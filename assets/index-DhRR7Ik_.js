var xT=e=>{throw TypeError(e)};var gee=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var tN=(e,t,r)=>t.has(e)||xT("Cannot "+r);var Ct=(e,t,r)=>(tN(e,t,"read from private field"),r?r.call(e):t.get(e)),En=(e,t,r)=>t.has(e)?xT("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),qr=(e,t,r,s)=>(tN(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),Xa=(e,t,r)=>(tN(e,t,"access private method"),r);var B1=(e,t,r,s)=>({set _(a){qr(e,t,a,r)},get _(){return Ct(e,t,s)}});var qZe=gee((uQe,l1)=>{function aB(e,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(s,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Fr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ln(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var iB={exports:{}},L2={},oB={exports:{}},cn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zv=Symbol.for("react.element"),xee=Symbol.for("react.portal"),vee=Symbol.for("react.fragment"),yee=Symbol.for("react.strict_mode"),bee=Symbol.for("react.profiler"),wee=Symbol.for("react.provider"),_ee=Symbol.for("react.context"),jee=Symbol.for("react.forward_ref"),Nee=Symbol.for("react.suspense"),See=Symbol.for("react.memo"),Cee=Symbol.for("react.lazy"),vT=Symbol.iterator;function Eee(e){return e===null||typeof e!="object"?null:(e=vT&&e[vT]||e["@@iterator"],typeof e=="function"?e:null)}var lB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cB=Object.assign,dB={};function Xp(e,t,r){this.props=e,this.context=t,this.refs=dB,this.updater=r||lB}Xp.prototype.isReactComponent={};Xp.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Xp.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function uB(){}uB.prototype=Xp.prototype;function PE(e,t,r){this.props=e,this.context=t,this.refs=dB,this.updater=r||lB}var OE=PE.prototype=new uB;OE.constructor=PE;cB(OE,Xp.prototype);OE.isPureReactComponent=!0;var yT=Array.isArray,hB=Object.prototype.hasOwnProperty,RE={current:null},fB={key:!0,ref:!0,__self:!0,__source:!0};function mB(e,t,r){var s,a={},i=null,o=null;if(t!=null)for(s in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)hB.call(t,s)&&!fB.hasOwnProperty(s)&&(a[s]=t[s]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var d=Array(l),c=0;c<l;c++)d[c]=arguments[c+2];a.children=d}if(e&&e.defaultProps)for(s in l=e.defaultProps,l)a[s]===void 0&&(a[s]=l[s]);return{$$typeof:zv,type:e,key:i,ref:o,props:a,_owner:RE.current}}function kee(e,t){return{$$typeof:zv,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ME(e){return typeof e=="object"&&e!==null&&e.$$typeof===zv}function Aee(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var bT=/\/+/g;function rN(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Aee(""+e.key):t.toString(36)}function Zy(e,t,r,s,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case zv:case xee:o=!0}}if(o)return o=e,a=a(o),e=s===""?"."+rN(o,0):s,yT(a)?(r="",e!=null&&(r=e.replace(bT,"$&/")+"/"),Zy(a,t,r,"",function(c){return c})):a!=null&&(ME(a)&&(a=kee(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(bT,"$&/")+"/")+e)),t.push(a)),1;if(o=0,s=s===""?".":s+":",yT(e))for(var l=0;l<e.length;l++){i=e[l];var d=s+rN(i,l);o+=Zy(i,t,r,d,a)}else if(d=Eee(e),typeof d=="function")for(e=d.call(e),l=0;!(i=e.next()).done;)i=i.value,d=s+rN(i,l++),o+=Zy(i,t,r,d,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function $1(e,t,r){if(e==null)return e;var s=[],a=0;return Zy(e,s,"","",function(i){return t.call(r,i,a++)}),s}function Tee(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ji={current:null},Qy={transition:null},Pee={ReactCurrentDispatcher:ji,ReactCurrentBatchConfig:Qy,ReactCurrentOwner:RE};function pB(){throw Error("act(...) is not supported in production builds of React.")}cn.Children={map:$1,forEach:function(e,t,r){$1(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return $1(e,function(){t++}),t},toArray:function(e){return $1(e,function(t){return t})||[]},only:function(e){if(!ME(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};cn.Component=Xp;cn.Fragment=vee;cn.Profiler=bee;cn.PureComponent=PE;cn.StrictMode=yee;cn.Suspense=Nee;cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Pee;cn.act=pB;cn.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=cB({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=RE.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(d in t)hB.call(t,d)&&!fB.hasOwnProperty(d)&&(s[d]=t[d]===void 0&&l!==void 0?l[d]:t[d])}var d=arguments.length-2;if(d===1)s.children=r;else if(1<d){l=Array(d);for(var c=0;c<d;c++)l[c]=arguments[c+2];s.children=l}return{$$typeof:zv,type:e.type,key:a,ref:i,props:s,_owner:o}};cn.createContext=function(e){return e={$$typeof:_ee,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:wee,_context:e},e.Consumer=e};cn.createElement=mB;cn.createFactory=function(e){var t=mB.bind(null,e);return t.type=e,t};cn.createRef=function(){return{current:null}};cn.forwardRef=function(e){return{$$typeof:jee,render:e}};cn.isValidElement=ME;cn.lazy=function(e){return{$$typeof:Cee,_payload:{_status:-1,_result:e},_init:Tee}};cn.memo=function(e,t){return{$$typeof:See,type:e,compare:t===void 0?null:t}};cn.startTransition=function(e){var t=Qy.transition;Qy.transition={};try{e()}finally{Qy.transition=t}};cn.unstable_act=pB;cn.useCallback=function(e,t){return ji.current.useCallback(e,t)};cn.useContext=function(e){return ji.current.useContext(e)};cn.useDebugValue=function(){};cn.useDeferredValue=function(e){return ji.current.useDeferredValue(e)};cn.useEffect=function(e,t){return ji.current.useEffect(e,t)};cn.useId=function(){return ji.current.useId()};cn.useImperativeHandle=function(e,t,r){return ji.current.useImperativeHandle(e,t,r)};cn.useInsertionEffect=function(e,t){return ji.current.useInsertionEffect(e,t)};cn.useLayoutEffect=function(e,t){return ji.current.useLayoutEffect(e,t)};cn.useMemo=function(e,t){return ji.current.useMemo(e,t)};cn.useReducer=function(e,t,r){return ji.current.useReducer(e,t,r)};cn.useRef=function(e){return ji.current.useRef(e)};cn.useState=function(e){return ji.current.useState(e)};cn.useSyncExternalStore=function(e,t,r){return ji.current.useSyncExternalStore(e,t,r)};cn.useTransition=function(){return ji.current.useTransition()};cn.version="18.3.1";oB.exports=cn;var P=oB.exports;const je=Ln(P),IE=aB({__proto__:null,default:je},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oee=P,Ree=Symbol.for("react.element"),Mee=Symbol.for("react.fragment"),Iee=Object.prototype.hasOwnProperty,Dee=Oee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Lee={key:!0,ref:!0,__self:!0,__source:!0};function gB(e,t,r){var s,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(s in t)Iee.call(t,s)&&!Lee.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)a[s]===void 0&&(a[s]=t[s]);return{$$typeof:Ree,type:e,key:i,ref:o,props:a,_owner:Dee.current}}L2.Fragment=Mee;L2.jsx=gB;L2.jsxs=gB;iB.exports=L2;var n=iB.exports,xB={exports:{}},vo={},vB={exports:{}},yB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(C,k){var M=C.length;C.push(k);e:for(;0<M;){var U=M-1>>>1,$=C[U];if(0<a($,k))C[U]=k,C[M]=$,M=U;else break e}}function r(C){return C.length===0?null:C[0]}function s(C){if(C.length===0)return null;var k=C[0],M=C.pop();if(M!==k){C[0]=M;e:for(var U=0,$=C.length,X=$>>>1;U<X;){var Z=2*(U+1)-1,re=C[Z],W=Z+1,J=C[W];if(0>a(re,M))W<$&&0>a(J,re)?(C[U]=J,C[W]=M,U=W):(C[U]=re,C[Z]=M,U=Z);else if(W<$&&0>a(J,M))C[U]=J,C[W]=M,U=W;else break e}}return k}function a(C,k){var M=C.sortIndex-k.sortIndex;return M!==0?M:C.id-k.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var d=[],c=[],u=1,h=null,f=3,m=!1,p=!1,g=!1,x=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(C){for(var k=r(c);k!==null;){if(k.callback===null)s(c);else if(k.startTime<=C)s(c),k.sortIndex=k.expirationTime,t(d,k);else break;k=r(c)}}function j(C){if(g=!1,b(C),!p)if(r(d)!==null)p=!0,E(T);else{var k=r(c);k!==null&&N(j,k.startTime-C)}}function T(C,k){p=!1,g&&(g=!1,v(D),D=-1),m=!0;var M=f;try{for(b(k),h=r(d);h!==null&&(!(h.expirationTime>k)||C&&!Y());){var U=h.callback;if(typeof U=="function"){h.callback=null,f=h.priorityLevel;var $=U(h.expirationTime<=k);k=e.unstable_now(),typeof $=="function"?h.callback=$:h===r(d)&&s(d),b(k)}else s(d);h=r(d)}if(h!==null)var X=!0;else{var Z=r(c);Z!==null&&N(j,Z.startTime-k),X=!1}return X}finally{h=null,f=M,m=!1}}var O=!1,R=null,D=-1,B=5,q=-1;function Y(){return!(e.unstable_now()-q<B)}function G(){if(R!==null){var C=e.unstable_now();q=C;var k=!0;try{k=R(!0,C)}finally{k?I():(O=!1,R=null)}}else O=!1}var I;if(typeof y=="function")I=function(){y(G)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,S=F.port2;F.port1.onmessage=G,I=function(){S.postMessage(null)}}else I=function(){x(G,0)};function E(C){R=C,O||(O=!0,I())}function N(C,k){D=x(function(){C(e.unstable_now())},k)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(C){C.callback=null},e.unstable_continueExecution=function(){p||m||(p=!0,E(T))},e.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<C?Math.floor(1e3/C):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(d)},e.unstable_next=function(C){switch(f){case 1:case 2:case 3:var k=3;break;default:k=f}var M=f;f=k;try{return C()}finally{f=M}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(C,k){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var M=f;f=C;try{return k()}finally{f=M}},e.unstable_scheduleCallback=function(C,k,M){var U=e.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?U+M:U):M=U,C){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=M+$,C={id:u++,callback:k,priorityLevel:C,startTime:M,expirationTime:$,sortIndex:-1},M>U?(C.sortIndex=M,t(c,C),r(d)===null&&C===r(c)&&(g?(v(D),D=-1):g=!0,N(j,M-U))):(C.sortIndex=$,t(d,C),p||m||(p=!0,E(T))),C},e.unstable_shouldYield=Y,e.unstable_wrapCallback=function(C){var k=f;return function(){var M=f;f=k;try{return C.apply(this,arguments)}finally{f=M}}}})(yB);vB.exports=yB;var Bee=vB.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $ee=P,fo=Bee;function Bt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bB=new Set,ix={};function pf(e,t){Jm(e,t),Jm(e+"Capture",t)}function Jm(e,t){for(ix[e]=t,e=0;e<t.length;e++)bB.add(t[e])}var Xc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),A4=Object.prototype.hasOwnProperty,Fee=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,wT={},_T={};function zee(e){return A4.call(_T,e)?!0:A4.call(wT,e)?!1:Fee.test(e)?_T[e]=!0:(wT[e]=!0,!1)}function Uee(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Vee(e,t,r,s){if(t===null||typeof t>"u"||Uee(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ni(e,t,r,s,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var qa={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){qa[e]=new Ni(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];qa[t]=new Ni(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){qa[e]=new Ni(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){qa[e]=new Ni(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){qa[e]=new Ni(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){qa[e]=new Ni(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){qa[e]=new Ni(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){qa[e]=new Ni(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){qa[e]=new Ni(e,5,!1,e.toLowerCase(),null,!1,!1)});var DE=/[\-:]([a-z])/g;function LE(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(DE,LE);qa[t]=new Ni(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(DE,LE);qa[t]=new Ni(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(DE,LE);qa[t]=new Ni(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){qa[e]=new Ni(e,1,!1,e.toLowerCase(),null,!1,!1)});qa.xlinkHref=new Ni("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){qa[e]=new Ni(e,1,!1,e.toLowerCase(),null,!0,!0)});function BE(e,t,r,s){var a=qa.hasOwnProperty(t)?qa[t]:null;(a!==null?a.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Vee(t,r,a,s)&&(r=null),s||a===null?zee(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,s=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var dd=$ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F1=Symbol.for("react.element"),im=Symbol.for("react.portal"),om=Symbol.for("react.fragment"),$E=Symbol.for("react.strict_mode"),T4=Symbol.for("react.profiler"),wB=Symbol.for("react.provider"),_B=Symbol.for("react.context"),FE=Symbol.for("react.forward_ref"),P4=Symbol.for("react.suspense"),O4=Symbol.for("react.suspense_list"),zE=Symbol.for("react.memo"),Rd=Symbol.for("react.lazy"),jB=Symbol.for("react.offscreen"),jT=Symbol.iterator;function Vg(e){return e===null||typeof e!="object"?null:(e=jT&&e[jT]||e["@@iterator"],typeof e=="function"?e:null)}var As=Object.assign,nN;function _0(e){if(nN===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);nN=t&&t[1]||""}return`
`+nN+e}var sN=!1;function aN(e,t){if(!e||sN)return"";sN=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var s=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){s=c}e.call(t.prototype)}else{try{throw Error()}catch(c){s=c}e()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),i=s.stack.split(`
`),o=a.length-1,l=i.length-1;1<=o&&0<=l&&a[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==i[l]){var d=`
`+a[o].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=o&&0<=l);break}}}finally{sN=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?_0(e):""}function qee(e){switch(e.tag){case 5:return _0(e.type);case 16:return _0("Lazy");case 13:return _0("Suspense");case 19:return _0("SuspenseList");case 0:case 2:case 15:return e=aN(e.type,!1),e;case 11:return e=aN(e.type.render,!1),e;case 1:return e=aN(e.type,!0),e;default:return""}}function R4(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case om:return"Fragment";case im:return"Portal";case T4:return"Profiler";case $E:return"StrictMode";case P4:return"Suspense";case O4:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case _B:return(e.displayName||"Context")+".Consumer";case wB:return(e._context.displayName||"Context")+".Provider";case FE:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case zE:return t=e.displayName||null,t!==null?t:R4(e.type)||"Memo";case Rd:t=e._payload,e=e._init;try{return R4(e(t))}catch{}}return null}function Wee(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return R4(t);case 8:return t===$E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function xu(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function NB(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Hee(e){var t=NB(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function z1(e){e._valueTracker||(e._valueTracker=Hee(e))}function SB(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=NB(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function wb(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function M4(e,t){var r=t.checked;return As({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function NT(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=xu(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function CB(e,t){t=t.checked,t!=null&&BE(e,"checked",t,!1)}function I4(e,t){CB(e,t);var r=xu(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?D4(e,t.type,r):t.hasOwnProperty("defaultValue")&&D4(e,t.type,xu(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ST(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function D4(e,t,r){(t!=="number"||wb(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var j0=Array.isArray;function km(e,t,r,s){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&s&&(e[r].defaultSelected=!0)}else{for(r=""+xu(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,s&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function L4(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Bt(91));return As({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function CT(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Bt(92));if(j0(r)){if(1<r.length)throw Error(Bt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:xu(r)}}function EB(e,t){var r=xu(t.value),s=xu(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function ET(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function kB(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function B4(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?kB(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var U1,AB=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(U1=U1||document.createElement("div"),U1.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=U1.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ox(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var I0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gee=["Webkit","ms","Moz","O"];Object.keys(I0).forEach(function(e){Gee.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),I0[t]=I0[e]})});function TB(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||I0.hasOwnProperty(e)&&I0[e]?(""+t).trim():t+"px"}function PB(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,a=TB(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,a):e[r]=a}}var Kee=As({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $4(e,t){if(t){if(Kee[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Bt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Bt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Bt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Bt(62))}}function F4(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var z4=null;function UE(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var U4=null,Am=null,Tm=null;function kT(e){if(e=qv(e)){if(typeof U4!="function")throw Error(Bt(280));var t=e.stateNode;t&&(t=U2(t),U4(e.stateNode,e.type,t))}}function OB(e){Am?Tm?Tm.push(e):Tm=[e]:Am=e}function RB(){if(Am){var e=Am,t=Tm;if(Tm=Am=null,kT(e),t)for(e=0;e<t.length;e++)kT(t[e])}}function MB(e,t){return e(t)}function IB(){}var iN=!1;function DB(e,t,r){if(iN)return e(t,r);iN=!0;try{return MB(e,t,r)}finally{iN=!1,(Am!==null||Tm!==null)&&(IB(),RB())}}function lx(e,t){var r=e.stateNode;if(r===null)return null;var s=U2(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Bt(231,t,typeof r));return r}var V4=!1;if(Xc)try{var qg={};Object.defineProperty(qg,"passive",{get:function(){V4=!0}}),window.addEventListener("test",qg,qg),window.removeEventListener("test",qg,qg)}catch{V4=!1}function Xee(e,t,r,s,a,i,o,l,d){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var D0=!1,_b=null,jb=!1,q4=null,Yee={onError:function(e){D0=!0,_b=e}};function Zee(e,t,r,s,a,i,o,l,d){D0=!1,_b=null,Xee.apply(Yee,arguments)}function Qee(e,t,r,s,a,i,o,l,d){if(Zee.apply(this,arguments),D0){if(D0){var c=_b;D0=!1,_b=null}else throw Error(Bt(198));jb||(jb=!0,q4=c)}}function gf(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function LB(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function AT(e){if(gf(e)!==e)throw Error(Bt(188))}function Jee(e){var t=e.alternate;if(!t){if(t=gf(e),t===null)throw Error(Bt(188));return t!==e?null:e}for(var r=e,s=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(s=a.return,s!==null){r=s;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return AT(a),e;if(i===s)return AT(a),t;i=i.sibling}throw Error(Bt(188))}if(r.return!==s.return)r=a,s=i;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,s=i;break}if(l===s){o=!0,s=a,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,s=a;break}if(l===s){o=!0,s=i,r=a;break}l=l.sibling}if(!o)throw Error(Bt(189))}}if(r.alternate!==s)throw Error(Bt(190))}if(r.tag!==3)throw Error(Bt(188));return r.stateNode.current===r?e:t}function BB(e){return e=Jee(e),e!==null?$B(e):null}function $B(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=$B(e);if(t!==null)return t;e=e.sibling}return null}var FB=fo.unstable_scheduleCallback,TT=fo.unstable_cancelCallback,ete=fo.unstable_shouldYield,tte=fo.unstable_requestPaint,zs=fo.unstable_now,rte=fo.unstable_getCurrentPriorityLevel,VE=fo.unstable_ImmediatePriority,zB=fo.unstable_UserBlockingPriority,Nb=fo.unstable_NormalPriority,nte=fo.unstable_LowPriority,UB=fo.unstable_IdlePriority,B2=null,nc=null;function ste(e){if(nc&&typeof nc.onCommitFiberRoot=="function")try{nc.onCommitFiberRoot(B2,e,void 0,(e.current.flags&128)===128)}catch{}}var vl=Math.clz32?Math.clz32:ote,ate=Math.log,ite=Math.LN2;function ote(e){return e>>>=0,e===0?32:31-(ate(e)/ite|0)|0}var V1=64,q1=4194304;function N0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Sb(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?s=N0(l):(i&=o,i!==0&&(s=N0(i)))}else o=r&~a,o!==0?s=N0(o):i!==0&&(s=N0(i));if(s===0)return 0;if(t!==0&&t!==s&&!(t&a)&&(a=s&-s,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-vl(t),a=1<<r,s|=e[r],t&=~a;return s}function lte(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cte(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-vl(i),l=1<<o,d=a[o];d===-1?(!(l&r)||l&s)&&(a[o]=lte(l,t)):d<=t&&(e.expiredLanes|=l),i&=~l}}function W4(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function VB(){var e=V1;return V1<<=1,!(V1&4194240)&&(V1=64),e}function oN(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Uv(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-vl(t),e[t]=r}function dte(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-vl(r),i=1<<a;t[a]=0,s[a]=-1,e[a]=-1,r&=~i}}function qE(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-vl(r),a=1<<s;a&t|e[s]&t&&(e[s]|=t),r&=~a}}var $n=0;function qB(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var WB,WE,HB,GB,KB,H4=!1,W1=[],nu=null,su=null,au=null,cx=new Map,dx=new Map,Bd=[],ute="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function PT(e,t){switch(e){case"focusin":case"focusout":nu=null;break;case"dragenter":case"dragleave":su=null;break;case"mouseover":case"mouseout":au=null;break;case"pointerover":case"pointerout":cx.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":dx.delete(t.pointerId)}}function Wg(e,t,r,s,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:i,targetContainers:[a]},t!==null&&(t=qv(t),t!==null&&WE(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function hte(e,t,r,s,a){switch(t){case"focusin":return nu=Wg(nu,e,t,r,s,a),!0;case"dragenter":return su=Wg(su,e,t,r,s,a),!0;case"mouseover":return au=Wg(au,e,t,r,s,a),!0;case"pointerover":var i=a.pointerId;return cx.set(i,Wg(cx.get(i)||null,e,t,r,s,a)),!0;case"gotpointercapture":return i=a.pointerId,dx.set(i,Wg(dx.get(i)||null,e,t,r,s,a)),!0}return!1}function XB(e){var t=xh(e.target);if(t!==null){var r=gf(t);if(r!==null){if(t=r.tag,t===13){if(t=LB(r),t!==null){e.blockedOn=t,KB(e.priority,function(){HB(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Jy(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=G4(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);z4=s,r.target.dispatchEvent(s),z4=null}else return t=qv(r),t!==null&&WE(t),e.blockedOn=r,!1;t.shift()}return!0}function OT(e,t,r){Jy(e)&&r.delete(t)}function fte(){H4=!1,nu!==null&&Jy(nu)&&(nu=null),su!==null&&Jy(su)&&(su=null),au!==null&&Jy(au)&&(au=null),cx.forEach(OT),dx.forEach(OT)}function Hg(e,t){e.blockedOn===t&&(e.blockedOn=null,H4||(H4=!0,fo.unstable_scheduleCallback(fo.unstable_NormalPriority,fte)))}function ux(e){function t(a){return Hg(a,e)}if(0<W1.length){Hg(W1[0],e);for(var r=1;r<W1.length;r++){var s=W1[r];s.blockedOn===e&&(s.blockedOn=null)}}for(nu!==null&&Hg(nu,e),su!==null&&Hg(su,e),au!==null&&Hg(au,e),cx.forEach(t),dx.forEach(t),r=0;r<Bd.length;r++)s=Bd[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<Bd.length&&(r=Bd[0],r.blockedOn===null);)XB(r),r.blockedOn===null&&Bd.shift()}var Pm=dd.ReactCurrentBatchConfig,Cb=!0;function mte(e,t,r,s){var a=$n,i=Pm.transition;Pm.transition=null;try{$n=1,HE(e,t,r,s)}finally{$n=a,Pm.transition=i}}function pte(e,t,r,s){var a=$n,i=Pm.transition;Pm.transition=null;try{$n=4,HE(e,t,r,s)}finally{$n=a,Pm.transition=i}}function HE(e,t,r,s){if(Cb){var a=G4(e,t,r,s);if(a===null)xN(e,t,s,Eb,r),PT(e,s);else if(hte(a,e,t,r,s))s.stopPropagation();else if(PT(e,s),t&4&&-1<ute.indexOf(e)){for(;a!==null;){var i=qv(a);if(i!==null&&WB(i),i=G4(e,t,r,s),i===null&&xN(e,t,s,Eb,r),i===a)break;a=i}a!==null&&s.stopPropagation()}else xN(e,t,s,null,r)}}var Eb=null;function G4(e,t,r,s){if(Eb=null,e=UE(s),e=xh(e),e!==null)if(t=gf(e),t===null)e=null;else if(r=t.tag,r===13){if(e=LB(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Eb=e,null}function YB(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(rte()){case VE:return 1;case zB:return 4;case Nb:case nte:return 16;case UB:return 536870912;default:return 16}default:return 16}}var Gd=null,GE=null,eb=null;function ZB(){if(eb)return eb;var e,t=GE,r=t.length,s,a="value"in Gd?Gd.value:Gd.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(s=1;s<=o&&t[r-s]===a[i-s];s++);return eb=a.slice(e,1<s?1-s:void 0)}function tb(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function H1(){return!0}function RT(){return!1}function yo(e){function t(r,s,a,i,o){this._reactName=r,this._targetInst=a,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?H1:RT,this.isPropagationStopped=RT,this}return As(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=H1)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=H1)},persist:function(){},isPersistent:H1}),t}var Yp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},KE=yo(Yp),Vv=As({},Yp,{view:0,detail:0}),gte=yo(Vv),lN,cN,Gg,$2=As({},Vv,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:XE,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Gg&&(Gg&&e.type==="mousemove"?(lN=e.screenX-Gg.screenX,cN=e.screenY-Gg.screenY):cN=lN=0,Gg=e),lN)},movementY:function(e){return"movementY"in e?e.movementY:cN}}),MT=yo($2),xte=As({},$2,{dataTransfer:0}),vte=yo(xte),yte=As({},Vv,{relatedTarget:0}),dN=yo(yte),bte=As({},Yp,{animationName:0,elapsedTime:0,pseudoElement:0}),wte=yo(bte),_te=As({},Yp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),jte=yo(_te),Nte=As({},Yp,{data:0}),IT=yo(Nte),Ste={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cte={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ete={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kte(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Ete[e])?!!t[e]:!1}function XE(){return kte}var Ate=As({},Vv,{key:function(e){if(e.key){var t=Ste[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=tb(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Cte[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:XE,charCode:function(e){return e.type==="keypress"?tb(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?tb(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Tte=yo(Ate),Pte=As({},$2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),DT=yo(Pte),Ote=As({},Vv,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:XE}),Rte=yo(Ote),Mte=As({},Yp,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ite=yo(Mte),Dte=As({},$2,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Lte=yo(Dte),Bte=[9,13,27,32],YE=Xc&&"CompositionEvent"in window,L0=null;Xc&&"documentMode"in document&&(L0=document.documentMode);var $te=Xc&&"TextEvent"in window&&!L0,QB=Xc&&(!YE||L0&&8<L0&&11>=L0),LT=" ",BT=!1;function JB(e,t){switch(e){case"keyup":return Bte.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function e$(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var lm=!1;function Fte(e,t){switch(e){case"compositionend":return e$(t);case"keypress":return t.which!==32?null:(BT=!0,LT);case"textInput":return e=t.data,e===LT&&BT?null:e;default:return null}}function zte(e,t){if(lm)return e==="compositionend"||!YE&&JB(e,t)?(e=ZB(),eb=GE=Gd=null,lm=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return QB&&t.locale!=="ko"?null:t.data;default:return null}}var Ute={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $T(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Ute[e.type]:t==="textarea"}function t$(e,t,r,s){OB(s),t=kb(t,"onChange"),0<t.length&&(r=new KE("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var B0=null,hx=null;function Vte(e){h$(e,0)}function F2(e){var t=um(e);if(SB(t))return e}function qte(e,t){if(e==="change")return t}var r$=!1;if(Xc){var uN;if(Xc){var hN="oninput"in document;if(!hN){var FT=document.createElement("div");FT.setAttribute("oninput","return;"),hN=typeof FT.oninput=="function"}uN=hN}else uN=!1;r$=uN&&(!document.documentMode||9<document.documentMode)}function zT(){B0&&(B0.detachEvent("onpropertychange",n$),hx=B0=null)}function n$(e){if(e.propertyName==="value"&&F2(hx)){var t=[];t$(t,hx,e,UE(e)),DB(Vte,t)}}function Wte(e,t,r){e==="focusin"?(zT(),B0=t,hx=r,B0.attachEvent("onpropertychange",n$)):e==="focusout"&&zT()}function Hte(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return F2(hx)}function Gte(e,t){if(e==="click")return F2(t)}function Kte(e,t){if(e==="input"||e==="change")return F2(t)}function Xte(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var jl=typeof Object.is=="function"?Object.is:Xte;function fx(e,t){if(jl(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var a=r[s];if(!A4.call(t,a)||!jl(e[a],t[a]))return!1}return!0}function UT(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function VT(e,t){var r=UT(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=UT(r)}}function s$(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?s$(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function a$(){for(var e=window,t=wb();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=wb(e.document)}return t}function ZE(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Yte(e){var t=a$(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&s$(r.ownerDocument.documentElement,r)){if(s!==null&&ZE(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(s.start,a);s=s.end===void 0?i:Math.min(s.end,a),!e.extend&&i>s&&(a=s,s=i,i=a),a=VT(r,i);var o=VT(r,s);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>s?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Zte=Xc&&"documentMode"in document&&11>=document.documentMode,cm=null,K4=null,$0=null,X4=!1;function qT(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;X4||cm==null||cm!==wb(s)||(s=cm,"selectionStart"in s&&ZE(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),$0&&fx($0,s)||($0=s,s=kb(K4,"onSelect"),0<s.length&&(t=new KE("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=cm)))}function G1(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var dm={animationend:G1("Animation","AnimationEnd"),animationiteration:G1("Animation","AnimationIteration"),animationstart:G1("Animation","AnimationStart"),transitionend:G1("Transition","TransitionEnd")},fN={},i$={};Xc&&(i$=document.createElement("div").style,"AnimationEvent"in window||(delete dm.animationend.animation,delete dm.animationiteration.animation,delete dm.animationstart.animation),"TransitionEvent"in window||delete dm.transitionend.transition);function z2(e){if(fN[e])return fN[e];if(!dm[e])return e;var t=dm[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in i$)return fN[e]=t[r];return e}var o$=z2("animationend"),l$=z2("animationiteration"),c$=z2("animationstart"),d$=z2("transitionend"),u$=new Map,WT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Au(e,t){u$.set(e,t),pf(t,[e])}for(var mN=0;mN<WT.length;mN++){var pN=WT[mN],Qte=pN.toLowerCase(),Jte=pN[0].toUpperCase()+pN.slice(1);Au(Qte,"on"+Jte)}Au(o$,"onAnimationEnd");Au(l$,"onAnimationIteration");Au(c$,"onAnimationStart");Au("dblclick","onDoubleClick");Au("focusin","onFocus");Au("focusout","onBlur");Au(d$,"onTransitionEnd");Jm("onMouseEnter",["mouseout","mouseover"]);Jm("onMouseLeave",["mouseout","mouseover"]);Jm("onPointerEnter",["pointerout","pointerover"]);Jm("onPointerLeave",["pointerout","pointerover"]);pf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));pf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));pf("onBeforeInput",["compositionend","keypress","textInput","paste"]);pf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));pf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));pf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var S0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ere=new Set("cancel close invalid load scroll toggle".split(" ").concat(S0));function HT(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,Qee(s,t,void 0,e),e.currentTarget=null}function h$(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],a=s.event;s=s.listeners;e:{var i=void 0;if(t)for(var o=s.length-1;0<=o;o--){var l=s[o],d=l.instance,c=l.currentTarget;if(l=l.listener,d!==i&&a.isPropagationStopped())break e;HT(a,l,c),i=d}else for(o=0;o<s.length;o++){if(l=s[o],d=l.instance,c=l.currentTarget,l=l.listener,d!==i&&a.isPropagationStopped())break e;HT(a,l,c),i=d}}}if(jb)throw e=q4,jb=!1,q4=null,e}function os(e,t){var r=t[eS];r===void 0&&(r=t[eS]=new Set);var s=e+"__bubble";r.has(s)||(f$(t,e,2,!1),r.add(s))}function gN(e,t,r){var s=0;t&&(s|=4),f$(r,e,s,t)}var K1="_reactListening"+Math.random().toString(36).slice(2);function mx(e){if(!e[K1]){e[K1]=!0,bB.forEach(function(r){r!=="selectionchange"&&(ere.has(r)||gN(r,!1,e),gN(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[K1]||(t[K1]=!0,gN("selectionchange",!1,t))}}function f$(e,t,r,s){switch(YB(t)){case 1:var a=mte;break;case 4:a=pte;break;default:a=HE}r=a.bind(null,t,r,e),a=void 0,!V4||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),s?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function xN(e,t,r,s,a){var i=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var l=s.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=s.return;o!==null;){var d=o.tag;if((d===3||d===4)&&(d=o.stateNode.containerInfo,d===a||d.nodeType===8&&d.parentNode===a))return;o=o.return}for(;l!==null;){if(o=xh(l),o===null)return;if(d=o.tag,d===5||d===6){s=i=o;continue e}l=l.parentNode}}s=s.return}DB(function(){var c=i,u=UE(r),h=[];e:{var f=u$.get(e);if(f!==void 0){var m=KE,p=e;switch(e){case"keypress":if(tb(r)===0)break e;case"keydown":case"keyup":m=Tte;break;case"focusin":p="focus",m=dN;break;case"focusout":p="blur",m=dN;break;case"beforeblur":case"afterblur":m=dN;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=MT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=vte;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Rte;break;case o$:case l$:case c$:m=wte;break;case d$:m=Ite;break;case"scroll":m=gte;break;case"wheel":m=Lte;break;case"copy":case"cut":case"paste":m=jte;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=DT}var g=(t&4)!==0,x=!g&&e==="scroll",v=g?f!==null?f+"Capture":null:f;g=[];for(var y=c,b;y!==null;){b=y;var j=b.stateNode;if(b.tag===5&&j!==null&&(b=j,v!==null&&(j=lx(y,v),j!=null&&g.push(px(y,j,b)))),x)break;y=y.return}0<g.length&&(f=new m(f,p,null,r,u),h.push({event:f,listeners:g}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",f&&r!==z4&&(p=r.relatedTarget||r.fromElement)&&(xh(p)||p[Yc]))break e;if((m||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,m?(p=r.relatedTarget||r.toElement,m=c,p=p?xh(p):null,p!==null&&(x=gf(p),p!==x||p.tag!==5&&p.tag!==6)&&(p=null)):(m=null,p=c),m!==p)){if(g=MT,j="onMouseLeave",v="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=DT,j="onPointerLeave",v="onPointerEnter",y="pointer"),x=m==null?f:um(m),b=p==null?f:um(p),f=new g(j,y+"leave",m,r,u),f.target=x,f.relatedTarget=b,j=null,xh(u)===c&&(g=new g(v,y+"enter",p,r,u),g.target=b,g.relatedTarget=x,j=g),x=j,m&&p)t:{for(g=m,v=p,y=0,b=g;b;b=Mf(b))y++;for(b=0,j=v;j;j=Mf(j))b++;for(;0<y-b;)g=Mf(g),y--;for(;0<b-y;)v=Mf(v),b--;for(;y--;){if(g===v||v!==null&&g===v.alternate)break t;g=Mf(g),v=Mf(v)}g=null}else g=null;m!==null&&GT(h,f,m,g,!1),p!==null&&x!==null&&GT(h,x,p,g,!0)}}e:{if(f=c?um(c):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var T=qte;else if($T(f))if(r$)T=Kte;else{T=Hte;var O=Wte}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(T=Gte);if(T&&(T=T(e,c))){t$(h,T,r,u);break e}O&&O(e,f,c),e==="focusout"&&(O=f._wrapperState)&&O.controlled&&f.type==="number"&&D4(f,"number",f.value)}switch(O=c?um(c):window,e){case"focusin":($T(O)||O.contentEditable==="true")&&(cm=O,K4=c,$0=null);break;case"focusout":$0=K4=cm=null;break;case"mousedown":X4=!0;break;case"contextmenu":case"mouseup":case"dragend":X4=!1,qT(h,r,u);break;case"selectionchange":if(Zte)break;case"keydown":case"keyup":qT(h,r,u)}var R;if(YE)e:{switch(e){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else lm?JB(e,r)&&(D="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(D="onCompositionStart");D&&(QB&&r.locale!=="ko"&&(lm||D!=="onCompositionStart"?D==="onCompositionEnd"&&lm&&(R=ZB()):(Gd=u,GE="value"in Gd?Gd.value:Gd.textContent,lm=!0)),O=kb(c,D),0<O.length&&(D=new IT(D,e,null,r,u),h.push({event:D,listeners:O}),R?D.data=R:(R=e$(r),R!==null&&(D.data=R)))),(R=$te?Fte(e,r):zte(e,r))&&(c=kb(c,"onBeforeInput"),0<c.length&&(u=new IT("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=R))}h$(h,t)})}function px(e,t,r){return{instance:e,listener:t,currentTarget:r}}function kb(e,t){for(var r=t+"Capture",s=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=lx(e,r),i!=null&&s.unshift(px(e,i,a)),i=lx(e,t),i!=null&&s.push(px(e,i,a))),e=e.return}return s}function Mf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function GT(e,t,r,s,a){for(var i=t._reactName,o=[];r!==null&&r!==s;){var l=r,d=l.alternate,c=l.stateNode;if(d!==null&&d===s)break;l.tag===5&&c!==null&&(l=c,a?(d=lx(r,i),d!=null&&o.unshift(px(r,d,l))):a||(d=lx(r,i),d!=null&&o.push(px(r,d,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var tre=/\r\n?/g,rre=/\u0000|\uFFFD/g;function KT(e){return(typeof e=="string"?e:""+e).replace(tre,`
`).replace(rre,"")}function X1(e,t,r){if(t=KT(t),KT(e)!==t&&r)throw Error(Bt(425))}function Ab(){}var Y4=null,Z4=null;function Q4(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var J4=typeof setTimeout=="function"?setTimeout:void 0,nre=typeof clearTimeout=="function"?clearTimeout:void 0,XT=typeof Promise=="function"?Promise:void 0,sre=typeof queueMicrotask=="function"?queueMicrotask:typeof XT<"u"?function(e){return XT.resolve(null).then(e).catch(are)}:J4;function are(e){setTimeout(function(){throw e})}function vN(e,t){var r=t,s=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(s===0){e.removeChild(a),ux(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=a}while(r);ux(t)}function iu(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function YT(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Zp=Math.random().toString(36).slice(2),Gl="__reactFiber$"+Zp,gx="__reactProps$"+Zp,Yc="__reactContainer$"+Zp,eS="__reactEvents$"+Zp,ire="__reactListeners$"+Zp,ore="__reactHandles$"+Zp;function xh(e){var t=e[Gl];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Yc]||r[Gl]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=YT(e);e!==null;){if(r=e[Gl])return r;e=YT(e)}return t}e=r,r=e.parentNode}return null}function qv(e){return e=e[Gl]||e[Yc],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function um(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Bt(33))}function U2(e){return e[gx]||null}var tS=[],hm=-1;function Tu(e){return{current:e}}function us(e){0>hm||(e.current=tS[hm],tS[hm]=null,hm--)}function ts(e,t){hm++,tS[hm]=e.current,e.current=t}var vu={},oi=Tu(vu),$i=Tu(!1),Uh=vu;function ep(e,t){var r=e.type.contextTypes;if(!r)return vu;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Fi(e){return e=e.childContextTypes,e!=null}function Tb(){us($i),us(oi)}function ZT(e,t,r){if(oi.current!==vu)throw Error(Bt(168));ts(oi,t),ts($i,r)}function m$(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var a in s)if(!(a in t))throw Error(Bt(108,Wee(e)||"Unknown",a));return As({},r,s)}function Pb(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||vu,Uh=oi.current,ts(oi,e),ts($i,$i.current),!0}function QT(e,t,r){var s=e.stateNode;if(!s)throw Error(Bt(169));r?(e=m$(e,t,Uh),s.__reactInternalMemoizedMergedChildContext=e,us($i),us(oi),ts(oi,e)):us($i),ts($i,r)}var Lc=null,V2=!1,yN=!1;function p$(e){Lc===null?Lc=[e]:Lc.push(e)}function lre(e){V2=!0,p$(e)}function Pu(){if(!yN&&Lc!==null){yN=!0;var e=0,t=$n;try{var r=Lc;for($n=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}Lc=null,V2=!1}catch(a){throw Lc!==null&&(Lc=Lc.slice(e+1)),FB(VE,Pu),a}finally{$n=t,yN=!1}}return null}var fm=[],mm=0,Ob=null,Rb=0,Ao=[],To=0,Vh=null,$c=1,Fc="";function oh(e,t){fm[mm++]=Rb,fm[mm++]=Ob,Ob=e,Rb=t}function g$(e,t,r){Ao[To++]=$c,Ao[To++]=Fc,Ao[To++]=Vh,Vh=e;var s=$c;e=Fc;var a=32-vl(s)-1;s&=~(1<<a),r+=1;var i=32-vl(t)+a;if(30<i){var o=a-a%5;i=(s&(1<<o)-1).toString(32),s>>=o,a-=o,$c=1<<32-vl(t)+a|r<<a|s,Fc=i+e}else $c=1<<i|r<<a|s,Fc=e}function QE(e){e.return!==null&&(oh(e,1),g$(e,1,0))}function JE(e){for(;e===Ob;)Ob=fm[--mm],fm[mm]=null,Rb=fm[--mm],fm[mm]=null;for(;e===Vh;)Vh=Ao[--To],Ao[To]=null,Fc=Ao[--To],Ao[To]=null,$c=Ao[--To],Ao[To]=null}var uo=null,co=null,ps=!1,ml=null;function x$(e,t){var r=Oo(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function JT(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,uo=e,co=iu(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,uo=e,co=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Vh!==null?{id:$c,overflow:Fc}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Oo(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,uo=e,co=null,!0):!1;default:return!1}}function rS(e){return(e.mode&1)!==0&&(e.flags&128)===0}function nS(e){if(ps){var t=co;if(t){var r=t;if(!JT(e,t)){if(rS(e))throw Error(Bt(418));t=iu(r.nextSibling);var s=uo;t&&JT(e,t)?x$(s,r):(e.flags=e.flags&-4097|2,ps=!1,uo=e)}}else{if(rS(e))throw Error(Bt(418));e.flags=e.flags&-4097|2,ps=!1,uo=e}}}function eP(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;uo=e}function Y1(e){if(e!==uo)return!1;if(!ps)return eP(e),ps=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Q4(e.type,e.memoizedProps)),t&&(t=co)){if(rS(e))throw v$(),Error(Bt(418));for(;t;)x$(e,t),t=iu(t.nextSibling)}if(eP(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Bt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){co=iu(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}co=null}}else co=uo?iu(e.stateNode.nextSibling):null;return!0}function v$(){for(var e=co;e;)e=iu(e.nextSibling)}function tp(){co=uo=null,ps=!1}function e6(e){ml===null?ml=[e]:ml.push(e)}var cre=dd.ReactCurrentBatchConfig;function Kg(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Bt(309));var s=r.stateNode}if(!s)throw Error(Bt(147,e));var a=s,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=a.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Bt(284));if(!r._owner)throw Error(Bt(290,e))}return e}function Z1(e,t){throw e=Object.prototype.toString.call(t),Error(Bt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function tP(e){var t=e._init;return t(e._payload)}function y$(e){function t(v,y){if(e){var b=v.deletions;b===null?(v.deletions=[y],v.flags|=16):b.push(y)}}function r(v,y){if(!e)return null;for(;y!==null;)t(v,y),y=y.sibling;return null}function s(v,y){for(v=new Map;y!==null;)y.key!==null?v.set(y.key,y):v.set(y.index,y),y=y.sibling;return v}function a(v,y){return v=du(v,y),v.index=0,v.sibling=null,v}function i(v,y,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<y?(v.flags|=2,y):b):(v.flags|=2,y)):(v.flags|=1048576,y)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,y,b,j){return y===null||y.tag!==6?(y=CN(b,v.mode,j),y.return=v,y):(y=a(y,b),y.return=v,y)}function d(v,y,b,j){var T=b.type;return T===om?u(v,y,b.props.children,j,b.key):y!==null&&(y.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Rd&&tP(T)===y.type)?(j=a(y,b.props),j.ref=Kg(v,y,b),j.return=v,j):(j=lb(b.type,b.key,b.props,null,v.mode,j),j.ref=Kg(v,y,b),j.return=v,j)}function c(v,y,b,j){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=EN(b,v.mode,j),y.return=v,y):(y=a(y,b.children||[]),y.return=v,y)}function u(v,y,b,j,T){return y===null||y.tag!==7?(y=Ih(b,v.mode,j,T),y.return=v,y):(y=a(y,b),y.return=v,y)}function h(v,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=CN(""+y,v.mode,b),y.return=v,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case F1:return b=lb(y.type,y.key,y.props,null,v.mode,b),b.ref=Kg(v,null,y),b.return=v,b;case im:return y=EN(y,v.mode,b),y.return=v,y;case Rd:var j=y._init;return h(v,j(y._payload),b)}if(j0(y)||Vg(y))return y=Ih(y,v.mode,b,null),y.return=v,y;Z1(v,y)}return null}function f(v,y,b,j){var T=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return T!==null?null:l(v,y,""+b,j);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case F1:return b.key===T?d(v,y,b,j):null;case im:return b.key===T?c(v,y,b,j):null;case Rd:return T=b._init,f(v,y,T(b._payload),j)}if(j0(b)||Vg(b))return T!==null?null:u(v,y,b,j,null);Z1(v,b)}return null}function m(v,y,b,j,T){if(typeof j=="string"&&j!==""||typeof j=="number")return v=v.get(b)||null,l(y,v,""+j,T);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case F1:return v=v.get(j.key===null?b:j.key)||null,d(y,v,j,T);case im:return v=v.get(j.key===null?b:j.key)||null,c(y,v,j,T);case Rd:var O=j._init;return m(v,y,b,O(j._payload),T)}if(j0(j)||Vg(j))return v=v.get(b)||null,u(y,v,j,T,null);Z1(y,j)}return null}function p(v,y,b,j){for(var T=null,O=null,R=y,D=y=0,B=null;R!==null&&D<b.length;D++){R.index>D?(B=R,R=null):B=R.sibling;var q=f(v,R,b[D],j);if(q===null){R===null&&(R=B);break}e&&R&&q.alternate===null&&t(v,R),y=i(q,y,D),O===null?T=q:O.sibling=q,O=q,R=B}if(D===b.length)return r(v,R),ps&&oh(v,D),T;if(R===null){for(;D<b.length;D++)R=h(v,b[D],j),R!==null&&(y=i(R,y,D),O===null?T=R:O.sibling=R,O=R);return ps&&oh(v,D),T}for(R=s(v,R);D<b.length;D++)B=m(R,v,D,b[D],j),B!==null&&(e&&B.alternate!==null&&R.delete(B.key===null?D:B.key),y=i(B,y,D),O===null?T=B:O.sibling=B,O=B);return e&&R.forEach(function(Y){return t(v,Y)}),ps&&oh(v,D),T}function g(v,y,b,j){var T=Vg(b);if(typeof T!="function")throw Error(Bt(150));if(b=T.call(b),b==null)throw Error(Bt(151));for(var O=T=null,R=y,D=y=0,B=null,q=b.next();R!==null&&!q.done;D++,q=b.next()){R.index>D?(B=R,R=null):B=R.sibling;var Y=f(v,R,q.value,j);if(Y===null){R===null&&(R=B);break}e&&R&&Y.alternate===null&&t(v,R),y=i(Y,y,D),O===null?T=Y:O.sibling=Y,O=Y,R=B}if(q.done)return r(v,R),ps&&oh(v,D),T;if(R===null){for(;!q.done;D++,q=b.next())q=h(v,q.value,j),q!==null&&(y=i(q,y,D),O===null?T=q:O.sibling=q,O=q);return ps&&oh(v,D),T}for(R=s(v,R);!q.done;D++,q=b.next())q=m(R,v,D,q.value,j),q!==null&&(e&&q.alternate!==null&&R.delete(q.key===null?D:q.key),y=i(q,y,D),O===null?T=q:O.sibling=q,O=q);return e&&R.forEach(function(G){return t(v,G)}),ps&&oh(v,D),T}function x(v,y,b,j){if(typeof b=="object"&&b!==null&&b.type===om&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case F1:e:{for(var T=b.key,O=y;O!==null;){if(O.key===T){if(T=b.type,T===om){if(O.tag===7){r(v,O.sibling),y=a(O,b.props.children),y.return=v,v=y;break e}}else if(O.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Rd&&tP(T)===O.type){r(v,O.sibling),y=a(O,b.props),y.ref=Kg(v,O,b),y.return=v,v=y;break e}r(v,O);break}else t(v,O);O=O.sibling}b.type===om?(y=Ih(b.props.children,v.mode,j,b.key),y.return=v,v=y):(j=lb(b.type,b.key,b.props,null,v.mode,j),j.ref=Kg(v,y,b),j.return=v,v=j)}return o(v);case im:e:{for(O=b.key;y!==null;){if(y.key===O)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(v,y.sibling),y=a(y,b.children||[]),y.return=v,v=y;break e}else{r(v,y);break}else t(v,y);y=y.sibling}y=EN(b,v.mode,j),y.return=v,v=y}return o(v);case Rd:return O=b._init,x(v,y,O(b._payload),j)}if(j0(b))return p(v,y,b,j);if(Vg(b))return g(v,y,b,j);Z1(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(v,y.sibling),y=a(y,b),y.return=v,v=y):(r(v,y),y=CN(b,v.mode,j),y.return=v,v=y),o(v)):r(v,y)}return x}var rp=y$(!0),b$=y$(!1),Mb=Tu(null),Ib=null,pm=null,t6=null;function r6(){t6=pm=Ib=null}function n6(e){var t=Mb.current;us(Mb),e._currentValue=t}function sS(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function Om(e,t){Ib=e,t6=pm=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Mi=!0),e.firstContext=null)}function $o(e){var t=e._currentValue;if(t6!==e)if(e={context:e,memoizedValue:t,next:null},pm===null){if(Ib===null)throw Error(Bt(308));pm=e,Ib.dependencies={lanes:0,firstContext:e}}else pm=pm.next=e;return t}var vh=null;function s6(e){vh===null?vh=[e]:vh.push(e)}function w$(e,t,r,s){var a=t.interleaved;return a===null?(r.next=r,s6(t)):(r.next=a.next,a.next=r),t.interleaved=r,Zc(e,s)}function Zc(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Md=!1;function a6(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _$(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function qc(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ou(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Nn&2){var a=s.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),s.pending=t,Zc(e,r)}return a=s.interleaved,a===null?(t.next=t,s6(s)):(t.next=a.next,a.next=t),s.interleaved=t,Zc(e,r)}function rb(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,qE(e,r)}}function rP(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Db(e,t,r,s){var a=e.updateQueue;Md=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var d=l,c=d.next;d.next=null,o===null?i=c:o.next=c,o=d;var u=e.alternate;u!==null&&(u=u.updateQueue,l=u.lastBaseUpdate,l!==o&&(l===null?u.firstBaseUpdate=c:l.next=c,u.lastBaseUpdate=d))}if(i!==null){var h=a.baseState;o=0,u=c=d=null,l=i;do{var f=l.lane,m=l.eventTime;if((s&f)===f){u!==null&&(u=u.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var p=e,g=l;switch(f=t,m=r,g.tag){case 1:if(p=g.payload,typeof p=="function"){h=p.call(m,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(m,h,f):p,f==null)break e;h=As({},h,f);break e;case 2:Md=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=a.effects,f===null?a.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},u===null?(c=u=m,d=h):u=u.next=m,o|=f;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;f=l,l=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(u===null&&(d=h),a.baseState=d,a.firstBaseUpdate=c,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);Wh|=o,e.lanes=o,e.memoizedState=h}}function nP(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],a=s.callback;if(a!==null){if(s.callback=null,s=r,typeof a!="function")throw Error(Bt(191,a));a.call(s)}}}var Wv={},sc=Tu(Wv),xx=Tu(Wv),vx=Tu(Wv);function yh(e){if(e===Wv)throw Error(Bt(174));return e}function i6(e,t){switch(ts(vx,t),ts(xx,e),ts(sc,Wv),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:B4(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=B4(t,e)}us(sc),ts(sc,t)}function np(){us(sc),us(xx),us(vx)}function j$(e){yh(vx.current);var t=yh(sc.current),r=B4(t,e.type);t!==r&&(ts(xx,e),ts(sc,r))}function o6(e){xx.current===e&&(us(sc),us(xx))}var ws=Tu(0);function Lb(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var bN=[];function l6(){for(var e=0;e<bN.length;e++)bN[e]._workInProgressVersionPrimary=null;bN.length=0}var nb=dd.ReactCurrentDispatcher,wN=dd.ReactCurrentBatchConfig,qh=0,Es=null,ca=null,Na=null,Bb=!1,F0=!1,yx=0,dre=0;function Ya(){throw Error(Bt(321))}function c6(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!jl(e[r],t[r]))return!1;return!0}function d6(e,t,r,s,a,i){if(qh=i,Es=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,nb.current=e===null||e.memoizedState===null?mre:pre,e=r(s,a),F0){i=0;do{if(F0=!1,yx=0,25<=i)throw Error(Bt(301));i+=1,Na=ca=null,t.updateQueue=null,nb.current=gre,e=r(s,a)}while(F0)}if(nb.current=$b,t=ca!==null&&ca.next!==null,qh=0,Na=ca=Es=null,Bb=!1,t)throw Error(Bt(300));return e}function u6(){var e=yx!==0;return yx=0,e}function Ul(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Na===null?Es.memoizedState=Na=e:Na=Na.next=e,Na}function Fo(){if(ca===null){var e=Es.alternate;e=e!==null?e.memoizedState:null}else e=ca.next;var t=Na===null?Es.memoizedState:Na.next;if(t!==null)Na=t,ca=e;else{if(e===null)throw Error(Bt(310));ca=e,e={memoizedState:ca.memoizedState,baseState:ca.baseState,baseQueue:ca.baseQueue,queue:ca.queue,next:null},Na===null?Es.memoizedState=Na=e:Na=Na.next=e}return Na}function bx(e,t){return typeof t=="function"?t(e):t}function _N(e){var t=Fo(),r=t.queue;if(r===null)throw Error(Bt(311));r.lastRenderedReducer=e;var s=ca,a=s.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}s.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,s=s.baseState;var l=o=null,d=null,c=i;do{var u=c.lane;if((qh&u)===u)d!==null&&(d=d.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:e(s,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};d===null?(l=d=h,o=s):d=d.next=h,Es.lanes|=u,Wh|=u}c=c.next}while(c!==null&&c!==i);d===null?o=s:d.next=l,jl(s,t.memoizedState)||(Mi=!0),t.memoizedState=s,t.baseState=o,t.baseQueue=d,r.lastRenderedState=s}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Es.lanes|=i,Wh|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function jN(e){var t=Fo(),r=t.queue;if(r===null)throw Error(Bt(311));r.lastRenderedReducer=e;var s=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);jl(i,t.memoizedState)||(Mi=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,s]}function N$(){}function S$(e,t){var r=Es,s=Fo(),a=t(),i=!jl(s.memoizedState,a);if(i&&(s.memoizedState=a,Mi=!0),s=s.queue,h6(k$.bind(null,r,s,e),[e]),s.getSnapshot!==t||i||Na!==null&&Na.memoizedState.tag&1){if(r.flags|=2048,wx(9,E$.bind(null,r,s,a,t),void 0,null),Ea===null)throw Error(Bt(349));qh&30||C$(r,t,a)}return a}function C$(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Es.updateQueue,t===null?(t={lastEffect:null,stores:null},Es.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function E$(e,t,r,s){t.value=r,t.getSnapshot=s,A$(t)&&T$(e)}function k$(e,t,r){return r(function(){A$(t)&&T$(e)})}function A$(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!jl(e,r)}catch{return!0}}function T$(e){var t=Zc(e,1);t!==null&&yl(t,e,1,-1)}function sP(e){var t=Ul();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bx,lastRenderedState:e},t.queue=e,e=e.dispatch=fre.bind(null,Es,e),[t.memoizedState,e]}function wx(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=Es.updateQueue,t===null?(t={lastEffect:null,stores:null},Es.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function P$(){return Fo().memoizedState}function sb(e,t,r,s){var a=Ul();Es.flags|=e,a.memoizedState=wx(1|t,r,void 0,s===void 0?null:s)}function q2(e,t,r,s){var a=Fo();s=s===void 0?null:s;var i=void 0;if(ca!==null){var o=ca.memoizedState;if(i=o.destroy,s!==null&&c6(s,o.deps)){a.memoizedState=wx(t,r,i,s);return}}Es.flags|=e,a.memoizedState=wx(1|t,r,i,s)}function aP(e,t){return sb(8390656,8,e,t)}function h6(e,t){return q2(2048,8,e,t)}function O$(e,t){return q2(4,2,e,t)}function R$(e,t){return q2(4,4,e,t)}function M$(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function I$(e,t,r){return r=r!=null?r.concat([e]):null,q2(4,4,M$.bind(null,t,e),r)}function f6(){}function D$(e,t){var r=Fo();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&c6(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function L$(e,t){var r=Fo();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&c6(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function B$(e,t,r){return qh&21?(jl(r,t)||(r=VB(),Es.lanes|=r,Wh|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Mi=!0),e.memoizedState=r)}function ure(e,t){var r=$n;$n=r!==0&&4>r?r:4,e(!0);var s=wN.transition;wN.transition={};try{e(!1),t()}finally{$n=r,wN.transition=s}}function $$(){return Fo().memoizedState}function hre(e,t,r){var s=cu(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},F$(e))z$(t,r);else if(r=w$(e,t,r,s),r!==null){var a=bi();yl(r,e,s,a),U$(r,t,s)}}function fre(e,t,r){var s=cu(e),a={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(F$(e))z$(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,r);if(a.hasEagerState=!0,a.eagerState=l,jl(l,o)){var d=t.interleaved;d===null?(a.next=a,s6(t)):(a.next=d.next,d.next=a),t.interleaved=a;return}}catch{}finally{}r=w$(e,t,a,s),r!==null&&(a=bi(),yl(r,e,s,a),U$(r,t,s))}}function F$(e){var t=e.alternate;return e===Es||t!==null&&t===Es}function z$(e,t){F0=Bb=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function U$(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,qE(e,r)}}var $b={readContext:$o,useCallback:Ya,useContext:Ya,useEffect:Ya,useImperativeHandle:Ya,useInsertionEffect:Ya,useLayoutEffect:Ya,useMemo:Ya,useReducer:Ya,useRef:Ya,useState:Ya,useDebugValue:Ya,useDeferredValue:Ya,useTransition:Ya,useMutableSource:Ya,useSyncExternalStore:Ya,useId:Ya,unstable_isNewReconciler:!1},mre={readContext:$o,useCallback:function(e,t){return Ul().memoizedState=[e,t===void 0?null:t],e},useContext:$o,useEffect:aP,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,sb(4194308,4,M$.bind(null,t,e),r)},useLayoutEffect:function(e,t){return sb(4194308,4,e,t)},useInsertionEffect:function(e,t){return sb(4,2,e,t)},useMemo:function(e,t){var r=Ul();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=Ul();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=hre.bind(null,Es,e),[s.memoizedState,e]},useRef:function(e){var t=Ul();return e={current:e},t.memoizedState=e},useState:sP,useDebugValue:f6,useDeferredValue:function(e){return Ul().memoizedState=e},useTransition:function(){var e=sP(!1),t=e[0];return e=ure.bind(null,e[1]),Ul().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=Es,a=Ul();if(ps){if(r===void 0)throw Error(Bt(407));r=r()}else{if(r=t(),Ea===null)throw Error(Bt(349));qh&30||C$(s,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,aP(k$.bind(null,s,i,e),[e]),s.flags|=2048,wx(9,E$.bind(null,s,i,r,t),void 0,null),r},useId:function(){var e=Ul(),t=Ea.identifierPrefix;if(ps){var r=Fc,s=$c;r=(s&~(1<<32-vl(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=yx++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=dre++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},pre={readContext:$o,useCallback:D$,useContext:$o,useEffect:h6,useImperativeHandle:I$,useInsertionEffect:O$,useLayoutEffect:R$,useMemo:L$,useReducer:_N,useRef:P$,useState:function(){return _N(bx)},useDebugValue:f6,useDeferredValue:function(e){var t=Fo();return B$(t,ca.memoizedState,e)},useTransition:function(){var e=_N(bx)[0],t=Fo().memoizedState;return[e,t]},useMutableSource:N$,useSyncExternalStore:S$,useId:$$,unstable_isNewReconciler:!1},gre={readContext:$o,useCallback:D$,useContext:$o,useEffect:h6,useImperativeHandle:I$,useInsertionEffect:O$,useLayoutEffect:R$,useMemo:L$,useReducer:jN,useRef:P$,useState:function(){return jN(bx)},useDebugValue:f6,useDeferredValue:function(e){var t=Fo();return ca===null?t.memoizedState=e:B$(t,ca.memoizedState,e)},useTransition:function(){var e=jN(bx)[0],t=Fo().memoizedState;return[e,t]},useMutableSource:N$,useSyncExternalStore:S$,useId:$$,unstable_isNewReconciler:!1};function il(e,t){if(e&&e.defaultProps){t=As({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function aS(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:As({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var W2={isMounted:function(e){return(e=e._reactInternals)?gf(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=bi(),a=cu(e),i=qc(s,a);i.payload=t,r!=null&&(i.callback=r),t=ou(e,i,a),t!==null&&(yl(t,e,a,s),rb(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=bi(),a=cu(e),i=qc(s,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=ou(e,i,a),t!==null&&(yl(t,e,a,s),rb(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=bi(),s=cu(e),a=qc(r,s);a.tag=2,t!=null&&(a.callback=t),t=ou(e,a,s),t!==null&&(yl(t,e,s,r),rb(t,e,s))}};function iP(e,t,r,s,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,i,o):t.prototype&&t.prototype.isPureReactComponent?!fx(r,s)||!fx(a,i):!0}function V$(e,t,r){var s=!1,a=vu,i=t.contextType;return typeof i=="object"&&i!==null?i=$o(i):(a=Fi(t)?Uh:oi.current,s=t.contextTypes,i=(s=s!=null)?ep(e,a):vu),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=W2,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function oP(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&W2.enqueueReplaceState(t,t.state,null)}function iS(e,t,r,s){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},a6(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=$o(i):(i=Fi(t)?Uh:oi.current,a.context=ep(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(aS(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&W2.enqueueReplaceState(a,a.state,null),Db(e,r,a,s),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function sp(e,t){try{var r="",s=t;do r+=qee(s),s=s.return;while(s);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function NN(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function oS(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var xre=typeof WeakMap=="function"?WeakMap:Map;function q$(e,t,r){r=qc(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){zb||(zb=!0,xS=s),oS(e,t)},r}function W$(e,t,r){r=qc(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var a=t.value;r.payload=function(){return s(a)},r.callback=function(){oS(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){oS(e,t),typeof s!="function"&&(lu===null?lu=new Set([this]):lu.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function lP(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new xre;var a=new Set;s.set(t,a)}else a=s.get(t),a===void 0&&(a=new Set,s.set(t,a));a.has(r)||(a.add(r),e=Pre.bind(null,e,t,r),t.then(e,e))}function cP(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function dP(e,t,r,s,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=qc(-1,1),t.tag=2,ou(r,t,1))),r.lanes|=1),e)}var vre=dd.ReactCurrentOwner,Mi=!1;function fi(e,t,r,s){t.child=e===null?b$(t,null,r,s):rp(t,e.child,r,s)}function uP(e,t,r,s,a){r=r.render;var i=t.ref;return Om(t,a),s=d6(e,t,r,s,i,a),r=u6(),e!==null&&!Mi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Qc(e,t,a)):(ps&&r&&QE(t),t.flags|=1,fi(e,t,s,a),t.child)}function hP(e,t,r,s,a){if(e===null){var i=r.type;return typeof i=="function"&&!w6(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,H$(e,t,i,s,a)):(e=lb(r.type,null,s,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:fx,r(o,s)&&e.ref===t.ref)return Qc(e,t,a)}return t.flags|=1,e=du(i,s),e.ref=t.ref,e.return=t,t.child=e}function H$(e,t,r,s,a){if(e!==null){var i=e.memoizedProps;if(fx(i,s)&&e.ref===t.ref)if(Mi=!1,t.pendingProps=s=i,(e.lanes&a)!==0)e.flags&131072&&(Mi=!0);else return t.lanes=e.lanes,Qc(e,t,a)}return lS(e,t,r,s,a)}function G$(e,t,r){var s=t.pendingProps,a=s.children,i=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ts(xm,to),to|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ts(xm,to),to|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:r,ts(xm,to),to|=s}else i!==null?(s=i.baseLanes|r,t.memoizedState=null):s=r,ts(xm,to),to|=s;return fi(e,t,a,r),t.child}function K$(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function lS(e,t,r,s,a){var i=Fi(r)?Uh:oi.current;return i=ep(t,i),Om(t,a),r=d6(e,t,r,s,i,a),s=u6(),e!==null&&!Mi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Qc(e,t,a)):(ps&&s&&QE(t),t.flags|=1,fi(e,t,r,a),t.child)}function fP(e,t,r,s,a){if(Fi(r)){var i=!0;Pb(t)}else i=!1;if(Om(t,a),t.stateNode===null)ab(e,t),V$(t,r,s),iS(t,r,s,a),s=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var d=o.context,c=r.contextType;typeof c=="object"&&c!==null?c=$o(c):(c=Fi(r)?Uh:oi.current,c=ep(t,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==s||d!==c)&&oP(t,o,s,c),Md=!1;var f=t.memoizedState;o.state=f,Db(t,s,o,a),d=t.memoizedState,l!==s||f!==d||$i.current||Md?(typeof u=="function"&&(aS(t,r,u,s),d=t.memoizedState),(l=Md||iP(t,r,l,s,f,d,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=d),o.props=s,o.state=d,o.context=c,s=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{o=t.stateNode,_$(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:il(t.type,l),o.props=c,h=t.pendingProps,f=o.context,d=r.contextType,typeof d=="object"&&d!==null?d=$o(d):(d=Fi(r)?Uh:oi.current,d=ep(t,d));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==d)&&oP(t,o,s,d),Md=!1,f=t.memoizedState,o.state=f,Db(t,s,o,a);var p=t.memoizedState;l!==h||f!==p||$i.current||Md?(typeof m=="function"&&(aS(t,r,m,s),p=t.memoizedState),(c=Md||iP(t,r,c,s,f,p,d)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,d),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,d)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=p),o.props=s,o.state=p,o.context=d,s=c):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),s=!1)}return cS(e,t,r,s,i,a)}function cS(e,t,r,s,a,i){K$(e,t);var o=(t.flags&128)!==0;if(!s&&!o)return a&&QT(t,r,!1),Qc(e,t,i);s=t.stateNode,vre.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&o?(t.child=rp(t,e.child,null,i),t.child=rp(t,null,l,i)):fi(e,t,l,i),t.memoizedState=s.state,a&&QT(t,r,!0),t.child}function X$(e){var t=e.stateNode;t.pendingContext?ZT(e,t.pendingContext,t.pendingContext!==t.context):t.context&&ZT(e,t.context,!1),i6(e,t.containerInfo)}function mP(e,t,r,s,a){return tp(),e6(a),t.flags|=256,fi(e,t,r,s),t.child}var dS={dehydrated:null,treeContext:null,retryLane:0};function uS(e){return{baseLanes:e,cachePool:null,transitions:null}}function Y$(e,t,r){var s=t.pendingProps,a=ws.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),ts(ws,a&1),e===null)return nS(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=s.children,e=s.fallback,i?(s=t.mode,i=t.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=K2(o,s,0,null),e=Ih(e,s,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=uS(r),t.memoizedState=dS,e):m6(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return yre(e,t,o,s,l,a,r);if(i){i=s.fallback,o=t.mode,a=e.child,l=a.sibling;var d={mode:"hidden",children:s.children};return!(o&1)&&t.child!==a?(s=t.child,s.childLanes=0,s.pendingProps=d,t.deletions=null):(s=du(a,d),s.subtreeFlags=a.subtreeFlags&14680064),l!==null?i=du(l,i):(i=Ih(i,o,r,null),i.flags|=2),i.return=t,s.return=t,s.sibling=i,t.child=s,s=i,i=t.child,o=e.child.memoizedState,o=o===null?uS(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=dS,s}return i=e.child,e=i.sibling,s=du(i,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function m6(e,t){return t=K2({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Q1(e,t,r,s){return s!==null&&e6(s),rp(t,e.child,null,r),e=m6(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function yre(e,t,r,s,a,i,o){if(r)return t.flags&256?(t.flags&=-257,s=NN(Error(Bt(422))),Q1(e,t,o,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=s.fallback,a=t.mode,s=K2({mode:"visible",children:s.children},a,0,null),i=Ih(i,a,o,null),i.flags|=2,s.return=t,i.return=t,s.sibling=i,t.child=s,t.mode&1&&rp(t,e.child,null,o),t.child.memoizedState=uS(o),t.memoizedState=dS,i);if(!(t.mode&1))return Q1(e,t,o,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var l=s.dgst;return s=l,i=Error(Bt(419)),s=NN(i,s,void 0),Q1(e,t,o,s)}if(l=(o&e.childLanes)!==0,Mi||l){if(s=Ea,s!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,Zc(e,a),yl(s,e,a,-1))}return b6(),s=NN(Error(Bt(421))),Q1(e,t,o,s)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Ore.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,co=iu(a.nextSibling),uo=t,ps=!0,ml=null,e!==null&&(Ao[To++]=$c,Ao[To++]=Fc,Ao[To++]=Vh,$c=e.id,Fc=e.overflow,Vh=t),t=m6(t,s.children),t.flags|=4096,t)}function pP(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),sS(e.return,t,r)}function SN(e,t,r,s,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=r,i.tailMode=a)}function Z$(e,t,r){var s=t.pendingProps,a=s.revealOrder,i=s.tail;if(fi(e,t,s.children,r),s=ws.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&pP(e,r,t);else if(e.tag===19)pP(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(ts(ws,s),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&Lb(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),SN(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&Lb(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}SN(t,!0,r,null,i);break;case"together":SN(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ab(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Qc(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Wh|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Bt(153));if(t.child!==null){for(e=t.child,r=du(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=du(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function bre(e,t,r){switch(t.tag){case 3:X$(t),tp();break;case 5:j$(t);break;case 1:Fi(t.type)&&Pb(t);break;case 4:i6(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,a=t.memoizedProps.value;ts(Mb,s._currentValue),s._currentValue=a;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(ts(ws,ws.current&1),t.flags|=128,null):r&t.child.childLanes?Y$(e,t,r):(ts(ws,ws.current&1),e=Qc(e,t,r),e!==null?e.sibling:null);ts(ws,ws.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return Z$(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ts(ws,ws.current),s)break;return null;case 22:case 23:return t.lanes=0,G$(e,t,r)}return Qc(e,t,r)}var Q$,hS,J$,eF;Q$=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};hS=function(){};J$=function(e,t,r,s){var a=e.memoizedProps;if(a!==s){e=t.stateNode,yh(sc.current);var i=null;switch(r){case"input":a=M4(e,a),s=M4(e,s),i=[];break;case"select":a=As({},a,{value:void 0}),s=As({},s,{value:void 0}),i=[];break;case"textarea":a=L4(e,a),s=L4(e,s),i=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Ab)}$4(r,s);var o;r=null;for(c in a)if(!s.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var l=a[c];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ix.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in s){var d=s[c];if(l=a!=null?a[c]:void 0,s.hasOwnProperty(c)&&d!==l&&(d!=null||l!=null))if(c==="style")if(l){for(o in l)!l.hasOwnProperty(o)||d&&d.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in d)d.hasOwnProperty(o)&&l[o]!==d[o]&&(r||(r={}),r[o]=d[o])}else r||(i||(i=[]),i.push(c,r)),r=d;else c==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,l=l?l.__html:void 0,d!=null&&l!==d&&(i=i||[]).push(c,d)):c==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(c,""+d):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ix.hasOwnProperty(c)?(d!=null&&c==="onScroll"&&os("scroll",e),i||l===d||(i=[])):(i=i||[]).push(c,d))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}};eF=function(e,t,r,s){r!==s&&(t.flags|=4)};function Xg(e,t){if(!ps)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Za(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function wre(e,t,r){var s=t.pendingProps;switch(JE(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Za(t),null;case 1:return Fi(t.type)&&Tb(),Za(t),null;case 3:return s=t.stateNode,np(),us($i),us(oi),l6(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(Y1(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ml!==null&&(bS(ml),ml=null))),hS(e,t),Za(t),null;case 5:o6(t);var a=yh(vx.current);if(r=t.type,e!==null&&t.stateNode!=null)J$(e,t,r,s,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(Bt(166));return Za(t),null}if(e=yh(sc.current),Y1(t)){s=t.stateNode,r=t.type;var i=t.memoizedProps;switch(s[Gl]=t,s[gx]=i,e=(t.mode&1)!==0,r){case"dialog":os("cancel",s),os("close",s);break;case"iframe":case"object":case"embed":os("load",s);break;case"video":case"audio":for(a=0;a<S0.length;a++)os(S0[a],s);break;case"source":os("error",s);break;case"img":case"image":case"link":os("error",s),os("load",s);break;case"details":os("toggle",s);break;case"input":NT(s,i),os("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},os("invalid",s);break;case"textarea":CT(s,i),os("invalid",s)}$4(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?s.textContent!==l&&(i.suppressHydrationWarning!==!0&&X1(s.textContent,l,e),a=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&X1(s.textContent,l,e),a=["children",""+l]):ix.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&os("scroll",s)}switch(r){case"input":z1(s),ST(s,i,!0);break;case"textarea":z1(s),ET(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=Ab)}s=a,t.updateQueue=s,s!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kB(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=o.createElement(r,{is:s.is}):(e=o.createElement(r),r==="select"&&(o=e,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):e=o.createElementNS(e,r),e[Gl]=t,e[gx]=s,Q$(e,t,!1,!1),t.stateNode=e;e:{switch(o=F4(r,s),r){case"dialog":os("cancel",e),os("close",e),a=s;break;case"iframe":case"object":case"embed":os("load",e),a=s;break;case"video":case"audio":for(a=0;a<S0.length;a++)os(S0[a],e);a=s;break;case"source":os("error",e),a=s;break;case"img":case"image":case"link":os("error",e),os("load",e),a=s;break;case"details":os("toggle",e),a=s;break;case"input":NT(e,s),a=M4(e,s),os("invalid",e);break;case"option":a=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},a=As({},s,{value:void 0}),os("invalid",e);break;case"textarea":CT(e,s),a=L4(e,s),os("invalid",e);break;default:a=s}$4(r,a),l=a;for(i in l)if(l.hasOwnProperty(i)){var d=l[i];i==="style"?PB(e,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&AB(e,d)):i==="children"?typeof d=="string"?(r!=="textarea"||d!=="")&&ox(e,d):typeof d=="number"&&ox(e,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ix.hasOwnProperty(i)?d!=null&&i==="onScroll"&&os("scroll",e):d!=null&&BE(e,i,d,o))}switch(r){case"input":z1(e),ST(e,s,!1);break;case"textarea":z1(e),ET(e);break;case"option":s.value!=null&&e.setAttribute("value",""+xu(s.value));break;case"select":e.multiple=!!s.multiple,i=s.value,i!=null?km(e,!!s.multiple,i,!1):s.defaultValue!=null&&km(e,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Ab)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Za(t),null;case 6:if(e&&t.stateNode!=null)eF(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(Bt(166));if(r=yh(vx.current),yh(sc.current),Y1(t)){if(s=t.stateNode,r=t.memoizedProps,s[Gl]=t,(i=s.nodeValue!==r)&&(e=uo,e!==null))switch(e.tag){case 3:X1(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&X1(s.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[Gl]=t,t.stateNode=s}return Za(t),null;case 13:if(us(ws),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ps&&co!==null&&t.mode&1&&!(t.flags&128))v$(),tp(),t.flags|=98560,i=!1;else if(i=Y1(t),s!==null&&s.dehydrated!==null){if(e===null){if(!i)throw Error(Bt(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Bt(317));i[Gl]=t}else tp(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Za(t),i=!1}else ml!==null&&(bS(ml),ml=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||ws.current&1?da===0&&(da=3):b6())),t.updateQueue!==null&&(t.flags|=4),Za(t),null);case 4:return np(),hS(e,t),e===null&&mx(t.stateNode.containerInfo),Za(t),null;case 10:return n6(t.type._context),Za(t),null;case 17:return Fi(t.type)&&Tb(),Za(t),null;case 19:if(us(ws),i=t.memoizedState,i===null)return Za(t),null;if(s=(t.flags&128)!==0,o=i.rendering,o===null)if(s)Xg(i,!1);else{if(da!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Lb(e),o!==null){for(t.flags|=128,Xg(i,!1),s=o.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)i=r,e=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ts(ws,ws.current&1|2),t.child}e=e.sibling}i.tail!==null&&zs()>ap&&(t.flags|=128,s=!0,Xg(i,!1),t.lanes=4194304)}else{if(!s)if(e=Lb(o),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Xg(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ps)return Za(t),null}else 2*zs()-i.renderingStartTime>ap&&r!==1073741824&&(t.flags|=128,s=!0,Xg(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=zs(),t.sibling=null,r=ws.current,ts(ws,s?r&1|2:r&1),t):(Za(t),null);case 22:case 23:return y6(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?to&1073741824&&(Za(t),t.subtreeFlags&6&&(t.flags|=8192)):Za(t),null;case 24:return null;case 25:return null}throw Error(Bt(156,t.tag))}function _re(e,t){switch(JE(t),t.tag){case 1:return Fi(t.type)&&Tb(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return np(),us($i),us(oi),l6(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return o6(t),null;case 13:if(us(ws),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Bt(340));tp()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return us(ws),null;case 4:return np(),null;case 10:return n6(t.type._context),null;case 22:case 23:return y6(),null;case 24:return null;default:return null}}var J1=!1,ti=!1,jre=typeof WeakSet=="function"?WeakSet:Set,cr=null;function gm(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Ls(e,t,s)}else r.current=null}function fS(e,t,r){try{r()}catch(s){Ls(e,t,s)}}var gP=!1;function Nre(e,t){if(Y4=Cb,e=a$(),ZE(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var a=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,l=-1,d=-1,c=0,u=0,h=e,f=null;t:for(;;){for(var m;h!==r||a!==0&&h.nodeType!==3||(l=o+a),h!==i||s!==0&&h.nodeType!==3||(d=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===e)break t;if(f===r&&++c===a&&(l=o),f===i&&++u===s&&(d=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}r=l===-1||d===-1?null:{start:l,end:d}}else r=null}r=r||{start:0,end:0}}else r=null;for(Z4={focusedElem:e,selectionRange:r},Cb=!1,cr=t;cr!==null;)if(t=cr,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,cr=e;else for(;cr!==null;){t=cr;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,x=p.memoizedState,v=t.stateNode,y=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:il(t.type,g),x);v.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Bt(163))}}catch(j){Ls(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,cr=e;break}cr=t.return}return p=gP,gP=!1,p}function z0(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&fS(t,r,i)}a=a.next}while(a!==s)}}function H2(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function mS(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function tF(e){var t=e.alternate;t!==null&&(e.alternate=null,tF(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gl],delete t[gx],delete t[eS],delete t[ire],delete t[ore])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function rF(e){return e.tag===5||e.tag===3||e.tag===4}function xP(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||rF(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function pS(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Ab));else if(s!==4&&(e=e.child,e!==null))for(pS(e,t,r),e=e.sibling;e!==null;)pS(e,t,r),e=e.sibling}function gS(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(gS(e,t,r),e=e.sibling;e!==null;)gS(e,t,r),e=e.sibling}var La=null,ul=!1;function Nd(e,t,r){for(r=r.child;r!==null;)nF(e,t,r),r=r.sibling}function nF(e,t,r){if(nc&&typeof nc.onCommitFiberUnmount=="function")try{nc.onCommitFiberUnmount(B2,r)}catch{}switch(r.tag){case 5:ti||gm(r,t);case 6:var s=La,a=ul;La=null,Nd(e,t,r),La=s,ul=a,La!==null&&(ul?(e=La,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):La.removeChild(r.stateNode));break;case 18:La!==null&&(ul?(e=La,r=r.stateNode,e.nodeType===8?vN(e.parentNode,r):e.nodeType===1&&vN(e,r),ux(e)):vN(La,r.stateNode));break;case 4:s=La,a=ul,La=r.stateNode.containerInfo,ul=!0,Nd(e,t,r),La=s,ul=a;break;case 0:case 11:case 14:case 15:if(!ti&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&fS(r,t,o),a=a.next}while(a!==s)}Nd(e,t,r);break;case 1:if(!ti&&(gm(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(l){Ls(r,t,l)}Nd(e,t,r);break;case 21:Nd(e,t,r);break;case 22:r.mode&1?(ti=(s=ti)||r.memoizedState!==null,Nd(e,t,r),ti=s):Nd(e,t,r);break;default:Nd(e,t,r)}}function vP(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new jre),t.forEach(function(s){var a=Rre.bind(null,e,s);r.has(s)||(r.add(s),s.then(a,a))})}}function Jo(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var a=r[s];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:La=l.stateNode,ul=!1;break e;case 3:La=l.stateNode.containerInfo,ul=!0;break e;case 4:La=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(La===null)throw Error(Bt(160));nF(i,o,a),La=null,ul=!1;var d=a.alternate;d!==null&&(d.return=null),a.return=null}catch(c){Ls(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)sF(t,e),t=t.sibling}function sF(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Jo(t,e),Fl(e),s&4){try{z0(3,e,e.return),H2(3,e)}catch(g){Ls(e,e.return,g)}try{z0(5,e,e.return)}catch(g){Ls(e,e.return,g)}}break;case 1:Jo(t,e),Fl(e),s&512&&r!==null&&gm(r,r.return);break;case 5:if(Jo(t,e),Fl(e),s&512&&r!==null&&gm(r,r.return),e.flags&32){var a=e.stateNode;try{ox(a,"")}catch(g){Ls(e,e.return,g)}}if(s&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,l=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&CB(a,i),F4(l,o);var c=F4(l,i);for(o=0;o<d.length;o+=2){var u=d[o],h=d[o+1];u==="style"?PB(a,h):u==="dangerouslySetInnerHTML"?AB(a,h):u==="children"?ox(a,h):BE(a,u,h,c)}switch(l){case"input":I4(a,i);break;case"textarea":EB(a,i);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?km(a,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?km(a,!!i.multiple,i.defaultValue,!0):km(a,!!i.multiple,i.multiple?[]:"",!1))}a[gx]=i}catch(g){Ls(e,e.return,g)}}break;case 6:if(Jo(t,e),Fl(e),s&4){if(e.stateNode===null)throw Error(Bt(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){Ls(e,e.return,g)}}break;case 3:if(Jo(t,e),Fl(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{ux(t.containerInfo)}catch(g){Ls(e,e.return,g)}break;case 4:Jo(t,e),Fl(e);break;case 13:Jo(t,e),Fl(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(x6=zs())),s&4&&vP(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(ti=(c=ti)||u,Jo(t,e),ti=c):Jo(t,e),Fl(e),s&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(cr=e,u=e.child;u!==null;){for(h=cr=u;cr!==null;){switch(f=cr,m=f.child,f.tag){case 0:case 11:case 14:case 15:z0(4,f,f.return);break;case 1:gm(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){s=f,r=f.return;try{t=s,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){Ls(s,r,g)}}break;case 5:gm(f,f.return);break;case 22:if(f.memoizedState!==null){bP(h);continue}}m!==null?(m.return=f,cr=m):bP(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{a=h.stateNode,c?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,d=h.memoizedProps.style,o=d!=null&&d.hasOwnProperty("display")?d.display:null,l.style.display=TB("display",o))}catch(g){Ls(e,e.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){Ls(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Jo(t,e),Fl(e),s&4&&vP(e);break;case 21:break;default:Jo(t,e),Fl(e)}}function Fl(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(rF(r)){var s=r;break e}r=r.return}throw Error(Bt(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(ox(a,""),s.flags&=-33);var i=xP(e);gS(e,i,a);break;case 3:case 4:var o=s.stateNode.containerInfo,l=xP(e);pS(e,l,o);break;default:throw Error(Bt(161))}}catch(d){Ls(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Sre(e,t,r){cr=e,aF(e)}function aF(e,t,r){for(var s=(e.mode&1)!==0;cr!==null;){var a=cr,i=a.child;if(a.tag===22&&s){var o=a.memoizedState!==null||J1;if(!o){var l=a.alternate,d=l!==null&&l.memoizedState!==null||ti;l=J1;var c=ti;if(J1=o,(ti=d)&&!c)for(cr=a;cr!==null;)o=cr,d=o.child,o.tag===22&&o.memoizedState!==null?wP(a):d!==null?(d.return=o,cr=d):wP(a);for(;i!==null;)cr=i,aF(i),i=i.sibling;cr=a,J1=l,ti=c}yP(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,cr=i):yP(e)}}function yP(e){for(;cr!==null;){var t=cr;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ti||H2(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!ti)if(r===null)s.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:il(t.type,r.memoizedProps);s.componentDidUpdate(a,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&nP(t,i,s);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}nP(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&r.focus();break;case"img":d.src&&(r.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&ux(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Bt(163))}ti||t.flags&512&&mS(t)}catch(f){Ls(t,t.return,f)}}if(t===e){cr=null;break}if(r=t.sibling,r!==null){r.return=t.return,cr=r;break}cr=t.return}}function bP(e){for(;cr!==null;){var t=cr;if(t===e){cr=null;break}var r=t.sibling;if(r!==null){r.return=t.return,cr=r;break}cr=t.return}}function wP(e){for(;cr!==null;){var t=cr;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{H2(4,t)}catch(d){Ls(t,r,d)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var a=t.return;try{s.componentDidMount()}catch(d){Ls(t,a,d)}}var i=t.return;try{mS(t)}catch(d){Ls(t,i,d)}break;case 5:var o=t.return;try{mS(t)}catch(d){Ls(t,o,d)}}}catch(d){Ls(t,t.return,d)}if(t===e){cr=null;break}var l=t.sibling;if(l!==null){l.return=t.return,cr=l;break}cr=t.return}}var Cre=Math.ceil,Fb=dd.ReactCurrentDispatcher,p6=dd.ReactCurrentOwner,Io=dd.ReactCurrentBatchConfig,Nn=0,Ea=null,Ys=null,Ua=0,to=0,xm=Tu(0),da=0,_x=null,Wh=0,G2=0,g6=0,U0=null,Pi=null,x6=0,ap=1/0,Ic=null,zb=!1,xS=null,lu=null,ey=!1,Kd=null,Ub=0,V0=0,vS=null,ib=-1,ob=0;function bi(){return Nn&6?zs():ib!==-1?ib:ib=zs()}function cu(e){return e.mode&1?Nn&2&&Ua!==0?Ua&-Ua:cre.transition!==null?(ob===0&&(ob=VB()),ob):(e=$n,e!==0||(e=window.event,e=e===void 0?16:YB(e.type)),e):1}function yl(e,t,r,s){if(50<V0)throw V0=0,vS=null,Error(Bt(185));Uv(e,r,s),(!(Nn&2)||e!==Ea)&&(e===Ea&&(!(Nn&2)&&(G2|=r),da===4&&$d(e,Ua)),zi(e,s),r===1&&Nn===0&&!(t.mode&1)&&(ap=zs()+500,V2&&Pu()))}function zi(e,t){var r=e.callbackNode;cte(e,t);var s=Sb(e,e===Ea?Ua:0);if(s===0)r!==null&&TT(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&TT(r),t===1)e.tag===0?lre(_P.bind(null,e)):p$(_P.bind(null,e)),sre(function(){!(Nn&6)&&Pu()}),r=null;else{switch(qB(s)){case 1:r=VE;break;case 4:r=zB;break;case 16:r=Nb;break;case 536870912:r=UB;break;default:r=Nb}r=fF(r,iF.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function iF(e,t){if(ib=-1,ob=0,Nn&6)throw Error(Bt(327));var r=e.callbackNode;if(Rm()&&e.callbackNode!==r)return null;var s=Sb(e,e===Ea?Ua:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=Vb(e,s);else{t=s;var a=Nn;Nn|=2;var i=lF();(Ea!==e||Ua!==t)&&(Ic=null,ap=zs()+500,Mh(e,t));do try{Are();break}catch(l){oF(e,l)}while(!0);r6(),Fb.current=i,Nn=a,Ys!==null?t=0:(Ea=null,Ua=0,t=da)}if(t!==0){if(t===2&&(a=W4(e),a!==0&&(s=a,t=yS(e,a))),t===1)throw r=_x,Mh(e,0),$d(e,s),zi(e,zs()),r;if(t===6)$d(e,s);else{if(a=e.current.alternate,!(s&30)&&!Ere(a)&&(t=Vb(e,s),t===2&&(i=W4(e),i!==0&&(s=i,t=yS(e,i))),t===1))throw r=_x,Mh(e,0),$d(e,s),zi(e,zs()),r;switch(e.finishedWork=a,e.finishedLanes=s,t){case 0:case 1:throw Error(Bt(345));case 2:lh(e,Pi,Ic);break;case 3:if($d(e,s),(s&130023424)===s&&(t=x6+500-zs(),10<t)){if(Sb(e,0)!==0)break;if(a=e.suspendedLanes,(a&s)!==s){bi(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=J4(lh.bind(null,e,Pi,Ic),t);break}lh(e,Pi,Ic);break;case 4:if($d(e,s),(s&4194240)===s)break;for(t=e.eventTimes,a=-1;0<s;){var o=31-vl(s);i=1<<o,o=t[o],o>a&&(a=o),s&=~i}if(s=a,s=zs()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*Cre(s/1960))-s,10<s){e.timeoutHandle=J4(lh.bind(null,e,Pi,Ic),s);break}lh(e,Pi,Ic);break;case 5:lh(e,Pi,Ic);break;default:throw Error(Bt(329))}}}return zi(e,zs()),e.callbackNode===r?iF.bind(null,e):null}function yS(e,t){var r=U0;return e.current.memoizedState.isDehydrated&&(Mh(e,t).flags|=256),e=Vb(e,t),e!==2&&(t=Pi,Pi=r,t!==null&&bS(t)),e}function bS(e){Pi===null?Pi=e:Pi.push.apply(Pi,e)}function Ere(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var a=r[s],i=a.getSnapshot;a=a.value;try{if(!jl(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function $d(e,t){for(t&=~g6,t&=~G2,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-vl(t),s=1<<r;e[r]=-1,t&=~s}}function _P(e){if(Nn&6)throw Error(Bt(327));Rm();var t=Sb(e,0);if(!(t&1))return zi(e,zs()),null;var r=Vb(e,t);if(e.tag!==0&&r===2){var s=W4(e);s!==0&&(t=s,r=yS(e,s))}if(r===1)throw r=_x,Mh(e,0),$d(e,t),zi(e,zs()),r;if(r===6)throw Error(Bt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,lh(e,Pi,Ic),zi(e,zs()),null}function v6(e,t){var r=Nn;Nn|=1;try{return e(t)}finally{Nn=r,Nn===0&&(ap=zs()+500,V2&&Pu())}}function Hh(e){Kd!==null&&Kd.tag===0&&!(Nn&6)&&Rm();var t=Nn;Nn|=1;var r=Io.transition,s=$n;try{if(Io.transition=null,$n=1,e)return e()}finally{$n=s,Io.transition=r,Nn=t,!(Nn&6)&&Pu()}}function y6(){to=xm.current,us(xm)}function Mh(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,nre(r)),Ys!==null)for(r=Ys.return;r!==null;){var s=r;switch(JE(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Tb();break;case 3:np(),us($i),us(oi),l6();break;case 5:o6(s);break;case 4:np();break;case 13:us(ws);break;case 19:us(ws);break;case 10:n6(s.type._context);break;case 22:case 23:y6()}r=r.return}if(Ea=e,Ys=e=du(e.current,null),Ua=to=t,da=0,_x=null,g6=G2=Wh=0,Pi=U0=null,vh!==null){for(t=0;t<vh.length;t++)if(r=vh[t],s=r.interleaved,s!==null){r.interleaved=null;var a=s.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,s.next=o}r.pending=s}vh=null}return e}function oF(e,t){do{var r=Ys;try{if(r6(),nb.current=$b,Bb){for(var s=Es.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Bb=!1}if(qh=0,Na=ca=Es=null,F0=!1,yx=0,p6.current=null,r===null||r.return===null){da=1,_x=t,Ys=null;break}e:{var i=e,o=r.return,l=r,d=t;if(t=Ua,l.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var c=d,u=l,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=cP(o);if(m!==null){m.flags&=-257,dP(m,o,l,i,t),m.mode&1&&lP(i,c,t),t=m,d=c;var p=t.updateQueue;if(p===null){var g=new Set;g.add(d),t.updateQueue=g}else p.add(d);break e}else{if(!(t&1)){lP(i,c,t),b6();break e}d=Error(Bt(426))}}else if(ps&&l.mode&1){var x=cP(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),dP(x,o,l,i,t),e6(sp(d,l));break e}}i=d=sp(d,l),da!==4&&(da=2),U0===null?U0=[i]:U0.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=q$(i,d,t);rP(i,v);break e;case 1:l=d;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(lu===null||!lu.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=W$(i,l,t);rP(i,j);break e}}i=i.return}while(i!==null)}dF(r)}catch(T){t=T,Ys===r&&r!==null&&(Ys=r=r.return);continue}break}while(!0)}function lF(){var e=Fb.current;return Fb.current=$b,e===null?$b:e}function b6(){(da===0||da===3||da===2)&&(da=4),Ea===null||!(Wh&268435455)&&!(G2&268435455)||$d(Ea,Ua)}function Vb(e,t){var r=Nn;Nn|=2;var s=lF();(Ea!==e||Ua!==t)&&(Ic=null,Mh(e,t));do try{kre();break}catch(a){oF(e,a)}while(!0);if(r6(),Nn=r,Fb.current=s,Ys!==null)throw Error(Bt(261));return Ea=null,Ua=0,da}function kre(){for(;Ys!==null;)cF(Ys)}function Are(){for(;Ys!==null&&!ete();)cF(Ys)}function cF(e){var t=hF(e.alternate,e,to);e.memoizedProps=e.pendingProps,t===null?dF(e):Ys=t,p6.current=null}function dF(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=_re(r,t),r!==null){r.flags&=32767,Ys=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{da=6,Ys=null;return}}else if(r=wre(r,t,to),r!==null){Ys=r;return}if(t=t.sibling,t!==null){Ys=t;return}Ys=t=e}while(t!==null);da===0&&(da=5)}function lh(e,t,r){var s=$n,a=Io.transition;try{Io.transition=null,$n=1,Tre(e,t,r,s)}finally{Io.transition=a,$n=s}return null}function Tre(e,t,r,s){do Rm();while(Kd!==null);if(Nn&6)throw Error(Bt(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Bt(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(dte(e,i),e===Ea&&(Ys=Ea=null,Ua=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ey||(ey=!0,fF(Nb,function(){return Rm(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Io.transition,Io.transition=null;var o=$n;$n=1;var l=Nn;Nn|=4,p6.current=null,Nre(e,r),sF(r,e),Yte(Z4),Cb=!!Y4,Z4=Y4=null,e.current=r,Sre(r),tte(),Nn=l,$n=o,Io.transition=i}else e.current=r;if(ey&&(ey=!1,Kd=e,Ub=a),i=e.pendingLanes,i===0&&(lu=null),ste(r.stateNode),zi(e,zs()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],s(a.value,{componentStack:a.stack,digest:a.digest});if(zb)throw zb=!1,e=xS,xS=null,e;return Ub&1&&e.tag!==0&&Rm(),i=e.pendingLanes,i&1?e===vS?V0++:(V0=0,vS=e):V0=0,Pu(),null}function Rm(){if(Kd!==null){var e=qB(Ub),t=Io.transition,r=$n;try{if(Io.transition=null,$n=16>e?16:e,Kd===null)var s=!1;else{if(e=Kd,Kd=null,Ub=0,Nn&6)throw Error(Bt(331));var a=Nn;for(Nn|=4,cr=e.current;cr!==null;){var i=cr,o=i.child;if(cr.flags&16){var l=i.deletions;if(l!==null){for(var d=0;d<l.length;d++){var c=l[d];for(cr=c;cr!==null;){var u=cr;switch(u.tag){case 0:case 11:case 15:z0(8,u,i)}var h=u.child;if(h!==null)h.return=u,cr=h;else for(;cr!==null;){u=cr;var f=u.sibling,m=u.return;if(tF(u),u===c){cr=null;break}if(f!==null){f.return=m,cr=f;break}cr=m}}}var p=i.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var x=g.sibling;g.sibling=null,g=x}while(g!==null)}}cr=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,cr=o;else e:for(;cr!==null;){if(i=cr,i.flags&2048)switch(i.tag){case 0:case 11:case 15:z0(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,cr=v;break e}cr=i.return}}var y=e.current;for(cr=y;cr!==null;){o=cr;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,cr=b;else e:for(o=y;cr!==null;){if(l=cr,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:H2(9,l)}}catch(T){Ls(l,l.return,T)}if(l===o){cr=null;break e}var j=l.sibling;if(j!==null){j.return=l.return,cr=j;break e}cr=l.return}}if(Nn=a,Pu(),nc&&typeof nc.onPostCommitFiberRoot=="function")try{nc.onPostCommitFiberRoot(B2,e)}catch{}s=!0}return s}finally{$n=r,Io.transition=t}}return!1}function jP(e,t,r){t=sp(r,t),t=q$(e,t,1),e=ou(e,t,1),t=bi(),e!==null&&(Uv(e,1,t),zi(e,t))}function Ls(e,t,r){if(e.tag===3)jP(e,e,r);else for(;t!==null;){if(t.tag===3){jP(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(lu===null||!lu.has(s))){e=sp(r,e),e=W$(t,e,1),t=ou(t,e,1),e=bi(),t!==null&&(Uv(t,1,e),zi(t,e));break}}t=t.return}}function Pre(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=bi(),e.pingedLanes|=e.suspendedLanes&r,Ea===e&&(Ua&r)===r&&(da===4||da===3&&(Ua&130023424)===Ua&&500>zs()-x6?Mh(e,0):g6|=r),zi(e,t)}function uF(e,t){t===0&&(e.mode&1?(t=q1,q1<<=1,!(q1&130023424)&&(q1=4194304)):t=1);var r=bi();e=Zc(e,t),e!==null&&(Uv(e,t,r),zi(e,r))}function Ore(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),uF(e,r)}function Rre(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(Bt(314))}s!==null&&s.delete(t),uF(e,r)}var hF;hF=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||$i.current)Mi=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Mi=!1,bre(e,t,r);Mi=!!(e.flags&131072)}else Mi=!1,ps&&t.flags&1048576&&g$(t,Rb,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;ab(e,t),e=t.pendingProps;var a=ep(t,oi.current);Om(t,r),a=d6(null,t,s,e,a,r);var i=u6();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Fi(s)?(i=!0,Pb(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a6(t),a.updater=W2,t.stateNode=a,a._reactInternals=t,iS(t,s,e,r),t=cS(null,t,s,!0,i,r)):(t.tag=0,ps&&i&&QE(t),fi(null,t,a,r),t=t.child),t;case 16:s=t.elementType;e:{switch(ab(e,t),e=t.pendingProps,a=s._init,s=a(s._payload),t.type=s,a=t.tag=Ire(s),e=il(s,e),a){case 0:t=lS(null,t,s,e,r);break e;case 1:t=fP(null,t,s,e,r);break e;case 11:t=uP(null,t,s,e,r);break e;case 14:t=hP(null,t,s,il(s.type,e),r);break e}throw Error(Bt(306,s,""))}return t;case 0:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:il(s,a),lS(e,t,s,a,r);case 1:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:il(s,a),fP(e,t,s,a,r);case 3:e:{if(X$(t),e===null)throw Error(Bt(387));s=t.pendingProps,i=t.memoizedState,a=i.element,_$(e,t),Db(t,s,null,r);var o=t.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=sp(Error(Bt(423)),t),t=mP(e,t,s,r,a);break e}else if(s!==a){a=sp(Error(Bt(424)),t),t=mP(e,t,s,r,a);break e}else for(co=iu(t.stateNode.containerInfo.firstChild),uo=t,ps=!0,ml=null,r=b$(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(tp(),s===a){t=Qc(e,t,r);break e}fi(e,t,s,r)}t=t.child}return t;case 5:return j$(t),e===null&&nS(t),s=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,Q4(s,a)?o=null:i!==null&&Q4(s,i)&&(t.flags|=32),K$(e,t),fi(e,t,o,r),t.child;case 6:return e===null&&nS(t),null;case 13:return Y$(e,t,r);case 4:return i6(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=rp(t,null,s,r):fi(e,t,s,r),t.child;case 11:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:il(s,a),uP(e,t,s,a,r);case 7:return fi(e,t,t.pendingProps,r),t.child;case 8:return fi(e,t,t.pendingProps.children,r),t.child;case 12:return fi(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,ts(Mb,s._currentValue),s._currentValue=o,i!==null)if(jl(i.value,o)){if(i.children===a.children&&!$i.current){t=Qc(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var d=l.firstContext;d!==null;){if(d.context===s){if(i.tag===1){d=qc(-1,r&-r),d.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?d.next=d:(d.next=u.next,u.next=d),c.pending=d}}i.lanes|=r,d=i.alternate,d!==null&&(d.lanes|=r),sS(i.return,r,t),l.lanes|=r;break}d=d.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Bt(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),sS(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}fi(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,s=t.pendingProps.children,Om(t,r),a=$o(a),s=s(a),t.flags|=1,fi(e,t,s,r),t.child;case 14:return s=t.type,a=il(s,t.pendingProps),a=il(s.type,a),hP(e,t,s,a,r);case 15:return H$(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:il(s,a),ab(e,t),t.tag=1,Fi(s)?(e=!0,Pb(t)):e=!1,Om(t,r),V$(t,s,a),iS(t,s,a,r),cS(null,t,s,!0,e,r);case 19:return Z$(e,t,r);case 22:return G$(e,t,r)}throw Error(Bt(156,t.tag))};function fF(e,t){return FB(e,t)}function Mre(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oo(e,t,r,s){return new Mre(e,t,r,s)}function w6(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Ire(e){if(typeof e=="function")return w6(e)?1:0;if(e!=null){if(e=e.$$typeof,e===FE)return 11;if(e===zE)return 14}return 2}function du(e,t){var r=e.alternate;return r===null?(r=Oo(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function lb(e,t,r,s,a,i){var o=2;if(s=e,typeof e=="function")w6(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case om:return Ih(r.children,a,i,t);case $E:o=8,a|=8;break;case T4:return e=Oo(12,r,t,a|2),e.elementType=T4,e.lanes=i,e;case P4:return e=Oo(13,r,t,a),e.elementType=P4,e.lanes=i,e;case O4:return e=Oo(19,r,t,a),e.elementType=O4,e.lanes=i,e;case jB:return K2(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case wB:o=10;break e;case _B:o=9;break e;case FE:o=11;break e;case zE:o=14;break e;case Rd:o=16,s=null;break e}throw Error(Bt(130,e==null?e:typeof e,""))}return t=Oo(o,r,t,a),t.elementType=e,t.type=s,t.lanes=i,t}function Ih(e,t,r,s){return e=Oo(7,e,s,t),e.lanes=r,e}function K2(e,t,r,s){return e=Oo(22,e,s,t),e.elementType=jB,e.lanes=r,e.stateNode={isHidden:!1},e}function CN(e,t,r){return e=Oo(6,e,null,t),e.lanes=r,e}function EN(e,t,r){return t=Oo(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Dre(e,t,r,s,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=oN(0),this.expirationTimes=oN(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=oN(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function _6(e,t,r,s,a,i,o,l,d){return e=new Dre(e,t,r,l,d),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Oo(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},a6(i),e}function Lre(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:im,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function mF(e){if(!e)return vu;e=e._reactInternals;e:{if(gf(e)!==e||e.tag!==1)throw Error(Bt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Fi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Bt(171))}if(e.tag===1){var r=e.type;if(Fi(r))return m$(e,r,t)}return t}function pF(e,t,r,s,a,i,o,l,d){return e=_6(r,s,!0,e,a,i,o,l,d),e.context=mF(null),r=e.current,s=bi(),a=cu(r),i=qc(s,a),i.callback=t??null,ou(r,i,a),e.current.lanes=a,Uv(e,a,s),zi(e,s),e}function X2(e,t,r,s){var a=t.current,i=bi(),o=cu(a);return r=mF(r),t.context===null?t.context=r:t.pendingContext=r,t=qc(i,o),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=ou(a,t,o),e!==null&&(yl(e,a,o,i),rb(e,a,o)),o}function qb(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function NP(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function j6(e,t){NP(e,t),(e=e.alternate)&&NP(e,t)}function Bre(){return null}var gF=typeof reportError=="function"?reportError:function(e){console.error(e)};function N6(e){this._internalRoot=e}Y2.prototype.render=N6.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Bt(409));X2(e,t,null,null)};Y2.prototype.unmount=N6.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Hh(function(){X2(null,e,null,null)}),t[Yc]=null}};function Y2(e){this._internalRoot=e}Y2.prototype.unstable_scheduleHydration=function(e){if(e){var t=GB();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Bd.length&&t!==0&&t<Bd[r].priority;r++);Bd.splice(r,0,e),r===0&&XB(e)}};function S6(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Z2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function SP(){}function $re(e,t,r,s,a){if(a){if(typeof s=="function"){var i=s;s=function(){var c=qb(o);i.call(c)}}var o=pF(t,s,e,0,null,!1,!1,"",SP);return e._reactRootContainer=o,e[Yc]=o.current,mx(e.nodeType===8?e.parentNode:e),Hh(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof s=="function"){var l=s;s=function(){var c=qb(d);l.call(c)}}var d=_6(e,0,!1,null,null,!1,!1,"",SP);return e._reactRootContainer=d,e[Yc]=d.current,mx(e.nodeType===8?e.parentNode:e),Hh(function(){X2(t,d,r,s)}),d}function Q2(e,t,r,s,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var l=a;a=function(){var d=qb(o);l.call(d)}}X2(t,o,e,a)}else o=$re(r,t,e,a,s);return qb(o)}WB=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=N0(t.pendingLanes);r!==0&&(qE(t,r|1),zi(t,zs()),!(Nn&6)&&(ap=zs()+500,Pu()))}break;case 13:Hh(function(){var s=Zc(e,1);if(s!==null){var a=bi();yl(s,e,1,a)}}),j6(e,1)}};WE=function(e){if(e.tag===13){var t=Zc(e,134217728);if(t!==null){var r=bi();yl(t,e,134217728,r)}j6(e,134217728)}};HB=function(e){if(e.tag===13){var t=cu(e),r=Zc(e,t);if(r!==null){var s=bi();yl(r,e,t,s)}j6(e,t)}};GB=function(){return $n};KB=function(e,t){var r=$n;try{return $n=e,t()}finally{$n=r}};U4=function(e,t,r){switch(t){case"input":if(I4(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var a=U2(s);if(!a)throw Error(Bt(90));SB(s),I4(s,a)}}}break;case"textarea":EB(e,r);break;case"select":t=r.value,t!=null&&km(e,!!r.multiple,t,!1)}};MB=v6;IB=Hh;var Fre={usingClientEntryPoint:!1,Events:[qv,um,U2,OB,RB,v6]},Yg={findFiberByHostInstance:xh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zre={bundleType:Yg.bundleType,version:Yg.version,rendererPackageName:Yg.rendererPackageName,rendererConfig:Yg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dd.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=BB(e),e===null?null:e.stateNode},findFiberByHostInstance:Yg.findFiberByHostInstance||Bre,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ty=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ty.isDisabled&&ty.supportsFiber)try{B2=ty.inject(zre),nc=ty}catch{}}vo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fre;vo.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S6(t))throw Error(Bt(200));return Lre(e,t,null,r)};vo.createRoot=function(e,t){if(!S6(e))throw Error(Bt(299));var r=!1,s="",a=gF;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=_6(e,1,!1,null,null,r,!1,s,a),e[Yc]=t.current,mx(e.nodeType===8?e.parentNode:e),new N6(t)};vo.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Bt(188)):(e=Object.keys(e).join(","),Error(Bt(268,e)));return e=BB(t),e=e===null?null:e.stateNode,e};vo.flushSync=function(e){return Hh(e)};vo.hydrate=function(e,t,r){if(!Z2(t))throw Error(Bt(200));return Q2(null,e,t,!0,r)};vo.hydrateRoot=function(e,t,r){if(!S6(e))throw Error(Bt(405));var s=r!=null&&r.hydratedSources||null,a=!1,i="",o=gF;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=pF(t,null,e,1,r??null,a,!1,i,o),e[Yc]=t.current,mx(e),s)for(e=0;e<s.length;e++)r=s[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Y2(t)};vo.render=function(e,t,r){if(!Z2(t))throw Error(Bt(200));return Q2(null,e,t,!1,r)};vo.unmountComponentAtNode=function(e){if(!Z2(e))throw Error(Bt(40));return e._reactRootContainer?(Hh(function(){Q2(null,null,e,!1,function(){e._reactRootContainer=null,e[Yc]=null})}),!0):!1};vo.unstable_batchedUpdates=v6;vo.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!Z2(r))throw Error(Bt(200));if(e==null||e._reactInternals===void 0)throw Error(Bt(38));return Q2(e,t,r,!1,s)};vo.version="18.3.1-next-f1338f8080-20240426";function xF(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(xF)}catch(e){console.error(e)}}xF(),xB.exports=vo;var xf=xB.exports;const vF=Ln(xf);var yF,CP=xf;yF=CP.createRoot,CP.hydrateRoot;const Ure=1,Vre=1e6;let kN=0;function qre(){return kN=(kN+1)%Number.MAX_SAFE_INTEGER,kN.toString()}const AN=new Map,EP=e=>{if(AN.has(e))return;const t=setTimeout(()=>{AN.delete(e),q0({type:"REMOVE_TOAST",toastId:e})},Vre);AN.set(e,t)},Wre=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,Ure)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?EP(r):e.toasts.forEach(s=>{EP(s.id)}),{...e,toasts:e.toasts.map(s=>s.id===r||r===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},cb=[];let db={toasts:[]};function q0(e){db=Wre(db,e),cb.forEach(t=>{t(db)})}function Hre({...e}){const t=qre(),r=a=>q0({type:"UPDATE_TOAST",toast:{...a,id:t}}),s=()=>q0({type:"DISMISS_TOAST",toastId:t});return q0({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||s()}}}),{id:t,dismiss:s,update:r}}function Gre(){const[e,t]=P.useState(db);return P.useEffect(()=>(cb.push(t),()=>{const r=cb.indexOf(t);r>-1&&cb.splice(r,1)}),[e]),{...e,toast:Hre,dismiss:r=>q0({type:"DISMISS_TOAST",toastId:r})}}function Tt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function kP(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Jc(...e){return t=>{let r=!1;const s=e.map(a=>{const i=kP(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<s.length;a++){const i=s[a];typeof i=="function"?i():kP(e[a],null)}}}}function Rr(...e){return P.useCallback(Jc(...e),e)}function Kre(e,t){const r=P.createContext(t),s=i=>{const{children:o,...l}=i,d=P.useMemo(()=>l,Object.values(l));return n.jsx(r.Provider,{value:d,children:o})};s.displayName=e+"Provider";function a(i){const o=P.useContext(r);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[s,a]}function ea(e,t=[]){let r=[];function s(i,o){const l=P.createContext(o),d=r.length;r=[...r,o];const c=h=>{var v;const{scope:f,children:m,...p}=h,g=((v=f==null?void 0:f[e])==null?void 0:v[d])||l,x=P.useMemo(()=>p,Object.values(p));return n.jsx(g.Provider,{value:x,children:m})};c.displayName=i+"Provider";function u(h,f){var g;const m=((g=f==null?void 0:f[e])==null?void 0:g[d])||l,p=P.useContext(m);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const a=()=>{const i=r.map(o=>P.createContext(o));return function(l){const d=(l==null?void 0:l[e])||i;return P.useMemo(()=>({[`__scope${e}`]:{...l,[e]:d}}),[l,d])}};return a.scopeName=e,[s,Xre(a,...t)]}function Xre(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const s=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((l,{useScope:d,scopeName:c})=>{const h=d(i)[`__scope${c}`];return{...l,...h}},{});return P.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function yu(e){const t=Zre(e),r=P.forwardRef((s,a)=>{const{children:i,...o}=s,l=P.Children.toArray(i),d=l.find(Qre);if(d){const c=d.props.children,u=l.map(h=>h===d?P.Children.count(c)>1?P.Children.only(null):P.isValidElement(c)?c.props.children:null:h);return n.jsx(t,{...o,ref:a,children:P.isValidElement(c)?P.cloneElement(c,void 0,u):null})}return n.jsx(t,{...o,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}var Yre=yu("Slot");function Zre(e){const t=P.forwardRef((r,s)=>{const{children:a,...i}=r;if(P.isValidElement(a)){const o=ene(a),l=Jre(i,a.props);return a.type!==P.Fragment&&(l.ref=s?Jc(s,o):o),P.cloneElement(a,l)}return P.Children.count(a)>1?P.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var bF=Symbol("radix.slottable");function wF(e){const t=({children:r})=>n.jsx(n.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=bF,t}function Qre(e){return P.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===bF}function Jre(e,t){const r={...t};for(const s in t){const a=e[s],i=t[s];/^on[A-Z]/.test(s)?a&&i?r[s]=(...l)=>{const d=i(...l);return a(...l),d}:a&&(r[s]=a):s==="style"?r[s]={...a,...i}:s==="className"&&(r[s]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}function ene(e){var s,a;let t=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function J2(e){const t=e+"CollectionProvider",[r,s]=ea(t),[a,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:x,children:v}=g,y=je.useRef(null),b=je.useRef(new Map).current;return n.jsx(a,{scope:x,itemMap:b,collectionRef:y,children:v})};o.displayName=t;const l=e+"CollectionSlot",d=yu(l),c=je.forwardRef((g,x)=>{const{scope:v,children:y}=g,b=i(l,v),j=Rr(x,b.collectionRef);return n.jsx(d,{ref:j,children:y})});c.displayName=l;const u=e+"CollectionItemSlot",h="data-radix-collection-item",f=yu(u),m=je.forwardRef((g,x)=>{const{scope:v,children:y,...b}=g,j=je.useRef(null),T=Rr(x,j),O=i(u,v);return je.useEffect(()=>(O.itemMap.set(j,{ref:j,...b}),()=>void O.itemMap.delete(j))),n.jsx(f,{[h]:"",ref:T,children:y})});m.displayName=u;function p(g){const x=i(e+"CollectionConsumer",g);return je.useCallback(()=>{const y=x.collectionRef.current;if(!y)return[];const b=Array.from(y.querySelectorAll(`[${h}]`));return Array.from(x.itemMap.values()).sort((O,R)=>b.indexOf(O.ref.current)-b.indexOf(R.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:o,Slot:c,ItemSlot:m},p,s]}var tne=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],er=tne.reduce((e,t)=>{const r=yu(`Primitive.${t}`),s=P.forwardRef((a,i)=>{const{asChild:o,...l}=a,d=o?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),n.jsx(d,{...l,ref:i})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function C6(e,t){e&&xf.flushSync(()=>e.dispatchEvent(t))}function Us(e){const t=P.useRef(e);return P.useEffect(()=>{t.current=e}),P.useMemo(()=>(...r)=>{var s;return(s=t.current)==null?void 0:s.call(t,...r)},[])}function rne(e,t=globalThis==null?void 0:globalThis.document){const r=Us(e);P.useEffect(()=>{const s=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",s,{capture:!0}),()=>t.removeEventListener("keydown",s,{capture:!0})},[r,t])}var nne="DismissableLayer",wS="dismissableLayer.update",sne="dismissableLayer.pointerDownOutside",ane="dismissableLayer.focusOutside",AP,_F=P.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Ou=P.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...d}=e,c=P.useContext(_F),[u,h]=P.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=P.useState({}),p=Rr(t,R=>h(R)),g=Array.from(c.layers),[x]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=g.indexOf(x),y=u?g.indexOf(u):-1,b=c.layersWithOutsidePointerEventsDisabled.size>0,j=y>=v,T=one(R=>{const D=R.target,B=[...c.branches].some(q=>q.contains(D));!j||B||(a==null||a(R),o==null||o(R),R.defaultPrevented||l==null||l())},f),O=lne(R=>{const D=R.target;[...c.branches].some(q=>q.contains(D))||(i==null||i(R),o==null||o(R),R.defaultPrevented||l==null||l())},f);return rne(R=>{y===c.layers.size-1&&(s==null||s(R),!R.defaultPrevented&&l&&(R.preventDefault(),l()))},f),P.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(AP=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),TP(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=AP)}},[u,f,r,c]),P.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),TP())},[u,c]),P.useEffect(()=>{const R=()=>m({});return document.addEventListener(wS,R),()=>document.removeEventListener(wS,R)},[]),n.jsx(er.div,{...d,ref:p,style:{pointerEvents:b?j?"auto":"none":void 0,...e.style},onFocusCapture:Tt(e.onFocusCapture,O.onFocusCapture),onBlurCapture:Tt(e.onBlurCapture,O.onBlurCapture),onPointerDownCapture:Tt(e.onPointerDownCapture,T.onPointerDownCapture)})});Ou.displayName=nne;var ine="DismissableLayerBranch",jF=P.forwardRef((e,t)=>{const r=P.useContext(_F),s=P.useRef(null),a=Rr(t,s);return P.useEffect(()=>{const i=s.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),n.jsx(er.div,{...e,ref:a})});jF.displayName=ine;function one(e,t=globalThis==null?void 0:globalThis.document){const r=Us(e),s=P.useRef(!1),a=P.useRef(()=>{});return P.useEffect(()=>{const i=l=>{if(l.target&&!s.current){let d=function(){NF(sne,r,c,{discrete:!0})};const c={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=d,t.addEventListener("click",a.current,{once:!0})):d()}else t.removeEventListener("click",a.current);s.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>s.current=!0}}function lne(e,t=globalThis==null?void 0:globalThis.document){const r=Us(e),s=P.useRef(!1);return P.useEffect(()=>{const a=i=>{i.target&&!s.current&&NF(ane,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function TP(){const e=new CustomEvent(wS);document.dispatchEvent(e)}function NF(e,t,r,{discrete:s}){const a=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),s?C6(a,i):a.dispatchEvent(i)}var cne=Ou,dne=jF,ga=globalThis!=null&&globalThis.document?P.useLayoutEffect:()=>{},une="Portal",Qp=P.forwardRef((e,t)=>{var l;const{container:r,...s}=e,[a,i]=P.useState(!1);ga(()=>i(!0),[]);const o=r||a&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?vF.createPortal(n.jsx(er.div,{...s,ref:t}),o):null});Qp.displayName=une;function hne(e,t){return P.useReducer((r,s)=>t[r][s]??r,e)}var Ws=e=>{const{present:t,children:r}=e,s=fne(t),a=typeof r=="function"?r({present:s.isPresent}):P.Children.only(r),i=Rr(s.ref,mne(a));return typeof r=="function"||s.isPresent?P.cloneElement(a,{ref:i}):null};Ws.displayName="Presence";function fne(e){const[t,r]=P.useState(),s=P.useRef(null),a=P.useRef(e),i=P.useRef("none"),o=e?"mounted":"unmounted",[l,d]=hne(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return P.useEffect(()=>{const c=ry(s.current);i.current=l==="mounted"?c:"none"},[l]),ga(()=>{const c=s.current,u=a.current;if(u!==e){const f=i.current,m=ry(c);e?d("MOUNT"):m==="none"||(c==null?void 0:c.display)==="none"?d("UNMOUNT"):d(u&&f!==m?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,d]),ga(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,h=m=>{const g=ry(s.current).includes(m.animationName);if(m.target===t&&g&&(d("ANIMATION_END"),!a.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},f=m=>{m.target===t&&(i.current=ry(s.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else d("ANIMATION_END")},[t,d]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:P.useCallback(c=>{s.current=c?getComputedStyle(c):null,r(c)},[])}}function ry(e){return(e==null?void 0:e.animationName)||"none"}function mne(e){var s,a;let t=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var pne=IE[" useInsertionEffect ".trim().toString()]||ga;function Ui({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){const[a,i,o]=gne({defaultProp:t,onChange:r}),l=e!==void 0,d=l?e:a;{const u=P.useRef(e!==void 0);P.useEffect(()=>{const h=u.current;h!==l&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,s])}const c=P.useCallback(u=>{var h;if(l){const f=xne(u)?u(e):u;f!==e&&((h=o.current)==null||h.call(o,f))}else i(u)},[l,e,i,o]);return[d,c]}function gne({defaultProp:e,onChange:t}){const[r,s]=P.useState(e),a=P.useRef(r),i=P.useRef(t);return pne(()=>{i.current=t},[t]),P.useEffect(()=>{var o;a.current!==r&&((o=i.current)==null||o.call(i,r),a.current=r)},[r,a]),[r,s,i]}function xne(e){return typeof e=="function"}var SF=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),vne="VisuallyHidden",e_=P.forwardRef((e,t)=>n.jsx(er.span,{...e,ref:t,style:{...SF,...e.style}}));e_.displayName=vne;var yne=e_,E6="ToastProvider",[k6,bne,wne]=J2("Toast"),[CF,HZe]=ea("Toast",[wne]),[_ne,t_]=CF(E6),EF=e=>{const{__scopeToast:t,label:r="Notification",duration:s=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:o}=e,[l,d]=P.useState(null),[c,u]=P.useState(0),h=P.useRef(!1),f=P.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${E6}\`. Expected non-empty \`string\`.`),n.jsx(k6.Provider,{scope:t,children:n.jsx(_ne,{scope:t,label:r,duration:s,swipeDirection:a,swipeThreshold:i,toastCount:c,viewport:l,onViewportChange:d,onToastAdd:P.useCallback(()=>u(m=>m+1),[]),onToastRemove:P.useCallback(()=>u(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};EF.displayName=E6;var kF="ToastViewport",jne=["F8"],_S="toast.viewportPause",jS="toast.viewportResume",AF=P.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:s=jne,label:a="Notifications ({hotkey})",...i}=e,o=t_(kF,r),l=bne(r),d=P.useRef(null),c=P.useRef(null),u=P.useRef(null),h=P.useRef(null),f=Rr(t,h,o.onViewportChange),m=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;P.useEffect(()=>{const x=v=>{var b;s.length!==0&&s.every(j=>v[j]||v.code===j)&&((b=h.current)==null||b.focus())};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[s]),P.useEffect(()=>{const x=d.current,v=h.current;if(p&&x&&v){const y=()=>{if(!o.isClosePausedRef.current){const O=new CustomEvent(_S);v.dispatchEvent(O),o.isClosePausedRef.current=!0}},b=()=>{if(o.isClosePausedRef.current){const O=new CustomEvent(jS);v.dispatchEvent(O),o.isClosePausedRef.current=!1}},j=O=>{!x.contains(O.relatedTarget)&&b()},T=()=>{x.contains(document.activeElement)||b()};return x.addEventListener("focusin",y),x.addEventListener("focusout",j),x.addEventListener("pointermove",y),x.addEventListener("pointerleave",T),window.addEventListener("blur",y),window.addEventListener("focus",b),()=>{x.removeEventListener("focusin",y),x.removeEventListener("focusout",j),x.removeEventListener("pointermove",y),x.removeEventListener("pointerleave",T),window.removeEventListener("blur",y),window.removeEventListener("focus",b)}}},[p,o.isClosePausedRef]);const g=P.useCallback(({tabbingDirection:x})=>{const y=l().map(b=>{const j=b.ref.current,T=[j,...Dne(j)];return x==="forwards"?T:T.reverse()});return(x==="forwards"?y.reverse():y).flat()},[l]);return P.useEffect(()=>{const x=h.current;if(x){const v=y=>{var T,O,R;const b=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!b){const D=document.activeElement,B=y.shiftKey;if(y.target===x&&B){(T=c.current)==null||T.focus();return}const G=g({tabbingDirection:B?"backwards":"forwards"}),I=G.findIndex(F=>F===D);TN(G.slice(I+1))?y.preventDefault():B?(O=c.current)==null||O.focus():(R=u.current)==null||R.focus()}};return x.addEventListener("keydown",v),()=>x.removeEventListener("keydown",v)}},[l,g]),n.jsxs(dne,{ref:d,role:"region","aria-label":a.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&n.jsx(NS,{ref:c,onFocusFromOutsideViewport:()=>{const x=g({tabbingDirection:"forwards"});TN(x)}}),n.jsx(k6.Slot,{scope:r,children:n.jsx(er.ol,{tabIndex:-1,...i,ref:f})}),p&&n.jsx(NS,{ref:u,onFocusFromOutsideViewport:()=>{const x=g({tabbingDirection:"backwards"});TN(x)}})]})});AF.displayName=kF;var TF="ToastFocusProxy",NS=P.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:s,...a}=e,i=t_(TF,r);return n.jsx(e_,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:o=>{var c;const l=o.relatedTarget;!((c=i.viewport)!=null&&c.contains(l))&&s()}})});NS.displayName=TF;var Hv="Toast",Nne="toast.swipeStart",Sne="toast.swipeMove",Cne="toast.swipeCancel",Ene="toast.swipeEnd",PF=P.forwardRef((e,t)=>{const{forceMount:r,open:s,defaultOpen:a,onOpenChange:i,...o}=e,[l,d]=Ui({prop:s,defaultProp:a??!0,onChange:i,caller:Hv});return n.jsx(Ws,{present:r||l,children:n.jsx(Tne,{open:l,...o,ref:t,onClose:()=>d(!1),onPause:Us(e.onPause),onResume:Us(e.onResume),onSwipeStart:Tt(e.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Tt(e.onSwipeMove,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:Tt(e.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Tt(e.onSwipeEnd,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),d(!1)})})})});PF.displayName=Hv;var[kne,Ane]=CF(Hv,{onClose(){}}),Tne=P.forwardRef((e,t)=>{const{__scopeToast:r,type:s="foreground",duration:a,open:i,onClose:o,onEscapeKeyDown:l,onPause:d,onResume:c,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...p}=e,g=t_(Hv,r),[x,v]=P.useState(null),y=Rr(t,F=>v(F)),b=P.useRef(null),j=P.useRef(null),T=a||g.duration,O=P.useRef(0),R=P.useRef(T),D=P.useRef(0),{onToastAdd:B,onToastRemove:q}=g,Y=Us(()=>{var S;(x==null?void 0:x.contains(document.activeElement))&&((S=g.viewport)==null||S.focus()),o()}),G=P.useCallback(F=>{!F||F===1/0||(window.clearTimeout(D.current),O.current=new Date().getTime(),D.current=window.setTimeout(Y,F))},[Y]);P.useEffect(()=>{const F=g.viewport;if(F){const S=()=>{G(R.current),c==null||c()},E=()=>{const N=new Date().getTime()-O.current;R.current=R.current-N,window.clearTimeout(D.current),d==null||d()};return F.addEventListener(_S,E),F.addEventListener(jS,S),()=>{F.removeEventListener(_S,E),F.removeEventListener(jS,S)}}},[g.viewport,T,d,c,G]),P.useEffect(()=>{i&&!g.isClosePausedRef.current&&G(T)},[i,T,g.isClosePausedRef,G]),P.useEffect(()=>(B(),()=>q()),[B,q]);const I=P.useMemo(()=>x?BF(x):null,[x]);return g.viewport?n.jsxs(n.Fragment,{children:[I&&n.jsx(Pne,{__scopeToast:r,role:"status","aria-live":s==="foreground"?"assertive":"polite","aria-atomic":!0,children:I}),n.jsx(kne,{scope:r,onClose:Y,children:xf.createPortal(n.jsx(k6.ItemSlot,{scope:r,children:n.jsx(cne,{asChild:!0,onEscapeKeyDown:Tt(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||Y(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:n.jsx(er.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection,...p,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Tt(e.onKeyDown,F=>{F.key==="Escape"&&(l==null||l(F.nativeEvent),F.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,Y()))}),onPointerDown:Tt(e.onPointerDown,F=>{F.button===0&&(b.current={x:F.clientX,y:F.clientY})}),onPointerMove:Tt(e.onPointerMove,F=>{if(!b.current)return;const S=F.clientX-b.current.x,E=F.clientY-b.current.y,N=!!j.current,C=["left","right"].includes(g.swipeDirection),k=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,M=C?k(0,S):0,U=C?0:k(0,E),$=F.pointerType==="touch"?10:2,X={x:M,y:U},Z={originalEvent:F,delta:X};N?(j.current=X,ny(Sne,h,Z,{discrete:!1})):PP(X,g.swipeDirection,$)?(j.current=X,ny(Nne,u,Z,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs(S)>$||Math.abs(E)>$)&&(b.current=null)}),onPointerUp:Tt(e.onPointerUp,F=>{const S=j.current,E=F.target;if(E.hasPointerCapture(F.pointerId)&&E.releasePointerCapture(F.pointerId),j.current=null,b.current=null,S){const N=F.currentTarget,C={originalEvent:F,delta:S};PP(S,g.swipeDirection,g.swipeThreshold)?ny(Ene,m,C,{discrete:!0}):ny(Cne,f,C,{discrete:!0}),N.addEventListener("click",k=>k.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),Pne=e=>{const{__scopeToast:t,children:r,...s}=e,a=t_(Hv,t),[i,o]=P.useState(!1),[l,d]=P.useState(!1);return Mne(()=>o(!0)),P.useEffect(()=>{const c=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(c)},[]),l?null:n.jsx(Qp,{asChild:!0,children:n.jsx(e_,{...s,children:i&&n.jsxs(n.Fragment,{children:[a.label," ",r]})})})},One="ToastTitle",OF=P.forwardRef((e,t)=>{const{__scopeToast:r,...s}=e;return n.jsx(er.div,{...s,ref:t})});OF.displayName=One;var Rne="ToastDescription",RF=P.forwardRef((e,t)=>{const{__scopeToast:r,...s}=e;return n.jsx(er.div,{...s,ref:t})});RF.displayName=Rne;var MF="ToastAction",IF=P.forwardRef((e,t)=>{const{altText:r,...s}=e;return r.trim()?n.jsx(LF,{altText:r,asChild:!0,children:n.jsx(A6,{...s,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${MF}\`. Expected non-empty \`string\`.`),null)});IF.displayName=MF;var DF="ToastClose",A6=P.forwardRef((e,t)=>{const{__scopeToast:r,...s}=e,a=Ane(DF,r);return n.jsx(LF,{asChild:!0,children:n.jsx(er.button,{type:"button",...s,ref:t,onClick:Tt(e.onClick,a.onClose)})})});A6.displayName=DF;var LF=P.forwardRef((e,t)=>{const{__scopeToast:r,altText:s,...a}=e;return n.jsx(er.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...a,ref:t})});function BF(e){const t=[];return Array.from(e.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&t.push(s.textContent),Ine(s)){const a=s.ariaHidden||s.hidden||s.style.display==="none",i=s.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const o=s.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...BF(s))}}),t}function ny(e,t,r,{discrete:s}){const a=r.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),s?C6(a,i):a.dispatchEvent(i)}var PP=(e,t,r=0)=>{const s=Math.abs(e.x),a=Math.abs(e.y),i=s>a;return t==="left"||t==="right"?i&&s>r:!i&&a>r};function Mne(e=()=>{}){const t=Us(e);ga(()=>{let r=0,s=0;return r=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(s)}},[t])}function Ine(e){return e.nodeType===e.ELEMENT_NODE}function Dne(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function TN(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var Lne=EF,$F=AF,FF=PF,zF=OF,UF=RF,VF=IF,qF=A6;function WF(e){var t,r,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=WF(e[t]))&&(s&&(s+=" "),s+=r)}else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function pn(){for(var e,t,r=0,s="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=WF(e))&&(s&&(s+=" "),s+=t);return s}const OP=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,RP=pn,Jp=(e,t)=>r=>{var s;if((t==null?void 0:t.variants)==null)return RP(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,o=Object.keys(a).map(c=>{const u=r==null?void 0:r[c],h=i==null?void 0:i[c];if(u===null)return null;const f=OP(u)||OP(h);return a[c][f]}),l=r&&Object.entries(r).reduce((c,u)=>{let[h,f]=u;return f===void 0||(c[h]=f),c},{}),d=t==null||(s=t.compoundVariants)===null||s===void 0?void 0:s.reduce((c,u)=>{let{class:h,className:f,...m}=u;return Object.entries(m).every(p=>{let[g,x]=p;return Array.isArray(x)?x.includes({...i,...l}[g]):{...i,...l}[g]===x})?[...c,h,f]:c},[]);return RP(e,o,d,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bne=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),HF=(...e)=>e.filter((t,r,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var $ne={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fne=P.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:a="",children:i,iconNode:o,...l},d)=>P.createElement("svg",{ref:d,...$ne,width:t,height:t,stroke:e,strokeWidth:s?Number(r)*24/Number(t):r,className:HF("lucide",a),...l},[...o.map(([c,u])=>P.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xt=(e,t)=>{const r=P.forwardRef(({className:s,...a},i)=>P.createElement(Fne,{ref:i,iconNode:t,className:HF(`lucide-${Bne(e)}`,s),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jx=xt("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zne=xt("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GF=xt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=xt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=xt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KF=xt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Une=xt("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vne=xt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XF=xt("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qne=xt("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wne=xt("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zl=xt("Bike",[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YF=xt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=xt("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hne=xt("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SS=xt("Cake",[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h.01",key:"1bh4kh"}],["path",{d:"M12 4h.01",key:"1ujb9j"}],["path",{d:"M17 4h.01",key:"1upcoc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gne=xt("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=xt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=xt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=xt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kne=xt("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=xt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zo=xt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZF=xt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=xt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=xt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=xt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=xt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mn=xt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=xt("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xne=xt("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yne=xt("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=xt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QF=xt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wb=xt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=xt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=xt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=xt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vi=xt("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=xt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=xt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zne=xt("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=xt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=xt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=xt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gh=xt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kh=xt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ru=xt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hb=xt("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=xt("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=xt("GitCompare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T6=xt("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=xt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gb=xt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JF=xt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P6=xt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qne=xt("Infinity",[["path",{d:"M12 12c-2-2.67-4-4-6-4a4 4 0 1 0 0 8c2 0 4-1.33 6-4Zm0 0c2 2.67 4 4 6 4a4 4 0 0 0 0-8c-2 0-4 1.33-6 4Z",key:"1z0uae"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jne=xt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=xt("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O6=xt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ese=xt("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PN=xt("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=xt("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oi=xt("ListOrdered",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tse=xt("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=xt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rse=xt("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=xt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R6=xt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M6=xt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=xt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nse=xt("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=xt("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=xt("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=xt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sse=xt("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=xt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r_=xt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=xt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ase=xt("PackageCheck",[["path",{d:"m16 16 2 2 4-4",key:"gfu2re"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=xt("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n_=xt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ise=xt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=xt("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=xt("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uo=xt("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kl=xt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I6=xt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=xt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gv=xt("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=xt("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=xt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=xt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kv=xt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ose=xt("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uu=xt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=xt("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lse=xt("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const On=xt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yf=xt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=xt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cse=xt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=xt("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s_=xt("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dse=xt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const use=xt("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=xt("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ri=xt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D6=xt("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=xt("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hse=xt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=xt("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wi=xt("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fse=xt("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=xt("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=xt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const li=xt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mse=xt("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pse=xt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=xt("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=xt("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=xt("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iu=xt("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ui=xt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sx=xt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=xt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=xt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=xt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=xt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gse=xt("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lh=xt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=xt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=xt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xse=xt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=xt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kb=xt("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=xt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vse=xt("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=xt("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=xt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yse=xt("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),L6="-",bse=e=>{const t=_se(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:o=>{const l=o.split(L6);return l[0]===""&&l.length!==1&&l.shift(),cz(l,t)||wse(o)},getConflictingClassGroupIds:(o,l)=>{const d=r[o]||[];return l&&s[o]?[...d,...s[o]]:d}}},cz=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],s=t.nextPart.get(r),a=s?cz(e.slice(1),s):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(L6);return(o=t.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},LP=/^\[(.+)\]$/,wse=e=>{if(LP.test(e)){const t=LP.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},_se=e=>{const{theme:t,prefix:r}=e,s={nextPart:new Map,validators:[]};return Nse(Object.entries(e.classGroups),r).forEach(([i,o])=>{AS(o,s,i,t)}),s},AS=(e,t,r,s)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:BP(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(jse(a)){AS(a(s),t,r,s);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,o])=>{AS(o,BP(t,i),r,s)})})},BP=(e,t)=>{let r=e;return t.split(L6).forEach(s=>{r.nextPart.has(s)||r.nextPart.set(s,{nextPart:new Map,validators:[]}),r=r.nextPart.get(s)}),r},jse=e=>e.isThemeGetter,Nse=(e,t)=>t?e.map(([r,s])=>{const a=s.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[t+o,l])):i);return[r,a]}):e,Sse=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,s=new Map;const a=(i,o)=>{r.set(i,o),t++,t>e&&(t=0,s=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return a(i,o),o},set(i,o){r.has(i)?r.set(i,o):a(i,o)}}},dz="!",Cse=e=>{const{separator:t,experimentalParseClassName:r}=e,s=t.length===1,a=t[0],i=t.length,o=l=>{const d=[];let c=0,u=0,h;for(let x=0;x<l.length;x++){let v=l[x];if(c===0){if(v===a&&(s||l.slice(x,x+i)===t)){d.push(l.slice(u,x)),u=x+i;continue}if(v==="/"){h=x;continue}}v==="["?c++:v==="]"&&c--}const f=d.length===0?l:l.substring(u),m=f.startsWith(dz),p=m?f.substring(1):f,g=h&&h>u?h-u:void 0;return{modifiers:d,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:g}};return r?l=>r({className:l,parseClassName:o}):o},Ese=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(s=>{s[0]==="["?(t.push(...r.sort(),s),r=[]):r.push(s)}),t.push(...r.sort()),t},kse=e=>({cache:Sse(e.cacheSize),parseClassName:Cse(e),...bse(e)}),Ase=/\s+/,Tse=(e,t)=>{const{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:a}=t,i=[],o=e.trim().split(Ase);let l="";for(let d=o.length-1;d>=0;d-=1){const c=o[d],{modifiers:u,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:m}=r(c);let p=!!m,g=s(p?f.substring(0,m):f);if(!g){if(!p){l=c+(l.length>0?" "+l:l);continue}if(g=s(f),!g){l=c+(l.length>0?" "+l:l);continue}p=!1}const x=Ese(u).join(":"),v=h?x+dz:x,y=v+g;if(i.includes(y))continue;i.push(y);const b=a(g,p);for(let j=0;j<b.length;++j){const T=b[j];i.push(v+T)}l=c+(l.length>0?" "+l:l)}return l};function Pse(){let e=0,t,r,s="";for(;e<arguments.length;)(t=arguments[e++])&&(r=uz(t))&&(s&&(s+=" "),s+=r);return s}const uz=e=>{if(typeof e=="string")return e;let t,r="";for(let s=0;s<e.length;s++)e[s]&&(t=uz(e[s]))&&(r&&(r+=" "),r+=t);return r};function Ose(e,...t){let r,s,a,i=o;function o(d){const c=t.reduce((u,h)=>h(u),e());return r=kse(c),s=r.cache.get,a=r.cache.set,i=l,l(d)}function l(d){const c=s(d);if(c)return c;const u=Tse(d,r);return a(d,u),u}return function(){return i(Pse.apply(null,arguments))}}const is=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},hz=/^\[(?:([a-z-]+):)?(.+)\]$/i,Rse=/^\d+\/\d+$/,Mse=new Set(["px","full","screen"]),Ise=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Dse=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Lse=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Bse=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,$se=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ac=e=>Mm(e)||Mse.has(e)||Rse.test(e),Sd=e=>eg(e,"length",Gse),Mm=e=>!!e&&!Number.isNaN(Number(e)),ON=e=>eg(e,"number",Mm),Zg=e=>!!e&&Number.isInteger(Number(e)),Fse=e=>e.endsWith("%")&&Mm(e.slice(0,-1)),Xr=e=>hz.test(e),Cd=e=>Ise.test(e),zse=new Set(["length","size","percentage"]),Use=e=>eg(e,zse,fz),Vse=e=>eg(e,"position",fz),qse=new Set(["image","url"]),Wse=e=>eg(e,qse,Xse),Hse=e=>eg(e,"",Kse),Qg=()=>!0,eg=(e,t,r)=>{const s=hz.exec(e);return s?s[1]?typeof t=="string"?s[1]===t:t.has(s[1]):r(s[2]):!1},Gse=e=>Dse.test(e)&&!Lse.test(e),fz=()=>!1,Kse=e=>Bse.test(e),Xse=e=>$se.test(e),Yse=()=>{const e=is("colors"),t=is("spacing"),r=is("blur"),s=is("brightness"),a=is("borderColor"),i=is("borderRadius"),o=is("borderSpacing"),l=is("borderWidth"),d=is("contrast"),c=is("grayscale"),u=is("hueRotate"),h=is("invert"),f=is("gap"),m=is("gradientColorStops"),p=is("gradientColorStopPositions"),g=is("inset"),x=is("margin"),v=is("opacity"),y=is("padding"),b=is("saturate"),j=is("scale"),T=is("sepia"),O=is("skew"),R=is("space"),D=is("translate"),B=()=>["auto","contain","none"],q=()=>["auto","hidden","clip","visible","scroll"],Y=()=>["auto",Xr,t],G=()=>[Xr,t],I=()=>["",Ac,Sd],F=()=>["auto",Mm,Xr],S=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],E=()=>["solid","dashed","dotted","double","none"],N=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],C=()=>["start","end","center","between","around","evenly","stretch"],k=()=>["","0",Xr],M=()=>["auto","avoid","all","avoid-page","page","left","right","column"],U=()=>[Mm,Xr];return{cacheSize:500,separator:":",theme:{colors:[Qg],spacing:[Ac,Sd],blur:["none","",Cd,Xr],brightness:U(),borderColor:[e],borderRadius:["none","","full",Cd,Xr],borderSpacing:G(),borderWidth:I(),contrast:U(),grayscale:k(),hueRotate:U(),invert:k(),gap:G(),gradientColorStops:[e],gradientColorStopPositions:[Fse,Sd],inset:Y(),margin:Y(),opacity:U(),padding:G(),saturate:U(),scale:U(),sepia:k(),skew:U(),space:G(),translate:G()},classGroups:{aspect:[{aspect:["auto","square","video",Xr]}],container:["container"],columns:[{columns:[Cd]}],"break-after":[{"break-after":M()}],"break-before":[{"break-before":M()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...S(),Xr]}],overflow:[{overflow:q()}],"overflow-x":[{"overflow-x":q()}],"overflow-y":[{"overflow-y":q()}],overscroll:[{overscroll:B()}],"overscroll-x":[{"overscroll-x":B()}],"overscroll-y":[{"overscroll-y":B()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Zg,Xr]}],basis:[{basis:Y()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Xr]}],grow:[{grow:k()}],shrink:[{shrink:k()}],order:[{order:["first","last","none",Zg,Xr]}],"grid-cols":[{"grid-cols":[Qg]}],"col-start-end":[{col:["auto",{span:["full",Zg,Xr]},Xr]}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":[Qg]}],"row-start-end":[{row:["auto",{span:[Zg,Xr]},Xr]}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Xr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Xr]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...C()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...C(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...C(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[R]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[R]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Xr,t]}],"min-w":[{"min-w":[Xr,t,"min","max","fit"]}],"max-w":[{"max-w":[Xr,t,"none","full","min","max","fit","prose",{screen:[Cd]},Cd]}],h:[{h:[Xr,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Xr,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Xr,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Xr,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Cd,Sd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ON]}],"font-family":[{font:[Qg]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Xr]}],"line-clamp":[{"line-clamp":["none",Mm,ON]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ac,Xr]}],"list-image":[{"list-image":["none",Xr]}],"list-style-type":[{list:["none","disc","decimal",Xr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...E(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ac,Sd]}],"underline-offset":[{"underline-offset":["auto",Ac,Xr]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:G()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Xr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Xr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...S(),Vse]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Use]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Wse]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[...E(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:E()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...E()]}],"outline-offset":[{"outline-offset":[Ac,Xr]}],"outline-w":[{outline:[Ac,Sd]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:I()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[Ac,Sd]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Cd,Hse]}],"shadow-color":[{shadow:[Qg]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":[...N(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":N()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[s]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",Cd,Xr]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Xr]}],duration:[{duration:U()}],ease:[{ease:["linear","in","out","in-out",Xr]}],delay:[{delay:U()}],animate:[{animate:["none","spin","ping","pulse","bounce",Xr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[Zg,Xr]}],"translate-x":[{"translate-x":[D]}],"translate-y":[{"translate-y":[D]}],"skew-x":[{"skew-x":[O]}],"skew-y":[{"skew-y":[O]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Xr]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Xr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":G()}],"scroll-mx":[{"scroll-mx":G()}],"scroll-my":[{"scroll-my":G()}],"scroll-ms":[{"scroll-ms":G()}],"scroll-me":[{"scroll-me":G()}],"scroll-mt":[{"scroll-mt":G()}],"scroll-mr":[{"scroll-mr":G()}],"scroll-mb":[{"scroll-mb":G()}],"scroll-ml":[{"scroll-ml":G()}],"scroll-p":[{"scroll-p":G()}],"scroll-px":[{"scroll-px":G()}],"scroll-py":[{"scroll-py":G()}],"scroll-ps":[{"scroll-ps":G()}],"scroll-pe":[{"scroll-pe":G()}],"scroll-pt":[{"scroll-pt":G()}],"scroll-pr":[{"scroll-pr":G()}],"scroll-pb":[{"scroll-pb":G()}],"scroll-pl":[{"scroll-pl":G()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Xr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Ac,Sd,ON]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Zse=Ose(Yse);function He(...e){return Zse(pn(e))}const Qse=Lne,mz=P.forwardRef(({className:e,...t},r)=>n.jsx($F,{ref:r,className:He("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));mz.displayName=$F.displayName;const Jse=Jp("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),pz=P.forwardRef(({className:e,variant:t,...r},s)=>n.jsx(FF,{ref:s,className:He(Jse({variant:t}),e),...r}));pz.displayName=FF.displayName;const eae=P.forwardRef(({className:e,...t},r)=>n.jsx(VF,{ref:r,className:He("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...t}));eae.displayName=VF.displayName;const gz=P.forwardRef(({className:e,...t},r)=>n.jsx(qF,{ref:r,className:He("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:n.jsx(sn,{className:"h-4 w-4"})}));gz.displayName=qF.displayName;const xz=P.forwardRef(({className:e,...t},r)=>n.jsx(zF,{ref:r,className:He("text-sm font-semibold",e),...t}));xz.displayName=zF.displayName;const vz=P.forwardRef(({className:e,...t},r)=>n.jsx(UF,{ref:r,className:He("text-sm opacity-90",e),...t}));vz.displayName=UF.displayName;function tae(){const{toasts:e}=Gre();return n.jsxs(Qse,{children:[e.map(function({id:t,title:r,description:s,action:a,...i}){return n.jsxs(pz,{...i,children:[n.jsxs("div",{className:"grid gap-1",children:[r&&n.jsx(xz,{children:r}),s&&n.jsx(vz,{children:s})]}),a,n.jsx(gz,{})]},t)}),n.jsx(mz,{})]})}var $P=["light","dark"],rae="(prefers-color-scheme: dark)",nae=P.createContext(void 0),sae={setTheme:e=>{},themes:[]},aae=()=>{var e;return(e=P.useContext(nae))!=null?e:sae};P.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:s,enableColorScheme:a,defaultTheme:i,value:o,attrs:l,nonce:d})=>{let c=i==="system",u=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(p=>`'${p}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,h=a?$P.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(p,g=!1,x=!0)=>{let v=o?o[p]:p,y=g?p+"|| ''":`'${v}'`,b="";return a&&x&&!g&&$P.includes(p)&&(b+=`d.style.colorScheme = '${p}';`),r==="class"?g||v?b+=`c.add(${y})`:b+="null":v&&(b+=`d[s](n,${y})`),b},m=e?`!function(){${u}${f(e)}}()`:s?`!function(){try{${u}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${c})){var t='${rae}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${c?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return P.createElement("script",{nonce:d,dangerouslySetInnerHTML:{__html:m}})});var iae=e=>{switch(e){case"success":return cae;case"info":return uae;case"warning":return dae;case"error":return hae;default:return null}},oae=Array(12).fill(0),lae=({visible:e,className:t})=>je.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},je.createElement("div",{className:"sonner-spinner"},oae.map((r,s)=>je.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),cae=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),dae=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),uae=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),hae=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},je.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),fae=je.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},je.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),je.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),mae=()=>{let[e,t]=je.useState(document.hidden);return je.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},TS=1,pae=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...s}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:TS++,i=this.toasts.find(l=>l.id===a),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),i?this.toasts=this.toasts.map(l=>l.id===a?(this.publish({...l,...e,id:a,title:r}),{...l,...e,id:a,dismissible:o,title:r}):l):this.addToast({title:r,...s,dismissible:o,id:a}),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let s=e instanceof Promise?e:e(),a=r!==void 0,i,o=s.then(async d=>{if(i=["resolve",d],je.isValidElement(d))a=!1,this.create({id:r,type:"default",message:d});else if(xae(d)&&!d.ok){a=!1;let c=typeof t.error=="function"?await t.error(`HTTP error! status: ${d.status}`):t.error,u=typeof t.description=="function"?await t.description(`HTTP error! status: ${d.status}`):t.description;this.create({id:r,type:"error",message:c,description:u})}else if(t.success!==void 0){a=!1;let c=typeof t.success=="function"?await t.success(d):t.success,u=typeof t.description=="function"?await t.description(d):t.description;this.create({id:r,type:"success",message:c,description:u})}}).catch(async d=>{if(i=["reject",d],t.error!==void 0){a=!1;let c=typeof t.error=="function"?await t.error(d):t.error,u=typeof t.description=="function"?await t.description(d):t.description;this.create({id:r,type:"error",message:c,description:u})}}).finally(()=>{var d;a&&(this.dismiss(r),r=void 0),(d=t.finally)==null||d.call(t)}),l=()=>new Promise((d,c)=>o.then(()=>i[0]==="reject"?c(i[1]):d(i[1])).catch(c));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||TS++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Ti=new pae,gae=(e,t)=>{let r=(t==null?void 0:t.id)||TS++;return Ti.addToast({title:e,...t,id:r}),r},xae=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",vae=gae,yae=()=>Ti.toasts,bae=()=>Ti.getActiveToasts(),de=Object.assign(vae,{success:Ti.success,info:Ti.info,warning:Ti.warning,error:Ti.error,custom:Ti.custom,message:Ti.message,promise:Ti.promise,dismiss:Ti.dismiss,loading:Ti.loading},{getHistory:yae,getToasts:bae});function wae(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t==="top"&&r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}wae(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function sy(e){return e.label!==void 0}var _ae=3,jae="32px",Nae="16px",FP=4e3,Sae=356,Cae=14,Eae=20,kae=200;function el(...e){return e.filter(Boolean).join(" ")}function Aae(e){let[t,r]=e.split("-"),s=[];return t&&s.push(t),r&&s.push(r),s}var Tae=e=>{var t,r,s,a,i,o,l,d,c,u,h;let{invert:f,toast:m,unstyled:p,interacting:g,setHeights:x,visibleToasts:v,heights:y,index:b,toasts:j,expanded:T,removeToast:O,defaultRichColors:R,closeButton:D,style:B,cancelButtonStyle:q,actionButtonStyle:Y,className:G="",descriptionClassName:I="",duration:F,position:S,gap:E,loadingIcon:N,expandByDefault:C,classNames:k,icons:M,closeButtonAriaLabel:U="Close toast",pauseWhenPageIsHidden:$}=e,[X,Z]=je.useState(null),[re,W]=je.useState(null),[J,V]=je.useState(!1),[H,ee]=je.useState(!1),[ie,oe]=je.useState(!1),[se,ue]=je.useState(!1),[pe,ce]=je.useState(!1),[ne,me]=je.useState(0),[ge,_e]=je.useState(0),be=je.useRef(m.duration||F||FP),ye=je.useRef(null),Oe=je.useRef(null),Ne=b===0,De=b+1<=v,Ge=m.type,Qe=m.dismissible!==!1,Ie=m.className||"",Ae=m.descriptionClassName||"",st=je.useMemo(()=>y.findIndex(tt=>tt.toastId===m.id)||0,[y,m.id]),nt=je.useMemo(()=>{var tt;return(tt=m.closeButton)!=null?tt:D},[m.closeButton,D]),vt=je.useMemo(()=>m.duration||F||FP,[m.duration,F]),Je=je.useRef(0),Ue=je.useRef(0),Le=je.useRef(0),Ze=je.useRef(null),[ct,ht]=S.split("-"),yt=je.useMemo(()=>y.reduce((tt,ot,lt)=>lt>=st?tt:tt+ot.height,0),[y,st]),Re=mae(),Ke=m.invert||f,_t=Ge==="loading";Ue.current=je.useMemo(()=>st*E+yt,[st,yt]),je.useEffect(()=>{be.current=vt},[vt]),je.useEffect(()=>{V(!0)},[]),je.useEffect(()=>{let tt=Oe.current;if(tt){let ot=tt.getBoundingClientRect().height;return _e(ot),x(lt=>[{toastId:m.id,height:ot,position:m.position},...lt]),()=>x(lt=>lt.filter(At=>At.toastId!==m.id))}},[x,m.id]),je.useLayoutEffect(()=>{if(!J)return;let tt=Oe.current,ot=tt.style.height;tt.style.height="auto";let lt=tt.getBoundingClientRect().height;tt.style.height=ot,_e(lt),x(At=>At.find(Nt=>Nt.toastId===m.id)?At.map(Nt=>Nt.toastId===m.id?{...Nt,height:lt}:Nt):[{toastId:m.id,height:lt,position:m.position},...At])},[J,m.title,m.description,x,m.id]);let Rt=je.useCallback(()=>{ee(!0),me(Ue.current),x(tt=>tt.filter(ot=>ot.toastId!==m.id)),setTimeout(()=>{O(m)},kae)},[m,O,x,Ue]);je.useEffect(()=>{if(m.promise&&Ge==="loading"||m.duration===1/0||m.type==="loading")return;let tt;return T||g||$&&Re?(()=>{if(Le.current<Je.current){let ot=new Date().getTime()-Je.current;be.current=be.current-ot}Le.current=new Date().getTime()})():be.current!==1/0&&(Je.current=new Date().getTime(),tt=setTimeout(()=>{var ot;(ot=m.onAutoClose)==null||ot.call(m,m),Rt()},be.current)),()=>clearTimeout(tt)},[T,g,m,Ge,$,Re,Rt]),je.useEffect(()=>{m.delete&&Rt()},[Rt,m.delete]);function Se(){var tt,ot,lt;return M!=null&&M.loading?je.createElement("div",{className:el(k==null?void 0:k.loader,(tt=m==null?void 0:m.classNames)==null?void 0:tt.loader,"sonner-loader"),"data-visible":Ge==="loading"},M.loading):N?je.createElement("div",{className:el(k==null?void 0:k.loader,(ot=m==null?void 0:m.classNames)==null?void 0:ot.loader,"sonner-loader"),"data-visible":Ge==="loading"},N):je.createElement(lae,{className:el(k==null?void 0:k.loader,(lt=m==null?void 0:m.classNames)==null?void 0:lt.loader),visible:Ge==="loading"})}return je.createElement("li",{tabIndex:0,ref:Oe,className:el(G,Ie,k==null?void 0:k.toast,(t=m==null?void 0:m.classNames)==null?void 0:t.toast,k==null?void 0:k.default,k==null?void 0:k[Ge],(r=m==null?void 0:m.classNames)==null?void 0:r[Ge]),"data-sonner-toast":"","data-rich-colors":(s=m.richColors)!=null?s:R,"data-styled":!(m.jsx||m.unstyled||p),"data-mounted":J,"data-promise":!!m.promise,"data-swiped":pe,"data-removed":H,"data-visible":De,"data-y-position":ct,"data-x-position":ht,"data-index":b,"data-front":Ne,"data-swiping":ie,"data-dismissible":Qe,"data-type":Ge,"data-invert":Ke,"data-swipe-out":se,"data-swipe-direction":re,"data-expanded":!!(T||C&&J),style:{"--index":b,"--toasts-before":b,"--z-index":j.length-b,"--offset":`${H?ne:Ue.current}px`,"--initial-height":C?"auto":`${ge}px`,...B,...m.style},onDragEnd:()=>{oe(!1),Z(null),Ze.current=null},onPointerDown:tt=>{_t||!Qe||(ye.current=new Date,me(Ue.current),tt.target.setPointerCapture(tt.pointerId),tt.target.tagName!=="BUTTON"&&(oe(!0),Ze.current={x:tt.clientX,y:tt.clientY}))},onPointerUp:()=>{var tt,ot,lt,At;if(se||!Qe)return;Ze.current=null;let Nt=Number(((tt=Oe.current)==null?void 0:tt.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),ut=Number(((ot=Oe.current)==null?void 0:ot.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),lr=new Date().getTime()-((lt=ye.current)==null?void 0:lt.getTime()),Pt=X==="x"?Nt:ut,Pe=Math.abs(Pt)/lr;if(Math.abs(Pt)>=Eae||Pe>.11){me(Ue.current),(At=m.onDismiss)==null||At.call(m,m),W(X==="x"?Nt>0?"right":"left":ut>0?"down":"up"),Rt(),ue(!0),ce(!1);return}oe(!1),Z(null)},onPointerMove:tt=>{var ot,lt,At,Nt;if(!Ze.current||!Qe||((ot=window.getSelection())==null?void 0:ot.toString().length)>0)return;let ut=tt.clientY-Ze.current.y,lr=tt.clientX-Ze.current.x,Pt=(lt=e.swipeDirections)!=null?lt:Aae(S);!X&&(Math.abs(lr)>1||Math.abs(ut)>1)&&Z(Math.abs(lr)>Math.abs(ut)?"x":"y");let Pe={x:0,y:0};X==="y"?(Pt.includes("top")||Pt.includes("bottom"))&&(Pt.includes("top")&&ut<0||Pt.includes("bottom")&&ut>0)&&(Pe.y=ut):X==="x"&&(Pt.includes("left")||Pt.includes("right"))&&(Pt.includes("left")&&lr<0||Pt.includes("right")&&lr>0)&&(Pe.x=lr),(Math.abs(Pe.x)>0||Math.abs(Pe.y)>0)&&ce(!0),(At=Oe.current)==null||At.style.setProperty("--swipe-amount-x",`${Pe.x}px`),(Nt=Oe.current)==null||Nt.style.setProperty("--swipe-amount-y",`${Pe.y}px`)}},nt&&!m.jsx?je.createElement("button",{"aria-label":U,"data-disabled":_t,"data-close-button":!0,onClick:_t||!Qe?()=>{}:()=>{var tt;Rt(),(tt=m.onDismiss)==null||tt.call(m,m)},className:el(k==null?void 0:k.closeButton,(a=m==null?void 0:m.classNames)==null?void 0:a.closeButton)},(i=M==null?void 0:M.close)!=null?i:fae):null,m.jsx||P.isValidElement(m.title)?m.jsx?m.jsx:typeof m.title=="function"?m.title():m.title:je.createElement(je.Fragment,null,Ge||m.icon||m.promise?je.createElement("div",{"data-icon":"",className:el(k==null?void 0:k.icon,(o=m==null?void 0:m.classNames)==null?void 0:o.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||Se():null,m.type!=="loading"?m.icon||(M==null?void 0:M[Ge])||iae(Ge):null):null,je.createElement("div",{"data-content":"",className:el(k==null?void 0:k.content,(l=m==null?void 0:m.classNames)==null?void 0:l.content)},je.createElement("div",{"data-title":"",className:el(k==null?void 0:k.title,(d=m==null?void 0:m.classNames)==null?void 0:d.title)},typeof m.title=="function"?m.title():m.title),m.description?je.createElement("div",{"data-description":"",className:el(I,Ae,k==null?void 0:k.description,(c=m==null?void 0:m.classNames)==null?void 0:c.description)},typeof m.description=="function"?m.description():m.description):null),P.isValidElement(m.cancel)?m.cancel:m.cancel&&sy(m.cancel)?je.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||q,onClick:tt=>{var ot,lt;sy(m.cancel)&&Qe&&((lt=(ot=m.cancel).onClick)==null||lt.call(ot,tt),Rt())},className:el(k==null?void 0:k.cancelButton,(u=m==null?void 0:m.classNames)==null?void 0:u.cancelButton)},m.cancel.label):null,P.isValidElement(m.action)?m.action:m.action&&sy(m.action)?je.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||Y,onClick:tt=>{var ot,lt;sy(m.action)&&((lt=(ot=m.action).onClick)==null||lt.call(ot,tt),!tt.defaultPrevented&&Rt())},className:el(k==null?void 0:k.actionButton,(h=m==null?void 0:m.classNames)==null?void 0:h.actionButton)},m.action.label):null))};function zP(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Pae(e,t){let r={};return[e,t].forEach((s,a)=>{let i=a===1,o=i?"--mobile-offset":"--offset",l=i?Nae:jae;function d(c){["top","right","bottom","left"].forEach(u=>{r[`${o}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof s=="number"||typeof s=="string"?d(s):typeof s=="object"?["top","right","bottom","left"].forEach(c=>{s[c]===void 0?r[`${o}-${c}`]=l:r[`${o}-${c}`]=typeof s[c]=="number"?`${s[c]}px`:s[c]}):d(l)}),r}var Oae=P.forwardRef(function(e,t){let{invert:r,position:s="bottom-right",hotkey:a=["altKey","KeyT"],expand:i,closeButton:o,className:l,offset:d,mobileOffset:c,theme:u="light",richColors:h,duration:f,style:m,visibleToasts:p=_ae,toastOptions:g,dir:x=zP(),gap:v=Cae,loadingIcon:y,icons:b,containerAriaLabel:j="Notifications",pauseWhenPageIsHidden:T}=e,[O,R]=je.useState([]),D=je.useMemo(()=>Array.from(new Set([s].concat(O.filter($=>$.position).map($=>$.position)))),[O,s]),[B,q]=je.useState([]),[Y,G]=je.useState(!1),[I,F]=je.useState(!1),[S,E]=je.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),N=je.useRef(null),C=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),k=je.useRef(null),M=je.useRef(!1),U=je.useCallback($=>{R(X=>{var Z;return(Z=X.find(re=>re.id===$.id))!=null&&Z.delete||Ti.dismiss($.id),X.filter(({id:re})=>re!==$.id)})},[]);return je.useEffect(()=>Ti.subscribe($=>{if($.dismiss){R(X=>X.map(Z=>Z.id===$.id?{...Z,delete:!0}:Z));return}setTimeout(()=>{vF.flushSync(()=>{R(X=>{let Z=X.findIndex(re=>re.id===$.id);return Z!==-1?[...X.slice(0,Z),{...X[Z],...$},...X.slice(Z+1)]:[$,...X]})})})}),[]),je.useEffect(()=>{if(u!=="system"){E(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?E("dark"):E("light")),typeof window>"u")return;let $=window.matchMedia("(prefers-color-scheme: dark)");try{$.addEventListener("change",({matches:X})=>{E(X?"dark":"light")})}catch{$.addListener(({matches:Z})=>{try{E(Z?"dark":"light")}catch(re){console.error(re)}})}},[u]),je.useEffect(()=>{O.length<=1&&G(!1)},[O]),je.useEffect(()=>{let $=X=>{var Z,re;a.every(W=>X[W]||X.code===W)&&(G(!0),(Z=N.current)==null||Z.focus()),X.code==="Escape"&&(document.activeElement===N.current||(re=N.current)!=null&&re.contains(document.activeElement))&&G(!1)};return document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)},[a]),je.useEffect(()=>{if(N.current)return()=>{k.current&&(k.current.focus({preventScroll:!0}),k.current=null,M.current=!1)}},[N.current]),je.createElement("section",{ref:t,"aria-label":`${j} ${C}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},D.map(($,X)=>{var Z;let[re,W]=$.split("-");return O.length?je.createElement("ol",{key:$,dir:x==="auto"?zP():x,tabIndex:-1,ref:N,className:l,"data-sonner-toaster":!0,"data-theme":S,"data-y-position":re,"data-lifted":Y&&O.length>1&&!i,"data-x-position":W,style:{"--front-toast-height":`${((Z=B[0])==null?void 0:Z.height)||0}px`,"--width":`${Sae}px`,"--gap":`${v}px`,...m,...Pae(d,c)},onBlur:J=>{M.current&&!J.currentTarget.contains(J.relatedTarget)&&(M.current=!1,k.current&&(k.current.focus({preventScroll:!0}),k.current=null))},onFocus:J=>{J.target instanceof HTMLElement&&J.target.dataset.dismissible==="false"||M.current||(M.current=!0,k.current=J.relatedTarget)},onMouseEnter:()=>G(!0),onMouseMove:()=>G(!0),onMouseLeave:()=>{I||G(!1)},onDragEnd:()=>G(!1),onPointerDown:J=>{J.target instanceof HTMLElement&&J.target.dataset.dismissible==="false"||F(!0)},onPointerUp:()=>F(!1)},O.filter(J=>!J.position&&X===0||J.position===$).map((J,V)=>{var H,ee;return je.createElement(Tae,{key:J.id,icons:b,index:V,toast:J,defaultRichColors:h,duration:(H=g==null?void 0:g.duration)!=null?H:f,className:g==null?void 0:g.className,descriptionClassName:g==null?void 0:g.descriptionClassName,invert:r,visibleToasts:p,closeButton:(ee=g==null?void 0:g.closeButton)!=null?ee:o,interacting:I,position:$,style:g==null?void 0:g.style,unstyled:g==null?void 0:g.unstyled,classNames:g==null?void 0:g.classNames,cancelButtonStyle:g==null?void 0:g.cancelButtonStyle,actionButtonStyle:g==null?void 0:g.actionButtonStyle,removeToast:U,toasts:O.filter(ie=>ie.position==J.position),heights:B.filter(ie=>ie.position==J.position),setHeights:q,expandByDefault:i,gap:v,loadingIcon:y,expanded:Y,pauseWhenPageIsHidden:T,swipeDirections:e.swipeDirections})})):null}))});const Rae=({...e})=>{const{theme:t="system"}=aae();return n.jsx(Oae,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Mae=IE[" useId ".trim().toString()]||(()=>{}),Iae=0;function pa(e){const[t,r]=P.useState(Mae());return ga(()=>{e||r(s=>s??String(Iae++))},[e]),e||(t?`radix-${t}`:"")}const Dae=["top","right","bottom","left"],bu=Math.min,no=Math.max,Xb=Math.round,ay=Math.floor,ic=e=>({x:e,y:e}),Lae={left:"right",right:"left",bottom:"top",top:"bottom"},Bae={start:"end",end:"start"};function PS(e,t,r){return no(e,bu(t,r))}function ed(e,t){return typeof e=="function"?e(t):e}function td(e){return e.split("-")[0]}function tg(e){return e.split("-")[1]}function B6(e){return e==="x"?"y":"x"}function $6(e){return e==="y"?"height":"width"}const $ae=new Set(["top","bottom"]);function Jl(e){return $ae.has(td(e))?"y":"x"}function F6(e){return B6(Jl(e))}function Fae(e,t,r){r===void 0&&(r=!1);const s=tg(e),a=F6(e),i=$6(a);let o=a==="x"?s===(r?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=Yb(o)),[o,Yb(o)]}function zae(e){const t=Yb(e);return[OS(e),t,OS(t)]}function OS(e){return e.replace(/start|end/g,t=>Bae[t])}const UP=["left","right"],VP=["right","left"],Uae=["top","bottom"],Vae=["bottom","top"];function qae(e,t,r){switch(e){case"top":case"bottom":return r?t?VP:UP:t?UP:VP;case"left":case"right":return t?Uae:Vae;default:return[]}}function Wae(e,t,r,s){const a=tg(e);let i=qae(td(e),r==="start",s);return a&&(i=i.map(o=>o+"-"+a),t&&(i=i.concat(i.map(OS)))),i}function Yb(e){return e.replace(/left|right|bottom|top/g,t=>Lae[t])}function Hae(e){return{top:0,right:0,bottom:0,left:0,...e}}function yz(e){return typeof e!="number"?Hae(e):{top:e,right:e,bottom:e,left:e}}function Zb(e){const{x:t,y:r,width:s,height:a}=e;return{width:s,height:a,top:r,left:t,right:t+s,bottom:r+a,x:t,y:r}}function qP(e,t,r){let{reference:s,floating:a}=e;const i=Jl(t),o=F6(t),l=$6(o),d=td(t),c=i==="y",u=s.x+s.width/2-a.width/2,h=s.y+s.height/2-a.height/2,f=s[l]/2-a[l]/2;let m;switch(d){case"top":m={x:u,y:s.y-a.height};break;case"bottom":m={x:u,y:s.y+s.height};break;case"right":m={x:s.x+s.width,y:h};break;case"left":m={x:s.x-a.width,y:h};break;default:m={x:s.x,y:s.y}}switch(tg(t)){case"start":m[o]-=f*(r&&c?-1:1);break;case"end":m[o]+=f*(r&&c?-1:1);break}return m}const Gae=async(e,t,r)=>{const{placement:s="bottom",strategy:a="absolute",middleware:i=[],platform:o}=r,l=i.filter(Boolean),d=await(o.isRTL==null?void 0:o.isRTL(t));let c=await o.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:h}=qP(c,s,d),f=s,m={},p=0;for(let g=0;g<l.length;g++){const{name:x,fn:v}=l[g],{x:y,y:b,data:j,reset:T}=await v({x:u,y:h,initialPlacement:s,placement:f,strategy:a,middlewareData:m,rects:c,platform:o,elements:{reference:e,floating:t}});u=y??u,h=b??h,m={...m,[x]:{...m[x],...j}},T&&p<=50&&(p++,typeof T=="object"&&(T.placement&&(f=T.placement),T.rects&&(c=T.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:a}):T.rects),{x:u,y:h}=qP(c,f,d)),g=-1)}return{x:u,y:h,placement:f,strategy:a,middlewareData:m}};async function Cx(e,t){var r;t===void 0&&(t={});const{x:s,y:a,platform:i,rects:o,elements:l,strategy:d}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=ed(t,e),p=yz(m),x=l[f?h==="floating"?"reference":"floating":h],v=Zb(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(x)))==null||r?x:x.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:c,rootBoundary:u,strategy:d})),y=h==="floating"?{x:s,y:a,width:o.floating.width,height:o.floating.height}:o.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),j=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},T=Zb(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:y,offsetParent:b,strategy:d}):y);return{top:(v.top-T.top+p.top)/j.y,bottom:(T.bottom-v.bottom+p.bottom)/j.y,left:(v.left-T.left+p.left)/j.x,right:(T.right-v.right+p.right)/j.x}}const Kae=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:s,placement:a,rects:i,platform:o,elements:l,middlewareData:d}=t,{element:c,padding:u=0}=ed(e,t)||{};if(c==null)return{};const h=yz(u),f={x:r,y:s},m=F6(a),p=$6(m),g=await o.getDimensions(c),x=m==="y",v=x?"top":"left",y=x?"bottom":"right",b=x?"clientHeight":"clientWidth",j=i.reference[p]+i.reference[m]-f[m]-i.floating[p],T=f[m]-i.reference[m],O=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let R=O?O[b]:0;(!R||!await(o.isElement==null?void 0:o.isElement(O)))&&(R=l.floating[b]||i.floating[p]);const D=j/2-T/2,B=R/2-g[p]/2-1,q=bu(h[v],B),Y=bu(h[y],B),G=q,I=R-g[p]-Y,F=R/2-g[p]/2+D,S=PS(G,F,I),E=!d.arrow&&tg(a)!=null&&F!==S&&i.reference[p]/2-(F<G?q:Y)-g[p]/2<0,N=E?F<G?F-G:F-I:0;return{[m]:f[m]+N,data:{[m]:S,centerOffset:F-S-N,...E&&{alignmentOffset:N}},reset:E}}}),Xae=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,s;const{placement:a,middlewareData:i,rects:o,initialPlacement:l,platform:d,elements:c}=t,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...x}=ed(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const v=td(a),y=Jl(l),b=td(l)===l,j=await(d.isRTL==null?void 0:d.isRTL(c.floating)),T=f||(b||!g?[Yb(l)]:zae(l)),O=p!=="none";!f&&O&&T.push(...Wae(l,g,p,j));const R=[l,...T],D=await Cx(t,x),B=[];let q=((s=i.flip)==null?void 0:s.overflows)||[];if(u&&B.push(D[v]),h){const F=Fae(a,o,j);B.push(D[F[0]],D[F[1]])}if(q=[...q,{placement:a,overflows:B}],!B.every(F=>F<=0)){var Y,G;const F=(((Y=i.flip)==null?void 0:Y.index)||0)+1,S=R[F];if(S&&(!(h==="alignment"?y!==Jl(S):!1)||q.every(C=>C.overflows[0]>0&&Jl(C.placement)===y)))return{data:{index:F,overflows:q},reset:{placement:S}};let E=(G=q.filter(N=>N.overflows[0]<=0).sort((N,C)=>N.overflows[1]-C.overflows[1])[0])==null?void 0:G.placement;if(!E)switch(m){case"bestFit":{var I;const N=(I=q.filter(C=>{if(O){const k=Jl(C.placement);return k===y||k==="y"}return!0}).map(C=>[C.placement,C.overflows.filter(k=>k>0).reduce((k,M)=>k+M,0)]).sort((C,k)=>C[1]-k[1])[0])==null?void 0:I[0];N&&(E=N);break}case"initialPlacement":E=l;break}if(a!==E)return{reset:{placement:E}}}return{}}}};function WP(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function HP(e){return Dae.some(t=>e[t]>=0)}const Yae=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:s="referenceHidden",...a}=ed(e,t);switch(s){case"referenceHidden":{const i=await Cx(t,{...a,elementContext:"reference"}),o=WP(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:HP(o)}}}case"escaped":{const i=await Cx(t,{...a,altBoundary:!0}),o=WP(i,r.floating);return{data:{escapedOffsets:o,escaped:HP(o)}}}default:return{}}}}},bz=new Set(["left","top"]);async function Zae(e,t){const{placement:r,platform:s,elements:a}=e,i=await(s.isRTL==null?void 0:s.isRTL(a.floating)),o=td(r),l=tg(r),d=Jl(r)==="y",c=bz.has(o)?-1:1,u=i&&d?-1:1,h=ed(t,e);let{mainAxis:f,crossAxis:m,alignmentAxis:p}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof p=="number"&&(m=l==="end"?p*-1:p),d?{x:m*u,y:f*c}:{x:f*c,y:m*u}}const Qae=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,s;const{x:a,y:i,placement:o,middlewareData:l}=t,d=await Zae(t,e);return o===((r=l.offset)==null?void 0:r.placement)&&(s=l.arrow)!=null&&s.alignmentOffset?{}:{x:a+d.x,y:i+d.y,data:{...d,placement:o}}}}},Jae=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:s,placement:a}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:x=>{let{x:v,y}=x;return{x:v,y}}},...d}=ed(e,t),c={x:r,y:s},u=await Cx(t,d),h=Jl(td(a)),f=B6(h);let m=c[f],p=c[h];if(i){const x=f==="y"?"top":"left",v=f==="y"?"bottom":"right",y=m+u[x],b=m-u[v];m=PS(y,m,b)}if(o){const x=h==="y"?"top":"left",v=h==="y"?"bottom":"right",y=p+u[x],b=p-u[v];p=PS(y,p,b)}const g=l.fn({...t,[f]:m,[h]:p});return{...g,data:{x:g.x-r,y:g.y-s,enabled:{[f]:i,[h]:o}}}}}},eie=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:s,placement:a,rects:i,middlewareData:o}=t,{offset:l=0,mainAxis:d=!0,crossAxis:c=!0}=ed(e,t),u={x:r,y:s},h=Jl(a),f=B6(h);let m=u[f],p=u[h];const g=ed(l,t),x=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(d){const b=f==="y"?"height":"width",j=i.reference[f]-i.floating[b]+x.mainAxis,T=i.reference[f]+i.reference[b]-x.mainAxis;m<j?m=j:m>T&&(m=T)}if(c){var v,y;const b=f==="y"?"width":"height",j=bz.has(td(a)),T=i.reference[h]-i.floating[b]+(j&&((v=o.offset)==null?void 0:v[h])||0)+(j?0:x.crossAxis),O=i.reference[h]+i.reference[b]+(j?0:((y=o.offset)==null?void 0:y[h])||0)-(j?x.crossAxis:0);p<T?p=T:p>O&&(p=O)}return{[f]:m,[h]:p}}}},tie=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,s;const{placement:a,rects:i,platform:o,elements:l}=t,{apply:d=()=>{},...c}=ed(e,t),u=await Cx(t,c),h=td(a),f=tg(a),m=Jl(a)==="y",{width:p,height:g}=i.floating;let x,v;h==="top"||h==="bottom"?(x=h,v=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(v=h,x=f==="end"?"top":"bottom");const y=g-u.top-u.bottom,b=p-u.left-u.right,j=bu(g-u[x],y),T=bu(p-u[v],b),O=!t.middlewareData.shift;let R=j,D=T;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(D=b),(s=t.middlewareData.shift)!=null&&s.enabled.y&&(R=y),O&&!f){const q=no(u.left,0),Y=no(u.right,0),G=no(u.top,0),I=no(u.bottom,0);m?D=p-2*(q!==0||Y!==0?q+Y:no(u.left,u.right)):R=g-2*(G!==0||I!==0?G+I:no(u.top,u.bottom))}await d({...t,availableWidth:D,availableHeight:R});const B=await o.getDimensions(l.floating);return p!==B.width||g!==B.height?{reset:{rects:!0}}:{}}}};function a_(){return typeof window<"u"}function rg(e){return wz(e)?(e.nodeName||"").toLowerCase():"#document"}function ho(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function yc(e){var t;return(t=(wz(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function wz(e){return a_()?e instanceof Node||e instanceof ho(e).Node:!1}function Sl(e){return a_()?e instanceof Element||e instanceof ho(e).Element:!1}function mc(e){return a_()?e instanceof HTMLElement||e instanceof ho(e).HTMLElement:!1}function GP(e){return!a_()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ho(e).ShadowRoot}const rie=new Set(["inline","contents"]);function Xv(e){const{overflow:t,overflowX:r,overflowY:s,display:a}=Cl(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+r)&&!rie.has(a)}const nie=new Set(["table","td","th"]);function sie(e){return nie.has(rg(e))}const aie=[":popover-open",":modal"];function i_(e){return aie.some(t=>{try{return e.matches(t)}catch{return!1}})}const iie=["transform","translate","scale","rotate","perspective"],oie=["transform","translate","scale","rotate","perspective","filter"],lie=["paint","layout","strict","content"];function z6(e){const t=U6(),r=Sl(e)?Cl(e):e;return iie.some(s=>r[s]?r[s]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||oie.some(s=>(r.willChange||"").includes(s))||lie.some(s=>(r.contain||"").includes(s))}function cie(e){let t=wu(e);for(;mc(t)&&!lp(t);){if(z6(t))return t;if(i_(t))return null;t=wu(t)}return null}function U6(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const die=new Set(["html","body","#document"]);function lp(e){return die.has(rg(e))}function Cl(e){return ho(e).getComputedStyle(e)}function o_(e){return Sl(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function wu(e){if(rg(e)==="html")return e;const t=e.assignedSlot||e.parentNode||GP(e)&&e.host||yc(e);return GP(t)?t.host:t}function _z(e){const t=wu(e);return lp(t)?e.ownerDocument?e.ownerDocument.body:e.body:mc(t)&&Xv(t)?t:_z(t)}function Ex(e,t,r){var s;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=_z(e),i=a===((s=e.ownerDocument)==null?void 0:s.body),o=ho(a);if(i){const l=RS(o);return t.concat(o,o.visualViewport||[],Xv(a)?a:[],l&&r?Ex(l):[])}return t.concat(a,Ex(a,[],r))}function RS(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function jz(e){const t=Cl(e);let r=parseFloat(t.width)||0,s=parseFloat(t.height)||0;const a=mc(e),i=a?e.offsetWidth:r,o=a?e.offsetHeight:s,l=Xb(r)!==i||Xb(s)!==o;return l&&(r=i,s=o),{width:r,height:s,$:l}}function V6(e){return Sl(e)?e:e.contextElement}function Im(e){const t=V6(e);if(!mc(t))return ic(1);const r=t.getBoundingClientRect(),{width:s,height:a,$:i}=jz(t);let o=(i?Xb(r.width):r.width)/s,l=(i?Xb(r.height):r.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const uie=ic(0);function Nz(e){const t=ho(e);return!U6()||!t.visualViewport?uie:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function hie(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==ho(e)?!1:t}function Xh(e,t,r,s){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),i=V6(e);let o=ic(1);t&&(s?Sl(s)&&(o=Im(s)):o=Im(e));const l=hie(i,r,s)?Nz(i):ic(0);let d=(a.left+l.x)/o.x,c=(a.top+l.y)/o.y,u=a.width/o.x,h=a.height/o.y;if(i){const f=ho(i),m=s&&Sl(s)?ho(s):s;let p=f,g=RS(p);for(;g&&s&&m!==p;){const x=Im(g),v=g.getBoundingClientRect(),y=Cl(g),b=v.left+(g.clientLeft+parseFloat(y.paddingLeft))*x.x,j=v.top+(g.clientTop+parseFloat(y.paddingTop))*x.y;d*=x.x,c*=x.y,u*=x.x,h*=x.y,d+=b,c+=j,p=ho(g),g=RS(p)}}return Zb({width:u,height:h,x:d,y:c})}function q6(e,t){const r=o_(e).scrollLeft;return t?t.left+r:Xh(yc(e)).left+r}function Sz(e,t,r){r===void 0&&(r=!1);const s=e.getBoundingClientRect(),a=s.left+t.scrollLeft-(r?0:q6(e,s)),i=s.top+t.scrollTop;return{x:a,y:i}}function fie(e){let{elements:t,rect:r,offsetParent:s,strategy:a}=e;const i=a==="fixed",o=yc(s),l=t?i_(t.floating):!1;if(s===o||l&&i)return r;let d={scrollLeft:0,scrollTop:0},c=ic(1);const u=ic(0),h=mc(s);if((h||!h&&!i)&&((rg(s)!=="body"||Xv(o))&&(d=o_(s)),mc(s))){const m=Xh(s);c=Im(s),u.x=m.x+s.clientLeft,u.y=m.y+s.clientTop}const f=o&&!h&&!i?Sz(o,d,!0):ic(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-d.scrollLeft*c.x+u.x+f.x,y:r.y*c.y-d.scrollTop*c.y+u.y+f.y}}function mie(e){return Array.from(e.getClientRects())}function pie(e){const t=yc(e),r=o_(e),s=e.ownerDocument.body,a=no(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),i=no(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight);let o=-r.scrollLeft+q6(e);const l=-r.scrollTop;return Cl(s).direction==="rtl"&&(o+=no(t.clientWidth,s.clientWidth)-a),{width:a,height:i,x:o,y:l}}function gie(e,t){const r=ho(e),s=yc(e),a=r.visualViewport;let i=s.clientWidth,o=s.clientHeight,l=0,d=0;if(a){i=a.width,o=a.height;const c=U6();(!c||c&&t==="fixed")&&(l=a.offsetLeft,d=a.offsetTop)}return{width:i,height:o,x:l,y:d}}const xie=new Set(["absolute","fixed"]);function vie(e,t){const r=Xh(e,!0,t==="fixed"),s=r.top+e.clientTop,a=r.left+e.clientLeft,i=mc(e)?Im(e):ic(1),o=e.clientWidth*i.x,l=e.clientHeight*i.y,d=a*i.x,c=s*i.y;return{width:o,height:l,x:d,y:c}}function KP(e,t,r){let s;if(t==="viewport")s=gie(e,r);else if(t==="document")s=pie(yc(e));else if(Sl(t))s=vie(t,r);else{const a=Nz(e);s={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return Zb(s)}function Cz(e,t){const r=wu(e);return r===t||!Sl(r)||lp(r)?!1:Cl(r).position==="fixed"||Cz(r,t)}function yie(e,t){const r=t.get(e);if(r)return r;let s=Ex(e,[],!1).filter(l=>Sl(l)&&rg(l)!=="body"),a=null;const i=Cl(e).position==="fixed";let o=i?wu(e):e;for(;Sl(o)&&!lp(o);){const l=Cl(o),d=z6(o);!d&&l.position==="fixed"&&(a=null),(i?!d&&!a:!d&&l.position==="static"&&!!a&&xie.has(a.position)||Xv(o)&&!d&&Cz(e,o))?s=s.filter(u=>u!==o):a=l,o=wu(o)}return t.set(e,s),s}function bie(e){let{element:t,boundary:r,rootBoundary:s,strategy:a}=e;const o=[...r==="clippingAncestors"?i_(t)?[]:yie(t,this._c):[].concat(r),s],l=o[0],d=o.reduce((c,u)=>{const h=KP(t,u,a);return c.top=no(h.top,c.top),c.right=bu(h.right,c.right),c.bottom=bu(h.bottom,c.bottom),c.left=no(h.left,c.left),c},KP(t,l,a));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function wie(e){const{width:t,height:r}=jz(e);return{width:t,height:r}}function _ie(e,t,r){const s=mc(t),a=yc(t),i=r==="fixed",o=Xh(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const d=ic(0);function c(){d.x=q6(a)}if(s||!s&&!i)if((rg(t)!=="body"||Xv(a))&&(l=o_(t)),s){const m=Xh(t,!0,i,t);d.x=m.x+t.clientLeft,d.y=m.y+t.clientTop}else a&&c();i&&!s&&a&&c();const u=a&&!s&&!i?Sz(a,l):ic(0),h=o.left+l.scrollLeft-d.x-u.x,f=o.top+l.scrollTop-d.y-u.y;return{x:h,y:f,width:o.width,height:o.height}}function RN(e){return Cl(e).position==="static"}function XP(e,t){if(!mc(e)||Cl(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return yc(e)===r&&(r=r.ownerDocument.body),r}function Ez(e,t){const r=ho(e);if(i_(e))return r;if(!mc(e)){let a=wu(e);for(;a&&!lp(a);){if(Sl(a)&&!RN(a))return a;a=wu(a)}return r}let s=XP(e,t);for(;s&&sie(s)&&RN(s);)s=XP(s,t);return s&&lp(s)&&RN(s)&&!z6(s)?r:s||cie(e)||r}const jie=async function(e){const t=this.getOffsetParent||Ez,r=this.getDimensions,s=await r(e.floating);return{reference:_ie(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function Nie(e){return Cl(e).direction==="rtl"}const Sie={convertOffsetParentRelativeRectToViewportRelativeRect:fie,getDocumentElement:yc,getClippingRect:bie,getOffsetParent:Ez,getElementRects:jie,getClientRects:mie,getDimensions:wie,getScale:Im,isElement:Sl,isRTL:Nie};function kz(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Cie(e,t){let r=null,s;const a=yc(e);function i(){var l;clearTimeout(s),(l=r)==null||l.disconnect(),r=null}function o(l,d){l===void 0&&(l=!1),d===void 0&&(d=1),i();const c=e.getBoundingClientRect(),{left:u,top:h,width:f,height:m}=c;if(l||t(),!f||!m)return;const p=ay(h),g=ay(a.clientWidth-(u+f)),x=ay(a.clientHeight-(h+m)),v=ay(u),b={rootMargin:-p+"px "+-g+"px "+-x+"px "+-v+"px",threshold:no(0,bu(1,d))||1};let j=!0;function T(O){const R=O[0].intersectionRatio;if(R!==d){if(!j)return o();R?o(!1,R):s=setTimeout(()=>{o(!1,1e-7)},1e3)}R===1&&!kz(c,e.getBoundingClientRect())&&o(),j=!1}try{r=new IntersectionObserver(T,{...b,root:a.ownerDocument})}catch{r=new IntersectionObserver(T,b)}r.observe(e)}return o(!0),i}function Eie(e,t,r,s){s===void 0&&(s={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:d=!1}=s,c=V6(e),u=a||i?[...c?Ex(c):[],...Ex(t)]:[];u.forEach(v=>{a&&v.addEventListener("scroll",r,{passive:!0}),i&&v.addEventListener("resize",r)});const h=c&&l?Cie(c,r):null;let f=-1,m=null;o&&(m=new ResizeObserver(v=>{let[y]=v;y&&y.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=m)==null||b.observe(t)})),r()}),c&&!d&&m.observe(c),m.observe(t));let p,g=d?Xh(e):null;d&&x();function x(){const v=Xh(e);g&&!kz(g,v)&&r(),g=v,p=requestAnimationFrame(x)}return r(),()=>{var v;u.forEach(y=>{a&&y.removeEventListener("scroll",r),i&&y.removeEventListener("resize",r)}),h==null||h(),(v=m)==null||v.disconnect(),m=null,d&&cancelAnimationFrame(p)}}const kie=Qae,Aie=Jae,Tie=Xae,Pie=tie,Oie=Yae,YP=Kae,Rie=eie,Mie=(e,t,r)=>{const s=new Map,a={platform:Sie,...r},i={...a.platform,_c:s};return Gae(e,t,{...a,platform:i})};var Iie=typeof document<"u",Die=function(){},ub=Iie?P.useLayoutEffect:Die;function Qb(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,s,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(s=r;s--!==0;)if(!Qb(e[s],t[s]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(s=r;s--!==0;)if(!{}.hasOwnProperty.call(t,a[s]))return!1;for(s=r;s--!==0;){const i=a[s];if(!(i==="_owner"&&e.$$typeof)&&!Qb(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function Az(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ZP(e,t){const r=Az(e);return Math.round(t*r)/r}function MN(e){const t=P.useRef(e);return ub(()=>{t.current=e}),t}function Lie(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:s=[],platform:a,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:d,open:c}=e,[u,h]=P.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[f,m]=P.useState(s);Qb(f,s)||m(s);const[p,g]=P.useState(null),[x,v]=P.useState(null),y=P.useCallback(C=>{C!==O.current&&(O.current=C,g(C))},[]),b=P.useCallback(C=>{C!==R.current&&(R.current=C,v(C))},[]),j=i||p,T=o||x,O=P.useRef(null),R=P.useRef(null),D=P.useRef(u),B=d!=null,q=MN(d),Y=MN(a),G=MN(c),I=P.useCallback(()=>{if(!O.current||!R.current)return;const C={placement:t,strategy:r,middleware:f};Y.current&&(C.platform=Y.current),Mie(O.current,R.current,C).then(k=>{const M={...k,isPositioned:G.current!==!1};F.current&&!Qb(D.current,M)&&(D.current=M,xf.flushSync(()=>{h(M)}))})},[f,t,r,Y,G]);ub(()=>{c===!1&&D.current.isPositioned&&(D.current.isPositioned=!1,h(C=>({...C,isPositioned:!1})))},[c]);const F=P.useRef(!1);ub(()=>(F.current=!0,()=>{F.current=!1}),[]),ub(()=>{if(j&&(O.current=j),T&&(R.current=T),j&&T){if(q.current)return q.current(j,T,I);I()}},[j,T,I,q,B]);const S=P.useMemo(()=>({reference:O,floating:R,setReference:y,setFloating:b}),[y,b]),E=P.useMemo(()=>({reference:j,floating:T}),[j,T]),N=P.useMemo(()=>{const C={position:r,left:0,top:0};if(!E.floating)return C;const k=ZP(E.floating,u.x),M=ZP(E.floating,u.y);return l?{...C,transform:"translate("+k+"px, "+M+"px)",...Az(E.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:k,top:M}},[r,l,E.floating,u.x,u.y]);return P.useMemo(()=>({...u,update:I,refs:S,elements:E,floatingStyles:N}),[u,I,S,E,N])}const Bie=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:s,padding:a}=typeof e=="function"?e(r):e;return s&&t(s)?s.current!=null?YP({element:s.current,padding:a}).fn(r):{}:s?YP({element:s,padding:a}).fn(r):{}}}},$ie=(e,t)=>({...kie(e),options:[e,t]}),Fie=(e,t)=>({...Aie(e),options:[e,t]}),zie=(e,t)=>({...Rie(e),options:[e,t]}),Uie=(e,t)=>({...Tie(e),options:[e,t]}),Vie=(e,t)=>({...Pie(e),options:[e,t]}),qie=(e,t)=>({...Oie(e),options:[e,t]}),Wie=(e,t)=>({...Bie(e),options:[e,t]});var Hie="Arrow",Tz=P.forwardRef((e,t)=>{const{children:r,width:s=10,height:a=5,...i}=e;return n.jsx(er.svg,{...i,ref:t,width:s,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:n.jsx("polygon",{points:"0,0 30,0 15,10"})})});Tz.displayName=Hie;var Gie=Tz;function l_(e){const[t,r]=P.useState(void 0);return ga(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const s=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,l;if("borderBoxSize"in i){const d=i.borderBoxSize,c=Array.isArray(d)?d[0]:d;o=c.inlineSize,l=c.blockSize}else o=e.offsetWidth,l=e.offsetHeight;r({width:o,height:l})});return s.observe(e,{box:"border-box"}),()=>s.unobserve(e)}else r(void 0)},[e]),t}var W6="Popper",[Pz,bc]=ea(W6),[Kie,Oz]=Pz(W6),Rz=e=>{const{__scopePopper:t,children:r}=e,[s,a]=P.useState(null);return n.jsx(Kie,{scope:t,anchor:s,onAnchorChange:a,children:r})};Rz.displayName=W6;var Mz="PopperAnchor",Iz=P.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:s,...a}=e,i=Oz(Mz,r),o=P.useRef(null),l=Rr(t,o);return P.useEffect(()=>{i.onAnchorChange((s==null?void 0:s.current)||o.current)}),s?null:n.jsx(er.div,{...a,ref:l})});Iz.displayName=Mz;var H6="PopperContent",[Xie,Yie]=Pz(H6),Dz=P.forwardRef((e,t)=>{var J,V,H,ee,ie,oe;const{__scopePopper:r,side:s="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:d=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:p,...g}=e,x=Oz(H6,r),[v,y]=P.useState(null),b=Rr(t,se=>y(se)),[j,T]=P.useState(null),O=l_(j),R=(O==null?void 0:O.width)??0,D=(O==null?void 0:O.height)??0,B=s+(i!=="center"?"-"+i:""),q=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},Y=Array.isArray(c)?c:[c],G=Y.length>0,I={padding:q,boundary:Y.filter(Qie),altBoundary:G},{refs:F,floatingStyles:S,placement:E,isPositioned:N,middlewareData:C}=Lie({strategy:"fixed",placement:B,whileElementsMounted:(...se)=>Eie(...se,{animationFrame:m==="always"}),elements:{reference:x.anchor},middleware:[$ie({mainAxis:a+D,alignmentAxis:o}),d&&Fie({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?zie():void 0,...I}),d&&Uie({...I}),Vie({...I,apply:({elements:se,rects:ue,availableWidth:pe,availableHeight:ce})=>{const{width:ne,height:me}=ue.reference,ge=se.floating.style;ge.setProperty("--radix-popper-available-width",`${pe}px`),ge.setProperty("--radix-popper-available-height",`${ce}px`),ge.setProperty("--radix-popper-anchor-width",`${ne}px`),ge.setProperty("--radix-popper-anchor-height",`${me}px`)}}),j&&Wie({element:j,padding:l}),Jie({arrowWidth:R,arrowHeight:D}),f&&qie({strategy:"referenceHidden",...I})]}),[k,M]=$z(E),U=Us(p);ga(()=>{N&&(U==null||U())},[N,U]);const $=(J=C.arrow)==null?void 0:J.x,X=(V=C.arrow)==null?void 0:V.y,Z=((H=C.arrow)==null?void 0:H.centerOffset)!==0,[re,W]=P.useState();return ga(()=>{v&&W(window.getComputedStyle(v).zIndex)},[v]),n.jsx("div",{ref:F.setFloating,"data-radix-popper-content-wrapper":"",style:{...S,transform:N?S.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,"--radix-popper-transform-origin":[(ee=C.transformOrigin)==null?void 0:ee.x,(ie=C.transformOrigin)==null?void 0:ie.y].join(" "),...((oe=C.hide)==null?void 0:oe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:n.jsx(Xie,{scope:r,placedSide:k,onArrowChange:T,arrowX:$,arrowY:X,shouldHideArrow:Z,children:n.jsx(er.div,{"data-side":k,"data-align":M,...g,ref:b,style:{...g.style,animation:N?void 0:"none"}})})})});Dz.displayName=H6;var Lz="PopperArrow",Zie={top:"bottom",right:"left",bottom:"top",left:"right"},Bz=P.forwardRef(function(t,r){const{__scopePopper:s,...a}=t,i=Yie(Lz,s),o=Zie[i.placedSide];return n.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:n.jsx(Gie,{...a,ref:r,style:{...a.style,display:"block"}})})});Bz.displayName=Lz;function Qie(e){return e!==null}var Jie=e=>({name:"transformOrigin",options:e,fn(t){var x,v,y;const{placement:r,rects:s,middlewareData:a}=t,o=((x=a.arrow)==null?void 0:x.centerOffset)!==0,l=o?0:e.arrowWidth,d=o?0:e.arrowHeight,[c,u]=$z(r),h={start:"0%",center:"50%",end:"100%"}[u],f=(((v=a.arrow)==null?void 0:v.x)??0)+l/2,m=(((y=a.arrow)==null?void 0:y.y)??0)+d/2;let p="",g="";return c==="bottom"?(p=o?h:`${f}px`,g=`${-d}px`):c==="top"?(p=o?h:`${f}px`,g=`${s.floating.height+d}px`):c==="right"?(p=`${-d}px`,g=o?h:`${m}px`):c==="left"&&(p=`${s.floating.width+d}px`,g=o?h:`${m}px`),{data:{x:p,y:g}}}});function $z(e){const[t,r="center"]=e.split("-");return[t,r]}var Yv=Rz,ng=Iz,Zv=Dz,Qv=Bz,[c_,GZe]=ea("Tooltip",[bc]),d_=bc(),Fz="TooltipProvider",eoe=700,MS="tooltip.open",[toe,G6]=c_(Fz),zz=e=>{const{__scopeTooltip:t,delayDuration:r=eoe,skipDelayDuration:s=300,disableHoverableContent:a=!1,children:i}=e,o=P.useRef(!0),l=P.useRef(!1),d=P.useRef(0);return P.useEffect(()=>{const c=d.current;return()=>window.clearTimeout(c)},[]),n.jsx(toe,{scope:t,isOpenDelayedRef:o,delayDuration:r,onOpen:P.useCallback(()=>{window.clearTimeout(d.current),o.current=!1},[]),onClose:P.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>o.current=!0,s)},[s]),isPointerInTransitRef:l,onPointerInTransitChange:P.useCallback(c=>{l.current=c},[]),disableHoverableContent:a,children:i})};zz.displayName=Fz;var kx="Tooltip",[roe,u_]=c_(kx),Uz=e=>{const{__scopeTooltip:t,children:r,open:s,defaultOpen:a,onOpenChange:i,disableHoverableContent:o,delayDuration:l}=e,d=G6(kx,e.__scopeTooltip),c=d_(t),[u,h]=P.useState(null),f=pa(),m=P.useRef(0),p=o??d.disableHoverableContent,g=l??d.delayDuration,x=P.useRef(!1),[v,y]=Ui({prop:s,defaultProp:a??!1,onChange:R=>{R?(d.onOpen(),document.dispatchEvent(new CustomEvent(MS))):d.onClose(),i==null||i(R)},caller:kx}),b=P.useMemo(()=>v?x.current?"delayed-open":"instant-open":"closed",[v]),j=P.useCallback(()=>{window.clearTimeout(m.current),m.current=0,x.current=!1,y(!0)},[y]),T=P.useCallback(()=>{window.clearTimeout(m.current),m.current=0,y(!1)},[y]),O=P.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{x.current=!0,y(!0),m.current=0},g)},[g,y]);return P.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),n.jsx(Yv,{...c,children:n.jsx(roe,{scope:t,contentId:f,open:v,stateAttribute:b,trigger:u,onTriggerChange:h,onTriggerEnter:P.useCallback(()=>{d.isOpenDelayedRef.current?O():j()},[d.isOpenDelayedRef,O,j]),onTriggerLeave:P.useCallback(()=>{p?T():(window.clearTimeout(m.current),m.current=0)},[T,p]),onOpen:j,onClose:T,disableHoverableContent:p,children:r})})};Uz.displayName=kx;var IS="TooltipTrigger",Vz=P.forwardRef((e,t)=>{const{__scopeTooltip:r,...s}=e,a=u_(IS,r),i=G6(IS,r),o=d_(r),l=P.useRef(null),d=Rr(t,l,a.onTriggerChange),c=P.useRef(!1),u=P.useRef(!1),h=P.useCallback(()=>c.current=!1,[]);return P.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),n.jsx(ng,{asChild:!0,...o,children:n.jsx(er.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...s,ref:d,onPointerMove:Tt(e.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:Tt(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:Tt(e.onPointerDown,()=>{a.open&&a.onClose(),c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Tt(e.onFocus,()=>{c.current||a.onOpen()}),onBlur:Tt(e.onBlur,a.onClose),onClick:Tt(e.onClick,a.onClose)})})});Vz.displayName=IS;var noe="TooltipPortal",[KZe,soe]=c_(noe,{forceMount:void 0}),cp="TooltipContent",qz=P.forwardRef((e,t)=>{const r=soe(cp,e.__scopeTooltip),{forceMount:s=r.forceMount,side:a="top",...i}=e,o=u_(cp,e.__scopeTooltip);return n.jsx(Ws,{present:s||o.open,children:o.disableHoverableContent?n.jsx(Wz,{side:a,...i,ref:t}):n.jsx(aoe,{side:a,...i,ref:t})})}),aoe=P.forwardRef((e,t)=>{const r=u_(cp,e.__scopeTooltip),s=G6(cp,e.__scopeTooltip),a=P.useRef(null),i=Rr(t,a),[o,l]=P.useState(null),{trigger:d,onClose:c}=r,u=a.current,{onPointerInTransitChange:h}=s,f=P.useCallback(()=>{l(null),h(!1)},[h]),m=P.useCallback((p,g)=>{const x=p.currentTarget,v={x:p.clientX,y:p.clientY},y=doe(v,x.getBoundingClientRect()),b=uoe(v,y),j=hoe(g.getBoundingClientRect()),T=moe([...b,...j]);l(T),h(!0)},[h]);return P.useEffect(()=>()=>f(),[f]),P.useEffect(()=>{if(d&&u){const p=x=>m(x,u),g=x=>m(x,d);return d.addEventListener("pointerleave",p),u.addEventListener("pointerleave",g),()=>{d.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",g)}}},[d,u,m,f]),P.useEffect(()=>{if(o){const p=g=>{const x=g.target,v={x:g.clientX,y:g.clientY},y=(d==null?void 0:d.contains(x))||(u==null?void 0:u.contains(x)),b=!foe(v,o);y?f():b&&(f(),c())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[d,u,o,c,f]),n.jsx(Wz,{...e,ref:i})}),[ioe,ooe]=c_(kx,{isInside:!1}),loe=wF("TooltipContent"),Wz=P.forwardRef((e,t)=>{const{__scopeTooltip:r,children:s,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=e,d=u_(cp,r),c=d_(r),{onClose:u}=d;return P.useEffect(()=>(document.addEventListener(MS,u),()=>document.removeEventListener(MS,u)),[u]),P.useEffect(()=>{if(d.trigger){const h=f=>{const m=f.target;m!=null&&m.contains(d.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[d.trigger,u]),n.jsx(Ou,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:n.jsxs(Zv,{"data-state":d.stateAttribute,...c,...l,ref:t,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[n.jsx(loe,{children:s}),n.jsx(ioe,{scope:r,isInside:!0,children:n.jsx(yne,{id:d.contentId,role:"tooltip",children:a||s})})]})})});qz.displayName=cp;var Hz="TooltipArrow",coe=P.forwardRef((e,t)=>{const{__scopeTooltip:r,...s}=e,a=d_(r);return ooe(Hz,r).isInside?null:n.jsx(Qv,{...a,...s,ref:t})});coe.displayName=Hz;function doe(e,t){const r=Math.abs(t.top-e.y),s=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,s,a,i)){case i:return"left";case a:return"right";case r:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function uoe(e,t,r=5){const s=[];switch(t){case"top":s.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":s.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":s.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":s.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return s}function hoe(e){const{top:t,right:r,bottom:s,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:s},{x:a,y:s}]}function foe(e,t){const{x:r,y:s}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],d=t[o],c=l.x,u=l.y,h=d.x,f=d.y;u>s!=f>s&&r<(h-c)*(s-u)/(f-u)+c&&(a=!a)}return a}function moe(e){const t=e.slice();return t.sort((r,s)=>r.x<s.x?-1:r.x>s.x?1:r.y<s.y?-1:r.y>s.y?1:0),poe(t)}function poe(e){if(e.length<=1)return e.slice();const t=[];for(let s=0;s<e.length;s++){const a=e[s];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let s=e.length-1;s>=0;s--){const a=e[s];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var goe=zz,xoe=Uz,voe=Vz,Gz=qz;const dp=goe,$a=xoe,Fa=voe,Sa=P.forwardRef(({className:e,sideOffset:t=4,...r},s)=>n.jsx(Gz,{ref:s,sideOffset:t,className:He("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));Sa.displayName=Gz.displayName;var h_=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},f_=typeof window>"u"||"Deno"in globalThis;function ol(){}function yoe(e,t){return typeof e=="function"?e(t):e}function boe(e){return typeof e=="number"&&e>=0&&e!==1/0}function woe(e,t){return Math.max(e+(t||0)-Date.now(),0)}function DS(e,t){return typeof e=="function"?e(t):e}function _oe(e,t){return typeof e=="function"?e(t):e}function QP(e,t){const{type:r="all",exact:s,fetchStatus:a,predicate:i,queryKey:o,stale:l}=e;if(o){if(s){if(t.queryHash!==K6(o,t.options))return!1}else if(!Tx(t.queryKey,o))return!1}if(r!=="all"){const d=t.isActive();if(r==="active"&&!d||r==="inactive"&&d)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||a&&a!==t.state.fetchStatus||i&&!i(t))}function JP(e,t){const{exact:r,status:s,predicate:a,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Ax(t.options.mutationKey)!==Ax(i))return!1}else if(!Tx(t.options.mutationKey,i))return!1}return!(s&&t.state.status!==s||a&&!a(t))}function K6(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ax)(e)}function Ax(e){return JSON.stringify(e,(t,r)=>LS(r)?Object.keys(r).sort().reduce((s,a)=>(s[a]=r[a],s),{}):r)}function Tx(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Tx(e[r],t[r])):!1}function Kz(e,t){if(e===t)return e;const r=eO(e)&&eO(t);if(r||LS(e)&&LS(t)){const s=r?e:Object.keys(e),a=s.length,i=r?t:Object.keys(t),o=i.length,l=r?[]:{},d=new Set(s);let c=0;for(let u=0;u<o;u++){const h=r?u:i[u];(!r&&d.has(h)||r)&&e[h]===void 0&&t[h]===void 0?(l[h]=void 0,c++):(l[h]=Kz(e[h],t[h]),l[h]===e[h]&&e[h]!==void 0&&c++)}return a===o&&c===a?e:l}return t}function eO(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function LS(e){if(!tO(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!tO(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function tO(e){return Object.prototype.toString.call(e)==="[object Object]"}function joe(e){return new Promise(t=>{setTimeout(t,e)})}function Noe(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Kz(e,t):t}function Soe(e,t,r=0){const s=[...e,t];return r&&s.length>r?s.slice(1):s}function Coe(e,t,r=0){const s=[t,...e];return r&&s.length>r?s.slice(0,-1):s}var X6=Symbol();function Xz(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===X6?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var kh,Ud,Wm,ZL,Eoe=(ZL=class extends h_{constructor(){super();En(this,kh);En(this,Ud);En(this,Wm);qr(this,Wm,t=>{if(!f_&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){Ct(this,Ud)||this.setEventListener(Ct(this,Wm))}onUnsubscribe(){var t;this.hasListeners()||((t=Ct(this,Ud))==null||t.call(this),qr(this,Ud,void 0))}setEventListener(t){var r;qr(this,Wm,t),(r=Ct(this,Ud))==null||r.call(this),qr(this,Ud,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){Ct(this,kh)!==t&&(qr(this,kh,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof Ct(this,kh)=="boolean"?Ct(this,kh):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},kh=new WeakMap,Ud=new WeakMap,Wm=new WeakMap,ZL),Yz=new Eoe,Hm,Vd,Gm,QL,koe=(QL=class extends h_{constructor(){super();En(this,Hm,!0);En(this,Vd);En(this,Gm);qr(this,Gm,t=>{if(!f_&&window.addEventListener){const r=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",s)}}})}onSubscribe(){Ct(this,Vd)||this.setEventListener(Ct(this,Gm))}onUnsubscribe(){var t;this.hasListeners()||((t=Ct(this,Vd))==null||t.call(this),qr(this,Vd,void 0))}setEventListener(t){var r;qr(this,Gm,t),(r=Ct(this,Vd))==null||r.call(this),qr(this,Vd,t(this.setOnline.bind(this)))}setOnline(t){Ct(this,Hm)!==t&&(qr(this,Hm,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return Ct(this,Hm)}},Hm=new WeakMap,Vd=new WeakMap,Gm=new WeakMap,QL),Jb=new koe;function Aoe(){let e,t;const r=new Promise((a,i)=>{e=a,t=i});r.status="pending",r.catch(()=>{});function s(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{s({status:"fulfilled",value:a}),e(a)},r.reject=a=>{s({status:"rejected",reason:a}),t(a)},r}function Toe(e){return Math.min(1e3*2**e,3e4)}function Zz(e){return(e??"online")==="online"?Jb.isOnline():!0}var Qz=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function IN(e){return e instanceof Qz}function Jz(e){let t=!1,r=0,s=!1,a;const i=Aoe(),o=g=>{var x;s||(f(new Qz(g)),(x=e.abort)==null||x.call(e))},l=()=>{t=!0},d=()=>{t=!1},c=()=>Yz.isFocused()&&(e.networkMode==="always"||Jb.isOnline())&&e.canRun(),u=()=>Zz(e.networkMode)&&e.canRun(),h=g=>{var x;s||(s=!0,(x=e.onSuccess)==null||x.call(e,g),a==null||a(),i.resolve(g))},f=g=>{var x;s||(s=!0,(x=e.onError)==null||x.call(e,g),a==null||a(),i.reject(g))},m=()=>new Promise(g=>{var x;a=v=>{(s||c())&&g(v)},(x=e.onPause)==null||x.call(e)}).then(()=>{var g;a=void 0,s||(g=e.onContinue)==null||g.call(e)}),p=()=>{if(s)return;let g;const x=r===0?e.initialPromise:void 0;try{g=x??e.fn()}catch(v){g=Promise.reject(v)}Promise.resolve(g).then(h).catch(v=>{var O;if(s)return;const y=e.retry??(f_?0:3),b=e.retryDelay??Toe,j=typeof b=="function"?b(r,v):b,T=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,v);if(t||!T){f(v);return}r++,(O=e.onFail)==null||O.call(e,r,v),joe(j).then(()=>c()?void 0:m()).then(()=>{t?f(v):p()})})};return{promise:i,cancel:o,continue:()=>(a==null||a(),i),cancelRetry:l,continueRetry:d,canStart:u,start:()=>(u()?p():m().then(p),i)}}var Poe=e=>setTimeout(e,0);function Ooe(){let e=[],t=0,r=l=>{l()},s=l=>{l()},a=Poe;const i=l=>{t?e.push(l):a(()=>{r(l)})},o=()=>{const l=e;e=[],l.length&&a(()=>{s(()=>{l.forEach(d=>{r(d)})})})};return{batch:l=>{let d;t++;try{d=l()}finally{t--,t||o()}return d},batchCalls:l=>(...d)=>{i(()=>{l(...d)})},schedule:i,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{s=l},setScheduler:l=>{a=l}}}var pi=Ooe(),Ah,JL,eU=(JL=class{constructor(){En(this,Ah)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),boe(this.gcTime)&&qr(this,Ah,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(f_?1/0:5*60*1e3))}clearGcTimeout(){Ct(this,Ah)&&(clearTimeout(Ct(this,Ah)),qr(this,Ah,void 0))}},Ah=new WeakMap,JL),Km,Th,ko,Ph,Qa,$v,Oh,cl,Rc,eB,Roe=(eB=class extends eU{constructor(t){super();En(this,cl);En(this,Km);En(this,Th);En(this,ko);En(this,Ph);En(this,Qa);En(this,$v);En(this,Oh);qr(this,Oh,!1),qr(this,$v,t.defaultOptions),this.setOptions(t.options),this.observers=[],qr(this,Ph,t.client),qr(this,ko,Ct(this,Ph).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,qr(this,Km,Ioe(this.options)),this.state=t.state??Ct(this,Km),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Ct(this,Qa))==null?void 0:t.promise}setOptions(t){this.options={...Ct(this,$v),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Ct(this,ko).remove(this)}setData(t,r){const s=Noe(this.state.data,t,this.options);return Xa(this,cl,Rc).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(t,r){Xa(this,cl,Rc).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var s,a;const r=(s=Ct(this,Qa))==null?void 0:s.promise;return(a=Ct(this,Qa))==null||a.cancel(t),r?r.then(ol).catch(ol):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Ct(this,Km))}isActive(){return this.observers.some(t=>_oe(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===X6||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>DS(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!woe(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=Ct(this,Qa))==null||r.continue()}onOnline(){var r;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=Ct(this,Qa))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Ct(this,ko).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(Ct(this,Qa)&&(Ct(this,Oh)?Ct(this,Qa).cancel({revert:!0}):Ct(this,Qa).cancelRetry()),this.scheduleGc()),Ct(this,ko).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Xa(this,cl,Rc).call(this,{type:"invalidate"})}fetch(t,r){var c,u,h;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Ct(this,Qa))return Ct(this,Qa).continueRetry(),Ct(this,Qa).promise}if(t&&this.setOptions(t),!this.options.queryFn){const f=this.observers.find(m=>m.options.queryFn);f&&this.setOptions(f.options)}const s=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(qr(this,Oh,!0),s.signal)})},i=()=>{const f=Xz(this.options,r),p=(()=>{const g={client:Ct(this,Ph),queryKey:this.queryKey,meta:this.meta};return a(g),g})();return qr(this,Oh,!1),this.options.persister?this.options.persister(f,p,this):f(p)},l=(()=>{const f={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Ct(this,Ph),state:this.state,fetchFn:i};return a(f),f})();(c=this.options.behavior)==null||c.onFetch(l,this),qr(this,Th,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=l.fetchOptions)==null?void 0:u.meta))&&Xa(this,cl,Rc).call(this,{type:"fetch",meta:(h=l.fetchOptions)==null?void 0:h.meta});const d=f=>{var m,p,g,x;IN(f)&&f.silent||Xa(this,cl,Rc).call(this,{type:"error",error:f}),IN(f)||((p=(m=Ct(this,ko).config).onError)==null||p.call(m,f,this),(x=(g=Ct(this,ko).config).onSettled)==null||x.call(g,this.state.data,f,this)),this.scheduleGc()};return qr(this,Qa,Jz({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,abort:s.abort.bind(s),onSuccess:f=>{var m,p,g,x;if(f===void 0){d(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(v){d(v);return}(p=(m=Ct(this,ko).config).onSuccess)==null||p.call(m,f,this),(x=(g=Ct(this,ko).config).onSettled)==null||x.call(g,f,this.state.error,this),this.scheduleGc()},onError:d,onFail:(f,m)=>{Xa(this,cl,Rc).call(this,{type:"failed",failureCount:f,error:m})},onPause:()=>{Xa(this,cl,Rc).call(this,{type:"pause"})},onContinue:()=>{Xa(this,cl,Rc).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),Ct(this,Qa).start()}},Km=new WeakMap,Th=new WeakMap,ko=new WeakMap,Ph=new WeakMap,Qa=new WeakMap,$v=new WeakMap,Oh=new WeakMap,cl=new WeakSet,Rc=function(t){const r=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...Moe(s.data,this.options),fetchMeta:t.meta??null};case"success":return qr(this,Th,void 0),{...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return IN(a)&&a.revert&&Ct(this,Th)?{...Ct(this,Th),fetchStatus:"idle"}:{...s,error:a,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=r(this.state),pi.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),Ct(this,ko).notify({query:this,type:"updated",action:t})})},eB);function Moe(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Zz(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Ioe(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,s=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var ql,tB,Doe=(tB=class extends h_{constructor(t={}){super();En(this,ql);this.config=t,qr(this,ql,new Map)}build(t,r,s){const a=r.queryKey,i=r.queryHash??K6(a,r);let o=this.get(i);return o||(o=new Roe({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(r),state:s,defaultOptions:t.getQueryDefaults(a)}),this.add(o)),o}add(t){Ct(this,ql).has(t.queryHash)||(Ct(this,ql).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=Ct(this,ql).get(t.queryHash);r&&(t.destroy(),r===t&&Ct(this,ql).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){pi.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Ct(this,ql).get(t)}getAll(){return[...Ct(this,ql).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(s=>QP(r,s))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(s=>QP(t,s)):r}notify(t){pi.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){pi.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){pi.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ql=new WeakMap,tB),Wl,hi,Rh,Hl,Ad,rB,Loe=(rB=class extends eU{constructor(t){super();En(this,Hl);En(this,Wl);En(this,hi);En(this,Rh);this.mutationId=t.mutationId,qr(this,hi,t.mutationCache),qr(this,Wl,[]),this.state=t.state||Boe(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Ct(this,Wl).includes(t)||(Ct(this,Wl).push(t),this.clearGcTimeout(),Ct(this,hi).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){qr(this,Wl,Ct(this,Wl).filter(r=>r!==t)),this.scheduleGc(),Ct(this,hi).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Ct(this,Wl).length||(this.state.status==="pending"?this.scheduleGc():Ct(this,hi).remove(this))}continue(){var t;return((t=Ct(this,Rh))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,o,l,d,c,u,h,f,m,p,g,x,v,y,b,j,T,O,R,D;const r=()=>{Xa(this,Hl,Ad).call(this,{type:"continue"})};qr(this,Rh,Jz({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(B,q)=>{Xa(this,Hl,Ad).call(this,{type:"failed",failureCount:B,error:q})},onPause:()=>{Xa(this,Hl,Ad).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Ct(this,hi).canRun(this)}));const s=this.state.status==="pending",a=!Ct(this,Rh).canStart();try{if(s)r();else{Xa(this,Hl,Ad).call(this,{type:"pending",variables:t,isPaused:a}),await((o=(i=Ct(this,hi).config).onMutate)==null?void 0:o.call(i,t,this));const q=await((d=(l=this.options).onMutate)==null?void 0:d.call(l,t));q!==this.state.context&&Xa(this,Hl,Ad).call(this,{type:"pending",context:q,variables:t,isPaused:a})}const B=await Ct(this,Rh).start();return await((u=(c=Ct(this,hi).config).onSuccess)==null?void 0:u.call(c,B,t,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,B,t,this.state.context)),await((p=(m=Ct(this,hi).config).onSettled)==null?void 0:p.call(m,B,null,this.state.variables,this.state.context,this)),await((x=(g=this.options).onSettled)==null?void 0:x.call(g,B,null,t,this.state.context)),Xa(this,Hl,Ad).call(this,{type:"success",data:B}),B}catch(B){try{throw await((y=(v=Ct(this,hi).config).onError)==null?void 0:y.call(v,B,t,this.state.context,this)),await((j=(b=this.options).onError)==null?void 0:j.call(b,B,t,this.state.context)),await((O=(T=Ct(this,hi).config).onSettled)==null?void 0:O.call(T,void 0,B,this.state.variables,this.state.context,this)),await((D=(R=this.options).onSettled)==null?void 0:D.call(R,void 0,B,t,this.state.context)),B}finally{Xa(this,Hl,Ad).call(this,{type:"error",error:B})}}finally{Ct(this,hi).runNext(this)}}},Wl=new WeakMap,hi=new WeakMap,Rh=new WeakMap,Hl=new WeakSet,Ad=function(t){const r=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),pi.batch(()=>{Ct(this,Wl).forEach(s=>{s.onMutationUpdate(t)}),Ct(this,hi).notify({mutation:this,type:"updated",action:t})})},rB);function Boe(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Bc,dl,Fv,nB,$oe=(nB=class extends h_{constructor(t={}){super();En(this,Bc);En(this,dl);En(this,Fv);this.config=t,qr(this,Bc,new Set),qr(this,dl,new Map),qr(this,Fv,0)}build(t,r,s){const a=new Loe({mutationCache:this,mutationId:++B1(this,Fv)._,options:t.defaultMutationOptions(r),state:s});return this.add(a),a}add(t){Ct(this,Bc).add(t);const r=iy(t);if(typeof r=="string"){const s=Ct(this,dl).get(r);s?s.push(t):Ct(this,dl).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Ct(this,Bc).delete(t)){const r=iy(t);if(typeof r=="string"){const s=Ct(this,dl).get(r);if(s)if(s.length>1){const a=s.indexOf(t);a!==-1&&s.splice(a,1)}else s[0]===t&&Ct(this,dl).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=iy(t);if(typeof r=="string"){const s=Ct(this,dl).get(r),a=s==null?void 0:s.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var s;const r=iy(t);if(typeof r=="string"){const a=(s=Ct(this,dl).get(r))==null?void 0:s.find(i=>i!==t&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){pi.batch(()=>{Ct(this,Bc).forEach(t=>{this.notify({type:"removed",mutation:t})}),Ct(this,Bc).clear(),Ct(this,dl).clear()})}getAll(){return Array.from(Ct(this,Bc))}find(t){const r={exact:!0,...t};return this.getAll().find(s=>JP(r,s))}findAll(t={}){return this.getAll().filter(r=>JP(t,r))}notify(t){pi.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return pi.batch(()=>Promise.all(t.map(r=>r.continue().catch(ol))))}},Bc=new WeakMap,dl=new WeakMap,Fv=new WeakMap,nB);function iy(e){var t;return(t=e.options.scope)==null?void 0:t.id}function rO(e){return{onFetch:(t,r)=>{var u,h,f,m,p;const s=t.options,a=(f=(h=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((m=t.state.data)==null?void 0:m.pages)||[],o=((p=t.state.data)==null?void 0:p.pageParams)||[];let l={pages:[],pageParams:[]},d=0;const c=async()=>{let g=!1;const x=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},v=Xz(t.options,t.fetchOptions),y=async(b,j,T)=>{if(g)return Promise.reject();if(j==null&&b.pages.length)return Promise.resolve(b);const R=(()=>{const Y={client:t.client,queryKey:t.queryKey,pageParam:j,direction:T?"backward":"forward",meta:t.options.meta};return x(Y),Y})(),D=await v(R),{maxPages:B}=t.options,q=T?Coe:Soe;return{pages:q(b.pages,D,B),pageParams:q(b.pageParams,j,B)}};if(a&&i.length){const b=a==="backward",j=b?Foe:nO,T={pages:i,pageParams:o},O=j(s,T);l=await y(T,O,b)}else{const b=e??i.length;do{const j=d===0?o[0]??s.initialPageParam:nO(s,l);if(d>0&&j==null)break;l=await y(l,j),d++}while(d<b)}return l};t.options.persister?t.fetchFn=()=>{var g,x;return(x=(g=t.options).persister)==null?void 0:x.call(g,c,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=c}}}function nO(e,{pages:t,pageParams:r}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,r[s],r):void 0}function Foe(e,{pages:t,pageParams:r}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,r[0],r):void 0}var Rs,qd,Wd,Xm,Ym,Hd,Zm,Qm,sB,zoe=(sB=class{constructor(e={}){En(this,Rs);En(this,qd);En(this,Wd);En(this,Xm);En(this,Ym);En(this,Hd);En(this,Zm);En(this,Qm);qr(this,Rs,e.queryCache||new Doe),qr(this,qd,e.mutationCache||new $oe),qr(this,Wd,e.defaultOptions||{}),qr(this,Xm,new Map),qr(this,Ym,new Map),qr(this,Hd,0)}mount(){B1(this,Hd)._++,Ct(this,Hd)===1&&(qr(this,Zm,Yz.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ct(this,Rs).onFocus())})),qr(this,Qm,Jb.subscribe(async e=>{e&&(await this.resumePausedMutations(),Ct(this,Rs).onOnline())})))}unmount(){var e,t;B1(this,Hd)._--,Ct(this,Hd)===0&&((e=Ct(this,Zm))==null||e.call(this),qr(this,Zm,void 0),(t=Ct(this,Qm))==null||t.call(this),qr(this,Qm,void 0))}isFetching(e){return Ct(this,Rs).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Ct(this,qd).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Ct(this,Rs).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=Ct(this,Rs).build(this,t),s=r.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(DS(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return Ct(this,Rs).findAll(e).map(({queryKey:t,state:r})=>{const s=r.data;return[t,s]})}setQueryData(e,t,r){const s=this.defaultQueryOptions({queryKey:e}),a=Ct(this,Rs).get(s.queryHash),i=a==null?void 0:a.state.data,o=yoe(t,i);if(o!==void 0)return Ct(this,Rs).build(this,s).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return pi.batch(()=>Ct(this,Rs).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Ct(this,Rs).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=Ct(this,Rs);pi.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=Ct(this,Rs);return pi.batch(()=>(r.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},s=pi.batch(()=>Ct(this,Rs).findAll(e).map(a=>a.cancel(r)));return Promise.all(s).then(ol).catch(ol)}invalidateQueries(e,t={}){return pi.batch(()=>(Ct(this,Rs).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},s=pi.batch(()=>Ct(this,Rs).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,r);return r.throwOnError||(i=i.catch(ol)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(ol)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=Ct(this,Rs).build(this,t);return r.isStaleByTime(DS(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ol).catch(ol)}fetchInfiniteQuery(e){return e.behavior=rO(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ol).catch(ol)}ensureInfiniteQueryData(e){return e.behavior=rO(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Jb.isOnline()?Ct(this,qd).resumePausedMutations():Promise.resolve()}getQueryCache(){return Ct(this,Rs)}getMutationCache(){return Ct(this,qd)}getDefaultOptions(){return Ct(this,Wd)}setDefaultOptions(e){qr(this,Wd,e)}setQueryDefaults(e,t){Ct(this,Xm).set(Ax(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Ct(this,Xm).values()],r={};return t.forEach(s=>{Tx(e,s.queryKey)&&Object.assign(r,s.defaultOptions)}),r}setMutationDefaults(e,t){Ct(this,Ym).set(Ax(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Ct(this,Ym).values()],r={};return t.forEach(s=>{Tx(e,s.mutationKey)&&Object.assign(r,s.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Ct(this,Wd).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=K6(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===X6&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Ct(this,Wd).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Ct(this,Rs).clear(),Ct(this,qd).clear()}},Rs=new WeakMap,qd=new WeakMap,Wd=new WeakMap,Xm=new WeakMap,Ym=new WeakMap,Hd=new WeakMap,Zm=new WeakMap,Qm=new WeakMap,sB),Uoe=P.createContext(void 0),Voe=({client:e,children:t})=>(P.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),n.jsx(Uoe.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Px(){return Px=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Px.apply(this,arguments)}var Xd;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Xd||(Xd={}));const sO="popstate";function qoe(e){e===void 0&&(e={});function t(s,a){let{pathname:i,search:o,hash:l}=s.location;return BS("",{pathname:i,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(s,a){return typeof a=="string"?a:ew(a)}return Hoe(t,r,null,e)}function qs(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function tU(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Woe(){return Math.random().toString(36).substr(2,8)}function aO(e,t){return{usr:e.state,key:e.key,idx:t}}function BS(e,t,r,s){return r===void 0&&(r=null),Px({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?sg(t):t,{state:r,key:t&&t.key||s||Woe()})}function ew(e){let{pathname:t="/",search:r="",hash:s=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function sg(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function Hoe(e,t,r,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:i=!1}=s,o=a.history,l=Xd.Pop,d=null,c=u();c==null&&(c=0,o.replaceState(Px({},o.state,{idx:c}),""));function u(){return(o.state||{idx:null}).idx}function h(){l=Xd.Pop;let x=u(),v=x==null?null:x-c;c=x,d&&d({action:l,location:g.location,delta:v})}function f(x,v){l=Xd.Push;let y=BS(g.location,x,v);c=u()+1;let b=aO(y,c),j=g.createHref(y);try{o.pushState(b,"",j)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;a.location.assign(j)}i&&d&&d({action:l,location:g.location,delta:1})}function m(x,v){l=Xd.Replace;let y=BS(g.location,x,v);c=u();let b=aO(y,c),j=g.createHref(y);o.replaceState(b,"",j),i&&d&&d({action:l,location:g.location,delta:0})}function p(x){let v=a.location.origin!=="null"?a.location.origin:a.location.href,y=typeof x=="string"?x:ew(x);return y=y.replace(/ $/,"%20"),qs(v,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,v)}let g={get action(){return l},get location(){return e(a,o)},listen(x){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(sO,h),d=x,()=>{a.removeEventListener(sO,h),d=null}},createHref(x){return t(a,x)},createURL:p,encodeLocation(x){let v=p(x);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:m,go(x){return o.go(x)}};return g}var iO;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(iO||(iO={}));function Goe(e,t,r){return r===void 0&&(r="/"),Koe(e,t,r,!1)}function Koe(e,t,r,s){let a=typeof t=="string"?sg(t):t,i=Y6(a.pathname||"/",r);if(i==null)return null;let o=rU(e);Xoe(o);let l=null;for(let d=0;l==null&&d<o.length;++d){let c=ile(i);l=sle(o[d],c,s)}return l}function rU(e,t,r,s){t===void 0&&(t=[]),r===void 0&&(r=[]),s===void 0&&(s="");let a=(i,o,l)=>{let d={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};d.relativePath.startsWith("/")&&(qs(d.relativePath.startsWith(s),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(s.length));let c=hu([s,d.relativePath]),u=r.concat(d);i.children&&i.children.length>0&&(qs(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),rU(i.children,t,u,c)),!(i.path==null&&!i.index)&&t.push({path:c,score:rle(c,i.index),routesMeta:u})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))a(i,o);else for(let d of nU(i.path))a(i,o,d)}),t}function nU(e){let t=e.split("/");if(t.length===0)return[];let[r,...s]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(s.length===0)return a?[i,""]:[i];let o=nU(s.join("/")),l=[];return l.push(...o.map(d=>d===""?i:[i,d].join("/"))),a&&l.push(...o),l.map(d=>e.startsWith("/")&&d===""?"/":d)}function Xoe(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:nle(t.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}const Yoe=/^:[\w-]+$/,Zoe=3,Qoe=2,Joe=1,ele=10,tle=-2,oO=e=>e==="*";function rle(e,t){let r=e.split("/"),s=r.length;return r.some(oO)&&(s+=tle),t&&(s+=Qoe),r.filter(a=>!oO(a)).reduce((a,i)=>a+(Yoe.test(i)?Zoe:i===""?Joe:ele),s)}function nle(e,t){return e.length===t.length&&e.slice(0,-1).every((s,a)=>s===t[a])?e[e.length-1]-t[t.length-1]:0}function sle(e,t,r){let{routesMeta:s}=e,a={},i="/",o=[];for(let l=0;l<s.length;++l){let d=s[l],c=l===s.length-1,u=i==="/"?t:t.slice(i.length)||"/",h=lO({path:d.relativePath,caseSensitive:d.caseSensitive,end:c},u),f=d.route;if(!h&&c&&r&&!s[s.length-1].route.index&&(h=lO({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},u)),!h)return null;Object.assign(a,h.params),o.push({params:a,pathname:hu([i,h.pathname]),pathnameBase:dle(hu([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=hu([i,h.pathnameBase]))}return o}function lO(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,s]=ale(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:s.reduce((c,u,h)=>{let{paramName:f,isOptional:m}=u;if(f==="*"){let g=l[h]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const p=l[h];return m&&!p?c[f]=void 0:c[f]=(p||"").replace(/%2F/g,"/"),c},{}),pathname:i,pathnameBase:o,pattern:e}}function ale(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),tU(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,d)=>(s.push({paramName:l,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),s]}function ile(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return tU(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Y6(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&s!=="/"?null:e.slice(r)||"/"}function ole(e,t){t===void 0&&(t="/");let{pathname:r,search:s="",hash:a=""}=typeof e=="string"?sg(e):e;return{pathname:r?r.startsWith("/")?r:lle(r,t):t,search:ule(s),hash:hle(a)}}function lle(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function DN(e,t,r,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function cle(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Z6(e,t){let r=cle(e);return t?r.map((s,a)=>a===r.length-1?s.pathname:s.pathnameBase):r.map(s=>s.pathnameBase)}function Q6(e,t,r,s){s===void 0&&(s=!1);let a;typeof e=="string"?a=sg(e):(a=Px({},e),qs(!a.pathname||!a.pathname.includes("?"),DN("?","pathname","search",a)),qs(!a.pathname||!a.pathname.includes("#"),DN("#","pathname","hash",a)),qs(!a.search||!a.search.includes("#"),DN("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,l;if(o==null)l=r;else{let h=t.length-1;if(!s&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;a.pathname=f.join("/")}l=h>=0?t[h]:"/"}let d=ole(a,l),c=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(c||u)&&(d.pathname+="/"),d}const hu=e=>e.join("/").replace(/\/\/+/g,"/"),dle=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ule=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,hle=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function fle(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const sU=["post","put","patch","delete"];new Set(sU);const mle=["get",...sU];new Set(mle);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ox(){return Ox=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ox.apply(this,arguments)}const J6=P.createContext(null),ple=P.createContext(null),Du=P.createContext(null),m_=P.createContext(null),ud=P.createContext({outlet:null,matches:[],isDataRoute:!1}),aU=P.createContext(null);function gle(e,t){let{relative:r}=t===void 0?{}:t;ag()||qs(!1);let{basename:s,navigator:a}=P.useContext(Du),{hash:i,pathname:o,search:l}=oU(e,{relative:r}),d=o;return s!=="/"&&(d=o==="/"?s:hu([s,o])),a.createHref({pathname:d,search:l,hash:i})}function ag(){return P.useContext(m_)!=null}function wc(){return ag()||qs(!1),P.useContext(m_).location}function iU(e){P.useContext(Du).static||P.useLayoutEffect(e)}function pr(){let{isDataRoute:e}=P.useContext(ud);return e?Ale():xle()}function xle(){ag()||qs(!1);let e=P.useContext(J6),{basename:t,future:r,navigator:s}=P.useContext(Du),{matches:a}=P.useContext(ud),{pathname:i}=wc(),o=JSON.stringify(Z6(a,r.v7_relativeSplatPath)),l=P.useRef(!1);return iU(()=>{l.current=!0}),P.useCallback(function(c,u){if(u===void 0&&(u={}),!l.current)return;if(typeof c=="number"){s.go(c);return}let h=Q6(c,JSON.parse(o),i,u.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:hu([t,h.pathname])),(u.replace?s.replace:s.push)(h,u.state,u)},[t,s,o,i,e])}function ta(){let{matches:e}=P.useContext(ud),t=e[e.length-1];return t?t.params:{}}function oU(e,t){let{relative:r}=t===void 0?{}:t,{future:s}=P.useContext(Du),{matches:a}=P.useContext(ud),{pathname:i}=wc(),o=JSON.stringify(Z6(a,s.v7_relativeSplatPath));return P.useMemo(()=>Q6(e,JSON.parse(o),i,r==="path"),[e,o,i,r])}function vle(e,t){return yle(e,t)}function yle(e,t,r,s){ag()||qs(!1);let{navigator:a}=P.useContext(Du),{matches:i}=P.useContext(ud),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let d=o?o.pathnameBase:"/";o&&o.route;let c=wc(),u;if(t){var h;let x=typeof t=="string"?sg(t):t;d==="/"||(h=x.pathname)!=null&&h.startsWith(d)||qs(!1),u=x}else u=c;let f=u.pathname||"/",m=f;if(d!=="/"){let x=d.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(x.length).join("/")}let p=Goe(e,{pathname:m}),g=Nle(p&&p.map(x=>Object.assign({},x,{params:Object.assign({},l,x.params),pathname:hu([d,a.encodeLocation?a.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?d:hu([d,a.encodeLocation?a.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),i,r,s);return t&&g?P.createElement(m_.Provider,{value:{location:Ox({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:Xd.Pop}},g):g}function ble(){let e=kle(),t=fle(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},t),r?P.createElement("pre",{style:a},r):null,null)}const wle=P.createElement(ble,null);class _le extends P.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?P.createElement(ud.Provider,{value:this.props.routeContext},P.createElement(aU.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function jle(e){let{routeContext:t,match:r,children:s}=e,a=P.useContext(J6);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),P.createElement(ud.Provider,{value:t},s)}function Nle(e,t,r,s){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),s===void 0&&(s=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=s)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(a=r)==null?void 0:a.errors;if(l!=null){let u=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);u>=0||qs(!1),o=o.slice(0,Math.min(o.length,u+1))}let d=!1,c=-1;if(r&&s&&s.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:f,errors:m}=r,p=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||p){d=!0,c>=0?o=o.slice(0,c+1):o=[o[0]];break}}}return o.reduceRight((u,h,f)=>{let m,p=!1,g=null,x=null;r&&(m=l&&h.route.id?l[h.route.id]:void 0,g=h.route.errorElement||wle,d&&(c<0&&f===0?(p=!0,x=null):c===f&&(p=!0,x=h.route.hydrateFallbackElement||null)));let v=t.concat(o.slice(0,f+1)),y=()=>{let b;return m?b=g:p?b=x:h.route.Component?b=P.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=u,P.createElement(jle,{match:h,routeContext:{outlet:u,matches:v,isDataRoute:r!=null},children:b})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?P.createElement(_le,{location:r.location,revalidation:r.revalidation,component:g,error:m,children:y(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):y()},null)}var lU=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(lU||{}),tw=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(tw||{});function Sle(e){let t=P.useContext(J6);return t||qs(!1),t}function Cle(e){let t=P.useContext(ple);return t||qs(!1),t}function Ele(e){let t=P.useContext(ud);return t||qs(!1),t}function cU(e){let t=Ele(),r=t.matches[t.matches.length-1];return r.route.id||qs(!1),r.route.id}function kle(){var e;let t=P.useContext(aU),r=Cle(tw.UseRouteError),s=cU(tw.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[s]}function Ale(){let{router:e}=Sle(lU.UseNavigateStable),t=cU(tw.UseNavigateStable),r=P.useRef(!1);return iU(()=>{r.current=!0}),P.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Ox({fromRouteId:t},i)))},[e,t])}function Tle(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function cO(e){let{to:t,replace:r,state:s,relative:a}=e;ag()||qs(!1);let{future:i,static:o}=P.useContext(Du),{matches:l}=P.useContext(ud),{pathname:d}=wc(),c=pr(),u=Q6(t,Z6(l,i.v7_relativeSplatPath),d,a==="path"),h=JSON.stringify(u);return P.useEffect(()=>c(JSON.parse(h),{replace:r,state:s,relative:a}),[c,h,a,r,s]),null}function Ir(e){qs(!1)}function Ple(e){let{basename:t="/",children:r=null,location:s,navigationType:a=Xd.Pop,navigator:i,static:o=!1,future:l}=e;ag()&&qs(!1);let d=t.replace(/^\/*/,"/"),c=P.useMemo(()=>({basename:d,navigator:i,static:o,future:Ox({v7_relativeSplatPath:!1},l)}),[d,l,i,o]);typeof s=="string"&&(s=sg(s));let{pathname:u="/",search:h="",hash:f="",state:m=null,key:p="default"}=s,g=P.useMemo(()=>{let x=Y6(u,d);return x==null?null:{location:{pathname:x,search:h,hash:f,state:m,key:p},navigationType:a}},[d,u,h,f,m,p,a]);return g==null?null:P.createElement(Du.Provider,{value:c},P.createElement(m_.Provider,{children:r,value:g}))}function Ole(e){let{children:t,location:r}=e;return vle($S(t),r)}new Promise(()=>{});function $S(e,t){t===void 0&&(t=[]);let r=[];return P.Children.forEach(e,(s,a)=>{if(!P.isValidElement(s))return;let i=[...t,a];if(s.type===P.Fragment){r.push.apply(r,$S(s.props.children,i));return}s.type!==Ir&&qs(!1),!s.props.index||!s.props.children||qs(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=$S(s.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function FS(){return FS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},FS.apply(this,arguments)}function Rle(e,t){if(e==null)return{};var r={},s=Object.keys(e),a,i;for(i=0;i<s.length;i++)a=s[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Mle(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Ile(e,t){return e.button===0&&(!t||t==="_self")&&!Mle(e)}function zS(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let s=e[r];return t.concat(Array.isArray(s)?s.map(a=>[r,a]):[[r,s]])},[]))}function Dle(e,t){let r=zS(e);return t&&t.forEach((s,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}const Lle=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ble="6";try{window.__reactRouterVersion=Ble}catch{}const $le="startTransition",dO=IE[$le];function Fle(e){let{basename:t,children:r,future:s,window:a}=e,i=P.useRef();i.current==null&&(i.current=qoe({window:a,v5Compat:!0}));let o=i.current,[l,d]=P.useState({action:o.action,location:o.location}),{v7_startTransition:c}=s||{},u=P.useCallback(h=>{c&&dO?dO(()=>d(h)):d(h)},[d,c]);return P.useLayoutEffect(()=>o.listen(u),[o,u]),P.useEffect(()=>Tle(s),[s]),P.createElement(Ple,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:s})}const zle=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ule=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ft=P.forwardRef(function(t,r){let{onClick:s,relative:a,reloadDocument:i,replace:o,state:l,target:d,to:c,preventScrollReset:u,viewTransition:h}=t,f=Rle(t,Lle),{basename:m}=P.useContext(Du),p,g=!1;if(typeof c=="string"&&Ule.test(c)&&(p=c,zle))try{let b=new URL(window.location.href),j=c.startsWith("//")?new URL(b.protocol+c):new URL(c),T=Y6(j.pathname,m);j.origin===b.origin&&T!=null?c=T+j.search+j.hash:g=!0}catch{}let x=gle(c,{relative:a}),v=Vle(c,{replace:o,state:l,target:d,preventScrollReset:u,relative:a,viewTransition:h});function y(b){s&&s(b),b.defaultPrevented||v(b)}return P.createElement("a",FS({},f,{href:p||x,onClick:g||i?s:y,ref:r,target:d}))});var uO;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(uO||(uO={}));var hO;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(hO||(hO={}));function Vle(e,t){let{target:r,replace:s,state:a,preventScrollReset:i,relative:o,viewTransition:l}=t===void 0?{}:t,d=pr(),c=wc(),u=oU(e,{relative:o});return P.useCallback(h=>{if(Ile(h,r)){h.preventDefault();let f=s!==void 0?s:ew(c)===ew(u);d(e,{replace:f,state:a,preventScrollReset:i,relative:o,viewTransition:l})}},[c,d,u,s,a,r,e,i,o,l])}function hd(e){let t=P.useRef(zS(e)),r=P.useRef(!1),s=wc(),a=P.useMemo(()=>Dle(s.search,r.current?null:t.current),[s.search]),i=pr(),o=P.useCallback((l,d)=>{const c=zS(typeof l=="function"?l(a):l);r.current=!0,i("?"+c,d)},[i,a]);return[a,o]}var Kl=function(){return Kl=Object.assign||function(t){for(var r,s=1,a=arguments.length;s<a;s++){r=arguments[s];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Kl.apply(this,arguments)};function ig(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r}function qle(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function d(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(l,d)}c((s=s.apply(e,t||[])).next())})}function Wle(e,t,r){if(r||arguments.length===2)for(var s=0,a=t.length,i;s<a;s++)(i||!(s in t))&&(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}const Hle=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class ek extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class Gle extends ek{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class fO extends ek{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class mO extends ek{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var US;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(US||(US={}));class Kle{constructor(t,{headers:r={},customFetch:s,region:a=US.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Hle(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return qle(this,arguments,void 0,function*(r,s={}){var a;let i,o;try{const{headers:l,method:d,body:c,signal:u,timeout:h}=s;let f={},{region:m}=s;m||(m=this.region);const p=new URL(`${this.url}/${r}`);m&&m!=="any"&&(f["x-region"]=m,p.searchParams.set("forceFunctionRegion",m));let g;c&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",g=c):typeof c=="string"?(f["Content-Type"]="text/plain",g=c):typeof FormData<"u"&&c instanceof FormData?g=c:(f["Content-Type"]="application/json",g=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?g=JSON.stringify(c):g=c;let x=u;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),u?(x=o.signal,u.addEventListener("abort",()=>o.abort())):x=o.signal);const v=yield this.fetch(p.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),l),body:g,signal:x}).catch(T=>{throw new Gle(T)}),y=v.headers.get("x-relay-error");if(y&&y==="true")throw new fO(v);if(!v.ok)throw new mO(v);let b=((a=v.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),j;return b==="application/json"?j=yield v.json():b==="application/octet-stream"||b==="application/pdf"?j=yield v.blob():b==="text/event-stream"?j=v:b==="multipart/form-data"?j=yield v.formData():j=yield v.text(),{data:j,error:null,response:v}}catch(l){return{data:null,error:l,response:l instanceof mO||l instanceof fO?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var Xle=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},Yle=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let a=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,l=null,d=null,c=i.status,u=i.statusText;if(i.ok){var h,f;if(r.method!=="HEAD"){var m;const v=await i.text();v===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((m=r.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?l=v:l=JSON.parse(v))}const g=(h=r.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),x=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");g&&x&&x.length>1&&(d=parseInt(x[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(l)&&(l.length>1?(o={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,d=null,c=406,u="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var p;const g=await i.text();try{o=JSON.parse(g),Array.isArray(o)&&i.status===404&&(l=[],o=null,c=200,u="OK")}catch{i.status===404&&g===""?(c=204,u="No Content"):o={message:g}}if(o&&r.isMaybeSingle&&(!(o==null||(p=o.details)===null||p===void 0)&&p.includes("0 rows"))&&(o=null,c=200,u="OK"),o&&r.shouldThrowOnError)throw new Xle(o)}return{error:o,data:l,count:d,status:c,statusText:u}});return this.shouldThrowOnError||(a=a.catch(i=>{var o;let l="";const d=i==null?void 0:i.cause;if(d){var c,u,h,f;const p=(c=d==null?void 0:d.message)!==null&&c!==void 0?c:"",g=(u=d==null?void 0:d.code)!==null&&u!==void 0?u:"";l=`${(h=i==null?void 0:i.name)!==null&&h!==void 0?h:"FetchError"}: ${i==null?void 0:i.message}`,l+=`

Caused by: ${(f=d==null?void 0:d.name)!==null&&f!==void 0?f:"Error"}: ${p}`,g&&(l+=` (${g})`),d!=null&&d.stack&&(l+=`
${d.stack}`)}else{var m;l=(m=i==null?void 0:i.stack)!==null&&m!==void 0?m:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},Zle=class extends Yle{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:a=s}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const a=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:a=!1,format:i="text"}={}){var o;const l=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),d=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${d}"; options=${l};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const pO=new RegExp("[,()]");var em=class extends Zle{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&pO.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&pO.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},Qle=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:s}=t??{},a=r?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join(""),{url:l,headers:d}=this.cloneRequestState();return l.searchParams.set("select",o),s&&d.append("Prefer",`count=${s}`),new em({method:a,url:l,headers:d,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;const a="POST",{url:i,headers:o}=this.cloneRequestState();if(t&&o.append("Prefer",`count=${t}`),r||o.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((d,c)=>d.concat(Object.keys(c)),[]);if(l.length>0){const d=[...new Set(l)].map(c=>`"${c}"`);i.searchParams.set("columns",d.join(","))}}return new em({method:a,url:i,headers:o,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:a=!0}={}){var i;const o="POST",{url:l,headers:d}=this.cloneRequestState();if(d.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&l.searchParams.set("on_conflict",t),s&&d.append("Prefer",`count=${s}`),a||d.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);l.searchParams.set("columns",u.join(","))}}return new em({method:o,url:l,headers:d,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:t}={}){var r;const s="PATCH",{url:a,headers:i}=this.cloneRequestState();return t&&i.append("Prefer",`count=${t}`),new em({method:s,url:a,headers:i,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:s,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new em({method:r,url:s,headers:a,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},Jle=class dU{constructor(t,{headers:r={},schema:s,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=s,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Qle(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new dU(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:s=!1,get:a=!1,count:i}={}){var o;let l;const d=new URL(`${this.url}/rpc/${t}`);let c;const u=m=>m!==null&&typeof m=="object"&&(!Array.isArray(m)||m.some(u)),h=s&&Object.values(r).some(u);h?(l="POST",c=r):s||a?(l=s?"HEAD":"GET",Object.entries(r).filter(([m,p])=>p!==void 0).map(([m,p])=>[m,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([m,p])=>{d.searchParams.append(m,p)})):(l="POST",c=r);const f=new Headers(this.headers);return h?f.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&f.set("Prefer",`count=${i}`),new em({method:l,url:d,headers:f,schema:this.schemaName,body:c,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class ece{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const s=r.versions;if(s&&s.node){const a=s.node,i=parseInt(a.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const tce="2.91.0",rce=`realtime-js/${tce}`,nce="1.0.0",uU="2.0.0",gO=uU,VS=1e4,sce=1e3,ace=100;var Id;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Id||(Id={}));var aa;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(aa||(aa={}));var hl;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(hl||(hl={}));var qS;(function(e){e.websocket="websocket"})(qS||(qS={}));var ph;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ph||(ph={}));class ice{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,s;const a=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,s;const a=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},o=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,s){var a,i;const o=t.topic,l=(a=t.ref)!==null&&a!==void 0?a:"",d=(i=t.join_ref)!==null&&i!==void 0?i:"",c=t.payload.event,u=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},h=Object.keys(u).length===0?"":JSON.stringify(u);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+l.length+o.length+c.length+h.length,m=new ArrayBuffer(this.HEADER_LENGTH+f);let p=new DataView(m),g=0;p.setUint8(g++,this.KINDS.userBroadcastPush),p.setUint8(g++,d.length),p.setUint8(g++,l.length),p.setUint8(g++,o.length),p.setUint8(g++,c.length),p.setUint8(g++,h.length),p.setUint8(g++,r),Array.from(d,v=>p.setUint8(g++,v.charCodeAt(0))),Array.from(l,v=>p.setUint8(g++,v.charCodeAt(0))),Array.from(o,v=>p.setUint8(g++,v.charCodeAt(0))),Array.from(c,v=>p.setUint8(g++,v.charCodeAt(0))),Array.from(h,v=>p.setUint8(g++,v.charCodeAt(0)));var x=new Uint8Array(m.byteLength+s.byteLength);return x.set(new Uint8Array(m),0),x.set(new Uint8Array(s),m.byteLength),x.buffer}decode(t,r){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return r(s)}if(typeof t=="string"){const s=JSON.parse(t),[a,i,o,l,d]=s;return r({join_ref:a,ref:i,topic:o,event:l,payload:d})}return r({})}_binaryDecode(t){const r=new DataView(t),s=r.getUint8(0),a=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,s){const a=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),l=r.getUint8(4);let d=this.HEADER_LENGTH+4;const c=s.decode(t.slice(d,d+a));d=d+a;const u=s.decode(t.slice(d,d+i));d=d+i;const h=s.decode(t.slice(d,d+o));d=d+o;const f=t.slice(d,t.byteLength),m=l===this.JSON_ENCODING?JSON.parse(s.decode(f)):f,p={type:this.BROADCAST_EVENT,event:u,payload:m};return o>0&&(p.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([s])=>r.includes(s)))}}class hU{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Zn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Zn||(Zn={}));const xO=(e,t,r={})=>{var s;const a=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((i,o)=>(i[o]=oce(o,e,t,a),i),{}):{}},oce=(e,t,r,s)=>{const a=t.find(l=>l.name===e),i=a==null?void 0:a.type,o=r[e];return i&&!s.includes(i)?fU(i,o):WS(o)},fU=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return uce(t,r)}switch(e){case Zn.bool:return lce(t);case Zn.float4:case Zn.float8:case Zn.int2:case Zn.int4:case Zn.int8:case Zn.numeric:case Zn.oid:return cce(t);case Zn.json:case Zn.jsonb:return dce(t);case Zn.timestamp:return hce(t);case Zn.abstime:case Zn.date:case Zn.daterange:case Zn.int4range:case Zn.int8range:case Zn.money:case Zn.reltime:case Zn.text:case Zn.time:case Zn.timestamptz:case Zn.timetz:case Zn.tsrange:case Zn.tstzrange:return WS(t);default:return WS(t)}},WS=e=>e,lce=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},cce=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},dce=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},uce=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>fU(t,l))}return e},hce=e=>typeof e=="string"?e.replace(" ","T"):e,mU=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class LN{constructor(t,r,s={},a=VS){this.channel=t,this.event=r,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var vO;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(vO||(vO={}));class H0{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=H0.syncState(this.state,a,i,o),this.pendingDiffs.forEach(d=>{this.state=H0.syncDiff(this.state,d,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=H0.syncDiff(this.state,a,i,o),l())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,a){const i=this.cloneDeep(t),o=this.transformState(r),l={},d={};return this.map(i,(c,u)=>{o[c]||(d[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const f=u.map(x=>x.presence_ref),m=h.map(x=>x.presence_ref),p=u.filter(x=>m.indexOf(x.presence_ref)<0),g=h.filter(x=>f.indexOf(x.presence_ref)<0);p.length>0&&(l[c]=p),g.length>0&&(d[c]=g)}else l[c]=u}),this.syncDiff(i,{joins:l,leaves:d},s,a)}static syncDiff(t,r,s,a){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(i,(l,d)=>{var c;const u=(c=t[l])!==null&&c!==void 0?c:[];if(t[l]=this.cloneDeep(d),u.length>0){const h=t[l].map(m=>m.presence_ref),f=u.filter(m=>h.indexOf(m.presence_ref)<0);t[l].unshift(...f)}s(l,u,d)}),this.map(o,(l,d)=>{let c=t[l];if(!c)return;const u=d.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),t[l]=c,a(l,c,d),c.length===0&&delete t[l]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const a=t[s];return"metas"in a?r[s]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var yO;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(yO||(yO={}));var G0;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(G0||(G0={}));var Dc;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Dc||(Dc={}));class vm{constructor(t,r={config:{}},s){var a,i;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=aa.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new LN(this,hl.join,this.params,this.timeout),this.rejoinTimer=new hU(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=aa.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=aa.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=aa.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=aa.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=aa.errored,this.rejoinTimer.scheduleTimeout())}),this._on(hl.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new H0(this),this.broadcastEndpointURL=mU(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==aa.closed){const{config:{broadcast:o,presence:l,private:d}}=this.params,c=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(m=>m.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[G0.PRESENCE]&&this.bindings[G0.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:c,private:d};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(Dc.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(Dc.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),m===void 0){t==null||t(Dc.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,x=(p=g==null?void 0:g.length)!==null&&p!==void 0?p:0,v=[];for(let y=0;y<x;y++){const b=g[y],{filter:{event:j,schema:T,table:O,filter:R}}=b,D=m&&m[y];if(D&&D.event===j&&vm.isFilterValueEqual(D.schema,T)&&vm.isFilterValueEqual(D.table,O)&&vm.isFilterValueEqual(D.filter,R))v.push(Object.assign(Object.assign({},b),{id:D.id}));else{this.unsubscribe(),this.state=aa.errored,t==null||t(Dc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(Dc.SUBSCRIBED);return}}).receive("error",m=>{this.state=aa.errored,t==null||t(Dc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Dc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===aa.joined&&t===G0.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,s)}async httpSend(t,r,s={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);if(l.status===202)return{success:!0};let d=l.statusText;try{const c=await l.json();d=c.error||c.message||d}catch{}return Promise.reject(new Error(d))}async send(t,r={}){var s,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=t,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,d;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=aa.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(hl.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new LN(this,hl.leave,{},t),s.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=aa.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const a=new AbortController,i=setTimeout(()=>a.abort(),s),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),o}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new LN(this,t,r,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>ace){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var a,i;const o=t.toLocaleLowerCase(),{close:l,error:d,leave:c,join:u}=hl;if(s&&[l,d,c,u].indexOf(o)>=0&&s!==this._joinRef())return;let f=this._onMessage(o,r,s);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(m=>{var p,g,x;return((p=m.filter)===null||p===void 0?void 0:p.event)==="*"||((x=(g=m.filter)===null||g===void 0?void 0:g.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===o}).map(m=>m.callback(f,s)):(i=this.bindings[o])===null||i===void 0||i.filter(m=>{var p,g,x,v,y,b,j,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const O=m.id,R=(p=m.filter)===null||p===void 0?void 0:p.event;return O&&((g=r.ids)===null||g===void 0?void 0:g.includes(O))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))&&(!(!((v=m.filter)===null||v===void 0)&&v.table)||m.filter.table===((y=r.data)===null||y===void 0?void 0:y.table))}else{const O=(j=(b=m==null?void 0:m.filter)===null||b===void 0?void 0:b.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return O==="*"||O===((T=r==null?void 0:r.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:g,table:x,commit_timestamp:v,type:y,errors:b}=p;f=Object.assign(Object.assign({},{schema:g,table:x,commit_timestamp:v,eventType:y,new:{},old:{},errors:b}),this._getPayloadRecords(p))}m.callback(f,s)})}_isClosed(){return this.state===aa.closed}_isJoined(){return this.state===aa.joined}_isJoining(){return this.state===aa.joining}_isLeaving(){return this.state===aa.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:s};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&vm.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(hl.close,{},t)}_onError(t){this._on(hl.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=aa.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=xO(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=xO(t.columns,t.old_record)),r}}const BN=()=>{},oy={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},fce=[1e3,2e3,5e3,1e4],mce=1e4,pce=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class gce{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=VS,this.transport=null,this.heartbeatIntervalMs=oy.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=BN,this.ref=0,this.reconnectTimer=null,this.vsn=gO,this.logger=BN,this.conn=null,this.sendBuffer=[],this.serializer=new ice,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${qS.websocket}`,this.httpEndpoint=mU(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ece.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Id.connecting:return ph.Connecting;case Id.open:return ph.Open;case Id.closing:return ph.Closing;default:return ph.Closed}}isConnected(){return this.connectionState()===ph.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===s);if(a)return a;{const i=new vm(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:s,payload:a,ref:i}=t,o=()=>{this.encode(t,l=>{var d;(d=this.conn)===null||d===void 0||d.send(l)})};this.log("push",`${r} ${s} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(sce,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},oy.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(u){this.log("error","error in heartbeat callback",u)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:a,payload:i,ref:o}=r,l=o?`(${o})`:"",d=i.status||"";this.log("receive",`${d} ${s} ${a} ${l}`.trim(),i),this.channels.filter(c=>c._isMember(s)).forEach(c=>c._trigger(a,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Id.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Id.open||this.conn.readyState===Id.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(hl.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${s}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([pce],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,s=!1;if(t)r=t,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const i={access_token:r,version:rce};r&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(hl.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new hU(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},oy.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,a,i,o,l,d,c,u,h,f,m;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:VS,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:oy.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:BN,this.vsn=(d=t==null?void 0:t.vsn)!==null&&d!==void 0?d:gO,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:p=>fce[p-1]||mce,this.vsn){case nce:this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(p,g)=>g(JSON.stringify(p)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:(p,g)=>g(JSON.parse(p));break;case uU:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var Rx=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function xce(e,t,r){const s=new URL(t,e);if(r)for(const[a,i]of Object.entries(r))i!==void 0&&s.searchParams.set(a,i);return s.toString()}async function vce(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function yce(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:a,body:i,headers:o}){const l=xce(e.baseUrl,s,a),d=await vce(e.auth),c=await t(l,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...d,...o},body:i?JSON.stringify(i):void 0}),u=await c.text(),h=(c.headers.get("content-type")||"").includes("application/json"),f=h&&u?JSON.parse(u):u;if(!c.ok){const m=h?f:void 0,p=m==null?void 0:m.error;throw new Rx((p==null?void 0:p.message)??`Request failed with status ${c.status}`,{status:c.status,icebergType:p==null?void 0:p.type,icebergCode:p==null?void 0:p.code,details:m})}return{status:c.status,headers:c.headers,data:f}}}}function ly(e){return e.join("")}var bce=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:ly(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${ly(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${ly(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${ly(e.namespace)}`}),!0}catch(t){if(t instanceof Rx&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Rx&&r.status===409)return;throw r}}};function If(e){return e.join("")}var wce=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${If(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${If(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${If(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${If(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${If(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${If(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Rx&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Rx&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},_ce=class{constructor(e){var s;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=yce({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(s=e.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new bce(this.client,t),this.tableOps=new wce(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},p_=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function vs(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var jce=class extends p_{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},HS=class extends p_{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const tk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Nce=()=>Response,GS=e=>{if(Array.isArray(e))return e.map(r=>GS(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,s])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=GS(s)}),t},Sce=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Cce=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Mx(e){"@babel/helpers - typeof";return Mx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mx(e)}function Ece(e,t){if(Mx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Mx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kce(e){var t=Ece(e,"string");return Mx(t)=="symbol"?t:t+""}function Ace(e,t,r){return(t=kce(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Pr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bO(Object(r),!0).forEach(function(s){Ace(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bO(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const $N=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},Tce=async(e,t,r)=>{e instanceof await Nce()&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const a=e.status||500,i=(s==null?void 0:s.statusCode)||a+"";t(new jce($N(s),a,i))}).catch(s=>{t(new HS($N(s),s))}):t(new HS($N(e),e))},Pce=(e,t,r,s)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!s?a:(Sce(s)?(a.headers=Pr({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,t!=null&&t.duplex&&(a.duplex=t.duplex),Pr(Pr({},a),r))};async function Jv(e,t,r,s,a,i){return new Promise((o,l)=>{e(r,Pce(t,s,a,i)).then(d=>{if(!d.ok)throw d;return s!=null&&s.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>Tce(d,l,s))})}async function Ix(e,t,r,s){return Jv(e,"GET",t,r,s)}async function ll(e,t,r,s,a){return Jv(e,"POST",t,s,a,r)}async function KS(e,t,r,s,a){return Jv(e,"PUT",t,s,a,r)}async function Oce(e,t,r,s){return Jv(e,"HEAD",t,Pr(Pr({},r),{},{noResolveJson:!0}),s)}async function rk(e,t,r,s,a){return Jv(e,"DELETE",t,s,a,r)}var Rce=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(vs(t))return{data:null,error:t};throw t}}};let pU;pU=Symbol.toStringTag;var Mce=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[pU]="BlobDownloadBuilder",this.promise=null}asStream(){return new Rce(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(vs(t))return{data:null,error:t};throw t}}};const Ice={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},wO={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Dce=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=tk(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,s){var a=this;try{let i;const o=Pr(Pr({},wO),s);let l=Pr(Pr({},a.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",a.encodeMetadata(d)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),d&&!i.has("metadata")&&i.append("metadata",a.encodeMetadata(d))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,d&&(l["x-metadata"]=a.toBase64(a.encodeMetadata(d))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(l=Pr(Pr({},l),s.headers));const c=a._removeEmptyFolders(t),u=a._getFinalPath(c),h=await(e=="PUT"?KS:ll)(a.fetch,`${a.url}/object/${u}`,i,Pr({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(vs(i))return{data:null,error:i};throw i}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,s){var a=this;const i=a._removeEmptyFolders(e),o=a._getFinalPath(i),l=new URL(a.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let d;const c=Pr({upsert:wO.upsert},s),u=Pr(Pr({},a.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",c.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",c.cacheControl)):(d=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType),{data:{path:i,fullPath:(await KS(a.fetch,l.toString(),d,{headers:u})).Key},error:null}}catch(d){if(a.shouldThrowOnError)throw d;if(vs(d))return{data:null,error:d};throw d}}async createSignedUploadUrl(e,t){var r=this;try{let s=r._getFinalPath(e);const a=Pr({},r.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const i=await ll(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:a}),o=new URL(r.url+i.url),l=o.searchParams.get("token");if(!l)throw new p_("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(vs(s))return{data:null,error:s};throw s}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var s=this;try{return{data:await ll(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers}),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(vs(a))return{data:null,error:a};throw a}}async copy(e,t,r){var s=this;try{return{data:{path:(await ll(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers})).Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(vs(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,r){var s=this;try{let a=s._getFinalPath(e),i=await ll(s.fetch,`${s.url}/object/sign/${a}`,Pr({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:s.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(vs(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,r){var s=this;try{const a=await ll(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:t,paths:e},{headers:s.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(o=>Pr(Pr({},o),{},{signedUrl:o.signedURL?encodeURI(`${s.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(vs(a))return{data:null,error:a};throw a}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=s?`?${s}`:"",i=this._getFinalPath(e),o=()=>Ix(this.fetch,`${this.url}/${r}/${i}${a}`,{headers:this.headers,noResolveJson:!0});return new Mce(o,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:GS(await Ix(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(vs(s))return{data:null,error:s};throw s}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await Oce(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(vs(s)&&s instanceof HS){const a=s.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:s}}throw s}}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&s.push(a);const i=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});o!==""&&s.push(o);let l=s.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${l}`)}}}async remove(e){var t=this;try{return{data:await rk(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(vs(r))return{data:null,error:r};throw r}}async list(e,t,r){var s=this;try{const a=Pr(Pr(Pr({},Ice),t),{},{prefix:e||""});return{data:await ll(s.fetch,`${s.url}/object/list/${s.bucketId}`,a,{headers:s.headers},r),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(vs(a))return{data:null,error:a};throw a}}async listV2(e,t){var r=this;try{const s=Pr({},e);return{data:await ll(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},t),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(vs(s))return{data:null,error:s};throw s}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const gU="2.91.0",xU={"X-Client-Info":`storage-js/${gU}`};var Lce=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const a=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Pr(Pr({},xU),t),this.fetch=tk(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await Ix(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(vs(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Ix(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(vs(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await ll(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(vs(s))return{data:null,error:s};throw s}}async updateBucket(e,t){var r=this;try{return{data:await KS(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(vs(s))return{data:null,error:s};throw s}}async emptyBucket(e){var t=this;try{return{data:await ll(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(vs(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await rk(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(vs(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Bce=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Pr(Pr({},xU),t),this.fetch=tk(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await ll(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(vs(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const s=r.toString(),a=s?`${t.url}/bucket?${s}`:`${t.url}/bucket`;return{data:await Ix(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(vs(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await rk(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(vs(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!Cce(e))throw new p_("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new _ce({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(a,i){const o=a[i];return typeof o!="function"?o:async(...l)=>{try{return{data:await o.apply(a,l),error:null}}catch(d){if(s)throw d;return{data:null,error:d}}}}})}};const nk={"X-Client-Info":`storage-js/${gU}`,"Content-Type":"application/json"};var vU=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function ao(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var FN=class extends vU{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},$ce=class extends vU{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const sk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Fce=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},_O=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),zce=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const s=e.status||500,a=e;if(typeof a.json=="function")a.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";t(new FN(_O(i),s,o))}).catch(()=>{const i=s+"";t(new FN(a.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";t(new FN(a.statusText||`HTTP ${s} error`,s,i))}}else t(new $ce(_O(e),e))},Uce=(e,t,r,s)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return s?(Fce(s)?(a.headers=Pr({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,Pr(Pr({},a),r)):a};async function Vce(e,t,r,s,a,i){return new Promise((o,l)=>{e(r,Uce(t,s,a,i)).then(d=>{if(!d.ok)throw d;if(s!=null&&s.noResolveJson)return d;const c=d.headers.get("content-type");return!c||!c.includes("application/json")?{}:d.json()}).then(d=>o(d)).catch(d=>zce(d,l,s))})}async function io(e,t,r,s,a){return Vce(e,"POST",t,s,a,r)}var qce=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Pr(Pr({},nk),t),this.fetch=sk(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await io(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ao(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await io(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ao(s))return{data:null,error:s};throw s}}async listIndexes(e){var t=this;try{return{data:await io(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ao(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await io(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ao(s))return{data:null,error:s};throw s}}},Wce=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Pr(Pr({},nk),t),this.fetch=sk(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await io(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ao(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await io(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ao(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await io(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ao(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await io(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ao(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await io(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ao(r))return{data:null,error:r};throw r}}},Hce=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Pr(Pr({},nk),t),this.fetch=sk(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await io(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ao(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await io(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ao(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await io(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ao(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await io(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ao(r))return{data:null,error:r};throw r}}},Gce=class extends Hce{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Kce(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},Kce=class extends qce{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Pr(Pr({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Pr(Pr({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new Xce(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},Xce=class extends Wce{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Pr(Pr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Pr(Pr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Pr(Pr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Pr(Pr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Pr(Pr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},Yce=class extends Lce{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new Dce(this.url,this.headers,e,this.fetch)}get vectors(){return new Gce(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Bce(this.url+"/iceberg",this.headers,this.fetch)}};const yU="2.91.0",tm=30*1e3,XS=3,zN=XS*tm,Zce="http://localhost:9999",Qce="supabase.auth.token",Jce={"X-Client-Info":`gotrue-js/${yU}`},YS="X-Supabase-Api-Version",bU={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ede=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,tde=10*60*1e3;class Dx extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function yr(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class rde extends Dx{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function nde(e){return yr(e)&&e.name==="AuthApiError"}class gh extends Dx{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class fd extends Dx{constructor(t,r,s,a){super(t,s,a),this.name=r,this.status=s}}class Qi extends fd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function sde(e){return yr(e)&&e.name==="AuthSessionMissingError"}class Df extends fd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class cy extends fd{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class dy extends fd{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function ade(e){return yr(e)&&e.name==="AuthImplicitGrantRedirectError"}class jO extends fd{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ide extends fd{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class ZS extends fd{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function UN(e){return yr(e)&&e.name==="AuthRetryableFetchError"}class NO extends fd{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class QS extends fd{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const rw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),SO=` 	
\r=`.split(""),ode=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<SO.length;t+=1)e[SO[t].charCodeAt(0)]=-2;for(let t=0;t<rw.length;t+=1)e[rw[t].charCodeAt(0)]=t;return e})();function CO(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(rw[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(rw[s]),t.queuedBits-=6}}function wU(e,t,r){const s=ode[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function EO(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{dde(o,s,r)};for(let o=0;o<e.length;o+=1)wU(e.charCodeAt(o),a,i);return t.join("")}function lde(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function cde(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}lde(s,t)}}function dde(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Dm(e){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)wU(e.charCodeAt(a),r,s);return new Uint8Array(t)}function ude(e){const t=[];return cde(e,r=>t.push(r)),new Uint8Array(t)}function bh(e){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};return e.forEach(a=>CO(a,r,s)),CO(null,r,s),t.join("")}function hde(e){return Math.round(Date.now()/1e3)+e}function fde(){return Symbol("auth-callback")}const Ia=()=>typeof window<"u"&&typeof document<"u",Zu={tested:!1,writable:!1},_U=()=>{if(!Ia())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Zu.tested)return Zu.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Zu.tested=!0,Zu.writable=!0}catch{Zu.tested=!0,Zu.writable=!1}return Zu.writable};function mde(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((s,a)=>{t[a]=s}),t}const jU=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),pde=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",rm=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Qu=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ma=async(e,t)=>{await e.removeItem(t)};class g_{constructor(){this.promise=new g_.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}g_.promiseConstructor=Promise;function VN(e){const t=e.split(".");if(t.length!==3)throw new QS("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!ede.test(t[s]))throw new QS("JWT not in base64url format");return{header:JSON.parse(EO(t[0])),payload:JSON.parse(EO(t[1])),signature:Dm(t[2]),raw:{header:t[0],payload:t[1]}}}async function gde(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function xde(e,t){return new Promise((s,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){s(o);return}}catch(o){if(!t(i,o)){a(o);return}}})()})}function vde(e){return("0"+e.toString(16)).substr(-2)}function yde(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(t),Array.from(t,vde).join("")}async function bde(e){const r=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(s);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function wde(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await bde(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Lf(e,t,r=!1){const s=yde();let a=s;r&&(a+="/PASSWORD_RECOVERY"),await rm(e,`${t}-code-verifier`,a);const i=await wde(s);return[i,s===i?"plain":"s256"]}const _de=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function jde(e){const t=e.headers.get(YS);if(!t||!t.match(_de))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Nde(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Sde(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Cde=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Bf(e){if(!Cde.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function qN(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ede(e,t){return new Proxy(e,{get:(r,s,a)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,a)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,s,a)}})}function kO(e){return JSON.parse(JSON.stringify(e))}const ch=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),kde=[502,503,504];async function AO(e){var t;if(!pde(e))throw new ZS(ch(e),0);if(kde.includes(e.status))throw new ZS(ch(e),e.status);let r;try{r=await e.json()}catch(i){throw new gh(ch(i),i)}let s;const a=jde(e);if(a&&a.getTime()>=bU["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new NO(ch(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new Qi}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new NO(ch(r),e.status,r.weak_password.reasons);throw new rde(ch(r),e.status||500,s)}const Ade=(e,t,r,s)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),r))};async function Tr(e,t,r,s){var a;const i=Object.assign({},s==null?void 0:s.headers);i[YS]||(i[YS]=bU["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(a=s==null?void 0:s.query)!==null&&a!==void 0?a:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await Tde(e,t,r+l,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(d):{data:Object.assign({},d),error:null}}async function Tde(e,t,r,s,a,i){const o=Ade(t,s,a,i);let l;try{l=await e(r,Object.assign({},o))}catch(d){throw console.error(d),new ZS(ch(d),0)}if(l.ok||await AO(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(d){await AO(d)}}function nl(e){var t;let r=null;Rde(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=hde(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:s},error:null}}function TO(e){const t=nl(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Fd(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Pde(e){return{data:e,error:null}}function Ode(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:i}=e,o=ig(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:i},d=Object.assign({},o);return{data:{properties:l,user:d},error:null}}function PO(e){return e}function Rde(e){return e.access_token&&e.refresh_token&&e.expires_in}const WN=["global","local","others"];class Mde{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=jU(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=WN[0]){if(WN.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${WN.join(", ")}`);try{return await Tr(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(yr(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await Tr(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Fd})}catch(s){if(yr(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=ig(t,["options"]),a=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(a.new_email=s==null?void 0:s.newEmail,delete a.newEmail),await Tr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Ode,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(yr(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Tr(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Fd})}catch(r){if(yr(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,a,i,o,l,d;try{const c={nextPage:null,lastPage:0,total:0},u=await Tr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:PO});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(d=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&d!==void 0?d:[];return m.length>0&&(m.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(p.split(";")[1].split("=")[1]);c[`${x}Page`]=g}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(yr(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Bf(t);try{return await Tr(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Fd})}catch(r){if(yr(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Bf(t);try{return await Tr(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Fd})}catch(s){if(yr(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){Bf(t);try{return await Tr(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Fd})}catch(s){if(yr(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){Bf(t.userId);try{const{data:r,error:s}=await Tr(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:s}}catch(r){if(yr(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Bf(t.userId),Bf(t.id);try{return{data:await Tr(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(yr(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,a,i,o,l,d;try{const c={nextPage:null,lastPage:0,total:0},u=await Tr(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:PO});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(d=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&d!==void 0?d:[];return m.length>0&&(m.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(p.split(";")[1].split("=")[1]);c[`${x}Page`]=g}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(yr(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Tr(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(yr(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Tr(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(yr(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Tr(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(yr(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await Tr(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(yr(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Tr(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(yr(r))return{data:null,error:r};throw r}}}function OO(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const $f={debug:!!(globalThis&&_U()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class NU extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Ide extends NU{}async function Dde(e,t,r){$f.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),$f.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){$f.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{$f.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw $f.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Ide(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if($f.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Lde(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function SU(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Bde(e){return parseInt(e,16)}function $de(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function Fde(e){var t;const{chainId:r,domain:s,expirationTime:a,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:d,resources:c,scheme:u,uri:h,version:f}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=SU(e.address),p=u?`${u}://${s}`:s,g=e.statement?`${e.statement}
`:"",x=`${p} wants you to sign in with your Ethereum account:
${m}

${g}`;let v=`URI: ${h}
Version: ${f}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(a&&(v+=`
Expiration Time: ${a.toISOString()}`),l&&(v+=`
Not Before: ${l.toISOString()}`),d&&(v+=`
Request ID: ${d}`),c){let y=`
Resources:`;for(const b of c){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);y+=`
- ${b}`}v+=y}return`${x}
${v}`}class Gs extends Error{constructor({message:t,code:r,cause:s,name:a}){var i;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=a??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class nw extends Gs{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function zde({error:e,options:t}){var r,s,a;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Gs({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Gs({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Gs({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Gs({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Gs({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Gs({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Gs({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Gs({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(CU(o)){if(i.rp.id!==o)return new Gs({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Gs({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Gs({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Gs({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Gs({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Ude({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Gs({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Gs({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(CU(s)){if(r.rpId!==s)return new Gs({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Gs({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Gs({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Gs({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class Vde{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const qde=new Vde;function Wde(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,a=ig(e,["challenge","user","excludeCredentials"]),i=Dm(t).buffer,o=Object.assign(Object.assign({},r),{id:Dm(r.id).buffer}),l=Object.assign(Object.assign({},a),{challenge:i,user:o});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let d=0;d<s.length;d++){const c=s[d];l.excludeCredentials[d]=Object.assign(Object.assign({},c),{id:Dm(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return l}function Hde(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=ig(e,["challenge","allowCredentials"]),a=Dm(t).buffer,i=Object.assign(Object.assign({},s),{challenge:a});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const l=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:Dm(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function Gde(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:bh(new Uint8Array(e.response.attestationObject)),clientDataJSON:bh(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Kde(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,s=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:bh(new Uint8Array(a.authenticatorData)),clientDataJSON:bh(new Uint8Array(a.clientDataJSON)),signature:bh(new Uint8Array(a.signature)),userHandle:a.userHandle?bh(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function CU(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function RO(){var e,t;return!!(Ia()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function Xde(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new nw("Browser returned unexpected credential type",t)}:{data:null,error:new nw("Empty credential response",t)}}catch(t){return{data:null,error:zde({error:t,options:e})}}}async function Yde(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new nw("Browser returned unexpected credential type",t)}:{data:null,error:new nw("Empty credential response",t)}}catch(t){return{data:null,error:Ude({error:t,options:e})}}}const Zde={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},Qde={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function sw(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),s={};for(const a of e)if(a)for(const i in a){const o=a[i];if(o!==void 0)if(Array.isArray(o))s[i]=o;else if(r(o))s[i]=o;else if(t(o)){const l=s[i];t(l)?s[i]=sw(l,o):s[i]=sw(o)}else s[i]=o}return s}function Jde(e,t){return sw(Zde,e,t||{})}function eue(e,t){return sw(Qde,e,t||{})}class tue{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:a},i){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const d=a??qde.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:c}=o.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${s}`),c.displayName||(c.displayName=c.name)}switch(o.webauthn.type){case"create":{const c=Jde(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:u,error:h}=await Xde({publicKey:c,signal:d});return u?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const c=eue(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:u,error:h}=await Yde(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:c,signal:d}));return u?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(o){return yr(o)?{data:null,error:o}:{data:null,error:new gh("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new Dx("rpId is required for WebAuthn authentication")};try{if(!RO())return{data:null,error:new gh("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:a},{request:i});if(!o)return{data:null,error:l};const{webauthn:d}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:d.type,rpId:r,rpOrigins:s,credential_response:d.credential_response}})}catch(o){return yr(o)?{data:null,error:o}:{data:null,error:new gh("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new Dx("rpId is required for WebAuthn registration")};try{if(!RO())return{data:null,error:new gh("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===t&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:l};const{data:d,error:c}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:a},{create:i});return d?this._verify({factorId:o.id,challengeId:d.challengeId,webauthn:{rpId:r,rpOrigins:s,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:c}}catch(o){return yr(o)?{data:null,error:o}:{data:null,error:new gh("Unexpected error in register",o)}}}}Lde();const rue={url:Zce,storageKey:Qce,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Jce,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function MO(e,t,r){return await r()}const Ff={};class Lx{get jwks(){var t,r;return(r=(t=Ff[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Ff[this.storageKey]=Object.assign(Object.assign({},Ff[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Ff[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Ff[this.storageKey]=Object.assign(Object.assign({},Ff[this.storageKey]),{cachedAt:t})}constructor(t){var r,s,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},rue),t);if(this.storageKey=i.storageKey,this.instanceID=(r=Lx.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Lx.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Ia()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Mde({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=jU(i.fetch),this.lock=i.lock||MO,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&Ia()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=Dde:this.lock=MO,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new tue(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:_U()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=OO(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=OO(this.memoryStorage)),Ia()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${yU}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},s="none";if(Ia()&&(r=mde(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),Ia()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),ade(i)){const d=(t=i.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:o,redirectType:l}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return yr(r)?this._returnResult({error:r}):this._returnResult({error:new gh("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,a;try{const i=await Tr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:nl}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const d=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:c,session:d},error:null})}catch(i){if(yr(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,s,a;try{let i;if("email"in t){const{email:u,password:h,options:f}=t;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await Lf(this.storage,this.storageKey)),i=await Tr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:m,code_challenge_method:p},xform:nl})}else if("phone"in t){const{phone:u,password:h,options:f}=t;i=await Tr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(a=f==null?void 0:f.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:nl})}else throw new cy("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return await Ma(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const d=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:c,session:d},error:null})}catch(i){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),yr(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:l}=t;r=await Tr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:TO})}else if("phone"in t){const{phone:i,password:o,options:l}=t;r=await Tr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:TO})}else throw new cy("You must provide either an email or phone number and a password");const{data:s,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!s||!s.session||!s.user){const i=new Df;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(r){if(yr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,s,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,a,i,o,l,d,c,u,h,f;let m,p;if("message"in t)m=t.message,p=t.signature;else{const{chain:g,wallet:x,statement:v,options:y}=t;let b;if(Ia())if(typeof x=="object")b=x;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")b=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=x}const j=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),T=await b.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!T||T.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const O=SU(T[0]);let R=(s=y==null?void 0:y.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!R){const B=await b.request({method:"eth_chainId"});R=Bde(B)}const D={domain:j.host,address:O,statement:v,uri:j.href,version:"1",chainId:R,nonce:(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(o=(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(d=y==null?void 0:y.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=y==null?void 0:y.signInWithEthereum)===null||u===void 0?void 0:u.resources};m=Fde(D),p=await b.request({method:"personal_sign",params:[$de(m),O]})}try{const{data:g,error:x}=await Tr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:p},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:nl});if(x)throw x;if(!g||!g.session||!g.user){const v=new Df;return this._returnResult({data:{user:null,session:null},error:v})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:x})}catch(g){if(yr(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(t){var r,s,a,i,o,l,d,c,u,h,f,m;let p,g;if("message"in t)p=t.message,g=t.signature;else{const{chain:x,wallet:v,statement:y,options:b}=t;let j;if(Ia())if(typeof v=="object")j=v;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))j=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=v}const T=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const O=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),y?{statement:y}:null));let R;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")R=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)R=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)p=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),g=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${T.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(a=(s=b==null?void 0:b.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(u=b==null?void 0:b.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const O=await j.signMessage(new TextEncoder().encode(p),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=O}}try{const{data:x,error:v}=await Tr(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:bh(g)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:nl});if(v)throw v;if(!x||!x.session||!x.user){const y=new Df;return this._returnResult({data:{user:null,session:null},error:y})}return x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),this._returnResult({data:Object.assign({},x),error:v})}catch(x){if(yr(x))return this._returnResult({data:{user:null,session:null},error:x});throw x}}async _exchangeCodeForSession(t){const r=await Qu(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new ide;const{data:i,error:o}=await Tr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:nl});if(await Ma(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new Df;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),setTimeout(async()=>{await this._notifyAllSubscribers("SIGNED_IN",i.session)},0)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),yr(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:s,token:a,access_token:i,nonce:o}=t,l=await Tr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:nl}),{data:d,error:c}=l;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!d||!d.session||!d.user){const u=new Df;return this._returnResult({data:{user:null,session:null},error:u})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:c})}catch(r){if(yr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,s,a,i,o;try{if("email"in t){const{email:l,options:d}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Lf(this.storage,this.storageKey));const{error:h}=await Tr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},create_user:(s=d==null?void 0:d.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:d==null?void 0:d.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:l,options:d}=t,{data:c,error:u}=await Tr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(o=d==null?void 0:d.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u})}throw new cy("You must provide either an email or phone number.")}catch(l){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),yr(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var r,s;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await Tr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:nl});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,c=o.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:c,session:d},error:null})}catch(a){if(yr(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,s,a,i,o;try{let l=null,d=null;this.flowType==="pkce"&&([l,d]=await Lf(this.storage,this.storageKey));const c=await Tr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:d}),headers:this.headers,xform:Pde});return!((i=c.data)===null||i===void 0)&&i.url&&Ia()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(l){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),yr(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new Qi;const{error:a}=await Tr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(yr(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:a,options:i}=t,{error:o}=await Tr(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:s,type:a,options:i}=t,{data:o,error:l}=await Tr(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new cy("You must provide either an email or phone number and a type")}catch(r){if(yr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Qu(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<zN:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const o=await Qu(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=qN()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=Ede(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Tr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Fd}):await this._useSession(async r=>{var s,a,i;const{data:o,error:l}=r;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Qi}:await Tr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Fd})})}catch(r){if(yr(r))return sde(r)&&(await this._removeSession(),await Ma(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:a,error:i}=s;if(i)throw i;if(!a.session)throw new Qi;const o=a.session;let l=null,d=null;this.flowType==="pkce"&&t.email!=null&&([l,d]=await Lf(this.storage,this.storageKey));const{data:c,error:u}=await Tr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:d}),jwt:o.access_token,xform:Fd});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),yr(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Qi;const r=Date.now()/1e3;let s=r,a=!0,i=null;const{payload:o}=VN(t.access_token);if(o.exp&&(s=o.exp,a=s<=r),a){const{data:l,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:d}=await this._getUser(t.access_token);if(d)throw d;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(yr(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:o,error:l}=r;if(l)throw l;t=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new Qi;const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(yr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!Ia())throw new dy("No browser detected.");if(t.error||t.error_description||t.error_code)throw new dy(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new jO("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new dy("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new jO("No code detected.");const{data:y,error:b}=await this._exchangeCodeForSession(t.code);if(b)throw b;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:l,expires_at:d,token_type:c}=t;if(!i||!l||!o||!c)throw new dy("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(l);let f=u+h;d&&(f=parseInt(d));const m=f-u;m*1e3<=tm&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const p=f-h;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,u);const{data:g,error:x}=await this._getUser(i);if(x)throw x;const v={provider_token:s,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:c,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:v,redirectType:t.type},error:null})}catch(s){if(yr(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Qu(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:a,error:i}=r;if(i)return this._returnResult({error:i});const o=(s=a.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(nde(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Ma(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=fde(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,a;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await Lf(this.storage,this.storageKey,!0));try{return await Tr(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),yr(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:a}=await this._useSession(async i=>{var o,l,d,c,u;const{data:h,error:f}=i;if(f)throw f;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Tr(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return Ia()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:t.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(yr(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:a,data:{session:i}}=r;if(a)throw a;const{options:o,provider:l,token:d,access_token:c,nonce:u}=t,h=await Tr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:d,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:nl}),{data:f,error:m}=h;return m?this._returnResult({data:{user:null,session:null},error:m}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Df}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:m}))}catch(a){if(await Ma(this.storage,`${this.storageKey}-code-verifier`),yr(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,a;const{data:i,error:o}=r;if(o)throw o;return await Tr(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await xde(async a=>(a>0&&await gde(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Tr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:nl})),(a,i)=>{const o=200*Math.pow(2,a);return i&&UN(i)&&Date.now()+o-s<tm})}catch(s){if(this._debug(r,"error",s),yr(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),Ia()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await Qu(this.storage,this.storageKey);if(a&&this.userStorage){let o=await Qu(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await rm(this.userStorage,this.storageKey+"-user",o)),a.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:qN()}else if(a&&!a.user&&!a.user){const o=await Qu(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await Ma(this.storage,this.storageKey+"-user"),await rm(this.storage,this.storageKey,a)):a.user=qN()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<zN;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${zN}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),UN(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(a.access_token);!l&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new Qi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new g_;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new Qi;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(a,"error",i),yr(i)){const o={data:null,error:i};return UN(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,s=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,r)}catch(d){i.push(d)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Ma(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await rm(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=kO(a);await rm(this.storage,this.storageKey,i)}else{const a=kO(r);await rm(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ma(this.storage,this.storageKey),await Ma(this.storage,this.storageKey+"-code-verifier"),await Ma(this.storage,this.storageKey+"-user"),this.userStorage&&await Ma(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Ia()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),tm);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-t)/tm);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${tm}ms, refresh threshold is ${XS} ticks`),a<=XS&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof NU)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ia()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const a=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Lf(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(l.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);a.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;return i?this._returnResult({data:null,error:i}):await Tr(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,a;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:c}=await Tr(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&d.type==="totp"&&(!((a=d==null?void 0:d.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Gde(t.webauthn.credential_response):Kde(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:d}=await Tr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:d}))})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await Tr(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Wde(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:Hde(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:s},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=VN(s.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const c=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:c},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;return a?this._returnResult({data:null,error:a}):s?await Tr(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Qi})})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:a},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Qi});const o=await Tr(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Ia()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(yr(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:a},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new Qi});const o=await Tr(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Ia()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(yr(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await Tr(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new Qi})})}catch(t){if(yr(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;return a?this._returnResult({data:null,error:a}):s?(await Tr(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Qi})})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(l=>l.kid===t);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(l=>l.kid===t),s&&this.jwks_cached_at+tde>a)return s;const{data:i,error:o}=await Tr(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,s=i.keys.find(l=>l.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:m,error:p}=await this.getSession();if(p||!m.session)return this._returnResult({data:null,error:p});s=m.session.access_token}const{header:a,payload:i,signature:o,raw:{header:l,payload:d}}=VN(s);r!=null&&r.allowExpired||Nde(i.exp);const c=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!c){const{error:m}=await this.getUser(s);if(m)throw m;return{data:{claims:i,header:a,signature:o},error:null}}const u=Sde(a.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,ude(`${l}.${d}`)))throw new QS("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(s){if(yr(s))return this._returnResult({data:null,error:s});throw s}}}Lx.nextInstanceID={};const nue=Lx,sue="2.91.0";let C0="";typeof Deno<"u"?C0="deno":typeof document<"u"?C0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?C0="react-native":C0="node";const aue={"X-Client-Info":`supabase-js-${C0}/${sue}`},iue={headers:aue},oue={schema:"public"},lue={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},cue={};function Bx(e){"@babel/helpers - typeof";return Bx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bx(e)}function due(e,t){if(Bx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Bx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uue(e){var t=due(e,"string");return Bx(t)=="symbol"?t:t+""}function hue(e,t,r){return(t=uue(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Is(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IO(Object(r),!0).forEach(function(s){hue(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IO(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const fue=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),mue=()=>Headers,pue=(e,t,r)=>{const s=fue(r),a=mue();return async(i,o)=>{var l;const d=(l=await t())!==null&&l!==void 0?l:e;let c=new a(o==null?void 0:o.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${d}`),s(i,Is(Is({},o),{},{headers:c}))}};function gue(e){return e.endsWith("/")?e:e+"/"}function xue(e,t){var r,s;const{db:a,auth:i,realtime:o,global:l}=e,{db:d,auth:c,realtime:u,global:h}=t,f={db:Is(Is({},d),a),auth:Is(Is({},c),i),realtime:Is(Is({},u),o),storage:{},global:Is(Is(Is({},h),l),{},{headers:Is(Is({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function vue(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(gue(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var yue=class extends nue{constructor(e){super(e)}},bue=class{constructor(e,t,r){var s,a;this.supabaseUrl=e,this.supabaseKey=t;const i=vue(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,l={db:oue,realtime:cue,auth:Is(Is({},lue),{},{storageKey:o}),global:iue},d=xue(r??{},l);if(this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(u,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=d.auth)!==null&&c!==void 0?c:{},this.headers,d.global.fetch)}this.fetch=pue(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Is({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new Jle(new URL("rest/v1",i).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new Yce(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new Kle(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:s}=await e.auth.getSession();return(t=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:i,flowType:o,lock:l,debug:d,throwOnError:c},u,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new yue({url:this.authUrl.href,headers:Is(Is({},f),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:o,lock:l,debug:d,throwOnError:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new gce(this.realtimeUrl.href,Is(Is({},e),{},{params:Is(Is({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const wue=(e,t,r)=>new bue(e,t,r);function _ue(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}_ue()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const jue="https://deibjfkveiyogvtscyeh.supabase.co",Nue="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlaWJqZmt2ZWl5b2d2dHNjeWVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA2MDA3MzMsImV4cCI6MjA4NjE3NjczM30.eYGXOHLLJq6wpRT605kxSc8t_qS15_ux174d0rUOmfY",le=wue(jue,Nue,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}});function Sue(){const e=P.useCallback(async u=>{const h=new Date().toISOString();let f=le.from("gift_rules").select(`
        *,
        gift:gifts(*)
      `).eq("is_active",!0).or(`start_at.is.null,start_at.lte.${h}`).or(`end_at.is.null,end_at.gte.${h}`).order("priority",{ascending:!1});u.channel==="catalog"?f=f.in("channel_scope",["catalog_only","both"]):f=f.in("channel_scope",["live_only","both","live_specific"]);const{data:m,error:p}=await f;if(p)return console.error("Error fetching gift rules:",p),[];let g=m||[];return u.liveEventId?g=g.filter(x=>x.channel_scope==="live_specific"?x.live_event_id===u.liveEventId:!0):g=g.filter(x=>x.channel_scope!=="live_specific"),g},[]),t=P.useCallback(async(u,h)=>{switch(u.condition_type){case"all_purchases":return!0;case"min_value":return u.condition_value?h.cartTotal>=u.condition_value:!1;case"first_n_paid":return u.condition_value?u.current_awards_count<u.condition_value:!1;case"first_n_reserved":return u.condition_value?u.current_awards_count<u.condition_value:!1;default:return!1}},[]),r=P.useCallback(async(u,h,f)=>{var g;if(!u.max_per_customer||!h&&!f)return!0;let m=le.from("order_gifts").select("id",{count:"exact"}).eq("applied_by_rule_id",u.id);if(f){const{data:x}=await le.from("live_carts").select("live_customer:live_customers(instagram_handle)").eq("id",f).single();if((g=x==null?void 0:x.live_customer)!=null&&g.instagram_handle){const{data:v}=await le.from("live_carts").select("id").eq("live_customers.instagram_handle",x.live_customer.instagram_handle);v&&v.length>0&&(m=m.in("live_cart_id",v.map(y=>y.id)))}}const{count:p}=await m;return(p||0)<u.max_per_customer},[]),s=P.useCallback(u=>u.max_total_awards?u.current_awards_count<u.max_total_awards:!0,[]),a=P.useCallback(async(u,h)=>{const f=u.gift;if(!f)return!1;if(!f.unlimited_stock&&f.stock_qty<u.gift_qty)return console.log(`Gift ${f.name} out of stock`),!1;if(h.simulateOnly)return!0;try{const{error:m}=await le.from("order_gifts").insert({order_id:h.orderId||null,live_cart_id:h.liveCartId||null,gift_id:f.id,qty:u.gift_qty,status:"pending_separation",applied_by_rule_id:u.id});if(m)throw m;return await le.rpc("decrement_gift_stock",{p_gift_id:f.id,p_qty:u.gift_qty}),await le.rpc("increment_gift_rule_awards",{p_rule_id:u.id,p_qty:1}),!0}catch(m){return console.error("Error applying gift:",m),!1}},[]),i=P.useCallback(async u=>{const h=[];try{const f=await e(u);for(const m of f){if(!await t(m,u))continue;if(!u.simulateOnly){if(!await r(m,u.customerId,u.liveCartId)||!s(m))continue;const y=le.from("order_gifts").select("id").eq("gift_id",m.gift_id).eq("applied_by_rule_id",m.id);u.orderId?y.eq("order_id",u.orderId):u.liveCartId&&y.eq("live_cart_id",u.liveCartId);const{data:b}=await y;if(b&&b.length>0)continue}await a(m,u)&&m.gift&&h.push({giftId:m.gift.id,giftName:m.gift.name,giftImage:m.gift.image_url,ruleId:m.id,qty:m.gift_qty})}!u.simulateOnly&&h.length>0&&de.success(` Brinde aplicado: ${h.map(m=>m.giftName).join(", ")}`)}catch(f){console.error("Error evaluating gifts:",f)}return h},[e,t,r,s,a]),o=P.useCallback(async u=>{try{let h=le.from("order_gifts").select(`
          id,
          gift_id,
          applied_by_rule_id,
          gift_rule:gift_rules(*)
        `).not("applied_by_rule_id","is",null);u.orderId?h=h.eq("order_id",u.orderId):u.liveCartId&&(h=h.eq("live_cart_id",u.liveCartId));const{data:f}=await h;if(!f||f.length===0)return;for(const m of f){const p=m.gift_rule;if(!p)continue;await t(p,u)||(await le.from("order_gifts").update({status:"removed"}).eq("id",m.id),await le.rpc("decrement_gift_stock",{p_gift_id:m.gift_id,p_qty:-1}),de.info("Brinde removido (condio no atendida)"))}}catch(h){console.error("Error reevaluating gifts:",h)}},[t]),l=P.useCallback(async(u,h)=>{let f=le.from("order_gifts").select(`
        *,
        gift:gifts(*),
        gift_rule:gift_rules(*)
      `).neq("status","removed");if(u)f=f.eq("order_id",u);else if(h)f=f.eq("live_cart_id",h);else return[];const{data:m,error:p}=await f;return p?(console.error("Error fetching applied gifts:",p),[]):m||[]},[]),d=P.useCallback(async u=>{const{data:h,error:f}=await le.from("order_gifts").select(`
        id,
        gift_id,
        qty,
        status,
        applied_by_rule_id,
        applied_by_raffle_id,
        gift:gifts(id, name, image_url, sku)
      `).eq("live_cart_id",u).neq("status","removed");return f?(console.error("Error fetching live cart gifts:",f),[]):h||[]},[]),c=P.useCallback(async(u,h,f,m)=>{try{const{error:p}=await le.from("order_gifts").insert({live_cart_id:u,gift_id:h,qty:1,status:"pending_separation",applied_by_rule_id:f==="rule"?m:null,applied_by_raffle_id:f==="raffle"?m:null});if(p)throw p;return await le.rpc("decrement_gift_stock",{p_gift_id:h,p_qty:1}),!0}catch(p){return console.error("Error adding gift to cart:",p),!1}},[]);return{evaluateAndApplyGifts:i,reevaluateGifts:o,getAppliedGifts:l,getLiveCartGifts:d,addGiftToLiveCart:c}}const EU=P.createContext(void 0),DO="loja_cart";function Cue({children:e}){const[t,r]=P.useState(()=>{if(typeof window<"u"){const f=localStorage.getItem(DO);if(f)try{return JSON.parse(f).map(p=>({...p,originalPrice:p.originalPrice??p.price,discountPercent:p.discountPercent??0}))}catch{return[]}}return[]}),{evaluateAndApplyGifts:s}=Sue(),[a,i]=P.useState([]);P.useEffect(()=>{localStorage.setItem(DO,JSON.stringify(t))},[t]);const o=t.reduce((f,m)=>f+m.price*m.quantity,0),l=t.reduce((f,m)=>f+m.quantity,0);P.useEffect(()=>{(async()=>{if(o>0){const p=(await s({channel:"catalog",cartTotal:o,simulateOnly:!0})).map(g=>({productId:g.giftId,name:g.giftName,price:0,originalPrice:0,discountPercent:100,size:"nico",quantity:g.qty,imageUrl:g.giftImage,isGift:!0}));i(p)}else i([])})()},[o,s]);const d=f=>{r(m=>m.find(g=>g.productId===f.productId&&g.size===f.size)?m.map(g=>g.productId===f.productId&&g.size===f.size?{...g,quantity:g.quantity+1}:g):[...m,{...f,quantity:1}])},c=(f,m)=>{r(p=>p.filter(g=>!(g.productId===f&&g.size===m)))},u=(f,m,p)=>{if(p<=0){c(f,m);return}r(g=>g.map(x=>x.productId===f&&x.size===m?{...x,quantity:p}:x))},h=()=>r([]);return n.jsx(EU.Provider,{value:{items:t,addItem:d,removeItem:c,updateQuantity:u,clearCart:h,total:o,itemCount:l,gifts:a},children:e})}function Lu(){const e=P.useContext(EU);if(!e)throw new Error("useCart must be used within a CartProvider");return e}const $x=Jp("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),he=P.forwardRef(({className:e,variant:t,size:r,asChild:s=!1,...a},i)=>{const o=s?Yre:"button";return n.jsx(o,{className:He($x({variant:t,size:r,className:e})),ref:i,...a})});he.displayName="Button";const bf="/assets/logo-lepoa-sOM5Pm3c.png";var HN="focusScope.autoFocusOnMount",GN="focusScope.autoFocusOnUnmount",LO={bubbles:!1,cancelable:!0},Eue="FocusScope",e1=P.forwardRef((e,t)=>{const{loop:r=!1,trapped:s=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=e,[l,d]=P.useState(null),c=Us(a),u=Us(i),h=P.useRef(null),f=Rr(t,g=>d(g)),m=P.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;P.useEffect(()=>{if(s){let g=function(b){if(m.paused||!l)return;const j=b.target;l.contains(j)?h.current=j:Td(h.current,{select:!0})},x=function(b){if(m.paused||!l)return;const j=b.relatedTarget;j!==null&&(l.contains(j)||Td(h.current,{select:!0}))},v=function(b){if(document.activeElement===document.body)for(const T of b)T.removedNodes.length>0&&Td(l)};document.addEventListener("focusin",g),document.addEventListener("focusout",x);const y=new MutationObserver(v);return l&&y.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",x),y.disconnect()}}},[s,l,m.paused]),P.useEffect(()=>{if(l){$O.add(m);const g=document.activeElement;if(!l.contains(g)){const v=new CustomEvent(HN,LO);l.addEventListener(HN,c),l.dispatchEvent(v),v.defaultPrevented||(kue(Rue(kU(l)),{select:!0}),document.activeElement===g&&Td(l))}return()=>{l.removeEventListener(HN,c),setTimeout(()=>{const v=new CustomEvent(GN,LO);l.addEventListener(GN,u),l.dispatchEvent(v),v.defaultPrevented||Td(g??document.body,{select:!0}),l.removeEventListener(GN,u),$O.remove(m)},0)}}},[l,c,u,m]);const p=P.useCallback(g=>{if(!r&&!s||m.paused)return;const x=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,v=document.activeElement;if(x&&v){const y=g.currentTarget,[b,j]=Aue(y);b&&j?!g.shiftKey&&v===j?(g.preventDefault(),r&&Td(b,{select:!0})):g.shiftKey&&v===b&&(g.preventDefault(),r&&Td(j,{select:!0})):v===y&&g.preventDefault()}},[r,s,m.paused]);return n.jsx(er.div,{tabIndex:-1,...o,ref:f,onKeyDown:p})});e1.displayName=Eue;function kue(e,{select:t=!1}={}){const r=document.activeElement;for(const s of e)if(Td(s,{select:t}),document.activeElement!==r)return}function Aue(e){const t=kU(e),r=BO(t,e),s=BO(t.reverse(),e);return[r,s]}function kU(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function BO(e,t){for(const r of e)if(!Tue(r,{upTo:t}))return r}function Tue(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Pue(e){return e instanceof HTMLInputElement&&"select"in e}function Td(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Pue(e)&&t&&e.select()}}var $O=Oue();function Oue(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=FO(e,t),e.unshift(t)},remove(t){var r;e=FO(e,t),(r=e[0])==null||r.resume()}}}function FO(e,t){const r=[...e],s=r.indexOf(t);return s!==-1&&r.splice(s,1),r}function Rue(e){return e.filter(t=>t.tagName!=="A")}var KN=0;function x_(){P.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??zO()),document.body.insertAdjacentElement("beforeend",e[1]??zO()),KN++,()=>{KN===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),KN--}},[])}function zO(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var hb="right-scroll-bar-position",fb="width-before-scroll-bar",Mue="with-scroll-bars-hidden",Iue="--removed-body-scroll-bar-size";function XN(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Due(e,t){var r=P.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(s){var a=r.value;a!==s&&(r.value=s,r.callback(s,a))}}}})[0];return r.callback=t,r.facade}var Lue=typeof window<"u"?P.useLayoutEffect:P.useEffect,UO=new WeakMap;function Bue(e,t){var r=Due(null,function(s){return e.forEach(function(a){return XN(a,s)})});return Lue(function(){var s=UO.get(r);if(s){var a=new Set(s),i=new Set(e),o=r.current;a.forEach(function(l){i.has(l)||XN(l,null)}),i.forEach(function(l){a.has(l)||XN(l,o)})}UO.set(r,e)},[e]),r}function $ue(e){return e}function Fue(e,t){t===void 0&&(t=$ue);var r=[],s=!1,a={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var o=t(i,s);return r.push(o),function(){r=r.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(s=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(l){return i(l)},filter:function(){return r}}},assignMedium:function(i){s=!0;var o=[];if(r.length){var l=r;r=[],l.forEach(i),o=r}var d=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(d)};c(),r={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),r}}}};return a}function zue(e){e===void 0&&(e={});var t=Fue(null);return t.options=Kl({async:!0,ssr:!1},e),t}var AU=function(e){var t=e.sideCar,r=ig(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=t.read();if(!s)throw new Error("Sidecar medium not found");return P.createElement(s,Kl({},r))};AU.isSideCarExport=!0;function Uue(e,t){return e.useMedium(t),AU}var TU=zue(),YN=function(){},v_=P.forwardRef(function(e,t){var r=P.useRef(null),s=P.useState({onScrollCapture:YN,onWheelCapture:YN,onTouchMoveCapture:YN}),a=s[0],i=s[1],o=e.forwardProps,l=e.children,d=e.className,c=e.removeScrollBar,u=e.enabled,h=e.shards,f=e.sideCar,m=e.noRelative,p=e.noIsolation,g=e.inert,x=e.allowPinchZoom,v=e.as,y=v===void 0?"div":v,b=e.gapMode,j=ig(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),T=f,O=Bue([r,t]),R=Kl(Kl({},j),a);return P.createElement(P.Fragment,null,u&&P.createElement(T,{sideCar:TU,removeScrollBar:c,shards:h,noRelative:m,noIsolation:p,inert:g,setCallbacks:i,allowPinchZoom:!!x,lockRef:r,gapMode:b}),o?P.cloneElement(P.Children.only(l),Kl(Kl({},R),{ref:O})):P.createElement(y,Kl({},R,{className:d,ref:O}),l))});v_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};v_.classNames={fullWidth:fb,zeroRight:hb};var Vue=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function que(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=Vue();return t&&e.setAttribute("nonce",t),e}function Wue(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Hue(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Gue=function(){var e=0,t=null;return{add:function(r){e==0&&(t=que())&&(Wue(t,r),Hue(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Kue=function(){var e=Gue();return function(t,r){P.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},PU=function(){var e=Kue(),t=function(r){var s=r.styles,a=r.dynamic;return e(s,a),null};return t},Xue={left:0,top:0,right:0,gap:0},ZN=function(e){return parseInt(e||"",10)||0},Yue=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],s=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[ZN(r),ZN(s),ZN(a)]},Zue=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Xue;var t=Yue(e),r=document.documentElement.clientWidth,s=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,s-r+t[2]-t[0])}},Que=PU(),Lm="data-scroll-locked",Jue=function(e,t,r,s){var a=e.left,i=e.top,o=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(Mue,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(l,"px ").concat(s,`;
  }
  body[`).concat(Lm,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(s,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(s,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(hb,` {
    right: `).concat(l,"px ").concat(s,`;
  }
  
  .`).concat(fb,` {
    margin-right: `).concat(l,"px ").concat(s,`;
  }
  
  .`).concat(hb," .").concat(hb,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(fb," .").concat(fb,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Lm,`] {
    `).concat(Iue,": ").concat(l,`px;
  }
`)},VO=function(){var e=parseInt(document.body.getAttribute(Lm)||"0",10);return isFinite(e)?e:0},ehe=function(){P.useEffect(function(){return document.body.setAttribute(Lm,(VO()+1).toString()),function(){var e=VO()-1;e<=0?document.body.removeAttribute(Lm):document.body.setAttribute(Lm,e.toString())}},[])},the=function(e){var t=e.noRelative,r=e.noImportant,s=e.gapMode,a=s===void 0?"margin":s;ehe();var i=P.useMemo(function(){return Zue(a)},[a]);return P.createElement(Que,{styles:Jue(i,!t,a,r?"":"!important")})},JS=!1;if(typeof window<"u")try{var uy=Object.defineProperty({},"passive",{get:function(){return JS=!0,!0}});window.addEventListener("test",uy,uy),window.removeEventListener("test",uy,uy)}catch{JS=!1}var zf=JS?{passive:!1}:!1,rhe=function(e){return e.tagName==="TEXTAREA"},OU=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!rhe(e)&&r[t]==="visible")},nhe=function(e){return OU(e,"overflowY")},she=function(e){return OU(e,"overflowX")},qO=function(e,t){var r=t.ownerDocument,s=t;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var a=RU(e,s);if(a){var i=MU(e,s),o=i[1],l=i[2];if(o>l)return!0}s=s.parentNode}while(s&&s!==r.body);return!1},ahe=function(e){var t=e.scrollTop,r=e.scrollHeight,s=e.clientHeight;return[t,r,s]},ihe=function(e){var t=e.scrollLeft,r=e.scrollWidth,s=e.clientWidth;return[t,r,s]},RU=function(e,t){return e==="v"?nhe(t):she(t)},MU=function(e,t){return e==="v"?ahe(t):ihe(t)},ohe=function(e,t){return e==="h"&&t==="rtl"?-1:1},lhe=function(e,t,r,s,a){var i=ohe(e,window.getComputedStyle(t).direction),o=i*s,l=r.target,d=t.contains(l),c=!1,u=o>0,h=0,f=0;do{if(!l)break;var m=MU(e,l),p=m[0],g=m[1],x=m[2],v=g-x-i*p;(p||v)&&RU(e,l)&&(h+=v,f+=p);var y=l.parentNode;l=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!d&&l!==document.body||d&&(t.contains(l)||t===l));return(u&&(Math.abs(h)<1||!a)||!u&&(Math.abs(f)<1||!a))&&(c=!0),c},hy=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},WO=function(e){return[e.deltaX,e.deltaY]},HO=function(e){return e&&"current"in e?e.current:e},che=function(e,t){return e[0]===t[0]&&e[1]===t[1]},dhe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},uhe=0,Uf=[];function hhe(e){var t=P.useRef([]),r=P.useRef([0,0]),s=P.useRef(),a=P.useState(uhe++)[0],i=P.useState(PU)[0],o=P.useRef(e);P.useEffect(function(){o.current=e},[e]),P.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var g=Wle([e.lockRef.current],(e.shards||[]).map(HO),!0).filter(Boolean);return g.forEach(function(x){return x.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),g.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var l=P.useCallback(function(g,x){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var v=hy(g),y=r.current,b="deltaX"in g?g.deltaX:y[0]-v[0],j="deltaY"in g?g.deltaY:y[1]-v[1],T,O=g.target,R=Math.abs(b)>Math.abs(j)?"h":"v";if("touches"in g&&R==="h"&&O.type==="range")return!1;var D=qO(R,O);if(!D)return!0;if(D?T=R:(T=R==="v"?"h":"v",D=qO(R,O)),!D)return!1;if(!s.current&&"changedTouches"in g&&(b||j)&&(s.current=T),!T)return!0;var B=s.current||T;return lhe(B,x,g,B==="h"?b:j,!0)},[]),d=P.useCallback(function(g){var x=g;if(!(!Uf.length||Uf[Uf.length-1]!==i)){var v="deltaY"in x?WO(x):hy(x),y=t.current.filter(function(T){return T.name===x.type&&(T.target===x.target||x.target===T.shadowParent)&&che(T.delta,v)})[0];if(y&&y.should){x.cancelable&&x.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(HO).filter(Boolean).filter(function(T){return T.contains(x.target)}),j=b.length>0?l(x,b[0]):!o.current.noIsolation;j&&x.cancelable&&x.preventDefault()}}},[]),c=P.useCallback(function(g,x,v,y){var b={name:g,delta:x,target:v,should:y,shadowParent:fhe(v)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(j){return j!==b})},1)},[]),u=P.useCallback(function(g){r.current=hy(g),s.current=void 0},[]),h=P.useCallback(function(g){c(g.type,WO(g),g.target,l(g,e.lockRef.current))},[]),f=P.useCallback(function(g){c(g.type,hy(g),g.target,l(g,e.lockRef.current))},[]);P.useEffect(function(){return Uf.push(i),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",d,zf),document.addEventListener("touchmove",d,zf),document.addEventListener("touchstart",u,zf),function(){Uf=Uf.filter(function(g){return g!==i}),document.removeEventListener("wheel",d,zf),document.removeEventListener("touchmove",d,zf),document.removeEventListener("touchstart",u,zf)}},[]);var m=e.removeScrollBar,p=e.inert;return P.createElement(P.Fragment,null,p?P.createElement(i,{styles:dhe(a)}):null,m?P.createElement(the,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function fhe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const mhe=Uue(TU,hhe);var t1=P.forwardRef(function(e,t){return P.createElement(v_,Kl({},e,{ref:t,sideCar:mhe}))});t1.classNames=v_.classNames;var phe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Vf=new WeakMap,fy=new WeakMap,my={},QN=0,IU=function(e){return e&&(e.host||IU(e.parentNode))},ghe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var s=IU(r);return s&&e.contains(s)?s:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},xhe=function(e,t,r,s){var a=ghe(t,Array.isArray(e)?e:[e]);my[r]||(my[r]=new WeakMap);var i=my[r],o=[],l=new Set,d=new Set(a),c=function(h){!h||l.has(h)||(l.add(h),c(h.parentNode))};a.forEach(c);var u=function(h){!h||d.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))u(f);else try{var m=f.getAttribute(s),p=m!==null&&m!=="false",g=(Vf.get(f)||0)+1,x=(i.get(f)||0)+1;Vf.set(f,g),i.set(f,x),o.push(f),g===1&&p&&fy.set(f,!0),x===1&&f.setAttribute(r,"true"),p||f.setAttribute(s,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return u(t),l.clear(),QN++,function(){o.forEach(function(h){var f=Vf.get(h)-1,m=i.get(h)-1;Vf.set(h,f),i.set(h,m),f||(fy.has(h)||h.removeAttribute(s),fy.delete(h)),m||h.removeAttribute(r)}),QN--,QN||(Vf=new WeakMap,Vf=new WeakMap,fy=new WeakMap,my={})}},y_=function(e,t,r){r===void 0&&(r="data-aria-hidden");var s=Array.from(Array.isArray(e)?e:[e]),a=phe(e);return a?(s.push.apply(s,Array.from(a.querySelectorAll("[aria-live]"))),xhe(s,a,r,"aria-hidden")):function(){return null}},b_="Dialog",[DU,LU]=ea(b_),[vhe,Al]=DU(b_),BU=e=>{const{__scopeDialog:t,children:r,open:s,defaultOpen:a,onOpenChange:i,modal:o=!0}=e,l=P.useRef(null),d=P.useRef(null),[c,u]=Ui({prop:s,defaultProp:a??!1,onChange:i,caller:b_});return n.jsx(vhe,{scope:t,triggerRef:l,contentRef:d,contentId:pa(),titleId:pa(),descriptionId:pa(),open:c,onOpenChange:u,onOpenToggle:P.useCallback(()=>u(h=>!h),[u]),modal:o,children:r})};BU.displayName=b_;var $U="DialogTrigger",FU=P.forwardRef((e,t)=>{const{__scopeDialog:r,...s}=e,a=Al($U,r),i=Rr(t,a.triggerRef);return n.jsx(er.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":ok(a.open),...s,ref:i,onClick:Tt(e.onClick,a.onOpenToggle)})});FU.displayName=$U;var ak="DialogPortal",[yhe,zU]=DU(ak,{forceMount:void 0}),UU=e=>{const{__scopeDialog:t,forceMount:r,children:s,container:a}=e,i=Al(ak,t);return n.jsx(yhe,{scope:t,forceMount:r,children:P.Children.map(s,o=>n.jsx(Ws,{present:r||i.open,children:n.jsx(Qp,{asChild:!0,container:a,children:o})}))})};UU.displayName=ak;var aw="DialogOverlay",VU=P.forwardRef((e,t)=>{const r=zU(aw,e.__scopeDialog),{forceMount:s=r.forceMount,...a}=e,i=Al(aw,e.__scopeDialog);return i.modal?n.jsx(Ws,{present:s||i.open,children:n.jsx(whe,{...a,ref:t})}):null});VU.displayName=aw;var bhe=yu("DialogOverlay.RemoveScroll"),whe=P.forwardRef((e,t)=>{const{__scopeDialog:r,...s}=e,a=Al(aw,r);return n.jsx(t1,{as:bhe,allowPinchZoom:!0,shards:[a.contentRef],children:n.jsx(er.div,{"data-state":ok(a.open),...s,ref:t,style:{pointerEvents:"auto",...s.style}})})}),Yh="DialogContent",qU=P.forwardRef((e,t)=>{const r=zU(Yh,e.__scopeDialog),{forceMount:s=r.forceMount,...a}=e,i=Al(Yh,e.__scopeDialog);return n.jsx(Ws,{present:s||i.open,children:i.modal?n.jsx(_he,{...a,ref:t}):n.jsx(jhe,{...a,ref:t})})});qU.displayName=Yh;var _he=P.forwardRef((e,t)=>{const r=Al(Yh,e.__scopeDialog),s=P.useRef(null),a=Rr(t,r.contentRef,s);return P.useEffect(()=>{const i=s.current;if(i)return y_(i)},[]),n.jsx(WU,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Tt(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Tt(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:Tt(e.onFocusOutside,i=>i.preventDefault())})}),jhe=P.forwardRef((e,t)=>{const r=Al(Yh,e.__scopeDialog),s=P.useRef(!1),a=P.useRef(!1);return n.jsx(WU,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(s.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:i=>{var d,c;(d=e.onInteractOutside)==null||d.call(e,i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((c=r.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),WU=P.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,...o}=e,l=Al(Yh,r),d=P.useRef(null),c=Rr(t,d);return x_(),n.jsxs(n.Fragment,{children:[n.jsx(e1,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:i,children:n.jsx(Ou,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":ok(l.open),...o,ref:c,onDismiss:()=>l.onOpenChange(!1)})}),n.jsxs(n.Fragment,{children:[n.jsx(She,{titleId:l.titleId}),n.jsx(Ehe,{contentRef:d,descriptionId:l.descriptionId})]})]})}),ik="DialogTitle",HU=P.forwardRef((e,t)=>{const{__scopeDialog:r,...s}=e,a=Al(ik,r);return n.jsx(er.h2,{id:a.titleId,...s,ref:t})});HU.displayName=ik;var GU="DialogDescription",KU=P.forwardRef((e,t)=>{const{__scopeDialog:r,...s}=e,a=Al(GU,r);return n.jsx(er.p,{id:a.descriptionId,...s,ref:t})});KU.displayName=GU;var XU="DialogClose",YU=P.forwardRef((e,t)=>{const{__scopeDialog:r,...s}=e,a=Al(XU,r);return n.jsx(er.button,{type:"button",...s,ref:t,onClick:Tt(e.onClick,()=>a.onOpenChange(!1))})});YU.displayName=XU;function ok(e){return e?"open":"closed"}var ZU="DialogTitleWarning",[Nhe,QU]=Kre(ZU,{contentName:Yh,titleName:ik,docsSlug:"dialog"}),She=({titleId:e})=>{const t=QU(ZU),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return P.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},Che="DialogDescriptionWarning",Ehe=({contentRef:e,descriptionId:t})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${QU(Che).contentName}}.`;return P.useEffect(()=>{var i;const a=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(s))},[s,e,t]),null},r1=BU,w_=FU,n1=UU,wf=VU,_f=qU,og=HU,lg=KU,s1=YU;const _u=r1,lk=w_,khe=n1,JU=P.forwardRef(({className:e,...t},r)=>n.jsx(wf,{className:He("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));JU.displayName=wf.displayName;const Ahe=Jp("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500 overflow-y-auto",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top max-h-[85vh]",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom max-h-[85vh]",left:"inset-y-0 left-0 h-full w-[min(92vw,320px)] sm:w-[min(92vw,360px)] max-w-full border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left",right:"inset-y-0 right-0 h-full w-[min(92vw,320px)] sm:w-[min(92vw,400px)] max-w-full border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right"}},defaultVariants:{side:"right"}}),rd=P.forwardRef(({side:e="right",className:t,children:r,...s},a)=>n.jsxs(khe,{children:[n.jsx(JU,{}),n.jsxs(_f,{ref:a,className:He(Ahe({side:e}),t),...s,children:[r,n.jsxs(s1,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[n.jsx(sn,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));rd.displayName=_f.displayName;const ju=({className:e,...t})=>n.jsx("div",{className:He("flex flex-col space-y-2 text-center sm:text-left",e),...t});ju.displayName="SheetHeader";const eV=({className:e,...t})=>n.jsx("div",{className:He("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});eV.displayName="SheetFooter";const Zh=P.forwardRef(({className:e,...t},r)=>n.jsx(og,{ref:r,className:He("text-lg font-semibold text-foreground",e),...t}));Zh.displayName=og.displayName;const The=P.forwardRef(({className:e,...t},r)=>n.jsx(lg,{ref:r,className:He("text-sm text-muted-foreground",e),...t}));The.displayName=lg.displayName;function GO(){const e=pr(),{itemCount:t}=Lu();return n.jsxs(he,{variant:"ghost",size:"icon",className:"relative",onClick:()=>e("/carrinho"),"aria-label":"Ver carrinho",children:[n.jsx(hn,{className:"h-5 w-5"}),t>0&&n.jsx("span",{className:"absolute -top-1 -right-1 h-5 w-5 rounded-full bg-accent text-accent-foreground text-xs flex items-center justify-center font-medium",children:t>9?"9+":t})]})}const Phe="5562991223519";function po(e,t){let r,s;t===void 0?(r=Phe,s=e):(r=e,s=t);const a=Ohe(r),i=encodeURIComponent(s);return`https://wa.me/${a}?text=${i}`}function Ohe(e){const t=e.replace(/\D/g,"");return t.startsWith("55")&&t.length===13?t:t.length===11?`55${t}`:t}function tV(e){return e?e.replace(/@/g,"").replace(/\s/g,"").toLowerCase().trim():""}function iw(e){if(!e)return"";const t=tV(e);return t?`@${t}`:""}function rV(e){const t=tV(e);return t?`https://www.instagram.com/${t}`:null}function Fx(e,t){return`Oi, tudo bem? 
Aqui  da LE.PO. Muito obrigada por participar da nossa Live Shop.

${t?`Sua sacola #${t} j est pronta.`:"Sua sacola j est pronta."}
Para manter tudo organizado, pedimos que finalize seu pedido pelo link abaixo:
 ${e}

Qualquer dvida, fico  disposio.`}function Rhe(e,t,r){const s=t.map(a=>{let i=`${a.name} tam ${a.size}`;return a.color&&(i+=` (${a.color})`),i+=` x${a.quantity}`,i}).join(", ");return`Oi! Quero ajuda com meu pedido #${e}. Itens: ${s}. Total: ${r}.`}function Mhe(e){return`Oi! Quero falar sobre o pedido #${e}.`}function Ihe(){return"Oi! Vim pelo Provador VIP e queria tirar uma dvida "}function Nr({showCart:e=!0}){const t=po(Ihe());return n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b border-border",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 h-14 sm:h-16 flex items-center justify-between gap-2",children:[n.jsx(Ft,{to:"/",className:"flex items-center shrink-0",children:n.jsx("img",{src:bf,alt:"LE.PO",className:"h-7 sm:h-10 w-auto max-w-[100px] sm:max-w-none"})}),n.jsxs("nav",{className:"hidden md:flex items-center gap-4 lg:gap-6 flex-wrap",children:[n.jsx(Ft,{to:"/catalogo",className:"text-sm font-medium hover:text-accent transition-colors whitespace-nowrap",children:"Catlogo completo"}),n.jsx(Ft,{to:"/meu-estilo",className:"text-sm font-medium hover:text-accent transition-colors whitespace-nowrap",children:"Meu estilo"}),n.jsx(Ft,{to:"/enviar-print",className:"text-sm font-medium hover:text-accent transition-colors whitespace-nowrap",children:"Buscar por foto"}),e&&n.jsx(GO,{}),n.jsx(he,{variant:"ghost",size:"sm",className:"gap-2 text-green-600 hover:text-green-700 hover:bg-green-50 whitespace-nowrap",asChild:!0,children:n.jsxs("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:[n.jsx(nn,{className:"h-4 w-4"}),"Fale com a gente"]})}),n.jsx(Ft,{to:"/minha-conta",children:n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 whitespace-nowrap",children:[n.jsx(Dn,{className:"h-4 w-4"}),"Minha Conta"]})})]}),n.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 md:hidden",children:[e&&n.jsx(GO,{}),n.jsxs(_u,{children:[n.jsx(lk,{asChild:!0,children:n.jsx(he,{variant:"ghost",size:"icon",className:"h-9 w-9",children:n.jsx(nz,{className:"h-5 w-5"})})}),n.jsx(rd,{side:"right",className:"w-[min(92vw,320px)] p-0 overflow-hidden",children:n.jsxs("nav",{className:"flex flex-col gap-1 pt-12 px-4 h-full overflow-y-auto",children:[n.jsx(Ft,{to:"/catalogo",className:"text-base font-medium py-3 hover:text-accent transition-colors border-b",children:"Catlogo completo"}),n.jsx(Ft,{to:"/meu-estilo",className:"text-base font-medium py-3 hover:text-accent transition-colors border-b",children:"Meu estilo"}),n.jsx(Ft,{to:"/enviar-print",className:"text-base font-medium py-3 hover:text-accent transition-colors border-b",children:"Buscar por foto"}),n.jsx(Ft,{to:"/carrinho",className:"text-base font-medium py-3 hover:text-accent transition-colors border-b",children:"Meu Carrinho"}),n.jsxs("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-base font-medium py-3 text-green-600 hover:text-green-700 transition-colors border-b",children:[n.jsx(nn,{className:"h-5 w-5 shrink-0"}),"Fale com a gente"]}),n.jsx(Ft,{to:"/minha-conta",className:"mt-6",children:n.jsxs(he,{className:"w-full gap-2 h-11",children:[n.jsx(Dn,{className:"h-4 w-4"}),"Minha Conta"]})})]})})]})]})]})})}const Dhe=[{icon:ms,text:"3x sem juros"},{icon:nn,text:"Fale Conosco"}];function Bm(){return n.jsx("div",{className:"benefits-bar",children:n.jsx("div",{className:"container mx-auto flex items-center justify-center gap-4 md:gap-8 overflow-x-auto",children:Dhe.map((e,t)=>n.jsxs("div",{className:"flex items-center gap-1.5 whitespace-nowrap text-xs md:text-sm",children:[n.jsx(e.icon,{className:"h-3.5 w-3.5 md:h-4 md:w-4"}),n.jsx("span",{children:e.text})]},t))})})}function Qh({name:e,price:t,effectivePrice:r,imageUrl:s,tags:a=[],sizes:i=[],badge:o,onAddToLook:l,isOutOfStock:d=!1,hasPromotionalDiscount:c=!1,discountPercent:u=0,discountType:h,discountValue:f}){const m=v=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(v);let p=t,g=!1,x=null;return r!==void 0&&r<t?(p=r,g=!0,x=u>0?`-${u}%`:`-R$ ${(t-r).toFixed(2)}`):h&&f&&f>0&&(g=!0,h==="percentage"?(p=t*(1-f/100),x=`-${f}%`):(p=Math.max(0,t-f),x=`-R$ ${f.toFixed(2)}`)),n.jsxs("div",{className:He("card-product group",d&&"opacity-60"),children:[n.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden bg-secondary",children:[g&&x&&n.jsxs("span",{className:"absolute top-2 right-2 z-10 bg-green-600 text-white text-[10px] font-bold px-2 py-1 rounded-full flex items-center gap-1",children:[n.jsx(ua,{className:"h-3 w-3"}),x]}),o&&n.jsx("span",{className:"badge-promo",children:o}),n.jsx("img",{src:s||"/placeholder.svg",alt:e,className:He("w-full h-full object-cover transition-transform duration-500",!d&&"group-hover:scale-105")}),n.jsx("div",{className:He("absolute inset-0 bg-gradient-to-t from-black/20 to-transparent transition-opacity",d?"opacity-30":"opacity-0 group-hover:opacity-100")})]}),n.jsxs("div",{className:"p-3 md:p-4",children:[n.jsx("h3",{className:"font-medium text-sm md:text-base line-clamp-2 mb-1",children:e}),i.length>0&&n.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:["Tam: ",i.slice(0,4).join(", "),i.length>4?"...":""]}),n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("div",{className:"flex flex-col",children:g?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:He("font-semibold text-base md:text-lg text-green-600",d&&"text-muted-foreground"),children:m(p)}),n.jsx("span",{className:"text-xs text-muted-foreground line-through",children:m(t)})]}):n.jsx("span",{className:He("font-semibold text-base md:text-lg",d&&"text-muted-foreground"),children:m(t)})}),l&&!d&&n.jsxs(he,{size:"sm",variant:"outline",onClick:l,className:"gap-1.5",children:[n.jsx(hn,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Adicionar"})]})]})]})]})}function __(e={}){const{channel:t="catalog",productIds:r,enabled:s=!0}=e,[a,i]=P.useState(new Map),[o,l]=P.useState(!0),[d,c]=P.useState(null),u=P.useCallback(async()=>{if(!s){l(!1);return}try{l(!0),c(null);const{data:y,error:b}=await le.rpc("get_products_effective_prices",{p_channel:t,p_product_ids:r||null});if(b){console.error("[useEffectivePrices] RPC error:",b),c(b.message);return}const j=new Map;(y||[]).forEach(T=>{j.set(T.product_id,T)}),i(j)}catch(y){console.error("[useEffectivePrices] Error:",y),c(y instanceof Error?y.message:"Unknown error")}finally{l(!1)}},[t,r,s]);P.useEffect(()=>{u()},[u]);const h=P.useCallback((y,b)=>{const j=a.get(y);return(j==null?void 0:j.effective_price)??b},[a]),f=P.useCallback((y,b)=>{const j=a.get(y);return(j==null?void 0:j.original_price)??b},[a]),m=P.useCallback(y=>{const b=a.get(y);return b?b.effective_price<b.original_price:!1},[a]),p=P.useCallback(y=>{const b=a.get(y);return!b||b.effective_price>=b.original_price?0:Math.round((b.original_price-b.effective_price)/b.original_price*100)},[a]),g=P.useCallback(y=>{const b=a.get(y);return!b||!b.discount_type||b.effective_price>=b.original_price?null:b.discount_type==="percentage"&&b.discount_value?`-${b.discount_value}%`:b.discount_type==="fixed"&&b.discount_value?`-R$ ${b.discount_value.toFixed(2)}`:null},[a]),x=P.useCallback(y=>a.get(y)||null,[a]),v=P.useMemo(()=>Array.from(a.values()),[a]);return{priceData:a,allPriceData:v,isLoading:o,error:d,refetch:u,getEffectivePrice:h,getOriginalPrice:f,hasDiscount:m,getDiscountPercent:p,getDiscountLabel:g,getPromotionInfo:x}}function Lhe(e,t="catalog"){const[r,s]=P.useState(null),[a,i]=P.useState(!0);P.useEffect(()=>{if(!e){i(!1);return}async function d(){try{i(!0);const{data:c,error:u}=await le.rpc("get_products_effective_prices",{p_channel:t,p_product_ids:[e]});if(u){console.error("[useSingleProductEffectivePrice] Error:",u);return}c&&c.length>0&&s(c[0])}catch(c){console.error("[useSingleProductEffectivePrice] Error:",c)}finally{i(!1)}}d()},[e,t]);const o=r?r.effective_price<r.original_price:!1,l=o&&r?Math.round((r.original_price-r.effective_price)/r.original_price*100):0;return{data:r,isLoading:a,effectivePrice:(r==null?void 0:r.effective_price)??0,originalPrice:(r==null?void 0:r.original_price)??0,hasDiscount:o,discountPercent:l,promotionName:(r==null?void 0:r.promotion_name)??null,discountSource:(r==null?void 0:r.discount_source)??null}}function cg(e){const[t,r]=P.useState(new Map),[s,a]=P.useState(!0),[i,o]=P.useState(null),l=P.useCallback(async()=>{try{a(!0);let x=le.from("product_available_stock").select("*");e&&e.length>0&&(x=x.in("product_id",e));const{data:v,error:y}=await x;if(y)throw y;const b=new Map;(v||[]).forEach(j=>{b.has(j.product_id)||b.set(j.product_id,new Map),b.get(j.product_id).set(j.size,j)}),r(b),o(null)}catch(x){console.error("Error fetching available stock:",x),o(x)}finally{a(!1)}},[e==null?void 0:e.join(",")]);P.useEffect(()=>{l();const x=le.channel("stock-changes-view").on("postgres_changes",{event:"*",schema:"public",table:"live_carts"},()=>l()).on("postgres_changes",{event:"*",schema:"public",table:"live_cart_items"},()=>l()).on("postgres_changes",{event:"*",schema:"public",table:"product_catalog"},()=>l()).on("postgres_changes",{event:"*",schema:"public",table:"orders"},()=>l()).subscribe();return()=>{le.removeChannel(x)}},[l]);const d=P.useCallback((x,v)=>{const y=t.get(x);if(!y)return 0;const b=y.get(v);return(b==null?void 0:b.available)??0},[t]),c=P.useCallback(x=>{const v=t.get(x);if(!v)return[];const y=[];v.forEach((T,O)=>{T.available>0&&y.push(O)});const b=["34","36","38","40","42","44","46"],j=["PP","P","M","G","GG"];return y.sort((T,O)=>{const R=b.indexOf(T),D=b.indexOf(O),B=j.indexOf(T),q=j.indexOf(O);return R!==-1&&D!==-1?R-D:R!==-1?-1:D!==-1?1:B!==-1&&q!==-1?B-q:B!==-1?-1:q!==-1?1:T.localeCompare(O)})},[t]),u=P.useCallback((x,v)=>d(x,v)<=0,[d]),h=P.useCallback((x,v)=>{const y=d(x,v);return y>0&&y<=2},[d]),f=P.useCallback(x=>{const v=t.get(x);if(!v)return 0;let y=0;return v.forEach(b=>{y+=b.available}),y},[t]),m=P.useCallback(x=>f(x)<=0,[f]),p=P.useCallback((x,v)=>{const y=t.get(x);if(!y)return 0;const b=y.get(v);return(b==null?void 0:b.reserved)??0},[t]),g=P.useCallback(x=>{const v=t.get(x);if(!v)return 0;let y=0;return v.forEach(b=>{y+=b.reserved}),y},[t]);return{stockData:t,isLoading:s,error:i,refresh:l,getAvailable:d,getAvailableSizes:c,isSizeOutOfStock:u,isSizeLowStock:h,getReserved:p,getTotalAvailable:f,getTotalReserved:g,isProductOutOfStock:m}}function Bhe(e){const t=P.useMemo(()=>e?[e]:[],[e]),r=cg(t);return{...r,available:s=>e?r.getAvailable(e,s):0,availableSizes:e?r.getAvailableSizes(e):[],isOutOfStock:s=>e?r.isSizeOutOfStock(e,s):!0,isLowStock:s=>e?r.isSizeLowStock(e,s):!1,totalAvailable:e?r.getTotalAvailable(e):0,isProductOutOfStock:e?r.isProductOutOfStock(e):!0}}function $he(){const[e,t]=P.useState([]),[r,s]=P.useState(!0);return P.useEffect(()=>{async function a(){try{const{data:i,error:o}=await le.rpc("get_weekly_trending_products");if(o)throw o;t(i||[])}catch(i){console.error("Error fetching trending products:",i)}finally{s(!1)}}a()},[]),{trendingProducts:e,isLoading:r}}function Fhe(e){return Object.prototype.toString.call(e)==="[object Object]"}function KO(e){return Fhe(e)||Array.isArray(e)}function zhe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function ck(e,t){const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;const a=JSON.stringify(Object.keys(e.breakpoints||{})),i=JSON.stringify(Object.keys(t.breakpoints||{}));return a!==i?!1:r.every(o=>{const l=e[o],d=t[o];return typeof l=="function"?`${l}`==`${d}`:!KO(l)||!KO(d)?l===d:ck(l,d)})}function XO(e){return e.concat().sort((t,r)=>t.name>r.name?1:-1).map(t=>t.options)}function Uhe(e,t){if(e.length!==t.length)return!1;const r=XO(e),s=XO(t);return r.every((a,i)=>{const o=s[i];return ck(a,o)})}function dk(e){return typeof e=="number"}function eC(e){return typeof e=="string"}function j_(e){return typeof e=="boolean"}function YO(e){return Object.prototype.toString.call(e)==="[object Object]"}function _s(e){return Math.abs(e)}function uk(e){return Math.sign(e)}function K0(e,t){return _s(e-t)}function Vhe(e,t){if(e===0||t===0||_s(e)<=_s(t))return 0;const r=K0(_s(e),_s(t));return _s(r/e)}function qhe(e){return Math.round(e*100)/100}function zx(e){return Ux(e).map(Number)}function wl(e){return e[a1(e)]}function a1(e){return Math.max(0,e.length-1)}function hk(e,t){return t===a1(e)}function ZO(e,t=0){return Array.from(Array(e),(r,s)=>t+s)}function Ux(e){return Object.keys(e)}function nV(e,t){return[e,t].reduce((r,s)=>(Ux(s).forEach(a=>{const i=r[a],o=s[a],l=YO(i)&&YO(o);r[a]=l?nV(i,o):o}),r),{})}function tC(e,t){return typeof t.MouseEvent<"u"&&e instanceof t.MouseEvent}function Whe(e,t){const r={start:s,center:a,end:i};function s(){return 0}function a(d){return i(d)/2}function i(d){return t-d}function o(d,c){return eC(e)?r[e](d):e(t,d,c)}return{measure:o}}function Vx(){let e=[];function t(a,i,o,l={passive:!0}){let d;if("addEventListener"in a)a.addEventListener(i,o,l),d=()=>a.removeEventListener(i,o,l);else{const c=a;c.addListener(o),d=()=>c.removeListener(o)}return e.push(d),s}function r(){e=e.filter(a=>a())}const s={add:t,clear:r};return s}function Hhe(e,t,r,s){const a=Vx(),i=1e3/60;let o=null,l=0,d=0;function c(){a.add(e,"visibilitychange",()=>{e.hidden&&p()})}function u(){m(),a.clear()}function h(x){if(!d)return;o||(o=x,r(),r());const v=x-o;for(o=x,l+=v;l>=i;)r(),l-=i;const y=l/i;s(y),d&&(d=t.requestAnimationFrame(h))}function f(){d||(d=t.requestAnimationFrame(h))}function m(){t.cancelAnimationFrame(d),o=null,l=0,d=0}function p(){o=null,l=0}return{init:c,destroy:u,start:f,stop:m,update:r,render:s}}function Ghe(e,t){const r=t==="rtl",s=e==="y",a=s?"y":"x",i=s?"x":"y",o=!s&&r?-1:1,l=u(),d=h();function c(p){const{height:g,width:x}=p;return s?g:x}function u(){return s?"top":r?"right":"left"}function h(){return s?"bottom":r?"left":"right"}function f(p){return p*o}return{scroll:a,cross:i,startEdge:l,endEdge:d,measureSize:c,direction:f}}function Jh(e=0,t=0){const r=_s(e-t);function s(c){return c<e}function a(c){return c>t}function i(c){return s(c)||a(c)}function o(c){return i(c)?s(c)?e:t:c}function l(c){return r?c-r*Math.ceil((c-t)/r):c}return{length:r,max:t,min:e,constrain:o,reachedAny:i,reachedMax:a,reachedMin:s,removeOffset:l}}function sV(e,t,r){const{constrain:s}=Jh(0,e),a=e+1;let i=o(t);function o(f){return r?_s((a+f)%a):s(f)}function l(){return i}function d(f){return i=o(f),h}function c(f){return u().set(l()+f)}function u(){return sV(e,l(),r)}const h={get:l,set:d,add:c,clone:u};return h}function Khe(e,t,r,s,a,i,o,l,d,c,u,h,f,m,p,g,x,v,y){const{cross:b,direction:j}=e,T=["INPUT","SELECT","TEXTAREA"],O={passive:!1},R=Vx(),D=Vx(),B=Jh(50,225).constrain(m.measure(20)),q={mouse:300,touch:400},Y={mouse:500,touch:600},G=p?43:25;let I=!1,F=0,S=0,E=!1,N=!1,C=!1,k=!1;function M(oe){if(!y)return;function se(pe){(j_(y)||y(oe,pe))&&W(pe)}const ue=t;R.add(ue,"dragstart",pe=>pe.preventDefault(),O).add(ue,"touchmove",()=>{},O).add(ue,"touchend",()=>{}).add(ue,"touchstart",se).add(ue,"mousedown",se).add(ue,"touchcancel",V).add(ue,"contextmenu",V).add(ue,"click",H,!0)}function U(){R.clear(),D.clear()}function $(){const oe=k?r:t;D.add(oe,"touchmove",J,O).add(oe,"touchend",V).add(oe,"mousemove",J,O).add(oe,"mouseup",V)}function X(oe){const se=oe.nodeName||"";return T.includes(se)}function Z(){return(p?Y:q)[k?"mouse":"touch"]}function re(oe,se){const ue=h.add(uk(oe)*-1),pe=u.byDistance(oe,!p).distance;return p||_s(oe)<B?pe:x&&se?pe*.5:u.byIndex(ue.get(),0).distance}function W(oe){const se=tC(oe,s);k=se,C=p&&se&&!oe.buttons&&I,I=K0(a.get(),o.get())>=2,!(se&&oe.button!==0)&&(X(oe.target)||(E=!0,i.pointerDown(oe),c.useFriction(0).useDuration(0),a.set(o),$(),F=i.readPoint(oe),S=i.readPoint(oe,b),f.emit("pointerDown")))}function J(oe){if(!tC(oe,s)&&oe.touches.length>=2)return V(oe);const ue=i.readPoint(oe),pe=i.readPoint(oe,b),ce=K0(ue,F),ne=K0(pe,S);if(!N&&!k&&(!oe.cancelable||(N=ce>ne,!N)))return V(oe);const me=i.pointerMove(oe);ce>g&&(C=!0),c.useFriction(.3).useDuration(.75),l.start(),a.add(j(me)),oe.preventDefault()}function V(oe){const ue=u.byDistance(0,!1).index!==h.get(),pe=i.pointerUp(oe)*Z(),ce=re(j(pe),ue),ne=Vhe(pe,ce),me=G-10*ne,ge=v+ne/50;N=!1,E=!1,D.clear(),c.useDuration(me).useFriction(ge),d.distance(ce,!p),k=!1,f.emit("pointerUp")}function H(oe){C&&(oe.stopPropagation(),oe.preventDefault(),C=!1)}function ee(){return E}return{init:M,destroy:U,pointerDown:ee}}function Xhe(e,t){let s,a;function i(h){return h.timeStamp}function o(h,f){const p=`client${(f||e.scroll)==="x"?"X":"Y"}`;return(tC(h,t)?h:h.touches[0])[p]}function l(h){return s=h,a=h,o(h)}function d(h){const f=o(h)-o(a),m=i(h)-i(s)>170;return a=h,m&&(s=h),f}function c(h){if(!s||!a)return 0;const f=o(a)-o(s),m=i(h)-i(s),p=i(h)-i(a)>170,g=f/m;return m&&!p&&_s(g)>.1?g:0}return{pointerDown:l,pointerMove:d,pointerUp:c,readPoint:o}}function Yhe(){function e(r){const{offsetTop:s,offsetLeft:a,offsetWidth:i,offsetHeight:o}=r;return{top:s,right:a+i,bottom:s+o,left:a,width:i,height:o}}return{measure:e}}function Zhe(e){function t(s){return e*(s/100)}return{measure:t}}function Qhe(e,t,r,s,a,i,o){const l=[e].concat(s);let d,c,u=[],h=!1;function f(x){return a.measureSize(o.measure(x))}function m(x){if(!i)return;c=f(e),u=s.map(f);function v(y){for(const b of y){if(h)return;const j=b.target===e,T=s.indexOf(b.target),O=j?c:u[T],R=f(j?e:s[T]);if(_s(R-O)>=.5){x.reInit(),t.emit("resize");break}}}d=new ResizeObserver(y=>{(j_(i)||i(x,y))&&v(y)}),r.requestAnimationFrame(()=>{l.forEach(y=>d.observe(y))})}function p(){h=!0,d&&d.disconnect()}return{init:m,destroy:p}}function Jhe(e,t,r,s,a,i){let o=0,l=0,d=a,c=i,u=e.get(),h=0;function f(){const O=s.get()-e.get(),R=!d;let D=0;return R?(o=0,r.set(s),e.set(s),D=O):(r.set(e),o+=O/d,o*=c,u+=o,e.add(o),D=u-h),l=uk(D),h=u,T}function m(){const O=s.get()-t.get();return _s(O)<.001}function p(){return d}function g(){return l}function x(){return o}function v(){return b(a)}function y(){return j(i)}function b(O){return d=O,T}function j(O){return c=O,T}const T={direction:g,duration:p,velocity:x,seek:f,settled:m,useBaseFriction:y,useBaseDuration:v,useFriction:j,useDuration:b};return T}function efe(e,t,r,s,a){const i=a.measure(10),o=a.measure(50),l=Jh(.1,.99);let d=!1;function c(){return!(d||!e.reachedAny(r.get())||!e.reachedAny(t.get()))}function u(m){if(!c())return;const p=e.reachedMin(t.get())?"min":"max",g=_s(e[p]-t.get()),x=r.get()-t.get(),v=l.constrain(g/o);r.subtract(x*v),!m&&_s(x)<i&&(r.set(e.constrain(r.get())),s.useDuration(25).useBaseFriction())}function h(m){d=!m}return{shouldConstrain:c,constrain:u,toggleActive:h}}function tfe(e,t,r,s,a){const i=Jh(-t+e,0),o=h(),l=u(),d=f();function c(p,g){return K0(p,g)<=1}function u(){const p=o[0],g=wl(o),x=o.lastIndexOf(p),v=o.indexOf(g)+1;return Jh(x,v)}function h(){return r.map((p,g)=>{const{min:x,max:v}=i,y=i.constrain(p),b=!g,j=hk(r,g);return b?v:j||c(x,y)?x:c(v,y)?v:y}).map(p=>parseFloat(p.toFixed(3)))}function f(){if(t<=e+a)return[i.max];if(s==="keepSnaps")return o;const{min:p,max:g}=l;return o.slice(p,g)}return{snapsContained:d,scrollContainLimit:l}}function rfe(e,t,r){const s=t[0],a=r?s-e:wl(t);return{limit:Jh(a,s)}}function nfe(e,t,r,s){const i=t.min+.1,o=t.max+.1,{reachedMin:l,reachedMax:d}=Jh(i,o);function c(f){return f===1?d(r.get()):f===-1?l(r.get()):!1}function u(f){if(!c(f))return;const m=e*(f*-1);s.forEach(p=>p.add(m))}return{loop:u}}function sfe(e){const{max:t,length:r}=e;function s(i){const o=i-t;return r?o/-r:0}return{get:s}}function afe(e,t,r,s,a){const{startEdge:i,endEdge:o}=e,{groupSlides:l}=a,d=h().map(t.measure),c=f(),u=m();function h(){return l(s).map(g=>wl(g)[o]-g[0][i]).map(_s)}function f(){return s.map(g=>r[i]-g[i]).map(g=>-_s(g))}function m(){return l(c).map(g=>g[0]).map((g,x)=>g+d[x])}return{snaps:c,snapsAligned:u}}function ife(e,t,r,s,a,i){const{groupSlides:o}=a,{min:l,max:d}=s,c=u();function u(){const f=o(i),m=!e||t==="keepSnaps";return r.length===1?[i]:m?f:f.slice(l,d).map((p,g,x)=>{const v=!g,y=hk(x,g);if(v){const b=wl(x[0])+1;return ZO(b)}if(y){const b=a1(i)-wl(x)[0]+1;return ZO(b,wl(x)[0])}return p})}return{slideRegistry:c}}function ofe(e,t,r,s,a){const{reachedAny:i,removeOffset:o,constrain:l}=s;function d(p){return p.concat().sort((g,x)=>_s(g)-_s(x))[0]}function c(p){const g=e?o(p):l(p),x=t.map((y,b)=>({diff:u(y-g,0),index:b})).sort((y,b)=>_s(y.diff)-_s(b.diff)),{index:v}=x[0];return{index:v,distance:g}}function u(p,g){const x=[p,p+r,p-r];if(!e)return p;if(!g)return d(x);const v=x.filter(y=>uk(y)===g);return v.length?d(v):wl(x)-r}function h(p,g){const x=t[p]-a.get(),v=u(x,g);return{index:p,distance:v}}function f(p,g){const x=a.get()+p,{index:v,distance:y}=c(x),b=!e&&i(x);if(!g||b)return{index:v,distance:p};const j=t[v]-y,T=p+u(j,0);return{index:v,distance:T}}return{byDistance:f,byIndex:h,shortcut:u}}function lfe(e,t,r,s,a,i,o){function l(h){const f=h.distance,m=h.index!==t.get();i.add(f),f&&(s.duration()?e.start():(e.update(),e.render(1),e.update())),m&&(r.set(t.get()),t.set(h.index),o.emit("select"))}function d(h,f){const m=a.byDistance(h,f);l(m)}function c(h,f){const m=t.clone().set(h),p=a.byIndex(m.get(),f);l(p)}return{distance:d,index:c}}function cfe(e,t,r,s,a,i,o,l){const d={passive:!0,capture:!0};let c=0;function u(m){if(!l)return;function p(g){if(new Date().getTime()-c>10)return;o.emit("slideFocusStart"),e.scrollLeft=0;const y=r.findIndex(b=>b.includes(g));dk(y)&&(a.useDuration(0),s.index(y,0),o.emit("slideFocus"))}i.add(document,"keydown",h,!1),t.forEach((g,x)=>{i.add(g,"focus",v=>{(j_(l)||l(m,v))&&p(x)},d)})}function h(m){m.code==="Tab"&&(c=new Date().getTime())}return{init:u}}function E0(e){let t=e;function r(){return t}function s(d){t=o(d)}function a(d){t+=o(d)}function i(d){t-=o(d)}function o(d){return dk(d)?d:d.get()}return{get:r,set:s,add:a,subtract:i}}function aV(e,t){const r=e.scroll==="x"?o:l,s=t.style;let a=null,i=!1;function o(f){return`translate3d(${f}px,0px,0px)`}function l(f){return`translate3d(0px,${f}px,0px)`}function d(f){if(i)return;const m=qhe(e.direction(f));m!==a&&(s.transform=r(m),a=m)}function c(f){i=!f}function u(){i||(s.transform="",t.getAttribute("style")||t.removeAttribute("style"))}return{clear:u,to:d,toggleActive:c}}function dfe(e,t,r,s,a,i,o,l,d){const u=zx(a),h=zx(a).reverse(),f=v().concat(y());function m(R,D){return R.reduce((B,q)=>B-a[q],D)}function p(R,D){return R.reduce((B,q)=>m(B,D)>0?B.concat([q]):B,[])}function g(R){return i.map((D,B)=>({start:D-s[B]+.5+R,end:D+t-.5+R}))}function x(R,D,B){const q=g(D);return R.map(Y=>{const G=B?0:-r,I=B?r:0,F=B?"end":"start",S=q[Y][F];return{index:Y,loopPoint:S,slideLocation:E0(-1),translate:aV(e,d[Y]),target:()=>l.get()>S?G:I}})}function v(){const R=o[0],D=p(h,R);return x(D,r,!1)}function y(){const R=t-o[0]-1,D=p(u,R);return x(D,-r,!0)}function b(){return f.every(({index:R})=>{const D=u.filter(B=>B!==R);return m(D,t)<=.1})}function j(){f.forEach(R=>{const{target:D,translate:B,slideLocation:q}=R,Y=D();Y!==q.get()&&(B.to(Y),q.set(Y))})}function T(){f.forEach(R=>R.translate.clear())}return{canLoop:b,clear:T,loop:j,loopPoints:f}}function ufe(e,t,r){let s,a=!1;function i(d){if(!r)return;function c(u){for(const h of u)if(h.type==="childList"){d.reInit(),t.emit("slidesChanged");break}}s=new MutationObserver(u=>{a||(j_(r)||r(d,u))&&c(u)}),s.observe(e,{childList:!0})}function o(){s&&s.disconnect(),a=!0}return{init:i,destroy:o}}function hfe(e,t,r,s){const a={};let i=null,o=null,l,d=!1;function c(){l=new IntersectionObserver(p=>{d||(p.forEach(g=>{const x=t.indexOf(g.target);a[x]=g}),i=null,o=null,r.emit("slidesInView"))},{root:e.parentElement,threshold:s}),t.forEach(p=>l.observe(p))}function u(){l&&l.disconnect(),d=!0}function h(p){return Ux(a).reduce((g,x)=>{const v=parseInt(x),{isIntersecting:y}=a[v];return(p&&y||!p&&!y)&&g.push(v),g},[])}function f(p=!0){if(p&&i)return i;if(!p&&o)return o;const g=h(p);return p&&(i=g),p||(o=g),g}return{init:c,destroy:u,get:f}}function ffe(e,t,r,s,a,i){const{measureSize:o,startEdge:l,endEdge:d}=e,c=r[0]&&a,u=p(),h=g(),f=r.map(o),m=x();function p(){if(!c)return 0;const y=r[0];return _s(t[l]-y[l])}function g(){if(!c)return 0;const y=i.getComputedStyle(wl(s));return parseFloat(y.getPropertyValue(`margin-${d}`))}function x(){return r.map((y,b,j)=>{const T=!b,O=hk(j,b);return T?f[b]+u:O?f[b]+h:j[b+1][l]-y[l]}).map(_s)}return{slideSizes:f,slideSizesWithGaps:m,startGap:u,endGap:h}}function mfe(e,t,r,s,a,i,o,l,d){const{startEdge:c,endEdge:u,direction:h}=e,f=dk(r);function m(v,y){return zx(v).filter(b=>b%y===0).map(b=>v.slice(b,b+y))}function p(v){return v.length?zx(v).reduce((y,b,j)=>{const T=wl(y)||0,O=T===0,R=b===a1(v),D=a[c]-i[T][c],B=a[c]-i[b][u],q=!s&&O?h(o):0,Y=!s&&R?h(l):0,G=_s(B-Y-(D+q));return j&&G>t+d&&y.push(b),R&&y.push(v.length),y},[]).map((y,b,j)=>{const T=Math.max(j[b-1]||0);return v.slice(T,y)}):[]}function g(v){return f?m(v,r):p(v)}return{groupSlides:g}}function pfe(e,t,r,s,a,i,o){const{align:l,axis:d,direction:c,startIndex:u,loop:h,duration:f,dragFree:m,dragThreshold:p,inViewThreshold:g,slidesToScroll:x,skipSnaps:v,containScroll:y,watchResize:b,watchSlides:j,watchDrag:T,watchFocus:O}=i,R=2,D=Yhe(),B=D.measure(t),q=r.map(D.measure),Y=Ghe(d,c),G=Y.measureSize(B),I=Zhe(G),F=Whe(l,G),S=!h&&!!y,E=h||!!y,{slideSizes:N,slideSizesWithGaps:C,startGap:k,endGap:M}=ffe(Y,B,q,r,E,a),U=mfe(Y,G,x,h,B,q,k,M,R),{snaps:$,snapsAligned:X}=afe(Y,F,B,q,U),Z=-wl($)+wl(C),{snapsContained:re,scrollContainLimit:W}=tfe(G,Z,X,y,R),J=S?re:X,{limit:V}=rfe(Z,J,h),H=sV(a1(J),u,h),ee=H.clone(),ie=zx(r),oe=({dragHandler:st,scrollBody:nt,scrollBounds:vt,options:{loop:Je}})=>{Je||vt.constrain(st.pointerDown()),nt.seek()},se=({scrollBody:st,translate:nt,location:vt,offsetLocation:Je,previousLocation:Ue,scrollLooper:Le,slideLooper:Ze,dragHandler:ct,animation:ht,eventHandler:yt,scrollBounds:Re,options:{loop:Ke}},_t)=>{const Rt=st.settled(),Se=!Re.shouldConstrain(),tt=Ke?Rt:Rt&&Se,ot=tt&&!ct.pointerDown();ot&&ht.stop();const lt=vt.get()*_t+Ue.get()*(1-_t);Je.set(lt),Ke&&(Le.loop(st.direction()),Ze.loop()),nt.to(Je.get()),ot&&yt.emit("settle"),tt||yt.emit("scroll")},ue=Hhe(s,a,()=>oe(Ae),st=>se(Ae,st)),pe=.68,ce=J[H.get()],ne=E0(ce),me=E0(ce),ge=E0(ce),_e=E0(ce),be=Jhe(ne,ge,me,_e,f,pe),ye=ofe(h,J,Z,V,_e),Oe=lfe(ue,H,ee,be,ye,_e,o),Ne=sfe(V),De=Vx(),Ge=hfe(t,r,o,g),{slideRegistry:Qe}=ife(S,y,J,W,U,ie),Ie=cfe(e,r,Qe,Oe,be,De,o,O),Ae={ownerDocument:s,ownerWindow:a,eventHandler:o,containerRect:B,slideRects:q,animation:ue,axis:Y,dragHandler:Khe(Y,e,s,a,_e,Xhe(Y,a),ne,ue,Oe,be,ye,H,o,I,m,p,v,pe,T),eventStore:De,percentOfView:I,index:H,indexPrevious:ee,limit:V,location:ne,offsetLocation:ge,previousLocation:me,options:i,resizeHandler:Qhe(t,o,a,r,Y,b,D),scrollBody:be,scrollBounds:efe(V,ge,_e,be,I),scrollLooper:nfe(Z,V,ge,[ne,ge,me,_e]),scrollProgress:Ne,scrollSnapList:J.map(Ne.get),scrollSnaps:J,scrollTarget:ye,scrollTo:Oe,slideLooper:dfe(Y,G,Z,N,C,$,J,ge,r),slideFocus:Ie,slidesHandler:ufe(t,o,j),slidesInView:Ge,slideIndexes:ie,slideRegistry:Qe,slidesToScroll:U,target:_e,translate:aV(Y,t)};return Ae}function gfe(){let e={},t;function r(c){t=c}function s(c){return e[c]||[]}function a(c){return s(c).forEach(u=>u(t,c)),d}function i(c,u){return e[c]=s(c).concat([u]),d}function o(c,u){return e[c]=s(c).filter(h=>h!==u),d}function l(){e={}}const d={init:r,emit:a,off:o,on:i,clear:l};return d}const xfe={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function vfe(e){function t(i,o){return nV(i,o||{})}function r(i){const o=i.breakpoints||{},l=Ux(o).filter(d=>e.matchMedia(d).matches).map(d=>o[d]).reduce((d,c)=>t(d,c),{});return t(i,l)}function s(i){return i.map(o=>Ux(o.breakpoints||{})).reduce((o,l)=>o.concat(l),[]).map(e.matchMedia)}return{mergeOptions:t,optionsAtMedia:r,optionsMediaQueries:s}}function yfe(e){let t=[];function r(i,o){return t=o.filter(({options:l})=>e.optionsAtMedia(l).active!==!1),t.forEach(l=>l.init(i,e)),o.reduce((l,d)=>Object.assign(l,{[d.name]:d}),{})}function s(){t=t.filter(i=>i.destroy())}return{init:r,destroy:s}}function ow(e,t,r){const s=e.ownerDocument,a=s.defaultView,i=vfe(a),o=yfe(i),l=Vx(),d=gfe(),{mergeOptions:c,optionsAtMedia:u,optionsMediaQueries:h}=i,{on:f,off:m,emit:p}=d,g=Y;let x=!1,v,y=c(xfe,ow.globalOptions),b=c(y),j=[],T,O,R;function D(){const{container:ie,slides:oe}=b;O=(eC(ie)?e.querySelector(ie):ie)||e.children[0];const ue=eC(oe)?O.querySelectorAll(oe):oe;R=[].slice.call(ue||O.children)}function B(ie){const oe=pfe(e,O,R,s,a,ie,d);if(ie.loop&&!oe.slideLooper.canLoop()){const se=Object.assign({},ie,{loop:!1});return B(se)}return oe}function q(ie,oe){x||(y=c(y,ie),b=u(y),j=oe||j,D(),v=B(b),h([y,...j.map(({options:se})=>se)]).forEach(se=>l.add(se,"change",Y)),b.active&&(v.translate.to(v.location.get()),v.animation.init(),v.slidesInView.init(),v.slideFocus.init(ee),v.eventHandler.init(ee),v.resizeHandler.init(ee),v.slidesHandler.init(ee),v.options.loop&&v.slideLooper.loop(),O.offsetParent&&R.length&&v.dragHandler.init(ee),T=o.init(ee,j)))}function Y(ie,oe){const se=U();G(),q(c({startIndex:se},ie),oe),d.emit("reInit")}function G(){v.dragHandler.destroy(),v.eventStore.clear(),v.translate.clear(),v.slideLooper.clear(),v.resizeHandler.destroy(),v.slidesHandler.destroy(),v.slidesInView.destroy(),v.animation.destroy(),o.destroy(),l.clear()}function I(){x||(x=!0,l.clear(),G(),d.emit("destroy"),d.clear())}function F(ie,oe,se){!b.active||x||(v.scrollBody.useBaseFriction().useDuration(oe===!0?0:b.duration),v.scrollTo.index(ie,se||0))}function S(ie){const oe=v.index.add(1).get();F(oe,ie,-1)}function E(ie){const oe=v.index.add(-1).get();F(oe,ie,1)}function N(){return v.index.add(1).get()!==U()}function C(){return v.index.add(-1).get()!==U()}function k(){return v.scrollSnapList}function M(){return v.scrollProgress.get(v.offsetLocation.get())}function U(){return v.index.get()}function $(){return v.indexPrevious.get()}function X(){return v.slidesInView.get()}function Z(){return v.slidesInView.get(!1)}function re(){return T}function W(){return v}function J(){return e}function V(){return O}function H(){return R}const ee={canScrollNext:N,canScrollPrev:C,containerNode:V,internalEngine:W,destroy:I,off:m,on:f,emit:p,plugins:re,previousScrollSnap:$,reInit:g,rootNode:J,scrollNext:S,scrollPrev:E,scrollProgress:M,scrollSnapList:k,scrollTo:F,selectedScrollSnap:U,slideNodes:H,slidesInView:X,slidesNotInView:Z};return q(t,r),setTimeout(()=>d.emit("init"),0),ee}ow.globalOptions=void 0;function fk(e={},t=[]){const r=P.useRef(e),s=P.useRef(t),[a,i]=P.useState(),[o,l]=P.useState(),d=P.useCallback(()=>{a&&a.reInit(r.current,s.current)},[a]);return P.useEffect(()=>{ck(r.current,e)||(r.current=e,d())},[e,d]),P.useEffect(()=>{Uhe(s.current,t)||(s.current=t,d())},[t,d]),P.useEffect(()=>{if(zhe()&&o){ow.globalOptions=fk.globalOptions;const c=ow(o,r.current,s.current);return i(c),()=>c.destroy()}else i(void 0)},[o,i]),[l,a]}fk.globalOptions=void 0;const iV=P.createContext(null);function N_(){const e=P.useContext(iV);if(!e)throw new Error("useCarousel must be used within a <Carousel />");return e}const oV=P.forwardRef(({orientation:e="horizontal",opts:t,setApi:r,plugins:s,className:a,children:i,...o},l)=>{const[d,c]=fk({...t,axis:e==="horizontal"?"x":"y"},s),[u,h]=P.useState(!1),[f,m]=P.useState(!1),p=P.useCallback(y=>{y&&(h(y.canScrollPrev()),m(y.canScrollNext()))},[]),g=P.useCallback(()=>{c==null||c.scrollPrev()},[c]),x=P.useCallback(()=>{c==null||c.scrollNext()},[c]),v=P.useCallback(y=>{y.key==="ArrowLeft"?(y.preventDefault(),g()):y.key==="ArrowRight"&&(y.preventDefault(),x())},[g,x]);return P.useEffect(()=>{!c||!r||r(c)},[c,r]),P.useEffect(()=>{if(c)return p(c),c.on("reInit",p),c.on("select",p),()=>{c==null||c.off("select",p)}},[c,p]),n.jsx(iV.Provider,{value:{carouselRef:d,api:c,opts:t,orientation:e||((t==null?void 0:t.axis)==="y"?"vertical":"horizontal"),scrollPrev:g,scrollNext:x,canScrollPrev:u,canScrollNext:f},children:n.jsx("div",{ref:l,onKeyDownCapture:v,className:He("relative",a),role:"region","aria-roledescription":"carousel",...o,children:i})})});oV.displayName="Carousel";const lV=P.forwardRef(({className:e,...t},r)=>{const{carouselRef:s,orientation:a}=N_();return n.jsx("div",{ref:s,className:"overflow-hidden",children:n.jsx("div",{ref:r,className:He("flex",a==="horizontal"?"-ml-4":"-mt-4 flex-col",e),...t})})});lV.displayName="CarouselContent";const cV=P.forwardRef(({className:e,...t},r)=>{const{orientation:s}=N_();return n.jsx("div",{ref:r,role:"group","aria-roledescription":"slide",className:He("min-w-0 shrink-0 grow-0 basis-full",s==="horizontal"?"pl-4":"pt-4",e),...t})});cV.displayName="CarouselItem";const dV=P.forwardRef(({className:e,variant:t="outline",size:r="icon",...s},a)=>{const{orientation:i,scrollPrev:o,canScrollPrev:l}=N_();return n.jsxs(he,{ref:a,variant:t,size:r,className:He("absolute h-8 w-8 rounded-full",i==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",e),disabled:!l,onClick:o,...s,children:[n.jsx(Ts,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Previous slide"})]})});dV.displayName="CarouselPrevious";const uV=P.forwardRef(({className:e,variant:t="outline",size:r="icon",...s},a)=>{const{orientation:i,scrollNext:o,canScrollNext:l}=N_();return n.jsxs(he,{ref:a,variant:t,size:r,className:He("absolute h-8 w-8 rounded-full",i==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",e),disabled:!l,onClick:o,...s,children:[n.jsx(hs,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Next slide"})]})});uV.displayName="CarouselNext";function bfe(){const{trendingProducts:e,isLoading:t}=$he(),r=e.map(u=>u.product_id),{getEffectivePrice:s,getOriginalPrice:a,hasDiscount:i,getDiscountPercent:o}=__({channel:"catalog",productIds:r.length>0?r:void 0,enabled:r.length>0}),{getAvailableSizes:l,isProductOutOfStock:d}=cg(r.length>0?r:void 0);if(t)return n.jsx("section",{className:"py-14 px-5",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsx("div",{className:"h-8 bg-secondary animate-pulse w-48 mb-8 rounded"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[...Array(4)].map((u,h)=>n.jsx("div",{className:"aspect-[3/4] bg-secondary animate-pulse rounded-xl"},h))})]})});if(e.length===0)return n.jsx("section",{className:"py-14 px-5 border-y border-dashed border-accent/20 bg-accent/5",children:n.jsxs("div",{className:"max-w-6xl mx-auto text-center opacity-40",children:[n.jsx(Hb,{className:"h-6 w-6 mx-auto mb-2"}),n.jsx("p",{className:"text-sm",children:"O carrossel de tendncias aparecer aqui assim que houver pedidos pagos."})]})});const c=u=>{var h;return(h=u.images)!=null&&h.length?u.images[u.main_image_index||0]||u.images[0]:u.image_url||void 0};return n.jsx("section",{className:"py-14 md:py-20 px-5 overflow-hidden",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsx("div",{className:"flex flex-col md:flex-row md:items-end justify-between mb-8 gap-4",children:n.jsxs("div",{className:"text-center md:text-left",children:[n.jsx("div",{className:"flex items-center justify-center md:justify-start gap-2 mb-4",children:n.jsxs("span",{className:"bg-secondary text-primary text-[10px] font-bold px-4 py-1.5 rounded-full flex items-center gap-2 uppercase tracking-[0.2em] border border-gold/20 shadow-sm",children:[n.jsx(Hb,{className:"h-3.5 w-3.5 text-gold"}),"Escolha do Personal Stylist"]})}),n.jsxs("h2",{className:"font-serif text-4xl md:text-5xl font-medium text-primary leading-tight mb-4",children:["Coleo em ",n.jsx("span",{className:"italic",children:"Destaque"})]}),n.jsx("p",{className:"text-muted-foreground text-sm md:text-lg font-light max-w-lg",children:"Peas curadas estrategicamente para elevar seu guarda-roupa."})]})}),n.jsxs(oV,{opts:{align:"start",loop:!0},className:"w-full relative",children:[n.jsx(lV,{className:"-ml-4",children:e.map(u=>n.jsx(cV,{className:"pl-4 basis-1/2 md:basis-1/3 lg:basis-1/4",children:n.jsx(Ft,{to:`/produto/${u.product_id}`,className:"block h-full group",children:n.jsx(Qh,{name:u.name,price:a(u.product_id,u.price),effectivePrice:s(u.product_id,u.price),imageUrl:c(u),sizes:l(u.product_id),isOutOfStock:d(u.product_id),hasPromotionalDiscount:i(u.product_id),discountPercent:o(u.product_id)})})},u.product_id))}),n.jsxs("div",{className:"absolute -top-16 right-12 hidden md:flex gap-2",children:[n.jsx(dV,{className:"static translate-y-0"}),n.jsx(uV,{className:"static translate-y-0"})]})]})]})})}const et=P.forwardRef(({className:e,type:t,...r},s)=>n.jsx("input",{type:t,className:He("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...r}));et.displayName="Input";const $e=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:He("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));$e.displayName="Card";const Dt=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:He("flex flex-col space-y-1.5 p-6",e),...t}));Dt.displayName="CardHeader";const Lt=P.forwardRef(({className:e,...t},r)=>n.jsx("h3",{ref:r,className:He("text-2xl font-semibold leading-none tracking-tight",e),...t}));Lt.displayName="CardTitle";const qi=P.forwardRef(({className:e,...t},r)=>n.jsx("p",{ref:r,className:He("text-sm text-muted-foreground",e),...t}));qi.displayName="CardDescription";const Fe=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:He("p-6 pt-0",e),...t}));Fe.displayName="CardContent";const wfe=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:He("flex items-center p-6 pt-0",e),...t}));wfe.displayName="CardFooter";function qn(){const[e,t]=P.useState({user:null,session:null,isLoading:!0,rolesLoading:!0,roles:[]}),r=P.useCallback(async l=>{t(u=>({...u,rolesLoading:!0}));const{data:d,error:c}=await le.from("user_roles").select("role").eq("user_id",l);!c&&d?t(u=>({...u,roles:d.map(h=>h.role),rolesLoading:!1})):(console.error("Error fetching roles:",c),t(u=>({...u,rolesLoading:!1})))},[]);P.useEffect(()=>{const{data:{subscription:l}}=le.auth.onAuthStateChange((d,c)=>{t(u=>({...u,session:c,user:(c==null?void 0:c.user)??null,isLoading:!1})),c!=null&&c.user?setTimeout(()=>{r(c.user.id)},0):t(u=>({...u,roles:[],rolesLoading:!1}))});return le.auth.getSession().then(({data:{session:d}})=>{t(c=>({...c,session:d,user:(d==null?void 0:d.user)??null,isLoading:!1})),d!=null&&d.user?r(d.user.id):t(c=>({...c,rolesLoading:!1}))}),()=>l.unsubscribe()},[r]);const s=P.useCallback(l=>e.roles.includes(l),[e.roles]),a=P.useCallback(()=>s("merchant")||s("admin"),[s]),i=P.useCallback(()=>s("admin"),[s]);return{...e,hasRole:s,isMerchant:a,isAdmin:i,signOut:async()=>{await le.auth.signOut()}}}function _fe(){const{user:e}=qn();return{trackEvent:async(r,s={})=>{try{let a=localStorage.getItem("analytics_session_id");a||(a=crypto.randomUUID(),localStorage.setItem("analytics_session_id",a)),await le.from("analytics_events").insert({event_name:r,user_id:(e==null?void 0:e.id)||null,session_id:a,metadata:s})}catch(a){console.error("Failed to track event:",a)}}}}const jfe=["Jantar romntico","Reunio de trabalho","Casamento de dia","Look casual chic"];function Nfe(){const{user:e}=qn(),[t,r]=P.useState(""),[s,a]=P.useState(!1),[i,o]=P.useState([{id:"welcome",type:"bot",text:"Ol! Sou sua consultora de estilo Le.Po. Me conte: qual a ocasio de hoje para eu montar o look ideal para voc?"}]),l=P.useRef(null),{trackEvent:d}=_fe();P.useEffect(()=>{l.current&&(l.current.scrollTop=l.current.scrollHeight)},[i,s]);const c=i.filter(p=>p.look).flatMap(p=>p.look.products),{getEffectivePrice:u}=__({channel:"catalog",productIds:c.length>0?c:void 0,enabled:c.length>0}),h=async p=>{var x;if(!p.trim()||!e)return;const g={id:crypto.randomUUID(),type:"user",text:p};o(v=>[...v,g]),r(""),a(!0);try{const{data:v,error:y}=await le.functions.invoke("generate-ai-look",{body:{input_text:p,user_id:e==null?void 0:e.id,session_id:localStorage.getItem("analytics_session_id")||crypto.randomUUID(),history:i.slice(1).map(O=>({type:O.type,text:O.text}))}});if(y)throw y;if(!v.success)throw new Error(v.error||"Erro ao gerar look");const b=v.data;let j=[];if(b.type==="look"&&((x=b.products)==null?void 0:x.length)>0){const{data:O,error:R}=await le.from("product_catalog").select("id, name, price, image_url, images, main_image_index").in("id",b.products);if(R)throw R;j=O||[]}const T={id:crypto.randomUUID(),type:"bot",text:b.text,look:b.type==="look"?{title:b.title,description:b.text,products:b.products}:void 0,products:j};o(O=>[...O,T]),b.type==="look"&&d("ai_look_generated",{occasion:p,title:b.title,products_count:b.products.length})}catch(v){console.error("DEBUG: Error generating AI look:",v);const y=(v==null?void 0:v.message)||"Erro desconhecido";o(b=>[...b,{id:crypto.randomUUID(),type:"bot",text:`Desculpe, tive um probleminha para montar seu look: "${y}".`}])}finally{a(!1)}},f=p=>{var g;return(g=p.images)!=null&&g.length?p.images[p.main_image_index||0]||p.images[0]:p.image_url||void 0},m=p=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(p);return n.jsxs("section",{id:"consultora-ai",className:"py-16 md:py-24 px-5 bg-primary relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-gold/5 rounded-full blur-[100px] -mr-48 -mt-48"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-secondary/5 rounded-full blur-[100px] -ml-48 -mb-48"}),n.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-12",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gold/10 text-gold mb-6 border border-gold/20 shadow-lg",children:n.jsx(Gr,{className:"h-8 w-8"})}),n.jsxs("h2",{className:"font-serif text-4xl md:text-5xl font-medium mb-4 text-white italic",children:["Atelier de Estilo ",n.jsx("span",{className:"text-gold",children:"IA"})]}),n.jsx("p",{className:"text-white/60 font-light text-base md:text-lg max-w-lg mx-auto",children:"Sua consultora exclusiva 24/7. Conte qual a ocasio e ns criamos o visual perfeito."})]}),n.jsxs($e,{className:"border-none shadow-xl overflow-hidden rounded-3xl bg-white/80 backdrop-blur-sm relative",children:[!e&&n.jsxs("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center p-8 bg-primary/80 backdrop-blur-md text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-gold/10 rounded-full flex items-center justify-center mb-6",children:n.jsx(hn,{className:"h-8 w-8 text-gold"})}),n.jsx("h3",{className:"text-2xl font-serif font-medium mb-4 text-white italic",children:"Acesso Exclusivo Le.Po"}),n.jsx("p",{className:"text-white/60 max-w-sm mb-10 leading-relaxed font-light",children:"Inicie sua jornada de estilo personalizada agora. Faa login para acessar nossa curadoria guiada por IA."}),n.jsx("div",{className:"flex flex-col sm:flex-row gap-4 w-full max-w-xs",children:n.jsx(Ft,{to:"/auth",className:"flex-1",children:n.jsx(he,{className:"btn-gold w-full rounded-full h-14",children:"ENTRAR NO MEU ATELIER"})})}),n.jsx("p",{className:"mt-6 text-[11px] uppercase tracking-widest text-muted-foreground/60",children:"Acesso gratuito e instantneo"})]}),n.jsxs(Fe,{className:He("p-0 flex flex-col h-[600px] transition-all duration-500",!e&&"blur-[2px] pointer-events-none select-none"),children:[n.jsxs("div",{ref:l,className:"flex-1 overflow-y-auto p-6 space-y-6 scroll-smooth",children:[i.map(p=>n.jsx("div",{className:He("flex w-full mb-4 animate-fade-in",p.type==="user"?"justify-end":"justify-start"),children:n.jsxs("div",{className:He("flex gap-3 max-w-[85%] md:max-w-[70%]",p.type==="user"?"flex-row-reverse":"flex-row"),children:[n.jsx("div",{className:He("w-9 h-9 rounded-full flex items-center justify-center flex-shrink-0 mt-1 shadow-md",p.type==="user"?"bg-gold text-white":"bg-primary border border-gold/20"),children:p.type==="user"?n.jsx(Dn,{className:"h-4 w-4"}):n.jsx(MP,{className:"h-4 w-4 text-gold"})}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:He("rounded-2xl px-6 py-4 text-sm leading-relaxed shadow-sm",p.type==="user"?"bg-gold text-white rounded-tr-none font-medium":"bg-white border border-border/50 text-gray-800 rounded-tl-none"),children:p.text}),p.look&&p.products&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-accent px-1",children:p.look.title}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:p.products.map(g=>n.jsxs(Ft,{to:`/produto/${g.id}?from=ai_look`,className:"bg-white rounded-xl border border-border/40 overflow-hidden shadow-sm hover:shadow-md transition-all group",children:[n.jsx("div",{className:"aspect-[3/4] overflow-hidden bg-secondary",children:n.jsx("img",{src:f(g),alt:g.name,className:"w-full h-full object-cover transition-transform group-hover:scale-105"})}),n.jsxs("div",{className:"p-3",children:[n.jsx("p",{className:"text-[10px] font-bold tracking-widest uppercase text-muted-foreground/50 mb-1",children:g.name}),n.jsx("p",{className:"text-base font-bold text-primary",children:m(u(g.id,g.price))})]})]},g.id))})]})]})]})},p.id)),s&&n.jsx("div",{className:"flex justify-start animate-fade-in",children:n.jsxs("div",{className:"flex gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-card border border-border flex items-center justify-center",children:n.jsx(MP,{className:"h-4 w-4 text-accent"})}),n.jsx("div",{className:"bg-white border border-border/50 rounded-2xl rounded-tl-none px-5 py-3.5 shadow-sm",children:n.jsxs("div",{className:"flex gap-1.5 pt-1",children:[n.jsx("span",{className:"w-1.5 h-1.5 bg-accent/40 rounded-full animate-bounce"}),n.jsx("span",{className:"w-1.5 h-1.5 bg-accent/60 rounded-full animate-bounce [animation-delay:0.2s]"}),n.jsx("span",{className:"w-1.5 h-1.5 bg-accent/80 rounded-full animate-bounce [animation-delay:0.4s]"})]})})]})})]}),n.jsxs("div",{className:"p-5 bg-card/30 border-t border-border/40",children:[i.length===1&&!s&&n.jsx("div",{className:"flex flex-wrap gap-2 mb-4 animate-fade-in",children:jfe.map(p=>n.jsx("button",{onClick:()=>h(p),className:"text-[10px] font-bold tracking-widest uppercase border border-gold/20 bg-white/50 text-primary hover:bg-gold hover:text-white px-5 py-2.5 rounded-full transition-all backdrop-blur-sm",children:p},p))}),n.jsxs("div",{className:"relative group",children:[n.jsx(et,{placeholder:"Conte-nos o que voc precisa...",className:"h-14 pl-6 pr-24 rounded-full border border-gold/20 bg-white shadow-inner focus-visible:ring-gold focus-visible:ring-offset-0 focus-visible:border-gold transition-all text-sm",value:t,onChange:p=>r(p.target.value),onKeyDown:p=>p.key==="Enter"&&h(t),disabled:s}),n.jsx(he,{size:"icon",className:"absolute right-2 top-2 bottom-2 w-10 h-10 rounded-full bg-primary hover:bg-gold text-white transition-all duration-300 shadow-md",disabled:s||!t.trim(),onClick:()=>h(t),children:n.jsx(yf,{className:"h-4 w-4"})})]})]})]})]})]})]})}const Sfe="https://images.unsplash.com/photo-1490481651871-ab68de25d43d?w=900&q=80",Cfe=["Trabalho","Jantar","Evento","Igreja","Viagem","Dia a dia chic"],Efe=[{icon:Qr,label:"Troca fcil",desc:"Sem burocracia"},{icon:ms,label:"3x sem juros",desc:"No carto"},{icon:nn,label:"Suporte WhatsApp",desc:"Resposta rpida"},{icon:yn,label:"Envio Brasil",desc:"Todo o pas"}],kfe=()=>{const[e,t]=P.useState([]),[r,s]=P.useState(!0);P.useEffect(()=>{(async()=>{try{const{data:f}=await le.from("product_catalog").select("id, name, price, image_url, images, main_image_index, category, stock_by_size").eq("is_active",!0).order("created_at",{ascending:!1}).limit(4);t(f||[])}catch(f){console.error("Error loading products:",f)}finally{s(!1)}})()},[]);const a=P.useMemo(()=>e.map(f=>f.id),[e]),{getEffectivePrice:i,getOriginalPrice:o,hasDiscount:l,getDiscountPercent:d}=__({channel:"catalog",productIds:a.length>0?a:void 0,enabled:a.length>0}),{getAvailableSizes:c,isProductOutOfStock:u}=cg(a.length>0?a:void 0),h=f=>{var m;return(m=f.images)!=null&&m.length?f.images[f.main_image_index||0]||f.images[0]:f.image_url||void 0};return n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(Bm,{}),n.jsx(Nr,{}),n.jsxs("section",{className:"relative overflow-hidden",children:[n.jsxs("div",{className:"absolute inset-0 z-0 text-safe",children:[n.jsx("img",{src:Sfe,alt:"LE.PO Editorial",className:"w-full h-full object-cover object-top"}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-[hsl(40,33%,98%)]/95 via-[hsl(40,33%,98%)]/80 to-transparent md:from-[hsl(40,33%,98%)]/90 md:via-[hsl(40,33%,98%)]/60"})]}),n.jsx("div",{className:"relative z-10 max-w-6xl mx-auto px-5 py-16 md:py-28 lg:py-36",children:n.jsxs("div",{className:"max-w-xl animate-fade-in",children:[n.jsxs("span",{className:"inline-flex items-center gap-2 text-accent text-xs tracking-[0.2em] uppercase font-bold mb-6",children:[n.jsx(Gr,{className:"h-3.5 w-3.5"}),"Curadoria de moda feminina"]}),n.jsxs("h1",{className:"font-serif text-4xl md:text-5xl lg:text-6xl font-bold leading-[1.1] mb-5 text-foreground",children:["Nunca mais fique",n.jsx("br",{}),"sem saber",n.jsx("br",{}),n.jsx("span",{className:"text-accent italic font-black",children:"o que vestir."})]}),n.jsx("p",{className:"text-base md:text-lg text-foreground/90 leading-relaxed mb-8 max-w-md font-medium",children:"Curadoria estratgica para o trabalho, jantares e ocasies especiais. Peas escolhidas a dedo para mulheres que no tm tempo a perder."}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[n.jsx(Ft,{to:"/meu-estilo",children:n.jsx("button",{className:"w-full sm:w-auto px-10 py-4 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white",children:"Fazer meu provador VIP"})}),n.jsx(Ft,{to:"/enviar-print",children:n.jsx("button",{className:"w-full sm:w-auto px-10 py-4 border border-foreground/30 text-foreground text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:border-accent hover:text-accent font-medium",children:"Buscar look por foto"})})]})]})})]}),n.jsx("section",{className:"py-14 md:py-20 px-5",children:n.jsxs("div",{className:"max-w-5xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-10 md:mb-14",children:[n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mb-3",children:"Como podemos te ajudar?"}),n.jsx("p",{className:"text-muted-foreground text-sm md:text-base max-w-lg mx-auto font-medium",children:"Escolha como quer comear. Em poucos minutos a gente te ajuda a encontrar o look perfeito."})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-5 md:gap-6",children:[n.jsx(JN,{to:"/meu-estilo",icon:n.jsx(Gr,{className:"h-7 w-7"}),title:"Provador VIP",subtitle:"Quiz em 2 minutos",description:"Responda perguntas rpidas e receba sugestes no seu estilo e tamanho.",accent:!0}),n.jsx(JN,{to:"/enviar-print",icon:n.jsx(ka,{className:"h-7 w-7"}),title:"Buscar por Foto",subtitle:"Envie print ou inspirao",description:"Viu um look nos Stories? Mande a foto e a gente encontra peas parecidas."}),n.jsx(JN,{to:"/catalogo",icon:n.jsx(hn,{className:"h-7 w-7"}),title:"Catlogo Completo",subtitle:"Todas as peas",description:"Navegue por toda a coleo, filtre por tamanho, cor e categoria."})]})]})}),n.jsx(bfe,{}),n.jsx(Nfe,{}),n.jsx("section",{className:"py-14 md:py-20 px-5 bg-secondary/30",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsxs("div",{className:"flex items-end justify-between mb-8 md:mb-10",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-bold",children:"Destaques"}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mt-1",children:"Lanamentos Recentes"})]}),n.jsx(Ft,{to:"/catalogo",children:n.jsxs(he,{variant:"ghost",className:"gap-1.5 text-sm hover:text-accent font-bold",children:["Ver todos",n.jsx(hs,{className:"h-4 w-4"})]})})]}),r?n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6",children:[...Array(4)].map((f,m)=>n.jsxs("div",{className:"animate-pulse",children:[n.jsx("div",{className:"aspect-[3/4] bg-secondary rounded-xl mb-3"}),n.jsx("div",{className:"h-4 bg-secondary rounded w-3/4 mb-2"}),n.jsx("div",{className:"h-4 bg-secondary rounded w-1/2"})]},m))}):n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6",children:e.map(f=>n.jsx(Ft,{to:`/produto/${f.id}`,className:"group",children:n.jsx(Qh,{name:f.name,price:o(f.id,f.price),effectivePrice:i(f.id,f.price),imageUrl:h(f),sizes:c(f.id),isOutOfStock:u(f.id),hasPromotionalDiscount:l(f.id),discountPercent:d(f.id)})},f.id))})]})}),n.jsx("section",{className:"py-14 md:py-20 px-5",children:n.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-bold",children:"Para cada momento"}),n.jsxs("h2",{className:"font-serif text-2xl md:text-3xl mt-2 mb-3",children:["Qual ocasio voc precisa",n.jsx("br",{className:"hidden sm:block"})," se vestir hoje?"]}),n.jsx("p",{className:"text-muted-foreground text-sm mb-10 max-w-md mx-auto font-medium",children:"Conte pra gente e a nossa curadoria encontra opes perfeitas para voc."}),n.jsx("div",{className:"flex flex-wrap justify-center gap-x-8 gap-y-5",children:Cfe.map(f=>n.jsxs(Ft,{to:`/catalogo?occasion=${encodeURIComponent(f)}`,className:"group relative",children:[n.jsx("span",{className:"font-serif text-lg md:text-xl text-foreground transition-colors duration-300 group-hover:text-accent font-medium",children:f}),n.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-px bg-accent transition-all duration-500 group-hover:w-full"})]},f))})]})}),n.jsx("section",{className:"py-14 md:py-20 px-5 bg-[hsl(35,30%,94%)]/60",children:n.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-bold",children:"Por que escolher a LE.PO"}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mt-2 mb-3",children:"Mais de 8 anos vestindo mulheres reais."}),n.jsx("p",{className:"text-muted-foreground text-sm mb-10 max-w-md mx-auto font-medium",children:"No somos s uma loja. Somos sua parceira de estilo para cada momento da sua vida."}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-8",children:Efe.map(f=>n.jsxs("div",{className:"flex flex-col items-center gap-3 group",children:[n.jsx("div",{className:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm group-hover:shadow-md group-hover:border-accent/40 transition-all duration-300",children:n.jsx(f.icon,{className:"h-6 w-6 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold text-sm text-foreground",children:f.label}),n.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:f.desc})]})]},f.label))})]})}),n.jsx("section",{className:"py-16 md:py-24 px-5",children:n.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[n.jsx("div",{className:"w-px h-12 bg-accent/40 mx-auto mb-6"}),n.jsx("h2",{className:"font-serif text-3xl md:text-4xl mb-4 italic font-bold",children:"Pronta para se sentir incrvel?"}),n.jsx("p",{className:"text-muted-foreground mb-8 max-w-md mx-auto font-medium text-base",children:"Monte seu provador VIP em 2 minutos e receba sugestes personalizadas direto no seu WhatsApp."}),n.jsx(Ft,{to:"/meu-estilo",children:n.jsx("button",{className:"px-12 py-4 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-bold transition-all duration-500 hover:bg-accent hover:text-white",children:"Quero meu provador VIP"})}),n.jsx("p",{className:"text-[11px] text-muted-foreground mt-6 tracking-wide font-medium",children:"Gratuito  Leva menos de 2 minutos"})]})}),n.jsx("footer",{className:"border-t border-border py-10 px-5",children:n.jsxs("div",{className:"max-w-5xl mx-auto",children:[n.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[n.jsxs("div",{className:"text-center md:text-left",children:[n.jsx("p",{className:"font-serif text-xl mb-1 font-bold",children:"LE.PO"}),n.jsx("p",{className:"text-xs text-muted-foreground font-medium",children:"Curadoria de moda feminina  Anpolis, GO"})]}),n.jsxs("div",{className:"flex items-center gap-5 text-sm text-muted-foreground font-medium",children:[n.jsx(Ft,{to:"/catalogo",className:"hover:text-foreground transition-colors",children:"Catlogo"}),n.jsx(Ft,{to:"/meu-estilo",className:"hover:text-foreground transition-colors",children:"Provador VIP"}),n.jsx(Ft,{to:"/enviar-print",className:"hover:text-foreground transition-colors",children:"Buscar por foto"}),n.jsx("a",{href:po("Ol! Gostaria de saber mais sobre a LE.PO "),target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors",children:"WhatsApp"})]})]}),n.jsxs("div",{className:"border-t border-border mt-6 pt-6 flex flex-col sm:flex-row items-center justify-between gap-2",children:[n.jsxs("p",{className:"text-xs text-muted-foreground font-medium",children:[" ",new Date().getFullYear()," LE.PO. Todos os direitos reservados."]}),n.jsx(Ft,{to:"/area-lojista",className:"text-[10px] text-muted-foreground/40 hover:text-muted-foreground transition-colors",children:"rea do Lojista"})]})]})})]})};function JN({to:e,icon:t,title:r,subtitle:s,description:a,accent:i=!1}){return n.jsx(Ft,{to:e,className:"group",children:n.jsxs("div",{className:`
          relative overflow-hidden rounded-2xl p-7 md:p-8 h-full
          border-2 transition-all duration-300
          hover:shadow-xl hover:-translate-y-1
          ${i?"border-accent/30 bg-accent/5 hover:border-accent/60":"border-border bg-card hover:border-accent/30"}
        `,children:[n.jsx("div",{className:`
            inline-flex items-center justify-center w-14 h-14 rounded-2xl mb-5
            transition-colors duration-300
            ${i?"bg-accent/15 text-accent":"bg-secondary text-foreground/70 group-hover:bg-accent/10 group-hover:text-accent"}
          `,children:t}),n.jsx("p",{className:"text-[10px] tracking-[0.2em] uppercase text-accent font-bold mb-1.5",children:s}),n.jsx("h3",{className:"font-serif text-xl mb-2 font-bold",children:r}),n.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed font-medium",children:a}),n.jsxs("div",{className:"mt-5 inline-flex items-center gap-1.5 text-sm text-accent font-bold group-hover:gap-2.5 transition-all duration-300",children:["Comear",n.jsx(hs,{className:"h-4 w-4"})]})]})})}var mk="Progress",pk=100,[Afe,XZe]=ea(mk),[Tfe,Pfe]=Afe(mk),hV=P.forwardRef((e,t)=>{const{__scopeProgress:r,value:s=null,max:a,getValueLabel:i=Ofe,...o}=e;(a||a===0)&&!QO(a)&&console.error(Rfe(`${a}`,"Progress"));const l=QO(a)?a:pk;s!==null&&!JO(s,l)&&console.error(Mfe(`${s}`,"Progress"));const d=JO(s,l)?s:null,c=lw(d)?i(d,l):void 0;return n.jsx(Tfe,{scope:r,value:d,max:l,children:n.jsx(er.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":lw(d)?d:void 0,"aria-valuetext":c,role:"progressbar","data-state":pV(d,l),"data-value":d??void 0,"data-max":l,...o,ref:t})})});hV.displayName=mk;var fV="ProgressIndicator",mV=P.forwardRef((e,t)=>{const{__scopeProgress:r,...s}=e,a=Pfe(fV,r);return n.jsx(er.div,{"data-state":pV(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...s,ref:t})});mV.displayName=fV;function Ofe(e,t){return`${Math.round(e/t*100)}%`}function pV(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function lw(e){return typeof e=="number"}function QO(e){return lw(e)&&!isNaN(e)&&e>0}function JO(e,t){return lw(e)&&!isNaN(e)&&e<=t&&e>=0}function Rfe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${pk}\`.`}function Mfe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${pk} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var gV=hV,Ife=mV;const dg=P.forwardRef(({className:e,value:t,...r},s)=>n.jsx(gV,{ref:s,className:He("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:n.jsx(Ife,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));dg.displayName=gV.displayName;const Dfe=Jp("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function ke({className:e,variant:t,...r}){return n.jsx("div",{className:He(Dfe({variant:t}),e),...r})}const oo={perQuestion:10,photoUpload:50,completionBonus:20};function Lfe(e){return e.questions.length*oo.perQuestion+oo.photoUpload+oo.completionBonus}const cw=[{id:"blazer-week",title:"O Blazer Perfeito",subtitle:"Descubra qual modelagem e styling combinam com voc",emoji:"",theme:"blazer",pointsReward:oo.completionBonus,tags:["blazer-lover","power-dressing"],photoPrompt:"Envie referncias de blazers que te atraem ou que gostaria de ter",questions:[{id:1,question:"Qual modelagem de blazer combina mais com voc?",subtext:"A modelagem certa muda tudo",options:[{text:"Oversized e descontrado",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}},{text:"Ajustado e estruturado",styleBonus:{elegante:3,classica:2,minimal:0,romantica:0}},{text:"Alongado  abaixo do quadril",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Com detalhes femininos como lao ou pregas",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}}]},{id:2,question:"Para qual momento voc mais usaria blazer?",subtext:"Vou sugerir o blazer certo para essa ocasio",options:[{text:"Reunies importantes e apresentaes",styleBonus:{elegante:3,classica:2,minimal:1,romantica:0}},{text:"Happy hour e eventos casuais",styleBonus:{elegante:2,classica:1,minimal:0,romantica:2}},{text:"Dia a dia no escritrio",styleBonus:{elegante:1,classica:3,minimal:2,romantica:0}},{text:"Fim de semana com estilo",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}}]},{id:3,question:"Qual cor de blazer te atrai mais?",subtext:"A cor define todo o impacto da pea",options:[{text:"Preto clssico  sempre seguro",styleBonus:{elegante:3,classica:2,minimal:2,romantica:0}},{text:"Bege ou caramelo  neutro e sofisticado",styleBonus:{elegante:1,classica:3,minimal:2,romantica:1}},{text:"Cores vibrantes  vermelho, azul, verde",styleBonus:{elegante:1,classica:0,minimal:0,romantica:2}},{text:"Branco ou off-white  leveza e modernidade",styleBonus:{elegante:2,classica:1,minimal:3,romantica:1}}]},{id:4,question:"Com o que voc combinaria seu blazer ideal?",subtext:"A composio completa o look",options:[{text:"Cala de alfaiataria",styleBonus:{elegante:2,classica:3,minimal:2,romantica:0}},{text:"Jeans bem cortado",styleBonus:{elegante:1,classica:2,minimal:3,romantica:0}},{text:"Vestido fluido",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}},{text:"Saia lpis",styleBonus:{elegante:3,classica:2,minimal:1,romantica:1}}]},{id:5,question:"Qual detalhe faria seu blazer especial?",subtext:"O que diferencia uma pea comum de uma pea sua",options:[{text:"Botes dourados ou detalhes metalizados",styleBonus:{elegante:3,classica:2,minimal:0,romantica:1}},{text:"Nenhum  corte limpo e minimalista",styleBonus:{elegante:1,classica:1,minimal:3,romantica:0}},{text:"Lapela diferenciada ou corte assimtrico",styleBonus:{elegante:2,classica:3,minimal:0,romantica:1}},{text:"Bordados, texturas ou aplicaes delicadas",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}}]}]},{id:"work-style",title:"Seu Visual Profissional",subtitle:"Refine seu estilo para o ambiente de trabalho",emoji:"",theme:"work",pointsReward:oo.completionBonus,tags:["work-ready","professional"],photoPrompt:"Envie referncias de looks de trabalho que voc admira",questions:[{id:1,question:"Como  o dress code do seu trabalho?",subtext:"Cada ambiente pede uma abordagem diferente",options:[{text:"Formal e sofisticado",styleBonus:{elegante:3,classica:2,minimal:0,romantica:0}},{text:"Smart casual  elegante mas relaxado",styleBonus:{elegante:1,classica:3,minimal:2,romantica:0}},{text:"Casual e flexvel",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}},{text:"Criativo e expressivo",styleBonus:{elegante:1,classica:0,minimal:1,romantica:3}}]},{id:2,question:"Qual pea no pode faltar no seu closet de trabalho?",subtext:"A base do seu guarda-roupa profissional",options:[{text:"Cala de alfaiataria bem cortada",styleBonus:{elegante:2,classica:3,minimal:2,romantica:0}},{text:"Blazer que funciona com tudo",styleBonus:{elegante:3,classica:2,minimal:1,romantica:0}},{text:"Vestido midi que resolve o look",styleBonus:{elegante:2,classica:1,minimal:0,romantica:3}},{text:"Camiseta premium  bsico elevado",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}}]},{id:3,question:"Reunio importante amanh. O que voc veste?",subtext:"A roupa certa te d confiana antes de abrir a boca",options:[{text:"Conjunto alfaiataria  impecvel",styleBonus:{elegante:3,classica:3,minimal:1,romantica:0}},{text:"Vestido midi elegante e estruturado",styleBonus:{elegante:2,classica:1,minimal:0,romantica:2}},{text:"Blazer com jeans premium",styleBonus:{elegante:1,classica:2,minimal:3,romantica:0}},{text:"Saia e blusa bem combinadas",styleBonus:{elegante:2,classica:2,minimal:1,romantica:2}}]},{id:4,question:"Qual sapato te leva do escritrio ao happy hour?",subtext:"Versatilidade sem abrir mo de estilo",options:[{text:"Scarpin clssico",styleBonus:{elegante:3,classica:2,minimal:0,romantica:1}},{text:"Mocassim ou loafer de couro",styleBonus:{elegante:1,classica:3,minimal:2,romantica:0}},{text:"Tnis elegante  conforto com estilo",styleBonus:{elegante:0,classica:1,minimal:3,romantica:0}},{text:"Sandlia com salto mdio",styleBonus:{elegante:1,classica:0,minimal:1,romantica:3}}]},{id:5,question:"Qual acessrio completa seu visual profissional?",subtext:"O detalhe que mostra quem voc  sem exagerar",options:[{text:"Relgio sofisticado",styleBonus:{elegante:3,classica:2,minimal:1,romantica:0}},{text:"Bolsa estruturada de couro",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Brincos discretos e delicados",styleBonus:{elegante:1,classica:2,minimal:2,romantica:2}},{text:"Leno de seda no pescoo",styleBonus:{elegante:1,classica:1,minimal:0,romantica:3}}]}]},{id:"weekend-vibes",title:"Seu Estilo no Fim de Semana",subtitle:"Como voc se veste quando  s para se sentir bem",emoji:"",theme:"casual",pointsReward:oo.completionBonus,tags:["weekend-ready","casual-chic"],photoPrompt:"Envie fotos de looks de fim de semana que voc ama ou gostaria de experimentar",questions:[{id:1,question:"O que voc mais valoriza num look de lazer?",subtext:"Quando no tem compromisso formal",options:[{text:"Conforto acima de tudo",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}},{text:"Quero estar bem vestida mesmo relaxando",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Feminilidade e leveza",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}},{text:"Praticidade  vestir rpido e sair",styleBonus:{elegante:1,classica:2,minimal:3,romantica:0}}]},{id:2,question:"Qual combinao  a sua cara?",subtext:"Aquela que voc monta de olhos fechados",options:[{text:"Jeans reto e camiseta premium",styleBonus:{elegante:1,classica:2,minimal:3,romantica:0}},{text:"Vestido fluido e rasteirinha de couro",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}},{text:"Cala wide e blusa elegante",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Saia midi e tnis branco",styleBonus:{elegante:0,classica:1,minimal:2,romantica:2}}]},{id:3,question:"Brunch com amigas  o que voc veste?",subtext:"Look para se divertir e se sentir bonita",options:[{text:"Vestido midi com estampa sutil",styleBonus:{elegante:1,classica:1,minimal:0,romantica:3}},{text:"Cala e blusa elegante",styleBonus:{elegante:2,classica:2,minimal:2,romantica:0}},{text:"Jeans, blazer leve e sapatilha",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Conjunto confortvel e estiloso",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}}]},{id:4,question:"Qual  a sua bolsa ideal para o fim de semana?",subtext:"Funcionalidade com personalidade",options:[{text:"Grande e espaosa  levo tudo comigo",styleBonus:{elegante:1,classica:2,minimal:2,romantica:0}},{text:"Crossbody compacta  s o essencial",styleBonus:{elegante:1,classica:1,minimal:3,romantica:1}},{text:"Bolsa de couro estruturada",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Clutch ou bolsa delicada",styleBonus:{elegante:2,classica:0,minimal:0,romantica:3}}]},{id:5,question:"Seu calado favorito para dias livres?",subtext:"O que seus ps escolhem quando so livres",options:[{text:"Tnis branco minimalista",styleBonus:{elegante:1,classica:2,minimal:3,romantica:0}},{text:"Sandlia colorida ou estampada",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}},{text:"Plataforma ou chunky sneaker",styleBonus:{elegante:2,classica:1,minimal:1,romantica:1}},{text:"Mocassim ou loafer",styleBonus:{elegante:0,classica:3,minimal:2,romantica:1}}]}]},{id:"color-discovery",title:"Sua Paleta Pessoal",subtitle:"Descubra as cores que mais te valorizam",emoji:"",theme:"colors",pointsReward:oo.completionBonus,tags:["color-confident","palette-defined"],photoPrompt:"Envie fotos de peas ou looks com cores que te atraem",questions:[{id:1,question:"Qual paleta mais te representa?",subtext:"As cores que dominam o seu closet",options:[{text:"Preto, branco e cinza  seguro e sofisticado",styleBonus:{elegante:3,classica:1,minimal:3,romantica:0}},{text:"Bege, caramelo e off-white  quente e acolhedor",styleBonus:{elegante:1,classica:3,minimal:2,romantica:1}},{text:"Rosa, lavanda e pssego  suave e feminino",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}},{text:"Azul, verde e terrosos  natural e moderno",styleBonus:{elegante:1,classica:2,minimal:2,romantica:1}}]},{id:2,question:"Qual a sua relao com estampas coloridas?",subtext:"Isso define o nvel de ousadia da sua curadoria",options:[{text:"Prefiro tons lisos  a cor fala por si",styleBonus:{elegante:2,classica:2,minimal:3,romantica:0}},{text:"Gosto de listras e geomtricos clssicos",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Adoro florais delicados",styleBonus:{elegante:0,classica:1,minimal:0,romantica:3}},{text:"Curto animal print e estampas marcantes",styleBonus:{elegante:3,classica:1,minimal:0,romantica:1}}]},{id:3,question:"Tem alguma cor que voc evita?",subtext:"Importante saber isso para a sua curadoria",options:[{text:"Cores neon e muito chamativas",styleBonus:{elegante:2,classica:3,minimal:2,romantica:1}},{text:"Tons pastis  acho que no combinam comigo",styleBonus:{elegante:2,classica:1,minimal:2,romantica:0}},{text:"Preto total  acho pesado demais",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}},{text:"Neutros demais  quero mais vida",styleBonus:{elegante:1,classica:0,minimal:0,romantica:2}}]},{id:4,question:"Qual cor voc gostaria de usar com mais confiana?",subtext:"Aquela que te atrai mas voc ainda no ousou",options:[{text:"Vermelho  poderoso e marcante",styleBonus:{elegante:3,classica:1,minimal:0,romantica:1}},{text:"Azul profundo  elegncia discreta",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Verde  sofisticao natural",styleBonus:{elegante:1,classica:2,minimal:2,romantica:1}},{text:"Rosa intenso  feminino e ousado",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}}]},{id:5,question:"Como voc monta um look colorido?",subtext:"A estratgia com cor diz muito sobre seu estilo",options:[{text:"Uma pea statement e o restante neutro",styleBonus:{elegante:2,classica:3,minimal:2,romantica:0}},{text:"Total color  uma cor da cabea aos ps",styleBonus:{elegante:3,classica:1,minimal:1,romantica:1}},{text:"Mix de tons prximos  monocromtico suave",styleBonus:{elegante:1,classica:2,minimal:3,romantica:1}},{text:"Contrastes ousados  adoro misturar",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}}]}]},{id:"special-occasions",title:"Looks para Ocasies Especiais",subtitle:"O que vestir nos momentos mais importantes",emoji:"",theme:"events",pointsReward:oo.completionBonus,tags:["event-ready","celebration-style"],photoPrompt:"Envie referncias de looks de festa ou eventos que te inspiram",questions:[{id:1,question:"Jantar especial  o que voc escolheria?",subtext:"O look que te faz sentir confiante e bonita",options:[{text:"Vestido elegante e estruturado",styleBonus:{elegante:3,classica:2,minimal:0,romantica:1}},{text:"Conjunto sofisticado de alfaiataria",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Look monocromtico impactante",styleBonus:{elegante:1,classica:1,minimal:3,romantica:0}},{text:"Vestido fluido com movimento e cor",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}}]},{id:2,question:"Qual acessrio eleva seu look de evento?",subtext:"O toque final que transforma o visual",options:[{text:"Joia statement  brinco ou colar marcante",styleBonus:{elegante:3,classica:1,minimal:0,romantica:1}},{text:"Bolsa clssica de qualidade",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Peas minimalistas e discretas",styleBonus:{elegante:1,classica:1,minimal:3,romantica:0}},{text:"Detalhes delicados e femininos",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}}]},{id:3,question:"Casamento como convidada  seu estilo?",subtext:"O equilbrio entre elegncia e personalidade",options:[{text:"Vestido midi elegante e discreto",styleBonus:{elegante:3,classica:2,minimal:1,romantica:1}},{text:"Conjunto com alfaiataria impecvel",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Vestido longo e fluido",styleBonus:{elegante:1,classica:1,minimal:0,romantica:3}},{text:"Jumpsuit sofisticado e moderno",styleBonus:{elegante:2,classica:1,minimal:3,romantica:0}}]},{id:4,question:"Qual salto combina com voc em eventos?",subtext:"O sapato certo completa todo o visual",options:[{text:"Stiletto alto  impacto mximo",styleBonus:{elegante:3,classica:1,minimal:0,romantica:1}},{text:"Salto bloco  elegncia com conforto",styleBonus:{elegante:1,classica:3,minimal:2,romantica:0}},{text:"Mule com salto mdio",styleBonus:{elegante:2,classica:2,minimal:3,romantica:0}},{text:"Sandlia delicada com tiras finas",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}}]},{id:5,question:"Como voc prefere sua maquiagem em eventos?",subtext:"O make complementa a histria do look",options:[{text:"Batom marcante  vermelho ou vinho",styleBonus:{elegante:3,classica:2,minimal:0,romantica:0}},{text:"Olho marcado e boca nude",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Natural, luminoso e clean",styleBonus:{elegante:1,classica:1,minimal:3,romantica:1}},{text:"Tons rosados e pele iluminada",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}}]}]}];function qx(e){return cw.filter(t=>!e.includes(t.id))}function dw(e){return cw.find(t=>t.id===e)}const es={poa:{id:"poa",name:"Po",minPoints:0,maxPoints:999,multiplier:1,color:"bg-stone-500",benefits:["Acumule 1 ponto a cada R$ 1 gasto","Acesso antecipado a promoes","Presente de aniversrio"]},poa_gold:{id:"poa_gold",name:"Po Gold",minPoints:1e3,maxPoints:2999,multiplier:1.1,color:"#C5A572",benefits:["Todos os benefcios Po","Acumule 1.1 pontos a cada R$ 1 gasto","Frete grtis em 1 pedido por ms","Consultoria de estilo express"]},poa_platinum:{id:"poa_platinum",name:"Po Platinum",minPoints:3e3,maxPoints:5999,multiplier:1.2,color:"#E5E4E2",benefits:["Todos os benefcios Gold","Acumule 1.2 pontos a cada R$ 1 gasto","Frete grtis ilimitado","Acesso a eventos exclusivos"]},poa_black:{id:"poa_black",name:"Po Black",minPoints:6e3,maxPoints:1/0,multiplier:1.3,color:"#000000",benefits:["Todos os benefcios Platinum","Acumule 1.3 pontos a cada R$ 1 gasto","Concierge pessoal","Presentes exclusivos da marca"]}},e3=["poa","poa_gold","poa_platinum","poa_black"];function Bfe(e){return e>=es.poa_black.minPoints?es.poa_black:e>=es.poa_platinum.minPoints?es.poa_platinum:e>=es.poa_gold.minPoints?es.poa_gold:es.poa}const eR=[{points:500,value:25},{points:1e3,value:60},{points:2e3,value:150}],$fe=.2,t3=200,Ffe={basic_profile:{name:"Perfil Bsico",points:150,oneTime:!0},preferences:{name:"Preferncias de Estilo",points:150,oneTime:!0},measurements:{name:"Minhas Medidas",points:200,oneTime:!0},prints_photos:{name:"Meus Prints/Fotos",points:150,oneTime:!0}},zfe={update_style:{name:"Atualizar Estilo",points:80,interval:"monthly"},post_purchase_feedback:{name:"Feedback Ps-Compra",points:50,interval:"monthly"},occasion_month:{name:"Ocasio do Ms",points:50,interval:"monthly"}};function i1(){const{user:e}=qn(),[t,r]=P.useState(null),[s,a]=P.useState([]),[i,o]=P.useState([]),[l,d]=P.useState([]),[c,u]=P.useState(!0),h=P.useCallback(D=>es[D],[]),f=P.useCallback(D=>{const B=e3.indexOf(D);return B<e3.length-1?e3[B+1]:null},[]),m=P.useCallback((D,B)=>{const q=f(B);if(!q)return{progress:100,pointsNeeded:0,nextTierName:null};const Y=es[B],G=es[q],I=D-Y.minPoints,F=G.minPoints-Y.minPoints,S=Math.min(I/F*100,100),E=Math.max(G.minPoints-D,0);return{progress:S,pointsNeeded:E,nextTierName:G.name}},[f]),p=P.useCallback(D=>D<t3,[]),g=P.useCallback(D=>Math.max(t3-D,0),[]),x=P.useCallback(D=>{const B=D*$fe,q=eR.filter(G=>G.value<=B);if(q.length===0)return{maxPoints:0,maxDiscount:0};const Y=q[q.length-1];return{maxPoints:Y.points,maxDiscount:Y.value}},[]),v=P.useCallback(async()=>{if(!e){r(null),u(!1);return}try{let{data:D,error:B}=await le.from("customer_loyalty").select("*").eq("user_id",e.id).maybeSingle();if(!D&&!B){const{data:q,error:Y}=await le.from("customer_loyalty").insert({user_id:e.id}).select().single();if(Y)throw Y;D=q}D&&r({id:D.id,currentPoints:D.current_points,lifetimePoints:D.lifetime_points,annualPoints:D.annual_points,currentTier:D.current_tier,weeklyMissionPoints:D.weekly_mission_points,weeklyMissionResetAt:D.weekly_mission_reset_at})}catch(D){console.error("Error fetching loyalty:",D)}finally{u(!1)}},[e]),y=P.useCallback(async()=>{if(e)try{const{data:D,error:B}=await le.from("point_transactions").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(50);if(B)throw B;a((D||[]).map(q=>({id:q.id,type:q.type,points:q.points,description:q.description,orderId:q.order_id,missionId:q.mission_id,rewardId:q.reward_id,expiresAt:q.expires_at,expired:q.expired,multiplier:q.multiplier||1,basePoints:q.base_points,createdAt:q.created_at})))}catch(D){console.error("Error fetching transactions:",D)}},[e]),b=P.useCallback(async()=>{try{const{data:D,error:B}=await le.from("loyalty_rewards").select("*").eq("is_active",!0).order("points_cost",{ascending:!0});if(B)throw B;o((D||[]).map(q=>({id:q.id,name:q.name,description:q.description,imageUrl:q.image_url,type:q.type,pointsCost:q.points_cost,discountValue:q.discount_value,minTier:q.min_tier,stockQty:q.stock_qty,unlimitedStock:q.unlimited_stock,isActive:q.is_active,isFeatured:q.is_featured})))}catch(D){console.error("Error fetching rewards:",D)}},[]),j=P.useCallback(async()=>{if(e)try{const{data:D,error:B}=await le.from("reward_redemptions").select("*, loyalty_rewards(*)").eq("user_id",e.id).order("created_at",{ascending:!1});if(B)throw B;d((D||[]).map(q=>({id:q.id,rewardId:q.reward_id,pointsSpent:q.points_spent,couponCode:q.coupon_code,rewardType:q.reward_type,discountValue:q.discount_value,status:q.status,expiresAt:q.expires_at,createdAt:q.created_at,reward:q.loyalty_rewards?{id:q.loyalty_rewards.id,name:q.loyalty_rewards.name,description:q.loyalty_rewards.description,imageUrl:q.loyalty_rewards.image_url,type:q.loyalty_rewards.type,pointsCost:q.loyalty_rewards.points_cost,discountValue:q.loyalty_rewards.discount_value,minTier:q.loyalty_rewards.min_tier,stockQty:q.loyalty_rewards.stock_qty,unlimitedStock:q.loyalty_rewards.unlimited_stock,isActive:q.loyalty_rewards.is_active,isFeatured:q.loyalty_rewards.is_featured}:void 0})))}catch(D){console.error("Error fetching redemptions:",D)}},[e]),T=P.useCallback(D=>{if(!t)return{canRedeem:!1,reason:"Faa login para resgatar"};if(t.currentPoints<D.pointsCost)return{canRedeem:!1,reason:`Faltam ${D.pointsCost-t.currentPoints} pontos`};const B=["poa","poa_gold","poa_platinum","poa_black"];return B.indexOf(t.currentTier)<B.indexOf(D.minTier)?{canRedeem:!1,reason:`Necessrio nvel ${es[D.minTier].name}`}:!D.unlimitedStock&&(D.stockQty===null||D.stockQty<=0)?{canRedeem:!1,reason:"Esgotado"}:{canRedeem:!0,reason:null}},[t]),O=P.useCallback(async D=>{if(!e||!t)return null;const B=i.find(G=>G.id===D);if(!B)return null;const{canRedeem:q,reason:Y}=T(B);if(!q)throw new Error(Y||"No  possvel resgatar");try{const{data:G,error:I}=await le.rpc("generate_reward_coupon");if(I)throw I;const F=G,S=new Date;S.setDate(S.getDate()+30);const{data:E,error:N}=await le.from("reward_redemptions").insert({user_id:e.id,reward_id:D,points_spent:B.pointsCost,coupon_code:F,reward_type:B.type,discount_value:B.discountValue,expires_at:S.toISOString()}).select().single();if(N)throw N;const{error:C}=await le.from("point_transactions").insert({user_id:e.id,type:"redemption",points:-B.pointsCost,description:`Resgate: ${B.name}`,reward_id:D,redemption_id:E.id});if(C)throw C;const{error:k}=await le.from("customer_loyalty").update({current_points:t.currentPoints-B.pointsCost,updated_at:new Date().toISOString()}).eq("id",t.id);if(k)throw k;return await Promise.all([v(),j(),y()]),F}catch(G){throw console.error("Error redeeming reward:",G),G}},[e,t,i,T,v,j,y]),R=P.useCallback(()=>{const D=new Date;return D.setDate(D.getDate()+30),s.filter(B=>B.points>0&&!B.expired&&B.expiresAt&&new Date(B.expiresAt)<=D).reduce((B,q)=>B+q.points,0)},[s]);return P.useEffect(()=>{v(),b()},[v,b]),P.useEffect(()=>{e&&(y(),j())},[e,y,j]),{loyalty:t,transactions:s,rewards:i,redemptions:l,isLoading:c,getTierInfo:h,getNextTier:f,getProgressToNextTier:m,canEarnMissionPoints:p,getMissionPointsRemaining:g,monthlyMissionLimit:t3,canRedeemReward:T,redeemReward:O,getExpiringPoints:R,getMaxRedeemablePoints:x,fixedMissions:Ffe,recurringMissions:zfe,redemptionDiscounts:eR,refetch:v}}var xV="AlertDialog",[Ufe,YZe]=ea(xV,[LU]),md=LU(),vV=e=>{const{__scopeAlertDialog:t,...r}=e,s=md(t);return n.jsx(r1,{...s,...r,modal:!0})};vV.displayName=xV;var Vfe="AlertDialogTrigger",yV=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,a=md(r);return n.jsx(w_,{...a,...s,ref:t})});yV.displayName=Vfe;var qfe="AlertDialogPortal",bV=e=>{const{__scopeAlertDialog:t,...r}=e,s=md(t);return n.jsx(n1,{...s,...r})};bV.displayName=qfe;var Wfe="AlertDialogOverlay",wV=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,a=md(r);return n.jsx(wf,{...a,...s,ref:t})});wV.displayName=Wfe;var $m="AlertDialogContent",[Hfe,Gfe]=Ufe($m),Kfe=wF("AlertDialogContent"),_V=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:s,...a}=e,i=md(r),o=P.useRef(null),l=Rr(t,o),d=P.useRef(null);return n.jsx(Nhe,{contentName:$m,titleName:jV,docsSlug:"alert-dialog",children:n.jsx(Hfe,{scope:r,cancelRef:d,children:n.jsxs(_f,{role:"alertdialog",...i,...a,ref:l,onOpenAutoFocus:Tt(a.onOpenAutoFocus,c=>{var u;c.preventDefault(),(u=d.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:c=>c.preventDefault(),onInteractOutside:c=>c.preventDefault(),children:[n.jsx(Kfe,{children:s}),n.jsx(Yfe,{contentRef:o})]})})})});_V.displayName=$m;var jV="AlertDialogTitle",NV=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,a=md(r);return n.jsx(og,{...a,...s,ref:t})});NV.displayName=jV;var SV="AlertDialogDescription",CV=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,a=md(r);return n.jsx(lg,{...a,...s,ref:t})});CV.displayName=SV;var Xfe="AlertDialogAction",EV=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,a=md(r);return n.jsx(s1,{...a,...s,ref:t})});EV.displayName=Xfe;var kV="AlertDialogCancel",AV=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,{cancelRef:a}=Gfe(kV,r),i=md(r),o=Rr(t,a);return n.jsx(s1,{...i,...s,ref:o})});AV.displayName=kV;var Yfe=({contentRef:e})=>{const t=`\`${$m}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${$m}\` by passing a \`${SV}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${$m}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return P.useEffect(()=>{var s;document.getElementById((s=e.current)==null?void 0:s.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Zfe=vV,Qfe=yV,Jfe=bV,TV=wV,PV=_V,OV=EV,RV=AV,MV=NV,IV=CV;const _c=Zfe,o1=Qfe,eme=Jfe,DV=P.forwardRef(({className:e,...t},r)=>n.jsx(TV,{className:He("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));DV.displayName=TV.displayName;const Tl=P.forwardRef(({className:e,...t},r)=>n.jsxs(eme,{children:[n.jsx(DV,{}),n.jsx(PV,{ref:r,className:He("fixed left-[50%] top-[50%] z-50 grid w-[min(92vw,480px)] max-w-[92vw] max-h-[85vh] overflow-y-auto translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-4 sm:p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg",e),...t})]}));Tl.displayName=PV.displayName;const Pl=({className:e,...t})=>n.jsx("div",{className:He("flex flex-col space-y-2 text-center sm:text-left",e),...t});Pl.displayName="AlertDialogHeader";const jc=({className:e,...t})=>n.jsx("div",{className:He("flex flex-col gap-2 sm:flex-row sm:justify-end sm:space-x-2",e),...t});jc.displayName="AlertDialogFooter";const Ol=P.forwardRef(({className:e,...t},r)=>n.jsx(MV,{ref:r,className:He("text-lg font-semibold",e),...t}));Ol.displayName=MV.displayName;const Rl=P.forwardRef(({className:e,...t},r)=>n.jsx(IV,{ref:r,className:He("text-sm text-muted-foreground",e),...t}));Rl.displayName=IV.displayName;const Nc=P.forwardRef(({className:e,...t},r)=>n.jsx(OV,{ref:r,className:He($x(),e),...t}));Nc.displayName=OV.displayName;const Sc=P.forwardRef(({className:e,...t},r)=>n.jsx(RV,{ref:r,className:He($x({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Sc.displayName=RV.displayName;const tme=()=>{const e=pr(),{user:t,isLoading:r}=qn(),[s,a]=P.useState(null),[i,o]=P.useState(!0),[l,d]=P.useState(null);P.useEffect(()=>{if(!r){if(!t){e("/entrar",{state:{from:"/meu-estilo",message:"Entre ou crie sua conta para salvar seu estilo e receber sugestes no seu tamanho."}});return}c(),u()}},[t,r,e]);const c=async()=>{if(t)try{const{data:G,error:I}=await le.from("profiles").select(`
          name, full_name, style_title, style_description, 
          size_letter, size_number, quiz_points, quiz_level, 
          quiz_completed_at, completed_missions, last_mission_id,
          last_mission_completed_at, color_palette, personal_tip
        `).eq("user_id",t.id).maybeSingle();if(I)throw I;a(G||{name:null,full_name:null,style_title:null,style_description:null,size_letter:null,size_number:null,quiz_points:0,quiz_level:1,quiz_completed_at:null,completed_missions:[],last_mission_id:null,last_mission_completed_at:null,color_palette:null,personal_tip:null})}catch(G){console.error("Error loading profile:",G)}finally{o(!1)}},u=async()=>{if(t)try{const{data:G}=await le.from("mission_attempts").select("mission_id").eq("user_id",t.id).eq("status","in_progress").order("updated_at",{ascending:!1}).limit(1).maybeSingle();d((G==null?void 0:G.mission_id)||null)}catch(G){console.error("Error checking in-progress mission:",G)}},h=!!(s!=null&&s.quiz_completed_at)&&!!(s!=null&&s.style_title),{loyalty:f,getTierInfo:m,getProgressToNextTier:p,isLoading:g}=i1();if(P.useEffect(()=>{!i&&s&&!h&&e("/quiz")},[i,s,h,e]),r||i||g)return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-accent"})})]});if(!s||!h)return null;const x=(f==null?void 0:f.currentPoints)||0,v=(f==null?void 0:f.currentTier)||"poa",y=m(v),{progress:b,pointsNeeded:j,nextTierName:T}=p((f==null?void 0:f.annualPoints)||0,v),O=s.full_name||s.name||"voc",R=[s.size_letter,s.size_number].filter(Boolean).join(" / "),D=s.completed_missions||[],B=cw.filter(G=>D.includes(G.id)),q=cw.filter(G=>!D.includes(G.id)),Y=q[0];return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-6 max-w-lg",children:[n.jsx("div",{className:"text-center mb-6",children:n.jsx("p",{className:"text-xs text-muted-foreground",children:"Quanto mais voc completa misses, mais perfeito fica seu provador no seu tamanho "})}),n.jsxs("div",{className:"bg-gradient-to-br from-accent/10 via-primary/5 to-accent/5 border border-accent/20 rounded-2xl p-5 mb-6",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsxs("h1",{className:"font-serif text-xl mb-1",children:["Ol, ",O," "]}),n.jsx("p",{className:"text-accent font-medium",children:s.style_title}),R&&n.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Tamanhos: ",R]})]}),s.color_palette&&s.color_palette.length>0&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mb-4",children:[n.jsx(n_,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("div",{className:"flex gap-1.5",children:s.color_palette.slice(0,4).map((G,I)=>n.jsx(ke,{variant:"outline",className:"text-xs",children:G},I))})]})]}),n.jsxs("div",{className:"bg-card border border-border rounded-2xl p-5 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(ma,{className:"h-5 w-5 text-accent"}),n.jsx("h2",{className:"font-serif text-lg",children:"Seu Progresso VIP"})]}),n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("div",{className:"flex items-center gap-1.5 bg-accent/10 px-3 py-1.5 rounded-full",children:[n.jsx(wi,{className:"h-4 w-4 text-amber-500 fill-amber-500"}),n.jsxs("span",{className:"font-bold text-amber-700",children:[x," pts"]})]})}),n.jsxs("div",{className:"text-sm text-right",children:[n.jsx("span",{className:"text-muted-foreground",children:"Nvel Atual: "}),n.jsx("span",{className:"font-medium text-accent",children:y.name})]})]}),T?n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-1.5",children:[n.jsxs("span",{children:["Rumo ao nvel ",T]}),n.jsxs("span",{children:["Faltam ",j," pts"]})]}),n.jsx(dg,{value:b,className:"h-2.5"})]}):n.jsxs("div",{className:"flex items-center gap-2 text-sm text-accent mb-4",children:[n.jsx(mn,{className:"h-4 w-4"}),n.jsx("span",{className:"font-medium",children:"Nvel mximo alcanado! "})]}),n.jsx("p",{className:"text-xs text-muted-foreground text-center bg-muted/30 rounded-lg p-3",children:"Quanto mais voc detalha seu estilo, mais certeiras ficam suas sugestes  e mais pontos voc ganha "})]}),n.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Pn,{className:"h-5 w-5 text-amber-600"}),n.jsx("h3",{className:"font-medium text-amber-800 dark:text-amber-200",children:"Recompensas"})]}),n.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:"Seus pontos podem virar presentes e vantagens exclusivas (em breve). "})]}),n.jsxs("div",{className:"space-y-3 mb-6",children:[l?n.jsx(Ft,{to:`/missao/${l}`,children:n.jsxs(he,{className:"w-full gap-2 bg-amber-500 hover:bg-amber-600 text-white",children:[n.jsx(Lr,{className:"h-4 w-4"}),"Continuar de onde parei",n.jsx(hs,{className:"h-4 w-4"})]})}):Y?n.jsx(Ft,{to:`/missao/${Y.id}`,children:n.jsxs(he,{className:"w-full gap-2",children:[n.jsx(li,{className:"h-4 w-4"}),"Continuar Trilhas",n.jsx(hs,{className:"h-4 w-4"})]})}):n.jsxs("div",{className:"text-center text-sm text-muted-foreground bg-card rounded-xl p-3 border",children:[n.jsx(mn,{className:"h-5 w-5 text-accent mx-auto mb-1"}),"Todas as misses completadas! "]}),n.jsx(Ft,{to:"/minhas-sugestoes",children:n.jsxs(he,{variant:"outline",className:"w-full gap-2",children:[n.jsx(ai,{className:"h-4 w-4"}),"Ver minhas sugestes"]})})]}),n.jsxs("div",{className:"space-y-6",children:[q.length>0&&n.jsxs("div",{children:[n.jsxs("h3",{className:"font-serif text-lg mb-3 flex items-center gap-2",children:[n.jsx(li,{className:"h-4 w-4 text-accent"}),"Misses Disponveis"]}),n.jsx("div",{className:"space-y-3",children:q.map((G,I)=>n.jsx(tR,{mission:G,isCompleted:!1,isInProgress:l===G.id,isNextSuggested:I===0&&!l},G.id))})]}),B.length>0&&n.jsxs("div",{children:[n.jsxs("h3",{className:"font-serif text-lg mb-3 flex items-center gap-2",children:[n.jsx(mn,{className:"h-4 w-4 text-green-500"}),"Misses Concludas (",B.length,")"]}),n.jsx("div",{className:"space-y-3",children:B.map(G=>n.jsx(tR,{mission:G,isCompleted:!0},G.id))})]})]}),n.jsx("div",{className:"mt-8 pt-6 border-t border-border",children:n.jsxs(_c,{children:[n.jsx(o1,{asChild:!0,children:n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full text-muted-foreground hover:text-foreground gap-2",children:[n.jsx(Kv,{className:"h-4 w-4"}),"Refazer Quiz Base"]})}),n.jsxs(Tl,{children:[n.jsxs(Pl,{children:[n.jsx(Ol,{children:"Refazer Quiz Base?"}),n.jsxs(Rl,{children:["Voc pode refazer o quiz para atualizar seu perfil de estilo.",n.jsx("span",{className:"block mt-2 font-medium text-foreground",children:"Seus pontos sero mantidos  no sero somados novamente."})]})]}),n.jsxs(jc,{children:[n.jsx(Sc,{children:"Cancelar"}),n.jsx(Nc,{asChild:!0,children:n.jsx(Ft,{to:"/quiz?redo=true",children:n.jsx(he,{children:"Refazer Quiz"})})})]})]})]})})]})]})};function tR({mission:e,isCompleted:t,isInProgress:r,isNextSuggested:s}){const a=Lfe(e);return n.jsx(Ft,{to:`/missao/${e.id}`,children:n.jsx($e,{className:`transition-all hover:shadow-md ${t?"bg-muted/30 border-green-200 dark:border-green-800":r?"border-amber-300 bg-amber-50/50 dark:bg-amber-900/10":s?"border-accent/50 bg-accent/5":""}`,children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"text-3xl",children:e.emoji}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-medium truncate",children:e.title}),t&&n.jsx(mn,{className:"h-4 w-4 text-green-500 flex-shrink-0"}),r&&n.jsx(ke,{variant:"outline",className:"text-amber-600 border-amber-300 text-xs",children:"Em andamento"}),s&&!r&&n.jsx(ke,{className:"bg-accent text-accent-foreground text-xs",children:"Sugerida"})]}),n.jsx("p",{className:"text-sm text-muted-foreground truncate",children:e.subtitle}),n.jsxs("div",{className:"flex items-center gap-3 mt-2 text-xs text-muted-foreground",children:[n.jsxs("span",{children:[e.questions.length," perguntas"]}),n.jsxs("span",{children:["+",a," pts"]}),n.jsx("span",{children:" at 5 fotos"})]})]}),n.jsx(In,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"})]})})})})}const rs=P.forwardRef(({className:e,...t},r)=>n.jsx("textarea",{className:He("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));rs.displayName="Textarea";function rme({current:e,total:t}){const r=e/t*100;return n.jsxs("div",{className:"w-full space-y-5",children:[n.jsx("div",{className:"text-center",children:n.jsx("p",{className:"text-[10px] tracking-[0.3em] uppercase text-foreground/40 font-medium",children:"Sua consultoria de estilo"})}),n.jsxs("div",{children:[n.jsx("div",{className:"h-px bg-border relative",children:n.jsx("div",{className:"h-px bg-foreground transition-all duration-700 ease-out",style:{width:`${r}%`}})}),n.jsxs("div",{className:"flex justify-between mt-2.5",children:[n.jsxs("span",{className:"text-[11px] text-foreground/40 tracking-wide",children:[e," de ",t]}),n.jsxs("span",{className:"text-[11px] text-foreground/40 tracking-wide",children:[Math.round(r),"%"]})]})]})]})}function LV({text:e,imageUrl:t,isSelected:r,onClick:s}){return n.jsx("button",{onClick:s,className:He("relative w-full py-5 px-6 border transition-all duration-500 text-left group","hover:border-foreground/40","active:scale-[0.99]",r?"border-foreground bg-foreground/[0.03]":"border-border bg-transparent"),children:n.jsxs("div",{className:"flex items-center gap-4",children:[t&&n.jsx("img",{src:t,alt:e,className:He("w-12 h-12 object-cover flex-shrink-0 transition-all duration-300",r&&"ring-1 ring-foreground")}),n.jsx("span",{className:He("font-light text-base flex-1 transition-colors duration-300 tracking-wide",r?"text-foreground font-normal":"text-foreground/70"),children:e}),r?n.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-foreground flex items-center justify-center",children:n.jsx(gn,{className:"h-3.5 w-3.5 text-background",strokeWidth:2.5})}):n.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full border border-foreground/20 group-hover:border-foreground/40 transition-colors duration-300"})]})})}const nme=["PP","P","M","G","GG"],sme=["34","36","38","40","42","44","46"];function ame({selectedLetterSize:e,selectedNumberSize:t,onSelectLetter:r,onSelectNumber:s}){const a=o=>{r(e===o?null:o)},i=o=>{s(t===o?null:o)};return n.jsxs("div",{className:"space-y-8",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/40 font-medium mb-4",children:["Tamanho em letras ",n.jsx("span",{className:"text-foreground/60",children:"(opcional)"})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:nme.map((o,l)=>n.jsx("button",{onClick:()=>a(o),style:{animationDelay:`${l*50}ms`},className:He("w-14 h-14 border font-light tracking-wide text-sm transition-all duration-300 animate-slide-in-up","hover:border-foreground/40",e===o?"border-foreground bg-foreground text-background font-normal":"border-border bg-transparent text-foreground/60"),children:o},o))})]}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/40 font-medium mb-4",children:["Numerao ",n.jsx("span",{className:"text-foreground/60",children:"(opcional)"})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:sme.map((o,l)=>n.jsx("button",{onClick:()=>i(o),style:{animationDelay:`${(l+5)*50}ms`},className:He("w-14 h-14 border font-light tracking-wide text-sm transition-all duration-300 animate-slide-in-up","hover:border-foreground/40",t===o?"border-foreground bg-foreground text-background font-normal":"border-border bg-transparent text-foreground/60"),children:o},o))})]}),(e||t)&&n.jsx("div",{className:"border-t border-border pt-4",children:n.jsx("p",{className:"text-sm text-foreground/70 text-center font-light",children:e&&t?n.jsxs(n.Fragment,{children:["Seus tamanhos: ",n.jsx("span",{className:"font-medium text-foreground",children:e})," e ",n.jsx("span",{className:"font-medium text-foreground",children:t})]}):e?n.jsxs(n.Fragment,{children:["Seu tamanho: ",n.jsx("span",{className:"font-medium text-foreground",children:e})]}):n.jsxs(n.Fragment,{children:["Sua numerao: ",n.jsx("span",{className:"font-medium text-foreground",children:t})]})})})]})}function BV({points:e,show:t,onComplete:r}){const[s,a]=P.useState(!1),[i,o]=P.useState(0);return P.useEffect(()=>{if(t&&e>0){a(!0),requestAnimationFrame(()=>{o(1)});const l=setTimeout(()=>{o(0),setTimeout(()=>{a(!1),r==null||r()},300)},1500);return()=>clearTimeout(l)}},[t,e,r]),s?n.jsx("div",{className:"fixed bottom-24 right-4 pointer-events-none z-40",children:n.jsx("div",{className:He("transition-all duration-300 ease-out",i===1?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:n.jsx("div",{className:"bg-stone-900/90 backdrop-blur-sm rounded-lg px-4 py-2 shadow-lg border border-stone-700",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Gr,{className:"h-4 w-4 text-amber-400"}),n.jsxs("span",{className:"text-sm font-medium text-white",children:["+",e," pontos"]})]})})})}):null}const py=[{id:1,question:"Como voc gostaria de ser percebida quando entra em um lugar?",subtext:"Sua consultora pessoal comea aqui",type:"single",pointsType:"key",options:[{text:"Sofisticada e poderosa  comando respeito",points:{elegante:3,classica:1,minimal:0,romantica:0}},{text:"Elegante sem esforo  tudo parece natural em mim",points:{elegante:1,classica:3,minimal:1,romantica:0}},{text:"Moderna e despojada  menos  mais",points:{elegante:0,classica:1,minimal:3,romantica:0}},{text:"Feminina e marcante  os detalhes me definem",points:{elegante:0,classica:0,minimal:0,romantica:3}}]},{id:2,question:"Como  a sua rotina na maior parte da semana?",subtext:"Para montar sugestes que funcionem na sua vida real",type:"single",pointsType:"common",options:[{text:"Escritrio, reunies e ambientes corporativos",points:{elegante:3,classica:2,minimal:0,romantica:0}},{text:"Flexvel  misturo trabalho, casa e compromissos",points:{elegante:1,classica:2,minimal:3,romantica:0}},{text:"Home office, mas saio bastante nos fins de semana",points:{elegante:0,classica:1,minimal:3,romantica:1}},{text:"Vida social ativa  eventos, encontros e sadas",points:{elegante:1,classica:0,minimal:0,romantica:3}}]},{id:3,question:"Quais cores te fazem se sentir mais bonita?",subtext:"Cores revelam muito sobre quem voc ",type:"single",pointsType:"key",options:[{text:"Preto, marinho e tons escuros  no erro nunca",points:{elegante:3,classica:1,minimal:2,romantica:0}},{text:"Neutros quentes  bege, caramelo, terracota",points:{elegante:1,classica:3,minimal:2,romantica:0}},{text:"Cores vibrantes  vermelho, verde, azul royal, pink",points:{elegante:2,classica:0,minimal:0,romantica:2}},{text:"Tons suaves  rosa, lavanda, pssego, verde menta",points:{elegante:0,classica:0,minimal:1,romantica:3}},{text:"Branco e off-white  gosto de leveza e limpeza",points:{elegante:1,classica:1,minimal:3,romantica:1}}]},{id:4,question:"O que voc mais gosta de valorizar no seu corpo?",subtext:"Para escolher cortes que te favoream de verdade",type:"single",pointsType:"key",options:[{text:"A cintura  adoro peas que marquem",points:{elegante:3,classica:1,minimal:0,romantica:2}},{text:"Os ombros e a postura  gosto de estrutura",points:{elegante:3,classica:2,minimal:1,romantica:0}},{text:"Prefiro no marcar  gosto de caimento solto",points:{elegante:0,classica:1,minimal:3,romantica:1}},{text:"As pernas  saias e vestidos so meu forte",points:{elegante:1,classica:0,minimal:0,romantica:3}}]},{id:5,question:"Qual a sua maior dificuldade na hora de se vestir?",subtext:"Entender isso me ajuda a cuidar melhor de voc",type:"single",pointsType:"common",options:[{text:"No sei combinar peas  fico insegura",points:{elegante:0,classica:3,minimal:1,romantica:1}},{text:"No encontro roupas que valorizem meu corpo",points:{elegante:2,classica:1,minimal:1,romantica:1}},{text:"Canso de usar sempre a mesma coisa",points:{elegante:1,classica:0,minimal:0,romantica:3}},{text:"Compro e depois no uso  falta estratgia",points:{elegante:0,classica:1,minimal:3,romantica:0}}]},{id:6,question:"Se pudesse ter s 3 peas no closet, qual no ficaria de fora?",subtext:"A pea essencial diz muito sobre seu estilo",type:"single",pointsType:"common",options:[{text:"Blazer bem cortado",points:{elegante:3,classica:2,minimal:1,romantica:0}},{text:"Jeans perfeito + camisa atemporal",points:{elegante:0,classica:3,minimal:2,romantica:0}},{text:"Conjunto confortvel e estiloso",points:{elegante:0,classica:0,minimal:3,romantica:1}},{text:"Vestido que funciona pra tudo",points:{elegante:1,classica:1,minimal:0,romantica:3}}]},{id:7,question:"Qual a sua relao com estampas?",subtext:"Isso define o nvel de ousadia da sua curadoria",type:"single",pointsType:"common",options:[{text:"Prefiro peas lisas  a elegncia est no corte",points:{elegante:3,classica:1,minimal:2,romantica:0}},{text:"Gosto de listras, po e estampas clssicas",points:{elegante:1,classica:3,minimal:0,romantica:1}},{text:"Adoro  floral, animal print, estampa colorida",points:{elegante:0,classica:0,minimal:0,romantica:3}},{text:"Gosto de textura  tricot, linho, couro, tule",points:{elegante:1,classica:1,minimal:3,romantica:1}}]},{id:8,question:"Tem algum look que te inspira?",subtext:"Envie uma referncia  isso me ajuda a entender voc ainda melhor",type:"photos",pointsType:"photos"},{id:9,question:"Quer me contar mais sobre o que procura?",subtext:"Quanto mais eu souber, mais precisa ser a sua curadoria",type:"open",pointsType:"open"},{id:10,question:"Qual  o seu tamanho?",subtext:"Vou selecionar apenas peas disponveis na sua numerao",type:"size",pointsType:"key"}],rC={elegante:{id:"elegante",title:"Elegante Estratgica",subtitle:"Poder e sofisticao em cada detalhe",description:"Voc transmite confiana e autoridade sem dizer uma palavra. Suas escolhas so intencionais  cada pea  um statement. Voc sabe que a roupa certa abre portas, e busca qualidade, corte impecvel e presena.",highlights:["Voc valoriza qualidade sobre quantidade","Seu olhar  atrado por cortes impecveis e acabamento nobre","A roupa  sua ferramenta de poder e expresso"],valorizes:["estrutura","acabamento impecvel","tecidos nobres","cores fortes e sbrias"],tags:["elegante","power","luxo","trabalho","sofisticada"],emoji:"",colorPalette:["preto","branco","marinho","dourado","vermelho escuro"],keyPieces:["Blazer estruturado","Scarpin clssico","Bolsa de couro","Cala de alfaiataria"]},classica:{id:"classica",title:"Clssica Moderna",subtitle:"Atemporal com um toque contemporneo",description:"Voc constri um guarda-roupa com inteno. Prefere peas que atravessam temporadas a tendncias passageiras. Seu estilo  uma curadoria inteligente  cada pea combina com as outras, e vestir-se  simples porque tudo funciona junto.",highlights:["Seu closet  curado com estratgia  nada ali  acidente","Elegncia discreta  sua marca registrada","Voc investe em peas que duram anos, no semanas"],valorizes:["versatilidade","cortes clean","paleta neutra e harmnica","peas atemporais"],tags:["clssico","atemporal","neutro","trabalho","curado"],emoji:"",colorPalette:["bege","marinho","branco","caramelo","cinza"],keyPieces:["Camisa branca","Cala de alfaiataria","Trench coat","Scarpin nude"]},minimal:{id:"minimal",title:"Chic Minimal",subtitle:"Menos  mais  e voc prova isso todos os dias",description:"Voc encontra beleza na simplicidade e conforto no que  bem pensado. Cortes limpos, cores neutras e uma curadoria intencional definem quem voc . Seu visual parece fcil, mas por trs tem uma mulher que sabe exatamente o que quer.",highlights:["Praticidade e estilo caminham juntos na sua vida","Voc prefere menos peas, mas que todas conversem entre si","Conforto no  abrir mo de estilo   seu superpoder"],valorizes:["conforto inteligente","silhueta relaxada","tecidos macios de qualidade","funcionalidade"],tags:["minimal","moderno","verstil","confortvel","clean"],emoji:"",colorPalette:["branco","cinza","bege","oliva","terracota"],keyPieces:["T-shirt premium","Jeans reto perfeito","Tnis branco","Cardigan oversized"]},romantica:{id:"romantica",title:"Romntica Contempornea",subtitle:"Delicadeza com personalidade e ousadia",description:"Voc celebra sua feminilidade com graa e autenticidade. Ama detalhes que contam uma histria  um lao, uma estampa, uma textura inesperada. Cores te atraem, movimento te encanta, e voc no tem medo de ser vista.",highlights:["Detalhes so tudo para voc  cada pea conta uma histria","Feminilidade  sua forma de expresso e fora","Voc se permite experimentar, misturar e ousar"],valorizes:["delicadeza","movimento fluido","estampas e cores","detalhes especiais"],tags:["romntico","floral","feminino","colorido","ousada"],emoji:"",colorPalette:["rosa","lavanda","pssego","vermelho","verde esmeralda"],keyPieces:["Vestido midi","Saia fluida","Blusa com detalhes","Acessrios statement"]}};function ime(e){const t={elegante:0,classica:0,minimal:0,romantica:0};e.forEach(s=>{s.points&&(t.elegante+=s.points.elegante||0,t.classica+=s.points.classica||0,t.minimal+=s.points.minimal||0,t.romantica+=s.points.romantica||0)});const r=Object.entries(t).reduce((s,a)=>s[1]>a[1]?s:a)[0];return rC[r]}const Jg=[es.poa.minPoints,es.poa_gold.minPoints,es.poa_platinum.minPoints,es.poa_black.minPoints];es.poa.name,es.poa_gold.name,es.poa_platinum.name,es.poa_black.name;function ef(e){const t=Bfe(e);return t.id==="poa_black"?{level:3,title:t.name,nextLevel:99999,minPoints:t.minPoints}:t.id==="poa_platinum"?{level:2,title:t.name,nextLevel:es.poa_black.minPoints,minPoints:t.minPoints}:t.id==="poa_gold"?{level:1,title:t.name,nextLevel:es.poa_platinum.minPoints,minPoints:t.minPoints}:{level:0,title:es.poa.name,nextLevel:es.poa_gold.minPoints,minPoints:0}}function r3(e){return e==="key"?20:e==="open"?nC:e==="photos"?0:10}const nC=30,Ju=50,qf=5;function ome({userId:e,onPhotosChange:t,photos:r,onPointsEarned:s}){const[a,i]=P.useState(!1),o=async c=>{try{const{data:u,error:h}=await le.functions.invoke("analyze-product-image",{body:{image_url:c}});return h?(console.error("Analysis error:",h),null):u!=null&&u.success&&(u!=null&&u.analysis)?u.analysis:null}catch(u){return console.error("Error analyzing photo:",u),null}},l=async c=>{const u=c.target.files;if(!u||u.length===0)return;const h=qf-r.length;if(h<=0){de.error(`Mximo de ${qf} fotos`);return}const f=Array.from(u).slice(0,h);i(!0);try{let m=[...r],p=0;for(const g of f){const x=`${e}/inspiration/${Date.now()}-${g.name}`,{error:v}=await le.storage.from("prints").upload(x,g);if(v)throw v;const{data:y}=le.storage.from("prints").getPublicUrl(x),b={url:y.publicUrl,isAnalyzing:!0};m=[...m,b],p+=Ju,t(m,p),s(Ju),de.success(`+${Ju} pontos! `),o(y.publicUrl).then(j=>{const T=m.map(O=>O.url===y.publicUrl?{...O,analysis:j||void 0,isAnalyzing:!1}:O);t(T,p)})}}catch(m){console.error("Error uploading photos:",m),de.error("Erro ao enviar fotos")}finally{i(!1),c.target.value=""}},d=c=>{const u=r.filter(f=>f.url!==c),h=u.length*Ju;t(u,h)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-3",children:[r.map((c,u)=>n.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden border-2 border-accent/30 group shadow-sm",children:[n.jsx("img",{src:c.url,alt:`Inspirao ${u+1}`,className:"w-full h-full object-cover"}),c.isAnalyzing&&n.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:n.jsx(Et,{className:"h-5 w-5 text-white animate-spin"})}),!c.isAnalyzing&&c.analysis&&n.jsx("div",{className:"absolute top-1.5 left-1.5",children:n.jsx("div",{className:"bg-accent text-accent-foreground rounded-full p-1",children:n.jsx(gn,{className:"h-3 w-3"})})}),n.jsx("button",{onClick:()=>d(c.url),className:"absolute top-1.5 right-1.5 bg-black/60 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx(sn,{className:"h-3 w-3"})}),n.jsxs("div",{className:"absolute bottom-1.5 left-1.5 bg-amber-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full",children:["+",Ju]})]},c.url)),r.length<qf&&n.jsx("button",{type:"button",onClick:()=>{var c;return(c=document.getElementById("quiz-photo-upload"))==null?void 0:c.click()},disabled:a,className:"aspect-square rounded-xl border-2 border-dashed border-accent/40 hover:border-accent bg-accent/5 hover:bg-accent/10 flex flex-col items-center justify-center transition-all disabled:opacity-50 gap-1.5",children:a?n.jsx(Et,{className:"h-6 w-6 text-accent animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(Lh,{className:"h-6 w-6 text-accent"}),n.jsxs("span",{className:"text-xs font-medium text-accent",children:["+",Ju,"pts"]})]})}),n.jsx("input",{id:"quiz-photo-upload",type:"file",accept:"image/*",multiple:!0,onChange:l,className:"hidden"})]}),r.length>0&&r.some(c=>c.analysis)&&n.jsxs("div",{className:"bg-accent/10 border border-accent/30 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(Gr,{className:"h-5 w-5 text-accent shrink-0 mt-0.5 animate-pulse"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-accent mb-1",children:"IA analisando seus looks..."}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Estou identificando cores, estilos e peas que voc ama"})]})]}),r.length===0&&!a&&n.jsxs(he,{variant:"outline",className:"w-full gap-2 h-12 border-accent/30 hover:border-accent hover:bg-accent/5",onClick:()=>{var c;return(c=document.getElementById("quiz-photo-upload"))==null?void 0:c.click()},children:[n.jsx(ka,{className:"h-5 w-5 text-accent"}),n.jsx("span",{children:"Adicionar fotos de inspirao"})]}),n.jsx("p",{className:"text-center text-sm text-muted-foreground",children:r.length===0?"Opcional: envie at 5 fotos":r.length<qf?n.jsxs(n.Fragment,{children:[n.jsxs("span",{className:"font-medium text-accent",children:[r.length,"/",qf]})," fotos  Voc pode ganhar mais ",n.jsxs("span",{className:"font-medium text-amber-600",children:["+",(qf-r.length)*Ju," pontos"]})]}):n.jsx("span",{className:"text-accent font-medium",children:" Mximo de fotos atingido!"})})]})}var l1={};(function e(t,r,s,a){var i=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),o=typeof Path2D=="function"&&typeof DOMMatrix=="function",l=function(){if(!t.OffscreenCanvas)return!1;try{var M=new OffscreenCanvas(1,1),U=M.getContext("2d");U.fillRect(0,0,1,1);var $=M.transferToImageBitmap();U.createPattern($,"no-repeat")}catch{return!1}return!0}();function d(){}function c(M){var U=r.exports.Promise,$=U!==void 0?U:t.Promise;return typeof $=="function"?new $(M):(M(d,d),null)}var u=function(M,U){return{transform:function($){if(M)return $;if(U.has($))return U.get($);var X=new OffscreenCanvas($.width,$.height),Z=X.getContext("2d");return Z.drawImage($,0,0),U.set($,X),X},clear:function(){U.clear()}}}(l,new Map),h=function(){var M=Math.floor(16.666666666666668),U,$,X={},Z=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(U=function(re){var W=Math.random();return X[W]=requestAnimationFrame(function J(V){Z===V||Z+M-1<V?(Z=V,delete X[W],re()):X[W]=requestAnimationFrame(J)}),W},$=function(re){X[re]&&cancelAnimationFrame(X[re])}):(U=function(re){return setTimeout(re,M)},$=function(re){return clearTimeout(re)}),{frame:U,cancel:$}}(),f=function(){var M,U,$={};function X(Z){function re(W,J){Z.postMessage({options:W||{},callback:J})}Z.init=function(J){var V=J.transferControlToOffscreen();Z.postMessage({canvas:V},[V])},Z.fire=function(J,V,H){if(U)return re(J,null),U;var ee=Math.random().toString(36).slice(2);return U=c(function(ie){function oe(se){se.data.callback===ee&&(delete $[ee],Z.removeEventListener("message",oe),U=null,u.clear(),H(),ie())}Z.addEventListener("message",oe),re(J,ee),$[ee]=oe.bind(null,{data:{callback:ee}})}),U},Z.reset=function(){Z.postMessage({reset:!0});for(var J in $)$[J](),delete $[J]}}return function(){if(M)return M;if(!s&&i){var Z=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{M=new Worker(URL.createObjectURL(new Blob([Z])))}catch(re){return typeof console<"u"&&typeof console.warn=="function"&&console.warn(" Could not load worker",re),null}X(M)}return M}}(),m={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function p(M,U){return U?U(M):M}function g(M){return M!=null}function x(M,U,$){return p(M&&g(M[U])?M[U]:m[U],$)}function v(M){return M<0?0:Math.floor(M)}function y(M,U){return Math.floor(Math.random()*(U-M))+M}function b(M){return parseInt(M,16)}function j(M){return M.map(T)}function T(M){var U=String(M).replace(/[^0-9a-f]/gi,"");return U.length<6&&(U=U[0]+U[0]+U[1]+U[1]+U[2]+U[2]),{r:b(U.substring(0,2)),g:b(U.substring(2,4)),b:b(U.substring(4,6))}}function O(M){var U=x(M,"origin",Object);return U.x=x(U,"x",Number),U.y=x(U,"y",Number),U}function R(M){M.width=document.documentElement.clientWidth,M.height=document.documentElement.clientHeight}function D(M){var U=M.getBoundingClientRect();M.width=U.width,M.height=U.height}function B(M){var U=document.createElement("canvas");return U.style.position="fixed",U.style.top="0px",U.style.left="0px",U.style.pointerEvents="none",U.style.zIndex=M,U}function q(M,U,$,X,Z,re,W,J,V){M.save(),M.translate(U,$),M.rotate(re),M.scale(X,Z),M.arc(0,0,1,W,J,V),M.restore()}function Y(M){var U=M.angle*(Math.PI/180),$=M.spread*(Math.PI/180);return{x:M.x,y:M.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:M.startVelocity*.5+Math.random()*M.startVelocity,angle2D:-U+(.5*$-Math.random()*$),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:M.color,shape:M.shape,tick:0,totalTicks:M.ticks,decay:M.decay,drift:M.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:M.gravity*3,ovalScalar:.6,scalar:M.scalar,flat:M.flat}}function G(M,U){U.x+=Math.cos(U.angle2D)*U.velocity+U.drift,U.y+=Math.sin(U.angle2D)*U.velocity+U.gravity,U.velocity*=U.decay,U.flat?(U.wobble=0,U.wobbleX=U.x+10*U.scalar,U.wobbleY=U.y+10*U.scalar,U.tiltSin=0,U.tiltCos=0,U.random=1):(U.wobble+=U.wobbleSpeed,U.wobbleX=U.x+10*U.scalar*Math.cos(U.wobble),U.wobbleY=U.y+10*U.scalar*Math.sin(U.wobble),U.tiltAngle+=.1,U.tiltSin=Math.sin(U.tiltAngle),U.tiltCos=Math.cos(U.tiltAngle),U.random=Math.random()+2);var $=U.tick++/U.totalTicks,X=U.x+U.random*U.tiltCos,Z=U.y+U.random*U.tiltSin,re=U.wobbleX+U.random*U.tiltCos,W=U.wobbleY+U.random*U.tiltSin;if(M.fillStyle="rgba("+U.color.r+", "+U.color.g+", "+U.color.b+", "+(1-$)+")",M.beginPath(),o&&U.shape.type==="path"&&typeof U.shape.path=="string"&&Array.isArray(U.shape.matrix))M.fill(N(U.shape.path,U.shape.matrix,U.x,U.y,Math.abs(re-X)*.1,Math.abs(W-Z)*.1,Math.PI/10*U.wobble));else if(U.shape.type==="bitmap"){var J=Math.PI/10*U.wobble,V=Math.abs(re-X)*.1,H=Math.abs(W-Z)*.1,ee=U.shape.bitmap.width*U.scalar,ie=U.shape.bitmap.height*U.scalar,oe=new DOMMatrix([Math.cos(J)*V,Math.sin(J)*V,-Math.sin(J)*H,Math.cos(J)*H,U.x,U.y]);oe.multiplySelf(new DOMMatrix(U.shape.matrix));var se=M.createPattern(u.transform(U.shape.bitmap),"no-repeat");se.setTransform(oe),M.globalAlpha=1-$,M.fillStyle=se,M.fillRect(U.x-ee/2,U.y-ie/2,ee,ie),M.globalAlpha=1}else if(U.shape==="circle")M.ellipse?M.ellipse(U.x,U.y,Math.abs(re-X)*U.ovalScalar,Math.abs(W-Z)*U.ovalScalar,Math.PI/10*U.wobble,0,2*Math.PI):q(M,U.x,U.y,Math.abs(re-X)*U.ovalScalar,Math.abs(W-Z)*U.ovalScalar,Math.PI/10*U.wobble,0,2*Math.PI);else if(U.shape==="star")for(var ue=Math.PI/2*3,pe=4*U.scalar,ce=8*U.scalar,ne=U.x,me=U.y,ge=5,_e=Math.PI/ge;ge--;)ne=U.x+Math.cos(ue)*ce,me=U.y+Math.sin(ue)*ce,M.lineTo(ne,me),ue+=_e,ne=U.x+Math.cos(ue)*pe,me=U.y+Math.sin(ue)*pe,M.lineTo(ne,me),ue+=_e;else M.moveTo(Math.floor(U.x),Math.floor(U.y)),M.lineTo(Math.floor(U.wobbleX),Math.floor(Z)),M.lineTo(Math.floor(re),Math.floor(W)),M.lineTo(Math.floor(X),Math.floor(U.wobbleY));return M.closePath(),M.fill(),U.tick<U.totalTicks}function I(M,U,$,X,Z){var re=U.slice(),W=M.getContext("2d"),J,V,H=c(function(ee){function ie(){J=V=null,W.clearRect(0,0,X.width,X.height),u.clear(),Z(),ee()}function oe(){s&&!(X.width===a.width&&X.height===a.height)&&(X.width=M.width=a.width,X.height=M.height=a.height),!X.width&&!X.height&&($(M),X.width=M.width,X.height=M.height),W.clearRect(0,0,X.width,X.height),re=re.filter(function(se){return G(W,se)}),re.length?J=h.frame(oe):ie()}J=h.frame(oe),V=ie});return{addFettis:function(ee){return re=re.concat(ee),H},canvas:M,promise:H,reset:function(){J&&h.cancel(J),V&&V()}}}function F(M,U){var $=!M,X=!!x(U||{},"resize"),Z=!1,re=x(U,"disableForReducedMotion",Boolean),W=i&&!!x(U||{},"useWorker"),J=W?f():null,V=$?R:D,H=M&&J?!!M.__confetti_initialized:!1,ee=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,ie;function oe(ue,pe,ce){for(var ne=x(ue,"particleCount",v),me=x(ue,"angle",Number),ge=x(ue,"spread",Number),_e=x(ue,"startVelocity",Number),be=x(ue,"decay",Number),ye=x(ue,"gravity",Number),Oe=x(ue,"drift",Number),Ne=x(ue,"colors",j),De=x(ue,"ticks",Number),Ge=x(ue,"shapes"),Qe=x(ue,"scalar"),Ie=!!x(ue,"flat"),Ae=O(ue),st=ne,nt=[],vt=M.width*Ae.x,Je=M.height*Ae.y;st--;)nt.push(Y({x:vt,y:Je,angle:me,spread:ge,startVelocity:_e,color:Ne[st%Ne.length],shape:Ge[y(0,Ge.length)],ticks:De,decay:be,gravity:ye,drift:Oe,scalar:Qe,flat:Ie}));return ie?ie.addFettis(nt):(ie=I(M,nt,V,pe,ce),ie.promise)}function se(ue){var pe=re||x(ue,"disableForReducedMotion",Boolean),ce=x(ue,"zIndex",Number);if(pe&&ee)return c(function(_e){_e()});$&&ie?M=ie.canvas:$&&!M&&(M=B(ce),document.body.appendChild(M)),X&&!H&&V(M);var ne={width:M.width,height:M.height};J&&!H&&J.init(M),H=!0,J&&(M.__confetti_initialized=!0);function me(){if(J){var _e={getBoundingClientRect:function(){if(!$)return M.getBoundingClientRect()}};V(_e),J.postMessage({resize:{width:_e.width,height:_e.height}});return}ne.width=ne.height=null}function ge(){ie=null,X&&(Z=!1,t.removeEventListener("resize",me)),$&&M&&(document.body.contains(M)&&document.body.removeChild(M),M=null,H=!1)}return X&&!Z&&(Z=!0,t.addEventListener("resize",me,!1)),J?J.fire(ue,ne,ge):oe(ue,ne,ge)}return se.reset=function(){J&&J.reset(),ie&&ie.reset()},se}var S;function E(){return S||(S=F(null,{useWorker:!0,resize:!0})),S}function N(M,U,$,X,Z,re,W){var J=new Path2D(M),V=new Path2D;V.addPath(J,new DOMMatrix(U));var H=new Path2D;return H.addPath(V,new DOMMatrix([Math.cos(W)*Z,Math.sin(W)*Z,-Math.sin(W)*re,Math.cos(W)*re,$,X])),H}function C(M){if(!o)throw new Error("path confetti are not supported in this browser");var U,$;typeof M=="string"?U=M:(U=M.path,$=M.matrix);var X=new Path2D(U),Z=document.createElement("canvas"),re=Z.getContext("2d");if(!$){for(var W=1e3,J=W,V=W,H=0,ee=0,ie,oe,se=0;se<W;se+=2)for(var ue=0;ue<W;ue+=2)re.isPointInPath(X,se,ue,"nonzero")&&(J=Math.min(J,se),V=Math.min(V,ue),H=Math.max(H,se),ee=Math.max(ee,ue));ie=H-J,oe=ee-V;var pe=10,ce=Math.min(pe/ie,pe/oe);$=[ce,0,0,ce,-Math.round(ie/2+J)*ce,-Math.round(oe/2+V)*ce]}return{type:"path",path:U,matrix:$}}function k(M){var U,$=1,X="#000000",Z='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof M=="string"?U=M:(U=M.text,$="scalar"in M?M.scalar:$,Z="fontFamily"in M?M.fontFamily:Z,X="color"in M?M.color:X);var re=10*$,W=""+re+"px "+Z,J=new OffscreenCanvas(re,re),V=J.getContext("2d");V.font=W;var H=V.measureText(U),ee=Math.ceil(H.actualBoundingBoxRight+H.actualBoundingBoxLeft),ie=Math.ceil(H.actualBoundingBoxAscent+H.actualBoundingBoxDescent),oe=2,se=H.actualBoundingBoxLeft+oe,ue=H.actualBoundingBoxAscent+oe;ee+=oe+oe,ie+=oe+oe,J=new OffscreenCanvas(ee,ie),V=J.getContext("2d"),V.font=W,V.fillStyle=X,V.fillText(U,se,ue);var pe=1/$;return{type:"bitmap",bitmap:J.transferToImageBitmap(),matrix:[pe,0,0,pe,-ee*pe/2,-ie*pe/2]}}r.exports=function(){return E().apply(this,arguments)},r.exports.reset=function(){E().reset()},r.exports.create=F,r.exports.shapeFromPath=C,r.exports.shapeFromText=k})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),l1,!1);const eh=l1.exports;l1.exports.create;function gk(){const e=P.useCallback((s={})=>{const{type:a="default"}=s;switch(a){case"stars":eh({particleCount:50,spread:60,origin:{y:.6},colors:["#FFD700","#FFA500","#FF6B6B","#9333EA"],shapes:["star"],scalar:1.2});break;case"emoji":eh({particleCount:30,spread:70,origin:{y:.5},colors:["#FFD700","#E91E63","#9C27B0","#4CAF50"]});break;case"celebration":let o=function(h,f){return Math.random()*(f-h)+h};const l=2e3,d=Date.now()+l,c={startVelocity:30,spread:360,ticks:60,zIndex:1e3},u=setInterval(function(){const h=d-Date.now();if(h<=0)return clearInterval(u);const f=50*(h/l);eh({...c,particleCount:f,origin:{x:o(.1,.3),y:Math.random()-.2},colors:["#FFD700","#FF6B6B","#9333EA","#22C55E"]}),eh({...c,particleCount:f,origin:{x:o(.7,.9),y:Math.random()-.2},colors:["#FFD700","#FF6B6B","#9333EA","#22C55E"]})},250);break;default:eh({particleCount:80,spread:70,origin:{y:.6},colors:["#FFD700","#9333EA","#22C55E","#FF6B6B","#3B82F6"]})}},[]),t=P.useCallback(s=>{const a=Math.min(30+s,100);eh({particleCount:a,spread:50+s,origin:{y:.7,x:.5},colors:["#FFD700","#FFA500","#9333EA"],shapes:["star","circle"],scalar:.8})},[]),r=P.useCallback(()=>{const a={origin:{y:.7},zIndex:1e3};function i(o,l){eh({...a,...l,particleCount:Math.floor(200*o)})}i(.25,{spread:26,startVelocity:55,colors:["#FFD700"]}),i(.2,{spread:60,colors:["#9333EA"]}),i(.35,{spread:100,decay:.91,scalar:.8,colors:["#22C55E","#FFD700"]}),i(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2,colors:["#FF6B6B","#9333EA"]}),i(.1,{spread:120,startVelocity:45,colors:["#FFD700","#FFA500"]})},[]);return{fireConfetti:e,firePoints:t,fireLevelUp:r}}const lme=()=>{var pe;const e=pr(),[t]=hd(),r=t.get("redo")==="true",{user:s,isLoading:a}=qn(),{firePoints:i,fireLevelUp:o}=gk(),[l,d]=P.useState(0),[c,u]=P.useState([]),[h,f]=P.useState(null),[m,p]=P.useState(null),[g,x]=P.useState(null),[v,y]=P.useState(""),[b,j]=P.useState([]),[T,O]=P.useState(0),[R,D]=P.useState(!1),[B,q]=P.useState(0),[Y,G]=P.useState(0),[I,F]=P.useState(0),[S,E]=P.useState(!1),[N,C]=P.useState(1),[k,M]=P.useState(!1);P.useEffect(()=>{!a&&!s&&e("/entrar?redirect=/quiz",{replace:!0})},[s,a,e]),P.useEffect(()=>{(async()=>{if(s&&r){const{data:ne}=await le.from("profiles").select("quiz_points").eq("user_id",s.id).single();ne!=null&&ne.quiz_points&&G(ne.quiz_points)}})()},[s,r]);const U=py[l],$=l===py.length-1,X=(U==null?void 0:U.type)==="size",Z=(U==null?void 0:U.type)==="photos",re=(U==null?void 0:U.type)==="open",W=X?m!==null||g!==null:Z||re?!0:h!==null,J=P.useCallback(ce=>{const{level:ne}=ef(ce);ne>N&&(C(ne),setTimeout(()=>{o(),de.success(` Parabns! Voc alcanou o Nvel ${ne}!`,{duration:3e3})},800))},[N,o]);P.useEffect(()=>{if(I>0){const ce=setTimeout(()=>F(0),1500);return()=>clearTimeout(ce)}},[I]);const V=ce=>{f(ce)},H=ce=>{p(ce)},ee=ce=>{x(ce)},ie=(ce,ne)=>{j(ce),O(ne)},oe=ce=>{if(r)return;const ne=B+ce;q(ne),F(ce),E(!0),i(ce),J(ne)},se=async()=>{var _e,be;if(Z){M(!0),setTimeout(()=>{d(l+1),f(null),M(!1)},300);return}if(re){const ye=r?0:v.trim()?nC:0;if(ye>0){const Oe=B+ye;q(Oe),F(ye),E(!0),i(ye),J(Oe)}M(!0),setTimeout(()=>{d(l+1),f(null),M(!1)},300);return}if(X){if(!m&&!g)return;D(!0);try{const ye=r?0:r3(U.pointsType),Oe=r?Y:B+ye,Ne=ime(c),De=c.map(Le=>({question:Le.question,answer:Le.answer,points:Le.earnedPoints})),Ge=[m,g].filter(Boolean).join(" / ");let Qe=null;try{const{data:Le,error:Ze}=await le.functions.invoke("analyze-quiz",{body:{answers:De,size:Ge,additionalNotes:v||void 0,totalPoints:Oe,inspirationPhotos:b.filter(ct=>ct.analysis).map(ct=>({url:ct.url,analysis:ct.analysis}))}});!Ze&&Le&&!Le.error&&(Qe=Le)}catch(Le){console.log("AI analysis skipped:",Le)}let Ie="",Ae="",st="";if(s){const{data:Le}=await le.from("profiles").select("name, whatsapp, full_name").eq("user_id",s.id).maybeSingle();Ie=(Le==null?void 0:Le.full_name)||(Le==null?void 0:Le.name)||((_e=s.user_metadata)==null?void 0:_e.name)||"",Ae=(Le==null?void 0:Le.whatsapp)||((be=s.user_metadata)==null?void 0:be.whatsapp)||"",st=s.email||""}const{data:nt,error:vt}=await le.from("customers").upsert({phone:Ae,name:Ie,email:st||null,style_title:(Qe==null?void 0:Qe.styleTitle)||Ne.title,size_letter:m,size_number:g,user_id:s==null?void 0:s.id},{onConflict:"user_id",ignoreDuplicates:!1}).select().single();if(vt)throw vt;if(s){const{level:Le}=ef(Oe),ct=b.filter(ht=>ht.analysis).map(ht=>ht.analysis).map(ht=>{var yt;return(yt=ht==null?void 0:ht.cor)==null?void 0:yt.value}).filter(Boolean).slice(0,3);await le.from("profiles").update({size_letter:m,size_number:g,style_title:(Qe==null?void 0:Qe.styleTitle)||Ne.title,quiz_points:Oe,quiz_level:Le,quiz_completed_at:new Date().toISOString(),style_description:(Qe==null?void 0:Qe.description)||Ne.description,color_palette:(Qe==null?void 0:Qe.colorPalette)||[...ct,...Ne.colorPalette||[]].slice(0,5),personal_tip:Qe==null?void 0:Qe.personalTip,avoid_items:(Qe==null?void 0:Qe.avoidColors)||[]}).eq("user_id",s.id)}const Je=c.map((Le,Ze)=>({customer_id:nt.id,user_id:s==null?void 0:s.id,question_number:Ze+1,question:Le.question,answer:Le.answer,points:Le.earnedPoints}));if(b.length>0&&Je.push({customer_id:nt.id,user_id:s==null?void 0:s.id,question_number:c.length+1,question:"Fotos de inspirao",answer:`${b.length} fotos enviadas`,points:T}),v&&Je.push({customer_id:nt.id,user_id:s==null?void 0:s.id,question_number:c.length+2,question:"Quer me contar mais?",answer:v,points:v.trim()?nC:0}),m||g){const Le=[m,g].filter(Boolean).join(" e ");Je.push({customer_id:nt.id,user_id:s==null?void 0:s.id,question_number:c.length+3,question:"Qual  o seu tamanho?",answer:Le,points:ye})}if(!r&&s&&Oe>0){const{error:Le}=await le.rpc("award_loyalty_points",{p_user_id:s.id,p_points:Oe,p_description:"Quiz de Estilo Inicial"});Le&&(console.error("Error awarding loyalty points:",Le),de.error("Erro ao computar pontos do clube, mas seu estilo foi salvo!"))}const{error:Ue}=await le.from("quiz_responses").insert(Je);if(Ue)throw Ue;e(`/resultado/${nt.id}`,{state:{aiAnalysis:Qe,totalPoints:Oe,sizeLetter:m,sizeNumber:g,showCelebration:!0,profile:Ne}})}catch(ye){console.error("Error saving quiz:",ye),de.error("Ops! Algo deu errado. Tente novamente."),D(!1)}return}if(h===null||!U.options)return;const ce=U.options[h],ne=r?0:r3(U.pointsType),me={questionId:U.id,question:U.question,answer:ce.text,points:ce.points,earnedPoints:ne},ge=B+ne;ne>0&&(i(ne),E(!0),F(ne),J(ge)),u([...c,me]),q(ge),M(!0),setTimeout(()=>{d(l+1),f(null),M(!1)},300)},ue=()=>{if(l>0){if(py[l-1].type==="single"){const ne=c[c.length-1];ne&&(q(me=>me-ne.earnedPoints),u(c.slice(0,-1)))}M(!0),setTimeout(()=>{d(l-1),f(null),M(!1)},150)}};return a?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Et,{className:"h-8 w-8 animate-spin text-accent mx-auto mb-4"}),n.jsx("p",{className:"text-muted-foreground",children:"Carregando..."})]})}):s?(U&&r3(U.pointsType),n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(Nr,{}),n.jsx(BV,{points:I,show:S,onComplete:()=>E(!1)}),n.jsxs("main",{className:"flex-1 container mx-auto px-4 py-6 max-w-2xl",children:[r&&n.jsxs("div",{className:"mb-6 border border-foreground/10 p-4 flex items-center gap-2 text-sm text-foreground/60",children:[n.jsx(Kv,{className:"h-4 w-4 flex-shrink-0"}),n.jsxs("span",{children:["Voc est atualizando seu perfil de estilo. ",n.jsx("strong",{className:"text-foreground/80",children:"Seus pontos sero mantidos."})]})]}),n.jsx(rme,{current:l+1,total:py.length,points:r?Y:B,pointsJustEarned:r?0:I}),n.jsxs("div",{className:`mt-8 transition-all duration-300 ease-out ${k?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[U.subtext&&n.jsx("p",{className:"text-[11px] tracking-[0.2em] uppercase text-foreground/40 font-medium mb-4 animate-slide-in-up",children:U.subtext}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mb-8 animate-slide-in-up",style:{animationDelay:"50ms"},children:U.question}),Z&&n.jsx("div",{className:"animate-slide-in-up",style:{animationDelay:"100ms"},children:n.jsx(ome,{userId:s.id,photos:b,onPhotosChange:ie,onPointsEarned:oe})}),re&&n.jsxs("div",{className:"animate-slide-in-up",style:{animationDelay:"100ms"},children:[n.jsx("p",{className:"text-foreground/50 text-sm font-light mb-5 leading-relaxed",children:"Cores favoritas, ocasies especiais, peas que ama ou evita  tudo conta."}),n.jsx(rs,{value:v,onChange:ce=>y(ce.target.value),placeholder:"Ex: Adoro peas confortveis pra trabalhar de casa, gosto muito de azul e verde, evito estampas muito grandes...",className:"min-h-[140px] border-border bg-transparent focus:ring-1 focus:ring-foreground/20 focus:border-foreground/30 transition-all font-light text-sm placeholder:text-foreground/25 resize-none"}),v.trim()&&n.jsx("p",{className:"text-[11px] text-foreground/40 mt-3 tracking-wide",children:"Quanto mais detalhes, mais precisa ser a sua curadoria."})]}),X&&n.jsx("div",{className:"animate-slide-in-up",style:{animationDelay:"100ms"},children:n.jsx(ame,{selectedLetterSize:m,selectedNumberSize:g,onSelectLetter:H,onSelectNumber:ee})}),U.type==="single"&&n.jsx("div",{className:"space-y-3",children:(pe=U.options)==null?void 0:pe.map((ce,ne)=>n.jsx("div",{className:"animate-slide-in-up",style:{animationDelay:`${100+ne*50}ms`},children:n.jsx(LV,{text:ce.text,emoji:ce.emoji,imageUrl:ce.imageUrl,isSelected:h===ne,onClick:()=>V(ne)})},ne))})]},l),n.jsxs("div",{className:"mt-10 flex gap-4",children:[l>0&&n.jsx("button",{onClick:ue,disabled:R||k,className:"px-6 py-3.5 border border-foreground/20 text-xs tracking-[0.2em] uppercase font-medium text-foreground/60 transition-all duration-300 hover:border-foreground/40 hover:text-foreground disabled:opacity-40",children:"Voltar"}),n.jsx("button",{onClick:se,disabled:!W||R||k,className:"flex-1 py-3.5 bg-foreground text-background text-xs tracking-[0.2em] uppercase font-medium transition-all duration-500 hover:bg-accent disabled:opacity-30 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:R?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 animate-spin"}),"Preparando seu resultado"]}):$?"Descobrir meu estilo":Z?b.length>0?"Continuar":"Pular esta etapa":re?v.trim()?"Continuar":"Pular esta etapa":"Prxima"})]})]})]})):n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Nl,{className:"h-8 w-8 text-muted-foreground mx-auto mb-4"}),n.jsx("p",{className:"text-muted-foreground",children:"Redirecionando para login..."})]})})};function S_({href:e,variant:t="primary",label:r="Falar no WhatsApp",showMicrocopy:s=!1,className:a}){return t==="circle"?n.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer","aria-label":"Falar no WhatsApp",onClick:i=>i.stopPropagation(),className:He("flex items-center justify-center w-10 h-10 rounded-full","bg-[#25D366] text-white","hover:bg-[#1EBE5D] active:bg-[#18A84F]","transition-colors",a),children:n.jsx(nn,{className:"h-5 w-5"})}):n.jsxs("div",{className:"w-full",children:[n.jsxs("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:He("flex items-center justify-center gap-2 w-full h-12","bg-[#25D366] text-white font-medium","rounded-xl","hover:bg-[#1EBE5D] active:bg-[#18A84F]","transition-colors",a),children:[n.jsx(nn,{className:"h-5 w-5"}),r]}),s&&n.jsxs("p",{className:"text-center text-xs text-muted-foreground mt-2",children:["Abrimos o WhatsApp com a mensagem pronta ",""]})]})}function $V({completedMissions:e,currentPoints:t,currentLevel:r}){const s=qx(e),a=[...qx([])];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-end justify-between",children:[n.jsx("h3",{className:"font-serif text-xl",children:"Aprofunde seu perfil"}),n.jsxs("span",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/40",children:[e.length," de ",a.length," concludas"]})]}),n.jsx("p",{className:"text-sm text-foreground/50 font-light leading-relaxed",children:"Cada mdulo refina sua curadoria em uma rea especfica  quanto mais eu te conhecer, melhores sero as sugestes."}),n.jsx("div",{className:"grid gap-3",children:a.map(i=>{const o=e.includes(i.id);return n.jsx(cme,{mission:i,isCompleted:o},i.id)})}),s.length===0&&n.jsxs("div",{className:"text-center py-10 border border-border",children:[n.jsx(mn,{className:"h-8 w-8 text-foreground/30 mx-auto mb-3"}),n.jsx("p",{className:"text-sm font-light text-foreground/60",children:"Todos os mdulos concludos"}),n.jsx("p",{className:"text-[11px] text-foreground/40 mt-1 tracking-wide",children:"Novos mdulos em breve"})]})]})}function cme({mission:e,isCompleted:t}){const r=e.questions.length;return n.jsx("div",{className:He("border p-5 transition-all duration-300",t?"border-foreground/10 bg-foreground/[0.02]":"border-border hover:border-foreground/30"),children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:He("text-sm tracking-wide",t?"text-foreground/50":"font-medium"),children:e.title}),t&&n.jsx(mn,{className:"h-3.5 w-3.5 text-foreground/30 shrink-0"})]}),n.jsx("p",{className:"text-[12px] text-foreground/40 font-light",children:e.subtitle}),n.jsxs("p",{className:"text-[11px] text-foreground/30 mt-1.5 tracking-wide",children:[r," perguntas + referncias visuais"]})]}),n.jsx("div",{className:"shrink-0",children:t?n.jsx("span",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/30 font-medium",children:"Concluda"}):n.jsx(Ft,{to:`/missao/${e.id}`,children:n.jsxs("button",{className:"px-5 py-2.5 border border-foreground/20 text-[11px] tracking-[0.15em] uppercase font-medium text-foreground/60 transition-all duration-300 hover:border-foreground hover:text-foreground flex items-center gap-2",children:["Iniciar",n.jsx(hs,{className:"h-3 w-3"})]})})})]})})}const dme=()=>{var E,N,C,k,M,U,$;const{customerId:e}=ta(),t=wc();qn();const{addItem:r}=Lu(),{fireConfetti:s}=gk(),{loyalty:a}=i1(),[i,o]=P.useState(null),[l,d]=P.useState([]),[c,u]=P.useState([]),[h,f]=P.useState(!0),[m,p]=P.useState(!1),[g,x]=P.useState(0),v=(E=t.state)==null?void 0:E.aiAnalysis,y=((N=t.state)==null?void 0:N.totalPoints)||0,b=(C=t.state)==null?void 0:C.sizeLetter,j=(k=t.state)==null?void 0:k.sizeNumber,T=(M=t.state)==null?void 0:M.showCelebration,O=(U=t.state)==null?void 0:U.profile;P.useEffect(()=>{y>0?x(y):a!=null&&a.currentPoints&&x(a.currentPoints)},[y,a]),P.useEffect(()=>{T&&!m&&!h&&(p(!0),setTimeout(()=>{s({type:"celebration"})},500))},[T,m,h,s]);const R=i!=null&&i.style_title?Object.values(rC).find(X=>X.title===i.style_title):v!=null&&v.styleId?rC[v.styleId]:O||null,{level:D,title:B}=ef(g),q=(v==null?void 0:v.highlights)||(R==null?void 0:R.highlights)||["Voc valoriza qualidade sobre quantidade","Seu olhar  atrado por cortes impecveis","Voc sabe o poder de uma boa escolha"],Y=(v==null?void 0:v.valorizes)||(R==null?void 0:R.valorizes)||["estilo","conforto","versatilidade"];P.useEffect(()=>{async function X(){if(e)try{const{data:Z,error:re}=await le.from("customers").select("*").eq("id",e).single();if(re)throw re;o(Z);const W=b||Z.size_letter,J=j||Z.size_number;let V=le.from("product_catalog").select("*").eq("is_active",!0);const{data:H,error:ee}=await V.limit(50);if(ee)throw ee;const ie=(H||[]).filter(pe=>{const ce=pe.stock_by_size;return ce?(ce.UN||0)>0||W&&(ce[W]||0)>0||J&&(ce[J]||0)>0?!0:!W&&!J?Object.values(ce).some(me=>me>0):!1:!1}),oe=(v==null?void 0:v.tags)||(R==null?void 0:R.tags)||[],se=ie.map(pe=>{let ce=0;pe.style&&oe.includes(pe.style)&&(ce+=3);const ne=pe.tags||[];return oe.forEach(me=>{ne.some(ge=>ge.toLowerCase().includes(me.toLowerCase()))&&(ce+=1)}),pe.category&&((v==null?void 0:v.keyPieces)||(R==null?void 0:R.keyPieces)||[]).some(me=>{var ge;return me.toLowerCase().includes(((ge=pe.category)==null?void 0:ge.toLowerCase())||"")})&&(ce+=2),{...pe,score:ce}}).sort((pe,ce)=>ce.score-pe.score);d(se.slice(0,12));const ue=G(se,v||R);u(ue)}catch(Z){console.error("Error loading data:",Z),de.error("Erro ao carregar resultados")}finally{f(!1)}}X()},[e,v,b,j]);const G=(X,Z)=>{var V;if(X.length<3)return[];const re=[],W=new Set,J=((V=v==null?void 0:v.keyPieces)==null?void 0:V.slice(0,3).map((H,ee)=>`Look ${H}`))||["Look Principal","Look Alternativo","Look Verstil"];for(let H=0;H<3&&W.size<X.length;H++){const ee=[];for(const ie of X)if(!W.has(ie.id)&&ee.length<3&&(ee.push(ie),W.add(ie.id)),ee.length>=2&&(ee.length>=3||W.size>=X.length-2))break;ee.length>=2&&re.push({name:J[H]||`Look ${H+1}`,products:ee})}return re},I=X=>{const Z=b||(i==null?void 0:i.size_letter),re=j||(i==null?void 0:i.size_number),W=X.stock_by_size;let J=null;if(W&&((W.UN||0)>0?J="UN":Z&&(W[Z]||0)>0?J=Z:re&&(W[re]||0)>0&&(J=re)),!J){de.error("Tamanho no disponvel");return}r({productId:X.id,name:X.name,price:X.price,originalPrice:X.price,discountPercent:0,size:J,imageUrl:X.image_url||void 0}),de.success("Adicionado ao carrinho!")},F=()=>`Ol!  Fiz o quiz do Provador VIP e descobri que sou "${(v==null?void 0:v.styleTitle)||(R==null?void 0:R.title)||"meu estilo"}"! 

Ganhei ${g} pontos e cheguei no nvel ${D} (${B})! 

${(v==null?void 0:v.description)||(R==null?void 0:R.description)||""}

Quero ver mais looks que combinam com meu estilo! `,S=X=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(X);return h?n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Gr,{className:"h-8 w-8 animate-pulse-soft mx-auto mb-4 text-accent"}),n.jsx("p",{className:"text-muted-foreground",children:"Preparando seu resultado..."})]})}):i?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("div",{className:"bg-gradient-to-r from-amber-500/20 via-accent/20 to-amber-500/20 border-b border-amber-500/30",children:n.jsx("div",{className:"container mx-auto px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm animate-slide-in-up",children:[n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx(wi,{className:"h-4 w-4 text-amber-500 fill-amber-500 animate-pulse"}),n.jsxs("span",{className:"font-bold text-amber-700",children:[g," pontos"]})]}),n.jsx("div",{className:"w-px h-4 bg-amber-500/30"}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx(ma,{className:"h-4 w-4 text-accent"}),n.jsxs("span",{className:"font-medium",children:["Nvel ",D,": ",B]})]})]})})}),n.jsx("section",{className:"py-10 md:py-14 bg-gradient-to-b from-secondary/50 to-background",children:n.jsx("div",{className:"container mx-auto px-4 max-w-3xl text-center",children:n.jsxs("div",{className:"animate-bounce-in",children:[n.jsx("span",{className:"text-6xl mb-4 block animate-float",children:(R==null?void 0:R.emoji)||""}),n.jsx("p",{className:"text-sm text-accent font-medium mb-2 animate-slide-in-up",style:{animationDelay:"100ms"},children:"Seu estilo predominante :"}),n.jsx("h1",{className:"font-serif text-3xl md:text-5xl mb-3 animate-slide-in-up",style:{animationDelay:"200ms"},children:(v==null?void 0:v.styleTitle)||(R==null?void 0:R.title)||i.style_title}),n.jsx("p",{className:"text-accent text-lg mb-6 animate-slide-in-up",style:{animationDelay:"300ms"},children:(v==null?void 0:v.styleSubtitle)||(R==null?void 0:R.subtitle)}),n.jsx("div",{className:"bg-card border border-border rounded-2xl p-6 max-w-xl mx-auto mb-6 animate-slide-in-up",style:{animationDelay:"400ms"},children:n.jsx("div",{className:"space-y-3",children:q.map((X,Z)=>n.jsxs("div",{className:"flex items-start gap-3 text-left",children:[n.jsx(mn,{className:"h-5 w-5 text-accent shrink-0 mt-0.5"}),n.jsx("p",{className:"text-foreground",children:X})]},Z))})}),n.jsxs("div",{className:"bg-accent/10 border border-accent/30 rounded-xl p-4 max-w-lg mx-auto mb-6 animate-slide-in-up",style:{animationDelay:"500ms"},children:[n.jsxs("p",{className:"text-sm font-medium text-accent mb-2 flex items-center justify-center gap-2",children:[n.jsx(use,{className:"h-4 w-4"}),"Suas melhores escolhas valorizam:"]}),n.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:Y.map((X,Z)=>n.jsx("span",{className:"px-3 py-1 bg-card border border-border rounded-full text-sm font-medium",children:X},Z))})]}),(v==null?void 0:v.personalTip)&&n.jsxs("div",{className:"bg-amber-50/80 border border-amber-200 rounded-xl p-4 max-w-lg mx-auto mb-6 animate-slide-in-up",style:{animationDelay:"600ms"},children:[n.jsx("p",{className:"text-sm font-medium text-amber-700 mb-1",children:" Dica da sua consultora"}),n.jsx("p",{className:"text-sm text-amber-900",children:v.personalTip})]}),((v==null?void 0:v.colorPalette)||(R==null?void 0:R.colorPalette))&&n.jsxs("div",{className:"mt-6 animate-slide-in-up",style:{animationDelay:"700ms"},children:[n.jsxs("p",{className:"text-sm text-muted-foreground mb-2 flex items-center justify-center gap-2",children:[n.jsx(n_,{className:"h-4 w-4"}),"Suas cores"]}),n.jsx("div",{className:"flex items-center justify-center gap-2",children:($=(v==null?void 0:v.colorPalette)||(R==null?void 0:R.colorPalette))==null?void 0:$.map((X,Z)=>n.jsx("span",{className:"px-3 py-1 bg-card border border-border rounded-full text-sm",children:X},Z))})]}),(b||j||(i==null?void 0:i.size_letter)||(i==null?void 0:i.size_number))&&n.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 bg-primary/10 px-4 py-2 rounded-full flex-wrap justify-center",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Seus tamanhos:"}),(b||(i==null?void 0:i.size_letter))&&n.jsx("span",{className:"font-bold",children:b||(i==null?void 0:i.size_letter)}),(b||(i==null?void 0:i.size_letter))&&(j||(i==null?void 0:i.size_number))&&n.jsx("span",{className:"text-muted-foreground",children:"e"}),(j||(i==null?void 0:i.size_number))&&n.jsx("span",{className:"font-bold",children:j||(i==null?void 0:i.size_number)})]})]})})}),c.length>0&&n.jsx("section",{className:"py-10 md:py-14",children:n.jsxs("div",{className:"container mx-auto px-4",children:[n.jsx("h2",{className:"font-serif text-2xl md:text-3xl text-center mb-2",children:"Sugestes de looks pra voc"}),n.jsx("p",{className:"text-center text-muted-foreground mb-8",children:"Todas as peas tm estoque no seu tamanho "}),n.jsx("div",{className:"space-y-8 max-w-5xl mx-auto",children:c.map((X,Z)=>n.jsxs("div",{className:"bg-card rounded-2xl p-5 border border-border",children:[n.jsxs("h3",{className:"font-serif text-xl mb-4 flex items-center gap-2",children:[n.jsx("span",{className:"w-8 h-8 rounded-full bg-accent/10 text-accent flex items-center justify-center text-sm font-medium",children:Z+1}),X.name]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:X.products.map(re=>n.jsxs("div",{className:"relative group",children:[n.jsx(Ft,{to:`/produto/${re.id}`,children:n.jsx(Qh,{name:re.name,price:re.price,imageUrl:re.image_url||void 0,sizes:re.sizes||[],badge:"Tem no seu tamanho"})}),n.jsxs(he,{size:"sm",variant:"secondary",className:"absolute bottom-4 right-2 opacity-0 group-hover:opacity-100 transition-opacity gap-1",onClick:()=>I(re),children:[n.jsx(bl,{className:"h-3 w-3"}),"Quero"]})]},re.id))}),n.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total do look: ",n.jsx("span",{className:"font-semibold text-foreground",children:S(X.products.reduce((re,W)=>re+W.price,0))})]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>X.products.forEach(re=>I(re)),children:[n.jsx(hn,{className:"h-4 w-4 mr-1"}),"Quero esse look"]})]})]},Z))})]})}),l.length>0&&n.jsx("section",{className:"py-10 md:py-14 bg-secondary/30",children:n.jsxs("div",{className:"container mx-auto px-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"font-serif text-2xl md:text-3xl",children:"Mais peas que combinam com voc"}),n.jsx(Ft,{to:"/catalogo",children:n.jsxs(he,{variant:"outline",className:"gap-2",children:["Ver catlogo",n.jsx(hs,{className:"h-4 w-4"})]})})]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6",children:l.slice(0,8).map(X=>n.jsx(Ft,{to:`/produto/${X.id}`,children:n.jsx(Qh,{name:X.name,price:X.price,imageUrl:X.image_url||void 0,sizes:X.sizes||[],badge:"Combina com voc"})},X.id))}),l.length===0&&n.jsx("p",{className:"text-center text-muted-foreground",children:"Estamos preparando looks especiais para voc!"})]})}),n.jsx("section",{className:"py-10 md:py-14 bg-gradient-to-b from-background to-secondary/30",children:n.jsxs("div",{className:"container mx-auto px-4 max-w-2xl",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("p",{className:"text-[10px] tracking-[0.3em] uppercase text-foreground/40 font-medium mb-4",children:"Prximo passo"}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mb-2",children:"Aprofunde seu perfil"}),n.jsx("p",{className:"text-foreground/50 font-light",children:"Responda mdulos especficos para refinar ainda mais a sua curadoria"})]}),n.jsx($V,{completedMissions:[],currentPoints:g,currentLevel:D})]})}),n.jsx("section",{className:"py-10 md:py-14",children:n.jsxs("div",{className:"container mx-auto px-4 max-w-md",children:[n.jsxs("div",{className:"bg-card rounded-2xl p-6 border border-border shadow-sm",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx(nn,{className:"h-10 w-10 mx-auto text-whatsapp mb-3"}),n.jsx("h3",{className:"font-serif text-xl mb-2",children:"Fale com sua consultora"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Receba mais sugestes personalizadas no WhatsApp!"})]}),n.jsx(S_,{href:`https://wa.me/5511999999999?text=${encodeURIComponent(F())}`,label:"Conversar no WhatsApp"})]}),n.jsxs("div",{className:"mt-6 text-center space-y-2",children:[n.jsx(Ft,{to:"/minha-conta",children:n.jsxs(he,{variant:"ghost",className:"gap-2 w-full",children:[n.jsx(Gr,{className:"h-4 w-4"}),"Ver minhas sugestes"]})}),n.jsx(Ft,{to:"/quiz",children:n.jsxs(he,{variant:"ghost",className:"gap-2",children:[n.jsx(hs,{className:"h-4 w-4 rotate-180"}),"Refazer o quiz"]})})]})]})})]}):n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-muted-foreground mb-4",children:"Resultado no encontrado"}),n.jsx(Ft,{to:"/quiz",children:n.jsx(he,{children:"Fazer o quiz novamente"})})]})})};function ume({missionId:e,userId:t,theme:r,photoPrompt:s,maxPhotos:a=5,onPhotosChange:i,onPointsEarned:o}){const[l,d]=P.useState([]),[c,u]=P.useState(!1),h=P.useRef(null),f=async x=>{const v=x.target.files;if(!v||v.length===0)return;const y=a-l.length,b=Array.from(v).slice(0,y);b.length<v.length&&de.info(`Mximo de ${a} fotos permitidas`),u(!0);for(const j of b)await m(j);u(!1),h.current&&(h.current.value="")},m=async x=>{try{const y=`${Date.now()}-${x.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,b=`${t}/missions/${e}/${y}`,{error:j}=await le.storage.from("prints").upload(b,x,{cacheControl:"3600",upsert:!1});if(j)throw j;const{data:T}=le.storage.from("prints").getPublicUrl(b),O=T.publicUrl,R={url:O,analysis:null,isAnalyzing:!0};d(D=>{const B=[...D,R];return i(B),B}),o(50);try{const{data:D,error:B}=await le.functions.invoke("analyze-product-image",{body:{image_url:O}});B&&console.error("Analysis error:",B),d(q=>{const Y=q.map(G=>G.url===O?{...G,analysis:(D==null?void 0:D.analysis)||null,isAnalyzing:!1}:G);return i(Y),Y})}catch(D){console.error("Failed to analyze:",D),d(B=>{const q=B.map(Y=>Y.url===O?{...Y,isAnalyzing:!1}:Y);return i(q),q})}}catch(v){console.error("Upload error:",v),de.error("Erro ao enviar foto")}},p=x=>{d(v=>{const y=v.filter(b=>b.url!==x);return i(y),y})},g=l.length<a;return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"inline-flex items-center gap-2 bg-accent/10 px-4 py-2 rounded-full mb-3",children:[n.jsx(ka,{className:"h-4 w-4 text-accent"}),n.jsx("span",{className:"text-sm font-medium text-accent",children:"Etapa opcional: +50pts por foto"})]}),n.jsx("p",{className:"text-muted-foreground text-sm",children:s})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[l.map((x,v)=>n.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden border-2 border-accent/30 bg-secondary",children:[n.jsx("img",{src:x.url,alt:`Inspirao ${v+1}`,className:"w-full h-full object-cover"}),x.isAnalyzing&&n.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:n.jsx(Et,{className:"h-6 w-6 text-white animate-spin"})}),x.analysis&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2",children:n.jsxs("div",{className:"flex items-center gap-1 text-white text-xs",children:[n.jsx(Gr,{className:"h-3 w-3"}),n.jsx("span",{className:"truncate",children:x.analysis.estilo||x.analysis.cor||"Analisado"})]})}),n.jsx("button",{onClick:()=>p(x.url),className:"absolute top-1 right-1 w-6 h-6 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-red-500 transition-colors",children:n.jsx(sn,{className:"h-4 w-4"})}),!x.isAnalyzing&&n.jsx("div",{className:"absolute top-1 left-1 w-6 h-6 rounded-full bg-green-500 text-white flex items-center justify-center",children:n.jsx(gn,{className:"h-4 w-4"})})]},x.url)),g&&n.jsx("button",{onClick:()=>{var x;return(x=h.current)==null?void 0:x.click()},disabled:c,className:He("aspect-square rounded-xl border-2 border-dashed border-accent/30 flex flex-col items-center justify-center gap-2 text-muted-foreground hover:border-accent hover:text-accent transition-colors",c&&"opacity-50 cursor-not-allowed"),children:c?n.jsx(Et,{className:"h-6 w-6 animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(ka,{className:"h-6 w-6"}),n.jsx("span",{className:"text-xs",children:"Adicionar"})]})})]}),n.jsx("input",{ref:h,type:"file",accept:"image/*",multiple:!0,onChange:f,className:"hidden"}),n.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[l.length,"/",a," fotos ",l.length>0&&n.jsxs("span",{className:"text-amber-600 font-medium ml-1",children:["+",l.length*50," pts"]})]})]})}function hme({mission:e,earnedPoints:t,totalPoints:r,previousLevel:s,newLevel:a,nextMissionId:i,nextMissionName:o}){const l=pr(),{title:d}=ef(r),c=a>s;return n.jsxs("div",{className:"text-center animate-fade-in",children:[n.jsx("div",{className:"w-16 h-16 mx-auto mb-8 border border-foreground/10 rounded-full flex items-center justify-center",children:n.jsx(Sr,{className:"h-7 w-7 text-foreground/40"})}),n.jsx("h1",{className:"font-serif text-3xl mb-2",children:"Mdulo concludo"}),n.jsx("p",{className:"text-foreground/50 font-light mb-8",children:e.title}),n.jsx("div",{className:"border border-foreground/10 p-5 mb-8 max-w-sm mx-auto",children:n.jsx("p",{className:"text-sm text-foreground/60 font-light",children:"Suas sugestes de estilo foram refinadas com base nas suas respostas."})}),n.jsxs("div",{className:"border border-foreground/10 p-6 mb-8 max-w-sm mx-auto",children:[n.jsx("p",{className:"text-[11px] tracking-[0.2em] uppercase text-foreground/40 mb-3",children:"Pontos conquistados"}),n.jsxs("p",{className:"text-2xl font-light text-foreground",children:["+",t]}),c&&n.jsx("div",{className:"border-t border-foreground/10 mt-4 pt-4",children:n.jsxs("p",{className:"text-sm text-foreground/60",children:["Voc subiu para ",n.jsx("span",{className:"font-medium text-foreground",children:d})]})}),n.jsxs("p",{className:"text-[11px] text-foreground/30 mt-3 tracking-wide",children:[d,"  ",r," pontos acumulados"]})]}),n.jsxs("div",{className:"space-y-3 max-w-sm mx-auto",children:[n.jsx("button",{onClick:()=>l("/minhas-sugestoes"),className:"w-full py-3.5 bg-foreground text-background text-xs tracking-[0.2em] uppercase font-medium transition-all duration-300 hover:bg-accent",children:"Ver minhas sugestes atualizadas"}),i&&n.jsxs("button",{onClick:()=>l(`/missao/${i}`),className:"w-full py-3.5 border border-foreground/20 text-xs tracking-[0.2em] uppercase font-medium text-foreground/60 transition-all duration-300 hover:border-foreground hover:text-foreground flex items-center justify-center gap-2",children:["Prximo mdulo",n.jsx(hs,{className:"h-3.5 w-3.5"})]}),n.jsx("button",{onClick:()=>l("/minha-conta"),className:"w-full py-3 text-xs tracking-[0.15em] uppercase text-foreground/40 hover:text-foreground/60 transition-colors",children:"Voltar para minha conta"})]}),i&&o&&n.jsxs("div",{className:"mt-8 text-[11px] text-foreground/30 tracking-wide",children:[n.jsx("p",{children:"Prximo mdulo recomendado:"}),n.jsx("p",{className:"font-medium text-foreground/50 mt-0.5",children:o})]})]})}const fme=()=>{const e=pr(),{missionId:t}=ta(),{user:r,isLoading:s}=qn(),{firePoints:a,fireLevelUp:i,fireConfetti:o}=gk(),[l,d]=P.useState(null),[c,u]=P.useState(0),[h,f]=P.useState([]),[m,p]=P.useState(null),[g,x]=P.useState([]),[v,y]=P.useState(0),[b,j]=P.useState(!1),[T,O]=P.useState(!1),[R,D]=P.useState(!1),[B,q]=P.useState(10),[Y,G]=P.useState(1),[I,F]=P.useState(0),[S,E]=P.useState(0),[N,C]=P.useState(1),[k,M]=P.useState(!1),[U,$]=P.useState(null),[X,Z]=P.useState(null);P.useEffect(()=>{if(!s&&!r){e("/entrar?redirect=/missao/"+t,{replace:!0});return}const me=dw(t||"");if(!me){de.error("Misso no encontrada"),e("/minha-conta");return}d(me),r&&re()},[t,r,s,e]);const re=async()=>{if(!r||!t)return;const{data:me}=await le.from("profiles").select("quiz_points, quiz_level, completed_missions").eq("user_id",r.id).single();if(me){F(me.quiz_points||0),G(me.quiz_level||1);const _e=me.completed_missions||[];if(_e.includes(t)){de.info("Voc j completou essa misso!"),e("/minha-conta");return}const be=qx([..._e,t]);be.length>0&&Z({id:be[0].id,name:be[0].title})}const{data:ge}=await le.from("mission_attempts").select("*").eq("user_id",r.id).eq("mission_id",t).eq("status","in_progress").maybeSingle();if(ge){$(ge.id),u(ge.current_question||0);const _e=ge.answers_json;if(f(_e||[]),ge.images_urls&&ge.images_urls.length>0){const be=ge.images_urls.map(ye=>({url:ye,analysis:null,isAnalyzing:!1}));x(be),y(be.length*oo.photoUpload)}}};if(!l||s)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-accent"})});const W=l.questions.length,J=c===W,V=c===W-1,H=J?null:l.questions[c],ee=me=>{p(me)},ie=me=>{x(me)},oe=me=>{y(ge=>ge+me),q(me),D(!0),a(me)},se=async(me,ge)=>{if(!r||!t)return;const _e={user_id:r.id,mission_id:t,status:"in_progress",current_question:me,answers_json:JSON.parse(JSON.stringify(ge)),images_urls:g.map(be=>be.url),score_earned:0};if(U)await le.from("mission_attempts").update(_e).eq("id",U);else{const{data:be}=await le.from("mission_attempts").insert([_e]).select("id").single();be&&$(be.id)}},ue=async()=>{if(!(!r||!l)){j(!0);try{const ge=h.length*oo.perQuestion+v+oo.completionBonus,_e=I+ge,{level:be}=ef(_e);E(ge),C(be);const ye=g.filter(Ge=>Ge.analysis).map(Ge=>JSON.parse(JSON.stringify(Ge.analysis)));U?await le.from("mission_attempts").update({status:"completed",completed_at:new Date().toISOString(),score_earned:ge,images_urls:g.map(Ge=>Ge.url),analysis_json:JSON.parse(JSON.stringify({photos:ye}))}).eq("id",U):await le.from("mission_attempts").insert([{user_id:r.id,mission_id:l.id,status:"completed",completed_at:new Date().toISOString(),current_question:W,answers_json:JSON.parse(JSON.stringify(h)),score_earned:ge,images_urls:g.map(Ge=>Ge.url),analysis_json:JSON.parse(JSON.stringify({photos:ye}))}]),await le.from("missions_log").insert([{user_id:r.id,mission_id:l.id,points_earned:ge,answers:JSON.parse(JSON.stringify(h))}]);const{error:Oe}=await le.rpc("award_loyalty_points",{p_user_id:r.id,p_points:ge,p_description:`Misso: ${l.title}`,p_mission_id:l.id});Oe&&console.error("Error awarding loyalty points:",Oe);const{data:Ne}=await le.from("profiles").select("completed_missions, quiz_points, quiz_level").eq("user_id",r.id).single(),De=[...(Ne==null?void 0:Ne.completed_missions)||[],l.id];await le.from("profiles").update({quiz_points:_e,quiz_level:be,completed_missions:De,last_mission_id:l.id,last_mission_completed_at:new Date().toISOString(),suggestions_updated_at:new Date().toISOString()}).eq("user_id",r.id),be>Y&&setTimeout(()=>{i(),de.success(` Voc subiu para o Nvel ${be}!`)},500),o({type:"celebration"}),F(_e),O(!0)}catch(me){console.error("Error completing mission:",me),de.error("Erro ao salvar misso")}finally{j(!1)}}},pe=async()=>{if(J){await ue();return}if(m===null||!H)return;const me=H.options[m],ge={questionId:H.id,answer:me.text,styleBonus:me.styleBonus},_e=[...h,ge];f(_e),q(oo.perQuestion),D(!0),a(oo.perQuestion),await se(c+1,_e),M(!0),setTimeout(()=>{u(c+1),p(null),M(!1)},300)},ce=()=>{c>0&&(M(!0),setTimeout(()=>{J?u(W-1):(u(c-1),f(h.slice(0,-1))),p(null),M(!1)},150))},ne=async()=>{await ue()};return T?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("main",{className:"container mx-auto px-4 py-12 max-w-lg",children:n.jsx(hme,{mission:l,earnedPoints:S,totalPoints:I,previousLevel:Y,newLevel:N,nextMissionId:X==null?void 0:X.id,nextMissionName:X==null?void 0:X.name})})]}):n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(Nr,{}),n.jsx(BV,{points:B,show:R,onComplete:()=>D(!1)}),n.jsxs("main",{className:"flex-1 container mx-auto px-4 py-6 max-w-2xl",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("p",{className:"text-[10px] tracking-[0.3em] uppercase text-foreground/40 font-medium mb-3",children:l.title}),n.jsx("p",{className:"text-sm text-foreground/50 font-light",children:l.subtitle})]}),n.jsxs("div",{className:"mb-8",children:[n.jsx("div",{className:"h-px bg-border relative",children:n.jsx("div",{className:"h-px bg-foreground transition-all duration-700 ease-out",style:{width:`${(c+1)/(W+1)*100}%`}})}),n.jsxs("div",{className:"flex justify-between mt-2.5",children:[n.jsx("span",{className:"text-[11px] text-foreground/40 tracking-wide",children:J?"Referncias visuais":`${c+1} de ${W}`}),n.jsxs("span",{className:"text-[11px] text-foreground/40 tracking-wide",children:[Math.round((c+1)/(W+1)*100),"%"]})]})]}),n.jsx("div",{className:He("transition-all duration-300 ease-out",k?"opacity-0 translate-y-4":"opacity-100 translate-y-0"),children:J?n.jsx(ume,{missionId:l.id,userId:(r==null?void 0:r.id)||"",theme:l.theme,photoPrompt:l.photoPrompt,maxPhotos:5,onPhotosChange:ie,onPointsEarned:oe}):H&&n.jsxs(n.Fragment,{children:[H.subtext&&n.jsx("p",{className:"text-[11px] tracking-[0.2em] uppercase text-foreground/40 font-medium mb-4 animate-slide-in-up",children:H.subtext}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mb-8 animate-slide-in-up",style:{animationDelay:"50ms"},children:H.question}),n.jsx("div",{className:"space-y-3",children:H.options.map((me,ge)=>n.jsx("div",{className:"animate-slide-in-up",style:{animationDelay:`${100+ge*50}ms`},children:n.jsx(LV,{text:me.text,emoji:me.emoji,isSelected:m===ge,onClick:()=>ee(ge)})},ge))})]})},c),n.jsxs("div",{className:"mt-10 flex gap-4",children:[c>0&&n.jsx("button",{onClick:ce,disabled:b||k,className:"px-6 py-3.5 border border-foreground/20 text-xs tracking-[0.2em] uppercase font-medium text-foreground/60 transition-all duration-300 hover:border-foreground/40 hover:text-foreground disabled:opacity-40",children:"Voltar"}),J?n.jsxs("div",{className:"flex-1 flex gap-3",children:[n.jsx("button",{onClick:ne,disabled:b,className:"flex-1 py-3.5 border border-foreground/20 text-xs tracking-[0.2em] uppercase font-medium text-foreground/60 transition-all duration-300 hover:border-foreground/40 hover:text-foreground disabled:opacity-40",children:"Pular esta etapa"}),n.jsx("button",{onClick:pe,disabled:b,className:"flex-1 py-3.5 bg-foreground text-background text-xs tracking-[0.2em] uppercase font-medium transition-all duration-500 hover:bg-accent disabled:opacity-30 flex items-center justify-center gap-2",children:b?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 animate-spin"}),"Salvando"]}):"Concluir"})]}):n.jsx("button",{onClick:pe,disabled:m===null||b||k,className:"flex-1 py-3.5 bg-foreground text-background text-xs tracking-[0.2em] uppercase font-medium transition-all duration-500 hover:bg-accent disabled:opacity-30 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:b?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 animate-spin"}),"Salvando"]}):V?"Prximo: Referncias visuais":"Prxima"})]})]})]})};function FV(){const[e,t]=P.useState(!1),[r,s]=P.useState(null);return{isAnalyzing:e,analysisResult:r,analyzeImage:async o=>{t(!0),s(null);try{const d=o.startsWith("http://")||o.startsWith("https://")?{image_url:o}:{image_base64:o},{data:c,error:u}=await le.functions.invoke("analyze-product-image",{body:d});return u?(console.error("Edge function error:",u),de.error("Erro ao analisar imagem"),null):c!=null&&c.error?(de.error(c.error),null):c!=null&&c.success&&(c!=null&&c.analysis)?(s(c.analysis),de.success("Anlise concluda! Confira as sugestes."),c.analysis):null}catch(l){return console.error("Error analyzing image:",l),de.error("Erro ao conectar com o servio de anlise"),null}finally{t(!1)}},clearAnalysis:()=>{s(null)}}}const mme={default:{category:35,color:20,modeling:20,details:15,style:10},color:{category:25,color:35,modeling:20,details:10,style:10},modeling:{category:25,color:20,modeling:35,details:10,style:10},elegant:{category:25,color:20,modeling:20,details:10,style:25,tagBonus:["elegante","alfaiataria","sofisticado","clssico","chic"]},casual:{category:25,color:20,modeling:20,details:10,style:25,tagBonus:["casual","dia a dia","bsico","confortvel","despojado"]},category:{category:45,color:20,modeling:20,details:10,style:5}};function Yd(e){return e?e.toLowerCase().trim().replace(/[_-]/g," "):""}function k0(e,t){const r=Yd(e),s=Yd(t);return!r||!s?!1:r===s}function pme(e,t){if(k0(e,t))return!0;const r={neutro:["preto","branco","cinza","bege","nude","off white","creme","areia"],quente:["vermelho","laranja","amarelo","dourado","coral","terracota","mostarda"],frio:["azul","verde","roxo","prata","turquesa","menta","lavanda"],rosa:["rosa","pink","magenta","coral","salmo","blush"],marrom:["marrom","caramelo","chocolate","caf","terra","camel"],vinho:["vinho","bord","marsala","burgundy","cereja"]},s=Yd(e),a=Yd(t);for(const i of Object.values(r)){const o=i.some(d=>s.includes(d)),l=i.some(d=>a.includes(d));if(o&&l)return!0}return!1}function gme(e,t,r){if(!e)return!1;if(e.UN&&e.UN>0||e.U&&e.U>0)return!0;for(const s of t){const a=s.toUpperCase().trim();if(e[a]&&e[a]>0)return!0}for(const s of r){const a=s.trim();if(e[a]&&e[a]>0)return!0}return!1}function xme(e,t,r="default"){var h,f,m,p,g;const s=mme[r];let a=0;const i=[],o={category:!1,color:!1,style:!1,occasion:!1,modeling:!1,matchingTags:[]};k0(e.category,(h=t.categoria)==null?void 0:h.value)&&(a+=s.category,o.category=!0,i.push("categoria")),pme(e.color,(f=t.cor)==null?void 0:f.value)&&(a+=s.color,o.color=!0,i.push("cor")),k0(e.modeling,(m=t.modelagem)==null?void 0:m.value)&&(a+=s.modeling,o.modeling=!0,i.push("modelagem")),k0(e.style,(p=t.estilo)==null?void 0:p.value)&&(a+=s.style,o.style=!0,i.push("estilo")),k0(e.occasion,(g=t.ocasiao)==null?void 0:g.value)&&(o.occasion=!0);const l=t.tags_extras||[],d=e.tags||[];let c=0;const u=3;for(const x of l){if(c>=u)break;const v=Yd(x);for(const y of d){const b=Yd(y);if(v&&b&&(v.includes(b)||b.includes(v))){c++,o.matchingTags.push(y);break}}}return c>0&&(a+=Math.round(c/u*s.details),i.push("detalhes")),s.tagBonus&&d.length>0&&s.tagBonus.some(v=>d.some(y=>Yd(y).includes(Yd(v))))&&(a+=10),{score:a,matchDetails:o,matchReasons:i}}function vme(e,t,r){const{letterSizes:s,numberSizes:a,limit:i=9,refinementMode:o="default"}=r,l=[];for(const m of e){if(!m.is_active)continue;const p=gme(m.stock_by_size,s,a),{score:g,matchDetails:x,matchReasons:v}=xme(m,t,o);l.push({id:m.id,name:m.name,price:m.price,image_url:m.image_url,sizes:m.sizes||[],stock_by_size:m.stock_by_size||{},is_active:m.is_active??!0,category:m.category,color:m.color,style:m.style,occasion:m.occasion,modeling:m.modeling,tags:m.tags||[],group_key:m.group_key,score:g,matchReasons:v,matchDetails:x,outOfStockInSelectedSize:!p,_hasStock:p})}l.sort((m,p)=>p.score-m.score);const d=l.length>0?l[0]:null,c=l.filter(m=>m._hasStock),u=c.length>0;let h=null,f=[];if(d){const{_hasStock:m,...p}=d;h=p,d._hasStock?f=c.filter(g=>g.id!==d.id).slice(0,i-1).map(({_hasStock:g,...x})=>x):f=c.slice(0,i).map(({_hasStock:g,...x})=>x)}return{identifiedProduct:h,alternatives:f,hasStockAvailable:u}}function yme(){const[e,t]=P.useState(!1),[r,s]=P.useState({identifiedProduct:null,alternatives:[],hasStockAvailable:!0}),a=P.useCallback(async(o,l)=>{t(!0);const d={identifiedProduct:null,alternatives:[],hasStockAvailable:!1};s({identifiedProduct:null,alternatives:[],hasStockAvailable:!0});try{const{data:c,error:u}=await le.from("product_catalog").select("id, name, price, image_url, sizes, stock_by_size, is_active, category, color, style, occasion, modeling, tags, group_key").eq("is_active",!0);if(u)return console.error("Error fetching products:",u),d;if(!c||c.length===0)return s(d),d;const h=c.map(m=>({...m,stock_by_size:typeof m.stock_by_size=="object"?m.stock_by_size:null})),f=vme(h,o,l);return s(f),f}catch(c){return console.error("Error finding matches:",c),d}finally{t(!1)}},[]),i=P.useCallback(()=>{s({identifiedProduct:null,alternatives:[],hasStockAvailable:!0})},[]);return{isLoading:e,identifiedProduct:r.identifiedProduct,alternatives:r.alternatives,hasStockAvailable:r.hasStockAvailable,findMatches:a,clearMatches:i}}function bme(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const wme=["PP","P","M","G","GG"],_me=["34","36","38","40","42","44","46"],jme=[{mode:"color",label:"Mais parecido com a COR"},{mode:"modeling",label:"Mais parecido com a MODELAGEM"},{mode:"category",label:"Mais parecido com a CATEGORIA"},{mode:"elegant",label:"Mais elegante"},{mode:"casual",label:"Mais casual"}],Nme=[{icon:ka,number:"01",title:"Envie sua foto",desc:"Print do Instagram, selfie no espelho, foto de revista qualquer imagem serve."},{icon:Gr,number:"02",title:"IA identifica a pea",desc:"Nossa inteligncia artificial analisa cor, modelagem, tecido e estilo em segundos."},{icon:On,number:"03",title:"Encontre peas parecidas",desc:"Mostramos opes similares do nosso catlogo, disponveis no seu tamanho."}],Sme=[{icon:Qr,label:"Troca fcil",desc:"Sem burocracia"},{icon:ms,label:"3x sem juros",desc:"No carto"},{icon:nn,label:"Suporte WhatsApp",desc:"Resposta rpida"},{icon:yn,label:"Envio Brasil",desc:"Todo o pas"}],Cme=()=>{const e=pr(),{addItem:t}=Lu(),{user:r}=qn(),[s,a]=P.useState(1),[i,o]=P.useState(null),[l,d]=P.useState(null),[c,u]=P.useState([]),[h,f]=P.useState([]),[m,p]=P.useState("default"),{isAnalyzing:g,analysisResult:x,analyzeImage:v,clearAnalysis:y}=FV(),{isLoading:b,identifiedProduct:j,alternatives:T,hasStockAvailable:O,findMatches:R,clearMatches:D}=yme(),B=[...c,...h].join(" / ")||"",q=c.length>0||h.length>0,Y=$=>{u(X=>X.includes($)?X.filter(Z=>Z!==$):[...X,$])},G=$=>{f(X=>X.includes($)?X.filter(Z=>Z!==$):[...X,$])},I=$=>{var Z;const X=(Z=$.target.files)==null?void 0:Z[0];if(X){o(X);const re=new FileReader;re.onloadend=()=>{d(re.result)},re.readAsDataURL(X),y(),D(),p("default")}},F=async()=>{if(!l){de.error("Envie uma imagem primeiro");return}await v(l)&&a(2)},S=async()=>{if(!(!x||!i)){try{const $=`${Date.now()}-${i.name}`,{error:X}=await le.storage.from("prints").upload($,i);X||await le.from("print_requests").insert({image_path:$,size:B||null,user_id:(r==null?void 0:r.id)||null,status:"pending"})}catch($){console.error("Error saving print request:",$)}await R(x,{letterSizes:c,numberSizes:h,refinementMode:"default"}),a(3)}},E=async $=>{if(!x)return;const X=m===$?"default":$;p(X);const Z=await R(x,{letterSizes:c,numberSizes:h,refinementMode:X});!Z.identifiedProduct&&Z.alternatives.length===0&&de.info("No encontrei produtos com esse filtro nos seus tamanhos")},N=$=>{const X=[...c,...h].find(Z=>{const re=$.stock_by_size[Z]||$.stock_by_size[Z.toUpperCase()];return re&&re>0})||c[0]||h[0]||"";t({productId:$.id,name:$.name,price:$.price,originalPrice:$.price,discountPercent:0,size:X,imageUrl:$.image_url}),de.success("Adicionado ao carrinho!"),e("/carrinho")},C=()=>{const $=c.length>0?c.join(", "):"",X=h.length>0?h.join(", "):"";let Z="";return $&&X?Z=`${$} / ${X}`:$?Z=$:X?Z=X:Z="no informado",`https://wa.me/5562991223519?text=${encodeURIComponent(`Oi! Usei o Buscar por Foto no Provador VIP 
Meu tamanho : ${Z}
Pode me ajudar a achar uma pea parecida?`)}`},k=()=>{a(1),o(null),d(null),u([]),f([]),p("default"),y(),D()},M=()=>{var Z,re,W,J;if(!x)return"";const $=x;if($.resumo_visual)return $.resumo_visual;const X=[];return(Z=$.categoria)!=null&&Z.value&&X.push($.categoria.value),(re=$.cor)!=null&&re.value&&X.push(`em tom ${$.cor.value}`),(W=$.decote)!=null&&W.value&&X.push(`com decote ${$.decote.value}`),(J=$.estilo)!=null&&J.value&&X.push(`e vibe ${$.estilo.value}`),X.length>0?`Parece ${X.join(" ")}`:"Pea identificada"},U=()=>{var $;($=document.getElementById("buscar-foto-tool"))==null||$.scrollIntoView({behavior:"smooth"})};return n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(Bm,{}),n.jsx(Nr,{}),n.jsx("section",{className:"py-14 md:py-20 px-5 text-center",children:n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsxs("span",{className:"inline-flex items-center gap-2 text-accent text-xs tracking-[0.2em] uppercase font-medium mb-4",children:[n.jsx(Gr,{className:"h-3.5 w-3.5"}),"Inteligncia Artificial"]}),n.jsxs("h1",{className:"font-serif text-3xl md:text-4xl lg:text-5xl leading-[1.15] mb-4",children:["Viu um look e"," ",n.jsxs("span",{className:"text-accent italic",children:["quer encontrar",n.jsx("br",{className:"hidden sm:block"}),"pea parecida?"]})]}),n.jsx("p",{className:"text-muted-foreground font-light text-sm md:text-base max-w-lg mx-auto leading-relaxed mb-8",children:"Envie qualquer foto  print do Instagram, selfie no espelho, inspirao do Pinterest  e a nossa IA encontra opes similares no seu tamanho em segundos."}),n.jsx("button",{onClick:U,className:"px-12 py-4 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white",children:"Enviar minha foto"}),n.jsx("p",{className:"text-[11px] text-muted-foreground mt-4 tracking-wide",children:"Grtis  Sem cadastro  Resultado em segundos"})]})}),n.jsx("section",{className:"py-14 md:py-20 px-5 bg-secondary/30",children:n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-10 md:mb-14",children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-medium",children:"Como funciona"}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mt-2 mb-3",children:"3 passos simples, resultado incrvel."}),n.jsx("p",{className:"text-muted-foreground text-sm font-light max-w-md mx-auto",children:"A ferramenta mais inteligente para encontrar looks que voc ama."})]}),n.jsx("div",{className:"grid md:grid-cols-3 gap-6 md:gap-8",children:Nme.map($=>n.jsxs("div",{className:"relative text-center group",children:[n.jsx("div",{className:"w-16 h-16 rounded-full bg-card border-2 border-border flex items-center justify-center mx-auto mb-5 shadow-sm group-hover:shadow-md group-hover:border-accent/40 transition-all duration-300",children:n.jsx($.icon,{className:"h-7 w-7 text-accent"})}),n.jsxs("span",{className:"text-[10px] tracking-[0.2em] uppercase text-accent font-semibold",children:["Passo ",$.number]}),n.jsx("h3",{className:"font-serif text-lg mt-1 mb-2",children:$.title}),n.jsx("p",{className:"text-sm text-muted-foreground font-light leading-relaxed",children:$.desc})]},$.number))})]})}),n.jsx("section",{className:"py-14 md:py-20 px-5",children:n.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-medium",children:"Funciona com tudo"}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mt-2 mb-3",children:"Qualquer foto, a gente encontra."}),n.jsx("p",{className:"text-muted-foreground text-sm font-light mb-10 max-w-md mx-auto",children:"No precisa ser foto profissional. Vale qualquer inspirao."}),n.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-4 md:gap-x-8",children:["Print do Instagram","Selfie no espelho","Foto do Pinterest","Screenshot de srie","Foto de revista","Look de amiga"].map($=>n.jsx("span",{className:"font-serif text-base md:text-lg text-foreground/60",children:$},$))})]})}),n.jsx("section",{id:"buscar-foto-tool",className:"py-14 md:py-20 px-5 bg-[hsl(35,30%,94%)]/60",children:n.jsxs("div",{className:"max-w-lg mx-auto",children:[n.jsx("div",{className:"flex items-center justify-center gap-3 mb-8",children:[1,2,3].map($=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`
                    w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium transition-all duration-300
                    ${s>=$?"bg-foreground text-background":"border-2 border-foreground/20 text-foreground/40"}
                  `,children:s>$?n.jsx(gn,{className:"h-4 w-4"}):$}),$<3&&n.jsx("div",{className:`w-8 h-px transition-colors duration-300 ${s>$?"bg-foreground":"bg-foreground/15"}`})]},$))}),s===1&&n.jsxs("div",{className:"animate-fade-in space-y-6",children:[n.jsxs("div",{className:"text-center mb-2",children:[n.jsx("h3",{className:"font-serif text-xl mb-1",children:"Envie sua foto"}),n.jsx("p",{className:"text-sm text-muted-foreground font-light",children:"Print, selfie, inspirao  qualquer imagem funciona."})]}),n.jsxs("div",{className:"border-2 border-dashed border-foreground/15 rounded-xl p-8 text-center cursor-pointer hover:border-accent/50 transition-all duration-300 bg-card/50",onClick:()=>{var $;return($=document.getElementById("file-input"))==null?void 0:$.click()},children:[l?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:l,alt:"Preview",className:"max-h-64 mx-auto rounded-lg shadow-sm"}),n.jsx("button",{className:"mt-4 text-xs text-muted-foreground hover:text-foreground transition-colors tracking-wide",onClick:$=>{$.stopPropagation(),o(null),d(null),y(),D()},children:"Trocar imagem"})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-14 h-14 rounded-full bg-secondary/60 flex items-center justify-center mx-auto mb-3",children:n.jsx(P6,{className:"h-6 w-6 text-muted-foreground"})}),n.jsx("p",{className:"text-sm text-muted-foreground font-light",children:"Clique para enviar ou arraste sua imagem"}),n.jsx("p",{className:"text-[10px] text-muted-foreground/60 mt-1 tracking-wide",children:"JPG, PNG ou WEBP"})]}),n.jsx("input",{id:"file-input",type:"file",accept:"image/*",onChange:I,className:"hidden"})]}),l&&n.jsx("button",{onClick:F,disabled:g,className:"w-full px-10 py-3.5 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white disabled:opacity-50",children:g?n.jsxs("span",{className:"inline-flex items-center gap-2",children:[n.jsx(Et,{className:"h-4 w-4 animate-spin"}),"Identificando pea..."]}):n.jsxs("span",{className:"inline-flex items-center gap-2",children:[n.jsx(Gr,{className:"h-4 w-4"}),"Identificar e buscar"]})})]}),s===2&&n.jsxs("div",{className:"animate-fade-in space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-green-500/10 flex items-center justify-center mx-auto mb-3",children:n.jsx(gn,{className:"h-6 w-6 text-green-600"})}),n.jsx("h3",{className:"font-serif text-xl mb-1",children:"Pea identificada!"}),n.jsx("p",{className:"text-sm text-muted-foreground font-light",children:"Selecione seu tamanho para ver as opes disponveis."})]}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-3 text-center",children:["Tamanhos letras ",n.jsx("span",{className:"text-accent",children:"(pode marcar mais de um)"})]}),n.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:wme.map($=>n.jsx("button",{onClick:()=>Y($),className:`w-12 h-12 rounded-full border-2 font-medium text-sm transition-all duration-200 ${c.includes($)?"border-foreground bg-foreground text-background":"border-foreground/20 bg-card hover:border-foreground/40"}`,children:$},$))})]}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-3 text-center",children:["Numerao ",n.jsx("span",{className:"text-accent",children:"(pode marcar mais de um)"})]}),n.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:_me.map($=>n.jsx("button",{onClick:()=>G($),className:`w-12 h-12 rounded-full border-2 font-medium text-sm transition-all duration-200 ${h.includes($)?"border-foreground bg-foreground text-background":"border-foreground/20 bg-card hover:border-foreground/40"}`,children:$},$))})]}),q?n.jsx("div",{className:"border border-accent/30 rounded-xl p-3 text-center bg-accent/5",children:n.jsxs("p",{className:"text-sm",children:["Buscando tamanhos: ",n.jsx("span",{className:"font-medium text-accent",children:B})]})}):n.jsx("div",{className:"border border-foreground/10 rounded-xl p-3 text-center",children:n.jsx("p",{className:"text-sm text-muted-foreground font-light",children:"Selecione pelo menos um tamanho"})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>a(1),className:"px-6 py-3 border border-foreground/20 text-foreground text-xs tracking-[0.15em] uppercase font-medium transition-all duration-300 hover:border-foreground/40",children:"Voltar"}),n.jsx("button",{onClick:S,disabled:!q||b,className:"flex-1 px-6 py-3 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white disabled:opacity-50",children:b?n.jsxs("span",{className:"inline-flex items-center gap-2 justify-center",children:[n.jsx(Et,{className:"h-4 w-4 animate-spin"}),"Buscando..."]}):"Buscar sugestes"})]})]}),s===3&&n.jsxs("div",{className:"animate-fade-in space-y-6",children:[n.jsxs("div",{className:"border border-foreground/10 rounded-xl p-4 bg-card/50",children:[n.jsx("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-1",children:"O que a IA identificou"}),n.jsxs("p",{className:"text-sm font-medium italic font-serif",children:['"',M(),'"']})]}),j&&j.outOfStockInSelectedSize&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"border border-amber-300/50 bg-amber-50/50 rounded-xl p-4",children:n.jsxs("p",{className:"text-sm text-foreground font-light",children:["Encontramos uma pea muito parecida, mas no seu tamanho ela est esgotada.",T.length>0&&n.jsxs("span",{className:"font-medium",children:[" ","Veja opes similares abaixo."]})]})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-2",children:"Pea identificada"}),n.jsx(n3,{product:j,onView:()=>e(`/produto/${j.id}`),onBuy:()=>e(`/produto/${j.id}`),outOfStock:!0})]})]}),(T.length>0||j&&!j.outOfStockInSelectedSize)&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"text-center border border-accent/20 bg-accent/5 rounded-xl p-4",children:[n.jsx(Gr,{className:"h-5 w-5 text-accent mx-auto mb-2"}),n.jsx("p",{className:"font-serif text-lg",children:j!=null&&j.outOfStockInSelectedSize?"Opes similares no seu tamanho":"Sugestes no seu tamanho"}),n.jsxs("p",{className:"text-[11px] text-muted-foreground mt-1 tracking-wide",children:[(j&&!j.outOfStockInSelectedSize?1:0)+T.length," ",(j&&!j.outOfStockInSelectedSize?1:0)+T.length===1?"opo encontrada":"opes encontradas"," ","com estoque em ",B]})]}),j&&!j.outOfStockInSelectedSize&&n.jsxs("div",{children:[n.jsxs("p",{className:"text-[10px] tracking-[0.15em] uppercase text-accent font-medium mb-2 flex items-center gap-1",children:[n.jsx(Gr,{className:"h-3 w-3"})," Pea mais provvel"]}),n.jsx(n3,{product:j,onView:()=>e(`/produto/${j.id}`),onBuy:()=>N(j)})]}),T.length>0&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"grid grid-cols-2 gap-3",children:T.slice(0,6).map($=>n.jsx(n3,{product:$,onView:()=>e(`/produto/${$.id}`),onBuy:()=>N($)},$.id))}),T.length>6&&n.jsx(Ft,{to:"/catalogo",children:n.jsx("button",{className:"w-full px-6 py-3 border border-foreground/20 text-foreground text-xs tracking-[0.15em] uppercase font-medium transition-all duration-300 hover:border-accent hover:text-accent",children:"Ver mais opes no catlogo"})})]}),n.jsxs("div",{className:"border-t border-foreground/8 pt-4",children:[n.jsx("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-3 text-center",children:"Refinar busca"}),n.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:jme.map(({mode:$,label:X})=>n.jsx(Eme,{label:X,active:m===$,onClick:()=>E($),isLoading:b&&m===$},$))})]})]}),!j&&T.length===0&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"text-center border border-foreground/10 rounded-xl p-6",children:[n.jsx(Vt,{className:"h-8 w-8 text-muted-foreground mx-auto mb-3"}),n.jsx("p",{className:"font-serif text-lg mb-1",children:"Nenhuma pea encontrada"}),n.jsx("p",{className:"text-sm text-muted-foreground font-light",children:c.length>0&&h.length===0?"Tente selecionar tambm os tamanhos numricos (34-46).":h.length>0&&c.length===0?"Tente selecionar tambm os tamanhos letras (PP-GG).":"Me chama no WhatsApp que te ajudo a achar algo especial!"})]}),n.jsx("button",{onClick:()=>a(2),className:"w-full px-6 py-3 border border-foreground/20 text-foreground text-xs tracking-[0.15em] uppercase font-medium transition-all duration-300 hover:border-foreground/40",children:"Alterar tamanhos"}),n.jsx(Ft,{to:"/catalogo",children:n.jsx("button",{className:"w-full px-6 py-3 border border-foreground/20 text-foreground text-xs tracking-[0.15em] uppercase font-medium transition-all duration-300 hover:border-accent hover:text-accent",children:"Ver catlogo completo"})})]}),n.jsxs("a",{href:C(),target:"_blank",rel:"noopener noreferrer",className:`flex items-center justify-center gap-2 w-full font-medium py-3.5 px-4 rounded-xl text-xs tracking-wide uppercase transition-all duration-300 ${!j&&T.length===0?"bg-[#25D366] hover:bg-[#20BD5A] text-white":"border border-[#25D366]/40 text-[#25D366] hover:bg-[#25D366]/5"}`,children:[n.jsx(nn,{className:"h-4 w-4"}),"Falar no WhatsApp"]}),n.jsxs("button",{onClick:k,className:"w-full text-xs tracking-wide text-muted-foreground hover:text-foreground transition-colors py-2 inline-flex items-center justify-center gap-1.5",children:[n.jsx(Qr,{className:"h-3.5 w-3.5"}),"Buscar outra foto"]})]})]})}),n.jsx("section",{className:"py-14 md:py-20 px-5",children:n.jsx("div",{className:"max-w-4xl mx-auto text-center",children:n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-8",children:Sme.map($=>n.jsxs("div",{className:"flex flex-col items-center gap-3 group",children:[n.jsx("div",{className:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm group-hover:shadow-md group-hover:border-accent/40 transition-all duration-300",children:n.jsx($.icon,{className:"h-6 w-6 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:$.label}),n.jsx("p",{className:"text-xs text-muted-foreground",children:$.desc})]})]},$.label))})})}),n.jsx("section",{className:"py-16 md:py-24 px-5 bg-secondary/30",children:n.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[n.jsx("div",{className:"w-px h-12 bg-accent/40 mx-auto mb-6"}),n.jsx("h2",{className:"font-serif text-3xl md:text-4xl mb-4 italic",children:"Pronta para se sentir incrvel?"}),n.jsx("p",{className:"text-muted-foreground font-light mb-8 max-w-md mx-auto",children:"Monte seu provador VIP em 2 minutos e receba sugestes personalizadas direto no seu WhatsApp."}),n.jsx(Ft,{to:"/meu-estilo",children:n.jsx("button",{className:"px-12 py-4 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white",children:"Quero meu provador VIP"})}),n.jsx("p",{className:"text-[11px] text-muted-foreground mt-6 tracking-wide",children:"Gratuito  Leva menos de 2 minutos"})]})}),n.jsx("footer",{className:"border-t border-border py-10 px-5",children:n.jsxs("div",{className:"max-w-5xl mx-auto",children:[n.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[n.jsxs("div",{className:"text-center md:text-left",children:[n.jsx("p",{className:"font-serif text-lg mb-1",children:"LE.PO"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Curadoria de moda feminina  Anpolis, GO"})]}),n.jsxs("div",{className:"flex items-center gap-5 text-sm text-muted-foreground",children:[n.jsx(Ft,{to:"/catalogo",className:"hover:text-foreground transition-colors",children:"Catlogo"}),n.jsx(Ft,{to:"/meu-estilo",className:"hover:text-foreground transition-colors",children:"Provador VIP"}),n.jsx(Ft,{to:"/enviar-print",className:"hover:text-foreground transition-colors",children:"Buscar por foto"}),n.jsx("a",{href:po("Ol! Gostaria de saber mais sobre a LE.PO "),target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors",children:"WhatsApp"})]})]}),n.jsxs("div",{className:"border-t border-border mt-6 pt-6 flex flex-col sm:flex-row items-center justify-between gap-2",children:[n.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",new Date().getFullYear()," LE.PO. Todos os direitos reservados."]}),n.jsx(Ft,{to:"/area-lojista",className:"text-[10px] text-muted-foreground/40 hover:text-muted-foreground transition-colors",children:"rea do Lojista"})]})]})})]})};function n3({product:e,onView:t,onBuy:r,outOfStock:s}){return n.jsxs($e,{className:`overflow-hidden border-foreground/10 ${s?"ring-1 ring-amber-300/50":""}`,children:[n.jsxs("div",{className:"w-full aspect-[3/4] bg-secondary/30 flex items-center justify-center cursor-pointer relative",onClick:t,children:[e.image_url?n.jsx("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-contain"}):n.jsx(Vt,{className:"h-8 w-8 text-muted-foreground"}),s?n.jsx(ke,{className:"absolute top-2 left-2 bg-foreground/80 text-background text-[9px] px-1.5 py-0.5 tracking-wider",children:"Esgotado no seu tam"}):n.jsx(ke,{className:"absolute top-2 left-2 bg-green-600/90 text-white text-[9px] px-1.5 py-0.5 tracking-wider",children:" No seu tamanho"})]}),n.jsxs(Fe,{className:"p-3 space-y-2",children:[n.jsx("h4",{className:"text-sm font-medium line-clamp-2 min-h-[2.5rem]",children:e.name}),e.matchReasons.length>0&&n.jsxs("div",{className:"flex flex-wrap gap-1",children:[n.jsx("span",{className:"text-[9px] text-muted-foreground tracking-wide",children:"Parecido por:"}),e.matchReasons.slice(0,2).map(a=>n.jsx(ke,{variant:"secondary",className:"text-[9px] px-1.5 py-0 tracking-wide",children:a},a))]}),n.jsx("p",{className:"font-semibold text-accent text-sm",children:bme(e.price)}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:t,className:"flex-1 text-[10px] tracking-wide uppercase py-2 border border-foreground/15 hover:border-foreground/30 transition-colors inline-flex items-center justify-center gap-1",children:[n.jsx(ai,{className:"h-3 w-3"}),"Ver"]}),s?n.jsxs("button",{onClick:t,className:"flex-1 text-[10px] tracking-wide uppercase py-2 bg-secondary text-foreground/70 inline-flex items-center justify-center gap-1",children:[n.jsx(ai,{className:"h-3 w-3"}),"Tamanhos"]}):n.jsxs("button",{onClick:r,className:"flex-1 text-[10px] tracking-wide uppercase py-2 bg-foreground text-background hover:bg-accent transition-colors inline-flex items-center justify-center gap-1",children:[n.jsx(hn,{className:"h-3 w-3"}),"Comprar"]})]})]})]})}function Eme({label:e,active:t,onClick:r,isLoading:s}){return n.jsx("button",{onClick:r,disabled:s,className:`text-xs px-3 py-1.5 rounded-full border transition-all duration-200 tracking-wide ${t?"bg-foreground text-background border-foreground":"border-foreground/15 text-foreground/70 hover:border-foreground/30"} ${s?"opacity-50":""}`,children:s?n.jsx(Et,{className:"h-3 w-3 animate-spin"}):e})}var kme="Label",zV=P.forwardRef((e,t)=>n.jsx(er.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));zV.displayName=kme;var UV=zV;const Ame=Jp("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Be=P.forwardRef(({className:e,...t},r)=>n.jsx(UV,{ref:r,className:He(Ame(),e),...t}));Be.displayName=UV.displayName;var An;(function(e){e.assertEqual=a=>{};function t(a){}e.assertIs=t;function r(a){throw new Error}e.assertNever=r,e.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},e.getValidEnumValues=a=>{const i=e.objectKeys(a).filter(l=>typeof a[a[l]]!="number"),o={};for(const l of i)o[l]=a[l];return e.objectValues(o)},e.objectValues=a=>e.objectKeys(a).map(function(i){return a[i]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},e.find=(a,i)=>{for(const o of a)if(i(o))return o},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function s(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}e.joinValues=s,e.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(An||(An={}));var rR;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(rR||(rR={}));const fr=An.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Dd=e=>{switch(typeof e){case"undefined":return fr.undefined;case"string":return fr.string;case"number":return Number.isNaN(e)?fr.nan:fr.number;case"boolean":return fr.boolean;case"function":return fr.function;case"bigint":return fr.bigint;case"symbol":return fr.symbol;case"object":return Array.isArray(e)?fr.array:e===null?fr.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?fr.promise:typeof Map<"u"&&e instanceof Map?fr.map:typeof Set<"u"&&e instanceof Set?fr.set:typeof Date<"u"&&e instanceof Date?fr.date:fr.object;default:return fr.unknown}},qt=An.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class nd extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},s={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)s._errors.push(r(o));else{let l=s,d=0;for(;d<o.path.length;){const c=o.path[d];d===o.path.length-1?(l[c]=l[c]||{_errors:[]},l[c]._errors.push(r(o))):l[c]=l[c]||{_errors:[]},l=l[c],d++}}};return a(this),s}static assert(t){if(!(t instanceof nd))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,An.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},s=[];for(const a of this.issues)if(a.path.length>0){const i=a.path[0];r[i]=r[i]||[],r[i].push(t(a))}else s.push(t(a));return{formErrors:s,fieldErrors:r}}get formErrors(){return this.flatten()}}nd.create=e=>new nd(e);const sC=(e,t)=>{let r;switch(e.code){case qt.invalid_type:e.received===fr.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case qt.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,An.jsonStringifyReplacer)}`;break;case qt.unrecognized_keys:r=`Unrecognized key(s) in object: ${An.joinValues(e.keys,", ")}`;break;case qt.invalid_union:r="Invalid input";break;case qt.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${An.joinValues(e.options)}`;break;case qt.invalid_enum_value:r=`Invalid enum value. Expected ${An.joinValues(e.options)}, received '${e.received}'`;break;case qt.invalid_arguments:r="Invalid function arguments";break;case qt.invalid_return_type:r="Invalid function return type";break;case qt.invalid_date:r="Invalid date";break;case qt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:An.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case qt.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case qt.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case qt.custom:r="Invalid input";break;case qt.invalid_intersection_types:r="Intersection results could not be merged";break;case qt.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case qt.not_finite:r="Number must be finite";break;default:r=t.defaultError,An.assertNever(e)}return{message:r}};let Tme=sC;function Pme(){return Tme}const Ome=e=>{const{data:t,path:r,errorMaps:s,issueData:a}=e,i=[...r,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let l="";const d=s.filter(c=>!!c).slice().reverse();for(const c of d)l=c(o,{data:t,defaultError:l}).message;return{...a,path:i,message:l}};function ar(e,t){const r=Pme(),s=Ome({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===sC?void 0:sC].filter(a=>!!a)});e.common.issues.push(s)}class go{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const s=[];for(const a of r){if(a.status==="aborted")return zr;a.status==="dirty"&&t.dirty(),s.push(a.value)}return{status:t.value,value:s}}static async mergeObjectAsync(t,r){const s=[];for(const a of r){const i=await a.key,o=await a.value;s.push({key:i,value:o})}return go.mergeObjectSync(t,s)}static mergeObjectSync(t,r){const s={};for(const a of r){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return zr;i.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(s[i.value]=o.value)}return{status:t.value,value:s}}}const zr=Object.freeze({status:"aborted"}),A0=e=>({status:"dirty",value:e}),Ho=e=>({status:"valid",value:e}),nR=e=>e.status==="aborted",sR=e=>e.status==="dirty",up=e=>e.status==="valid",uw=e=>typeof Promise<"u"&&e instanceof Promise;var gr;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(gr||(gr={}));class Nu{constructor(t,r,s,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=s,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const aR=(e,t)=>{if(up(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new nd(e.common.issues);return this._error=r,this._error}}};function an(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:s,description:a}=e;if(t&&(r||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(o,l)=>{const{message:d}=e;return o.code==="invalid_enum_value"?{message:d??l.defaultError}:typeof l.data>"u"?{message:d??s??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:d??r??l.defaultError}},description:a}}class Cn{get description(){return this._def.description}_getType(t){return Dd(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Dd(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new go,ctx:{common:t.parent.common,data:t.data,parsedType:Dd(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(uw(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const s=this.safeParse(t,r);if(s.success)return s.data;throw s.error}safeParse(t,r){const s={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Dd(t)},a=this._parseSync({data:t,path:s.path,parent:s});return aR(s,a)}"~validate"(t){var s,a;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Dd(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:r});return up(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(a=(s=i==null?void 0:i.message)==null?void 0:s.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(i=>up(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(t,r){const s=await this.safeParseAsync(t,r);if(s.success)return s.data;throw s.error}async safeParseAsync(t,r){const s={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Dd(t)},a=this._parse({data:t,path:s.path,parent:s}),i=await(uw(a)?a:Promise.resolve(a));return aR(s,i)}refine(t,r){const s=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,i)=>{const o=t(a),l=()=>i.addIssue({code:qt.custom,...s(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(d=>d?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(t,r){return this._refinement((s,a)=>t(s)?!0:(a.addIssue(typeof r=="function"?r(s,a):r),!1))}_refinement(t){return new fp({schema:this,typeName:Ur.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return fu.create(this,this._def)}nullable(){return mp.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return oc.create(this)}promise(){return pw.create(this,this._def)}or(t){return fw.create([this,t],this._def)}and(t){return mw.create(this,t,this._def)}transform(t){return new fp({...an(this._def),schema:this,typeName:Ur.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new iC({...an(this._def),innerType:this,defaultValue:r,typeName:Ur.ZodDefault})}brand(){return new tpe({typeName:Ur.ZodBranded,type:this,...an(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new oC({...an(this._def),innerType:this,catchValue:r,typeName:Ur.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return xk.create(this,t)}readonly(){return lC.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Rme=/^c[^\s-]{8,}$/i,Mme=/^[0-9a-z]+$/,Ime=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Dme=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Lme=/^[a-z0-9_-]{21}$/i,Bme=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,$me=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Fme=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,zme="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let s3;const Ume=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Vme=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,qme=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Wme=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Hme=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Gme=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,VV="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Kme=new RegExp(`^${VV}$`);function qV(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function Xme(e){return new RegExp(`^${qV(e)}$`)}function Yme(e){let t=`${VV}T${qV(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function Zme(e,t){return!!((t==="v4"||!t)&&Ume.test(e)||(t==="v6"||!t)&&qme.test(e))}function Qme(e,t){if(!Bme.test(e))return!1;try{const[r]=e.split(".");if(!r)return!1;const s=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(s));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&a.alg!==t)}catch{return!1}}function Jme(e,t){return!!((t==="v4"||!t)&&Vme.test(e)||(t==="v6"||!t)&&Wme.test(e))}class Zd extends Cn{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==fr.string){const i=this._getOrReturnCtx(t);return ar(i,{code:qt.invalid_type,expected:fr.string,received:i.parsedType}),zr}const s=new go;let a;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(a=this._getOrReturnCtx(t,a),ar(a,{code:qt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")t.data.length>i.value&&(a=this._getOrReturnCtx(t,a),ar(a,{code:qt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){const o=t.data.length>i.value,l=t.data.length<i.value;(o||l)&&(a=this._getOrReturnCtx(t,a),o?ar(a,{code:qt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&ar(a,{code:qt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")Fme.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"email",code:qt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")s3||(s3=new RegExp(zme,"u")),s3.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"emoji",code:qt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")Dme.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"uuid",code:qt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")Lme.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"nanoid",code:qt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")Rme.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"cuid",code:qt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")Mme.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"cuid2",code:qt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")Ime.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"ulid",code:qt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),ar(a,{validation:"url",code:qt.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"regex",code:qt.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(t,a),ar(a,{code:qt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(a=this._getOrReturnCtx(t,a),ar(a,{code:qt.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(a=this._getOrReturnCtx(t,a),ar(a,{code:qt.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?Yme(i).test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{code:qt.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?Kme.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{code:qt.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?Xme(i).test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{code:qt.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?$me.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"duration",code:qt.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?Zme(t.data,i.version)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"ip",code:qt.invalid_string,message:i.message}),s.dirty()):i.kind==="jwt"?Qme(t.data,i.alg)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"jwt",code:qt.invalid_string,message:i.message}),s.dirty()):i.kind==="cidr"?Jme(t.data,i.version)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"cidr",code:qt.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?Hme.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"base64",code:qt.invalid_string,message:i.message}),s.dirty()):i.kind==="base64url"?Gme.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"base64url",code:qt.invalid_string,message:i.message}),s.dirty()):An.assertNever(i);return{status:s.value,value:t.data}}_regex(t,r,s){return this.refinement(a=>t.test(a),{validation:r,code:qt.invalid_string,...gr.errToObj(s)})}_addCheck(t){return new Zd({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...gr.errToObj(t)})}url(t){return this._addCheck({kind:"url",...gr.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...gr.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...gr.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...gr.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...gr.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...gr.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...gr.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...gr.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...gr.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...gr.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...gr.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...gr.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...gr.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...gr.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...gr.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...gr.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...gr.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...gr.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...gr.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...gr.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...gr.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...gr.errToObj(r)})}nonempty(t){return this.min(1,gr.errToObj(t))}trim(){return new Zd({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Zd({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Zd({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Zd.create=e=>new Zd({checks:[],typeName:Ur.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...an(e)});function epe(e,t){const r=(e.toString().split(".")[1]||"").length,s=(t.toString().split(".")[1]||"").length,a=r>s?r:s,i=Number.parseInt(e.toFixed(a).replace(".","")),o=Number.parseInt(t.toFixed(a).replace(".",""));return i%o/10**a}class Wx extends Cn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==fr.number){const i=this._getOrReturnCtx(t);return ar(i,{code:qt.invalid_type,expected:fr.number,received:i.parsedType}),zr}let s;const a=new go;for(const i of this._def.checks)i.kind==="int"?An.isInteger(t.data)||(s=this._getOrReturnCtx(t,s),ar(s,{code:qt.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(s=this._getOrReturnCtx(t,s),ar(s,{code:qt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(s=this._getOrReturnCtx(t,s),ar(s,{code:qt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?epe(t.data,i.value)!==0&&(s=this._getOrReturnCtx(t,s),ar(s,{code:qt.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(s=this._getOrReturnCtx(t,s),ar(s,{code:qt.not_finite,message:i.message}),a.dirty()):An.assertNever(i);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,gr.toString(r))}gt(t,r){return this.setLimit("min",t,!1,gr.toString(r))}lte(t,r){return this.setLimit("max",t,!0,gr.toString(r))}lt(t,r){return this.setLimit("max",t,!1,gr.toString(r))}setLimit(t,r,s,a){return new Wx({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:s,message:gr.toString(a)}]})}_addCheck(t){return new Wx({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:gr.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:gr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:gr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:gr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:gr.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:gr.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:gr.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:gr.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:gr.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&An.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(r===null||s.value>r)&&(r=s.value):s.kind==="max"&&(t===null||s.value<t)&&(t=s.value)}return Number.isFinite(r)&&Number.isFinite(t)}}Wx.create=e=>new Wx({checks:[],typeName:Ur.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...an(e)});class Hx extends Cn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==fr.bigint)return this._getInvalidInput(t);let s;const a=new go;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(s=this._getOrReturnCtx(t,s),ar(s,{code:qt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(s=this._getOrReturnCtx(t,s),ar(s,{code:qt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(t,s),ar(s,{code:qt.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):An.assertNever(i);return{status:a.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return ar(r,{code:qt.invalid_type,expected:fr.bigint,received:r.parsedType}),zr}gte(t,r){return this.setLimit("min",t,!0,gr.toString(r))}gt(t,r){return this.setLimit("min",t,!1,gr.toString(r))}lte(t,r){return this.setLimit("max",t,!0,gr.toString(r))}lt(t,r){return this.setLimit("max",t,!1,gr.toString(r))}setLimit(t,r,s,a){return new Hx({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:s,message:gr.toString(a)}]})}_addCheck(t){return new Hx({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:gr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:gr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:gr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:gr.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:gr.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}Hx.create=e=>new Hx({checks:[],typeName:Ur.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...an(e)});class iR extends Cn{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==fr.boolean){const s=this._getOrReturnCtx(t);return ar(s,{code:qt.invalid_type,expected:fr.boolean,received:s.parsedType}),zr}return Ho(t.data)}}iR.create=e=>new iR({typeName:Ur.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...an(e)});class hw extends Cn{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==fr.date){const i=this._getOrReturnCtx(t);return ar(i,{code:qt.invalid_type,expected:fr.date,received:i.parsedType}),zr}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return ar(i,{code:qt.invalid_date}),zr}const s=new go;let a;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(a=this._getOrReturnCtx(t,a),ar(a,{code:qt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(a=this._getOrReturnCtx(t,a),ar(a,{code:qt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):An.assertNever(i);return{status:s.value,value:new Date(t.data.getTime())}}_addCheck(t){return new hw({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:gr.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:gr.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}hw.create=e=>new hw({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:Ur.ZodDate,...an(e)});class oR extends Cn{_parse(t){if(this._getType(t)!==fr.symbol){const s=this._getOrReturnCtx(t);return ar(s,{code:qt.invalid_type,expected:fr.symbol,received:s.parsedType}),zr}return Ho(t.data)}}oR.create=e=>new oR({typeName:Ur.ZodSymbol,...an(e)});class lR extends Cn{_parse(t){if(this._getType(t)!==fr.undefined){const s=this._getOrReturnCtx(t);return ar(s,{code:qt.invalid_type,expected:fr.undefined,received:s.parsedType}),zr}return Ho(t.data)}}lR.create=e=>new lR({typeName:Ur.ZodUndefined,...an(e)});class cR extends Cn{_parse(t){if(this._getType(t)!==fr.null){const s=this._getOrReturnCtx(t);return ar(s,{code:qt.invalid_type,expected:fr.null,received:s.parsedType}),zr}return Ho(t.data)}}cR.create=e=>new cR({typeName:Ur.ZodNull,...an(e)});class dR extends Cn{constructor(){super(...arguments),this._any=!0}_parse(t){return Ho(t.data)}}dR.create=e=>new dR({typeName:Ur.ZodAny,...an(e)});class uR extends Cn{constructor(){super(...arguments),this._unknown=!0}_parse(t){return Ho(t.data)}}uR.create=e=>new uR({typeName:Ur.ZodUnknown,...an(e)});class Su extends Cn{_parse(t){const r=this._getOrReturnCtx(t);return ar(r,{code:qt.invalid_type,expected:fr.never,received:r.parsedType}),zr}}Su.create=e=>new Su({typeName:Ur.ZodNever,...an(e)});class hR extends Cn{_parse(t){if(this._getType(t)!==fr.undefined){const s=this._getOrReturnCtx(t);return ar(s,{code:qt.invalid_type,expected:fr.void,received:s.parsedType}),zr}return Ho(t.data)}}hR.create=e=>new hR({typeName:Ur.ZodVoid,...an(e)});class oc extends Cn{_parse(t){const{ctx:r,status:s}=this._processInputParams(t),a=this._def;if(r.parsedType!==fr.array)return ar(r,{code:qt.invalid_type,expected:fr.array,received:r.parsedType}),zr;if(a.exactLength!==null){const o=r.data.length>a.exactLength.value,l=r.data.length<a.exactLength.value;(o||l)&&(ar(r,{code:o?qt.too_big:qt.too_small,minimum:l?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),s.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(ar(r,{code:qt.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),s.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(ar(r,{code:qt.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),s.dirty()),r.common.async)return Promise.all([...r.data].map((o,l)=>a.type._parseAsync(new Nu(r,o,r.path,l)))).then(o=>go.mergeArray(s,o));const i=[...r.data].map((o,l)=>a.type._parseSync(new Nu(r,o,r.path,l)));return go.mergeArray(s,i)}get element(){return this._def.type}min(t,r){return new oc({...this._def,minLength:{value:t,message:gr.toString(r)}})}max(t,r){return new oc({...this._def,maxLength:{value:t,message:gr.toString(r)}})}length(t,r){return new oc({...this._def,exactLength:{value:t,message:gr.toString(r)}})}nonempty(t){return this.min(1,t)}}oc.create=(e,t)=>new oc({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Ur.ZodArray,...an(t)});function nm(e){if(e instanceof Ds){const t={};for(const r in e.shape){const s=e.shape[r];t[r]=fu.create(nm(s))}return new Ds({...e._def,shape:()=>t})}else return e instanceof oc?new oc({...e._def,type:nm(e.element)}):e instanceof fu?fu.create(nm(e.unwrap())):e instanceof mp?mp.create(nm(e.unwrap())):e instanceof tf?tf.create(e.items.map(t=>nm(t))):e}class Ds extends Cn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=An.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==fr.object){const c=this._getOrReturnCtx(t);return ar(c,{code:qt.invalid_type,expected:fr.object,received:c.parsedType}),zr}const{status:s,ctx:a}=this._processInputParams(t),{shape:i,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof Su&&this._def.unknownKeys==="strip"))for(const c in a.data)o.includes(c)||l.push(c);const d=[];for(const c of o){const u=i[c],h=a.data[c];d.push({key:{status:"valid",value:c},value:u._parse(new Nu(a,h,a.path,c)),alwaysSet:c in a.data})}if(this._def.catchall instanceof Su){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of l)d.push({key:{status:"valid",value:u},value:{status:"valid",value:a.data[u]}});else if(c==="strict")l.length>0&&(ar(a,{code:qt.unrecognized_keys,keys:l}),s.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of l){const h=a.data[u];d.push({key:{status:"valid",value:u},value:c._parse(new Nu(a,h,a.path,u)),alwaysSet:u in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of d){const h=await u.key,f=await u.value;c.push({key:h,value:f,alwaysSet:u.alwaysSet})}return c}).then(c=>go.mergeObjectSync(s,c)):go.mergeObjectSync(s,d)}get shape(){return this._def.shape()}strict(t){return gr.errToObj,new Ds({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,s)=>{var i,o;const a=((o=(i=this._def).errorMap)==null?void 0:o.call(i,r,s).message)??s.defaultError;return r.code==="unrecognized_keys"?{message:gr.errToObj(t).message??a}:{message:a}}}:{}})}strip(){return new Ds({...this._def,unknownKeys:"strip"})}passthrough(){return new Ds({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ds({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ds({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:Ur.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new Ds({...this._def,catchall:t})}pick(t){const r={};for(const s of An.objectKeys(t))t[s]&&this.shape[s]&&(r[s]=this.shape[s]);return new Ds({...this._def,shape:()=>r})}omit(t){const r={};for(const s of An.objectKeys(this.shape))t[s]||(r[s]=this.shape[s]);return new Ds({...this._def,shape:()=>r})}deepPartial(){return nm(this)}partial(t){const r={};for(const s of An.objectKeys(this.shape)){const a=this.shape[s];t&&!t[s]?r[s]=a:r[s]=a.optional()}return new Ds({...this._def,shape:()=>r})}required(t){const r={};for(const s of An.objectKeys(this.shape))if(t&&!t[s])r[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof fu;)i=i._def.innerType;r[s]=i}return new Ds({...this._def,shape:()=>r})}keyof(){return WV(An.objectKeys(this.shape))}}Ds.create=(e,t)=>new Ds({shape:()=>e,unknownKeys:"strip",catchall:Su.create(),typeName:Ur.ZodObject,...an(t)});Ds.strictCreate=(e,t)=>new Ds({shape:()=>e,unknownKeys:"strict",catchall:Su.create(),typeName:Ur.ZodObject,...an(t)});Ds.lazycreate=(e,t)=>new Ds({shape:e,unknownKeys:"strip",catchall:Su.create(),typeName:Ur.ZodObject,...an(t)});class fw extends Cn{_parse(t){const{ctx:r}=this._processInputParams(t),s=this._def.options;function a(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return r.common.issues.push(...l.ctx.common.issues),l.result;const o=i.map(l=>new nd(l.ctx.common.issues));return ar(r,{code:qt.invalid_union,unionErrors:o}),zr}if(r.common.async)return Promise.all(s.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const d of s){const c={...r,common:{...r.common,issues:[]},parent:null},u=d._parseSync({data:r.data,path:r.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const l=o.map(d=>new nd(d));return ar(r,{code:qt.invalid_union,unionErrors:l}),zr}}get options(){return this._def.options}}fw.create=(e,t)=>new fw({options:e,typeName:Ur.ZodUnion,...an(t)});function aC(e,t){const r=Dd(e),s=Dd(t);if(e===t)return{valid:!0,data:e};if(r===fr.object&&s===fr.object){const a=An.objectKeys(t),i=An.objectKeys(e).filter(l=>a.indexOf(l)!==-1),o={...e,...t};for(const l of i){const d=aC(e[l],t[l]);if(!d.valid)return{valid:!1};o[l]=d.data}return{valid:!0,data:o}}else if(r===fr.array&&s===fr.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let i=0;i<e.length;i++){const o=e[i],l=t[i],d=aC(o,l);if(!d.valid)return{valid:!1};a.push(d.data)}return{valid:!0,data:a}}else return r===fr.date&&s===fr.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class mw extends Cn{_parse(t){const{status:r,ctx:s}=this._processInputParams(t),a=(i,o)=>{if(nR(i)||nR(o))return zr;const l=aC(i.value,o.value);return l.valid?((sR(i)||sR(o))&&r.dirty(),{status:r.value,value:l.data}):(ar(s,{code:qt.invalid_intersection_types}),zr)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}mw.create=(e,t,r)=>new mw({left:e,right:t,typeName:Ur.ZodIntersection,...an(r)});class tf extends Cn{_parse(t){const{status:r,ctx:s}=this._processInputParams(t);if(s.parsedType!==fr.array)return ar(s,{code:qt.invalid_type,expected:fr.array,received:s.parsedType}),zr;if(s.data.length<this._def.items.length)return ar(s,{code:qt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),zr;!this._def.rest&&s.data.length>this._def.items.length&&(ar(s,{code:qt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...s.data].map((o,l)=>{const d=this._def.items[l]||this._def.rest;return d?d._parse(new Nu(s,o,s.path,l)):null}).filter(o=>!!o);return s.common.async?Promise.all(i).then(o=>go.mergeArray(r,o)):go.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new tf({...this._def,rest:t})}}tf.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new tf({items:e,typeName:Ur.ZodTuple,rest:null,...an(t)})};class fR extends Cn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:s}=this._processInputParams(t);if(s.parsedType!==fr.map)return ar(s,{code:qt.invalid_type,expected:fr.map,received:s.parsedType}),zr;const a=this._def.keyType,i=this._def.valueType,o=[...s.data.entries()].map(([l,d],c)=>({key:a._parse(new Nu(s,l,s.path,[c,"key"])),value:i._parse(new Nu(s,d,s.path,[c,"value"]))}));if(s.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const d of o){const c=await d.key,u=await d.value;if(c.status==="aborted"||u.status==="aborted")return zr;(c.status==="dirty"||u.status==="dirty")&&r.dirty(),l.set(c.value,u.value)}return{status:r.value,value:l}})}else{const l=new Map;for(const d of o){const c=d.key,u=d.value;if(c.status==="aborted"||u.status==="aborted")return zr;(c.status==="dirty"||u.status==="dirty")&&r.dirty(),l.set(c.value,u.value)}return{status:r.value,value:l}}}}fR.create=(e,t,r)=>new fR({valueType:t,keyType:e,typeName:Ur.ZodMap,...an(r)});class Gx extends Cn{_parse(t){const{status:r,ctx:s}=this._processInputParams(t);if(s.parsedType!==fr.set)return ar(s,{code:qt.invalid_type,expected:fr.set,received:s.parsedType}),zr;const a=this._def;a.minSize!==null&&s.data.size<a.minSize.value&&(ar(s,{code:qt.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&s.data.size>a.maxSize.value&&(ar(s,{code:qt.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const i=this._def.valueType;function o(d){const c=new Set;for(const u of d){if(u.status==="aborted")return zr;u.status==="dirty"&&r.dirty(),c.add(u.value)}return{status:r.value,value:c}}const l=[...s.data.values()].map((d,c)=>i._parse(new Nu(s,d,s.path,c)));return s.common.async?Promise.all(l).then(d=>o(d)):o(l)}min(t,r){return new Gx({...this._def,minSize:{value:t,message:gr.toString(r)}})}max(t,r){return new Gx({...this._def,maxSize:{value:t,message:gr.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}Gx.create=(e,t)=>new Gx({valueType:e,minSize:null,maxSize:null,typeName:Ur.ZodSet,...an(t)});class mR extends Cn{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}mR.create=(e,t)=>new mR({getter:e,typeName:Ur.ZodLazy,...an(t)});class pR extends Cn{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return ar(r,{received:r.data,code:qt.invalid_literal,expected:this._def.value}),zr}return{status:"valid",value:t.data}}get value(){return this._def.value}}pR.create=(e,t)=>new pR({value:e,typeName:Ur.ZodLiteral,...an(t)});function WV(e,t){return new hp({values:e,typeName:Ur.ZodEnum,...an(t)})}class hp extends Cn{_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),s=this._def.values;return ar(r,{expected:An.joinValues(s),received:r.parsedType,code:qt.invalid_type}),zr}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const r=this._getOrReturnCtx(t),s=this._def.values;return ar(r,{received:r.data,code:qt.invalid_enum_value,options:s}),zr}return Ho(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return hp.create(t,{...this._def,...r})}exclude(t,r=this._def){return hp.create(this.options.filter(s=>!t.includes(s)),{...this._def,...r})}}hp.create=WV;class gR extends Cn{_parse(t){const r=An.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(t);if(s.parsedType!==fr.string&&s.parsedType!==fr.number){const a=An.objectValues(r);return ar(s,{expected:An.joinValues(a),received:s.parsedType,code:qt.invalid_type}),zr}if(this._cache||(this._cache=new Set(An.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const a=An.objectValues(r);return ar(s,{received:s.data,code:qt.invalid_enum_value,options:a}),zr}return Ho(t.data)}get enum(){return this._def.values}}gR.create=(e,t)=>new gR({values:e,typeName:Ur.ZodNativeEnum,...an(t)});class pw extends Cn{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==fr.promise&&r.common.async===!1)return ar(r,{code:qt.invalid_type,expected:fr.promise,received:r.parsedType}),zr;const s=r.parsedType===fr.promise?r.data:Promise.resolve(r.data);return Ho(s.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}pw.create=(e,t)=>new pw({type:e,typeName:Ur.ZodPromise,...an(t)});class fp extends Cn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ur.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:s}=this._processInputParams(t),a=this._def.effect||null,i={addIssue:o=>{ar(s,o),o.fatal?r.abort():r.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(s.data,i);if(s.common.async)return Promise.resolve(o).then(async l=>{if(r.value==="aborted")return zr;const d=await this._def.schema._parseAsync({data:l,path:s.path,parent:s});return d.status==="aborted"?zr:d.status==="dirty"||r.value==="dirty"?A0(d.value):d});{if(r.value==="aborted")return zr;const l=this._def.schema._parseSync({data:o,path:s.path,parent:s});return l.status==="aborted"?zr:l.status==="dirty"||r.value==="dirty"?A0(l.value):l}}if(a.type==="refinement"){const o=l=>{const d=a.refinement(l,i);if(s.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(s.common.async===!1){const l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return l.status==="aborted"?zr:(l.status==="dirty"&&r.dirty(),o(l.value),{status:r.value,value:l.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>l.status==="aborted"?zr:(l.status==="dirty"&&r.dirty(),o(l.value).then(()=>({status:r.value,value:l.value}))))}if(a.type==="transform")if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!up(o))return zr;const l=a.transform(o.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:l}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>up(o)?Promise.resolve(a.transform(o.value,i)).then(l=>({status:r.value,value:l})):zr);An.assertNever(a)}}fp.create=(e,t,r)=>new fp({schema:e,typeName:Ur.ZodEffects,effect:t,...an(r)});fp.createWithPreprocess=(e,t,r)=>new fp({schema:t,effect:{type:"preprocess",transform:e},typeName:Ur.ZodEffects,...an(r)});class fu extends Cn{_parse(t){return this._getType(t)===fr.undefined?Ho(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}fu.create=(e,t)=>new fu({innerType:e,typeName:Ur.ZodOptional,...an(t)});class mp extends Cn{_parse(t){return this._getType(t)===fr.null?Ho(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}mp.create=(e,t)=>new mp({innerType:e,typeName:Ur.ZodNullable,...an(t)});class iC extends Cn{_parse(t){const{ctx:r}=this._processInputParams(t);let s=r.data;return r.parsedType===fr.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}iC.create=(e,t)=>new iC({innerType:e,typeName:Ur.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...an(t)});class oC extends Cn{_parse(t){const{ctx:r}=this._processInputParams(t),s={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return uw(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new nd(s.common.issues)},input:s.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new nd(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}oC.create=(e,t)=>new oC({innerType:e,typeName:Ur.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...an(t)});class xR extends Cn{_parse(t){if(this._getType(t)!==fr.nan){const s=this._getOrReturnCtx(t);return ar(s,{code:qt.invalid_type,expected:fr.nan,received:s.parsedType}),zr}return{status:"valid",value:t.data}}}xR.create=e=>new xR({typeName:Ur.ZodNaN,...an(e)});class tpe extends Cn{_parse(t){const{ctx:r}=this._processInputParams(t),s=r.data;return this._def.type._parse({data:s,path:r.path,parent:r})}unwrap(){return this._def.type}}class xk extends Cn{_parse(t){const{status:r,ctx:s}=this._processInputParams(t);if(s.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?zr:i.status==="dirty"?(r.dirty(),A0(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{const a=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?zr:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:s.path,parent:s})}}static create(t,r){return new xk({in:t,out:r,typeName:Ur.ZodPipeline})}}class lC extends Cn{_parse(t){const r=this._def.innerType._parse(t),s=a=>(up(a)&&(a.value=Object.freeze(a.value)),a);return uw(r)?r.then(a=>s(a)):s(r)}unwrap(){return this._def.innerType}}lC.create=(e,t)=>new lC({innerType:e,typeName:Ur.ZodReadonly,...an(t)});Ds.lazycreate;var Ur;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(Ur||(Ur={}));const Ii=Zd.create;Su.create;oc.create;const ug=Ds.create;Ds.strictCreate;fw.create;mw.create;tf.create;hp.create;pw.create;fu.create;mp.create;const rpe=ug({email:Ii().email("Email invlido"),password:Ii().min(6,"Senha deve ter no mnimo 6 caracteres")}),vR=()=>{const e=pr(),{user:t,isMerchant:r,isLoading:s}=qn(),[a,i]=P.useState(""),[o,l]=P.useState(""),[d,c]=P.useState(!1),[u,h]=P.useState(!1);P.useEffect(()=>{!s&&t&&r()&&e("/dashboard")},[t,s,r,e]);const f=async m=>{var g;m.preventDefault();const p=rpe.safeParse({email:a,password:o});if(!p.success){de.error(p.error.errors[0].message);return}h(!0);try{const{error:x}=await le.auth.signInWithPassword({email:a,password:o});if(x)throw x;const{data:v}=await le.from("user_roles").select("role").eq("user_id",(g=(await le.auth.getUser()).data.user)==null?void 0:g.id);if(!(v==null?void 0:v.some(b=>b.role==="merchant"||b.role==="admin"))){await le.auth.signOut(),de.error("Acesso restrito. Esta rea  apenas para lojistas autorizados.");return}de.success("Bem-vinda de volta!"),e("/dashboard")}catch(x){console.error("Auth error:",x),x.message.includes("Invalid login")?de.error("Email ou senha incorretos."):de.error(x.message||"Erro ao autenticar. Tente novamente.")}finally{h(!1)}};return s?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center px-4",children:n.jsxs("div",{className:"w-full max-w-sm",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"rea do Lojista"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Acesso restrito a lojistas autorizados"})]}),n.jsxs("form",{onSubmit:f,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"email",children:"Email"}),n.jsx(et,{id:"email",type:"email",placeholder:"seu@email.com",value:a,onChange:m=>i(m.target.value),required:!0})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"password",children:"Senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(et,{id:"password",type:d?"text":"password",placeholder:"",value:o,onChange:m=>l(m.target.value),required:!0}),n.jsx("button",{type:"button",onClick:()=>c(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:d?n.jsx(ac,{className:"h-4 w-4"}):n.jsx(ai,{className:"h-4 w-4"})})]})]}),n.jsx(he,{type:"submit",className:"w-full",disabled:u,children:u?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Entrando..."]}):"Entrar"})]}),n.jsx("p",{className:"mt-6 text-center text-xs text-muted-foreground",children:"Cadastro de lojistas apenas por convite."})]})})};var npe="Separator",yR="horizontal",spe=["horizontal","vertical"],HV=P.forwardRef((e,t)=>{const{decorative:r,orientation:s=yR,...a}=e,i=ape(s)?s:yR,l=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return n.jsx(er.div,{"data-orientation":i,...l,...a,ref:t})});HV.displayName=npe;function ape(e){return spe.includes(e)}var GV=HV;const Ca=P.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...s},a)=>n.jsx(GV,{ref:a,decorative:r,orientation:t,className:He("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...s}));Ca.displayName=GV.displayName;var ipe="authorization_response",ope="/~oauth/initiate",lpe=["https://oauth.lovable.app"];function cpe(e){let t;const r=new Promise(i=>{t=i}),s=i=>{if(!e.some(d=>i.origin===d))return;const l=i.data;!l||typeof l!="object"||l.type===ipe&&t(l.response)},a=()=>{window.removeEventListener("message",s)};return window.addEventListener("message",s),{cleanup:a,messagePromise:r}}function dpe(e){const t=window.screenX!==0||window.screenY!==0||!e,r=t?window.outerWidth*.5:window.screen.width*.5,s=t?window.outerHeight*.5:window.screen.height*.5,a=t?window.screenX+(window.outerWidth-r)/2:(window.screen.width-r)/2,i=t?window.screenY+(window.outerHeight-s)/2:(window.screen.height-s)/2;return{width:r,height:s,left:a,top:i}}function upe(){return typeof crypto<"u"&&crypto.getRandomValues?[...crypto.getRandomValues(new Uint8Array(16))].map(e=>e.toString(16).padStart(2,"0")).join(""):Math.random().toString(36).substring(2)+Date.now().toString(36)}function hpe(e={}){const t=e.oauthBrokerUrl??ope,r=e.supportedOAuthOrigins??lpe;async function s(a,i={}){let o=!1;try{o=window.self!==window.top}catch{o=!0}const l=upe(),d=i.redirect_uri??window.location.origin,c=new URLSearchParams({provider:a,redirect_uri:d,state:l,...i.extraParams});if(!o)return window.location.href=`${t}?${c.toString()}`,{error:null,redirected:!0};c.set("response_mode","web_message");const u=`${t}?${c.toString()}`,{messagePromise:h,cleanup:f}=cpe(r),m=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);let p;if(m)p=window.open(u,"_blank");else{const{width:v,height:y,left:b,top:j}=dpe(o);p=window.open(u,"oauth",`width=${v},height=${y},left=${b},top=${j}`)}if(!p)return f(),{error:new Error("Popup was blocked")};let g;const x=new Promise((v,y)=>{g=setInterval(()=>{p.closed&&(clearInterval(g),y(new Error("Sign in was cancelled")))},500)});try{const v=await Promise.race([h,x]);return v.error?v.error==="legacy_flow"?{error:new Error("This flow is not supported in Preview mode. Please open the app in a new tab to sign in.")}:{error:new Error(v.error_description??"Sign in failed")}:v.state!==l?{error:new Error("State is invalid")}:!v.access_token||!v.refresh_token?{error:new Error("No tokens received")}:{tokens:{access_token:v.access_token,refresh_token:v.refresh_token},error:null}}catch(v){return{error:v instanceof Error?v:new Error(String(v))}}finally{clearInterval(g),f(),p==null||p.close()}}return{signInWithOAuth:s}}function fpe(e){return hpe(e)}const mpe=fpe({}),KV={auth:{signInWithOAuth:async(e,t)=>{const r=await mpe.signInWithOAuth(e,{redirect_uri:t==null?void 0:t.redirect_uri,extraParams:{...t==null?void 0:t.extraParams}});if(r.redirected||r.error)return r;try{await le.auth.setSession(r.tokens)}catch(s){return{error:s instanceof Error?s:new Error(String(s))}}return r}}};function mb(e){const t=e.replace(/\D/g,""),r=t.startsWith("55")&&t.length>11?t.slice(2):t;return r.length===0?"":r.length<=2?`(${r}`:r.length<=7?`(${r.slice(0,2)}) ${r.slice(2)}`:`(${r.slice(0,2)}) ${r.slice(2,7)}-${r.slice(7,11)}`}function ppe(e){const t=e.replace(/\D/g,"");return t.startsWith("55")&&t.length===13||t.startsWith("55")&&t.length===12?t:t.length===11?`55${t}`:t.length===10?`55${t}`:t.startsWith("55")?t:`55${t}`}function a3(e){const t=e.replace(/\D/g,"");return(t.startsWith("55")?t.slice(2):t).length===11}function vk(e=""){const[t,r]=P.useState(()=>mb(e)),[s,a]=P.useState(()=>e?a3(e):!0),[i,o]=P.useState(!1),l=P.useCallback(h=>{const f=h.target.value,m=mb(f);r(m);const p=f.replace(/\D/g,"");p.length>0?a(a3(p)):a(!0)},[]),d=P.useCallback(()=>{o(!0)},[]),c=P.useCallback(()=>ppe(t),[t]),u=i&&t.length>0&&!s;return{displayValue:t,setDisplayValue:h=>{r(mb(h)),a(a3(h))},isValid:s,hasError:u,handleChange:l,handleBlur:d,getNormalizedValue:c}}const gpe=ug({email:Ii().email("Email invlido"),password:Ii().min(6,"Senha deve ter no mnimo 6 caracteres")}),xpe=ug({name:Ii().min(2,"Nome deve ter no mnimo 2 caracteres"),email:Ii().email("Email invlido"),password:Ii().min(6,"Senha deve ter no mnimo 6 caracteres"),whatsapp:Ii().min(14,"WhatsApp invlido")}),vpe=()=>{const e=pr(),t=wc(),{user:r,isLoading:s}=qn(),[a,i]=P.useState(!1),[o,l]=P.useState(""),[d,c]=P.useState(""),[u,h]=P.useState(""),[f,m]=P.useState(""),[p,g]=P.useState(!1),[x,v]=P.useState(!1),[y,b]=P.useState(!1),{displayValue:j,handleChange:T,getNormalizedValue:O,isValid:R}=vk(""),D=new URLSearchParams(t.search),B=t.state,q=D.get("redirect")||(B==null?void 0:B.returnTo)||(B==null?void 0:B.redirectTo)||(B==null?void 0:B.from)||"/",Y=B==null?void 0:B.message;P.useEffect(()=>{!s&&r&&e(q,{replace:!0})},[r,s,e,q]);const G=async S=>{S.preventDefault();const E=gpe.safeParse({email:o,password:d});if(!E.success){de.error(E.error.errors[0].message);return}v(!0);try{const{error:N}=await le.auth.signInWithPassword({email:o,password:d});if(N)throw N;de.success("Bem-vinda de volta! "),e(q,{replace:!0})}catch(N){console.error("Auth error:",N),N.message.includes("Invalid login")?de.error("Email ou senha incorretos."):de.error(N.message||"Erro ao entrar. Tente novamente.")}finally{v(!1)}},I=async S=>{S.preventDefault();const E=xpe.safeParse({name:u,email:o,password:d,whatsapp:j});if(!E.success||!R){de.error(R?E.error.errors[0].message:"WhatsApp invlido"),de.error(E.error.errors[0].message);return}v(!0);try{const N=`${window.location.origin}${q}`,C=O(),k=f.replace(/@/g,"").replace(/\s/g,"").toLowerCase().trim()||null,{data:M,error:U}=await le.auth.signUp({email:o,password:d,options:{emailRedirectTo:N,data:{name:u,whatsapp:C,instagram_handle:k}}});if(U)throw U;if(M.user){const{error:$}=await le.from("profiles").update({name:u,whatsapp:C,instagram_handle:k}).eq("user_id",M.user.id);$&&console.error("Profile update error:",$)}de.success("Conta criada com sucesso! "),e(q,{replace:!0})}catch(N){console.error("Signup error:",N),N.message.includes("already registered")?(de.error("Este email j est cadastrado. Faa login."),i(!1)):de.error(N.message||"Erro ao criar conta. Tente novamente.")}finally{v(!1)}},F=async()=>{b(!0);try{sessionStorage.setItem("oauth_return_to",q);const{error:S}=await KV.auth.signInWithOAuth("google",{redirect_uri:window.location.origin});if(S)throw S}catch(S){console.error("Google auth error:",S),de.error("Erro ao entrar com Google. Tente novamente."),b(!1)}};return s?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-md",children:[n.jsxs(Ft,{to:"/",className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-6",children:[n.jsx(Ts,{className:"h-4 w-4"}),"Voltar"]}),n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-accent/10 mb-4",children:n.jsx(Gr,{className:"h-8 w-8 text-accent"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:a?"Criar sua conta":"Entrar"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:Y||(a?"Crie sua conta para fazer o quiz e receber looks personalizados":"Entre para acessar seus looks e pedidos")})]}),Y&&n.jsx("div",{className:"mb-6 p-4 bg-accent/10 rounded-xl border border-accent/30 text-center",children:n.jsx("p",{className:"text-sm",children:" Ao entrar, voc ter acesso ao seu perfil de estilo e sugestes personalizadas!"})}),n.jsxs("form",{onSubmit:a?I:G,className:"space-y-4",children:[a&&n.jsxs("div",{className:"animate-slide-in-up",children:[n.jsx(Be,{htmlFor:"name",children:"Seu nome"}),n.jsx(et,{id:"name",type:"text",placeholder:"Como podemos te chamar?",value:u,onChange:S=>h(S.target.value),required:!0})]}),n.jsxs("div",{className:a?"animate-slide-in-up":"",style:a?{animationDelay:"50ms"}:{},children:[n.jsx(Be,{htmlFor:"email",children:"Email"}),n.jsx(et,{id:"email",type:"email",placeholder:"seu@email.com",value:o,onChange:S=>l(S.target.value),required:!0})]}),a&&n.jsxs("div",{className:"animate-slide-in-up",style:{animationDelay:"100ms"},children:[n.jsx(Be,{htmlFor:"whatsapp",children:"WhatsApp"}),n.jsx(et,{id:"whatsapp",type:"tel",placeholder:"(62) 99999-9999",value:j,onChange:T,required:!0}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Usaremos para enviar novidades e looks no seu tamanho"})]}),a&&n.jsxs("div",{className:"animate-slide-in-up",style:{animationDelay:"120ms"},children:[n.jsx(Be,{htmlFor:"instagram",children:"Instagram (opcional)"}),n.jsx(et,{id:"instagram",type:"text",placeholder:"@seuinstagram",value:f,onChange:S=>m(S.target.value)}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Se voc compra nas nossas lives, coloque seu @ para ver seus pedidos aqui"})]}),n.jsxs("div",{className:a?"animate-slide-in-up":"",style:a?{animationDelay:"150ms"}:{},children:[n.jsx(Be,{htmlFor:"password",children:"Senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(et,{id:"password",type:p?"text":"password",placeholder:"",value:d,onChange:S=>c(S.target.value),required:!0}),n.jsx("button",{type:"button",onClick:()=>g(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:p?n.jsx(ac,{className:"h-4 w-4"}):n.jsx(ai,{className:"h-4 w-4"})})]}),!a&&n.jsx("div",{className:"mt-1 text-right",children:n.jsx(Ft,{to:"/esqueci-senha",className:"text-xs text-muted-foreground hover:text-accent transition-colors",children:"Esqueci minha senha"})})]}),n.jsx(he,{type:"submit",className:"w-full gap-2 transition-all hover:scale-[1.02]",disabled:x,children:x?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 animate-spin"}),a?"Criando conta...":"Entrando..."]}):a?n.jsxs(n.Fragment,{children:[n.jsx(Gr,{className:"h-4 w-4"}),"Criar conta"]}):"Entrar"})]}),n.jsxs("div",{className:"relative my-6",children:[n.jsx(Ca,{}),n.jsx("span",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-background px-3 text-xs text-muted-foreground",children:"ou continue com"})]}),n.jsxs(he,{type:"button",variant:"outline",className:"w-full gap-2",onClick:F,disabled:y||x,children:[y?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):n.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",children:[n.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),n.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),n.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),n.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google"]}),n.jsx("div",{className:"mt-6 text-center",children:n.jsx("button",{type:"button",onClick:()=>i(!a),className:"text-sm text-accent hover:underline",children:a?"J tem uma conta? Fazer login":"No tem conta? Criar agora"})}),q.includes("quiz")&&n.jsxs("div",{className:"mt-8 p-4 bg-accent/10 rounded-xl border border-accent/30 text-center",children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Ao criar sua conta, voc ter acesso a:"}),n.jsxs("ul",{className:"mt-2 text-sm space-y-1",children:[n.jsx("li",{children:" Looks personalizados no seu tamanho"}),n.jsx("li",{children:" Histrico de pedidos"}),n.jsx("li",{children:" Sugestes exclusivas"})]})]})]})]})};function ype(){const e=pr();return P.useEffect(()=>{(async()=>{try{const{error:r}=await le.auth.exchangeCodeForSession(window.location.href);if(r){console.error("OAuth callback error:",r),e("/entrar",{replace:!0});return}const s=sessionStorage.getItem("oauth_return_to");sessionStorage.removeItem("oauth_return_to"),e(s||"/minha-conta",{replace:!0})}catch(r){console.error("OAuth callback exception:",r),e("/entrar",{replace:!0})}})()},[e]),n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center space-y-4",children:[n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground mx-auto"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Finalizando login..."})]})})}const bpe=()=>{const t=po("Oi! Esqueci minha senha do Provador VIP e preciso recuperar meu acesso ");return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-md",children:[n.jsxs(Ft,{to:"/entrar",className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-6",children:[n.jsx(Ts,{className:"h-4 w-4"}),"Voltar para login"]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-accent/10 mb-4",children:n.jsx(bl,{className:"h-8 w-8 text-accent"})}),n.jsx("h1",{className:"font-serif text-2xl mb-4",children:"Esqueceu sua senha?"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-2",children:"No se preocupe "}),n.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:"Para sua segurana, a recuperao de acesso ao Provador VIP  feita com nosso time pelo WhatsApp."}),n.jsx("p",{className:"text-muted-foreground text-sm mb-8",children:"Assim garantimos um atendimento rpido e personalizado pra voc voltar a usar seu provador sem dor de cabea "}),n.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"block",children:n.jsxs(he,{className:"w-full gap-2 bg-[#25D366] hover:bg-[#20BD5A] text-white rounded-xl py-6 text-base font-medium",size:"lg",children:[n.jsx(nn,{className:"h-5 w-5"}),"Recuperar acesso no WhatsApp"]})}),n.jsxs("p",{className:"mt-8 text-center text-xs text-muted-foreground",children:["Lembrou sua senha?"," ",n.jsx(Ft,{to:"/entrar",className:"text-accent hover:underline",children:"Fazer login"})]})]})]})]})},wpe=ug({password:Ii().min(6,"Senha deve ter no mnimo 6 caracteres"),confirmPassword:Ii().min(6,"Confirmao deve ter no mnimo 6 caracteres")}).refine(e=>e.password===e.confirmPassword,{message:"As senhas no conferem",path:["confirmPassword"]}),_pe=()=>{const e=pr(),[t,r]=P.useState(""),[s,a]=P.useState(""),[i,o]=P.useState(!1),[l,d]=P.useState(!1),[c,u]=P.useState(!1),[h,f]=P.useState(!1),[m,p]=P.useState(null);P.useEffect(()=>{(async()=>{const{data:{session:y}}=await le.auth.getSession(),b=new URLSearchParams(window.location.hash.substring(1)),j=b.get("access_token");if(b.get("type")==="recovery"&&j){const{error:O}=await le.auth.setSession({access_token:j,refresh_token:b.get("refresh_token")||""});O?p(!1):(p(!0),window.history.replaceState({},document.title,window.location.pathname))}else p(!!y)})()},[]);const g=async v=>{v.preventDefault();const y=wpe.safeParse({password:t,confirmPassword:s});if(!y.success){de.error(y.error.errors[0].message);return}u(!0);try{const{error:b}=await le.auth.updateUser({password:t});if(b)throw b;f(!0),de.success("Senha redefinida com sucesso!")}catch(b){console.error("Password update error:",b),de.error(b.message||"Erro ao redefinir senha. Tente novamente.")}finally{u(!1)}},x=async()=>{await le.auth.signOut(),e("/entrar")};return m===null?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 max-w-md flex items-center justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}):m?h?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 max-w-md",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4",children:n.jsx(Sr,{className:"h-8 w-8 text-green-600"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Senha redefinida!"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:"Sua senha foi alterada com sucesso. Agora voc pode fazer login com sua nova senha."}),n.jsx(he,{className:"w-full",onClick:x,children:"Entrar"})]})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-md",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-accent/10 mb-4",children:n.jsx(Nl,{className:"h-8 w-8 text-accent"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Criar nova senha"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Digite sua nova senha abaixo. Escolha uma senha segura com no mnimo 6 caracteres."})]}),n.jsxs("form",{onSubmit:g,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"password",children:"Nova senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(et,{id:"password",type:i?"text":"password",placeholder:"",value:t,onChange:v=>r(v.target.value),required:!0,autoFocus:!0}),n.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:i?n.jsx(ac,{className:"h-4 w-4"}):n.jsx(ai,{className:"h-4 w-4"})})]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Mnimo de 6 caracteres"})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"confirmPassword",children:"Confirmar nova senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(et,{id:"confirmPassword",type:l?"text":"password",placeholder:"",value:s,onChange:v=>a(v.target.value),required:!0}),n.jsx("button",{type:"button",onClick:()=>d(!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:l?n.jsx(ac,{className:"h-4 w-4"}):n.jsx(ai,{className:"h-4 w-4"})})]})]}),n.jsx(he,{type:"submit",className:"w-full",disabled:c,children:c?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Redefinindo..."]}):"Redefinir senha"})]})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 max-w-md",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-red-100 mb-4",children:n.jsx(Sn,{className:"h-8 w-8 text-red-600"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Link invlido ou expirado"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:"Este link de recuperao de senha no  mais vlido. Isso pode acontecer se o link j foi usado ou expirou."}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(Ft,{to:"/esqueci-senha",children:n.jsx(he,{className:"w-full",children:"Solicitar novo link"})}),n.jsx(Ft,{to:"/entrar",children:n.jsx(he,{variant:"outline",className:"w-full",children:"Voltar para login"})})]})]})})]})},jpe=ug({password:Ii().min(6,"Senha deve ter no mnimo 6 caracteres"),confirmPassword:Ii().min(6,"Confirmao deve ter no mnimo 6 caracteres")}).refine(e=>e.password===e.confirmPassword,{message:"As senhas no conferem",path:["confirmPassword"]}),Npe=()=>{const e=pr(),[t]=hd(),r=t.get("token"),[s,a]=P.useState(""),[i,o]=P.useState(""),[l,d]=P.useState(!1),[c,u]=P.useState(!1),[h,f]=P.useState(!1),[m,p]=P.useState(!1),[g,x]=P.useState(null);P.useEffect(()=>{r||x("Link invlido. Solicite um novo link de recuperao.")},[r]);const v=async j=>{j.preventDefault();const T=jpe.safeParse({password:s,confirmPassword:i});if(!T.success){de.error(T.error.errors[0].message);return}f(!0),x(null);try{const{data:O,error:R}=await le.functions.invoke("reset-password",{body:{token:r,newPassword:s}});if(R)throw new Error(R.message||"Erro ao redefinir senha");if(O!=null&&O.error)throw new Error(O.error);p(!0),de.success("Senha atualizada com sucesso! ")}catch(O){console.error("Password reset error:",O);const R=O.message||"Erro ao redefinir senha. Tente novamente.";x(R),de.error(R)}finally{f(!1)}},y=()=>{e("/meu-estilo")},b=()=>{e("/entrar")};return!r||g?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 max-w-md",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-red-100 mb-4",children:n.jsx(Sn,{className:"h-8 w-8 text-red-600"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Link invlido ou expirado"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:g||"Este link de recuperao de senha no  mais vlido. Isso pode acontecer se o link j foi usado ou expirou."}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(Ft,{to:"/esqueci-senha",children:n.jsx(he,{className:"w-full",children:"Solicitar novo link"})}),n.jsx(Ft,{to:"/entrar",children:n.jsx(he,{variant:"outline",className:"w-full",children:"Voltar para login"})})]})]})})]}):m?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 max-w-md",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4",children:n.jsx(Sr,{className:"h-8 w-8 text-green-600"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:" Senha atualizada com sucesso!"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:"Voc j pode acessar o seu Provador VIP e conferir suas sugestes personalizadas."}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs(he,{className:"w-full gap-2",onClick:y,children:[n.jsx(Gr,{className:"h-4 w-4"}),"Ir para Meu Estilo"]}),n.jsx(he,{variant:"outline",className:"w-full",onClick:b,children:"Fazer login"})]}),n.jsx("div",{className:"mt-8 p-4 bg-accent/10 rounded-xl border border-accent/30",children:n.jsx("p",{className:"text-sm text-muted-foreground",children:' Acesse "Meu Estilo" para ver seu nvel VIP, pontos acumulados e sugestes exclusivas!'})})]})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-md",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-accent/10 mb-4",children:n.jsx(Nl,{className:"h-8 w-8 text-accent"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Criar nova senha"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Digite sua nova senha abaixo. Escolha uma senha segura com no mnimo 6 caracteres."})]}),n.jsxs("form",{onSubmit:v,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"password",children:"Nova senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(et,{id:"password",type:l?"text":"password",placeholder:"",value:s,onChange:j=>a(j.target.value),required:!0,autoFocus:!0}),n.jsx("button",{type:"button",onClick:()=>d(!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:l?n.jsx(ac,{className:"h-4 w-4"}):n.jsx(ai,{className:"h-4 w-4"})})]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Mnimo de 6 caracteres"})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"confirmPassword",children:"Confirmar nova senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(et,{id:"confirmPassword",type:c?"text":"password",placeholder:"",value:i,onChange:j=>o(j.target.value),required:!0}),n.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:c?n.jsx(ac,{className:"h-4 w-4"}):n.jsx(ai,{className:"h-4 w-4"})})]})]}),n.jsx(he,{type:"submit",className:"w-full",disabled:h,children:h?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar nova senha"})]})]})]})};var Spe=P.createContext(void 0);function hg(e){const t=P.useContext(Spe);return e||t||"ltr"}var i3="rovingFocusGroup.onEntryFocus",Cpe={bubbles:!1,cancelable:!0},c1="RovingFocusGroup",[cC,XV,Epe]=J2(c1),[kpe,fg]=ea(c1,[Epe]),[Ape,Tpe]=kpe(c1),YV=P.forwardRef((e,t)=>n.jsx(cC.Provider,{scope:e.__scopeRovingFocusGroup,children:n.jsx(cC.Slot,{scope:e.__scopeRovingFocusGroup,children:n.jsx(Ppe,{...e,ref:t})})}));YV.displayName=c1;var Ppe=P.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:s,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:d,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...h}=e,f=P.useRef(null),m=Rr(t,f),p=hg(i),[g,x]=Ui({prop:o,defaultProp:l??null,onChange:d,caller:c1}),[v,y]=P.useState(!1),b=Us(c),j=XV(r),T=P.useRef(!1),[O,R]=P.useState(0);return P.useEffect(()=>{const D=f.current;if(D)return D.addEventListener(i3,b),()=>D.removeEventListener(i3,b)},[b]),n.jsx(Ape,{scope:r,orientation:s,dir:p,loop:a,currentTabStopId:g,onItemFocus:P.useCallback(D=>x(D),[x]),onItemShiftTab:P.useCallback(()=>y(!0),[]),onFocusableItemAdd:P.useCallback(()=>R(D=>D+1),[]),onFocusableItemRemove:P.useCallback(()=>R(D=>D-1),[]),children:n.jsx(er.div,{tabIndex:v||O===0?-1:0,"data-orientation":s,...h,ref:m,style:{outline:"none",...e.style},onMouseDown:Tt(e.onMouseDown,()=>{T.current=!0}),onFocus:Tt(e.onFocus,D=>{const B=!T.current;if(D.target===D.currentTarget&&B&&!v){const q=new CustomEvent(i3,Cpe);if(D.currentTarget.dispatchEvent(q),!q.defaultPrevented){const Y=j().filter(E=>E.focusable),G=Y.find(E=>E.active),I=Y.find(E=>E.id===g),S=[G,I,...Y].filter(Boolean).map(E=>E.ref.current);JV(S,u)}}T.current=!1}),onBlur:Tt(e.onBlur,()=>y(!1))})})}),ZV="RovingFocusGroupItem",QV=P.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:s=!0,active:a=!1,tabStopId:i,children:o,...l}=e,d=pa(),c=i||d,u=Tpe(ZV,r),h=u.currentTabStopId===c,f=XV(r),{onFocusableItemAdd:m,onFocusableItemRemove:p,currentTabStopId:g}=u;return P.useEffect(()=>{if(s)return m(),()=>p()},[s,m,p]),n.jsx(cC.ItemSlot,{scope:r,id:c,focusable:s,active:a,children:n.jsx(er.span,{tabIndex:h?0:-1,"data-orientation":u.orientation,...l,ref:t,onMouseDown:Tt(e.onMouseDown,x=>{s?u.onItemFocus(c):x.preventDefault()}),onFocus:Tt(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Tt(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){u.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const v=Mpe(x,u.orientation,u.dir);if(v!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let b=f().filter(j=>j.focusable).map(j=>j.ref.current);if(v==="last")b.reverse();else if(v==="prev"||v==="next"){v==="prev"&&b.reverse();const j=b.indexOf(x.currentTarget);b=u.loop?Ipe(b,j+1):b.slice(j+1)}setTimeout(()=>JV(b))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:g!=null}):o})})});QV.displayName=ZV;var Ope={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Rpe(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Mpe(e,t,r){const s=Rpe(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return Ope[s]}function JV(e,t=!1){const r=document.activeElement;for(const s of e)if(s===r||(s.focus({preventScroll:t}),document.activeElement!==r))return}function Ipe(e,t){return e.map((r,s)=>e[(t+s)%e.length])}var yk=YV,bk=QV,C_="Tabs",[Dpe,ZZe]=ea(C_,[fg]),eq=fg(),[Lpe,wk]=Dpe(C_),tq=P.forwardRef((e,t)=>{const{__scopeTabs:r,value:s,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:d="automatic",...c}=e,u=hg(l),[h,f]=Ui({prop:s,onChange:a,defaultProp:i??"",caller:C_});return n.jsx(Lpe,{scope:r,baseId:pa(),value:h,onValueChange:f,orientation:o,dir:u,activationMode:d,children:n.jsx(er.div,{dir:u,"data-orientation":o,...c,ref:t})})});tq.displayName=C_;var rq="TabsList",nq=P.forwardRef((e,t)=>{const{__scopeTabs:r,loop:s=!0,...a}=e,i=wk(rq,r),o=eq(r);return n.jsx(yk,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:s,children:n.jsx(er.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:t})})});nq.displayName=rq;var sq="TabsTrigger",aq=P.forwardRef((e,t)=>{const{__scopeTabs:r,value:s,disabled:a=!1,...i}=e,o=wk(sq,r),l=eq(r),d=lq(o.baseId,s),c=cq(o.baseId,s),u=s===o.value;return n.jsx(bk,{asChild:!0,...l,focusable:!a,active:u,children:n.jsx(er.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:d,...i,ref:t,onMouseDown:Tt(e.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?o.onValueChange(s):h.preventDefault()}),onKeyDown:Tt(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(s)}),onFocus:Tt(e.onFocus,()=>{const h=o.activationMode!=="manual";!u&&!a&&h&&o.onValueChange(s)})})})});aq.displayName=sq;var iq="TabsContent",oq=P.forwardRef((e,t)=>{const{__scopeTabs:r,value:s,forceMount:a,children:i,...o}=e,l=wk(iq,r),d=lq(l.baseId,s),c=cq(l.baseId,s),u=s===l.value,h=P.useRef(u);return P.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),n.jsx(Ws,{present:a||u,children:({present:f})=>n.jsx(er.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":d,hidden:!f,id:c,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});oq.displayName=iq;function lq(e,t){return`${e}-trigger-${t}`}function cq(e,t){return`${e}-content-${t}`}var Bpe=tq,dq=nq,uq=aq,hq=oq;const Hi=Bpe,Si=P.forwardRef(({className:e,...t},r)=>n.jsx(dq,{ref:r,className:He("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Si.displayName=dq.displayName;const br=P.forwardRef(({className:e,...t},r)=>n.jsx(uq,{ref:r,className:He("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",e),...t}));br.displayName=uq.displayName;const kr=P.forwardRef(({className:e,...t},r)=>n.jsx(hq,{ref:r,className:He("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));kr.displayName=hq.displayName;const xa=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{className:"relative w-full overflow-auto",children:n.jsx("table",{ref:r,className:He("w-full caption-bottom text-sm",e),...t})}));xa.displayName="Table";const va=P.forwardRef(({className:e,...t},r)=>n.jsx("thead",{ref:r,className:He("[&_tr]:border-b",e),...t}));va.displayName="TableHeader";const ya=P.forwardRef(({className:e,...t},r)=>n.jsx("tbody",{ref:r,className:He("[&_tr:last-child]:border-0",e),...t}));ya.displayName="TableBody";const $pe=P.forwardRef(({className:e,...t},r)=>n.jsx("tfoot",{ref:r,className:He("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));$pe.displayName="TableFooter";const Kr=P.forwardRef(({className:e,...t},r)=>n.jsx("tr",{ref:r,className:He("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",e),...t}));Kr.displayName="TableRow";const St=P.forwardRef(({className:e,...t},r)=>n.jsx("th",{ref:r,className:He("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));St.displayName="TableHead";const bt=P.forwardRef(({className:e,...t},r)=>n.jsx("td",{ref:r,className:He("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));bt.displayName="TableCell";const Fpe=P.forwardRef(({className:e,...t},r)=>n.jsx("caption",{ref:r,className:He("mt-4 text-sm text-muted-foreground",e),...t}));Fpe.displayName="TableCaption";const fq=je.forwardRef(({value:e,onChange:t,className:r,...s},a)=>{const i=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2,maximumFractionDigits:2}).format(l),o=l=>{const d=l.target.value.replace(/\D/g,""),u=(parseInt(d,10)||0)/100;t(u)};return n.jsx(et,{...s,ref:a,className:He("font-mono",r),value:i(e),onChange:o,inputMode:"numeric"})});fq.displayName="MoneyInput";function E_(e){const t=P.useRef({value:e,previous:e});return P.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var k_="Checkbox",[zpe,QZe]=ea(k_),[Upe,_k]=zpe(k_);function Vpe(e){const{__scopeCheckbox:t,checked:r,children:s,defaultChecked:a,disabled:i,form:o,name:l,onCheckedChange:d,required:c,value:u="on",internal_do_not_use_render:h}=e,[f,m]=Ui({prop:r,defaultProp:a??!1,onChange:d,caller:k_}),[p,g]=P.useState(null),[x,v]=P.useState(null),y=P.useRef(!1),b=p?!!o||!!p.closest("form"):!0,j={checked:f,disabled:i,setChecked:m,control:p,setControl:g,name:l,form:o,value:u,hasConsumerStoppedPropagationRef:y,required:c,defaultChecked:mu(a)?!1:a,isFormControl:b,bubbleInput:x,setBubbleInput:v};return n.jsx(Upe,{scope:t,...j,children:qpe(h)?h(j):s})}var mq="CheckboxTrigger",pq=P.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...s},a)=>{const{control:i,value:o,disabled:l,checked:d,required:c,setControl:u,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:p}=_k(mq,e),g=Rr(a,u),x=P.useRef(d);return P.useEffect(()=>{const v=i==null?void 0:i.form;if(v){const y=()=>h(x.current);return v.addEventListener("reset",y),()=>v.removeEventListener("reset",y)}},[i,h]),n.jsx(er.button,{type:"button",role:"checkbox","aria-checked":mu(d)?"mixed":d,"aria-required":c,"data-state":bq(d),"data-disabled":l?"":void 0,disabled:l,value:o,...s,ref:g,onKeyDown:Tt(t,v=>{v.key==="Enter"&&v.preventDefault()}),onClick:Tt(r,v=>{h(y=>mu(y)?!0:!y),p&&m&&(f.current=v.isPropagationStopped(),f.current||v.stopPropagation())})})});pq.displayName=mq;var jk=P.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:s,checked:a,defaultChecked:i,required:o,disabled:l,value:d,onCheckedChange:c,form:u,...h}=e;return n.jsx(Vpe,{__scopeCheckbox:r,checked:a,defaultChecked:i,disabled:l,required:o,onCheckedChange:c,name:s,form:u,value:d,internal_do_not_use_render:({isFormControl:f})=>n.jsxs(n.Fragment,{children:[n.jsx(pq,{...h,ref:t,__scopeCheckbox:r}),f&&n.jsx(yq,{__scopeCheckbox:r})]})})});jk.displayName=k_;var gq="CheckboxIndicator",xq=P.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:s,...a}=e,i=_k(gq,r);return n.jsx(Ws,{present:s||mu(i.checked)||i.checked===!0,children:n.jsx(er.span,{"data-state":bq(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});xq.displayName=gq;var vq="CheckboxBubbleInput",yq=P.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:s,hasConsumerStoppedPropagationRef:a,checked:i,defaultChecked:o,required:l,disabled:d,name:c,value:u,form:h,bubbleInput:f,setBubbleInput:m}=_k(vq,e),p=Rr(r,m),g=E_(i),x=l_(s);P.useEffect(()=>{const y=f;if(!y)return;const b=window.HTMLInputElement.prototype,T=Object.getOwnPropertyDescriptor(b,"checked").set,O=!a.current;if(g!==i&&T){const R=new Event("click",{bubbles:O});y.indeterminate=mu(i),T.call(y,mu(i)?!1:i),y.dispatchEvent(R)}},[f,g,i,a]);const v=P.useRef(mu(i)?!1:i);return n.jsx(er.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??v.current,required:l,disabled:d,name:c,value:u,form:h,...t,tabIndex:-1,ref:p,style:{...t.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});yq.displayName=vq;function qpe(e){return typeof e=="function"}function mu(e){return e==="indeterminate"}function bq(e){return mu(e)?"indeterminate":e?"checked":"unchecked"}const Va=P.forwardRef(({className:e,...t},r)=>n.jsx(jk,{ref:r,className:He("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(xq,{className:He("flex items-center justify-center text-current"),children:n.jsx(gn,{className:"h-4 w-4"})})}));Va.displayName=jk.displayName;const tn=r1,Wpe=w_,Hpe=n1,wq=P.forwardRef(({className:e,...t},r)=>n.jsx(wf,{ref:r,className:He("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));wq.displayName=wf.displayName;const Jr=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(Hpe,{children:[n.jsx(wq,{}),n.jsxs(_f,{ref:s,className:He("fixed left-[50%] top-[50%] z-50 grid w-[min(92vw,520px)] max-w-[92vw] max-h-[85vh] overflow-y-auto translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-4 sm:p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg",e),...r,children:[t,n.jsxs(s1,{className:"absolute right-3 top-3 sm:right-4 sm:top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[n.jsx(sn,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Jr.displayName=_f.displayName;const ln=({className:e,...t})=>n.jsx("div",{className:He("flex flex-col space-y-1.5 text-center sm:text-left pr-8",e),...t});ln.displayName="DialogHeader";const ba=({className:e,...t})=>n.jsx("div",{className:He("flex flex-col gap-2 sm:flex-row sm:justify-end sm:space-x-2",e),...t});ba.displayName="DialogFooter";const rn=P.forwardRef(({className:e,...t},r)=>n.jsx(og,{ref:r,className:He("text-lg font-semibold leading-none tracking-tight",e),...t}));rn.displayName=og.displayName;const Vo=P.forwardRef(({className:e,...t},r)=>n.jsx(lg,{ref:r,className:He("text-sm text-muted-foreground",e),...t}));Vo.displayName=lg.displayName;function dC(e,[t,r]){return Math.min(r,Math.max(t,e))}var Gpe=[" ","Enter","ArrowUp","ArrowDown"],Kpe=[" ","Enter"],rf="Select",[A_,T_,Xpe]=J2(rf),[mg,JZe]=ea(rf,[Xpe,bc]),P_=bc(),[Ype,Bu]=mg(rf),[Zpe,Qpe]=mg(rf),_q=e=>{const{__scopeSelect:t,children:r,open:s,defaultOpen:a,onOpenChange:i,value:o,defaultValue:l,onValueChange:d,dir:c,name:u,autoComplete:h,disabled:f,required:m,form:p}=e,g=P_(t),[x,v]=P.useState(null),[y,b]=P.useState(null),[j,T]=P.useState(!1),O=hg(c),[R,D]=Ui({prop:s,defaultProp:a??!1,onChange:i,caller:rf}),[B,q]=Ui({prop:o,defaultProp:l,onChange:d,caller:rf}),Y=P.useRef(null),G=x?p||!!x.closest("form"):!0,[I,F]=P.useState(new Set),S=Array.from(I).map(E=>E.props.value).join(";");return n.jsx(Yv,{...g,children:n.jsxs(Ype,{required:m,scope:t,trigger:x,onTriggerChange:v,valueNode:y,onValueNodeChange:b,valueNodeHasChildren:j,onValueNodeHasChildrenChange:T,contentId:pa(),value:B,onValueChange:q,open:R,onOpenChange:D,dir:O,triggerPointerDownPosRef:Y,disabled:f,children:[n.jsx(A_.Provider,{scope:t,children:n.jsx(Zpe,{scope:e.__scopeSelect,onNativeOptionAdd:P.useCallback(E=>{F(N=>new Set(N).add(E))},[]),onNativeOptionRemove:P.useCallback(E=>{F(N=>{const C=new Set(N);return C.delete(E),C})},[]),children:r})}),G?n.jsxs(Hq,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:h,value:B,onChange:E=>q(E.target.value),disabled:f,form:p,children:[B===void 0?n.jsx("option",{value:""}):null,Array.from(I)]},S):null]})})};_q.displayName=rf;var jq="SelectTrigger",Nq=P.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:s=!1,...a}=e,i=P_(r),o=Bu(jq,r),l=o.disabled||s,d=Rr(t,o.onTriggerChange),c=T_(r),u=P.useRef("touch"),[h,f,m]=Kq(g=>{const x=c().filter(b=>!b.disabled),v=x.find(b=>b.value===o.value),y=Xq(x,g,v);y!==void 0&&o.onValueChange(y.value)}),p=g=>{l||(o.onOpenChange(!0),m()),g&&(o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return n.jsx(ng,{asChild:!0,...i,children:n.jsx(er.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":Gq(o.value)?"":void 0,...a,ref:d,onClick:Tt(a.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&p(g)}),onPointerDown:Tt(a.onPointerDown,g=>{u.current=g.pointerType;const x=g.target;x.hasPointerCapture(g.pointerId)&&x.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(p(g),g.preventDefault())}),onKeyDown:Tt(a.onKeyDown,g=>{const x=h.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&f(g.key),!(x&&g.key===" ")&&Gpe.includes(g.key)&&(p(),g.preventDefault())})})})});Nq.displayName=jq;var Sq="SelectValue",Cq=P.forwardRef((e,t)=>{const{__scopeSelect:r,className:s,style:a,children:i,placeholder:o="",...l}=e,d=Bu(Sq,r),{onValueNodeHasChildrenChange:c}=d,u=i!==void 0,h=Rr(t,d.onValueNodeChange);return ga(()=>{c(u)},[c,u]),n.jsx(er.span,{...l,ref:h,style:{pointerEvents:"none"},children:Gq(d.value)?n.jsx(n.Fragment,{children:o}):i})});Cq.displayName=Sq;var Jpe="SelectIcon",Eq=P.forwardRef((e,t)=>{const{__scopeSelect:r,children:s,...a}=e;return n.jsx(er.span,{"aria-hidden":!0,...a,ref:t,children:s||""})});Eq.displayName=Jpe;var ege="SelectPortal",kq=e=>n.jsx(Qp,{asChild:!0,...e});kq.displayName=ege;var nf="SelectContent",Aq=P.forwardRef((e,t)=>{const r=Bu(nf,e.__scopeSelect),[s,a]=P.useState();if(ga(()=>{a(new DocumentFragment)},[]),!r.open){const i=s;return i?xf.createPortal(n.jsx(Tq,{scope:e.__scopeSelect,children:n.jsx(A_.Slot,{scope:e.__scopeSelect,children:n.jsx("div",{children:e.children})})}),i):null}return n.jsx(Pq,{...e,ref:t})});Aq.displayName=nf;var sl=10,[Tq,$u]=mg(nf),tge="SelectContentImpl",rge=yu("SelectContent.RemoveScroll"),Pq=P.forwardRef((e,t)=>{const{__scopeSelect:r,position:s="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:d,align:c,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:p,hideWhenDetached:g,avoidCollisions:x,...v}=e,y=Bu(nf,r),[b,j]=P.useState(null),[T,O]=P.useState(null),R=Rr(t,J=>j(J)),[D,B]=P.useState(null),[q,Y]=P.useState(null),G=T_(r),[I,F]=P.useState(!1),S=P.useRef(!1);P.useEffect(()=>{if(b)return y_(b)},[b]),x_();const E=P.useCallback(J=>{const[V,...H]=G().map(oe=>oe.ref.current),[ee]=H.slice(-1),ie=document.activeElement;for(const oe of J)if(oe===ie||(oe==null||oe.scrollIntoView({block:"nearest"}),oe===V&&T&&(T.scrollTop=0),oe===ee&&T&&(T.scrollTop=T.scrollHeight),oe==null||oe.focus(),document.activeElement!==ie))return},[G,T]),N=P.useCallback(()=>E([D,b]),[E,D,b]);P.useEffect(()=>{I&&N()},[I,N]);const{onOpenChange:C,triggerPointerDownPosRef:k}=y;P.useEffect(()=>{if(b){let J={x:0,y:0};const V=ee=>{var ie,oe;J={x:Math.abs(Math.round(ee.pageX)-(((ie=k.current)==null?void 0:ie.x)??0)),y:Math.abs(Math.round(ee.pageY)-(((oe=k.current)==null?void 0:oe.y)??0))}},H=ee=>{J.x<=10&&J.y<=10?ee.preventDefault():b.contains(ee.target)||C(!1),document.removeEventListener("pointermove",V),k.current=null};return k.current!==null&&(document.addEventListener("pointermove",V),document.addEventListener("pointerup",H,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",V),document.removeEventListener("pointerup",H,{capture:!0})}}},[b,C,k]),P.useEffect(()=>{const J=()=>C(!1);return window.addEventListener("blur",J),window.addEventListener("resize",J),()=>{window.removeEventListener("blur",J),window.removeEventListener("resize",J)}},[C]);const[M,U]=Kq(J=>{const V=G().filter(ie=>!ie.disabled),H=V.find(ie=>ie.ref.current===document.activeElement),ee=Xq(V,J,H);ee&&setTimeout(()=>ee.ref.current.focus())}),$=P.useCallback((J,V,H)=>{const ee=!S.current&&!H;(y.value!==void 0&&y.value===V||ee)&&(B(J),ee&&(S.current=!0))},[y.value]),X=P.useCallback(()=>b==null?void 0:b.focus(),[b]),Z=P.useCallback((J,V,H)=>{const ee=!S.current&&!H;(y.value!==void 0&&y.value===V||ee)&&Y(J)},[y.value]),re=s==="popper"?uC:Oq,W=re===uC?{side:l,sideOffset:d,align:c,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:p,hideWhenDetached:g,avoidCollisions:x}:{};return n.jsx(Tq,{scope:r,content:b,viewport:T,onViewportChange:O,itemRefCallback:$,selectedItem:D,onItemLeave:X,itemTextRefCallback:Z,focusSelectedItem:N,selectedItemText:q,position:s,isPositioned:I,searchRef:M,children:n.jsx(t1,{as:rge,allowPinchZoom:!0,children:n.jsx(e1,{asChild:!0,trapped:y.open,onMountAutoFocus:J=>{J.preventDefault()},onUnmountAutoFocus:Tt(a,J=>{var V;(V=y.trigger)==null||V.focus({preventScroll:!0}),J.preventDefault()}),children:n.jsx(Ou,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:J=>J.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:n.jsx(re,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:J=>J.preventDefault(),...v,...W,onPlaced:()=>F(!0),ref:R,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:Tt(v.onKeyDown,J=>{const V=J.ctrlKey||J.altKey||J.metaKey;if(J.key==="Tab"&&J.preventDefault(),!V&&J.key.length===1&&U(J.key),["ArrowUp","ArrowDown","Home","End"].includes(J.key)){let ee=G().filter(ie=>!ie.disabled).map(ie=>ie.ref.current);if(["ArrowUp","End"].includes(J.key)&&(ee=ee.slice().reverse()),["ArrowUp","ArrowDown"].includes(J.key)){const ie=J.target,oe=ee.indexOf(ie);ee=ee.slice(oe+1)}setTimeout(()=>E(ee)),J.preventDefault()}})})})})})})});Pq.displayName=tge;var nge="SelectItemAlignedPosition",Oq=P.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:s,...a}=e,i=Bu(nf,r),o=$u(nf,r),[l,d]=P.useState(null),[c,u]=P.useState(null),h=Rr(t,R=>u(R)),f=T_(r),m=P.useRef(!1),p=P.useRef(!0),{viewport:g,selectedItem:x,selectedItemText:v,focusSelectedItem:y}=o,b=P.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&c&&g&&x&&v){const R=i.trigger.getBoundingClientRect(),D=c.getBoundingClientRect(),B=i.valueNode.getBoundingClientRect(),q=v.getBoundingClientRect();if(i.dir!=="rtl"){const ie=q.left-D.left,oe=B.left-ie,se=R.left-oe,ue=R.width+se,pe=Math.max(ue,D.width),ce=window.innerWidth-sl,ne=dC(oe,[sl,Math.max(sl,ce-pe)]);l.style.minWidth=ue+"px",l.style.left=ne+"px"}else{const ie=D.right-q.right,oe=window.innerWidth-B.right-ie,se=window.innerWidth-R.right-oe,ue=R.width+se,pe=Math.max(ue,D.width),ce=window.innerWidth-sl,ne=dC(oe,[sl,Math.max(sl,ce-pe)]);l.style.minWidth=ue+"px",l.style.right=ne+"px"}const Y=f(),G=window.innerHeight-sl*2,I=g.scrollHeight,F=window.getComputedStyle(c),S=parseInt(F.borderTopWidth,10),E=parseInt(F.paddingTop,10),N=parseInt(F.borderBottomWidth,10),C=parseInt(F.paddingBottom,10),k=S+E+I+C+N,M=Math.min(x.offsetHeight*5,k),U=window.getComputedStyle(g),$=parseInt(U.paddingTop,10),X=parseInt(U.paddingBottom,10),Z=R.top+R.height/2-sl,re=G-Z,W=x.offsetHeight/2,J=x.offsetTop+W,V=S+E+J,H=k-V;if(V<=Z){const ie=Y.length>0&&x===Y[Y.length-1].ref.current;l.style.bottom="0px";const oe=c.clientHeight-g.offsetTop-g.offsetHeight,se=Math.max(re,W+(ie?X:0)+oe+N),ue=V+se;l.style.height=ue+"px"}else{const ie=Y.length>0&&x===Y[0].ref.current;l.style.top="0px";const se=Math.max(Z,S+g.offsetTop+(ie?$:0)+W)+H;l.style.height=se+"px",g.scrollTop=V-Z+g.offsetTop}l.style.margin=`${sl}px 0`,l.style.minHeight=M+"px",l.style.maxHeight=G+"px",s==null||s(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,l,c,g,x,v,i.dir,s]);ga(()=>b(),[b]);const[j,T]=P.useState();ga(()=>{c&&T(window.getComputedStyle(c).zIndex)},[c]);const O=P.useCallback(R=>{R&&p.current===!0&&(b(),y==null||y(),p.current=!1)},[b,y]);return n.jsx(age,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:O,children:n.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:n.jsx(er.div,{...a,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});Oq.displayName=nge;var sge="SelectPopperPosition",uC=P.forwardRef((e,t)=>{const{__scopeSelect:r,align:s="start",collisionPadding:a=sl,...i}=e,o=P_(r);return n.jsx(Zv,{...o,...i,ref:t,align:s,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});uC.displayName=sge;var[age,Nk]=mg(nf,{}),hC="SelectViewport",Rq=P.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:s,...a}=e,i=$u(hC,r),o=Nk(hC,r),l=Rr(t,i.onViewportChange),d=P.useRef(0);return n.jsxs(n.Fragment,{children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),n.jsx(A_.Slot,{scope:r,children:n.jsx(er.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:Tt(a.onScroll,c=>{const u=c.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:f}=o;if(f!=null&&f.current&&h){const m=Math.abs(d.current-u.scrollTop);if(m>0){const p=window.innerHeight-sl*2,g=parseFloat(h.style.minHeight),x=parseFloat(h.style.height),v=Math.max(g,x);if(v<p){const y=v+m,b=Math.min(p,y),j=y-b;h.style.height=b+"px",h.style.bottom==="0px"&&(u.scrollTop=j>0?j:0,h.style.justifyContent="flex-end")}}}d.current=u.scrollTop})})})]})});Rq.displayName=hC;var Mq="SelectGroup",[ige,oge]=mg(Mq),lge=P.forwardRef((e,t)=>{const{__scopeSelect:r,...s}=e,a=pa();return n.jsx(ige,{scope:r,id:a,children:n.jsx(er.div,{role:"group","aria-labelledby":a,...s,ref:t})})});lge.displayName=Mq;var Iq="SelectLabel",Dq=P.forwardRef((e,t)=>{const{__scopeSelect:r,...s}=e,a=oge(Iq,r);return n.jsx(er.div,{id:a.id,...s,ref:t})});Dq.displayName=Iq;var gw="SelectItem",[cge,Lq]=mg(gw),Bq=P.forwardRef((e,t)=>{const{__scopeSelect:r,value:s,disabled:a=!1,textValue:i,...o}=e,l=Bu(gw,r),d=$u(gw,r),c=l.value===s,[u,h]=P.useState(i??""),[f,m]=P.useState(!1),p=Rr(t,y=>{var b;return(b=d.itemRefCallback)==null?void 0:b.call(d,y,s,a)}),g=pa(),x=P.useRef("touch"),v=()=>{a||(l.onValueChange(s),l.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return n.jsx(cge,{scope:r,value:s,disabled:a,textId:g,isSelected:c,onItemTextChange:P.useCallback(y=>{h(b=>b||((y==null?void 0:y.textContent)??"").trim())},[]),children:n.jsx(A_.ItemSlot,{scope:r,value:s,disabled:a,textValue:u,children:n.jsx(er.div,{role:"option","aria-labelledby":g,"data-highlighted":f?"":void 0,"aria-selected":c&&f,"data-state":c?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...o,ref:p,onFocus:Tt(o.onFocus,()=>m(!0)),onBlur:Tt(o.onBlur,()=>m(!1)),onClick:Tt(o.onClick,()=>{x.current!=="mouse"&&v()}),onPointerUp:Tt(o.onPointerUp,()=>{x.current==="mouse"&&v()}),onPointerDown:Tt(o.onPointerDown,y=>{x.current=y.pointerType}),onPointerMove:Tt(o.onPointerMove,y=>{var b;x.current=y.pointerType,a?(b=d.onItemLeave)==null||b.call(d):x.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Tt(o.onPointerLeave,y=>{var b;y.currentTarget===document.activeElement&&((b=d.onItemLeave)==null||b.call(d))}),onKeyDown:Tt(o.onKeyDown,y=>{var j;((j=d.searchRef)==null?void 0:j.current)!==""&&y.key===" "||(Kpe.includes(y.key)&&v(),y.key===" "&&y.preventDefault())})})})})});Bq.displayName=gw;var T0="SelectItemText",$q=P.forwardRef((e,t)=>{const{__scopeSelect:r,className:s,style:a,...i}=e,o=Bu(T0,r),l=$u(T0,r),d=Lq(T0,r),c=Qpe(T0,r),[u,h]=P.useState(null),f=Rr(t,v=>h(v),d.onItemTextChange,v=>{var y;return(y=l.itemTextRefCallback)==null?void 0:y.call(l,v,d.value,d.disabled)}),m=u==null?void 0:u.textContent,p=P.useMemo(()=>n.jsx("option",{value:d.value,disabled:d.disabled,children:m},d.value),[d.disabled,d.value,m]),{onNativeOptionAdd:g,onNativeOptionRemove:x}=c;return ga(()=>(g(p),()=>x(p)),[g,x,p]),n.jsxs(n.Fragment,{children:[n.jsx(er.span,{id:d.textId,...i,ref:f}),d.isSelected&&o.valueNode&&!o.valueNodeHasChildren?xf.createPortal(i.children,o.valueNode):null]})});$q.displayName=T0;var Fq="SelectItemIndicator",zq=P.forwardRef((e,t)=>{const{__scopeSelect:r,...s}=e;return Lq(Fq,r).isSelected?n.jsx(er.span,{"aria-hidden":!0,...s,ref:t}):null});zq.displayName=Fq;var fC="SelectScrollUpButton",Uq=P.forwardRef((e,t)=>{const r=$u(fC,e.__scopeSelect),s=Nk(fC,e.__scopeSelect),[a,i]=P.useState(!1),o=Rr(t,s.onScrollButtonChange);return ga(()=>{if(r.viewport&&r.isPositioned){let l=function(){const c=d.scrollTop>0;i(c)};const d=r.viewport;return l(),d.addEventListener("scroll",l),()=>d.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?n.jsx(qq,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:d}=r;l&&d&&(l.scrollTop=l.scrollTop-d.offsetHeight)}}):null});Uq.displayName=fC;var mC="SelectScrollDownButton",Vq=P.forwardRef((e,t)=>{const r=$u(mC,e.__scopeSelect),s=Nk(mC,e.__scopeSelect),[a,i]=P.useState(!1),o=Rr(t,s.onScrollButtonChange);return ga(()=>{if(r.viewport&&r.isPositioned){let l=function(){const c=d.scrollHeight-d.clientHeight,u=Math.ceil(d.scrollTop)<c;i(u)};const d=r.viewport;return l(),d.addEventListener("scroll",l),()=>d.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),a?n.jsx(qq,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:d}=r;l&&d&&(l.scrollTop=l.scrollTop+d.offsetHeight)}}):null});Vq.displayName=mC;var qq=P.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:s,...a}=e,i=$u("SelectScrollButton",r),o=P.useRef(null),l=T_(r),d=P.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return P.useEffect(()=>()=>d(),[d]),ga(()=>{var u;const c=l().find(h=>h.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[l]),n.jsx(er.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:Tt(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(s,50))}),onPointerMove:Tt(a.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),o.current===null&&(o.current=window.setInterval(s,50))}),onPointerLeave:Tt(a.onPointerLeave,()=>{d()})})}),dge="SelectSeparator",Wq=P.forwardRef((e,t)=>{const{__scopeSelect:r,...s}=e;return n.jsx(er.div,{"aria-hidden":!0,...s,ref:t})});Wq.displayName=dge;var pC="SelectArrow",uge=P.forwardRef((e,t)=>{const{__scopeSelect:r,...s}=e,a=P_(r),i=Bu(pC,r),o=$u(pC,r);return i.open&&o.position==="popper"?n.jsx(Qv,{...a,...s,ref:t}):null});uge.displayName=pC;var hge="SelectBubbleInput",Hq=P.forwardRef(({__scopeSelect:e,value:t,...r},s)=>{const a=P.useRef(null),i=Rr(s,a),o=E_(t);return P.useEffect(()=>{const l=a.current;if(!l)return;const d=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==t&&u){const h=new Event("change",{bubbles:!0});u.call(l,t),l.dispatchEvent(h)}},[o,t]),n.jsx(er.select,{...r,style:{...SF,...r.style},ref:i,defaultValue:t})});Hq.displayName=hge;function Gq(e){return e===""||e===void 0}function Kq(e){const t=Us(e),r=P.useRef(""),s=P.useRef(0),a=P.useCallback(o=>{const l=r.current+o;t(l),function d(c){r.current=c,window.clearTimeout(s.current),c!==""&&(s.current=window.setTimeout(()=>d(""),1e3))}(l)},[t]),i=P.useCallback(()=>{r.current="",window.clearTimeout(s.current)},[]);return P.useEffect(()=>()=>window.clearTimeout(s.current),[]),[r,a,i]}function Xq(e,t,r){const a=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=fge(e,Math.max(i,0));a.length===1&&(o=o.filter(c=>c!==r));const d=o.find(c=>c.textValue.toLowerCase().startsWith(a.toLowerCase()));return d!==r?d:void 0}function fge(e,t){return e.map((r,s)=>e[(t+s)%e.length])}var mge=_q,Yq=Nq,pge=Cq,gge=Eq,xge=kq,Zq=Aq,vge=Rq,Qq=Dq,Jq=Bq,yge=$q,bge=zq,eW=Uq,tW=Vq,rW=Wq;const Xt=mge,Yt=pge,Ht=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(Yq,{ref:s,className:He("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,n.jsx(gge,{asChild:!0,children:n.jsx(zo,{className:"h-4 w-4 opacity-50"})})]}));Ht.displayName=Yq.displayName;const nW=P.forwardRef(({className:e,...t},r)=>n.jsx(eW,{ref:r,className:He("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx(ip,{className:"h-4 w-4"})}));nW.displayName=eW.displayName;const sW=P.forwardRef(({className:e,...t},r)=>n.jsx(tW,{ref:r,className:He("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx(zo,{className:"h-4 w-4"})}));sW.displayName=tW.displayName;const Gt=P.forwardRef(({className:e,children:t,position:r="popper",...s},a)=>n.jsx(xge,{children:n.jsxs(Zq,{ref:a,className:He("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...s,children:[n.jsx(nW,{}),n.jsx(vge,{className:He("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),n.jsx(sW,{})]})}));Gt.displayName=Zq.displayName;const wge=P.forwardRef(({className:e,...t},r)=>n.jsx(Qq,{ref:r,className:He("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));wge.displayName=Qq.displayName;const qe=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(Jq,{ref:s,className:He("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...r,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(bge,{children:n.jsx(gn,{className:"h-4 w-4"})})}),n.jsx(yge,{children:t})]}));qe.displayName=Jq.displayName;const _ge=P.forwardRef(({className:e,...t},r)=>n.jsx(rW,{ref:r,className:He("-mx-1 my-1 h-px bg-muted",e),...t}));_ge.displayName=rW.displayName;var bR=1,jge=.9,Nge=.8,Sge=.17,o3=.1,l3=.999,Cge=.9999,Ege=.99,kge=/[\\\/_+.#"@\[\(\{&]/,Age=/[\\\/_+.#"@\[\(\{&]/g,Tge=/[\s-]/,aW=/[\s-]/g;function gC(e,t,r,s,a,i,o){if(i===t.length)return a===e.length?bR:Ege;var l=`${a},${i}`;if(o[l]!==void 0)return o[l];for(var d=s.charAt(i),c=r.indexOf(d,a),u=0,h,f,m,p;c>=0;)h=gC(e,t,r,s,c+1,i+1,o),h>u&&(c===a?h*=bR:kge.test(e.charAt(c-1))?(h*=Nge,m=e.slice(a,c-1).match(Age),m&&a>0&&(h*=Math.pow(l3,m.length))):Tge.test(e.charAt(c-1))?(h*=jge,p=e.slice(a,c-1).match(aW),p&&a>0&&(h*=Math.pow(l3,p.length))):(h*=Sge,a>0&&(h*=Math.pow(l3,c-a))),e.charAt(c)!==t.charAt(i)&&(h*=Cge)),(h<o3&&r.charAt(c-1)===s.charAt(i+1)||s.charAt(i+1)===s.charAt(i)&&r.charAt(c-1)!==s.charAt(i))&&(f=gC(e,t,r,s,c+1,i+2,o),f*o3>h&&(h=f*o3)),h>u&&(u=h),c=r.indexOf(d,c+1);return o[l]=u,u}function wR(e){return e.toLowerCase().replace(aW," ")}function Pge(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,gC(e,t,wR(e),wR(t),0,0,{})}var e0='[cmdk-group=""]',c3='[cmdk-group-items=""]',Oge='[cmdk-group-heading=""]',iW='[cmdk-item=""]',_R=`${iW}:not([aria-disabled="true"])`,xC="cmdk-item-select",sm="data-value",Rge=(e,t,r)=>Pge(e,t,r),oW=P.createContext(void 0),d1=()=>P.useContext(oW),lW=P.createContext(void 0),Sk=()=>P.useContext(lW),cW=P.createContext(void 0),dW=P.forwardRef((e,t)=>{let r=am(()=>{var $,X;return{search:"",value:(X=($=e.value)!=null?$:e.defaultValue)!=null?X:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),s=am(()=>new Set),a=am(()=>new Map),i=am(()=>new Map),o=am(()=>new Set),l=uW(e),{label:d,children:c,value:u,onValueChange:h,filter:f,shouldFilter:m,loop:p,disablePointerSelection:g=!1,vimBindings:x=!0,...v}=e,y=pa(),b=pa(),j=pa(),T=P.useRef(null),O=qge();sf(()=>{if(u!==void 0){let $=u.trim();r.current.value=$,R.emit()}},[u]),sf(()=>{O(6,I)},[]);let R=P.useMemo(()=>({subscribe:$=>(o.current.add($),()=>o.current.delete($)),snapshot:()=>r.current,setState:($,X,Z)=>{var re,W,J,V;if(!Object.is(r.current[$],X)){if(r.current[$]=X,$==="search")G(),q(),O(1,Y);else if($==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let H=document.getElementById(j);H?H.focus():(re=document.getElementById(y))==null||re.focus()}if(O(7,()=>{var H;r.current.selectedItemId=(H=F())==null?void 0:H.id,R.emit()}),Z||O(5,I),((W=l.current)==null?void 0:W.value)!==void 0){let H=X??"";(V=(J=l.current).onValueChange)==null||V.call(J,H);return}}R.emit()}},emit:()=>{o.current.forEach($=>$())}}),[]),D=P.useMemo(()=>({value:($,X,Z)=>{var re;X!==((re=i.current.get($))==null?void 0:re.value)&&(i.current.set($,{value:X,keywords:Z}),r.current.filtered.items.set($,B(X,Z)),O(2,()=>{q(),R.emit()}))},item:($,X)=>(s.current.add($),X&&(a.current.has(X)?a.current.get(X).add($):a.current.set(X,new Set([$]))),O(3,()=>{G(),q(),r.current.value||Y(),R.emit()}),()=>{i.current.delete($),s.current.delete($),r.current.filtered.items.delete($);let Z=F();O(4,()=>{G(),(Z==null?void 0:Z.getAttribute("id"))===$&&Y(),R.emit()})}),group:$=>(a.current.has($)||a.current.set($,new Set),()=>{i.current.delete($),a.current.delete($)}),filter:()=>l.current.shouldFilter,label:d||e["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:y,inputId:j,labelId:b,listInnerRef:T}),[]);function B($,X){var Z,re;let W=(re=(Z=l.current)==null?void 0:Z.filter)!=null?re:Rge;return $?W($,r.current.search,X):0}function q(){if(!r.current.search||l.current.shouldFilter===!1)return;let $=r.current.filtered.items,X=[];r.current.filtered.groups.forEach(re=>{let W=a.current.get(re),J=0;W.forEach(V=>{let H=$.get(V);J=Math.max(H,J)}),X.push([re,J])});let Z=T.current;S().sort((re,W)=>{var J,V;let H=re.getAttribute("id"),ee=W.getAttribute("id");return((J=$.get(ee))!=null?J:0)-((V=$.get(H))!=null?V:0)}).forEach(re=>{let W=re.closest(c3);W?W.appendChild(re.parentElement===W?re:re.closest(`${c3} > *`)):Z.appendChild(re.parentElement===Z?re:re.closest(`${c3} > *`))}),X.sort((re,W)=>W[1]-re[1]).forEach(re=>{var W;let J=(W=T.current)==null?void 0:W.querySelector(`${e0}[${sm}="${encodeURIComponent(re[0])}"]`);J==null||J.parentElement.appendChild(J)})}function Y(){let $=S().find(Z=>Z.getAttribute("aria-disabled")!=="true"),X=$==null?void 0:$.getAttribute(sm);R.setState("value",X||void 0)}function G(){var $,X,Z,re;if(!r.current.search||l.current.shouldFilter===!1){r.current.filtered.count=s.current.size;return}r.current.filtered.groups=new Set;let W=0;for(let J of s.current){let V=(X=($=i.current.get(J))==null?void 0:$.value)!=null?X:"",H=(re=(Z=i.current.get(J))==null?void 0:Z.keywords)!=null?re:[],ee=B(V,H);r.current.filtered.items.set(J,ee),ee>0&&W++}for(let[J,V]of a.current)for(let H of V)if(r.current.filtered.items.get(H)>0){r.current.filtered.groups.add(J);break}r.current.filtered.count=W}function I(){var $,X,Z;let re=F();re&&((($=re.parentElement)==null?void 0:$.firstChild)===re&&((Z=(X=re.closest(e0))==null?void 0:X.querySelector(Oge))==null||Z.scrollIntoView({block:"nearest"})),re.scrollIntoView({block:"nearest"}))}function F(){var $;return($=T.current)==null?void 0:$.querySelector(`${iW}[aria-selected="true"]`)}function S(){var $;return Array.from((($=T.current)==null?void 0:$.querySelectorAll(_R))||[])}function E($){let X=S()[$];X&&R.setState("value",X.getAttribute(sm))}function N($){var X;let Z=F(),re=S(),W=re.findIndex(V=>V===Z),J=re[W+$];(X=l.current)!=null&&X.loop&&(J=W+$<0?re[re.length-1]:W+$===re.length?re[0]:re[W+$]),J&&R.setState("value",J.getAttribute(sm))}function C($){let X=F(),Z=X==null?void 0:X.closest(e0),re;for(;Z&&!re;)Z=$>0?Uge(Z,e0):Vge(Z,e0),re=Z==null?void 0:Z.querySelector(_R);re?R.setState("value",re.getAttribute(sm)):N($)}let k=()=>E(S().length-1),M=$=>{$.preventDefault(),$.metaKey?k():$.altKey?C(1):N(1)},U=$=>{$.preventDefault(),$.metaKey?E(0):$.altKey?C(-1):N(-1)};return P.createElement(er.div,{ref:t,tabIndex:-1,...v,"cmdk-root":"",onKeyDown:$=>{var X;(X=v.onKeyDown)==null||X.call(v,$);let Z=$.nativeEvent.isComposing||$.keyCode===229;if(!($.defaultPrevented||Z))switch($.key){case"n":case"j":{x&&$.ctrlKey&&M($);break}case"ArrowDown":{M($);break}case"p":case"k":{x&&$.ctrlKey&&U($);break}case"ArrowUp":{U($);break}case"Home":{$.preventDefault(),E(0);break}case"End":{$.preventDefault(),k();break}case"Enter":{$.preventDefault();let re=F();if(re){let W=new Event(xC);re.dispatchEvent(W)}}}}},P.createElement("label",{"cmdk-label":"",htmlFor:D.inputId,id:D.labelId,style:Hge},d),O_(e,$=>P.createElement(lW.Provider,{value:R},P.createElement(oW.Provider,{value:D},$))))}),Mge=P.forwardRef((e,t)=>{var r,s;let a=pa(),i=P.useRef(null),o=P.useContext(cW),l=d1(),d=uW(e),c=(s=(r=d.current)==null?void 0:r.forceMount)!=null?s:o==null?void 0:o.forceMount;sf(()=>{if(!c)return l.item(a,o==null?void 0:o.id)},[c]);let u=hW(a,i,[e.value,e.children,i],e.keywords),h=Sk(),f=Cu(O=>O.value&&O.value===u.current),m=Cu(O=>c||l.filter()===!1?!0:O.search?O.filtered.items.get(a)>0:!0);P.useEffect(()=>{let O=i.current;if(!(!O||e.disabled))return O.addEventListener(xC,p),()=>O.removeEventListener(xC,p)},[m,e.onSelect,e.disabled]);function p(){var O,R;g(),(R=(O=d.current).onSelect)==null||R.call(O,u.current)}function g(){h.setState("value",u.current,!0)}if(!m)return null;let{disabled:x,value:v,onSelect:y,forceMount:b,keywords:j,...T}=e;return P.createElement(er.div,{ref:Jc(i,t),...T,id:a,"cmdk-item":"",role:"option","aria-disabled":!!x,"aria-selected":!!f,"data-disabled":!!x,"data-selected":!!f,onPointerMove:x||l.getDisablePointerSelection()?void 0:g,onClick:x?void 0:p},e.children)}),Ige=P.forwardRef((e,t)=>{let{heading:r,children:s,forceMount:a,...i}=e,o=pa(),l=P.useRef(null),d=P.useRef(null),c=pa(),u=d1(),h=Cu(m=>a||u.filter()===!1?!0:m.search?m.filtered.groups.has(o):!0);sf(()=>u.group(o),[]),hW(o,l,[e.value,e.heading,d]);let f=P.useMemo(()=>({id:o,forceMount:a}),[a]);return P.createElement(er.div,{ref:Jc(l,t),...i,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},r&&P.createElement("div",{ref:d,"cmdk-group-heading":"","aria-hidden":!0,id:c},r),O_(e,m=>P.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?c:void 0},P.createElement(cW.Provider,{value:f},m))))}),Dge=P.forwardRef((e,t)=>{let{alwaysRender:r,...s}=e,a=P.useRef(null),i=Cu(o=>!o.search);return!r&&!i?null:P.createElement(er.div,{ref:Jc(a,t),...s,"cmdk-separator":"",role:"separator"})}),Lge=P.forwardRef((e,t)=>{let{onValueChange:r,...s}=e,a=e.value!=null,i=Sk(),o=Cu(c=>c.search),l=Cu(c=>c.selectedItemId),d=d1();return P.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),P.createElement(er.input,{ref:t,...s,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":d.listId,"aria-labelledby":d.labelId,"aria-activedescendant":l,id:d.inputId,type:"text",value:a?e.value:o,onChange:c=>{a||i.setState("search",c.target.value),r==null||r(c.target.value)}})}),Bge=P.forwardRef((e,t)=>{let{children:r,label:s="Suggestions",...a}=e,i=P.useRef(null),o=P.useRef(null),l=Cu(c=>c.selectedItemId),d=d1();return P.useEffect(()=>{if(o.current&&i.current){let c=o.current,u=i.current,h,f=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let m=c.offsetHeight;u.style.setProperty("--cmdk-list-height",m.toFixed(1)+"px")})});return f.observe(c),()=>{cancelAnimationFrame(h),f.unobserve(c)}}},[]),P.createElement(er.div,{ref:Jc(i,t),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":s,id:d.listId},O_(e,c=>P.createElement("div",{ref:Jc(o,d.listInnerRef),"cmdk-list-sizer":""},c)))}),$ge=P.forwardRef((e,t)=>{let{open:r,onOpenChange:s,overlayClassName:a,contentClassName:i,container:o,...l}=e;return P.createElement(r1,{open:r,onOpenChange:s},P.createElement(n1,{container:o},P.createElement(wf,{"cmdk-overlay":"",className:a}),P.createElement(_f,{"aria-label":e.label,"cmdk-dialog":"",className:i},P.createElement(dW,{ref:t,...l}))))}),Fge=P.forwardRef((e,t)=>Cu(r=>r.filtered.count===0)?P.createElement(er.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),zge=P.forwardRef((e,t)=>{let{progress:r,children:s,label:a="Loading...",...i}=e;return P.createElement(er.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},O_(e,o=>P.createElement("div",{"aria-hidden":!0},o)))}),Gi=Object.assign(dW,{List:Bge,Item:Mge,Input:Lge,Group:Ige,Separator:Dge,Dialog:$ge,Empty:Fge,Loading:zge});function Uge(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function Vge(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function uW(e){let t=P.useRef(e);return sf(()=>{t.current=e}),t}var sf=typeof window>"u"?P.useEffect:P.useLayoutEffect;function am(e){let t=P.useRef();return t.current===void 0&&(t.current=e()),t}function Cu(e){let t=Sk(),r=()=>e(t.snapshot());return P.useSyncExternalStore(t.subscribe,r,r)}function hW(e,t,r,s=[]){let a=P.useRef(),i=d1();return sf(()=>{var o;let l=(()=>{var c;for(let u of r){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():a.current}})(),d=s.map(c=>c.trim());i.value(e,l,d),(o=t.current)==null||o.setAttribute(sm,l),a.current=l}),a}var qge=()=>{let[e,t]=P.useState(),r=am(()=>new Map);return sf(()=>{r.current.forEach(s=>s()),r.current=new Map},[e]),(s,a)=>{r.current.set(s,a),t({})}};function Wge(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function O_({asChild:e,children:t},r){return e&&P.isValidElement(t)?P.cloneElement(Wge(t),{ref:t.ref},r(t.props.children)):r(t)}var Hge={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Ck=P.forwardRef(({className:e,...t},r)=>n.jsx(Gi,{ref:r,className:He("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));Ck.displayName=Gi.displayName;const fW=P.forwardRef(({className:e,...t},r)=>n.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[n.jsx(On,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),n.jsx(Gi.Input,{ref:r,className:He("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));fW.displayName=Gi.Input.displayName;const Ek=P.forwardRef(({className:e,...t},r)=>n.jsx(Gi.List,{ref:r,className:He("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));Ek.displayName=Gi.List.displayName;const kk=P.forwardRef((e,t)=>n.jsx(Gi.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));kk.displayName=Gi.Empty.displayName;const Ak=P.forwardRef(({className:e,...t},r)=>n.jsx(Gi.Group,{ref:r,className:He("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));Ak.displayName=Gi.Group.displayName;const Gge=P.forwardRef(({className:e,...t},r)=>n.jsx(Gi.Separator,{ref:r,className:He("-mx-1 h-px bg-border",e),...t}));Gge.displayName=Gi.Separator.displayName;const Tk=P.forwardRef(({className:e,...t},r)=>n.jsx(Gi.Item,{ref:r,className:He("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...t}));Tk.displayName=Gi.Item.displayName;var R_="Popover",[mW,eQe]=ea(R_,[bc]),u1=bc(),[Kge,Fu]=mW(R_),pW=e=>{const{__scopePopover:t,children:r,open:s,defaultOpen:a,onOpenChange:i,modal:o=!1}=e,l=u1(t),d=P.useRef(null),[c,u]=P.useState(!1),[h,f]=Ui({prop:s,defaultProp:a??!1,onChange:i,caller:R_});return n.jsx(Yv,{...l,children:n.jsx(Kge,{scope:t,contentId:pa(),triggerRef:d,open:h,onOpenChange:f,onOpenToggle:P.useCallback(()=>f(m=>!m),[f]),hasCustomAnchor:c,onCustomAnchorAdd:P.useCallback(()=>u(!0),[]),onCustomAnchorRemove:P.useCallback(()=>u(!1),[]),modal:o,children:r})})};pW.displayName=R_;var gW="PopoverAnchor",Xge=P.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=Fu(gW,r),i=u1(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=a;return P.useEffect(()=>(o(),()=>l()),[o,l]),n.jsx(ng,{...i,...s,ref:t})});Xge.displayName=gW;var xW="PopoverTrigger",vW=P.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=Fu(xW,r),i=u1(r),o=Rr(t,a.triggerRef),l=n.jsx(er.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":jW(a.open),...s,ref:o,onClick:Tt(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?l:n.jsx(ng,{asChild:!0,...i,children:l})});vW.displayName=xW;var Pk="PopoverPortal",[Yge,Zge]=mW(Pk,{forceMount:void 0}),yW=e=>{const{__scopePopover:t,forceMount:r,children:s,container:a}=e,i=Fu(Pk,t);return n.jsx(Yge,{scope:t,forceMount:r,children:n.jsx(Ws,{present:r||i.open,children:n.jsx(Qp,{asChild:!0,container:a,children:s})})})};yW.displayName=Pk;var pp="PopoverContent",bW=P.forwardRef((e,t)=>{const r=Zge(pp,e.__scopePopover),{forceMount:s=r.forceMount,...a}=e,i=Fu(pp,e.__scopePopover);return n.jsx(Ws,{present:s||i.open,children:i.modal?n.jsx(Jge,{...a,ref:t}):n.jsx(e0e,{...a,ref:t})})});bW.displayName=pp;var Qge=yu("PopoverContent.RemoveScroll"),Jge=P.forwardRef((e,t)=>{const r=Fu(pp,e.__scopePopover),s=P.useRef(null),a=Rr(t,s),i=P.useRef(!1);return P.useEffect(()=>{const o=s.current;if(o)return y_(o)},[]),n.jsx(t1,{as:Qge,allowPinchZoom:!0,children:n.jsx(wW,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Tt(e.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=r.triggerRef.current)==null||l.focus()}),onPointerDownOutside:Tt(e.onPointerDownOutside,o=>{const l=o.detail.originalEvent,d=l.button===0&&l.ctrlKey===!0,c=l.button===2||d;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Tt(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),e0e=P.forwardRef((e,t)=>{const r=Fu(pp,e.__scopePopover),s=P.useRef(!1),a=P.useRef(!1);return n.jsx(wW,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(s.current||(l=r.triggerRef.current)==null||l.focus(),i.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:i=>{var d,c;(d=e.onInteractOutside)==null||d.call(e,i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((c=r.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),wW=P.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:c,onInteractOutside:u,...h}=e,f=Fu(pp,r),m=u1(r);return x_(),n.jsx(e1,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:i,children:n.jsx(Ou,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:l,onPointerDownOutside:d,onFocusOutside:c,onDismiss:()=>f.onOpenChange(!1),children:n.jsx(Zv,{"data-state":jW(f.open),role:"dialog",id:f.contentId,...m,...h,ref:t,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),_W="PopoverClose",t0e=P.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=Fu(_W,r);return n.jsx(er.button,{type:"button",...s,ref:t,onClick:Tt(e.onClick,()=>a.onOpenChange(!1))})});t0e.displayName=_W;var r0e="PopoverArrow",n0e=P.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=u1(r);return n.jsx(Qv,{...a,...s,ref:t})});n0e.displayName=r0e;function jW(e){return e?"open":"closed"}var s0e=pW,a0e=vW,i0e=yW,NW=bW;const ci=s0e,di=a0e,Ga=P.forwardRef(({className:e,align:t="center",sideOffset:r=4,...s},a)=>n.jsx(i0e,{children:n.jsx(NW,{ref:a,align:t,sideOffset:r,className:He("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})}));Ga.displayName=NW.displayName;const o0e=["Vestidos","Blusas","Calas","Saias","Conjuntos","Acessrios","Blazers","Shorts","Casacos","Macaces","Camisas"],l0e=["Preto","Branco","Bege","Rosa","Azul","Verde","Vermelho","Marrom","Cinza","Estampado"],c0e=["elegante","clssico","minimal","romntico","casual","moderno","fashion","sexy_chic"],d0e=["trabalho","casual","festa","dia a dia","especial","casual_chic","eventos","viagem"],u0e=["ajustado","regular","soltinho","oversized","acinturado","slim","reto","amplo"],h0e=["premium","bsico","tendncia","atemporal","verstil","sofisticado","confortvel","leve","estruturado","fluido","minimalista","estampado","bordado","renda","cetim","linho","algodo","seda","alfaiataria","vero","inverno","meia-estao","praia","escritrio","noite"],f0e={category:"Categoria",color:"Cor",style:"Estilo",occasion:"Ocasio",modeling:"Modelagem"},m0e={category:o0e,color:l0e,style:c0e,occasion:d0e,modeling:u0e},p0e={vestido:"Vestidos",blazer:"Blazers",cala:"Calas",camisa:"Camisas",saia:"Saias",conjunto:"Conjuntos",short:"Shorts",casaco:"Casacos",macaco:"Macaces",blusa:"Blusas"},g0e={preto:"Preto",branco:"Branco",bege:"Bege",rosa:"Rosa",azul:"Azul",verde:"Verde",vermelho:"Vermelho",marrom:"Marrom",cinza:"Cinza",estampado:"Estampado"};function jR(e,t){return t?e==="category"?p0e[t.toLowerCase()]||t:e==="color"&&g0e[t.toLowerCase()]||t:null}function x0e({confidence:e}){return e>=.8?n.jsx(ke,{variant:"secondary",className:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 text-xs",children:"Alta"}):e>=.5?n.jsx(ke,{variant:"secondary",className:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 text-xs",children:"Mdia"}):n.jsx(ke,{variant:"secondary",className:"bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-300 text-xs",children:"Baixa"})}function v0e({fieldKey:e,aiValue:t,confidence:r,editedValue:s,isSelected:a,onValueChange:i,onSelectionChange:o}){const l=m0e[e]||[],d=s||"";return n.jsxs("div",{className:"border rounded-lg p-3 space-y-2 bg-background",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Va,{id:`select-${e}`,checked:a,onCheckedChange:c=>o(c===!0)}),n.jsx("label",{htmlFor:`select-${e}`,className:"font-medium text-sm flex-1 cursor-pointer",children:f0e[e]}),n.jsx(x0e,{confidence:r})]}),n.jsxs(Xt,{value:d,onValueChange:c=>i(c||null),children:[n.jsx(Ht,{className:"w-full",children:n.jsx(Yt,{placeholder:"Selecione..."})}),n.jsx(Gt,{children:l.map(c=>n.jsx(qe,{value:c,className:"capitalize",children:c},c))})]}),t&&s!==t&&n.jsxs("p",{className:"text-xs text-muted-foreground",children:["Sugesto original: ",n.jsx("span",{className:"capitalize",children:t})]})]})}function y0e({tags:e,onTagsChange:t}){const[r,s]=P.useState(""),[a,i]=P.useState(!1),o=P.useRef(null),l=h0e.filter(h=>!e.includes(h)&&h.toLowerCase().includes(r.toLowerCase())).slice(0,6),d=h=>{var m;const f=h.trim().toLowerCase();f&&!e.includes(f)&&t([...e,f]),s(""),i(!1),(m=o.current)==null||m.focus()},c=h=>{t(e.filter(f=>f!==h))},u=h=>{h.key==="Enter"&&r.trim()&&(h.preventDefault(),d(r))};return n.jsxs("div",{className:"border rounded-lg p-3 space-y-3 bg-background",children:[n.jsx("span",{className:"font-medium text-sm",children:"Tags Sugeridas"}),n.jsx("div",{className:"flex flex-wrap gap-1.5",children:e.map(h=>n.jsxs(ke,{variant:"secondary",className:"capitalize flex items-center gap-1 pr-1",children:[h,n.jsx("button",{type:"button",onClick:()=>c(h),className:"ml-1 hover:bg-muted rounded-full p-0.5",children:n.jsx(sn,{className:"h-3 w-3"})})]},h))}),n.jsxs(ci,{open:a,onOpenChange:i,children:[n.jsx(di,{asChild:!0,children:n.jsxs("div",{className:"relative",children:[n.jsx(et,{ref:o,value:r,onChange:h=>{s(h.target.value),h.target.value&&i(!0)},onFocus:()=>r&&i(!0),onKeyDown:u,placeholder:"Adicionar tag...",className:"pr-8"}),n.jsx(he,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 -translate-y-1/2 h-6 w-6 p-0",onClick:()=>r&&d(r),children:n.jsx(kn,{className:"h-4 w-4"})})]})}),l.length>0&&n.jsx(Ga,{className:"p-0 w-[var(--radix-popover-trigger-width)]",align:"start",children:n.jsx(Ck,{children:n.jsxs(Ek,{children:[n.jsx(kk,{children:"Nenhuma sugesto"}),n.jsx(Ak,{children:l.map(h=>n.jsx(Tk,{value:h,onSelect:()=>d(h),className:"capitalize cursor-pointer",children:h},h))})]})})})]})]})}function b0e({analysis:e,onApply:t,onApplyAll:r,onApplySelected:s,onDismiss:a,currentValues:i}){const o=["category","color","style","occasion","modeling"],l={category:"categoria",color:"cor",style:"estilo",occasion:"ocasiao",modeling:"modelagem"},[d,c]=P.useState(()=>{const x={category:{selected:!0,value:null},color:{selected:!0,value:null},style:{selected:!0,value:null},occasion:{selected:!0,value:null},modeling:{selected:!0,value:null},tags:[]};return o.forEach(v=>{const y=e[l[v]],b=jR(v,y.value);x[v]={selected:!!b,value:b}}),x.tags=e.tags_extras||[],x}),u=(x,v)=>{c(y=>({...y,[x]:{...y[x],value:v}}))},h=(x,v)=>{c(y=>({...y,[x]:{...y[x],selected:v}}))},f=x=>{c(v=>({...v,tags:x}))},m=()=>{s(d)},p=()=>{const x={...d};o.forEach(v=>{x[v]={...x[v],selected:!0}}),s(x)},g=o.filter(x=>d[x].selected&&d[x].value).length;return n.jsxs("div",{className:"bg-accent/30 border border-accent rounded-xl p-4 space-y-4 animate-fade-in",children:[n.jsxs("div",{className:"flex items-center gap-2 text-accent-foreground",children:[n.jsx(Gr,{className:"h-5 w-5"}),n.jsx("h4",{className:"font-medium",children:"Sugestes da IA"}),n.jsx("span",{className:"text-xs text-muted-foreground ml-auto",children:"Edite os valores antes de aplicar"})]}),n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:o.map(x=>{const v=e[l[x]];return n.jsx(v0e,{fieldKey:x,aiValue:jR(x,v.value),confidence:v.confidence,editedValue:d[x].value,isSelected:d[x].selected,onValueChange:y=>u(x,y),onSelectionChange:y=>h(x,y)},x)})}),n.jsx(y0e,{tags:d.tags,onTagsChange:f}),n.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[n.jsxs(he,{type:"button",size:"sm",onClick:m,disabled:g===0,className:"flex-1 min-w-[140px]",children:[n.jsx(gn,{className:"h-4 w-4 mr-1"}),"Aplicar selecionados (",g,")"]}),n.jsx(he,{type:"button",size:"sm",variant:"secondary",onClick:p,className:"flex-1 min-w-[140px]",children:"Aplicar todas sugestes"}),n.jsx(he,{type:"button",size:"sm",variant:"ghost",onClick:a,children:"Dispensar"})]})]})}const t0=5;function w0e({images:e,mainImageIndex:t,videoUrl:r,onImagesChange:s,onVideoChange:a,userId:i}){const[o,l]=P.useState(!1),[d,c]=P.useState(!1),[u,h]=P.useState(null),f=async b=>{const j=b.target.files;if(!j||j.length===0)return;const T=t0-e.length;if(T<=0){de.error(`Mximo de ${t0} imagens`);return}const O=Array.from(j).slice(0,T);l(!0);try{const R=[];for(const D of O){const B=`${i}/${Date.now()}-${D.name}`,{error:q}=await le.storage.from("products").upload(B,D);if(q)throw q;const{data:Y}=le.storage.from("products").getPublicUrl(B);R.push(Y.publicUrl)}s([...e,...R],t),de.success(`${R.length} imagem(ns) enviada(s)`)}catch(R){console.error("Error uploading images:",R),de.error("Erro ao enviar imagens")}finally{l(!1),b.target.value=""}},m=async b=>{var T;const j=(T=b.target.files)==null?void 0:T[0];if(j){if(j.size>50*1024*1024){de.error("Vdeo muito grande (mx 50MB)");return}c(!0);try{const O=`${i}/videos/${Date.now()}-${j.name}`,{error:R}=await le.storage.from("products").upload(O,j);if(R)throw R;const{data:D}=le.storage.from("products").getPublicUrl(O);a(D.publicUrl),de.success("Vdeo enviado!")}catch(O){console.error("Error uploading video:",O),de.error("Erro ao enviar vdeo")}finally{c(!1),b.target.value=""}}},p=b=>{const j=e.filter((O,R)=>R!==b);let T=t;b===t?T=0:b<t&&(T=t-1),s(j,Math.min(T,j.length-1))},g=b=>{s(e,b),de.success("Imagem principal atualizada")},x=b=>{h(b)},v=(b,j)=>{if(b.preventDefault(),u===null||u===j)return;const T=[...e],[O]=T.splice(u,1);T.splice(j,0,O);let R=t;t===u?R=j:u<t&&j>=t?R=t-1:u>t&&j<=t&&(R=t+1),s(T,R),h(j)},y=()=>{h(null)};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm font-medium",children:["Imagens (",e.length,"/",t0,")"]}),e.length<t0&&n.jsxs(he,{type:"button",variant:"outline",size:"sm",onClick:()=>{var b;return(b=document.getElementById("multi-image-upload"))==null?void 0:b.click()},disabled:o,children:[n.jsx(Lh,{className:"h-4 w-4 mr-1"}),o?"Enviando...":"Adicionar"]}),n.jsx("input",{id:"multi-image-upload",type:"file",accept:"image/*",multiple:!0,onChange:f,className:"hidden"})]}),n.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-2",children:[e.map((b,j)=>n.jsxs("div",{draggable:!0,onDragStart:()=>x(j),onDragOver:T=>v(T,j),onDragEnd:y,className:`relative aspect-square rounded-lg overflow-hidden border-2 cursor-move group ${j===t?"border-accent ring-2 ring-accent/30":"border-border"} ${u===j?"opacity-50":""}`,children:[n.jsx("img",{src:b,alt:`Imagem ${j+1}`,className:"w-full h-full object-cover"}),n.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-1",children:[n.jsx(he,{type:"button",size:"icon",variant:"ghost",className:"h-7 w-7 text-white hover:bg-white/20",onClick:()=>g(j),title:"Definir como principal",children:n.jsx(wi,{className:`h-4 w-4 ${j===t?"fill-yellow-400 text-yellow-400":""}`})}),n.jsx(he,{type:"button",size:"icon",variant:"ghost",className:"h-7 w-7 text-white hover:bg-white/20",onClick:()=>p(j),title:"Remover",children:n.jsx(sn,{className:"h-4 w-4"})})]}),j===t&&n.jsx("span",{className:"absolute top-1 left-1 text-[10px] bg-accent text-accent-foreground px-1.5 py-0.5 rounded",children:"Principal"}),n.jsx("div",{className:"absolute bottom-1 right-1 text-white/60",children:n.jsx(T6,{className:"h-3 w-3"})})]},b)),e.length<t0&&n.jsx("button",{type:"button",onClick:()=>{var b;return(b=document.getElementById("multi-image-upload"))==null?void 0:b.click()},className:"aspect-square rounded-lg border-2 border-dashed border-border hover:border-accent flex items-center justify-center transition-colors",children:n.jsx(Lh,{className:"h-5 w-5 text-muted-foreground"})})]}),n.jsxs("div",{className:"pt-4 border-t border-border",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("span",{className:"text-sm font-medium flex items-center gap-1.5",children:[n.jsx(vse,{className:"h-4 w-4"}),"Vdeo (opcional)"]}),!r&&n.jsxs(he,{type:"button",variant:"outline",size:"sm",onClick:()=>{var b;return(b=document.getElementById("video-upload"))==null?void 0:b.click()},disabled:d,children:[n.jsx(Lh,{className:"h-4 w-4 mr-1"}),d?"Enviando...":"Adicionar vdeo"]}),n.jsx("input",{id:"video-upload",type:"file",accept:"video/*",onChange:m,className:"hidden"})]}),r&&n.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden bg-black",children:[n.jsx("video",{src:r,controls:!0,className:"w-full h-full object-contain"}),n.jsx(he,{type:"button",size:"icon",variant:"secondary",className:"absolute top-2 right-2 h-7 w-7",onClick:()=>a(null),children:n.jsx(sn,{className:"h-4 w-4"})})]})]})]})}const _0e={"elegante estratgica":["elegante","clssico","minimal"],"romntica sofisticada":["romntico","elegante","fashion"],"moderna urbana":["moderno","casual","minimal"],"clssica atemporal":["clssico","elegante","minimal"],"fashion ousada":["fashion","moderno","sexy_chic"],"casual chic":["casual","moderno","minimal"]},j0e={trabalho:["trabalho","office","reunio","escritrio"],casual:["casual","dia a dia","passeio","lazer"],festa:["festa","balada","evento","especial"]},N0e={neutros:["preto","branco","bege","cinza","nude","off white"],cores:["azul","verde","vermelho","rosa","amarelo","laranja","roxo","lils"],estampado:["estampado","floral","animal print"]};function Ed(e){return e?e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""):""}function S0e(e,t,r){const s=[];let a=0;const i=Ed(e.category),o=Ed(e.style),l=Ed(e.occasion),d=Ed(e.color),c=Ed(t.style_title),u=r.map(h=>Ed(h.answer)).join(" ");if(r.map(h=>Ed(h.question)).join(" "),i&&({vestidos:["vestido","dress"],blusas:["blusa","top","camisa"],calas:["calca","pants"],saias:["saia","skirt"],conjuntos:["conjunto","set"],blazers:["blazer","casaco"]}[i]||[i]).some(m=>u.includes(m))&&(a+=3,s.push({type:"category",label:`Categoria ${e.category}`,points:3})),o&&c){if(c.includes(o))a+=3,s.push({type:"style",label:`Estilo ${e.style}`,points:3});else for(const[h,f]of Object.entries(_0e))if(c.includes(Ed(h))&&f.includes(o)){a+=3,s.push({type:"style",label:`Estilo combina com ${t.style_title}`,points:3});break}}if(l){for(const[h,f]of Object.entries(j0e))if(f.some(m=>l.includes(m))&&f.some(m=>u.includes(m))){a+=2,s.push({type:"occasion",label:`Ocasio ${e.occasion}`,points:2});break}}if(d){if(u.includes(d))a+=2,s.push({type:"color",label:`Cor ${e.color}`,points:2});else for(const[h,f]of Object.entries(N0e))if(f.includes(d)&&(u.includes(h)||u.includes(f[0]))){a+=2,s.push({type:"color",label:`Cor ${e.color}`,points:2});break}}return t.size&&e.stock_by_size&&(e.stock_by_size[t.size]||0)>0&&(a+=5,s.push({type:"size",label:`Tamanho ${t.size} disponvel`,points:5})),a===0?null:{customer_id:t.id,score:a,reasons:s}}async function SW(e){try{const{data:t,error:r}=await le.from("product_catalog").select("id, category, color, style, occasion, stock_by_size, name").eq("id",e).single();if(r||!t)return{success:!1,count:0,error:"Produto no encontrado"};const{data:s,error:a}=await le.from("customers").select("id, phone, name, size, style_title");if(a)return{success:!1,count:0,error:"Erro ao carregar clientes"};const i=(s||[]).filter(f=>f.style_title);if(i.length===0)return{success:!0,count:0};const o=i.map(f=>f.id),{data:l}=await le.from("quiz_responses").select("customer_id, question, answer").in("customer_id",o),d={};(l||[]).forEach(f=>{d[f.customer_id]||(d[f.customer_id]=[]),d[f.customer_id].push(f)});const c=[];for(const f of i){const m=d[f.id]||[],p=S0e(t,f,m);p&&c.push(p)}if(c.length===0)return await le.from("customer_product_suggestions").delete().eq("product_id",e),{success:!0,count:0};await le.from("customer_product_suggestions").delete().eq("product_id",e);const u=c.map(f=>({product_id:e,customer_id:f.customer_id,score:f.score,reasons:JSON.parse(JSON.stringify(f.reasons))})),{error:h}=await le.from("customer_product_suggestions").insert(u);return h?(console.error("Error inserting suggestions:",h),{success:!1,count:0,error:"Erro ao salvar sugestes"}):{success:!0,count:c.length}}catch(t){return console.error("Error in suggestCustomersForProduct:",t),{success:!1,count:0,error:"Erro inesperado"}}}function C0e({productId:e,productName:t}){const r=pr(),[s,a]=P.useState([]),[i,o]=P.useState(!0),[l,d]=P.useState(!1),[c,u]=P.useState(null);P.useEffect(()=>{h()},[e]);const h=async()=>{try{const{data:y,error:b}=await le.from("customer_product_suggestions").select("*").eq("product_id",e).order("score",{ascending:!1});if(b)throw b;if(!y||y.length===0){a([]);return}const j=y.map(D=>D.customer_id),{data:T}=await le.from("customers").select("id, name, phone, size, style_title").in("id",j),O={};(T||[]).forEach(D=>{O[D.id]=D});const R=y.filter(D=>O[D.customer_id]).map(D=>({...D,reasons:D.reasons,customer:O[D.customer_id]}));a(R)}catch(y){console.error("Error loading suggestions:",y)}finally{o(!1)}},f=async()=>{d(!0);try{const y=await SW(e);y.success?(de.success(`${y.count} cliente(s) sugerido(s)`),h()):de.error(y.error||"Erro ao atualizar sugestes")}catch{de.error("Erro ao atualizar sugestes")}finally{d(!1)}},m=y=>{const b=y.replace(/\D/g,"");return b.length===11?`(${b.slice(0,2)}) ${b.slice(2,7)}-${b.slice(7)}`:y},p=y=>{const b=y.customer.name||"",j=y.customer.size,T=j?` Tenho no seu tamanho ${j}`:"";return`Oi${b?` ${b}`:""}! Chegou uma pea que tem tudo a ver com voc ${t}${T} `},g=y=>{const b=p(y);navigator.clipboard.writeText(b),u(y.id),de.success("Mensagem copiada!"),setTimeout(()=>u(null),2e3)},x=async y=>{await le.from("customer_product_suggestions").update({notified:!0}).eq("id",y),a(b=>b.map(j=>j.id===y?{...j,notified:!0}:j))},v=y=>{switch(y){case"style":return n.jsx(Gr,{className:"h-3 w-3"});case"size":return n.jsx(ose,{className:"h-3 w-3"});case"category":return n.jsx(ua,{className:"h-3 w-3"});case"color":return n.jsx(n_,{className:"h-3 w-3"});case"occasion":return n.jsx(ns,{className:"h-3 w-3"});default:return null}};return i?n.jsx($e,{children:n.jsx(Fe,{className:"py-8 flex justify-center",children:n.jsx(Et,{className:"h-6 w-6 animate-spin text-muted-foreground"})})}):n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Lt,{className:"text-lg flex items-center gap-2",children:[n.jsx(Ha,{className:"h-5 w-5"}),"Clientes para avisar",s.length>0&&n.jsx(ke,{variant:"secondary",children:s.length})]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:f,disabled:l,className:"gap-1",children:[l?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):n.jsx(Qr,{className:"h-4 w-4"}),"Atualizar"]})]})}),n.jsx(Fe,{children:s.length===0?n.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[n.jsx(Ha,{className:"h-10 w-10 mx-auto mb-3 opacity-50"}),n.jsx("p",{className:"mb-2",children:"Nenhum cliente sugerido ainda."}),n.jsx("p",{className:"text-sm",children:"Clientes com quiz completado sero sugeridos com base no match de estilo."})]}):n.jsx("div",{className:"space-y-3",children:s.map(y=>n.jsx("div",{className:`border rounded-lg p-4 ${y.notified?"bg-muted/30 border-border":"bg-card border-primary/20"}`,children:n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("button",{onClick:()=>r(`/dashboard/clientes/${y.customer.id}`),className:"font-medium hover:text-primary transition-colors truncate",children:y.customer.name||"Cliente sem nome"}),n.jsxs(ke,{variant:y.score>=10?"default":"secondary",className:"shrink-0",children:["Score: ",y.score]}),y.notified&&n.jsxs(ke,{variant:"outline",className:"shrink-0 text-green-600",children:[n.jsx(gn,{className:"h-3 w-3 mr-1"}),"Avisado"]})]}),n.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[m(y.customer.phone),y.customer.size&&`  Tam. ${y.customer.size}`,y.customer.style_title&&`  ${y.customer.style_title}`]}),n.jsx("div",{className:"flex flex-wrap gap-1.5",children:y.reasons.map((b,j)=>n.jsxs(ke,{variant:"outline",className:"text-xs gap-1 bg-background",children:[v(b.type),b.label,n.jsxs("span",{className:"text-primary",children:["+",b.points]})]},j))})]}),n.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[n.jsx(he,{variant:"outline",size:"sm",onClick:()=>g(y),className:"gap-1",children:c===y.id?n.jsx(gn,{className:"h-4 w-4"}):n.jsx(Wa,{className:"h-4 w-4"})}),n.jsxs("a",{href:po(p(y)),target:"_blank",rel:"noopener noreferrer",onClick:()=>x(y.id),className:"inline-flex items-center justify-center gap-1.5 h-9 px-3 rounded-md text-sm font-medium bg-[#25D366] text-white hover:bg-[#1EBE5D] transition-colors",children:[n.jsx(nn,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"WhatsApp"})]})]})]})},y.id))})})]})}const E0e=["34","36","38","40","42","44","46"],k0e=["PP","P","M","G","GG"],NR=[...E0e,...k0e];function gp(e){return[...e].sort((t,r)=>{const s=NR.indexOf(t),a=NR.indexOf(r);return s!==-1&&a!==-1?s-a:s!==-1?-1:a!==-1?1:t.localeCompare(r)})}function A0e(e){return!e||typeof e!="object"?0:Object.values(e).reduce((r,s)=>r+(typeof s=="number"?s:0),0)}const T0e=["PP","P","M","G","GG"],P0e=["34","36","38","40","42","44","46"];function O0e({stock:e,onChange:t}){const r=(a,i)=>{const o=parseInt(i)||0,l={...e,[a]:Math.max(0,o)};t(l)},s=Object.values(e).reduce((a,i)=>a+(i||0),0);return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Be,{className:"text-base",children:"Estoque por Tamanho"}),n.jsxs("span",{className:"text-sm text-muted-foreground",children:["Total: ",n.jsx("span",{className:"font-medium text-foreground",children:s})," unidades"]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-xs text-muted-foreground block mb-2",children:"Tamanhos letras"}),n.jsx("div",{className:"grid grid-cols-5 gap-2",children:T0e.map(a=>n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-xs font-medium text-center block",children:a}),n.jsx(et,{type:"number",min:"0",value:e[a]||"",onChange:i=>r(a,i.target.value),placeholder:"0",className:"text-center h-9"})]},a))})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-xs text-muted-foreground block mb-2",children:"Tamanhos numricos"}),n.jsx("div",{className:"grid grid-cols-7 gap-2",children:P0e.map(a=>n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-xs font-medium text-center block",children:a}),n.jsx(et,{type:"number",min:"0",value:e[a]||"",onChange:i=>r(a,i.target.value),placeholder:"0",className:"text-center h-9"})]},a))})]})]})}function CW(e){if(!e||typeof e!="object")return[];const r=Object.entries(e).filter(([s,a])=>typeof a=="number"&&a>0).map(([s])=>s);return gp(r)}function SR(e,t){return!e||typeof e!="object"?0:e[t]||0}function R0e(e,t){return SR(e,t)>0&&SR(e,t)<=2}function M0e({discountType:e,discountValue:t,onDiscountTypeChange:r,onDiscountValueChange:s,label:a="Desconto"}){return n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:a}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(Xt,{value:e||"_none",onValueChange:i=>r(i==="_none"?null:i),children:[n.jsx(Ht,{className:"w-[140px]",children:n.jsx(Yt,{placeholder:"Sem desconto"})}),n.jsxs(Gt,{className:"bg-background z-50",children:[n.jsx(qe,{value:"_none",children:"Sem desconto"}),n.jsx(qe,{value:"percentage",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Uo,{className:"h-3 w-3"})," Porcentagem"]})}),n.jsx(qe,{value:"fixed",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ks,{className:"h-3 w-3"})," Valor fixo"]})})]})]}),e&&n.jsxs("div",{className:"relative flex-1",children:[n.jsx(et,{type:"number",min:"0",step:e==="percentage"?"1":"0.01",max:e==="percentage"?"100":void 0,value:t??"",onChange:i=>s(i.target.value?parseFloat(i.target.value):null),placeholder:e==="percentage"?"Ex: 10":"Ex: 15.00",className:"pr-8"}),n.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm",children:e==="percentage"?"%":"R$"})]})]}),e&&t&&n.jsx("p",{className:"text-xs text-muted-foreground",children:e==="percentage"?`${t}% de desconto ser aplicado`:`R$ ${t.toFixed(2)} de desconto ser aplicado`})]})}function I0e(e,t,r){return!t||!r?e:t==="percentage"?e*(1-r/100):Math.max(0,e-r)}const d3={Blusas:.25,Vestidos:.45,Calas:.6,Blazers:.7,Casacos:.8,Camisas:.25,Saias:.3,Shorts:.25,Conjuntos:.85,Macaces:.85,Acessrios:.2},Tc={length:30,width:20,height:10},D0e=["Vestidos","Blusas","Calas","Saias","Conjuntos","Acessrios","Blazers","Shorts","Casacos","Macaces","Camisas"],r0=["Preto","Branco","Bege","Rosa","Azul","Verde","Vermelho","Marrom","Cinza","Estampado","Off White","Chocolate","Menta","Nude","Caramelo","Mostarda","Vinho","Laranja","Amarelo","Lils","Roxo","Coral"],L0e=["elegante","clssico","minimal","romntico","casual","moderno","fashion","sexy_chic"],B0e=["trabalho","casual","festa","dia a dia","especial","casual_chic","eventos","viagem"],$0e=["ajustado","regular","soltinho","oversized","acinturado","slim","reto","amplo"],vC={preto:"Preto",branco:"Branco",bege:"Bege",rosa:"Rosa",azul:"Azul",verde:"Verde",vermelho:"Vermelho",marrom:"Marrom",cinza:"Cinza",estampado:"Estampado","off white":"Off White",offwhite:"Off White","off-white":"Off White",chocolate:"Chocolate",menta:"Menta",nude:"Nude",caramelo:"Caramelo",mostarda:"Mostarda",vinho:"Vinho",laranja:"Laranja",amarelo:"Amarelo",lilas:"Lils",lils:"Lils",roxo:"Roxo",coral:"Coral"};function F0e(e){if(!e)return null;const t=e.trim().toLowerCase();return vC[t]?vC[t]:e.trim().split(/\s+/).map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" ")}const CR={vestido:"Vestidos",blazer:"Blazers",cala:"Calas",camisa:"Camisas",saia:"Saias",conjunto:"Conjuntos",short:"Shorts",casaco:"Casacos",macaco:"Macaces",blusa:"Blusas"},ER=vC;function z0e({open:e,onOpenChange:t,product:r,onSuccess:s,userId:a}){const[i,o]=P.useState(!1),[l,d]=P.useState(!1),[c,u]=P.useState([]),[h,f]=P.useState(0),[m,p]=P.useState(null),[g,x]=P.useState({}),[v,y]=P.useState({name:"",sku:null,category:null,price:0,color:null,style:null,occasion:null,modeling:null,sizes:[],is_active:!0,image_url:null,tags:[],description:null,weight_kg:.3,length_cm:Tc.length,width_cm:Tc.width,height_cm:Tc.height,discount_type:null,discount_value:null}),{isAnalyzing:b,analysisResult:j,analyzeImage:T,clearAnalysis:O}=FV(),[R,D]=P.useState(r0);P.useEffect(()=>{if(r){const N=F0e(r.color);y({...r,sku:r.sku||r.group_key||null,color:N,sizes:r.sizes||[],tags:r.tags||[],weight_kg:r.weight_kg??null,length_cm:r.length_cm??null,width_cm:r.width_cm??null,height_cm:r.height_cm??null,discount_type:r.discount_type??null,discount_value:r.discount_value??null}),u(r.images||(r.image_url?[r.image_url]:[])),f(r.main_image_index||0),p(r.video_url||null),x(r.stock_by_size||{}),N&&!r0.includes(N)?D([...r0,N]):D(r0)}else y({name:"",sku:null,category:null,price:0,color:null,style:null,occasion:null,modeling:null,sizes:[],is_active:!0,image_url:null,tags:[],description:null,weight_kg:.3,length_cm:Tc.length,width_cm:Tc.width,height_cm:Tc.height,discount_type:null,discount_value:null}),u([]),f(0),p(null),x({}),D(r0);O()},[r,e]);const B=(N,C)=>{u(N),f(C)},q=async()=>{const N=c[h]||c[0];if(!N){de.error("Envie uma imagem primeiro");return}await T(N)},Y=(N,C)=>{let k=C;N==="category"?k=CR[C.toLowerCase()]||C:N==="color"&&(k=ER[C.toLowerCase()]||C),y(M=>({...M,[N]:k}))},G=()=>{if(!j)return;const N={};j.categoria.value&&(N.category=CR[j.categoria.value.toLowerCase()]||j.categoria.value),j.cor.value&&(N.color=ER[j.cor.value.toLowerCase()]||j.cor.value),j.estilo.value&&(N.style=j.estilo.value),j.ocasiao.value&&(N.occasion=j.ocasiao.value),j.modelagem.value&&(N.modeling=j.modelagem.value),y(C=>({...C,...N})),de.success("Sugestes aplicadas!")},I=N=>{const C={};["category","color","style","occasion","modeling"].forEach(M=>{N[M].selected&&N[M].value&&(C[M]=N[M].value)}),N.tags.length>0&&(C.tags=[...new Set([...v.tags,...N.tags])]),y(M=>({...M,...C})),de.success("Sugestes aplicadas!")},F=async()=>{const N=c[h]||c[0];if(!N){de.error("Adicione uma imagem do produto primeiro");return}d(!0);try{const{data:C,error:k}=await le.functions.invoke("generate-product-description",{body:{image_url:N,product_name:v.name||null}});if(k){console.error("Edge function error:",k),de.error("Erro ao gerar descrio");return}if(C!=null&&C.error){de.error(C.error);return}if(C!=null&&C.success&&(C!=null&&C.data)){const M=C.data;let U=M.descricao_completa||"";M.diferenciais&&M.diferenciais.length>0&&(U+=`

 Diferenciais:
`,M.diferenciais.forEach($=>{U+=` ${$}
`})),M.palavras_chave&&M.palavras_chave.length>0&&(U+=`
 Tags: ${M.palavras_chave.join(", ")}`),y($=>({...$,description:U,name:$.name||M.nome_produto||$.name})),de.success("Descrio premium gerada com sucesso!"),M.frase_anuncio&&setTimeout(()=>{de.info(` Frase para anncio: "${M.frase_anuncio}"`)},1500)}}catch(C){console.error("Error generating description:",C),de.error("Erro ao conectar com o servio de IA")}finally{d(!1)}},S=()=>{const N=[];return v.style&&N.push(v.style),v.occasion&&N.push(v.occasion),v.category&&N.push(v.category.toLowerCase()),v.modeling&&N.push(v.modeling),j!=null&&j.tags_extras&&N.push(...j.tags_extras),[...new Set(N)]},E=async(N,C=!1)=>{if(N.preventDefault(),!v.name||!v.price){de.error("Nome e preo so obrigatrios");return}o(!0);try{const k=CW(g),M=c[h]||c[0]||null,U={name:v.name,sku:v.sku||null,category:v.category,price:v.price,color:v.color,style:v.style,occasion:v.occasion,modeling:v.modeling,sizes:k,is_active:v.is_active,image_url:M,tags:S(),user_id:a,images:c,video_url:m,main_image_index:h,stock_by_size:g,description:v.description,weight_kg:v.weight_kg||null,length_cm:v.length_cm||null,width_cm:v.width_cm||null,height_cm:v.height_cm||null,discount_type:v.discount_type||null,discount_value:v.discount_value||null};let $=r==null?void 0:r.id;if(r!=null&&r.id){const{error:X}=await le.from("product_catalog").update(U).eq("id",r.id);if(X)throw X;de.success("Produto atualizado!")}else{const{data:X,error:Z}=await le.from("product_catalog").insert(U).select("id").single();if(Z)throw Z;$=X==null?void 0:X.id,de.success("Produto criado!")}$&&v.is_active&&SW($).then(X=>{X.count>0&&de.info(`${X.count} cliente(s) sugerido(s) para avisar!`)}),s(),C||t(!1)}catch(k){console.error("Error saving product:",k),de.error("Erro ao salvar produto")}finally{o(!1)}};return n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[n.jsx(ln,{children:n.jsx(rn,{className:"font-serif",children:r?"Editar Produto":"Novo Produto"})}),n.jsxs("form",{onSubmit:N=>E(N,!1),className:"space-y-6",children:[n.jsxs("div",{className:"border border-border rounded-lg p-4",children:[n.jsx(w0e,{images:c,mainImageIndex:h,videoUrl:m,onImagesChange:B,onVideoChange:p,userId:a}),c.length>0&&!j&&n.jsx(he,{type:"button",variant:"outline",onClick:q,disabled:b,className:"w-full mt-4",children:b?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Analisando foto..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Analisar foto e sugerir campos"]})})]}),j&&n.jsx(b0e,{analysis:j,onApply:Y,onApplyAll:G,onApplySelected:I,onDismiss:O,currentValues:{category:v.category,color:v.color,style:v.style,occasion:v.occasion,modeling:v.modeling}}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"name",children:"Nome *"}),n.jsx(et,{id:"name",value:v.name,onChange:N=>y(C=>({...C,name:N.target.value})),placeholder:"Nome do produto"})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"sku",children:"SKU (cdigo nico)"}),n.jsx(et,{id:"sku",value:v.sku||"",onChange:N=>y(C=>({...C,sku:N.target.value||null})),placeholder:"Ex: VEST-001",className:"font-mono"})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"price",children:"Preo *"}),n.jsx(fq,{id:"price",value:v.price,onChange:N=>y(C=>({...C,price:N})),placeholder:"0,00"})]}),n.jsxs("div",{children:[n.jsx(Be,{children:"Categoria"}),n.jsxs(Xt,{value:v.category||"",onValueChange:N=>y(C=>({...C,category:N})),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecione"})}),n.jsx(Gt,{children:D0e.map(N=>n.jsx(qe,{value:N,children:N},N))})]})]}),n.jsxs("div",{className:"col-span-2 space-y-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx(Be,{htmlFor:"weight_kg",children:"Peso (kg) *"}),v.category&&d3[v.category]&&n.jsxs(he,{type:"button",variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:()=>y(N=>({...N,weight_kg:d3[N.category]})),children:["Usar sugesto: ",d3[v.category],"kg"]})]}),n.jsx(et,{id:"weight_kg",type:"number",step:"0.01",min:"0",max:"30",value:v.weight_kg??"",onChange:N=>y(C=>({...C,weight_kg:N.target.value?parseFloat(N.target.value):null})),placeholder:"Ex: 0.45"}),!v.weight_kg&&v.is_active&&n.jsx("p",{className:"text-xs text-amber-600 mt-1",children:" Peso obrigatrio para produtos ativos. O frete usar 0.30kg como padro."})]}),n.jsxs("div",{children:[n.jsxs(Be,{className:"text-muted-foreground text-xs mb-2 block",children:["Dimenses (cm) - opcional, padro: ",Tc.length,"x",Tc.width,"x",Tc.height]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsx("div",{children:n.jsx(et,{type:"number",step:"0.1",min:"0",max:"100",value:v.length_cm??"",onChange:N=>y(C=>({...C,length_cm:N.target.value?parseFloat(N.target.value):null})),placeholder:"Comp."})}),n.jsx("div",{children:n.jsx(et,{type:"number",step:"0.1",min:"0",max:"100",value:v.width_cm??"",onChange:N=>y(C=>({...C,width_cm:N.target.value?parseFloat(N.target.value):null})),placeholder:"Larg."})}),n.jsx("div",{children:n.jsx(et,{type:"number",step:"0.1",min:"0",max:"100",value:v.height_cm??"",onChange:N=>y(C=>({...C,height_cm:N.target.value?parseFloat(N.target.value):null})),placeholder:"Alt."})})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(Be,{children:"Cor"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Xt,{value:R.includes(v.color||"")?v.color||"":"new_color",onValueChange:N=>{y(N==="new_color"?C=>({...C,color:""}):C=>({...C,color:N}))},children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecione"})}),n.jsxs(Gt,{children:[R.map(N=>n.jsx(qe,{value:N,children:N},N)),n.jsx(qe,{value:"new_color",className:"font-medium text-primary",children:"+ Nova Cor..."})]})]}),(!R.includes(v.color||"")||v.color==="")&&n.jsx(et,{placeholder:"Digite a cor...",value:v.color||"",onChange:N=>y(C=>({...C,color:N.target.value})),className:"mt-2 animate-in fade-in slide-in-from-top-1",autoFocus:!0})]})]}),n.jsxs("div",{children:[n.jsx(Be,{children:"Estilo"}),n.jsxs(Xt,{value:v.style||"",onValueChange:N=>y(C=>({...C,style:N})),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecione"})}),n.jsx(Gt,{children:L0e.map(N=>n.jsx(qe,{value:N,children:N},N))})]})]}),n.jsxs("div",{children:[n.jsx(Be,{children:"Ocasio"}),n.jsxs(Xt,{value:v.occasion||"",onValueChange:N=>y(C=>({...C,occasion:N})),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecione"})}),n.jsx(Gt,{children:B0e.map(N=>n.jsx(qe,{value:N,children:N},N))})]})]}),n.jsxs("div",{children:[n.jsx(Be,{children:"Modelagem"}),n.jsxs(Xt,{value:v.modeling||"",onValueChange:N=>y(C=>({...C,modeling:N})),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecione"})}),n.jsx(Gt,{children:$0e.map(N=>n.jsx(qe,{value:N,children:N},N))})]})]})]}),n.jsx("div",{className:"border border-border rounded-lg p-4",children:n.jsx(O0e,{stock:g,onChange:x})}),n.jsxs("div",{className:"border border-border rounded-lg p-4",children:[n.jsx(M0e,{discountType:v.discount_type||null,discountValue:v.discount_value??null,onDiscountTypeChange:N=>y(C=>({...C,discount_type:N})),onDiscountValueChange:N=>y(C=>({...C,discount_value:N})),label:"Desconto no Catlogo"}),v.discount_type&&v.discount_value&&v.price>0&&n.jsxs("div",{className:"mt-3 p-2 bg-green-50 dark:bg-green-950/30 rounded text-sm",children:[n.jsxs("span",{className:"text-muted-foreground line-through",children:["R$ ",v.price.toFixed(2)]}),n.jsxs("span",{className:"ml-2 font-bold text-green-600",children:["R$ ",I0e(v.price,v.discount_type,v.discount_value).toFixed(2)]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Be,{htmlFor:"description",children:"Descrio"}),n.jsxs(he,{type:"button",variant:"ghost",size:"sm",onClick:F,disabled:l||c.length===0,title:c.length===0?"Adicione uma imagem primeiro":"Gerar descrio premium com IA",children:[l?n.jsx(Et,{className:"h-4 w-4 mr-1 animate-spin"}):n.jsx(Gr,{className:"h-4 w-4 mr-1"}),l?"Gerando...":"Gerar com IA"]})]}),n.jsx(rs,{id:"description",value:v.description||"",onChange:N=>y(C=>({...C,description:N.target.value})),placeholder:"Descrio detalhada do produto...",rows:3})]}),(r==null?void 0:r.id)&&n.jsx("div",{className:"border-t pt-6",children:n.jsx(C0e,{productId:r.id,productName:v.name||r.name})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Va,{id:"is_active",checked:v.is_active,onCheckedChange:N=>y(C=>({...C,is_active:N}))}),n.jsx(Be,{htmlFor:"is_active",className:"cursor-pointer",children:"Produto ativo (visvel no catlogo)"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(he,{type:"button",variant:"outline",onClick:()=>t(!1),className:"flex-1",children:"Cancelar"}),n.jsx(he,{type:"button",variant:"secondary",disabled:i,onClick:N=>E(N,!0),children:i?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):"Salvar rpido"}),n.jsx(he,{type:"submit",disabled:i,className:"flex-1",children:i?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar completo"})]})]})]})})}var u3,M_="HoverCard",[EW,tQe]=ea(M_,[bc]),I_=bc(),[U0e,Ok]=EW(M_),kW=e=>{const{__scopeHoverCard:t,children:r,open:s,defaultOpen:a,onOpenChange:i,openDelay:o=700,closeDelay:l=300}=e,d=I_(t),c=P.useRef(0),u=P.useRef(0),h=P.useRef(!1),f=P.useRef(!1),[m,p]=Ui({prop:s,defaultProp:a??!1,onChange:i,caller:M_}),g=P.useCallback(()=>{clearTimeout(u.current),c.current=window.setTimeout(()=>p(!0),o)},[o,p]),x=P.useCallback(()=>{clearTimeout(c.current),!h.current&&!f.current&&(u.current=window.setTimeout(()=>p(!1),l))},[l,p]),v=P.useCallback(()=>p(!1),[p]);return P.useEffect(()=>()=>{clearTimeout(c.current),clearTimeout(u.current)},[]),n.jsx(U0e,{scope:t,open:m,onOpenChange:p,onOpen:g,onClose:x,onDismiss:v,hasSelectionRef:h,isPointerDownOnContentRef:f,children:n.jsx(Yv,{...d,children:r})})};kW.displayName=M_;var AW="HoverCardTrigger",TW=P.forwardRef((e,t)=>{const{__scopeHoverCard:r,...s}=e,a=Ok(AW,r),i=I_(r);return n.jsx(ng,{asChild:!0,...i,children:n.jsx(er.a,{"data-state":a.open?"open":"closed",...s,ref:t,onPointerEnter:Tt(e.onPointerEnter,vw(a.onOpen)),onPointerLeave:Tt(e.onPointerLeave,vw(a.onClose)),onFocus:Tt(e.onFocus,a.onOpen),onBlur:Tt(e.onBlur,a.onClose),onTouchStart:Tt(e.onTouchStart,o=>o.preventDefault())})})});TW.displayName=AW;var V0e="HoverCardPortal",[rQe,q0e]=EW(V0e,{forceMount:void 0}),xw="HoverCardContent",PW=P.forwardRef((e,t)=>{const r=q0e(xw,e.__scopeHoverCard),{forceMount:s=r.forceMount,...a}=e,i=Ok(xw,e.__scopeHoverCard);return n.jsx(Ws,{present:s||i.open,children:n.jsx(W0e,{"data-state":i.open?"open":"closed",...a,onPointerEnter:Tt(e.onPointerEnter,vw(i.onOpen)),onPointerLeave:Tt(e.onPointerLeave,vw(i.onClose)),ref:t})})});PW.displayName=xw;var W0e=P.forwardRef((e,t)=>{const{__scopeHoverCard:r,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,...l}=e,d=Ok(xw,r),c=I_(r),u=P.useRef(null),h=Rr(t,u),[f,m]=P.useState(!1);return P.useEffect(()=>{if(f){const p=document.body;return u3=p.style.userSelect||p.style.webkitUserSelect,p.style.userSelect="none",p.style.webkitUserSelect="none",()=>{p.style.userSelect=u3,p.style.webkitUserSelect=u3}}},[f]),P.useEffect(()=>{if(u.current){const p=()=>{m(!1),d.isPointerDownOnContentRef.current=!1,setTimeout(()=>{var x;((x=document.getSelection())==null?void 0:x.toString())!==""&&(d.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",p),()=>{document.removeEventListener("pointerup",p),d.hasSelectionRef.current=!1,d.isPointerDownOnContentRef.current=!1}}},[d.isPointerDownOnContentRef,d.hasSelectionRef]),P.useEffect(()=>{u.current&&K0e(u.current).forEach(g=>g.setAttribute("tabindex","-1"))}),n.jsx(Ou,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:o,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:Tt(i,p=>{p.preventDefault()}),onDismiss:d.onDismiss,children:n.jsx(Zv,{...c,...l,onPointerDown:Tt(l.onPointerDown,p=>{p.currentTarget.contains(p.target)&&m(!0),d.hasSelectionRef.current=!1,d.isPointerDownOnContentRef.current=!0}),ref:h,style:{...l.style,userSelect:f?"text":void 0,WebkitUserSelect:f?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),H0e="HoverCardArrow",G0e=P.forwardRef((e,t)=>{const{__scopeHoverCard:r,...s}=e,a=I_(r);return n.jsx(Qv,{...a,...s,ref:t})});G0e.displayName=H0e;function vw(e){return t=>t.pointerType==="touch"?void 0:e()}function K0e(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;r.nextNode();)t.push(r.currentNode);return t}var X0e=kW,Y0e=TW,OW=PW;const kR=X0e,AR=Y0e,yC=P.forwardRef(({className:e,align:t="center",sideOffset:r=4,...s},a)=>n.jsx(OW,{ref:a,align:t,sideOffset:r,className:He("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s}));yC.displayName=OW.displayName;function gy({size:e,stock:t,variant:r="badge",hasReservations:s=!1}){const a=t!=null&&typeof t.stock=="number"&&!isNaN(t.stock),i=n.jsxs("div",{className:"space-y-2 min-w-[180px]",children:[n.jsxs("p",{className:"font-semibold text-sm border-b pb-1",children:["Detalhe: ",e]}),a?n.jsx(n.Fragment,{children:n.jsxs("div",{className:"space-y-1 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Total Fsico:"}),n.jsx("span",{className:"font-medium",children:t.stock})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Reservado:"}),n.jsx("span",{className:`font-medium ${t.reserved>0?"text-orange-600":""}`,children:t.reserved})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Vendido:"}),n.jsx("span",{className:`font-medium ${t.committed>0?"text-blue-600":""}`,children:t.committed})]}),n.jsxs("div",{className:"flex justify-between pt-1 border-t mt-1",children:[n.jsx("span",{className:"font-medium",children:"Disponvel Venda:"}),n.jsx("span",{className:`font-bold ${t.available>0?"text-green-600":"text-red-600"}`,children:t.available})]})]})}):n.jsx("p",{className:"text-sm text-muted-foreground italic",children:"Sem detalhamento disponvel no momento."})]});return r==="icon"?n.jsxs(kR,{openDelay:0,closeDelay:0,children:[n.jsx(AR,{asChild:!0,children:n.jsx("button",{type:"button",className:"inline-flex items-center justify-center cursor-help focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-1 rounded-sm","aria-label":`Ver detalhes de estoque para tamanho ${e}`,children:n.jsx(CS,{className:"h-4 w-4 text-muted-foreground hover:text-foreground transition-colors"})})}),n.jsx(yC,{className:"w-auto p-3 z-50 bg-white shadow-xl border-2",side:"top",align:"center",children:i})]}):n.jsxs(kR,{openDelay:0,closeDelay:0,children:[n.jsx(AR,{asChild:!0,children:n.jsxs("div",{className:`
            inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full border text-xs font-semibold transition-colors cursor-help
            ${a&&t.available>0?"bg-secondary text-secondary-foreground hover:bg-secondary/80":"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 opacity-50"}
            ${s?"border-orange-200 bg-orange-50 text-orange-700":""}
          `,tabIndex:0,role:"button",children:[n.jsxs("span",{children:[e,": ",a?t.available:0]}),n.jsx(CS,{className:"h-3 w-3 opacity-50 ml-0.5"})]})}),n.jsx(yC,{className:"w-auto p-3 z-50 bg-white shadow-xl border-2",side:"top",align:"center",children:i})]})}function X0(e,t,r){return!t||!r||r<=0?e:t==="percentage"?e*(1-r/100):t==="fixed"?Math.max(0,e-r):e}function ym(e,t){return!!(e&&t&&t>0)}function RW(e,t){return ym(e,t)?e==="percentage"?`-${t}%`:e==="fixed"?`-R$ ${t==null?void 0:t.toFixed(2)}`:null:null}function Z0e({userId:e,initialFilter:t}){const[r,s]=P.useState([]),[a,i]=P.useState(new Map),[o,l]=P.useState(!0),[d,c]=P.useState(""),[u,h]=P.useState(()=>t==="imported"?"imported":"active"),[f,m]=P.useState(!1),[p,g]=P.useState(null),[x,v]=P.useState(!1),[y,b]=P.useState(null),j=P.useCallback(async S=>{if(S.length!==0)try{const{data:E,error:N}=await le.from("product_available_stock").select("*").in("product_id",S);if(N)throw N;const C=new Map;(E||[]).forEach(k=>{C.has(k.product_id)||C.set(k.product_id,new Map);const M={product_id:k.product_id,size:k.size,on_hand:k.on_hand||k.stock||0,committed:k.committed||0,reserved:k.reserved||0,available:k.available||0};C.get(k.product_id).set(k.size,M)}),i(C)}catch(E){console.error("Error loading available stock:",E)}},[]),T=async()=>{try{let S=le.from("product_catalog").select("*").order("group_key",{ascending:!0,nullsFirst:!1}).order("color",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!1});S=S.or(`user_id.eq.${e},user_id.is.null`),u==="active"?S=S.eq("is_active",!0):u==="archived"?S=S.eq("is_active",!1):u==="imported"&&(S=S.eq("is_active",!1).eq("created_from_import",!0));const{data:E,error:N}=await S;if(N)throw N;s(E||[]),E&&E.length>0&&j(E.map(C=>C.id))}catch(S){console.error("Error loading products:",S),de.error("Erro ao carregar produtos")}finally{l(!1)}};P.useEffect(()=>{T()},[e,u]);const O=async S=>{try{const{error:E}=await le.from("product_catalog").update({is_active:!S.is_active}).eq("id",S.id);if(E)throw E;de.success(S.is_active?"Produto arquivado":"Produto reativado"),T()}catch(E){console.error("Error archiving product:",E),de.error("Erro ao arquivar produto")}},R=S=>{b(S),v(!0)},D=async()=>{if(y)try{const{error:S}=await le.from("product_catalog").delete().eq("id",y.id);if(S)throw S;de.success("Produto excludo permanentemente"),T()}catch(S){console.error("Error deleting product:",S),de.error("Erro ao excluir produto")}finally{v(!1),b(null)}},B=S=>{g(S),m(!0)},q=()=>{g(null),m(!0)},Y=r.filter(S=>{var E,N,C,k;return S.name.toLowerCase().includes(d.toLowerCase())||((E=S.sku)==null?void 0:E.toLowerCase().includes(d.toLowerCase()))||((N=S.group_key)==null?void 0:N.toLowerCase().includes(d.toLowerCase()))||((C=S.category)==null?void 0:C.toLowerCase().includes(d.toLowerCase()))||((k=S.color)==null?void 0:k.toLowerCase().includes(d.toLowerCase()))}),G=S=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(S),I=S=>!S||typeof S!="object"?{}:S,F=S=>{const E=["PP","P","M","G","GG","XG","XXG","XXXG","UN"];return S.sort(([N],[C])=>{const k=E.includes(N.toUpperCase()),M=E.includes(C.toUpperCase()),U=/^\d+$/.test(N),$=/^\d+$/.test(C);return k&&!M?-1:!k&&M?1:k&&M?E.indexOf(N.toUpperCase())-E.indexOf(C.toUpperCase()):U&&$?parseInt(N)-parseInt(C):N.localeCompare(C)})};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[n.jsxs("div",{className:"relative flex-1 max-w-sm",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar produtos...",value:d,onChange:S=>c(S.target.value),className:"pl-10"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{variant:u==="active"?"secondary":"outline",onClick:()=>h("active"),className:"gap-2",size:"sm",children:"Ativos"}),n.jsxs(he,{variant:u==="archived"?"secondary":"outline",onClick:()=>h("archived"),className:"gap-2",size:"sm",children:[n.jsx(jx,{className:"h-4 w-4"}),"Arquivados"]}),n.jsxs(he,{variant:u==="imported"?"secondary":"outline",onClick:()=>h("imported"),className:"gap-2",size:"sm",children:[n.jsx(Vt,{className:"h-4 w-4"}),"Importados (ERP)"]}),n.jsxs(he,{onClick:q,className:"gap-2",children:[n.jsx(kn,{className:"h-4 w-4"}),"Novo Produto"]})]})]}),n.jsx("div",{className:"bg-card rounded-xl border border-border overflow-hidden",children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{className:"w-[80px]",children:"Imagem"}),n.jsx(St,{children:"Produto"}),n.jsx(St,{children:"Modelo"}),n.jsx(St,{children:"Preo"}),n.jsx(St,{children:"Estoque"}),n.jsx(St,{children:"Status"}),n.jsx(St,{className:"text-right",children:"Aes"})]})}),n.jsxs(ya,{children:[Y.map(S=>n.jsxs(Kr,{children:[n.jsx(bt,{children:S.image_url?n.jsx("img",{src:S.image_url,alt:S.name,className:"w-12 h-12 object-cover rounded-lg"}):n.jsx("div",{className:"w-12 h-12 bg-secondary rounded-lg flex items-center justify-center",children:n.jsx(Vt,{className:"h-5 w-5 text-muted-foreground"})})}),n.jsx(bt,{children:n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:S.name}),n.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[S.category&&n.jsx("span",{className:"text-xs text-muted-foreground",children:S.category}),S.category&&S.color&&n.jsx("span",{className:"text-xs text-muted-foreground",children:""}),S.color?n.jsx(ke,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 font-normal",children:S.color}):n.jsx("span",{className:"text-xs text-amber-600",children:"Cor pendente"})]})]})}),n.jsx(bt,{children:S.group_key?n.jsx(ke,{variant:"outline",className:"font-mono",children:S.group_key}):S.sku?n.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:S.sku}):"-"}),n.jsx(bt,{children:S.price>0?n.jsx("div",{className:"flex flex-col",children:ym(S.discount_type,S.discount_value)?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"font-medium text-green-600",children:G(X0(S.price,S.discount_type,S.discount_value))}),n.jsx("span",{className:"text-xs text-muted-foreground line-through",children:G(S.price)}),n.jsxs(ke,{variant:"outline",className:"text-[10px] px-1 py-0 h-4 w-fit text-green-600 border-green-200 mt-0.5",children:[n.jsx(ua,{className:"h-2.5 w-2.5 mr-0.5"}),RW(S.discount_type,S.discount_value)]})]}):G(S.price)}):n.jsx("span",{className:"text-muted-foreground text-xs",children:"A definir"})}),n.jsx(bt,{children:n.jsx("div",{className:"flex flex-wrap gap-1",children:(()=>{const E=a.get(S.id);if(E&&E.size>0){const X=Array.from(E.entries()).filter(([,W])=>W.on_hand>0||W.available>0),Z=F(X.map(([W])=>[W,0])).map(([W])=>{const J=E.get(W);return{size:W,entry:J}});return Z.length===0?n.jsx("span",{className:"text-xs text-amber-600",children:" Grade no definida"}):Z.every(({entry:W})=>((W==null?void 0:W.available)||0)<=0)?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-xs text-amber-600 mr-1",children:" Esgotado"}),Z.slice(0,5).map(({size:W,entry:J})=>{const V=J?{stock:J.on_hand,reserved:J.reserved,committed:J.committed,available:J.available}:null;return n.jsx(gy,{size:W,stock:V,hasReservations:((J==null?void 0:J.reserved)||0)>0},W)}),Z.length>5&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",Z.length-5]})]}):n.jsxs(n.Fragment,{children:[Z.slice(0,6).map(({size:W,entry:J})=>{const V=(J==null?void 0:J.reserved)||0,H=(J==null?void 0:J.committed)||0,ee=V>0||H>0,ie=J?{stock:J.on_hand,reserved:J.reserved,committed:J.committed,available:J.available}:null;return n.jsx(gy,{size:W,stock:ie,hasReservations:ee},W)}),Z.length>6&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",Z.length-6]})]})}const N=I(S.stock_by_size),C=Object.entries(N),k=F(C),M=k.filter(([,$])=>$>0),U=k.filter(([,$])=>$===0);return C.length===0?n.jsx("span",{className:"text-xs text-amber-600",children:" Grade no definida"}):M.length===0?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-xs text-amber-600 mr-1",children:" Zerado"}),U.slice(0,4).map(([$])=>n.jsx(gy,{size:$,stock:{stock:0,reserved:0,committed:0,available:0}},$)),U.length>4&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",U.length-4]})]}):n.jsxs(n.Fragment,{children:[M.slice(0,5).map(([$,X])=>n.jsx(gy,{size:$,stock:{stock:X,reserved:0,committed:0,available:X}},$)),M.length>5&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",M.length-5]})]})})()})}),n.jsx(bt,{children:n.jsxs("div",{className:"flex flex-col items-start gap-1",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${S.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:S.is_active?"Ativo":"Arquivado"}),S.created_from_import&&n.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-amber-100 text-amber-700",children:"ERP"})]}),S.is_active&&!S.weight_kg&&n.jsx("span",{className:"text-xs text-amber-600",children:" Peso faltando"})]})}),n.jsx(bt,{className:"text-right",children:n.jsxs("div",{className:"flex justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>B(S),title:"Editar",children:n.jsx(Js,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>O(S),title:S.is_active?"Arquivar":"Reativar",children:n.jsx(jx,{className:"h-4 w-4"})}),S.created_from_import&&n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>R(S),title:"Excluir permanentemente",className:"text-destructive hover:text-destructive",children:n.jsx(ui,{className:"h-4 w-4"})})]})})]},S.id)),Y.length===0&&n.jsx(Kr,{children:n.jsx(bt,{colSpan:7,className:"text-center py-12 text-muted-foreground",children:o?"Carregando...":"Nenhum produto encontrado"})})]})]})}),n.jsx(z0e,{open:f,onOpenChange:m,product:p?{...p,sizes:p.sizes||[],tags:p.tags||[],is_active:p.is_active??!0,stock_by_size:I(p.stock_by_size),group_key:p.group_key,created_from_import:p.created_from_import}:null,onSuccess:T,userId:e},f?"open":"closed"),n.jsx(_c,{open:x,onOpenChange:v,children:n.jsxs(Tl,{children:[n.jsxs(Pl,{children:[n.jsx(Ol,{children:"Excluir produto?"}),n.jsxs(Rl,{children:['Esta ao  irreversvel. O produto "',y==null?void 0:y.name,'" ser excludo permanentemente.']})]}),n.jsxs(jc,{children:[n.jsx(Sc,{children:"Cancelar"}),n.jsx(Nc,{onClick:D,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir"})]})]})})]})}async function af(e){try{if(navigator.clipboard&&typeof ClipboardItem<"u"){const t=new Blob([e],{type:"text/plain;charset=utf-8"});return await navigator.clipboard.write([new ClipboardItem({"text/plain":t})]),!0}return navigator.clipboard?(await navigator.clipboard.writeText(e),!0):TR(e)}catch(t){return console.warn("Clipboard API failed, using fallback:",t),TR(e)}}function TR(e){const t=document.createElement("textarea");t.value=e,t.style.cssText=`
    position: fixed;
    top: 0;
    left: -9999px;
    width: 1px;
    height: 1px;
    padding: 0;
    border: none;
    outline: none;
    box-shadow: none;
    background: transparent;
  `,document.body.appendChild(t),t.focus(),t.select();let r=!1;try{r=document.execCommand("copy")}catch(s){console.error("execCommand copy failed:",s)}return document.body.removeChild(t),r}function Q0e({open:e,onOpenChange:t,print:r,customerPhone:s,onSuccess:a}){var R;const[i,o]=P.useState([]),[l,d]=P.useState([]),[c,u]=P.useState(""),[h,f]=P.useState(null),[m,p]=P.useState(!0),[g,x]=P.useState(!1);P.useEffect(()=>{e&&v()},[e,r]);const v=async()=>{try{const{data:D,error:B}=await le.from("product_catalog").select("*").eq("is_active",!0).order("name");if(B)throw B;if(o(D||[]),r.size||r.preference){const q=r.preference==="ajustado"?["ajustado","regular"]:["soltinho","oversized"],Y=(D||[]).filter(G=>{var S;const I=!r.size||((S=G.sizes)==null?void 0:S.includes(r.size)),F=!r.preference||q.some(E=>{var N,C;return((N=G.tags)==null?void 0:N.includes(E))||((C=G.style)==null?void 0:C.includes(E))});return I||F}).slice(0,6);d(Y)}if(r.linked_product_id){const q=(D||[]).find(Y=>Y.id===r.linked_product_id);q&&f(q)}}catch(D){console.error("Error loading products:",D)}finally{p(!1)}},y=i.filter(D=>{var B;return D.name.toLowerCase().includes(c.toLowerCase())||((B=D.category)==null?void 0:B.toLowerCase().includes(c.toLowerCase()))}),b=async()=>{if(h){x(!0);try{const{error:D}=await le.from("print_requests").update({linked_product_id:h.id}).eq("id",r.id);if(D)throw D;de.success("Produto vinculado!"),a(),t(!1)}catch(D){console.error("Error linking product:",D),de.error("Erro ao vincular produto")}finally{x(!1)}}},j=()=>{var B;const D=q=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(q);return h?r.size&&((B=h.sizes)==null?void 0:B.includes(r.size))?`Oi!  Achei a pea que voc procura: ${h.name} - ${D(h.price)}. Tenho no seu tamanho (${r.size})! Posso reservar para voc?`:`Oi!  Encontrei uma pea parecida com o que voc procura: ${h.name} - ${D(h.price)}. Vou verificar os tamanhos disponveis e te aviso!`:"Oi!  Vi o print que voc mandou! Estou procurando essa pea para voc. Em breve te dou um retorno!"},T=async()=>{const D=j(),q=`https://wa.me/55${s.replace(/\D/g,"")}?text=${encodeURIComponent(D)}`,Y=window.open(q,"_blank","noopener,noreferrer");(!Y||Y.closed||typeof Y.closed>"u")&&(await af(D),de.success("Link bloqueado. Mensagem copiada para rea de transferncia!"))},O=D=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(D);return n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[n.jsx(ln,{children:n.jsx(rn,{className:"font-serif",children:"Vincular a Produto"})}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar produto...",value:c,onChange:D=>u(D.target.value),className:"pl-10"})]}),h&&n.jsxs("div",{className:"p-4 bg-accent/10 rounded-xl border border-accent/20",children:[n.jsx("p",{className:"text-xs text-accent font-medium mb-2",children:"Produto selecionado"}),n.jsxs("div",{className:"flex gap-4",children:[h.image_url?n.jsx("img",{src:h.image_url,alt:h.name,className:"w-16 h-16 object-cover rounded-lg"}):n.jsx("div",{className:"w-16 h-16 bg-secondary rounded-lg flex items-center justify-center",children:n.jsx(Vt,{className:"h-6 w-6 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:h.name}),n.jsx("p",{className:"text-sm text-muted-foreground",children:O(h.price)}),r.size&&n.jsx("p",{className:"text-xs mt-1",children:(R=h.sizes)!=null&&R.includes(r.size)?n.jsxs("span",{className:"text-green-600",children:[" Tem no tamanho ",r.size]}):n.jsxs("span",{className:"text-amber-600",children:[" Verificar tamanho ",r.size]})})]}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>f(null),children:"Trocar"})]})]}),!h&&l.length>0&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium mb-3",children:"Sugestes baseadas nas preferncias"}),n.jsx("div",{className:"grid grid-cols-3 gap-3",children:l.map(D=>n.jsxs("button",{onClick:()=>f(D),className:"text-left p-3 rounded-xl border border-border hover:border-accent transition-colors",children:[D.image_url?n.jsx("img",{src:D.image_url,alt:D.name,className:"w-full aspect-square object-cover rounded-lg mb-2"}):n.jsx("div",{className:"w-full aspect-square bg-secondary rounded-lg mb-2 flex items-center justify-center",children:n.jsx(Vt,{className:"h-8 w-8 text-muted-foreground"})}),n.jsx("p",{className:"text-sm font-medium truncate",children:D.name}),n.jsx("p",{className:"text-xs text-muted-foreground",children:O(D.price)})]},D.id))})]}),!h&&c&&n.jsxs("div",{className:"max-h-[300px] overflow-y-auto space-y-2",children:[y.map(D=>n.jsxs("button",{onClick:()=>f(D),className:"w-full flex items-center gap-3 p-3 rounded-xl border border-border hover:border-accent transition-colors text-left",children:[D.image_url?n.jsx("img",{src:D.image_url,alt:D.name,className:"w-12 h-12 object-cover rounded-lg"}):n.jsx("div",{className:"w-12 h-12 bg-secondary rounded-lg flex items-center justify-center",children:n.jsx(Vt,{className:"h-5 w-5 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:D.name}),n.jsx("p",{className:"text-sm text-muted-foreground",children:O(D.price)})]})]},D.id)),y.length===0&&n.jsx("p",{className:"text-center text-muted-foreground py-4",children:"Nenhum produto encontrado"})]}),n.jsxs("div",{className:"flex flex-col gap-3 pt-4 border-t border-border",children:[n.jsxs("div",{className:"flex gap-3",children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),className:"flex-1",children:"Cancelar"}),n.jsxs(he,{onClick:b,disabled:!h||g,className:"flex-1 gap-2",children:[n.jsx(tz,{className:"h-4 w-4"}),"Vincular"]})]}),n.jsxs(he,{variant:"secondary",onClick:T,className:"gap-2",children:[n.jsx(nn,{className:"h-4 w-4"}),"Enviar resposta no WhatsApp"]})]})]})]})})}const J0e=Jp("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),of=P.forwardRef(({className:e,variant:t,...r},s)=>n.jsx("div",{ref:s,role:"alert",className:He(J0e({variant:t}),e),...r}));of.displayName="Alert";const exe=P.forwardRef(({className:e,...t},r)=>n.jsx("h5",{ref:r,className:He("mb-1 font-medium leading-none tracking-tight",e),...t}));exe.displayName="AlertTitle";const lf=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:He("text-sm [&_p]:leading-relaxed",e),...t}));lf.displayName="AlertDescription";var D_="Collapsible",[txe,nQe]=ea(D_),[rxe,Rk]=txe(D_),MW=P.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:s,defaultOpen:a,disabled:i,onOpenChange:o,...l}=e,[d,c]=Ui({prop:s,defaultProp:a??!1,onChange:o,caller:D_});return n.jsx(rxe,{scope:r,disabled:i,contentId:pa(),open:d,onOpenToggle:P.useCallback(()=>c(u=>!u),[c]),children:n.jsx(er.div,{"data-state":Ik(d),"data-disabled":i?"":void 0,...l,ref:t})})});MW.displayName=D_;var IW="CollapsibleTrigger",DW=P.forwardRef((e,t)=>{const{__scopeCollapsible:r,...s}=e,a=Rk(IW,r);return n.jsx(er.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":Ik(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...s,ref:t,onClick:Tt(e.onClick,a.onOpenToggle)})});DW.displayName=IW;var Mk="CollapsibleContent",LW=P.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=Rk(Mk,e.__scopeCollapsible);return n.jsx(Ws,{present:r||a.open,children:({present:i})=>n.jsx(nxe,{...s,ref:t,present:i})})});LW.displayName=Mk;var nxe=P.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:s,children:a,...i}=e,o=Rk(Mk,r),[l,d]=P.useState(s),c=P.useRef(null),u=Rr(t,c),h=P.useRef(0),f=h.current,m=P.useRef(0),p=m.current,g=o.open||l,x=P.useRef(g),v=P.useRef(void 0);return P.useEffect(()=>{const y=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(y)},[]),ga(()=>{const y=c.current;if(y){v.current=v.current||{transitionDuration:y.style.transitionDuration,animationName:y.style.animationName},y.style.transitionDuration="0s",y.style.animationName="none";const b=y.getBoundingClientRect();h.current=b.height,m.current=b.width,x.current||(y.style.transitionDuration=v.current.transitionDuration,y.style.animationName=v.current.animationName),d(s)}},[o.open,s]),n.jsx(er.div,{"data-state":Ik(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!g,...i,ref:u,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":p?`${p}px`:void 0,...e.style},children:g&&a})});function Ik(e){return e?"open":"closed"}var sxe=MW;const pg=sxe,gg=DW,xg=LW;function Dk(){const[e,t]=P.useState([]),[r,s]=P.useState(!0),a=async()=>{const{data:c,error:u}=await le.from("sellers").select("*").eq("is_active",!0).order("name");if(u){console.error("Error loading sellers:",u);return}t(c||[]),s(!1)},i=async()=>{const{data:c,error:u}=await le.from("sellers").select("*").order("name");if(u){console.error("Error loading sellers:",u);return}t(c||[]),s(!1)},o=async c=>{const{data:u,error:h}=await le.from("sellers").insert(c).select().single();if(h)throw de.error("Erro ao criar vendedora"),h;return t(f=>[...f,u]),de.success("Vendedora cadastrada!"),u},l=async(c,u)=>{const{error:h}=await le.from("sellers").update(u).eq("id",c);if(h)throw de.error("Erro ao atualizar vendedora"),h;t(f=>f.map(m=>m.id===c?{...m,...u}:m)),de.success("Vendedora atualizada!")},d=async(c,u)=>{await l(c,{is_active:u})};return P.useEffect(()=>{a()},[]),{sellers:e,isLoading:r,loadSellers:a,loadAllSellers:i,createSeller:o,updateSeller:l,toggleSellerActive:d,refetch:a}}function BW({open:e,onClose:t,onSuccess:r,orderId:s,liveCartId:a}){const[i,o]=P.useState(""),[l,d]=P.useState(!1),[c,u]=P.useState(null),h=async()=>{var m,p,g;if(!i.trim()){de.error("Informe o ID do pagamento");return}d(!0),u(null);try{const{data:x,error:v}=await le.functions.invoke("revalidate-payment",{body:{payment_id:i.trim(),order_id:s||void 0}});if(v){console.error("Revalidate error:",v),console.error("Revalidate backend payload:",x);const T=(x==null?void 0:x.error)||(x==null?void 0:x.message)||v.message||"Erro ao revalidar";u({success:!1,message:T}),de.error(T);return}const y=x;console.log("[RevalidatePaymentModal] Response:",y);const b=((m=y.order)==null?void 0:m.status)==="pago"||((p=y.order)==null?void 0:p.payment_status)==="approved"||((g=y.live_cart)==null?void 0:g.status)==="pago";if(y.success&&b)u({success:!0,message:y.message,amount:y.amount,already_paid:y.already_paid,order_id:y.order_id,order:y.order,live_cart_id:y.live_cart_id,live_cart:y.live_cart,paid_at:y.paid_at}),y.already_paid?de.info("Este pedido j estava marcado como pago."):de.success(" Pagamento revalidado e pedido atualizado para PAGO!"),r==null||r(y);else if(y.success&&!b)console.error("[RevalidatePaymentModal] API success but status not pago:",y),u({success:!1,message:y.error||"Revalidao falhou. Status no atualizado para 'pago'."}),de.error("Falha na persistncia. Status no atualizado.");else{const j=y.error||y.message||"Falha na revalidao";u({success:!1,message:j}),de.error(j)}}catch(x){console.error("Revalidate exception:",x),u({success:!1,message:"Erro de conexo. Tente novamente."}),de.error("Erro de conexo")}finally{d(!1)}},f=()=>{o(""),u(null),t()};return n.jsx(tn,{open:e,onOpenChange:f,children:n.jsxs(Jr,{className:"sm:max-w-md",children:[n.jsxs(ln,{children:[n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(Qr,{className:"h-5 w-5"}),"Revalidar Pagamento Mercado Pago"]}),n.jsx(Vo,{children:"Cole o ID do pagamento do Mercado Pago para buscar e atualizar o status do pedido."})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(of,{variant:"default",className:"bg-blue-50 border-blue-200",children:n.jsxs(lf,{className:"text-sm",children:[n.jsx("strong",{children:"Como encontrar o Payment ID:"}),n.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[n.jsxs("li",{children:["Acesse o ",n.jsx("a",{href:"https://www.mercadopago.com.br/activities",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"painel do Mercado Pago"})]}),n.jsx("li",{children:"Encontre a transao (aprovada)"}),n.jsx("li",{children:"Copie o nmero do pagamento (ex: 12345678901)"})]})]})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"payment_id",children:"ID do Pagamento"}),n.jsx(et,{id:"payment_id",placeholder:"Ex: 12345678901",value:i,onChange:m=>o(m.target.value),disabled:l,onKeyDown:m=>{m.key==="Enter"&&!l&&i.trim()&&h()}})]}),c&&n.jsxs(of,{variant:c.success?"default":"destructive",className:c.success?"bg-green-50 border-green-200":"",children:[c.success?n.jsx(Sr,{className:"h-4 w-4 text-green-600"}):n.jsx(Or,{className:"h-4 w-4"}),n.jsxs(lf,{children:[n.jsx("span",{className:c.success?"text-green-800":"",children:c.message}),c.amount&&n.jsxs("div",{className:"mt-1 font-medium text-green-700",children:["Valor confirmado: R$ ",c.amount.toFixed(2)]}),c.paid_at&&n.jsxs("div",{className:"mt-1 text-sm text-green-600",children:["Data do pagamento: ",new Date(c.paid_at).toLocaleString("pt-BR")]}),c.order&&n.jsxs("div",{className:"mt-2 text-xs text-muted-foreground font-mono space-y-1",children:[n.jsxs("div",{children:["Pedido: ",c.order.id.slice(0,8),"..."]}),n.jsxs("div",{children:["Status: ",n.jsx("span",{className:"font-semibold text-green-700",children:c.order.status})]}),n.jsxs("div",{children:["Payment Status: ",n.jsx("span",{className:"font-semibold",children:c.order.payment_status})]})]}),c.live_cart&&n.jsxs("div",{className:"mt-2 text-xs text-muted-foreground font-mono space-y-1",children:[n.jsxs("div",{children:["Sacola: ",c.live_cart.id.slice(0,8),"..."]}),n.jsxs("div",{children:["Status: ",n.jsx("span",{className:"font-semibold text-green-700",children:c.live_cart.status})]})]})]})]}),(s||a)&&!c&&n.jsxs("p",{className:"text-xs text-muted-foreground",children:[s&&n.jsxs(n.Fragment,{children:["Pedido: ",n.jsx("span",{className:"font-mono",children:s.slice(0,8)})]}),a&&n.jsxs(n.Fragment,{children:["Sacola: ",n.jsx("span",{className:"font-mono",children:a.slice(0,8)})]})]})]}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx(he,{variant:"outline",onClick:f,disabled:l,children:c!=null&&c.success?"Fechar":"Cancelar"}),!(c!=null&&c.success)&&n.jsxs(he,{onClick:h,disabled:l||!i.trim(),children:[l?n.jsx(Qr,{className:"h-4 w-4 mr-2 animate-spin"}):n.jsx(Qr,{className:"h-4 w-4 mr-2"}),"Revalidar"]})]})]})})}const axe=({isOpen:e,onClose:t,order:r,onSuccess:s})=>{const[a,i]=P.useState(!1),o=async l=>{if(r){i(!0);try{if(l){const{error:d}=await le.from("orders").update({status:"pago",payment_review_status:"approved",paid_at:new Date().toISOString()}).eq("id",r.id);if(d)throw d;if(r.live_cart_id){const{error:c}=await le.from("live_carts").update({status:"pago",operational_status:"pago"}).eq("id",r.live_cart_id);c&&console.error("Error updating live cart:",c)}de.success("Pagamento aprovado com sucesso!")}else{const{error:d}=await le.from("orders").update({status:"aguardando_pagamento",payment_review_status:"rejected"}).eq("id",r.id);if(d)throw d;r.live_cart_id&&await le.from("live_carts").update({operational_status:"pendente"}).eq("id",r.live_cart_id),de.error("Pagamento rejeitado. O cliente precisar enviar um novo comprovante.")}s(),t()}catch(d){console.error("Error validating payment:",d),de.error("Erro ao processar: "+d.message)}finally{i(!1)}}};return r?n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"sm:max-w-[500px]",children:[n.jsx(ln,{children:n.jsx(rn,{children:"Validar Comprovante de Pagamento"})}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsxs("div",{className:"flex justify-between items-center text-sm border-b pb-2",children:[n.jsx("span",{className:"text-muted-foreground",children:"Pedido:"}),n.jsxs("span",{className:"font-medium",children:["#",r.id.slice(0,8)]})]}),n.jsxs("div",{className:"flex justify-between items-center text-sm border-b pb-2",children:[n.jsx("span",{className:"text-muted-foreground",children:"Cliente:"}),n.jsx("span",{className:"font-medium",children:r.customer_name})]}),n.jsxs("div",{className:"flex justify-between items-center text-sm border-b pb-2",children:[n.jsx("span",{className:"text-muted-foreground",children:"Valor Total:"}),n.jsx("span",{className:"font-semibold text-primary",children:new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(r.total)})]}),n.jsxs("div",{className:"mt-4",children:[n.jsx("p",{className:"text-sm font-medium mb-2",children:"Comprovante enviado:"}),r.payment_proof_url?n.jsxs("div",{className:"relative group rounded-lg overflow-hidden border bg-muted min-h-[200px] flex items-center justify-center",children:[n.jsx("img",{src:r.payment_proof_url,alt:"Comprovante",className:"max-h-[400px] w-auto object-contain cursor-pointer",onClick:()=>window.open(r.payment_proof_url,"_blank")}),n.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2",children:n.jsx(he,{variant:"secondary",size:"sm",asChild:!0,children:n.jsxs("a",{href:r.payment_proof_url,target:"_blank",rel:"noreferrer",children:[n.jsx(Zs,{className:"h-4 w-4 mr-2"}),"Ampliar"]})})})]}):n.jsx("div",{className:"p-8 text-center border-2 border-dashed rounded-lg text-muted-foreground",children:"Comprovante no encontrado ou URL invlida."})]})]}),n.jsxs(ba,{className:"flex gap-2 sm:gap-0",children:[n.jsxs(he,{variant:"outline",className:"flex-1 text-destructive hover:text-destructive",onClick:()=>o(!1),disabled:a,children:[n.jsx(Kn,{className:"h-4 w-4 mr-2"}),"Recusar"]}),n.jsxs(he,{className:"flex-1 bg-green-600 hover:bg-green-700",onClick:()=>o(!0),disabled:a,children:[a?n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}):n.jsx(mn,{className:"h-4 w-4 mr-2"}),"Aprovar Pagamento"]})]})]})}):null};function $r(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Wi(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function mi(e,t){const r=$r(e);return isNaN(t)?Wi(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function qo(e,t){const r=$r(e);if(isNaN(t))return Wi(e,NaN);if(!t)return r;const s=r.getDate(),a=Wi(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const i=a.getDate();return s>=i?a:(r.setFullYear(a.getFullYear(),a.getMonth(),s),r)}const Lk=6048e5,ixe=864e5,$W=6e4,Bk=36e5,xy=43200,PR=1440;let oxe={};function vg(){return oxe}function pc(e,t){var l,d,c,u;const r=vg(),s=(t==null?void 0:t.weekStartsOn)??((d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.weekStartsOn)??r.weekStartsOn??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,a=$r(e),i=a.getDay(),o=(i<s?7:0)+i-s;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function cf(e){return pc(e,{weekStartsOn:1})}function FW(e){const t=$r(e),r=t.getFullYear(),s=Wi(e,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const a=cf(s),i=Wi(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=cf(i);return t.getTime()>=a.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function Vn(e){const t=$r(e);return t.setHours(0,0,0,0),t}function xp(e){const t=$r(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function ec(e,t){const r=Vn(e),s=Vn(t),a=+r-xp(r),i=+s-xp(s);return Math.round((a-i)/ixe)}function lxe(e){const t=FW(e),r=Wi(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),cf(r)}function bC(e,t){const r=t*7;return mi(e,r)}function zW(e,t){return qo(e,t*12)}function cxe(e){let t;return e.forEach(function(r){const s=$r(r);(t===void 0||t<s||isNaN(Number(s)))&&(t=s)}),t||new Date(NaN)}function dxe(e){let t;return e.forEach(r=>{const s=$r(r);(!t||t>s||isNaN(+s))&&(t=s)}),t||new Date(NaN)}function pb(e,t){const r=$r(e),s=$r(t),a=r.getTime()-s.getTime();return a<0?-1:a>0?1:a}function uxe(e){return Wi(e,Date.now())}function Di(e,t){const r=Vn(e),s=Vn(t);return+r==+s}function $k(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function hxe(e){if(!$k(e)&&typeof e!="number")return!1;const t=$r(e);return!isNaN(Number(t))}function vp(e,t){const r=$r(e),s=$r(t),a=r.getFullYear()-s.getFullYear(),i=r.getMonth()-s.getMonth();return a*12+i}function fxe(e,t,r){const s=pc(e,r),a=pc(t,r),i=+s-xp(s),o=+a-xp(a);return Math.round((i-o)/Lk)}function UW(e){return t=>{const s=(e?Math[e]:Math.trunc)(t);return s===0?0:s}}function VW(e,t){return+$r(e)-+$r(t)}function OR(e,t,r){const s=VW(e,t)/Bk;return UW(r==null?void 0:r.roundingMethod)(s)}function Jn(e){const t=$r(e);return t.setHours(23,59,59,999),t}function lc(e){const t=$r(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function mxe(e){const t=$r(e);return+Jn(t)==+lc(t)}function pxe(e,t){const r=$r(e),s=$r(t),a=pb(r,s),i=Math.abs(vp(r,s));let o;if(i<1)o=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*i);let l=pb(r,s)===-a;mxe($r(e))&&i===1&&pb(e,s)===1&&(l=!1),o=a*(i-Number(l))}return o===0?0:o}function gxe(e,t,r){const s=VW(e,t)/1e3;return UW(r==null?void 0:r.roundingMethod)(s)}function Cs(e){const t=$r(e);return t.setDate(1),t.setHours(0,0,0,0),t}function xxe(e){const t=$r(e),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function Fk(e){const t=$r(e),r=Wi(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function zk(e,t){var l,d,c,u;const r=vg(),s=(t==null?void 0:t.weekStartsOn)??((d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.weekStartsOn)??r.weekStartsOn??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,a=$r(e),i=a.getDay(),o=(i<s?-7:0)+6-(i-s);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}function qW(e){return zk(e,{weekStartsOn:1})}const vxe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},yxe=(e,t,r)=>{let s;const a=vxe[e];return typeof a=="string"?s=a:t===1?s=a.one:s=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+s:s+" ago":s};function Fm(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const bxe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},wxe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},_xe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},jxe={date:Fm({formats:bxe,defaultWidth:"full"}),time:Fm({formats:wxe,defaultWidth:"full"}),dateTime:Fm({formats:_xe,defaultWidth:"full"})},Nxe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Sxe=(e,t,r,s)=>Nxe[e];function Xl(e){return(t,r)=>{const s=r!=null&&r.context?String(r.context):"standalone";let a;if(s==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const Cxe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Exe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},kxe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Axe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Txe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Pxe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Oxe=(e,t)=>{const r=Number(e),s=r%100;if(s>20||s<10)switch(s%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Rxe={ordinalNumber:Oxe,era:Xl({values:Cxe,defaultWidth:"wide"}),quarter:Xl({values:Exe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Xl({values:kxe,defaultWidth:"wide"}),day:Xl({values:Axe,defaultWidth:"wide"}),dayPeriod:Xl({values:Txe,defaultWidth:"wide",formattingValues:Pxe,defaultFormattingWidth:"wide"})};function Yl(e){return(t,r={})=>{const s=r.width,a=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const o=i[0],l=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(l)?Ixe(l,h=>h.test(o)):Mxe(l,h=>h.test(o));let c;c=e.valueCallback?e.valueCallback(d):d,c=r.valueCallback?r.valueCallback(c):c;const u=t.slice(o.length);return{value:c,rest:u}}}function Mxe(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function Ixe(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function WW(e){return(t,r={})=>{const s=t.match(e.matchPattern);if(!s)return null;const a=s[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=t.slice(a.length);return{value:o,rest:l}}}const Dxe=/^(\d+)(th|st|nd|rd)?/i,Lxe=/\d+/i,Bxe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},$xe={any:[/^b/i,/^(a|c)/i]},Fxe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},zxe={any:[/1/i,/2/i,/3/i,/4/i]},Uxe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Vxe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},qxe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Wxe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Hxe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Gxe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Kxe={ordinalNumber:WW({matchPattern:Dxe,parsePattern:Lxe,valueCallback:e=>parseInt(e,10)}),era:Yl({matchPatterns:Bxe,defaultMatchWidth:"wide",parsePatterns:$xe,defaultParseWidth:"any"}),quarter:Yl({matchPatterns:Fxe,defaultMatchWidth:"wide",parsePatterns:zxe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Yl({matchPatterns:Uxe,defaultMatchWidth:"wide",parsePatterns:Vxe,defaultParseWidth:"any"}),day:Yl({matchPatterns:qxe,defaultMatchWidth:"wide",parsePatterns:Wxe,defaultParseWidth:"any"}),dayPeriod:Yl({matchPatterns:Hxe,defaultMatchWidth:"any",parsePatterns:Gxe,defaultParseWidth:"any"})},Uk={code:"en-US",formatDistance:yxe,formatLong:jxe,formatRelative:Sxe,localize:Rxe,match:Kxe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Xxe(e){const t=$r(e);return ec(t,Fk(t))+1}function HW(e){const t=$r(e),r=+cf(t)-+lxe(t);return Math.round(r/Lk)+1}function GW(e,t){var u,h,f,m;const r=$r(e),s=r.getFullYear(),a=vg(),i=(t==null?void 0:t.firstWeekContainsDate)??((h=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((m=(f=a.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=Wi(e,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const l=pc(o,t),d=Wi(e,0);d.setFullYear(s,0,i),d.setHours(0,0,0,0);const c=pc(d,t);return r.getTime()>=l.getTime()?s+1:r.getTime()>=c.getTime()?s:s-1}function Yxe(e,t){var l,d,c,u;const r=vg(),s=(t==null?void 0:t.firstWeekContainsDate)??((d=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(c=r.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,a=GW(e,t),i=Wi(e,0);return i.setFullYear(a,0,s),i.setHours(0,0,0,0),pc(i,t)}function KW(e,t){const r=$r(e),s=+pc(r,t)-+Yxe(r,t);return Math.round(s/Lk)+1}function Bn(e,t){const r=e<0?"-":"",s=Math.abs(e).toString().padStart(t,"0");return r+s}const kd={y(e,t){const r=e.getFullYear(),s=r>0?r:1-r;return Bn(t==="yy"?s%100:s,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Bn(r+1,2)},d(e,t){return Bn(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Bn(e.getHours()%12||12,t.length)},H(e,t){return Bn(e.getHours(),t.length)},m(e,t){return Bn(e.getMinutes(),t.length)},s(e,t){return Bn(e.getSeconds(),t.length)},S(e,t){const r=t.length,s=e.getMilliseconds(),a=Math.trunc(s*Math.pow(10,r-3));return Bn(a,t.length)}},Wf={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},RR={G:function(e,t,r){const s=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(s,{width:"abbreviated"});case"GGGGG":return r.era(s,{width:"narrow"});case"GGGG":default:return r.era(s,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const s=e.getFullYear(),a=s>0?s:1-s;return r.ordinalNumber(a,{unit:"year"})}return kd.y(e,t)},Y:function(e,t,r,s){const a=GW(e,s),i=a>0?a:1-a;if(t==="YY"){const o=i%100;return Bn(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Bn(i,t.length)},R:function(e,t){const r=FW(e);return Bn(r,t.length)},u:function(e,t){const r=e.getFullYear();return Bn(r,t.length)},Q:function(e,t,r){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return Bn(s,2);case"Qo":return r.ordinalNumber(s,{unit:"quarter"});case"QQQ":return r.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,t,r){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return Bn(s,2);case"qo":return r.ordinalNumber(s,{unit:"quarter"});case"qqq":return r.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,t,r){const s=e.getMonth();switch(t){case"M":case"MM":return kd.M(e,t);case"Mo":return r.ordinalNumber(s+1,{unit:"month"});case"MMM":return r.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(s,{width:"wide",context:"formatting"})}},L:function(e,t,r){const s=e.getMonth();switch(t){case"L":return String(s+1);case"LL":return Bn(s+1,2);case"Lo":return r.ordinalNumber(s+1,{unit:"month"});case"LLL":return r.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(s,{width:"wide",context:"standalone"})}},w:function(e,t,r,s){const a=KW(e,s);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Bn(a,t.length)},I:function(e,t,r){const s=HW(e);return t==="Io"?r.ordinalNumber(s,{unit:"week"}):Bn(s,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):kd.d(e,t)},D:function(e,t,r){const s=Xxe(e);return t==="Do"?r.ordinalNumber(s,{unit:"dayOfYear"}):Bn(s,t.length)},E:function(e,t,r){const s=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(s,{width:"short",context:"formatting"});case"EEEE":default:return r.day(s,{width:"wide",context:"formatting"})}},e:function(e,t,r,s){const a=e.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Bn(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,s){const a=e.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Bn(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const s=e.getDay(),a=s===0?7:s;switch(t){case"i":return String(a);case"ii":return Bn(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(s,{width:"short",context:"formatting"});case"iiii":default:return r.day(s,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const s=e.getHours();let a;switch(s===12?a=Wf.noon:s===0?a=Wf.midnight:a=s/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const s=e.getHours();let a;switch(s>=17?a=Wf.evening:s>=12?a=Wf.afternoon:s>=4?a=Wf.morning:a=Wf.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let s=e.getHours()%12;return s===0&&(s=12),r.ordinalNumber(s,{unit:"hour"})}return kd.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):kd.H(e,t)},K:function(e,t,r){const s=e.getHours()%12;return t==="Ko"?r.ordinalNumber(s,{unit:"hour"}):Bn(s,t.length)},k:function(e,t,r){let s=e.getHours();return s===0&&(s=24),t==="ko"?r.ordinalNumber(s,{unit:"hour"}):Bn(s,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):kd.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):kd.s(e,t)},S:function(e,t){return kd.S(e,t)},X:function(e,t,r){const s=e.getTimezoneOffset();if(s===0)return"Z";switch(t){case"X":return IR(s);case"XXXX":case"XX":return dh(s);case"XXXXX":case"XXX":default:return dh(s,":")}},x:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"x":return IR(s);case"xxxx":case"xx":return dh(s);case"xxxxx":case"xxx":default:return dh(s,":")}},O:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+MR(s,":");case"OOOO":default:return"GMT"+dh(s,":")}},z:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+MR(s,":");case"zzzz":default:return"GMT"+dh(s,":")}},t:function(e,t,r){const s=Math.trunc(e.getTime()/1e3);return Bn(s,t.length)},T:function(e,t,r){const s=e.getTime();return Bn(s,t.length)}};function MR(e,t=""){const r=e>0?"-":"+",s=Math.abs(e),a=Math.trunc(s/60),i=s%60;return i===0?r+String(a):r+String(a)+t+Bn(i,2)}function IR(e,t){return e%60===0?(e>0?"-":"+")+Bn(Math.abs(e)/60,2):dh(e,t)}function dh(e,t=""){const r=e>0?"-":"+",s=Math.abs(e),a=Bn(Math.trunc(s/60),2),i=Bn(s%60,2);return r+a+t+i}const DR=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},XW=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Zxe=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],s=r[1],a=r[2];if(!a)return DR(e,t);let i;switch(s){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",DR(s,t)).replace("{{time}}",XW(a,t))},Qxe={p:XW,P:Zxe},Jxe=/^D+$/,eve=/^Y+$/,tve=["D","DD","YY","YYYY"];function rve(e){return Jxe.test(e)}function nve(e){return eve.test(e)}function sve(e,t,r){const s=ave(e,t,r);if(console.warn(s),tve.includes(e))throw new RangeError(s)}function ave(e,t,r){const s=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${s} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const ive=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ove=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,lve=/^'([^]*?)'?$/,cve=/''/g,dve=/[a-zA-Z]/;function Wt(e,t,r){var u,h,f,m,p,g,x,v;const s=vg(),a=(r==null?void 0:r.locale)??s.locale??Uk,i=(r==null?void 0:r.firstWeekContainsDate)??((h=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(f=s.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((g=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:g.weekStartsOn)??s.weekStartsOn??((v=(x=s.locale)==null?void 0:x.options)==null?void 0:v.weekStartsOn)??0,l=$r(e);if(!hxe(l))throw new RangeError("Invalid time value");let d=t.match(ove).map(y=>{const b=y[0];if(b==="p"||b==="P"){const j=Qxe[b];return j(y,a.formatLong)}return y}).join("").match(ive).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const b=y[0];if(b==="'")return{isToken:!1,value:uve(y)};if(RR[b])return{isToken:!0,value:y};if(b.match(dve))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:y}});a.localize.preprocessor&&(d=a.localize.preprocessor(l,d));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return d.map(y=>{if(!y.isToken)return y.value;const b=y.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&nve(b)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&rve(b))&&sve(b,t,String(e));const j=RR[b[0]];return j(l,b,a.localize,c)}).join("")}function uve(e){const t=e.match(lve);return t?t[1].replace(cve,"'"):e}function hve(e,t,r){const s=vg(),a=(r==null?void 0:r.locale)??s.locale??Uk,i=2520,o=pb(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o});let d,c;o>0?(d=$r(t),c=$r(e)):(d=$r(e),c=$r(t));const u=gxe(c,d),h=(xp(c)-xp(d))/1e3,f=Math.round((u-h)/60);let m;if(f<2)return r!=null&&r.includeSeconds?u<5?a.formatDistance("lessThanXSeconds",5,l):u<10?a.formatDistance("lessThanXSeconds",10,l):u<20?a.formatDistance("lessThanXSeconds",20,l):u<40?a.formatDistance("halfAMinute",0,l):u<60?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",1,l):f===0?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",f,l);if(f<45)return a.formatDistance("xMinutes",f,l);if(f<90)return a.formatDistance("aboutXHours",1,l);if(f<PR){const p=Math.round(f/60);return a.formatDistance("aboutXHours",p,l)}else{if(f<i)return a.formatDistance("xDays",1,l);if(f<xy){const p=Math.round(f/PR);return a.formatDistance("xDays",p,l)}else if(f<xy*2)return m=Math.round(f/xy),a.formatDistance("aboutXMonths",m,l)}if(m=pxe(c,d),m<12){const p=Math.round(f/xy);return a.formatDistance("xMonths",p,l)}else{const p=m%12,g=Math.trunc(m/12);return p<3?a.formatDistance("aboutXYears",g,l):p<9?a.formatDistance("overXYears",g,l):a.formatDistance("almostXYears",g+1,l)}}function Vk(e,t){return hve(e,uxe(e),t)}function fve(e){const t=$r(e),r=t.getFullYear(),s=t.getMonth(),a=Wi(e,0);return a.setFullYear(r,s+1,0),a.setHours(0,0,0,0),a.getDate()}function mve(e){return Math.trunc(+$r(e)/1e3)}function pve(e){const t=$r(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function gve(e,t){return fxe(pve(e),Cs(e),t)+1}function yw(e,t){const r=$r(e),s=$r(t);return r.getTime()>s.getTime()}function qk(e,t){const r=$r(e),s=$r(t);return+r<+s}function Wk(e,t){const r=$r(e),s=$r(t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function xve(e,t){const r=$r(e),s=$r(t);return r.getFullYear()===s.getFullYear()}function fn(e,t){return mi(e,-t)}function Qd(e,t){const s=wve(e);let a;if(s.date){const d=_ve(s.date,2);a=jve(d.restDateString,d.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let o=0,l;if(s.time&&(o=Nve(s.time),isNaN(o)))return new Date(NaN);if(s.timezone){if(l=Sve(s.timezone),isNaN(l))return new Date(NaN)}else{const d=new Date(i+o),c=new Date(0);return c.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),c.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),c}return new Date(i+o+l)}const vy={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},vve=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,yve=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,bve=/^([+-])(\d{2})(?::?(\d{2}))?$/;function wve(e){const t={},r=e.split(vy.dateTimeDelimiter);let s;if(r.length>2)return t;if(/:/.test(r[0])?s=r[0]:(t.date=r[0],s=r[1],vy.timeZoneDelimiter.test(t.date)&&(t.date=e.split(vy.timeZoneDelimiter)[0],s=e.substr(t.date.length,e.length))),s){const a=vy.timezone.exec(s);a?(t.time=s.replace(a[1],""),t.timezone=a[1]):t.time=s}return t}function _ve(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=e.match(r);if(!s)return{year:NaN,restDateString:""};const a=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?a:i*100,restDateString:e.slice((s[1]||s[2]).length)}}function jve(e,t){if(t===null)return new Date(NaN);const r=e.match(vve);if(!r)return new Date(NaN);const s=!!r[4],a=n0(r[1]),i=n0(r[2])-1,o=n0(r[3]),l=n0(r[4]),d=n0(r[5])-1;if(s)return Tve(t,l,d)?Cve(t,l,d):new Date(NaN);{const c=new Date(0);return!kve(t,i,o)||!Ave(t,a)?new Date(NaN):(c.setUTCFullYear(t,i,Math.max(a,o)),c)}}function n0(e){return e?parseInt(e):1}function Nve(e){const t=e.match(yve);if(!t)return NaN;const r=h3(t[1]),s=h3(t[2]),a=h3(t[3]);return Pve(r,s,a)?r*Bk+s*$W+a*1e3:NaN}function h3(e){return e&&parseFloat(e.replace(",","."))||0}function Sve(e){if(e==="Z")return 0;const t=e.match(bve);if(!t)return 0;const r=t[1]==="+"?-1:1,s=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return Ove(s,a)?r*(s*Bk+a*$W):NaN}function Cve(e,t,r){const s=new Date(0);s.setUTCFullYear(e,0,4);const a=s.getUTCDay()||7,i=(t-1)*7+r+1-a;return s.setUTCDate(s.getUTCDate()+i),s}const Eve=[31,null,31,30,31,30,31,31,30,31,30,31];function YW(e){return e%400===0||e%4===0&&e%100!==0}function kve(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(Eve[t]||(YW(e)?29:28))}function Ave(e,t){return t>=1&&t<=(YW(e)?366:365)}function Tve(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function Pve(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function Ove(e,t){return t>=0&&t<=59}function f3(e,t){const r=$r(e),s=r.getFullYear(),a=r.getDate(),i=Wi(e,0);i.setFullYear(s,t,15),i.setHours(0,0,0,0);const o=fve(i);return r.setMonth(t,Math.min(a,o)),r}function LR(e,t){const r=$r(e);return isNaN(+r)?Wi(e,NaN):(r.setFullYear(t),r)}function so(e,t){return qo(e,-t)}function BR(e,t){return zW(e,-t)}const Rve={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},Mve=(e,t,r)=>{let s;const a=Rve[e];return typeof a=="string"?s=a:t===1?s=a.one:s=a.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"em "+s:"h "+s:s},Ive={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},Dve={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Lve={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Bve={date:Fm({formats:Ive,defaultWidth:"full"}),time:Fm({formats:Dve,defaultWidth:"full"}),dateTime:Fm({formats:Lve,defaultWidth:"full"})},$ve={lastWeek:e=>{const t=e.getDay();return"'"+(t===0||t===6?"ltimo":"ltima")+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},Fve=(e,t,r,s)=>{const a=$ve[e];return typeof a=="function"?a(t):a},zve={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},Uve={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},Vve={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},qve={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},Wve={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},Hve={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},Gve=(e,t)=>{const r=Number(e);return(t==null?void 0:t.unit)==="week"?r+"":r+""},Kve={ordinalNumber:Gve,era:Xl({values:zve,defaultWidth:"wide"}),quarter:Xl({values:Uve,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Xl({values:Vve,defaultWidth:"wide"}),day:Xl({values:qve,defaultWidth:"wide"}),dayPeriod:Xl({values:Wve,defaultWidth:"wide",formattingValues:Hve,defaultFormattingWidth:"wide"})},Xve=/^(\d+)[o]?/i,Yve=/\d+/i,Zve={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},Qve={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},Jve={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},e1e={any:[/1/i,/2/i,/3/i,/4/i]},t1e={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},r1e={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},n1e={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},s1e={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},a1e={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},i1e={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},o1e={ordinalNumber:WW({matchPattern:Xve,parsePattern:Yve,valueCallback:e=>parseInt(e,10)}),era:Yl({matchPatterns:Zve,defaultMatchWidth:"wide",parsePatterns:Qve,defaultParseWidth:"any"}),quarter:Yl({matchPatterns:Jve,defaultMatchWidth:"wide",parsePatterns:e1e,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Yl({matchPatterns:t1e,defaultMatchWidth:"wide",parsePatterns:r1e,defaultParseWidth:"any"}),day:Yl({matchPatterns:n1e,defaultMatchWidth:"wide",parsePatterns:s1e,defaultParseWidth:"any"}),dayPeriod:Yl({matchPatterns:a1e,defaultMatchWidth:"any",parsePatterns:i1e,defaultParseWidth:"any"})},mr={code:"pt-BR",formatDistance:Mve,formatLong:Bve,formatRelative:Fve,localize:Kve,match:o1e,options:{weekStartsOn:0,firstWeekContainsDate:1}},$R=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),l1e=e=>{switch(e){case"motoboy":return"Motoboy";case"pickup":return"Retirada na loja";case"shipping":return"Correios";default:return"No definido"}},ZW=()=>`
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  body {
    font-family: 'Segoe UI', Arial, sans-serif;
    padding: 20px;
    max-width: 800px;
    margin: 0 auto;
    font-size: 12px;
    color: #1a1a1a;
  }
  .packing-slip {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 24px;
    page-break-inside: avoid;
    margin-bottom: 20px;
  }
  .header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    border-bottom: 2px solid #000;
    padding-bottom: 16px;
    margin-bottom: 16px;
  }
  .logo-section {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .logo-section img {
    height: 40px;
    object-fit: contain;
  }
  .store-name {
    font-size: 24px;
    font-weight: bold;
  }
  .document-title {
    font-size: 18px;
    font-weight: bold;
    text-transform: uppercase;
    color: #666;
  }
  .order-info {
    text-align: right;
  }
  .order-number {
    font-size: 20px;
    font-weight: bold;
    font-family: monospace;
  }
  .order-date {
    font-size: 11px;
    color: #666;
  }
  .section {
    margin-bottom: 16px;
  }
  .section-title {
    font-size: 11px;
    font-weight: bold;
    text-transform: uppercase;
    color: #666;
    margin-bottom: 8px;
    border-bottom: 1px solid #eee;
    padding-bottom: 4px;
  }
  .customer-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
  }
  .info-block {
    padding: 12px;
    background: #f9f9f9;
    border-radius: 6px;
  }
  .info-label {
    font-size: 10px;
    color: #666;
    text-transform: uppercase;
    margin-bottom: 2px;
  }
  .info-value {
    font-size: 13px;
    font-weight: 500;
  }
  .items-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 16px;
  }
  .items-table th {
    background: #f3f3f3;
    padding: 10px 8px;
    text-align: left;
    font-size: 10px;
    text-transform: uppercase;
    font-weight: 600;
    border-bottom: 2px solid #ddd;
  }
  .items-table td {
    padding: 12px 8px;
    border-bottom: 1px solid #eee;
    vertical-align: top;
  }
  .items-table tr:last-child td {
    border-bottom: none;
  }
  .item-name {
    font-weight: 500;
    font-size: 13px;
  }
  .item-sku {
    font-size: 11px;
    color: #444;
    font-family: monospace;
    margin-top: 2px;
  }
  .item-details {
    font-size: 11px;
    color: #666;
    margin-top: 2px;
  }
  .item-photo-col {
    width: 50px;
    text-align: center;
    vertical-align: middle;
  }
  .item-thumbnail {
    width: 40px;
    height: 40px;
    object-fit: cover;
    border-radius: 4px;
    border: 1px solid #ddd;
  }
  .no-photo {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f5f5f5;
    border-radius: 4px;
    font-size: 16px;
    margin: 0 auto;
  }
  .item-size {
    font-weight: 600;
    font-size: 14px;
    text-align: center;
  }
  .item-qty {
    font-weight: 600;
    font-size: 14px;
    text-align: center;
  }
  .item-price {
    text-align: right;
    font-weight: 500;
  }
  .checkbox-col {
    width: 30px;
    text-align: center;
  }
  .checkbox {
    width: 16px;
    height: 16px;
    border: 2px solid #000;
    display: inline-block;
    border-radius: 3px;
  }
  .totals {
    display: flex;
    justify-content: flex-end;
  }
  .totals-box {
    text-align: right;
    background: #f9f9f9;
    padding: 12px 16px;
    border-radius: 6px;
    min-width: 200px;
  }
  .total-row {
    display: flex;
    justify-content: space-between;
    padding: 4px 0;
    font-size: 12px;
  }
  .total-row.grand-total {
    font-size: 16px;
    font-weight: bold;
    border-top: 2px solid #000;
    margin-top: 8px;
    padding-top: 8px;
  }
  .notes-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-top: 16px;
  }
  .notes-box {
    padding: 12px;
    border: 1px dashed #ccc;
    border-radius: 6px;
    min-height: 60px;
  }
  .notes-title {
    font-size: 10px;
    font-weight: bold;
    text-transform: uppercase;
    color: #666;
    margin-bottom: 6px;
  }
  .notes-content {
    font-size: 11px;
    white-space: pre-wrap;
  }
  .signature-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 24px;
    margin-top: 24px;
    padding-top: 16px;
    border-top: 2px dashed #ccc;
  }
  .signature-box {
    text-align: center;
  }
  .signature-line {
    border-bottom: 1px solid #000;
    height: 40px;
    margin-bottom: 8px;
  }
  .signature-label {
    font-size: 11px;
    color: #666;
  }
  .delivery-badge {
    display: inline-block;
    padding: 4px 12px;
    background: #e0f2fe;
    color: #0369a1;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
  }
  .delivery-badge.motoboy {
    background: #fef3c7;
    color: #92400e;
  }
  .delivery-badge.pickup {
    background: #d1fae5;
    color: #065f46;
  }
  @media print {
    body {
      padding: 0;
    }
    .packing-slip {
      border: none;
      page-break-after: always;
    }
    .packing-slip:last-child {
      page-break-after: avoid;
    }
  }
`,QW=(e,t,r)=>{const s=e.id.slice(0,8).toUpperCase(),a=Wt(new Date(e.created_at),"dd 'de' MMMM 'de' yyyy 's' HH:mm",{locale:mr}),i=e.delivery_method==="motoboy"?"motoboy":e.delivery_method==="pickup"?"pickup":"",o=t.map(d=>`
    <tr>
      <td class="checkbox-col"><span class="checkbox"></span></td>
      <td class="item-photo-col">
        ${d.image_url?`<img src="${d.image_url}" alt="${d.product_name}" class="item-thumbnail" />`:'<div class="no-photo"></div>'}
      </td>
      <td>
        <div class="item-name">${d.product_name}</div>
        ${d.product_sku?`<div class="item-sku">SKU: ${d.product_sku}</div>`:""}
        ${d.color?`<div class="item-details">Cor: ${d.color}</div>`:""}
      </td>
      <td class="item-size">${d.size||"-"}</td>
      <td class="item-qty">${d.quantity}</td>
      <td class="item-price">${$R(d.product_price*d.quantity)}</td>
    </tr>
  `).join(""),l=t.reduce((d,c)=>d+c.quantity,0);return`
    <div class="packing-slip">
      <div class="header">
        <div class="logo-section">
          ${r?`<img src="${r}" alt="Logo" />`:""}
          <div>
            <div class="document-title">Romaneio de Separao</div>
          </div>
        </div>
        <div class="order-info">
          <div class="order-number">#${s}</div>
          <div class="order-date">${a}</div>
          <div style="margin-top: 8px;">
            <span class="delivery-badge ${i}">${l1e(e.delivery_method)}</span>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">Dados do Cliente</div>
        <div class="customer-info">
          <div class="info-block">
            <div class="info-label">Nome</div>
            <div class="info-value">${e.customer_name}</div>
          </div>
          <div class="info-block">
            <div class="info-label">Telefone</div>
            <div class="info-value">${e.customer_phone}</div>
          </div>
        </div>
        ${e.delivery_method!=="pickup"?`
          <div class="info-block" style="margin-top: 8px;">
            <div class="info-label">Endereo de Entrega</div>
            <div class="info-value">${e.customer_address||"No informado"}</div>
          </div>
        `:""}
      </div>

      <div class="section">
        <div class="section-title">Itens do Pedido (${l} ${l===1?"item":"itens"})</div>
        <table class="items-table">
          <thead>
            <tr>
              <th class="checkbox-col"></th>
              <th style="width: 50px;">Foto</th>
              <th>Produto / SKU</th>
              <th style="text-align: center; width: 80px;">Tamanho</th>
              <th style="text-align: center; width: 50px;">Qtd</th>
              <th style="text-align: right; width: 100px;">Subtotal</th>
            </tr>
          </thead>
          <tbody>
            ${o}
          </tbody>
        </table>

        <div class="totals">
          <div class="totals-box">
            <div class="total-row grand-total">
              <span>Total:</span>
              <span>${$R(e.total)}</span>
            </div>
          </div>
        </div>
      </div>

      ${e.customer_notes||e.internal_notes?`
        <div class="notes-section">
          ${e.customer_notes?`
            <div class="notes-box">
              <div class="notes-title"> Observao do Cliente</div>
              <div class="notes-content">${e.customer_notes}${e.delivery_period?`

Perodo: ${e.delivery_period==="manha"?"Manh":e.delivery_period==="tarde"?"Tarde":"Qualquer horrio"}`:""}</div>
            </div>
          `:"<div></div>"}
          ${e.internal_notes?`
            <div class="notes-box">
              <div class="notes-title"> Observao Interna</div>
              <div class="notes-content">${e.internal_notes}</div>
            </div>
          `:"<div></div>"}
        </div>
      `:""}

      <div class="signature-section">
        <div class="signature-box">
          <div class="signature-line"></div>
          <div class="signature-label">Separado por</div>
        </div>
        <div class="signature-box">
          <div class="signature-line"></div>
          <div class="signature-label">Conferido por</div>
        </div>
      </div>
    </div>
  `},JW=async e=>new Promise(t=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.width,s.height=r.height;const a=s.getContext("2d");a==null||a.drawImage(r,0,0),t(s.toDataURL("image/png"))},r.onerror=()=>t(""),r.src=e});function c1e({order:e,items:t,variant:r="button"}){const s=async()=>{if(t.length===0){de.error("Nenhum item no pedido");return}const a=await JW(bf),i=window.open("","_blank","width=900,height=700");if(!i){de.error("No foi possvel abrir janela de impresso");return}i.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Romaneio #${e.id.slice(0,8).toUpperCase()}</title>
          <style>${ZW()}</style>
        </head>
        <body>
          ${QW(e,t,a)}
          <script>
            setTimeout(() => { window.print(); }, 500);
          <\/script>
        </body>
      </html>
    `),i.document.close()};return r==="icon"?n.jsx(he,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:a=>{a.stopPropagation(),s()},title:"Imprimir romaneio",children:n.jsx(Kh,{className:"h-4 w-4"})}):n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2",onClick:a=>{a.stopPropagation(),s()},children:[n.jsx(Kh,{className:"h-4 w-4"}),"Imprimir Pedido"]})}function d1e({orders:e}){const t=async()=>{if(e.length===0){de.error("Nenhum pedido selecionado");return}const r=await JW(bf),s=window.open("","_blank","width=900,height=700");if(!s){de.error("No foi possvel abrir janela de impresso");return}const a=e.map(({order:i,items:o})=>QW(i,o,r)).join('<div style="page-break-before: always;"></div>');s.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Romaneios - ${e.length} pedidos</title>
          <style>${ZW()}</style>
        </head>
        <body>
          ${a}
          <script>
            setTimeout(() => { window.print(); }, 500);
          <\/script>
        </body>
      </html>
    `),s.document.close()};return n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2",onClick:t,disabled:e.length===0,children:[n.jsx(Gv,{className:"h-4 w-4"}),"Imprimir Romaneios (",e.length,")"]})}function yy(e){const t=e.replace(/\D/g,"").slice(0,11);return t.length===0?"":t.length<=3?t:t.length<=6?`${t.slice(0,3)}.${t.slice(3)}`:t.length<=9?`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6)}`:`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6,9)}-${t.slice(9)}`}function FR(e){if(e.paid_at)return!0;const t=e.status.toLowerCase().trim();return["pago","paid","approved","payment_approved"].includes(t)}function u1e(e){if(e.paid_at)return!1;const t=e.status.toLowerCase().trim();return t==="pendente"||t==="aguardando_pagamento"||t==="pagamento_rejeitado"||t==="pending"}function zR(e){return!!e.me_label_url||!!e.tracking_code||e.shipping_status==="etiqueta_gerada"}function h1e({order:e,variant:t="button",onLabelGenerated:r,onOrderUpdated:s}){const[a,i]=P.useState(!1),[o,l]=P.useState(!1),[d,c]=P.useState(!1),[u,h]=P.useState(""),[f,m]=P.useState(!1),[p,g]=P.useState(e.status),x=e.delivery_method==="shipping",v=!!e.me_label_url,y=zR(e),b=FR(e),j=u1e(e),T=v,O=e.address_snapshot,R=O&&O.zip_code&&(O.street||O.address_line)&&O.city&&O.state,D=((O==null?void 0:O.document)||(O==null?void 0:O.cpf)||"").replace(/\D/g,""),B=D.length===11,q=b&&x&&!y&&R,Y=q&&B,G=()=>{h(D),c(!0)},I=async()=>{const N=u.replace(/\D/g,"");if(N.length!==11){de.error("CPF deve ter 11 dgitos");return}m(!0);try{const C={...e.address_snapshot,document:N},{error:k}=await le.from("orders").update({address_snapshot:C,updated_at:new Date().toISOString()}).eq("id",e.id);if(k)throw k;if(e.customer_id){await le.from("customers").update({document:N}).eq("id",e.customer_id);const{data:M}=await le.from("customer_addresses").select("id").eq("customer_id",e.customer_id).eq("is_default",!0).maybeSingle();M&&await le.from("customer_addresses").update({document:N}).eq("id",M.id)}de.success("CPF salvo com sucesso!"),c(!1),s&&s({...e,address_snapshot:C})}catch(C){console.error("Error saving CPF:",C),de.error("Erro ao salvar CPF")}finally{m(!1)}},F=async()=>{if(!R){de.error("Endereo incompleto. Verifique CEP, rua, cidade e estado.");return}if(!B){G();return}l(!0)},S=async()=>{l(!1),i(!0),console.log("[ShippingLabel] Starting label generation",{orderId:e.id,currentStatus:e.status,normalizedStatus:e.status.toLowerCase().trim()});try{const{data:N,error:C}=await le.from("orders").select("id, status, paid_at, tracking_code, me_label_url, shipping_status").eq("id",e.id).single();if(C||!N){console.error("[ShippingLabel] Failed to refetch order:",C),de.error("Erro ao verificar status do pedido. Tente novamente.");return}if(console.log("[ShippingLabel] Refetched order:",{orderId:N.id,dbStatus:N.status,paid_at:N.paid_at,shipping_status:N.shipping_status,tracking_code:N.tracking_code,me_label_url:N.me_label_url}),g(N.status),zR(N)){de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Etiqueta j foi gerada"})}),n.jsx("p",{className:"text-sm",children:"Este pedido j possui uma etiqueta gerada."}),N.tracking_code&&n.jsxs("p",{className:"text-xs text-muted-foreground",children:["Rastreio: ",N.tracking_code]})]}),{duration:6e3});return}if(!FR(N)){de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Pedido ainda no est pago"})}),n.jsxs("p",{className:"text-sm",children:["Status atual: ",N.status]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:N.paid_at?`Pagamento registrado: ${new Date(N.paid_at).toLocaleString("pt-BR")}`:"Aguarde a confirmao do pagamento para gerar a etiqueta."})]}),{duration:6e3});return}const{data:M,error:U}=await le.functions.invoke("generate-order-shipping-label",{body:{orderId:e.id}});if(console.log("[ShippingLabel] Edge Function response:",{orderId:e.id,hasError:!!U,errorMessage:U==null?void 0:U.message,errorContext:U==null?void 0:U.context,data:M}),U){console.error("[ShippingLabel] Edge function invoke error:",U);let $=null;try{const X=U==null?void 0:U.context;X&&(typeof X.json=="function"?$=await X.json():X.body?$=X.body:typeof X=="object"&&($=X))}catch(X){console.error("[ShippingLabel] Failed to parse error context:",X)}if(console.log("[ShippingLabel] Extracted error body:",$),$!=null&&$.error){if($.action==="recharge_wallet"){de.error(n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{children:n.jsx("strong",{children:"Saldo insuficiente no Melhor Envio"})}),n.jsx("p",{className:"text-sm",children:$.details||"Recarregue a carteira e tente novamente."}),$.wallet_url&&n.jsx("a",{href:$.wallet_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline text-sm block",children:"Recarregar carteira "})]}),{duration:1e4});return}if($.missing_fields){de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Dados faltando para gerar etiqueta"})}),n.jsx("p",{className:"text-sm",children:$.missing_fields.join(", ")})]}));return}de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Erro ao gerar etiqueta"})}),n.jsx("p",{className:"text-sm",children:$.error||$.message}),$.details&&n.jsx("p",{className:"text-xs text-muted-foreground",children:$.details})]}),{duration:8e3});return}de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Erro ao gerar etiqueta"})}),n.jsx("p",{className:"text-sm",children:U.message||"Erro desconhecido"})]}),{duration:8e3});return}if(M!=null&&M.error){if(console.error("[ShippingLabel] Edge function error in response:",M),M.action==="recharge_wallet"){de.error(n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{children:n.jsx("strong",{children:"Saldo insuficiente no Melhor Envio"})}),n.jsx("p",{className:"text-sm",children:M.details}),n.jsx("a",{href:M.wallet_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline text-sm",children:"Recarregar carteira "})]}),{duration:1e4});return}if(M.missing_fields){de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Dados faltando para gerar etiqueta"})}),n.jsx("p",{className:"text-sm",children:M.missing_fields.join(", ")})]}));return}const $=M.status||M.statusCode||"Erro";de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsxs("strong",{children:["Erro ao gerar etiqueta (",$,")"]})}),n.jsx("p",{className:"text-sm",children:M.error||M.message||"Erro desconhecido"}),M.details&&n.jsx("p",{className:"text-xs text-muted-foreground",children:M.details})]}),{duration:8e3});return}(M!=null&&M.success||M!=null&&M.label_url)&&(de.success(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Etiqueta gerada com sucesso!"})}),M.tracking_code&&n.jsxs("p",{className:"text-sm",children:["Rastreio: ",M.tracking_code]})]})),r&&r(M.label_url,M.tracking_code),M.label_url&&window.open(M.label_url,"_blank"))}catch(N){console.error("[ShippingLabel] Unexpected error:",N),de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Erro inesperado"})}),n.jsx("p",{className:"text-sm",children:(N==null?void 0:N.message)||"Falha ao gerar etiqueta"})]}),{duration:8e3})}finally{i(!1)}},E=()=>{e.me_label_url&&window.open(e.me_label_url,"_blank")};return x?q?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex flex-col gap-2",children:[!B&&n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 border-amber-300 text-amber-700 hover:bg-amber-50",onClick:G,children:[n.jsx(Ql,{className:"h-4 w-4"}),"Cadastrar CPF para Etiqueta"]}),n.jsxs("span",{className:"text-xs text-amber-600 flex items-center gap-1",children:[n.jsx(Sn,{className:"h-3 w-3"}),"CPF obrigatrio para gerar etiqueta Correios"]})]}),n.jsx(he,{variant:t==="full"?"default":"outline",size:"sm",className:t==="full"?`gap-2 ${Y?"bg-orange-600 hover:bg-orange-700":"bg-muted text-muted-foreground cursor-not-allowed"}`:`gap-2 ${Y?"border-orange-300 text-orange-700 hover:bg-orange-50":"border-muted text-muted-foreground cursor-not-allowed"}`,onClick:N=>{N.stopPropagation(),Y&&F()},disabled:a||!Y,children:a?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 animate-spin"}),"Gerando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(yn,{className:"h-4 w-4"}),t==="full"?"Gerar Etiqueta (Melhor Envio)":"Gerar Etiqueta"]})}),B&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs text-green-600",children:["CPF: ",yy(D)]}),n.jsxs(he,{variant:"ghost",size:"sm",className:"h-5 px-1 text-xs text-muted-foreground hover:text-foreground",onClick:N=>{N.stopPropagation(),G()},children:[n.jsx(Ql,{className:"h-3 w-3 mr-1"}),"Editar"]})]})]}),n.jsx(_c,{open:o,onOpenChange:l,children:n.jsxs(Tl,{children:[n.jsxs(Pl,{children:[n.jsx(Ol,{children:"Gerar Etiqueta dos Correios?"}),n.jsxs(Rl,{className:"space-y-2",children:[n.jsx("p",{children:"Esta ao ir:"}),n.jsxs("ul",{className:"list-disc list-inside text-sm space-y-1",children:[n.jsx("li",{children:"Comprar a etiqueta no Melhor Envio (dbito na carteira)"}),n.jsx("li",{children:"Gerar o PDF oficial para postagem nos Correios"}),n.jsx("li",{children:'Atualizar o status do pedido para "Etiqueta Gerada"'})]}),n.jsxs("p",{className:"font-medium mt-2",children:["Destinatrio: ",e.customer_name,n.jsx("br",{}),"CPF: ",yy(D),n.jsx("br",{}),"CEP: ",O==null?void 0:O.zip_code]})]})]}),n.jsxs(jc,{children:[n.jsx(Sc,{children:"Cancelar"}),n.jsx(Nc,{onClick:S,className:"bg-orange-600 hover:bg-orange-700",children:"Confirmar e Gerar"})]})]})}),n.jsx(tn,{open:d,onOpenChange:c,children:n.jsxs(Jr,{className:"sm:max-w-md",children:[n.jsxs(ln,{children:[n.jsxs(rn,{children:[B?"Editar":"Cadastrar"," CPF do Destinatrio"]}),n.jsx(Vo,{children:"O CPF  obrigatrio para gerar etiquetas dos Correios via Melhor Envio."})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"cpf",children:"CPF (11 dgitos)"}),n.jsx(et,{id:"cpf",value:yy(u),onChange:N=>h(N.target.value.replace(/\D/g,"").slice(0,11)),placeholder:"000.000.000-00",maxLength:14}),u&&u.length>0&&u.length!==11&&n.jsxs("p",{className:"text-xs text-amber-600",children:["CPF deve ter 11 dgitos (",u.length,"/11)"]})]}),n.jsxs("div",{className:"bg-muted/50 rounded p-3 text-sm",children:[n.jsx("p",{className:"font-medium",children:"Destinatrio:"}),n.jsx("p",{children:e.customer_name}),n.jsxs("p",{className:"text-muted-foreground text-xs mt-1",children:[O==null?void 0:O.city,"/",O==null?void 0:O.state," - CEP ",O==null?void 0:O.zip_code]})]})]}),n.jsxs(ba,{children:[n.jsx(he,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),n.jsxs(he,{onClick:I,disabled:u.length!==11||f,className:"gap-2",children:[f?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):n.jsx(uu,{className:"h-4 w-4"}),"Salvar CPF"]})]})]})})]}):T?n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsxs(he,{variant:t==="full"?"default":"outline",size:"sm",className:t==="full"?"gap-2 bg-green-600 hover:bg-green-700":"gap-2 border-green-300 text-green-700 hover:bg-green-50",onClick:N=>{N.stopPropagation(),E()},children:[n.jsx(Zs,{className:"h-4 w-4"}),t==="full"?"Imprimir Etiqueta Correios":"Imprimir Etiqueta"]}),e.tracking_code&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["Rastreio: ",e.tracking_code]}),B&&n.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[n.jsx(Nl,{className:"h-3 w-3"}),n.jsxs("span",{children:["CPF: ",yy(D)]}),n.jsx("span",{className:"text-[10px] italic",children:"(no editvel aps etiqueta)"})]})]}):j?n.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-amber-50 border border-amber-200 rounded-lg",children:[n.jsx(Nl,{className:"h-4 w-4 text-amber-600"}),n.jsx("span",{className:"text-xs text-amber-700 font-medium",children:" Aguardando pagamento para liberar envio"})]}):y&&!v?n.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-green-50 border border-green-200 rounded-lg",children:[n.jsx(yn,{className:"h-4 w-4 text-green-600"}),n.jsxs("span",{className:"text-xs text-green-700 font-medium",children:[" Etiqueta j gerada ",e.tracking_code?` ${e.tracking_code}`:""]})]}):R?null:n.jsxs("span",{className:"text-xs text-red-500 flex items-center gap-1",children:[n.jsx(Sn,{className:"h-3 w-3"}),"Endereo incompleto"]}):null}const f1e={pendente:e=>`Oi, ${e.customerName}! 

Seu pedido #${e.shortId} foi recebido e est aguardando confirmao.

Qualquer dvida, estou por aqui! `,aguardando_pagamento:e=>`Oi, ${e.customerName}! 

Seu pedido #${e.shortId} est aguardando pagamento.

${e.total?`*Total:* ${e.total}

`:""}Assim que o pagamento for confirmado, j comeamos a preparar! `,pago:e=>`Oi, ${e.customerName}! 

Pagamento confirmado 

J vamos preparar seu pedido #${e.shortId} com muito carinho!

Qualquer coisa, estou por aqui! `,confirmado:e=>`Oi, ${e.customerName}! 

Seu pedido #${e.shortId} foi confirmado e est sendo preparado!

Em breve voc receber as atualizaes de envio. `,enviado:e=>`Oi, ${e.customerName}! 

Boa notcia! Seu pedido #${e.shortId} foi enviado!

${e.trackingCode?` *Cdigo de rastreio:* ${e.trackingCode}

Voc pode acompanhar pelo site dos Correios.`:"Em breve voc receber o cdigo de rastreio."}

Qualquer coisa, estou por aqui! `,entregue:e=>`Oi, ${e.customerName}! 

Seu pedido #${e.shortId} foi entregue! 

Esperamos que tenha gostado! Se puder, compartilha uma foto usando as peas - adoramos ver! 

Obrigada pela confiana! `,cancelado:e=>`Oi, ${e.customerName}.

Informamos que seu pedido #${e.shortId} foi cancelado.

Se precisar de algo ou tiver dvidas, estamos  disposio! `,pagamento_rejeitado:e=>`Oi, ${e.customerName}! 

Houve um problema com o pagamento do pedido #${e.shortId}.

Por favor, tente novamente ou entre em contato para resolvermos juntos! `,reembolsado:e=>`Oi, ${e.customerName}.

O reembolso do pedido #${e.shortId} foi processado.

O valor ser estornado conforme a poltica do seu mtodo de pagamento.

Se precisar de algo, estamos aqui! `};function Hf(e,t){const r=f1e[e];return r?r(t):`Oi, ${t.customerName}! Qualquer dvida sobre o pedido #${t.shortId}, estou  disposio! `}function Gf(e){return e.slice(0,8).toUpperCase()}function Os(e){const t=new URLSearchParams;return t.set("tab","orders"),e.status&&t.set("status",e.status),e.source&&t.set("source",e.source),e.seller&&t.set("seller",e.seller),e.specialFilter&&t.set("filter",e.specialFilter),e.startDate&&t.set("from",e.startDate),e.endDate&&t.set("to",e.endDate),`/dashboard?${t.toString()}`}const Bs={pendencias:()=>Os({specialFilter:"pendencias"}),faturamentoPago:()=>Os({status:"pago"}),reservado:()=>Os({status:"aguardando_pagamento"}),conversao:()=>Os({specialFilter:"funil"}),pagos:()=>Os({status:"pago"}),pendentes:()=>Os({status:"aguardando_pagamento"}),cancelados:()=>Os({status:"cancelado"}),catalogPagos:()=>Os({source:"catalog",status:"pago"}),catalogPendentes:()=>Os({source:"catalog",status:"aguardando_pagamento"}),catalogAll:()=>Os({source:"catalog"}),livePagos:()=>Os({source:"live",status:"pago"}),livePendentes:()=>Os({source:"live",status:"aguardando_pagamento"}),liveAll:()=>Os({source:"live"}),aguardandoPagamento24h:()=>Os({specialFilter:"aguardando-24h"}),aguardandoRetorno24h:()=>Os({specialFilter:"aguardando-retorno"}),naoCobrado:()=>Os({specialFilter:"nao-cobrado"}),pagoSemLogistica:()=>Os({status:"pago",specialFilter:"sem-logistica"}),etiquetaPendente:()=>Os({specialFilter:"etiqueta-pendente"}),semVendedora:()=>Os({specialFilter:"sem-vendedora"}),urgente:()=>Os({specialFilter:"urgente"}),liveEventOrders:e=>Os({source:"live",specialFilter:`live-event:${e}`}),sellerOrders:e=>Os({seller:e})};function UR(e){const t=e.get("status")||"all",r=e.get("source")||"all",s=e.get("seller"),a=e.get("filter");let i=null;return a!=null&&a.startsWith("live-event:")&&(i=a.replace("live-event:","")),{status:t,source:r,seller:s,specialFilter:a,liveEventId:i}}function m1e(e){if(!e)return null;const t={pendencias:"Pendncias operacionais",funil:"Anlise de funil","aguardando-24h":"Aguardando pagamento +24h","aguardando-retorno":"Aguardando retorno +24h","nao-cobrado":"No cobrados","sem-logistica":"Pagos sem logstica definida","etiqueta-pendente":"Etiqueta pendente","sem-vendedora":"Sem vendedora atribuda",urgente:"Urgentes"};return e.startsWith("live-event:")?"Pedidos da Live":t[e]||null}function VR(e){return e!==null&&["pendencias","aguardando-24h","aguardando-retorno","nao-cobrado","sem-logistica","etiqueta-pendente","sem-vendedora","urgente"].includes(e)}const p1e=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"],g1e=["postado","em_rota","retirada","entregue"];async function wC(e={}){const t=new Date;let r=le.from("orders").select("*").neq("status","cancelado");e.startDate&&(r=r.gte("created_at",e.startDate.toISOString())),e.endDate&&(r=r.lte("created_at",e.endDate.toISOString())),e.liveEventId&&(r=r.eq("live_event_id",e.liveEventId)),e.sellerId&&(r=r.eq("seller_id",e.sellerId));const{data:s,error:a}=await r;a&&console.error("[getOperationalPendingOrders] Orders Error:",a);let i=le.from("live_carts").select("*, live_customer:live_customers(nome, instagram_handle, whatsapp)").is("order_id",null).neq("status","cancelado").neq("status","expirado");e.liveEventId&&(i=i.eq("live_event_id",e.liveEventId)),e.sellerId&&(i=i.eq("seller_id",e.sellerId));const{data:o,error:l}=await i;if(l&&console.error("[getOperationalPendingOrders] LiveCarts Error:",l),a&&l)return{summary:[],allOrders:[],debug:"Error fetching orders and live carts"};const d=[],c=new Map,u=(m,p,g)=>({type:m,title:p,count:0,value:0,severity:g,orders:[]});c.set("aguardando_pagamento_24h",u("aguardando_pagamento_24h","Aguardando pagamento >24h","error")),c.set("aguardando_retorno_24h",u("aguardando_retorno_24h","Aguardando retorno >24h","error")),c.set("nao_cobrado",u("nao_cobrado","No cobrados / Live aberta","info")),c.set("pago_sem_logistica",u("pago_sem_logistica","Pagos sem logstica >12h","warning")),c.set("etiqueta_pendente",u("etiqueta_pendente","Etiqueta gerada sem postagem >24h","warning")),c.set("sem_vendedora",u("sem_vendedora","Pedidos sem vendedora","info")),c.set("urgente",u("urgente","Pedidos urgentes/em rota","error")),(s||[]).forEach(m=>{const p=new Date(m.created_at),g=new Date(m.updated_at),x=Math.round((t.getTime()-g.getTime())/(1e3*60*60)),v=Math.round((t.getTime()-p.getTime())/(1e3*60*60)),y={id:m.id,customer_name:m.customer_name,customer_phone:m.customer_phone,total:m.total||0,status:m.status,created_at:m.created_at,updated_at:m.updated_at,delivery_method:m.delivery_method,seller_id:m.seller_id,live_event_id:m.live_event_id,hoursStalled:x,customer_address:m.customer_address,address_snapshot:m.address_snapshot,tracking_code:m.tracking_code,type:"urgente"};if((m.status==="pendente"||m.status==="aguardando_pagamento")&&v>24){h("aguardando_pagamento_24h",y);return}if(m.status==="aguardando_retorno"&&x>24){h("aguardando_retorno_24h",y);return}if(p1e.slice(0,2).includes(m.status)&&m.delivery_method==="shipping"&&x>12){h("pago_sem_logistica",y);return}if(m.status==="etiqueta_gerada"&&x>24){h("etiqueta_pendente",y);return}if(!m.seller_id&&!g1e.includes(m.status)){h("sem_vendedora",y);return}if(m.status==="em_rota"&&x>8){h("urgente",y);return}}),(o||[]).forEach(m=>{var T,O,R,D;const p=new Date(m.created_at),g=new Date(m.updated_at),x=Math.round((t.getTime()-g.getTime())/(1e3*60*60)),v=Math.round((t.getTime()-p.getTime())/(1e3*60*60)),y=((T=m.live_customer)==null?void 0:T.nome)||((O=m.live_customer)==null?void 0:O.instagram_handle)||"Cliente Live",b=((R=m.live_customer)==null?void 0:R.whatsapp)||"",j={id:m.id,customer_name:y,customer_phone:b,total:m.total||0,status:m.operational_status||m.status,created_at:m.created_at,updated_at:m.updated_at,delivery_method:m.delivery_method,seller_id:m.seller_id,live_event_id:m.live_event_id,hoursStalled:x,isLiveCart:!0,customer_address:((D=m.shipping_address_snapshot)==null?void 0:D.full_address)||"Endereo da live",address_snapshot:m.shipping_address_snapshot,tracking_code:m.shipping_tracking_code,type:"nao_cobrado"};v>24?h("aguardando_pagamento_24h",j):h("nao_cobrado",j)});function h(m,p){const g={...p,type:m},x=c.get(m);x&&(x.count++,x.value+=p.total,x.orders.push(g)),d.push(g)}let f=Array.from(c.values()).filter(m=>m.count>0);return e.type&&(f=f.filter(m=>m.type===e.type)),{summary:f,allOrders:d,debug:`Fetched ${(s==null?void 0:s.length)||0} orders, ${(o==null?void 0:o.length)||0} carts.`}}const by={aberto:{label:"Sacola Aberta",icon:Lr,color:"bg-blue-50 text-blue-600 border-blue-200"},aguardando_retorno:{label:"Aguardando Retorno",icon:Lr,color:"bg-orange-50 text-orange-600 border-orange-200"},pendente:{label:"Pendente",icon:Lr,color:"bg-amber-100 text-amber-800"},aguardando_pagamento:{label:"Aguardando Pagamento",icon:ms,color:"bg-orange-100 text-orange-800"},pago:{label:"Pago",icon:Sr,color:"bg-green-100 text-green-800"},etiqueta_gerada:{label:"Etiqueta Gerada",icon:Kh,color:"bg-cyan-100 text-cyan-800"},confirmado:{label:"Confirmado",icon:Sr,color:"bg-blue-100 text-blue-800"},enviado:{label:"Enviado",icon:yn,color:"bg-purple-100 text-purple-800"},entregue:{label:"Entregue",icon:Sr,color:"bg-green-100 text-green-800"},cancelado:{label:"Cancelado",icon:sn,color:"bg-red-100 text-red-800"},pagamento_rejeitado:{label:"Pagamento Rejeitado",icon:sn,color:"bg-red-100 text-red-800"},reembolsado:{label:"Reembolsado",icon:Lr,color:"bg-gray-100 text-gray-800"},abandonado:{label:"Abandonado",icon:sn,color:"bg-gray-100 text-gray-400"},aguardando_pagamento_frete:{label:"Aguardando Pag. Frete",icon:ms,color:"bg-yellow-100 text-yellow-800"},aguardando_validacao_pagamento:{label:"Validar Pagamento",icon:s_,color:"bg-purple-100 text-purple-800 animate-pulse border-purple-300"}},qR=[{value:"aberto",label:"Sacola Aberta"},{value:"aguardando_retorno",label:"Aguardando Retorno"},{value:"pendente",label:"Pendente"},{value:"aguardando_pagamento",label:"Aguardando Pagamento"},{value:"pago",label:"Pago"},{value:"etiqueta_gerada",label:"Etiqueta Gerada"},{value:"confirmado",label:"Confirmado"},{value:"enviado",label:"Enviado"},{value:"entregue",label:"Entregue"},{value:"cancelado",label:"Cancelado"},{value:"pagamento_rejeitado",label:"Pagamento Rejeitado"},{value:"reembolsado",label:"Reembolsado"},{value:"aguardando_pagamento_frete",label:"Aguardando Pag. Frete"},{value:"aguardando_validacao_pagamento",label:"Validar Pagamento"}],x1e={"aguardando-24h":"aguardando_pagamento_24h","aguardando-retorno":"aguardando_retorno_24h","nao-cobrado":"nao_cobrado","sem-logistica":"pago_sem_logistica","etiqueta-pendente":"etiqueta_pendente","sem-vendedora":"sem_vendedora",urgente:"urgente"};function v1e({initialFilter:e}){var _t,Rt;const[t,r]=hd(),s=P.useMemo(()=>UR(t),[t]),[a,i]=P.useState([]),[o,l]=P.useState({}),[d,c]=P.useState(!0),[u,h]=P.useState(null),[f,m]=P.useState(()=>s.status!=="all"?s.status:_e(e)||"all"),[p,g]=P.useState(()=>s.source||"all"),[x,v]=P.useState(()=>s.seller),[y,b]=P.useState(()=>s.specialFilter),[j,T]=P.useState(new Set),[O,R]=P.useState(""),[D,B]=P.useState(null),[q,Y]=P.useState(""),[G,I]=P.useState(null),[F,S]=P.useState(""),[E,N]=P.useState(!1),[C,k]=P.useState(null),[M,U]=P.useState(!1),[$,X]=P.useState(null),[Z,re]=P.useState({}),[W,J]=P.useState({}),[V,H]=P.useState(null),[ee,ie]=P.useState(new Set),[oe,se]=P.useState(null),[ue,pe]=P.useState(""),{sellers:ce}=Dk(),ne=Se=>{ie(tt=>{const ot=new Set(tt);return ot.has(Se)?ot.delete(Se):ot.add(Se),ot})},me=()=>{ee.size===Ke.length?ie(new Set):ie(new Set(Ke.map(Se=>Se.id)))},ge=()=>Array.from(ee).map(Se=>{const tt=a.find(lt=>lt.id===Se),ot=o[Se]||[];return tt?{order:tt,items:ot}:null}).filter(Se=>Se!==null);function _e(Se){return Se?{aguardando:"aguardando_pagamento",pagos:"pago",separar:"pago",envio:"enviado",retirada:"pago",cancelado:"cancelado"}[Se]||Se:void 0}P.useEffect(()=>{const Se=UR(t);Se.status!=="all"&&m(Se.status),Se.source!=="all"&&g(Se.source),Se.seller&&v(Se.seller),Se.specialFilter&&b(Se.specialFilter)},[t]),P.useEffect(()=>{be()},[]),P.useEffect(()=>{y&&VR(y)?ye():T(new Set)},[y]);const be=async()=>{c(!0);try{const{data:Se,error:tt}=await le.from("orders").select(`
          *,
          live_event:live_events(titulo)
        `).order("created_at",{ascending:!1});if(tt)throw tt;const{data:ot,error:lt}=await le.from("live_carts").select(`
          *,
          live_customer:live_customers(*),
          live_event:live_events(titulo)
        `).is("order_id",null).neq("status","abandonado").order("created_at",{ascending:!1});lt&&console.error("Error fetching live carts:",lt);const At=(ot||[]).map(ut=>{var lr,Pt,Pe,Me;return{id:ut.id,created_at:ut.created_at,status:ut.operational_status||ut.status,total:ut.total,customer_name:((lr=ut.live_customer)==null?void 0:lr.nome)||((Pt=ut.live_customer)==null?void 0:Pt.instagram_handle)||"Cliente Live",customer_phone:((Pe=ut.live_customer)==null?void 0:Pe.whatsapp)||"",customer_address:((Me=ut.shipping_address_snapshot)==null?void 0:Me.full_address)||"Endereo no capturado",customer_id:ut.user_id||null,payment_link:null,tracking_code:ut.shipping_tracking_code||null,delivery_method:ut.delivery_method,live_event_id:ut.live_event_id,seller_id:ut.seller_id,internal_notes:null,mp_checkout_url:null,customer_notes:ut.customer_checkout_notes||ut.customer_live_notes,delivery_period:ut.delivery_period,last_whatsapp_status:null,last_whatsapp_sent_at:null,whatsapp_message_override:null,reserved_until:null,address_snapshot:ut.shipping_address_snapshot,me_shipment_id:ut.me_shipment_id,me_label_url:ut.me_label_url,paid_at:ut.paid_at,source:"live",live_cart_id:ut.id,live_bag_number:ut.bag_number,live_event:ut.live_event,requires_physical_cancel:!1}}),Nt=[...Se||[],...At].sort((ut,lr)=>new Date(lr.created_at).getTime()-new Date(ut.created_at).getTime());i(Nt)}catch(Se){console.error("Error loading orders:",Se),de.error("Erro ao carregar pedidos")}finally{c(!1)}},ye=async()=>{if(!y)return;if(y==="pendencias"){const lt=await wC({}),At=new Set(lt.allOrders.map(Nt=>Nt.id));T(At);return}const Se=x1e[y];if(!Se)return;const tt=await wC({type:Se}),ot=new Set(tt.allOrders.map(lt=>lt.id));T(ot)},Oe=()=>{m("all"),g("all"),v(null),b(null),R("");const Se=new URLSearchParams;Se.set("tab","orders"),r(Se)},Ne=async Se=>{if(o[Se])return;const{data:tt}=await le.from("order_items").select("*").eq("order_id",Se);tt&&l(ot=>({...ot,[Se]:tt}))},De=async(Se,tt)=>{const ot=a.find(Pe=>Pe.id===Se);if(!ot)return;const lt=tt.toLowerCase().trim(),At=["pago","paid","approved","payment_approved"].includes(lt),Nt={status:tt,updated_at:new Date().toISOString()};At&&!ot.paid_at&&(Nt.paid_at=new Date().toISOString());const{error:ut}=await le.from("orders").update(Nt).eq("id",Se);if(ut){de.error("Erro ao atualizar status");return}if(ot.source==="live"&&ot.live_cart_id){const Pe={operational_status:tt,updated_at:new Date().toISOString()};At?(Pe.status="pago",Pe.paid_at=Nt.paid_at):tt==="cancelado"&&(Pe.status="cancelado");const{error:Me}=await le.from("live_carts").update(Pe).eq("id",ot.live_cart_id);if(Me&&(console.error("Error syncing live_carts status:",Me),de.error("Status atualizado em Pedidos, mas erro ao sincronizar com Live")),At)try{const{data:it,error:gt}=await le.rpc("apply_live_cart_paid_effects",{p_live_cart_id:ot.live_cart_id});gt?(console.error("RPC Error (stock decrement):",gt),de.error("Erro ao baixar estoque da Live automaticamente")):(console.log("Live stock effects applied:",it),de.success("Estoque da Live atualizado!"))}catch(it){console.error("Catching RPC error:",it)}await le.from("live_cart_status_history").insert({live_cart_id:ot.live_cart_id,old_status:ot.status,new_status:tt,notes:"Atualizado via Gerenciador de Pedidos Geral"})}i(Pe=>Pe.map(Me=>Me.id===Se?{...Me,status:tt,paid_at:Nt.paid_at||Me.paid_at}:Me));const lr={customerName:ot.customer_name.split(" ")[0],shortId:Gf(Se),trackingCode:ot.tracking_code,total:vt(ot.total)},Pt=Hf(tt,lr);re(Pe=>({...Pe,[Se]:Pt})),J(Pe=>({...Pe,[Se]:!0})),de.success("Status atualizado  mensagem pronta para enviar!")},Ge=async(Se,tt)=>{const{error:ot}=await le.from("orders").update({seller_id:tt==="none"?null:tt}).eq("id",Se);if(ot){de.error("Erro ao atualizar vendedora");return}i(lt=>lt.map(At=>At.id===Se?{...At,seller_id:tt==="none"?null:tt}:At)),de.success("Vendedora atualizada")},Qe=Se=>{const tt=(Se.status||"").toLowerCase().trim();return["pago","paid","approved","payment_approved","etiqueta_gerada","enviado","entregue"].includes(tt)||!!Se.paid_at?{allowed:!1,reason:"No  possvel alterar entrega aps pagamento confirmado."}:Se.tracking_code||Se.me_label_url||Se.me_shipment_id?{allowed:!1,reason:"No  possvel alterar entrega com etiqueta/rastreio gerado."}:{allowed:!0}},Ie=async(Se,tt)=>{const ot=a.find(Nt=>Nt.id===Se);if(!ot)return;const lt=Qe(ot);if(!lt.allowed){de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Alterao bloqueada"})}),n.jsx("p",{className:"text-sm",children:lt.reason}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Coloque o pedido em ATENO para ajuste manual."})]}),{duration:6e3});return}const{error:At}=await le.from("orders").update({delivery_method:tt,updated_at:new Date().toISOString()}).eq("id",Se);if(At){de.error("Erro ao atualizar mtodo de entrega");return}i(Nt=>Nt.map(ut=>ut.id===Se?{...ut,delivery_method:tt}:ut)),se(null),de.success(`Mtodo de entrega alterado para ${Le(tt)}`)},Ae=async Se=>{const{error:tt}=await le.from("orders").update({internal_notes:F||null}).eq("id",Se);if(tt){de.error("Erro ao salvar observao");return}i(ot=>ot.map(lt=>lt.id===Se?{...lt,internal_notes:F||null}:lt)),I(null),de.success("Observao salva")},st=async Se=>{const{error:tt}=await le.from("orders").update({tracking_code:q||null}).eq("id",Se);if(tt){de.error("Erro ao salvar cdigo");return}i(ot=>ot.map(lt=>lt.id===Se?{...lt,tracking_code:q||null}:lt)),B(null),de.success("Cdigo de rastreio salvo")},nt=Se=>new Date(Se).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}),vt=Se=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Se),Je=Se=>Se.slice(0,8).toUpperCase(),Ue=Se=>{var tt;if(Se.source==="live"||Se.live_event_id){const ot=(tt=Se.live_event)!=null&&tt.titulo?`  ${Se.live_event.titulo}`:"",lt=Se.live_bag_number?`  Sacola #${Se.live_bag_number}`:"";return{label:"Live",icon:Ss,color:"bg-pink-100 text-pink-700",details:`${ot}${lt}`.replace(/^  /,"")}}return{label:"Loja Online",icon:fa,color:"bg-blue-100 text-blue-700",details:""}},Le=Se=>{switch(Se){case"motoboy":return"Motoboy";case"pickup":return"Retirada na loja";case"shipping":return"Correios";default:return"No definido"}},Ze=Se=>{if(!Se)return null;const tt=ce.find(ot=>ot.id===Se);return(tt==null?void 0:tt.name)||null},ct=Se=>{if(Se.status!=="aguardando_pagamento"||!Se.reserved_until)return null;const tt=new Date,lt=new Date(Se.reserved_until).getTime()-tt.getTime();if(lt<=0)return{expired:!0,text:"Expirado",minutesLeft:0};const At=Math.ceil(lt/(1e3*60)),Nt=Math.floor(At/60),ut=Math.floor(Nt/24);if(Se.source==="live"||Se.live_event_id){if(ut>=1){const Pt=Nt%24;return{expired:!1,text:Pt>0?`${ut}d ${Pt}h`:`${ut}d`,minutesLeft:At,urgent:ut<1}}else if(Nt>=1)return{expired:!1,text:`${Nt}h`,minutesLeft:At,urgent:Nt<6};return{expired:!1,text:`${At}min`,minutesLeft:At,urgent:!0}}return At<=5?{expired:!1,text:`${At}min`,minutesLeft:At,urgent:!0}:{expired:!1,text:`${At}min`,minutesLeft:At,urgent:!1}},ht=a.filter(Se=>Se.requires_physical_cancel).length,yt=f!=="all"||p!=="all"||x!==null||y!==null||O!=="",Re=m1e(y),Ke=P.useMemo(()=>a.filter(Se=>{if(y&&VR(y))return j.has(Se.id);const tt=f==="all"||f==="attention"&&Se.requires_physical_cancel||Se.status===f,ot=p==="all"||p==="live"&&(Se.source==="live"||Se.live_event_id)||p==="catalog"&&Se.source!=="live"&&!Se.live_event_id,lt=!x||Se.seller_id===x,At=O===""||Se.customer_name.toLowerCase().includes(O.toLowerCase())||Se.customer_phone.includes(O)||Se.id.toLowerCase().includes(O.toLowerCase())||Se.live_bag_number&&Se.live_bag_number.toString().includes(O);return tt&&ot&&lt&&At}),[a,f,p,x,y,j,O]);return d?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})}):n.jsxs("div",{className:"space-y-4",children:[yt&&n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[n.jsx(Ru,{className:"h-4 w-4"}),n.jsx("span",{children:"Filtros ativos:"})]}),Re&&n.jsxs(ke,{variant:"secondary",className:"gap-1",children:[Re,n.jsx("button",{onClick:()=>b(null),className:"ml-1 hover:text-destructive",children:n.jsx(Kn,{className:"h-3 w-3"})})]}),f!=="all"&&!y&&n.jsxs(ke,{variant:"secondary",className:"gap-1",children:["Status: ",((_t=by[f])==null?void 0:_t.label)||f,n.jsx("button",{onClick:()=>m("all"),className:"ml-1 hover:text-destructive",children:n.jsx(Kn,{className:"h-3 w-3"})})]}),p!=="all"&&n.jsxs(ke,{variant:"secondary",className:"gap-1",children:["Origem: ",p==="live"?"Live":"Catlogo",n.jsx("button",{onClick:()=>g("all"),className:"ml-1 hover:text-destructive",children:n.jsx(Kn,{className:"h-3 w-3"})})]}),x&&n.jsxs(ke,{variant:"secondary",className:"gap-1",children:["Vendedora: ",((Rt=ce.find(Se=>Se.id===x))==null?void 0:Rt.name)||x,n.jsx("button",{onClick:()=>v(null),className:"ml-1 hover:text-destructive",children:n.jsx(Kn,{className:"h-3 w-3"})})]}),n.jsx(he,{variant:"ghost",size:"sm",onClick:Oe,className:"h-6 text-xs",children:"Limpar todos"})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por nome, telefone ou n pedido...",value:O,onChange:Se=>R(Se.target.value),className:"pl-9"})]}),n.jsxs(Xt,{value:p,onValueChange:g,children:[n.jsx(Ht,{className:"w-full sm:w-[120px]",children:n.jsx(Yt,{placeholder:"Origem"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todas origens"}),n.jsx(qe,{value:"catalog",children:"Loja Online"}),n.jsx(qe,{value:"live",children:"Live"})]})]}),n.jsxs(Xt,{value:f,onValueChange:Se=>{m(Se),y&&b(null)},children:[n.jsx(Ht,{className:"w-full sm:w-[200px]",children:n.jsx(Yt,{placeholder:"Filtrar por status"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todos os status"}),ht>0&&n.jsxs(qe,{value:"attention",className:"text-amber-600",children:[" Requerem ateno (",ht,")"]}),qR.map(Se=>n.jsx(qe,{value:Se.value,children:Se.label},Se.value))]})]})]}),ee.size>0&&n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-primary/5 border border-primary/20 rounded-lg",children:[n.jsxs("span",{className:"text-sm font-medium",children:[ee.size," pedido",ee.size>1?"s":""," selecionado",ee.size>1?"s":""]}),n.jsx("div",{className:"flex-1"}),n.jsx(d1e,{orders:ge()}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>ie(new Set),children:"Limpar seleo"})]}),n.jsxs("div",{className:"bg-card rounded-xl border border-border overflow-hidden",children:[n.jsxs("div",{className:"hidden md:grid grid-cols-[32px_40px_80px_1fr_80px_minmax(160px,auto)_80px_90px] gap-3 px-4 py-3 bg-muted/40 border-b border-border text-sm font-medium text-muted-foreground",children:[n.jsx("div",{className:"flex items-center justify-center",children:n.jsx(Va,{checked:ee.size===Ke.length&&Ke.length>0,onCheckedChange:me})}),n.jsx("div",{}),n.jsx("div",{children:"Pedido"}),n.jsx("div",{children:"Cliente"}),n.jsx("div",{children:"Origem"}),n.jsx("div",{children:"Status"}),n.jsx("div",{className:"text-right",children:"Total"}),n.jsx("div",{className:"text-right",children:"Data"})]}),n.jsx("div",{className:"divide-y divide-border",children:Ke.map(Se=>{var Pt,Pe;const tt=by[Se.status]||by.pendente,ot=tt.icon,lt=Ue(Se),At=lt.icon,Nt=u===Se.id,ut=Ze(Se.seller_id),lr=ct(Se);return n.jsxs(pg,{open:Nt,onOpenChange:Me=>{h(Me?Se.id:null),Me&&Ne(Se.id)},children:[n.jsx(gg,{asChild:!0,children:n.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:[n.jsxs("div",{className:"hidden md:grid grid-cols-[32px_40px_80px_1fr_80px_minmax(160px,auto)_80px_90px] gap-3 px-4 py-3 items-center",children:[n.jsx("div",{className:"flex items-center justify-center",onClick:Me=>Me.stopPropagation(),children:n.jsx(Va,{checked:ee.has(Se.id),onCheckedChange:()=>{ne(Se.id),Ne(Se.id)}})}),n.jsx("div",{children:n.jsx(zo,{className:`h-4 w-4 text-muted-foreground transition-transform ${Nt?"rotate-180":""}`})}),n.jsxs("div",{className:"font-mono text-xs text-muted-foreground",children:["#",Je(Se.id)]}),n.jsxs("div",{className:"min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("p",{className:"font-medium truncate text-sm",children:Se.customer_name}),ut&&n.jsxs(ke,{variant:"outline",className:"text-[10px] shrink-0 px-1.5 py-0",children:[n.jsx(Dn,{className:"h-2.5 w-2.5 mr-0.5"}),ut]})]}),n.jsx("p",{className:"text-xs text-muted-foreground truncate",children:Se.customer_phone})]}),n.jsxs("div",{className:"flex flex-col gap-0.5 items-start",children:[n.jsxs(ke,{className:`${lt.color} border-0 gap-1 text-[10px] px-1.5`,children:[n.jsx(At,{className:"h-2.5 w-2.5"}),lt.label]}),lt.details&&n.jsx("span",{className:"text-[9px] text-muted-foreground truncate max-w-[100px]",title:lt.details,children:lt.details})]}),n.jsxs("div",{className:"flex flex-col gap-1 items-start",children:[n.jsxs(ke,{className:`${tt.color} border-0 gap-1 text-xs`,children:[n.jsx(ot,{className:"h-3 w-3"}),tt.label]}),lr&&n.jsxs(ke,{className:`border-0 gap-1 text-[10px] px-1.5 py-0 ${lr.expired?"bg-destructive text-destructive-foreground":lr.urgent?"bg-amber-100 text-amber-700 animate-pulse-soft":"bg-secondary text-muted-foreground"}`,children:[n.jsx(kS,{className:"h-2.5 w-2.5"}),lr.expired?"Reserva expirada":`Reserva: ${lr.text}`]}),Se.requires_physical_cancel&&n.jsxs(ke,{className:"border-0 gap-1 text-[10px] px-1.5 py-0 bg-orange-100 text-orange-700 animate-pulse",children:[n.jsx(Sn,{className:"h-2.5 w-2.5"}),"Cancelar sacola fsica"]})]}),n.jsx("div",{className:"text-right font-semibold tabular-nums text-sm",children:vt(Se.total)}),n.jsx("div",{className:"text-right text-xs text-muted-foreground whitespace-nowrap",children:nt(Se.created_at)})]}),n.jsxs("div",{className:"md:hidden p-3",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(zo,{className:`h-4 w-4 text-muted-foreground transition-transform shrink-0 ${Nt?"rotate-180":""}`}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:Se.customer_name}),n.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["#",Je(Se.id),"  ",nt(Se.created_at)]})]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("p",{className:"font-semibold text-sm tabular-nums",children:vt(Se.total)}),n.jsx(ke,{className:`${lt.color} border-0 text-[10px] px-1.5 mt-1`,children:lt.label})]})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 ml-6",children:[n.jsxs(ke,{className:`${tt.color} border-0 gap-1 text-xs`,children:[n.jsx(ot,{className:"h-3 w-3"}),tt.label]}),lr&&n.jsxs(ke,{className:`border-0 gap-1 text-[10px] px-1.5 ${lr.expired?"bg-destructive text-destructive-foreground":lr.urgent?"bg-amber-100 text-amber-700 animate-pulse-soft":"bg-secondary text-muted-foreground"}`,children:[n.jsx(kS,{className:"h-2.5 w-2.5"}),lr.expired?"Expirada":lr.text]}),Se.requires_physical_cancel&&n.jsxs(ke,{className:"border-0 gap-1 text-[10px] px-1.5 bg-orange-100 text-orange-700 animate-pulse",children:[n.jsx(Sn,{className:"h-2.5 w-2.5"}),"Cancelar sacola"]}),ut&&n.jsxs(ke,{variant:"outline",className:"text-[10px] px-1.5 py-0",children:[n.jsx(Dn,{className:"h-2.5 w-2.5 mr-0.5"}),ut]})]})]})]})}),n.jsx(xg,{children:n.jsxs("div",{className:"px-4 py-4 bg-muted/20 border-t border-border",children:[Se.requires_physical_cancel&&n.jsxs(of,{className:"mb-4 border-orange-200 bg-orange-50",children:[n.jsx(Sn,{className:"h-4 w-4 text-orange-600"}),n.jsxs(lf,{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-orange-700",children:[n.jsx("strong",{children:" Ateno:"})," Reserva expirada.  necessrio cancelar a sacola fsica da Live.",Se.live_bag_number&&` (Sacola #${Se.live_bag_number})`]}),n.jsx(he,{variant:"outline",size:"sm",className:"ml-2 border-orange-300 text-orange-700 hover:bg-orange-100",onClick:async Me=>{Me.stopPropagation();const{error:it}=await le.from("orders").update({requires_physical_cancel:!1,attention_reason:null,attention_at:null}).eq("id",Se.id);if(it){de.error("Erro ao resolver ateno");return}i(gt=>gt.map(dt=>dt.id===Se.id?{...dt,requires_physical_cancel:!1,attention_reason:null,attention_at:null}:dt)),de.success("Ateno resolvida!")},children:" Marcar como resolvido"})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-3 text-sm",children:"Itens do pedido"}),n.jsx("div",{className:"space-y-2",children:((Pt=o[Se.id])==null?void 0:Pt.map(Me=>n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background rounded-lg",children:[Me.image_url?n.jsx("img",{src:Me.image_url,alt:Me.product_name,className:"w-10 h-10 object-cover rounded"}):n.jsx("div",{className:"w-10 h-10 bg-secondary rounded flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:Me.product_name}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[Me.size,Me.color&&`  ${Me.color}`,"  x",Me.quantity]})]}),n.jsx("span",{className:"text-sm font-medium",children:vt(Me.product_price*Me.quantity)})]},Me.id)))||n.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando..."})}),n.jsx(Ca,{className:"my-4"}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-muted-foreground",children:"Entrega: "}),oe===Se.id?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Xt,{value:ue||Se.delivery_method||"",onValueChange:Me=>pe(Me),children:[n.jsx(Ht,{className:"h-7 w-[140px] text-xs",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"pickup",children:"Retirada na loja"}),n.jsx(qe,{value:"motoboy",children:"Motoboy"}),n.jsx(qe,{value:"shipping",children:"Correios"})]})]}),n.jsx(he,{size:"sm",className:"h-7 px-2",onClick:()=>Ie(Se.id,ue||Se.delivery_method||""),disabled:!ue||ue===Se.delivery_method,children:n.jsx(uu,{className:"h-3 w-3"})}),n.jsx(he,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:()=>{se(null),pe("")},children:n.jsx(sn,{className:"h-3 w-3"})})]}):n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"font-medium",children:Le(Se.delivery_method)}),Qe(Se).allowed?n.jsxs(he,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs gap-1 text-muted-foreground hover:text-foreground",onClick:it=>{it.stopPropagation(),se(Se.id),pe(Se.delivery_method||"")},children:[n.jsx(Ql,{className:"h-3 w-3"}),"Alterar"]}):n.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1 ml-2",children:[n.jsx(Nl,{className:"h-3 w-3"}),"Bloqueado"]})]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Endereo: "}),n.jsx("span",{children:Se.customer_address})]}),Se.delivery_method==="shipping"&&n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"CPF: "}),(()=>{var it,gt;const Me=(((it=Se.address_snapshot)==null?void 0:it.document)||((gt=Se.address_snapshot)==null?void 0:gt.cpf)||"").replace(/\D/g,"");return Me.length===11?n.jsx("span",{className:"font-medium text-green-700",children:Me.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4")}):n.jsx("span",{className:"text-amber-600 font-medium",children:"No cadastrado"})})()]}),Se.delivery_method==="shipping"&&(Se.tracking_code||Se.me_label_url||Se.status==="etiqueta_gerada")&&n.jsx("div",{className:"mt-2 pt-2 border-t border-dashed border-border",children:(gt=>{if(!gt||gt.startsWith("ORD-")||gt.startsWith("ORD"))return!1;const dt=/^[A-Z]{2}\d{9}BR$/.test(gt),It=/^\d{8,20}$/.test(gt);return dt||It})(Se.tracking_code)?n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsx("span",{className:"text-muted-foreground",children:"Rastreio:"}),n.jsx(ke,{variant:"outline",className:"font-mono text-xs bg-purple-50 text-purple-700 border-purple-200",children:Se.tracking_code}),n.jsxs(he,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs gap-1",onClick:async gt=>{gt.stopPropagation(),await af(Se.tracking_code)?de.success("Cdigo de rastreio copiado!"):de.error("Erro ao copiar")},children:[n.jsx(Wa,{className:"h-3 w-3"}),"Copiar"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs gap-1",onClick:gt=>{gt.stopPropagation(),window.open(`https://www.correios.com.br/rastreamento?objetos=${Se.tracking_code}`,"_blank")},children:[n.jsx(yn,{className:"h-3 w-3"}),"Acompanhar"]}),n.jsx(he,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs gap-1 text-muted-foreground",onClick:gt=>{gt.stopPropagation(),B(Se.id),Y(Se.tracking_code||"")},children:n.jsx(Ql,{className:"h-3 w-3"})})]}):n.jsx("div",{className:"space-y-2",children:D===Se.id?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(et,{value:q,onChange:gt=>Y(gt.target.value.toUpperCase()),placeholder:"Ex: AB123456789BR",className:"h-8 text-sm font-mono flex-1 max-w-[200px]",onClick:gt=>gt.stopPropagation()}),n.jsx(he,{size:"sm",className:"h-8",onClick:async gt=>{gt.stopPropagation(),await st(Se.id)},children:n.jsx(uu,{className:"h-3 w-3"})}),n.jsx(he,{size:"sm",variant:"ghost",className:"h-8",onClick:gt=>{gt.stopPropagation(),B(null)},children:n.jsx(sn,{className:"h-3 w-3"})})]}):n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsxs("div",{className:"flex items-center gap-1 text-amber-600",children:[n.jsx(Sn,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs",children:"Rastreio no encontrado"})]}),Se.me_shipment_id&&n.jsxs(he,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs gap-1",onClick:async gt=>{gt.stopPropagation(),de.loading("Sincronizando rastreio...",{id:`sync-${Se.id}`});try{const{data:dt,error:It}=await le.functions.invoke("sync-order-tracking",{body:{orderId:Se.id}});It||dt!=null&&dt.error?de.error((dt==null?void 0:dt.error)||"Erro ao sincronizar",{id:`sync-${Se.id}`}):dt!=null&&dt.tracking_code?(de.success(`Rastreio sincronizado: ${dt.tracking_code}`,{id:`sync-${Se.id}`}),be()):de.error("Rastreio ainda no disponvel",{id:`sync-${Se.id}`})}catch{de.error("Erro ao sincronizar rastreio",{id:`sync-${Se.id}`})}},children:[n.jsx(Qr,{className:"h-3 w-3"}),"Sincronizar"]}),(Se.me_label_url||Se.status==="etiqueta_gerada")&&n.jsxs(he,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs gap-1",onClick:gt=>{gt.stopPropagation(),B(Se.id),Y(Se.tracking_code||"")},children:[n.jsx(Ql,{className:"h-3 w-3"}),"Editar rastreio"]})]})})})]}),n.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-dashed border-border",children:[n.jsx(c1e,{order:Se,items:o[Se.id]||[]}),n.jsx(h1e,{order:Se,onLabelGenerated:(Me,it)=>{i(gt=>gt.map(dt=>dt.id===Se.id?{...dt,me_label_url:Me,tracking_code:it,shipping_status:"etiqueta_gerada",shipping_label_generated_at:new Date().toISOString()}:dt))},onOrderUpdated:Me=>{i(it=>it.map(gt=>gt.id===Me.id?{...gt,address_snapshot:Me.address_snapshot}:gt))}})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Alterar status"}),n.jsxs(Xt,{value:Se.status,onValueChange:Me=>De(Se.id,Me),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsx(Gt,{children:qR.map(Me=>n.jsx(qe,{value:Me.value,children:Me.label},Me.value))})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"text-sm font-medium mb-2 block flex items-center gap-2",children:[n.jsx(Dn,{className:"h-4 w-4"}),"Vendedora responsvel"]}),n.jsxs(Xt,{value:Se.seller_id||"none",onValueChange:Me=>Ge(Se.id,Me),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecionar vendedora"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"none",children:"Nenhuma"}),ce.map(Me=>n.jsx(qe,{value:Me.id,children:Me.name},Me.id))]})]})]}),Se.customer_notes&&n.jsxs("div",{children:[n.jsxs("label",{className:"text-sm font-medium mb-2 block flex items-center gap-2",children:[n.jsx(nn,{className:"h-4 w-4 text-blue-500"}),"Observao do cliente"]}),n.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[Se.customer_notes,Se.delivery_period&&n.jsxs("p",{className:"mt-2 text-xs text-blue-600",children:["Perodo preferido: ",Se.delivery_period==="manha"?"Manh":Se.delivery_period==="tarde"?"Tarde":"Qualquer horrio"]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"text-sm font-medium mb-2 block flex items-center gap-2",children:[n.jsx(fse,{className:"h-4 w-4"}),"Observao interna"]}),G===Se.id?n.jsxs("div",{className:"space-y-2",children:[n.jsx(rs,{placeholder:"Ex: Cliente vai passar na loja dia 30/01 para experimentar...",value:F,onChange:Me=>S(Me.target.value),rows:3}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{size:"sm",onClick:()=>Ae(Se.id),children:[n.jsx(uu,{className:"h-4 w-4 mr-1"}),"Salvar"]}),n.jsx(he,{size:"sm",variant:"ghost",onClick:()=>I(null),children:"Cancelar"})]})]}):n.jsxs("div",{className:"flex items-start gap-2",children:[Se.internal_notes?n.jsx("div",{className:"flex-1 p-3 bg-amber-50 border border-amber-200 rounded-lg text-sm",children:Se.internal_notes}):n.jsx("span",{className:"text-sm text-muted-foreground italic",children:"Sem observaes"}),n.jsx(he,{size:"sm",variant:"ghost",onClick:()=>{S(Se.internal_notes||""),I(Se.id)},children:n.jsx(Ql,{className:"h-4 w-4"})})]})]}),Se.status==="enviado"&&n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Cdigo de rastreio"}),D===Se.id?n.jsxs("div",{className:"flex gap-2",children:[n.jsx(et,{placeholder:"Ex: BR123456789BR",value:q,onChange:Me=>Y(Me.target.value)}),n.jsx(he,{size:"sm",onClick:()=>st(Se.id),children:"Salvar"}),n.jsx(he,{size:"sm",variant:"ghost",onClick:()=>B(null),children:"Cancelar"})]}):n.jsx("div",{className:"flex items-center gap-2",children:Se.tracking_code?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"font-mono",children:Se.tracking_code}),n.jsx(he,{size:"sm",variant:"ghost",onClick:()=>{Y(Se.tracking_code||""),B(Se.id)},children:"Editar"})]}):n.jsx(he,{size:"sm",variant:"outline",onClick:()=>{Y(""),B(Se.id)},children:"Adicionar cdigo"})})]}),(Se.status==="aguardando_pagamento"||Se.status==="pendente")&&n.jsxs(he,{variant:"outline",className:"w-full gap-2 border-amber-300 text-amber-700 hover:bg-amber-50",onClick:()=>{k(Se.id),N(!0)},children:[n.jsx(Qr,{className:"h-4 w-4"}),"Revalidar Pagamento MP"]}),Se.status==="aguardando_validacao_pagamento"&&n.jsxs(he,{className:"w-full gap-2 bg-purple-600 hover:bg-purple-700 animate-pulse",onClick:()=>{X(Se),U(!0)},children:[n.jsx(s_,{className:"h-4 w-4"}),"Validar Comprovante"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:"text-sm font-medium mb-2 block flex items-center gap-2",children:[n.jsx(nn,{className:"h-4 w-4 text-green-600"}),"Mensagem WhatsApp"]}),W[Se.id]&&n.jsxs(of,{className:"border-green-300 bg-green-50",children:[n.jsx(Sn,{className:"h-4 w-4 text-green-600"}),n.jsxs(lf,{className:"text-green-800",children:[n.jsx("strong",{children:"Mensagem atualizada!"}),' Clique em "Enviar WhatsApp" para notificar a cliente.']})]}),Se.last_whatsapp_sent_at&&n.jsxs("p",{className:"text-xs text-muted-foreground",children:["ltima notificao: ",new Date(Se.last_whatsapp_sent_at).toLocaleString("pt-BR"),Se.last_whatsapp_status&&` (${((Pe=by[Se.last_whatsapp_status])==null?void 0:Pe.label)||Se.last_whatsapp_status})`]}),V===Se.id?n.jsxs("div",{className:"space-y-2",children:[n.jsx(rs,{value:Z[Se.id]||Hf(Se.status,{customerName:Se.customer_name.split(" ")[0],shortId:Gf(Se.id),trackingCode:Se.tracking_code,total:vt(Se.total)}),onChange:Me=>re(it=>({...it,[Se.id]:Me.target.value})),rows:5,className:"text-sm"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{size:"sm",variant:"ghost",onClick:()=>H(null),children:"Fechar editor"}),n.jsx(he,{size:"sm",variant:"outline",onClick:()=>{const Me=Hf(Se.status,{customerName:Se.customer_name.split(" ")[0],shortId:Gf(Se.id),trackingCode:Se.tracking_code,total:vt(Se.total)});re(it=>({...it,[Se.id]:Me}))},children:"Resetar para template"})]})]}):n.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg text-sm cursor-pointer hover:bg-muted transition-colors",onClick:()=>H(Se.id),children:[n.jsx("p",{className:"whitespace-pre-wrap line-clamp-3",children:Z[Se.id]||Hf(Se.status,{customerName:Se.customer_name.split(" ")[0],shortId:Gf(Se.id),trackingCode:Se.tracking_code,total:vt(Se.total)})}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Clique para editar"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{variant:"outline",className:"flex-1 gap-2",onClick:async()=>{const Me=Z[Se.id]||Hf(Se.status,{customerName:Se.customer_name.split(" ")[0],shortId:Gf(Se.id),trackingCode:Se.tracking_code,total:vt(Se.total)});await af(Me),de.success("Mensagem copiada!")},children:[n.jsx(Wa,{className:"h-4 w-4"}),"Copiar msg"]}),n.jsxs(he,{className:`flex-1 gap-2 ${W[Se.id]?"bg-green-600 hover:bg-green-700 animate-pulse":"btn-whatsapp"}`,onClick:async()=>{const Me=Z[Se.id]||Hf(Se.status,{customerName:Se.customer_name.split(" ")[0],shortId:Gf(Se.id),trackingCode:Se.tracking_code,total:vt(Se.total)}),it=Se.customer_phone.replace(/\D/g,""),dt=`https://wa.me/${it.startsWith("55")?it:`55${it}`}?text=${encodeURIComponent(Me)}`;window.open(dt,"_blank","noopener,noreferrer"),await le.from("orders").update({last_whatsapp_status:Se.status,last_whatsapp_sent_at:new Date().toISOString(),whatsapp_message_override:Z[Se.id]||null}).eq("id",Se.id),i(It=>It.map(xr=>xr.id===Se.id?{...xr,last_whatsapp_status:Se.status,last_whatsapp_sent_at:new Date().toISOString()}:xr)),J(It=>({...It,[Se.id]:!1})),de.success("WhatsApp aberto  notificao registrada!")},children:[n.jsx(yf,{className:"h-4 w-4"}),W[Se.id]?"Enviar Agora!":"Enviar WhatsApp"]})]})]})]})]})]})})]},Se.id)})}),Ke.length===0&&n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:a.length===0?"Nenhum pedido ainda.":"Nenhum pedido encontrado com os filtros aplicados."})]}),n.jsx(BW,{open:E,onClose:()=>{N(!1),k(null)},onSuccess:be,orderId:C||void 0}),n.jsx(axe,{isOpen:M,onClose:()=>{U(!1),X(null)},order:$,onSuccess:be})]})}function y1e({customer:e,onOpenCatalog:t}){const r=pr(),s=[e.name,e.phone,e.email,e.size_letter||e.size_number,e.address_line,e.city,e.zip_code],a=s.filter(Boolean).length,i=Math.round(a/s.length*100),o=i===100,l=m=>{const p=m.replace(/\D/g,"");return p.length===11?`(${p.slice(0,2)}) ${p.slice(2,7)}-${p.slice(7)}`:p.length===13&&p.startsWith("55")?`(${p.slice(2,4)}) ${p.slice(4,9)}-${p.slice(9)}`:m},d=m=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(m),c=m=>m?new Date(m).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit"}):null,u=()=>{var m;return e.name?e.name.split(" ").map(p=>p[0]).join("").slice(0,2).toUpperCase():((m=e.phone)==null?void 0:m.slice(-2))||"?"},h=e.phone.replace(/\D/g,""),f=`https://wa.me/${h.startsWith("55")?h:`55${h}`}`;return n.jsx($e,{className:"hover:shadow-md transition-shadow",children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:n.jsx("span",{className:"text-sm font-semibold text-primary",children:u()})}),n.jsx("div",{className:"flex-1 min-w-0",children:n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-sm line-clamp-1",children:e.name||"Sem nome"}),n.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground text-xs mt-0.5",children:[n.jsx(kl,{className:"h-3 w-3"}),n.jsx("span",{children:l(e.phone)})]})]}),o?n.jsxs(ke,{variant:"default",className:"bg-emerald-500 text-xs gap-0.5 flex-shrink-0",children:[n.jsx(gn,{className:"h-3 w-3"}),"Completo"]}):n.jsxs(ke,{variant:"outline",className:"text-amber-600 border-amber-300 text-xs gap-0.5 flex-shrink-0",children:[n.jsx(Sn,{className:"h-3 w-3"}),i,"%"]})]})})]}),n.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3",children:[e.style_title&&n.jsxs(ke,{variant:"secondary",className:"gap-1 text-xs",children:[n.jsx(Gr,{className:"h-3 w-3"}),e.style_title]}),(e.size_letter||e.size_number)&&n.jsx(ke,{variant:"outline",className:"text-xs",children:[e.size_letter,e.size_number].filter(Boolean).join(" / ")})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3 text-xs",children:[n.jsxs("div",{className:"bg-secondary/50 rounded-lg p-2 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1 text-muted-foreground mb-0.5",children:[n.jsx(hn,{className:"h-3 w-3"}),n.jsx("span",{children:"Pedidos"})]}),n.jsx("p",{className:"font-semibold",children:e.total_orders||0})]}),n.jsxs("div",{className:"bg-secondary/50 rounded-lg p-2 text-center col-span-2",children:[n.jsx("div",{className:"text-muted-foreground mb-0.5",children:"Total gasto"}),n.jsx("p",{className:"font-semibold text-primary",children:e.total_spent>0?d(e.total_spent):""})]})]}),e.last_order_at&&n.jsxs("p",{className:"text-xs text-muted-foreground mb-3",children:["ltima compra: ",c(e.last_order_at)]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{size:"sm",variant:"default",className:"flex-1 bg-[#25D366] hover:bg-[#128C7E] text-white gap-1",asChild:!0,children:n.jsxs("a",{href:f,target:"_blank",rel:"noopener noreferrer",children:[n.jsx(nn,{className:"h-3.5 w-3.5"}),"WhatsApp"]})}),n.jsxs(he,{size:"sm",variant:"outline",className:"gap-1",onClick:()=>r(`/dashboard/clientes/${e.id}`),children:[n.jsx(ai,{className:"h-3.5 w-3.5"}),"Perfil"]}),n.jsxs(he,{size:"sm",variant:"outline",className:"gap-1",onClick:()=>t==null?void 0:t(e.id),children:[n.jsx(YF,{className:"h-3.5 w-3.5"}),"Catlogo"]})]})]})})}const b1e=[{value:"all",label:"Todos"},{value:"incomplete",label:"Cadastro incompleto"},{value:"has_orders",label:"J compraram"},{value:"no_orders",label:"Nunca compraram"},{value:"has_quiz",label:"Com quiz"},{value:"no_quiz",label:"Sem quiz"},{value:"recent",label:"ltimos 7 dias"}],w1e=[{value:"_all",label:"Todos tamanhos"},{value:"PP",label:"PP"},{value:"P",label:"P"},{value:"M",label:"M"},{value:"G",label:"G"},{value:"GG",label:"GG"},{value:"34",label:"34"},{value:"36",label:"36"},{value:"38",label:"38"},{value:"40",label:"40"},{value:"42",label:"42"},{value:"44",label:"44"},{value:"46",label:"46"}];function _1e({search:e,onSearchChange:t,filter:r,onFilterChange:s,styleFilter:a,onStyleFilterChange:i,sizeFilter:o,onSizeFilterChange:l,totalCount:d,filteredCount:c,availableStyles:u}){return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[n.jsxs("div",{className:"relative flex-1 max-w-md",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por nome, telefone ou estilo...",value:e,onChange:h=>t(h.target.value),className:"pl-9"})]}),n.jsxs(Xt,{value:a,onValueChange:i,children:[n.jsx(Ht,{className:"w-full sm:w-[180px]",children:n.jsx(Yt,{placeholder:"Estilo"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"_all",children:"Todos estilos"}),u.map(h=>n.jsx(qe,{value:h,children:h},h))]})]}),n.jsxs(Xt,{value:o,onValueChange:l,children:[n.jsx(Ht,{className:"w-full sm:w-[140px]",children:n.jsx(Yt,{placeholder:"Tamanho"})}),n.jsx(Gt,{children:w1e.map(h=>n.jsx(qe,{value:h.value,children:h.label},h.value))})]}),n.jsxs(ke,{variant:"secondary",className:"h-10 px-3 flex items-center gap-1 whitespace-nowrap",children:[c," / ",d," clientes"]})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:b1e.map(h=>n.jsx("button",{onClick:()=>s(h.value),className:`px-3 py-1.5 rounded-full text-sm transition-colors ${r===h.value?"bg-primary text-primary-foreground":"bg-secondary hover:bg-secondary/80 text-muted-foreground"}`,children:h.label},h.value))})]})}function eH({open:e,onClose:t,customerId:r,customerName:s,customerPhone:a,customerStyle:i,customerSizeLetter:o,customerSizeNumber:l,availableProducts:d}){const[c,u]=P.useState(`Catlogo da ${s||"Cliente"}`),[h,f]=P.useState(""),[m,p]=P.useState([]),[g,x]=P.useState(!1),[v,y]=P.useState(!1),[b,j]=P.useState(null),[T,O]=P.useState(!1),[R,D]=P.useState("_all"),[B,q]=P.useState("_all"),[Y,G]=P.useState("_all"),I=[o,l,"UN","nico"].filter(Boolean),[F,S]=P.useState("all"),E=["34","36","38","40","42","44","46","PP","P","M","G","GG","UN","nico"],N=[...new Set(d.flatMap(se=>{if(!se.stock_by_size)return[];const ue=se.stock_by_size;return Object.entries(ue).filter(([pe,ce])=>ce>0).map(([pe])=>pe)}))].sort((se,ue)=>{const pe=E.indexOf(se),ce=E.indexOf(ue);return pe===-1&&ce===-1?se.localeCompare(ue):pe===-1?1:ce===-1?-1:pe-ce}),C=[...new Set(d.filter(se=>se.category).map(se=>se.category))].sort(),k=[...new Set(d.filter(se=>se.color).map(se=>se.color))].sort(),M=d.filter(se=>{if(!se.stock_by_size)return!1;const ue=se.stock_by_size;return Object.values(ue).reduce((ce,ne)=>ce+ne,0)>0}),U=I.length>0?d.filter(se=>{if(!se.stock_by_size)return!1;const ue=se.stock_by_size;return I.some(pe=>{if(!pe)return!1;const ce=Object.keys(ue).find(ne=>ne.toLowerCase()===pe.toLowerCase());return ce&&ue[ce]>0})}):[],Z=(se=>se.filter(ue=>{if(B!=="_all"&&ue.category!==B||Y!=="_all"&&ue.color!==Y)return!1;if(R!=="_all"){if(!ue.stock_by_size)return!1;const pe=ue.stock_by_size,ce=Object.keys(pe).find(ne=>ne.toLowerCase()===R.toLowerCase());if(!ce||pe[ce]<=0)return!1}return!0}))(F==="suggested"?U:M);P.useEffect(()=>{e&&(u(`Catlogo da ${s||"Cliente"}`),re(),S(U.length>0?"suggested":"all"),D("_all"),q("_all"),G("_all"))},[e,s]);const re=async()=>{x(!0);const se=[o,l].filter(Boolean).join("/"),ue=[`${s||"Querida"}, montei esse provador pensando no seu estilo ${i?`${i} `:""}e no seu tamanho${se?` ${se}`:""}, com peas que vo te deixar ainda mais confiante e sofisticada. Me diz qual voc amou primeiro `,`Oi ${s||""}! Selecionei essas peas especialmente pra voc, todas no seu tamanho${se?` ${se}`:""} e com a sua cara${i?`, combinando com seu estilo ${i}`:""}. Qual delas te conquistou? `,`${s||"Linda"}, preparei uma seleo exclusiva pensando em voc! Peas que valorizam seu corpo${se?` (${se})`:""} e combinam perfeitamente com ${i?`seu estilo ${i}`:"seu estilo nico"}. Me conta sua favorita! `];f(ue[Math.floor(Math.random()*ue.length)]),x(!1)},W=se=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(se),J=se=>{if(se.images&&se.images.length>0){const ue=se.main_image_index||0;return se.images[ue]||se.images[0]}return se.image_url},V=se=>{m.find(ue=>ue.id===se.id)||p([...m,se]),O(!1)},H=se=>{p(m.filter(ue=>ue.id!==se))},ee=async()=>{if(m.length===0){de.error("Adicione pelo menos um produto ao catlogo");return}y(!0);try{const se=`catalogo-${r.slice(0,8)}-${Date.now()}`,{data:ue,error:pe}=await le.from("customer_catalogs").insert({customer_id:r,title:c,intro_text:h,products:m.map(ne=>({id:ne.id,name:ne.name,price:ne.price,image:J(ne),color:ne.color})),public_link:se}).select().single();if(pe)throw pe;const ce=`${window.location.origin}/c/${se}`;j(ce),de.success("Catlogo criado com sucesso!")}catch(se){console.error("Error saving catalog:",se),de.error("Erro ao salvar catlogo")}finally{y(!1)}},ie=()=>{b&&(navigator.clipboard.writeText(b),de.success("Link copiado!"))},oe=()=>{const se=a.replace(/\D/g,""),ue=se.startsWith("55")?se:`55${se}`,pe=encodeURIComponent(`${h}

 Veja seu catlogo personalizado:
${b}`);window.open(`https://wa.me/${ue}?text=${pe}`,"_blank")};return n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs(ln,{children:[n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(Gr,{className:"h-5 w-5 text-primary"}),"Montar Catlogo Personalizado"]}),n.jsxs(Vo,{children:["Selecione produtos para criar um catlogo exclusivo para ",s||"esta cliente","."]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Nome do catlogo"}),n.jsx(et,{value:c,onChange:se=>u(se.target.value),placeholder:"Catlogo da Cliente"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"text-sm font-medium",children:"Texto de abertura"}),n.jsxs(he,{variant:"ghost",size:"sm",onClick:re,disabled:g,children:[g?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):n.jsx(Gr,{className:"h-4 w-4"}),"Gerar novo"]})]}),n.jsx(rs,{value:h,onChange:se=>f(se.target.value),rows:4,placeholder:"Texto personalizado para a cliente..."})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("label",{className:"text-sm font-medium",children:["Produtos (",m.length,")"]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>O(!0),children:[n.jsx(kn,{className:"h-4 w-4 mr-1"}),"Adicionar"]})]}),m.length===0?n.jsxs("div",{className:"border border-dashed rounded-lg p-8 text-center text-muted-foreground",children:[n.jsx("p",{children:"Nenhum produto selecionado"}),n.jsx("p",{className:"text-sm",children:'Clique em "Adicionar" para incluir produtos'})]}):n.jsx("div",{className:"space-y-2",children:m.map((se,ue)=>n.jsxs("div",{className:"flex items-center gap-3 bg-secondary/50 rounded-lg p-2",children:[n.jsx(T6,{className:"h-4 w-4 text-muted-foreground cursor-grab"}),n.jsx("div",{className:"w-12 h-12 rounded overflow-hidden bg-secondary flex-shrink-0",children:J(se)?n.jsx("img",{src:J(se),alt:se.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:"?"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:se.name}),n.jsx("p",{className:"text-sm text-primary",children:W(se.price)})]}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>H(se.id),children:n.jsx(ui,{className:"h-4 w-4 text-muted-foreground"})})]},se.id))})]}),T&&n.jsxs("div",{className:"border rounded-lg p-4 bg-background",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"font-medium",children:"Selecionar produto"}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>O(!1),children:n.jsx(sn,{className:"h-4 w-4"})})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[n.jsxs(Xt,{value:R,onValueChange:D,children:[n.jsx(Ht,{className:"h-9",children:n.jsx(Yt,{placeholder:"Tamanho"})}),n.jsxs(Gt,{className:"bg-background z-50",children:[n.jsx(qe,{value:"_all",children:"Todos tam."}),N.map(se=>n.jsx(qe,{value:se,children:se},se))]})]}),n.jsxs(Xt,{value:B,onValueChange:q,children:[n.jsx(Ht,{className:"h-9",children:n.jsx(Yt,{placeholder:"Categoria"})}),n.jsxs(Gt,{className:"bg-background z-50",children:[n.jsx(qe,{value:"_all",children:"Todas cat."}),C.map(se=>n.jsx(qe,{value:se,children:se},se))]})]}),n.jsxs(Xt,{value:Y,onValueChange:G,children:[n.jsx(Ht,{className:"h-9",children:n.jsx(Yt,{placeholder:"Cor"})}),n.jsxs(Gt,{className:"bg-background z-50",children:[n.jsx(qe,{value:"_all",children:"Todas cores"}),k.map(se=>n.jsx(qe,{value:se,children:se},se))]})]})]}),n.jsx(Hi,{value:F,onValueChange:se=>S(se),className:"mb-3",children:n.jsxs(Si,{className:"grid w-full grid-cols-2",children:[n.jsxs(br,{value:"suggested",disabled:U.length===0,children:[n.jsx(Ru,{className:"h-3 w-3 mr-1"}),"Sugeridos (",U.length,")"]}),n.jsxs(br,{value:"all",children:["Todos (",M.length,")"]})]})}),n.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:[Z.filter(se=>!m.find(ue=>ue.id===se.id)).length," produtos encontrados"]}),Z.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx("p",{className:"text-sm",children:"Nenhum produto encontrado"}),(R!=="_all"||B!=="_all"||Y!=="_all")&&n.jsx(he,{variant:"link",size:"sm",onClick:()=>{D("_all"),q("_all"),G("_all")},className:"mt-2",children:"Limpar filtros"})]}):n.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-60 overflow-y-auto",children:Z.filter(se=>!m.find(ue=>ue.id===se.id)).map(se=>n.jsxs("button",{onClick:()=>V(se),className:"text-left p-2 rounded-lg hover:bg-secondary transition-colors",children:[n.jsx("div",{className:"aspect-square rounded overflow-hidden bg-secondary mb-1",children:J(se)?n.jsx("img",{src:J(se),alt:se.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:"?"})}),n.jsx("p",{className:"text-xs truncate",children:se.name}),n.jsx("p",{className:"text-xs text-primary",children:W(se.price)})]},se.id))})]}),b&&n.jsxs("div",{className:"border rounded-lg p-4 bg-emerald-50/50",children:[n.jsx("p",{className:"text-sm font-medium text-emerald-700 mb-2",children:" Catlogo criado!"}),n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(et,{value:b,readOnly:!0,className:"flex-1 text-sm"}),n.jsx(he,{variant:"outline",size:"icon",onClick:ie,children:n.jsx(Wa,{className:"h-4 w-4"})}),n.jsx(he,{variant:"outline",size:"icon",asChild:!0,children:n.jsx("a",{href:b,target:"_blank",rel:"noopener noreferrer",children:n.jsx(Zs,{className:"h-4 w-4"})})})]}),n.jsxs(he,{className:"w-full bg-[#25D366] hover:bg-[#128C7E] text-white",onClick:oe,children:[n.jsx(nn,{className:"h-4 w-4 mr-2"}),"Enviar no WhatsApp"]})]}),!b&&n.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[n.jsx(he,{variant:"outline",onClick:t,className:"flex-1",children:"Cancelar"}),n.jsxs(he,{onClick:ee,disabled:v||m.length===0,className:"flex-1",children:[v?n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}):n.jsx(Gr,{className:"h-4 w-4 mr-2"}),"Criar Catlogo"]})]})]})]})})}function j1e(){const[e,t]=P.useState([]),[r,s]=P.useState([]),[a,i]=P.useState(!0),[o,l]=P.useState(""),[d,c]=P.useState("all"),[u,h]=P.useState("_all"),[f,m]=P.useState("_all"),[p,g]=P.useState(!1),[x,v]=P.useState(null);P.useEffect(()=>{y()},[]);const y=async()=>{try{const[R,D]=await Promise.all([le.from("customers").select("*").order("last_order_at",{ascending:!1,nullsFirst:!1}),le.from("product_catalog").select("id, name, price, image_url, images, main_image_index, stock_by_size, color, category").eq("is_active",!0)]);if(R.error)throw R.error;if(D.error)throw D.error;const B=(R.data||[]).map(q=>({id:q.id,phone:q.phone,name:q.name,email:q.email,size:q.size,size_letter:q.size_letter,size_number:q.size_number,style_title:q.style_title,created_at:q.created_at,total_orders:q.total_orders||0,last_order_at:q.last_order_at,total_spent:Number(q.total_spent)||0,address_line:q.address_line,city:q.city,state:q.state,zip_code:q.zip_code,user_id:q.user_id,document:q.document}));B.sort((q,Y)=>q.last_order_at&&Y.last_order_at?new Date(Y.last_order_at).getTime()-new Date(q.last_order_at).getTime():q.last_order_at?-1:Y.last_order_at?1:new Date(Y.created_at).getTime()-new Date(q.created_at).getTime()),t(B),s(D.data||[])}catch(R){console.error("Error loading data:",R),de.error("Erro ao carregar dados")}finally{i(!1)}},b=[...new Set(e.map(R=>R.style_title).filter(Boolean))],j=R=>{const D=[R.name,R.phone,R.email,R.size_letter||R.size_number,R.address_line,R.city,R.zip_code];return D.filter(Boolean).length===D.length},T=e.filter(R=>{var Y,G,I,F,S;const D=o.toLowerCase();if(!(!o||((Y=R.name)==null?void 0:Y.toLowerCase().includes(D))||((G=R.phone)==null?void 0:G.includes(o))||((I=R.style_title)==null?void 0:I.toLowerCase().includes(D))||((F=R.email)==null?void 0:F.toLowerCase().includes(D))))return!1;const q=new Date;switch(q.setDate(q.getDate()-7),d){case"incomplete":if(j(R))return!1;break;case"has_orders":if(R.total_orders===0)return!1;break;case"no_orders":if(R.total_orders>0)return!1;break;case"has_quiz":if(!R.style_title)return!1;break;case"no_quiz":if(R.style_title)return!1;break;case"recent":const E=R.last_order_at||R.created_at;if(new Date(E)<q)return!1;break}return!(u!=="_all"&&R.style_title!==u||f!=="_all"&&!(((S=R.size_letter)==null?void 0:S.toLowerCase())===f.toLowerCase()||R.size_number===f))}),O=R=>{const D=e.find(B=>B.id===R);D&&(v(D),g(!0))};return a?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx(_1e,{search:o,onSearchChange:l,filter:d,onFilterChange:c,styleFilter:u,onStyleFilterChange:h,sizeFilter:f,onSizeFilterChange:m,totalCount:e.length,filteredCount:T.length,availableStyles:b}),T.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(Ha,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:o||d!=="all"||u!=="_all"||f!=="_all"?"Nenhum cliente encontrado com esses filtros":"Nenhum cliente cadastrado ainda"})]}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(R=>n.jsx(y1e,{customer:R,onOpenCatalog:O},R.id))}),x&&n.jsx(eH,{open:p,onClose:()=>{g(!1),v(null)},customerId:x.id,customerName:x.name,customerPhone:x.phone,customerStyle:x.style_title,customerSizeLetter:x.size_letter,customerSizeNumber:x.size_number,availableProducts:r})]})}function Wr({className:e,...t}){return n.jsx("div",{className:He("animate-pulse rounded-md bg-muted",e),...t})}function L_(){const[e,t]=P.useState([]),[r,s]=P.useState(!0),[a,i]=P.useState(null),o=P.useCallback(async()=>{s(!0);try{const{data:u,error:h}=await le.from("live_events").select("*").order("data_hora_inicio",{ascending:!1});if(h)throw h;const f=await Promise.all((u||[]).map(async m=>{const{count:p}=await le.from("live_products").select("*",{count:"exact",head:!0}).eq("live_event_id",m.id),{count:g}=await le.from("live_carts").select("*",{count:"exact",head:!0}).eq("live_event_id",m.id),{data:x}=await le.from("live_carts").select("total").eq("live_event_id",m.id).eq("status","pago"),v=(x||[]).reduce((y,b)=>y+(b.total||0),0);return{...m,productsCount:p||0,cartsCount:g||0,totalPaid:v}}));t(f)}catch(u){console.error("Error fetching live events:",u),i(u.message),de.error("Erro ao carregar lives")}finally{s(!1)}},[]);return P.useEffect(()=>{o()},[o]),{events:e,isLoading:r,error:a,fetchEvents:o,createEvent:async u=>{try{const{data:{user:h}}=await le.auth.getUser(),{data:f,error:m}=await le.from("live_events").insert({titulo:u.titulo,data_hora_inicio:u.data_hora_inicio,observacoes:u.observacoes||null,reservation_expiry_minutes:u.reservation_expiry_minutes||30,user_id:h==null?void 0:h.id}).select().single();if(m)throw m;return de.success("Live criada com sucesso!"),o(),f}catch(h){return console.error("Error creating live event:",h),de.error("Erro ao criar live"),null}},updateEventStatus:async(u,h)=>{try{const f={status:h};h==="ao_vivo"&&(f.data_hora_inicio=new Date().toISOString()),h==="encerrada"&&(f.data_hora_fim=new Date().toISOString());const{error:m}=await le.from("live_events").update(f).eq("id",u);if(m)throw m;const p={planejada:"Planejada",ao_vivo:"Ao Vivo",encerrada:"Encerrada",arquivada:"Arquivada"};return de.success(`Live ${p[h]}!`),o(),!0}catch(f){return console.error("Error updating live event status:",f),de.error("Erro ao atualizar status da live"),!1}},deleteEvent:async u=>{try{const{error:h}=await le.from("live_events").delete().eq("id",u);if(h)throw h;return de.success("Live excluda com sucesso!"),o(),!0}catch(h){return console.error("Error deleting live event:",h),de.error("Erro ao excluir live"),!1}}}}function B_(e){const[t,r]=P.useState(null),[s,a]=P.useState([]),[i,o]=P.useState({totalPlanejado:{itens:0,valor:0},totalReservado:{itens:0,valor:0},totalVendido:{itens:0,valor:0},totalEmAberto:{itens:0,valor:0},percentualPago:0}),[l,d]=P.useState(!0),c=P.useCallback(async()=>{if(e){d(!0);try{const{data:p,error:g}=await le.from("live_events").select("*").eq("id",e).single();if(g)throw g;r(p);const{data:x,error:v}=await le.from("live_products").select(`
          *,
          product:product_catalog(
            id, name, image_url, images, price, color, 
            stock_by_size, category, sku, group_key
          )
        `).eq("live_event_id",e).order("prioridade_ordem");if(v)throw v;const y=(x||[]).map(T=>T.product_id).filter(Boolean);let b={};if(y.length>0){const{data:T,error:O}=await le.from("product_available_stock").select("product_id, size, available").in("product_id",y);!O&&T&&T.forEach(R=>{b[R.product_id]||(b[R.product_id]={}),R.available>0&&(b[R.product_id][R.size]=R.available)})}const j=(x||[]).map(T=>{const O=b[T.product_id]||{};return{...T,product:T.product?{...T.product,available_by_size:O}:null}});a(j),await u(e)}catch(p){console.error("Error fetching live event:",p),de.error("Erro ao carregar live")}finally{d(!1)}}},[e]),u=async p=>{try{const{data:g}=await le.from("live_carts").select(`
          *,
          items:live_cart_items(*)
        `).eq("live_event_id",p),x=g||[];let v=0,y=0,b=0,j=0,T=0,O=0;x.forEach(G=>{const I=G.items||[],F=I.reduce((E,N)=>E+N.preco_unitario*N.qtd,0),S=I.reduce((E,N)=>E+N.qtd,0);if(G.status==="pago")b+=S,j+=F;else if(["aberto","em_confirmacao","aguardando_pagamento"].includes(G.status)){const E=I.filter(k=>["reservado","confirmado"].includes(k.status)),N=E.reduce((k,M)=>k+M.preco_unitario*M.qtd,0),C=E.reduce((k,M)=>k+M.qtd,0);v+=C,y+=N,T+=C,O+=N}});const{data:R}=await le.from("live_products").select(`
          *,
          product:product_catalog(price, stock_by_size)
        `).eq("live_event_id",p);let D=0,B=0;(R||[]).forEach(G=>{var E,N;const I=((E=G.product)==null?void 0:E.stock_by_size)||{},F=G.limite_unidades_live||Object.values(I).reduce((C,k)=>C+(k||0),0),S=((N=G.product)==null?void 0:N.price)||0;D+=F,B+=F*S});const q=b+T,Y=q>0?Math.round(b/q*100):0;o({totalPlanejado:{itens:D,valor:B},totalReservado:{itens:v,valor:y},totalVendido:{itens:b,valor:j},totalEmAberto:{itens:T,valor:O},percentualPago:Y})}catch(g){console.error("Error calculating KPIs:",g)}};return P.useEffect(()=>{c()},[c]),{event:t,products:s,kpis:i,isLoading:l,fetchEvent:c,addProduct:async(p,g)=>{if(!e)return!1;try{const x=s.reduce((D,B)=>Math.max(D,B.prioridade_ordem),0),{data:v,error:y}=await le.from("product_available_stock").select("size, available").eq("product_id",p);y&&console.error("[useLiveEvent.addProduct] Error fetching availability:",y);const b={};(v||[]).forEach(D=>{const B=Number(D.available||0);B>0&&(b[D.size]=B)});let j={},T=null;const O=Object.fromEntries(Object.entries(g.stock_reservations||{}).filter(([,D])=>Number(D||0)>0));Object.keys(O).length>0?(j=O,T=Object.values(j).reduce((D,B)=>D+(B||0),0)):(j=b,g.reserve_all?T=Object.values(j).reduce((D,B)=>D+(B||0),0):T=g.limite_unidades_live??null);const{error:R}=await le.from("live_products").insert({live_event_id:e,product_id:p,prioridade_ordem:x+1,visibilidade:g.visibilidade,bloquear_desde_planejamento:g.bloquear_desde_planejamento,limite_unidades_live:T,snapshot_variantes:j,live_discount_type:g.live_discount_type||null,live_discount_value:g.live_discount_value||null});if(R){if(R.code==="23505")return de.error("Este produto j est na live"),!1;throw R}return de.success("Produto adicionado  live!"),c(),!0}catch(x){return console.error("Error adding product to live:",x),de.error("Erro ao adicionar produto"),!1}},removeProduct:async p=>{try{const{error:g}=await le.from("live_products").delete().eq("id",p);if(g)throw g;return de.success("Produto removido da live!"),c(),!0}catch(g){return console.error("Error removing product from live:",g),de.error("Erro ao remover produto"),!1}},updateProductOrder:async p=>{try{const g=p.map((x,v)=>le.from("live_products").update({prioridade_ordem:v}).eq("id",x));return await Promise.all(g),c(),!0}catch(g){return console.error("Error updating product order:",g),de.error("Erro ao reordenar produtos"),!1}}}}function N1e({open:e,onOpenChange:t}){const r=pr(),{createEvent:s}=L_(),[a,i]=P.useState(!1),[o,l]=P.useState(""),[d,c]=P.useState(()=>{const g=new Date;return g.setMinutes(0),g.setSeconds(0),Wt(g,"yyyy-MM-dd'T'HH:mm")}),[u,h]=P.useState(""),[f,m]=P.useState(7),p=async g=>{if(g.preventDefault(),!!o.trim()){i(!0);try{const x=await s({titulo:o.trim(),data_hora_inicio:new Date(d).toISOString(),observacoes:u.trim()||void 0,reservation_expiry_minutes:Math.max(7,f)*24*60});x&&(t(!1),l(""),h(""),r(`/dashboard/lives/${x.id}/planejar`))}finally{i(!1)}}};return n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"sm:max-w-md",children:[n.jsxs(ln,{children:[n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(Ss,{className:"h-5 w-5 text-primary"}),"Nova Live"]}),n.jsx(Vo,{children:"Crie um evento de live para gerenciar vendas em tempo real"})]}),n.jsxs("form",{onSubmit:p,className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"titulo",children:"Ttulo da Live *"}),n.jsx(et,{id:"titulo",placeholder:"Ex: Live de Tera - Novidades",value:o,onChange:g=>l(g.target.value),required:!0})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"dataHora",children:"Data e Hora *"}),n.jsxs("div",{className:"relative",children:[n.jsx(ns,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{id:"dataHora",type:"datetime-local",value:d,onChange:g=>c(g.target.value),className:"pl-10",required:!0})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"expiryDays",children:"Tempo de Reserva (dias)"}),n.jsxs("div",{className:"relative",children:[n.jsx(Lr,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{id:"expiryDays",type:"number",min:7,max:30,step:1,value:f,onChange:g=>m(parseInt(g.target.value)||7),className:"pl-10"})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Mnimo de 7 dias. Reservas ficam separadas por pelo menos esse perodo."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"observacoes",children:"Observaes"}),n.jsx(rs,{id:"observacoes",placeholder:"Anotaes sobre a live...",value:u,onChange:g=>h(g.target.value),rows:3})]}),n.jsxs(ba,{children:[n.jsx(he,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),n.jsx(he,{type:"submit",disabled:a||!o.trim(),children:a?"Criando...":"Criar e Planejar"})]})]})]})})}const S1e={planejada:{label:"Planejada",color:"text-blue-600",bgColor:"bg-blue-50 border-blue-200",icon:n.jsx(ns,{className:"h-4 w-4"})},ao_vivo:{label:"AO VIVO",color:"text-red-600",bgColor:"bg-red-50 border-red-200",icon:n.jsx(Ss,{className:"h-4 w-4 animate-pulse"})},encerrada:{label:"Encerrada",color:"text-green-600",bgColor:"bg-green-50 border-green-200",icon:n.jsx(Sr,{className:"h-4 w-4"})},arquivada:{label:"Arquivada",color:"text-muted-foreground",bgColor:"bg-muted border-muted",icon:n.jsx(jx,{className:"h-4 w-4"})}};function C1e(){const e=pr(),{events:t,isLoading:r,updateEventStatus:s}=L_(),[a,i]=P.useState(!1),o=async h=>{await s(h.id,"ao_vivo"),e(`/dashboard/lives/${h.id}/backstage`)},l=async h=>{await s(h.id,"encerrada")};if(r)return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx(Wr,{className:"h-8 w-48"}),n.jsx(Wr,{className:"h-10 w-32"})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3].map(h=>n.jsx(Wr,{className:"h-64"},h))})]});const d=t.filter(h=>h.status==="ao_vivo"),c=t.filter(h=>h.status==="planejada"),u=t.filter(h=>["encerrada","arquivada"].includes(h.status));return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"font-serif text-2xl font-semibold",children:"Lives"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Gerencie suas vendas durante transmisses ao vivo"})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(he,{variant:"outline",onClick:()=>e("/dashboard/lives/rastreador"),className:"gap-2",children:[n.jsx(Nx,{className:"h-4 w-4"}),"Rastreador"]}),n.jsxs(he,{variant:"outline",onClick:()=>e("/dashboard/lives/relatorio"),className:"gap-2",children:[n.jsx(fc,{className:"h-4 w-4"}),"Relatrio"]}),n.jsxs(he,{onClick:()=>i(!0),className:"gap-2",children:[n.jsx(kn,{className:"h-4 w-4"}),"Nova Live"]})]})]}),d.length>0&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h3",{className:"font-medium text-red-600 flex items-center gap-2",children:[n.jsx(Ss,{className:"h-4 w-4 animate-pulse"}),"Ao Vivo Agora"]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(h=>n.jsx(m3,{event:h,onOpenBackstage:()=>e(`/dashboard/lives/${h.id}/backstage`),onEndLive:()=>l(h)},h.id))})]}),c.length>0&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h3",{className:"font-medium text-blue-600 flex items-center gap-2",children:[n.jsx(ns,{className:"h-4 w-4"}),"Prximas Lives"]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(h=>n.jsx(m3,{event:h,onPlan:()=>e(`/dashboard/lives/${h.id}/planejar`),onStartLive:()=>o(h)},h.id))})]}),u.length>0&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h3",{className:"font-medium text-muted-foreground flex items-center gap-2",children:[n.jsx(jx,{className:"h-4 w-4"}),"Lives Anteriores"]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.slice(0,6).map(h=>n.jsx(m3,{event:h,onViewReport:()=>e(`/dashboard/lives/${h.id}/relatorio`)},h.id))})]}),t.length===0&&n.jsx($e,{className:"border-dashed",children:n.jsxs(Fe,{className:"flex flex-col items-center justify-center py-12 text-center",children:[n.jsx(Ss,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),n.jsx("h3",{className:"font-medium text-lg mb-2",children:"Nenhuma live ainda"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-4 max-w-sm",children:"Crie sua primeira live para vender durante transmisses do Instagram"}),n.jsxs(he,{onClick:()=>i(!0),className:"gap-2",children:[n.jsx(kn,{className:"h-4 w-4"}),"Criar primeira live"]})]})}),n.jsx(N1e,{open:a,onOpenChange:i})]})}function m3({event:e,onPlan:t,onStartLive:r,onOpenBackstage:s,onEndLive:a,onViewReport:i}){const o=S1e[e.status];return n.jsxs($e,{className:`transition-all hover:shadow-md ${o.bgColor}`,children:[n.jsx(Dt,{className:"pb-3",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsx(Lt,{className:"text-lg font-medium line-clamp-1",children:e.titulo}),n.jsxs(ke,{variant:"outline",className:`${o.color} shrink-0 gap-1`,children:[o.icon,o.label]})]})}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(Lr,{className:"h-4 w-4"}),Wt(new Date(e.data_hora_inicio),"dd 'de' MMMM 's' HH:mm",{locale:mr})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[n.jsxs("div",{className:"bg-background/80 rounded-lg p-2",children:[n.jsx("div",{className:"text-lg font-semibold",children:e.productsCount}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Produtos"})]}),n.jsxs("div",{className:"bg-background/80 rounded-lg p-2",children:[n.jsx("div",{className:"text-lg font-semibold",children:e.cartsCount}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Carrinhos"})]}),n.jsxs("div",{className:"bg-background/80 rounded-lg p-2",children:[n.jsx("div",{className:"text-lg font-semibold",children:e.totalPaid>0?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e.totalPaid):"R$ 0"}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Vendas"})]})]}),n.jsxs("div",{className:"flex gap-2",children:[e.status==="planejada"&&n.jsxs(n.Fragment,{children:[n.jsx(he,{variant:"outline",size:"sm",className:"flex-1",onClick:t,children:"Planejar"}),n.jsxs(he,{size:"sm",className:"flex-1 gap-1 bg-red-600 hover:bg-red-700",onClick:r,children:[n.jsx(I6,{className:"h-3 w-3"}),"Iniciar"]})]}),e.status==="ao_vivo"&&n.jsxs(n.Fragment,{children:[n.jsxs(he,{size:"sm",className:"flex-1 gap-1 bg-red-600 hover:bg-red-700",onClick:s,children:[n.jsx(Ss,{className:"h-3 w-3"}),"Backstage"]}),n.jsx(he,{variant:"outline",size:"sm",onClick:a,children:n.jsx(iz,{className:"h-3 w-3"})})]}),["encerrada","arquivada"].includes(e.status)&&n.jsx(he,{variant:"outline",size:"sm",className:"flex-1",onClick:i,children:"Ver Relatrio"})]})]})]})}var Dr=function(){return Dr=Object.assign||function(t){for(var r,s=1,a=arguments.length;s<a;s++){r=arguments[s];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Dr.apply(this,arguments)};function E1e(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r}function tH(e,t,r){for(var s=0,a=t.length,i;s<a;s++)(i||!(s in t))&&(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}function h1(e){return e.mode==="multiple"}function f1(e){return e.mode==="range"}function $_(e){return e.mode==="single"}var k1e={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function A1e(e,t){return Wt(e,"LLLL y",t)}function T1e(e,t){return Wt(e,"d",t)}function P1e(e,t){return Wt(e,"LLLL",t)}function O1e(e){return"".concat(e)}function R1e(e,t){return Wt(e,"cccccc",t)}function M1e(e,t){return Wt(e,"yyyy",t)}var I1e=Object.freeze({__proto__:null,formatCaption:A1e,formatDay:T1e,formatMonthCaption:P1e,formatWeekNumber:O1e,formatWeekdayName:R1e,formatYearCaption:M1e}),D1e=function(e,t,r){return Wt(e,"do MMMM (EEEE)",r)},L1e=function(){return"Month: "},B1e=function(){return"Go to next month"},$1e=function(){return"Go to previous month"},F1e=function(e,t){return Wt(e,"cccc",t)},z1e=function(e){return"Week n. ".concat(e)},U1e=function(){return"Year: "},V1e=Object.freeze({__proto__:null,labelDay:D1e,labelMonthDropdown:L1e,labelNext:B1e,labelPrevious:$1e,labelWeekNumber:z1e,labelWeekday:F1e,labelYearDropdown:U1e});function q1e(){var e="buttons",t=k1e,r=Uk,s={},a={},i=1,o={},l=new Date;return{captionLayout:e,classNames:t,formatters:I1e,labels:V1e,locale:r,modifiersClassNames:s,modifiers:a,numberOfMonths:i,styles:o,today:l,mode:"default"}}function W1e(e){var t=e.fromYear,r=e.toYear,s=e.fromMonth,a=e.toMonth,i=e.fromDate,o=e.toDate;return s?i=Cs(s):t&&(i=new Date(t,0,1)),a?o=lc(a):r&&(o=new Date(r,11,31)),{fromDate:i?Vn(i):void 0,toDate:o?Vn(o):void 0}}var rH=P.createContext(void 0);function H1e(e){var t,r=e.initialProps,s=q1e(),a=W1e(r),i=a.fromDate,o=a.toDate,l=(t=r.captionLayout)!==null&&t!==void 0?t:s.captionLayout;l!=="buttons"&&(!i||!o)&&(l="buttons");var d;($_(r)||h1(r)||f1(r))&&(d=r.onSelect);var c=Dr(Dr(Dr({},s),r),{captionLayout:l,classNames:Dr(Dr({},s.classNames),r.classNames),components:Dr({},r.components),formatters:Dr(Dr({},s.formatters),r.formatters),fromDate:i,labels:Dr(Dr({},s.labels),r.labels),mode:r.mode||s.mode,modifiers:Dr(Dr({},s.modifiers),r.modifiers),modifiersClassNames:Dr(Dr({},s.modifiersClassNames),r.modifiersClassNames),onSelect:d,styles:Dr(Dr({},s.styles),r.styles),toDate:o});return n.jsx(rH.Provider,{value:c,children:e.children})}function ss(){var e=P.useContext(rH);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function nH(e){var t=ss(),r=t.locale,s=t.classNames,a=t.styles,i=t.formatters.formatCaption;return n.jsx("div",{className:s.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:i(e.displayMonth,{locale:r})})}function G1e(e){return n.jsx("svg",Dr({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:n.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function sH(e){var t,r,s=e.onChange,a=e.value,i=e.children,o=e.caption,l=e.className,d=e.style,c=ss(),u=(r=(t=c.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:G1e;return n.jsxs("div",{className:l,style:d,children:[n.jsx("span",{className:c.classNames.vhidden,children:e["aria-label"]}),n.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:c.classNames.dropdown,style:c.styles.dropdown,value:a,onChange:s,children:i}),n.jsxs("div",{className:c.classNames.caption_label,style:c.styles.caption_label,"aria-hidden":"true",children:[o,n.jsx(u,{className:c.classNames.dropdown_icon,style:c.styles.dropdown_icon})]})]})}function K1e(e){var t,r=ss(),s=r.fromDate,a=r.toDate,i=r.styles,o=r.locale,l=r.formatters.formatMonthCaption,d=r.classNames,c=r.components,u=r.labels.labelMonthDropdown;if(!s)return n.jsx(n.Fragment,{});if(!a)return n.jsx(n.Fragment,{});var h=[];if(xve(s,a))for(var f=Cs(s),m=s.getMonth();m<=a.getMonth();m++)h.push(f3(f,m));else for(var f=Cs(new Date),m=0;m<=11;m++)h.push(f3(f,m));var p=function(x){var v=Number(x.target.value),y=f3(Cs(e.displayMonth),v);e.onChange(y)},g=(t=c==null?void 0:c.Dropdown)!==null&&t!==void 0?t:sH;return n.jsx(g,{name:"months","aria-label":u(),className:d.dropdown_month,style:i.dropdown_month,onChange:p,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:o}),children:h.map(function(x){return n.jsx("option",{value:x.getMonth(),children:l(x,{locale:o})},x.getMonth())})})}function X1e(e){var t,r=e.displayMonth,s=ss(),a=s.fromDate,i=s.toDate,o=s.locale,l=s.styles,d=s.classNames,c=s.components,u=s.formatters.formatYearCaption,h=s.labels.labelYearDropdown,f=[];if(!a)return n.jsx(n.Fragment,{});if(!i)return n.jsx(n.Fragment,{});for(var m=a.getFullYear(),p=i.getFullYear(),g=m;g<=p;g++)f.push(LR(Fk(new Date),g));var x=function(y){var b=LR(Cs(r),Number(y.target.value));e.onChange(b)},v=(t=c==null?void 0:c.Dropdown)!==null&&t!==void 0?t:sH;return n.jsx(v,{name:"years","aria-label":h(),className:d.dropdown_year,style:l.dropdown_year,onChange:x,value:r.getFullYear(),caption:u(r,{locale:o}),children:f.map(function(y){return n.jsx("option",{value:y.getFullYear(),children:u(y,{locale:o})},y.getFullYear())})})}function Y1e(e,t){var r=P.useState(e),s=r[0],a=r[1],i=t===void 0?s:t;return[i,a]}function Z1e(e){var t=e.month,r=e.defaultMonth,s=e.today,a=t||r||s||new Date,i=e.toDate,o=e.fromDate,l=e.numberOfMonths,d=l===void 0?1:l;if(i&&vp(i,a)<0){var c=-1*(d-1);a=qo(i,c)}return o&&vp(a,o)<0&&(a=o),Cs(a)}function Q1e(){var e=ss(),t=Z1e(e),r=Y1e(t,e.month),s=r[0],a=r[1],i=function(o){var l;if(!e.disableNavigation){var d=Cs(o);a(d),(l=e.onMonthChange)===null||l===void 0||l.call(e,d)}};return[s,i]}function J1e(e,t){for(var r=t.reverseMonths,s=t.numberOfMonths,a=Cs(e),i=Cs(qo(a,s)),o=vp(i,a),l=[],d=0;d<o;d++){var c=qo(a,d);l.push(c)}return r&&(l=l.reverse()),l}function eye(e,t){if(!t.disableNavigation){var r=t.toDate,s=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,o=s?i:1,l=Cs(e);if(!r)return qo(l,o);var d=vp(r,e);if(!(d<i))return qo(l,o)}}function tye(e,t){if(!t.disableNavigation){var r=t.fromDate,s=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,o=s?i:1,l=Cs(e);if(!r)return qo(l,-o);var d=vp(l,r);if(!(d<=0))return qo(l,-o)}}var aH=P.createContext(void 0);function rye(e){var t=ss(),r=Q1e(),s=r[0],a=r[1],i=J1e(s,t),o=eye(s,t),l=tye(s,t),d=function(h){return i.some(function(f){return Wk(h,f)})},c=function(h,f){d(h)||(f&&qk(h,f)?a(qo(h,1+t.numberOfMonths*-1)):a(h))},u={currentMonth:s,displayMonths:i,goToMonth:a,goToDate:c,previousMonth:l,nextMonth:o,isDateDisplayed:d};return n.jsx(aH.Provider,{value:u,children:e.children})}function m1(){var e=P.useContext(aH);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function WR(e){var t,r=ss(),s=r.classNames,a=r.styles,i=r.components,o=m1().goToMonth,l=function(u){o(qo(u,e.displayIndex?-e.displayIndex:0))},d=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:nH,c=n.jsx(d,{id:e.id,displayMonth:e.displayMonth});return n.jsxs("div",{className:s.caption_dropdowns,style:a.caption_dropdowns,children:[n.jsx("div",{className:s.vhidden,children:c}),n.jsx(K1e,{onChange:l,displayMonth:e.displayMonth}),n.jsx(X1e,{onChange:l,displayMonth:e.displayMonth})]})}function nye(e){return n.jsx("svg",Dr({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function sye(e){return n.jsx("svg",Dr({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var bw=P.forwardRef(function(e,t){var r=ss(),s=r.classNames,a=r.styles,i=[s.button_reset,s.button];e.className&&i.push(e.className);var o=i.join(" "),l=Dr(Dr({},a.button_reset),a.button);return e.style&&Object.assign(l,e.style),n.jsx("button",Dr({},e,{ref:t,type:"button",className:o,style:l}))});function aye(e){var t,r,s=ss(),a=s.dir,i=s.locale,o=s.classNames,l=s.styles,d=s.labels,c=d.labelPrevious,u=d.labelNext,h=s.components;if(!e.nextMonth&&!e.previousMonth)return n.jsx(n.Fragment,{});var f=c(e.previousMonth,{locale:i}),m=[o.nav_button,o.nav_button_previous].join(" "),p=u(e.nextMonth,{locale:i}),g=[o.nav_button,o.nav_button_next].join(" "),x=(t=h==null?void 0:h.IconRight)!==null&&t!==void 0?t:sye,v=(r=h==null?void 0:h.IconLeft)!==null&&r!==void 0?r:nye;return n.jsxs("div",{className:o.nav,style:l.nav,children:[!e.hidePrevious&&n.jsx(bw,{name:"previous-month","aria-label":f,className:m,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?n.jsx(x,{className:o.nav_icon,style:l.nav_icon}):n.jsx(v,{className:o.nav_icon,style:l.nav_icon})}),!e.hideNext&&n.jsx(bw,{name:"next-month","aria-label":p,className:g,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?n.jsx(v,{className:o.nav_icon,style:l.nav_icon}):n.jsx(x,{className:o.nav_icon,style:l.nav_icon})})]})}function HR(e){var t=ss().numberOfMonths,r=m1(),s=r.previousMonth,a=r.nextMonth,i=r.goToMonth,o=r.displayMonths,l=o.findIndex(function(p){return Wk(e.displayMonth,p)}),d=l===0,c=l===o.length-1,u=t>1&&(d||!c),h=t>1&&(c||!d),f=function(){s&&i(s)},m=function(){a&&i(a)};return n.jsx(aye,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:h,nextMonth:a,previousMonth:s,onPreviousClick:f,onNextClick:m})}function iye(e){var t,r=ss(),s=r.classNames,a=r.disableNavigation,i=r.styles,o=r.captionLayout,l=r.components,d=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:nH,c;return a?c=n.jsx(d,{id:e.id,displayMonth:e.displayMonth}):o==="dropdown"?c=n.jsx(WR,{displayMonth:e.displayMonth,id:e.id}):o==="dropdown-buttons"?c=n.jsxs(n.Fragment,{children:[n.jsx(WR,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),n.jsx(HR,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):c=n.jsxs(n.Fragment,{children:[n.jsx(d,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(HR,{displayMonth:e.displayMonth,id:e.id})]}),n.jsx("div",{className:s.caption,style:i.caption,children:c})}function oye(e){var t=ss(),r=t.footer,s=t.styles,a=t.classNames.tfoot;return r?n.jsx("tfoot",{className:a,style:s.tfoot,children:n.jsx("tr",{children:n.jsx("td",{colSpan:8,children:r})})}):n.jsx(n.Fragment,{})}function lye(e,t,r){for(var s=r?cf(new Date):pc(new Date,{locale:e,weekStartsOn:t}),a=[],i=0;i<7;i++){var o=mi(s,i);a.push(o)}return a}function cye(){var e=ss(),t=e.classNames,r=e.styles,s=e.showWeekNumber,a=e.locale,i=e.weekStartsOn,o=e.ISOWeek,l=e.formatters.formatWeekdayName,d=e.labels.labelWeekday,c=lye(a,i,o);return n.jsxs("tr",{style:r.head_row,className:t.head_row,children:[s&&n.jsx("td",{style:r.head_cell,className:t.head_cell}),c.map(function(u,h){return n.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":d(u,{locale:a}),children:l(u,{locale:a})},h)})]})}function dye(){var e,t=ss(),r=t.classNames,s=t.styles,a=t.components,i=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:cye;return n.jsx("thead",{style:s.head,className:r.head,children:n.jsx(i,{})})}function uye(e){var t=ss(),r=t.locale,s=t.formatters.formatDay;return n.jsx(n.Fragment,{children:s(e.date,{locale:r})})}var Hk=P.createContext(void 0);function hye(e){if(!h1(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return n.jsx(Hk.Provider,{value:t,children:e.children})}return n.jsx(fye,{initialProps:e.initialProps,children:e.children})}function fye(e){var t=e.initialProps,r=e.children,s=t.selected,a=t.min,i=t.max,o=function(c,u,h){var f,m;(f=t.onDayClick)===null||f===void 0||f.call(t,c,u,h);var p=!!(u.selected&&a&&(s==null?void 0:s.length)===a);if(!p){var g=!!(!u.selected&&i&&(s==null?void 0:s.length)===i);if(!g){var x=s?tH([],s):[];if(u.selected){var v=x.findIndex(function(y){return Di(c,y)});x.splice(v,1)}else x.push(c);(m=t.onSelect)===null||m===void 0||m.call(t,x,c,u,h)}}},l={disabled:[]};s&&l.disabled.push(function(c){var u=i&&s.length>i-1,h=s.some(function(f){return Di(f,c)});return!!(u&&!h)});var d={selected:s,onDayClick:o,modifiers:l};return n.jsx(Hk.Provider,{value:d,children:r})}function Gk(){var e=P.useContext(Hk);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function mye(e,t){var r=t||{},s=r.from,a=r.to;return s&&a?Di(a,e)&&Di(s,e)?void 0:Di(a,e)?{from:a,to:void 0}:Di(s,e)?void 0:yw(s,e)?{from:e,to:a}:{from:s,to:e}:a?yw(e,a)?{from:a,to:e}:{from:e,to:a}:s?qk(e,s)?{from:e,to:s}:{from:s,to:e}:{from:e,to:void 0}}var Kk=P.createContext(void 0);function pye(e){if(!f1(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return n.jsx(Kk.Provider,{value:t,children:e.children})}return n.jsx(gye,{initialProps:e.initialProps,children:e.children})}function gye(e){var t=e.initialProps,r=e.children,s=t.selected,a=s||{},i=a.from,o=a.to,l=t.min,d=t.max,c=function(m,p,g){var x,v;(x=t.onDayClick)===null||x===void 0||x.call(t,m,p,g);var y=mye(m,s);(v=t.onSelect)===null||v===void 0||v.call(t,y,m,p,g)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(u.range_start=[i],o?(u.range_end=[o],Di(i,o)||(u.range_middle=[{after:i,before:o}])):u.range_end=[i]):o&&(u.range_start=[o],u.range_end=[o]),l&&(i&&!o&&u.disabled.push({after:fn(i,l-1),before:mi(i,l-1)}),i&&o&&u.disabled.push({after:i,before:mi(i,l-1)}),!i&&o&&u.disabled.push({after:fn(o,l-1),before:mi(o,l-1)})),d){if(i&&!o&&(u.disabled.push({before:mi(i,-d+1)}),u.disabled.push({after:mi(i,d-1)})),i&&o){var h=ec(o,i)+1,f=d-h;u.disabled.push({before:fn(i,f)}),u.disabled.push({after:mi(o,f)})}!i&&o&&(u.disabled.push({before:mi(o,-d+1)}),u.disabled.push({after:mi(o,d-1)}))}return n.jsx(Kk.Provider,{value:{selected:s,onDayClick:c,modifiers:u},children:r})}function Xk(){var e=P.useContext(Kk);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function gb(e){return Array.isArray(e)?tH([],e):e!==void 0?[e]:[]}function xye(e){var t={};return Object.entries(e).forEach(function(r){var s=r[0],a=r[1];t[s]=gb(a)}),t}var El;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(El||(El={}));var vye=El.Selected,Pc=El.Disabled,yye=El.Hidden,bye=El.Today,p3=El.RangeEnd,g3=El.RangeMiddle,x3=El.RangeStart,wye=El.Outside;function _ye(e,t,r){var s,a=(s={},s[vye]=gb(e.selected),s[Pc]=gb(e.disabled),s[yye]=gb(e.hidden),s[bye]=[e.today],s[p3]=[],s[g3]=[],s[x3]=[],s[wye]=[],s);return e.fromDate&&a[Pc].push({before:e.fromDate}),e.toDate&&a[Pc].push({after:e.toDate}),h1(e)?a[Pc]=a[Pc].concat(t.modifiers[Pc]):f1(e)&&(a[Pc]=a[Pc].concat(r.modifiers[Pc]),a[x3]=r.modifiers[x3],a[g3]=r.modifiers[g3],a[p3]=r.modifiers[p3]),a}var iH=P.createContext(void 0);function jye(e){var t=ss(),r=Gk(),s=Xk(),a=_ye(t,r,s),i=xye(t.modifiers),o=Dr(Dr({},a),i);return n.jsx(iH.Provider,{value:o,children:e.children})}function oH(){var e=P.useContext(iH);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Nye(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Sye(e){return!!(e&&typeof e=="object"&&"from"in e)}function Cye(e){return!!(e&&typeof e=="object"&&"after"in e)}function Eye(e){return!!(e&&typeof e=="object"&&"before"in e)}function kye(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Aye(e,t){var r,s=t.from,a=t.to;if(s&&a){var i=ec(a,s)<0;i&&(r=[a,s],s=r[0],a=r[1]);var o=ec(e,s)>=0&&ec(a,e)>=0;return o}return a?Di(a,e):s?Di(s,e):!1}function Tye(e){return $k(e)}function Pye(e){return Array.isArray(e)&&e.every($k)}function Oye(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(Tye(r))return Di(e,r);if(Pye(r))return r.includes(e);if(Sye(r))return Aye(e,r);if(kye(r))return r.dayOfWeek.includes(e.getDay());if(Nye(r)){var s=ec(r.before,e),a=ec(r.after,e),i=s>0,o=a<0,l=yw(r.before,r.after);return l?o&&i:i||o}return Cye(r)?ec(e,r.after)>0:Eye(r)?ec(r.before,e)>0:typeof r=="function"?r(e):!1})}function Yk(e,t,r){var s=Object.keys(t).reduce(function(i,o){var l=t[o];return Oye(e,l)&&i.push(o),i},[]),a={};return s.forEach(function(i){return a[i]=!0}),r&&!Wk(e,r)&&(a.outside=!0),a}function Rye(e,t){for(var r=Cs(e[0]),s=lc(e[e.length-1]),a,i,o=r;o<=s;){var l=Yk(o,t),d=!l.disabled&&!l.hidden;if(!d){o=mi(o,1);continue}if(l.selected)return o;l.today&&!i&&(i=o),a||(a=o),o=mi(o,1)}return i||a}var Mye=365;function lH(e,t){var r=t.moveBy,s=t.direction,a=t.context,i=t.modifiers,o=t.retry,l=o===void 0?{count:0,lastFocused:e}:o,d=a.weekStartsOn,c=a.fromDate,u=a.toDate,h=a.locale,f={day:mi,week:bC,month:qo,year:zW,startOfWeek:function(x){return a.ISOWeek?cf(x):pc(x,{locale:h,weekStartsOn:d})},endOfWeek:function(x){return a.ISOWeek?qW(x):zk(x,{locale:h,weekStartsOn:d})}},m=f[r](e,s==="after"?1:-1);s==="before"&&c?m=cxe([c,m]):s==="after"&&u&&(m=dxe([u,m]));var p=!0;if(i){var g=Yk(m,i);p=!g.disabled&&!g.hidden}return p?m:l.count>Mye?l.lastFocused:lH(m,{moveBy:r,direction:s,context:a,modifiers:i,retry:Dr(Dr({},l),{count:l.count+1})})}var cH=P.createContext(void 0);function Iye(e){var t=m1(),r=oH(),s=P.useState(),a=s[0],i=s[1],o=P.useState(),l=o[0],d=o[1],c=Rye(t.displayMonths,r),u=a??(l&&t.isDateDisplayed(l))?l:c,h=function(){d(a),i(void 0)},f=function(x){i(x)},m=ss(),p=function(x,v){if(a){var y=lH(a,{moveBy:x,direction:v,context:m,modifiers:r});Di(a,y)||(t.goToDate(y,a),f(y))}},g={focusedDay:a,focusTarget:u,blur:h,focus:f,focusDayAfter:function(){return p("day","after")},focusDayBefore:function(){return p("day","before")},focusWeekAfter:function(){return p("week","after")},focusWeekBefore:function(){return p("week","before")},focusMonthBefore:function(){return p("month","before")},focusMonthAfter:function(){return p("month","after")},focusYearBefore:function(){return p("year","before")},focusYearAfter:function(){return p("year","after")},focusStartOfWeek:function(){return p("startOfWeek","before")},focusEndOfWeek:function(){return p("endOfWeek","after")}};return n.jsx(cH.Provider,{value:g,children:e.children})}function Zk(){var e=P.useContext(cH);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function Dye(e,t){var r=oH(),s=Yk(e,r,t);return s}var Qk=P.createContext(void 0);function Lye(e){if(!$_(e.initialProps)){var t={selected:void 0};return n.jsx(Qk.Provider,{value:t,children:e.children})}return n.jsx(Bye,{initialProps:e.initialProps,children:e.children})}function Bye(e){var t=e.initialProps,r=e.children,s=function(i,o,l){var d,c,u;if((d=t.onDayClick)===null||d===void 0||d.call(t,i,o,l),o.selected&&!t.required){(c=t.onSelect)===null||c===void 0||c.call(t,void 0,i,o,l);return}(u=t.onSelect)===null||u===void 0||u.call(t,i,i,o,l)},a={selected:t.selected,onDayClick:s};return n.jsx(Qk.Provider,{value:a,children:r})}function dH(){var e=P.useContext(Qk);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function $ye(e,t){var r=ss(),s=dH(),a=Gk(),i=Xk(),o=Zk(),l=o.focusDayAfter,d=o.focusDayBefore,c=o.focusWeekAfter,u=o.focusWeekBefore,h=o.blur,f=o.focus,m=o.focusMonthBefore,p=o.focusMonthAfter,g=o.focusYearBefore,x=o.focusYearAfter,v=o.focusStartOfWeek,y=o.focusEndOfWeek,b=function(N){var C,k,M,U;$_(r)?(C=s.onDayClick)===null||C===void 0||C.call(s,e,t,N):h1(r)?(k=a.onDayClick)===null||k===void 0||k.call(a,e,t,N):f1(r)?(M=i.onDayClick)===null||M===void 0||M.call(i,e,t,N):(U=r.onDayClick)===null||U===void 0||U.call(r,e,t,N)},j=function(N){var C;f(e),(C=r.onDayFocus)===null||C===void 0||C.call(r,e,t,N)},T=function(N){var C;h(),(C=r.onDayBlur)===null||C===void 0||C.call(r,e,t,N)},O=function(N){var C;(C=r.onDayMouseEnter)===null||C===void 0||C.call(r,e,t,N)},R=function(N){var C;(C=r.onDayMouseLeave)===null||C===void 0||C.call(r,e,t,N)},D=function(N){var C;(C=r.onDayPointerEnter)===null||C===void 0||C.call(r,e,t,N)},B=function(N){var C;(C=r.onDayPointerLeave)===null||C===void 0||C.call(r,e,t,N)},q=function(N){var C;(C=r.onDayTouchCancel)===null||C===void 0||C.call(r,e,t,N)},Y=function(N){var C;(C=r.onDayTouchEnd)===null||C===void 0||C.call(r,e,t,N)},G=function(N){var C;(C=r.onDayTouchMove)===null||C===void 0||C.call(r,e,t,N)},I=function(N){var C;(C=r.onDayTouchStart)===null||C===void 0||C.call(r,e,t,N)},F=function(N){var C;(C=r.onDayKeyUp)===null||C===void 0||C.call(r,e,t,N)},S=function(N){var C;switch(N.key){case"ArrowLeft":N.preventDefault(),N.stopPropagation(),r.dir==="rtl"?l():d();break;case"ArrowRight":N.preventDefault(),N.stopPropagation(),r.dir==="rtl"?d():l();break;case"ArrowDown":N.preventDefault(),N.stopPropagation(),c();break;case"ArrowUp":N.preventDefault(),N.stopPropagation(),u();break;case"PageUp":N.preventDefault(),N.stopPropagation(),N.shiftKey?g():m();break;case"PageDown":N.preventDefault(),N.stopPropagation(),N.shiftKey?x():p();break;case"Home":N.preventDefault(),N.stopPropagation(),v();break;case"End":N.preventDefault(),N.stopPropagation(),y();break}(C=r.onDayKeyDown)===null||C===void 0||C.call(r,e,t,N)},E={onClick:b,onFocus:j,onBlur:T,onKeyDown:S,onKeyUp:F,onMouseEnter:O,onMouseLeave:R,onPointerEnter:D,onPointerLeave:B,onTouchCancel:q,onTouchEnd:Y,onTouchMove:G,onTouchStart:I};return E}function Fye(){var e=ss(),t=dH(),r=Gk(),s=Xk(),a=$_(e)?t.selected:h1(e)?r.selected:f1(e)?s.selected:void 0;return a}function zye(e){return Object.values(El).includes(e)}function Uye(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(s){var a=e.modifiersClassNames[s];if(a)r.push(a);else if(zye(s)){var i=e.classNames["day_".concat(s)];i&&r.push(i)}}),r}function Vye(e,t){var r=Dr({},e.styles.day);return Object.keys(t).forEach(function(s){var a;r=Dr(Dr({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[s])}),r}function qye(e,t,r){var s,a,i,o=ss(),l=Zk(),d=Dye(e,t),c=$ye(e,d),u=Fye(),h=!!(o.onDayClick||o.mode!=="default");P.useEffect(function(){var O;d.outside||l.focusedDay&&h&&Di(l.focusedDay,e)&&((O=r.current)===null||O===void 0||O.focus())},[l.focusedDay,e,r,h,d.outside]);var f=Uye(o,d).join(" "),m=Vye(o,d),p=!!(d.outside&&!o.showOutsideDays||d.hidden),g=(i=(a=o.components)===null||a===void 0?void 0:a.DayContent)!==null&&i!==void 0?i:uye,x=n.jsx(g,{date:e,displayMonth:t,activeModifiers:d}),v={style:m,className:f,children:x,role:"gridcell"},y=l.focusTarget&&Di(l.focusTarget,e)&&!d.outside,b=l.focusedDay&&Di(l.focusedDay,e),j=Dr(Dr(Dr({},v),(s={disabled:d.disabled,role:"gridcell"},s["aria-selected"]=d.selected,s.tabIndex=b||y?0:-1,s)),c),T={isButton:h,isHidden:p,activeModifiers:d,selectedDays:u,buttonProps:j,divProps:v};return T}function Wye(e){var t=P.useRef(null),r=qye(e.date,e.displayMonth,t);return r.isHidden?n.jsx("div",{role:"gridcell"}):r.isButton?n.jsx(bw,Dr({name:"day",ref:t},r.buttonProps)):n.jsx("div",Dr({},r.divProps))}function Hye(e){var t=e.number,r=e.dates,s=ss(),a=s.onWeekNumberClick,i=s.styles,o=s.classNames,l=s.locale,d=s.labels.labelWeekNumber,c=s.formatters.formatWeekNumber,u=c(Number(t),{locale:l});if(!a)return n.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:u});var h=d(Number(t),{locale:l}),f=function(m){a(t,r,m)};return n.jsx(bw,{name:"week-number","aria-label":h,className:o.weeknumber,style:i.weeknumber,onClick:f,children:u})}function Gye(e){var t,r,s=ss(),a=s.styles,i=s.classNames,o=s.showWeekNumber,l=s.components,d=(t=l==null?void 0:l.Day)!==null&&t!==void 0?t:Wye,c=(r=l==null?void 0:l.WeekNumber)!==null&&r!==void 0?r:Hye,u;return o&&(u=n.jsx("td",{className:i.cell,style:a.cell,children:n.jsx(c,{number:e.weekNumber,dates:e.dates})})),n.jsxs("tr",{className:i.row,style:a.row,children:[u,e.dates.map(function(h){return n.jsx("td",{className:i.cell,style:a.cell,role:"presentation",children:n.jsx(d,{displayMonth:e.displayMonth,date:h})},mve(h))})]})}function GR(e,t,r){for(var s=r!=null&&r.ISOWeek?qW(t):zk(t,r),a=r!=null&&r.ISOWeek?cf(e):pc(e,r),i=ec(s,a),o=[],l=0;l<=i;l++)o.push(mi(a,l));var d=o.reduce(function(c,u){var h=r!=null&&r.ISOWeek?HW(u):KW(u,r),f=c.find(function(m){return m.weekNumber===h});return f?(f.dates.push(u),c):(c.push({weekNumber:h,dates:[u]}),c)},[]);return d}function Kye(e,t){var r=GR(Cs(e),lc(e),t);if(t!=null&&t.useFixedWeeks){var s=gve(e,t);if(s<6){var a=r[r.length-1],i=a.dates[a.dates.length-1],o=bC(i,6-s),l=GR(bC(i,1),o,t);r.push.apply(r,l)}}return r}function Xye(e){var t,r,s,a=ss(),i=a.locale,o=a.classNames,l=a.styles,d=a.hideHead,c=a.fixedWeeks,u=a.components,h=a.weekStartsOn,f=a.firstWeekContainsDate,m=a.ISOWeek,p=Kye(e.displayMonth,{useFixedWeeks:!!c,ISOWeek:m,locale:i,weekStartsOn:h,firstWeekContainsDate:f}),g=(t=u==null?void 0:u.Head)!==null&&t!==void 0?t:dye,x=(r=u==null?void 0:u.Row)!==null&&r!==void 0?r:Gye,v=(s=u==null?void 0:u.Footer)!==null&&s!==void 0?s:oye;return n.jsxs("table",{id:e.id,className:o.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!d&&n.jsx(g,{}),n.jsx("tbody",{className:o.tbody,style:l.tbody,children:p.map(function(y){return n.jsx(x,{displayMonth:e.displayMonth,dates:y.dates,weekNumber:y.weekNumber},y.weekNumber)})}),n.jsx(v,{displayMonth:e.displayMonth})]})}function Yye(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var Zye=Yye()?P.useLayoutEffect:P.useEffect,v3=!1,Qye=0;function KR(){return"react-day-picker-".concat(++Qye)}function Jye(e){var t,r=e??(v3?KR():null),s=P.useState(r),a=s[0],i=s[1];return Zye(function(){a===null&&i(KR())},[]),P.useEffect(function(){v3===!1&&(v3=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function ebe(e){var t,r,s=ss(),a=s.dir,i=s.classNames,o=s.styles,l=s.components,d=m1().displayMonths,c=Jye(s.id?"".concat(s.id,"-").concat(e.displayIndex):void 0),u=s.id?"".concat(s.id,"-grid-").concat(e.displayIndex):void 0,h=[i.month],f=o.month,m=e.displayIndex===0,p=e.displayIndex===d.length-1,g=!m&&!p;a==="rtl"&&(t=[m,p],p=t[0],m=t[1]),m&&(h.push(i.caption_start),f=Dr(Dr({},f),o.caption_start)),p&&(h.push(i.caption_end),f=Dr(Dr({},f),o.caption_end)),g&&(h.push(i.caption_between),f=Dr(Dr({},f),o.caption_between));var x=(r=l==null?void 0:l.Caption)!==null&&r!==void 0?r:iye;return n.jsxs("div",{className:h.join(" "),style:f,children:[n.jsx(x,{id:c,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(Xye,{id:u,"aria-labelledby":c,displayMonth:e.displayMonth})]},e.displayIndex)}function tbe(e){var t=ss(),r=t.classNames,s=t.styles;return n.jsx("div",{className:r.months,style:s.months,children:e.children})}function rbe(e){var t,r,s=e.initialProps,a=ss(),i=Zk(),o=m1(),l=P.useState(!1),d=l[0],c=l[1];P.useEffect(function(){a.initialFocus&&i.focusTarget&&(d||(i.focus(i.focusTarget),c(!0)))},[a.initialFocus,d,i.focus,i.focusTarget,i]);var u=[a.classNames.root,a.className];a.numberOfMonths>1&&u.push(a.classNames.multiple_months),a.showWeekNumber&&u.push(a.classNames.with_weeknumber);var h=Dr(Dr({},a.styles.root),a.style),f=Object.keys(s).filter(function(p){return p.startsWith("data-")}).reduce(function(p,g){var x;return Dr(Dr({},p),(x={},x[g]=s[g],x))},{}),m=(r=(t=s.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:tbe;return n.jsx("div",Dr({className:u.join(" "),style:h,dir:a.dir,id:a.id,nonce:s.nonce,title:s.title,lang:s.lang},f,{children:n.jsx(m,{children:o.displayMonths.map(function(p,g){return n.jsx(ebe,{displayIndex:g,displayMonth:p},g)})})}))}function nbe(e){var t=e.children,r=E1e(e,["children"]);return n.jsx(H1e,{initialProps:r,children:n.jsx(rye,{children:n.jsx(Lye,{initialProps:r,children:n.jsx(hye,{initialProps:r,children:n.jsx(pye,{initialProps:r,children:n.jsx(jye,{children:n.jsx(Iye,{children:t})})})})})})})}function sbe(e){return n.jsx(nbe,Dr({},e,{children:n.jsx(rbe,{initialProps:e})}))}function _i({className:e,classNames:t,showOutsideDays:r=!0,...s}){return n.jsx(sbe,{showOutsideDays:r,className:He("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:He($x({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:He($x({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...a})=>n.jsx(ZF,{className:"h-4 w-4"}),IconRight:({...a})=>n.jsx(In,{className:"h-4 w-4"})},...s})}_i.displayName="Calendar";function abe(){const[e,t]=P.useState([]),[r,s]=P.useState(!0),[a,i]=P.useState(""),[o,l]=P.useState(!1),[d,c]=P.useState(null),[u,h]=P.useState(""),[f,m]=P.useState("percentage"),[p,g]=P.useState(""),[x,v]=P.useState(),[y,b]=P.useState(),[j,T]=P.useState(""),[O,R]=P.useState(""),[D,B]=P.useState(!1);P.useEffect(()=>{q()},[]);const q=async()=>{s(!0);try{const{data:k,error:M}=await le.from("coupons").select("*").order("created_at",{ascending:!1});if(M)throw M;t(k||[])}catch(k){console.error("Error fetching coupons:",k),de.error("Erro ao carregar cupons")}finally{s(!1)}},Y=()=>{h(""),m("percentage"),g(""),v(void 0),b(void 0),T(""),R("")},G=async()=>{if(!u.trim()||!p){de.error("Preencha o cdigo e o valor do desconto");return}B(!0);try{const{error:k}=await le.from("coupons").insert({code:u.toUpperCase().trim(),discount_type:f,discount_value:parseFloat(p),starts_at:(x==null?void 0:x.toISOString())||null,ends_at:(y==null?void 0:y.toISOString())||null,max_uses:j?parseInt(j):null,min_order_value:O?parseFloat(O):null});if(k){if(k.code==="23505")de.error("J existe um cupom com este cdigo");else throw k;return}de.success("Cupom criado com sucesso!"),l(!1),Y(),q()}catch(k){console.error("Error creating coupon:",k),de.error("Erro ao criar cupom")}finally{B(!1)}},I=async k=>{try{const{error:M}=await le.from("coupons").update({is_active:!k.is_active}).eq("id",k.id);if(M)throw M;t(U=>U.map($=>$.id===k.id?{...$,is_active:!$.is_active}:$)),de.success(k.is_active?"Cupom desativado":"Cupom ativado")}catch(M){console.error("Error toggling coupon:",M),de.error("Erro ao atualizar cupom")}},F=async k=>{if(confirm("Tem certeza que deseja excluir este cupom?"))try{const{error:M}=await le.from("coupons").delete().eq("id",k);if(M)throw M;t(U=>U.filter($=>$.id!==k)),de.success("Cupom excludo")}catch(M){console.error("Error deleting coupon:",M),de.error("Erro ao excluir cupom")}},S=k=>{navigator.clipboard.writeText(k),c(k),setTimeout(()=>c(null),2e3)},E=e.filter(k=>k.code.toLowerCase().includes(a.toLowerCase())),N=k=>{if(!k.is_active)return{label:"Inativo",variant:"secondary"};const M=new Date;return k.starts_at&&new Date(k.starts_at)>M?{label:"Agendado",variant:"outline"}:k.ends_at&&new Date(k.ends_at)<M?{label:"Expirado",variant:"destructive"}:k.max_uses&&k.times_used>=k.max_uses?{label:"Esgotado",variant:"destructive"}:{label:"Ativo",variant:"default"}},C=k=>k.discount_type==="percentage"?`${k.discount_value}%`:`R$ ${k.discount_value.toFixed(2)}`;return n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Dh,{className:"h-5 w-5"}),"Cupons de Desconto"]}),n.jsx(qi,{children:"Gerencie cupons promocionais para suas vendas"})]}),n.jsxs(he,{onClick:()=>l(!0),children:[n.jsx(kn,{className:"h-4 w-4 mr-1"}),"Novo Cupom"]})]})}),n.jsxs(Fe,{children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por cdigo...",value:a,onChange:k=>i(k.target.value),className:"pl-10"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Total"})]}),n.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(k=>N(k).label==="Ativo").length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Ativos"})]}),n.jsxs("div",{className:"p-3 bg-amber-50 dark:bg-amber-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:e.reduce((k,M)=>k+M.times_used,0)}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Usos"})]})]}),r?n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando..."}):E.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Dh,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhum cupom encontrado"})]}):n.jsx("div",{className:"rounded-md border overflow-x-auto",children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{children:"Cdigo"}),n.jsx(St,{children:"Desconto"}),n.jsx(St,{children:"Validade"}),n.jsx(St,{children:"Usos"}),n.jsx(St,{children:"Status"}),n.jsx(St,{className:"text-right",children:"Aes"})]})}),n.jsx(ya,{children:E.map(k=>{const M=N(k);return n.jsxs(Kr,{children:[n.jsx(bt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("code",{className:"font-mono font-bold bg-secondary px-2 py-1 rounded",children:k.code}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>S(k.code),children:d===k.code?n.jsx(gn,{className:"h-3 w-3 text-green-600"}):n.jsx(Wa,{className:"h-3 w-3"})})]})}),n.jsxs(bt,{children:[n.jsxs("div",{className:"flex items-center gap-1",children:[k.discount_type==="percentage"?n.jsx(Uo,{className:"h-3 w-3"}):n.jsx(ks,{className:"h-3 w-3"}),C(k)]}),k.min_order_value&&n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Mn: R$ ",k.min_order_value.toFixed(2)]})]}),n.jsx(bt,{children:n.jsxs("div",{className:"text-sm",children:[k.starts_at&&n.jsxs("div",{children:["De:"," ",Wt(new Date(k.starts_at),"dd/MM/yy",{locale:mr})]}),k.ends_at&&n.jsxs("div",{children:["At:"," ",Wt(new Date(k.ends_at),"dd/MM/yy",{locale:mr})]}),!k.starts_at&&!k.ends_at&&n.jsx("span",{className:"text-muted-foreground",children:"Sem limite"})]})}),n.jsx(bt,{children:n.jsxs("div",{className:"text-sm",children:[k.times_used,k.max_uses&&` / ${k.max_uses}`]})}),n.jsx(bt,{children:n.jsx(ke,{variant:M.variant,children:M.label})}),n.jsx(bt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>I(k),title:k.is_active?"Desativar":"Ativar",children:k.is_active?n.jsx(Iu,{className:"h-4 w-4 text-green-600"}):n.jsx(Mu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>F(k.id),children:n.jsx(ui,{className:"h-4 w-4 text-destructive"})})]})})]},k.id)})})]})})]}),n.jsx(tn,{open:o,onOpenChange:l,children:n.jsxs(Jr,{className:"sm:max-w-md",children:[n.jsx(ln,{children:n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(Dh,{className:"h-5 w-5"}),"Novo Cupom"]})}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Cdigo do Cupom *"}),n.jsx(et,{placeholder:"Ex: DESCONTO10",value:u,onChange:k=>h(k.target.value.toUpperCase()),className:"font-mono"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Tipo de Desconto *"}),n.jsxs(Xt,{value:f,onValueChange:k=>m(k),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsxs(Gt,{className:"bg-background z-50",children:[n.jsx(qe,{value:"percentage",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Uo,{className:"h-3 w-3"})," Porcentagem"]})}),n.jsx(qe,{value:"fixed",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ks,{className:"h-3 w-3"})," Valor fixo"]})})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Valor *"}),n.jsxs("div",{className:"relative",children:[n.jsx(et,{type:"number",min:"0",step:f==="percentage"?"1":"0.01",max:f==="percentage"?"100":void 0,value:p,onChange:k=>g(k.target.value),placeholder:f==="percentage"?"10":"15.00",className:"pr-8"}),n.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm",children:f==="percentage"?"%":"R$"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Data de Incio"}),n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("w-full justify-start text-left font-normal",!x&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),x?Wt(x,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Ga,{className:"w-auto p-0 bg-background z-50",align:"start",children:n.jsx(_i,{mode:"single",selected:x,onSelect:v,initialFocus:!0,className:"pointer-events-auto"})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Data de Fim"}),n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("w-full justify-start text-left font-normal",!y&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),y?Wt(y,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Ga,{className:"w-auto p-0 bg-background z-50",align:"start",children:n.jsx(_i,{mode:"single",selected:y,onSelect:b,initialFocus:!0,className:"pointer-events-auto"})})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"N Mximo de Usos"}),n.jsx(et,{type:"number",min:"1",value:j,onChange:k=>T(k.target.value),placeholder:"Ilimitado"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Pedido Mnimo (R$)"}),n.jsx(et,{type:"number",min:"0",step:"0.01",value:O,onChange:k=>R(k.target.value),placeholder:"Sem mnimo"})]})]})]}),n.jsxs(ba,{children:[n.jsx(he,{variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),n.jsx(he,{onClick:G,disabled:D,children:D?"Criando...":"Criar Cupom"})]})]})})]})}const ibe=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"],obe=["cancelado"],th=e=>ibe.includes(e.status)||e.payment_status==="approved",s0=e=>obe.includes(e.status);function lbe(e){const[t,r]=P.useState(null),[s,a]=P.useState(null),[i,o]=P.useState([]),[l,d]=P.useState([]),[c,u]=P.useState([]),[h,f]=P.useState([]),[m,p]=P.useState([]),[g,x]=P.useState(!0),{startDate:v,endDate:y,prevStartDate:b,prevEndDate:j}=P.useMemo(()=>{var Y,G;const O=new Date;let R,D,B,q;switch(e.period){case"today":R=Vn(O),D=Jn(O),B=Vn(fn(O,1)),q=Jn(fn(O,1));break;case"7days":R=Vn(fn(O,6)),D=Jn(O),B=Vn(fn(O,13)),q=Jn(fn(O,7));break;case"30days":R=Vn(fn(O,29)),D=Jn(O),B=Vn(fn(O,59)),q=Jn(fn(O,30));break;case"thisMonth":R=Cs(O),D=Jn(O),B=Cs(so(O,1)),q=lc(so(O,1));break;case"lastMonth":R=Cs(so(O,1)),D=lc(so(O,1)),B=Cs(so(O,2)),q=lc(so(O,2));break;case"custom":R=((Y=e.customDateRange)==null?void 0:Y.from)||Vn(O),D=((G=e.customDateRange)==null?void 0:G.to)||Jn(O);const I=Math.ceil((D.getTime()-R.getTime())/(1e3*60*60*24));B=fn(R,I),q=fn(D,I);break;default:R=Vn(O),D=Jn(O),B=Vn(fn(O,1)),q=Jn(fn(O,1))}return{startDate:R,endDate:D,prevStartDate:B,prevEndDate:q}},[e.period,e.customDateRange]),T=P.useCallback(async()=>{x(!0);try{const[O,R]=await Promise.all([le.from("sellers").select("id, name").eq("is_active",!0),le.from("live_events").select("id, titulo, data_hora_inicio").order("data_hora_inicio",{ascending:!1}).limit(20)]);f(O.data||[]),p(R.data||[]);let D=le.from("orders").select("*, order_items(*)").gte("created_at",v.toISOString()).lte("created_at",y.toISOString());e.channel==="catalog"?D=D.is("live_event_id",null):e.channel==="live"&&(D=D.not("live_event_id","is",null)),e.liveEventId&&(D=D.eq("live_event_id",e.liveEventId)),e.sellerId&&(D=D.eq("seller_id",e.sellerId));let B=le.from("orders").select("*, order_items(*)").gte("created_at",b.toISOString()).lte("created_at",j.toISOString());e.channel==="catalog"?B=B.is("live_event_id",null):e.channel==="live"&&(B=B.not("live_event_id","is",null)),e.liveEventId&&(B=B.eq("live_event_id",e.liveEventId)),e.sellerId&&(B=B.eq("seller_id",e.sellerId));const q=le.from("customers").select("*").order("total_spent",{ascending:!1}).limit(10),[Y,G,I]=await Promise.all([D,B,q]),F=Y.data||[],S=G.data||[],E=I.data||[];{const Ne=F.filter(Qe=>Qe.live_event_id),De=F.filter(Qe=>!Qe.live_event_id),Ge=F.filter(Qe=>th(Qe)).length;console.log("[Dashboard Debug] Query Info:",{dateRange:{start:v.toISOString(),end:y.toISOString()},filters:{channel:e.channel,liveEventId:e.liveEventId,sellerId:e.sellerId},results:{totalOrders:F.length,liveOrders:Ne.length,catalogOrders:De.length,paidOrders:Ge,previousPeriodOrders:S.length},warning:Ne.length===0&&e.channel!=="catalog"?" No Live orders found. Check if live_carts are being converted to orders.":null})}const N=Ne=>{const De=Ne.filter(nt=>!s0(nt)),Ge=Ne.filter(nt=>th(nt)),Qe=Ne.filter(nt=>s0(nt)),Ie=Ge.reduce((nt,vt)=>{const Ue=(vt.order_items||[]).reduce((Le,Ze)=>Ze.product_price===0?Le:Le+Ze.product_price*Ze.quantity,0);return nt+Ue},0),Ae=De.reduce((nt,vt)=>{const Ue=(vt.order_items||[]).reduce((Le,Ze)=>Ze.product_price===0?Le:Le+Ze.product_price*Ze.quantity,0);return nt+Ue},0),st=Ge.reduce((nt,vt)=>{const Je=vt.order_items||[];return nt+Je.filter(Ue=>Ue.product_price>0).reduce((Ue,Le)=>Ue+Le.quantity,0)},0);return{paidTotal:Ie,reservedTotal:Ae,paidCount:Ge.length,notCancelledCount:De.length,cancelledCount:Qe.length,totalPieces:st}},C=N(F),k=N(S),M=F.filter(Ne=>th(Ne)&&Ne.updated_at),U=M.length>0?M.reduce((Ne,De)=>{const Ge=Qd(De.created_at),Qe=Qd(De.updated_at);return Ne+OR(Qe,Ge)},0)/M.length:0,$=await wC({startDate:v,endDate:y,liveEventId:e.liveEventId,sellerId:e.sellerId});console.log("[Dashboard] Pending orders debug:",$.debug);const X=$.summary.map(Ne=>({id:Ne.type,type:Ne.type,title:Ne.title,count:Ne.count,value:Ne.value,severity:Ne.severity}));u(X);const Z=F.filter(Ne=>!Ne.live_event_id),re=F.filter(Ne=>Ne.live_event_id),W=Z.filter(Ne=>!s0(Ne)),J=re.filter(Ne=>!s0(Ne)),V=Z.filter(Ne=>th(Ne)),H=re.filter(Ne=>th(Ne)),ee=V.reduce((Ne,De)=>Ne+(De.total||0),0),ie=H.reduce((Ne,De)=>Ne+(De.total||0),0),oe=J.reduce((Ne,De)=>Ne+(De.total||0),0),se=new Set(V.map(Ne=>Ne.customer_id).filter(Boolean));a({catalog:{pago:ee,pedidosPagos:V.length,ticket:V.length>0?ee/V.length:0,conversao:W.length>0?V.length/W.length*100:0,clientesAtivos:se.size},live:{pago:ie,reservado:oe,pedidosPagos:H.length,ticket:H.length>0?ie/H.length:0,conversao:J.length>0?H.length/J.length*100:0,progressoPagamento:oe>0?ie/oe*100:0,lotesPendentes:J.filter(Ne=>!th(Ne)).length}});const ue=new Map,pe=new Map;(O.data||[]).forEach(Ne=>pe.set(Ne.id,Ne.name)),F.forEach(Ne=>{const De=Ne.seller_id;if(!De)return;const Ge=pe.get(De)||"Sem nome",Qe=ue.get(De)||{id:De,name:Ge,pedidosReservados:0,pedidosPagos:0,valorReservado:0,valorPago:0,tempoTotal:0};if(s0(Ne)||(Qe.pedidosReservados+=1,Qe.valorReservado+=Ne.total||0),th(Ne)&&(Qe.pedidosPagos+=1,Qe.valorPago+=Ne.total||0,Ne.updated_at)){const Ie=Qd(Ne.created_at),Ae=Qd(Ne.updated_at);Qe.tempoTotal+=OR(Ae,Ie)}ue.set(De,Qe)});const ce=Array.from(ue.values()).map(Ne=>{const De=Ne.pedidosReservados>0?Ne.pedidosPagos/Ne.pedidosReservados*100:0,Ge=Ne.pedidosPagos>0?Ne.valorPago/Ne.pedidosPagos:0,Qe=Ne.pedidosPagos>0?Ne.tempoTotal/Ne.pedidosPagos:0;return{id:Ne.id,name:Ne.name,pedidosReservados:Ne.pedidosReservados,pedidosPagos:Ne.pedidosPagos,conversao:De,valorPago:Ne.valorPago,ticketMedio:Ge,tempoMedioPagamento:Qe,badges:[],performanceScore:0}});if(ce.length>0){const Ne=Math.max(...ce.map(Je=>Je.valorPago),1),De=Math.max(...ce.map(Je=>Je.pedidosPagos),1),Ge=Math.max(...ce.map(Je=>Je.ticketMedio),1);ce.forEach(Je=>{const Ue=Je.valorPago/Ne,Le=Je.pedidosPagos/De,Ze=Je.ticketMedio/Ge,ct=Je.conversao/100;Je.performanceScore=ct*.4+Ue*.3+Le*.2+Ze*.1});const Qe=Math.max(...ce.map(Je=>Je.valorPago)),Ie=ce.filter(Je=>Je.pedidosReservados>=3||Je.valorPago>=300),Ae=Ie.length>0?Math.max(...Ie.map(Je=>Je.conversao)):0,st=Math.max(...ce.map(Je=>Je.pedidosPagos)),nt=Math.max(...ce.map(Je=>Je.ticketMedio)),vt=Math.min(...ce.filter(Je=>Je.pedidosPagos>0).map(Je=>Je.tempoMedioPagamento));ce.forEach(Je=>{Je.badges=[],Je.valorPago===Qe&&Qe>0&&Je.badges.push("maior_faturamento"),(Je.pedidosReservados>=3||Je.valorPago>=300)&&Je.conversao===Ae&&Ae>0&&Je.badges.push("maior_conversao"),Je.pedidosPagos===st&&st>0&&Je.badges.push("mais_pedidos"),Je.ticketMedio===nt&&nt>0&&Je.badges.push("maior_ticket"),Je.pedidosPagos>0&&Je.tempoMedioPagamento===vt&&vt<24&&Je.badges.push("velocidade")})}o(ce.sort((Ne,De)=>De.performanceScore-Ne.performanceScore));const ne=E.slice(0,5).map(Ne=>({id:Ne.id,name:Ne.name,instagram_handle:Ne.instagram_handle,totalGasto:Ne.total_spent||0,totalPedidos:Ne.total_orders||0,ultimaCompra:Ne.last_order_at}));d(ne);const me=(Ne,De)=>{const Ge=Ne-De,Qe=De>0?(Ne-De)/De*100:Ne>0?100:0;return{value:Ne,previousValue:De,change:Ge,changePercent:Qe}},ge=async(Ne,De)=>{const{count:Ge}=await le.from("customers").select("*",{count:"exact",head:!0}).gte("created_at",Ne.toISOString()).lte("created_at",De.toISOString());return Ge||0},[_e,be]=await Promise.all([ge(v,y),ge(b,j)]),ye=F.filter(Ne=>Ne.status==="cancelado").length,Oe=F.filter(Ne=>Ne.status!=="cancelado").length;r({faturamentoPago:me(C.paidTotal,k.paidTotal),reservado:me(C.reservedTotal,k.reservedTotal),conversao:me(C.reservedTotal>0?C.paidTotal/C.reservedTotal*100:0,k.reservedTotal>0?k.paidTotal/k.reservedTotal*100:0),ticketMedio:me(C.paidCount>0?C.paidTotal/C.paidCount:0,k.paidCount>0?k.paidTotal/k.paidCount:0),pecasAtendimento:me(C.paidCount>0?C.totalPieces/C.paidCount:0,k.paidCount>0?k.totalPieces/k.paidCount:0),pendenciasOperacionais:me(X.reduce((Ne,De)=>Ne+De.count,0),0),pedidosPagos:C.paidCount,pedidosPendentes:Oe-C.paidCount,cancelados:ye,novosClientes:me(_e,be),taxaCancelamento:Oe+ye>0?ye/(Oe+ye)*100:0})}catch(O){console.error("Error fetching dashboard data:",O)}finally{x(!1)}},[v,y,b,j,e.channel,e.sellerId,e.liveEventId]);return P.useEffect(()=>{T()},[T]),{kpis:t,channelComparison:s,sellerPerformance:i,topCustomers:l,pendingActions:c,sellers:h,liveEvents:m,isLoading:g,refetch:T,dateRange:{startDate:v,endDate:y}}}const cbe=[{value:"today",label:"Hoje"},{value:"7days",label:"ltimos 7 dias"},{value:"30days",label:"ltimos 30 dias"},{value:"thisMonth",label:"Este ms"},{value:"lastMonth",label:"Ms passado"},{value:"custom",label:"Personalizado"}],dbe=[{value:"all",label:"Todos os canais"},{value:"catalog",label:"Catlogo"},{value:"live",label:"Live"}];function ube({filters:e,onFiltersChange:t,sellers:r,liveEvents:s}){var c,u;const a=h=>{t({...e,period:h})},i=h=>{t({...e,channel:h,liveEventId:h!=="live"?null:e.liveEventId})},o=h=>{t({...e,sellerId:h==="all_sellers"?null:h})},l=h=>{t({...e,liveEventId:h==="all_lives"?null:h})},d=h=>{h.from&&h.to&&t({...e,period:"custom",customDateRange:{from:h.from,to:h.to}})};return n.jsx("div",{className:"sticky top-14 sm:top-16 z-40 bg-background/95 backdrop-blur border-b border-border py-2 sm:py-3 -mx-4 px-4 mb-4 sm:mb-6",children:n.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[n.jsx(Ru,{className:"h-4 w-4 text-muted-foreground hidden sm:block"}),n.jsxs(Xt,{value:e.period,onValueChange:a,children:[n.jsx(Ht,{className:"w-[130px] sm:w-[160px] h-8 sm:h-9 bg-card text-sm",children:n.jsx(Yt,{})}),n.jsx(Gt,{className:"bg-popover z-50",children:cbe.map(h=>n.jsx(qe,{value:h.value,children:h.label},h.value))})]}),e.period==="custom"&&n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 h-8 sm:h-9 text-sm",children:[n.jsx(ns,{className:"h-4 w-4"}),e.customDateRange?n.jsxs(n.Fragment,{children:[Wt(e.customDateRange.from,"dd/MM",{locale:mr})," - ",Wt(e.customDateRange.to,"dd/MM",{locale:mr})]}):"Selecionar datas"]})}),n.jsx(Ga,{className:"w-auto p-0 bg-popover z-50",align:"start",children:n.jsx(_i,{mode:"range",selected:{from:(c=e.customDateRange)==null?void 0:c.from,to:(u=e.customDateRange)==null?void 0:u.to},onSelect:h=>d(h||{}),numberOfMonths:2,className:He("p-3 pointer-events-auto")})})]}),n.jsx("div",{className:"h-6 w-px bg-border hidden sm:block"}),n.jsxs(Xt,{value:e.channel,onValueChange:i,children:[n.jsx(Ht,{className:"w-[120px] sm:w-[140px] h-8 sm:h-9 bg-card text-sm",children:n.jsx(Yt,{})}),n.jsx(Gt,{className:"bg-popover z-50",children:dbe.map(h=>n.jsx(qe,{value:h.value,children:h.label},h.value))})]}),(e.channel==="all"||e.channel==="live")&&s.length>0&&n.jsxs(Xt,{value:e.liveEventId||"all_lives",onValueChange:l,children:[n.jsx(Ht,{className:"w-[140px] sm:w-[180px] h-8 sm:h-9 bg-card text-sm",children:n.jsx(Yt,{placeholder:"Todas as lives"})}),n.jsxs(Gt,{className:"bg-popover z-50",children:[n.jsx(qe,{value:"all_lives",children:"Agrupar por perodo"}),s.map(h=>n.jsx(qe,{value:h.id,children:h.titulo},h.id))]})]}),n.jsx("div",{className:"h-6 w-px bg-border hidden sm:block"}),n.jsxs(Xt,{value:e.sellerId||"all_sellers",onValueChange:o,children:[n.jsx(Ht,{className:"w-[130px] sm:w-[160px] h-8 sm:h-9 bg-card text-sm",children:n.jsx(Yt,{placeholder:"Vendedoras"})}),n.jsxs(Gt,{className:"bg-popover z-50",children:[n.jsx(qe,{value:"all_sellers",children:"Todas vendedoras"}),r.map(h=>n.jsx(qe,{value:h.id,children:h.name},h.id))]})]})]})})}function hbe(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const uH=je.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),yg=()=>{const e=je.useContext(uH);if(!e)throw new Error("useDrawerContext must be used within a Drawer.Root");return e};hbe(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,-100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(-100%,0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(100%,0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,100%,0)}}@keyframes slideFromTop{from{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,-100%,0)}}@keyframes slideFromLeft{from{transform:translate3d(-100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(-100%,0,0)}}@keyframes slideFromRight{from{transform:translate3d(100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(100%,0,0)}}`);const fbe=24,mbe=typeof window<"u"?P.useLayoutEffect:P.useEffect;function XR(...e){return(...t)=>{for(let r of e)typeof r=="function"&&r(...t)}}function pbe(){return Jk(/^Mac/)}function gbe(){return Jk(/^iPhone/)}function YR(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function xbe(){return Jk(/^iPad/)||pbe()&&navigator.maxTouchPoints>1}function hH(){return gbe()||xbe()}function Jk(e){return typeof window<"u"&&window.navigator!=null?e.test(window.navigator.platform):void 0}const y3=typeof document<"u"&&window.visualViewport;function ZR(e){let t=window.getComputedStyle(e);return/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}function fH(e){for(ZR(e)&&(e=e.parentElement);e&&!ZR(e);)e=e.parentElement;return e||document.scrollingElement||document.documentElement}const vbe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let wy=0,b3;function ybe(e={}){let{isDisabled:t}=e;mbe(()=>{if(!t)return wy++,wy===1&&hH()&&(b3=bbe()),()=>{wy--,wy===0&&(b3==null||b3())}},[t])}function bbe(){let e,t=0,r=h=>{e=fH(h.target),!(e===document.documentElement&&e===document.body)&&(t=h.changedTouches[0].pageY)},s=h=>{if(!e||e===document.documentElement||e===document.body){h.preventDefault();return}let f=h.changedTouches[0].pageY,m=e.scrollTop,p=e.scrollHeight-e.clientHeight;p!==0&&((m<=0&&f>t||m>=p&&f<t)&&h.preventDefault(),t=f)},a=h=>{let f=h.target;_C(f)&&f!==document.activeElement&&(h.preventDefault(),f.style.transform="translateY(-2000px)",f.focus(),requestAnimationFrame(()=>{f.style.transform=""}))},i=h=>{let f=h.target;_C(f)&&(f.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{f.style.transform="",y3&&(y3.height<window.innerHeight?requestAnimationFrame(()=>{QR(f)}):y3.addEventListener("resize",()=>QR(f),{once:!0}))}))},o=()=>{window.scrollTo(0,0)},l=window.pageXOffset,d=window.pageYOffset,c=XR(wbe(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let u=XR(a0(document,"touchstart",r,{passive:!1,capture:!0}),a0(document,"touchmove",s,{passive:!1,capture:!0}),a0(document,"touchend",a,{passive:!1,capture:!0}),a0(document,"focus",i,!0),a0(window,"scroll",o));return()=>{c(),u(),window.scrollTo(l,d)}}function wbe(e,t,r){let s=e.style[t];return e.style[t]=r,()=>{e.style[t]=s}}function a0(e,t,r,s){return e.addEventListener(t,r,s),()=>{e.removeEventListener(t,r,s)}}function QR(e){let t=document.scrollingElement||document.documentElement;for(;e&&e!==t;){let r=fH(e);if(r!==document.documentElement&&r!==document.body&&r!==e){let s=r.getBoundingClientRect().top,a=e.getBoundingClientRect().top,i=e.getBoundingClientRect().bottom;const o=r.getBoundingClientRect().bottom+fbe;i>o&&(r.scrollTop+=a-s)}e=r.parentElement}}function _C(e){return e instanceof HTMLInputElement&&!vbe.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}function _be(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function jbe(...e){return t=>e.forEach(r=>_be(r,t))}function mH(...e){return P.useCallback(jbe(...e),e)}const pH=new WeakMap;function ia(e,t,r=!1){if(!e||!(e instanceof HTMLElement))return;let s={};Object.entries(t).forEach(([a,i])=>{if(a.startsWith("--")){e.style.setProperty(a,i);return}s[a]=e.style[a],e.style[a]=i}),!r&&pH.set(e,s)}function Nbe(e,t){if(!e||!(e instanceof HTMLElement))return;let r=pH.get(e);r&&(e.style[t]=r[t])}const la=e=>{switch(e){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return e}};function _y(e,t){if(!e)return null;const r=window.getComputedStyle(e),s=r.transform||r.webkitTransform||r.mozTransform;let a=s.match(/^matrix3d\((.+)\)$/);return a?parseFloat(a[1].split(", ")[la(t)?13:12]):(a=s.match(/^matrix\((.+)\)$/),a?parseFloat(a[1].split(", ")[la(t)?5:4]):null)}function Sbe(e){return 8*(Math.log(e+1)-2)}function w3(e,t){if(!e)return()=>{};const r=e.style.cssText;return Object.assign(e.style,t),()=>{e.style.cssText=r}}function Cbe(...e){return(...t)=>{for(const r of e)typeof r=="function"&&r(...t)}}const ys={DURATION:.5,EASE:[.32,.72,0,1]},gH=.4,Ebe=.25,kbe=100,xH=8,rh=16,jC=26,_3="vaul-dragging";function vH(e){const t=je.useRef(e);return je.useEffect(()=>{t.current=e}),je.useMemo(()=>(...r)=>t.current==null?void 0:t.current.call(t,...r),[])}function Abe({defaultProp:e,onChange:t}){const r=je.useState(e),[s]=r,a=je.useRef(s),i=vH(t);return je.useEffect(()=>{a.current!==s&&(i(s),a.current=s)},[s,a,i]),r}function yH({prop:e,defaultProp:t,onChange:r=()=>{}}){const[s,a]=Abe({defaultProp:t,onChange:r}),i=e!==void 0,o=i?e:s,l=vH(r),d=je.useCallback(c=>{if(i){const h=typeof c=="function"?c(e):c;h!==e&&l(h)}else a(c)},[i,e,a,l]);return[o,d]}function Tbe({activeSnapPointProp:e,setActiveSnapPointProp:t,snapPoints:r,drawerRef:s,overlayRef:a,fadeFromIndex:i,onSnapPointChange:o,direction:l="bottom",container:d,snapToSequentialPoint:c}){const[u,h]=yH({prop:e,defaultProp:r==null?void 0:r[0],onChange:t}),[f,m]=je.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);je.useEffect(()=>{function R(){m({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[]);const p=je.useMemo(()=>u===(r==null?void 0:r[r.length-1])||null,[r,u]),g=je.useMemo(()=>r==null?void 0:r.findIndex(R=>R===u),[r,u]),x=r&&r.length>0&&(i||i===0)&&!Number.isNaN(i)&&r[i]===u||!r,v=je.useMemo(()=>{const R=d?{width:d.getBoundingClientRect().width,height:d.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var D;return(D=r==null?void 0:r.map(B=>{const q=typeof B=="string";let Y=0;if(q&&(Y=parseInt(B,10)),la(l)){const I=q?Y:f?B*R.height:0;return f?l==="bottom"?R.height-I:-R.height+I:I}const G=q?Y:f?B*R.width:0;return f?l==="right"?R.width-G:-R.width+G:G}))!=null?D:[]},[r,f,d]),y=je.useMemo(()=>g!==null?v==null?void 0:v[g]:null,[v,g]),b=je.useCallback(R=>{var D;const B=(D=v==null?void 0:v.findIndex(q=>q===R))!=null?D:null;o(B),ia(s.current,{transition:`transform ${ys.DURATION}s cubic-bezier(${ys.EASE.join(",")})`,transform:la(l)?`translate3d(0, ${R}px, 0)`:`translate3d(${R}px, 0, 0)`}),v&&B!==v.length-1&&B!==i&&B<i?ia(a.current,{transition:`opacity ${ys.DURATION}s cubic-bezier(${ys.EASE.join(",")})`,opacity:"0"}):ia(a.current,{transition:`opacity ${ys.DURATION}s cubic-bezier(${ys.EASE.join(",")})`,opacity:"1"}),h(r==null?void 0:r[Math.max(B,0)])},[s.current,r,v,i,a,h]);je.useEffect(()=>{if(u||e){var R;const D=(R=r==null?void 0:r.findIndex(B=>B===e||B===u))!=null?R:-1;v&&D!==-1&&typeof v[D]=="number"&&b(v[D])}},[u,e,r,v,b]);function j({draggedDistance:R,closeDrawer:D,velocity:B,dismissible:q}){if(i===void 0)return;const Y=l==="bottom"||l==="right"?(y??0)-R:(y??0)+R,G=g===i-1,I=g===0,F=R>0;if(G&&ia(a.current,{transition:`opacity ${ys.DURATION}s cubic-bezier(${ys.EASE.join(",")})`}),!c&&B>2&&!F){q?D():b(v[0]);return}if(!c&&B>2&&F&&v&&r){b(v[r.length-1]);return}const S=v==null?void 0:v.reduce((N,C)=>typeof N!="number"||typeof C!="number"?N:Math.abs(C-Y)<Math.abs(N-Y)?C:N),E=la(l)?window.innerHeight:window.innerWidth;if(B>gH&&Math.abs(R)<E*.4){const N=F?1:-1;if(N>0&&p){b(v[r.length-1]);return}if(I&&N<0&&q&&D(),g===null)return;b(v[g+N]);return}b(S)}function T({draggedDistance:R}){if(y===null)return;const D=l==="bottom"||l==="right"?y-R:y+R;(l==="bottom"||l==="right")&&D<v[v.length-1]||(l==="top"||l==="left")&&D>v[v.length-1]||ia(s.current,{transform:la(l)?`translate3d(0, ${D}px, 0)`:`translate3d(${D}px, 0, 0)`})}function O(R,D){if(!r||typeof g!="number"||!v||i===void 0)return null;const B=g===i-1;if(g>=i&&D)return 0;if(B&&!D)return 1;if(!x&&!B)return null;const Y=B?g+1:g-1,G=B?v[Y]-v[Y-1]:v[Y+1]-v[Y],I=R/Math.abs(G);return B?1-I:I}return{isLastSnapPoint:p,activeSnapPoint:u,shouldFade:x,getPercentageDragged:O,setActiveSnapPoint:h,activeSnapPointIndex:g,onRelease:j,onDrag:T,snapPointsOffset:v}}const Pbe=()=>()=>{};function Obe(){const{direction:e,isOpen:t,shouldScaleBackground:r,setBackgroundColorOnScale:s,noBodyStyles:a}=yg(),i=je.useRef(null),o=P.useMemo(()=>document.body.style.backgroundColor,[]);function l(){return(window.innerWidth-jC)/window.innerWidth}je.useEffect(()=>{if(t&&r){i.current&&clearTimeout(i.current);const d=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!d)return;Cbe(s&&!a?w3(document.body,{background:"black"}):Pbe,w3(d,{transformOrigin:la(e)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${ys.DURATION}s`,transitionTimingFunction:`cubic-bezier(${ys.EASE.join(",")})`}));const c=w3(d,{borderRadius:`${xH}px`,overflow:"hidden",...la(e)?{transform:`scale(${l()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${l()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{c(),i.current=window.setTimeout(()=>{o?document.body.style.background=o:document.body.style.removeProperty("background")},ys.DURATION*1e3)}}},[t,r,o])}let i0=null;function Rbe({isOpen:e,modal:t,nested:r,hasBeenOpened:s,preventScrollRestoration:a,noBodyStyles:i}){const[o,l]=je.useState(()=>typeof window<"u"?window.location.href:""),d=je.useRef(0),c=je.useCallback(()=>{if(YR()&&i0===null&&e&&!i){i0={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:h,innerHeight:f}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-d.current}px`,left:`${-h}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const m=f-window.innerHeight;m&&d.current>=f&&(document.body.style.top=`${-(d.current+m)}px`)}),300)}},[e]),u=je.useCallback(()=>{if(YR()&&i0!==null&&!i){const h=-parseInt(document.body.style.top,10),f=-parseInt(document.body.style.left,10);Object.assign(document.body.style,i0),window.requestAnimationFrame(()=>{if(a&&o!==window.location.href){l(window.location.href);return}window.scrollTo(f,h)}),i0=null}},[o]);return je.useEffect(()=>{function h(){d.current=window.scrollY}return h(),window.addEventListener("scroll",h),()=>{window.removeEventListener("scroll",h)}},[]),je.useEffect(()=>{r||!s||(e?(!window.matchMedia("(display-mode: standalone)").matches&&c(),t||window.setTimeout(()=>{u()},500)):u())},[e,s,o,t,r,c,u]),{restorePositionSetting:u}}function bH({open:e,onOpenChange:t,children:r,onDrag:s,onRelease:a,snapPoints:i,shouldScaleBackground:o=!1,setBackgroundColorOnScale:l=!0,closeThreshold:d=Ebe,scrollLockTimeout:c=kbe,dismissible:u=!0,handleOnly:h=!1,fadeFromIndex:f=i&&i.length-1,activeSnapPoint:m,setActiveSnapPoint:p,fixed:g,modal:x=!0,onClose:v,nested:y,noBodyStyles:b,direction:j="bottom",defaultOpen:T=!1,disablePreventScroll:O=!0,snapToSequentialPoint:R=!1,preventScrollRestoration:D=!1,repositionInputs:B=!0,onAnimationEnd:q,container:Y,autoFocus:G=!1}){var I,F;const[S=!1,E]=yH({defaultProp:T,prop:e,onChange:ht=>{t==null||t(ht),!ht&&!y&&Ge(),setTimeout(()=>{q==null||q(ht)},ys.DURATION*1e3),ht&&!x&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),ht||(document.body.style.pointerEvents="auto")}}),[N,C]=je.useState(!1),[k,M]=je.useState(!1),[U,$]=je.useState(!1),X=je.useRef(null),Z=je.useRef(null),re=je.useRef(null),W=je.useRef(null),J=je.useRef(null),V=je.useRef(!1),H=je.useRef(null),ee=je.useRef(0),ie=je.useRef(!1),oe=je.useRef(0),se=je.useRef(null),ue=je.useRef(((I=se.current)==null?void 0:I.getBoundingClientRect().height)||0),pe=je.useRef(((F=se.current)==null?void 0:F.getBoundingClientRect().width)||0),ce=je.useRef(0),ne=je.useCallback(ht=>{i&&ht===ye.length-1&&(Z.current=new Date)},[]),{activeSnapPoint:me,activeSnapPointIndex:ge,setActiveSnapPoint:_e,onRelease:be,snapPointsOffset:ye,onDrag:Oe,shouldFade:Ne,getPercentageDragged:De}=Tbe({snapPoints:i,activeSnapPointProp:m,setActiveSnapPointProp:p,drawerRef:se,fadeFromIndex:f,overlayRef:X,onSnapPointChange:ne,direction:j,container:Y,snapToSequentialPoint:R});ybe({isDisabled:!S||k||!x||U||!N||!B||!O});const{restorePositionSetting:Ge}=Rbe({isOpen:S,modal:x,nested:y,hasBeenOpened:N,preventScrollRestoration:D,noBodyStyles:b});function Qe(){return(window.innerWidth-jC)/window.innerWidth}function Ie(ht){var yt,Re;!u&&!i||se.current&&!se.current.contains(ht.target)||(ue.current=((yt=se.current)==null?void 0:yt.getBoundingClientRect().height)||0,pe.current=((Re=se.current)==null?void 0:Re.getBoundingClientRect().width)||0,M(!0),re.current=new Date,hH()&&window.addEventListener("touchend",()=>V.current=!1,{once:!0}),ht.target.setPointerCapture(ht.pointerId),ee.current=la(j)?ht.pageY:ht.pageX)}function Ae(ht,yt){var Re,Ke;let _t=ht;const Rt=(Re=window.getSelection())==null?void 0:Re.toString(),Se=se.current?_y(se.current,j):null,tt=new Date;if(_t.hasAttribute("data-vaul-no-drag")||_t.closest("[data-vaul-no-drag]"))return!1;if(j==="right"||j==="left")return!0;if(Z.current&&tt.getTime()-Z.current.getTime()<500)return!1;if(Se!==null&&(j==="bottom"?Se>0:Se<0))return!0;if(Rt&&Rt.length>0)return!1;if(tt.getTime()-((Ke=J.current)==null?void 0:Ke.getTime())<c&&Se===0||yt)return J.current=tt,!1;for(;_t;){if(_t.scrollHeight>_t.clientHeight){if(_t.scrollTop!==0)return J.current=new Date,!1;if(_t.getAttribute("role")==="dialog")return!0}_t=_t.parentNode}return!0}function st(ht){if(se.current&&k){const yt=j==="bottom"||j==="right"?1:-1,Re=(ee.current-(la(j)?ht.pageY:ht.pageX))*yt,Ke=Re>0,_t=i&&!u&&!Ke;if(_t&&ge===0)return;const Rt=Math.abs(Re),Se=document.querySelector("[data-vaul-drawer-wrapper]"),tt=j==="bottom"||j==="top"?ue.current:pe.current;let ot=Rt/tt;const lt=De(Rt,Ke);if(lt!==null&&(ot=lt),_t&&ot>=1||!V.current&&!Ae(ht.target,Ke))return;if(se.current.classList.add(_3),V.current=!0,ia(se.current,{transition:"none"}),ia(X.current,{transition:"none"}),i&&Oe({draggedDistance:Re}),Ke&&!i){const Nt=Sbe(Re),ut=Math.min(Nt*-1,0)*yt;ia(se.current,{transform:la(j)?`translate3d(0, ${ut}px, 0)`:`translate3d(${ut}px, 0, 0)`});return}const At=1-ot;if((Ne||f&&ge===f-1)&&(s==null||s(ht,ot),ia(X.current,{opacity:`${At}`,transition:"none"},!0)),Se&&X.current&&o){const Nt=Math.min(Qe()+ot*(1-Qe()),1),ut=8-ot*8,lr=Math.max(0,14-ot*14);ia(Se,{borderRadius:`${ut}px`,transform:la(j)?`scale(${Nt}) translate3d(0, ${lr}px, 0)`:`scale(${Nt}) translate3d(${lr}px, 0, 0)`,transition:"none"},!0)}if(!i){const Nt=Rt*yt;ia(se.current,{transform:la(j)?`translate3d(0, ${Nt}px, 0)`:`translate3d(${Nt}px, 0, 0)`})}}}je.useEffect(()=>{var ht;function yt(){if(!se.current||!B)return;const Re=document.activeElement;if(_C(Re)||ie.current){var Ke;const _t=((Ke=window.visualViewport)==null?void 0:Ke.height)||0,Rt=window.innerHeight;let Se=Rt-_t;const tt=se.current.getBoundingClientRect().height||0,ot=tt>Rt*.8;ce.current||(ce.current=tt);const lt=se.current.getBoundingClientRect().top;if(Math.abs(oe.current-Se)>60&&(ie.current=!ie.current),i&&i.length>0&&ye&&ge){const At=ye[ge]||0;Se+=At}if(oe.current=Se,tt>_t||ie.current){const At=se.current.getBoundingClientRect().height;let Nt=At;At>_t&&(Nt=_t-(ot?lt:jC)),g?se.current.style.height=`${At-Math.max(Se,0)}px`:se.current.style.height=`${Math.max(Nt,_t-lt)}px`}else se.current.style.height=`${ce.current}px`;i&&i.length>0&&!ie.current?se.current.style.bottom="0px":se.current.style.bottom=`${Math.max(Se,0)}px`}}return(ht=window.visualViewport)==null||ht.addEventListener("resize",yt),()=>{var Re;return(Re=window.visualViewport)==null?void 0:Re.removeEventListener("resize",yt)}},[ge,i,ye]);function nt(ht){Je(),v==null||v(),ht||E(!1),setTimeout(()=>{i&&_e(i[0])},ys.DURATION*1e3)}function vt(){if(!se.current)return;const ht=document.querySelector("[data-vaul-drawer-wrapper]"),yt=_y(se.current,j);ia(se.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${ys.DURATION}s cubic-bezier(${ys.EASE.join(",")})`}),ia(X.current,{transition:`opacity ${ys.DURATION}s cubic-bezier(${ys.EASE.join(",")})`,opacity:"1"}),o&&yt&&yt>0&&S&&ia(ht,{borderRadius:`${xH}px`,overflow:"hidden",...la(j)?{transform:`scale(${Qe()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${Qe()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${ys.DURATION}s`,transitionTimingFunction:`cubic-bezier(${ys.EASE.join(",")})`},!0)}function Je(){!k||!se.current||(se.current.classList.remove(_3),V.current=!1,M(!1),W.current=new Date)}function Ue(ht){if(!k||!se.current)return;se.current.classList.remove(_3),V.current=!1,M(!1),W.current=new Date;const yt=_y(se.current,j);if(!Ae(ht.target,!1)||!yt||Number.isNaN(yt)||re.current===null)return;const Re=W.current.getTime()-re.current.getTime(),Ke=ee.current-(la(j)?ht.pageY:ht.pageX),_t=Math.abs(Ke)/Re;if(_t>.05&&($(!0),setTimeout(()=>{$(!1)},200)),i){be({draggedDistance:Ke*(j==="bottom"||j==="right"?1:-1),closeDrawer:nt,velocity:_t,dismissible:u}),a==null||a(ht,!0);return}if(j==="bottom"||j==="right"?Ke>0:Ke<0){vt(),a==null||a(ht,!0);return}if(_t>gH){nt(),a==null||a(ht,!1);return}var Rt;const Se=Math.min((Rt=se.current.getBoundingClientRect().height)!=null?Rt:0,window.innerHeight);var tt;const ot=Math.min((tt=se.current.getBoundingClientRect().width)!=null?tt:0,window.innerWidth),lt=j==="left"||j==="right";if(Math.abs(yt)>=(lt?ot:Se)*d){nt(),a==null||a(ht,!1);return}a==null||a(ht,!0),vt()}je.useEffect(()=>(S&&(ia(document.documentElement,{scrollBehavior:"auto"}),Z.current=new Date),()=>{Nbe(document.documentElement,"scrollBehavior")}),[S]);function Le(ht){const yt=ht?(window.innerWidth-rh)/window.innerWidth:1,Re=ht?-rh:0;H.current&&window.clearTimeout(H.current),ia(se.current,{transition:`transform ${ys.DURATION}s cubic-bezier(${ys.EASE.join(",")})`,transform:`scale(${yt}) translate3d(0, ${Re}px, 0)`}),!ht&&se.current&&(H.current=setTimeout(()=>{const Ke=_y(se.current,j);ia(se.current,{transition:"none",transform:la(j)?`translate3d(0, ${Ke}px, 0)`:`translate3d(${Ke}px, 0, 0)`})},500))}function Ze(ht,yt){if(yt<0)return;const Re=(window.innerWidth-rh)/window.innerWidth,Ke=Re+yt*(1-Re),_t=-rh+yt*rh;ia(se.current,{transform:la(j)?`scale(${Ke}) translate3d(0, ${_t}px, 0)`:`scale(${Ke}) translate3d(${_t}px, 0, 0)`,transition:"none"})}function ct(ht,yt){const Re=la(j)?window.innerHeight:window.innerWidth,Ke=yt?(Re-rh)/Re:1,_t=yt?-rh:0;yt&&ia(se.current,{transition:`transform ${ys.DURATION}s cubic-bezier(${ys.EASE.join(",")})`,transform:la(j)?`scale(${Ke}) translate3d(0, ${_t}px, 0)`:`scale(${Ke}) translate3d(${_t}px, 0, 0)`})}return je.createElement(r1,{defaultOpen:T,onOpenChange:ht=>{!u&&!ht||(ht?C(!0):nt(!0),E(ht))},open:S},je.createElement(uH.Provider,{value:{activeSnapPoint:me,snapPoints:i,setActiveSnapPoint:_e,drawerRef:se,overlayRef:X,onOpenChange:t,onPress:Ie,onRelease:Ue,onDrag:st,dismissible:u,handleOnly:h,isOpen:S,isDragging:k,shouldFade:Ne,closeDrawer:nt,onNestedDrag:Ze,onNestedOpenChange:Le,onNestedRelease:ct,keyboardIsOpen:ie,modal:x,snapPointsOffset:ye,direction:j,shouldScaleBackground:o,setBackgroundColorOnScale:l,noBodyStyles:b,container:Y,autoFocus:G}},r))}const wH=je.forwardRef(function({...e},t){const{overlayRef:r,snapPoints:s,onRelease:a,shouldFade:i,isOpen:o,modal:l}=yg(),d=mH(t,r),c=s&&s.length>0;return l?je.createElement(wf,{onMouseUp:a,ref:d,"data-vaul-overlay":"","data-vaul-snap-points":o&&c?"true":"false","data-vaul-snap-points-overlay":o&&i?"true":"false",...e}):(typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),null)});wH.displayName="Drawer.Overlay";const _H=je.forwardRef(function({onPointerDownOutside:e,style:t,onOpenAutoFocus:r,...s},a){const{drawerRef:i,onPress:o,onRelease:l,onDrag:d,keyboardIsOpen:c,snapPointsOffset:u,modal:h,isOpen:f,direction:m,snapPoints:p,container:g,handleOnly:x,autoFocus:v}=yg(),[y,b]=je.useState(!1),j=mH(a,i),T=je.useRef(null),O=je.useRef(null),R=je.useRef(!1),D=p&&p.length>0;Obe();const B=(Y,G,I=0)=>{if(R.current)return!0;const F=Math.abs(Y.y),S=Math.abs(Y.x),E=S>F,N=["bottom","right"].includes(G)?1:-1;if(G==="left"||G==="right"){if(!(Y.x*N<0)&&S>=0&&S<=I)return E}else if(!(Y.y*N<0)&&F>=0&&F<=I)return!E;return R.current=!0,!0};je.useEffect(()=>{D&&window.requestAnimationFrame(()=>{b(!0)})},[]);function q(Y){T.current=null,R.current=!1,l(Y)}return je.createElement(_f,{"data-vaul-drawer-direction":m,"data-vaul-drawer":"","data-vaul-delayed-snap-points":y?"true":"false","data-vaul-snap-points":f&&D?"true":"false","data-vaul-custom-container":g?"true":"false",...s,ref:j,style:u&&u.length>0?{"--snap-point-height":`${u[0]}px`,...t}:t,onPointerDown:Y=>{x||(s.onPointerDown==null||s.onPointerDown.call(s,Y),T.current={x:Y.pageX,y:Y.pageY},o(Y))},onOpenAutoFocus:Y=>{r==null||r(Y),v||Y.preventDefault()},onPointerDownOutside:Y=>{if(e==null||e(Y),!h||Y.defaultPrevented){Y.preventDefault();return}c.current&&(c.current=!1)},onFocusOutside:Y=>{if(!h){Y.preventDefault();return}},onPointerMove:Y=>{if(O.current=Y,x||(s.onPointerMove==null||s.onPointerMove.call(s,Y),!T.current))return;const G=Y.pageY-T.current.y,I=Y.pageX-T.current.x,F=Y.pointerType==="touch"?10:2;B({x:I,y:G},m,F)?d(Y):(Math.abs(I)>F||Math.abs(G)>F)&&(T.current=null)},onPointerUp:Y=>{s.onPointerUp==null||s.onPointerUp.call(s,Y),T.current=null,R.current=!1,l(Y)},onPointerOut:Y=>{s.onPointerOut==null||s.onPointerOut.call(s,Y),q(O.current)},onContextMenu:Y=>{s.onContextMenu==null||s.onContextMenu.call(s,Y),q(O.current)}})});_H.displayName="Drawer.Content";const Mbe=250,Ibe=120,jH=je.forwardRef(function({preventCycle:e=!1,children:t,...r},s){const{closeDrawer:a,isDragging:i,snapPoints:o,activeSnapPoint:l,setActiveSnapPoint:d,dismissible:c,handleOnly:u,isOpen:h,onPress:f,onDrag:m}=yg(),p=je.useRef(null),g=je.useRef(!1);function x(){if(g.current){b();return}window.setTimeout(()=>{v()},Ibe)}function v(){if(i||e||g.current){b();return}if(b(),(!o||o.length===0)&&c){a();return}if(l===o[o.length-1]&&c){a();return}const T=o.findIndex(R=>R===l);if(T===-1)return;const O=o[T+1];d(O)}function y(){p.current=window.setTimeout(()=>{g.current=!0},Mbe)}function b(){window.clearTimeout(p.current),g.current=!1}return je.createElement("div",{onClick:x,onPointerCancel:b,onPointerDown:j=>{u&&f(j),y()},onPointerMove:j=>{u&&m(j)},ref:s,"data-vaul-drawer-visible":h?"true":"false","data-vaul-handle":"","aria-hidden":"true",...r},je.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},t))});jH.displayName="Drawer.Handle";function Dbe({onDrag:e,onOpenChange:t,...r}){const{onNestedDrag:s,onNestedOpenChange:a,onNestedRelease:i}=yg();if(!s)throw new Error("Drawer.NestedRoot must be placed in another drawer");return je.createElement(bH,{nested:!0,onClose:()=>{a(!1)},onDrag:(o,l)=>{s(o,l),e==null||e(o,l)},onOpenChange:o=>{o&&a(o)},onRelease:i,...r})}function Lbe(e){const t=yg(),{container:r=t.container,...s}=e;return je.createElement(n1,{container:r,...s})}const Ml={Root:bH,NestedRoot:Dbe,Content:_H,Overlay:wH,Trigger:w_,Portal:Lbe,Handle:jH,Close:s1,Title:og,Description:lg},NH=({shouldScaleBackground:e=!0,...t})=>n.jsx(Ml.Root,{shouldScaleBackground:e,...t});NH.displayName="Drawer";const Bbe=Ml.Trigger,$be=Ml.Portal,Fbe=Ml.Close,SH=P.forwardRef(({className:e,...t},r)=>n.jsx(Ml.Overlay,{ref:r,className:He("fixed inset-0 z-50 bg-black/80",e),...t}));SH.displayName=Ml.Overlay.displayName;const CH=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs($be,{children:[n.jsx(SH,{}),n.jsxs(Ml.Content,{ref:s,className:He("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto max-h-[85vh] flex-col rounded-t-[10px] border bg-background overflow-hidden",e),...r,children:[n.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted shrink-0"}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:t})]})]}));CH.displayName="DrawerContent";const EH=({className:e,...t})=>n.jsx("div",{className:He("grid gap-1.5 p-4 text-center sm:text-left",e),...t});EH.displayName="DrawerHeader";const kH=({className:e,...t})=>n.jsx("div",{className:He("mt-auto flex flex-col gap-2 p-4",e),...t});kH.displayName="DrawerFooter";const AH=P.forwardRef(({className:e,...t},r)=>n.jsx(Ml.Title,{ref:r,className:He("text-lg font-semibold leading-none tracking-tight",e),...t}));AH.displayName=Ml.Title.displayName;const zbe=P.forwardRef(({className:e,...t},r)=>n.jsx(Ml.Description,{ref:r,className:He("text-sm text-muted-foreground",e),...t}));zbe.displayName=Ml.Description.displayName;const JR=[{value:"today",label:"Hoje"},{value:"7days",label:"ltimos 7 dias"},{value:"30days",label:"ltimos 30 dias"},{value:"thisMonth",label:"Este ms"},{value:"lastMonth",label:"Ms passado"},{value:"custom",label:"Personalizado"}],Ube=[{value:"all",label:"Todos os canais"},{value:"catalog",label:"Catlogo"},{value:"live",label:"Live"}];function Vbe({filters:e,onFiltersChange:t,sellers:r,liveEvents:s}){var p,g,x,v,y;const[a,i]=P.useState(!1),[o,l]=P.useState(e),[d,c]=P.useState(!1),u=()=>{t(o),i(!1)},h=()=>{const b={period:"7days",channel:"all",liveEventId:null,sellerId:null};l(b),t(b),i(!1)},f=[e.period!=="7days",e.channel!=="all",e.sellerId!==null,e.liveEventId!==null].filter(Boolean).length,m=((p=JR.find(b=>b.value===e.period))==null?void 0:p.label)||"Perodo";return n.jsxs(NH,{open:a,onOpenChange:i,children:[n.jsx(Bbe,{asChild:!0,children:n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 h-9",children:[n.jsx(Ru,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden xs:inline",children:m}),f>0&&n.jsx(ke,{variant:"secondary",className:"h-5 w-5 p-0 flex items-center justify-center text-xs",children:f})]})}),n.jsxs(CH,{className:"max-h-[85vh]",children:[n.jsx(EH,{className:"border-b pb-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(AH,{children:"Filtros"}),n.jsx(Fbe,{asChild:!0,children:n.jsx(he,{variant:"ghost",size:"icon",children:n.jsx(sn,{className:"h-5 w-5"})})})]})}),n.jsxs("div",{className:"p-4 space-y-6 overflow-y-auto flex-1",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{className:"text-sm font-medium",children:"Perodo"}),n.jsxs(Xt,{value:o.period,onValueChange:b=>{l({...o,period:b}),b==="custom"&&c(!0)},children:[n.jsx(Ht,{className:"w-full h-12",children:n.jsx(Yt,{})}),n.jsx(Gt,{children:JR.map(b=>n.jsx(qe,{value:b.value,children:b.label},b.value))})]})]}),o.period==="custom"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{className:"text-sm font-medium",children:"Intervalo de datas"}),n.jsx("div",{className:"border rounded-lg p-2",children:n.jsx(_i,{mode:"range",selected:{from:(g=o.customDateRange)==null?void 0:g.from,to:(x=o.customDateRange)==null?void 0:x.to},onSelect:b=>{b!=null&&b.from&&(b!=null&&b.to)&&l({...o,customDateRange:{from:b.from,to:b.to}})},numberOfMonths:1,className:"pointer-events-auto"})}),((v=o.customDateRange)==null?void 0:v.from)&&((y=o.customDateRange)==null?void 0:y.to)&&n.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:[Wt(o.customDateRange.from,"dd/MM/yyyy",{locale:mr})," -"," ",Wt(o.customDateRange.to,"dd/MM/yyyy",{locale:mr})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{className:"text-sm font-medium",children:"Canal"}),n.jsxs(Xt,{value:o.channel,onValueChange:b=>l({...o,channel:b,liveEventId:b!=="live"?null:o.liveEventId}),children:[n.jsx(Ht,{className:"w-full h-12",children:n.jsx(Yt,{})}),n.jsx(Gt,{children:Ube.map(b=>n.jsx(qe,{value:b.value,children:b.label},b.value))})]})]}),(o.channel==="all"||o.channel==="live")&&s.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{className:"text-sm font-medium",children:"Live"}),n.jsxs(Xt,{value:o.liveEventId||"all_lives",onValueChange:b=>l({...o,liveEventId:b==="all_lives"?null:b}),children:[n.jsx(Ht,{className:"w-full h-12",children:n.jsx(Yt,{placeholder:"Todas as lives"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all_lives",children:"Todas as lives"}),s.map(b=>n.jsx(qe,{value:b.id,children:b.titulo},b.id))]})]})]}),r.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{className:"text-sm font-medium",children:"Vendedora"}),n.jsxs(Xt,{value:o.sellerId||"all_sellers",onValueChange:b=>l({...o,sellerId:b==="all_sellers"?null:b}),children:[n.jsx(Ht,{className:"w-full h-12",children:n.jsx(Yt,{placeholder:"Todas as vendedoras"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all_sellers",children:"Todas as vendedoras"}),r.map(b=>n.jsx(qe,{value:b.id,children:b.name},b.id))]})]})]})]}),n.jsxs(kH,{className:"border-t pt-4 gap-2",children:[n.jsxs(he,{onClick:u,className:"w-full h-12 gap-2",children:[n.jsx(gn,{className:"h-4 w-4"}),"Aplicar Filtros"]}),n.jsx(he,{variant:"outline",onClick:h,className:"w-full h-12",children:"Limpar Filtros"})]})]})]})}const j3=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),NC=e=>`${e.toFixed(1)}%`,qbe=(e,t=1)=>e.toFixed(t);function Kf({icon:e,label:t,value:r,kpi:s,tooltip:a,onClick:i,variant:o="default"}){const l=s.changePercent>0,d=s.changePercent<0,c=l?Vs:d?Sx:null,u={default:"bg-card hover:bg-card/80",success:"bg-primary/5 hover:bg-primary/10 border-primary/20",warning:"bg-amber-50 hover:bg-amber-100/50 border-amber-200",muted:"bg-muted/50 hover:bg-muted"}[o];return n.jsx(dp,{children:n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsx($e,{className:He("cursor-pointer transition-all group border min-h-[100px]",u),onClick:i,children:n.jsxs(Fe,{className:"p-3 sm:p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1 sm:mb-2",children:[n.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 min-w-0",children:[n.jsx(e,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-muted-foreground shrink-0"}),n.jsx("span",{className:"text-[10px] sm:text-xs font-medium text-muted-foreground uppercase tracking-wide truncate",children:t})]}),n.jsx(Jne,{className:"h-3 w-3 text-muted-foreground/50 shrink-0 hidden sm:block"})]}),n.jsx("p",{className:"text-lg sm:text-2xl font-semibold text-foreground tracking-tight truncate",children:r}),c&&s.changePercent!==0&&n.jsxs("div",{className:He("flex items-center gap-1 mt-1 text-[10px] sm:text-xs font-medium",l?"text-primary":"text-destructive"),children:[n.jsx(c,{className:"h-3 w-3 shrink-0"}),n.jsxs("span",{className:"truncate",children:[l?"+":"",NC(s.changePercent)]}),n.jsx("span",{className:"text-muted-foreground font-normal hidden sm:inline",children:"vs anterior"})]})]})})}),n.jsx(Sa,{side:"bottom",className:"max-w-xs",children:n.jsx("p",{className:"text-xs",children:a})})]})})}function Wbe({kpis:e,onKPIClick:t}){return n.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-2 sm:gap-3",children:[n.jsx(Kf,{icon:ks,label:"Faturamento",value:j3(e.faturamentoPago.value),kpi:e.faturamentoPago,tooltip:"Soma de pedidos com pagamento confirmado. Exclui brindes (R$0).",onClick:()=>t("faturamento"),variant:"success"}),n.jsx(Kf,{icon:hn,label:"Reservado",value:j3(e.reservado.value),kpi:e.reservado,tooltip:"Soma de pedidos ativos (no cancelados), independente de pagamento.",onClick:()=>t("reservado")}),n.jsx(Kf,{icon:li,label:"Converso",value:NC(e.conversao.value),kpi:e.conversao,tooltip:"Pago  Reservado (em R$). Mede eficincia de fechamento.",onClick:()=>t("conversao")}),n.jsx(Kf,{icon:ks,label:"Ticket",value:j3(e.ticketMedio.value),kpi:e.ticketMedio,tooltip:"Faturamento Pago  N de pedidos pagos.",onClick:()=>t("ticket")}),n.jsx(Kf,{icon:Vt,label:"P.A.",value:qbe(e.pecasAtendimento.value),kpi:e.pecasAtendimento,tooltip:"Peas por Atendimento: itens pagos (sem brinde)  n de pedidos pagos.",onClick:()=>t("pa")}),n.jsx(Kf,{icon:Or,label:"Pendncias",value:e.pendenciasOperacionais.value.toString(),kpi:e.pendenciasOperacionais,tooltip:"Pedidos que exigem ao imediata (cobrar, postar, validar, etc.).",onClick:()=>t("pendencias"),variant:e.pendenciasOperacionais.value>0?"warning":"muted"})]}),n.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 sm:pb-0 sm:grid sm:grid-cols-3 md:grid-cols-5 sm:overflow-visible -mx-4 px-4 sm:mx-0 sm:px-0",children:[n.jsx($e,{className:"bg-card/50 cursor-pointer hover:bg-card transition-colors shrink-0 w-[140px] sm:w-auto",onClick:()=>t("pagos"),children:n.jsx(Fe,{className:"p-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:"Pagos"}),n.jsx("span",{className:"text-base sm:text-lg font-semibold text-primary",children:e.pedidosPagos})]})})}),n.jsx($e,{className:"bg-card/50 cursor-pointer hover:bg-card transition-colors shrink-0 w-[140px] sm:w-auto",onClick:()=>t("pendentes"),children:n.jsx(Fe,{className:"p-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:"Pendentes"}),n.jsx("span",{className:"text-base sm:text-lg font-semibold text-amber-600",children:e.pedidosPendentes})]})})}),n.jsx($e,{className:"bg-card/50 cursor-pointer hover:bg-card transition-colors shrink-0 w-[140px] sm:w-auto",onClick:()=>t("cancelados"),children:n.jsx(Fe,{className:"p-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:"Cancelados"}),n.jsx("span",{className:"text-base sm:text-lg font-semibold text-destructive",children:e.cancelados})]})})}),n.jsx($e,{className:"bg-card/50 cursor-pointer hover:bg-card transition-colors shrink-0 w-[140px] sm:w-auto",onClick:()=>t("ticket"),children:n.jsx(Fe,{className:"p-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Kb,{className:"h-3 w-3 text-muted-foreground"}),n.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:"Novos Cli."})]}),n.jsxs("span",{className:"text-base sm:text-lg font-semibold",children:[e.novosClientes.value,e.novosClientes.change>0&&n.jsxs("span",{className:"text-xs text-primary ml-1",children:["+",e.novosClientes.change]})]})]})})}),n.jsx($e,{className:"bg-card/50 shrink-0 w-[140px] sm:w-auto",children:n.jsx(Fe,{className:"p-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:"Cancelam."}),n.jsx("span",{className:He("text-base sm:text-lg font-semibold",e.taxaCancelamento>10?"text-destructive":"text-muted-foreground"),children:NC(e.taxaCancelamento)})]})})})]})]})}const o0=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),N3=e=>`${e.toFixed(1)}%`;function nh({label:e,value:t,highlight:r,icon:s,onClick:a}){return n.jsxs("div",{className:`flex items-center justify-between py-2 border-b border-border/30 last:border-0 ${a?"cursor-pointer hover:bg-muted/50 -mx-1 px-1 rounded transition-colors":""}`,onClick:a,children:[n.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1.5",children:[s,e]}),n.jsx("span",{className:`text-sm font-medium ${r?"text-primary":""}`,children:t})]})}function Hbe({data:e}){const t=pr();return n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[n.jsxs($e,{className:"cursor-pointer hover:shadow-md transition-all group bg-gradient-to-br from-stone-50 to-stone-100/50 border-stone-200",onClick:()=>t(Bs.catalogAll()),children:[n.jsx(Dt,{className:"pb-2 sm:pb-3 p-3 sm:p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"p-1.5 rounded-md bg-stone-200/60",children:n.jsx(fa,{className:"h-4 w-4 text-stone-600"})}),n.jsx(Lt,{className:"text-sm sm:text-base font-semibold text-stone-700",children:"Catlogo"})]}),n.jsx(hs,{className:"h-4 w-4 text-stone-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),n.jsxs(Fe,{className:"pt-0 p-3 sm:p-6 sm:pt-0",children:[n.jsxs("div",{className:"mb-3 sm:mb-4 cursor-pointer hover:opacity-80 transition-opacity",onClick:r=>{r.stopPropagation(),t(Bs.catalogPagos())},children:[n.jsx("p",{className:"text-xl sm:text-2xl font-semibold text-stone-800",children:o0(e.catalog.pago)}),n.jsx("p",{className:"text-[10px] sm:text-xs text-stone-500",children:"Faturamento Pago"})]}),n.jsxs("div",{className:"space-y-0.5 text-sm",children:[n.jsx(nh,{label:"Pedidos Pagos",value:e.catalog.pedidosPagos.toString(),onClick:()=>t(Bs.catalogPagos())}),n.jsx(nh,{label:"Ticket Mdio",value:o0(e.catalog.ticket)}),n.jsx(nh,{label:"Converso",value:N3(e.catalog.conversao)}),n.jsx(nh,{label:"Clientes",value:e.catalog.clientesAtivos.toString(),icon:n.jsx(Ha,{className:"h-3 w-3"})})]}),n.jsx("div",{className:"mt-3 sm:mt-4 pt-2 sm:pt-3 border-t border-stone-200",children:n.jsxs("span",{className:"text-[10px] sm:text-xs text-stone-500 flex items-center gap-1",children:[n.jsx(hs,{className:"h-3 w-3"})," Ver pedidos"]})})]})]}),n.jsxs($e,{className:"cursor-pointer hover:shadow-md transition-all group bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20",onClick:()=>t(Bs.liveAll()),children:[n.jsx(Dt,{className:"pb-2 sm:pb-3 p-3 sm:p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"p-1.5 rounded-md bg-primary/15",children:n.jsx(Ss,{className:"h-4 w-4 text-primary"})}),n.jsx(Lt,{className:"text-sm sm:text-base font-semibold text-foreground",children:"Live Shop"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[e.live.lotesPendentes>0&&n.jsxs(ke,{variant:"outline",className:"text-[10px] sm:text-xs border-amber-300 text-amber-700 bg-amber-50 px-1.5 py-0 cursor-pointer hover:bg-amber-100",onClick:r=>{r.stopPropagation(),t(Bs.livePendentes())},children:[e.live.lotesPendentes," a cobrar"]}),n.jsx(hs,{className:"h-4 w-4 text-primary/50 opacity-0 group-hover:opacity-100 transition-opacity"})]})]})}),n.jsxs(Fe,{className:"pt-0 p-3 sm:p-6 sm:pt-0",children:[n.jsxs("div",{className:"mb-3 sm:mb-4 flex items-end gap-3 sm:gap-4",children:[n.jsxs("div",{className:"cursor-pointer hover:opacity-80 transition-opacity",onClick:r=>{r.stopPropagation(),t(Bs.livePagos())},children:[n.jsx("p",{className:"text-xl sm:text-2xl font-semibold text-primary",children:o0(e.live.pago)}),n.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"Faturamento Pago"})]}),n.jsxs("div",{className:"text-right cursor-pointer hover:opacity-80 transition-opacity",onClick:r=>{r.stopPropagation(),t(Bs.livePendentes())},children:[n.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:o0(e.live.reservado)}),n.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"Reservado"})]})]}),n.jsxs("div",{className:"mb-2 sm:mb-3",children:[n.jsxs("div",{className:"flex justify-between text-[10px] sm:text-xs text-muted-foreground mb-1",children:[n.jsx("span",{children:"Pagamento"}),n.jsx("span",{className:"font-medium",children:N3(e.live.progressoPagamento)})]}),n.jsx(dg,{value:e.live.progressoPagamento,className:"h-1.5 sm:h-2"})]}),n.jsxs("div",{className:"space-y-0.5 text-sm",children:[n.jsx(nh,{label:"Pedidos Pagos",value:e.live.pedidosPagos.toString(),onClick:()=>t(Bs.livePagos())}),n.jsx(nh,{label:"Ticket Mdio",value:o0(e.live.ticket)}),n.jsx(nh,{label:"Converso",value:N3(e.live.conversao),icon:n.jsx(Vs,{className:"h-3 w-3"})})]}),n.jsx("div",{className:"mt-3 sm:mt-4 pt-2 sm:pt-3 border-t border-primary/10",children:n.jsxs("span",{className:"text-[10px] sm:text-xs text-primary/70 flex items-center gap-1",children:[n.jsx(hs,{className:"h-3 w-3"})," Ver pedidos"]})})]})]})]})}const jy=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),eM=e=>`${e.toFixed(1)}%`,Gbe={maior_faturamento:{icon:ks,label:"Maior Faturamento",color:"bg-primary/10 text-primary border-primary/30"},maior_conversao:{icon:li,label:"Maior Converso",color:"bg-emerald-50 text-emerald-700 border-emerald-200"},mais_pedidos:{icon:hn,label:"Mais Pedidos",color:"bg-blue-50 text-blue-700 border-blue-200"},maior_ticket:{icon:sz,label:"Maior Ticket",color:"bg-violet-50 text-violet-700 border-violet-200"},velocidade:{icon:Vi,label:"Mais Rpida",color:"bg-amber-50 text-amber-700 border-amber-200"}};function Kbe({sellers:e}){const[t,r]=P.useState("valorPago"),[s,a]=P.useState(!1),i=c=>{t===c?a(!s):(r(c),a(!1))},o=[...e].sort((c,u)=>{const h=c[t]-u[t];return s?h:-h}),l=c=>c.length===0?null:n.jsx("div",{className:"flex flex-wrap gap-1",children:c.map(u=>{const h=Gbe[u],f=h.icon;return n.jsx(dp,{children:n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsx(ke,{variant:"outline",className:He("text-xs gap-1 border",h.color),children:n.jsx(f,{className:"h-3 w-3"})})}),n.jsx(Sa,{side:"top",children:n.jsx("p",{className:"text-xs",children:h.label})})]})},u)})}),d=({label:c,sortKeyName:u})=>n.jsxs(he,{variant:"ghost",size:"sm",className:He("h-auto p-0 font-medium hover:bg-transparent",t===u?"text-foreground":"text-muted-foreground"),onClick:()=>i(u),children:[c,n.jsx(KF,{className:"ml-1 h-3 w-3"})]});return e.length===0?n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsx(Lt,{className:"text-base font-medium",children:"Performance por Vendedora"})}),n.jsx(Fe,{children:n.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhuma vendedora com pedidos no perodo."})})]}):n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Lt,{className:"text-base font-medium",children:"Performance por Vendedora"}),n.jsx(dp,{children:n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsx("span",{className:"text-xs text-muted-foreground cursor-help hidden sm:inline",children:" Critrios"})}),n.jsx(Sa,{side:"left",className:"max-w-xs",children:n.jsxs("div",{className:"text-xs space-y-1",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Maior Faturamento:"})," maior valor pago (R$)"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Maior Converso:"})," maior % (base mn. 3 pedidos ou R$300)"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Mais Pedidos:"})," maior quantidade de pedidos pagos"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Maior Ticket:"})," maior ticket mdio"]})]})})]})})]})}),n.jsxs(Fe,{className:"pt-0",children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{className:"hover:bg-transparent",children:[n.jsx(St,{className:"w-[150px]",children:"Vendedora"}),n.jsx(St,{className:"text-right",children:"Reservados"}),n.jsx(St,{className:"text-right",children:"Pagos"}),n.jsx(St,{className:"text-right",children:n.jsx(d,{label:"Converso",sortKeyName:"conversao"})}),n.jsx(St,{className:"text-right",children:n.jsx(d,{label:"Valor Pago",sortKeyName:"valorPago"})}),n.jsx(St,{className:"text-right",children:n.jsx(d,{label:"Ticket",sortKeyName:"ticketMedio"})}),n.jsx(St,{className:"w-[120px]",children:"Destaques"})]})}),n.jsx(ya,{children:o.map((c,u)=>n.jsxs(Kr,{children:[n.jsx(bt,{className:"font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs text-muted-foreground w-4",children:[u+1,"."]}),c.name]})}),n.jsx(bt,{className:"text-right text-muted-foreground",children:c.pedidosReservados}),n.jsx(bt,{className:"text-right",children:c.pedidosPagos}),n.jsx(bt,{className:"text-right",children:n.jsx("span",{className:He(c.conversao>=70?"text-primary font-medium":c.conversao<50?"text-amber-600":""),children:eM(c.conversao)})}),n.jsx(bt,{className:"text-right font-medium",children:jy(c.valorPago)}),n.jsx(bt,{className:"text-right",children:jy(c.ticketMedio)}),n.jsx(bt,{children:l(c.badges)})]},c.id))})]})}),n.jsx("div",{className:"md:hidden space-y-3",children:o.map((c,u)=>n.jsxs("div",{className:"p-3 rounded-lg border bg-card/50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs text-muted-foreground",children:[u+1,"."]}),n.jsx("span",{className:"font-medium text-sm",children:c.name})]}),l(c.badges)]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Reservados:"}),n.jsx("span",{children:c.pedidosReservados})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Pagos:"}),n.jsx("span",{children:c.pedidosPagos})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Converso:"}),n.jsx("span",{className:He(c.conversao>=70?"text-primary font-medium":c.conversao<50?"text-amber-600":""),children:eM(c.conversao)})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Ticket:"}),n.jsx("span",{children:jy(c.ticketMedio)})]})]}),n.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center",children:[n.jsx("span",{className:"text-xs text-muted-foreground",children:"Total Pago"}),n.jsx("span",{className:"font-semibold text-primary",children:jy(c.valorPago)})]})]},c.id))})]})]})}const Xbe=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),Ybe={aguardando_pagamento_24h:{icon:Lr,getRoute:Bs.aguardandoPagamento24h},aguardando_retorno_24h:{icon:Kv,getRoute:Bs.aguardandoRetorno24h},nao_cobrado:{icon:r_,getRoute:Bs.naoCobrado},pago_sem_logistica:{icon:yn,getRoute:Bs.pagoSemLogistica},etiqueta_pendente:{icon:Vt,getRoute:Bs.etiquetaPendente},sem_vendedora:{icon:xse,getRoute:Bs.semVendedora},urgente:{icon:Or,getRoute:Bs.urgente}};function Zbe({actions:e}){const t=pr();return e.length===0?n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(Or,{className:"h-4 w-4 text-muted-foreground"}),"Pendncias Operacionais"]})}),n.jsx(Fe,{children:n.jsx("div",{className:"text-center py-6",children:n.jsx("p",{className:"text-sm text-muted-foreground",children:" Nenhuma pendncia no momento"})})})]}):n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(Or,{className:"h-4 w-4 text-amber-500"}),"Pendncias Operacionais"]})}),n.jsx(Fe,{className:"pt-0",children:n.jsx("div",{className:"space-y-2",children:e.map(r=>{const s=Ybe[r.type],a=s.icon;return n.jsxs("div",{className:He("flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-colors group",r.severity==="error"?"bg-destructive/5 hover:bg-destructive/10":r.severity==="warning"?"bg-amber-50 hover:bg-amber-100":"bg-muted/50 hover:bg-muted"),onClick:()=>t(s.getRoute()),children:[n.jsx(a,{className:He("h-4 w-4 shrink-0",r.severity==="error"?"text-destructive":r.severity==="warning"?"text-amber-600":"text-muted-foreground")}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:r.title}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.count," pedido",r.count>1?"s":"","  ",Xbe(r.value)]})]}),n.jsx(hs,{className:"h-4 w-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"})]},r.id)})})})]})}const Qbe=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);function Jbe({customers:e}){const t=pr();return e.length===0?n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(Ha,{className:"h-4 w-4 text-muted-foreground"}),"Melhores Clientes"]})}),n.jsx(Fe,{children:n.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhum cliente encontrado."})})]}):n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Lt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(Ha,{className:"h-4 w-4 text-muted-foreground"}),"Melhores Clientes"]}),n.jsxs("button",{className:"text-xs text-muted-foreground hover:text-foreground transition-colors flex items-center gap-1",onClick:()=>t("/dashboard?tab=clientes"),children:["Ver todos ",n.jsx(hs,{className:"h-3 w-3"})]})]})}),n.jsx(Fe,{className:"pt-0",children:n.jsx("div",{className:"space-y-3",children:e.map((r,s)=>n.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>t(`/dashboard/clientes/${r.id}`),children:[n.jsxs("span",{className:"text-xs text-muted-foreground w-4",children:[s+1,"."]}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:r.name||r.instagram_handle||"Cliente"}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[r.instagram_handle&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ez,{className:"h-3 w-3"}),"@",r.instagram_handle.replace("@","")]}),n.jsxs("span",{children:[" ",r.totalPedidos," pedido",r.totalPedidos!==1?"s":""]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm font-semibold text-primary",children:Qbe(r.totalGasto)}),r.ultimaCompra&&n.jsx("p",{className:"text-xs text-muted-foreground",children:Vk(new Date(r.ultimaCompra),{addSuffix:!0,locale:mr})})]})]},r.id))})})]})}const ewe=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"];function twe(){const e=pr(),[t,r]=P.useState([]),[s,a]=P.useState([]),[i,o]=P.useState([]),[l,d]=P.useState(!0);P.useEffect(()=>{c()},[]);const c=async()=>{try{const f=fn(new Date,7),{data:m}=await le.from("orders").select("*, order_items(*)").gte("created_at",f.toISOString());if(!m)return;const p=new Map;m.forEach(b=>{const j=ewe.includes(b.status),T=b.status==="aguardando_pagamento",O=b.status==="cancelado";(b.order_items||[]).forEach(D=>{const B=D.product_name||"Unknown",q=p.get(B)||{name:D.product_name||"Unknown",sku:D.product_sku,qtySold:0,revenue:0,reservedQty:0,canceledQty:0};j&&(q.qtySold+=D.quantity||0,q.revenue+=(D.product_price||0)*(D.quantity||0)),T&&(q.reservedQty+=D.quantity||0),O&&(q.canceledQty+=D.quantity||0),p.set(B,q)})});const g=Array.from(p.values()),x=[...g].filter(b=>b.qtySold>0).sort((b,j)=>j.qtySold-b.qtySold).slice(0,5).map(b=>({name:b.name,sku:b.sku,qty:b.qtySold,revenue:b.revenue}));r(x);const v=[...g].filter(b=>b.revenue>0).sort((b,j)=>j.revenue-b.revenue).slice(0,5).map(b=>({name:b.name,sku:b.sku,qty:b.qtySold,revenue:b.revenue}));a(v);const y=[];g.forEach(b=>{const j=b.qtySold+b.reservedQty+b.canceledQty;if(j===0)return;const T=b.qtySold/j*100,O=b.canceledQty/j*100;b.reservedQty>3&&T<30&&y.push({name:b.name,type:"baixa_conversao",value:`${T.toFixed(0)}% converso, ${b.reservedQty} reservados`}),O>30&&b.canceledQty>2&&y.push({name:b.name,type:"alto_cancelamento",value:`${O.toFixed(0)}% cancelamento`})}),o(y.slice(0,5))}catch(f){console.error("Error loading BI cards:",f)}finally{d(!1)}},u=f=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(f),h=f=>{const m=new URLSearchParams;f&&m.set("sort",f),e(`/dashboard/insights?${m.toString()}`)};return l?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(f=>n.jsx($e,{className:"animate-pulse",children:n.jsx(Fe,{className:"h-48 flex items-center justify-center",children:n.jsx(Et,{className:"h-6 w-6 animate-spin text-muted-foreground"})})},f))}):n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsxs($e,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>h("qty"),children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(Vt,{className:"h-4 w-4 text-blue-500"}),"Top 5 Peas (Qtd)"]})}),n.jsxs(Fe,{className:"space-y-2",children:[t.length===0?n.jsx("p",{className:"text-sm text-muted-foreground",children:"Sem vendas no perodo"}):t.map((f,m)=>n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsxs("span",{className:"text-muted-foreground w-4 shrink-0",children:[m+1,"."]}),n.jsx("span",{className:"truncate",children:f.name})]}),n.jsx(ke,{variant:"secondary",className:"shrink-0 ml-2",children:f.qty})]},m)),n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full mt-2 gap-1",children:["Ver ranking completo ",n.jsx(In,{className:"h-3 w-3"})]})]})]}),n.jsxs($e,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>h("revenue"),children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(ks,{className:"h-4 w-4 text-green-500"}),"Top 5 Peas (Receita)"]})}),n.jsxs(Fe,{className:"space-y-2",children:[s.length===0?n.jsx("p",{className:"text-sm text-muted-foreground",children:"Sem vendas no perodo"}):s.map((f,m)=>n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsxs("span",{className:"text-muted-foreground w-4 shrink-0",children:[m+1,"."]}),n.jsx("span",{className:"truncate",children:f.name})]}),n.jsx("span",{className:"font-medium text-green-600 shrink-0 ml-2",children:u(f.revenue)})]},m)),n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full mt-2 gap-1",children:["Ver ranking completo ",n.jsx(In,{className:"h-3 w-3"})]})]})]}),n.jsxs($e,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>h("risk"),children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(Or,{className:"h-4 w-4 text-amber-500"}),"Risco Operacional"]})}),n.jsxs(Fe,{className:"space-y-2",children:[i.length===0?n.jsxs("div",{className:"text-center py-4",children:[n.jsx(ke,{className:"bg-green-100 text-green-700 border-0",children:"Tudo OK"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Nenhum alerta ativo"})]}):i.map((f,m)=>n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsx(ke,{variant:"outline",className:f.type==="baixa_conversao"?"border-amber-300 text-amber-700 text-[10px]":"border-red-300 text-red-700 text-[10px]",children:f.type==="baixa_conversao"?"Converso":"Cancelamento"})}),n.jsx("p",{className:"text-xs truncate",children:f.name}),n.jsx("p",{className:"text-[10px] text-muted-foreground",children:f.value})]},m)),n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full mt-2 gap-1",children:["Ver todos alertas ",n.jsx(In,{className:"h-3 w-3"})]})]})]}),n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(yse,{className:"h-4 w-4 text-purple-500"}),"Aes Rpidas"]})}),n.jsxs(Fe,{className:"space-y-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",onClick:()=>e("/dashboard?tab=orders&status=aguardando_pagamento"),children:[n.jsx(Vs,{className:"h-4 w-4 text-amber-500"}),"Cobrar reservas"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",onClick:()=>e("/dashboard?tab=products&filter=low_stock"),children:[n.jsx(Vt,{className:"h-4 w-4 text-blue-500"}),"Repor estoque"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",onClick:()=>h("risk"),children:[n.jsx(Or,{className:"h-4 w-4 text-red-500"}),"Ver alertas"]}),n.jsxs(he,{variant:"default",size:"sm",className:"w-full justify-start gap-2 mt-2",onClick:()=>h(),children:[n.jsx(Vs,{className:"h-4 w-4"}),"Centro de Inteligncia"]})]})]})]})}const S3=768;function e8(){const[e,t]=P.useState(void 0);return P.useEffect(()=>{const r=window.matchMedia(`(max-width: ${S3-1}px)`),s=()=>{t(window.innerWidth<S3)};return r.addEventListener("change",s),t(window.innerWidth<S3),()=>r.removeEventListener("change",s)},[]),!!e}function rwe(){const e=pr(),t=e8(),[r,s]=P.useState({period:"7days",channel:"all",liveEventId:null,sellerId:null}),{kpis:a,channelComparison:i,sellerPerformance:o,topCustomers:l,pendingActions:d,sellers:c,liveEvents:u,isLoading:h,refetch:f}=lbe(r),m=p=>{switch(p){case"faturamento":e(Bs.faturamentoPago());break;case"reservado":e(Bs.reservado());break;case"conversao":e(Bs.conversao());break;case"ticket":e("/dashboard?tab=clientes");break;case"pa":e("/dashboard?tab=products");break;case"pendencias":e(Bs.pendencias());break;case"pagos":e(Bs.pagos());break;case"pendentes":e(Bs.pendentes());break;case"cancelados":e(Bs.cancelados());break}};return h?n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):a?n.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("h2",{className:"text-lg sm:text-xl font-semibold truncate",children:"Viso Geral"}),n.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground hidden sm:block",children:"Dados consolidados do seu negcio"})]}),n.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[t?n.jsx(Vbe,{filters:r,onFiltersChange:s,sellers:c,liveEvents:u}):null,n.jsxs(he,{variant:"outline",size:"sm",onClick:f,className:"gap-2 h-9",children:[n.jsx(Qr,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Atualizar"})]})]})]}),!t&&n.jsx(ube,{filters:r,onFiltersChange:s,sellers:c,liveEvents:u}),n.jsx(Wbe,{kpis:a,onKPIClick:m}),n.jsxs("div",{className:"mt-6",children:[n.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Inteligncia Operacional"}),n.jsx(twe,{})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-10 gap-4 sm:gap-6",children:[n.jsxs("div",{className:"lg:col-span-7 space-y-4 sm:space-y-6",children:[i&&n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-2 sm:mb-3",children:"Catlogo vs Live"}),n.jsx(Hbe,{data:i})]}),n.jsx(Kbe,{sellers:o})]}),n.jsxs("div",{className:"lg:col-span-3 space-y-4 sm:space-y-6",children:[n.jsx("div",{id:"pending-actions",children:n.jsx(Zbe,{actions:d})}),n.jsx(Jbe,{customers:l})]})]})]}):n.jsxs("div",{className:"text-center py-20",children:[n.jsx("p",{className:"text-muted-foreground",children:"Erro ao carregar dados"}),n.jsx(he,{onClick:f,variant:"outline",className:"mt-4",children:"Tentar novamente"})]})}const tM=[{value:"overview",label:"Viso Geral",icon:O6},{value:"clientes",label:"Clientes",icon:oz},{value:"products",label:"Produtos",icon:Vt},{value:"orders",label:"Pedidos",icon:hn},{value:"lives",label:"Lives",icon:Ss},{value:"cupons",label:"Cupons",icon:Dh},{value:"promocoes",label:"Promoes",icon:ua},{value:"brindes",label:"Brindes",icon:Pn},{value:"club",label:"Le.Po Club",icon:Vi},{value:"equipe",label:"Equipe",icon:Kb},{value:"prints",label:"Prints",icon:P6,showCount:!0}];function nwe({activeTab:e,onTabChange:t,onLogout:r,onImportStock:s,printCount:a}){const[i,o]=P.useState(!1),l=d=>{t(d),o(!1)};return tM.find(d=>d.value===e),n.jsxs(_u,{open:i,onOpenChange:o,children:[n.jsx(lk,{asChild:!0,children:n.jsxs(he,{variant:"ghost",size:"icon",className:"md:hidden shrink-0",children:[n.jsx(nz,{className:"h-5 w-5"}),n.jsx("span",{className:"sr-only",children:"Menu"})]})}),n.jsxs(rd,{side:"left",className:"w-[min(92vw,320px)] p-0 overflow-hidden",children:[n.jsx(ju,{className:"p-4 border-b shrink-0",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("img",{src:bf,alt:"LE.PO",className:"h-8 max-w-[120px] object-contain"}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>o(!1),className:"shrink-0",children:n.jsx(sn,{className:"h-5 w-5"})})]})}),n.jsxs("nav",{className:"flex flex-col h-[calc(100vh-80px)] overflow-hidden",children:[n.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:tM.map(d=>{const c=d.icon,u=e===d.value;return n.jsxs("button",{onClick:()=>l(d.value),className:He("w-full flex items-center gap-3 px-4 py-3 text-left transition-colors","hover:bg-muted/50 active:bg-muted","min-h-[48px]",u&&"bg-primary/5 text-primary border-r-2 border-primary"),children:[n.jsx(c,{className:He("h-5 w-5 shrink-0",u?"text-primary":"text-muted-foreground")}),n.jsx("span",{className:He("text-sm font-medium truncate flex-1",u&&"text-primary"),children:d.label}),d.showCount&&a>0&&n.jsx("span",{className:"shrink-0 text-xs bg-primary text-primary-foreground px-2 py-0.5 rounded-full",children:a})]},d.value)})}),n.jsxs("div",{className:"border-t p-4 space-y-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"w-full justify-start gap-2 h-11",onClick:()=>{s(),o(!1)},children:[n.jsx(Gh,{className:"h-4 w-4"}),"Importar Estoque"]}),n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full justify-start gap-2 h-11 text-muted-foreground",onClick:()=>{r(),o(!1)},children:[n.jsx(R6,{className:"h-4 w-4"}),"Sair"]})]})]})]})]})}function swe(){const{sellers:e,isLoading:t,createSeller:r,updateSeller:s,toggleSellerActive:a,loadAllSellers:i}=Dk(),[o,l]=P.useState(!1),[d,c]=P.useState(null),[u,h]=P.useState({name:"",whatsapp:"",email:""}),[f,m]=P.useState(!1);P.useState(()=>{f&&i()});const p=v=>{v?(c(v),h({name:v.name,whatsapp:v.whatsapp||"",email:v.email||""})):(c(null),h({name:"",whatsapp:"",email:""})),l(!0)},g=async v=>{if(v.preventDefault(),!!u.name.trim())try{d?await s(d.id,{name:u.name,whatsapp:u.whatsapp||null,email:u.email||null}):await r({name:u.name,whatsapp:u.whatsapp||void 0,email:u.email||void 0}),l(!1),h({name:"",whatsapp:"",email:""}),c(null)}catch{}},x=f?e:e.filter(v=>v.is_active);return t?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("h2",{className:"text-lg font-semibold",children:"Equipe de Vendas"}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>{m(!f),f||i()},children:f?"Ocultar inativos":"Mostrar inativos"})]}),n.jsxs(tn,{open:o,onOpenChange:l,children:[n.jsx(Wpe,{asChild:!0,children:n.jsxs(he,{onClick:()=>p(),children:[n.jsx(kn,{className:"h-4 w-4 mr-2"}),"Nova Vendedora"]})}),n.jsxs(Jr,{children:[n.jsx(ln,{children:n.jsx(rn,{children:d?"Editar Vendedora":"Cadastrar Vendedora"})}),n.jsxs("form",{onSubmit:g,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"name",children:"Nome *"}),n.jsx(et,{id:"name",placeholder:"Nome da vendedora",value:u.name,onChange:v=>h(y=>({...y,name:v.target.value})),required:!0})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"whatsapp",children:"WhatsApp"}),n.jsx(et,{id:"whatsapp",placeholder:"(62) 99999-9999",value:u.whatsapp,onChange:v=>h(y=>({...y,whatsapp:v.target.value}))})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"email",children:"E-mail"}),n.jsx(et,{id:"email",type:"email",placeholder:"email@exemplo.com",value:u.email,onChange:v=>h(y=>({...y,email:v.target.value}))})]}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx(he,{type:"button",variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),n.jsx(he,{type:"submit",children:d?"Salvar":"Cadastrar"})]})]})]})]})]}),x.length===0?n.jsx($e,{children:n.jsxs(Fe,{className:"py-12 text-center text-muted-foreground",children:[n.jsx(Dn,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhuma vendedora cadastrada ainda."}),n.jsx("p",{className:"text-sm mt-1",children:'Clique em "Nova Vendedora" para comear.'})]})}):n.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:x.map(v=>n.jsx($e,{className:v.is_active?"":"opacity-60",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h3",{className:"font-medium truncate",children:v.name}),!v.is_active&&n.jsx(ke,{variant:"secondary",className:"text-xs",children:"Inativa"})]}),v.whatsapp&&n.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-muted-foreground mt-1",children:[n.jsx(kl,{className:"h-3 w-3"}),n.jsx("span",{children:v.whatsapp})]}),v.email&&n.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-muted-foreground mt-0.5",children:[n.jsx(M6,{className:"h-3 w-3"}),n.jsx("span",{className:"truncate",children:v.email})]})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx(he,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>p(v),children:n.jsx(Ql,{className:"h-4 w-4"})}),n.jsx(he,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>a(v.id,!v.is_active),title:v.is_active?"Desativar":"Ativar",children:v.is_active?n.jsx(Iu,{className:"h-4 w-4 text-green-600"}):n.jsx(Mu,{className:"h-4 w-4 text-muted-foreground"})})]})]})})},v.id))})]})}function TH(){const[e,t]=P.useState([]),[r,s]=P.useState([]),[a,i]=P.useState(!0),o=P.useCallback(async()=>{try{const{data:v,error:y}=await le.from("gifts").select("*").order("created_at",{ascending:!1});if(y)throw y;t(v||[])}catch(v){console.error("Error fetching gifts:",v),de.error("Erro ao carregar brindes")}},[]),l=P.useCallback(async()=>{try{const{data:v,error:y}=await le.from("gift_rules").select(`
          *,
          gift:gifts(*),
          live_event:live_events(id, titulo)
        `).order("priority",{ascending:!1});if(y)throw y;s(v||[])}catch(v){console.error("Error fetching gift rules:",v),de.error("Erro ao carregar regras de brindes")}},[]),d=P.useCallback(async()=>{i(!0),await Promise.all([o(),l()]),i(!1)},[o,l]);return P.useEffect(()=>{d()},[d]),{gifts:e,rules:r,isLoading:a,fetchAll:d,fetchGifts:o,fetchRules:l,createGift:async v=>{try{const{data:y,error:b}=await le.from("gifts").insert({name:v.name,image_url:v.image_url||null,description:v.description||null,stock_qty:v.unlimited_stock?0:v.stock_qty,unlimited_stock:v.unlimited_stock,is_active:v.is_active,start_at:v.start_at||null,end_at:v.end_at||null,require_manual_confirm:v.require_manual_confirm,cost:v.cost||null}).select().single();if(b)throw b;return de.success("Brinde criado com sucesso!"),o(),y}catch(y){return console.error("Error creating gift:",y),de.error("Erro ao criar brinde"),null}},updateGift:async(v,y)=>{try{const{error:b}=await le.from("gifts").update({name:y.name,image_url:y.image_url,description:y.description,stock_qty:y.unlimited_stock?0:y.stock_qty,unlimited_stock:y.unlimited_stock,is_active:y.is_active,start_at:y.start_at||null,end_at:y.end_at||null,require_manual_confirm:y.require_manual_confirm,cost:y.cost}).eq("id",v);if(b)throw b;return de.success("Brinde atualizado!"),o(),!0}catch(b){return console.error("Error updating gift:",b),de.error("Erro ao atualizar brinde"),!1}},toggleGiftActive:async(v,y)=>{try{const{error:b}=await le.from("gifts").update({is_active:!y}).eq("id",v);if(b)throw b;return t(j=>j.map(T=>T.id===v?{...T,is_active:!y}:T)),de.success(y?"Brinde desativado":"Brinde ativado"),!0}catch(b){return console.error("Error toggling gift:",b),de.error("Erro ao atualizar brinde"),!1}},deleteGift:async v=>{try{const{error:y}=await le.from("gifts").delete().eq("id",v);if(y)throw y;return t(b=>b.filter(j=>j.id!==v)),de.success("Brinde excludo"),!0}catch(y){return console.error("Error deleting gift:",y),de.error("Erro ao excluir brinde"),!1}},createRule:async v=>{try{const{data:y,error:b}=await le.from("gift_rules").insert({name:v.name,is_active:v.is_active,channel_scope:v.channel_scope,live_event_id:v.live_event_id||null,start_at:v.start_at||null,end_at:v.end_at||null,priority:v.priority,condition_type:v.condition_type,condition_value:v.condition_value||null,gift_id:v.gift_id,gift_qty:v.gift_qty,max_per_customer:v.max_per_customer||null,max_total_awards:v.max_total_awards||null}).select("*, gift:gifts(*), live_event:live_events(id, titulo)").single();if(b)throw b;return de.success("Regra criada com sucesso!"),l(),y}catch(y){return console.error("Error creating rule:",y),de.error("Erro ao criar regra"),null}},updateRule:async(v,y)=>{try{const{error:b}=await le.from("gift_rules").update({name:y.name,is_active:y.is_active,channel_scope:y.channel_scope,live_event_id:y.live_event_id||null,start_at:y.start_at||null,end_at:y.end_at||null,priority:y.priority,condition_type:y.condition_type,condition_value:y.condition_value,gift_id:y.gift_id,gift_qty:y.gift_qty,max_per_customer:y.max_per_customer,max_total_awards:y.max_total_awards}).eq("id",v);if(b)throw b;return de.success("Regra atualizada!"),l(),!0}catch(b){return console.error("Error updating rule:",b),de.error("Erro ao atualizar regra"),!1}},toggleRuleActive:async(v,y)=>{try{const{error:b}=await le.from("gift_rules").update({is_active:!y}).eq("id",v);if(b)throw b;return s(j=>j.map(T=>T.id===v?{...T,is_active:!y}:T)),de.success(y?"Regra desativada":"Regra ativada"),!0}catch(b){return console.error("Error toggling rule:",b),de.error("Erro ao atualizar regra"),!1}},deleteRule:async v=>{try{const{error:y}=await le.from("gift_rules").delete().eq("id",v);if(y)throw y;return s(b=>b.filter(j=>j.id!==v)),de.success("Regra excluda"),!0}catch(y){return console.error("Error deleting rule:",y),de.error("Erro ao excluir regra"),!1}}}}function awe(){const[e,t]=P.useState([]),[r,s]=P.useState(!0);return P.useEffect(()=>{(async()=>{try{const i=new Date().toISOString(),{data:o,error:l}=await le.from("gifts").select("*").eq("is_active",!0).or(`start_at.is.null,start_at.lte.${i}`).or(`end_at.is.null,end_at.gte.${i}`).order("name");if(l)throw l;t(o||[])}catch(i){console.error("Error fetching active gifts:",i)}finally{s(!1)}})()},[]),{gifts:e,isLoading:r}}function iwe(){const{gifts:e,isLoading:t,createGift:r,updateGift:s,toggleGiftActive:a,deleteGift:i}=TH(),[o,l]=P.useState(""),[d,c]=P.useState(!1),[u,h]=P.useState(null),[f,m]=P.useState(!1),[p,g]=P.useState(!1),[x,v]=P.useState(""),[y,b]=P.useState(""),[j,T]=P.useState(""),[O,R]=P.useState(""),[D,B]=P.useState(!1),[q,Y]=P.useState(!0),[G,I]=P.useState(),[F,S]=P.useState(),[E,N]=P.useState(!1),[C,k]=P.useState(""),M=()=>{v(""),b(""),T(""),R(""),B(!1),Y(!0),I(void 0),S(void 0),N(!1),k(""),h(null)},U=()=>{M(),c(!0)},$=V=>{var H;h(V),v(V.name),b(V.image_url||""),T(V.description||""),R(V.stock_qty.toString()),B(V.unlimited_stock),Y(V.is_active),I(V.start_at?new Date(V.start_at):void 0),S(V.end_at?new Date(V.end_at):void 0),N(V.require_manual_confirm),k(((H=V.cost)==null?void 0:H.toString())||""),c(!0)},X=async V=>{var ee;const H=(ee=V.target.files)==null?void 0:ee[0];if(H){g(!0);try{const ie=H.name.split(".").pop(),se=`gifts/${`gift-${Date.now()}.${ie}`}`,{error:ue}=await le.storage.from("products").upload(se,H);if(ue)throw ue;const{data:{publicUrl:pe}}=le.storage.from("products").getPublicUrl(se);b(pe),de.success("Imagem enviada!")}catch(ie){console.error("Error uploading image:",ie),de.error("Erro ao enviar imagem")}finally{g(!1)}}},Z=async()=>{if(!x.trim()){de.error("Preencha o nome do brinde");return}if(!D&&!O){de.error("Informe a quantidade em estoque ou marque como ilimitado");return}m(!0);const V={name:x.trim(),image_url:y||void 0,description:j||void 0,stock_qty:D?0:parseInt(O)||0,unlimited_stock:D,is_active:q,start_at:G==null?void 0:G.toISOString(),end_at:F==null?void 0:F.toISOString(),require_manual_confirm:E,cost:C?parseFloat(C):void 0};let H=!1;u?H=await s(u.id,V):H=!!await r(V),m(!1),H&&(c(!1),M())},re=async V=>{confirm("Tem certeza que deseja excluir este brinde?")&&await i(V)},W=e.filter(V=>{var H;return V.name.toLowerCase().includes(o.toLowerCase())||((H=V.sku)==null?void 0:H.toLowerCase().includes(o.toLowerCase()))}),J=V=>{if(!V.is_active)return{label:"Inativo",variant:"secondary"};const H=new Date;return V.start_at&&new Date(V.start_at)>H?{label:"Agendado",variant:"outline"}:V.end_at&&new Date(V.end_at)<H?{label:"Expirado",variant:"destructive"}:!V.unlimited_stock&&V.stock_qty<=0?{label:"Sem estoque",variant:"destructive"}:{label:"Ativo",variant:"default"}};return n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Pn,{className:"h-5 w-5"}),"Brindes"]}),n.jsx(qi,{children:"Cadastre brindes para regras automticas e sorteios"})]}),n.jsxs(he,{onClick:U,children:[n.jsx(kn,{className:"h-4 w-4 mr-1"}),"Novo Brinde"]})]})}),n.jsxs(Fe,{children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por nome ou SKU...",value:o,onChange:V=>l(V.target.value),className:"pl-10"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Total"})]}),n.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(V=>J(V).label==="Ativo").length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Ativos"})]}),n.jsxs("div",{className:"p-3 bg-amber-50 dark:bg-amber-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:e.filter(V=>V.unlimited_stock).length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Ilimitados"})]})]}),t?n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando..."}):W.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Pn,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhum brinde encontrado"})]}):n.jsx("div",{className:"rounded-md border overflow-x-auto",children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{children:"Brinde"}),n.jsx(St,{children:"SKU"}),n.jsx(St,{children:"Estoque"}),n.jsx(St,{children:"Validade"}),n.jsx(St,{children:"Status"}),n.jsx(St,{className:"text-right",children:"Aes"})]})}),n.jsx(ya,{children:W.map(V=>{const H=J(V);return n.jsxs(Kr,{children:[n.jsx(bt,{children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:V.image_url?n.jsx("img",{src:V.image_url,alt:V.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Pn,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:V.name}),V.description&&n.jsx("div",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:V.description})]})]})}),n.jsx(bt,{children:n.jsx("code",{className:"text-xs bg-secondary px-1 py-0.5 rounded",children:V.sku})}),n.jsx(bt,{children:V.unlimited_stock?n.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",children:[n.jsx(Qne,{className:"h-3 w-3"})," Ilimitado"]}):n.jsxs("span",{className:V.stock_qty<=0?"text-destructive":"",children:[V.stock_qty," un"]})}),n.jsx(bt,{children:n.jsxs("div",{className:"text-sm",children:[V.start_at&&n.jsxs("div",{children:["De: ",Wt(new Date(V.start_at),"dd/MM/yy",{locale:mr})]}),V.end_at&&n.jsxs("div",{children:["At: ",Wt(new Date(V.end_at),"dd/MM/yy",{locale:mr})]}),!V.start_at&&!V.end_at&&n.jsx("span",{className:"text-muted-foreground",children:"Sem limite"})]})}),n.jsx(bt,{children:n.jsx(ke,{variant:H.variant,children:H.label})}),n.jsx(bt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>$(V),children:n.jsx(Js,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>a(V.id,V.is_active),title:V.is_active?"Desativar":"Ativar",children:V.is_active?n.jsx(Iu,{className:"h-4 w-4 text-green-600"}):n.jsx(Mu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>re(V.id),children:n.jsx(ui,{className:"h-4 w-4 text-destructive"})})]})})]},V.id)})})]})})]}),n.jsx(tn,{open:d,onOpenChange:c,children:n.jsxs(Jr,{className:"sm:max-w-lg p-0 max-h-[85vh] flex flex-col overflow-hidden",children:[n.jsx(ln,{className:"px-6 py-4 border-b shrink-0",children:n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(Pn,{className:"h-5 w-5"}),u?"Editar Brinde":"Novo Brinde"]})}),n.jsxs("div",{className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Nome do Brinde *"}),n.jsx(et,{placeholder:"Ex: Brinco Semijoia",value:x,onChange:V=>v(V.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Foto"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(et,{placeholder:"URL da imagem ou envie",value:y,onChange:V=>b(V.target.value),className:"flex-1"}),n.jsx(he,{variant:"outline",size:"icon",asChild:!0,disabled:p,children:n.jsxs("label",{className:"cursor-pointer",children:[n.jsx(Lh,{className:"h-4 w-4"}),n.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:X})]})})]}),y&&n.jsx("div",{className:"w-20 h-20 rounded overflow-hidden border",children:n.jsx("img",{src:y,alt:"Preview",className:"w-full h-full object-cover"})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Descrio (opcional)"}),n.jsx(rs,{placeholder:"Breve descrio do brinde",value:j,onChange:V=>T(V.target.value),rows:2})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Estoque"}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Va,{id:"unlimited",checked:D,onCheckedChange:V=>B(!!V)}),n.jsx("label",{htmlFor:"unlimited",className:"text-sm cursor-pointer",children:"Ilimitado"})]}),!D&&n.jsx(et,{type:"number",min:"0",placeholder:"Quantidade",value:O,onChange:V=>R(V.target.value),className:"w-32"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Data de Incio"}),n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("w-full justify-start text-left font-normal",!G&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),G?Wt(G,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Ga,{className:"w-auto p-0 z-50",align:"start",children:n.jsx(_i,{mode:"single",selected:G,onSelect:I,locale:mr,initialFocus:!0})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Data de Fim"}),n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("w-full justify-start text-left font-normal",!F&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),F?Wt(F,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Ga,{className:"w-auto p-0 z-50",align:"start",children:n.jsx(_i,{mode:"single",selected:F,onSelect:S,locale:mr,initialFocus:!0})})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Custo (interno, opcional)"}),n.jsx(et,{type:"number",min:"0",step:"0.01",placeholder:"R$ 0,00",value:C,onChange:V=>k(V.target.value)})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Va,{id:"active",checked:q,onCheckedChange:V=>Y(!!V)}),n.jsx("label",{htmlFor:"active",className:"text-sm cursor-pointer",children:"Brinde ativo"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Va,{id:"confirm",checked:E,onCheckedChange:V=>N(!!V)}),n.jsx("label",{htmlFor:"confirm",className:"text-sm cursor-pointer",children:"Requer confirmao manual na separao"})]})]})]}),n.jsxs(ba,{className:"px-6 py-4 border-t shrink-0",children:[n.jsx(he,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),n.jsx(he,{onClick:Z,disabled:f,children:f?"Salvando...":u?"Salvar":"Criar Brinde"})]})]})})]})}const owe={catalog_only:"Apenas Catlogo",live_only:"Apenas Lives",both:"Catlogo e Lives",live_specific:"Live Especfica"},lwe={all_purchases:"Todas as compras",min_value:"Valor mnimo",first_n_paid:"Primeiros N pagos",first_n_reserved:"Primeiros N reservados"},cwe={all_purchases:hn,min_value:ks,first_n_paid:ms,first_n_reserved:Ha};function dwe(){const{rules:e,isLoading:t,createRule:r,updateRule:s,toggleRuleActive:a,deleteRule:i}=TH(),{gifts:o}=awe(),[l,d]=P.useState([]),[c,u]=P.useState(""),[h,f]=P.useState(!1),[m,p]=P.useState(null),[g,x]=P.useState(!1),[v,y]=P.useState(""),[b,j]=P.useState(!0),[T,O]=P.useState("both"),[R,D]=P.useState(""),[B,q]=P.useState(),[Y,G]=P.useState(),[I,F]=P.useState("0"),[S,E]=P.useState("all_purchases"),[N,C]=P.useState(""),[k,M]=P.useState(""),[U,$]=P.useState("1"),[X,Z]=P.useState("1"),[re,W]=P.useState("");P.useEffect(()=>{(async()=>{const{data:me}=await le.from("live_events").select("id, titulo, status").in("status",["planejada","ao_vivo"]).order("data_hora_inicio",{ascending:!1});d(me||[])})()},[]);const J=()=>{y(""),j(!0),O("both"),D(""),q(void 0),G(void 0),F("0"),E("all_purchases"),C(""),M(""),$("1"),Z("1"),W(""),p(null)},V=()=>{J(),f(!0)},H=ne=>{var me,ge,_e;p(ne),y(ne.name),j(ne.is_active),O(ne.channel_scope),D(ne.live_event_id||""),q(ne.start_at?new Date(ne.start_at):void 0),G(ne.end_at?new Date(ne.end_at):void 0),F(ne.priority.toString()),E(ne.condition_type),C(((me=ne.condition_value)==null?void 0:me.toString())||""),M(ne.gift_id),$(ne.gift_qty.toString()),Z(((ge=ne.max_per_customer)==null?void 0:ge.toString())||"1"),W(((_e=ne.max_total_awards)==null?void 0:_e.toString())||""),f(!0)},ee=async()=>{if(!v.trim()){de.error("Preencha o nome da regra");return}if(!k){de.error("Selecione um brinde");return}if(T==="live_specific"&&!R){de.error("Selecione uma live");return}if((S==="min_value"||S==="first_n_paid"||S==="first_n_reserved")&&!N){de.error("Informe o valor da condio");return}x(!0);const ne={name:v.trim(),is_active:b,channel_scope:T,live_event_id:T==="live_specific"?R:void 0,start_at:B==null?void 0:B.toISOString(),end_at:Y==null?void 0:Y.toISOString(),priority:parseInt(I)||0,condition_type:S,condition_value:N?parseFloat(N):void 0,gift_id:k,gift_qty:parseInt(U)||1,max_per_customer:X?parseInt(X):void 0,max_total_awards:re?parseInt(re):void 0};let me=!1;m?me=await s(m.id,ne):me=!!await r(ne),x(!1),me&&(f(!1),J())},ie=async ne=>{confirm("Tem certeza que deseja excluir esta regra?")&&await i(ne)},oe=e.filter(ne=>{var me;return ne.name.toLowerCase().includes(c.toLowerCase())||((me=ne.gift)==null?void 0:me.name.toLowerCase().includes(c.toLowerCase()))}),se=ne=>{if(!ne.is_active)return{label:"Inativa",variant:"secondary"};if(ne.gift&&!ne.gift.unlimited_stock&&ne.gift.stock_qty<ne.gift_qty)return{label:"Sem Estoque",variant:"destructive",description:`Requer ${ne.gift_qty}, disp: ${ne.gift.stock_qty}`};const me=new Date;return ne.start_at&&new Date(ne.start_at)>me?{label:"Agendada",variant:"outline"}:ne.end_at&&new Date(ne.end_at)<me?{label:"Expirada",variant:"destructive"}:ne.max_total_awards&&ne.current_awards_count>=ne.max_total_awards?{label:"Esgotada",variant:"destructive"}:{label:"Ativa",variant:"default"}},ue=o.find(ne=>ne.id===k),pe=ue&&!ue.unlimited_stock&&ue.stock_qty<(parseInt(U)||1),ce=S==="min_value"||S==="first_n_paid"||S==="first_n_reserved";return n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(W0,{className:"h-5 w-5"}),"Regras de Brindes"]}),n.jsx(qi,{children:"Configure regras automticas para aplicar brindes"})]}),n.jsxs(he,{onClick:V,children:[n.jsx(kn,{className:"h-4 w-4 mr-1"}),"Nova Regra"]})]})}),n.jsxs(Fe,{children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar regras...",value:c,onChange:ne=>u(ne.target.value),className:"pl-10"})]}),t?n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando..."}):oe.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(W0,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhuma regra encontrada"})]}):n.jsx("div",{className:"rounded-md border overflow-x-auto",children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{children:"Regra"}),n.jsx(St,{children:"Brinde"}),n.jsx(St,{children:"Condio"}),n.jsx(St,{children:"Canal"}),n.jsx(St,{children:"Aplicaes"}),n.jsx(St,{children:"Status"}),n.jsx(St,{className:"text-right",children:"Aes"})]})}),n.jsx(ya,{children:oe.map(ne=>{var _e,be;const me=se(ne),ge=cwe[ne.condition_type];return n.jsxs(Kr,{children:[n.jsxs(bt,{children:[n.jsx("div",{className:"font-medium",children:ne.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Prioridade: ",ne.priority]})]}),n.jsx(bt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 bg-secondary rounded overflow-hidden shrink-0",children:(_e=ne.gift)!=null&&_e.image_url?n.jsx("img",{src:ne.gift.image_url,alt:"",className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Pn,{className:"h-3 w-3 text-muted-foreground"})})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm",children:((be=ne.gift)==null?void 0:be.name)||""}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["x",ne.gift_qty]}),ne.gift&&!ne.gift.unlimited_stock&&n.jsxs("div",{className:He("text-[10px]",ne.gift.stock_qty<ne.gift_qty?"text-destructive font-medium":"text-muted-foreground"),children:["Estoque: ",ne.gift.stock_qty]})]})]})}),n.jsxs(bt,{children:[n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx(ge,{className:"h-3.5 w-3.5 text-muted-foreground"}),n.jsx("span",{className:"text-sm",children:lwe[ne.condition_type]})]}),ne.condition_value&&n.jsx("div",{className:"text-xs text-muted-foreground mt-0.5",children:ne.condition_type==="min_value"?`R$ ${ne.condition_value.toFixed(2)}`:`${ne.condition_value}`})]}),n.jsxs(bt,{children:[n.jsx("div",{className:"text-sm",children:owe[ne.channel_scope]}),ne.live_event&&n.jsx("div",{className:"text-xs text-muted-foreground truncate max-w-[120px]",children:ne.live_event.titulo})]}),n.jsx(bt,{children:n.jsxs("div",{className:"text-sm",children:[ne.current_awards_count,ne.max_total_awards&&` / ${ne.max_total_awards}`]})}),n.jsx(bt,{children:n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsx(ke,{variant:me.variant,children:me.label}),me.description&&n.jsx("span",{className:"text-[10px] text-destructive font-medium whitespace-nowrap",children:me.description})]})}),n.jsx(bt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>H(ne),children:n.jsx(Js,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>a(ne.id,ne.is_active),children:ne.is_active?n.jsx(Iu,{className:"h-4 w-4 text-green-600"}):n.jsx(Mu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>ie(ne.id),children:n.jsx(ui,{className:"h-4 w-4 text-destructive"})})]})})]},ne.id)})})]})})]}),n.jsx(tn,{open:h,onOpenChange:f,children:n.jsxs(Jr,{className:"sm:max-w-lg p-0 max-h-[85vh] flex flex-col overflow-hidden",children:[n.jsx(ln,{className:"px-6 py-4 border-b shrink-0",children:n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(W0,{className:"h-5 w-5"}),m?"Editar Regra":"Nova Regra"]})}),n.jsxs("div",{className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Nome da Regra *"}),n.jsx(et,{placeholder:"Ex: Brinde acima de R$ 400",value:v,onChange:ne=>y(ne.target.value)})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{className:"col-span-2 space-y-2",children:[n.jsx(Be,{children:"Brinde *"}),n.jsxs(Xt,{value:k,onValueChange:M,children:[n.jsx(Ht,{className:He(pe&&"border-destructive text-destructive"),children:n.jsx(Yt,{placeholder:"Selecione"})}),n.jsx(Gt,{className:"bg-background z-50",children:o.map(ne=>n.jsx(qe,{value:ne.id,children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Pn,{className:"h-3 w-3"}),ne.name,!ne.unlimited_stock&&n.jsxs("span",{className:He("text-xs ml-1",ne.stock_qty<(parseInt(U)||1)?"text-destructive":"text-muted-foreground"),children:["(Estoque: ",ne.stock_qty,")"]})]})},ne.id))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Qtd"}),n.jsx(et,{type:"number",min:"1",value:U,onChange:ne=>$(ne.target.value),className:He(pe&&"border-destructive text-destructive")})]})]}),pe&&ue&&n.jsxs("div",{className:"text-sm bg-destructive/10 text-destructive p-3 rounded-md flex gap-2 items-start mt-0",children:[n.jsx(Sn,{className:"h-4 w-4 mt-0.5 shrink-0"}),n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsx("p",{className:"font-medium",children:"Ateno: Estoque Insuficiente"}),n.jsxs("p",{className:"text-xs opacity-90",children:["Voc est configurando para dar ",n.jsx("strong",{children:U})," unidades, mas s h ",n.jsx("strong",{children:ue.stock_qty})," em estoque."]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Aplicar em"}),n.jsxs(Xt,{value:T,onValueChange:ne=>O(ne),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsxs(Gt,{className:"bg-background z-50",children:[n.jsx(qe,{value:"both",children:"Catlogo e Lives"}),n.jsx(qe,{value:"catalog_only",children:"Apenas Catlogo"}),n.jsx(qe,{value:"live_only",children:"Apenas Lives"}),n.jsx(qe,{value:"live_specific",children:"Live Especfica"})]})]})]}),T==="live_specific"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Live *"}),n.jsxs(Xt,{value:R,onValueChange:D,children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecione a live"})}),n.jsx(Gt,{className:"bg-background z-50",children:l.map(ne=>n.jsx(qe,{value:ne.id,children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Ss,{className:"h-3 w-3"}),ne.titulo]})},ne.id))})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Condio"}),n.jsxs(Xt,{value:S,onValueChange:ne=>E(ne),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsxs(Gt,{className:"bg-background z-50",children:[n.jsx(qe,{value:"all_purchases",children:"Todas as compras"}),n.jsx(qe,{value:"min_value",children:"Valor mnimo"}),n.jsx(qe,{value:"first_n_paid",children:"Primeiros N pagos"}),n.jsx(qe,{value:"first_n_reserved",children:"Primeiros N reservados"})]})]})]}),ce&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:S==="min_value"?"Valor (R$)":"Quantidade"}),n.jsx(et,{type:"number",min:"1",step:S==="min_value"?"0.01":"1",value:N,onChange:ne=>C(ne.target.value),placeholder:S==="min_value"?"400.00":"10"})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Por cliente"}),n.jsx(et,{type:"number",min:"1",value:X,onChange:ne=>Z(ne.target.value),placeholder:"1"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Total mximo"}),n.jsx(et,{type:"number",min:"1",value:re,onChange:ne=>W(ne.target.value),placeholder:"Ilimitado"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Prioridade"}),n.jsx(et,{type:"number",value:I,onChange:ne=>F(ne.target.value),placeholder:"0"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Data de Incio"}),n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("w-full justify-start text-left font-normal",!B&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),B?Wt(B,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Ga,{className:"w-auto p-0 z-50",align:"start",children:n.jsx(_i,{mode:"single",selected:B,onSelect:q,locale:mr,initialFocus:!0})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Data de Fim"}),n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("w-full justify-start text-left font-normal",!Y&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),Y?Wt(Y,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Ga,{className:"w-auto p-0 z-50",align:"start",children:n.jsx(_i,{mode:"single",selected:Y,onSelect:G,locale:mr,initialFocus:!0})})]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Va,{id:"ruleActive",checked:b,onCheckedChange:ne=>j(!!ne)}),n.jsx("label",{htmlFor:"ruleActive",className:"text-sm cursor-pointer",children:"Regra ativa"})]})]}),n.jsxs(ba,{className:"px-6 py-4 border-t shrink-0",children:[n.jsx(he,{variant:"outline",onClick:()=>f(!1),children:"Cancelar"}),n.jsx(he,{onClick:ee,disabled:g,children:g?"Salvando...":m?"Salvar":"Criar Regra"})]})]})})]})}function uwe(){return n.jsxs(Hi,{defaultValue:"gifts",className:"space-y-4",children:[n.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:n.jsxs(Si,{className:"inline-flex w-max sm:w-auto",children:[n.jsxs(br,{value:"gifts",className:"gap-2 min-h-[44px] px-4",children:[n.jsx(Pn,{className:"h-4 w-4"}),n.jsx("span",{children:"Brindes"})]}),n.jsxs(br,{value:"rules",className:"gap-2 min-h-[44px] px-4",children:[n.jsx(W0,{className:"h-4 w-4"}),n.jsx("span",{children:"Regras"})]})]})}),n.jsx(kr,{value:"gifts",children:n.jsx(iwe,{})}),n.jsx(kr,{value:"rules",children:n.jsx(dwe,{})})]})}var F_="Switch",[hwe,sQe]=ea(F_),[fwe,mwe]=hwe(F_),PH=P.forwardRef((e,t)=>{const{__scopeSwitch:r,name:s,checked:a,defaultChecked:i,required:o,disabled:l,value:d="on",onCheckedChange:c,form:u,...h}=e,[f,m]=P.useState(null),p=Rr(t,b=>m(b)),g=P.useRef(!1),x=f?u||!!f.closest("form"):!0,[v,y]=Ui({prop:a,defaultProp:i??!1,onChange:c,caller:F_});return n.jsxs(fwe,{scope:r,checked:v,disabled:l,children:[n.jsx(er.button,{type:"button",role:"switch","aria-checked":v,"aria-required":o,"data-state":IH(v),"data-disabled":l?"":void 0,disabled:l,value:d,...h,ref:p,onClick:Tt(e.onClick,b=>{y(j=>!j),x&&(g.current=b.isPropagationStopped(),g.current||b.stopPropagation())})}),x&&n.jsx(MH,{control:f,bubbles:!g.current,name:s,value:d,checked:v,required:o,disabled:l,form:u,style:{transform:"translateX(-100%)"}})]})});PH.displayName=F_;var OH="SwitchThumb",RH=P.forwardRef((e,t)=>{const{__scopeSwitch:r,...s}=e,a=mwe(OH,r);return n.jsx(er.span,{"data-state":IH(a.checked),"data-disabled":a.disabled?"":void 0,...s,ref:t})});RH.displayName=OH;var pwe="SwitchBubbleInput",MH=P.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:s=!0,...a},i)=>{const o=P.useRef(null),l=Rr(o,i),d=E_(r),c=l_(t);return P.useEffect(()=>{const u=o.current;if(!u)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(d!==r&&m){const p=new Event("click",{bubbles:s});m.call(u,r),u.dispatchEvent(p)}},[d,r,s]),n.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:l,style:{...a.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});MH.displayName=pwe;function IH(e){return e?"checked":"unchecked"}var DH=PH,gwe=RH;const ii=P.forwardRef(({className:e,...t},r)=>n.jsx(DH,{className:He("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",e),...t,ref:r,children:n.jsx(gwe,{className:He("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));ii.displayName=DH.displayName;function xwe(){const[e,t]=P.useState([]),[r,s]=P.useState([]),[a,i]=P.useState([]),[o,l]=P.useState(null),[d,c]=P.useState(null),[u,h]=P.useState(null),[f,m]=P.useState(!0),p=P.useCallback(async()=>{m(!0);try{await Promise.all([g(),x(),v(),y(),b()])}finally{m(!1)}},[]),g=async()=>{const{data:I,error:F}=await le.from("loyalty_tiers").select("*").order("display_order",{ascending:!0});!F&&I&&t(I.map(S=>({id:S.id,name:S.name,slug:S.slug,minPoints:S.min_points,maxPoints:S.max_points,multiplier:Number(S.multiplier),benefits:S.benefits,badgeColor:S.badge_color||"#8B7355",displayOrder:S.display_order,isActive:S.is_active})))},x=async()=>{const{data:I,error:F}=await le.from("loyalty_campaigns").select("*").order("priority",{ascending:!1});!F&&I&&s(I.map(S=>({id:S.id,name:S.name,description:S.description,campaignType:S.campaign_type,multiplierValue:Number(S.multiplier_value),bonusPoints:S.bonus_points,giftId:S.gift_id,minOrderValue:S.min_order_value?Number(S.min_order_value):null,applicableTiers:S.applicable_tiers||[],channelScope:S.channel_scope,categoryFilter:S.category_filter,skuFilter:S.sku_filter,priority:S.priority,maxUsesPerCustomer:S.max_uses_per_customer,maxTotalUses:S.max_total_uses,currentUses:S.current_uses,startAt:S.start_at,endAt:S.end_at,isActive:S.is_active})))},v=async()=>{const{data:I,error:F}=await le.from("loyalty_missions").select("*").order("display_order",{ascending:!0});!F&&I&&i(I.map(S=>({id:S.id,missionKey:S.mission_key,title:S.title,subtitle:S.subtitle,emoji:S.emoji||"",description:S.description,pointsReward:S.points_reward,missionType:S.mission_type,questionsJson:S.questions_json||[],maxPhotos:S.max_photos||5,isRepeatable:S.is_repeatable,repeatIntervalDays:S.repeat_interval_days,prerequisiteMissionId:S.prerequisite_mission_id,minTier:S.min_tier||"poa",displayOrder:S.display_order,isActive:S.is_active,isPublished:S.is_published})))},y=async()=>{const{data:I}=await le.from("loyalty_settings").select("setting_value").eq("setting_key","general").single(),{data:F}=await le.from("loyalty_settings").select("setting_value").eq("setting_key","messages").single();if(I!=null&&I.setting_value){const S=I.setting_value;l({enabled:S.enabled??!0,pointsPerReal:S.points_per_real??1,pointsExpiryMonths:S.points_expiry_months??12,weeklyMissionLimit:S.weekly_mission_limit??300})}if(F!=null&&F.setting_value){const S=F.setting_value;c({welcome:S.welcome??"",levelUp:S.level_up??"",pointsEarned:S.points_earned??"",pointsExpiring:S.points_expiring??""})}},b=async()=>{const{data:I}=await le.from("point_transactions").select("points, type, expired");let F=0,S=0,E=0;(I||[]).forEach($=>{$.points>0&&!$.expired&&(F+=$.points),$.type==="redemption"&&(S+=Math.abs($.points)),$.expired&&(E+=$.points)});const{count:N}=await le.from("customer_loyalty").select("*",{count:"exact",head:!0}),{data:C}=await le.from("customer_loyalty").select("current_tier"),k={};(C||[]).forEach($=>{k[$.current_tier]=(k[$.current_tier]||0)+1});const{data:M}=await le.from("reward_redemptions").select("reward_id, loyalty_rewards(name)").limit(100),U={};(M||[]).forEach($=>{var Z;const X=((Z=$.loyalty_rewards)==null?void 0:Z.name)||"Unknown";U[$.reward_id]||(U[$.reward_id]={name:X,count:0}),U[$.reward_id].count++}),h({pointsEarned:F,pointsRedeemed:S,pointsExpired:E,activeUsers:N||0,topRewards:Object.values(U).sort(($,X)=>X.count-$.count).slice(0,5).map($=>({name:$.name,redemptions:$.count})),tierDistribution:Object.entries(k).map(([$,X])=>({tier:$,count:X}))})},j=async I=>{const F={name:I.name,slug:I.slug,min_points:I.minPoints,max_points:I.maxPoints,multiplier:I.multiplier,benefits:I.benefits,badge_color:I.badgeColor,display_order:I.displayOrder,is_active:I.isActive};if(I.id){const{error:S}=await le.from("loyalty_tiers").update(F).eq("id",I.id);if(S)throw S}else{const{error:S}=await le.from("loyalty_tiers").insert(F);if(S)throw S}await g()},T=async I=>{const{error:F}=await le.from("loyalty_tiers").delete().eq("id",I);if(F)throw F;await g()},O=async I=>{const F={name:I.name,description:I.description,campaign_type:I.campaignType,multiplier_value:I.multiplierValue,bonus_points:I.bonusPoints,gift_id:I.giftId,min_order_value:I.minOrderValue,applicable_tiers:I.applicableTiers,channel_scope:I.channelScope,category_filter:I.categoryFilter,sku_filter:I.skuFilter,priority:I.priority,max_uses_per_customer:I.maxUsesPerCustomer,max_total_uses:I.maxTotalUses,start_at:I.startAt,end_at:I.endAt,is_active:I.isActive};if(I.id){const{error:S}=await le.from("loyalty_campaigns").update(F).eq("id",I.id);if(S)throw S}else{const{error:S}=await le.from("loyalty_campaigns").insert(F);if(S)throw S}await x()},R=async I=>{const{error:F}=await le.from("loyalty_campaigns").delete().eq("id",I);if(F)throw F;await x()},D=async I=>{const F={mission_key:I.missionKey,title:I.title,subtitle:I.subtitle,emoji:I.emoji,description:I.description,points_reward:I.pointsReward,mission_type:I.missionType,questions_json:I.questionsJson,max_photos:I.maxPhotos,is_repeatable:I.isRepeatable,repeat_interval_days:I.repeatIntervalDays,prerequisite_mission_id:I.prerequisiteMissionId,min_tier:I.minTier,display_order:I.displayOrder,is_active:I.isActive,is_published:I.isPublished};if(I.id){const{error:S}=await le.from("loyalty_missions").update(F).eq("id",I.id);if(S)throw S}else{const{error:S}=await le.from("loyalty_missions").insert(F);if(S)throw S}await v()},B=async I=>{const{error:F}=await le.from("loyalty_missions").delete().eq("id",I);if(F)throw F;await v()},q=async I=>{const{error:F}=await le.from("loyalty_settings").update({setting_value:{enabled:I.enabled,points_per_real:I.pointsPerReal,points_expiry_months:I.pointsExpiryMonths,weekly_mission_limit:I.weeklyMissionLimit}}).eq("setting_key","general");if(F)throw F;l(I)},Y=async I=>{const{error:F}=await le.from("loyalty_settings").update({setting_value:{welcome:I.welcome,level_up:I.levelUp,points_earned:I.pointsEarned,points_expiring:I.pointsExpiring}}).eq("setting_key","messages");if(F)throw F;c(I)},G=async(I,F,S,E)=>{const{error:N}=await le.from("point_transactions").insert({user_id:I,type:F>0?"earn":"redemption",points:F,description:`Ajuste manual: ${S}`});if(N)throw N;const{data:C}=await le.from("customer_loyalty").select("current_points").eq("user_id",I).single();C&&await le.from("customer_loyalty").update({current_points:C.current_points+F,lifetime_points:F>0?C.current_points+F:void 0}).eq("user_id",I)};return P.useEffect(()=>{p()},[p]),{tiers:e,campaigns:r,missions:a,settings:o,messages:d,reportData:u,isLoading:f,fetchAll:p,saveTier:j,deleteTier:T,saveCampaign:O,deleteCampaign:R,saveMission:D,deleteMission:B,saveSettings:q,saveMessages:Y,adjustPoints:G}}const C3=[{value:"discount_fixed",label:"Desconto fixo (R$)",icon:Uo},{value:"discount_percentage",label:"Desconto (%)",icon:Uo},{value:"free_shipping",label:"Frete grtis",icon:yn},{value:"gift",label:"Brinde fsico",icon:Pn},{value:"vip_access",label:"Acesso VIP",icon:Vi}],E3=[{value:"catalog",label:"Apenas Catlogo"},{value:"live",label:"Apenas Lives"},{value:"both",label:"Catlogo e Lives"}];function vwe({onBack:e}){const[t,r]=P.useState([]),[s,a]=P.useState([]),[i,o]=P.useState(!0),[l,d]=P.useState(""),[c,u]=P.useState("all"),[h,f]=P.useState(!1),[m,p]=P.useState(null),[g,x]=P.useState(!1),[v,y]=P.useState({name:"",description:"",type:"discount_fixed",points_cost:1e3,discount_value:30,min_tier:"poa",min_order_value:0,channel:"catalog",max_per_customer:1,stock_qty:null,unlimited_stock:!0,is_active:!0,is_featured:!1}),b=P.useCallback(async()=>{o(!0);try{const[I,F]=await Promise.all([le.from("loyalty_rewards").select("*").order("points_cost",{ascending:!0}),le.from("loyalty_tiers").select("id, slug, name").eq("is_active",!0).order("display_order")]);I.data&&r(I.data),F.data&&a(F.data)}catch(I){console.error("Error fetching data:",I),de.error("Erro ao carregar dados")}finally{o(!1)}},[]);P.useEffect(()=>{b()},[b]);const j=()=>{y({name:"",description:"",type:"discount_fixed",points_cost:1e3,discount_value:30,min_tier:"poa",min_order_value:0,channel:"catalog",max_per_customer:1,stock_qty:null,unlimited_stock:!0,is_active:!0,is_featured:!1}),p(null)},T=()=>{j(),f(!0)},O=I=>{p(I),y({name:I.name,description:I.description||"",type:I.type,points_cost:I.points_cost,discount_value:I.discount_value||0,min_tier:I.min_tier,min_order_value:I.min_order_value||0,channel:I.channel||"catalog",max_per_customer:I.max_per_customer||1,stock_qty:I.stock_qty,unlimited_stock:I.unlimited_stock,is_active:I.is_active,is_featured:I.is_featured}),f(!0)},R=async()=>{if(!v.name.trim()){de.error("Nome  obrigatrio");return}if(v.points_cost<=0){de.error("Custo em pontos deve ser maior que zero");return}x(!0);try{const I={name:v.name.trim(),description:v.description||null,type:v.type,points_cost:v.points_cost,discount_value:v.discount_value||null,min_tier:v.min_tier,min_order_value:v.min_order_value||null,channel:v.channel,max_per_customer:v.max_per_customer,stock_qty:v.unlimited_stock?null:v.stock_qty,unlimited_stock:v.unlimited_stock,is_active:v.is_active,is_featured:v.is_featured};if(m){const{error:F}=await le.from("loyalty_rewards").update(I).eq("id",m.id);if(F)throw F;de.success("Recompensa atualizada!")}else{const{error:F}=await le.from("loyalty_rewards").insert(I);if(F)throw F;de.success("Recompensa criada!")}f(!1),j(),b()}catch(I){console.error("Error saving reward:",I),de.error(I.message||"Erro ao salvar")}finally{x(!1)}},D=async(I,F)=>{try{const{error:S}=await le.from("loyalty_rewards").update({is_active:!F}).eq("id",I);if(S)throw S;b()}catch{de.error("Erro ao alterar status")}},B=async I=>{if(confirm("Tem certeza que deseja excluir esta recompensa?"))try{const{error:F}=await le.from("loyalty_rewards").delete().eq("id",I);if(F)throw F;de.success("Recompensa excluda"),b()}catch{de.error("Erro ao excluir")}},q=t.filter(I=>{const F=I.name.toLowerCase().includes(l.toLowerCase()),S=c==="all"||I.channel===c;return F&&S}),Y=I=>{const F=C3.find(S=>S.value===I);return(F==null?void 0:F.icon)||Pn},G=I=>{var F;return((F=s.find(S=>S.slug===I))==null?void 0:F.name)||I};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:e,children:n.jsx(Ts,{className:"h-5 w-5"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h2",{className:"text-xl font-serif",children:"Recompensas por Pontos"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Catlogo de itens que clientes podem resgatar com Pos"})]}),n.jsxs(he,{onClick:T,children:[n.jsx(kn,{className:"h-4 w-4 mr-1"}),"Nova Recompensa"]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar recompensas...",value:l,onChange:I=>d(I.target.value),className:"pl-10"})]}),n.jsxs(Xt,{value:c,onValueChange:u,children:[n.jsx(Ht,{className:"w-[180px]",children:n.jsx(Yt,{placeholder:"Canal"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todos os canais"}),E3.map(I=>n.jsx(qe,{value:I.value,children:I.label},I.value))]})]})]}),n.jsx($e,{children:n.jsx(Fe,{className:"p-0",children:i?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):q.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(Pn,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhuma recompensa encontrada"})]}):n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{children:"Recompensa"}),n.jsx(St,{children:"Tipo"}),n.jsx(St,{children:"Pontos"}),n.jsx(St,{children:"Canal"}),n.jsx(St,{children:"Nvel mn."}),n.jsx(St,{children:"Resgates"}),n.jsx(St,{children:"Status"}),n.jsx(St,{className:"text-right",children:"Aes"})]})}),n.jsx(ya,{children:q.map(I=>{var S,E;const F=Y(I.type);return n.jsxs(Kr,{children:[n.jsx(bt,{children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-muted rounded-lg flex items-center justify-center",children:n.jsx(F,{className:"h-5 w-5 text-muted-foreground"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"font-medium flex items-center gap-2",children:[I.name,I.is_featured&&n.jsx(wi,{className:"h-3 w-3 text-amber-500 fill-amber-500"})]}),I.description&&n.jsx("div",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:I.description})]})]})}),n.jsx(bt,{children:n.jsx(ke,{variant:"outline",children:((S=C3.find(N=>N.value===I.type))==null?void 0:S.label)||I.type})}),n.jsxs(bt,{children:[n.jsx("span",{className:"font-medium",children:I.points_cost}),n.jsx("span",{className:"text-muted-foreground text-xs ml-1",children:"pts"})]}),n.jsx(bt,{children:((E=E3.find(N=>N.value===I.channel))==null?void 0:E.label)||I.channel}),n.jsx(bt,{children:G(I.min_tier)}),n.jsxs(bt,{children:[I.current_redemptions,!I.unlimited_stock&&I.stock_qty!==null&&n.jsxs("span",{className:"text-muted-foreground",children:["/",I.stock_qty]})]}),n.jsx(bt,{children:n.jsx(ke,{variant:I.is_active?"default":"secondary",children:I.is_active?"Ativo":"Inativo"})}),n.jsx(bt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>O(I),children:n.jsx(Js,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>D(I.id,I.is_active),children:I.is_active?n.jsx(Iu,{className:"h-4 w-4 text-green-600"}):n.jsx(Mu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>B(I.id),children:n.jsx(ui,{className:"h-4 w-4 text-destructive"})})]})})]},I.id)})})]})})}),n.jsx(tn,{open:h,onOpenChange:f,children:n.jsxs(Jr,{className:"sm:max-w-lg max-h-[85vh] flex flex-col overflow-hidden",children:[n.jsx(ln,{children:n.jsx(rn,{children:m?"Editar Recompensa":"Nova Recompensa"})}),n.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 py-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Nome *"}),n.jsx(et,{value:v.name,onChange:I=>y({...v,name:I.target.value}),placeholder:"Ex: Cupom R$ 30"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Descrio"}),n.jsx(rs,{value:v.description,onChange:I=>y({...v,description:I.target.value}),placeholder:"Descrio curta da recompensa"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Tipo"}),n.jsxs(Xt,{value:v.type,onValueChange:I=>y({...v,type:I}),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsx(Gt,{children:C3.map(I=>n.jsx(qe,{value:I.value,children:I.label},I.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Custo em Pontos *"}),n.jsx(et,{type:"number",value:v.points_cost,onChange:I=>y({...v,points_cost:Number(I.target.value)})})]})]}),(v.type==="discount_fixed"||v.type==="discount_percentage"||v.type==="free_shipping")&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{children:["Valor do desconto ",v.type==="discount_percentage"?"(%)":"(R$)"]}),n.jsx(et,{type:"number",value:v.discount_value,onChange:I=>y({...v,discount_value:Number(I.target.value)})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Canal"}),n.jsxs(Xt,{value:v.channel,onValueChange:I=>y({...v,channel:I}),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsx(Gt,{children:E3.map(I=>n.jsx(qe,{value:I.value,children:I.label},I.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Nvel mnimo"}),n.jsxs(Xt,{value:v.min_tier,onValueChange:I=>y({...v,min_tier:I}),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsx(Gt,{children:s.map(I=>n.jsx(qe,{value:I.slug,children:I.name},I.slug))})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Valor mn. do pedido (R$)"}),n.jsx(et,{type:"number",value:v.min_order_value,onChange:I=>y({...v,min_order_value:Number(I.target.value)})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Mx. por cliente (30 dias)"}),n.jsx(et,{type:"number",value:v.max_per_customer,onChange:I=>y({...v,max_per_customer:Number(I.target.value)})})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ii,{checked:v.unlimited_stock,onCheckedChange:I=>y({...v,unlimited_stock:I})}),n.jsx(Be,{children:"Estoque ilimitado"})]}),!v.unlimited_stock&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Quantidade em estoque"}),n.jsx(et,{type:"number",value:v.stock_qty||"",onChange:I=>y({...v,stock_qty:Number(I.target.value)||null})})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ii,{checked:v.is_featured,onCheckedChange:I=>y({...v,is_featured:I})}),n.jsx(Be,{children:"Destaque (aparece primeiro)"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ii,{checked:v.is_active,onCheckedChange:I=>y({...v,is_active:I})}),n.jsx(Be,{children:"Ativo"})]})]})]}),n.jsxs(ba,{children:[n.jsx(he,{variant:"outline",onClick:()=>f(!1),children:"Cancelar"}),n.jsxs(he,{onClick:R,disabled:g,children:[g&&n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}),"Salvar"]})]})]})})]})}const k3=[{value:"catalog_only",label:"Apenas Catlogo"},{value:"live_only",label:"Apenas Lives"},{value:"both",label:"Catlogo e Lives"}],rM=[{value:"all_purchases",label:"Todas as compras"},{value:"min_value",label:"Valor mnimo"},{value:"first_n_paid",label:"Primeiros N pagos"}];function ywe({onBack:e}){const[t,r]=P.useState([]),[s,a]=P.useState([]),[i,o]=P.useState([]),[l,d]=P.useState(!0),[c,u]=P.useState(""),[h,f]=P.useState("all"),[m,p]=P.useState(!1),[g,x]=P.useState(null),[v,y]=P.useState(!1),[b,j]=P.useState({name:"",channel_scope:"both",condition_type:"min_value",condition_value:300,gift_id:"",gift_qty:1,max_per_customer:1,max_total_awards:null,priority:0,start_at:null,end_at:null,is_active:!0}),T=P.useCallback(async()=>{d(!0);try{const[S,E,N]=await Promise.all([le.from("gift_rules").select("*, gift:gifts(name, image_url)").order("priority",{ascending:!1}),le.from("gifts").select("id, name, image_url").eq("is_active",!0).order("name"),le.from("loyalty_tiers").select("slug, name").eq("is_active",!0).order("display_order")]);S.data&&r(S.data),E.data&&a(E.data),N.data&&o(N.data)}catch(S){console.error("Error fetching data:",S),de.error("Erro ao carregar dados")}finally{d(!1)}},[]);P.useEffect(()=>{T()},[T]);const O=()=>{j({name:"",channel_scope:"both",condition_type:"min_value",condition_value:300,gift_id:"",gift_qty:1,max_per_customer:1,max_total_awards:null,priority:0,start_at:null,end_at:null,is_active:!0}),x(null)},R=()=>{O(),p(!0)},D=S=>{x(S),j({name:S.name,channel_scope:S.channel_scope,condition_type:S.condition_type,condition_value:S.condition_value||0,gift_id:S.gift_id,gift_qty:S.gift_qty,max_per_customer:S.max_per_customer||1,max_total_awards:S.max_total_awards,priority:S.priority,start_at:S.start_at?new Date(S.start_at):null,end_at:S.end_at?new Date(S.end_at):null,is_active:S.is_active}),p(!0)},B=async()=>{var S,E;if(!b.name.trim()){de.error("Nome  obrigatrio");return}if(!b.gift_id){de.error("Selecione um brinde");return}if(b.condition_type==="min_value"&&(!b.condition_value||b.condition_value<=0)){de.error("Valor mnimo deve ser maior que zero");return}y(!0);try{const N={name:b.name.trim(),channel_scope:b.channel_scope,condition_type:b.condition_type,condition_value:b.condition_value||null,gift_id:b.gift_id,gift_qty:b.gift_qty,max_per_customer:b.max_per_customer,max_total_awards:b.max_total_awards,priority:b.priority,start_at:((S=b.start_at)==null?void 0:S.toISOString())||null,end_at:((E=b.end_at)==null?void 0:E.toISOString())||null,is_active:b.is_active};if(g){const{error:C}=await le.from("gift_rules").update(N).eq("id",g.id);if(C)throw C;de.success("Regra atualizada!")}else{const{error:C}=await le.from("gift_rules").insert(N);if(C)throw C;de.success("Regra criada!")}p(!1),O(),T()}catch(N){console.error("Error saving rule:",N),de.error(N.message||"Erro ao salvar")}finally{y(!1)}},q=async(S,E)=>{try{const{error:N}=await le.from("gift_rules").update({is_active:!E}).eq("id",S);if(N)throw N;T()}catch{de.error("Erro ao alterar status")}},Y=async S=>{if(confirm("Tem certeza que deseja excluir esta regra?"))try{const{error:E}=await le.from("gift_rules").delete().eq("id",S);if(E)throw E;de.success("Regra excluda"),T()}catch{de.error("Erro ao excluir")}},G=t.filter(S=>{const E=S.name.toLowerCase().includes(c.toLowerCase()),N=h==="all"||S.channel_scope===h;return E&&N}),I=S=>{if(!S.is_active)return{label:"Inativa",variant:"secondary"};const E=new Date;return S.start_at&&new Date(S.start_at)>E?{label:"Agendada",variant:"outline"}:S.end_at&&new Date(S.end_at)<E?{label:"Expirada",variant:"destructive"}:S.max_total_awards&&S.current_awards_count>=S.max_total_awards?{label:"Esgotada",variant:"destructive"}:{label:"Ativa",variant:"default"}},F=b.condition_type==="min_value"||b.condition_type==="first_n_paid";return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:e,children:n.jsx(Ts,{className:"h-5 w-5"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h2",{className:"text-xl font-serif",children:"Brindes Automticos"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Regras para adicionar brindes automaticamente ao carrinho"})]}),n.jsxs(he,{onClick:R,children:[n.jsx(kn,{className:"h-4 w-4 mr-1"}),"Nova Regra"]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar regras...",value:c,onChange:S=>u(S.target.value),className:"pl-10"})]}),n.jsxs(Xt,{value:h,onValueChange:f,children:[n.jsx(Ht,{className:"w-[180px]",children:n.jsx(Yt,{placeholder:"Canal"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todos os canais"}),k3.map(S=>n.jsx(qe,{value:S.value,children:S.label},S.value))]})]})]}),n.jsx($e,{children:n.jsx(Fe,{className:"p-0",children:l?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):G.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(W0,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhuma regra encontrada"})]}):n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{children:"Regra"}),n.jsx(St,{children:"Brinde"}),n.jsx(St,{children:"Condio"}),n.jsx(St,{children:"Canal"}),n.jsx(St,{children:"Aplicaes"}),n.jsx(St,{children:"Status"}),n.jsx(St,{className:"text-right",children:"Aes"})]})}),n.jsx(ya,{children:G.map(S=>{var N,C,k,M;const E=I(S);return n.jsxs(Kr,{children:[n.jsxs(bt,{children:[n.jsx("div",{className:"font-medium",children:S.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Prioridade: ",S.priority]})]}),n.jsx(bt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 bg-secondary rounded overflow-hidden shrink-0",children:(N=S.gift)!=null&&N.image_url?n.jsx("img",{src:S.gift.image_url,alt:"",className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Pn,{className:"h-3 w-3 text-muted-foreground"})})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm",children:((C=S.gift)==null?void 0:C.name)||""}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["x",S.gift_qty]})]})]})}),n.jsxs(bt,{children:[n.jsx("div",{className:"text-sm",children:(k=rM.find(U=>U.value===S.condition_type))==null?void 0:k.label}),S.condition_value&&n.jsx("div",{className:"text-xs text-muted-foreground",children:S.condition_type==="min_value"?`R$ ${S.condition_value.toFixed(2)}`:S.condition_value})]}),n.jsx(bt,{children:((M=k3.find(U=>U.value===S.channel_scope))==null?void 0:M.label)||S.channel_scope}),n.jsxs(bt,{children:[S.current_awards_count,S.max_total_awards&&` / ${S.max_total_awards}`]}),n.jsx(bt,{children:n.jsx(ke,{variant:E.variant,children:E.label})}),n.jsx(bt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>D(S),children:n.jsx(Js,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>q(S.id,S.is_active),children:S.is_active?n.jsx(Iu,{className:"h-4 w-4 text-green-600"}):n.jsx(Mu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>Y(S.id),children:n.jsx(ui,{className:"h-4 w-4 text-destructive"})})]})})]},S.id)})})]})})}),n.jsx(tn,{open:m,onOpenChange:p,children:n.jsxs(Jr,{className:"sm:max-w-lg max-h-[85vh] flex flex-col overflow-hidden",children:[n.jsx(ln,{children:n.jsx(rn,{children:g?"Editar Regra":"Nova Regra de Brinde"})}),n.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 py-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Nome da Regra *"}),n.jsx(et,{value:b.name,onChange:S=>j({...b,name:S.target.value}),placeholder:"Ex: Brinde acima de R$ 400"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{className:"col-span-2 space-y-2",children:[n.jsx(Be,{children:"Brinde *"}),n.jsxs(Xt,{value:b.gift_id,onValueChange:S=>j({...b,gift_id:S}),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecione"})}),n.jsx(Gt,{children:s.map(S=>n.jsx(qe,{value:S.id,children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Pn,{className:"h-3 w-3"}),S.name]})},S.id))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Qtd"}),n.jsx(et,{type:"number",min:"1",value:b.gift_qty,onChange:S=>j({...b,gift_qty:Number(S.target.value)||1})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Aplicar em"}),n.jsxs(Xt,{value:b.channel_scope,onValueChange:S=>j({...b,channel_scope:S}),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsx(Gt,{children:k3.map(S=>n.jsx(qe,{value:S.value,children:S.label},S.value))})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Condio"}),n.jsxs(Xt,{value:b.condition_type,onValueChange:S=>j({...b,condition_type:S}),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsx(Gt,{children:rM.map(S=>n.jsx(qe,{value:S.value,children:S.label},S.value))})]})]}),F&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:b.condition_type==="min_value"?"Valor mnimo (R$)":"Quantidade"}),n.jsx(et,{type:"number",value:b.condition_value,onChange:S=>j({...b,condition_value:Number(S.target.value)})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Mx. por cliente"}),n.jsx(et,{type:"number",value:b.max_per_customer,onChange:S=>j({...b,max_per_customer:Number(S.target.value)||1})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Mx. total (vazio = ilimitado)"}),n.jsx(et,{type:"number",value:b.max_total_awards||"",onChange:S=>j({...b,max_total_awards:S.target.value?Number(S.target.value):null}),placeholder:"Ilimitado"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Prioridade (maior = preferncia)"}),n.jsx(et,{type:"number",value:b.priority,onChange:S=>j({...b,priority:Number(S.target.value)})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Incio"}),n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("w-full justify-start text-left font-normal",!b.start_at&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),b.start_at?Wt(b.start_at,"dd/MM/yyyy",{locale:mr}):"Imediato"]})}),n.jsx(Ga,{className:"w-auto p-0",children:n.jsx(_i,{mode:"single",selected:b.start_at||void 0,onSelect:S=>j({...b,start_at:S||null}),locale:mr})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Fim"}),n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("w-full justify-start text-left font-normal",!b.end_at&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),b.end_at?Wt(b.end_at,"dd/MM/yyyy",{locale:mr}):"Sem limite"]})}),n.jsx(Ga,{className:"w-auto p-0",children:n.jsx(_i,{mode:"single",selected:b.end_at||void 0,onSelect:S=>j({...b,end_at:S||null}),locale:mr})})]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ii,{checked:b.is_active,onCheckedChange:S=>j({...b,is_active:S})}),n.jsx(Be,{children:"Regra ativa"})]})]}),n.jsxs(ba,{children:[n.jsx(he,{variant:"outline",onClick:()=>p(!1),children:"Cancelar"}),n.jsxs(he,{onClick:B,disabled:v,children:[v&&n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}),"Salvar"]})]})]})})]})}function bwe(){const[e,t]=P.useState([]),[r,s]=P.useState(!0),[a,i]=P.useState(new Date().getMonth()+1),[o,l]=P.useState("all"),d=P.useCallback(async()=>{s(!0);try{const{data:m,error:p}=await le.rpc("get_birthday_members_of_month",{p_month:a});p?(console.error("Error fetching birthday members:",p),t([])):t((m||[]).map(g=>{var x;return{userId:g.user_id,email:g.user_email,name:g.user_name||((x=g.user_email)==null?void 0:x.split("@")[0])||"",birthDate:g.birth_date,whatsapp:g.whatsapp,tier:g.tier||"poa",discountPercent:g.discount_percent,couponCode:g.coupon_code,notifiedAt:g.notified_at,renotifiedAt:g.renotified_at,usedAt:g.used_at,orderId:g.order_id,discountId:g.discount_id}}))}catch(m){console.error("Birthday admin error:",m)}finally{s(!1)}},[a]);P.useEffect(()=>{d()},[d]);const c=P.useCallback(async(m,p=!1)=>{const{error:g}=await le.rpc("mark_birthday_notified",{p_discount_id:m,p_is_renotify:p});if(g)throw g;await d()},[d]),u=P.useCallback(async m=>{const{data:p,error:g}=await le.rpc("get_or_create_birthday_discount",{p_user_id:m});if(g)throw g;return await d(),p==null?void 0:p[0]},[d]),h=e.filter(m=>o==="all"?!0:o==="not_notified"?!m.notifiedAt&&!m.usedAt:o==="notified_not_used"?m.notifiedAt&&!m.usedAt:o==="used"?!!m.usedAt:o==="renotified"?!!m.renotifiedAt&&!m.usedAt:!0),f={total:e.length,notNotified:e.filter(m=>!m.notifiedAt&&!m.usedAt).length,notifiedNotUsed:e.filter(m=>m.notifiedAt&&!m.usedAt).length,used:e.filter(m=>!!m.usedAt).length};return{members:h,allMembers:e,isLoading:r,selectedMonth:a,setSelectedMonth:i,statusFilter:o,setStatusFilter:l,stats:f,markNotified:c,ensureDiscount:u,refetch:d}}const wwe={poa:5,poa_gold:10,poa_platinum:15,poa_black:20},nM=["","Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],sM={poa:"Po",poa_gold:"Gold",poa_platinum:"Platinum",poa_black:"Black"};function _we(){const{members:e,allMembers:t,isLoading:r,selectedMonth:s,setSelectedMonth:a,statusFilter:i,setStatusFilter:o,stats:l,markNotified:d,ensureDiscount:c,refetch:u}=bwe(),[h,f]=P.useState(null),m=async y=>{f(y.userId);try{let b=y.discountId,j=y.couponCode,T=y.discountPercent;if(!b){const D=await c(y.userId);D&&(b=D.discount_id,j=D.coupon_code,T=D.discount_percent)}b&&await d(b,!1);const O=y.name.split(" ")[0],R=encodeURIComponent(`Ol ${O}! 

Feliz aniversrio! Como membro ${sM[y.tier]||"Po"} do Le.Po Club, preparamos um presente especial para voc:

 ${T||wwe[y.tier]}% de desconto na sua prxima compra este ms!

Use o cupom: *${j||""}*

Vlido at o final do ms. Aproveite! `);if(y.whatsapp){const B=`https://wa.me/55${y.whatsapp.replace(/\D/g,"")}?text=${R}`;window.open(B,"_blank")}else await navigator.clipboard.writeText(decodeURIComponent(R)),de.info("Sem WhatsApp cadastrado. Mensagem copiada para a rea de transferncia.");de.success(`${O} marcada como notificada`)}catch(b){console.error("Error notifying:",b),de.error("Erro ao notificar")}finally{f(null)}},p=async y=>{if(y.discountId){f(y.userId);try{await d(y.discountId,!0);const b=y.name.split(" ")[0],j=g(),T=encodeURIComponent(`Oi ${b}! 

Lembrete: seu desconto de aniversrio de ${y.discountPercent}% ainda est ativo!

Faltam apenas ${j} dias para usar. No perca essa oportunidade!

Cupom: *${y.couponCode}*

Acesse: seuprovador.com.br`);if(y.whatsapp){const O=y.whatsapp.replace(/\D/g,"");window.open(`https://wa.me/55${O}?text=${T}`,"_blank")}else await navigator.clipboard.writeText(decodeURIComponent(T)),de.info("Mensagem copiada para a rea de transferncia.");de.success(`Reaviso enviado para ${b}`)}catch{de.error("Erro ao reenviar")}finally{f(null)}}};function g(){const y=new Date;return new Date(y.getFullYear(),y.getMonth()+1,0).getDate()-y.getDate()}function x(y){return y.usedAt?n.jsx(ke,{variant:"default",className:"bg-green-600 text-white",children:"Usou desconto"}):y.renotifiedAt?n.jsx(ke,{variant:"outline",className:"border-amber-500 text-amber-600",children:"Reavisada"}):y.notifiedAt?n.jsx(ke,{variant:"outline",className:"border-blue-500 text-blue-600",children:"Notificada"}):y.discountId?n.jsx(ke,{variant:"outline",className:"border-gray-400 text-gray-500",children:"No notificada"}):n.jsx(ke,{variant:"outline",className:"border-gray-300 text-gray-400",children:"Sem desconto"})}const v=s===new Date().getMonth()+1;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(Xt,{value:String(s),onValueChange:y=>a(Number(y)),children:[n.jsx(Ht,{className:"w-[160px]",children:n.jsx(Yt,{})}),n.jsx(Gt,{children:nM.slice(1).map((y,b)=>n.jsx(qe,{value:String(b+1),children:y},b+1))})]}),n.jsx(he,{variant:"ghost",size:"icon",onClick:u,disabled:r,children:n.jsx(Qr,{className:`h-4 w-4 ${r?"animate-spin":""}`})})]}),n.jsxs(Xt,{value:i,onValueChange:y=>o(y),children:[n.jsxs(Ht,{className:"w-[200px]",children:[n.jsx(Ru,{className:"h-4 w-4 mr-2"}),n.jsx(Yt,{})]}),n.jsxs(Gt,{children:[n.jsxs(qe,{value:"all",children:["Todas (",l.total,")"]}),n.jsxs(qe,{value:"not_notified",children:["No notificadas (",l.notNotified,")"]}),n.jsxs(qe,{value:"notified_not_used",children:["Notificadas s/ uso (",l.notifiedNotUsed,")"]}),n.jsxs(qe,{value:"used",children:["Usaram desconto (",l.used,")"]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[n.jsx($e,{children:n.jsxs(Fe,{className:"p-4 text-center",children:[n.jsx(SS,{className:"h-5 w-5 mx-auto mb-1 text-pink-500"}),n.jsx("div",{className:"text-2xl font-bold",children:l.total}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Aniversariantes"})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4 text-center",children:[n.jsx(Sn,{className:"h-5 w-5 mx-auto mb-1 text-gray-400"}),n.jsx("div",{className:"text-2xl font-bold",children:l.notNotified}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"No notificadas"})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4 text-center",children:[n.jsx(Lr,{className:"h-5 w-5 mx-auto mb-1 text-blue-500"}),n.jsx("div",{className:"text-2xl font-bold",children:l.notifiedNotUsed}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Sem uso"})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4 text-center",children:[n.jsx(mn,{className:"h-5 w-5 mx-auto mb-1 text-green-500"}),n.jsx("div",{className:"text-2xl font-bold",children:l.used}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Usaram"})]})})]}),r?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(SS,{className:"h-12 w-12 mx-auto mb-3 opacity-30"}),n.jsxs("p",{children:["Nenhuma aniversariante ",i!=="all"?"com esse filtro ":"","em ",nM[s]]})]}):n.jsx("div",{className:"space-y-3",children:e.map(y=>n.jsx($e,{className:"overflow-hidden",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"font-medium truncate",children:y.name}),x(y)]}),n.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-xs text-muted-foreground",children:[n.jsx("span",{children:new Date(y.birthDate+"T12:00:00").toLocaleDateString("pt-BR",{day:"numeric",month:"long"})}),n.jsx("span",{className:"font-medium",children:sM[y.tier]||"Po"}),y.discountPercent&&n.jsxs("span",{className:"text-green-600 font-medium",children:[y.discountPercent,"% off"]}),y.couponCode&&n.jsx("span",{className:"font-mono text-[10px] bg-muted px-1.5 py-0.5 rounded",children:y.couponCode})]}),n.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-[10px] text-muted-foreground mt-2",children:[y.notifiedAt&&n.jsxs("span",{children:["Notificada: ",new Date(y.notifiedAt).toLocaleDateString("pt-BR")]}),y.renotifiedAt&&n.jsxs("span",{children:["Reaviso: ",new Date(y.renotifiedAt).toLocaleDateString("pt-BR")]}),y.usedAt&&n.jsxs("span",{className:"text-green-600",children:["Usou: ",new Date(y.usedAt).toLocaleDateString("pt-BR")]})]})]}),n.jsx("div",{className:"flex gap-2 shrink-0",children:!y.usedAt&&n.jsx(n.Fragment,{children:y.notifiedAt?y.renotifiedAt?n.jsx("span",{className:"text-xs text-muted-foreground italic",children:"J reavisada"}):n.jsxs(he,{size:"sm",variant:"outline",onClick:()=>p(y),disabled:h===y.userId,className:"gap-1.5",children:[h===y.userId?n.jsx(Et,{className:"h-3.5 w-3.5 animate-spin"}):n.jsx(Qr,{className:"h-3.5 w-3.5"}),"Reaviso"]}):n.jsxs(he,{size:"sm",onClick:()=>m(y),disabled:h===y.userId,className:"gap-1.5",children:[h===y.userId?n.jsx(Et,{className:"h-3.5 w-3.5 animate-spin"}):n.jsx(r_,{className:"h-3.5 w-3.5"}),"Enviar mensagem"]})})})]})})},y.userId))}),!r&&v&&l.total>0&&n.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-3",children:n.jsxs("p",{className:"text-xs text-amber-700 dark:text-amber-300",children:[n.jsx("strong",{children:"Dica:"}),' Prximo ao final do ms, use o boto "Reaviso" para lembrar as clientes que ainda no usaram o desconto de aniversrio. Faltam'," ",n.jsxs("strong",{children:[g()," dias"]})," para encerrar as promoes deste ms."]})})]})}function jwe(){const{tiers:e,campaigns:t,missions:r,settings:s,messages:a,reportData:i,isLoading:o,saveTier:l,deleteTier:d,saveCampaign:c,deleteCampaign:u,saveMission:h,deleteMission:f,saveSettings:m,saveMessages:p}=xwe(),[g,x]=P.useState("config");return o?n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):n.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl sm:text-2xl font-serif",children:"Le.Po Club"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Programa de fidelidade e gamificao"})]}),s&&n.jsxs(ke,{variant:s.enabled?"default":"secondary",className:"gap-1 w-fit",children:[s.enabled?n.jsx(Iu,{className:"h-3 w-3"}):n.jsx(Mu,{className:"h-3 w-3"}),s.enabled?"Ativo":"Inativo"]})]}),n.jsxs(Hi,{value:g,onValueChange:x,children:[n.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:n.jsxs(Si,{className:"inline-flex w-max sm:grid sm:grid-cols-7 sm:w-full bg-muted/50 p-1",children:[n.jsxs(br,{value:"config",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(az,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Config"})]}),n.jsxs(br,{value:"tiers",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(XF,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Nveis"})]}),n.jsxs(br,{value:"campaigns",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(rz,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Campanhas"})]}),n.jsxs(br,{value:"rewards",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(Pn,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Recompensas"})]}),n.jsxs(br,{value:"missions",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(li,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Misses"})]}),n.jsxs(br,{value:"birthdays",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(SS,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Aniversrios"})]}),n.jsxs(br,{value:"reports",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(fc,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Relatrios"})]})]})}),n.jsx(kr,{value:"config",className:"space-y-4 sm:space-y-6",children:n.jsx(Nwe,{settings:s,messages:a,onSaveSettings:m,onSaveMessages:p})}),n.jsx(kr,{value:"tiers",className:"space-y-4 sm:space-y-6",children:n.jsx(Swe,{tiers:e,onSave:l,onDelete:d})}),n.jsx(kr,{value:"campaigns",className:"space-y-4 sm:space-y-6",children:n.jsx(Cwe,{campaigns:t,tiers:e,onSave:c,onDelete:u})}),n.jsx(kr,{value:"rewards",className:"space-y-4 sm:space-y-6",children:n.jsx(Ewe,{tiers:e})}),n.jsx(kr,{value:"missions",className:"space-y-4 sm:space-y-6",children:n.jsx(kwe,{missions:r,tiers:e,onSave:h,onDelete:f})}),n.jsx(kr,{value:"reports",className:"space-y-4 sm:space-y-6",children:n.jsx(Awe,{data:i,tiers:e})}),n.jsx(kr,{value:"birthdays",className:"space-y-4 sm:space-y-6",children:n.jsx(_we,{})})]})]})}function Nwe({settings:e,messages:t,onSaveSettings:r,onSaveMessages:s}){const[a,i]=P.useState(e),[o,l]=P.useState(t),[d,c]=P.useState(!1),u=async()=>{c(!0);try{await r(a),await s(o),de.success("Configuraes salvas!")}catch{de.error("Erro ao salvar")}finally{c(!1)}};return a?n.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[n.jsxs($e,{children:[n.jsxs(Dt,{children:[n.jsx(Lt,{children:"Configuraes Gerais"}),n.jsx(qi,{children:"Regras do programa de pontos"})]}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Be,{htmlFor:"enabled",children:"Programa ativo"}),n.jsx(ii,{id:"enabled",checked:a.enabled,onCheckedChange:h=>i({...a,enabled:h})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Pontos por R$ pago"}),n.jsx(et,{type:"number",value:a.pointsPerReal,onChange:h=>i({...a,pointsPerReal:Number(h.target.value)})}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Pontos creditados somente quando o pedido for PAGO"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Expirao de pontos (meses)"}),n.jsx(et,{type:"number",value:a.pointsExpiryMonths,onChange:h=>i({...a,pointsExpiryMonths:Number(h.target.value)})}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Pontos expiram aps este perodo (FIFO)"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Limite semanal de misses (pontos)"}),n.jsx(et,{type:"number",value:a.weeklyMissionLimit,onChange:h=>i({...a,weeklyMissionLimit:Number(h.target.value)})})]}),n.jsx("div",{className:"pt-4 border-t",children:n.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[n.jsx("strong",{children:"Regra de estorno:"})," Se pedido for CANCELADO/ESTORNADO, os pontos so automaticamente removidos."]})})]})]}),n.jsxs($e,{children:[n.jsxs(Dt,{children:[n.jsx(Lt,{children:"Mensagens do Club"}),n.jsx(qi,{children:"Textos exibidos para os clientes"})]}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Boas-vindas"}),n.jsx(rs,{value:(o==null?void 0:o.welcome)||"",onChange:h=>l({...o,welcome:h.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Subiu de nvel"}),n.jsx(rs,{value:(o==null?void 0:o.levelUp)||"",onChange:h=>l({...o,levelUp:h.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{children:["Ganhou pontos (use ","{points}",")"]}),n.jsx(rs,{value:(o==null?void 0:o.pointsEarned)||"",onChange:h=>l({...o,pointsEarned:h.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{children:["Pontos expirando (use ","{days}",")"]}),n.jsx(rs,{value:(o==null?void 0:o.pointsExpiring)||"",onChange:h=>l({...o,pointsExpiring:h.target.value})})]})]})]}),n.jsx("div",{className:"md:col-span-2",children:n.jsxs(he,{onClick:u,disabled:d,className:"w-full sm:w-auto",children:[d?n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}):null,"Salvar Configuraes"]})})]}):null}function Swe({tiers:e,onSave:t,onDelete:r}){const[s,a]=P.useState(null),[i,o]=P.useState(!1),l=async()=>{if(!(s!=null&&s.name)||!(s!=null&&s.slug)){de.error("Nome e slug so obrigatrios");return}o(!0);try{await t(s),a(null),de.success("Nvel salvo!")}catch{de.error("Erro ao salvar")}finally{o(!1)}};return n.jsxs($e,{children:[n.jsxs(Dt,{className:"flex flex-row items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(Lt,{children:"Nveis do Club"}),n.jsx(qi,{children:"Configure os tiers de fidelidade"})]}),n.jsxs(he,{onClick:()=>a({isActive:!0,multiplier:1,displayOrder:e.length}),size:"sm",children:[n.jsx(kn,{className:"h-4 w-4 mr-1"})," Novo Nvel"]})]}),n.jsx(Fe,{children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{children:"Ordem"}),n.jsx(St,{children:"Nome"}),n.jsx(St,{children:"Pontos"}),n.jsx(St,{children:"Multiplicador"}),n.jsx(St,{children:"Status"}),n.jsx(St,{className:"text-right",children:"Aes"})]})}),n.jsx(ya,{children:e.map(d=>n.jsxs(Kr,{children:[n.jsx(bt,{children:d.displayOrder}),n.jsx(bt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:d.badgeColor}}),n.jsx("span",{className:"font-medium",children:d.name})]})}),n.jsxs(bt,{children:[d.minPoints.toLocaleString()," - ",d.maxPoints?d.maxPoints.toLocaleString():""]}),n.jsxs(bt,{children:[d.multiplier,"x"]}),n.jsx(bt,{children:n.jsx(ke,{variant:d.isActive?"default":"secondary",children:d.isActive?"Ativo":"Inativo"})}),n.jsxs(bt,{className:"text-right",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>a(d),children:n.jsx(Js,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>r(d.id),children:n.jsx(ui,{className:"h-4 w-4 text-destructive"})})]})]},d.id))})]})}),n.jsx(tn,{open:!!s,onOpenChange:d=>!d&&a(null),children:n.jsxs(Jr,{children:[n.jsx(ln,{children:n.jsx(rn,{children:s!=null&&s.id?"Editar Nvel":"Novo Nvel"})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Nome"}),n.jsx(et,{value:(s==null?void 0:s.name)||"",onChange:d=>a({...s,name:d.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Slug"}),n.jsx(et,{value:(s==null?void 0:s.slug)||"",onChange:d=>a({...s,slug:d.target.value})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Pontos mnimos"}),n.jsx(et,{type:"number",value:(s==null?void 0:s.minPoints)||0,onChange:d=>a({...s,minPoints:Number(d.target.value)})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Pontos mximos"}),n.jsx(et,{type:"number",value:(s==null?void 0:s.maxPoints)||"",onChange:d=>a({...s,maxPoints:d.target.value?Number(d.target.value):null}),placeholder:""})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Multiplicador"}),n.jsx(et,{type:"number",step:"0.1",value:(s==null?void 0:s.multiplier)||1,onChange:d=>a({...s,multiplier:Number(d.target.value)})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Cor do badge"}),n.jsx(et,{type:"color",value:(s==null?void 0:s.badgeColor)||"#8B7355",onChange:d=>a({...s,badgeColor:d.target.value})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Benefcios"}),n.jsx(rs,{value:(s==null?void 0:s.benefits)||"",onChange:d=>a({...s,benefits:d.target.value})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ii,{checked:(s==null?void 0:s.isActive)??!0,onCheckedChange:d=>a({...s,isActive:d})}),n.jsx(Be,{children:"Ativo"})]})]}),n.jsxs(ba,{children:[n.jsx(he,{variant:"outline",onClick:()=>a(null),children:"Cancelar"}),n.jsxs(he,{onClick:l,disabled:i,children:[i&&n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}),"Salvar"]})]})]})})]})}function Cwe({campaigns:e,tiers:t,onSave:r,onDelete:s}){var u,h;const[a,i]=P.useState(null),[o,l]=P.useState(!1),d=async()=>{if(!(a!=null&&a.name)){de.error("Nome  obrigatrio");return}l(!0);try{await r(a),i(null),de.success("Campanha salva!")}catch{de.error("Erro ao salvar")}finally{l(!1)}},c=[{value:"multiplier",label:"Multiplicador de pontos"},{value:"bonus_points",label:"Pontos bnus"},{value:"auto_gift",label:"Brinde automtico"},{value:"mission_bonus",label:"Misso bnus"}];return n.jsxs($e,{children:[n.jsxs(Dt,{className:"flex flex-row items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(Lt,{children:"Campanhas"}),n.jsx(qi,{children:"Promoes e multiplicadores temporrios"})]}),n.jsxs(he,{onClick:()=>i({isActive:!0,campaignType:"multiplier",multiplierValue:2,channelScope:"both",applicableTiers:["poa","poa_gold","poa_platinum","atelier"],priority:0}),size:"sm",children:[n.jsx(kn,{className:"h-4 w-4 mr-1"})," Nova Campanha"]})]}),n.jsx(Fe,{children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{children:"Nome"}),n.jsx(St,{children:"Tipo"}),n.jsx(St,{children:"Canal"}),n.jsx(St,{children:"Perodo"}),n.jsx(St,{children:"Status"}),n.jsx(St,{className:"text-right",children:"Aes"})]})}),n.jsx(ya,{children:e.length===0?n.jsx(Kr,{children:n.jsx(bt,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"Nenhuma campanha cadastrada"})}):e.map(f=>{var m;return n.jsxs(Kr,{children:[n.jsx(bt,{className:"font-medium",children:f.name}),n.jsx(bt,{children:n.jsx(ke,{variant:"outline",children:((m=c.find(p=>p.value===f.campaignType))==null?void 0:m.label)||f.campaignType})}),n.jsx(bt,{className:"capitalize",children:f.channelScope}),n.jsxs(bt,{className:"text-sm",children:[f.startAt?new Date(f.startAt).toLocaleDateString("pt-BR"):"-","  ",f.endAt?new Date(f.endAt).toLocaleDateString("pt-BR"):""]}),n.jsx(bt,{children:n.jsx(ke,{variant:f.isActive?"default":"secondary",children:f.isActive?"Ativa":"Inativa"})}),n.jsxs(bt,{className:"text-right",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>i(f),children:n.jsx(Js,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>s(f.id),children:n.jsx(ui,{className:"h-4 w-4 text-destructive"})})]})]},f.id)})})]})}),n.jsx(tn,{open:!!a,onOpenChange:f=>!f&&i(null),children:n.jsxs(Jr,{className:"max-w-lg",children:[n.jsx(ln,{children:n.jsx(rn,{children:a!=null&&a.id?"Editar Campanha":"Nova Campanha"})}),n.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Nome"}),n.jsx(et,{value:(a==null?void 0:a.name)||"",onChange:f=>i({...a,name:f.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Descrio"}),n.jsx(rs,{value:(a==null?void 0:a.description)||"",onChange:f=>i({...a,description:f.target.value})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Tipo"}),n.jsxs(Xt,{value:(a==null?void 0:a.campaignType)||"multiplier",onValueChange:f=>i({...a,campaignType:f}),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsx(Gt,{children:c.map(f=>n.jsx(qe,{value:f.value,children:f.label},f.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Canal"}),n.jsxs(Xt,{value:(a==null?void 0:a.channelScope)||"both",onValueChange:f=>i({...a,channelScope:f}),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"both",children:"Ambos"}),n.jsx(qe,{value:"live",children:"S Live"}),n.jsx(qe,{value:"catalog",children:"S Catlogo"})]})]})]})]}),(a==null?void 0:a.campaignType)==="multiplier"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Multiplicador"}),n.jsx(et,{type:"number",step:"0.1",value:(a==null?void 0:a.multiplierValue)||2,onChange:f=>i({...a,multiplierValue:Number(f.target.value)})})]}),(a==null?void 0:a.campaignType)==="bonus_points"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Pontos bnus"}),n.jsx(et,{type:"number",value:(a==null?void 0:a.bonusPoints)||0,onChange:f=>i({...a,bonusPoints:Number(f.target.value)})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Incio"}),n.jsx(et,{type:"datetime-local",value:((u=a==null?void 0:a.startAt)==null?void 0:u.slice(0,16))||"",onChange:f=>i({...a,startAt:f.target.value?new Date(f.target.value).toISOString():null})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Fim"}),n.jsx(et,{type:"datetime-local",value:((h=a==null?void 0:a.endAt)==null?void 0:h.slice(0,16))||"",onChange:f=>i({...a,endAt:f.target.value?new Date(f.target.value).toISOString():null})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Valor mnimo do pedido"}),n.jsx(et,{type:"number",value:(a==null?void 0:a.minOrderValue)||"",onChange:f=>i({...a,minOrderValue:f.target.value?Number(f.target.value):null}),placeholder:"Sem mnimo"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ii,{checked:(a==null?void 0:a.isActive)??!0,onCheckedChange:f=>i({...a,isActive:f})}),n.jsx(Be,{children:"Campanha ativa"})]})]}),n.jsxs(ba,{children:[n.jsx(he,{variant:"outline",onClick:()=>i(null),children:"Cancelar"}),n.jsxs(he,{onClick:d,disabled:o,children:[o&&n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}),"Salvar"]})]})]})})]})}function Ewe({tiers:e}){const[t,r]=P.useState("menu");return t==="rewards"?n.jsx(vwe,{onBack:()=>r("menu")}):t==="rules"?n.jsx(ywe,{onBack:()=>r("menu")}):n.jsxs($e,{children:[n.jsxs(Dt,{children:[n.jsx(Lt,{children:"Recompensas & Brindes"}),n.jsx(qi,{children:"Gerencie recompensas por resgate de pontos e brindes automticos"})]}),n.jsxs(Fe,{children:[n.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[n.jsx($e,{className:"border-dashed hover:border-primary/50 transition-colors cursor-pointer",onClick:()=>r("rewards"),children:n.jsxs(Fe,{className:"p-6 text-center",children:[n.jsx(Pn,{className:"h-10 w-10 mx-auto mb-3 text-muted-foreground"}),n.jsx("h3",{className:"font-medium mb-1",children:"Resgate por Pontos"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Clientes trocam pontos por descontos, frete grtis ou brindes"}),n.jsx(he,{variant:"outline",size:"sm",children:"Gerenciar Recompensas"})]})}),n.jsx($e,{className:"border-dashed hover:border-primary/50 transition-colors cursor-pointer",onClick:()=>r("rules"),children:n.jsxs(Fe,{className:"p-6 text-center",children:[n.jsx(rz,{className:"h-10 w-10 mx-auto mb-3 text-muted-foreground"}),n.jsx("h3",{className:"font-medium mb-1",children:"Brindes Automticos"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Brindes adicionados automaticamente ao carrinho por regras"}),n.jsx(he,{variant:"outline",size:"sm",children:"Configurar Regras"})]})})]}),n.jsxs("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg",children:[n.jsx("h4",{className:"font-medium mb-2",children:"Nveis e elegibilidade"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(s=>n.jsxs(ke,{variant:"outline",style:{borderColor:s.badgeColor,color:s.badgeColor},children:[s.name," (",s.minPoints,"+ pts)"]},s.id))})]})]})]})}function kwe({missions:e,tiers:t,onSave:r,onDelete:s}){const[a,i]=P.useState(null),[o,l]=P.useState(!1),d=async()=>{if(!(a!=null&&a.title)||!(a!=null&&a.missionKey)){de.error("Ttulo e chave so obrigatrios");return}l(!0);try{await r(a),i(null),de.success("Misso salva!")}catch{de.error("Erro ao salvar")}finally{l(!1)}},c=[{value:"quiz",label:"Quiz/Perguntas"},{value:"profile_update",label:"Atualizar perfil"},{value:"photo_upload",label:"Enviar fotos"},{value:"first_purchase",label:"Primeira compra"},{value:"review",label:"Avaliao"}];return n.jsxs($e,{children:[n.jsxs(Dt,{className:"flex flex-row items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(Lt,{children:"Misses"}),n.jsx(qi,{children:"Questionrios e tarefas que do pontos"})]}),n.jsxs(he,{onClick:()=>i({isActive:!0,isPublished:!1,missionType:"quiz",pointsReward:50,maxPhotos:5,emoji:"",displayOrder:e.length,questionsJson:[]}),size:"sm",children:[n.jsx(kn,{className:"h-4 w-4 mr-1"})," Nova Misso"]})]}),n.jsx(Fe,{children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{children:"Misso"}),n.jsx(St,{children:"Tipo"}),n.jsx(St,{children:"Pontos"}),n.jsx(St,{children:"Status"}),n.jsx(St,{className:"text-right",children:"Aes"})]})}),n.jsx(ya,{children:e.length===0?n.jsx(Kr,{children:n.jsx(bt,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"Nenhuma misso cadastrada"})}):e.map(u=>{var h;return n.jsxs(Kr,{children:[n.jsx(bt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xl",children:u.emoji}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:u.title}),n.jsx("div",{className:"text-xs text-muted-foreground",children:u.subtitle})]})]})}),n.jsx(bt,{children:n.jsx(ke,{variant:"outline",children:((h=c.find(f=>f.value===u.missionType))==null?void 0:h.label)||u.missionType})}),n.jsxs(bt,{children:["+",u.pointsReward," pts"]}),n.jsx(bt,{children:n.jsxs("div",{className:"flex gap-1",children:[n.jsx(ke,{variant:u.isActive?"default":"secondary",children:u.isActive?"Ativo":"Inativo"}),u.isPublished&&n.jsx(ke,{variant:"outline",children:"Publicado"})]})}),n.jsxs(bt,{className:"text-right",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>i(u),children:n.jsx(Js,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>s(u.id),children:n.jsx(ui,{className:"h-4 w-4 text-destructive"})})]})]},u.id)})})]})}),n.jsx(tn,{open:!!a,onOpenChange:u=>!u&&i(null),children:n.jsxs(Jr,{className:"max-w-lg",children:[n.jsx(ln,{children:n.jsx(rn,{children:a!=null&&a.id?"Editar Misso":"Nova Misso"})}),n.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:[n.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Emoji"}),n.jsx(et,{value:(a==null?void 0:a.emoji)||"",onChange:u=>i({...a,emoji:u.target.value}),className:"text-center text-xl"})]}),n.jsxs("div",{className:"col-span-3 space-y-2",children:[n.jsx(Be,{children:"Ttulo"}),n.jsx(et,{value:(a==null?void 0:a.title)||"",onChange:u=>i({...a,title:u.target.value})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Chave nica"}),n.jsx(et,{value:(a==null?void 0:a.missionKey)||"",onChange:u=>i({...a,missionKey:u.target.value.toLowerCase().replace(/\s+/g,"_")}),placeholder:"ex: mission_trabalho"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Subttulo"}),n.jsx(et,{value:(a==null?void 0:a.subtitle)||"",onChange:u=>i({...a,subtitle:u.target.value})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Tipo"}),n.jsxs(Xt,{value:(a==null?void 0:a.missionType)||"quiz",onValueChange:u=>i({...a,missionType:u}),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsx(Gt,{children:c.map(u=>n.jsx(qe,{value:u.value,children:u.label},u.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Pontos"}),n.jsx(et,{type:"number",value:(a==null?void 0:a.pointsReward)||50,onChange:u=>i({...a,pointsReward:Number(u.target.value)})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Descrio"}),n.jsx(rs,{value:(a==null?void 0:a.description)||"",onChange:u=>i({...a,description:u.target.value})})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ii,{checked:(a==null?void 0:a.isActive)??!0,onCheckedChange:u=>i({...a,isActive:u})}),n.jsx(Be,{children:"Ativo"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ii,{checked:(a==null?void 0:a.isPublished)??!1,onCheckedChange:u=>i({...a,isPublished:u})}),n.jsx(Be,{children:"Publicado"})]})]})]}),n.jsxs(ba,{children:[n.jsx(he,{variant:"outline",onClick:()=>i(null),children:"Cancelar"}),n.jsxs(he,{onClick:d,disabled:o,children:[o&&n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}),"Salvar"]})]})]})})]})}function Awe({data:e,tiers:t}){return e?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Pontos Emitidos"}),n.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["+",e.pointsEarned.toLocaleString()]})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Pontos Resgatados"}),n.jsxs("div",{className:"text-2xl font-bold text-amber-600",children:["-",e.pointsRedeemed.toLocaleString()]})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Pontos Expirados"}),n.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.pointsExpired.toLocaleString()})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Membros Ativos"}),n.jsx("div",{className:"text-2xl font-bold",children:e.activeUsers})]})})]}),n.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsx(Lt,{children:"Distribuio por Nvel"})}),n.jsx(Fe,{children:n.jsx("div",{className:"space-y-3",children:t.map(r=>{var o;const s=((o=e.tierDistribution.find(l=>l.tier===r.slug))==null?void 0:o.count)||0,a=e.activeUsers||1,i=Math.round(s/a*100);return n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:r.badgeColor}}),r.name]}),n.jsxs("span",{className:"text-muted-foreground",children:[s," (",i,"%)"]})]}),n.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full rounded-full",style:{width:`${i}%`,backgroundColor:r.badgeColor}})})]},r.id)})})})]}),n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsx(Lt,{children:"Top Recompensas"})}),n.jsx(Fe,{children:e.topRewards.length===0?n.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Nenhum resgate ainda"}):n.jsx("div",{className:"space-y-3",children:e.topRewards.map((r,s)=>n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{children:r.name}),n.jsxs(ke,{variant:"outline",children:[r.redemptions," resgates"]})]},s))})})]})]})]}):n.jsx("div",{className:"flex items-center justify-center py-20 text-muted-foreground",children:"Carregando relatrios..."})}function Twe(){const[e,t]=P.useState([]),[r,s]=P.useState(!0),a=P.useCallback(async()=>{s(!0);try{const{data:c,error:u}=await le.from("promotional_tables").select("*").order("priority",{ascending:!1});if(u)throw u;const h=m=>{if(!m)return[];if(Array.isArray(m))return m;if(typeof m=="string")try{const p=JSON.parse(m);return Array.isArray(p)?p:[]}catch{return[]}return[]},f=(c||[]).map(m=>({...m,category_discounts:h(m.category_discounts),product_discounts:h(m.product_discounts)}));t(f)}catch(c){console.error("Error fetching promotional tables:",c),de.error("Erro ao carregar tabelas promocionais")}finally{s(!1)}},[]);return P.useEffect(()=>{a()},[a]),{tables:e,isLoading:r,fetchTables:a,createTable:async c=>{try{const{error:u}=await le.from("promotional_tables").insert({...c,category_discounts:JSON.stringify(c.category_discounts),product_discounts:JSON.stringify(c.product_discounts)});if(u)throw u;return de.success("Tabela promocional criada!"),await a(),!0}catch(u){return console.error("Error creating promotional table:",u),de.error("Erro ao criar tabela promocional"),!1}},updateTable:async(c,u)=>{try{const h={...u};u.category_discounts&&(h.category_discounts=JSON.stringify(u.category_discounts)),u.product_discounts&&(h.product_discounts=JSON.stringify(u.product_discounts));const{error:f}=await le.from("promotional_tables").update(h).eq("id",c);if(f)throw f;return de.success("Tabela promocional atualizada!"),await a(),!0}catch(h){return console.error("Error updating promotional table:",h),de.error("Erro ao atualizar tabela promocional"),!1}},deleteTable:async c=>{try{const{error:u}=await le.from("promotional_tables").delete().eq("id",c);if(u)throw u;return de.success("Tabela promocional excluda!"),t(h=>h.filter(f=>f.id!==c)),!0}catch(u){return console.error("Error deleting promotional table:",u),de.error("Erro ao excluir tabela promocional"),!1}},toggleActive:async c=>{try{const{error:u}=await le.from("promotional_tables").update({is_active:!c.is_active}).eq("id",c.id);if(u)throw u;return t(h=>h.map(f=>f.id===c.id?{...f,is_active:!f.is_active}:f)),de.success(c.is_active?"Tabela desativada":"Tabela ativada"),!0}catch(u){return console.error("Error toggling table:",u),de.error("Erro ao atualizar tabela"),!1}}}}const Ny=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e);function Pwe({value:e,onChange:t}){const[r,s]=P.useState(!1),[a,i]=P.useState(""),[o,l]=P.useState([]),[d,c]=P.useState(!1),[u,h]=P.useState(!1),[f,m]=P.useState("percentage"),[p,g]=P.useState(""),[x,v]=P.useState(!1),[y,b]=P.useState(""),[j,T]=P.useState(!1);P.useEffect(()=>{if(!r)return;const N=setTimeout(()=>{O(a)},300);return()=>clearTimeout(N)},[a,r]),P.useEffect(()=>{r&&O("")},[r]);const O=async N=>{c(!0);try{let C=le.from("product_catalog").select("id, name, image_url, price, sku, is_active, stock_by_size, discount_type, discount_value").order("name").limit(50);N&&N.length>=2&&(C=C.or(`name.ilike.%${N}%,sku.ilike.%${N}%`));const{data:k,error:M}=await C;if(M)throw M;l(k||[])}catch(C){console.error("Error fetching products:",C)}finally{c(!1)}},R=P.useMemo(()=>{const N=new Set(e.map(C=>C.product_id));return o.filter(C=>!N.has(C.id))},[o,e]),D=P.useCallback(N=>{if(e.some(C=>C.product_id===N.id)){de.info("Produto j adicionado",{description:N.name});return}if(!N.is_active){de.warning("Produto inativo",{description:`${N.name} est inativo. Confirme se deseja adicionar.`,action:{label:"Adicionar mesmo assim",onClick:()=>B(N)}});return}B(N)},[e,u,f,p]),B=N=>{const C=u?f:"percentage",k=u&&p?parseFloat(p):10,M={product_id:N.id,product_name:N.name,discount_type:C,discount_value:k,price_base:"current",image_url:N.image_url||void 0,original_price:N.price,sku:N.sku||void 0,is_active:N.is_active};t([...e,M]),s(!1),i("")},q=N=>{t(e.filter(C=>C.product_id!==N))},Y=(N,C,k)=>{t(e.map(M=>M.product_id===N?{...M,[C]:C==="discount_value"?parseFloat(String(k))||0:k}:M))},G=()=>{if(!p)return;const N=parseFloat(p);t(e.map(C=>({...C,discount_type:f,discount_value:N}))),de.success(`Desconto aplicado a ${e.length} produtos`)},I=async()=>{if(y.trim()){T(!0);try{const N=y.split(/[\n,;\s]+/).map(V=>V.trim()).filter(V=>V.length>0);if(N.length===0){de.error("Nenhum SKU ou ID vlido encontrado");return}const{data:C,error:k}=await le.from("product_catalog").select("id, name, image_url, price, sku, is_active, stock_by_size").or(N.map(V=>`sku.eq.${V},id.eq.${V}`).join(","));if(k)throw k;const M=C||[],U=new Set(M.map(V=>V.sku||V.id)),$=N.filter(V=>!U.has(V)&&!M.some(H=>H.id===V));let X=0,Z=0;const re=new Set(e.map(V=>V.product_id)),W=[];for(const V of M){if(re.has(V.id)){Z++;continue}W.push({product_id:V.id,product_name:V.name,discount_type:f,discount_value:p?parseFloat(p):10,price_base:"current",image_url:V.image_url||void 0,original_price:V.price,sku:V.sku||void 0,is_active:V.is_active}),X++}t([...e,...W]);let J=`${X} produto(s) adicionado(s)`;Z>0&&(J+=`, ${Z} j existiam`),$.length>0&&(J+=`, ${$.length} no encontrado(s)`),de.success(J,{description:$.length>0?`No encontrados: ${$.slice(0,5).join(", ")}${$.length>5?"...":""}`:void 0}),v(!1),b("")}catch(N){console.error("Error processing paste:",N),de.error("Erro ao processar lista")}finally{T(!1)}}},F=N=>N.original_price?N.discount_type==="percentage"?N.original_price*(1-N.discount_value/100):Math.max(0,N.original_price-N.discount_value):null,S=N=>{if(N.discount_type==="percentage"){if(N.discount_value<=0||N.discount_value>90)return"Desconto % deve ser entre 1 e 90"}else if(N.discount_type==="fixed"&&N.original_price&&N.discount_value>=N.original_price)return"Desconto no pode ser maior que o preo";return null},E=P.useMemo(()=>{if(e.length===0)return null;const N=e.reduce((C,k)=>k.discount_type==="percentage"?C+k.discount_value:k.original_price&&k.original_price>0?C+k.discount_value/k.original_price*100:C,0)/e.length;return{count:e.length,avgDiscount:N.toFixed(1)}},[e]);return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ii,{id:"bulk-same-discount",checked:u,onCheckedChange:h}),n.jsx(Be,{htmlFor:"bulk-same-discount",className:"text-sm",children:"Aplicar mesmo desconto"})]}),u&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Xt,{value:f,onValueChange:N=>m(N),children:[n.jsx(Ht,{className:"w-20",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"percentage",children:"%"}),n.jsx(qe,{value:"fixed",children:"R$"})]})]}),n.jsx(et,{type:"number",min:"0",max:f==="percentage"?"90":void 0,placeholder:"Valor",value:p,onChange:N=>g(N.target.value),className:"w-24"}),e.length>0&&n.jsx(he,{variant:"outline",size:"sm",onClick:G,children:"Aplicar a todos"})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsxs(ci,{open:r,onOpenChange:s,children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:"flex-1 justify-start",children:[n.jsx(On,{className:"h-4 w-4 mr-2"}),"Buscar produto por nome ou SKU..."]})}),n.jsx(Ga,{className:"w-[400px] p-0",align:"start",children:n.jsxs(Ck,{shouldFilter:!1,children:[n.jsx(fW,{placeholder:"Digite nome ou SKU...",value:a,onValueChange:i}),n.jsx(Ek,{children:d?n.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Buscando..."}):R.length===0?n.jsx(kk,{children:a.length<2?"Digite ao menos 2 caracteres":"Nenhum produto encontrado"}):n.jsx(Ak,{children:R.slice(0,20).map(N=>{const C=A0e(N.stock_by_size);return n.jsxs(Tk,{value:N.id,onSelect:()=>D(N),className:"flex items-center gap-3 p-2",children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:N.image_url?n.jsx("img",{src:N.image_url,alt:N.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-medium text-sm truncate",children:N.name}),!N.is_active&&n.jsx(ke,{variant:"outline",className:"text-[10px] px-1",children:"Inativo"})]}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[N.sku||"Sem SKU","  ",Ny(N.price),"  ",C," un"]})]}),n.jsx(kn,{className:"h-4 w-4 shrink-0"})]},N.id)})})})]})})]}),n.jsxs(he,{variant:"outline",onClick:()=>v(!0),children:[n.jsx(Wb,{className:"h-4 w-4 mr-2"}),"Colar SKUs"]})]}),E&&n.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[n.jsxs("span",{children:[E.count," produto(s) selecionado(s)"]}),n.jsxs("span",{children:["Mdia: ",E.avgDiscount,"% desconto"]})]}),e.length>0?n.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:e.map(N=>{const C=F(N),k=S(N);return n.jsx("div",{className:He("p-3 rounded-lg border",k?"border-destructive/50 bg-destructive/5":"bg-muted/30"),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:N.image_url?n.jsx("img",{src:N.image_url,alt:N.product_name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"font-medium text-sm truncate",children:N.product_name||N.product_id.slice(0,8)}),N.is_active===!1&&n.jsxs(ke,{variant:"outline",className:"text-[10px] px-1",children:[n.jsx(Or,{className:"h-2.5 w-2.5 mr-0.5"}),"Inativo"]})]}),n.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[N.sku||"",N.original_price&&`  ${Ny(N.original_price)}`]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsxs(Xt,{value:N.discount_type,onValueChange:M=>Y(N.product_id,"discount_type",M),children:[n.jsx(Ht,{className:"w-16 h-8",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"percentage",children:n.jsx(Uo,{className:"h-3 w-3"})}),n.jsx(qe,{value:"fixed",children:n.jsx(ks,{className:"h-3 w-3"})})]})]}),n.jsx(et,{type:"number",min:"0",max:N.discount_type==="percentage"?"90":void 0,step:N.discount_type==="percentage"?"1":"0.01",value:N.discount_value,onChange:M=>Y(N.product_id,"discount_value",M.target.value),className:"w-20 h-8"}),C!==null&&N.original_price&&n.jsxs("span",{className:"text-sm",children:[n.jsx("span",{className:"text-muted-foreground line-through",children:Ny(N.original_price)}),"  ",n.jsx("span",{className:"font-medium text-green-600",children:Ny(C)})]})]}),k&&n.jsx("p",{className:"text-xs text-destructive mt-1",children:k})]}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 text-muted-foreground hover:text-destructive",onClick:()=>q(N.product_id),children:n.jsx(ui,{className:"h-4 w-4"})})]})},N.product_id)})}):n.jsxs("div",{className:"text-center py-8 text-muted-foreground border border-dashed rounded-lg",children:[n.jsx(Vt,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm",children:"Nenhum produto selecionado"}),n.jsx("p",{className:"text-xs",children:"Use a busca acima para adicionar produtos"})]}),n.jsx(tn,{open:x,onOpenChange:v,children:n.jsxs(Jr,{className:"sm:max-w-md",children:[n.jsx(ln,{children:n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(Wb,{className:"h-5 w-5"}),"Colar Lista de SKUs/IDs"]})}),n.jsxs("div",{className:"space-y-4",children:[n.jsx(rs,{placeholder:"Cole aqui os SKUs ou IDs separados por vrgula, espao ou nova linha...",value:y,onChange:N=>b(N.target.value),rows:6}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Exemplo: SKU001, SKU002, SKU003 ou um por linha"})]}),n.jsxs(ba,{children:[n.jsx(he,{variant:"outline",onClick:()=>v(!1),children:"Cancelar"}),n.jsx(he,{onClick:I,disabled:j||!y.trim(),children:j?"Processando...":n.jsxs(n.Fragment,{children:[n.jsx(gn,{className:"h-4 w-4 mr-1"}),"Processar"]})})]})]})})]})}const Owe=["vestidos","blusas","calas","saias","shorts","conjuntos","macaces","casacos","acessrios"];function Rwe({open:e,onOpenChange:t,table:r,onSubmit:s}){const a=!!r,[i,o]=P.useState(""),[l,d]=P.useState(""),[c,u]=P.useState(!0),[h,f]=P.useState(0),[m,p]=P.useState("all"),[g,x]=P.useState(),[v,y]=P.useState("00:00"),[b,j]=P.useState(),[T,O]=P.useState("23:59"),[R,D]=P.useState(""),[B,q]=P.useState(""),[Y,G]=P.useState(""),[I,F]=P.useState([]),[S,E]=P.useState(""),[N,C]=P.useState("percentage"),[k,M]=P.useState(""),[U,$]=P.useState([]),[X,Z]=P.useState(!1);P.useEffect(()=>{var ee,ie;if(e){if(r){if(o(r.name),d(r.description||""),u(r.is_active),f(r.priority),p(r.channel_scope),r.start_at){const oe=new Date(r.start_at);x(oe),y(Wt(oe,"HH:mm"))}else x(void 0),y("00:00");if(r.end_at){const oe=new Date(r.end_at);j(oe),O(Wt(oe,"HH:mm"))}else j(void 0),O("23:59");D(r.store_discount_type||""),q(((ee=r.store_discount_value)==null?void 0:ee.toString())||""),G(((ie=r.store_min_order_value)==null?void 0:ie.toString())||""),F(r.category_discounts||[]),$((r.product_discounts||[]).map(oe=>({product_id:oe.product_id,product_name:oe.product_name,discount_type:oe.discount_type,discount_value:oe.discount_value,price_base:"current"})))}else o(""),d(""),u(!0),f(0),p("all"),x(void 0),y("00:00"),j(void 0),O("23:59"),D(""),q(""),G(""),F([]),$([]);E(""),M("")}},[e,r]);const re=(ee,ie)=>{if(!ee)return null;const[oe,se]=ie.split(":").map(Number),ue=new Date(ee);return ue.setHours(oe,se,0,0),ue.toISOString()},W=()=>{if(!S||!k)return;const ee=I.find(ie=>ie.category===S);F(ee?ie=>ie.map(oe=>oe.category===S?{...oe,discount_type:N,discount_value:parseFloat(k)}:oe):ie=>[...ie,{category:S,discount_type:N,discount_value:parseFloat(k)}]),E(""),M("")},J=ee=>{F(ie=>ie.filter(oe=>oe.category!==ee))},V=()=>U.map(ee=>({product_id:ee.product_id,product_name:ee.product_name,discount_type:ee.discount_type,discount_value:ee.discount_value})),H=async()=>{if(i.trim()){Z(!0);try{const ee={name:i.trim(),description:l.trim()||null,is_active:c,priority:h,channel_scope:m,start_at:re(g,v),end_at:re(b,T),store_discount_type:R||null,store_discount_value:B?parseFloat(B):null,store_min_order_value:Y?parseFloat(Y):null,category_discounts:I,product_discounts:V(),user_id:null};await s(ee)&&t(!1)}finally{Z(!1)}}};return n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"!flex !flex-col sm:max-w-2xl max-h-[90vh] overflow-hidden p-0",children:[n.jsxs(ln,{className:"shrink-0 p-4 sm:p-6 pb-4 border-b",children:[n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(ua,{className:"h-5 w-5"}),a?"Editar Tabela Promocional":"Nova Tabela Promocional"]}),n.jsx(Vo,{children:a?"Atualize as regras de preo e agendamento":"Crie regras de desconto para loja, categorias ou produtos especficos"})]}),n.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto overscroll-contain px-4 sm:px-6",children:n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"name",children:"Nome da Tabela *"}),n.jsx(et,{id:"name",placeholder:"Ex: Black Friday 2025",value:i,onChange:ee=>o(ee.target.value)}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Uso interno, no aparece para o cliente"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"description",children:"Descrio (opcional)"}),n.jsx(rs,{id:"description",placeholder:"Detalhes sobre a promoo...",value:l,onChange:ee=>d(ee.target.value),rows:2})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ii,{id:"is_active",checked:c,onCheckedChange:u}),n.jsx(Be,{htmlFor:"is_active",children:"Ativa"})]}),n.jsxs("div",{className:"flex-1 space-y-1",children:[n.jsx(Be,{children:"Canal"}),n.jsxs(Xt,{value:m,onValueChange:ee=>p(ee),children:[n.jsx(Ht,{className:"w-full sm:w-40",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todos"}),n.jsx(qe,{value:"catalog",children:"S Catlogo"}),n.jsx(qe,{value:"live",children:"S Live"})]})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx(Be,{children:"Prioridade"}),n.jsx(et,{type:"number",min:"0",value:h,onChange:ee=>f(parseInt(ee.target.value)||0),className:"w-20"})]})]})]}),n.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[n.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[n.jsx(Lr,{className:"h-4 w-4"}),"Agendamento"]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Incio"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("flex-1 justify-start text-left font-normal",!g&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),g?Wt(g,"dd/MM/yy"):"Data"]})}),n.jsx(Ga,{className:"w-auto p-0",align:"start",children:n.jsx(_i,{mode:"single",selected:g,onSelect:x,locale:mr})})]}),n.jsx(et,{type:"time",value:v,onChange:ee=>y(ee.target.value),className:"w-24"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Fim"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("flex-1 justify-start text-left font-normal",!b&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),b?Wt(b,"dd/MM/yy"):"Data"]})}),n.jsx(Ga,{className:"w-auto p-0",align:"start",children:n.jsx(_i,{mode:"single",selected:b,onSelect:j,locale:mr})})]}),n.jsx(et,{type:"time",value:T,onChange:ee=>O(ee.target.value),className:"w-24"})]})]})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Deixe vazio para promoo sem limite de tempo"})]}),n.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[n.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[n.jsx(fa,{className:"h-4 w-4"}),"Desconto Geral da Loja"]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Aplica um desconto padro para toda a loja"}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Tipo"}),n.jsxs(Xt,{value:R,onValueChange:ee=>D(ee),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecionar"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"percentage",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Uo,{className:"h-3 w-3"})," Porcentagem"]})}),n.jsx(qe,{value:"fixed",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ks,{className:"h-3 w-3"})," Valor fixo"]})})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Desconto"}),n.jsxs("div",{className:"relative",children:[n.jsx(et,{type:"number",min:"0",step:R==="percentage"?"1":"0.01",value:B,onChange:ee=>q(ee.target.value),placeholder:"0",disabled:!R}),R&&n.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm",children:R==="percentage"?"%":"R$"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Valor Mnimo"}),n.jsxs("div",{className:"relative",children:[n.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm",children:"R$"}),n.jsx(et,{type:"number",min:"0",step:"0.01",value:Y,onChange:ee=>G(ee.target.value),placeholder:"0,00",className:"pl-10"})]})]})]})]}),n.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[n.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[n.jsx(ua,{className:"h-4 w-4"}),"Descontos por Categoria"]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Substituem o desconto geral da loja"}),I.length>0&&n.jsx("div",{className:"space-y-2",children:I.map(ee=>n.jsxs("div",{className:"flex items-center justify-between bg-secondary/50 rounded-lg px-3 py-2",children:[n.jsx("span",{className:"capitalize font-medium",children:ee.category}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm",children:ee.discount_type==="percentage"?`${ee.discount_value}%`:`R$ ${ee.discount_value.toFixed(2)}`}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>J(ee.category),children:n.jsx(sn,{className:"h-3 w-3"})})]})]},ee.category))}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsxs(Xt,{value:S,onValueChange:E,children:[n.jsx(Ht,{className:"flex-1",children:n.jsx(Yt,{placeholder:"Categoria"})}),n.jsx(Gt,{children:Owe.filter(ee=>!I.find(ie=>ie.category===ee)).map(ee=>n.jsx(qe,{value:ee,className:"capitalize",children:ee},ee))})]}),n.jsxs(Xt,{value:N,onValueChange:ee=>C(ee),children:[n.jsx(Ht,{className:"w-full sm:w-32",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"percentage",children:"%"}),n.jsx(qe,{value:"fixed",children:"R$"})]})]}),n.jsx(et,{type:"number",min:"0",placeholder:"Valor",value:k,onChange:ee=>M(ee.target.value),className:"w-full sm:w-24"}),n.jsx(he,{variant:"outline",size:"icon",onClick:W,disabled:!S||!k,children:n.jsx(kn,{className:"h-4 w-4"})})]})]}),n.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[n.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[n.jsx(Vt,{className:"h-4 w-4"}),"Descontos por Produto"]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Substituem descontos de categoria e geral. Busque e selecione produtos abaixo."}),n.jsx(Pwe,{value:U,onChange:$})]})]})}),n.jsx(ba,{className:"shrink-0 p-4 sm:p-6 border-t bg-background",children:n.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-2 w-full sm:w-auto",children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),disabled:X,className:"w-full sm:w-auto",children:"Cancelar"}),n.jsx(he,{onClick:H,disabled:X||!i.trim(),className:"w-full sm:w-auto",children:X?"Salvando...":a?"Salvar Alteraes":"Criar Tabela"})]})})]})})}function Mwe(){const{tables:e,isLoading:t,createTable:r,updateTable:s,deleteTable:a,toggleActive:i}=Twe(),[o,l]=P.useState(""),[d,c]=P.useState(!1),[u,h]=P.useState(null),[f,m]=P.useState(null),p=()=>{h(null),c(!0)},g=O=>{h(O),c(!0)},x=async O=>{confirm(`Excluir a tabela "${O.name}"?`)&&await a(O.id)},v=async O=>u?await s(u.id,O):await r(O),y=e.filter(O=>{var R;return O.name.toLowerCase().includes(o.toLowerCase())||((R=O.description)==null?void 0:R.toLowerCase().includes(o.toLowerCase()))}),b=O=>{if(!O.is_active)return{label:"Inativa",variant:"secondary"};const R=new Date;return O.start_at&&yw(Qd(O.start_at),R)?{label:"Agendada",variant:"outline"}:O.end_at&&qk(Qd(O.end_at),R)?{label:"Expirada",variant:"destructive"}:{label:"Ativa",variant:"default"}},j=(O,R)=>!O||!R?"-":O==="percentage"?`${R}%`:`R$ ${R.toFixed(2)}`,T=O=>{switch(O){case"catalog":return"Catlogo";case"live":return"Live";default:return"Todos"}};return n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[n.jsxs("div",{children:[n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(ua,{className:"h-5 w-5"}),"Tabelas Promocionais"]}),n.jsx(qi,{children:"Regras de preo com agendamento e descontos por loja, categoria ou produto"})]}),n.jsxs(he,{onClick:p,className:"w-full sm:w-auto",children:[n.jsx(kn,{className:"h-4 w-4 mr-1"}),"Nova Tabela"]})]})}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar tabelas...",value:o,onChange:O=>l(O.target.value),className:"pl-10"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Total"})]}),n.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(O=>b(O).label==="Ativa").length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Ativas"})]}),n.jsxs("div",{className:"p-3 bg-amber-50 dark:bg-amber-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:e.filter(O=>b(O).label==="Agendada").length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Agendadas"})]})]}),t?n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando..."}):y.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(ua,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhuma tabela promocional encontrada"}),n.jsx(he,{variant:"link",onClick:p,className:"mt-2",children:"Criar primeira tabela"})]}):n.jsx("div",{className:"space-y-3",children:y.map(O=>{const R=b(O),D=f===O.id,B=!!O.store_discount_type&&!!O.store_discount_value,q=O.category_discounts.length>0,Y=O.product_discounts.length>0;return n.jsx(pg,{open:D,onOpenChange:()=>m(D?null:O.id),children:n.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"p-4 bg-card flex flex-col sm:flex-row sm:items-center gap-3",children:[n.jsx(gg,{asChild:!0,children:n.jsxs("button",{className:"flex-1 flex items-start gap-3 text-left",children:[n.jsx("div",{className:"mt-1",children:D?n.jsx(ip,{className:"h-4 w-4 text-muted-foreground"}):n.jsx(zo,{className:"h-4 w-4 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("span",{className:"font-medium",children:O.name}),n.jsx(ke,{variant:R.variant,children:R.label}),n.jsx(ke,{variant:"outline",className:"text-xs",children:T(O.channel_scope)})]}),O.description&&n.jsx("p",{className:"text-sm text-muted-foreground mt-1 truncate",children:O.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground flex-wrap",children:[(O.start_at||O.end_at)&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Lr,{className:"h-3 w-3"}),O.start_at&&Wt(Qd(O.start_at),"dd/MM HH:mm",{locale:mr}),O.start_at&&O.end_at&&"  ",O.end_at&&Wt(Qd(O.end_at),"dd/MM HH:mm",{locale:mr})]}),B&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(fa,{className:"h-3 w-3"}),j(O.store_discount_type,O.store_discount_value)]}),q&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ua,{className:"h-3 w-3"}),O.category_discounts.length," cat."]}),Y&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Vt,{className:"h-3 w-3"}),O.product_discounts.length," prod."]})]})]})]})}),n.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>g(O),title:"Editar",children:n.jsx(Js,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>i(O),title:O.is_active?"Desativar":"Ativar",children:O.is_active?n.jsx(Iu,{className:"h-4 w-4 text-green-600"}):n.jsx(Mu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>x(O),title:"Excluir",children:n.jsx(ui,{className:"h-4 w-4 text-destructive"})})]})]}),n.jsx(xg,{children:n.jsxs("div",{className:"border-t p-4 bg-muted/30 space-y-4",children:[B&&n.jsxs("div",{children:[n.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[n.jsx(fa,{className:"h-4 w-4"}),"Desconto Geral"]}),n.jsxs("div",{className:"text-sm",children:[j(O.store_discount_type,O.store_discount_value),O.store_min_order_value&&O.store_min_order_value>0&&n.jsxs("span",{className:"text-muted-foreground ml-2",children:["(mn. R$ ",O.store_min_order_value.toFixed(2),")"]})]})]}),q&&n.jsxs("div",{children:[n.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[n.jsx(ua,{className:"h-4 w-4"}),"Por Categoria"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:O.category_discounts.map(G=>n.jsxs(ke,{variant:"secondary",className:"capitalize",children:[G.category,": ",j(G.discount_type,G.discount_value)]},G.category))})]}),Y&&n.jsxs("div",{children:[n.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[n.jsx(Vt,{className:"h-4 w-4"}),"Por Produto"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:O.product_discounts.map(G=>n.jsxs(ke,{variant:"secondary",children:[G.product_name||G.product_id.slice(0,8),":"," ",j(G.discount_type,G.discount_value)]},G.product_id))})]}),!B&&!q&&!Y&&n.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum desconto configurado"})]})})]})},O.id)})})]}),n.jsx(Rwe,{open:d,onOpenChange:c,table:u,onSubmit:v})]})}function Iwe(){const[e,t]=P.useState([]),[r,s]=P.useState(!0),[a,i]=P.useState(""),[o,l]=P.useState(null),d=async()=>{s(!0);try{const{data:f,error:m}=await le.from("profiles").select("user_id, name, whatsapp").order("created_at",{ascending:!1});if(m)throw m;const{data:p,error:g}=await le.from("user_roles").select("user_id, role");if(g)throw g;const{data:x}=await le.from("customers").select("user_id, email").not("user_id","is",null),v=(f||[]).map(y=>{const b=(p||[]).filter(T=>T.user_id===y.user_id).map(T=>T.role),j=(x||[]).find(T=>T.user_id===y.user_id);return{...y,roles:b,email:j==null?void 0:j.email}});t(v)}catch(f){console.error("Error loading profiles:",f),de.error("Erro ao carregar perfis.")}finally{s(!1)}};P.useEffect(()=>{d()},[]);const c=async(f,m)=>{l(f);try{const{error:p}=await le.from("user_roles").delete().eq("user_id",f);if(p)throw p;const{error:g}=await le.from("user_roles").insert({user_id:f,role:m});if(g)throw g;de.success("Permisses atualizadas!"),d()}catch(p){console.error("Error updating role:",p),de.error("Erro ao atualizar permisses.")}finally{l(null)}},u=e.filter(f=>{var m,p,g;return((m=f.name)==null?void 0:m.toLowerCase().includes(a.toLowerCase()))||((p=f.email)==null?void 0:p.toLowerCase().includes(a.toLowerCase()))||((g=f.whatsapp)==null?void 0:g.includes(a))||f.roles.some(x=>x.toLowerCase().includes(a.toLowerCase()))}),h=f=>f.includes("admin")?n.jsxs(ke,{className:"bg-rose-100 text-rose-700 border-rose-200 gap-1",children:[n.jsx(ES,{className:"h-3 w-3"})," Admin"]}):f.includes("merchant")?n.jsxs(ke,{className:"bg-amber-100 text-amber-700 border-amber-200 gap-1",children:[n.jsx(s_,{className:"h-3 w-3"})," Lojista"]}):n.jsx(ke,{variant:"outline",children:"Cliente"});return r?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-primary"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl font-semibold",children:"Gesto de Perfis e Acessos"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Gerencie quem pode acessar o painel administrativo."})]}),n.jsxs("div",{className:"relative w-full sm:w-64",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por nome, email ou papel...",className:"pl-9 h-9",value:a,onChange:f=>i(f.target.value)})]})]}),n.jsxs("div",{className:"grid gap-3",children:[u.map(f=>n.jsx($e,{className:"overflow-hidden",children:n.jsx(Fe,{className:"p-0",children:n.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-stretch",children:[n.jsxs("div",{className:"p-4 flex-1 flex items-center gap-4 w-full",children:[n.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:n.jsx(Dn,{className:"h-5 w-5 text-primary"})}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("h3",{className:"font-medium truncate",children:f.name||"Sem nome"}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-4 text-xs text-muted-foreground mt-1",children:[f.email&&n.jsx("span",{className:"truncate max-w-[150px] sm:max-w-none",children:f.email}),f.whatsapp&&n.jsx("span",{className:"shrink-0",children:f.whatsapp}),h(f.roles)]})]})]}),n.jsxs("div",{className:"p-4 bg-muted/30 border-t sm:border-t-0 sm:border-l w-full sm:w-auto flex items-center gap-3",children:[n.jsx("div",{className:"flex-1 sm:w-40",children:n.jsxs(Xt,{disabled:o===f.user_id,value:f.roles[0]||"customer",onValueChange:m=>c(f.user_id,m),children:[n.jsx(Ht,{className:"h-9",children:n.jsx(Yt,{placeholder:"Alterar papel"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"admin",children:"Administrador"}),n.jsx(qe,{value:"merchant",children:"Lojista / Gerente"}),n.jsx(qe,{value:"customer",children:"Cliente Comum"})]})]})}),o===f.user_id&&n.jsx(Et,{className:"h-4 w-4 animate-spin text-muted-foreground"})]})]})})},f.user_id)),u.length===0&&n.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-xl",children:[n.jsx(Dn,{className:"h-12 w-12 mx-auto text-muted-foreground opacity-20 mb-4"}),n.jsx("p",{className:"text-muted-foreground",children:"Nenhum perfil encontrado."})]})]}),n.jsxs($e,{className:"bg-amber-50 border-amber-100",children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-xs font-semibold flex items-center gap-2 text-amber-800 uppercase tracking-wider",children:[n.jsx(ES,{className:"h-4 w-4"}),"Ateno com Permisses"]})}),n.jsx(Fe,{children:n.jsxs("p",{className:"text-xs text-amber-700 leading-relaxed",children:["Alterar o papel de um usurio concede ou remove acesso imediato a reas sensveis do painel. ",n.jsx("br",{}),"Certifique-se da identidade do usurio antes de promover a ",n.jsx("span",{className:"font-bold",children:"Administrador"}),"."]})})]})]})}const Dwe=()=>{const e=pr(),[t,r]=hd(),s=t.get("tab"),a=t.get("filter"),[i,o]=P.useState(s||"overview");P.useEffect(()=>{s&&s!==i&&o(s)},[s]);const l=E=>{o(E);const N=new URLSearchParams(t);N.set("tab",E),E!==s&&N.delete("filter"),r(N)},[d,c]=P.useState(null),[u,h]=P.useState(null),[f,m]=P.useState([]),[p,g]=P.useState([]),[x,v]=P.useState({}),[y,b]=P.useState(!0),[j,T]=P.useState(!1),[O,R]=P.useState(null),[D,B]=P.useState("");P.useEffect(()=>{const{data:{subscription:E}}=le.auth.onAuthStateChange((N,C)=>{h(C),c((C==null?void 0:C.user)??null),C||e("/login")});return le.auth.getSession().then(({data:{session:N}})=>{h(N),c((N==null?void 0:N.user)??null),N||e("/login")}),()=>E.unsubscribe()},[e]),P.useEffect(()=>{d&&q()},[d]);const q=async()=>{try{const{data:E,error:N}=await le.from("customers").select("*").order("created_at",{ascending:!1});if(N)throw N;m(E||[]);const{data:C,error:k}=await le.from("print_requests").select("*").order("created_at",{ascending:!1});if(k)throw k;g(C||[]);const M=(C||[]).filter(U=>U.linked_product_id).map(U=>U.linked_product_id);if(M.length>0){const{data:U}=await le.from("product_catalog").select("id, name, image_url, price").in("id",M);if(U){const $={};U.forEach(X=>{$[X.id]=X}),v($)}}}catch(E){console.error("Error loading data:",E),de.error("Erro ao carregar dados")}finally{b(!1)}},Y=async()=>{await le.auth.signOut(),e("/login")},G=E=>{const{data:N}=le.storage.from("prints").getPublicUrl(E);return N.publicUrl},I=E=>new Date(E).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}),F=E=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(E),S=E=>{const N=f.find(C=>C.id===E.customer_id);R(E),B((N==null?void 0:N.phone)||""),T(!0)};return d?n.jsxs("div",{className:"min-h-screen bg-background overflow-x-hidden w-full max-w-full",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b border-border",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 h-14 sm:h-16 flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 min-w-0",children:[n.jsx(nwe,{activeTab:i,onTabChange:l,onLogout:Y,onImportStock:()=>e("/importar-estoque"),printCount:p.length}),n.jsx("img",{src:bf,alt:"LE.PO",className:"h-6 sm:h-8 shrink-0 max-w-[100px]"}),n.jsx("div",{className:"hidden md:block h-6 w-px bg-border"}),n.jsx("span",{className:"hidden md:block text-sm font-medium text-muted-foreground truncate",children:"Painel de Controle"})]}),n.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 shrink-0",children:[n.jsxs(he,{variant:"outline",onClick:()=>e("/importar-estoque"),size:"sm",className:"gap-2 hidden sm:flex h-9",children:[n.jsx(Gh,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden lg:inline",children:"Importar Estoque"})]}),n.jsxs(he,{variant:"ghost",onClick:Y,size:"sm",className:"gap-2 hidden md:flex h-9",children:[n.jsx(R6,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden lg:inline",children:"Sair"})]})]})]})}),n.jsx("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-4 sm:py-6 overflow-x-hidden w-full",children:n.jsxs(Hi,{value:i,onValueChange:l,className:"space-y-4 sm:space-y-6",children:[n.jsxs(Si,{className:"hidden md:flex flex-wrap bg-muted/50 p-1",children:[n.jsxs(br,{value:"overview",className:"gap-2",children:[n.jsx(O6,{className:"h-4 w-4"}),"Viso Geral"]}),n.jsxs(br,{value:"clientes",className:"gap-2",children:[n.jsx(oz,{className:"h-4 w-4"}),"Clientes"]}),n.jsxs(br,{value:"products",className:"gap-2",children:[n.jsx(Vt,{className:"h-4 w-4"}),"Produtos"]}),n.jsxs(br,{value:"orders",className:"gap-2",children:[n.jsx(hn,{className:"h-4 w-4"}),"Pedidos"]}),n.jsxs(br,{value:"lives",className:"gap-2",children:[n.jsx(Ss,{className:"h-4 w-4"}),"Lives"]}),n.jsxs(br,{value:"cupons",className:"gap-2",children:[n.jsx(Dh,{className:"h-4 w-4"}),"Cupons"]}),n.jsxs(br,{value:"promocoes",className:"gap-2",children:[n.jsx(ua,{className:"h-4 w-4"}),"Promoes"]}),n.jsxs(br,{value:"brindes",className:"gap-2",children:[n.jsx(Pn,{className:"h-4 w-4"}),"Brindes"]}),n.jsxs(br,{value:"club",className:"gap-2",children:[n.jsx(Vi,{className:"h-4 w-4"}),"Club"]}),n.jsxs(br,{value:"equipe",className:"gap-2",children:[n.jsx(Kb,{className:"h-4 w-4"}),"Equipe"]}),n.jsxs(br,{value:"profiles",className:"gap-2",children:[n.jsx(Kb,{className:"h-4 w-4"}),"Time e Acessos"]}),n.jsxs(br,{value:"prints",className:"gap-2",children:[n.jsx(P6,{className:"h-4 w-4"}),"Prints (",p.length,")"]})]}),n.jsx(kr,{value:"overview",children:n.jsx(rwe,{})}),n.jsx(kr,{value:"products",children:n.jsx(Z0e,{userId:d.id,initialFilter:a||void 0})}),n.jsx(kr,{value:"orders",children:n.jsx(v1e,{initialFilter:a||void 0})}),n.jsx(kr,{value:"prints",children:n.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[p.map(E=>{const N=f.find(k=>k.id===E.customer_id),C=E.linked_product_id?x[E.linked_product_id]:null;return n.jsxs("div",{className:"bg-card rounded-xl border border-border overflow-hidden",children:[n.jsx("div",{className:"aspect-square bg-secondary",children:n.jsx("img",{src:G(E.image_path),alt:"Print do story",className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"p-4 space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${C?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700"}`,children:C?"Vinculado":"Pendente"}),n.jsx("span",{className:"text-xs text-muted-foreground",children:I(E.created_at)})]}),n.jsxs("div",{className:"text-sm space-y-1",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Tel:"})," ",(N==null?void 0:N.phone)||"-"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Tamanho:"})," ",E.size||"-"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Preferncia:"})," ",E.preference==="ajustado"?"Mais ajustado":"Mais soltinho"]})]}),C&&n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Produto vinculado:"}),n.jsxs("div",{className:"flex items-center gap-3",children:[C.image_url?n.jsx("img",{src:C.image_url,alt:C.name,className:"w-10 h-10 object-cover rounded"}):n.jsx("div",{className:"w-10 h-10 bg-secondary rounded flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:C.name}),n.jsx("p",{className:"text-xs text-muted-foreground",children:F(C.price)})]})]})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"w-full gap-2",onClick:()=>S(E),children:[n.jsx(tz,{className:"h-4 w-4"}),C?"Alterar produto":"Vincular a produto"]})]})]},E.id)}),p.length===0&&n.jsx("div",{className:"col-span-full text-center py-12 text-muted-foreground",children:"Nenhum print recebido ainda."})]})}),n.jsx(kr,{value:"clientes",children:n.jsx(j1e,{})}),n.jsx(kr,{value:"lives",children:n.jsx(C1e,{})}),n.jsx(kr,{value:"cupons",children:n.jsx(abe,{})}),n.jsx(kr,{value:"promocoes",children:n.jsx(Mwe,{})}),n.jsx(kr,{value:"brindes",children:n.jsx(uwe,{})}),n.jsx(kr,{value:"club",children:n.jsx(jwe,{})}),n.jsx(kr,{value:"equipe",children:n.jsx(swe,{})}),n.jsx(kr,{value:"profiles",children:n.jsx(Iwe,{})})]})}),O&&n.jsx(Q0e,{open:j,onOpenChange:T,print:O,customerPhone:D,onSuccess:q})]}):null};function Lwe(){const[e,t]=P.useState(new Set),[r,s]=P.useState([]),[a,i]=P.useState(!0),o=P.useCallback(async()=>{try{const{data:c,error:u}=await le.from("live_products").select(`
          product_id,
          visibilidade,
          bloquear_desde_planejamento,
          live_event:live_events(id, titulo, status)
        `).eq("visibilidade","exclusivo_live");if(u)throw u;const h=[],f=new Set;(c||[]).forEach(m=>{var x,v;const p=(x=m.live_event)==null?void 0:x.status;(p==="ao_vivo"||p==="planejada"&&m.bloquear_desde_planejamento)&&(f.add(m.product_id),h.push({productId:m.product_id,liveTitle:((v=m.live_event)==null?void 0:v.titulo)||"Live",visibility:m.visibilidade}))}),t(f),s(h)}catch(c){console.error("Error fetching hidden products:",c)}finally{i(!1)}},[]);P.useEffect(()=>{o()},[o]);const l=P.useCallback(c=>e.has(c),[e]),d=P.useCallback(c=>{const u=r.find(h=>h.productId===c);return u?`Exclusivo da live "${u.liveTitle}"`:null},[r]);return{hiddenProductIds:e,hiddenInfo:r,isLoading:a,isProductHidden:l,getHiddenReason:d,refresh:o}}const aM=["Vestidos","Blusas","Calas","Saias","Conjuntos","Acessrios","Blazers"],iM=["Preto","Branco","Bege","Rosa","Azul","Verde","Vermelho","Marrom","Cinza","Estampado"],oM=["PP","P","M","G","GG","34","36","38","40","42","44","46"],Bwe=[{label:"Trabalho",query:"trabalho"},{label:"Jantar",query:"jantar"},{label:"Evento",query:"evento"},{label:"Igreja",query:"igreja"},{label:"Viagem",query:"viagem"},{label:"Dia a dia chic",query:"dia a dia"},{label:"Todas as peas",query:""}],$we=[{icon:Qr,label:"Troca fcil",desc:"Sem burocracia"},{icon:ms,label:"3x sem juros",desc:"No carto"},{icon:nn,label:"Suporte WhatsApp",desc:"Resposta rpida"},{icon:yn,label:"Envio Brasil",desc:"Todo o pas"}],Fwe=()=>{const[e,t]=hd(),[r,s]=P.useState([]),[a,i]=P.useState(!0),[o,l]=P.useState(""),[d,c]=P.useState(null),[u,h]=P.useState(null),[f,m]=P.useState([]),[p,g]=P.useState(""),[x,v]=P.useState("recent");P.useEffect(()=>{const J=e.get("occasion")||"";g(J)},[e]);const{isProductHidden:y}=Lwe(),b=P.useMemo(()=>r.map(J=>J.id),[r]),{getAvailable:j,getAvailableSizes:T,getTotalAvailable:O,isProductOutOfStock:R,isSizeLowStock:D}=cg(b.length>0?b:void 0),{getEffectivePrice:B,getOriginalPrice:q,hasDiscount:Y,getDiscountPercent:G}=__({channel:"catalog",productIds:b.length>0?b:void 0,enabled:b.length>0});P.useEffect(()=>{async function J(){try{const{data:V,error:H}=await le.from("product_catalog").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(H)throw H;s(V||[])}catch(V){console.error("Error loading products:",V)}finally{i(!1)}}J()},[]);const I=P.useMemo(()=>{let J=r;if(J=J.filter(V=>!y(V.id)),o){const V=o.toLowerCase();J=J.filter(H=>{var ee;return H.name.toLowerCase().includes(V)||((ee=H.category)==null?void 0:ee.toLowerCase().includes(V))})}if(p){const V=p.toLowerCase();J=J.filter(H=>{var ee,ie,oe;return((ee=H.tags)==null?void 0:ee.some(se=>se.toLowerCase().includes(V)))||((ie=H.style)==null?void 0:ie.toLowerCase().includes(V))||((oe=H.category)==null?void 0:oe.toLowerCase().includes(V))||H.name.toLowerCase().includes(V)})}switch(d&&(J=J.filter(V=>V.category===d)),u&&(J=J.filter(V=>V.color===u)),f.length>0&&(J=J.filter(V=>f.some(H=>j(V.id,H)>0))),x){case"price_asc":J=[...J].sort((V,H)=>V.price-H.price);break;case"price_desc":J=[...J].sort((V,H)=>H.price-V.price);break;case"name":J=[...J].sort((V,H)=>V.name.localeCompare(H.name));break}return J=[...J].sort((V,H)=>{const ee=O(V.id)<=0,ie=O(H.id)<=0;return ee&&!ie?1:!ee&&ie?-1:0}),J},[r,o,d,u,f,x,p,y,j,O]),F=[d,u].filter(Boolean).length+(f.length>0?1:0),S=J=>{m(V=>V.includes(J)?V.filter(H=>H!==J):[...V,J])},E=()=>{c(null),h(null),m([]),l(""),g("")},N=J=>T(J.id),C=J=>T(J.id).some(H=>D(J.id,H)),k=J=>R(J.id),M=J=>{if(J.images&&J.images.length>0){const V=J.main_image_index||0;return J.images[V]||J.images[0]}return J.image_url||void 0},U=J=>{g(J),t(J?{occasion:J}:{})},$=Math.ceil(I.length/2),X=I.slice(0,$),Z=I.slice($),re=J=>{const V=k(J),H=!V&&C(J);return n.jsx(Ft,{to:`/produto/${J.id}`,children:n.jsxs("div",{className:"relative group",children:[V?n.jsx(ke,{variant:"secondary",className:"absolute top-3 left-3 z-10 text-[10px] tracking-wider uppercase bg-muted/90 text-muted-foreground backdrop-blur-sm",children:"Esgotado"}):H?n.jsx(ke,{className:"absolute top-3 left-3 z-10 text-[10px] tracking-wider uppercase bg-foreground/90 text-background backdrop-blur-sm",children:"ltimas unidades"}):null,n.jsx(Qh,{name:J.name,price:q(J.id,J.price),effectivePrice:B(J.id,J.price),imageUrl:M(J),sizes:N(J),isOutOfStock:V,hasPromotionalDiscount:Y(J.id),discountPercent:G(J.id)})]})},J.id)},W=({value:J,onChange:V,placeholder:H,options:ee,width:ie="w-[130px]"})=>n.jsxs(Xt,{value:J||"_all",onValueChange:oe=>V(oe==="_all"?null:oe),children:[n.jsx(Ht,{className:`${ie} border-foreground/15 bg-transparent text-xs tracking-wide`,children:n.jsx(Yt,{placeholder:H})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"_all",children:H}),ee.map(oe=>n.jsx(qe,{value:oe,children:oe},oe))]})]});return n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(Bm,{}),n.jsx(Nr,{}),n.jsx("section",{className:"py-14 md:py-20 px-5 text-center",children:n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-medium",children:"Coleo completa"}),n.jsxs("h1",{className:"font-serif text-3xl md:text-4xl lg:text-5xl mt-3 mb-4 leading-[1.15]",children:["Curadoria pensada para"," ",n.jsxs("span",{className:"text-accent italic",children:["mulheres que no"," ",n.jsx("br",{className:"hidden sm:block"}),"tm tempo a perder."]})]}),n.jsx("p",{className:"text-muted-foreground font-light text-sm md:text-base max-w-lg mx-auto leading-relaxed",children:"Cada pea foi escolhida a dedo para valorizar seu corpo, simplificar suas manhs e fazer voc se sentir incrvel do escritrio ao jantar."})]})}),n.jsx("section",{className:"px-5 pb-10 md:pb-14",children:n.jsxs("div",{className:"max-w-3xl mx-auto",children:[n.jsx("p",{className:"text-center text-xs tracking-[0.15em] uppercase text-muted-foreground mb-6 font-medium",children:"Para qual ocasio?"}),n.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-4 md:gap-x-8",children:Bwe.map(J=>n.jsxs("button",{onClick:()=>U(J.query),className:"group relative",children:[n.jsx("span",{className:`
                    font-serif text-base md:text-lg transition-colors duration-300
                    ${p===J.query?"text-foreground":"text-foreground/50 hover:text-foreground/80"}
                  `,children:J.label}),n.jsx("span",{className:`
                    absolute -bottom-1 left-0 h-px bg-accent transition-all duration-500
                    ${p===J.query?"w-full":"w-0 group-hover:w-full"}
                  `})]},J.query||"all"))})]})}),n.jsx("section",{className:"border-y border-foreground/8 bg-secondary/20",children:n.jsxs("div",{className:"max-w-6xl mx-auto px-5 py-4",children:[n.jsxs("div",{className:"flex flex-col md:flex-row gap-3 items-center",children:[n.jsxs("div",{className:"relative flex-1 w-full md:w-auto",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por nome...",value:o,onChange:J=>l(J.target.value),className:"pl-10 border-foreground/15 bg-transparent text-sm"})]}),n.jsxs("div",{className:"flex gap-2 items-center",children:[n.jsxs(_u,{children:[n.jsx(lk,{asChild:!0,children:n.jsxs(he,{variant:"outline",size:"sm",className:"md:hidden gap-1.5 border-foreground/15 text-xs",children:[n.jsx(Ru,{className:"h-3.5 w-3.5"}),"Filtros",F>0&&n.jsx("span",{className:"bg-accent text-white text-[10px] rounded-full w-4 h-4 flex items-center justify-center",children:F})]})}),n.jsxs(rd,{side:"right",children:[n.jsx(ju,{children:n.jsx(Zh,{className:"font-serif",children:"Filtros"})}),n.jsxs("div",{className:"space-y-6 mt-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-2 block",children:"Categoria"}),n.jsx(W,{value:d,onChange:c,placeholder:"Todas",options:aM,width:"w-full"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-2 block",children:"Cor"}),n.jsx(W,{value:u,onChange:h,placeholder:"Todas",options:iM,width:"w-full"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-3 block",children:"Tamanho"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:oM.map(J=>n.jsx("button",{onClick:()=>S(J),className:`
                              px-3 py-1.5 text-xs tracking-wide border rounded-full transition-all duration-200
                              ${f.includes(J)?"bg-foreground text-background border-foreground":"border-foreground/20 text-foreground/70 hover:border-foreground/40"}
                            `,children:J},J))})]}),F>0&&n.jsx(he,{variant:"ghost",onClick:E,className:"w-full text-xs tracking-wide",children:"Limpar filtros"})]})]})]}),n.jsxs("div",{className:"hidden md:flex gap-2",children:[n.jsx(W,{value:d,onChange:c,placeholder:"Categoria",options:aM}),n.jsx(W,{value:u,onChange:h,placeholder:"Cor",options:iM,width:"w-[110px]"}),n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs("button",{className:"inline-flex items-center gap-1.5 h-10 px-3 border border-foreground/15 bg-transparent text-xs tracking-wide rounded-md hover:bg-secondary/50 transition-colors",children:[f.length>0?`${f.length} tam.`:"Tamanho",n.jsx(zo,{className:"h-3.5 w-3.5 text-muted-foreground"})]})}),n.jsxs(Ga,{align:"start",className:"w-auto p-3",children:[n.jsx("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-2",children:"Tamanho"}),n.jsx("div",{className:"flex flex-wrap gap-1.5 max-w-[220px]",children:oM.map(J=>n.jsx("button",{onClick:()=>S(J),className:`
                            px-2.5 py-1 text-xs tracking-wide border rounded-full transition-all duration-200
                            ${f.includes(J)?"bg-foreground text-background border-foreground":"border-foreground/20 text-foreground/70 hover:border-foreground/40"}
                          `,children:J},J))}),f.length>0&&n.jsx("button",{onClick:()=>m([]),className:"mt-2 text-[10px] text-muted-foreground hover:text-foreground transition-colors",children:"Limpar tamanhos"})]})]})]}),n.jsxs(Xt,{value:x,onValueChange:v,children:[n.jsx(Ht,{className:"w-[130px] border-foreground/15 bg-transparent text-xs tracking-wide",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"recent",children:"Mais recentes"}),n.jsx(qe,{value:"price_asc",children:"Menor preo"}),n.jsx(qe,{value:"price_desc",children:"Maior preo"}),n.jsx(qe,{value:"name",children:"A-Z"})]})]})]})]}),(F>0||p)&&n.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 pt-3 border-t border-foreground/5",children:[p&&n.jsxs("button",{onClick:()=>U(""),className:"inline-flex items-center gap-1 px-3 py-1 text-[11px] tracking-wide border border-accent/30 text-accent rounded-full hover:bg-accent/5 transition-colors",children:[p,n.jsx(sn,{className:"h-3 w-3"})]}),d&&n.jsxs("button",{onClick:()=>c(null),className:"inline-flex items-center gap-1 px-3 py-1 text-[11px] tracking-wide border border-foreground/15 rounded-full hover:bg-secondary transition-colors",children:[d,n.jsx(sn,{className:"h-3 w-3"})]}),u&&n.jsxs("button",{onClick:()=>h(null),className:"inline-flex items-center gap-1 px-3 py-1 text-[11px] tracking-wide border border-foreground/15 rounded-full hover:bg-secondary transition-colors",children:[u,n.jsx(sn,{className:"h-3 w-3"})]}),f.map(J=>n.jsxs("button",{onClick:()=>S(J),className:"inline-flex items-center gap-1 px-3 py-1 text-[11px] tracking-wide border border-foreground/15 rounded-full hover:bg-secondary transition-colors",children:["Tam ",J,n.jsx(sn,{className:"h-3 w-3"})]},J)),n.jsx("button",{onClick:E,className:"text-[11px] tracking-wide text-muted-foreground hover:text-foreground transition-colors",children:"Limpar todos"})]})]})}),n.jsx("div",{className:"max-w-6xl mx-auto px-5 pt-6 pb-2",children:n.jsxs("p",{className:"text-[11px] tracking-[0.15em] uppercase text-muted-foreground font-medium",children:[I.length," ",I.length===1?"pea":"peas",p?` para ${p}`:""]})}),n.jsx("main",{className:"max-w-6xl mx-auto px-5 py-6",children:a?n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6",children:[...Array(8)].map((J,V)=>n.jsxs("div",{className:"animate-pulse",children:[n.jsx("div",{className:"aspect-[3/4] bg-secondary mb-3"}),n.jsx("div",{className:"h-3 bg-secondary w-3/4 mb-2"}),n.jsx("div",{className:"h-3 bg-secondary w-1/2"})]},V))}):I.length===0?n.jsxs("div",{className:"text-center py-20",children:[n.jsx("p",{className:"font-serif text-xl mb-2",children:"Nenhuma pea encontrada"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Tente remover alguns filtros ou explorar outra ocasio."}),n.jsx(he,{variant:"outline",onClick:E,className:"text-xs tracking-wide",children:"Limpar filtros"})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6",children:X.map(re)}),I.length>3&&n.jsx("section",{className:"my-12 md:my-16 py-12 md:py-16 border-y border-foreground/8",children:n.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[n.jsx("div",{className:"w-px h-10 bg-accent/40 mx-auto mb-6"}),n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-medium",children:"Precisa de ajuda?"}),n.jsxs("h2",{className:"font-serif text-2xl md:text-3xl mt-2 mb-3 italic",children:["No sabe o que vestir?"," ",n.jsx("br",{className:"hidden sm:block"}),"A gente resolve."]}),n.jsx("p",{className:"text-muted-foreground font-light text-sm mb-8 max-w-md mx-auto leading-relaxed",children:"Responda 5 perguntas sobre seu estilo e tamanho. Em 2 minutos a gente monta um provador personalizado e envia sugestes direto no seu WhatsApp."}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[n.jsx(Ft,{to:"/meu-estilo",children:n.jsx("button",{className:"px-10 py-3.5 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white",children:"Fazer meu provador VIP"})}),n.jsx(Ft,{to:"/enviar-print",children:n.jsx("button",{className:"px-10 py-3.5 border border-foreground/30 text-foreground text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:border-accent hover:text-accent",children:"Buscar look por foto"})})]})]})}),Z.length>0&&n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6",children:Z.map(re)})]})}),n.jsx("section",{className:"py-14 md:py-20 px-5 bg-[hsl(35,30%,94%)]/60",children:n.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-medium",children:"Por que escolher a LE.PO"}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mt-2 mb-3",children:"Mais de 8 anos vestindo mulheres reais."}),n.jsx("p",{className:"text-muted-foreground text-sm font-light mb-10 max-w-md mx-auto",children:"No somos s uma loja. Somos sua parceira de estilo para cada momento da sua vida."}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-8",children:$we.map(J=>n.jsxs("div",{className:"flex flex-col items-center gap-3 group",children:[n.jsx("div",{className:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm group-hover:shadow-md group-hover:border-accent/40 transition-all duration-300",children:n.jsx(J.icon,{className:"h-6 w-6 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:J.label}),n.jsx("p",{className:"text-xs text-muted-foreground",children:J.desc})]})]},J.label))})]})}),n.jsx("section",{className:"py-16 md:py-24 px-5",children:n.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[n.jsx("div",{className:"w-px h-12 bg-accent/40 mx-auto mb-6"}),n.jsx("h2",{className:"font-serif text-3xl md:text-4xl mb-4 italic",children:"Pronta para se sentir incrvel?"}),n.jsx("p",{className:"text-muted-foreground font-light mb-8 max-w-md mx-auto",children:"Monte seu provador VIP em 2 minutos e receba sugestes personalizadas direto no seu WhatsApp."}),n.jsx(Ft,{to:"/meu-estilo",children:n.jsx("button",{className:"px-12 py-4 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white",children:"Quero meu provador VIP"})}),n.jsx("p",{className:"text-[11px] text-muted-foreground mt-6 tracking-wide",children:"Gratuito  Leva menos de 2 minutos"})]})}),n.jsx("footer",{className:"border-t border-border py-10 px-5",children:n.jsxs("div",{className:"max-w-5xl mx-auto",children:[n.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[n.jsxs("div",{className:"text-center md:text-left",children:[n.jsx("p",{className:"font-serif text-lg mb-1",children:"LE.PO"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Curadoria de moda feminina  Anpolis, GO"})]}),n.jsxs("div",{className:"flex items-center gap-5 text-sm text-muted-foreground",children:[n.jsx(Ft,{to:"/catalogo",className:"hover:text-foreground transition-colors",children:"Catlogo"}),n.jsx(Ft,{to:"/meu-estilo",className:"hover:text-foreground transition-colors",children:"Provador VIP"}),n.jsx(Ft,{to:"/enviar-print",className:"hover:text-foreground transition-colors",children:"Buscar por foto"}),n.jsx("a",{href:po("Ol! Gostaria de saber mais sobre a LE.PO "),target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors",children:"WhatsApp"})]})]}),n.jsxs("div",{className:"border-t border-border mt-6 pt-6 flex flex-col sm:flex-row items-center justify-between gap-2",children:[n.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",new Date().getFullYear()," LE.PO. Todos os direitos reservados."]}),n.jsx(Ft,{to:"/area-lojista",className:"text-[10px] text-muted-foreground/40 hover:text-muted-foreground transition-colors",children:"rea do Lojista"})]})]})})]})};function LH(){const{user:e}=qn(),[t,r]=P.useState([]),[s,a]=P.useState(!1),i=P.useCallback(async()=>{if(!e){r([]);return}try{const{data:d,error:c}=await le.from("customer_favorites").select("product_id").eq("user_id",e.id);if(c)throw c;r((d==null?void 0:d.map(u=>u.product_id))||[])}catch(d){console.error("Error loading favorites:",d)}},[e]);P.useEffect(()=>{i()},[i]);const o=P.useCallback(d=>t.includes(d),[t]),l=P.useCallback(async d=>{if(!e)return!1;a(!0);const c=t.includes(d);try{if(c){const{error:u}=await le.from("customer_favorites").delete().eq("user_id",e.id).eq("product_id",d);if(u)throw u;r(h=>h.filter(f=>f!==d)),de.success("Removido dos favoritos")}else{const{error:u}=await le.from("customer_favorites").insert({user_id:e.id,product_id:d});if(u)throw u;r(h=>[...h,d]),de.success("Adicionado aos favoritos ")}return!0}catch(u){return console.error("Error toggling favorite:",u),de.error("Erro ao atualizar favoritos"),!1}finally{a(!1)}},[e,t]);return{favorites:t,isFavorite:o,toggleFavorite:l,isLoading:s,refetch:i}}const zwe=()=>{var re;const{productId:e}=ta(),t=pr(),{addItem:r}=Lu(),{user:s}=qn(),{isFavorite:a,toggleFavorite:i,isLoading:o}=LH(),[l,d]=P.useState(null),[c,u]=P.useState([]),[h,f]=P.useState(null),[m,p]=P.useState(0),[g,x]=P.useState(!1),[v,y]=P.useState(!0),{availableSizes:b,available:j,isLowStock:T,isProductOutOfStock:O,isLoading:R}=Bhe(e),{effectivePrice:D,originalPrice:B,hasDiscount:q,discountPercent:Y,promotionName:G,isLoading:I}=Lhe(e,"catalog");P.useEffect(()=>{async function W(){if(e)try{const{data:J,error:V}=await le.from("product_catalog").select("*").eq("id",e).single();if(V)throw V;if(d(J),p(J.main_image_index||0),J){const{data:H,error:ee}=await le.from("product_catalog").select("*").eq("is_active",!0).neq("id",e).or(`category.eq.${J.category},style.eq.${J.style}`).limit(4);ee||u(H||[])}}catch(J){console.error("Error loading product:",J),de.error("Produto no encontrado")}finally{y(!1)}}W()},[e]);const F=W=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(W),S=(re=l==null?void 0:l.images)!=null&&re.length?l.images:l!=null&&l.image_url?[l.image_url]:[],E=q?D:(l==null?void 0:l.price)||0,N=q||(l==null?void 0:l.discount_value)&&l.discount_value>0,C=q?Y>0?`-${Y}%`:`-R$ ${((B||(l==null?void 0:l.price)||0)-D).toFixed(2)}`:null,k=()=>{if(!l||!e)return;if(!h){de.error("Selecione um tamanho");return}if(j(h)<=0){de.error("Tamanho esgotado no momento");return}r({productId:l.id,name:l.name,price:E,originalPrice:l.price,discountPercent:Y,size:h,imageUrl:S[0]||l.image_url}),de.success("Adicionado ao carrinho!"),t("/carrinho")},M=async()=>{try{await navigator.share({title:l==null?void 0:l.name,text:`Confira essa pea linda: ${l==null?void 0:l.name}`,url:window.location.href})}catch{navigator.clipboard.writeText(window.location.href),de.success("Link copiado!")}},U=async()=>{if(!s){de.info("Faa login para salvar favoritos"),t("/entrar");return}e&&await i(e)},$=e?a(e):!1,X=()=>{S.length>0&&(p(W=>(W+1)%S.length),x(!1))},Z=()=>{S.length>0&&(p(W=>(W-1+S.length)%S.length),x(!1))};return v||R||I?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Bm,{}),n.jsx(Nr,{}),n.jsx("div",{className:"container mx-auto px-4 py-8",children:n.jsxs("div",{className:"animate-pulse",children:[n.jsx("div",{className:"aspect-[3/4] md:aspect-square bg-secondary rounded-xl mb-6"}),n.jsx("div",{className:"h-6 bg-secondary rounded w-3/4 mb-3"}),n.jsx("div",{className:"h-8 bg-secondary rounded w-1/3"})]})})]}):l?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Bm,{}),n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-6",children:[n.jsxs(Ft,{to:"/catalogo",className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-6",children:[n.jsx(Ts,{className:"h-4 w-4"}),"Voltar ao catlogo"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"relative aspect-[3/4] bg-secondary rounded-xl overflow-hidden",children:[g&&l.video_url?n.jsx("video",{src:l.video_url,controls:!0,autoPlay:!0,className:"w-full h-full object-contain bg-black"}):S.length>0?n.jsx("img",{src:S[m],alt:l.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-16 w-16 text-muted-foreground"})}),S.length>1&&!g&&n.jsxs(n.Fragment,{children:[n.jsx(he,{variant:"secondary",size:"icon",className:"absolute left-2 top-1/2 -translate-y-1/2 h-8 w-8 rounded-full opacity-80 hover:opacity-100",onClick:Z,children:n.jsx(ZF,{className:"h-4 w-4"})}),n.jsx(he,{variant:"secondary",size:"icon",className:"absolute right-2 top-1/2 -translate-y-1/2 h-8 w-8 rounded-full opacity-80 hover:opacity-100",onClick:X,children:n.jsx(In,{className:"h-4 w-4"})})]})]}),(S.length>1||l.video_url)&&n.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[S.map((W,J)=>n.jsx("button",{onClick:()=>{p(J),x(!1)},className:`flex-shrink-0 w-16 h-20 rounded-lg overflow-hidden border-2 transition-colors ${m===J&&!g?"border-accent":"border-transparent"}`,children:n.jsx("img",{src:W,alt:"",className:"w-full h-full object-cover"})},J)),l.video_url&&n.jsx("button",{onClick:()=>x(!0),className:`flex-shrink-0 w-16 h-20 rounded-lg overflow-hidden border-2 transition-colors bg-black flex items-center justify-center ${g?"border-accent":"border-transparent"}`,children:n.jsx(I6,{className:"h-6 w-6 text-white"})})]})]}),n.jsxs("div",{className:"space-y-6",children:[l.category&&n.jsx("span",{className:"inline-block text-xs font-medium text-accent uppercase tracking-wide",children:l.category}),n.jsx("h1",{className:"font-serif text-3xl md:text-4xl",children:l.name}),n.jsx("div",{className:"flex items-center gap-3",children:N?n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-2xl font-semibold text-green-600",children:F(E)}),n.jsx("p",{className:"text-lg text-muted-foreground line-through",children:F(B||l.price)}),C&&n.jsxs(ke,{variant:"secondary",className:"bg-green-100 text-green-700 flex items-center gap-1",children:[n.jsx(ua,{className:"h-3 w-3"}),C]}),G&&n.jsx(ke,{variant:"outline",className:"text-xs",children:G})]}):n.jsx("p",{className:"text-2xl font-semibold",children:F(l.price)})}),l.description&&n.jsx("p",{className:"text-muted-foreground",children:l.description}),n.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[l.color&&n.jsxs("p",{children:[n.jsx("span",{className:"font-medium text-foreground",children:"Cor:"})," ",l.color]}),l.style&&n.jsxs("p",{children:[n.jsx("span",{className:"font-medium text-foreground",children:"Estilo:"})," ",l.style]}),l.occasion&&n.jsxs("p",{children:[n.jsx("span",{className:"font-medium text-foreground",children:"Ocasio:"})," ",l.occasion]}),l.modeling&&n.jsxs("p",{children:[n.jsx("span",{className:"font-medium text-foreground",children:"Modelagem:"})," ",l.modeling]})]}),b.length>0?n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium mb-3 block",children:"Tamanhos disponveis"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:b.map(W=>{const J=j(W),V=T(W);return n.jsxs("div",{className:"relative",children:[n.jsx("button",{onClick:()=>f(W===h?null:W),className:`px-4 py-2 text-sm rounded-lg border transition-colors ${h===W?"bg-primary text-primary-foreground border-primary":"border-border hover:border-accent"}`,children:W}),V&&n.jsx(ke,{variant:"destructive",className:"absolute -top-2 -right-2 text-[9px] px-1 py-0",children:J})]},W)})}),h&&T(h)&&n.jsxs("p",{className:"text-xs text-destructive mt-2 flex items-center gap-1",children:[n.jsx(Sn,{className:"h-3 w-3"}),"ltimas unidades disponveis!"]})]}):n.jsx("div",{className:"p-4 bg-muted rounded-lg text-center",children:n.jsx("p",{className:"text-muted-foreground",children:"Produto esgotado"})}),n.jsxs("div",{className:"flex flex-col gap-3 pt-4",children:[n.jsxs(he,{size:"lg",onClick:k,className:"gap-2",disabled:!h||b.length===0||O,children:[n.jsx(hn,{className:"h-5 w-5"}),b.length===0||O?"Esgotado":h?"Comprar agora":"Selecione um tamanho"]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs(he,{variant:"outline",size:"lg",className:`flex-1 gap-2 ${$?"text-destructive border-destructive":""}`,onClick:U,disabled:o,children:[n.jsx(bl,{className:`h-5 w-5 ${$?"fill-current":""}`}),$?"Favoritado":"Favoritar"]}),n.jsx(he,{variant:"outline",size:"lg",onClick:M,className:"gap-2",children:n.jsx(cse,{className:"h-5 w-5"})})]})]})]})]}),c.length>0&&n.jsxs("section",{className:"mt-16",children:[n.jsx("h2",{className:"font-serif text-2xl mb-6",children:"Voc tambm pode gostar"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6",children:c.map(W=>{var J;return n.jsx(Ft,{to:`/produto/${W.id}`,children:n.jsx(Qh,{name:W.name,price:W.price,imageUrl:((J=W.images)==null?void 0:J[W.main_image_index||0])||W.image_url||void 0,sizes:CW(W.stock_by_size)})},W.id)})})]})]}),n.jsx("footer",{className:"py-8 border-t border-border mt-12",children:n.jsx("div",{className:"container mx-auto px-4 text-center text-sm text-muted-foreground",children:n.jsx("p",{children:" 2024 Provador VIP. Feito com  para lojistas de moda."})})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Bm,{}),n.jsx(Nr,{}),n.jsxs("div",{className:"container mx-auto px-4 py-16 text-center",children:[n.jsx(Vt,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-4",children:"Produto no encontrado"}),n.jsx(Ft,{to:"/catalogo",children:n.jsx(he,{variant:"outline",children:"Ver catlogo"})})]})]})};function Sy(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const Uwe=()=>{const e=pr(),{items:t,removeItem:r,updateQuantity:s,total:a,itemCount:i,gifts:o}=Lu(),l=t.map(h=>h.productId),{getAvailable:d,isLoading:c}=cg(l),u=(h,f,m)=>{const p=d(h,f);if(m>=p){de.error(`Limite do estoque disponvel (${p} un.)`);return}s(h,f,m+1)};return t.length===0?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx(hn,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Seu carrinho est vazio"}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Que tal encontrar algo especial?"}),n.jsx(he,{onClick:()=>e("/catalogo"),children:"Ver catlogo"})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-lg",children:[n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>e(-1),className:"mb-4",children:[n.jsx(Ts,{className:"h-4 w-4 mr-1"}),"Voltar"]}),n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsx(hn,{className:"h-6 w-6 text-accent"}),n.jsxs("h1",{className:"font-serif text-2xl",children:["Meu Carrinho (",i,")"]})]}),n.jsx("div",{className:"space-y-4 mb-8",children:t.map(h=>n.jsx($e,{children:n.jsxs(Fe,{className:"p-4 flex gap-4",children:[n.jsx("div",{className:"w-20 h-24 bg-stone-50 rounded-lg flex items-center justify-center overflow-hidden",children:h.imageUrl?n.jsx("img",{src:h.imageUrl,alt:h.name,className:"w-full h-full object-contain"}):n.jsx(Vt,{className:"h-8 w-8 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-medium line-clamp-1",children:h.name}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Tamanho: ",h.size]}),h.discountPercent>0?n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:"font-semibold text-green-600",children:Sy(h.price)}),n.jsx("span",{className:"text-xs text-muted-foreground line-through",children:Sy(h.originalPrice)}),n.jsxs(ke,{variant:"secondary",className:"bg-green-100 text-green-700 text-[10px] px-1 py-0",children:[n.jsx(ua,{className:"h-2.5 w-2.5 mr-0.5"}),"-",h.discountPercent,"%"]})]}):n.jsx("p",{className:"font-semibold text-accent mt-1",children:Sy(h.price)})]}),n.jsxs("div",{className:"flex flex-col items-end justify-between",children:[n.jsx(he,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>r(h.productId,h.size),children:n.jsx(ui,{className:"h-4 w-4"})}),n.jsxs("div",{className:"flex flex-col items-end gap-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(he,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>s(h.productId,h.size,h.quantity-1),children:n.jsx(op,{className:"h-3 w-3"})}),n.jsx("span",{className:"w-6 text-center text-sm font-medium",children:h.quantity}),n.jsx(he,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>u(h.productId,h.size,h.quantity),disabled:c||h.quantity>=d(h.productId,h.size),children:n.jsx(kn,{className:"h-3 w-3"})})]}),!c&&h.quantity>=d(h.productId,h.size)&&n.jsxs("span",{className:"text-[10px] text-destructive flex items-center gap-0.5",children:[n.jsx(Sn,{className:"h-3 w-3"}),"Mx. disponvel"]})]})]})]})},`${h.productId}-${h.size}`))}),o&&o.length>0&&n.jsxs("div",{className:"space-y-4 mb-8",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Pn,{className:"h-5 w-5 text-green-600"}),n.jsx("h2",{className:"font-serif text-lg text-green-700",children:"Seus Brindes"})]}),o.map(h=>n.jsx($e,{className:"border-green-200 bg-green-50/30",children:n.jsxs(Fe,{className:"p-4 flex gap-4",children:[n.jsx("div",{className:"w-20 h-24 bg-white rounded-lg flex items-center justify-center overflow-hidden border border-green-100",children:h.imageUrl?n.jsx("img",{src:h.imageUrl,alt:h.name,className:"w-full h-full object-contain"}):n.jsx(Pn,{className:"h-8 w-8 text-green-500"})}),n.jsx("div",{className:"flex-1",children:n.jsx("div",{className:"flex items-start justify-between",children:n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium line-clamp-1 text-green-900",children:h.name}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsxs(ke,{className:"bg-green-500 hover:bg-green-600 border-none",children:[n.jsx(Pn,{className:"h-3 w-3 mr-1"}),"GRTIS"]}),n.jsx("span",{className:"text-xs text-green-700 font-medium hidden sm:inline",children:"Mimo especial pra voc!"})]})]})})}),n.jsx("div",{className:"flex flex-col items-end justify-center",children:n.jsx("div",{className:"flex items-center gap-2 bg-white/50 px-3 py-1 rounded-full border border-green-100",children:n.jsxs("span",{className:"text-sm font-medium text-green-800",children:[h.quantity," un"]})})})]})},`gift-${h.productId}`))]}),n.jsx($e,{className:"mb-6",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex justify-between items-center text-lg",children:[n.jsx("span",{className:"font-medium",children:"Total"}),n.jsx("span",{className:"font-bold text-accent",children:Sy(a)})]})})}),n.jsx(he,{className:"w-full",size:"lg",onClick:()=>e("/checkout"),children:"Finalizar pedido"})]})]})};var t8="Radio",[Vwe,BH]=ea(t8),[qwe,Wwe]=Vwe(t8),$H=P.forwardRef((e,t)=>{const{__scopeRadio:r,name:s,checked:a=!1,required:i,disabled:o,value:l="on",onCheck:d,form:c,...u}=e,[h,f]=P.useState(null),m=Rr(t,x=>f(x)),p=P.useRef(!1),g=h?c||!!h.closest("form"):!0;return n.jsxs(qwe,{scope:r,checked:a,disabled:o,children:[n.jsx(er.button,{type:"button",role:"radio","aria-checked":a,"data-state":VH(a),"data-disabled":o?"":void 0,disabled:o,value:l,...u,ref:m,onClick:Tt(e.onClick,x=>{a||d==null||d(),g&&(p.current=x.isPropagationStopped(),p.current||x.stopPropagation())})}),g&&n.jsx(UH,{control:h,bubbles:!p.current,name:s,value:l,checked:a,required:i,disabled:o,form:c,style:{transform:"translateX(-100%)"}})]})});$H.displayName=t8;var FH="RadioIndicator",zH=P.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:s,...a}=e,i=Wwe(FH,r);return n.jsx(Ws,{present:s||i.checked,children:n.jsx(er.span,{"data-state":VH(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t})})});zH.displayName=FH;var Hwe="RadioBubbleInput",UH=P.forwardRef(({__scopeRadio:e,control:t,checked:r,bubbles:s=!0,...a},i)=>{const o=P.useRef(null),l=Rr(o,i),d=E_(r),c=l_(t);return P.useEffect(()=>{const u=o.current;if(!u)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(d!==r&&m){const p=new Event("click",{bubbles:s});m.call(u,r),u.dispatchEvent(p)}},[d,r,s]),n.jsx(er.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:l,style:{...a.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});UH.displayName=Hwe;function VH(e){return e?"checked":"unchecked"}var Gwe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],z_="RadioGroup",[Kwe,aQe]=ea(z_,[fg,BH]),qH=fg(),WH=BH(),[Xwe,Ywe]=Kwe(z_),HH=P.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:s,defaultValue:a,value:i,required:o=!1,disabled:l=!1,orientation:d,dir:c,loop:u=!0,onValueChange:h,...f}=e,m=qH(r),p=hg(c),[g,x]=Ui({prop:i,defaultProp:a??null,onChange:h,caller:z_});return n.jsx(Xwe,{scope:r,name:s,required:o,disabled:l,value:g,onValueChange:x,children:n.jsx(yk,{asChild:!0,...m,orientation:d,dir:p,loop:u,children:n.jsx(er.div,{role:"radiogroup","aria-required":o,"aria-orientation":d,"data-disabled":l?"":void 0,dir:p,...f,ref:t})})})});HH.displayName=z_;var GH="RadioGroupItem",KH=P.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:s,...a}=e,i=Ywe(GH,r),o=i.disabled||s,l=qH(r),d=WH(r),c=P.useRef(null),u=Rr(t,c),h=i.value===a.value,f=P.useRef(!1);return P.useEffect(()=>{const m=g=>{Gwe.includes(g.key)&&(f.current=!0)},p=()=>f.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",p),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",p)}},[]),n.jsx(bk,{asChild:!0,...l,focusable:!o,active:h,children:n.jsx($H,{disabled:o,required:i.required,checked:h,...d,...a,name:i.name,ref:u,onCheck:()=>i.onValueChange(a.value),onKeyDown:Tt(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:Tt(a.onFocus,()=>{var m;f.current&&((m=c.current)==null||m.click())})})})});KH.displayName=GH;var Zwe="RadioGroupIndicator",XH=P.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...s}=e,a=WH(r);return n.jsx(zH,{...a,...s,ref:t})});XH.displayName=Zwe;var YH=HH,ZH=KH,Qwe=XH;const gc=P.forwardRef(({className:e,...t},r)=>n.jsx(YH,{className:He("grid gap-2",e),...t,ref:r}));gc.displayName=YH.displayName;const Li=P.forwardRef(({className:e,...t},r)=>n.jsx(ZH,{ref:r,className:He("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(Qwe,{className:"flex items-center justify-center",children:n.jsx(QF,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Li.displayName=ZH.displayName;const Xs={originZipCode:"75110-760",storeAddress:"Rua Luiz Frana, n 65, qd 32 lote 20 - Bairro Jundia - Anpolis/GO",storeHours:"Segunda a Sexta: 9h s 18h | Sbado: 9h s 13h",motoboyFee:10,motoboyDeliveryText:"Entrega rpida em Anpolis",defaultWeight:.3,defaultLength:30,defaultWidth:20,defaultHeight:10};function r8(){const[e,t]=P.useState(!1),[r,s]=P.useState(null),[a,i]=P.useState(null),o=P.useCallback(()=>{i(null),s(null),t(!1)},[]),l=P.useCallback(async d=>{var u;const c=d.replace(/\D/g,"");if(c.length!==8)return s("CEP deve ter 8 dgitos"),null;t(!0),s(null);try{const h=await fetch(`https://viacep.com.br/ws/${c}/json/`);if(!h.ok)throw new Error("Erro ao consultar CEP");const f=await h.json();if(f.erro)return s("CEP no encontrado"),i(null),null;const m={street:f.logradouro||"",neighborhood:f.bairro||"",city:f.localidade||"",state:f.uf||"",cep:((u=f.cep)==null?void 0:u.replace(/\D/g,""))||c};return i(m),s(null),m}catch(h){return console.error("CEP lookup error:",h),s("Erro ao buscar CEP. Tente novamente."),i(null),null}finally{t(!1)}},[]);return{isLoading:e,error:r,data:a,lookup:l,reset:o}}function Kx(e){const t=e.replace(/\D/g,"").slice(0,8);return t.length<=5?t:`${t.slice(0,5)}-${t.slice(5,8)}`}const Jwe=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"];function QH(e){const t=e.replace(/\D/g,"").slice(0,11);return t.length===0?"":t.length<=3?t:t.length<=6?`${t.slice(0,3)}.${t.slice(3)}`:t.length<=9?`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6)}`:`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6,9)}-${t.slice(9)}`}function Cy(e){return e.replace(/\D/g,"").length===11}function U_({value:e,onChange:t,showReference:r=!0,showCpf:s=!0,cpfRequired:a=!1,className:i,disabled:o=!1}){const l=r8(),[d,c]=P.useState(e.zipCode||""),[u,h]=P.useState(!1);P.useEffect(()=>{e.zipCode&&e.zipCode!==d.replace(/\D/g,"")&&c(Kx(e.zipCode))},[e.zipCode]);const f=x=>{const v=Kx(x.target.value);c(v),t({...e,zipCode:v.replace(/\D/g,"")}),h(!1)},m=async()=>{const x=d.replace(/\D/g,"");if(x.length===8&&!u){const v=await l.lookup(x);v&&(t({...e,zipCode:v.cep,street:v.street||e.street,neighborhood:v.neighborhood||e.neighborhood,city:v.city||e.city,state:v.state||e.state}),h(!0))}},p=async()=>{const x=d.replace(/\D/g,"");if(x.length===8){const v=await l.lookup(x);v&&(t({...e,zipCode:v.cep,street:v.street||e.street,neighborhood:v.neighborhood||e.neighborhood,city:v.city||e.city,state:v.state||e.state}),h(!0))}},g=(x,v)=>{t({...e,[x]:v})};return n.jsxs("div",{className:He("space-y-4",i),children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{htmlFor:"cep",className:"flex items-center gap-2",children:[n.jsx(mo,{className:"h-4 w-4"}),"CEP"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(et,{id:"cep",value:d,onChange:f,onBlur:m,placeholder:"00000-000",maxLength:9,disabled:o,className:He(u&&"border-green-500 bg-green-50/50")}),u&&n.jsx(gn,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-green-600"})]}),n.jsx(he,{type:"button",variant:"outline",size:"icon",onClick:p,disabled:d.replace(/\D/g,"").length!==8||l.isLoading||o,children:l.isLoading?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):n.jsx(On,{className:"h-4 w-4"})})]}),l.error&&n.jsx("p",{className:"text-sm text-destructive",children:l.error}),u&&n.jsx("p",{className:"text-sm text-green-600",children:"Endereo preenchido automaticamente!"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"street",children:"Rua / Avenida"}),n.jsx(et,{id:"street",value:e.street,onChange:x=>g("street",x.target.value),placeholder:"Nome da rua ou avenida",disabled:o})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"number",children:"Nmero"}),n.jsx(et,{id:"number",value:e.number,onChange:x=>g("number",x.target.value),placeholder:"N",disabled:o})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"complement",children:"Complemento"}),n.jsx(et,{id:"complement",value:e.complement,onChange:x=>g("complement",x.target.value),placeholder:"Apto, Bloco, etc.",disabled:o})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"neighborhood",children:"Bairro"}),n.jsx(et,{id:"neighborhood",value:e.neighborhood,onChange:x=>g("neighborhood",x.target.value),placeholder:"Bairro",disabled:o})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"col-span-2 space-y-2",children:[n.jsx(Be,{htmlFor:"city",children:"Cidade"}),n.jsx(et,{id:"city",value:e.city,onChange:x=>g("city",x.target.value),placeholder:"Cidade",disabled:o})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Estado"}),n.jsxs(Xt,{value:e.state,onValueChange:x=>g("state",x),disabled:o,children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"UF"})}),n.jsx(Gt,{children:Jwe.map(x=>n.jsx(qe,{value:x,children:x},x))})]})]})]}),s&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{htmlFor:"cpf",children:["CPF ",a?n.jsx("span",{className:"text-red-500",children:"*"}):"(opcional)"]}),n.jsx(et,{id:"cpf",value:QH(e.document||""),onChange:x=>g("document",x.target.value.replace(/\D/g,"").slice(0,11)),placeholder:"000.000.000-00",maxLength:14,disabled:o,className:He(a&&!Cy(e.document||"")&&"border-red-500",!a&&e.document&&!Cy(e.document)&&"border-amber-500")}),a&&!Cy(e.document||"")&&n.jsx("p",{className:"text-xs text-red-600",children:"CPF obrigatrio para gerar etiqueta dos Correios (11 dgitos)"}),!a&&e.document&&!Cy(e.document)&&n.jsx("p",{className:"text-xs text-amber-600",children:"CPF deve ter 11 dgitos"})]}),r&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"reference",children:"Ponto de referncia (opcional)"}),n.jsx(et,{id:"reference",value:e.reference,onChange:x=>g("reference",x.target.value),placeholder:"Prximo a...",disabled:o})]})]})}function SC(e){let r=[e.street,e.number,e.complement,e.neighborhood,e.city,e.state].filter(Boolean).join(", ");return e.zipCode&&(r+=` - CEP ${Kx(e.zipCode)}`),e.reference&&(r+=` (${e.reference})`),r}function CC(e,t,r,s,a,i){var u;let o=e||"",l="",d="",c="";if(e){const h=e.split(",").map(f=>f.trim());if(h.length>=2)if(o=h[0],/^\d+/.test(h[1])){l=((u=h[1].match(/^\d+/))==null?void 0:u[0])||"";const f=h[1].replace(/^\d+\s*/,"").trim();f&&(d=f),h[2]&&(c=h[2])}else c=h[1]}return{zipCode:(s==null?void 0:s.replace(/\D/g,""))||"",street:o,number:l,complement:d,neighborhood:c,city:t||"",state:r||"",reference:a||"",document:(i==null?void 0:i.replace(/\D/g,""))||""}}function e2e(){const[e,t]=P.useState(null),[r,s]=P.useState(!1),[a,i]=P.useState(null),[o,l]=P.useState(0),d=f=>e?e.discount_type==="percentage"?f*(e.discount_value/100):Math.min(e.discount_value,f):0,c=async(f,m)=>{if(!f.trim())return i("Digite um cdigo de cupom"),!1;s(!0),i(null);try{const p=f.toUpperCase().trim(),{data:g,error:x}=await le.from("coupons").select("*").eq("code",p).eq("is_active",!0).maybeSingle();if(x)throw x;if(!g)return await u(p,m)?!0:(i("Cupom no encontrado ou inativo"),t(null),l(0),!1);const v=g,y=new Date;if(v.starts_at&&new Date(v.starts_at)>y)return i("Este cupom ainda no est disponvel"),!1;if(v.ends_at&&new Date(v.ends_at)<y)return i("Este cupom expirou"),!1;if(v.max_uses&&v.times_used>=v.max_uses)return i("Este cupom atingiu o limite de usos"),!1;if(v.min_order_value&&m<v.min_order_value)return i(`Pedido mnimo de R$ ${v.min_order_value.toFixed(2)} para este cupom`),!1;t(v);const b=v.discount_type==="percentage"?m*(v.discount_value/100):Math.min(v.discount_value,m);return l(b),de.success(`Cupom aplicado! Desconto de R$ ${b.toFixed(2)}`),!0}catch(p){return console.error("Error applying coupon:",p),i("Erro ao validar cupom"),!1}finally{s(!1)}},u=async(f,m)=>{try{const{data:p,error:g}=await le.from("birthday_discounts").select("id, coupon_code, discount_percent, used_at, expires_at, user_id").eq("coupon_code",f).maybeSingle();if(g||!p)return!1;if(p.used_at)return i("Este cupom de aniversrio j foi utilizado"),!1;if(p.expires_at&&new Date(p.expires_at)<new Date)return i("Este cupom de aniversrio expirou"),!1;const{data:{user:x}}=await le.auth.getUser();if(!x||x.id!==p.user_id)return i("Este cupom pertence a outra conta"),!1;const v=m*(p.discount_percent/100),y={id:p.id,code:p.coupon_code,discount_type:"percentage",discount_value:p.discount_percent,starts_at:null,ends_at:p.expires_at,max_uses:1,times_used:0,min_order_value:null,is_active:!0,isBirthdayCoupon:!0,birthdayDiscountId:p.id};return t(y),l(v),de.success(` Cupom de aniversrio aplicado! ${p.discount_percent}% de desconto (R$ ${v.toFixed(2)})`),!0}catch(p){return console.error("Error checking birthday coupon:",p),!1}};return{coupon:e,isLoading:r,error:a,discountAmount:o,applyCoupon:c,removeCoupon:()=>{t(null),l(0),i(null)},calculateDiscount:d}}async function t2e(e,t,r,s,a){try{if(a){await le.from("birthday_discounts").update({used_at:new Date().toISOString(),order_id:t}).eq("id",e);return}await le.from("coupon_uses").insert({coupon_id:e,order_id:t,live_cart_id:r,discount_applied:s});const{data:i}=await le.from("coupons").select("times_used").eq("id",e).single();i&&await le.from("coupons").update({times_used:(i.times_used||0)+1}).eq("id",e)}catch(i){console.error("Error recording coupon use:",i)}}function r2e({onApply:e,onRemove:t,appliedCoupon:r,isLoading:s,error:a,orderTotal:i,className:o}){const[l,d]=P.useState(""),c=async()=>{await e(l)&&d("")},u=h=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(h);return r?n.jsxs("div",{className:He("flex items-center justify-between p-3 bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800 rounded-lg",o),children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(gn,{className:"h-4 w-4 text-green-600"}),n.jsxs("div",{children:[n.jsx("span",{className:"font-mono font-bold text-green-700 dark:text-green-400",children:r.code}),n.jsxs("span",{className:"text-sm text-green-600 dark:text-green-400 ml-2",children:["-",u(r.discountAmount)]})]})]}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-600 hover:text-red-600",onClick:t,children:n.jsx(sn,{className:"h-4 w-4"})})]}):n.jsxs("div",{className:He("space-y-2",o),children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Dh,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Cdigo do cupom",value:l,onChange:h=>d(h.target.value.toUpperCase()),className:"pl-10 font-mono",disabled:s})]}),n.jsx(he,{type:"button",variant:"outline",onClick:c,disabled:!l.trim()||s,children:s?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):"Aplicar"})]}),a&&n.jsx("p",{className:"text-xs text-destructive",children:a})]})}function n2e(e){const r=[e.street,e.number,e.complement,e.neighborhood].filter(Boolean).join(", "),s=[e.city,e.state].filter(Boolean).join(" - "),a=e.zipCode?`CEP ${e.zipCode}`:"";return[r,s,a].filter(Boolean).join(`
`)}function s2e(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function JH({address:e,onAddressConfirmed:t,onEditAddress:r,initialPeriod:s="qualquer",initialNotes:a=""}){const[i,o]=P.useState(!1),[l,d]=P.useState(s),[c,u]=P.useState(a),h=n2e(e),f=!!(e.street&&e.city&&e.state),m=()=>{o(!0),t({period:l,notes:c})};return f?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{className:"font-medium",children:"Confirme o endereo para entrega *"}),n.jsx(gc,{value:i?"confirmed":"",onValueChange:p=>{p==="confirmed"&&m()},children:n.jsxs("label",{className:`flex items-start gap-3 p-4 rounded-lg border-2 cursor-pointer transition-all hover:bg-muted/50 ${i?"border-green-500 bg-green-50":"border-muted hover:border-primary/50"}`,children:[n.jsx(Li,{value:"confirmed",className:"mt-1"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(mo,{className:`h-4 w-4 shrink-0 ${i?"text-green-600":"text-muted-foreground"}`}),n.jsx("span",{className:`font-medium ${i?"text-green-800":""}`,children:"Endereo de entrega"})]}),i&&n.jsx(gn,{className:"h-5 w-5 text-green-600 shrink-0"})]}),n.jsx("pre",{className:"text-sm text-muted-foreground whitespace-pre-wrap font-sans mt-2",children:h}),e.reference&&n.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[n.jsx("span",{className:"font-medium",children:"Ref:"})," ",e.reference]})]})]})}),n.jsxs(he,{variant:"outline",size:"sm",onClick:r,className:"mt-2",children:[n.jsx(Js,{className:"h-4 w-4 mr-2"}),"Editar endereo"]})]}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(Lr,{className:"h-4 w-4 text-primary"}),n.jsx(Be,{className:"font-medium",children:"Perodo de entrega *"})]}),n.jsxs(gc,{value:l,onValueChange:p=>{d(p),i&&t({period:p,notes:c})},className:"space-y-2",children:[n.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-muted/50 ${l==="manha"?"border-primary bg-primary/5":""}`,children:[n.jsx(Li,{value:"manha"}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Manh"}),n.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"(8h s 12h)"})]})]}),n.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-muted/50 ${l==="tarde"?"border-primary bg-primary/5":""}`,children:[n.jsx(Li,{value:"tarde"}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Tarde"}),n.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"(13h s 18h)"})]})]}),n.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-muted/50 ${l==="qualquer"?"border-primary bg-primary/5":""}`,children:[n.jsx(Li,{value:"qualquer"}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Qualquer horrio"}),n.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"(8h s 18h)"})]})]})]})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsx(Be,{className:"font-medium mb-2 block",children:"Observaes para entrega"}),n.jsx(rs,{value:c,onChange:p=>{u(p.target.value),i&&t({period:l,notes:p.target.value})},placeholder:"Ex: deixar na portaria / ao chegar ligar / casa de fundo / prximo ao mercado...",rows:3,className:"resize-none"})]})}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary/5 rounded-lg border border-primary/20",children:[n.jsx("span",{className:"text-sm font-medium",children:"Taxa de entrega Motoboy:"}),n.jsx("span",{className:"font-bold text-primary",children:s2e(Xs.motoboyFee)})]})]}):n.jsx($e,{className:"border-amber-200 bg-amber-50",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(mo,{className:"h-5 w-5 text-amber-600 mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-amber-800",children:"Endereo no cadastrado"}),n.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Para entrega via Motoboy, precisamos do seu endereo completo."}),n.jsxs(he,{variant:"outline",size:"sm",className:"mt-3 border-amber-300 text-amber-800 hover:bg-amber-100",onClick:r,children:[n.jsx(Js,{className:"h-4 w-4 mr-2"}),"Cadastrar endereo"]})]})]})})})}function eG(e,t){return e&&!!t}function tG({notes:e,onNotesChange:t}){return n.jsxs("div",{className:"space-y-4",children:[n.jsx($e,{className:"border-green-200 bg-green-50",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(fa,{className:"h-5 w-5 text-green-600 mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-green-800",children:"Retirar na Loja"}),n.jsx("p",{className:"text-sm text-green-700 mt-1",children:Xs.storeAddress}),n.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-green-600",children:[n.jsx(Lr,{className:"h-4 w-4"}),n.jsx("span",{children:Xs.storeHours})]}),n.jsx("p",{className:"text-lg font-bold text-green-700 mt-2",children:"Grtis"})]})]})})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsx(Be,{className:"font-medium mb-2 block",children:"Observaes (opcional)"}),n.jsx(rs,{value:e,onChange:r=>t(r.target.value),placeholder:"Ex: vou buscar amanh s 10h / outra pessoa vai retirar (nome)...",rows:3,className:"resize-none"})]})})]})}function a2e({userId:e,quotedZipCode:t,onAddressSelect:r,selectedAddressId:s,cpfRequired:a=!0,className:i}){const[o,l]=P.useState([]),[d,c]=P.useState(!0),[u,h]=P.useState(s||null),[f,m]=P.useState(!1),[p,g]=P.useState({zipCode:t,street:"",number:"",complement:"",neighborhood:"",city:"",state:"",reference:"",document:""}),x=t.replace(/\D/g,"");P.useEffect(()=>{async function R(){if(e){c(!0);try{const{data:D}=await le.from("customers").select("id").eq("user_id",e).maybeSingle();if(D){const{data:B}=await le.from("customer_addresses").select("*").eq("customer_id",D.id).order("is_default",{ascending:!1});if(B){l(B);const q=B.find(Y=>{var G;return((G=Y.zip_code)==null?void 0:G.replace(/\D/g,""))===x});q&&!u?(h(q.id),v(q)):!q&&B.length===0&&m(!0)}}else m(!0)}catch(D){console.error("Error loading addresses:",D)}finally{c(!1)}}}R()},[e,x]),P.useEffect(()=>{f&&g(R=>({...R,zipCode:x}))},[f,x]);const v=R=>{var B,q;const D={zipCode:((B=R.zip_code)==null?void 0:B.replace(/\D/g,""))||"",street:R.street||"",number:R.number||"",complement:R.complement||"",neighborhood:R.neighborhood||"",city:R.city||"",state:R.state||"",reference:R.reference||"",document:((q=R.document)==null?void 0:q.replace(/\D/g,""))||""};r(D,R.id)},y=R=>{g(R),R.zipCode.replace(/\D/g,"")===x&&R.street&&R.city&&R.state&&r(R,void 0)},b=()=>{h(null),m(!0),g({zipCode:x,street:"",number:"",complement:"",neighborhood:"",city:"",state:"",reference:"",document:""})},j=R=>{h(R.id),m(!1),v(R)},T=o.filter(R=>{var D;return((D=R.zip_code)==null?void 0:D.replace(/\D/g,""))===x}),O=o.filter(R=>{var D;return((D=R.zip_code)==null?void 0:D.replace(/\D/g,""))!==x});return d?n.jsxs("div",{className:"animate-pulse space-y-3",children:[n.jsx("div",{className:"h-20 bg-muted rounded-lg"}),n.jsx("div",{className:"h-20 bg-muted rounded-lg"})]}):n.jsxs("div",{className:He("space-y-4",i),children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(mo,{className:"h-4 w-4 text-primary"}),n.jsxs("span",{className:"font-medium",children:["Endereo de entrega para CEP ",x.replace(/(\d{5})(\d{3})/,"$1-$2")]})]}),T.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Endereos salvos para este CEP:"}),n.jsx(gc,{value:u||"",onValueChange:R=>{const D=T.find(B=>B.id===R);D&&j(D)},children:T.map(R=>n.jsx(lM,{address:R,isSelected:u===R.id&&!f,onSelect:()=>j(R),showWarning:!1},R.id))})]}),O.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Outros endereos salvos (CEP diferente):"}),n.jsx(gc,{value:u||"",onValueChange:R=>{const D=O.find(B=>B.id===R);D&&j(D)},children:O.map(R=>n.jsx(lM,{address:R,isSelected:u===R.id&&!f,onSelect:()=>j(R),showWarning:!0,quotedZip:x},R.id))})]}),n.jsx($e,{className:He("cursor-pointer transition-colors",f?"border-primary bg-primary/5":"hover:border-primary/50"),onClick:b,children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:He("w-5 h-5 rounded-full border-2 flex items-center justify-center",f?"border-primary bg-primary":"border-muted-foreground"),children:f&&n.jsx(gn,{className:"h-3 w-3 text-primary-foreground"})}),n.jsx(Yne,{className:"h-4 w-4 text-primary"}),n.jsx("span",{className:"font-medium",children:"Cadastrar novo endereo"})]})})}),f&&n.jsx($e,{className:"border-primary/30",children:n.jsxs(Fe,{className:"p-4",children:[n.jsx(U_,{value:p,onChange:y,showReference:!0,showCpf:!0,cpfRequired:a}),p.zipCode.replace(/\D/g,"")!==x&&p.zipCode.length===8&&n.jsxs(of,{variant:"destructive",className:"mt-3",children:[n.jsx(Sn,{className:"h-4 w-4"}),n.jsxs(lf,{children:["O CEP do endereo (",p.zipCode.replace(/(\d{5})(\d{3})/,"$1-$2"),")  diferente do CEP cotado (",x.replace(/(\d{5})(\d{3})/,"$1-$2"),"). O frete pode mudar. Por favor, use o CEP correto."]})]})]})})]})}function lM({address:e,isSelected:t,onSelect:r,showWarning:s,quotedZip:a}){var d;const i=[e.street,e.number,e.complement,e.neighborhood].filter(Boolean).join(", "),o=`${e.city} - ${e.state}`,l=((d=e.zip_code)==null?void 0:d.replace(/(\d{5})(\d{3})/,"$1-$2"))||"";return n.jsx($e,{className:He("cursor-pointer transition-colors",t?"border-primary bg-primary/5":"hover:border-primary/50",s&&"border-amber-300"),onClick:r,children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:He("w-5 h-5 rounded-full border-2 flex items-center justify-center mt-0.5",t?"border-primary bg-primary":"border-muted-foreground"),children:t&&n.jsx(gn,{className:"h-3 w-3 text-primary-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(JF,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"font-medium",children:e.label||"Endereo"}),e.is_default&&n.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded",children:"Padro"})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:i}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[o,"  CEP ",l]}),s&&a&&n.jsxs("div",{className:"flex items-center gap-1 mt-2 text-amber-600 text-xs",children:[n.jsx(Sn,{className:"h-3 w-3"}),n.jsxs("span",{children:["CEP diferente do cotado (",a.replace(/(\d{5})(\d{3})/,"$1-$2"),"). O frete ser recalculado."]})]})]})]})})})}function zl(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const i2e=.3,l0={length:30,width:20,height:10},o2e=()=>{var Ue;const e=pr(),{items:t,total:r,clearCart:s}=Lu(),a=e2e(),{user:i,isLoading:o}=qn(),[l,d]=P.useState("profile"),[c,u]=P.useState(""),h=vk(""),[f,m]=P.useState({zipCode:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:"",reference:"",document:""}),[p,g]=P.useState("motoboy"),[x,v]=P.useState([]),[y,b]=P.useState(null),[j,T]=P.useState(!1),[O,R]=P.useState(""),[D,B]=P.useState(null),[q,Y]=P.useState(null),[G,I]=P.useState(""),[F,S]=P.useState(!1),[E,N]=P.useState("qualquer"),[C,k]=P.useState(""),[M,U]=P.useState(!1),[$,X]=P.useState(null),[Z,re]=P.useState(!1),[W,J]=P.useState(!1),[V,H]=P.useState(null),[ee,ie]=P.useState(null),[oe,se]=P.useState({}),[ue,pe]=P.useState([]),[ce,ne]=P.useState(!1);P.useEffect(()=>{!o&&!i&&(de.info("Faa login para finalizar seu pedido"),e("/entrar",{state:{returnTo:"/checkout"}}))},[i,o,e]),P.useEffect(()=>{i&&be()},[i]),P.useEffect(()=>{l==="review"&&p==="shipping"&&((()=>{if(!D||!G)return!1;const Ze=D.zipCode.replace(/\D/g,""),ct=G.replace(/\D/g,"");return!!(D.street&&D.city&&D.state&&Ze.length===8)&&Ze===ct})()||(de.error("Endereo de entrega invlido. Selecione ou cadastre um endereo."),d("delivery")))},[l,p,D,G]);const me=P.useMemo(()=>[...new Set(t.map(Le=>Le.productId))],[t]),{getAvailable:ge,isLoading:_e}=cg(me.length>0?me:void 0);P.useEffect(()=>{async function Le(){if(t.length===0)return;const{data:Ze}=await le.from("product_catalog").select("id, stock_by_size, color, image_url, images, main_image_index, weight_kg, length_cm, width_cm, height_cm").in("id",me);if(Ze){const ct={};Ze.forEach(ht=>{ct[ht.id]=ht}),se(ct)}}Le()},[t,me]),P.useEffect(()=>{if(_e||t.length===0)return;const Le=[];t.forEach(Ze=>{const ct=ge(Ze.productId,Ze.size);Ze.quantity>ct&&(ct<=0?Le.push(`${Ze.name} (${Ze.size}): tamanho esgotado no momento`):Le.push(`${Ze.name} (${Ze.size}): apenas ${ct} disponvel(is)`))}),pe(Le)},[t,ge,_e]);const be=async()=>{if(!i)return;const{data:Le}=await le.from("profiles").select("full_name, name, whatsapp, address_line, city, state, zip_code, address_reference, cpf, address").eq("user_id",i.id).maybeSingle();if(Le){const Ze=Le.full_name||Le.name||"";u(Ze),Le.whatsapp&&h.setDisplayValue(Le.whatsapp);const ct=CC(Le.address_line,Le.city,Le.state,Le.zip_code,Le.address_reference);m(ct),Le.zip_code&&R(Le.zip_code.replace(/\D/g,""));const ht=!!(Ze&&Le.whatsapp);ne(ht),ht&&d("delivery")}},ye=async()=>{if(i){if(!c.trim()||!h.displayValue){de.error("Preencha nome e WhatsApp");return}if(!h.isValid){de.error("WhatsApp invlido");return}re(!0);try{const Ze=[f.street,f.number,f.complement,f.neighborhood].filter(Boolean).join(", "),{error:ct}=await le.from("profiles").update({full_name:c.trim(),name:c.trim(),whatsapp:h.getNormalizedValue(),address_line:Ze||null,city:f.city.trim()||null,state:f.state.trim()||null,zip_code:f.zipCode.replace(/\D/g,"")||null,address_reference:f.reference.trim()||null}).eq("user_id",i.id);if(ct)throw ct;ne(!0),d("delivery"),de.success("Dados salvos!")}catch(Le){console.error("Save profile error:",Le),de.error("Erro ao salvar dados")}finally{re(!1)}}},Oe=()=>{let Le=0;return t.forEach(Ze=>{var ht;const ct=((ht=oe[Ze.productId])==null?void 0:ht.weight_kg)||i2e;Le+=ct*Ze.quantity}),Math.round(Le*100)/100},Ne=()=>{let Le=l0.length,Ze=l0.width,ct=0;return t.forEach(ht=>{const yt=oe[ht.productId],Re=(yt==null?void 0:yt.length_cm)||l0.length,Ke=(yt==null?void 0:yt.width_cm)||l0.width,_t=(yt==null?void 0:yt.height_cm)||l0.height;Le=Math.max(Le,Re),Ze=Math.max(Ze,Ke),ct+=_t*ht.quantity}),{length:Math.min(Math.max(Le,11),100),width:Math.min(Math.max(Ze,11),100),height:Math.min(Math.max(ct,2),100)}},De=async()=>{var Ze,ct;const Le=O.replace(/\D/g,"");if(Le.length!==8){de.error("CEP invlido");return}T(!0),v([]),b(null),B(null),Y(null);try{const ht=Oe(),yt=Ne();console.log(`Shipping calculation: weight=${ht}kg, dimensions=${yt.length}x${yt.width}x${yt.height}cm`);const{data:Re,error:Ke}=await le.functions.invoke("calculate-shipping",{body:{toZipCode:Le,weight:ht,length:yt.length,width:yt.width,height:yt.height}});if(Ke)throw Ke;Re.quotes&&Re.quotes.length>0?(v(Re.quotes),b(Re.quotes[0]),I(Le),de.success("Frete calculado! Agora selecione o endereo de entrega.")):de.error(Re.error||"No foi possvel calcular o frete")}catch(ht){console.error("Shipping calculation error:",ht);let yt="Erro ao calcular frete";if(((Ze=ht==null?void 0:ht.context)==null?void 0:Ze.status)===500||((ct=ht==null?void 0:ht.context)==null?void 0:ct.status)===400)try{const Re=await ht.context.json();Re!=null&&Re.error&&(yt=Re.error,Re.details&&(yt+=`: ${Re.details}`))}catch(Re){console.error("Failed to parse error body:",Re)}else ht!=null&&ht.message&&(yt=ht.message);de.error(yt)}finally{T(!1)}},Ge=()=>p==="pickup"?0:p==="motoboy"?Xs.motoboyFee:p==="shipping"&&y?y.price:0,Qe=()=>p==="shipping"&&D?(D.document||"").replace(/\D/g,"").length===11:(f.document||"").replace(/\D/g,"").length===11,Ie=()=>{if(!D||!G)return!1;const Le=D.zipCode.replace(/\D/g,""),Ze=G.replace(/\D/g,"");return!!(D.street&&D.city&&D.state&&Le.length===8)&&Le===Ze},Ae=()=>{if(!y)return"Calcule o frete primeiro";if(!G)return"CEP no cotado";if(!D)return"Selecione ou cadastre um endereo";const Le=D.zipCode.replace(/\D/g,""),Ze=G.replace(/\D/g,"");return Le!==Ze?`O frete foi calculado para o CEP ${Ze.replace(/(\d{5})(\d{3})/,"$1-$2")}, mas o endereo selecionado  do CEP ${Le.replace(/(\d{5})(\d{3})/,"$1-$2")}. Selecione ou cadastre o endereo correto.`:!D.street||!D.city||!D.state?"Complete todos os campos obrigatrios do endereo":Qe()?null:"CPF obrigatrio para gerar etiqueta dos Correios (11 dgitos)"},st=()=>p==="pickup"?!0:p==="motoboy"?eG(F,E):p==="shipping"?!!y&&Ie()&&Qe():!1,nt=async()=>{var Le;if(!i){de.error("Faa login para continuar");return}if(t.length===0){de.error("Carrinho vazio");return}if(!c.trim()){de.error("Preencha seu nome completo"),d("profile");return}if(!h.isValid||!h.displayValue){de.error("Preencha um WhatsApp vlido"),d("profile");return}if(ue.length>0){de.error("Corrija os problemas de estoque");return}if(p==="shipping"){const Ze=Ae();if(Ze){de.error(Ze),d("delivery");return}}U(!0);try{const Ze=Ge(),ct=a.discountAmount,ht=r-ct+Ze,yt=p==="shipping"&&D?D:f,Ke=[yt.street,yt.number,yt.complement,yt.neighborhood].filter(Boolean).join(", "),_t={full_name:c,whatsapp:h.getNormalizedValue(),address_line:Ke,city:yt.city,state:yt.state,zip_code:yt.zipCode,address_reference:yt.reference,document:((Le=yt.document)==null?void 0:Le.replace(/\D/g,""))||""},Rt=p==="pickup"?"Retirada na loja":`${Ke}, ${yt.city} - ${yt.state}, CEP ${yt.zipCode}${yt.reference?` (${yt.reference})`:""}`,{data:Se,error:tt}=await le.from("orders").insert({customer_name:c,customer_phone:h.getNormalizedValue(),customer_address:Rt,subtotal:r,total:ht,status:"aguardando_pagamento",payment_status:"pending",user_id:i.id,delivery_method:p,shipping_fee:Ze,shipping_service:(y==null?void 0:y.service)||null,shipping_deadline_days:(y==null?void 0:y.deliveryDays)||null,address_snapshot:_t,coupon_id:a.coupon&&!a.coupon.isBirthdayCoupon?a.coupon.id:null,coupon_discount:ct,delivery_period:p==="motoboy"?E:null,delivery_notes:(C==null?void 0:C.trim())||null,customer_notes:(C==null?void 0:C.trim())||null}).select().single();if(tt)throw tt;const ot=t.map(Pt=>{var dt;const Pe=oe[Pt.productId],Me=(Pe==null?void 0:Pe.main_image_index)||0,it=((dt=Pe==null?void 0:Pe.images)==null?void 0:dt[Me])||(Pe==null?void 0:Pe.image_url)||Pt.imageUrl||null,gt=Pt.price*Pt.quantity;return console.log("[CHECKOUT] Order item:",{product_id:Pt.productId,size:Pt.size,quantity:Pt.quantity,unit_price_original:Pt.originalPrice,unit_price_final:Pt.price,discount_percent:Pt.discountPercent,subtotal:gt}),{order_id:Se.id,product_id:Pt.productId,product_name:Pt.name,product_price:Pt.price,unit_price_original:Pt.originalPrice,discount_percent:Pt.discountPercent,subtotal:gt,size:Pt.size,quantity:Pt.quantity,color:(Pe==null?void 0:Pe.color)||null,image_url:it}}),{error:lt}=await le.from("order_items").insert(ot);if(lt)throw lt;const{data:At,error:Nt}=await le.rpc("reserve_order_stock",{p_order_id:Se.id});Nt?console.error("[CHECKOUT] Stock reservation failed:",Nt):console.log("[CHECKOUT] Stock reserved:",At),a.coupon&&await t2e(a.coupon.id,Se.id,null,ct,a.coupon.isBirthdayCoupon);const ut=(f.document||"").replace(/\D/g,"");if(ut.length===11&&(i!=null&&i.id)){const{data:Pt}=await le.from("customers").select("id").eq("user_id",i.id).maybeSingle();if(Pt){await le.from("customers").update({document:ut}).eq("id",Pt.id);const{data:Pe}=await le.from("customer_addresses").select("id").eq("customer_id",Pt.id).eq("is_default",!0).maybeSingle();Pe&&await le.from("customer_addresses").update({document:ut}).eq("id",Pe.id)}}H(Se.id),ie(Se.id.slice(0,8).toUpperCase());const lr=r-a.discountAmount+Ge();X(lr),s(),d("payment"),de.success("Pedido criado! Agora finalize o pagamento.")}catch(Ze){console.error("Checkout error:",Ze),de.error("Erro ao criar pedido. Tente novamente.")}finally{U(!1)}},vt=async()=>{if(!V){de.error("Pedido no encontrado");return}J(!0);try{console.log("[CHECKOUT] Calling finalize_order_prices RPC for:",V);const{data:Le,error:Ze}=await le.rpc("finalize_order_prices",{p_order_id:V});Ze?(console.error("finalize_order_prices RPC error:",Ze),console.warn("[CHECKOUT] Continuing despite finalize error")):console.log("[CHECKOUT] finalize_order_prices result:",Le);const{data:ct,error:ht}=await le.functions.invoke("create-mp-preference",{body:{order_id:V,payer_email:(i==null?void 0:i.email)||""}});if(ht){console.error("MP preference invocation error:",ht),de.error("Erro de conexo com o servidor. Tente novamente.");return}if(ct!=null&&ct.error_code||ct!=null&&ct.error){console.error("MP preference error:",ct);const yt=ct.error||"Erro ao criar link de pagamento",Re=ct.action||"";de.error(`${yt}${Re?` ${Re}`:""}`);return}ct!=null&&ct.init_point?window.location.href=ct.init_point:(console.error("MP preference missing init_point:",ct),de.error("Link de pagamento no gerado. Tente novamente."))}catch(Le){console.error("Payment error:",Le),de.error("Erro ao processar pagamento. Verifique sua conexo.")}finally{J(!1)}};if(o)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-primary"})});if(t.length===0&&!ee&&l!=="payment")return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx(Vt,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Carrinho vazio"}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Adicione produtos antes de finalizar"}),n.jsx(he,{onClick:()=>e("/catalogo"),children:"Ver catlogo"})]})]});const Je=r-a.discountAmount+Ge();return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-lg",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1 sm:gap-2 mb-8",children:[n.jsx(Ey,{step:"profile",current:l,label:"Cadastro",icon:n.jsx(Dn,{className:"h-4 w-4"})}),n.jsx("div",{className:"w-4 sm:w-8 h-px bg-border"}),n.jsx(Ey,{step:"delivery",current:l,label:"Entrega",icon:n.jsx(yn,{className:"h-4 w-4"})}),n.jsx("div",{className:"w-4 sm:w-8 h-px bg-border"}),n.jsx(Ey,{step:"review",current:l,label:"Confirmar",icon:n.jsx(mn,{className:"h-4 w-4"})}),n.jsx("div",{className:"w-4 sm:w-8 h-px bg-border"}),n.jsx(Ey,{step:"payment",current:l,label:"Pagar",icon:n.jsx(ms,{className:"h-4 w-4"})})]}),ue.length>0&&n.jsx($e,{className:"mb-6 border-destructive",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Sn,{className:"h-5 w-5 text-destructive flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-destructive mb-1",children:"Problemas de estoque"}),n.jsx("ul",{className:"text-sm text-muted-foreground space-y-1",children:ue.map((Le,Ze)=>n.jsx("li",{children:Le},Ze))}),n.jsx(he,{variant:"link",size:"sm",className:"px-0 h-auto mt-2",onClick:()=>e("/carrinho"),children:"Ajustar carrinho"})]})]})})}),l==="profile"&&n.jsxs($e,{children:[n.jsxs(Dt,{children:[n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Dn,{className:"h-5 w-5"}),"Complete seu cadastro"]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:" s uma vez. Seus dados ficam salvos para os prximos pedidos."})]}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"fullName",children:"Seu nome *"}),n.jsx(et,{id:"fullName",placeholder:"Maria Silva",value:c,onChange:Le=>u(Le.target.value),required:!0})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"phone",children:"WhatsApp *"}),n.jsx(et,{id:"phone",type:"tel",placeholder:"(62) 99122-3519",value:h.displayValue,onChange:h.handleChange,onBlur:h.handleBlur,className:h.hasError?"border-destructive":""}),h.hasError&&n.jsx("p",{className:"text-sm text-destructive",children:"WhatsApp invlido"})]}),n.jsxs("div",{className:"border-t pt-4 mt-4",children:[n.jsx("p",{className:"text-sm font-medium mb-3",children:"Endereo (para entregas)"}),n.jsx(U_,{value:f,onChange:Le=>{m(Le),Le.zipCode.length===8&&R(Le.zipCode)},showReference:!0})]}),n.jsx(he,{className:"w-full mt-4",onClick:ye,disabled:Z||!c.trim()||!h.displayValue||!h.isValid,children:Z?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):n.jsxs(n.Fragment,{children:["Continuar",n.jsx(hs,{className:"h-4 w-4 ml-2"})]})})]})]}),l==="delivery"&&n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(yn,{className:"h-5 w-5"}),"Como voc quer receber?"]})}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs(gc,{value:p,onValueChange:Le=>{g(Le),Le!=="shipping"&&(v([]),b(null))},children:[n.jsxs("div",{className:`flex items-start space-x-3 p-4 rounded-lg border ${p==="motoboy"?"border-primary bg-primary/5":"border-border"}`,children:[n.jsx(Li,{value:"motoboy",id:"motoboy",className:"mt-1"}),n.jsxs(Be,{htmlFor:"motoboy",className:"flex-1 cursor-pointer",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(mo,{className:"h-4 w-4 text-primary"}),n.jsx("span",{className:"font-medium",children:"Motoboy (Anpolis)"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:Xs.motoboyDeliveryText}),n.jsx("p",{className:"text-sm font-medium text-primary mt-1",children:zl(Xs.motoboyFee)})]})]}),n.jsxs("div",{className:`flex items-start space-x-3 p-4 rounded-lg border ${p==="pickup"?"border-primary bg-primary/5":"border-border"}`,children:[n.jsx(Li,{value:"pickup",id:"pickup",className:"mt-1"}),n.jsxs(Be,{htmlFor:"pickup",className:"flex-1 cursor-pointer",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(fa,{className:"h-4 w-4 text-primary"}),n.jsx("span",{className:"font-medium",children:"Retirar na loja"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:Xs.storeAddress}),n.jsx("p",{className:"text-xs text-muted-foreground",children:Xs.storeHours}),n.jsx("p",{className:"text-sm font-medium text-green-600 mt-1",children:"Grtis"})]})]}),n.jsxs("div",{className:`flex items-start space-x-3 p-4 rounded-lg border ${p==="shipping"?"border-primary bg-primary/5":"border-border"}`,children:[n.jsx(Li,{value:"shipping",id:"shipping",className:"mt-1"}),n.jsxs(Be,{htmlFor:"shipping",className:"flex-1 cursor-pointer",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(yn,{className:"h-4 w-4 text-primary"}),n.jsx("span",{className:"font-medium",children:"Outra cidade (Correios)"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Entrega via PAC ou SEDEX"})]})]})]}),p==="motoboy"&&n.jsx(JH,{address:{street:f.street,number:f.number,complement:f.complement,neighborhood:f.neighborhood,city:f.city,state:f.state,zipCode:f.zipCode,reference:f.reference},onAddressConfirmed:({period:Le,notes:Ze})=>{S(!0),N(Le),k(Ze)},onEditAddress:()=>d("profile"),initialPeriod:E,initialNotes:C}),p==="pickup"&&n.jsx(tG,{notes:C,onNotesChange:k}),p==="shipping"&&n.jsxs("div",{className:"border-t pt-4 space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{className:"text-sm font-medium",children:"1. Calcular frete"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(et,{placeholder:"Digite o CEP de destino",value:O,onChange:Le=>R(Le.target.value.replace(/\D/g,"").slice(0,8)),className:"flex-1"}),n.jsx(he,{variant:"secondary",onClick:De,disabled:j||O.length<8,children:j?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):"Calcular"})]})]}),x.length>0&&n.jsx(gc,{value:(y==null?void 0:y.service)||"",onValueChange:Le=>b(x.find(Ze=>Ze.service===Le)||null),children:x.map(Le=>n.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${(y==null?void 0:y.service)===Le.service?"border-primary bg-primary/5":"border-border"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Li,{value:Le.service,id:Le.service}),n.jsxs(Be,{htmlFor:Le.service,className:"cursor-pointer",children:[n.jsx("span",{className:"font-medium",children:Le.serviceName}),n.jsx("p",{className:"text-xs text-muted-foreground",children:Le.deliveryRange.min===Le.deliveryRange.max?`${Le.deliveryDays} dias teis`:`${Le.deliveryRange.min}-${Le.deliveryRange.max} dias teis`})]})]}),n.jsx("span",{className:"font-medium",children:zl(Le.price)})]},Le.service))}),y&&G&&i&&n.jsxs("div",{className:"space-y-2 border-t pt-4",children:[n.jsx(Be,{className:"text-sm font-medium",children:"2. Endereo de entrega"}),n.jsx(a2e,{userId:i.id,quotedZipCode:G,onAddressSelect:(Le,Ze)=>{B(Le),Y(Ze||null)},selectedAddressId:q,cpfRequired:!0})]}),y&&Ae()&&n.jsxs(of,{variant:"destructive",className:"mt-2",children:[n.jsx(Sn,{className:"h-4 w-4"}),n.jsx(lf,{children:Ae()})]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(he,{variant:"outline",onClick:()=>d("profile"),children:"Voltar"}),n.jsxs(he,{className:"flex-1",onClick:()=>d("review"),disabled:!st(),children:["Continuar",n.jsx(hs,{className:"h-4 w-4 ml-2"})]})]})]})]}),l==="review"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsx(Lt,{className:"text-sm font-medium text-muted-foreground",children:"Resumo do pedido"})}),n.jsxs(Fe,{className:"space-y-2",children:[t.map(Le=>{var yt;const Ze=(yt=oe[Le.productId])==null?void 0:yt.stock_by_size,ht=R0e(Ze&&typeof Ze=="object"?Ze:{},Le.size);return n.jsxs("div",{className:"flex justify-between text-sm items-center",children:[n.jsxs("span",{className:"flex items-center gap-2",children:[Le.name," (",Le.size,") x",Le.quantity,ht&&n.jsx(ke,{variant:"outline",className:"text-[10px]",children:"ltimas"})]}),n.jsx("span",{children:zl(Le.price*Le.quantity)})]},`${Le.productId}-${Le.size}`)}),n.jsxs("div",{className:"border-t pt-2 mt-2 space-y-1",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Subtotal"}),n.jsx("span",{children:zl(r)})]}),a.discountAmount>0&&n.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[n.jsxs("span",{children:["Cupom (",(Ue=a.coupon)==null?void 0:Ue.code,")"]}),n.jsxs("span",{children:["-",zl(a.discountAmount)]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:p==="pickup"?"Retirada":p==="motoboy"?"Motoboy":(y==null?void 0:y.serviceName)||"Frete"}),n.jsx("span",{className:Ge()===0?"text-green-600":"",children:Ge()===0?"Grtis":zl(Ge())})]}),n.jsxs("div",{className:"flex justify-between font-medium text-lg border-t pt-2",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{className:"text-accent",children:zl(Je)})]})]})]})]}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsx("p",{className:"text-sm font-medium mb-3",children:"Cupom de desconto"}),n.jsx(r2e,{onApply:Le=>a.applyCoupon(Le,r),onRemove:a.removeCoupon,appliedCoupon:a.coupon?{code:a.coupon.code,discountAmount:a.discountAmount}:null,isLoading:a.isLoading,error:a.error,orderTotal:r})]})}),n.jsx($e,{children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[p==="pickup"?n.jsx(fa,{className:"h-5 w-5 text-primary mt-0.5"}):n.jsx(mo,{className:"h-5 w-5 text-primary mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:p==="pickup"?"Retirada na loja":"Entrega"}),p==="pickup"?n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:Xs.storeAddress}),n.jsx("p",{className:"text-xs text-muted-foreground",children:Xs.storeHours})]}):p==="shipping"&&D?n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:SC(D)}),y&&n.jsxs("p",{className:"text-xs text-primary mt-1",children:[y.serviceName,"  ",zl(y.price)]})]}):n.jsx("p",{className:"text-sm text-muted-foreground",children:SC(f)})]})]})})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(he,{variant:"outline",onClick:()=>d("delivery"),children:"Voltar"}),n.jsx(he,{className:"flex-1",size:"lg",onClick:nt,disabled:M||ue.length>0,children:M?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Finalizando..."]}):`Confirmar pedido  ${zl(Je)}`})]})]}),l==="payment"&&V&&n.jsx("div",{className:"space-y-4",children:n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(ms,{className:"h-5 w-5"}),"Pagamento via Mercado Pago"]})}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 text-center",children:[n.jsxs("p",{className:"text-sm mb-2",children:["Pedido ",n.jsxs("span",{className:"font-mono font-bold",children:["#",ee]})," criado!"]}),$!==null?n.jsx("p",{className:"text-2xl font-bold text-accent",children:zl($)}):n.jsx("div",{className:"h-8 w-32 mx-auto bg-muted animate-pulse rounded"})]}),n.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Voc ser redirecionada para o Mercado Pago para finalizar o pagamento com segurana. Aceita carto, Pix e boleto."}),n.jsx(he,{onClick:vt,disabled:W,className:"w-full",size:"lg",children:W?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Gerando link..."]}):n.jsxs(n.Fragment,{children:["Pagar com Mercado Pago",n.jsx(Zs,{className:"h-4 w-4 ml-2"})]})}),n.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Pagamento 100% seguro. Seus dados so protegidos."})]})]})})]})]})};function Ey({step:e,current:t,label:r,icon:s}){const a=["profile","delivery","review","payment"],i=a.indexOf(t),o=a.indexOf(e),l=e===t,d=o<i;return n.jsxs("div",{className:`flex flex-col items-center gap-1 ${l?"text-primary":d?"text-primary/70":"text-muted-foreground"}`,children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${l?"bg-primary text-primary-foreground":d?"bg-primary/20":"bg-muted"}`,children:d?n.jsx(mn,{className:"h-4 w-4"}):s}),n.jsx("span",{className:"text-xs",children:r})]})}function ky(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var rG={exports:{}};/*! ExcelJS 19-10-2023 */(function(e,t){(function(r){e.exports=r()})(function(){return function r(s,a,i){function o(c,u){if(!a[c]){if(!s[c]){var h=typeof ky=="function"&&ky;if(!u&&h)return h(c,!0);if(l)return l(c,!0);var f=new Error("Cannot find module '"+c+"'");throw f.code="MODULE_NOT_FOUND",f}var m=a[c]={exports:{}};s[c][0].call(m.exports,function(p){return o(s[c][1][p]||p)},m,m.exports,r,s,a,i)}return a[c].exports}for(var l=typeof ky=="function"&&ky,d=0;d<i.length;d++)o(i[d]);return o}({1:[function(r,s,a){const i=r("fs"),o=r("fast-csv"),l=r("dayjs/plugin/customParseFormat"),d=r("dayjs/plugin/utc"),c=r("dayjs").extend(l).extend(d),u=r("../utils/stream-buf"),{fs:{exists:h}}=r("../utils/utils"),f={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};s.exports=class{constructor(m){this.workbook=m,this.worksheet=null}async readFile(m,p){if(p=p||{},!await h(m))throw new Error("File not found: "+m);const g=i.createReadStream(m),x=await this.read(g,p);return g.close(),x}read(m,p){return p=p||{},new Promise((g,x)=>{const v=this.workbook.addWorksheet(p.sheetName),y=p.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],b=p.map||function(T){if(T==="")return null;const O=Number(T);if(!Number.isNaN(O)&&O!==1/0)return O;const R=y.reduce((B,q)=>{if(B)return B;const Y=c(T,q,!0);return Y.isValid()?Y:null},null);if(R)return new Date(R.valueOf());const D=f[T];return D!==void 0?D:T},j=o.parse(p.parserOptions).on("data",T=>{v.addRow(T.map(b))}).on("end",()=>{j.emit("worksheet",v)});j.on("worksheet",g).on("error",x),m.pipe(j)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(m,p){return new Promise((g,x)=>{p=p||{};const v=this.workbook.getWorksheet(p.sheetName||p.sheetId),y=o.format(p.formatterOptions);m.on("finish",()=>{g()}),y.on("error",x),y.pipe(m);const{dateFormat:b,dateUTC:j}=p,T=p.map||(D=>{if(D){if(D.text||D.hyperlink)return D.hyperlink||D.text||"";if(D.formula||D.result)return D.result||"";if(D instanceof Date)return b?j?c.utc(D).format(b):c(D).format(b):j?c.utc(D).format():c(D).format();if(D.error)return D.error;if(typeof D=="object")return JSON.stringify(D)}return D}),O=p.includeEmptyRows===void 0||p.includeEmptyRows;let R=1;v&&v.eachRow((D,B)=>{if(O)for(;R++<B-1;)y.write([]);const{values:q}=D;q.shift(),y.write(q.map(T)),R=B}),y.end()})}writeFile(m,p){const g={encoding:(p=p||{}).encoding||"utf8"},x=i.createWriteStream(m,g);return this.write(x,p)}async writeBuffer(m){const p=new u;return await this.write(p,m),p.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(r,s,a){const i=r("../utils/col-cache");class o{constructor(d,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=d,c)if(typeof c=="string"){const h=i.decodeAddress(c);this.nativeCol=h.col+u,this.nativeColOff=0,this.nativeRow=h.row+u,this.nativeRowOff=0}else c.nativeCol!==void 0?(this.nativeCol=c.nativeCol||0,this.nativeColOff=c.nativeColOff||0,this.nativeRow=c.nativeRow||0,this.nativeRowOff=c.nativeRowOff||0):c.col!==void 0?(this.col=c.col+u,this.row=c.row+u):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(d){return d instanceof o||d==null?d:new o(d)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(d){this.nativeCol=Math.floor(d),this.nativeColOff=Math.floor((d-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(d){this.nativeRow=Math.floor(d),this.nativeRowOff=Math.floor((d-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(d){this.nativeCol=d.nativeCol,this.nativeColOff=d.nativeColOff,this.nativeRow=d.nativeRow,this.nativeRowOff=d.nativeRowOff}}s.exports=o},{"../utils/col-cache":19}],3:[function(r,s,a){const i=r("../utils/col-cache"),o=r("../utils/under-dash"),l=r("./enums"),{slideFormula:d}=r("../utils/shared-formula"),c=r("./note");class u{constructor(m,p,g){if(!m||!p)throw new Error("A Cell needs a Row");this._row=m,this._column=p,i.validateAddress(g),this._address=g,this._value=h.create(u.Types.Null,this),this.style=this._mergeStyle(m.style,p.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(m){this.style.numFmt=m}get font(){return this.style.font}set font(m){this.style.font=m}get alignment(){return this.style.alignment}set alignment(m){this.style.alignment=m}get border(){return this.style.border}set border(m){this.style.border=m}get fill(){return this.style.fill}set fill(m){this.style.fill=m}get protection(){return this.style.protection}set protection(m){this.style.protection=m}_mergeStyle(m,p,g){const x=m&&m.numFmt||p&&p.numFmt;x&&(g.numFmt=x);const v=m&&m.font||p&&p.font;v&&(g.font=v);const y=m&&m.alignment||p&&p.alignment;y&&(g.alignment=y);const b=m&&m.border||p&&p.border;b&&(g.border=b);const j=m&&m.fill||p&&p.fill;j&&(g.fill=j);const T=m&&m.protection||p&&p.protection;return T&&(g.protection=T),g}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===u.Types.Merge}merge(m,p){this._value.release(),this._value=h.create(u.Types.Merge,this,m),p||(this.style=m.style)}unmerge(){this.type===u.Types.Merge&&(this._value.release(),this._value=h.create(u.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(m){return this._value.type===u.Types.Merge&&this._value.isMergedTo(m)}get master(){return this.type===u.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===u.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(m){this.type!==u.Types.Merge?(this._value.release(),this._value=h.create(h.getType(m),this,m)):this._value.master.value=m}get note(){return this._comment&&this._comment.note}set note(m){this._comment=new c(m)}get text(){return this._value.toString()}get html(){return o.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(m){this.type===u.Types.String&&(this._value=h.create(u.Types.Hyperlink,this,{text:this._value.value,hyperlink:m}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:m}=this._row;return{sheetName:m.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(m){this.names=[m]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(m){const{definedNames:p}=this.workbook;p.removeAllNames(this.fullAddress),m.forEach(g=>{p.addEx(this.fullAddress,g)})}addName(m){this.workbook.definedNames.addEx(this.fullAddress,m)}removeName(m){this.workbook.definedNames.removeEx(this.fullAddress,m)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(m){this._dataValidations.add(this.address,m)}get model(){const{model:m}=this._value;return m.style=this.style,this._comment&&(m.comment=this._comment.model),m}set model(m){if(this._value.release(),this._value=h.create(m.type,this),this._value.model=m,m.comment)switch(m.comment.type){case"note":this._comment=c.fromModel(m.comment)}m.style?this.style=m.style:this.style={}}}u.Types=l.ValueType;const h={getType:f=>f==null?u.Types.Null:f instanceof String||typeof f=="string"?u.Types.String:typeof f=="number"?u.Types.Number:typeof f=="boolean"?u.Types.Boolean:f instanceof Date?u.Types.Date:f.text&&f.hyperlink?u.Types.Hyperlink:f.formula||f.sharedFormula?u.Types.Formula:f.richText?u.Types.RichText:f.sharedString?u.Types.SharedString:f.error?u.Types.Error:u.Types.JSON,types:[{t:u.Types.Null,f:class{constructor(f){this.model={address:f.address,type:u.Types.Null}}get value(){return null}set value(f){}get type(){return u.Types.Null}get effectiveType(){return u.Types.Null}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){}toString(){return""}}},{t:u.Types.Number,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Number,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Number}get effectiveType(){return u.Types.Number}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.String,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.String,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:u.Types.Date,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Date,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Date}get effectiveType(){return u.Types.Date}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Hyperlink,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Hyperlink,text:m?m.text:void 0,hyperlink:m?m.hyperlink:void 0},m&&m.tooltip&&(this.model.tooltip=m.tooltip)}get value(){const f={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(f.tooltip=this.model.tooltip),f}set value(f){this.model={text:f.text,hyperlink:f.hyperlink},f.tooltip&&(this.model.tooltip=f.tooltip)}get text(){return this.model.text}set text(f){this.model.text=f}get hyperlink(){return this.model.hyperlink}set hyperlink(f){this.model.hyperlink=f}get type(){return u.Types.Hyperlink}get effectiveType(){return u.Types.Hyperlink}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:u.Types.Formula,f:class{constructor(f,m){this.cell=f,this.model={address:f.address,type:u.Types.Formula,shareType:m?m.shareType:void 0,ref:m?m.ref:void 0,formula:m?m.formula:void 0,sharedFormula:m?m.sharedFormula:void 0,result:m?m.result:void 0}}_copyModel(f){const m={},p=g=>{const x=f[g];x&&(m[g]=x)};return p("formula"),p("result"),p("ref"),p("shareType"),p("sharedFormula"),m}get value(){return this._copyModel(this.model)}set value(f){this.model=this._copyModel(f)}validate(f){switch(h.getType(f)){case u.Types.Null:case u.Types.String:case u.Types.Number:case u.Types.Date:break;case u.Types.Hyperlink:case u.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(f){this.model.formula=f}get formulaType(){return this.model.formula?l.FormulaType.Master:this.model.sharedFormula?l.FormulaType.Shared:l.FormulaType.None}get result(){return this.model.result}set result(f){this.model.result=f}get type(){return u.Types.Formula}get effectiveType(){const f=this.model.result;return f==null?l.ValueType.Null:f instanceof String||typeof f=="string"?l.ValueType.String:typeof f=="number"?l.ValueType.Number:f instanceof Date?l.ValueType.Date:f.text&&f.hyperlink?l.ValueType.Hyperlink:f.formula?l.ValueType.Formula:l.ValueType.Null}get address(){return this.model.address}set address(f){this.model.address=f}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:f}=this.cell,m=f.findCell(this.model.sharedFormula);this._translatedFormula=m&&d(m.formula,m.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:u.Types.Merge,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Merge,master:m?m.address:void 0},this._master=m,m&&m.addMergeRef()}get value(){return this._master.value}set value(f){f instanceof u?(this._master&&this._master.releaseMergeRef(),f.addMergeRef(),this._master=f):this._master.value=f}isMergedTo(f){return f===this._master}get master(){return this._master}get type(){return u.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:u.Types.JSON,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.String,value:JSON.stringify(m),rawValue:m}}get value(){return this.model.rawValue}set value(f){this.model.rawValue=f,this.model.value=JSON.stringify(f)}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:u.Types.SharedString,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.SharedString,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.SharedString}get effectiveType(){return u.Types.SharedString}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.RichText,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.String,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}toString(){return this.model.value.richText.map(f=>f.text).join("")}get type(){return u.Types.RichText}get effectiveType(){return u.Types.RichText}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:u.Types.Boolean,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Boolean,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Boolean}get effectiveType(){return u.Types.Boolean}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Error,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Error,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Error}get effectiveType(){return u.Types.Error}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((f,m)=>(f[m.t]=m.f,f),[]),create(f,m,p){const g=this.types[f];if(!g)throw new Error("Could not create Value of type "+f);return new g(m,p)}};s.exports=u},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(r,s,a){const i=r("../utils/under-dash"),o=r("./enums"),l=r("../utils/col-cache");class d{constructor(u,h,f){this._worksheet=u,this._number=h,f!==!1&&(this.defn=f)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return l.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(u){u?(this.key=u.key,this.width=u.width!==void 0?u.width:9,this.outlineLevel=u.outlineLevel,u.style?this.style=u.style:this.style={},this.header=u.header,this._hidden=!!u.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(u){u!==void 0?(this._header=u,this.headers.forEach((h,f)=>{this._worksheet.getCell(f+1,this.number).value=h})):this._header=void 0}get key(){return this._key}set key(u){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=u,u&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(u){this._hidden=u}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(u){this._outlineLevel=u}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(u){return this.width===u.width&&this.hidden===u.hidden&&this.outlineLevel===u.outlineLevel&&i.isEqual(this.style,u.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const u=this.style;return!u||!(u.font||u.numFmt||u.alignment||u.border||u.fill||u.protection)}get headerCount(){return this.headers.length}eachCell(u,h){const f=this.number;h||(h=u,u=null),this._worksheet.eachRow(u,(m,p)=>{h(m.getCell(f),p)})}get values(){const u=[];return this.eachCell((h,f)=>{h&&h.type!==o.ValueType.Null&&(u[f]=h.value)}),u}set values(u){if(!u)return;const h=this.number;let f=0;u.hasOwnProperty("0")&&(f=1),u.forEach((m,p)=>{this._worksheet.getCell(p+f,h).value=m})}_applyStyle(u,h){return this.style[u]=h,this.eachCell(f=>{f[u]=h}),h}get numFmt(){return this.style.numFmt}set numFmt(u){this._applyStyle("numFmt",u)}get font(){return this.style.font}set font(u){this._applyStyle("font",u)}get alignment(){return this.style.alignment}set alignment(u){this._applyStyle("alignment",u)}get protection(){return this.style.protection}set protection(u){this._applyStyle("protection",u)}get border(){return this.style.border}set border(u){this._applyStyle("border",u)}get fill(){return this.style.fill}set fill(u){this._applyStyle("fill",u)}static toModel(u){const h=[];let f=null;return u&&u.forEach((m,p)=>{m.isDefault?f&&(f=null):f&&m.equivalentTo(f)?f.max=p+1:(f={min:p+1,max:p+1,width:m.width!==void 0?m.width:9,style:m.style,isCustomWidth:m.isCustomWidth,hidden:m.hidden,outlineLevel:m.outlineLevel,collapsed:m.collapsed},h.push(f))}),h.length?h:void 0}static fromModel(u,h){const f=[];let m=1,p=0;for(h=(h=h||[]).sort(function(g,x){return g.min-x.min});p<h.length;){const g=h[p++];for(;m<g.min;)f.push(new d(u,m++));for(;m<=g.max;)f.push(new d(u,m++,g))}return f.length?f:null}}s.exports=d},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(r,s,a){s.exports=class{constructor(i){this.model=i||{}}add(i,o){return this.model[i]=o}find(i){return this.model[i]}remove(i){this.model[i]=void 0}}},{}],6:[function(r,s,a){const i=r("../utils/under-dash"),o=r("../utils/col-cache"),l=r("../utils/cell-matrix"),d=r("./range"),c=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;s.exports=class{constructor(){this.matrixMap={}}getMatrix(u){return this.matrixMap[u]||(this.matrixMap[u]=new l)}add(u,h){const f=o.decodeEx(u);this.addEx(f,h)}addEx(u,h){const f=this.getMatrix(h);if(u.top)for(let m=u.left;m<=u.right;m++)for(let p=u.top;p<=u.bottom;p++){const g={sheetName:u.sheetName,address:o.n2l(m)+p,row:p,col:m};f.addCellEx(g)}else f.addCellEx(u)}remove(u,h){const f=o.decodeEx(u);this.removeEx(f,h)}removeEx(u,h){this.getMatrix(h).removeCellEx(u)}removeAllNames(u){i.each(this.matrixMap,h=>{h.removeCellEx(u)})}forEach(u){i.each(this.matrixMap,(h,f)=>{h.forEach(m=>{u(f,m)})})}getNames(u){return this.getNamesEx(o.decodeEx(u))}getNamesEx(u){return i.map(this.matrixMap,(h,f)=>h.findCellEx(u)&&f).filter(Boolean)}_explore(u,h){h.mark=!1;const{sheetName:f}=h,m=new d(h.row,h.col,h.row,h.col,f);let p,g;function x(y,b){const j=u.findCellAt(f,y,h.col);return!(!j||!j.mark)&&(m[b]=y,j.mark=!1,!0)}for(g=h.row-1;x(g,"top");g--);for(g=h.row+1;x(g,"bottom");g++);function v(y,b){const j=[];for(g=m.top;g<=m.bottom;g++){const T=u.findCellAt(f,g,y);if(!T||!T.mark)return!1;j.push(T)}m[b]=y;for(let T=0;T<j.length;T++)j[T].mark=!1;return!0}for(p=h.col-1;v(p,"left");p--);for(p=h.col+1;v(p,"right");p++);return m}getRanges(u,h){return(h=h||this.matrixMap[u])?(h.forEach(f=>{f.mark=!0}),{name:u,ranges:h.map(f=>f.mark&&this._explore(h,f)).filter(Boolean).map(f=>f.$shortRange)}):{name:u,ranges:[]}}normaliseMatrix(u,h){u.forEachInSheet(h,(f,m,p)=>{f&&(f.row===m&&f.col===p||(f.row=m,f.col=p,f.address=o.n2l(p)+m))})}spliceRows(u,h,f,m){i.each(this.matrixMap,p=>{p.spliceRows(u,h,f,m),this.normaliseMatrix(p,u)})}spliceColumns(u,h,f,m){i.each(this.matrixMap,p=>{p.spliceColumns(u,h,f,m),this.normaliseMatrix(p,u)})}get model(){return i.map(this.matrixMap,(u,h)=>this.getRanges(h,u)).filter(u=>u.ranges.length)}set model(u){const h=this.matrixMap={};u.forEach(f=>{const m=h[f.name]=new l;f.ranges.forEach(p=>{c.test(p.split("!").pop()||"")&&m.addCell(p)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(r,s,a){s.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(r,s,a){const i=r("../utils/col-cache"),o=r("./anchor");s.exports=class{constructor(l,d){this.worksheet=l,this.model=d}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(l){let{type:d,imageId:c,range:u,hyperlinks:h}=l;if(this.type=d,this.imageId=c,d==="image")if(typeof u=="string"){const f=i.decode(u);this.range={tl:new o(this.worksheet,{col:f.left,row:f.top},-1),br:new o(this.worksheet,{col:f.right,row:f.bottom},0),editAs:"oneCell"}}else this.range={tl:new o(this.worksheet,u.tl,0),br:u.br&&new o(this.worksheet,u.br,0),ext:u.ext,editAs:u.editAs,hyperlinks:h||u.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(r,s,a){const i=r("../utils/under-dash");class o{constructor(d){this.note=d}get model(){let d=null;switch(typeof this.note){case"string":d={type:"note",note:{texts:[{text:this.note}]}};break;default:d={type:"note",note:this.note}}return i.deepMerge({},o.DEFAULT_CONFIGS,d)}set model(d){const{note:c}=d,{texts:u}=c;u.length===1&&Object.keys(u[0]).length===1?this.note=u[0].text:this.note=c}static fromModel(d){const c=new o;return c.model=d,c}}o.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},s.exports=o},{"../utils/under-dash":26}],10:[function(r,s,a){const i=r("../utils/col-cache");class o{constructor(){this.decode(arguments)}setTLBR(d,c,u,h,f){if(arguments.length<4){const m=i.decodeAddress(d),p=i.decodeAddress(c);this.model={top:Math.min(m.row,p.row),left:Math.min(m.col,p.col),bottom:Math.max(m.row,p.row),right:Math.max(m.col,p.col),sheetName:u},this.setTLBR(m.row,m.col,p.row,p.col,f)}else this.model={top:Math.min(d,u),left:Math.min(c,h),bottom:Math.max(d,u),right:Math.max(c,h),sheetName:f}}decode(d){switch(d.length){case 5:this.setTLBR(d[0],d[1],d[2],d[3],d[4]);break;case 4:this.setTLBR(d[0],d[1],d[2],d[3]);break;case 3:this.setTLBR(d[0],d[1],d[2]);break;case 2:this.setTLBR(d[0],d[1]);break;case 1:{const c=d[0];if(c instanceof o)this.model={top:c.model.top,left:c.model.left,bottom:c.model.bottom,right:c.model.right,sheetName:c.sheetName};else if(c instanceof Array)this.decode(c);else if(c.top&&c.left&&c.bottom&&c.right)this.model={top:c.top,left:c.left,bottom:c.bottom,right:c.right,sheetName:c.sheetName};else{const u=i.decodeEx(c);u.top?this.model={top:u.top,left:u.left,bottom:u.bottom,right:u.right,sheetName:u.sheetName}:this.model={top:u.row,left:u.col,bottom:u.row,right:u.col,sheetName:u.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+d.length)}}get top(){return this.model.top||1}set top(d){this.model.top=d}get left(){return this.model.left||1}set left(d){this.model.left=d}get bottom(){return this.model.bottom||1}set bottom(d){this.model.bottom=d}get right(){return this.model.right||1}set right(d){this.model.right=d}get sheetName(){return this.model.sheetName}set sheetName(d){this.model.sheetName=d}get _serialisedSheetName(){const{sheetName:d}=this.model;return d?/^[a-zA-Z0-9]*$/.test(d)?d+"!":`'${d}'!`:""}expand(d,c,u,h){(!this.model.top||d<this.top)&&(this.top=d),(!this.model.left||c<this.left)&&(this.left=c),(!this.model.bottom||u>this.bottom)&&(this.bottom=u),(!this.model.right||h>this.right)&&(this.right=h)}expandRow(d){if(d){const{dimensions:c,number:u}=d;c&&this.expand(u,c.min,u,c.max)}}expandToAddress(d){const c=i.decodeEx(d);this.expand(c.row,c.col,c.row,c.col)}get tl(){return i.n2l(this.left)+this.top}get $t$l(){return`$${i.n2l(this.left)}$${this.top}`}get br(){return i.n2l(this.right)+this.bottom}get $b$r(){return`$${i.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(d){return(!d.sheetName||!this.sheetName||d.sheetName===this.sheetName)&&!(d.bottom<this.top)&&!(d.top>this.bottom)&&!(d.right<this.left)&&!(d.left>this.right)}contains(d){const c=i.decodeEx(d);return this.containsEx(c)}containsEx(d){return(!d.sheetName||!this.sheetName||d.sheetName===this.sheetName)&&d.row>=this.top&&d.row<=this.bottom&&d.col>=this.left&&d.col<=this.right}forEachAddress(d){for(let c=this.left;c<=this.right;c++)for(let u=this.top;u<=this.bottom;u++)d(i.encodeAddress(u,c),u,c)}}s.exports=o},{"../utils/col-cache":19}],11:[function(r,s,a){const i=r("../utils/under-dash"),o=r("./enums"),l=r("../utils/col-cache"),d=r("./cell");s.exports=class{constructor(c,u){this._worksheet=c,this._number=u,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(c){return this._cells[c-1]}getCellEx(c){let u=this._cells[c.col-1];if(!u){const h=this._worksheet.getColumn(c.col);u=new d(this,h,c.address),this._cells[c.col-1]=u}return u}getCell(c){if(typeof c=="string"){const u=this._worksheet.getColumnKey(c);c=u?u.number:l.l2n(c)}return this._cells[c-1]||this.getCellEx({address:l.encodeAddress(this._number,c),row:this._number,col:c})}splice(c,u){const h=c+u;for(var f=arguments.length,m=new Array(f>2?f-2:0),p=2;p<f;p++)m[p-2]=arguments[p];const g=m.length-u,x=this._cells.length;let v,y,b;if(g<0)for(v=c+m.length;v<=x;v++)b=this._cells[v-1],y=this._cells[v-g-1],y?(b=this.getCell(v),b.value=y.value,b.style=y.style,b._comment=y._comment):b&&(b.value=null,b.style={},b._comment=void 0);else if(g>0)for(v=x;v>=h;v--)y=this._cells[v-1],y?(b=this.getCell(v+g),b.value=y.value,b.style=y.style,b._comment=y._comment):this._cells[v+g-1]=void 0;for(v=0;v<m.length;v++)b=this.getCell(c+v),b.value=m[v],b.style={},b._comment=void 0}eachCell(c,u){if(u||(u=c,c=null),c&&c.includeEmpty){const h=this._cells.length;for(let f=1;f<=h;f++)u(this.getCell(f),f)}else this._cells.forEach((h,f)=>{h&&h.type!==o.ValueType.Null&&u(h,f+1)})}addPageBreak(c,u){const h=this._worksheet,f=Math.max(0,c-1)||0,m=Math.max(0,u-1)||16838,p={id:this._number,max:m,man:1};f&&(p.min=f),h.rowBreaks.push(p)}get values(){const c=[];return this._cells.forEach(u=>{u&&u.type!==o.ValueType.Null&&(c[u.col]=u.value)}),c}set values(c){if(this._cells=[],c)if(c instanceof Array){let u=0;c.hasOwnProperty("0")&&(u=1),c.forEach((h,f)=>{h!==void 0&&(this.getCellEx({address:l.encodeAddress(this._number,f+u),row:this._number,col:f+u}).value=h)})}else this._worksheet.eachColumnKey((u,h)=>{c[h]!==void 0&&(this.getCellEx({address:l.encodeAddress(this._number,u.number),row:this._number,col:u.number}).value=c[h])})}get hasValues(){return i.some(this._cells,c=>c&&c.type!==o.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let c=0;return this.eachCell(()=>{c++}),c}get dimensions(){let c=0,u=0;return this._cells.forEach(h=>{h&&h.type!==o.ValueType.Null&&((!c||c>h.col)&&(c=h.col),u<h.col&&(u=h.col))}),c>0?{min:c,max:u}:null}_applyStyle(c,u){return this.style[c]=u,this._cells.forEach(h=>{h&&(h[c]=u)}),u}get numFmt(){return this.style.numFmt}set numFmt(c){this._applyStyle("numFmt",c)}get font(){return this.style.font}set font(c){this._applyStyle("font",c)}get alignment(){return this.style.alignment}set alignment(c){this._applyStyle("alignment",c)}get protection(){return this.style.protection}set protection(c){this._applyStyle("protection",c)}get border(){return this.style.border}set border(c){this._applyStyle("border",c)}get fill(){return this.style.fill}set fill(c){this._applyStyle("fill",c)}get hidden(){return!!this._hidden}set hidden(c){this._hidden=c}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(c){this._outlineLevel=c}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const c=[];let u=0,h=0;return this._cells.forEach(f=>{if(f){const m=f.model;m&&((!u||u>f.col)&&(u=f.col),h<f.col&&(h=f.col),c.push(m))}}),this.height||c.length?{cells:c,number:this.number,min:u,max:h,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(c){if(c.number!==this._number)throw new Error("Invalid row number in model");let u;this._cells=[],c.cells.forEach(h=>{switch(h.type){case d.Types.Merge:break;default:{let f;if(h.address)f=l.decodeAddress(h.address);else if(u){const{row:m}=u,p=u.col+1;f={row:m,col:p,address:l.encodeAddress(m,p),$col$row:`$${l.n2l(p)}$${m}`}}u=f,this.getCellEx(f).model=h;break}}}),c.height?this.height=c.height:delete this.height,this.hidden=c.hidden,this.outlineLevel=c.outlineLevel||0,this.style=c.style&&JSON.parse(JSON.stringify(c.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(r,s,a){const i=r("../utils/col-cache");class o{constructor(d,c,u){this.table=d,this.column=c,this.index=u}_set(d,c){this.table.cacheState(),this.column[d]=c}get name(){return this.column.name}set name(d){this._set("name",d)}get filterButton(){return this.column.filterButton}set filterButton(d){this.column.filterButton=d}get style(){return this.column.style}set style(d){this.column.style=d}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(d){this._set("totalsRowLabel",d)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(d){this._set("totalsRowFunction",d)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(d){this._set("totalsRowResult",d)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(d){this._set("totalsRowFormula",d)}}s.exports=class{constructor(l,d){this.worksheet=l,d&&(this.table=d,this.validate(),this.store())}getFormula(l){switch(l.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${l.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${l.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${l.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${l.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${l.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${l.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${l.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${l.name}])`;case"custom":return l.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+l.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:l}=this,d=(g,x,v)=>{g[x]===void 0&&(g[x]=v)};d(l,"headerRow",!0),d(l,"totalsRow",!1),d(l,"style",{}),d(l.style,"theme","TableStyleMedium2"),d(l.style,"showFirstColumn",!1),d(l.style,"showLastColumn",!1),d(l.style,"showRowStripes",!1),d(l.style,"showColumnStripes",!1);const c=(g,x)=>{if(!g)throw new Error(x)};c(l.ref,"Table must have ref"),c(l.columns,"Table must have column definitions"),c(l.rows,"Table must have row definitions"),l.tl=i.decodeAddress(l.ref);const{row:u,col:h}=l.tl;c(u>0,"Table must be on valid row"),c(h>0,"Table must be on valid col");const{width:f,filterHeight:m,tableHeight:p}=this;l.autoFilterRef=i.encode(u,h,u+m-1,h+f-1),l.tableRef=i.encode(u,h,u+p-1,h+f-1),l.columns.forEach((g,x)=>{c(g.name,`Column ${x} must have a name`),x===0?d(g,"totalsRowLabel","Total"):(d(g,"totalsRowFunction","none"),g.totalsRowFormula=this.getFormula(g))})}store(){const l=(m,p)=>{p&&Object.keys(p).forEach(g=>{m[g]=p[g]})},{worksheet:d,table:c}=this,{row:u,col:h}=c.tl;let f=0;if(c.headerRow){const m=d.getRow(u+f++);c.columns.forEach((p,g)=>{const{style:x,name:v}=p,y=m.getCell(h+g);y.value=v,l(y,x)})}if(c.rows.forEach(m=>{const p=d.getRow(u+f++);m.forEach((g,x)=>{const v=p.getCell(h+x);v.value=g,l(v,c.columns[x].style)})}),c.totalsRow){const m=d.getRow(u+f++);c.columns.forEach((p,g)=>{const x=m.getCell(h+g);if(g===0)x.value=p.totalsRowLabel;else{const v=this.getFormula(p);x.value=v?{formula:p.totalsRowFormula,result:p.totalsRowResult}:null}l(x,p.style)})}}load(l){const{table:d}=this,{row:c,col:u}=d.tl;let h=0;if(d.headerRow){const f=l.getRow(c+h++);d.columns.forEach((m,p)=>{f.getCell(u+p).value=m.name})}if(d.rows.forEach(f=>{const m=l.getRow(c+h++);f.forEach((p,g)=>{m.getCell(u+g).value=p})}),d.totalsRow){const f=l.getRow(c+h++);d.columns.forEach((m,p)=>{const g=f.getCell(u+p);p===0?g.value=m.totalsRowLabel:this.getFormula(m)&&(g.value={formula:m.totalsRowFormula,result:m.totalsRowResult})})}}get model(){return this.table}set model(l){this.table=l}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const l=i.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let d=0;d<this._cache.tableHeight;d++){const c=this.worksheet.getRow(l.row+d);for(let u=0;u<this._cache.width;u++)c.getCell(l.col+u).value=null}else{for(let d=this.tableHeight;d<this._cache.tableHeight;d++){const c=this.worksheet.getRow(l.row+d);for(let u=0;u<this._cache.width;u++)c.getCell(l.col+u).value=null}for(let d=0;d<this.tableHeight;d++){const c=this.worksheet.getRow(l.row+d);for(let u=this.width;u<this._cache.width;u++)c.getCell(l.col+u).value=null}}this.store()}addRow(l,d){this.cacheState(),d===void 0?this.table.rows.push(l):this.table.rows.splice(d,0,l)}removeRows(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(l,d)}getColumn(l){const d=this.table.columns[l];return new o(this,d,l)}addColumn(l,d,c){this.cacheState(),c===void 0?(this.table.columns.push(l),this.table.rows.forEach((u,h)=>{u.push(d[h])})):(this.table.columns.splice(c,0,l),this.table.rows.forEach((u,h)=>{u.splice(c,0,d[h])}))}removeColumns(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(l,d),this.table.rows.forEach(c=>{c.splice(l,d)})}_assign(l,d,c){this.cacheState(),l[d]=c}get ref(){return this.table.ref}set ref(l){this._assign(this.table,"ref",l)}get name(){return this.table.name}set name(l){this.table.name=l}get displayName(){return this.table.displyName||this.table.name}set displayNamename(l){this.table.displayName=l}get headerRow(){return this.table.headerRow}set headerRow(l){this._assign(this.table,"headerRow",l)}get totalsRow(){return this.table.totalsRow}set totalsRow(l){this._assign(this.table,"totalsRow",l)}get theme(){return this.table.style.name}set theme(l){this.table.style.name=l}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(l){this.table.style.showFirstColumn=l}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(l){this.table.style.showLastColumn=l}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(l){this.table.style.showRowStripes=l}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(l){this.table.style.showColumnStripes=l}}},{"../utils/col-cache":19}],13:[function(r,s,a){const i=r("./worksheet"),o=r("./defined-names"),l=r("../xlsx/xlsx"),d=r("../csv/csv");s.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new o}get xlsx(){return this._xlsx||(this._xlsx=new l(this)),this._xlsx}get csv(){return this._csv||(this._csv=new d(this)),this._csv}get nextId(){for(let c=1;c<this._worksheets.length;c++)if(!this._worksheets[c])return c;return this._worksheets.length||1}addWorksheet(c,u){const h=this.nextId;u&&(typeof u=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),u={properties:{tabColor:{argb:u}}}):(u.argb||u.theme||u.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),u={properties:{tabColor:u}}));const f=this._worksheets.reduce((g,x)=>(x&&x.orderNo)>g?x.orderNo:g,0),m=Object.assign({},u,{id:h,name:c,orderNo:f+1,workbook:this}),p=new i(m);return this._worksheets[h]=p,p}removeWorksheetEx(c){delete this._worksheets[c.id]}removeWorksheet(c){const u=this.getWorksheet(c);u&&u.destroy()}getWorksheet(c){return c===void 0?this._worksheets.find(Boolean):typeof c=="number"?this._worksheets[c]:typeof c=="string"?this._worksheets.find(u=>u&&u.name===c):void 0}get worksheets(){return this._worksheets.slice(1).sort((c,u)=>c.orderNo-u.orderNo).filter(Boolean)}eachSheet(c){this.worksheets.forEach(u=>{c(u,u.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(c){const u=this.media.length;return this.media.push(Object.assign({},c,{type:"image"})),u}getImage(c){return this.media[c]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(c=>c.model),sheets:this.worksheets.map(c=>c.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(c){this.creator=c.creator,this.lastModifiedBy=c.lastModifiedBy,this.lastPrinted=c.lastPrinted,this.created=c.created,this.modified=c.modified,this.company=c.company,this.manager=c.manager,this.title=c.title,this.subject=c.subject,this.keywords=c.keywords,this.category=c.category,this.description=c.description,this.language=c.language,this.revision=c.revision,this.contentStatus=c.contentStatus,this.properties=c.properties,this.calcProperties=c.calcProperties,this._worksheets=[],c.worksheets.forEach(u=>{const{id:h,name:f,state:m}=u,p=c.sheets&&c.sheets.findIndex(g=>g.id===h);(this._worksheets[h]=new i({id:h,name:f,orderNo:p,state:m,workbook:this})).model=u}),this._definedNames.model=c.definedNames,this.views=c.views,this._themes=c.themes,this.media=c.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(r,s,a){const i=r("../utils/under-dash"),o=r("../utils/col-cache"),l=r("./range"),d=r("./row"),c=r("./column"),u=r("./enums"),h=r("./image"),f=r("./table"),m=r("./data-validations"),p=r("../utils/encryptor"),{copyStyle:g}=r("../utils/copy-style");s.exports=class{constructor(x){x=x||{},this._workbook=x.workbook,this.id=x.id,this.orderNo=x.orderNo,this.name=x.name,this.state=x.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},x.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!x.pageSetup||!x.pageSetup.fitToWidth&&!x.pageSetup.fitToHeight||x.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},x.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},x.headerFooter),this.dataValidations=new m,this.views=x.views||[],this.autoFilter=x.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(x){if(x===void 0&&(x="sheet"+this.id),this._name!==x){if(typeof x!="string")throw new Error("The name has to be a string.");if(x==="")throw new Error("The name can't be empty.");if(x==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(x))throw new Error(`Worksheet name ${x} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(x))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+x);if(x&&x.length>31&&(console.warn(`Worksheet name ${x} exceeds 31 chars. This will be truncated`),x=x.substring(0,31)),this._workbook._worksheets.find(v=>v&&v.name.toLowerCase()===x.toLowerCase()))throw new Error("Worksheet name already exists: "+x);this._name=x}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const x=new l;return this._rows.forEach(v=>{if(v){const y=v.dimensions;y&&x.expand(v.number,y.min,v.number,y.max)}}),x}get columns(){return this._columns}set columns(x){this._headerRowCount=x.reduce((b,j)=>{const T=(j.header?1:j.headers&&j.headers.length)||0;return Math.max(b,T)},0);let v=1;const y=this._columns=[];x.forEach(b=>{const j=new c(this,v++,!1);y.push(j),j.defn=b})}getColumnKey(x){return this._keys[x]}setColumnKey(x,v){this._keys[x]=v}deleteColumnKey(x){delete this._keys[x]}eachColumnKey(x){i.each(this._keys,x)}getColumn(x){if(typeof x=="string"){const v=this._keys[x];if(v)return v;x=o.l2n(x)}if(this._columns||(this._columns=[]),x>this._columns.length){let v=this._columns.length+1;for(;v<=x;)this._columns.push(new c(this,v++))}return this._columns[x-1]}spliceColumns(x,v){const y=this._rows.length;for(var b=arguments.length,j=new Array(b>2?b-2:0),T=2;T<b;T++)j[T-2]=arguments[T];if(j.length>0)for(let B=0;B<y;B++){const q=[x,v];j.forEach(G=>{q.push(G[B]||null)});const Y=this.getRow(B+1);Y.splice.apply(Y,q)}else this._rows.forEach(B=>{B&&B.splice(x,v)});const O=j.length-v,R=x+v,D=this._columns.length;if(O<0)for(let B=x+j.length;B<=D;B++)this.getColumn(B).defn=this.getColumn(B-O).defn;else if(O>0)for(let B=D;B>=R;B--)this.getColumn(B+O).defn=this.getColumn(B).defn;for(let B=x;B<x+j.length;B++)this.getColumn(B).defn=null;this.workbook.definedNames.spliceColumns(this.name,x,v,j.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let x=0;return this.eachRow(v=>{x=Math.max(x,v.cellCount)}),x}get actualColumnCount(){const x=[];let v=0;return this.eachRow(y=>{y.eachCell(b=>{let{col:j}=b;x[j]||(x[j]=!0,v++)})}),v}_commitRow(){}get _lastRowNumber(){const x=this._rows;let v=x.length;for(;v>0&&x[v-1]===void 0;)v--;return v}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(x){return this._rows[x-1]}findRows(x,v){return this._rows.slice(x-1,x-1+v)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let x=0;return this.eachRow(()=>{x++}),x}getRow(x){let v=this._rows[x-1];return v||(v=this._rows[x-1]=new d(this,x)),v}getRows(x,v){if(v<1)return;const y=[];for(let b=x;b<x+v;b++)y.push(this.getRow(b));return y}addRow(x){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=this._nextRow,b=this.getRow(y);return b.values=x,this._setStyleOption(y,v[0]==="i"?v:"n"),b}addRows(x){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=[];return x.forEach(b=>{y.push(this.addRow(b,v))}),y}insertRow(x,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(x,0,v),this._setStyleOption(x,y),this.getRow(x)}insertRows(x,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(x,0,...v),y!=="n")for(let b=0;b<v.length;b++)y[0]==="o"&&this.findRow(v.length+x+b)!==void 0?this._copyStyle(v.length+x+b,x+b,y[1]==="+"):y[0]==="i"&&this.findRow(x-1)!==void 0&&this._copyStyle(x-1,x+b,y[1]==="+");return this.getRows(x,v.length)}_setStyleOption(x){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";v[0]==="o"&&this.findRow(x+1)!==void 0?this._copyStyle(x+1,x,v[1]==="+"):v[0]==="i"&&this.findRow(x-1)!==void 0&&this._copyStyle(x-1,x,v[1]==="+")}_copyStyle(x,v){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const b=this.getRow(x),j=this.getRow(v);j.style=g(b.style),b.eachCell({includeEmpty:y},(T,O)=>{j.getCell(O).style=g(T.style)}),j.height=b.height}duplicateRow(x,v){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const b=this._rows[x-1],j=new Array(v).fill(b.values);this.spliceRows(x+1,y?0:v,...j);for(let T=0;T<v;T++){const O=this._rows[x+T];O.style=b.style,O.height=b.height,b.eachCell({includeEmpty:!0},(R,D)=>{O.getCell(D).style=R.style})}}spliceRows(x,v){const y=x+v;for(var b=arguments.length,j=new Array(b>2?b-2:0),T=2;T<b;T++)j[T-2]=arguments[T];const O=j.length,R=O-v,D=this._rows.length;let B,q;if(R<0)for(x===D&&(this._rows[D-1]=void 0),B=y;B<=D;B++)if(q=this._rows[B-1],q){const Y=this.getRow(B+R);Y.values=q.values,Y.style=q.style,Y.height=q.height,q.eachCell({includeEmpty:!0},(G,I)=>{Y.getCell(I).style=G.style}),this._rows[B-1]=void 0}else this._rows[B+R-1]=void 0;else if(R>0)for(B=D;B>=y;B--)if(q=this._rows[B-1],q){const Y=this.getRow(B+R);Y.values=q.values,Y.style=q.style,Y.height=q.height,q.eachCell({includeEmpty:!0},(G,I)=>{if(Y.getCell(I).style=G.style,G._value.constructor.name==="MergeValue"){const F=this.getRow(G._row._number+O).getCell(I),S=G._value._master,E=this.getRow(S._row._number+O).getCell(S._column._number);F.merge(E)}})}else this._rows[B+R-1]=void 0;for(B=0;B<O;B++){const Y=this.getRow(x+B);Y.style={},Y.values=j[B]}this.workbook.definedNames.spliceRows(this.name,x,v,O)}eachRow(x,v){if(v||(v=x,x=void 0),x&&x.includeEmpty){const y=this._rows.length;for(let b=1;b<=y;b++)v(this.getRow(b),b)}else this._rows.forEach(y=>{y&&y.hasValues&&v(y,y.number)})}getSheetValues(){const x=[];return this._rows.forEach(v=>{v&&(x[v.number]=v.values)}),x}findCell(x,v){const y=o.getAddress(x,v),b=this._rows[y.row-1];return b?b.findCell(y.col):void 0}getCell(x,v){const y=o.getAddress(x,v);return this.getRow(y.row).getCellEx(y)}mergeCells(){for(var x=arguments.length,v=new Array(x),y=0;y<x;y++)v[y]=arguments[y];const b=new l(v);this._mergeCellsInternal(b)}mergeCellsWithoutStyle(){for(var x=arguments.length,v=new Array(x),y=0;y<x;y++)v[y]=arguments[y];const b=new l(v);this._mergeCellsInternal(b,!0)}_mergeCellsInternal(x,v){i.each(this._merges,b=>{if(b.intersects(x))throw new Error("Cannot merge already merged cells")});const y=this.getCell(x.top,x.left);for(let b=x.top;b<=x.bottom;b++)for(let j=x.left;j<=x.right;j++)(b>x.top||j>x.left)&&this.getCell(b,j).merge(y,v);this._merges[y.address]=x}_unMergeMaster(x){const v=this._merges[x.address];if(v){for(let y=v.top;y<=v.bottom;y++)for(let b=v.left;b<=v.right;b++)this.getCell(y,b).unmerge();delete this._merges[x.address]}}get hasMerges(){return i.some(this._merges,Boolean)}unMergeCells(){for(var x=arguments.length,v=new Array(x),y=0;y<x;y++)v[y]=arguments[y];const b=new l(v);for(let j=b.top;j<=b.bottom;j++)for(let T=b.left;T<=b.right;T++){const O=this.findCell(j,T);O&&(O.type===u.ValueType.Merge?this._unMergeMaster(O.master):this._merges[O.address]&&this._unMergeMaster(O))}}fillFormula(x,v,y){let b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const j=o.decode(x),{top:T,left:O,bottom:R,right:D}=j,B=D-O+1,q=o.encodeAddress(T,O),Y=b==="shared";let G;G=typeof y=="function"?y:Array.isArray(y)?Array.isArray(y[0])?(F,S)=>y[F-T][S-O]:(F,S)=>y[(F-T)*B+(S-O)]:()=>{};let I=!0;for(let F=T;F<=R;F++)for(let S=O;S<=D;S++)I?(this.getCell(F,S).value={shareType:b,formula:v,ref:x,result:G(F,S)},I=!1):this.getCell(F,S).value=Y?{sharedFormula:q,result:G(F,S)}:G(F,S)}addImage(x,v){const y={type:"image",imageId:x,range:v};this._media.push(new h(this,y))}getImages(){return this._media.filter(x=>x.type==="image")}addBackgroundImage(x){const v={type:"background",imageId:x};this._media.push(new h(this,v))}getBackgroundImageId(){const x=this._media.find(v=>v.type==="background");return x&&x.imageId}protect(x,v){return new Promise(y=>{this.sheetProtection={sheet:!0},v&&"spinCount"in v&&(v.spinCount=Number.isFinite(v.spinCount)?Math.round(Math.max(0,v.spinCount)):1e5),x&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=p.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=v&&"spinCount"in v?v.spinCount:1e5,this.sheetProtection.hashValue=p.convertPasswordToHash(x,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),v&&(this.sheetProtection=Object.assign(this.sheetProtection,v),!x&&"spinCount"in v&&delete this.sheetProtection.spinCount),y()})}unprotect(){this.sheetProtection=null}addTable(x){const v=new f(this,x);return this.tables[x.name]=v,v}getTable(x){return this.tables[x]}removeTable(x){delete this.tables[x]}getTables(){return Object.values(this.tables)}addConditionalFormatting(x){this.conditionalFormattings.push(x)}removeConditionalFormatting(x){typeof x=="number"?this.conditionalFormattings.splice(x,1):this.conditionalFormattings=x instanceof Function?this.conditionalFormattings.filter(x):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(x){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=x}get model(){const x={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(b=>b.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(b=>b.model),conditionalFormattings:this.conditionalFormattings};x.cols=c.toModel(this.columns);const v=x.rows=[],y=x.dimensions=new l;return this._rows.forEach(b=>{const j=b&&b.model;j&&(y.expand(j.number,j.min,j.number,j.max),v.push(j))}),x.merges=[],i.each(this._merges,b=>{x.merges.push(b.range)}),x}_parseRows(x){this._rows=[],x.rows.forEach(v=>{const y=new d(this,v.number);this._rows[y.number-1]=y,y.model=v})}_parseMergeCells(x){i.each(x.mergeCells,v=>{this.mergeCellsWithoutStyle(v)})}set model(x){this.name=x.name,this._columns=c.fromModel(this,x.cols),this._parseRows(x),this._parseMergeCells(x),this.dataValidations=new m(x.dataValidations),this.properties=x.properties,this.pageSetup=x.pageSetup,this.headerFooter=x.headerFooter,this.views=x.views,this.autoFilter=x.autoFilter,this._media=x.media.map(v=>new h(this,v)),this.sheetProtection=x.sheetProtection,this.tables=x.tables.reduce((v,y)=>{const b=new f;return b.model=y,v[y.name]=b,v},{}),this.conditionalFormattings=x.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(r,s,a){r("core-js/modules/es.promise"),r("core-js/modules/es.promise.finally"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.values"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.async-iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.find-index"),r("core-js/modules/es.array.find"),r("core-js/modules/es.string.from-code-point"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.number.is-nan"),r("regenerator-runtime/runtime");const i={Workbook:r("./doc/workbook")},o=r("./doc/enums");Object.keys(o).forEach(l=>{i[l]=o[l]}),s.exports=i},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(r,s,a){const i=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");a.bufferToString=function(o){return typeof o=="string"?o:i?i.decode(o):o.toString()}},{}],17:[function(r,s,a){const i=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:o}=r("buffer");a.stringToBuffer=function(l){return typeof l!="string"?l:i?o.from(i.encode(l).buffer):o.from(l)}},{buffer:220}],18:[function(r,s,a){const i=r("./under-dash"),o=r("./col-cache");s.exports=class{constructor(l){this.template=l,this.sheets={}}addCell(l){this.addCellEx(o.decodeEx(l))}getCell(l){return this.findCellEx(o.decodeEx(l),!0)}findCell(l){return this.findCellEx(o.decodeEx(l),!1)}findCellAt(l,d,c){const u=this.sheets[l],h=u&&u[d];return h&&h[c]}addCellEx(l){if(l.top)for(let d=l.top;d<=l.bottom;d++)for(let c=l.left;c<=l.right;c++)this.getCellAt(l.sheetName,d,c);else this.findCellEx(l,!0)}getCellEx(l){return this.findCellEx(l,!0)}findCellEx(l,d){const c=this.findSheet(l,d),u=this.findSheetRow(c,l,d);return this.findRowCell(u,l,d)}getCellAt(l,d,c){const u=this.sheets[l]||(this.sheets[l]=[]),h=u[d]||(u[d]=[]);return h[c]||(h[c]={sheetName:l,address:o.n2l(c)+d,row:d,col:c})}removeCellEx(l){const d=this.findSheet(l);if(!d)return;const c=this.findSheetRow(d,l);c&&delete c[l.col]}forEachInSheet(l,d){const c=this.sheets[l];c&&c.forEach((u,h)=>{u&&u.forEach((f,m)=>{f&&d(f,h,m)})})}forEach(l){i.each(this.sheets,(d,c)=>{this.forEachInSheet(c,l)})}map(l){const d=[];return this.forEach(c=>{d.push(l(c))}),d}findSheet(l,d){const c=l.sheetName;return this.sheets[c]?this.sheets[c]:d?this.sheets[c]=[]:void 0}findSheetRow(l,d,c){const{row:u}=d;return l&&l[u]?l[u]:c?l[u]=[]:void 0}findRowCell(l,d,c){const{col:u}=d;return l&&l[u]?l[u]:c?l[u]=this.template?Object.assign(d,JSON.parse(JSON.stringify(this.template))):d:void 0}spliceRows(l,d,c,u){const h=this.sheets[l];if(h){const f=[];for(let m=0;m<u;m++)f.push([]);h.splice(d,c,...f)}}spliceColumns(l,d,c,u){const h=this.sheets[l];if(h){const f=[];for(let m=0;m<u;m++)f.push(null);i.each(h,m=>{m.splice(d,c,...f)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(r,s,a){const i=/^[A-Z]+\d+$/,o={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:l=>l<=26?1:l<=676?2:3,_fill(l){let d,c,u,h,f,m=1;if(l>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&l>=1){for(;m<=26;)d=this._dictionary[m-1],this._n2l[m]=d,this._l2n[d]=m,m++;this._l2nFill=1}if(this._l2nFill<2&&l>=2){for(m=27;m<=702;)c=m-27,u=c%26,h=Math.floor(c/26),d=this._dictionary[h]+this._dictionary[u],this._n2l[m]=d,this._l2n[d]=m,m++;this._l2nFill=2}if(this._l2nFill<3&&l>=3){for(m=703;m<=16384;)c=m-703,u=c%26,h=Math.floor(c/26)%26,f=Math.floor(c/676),d=this._dictionary[f]+this._dictionary[h]+this._dictionary[u],this._n2l[m]=d,this._l2n[d]=m,m++;this._l2nFill=3}},l2n(l){if(this._l2n[l]||this._fill(l.length),!this._l2n[l])throw new Error("Out of bounds. Invalid column letter: "+l);return this._l2n[l]},n2l(l){if(l<1||l>16384)throw new Error(l+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[l]||this._fill(this._level(l)),this._n2l[l]},_hash:{},validateAddress(l){if(!i.test(l))throw new Error("Invalid Address: "+l);return!0},decodeAddress(l){const d=l.length<5&&this._hash[l];if(d)return d;let c=!1,u="",h=0,f=!1,m="",p=0;for(let x,v=0;v<l.length;v++)if(x=l.charCodeAt(v),!f&&x>=65&&x<=90)c=!0,u+=l[v],h=26*h+x-64;else if(x>=48&&x<=57)f=!0,m+=l[v],p=10*p+x-48;else if(f&&c&&x!==36)break;if(c){if(h>16384)throw new Error("Out of bounds. Invalid column letter: "+u)}else h=void 0;f||(p=void 0);const g={address:l=u+m,col:h,row:p,$col$row:`$${u}$${m}`};return h<=100&&p<=100&&(this._hash[l]=g,this._hash[g.$col$row]=g),g},getAddress(l,d){if(d){const c=this.n2l(d)+l;return this.decodeAddress(c)}return this.decodeAddress(l)},decode(l){const d=l.split(":");if(d.length===2){const c=this.decodeAddress(d[0]),u=this.decodeAddress(d[1]),h={top:Math.min(c.row,u.row),left:Math.min(c.col,u.col),bottom:Math.max(c.row,u.row),right:Math.max(c.col,u.col)};return h.tl=this.n2l(h.left)+h.top,h.br=this.n2l(h.right)+h.bottom,h.dimensions=`${h.tl}:${h.br}`,h}return this.decodeAddress(l)},decodeEx(l){const d=l.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),c=d[1]||d[2],u=d[3],h=u.split(":");if(h.length>1){let m=this.decodeAddress(h[0]),p=this.decodeAddress(h[1]);const g=Math.min(m.row,p.row),x=Math.min(m.col,p.col),v=Math.max(m.row,p.row),y=Math.max(m.col,p.col);return m=this.n2l(x)+g,p=this.n2l(y)+v,{top:g,left:x,bottom:v,right:y,sheetName:c,tl:{address:m,col:x,row:g,$col$row:`$${this.n2l(x)}$${g}`,sheetName:c},br:{address:p,col:y,row:v,$col$row:`$${this.n2l(y)}$${v}`,sheetName:c},dimensions:`${m}:${p}`}}if(u.startsWith("#"))return c?{sheetName:c,error:u}:{error:u};const f=this.decodeAddress(u);return c?{sheetName:c,...f}:f},encodeAddress:(l,d)=>o.n2l(d)+l,encode(){switch(arguments.length){case 2:return o.encodeAddress(arguments[0],arguments[1]);case 4:return`${o.encodeAddress(arguments[0],arguments[1])}:${o.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(l,d){const[c,u,,h,f]=l,[m,p]=d;return m>=c&&m<=h&&p>=u&&p<=f}};s.exports=o},{}],20:[function(r,s,a){const i=(l,d)=>({...l,...d.reduce((c,u)=>(l[u]&&(c[u]={...l[u]}),c),{})}),o=function(l,d,c){let u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];l[c]&&(d[c]=i(l[c],u))};a.copyStyle=l=>{if(!l)return l;if(d=l,Object.keys(d).length===0)return{};var d;const c={...l};return o(l,c,"font",["color"]),o(l,c,"alignment"),o(l,c,"protection"),l.border&&(o(l,c,"border"),o(l.border,c.border,"top",["color"]),o(l.border,c.border,"left",["color"]),o(l.border,c.border,"bottom",["color"]),o(l.border,c.border,"right",["color"]),o(l.border,c.border,"diagonal",["color"])),l.fill&&(o(l,c,"fill",["fgColor","bgColor","center"]),l.fill.stops&&(c.fill.stops=l.fill.stops.map(u=>i(u,["color"])))),c}},{}],21:[function(r,s,a){(function(i){(function(){const o=r("crypto"),l={hash(d){const c=o.createHash(d);for(var u=arguments.length,h=new Array(u>1?u-1:0),f=1;f<u;f++)h[f-1]=arguments[f];return c.update(i.concat(h)),c.digest()},convertPasswordToHash(d,c,u,h){if(c=c.toLowerCase(),o.getHashes().indexOf(c)<0)throw new Error(`Hash algorithm '${c}' not supported!`);const f=i.from(d,"utf16le");let m=this.hash(c,i.from(u,"base64"),f);for(let p=0;p<h;p++){const g=i.alloc(4);g.writeUInt32LE(p,0),m=this.hash(c,m,g)}return m.toString("base64")},randomBytes:d=>o.randomBytes(d)};s.exports=l}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(r,s,a){const{SaxesParser:i}=r("saxes"),{PassThrough:o}=r("readable-stream"),{bufferToString:l}=r("./browser-buffer-decode");s.exports=async function*(d){d.pipe&&!d[Symbol.asyncIterator]&&(d=d.pipe(new o));const c=new i;let u;c.on("error",f=>{u=f});let h=[];c.on("opentag",f=>h.push({eventType:"opentag",value:f})),c.on("text",f=>h.push({eventType:"text",value:f})),c.on("closetag",f=>h.push({eventType:"closetag",value:f}));for await(const f of d){if(c.write(l(f)),u)throw u;yield h,h=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(r,s,a){const i=r("./col-cache"),o=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,l=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;s.exports={slideFormula:function(d,c,u){const h=i.decode(c),f=i.decode(u);return d.replace(o,(m,p,g,x,v)=>{if(v)return m;const y=l.exec(x);if(y){const b=y[1],j=y[2].toUpperCase(),T=y[3],O=y[4];if(j.length>3||j.length===3&&j>"XFD")return m;let R=i.l2n(j),D=parseInt(O,10);return b||(R+=f.col-h.col),T||(D+=f.row-h.row),(p||"")+(b||"")+i.n2l(R)+(T||"")+D}return m})}}},{"./col-cache":19}],24:[function(r,s,a){(function(i,o){(function(){const l=r("readable-stream"),d=r("./utils"),c=r("./string-buf");class u{constructor(x,v){this._data=x,this._encoding=v}get length(){return this.toBuffer().length}copy(x,v,y,b){return this.toBuffer().copy(x,v,y,b)}toBuffer(){return this._buffer||(this._buffer=o.from(this._data,this._encoding)),this._buffer}}class h{constructor(x){this._data=x}get length(){return this._data.length}copy(x,v,y,b){return this._data._buf.copy(x,v,y,b)}toBuffer(){return this._data.toBuffer()}}class f{constructor(x){this._data=x}get length(){return this._data.length}copy(x,v,y,b){this._data.copy(x,v,y,b)}toBuffer(){return this._data}}class m{constructor(x){this.size=x,this.buffer=o.alloc(x),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const x=o.alloc(this.iWrite-this.iRead);return this.buffer.copy(x,0,this.iRead,this.iWrite),x}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(x){let v;return x===0?null:x===void 0||x>=this.length?(v=this.toBuffer(),this.iRead=this.iWrite,v):(v=o.alloc(x),this.buffer.copy(v,0,this.iRead,x),this.iRead+=x,v)}write(x,v,y){const b=Math.min(y,this.size-this.iWrite);return x.copy(this.buffer,this.iWrite,v,v+b),this.iWrite+=b,b}}const p=function(g){g=g||{},this.bufSize=g.bufSize||1048576,this.buffers=[],this.batch=g.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};d.inherits(p,l.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return o.concat(this.buffers.map(g=>g.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const x=this.buffers[this.buffers.length-1];if(!x.full)return x}const g=new m(this.bufSize);return this.buffers.push(g),g},async _pipe(g){await Promise.all(this.pipes.map(function(x){return new Promise(v=>{x.write(g.toBuffer(),()=>{v()})})}))},_writeToBuffers(g){let x=0;const v=g.length;for(;x<v;)x+=this._getWritableBuffer().write(g,x,v-x)},async write(g,x,v){let y;if(x instanceof Function&&(v=x,x="utf8"),v=v||d.nop,g instanceof c)y=new h(g);else if(g instanceof o)y=new f(g);else{if(!(typeof g=="string"||g instanceof String||g instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");y=new u(g,x)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(y);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(y),i.nextTick(v)):(await this._pipe(y),v());else this.paused||this.emit("data",y.toBuffer()),this._writeToBuffers(y),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(g,x,v){const y=b=>{b?v(b):(this._flush(),this.pipes.forEach(j=>{j.end()}),this.emit("finish"))};g?this.write(g,x,y):y()},read(g){let x;if(g){for(x=[];g&&this.buffers.length&&!this.buffers[0].eod;){const v=this.buffers[0],y=v.read(g);g-=y.length,x.push(y),v.eod&&v.full&&this.buffers.shift()}return o.concat(x)}return x=this.buffers.map(v=>v.toBuffer()).filter(Boolean),this.buffers=[],o.concat(x)},setEncoding(g){this.encoding=g},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(g){this.pipes.push(g),!this.paused&&this.buffers.length&&this.end()},unpipe(g){this.pipes=this.pipes.filter(x=>x!==g)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),s.exports=p}).call(this)}).call(this,r("_process"),r("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(r,s,a){(function(i){(function(){s.exports=class{constructor(o){this._buf=i.alloc(o&&o.size||16384),this._encoding=o&&o.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=i.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(o){o=o||0,this._buffer=void 0,this._inPos=o}_grow(o){let l=2*this._buf.length;for(;l<o;)l*=2;const d=i.alloc(l);this._buf.copy(d,0),this._buf=d}addText(o){this._buffer=void 0;let l=this._inPos+this._buf.write(o,this._inPos,this._encoding);for(;l>=this._buf.length-4;)this._grow(this._inPos+o.length),l=this._inPos+this._buf.write(o,this._inPos,this._encoding);this._inPos=l}addStringBuf(o){o.length&&(this._buffer=void 0,this.length+o.length>this.capacity&&this._grow(this.length+o.length),o._buf.copy(this._buf,this._inPos,0,o.length),this._inPos+=o.length)}}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220}],26:[function(r,s,a){const{toString:i}=Object.prototype,o=/["&<>]/,l={each:function(d,c){d&&(Array.isArray(d)?d.forEach(c):Object.keys(d).forEach(u=>{c(d[u],u)}))},some:function(d,c){return!!d&&(Array.isArray(d)?d.some(c):Object.keys(d).some(u=>c(d[u],u)))},every:function(d,c){return!d||(Array.isArray(d)?d.every(c):Object.keys(d).every(u=>c(d[u],u)))},map:function(d,c){return d?Array.isArray(d)?d.map(c):Object.keys(d).map(u=>c(d[u],u)):[]},keyBy:(d,c)=>d.reduce((u,h)=>(u[h[c]]=h,u),{}),isEqual:function(d,c){const u=typeof d,h=typeof c,f=Array.isArray(d),m=Array.isArray(c);let p;if(u!==h)return!1;switch(typeof d){case"object":if(f||m)return!(!f||!m)&&d.length===c.length&&d.every((g,x)=>{const v=c[x];return l.isEqual(g,v)});if(d===null||c===null)return d===c;if(p=Object.keys(d),Object.keys(c).length!==p.length)return!1;for(const g of p)if(!c.hasOwnProperty(g))return!1;return l.every(d,(g,x)=>{const v=c[x];return l.isEqual(g,v)});default:return d===c}},escapeHtml(d){const c=o.exec(d);if(!c)return d;let u="",h="",f=0,m=c.index;for(;m<d.length;m++){switch(d.charAt(m)){case'"':h="&quot;";break;case"&":h="&amp;";break;case"'":h="&apos;";break;case"<":h="&lt;";break;case">":h="&gt;";break;default:continue}f!==m&&(u+=d.substring(f,m)),f=m+1,u+=h}return f!==m?u+d.substring(f,m):u},strcmp:(d,c)=>d<c?-1:d>c?1:0,isUndefined:d=>i.call(d)==="[object Undefined]",isObject:d=>i.call(d)==="[object Object]",deepMerge(){const d=arguments[0]||{},{length:c}=arguments;let u,h,f;function m(p,g){u=d[g],f=Array.isArray(p),l.isObject(p)||f?(f?(f=!1,h=u&&Array.isArray(u)?u:[]):h=u&&l.isObject(u)?u:{},d[g]=l.deepMerge(h,p)):l.isUndefined(p)||(d[g]=p)}for(let p=0;p<c;p++)l.each(arguments[p],m);return d}};s.exports=l},{}],27:[function(r,s,a){(function(i,o){(function(){const l=r("fs"),d=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,c={nop(){},promiseImmediate:u=>new Promise(h=>{i.setImmediate?o(()=>{h(u)}):setTimeout(()=>{h(u)},1)}),inherits:function(u,h,f,m){u.super_=h,m||(m=f,f=null),f&&Object.keys(f).forEach(g=>{Object.defineProperty(u,g,Object.getOwnPropertyDescriptor(f,g))});const p={constructor:{value:u,enumerable:!1,writable:!1,configurable:!0}};m&&Object.keys(m).forEach(g=>{p[g]=Object.getOwnPropertyDescriptor(m,g)}),u.prototype=Object.create(h.prototype,p)},dateToExcel:(u,h)=>25569+u.getTime()/864e5-(h?1462:0),excelToDate(u,h){const f=Math.round(24*(u-25569+(h?1462:0))*3600*1e3);return new Date(f)},parsePath(u){const h=u.lastIndexOf("/");return{path:u.substring(0,h),name:u.substring(h+1)}},getRelsPath(u){const h=c.parsePath(u);return`${h.path}/_rels/${h.name}.rels`},xmlEncode(u){const h=d.exec(u);if(!h)return u;let f="",m="",p=0,g=h.index;for(;g<u.length;g++){const x=u.charCodeAt(g);switch(x){case 34:m="&quot;";break;case 38:m="&amp;";break;case 39:m="&apos;";break;case 60:m="&lt;";break;case 62:m="&gt;";break;case 127:m="";break;default:if(x<=31&&(x<=8||x>=11&&x!==13)){m="";break}continue}p!==g&&(f+=u.substring(p,g)),p=g+1,m&&(f+=m)}return p!==g?f+u.substring(p,g):f},xmlDecode:u=>u.replace(/&([a-z]*);/g,h=>{switch(h){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return h}}),validInt(u){const h=parseInt(u,10);return Number.isNaN(h)?0:h},isDateFmt(u){return u?(u=(u=u.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:u=>new Promise(h=>{l.access(u,l.constants.F_OK,f=>{h(!f)})})},toIsoDateString:u=>u.toIsoString().subsstr(0,10),parseBoolean:u=>u===!0||u==="true"||u===1||u==="1"};s.exports=c}).call(this)}).call(this,typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{},r("timers").setImmediate)},{fs:216,timers:523}],28:[function(r,s,a){const i=r("./under-dash"),o=r("./utils");function l(u,h,f){u.push(` ${h}="${o.xmlEncode(f.toString())}"`)}function d(u,h){if(h){const f=[];i.each(h,(m,p)=>{m!==void 0&&l(f,p,m)}),u.push(f.join(""))}}class c{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(h){const f=this._xml;f.push("<?xml"),d(f,h),f.push(`?>
`)}openNode(h,f){const m=this.tos,p=this._xml;m&&this.open&&p.push(">"),this._stack.push(h),p.push("<"),p.push(h),d(p,f),this.leaf=!0,this.open=!0}addAttribute(h,f){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");f!==void 0&&l(this._xml,h,f)}addAttributes(h){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");d(this._xml,h)}writeText(h){const f=this._xml;this.open&&(f.push(">"),this.open=!1),this.leaf=!1,f.push(o.xmlEncode(h.toString()))}writeXml(h){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(h)}closeNode(){const h=this._stack.pop(),f=this._xml;this.leaf?f.push("/>"):(f.push("</"),f.push(h),f.push(">")),this.open=!1,this.leaf=!1}leafNode(h,f,m){this.openNode(h,f),m!==void 0&&this.writeText(m),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const h=this._rollbacks.pop();this._xml.length>h.xml&&this._xml.splice(h.xml,this._xml.length-h.xml),this._stack.length>h.stack&&this._stack.splice(h.stack,this._stack.length-h.stack),this.leaf=h.leaf,this.open=h.open}get xml(){return this.closeAll(),this._xml.join("")}}c.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},s.exports=c},{"./under-dash":26,"./utils":27}],29:[function(r,s,a){(function(i){(function(){const o=r("events"),l=r("jszip"),d=r("./stream-buf"),{stringToBuffer:c}=r("./browser-buffer-encode");class u extends o.EventEmitter{constructor(f){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},f),this.zip=new l,this.stream=new d}append(f,m){m.hasOwnProperty("base64")&&m.base64?this.zip.file(m.name,f,{base64:!0}):(i.browser&&typeof f=="string"&&(f=c(f)),this.zip.file(m.name,f))}async finalize(){const f=await this.zip.generateAsync(this.options);this.stream.end(f),this.emit("finish")}read(f){return this.stream.read(f)}setEncoding(f){return this.stream.setEncoding(f)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(f,m){return this.stream.pipe(f,m)}unpipe(f){return this.stream.unpipe(f)}unshift(f){return this.stream.unshift(f)}wrap(f){return this.stream.wrap(f)}}s.exports={ZipWriter:u}}).call(this)}).call(this,r("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(r,s,a){s.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(r,s,a){s.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(r,s,a){const i=r("../../utils/parse-sax"),o=r("../../utils/xml-stream");class l{prepare(){}render(){}parseOpen(c){}parseText(c){}parseClose(c){}reconcile(c,u){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(c=>{c instanceof l?c.reset():c.xform&&c.xform.reset()})}mergeModel(c){this.model=Object.assign(this.model||{},c)}async parse(c){for await(const u of c)for(const{eventType:h,value:f}of u)if(h==="opentag")this.parseOpen(f);else if(h==="text")this.parseText(f);else if(h==="closetag"&&!this.parseClose(f.name))return this.model;return this.model}async parseStream(c){return this.parse(i(c))}get xml(){return this.toXml(this.model)}toXml(c){const u=new o;return this.render(u,c),u.xml}static toAttribute(c,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(c===void 0){if(h)return u}else if(h||c!==u)return c.toString()}static toStringAttribute(c,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(c,u,h)}static toStringValue(c,u){return c===void 0?u:c}static toBoolAttribute(c,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(c===void 0){if(h)return u}else if(h||c!==u)return c?"1":"0"}static toBoolValue(c,u){return c===void 0?u:c==="1"}static toIntAttribute(c,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(c,u,h)}static toIntValue(c,u){return c===void 0?u:parseInt(c,10)}static toFloatAttribute(c,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return l.toAttribute(c,u,h)}static toFloatValue(c,u){return c===void 0?u:parseFloat(c)}}s.exports=l},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(r,s,a){const i=r("../base-xform"),o=r("../../../utils/col-cache");function l(c){try{return o.decodeEx(c),!0}catch{return!1}}function d(c){const u=[];let h=!1,f="";return c.split(",").forEach(m=>{if(!m)return;const p=(m.match(/'/g)||[]).length;if(!p)return void(h?f+=m+",":l(m)&&u.push(m));const g=p%2==0;!h&&g&&l(m)?u.push(m):h&&!g?(h=!1,l(f+m)&&u.push(f+m),f=""):(h=!0,f+=m+",")}),u}s.exports=class extends i{render(c,u){c.openNode("definedName",{name:u.name,localSheetId:u.localSheetId}),c.writeText(u.ranges.join(",")),c.closeNode()}parseOpen(c){switch(c.name){case"definedName":return this._parsedName=c.attributes.name,this._parsedLocalSheetId=c.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(c){this._parsedText.push(c)}parseClose(){return this.model={name:this._parsedName,ranges:d(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(r,s,a){const i=r("../../../utils/utils"),o=r("../base-xform");s.exports=class extends o{render(l,d){l.leafNode("sheet",{sheetId:d.id,name:d.name,state:d.state,"r:id":d.rId})}parseOpen(l){return l.name==="sheet"&&(this.model={name:i.xmlDecode(l.attributes.name),id:parseInt(l.attributes.sheetId,10),state:l.attributes.state,rId:l.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,l){o.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:l.fullCalcOnLoad?1:void 0})}parseOpen(o){return o.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,l){o.leafNode("workbookPr",{date1904:l.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(o){return o.name==="workbookPr"&&(this.model={date1904:o.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,l){const d={xWindow:l.x||0,yWindow:l.y||0,windowWidth:l.width||12e3,windowHeight:l.height||24e3,firstSheet:l.firstSheet,activeTab:l.activeTab};l.visibility&&l.visibility!=="visible"&&(d.visibility=l.visibility),o.leafNode("workbookView",d)}parseOpen(o){if(o.name==="workbookView"){const l=this.model={},d=function(u,h,f){const m=h!==void 0?l[u]=h:f;m!==void 0&&(l[u]=m)},c=function(u,h,f){const m=h!==void 0?l[u]=parseInt(h,10):f;m!==void 0&&(l[u]=m)};return c("x",o.attributes.xWindow,0),c("y",o.attributes.yWindow,0),c("width",o.attributes.windowWidth,25e3),c("height",o.attributes.windowHeight,1e4),d("visibility",o.attributes.visibility,"visible"),c("activeTab",o.attributes.activeTab,void 0),c("firstSheet",o.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../../../utils/col-cache"),l=r("../../../utils/xml-stream"),d=r("../base-xform"),c=r("../static-xform"),u=r("../list-xform"),h=r("./defined-name-xform"),f=r("./sheet-xform"),m=r("./workbook-view-xform"),p=r("./workbook-properties-xform"),g=r("./workbook-calc-properties-xform");class x extends d{constructor(){super(),this.map={fileVersion:x.STATIC_XFORMS.fileVersion,workbookPr:new p,bookViews:new u({tag:"bookViews",count:!1,childXform:new m}),sheets:new u({tag:"sheets",count:!1,childXform:new f}),definedNames:new u({tag:"definedNames",count:!1,childXform:new h}),calcPr:new g}}prepare(y){y.sheets=y.worksheets;const b=[];let j=0;y.sheets.forEach(T=>{if(T.pageSetup&&T.pageSetup.printArea&&T.pageSetup.printArea.split("&&").forEach(O=>{const R=O.split(":"),D={name:"_xlnm.Print_Area",ranges:[`'${T.name}'!$${R[0]}:$${R[1]}`],localSheetId:j};b.push(D)}),T.pageSetup&&(T.pageSetup.printTitlesRow||T.pageSetup.printTitlesColumn)){const O=[];if(T.pageSetup.printTitlesColumn){const D=T.pageSetup.printTitlesColumn.split(":");O.push(`'${T.name}'!$${D[0]}:$${D[1]}`)}if(T.pageSetup.printTitlesRow){const D=T.pageSetup.printTitlesRow.split(":");O.push(`'${T.name}'!$${D[0]}:$${D[1]}`)}const R={name:"_xlnm.Print_Titles",ranges:O,localSheetId:j};b.push(R)}j++}),b.length&&(y.definedNames=y.definedNames.concat(b)),(y.media||[]).forEach((T,O)=>{T.name=T.type+(O+1)})}render(y,b){y.openXml(l.StdDocAttributes),y.openNode("workbook",x.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(y),this.map.workbookPr.render(y,b.properties),this.map.bookViews.render(y,b.views),this.map.sheets.render(y,b.sheets),this.map.definedNames.render(y,b.definedNames),this.map.calcPr.render(y,b.calcProperties),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"workbook":return!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(y){const b=(y.workbookRels||[]).reduce((D,B)=>(D[B.Id]=B,D),{}),j=[];let T,O=0;(y.sheets||[]).forEach(D=>{const B=b[D.rId];B&&(T=y.worksheetHash["xl/"+B.Target.replace(/^(\s|\/xl\/)+/,"")],T&&(T.name=D.name,T.id=D.id,T.state=D.state,j[O++]=T))});const R=[];i.each(y.definedNames,D=>{if(D.name==="_xlnm.Print_Area"){if(T=j[D.localSheetId],T){T.pageSetup||(T.pageSetup={});const B=o.decodeEx(D.ranges[0]);T.pageSetup.printArea=T.pageSetup.printArea?`${T.pageSetup.printArea}&&${B.dimensions}`:B.dimensions}}else if(D.name==="_xlnm.Print_Titles"){if(T=j[D.localSheetId],T){T.pageSetup||(T.pageSetup={});const B=D.ranges.join(","),q=/\$/g,Y=/\$\d+:\$\d+/,G=B.match(Y);if(G&&G.length){const S=G[0];T.pageSetup.printTitlesRow=S.replace(q,"")}const I=/\$[A-Z]+:\$[A-Z]+/,F=B.match(I);if(F&&F.length){const S=F[0];T.pageSetup.printTitlesColumn=S.replace(q,"")}}}else R.push(D)}),y.definedNames=R,y.media.forEach((D,B)=>{D.index=B})}}x.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},x.STATIC_XFORMS={fileVersion:new c({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},s.exports=x},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(r,s,a){const i=r("../strings/rich-text-xform"),o=r("../../../utils/utils"),l=r("../base-xform"),d=s.exports=function(c){this.model=c};o.inherits(d,l,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new i),this._richTextXform},render(c,u){u=u||this.model,c.openNode("comment",{ref:u.ref,authorId:0}),c.openNode("text"),u&&u.note&&u.note.texts&&u.note.texts.forEach(h=>{this.richTextXform.render(c,h)}),c.closeNode(),c.closeNode()},parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"comment":return this.model={type:"note",note:{texts:[]},...c.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(c),!0;default:return!1}},parseText(c){this.parser&&this.parser.parseText(c)},parseClose(c){switch(c){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(c),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../../../utils/utils"),l=r("../base-xform"),d=r("./comment-xform"),c=s.exports=function(){this.map={comment:new d}};o.inherits(c,l,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(u,h){h=h||this.model,u.openXml(i.StdDocAttributes),u.openNode("comments",c.COMMENTS_ATTRIBUTES),u.openNode("authors"),u.leafNode("author",null,"Author"),u.closeNode(),u.openNode("commentList"),h.comments.forEach(f=>{this.map.comment.render(u,f)}),u.closeNode(),u.closeNode()},parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(u),!0;default:return!1}},parseText(u){this.parser&&this.parser.parseText(u)},parseClose(u){switch(u){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,l,d){(l===d[2]||this.tag==="x:SizeWithCells"&&l===d[1])&&o.leafNode(this.tag)}parseOpen(o){switch(o.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,l){o.leafNode(this.tag,null,l)}parseOpen(o){switch(o.name){case this.tag:return this.text="",!0;default:return!1}}parseText(o){this.text=o}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"x:Anchor"}getAnchorRect(o){const l=Math.floor(o.left),d=Math.floor(68*(o.left-l)),c=Math.floor(o.top),u=Math.floor(18*(o.top-c)),h=Math.floor(o.right),f=Math.floor(68*(o.right-h)),m=Math.floor(o.bottom);return[l,d,c,u,h,f,m,Math.floor(18*(o.bottom-m))]}getDefaultRect(o){const l=o.col,d=Math.max(o.row-2,0);return[l,6,d,14,l+2,2,d+4,16]}render(o,l){const d=l.anchor?this.getAnchorRect(l.anchor):this.getDefaultRect(l.refAddress);o.leafNode("x:Anchor",null,d.join(", "))}parseOpen(o){switch(o.name){case this.tag:return this.text="",!0;default:return!1}}parseText(o){this.text=o}parseClose(){return!1}}},{"../base-xform":32}],44:[function(r,s,a){const i=r("../base-xform"),o=r("./vml-anchor-xform"),l=r("./style/vml-protection-xform"),d=r("./style/vml-position-xform"),c=["twoCells","oneCells","absolute"];s.exports=class extends i{constructor(){super(),this.map={"x:Anchor":new o,"x:Locked":new l({tag:"x:Locked"}),"x:LockText":new l({tag:"x:LockText"}),"x:SizeWithCells":new d({tag:"x:SizeWithCells"}),"x:MoveWithCells":new d({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(u,h){const{protection:f,editAs:m}=h.note;u.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(u,m,c),this.map["x:SizeWithCells"].render(u,m,c),this.map["x:Anchor"].render(u,h),this.map["x:Locked"].render(u,f.locked),u.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(u,f.lockText),u.leafNode("x:Row",null,h.refAddress.row-1),u.leafNode("x:Column",null,h.refAddress.col-1),u.closeNode()}parseOpen(u){switch(u.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){const u=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),h=Object.keys(u).length;this.model.editAs=c[h],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),l=r("./vml-shape-xform");class d extends o{constructor(){super(),this.map={"v:shape":new l}}get tag(){return"xml"}render(u,h){u.openXml(i.StdDocAttributes),u.openNode(this.tag,d.DRAWING_ATTRIBUTES),u.openNode("o:shapelayout",{"v:ext":"edit"}),u.leafNode("o:idmap",{"v:ext":"edit",data:1}),u.closeNode(),u.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),u.leafNode("v:stroke",{joinstyle:"miter"}),u.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),u.closeNode(),h.comments.forEach((f,m)=>{this.map["v:shape"].render(u,f,m)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}reconcile(u,h){u.anchors.forEach(f=>{f.br?this.map["xdr:twoCellAnchor"].reconcile(f,h):this.map["xdr:oneCellAnchor"].reconcile(f,h)})}}d.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},s.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(r,s,a){const i=r("../base-xform"),o=r("./vml-textbox-xform"),l=r("./vml-client-data-xform");class d extends i{constructor(){super(),this.map={"v:textbox":new o,"x:ClientData":new l}}get tag(){return"v:shape"}render(u,h,f){u.openNode("v:shape",d.V_SHAPE_ATTRIBUTES(h,f)),u.leafNode("v:fill",{color2:"infoBackground [80]"}),u.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),u.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(u,h),this.map["x:ClientData"].render(u,h),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={margins:{insetmode:u.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}}d.V_SHAPE_ATTRIBUTES=(c,u)=>({id:"_x0000_s"+(1025+u),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":c.note.margins&&c.note.margins.insetmode}),s.exports=d},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"v:textbox"}conversionUnit(o,l,d){return`${parseFloat(o)*l.toFixed(2)}${d}`}reverseConversionUnit(o){return(o||"").split(",").map(l=>Number(parseFloat(this.conversionUnit(parseFloat(l),.1,"")).toFixed(2)))}render(o,l){const d={style:"mso-direction-alt:auto"};if(l&&l.note){let{inset:c}=l.note&&l.note.margins;Array.isArray(c)&&(c=c.map(u=>this.conversionUnit(u,10,"mm")).join(",")),c&&(d.inset=c)}o.openNode("v:textbox",d),o.leafNode("div",{style:"text-align:left"}),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:return this.model={inset:this.reverseConversionUnit(o.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],48:[function(r,s,a){const i=r("./base-xform");s.exports=class extends i{createNewModel(o){return{}}parseOpen(o){return this.parser=this.parser||this.map[o.name],this.parser?(this.parser.parseOpen(o),!0):o.name===this.tag&&(this.model=this.createNewModel(o),!0)}parseText(o){this.parser&&this.parser.parseText(o)}onParserClose(o,l){this.model[o]=l.model}parseClose(o){return this.parser?(this.parser.parseClose(o)||(this.onParserClose(o,this.parser),this.parser=void 0),!0):o!==this.tag}}},{"./base-xform":32}],49:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,l){o.openNode("HeadingPairs"),o.openNode("vt:vector",{size:2,baseType:"variant"}),o.openNode("vt:variant"),o.leafNode("vt:lpstr",void 0,"Worksheets"),o.closeNode(),o.openNode("vt:variant"),o.leafNode("vt:i4",void 0,l.length),o.closeNode(),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="HeadingPairs"}parseText(){}parseClose(o){return o!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,l){o.openNode("TitlesOfParts"),o.openNode("vt:vector",{size:l.length,baseType:"lpstr"}),l.forEach(d=>{o.leafNode("vt:lpstr",void 0,d.name)}),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="TitlesOfParts"}parseText(){}parseClose(o){return o!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),l=r("../simple/string-xform"),d=r("./app-heading-pairs-xform"),c=r("./app-titles-of-parts-xform");class u extends o{constructor(){super(),this.map={Company:new l({tag:"Company"}),Manager:new l({tag:"Manager"}),HeadingPairs:new d,TitleOfParts:new c}}render(f,m){f.openXml(i.StdDocAttributes),f.openNode("Properties",u.PROPERTY_ATTRIBUTES),f.leafNode("Application",void 0,"Microsoft Excel"),f.leafNode("DocSecurity",void 0,"0"),f.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(f,m.worksheets),this.map.TitleOfParts.render(f,m.worksheets),this.map.Company.render(f,m.company||""),this.map.Manager.render(f,m.manager),f.leafNode("LinksUpToDate",void 0,"false"),f.leafNode("SharedDoc",void 0,"false"),f.leafNode("HyperlinksChanged",void 0,"false"),f.leafNode("AppVersion",void 0,"16.0300"),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"Properties":return!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}u.DateFormat=function(h){return h.toISOString().replace(/[.]\d{3,6}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},s.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform");class l extends o{render(c,u){c.openXml(i.StdDocAttributes),c.openNode("Types",l.PROPERTY_ATTRIBUTES);const h={};(u.media||[]).forEach(f=>{if(f.type==="image"){const m=f.extension;h[m]||(h[m]=!0,c.leafNode("Default",{Extension:m,ContentType:"image/"+m}))}}),c.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),c.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),c.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),u.worksheets.forEach(f=>{const m=`/xl/worksheets/sheet${f.id}.xml`;c.leafNode("Override",{PartName:m,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),c.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),c.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),u.sharedStrings&&u.sharedStrings.count&&c.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),u.tables&&u.tables.forEach(f=>{c.leafNode("Override",{PartName:"/xl/tables/"+f.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),u.drawings&&u.drawings.forEach(f=>{c.leafNode("Override",{PartName:`/xl/drawings/${f.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),u.commentRefs&&(c.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),u.commentRefs.forEach(f=>{let{commentName:m}=f;c.leafNode("Override",{PartName:`/xl/${m}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),c.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),c.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),c.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}l.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},s.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),l=r("../simple/date-xform"),d=r("../simple/string-xform"),c=r("../simple/integer-xform");class u extends o{constructor(){super(),this.map={"dc:creator":new d({tag:"dc:creator"}),"dc:title":new d({tag:"dc:title"}),"dc:subject":new d({tag:"dc:subject"}),"dc:description":new d({tag:"dc:description"}),"dc:identifier":new d({tag:"dc:identifier"}),"dc:language":new d({tag:"dc:language"}),"cp:keywords":new d({tag:"cp:keywords"}),"cp:category":new d({tag:"cp:category"}),"cp:lastModifiedBy":new d({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new l({tag:"cp:lastPrinted",format:u.DateFormat}),"cp:revision":new c({tag:"cp:revision"}),"cp:version":new d({tag:"cp:version"}),"cp:contentStatus":new d({tag:"cp:contentStatus"}),"cp:contentType":new d({tag:"cp:contentType"}),"dcterms:created":new l({tag:"dcterms:created",attrs:u.DateAttrs,format:u.DateFormat}),"dcterms:modified":new l({tag:"dcterms:modified",attrs:u.DateAttrs,format:u.DateFormat})}}render(f,m){f.openXml(i.StdDocAttributes),f.openNode("cp:coreProperties",u.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(f,m.creator),this.map["dc:title"].render(f,m.title),this.map["dc:subject"].render(f,m.subject),this.map["dc:description"].render(f,m.description),this.map["dc:identifier"].render(f,m.identifier),this.map["dc:language"].render(f,m.language),this.map["cp:keywords"].render(f,m.keywords),this.map["cp:category"].render(f,m.category),this.map["cp:lastModifiedBy"].render(f,m.lastModifiedBy),this.map["cp:lastPrinted"].render(f,m.lastPrinted),this.map["cp:revision"].render(f,m.revision),this.map["cp:version"].render(f,m.version),this.map["cp:contentStatus"].render(f,m.contentStatus),this.map["cp:contentType"].render(f,m.contentType),this.map["dcterms:created"].render(f,m.created),this.map["dcterms:modified"].render(f,m.modified),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[f.name],this.parser)return this.parser.parseOpen(f),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(f))}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+f)}}}u.DateFormat=function(h){return h.toISOString().replace(/[.]\d{3}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},s.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,l){o.leafNode("Relationship",l)}parseOpen(o){switch(o.name){case"Relationship":return this.model=o.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),l=r("./relationship-xform");class d extends o{constructor(){super(),this.map={Relationship:new l}}render(u,h){h=h||this._values,u.openXml(i.StdDocAttributes),u.openNode("Relationships",d.RELATIONSHIPS_ATTRIBUTES),h.forEach(f=>{this.map.Relationship.render(u,f)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[u.name],this.parser)return this.parser.parseOpen(u),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(u){case"Relationships":return!1;default:throw new Error("Unexpected xml node in parseClose: "+u)}}}d.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},s.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case this.tag:this.reset(),this.model={range:{editAs:o.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[o.name],this.parser&&this.parser.parseOpen(o)}return!0}parseText(o){this.parser&&this.parser.parseText(o)}reconcilePicture(o,l){if(o&&o.rId){const d=l.rels[o.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(d){const c=d[1],u=l.mediaIndex[c];return l.media[u]}}}}},{"../base-xform":32}],57:[function(r,s,a){const i=r("../base-xform"),o=r("./blip-xform");s.exports=class extends i{constructor(){super(),this.map={"a:blip":new o}}get tag(){return"xdr:blipFill"}render(l,d){l.openNode(this.tag),this.map["a:blip"].render(l,d),l.openNode("a:stretch"),l.leafNode("a:fillRect"),l.closeNode(),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}}},{"../base-xform":32,"./blip-xform":58}],58:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"a:blip"}render(o,l){o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":l.rId,cstate:"print"})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],59:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"xdr:cNvPicPr"}render(o){o.openNode(this.tag),o.leafNode("a:picLocks",{noChangeAspect:"1"}),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],60:[function(r,s,a){const i=r("../base-xform"),o=r("./hlink-click-xform"),l=r("./ext-lst-xform");s.exports=class extends i{constructor(){super(),this.map={"a:hlinkClick":new o,"a:extLst":new l}}get tag(){return"xdr:cNvPr"}render(d,c){d.openNode(this.tag,{id:c.index,name:"Picture "+c.index}),this.map["a:hlinkClick"].render(d,c),this.map["a:extLst"].render(d,c),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:this.reset();break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(){}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(r,s,a){const i=r("../base-xform"),o=r("../simple/integer-xform");s.exports=class extends i{constructor(l){super(),this.tag=l.tag,this.map={"xdr:col":new o({tag:"xdr:col",zero:!0}),"xdr:colOff":new o({tag:"xdr:colOff",zero:!0}),"xdr:row":new o({tag:"xdr:row",zero:!0}),"xdr:rowOff":new o({tag:"xdr:rowOff",zero:!0})}}render(l,d){l.openNode(this.tag),this.map["xdr:col"].render(l,d.nativeCol),this.map["xdr:colOff"].render(l,d.nativeColOff),this.map["xdr:row"].render(l,d.nativeRow),this.map["xdr:rowOff"].render(l,d.nativeRowOff),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:this.reset();break;default:this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)}return!0}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(r,s,a){const i=r("../../../utils/col-cache"),o=r("../../../utils/xml-stream"),l=r("../base-xform"),d=r("./two-cell-anchor-xform"),c=r("./one-cell-anchor-xform");class u extends l{constructor(){super(),this.map={"xdr:twoCellAnchor":new d,"xdr:oneCellAnchor":new c}}prepare(f){f.anchors.forEach((m,p)=>{m.anchorType=function(g){return(typeof g.range=="string"?i.decode(g.range):g.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}(m),this.map[m.anchorType].prepare(m,{index:p})})}get tag(){return"xdr:wsDr"}render(f,m){f.openXml(o.StdDocAttributes),f.openNode(this.tag,u.DRAWING_ATTRIBUTES),m.anchors.forEach(p=>{this.map[p.anchorType].render(f,p)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f)}return!0}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(f){case this.tag:return!1;default:return!0}}reconcile(f,m){f.anchors.forEach(p=>{p.br?this.map["xdr:twoCellAnchor"].reconcile(p,m):this.map["xdr:oneCellAnchor"].reconcile(p,m)})}}u.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},s.exports=u},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"a:extLst"}render(o){o.openNode(this.tag),o.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),o.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),o.closeNode(),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],64:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.map={}}render(o,l){o.openNode(this.tag);const d=Math.floor(9525*l.width),c=Math.floor(9525*l.height);o.addAttribute("cx",d),o.addAttribute("cy",c),o.closeNode()}parseOpen(o){return o.name===this.tag&&(this.model={width:parseInt(o.attributes.cx||"0",10)/9525,height:parseInt(o.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"a:hlinkClick"}render(o,l){l.hyperlinks&&l.hyperlinks.rId&&o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":l.hyperlinks.rId,tooltip:l.hyperlinks.tooltip})}parseOpen(o){switch(o.name){case this.tag:return this.model={hyperlinks:{rId:o.attributes["r:id"],tooltip:o.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(r,s,a){const i=r("../base-xform"),o=r("./c-nv-pr-xform"),l=r("./c-nv-pic-pr-xform");s.exports=class extends i{constructor(){super(),this.map={"xdr:cNvPr":new o,"xdr:cNvPicPr":new l}}get tag(){return"xdr:nvPicPr"}render(d,c){d.openNode(this.tag),this.map["xdr:cNvPr"].render(d,c),this.map["xdr:cNvPicPr"].render(d,c),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:this.reset();break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(){}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(r,s,a){const i=r("./base-cell-anchor-xform"),o=r("../static-xform"),l=r("./cell-position-xform"),d=r("./ext-xform"),c=r("./pic-xform");s.exports=class extends i{constructor(){super(),this.map={"xdr:from":new l({tag:"xdr:from"}),"xdr:ext":new d({tag:"xdr:ext"}),"xdr:pic":new c,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(u,h){this.map["xdr:pic"].prepare(u.picture,h)}render(u,h){u.openNode(this.tag,{editAs:h.range.editAs||"oneCell"}),this.map["xdr:from"].render(u,h.range.tl),this.map["xdr:ext"].render(u,h.range.ext),this.map["xdr:pic"].render(u,h.picture),this.map["xdr:clientData"].render(u,{}),u.closeNode()}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(u,h){u.medium=this.reconcilePicture(u.picture,h)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(r,s,a){const i=r("../base-xform"),o=r("../static-xform"),l=r("./blip-fill-xform"),d=r("./nv-pic-pr-xform"),c=r("./sp-pr");s.exports=class extends i{constructor(){super(),this.map={"xdr:nvPicPr":new d,"xdr:blipFill":new l,"xdr:spPr":new o(c)}}get tag(){return"xdr:pic"}prepare(u,h){u.index=h.index+1}render(u,h){u.openNode(this.tag),this.map["xdr:nvPicPr"].render(u,h),this.map["xdr:blipFill"].render(u,h),this.map["xdr:spPr"].render(u,h),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(r,s,a){s.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(r,s,a){const i=r("./base-cell-anchor-xform"),o=r("../static-xform"),l=r("./cell-position-xform"),d=r("./pic-xform");s.exports=class extends i{constructor(){super(),this.map={"xdr:from":new l({tag:"xdr:from"}),"xdr:to":new l({tag:"xdr:to"}),"xdr:pic":new d,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(c,u){this.map["xdr:pic"].prepare(c.picture,u)}render(c,u){c.openNode(this.tag,{editAs:u.range.editAs||"oneCell"}),this.map["xdr:from"].render(c,u.range.tl),this.map["xdr:to"].render(c,u.range.br),this.map["xdr:pic"].render(c,u.picture),this.map["xdr:clientData"].render(c,{}),c.closeNode()}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(c,u){c.medium=this.reconcilePicture(c.picture,u)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(r,s,a){const i=r("./base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.always=!!o.always,this.count=o.count,this.empty=o.empty,this.$count=o.$count||"count",this.$=o.$,this.childXform=o.childXform,this.maxItems=o.maxItems}prepare(o,l){const{childXform:d}=this;o&&o.forEach((c,u)=>{l.index=u,d.prepare(c,l)})}render(o,l){if(this.always||l&&l.length){o.openNode(this.tag,this.$),this.count&&o.addAttribute(this.$count,l&&l.length||0);const{childXform:d}=this;(l||[]).forEach((c,u)=>{d.render(o,c,u)}),o.closeNode()}else this.empty&&o.leafNode(this.tag)}parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(o)&&(this.parser=this.childXform,!0)}}parseText(o){this.parser&&this.parser.parseText(o)}parseClose(o){if(this.parser){if(!this.parser.parseClose(o)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(o,l){if(o){const{childXform:d}=this;o.forEach(c=>{d.reconcile(c,l)})}}}},{"./base-xform":32}],72:[function(r,s,a){const i=r("../../../utils/col-cache"),o=r("../base-xform");s.exports=class extends o{get tag(){return"autoFilter"}render(l,d){if(d)if(typeof d=="string")l.leafNode("autoFilter",{ref:d});else{const c=function(f){return typeof f=="string"?f:i.getAddress(f.row,f.column).address},u=c(d.from),h=c(d.to);u&&h&&l.leafNode("autoFilter",{ref:`${u}:${h}`})}}parseOpen(l){l.name==="autoFilter"&&(this.model=l.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(r,s,a){const i=r("../../../utils/utils"),o=r("../base-xform"),l=r("../../../doc/range"),d=r("../../../doc/enums"),c=r("../strings/rich-text-xform");function u(h){if(h==null)return d.ValueType.Null;if(h instanceof String||typeof h=="string")return d.ValueType.String;if(typeof h=="number")return d.ValueType.Number;if(typeof h=="boolean")return d.ValueType.Boolean;if(h instanceof Date)return d.ValueType.Date;if(h.text&&h.hyperlink)return d.ValueType.Hyperlink;if(h.formula)return d.ValueType.Formula;if(h.error)return d.ValueType.Error;throw new Error("I could not understand type of value")}s.exports=class extends o{constructor(){super(),this.richTextXForm=new c}get tag(){return"c"}prepare(h,f){const m=f.styles.addStyleModel(h.style||{},function(p){switch(p.type){case d.ValueType.Formula:return u(p.result);default:return p.type}}(h));switch(m&&(h.styleId=m),h.comment&&f.comments.push({...h.comment,ref:h.address}),h.type){case d.ValueType.String:case d.ValueType.RichText:f.sharedStrings&&(h.ssId=f.sharedStrings.add(h.value));break;case d.ValueType.Date:f.date1904&&(h.date1904=!0);break;case d.ValueType.Hyperlink:f.sharedStrings&&h.text!==void 0&&h.text!==null&&(h.ssId=f.sharedStrings.add(h.text)),f.hyperlinks.push({address:h.address,target:h.hyperlink,tooltip:h.tooltip});break;case d.ValueType.Merge:f.merges.add(h);break;case d.ValueType.Formula:if(f.date1904&&(h.date1904=!0),h.shareType==="shared"&&(h.si=f.siFormulae++),h.formula)f.formulae[h.address]=h;else if(h.sharedFormula){const p=f.formulae[h.sharedFormula];if(!p)throw new Error("Shared Formula master must exist above and or left of clone for cell "+h.address);p.si===void 0?(p.shareType="shared",p.si=f.siFormulae++,p.range=new l(p.address,h.address)):p.range&&p.range.expandToAddress(h.address),h.si=p.si}}}renderFormula(h,f){let m=null;switch(f.shareType){case"shared":m={t:"shared",ref:f.ref||f.range.range,si:f.si};break;case"array":m={t:"array",ref:f.ref};break;default:f.si!==void 0&&(m={t:"shared",si:f.si})}switch(u(f.result)){case d.ValueType.Null:h.leafNode("f",m,f.formula);break;case d.ValueType.String:h.addAttribute("t","str"),h.leafNode("f",m,f.formula),h.leafNode("v",null,f.result);break;case d.ValueType.Number:h.leafNode("f",m,f.formula),h.leafNode("v",null,f.result);break;case d.ValueType.Boolean:h.addAttribute("t","b"),h.leafNode("f",m,f.formula),h.leafNode("v",null,f.result?1:0);break;case d.ValueType.Error:h.addAttribute("t","e"),h.leafNode("f",m,f.formula),h.leafNode("v",null,f.result.error);break;case d.ValueType.Date:h.leafNode("f",m,f.formula),h.leafNode("v",null,i.dateToExcel(f.result,f.date1904));break;default:throw new Error("I could not understand type of value")}}render(h,f){if(f.type!==d.ValueType.Null||f.styleId){switch(h.openNode("c"),h.addAttribute("r",f.address),f.styleId&&h.addAttribute("s",f.styleId),f.type){case d.ValueType.Null:break;case d.ValueType.Number:h.leafNode("v",null,f.value);break;case d.ValueType.Boolean:h.addAttribute("t","b"),h.leafNode("v",null,f.value?"1":"0");break;case d.ValueType.Error:h.addAttribute("t","e"),h.leafNode("v",null,f.value.error);break;case d.ValueType.String:case d.ValueType.RichText:f.ssId!==void 0?(h.addAttribute("t","s"),h.leafNode("v",null,f.ssId)):f.value&&f.value.richText?(h.addAttribute("t","inlineStr"),h.openNode("is"),f.value.richText.forEach(m=>{this.richTextXForm.render(h,m)}),h.closeNode("is")):(h.addAttribute("t","str"),h.leafNode("v",null,f.value));break;case d.ValueType.Date:h.leafNode("v",null,i.dateToExcel(f.value,f.date1904));break;case d.ValueType.Hyperlink:f.ssId!==void 0?(h.addAttribute("t","s"),h.leafNode("v",null,f.ssId)):(h.addAttribute("t","str"),h.leafNode("v",null,f.text));break;case d.ValueType.Formula:this.renderFormula(h,f);break;case d.ValueType.Merge:}h.closeNode()}}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"c":return this.model={address:h.attributes.r},this.t=h.attributes.t,h.attributes.s&&(this.model.styleId=parseInt(h.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=h.attributes.si,this.model.shareType=h.attributes.t,this.model.ref=h.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(h),!0;default:return!1}}parseText(h){if(this.parser)this.parser.parseText(h);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+h:h;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+h:h:this.model.value=this.model.value?this.model.value+h:h}}parseClose(h){switch(h){case"c":{const{model:f}=this;if(f.formula||f.shareType)f.type=d.ValueType.Formula,f.value&&(this.t==="str"?f.result=i.xmlDecode(f.value):this.t==="b"?f.result=parseInt(f.value,10)!==0:this.t==="e"?f.result={error:f.value}:f.result=parseFloat(f.value),f.value=void 0);else if(f.value!==void 0)switch(this.t){case"s":f.type=d.ValueType.String,f.value=parseInt(f.value,10);break;case"str":f.type=d.ValueType.String,f.value=i.xmlDecode(f.value);break;case"inlineStr":f.type=d.ValueType.String;break;case"b":f.type=d.ValueType.Boolean,f.value=parseInt(f.value,10)!==0;break;case"e":f.type=d.ValueType.Error,f.value={error:f.value};break;default:f.type=d.ValueType.Number,f.value=parseFloat(f.value)}else f.styleId?f.type=d.ValueType.Null:f.type=d.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(h),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(h),!0)}}reconcile(h,f){const m=h.styleId&&f.styles&&f.styles.getStyleModel(h.styleId);switch(m&&(h.style=m),h.styleId!==void 0&&(h.styleId=void 0),h.type){case d.ValueType.String:typeof h.value=="number"&&f.sharedStrings&&(h.value=f.sharedStrings.getString(h.value)),h.value.richText&&(h.type=d.ValueType.RichText);break;case d.ValueType.Number:m&&i.isDateFmt(m.numFmt)&&(h.type=d.ValueType.Date,h.value=i.excelToDate(h.value,f.date1904));break;case d.ValueType.Formula:h.result!==void 0&&m&&i.isDateFmt(m.numFmt)&&(h.result=i.excelToDate(h.result,f.date1904)),h.shareType==="shared"&&(h.ref?f.formulae[h.si]=h.address:(h.sharedFormula=f.formulae[h.si],delete h.shareType),delete h.si)}const p=f.hyperlinkMap[h.address];p&&(h.type===d.ValueType.Formula?(h.text=h.result,h.result=void 0):(h.text=h.value,h.value=void 0),h.type=d.ValueType.Hyperlink,h.hyperlink=p);const g=f.commentsMap&&f.commentsMap[h.address];g&&(h.comment=g)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{get tag(){return"x14:cfIcon"}render(o,l){o.leafNode(this.tag,{iconSet:l.iconSet,iconId:l.iconId})}parseOpen(o){let{attributes:l}=o;this.model={iconSet:l.iconSet,iconId:i.toIntValue(l.iconId)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],75:[function(r,s,a){const{v4:i}=r("uuid"),o=r("../../base-xform"),l=r("../../composite-xform"),d=r("./databar-ext-xform"),c=r("./icon-set-ext-xform"),u={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class h extends l{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new d,"x14:iconSet":this.iconSetXform=new c}}get tag(){return"x14:cfRule"}static isExt(m){return m.type==="dataBar"?d.isExt(m):!(m.type!=="iconSet"||!m.custom&&!u[m.iconSet])}prepare(m){h.isExt(m)&&(m.x14Id=`{${i()}}`.toUpperCase())}render(m,p){if(h.isExt(p))switch(p.type){case"dataBar":this.renderDataBar(m,p);break;case"iconSet":this.renderIconSet(m,p)}}renderDataBar(m,p){m.openNode(this.tag,{type:"dataBar",id:p.x14Id}),this.databarXform.render(m,p),m.closeNode()}renderIconSet(m,p){m.openNode(this.tag,{type:"iconSet",priority:p.priority,id:p.x14Id||`{${i()}}`}),this.iconSetXform.render(m,p),m.closeNode()}createNewModel(m){let{attributes:p}=m;return{type:p.type,x14Id:p.id,priority:o.toIntValue(p.priority)}}onParserClose(m,p){Object.assign(this.model,p.model)}}s.exports=h},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(r,s,a){const i=r("../../composite-xform"),o=r("./f-ext-xform");s.exports=class extends i{constructor(){super(),this.map={"xm:f":this.fExtXform=new o}}get tag(){return"x14:cfvo"}render(l,d){l.openNode(this.tag,{type:d.type}),d.value!==void 0&&this.fExtXform.render(l,d.value),l.closeNode()}createNewModel(l){return{type:l.attributes.type}}onParserClose(l,d){switch(l){case"xm:f":this.model.value=d.model?parseFloat(d.model):0}}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(r,s,a){const i=r("../../composite-xform"),o=r("./sqref-ext-xform"),l=r("./cf-rule-ext-xform");s.exports=class extends i{constructor(){super(),this.map={"xm:sqref":this.sqRef=new o,"x14:cfRule":this.cfRule=new l}}get tag(){return"x14:conditionalFormatting"}prepare(d,c){d.rules.forEach(u=>{this.cfRule.prepare(u,c)})}render(d,c){c.rules.some(l.isExt)&&(d.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),c.rules.filter(l.isExt).forEach(u=>this.cfRule.render(d,u)),this.sqRef.render(d,c.ref),d.closeNode())}createNewModel(){return{rules:[]}}onParserClose(d,c){switch(d){case"xm:sqref":this.model.ref=c.model;break;case"x14:cfRule":this.model.rules.push(c.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(r,s,a){const i=r("../../composite-xform"),o=r("./cf-rule-ext-xform"),l=r("./conditional-formatting-ext-xform");s.exports=class extends i{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new l}}get tag(){return"x14:conditionalFormattings"}hasContent(d){return d.hasExtContent===void 0&&(d.hasExtContent=d.some(c=>c.rules.some(o.isExt))),d.hasExtContent}prepare(d,c){d.forEach(u=>{this.cfXform.prepare(u,c)})}render(d,c){this.hasContent(c)&&(d.openNode(this.tag),c.forEach(u=>this.cfXform.render(d,u)),d.closeNode())}createNewModel(){return[]}onParserClose(d,c){this.model.push(c.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(r,s,a){const i=r("../../base-xform"),o=r("../../composite-xform"),l=r("../../style/color-xform"),d=r("./cfvo-ext-xform");s.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new d,"x14:borderColor":this.borderColorXform=new l("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new l("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new l("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new l("x14:axisColor")}}static isExt(c){return!c.gradient}get tag(){return"x14:dataBar"}render(c,u){c.openNode(this.tag,{minLength:i.toIntAttribute(u.minLength,0,!0),maxLength:i.toIntAttribute(u.maxLength,100,!0),border:i.toBoolAttribute(u.border,!1),gradient:i.toBoolAttribute(u.gradient,!0),negativeBarColorSameAsPositive:i.toBoolAttribute(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolAttribute(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toAttribute(u.axisPosition,"auto"),direction:i.toAttribute(u.direction,"leftToRight")}),u.cfvo.forEach(h=>{this.cfvoXform.render(c,h)}),this.borderColorXform.render(c,u.borderColor),this.negativeBorderColorXform.render(c,u.negativeBorderColor),this.negativeFillColorXform.render(c,u.negativeFillColor),this.axisColorXform.render(c,u.axisColor),c.closeNode()}createNewModel(c){let{attributes:u}=c;return{cfvo:[],minLength:i.toIntValue(u.minLength,0),maxLength:i.toIntValue(u.maxLength,100),border:i.toBoolValue(u.border,!1),gradient:i.toBoolValue(u.gradient,!0),negativeBarColorSameAsPositive:i.toBoolValue(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolValue(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toStringValue(u.axisPosition,"auto"),direction:i.toStringValue(u.direction,"leftToRight")}}onParserClose(c,u){const[,h]=c.split(":");switch(h){case"cfvo":this.model.cfvo.push(u.model);break;default:this.model[h]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{get tag(){return"xm:f"}render(o,l){o.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],81:[function(r,s,a){const i=r("../../base-xform"),o=r("../../composite-xform"),l=r("./cfvo-ext-xform"),d=r("./cf-icon-ext-xform");s.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new l,"x14:cfIcon":this.cfIconXform=new d}}get tag(){return"x14:iconSet"}render(c,u){c.openNode(this.tag,{iconSet:i.toStringAttribute(u.iconSet),reverse:i.toBoolAttribute(u.reverse,!1),showValue:i.toBoolAttribute(u.showValue,!0),custom:i.toBoolAttribute(u.icons,!1)}),u.cfvo.forEach(h=>{this.cfvoXform.render(c,h)}),u.icons&&u.icons.forEach((h,f)=>{h.iconId=f,this.cfIconXform.render(c,h)}),c.closeNode()}createNewModel(c){let{attributes:u}=c;return{cfvo:[],iconSet:i.toStringValue(u.iconSet,"3TrafficLights"),reverse:i.toBoolValue(u.reverse,!1),showValue:i.toBoolValue(u.showValue,!0)}}onParserClose(c,u){const[,h]=c.split(":");switch(h){case"cfvo":this.model.cfvo.push(u.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(u.model);break;default:this.model[h]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{get tag(){return"xm:sqref"}render(o,l){o.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],83:[function(r,s,a){const i=r("../../base-xform"),o=r("../../composite-xform"),l=r("../../../../doc/range"),d=r("./databar-xform"),c=r("./ext-lst-ref-xform"),u=r("./formula-xform"),h=r("./color-scale-xform"),f=r("./icon-set-xform"),m={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},p=x=>{const{type:v,operator:y}=x;switch(v){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:v};default:return{type:v,operator:y}}};class g extends o{constructor(){super(),this.map={dataBar:this.databarXform=new d,extLst:this.extLstRefXform=new c,formula:this.formulaXform=new u,colorScale:this.colorScaleXform=new h,iconSet:this.iconSetXform=new f}}get tag(){return"cfRule"}static isPrimitive(v){return v.type!=="iconSet"||!v.custom&&!m[v.iconSet]}render(v,y){switch(y.type){case"expression":this.renderExpression(v,y);break;case"cellIs":this.renderCellIs(v,y);break;case"top10":this.renderTop10(v,y);break;case"aboveAverage":this.renderAboveAverage(v,y);break;case"dataBar":this.renderDataBar(v,y);break;case"colorScale":this.renderColorScale(v,y);break;case"iconSet":this.renderIconSet(v,y);break;case"containsText":this.renderText(v,y);break;case"timePeriod":this.renderTimePeriod(v,y)}}renderExpression(v,y){v.openNode(this.tag,{type:"expression",dxfId:y.dxfId,priority:y.priority}),this.formulaXform.render(v,y.formulae[0]),v.closeNode()}renderCellIs(v,y){v.openNode(this.tag,{type:"cellIs",dxfId:y.dxfId,priority:y.priority,operator:y.operator}),y.formulae.forEach(b=>{this.formulaXform.render(v,b)}),v.closeNode()}renderTop10(v,y){v.leafNode(this.tag,{type:"top10",dxfId:y.dxfId,priority:y.priority,percent:i.toBoolAttribute(y.percent,!1),bottom:i.toBoolAttribute(y.bottom,!1),rank:i.toIntValue(y.rank,10,!0)})}renderAboveAverage(v,y){v.leafNode(this.tag,{type:"aboveAverage",dxfId:y.dxfId,priority:y.priority,aboveAverage:i.toBoolAttribute(y.aboveAverage,!0)})}renderDataBar(v,y){v.openNode(this.tag,{type:"dataBar",priority:y.priority}),this.databarXform.render(v,y),this.extLstRefXform.render(v,y),v.closeNode()}renderColorScale(v,y){v.openNode(this.tag,{type:"colorScale",priority:y.priority}),this.colorScaleXform.render(v,y),v.closeNode()}renderIconSet(v,y){g.isPrimitive(y)&&(v.openNode(this.tag,{type:"iconSet",priority:y.priority}),this.iconSetXform.render(v,y),v.closeNode())}renderText(v,y){v.openNode(this.tag,{type:y.operator,dxfId:y.dxfId,priority:y.priority,operator:i.toStringAttribute(y.operator,"containsText")});const b=(j=>{if(j.formulae&&j.formulae[0])return j.formulae[0];const T=new l(j.ref),{tl:O}=T;switch(j.operator){case"containsText":return`NOT(ISERROR(SEARCH("${j.text}",${O})))`;case"containsBlanks":return`LEN(TRIM(${O}))=0`;case"notContainsBlanks":return`LEN(TRIM(${O}))>0`;case"containsErrors":return`ISERROR(${O})`;case"notContainsErrors":return`NOT(ISERROR(${O}))`;default:return}})(y);b&&this.formulaXform.render(v,b),v.closeNode()}renderTimePeriod(v,y){v.openNode(this.tag,{type:"timePeriod",dxfId:y.dxfId,priority:y.priority,timePeriod:y.timePeriod});const b=(j=>{if(j.formulae&&j.formulae[0])return j.formulae[0];const T=new l(j.ref),{tl:O}=T;switch(j.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${O},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${O},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${O},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${O},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${O},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${O},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${O},1)=TODAY()-1`;case"today":return`FLOOR(${O},1)=TODAY()`;case"tomorrow":return`FLOOR(${O},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${O},1)<=6,FLOOR(${O},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${O})=MONTH(EDATE(TODAY(),0-1)),YEAR(${O})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${O})=MONTH(TODAY()),YEAR(${O})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${O})=MONTH(EDATE(TODAY(),0+1)),YEAR(${O})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(y);b&&this.formulaXform.render(v,b),v.closeNode()}createNewModel(v){let{attributes:y}=v;return{...p(y),dxfId:i.toIntValue(y.dxfId),priority:i.toIntValue(y.priority),timePeriod:y.timePeriod,percent:i.toBoolValue(y.percent),bottom:i.toBoolValue(y.bottom),rank:i.toIntValue(y.rank),aboveAverage:i.toBoolValue(y.aboveAverage)}}onParserClose(v,y){switch(v){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,y.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(y.model)}}}s.exports=g},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{get tag(){return"cfvo"}render(o,l){o.leafNode(this.tag,{type:l.type,val:l.value})}parseOpen(o){this.model={type:o.attributes.type,value:i.toFloatValue(o.attributes.val)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],85:[function(r,s,a){const i=r("../../composite-xform"),o=r("../../style/color-xform"),l=r("./cfvo-xform");s.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new l,color:this.colorXform=new o}}get tag(){return"colorScale"}render(d,c){d.openNode(this.tag),c.cfvo.forEach(u=>{this.cfvoXform.render(d,u)}),c.color.forEach(u=>{this.colorXform.render(d,u)}),d.closeNode()}createNewModel(d){return{cfvo:[],color:[]}}onParserClose(d,c){this.model[d].push(c.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(r,s,a){const i=r("../../composite-xform"),o=r("./cf-rule-xform");s.exports=class extends i{constructor(){super(),this.map={cfRule:new o}}get tag(){return"conditionalFormatting"}render(l,d){d.rules.some(o.isPrimitive)&&(l.openNode(this.tag,{sqref:d.ref}),d.rules.forEach(c=>{o.isPrimitive(c)&&(c.ref=d.ref,this.map.cfRule.render(l,c))}),l.closeNode())}createNewModel(l){let{attributes:d}=l;return{ref:d.sqref,rules:[]}}onParserClose(l,d){this.model.rules.push(d.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(r,s,a){const i=r("../../base-xform"),o=r("./conditional-formatting-xform");s.exports=class extends i{constructor(){super(),this.cfXform=new o}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(l,d){let c=l.reduce((u,h)=>Math.max(u,...h.rules.map(f=>f.priority||0)),1);l.forEach(u=>{u.rules.forEach(h=>{h.priority||(h.priority=c++),h.style&&(h.dxfId=d.styles.addDxfStyle(h.style))})})}render(l,d){d.forEach(c=>{this.cfXform.render(l,c)})}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(l),!0;default:return!1}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){return!!this.parser&&(!!this.parser.parseClose(l)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(l,d){l.forEach(c=>{c.rules.forEach(u=>{u.dxfId!==void 0&&(u.style=d.styles.getDxfStyle(u.dxfId),delete u.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(r,s,a){const i=r("../../composite-xform"),o=r("../../style/color-xform"),l=r("./cfvo-xform");s.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new l,color:this.colorXform=new o}}get tag(){return"dataBar"}render(d,c){d.openNode(this.tag),c.cfvo.forEach(u=>{this.cfvoXform.render(d,u)}),this.colorXform.render(d,c.color),d.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(d,c){switch(d){case"cfvo":this.model.cfvo.push(c.model);break;case"color":this.model.color=c.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(r,s,a){const i=r("../../base-xform"),o=r("../../composite-xform");class l extends i{get tag(){return"x14:id"}render(u,h){u.leafNode(this.tag,null,h)}parseOpen(){this.model=""}parseText(u){this.model+=u}parseClose(u){return u!==this.tag}}class d extends o{constructor(){super(),this.map={"x14:id":this.idXform=new l}}get tag(){return"ext"}render(u,h){u.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(u,h.x14Id),u.closeNode()}createNewModel(){return{}}onParserClose(u,h){this.model.x14Id=h.model}}s.exports=class extends o{constructor(){super(),this.map={ext:new d}}get tag(){return"extLst"}render(c,u){c.openNode(this.tag),this.map.ext.render(c,u),c.closeNode()}createNewModel(){return{}}onParserClose(c,u){Object.assign(this.model,u.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{get tag(){return"formula"}render(o,l){o.leafNode(this.tag,null,l)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],91:[function(r,s,a){const i=r("../../base-xform"),o=r("../../composite-xform"),l=r("./cfvo-xform");s.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new l}}get tag(){return"iconSet"}render(d,c){d.openNode(this.tag,{iconSet:i.toStringAttribute(c.iconSet,"3TrafficLights"),reverse:i.toBoolAttribute(c.reverse,!1),showValue:i.toBoolAttribute(c.showValue,!0)}),c.cfvo.forEach(u=>{this.cfvoXform.render(d,u)}),d.closeNode()}createNewModel(d){let{attributes:c}=d;return{iconSet:i.toStringValue(c.iconSet,"3TrafficLights"),reverse:i.toBoolValue(c.reverse),showValue:i.toBoolValue(c.showValue),cfvo:[]}}onParserClose(d,c){this.model[d].push(c.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(r,s,a){const i=r("../../../utils/utils"),o=r("../base-xform");s.exports=class extends o{get tag(){return"col"}prepare(l,d){const c=d.styles.addStyleModel(l.style||{});c&&(l.styleId=c)}render(l,d){l.openNode("col"),l.addAttribute("min",d.min),l.addAttribute("max",d.max),d.width&&l.addAttribute("width",d.width),d.styleId&&l.addAttribute("style",d.styleId),d.hidden&&l.addAttribute("hidden","1"),d.bestFit&&l.addAttribute("bestFit","1"),d.outlineLevel&&l.addAttribute("outlineLevel",d.outlineLevel),d.collapsed&&l.addAttribute("collapsed","1"),l.addAttribute("customWidth","1"),l.closeNode()}parseOpen(l){if(l.name==="col"){const d=this.model={min:parseInt(l.attributes.min||"0",10),max:parseInt(l.attributes.max||"0",10),width:l.attributes.width===void 0?void 0:parseFloat(l.attributes.width||"0")};return l.attributes.style&&(d.styleId=parseInt(l.attributes.style,10)),i.parseBoolean(l.attributes.hidden)&&(d.hidden=!0),i.parseBoolean(l.attributes.bestFit)&&(d.bestFit=!0),l.attributes.outlineLevel&&(d.outlineLevel=parseInt(l.attributes.outlineLevel,10)),i.parseBoolean(l.attributes.collapsed)&&(d.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(l,d){l.styleId&&(l.style=d.styles.getStyleModel(l.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../../../utils/utils"),l=r("../../../utils/col-cache"),d=r("../base-xform"),c=r("../../../doc/range");function u(f,m,p,g){const x=m[p];x!==void 0?f[p]=x:g!==void 0&&(f[p]=g)}function h(f,m,p,g){const x=m[p];x!==void 0&&(f[p]=o.parseBoolean(x))}s.exports=class extends d{get tag(){return"dataValidations"}render(f,m){const p=function(g){const x=i.map(g,(b,j)=>({address:j,dataValidation:b,marked:!1})).sort((b,j)=>i.strcmp(b.address,j.address)),v=i.keyBy(x,"address"),y=(b,j,T)=>{for(let O=0;O<j;O++){const R=l.encodeAddress(b.row+O,T);if(!g[R]||!i.isEqual(g[b.address],g[R]))return!1}return!0};return x.map(b=>{if(!b.marked){const j=l.decodeEx(b.address);if(j.dimensions)return v[j.dimensions].marked=!0,{...b.dataValidation,sqref:b.address};let T=1,O=l.encodeAddress(j.row+T,j.col);for(;g[O]&&i.isEqual(b.dataValidation,g[O]);)T++,O=l.encodeAddress(j.row+T,j.col);let R=1;for(;y(j,T,j.col+R);)R++;for(let D=0;D<T;D++)for(let B=0;B<R;B++)O=l.encodeAddress(j.row+D,j.col+B),v[O].marked=!0;if(T>1||R>1){const D=j.row+(T-1),B=j.col+(R-1);return{...b.dataValidation,sqref:`${b.address}:${l.encodeAddress(D,B)}`}}return{...b.dataValidation,sqref:b.address}}return null}).filter(Boolean)}(m);p.length&&(f.openNode("dataValidations",{count:p.length}),p.forEach(g=>{f.openNode("dataValidation"),g.type!=="any"&&(f.addAttribute("type",g.type),g.operator&&g.type!=="list"&&g.operator!=="between"&&f.addAttribute("operator",g.operator),g.allowBlank&&f.addAttribute("allowBlank","1")),g.showInputMessage&&f.addAttribute("showInputMessage","1"),g.promptTitle&&f.addAttribute("promptTitle",g.promptTitle),g.prompt&&f.addAttribute("prompt",g.prompt),g.showErrorMessage&&f.addAttribute("showErrorMessage","1"),g.errorStyle&&f.addAttribute("errorStyle",g.errorStyle),g.errorTitle&&f.addAttribute("errorTitle",g.errorTitle),g.error&&f.addAttribute("error",g.error),f.addAttribute("sqref",g.sqref),(g.formulae||[]).forEach((x,v)=>{f.openNode("formula"+(v+1)),g.type==="date"?f.writeText(o.dateToExcel(new Date(x))):f.writeText(x),f.closeNode()}),f.closeNode()}),f.closeNode())}parseOpen(f){switch(f.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=f.attributes.sqref;const m={type:f.attributes.type||"any",formulae:[]};switch(f.attributes.type&&h(m,f.attributes,"allowBlank"),h(m,f.attributes,"showInputMessage"),h(m,f.attributes,"showErrorMessage"),m.type){case"any":case"list":case"custom":break;default:u(m,f.attributes,"operator","between")}return u(m,f.attributes,"promptTitle"),u(m,f.attributes,"prompt"),u(m,f.attributes,"errorStyle"),u(m,f.attributes,"errorTitle"),u(m,f.attributes,"error"),this._dataValidation=m,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(f){this._formula&&this._formula.push(f)}parseClose(f){switch(f){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(m=>{m.includes(":")?new c(m).forEachAddress(p=>{this.model[p]=this._dataValidation}):this.model[m]=this._dataValidation}),!0;case"formula1":case"formula2":{let m=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":m=parseInt(m,10);break;case"decimal":m=parseFloat(m);break;case"date":m=o.excelToDate(parseFloat(m))}return this._dataValidation.formulae.push(m),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"dimension"}render(o,l){l&&o.leafNode("dimension",{ref:l})}parseOpen(o){return o.name==="dimension"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"drawing"}render(o,l){l&&o.leafNode(this.tag,{"r:id":l.rId})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(r,s,a){const i=r("../composite-xform"),o=r("./cf-ext/conditional-formattings-ext-xform");class l extends i{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new o}}get tag(){return"ext"}hasContent(c){return this.conditionalFormattings.hasContent(c.conditionalFormattings)}prepare(c,u){this.conditionalFormattings.prepare(c.conditionalFormattings,u)}render(c,u){c.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(c,u.conditionalFormattings),c.closeNode()}createNewModel(){return{}}onParserClose(c,u){this.model[c]=u.model}}s.exports=class extends i{constructor(){super(),this.map={ext:this.ext=new l}}get tag(){return"extLst"}prepare(d,c){this.ext.prepare(d,c)}hasContent(d){return this.ext.hasContent(d)}render(d,c){this.hasContent(c)&&(d.openNode("extLst"),this.ext.render(d,c),d.closeNode())}createNewModel(){return{}}onParserClose(d,c){Object.assign(this.model,c.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"headerFooter"}render(o,l){if(l){o.addRollback();let d=!1;o.openNode("headerFooter"),l.differentFirst&&(o.addAttribute("differentFirst","1"),d=!0),l.differentOddEven&&(o.addAttribute("differentOddEven","1"),d=!0),l.oddHeader&&typeof l.oddHeader=="string"&&(o.leafNode("oddHeader",null,l.oddHeader),d=!0),l.oddFooter&&typeof l.oddFooter=="string"&&(o.leafNode("oddFooter",null,l.oddFooter),d=!0),l.evenHeader&&typeof l.evenHeader=="string"&&(o.leafNode("evenHeader",null,l.evenHeader),d=!0),l.evenFooter&&typeof l.evenFooter=="string"&&(o.leafNode("evenFooter",null,l.evenFooter),d=!0),l.firstHeader&&typeof l.firstHeader=="string"&&(o.leafNode("firstHeader",null,l.firstHeader),d=!0),l.firstFooter&&typeof l.firstFooter=="string"&&(o.leafNode("firstFooter",null,l.firstFooter),d=!0),d?(o.closeNode(),o.commit()):o.rollback()}}parseOpen(o){switch(o.name){case"headerFooter":return this.model={},o.attributes.differentFirst&&(this.model.differentFirst=parseInt(o.attributes.differentFirst,0)===1),o.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(o.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(o){switch(this.currentNode){case"oddHeader":this.model.oddHeader=o;break;case"oddFooter":this.model.oddFooter=o;break;case"evenHeader":this.model.evenHeader=o;break;case"evenFooter":this.model.evenFooter=o;break;case"firstHeader":this.model.firstHeader=o;break;case"firstFooter":this.model.firstFooter=o}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"hyperlink"}render(o,l){this.isInternalLink(l)?o.leafNode("hyperlink",{ref:l.address,"r:id":l.rId,tooltip:l.tooltip,location:l.target}):o.leafNode("hyperlink",{ref:l.address,"r:id":l.rId,tooltip:l.tooltip})}parseOpen(o){return o.name==="hyperlink"&&(this.model={address:o.attributes.ref,rId:o.attributes["r:id"],tooltip:o.attributes.tooltip},o.attributes.location&&(this.model.target=o.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(o){return o.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(o.target)}}},{"../base-xform":32}],99:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"mergeCell"}render(o,l){o.leafNode("mergeCell",{ref:l})}parseOpen(o){return o.name==="mergeCell"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../../../doc/range"),l=r("../../../utils/col-cache"),d=r("../../../doc/enums");s.exports=class{constructor(){this.merges={}}add(c){if(this.merges[c.master])this.merges[c.master].expandToAddress(c.address);else{const u=`${c.master}:${c.address}`;this.merges[c.master]=new o(u)}}get mergeCells(){return i.map(this.merges,c=>c.range)}reconcile(c,u){i.each(c,h=>{const f=l.decode(h);for(let m=f.top;m<=f.bottom;m++){const p=u[m-1];for(let g=f.left;g<=f.right;g++){const x=p.cells[g-1];x?x.type===d.ValueType.Merge&&(x.master=f.tl):p.cells[g]={type:d.ValueType.Null,address:l.encodeAddress(m,g)}}}})}getMasterAddress(c){const u=this.hash[c];return u&&u.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(r,s,a){const i=r("../base-xform"),o=l=>l!==void 0;s.exports=class extends i{get tag(){return"outlinePr"}render(l,d){return!(!d||!o(d.summaryBelow)&&!o(d.summaryRight))&&(l.leafNode(this.tag,{summaryBelow:o(d.summaryBelow)?Number(d.summaryBelow):void 0,summaryRight:o(d.summaryRight)?Number(d.summaryRight):void 0}),!0)}parseOpen(l){return l.name===this.tag&&(this.model={summaryBelow:o(l.attributes.summaryBelow)?!!Number(l.attributes.summaryBelow):void 0,summaryRight:o(l.attributes.summaryRight)?!!Number(l.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"brk"}render(o,l){o.leafNode("brk",l)}parseOpen(o){return o.name==="brk"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../base-xform");s.exports=class extends o{get tag(){return"pageMargins"}render(l,d){if(d){const c={left:d.left,right:d.right,top:d.top,bottom:d.bottom,header:d.header,footer:d.footer};i.some(c,u=>u!==void 0)&&l.leafNode(this.tag,c)}}parseOpen(l){switch(l.name){case this.tag:return this.model={left:parseFloat(l.attributes.left||.7),right:parseFloat(l.attributes.right||.7),top:parseFloat(l.attributes.top||.75),bottom:parseFloat(l.attributes.bottom||.75),header:parseFloat(l.attributes.header||.3),footer:parseFloat(l.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"pageSetUpPr"}render(o,l){return!(!l||!l.fitToPage)&&(o.leafNode(this.tag,{fitToPage:l.fitToPage?"1":void 0}),!0)}parseOpen(o){return o.name===this.tag&&(this.model={fitToPage:o.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../base-xform");function l(h){return h?"1":void 0}function d(h){switch(h){case"overThenDown":return h;default:return}}function c(h){switch(h){case"atEnd":case"asDisplyed":return h;default:return}}function u(h){switch(h){case"dash":case"blank":case"NA":return h;default:return}}s.exports=class extends o{get tag(){return"pageSetup"}render(h,f){if(f){const m={paperSize:f.paperSize,orientation:f.orientation,horizontalDpi:f.horizontalDpi,verticalDpi:f.verticalDpi,pageOrder:d(f.pageOrder),blackAndWhite:l(f.blackAndWhite),draft:l(f.draft),cellComments:c(f.cellComments),errors:u(f.errors),scale:f.scale,fitToWidth:f.fitToWidth,fitToHeight:f.fitToHeight,firstPageNumber:f.firstPageNumber,useFirstPageNumber:l(f.firstPageNumber),usePrinterDefaults:l(f.usePrinterDefaults),copies:f.copies};i.some(m,p=>p!==void 0)&&h.leafNode(this.tag,m)}}parseOpen(h){switch(h.name){case this.tag:return this.model={paperSize:(f=h.attributes.paperSize,f!==void 0?parseInt(f,10):void 0),orientation:h.attributes.orientation||"portrait",horizontalDpi:parseInt(h.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(h.attributes.verticalDpi||"4294967295",10),pageOrder:h.attributes.pageOrder||"downThenOver",blackAndWhite:h.attributes.blackAndWhite==="1",draft:h.attributes.draft==="1",cellComments:h.attributes.cellComments||"None",errors:h.attributes.errors||"displayed",scale:parseInt(h.attributes.scale||"100",10),fitToWidth:parseInt(h.attributes.fitToWidth||"1",10),fitToHeight:parseInt(h.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(h.attributes.firstPageNumber||"1",10),useFirstPageNumber:h.attributes.useFirstPageNumber==="1",usePrinterDefaults:h.attributes.usePrinterDefaults==="1",copies:parseInt(h.attributes.copies||"1",10)},!0;default:return!1}var f}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"picture"}render(o,l){l&&o.leafNode(this.tag,{"r:id":l.rId})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../base-xform");function l(d){return d?"1":void 0}s.exports=class extends o{get tag(){return"printOptions"}render(d,c){if(c){const u={headings:l(c.showRowColHeaders),gridLines:l(c.showGridLines),horizontalCentered:l(c.horizontalCentered),verticalCentered:l(c.verticalCentered)};i.some(u,h=>h!==void 0)&&d.leafNode(this.tag,u)}}parseOpen(d){switch(d.name){case this.tag:return this.model={showRowColHeaders:d.attributes.headings==="1",showGridLines:d.attributes.gridLines==="1",horizontalCentered:d.attributes.horizontalCentered==="1",verticalCentered:d.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(r,s,a){const i=r("./page-breaks-xform"),o=r("../list-xform");s.exports=class extends o{constructor(){super({tag:"rowBreaks",count:!0,childXform:new i})}render(l,d){if(d&&d.length){l.openNode(this.tag,this.$),this.count&&(l.addAttribute(this.$count,d.length),l.addAttribute("manualBreakCount",d.length));const{childXform:c}=this;d.forEach(u=>{c.render(l,u)}),l.closeNode()}else this.empty&&l.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(r,s,a){const i=r("../base-xform"),o=r("../../../utils/utils"),l=r("./cell-xform");s.exports=class extends i{constructor(d){super(),this.maxItems=d&&d.maxItems,this.map={c:new l}}get tag(){return"row"}prepare(d,c){const u=c.styles.addStyleModel(d.style);u&&(d.styleId=u);const h=this.map.c;d.cells.forEach(f=>{h.prepare(f,c)})}render(d,c,u){d.openNode("row"),d.addAttribute("r",c.number),c.height&&(d.addAttribute("ht",c.height),d.addAttribute("customHeight","1")),c.hidden&&d.addAttribute("hidden","1"),c.min>0&&c.max>0&&c.min<=c.max&&d.addAttribute("spans",`${c.min}:${c.max}`),c.styleId&&(d.addAttribute("s",c.styleId),d.addAttribute("customFormat","1")),d.addAttribute("x14ac:dyDescent","0.25"),c.outlineLevel&&d.addAttribute("outlineLevel",c.outlineLevel),c.collapsed&&d.addAttribute("collapsed","1");const h=this.map.c;c.cells.forEach(f=>{h.render(d,f,u)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;if(d.name==="row"){this.numRowsSeen+=1;const c=d.attributes.spans?d.attributes.spans.split(":").map(h=>parseInt(h,10)):[void 0,void 0],u=this.model={number:parseInt(d.attributes.r,10),min:c[0],max:c[1],cells:[]};return d.attributes.s&&(u.styleId=parseInt(d.attributes.s,10)),o.parseBoolean(d.attributes.hidden)&&(u.hidden=!0),o.parseBoolean(d.attributes.bestFit)&&(u.bestFit=!0),d.attributes.ht&&(u.height=parseFloat(d.attributes.ht)),d.attributes.outlineLevel&&(u.outlineLevel=parseInt(d.attributes.outlineLevel,10)),o.parseBoolean(d.attributes.collapsed)&&(u.collapsed=!0),!0}return this.parser=this.map[d.name],!!this.parser&&(this.parser.parseOpen(d),!0)}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser){if(!this.parser.parseClose(d)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(d,c){d.style=d.styleId?c.styles.getStyleModel(d.styleId):{},d.styleId!==void 0&&(d.styleId=void 0);const u=this.map.c;d.cells.forEach(h=>{u.reconcile(h,c)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../base-xform");s.exports=class extends o{get tag(){return"sheetFormatPr"}render(l,d){if(d){const c={defaultRowHeight:d.defaultRowHeight,outlineLevelRow:d.outlineLevelRow,outlineLevelCol:d.outlineLevelCol,"x14ac:dyDescent":d.dyDescent};d.defaultColWidth&&(c.defaultColWidth=d.defaultColWidth),d.defaultRowHeight&&d.defaultRowHeight===15||(c.customHeight="1"),i.some(c,u=>u!==void 0)&&l.leafNode("sheetFormatPr",c)}}parseOpen(l){return l.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(l.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(l.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(l.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(l.attributes.outlineLevelCol||"0",10)},l.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(l.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(r,s,a){const i=r("../base-xform"),o=r("../style/color-xform"),l=r("./page-setup-properties-xform"),d=r("./outline-properties-xform");s.exports=class extends i{constructor(){super(),this.map={tabColor:new o("tabColor"),pageSetUpPr:new l,outlinePr:new d}}get tag(){return"sheetPr"}render(c,u){if(u){c.addRollback(),c.openNode("sheetPr");let h=!1;h=this.map.tabColor.render(c,u.tabColor)||h,h=this.map.pageSetUpPr.render(c,u.pageSetup)||h,h=this.map.outlinePr.render(c,u.outlineProperties)||h,h?(c.closeNode(),c.commit()):c.rollback()}}parseOpen(c){return this.parser?(this.parser.parseOpen(c),!0):c.name===this.tag?(this.reset(),!0):!!this.map[c.name]&&(this.parser=this.map[c.name],this.parser.parseOpen(c),!0)}parseText(c){return!!this.parser&&(this.parser.parseText(c),!0)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../base-xform");function l(c,u){return c?u:void 0}function d(c,u){return c===u||void 0}s.exports=class extends o{get tag(){return"sheetProtection"}render(c,u){if(u){const h={sheet:l(u.sheet,"1"),selectLockedCells:u.selectLockedCells===!1?"1":void 0,selectUnlockedCells:u.selectUnlockedCells===!1?"1":void 0,formatCells:l(u.formatCells,"0"),formatColumns:l(u.formatColumns,"0"),formatRows:l(u.formatRows,"0"),insertColumns:l(u.insertColumns,"0"),insertRows:l(u.insertRows,"0"),insertHyperlinks:l(u.insertHyperlinks,"0"),deleteColumns:l(u.deleteColumns,"0"),deleteRows:l(u.deleteRows,"0"),sort:l(u.sort,"0"),autoFilter:l(u.autoFilter,"0"),pivotTables:l(u.pivotTables,"0")};u.sheet&&(h.algorithmName=u.algorithmName,h.hashValue=u.hashValue,h.saltValue=u.saltValue,h.spinCount=u.spinCount,h.objects=l(u.objects===!1,"1"),h.scenarios=l(u.scenarios===!1,"1")),i.some(h,f=>f!==void 0)&&c.leafNode(this.tag,h)}}parseOpen(c){switch(c.name){case this.tag:return this.model={sheet:d(c.attributes.sheet,"1"),objects:c.attributes.objects!=="1"&&void 0,scenarios:c.attributes.scenarios!=="1"&&void 0,selectLockedCells:c.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:c.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:d(c.attributes.formatCells,"0"),formatColumns:d(c.attributes.formatColumns,"0"),formatRows:d(c.attributes.formatRows,"0"),insertColumns:d(c.attributes.insertColumns,"0"),insertRows:d(c.attributes.insertRows,"0"),insertHyperlinks:d(c.attributes.insertHyperlinks,"0"),deleteColumns:d(c.attributes.deleteColumns,"0"),deleteRows:d(c.attributes.deleteRows,"0"),sort:d(c.attributes.sort,"0"),autoFilter:d(c.attributes.autoFilter,"0"),pivotTables:d(c.attributes.pivotTables,"0")},c.attributes.algorithmName&&(this.model.algorithmName=c.attributes.algorithmName,this.model.hashValue=c.attributes.hashValue,this.model.saltValue=c.attributes.saltValue,this.model.spinCount=parseInt(c.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(r,s,a){const i=r("../../../utils/col-cache"),o=r("../base-xform"),l={frozen:"frozen",frozenSplit:"frozen",split:"split"};s.exports=class extends o{get tag(){return"sheetView"}prepare(d){switch(d.state){case"frozen":case"split":break;default:d.state="normal"}}render(d,c){d.openNode("sheetView",{workbookViewId:c.workbookViewId||0});const u=function(g,x,v){v&&d.addAttribute(g,x)};let h,f,m,p;switch(u("rightToLeft","1",c.rightToLeft===!0),u("tabSelected","1",c.tabSelected),u("showRuler","0",c.showRuler===!1),u("showRowColHeaders","0",c.showRowColHeaders===!1),u("showGridLines","0",c.showGridLines===!1),u("zoomScale",c.zoomScale,c.zoomScale),u("zoomScaleNormal",c.zoomScaleNormal,c.zoomScaleNormal),u("view",c.style,c.style),c.state){case"frozen":f=c.xSplit||0,m=c.ySplit||0,h=c.topLeftCell||i.getAddress(m+1,f+1).address,p=(c.xSplit&&c.ySplit?"bottomRight":c.xSplit&&"topRight")||"bottomLeft",d.leafNode("pane",{xSplit:c.xSplit||void 0,ySplit:c.ySplit||void 0,topLeftCell:h,activePane:p,state:"frozen"}),d.leafNode("selection",{pane:p,activeCell:c.activeCell,sqref:c.activeCell});break;case"split":c.activePane==="topLeft"&&(c.activePane=void 0),d.leafNode("pane",{xSplit:c.xSplit||void 0,ySplit:c.ySplit||void 0,topLeftCell:c.topLeftCell,activePane:c.activePane}),d.leafNode("selection",{pane:c.activePane,activeCell:c.activeCell,sqref:c.activeCell});break;case"normal":c.activeCell&&d.leafNode("selection",{activeCell:c.activeCell,sqref:c.activeCell})}d.closeNode()}parseOpen(d){switch(d.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(d.attributes.workbookViewId,10),rightToLeft:d.attributes.rightToLeft==="1",tabSelected:d.attributes.tabSelected==="1",showRuler:d.attributes.showRuler!=="0",showRowColHeaders:d.attributes.showRowColHeaders!=="0",showGridLines:d.attributes.showGridLines!=="0",zoomScale:parseInt(d.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(d.attributes.zoomScaleNormal||"100",10),style:d.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(d.attributes.xSplit||"0",10),ySplit:parseInt(d.attributes.ySplit||"0",10),topLeftCell:d.attributes.topLeftCell,activePane:d.attributes.activePane||"topLeft",state:d.attributes.state},!0;case"selection":{const c=d.attributes.pane||"topLeft";return this.selections[c]={pane:c,activeCell:d.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(d){let c,u;switch(d){case"sheetView":return this.sheetView&&this.pane?(c=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:l[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(c.activePane=this.pane.activePane),u=this.selections[this.pane.activePane],u&&u.activeCell&&(c.activeCell=u.activeCell),this.sheetView.style&&(c.style=this.sheetView.style)):(c=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},u=this.selections.topLeft,u&&u.activeCell&&(c.activeCell=u.activeCell),this.sheetView.style&&(c.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"tablePart"}render(o,l){l&&o.leafNode(this.tag,{"r:id":l.rId})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../../../utils/col-cache"),l=r("../../../utils/xml-stream"),d=r("../../rel-type"),c=r("./merges"),u=r("../base-xform"),h=r("../list-xform"),f=r("./row-xform"),m=r("./col-xform"),p=r("./dimension-xform"),g=r("./hyperlink-xform"),x=r("./merge-cell-xform"),v=r("./data-validations-xform"),y=r("./sheet-properties-xform"),b=r("./sheet-format-properties-xform"),j=r("./sheet-view-xform"),T=r("./sheet-protection-xform"),O=r("./page-margins-xform"),R=r("./page-setup-xform"),D=r("./print-options-xform"),B=r("./auto-filter-xform"),q=r("./picture-xform"),Y=r("./drawing-xform"),G=r("./table-part-xform"),I=r("./row-breaks-xform"),F=r("./header-footer-xform"),S=r("./cf/conditional-formattings-xform"),E=r("./ext-lst-xform"),N=(k,M)=>{if(!M||!M.length)return k;if(!k||!k.length)return M;const U={},$={};return k.forEach(X=>{U[X.ref]=X,X.rules.forEach(Z=>{const{x14Id:re}=Z;re&&($[re]=Z)})}),M.forEach(X=>{X.rules.forEach(Z=>{const re=$[Z.x14Id];re?((W,J)=>{Object.keys(J).forEach(V=>{const H=W[V],ee=J[V];H===void 0&&ee!==void 0&&(W[V]=ee)})})(re,Z):U[X.ref]?U[X.ref].rules.push(Z):k.push({ref:X.ref,rules:[Z]})})}),k};class C extends u{constructor(M){super();const{maxRows:U,maxCols:$,ignoreNodes:X}=M||{};this.ignoreNodes=X||[],this.map={sheetPr:new y,dimension:new p,sheetViews:new h({tag:"sheetViews",count:!1,childXform:new j}),sheetFormatPr:new b,cols:new h({tag:"cols",count:!1,childXform:new m}),sheetData:new h({tag:"sheetData",count:!1,empty:!0,childXform:new f({maxItems:$}),maxItems:U}),autoFilter:new B,mergeCells:new h({tag:"mergeCells",count:!0,childXform:new x}),rowBreaks:new I,hyperlinks:new h({tag:"hyperlinks",count:!1,childXform:new g}),pageMargins:new O,dataValidations:new v,pageSetup:new R,headerFooter:new F,printOptions:new D,picture:new q,drawing:new Y,sheetProtection:new T,tableParts:new h({tag:"tableParts",count:!0,childXform:new G}),conditionalFormatting:new S,extLst:new E}}prepare(M,U){U.merges=new c,M.hyperlinks=U.hyperlinks=[],M.comments=U.comments=[],U.formulae={},U.siFormulae=0,this.map.cols.prepare(M.cols,U),this.map.sheetData.prepare(M.rows,U),this.map.conditionalFormatting.prepare(M.conditionalFormattings,U),M.mergeCells=U.merges.mergeCells;const $=M.rels=[];function X(W){return"rId"+(W.length+1)}if(M.hyperlinks.forEach(W=>{const J=X($);W.rId=J,$.push({Id:J,Type:d.Hyperlink,Target:W.target,TargetMode:"External"})}),M.comments.length>0){const W={Id:X($),Type:d.Comments,Target:`../comments${M.id}.xml`};$.push(W);const J={Id:X($),Type:d.VmlDrawing,Target:`../drawings/vmlDrawing${M.id}.vml`};$.push(J),M.comments.forEach(V=>{V.refAddress=o.decodeAddress(V.ref)}),U.commentRefs.push({commentName:"comments"+M.id,vmlDrawing:"vmlDrawing"+M.id})}const Z=[];let re;M.media.forEach(W=>{if(W.type==="background"){const J=X($);re=U.media[W.imageId],$.push({Id:J,Type:d.Image,Target:`../media/${re.name}.${re.extension}`}),M.background={rId:J},M.image=U.media[W.imageId]}else if(W.type==="image"){let{drawing:J}=M;re=U.media[W.imageId],J||(J=M.drawing={rId:X($),name:"drawing"+ ++U.drawingsCount,anchors:[],rels:[]},U.drawings.push(J),$.push({Id:J.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${J.name}.xml`}));let V=this.preImageId===W.imageId?Z[W.imageId]:Z[J.rels.length];V||(V=X(J.rels),Z[J.rels.length]=V,J.rels.push({Id:V,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${re.name}.${re.extension}`}));const H={picture:{rId:V},range:W.range};if(W.hyperlinks&&W.hyperlinks.hyperlink){const ee=X(J.rels);Z[J.rels.length]=ee,H.picture.hyperlinks={tooltip:W.hyperlinks.tooltip,rId:ee},J.rels.push({Id:ee,Type:d.Hyperlink,Target:W.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=W.imageId,J.anchors.push(H)}}),M.tables.forEach(W=>{const J=X($);W.rId=J,$.push({Id:J,Type:d.Table,Target:"../tables/"+W.target}),W.columns.forEach(V=>{const{style:H}=V;H&&(V.dxfId=U.styles.addDxfStyle(H))})}),this.map.extLst.prepare(M,U)}render(M,U){M.openXml(l.StdDocAttributes),M.openNode("worksheet",C.WORKSHEET_ATTRIBUTES);const $=U.properties?{defaultRowHeight:U.properties.defaultRowHeight,dyDescent:U.properties.dyDescent,outlineLevelCol:U.properties.outlineLevelCol,outlineLevelRow:U.properties.outlineLevelRow}:void 0;U.properties&&U.properties.defaultColWidth&&($.defaultColWidth=U.properties.defaultColWidth);const X={outlineProperties:U.properties&&U.properties.outlineProperties,tabColor:U.properties&&U.properties.tabColor,pageSetup:U.pageSetup&&U.pageSetup.fitToPage?{fitToPage:U.pageSetup.fitToPage}:void 0},Z=U.pageSetup&&U.pageSetup.margins,re={showRowColHeaders:U.pageSetup&&U.pageSetup.showRowColHeaders,showGridLines:U.pageSetup&&U.pageSetup.showGridLines,horizontalCentered:U.pageSetup&&U.pageSetup.horizontalCentered,verticalCentered:U.pageSetup&&U.pageSetup.verticalCentered},W=U.sheetProtection;this.map.sheetPr.render(M,X),this.map.dimension.render(M,U.dimensions),this.map.sheetViews.render(M,U.views),this.map.sheetFormatPr.render(M,$),this.map.cols.render(M,U.cols),this.map.sheetData.render(M,U.rows),this.map.sheetProtection.render(M,W),this.map.autoFilter.render(M,U.autoFilter),this.map.mergeCells.render(M,U.mergeCells),this.map.conditionalFormatting.render(M,U.conditionalFormattings),this.map.dataValidations.render(M,U.dataValidations),this.map.hyperlinks.render(M,U.hyperlinks),this.map.printOptions.render(M,re),this.map.pageMargins.render(M,Z),this.map.pageSetup.render(M,U.pageSetup),this.map.headerFooter.render(M,U.headerFooter),this.map.rowBreaks.render(M,U.rowBreaks),this.map.drawing.render(M,U.drawing),this.map.picture.render(M,U.background),this.map.tableParts.render(M,U.tables),this.map.extLst.render(M,U),U.rels&&U.rels.forEach(J=>{J.Type===d.VmlDrawing&&M.leafNode("legacyDrawing",{"r:id":J.Id})}),M.closeNode()}parseOpen(M){return this.parser?(this.parser.parseOpen(M),!0):M.name==="worksheet"?(i.each(this.map,U=>{U.reset()}),!0):(this.map[M.name]&&!this.ignoreNodes.includes(M.name)&&(this.parser=this.map[M.name],this.parser.parseOpen(M)),!0)}parseText(M){this.parser&&this.parser.parseText(M)}parseClose(M){if(this.parser)return this.parser.parseClose(M)||(this.parser=void 0),!0;switch(M){case"worksheet":{const U=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(U.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(U.outlineProperties=this.map.sheetPr.model.outlineProperties);const $={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},X=Object.assign($,this.map.pageSetup.model,this.map.printOptions.model),Z=N(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:U,views:this.map.sheetViews.model,pageSetup:X,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:Z},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(M,U){const $=(M.relationships||[]).reduce((Z,re)=>{if(Z[re.Id]=re,re.Type===d.Comments&&(M.comments=U.comments[re.Target].comments),re.Type===d.VmlDrawing&&M.comments&&M.comments.length){const W=U.vmlDrawings[re.Target].comments;M.comments.forEach((J,V)=>{J.note=Object.assign({},J.note,W[V])})}return Z},{});if(U.commentsMap=(M.comments||[]).reduce((Z,re)=>(re.ref&&(Z[re.ref]=re),Z),{}),U.hyperlinkMap=(M.hyperlinks||[]).reduce((Z,re)=>(re.rId&&(Z[re.address]=$[re.rId].Target),Z),{}),U.formulae={},M.rows=M.rows&&M.rows.filter(Boolean)||[],M.rows.forEach(Z=>{Z.cells=Z.cells&&Z.cells.filter(Boolean)||[]}),this.map.cols.reconcile(M.cols,U),this.map.sheetData.reconcile(M.rows,U),this.map.conditionalFormatting.reconcile(M.conditionalFormattings,U),M.media=[],M.drawing){const Z=$[M.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(Z){const re=Z[1];U.drawings[re].anchors.forEach(W=>{if(W.medium){const J={type:"image",imageId:W.medium.index,range:W.range,hyperlinks:W.picture.hyperlinks};M.media.push(J)}})}}const X=M.background&&$[M.background.rId];if(X){const Z=X.Target.split("/media/")[1],re=U.mediaIndex&&U.mediaIndex[Z];re!==void 0&&M.media.push({type:"background",imageId:re})}M.tables=(M.tables||[]).map(Z=>{const re=$[Z.rId];return U.tables[re.Target]}),delete M.relationships,delete M.hyperlinks,delete M.comments}}C.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},s.exports=C},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr}render(o,l){l&&(o.openNode(this.tag),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this._format=o.format||function(l){try{return Number.isNaN(l.getTime())?"":l.toISOString()}catch{return""}},this._parse=o.parse||function(l){return new Date(l)}}render(o,l){l&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,this._format(l)):o.writeText(this._format(l)),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=this._parse(o.attributes[this.attr]):this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this.zero=o.zero}render(o,l){(l||this.zero)&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,l):o.writeText(l),o.closeNode())}parseOpen(o){return o.name===this.tag&&(this.attr?this.model=parseInt(o.attributes[this.attr],10):this.text=[],!0)}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs}render(o,l){l!==void 0&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,l):o.writeText(l),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=o.attributes[this.attr]:this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(r,s,a){const i=r("./base-xform"),o=r("../../utils/xml-stream");s.exports=class extends i{constructor(l){super(),this._model=l}render(l){if(!this._xml){const d=new o;(function c(u,h){u.openNode(h.tag,h.$),h.c&&h.c.forEach(f=>{c(u,f)}),h.t&&u.writeText(h.t),u.closeNode()})(d,this._model),this._xml=d.xml}l.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(l){switch(l){case this._model.tag:return!1;default:return!0}}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(r,s,a){const i=r("./text-xform"),o=r("./rich-text-xform"),l=r("../base-xform");s.exports=class extends l{constructor(){super(),this.map={r:new o,t:new i}}get tag(){return"rPh"}render(d,c){if(d.openNode(this.tag,{sb:c.sb||0,eb:c.eb||0}),c&&c.hasOwnProperty("richText")&&c.richText){const{r:u}=this.map;c.richText.forEach(h=>{u.render(d,h)})}else c&&this.map.t.render(d,c.text);d.closeNode()}parseOpen(d){const{name:c}=d;return this.parser?(this.parser.parseOpen(d),!0):c===this.tag?(this.model={sb:parseInt(d.attributes.sb,10),eb:parseInt(d.attributes.eb,10)},!0):(this.parser=this.map[c],!!this.parser&&(this.parser.parseOpen(d),!0))}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser){if(!this.parser.parseClose(d)){switch(d){case"r":{let c=this.model.richText;c||(c=this.model.richText=[]),c.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(d){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(r,s,a){const i=r("./text-xform"),o=r("../style/font-xform"),l=r("../base-xform");class d extends l{constructor(u){super(),this.model=u}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new i)}get fontXform(){return this._fontXform||(this._fontXform=new o(d.FONT_OPTIONS))}render(u,h){h=h||this.model,u.openNode("r"),h.font&&this.fontXform.render(u,h.font),this.textXform.render(u,h.text),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(u),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){switch(u){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}}d.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},s.exports=d},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(r,s,a){const i=r("./text-xform"),o=r("./rich-text-xform"),l=r("./phonetic-text-xform"),d=r("../base-xform");s.exports=class extends d{constructor(c){super(),this.model=c,this.map={r:new o,t:new i,rPh:new l}}get tag(){return"si"}render(c,u){c.openNode(this.tag),u&&u.hasOwnProperty("richText")&&u.richText?u.richText.length?u.richText.forEach(h=>{this.map.r.render(c,h)}):this.map.t.render(c,""):u!=null&&this.map.t.render(c,u),c.closeNode()}parseOpen(c){const{name:u}=c;return this.parser?(this.parser.parseOpen(c),!0):u===this.tag?(this.model={},!0):(this.parser=this.map[u],!!this.parser&&(this.parser.parseOpen(c),!0))}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser){if(!this.parser.parseClose(c)){switch(c){case"r":{let u=this.model.richText;u||(u=this.model.richText=[]),u.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(c){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),l=r("./shared-string-xform");s.exports=class extends o{constructor(d){super(),this.model=d||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new l)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(d){return this.model.values[d]}add(d){return d.richText?this.addRichText(d):this.addText(d)}addText(d){let c=this.hash[d];return c===void 0&&(c=this.hash[d]=this.model.values.length,this.model.values.push(d)),this.model.count++,c}addRichText(d){const c=this.sharedStringXform.toXml(d);let u=this.rich[c];return u===void 0&&(u=this.rich[c]=this.model.values.length,this.model.values.push(d)),this.model.count++,u}render(d,c){c=c||this._values,d.openXml(i.StdDocAttributes),d.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:c.count,uniqueCount:c.values.length});const u=this.sharedStringXform;c.values.forEach(h=>{u.render(d,h)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(d),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(d))}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(d){case"sst":return!1;default:throw new Error("Unexpected xml node in parseClose: "+d)}}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"t"}render(o,l){o.openNode("t"),/^\s|\n|\s$/.test(l)&&o.addAttribute("xml:space","preserve"),o.writeText(l),o.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(o,l)=>String.fromCharCode(parseInt(l,16)))}parseOpen(o){switch(o.name){case"t":return this._text=[],!0;default:return!1}}parseText(o){this._text.push(o)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(r,s,a){const i=r("../../../doc/enums"),o=r("../../../utils/utils"),l=r("../base-xform"),d={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((u,h)=>(u[h]=!0,u),{}),horizontal(u){return this.horizontalValues[u]?u:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((u,h)=>(u[h]=!0,u),{}),vertical(u){return u==="middle"?"center":this.verticalValues[u]?u:void 0},wrapText:u=>!!u||void 0,shrinkToFit:u=>!!u||void 0,textRotation(u){switch(u){case"vertical":return u;default:return(u=o.validInt(u))>=-90&&u<=90?u:void 0}},indent:u=>(u=o.validInt(u),Math.max(0,u)),readingOrder(u){switch(u){case"ltr":return i.ReadingOrder.LeftToRight;case"rtl":return i.ReadingOrder.RightToLeft;default:return}}},c={toXml(u){if(u=d.textRotation(u)){if(u==="vertical")return 255;const h=Math.round(u);if(h>=0&&h<=90)return h;if(h<0&&h>=-90)return 90-h}},toModel(u){const h=o.validInt(u);if(h!==void 0){if(h===255)return"vertical";if(h>=0&&h<=90)return h;if(h>90&&h<=180)return 90-h}}};s.exports=class extends l{get tag(){return"alignment"}render(u,h){u.addRollback(),u.openNode("alignment");let f=!1;function m(p,g){g&&(u.addAttribute(p,g),f=!0)}m("horizontal",d.horizontal(h.horizontal)),m("vertical",d.vertical(h.vertical)),m("wrapText",!!d.wrapText(h.wrapText)&&"1"),m("shrinkToFit",!!d.shrinkToFit(h.shrinkToFit)&&"1"),m("indent",d.indent(h.indent)),m("textRotation",c.toXml(h.textRotation)),m("readingOrder",d.readingOrder(h.readingOrder)),u.closeNode(),f?u.commit():u.rollback()}parseOpen(u){const h={};let f=!1;function m(p,g,x){p&&(h[g]=x,f=!0)}m(u.attributes.horizontal,"horizontal",u.attributes.horizontal),m(u.attributes.vertical,"vertical",u.attributes.vertical==="center"?"middle":u.attributes.vertical),m(u.attributes.wrapText,"wrapText",o.parseBoolean(u.attributes.wrapText)),m(u.attributes.shrinkToFit,"shrinkToFit",o.parseBoolean(u.attributes.shrinkToFit)),m(u.attributes.indent,"indent",parseInt(u.attributes.indent,10)),m(u.attributes.textRotation,"textRotation",c.toModel(u.attributes.textRotation)),m(u.attributes.readingOrder,"readingOrder",u.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=f?h:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(r,s,a){const i=r("../base-xform"),o=r("../../../utils/utils"),l=r("./color-xform");class d extends i{constructor(u){super(),this.name=u,this.map={color:new l}}get tag(){return this.name}render(u,h,f){const m=h&&h.color||f||this.defaultColor;u.openNode(this.name),h&&h.style&&(u.addAttribute("style",h.style),m&&this.map.color.render(u,m)),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.name:{const{style:h}=u.attributes;return this.model=h?{style:h}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):(u===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(u){return d.validStyleValues[u]}}d.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((c,u)=>(c[u]=!0,c),{}),s.exports=class extends i{constructor(){super(),this.map={top:new d("top"),left:new d("left"),bottom:new d("bottom"),right:new d("right"),diagonal:new d("diagonal")}}render(c,u){const{color:h}=u;function f(m,p){m&&!m.color&&u.color&&(m={...m,color:u.color}),p.render(c,m,h)}c.openNode("border"),u.diagonal&&u.diagonal.style&&(u.diagonal.up&&c.addAttribute("diagonalUp","1"),u.diagonal.down&&c.addAttribute("diagonalDown","1")),f(u.left,this.map.left),f(u.right,this.map.right),f(u.top,this.map.top),f(u.bottom,this.map.bottom),f(u.diagonal,this.map.diagonal),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"border":return this.reset(),this.diagonalUp=o.parseBoolean(c.attributes.diagonalUp),this.diagonalDown=o.parseBoolean(c.attributes.diagonalDown),!0;default:return this.parser=this.map[c.name],!!this.parser&&(this.parser.parseOpen(c),!0)}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;if(c==="border"){const u=this.model={},h=function(f,m,p){m&&(p&&Object.assign(m,p),u[f]=m)};h("left",this.map.left.model),h("right",this.map.right.model),h("top",this.map.top.model),h("bottom",this.map.bottom.model),h("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.name=o||"color"}get tag(){return this.name}render(o,l){return!!l&&(o.openNode(this.name),l.argb?o.addAttribute("rgb",l.argb):l.theme!==void 0?(o.addAttribute("theme",l.theme),l.tint!==void 0&&o.addAttribute("tint",l.tint)):l.indexed!==void 0?o.addAttribute("indexed",l.indexed):o.addAttribute("auto","1"),o.closeNode(),!0)}parseOpen(o){return o.name===this.name&&(o.attributes.rgb?this.model={argb:o.attributes.rgb}:o.attributes.theme?(this.model={theme:parseInt(o.attributes.theme,10)},o.attributes.tint&&(this.model.tint=parseFloat(o.attributes.tint))):o.attributes.indexed?this.model={indexed:parseInt(o.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(r,s,a){const i=r("../base-xform"),o=r("./alignment-xform"),l=r("./border-xform"),d=r("./fill-xform"),c=r("./font-xform"),u=r("./numfmt-xform"),h=r("./protection-xform");s.exports=class extends i{constructor(){super(),this.map={alignment:new o,border:new l,fill:new d,font:new c,numFmt:new u,protection:new h}}get tag(){return"dxf"}render(f,m){if(f.openNode(this.tag),m.font&&this.map.font.render(f,m.font),m.numFmt&&m.numFmtId){const p={id:m.numFmtId,formatCode:m.numFmt};this.map.numFmt.render(f,p)}m.fill&&this.map.fill.render(f,m.fill),m.alignment&&this.map.alignment.render(f,m.alignment),m.border&&this.map.border.render(f,m.border),m.protection&&this.map.protection.render(f,m.protection),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f),!0}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return this.parser?(this.parser.parseClose(f)||(this.parser=void 0),!0):f!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(r,s,a){const i=r("../base-xform"),o=r("./color-xform");class l extends i{constructor(){super(),this.map={color:new o}}get tag(){return"stop"}render(f,m){f.openNode("stop"),f.addAttribute("position",m.position),this.map.color.render(f,m.color),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"stop":return this.model={position:parseFloat(f.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(f),!0;default:return!1}}parseText(){}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class d extends i{constructor(){super(),this.map={fgColor:new o("fgColor"),bgColor:new o("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(f,m){f.openNode("patternFill"),f.addAttribute("patternType",m.pattern),m.fgColor&&this.map.fgColor.render(f,m.fgColor),m.bgColor&&this.map.bgColor.render(f,m.bgColor),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"patternFill":return this.model={type:"pattern",pattern:f.attributes.patternType},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.parser.model&&(this.model[f]=this.parser.model),this.parser=void 0),!0)}}class c extends i{constructor(){super(),this.map={stop:new l}}get name(){return"gradient"}get tag(){return"gradientFill"}render(f,m){switch(f.openNode("gradientFill"),m.gradient){case"angle":f.addAttribute("degree",m.degree);break;case"path":f.addAttribute("type","path"),m.center.left&&(f.addAttribute("left",m.center.left),m.center.right===void 0&&f.addAttribute("right",m.center.left)),m.center.right&&f.addAttribute("right",m.center.right),m.center.top&&(f.addAttribute("top",m.center.top),m.center.bottom===void 0&&f.addAttribute("bottom",m.center.top)),m.center.bottom&&f.addAttribute("bottom",m.center.bottom)}const p=this.map.stop;m.stops.forEach(g=>{p.render(f,g)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"gradientFill":{const m=this.model={stops:[]};return f.attributes.degree?(m.gradient="angle",m.degree=parseInt(f.attributes.degree,10)):f.attributes.type==="path"&&(m.gradient="path",m.center={left:f.attributes.left?parseFloat(f.attributes.left):0,top:f.attributes.top?parseFloat(f.attributes.top):0},f.attributes.right!==f.attributes.left&&(m.center.right=f.attributes.right?parseFloat(f.attributes.right):0),f.attributes.bottom!==f.attributes.top&&(m.center.bottom=f.attributes.bottom?parseFloat(f.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(f),!0;default:return!1}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class u extends i{constructor(){super(),this.map={patternFill:new d,gradientFill:new c}}get tag(){return"fill"}render(f,m){switch(f.addRollback(),f.openNode("fill"),m.type){case"pattern":this.map.patternFill.render(f,m);break;case"gradient":this.map.gradientFill.render(f,m);break;default:return void f.rollback()}f.closeNode(),f.commit()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"fill":return this.model={},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(f){return u.validPatternValues[f]}}u.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((h,f)=>(h[f]=!0,h),{}),u.StopXform=l,u.PatternFillXform=d,u.GradientFillXform=c,s.exports=u},{"../base-xform":32,"./color-xform":128}],131:[function(r,s,a){const i=r("./color-xform"),o=r("../simple/boolean-xform"),l=r("../simple/integer-xform"),d=r("../simple/string-xform"),c=r("./underline-xform"),u=r("../../../utils/under-dash"),h=r("../base-xform");class f extends h{constructor(p){super(),this.options=p||f.OPTIONS,this.map={b:{prop:"bold",xform:new o({tag:"b",attr:"val"})},i:{prop:"italic",xform:new o({tag:"i",attr:"val"})},u:{prop:"underline",xform:new c},charset:{prop:"charset",xform:new l({tag:"charset",attr:"val"})},color:{prop:"color",xform:new i},condense:{prop:"condense",xform:new o({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new o({tag:"extend",attr:"val"})},family:{prop:"family",xform:new l({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new o({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new d({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new d({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new o({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new o({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new l({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new d({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(p,g){const{map:x}=this;p.openNode(this.options.tagName),u.each(this.map,(v,y)=>{x[y].xform.render(p,g[v.prop])}),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;if(this.map[p.name])return this.parser=this.map[p.name].xform,this.parser.parseOpen(p);switch(p.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){if(this.parser&&!this.parser.parseClose(p)){const g=this.map[p];return this.parser.model&&(this.model[g.prop]=this.parser.model),this.parser=void 0,!0}switch(p){case this.options.tagName:return!1;default:return!0}}}f.OPTIONS={tagName:"font",fontNameTag:"name"},s.exports=f},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../../defaultnumformats"),l=r("../base-xform"),d=function(){const u={};return i.each(o,(h,f)=>{h.f&&(u[h.f]=parseInt(f,10))}),u}();class c extends l{constructor(h,f){super(),this.id=h,this.formatCode=f}get tag(){return"numFmt"}render(h,f){h.leafNode("numFmt",{numFmtId:f.id,formatCode:f.formatCode})}parseOpen(h){switch(h.name){case"numFmt":return this.model={id:parseInt(h.attributes.numFmtId,10),formatCode:h.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}}c.getDefaultFmtId=function(u){return d[u]},c.getDefaultFmtCode=function(u){return o[u]&&o[u].f},s.exports=c},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(r,s,a){const i=r("../base-xform"),o={boolean:(l,d)=>l===void 0?d:l};s.exports=class extends i{get tag(){return"protection"}render(l,d){l.addRollback(),l.openNode("protection");let c=!1;function u(h,f){f!==void 0&&(l.addAttribute(h,f),c=!0)}u("locked",o.boolean(d.locked,!0)?void 0:"0"),u("hidden",o.boolean(d.hidden,!1)?"1":void 0),l.closeNode(),c?l.commit():l.rollback()}parseOpen(l){const d={locked:l.attributes.locked!=="0",hidden:l.attributes.hidden==="1"},c=!d.locked||d.hidden;this.model=c?d:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(r,s,a){const i=r("../base-xform"),o=r("./alignment-xform"),l=r("./protection-xform");s.exports=class extends i{constructor(d){super(),this.xfId=!(!d||!d.xfId),this.map={alignment:new o,protection:new l}}get tag(){return"xf"}render(d,c){d.openNode("xf",{numFmtId:c.numFmtId||0,fontId:c.fontId||0,fillId:c.fillId||0,borderId:c.borderId||0}),this.xfId&&d.addAttribute("xfId",c.xfId||0),c.numFmtId&&d.addAttribute("applyNumberFormat","1"),c.fontId&&d.addAttribute("applyFont","1"),c.fillId&&d.addAttribute("applyFill","1"),c.borderId&&d.addAttribute("applyBorder","1"),c.alignment&&d.addAttribute("applyAlignment","1"),c.protection&&d.addAttribute("applyProtection","1"),c.alignment&&this.map.alignment.render(d,c.alignment),c.protection&&this.map.protection.render(d,c.protection),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"xf":return this.model={numFmtId:parseInt(d.attributes.numFmtId,10),fontId:parseInt(d.attributes.fontId,10),fillId:parseInt(d.attributes.fillId,10),borderId:parseInt(d.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(d.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(d),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):d!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(r,s,a){const i=r("../../../doc/enums"),o=r("../../../utils/xml-stream"),l=r("../base-xform"),d=r("../static-xform"),c=r("../list-xform"),u=r("./font-xform"),h=r("./fill-xform"),f=r("./border-xform"),m=r("./numfmt-xform"),p=r("./style-xform"),g=r("./dxf-xform");class x extends l{constructor(y){super(),this.map={numFmts:new c({tag:"numFmts",count:!0,childXform:new m}),fonts:new c({tag:"fonts",count:!0,childXform:new u,$:{"x14ac:knownFonts":1}}),fills:new c({tag:"fills",count:!0,childXform:new h}),borders:new c({tag:"borders",count:!0,childXform:new f}),cellStyleXfs:new c({tag:"cellStyleXfs",count:!0,childXform:new p}),cellXfs:new c({tag:"cellXfs",count:!0,childXform:new p({xfId:!0})}),dxfs:new c({tag:"dxfs",always:!0,count:!0,childXform:new g}),numFmt:new m,font:new u,fill:new h,border:new f,style:new p({xfId:!0}),cellStyles:x.STATIC_XFORMS.cellStyles,tableStyles:x.STATIC_XFORMS.tableStyles,extLst:x.STATIC_XFORMS.extLst},y&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(y,b){b=b||this.model,y.openXml(o.StdDocAttributes),y.openNode("styleSheet",x.STYLESHEET_ATTRIBUTES),this.index?(b.numFmts&&b.numFmts.length&&(y.openNode("numFmts",{count:b.numFmts.length}),b.numFmts.forEach(j=>{y.writeXml(j)}),y.closeNode()),b.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),y.openNode("fonts",{count:b.fonts.length,"x14ac:knownFonts":1}),b.fonts.forEach(j=>{y.writeXml(j)}),y.closeNode(),y.openNode("fills",{count:b.fills.length}),b.fills.forEach(j=>{y.writeXml(j)}),y.closeNode(),y.openNode("borders",{count:b.borders.length}),b.borders.forEach(j=>{y.writeXml(j)}),y.closeNode(),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),y.openNode("cellXfs",{count:b.styles.length}),b.styles.forEach(j=>{y.writeXml(j)}),y.closeNode()):(this.map.numFmts.render(y,b.numFmts),this.map.fonts.render(y,b.fonts),this.map.fills.render(y,b.fills),this.map.borders.render(y,b.borders),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(y,b.styles)),x.STATIC_XFORMS.cellStyles.render(y),this.map.dxfs.render(y,b.dxfs),x.STATIC_XFORMS.tableStyles.render(y),x.STATIC_XFORMS.extLst.render(y),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"styleSheet":{this.model={};const b=(j,T)=>{T.model&&T.model.length&&(this.model[j]=T.model)};if(b("numFmts",this.map.numFmts),b("fonts",this.map.fonts),b("fills",this.map.fills),b("borders",this.map.borders),b("styles",this.map.cellXfs),b("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const j=this.index.numFmt;this.model.numFmts.forEach(T=>{j[T.id]=T.formatCode})}return!1}default:return!0}}addStyleModel(y,b){if(!y)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(y))return this.weakMap.get(y);const j={};if(b=b||i.ValueType.Number,y.numFmt)j.numFmtId=this._addNumFmtStr(y.numFmt);else switch(b){case i.ValueType.Number:j.numFmtId=this._addNumFmtStr("General");break;case i.ValueType.Date:j.numFmtId=this._addNumFmtStr("mm-dd-yy")}y.font&&(j.fontId=this._addFont(y.font)),y.border&&(j.borderId=this._addBorder(y.border)),y.fill&&(j.fillId=this._addFill(y.fill)),y.alignment&&(j.alignment=y.alignment),y.protection&&(j.protection=y.protection);const T=this._addStyle(j);return this.weakMap&&this.weakMap.set(y,T),T}getStyleModel(y){const b=this.model.styles[y];if(!b)return null;let j=this.index.model[y];if(j)return j;if(j=this.index.model[y]={},b.numFmtId){const O=this.index.numFmt[b.numFmtId]||m.getDefaultFmtCode(b.numFmtId);O&&(j.numFmt=O)}function T(O,R,D){if(D||D===0){const B=R[D];B&&(j[O]=B)}}return T("font",this.model.fonts,b.fontId),T("border",this.model.borders,b.borderId),T("fill",this.model.fills,b.fillId),b.alignment&&(j.alignment=b.alignment),b.protection&&(j.protection=b.protection),j}addDxfStyle(y){return y.numFmt&&(y.numFmtId=this._addNumFmtStr(y.numFmt)),this.model.dxfs.push(y),this.model.dxfs.length-1}getDxfStyle(y){return this.model.dxfs[y]}_addStyle(y){const b=this.map.style.toXml(y);let j=this.index.style[b];return j===void 0&&(j=this.index.style[b]=this.model.styles.length,this.model.styles.push(b)),j}_addNumFmtStr(y){let b=m.getDefaultFmtId(y);if(b!==void 0||(b=this.index.numFmt[y],b!==void 0))return b;b=this.index.numFmt[y]=164+this.model.numFmts.length;const j=this.map.numFmt.toXml({id:b,formatCode:y});return this.model.numFmts.push(j),b}_addFont(y){const b=this.map.font.toXml(y);let j=this.index.font[b];return j===void 0&&(j=this.index.font[b]=this.model.fonts.length,this.model.fonts.push(b)),j}_addBorder(y){const b=this.map.border.toXml(y);let j=this.index.border[b];return j===void 0&&(j=this.index.border[b]=this.model.borders.length,this.model.borders.push(b)),j}_addFill(y){const b=this.map.fill.toXml(y);let j=this.index.fill[b];return j===void 0&&(j=this.index.fill[b]=this.model.fills.length,this.model.fills.push(b)),j}}x.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},x.STATIC_XFORMS={cellStyles:new d({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new d({tag:"dxfs",$:{count:0}}),tableStyles:new d({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new d({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},x.Mock=class extends x{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(v){return v.autodrain(),Promise.resolve()}addStyleModel(v,y){switch(y){case i.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){const v={numFmtId:m.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(v)}return this._dateStyleId}getStyleModel(){return{}}},s.exports=x},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(r,s,a){const i=r("../base-xform");class o extends i{constructor(d){super(),this.model=d}get tag(){return"u"}render(d,c){if((c=c||this.model)===!0)d.leafNode("u");else{const u=o.Attributes[c];u&&d.leafNode("u",u)}}parseOpen(d){d.name==="u"&&(this.model=d.attributes.val||!0)}parseText(){}parseClose(){return!1}}o.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},s.exports=o},{"../base-xform":32}],137:[function(r,s,a){const i=r("../base-xform"),o=r("./filter-column-xform");s.exports=class extends i{constructor(){super(),this.map={filterColumn:new o}}get tag(){return"autoFilter"}prepare(l){l.columns.forEach((d,c)=>{this.map.filterColumn.prepare(d,{index:c})})}render(l,d){return l.openNode(this.tag,{ref:d.autoFilterRef}),d.columns.forEach(c=>{this.map.filterColumn.render(l,c)}),l.closeNode(),!0}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case this.tag:return this.model={autoFilterRef:l.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[l.name],this.parser)return this.parseOpen(l),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(l){case this.tag:return!1;default:throw new Error("Unexpected xml node in parseClose: "+l)}}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"customFilter"}render(o,l){o.leafNode(this.tag,{val:l.val,operator:l.operator})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val,operator:o.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(r,s,a){const i=r("../base-xform"),o=r("../list-xform"),l=r("./custom-filter-xform"),d=r("./filter-xform");s.exports=class extends i{constructor(){super(),this.map={customFilters:new o({tag:"customFilters",count:!1,empty:!0,childXform:new l}),filters:new o({tag:"filters",count:!1,empty:!0,childXform:new d})}}get tag(){return"filterColumn"}prepare(c,u){c.colId=u.index.toString()}render(c,u){return u.customFilters?(c.openNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),this.map.customFilters.render(c,u.customFilters),c.closeNode(),!0):(c.leafNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),!0)}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;const{attributes:u}=c;switch(c.name){case this.tag:return this.model={filterButton:u.hiddenButton==="0"},!0;default:if(this.parser=this.map[c.name],this.parser)return this.parseOpen(c),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(c))}}parseText(){}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model.customFilters=this.map.customFilters.model,!1;default:return!0}}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"filter"}render(o,l){o.leafNode(this.tag,{val:l.val})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"tableColumn"}prepare(o,l){o.id=l.index+1}render(o,l){return o.leafNode(this.tag,{id:l.id.toString(),name:l.name,totalsRowLabel:l.totalsRowLabel,totalsRowFunction:l.totalsRowFunction,dxfId:l.dxfId}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:l}=o;return this.model={name:l.name,totalsRowLabel:l.totalsRowLabel,totalsRowFunction:l.totalsRowFunction,dxfId:l.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"tableStyleInfo"}render(o,l){return o.leafNode(this.tag,{name:l.theme?l.theme:void 0,showFirstColumn:l.showFirstColumn?"1":"0",showLastColumn:l.showLastColumn?"1":"0",showRowStripes:l.showRowStripes?"1":"0",showColumnStripes:l.showColumnStripes?"1":"0"}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:l}=o;return this.model={theme:l.name?l.name:null,showFirstColumn:l.showFirstColumn==="1",showLastColumn:l.showLastColumn==="1",showRowStripes:l.showRowStripes==="1",showColumnStripes:l.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),l=r("../list-xform"),d=r("./auto-filter-xform"),c=r("./table-column-xform"),u=r("./table-style-info-xform");class h extends o{constructor(){super(),this.map={autoFilter:new d,tableColumns:new l({tag:"tableColumns",count:!0,empty:!0,childXform:new c}),tableStyleInfo:new u}}prepare(m,p){this.map.autoFilter.prepare(m),this.map.tableColumns.prepare(m.columns,p)}get tag(){return"table"}render(m,p){m.openXml(i.StdDocAttributes),m.openNode(this.tag,{...h.TABLE_ATTRIBUTES,id:p.id,name:p.name,displayName:p.displayName||p.name,ref:p.tableRef,totalsRowCount:p.totalsRow?"1":void 0,totalsRowShown:p.totalsRow?void 0:"1",headerRowCount:p.headerRow?"1":"0"}),this.map.autoFilter.render(m,p),this.map.tableColumns.render(m,p.columns),this.map.tableStyleInfo.render(m,p.style),m.closeNode()}parseOpen(m){if(this.parser)return this.parser.parseOpen(m),!0;const{name:p,attributes:g}=m;switch(p){case this.tag:this.reset(),this.model={name:g.name,displayName:g.displayName||g.name,tableRef:g.ref,totalsRow:g.totalsRowCount==="1",headerRow:g.headerRowCount==="1"};break;default:this.parser=this.map[m.name],this.parser&&this.parser.parseOpen(m)}return!0}parseText(m){this.parser&&this.parser.parseText(m)}parseClose(m){if(this.parser)return this.parser.parseClose(m)||(this.parser=void 0),!0;switch(m){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((p,g)=>{this.model.columns[g].filterButton=p.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(m,p){m.columns.forEach(g=>{g.dxfId!==void 0&&(g.style=p.styles.getDxfStyle(g.dxfId))})}}h.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},s.exports=h},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(r,s,a){(function(i,o){(function(){const l=r("fs"),d=r("jszip"),{PassThrough:c}=r("readable-stream"),u=r("../utils/zip-stream"),h=r("../utils/stream-buf"),f=r("../utils/utils"),m=r("../utils/xml-stream"),{bufferToString:p}=r("../utils/browser-buffer-decode"),g=r("./xform/style/styles-xform"),x=r("./xform/core/core-xform"),v=r("./xform/strings/shared-strings-xform"),y=r("./xform/core/relationships-xform"),b=r("./xform/core/content-types-xform"),j=r("./xform/core/app-xform"),T=r("./xform/book/workbook-xform"),O=r("./xform/sheet/worksheet-xform"),R=r("./xform/drawing/drawing-xform"),D=r("./xform/table/table-xform"),B=r("./xform/comment/comments-xform"),q=r("./xform/comment/vml-notes-xform"),Y=r("./xml/theme1");class G{constructor(F){this.workbook=F}async readFile(F,S){if(!await f.fs.exists(F))throw new Error("File not found: "+F);const E=l.createReadStream(F);try{const N=await this.read(E,S);return E.close(),N}catch(N){throw E.close(),N}}parseRels(F){return new y().parseStream(F)}parseWorkbook(F){return new T().parseStream(F)}parseSharedStrings(F){return new v().parseStream(F)}reconcile(F,S){const E=new T,N=new O(S),C=new R,k=new D;E.reconcile(F);const M={media:F.media,mediaIndex:F.mediaIndex};Object.keys(F.drawings).forEach(X=>{const Z=F.drawings[X],re=F.drawingRels[X];re&&(M.rels=re.reduce((W,J)=>(W[J.Id]=J,W),{}),(Z.anchors||[]).forEach(W=>{const J=W.picture&&W.picture.hyperlinks;J&&M.rels[J.rId]&&(J.hyperlink=M.rels[J.rId].Target,delete J.rId)}),C.reconcile(Z,M))});const U={styles:F.styles};Object.values(F.tables).forEach(X=>{k.reconcile(X,U)});const $={styles:F.styles,sharedStrings:F.sharedStrings,media:F.media,mediaIndex:F.mediaIndex,date1904:F.properties&&F.properties.date1904,drawings:F.drawings,comments:F.comments,tables:F.tables,vmlDrawings:F.vmlDrawings};F.worksheets.forEach(X=>{X.relationships=F.worksheetRels[X.sheetNo],N.reconcile(X,$)}),delete F.worksheetHash,delete F.worksheetRels,delete F.globalRels,delete F.sharedStrings,delete F.workbookRels,delete F.sheetDefs,delete F.styles,delete F.mediaIndex,delete F.drawings,delete F.drawingRels,delete F.vmlDrawings}async _processWorksheetEntry(F,S,E,N,C){const k=new O(N),M=await k.parseStream(F);M.sheetNo=E,S.worksheetHash[C]=M,S.worksheets.push(M)}async _processCommentEntry(F,S,E){const N=new B,C=await N.parseStream(F);S.comments[`../${E}.xml`]=C}async _processTableEntry(F,S,E){const N=new D,C=await N.parseStream(F);S.tables[`../tables/${E}.xml`]=C}async _processWorksheetRelsEntry(F,S,E){const N=new y,C=await N.parseStream(F);S.worksheetRels[E]=C}async _processMediaEntry(F,S,E){const N=E.lastIndexOf(".");if(N>=1){const C=E.substr(N+1),k=E.substr(0,N);await new Promise((M,U)=>{const $=new h;$.on("finish",()=>{S.mediaIndex[E]=S.media.length,S.mediaIndex[k]=S.media.length;const X={type:"image",name:k,extension:C,buffer:$.toBuffer()};S.media.push(X),M()}),F.on("error",X=>{U(X)}),F.pipe($)})}}async _processDrawingEntry(F,S,E){const N=new R,C=await N.parseStream(F);S.drawings[E]=C}async _processDrawingRelsEntry(F,S,E){const N=new y,C=await N.parseStream(F);S.drawingRels[E]=C}async _processVmlDrawingEntry(F,S,E){const N=new q,C=await N.parseStream(F);S.vmlDrawings[`../drawings/${E}.vml`]=C}async _processThemeEntry(F,S,E){await new Promise((N,C)=>{const k=new h;F.on("error",C),k.on("error",C),k.on("finish",()=>{S.themes[E]=k.read().toString(),N()}),F.pipe(k)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(F,S){!F[Symbol.asyncIterator]&&F.pipe&&(F=F.pipe(new c));const E=[];for await(const N of F)E.push(N);return this.load(o.concat(E),S)}async load(F,S){let E;E=S&&S.base64?o.from(F.toString(),"base64"):F;const N={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},C=await d.loadAsync(E);for(const k of Object.values(C.files))if(!k.dir){let M,U=k.name;if(U[0]==="/"&&(U=U.substr(1)),U.match(/xl\/media\//)||U.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))M=new c,M.write(await k.async("nodebuffer"));else{let $;M=new c({writableObjectMode:!0,readableObjectMode:!0}),$=i.browser?p(await k.async("nodebuffer")):await k.async("string");const X=16384;for(let Z=0;Z<$.length;Z+=X)M.write($.substring(Z,Z+X))}switch(M.end(),U){case"_rels/.rels":N.globalRels=await this.parseRels(M);break;case"xl/workbook.xml":{const $=await this.parseWorkbook(M);N.sheets=$.sheets,N.definedNames=$.definedNames,N.views=$.views,N.properties=$.properties,N.calcProperties=$.calcProperties;break}case"xl/_rels/workbook.xml.rels":N.workbookRels=await this.parseRels(M);break;case"xl/sharedStrings.xml":N.sharedStrings=new v,await N.sharedStrings.parseStream(M);break;case"xl/styles.xml":N.styles=new g,await N.styles.parseStream(M);break;case"docProps/app.xml":{const $=new j,X=await $.parseStream(M);N.company=X.company,N.manager=X.manager;break}case"docProps/core.xml":{const $=new x,X=await $.parseStream(M);Object.assign(N,X);break}default:{let $=U.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if($){await this._processWorksheetEntry(M,N,$[1],S,U);break}if($=U.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),$){await this._processWorksheetRelsEntry(M,N,$[1]);break}if($=U.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),$){await this._processThemeEntry(M,N,$[1]);break}if($=U.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),$){await this._processMediaEntry(M,N,$[1]);break}if($=U.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),$){await this._processDrawingEntry(M,N,$[1]);break}if($=U.match(/xl\/(comments\d+)[.]xml/),$){await this._processCommentEntry(M,N,$[1]);break}if($=U.match(/xl\/tables\/(table\d+)[.]xml/),$){await this._processTableEntry(M,N,$[1]);break}if($=U.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),$){await this._processDrawingRelsEntry(M,N,$[1]);break}if($=U.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),$){await this._processVmlDrawingEntry(M,N,$[1]);break}}}}return this.reconcile(N,S),this.workbook.model=N,this.workbook}async addMedia(F,S){await Promise.all(S.media.map(async E=>{if(E.type==="image"){const N=`xl/media/${E.name}.${E.extension}`;if(E.filename){const C=await function(k,M){return new Promise((U,$)=>{l.readFile(k,M,(X,Z)=>{X?$(X):U(Z)})})}(E.filename);return F.append(C,{name:N})}if(E.buffer)return F.append(E.buffer,{name:N});if(E.base64){const C=E.base64,k=C.substring(C.indexOf(",")+1);return F.append(k,{name:N,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(F,S){const E=new R,N=new y;S.worksheets.forEach(C=>{const{drawing:k}=C;if(k){E.prepare(k,{});let M=E.toXml(k);F.append(M,{name:`xl/drawings/${k.name}.xml`}),M=N.toXml(k.rels),F.append(M,{name:`xl/drawings/_rels/${k.name}.xml.rels`})}})}addTables(F,S){const E=new D;S.worksheets.forEach(N=>{const{tables:C}=N;C.forEach(k=>{E.prepare(k,{});const M=E.toXml(k);F.append(M,{name:"xl/tables/"+k.target})})})}async addContentTypes(F,S){const E=new b().toXml(S);F.append(E,{name:"[Content_Types].xml"})}async addApp(F,S){const E=new j().toXml(S);F.append(E,{name:"docProps/app.xml"})}async addCore(F,S){const E=new x;F.append(E.toXml(S),{name:"docProps/core.xml"})}async addThemes(F,S){const E=S.themes||{theme1:Y};Object.keys(E).forEach(N=>{const C=E[N],k=`xl/theme/${N}.xml`;F.append(C,{name:k})})}async addOfficeRels(F){const S=new y().toXml([{Id:"rId1",Type:G.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:G.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:G.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);F.append(S,{name:"_rels/.rels"})}async addWorkbookRels(F,S){let E=1;const N=[{Id:"rId"+E++,Type:G.RelType.Styles,Target:"styles.xml"},{Id:"rId"+E++,Type:G.RelType.Theme,Target:"theme/theme1.xml"}];S.sharedStrings.count&&N.push({Id:"rId"+E++,Type:G.RelType.SharedStrings,Target:"sharedStrings.xml"}),S.worksheets.forEach(k=>{k.rId="rId"+E++,N.push({Id:k.rId,Type:G.RelType.Worksheet,Target:`worksheets/sheet${k.id}.xml`})});const C=new y().toXml(N);F.append(C,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(F,S){S.sharedStrings&&S.sharedStrings.count&&F.append(S.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(F,S){const{xml:E}=S.styles;E&&F.append(E,{name:"xl/styles.xml"})}async addWorkbook(F,S){const E=new T;F.append(E.toXml(S),{name:"xl/workbook.xml"})}async addWorksheets(F,S){const E=new O,N=new y,C=new B,k=new q;S.worksheets.forEach(M=>{let U=new m;E.render(U,M),F.append(U.xml,{name:`xl/worksheets/sheet${M.id}.xml`}),M.rels&&M.rels.length&&(U=new m,N.render(U,M.rels),F.append(U.xml,{name:`xl/worksheets/_rels/sheet${M.id}.xml.rels`})),M.comments.length>0&&(U=new m,C.render(U,M),F.append(U.xml,{name:`xl/comments${M.id}.xml`}),U=new m,k.render(U,M),F.append(U.xml,{name:`xl/drawings/vmlDrawing${M.id}.vml`}))})}_finalize(F){return new Promise((S,E)=>{F.on("finish",()=>{S(this)}),F.on("error",E),F.finalize()})}prepareModel(F,S){F.creator=F.creator||"ExcelJS",F.lastModifiedBy=F.lastModifiedBy||"ExcelJS",F.created=F.created||new Date,F.modified=F.modified||new Date,F.useSharedStrings=S.useSharedStrings===void 0||S.useSharedStrings,F.useStyles=S.useStyles===void 0||S.useStyles,F.sharedStrings=new v,F.styles=F.useStyles?new g(!0):new g.Mock;const E=new T,N=new O;E.prepare(F);const C={sharedStrings:F.sharedStrings,styles:F.styles,date1904:F.properties.date1904,drawingsCount:0,media:F.media};C.drawings=F.drawings=[],C.commentRefs=F.commentRefs=[];let k=0;F.tables=[],F.worksheets.forEach(M=>{M.tables.forEach(U=>{k++,U.target=`table${k}.xml`,U.id=k,F.tables.push(U)}),N.prepare(M,C)})}async write(F,S){S=S||{};const{model:E}=this.workbook,N=new u.ZipWriter(S.zip);return N.pipe(F),this.prepareModel(E,S),await this.addContentTypes(N,E),await this.addOfficeRels(N,E),await this.addWorkbookRels(N,E),await this.addWorksheets(N,E),await this.addSharedStrings(N,E),await this.addDrawings(N,E),await this.addTables(N,E),await Promise.all([this.addThemes(N,E),this.addStyles(N,E)]),await this.addMedia(N,E),await Promise.all([this.addApp(N,E),this.addCore(N,E)]),await this.addWorkbook(N,E),this._finalize(N)}writeFile(F,S){const E=l.createWriteStream(F);return new Promise((N,C)=>{E.on("finish",()=>{N()}),E.on("error",k=>{C(k)}),this.write(E,S).then(()=>{E.end()}).catch(k=>{C(k)})})}async writeBuffer(F){const S=new h;return await this.write(S,F),S.read()}}G.RelType=r("./rel-type"),s.exports=G}).call(this)}).call(this,r("_process"),r("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(r,s,a){s.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(r,s,a){(function(i){(function(){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvFormatterStream=void 0;const o=r("stream"),l=r("./formatter");class d extends o.Transform{constructor(u){super({writableObjectMode:u.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=u,this.rowFormatter=new l.RowFormatter(u),this.hasWrittenBOM=!u.writeBOM}transform(u){return this.rowFormatter.rowTransform=u,this}_transform(u,h,f){let m=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(u,(p,g)=>p?(m=!0,f(p)):(g&&g.forEach(x=>{this.push(i.from(x,"utf8"))}),m=!0,f()))}catch(p){if(m)throw p;f(p)}}_flush(u){this.rowFormatter.finish((h,f)=>h?u(h):(f&&f.forEach(m=>{this.push(i.from(m,"utf8"))}),u()))}}a.CsvFormatterStream=d}).call(this)}).call(this,r("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.FormatterOptions=void 0,a.FormatterOptions=class{constructor(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var o;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,i||{}),(i==null?void 0:i.quoteHeaders)===void 0&&(this.quoteHeaders=this.quoteColumns),(i==null?void 0:i.quote)===!0?this.quote='"':(i==null?void 0:i.quote)===!1&&(this.quote=""),typeof(i==null?void 0:i.escape)!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((o=i.writeHeaders)===null||o===void 0||o),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(r,s,a){var i=function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(a,"__esModule",{value:!0}),a.FieldFormatter=void 0;const o=i(r("lodash.isboolean")),l=i(r("lodash.isnil")),d=i(r("lodash.escaperegexp"));a.FieldFormatter=class{constructor(c){this._headers=null,this.formatterOptions=c,c.headers!==null&&(this.headers=c.headers),this.REPLACE_REGEXP=new RegExp(c.quote,"g");const u=`[${c.delimiter}${d.default(c.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(u)}set headers(c){this._headers=c}shouldQuote(c,u){const h=u?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return o.default(h)?h:Array.isArray(h)?h[c]:this._headers!==null&&h[this._headers[c]]}format(c,u,h){const f=(""+(l.default(c)?"":c)).replace(/\0/g,""),{formatterOptions:m}=this;return m.quote!==""&&f.indexOf(m.quote)!==-1?this.quoteField(f.replace(this.REPLACE_REGEXP,m.escapedQuote)):f.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(u,h)?this.quoteField(f):f}quoteField(c){const{quote:u}=this.formatterOptions;return`${u}${c}${u}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(r,s,a){var i=function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(a,"__esModule",{value:!0}),a.RowFormatter=void 0;const o=i(r("lodash.isfunction")),l=i(r("lodash.isequal")),d=r("./FieldFormatter"),c=r("../types");class u{constructor(f){this.rowCount=0,this.formatterOptions=f,this.fieldFormatter=new d.FieldFormatter(f),this.headers=f.headers,this.shouldWriteHeaders=f.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),f.transform&&(this.rowTransform=f.transform)}static isRowHashArray(f){return!!Array.isArray(f)&&Array.isArray(f[0])&&f[0].length===2}static isRowArray(f){return Array.isArray(f)&&!this.isRowHashArray(f)}static gatherHeaders(f){return u.isRowHashArray(f)?f.map(m=>m[0]):Array.isArray(f)?f:Object.keys(f)}static createTransform(f){return c.isSyncTransform(f)?(m,p)=>{let g=null;try{g=f(m)}catch(x){return p(x)}return p(null,g)}:(m,p)=>{f(m,p)}}set rowTransform(f){if(!o.default(f))throw new TypeError("The transform should be a function");this._rowTransform=u.createTransform(f)}format(f,m){this.callTransformer(f,(p,g)=>{if(p)return m(p);if(!f)return m(null);const x=[];if(g){const{shouldFormatColumns:v,headers:y}=this.checkHeaders(g);if(this.shouldWriteHeaders&&y&&!this.hasWrittenHeaders&&(x.push(this.formatColumns(y,!0)),this.hasWrittenHeaders=!0),v){const b=this.gatherColumns(g);x.push(this.formatColumns(b,!1))}}return m(null,x)})}finish(f){const m=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return f(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));m.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&m.push(this.formatterOptions.rowDelimiter),f(null,m)}checkHeaders(f){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const m=u.gatherHeaders(f);return this.headers=m,this.fieldFormatter.headers=m,this.shouldWriteHeaders?{shouldFormatColumns:!l.default(m,f),headers:m}:{shouldFormatColumns:!0,headers:null}}gatherColumns(f){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(f)?u.isRowHashArray(f)?this.headers.map((m,p)=>{const g=f[p];return g?g[1]:""}):u.isRowArray(f)&&!this.shouldWriteHeaders?f:this.headers.map((m,p)=>f[p]):this.headers.map(m=>f[m])}callTransformer(f,m){return this._rowTransform?this._rowTransform(f,m):m(null,f)}formatColumns(f,m){const p=f.map((x,v)=>this.fieldFormatter.format(x,v,m)).join(this.formatterOptions.delimiter),{rowCount:g}=this;return this.rowCount+=1,g?[this.formatterOptions.rowDelimiter,p].join(""):p}}a.RowFormatter=u},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.FieldFormatter=a.RowFormatter=void 0;var i=r("./RowFormatter");Object.defineProperty(a,"RowFormatter",{enumerable:!0,get:function(){return i.RowFormatter}});var o=r("./FieldFormatter");Object.defineProperty(a,"FieldFormatter",{enumerable:!0,get:function(){return o.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(r,s,a){(function(i){(function(){var o=Object.create?function(v,y,b,j){j===void 0&&(j=b),Object.defineProperty(v,j,{enumerable:!0,get:function(){return y[b]}})}:function(v,y,b,j){j===void 0&&(j=b),v[j]=y[b]},l=Object.create?function(v,y){Object.defineProperty(v,"default",{enumerable:!0,value:y})}:function(v,y){v.default=y},d=function(v){if(v&&v.__esModule)return v;var y={};if(v!=null)for(var b in v)b!=="default"&&Object.prototype.hasOwnProperty.call(v,b)&&o(y,v,b);return l(y,v),y},c=function(v,y){for(var b in v)b==="default"||Object.prototype.hasOwnProperty.call(y,b)||o(y,v,b)};Object.defineProperty(a,"__esModule",{value:!0}),a.writeToPath=a.writeToString=a.writeToBuffer=a.writeToStream=a.write=a.format=a.FormatterOptions=a.CsvFormatterStream=void 0;const u=r("util"),h=r("stream"),f=d(r("fs")),m=r("./FormatterOptions"),p=r("./CsvFormatterStream");c(r("./types"),a);var g=r("./CsvFormatterStream");Object.defineProperty(a,"CsvFormatterStream",{enumerable:!0,get:function(){return g.CsvFormatterStream}});var x=r("./FormatterOptions");Object.defineProperty(a,"FormatterOptions",{enumerable:!0,get:function(){return x.FormatterOptions}}),a.format=v=>new p.CsvFormatterStream(new m.FormatterOptions(v)),a.write=(v,y)=>{const b=a.format(y),j=u.promisify((T,O)=>{b.write(T,void 0,O)});return v.reduce((T,O)=>T.then(()=>j(O)),Promise.resolve()).then(()=>b.end()).catch(T=>{b.emit("error",T)}),b},a.writeToStream=(v,y,b)=>a.write(y,b).pipe(v),a.writeToBuffer=function(v){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const b=[],j=new h.Writable({write(T,O,R){b.push(T),R()}});return new Promise((T,O)=>{j.on("error",O).on("finish",()=>T(i.concat(b))),a.write(v,y).pipe(j)})},a.writeToString=(v,y)=>a.writeToBuffer(v,y).then(b=>b.toString()),a.writeToPath=(v,y,b)=>{const j=f.createWriteStream(v,{encoding:"utf8"});return a.write(y,b).pipe(j)}}).call(this)}).call(this,r("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.isSyncTransform=void 0,a.isSyncTransform=i=>i.length===1},{}],153:[function(r,s,a){(function(i){(function(){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvParserStream=void 0;const o=r("string_decoder"),l=r("stream"),d=r("./transforms"),c=r("./parser");class u extends l.Transform{constructor(f){super({objectMode:f.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=f,this.parser=new c.Parser(f),this.headerTransformer=new d.HeaderTransformer(f),this.decoder=new o.StringDecoder(f.encoding),this.rowTransformerValidator=new d.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(f){return this.rowTransformerValidator.rowTransform=f,this}validate(f){return this.rowTransformerValidator.rowValidator=f,this}emit(f){if(f==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var m=arguments.length,p=new Array(m>1?m-1:0),g=1;g<m;g++)p[g-1]=arguments[g];return super.emit(f,...p)}_transform(f,m,p){if(this.hasHitRowLimit)return p();const g=u.wrapDoneCallback(p);try{const{lines:x}=this,v=x+this.decoder.write(f),y=this.parse(v,!0);return this.processRows(y,g)}catch(x){return g(x)}}_flush(f){const m=u.wrapDoneCallback(f);if(this.hasHitRowLimit)return m();try{const p=this.lines+this.decoder.end(),g=this.parse(p,!1);return this.processRows(g,m)}catch(p){return m(p)}}parse(f,m){if(!f)return[];const{line:p,rows:g}=this.parser.parse(f,m);return this.lines=p,g}processRows(f,m){const p=f.length,g=x=>{const v=j=>j?m(j):x%100!=0?g(x+1):void i(()=>g(x+1));if(this.checkAndEmitHeaders(),x>=p||this.hasHitRowLimit)return m();if(this.parsedLineCount+=1,this.shouldSkipLine)return v();const y=f[x];this.rowCount+=1,this.parsedRowCount+=1;const b=this.rowCount;return this.transformRow(y,(j,T)=>{if(j)return this.rowCount-=1,v(j);if(!T)return v(new Error("expected transform result"));if(T.isValid){if(T.row)return this.pushRow(T.row,v)}else this.emit("data-invalid",T.row,b,T.reason);return v()})};g(0)}transformRow(f,m){try{this.headerTransformer.transform(f,(p,g)=>p?m(p):g?g.isValid?g.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(g.row,m):this.skipRow(m):(this.rowCount-=1,this.parsedRowCount-=1,m(null,{row:null,isValid:!0})):this.shouldEmitRows?m(null,{isValid:!1,row:f}):this.skipRow(m):m(new Error("Expected result from header transform")))}catch(p){m(p)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(f){return this.rowCount-=1,f(null,{row:null,isValid:!0})}pushRow(f,m){try{this.parserOptions.objectMode?this.push(f):this.push(JSON.stringify(f)),m()}catch(p){m(p)}}static wrapDoneCallback(f){let m=!1;return function(p){if(p){if(m)throw p;return m=!0,void f(p)}for(var g=arguments.length,x=new Array(g>1?g-1:0),v=1;v<g;v++)x[v-1]=arguments[v];f(...x)}}}a.CsvParserStream=u}).call(this)}).call(this,r("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(r,s,a){var i=function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(a,"__esModule",{value:!0}),a.ParserOptions=void 0;const o=i(r("lodash.escaperegexp")),l=i(r("lodash.isnil"));a.ParserOptions=class{constructor(d){var c;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,d||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=o.default(this.delimiter),this.escapeChar=(c=this.escape)!==null&&c!==void 0?c:this.quote,this.supportsComments=!l.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(r,s,a){var i=Object.create?function(g,x,v,y){y===void 0&&(y=v),Object.defineProperty(g,y,{enumerable:!0,get:function(){return x[v]}})}:function(g,x,v,y){y===void 0&&(y=v),g[y]=x[v]},o=Object.create?function(g,x){Object.defineProperty(g,"default",{enumerable:!0,value:x})}:function(g,x){g.default=x},l=function(g){if(g&&g.__esModule)return g;var x={};if(g!=null)for(var v in g)v!=="default"&&Object.prototype.hasOwnProperty.call(g,v)&&i(x,g,v);return o(x,g),x},d=function(g,x){for(var v in g)v==="default"||Object.prototype.hasOwnProperty.call(x,v)||i(x,g,v)};Object.defineProperty(a,"__esModule",{value:!0}),a.parseString=a.parseFile=a.parseStream=a.parse=a.ParserOptions=a.CsvParserStream=void 0;const c=l(r("fs")),u=r("stream"),h=r("./ParserOptions"),f=r("./CsvParserStream");d(r("./types"),a);var m=r("./CsvParserStream");Object.defineProperty(a,"CsvParserStream",{enumerable:!0,get:function(){return m.CsvParserStream}});var p=r("./ParserOptions");Object.defineProperty(a,"ParserOptions",{enumerable:!0,get:function(){return p.ParserOptions}}),a.parse=g=>new f.CsvParserStream(new h.ParserOptions(g)),a.parseStream=(g,x)=>g.pipe(new f.CsvParserStream(new h.ParserOptions(x))),a.parseFile=function(g){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return c.createReadStream(g).pipe(new f.CsvParserStream(new h.ParserOptions(x)))},a.parseString=(g,x)=>{const v=new u.Readable;return v.push(g),v.push(null),v.pipe(new f.CsvParserStream(new h.ParserOptions(x)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Parser=void 0;const i=r("./Scanner"),o=r("./RowParser"),l=r("./Token");class d{constructor(u){this.parserOptions=u,this.rowParser=new o.RowParser(this.parserOptions)}static removeBOM(u){return u&&u.charCodeAt(0)===65279?u.slice(1):u}parse(u,h){const f=new i.Scanner({line:d.removeBOM(u),parserOptions:this.parserOptions,hasMoreData:h});return this.parserOptions.supportsComments?this.parseWithComments(f):this.parseWithoutComments(f)}parseWithoutComments(u){const h=[];let f=!0;for(;f;)f=this.parseRow(u,h);return{line:u.line,rows:h}}parseWithComments(u){const{parserOptions:h}=this,f=[];for(let m=u.nextCharacterToken;m!==null;m=u.nextCharacterToken)if(l.Token.isTokenComment(m,h)){if(u.advancePastLine()===null)return{line:u.lineFromCursor,rows:f};if(!u.hasMoreCharacters)return{line:u.lineFromCursor,rows:f};u.truncateToCursor()}else if(!this.parseRow(u,f))break;return{line:u.line,rows:f}}parseRow(u,h){if(!u.nextNonSpaceToken)return!1;const f=this.rowParser.parse(u);return f!==null&&(this.parserOptions.ignoreEmpty&&o.RowParser.isEmptyRow(f)||h.push(f),!0)}}a.Parser=d},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.RowParser=void 0;const i=r("./column"),o=r("./Token");a.RowParser=class{constructor(l){this.parserOptions=l,this.columnParser=new i.ColumnParser(l)}static isEmptyRow(l){return l.join("").replace(/\s+/g,"")===""}parse(l){const{parserOptions:d}=this,{hasMoreData:c}=l,u=l,h=[];let f=this.getStartToken(u,h);for(;f;){if(o.Token.isTokenRowDelimiter(f))return u.advancePastToken(f),!u.hasMoreCharacters&&o.Token.isTokenCarriageReturn(f,d)&&c?null:(u.truncateToCursor(),h);if(!this.shouldSkipColumnParse(u,f,h)){const m=this.columnParser.parse(u);if(m===null)return null;h.push(m)}f=u.nextNonSpaceToken}return c?null:(u.truncateToCursor(),h)}getStartToken(l,d){const c=l.nextNonSpaceToken;return c!==null&&o.Token.isTokenDelimiter(c,this.parserOptions)?(d.push(""),l.nextNonSpaceToken):c}shouldSkipColumnParse(l,d,c){const{parserOptions:u}=this;if(o.Token.isTokenDelimiter(d,u)){l.advancePastToken(d);const h=l.nextCharacterToken;if(!l.hasMoreCharacters||h!==null&&o.Token.isTokenRowDelimiter(h)||h!==null&&o.Token.isTokenDelimiter(h,u))return c.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Scanner=void 0;const i=r("./Token"),o=/((?:\r\n)|\n|\r)/;a.Scanner=class{constructor(l){this.cursor=0,this.line=l.line,this.lineLength=this.line.length,this.parserOptions=l.parserOptions,this.hasMoreData=l.hasMoreData,this.cursor=l.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:l}=this,d=this.parserOptions.NEXT_TOKEN_REGEXP;if(l.search(d)===-1)return null;const c=d.exec(l);if(c==null)return null;const u=c[1],h=this.cursor+(c.index||0);return new i.Token({token:u,startCursor:h,endCursor:h+u.length-1})}get nextCharacterToken(){const{cursor:l,lineLength:d}=this;return d<=l?null:new i.Token({token:this.line[l],startCursor:l,endCursor:l})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const l=o.exec(this.lineFromCursor);return l?(this.cursor+=(l.index||0)+l[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(l){return this.cursor=l,this}advanceToToken(l){return this.cursor=l.startCursor,this}advancePastToken(l){return this.cursor=l.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Token=void 0,a.Token=class{constructor(i){this.token=i.token,this.startCursor=i.startCursor,this.endCursor=i.endCursor}static isTokenRowDelimiter(i){const o=i.token;return o==="\r"||o===`
`||o===`\r
`}static isTokenCarriageReturn(i,o){return i.token===o.carriageReturn}static isTokenComment(i,o){return o.supportsComments&&!!i&&i.token===o.comment}static isTokenEscapeCharacter(i,o){return i.token===o.escapeChar}static isTokenQuote(i,o){return i.token===o.quote}static isTokenDelimiter(i,o){return i.token===o.delimiter}}},{}],160:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnFormatter=void 0,a.ColumnFormatter=class{constructor(i){i.trim?this.format=o=>o.trim():i.ltrim?this.format=o=>o.trimLeft():i.rtrim?this.format=o=>o.trimRight():this.format=o=>o}}},{}],161:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnParser=void 0;const i=r("./NonQuotedColumnParser"),o=r("./QuotedColumnParser"),l=r("../Token");a.ColumnParser=class{constructor(d){this.parserOptions=d,this.quotedColumnParser=new o.QuotedColumnParser(d),this.nonQuotedColumnParser=new i.NonQuotedColumnParser(d)}parse(d){const{nextNonSpaceToken:c}=d;return c!==null&&l.Token.isTokenQuote(c,this.parserOptions)?(d.advanceToToken(c),this.quotedColumnParser.parse(d)):this.nonQuotedColumnParser.parse(d)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.NonQuotedColumnParser=void 0;const i=r("./ColumnFormatter"),o=r("../Token");a.NonQuotedColumnParser=class{constructor(l){this.parserOptions=l,this.columnFormatter=new i.ColumnFormatter(l)}parse(l){if(!l.hasMoreCharacters)return null;const{parserOptions:d}=this,c=[];let u=l.nextCharacterToken;for(;u&&!o.Token.isTokenDelimiter(u,d)&&!o.Token.isTokenRowDelimiter(u);u=l.nextCharacterToken)c.push(u.token),l.advancePastToken(u);return this.columnFormatter.format(c.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.QuotedColumnParser=void 0;const i=r("./ColumnFormatter"),o=r("../Token");a.QuotedColumnParser=class{constructor(l){this.parserOptions=l,this.columnFormatter=new i.ColumnFormatter(l)}parse(l){if(!l.hasMoreCharacters)return null;const d=l.cursor,{foundClosingQuote:c,col:u}=this.gatherDataBetweenQuotes(l);if(!c){if(l.advanceTo(d),!l.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${l.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(l),u}gatherDataBetweenQuotes(l){const{parserOptions:d}=this;let c=!1,u=!1;const h=[];let f=l.nextCharacterToken;for(;!u&&f!==null;f=l.nextCharacterToken){const m=o.Token.isTokenQuote(f,d);if(!c&&m)c=!0;else if(c)if(o.Token.isTokenEscapeCharacter(f,d)){l.advancePastToken(f);const p=l.nextCharacterToken;p!==null&&(o.Token.isTokenQuote(p,d)||o.Token.isTokenEscapeCharacter(p,d))?(h.push(p.token),f=p):m?u=!0:h.push(f.token)}else m?u=!0:h.push(f.token);l.advancePastToken(f)}return{col:this.columnFormatter.format(h.join("")),foundClosingQuote:u}}checkForMalformedColumn(l){const{parserOptions:d}=this,{nextNonSpaceToken:c}=l;if(c){const u=o.Token.isTokenDelimiter(c,d),h=o.Token.isTokenRowDelimiter(c);if(!u&&!h){const f=l.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${d.escapedDelimiter}' OR new line got: '${c.token}'. at '${f}`)}l.advanceToToken(c)}else l.hasMoreData||l.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnFormatter=a.QuotedColumnParser=a.NonQuotedColumnParser=a.ColumnParser=void 0;var i=r("./ColumnParser");Object.defineProperty(a,"ColumnParser",{enumerable:!0,get:function(){return i.ColumnParser}});var o=r("./NonQuotedColumnParser");Object.defineProperty(a,"NonQuotedColumnParser",{enumerable:!0,get:function(){return o.NonQuotedColumnParser}});var l=r("./QuotedColumnParser");Object.defineProperty(a,"QuotedColumnParser",{enumerable:!0,get:function(){return l.QuotedColumnParser}});var d=r("./ColumnFormatter");Object.defineProperty(a,"ColumnFormatter",{enumerable:!0,get:function(){return d.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.QuotedColumnParser=a.NonQuotedColumnParser=a.ColumnParser=a.Token=a.Scanner=a.RowParser=a.Parser=void 0;var i=r("./Parser");Object.defineProperty(a,"Parser",{enumerable:!0,get:function(){return i.Parser}});var o=r("./RowParser");Object.defineProperty(a,"RowParser",{enumerable:!0,get:function(){return o.RowParser}});var l=r("./Scanner");Object.defineProperty(a,"Scanner",{enumerable:!0,get:function(){return l.Scanner}});var d=r("./Token");Object.defineProperty(a,"Token",{enumerable:!0,get:function(){return d.Token}});var c=r("./column");Object.defineProperty(a,"ColumnParser",{enumerable:!0,get:function(){return c.ColumnParser}}),Object.defineProperty(a,"NonQuotedColumnParser",{enumerable:!0,get:function(){return c.NonQuotedColumnParser}}),Object.defineProperty(a,"QuotedColumnParser",{enumerable:!0,get:function(){return c.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(r,s,a){var i=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(a,"__esModule",{value:!0}),a.HeaderTransformer=void 0;const o=i(r("lodash.isundefined")),l=i(r("lodash.isfunction")),d=i(r("lodash.uniq")),c=i(r("lodash.groupby"));a.HeaderTransformer=class{constructor(u){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=u,u.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(u.headers)?this.setHeaders(u.headers):l.default(u.headers)&&(this.headersTransform=u.headers)}transform(u,h){return this.shouldMapRow(u)?h(null,this.processRow(u)):h(null,{row:null,isValid:!0})}shouldMapRow(u){const{parserOptions:h}=this;if(!this.headersTransform&&h.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(u)){if(this.headersTransform)this.setHeaders(this.headersTransform(u));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(u)}return!1}return!0}processRow(u){if(!this.headers)return{row:u,isValid:!0};const{parserOptions:h}=this;if(!h.discardUnmappedColumns&&u.length>this.headersLength){if(!h.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${u.length}`);return{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}}return h.strictColumnHandling&&u.length<this.headersLength?{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}:{row:this.mapHeaders(u),isValid:!0}}mapHeaders(u){const h={},{headers:f,headersLength:m}=this;for(let p=0;p<m;p+=1){const g=f[p];if(!o.default(g)){const x=u[p];o.default(x)?h[g]="":h[g]=x}}return h}setHeaders(u){var h;const f=u.filter(m=>!!m);if(d.default(f).length!==f.length){const m=c.default(f),p=Object.keys(m).filter(g=>m[g].length>1);throw new Error("Duplicate headers found "+JSON.stringify(p))}this.headers=u,this.receivedHeaders=!0,this.headersLength=((h=this.headers)===null||h===void 0?void 0:h.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(r,s,a){var i=function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(a,"__esModule",{value:!0}),a.RowTransformerValidator=void 0;const o=i(r("lodash.isfunction")),l=r("../types");class d{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(u){return l.isSyncTransform(u)?(h,f)=>{let m=null;try{m=u(h)}catch(p){return f(p)}return f(null,m)}:u}static createValidator(u){return l.isSyncValidate(u)?(h,f)=>{f(null,{row:h,isValid:u(h)})}:(h,f)=>{u(h,(m,p,g)=>m?f(m):f(null,p?{row:h,isValid:p,reason:g}:{row:h,isValid:!1,reason:g}))}}set rowTransform(u){if(!o.default(u))throw new TypeError("The transform should be a function");this._rowTransform=d.createTransform(u)}set rowValidator(u){if(!o.default(u))throw new TypeError("The validate should be a function");this._rowValidator=d.createValidator(u)}transformAndValidate(u,h){return this.callTransformer(u,(f,m)=>f?h(f):m?this.callValidator(m,(p,g)=>p?h(p):g&&!g.isValid?h(null,{row:m,isValid:!1,reason:g.reason}):h(null,{row:m,isValid:!0})):h(null,{row:null,isValid:!0}))}callTransformer(u,h){return this._rowTransform?this._rowTransform(u,h):h(null,u)}callValidator(u,h){return this._rowValidator?this._rowValidator(u,h):h(null,{row:u,isValid:!0})}}a.RowTransformerValidator=d},{"../types":169,"lodash.isfunction":446}],168:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.HeaderTransformer=a.RowTransformerValidator=void 0;var i=r("./RowTransformerValidator");Object.defineProperty(a,"RowTransformerValidator",{enumerable:!0,get:function(){return i.RowTransformerValidator}});var o=r("./HeaderTransformer");Object.defineProperty(a,"HeaderTransformer",{enumerable:!0,get:function(){return o.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.isSyncValidate=a.isSyncTransform=void 0,a.isSyncTransform=i=>i.length===1,a.isSyncValidate=i=>i.length===1},{}],170:[function(r,s,a){const i=a;i.bignum=r("bn.js"),i.define=r("./asn1/api").define,i.base=r("./asn1/base"),i.constants=r("./asn1/constants"),i.decoders=r("./asn1/decoders"),i.encoders=r("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(r,s,a){const i=r("./encoders"),o=r("./decoders"),l=r("inherits");function d(c,u){this.name=c,this.body=u,this.decoders={},this.encoders={}}a.define=function(c,u){return new d(c,u)},d.prototype._createNamed=function(c){const u=this.name;function h(f){this._initNamed(f,u)}return l(h,c),h.prototype._initNamed=function(f,m){c.call(this,f,m)},new h(this)},d.prototype._getDecoder=function(c){return c=c||"der",this.decoders.hasOwnProperty(c)||(this.decoders[c]=this._createNamed(o[c])),this.decoders[c]},d.prototype.decode=function(c,u,h){return this._getDecoder(u).decode(c,h)},d.prototype._getEncoder=function(c){return c=c||"der",this.encoders.hasOwnProperty(c)||(this.encoders[c]=this._createNamed(i[c])),this.encoders[c]},d.prototype.encode=function(c,u,h){return this._getEncoder(u).encode(c,h)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(r,s,a){const i=r("inherits"),o=r("../base/reporter").Reporter,l=r("safer-buffer").Buffer;function d(u,h){o.call(this,h),l.isBuffer(u)?(this.base=u,this.offset=0,this.length=u.length):this.error("Input not Buffer")}function c(u,h){if(Array.isArray(u))this.length=0,this.value=u.map(function(f){return c.isEncoderBuffer(f)||(f=new c(f,h)),this.length+=f.length,f},this);else if(typeof u=="number"){if(!(0<=u&&u<=255))return h.error("non-byte EncoderBuffer value");this.value=u,this.length=1}else if(typeof u=="string")this.value=u,this.length=l.byteLength(u);else{if(!l.isBuffer(u))return h.error("Unsupported type: "+typeof u);this.value=u,this.length=u.length}}i(d,o),a.DecoderBuffer=d,d.isDecoderBuffer=function(u){return u instanceof d?!0:typeof u=="object"&&l.isBuffer(u.base)&&u.constructor.name==="DecoderBuffer"&&typeof u.offset=="number"&&typeof u.length=="number"&&typeof u.save=="function"&&typeof u.restore=="function"&&typeof u.isEmpty=="function"&&typeof u.readUInt8=="function"&&typeof u.skip=="function"&&typeof u.raw=="function"},d.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},d.prototype.restore=function(u){const h=new d(this.base);return h.offset=u.offset,h.length=this.offset,this.offset=u.offset,o.prototype.restore.call(this,u.reporter),h},d.prototype.isEmpty=function(){return this.offset===this.length},d.prototype.readUInt8=function(u){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(u||"DecoderBuffer overrun")},d.prototype.skip=function(u,h){if(!(this.offset+u<=this.length))return this.error(h||"DecoderBuffer overrun");const f=new d(this.base);return f._reporterState=this._reporterState,f.offset=this.offset,f.length=this.offset+u,this.offset+=u,f},d.prototype.raw=function(u){return this.base.slice(u?u.offset:this.offset,this.length)},a.EncoderBuffer=c,c.isEncoderBuffer=function(u){return u instanceof c?!0:typeof u=="object"&&u.constructor.name==="EncoderBuffer"&&typeof u.length=="number"&&typeof u.join=="function"},c.prototype.join=function(u,h){return u||(u=l.alloc(this.length)),h||(h=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(f){f.join(u,h),h+=f.length}):(typeof this.value=="number"?u[h]=this.value:typeof this.value=="string"?u.write(this.value,h):l.isBuffer(this.value)&&this.value.copy(u,h),h+=this.length)),u}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(r,s,a){const i=a;i.Reporter=r("./reporter").Reporter,i.DecoderBuffer=r("./buffer").DecoderBuffer,i.EncoderBuffer=r("./buffer").EncoderBuffer,i.Node=r("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(r,s,a){const i=r("../base/reporter").Reporter,o=r("../base/buffer").EncoderBuffer,l=r("../base/buffer").DecoderBuffer,d=r("minimalistic-assert"),c=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(c);function h(m,p,g){const x={};this._baseState=x,x.name=g,x.enc=m,x.parent=p||null,x.children=null,x.tag=null,x.args=null,x.reverseArgs=null,x.choice=null,x.optional=!1,x.any=!1,x.obj=!1,x.use=null,x.useDecoder=null,x.key=null,x.default=null,x.explicit=null,x.implicit=null,x.contains=null,x.parent||(x.children=[],this._wrap())}s.exports=h;const f=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];h.prototype.clone=function(){const m=this._baseState,p={};f.forEach(function(x){p[x]=m[x]});const g=new this.constructor(p.parent);return g._baseState=p,g},h.prototype._wrap=function(){const m=this._baseState;u.forEach(function(p){this[p]=function(){const g=new this.constructor(this);return m.children.push(g),g[p].apply(g,arguments)}},this)},h.prototype._init=function(m){const p=this._baseState;d(p.parent===null),m.call(this),p.children=p.children.filter(function(g){return g._baseState.parent===this},this),d.equal(p.children.length,1,"Root node can have only one child")},h.prototype._useArgs=function(m){const p=this._baseState,g=m.filter(function(x){return x instanceof this.constructor},this);m=m.filter(function(x){return!(x instanceof this.constructor)},this),g.length!==0&&(d(p.children===null),p.children=g,g.forEach(function(x){x._baseState.parent=this},this)),m.length!==0&&(d(p.args===null),p.args=m,p.reverseArgs=m.map(function(x){if(typeof x!="object"||x.constructor!==Object)return x;const v={};return Object.keys(x).forEach(function(y){y==(0|y)&&(y|=0);const b=x[y];v[b]=y}),v}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(m){h.prototype[m]=function(){const p=this._baseState;throw new Error(m+" not implemented for encoding: "+p.enc)}}),c.forEach(function(m){h.prototype[m]=function(){const p=this._baseState,g=Array.prototype.slice.call(arguments);return d(p.tag===null),p.tag=m,this._useArgs(g),this}}),h.prototype.use=function(m){d(m);const p=this._baseState;return d(p.use===null),p.use=m,this},h.prototype.optional=function(){return this._baseState.optional=!0,this},h.prototype.def=function(m){const p=this._baseState;return d(p.default===null),p.default=m,p.optional=!0,this},h.prototype.explicit=function(m){const p=this._baseState;return d(p.explicit===null&&p.implicit===null),p.explicit=m,this},h.prototype.implicit=function(m){const p=this._baseState;return d(p.explicit===null&&p.implicit===null),p.implicit=m,this},h.prototype.obj=function(){const m=this._baseState,p=Array.prototype.slice.call(arguments);return m.obj=!0,p.length!==0&&this._useArgs(p),this},h.prototype.key=function(m){const p=this._baseState;return d(p.key===null),p.key=m,this},h.prototype.any=function(){return this._baseState.any=!0,this},h.prototype.choice=function(m){const p=this._baseState;return d(p.choice===null),p.choice=m,this._useArgs(Object.keys(m).map(function(g){return m[g]})),this},h.prototype.contains=function(m){const p=this._baseState;return d(p.use===null),p.contains=m,this},h.prototype._decode=function(m,p){const g=this._baseState;if(g.parent===null)return m.wrapResult(g.children[0]._decode(m,p));let x,v=g.default,y=!0,b=null;if(g.key!==null&&(b=m.enterKey(g.key)),g.optional){let j=null;if(g.explicit!==null?j=g.explicit:g.implicit!==null?j=g.implicit:g.tag!==null&&(j=g.tag),j!==null||g.any){if(y=this._peekTag(m,j,g.any),m.isError(y))return y}else{const T=m.save();try{g.choice===null?this._decodeGeneric(g.tag,m,p):this._decodeChoice(m,p),y=!0}catch{y=!1}m.restore(T)}}if(g.obj&&y&&(x=m.enterObject()),y){if(g.explicit!==null){const T=this._decodeTag(m,g.explicit);if(m.isError(T))return T;m=T}const j=m.offset;if(g.use===null&&g.choice===null){let T;g.any&&(T=m.save());const O=this._decodeTag(m,g.implicit!==null?g.implicit:g.tag,g.any);if(m.isError(O))return O;g.any?v=m.raw(T):m=O}if(p&&p.track&&g.tag!==null&&p.track(m.path(),j,m.length,"tagged"),p&&p.track&&g.tag!==null&&p.track(m.path(),m.offset,m.length,"content"),g.any||(v=g.choice===null?this._decodeGeneric(g.tag,m,p):this._decodeChoice(m,p)),m.isError(v))return v;if(g.any||g.choice!==null||g.children===null||g.children.forEach(function(T){T._decode(m,p)}),g.contains&&(g.tag==="octstr"||g.tag==="bitstr")){const T=new l(v);v=this._getUse(g.contains,m._reporterState.obj)._decode(T,p)}}return g.obj&&y&&(v=m.leaveObject(x)),g.key===null||v===null&&y!==!0?b!==null&&m.exitKey(b):m.leaveKey(b,g.key,v),v},h.prototype._decodeGeneric=function(m,p,g){const x=this._baseState;return m==="seq"||m==="set"?null:m==="seqof"||m==="setof"?this._decodeList(p,m,x.args[0],g):/str$/.test(m)?this._decodeStr(p,m,g):m==="objid"&&x.args?this._decodeObjid(p,x.args[0],x.args[1],g):m==="objid"?this._decodeObjid(p,null,null,g):m==="gentime"||m==="utctime"?this._decodeTime(p,m,g):m==="null_"?this._decodeNull(p,g):m==="bool"?this._decodeBool(p,g):m==="objDesc"?this._decodeStr(p,m,g):m==="int"||m==="enum"?this._decodeInt(p,x.args&&x.args[0],g):x.use!==null?this._getUse(x.use,p._reporterState.obj)._decode(p,g):p.error("unknown tag: "+m)},h.prototype._getUse=function(m,p){const g=this._baseState;return g.useDecoder=this._use(m,p),d(g.useDecoder._baseState.parent===null),g.useDecoder=g.useDecoder._baseState.children[0],g.implicit!==g.useDecoder._baseState.implicit&&(g.useDecoder=g.useDecoder.clone(),g.useDecoder._baseState.implicit=g.implicit),g.useDecoder},h.prototype._decodeChoice=function(m,p){const g=this._baseState;let x=null,v=!1;return Object.keys(g.choice).some(function(y){const b=m.save(),j=g.choice[y];try{const T=j._decode(m,p);if(m.isError(T))return!1;x={type:y,value:T},v=!0}catch{return m.restore(b),!1}return!0},this),v?x:m.error("Choice not matched")},h.prototype._createEncoderBuffer=function(m){return new o(m,this.reporter)},h.prototype._encode=function(m,p,g){const x=this._baseState;if(x.default!==null&&x.default===m)return;const v=this._encodeValue(m,p,g);return v===void 0||this._skipDefault(v,p,g)?void 0:v},h.prototype._encodeValue=function(m,p,g){const x=this._baseState;if(x.parent===null)return x.children[0]._encode(m,p||new i);let v=null;if(this.reporter=p,x.optional&&m===void 0){if(x.default===null)return;m=x.default}let y=null,b=!1;if(x.any)v=this._createEncoderBuffer(m);else if(x.choice)v=this._encodeChoice(m,p);else if(x.contains)y=this._getUse(x.contains,g)._encode(m,p),b=!0;else if(x.children)y=x.children.map(function(j){if(j._baseState.tag==="null_")return j._encode(null,p,m);if(j._baseState.key===null)return p.error("Child should have a key");const T=p.enterKey(j._baseState.key);if(typeof m!="object")return p.error("Child expected, but input is not object");const O=j._encode(m[j._baseState.key],p,m);return p.leaveKey(T),O},this).filter(function(j){return j}),y=this._createEncoderBuffer(y);else if(x.tag==="seqof"||x.tag==="setof"){if(!x.args||x.args.length!==1)return p.error("Too many args for : "+x.tag);if(!Array.isArray(m))return p.error("seqof/setof, but data is not Array");const j=this.clone();j._baseState.implicit=null,y=this._createEncoderBuffer(m.map(function(T){const O=this._baseState;return this._getUse(O.args[0],m)._encode(T,p)},j))}else x.use!==null?v=this._getUse(x.use,g)._encode(m,p):(y=this._encodePrimitive(x.tag,m),b=!0);if(!x.any&&x.choice===null){const j=x.implicit!==null?x.implicit:x.tag,T=x.implicit===null?"universal":"context";j===null?x.use===null&&p.error("Tag could be omitted only for .use()"):x.use===null&&(v=this._encodeComposite(j,b,T,y))}return x.explicit!==null&&(v=this._encodeComposite(x.explicit,!1,"context",v)),v},h.prototype._encodeChoice=function(m,p){const g=this._baseState,x=g.choice[m.type];return x||d(!1,m.type+" not found in "+JSON.stringify(Object.keys(g.choice))),x._encode(m.value,p)},h.prototype._encodePrimitive=function(m,p){const g=this._baseState;if(/str$/.test(m))return this._encodeStr(p,m);if(m==="objid"&&g.args)return this._encodeObjid(p,g.reverseArgs[0],g.args[1]);if(m==="objid")return this._encodeObjid(p,null,null);if(m==="gentime"||m==="utctime")return this._encodeTime(p,m);if(m==="null_")return this._encodeNull();if(m==="int"||m==="enum")return this._encodeInt(p,g.args&&g.reverseArgs[0]);if(m==="bool")return this._encodeBool(p);if(m==="objDesc")return this._encodeStr(p,m);throw new Error("Unsupported tag: "+m)},h.prototype._isNumstr=function(m){return/^[0-9 ]*$/.test(m)},h.prototype._isPrintstr=function(m){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(m)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(r,s,a){const i=r("inherits");function o(d){this._reporterState={obj:null,path:[],options:d||{},errors:[]}}function l(d,c){this.path=d,this.rethrow(c)}a.Reporter=o,o.prototype.isError=function(d){return d instanceof l},o.prototype.save=function(){const d=this._reporterState;return{obj:d.obj,pathLen:d.path.length}},o.prototype.restore=function(d){const c=this._reporterState;c.obj=d.obj,c.path=c.path.slice(0,d.pathLen)},o.prototype.enterKey=function(d){return this._reporterState.path.push(d)},o.prototype.exitKey=function(d){const c=this._reporterState;c.path=c.path.slice(0,d-1)},o.prototype.leaveKey=function(d,c,u){const h=this._reporterState;this.exitKey(d),h.obj!==null&&(h.obj[c]=u)},o.prototype.path=function(){return this._reporterState.path.join("/")},o.prototype.enterObject=function(){const d=this._reporterState,c=d.obj;return d.obj={},c},o.prototype.leaveObject=function(d){const c=this._reporterState,u=c.obj;return c.obj=d,u},o.prototype.error=function(d){let c;const u=this._reporterState,h=d instanceof l;if(c=h?d:new l(u.path.map(function(f){return"["+JSON.stringify(f)+"]"}).join(""),d.message||d,d.stack),!u.options.partial)throw c;return h||u.errors.push(c),c},o.prototype.wrapResult=function(d){const c=this._reporterState;return c.options.partial?{result:this.isError(d)?null:d,errors:c.errors}:d},i(l,Error),l.prototype.rethrow=function(d){if(this.message=d+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,l),!this.stack)try{throw new Error(this.message)}catch(c){this.stack=c.stack}return this}},{inherits:440}],176:[function(r,s,a){function i(o){const l={};return Object.keys(o).forEach(function(d){(0|d)==d&&(d|=0);const c=o[d];l[c]=d}),l}a.tagClass={0:"universal",1:"application",2:"context",3:"private"},a.tagClassByName=i(a.tagClass),a.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},a.tagByName=i(a.tag)},{}],177:[function(r,s,a){const i=a;i._reverse=function(o){const l={};return Object.keys(o).forEach(function(d){(0|d)==d&&(d|=0);const c=o[d];l[c]=d}),l},i.der=r("./der")},{"./der":176}],178:[function(r,s,a){const i=r("inherits"),o=r("bn.js"),l=r("../base/buffer").DecoderBuffer,d=r("../base/node"),c=r("../constants/der");function u(p){this.enc="der",this.name=p.name,this.entity=p,this.tree=new h,this.tree._init(p.body)}function h(p){d.call(this,"der",p)}function f(p,g){let x=p.readUInt8(g);if(p.isError(x))return x;const v=c.tagClass[x>>6],y=(32&x)==0;if((31&x)==31){let b=x;for(x=0;(128&b)==128;){if(b=p.readUInt8(g),p.isError(b))return b;x<<=7,x|=127&b}}else x&=31;return{cls:v,primitive:y,tag:x,tagStr:c.tag[x]}}function m(p,g,x){let v=p.readUInt8(x);if(p.isError(v))return v;if(!g&&v===128)return null;if(!(128&v))return v;const y=127&v;if(y>4)return p.error("length octect is too long");v=0;for(let b=0;b<y;b++){v<<=8;const j=p.readUInt8(x);if(p.isError(j))return j;v|=j}return v}s.exports=u,u.prototype.decode=function(p,g){return l.isDecoderBuffer(p)||(p=new l(p,g)),this.tree._decode(p,g)},i(h,d),h.prototype._peekTag=function(p,g,x){if(p.isEmpty())return!1;const v=p.save(),y=f(p,'Failed to peek tag: "'+g+'"');return p.isError(y)?y:(p.restore(v),y.tag===g||y.tagStr===g||y.tagStr+"of"===g||x)},h.prototype._decodeTag=function(p,g,x){const v=f(p,'Failed to decode tag of "'+g+'"');if(p.isError(v))return v;let y=m(p,v.primitive,'Failed to get length of "'+g+'"');if(p.isError(y))return y;if(!x&&v.tag!==g&&v.tagStr!==g&&v.tagStr+"of"!==g)return p.error('Failed to match tag: "'+g+'"');if(v.primitive||y!==null)return p.skip(y,'Failed to match body of: "'+g+'"');const b=p.save(),j=this._skipUntilEnd(p,'Failed to skip indefinite length body: "'+this.tag+'"');return p.isError(j)?j:(y=p.offset-b.offset,p.restore(b),p.skip(y,'Failed to match body of: "'+g+'"'))},h.prototype._skipUntilEnd=function(p,g){for(;;){const x=f(p,g);if(p.isError(x))return x;const v=m(p,x.primitive,g);if(p.isError(v))return v;let y;if(y=x.primitive||v!==null?p.skip(v):this._skipUntilEnd(p,g),p.isError(y))return y;if(x.tagStr==="end")break}},h.prototype._decodeList=function(p,g,x,v){const y=[];for(;!p.isEmpty();){const b=this._peekTag(p,"end");if(p.isError(b))return b;const j=x.decode(p,"der",v);if(p.isError(j)&&b)break;y.push(j)}return y},h.prototype._decodeStr=function(p,g){if(g==="bitstr"){const x=p.readUInt8();return p.isError(x)?x:{unused:x,data:p.raw()}}if(g==="bmpstr"){const x=p.raw();if(x.length%2==1)return p.error("Decoding of string type: bmpstr length mismatch");let v="";for(let y=0;y<x.length/2;y++)v+=String.fromCharCode(x.readUInt16BE(2*y));return v}if(g==="numstr"){const x=p.raw().toString("ascii");return this._isNumstr(x)?x:p.error("Decoding of string type: numstr unsupported characters")}if(g==="octstr"||g==="objDesc")return p.raw();if(g==="printstr"){const x=p.raw().toString("ascii");return this._isPrintstr(x)?x:p.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(g)?p.raw().toString():p.error("Decoding of string type: "+g+" unsupported")},h.prototype._decodeObjid=function(p,g,x){let v;const y=[];let b=0,j=0;for(;!p.isEmpty();)j=p.readUInt8(),b<<=7,b|=127&j,!(128&j)&&(y.push(b),b=0);128&j&&y.push(b);const T=y[0]/40|0,O=y[0]%40;if(v=x?y:[T,O].concat(y.slice(1)),g){let R=g[v.join(" ")];R===void 0&&(R=g[v.join(".")]),R!==void 0&&(v=R)}return v},h.prototype._decodeTime=function(p,g){const x=p.raw().toString();let v,y,b,j,T,O;if(g==="gentime")v=0|x.slice(0,4),y=0|x.slice(4,6),b=0|x.slice(6,8),j=0|x.slice(8,10),T=0|x.slice(10,12),O=0|x.slice(12,14);else{if(g!=="utctime")return p.error("Decoding "+g+" time is not supported yet");v=0|x.slice(0,2),y=0|x.slice(2,4),b=0|x.slice(4,6),j=0|x.slice(6,8),T=0|x.slice(8,10),O=0|x.slice(10,12),v=v<70?2e3+v:1900+v}return Date.UTC(v,y-1,b,j,T,O,0)},h.prototype._decodeNull=function(){return null},h.prototype._decodeBool=function(p){const g=p.readUInt8();return p.isError(g)?g:g!==0},h.prototype._decodeInt=function(p,g){const x=p.raw();let v=new o(x);return g&&(v=g[v.toString(10)]||v),v},h.prototype._use=function(p,g){return typeof p=="function"&&(p=p(g)),p._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(r,s,a){const i=a;i.der=r("./der"),i.pem=r("./pem")},{"./der":178,"./pem":180}],180:[function(r,s,a){const i=r("inherits"),o=r("safer-buffer").Buffer,l=r("./der");function d(c){l.call(this,c),this.enc="pem"}i(d,l),s.exports=d,d.prototype.decode=function(c,u){const h=c.toString().split(/[\r\n]+/g),f=u.label.toUpperCase(),m=/^-----(BEGIN|END) ([^-]+)-----$/;let p=-1,g=-1;for(let y=0;y<h.length;y++){const b=h[y].match(m);if(b!==null&&b[2]===f){if(p!==-1){if(b[1]!=="END")break;g=y;break}if(b[1]!=="BEGIN")break;p=y}}if(p===-1||g===-1)throw new Error("PEM section not found for: "+f);const x=h.slice(p+1,g).join("");x.replace(/[^a-z0-9+/=]+/gi,"");const v=o.from(x,"base64");return l.prototype.decode.call(this,v,u)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(r,s,a){const i=r("inherits"),o=r("safer-buffer").Buffer,l=r("../base/node"),d=r("../constants/der");function c(f){this.enc="der",this.name=f.name,this.entity=f,this.tree=new u,this.tree._init(f.body)}function u(f){l.call(this,"der",f)}function h(f){return f<10?"0"+f:f}s.exports=c,c.prototype.encode=function(f,m){return this.tree._encode(f,m).join()},i(u,l),u.prototype._encodeComposite=function(f,m,p,g){const x=function(b,j,T,O){let R;if(b==="seqof"?b="seq":b==="setof"&&(b="set"),d.tagByName.hasOwnProperty(b))R=d.tagByName[b];else{if(typeof b!="number"||(0|b)!==b)return O.error("Unknown tag: "+b);R=b}return R>=31?O.error("Multi-octet tag encoding unsupported"):(j||(R|=32),R|=d.tagClassByName[T||"universal"]<<6,R)}(f,m,p,this.reporter);if(g.length<128){const b=o.alloc(2);return b[0]=x,b[1]=g.length,this._createEncoderBuffer([b,g])}let v=1;for(let b=g.length;b>=256;b>>=8)v++;const y=o.alloc(2+v);y[0]=x,y[1]=128|v;for(let b=1+v,j=g.length;j>0;b--,j>>=8)y[b]=255&j;return this._createEncoderBuffer([y,g])},u.prototype._encodeStr=function(f,m){if(m==="bitstr")return this._createEncoderBuffer([0|f.unused,f.data]);if(m==="bmpstr"){const p=o.alloc(2*f.length);for(let g=0;g<f.length;g++)p.writeUInt16BE(f.charCodeAt(g),2*g);return this._createEncoderBuffer(p)}return m==="numstr"?this._isNumstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: numstr supports only digits and space"):m==="printstr"?this._isPrintstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(m)||m==="objDesc"?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: "+m+" unsupported")},u.prototype._encodeObjid=function(f,m,p){if(typeof f=="string"){if(!m)return this.reporter.error("string objid given, but no values map found");if(!m.hasOwnProperty(f))return this.reporter.error("objid not found in values map");f=m[f].split(/[\s.]+/g);for(let y=0;y<f.length;y++)f[y]|=0}else if(Array.isArray(f)){f=f.slice();for(let y=0;y<f.length;y++)f[y]|=0}if(!Array.isArray(f))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(f));if(!p){if(f[1]>=40)return this.reporter.error("Second objid identifier OOB");f.splice(0,2,40*f[0]+f[1])}let g=0;for(let y=0;y<f.length;y++){let b=f[y];for(g++;b>=128;b>>=7)g++}const x=o.alloc(g);let v=x.length-1;for(let y=f.length-1;y>=0;y--){let b=f[y];for(x[v--]=127&b;(b>>=7)>0;)x[v--]=128|127&b}return this._createEncoderBuffer(x)},u.prototype._encodeTime=function(f,m){let p;const g=new Date(f);return m==="gentime"?p=[h(g.getUTCFullYear()),h(g.getUTCMonth()+1),h(g.getUTCDate()),h(g.getUTCHours()),h(g.getUTCMinutes()),h(g.getUTCSeconds()),"Z"].join(""):m==="utctime"?p=[h(g.getUTCFullYear()%100),h(g.getUTCMonth()+1),h(g.getUTCDate()),h(g.getUTCHours()),h(g.getUTCMinutes()),h(g.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+m+" time is not supported yet"),this._encodeStr(p,"octstr")},u.prototype._encodeNull=function(){return this._createEncoderBuffer("")},u.prototype._encodeInt=function(f,m){if(typeof f=="string"){if(!m)return this.reporter.error("String int or enum given, but no values map");if(!m.hasOwnProperty(f))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(f));f=m[f]}if(typeof f!="number"&&!o.isBuffer(f)){const x=f.toArray();!f.sign&&128&x[0]&&x.unshift(0),f=o.from(x)}if(o.isBuffer(f)){let x=f.length;f.length===0&&x++;const v=o.alloc(x);return f.copy(v),f.length===0&&(v[0]=0),this._createEncoderBuffer(v)}if(f<128)return this._createEncoderBuffer(f);if(f<256)return this._createEncoderBuffer([0,f]);let p=1;for(let x=f;x>=256;x>>=8)p++;const g=new Array(p);for(let x=g.length-1;x>=0;x--)g[x]=255&f,f>>=8;return 128&g[0]&&g.unshift(0),this._createEncoderBuffer(o.from(g))},u.prototype._encodeBool=function(f){return this._createEncoderBuffer(f?255:0)},u.prototype._use=function(f,m){return typeof f=="function"&&(f=f(m)),f._getEncoder("der").tree},u.prototype._skipDefault=function(f,m,p){const g=this._baseState;let x;if(g.default===null)return!1;const v=f.join();if(g.defaultBuffer===void 0&&(g.defaultBuffer=this._encodeValue(g.default,m,p).join()),v.length!==g.defaultBuffer.length)return!1;for(x=0;x<v.length;x++)if(v[x]!==g.defaultBuffer[x])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(r,s,a){const i=a;i.der=r("./der"),i.pem=r("./pem")},{"./der":181,"./pem":183}],183:[function(r,s,a){const i=r("inherits"),o=r("./der");function l(d){o.call(this,d),this.enc="pem"}i(l,o),s.exports=l,l.prototype.encode=function(d,c){const u=o.prototype.encode.call(this,d).toString("base64"),h=["-----BEGIN "+c.label+"-----"];for(let f=0;f<u.length;f+=64)h.push(u.slice(f,f+64));return h.push("-----END "+c.label+"-----"),h.join(`
`)}},{"./der":181,inherits:440}],184:[function(r,s,a){(function(i,o){function l(I,F){if(!I)throw new Error(F||"Assertion failed")}function d(I,F){I.super_=F;var S=function(){};S.prototype=F.prototype,I.prototype=new S,I.prototype.constructor=I}function c(I,F,S){if(c.isBN(I))return I;this.negative=0,this.words=null,this.length=0,this.red=null,I!==null&&(F!=="le"&&F!=="be"||(S=F,F=10),this._init(I||0,F||10,S||"be"))}var u;typeof i=="object"?i.exports=c:(void 0).BN=c,c.BN=c,c.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:r("buffer").Buffer}catch{}function h(I,F){var S=I.charCodeAt(F);return S>=65&&S<=70?S-55:S>=97&&S<=102?S-87:S-48&15}function f(I,F,S){var E=h(I,S);return S-1>=F&&(E|=h(I,S-1)<<4),E}function m(I,F,S,E){for(var N=0,C=Math.min(I.length,S),k=F;k<C;k++){var M=I.charCodeAt(k)-48;N*=E,N+=M>=49?M-49+10:M>=17?M-17+10:M}return N}c.isBN=function(I){return I instanceof c||I!==null&&typeof I=="object"&&I.constructor.wordSize===c.wordSize&&Array.isArray(I.words)},c.max=function(I,F){return I.cmp(F)>0?I:F},c.min=function(I,F){return I.cmp(F)<0?I:F},c.prototype._init=function(I,F,S){if(typeof I=="number")return this._initNumber(I,F,S);if(typeof I=="object")return this._initArray(I,F,S);F==="hex"&&(F=16),l(F===(0|F)&&F>=2&&F<=36);var E=0;(I=I.toString().replace(/\s+/g,""))[0]==="-"&&(E++,this.negative=1),E<I.length&&(F===16?this._parseHex(I,E,S):(this._parseBase(I,F,E),S==="le"&&this._initArray(this.toArray(),F,S)))},c.prototype._initNumber=function(I,F,S){I<0&&(this.negative=1,I=-I),I<67108864?(this.words=[67108863&I],this.length=1):I<4503599627370496?(this.words=[67108863&I,I/67108864&67108863],this.length=2):(l(I<9007199254740992),this.words=[67108863&I,I/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),F,S)},c.prototype._initArray=function(I,F,S){if(l(typeof I.length=="number"),I.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(I.length/3),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var N,C,k=0;if(S==="be")for(E=I.length-1,N=0;E>=0;E-=3)C=I[E]|I[E-1]<<8|I[E-2]<<16,this.words[N]|=C<<k&67108863,this.words[N+1]=C>>>26-k&67108863,(k+=24)>=26&&(k-=26,N++);else if(S==="le")for(E=0,N=0;E<I.length;E+=3)C=I[E]|I[E+1]<<8|I[E+2]<<16,this.words[N]|=C<<k&67108863,this.words[N+1]=C>>>26-k&67108863,(k+=24)>=26&&(k-=26,N++);return this.strip()},c.prototype._parseHex=function(I,F,S){this.length=Math.ceil((I.length-F)/6),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var N,C=0,k=0;if(S==="be")for(E=I.length-1;E>=F;E-=2)N=f(I,F,E)<<C,this.words[k]|=67108863&N,C>=18?(C-=18,k+=1,this.words[k]|=N>>>26):C+=8;else for(E=(I.length-F)%2==0?F+1:F;E<I.length;E+=2)N=f(I,F,E)<<C,this.words[k]|=67108863&N,C>=18?(C-=18,k+=1,this.words[k]|=N>>>26):C+=8;this.strip()},c.prototype._parseBase=function(I,F,S){this.words=[0],this.length=1;for(var E=0,N=1;N<=67108863;N*=F)E++;E--,N=N/F|0;for(var C=I.length-S,k=C%E,M=Math.min(C,C-k)+S,U=0,$=S;$<M;$+=E)U=m(I,$,$+E,F),this.imuln(N),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U);if(k!==0){var X=1;for(U=m(I,$,I.length,F),$=0;$<k;$++)X*=F;this.imuln(X),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U)}this.strip()},c.prototype.copy=function(I){I.words=new Array(this.length);for(var F=0;F<this.length;F++)I.words[F]=this.words[F];I.length=this.length,I.negative=this.negative,I.red=this.red},c.prototype.clone=function(){var I=new c(null);return this.copy(I),I},c.prototype._expand=function(I){for(;this.length<I;)this.words[this.length++]=0;return this},c.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},c.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},c.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],x=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function v(I,F,S){S.negative=F.negative^I.negative;var E=I.length+F.length|0;S.length=E,E=E-1|0;var N=0|I.words[0],C=0|F.words[0],k=N*C,M=67108863&k,U=k/67108864|0;S.words[0]=M;for(var $=1;$<E;$++){for(var X=U>>>26,Z=67108863&U,re=Math.min($,F.length-1),W=Math.max(0,$-I.length+1);W<=re;W++){var J=$-W|0;X+=(k=(N=0|I.words[J])*(C=0|F.words[W])+Z)/67108864|0,Z=67108863&k}S.words[$]=0|Z,U=0|X}return U!==0?S.words[$]=0|U:S.length--,S.strip()}c.prototype.toString=function(I,F){var S;if(F=0|F||1,(I=I||10)===16||I==="hex"){S="";for(var E=0,N=0,C=0;C<this.length;C++){var k=this.words[C],M=(16777215&(k<<E|N)).toString(16);S=(N=k>>>24-E&16777215)!==0||C!==this.length-1?p[6-M.length]+M+S:M+S,(E+=2)>=26&&(E-=26,C--)}for(N!==0&&(S=N.toString(16)+S);S.length%F!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(I===(0|I)&&I>=2&&I<=36){var U=g[I],$=x[I];S="";var X=this.clone();for(X.negative=0;!X.isZero();){var Z=X.modn($).toString(I);S=(X=X.idivn($)).isZero()?Z+S:p[U-Z.length]+Z+S}for(this.isZero()&&(S="0"+S);S.length%F!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}l(!1,"Base should be between 2 and 36")},c.prototype.toNumber=function(){var I=this.words[0];return this.length===2?I+=67108864*this.words[1]:this.length===3&&this.words[2]===1?I+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-I:I},c.prototype.toJSON=function(){return this.toString(16)},c.prototype.toBuffer=function(I,F){return l(u!==void 0),this.toArrayLike(u,I,F)},c.prototype.toArray=function(I,F){return this.toArrayLike(Array,I,F)},c.prototype.toArrayLike=function(I,F,S){var E=this.byteLength(),N=S||Math.max(1,E);l(E<=N,"byte array longer than desired length"),l(N>0,"Requested array length <= 0"),this.strip();var C,k,M=F==="le",U=new I(N),$=this.clone();if(M){for(k=0;!$.isZero();k++)C=$.andln(255),$.iushrn(8),U[k]=C;for(;k<N;k++)U[k]=0}else{for(k=0;k<N-E;k++)U[k]=0;for(k=0;!$.isZero();k++)C=$.andln(255),$.iushrn(8),U[N-k-1]=C}return U},Math.clz32?c.prototype._countBits=function(I){return 32-Math.clz32(I)}:c.prototype._countBits=function(I){var F=I,S=0;return F>=4096&&(S+=13,F>>>=13),F>=64&&(S+=7,F>>>=7),F>=8&&(S+=4,F>>>=4),F>=2&&(S+=2,F>>>=2),S+F},c.prototype._zeroBits=function(I){if(I===0)return 26;var F=I,S=0;return!(8191&F)&&(S+=13,F>>>=13),!(127&F)&&(S+=7,F>>>=7),!(15&F)&&(S+=4,F>>>=4),!(3&F)&&(S+=2,F>>>=2),!(1&F)&&S++,S},c.prototype.bitLength=function(){var I=this.words[this.length-1],F=this._countBits(I);return 26*(this.length-1)+F},c.prototype.zeroBits=function(){if(this.isZero())return 0;for(var I=0,F=0;F<this.length;F++){var S=this._zeroBits(this.words[F]);if(I+=S,S!==26)break}return I},c.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},c.prototype.toTwos=function(I){return this.negative!==0?this.abs().inotn(I).iaddn(1):this.clone()},c.prototype.fromTwos=function(I){return this.testn(I-1)?this.notn(I).iaddn(1).ineg():this.clone()},c.prototype.isNeg=function(){return this.negative!==0},c.prototype.neg=function(){return this.clone().ineg()},c.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},c.prototype.iuor=function(I){for(;this.length<I.length;)this.words[this.length++]=0;for(var F=0;F<I.length;F++)this.words[F]=this.words[F]|I.words[F];return this.strip()},c.prototype.ior=function(I){return l((this.negative|I.negative)==0),this.iuor(I)},c.prototype.or=function(I){return this.length>I.length?this.clone().ior(I):I.clone().ior(this)},c.prototype.uor=function(I){return this.length>I.length?this.clone().iuor(I):I.clone().iuor(this)},c.prototype.iuand=function(I){var F;F=this.length>I.length?I:this;for(var S=0;S<F.length;S++)this.words[S]=this.words[S]&I.words[S];return this.length=F.length,this.strip()},c.prototype.iand=function(I){return l((this.negative|I.negative)==0),this.iuand(I)},c.prototype.and=function(I){return this.length>I.length?this.clone().iand(I):I.clone().iand(this)},c.prototype.uand=function(I){return this.length>I.length?this.clone().iuand(I):I.clone().iuand(this)},c.prototype.iuxor=function(I){var F,S;this.length>I.length?(F=this,S=I):(F=I,S=this);for(var E=0;E<S.length;E++)this.words[E]=F.words[E]^S.words[E];if(this!==F)for(;E<F.length;E++)this.words[E]=F.words[E];return this.length=F.length,this.strip()},c.prototype.ixor=function(I){return l((this.negative|I.negative)==0),this.iuxor(I)},c.prototype.xor=function(I){return this.length>I.length?this.clone().ixor(I):I.clone().ixor(this)},c.prototype.uxor=function(I){return this.length>I.length?this.clone().iuxor(I):I.clone().iuxor(this)},c.prototype.inotn=function(I){l(typeof I=="number"&&I>=0);var F=0|Math.ceil(I/26),S=I%26;this._expand(F),S>0&&F--;for(var E=0;E<F;E++)this.words[E]=67108863&~this.words[E];return S>0&&(this.words[E]=~this.words[E]&67108863>>26-S),this.strip()},c.prototype.notn=function(I){return this.clone().inotn(I)},c.prototype.setn=function(I,F){l(typeof I=="number"&&I>=0);var S=I/26|0,E=I%26;return this._expand(S+1),this.words[S]=F?this.words[S]|1<<E:this.words[S]&~(1<<E),this.strip()},c.prototype.iadd=function(I){var F,S,E;if(this.negative!==0&&I.negative===0)return this.negative=0,F=this.isub(I),this.negative^=1,this._normSign();if(this.negative===0&&I.negative!==0)return I.negative=0,F=this.isub(I),I.negative=1,F._normSign();this.length>I.length?(S=this,E=I):(S=I,E=this);for(var N=0,C=0;C<E.length;C++)F=(0|S.words[C])+(0|E.words[C])+N,this.words[C]=67108863&F,N=F>>>26;for(;N!==0&&C<S.length;C++)F=(0|S.words[C])+N,this.words[C]=67108863&F,N=F>>>26;if(this.length=S.length,N!==0)this.words[this.length]=N,this.length++;else if(S!==this)for(;C<S.length;C++)this.words[C]=S.words[C];return this},c.prototype.add=function(I){var F;return I.negative!==0&&this.negative===0?(I.negative=0,F=this.sub(I),I.negative^=1,F):I.negative===0&&this.negative!==0?(this.negative=0,F=I.sub(this),this.negative=1,F):this.length>I.length?this.clone().iadd(I):I.clone().iadd(this)},c.prototype.isub=function(I){if(I.negative!==0){I.negative=0;var F=this.iadd(I);return I.negative=1,F._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(I),this.negative=1,this._normSign();var S,E,N=this.cmp(I);if(N===0)return this.negative=0,this.length=1,this.words[0]=0,this;N>0?(S=this,E=I):(S=I,E=this);for(var C=0,k=0;k<E.length;k++)C=(F=(0|S.words[k])-(0|E.words[k])+C)>>26,this.words[k]=67108863&F;for(;C!==0&&k<S.length;k++)C=(F=(0|S.words[k])+C)>>26,this.words[k]=67108863&F;if(C===0&&k<S.length&&S!==this)for(;k<S.length;k++)this.words[k]=S.words[k];return this.length=Math.max(this.length,k),S!==this&&(this.negative=1),this.strip()},c.prototype.sub=function(I){return this.clone().isub(I)};var y=function(I,F,S){var E,N,C,k=I.words,M=F.words,U=S.words,$=0,X=0|k[0],Z=8191&X,re=X>>>13,W=0|k[1],J=8191&W,V=W>>>13,H=0|k[2],ee=8191&H,ie=H>>>13,oe=0|k[3],se=8191&oe,ue=oe>>>13,pe=0|k[4],ce=8191&pe,ne=pe>>>13,me=0|k[5],ge=8191&me,_e=me>>>13,be=0|k[6],ye=8191&be,Oe=be>>>13,Ne=0|k[7],De=8191&Ne,Ge=Ne>>>13,Qe=0|k[8],Ie=8191&Qe,Ae=Qe>>>13,st=0|k[9],nt=8191&st,vt=st>>>13,Je=0|M[0],Ue=8191&Je,Le=Je>>>13,Ze=0|M[1],ct=8191&Ze,ht=Ze>>>13,yt=0|M[2],Re=8191&yt,Ke=yt>>>13,_t=0|M[3],Rt=8191&_t,Se=_t>>>13,tt=0|M[4],ot=8191&tt,lt=tt>>>13,At=0|M[5],Nt=8191&At,ut=At>>>13,lr=0|M[6],Pt=8191&lr,Pe=lr>>>13,Me=0|M[7],it=8191&Me,gt=Me>>>13,dt=0|M[8],It=8191&dt,xr=dt>>>13,sr=0|M[9],ir=8191&sr,_r=sr>>>13;S.negative=I.negative^F.negative,S.length=19;var wr=($+(E=Math.imul(Z,Ue))|0)+((8191&(N=(N=Math.imul(Z,Le))+Math.imul(re,Ue)|0))<<13)|0;$=((C=Math.imul(re,Le))+(N>>>13)|0)+(wr>>>26)|0,wr&=67108863,E=Math.imul(J,Ue),N=(N=Math.imul(J,Le))+Math.imul(V,Ue)|0,C=Math.imul(V,Le);var jr=($+(E=E+Math.imul(Z,ct)|0)|0)+((8191&(N=(N=N+Math.imul(Z,ht)|0)+Math.imul(re,ct)|0))<<13)|0;$=((C=C+Math.imul(re,ht)|0)+(N>>>13)|0)+(jr>>>26)|0,jr&=67108863,E=Math.imul(ee,Ue),N=(N=Math.imul(ee,Le))+Math.imul(ie,Ue)|0,C=Math.imul(ie,Le),E=E+Math.imul(J,ct)|0,N=(N=N+Math.imul(J,ht)|0)+Math.imul(V,ct)|0,C=C+Math.imul(V,ht)|0;var rt=($+(E=E+Math.imul(Z,Re)|0)|0)+((8191&(N=(N=N+Math.imul(Z,Ke)|0)+Math.imul(re,Re)|0))<<13)|0;$=((C=C+Math.imul(re,Ke)|0)+(N>>>13)|0)+(rt>>>26)|0,rt&=67108863,E=Math.imul(se,Ue),N=(N=Math.imul(se,Le))+Math.imul(ue,Ue)|0,C=Math.imul(ue,Le),E=E+Math.imul(ee,ct)|0,N=(N=N+Math.imul(ee,ht)|0)+Math.imul(ie,ct)|0,C=C+Math.imul(ie,ht)|0,E=E+Math.imul(J,Re)|0,N=(N=N+Math.imul(J,Ke)|0)+Math.imul(V,Re)|0,C=C+Math.imul(V,Ke)|0;var Ot=($+(E=E+Math.imul(Z,Rt)|0)|0)+((8191&(N=(N=N+Math.imul(Z,Se)|0)+Math.imul(re,Rt)|0))<<13)|0;$=((C=C+Math.imul(re,Se)|0)+(N>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,E=Math.imul(ce,Ue),N=(N=Math.imul(ce,Le))+Math.imul(ne,Ue)|0,C=Math.imul(ne,Le),E=E+Math.imul(se,ct)|0,N=(N=N+Math.imul(se,ht)|0)+Math.imul(ue,ct)|0,C=C+Math.imul(ue,ht)|0,E=E+Math.imul(ee,Re)|0,N=(N=N+Math.imul(ee,Ke)|0)+Math.imul(ie,Re)|0,C=C+Math.imul(ie,Ke)|0,E=E+Math.imul(J,Rt)|0,N=(N=N+Math.imul(J,Se)|0)+Math.imul(V,Rt)|0,C=C+Math.imul(V,Se)|0;var rr=($+(E=E+Math.imul(Z,ot)|0)|0)+((8191&(N=(N=N+Math.imul(Z,lt)|0)+Math.imul(re,ot)|0))<<13)|0;$=((C=C+Math.imul(re,lt)|0)+(N>>>13)|0)+(rr>>>26)|0,rr&=67108863,E=Math.imul(ge,Ue),N=(N=Math.imul(ge,Le))+Math.imul(_e,Ue)|0,C=Math.imul(_e,Le),E=E+Math.imul(ce,ct)|0,N=(N=N+Math.imul(ce,ht)|0)+Math.imul(ne,ct)|0,C=C+Math.imul(ne,ht)|0,E=E+Math.imul(se,Re)|0,N=(N=N+Math.imul(se,Ke)|0)+Math.imul(ue,Re)|0,C=C+Math.imul(ue,Ke)|0,E=E+Math.imul(ee,Rt)|0,N=(N=N+Math.imul(ee,Se)|0)+Math.imul(ie,Rt)|0,C=C+Math.imul(ie,Se)|0,E=E+Math.imul(J,ot)|0,N=(N=N+Math.imul(J,lt)|0)+Math.imul(V,ot)|0,C=C+Math.imul(V,lt)|0;var nr=($+(E=E+Math.imul(Z,Nt)|0)|0)+((8191&(N=(N=N+Math.imul(Z,ut)|0)+Math.imul(re,Nt)|0))<<13)|0;$=((C=C+Math.imul(re,ut)|0)+(N>>>13)|0)+(nr>>>26)|0,nr&=67108863,E=Math.imul(ye,Ue),N=(N=Math.imul(ye,Le))+Math.imul(Oe,Ue)|0,C=Math.imul(Oe,Le),E=E+Math.imul(ge,ct)|0,N=(N=N+Math.imul(ge,ht)|0)+Math.imul(_e,ct)|0,C=C+Math.imul(_e,ht)|0,E=E+Math.imul(ce,Re)|0,N=(N=N+Math.imul(ce,Ke)|0)+Math.imul(ne,Re)|0,C=C+Math.imul(ne,Ke)|0,E=E+Math.imul(se,Rt)|0,N=(N=N+Math.imul(se,Se)|0)+Math.imul(ue,Rt)|0,C=C+Math.imul(ue,Se)|0,E=E+Math.imul(ee,ot)|0,N=(N=N+Math.imul(ee,lt)|0)+Math.imul(ie,ot)|0,C=C+Math.imul(ie,lt)|0,E=E+Math.imul(J,Nt)|0,N=(N=N+Math.imul(J,ut)|0)+Math.imul(V,Nt)|0,C=C+Math.imul(V,ut)|0;var Qt=($+(E=E+Math.imul(Z,Pt)|0)|0)+((8191&(N=(N=N+Math.imul(Z,Pe)|0)+Math.imul(re,Pt)|0))<<13)|0;$=((C=C+Math.imul(re,Pe)|0)+(N>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,E=Math.imul(De,Ue),N=(N=Math.imul(De,Le))+Math.imul(Ge,Ue)|0,C=Math.imul(Ge,Le),E=E+Math.imul(ye,ct)|0,N=(N=N+Math.imul(ye,ht)|0)+Math.imul(Oe,ct)|0,C=C+Math.imul(Oe,ht)|0,E=E+Math.imul(ge,Re)|0,N=(N=N+Math.imul(ge,Ke)|0)+Math.imul(_e,Re)|0,C=C+Math.imul(_e,Ke)|0,E=E+Math.imul(ce,Rt)|0,N=(N=N+Math.imul(ce,Se)|0)+Math.imul(ne,Rt)|0,C=C+Math.imul(ne,Se)|0,E=E+Math.imul(se,ot)|0,N=(N=N+Math.imul(se,lt)|0)+Math.imul(ue,ot)|0,C=C+Math.imul(ue,lt)|0,E=E+Math.imul(ee,Nt)|0,N=(N=N+Math.imul(ee,ut)|0)+Math.imul(ie,Nt)|0,C=C+Math.imul(ie,ut)|0,E=E+Math.imul(J,Pt)|0,N=(N=N+Math.imul(J,Pe)|0)+Math.imul(V,Pt)|0,C=C+Math.imul(V,Pe)|0;var Ce=($+(E=E+Math.imul(Z,it)|0)|0)+((8191&(N=(N=N+Math.imul(Z,gt)|0)+Math.imul(re,it)|0))<<13)|0;$=((C=C+Math.imul(re,gt)|0)+(N>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,E=Math.imul(Ie,Ue),N=(N=Math.imul(Ie,Le))+Math.imul(Ae,Ue)|0,C=Math.imul(Ae,Le),E=E+Math.imul(De,ct)|0,N=(N=N+Math.imul(De,ht)|0)+Math.imul(Ge,ct)|0,C=C+Math.imul(Ge,ht)|0,E=E+Math.imul(ye,Re)|0,N=(N=N+Math.imul(ye,Ke)|0)+Math.imul(Oe,Re)|0,C=C+Math.imul(Oe,Ke)|0,E=E+Math.imul(ge,Rt)|0,N=(N=N+Math.imul(ge,Se)|0)+Math.imul(_e,Rt)|0,C=C+Math.imul(_e,Se)|0,E=E+Math.imul(ce,ot)|0,N=(N=N+Math.imul(ce,lt)|0)+Math.imul(ne,ot)|0,C=C+Math.imul(ne,lt)|0,E=E+Math.imul(se,Nt)|0,N=(N=N+Math.imul(se,ut)|0)+Math.imul(ue,Nt)|0,C=C+Math.imul(ue,ut)|0,E=E+Math.imul(ee,Pt)|0,N=(N=N+Math.imul(ee,Pe)|0)+Math.imul(ie,Pt)|0,C=C+Math.imul(ie,Pe)|0,E=E+Math.imul(J,it)|0,N=(N=N+Math.imul(J,gt)|0)+Math.imul(V,it)|0,C=C+Math.imul(V,gt)|0;var Xe=($+(E=E+Math.imul(Z,It)|0)|0)+((8191&(N=(N=N+Math.imul(Z,xr)|0)+Math.imul(re,It)|0))<<13)|0;$=((C=C+Math.imul(re,xr)|0)+(N>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,E=Math.imul(nt,Ue),N=(N=Math.imul(nt,Le))+Math.imul(vt,Ue)|0,C=Math.imul(vt,Le),E=E+Math.imul(Ie,ct)|0,N=(N=N+Math.imul(Ie,ht)|0)+Math.imul(Ae,ct)|0,C=C+Math.imul(Ae,ht)|0,E=E+Math.imul(De,Re)|0,N=(N=N+Math.imul(De,Ke)|0)+Math.imul(Ge,Re)|0,C=C+Math.imul(Ge,Ke)|0,E=E+Math.imul(ye,Rt)|0,N=(N=N+Math.imul(ye,Se)|0)+Math.imul(Oe,Rt)|0,C=C+Math.imul(Oe,Se)|0,E=E+Math.imul(ge,ot)|0,N=(N=N+Math.imul(ge,lt)|0)+Math.imul(_e,ot)|0,C=C+Math.imul(_e,lt)|0,E=E+Math.imul(ce,Nt)|0,N=(N=N+Math.imul(ce,ut)|0)+Math.imul(ne,Nt)|0,C=C+Math.imul(ne,ut)|0,E=E+Math.imul(se,Pt)|0,N=(N=N+Math.imul(se,Pe)|0)+Math.imul(ue,Pt)|0,C=C+Math.imul(ue,Pe)|0,E=E+Math.imul(ee,it)|0,N=(N=N+Math.imul(ee,gt)|0)+Math.imul(ie,it)|0,C=C+Math.imul(ie,gt)|0,E=E+Math.imul(J,It)|0,N=(N=N+Math.imul(J,xr)|0)+Math.imul(V,It)|0,C=C+Math.imul(V,xr)|0;var ft=($+(E=E+Math.imul(Z,ir)|0)|0)+((8191&(N=(N=N+Math.imul(Z,_r)|0)+Math.imul(re,ir)|0))<<13)|0;$=((C=C+Math.imul(re,_r)|0)+(N>>>13)|0)+(ft>>>26)|0,ft&=67108863,E=Math.imul(nt,ct),N=(N=Math.imul(nt,ht))+Math.imul(vt,ct)|0,C=Math.imul(vt,ht),E=E+Math.imul(Ie,Re)|0,N=(N=N+Math.imul(Ie,Ke)|0)+Math.imul(Ae,Re)|0,C=C+Math.imul(Ae,Ke)|0,E=E+Math.imul(De,Rt)|0,N=(N=N+Math.imul(De,Se)|0)+Math.imul(Ge,Rt)|0,C=C+Math.imul(Ge,Se)|0,E=E+Math.imul(ye,ot)|0,N=(N=N+Math.imul(ye,lt)|0)+Math.imul(Oe,ot)|0,C=C+Math.imul(Oe,lt)|0,E=E+Math.imul(ge,Nt)|0,N=(N=N+Math.imul(ge,ut)|0)+Math.imul(_e,Nt)|0,C=C+Math.imul(_e,ut)|0,E=E+Math.imul(ce,Pt)|0,N=(N=N+Math.imul(ce,Pe)|0)+Math.imul(ne,Pt)|0,C=C+Math.imul(ne,Pe)|0,E=E+Math.imul(se,it)|0,N=(N=N+Math.imul(se,gt)|0)+Math.imul(ue,it)|0,C=C+Math.imul(ue,gt)|0,E=E+Math.imul(ee,It)|0,N=(N=N+Math.imul(ee,xr)|0)+Math.imul(ie,It)|0,C=C+Math.imul(ie,xr)|0;var ze=($+(E=E+Math.imul(J,ir)|0)|0)+((8191&(N=(N=N+Math.imul(J,_r)|0)+Math.imul(V,ir)|0))<<13)|0;$=((C=C+Math.imul(V,_r)|0)+(N>>>13)|0)+(ze>>>26)|0,ze&=67108863,E=Math.imul(nt,Re),N=(N=Math.imul(nt,Ke))+Math.imul(vt,Re)|0,C=Math.imul(vt,Ke),E=E+Math.imul(Ie,Rt)|0,N=(N=N+Math.imul(Ie,Se)|0)+Math.imul(Ae,Rt)|0,C=C+Math.imul(Ae,Se)|0,E=E+Math.imul(De,ot)|0,N=(N=N+Math.imul(De,lt)|0)+Math.imul(Ge,ot)|0,C=C+Math.imul(Ge,lt)|0,E=E+Math.imul(ye,Nt)|0,N=(N=N+Math.imul(ye,ut)|0)+Math.imul(Oe,Nt)|0,C=C+Math.imul(Oe,ut)|0,E=E+Math.imul(ge,Pt)|0,N=(N=N+Math.imul(ge,Pe)|0)+Math.imul(_e,Pt)|0,C=C+Math.imul(_e,Pe)|0,E=E+Math.imul(ce,it)|0,N=(N=N+Math.imul(ce,gt)|0)+Math.imul(ne,it)|0,C=C+Math.imul(ne,gt)|0,E=E+Math.imul(se,It)|0,N=(N=N+Math.imul(se,xr)|0)+Math.imul(ue,It)|0,C=C+Math.imul(ue,xr)|0;var Zt=($+(E=E+Math.imul(ee,ir)|0)|0)+((8191&(N=(N=N+Math.imul(ee,_r)|0)+Math.imul(ie,ir)|0))<<13)|0;$=((C=C+Math.imul(ie,_r)|0)+(N>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,E=Math.imul(nt,Rt),N=(N=Math.imul(nt,Se))+Math.imul(vt,Rt)|0,C=Math.imul(vt,Se),E=E+Math.imul(Ie,ot)|0,N=(N=N+Math.imul(Ie,lt)|0)+Math.imul(Ae,ot)|0,C=C+Math.imul(Ae,lt)|0,E=E+Math.imul(De,Nt)|0,N=(N=N+Math.imul(De,ut)|0)+Math.imul(Ge,Nt)|0,C=C+Math.imul(Ge,ut)|0,E=E+Math.imul(ye,Pt)|0,N=(N=N+Math.imul(ye,Pe)|0)+Math.imul(Oe,Pt)|0,C=C+Math.imul(Oe,Pe)|0,E=E+Math.imul(ge,it)|0,N=(N=N+Math.imul(ge,gt)|0)+Math.imul(_e,it)|0,C=C+Math.imul(_e,gt)|0,E=E+Math.imul(ce,It)|0,N=(N=N+Math.imul(ce,xr)|0)+Math.imul(ne,It)|0,C=C+Math.imul(ne,xr)|0;var wt=($+(E=E+Math.imul(se,ir)|0)|0)+((8191&(N=(N=N+Math.imul(se,_r)|0)+Math.imul(ue,ir)|0))<<13)|0;$=((C=C+Math.imul(ue,_r)|0)+(N>>>13)|0)+(wt>>>26)|0,wt&=67108863,E=Math.imul(nt,ot),N=(N=Math.imul(nt,lt))+Math.imul(vt,ot)|0,C=Math.imul(vt,lt),E=E+Math.imul(Ie,Nt)|0,N=(N=N+Math.imul(Ie,ut)|0)+Math.imul(Ae,Nt)|0,C=C+Math.imul(Ae,ut)|0,E=E+Math.imul(De,Pt)|0,N=(N=N+Math.imul(De,Pe)|0)+Math.imul(Ge,Pt)|0,C=C+Math.imul(Ge,Pe)|0,E=E+Math.imul(ye,it)|0,N=(N=N+Math.imul(ye,gt)|0)+Math.imul(Oe,it)|0,C=C+Math.imul(Oe,gt)|0,E=E+Math.imul(ge,It)|0,N=(N=N+Math.imul(ge,xr)|0)+Math.imul(_e,It)|0,C=C+Math.imul(_e,xr)|0;var kt=($+(E=E+Math.imul(ce,ir)|0)|0)+((8191&(N=(N=N+Math.imul(ce,_r)|0)+Math.imul(ne,ir)|0))<<13)|0;$=((C=C+Math.imul(ne,_r)|0)+(N>>>13)|0)+(kt>>>26)|0,kt&=67108863,E=Math.imul(nt,Nt),N=(N=Math.imul(nt,ut))+Math.imul(vt,Nt)|0,C=Math.imul(vt,ut),E=E+Math.imul(Ie,Pt)|0,N=(N=N+Math.imul(Ie,Pe)|0)+Math.imul(Ae,Pt)|0,C=C+Math.imul(Ae,Pe)|0,E=E+Math.imul(De,it)|0,N=(N=N+Math.imul(De,gt)|0)+Math.imul(Ge,it)|0,C=C+Math.imul(Ge,gt)|0,E=E+Math.imul(ye,It)|0,N=(N=N+Math.imul(ye,xr)|0)+Math.imul(Oe,It)|0,C=C+Math.imul(Oe,xr)|0;var Cr=($+(E=E+Math.imul(ge,ir)|0)|0)+((8191&(N=(N=N+Math.imul(ge,_r)|0)+Math.imul(_e,ir)|0))<<13)|0;$=((C=C+Math.imul(_e,_r)|0)+(N>>>13)|0)+(Cr>>>26)|0,Cr&=67108863,E=Math.imul(nt,Pt),N=(N=Math.imul(nt,Pe))+Math.imul(vt,Pt)|0,C=Math.imul(vt,Pe),E=E+Math.imul(Ie,it)|0,N=(N=N+Math.imul(Ie,gt)|0)+Math.imul(Ae,it)|0,C=C+Math.imul(Ae,gt)|0,E=E+Math.imul(De,It)|0,N=(N=N+Math.imul(De,xr)|0)+Math.imul(Ge,It)|0,C=C+Math.imul(Ge,xr)|0;var Jt=($+(E=E+Math.imul(ye,ir)|0)|0)+((8191&(N=(N=N+Math.imul(ye,_r)|0)+Math.imul(Oe,ir)|0))<<13)|0;$=((C=C+Math.imul(Oe,_r)|0)+(N>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,E=Math.imul(nt,it),N=(N=Math.imul(nt,gt))+Math.imul(vt,it)|0,C=Math.imul(vt,gt),E=E+Math.imul(Ie,It)|0,N=(N=N+Math.imul(Ie,xr)|0)+Math.imul(Ae,It)|0,C=C+Math.imul(Ae,xr)|0;var tr=($+(E=E+Math.imul(De,ir)|0)|0)+((8191&(N=(N=N+Math.imul(De,_r)|0)+Math.imul(Ge,ir)|0))<<13)|0;$=((C=C+Math.imul(Ge,_r)|0)+(N>>>13)|0)+(tr>>>26)|0,tr&=67108863,E=Math.imul(nt,It),N=(N=Math.imul(nt,xr))+Math.imul(vt,It)|0,C=Math.imul(vt,xr);var Ut=($+(E=E+Math.imul(Ie,ir)|0)|0)+((8191&(N=(N=N+Math.imul(Ie,_r)|0)+Math.imul(Ae,ir)|0))<<13)|0;$=((C=C+Math.imul(Ae,_r)|0)+(N>>>13)|0)+(Ut>>>26)|0,Ut&=67108863;var xn=($+(E=Math.imul(nt,ir))|0)+((8191&(N=(N=Math.imul(nt,_r))+Math.imul(vt,ir)|0))<<13)|0;return $=((C=Math.imul(vt,_r))+(N>>>13)|0)+(xn>>>26)|0,xn&=67108863,U[0]=wr,U[1]=jr,U[2]=rt,U[3]=Ot,U[4]=rr,U[5]=nr,U[6]=Qt,U[7]=Ce,U[8]=Xe,U[9]=ft,U[10]=ze,U[11]=Zt,U[12]=wt,U[13]=kt,U[14]=Cr,U[15]=Jt,U[16]=tr,U[17]=Ut,U[18]=xn,$!==0&&(U[19]=$,S.length++),S};function b(I,F,S){return new j().mulp(I,F,S)}function j(I,F){this.x=I,this.y=F}Math.imul||(y=v),c.prototype.mulTo=function(I,F){var S=this.length+I.length;return this.length===10&&I.length===10?y(this,I,F):S<63?v(this,I,F):S<1024?function(E,N,C){C.negative=N.negative^E.negative,C.length=E.length+N.length;for(var k=0,M=0,U=0;U<C.length-1;U++){var $=M;M=0;for(var X=67108863&k,Z=Math.min(U,N.length-1),re=Math.max(0,U-E.length+1);re<=Z;re++){var W=U-re,J=(0|E.words[W])*(0|N.words[re]),V=67108863&J;X=67108863&(V=V+X|0),M+=($=($=$+(J/67108864|0)|0)+(V>>>26)|0)>>>26,$&=67108863}C.words[U]=X,k=$,$=M}return k!==0?C.words[U]=k:C.length--,C.strip()}(this,I,F):b(this,I,F)},j.prototype.makeRBT=function(I){for(var F=new Array(I),S=c.prototype._countBits(I)-1,E=0;E<I;E++)F[E]=this.revBin(E,S,I);return F},j.prototype.revBin=function(I,F,S){if(I===0||I===S-1)return I;for(var E=0,N=0;N<F;N++)E|=(1&I)<<F-N-1,I>>=1;return E},j.prototype.permute=function(I,F,S,E,N,C){for(var k=0;k<C;k++)E[k]=F[I[k]],N[k]=S[I[k]]},j.prototype.transform=function(I,F,S,E,N,C){this.permute(C,I,F,S,E,N);for(var k=1;k<N;k<<=1)for(var M=k<<1,U=Math.cos(2*Math.PI/M),$=Math.sin(2*Math.PI/M),X=0;X<N;X+=M)for(var Z=U,re=$,W=0;W<k;W++){var J=S[X+W],V=E[X+W],H=S[X+W+k],ee=E[X+W+k],ie=Z*H-re*ee;ee=Z*ee+re*H,H=ie,S[X+W]=J+H,E[X+W]=V+ee,S[X+W+k]=J-H,E[X+W+k]=V-ee,W!==M&&(ie=U*Z-$*re,re=U*re+$*Z,Z=ie)}},j.prototype.guessLen13b=function(I,F){var S=1|Math.max(F,I),E=1&S,N=0;for(S=S/2|0;S;S>>>=1)N++;return 1<<N+1+E},j.prototype.conjugate=function(I,F,S){if(!(S<=1))for(var E=0;E<S/2;E++){var N=I[E];I[E]=I[S-E-1],I[S-E-1]=N,N=F[E],F[E]=-F[S-E-1],F[S-E-1]=-N}},j.prototype.normalize13b=function(I,F){for(var S=0,E=0;E<F/2;E++){var N=8192*Math.round(I[2*E+1]/F)+Math.round(I[2*E]/F)+S;I[E]=67108863&N,S=N<67108864?0:N/67108864|0}return I},j.prototype.convert13b=function(I,F,S,E){for(var N=0,C=0;C<F;C++)N+=0|I[C],S[2*C]=8191&N,N>>>=13,S[2*C+1]=8191&N,N>>>=13;for(C=2*F;C<E;++C)S[C]=0;l(N===0),l((-8192&N)==0)},j.prototype.stub=function(I){for(var F=new Array(I),S=0;S<I;S++)F[S]=0;return F},j.prototype.mulp=function(I,F,S){var E=2*this.guessLen13b(I.length,F.length),N=this.makeRBT(E),C=this.stub(E),k=new Array(E),M=new Array(E),U=new Array(E),$=new Array(E),X=new Array(E),Z=new Array(E),re=S.words;re.length=E,this.convert13b(I.words,I.length,k,E),this.convert13b(F.words,F.length,$,E),this.transform(k,C,M,U,E,N),this.transform($,C,X,Z,E,N);for(var W=0;W<E;W++){var J=M[W]*X[W]-U[W]*Z[W];U[W]=M[W]*Z[W]+U[W]*X[W],M[W]=J}return this.conjugate(M,U,E),this.transform(M,U,re,C,E,N),this.conjugate(re,C,E),this.normalize13b(re,E),S.negative=I.negative^F.negative,S.length=I.length+F.length,S.strip()},c.prototype.mul=function(I){var F=new c(null);return F.words=new Array(this.length+I.length),this.mulTo(I,F)},c.prototype.mulf=function(I){var F=new c(null);return F.words=new Array(this.length+I.length),b(this,I,F)},c.prototype.imul=function(I){return this.clone().mulTo(I,this)},c.prototype.imuln=function(I){l(typeof I=="number"),l(I<67108864);for(var F=0,S=0;S<this.length;S++){var E=(0|this.words[S])*I,N=(67108863&E)+(67108863&F);F>>=26,F+=E/67108864|0,F+=N>>>26,this.words[S]=67108863&N}return F!==0&&(this.words[S]=F,this.length++),this},c.prototype.muln=function(I){return this.clone().imuln(I)},c.prototype.sqr=function(){return this.mul(this)},c.prototype.isqr=function(){return this.imul(this.clone())},c.prototype.pow=function(I){var F=function(C){for(var k=new Array(C.bitLength()),M=0;M<k.length;M++){var U=M/26|0,$=M%26;k[M]=(C.words[U]&1<<$)>>>$}return k}(I);if(F.length===0)return new c(1);for(var S=this,E=0;E<F.length&&F[E]===0;E++,S=S.sqr());if(++E<F.length)for(var N=S.sqr();E<F.length;E++,N=N.sqr())F[E]!==0&&(S=S.mul(N));return S},c.prototype.iushln=function(I){l(typeof I=="number"&&I>=0);var F,S=I%26,E=(I-S)/26,N=67108863>>>26-S<<26-S;if(S!==0){var C=0;for(F=0;F<this.length;F++){var k=this.words[F]&N,M=(0|this.words[F])-k<<S;this.words[F]=M|C,C=k>>>26-S}C&&(this.words[F]=C,this.length++)}if(E!==0){for(F=this.length-1;F>=0;F--)this.words[F+E]=this.words[F];for(F=0;F<E;F++)this.words[F]=0;this.length+=E}return this.strip()},c.prototype.ishln=function(I){return l(this.negative===0),this.iushln(I)},c.prototype.iushrn=function(I,F,S){var E;l(typeof I=="number"&&I>=0),E=F?(F-F%26)/26:0;var N=I%26,C=Math.min((I-N)/26,this.length),k=67108863^67108863>>>N<<N,M=S;if(E-=C,E=Math.max(0,E),M){for(var U=0;U<C;U++)M.words[U]=this.words[U];M.length=C}if(C!==0)if(this.length>C)for(this.length-=C,U=0;U<this.length;U++)this.words[U]=this.words[U+C];else this.words[0]=0,this.length=1;var $=0;for(U=this.length-1;U>=0&&($!==0||U>=E);U--){var X=0|this.words[U];this.words[U]=$<<26-N|X>>>N,$=X&k}return M&&$!==0&&(M.words[M.length++]=$),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},c.prototype.ishrn=function(I,F,S){return l(this.negative===0),this.iushrn(I,F,S)},c.prototype.shln=function(I){return this.clone().ishln(I)},c.prototype.ushln=function(I){return this.clone().iushln(I)},c.prototype.shrn=function(I){return this.clone().ishrn(I)},c.prototype.ushrn=function(I){return this.clone().iushrn(I)},c.prototype.testn=function(I){l(typeof I=="number"&&I>=0);var F=I%26,S=(I-F)/26,E=1<<F;return!(this.length<=S)&&!!(this.words[S]&E)},c.prototype.imaskn=function(I){l(typeof I=="number"&&I>=0);var F=I%26,S=(I-F)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(F!==0&&S++,this.length=Math.min(S,this.length),F!==0){var E=67108863^67108863>>>F<<F;this.words[this.length-1]&=E}return this.strip()},c.prototype.maskn=function(I){return this.clone().imaskn(I)},c.prototype.iaddn=function(I){return l(typeof I=="number"),l(I<67108864),I<0?this.isubn(-I):this.negative!==0?this.length===1&&(0|this.words[0])<I?(this.words[0]=I-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(I),this.negative=1,this):this._iaddn(I)},c.prototype._iaddn=function(I){this.words[0]+=I;for(var F=0;F<this.length&&this.words[F]>=67108864;F++)this.words[F]-=67108864,F===this.length-1?this.words[F+1]=1:this.words[F+1]++;return this.length=Math.max(this.length,F+1),this},c.prototype.isubn=function(I){if(l(typeof I=="number"),l(I<67108864),I<0)return this.iaddn(-I);if(this.negative!==0)return this.negative=0,this.iaddn(I),this.negative=1,this;if(this.words[0]-=I,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var F=0;F<this.length&&this.words[F]<0;F++)this.words[F]+=67108864,this.words[F+1]-=1;return this.strip()},c.prototype.addn=function(I){return this.clone().iaddn(I)},c.prototype.subn=function(I){return this.clone().isubn(I)},c.prototype.iabs=function(){return this.negative=0,this},c.prototype.abs=function(){return this.clone().iabs()},c.prototype._ishlnsubmul=function(I,F,S){var E,N,C=I.length+S;this._expand(C);var k=0;for(E=0;E<I.length;E++){N=(0|this.words[E+S])+k;var M=(0|I.words[E])*F;k=((N-=67108863&M)>>26)-(M/67108864|0),this.words[E+S]=67108863&N}for(;E<this.length-S;E++)k=(N=(0|this.words[E+S])+k)>>26,this.words[E+S]=67108863&N;if(k===0)return this.strip();for(l(k===-1),k=0,E=0;E<this.length;E++)k=(N=-(0|this.words[E])+k)>>26,this.words[E]=67108863&N;return this.negative=1,this.strip()},c.prototype._wordDiv=function(I,F){var S=(this.length,I.length),E=this.clone(),N=I,C=0|N.words[N.length-1];(S=26-this._countBits(C))!==0&&(N=N.ushln(S),E.iushln(S),C=0|N.words[N.length-1]);var k,M=E.length-N.length;if(F!=="mod"){(k=new c(null)).length=M+1,k.words=new Array(k.length);for(var U=0;U<k.length;U++)k.words[U]=0}var $=E.clone()._ishlnsubmul(N,1,M);$.negative===0&&(E=$,k&&(k.words[M]=1));for(var X=M-1;X>=0;X--){var Z=67108864*(0|E.words[N.length+X])+(0|E.words[N.length+X-1]);for(Z=Math.min(Z/C|0,67108863),E._ishlnsubmul(N,Z,X);E.negative!==0;)Z--,E.negative=0,E._ishlnsubmul(N,1,X),E.isZero()||(E.negative^=1);k&&(k.words[X]=Z)}return k&&k.strip(),E.strip(),F!=="div"&&S!==0&&E.iushrn(S),{div:k||null,mod:E}},c.prototype.divmod=function(I,F,S){return l(!I.isZero()),this.isZero()?{div:new c(0),mod:new c(0)}:this.negative!==0&&I.negative===0?(C=this.neg().divmod(I,F),F!=="mod"&&(E=C.div.neg()),F!=="div"&&(N=C.mod.neg(),S&&N.negative!==0&&N.iadd(I)),{div:E,mod:N}):this.negative===0&&I.negative!==0?(C=this.divmod(I.neg(),F),F!=="mod"&&(E=C.div.neg()),{div:E,mod:C.mod}):this.negative&I.negative?(C=this.neg().divmod(I.neg(),F),F!=="div"&&(N=C.mod.neg(),S&&N.negative!==0&&N.isub(I)),{div:C.div,mod:N}):I.length>this.length||this.cmp(I)<0?{div:new c(0),mod:this}:I.length===1?F==="div"?{div:this.divn(I.words[0]),mod:null}:F==="mod"?{div:null,mod:new c(this.modn(I.words[0]))}:{div:this.divn(I.words[0]),mod:new c(this.modn(I.words[0]))}:this._wordDiv(I,F);var E,N,C},c.prototype.div=function(I){return this.divmod(I,"div",!1).div},c.prototype.mod=function(I){return this.divmod(I,"mod",!1).mod},c.prototype.umod=function(I){return this.divmod(I,"mod",!0).mod},c.prototype.divRound=function(I){var F=this.divmod(I);if(F.mod.isZero())return F.div;var S=F.div.negative!==0?F.mod.isub(I):F.mod,E=I.ushrn(1),N=I.andln(1),C=S.cmp(E);return C<0||N===1&&C===0?F.div:F.div.negative!==0?F.div.isubn(1):F.div.iaddn(1)},c.prototype.modn=function(I){l(I<=67108863);for(var F=(1<<26)%I,S=0,E=this.length-1;E>=0;E--)S=(F*S+(0|this.words[E]))%I;return S},c.prototype.idivn=function(I){l(I<=67108863);for(var F=0,S=this.length-1;S>=0;S--){var E=(0|this.words[S])+67108864*F;this.words[S]=E/I|0,F=E%I}return this.strip()},c.prototype.divn=function(I){return this.clone().idivn(I)},c.prototype.egcd=function(I){l(I.negative===0),l(!I.isZero());var F=this,S=I.clone();F=F.negative!==0?F.umod(I):F.clone();for(var E=new c(1),N=new c(0),C=new c(0),k=new c(1),M=0;F.isEven()&&S.isEven();)F.iushrn(1),S.iushrn(1),++M;for(var U=S.clone(),$=F.clone();!F.isZero();){for(var X=0,Z=1;!(F.words[0]&Z)&&X<26;++X,Z<<=1);if(X>0)for(F.iushrn(X);X-- >0;)(E.isOdd()||N.isOdd())&&(E.iadd(U),N.isub($)),E.iushrn(1),N.iushrn(1);for(var re=0,W=1;!(S.words[0]&W)&&re<26;++re,W<<=1);if(re>0)for(S.iushrn(re);re-- >0;)(C.isOdd()||k.isOdd())&&(C.iadd(U),k.isub($)),C.iushrn(1),k.iushrn(1);F.cmp(S)>=0?(F.isub(S),E.isub(C),N.isub(k)):(S.isub(F),C.isub(E),k.isub(N))}return{a:C,b:k,gcd:S.iushln(M)}},c.prototype._invmp=function(I){l(I.negative===0),l(!I.isZero());var F=this,S=I.clone();F=F.negative!==0?F.umod(I):F.clone();for(var E,N=new c(1),C=new c(0),k=S.clone();F.cmpn(1)>0&&S.cmpn(1)>0;){for(var M=0,U=1;!(F.words[0]&U)&&M<26;++M,U<<=1);if(M>0)for(F.iushrn(M);M-- >0;)N.isOdd()&&N.iadd(k),N.iushrn(1);for(var $=0,X=1;!(S.words[0]&X)&&$<26;++$,X<<=1);if($>0)for(S.iushrn($);$-- >0;)C.isOdd()&&C.iadd(k),C.iushrn(1);F.cmp(S)>=0?(F.isub(S),N.isub(C)):(S.isub(F),C.isub(N))}return(E=F.cmpn(1)===0?N:C).cmpn(0)<0&&E.iadd(I),E},c.prototype.gcd=function(I){if(this.isZero())return I.abs();if(I.isZero())return this.abs();var F=this.clone(),S=I.clone();F.negative=0,S.negative=0;for(var E=0;F.isEven()&&S.isEven();E++)F.iushrn(1),S.iushrn(1);for(;;){for(;F.isEven();)F.iushrn(1);for(;S.isEven();)S.iushrn(1);var N=F.cmp(S);if(N<0){var C=F;F=S,S=C}else if(N===0||S.cmpn(1)===0)break;F.isub(S)}return S.iushln(E)},c.prototype.invm=function(I){return this.egcd(I).a.umod(I)},c.prototype.isEven=function(){return(1&this.words[0])==0},c.prototype.isOdd=function(){return(1&this.words[0])==1},c.prototype.andln=function(I){return this.words[0]&I},c.prototype.bincn=function(I){l(typeof I=="number");var F=I%26,S=(I-F)/26,E=1<<F;if(this.length<=S)return this._expand(S+1),this.words[S]|=E,this;for(var N=E,C=S;N!==0&&C<this.length;C++){var k=0|this.words[C];N=(k+=N)>>>26,k&=67108863,this.words[C]=k}return N!==0&&(this.words[C]=N,this.length++),this},c.prototype.isZero=function(){return this.length===1&&this.words[0]===0},c.prototype.cmpn=function(I){var F,S=I<0;if(this.negative!==0&&!S)return-1;if(this.negative===0&&S)return 1;if(this.strip(),this.length>1)F=1;else{S&&(I=-I),l(I<=67108863,"Number is too big");var E=0|this.words[0];F=E===I?0:E<I?-1:1}return this.negative!==0?0|-F:F},c.prototype.cmp=function(I){if(this.negative!==0&&I.negative===0)return-1;if(this.negative===0&&I.negative!==0)return 1;var F=this.ucmp(I);return this.negative!==0?0|-F:F},c.prototype.ucmp=function(I){if(this.length>I.length)return 1;if(this.length<I.length)return-1;for(var F=0,S=this.length-1;S>=0;S--){var E=0|this.words[S],N=0|I.words[S];if(E!==N){E<N?F=-1:E>N&&(F=1);break}}return F},c.prototype.gtn=function(I){return this.cmpn(I)===1},c.prototype.gt=function(I){return this.cmp(I)===1},c.prototype.gten=function(I){return this.cmpn(I)>=0},c.prototype.gte=function(I){return this.cmp(I)>=0},c.prototype.ltn=function(I){return this.cmpn(I)===-1},c.prototype.lt=function(I){return this.cmp(I)===-1},c.prototype.lten=function(I){return this.cmpn(I)<=0},c.prototype.lte=function(I){return this.cmp(I)<=0},c.prototype.eqn=function(I){return this.cmpn(I)===0},c.prototype.eq=function(I){return this.cmp(I)===0},c.red=function(I){return new Y(I)},c.prototype.toRed=function(I){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),I.convertTo(this)._forceRed(I)},c.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},c.prototype._forceRed=function(I){return this.red=I,this},c.prototype.forceRed=function(I){return l(!this.red,"Already a number in reduction context"),this._forceRed(I)},c.prototype.redAdd=function(I){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,I)},c.prototype.redIAdd=function(I){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,I)},c.prototype.redSub=function(I){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,I)},c.prototype.redISub=function(I){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,I)},c.prototype.redShl=function(I){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,I)},c.prototype.redMul=function(I){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,I),this.red.mul(this,I)},c.prototype.redIMul=function(I){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,I),this.red.imul(this,I)},c.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},c.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},c.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},c.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},c.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},c.prototype.redPow=function(I){return l(this.red&&!I.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,I)};var T={k256:null,p224:null,p192:null,p25519:null};function O(I,F){this.name=I,this.p=new c(F,16),this.n=this.p.bitLength(),this.k=new c(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function R(){O.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function D(){O.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function B(){O.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function q(){O.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function Y(I){if(typeof I=="string"){var F=c._prime(I);this.m=F.p,this.prime=F}else l(I.gtn(1),"modulus must be greater than 1"),this.m=I,this.prime=null}function G(I){Y.call(this,I),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new c(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}O.prototype._tmp=function(){var I=new c(null);return I.words=new Array(Math.ceil(this.n/13)),I},O.prototype.ireduce=function(I){var F,S=I;do this.split(S,this.tmp),F=(S=(S=this.imulK(S)).iadd(this.tmp)).bitLength();while(F>this.n);var E=F<this.n?-1:S.ucmp(this.p);return E===0?(S.words[0]=0,S.length=1):E>0?S.isub(this.p):S.strip!==void 0?S.strip():S._strip(),S},O.prototype.split=function(I,F){I.iushrn(this.n,0,F)},O.prototype.imulK=function(I){return I.imul(this.k)},d(R,O),R.prototype.split=function(I,F){for(var S=Math.min(I.length,9),E=0;E<S;E++)F.words[E]=I.words[E];if(F.length=S,I.length<=9)return I.words[0]=0,void(I.length=1);var N=I.words[9];for(F.words[F.length++]=4194303&N,E=10;E<I.length;E++){var C=0|I.words[E];I.words[E-10]=(4194303&C)<<4|N>>>22,N=C}N>>>=22,I.words[E-10]=N,N===0&&I.length>10?I.length-=10:I.length-=9},R.prototype.imulK=function(I){I.words[I.length]=0,I.words[I.length+1]=0,I.length+=2;for(var F=0,S=0;S<I.length;S++){var E=0|I.words[S];F+=977*E,I.words[S]=67108863&F,F=64*E+(F/67108864|0)}return I.words[I.length-1]===0&&(I.length--,I.words[I.length-1]===0&&I.length--),I},d(D,O),d(B,O),d(q,O),q.prototype.imulK=function(I){for(var F=0,S=0;S<I.length;S++){var E=19*(0|I.words[S])+F,N=67108863&E;E>>>=26,I.words[S]=N,F=E}return F!==0&&(I.words[I.length++]=F),I},c._prime=function(I){if(T[I])return T[I];var F;if(I==="k256")F=new R;else if(I==="p224")F=new D;else if(I==="p192")F=new B;else{if(I!=="p25519")throw new Error("Unknown prime "+I);F=new q}return T[I]=F,F},Y.prototype._verify1=function(I){l(I.negative===0,"red works only with positives"),l(I.red,"red works only with red numbers")},Y.prototype._verify2=function(I,F){l((I.negative|F.negative)==0,"red works only with positives"),l(I.red&&I.red===F.red,"red works only with red numbers")},Y.prototype.imod=function(I){return this.prime?this.prime.ireduce(I)._forceRed(this):I.umod(this.m)._forceRed(this)},Y.prototype.neg=function(I){return I.isZero()?I.clone():this.m.sub(I)._forceRed(this)},Y.prototype.add=function(I,F){this._verify2(I,F);var S=I.add(F);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},Y.prototype.iadd=function(I,F){this._verify2(I,F);var S=I.iadd(F);return S.cmp(this.m)>=0&&S.isub(this.m),S},Y.prototype.sub=function(I,F){this._verify2(I,F);var S=I.sub(F);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},Y.prototype.isub=function(I,F){this._verify2(I,F);var S=I.isub(F);return S.cmpn(0)<0&&S.iadd(this.m),S},Y.prototype.shl=function(I,F){return this._verify1(I),this.imod(I.ushln(F))},Y.prototype.imul=function(I,F){return this._verify2(I,F),this.imod(I.imul(F))},Y.prototype.mul=function(I,F){return this._verify2(I,F),this.imod(I.mul(F))},Y.prototype.isqr=function(I){return this.imul(I,I.clone())},Y.prototype.sqr=function(I){return this.mul(I,I)},Y.prototype.sqrt=function(I){if(I.isZero())return I.clone();var F=this.m.andln(3);if(l(F%2==1),F===3){var S=this.m.add(new c(1)).iushrn(2);return this.pow(I,S)}for(var E=this.m.subn(1),N=0;!E.isZero()&&E.andln(1)===0;)N++,E.iushrn(1);l(!E.isZero());var C=new c(1).toRed(this),k=C.redNeg(),M=this.m.subn(1).iushrn(1),U=this.m.bitLength();for(U=new c(2*U*U).toRed(this);this.pow(U,M).cmp(k)!==0;)U.redIAdd(k);for(var $=this.pow(U,E),X=this.pow(I,E.addn(1).iushrn(1)),Z=this.pow(I,E),re=N;Z.cmp(C)!==0;){for(var W=Z,J=0;W.cmp(C)!==0;J++)W=W.redSqr();l(J<re);var V=this.pow($,new c(1).iushln(re-J-1));X=X.redMul(V),$=V.redSqr(),Z=Z.redMul($),re=J}return X},Y.prototype.invm=function(I){var F=I._invmp(this.m);return F.negative!==0?(F.negative=0,this.imod(F).redNeg()):this.imod(F)},Y.prototype.pow=function(I,F){if(F.isZero())return new c(1).toRed(this);if(F.cmpn(1)===0)return I.clone();var S=new Array(16);S[0]=new c(1).toRed(this),S[1]=I;for(var E=2;E<S.length;E++)S[E]=this.mul(S[E-1],I);var N=S[0],C=0,k=0,M=F.bitLength()%26;for(M===0&&(M=26),E=F.length-1;E>=0;E--){for(var U=F.words[E],$=M-1;$>=0;$--){var X=U>>$&1;N!==S[0]&&(N=this.sqr(N)),X!==0||C!==0?(C<<=1,C|=X,(++k===4||E===0&&$===0)&&(N=this.mul(N,S[C]),k=0,C=0)):k=0}M=26}return N},Y.prototype.convertTo=function(I){var F=I.umod(this.m);return F===I?F.clone():F},Y.prototype.convertFrom=function(I){var F=I.clone();return F.red=null,F},c.mont=function(I){return new G(I)},d(G,Y),G.prototype.convertTo=function(I){return this.imod(I.ushln(this.shift))},G.prototype.convertFrom=function(I){var F=this.imod(I.mul(this.rinv));return F.red=null,F},G.prototype.imul=function(I,F){if(I.isZero()||F.isZero())return I.words[0]=0,I.length=1,I;var S=I.imul(F),E=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=S.isub(E).iushrn(this.shift),C=N;return N.cmp(this.m)>=0?C=N.isub(this.m):N.cmpn(0)<0&&(C=N.iadd(this.m)),C._forceRed(this)},G.prototype.mul=function(I,F){if(I.isZero()||F.isZero())return new c(0)._forceRed(this);var S=I.mul(F),E=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=S.isub(E).iushrn(this.shift),C=N;return N.cmp(this.m)>=0?C=N.isub(this.m):N.cmpn(0)<0&&(C=N.iadd(this.m)),C._forceRed(this)},G.prototype.invm=function(I){return this.imod(I._invmp(this.m).mul(this.r2))._forceRed(this)}})(s===void 0||s)},{buffer:188}],185:[function(r,s,a){a.byteLength=function(m){var p=h(m),g=p[0],x=p[1];return 3*(g+x)/4-x},a.toByteArray=function(m){var p,g,x=h(m),v=x[0],y=x[1],b=new l(function(O,R,D){return 3*(R+D)/4-D}(0,v,y)),j=0,T=y>0?v-4:v;for(g=0;g<T;g+=4)p=o[m.charCodeAt(g)]<<18|o[m.charCodeAt(g+1)]<<12|o[m.charCodeAt(g+2)]<<6|o[m.charCodeAt(g+3)],b[j++]=p>>16&255,b[j++]=p>>8&255,b[j++]=255&p;return y===2&&(p=o[m.charCodeAt(g)]<<2|o[m.charCodeAt(g+1)]>>4,b[j++]=255&p),y===1&&(p=o[m.charCodeAt(g)]<<10|o[m.charCodeAt(g+1)]<<4|o[m.charCodeAt(g+2)]>>2,b[j++]=p>>8&255,b[j++]=255&p),b},a.fromByteArray=function(m){for(var p,g=m.length,x=g%3,v=[],y=0,b=g-x;y<b;y+=16383)v.push(f(m,y,y+16383>b?b:y+16383));return x===1?(p=m[g-1],v.push(i[p>>2]+i[p<<4&63]+"==")):x===2&&(p=(m[g-2]<<8)+m[g-1],v.push(i[p>>10]+i[p>>4&63]+i[p<<2&63]+"=")),v.join("")};for(var i=[],o=[],l=typeof Uint8Array<"u"?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,u=d.length;c<u;++c)i[c]=d[c],o[d.charCodeAt(c)]=c;function h(m){var p=m.length;if(p%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=m.indexOf("=");return g===-1&&(g=p),[g,g===p?0:4-g%4]}function f(m,p,g){for(var x,v,y=[],b=p;b<g;b+=3)x=(m[b]<<16&16711680)+(m[b+1]<<8&65280)+(255&m[b+2]),y.push(i[(v=x)>>18&63]+i[v>>12&63]+i[v>>6&63]+i[63&v]);return y.join("")}o[45]=62,o[95]=63},{}],186:[function(r,s,a){(function(i,o){function l(S,E){if(!S)throw new Error(E||"Assertion failed")}function d(S,E){S.super_=E;var N=function(){};N.prototype=E.prototype,S.prototype=new N,S.prototype.constructor=S}function c(S,E,N){if(c.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,S!==null&&(E!=="le"&&E!=="be"||(N=E,E=10),this._init(S||0,E||10,N||"be"))}var u;typeof i=="object"?i.exports=c:(void 0).BN=c,c.BN=c,c.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:r("buffer").Buffer}catch{}function h(S,E){var N=S.charCodeAt(E);return N>=48&&N<=57?N-48:N>=65&&N<=70?N-55:N>=97&&N<=102?N-87:void l(!1,"Invalid character in "+S)}function f(S,E,N){var C=h(S,N);return N-1>=E&&(C|=h(S,N-1)<<4),C}function m(S,E,N,C){for(var k=0,M=0,U=Math.min(S.length,N),$=E;$<U;$++){var X=S.charCodeAt($)-48;k*=C,M=X>=49?X-49+10:X>=17?X-17+10:X,l(X>=0&&M<C,"Invalid character"),k+=M}return k}function p(S,E){S.words=E.words,S.length=E.length,S.negative=E.negative,S.red=E.red}if(c.isBN=function(S){return S instanceof c||S!==null&&typeof S=="object"&&S.constructor.wordSize===c.wordSize&&Array.isArray(S.words)},c.max=function(S,E){return S.cmp(E)>0?S:E},c.min=function(S,E){return S.cmp(E)<0?S:E},c.prototype._init=function(S,E,N){if(typeof S=="number")return this._initNumber(S,E,N);if(typeof S=="object")return this._initArray(S,E,N);E==="hex"&&(E=16),l(E===(0|E)&&E>=2&&E<=36);var C=0;(S=S.toString().replace(/\s+/g,""))[0]==="-"&&(C++,this.negative=1),C<S.length&&(E===16?this._parseHex(S,C,N):(this._parseBase(S,E,C),N==="le"&&this._initArray(this.toArray(),E,N)))},c.prototype._initNumber=function(S,E,N){S<0&&(this.negative=1,S=-S),S<67108864?(this.words=[67108863&S],this.length=1):S<4503599627370496?(this.words=[67108863&S,S/67108864&67108863],this.length=2):(l(S<9007199254740992),this.words=[67108863&S,S/67108864&67108863,1],this.length=3),N==="le"&&this._initArray(this.toArray(),E,N)},c.prototype._initArray=function(S,E,N){if(l(typeof S.length=="number"),S.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(S.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var k,M,U=0;if(N==="be")for(C=S.length-1,k=0;C>=0;C-=3)M=S[C]|S[C-1]<<8|S[C-2]<<16,this.words[k]|=M<<U&67108863,this.words[k+1]=M>>>26-U&67108863,(U+=24)>=26&&(U-=26,k++);else if(N==="le")for(C=0,k=0;C<S.length;C+=3)M=S[C]|S[C+1]<<8|S[C+2]<<16,this.words[k]|=M<<U&67108863,this.words[k+1]=M>>>26-U&67108863,(U+=24)>=26&&(U-=26,k++);return this._strip()},c.prototype._parseHex=function(S,E,N){this.length=Math.ceil((S.length-E)/6),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var k,M=0,U=0;if(N==="be")for(C=S.length-1;C>=E;C-=2)k=f(S,E,C)<<M,this.words[U]|=67108863&k,M>=18?(M-=18,U+=1,this.words[U]|=k>>>26):M+=8;else for(C=(S.length-E)%2==0?E+1:E;C<S.length;C+=2)k=f(S,E,C)<<M,this.words[U]|=67108863&k,M>=18?(M-=18,U+=1,this.words[U]|=k>>>26):M+=8;this._strip()},c.prototype._parseBase=function(S,E,N){this.words=[0],this.length=1;for(var C=0,k=1;k<=67108863;k*=E)C++;C--,k=k/E|0;for(var M=S.length-N,U=M%C,$=Math.min(M,M-U)+N,X=0,Z=N;Z<$;Z+=C)X=m(S,Z,Z+C,E),this.imuln(k),this.words[0]+X<67108864?this.words[0]+=X:this._iaddn(X);if(U!==0){var re=1;for(X=m(S,Z,S.length,E),Z=0;Z<U;Z++)re*=E;this.imuln(re),this.words[0]+X<67108864?this.words[0]+=X:this._iaddn(X)}this._strip()},c.prototype.copy=function(S){S.words=new Array(this.length);for(var E=0;E<this.length;E++)S.words[E]=this.words[E];S.length=this.length,S.negative=this.negative,S.red=this.red},c.prototype._move=function(S){p(S,this)},c.prototype.clone=function(){var S=new c(null);return this.copy(S),S},c.prototype._expand=function(S){for(;this.length<S;)this.words[this.length++]=0;return this},c.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},c.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{c.prototype[Symbol.for("nodejs.util.inspect.custom")]=g}catch{c.prototype.inspect=g}else c.prototype.inspect=g;function g(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var x=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];c.prototype.toString=function(S,E){var N;if(E=0|E||1,(S=S||10)===16||S==="hex"){N="";for(var C=0,k=0,M=0;M<this.length;M++){var U=this.words[M],$=(16777215&(U<<C|k)).toString(16);k=U>>>24-C&16777215,(C+=2)>=26&&(C-=26,M--),N=k!==0||M!==this.length-1?x[6-$.length]+$+N:$+N}for(k!==0&&(N=k.toString(16)+N);N.length%E!=0;)N="0"+N;return this.negative!==0&&(N="-"+N),N}if(S===(0|S)&&S>=2&&S<=36){var X=v[S],Z=y[S];N="";var re=this.clone();for(re.negative=0;!re.isZero();){var W=re.modrn(Z).toString(S);N=(re=re.idivn(Z)).isZero()?W+N:x[X-W.length]+W+N}for(this.isZero()&&(N="0"+N);N.length%E!=0;)N="0"+N;return this.negative!==0&&(N="-"+N),N}l(!1,"Base should be between 2 and 36")},c.prototype.toNumber=function(){var S=this.words[0];return this.length===2?S+=67108864*this.words[1]:this.length===3&&this.words[2]===1?S+=4503599627370496+67108864*this.words[1]:this.length>2&&l(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-S:S},c.prototype.toJSON=function(){return this.toString(16,2)},u&&(c.prototype.toBuffer=function(S,E){return this.toArrayLike(u,S,E)}),c.prototype.toArray=function(S,E){return this.toArrayLike(Array,S,E)};function b(S,E,N){N.negative=E.negative^S.negative;var C=S.length+E.length|0;N.length=C,C=C-1|0;var k=0|S.words[0],M=0|E.words[0],U=k*M,$=67108863&U,X=U/67108864|0;N.words[0]=$;for(var Z=1;Z<C;Z++){for(var re=X>>>26,W=67108863&X,J=Math.min(Z,E.length-1),V=Math.max(0,Z-S.length+1);V<=J;V++){var H=Z-V|0;re+=(U=(k=0|S.words[H])*(M=0|E.words[V])+W)/67108864|0,W=67108863&U}N.words[Z]=0|W,X=0|re}return X!==0?N.words[Z]=0|X:N.length--,N._strip()}c.prototype.toArrayLike=function(S,E,N){this._strip();var C=this.byteLength(),k=N||Math.max(1,C);l(C<=k,"byte array longer than desired length"),l(k>0,"Requested array length <= 0");var M=function(U,$){return U.allocUnsafe?U.allocUnsafe($):new U($)}(S,k);return this["_toArrayLike"+(E==="le"?"LE":"BE")](M,C),M},c.prototype._toArrayLikeLE=function(S,E){for(var N=0,C=0,k=0,M=0;k<this.length;k++){var U=this.words[k]<<M|C;S[N++]=255&U,N<S.length&&(S[N++]=U>>8&255),N<S.length&&(S[N++]=U>>16&255),M===6?(N<S.length&&(S[N++]=U>>24&255),C=0,M=0):(C=U>>>24,M+=2)}if(N<S.length)for(S[N++]=C;N<S.length;)S[N++]=0},c.prototype._toArrayLikeBE=function(S,E){for(var N=S.length-1,C=0,k=0,M=0;k<this.length;k++){var U=this.words[k]<<M|C;S[N--]=255&U,N>=0&&(S[N--]=U>>8&255),N>=0&&(S[N--]=U>>16&255),M===6?(N>=0&&(S[N--]=U>>24&255),C=0,M=0):(C=U>>>24,M+=2)}if(N>=0)for(S[N--]=C;N>=0;)S[N--]=0},Math.clz32?c.prototype._countBits=function(S){return 32-Math.clz32(S)}:c.prototype._countBits=function(S){var E=S,N=0;return E>=4096&&(N+=13,E>>>=13),E>=64&&(N+=7,E>>>=7),E>=8&&(N+=4,E>>>=4),E>=2&&(N+=2,E>>>=2),N+E},c.prototype._zeroBits=function(S){if(S===0)return 26;var E=S,N=0;return!(8191&E)&&(N+=13,E>>>=13),!(127&E)&&(N+=7,E>>>=7),!(15&E)&&(N+=4,E>>>=4),!(3&E)&&(N+=2,E>>>=2),!(1&E)&&N++,N},c.prototype.bitLength=function(){var S=this.words[this.length-1],E=this._countBits(S);return 26*(this.length-1)+E},c.prototype.zeroBits=function(){if(this.isZero())return 0;for(var S=0,E=0;E<this.length;E++){var N=this._zeroBits(this.words[E]);if(S+=N,N!==26)break}return S},c.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},c.prototype.toTwos=function(S){return this.negative!==0?this.abs().inotn(S).iaddn(1):this.clone()},c.prototype.fromTwos=function(S){return this.testn(S-1)?this.notn(S).iaddn(1).ineg():this.clone()},c.prototype.isNeg=function(){return this.negative!==0},c.prototype.neg=function(){return this.clone().ineg()},c.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},c.prototype.iuor=function(S){for(;this.length<S.length;)this.words[this.length++]=0;for(var E=0;E<S.length;E++)this.words[E]=this.words[E]|S.words[E];return this._strip()},c.prototype.ior=function(S){return l((this.negative|S.negative)==0),this.iuor(S)},c.prototype.or=function(S){return this.length>S.length?this.clone().ior(S):S.clone().ior(this)},c.prototype.uor=function(S){return this.length>S.length?this.clone().iuor(S):S.clone().iuor(this)},c.prototype.iuand=function(S){var E;E=this.length>S.length?S:this;for(var N=0;N<E.length;N++)this.words[N]=this.words[N]&S.words[N];return this.length=E.length,this._strip()},c.prototype.iand=function(S){return l((this.negative|S.negative)==0),this.iuand(S)},c.prototype.and=function(S){return this.length>S.length?this.clone().iand(S):S.clone().iand(this)},c.prototype.uand=function(S){return this.length>S.length?this.clone().iuand(S):S.clone().iuand(this)},c.prototype.iuxor=function(S){var E,N;this.length>S.length?(E=this,N=S):(E=S,N=this);for(var C=0;C<N.length;C++)this.words[C]=E.words[C]^N.words[C];if(this!==E)for(;C<E.length;C++)this.words[C]=E.words[C];return this.length=E.length,this._strip()},c.prototype.ixor=function(S){return l((this.negative|S.negative)==0),this.iuxor(S)},c.prototype.xor=function(S){return this.length>S.length?this.clone().ixor(S):S.clone().ixor(this)},c.prototype.uxor=function(S){return this.length>S.length?this.clone().iuxor(S):S.clone().iuxor(this)},c.prototype.inotn=function(S){l(typeof S=="number"&&S>=0);var E=0|Math.ceil(S/26),N=S%26;this._expand(E),N>0&&E--;for(var C=0;C<E;C++)this.words[C]=67108863&~this.words[C];return N>0&&(this.words[C]=~this.words[C]&67108863>>26-N),this._strip()},c.prototype.notn=function(S){return this.clone().inotn(S)},c.prototype.setn=function(S,E){l(typeof S=="number"&&S>=0);var N=S/26|0,C=S%26;return this._expand(N+1),this.words[N]=E?this.words[N]|1<<C:this.words[N]&~(1<<C),this._strip()},c.prototype.iadd=function(S){var E,N,C;if(this.negative!==0&&S.negative===0)return this.negative=0,E=this.isub(S),this.negative^=1,this._normSign();if(this.negative===0&&S.negative!==0)return S.negative=0,E=this.isub(S),S.negative=1,E._normSign();this.length>S.length?(N=this,C=S):(N=S,C=this);for(var k=0,M=0;M<C.length;M++)E=(0|N.words[M])+(0|C.words[M])+k,this.words[M]=67108863&E,k=E>>>26;for(;k!==0&&M<N.length;M++)E=(0|N.words[M])+k,this.words[M]=67108863&E,k=E>>>26;if(this.length=N.length,k!==0)this.words[this.length]=k,this.length++;else if(N!==this)for(;M<N.length;M++)this.words[M]=N.words[M];return this},c.prototype.add=function(S){var E;return S.negative!==0&&this.negative===0?(S.negative=0,E=this.sub(S),S.negative^=1,E):S.negative===0&&this.negative!==0?(this.negative=0,E=S.sub(this),this.negative=1,E):this.length>S.length?this.clone().iadd(S):S.clone().iadd(this)},c.prototype.isub=function(S){if(S.negative!==0){S.negative=0;var E=this.iadd(S);return S.negative=1,E._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(S),this.negative=1,this._normSign();var N,C,k=this.cmp(S);if(k===0)return this.negative=0,this.length=1,this.words[0]=0,this;k>0?(N=this,C=S):(N=S,C=this);for(var M=0,U=0;U<C.length;U++)M=(E=(0|N.words[U])-(0|C.words[U])+M)>>26,this.words[U]=67108863&E;for(;M!==0&&U<N.length;U++)M=(E=(0|N.words[U])+M)>>26,this.words[U]=67108863&E;if(M===0&&U<N.length&&N!==this)for(;U<N.length;U++)this.words[U]=N.words[U];return this.length=Math.max(this.length,U),N!==this&&(this.negative=1),this._strip()},c.prototype.sub=function(S){return this.clone().isub(S)};var j=function(S,E,N){var C,k,M,U=S.words,$=E.words,X=N.words,Z=0,re=0|U[0],W=8191&re,J=re>>>13,V=0|U[1],H=8191&V,ee=V>>>13,ie=0|U[2],oe=8191&ie,se=ie>>>13,ue=0|U[3],pe=8191&ue,ce=ue>>>13,ne=0|U[4],me=8191&ne,ge=ne>>>13,_e=0|U[5],be=8191&_e,ye=_e>>>13,Oe=0|U[6],Ne=8191&Oe,De=Oe>>>13,Ge=0|U[7],Qe=8191&Ge,Ie=Ge>>>13,Ae=0|U[8],st=8191&Ae,nt=Ae>>>13,vt=0|U[9],Je=8191&vt,Ue=vt>>>13,Le=0|$[0],Ze=8191&Le,ct=Le>>>13,ht=0|$[1],yt=8191&ht,Re=ht>>>13,Ke=0|$[2],_t=8191&Ke,Rt=Ke>>>13,Se=0|$[3],tt=8191&Se,ot=Se>>>13,lt=0|$[4],At=8191&lt,Nt=lt>>>13,ut=0|$[5],lr=8191&ut,Pt=ut>>>13,Pe=0|$[6],Me=8191&Pe,it=Pe>>>13,gt=0|$[7],dt=8191&gt,It=gt>>>13,xr=0|$[8],sr=8191&xr,ir=xr>>>13,_r=0|$[9],wr=8191&_r,jr=_r>>>13;N.negative=S.negative^E.negative,N.length=19;var rt=(Z+(C=Math.imul(W,Ze))|0)+((8191&(k=(k=Math.imul(W,ct))+Math.imul(J,Ze)|0))<<13)|0;Z=((M=Math.imul(J,ct))+(k>>>13)|0)+(rt>>>26)|0,rt&=67108863,C=Math.imul(H,Ze),k=(k=Math.imul(H,ct))+Math.imul(ee,Ze)|0,M=Math.imul(ee,ct);var Ot=(Z+(C=C+Math.imul(W,yt)|0)|0)+((8191&(k=(k=k+Math.imul(W,Re)|0)+Math.imul(J,yt)|0))<<13)|0;Z=((M=M+Math.imul(J,Re)|0)+(k>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,C=Math.imul(oe,Ze),k=(k=Math.imul(oe,ct))+Math.imul(se,Ze)|0,M=Math.imul(se,ct),C=C+Math.imul(H,yt)|0,k=(k=k+Math.imul(H,Re)|0)+Math.imul(ee,yt)|0,M=M+Math.imul(ee,Re)|0;var rr=(Z+(C=C+Math.imul(W,_t)|0)|0)+((8191&(k=(k=k+Math.imul(W,Rt)|0)+Math.imul(J,_t)|0))<<13)|0;Z=((M=M+Math.imul(J,Rt)|0)+(k>>>13)|0)+(rr>>>26)|0,rr&=67108863,C=Math.imul(pe,Ze),k=(k=Math.imul(pe,ct))+Math.imul(ce,Ze)|0,M=Math.imul(ce,ct),C=C+Math.imul(oe,yt)|0,k=(k=k+Math.imul(oe,Re)|0)+Math.imul(se,yt)|0,M=M+Math.imul(se,Re)|0,C=C+Math.imul(H,_t)|0,k=(k=k+Math.imul(H,Rt)|0)+Math.imul(ee,_t)|0,M=M+Math.imul(ee,Rt)|0;var nr=(Z+(C=C+Math.imul(W,tt)|0)|0)+((8191&(k=(k=k+Math.imul(W,ot)|0)+Math.imul(J,tt)|0))<<13)|0;Z=((M=M+Math.imul(J,ot)|0)+(k>>>13)|0)+(nr>>>26)|0,nr&=67108863,C=Math.imul(me,Ze),k=(k=Math.imul(me,ct))+Math.imul(ge,Ze)|0,M=Math.imul(ge,ct),C=C+Math.imul(pe,yt)|0,k=(k=k+Math.imul(pe,Re)|0)+Math.imul(ce,yt)|0,M=M+Math.imul(ce,Re)|0,C=C+Math.imul(oe,_t)|0,k=(k=k+Math.imul(oe,Rt)|0)+Math.imul(se,_t)|0,M=M+Math.imul(se,Rt)|0,C=C+Math.imul(H,tt)|0,k=(k=k+Math.imul(H,ot)|0)+Math.imul(ee,tt)|0,M=M+Math.imul(ee,ot)|0;var Qt=(Z+(C=C+Math.imul(W,At)|0)|0)+((8191&(k=(k=k+Math.imul(W,Nt)|0)+Math.imul(J,At)|0))<<13)|0;Z=((M=M+Math.imul(J,Nt)|0)+(k>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,C=Math.imul(be,Ze),k=(k=Math.imul(be,ct))+Math.imul(ye,Ze)|0,M=Math.imul(ye,ct),C=C+Math.imul(me,yt)|0,k=(k=k+Math.imul(me,Re)|0)+Math.imul(ge,yt)|0,M=M+Math.imul(ge,Re)|0,C=C+Math.imul(pe,_t)|0,k=(k=k+Math.imul(pe,Rt)|0)+Math.imul(ce,_t)|0,M=M+Math.imul(ce,Rt)|0,C=C+Math.imul(oe,tt)|0,k=(k=k+Math.imul(oe,ot)|0)+Math.imul(se,tt)|0,M=M+Math.imul(se,ot)|0,C=C+Math.imul(H,At)|0,k=(k=k+Math.imul(H,Nt)|0)+Math.imul(ee,At)|0,M=M+Math.imul(ee,Nt)|0;var Ce=(Z+(C=C+Math.imul(W,lr)|0)|0)+((8191&(k=(k=k+Math.imul(W,Pt)|0)+Math.imul(J,lr)|0))<<13)|0;Z=((M=M+Math.imul(J,Pt)|0)+(k>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,C=Math.imul(Ne,Ze),k=(k=Math.imul(Ne,ct))+Math.imul(De,Ze)|0,M=Math.imul(De,ct),C=C+Math.imul(be,yt)|0,k=(k=k+Math.imul(be,Re)|0)+Math.imul(ye,yt)|0,M=M+Math.imul(ye,Re)|0,C=C+Math.imul(me,_t)|0,k=(k=k+Math.imul(me,Rt)|0)+Math.imul(ge,_t)|0,M=M+Math.imul(ge,Rt)|0,C=C+Math.imul(pe,tt)|0,k=(k=k+Math.imul(pe,ot)|0)+Math.imul(ce,tt)|0,M=M+Math.imul(ce,ot)|0,C=C+Math.imul(oe,At)|0,k=(k=k+Math.imul(oe,Nt)|0)+Math.imul(se,At)|0,M=M+Math.imul(se,Nt)|0,C=C+Math.imul(H,lr)|0,k=(k=k+Math.imul(H,Pt)|0)+Math.imul(ee,lr)|0,M=M+Math.imul(ee,Pt)|0;var Xe=(Z+(C=C+Math.imul(W,Me)|0)|0)+((8191&(k=(k=k+Math.imul(W,it)|0)+Math.imul(J,Me)|0))<<13)|0;Z=((M=M+Math.imul(J,it)|0)+(k>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,C=Math.imul(Qe,Ze),k=(k=Math.imul(Qe,ct))+Math.imul(Ie,Ze)|0,M=Math.imul(Ie,ct),C=C+Math.imul(Ne,yt)|0,k=(k=k+Math.imul(Ne,Re)|0)+Math.imul(De,yt)|0,M=M+Math.imul(De,Re)|0,C=C+Math.imul(be,_t)|0,k=(k=k+Math.imul(be,Rt)|0)+Math.imul(ye,_t)|0,M=M+Math.imul(ye,Rt)|0,C=C+Math.imul(me,tt)|0,k=(k=k+Math.imul(me,ot)|0)+Math.imul(ge,tt)|0,M=M+Math.imul(ge,ot)|0,C=C+Math.imul(pe,At)|0,k=(k=k+Math.imul(pe,Nt)|0)+Math.imul(ce,At)|0,M=M+Math.imul(ce,Nt)|0,C=C+Math.imul(oe,lr)|0,k=(k=k+Math.imul(oe,Pt)|0)+Math.imul(se,lr)|0,M=M+Math.imul(se,Pt)|0,C=C+Math.imul(H,Me)|0,k=(k=k+Math.imul(H,it)|0)+Math.imul(ee,Me)|0,M=M+Math.imul(ee,it)|0;var ft=(Z+(C=C+Math.imul(W,dt)|0)|0)+((8191&(k=(k=k+Math.imul(W,It)|0)+Math.imul(J,dt)|0))<<13)|0;Z=((M=M+Math.imul(J,It)|0)+(k>>>13)|0)+(ft>>>26)|0,ft&=67108863,C=Math.imul(st,Ze),k=(k=Math.imul(st,ct))+Math.imul(nt,Ze)|0,M=Math.imul(nt,ct),C=C+Math.imul(Qe,yt)|0,k=(k=k+Math.imul(Qe,Re)|0)+Math.imul(Ie,yt)|0,M=M+Math.imul(Ie,Re)|0,C=C+Math.imul(Ne,_t)|0,k=(k=k+Math.imul(Ne,Rt)|0)+Math.imul(De,_t)|0,M=M+Math.imul(De,Rt)|0,C=C+Math.imul(be,tt)|0,k=(k=k+Math.imul(be,ot)|0)+Math.imul(ye,tt)|0,M=M+Math.imul(ye,ot)|0,C=C+Math.imul(me,At)|0,k=(k=k+Math.imul(me,Nt)|0)+Math.imul(ge,At)|0,M=M+Math.imul(ge,Nt)|0,C=C+Math.imul(pe,lr)|0,k=(k=k+Math.imul(pe,Pt)|0)+Math.imul(ce,lr)|0,M=M+Math.imul(ce,Pt)|0,C=C+Math.imul(oe,Me)|0,k=(k=k+Math.imul(oe,it)|0)+Math.imul(se,Me)|0,M=M+Math.imul(se,it)|0,C=C+Math.imul(H,dt)|0,k=(k=k+Math.imul(H,It)|0)+Math.imul(ee,dt)|0,M=M+Math.imul(ee,It)|0;var ze=(Z+(C=C+Math.imul(W,sr)|0)|0)+((8191&(k=(k=k+Math.imul(W,ir)|0)+Math.imul(J,sr)|0))<<13)|0;Z=((M=M+Math.imul(J,ir)|0)+(k>>>13)|0)+(ze>>>26)|0,ze&=67108863,C=Math.imul(Je,Ze),k=(k=Math.imul(Je,ct))+Math.imul(Ue,Ze)|0,M=Math.imul(Ue,ct),C=C+Math.imul(st,yt)|0,k=(k=k+Math.imul(st,Re)|0)+Math.imul(nt,yt)|0,M=M+Math.imul(nt,Re)|0,C=C+Math.imul(Qe,_t)|0,k=(k=k+Math.imul(Qe,Rt)|0)+Math.imul(Ie,_t)|0,M=M+Math.imul(Ie,Rt)|0,C=C+Math.imul(Ne,tt)|0,k=(k=k+Math.imul(Ne,ot)|0)+Math.imul(De,tt)|0,M=M+Math.imul(De,ot)|0,C=C+Math.imul(be,At)|0,k=(k=k+Math.imul(be,Nt)|0)+Math.imul(ye,At)|0,M=M+Math.imul(ye,Nt)|0,C=C+Math.imul(me,lr)|0,k=(k=k+Math.imul(me,Pt)|0)+Math.imul(ge,lr)|0,M=M+Math.imul(ge,Pt)|0,C=C+Math.imul(pe,Me)|0,k=(k=k+Math.imul(pe,it)|0)+Math.imul(ce,Me)|0,M=M+Math.imul(ce,it)|0,C=C+Math.imul(oe,dt)|0,k=(k=k+Math.imul(oe,It)|0)+Math.imul(se,dt)|0,M=M+Math.imul(se,It)|0,C=C+Math.imul(H,sr)|0,k=(k=k+Math.imul(H,ir)|0)+Math.imul(ee,sr)|0,M=M+Math.imul(ee,ir)|0;var Zt=(Z+(C=C+Math.imul(W,wr)|0)|0)+((8191&(k=(k=k+Math.imul(W,jr)|0)+Math.imul(J,wr)|0))<<13)|0;Z=((M=M+Math.imul(J,jr)|0)+(k>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,C=Math.imul(Je,yt),k=(k=Math.imul(Je,Re))+Math.imul(Ue,yt)|0,M=Math.imul(Ue,Re),C=C+Math.imul(st,_t)|0,k=(k=k+Math.imul(st,Rt)|0)+Math.imul(nt,_t)|0,M=M+Math.imul(nt,Rt)|0,C=C+Math.imul(Qe,tt)|0,k=(k=k+Math.imul(Qe,ot)|0)+Math.imul(Ie,tt)|0,M=M+Math.imul(Ie,ot)|0,C=C+Math.imul(Ne,At)|0,k=(k=k+Math.imul(Ne,Nt)|0)+Math.imul(De,At)|0,M=M+Math.imul(De,Nt)|0,C=C+Math.imul(be,lr)|0,k=(k=k+Math.imul(be,Pt)|0)+Math.imul(ye,lr)|0,M=M+Math.imul(ye,Pt)|0,C=C+Math.imul(me,Me)|0,k=(k=k+Math.imul(me,it)|0)+Math.imul(ge,Me)|0,M=M+Math.imul(ge,it)|0,C=C+Math.imul(pe,dt)|0,k=(k=k+Math.imul(pe,It)|0)+Math.imul(ce,dt)|0,M=M+Math.imul(ce,It)|0,C=C+Math.imul(oe,sr)|0,k=(k=k+Math.imul(oe,ir)|0)+Math.imul(se,sr)|0,M=M+Math.imul(se,ir)|0;var wt=(Z+(C=C+Math.imul(H,wr)|0)|0)+((8191&(k=(k=k+Math.imul(H,jr)|0)+Math.imul(ee,wr)|0))<<13)|0;Z=((M=M+Math.imul(ee,jr)|0)+(k>>>13)|0)+(wt>>>26)|0,wt&=67108863,C=Math.imul(Je,_t),k=(k=Math.imul(Je,Rt))+Math.imul(Ue,_t)|0,M=Math.imul(Ue,Rt),C=C+Math.imul(st,tt)|0,k=(k=k+Math.imul(st,ot)|0)+Math.imul(nt,tt)|0,M=M+Math.imul(nt,ot)|0,C=C+Math.imul(Qe,At)|0,k=(k=k+Math.imul(Qe,Nt)|0)+Math.imul(Ie,At)|0,M=M+Math.imul(Ie,Nt)|0,C=C+Math.imul(Ne,lr)|0,k=(k=k+Math.imul(Ne,Pt)|0)+Math.imul(De,lr)|0,M=M+Math.imul(De,Pt)|0,C=C+Math.imul(be,Me)|0,k=(k=k+Math.imul(be,it)|0)+Math.imul(ye,Me)|0,M=M+Math.imul(ye,it)|0,C=C+Math.imul(me,dt)|0,k=(k=k+Math.imul(me,It)|0)+Math.imul(ge,dt)|0,M=M+Math.imul(ge,It)|0,C=C+Math.imul(pe,sr)|0,k=(k=k+Math.imul(pe,ir)|0)+Math.imul(ce,sr)|0,M=M+Math.imul(ce,ir)|0;var kt=(Z+(C=C+Math.imul(oe,wr)|0)|0)+((8191&(k=(k=k+Math.imul(oe,jr)|0)+Math.imul(se,wr)|0))<<13)|0;Z=((M=M+Math.imul(se,jr)|0)+(k>>>13)|0)+(kt>>>26)|0,kt&=67108863,C=Math.imul(Je,tt),k=(k=Math.imul(Je,ot))+Math.imul(Ue,tt)|0,M=Math.imul(Ue,ot),C=C+Math.imul(st,At)|0,k=(k=k+Math.imul(st,Nt)|0)+Math.imul(nt,At)|0,M=M+Math.imul(nt,Nt)|0,C=C+Math.imul(Qe,lr)|0,k=(k=k+Math.imul(Qe,Pt)|0)+Math.imul(Ie,lr)|0,M=M+Math.imul(Ie,Pt)|0,C=C+Math.imul(Ne,Me)|0,k=(k=k+Math.imul(Ne,it)|0)+Math.imul(De,Me)|0,M=M+Math.imul(De,it)|0,C=C+Math.imul(be,dt)|0,k=(k=k+Math.imul(be,It)|0)+Math.imul(ye,dt)|0,M=M+Math.imul(ye,It)|0,C=C+Math.imul(me,sr)|0,k=(k=k+Math.imul(me,ir)|0)+Math.imul(ge,sr)|0,M=M+Math.imul(ge,ir)|0;var Cr=(Z+(C=C+Math.imul(pe,wr)|0)|0)+((8191&(k=(k=k+Math.imul(pe,jr)|0)+Math.imul(ce,wr)|0))<<13)|0;Z=((M=M+Math.imul(ce,jr)|0)+(k>>>13)|0)+(Cr>>>26)|0,Cr&=67108863,C=Math.imul(Je,At),k=(k=Math.imul(Je,Nt))+Math.imul(Ue,At)|0,M=Math.imul(Ue,Nt),C=C+Math.imul(st,lr)|0,k=(k=k+Math.imul(st,Pt)|0)+Math.imul(nt,lr)|0,M=M+Math.imul(nt,Pt)|0,C=C+Math.imul(Qe,Me)|0,k=(k=k+Math.imul(Qe,it)|0)+Math.imul(Ie,Me)|0,M=M+Math.imul(Ie,it)|0,C=C+Math.imul(Ne,dt)|0,k=(k=k+Math.imul(Ne,It)|0)+Math.imul(De,dt)|0,M=M+Math.imul(De,It)|0,C=C+Math.imul(be,sr)|0,k=(k=k+Math.imul(be,ir)|0)+Math.imul(ye,sr)|0,M=M+Math.imul(ye,ir)|0;var Jt=(Z+(C=C+Math.imul(me,wr)|0)|0)+((8191&(k=(k=k+Math.imul(me,jr)|0)+Math.imul(ge,wr)|0))<<13)|0;Z=((M=M+Math.imul(ge,jr)|0)+(k>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,C=Math.imul(Je,lr),k=(k=Math.imul(Je,Pt))+Math.imul(Ue,lr)|0,M=Math.imul(Ue,Pt),C=C+Math.imul(st,Me)|0,k=(k=k+Math.imul(st,it)|0)+Math.imul(nt,Me)|0,M=M+Math.imul(nt,it)|0,C=C+Math.imul(Qe,dt)|0,k=(k=k+Math.imul(Qe,It)|0)+Math.imul(Ie,dt)|0,M=M+Math.imul(Ie,It)|0,C=C+Math.imul(Ne,sr)|0,k=(k=k+Math.imul(Ne,ir)|0)+Math.imul(De,sr)|0,M=M+Math.imul(De,ir)|0;var tr=(Z+(C=C+Math.imul(be,wr)|0)|0)+((8191&(k=(k=k+Math.imul(be,jr)|0)+Math.imul(ye,wr)|0))<<13)|0;Z=((M=M+Math.imul(ye,jr)|0)+(k>>>13)|0)+(tr>>>26)|0,tr&=67108863,C=Math.imul(Je,Me),k=(k=Math.imul(Je,it))+Math.imul(Ue,Me)|0,M=Math.imul(Ue,it),C=C+Math.imul(st,dt)|0,k=(k=k+Math.imul(st,It)|0)+Math.imul(nt,dt)|0,M=M+Math.imul(nt,It)|0,C=C+Math.imul(Qe,sr)|0,k=(k=k+Math.imul(Qe,ir)|0)+Math.imul(Ie,sr)|0,M=M+Math.imul(Ie,ir)|0;var Ut=(Z+(C=C+Math.imul(Ne,wr)|0)|0)+((8191&(k=(k=k+Math.imul(Ne,jr)|0)+Math.imul(De,wr)|0))<<13)|0;Z=((M=M+Math.imul(De,jr)|0)+(k>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,C=Math.imul(Je,dt),k=(k=Math.imul(Je,It))+Math.imul(Ue,dt)|0,M=Math.imul(Ue,It),C=C+Math.imul(st,sr)|0,k=(k=k+Math.imul(st,ir)|0)+Math.imul(nt,sr)|0,M=M+Math.imul(nt,ir)|0;var xn=(Z+(C=C+Math.imul(Qe,wr)|0)|0)+((8191&(k=(k=k+Math.imul(Qe,jr)|0)+Math.imul(Ie,wr)|0))<<13)|0;Z=((M=M+Math.imul(Ie,jr)|0)+(k>>>13)|0)+(xn>>>26)|0,xn&=67108863,C=Math.imul(Je,sr),k=(k=Math.imul(Je,ir))+Math.imul(Ue,sr)|0,M=Math.imul(Ue,ir);var vn=(Z+(C=C+Math.imul(st,wr)|0)|0)+((8191&(k=(k=k+Math.imul(st,jr)|0)+Math.imul(nt,wr)|0))<<13)|0;Z=((M=M+Math.imul(nt,jr)|0)+(k>>>13)|0)+(vn>>>26)|0,vn&=67108863;var bn=(Z+(C=Math.imul(Je,wr))|0)+((8191&(k=(k=Math.imul(Je,jr))+Math.imul(Ue,wr)|0))<<13)|0;return Z=((M=Math.imul(Ue,jr))+(k>>>13)|0)+(bn>>>26)|0,bn&=67108863,X[0]=rt,X[1]=Ot,X[2]=rr,X[3]=nr,X[4]=Qt,X[5]=Ce,X[6]=Xe,X[7]=ft,X[8]=ze,X[9]=Zt,X[10]=wt,X[11]=kt,X[12]=Cr,X[13]=Jt,X[14]=tr,X[15]=Ut,X[16]=xn,X[17]=vn,X[18]=bn,Z!==0&&(X[19]=Z,N.length++),N};function T(S,E,N){N.negative=E.negative^S.negative,N.length=S.length+E.length;for(var C=0,k=0,M=0;M<N.length-1;M++){var U=k;k=0;for(var $=67108863&C,X=Math.min(M,E.length-1),Z=Math.max(0,M-S.length+1);Z<=X;Z++){var re=M-Z,W=(0|S.words[re])*(0|E.words[Z]),J=67108863&W;$=67108863&(J=J+$|0),k+=(U=(U=U+(W/67108864|0)|0)+(J>>>26)|0)>>>26,U&=67108863}N.words[M]=$,C=U,U=k}return C!==0?N.words[M]=C:N.length--,N._strip()}function O(S,E,N){return T(S,E,N)}Math.imul||(j=b),c.prototype.mulTo=function(S,E){var N=this.length+S.length;return this.length===10&&S.length===10?j(this,S,E):N<63?b(this,S,E):N<1024?T(this,S,E):O(this,S,E)},c.prototype.mul=function(S){var E=new c(null);return E.words=new Array(this.length+S.length),this.mulTo(S,E)},c.prototype.mulf=function(S){var E=new c(null);return E.words=new Array(this.length+S.length),O(this,S,E)},c.prototype.imul=function(S){return this.clone().mulTo(S,this)},c.prototype.imuln=function(S){var E=S<0;E&&(S=-S),l(typeof S=="number"),l(S<67108864);for(var N=0,C=0;C<this.length;C++){var k=(0|this.words[C])*S,M=(67108863&k)+(67108863&N);N>>=26,N+=k/67108864|0,N+=M>>>26,this.words[C]=67108863&M}return N!==0&&(this.words[C]=N,this.length++),E?this.ineg():this},c.prototype.muln=function(S){return this.clone().imuln(S)},c.prototype.sqr=function(){return this.mul(this)},c.prototype.isqr=function(){return this.imul(this.clone())},c.prototype.pow=function(S){var E=function(M){for(var U=new Array(M.bitLength()),$=0;$<U.length;$++){var X=$/26|0,Z=$%26;U[$]=M.words[X]>>>Z&1}return U}(S);if(E.length===0)return new c(1);for(var N=this,C=0;C<E.length&&E[C]===0;C++,N=N.sqr());if(++C<E.length)for(var k=N.sqr();C<E.length;C++,k=k.sqr())E[C]!==0&&(N=N.mul(k));return N},c.prototype.iushln=function(S){l(typeof S=="number"&&S>=0);var E,N=S%26,C=(S-N)/26,k=67108863>>>26-N<<26-N;if(N!==0){var M=0;for(E=0;E<this.length;E++){var U=this.words[E]&k,$=(0|this.words[E])-U<<N;this.words[E]=$|M,M=U>>>26-N}M&&(this.words[E]=M,this.length++)}if(C!==0){for(E=this.length-1;E>=0;E--)this.words[E+C]=this.words[E];for(E=0;E<C;E++)this.words[E]=0;this.length+=C}return this._strip()},c.prototype.ishln=function(S){return l(this.negative===0),this.iushln(S)},c.prototype.iushrn=function(S,E,N){var C;l(typeof S=="number"&&S>=0),C=E?(E-E%26)/26:0;var k=S%26,M=Math.min((S-k)/26,this.length),U=67108863^67108863>>>k<<k,$=N;if(C-=M,C=Math.max(0,C),$){for(var X=0;X<M;X++)$.words[X]=this.words[X];$.length=M}if(M!==0)if(this.length>M)for(this.length-=M,X=0;X<this.length;X++)this.words[X]=this.words[X+M];else this.words[0]=0,this.length=1;var Z=0;for(X=this.length-1;X>=0&&(Z!==0||X>=C);X--){var re=0|this.words[X];this.words[X]=Z<<26-k|re>>>k,Z=re&U}return $&&Z!==0&&($.words[$.length++]=Z),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},c.prototype.ishrn=function(S,E,N){return l(this.negative===0),this.iushrn(S,E,N)},c.prototype.shln=function(S){return this.clone().ishln(S)},c.prototype.ushln=function(S){return this.clone().iushln(S)},c.prototype.shrn=function(S){return this.clone().ishrn(S)},c.prototype.ushrn=function(S){return this.clone().iushrn(S)},c.prototype.testn=function(S){l(typeof S=="number"&&S>=0);var E=S%26,N=(S-E)/26,C=1<<E;return!(this.length<=N)&&!!(this.words[N]&C)},c.prototype.imaskn=function(S){l(typeof S=="number"&&S>=0);var E=S%26,N=(S-E)/26;if(l(this.negative===0,"imaskn works only with positive numbers"),this.length<=N)return this;if(E!==0&&N++,this.length=Math.min(N,this.length),E!==0){var C=67108863^67108863>>>E<<E;this.words[this.length-1]&=C}return this._strip()},c.prototype.maskn=function(S){return this.clone().imaskn(S)},c.prototype.iaddn=function(S){return l(typeof S=="number"),l(S<67108864),S<0?this.isubn(-S):this.negative!==0?this.length===1&&(0|this.words[0])<=S?(this.words[0]=S-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(S),this.negative=1,this):this._iaddn(S)},c.prototype._iaddn=function(S){this.words[0]+=S;for(var E=0;E<this.length&&this.words[E]>=67108864;E++)this.words[E]-=67108864,E===this.length-1?this.words[E+1]=1:this.words[E+1]++;return this.length=Math.max(this.length,E+1),this},c.prototype.isubn=function(S){if(l(typeof S=="number"),l(S<67108864),S<0)return this.iaddn(-S);if(this.negative!==0)return this.negative=0,this.iaddn(S),this.negative=1,this;if(this.words[0]-=S,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var E=0;E<this.length&&this.words[E]<0;E++)this.words[E]+=67108864,this.words[E+1]-=1;return this._strip()},c.prototype.addn=function(S){return this.clone().iaddn(S)},c.prototype.subn=function(S){return this.clone().isubn(S)},c.prototype.iabs=function(){return this.negative=0,this},c.prototype.abs=function(){return this.clone().iabs()},c.prototype._ishlnsubmul=function(S,E,N){var C,k,M=S.length+N;this._expand(M);var U=0;for(C=0;C<S.length;C++){k=(0|this.words[C+N])+U;var $=(0|S.words[C])*E;U=((k-=67108863&$)>>26)-($/67108864|0),this.words[C+N]=67108863&k}for(;C<this.length-N;C++)U=(k=(0|this.words[C+N])+U)>>26,this.words[C+N]=67108863&k;if(U===0)return this._strip();for(l(U===-1),U=0,C=0;C<this.length;C++)U=(k=-(0|this.words[C])+U)>>26,this.words[C]=67108863&k;return this.negative=1,this._strip()},c.prototype._wordDiv=function(S,E){var N=(this.length,S.length),C=this.clone(),k=S,M=0|k.words[k.length-1];(N=26-this._countBits(M))!==0&&(k=k.ushln(N),C.iushln(N),M=0|k.words[k.length-1]);var U,$=C.length-k.length;if(E!=="mod"){(U=new c(null)).length=$+1,U.words=new Array(U.length);for(var X=0;X<U.length;X++)U.words[X]=0}var Z=C.clone()._ishlnsubmul(k,1,$);Z.negative===0&&(C=Z,U&&(U.words[$]=1));for(var re=$-1;re>=0;re--){var W=67108864*(0|C.words[k.length+re])+(0|C.words[k.length+re-1]);for(W=Math.min(W/M|0,67108863),C._ishlnsubmul(k,W,re);C.negative!==0;)W--,C.negative=0,C._ishlnsubmul(k,1,re),C.isZero()||(C.negative^=1);U&&(U.words[re]=W)}return U&&U._strip(),C._strip(),E!=="div"&&N!==0&&C.iushrn(N),{div:U||null,mod:C}},c.prototype.divmod=function(S,E,N){return l(!S.isZero()),this.isZero()?{div:new c(0),mod:new c(0)}:this.negative!==0&&S.negative===0?(M=this.neg().divmod(S,E),E!=="mod"&&(C=M.div.neg()),E!=="div"&&(k=M.mod.neg(),N&&k.negative!==0&&k.iadd(S)),{div:C,mod:k}):this.negative===0&&S.negative!==0?(M=this.divmod(S.neg(),E),E!=="mod"&&(C=M.div.neg()),{div:C,mod:M.mod}):this.negative&S.negative?(M=this.neg().divmod(S.neg(),E),E!=="div"&&(k=M.mod.neg(),N&&k.negative!==0&&k.isub(S)),{div:M.div,mod:k}):S.length>this.length||this.cmp(S)<0?{div:new c(0),mod:this}:S.length===1?E==="div"?{div:this.divn(S.words[0]),mod:null}:E==="mod"?{div:null,mod:new c(this.modrn(S.words[0]))}:{div:this.divn(S.words[0]),mod:new c(this.modrn(S.words[0]))}:this._wordDiv(S,E);var C,k,M},c.prototype.div=function(S){return this.divmod(S,"div",!1).div},c.prototype.mod=function(S){return this.divmod(S,"mod",!1).mod},c.prototype.umod=function(S){return this.divmod(S,"mod",!0).mod},c.prototype.divRound=function(S){var E=this.divmod(S);if(E.mod.isZero())return E.div;var N=E.div.negative!==0?E.mod.isub(S):E.mod,C=S.ushrn(1),k=S.andln(1),M=N.cmp(C);return M<0||k===1&&M===0?E.div:E.div.negative!==0?E.div.isubn(1):E.div.iaddn(1)},c.prototype.modrn=function(S){var E=S<0;E&&(S=-S),l(S<=67108863);for(var N=(1<<26)%S,C=0,k=this.length-1;k>=0;k--)C=(N*C+(0|this.words[k]))%S;return E?-C:C},c.prototype.modn=function(S){return this.modrn(S)},c.prototype.idivn=function(S){var E=S<0;E&&(S=-S),l(S<=67108863);for(var N=0,C=this.length-1;C>=0;C--){var k=(0|this.words[C])+67108864*N;this.words[C]=k/S|0,N=k%S}return this._strip(),E?this.ineg():this},c.prototype.divn=function(S){return this.clone().idivn(S)},c.prototype.egcd=function(S){l(S.negative===0),l(!S.isZero());var E=this,N=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var C=new c(1),k=new c(0),M=new c(0),U=new c(1),$=0;E.isEven()&&N.isEven();)E.iushrn(1),N.iushrn(1),++$;for(var X=N.clone(),Z=E.clone();!E.isZero();){for(var re=0,W=1;!(E.words[0]&W)&&re<26;++re,W<<=1);if(re>0)for(E.iushrn(re);re-- >0;)(C.isOdd()||k.isOdd())&&(C.iadd(X),k.isub(Z)),C.iushrn(1),k.iushrn(1);for(var J=0,V=1;!(N.words[0]&V)&&J<26;++J,V<<=1);if(J>0)for(N.iushrn(J);J-- >0;)(M.isOdd()||U.isOdd())&&(M.iadd(X),U.isub(Z)),M.iushrn(1),U.iushrn(1);E.cmp(N)>=0?(E.isub(N),C.isub(M),k.isub(U)):(N.isub(E),M.isub(C),U.isub(k))}return{a:M,b:U,gcd:N.iushln($)}},c.prototype._invmp=function(S){l(S.negative===0),l(!S.isZero());var E=this,N=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var C,k=new c(1),M=new c(0),U=N.clone();E.cmpn(1)>0&&N.cmpn(1)>0;){for(var $=0,X=1;!(E.words[0]&X)&&$<26;++$,X<<=1);if($>0)for(E.iushrn($);$-- >0;)k.isOdd()&&k.iadd(U),k.iushrn(1);for(var Z=0,re=1;!(N.words[0]&re)&&Z<26;++Z,re<<=1);if(Z>0)for(N.iushrn(Z);Z-- >0;)M.isOdd()&&M.iadd(U),M.iushrn(1);E.cmp(N)>=0?(E.isub(N),k.isub(M)):(N.isub(E),M.isub(k))}return(C=E.cmpn(1)===0?k:M).cmpn(0)<0&&C.iadd(S),C},c.prototype.gcd=function(S){if(this.isZero())return S.abs();if(S.isZero())return this.abs();var E=this.clone(),N=S.clone();E.negative=0,N.negative=0;for(var C=0;E.isEven()&&N.isEven();C++)E.iushrn(1),N.iushrn(1);for(;;){for(;E.isEven();)E.iushrn(1);for(;N.isEven();)N.iushrn(1);var k=E.cmp(N);if(k<0){var M=E;E=N,N=M}else if(k===0||N.cmpn(1)===0)break;E.isub(N)}return N.iushln(C)},c.prototype.invm=function(S){return this.egcd(S).a.umod(S)},c.prototype.isEven=function(){return(1&this.words[0])==0},c.prototype.isOdd=function(){return(1&this.words[0])==1},c.prototype.andln=function(S){return this.words[0]&S},c.prototype.bincn=function(S){l(typeof S=="number");var E=S%26,N=(S-E)/26,C=1<<E;if(this.length<=N)return this._expand(N+1),this.words[N]|=C,this;for(var k=C,M=N;k!==0&&M<this.length;M++){var U=0|this.words[M];k=(U+=k)>>>26,U&=67108863,this.words[M]=U}return k!==0&&(this.words[M]=k,this.length++),this},c.prototype.isZero=function(){return this.length===1&&this.words[0]===0},c.prototype.cmpn=function(S){var E,N=S<0;if(this.negative!==0&&!N)return-1;if(this.negative===0&&N)return 1;if(this._strip(),this.length>1)E=1;else{N&&(S=-S),l(S<=67108863,"Number is too big");var C=0|this.words[0];E=C===S?0:C<S?-1:1}return this.negative!==0?0|-E:E},c.prototype.cmp=function(S){if(this.negative!==0&&S.negative===0)return-1;if(this.negative===0&&S.negative!==0)return 1;var E=this.ucmp(S);return this.negative!==0?0|-E:E},c.prototype.ucmp=function(S){if(this.length>S.length)return 1;if(this.length<S.length)return-1;for(var E=0,N=this.length-1;N>=0;N--){var C=0|this.words[N],k=0|S.words[N];if(C!==k){C<k?E=-1:C>k&&(E=1);break}}return E},c.prototype.gtn=function(S){return this.cmpn(S)===1},c.prototype.gt=function(S){return this.cmp(S)===1},c.prototype.gten=function(S){return this.cmpn(S)>=0},c.prototype.gte=function(S){return this.cmp(S)>=0},c.prototype.ltn=function(S){return this.cmpn(S)===-1},c.prototype.lt=function(S){return this.cmp(S)===-1},c.prototype.lten=function(S){return this.cmpn(S)<=0},c.prototype.lte=function(S){return this.cmp(S)<=0},c.prototype.eqn=function(S){return this.cmpn(S)===0},c.prototype.eq=function(S){return this.cmp(S)===0},c.red=function(S){return new I(S)},c.prototype.toRed=function(S){return l(!this.red,"Already a number in reduction context"),l(this.negative===0,"red works only with positives"),S.convertTo(this)._forceRed(S)},c.prototype.fromRed=function(){return l(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},c.prototype._forceRed=function(S){return this.red=S,this},c.prototype.forceRed=function(S){return l(!this.red,"Already a number in reduction context"),this._forceRed(S)},c.prototype.redAdd=function(S){return l(this.red,"redAdd works only with red numbers"),this.red.add(this,S)},c.prototype.redIAdd=function(S){return l(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,S)},c.prototype.redSub=function(S){return l(this.red,"redSub works only with red numbers"),this.red.sub(this,S)},c.prototype.redISub=function(S){return l(this.red,"redISub works only with red numbers"),this.red.isub(this,S)},c.prototype.redShl=function(S){return l(this.red,"redShl works only with red numbers"),this.red.shl(this,S)},c.prototype.redMul=function(S){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.mul(this,S)},c.prototype.redIMul=function(S){return l(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.imul(this,S)},c.prototype.redSqr=function(){return l(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},c.prototype.redISqr=function(){return l(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},c.prototype.redSqrt=function(){return l(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},c.prototype.redInvm=function(){return l(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},c.prototype.redNeg=function(){return l(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},c.prototype.redPow=function(S){return l(this.red&&!S.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,S)};var R={k256:null,p224:null,p192:null,p25519:null};function D(S,E){this.name=S,this.p=new c(E,16),this.n=this.p.bitLength(),this.k=new c(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function B(){D.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function q(){D.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function Y(){D.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function G(){D.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function I(S){if(typeof S=="string"){var E=c._prime(S);this.m=E.p,this.prime=E}else l(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}function F(S){I.call(this,S),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new c(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}D.prototype._tmp=function(){var S=new c(null);return S.words=new Array(Math.ceil(this.n/13)),S},D.prototype.ireduce=function(S){var E,N=S;do this.split(N,this.tmp),E=(N=(N=this.imulK(N)).iadd(this.tmp)).bitLength();while(E>this.n);var C=E<this.n?-1:N.ucmp(this.p);return C===0?(N.words[0]=0,N.length=1):C>0?N.isub(this.p):N.strip!==void 0?N.strip():N._strip(),N},D.prototype.split=function(S,E){S.iushrn(this.n,0,E)},D.prototype.imulK=function(S){return S.imul(this.k)},d(B,D),B.prototype.split=function(S,E){for(var N=Math.min(S.length,9),C=0;C<N;C++)E.words[C]=S.words[C];if(E.length=N,S.length<=9)return S.words[0]=0,void(S.length=1);var k=S.words[9];for(E.words[E.length++]=4194303&k,C=10;C<S.length;C++){var M=0|S.words[C];S.words[C-10]=(4194303&M)<<4|k>>>22,k=M}k>>>=22,S.words[C-10]=k,k===0&&S.length>10?S.length-=10:S.length-=9},B.prototype.imulK=function(S){S.words[S.length]=0,S.words[S.length+1]=0,S.length+=2;for(var E=0,N=0;N<S.length;N++){var C=0|S.words[N];E+=977*C,S.words[N]=67108863&E,E=64*C+(E/67108864|0)}return S.words[S.length-1]===0&&(S.length--,S.words[S.length-1]===0&&S.length--),S},d(q,D),d(Y,D),d(G,D),G.prototype.imulK=function(S){for(var E=0,N=0;N<S.length;N++){var C=19*(0|S.words[N])+E,k=67108863&C;C>>>=26,S.words[N]=k,E=C}return E!==0&&(S.words[S.length++]=E),S},c._prime=function(S){if(R[S])return R[S];var E;if(S==="k256")E=new B;else if(S==="p224")E=new q;else if(S==="p192")E=new Y;else{if(S!=="p25519")throw new Error("Unknown prime "+S);E=new G}return R[S]=E,E},I.prototype._verify1=function(S){l(S.negative===0,"red works only with positives"),l(S.red,"red works only with red numbers")},I.prototype._verify2=function(S,E){l((S.negative|E.negative)==0,"red works only with positives"),l(S.red&&S.red===E.red,"red works only with red numbers")},I.prototype.imod=function(S){return this.prime?this.prime.ireduce(S)._forceRed(this):(p(S,S.umod(this.m)._forceRed(this)),S)},I.prototype.neg=function(S){return S.isZero()?S.clone():this.m.sub(S)._forceRed(this)},I.prototype.add=function(S,E){this._verify2(S,E);var N=S.add(E);return N.cmp(this.m)>=0&&N.isub(this.m),N._forceRed(this)},I.prototype.iadd=function(S,E){this._verify2(S,E);var N=S.iadd(E);return N.cmp(this.m)>=0&&N.isub(this.m),N},I.prototype.sub=function(S,E){this._verify2(S,E);var N=S.sub(E);return N.cmpn(0)<0&&N.iadd(this.m),N._forceRed(this)},I.prototype.isub=function(S,E){this._verify2(S,E);var N=S.isub(E);return N.cmpn(0)<0&&N.iadd(this.m),N},I.prototype.shl=function(S,E){return this._verify1(S),this.imod(S.ushln(E))},I.prototype.imul=function(S,E){return this._verify2(S,E),this.imod(S.imul(E))},I.prototype.mul=function(S,E){return this._verify2(S,E),this.imod(S.mul(E))},I.prototype.isqr=function(S){return this.imul(S,S.clone())},I.prototype.sqr=function(S){return this.mul(S,S)},I.prototype.sqrt=function(S){if(S.isZero())return S.clone();var E=this.m.andln(3);if(l(E%2==1),E===3){var N=this.m.add(new c(1)).iushrn(2);return this.pow(S,N)}for(var C=this.m.subn(1),k=0;!C.isZero()&&C.andln(1)===0;)k++,C.iushrn(1);l(!C.isZero());var M=new c(1).toRed(this),U=M.redNeg(),$=this.m.subn(1).iushrn(1),X=this.m.bitLength();for(X=new c(2*X*X).toRed(this);this.pow(X,$).cmp(U)!==0;)X.redIAdd(U);for(var Z=this.pow(X,C),re=this.pow(S,C.addn(1).iushrn(1)),W=this.pow(S,C),J=k;W.cmp(M)!==0;){for(var V=W,H=0;V.cmp(M)!==0;H++)V=V.redSqr();l(H<J);var ee=this.pow(Z,new c(1).iushln(J-H-1));re=re.redMul(ee),Z=ee.redSqr(),W=W.redMul(Z),J=H}return re},I.prototype.invm=function(S){var E=S._invmp(this.m);return E.negative!==0?(E.negative=0,this.imod(E).redNeg()):this.imod(E)},I.prototype.pow=function(S,E){if(E.isZero())return new c(1).toRed(this);if(E.cmpn(1)===0)return S.clone();var N=new Array(16);N[0]=new c(1).toRed(this),N[1]=S;for(var C=2;C<N.length;C++)N[C]=this.mul(N[C-1],S);var k=N[0],M=0,U=0,$=E.bitLength()%26;for($===0&&($=26),C=E.length-1;C>=0;C--){for(var X=E.words[C],Z=$-1;Z>=0;Z--){var re=X>>Z&1;k!==N[0]&&(k=this.sqr(k)),re!==0||M!==0?(M<<=1,M|=re,(++U===4||C===0&&Z===0)&&(k=this.mul(k,N[M]),U=0,M=0)):U=0}$=26}return k},I.prototype.convertTo=function(S){var E=S.umod(this.m);return E===S?E.clone():E},I.prototype.convertFrom=function(S){var E=S.clone();return E.red=null,E},c.mont=function(S){return new F(S)},d(F,I),F.prototype.convertTo=function(S){return this.imod(S.ushln(this.shift))},F.prototype.convertFrom=function(S){var E=this.imod(S.mul(this.rinv));return E.red=null,E},F.prototype.imul=function(S,E){if(S.isZero()||E.isZero())return S.words[0]=0,S.length=1,S;var N=S.imul(E),C=N.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=N.isub(C).iushrn(this.shift),M=k;return k.cmp(this.m)>=0?M=k.isub(this.m):k.cmpn(0)<0&&(M=k.iadd(this.m)),M._forceRed(this)},F.prototype.mul=function(S,E){if(S.isZero()||E.isZero())return new c(0)._forceRed(this);var N=S.mul(E),C=N.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=N.isub(C).iushrn(this.shift),M=k;return k.cmp(this.m)>=0?M=k.isub(this.m):k.cmpn(0)<0&&(M=k.iadd(this.m)),M._forceRed(this)},F.prototype.invm=function(S){return this.imod(S._invmp(this.m).mul(this.r2))._forceRed(this)}})(s===void 0||s)},{buffer:188}],187:[function(r,s,a){var i;function o(d){this.rand=d}if(s.exports=function(d){return i||(i=new o(null)),i.generate(d)},s.exports.Rand=o,o.prototype.generate=function(d){return this._rand(d)},o.prototype._rand=function(d){if(this.rand.getBytes)return this.rand.getBytes(d);for(var c=new Uint8Array(d),u=0;u<c.length;u++)c[u]=this.rand.getByte();return c},typeof self=="object")self.crypto&&self.crypto.getRandomValues?o.prototype._rand=function(d){var c=new Uint8Array(d);return self.crypto.getRandomValues(c),c}:self.msCrypto&&self.msCrypto.getRandomValues?o.prototype._rand=function(d){var c=new Uint8Array(d);return self.msCrypto.getRandomValues(c),c}:typeof window=="object"&&(o.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var l=r("crypto");if(typeof l.randomBytes!="function")throw new Error("Not supported");o.prototype._rand=function(d){return l.randomBytes(d)}}catch{}},{crypto:188}],188:[function(r,s,a){},{}],189:[function(r,s,a){var i=r("safe-buffer").Buffer;function o(f){i.isBuffer(f)||(f=i.from(f));for(var m=f.length/4|0,p=new Array(m),g=0;g<m;g++)p[g]=f.readUInt32BE(4*g);return p}function l(f){for(;0<f.length;f++)f[0]=0}function d(f,m,p,g,x){for(var v,y,b,j,T=p[0],O=p[1],R=p[2],D=p[3],B=f[0]^m[0],q=f[1]^m[1],Y=f[2]^m[2],G=f[3]^m[3],I=4,F=1;F<x;F++)v=T[B>>>24]^O[q>>>16&255]^R[Y>>>8&255]^D[255&G]^m[I++],y=T[q>>>24]^O[Y>>>16&255]^R[G>>>8&255]^D[255&B]^m[I++],b=T[Y>>>24]^O[G>>>16&255]^R[B>>>8&255]^D[255&q]^m[I++],j=T[G>>>24]^O[B>>>16&255]^R[q>>>8&255]^D[255&Y]^m[I++],B=v,q=y,Y=b,G=j;return v=(g[B>>>24]<<24|g[q>>>16&255]<<16|g[Y>>>8&255]<<8|g[255&G])^m[I++],y=(g[q>>>24]<<24|g[Y>>>16&255]<<16|g[G>>>8&255]<<8|g[255&B])^m[I++],b=(g[Y>>>24]<<24|g[G>>>16&255]<<16|g[B>>>8&255]<<8|g[255&q])^m[I++],j=(g[G>>>24]<<24|g[B>>>16&255]<<16|g[q>>>8&255]<<8|g[255&Y])^m[I++],[v>>>=0,y>>>=0,b>>>=0,j>>>=0]}var c=[0,1,2,4,8,16,32,64,128,27,54],u=function(){for(var f=new Array(256),m=0;m<256;m++)f[m]=m<128?m<<1:m<<1^283;for(var p=[],g=[],x=[[],[],[],[]],v=[[],[],[],[]],y=0,b=0,j=0;j<256;++j){var T=b^b<<1^b<<2^b<<3^b<<4;T=T>>>8^255&T^99,p[y]=T,g[T]=y;var O=f[y],R=f[O],D=f[R],B=257*f[T]^16843008*T;x[0][y]=B<<24|B>>>8,x[1][y]=B<<16|B>>>16,x[2][y]=B<<8|B>>>24,x[3][y]=B,B=16843009*D^65537*R^257*O^16843008*y,v[0][T]=B<<24|B>>>8,v[1][T]=B<<16|B>>>16,v[2][T]=B<<8|B>>>24,v[3][T]=B,y===0?y=b=1:(y=O^f[f[f[D^O]]],b^=f[f[b]])}return{SBOX:p,INV_SBOX:g,SUB_MIX:x,INV_SUB_MIX:v}}();function h(f){this._key=o(f),this._reset()}h.blockSize=16,h.keySize=32,h.prototype.blockSize=h.blockSize,h.prototype.keySize=h.keySize,h.prototype._reset=function(){for(var f=this._key,m=f.length,p=m+6,g=4*(p+1),x=[],v=0;v<m;v++)x[v]=f[v];for(v=m;v<g;v++){var y=x[v-1];v%m==0?(y=y<<8|y>>>24,y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y],y^=c[v/m|0]<<24):m>6&&v%m==4&&(y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y]),x[v]=x[v-m]^y}for(var b=[],j=0;j<g;j++){var T=g-j,O=x[T-(j%4?0:4)];b[j]=j<4||T<=4?O:u.INV_SUB_MIX[0][u.SBOX[O>>>24]]^u.INV_SUB_MIX[1][u.SBOX[O>>>16&255]]^u.INV_SUB_MIX[2][u.SBOX[O>>>8&255]]^u.INV_SUB_MIX[3][u.SBOX[255&O]]}this._nRounds=p,this._keySchedule=x,this._invKeySchedule=b},h.prototype.encryptBlockRaw=function(f){return d(f=o(f),this._keySchedule,u.SUB_MIX,u.SBOX,this._nRounds)},h.prototype.encryptBlock=function(f){var m=this.encryptBlockRaw(f),p=i.allocUnsafe(16);return p.writeUInt32BE(m[0],0),p.writeUInt32BE(m[1],4),p.writeUInt32BE(m[2],8),p.writeUInt32BE(m[3],12),p},h.prototype.decryptBlock=function(f){var m=(f=o(f))[1];f[1]=f[3],f[3]=m;var p=d(f,this._invKeySchedule,u.INV_SUB_MIX,u.INV_SBOX,this._nRounds),g=i.allocUnsafe(16);return g.writeUInt32BE(p[0],0),g.writeUInt32BE(p[3],4),g.writeUInt32BE(p[2],8),g.writeUInt32BE(p[1],12),g},h.prototype.scrub=function(){l(this._keySchedule),l(this._invKeySchedule),l(this._key)},s.exports.AES=h},{"safe-buffer":494}],190:[function(r,s,a){var i=r("./aes"),o=r("safe-buffer").Buffer,l=r("cipher-base"),d=r("inherits"),c=r("./ghash"),u=r("buffer-xor"),h=r("./incr32");function f(m,p,g,x){l.call(this);var v=o.alloc(4,0);this._cipher=new i.AES(p);var y=this._cipher.encryptBlock(v);this._ghash=new c(y),g=function(b,j,T){if(j.length===12)return b._finID=o.concat([j,o.from([0,0,0,1])]),o.concat([j,o.from([0,0,0,2])]);var O=new c(T),R=j.length,D=R%16;O.update(j),D&&(D=16-D,O.update(o.alloc(D,0))),O.update(o.alloc(8,0));var B=8*R,q=o.alloc(8);q.writeUIntBE(B,0,8),O.update(q),b._finID=O.state;var Y=o.from(b._finID);return h(Y),Y}(this,g,y),this._prev=o.from(g),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=x,this._alen=0,this._len=0,this._mode=m,this._authTag=null,this._called=!1}d(f,l),f.prototype._update=function(m){if(!this._called&&this._alen){var p=16-this._alen%16;p<16&&(p=o.alloc(p,0),this._ghash.update(p))}this._called=!0;var g=this._mode.encrypt(this,m);return this._decrypt?this._ghash.update(m):this._ghash.update(g),this._len+=m.length,g},f.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var m=u(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(p,g){var x=0;p.length!==g.length&&x++;for(var v=Math.min(p.length,g.length),y=0;y<v;++y)x+=p[y]^g[y];return x}(m,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=m,this._cipher.scrub()},f.prototype.getAuthTag=function(){if(this._decrypt||!o.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},f.prototype.setAuthTag=function(m){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=m},f.prototype.setAAD=function(m){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(m),this._alen+=m.length},s.exports=f},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(r,s,a){var i=r("./encrypter"),o=r("./decrypter"),l=r("./modes/list.json");a.createCipher=a.Cipher=i.createCipher,a.createCipheriv=a.Cipheriv=i.createCipheriv,a.createDecipher=a.Decipher=o.createDecipher,a.createDecipheriv=a.Decipheriv=o.createDecipheriv,a.listCiphers=a.getCiphers=function(){return Object.keys(l)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(r,s,a){var i=r("./authCipher"),o=r("safe-buffer").Buffer,l=r("./modes"),d=r("./streamCipher"),c=r("cipher-base"),u=r("./aes"),h=r("evp_bytestokey");function f(g,x,v){c.call(this),this._cache=new m,this._last=void 0,this._cipher=new u.AES(x),this._prev=o.from(v),this._mode=g,this._autopadding=!0}function m(){this.cache=o.allocUnsafe(0)}function p(g,x,v){var y=l[g.toLowerCase()];if(!y)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=o.from(v)),y.mode!=="GCM"&&v.length!==y.iv)throw new TypeError("invalid iv length "+v.length);if(typeof x=="string"&&(x=o.from(x)),x.length!==y.key/8)throw new TypeError("invalid key length "+x.length);return y.type==="stream"?new d(y.module,x,v,!0):y.type==="auth"?new i(y.module,x,v,!0):new f(y.module,x,v)}r("inherits")(f,c),f.prototype._update=function(g){var x,v;this._cache.add(g);for(var y=[];x=this._cache.get(this._autopadding);)v=this._mode.decrypt(this,x),y.push(v);return o.concat(y)},f.prototype._final=function(){var g=this._cache.flush();if(this._autopadding)return function(x){var v=x[15];if(v<1||v>16)throw new Error("unable to decrypt data");for(var y=-1;++y<v;)if(x[y+(16-v)]!==v)throw new Error("unable to decrypt data");if(v!==16)return x.slice(0,16-v)}(this._mode.decrypt(this,g));if(g)throw new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(g){return this._autopadding=!!g,this},m.prototype.add=function(g){this.cache=o.concat([this.cache,g])},m.prototype.get=function(g){var x;if(g){if(this.cache.length>16)return x=this.cache.slice(0,16),this.cache=this.cache.slice(16),x}else if(this.cache.length>=16)return x=this.cache.slice(0,16),this.cache=this.cache.slice(16),x;return null},m.prototype.flush=function(){if(this.cache.length)return this.cache},a.createDecipher=function(g,x){var v=l[g.toLowerCase()];if(!v)throw new TypeError("invalid suite type");var y=h(x,!1,v.key,v.iv);return p(g,y.key,y.iv)},a.createDecipheriv=p},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(r,s,a){var i=r("./modes"),o=r("./authCipher"),l=r("safe-buffer").Buffer,d=r("./streamCipher"),c=r("cipher-base"),u=r("./aes"),h=r("evp_bytestokey");function f(x,v,y){c.call(this),this._cache=new p,this._cipher=new u.AES(v),this._prev=l.from(y),this._mode=x,this._autopadding=!0}r("inherits")(f,c),f.prototype._update=function(x){var v,y;this._cache.add(x);for(var b=[];v=this._cache.get();)y=this._mode.encrypt(this,v),b.push(y);return l.concat(b)};var m=l.alloc(16,16);function p(){this.cache=l.allocUnsafe(0)}function g(x,v,y){var b=i[x.toLowerCase()];if(!b)throw new TypeError("invalid suite type");if(typeof v=="string"&&(v=l.from(v)),v.length!==b.key/8)throw new TypeError("invalid key length "+v.length);if(typeof y=="string"&&(y=l.from(y)),b.mode!=="GCM"&&y.length!==b.iv)throw new TypeError("invalid iv length "+y.length);return b.type==="stream"?new d(b.module,v,y):b.type==="auth"?new o(b.module,v,y):new f(b.module,v,y)}f.prototype._final=function(){var x=this._cache.flush();if(this._autopadding)return x=this._mode.encrypt(this,x),this._cipher.scrub(),x;if(!x.equals(m))throw this._cipher.scrub(),new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(x){return this._autopadding=!!x,this},p.prototype.add=function(x){this.cache=l.concat([this.cache,x])},p.prototype.get=function(){if(this.cache.length>15){var x=this.cache.slice(0,16);return this.cache=this.cache.slice(16),x}return null},p.prototype.flush=function(){for(var x=16-this.cache.length,v=l.allocUnsafe(x),y=-1;++y<x;)v.writeUInt8(x,y);return l.concat([this.cache,v])},a.createCipheriv=g,a.createCipher=function(x,v){var y=i[x.toLowerCase()];if(!y)throw new TypeError("invalid suite type");var b=h(v,!1,y.key,y.iv);return g(x,b.key,b.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(r,s,a){var i=r("safe-buffer").Buffer,o=i.alloc(16,0);function l(c){var u=i.allocUnsafe(16);return u.writeUInt32BE(c[0]>>>0,0),u.writeUInt32BE(c[1]>>>0,4),u.writeUInt32BE(c[2]>>>0,8),u.writeUInt32BE(c[3]>>>0,12),u}function d(c){this.h=c,this.state=i.alloc(16,0),this.cache=i.allocUnsafe(0)}d.prototype.ghash=function(c){for(var u=-1;++u<c.length;)this.state[u]^=c[u];this._multiply()},d.prototype._multiply=function(){for(var c,u,h,f=[(c=this.h).readUInt32BE(0),c.readUInt32BE(4),c.readUInt32BE(8),c.readUInt32BE(12)],m=[0,0,0,0],p=-1;++p<128;){for(this.state[~~(p/8)]&1<<7-p%8&&(m[0]^=f[0],m[1]^=f[1],m[2]^=f[2],m[3]^=f[3]),h=(1&f[3])!=0,u=3;u>0;u--)f[u]=f[u]>>>1|(1&f[u-1])<<31;f[0]=f[0]>>>1,h&&(f[0]=f[0]^225<<24)}this.state=l(m)},d.prototype.update=function(c){var u;for(this.cache=i.concat([this.cache,c]);this.cache.length>=16;)u=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(u)},d.prototype.final=function(c,u){return this.cache.length&&this.ghash(i.concat([this.cache,o],16)),this.ghash(l([0,c,0,u])),this.state},s.exports=d},{"safe-buffer":494}],195:[function(r,s,a){s.exports=function(i){for(var o,l=i.length;l--;){if((o=i.readUInt8(l))!==255){o++,i.writeUInt8(o,l);break}i.writeUInt8(0,l)}}},{}],196:[function(r,s,a){var i=r("buffer-xor");a.encrypt=function(o,l){var d=i(l,o._prev);return o._prev=o._cipher.encryptBlock(d),o._prev},a.decrypt=function(o,l){var d=o._prev;o._prev=l;var c=o._cipher.decryptBlock(l);return i(c,d)}},{"buffer-xor":219}],197:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("buffer-xor");function l(d,c,u){var h=c.length,f=o(c,d._cache);return d._cache=d._cache.slice(h),d._prev=i.concat([d._prev,u?c:f]),f}a.encrypt=function(d,c,u){for(var h,f=i.allocUnsafe(0);c.length;){if(d._cache.length===0&&(d._cache=d._cipher.encryptBlock(d._prev),d._prev=i.allocUnsafe(0)),!(d._cache.length<=c.length)){f=i.concat([f,l(d,c,u)]);break}h=d._cache.length,f=i.concat([f,l(d,c.slice(0,h),u)]),c=c.slice(h)}return f}},{"buffer-xor":219,"safe-buffer":494}],198:[function(r,s,a){var i=r("safe-buffer").Buffer;function o(d,c,u){for(var h,f,m=-1,p=0;++m<8;)h=c&1<<7-m?128:0,p+=(128&(f=d._cipher.encryptBlock(d._prev)[0]^h))>>m%8,d._prev=l(d._prev,u?h:f);return p}function l(d,c){var u=d.length,h=-1,f=i.allocUnsafe(d.length);for(d=i.concat([d,i.from([c])]);++h<u;)f[h]=d[h]<<1|d[h+1]>>7;return f}a.encrypt=function(d,c,u){for(var h=c.length,f=i.allocUnsafe(h),m=-1;++m<h;)f[m]=o(d,c[m],u);return f}},{"safe-buffer":494}],199:[function(r,s,a){var i=r("safe-buffer").Buffer;function o(l,d,c){var u=l._cipher.encryptBlock(l._prev)[0]^d;return l._prev=i.concat([l._prev.slice(1),i.from([c?d:u])]),u}a.encrypt=function(l,d,c){for(var u=d.length,h=i.allocUnsafe(u),f=-1;++f<u;)h[f]=o(l,d[f],c);return h}},{"safe-buffer":494}],200:[function(r,s,a){var i=r("buffer-xor"),o=r("safe-buffer").Buffer,l=r("../incr32");function d(c){var u=c._cipher.encryptBlockRaw(c._prev);return l(c._prev),u}a.encrypt=function(c,u){var h=Math.ceil(u.length/16),f=c._cache.length;c._cache=o.concat([c._cache,o.allocUnsafe(16*h)]);for(var m=0;m<h;m++){var p=d(c),g=f+16*m;c._cache.writeUInt32BE(p[0],g+0),c._cache.writeUInt32BE(p[1],g+4),c._cache.writeUInt32BE(p[2],g+8),c._cache.writeUInt32BE(p[3],g+12)}var x=c._cache.slice(0,u.length);return c._cache=c._cache.slice(u.length),i(u,x)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(r,s,a){a.encrypt=function(i,o){return i._cipher.encryptBlock(o)},a.decrypt=function(i,o){return i._cipher.decryptBlock(o)}},{}],202:[function(r,s,a){var i={ECB:r("./ecb"),CBC:r("./cbc"),CFB:r("./cfb"),CFB8:r("./cfb8"),CFB1:r("./cfb1"),OFB:r("./ofb"),CTR:r("./ctr"),GCM:r("./ctr")},o=r("./list.json");for(var l in o)o[l].module=i[o[l].mode];s.exports=o},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(r,s,a){s.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(r,s,a){(function(i){(function(){var o=r("buffer-xor");function l(d){return d._prev=d._cipher.encryptBlock(d._prev),d._prev}a.encrypt=function(d,c){for(;d._cache.length<c.length;)d._cache=i.concat([d._cache,l(d)]);var u=d._cache.slice(0,c.length);return d._cache=d._cache.slice(c.length),o(c,u)}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(r,s,a){var i=r("./aes"),o=r("safe-buffer").Buffer,l=r("cipher-base");function d(c,u,h,f){l.call(this),this._cipher=new i.AES(u),this._prev=o.from(h),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=f,this._mode=c}r("inherits")(d,l),d.prototype._update=function(c){return this._mode.encrypt(this,c,this._decrypt)},d.prototype._final=function(){this._cipher.scrub()},s.exports=d},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(r,s,a){var i=r("browserify-des"),o=r("browserify-aes/browser"),l=r("browserify-aes/modes"),d=r("browserify-des/modes"),c=r("evp_bytestokey");function u(f,m,p){if(f=f.toLowerCase(),l[f])return o.createCipheriv(f,m,p);if(d[f])return new i({key:m,iv:p,mode:f});throw new TypeError("invalid suite type")}function h(f,m,p){if(f=f.toLowerCase(),l[f])return o.createDecipheriv(f,m,p);if(d[f])return new i({key:m,iv:p,mode:f,decrypt:!0});throw new TypeError("invalid suite type")}a.createCipher=a.Cipher=function(f,m){var p,g;if(f=f.toLowerCase(),l[f])p=l[f].key,g=l[f].iv;else{if(!d[f])throw new TypeError("invalid suite type");p=8*d[f].key,g=d[f].iv}var x=c(m,!1,p,g);return u(f,x.key,x.iv)},a.createCipheriv=a.Cipheriv=u,a.createDecipher=a.Decipher=function(f,m){var p,g;if(f=f.toLowerCase(),l[f])p=l[f].key,g=l[f].iv;else{if(!d[f])throw new TypeError("invalid suite type");p=8*d[f].key,g=d[f].iv}var x=c(m,!1,p,g);return h(f,x.key,x.iv)},a.createDecipheriv=a.Decipheriv=h,a.listCiphers=a.getCiphers=function(){return Object.keys(d).concat(o.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(r,s,a){var i=r("cipher-base"),o=r("des.js"),l=r("inherits"),d=r("safe-buffer").Buffer,c={"des-ede3-cbc":o.CBC.instantiate(o.EDE),"des-ede3":o.EDE,"des-ede-cbc":o.CBC.instantiate(o.EDE),"des-ede":o.EDE,"des-cbc":o.CBC.instantiate(o.DES),"des-ecb":o.DES};function u(h){i.call(this);var f,m=h.mode.toLowerCase(),p=c[m];f=h.decrypt?"decrypt":"encrypt";var g=h.key;d.isBuffer(g)||(g=d.from(g)),m!=="des-ede"&&m!=="des-ede-cbc"||(g=d.concat([g,g.slice(0,8)]));var x=h.iv;d.isBuffer(x)||(x=d.from(x)),this._des=p.create({key:g,iv:x,type:f})}c.des=c["des-cbc"],c.des3=c["des-ede3-cbc"],s.exports=u,l(u,i),u.prototype._update=function(h){return d.from(this._des.update(h))},u.prototype._final=function(){return d.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(r,s,a){a["des-ecb"]={key:8,iv:0},a["des-cbc"]=a.des={key:8,iv:8},a["des-ede3-cbc"]=a.des3={key:24,iv:8},a["des-ede3"]={key:24,iv:0},a["des-ede-cbc"]={key:16,iv:8},a["des-ede"]={key:16,iv:0}},{}],209:[function(r,s,a){(function(i){(function(){var o=r("bn.js"),l=r("randombytes");function d(u){var h,f=u.modulus.byteLength();do h=new o(l(f));while(h.cmp(u.modulus)>=0||!h.umod(u.prime1)||!h.umod(u.prime2));return h}function c(u,h){var f=function(R){var D=d(R);return{blinder:D.toRed(o.mont(R.modulus)).redPow(new o(R.publicExponent)).fromRed(),unblinder:D.invm(R.modulus)}}(h),m=h.modulus.byteLength(),p=new o(u).mul(f.blinder).umod(h.modulus),g=p.toRed(o.mont(h.prime1)),x=p.toRed(o.mont(h.prime2)),v=h.coefficient,y=h.prime1,b=h.prime2,j=g.redPow(h.exponent1).fromRed(),T=x.redPow(h.exponent2).fromRed(),O=j.isub(T).imul(v).umod(y).imul(b);return T.iadd(O).imul(f.unblinder).umod(h.modulus).toArrayLike(i,"be",m)}c.getr=d,s.exports=c}).call(this)}).call(this,r("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(r,s,a){s.exports=r("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(r,s,a){s.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(r,s,a){s.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("create-hash"),l=r("readable-stream"),d=r("inherits"),c=r("./sign"),u=r("./verify"),h=r("./algorithms.json");function f(x){l.Writable.call(this);var v=h[x];if(!v)throw new Error("Unknown message digest");this._hashType=v.hash,this._hash=o(v.hash),this._tag=v.id,this._signType=v.sign}function m(x){l.Writable.call(this);var v=h[x];if(!v)throw new Error("Unknown message digest");this._hash=o(v.hash),this._tag=v.id,this._signType=v.sign}function p(x){return new f(x)}function g(x){return new m(x)}Object.keys(h).forEach(function(x){h[x].id=i.from(h[x].id,"hex"),h[x.toLowerCase()]=h[x]}),d(f,l.Writable),f.prototype._write=function(x,v,y){this._hash.update(x),y()},f.prototype.update=function(x,v){return typeof x=="string"&&(x=i.from(x,v)),this._hash.update(x),this},f.prototype.sign=function(x,v){this.end();var y=this._hash.digest(),b=c(y,x,this._hashType,this._signType,this._tag);return v?b.toString(v):b},d(m,l.Writable),m.prototype._write=function(x,v,y){this._hash.update(x),y()},m.prototype.update=function(x,v){return typeof x=="string"&&(x=i.from(x,v)),this._hash.update(x),this},m.prototype.verify=function(x,v,y){typeof v=="string"&&(v=i.from(v,y)),this.end();var b=this._hash.digest();return u(v,b,x,this._signType,this._tag)},s.exports={Sign:p,Verify:g,createSign:p,createVerify:g}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("create-hmac"),l=r("browserify-rsa"),d=r("elliptic").ec,c=r("bn.js"),u=r("parse-asn1"),h=r("./curves.json");function f(x,v,y,b){if((x=i.from(x.toArray())).length<v.byteLength()){var j=i.alloc(v.byteLength()-x.length);x=i.concat([j,x])}var T=y.length,O=function(B,q){B=(B=m(B,q)).mod(q);var Y=i.from(B.toArray());if(Y.length<q.byteLength()){var G=i.alloc(q.byteLength()-Y.length);Y=i.concat([G,Y])}return Y}(y,v),R=i.alloc(T);R.fill(1);var D=i.alloc(T);return D=o(b,D).update(R).update(i.from([0])).update(x).update(O).digest(),R=o(b,D).update(R).digest(),{k:D=o(b,D).update(R).update(i.from([1])).update(x).update(O).digest(),v:R=o(b,D).update(R).digest()}}function m(x,v){var y=new c(x),b=(x.length<<3)-v.bitLength();return b>0&&y.ishrn(b),y}function p(x,v,y){var b,j;do{for(b=i.alloc(0);8*b.length<x.bitLength();)v.v=o(y,v.k).update(v.v).digest(),b=i.concat([b,v.v]);j=m(b,x),v.k=o(y,v.k).update(v.v).update(i.from([0])).digest(),v.v=o(y,v.k).update(v.v).digest()}while(j.cmp(x)!==-1);return j}function g(x,v,y,b){return x.toRed(c.mont(y)).redPow(v).fromRed().mod(b)}s.exports=function(x,v,y,b,j){var T=u(v);if(T.curve){if(b!=="ecdsa"&&b!=="ecdsa/rsa")throw new Error("wrong private key type");return function(B,q){var Y=h[q.curve.join(".")];if(!Y)throw new Error("unknown curve "+q.curve.join("."));var G=new d(Y).keyFromPrivate(q.privateKey).sign(B);return i.from(G.toDER())}(x,T)}if(T.type==="dsa"){if(b!=="dsa")throw new Error("wrong private key type");return function(B,q,Y){for(var G,I=q.params.priv_key,F=q.params.p,S=q.params.q,E=q.params.g,N=new c(0),C=m(B,S).mod(S),k=!1,M=f(I,S,B,Y);k===!1;)G=p(S,M,Y),N=g(E,G,F,S),(k=G.invm(S).imul(C.add(I.mul(N))).mod(S)).cmpn(0)===0&&(k=!1,N=new c(0));return function(U,$){U=U.toArray(),$=$.toArray(),128&U[0]&&(U=[0].concat(U)),128&$[0]&&($=[0].concat($));var X=[48,U.length+$.length+4,2,U.length];return X=X.concat(U,[2,$.length],$),i.from(X)}(N,k)}(x,T,y)}if(b!=="rsa"&&b!=="ecdsa/rsa")throw new Error("wrong private key type");x=i.concat([j,x]);for(var O=T.modulus.byteLength(),R=[0,1];x.length+R.length+1<O;)R.push(255);R.push(0);for(var D=-1;++D<x.length;)R.push(x[D]);return l(R,T)},s.exports.getKey=f,s.exports.makeKey=p},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("bn.js"),l=r("elliptic").ec,d=r("parse-asn1"),c=r("./curves.json");function u(h,f){if(h.cmpn(0)<=0)throw new Error("invalid sig");if(h.cmp(f)>=f)throw new Error("invalid sig")}s.exports=function(h,f,m,p,g){var x=d(m);if(x.type==="ec"){if(p!=="ecdsa"&&p!=="ecdsa/rsa")throw new Error("wrong public key type");return function(R,D,B){var q=c[B.data.algorithm.curve.join(".")];if(!q)throw new Error("unknown curve "+B.data.algorithm.curve.join("."));var Y=new l(q),G=B.data.subjectPrivateKey.data;return Y.verify(D,R,G)}(h,f,x)}if(x.type==="dsa"){if(p!=="dsa")throw new Error("wrong public key type");return function(R,D,B){var q=B.data.p,Y=B.data.q,G=B.data.g,I=B.data.pub_key,F=d.signature.decode(R,"der"),S=F.s,E=F.r;u(S,Y),u(E,Y);var N=o.mont(q),C=S.invm(Y);return G.toRed(N).redPow(new o(D).mul(C).mod(Y)).fromRed().mul(I.toRed(N).redPow(E.mul(C).mod(Y)).fromRed()).mod(q).mod(Y).cmp(E)===0}(h,f,x)}if(p!=="rsa"&&p!=="ecdsa/rsa")throw new Error("wrong public key type");f=i.concat([g,f]);for(var v=x.modulus.byteLength(),y=[1],b=0;f.length+y.length+2<v;)y.push(255),b++;y.push(0);for(var j=-1;++j<f.length;)y.push(f[j]);y=i.from(y);var T=o.mont(x.modulus);h=(h=new o(h).toRed(T)).redPow(new o(x.publicExponent)),h=i.from(h.fromRed().toArray());var O=b<8?1:0;for(v=Math.min(h.length,y.length),h.length!==y.length&&(O=1),j=-1;++j<v;)O|=h[j]^y[j];return O===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(r,s,a){},{}],217:[function(r,s,a){var i=r("buffer"),o=i.Buffer;function l(c,u){for(var h in c)u[h]=c[h]}function d(c,u,h){return o(c,u,h)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?s.exports=i:(l(i,a),a.Buffer=d),l(o,d),d.from=function(c,u,h){if(typeof c=="number")throw new TypeError("Argument must not be a number");return o(c,u,h)},d.alloc=function(c,u,h){if(typeof c!="number")throw new TypeError("Argument must be a number");var f=o(c);return u!==void 0?typeof h=="string"?f.fill(u,h):f.fill(u):f.fill(0),f},d.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return o(c)},d.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return i.SlowBuffer(c)}},{buffer:220}],218:[function(r,s,a){var i=r("safe-buffer").Buffer,o=i.isEncoding||function(x){switch((x=""+x)&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function l(x){var v;switch(this.encoding=function(y){var b=function(j){if(!j)return"utf8";for(var T;;)switch(j){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return j;default:if(T)return;j=(""+j).toLowerCase(),T=!0}}(y);if(typeof b!="string"&&(i.isEncoding===o||!o(y)))throw new Error("Unknown encoding: "+y);return b||y}(x),this.encoding){case"utf16le":this.text=u,this.end=h,v=4;break;case"utf8":this.fillLast=c,v=4;break;case"base64":this.text=f,this.end=m,v=3;break;default:return this.write=p,void(this.end=g)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(v)}function d(x){return x<=127?0:x>>5==6?2:x>>4==14?3:x>>3==30?4:x>>6==2?-1:-2}function c(x){var v=this.lastTotal-this.lastNeed,y=function(b,j,T){if((192&j[0])!=128)return b.lastNeed=0,"";if(b.lastNeed>1&&j.length>1){if((192&j[1])!=128)return b.lastNeed=1,"";if(b.lastNeed>2&&j.length>2&&(192&j[2])!=128)return b.lastNeed=2,""}}(this,x);return y!==void 0?y:this.lastNeed<=x.length?(x.copy(this.lastChar,v,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(x.copy(this.lastChar,v,0,x.length),void(this.lastNeed-=x.length))}function u(x,v){if((x.length-v)%2==0){var y=x.toString("utf16le",v);if(y){var b=y.charCodeAt(y.length-1);if(b>=55296&&b<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],y.slice(0,-1)}return y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",v,x.length-1)}function h(x){var v=x&&x.length?this.write(x):"";if(this.lastNeed){var y=this.lastTotal-this.lastNeed;return v+this.lastChar.toString("utf16le",0,y)}return v}function f(x,v){var y=(x.length-v)%3;return y===0?x.toString("base64",v):(this.lastNeed=3-y,this.lastTotal=3,y===1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",v,x.length-y))}function m(x){var v=x&&x.length?this.write(x):"";return this.lastNeed?v+this.lastChar.toString("base64",0,3-this.lastNeed):v}function p(x){return x.toString(this.encoding)}function g(x){return x&&x.length?this.write(x):""}a.StringDecoder=l,l.prototype.write=function(x){if(x.length===0)return"";var v,y;if(this.lastNeed){if((v=this.fillLast(x))===void 0)return"";y=this.lastNeed,this.lastNeed=0}else y=0;return y<x.length?v?v+this.text(x,y):this.text(x,y):v||""},l.prototype.end=function(x){var v=x&&x.length?this.write(x):"";return this.lastNeed?v+"":v},l.prototype.text=function(x,v){var y=function(j,T,O){var R=T.length-1;if(R<O)return 0;var D=d(T[R]);return D>=0?(D>0&&(j.lastNeed=D-1),D):--R<O||D===-2?0:(D=d(T[R]))>=0?(D>0&&(j.lastNeed=D-2),D):--R<O||D===-2?0:(D=d(T[R]))>=0?(D>0&&(D===2?D=0:j.lastNeed=D-3),D):0}(this,x,v);if(!this.lastNeed)return x.toString("utf8",v);this.lastTotal=y;var b=x.length-(y-this.lastNeed);return x.copy(this.lastChar,0,b),x.toString("utf8",v,b)},l.prototype.fillLast=function(x){if(this.lastNeed<=x.length)return x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),this.lastNeed-=x.length}},{"safe-buffer":217}],219:[function(r,s,a){(function(i){(function(){s.exports=function(o,l){for(var d=Math.min(o.length,l.length),c=new i(d),u=0;u<d;++u)c[u]=o[u]^l[u];return c}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220}],220:[function(r,s,a){(function(i){(function(){var o=r("base64-js"),l=r("ieee754");a.Buffer=c,a.SlowBuffer=function(V){return+V!=V&&(V=0),c.alloc(+V)},a.INSPECT_MAX_BYTES=50;function d(V){if(V>2147483647)throw new RangeError('The value "'+V+'" is invalid for option "size"');var H=new Uint8Array(V);return H.__proto__=c.prototype,H}function c(V,H,ee){if(typeof V=="number"){if(typeof H=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(V)}return u(V,H,ee)}function u(V,H,ee){if(typeof V=="string")return function(se,ue){if(typeof ue=="string"&&ue!==""||(ue="utf8"),!c.isEncoding(ue))throw new TypeError("Unknown encoding: "+ue);var pe=0|g(se,ue),ce=d(pe),ne=ce.write(se,ue);return ne!==pe&&(ce=ce.slice(0,ne)),ce}(V,H);if(ArrayBuffer.isView(V))return m(V);if(V==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V);if(W(V,ArrayBuffer)||V&&W(V.buffer,ArrayBuffer))return function(se,ue,pe){if(ue<0||se.byteLength<ue)throw new RangeError('"offset" is outside of buffer bounds');if(se.byteLength<ue+(pe||0))throw new RangeError('"length" is outside of buffer bounds');var ce;return ce=ue===void 0&&pe===void 0?new Uint8Array(se):pe===void 0?new Uint8Array(se,ue):new Uint8Array(se,ue,pe),ce.__proto__=c.prototype,ce}(V,H,ee);if(typeof V=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ie=V.valueOf&&V.valueOf();if(ie!=null&&ie!==V)return c.from(ie,H,ee);var oe=function(se){if(c.isBuffer(se)){var ue=0|p(se.length),pe=d(ue);return pe.length===0||se.copy(pe,0,0,ue),pe}if(se.length!==void 0)return typeof se.length!="number"||J(se.length)?d(0):m(se);if(se.type==="Buffer"&&Array.isArray(se.data))return m(se.data)}(V);if(oe)return oe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof V[Symbol.toPrimitive]=="function")return c.from(V[Symbol.toPrimitive]("string"),H,ee);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V)}function h(V){if(typeof V!="number")throw new TypeError('"size" argument must be of type number');if(V<0)throw new RangeError('The value "'+V+'" is invalid for option "size"')}function f(V){return h(V),d(V<0?0:0|p(V))}function m(V){for(var H=V.length<0?0:0|p(V.length),ee=d(H),ie=0;ie<H;ie+=1)ee[ie]=255&V[ie];return ee}function p(V){if(V>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|V}function g(V,H){if(c.isBuffer(V))return V.length;if(ArrayBuffer.isView(V)||W(V,ArrayBuffer))return V.byteLength;if(typeof V!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof V);var ee=V.length,ie=arguments.length>2&&arguments[2]===!0;if(!ie&&ee===0)return 0;for(var oe=!1;;)switch(H){case"ascii":case"latin1":case"binary":return ee;case"utf8":case"utf-8":return X(V).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*ee;case"hex":return ee>>>1;case"base64":return Z(V).length;default:if(oe)return ie?-1:X(V).length;H=(""+H).toLowerCase(),oe=!0}}function x(V,H,ee){var ie=!1;if((H===void 0||H<0)&&(H=0),H>this.length||((ee===void 0||ee>this.length)&&(ee=this.length),ee<=0)||(ee>>>=0)<=(H>>>=0))return"";for(V||(V="utf8");;)switch(V){case"hex":return F(this,H,ee);case"utf8":case"utf-8":return Y(this,H,ee);case"ascii":return G(this,H,ee);case"latin1":case"binary":return I(this,H,ee);case"base64":return q(this,H,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,H,ee);default:if(ie)throw new TypeError("Unknown encoding: "+V);V=(V+"").toLowerCase(),ie=!0}}function v(V,H,ee){var ie=V[H];V[H]=V[ee],V[ee]=ie}function y(V,H,ee,ie,oe){if(V.length===0)return-1;if(typeof ee=="string"?(ie=ee,ee=0):ee>2147483647?ee=2147483647:ee<-2147483648&&(ee=-2147483648),J(ee=+ee)&&(ee=oe?0:V.length-1),ee<0&&(ee=V.length+ee),ee>=V.length){if(oe)return-1;ee=V.length-1}else if(ee<0){if(!oe)return-1;ee=0}if(typeof H=="string"&&(H=c.from(H,ie)),c.isBuffer(H))return H.length===0?-1:b(V,H,ee,ie,oe);if(typeof H=="number")return H&=255,typeof Uint8Array.prototype.indexOf=="function"?oe?Uint8Array.prototype.indexOf.call(V,H,ee):Uint8Array.prototype.lastIndexOf.call(V,H,ee):b(V,[H],ee,ie,oe);throw new TypeError("val must be string, number or Buffer")}function b(V,H,ee,ie,oe){var se,ue=1,pe=V.length,ce=H.length;if(ie!==void 0&&((ie=String(ie).toLowerCase())==="ucs2"||ie==="ucs-2"||ie==="utf16le"||ie==="utf-16le")){if(V.length<2||H.length<2)return-1;ue=2,pe/=2,ce/=2,ee/=2}function ne(be,ye){return ue===1?be[ye]:be.readUInt16BE(ye*ue)}if(oe){var me=-1;for(se=ee;se<pe;se++)if(ne(V,se)===ne(H,me===-1?0:se-me)){if(me===-1&&(me=se),se-me+1===ce)return me*ue}else me!==-1&&(se-=se-me),me=-1}else for(ee+ce>pe&&(ee=pe-ce),se=ee;se>=0;se--){for(var ge=!0,_e=0;_e<ce;_e++)if(ne(V,se+_e)!==ne(H,_e)){ge=!1;break}if(ge)return se}return-1}function j(V,H,ee,ie){ee=Number(ee)||0;var oe=V.length-ee;ie?(ie=Number(ie))>oe&&(ie=oe):ie=oe;var se=H.length;ie>se/2&&(ie=se/2);for(var ue=0;ue<ie;++ue){var pe=parseInt(H.substr(2*ue,2),16);if(J(pe))return ue;V[ee+ue]=pe}return ue}function T(V,H,ee,ie){return re(X(H,V.length-ee),V,ee,ie)}function O(V,H,ee,ie){return re(function(oe){for(var se=[],ue=0;ue<oe.length;++ue)se.push(255&oe.charCodeAt(ue));return se}(H),V,ee,ie)}function R(V,H,ee,ie){return O(V,H,ee,ie)}function D(V,H,ee,ie){return re(Z(H),V,ee,ie)}function B(V,H,ee,ie){return re(function(oe,se){for(var ue,pe,ce,ne=[],me=0;me<oe.length&&!((se-=2)<0);++me)ue=oe.charCodeAt(me),pe=ue>>8,ce=ue%256,ne.push(ce),ne.push(pe);return ne}(H,V.length-ee),V,ee,ie)}function q(V,H,ee){return H===0&&ee===V.length?o.fromByteArray(V):o.fromByteArray(V.slice(H,ee))}function Y(V,H,ee){ee=Math.min(V.length,ee);for(var ie=[],oe=H;oe<ee;){var se,ue,pe,ce,ne=V[oe],me=null,ge=ne>239?4:ne>223?3:ne>191?2:1;if(oe+ge<=ee)switch(ge){case 1:ne<128&&(me=ne);break;case 2:(192&(se=V[oe+1]))==128&&(ce=(31&ne)<<6|63&se)>127&&(me=ce);break;case 3:se=V[oe+1],ue=V[oe+2],(192&se)==128&&(192&ue)==128&&(ce=(15&ne)<<12|(63&se)<<6|63&ue)>2047&&(ce<55296||ce>57343)&&(me=ce);break;case 4:se=V[oe+1],ue=V[oe+2],pe=V[oe+3],(192&se)==128&&(192&ue)==128&&(192&pe)==128&&(ce=(15&ne)<<18|(63&se)<<12|(63&ue)<<6|63&pe)>65535&&ce<1114112&&(me=ce)}me===null?(me=65533,ge=1):me>65535&&(me-=65536,ie.push(me>>>10&1023|55296),me=56320|1023&me),ie.push(me),oe+=ge}return function(_e){var be=_e.length;if(be<=4096)return String.fromCharCode.apply(String,_e);for(var ye="",Oe=0;Oe<be;)ye+=String.fromCharCode.apply(String,_e.slice(Oe,Oe+=4096));return ye}(ie)}a.kMaxLength=2147483647,c.TYPED_ARRAY_SUPPORT=function(){try{var V=new Uint8Array(1);return V.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},V.foo()===42}catch{return!1}}(),c.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),c.poolSize=8192,c.from=function(V,H,ee){return u(V,H,ee)},c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,c.alloc=function(V,H,ee){return function(ie,oe,se){return h(ie),ie<=0?d(ie):oe!==void 0?typeof se=="string"?d(ie).fill(oe,se):d(ie).fill(oe):d(ie)}(V,H,ee)},c.allocUnsafe=function(V){return f(V)},c.allocUnsafeSlow=function(V){return f(V)},c.isBuffer=function(V){return V!=null&&V._isBuffer===!0&&V!==c.prototype},c.compare=function(V,H){if(W(V,Uint8Array)&&(V=c.from(V,V.offset,V.byteLength)),W(H,Uint8Array)&&(H=c.from(H,H.offset,H.byteLength)),!c.isBuffer(V)||!c.isBuffer(H))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(V===H)return 0;for(var ee=V.length,ie=H.length,oe=0,se=Math.min(ee,ie);oe<se;++oe)if(V[oe]!==H[oe]){ee=V[oe],ie=H[oe];break}return ee<ie?-1:ie<ee?1:0},c.isEncoding=function(V){switch(String(V).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(V,H){if(!Array.isArray(V))throw new TypeError('"list" argument must be an Array of Buffers');if(V.length===0)return c.alloc(0);var ee;if(H===void 0)for(H=0,ee=0;ee<V.length;++ee)H+=V[ee].length;var ie=c.allocUnsafe(H),oe=0;for(ee=0;ee<V.length;++ee){var se=V[ee];if(W(se,Uint8Array)&&(se=c.from(se)),!c.isBuffer(se))throw new TypeError('"list" argument must be an Array of Buffers');se.copy(ie,oe),oe+=se.length}return ie},c.byteLength=g,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var V=this.length;if(V%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var H=0;H<V;H+=2)v(this,H,H+1);return this},c.prototype.swap32=function(){var V=this.length;if(V%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var H=0;H<V;H+=4)v(this,H,H+3),v(this,H+1,H+2);return this},c.prototype.swap64=function(){var V=this.length;if(V%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var H=0;H<V;H+=8)v(this,H,H+7),v(this,H+1,H+6),v(this,H+2,H+5),v(this,H+3,H+4);return this},c.prototype.toString=function(){var V=this.length;return V===0?"":arguments.length===0?Y(this,0,V):x.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(V){if(!c.isBuffer(V))throw new TypeError("Argument must be a Buffer");return this===V||c.compare(this,V)===0},c.prototype.inspect=function(){var V="",H=a.INSPECT_MAX_BYTES;return V=this.toString("hex",0,H).replace(/(.{2})/g,"$1 ").trim(),this.length>H&&(V+=" ... "),"<Buffer "+V+">"},c.prototype.compare=function(V,H,ee,ie,oe){if(W(V,Uint8Array)&&(V=c.from(V,V.offset,V.byteLength)),!c.isBuffer(V))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof V);if(H===void 0&&(H=0),ee===void 0&&(ee=V?V.length:0),ie===void 0&&(ie=0),oe===void 0&&(oe=this.length),H<0||ee>V.length||ie<0||oe>this.length)throw new RangeError("out of range index");if(ie>=oe&&H>=ee)return 0;if(ie>=oe)return-1;if(H>=ee)return 1;if(this===V)return 0;for(var se=(oe>>>=0)-(ie>>>=0),ue=(ee>>>=0)-(H>>>=0),pe=Math.min(se,ue),ce=this.slice(ie,oe),ne=V.slice(H,ee),me=0;me<pe;++me)if(ce[me]!==ne[me]){se=ce[me],ue=ne[me];break}return se<ue?-1:ue<se?1:0},c.prototype.includes=function(V,H,ee){return this.indexOf(V,H,ee)!==-1},c.prototype.indexOf=function(V,H,ee){return y(this,V,H,ee,!0)},c.prototype.lastIndexOf=function(V,H,ee){return y(this,V,H,ee,!1)},c.prototype.write=function(V,H,ee,ie){if(H===void 0)ie="utf8",ee=this.length,H=0;else if(ee===void 0&&typeof H=="string")ie=H,ee=this.length,H=0;else{if(!isFinite(H))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");H>>>=0,isFinite(ee)?(ee>>>=0,ie===void 0&&(ie="utf8")):(ie=ee,ee=void 0)}var oe=this.length-H;if((ee===void 0||ee>oe)&&(ee=oe),V.length>0&&(ee<0||H<0)||H>this.length)throw new RangeError("Attempt to write outside buffer bounds");ie||(ie="utf8");for(var se=!1;;)switch(ie){case"hex":return j(this,V,H,ee);case"utf8":case"utf-8":return T(this,V,H,ee);case"ascii":return O(this,V,H,ee);case"latin1":case"binary":return R(this,V,H,ee);case"base64":return D(this,V,H,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,V,H,ee);default:if(se)throw new TypeError("Unknown encoding: "+ie);ie=(""+ie).toLowerCase(),se=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function G(V,H,ee){var ie="";ee=Math.min(V.length,ee);for(var oe=H;oe<ee;++oe)ie+=String.fromCharCode(127&V[oe]);return ie}function I(V,H,ee){var ie="";ee=Math.min(V.length,ee);for(var oe=H;oe<ee;++oe)ie+=String.fromCharCode(V[oe]);return ie}function F(V,H,ee){var ie=V.length;(!H||H<0)&&(H=0),(!ee||ee<0||ee>ie)&&(ee=ie);for(var oe="",se=H;se<ee;++se)oe+=$(V[se]);return oe}function S(V,H,ee){for(var ie=V.slice(H,ee),oe="",se=0;se<ie.length;se+=2)oe+=String.fromCharCode(ie[se]+256*ie[se+1]);return oe}function E(V,H,ee){if(V%1!=0||V<0)throw new RangeError("offset is not uint");if(V+H>ee)throw new RangeError("Trying to access beyond buffer length")}function N(V,H,ee,ie,oe,se){if(!c.isBuffer(V))throw new TypeError('"buffer" argument must be a Buffer instance');if(H>oe||H<se)throw new RangeError('"value" argument is out of bounds');if(ee+ie>V.length)throw new RangeError("Index out of range")}function C(V,H,ee,ie,oe,se){if(ee+ie>V.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("Index out of range")}function k(V,H,ee,ie,oe){return H=+H,ee>>>=0,oe||C(V,0,ee,4),l.write(V,H,ee,ie,23,4),ee+4}function M(V,H,ee,ie,oe){return H=+H,ee>>>=0,oe||C(V,0,ee,8),l.write(V,H,ee,ie,52,8),ee+8}c.prototype.slice=function(V,H){var ee=this.length;(V=~~V)<0?(V+=ee)<0&&(V=0):V>ee&&(V=ee),(H=H===void 0?ee:~~H)<0?(H+=ee)<0&&(H=0):H>ee&&(H=ee),H<V&&(H=V);var ie=this.subarray(V,H);return ie.__proto__=c.prototype,ie},c.prototype.readUIntLE=function(V,H,ee){V>>>=0,H>>>=0,ee||E(V,H,this.length);for(var ie=this[V],oe=1,se=0;++se<H&&(oe*=256);)ie+=this[V+se]*oe;return ie},c.prototype.readUIntBE=function(V,H,ee){V>>>=0,H>>>=0,ee||E(V,H,this.length);for(var ie=this[V+--H],oe=1;H>0&&(oe*=256);)ie+=this[V+--H]*oe;return ie},c.prototype.readUInt8=function(V,H){return V>>>=0,H||E(V,1,this.length),this[V]},c.prototype.readUInt16LE=function(V,H){return V>>>=0,H||E(V,2,this.length),this[V]|this[V+1]<<8},c.prototype.readUInt16BE=function(V,H){return V>>>=0,H||E(V,2,this.length),this[V]<<8|this[V+1]},c.prototype.readUInt32LE=function(V,H){return V>>>=0,H||E(V,4,this.length),(this[V]|this[V+1]<<8|this[V+2]<<16)+16777216*this[V+3]},c.prototype.readUInt32BE=function(V,H){return V>>>=0,H||E(V,4,this.length),16777216*this[V]+(this[V+1]<<16|this[V+2]<<8|this[V+3])},c.prototype.readIntLE=function(V,H,ee){V>>>=0,H>>>=0,ee||E(V,H,this.length);for(var ie=this[V],oe=1,se=0;++se<H&&(oe*=256);)ie+=this[V+se]*oe;return ie>=(oe*=128)&&(ie-=Math.pow(2,8*H)),ie},c.prototype.readIntBE=function(V,H,ee){V>>>=0,H>>>=0,ee||E(V,H,this.length);for(var ie=H,oe=1,se=this[V+--ie];ie>0&&(oe*=256);)se+=this[V+--ie]*oe;return se>=(oe*=128)&&(se-=Math.pow(2,8*H)),se},c.prototype.readInt8=function(V,H){return V>>>=0,H||E(V,1,this.length),128&this[V]?-1*(255-this[V]+1):this[V]},c.prototype.readInt16LE=function(V,H){V>>>=0,H||E(V,2,this.length);var ee=this[V]|this[V+1]<<8;return 32768&ee?4294901760|ee:ee},c.prototype.readInt16BE=function(V,H){V>>>=0,H||E(V,2,this.length);var ee=this[V+1]|this[V]<<8;return 32768&ee?4294901760|ee:ee},c.prototype.readInt32LE=function(V,H){return V>>>=0,H||E(V,4,this.length),this[V]|this[V+1]<<8|this[V+2]<<16|this[V+3]<<24},c.prototype.readInt32BE=function(V,H){return V>>>=0,H||E(V,4,this.length),this[V]<<24|this[V+1]<<16|this[V+2]<<8|this[V+3]},c.prototype.readFloatLE=function(V,H){return V>>>=0,H||E(V,4,this.length),l.read(this,V,!0,23,4)},c.prototype.readFloatBE=function(V,H){return V>>>=0,H||E(V,4,this.length),l.read(this,V,!1,23,4)},c.prototype.readDoubleLE=function(V,H){return V>>>=0,H||E(V,8,this.length),l.read(this,V,!0,52,8)},c.prototype.readDoubleBE=function(V,H){return V>>>=0,H||E(V,8,this.length),l.read(this,V,!1,52,8)},c.prototype.writeUIntLE=function(V,H,ee,ie){V=+V,H>>>=0,ee>>>=0,ie||N(this,V,H,ee,Math.pow(2,8*ee)-1,0);var oe=1,se=0;for(this[H]=255&V;++se<ee&&(oe*=256);)this[H+se]=V/oe&255;return H+ee},c.prototype.writeUIntBE=function(V,H,ee,ie){V=+V,H>>>=0,ee>>>=0,ie||N(this,V,H,ee,Math.pow(2,8*ee)-1,0);var oe=ee-1,se=1;for(this[H+oe]=255&V;--oe>=0&&(se*=256);)this[H+oe]=V/se&255;return H+ee},c.prototype.writeUInt8=function(V,H,ee){return V=+V,H>>>=0,ee||N(this,V,H,1,255,0),this[H]=255&V,H+1},c.prototype.writeUInt16LE=function(V,H,ee){return V=+V,H>>>=0,ee||N(this,V,H,2,65535,0),this[H]=255&V,this[H+1]=V>>>8,H+2},c.prototype.writeUInt16BE=function(V,H,ee){return V=+V,H>>>=0,ee||N(this,V,H,2,65535,0),this[H]=V>>>8,this[H+1]=255&V,H+2},c.prototype.writeUInt32LE=function(V,H,ee){return V=+V,H>>>=0,ee||N(this,V,H,4,4294967295,0),this[H+3]=V>>>24,this[H+2]=V>>>16,this[H+1]=V>>>8,this[H]=255&V,H+4},c.prototype.writeUInt32BE=function(V,H,ee){return V=+V,H>>>=0,ee||N(this,V,H,4,4294967295,0),this[H]=V>>>24,this[H+1]=V>>>16,this[H+2]=V>>>8,this[H+3]=255&V,H+4},c.prototype.writeIntLE=function(V,H,ee,ie){if(V=+V,H>>>=0,!ie){var oe=Math.pow(2,8*ee-1);N(this,V,H,ee,oe-1,-oe)}var se=0,ue=1,pe=0;for(this[H]=255&V;++se<ee&&(ue*=256);)V<0&&pe===0&&this[H+se-1]!==0&&(pe=1),this[H+se]=(V/ue>>0)-pe&255;return H+ee},c.prototype.writeIntBE=function(V,H,ee,ie){if(V=+V,H>>>=0,!ie){var oe=Math.pow(2,8*ee-1);N(this,V,H,ee,oe-1,-oe)}var se=ee-1,ue=1,pe=0;for(this[H+se]=255&V;--se>=0&&(ue*=256);)V<0&&pe===0&&this[H+se+1]!==0&&(pe=1),this[H+se]=(V/ue>>0)-pe&255;return H+ee},c.prototype.writeInt8=function(V,H,ee){return V=+V,H>>>=0,ee||N(this,V,H,1,127,-128),V<0&&(V=255+V+1),this[H]=255&V,H+1},c.prototype.writeInt16LE=function(V,H,ee){return V=+V,H>>>=0,ee||N(this,V,H,2,32767,-32768),this[H]=255&V,this[H+1]=V>>>8,H+2},c.prototype.writeInt16BE=function(V,H,ee){return V=+V,H>>>=0,ee||N(this,V,H,2,32767,-32768),this[H]=V>>>8,this[H+1]=255&V,H+2},c.prototype.writeInt32LE=function(V,H,ee){return V=+V,H>>>=0,ee||N(this,V,H,4,2147483647,-2147483648),this[H]=255&V,this[H+1]=V>>>8,this[H+2]=V>>>16,this[H+3]=V>>>24,H+4},c.prototype.writeInt32BE=function(V,H,ee){return V=+V,H>>>=0,ee||N(this,V,H,4,2147483647,-2147483648),V<0&&(V=4294967295+V+1),this[H]=V>>>24,this[H+1]=V>>>16,this[H+2]=V>>>8,this[H+3]=255&V,H+4},c.prototype.writeFloatLE=function(V,H,ee){return k(this,V,H,!0,ee)},c.prototype.writeFloatBE=function(V,H,ee){return k(this,V,H,!1,ee)},c.prototype.writeDoubleLE=function(V,H,ee){return M(this,V,H,!0,ee)},c.prototype.writeDoubleBE=function(V,H,ee){return M(this,V,H,!1,ee)},c.prototype.copy=function(V,H,ee,ie){if(!c.isBuffer(V))throw new TypeError("argument should be a Buffer");if(ee||(ee=0),ie||ie===0||(ie=this.length),H>=V.length&&(H=V.length),H||(H=0),ie>0&&ie<ee&&(ie=ee),ie===ee||V.length===0||this.length===0)return 0;if(H<0)throw new RangeError("targetStart out of bounds");if(ee<0||ee>=this.length)throw new RangeError("Index out of range");if(ie<0)throw new RangeError("sourceEnd out of bounds");ie>this.length&&(ie=this.length),V.length-H<ie-ee&&(ie=V.length-H+ee);var oe=ie-ee;if(this===V&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(H,ee,ie);else if(this===V&&ee<H&&H<ie)for(var se=oe-1;se>=0;--se)V[se+H]=this[se+ee];else Uint8Array.prototype.set.call(V,this.subarray(ee,ie),H);return oe},c.prototype.fill=function(V,H,ee,ie){if(typeof V=="string"){if(typeof H=="string"?(ie=H,H=0,ee=this.length):typeof ee=="string"&&(ie=ee,ee=this.length),ie!==void 0&&typeof ie!="string")throw new TypeError("encoding must be a string");if(typeof ie=="string"&&!c.isEncoding(ie))throw new TypeError("Unknown encoding: "+ie);if(V.length===1){var oe=V.charCodeAt(0);(ie==="utf8"&&oe<128||ie==="latin1")&&(V=oe)}}else typeof V=="number"&&(V&=255);if(H<0||this.length<H||this.length<ee)throw new RangeError("Out of range index");if(ee<=H)return this;var se;if(H>>>=0,ee=ee===void 0?this.length:ee>>>0,V||(V=0),typeof V=="number")for(se=H;se<ee;++se)this[se]=V;else{var ue=c.isBuffer(V)?V:c.from(V,ie),pe=ue.length;if(pe===0)throw new TypeError('The value "'+V+'" is invalid for argument "value"');for(se=0;se<ee-H;++se)this[se+H]=ue[se%pe]}return this};var U=/[^+/0-9A-Za-z-_]/g;function $(V){return V<16?"0"+V.toString(16):V.toString(16)}function X(V,H){var ee;H=H||1/0;for(var ie=V.length,oe=null,se=[],ue=0;ue<ie;++ue){if((ee=V.charCodeAt(ue))>55295&&ee<57344){if(!oe){if(ee>56319){(H-=3)>-1&&se.push(239,191,189);continue}if(ue+1===ie){(H-=3)>-1&&se.push(239,191,189);continue}oe=ee;continue}if(ee<56320){(H-=3)>-1&&se.push(239,191,189),oe=ee;continue}ee=65536+(oe-55296<<10|ee-56320)}else oe&&(H-=3)>-1&&se.push(239,191,189);if(oe=null,ee<128){if((H-=1)<0)break;se.push(ee)}else if(ee<2048){if((H-=2)<0)break;se.push(ee>>6|192,63&ee|128)}else if(ee<65536){if((H-=3)<0)break;se.push(ee>>12|224,ee>>6&63|128,63&ee|128)}else{if(!(ee<1114112))throw new Error("Invalid code point");if((H-=4)<0)break;se.push(ee>>18|240,ee>>12&63|128,ee>>6&63|128,63&ee|128)}}return se}function Z(V){return o.toByteArray(function(H){if((H=(H=H.split("=")[0]).trim().replace(U,"")).length<2)return"";for(;H.length%4!=0;)H+="=";return H}(V))}function re(V,H,ee,ie){for(var oe=0;oe<ie&&!(oe+ee>=H.length||oe>=V.length);++oe)H[oe+ee]=V[oe];return oe}function W(V,H){return V instanceof H||V!=null&&V.constructor!=null&&V.constructor.name!=null&&V.constructor.name===H.name}function J(V){return V!=V}}).call(this)}).call(this,r("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("stream").Transform,l=r("string_decoder").StringDecoder;function d(c){o.call(this),this.hashMode=typeof c=="string",this.hashMode?this[c]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}r("inherits")(d,o),d.prototype.update=function(c,u,h){typeof c=="string"&&(c=i.from(c,u));var f=this._update(c);return this.hashMode?this:(h&&(f=this._toString(f,h)),f)},d.prototype.setAutoPadding=function(){},d.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},d.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},d.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},d.prototype._transform=function(c,u,h){var f;try{this.hashMode?this._update(c):this.push(this._update(c))}catch(m){f=m}finally{h(f)}},d.prototype._flush=function(c){var u;try{this.push(this.__final())}catch(h){u=h}c(u)},d.prototype._finalOrDigest=function(c){var u=this.__final()||i.alloc(0);return c&&(u=this._toString(u,c,!0)),u},d.prototype._toString=function(c,u,h){if(this._decoder||(this._decoder=new l(u),this._encoding=u),this._encoding!==u)throw new Error("can't switch encodings");var f=this._decoder.write(c);return h&&(f+=this._decoder.end()),f},s.exports=d},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(r,s,a){var i=r("../internals/is-callable"),o=r("../internals/try-to-string"),l=TypeError;s.exports=function(d){if(i(d))return d;throw new l(o(d)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(r,s,a){var i=r("../internals/is-constructor"),o=r("../internals/try-to-string"),l=TypeError;s.exports=function(d){if(i(d))return d;throw new l(o(d)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(r,s,a){var i=r("../internals/is-callable"),o=String,l=TypeError;s.exports=function(d){if(typeof d=="object"||i(d))return d;throw new l("Can't set "+o(d)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(r,s,a){var i=r("../internals/well-known-symbol"),o=r("../internals/object-create"),l=r("../internals/object-define-property").f,d=i("unscopables"),c=Array.prototype;c[d]===void 0&&l(c,d,{configurable:!0,value:o(null)}),s.exports=function(u){c[d][u]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(r,s,a){var i=r("../internals/object-is-prototype-of"),o=TypeError;s.exports=function(l,d){if(i(d,l))return l;throw new o("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(r,s,a){var i=r("../internals/is-object"),o=String,l=TypeError;s.exports=function(d){if(i(d))return d;throw new l(o(d)+" is not an object")}},{"../internals/is-object":289}],228:[function(r,s,a){var i=r("../internals/to-indexed-object"),o=r("../internals/to-absolute-index"),l=r("../internals/length-of-array-like"),d=function(c){return function(u,h,f){var m,p=i(u),g=l(p),x=o(f,g);if(c&&h!=h){for(;g>x;)if((m=p[x++])!=m)return!0}else for(;g>x;x++)if((c||x in p)&&p[x]===h)return c||x||0;return!c&&-1}};s.exports={includes:d(!0),indexOf:d(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(r,s,a){var i=r("../internals/function-bind-context"),o=r("../internals/function-uncurry-this"),l=r("../internals/indexed-object"),d=r("../internals/to-object"),c=r("../internals/length-of-array-like"),u=r("../internals/array-species-create"),h=o([].push),f=function(m){var p=m===1,g=m===2,x=m===3,v=m===4,y=m===6,b=m===7,j=m===5||y;return function(T,O,R,D){for(var B,q,Y=d(T),G=l(Y),I=i(O,R),F=c(G),S=0,E=D||u,N=p?E(T,F):g||b?E(T,0):void 0;F>S;S++)if((j||S in G)&&(q=I(B=G[S],S,Y),m))if(p)N[S]=q;else if(q)switch(m){case 3:return!0;case 5:return B;case 6:return S;case 2:h(N,B)}else switch(m){case 4:return!1;case 7:h(N,B)}return y?-1:x||v?v:N}};s.exports={forEach:f(0),map:f(1),filter:f(2),some:f(3),every:f(4),find:f(5),findIndex:f(6),filterReject:f(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(r,s,a){var i=r("../internals/to-absolute-index"),o=r("../internals/length-of-array-like"),l=r("../internals/create-property"),d=Array,c=Math.max;s.exports=function(u,h,f){for(var m=o(u),p=i(h,m),g=i(f===void 0?m:f,m),x=d(c(g-p,0)),v=0;p<g;p++,v++)l(x,v,u[p]);return x.length=v,x}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(r,s,a){var i=r("../internals/function-uncurry-this");s.exports=i([].slice)},{"../internals/function-uncurry-this":268}],232:[function(r,s,a){var i=r("../internals/is-array"),o=r("../internals/is-constructor"),l=r("../internals/is-object"),d=r("../internals/well-known-symbol")("species"),c=Array;s.exports=function(u){var h;return i(u)&&(h=u.constructor,(o(h)&&(h===c||i(h.prototype))||l(h)&&(h=h[d])===null)&&(h=void 0)),h===void 0?c:h}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(r,s,a){var i=r("../internals/array-species-constructor");s.exports=function(o,l){return new(i(o))(l===0?0:l)}},{"../internals/array-species-constructor":232}],234:[function(r,s,a){var i=r("../internals/well-known-symbol")("iterator"),o=!1;try{var l=0,d={next:function(){return{done:!!l++}},return:function(){o=!0}};d[i]=function(){return this},Array.from(d,function(){throw 2})}catch{}s.exports=function(c,u){try{if(!u&&!o)return!1}catch{return!1}var h=!1;try{var f={};f[i]=function(){return{next:function(){return{done:h=!0}}}},c(f)}catch{}return h}},{"../internals/well-known-symbol":357}],235:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=i({}.toString),l=i("".slice);s.exports=function(d){return l(o(d),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(r,s,a){var i=r("../internals/to-string-tag-support"),o=r("../internals/is-callable"),l=r("../internals/classof-raw"),d=r("../internals/well-known-symbol")("toStringTag"),c=Object,u=l(function(){return arguments}())==="Arguments";s.exports=i?l:function(h){var f,m,p;return h===void 0?"Undefined":h===null?"Null":typeof(m=function(g,x){try{return g[x]}catch{}}(f=c(h),d))=="string"?m:u?l(f):(p=l(f))==="Object"&&o(f.callee)?"Arguments":p}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(r,s,a){var i=r("../internals/has-own-property"),o=r("../internals/own-keys"),l=r("../internals/object-get-own-property-descriptor"),d=r("../internals/object-define-property");s.exports=function(c,u,h){for(var f=o(u),m=d.f,p=l.f,g=0;g<f.length;g++){var x=f[g];i(c,x)||h&&i(h,x)||m(c,x,p(u,x))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(r,s,a){var i=r("../internals/well-known-symbol")("match");s.exports=function(o){var l=/./;try{"/./"[o](l)}catch{try{return l[i]=!1,"/./"[o](l)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(r,s,a){var i=r("../internals/fails");s.exports=!i(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype})},{"../internals/fails":260}],240:[function(r,s,a){s.exports=function(i,o){return{value:i,done:o}}},{}],241:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/object-define-property"),l=r("../internals/create-property-descriptor");s.exports=i?function(d,c,u){return o.f(d,c,l(1,u))}:function(d,c,u){return d[c]=u,d}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(r,s,a){s.exports=function(i,o){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:o}}},{}],243:[function(r,s,a){var i=r("../internals/to-property-key"),o=r("../internals/object-define-property"),l=r("../internals/create-property-descriptor");s.exports=function(d,c,u){var h=i(c);h in d?o.f(d,h,l(0,u)):d[h]=u}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(r,s,a){var i=r("../internals/make-built-in"),o=r("../internals/object-define-property");s.exports=function(l,d,c){return c.get&&i(c.get,d,{getter:!0}),c.set&&i(c.set,d,{setter:!0}),o.f(l,d,c)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(r,s,a){var i=r("../internals/is-callable"),o=r("../internals/object-define-property"),l=r("../internals/make-built-in"),d=r("../internals/define-global-property");s.exports=function(c,u,h,f){f||(f={});var m=f.enumerable,p=f.name!==void 0?f.name:u;if(i(h)&&l(h,p,f),f.global)m?c[u]=h:d(u,h);else{try{f.unsafe?c[u]&&(m=!0):delete c[u]}catch{}m?c[u]=h:o.f(c,u,{value:h,enumerable:!1,configurable:!f.nonConfigurable,writable:!f.nonWritable})}return c}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(r,s,a){var i=r("../internals/global"),o=Object.defineProperty;s.exports=function(l,d){try{o(i,l,{value:d,configurable:!0,writable:!0})}catch{i[l]=d}return d}},{"../internals/global":274}],247:[function(r,s,a){var i=r("../internals/fails");s.exports=!i(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},{"../internals/fails":260}],248:[function(r,s,a){var i=typeof document=="object"&&document.all,o=i===void 0&&i!==void 0;s.exports={all:i,IS_HTMLDDA:o}},{}],249:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/is-object"),l=i.document,d=o(l)&&o(l.createElement);s.exports=function(c){return d?l.createElement(c):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(r,s,a){var i=r("../internals/engine-is-deno"),o=r("../internals/engine-is-node");s.exports=!i&&!o&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(r,s,a){s.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(r,s,a){var i=r("../internals/engine-user-agent");s.exports=/ipad|iphone|ipod/i.test(i)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(r,s,a){var i=r("../internals/engine-user-agent");s.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},{"../internals/engine-user-agent":256}],254:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/classof-raw");s.exports=o(i.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(r,s,a){var i=r("../internals/engine-user-agent");s.exports=/web0s(?!.*chrome)/i.test(i)},{"../internals/engine-user-agent":256}],256:[function(r,s,a){s.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(r,s,a){var i,o,l=r("../internals/global"),d=r("../internals/engine-user-agent"),c=l.process,u=l.Deno,h=c&&c.versions||u&&u.version,f=h&&h.v8;f&&(o=(i=f.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!o&&d&&(!(i=d.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=d.match(/Chrome\/(\d+)/))&&(o=+i[1]),s.exports=o},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(r,s,a){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/object-get-own-property-descriptor").f,l=r("../internals/create-non-enumerable-property"),d=r("../internals/define-built-in"),c=r("../internals/define-global-property"),u=r("../internals/copy-constructor-properties"),h=r("../internals/is-forced");s.exports=function(f,m){var p,g,x,v,y,b=f.target,j=f.global,T=f.stat;if(p=j?i:T?i[b]||c(b,{}):(i[b]||{}).prototype)for(g in m){if(v=m[g],x=f.dontCallGetSet?(y=o(p,g))&&y.value:p[g],!h(j?g:b+(T?".":"#")+g,f.forced)&&x!==void 0){if(typeof v==typeof x)continue;u(v,x)}(f.sham||x&&x.sham)&&l(v,"sham",!0),d(p,g,v,f)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(r,s,a){s.exports=function(i){try{return!!i()}catch{return!0}}},{}],261:[function(r,s,a){var i=r("../internals/function-bind-native"),o=Function.prototype,l=o.apply,d=o.call;s.exports=typeof Reflect=="object"&&Reflect.apply||(i?d.bind(l):function(){return d.apply(l,arguments)})},{"../internals/function-bind-native":263}],262:[function(r,s,a){var i=r("../internals/function-uncurry-this-clause"),o=r("../internals/a-callable"),l=r("../internals/function-bind-native"),d=i(i.bind);s.exports=function(c,u){return o(c),u===void 0?c:l?d(c,u):function(){return c.apply(u,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(r,s,a){var i=r("../internals/fails");s.exports=!i(function(){var o=(function(){}).bind();return typeof o!="function"||o.hasOwnProperty("prototype")})},{"../internals/fails":260}],264:[function(r,s,a){var i=r("../internals/function-bind-native"),o=Function.prototype.call;s.exports=i?o.bind(o):function(){return o.apply(o,arguments)}},{"../internals/function-bind-native":263}],265:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/has-own-property"),l=Function.prototype,d=i&&Object.getOwnPropertyDescriptor,c=o(l,"name"),u=c&&(function(){}).name==="something",h=c&&(!i||i&&d(l,"name").configurable);s.exports={EXISTS:c,PROPER:u,CONFIGURABLE:h}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/a-callable");s.exports=function(l,d,c){try{return i(o(Object.getOwnPropertyDescriptor(l,d)[c]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(r,s,a){var i=r("../internals/classof-raw"),o=r("../internals/function-uncurry-this");s.exports=function(l){if(i(l)==="Function")return o(l)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(r,s,a){var i=r("../internals/function-bind-native"),o=Function.prototype,l=o.call,d=i&&o.bind.bind(l,l);s.exports=i?d:function(c){return function(){return l.apply(c,arguments)}}},{"../internals/function-bind-native":263}],269:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/is-callable"),l=function(d){return o(d)?d:void 0};s.exports=function(d,c){return arguments.length<2?l(i[d]):i[d]&&i[d][c]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(r,s,a){var i=r("../internals/classof"),o=r("../internals/get-method"),l=r("../internals/is-null-or-undefined"),d=r("../internals/iterators"),c=r("../internals/well-known-symbol")("iterator");s.exports=function(u){if(!l(u))return o(u,c)||o(u,"@@iterator")||d[i(u)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(r,s,a){var i=r("../internals/function-call"),o=r("../internals/a-callable"),l=r("../internals/an-object"),d=r("../internals/try-to-string"),c=r("../internals/get-iterator-method"),u=TypeError;s.exports=function(h,f){var m=arguments.length<2?c(h):f;if(o(m))return l(i(m,h));throw new u(d(h)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/is-array"),l=r("../internals/is-callable"),d=r("../internals/classof-raw"),c=r("../internals/to-string"),u=i([].push);s.exports=function(h){if(l(h))return h;if(o(h)){for(var f=h.length,m=[],p=0;p<f;p++){var g=h[p];typeof g=="string"?u(m,g):typeof g!="number"&&d(g)!=="Number"&&d(g)!=="String"||u(m,c(g))}var x=m.length,v=!0;return function(y,b){if(v)return v=!1,b;if(o(this))return b;for(var j=0;j<x;j++)if(m[j]===y)return b}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(r,s,a){var i=r("../internals/a-callable"),o=r("../internals/is-null-or-undefined");s.exports=function(l,d){var c=l[d];return o(c)?void 0:i(c)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(r,s,a){(function(i){(function(){var o=function(l){return l&&l.Math===Math&&l};s.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof i=="object"&&i)||function(){return this}()||this||Function("return this")()}).call(this)}).call(this,typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/to-object"),l=i({}.hasOwnProperty);s.exports=Object.hasOwn||function(d,c){return l(o(d),c)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(r,s,a){s.exports={}},{}],277:[function(r,s,a){s.exports=function(i,o){try{arguments.length===1?console.error(i):console.error(i,o)}catch{}}},{}],278:[function(r,s,a){var i=r("../internals/get-built-in");s.exports=i("document","documentElement")},{"../internals/get-built-in":269}],279:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/fails"),l=r("../internals/document-create-element");s.exports=!i&&!o(function(){return Object.defineProperty(l("div"),"a",{get:function(){return 7}}).a!==7})},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/fails"),l=r("../internals/classof-raw"),d=Object,c=i("".split);s.exports=o(function(){return!d("z").propertyIsEnumerable(0)})?function(u){return l(u)==="String"?c(u,""):d(u)}:d},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/is-callable"),l=r("../internals/shared-store"),d=i(Function.toString);o(l.inspectSource)||(l.inspectSource=function(c){return d(c)}),s.exports=l.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(r,s,a){var i,o,l,d=r("../internals/weak-map-basic-detection"),c=r("../internals/global"),u=r("../internals/is-object"),h=r("../internals/create-non-enumerable-property"),f=r("../internals/has-own-property"),m=r("../internals/shared-store"),p=r("../internals/shared-key"),g=r("../internals/hidden-keys"),x=c.TypeError,v=c.WeakMap;if(d||m.state){var y=m.state||(m.state=new v);y.get=y.get,y.has=y.has,y.set=y.set,i=function(j,T){if(y.has(j))throw new x("Object already initialized");return T.facade=j,y.set(j,T),T},o=function(j){return y.get(j)||{}},l=function(j){return y.has(j)}}else{var b=p("state");g[b]=!0,i=function(j,T){if(f(j,b))throw new x("Object already initialized");return T.facade=j,h(j,b,T),T},o=function(j){return f(j,b)?j[b]:{}},l=function(j){return f(j,b)}}s.exports={set:i,get:o,has:l,enforce:function(j){return l(j)?o(j):i(j,{})},getterFor:function(j){return function(T){var O;if(!u(T)||(O=o(T)).type!==j)throw new x("Incompatible receiver, "+j+" required");return O}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(r,s,a){var i=r("../internals/well-known-symbol"),o=r("../internals/iterators"),l=i("iterator"),d=Array.prototype;s.exports=function(c){return c!==void 0&&(o.Array===c||d[l]===c)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(r,s,a){var i=r("../internals/classof-raw");s.exports=Array.isArray||function(o){return i(o)==="Array"}},{"../internals/classof-raw":235}],285:[function(r,s,a){var i=r("../internals/document-all"),o=i.all;s.exports=i.IS_HTMLDDA?function(l){return typeof l=="function"||l===o}:function(l){return typeof l=="function"}},{"../internals/document-all":248}],286:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/fails"),l=r("../internals/is-callable"),d=r("../internals/classof"),c=r("../internals/get-built-in"),u=r("../internals/inspect-source"),h=function(){},f=[],m=c("Reflect","construct"),p=/^\s*(?:class|function)\b/,g=i(p.exec),x=!p.test(h),v=function(b){if(!l(b))return!1;try{return m(h,f,b),!0}catch{return!1}},y=function(b){if(!l(b))return!1;switch(d(b)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return x||!!g(p,u(b))}catch{return!0}};y.sham=!0,s.exports=!m||o(function(){var b;return v(v.call)||!v(Object)||!v(function(){b=!0})||b})?y:v},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(r,s,a){var i=r("../internals/fails"),o=r("../internals/is-callable"),l=/#|\.prototype\./,d=function(m,p){var g=u[c(m)];return g===f||g!==h&&(o(p)?i(p):!!p)},c=d.normalize=function(m){return String(m).replace(l,".").toLowerCase()},u=d.data={},h=d.NATIVE="N",f=d.POLYFILL="P";s.exports=d},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(r,s,a){s.exports=function(i){return i==null}},{}],289:[function(r,s,a){var i=r("../internals/is-callable"),o=r("../internals/document-all"),l=o.all;s.exports=o.IS_HTMLDDA?function(d){return typeof d=="object"?d!==null:i(d)||d===l}:function(d){return typeof d=="object"?d!==null:i(d)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(r,s,a){s.exports=!1},{}],291:[function(r,s,a){var i=r("../internals/is-object"),o=r("../internals/classof-raw"),l=r("../internals/well-known-symbol")("match");s.exports=function(d){var c;return i(d)&&((c=d[l])!==void 0?!!c:o(d)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(r,s,a){var i=r("../internals/get-built-in"),o=r("../internals/is-callable"),l=r("../internals/object-is-prototype-of"),d=r("../internals/use-symbol-as-uid"),c=Object;s.exports=d?function(u){return typeof u=="symbol"}:function(u){var h=i("Symbol");return o(h)&&l(h.prototype,c(u))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(r,s,a){var i=r("../internals/function-bind-context"),o=r("../internals/function-call"),l=r("../internals/an-object"),d=r("../internals/try-to-string"),c=r("../internals/is-array-iterator-method"),u=r("../internals/length-of-array-like"),h=r("../internals/object-is-prototype-of"),f=r("../internals/get-iterator"),m=r("../internals/get-iterator-method"),p=r("../internals/iterator-close"),g=TypeError,x=function(y,b){this.stopped=y,this.result=b},v=x.prototype;s.exports=function(y,b,j){var T,O,R,D,B,q,Y,G=j&&j.that,I=!(!j||!j.AS_ENTRIES),F=!(!j||!j.IS_RECORD),S=!(!j||!j.IS_ITERATOR),E=!(!j||!j.INTERRUPTED),N=i(b,G),C=function(M){return T&&p(T,"normal",M),new x(!0,M)},k=function(M){return I?(l(M),E?N(M[0],M[1],C):N(M[0],M[1])):E?N(M,C):N(M)};if(F)T=y.iterator;else if(S)T=y;else{if(!(O=m(y)))throw new g(d(y)+" is not iterable");if(c(O)){for(R=0,D=u(y);D>R;R++)if((B=k(y[R]))&&h(v,B))return B;return new x(!1)}T=f(y,O)}for(q=F?y.next:T.next;!(Y=o(q,T)).done;){try{B=k(Y.value)}catch(M){p(T,"throw",M)}if(typeof B=="object"&&B&&h(v,B))return B}return new x(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(r,s,a){var i=r("../internals/function-call"),o=r("../internals/an-object"),l=r("../internals/get-method");s.exports=function(d,c,u){var h,f;o(d);try{if(!(h=l(d,"return"))){if(c==="throw")throw u;return u}h=i(h,d)}catch(m){f=!0,h=m}if(c==="throw")throw u;if(f)throw h;return o(h),u}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(r,s,a){var i=r("../internals/iterators-core").IteratorPrototype,o=r("../internals/object-create"),l=r("../internals/create-property-descriptor"),d=r("../internals/set-to-string-tag"),c=r("../internals/iterators"),u=function(){return this};s.exports=function(h,f,m,p){var g=f+" Iterator";return h.prototype=o(i,{next:l(+!p,m)}),d(h,g,!1,!0),c[g]=u,h}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-call"),l=r("../internals/is-pure"),d=r("../internals/function-name"),c=r("../internals/is-callable"),u=r("../internals/iterator-create-constructor"),h=r("../internals/object-get-prototype-of"),f=r("../internals/object-set-prototype-of"),m=r("../internals/set-to-string-tag"),p=r("../internals/create-non-enumerable-property"),g=r("../internals/define-built-in"),x=r("../internals/well-known-symbol"),v=r("../internals/iterators"),y=r("../internals/iterators-core"),b=d.PROPER,j=d.CONFIGURABLE,T=y.IteratorPrototype,O=y.BUGGY_SAFARI_ITERATORS,R=x("iterator"),D=function(){return this};s.exports=function(B,q,Y,G,I,F,S){u(Y,q,G);var E,N,C,k=function(W){if(W===I&&Z)return Z;if(!O&&W&&W in $)return $[W];switch(W){case"keys":case"values":case"entries":return function(){return new Y(this,W)}}return function(){return new Y(this)}},M=q+" Iterator",U=!1,$=B.prototype,X=$[R]||$["@@iterator"]||I&&$[I],Z=!O&&X||k(I),re=q==="Array"&&$.entries||X;if(re&&(E=h(re.call(new B)))!==Object.prototype&&E.next&&(l||h(E)===T||(f?f(E,T):c(E[R])||g(E,R,D)),m(E,M,!0,!0),l&&(v[M]=D)),b&&I==="values"&&X&&X.name!=="values"&&(!l&&j?p($,"name","values"):(U=!0,Z=function(){return o(X,this)})),I)if(N={values:k("values"),keys:F?Z:k("keys"),entries:k("entries")},S)for(C in N)(O||U||!(C in $))&&g($,C,N[C]);else i({target:q,proto:!0,forced:O||U},N);return l&&!S||$[R]===Z||g($,R,Z,{name:I}),v[q]=Z,N}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(r,s,a){var i,o,l,d=r("../internals/fails"),c=r("../internals/is-callable"),u=r("../internals/is-object"),h=r("../internals/object-create"),f=r("../internals/object-get-prototype-of"),m=r("../internals/define-built-in"),p=r("../internals/well-known-symbol"),g=r("../internals/is-pure"),x=p("iterator"),v=!1;[].keys&&("next"in(l=[].keys())?(o=f(f(l)))!==Object.prototype&&(i=o):v=!0),!u(i)||d(function(){var y={};return i[x].call(y)!==y})?i={}:g&&(i=h(i)),c(i[x])||m(i,x,function(){return this}),s.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:v}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(r,s,a){arguments[4][276][0].apply(a,arguments)},{dup:276}],299:[function(r,s,a){var i=r("../internals/to-length");s.exports=function(o){return i(o.length)}},{"../internals/to-length":343}],300:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/fails"),l=r("../internals/is-callable"),d=r("../internals/has-own-property"),c=r("../internals/descriptors"),u=r("../internals/function-name").CONFIGURABLE,h=r("../internals/inspect-source"),f=r("../internals/internal-state"),m=f.enforce,p=f.get,g=String,x=Object.defineProperty,v=i("".slice),y=i("".replace),b=i([].join),j=c&&!o(function(){return x(function(){},"length",{value:8}).length!==8}),T=String(String).split("String"),O=s.exports=function(R,D,B){v(g(D),0,7)==="Symbol("&&(D="["+y(g(D),/^Symbol\(([^)]*)\)/,"$1")+"]"),B&&B.getter&&(D="get "+D),B&&B.setter&&(D="set "+D),(!d(R,"name")||u&&R.name!==D)&&(c?x(R,"name",{value:D,configurable:!0}):R.name=D),j&&B&&d(B,"arity")&&R.length!==B.arity&&x(R,"length",{value:B.arity});try{B&&d(B,"constructor")&&B.constructor?c&&x(R,"prototype",{writable:!1}):R.prototype&&(R.prototype=void 0)}catch{}var q=m(R);return d(q,"source")||(q.source=b(T,typeof D=="string"?D:"")),R};Function.prototype.toString=O(function(){return l(this)&&p(this).source||h(this)},"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(r,s,a){var i=Math.ceil,o=Math.floor;s.exports=Math.trunc||function(l){var d=+l;return(d>0?o:i)(d)}},{}],302:[function(r,s,a){var i,o,l,d,c,u=r("../internals/global"),h=r("../internals/function-bind-context"),f=r("../internals/object-get-own-property-descriptor").f,m=r("../internals/task").set,p=r("../internals/queue"),g=r("../internals/engine-is-ios"),x=r("../internals/engine-is-ios-pebble"),v=r("../internals/engine-is-webos-webkit"),y=r("../internals/engine-is-node"),b=u.MutationObserver||u.WebKitMutationObserver,j=u.document,T=u.process,O=u.Promise,R=f(u,"queueMicrotask"),D=R&&R.value;if(!D){var B=new p,q=function(){var Y,G;for(y&&(Y=T.domain)&&Y.exit();G=B.get();)try{G()}catch(I){throw B.head&&i(),I}Y&&Y.enter()};g||y||v||!b||!j?!x&&O&&O.resolve?((d=O.resolve(void 0)).constructor=O,c=h(d.then,d),i=function(){c(q)}):y?i=function(){T.nextTick(q)}:(m=h(m,u),i=function(){m(q)}):(o=!0,l=j.createTextNode(""),new b(q).observe(l,{characterData:!0}),i=function(){l.data=o=!o}),D=function(Y){B.head||i(),B.add(Y)}}s.exports=D},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(r,s,a){var i=r("../internals/a-callable"),o=TypeError,l=function(d){var c,u;this.promise=new d(function(h,f){if(c!==void 0||u!==void 0)throw new o("Bad Promise constructor");c=h,u=f}),this.resolve=i(c),this.reject=i(u)};s.exports.f=function(d){return new l(d)}},{"../internals/a-callable":222}],304:[function(r,s,a){var i=r("../internals/is-regexp"),o=TypeError;s.exports=function(l){if(i(l))throw new o("The method doesn't accept regular expressions");return l}},{"../internals/is-regexp":291}],305:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/function-uncurry-this"),l=r("../internals/function-call"),d=r("../internals/fails"),c=r("../internals/object-keys"),u=r("../internals/object-get-own-property-symbols"),h=r("../internals/object-property-is-enumerable"),f=r("../internals/to-object"),m=r("../internals/indexed-object"),p=Object.assign,g=Object.defineProperty,x=o([].concat);s.exports=!p||d(function(){if(i&&p({b:1},p(g({},"a",{enumerable:!0,get:function(){g(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var v={},y={},b=Symbol("assign detection");return v[b]=7,"abcdefghijklmnopqrst".split("").forEach(function(j){y[j]=j}),p({},v)[b]!==7||c(p({},y)).join("")!=="abcdefghijklmnopqrst"})?function(v,y){for(var b=f(v),j=arguments.length,T=1,O=u.f,R=h.f;j>T;)for(var D,B=m(arguments[T++]),q=O?x(c(B),O(B)):c(B),Y=q.length,G=0;Y>G;)D=q[G++],i&&!l(R,B,D)||(b[D]=B[D]);return b}:p},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(r,s,a){var i,o=r("../internals/an-object"),l=r("../internals/object-define-properties"),d=r("../internals/enum-bug-keys"),c=r("../internals/hidden-keys"),u=r("../internals/html"),h=r("../internals/document-create-element"),f=r("../internals/shared-key"),m=f("IE_PROTO"),p=function(){},g=function(y){return"<script>"+y+"<\/script>"},x=function(y){y.write(g("")),y.close();var b=y.parentWindow.Object;return y=null,b},v=function(){try{i=new ActiveXObject("htmlfile")}catch{}var y,b;v=typeof document<"u"?document.domain&&i?x(i):((b=h("iframe")).style.display="none",u.appendChild(b),b.src="javascript:",(y=b.contentWindow.document).open(),y.write(g("document.F=Object")),y.close(),y.F):x(i);for(var j=d.length;j--;)delete v.prototype[d[j]];return v()};c[m]=!0,s.exports=Object.create||function(y,b){var j;return y!==null?(p.prototype=o(y),j=new p,p.prototype=null,j[m]=y):j=v(),b===void 0?j:l.f(j,b)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/v8-prototype-define-bug"),l=r("../internals/object-define-property"),d=r("../internals/an-object"),c=r("../internals/to-indexed-object"),u=r("../internals/object-keys");a.f=i&&!o?Object.defineProperties:function(h,f){d(h);for(var m,p=c(f),g=u(f),x=g.length,v=0;x>v;)l.f(h,m=g[v++],p[m]);return h}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/ie8-dom-define"),l=r("../internals/v8-prototype-define-bug"),d=r("../internals/an-object"),c=r("../internals/to-property-key"),u=TypeError,h=Object.defineProperty,f=Object.getOwnPropertyDescriptor;a.f=i?l?function(m,p,g){if(d(m),p=c(p),d(g),typeof m=="function"&&p==="prototype"&&"value"in g&&"writable"in g&&!g.writable){var x=f(m,p);x&&x.writable&&(m[p]=g.value,g={configurable:"configurable"in g?g.configurable:x.configurable,enumerable:"enumerable"in g?g.enumerable:x.enumerable,writable:!1})}return h(m,p,g)}:h:function(m,p,g){if(d(m),p=c(p),d(g),o)try{return h(m,p,g)}catch{}if("get"in g||"set"in g)throw new u("Accessors not supported");return"value"in g&&(m[p]=g.value),m}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/function-call"),l=r("../internals/object-property-is-enumerable"),d=r("../internals/create-property-descriptor"),c=r("../internals/to-indexed-object"),u=r("../internals/to-property-key"),h=r("../internals/has-own-property"),f=r("../internals/ie8-dom-define"),m=Object.getOwnPropertyDescriptor;a.f=i?m:function(p,g){if(p=c(p),g=u(g),f)try{return m(p,g)}catch{}if(h(p,g))return d(!o(l.f,p,g),p[g])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(r,s,a){var i=r("../internals/classof-raw"),o=r("../internals/to-indexed-object"),l=r("../internals/object-get-own-property-names").f,d=r("../internals/array-slice-simple"),c=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];s.exports.f=function(u){return c&&i(u)==="Window"?function(h){try{return l(h)}catch{return d(c)}}(u):l(o(u))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(r,s,a){var i=r("../internals/object-keys-internal"),o=r("../internals/enum-bug-keys").concat("length","prototype");a.f=Object.getOwnPropertyNames||function(l){return i(l,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(r,s,a){a.f=Object.getOwnPropertySymbols},{}],313:[function(r,s,a){var i=r("../internals/has-own-property"),o=r("../internals/is-callable"),l=r("../internals/to-object"),d=r("../internals/shared-key"),c=r("../internals/correct-prototype-getter"),u=d("IE_PROTO"),h=Object,f=h.prototype;s.exports=c?h.getPrototypeOf:function(m){var p=l(m);if(i(p,u))return p[u];var g=p.constructor;return o(g)&&p instanceof g?g.prototype:p instanceof h?f:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(r,s,a){var i=r("../internals/function-uncurry-this");s.exports=i({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/has-own-property"),l=r("../internals/to-indexed-object"),d=r("../internals/array-includes").indexOf,c=r("../internals/hidden-keys"),u=i([].push);s.exports=function(h,f){var m,p=l(h),g=0,x=[];for(m in p)!o(c,m)&&o(p,m)&&u(x,m);for(;f.length>g;)o(p,m=f[g++])&&(~d(x,m)||u(x,m));return x}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(r,s,a){var i=r("../internals/object-keys-internal"),o=r("../internals/enum-bug-keys");s.exports=Object.keys||function(l){return i(l,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(r,s,a){var i={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,l=o&&!i.call({1:2},1);a.f=l?function(d){var c=o(this,d);return!!c&&c.enumerable}:i},{}],318:[function(r,s,a){var i=r("../internals/function-uncurry-this-accessor"),o=r("../internals/an-object"),l=r("../internals/a-possible-prototype");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var d,c=!1,u={};try{(d=i(Object.prototype,"__proto__","set"))(u,[]),c=u instanceof Array}catch{}return function(h,f){return o(h),l(f),c?d(h,f):h.__proto__=f,h}}():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/fails"),l=r("../internals/function-uncurry-this"),d=r("../internals/object-get-prototype-of"),c=r("../internals/object-keys"),u=r("../internals/to-indexed-object"),h=l(r("../internals/object-property-is-enumerable").f),f=l([].push),m=i&&o(function(){var g=Object.create(null);return g[2]=2,!h(g,2)}),p=function(g){return function(x){for(var v,y=u(x),b=c(y),j=m&&d(y)===null,T=b.length,O=0,R=[];T>O;)v=b[O++],i&&!(j?v in y:h(y,v))||f(R,g?[v,y[v]]:y[v]);return R}};s.exports={entries:p(!0),values:p(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(r,s,a){var i=r("../internals/function-call"),o=r("../internals/is-callable"),l=r("../internals/is-object"),d=TypeError;s.exports=function(c,u){var h,f;if(u==="string"&&o(h=c.toString)&&!l(f=i(h,c))||o(h=c.valueOf)&&!l(f=i(h,c))||u!=="string"&&o(h=c.toString)&&!l(f=i(h,c)))return f;throw new d("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(r,s,a){var i=r("../internals/get-built-in"),o=r("../internals/function-uncurry-this"),l=r("../internals/object-get-own-property-names"),d=r("../internals/object-get-own-property-symbols"),c=r("../internals/an-object"),u=o([].concat);s.exports=i("Reflect","ownKeys")||function(h){var f=l.f(c(h)),m=d.f;return m?u(f,m(h)):f}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(r,s,a){var i=r("../internals/global");s.exports=i},{"../internals/global":274}],323:[function(r,s,a){s.exports=function(i){try{return{error:!1,value:i()}}catch(o){return{error:!0,value:o}}}},{}],324:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/promise-native-constructor"),l=r("../internals/is-callable"),d=r("../internals/is-forced"),c=r("../internals/inspect-source"),u=r("../internals/well-known-symbol"),h=r("../internals/engine-is-browser"),f=r("../internals/engine-is-deno"),m=r("../internals/is-pure"),p=r("../internals/engine-v8-version"),g=o&&o.prototype,x=u("species"),v=!1,y=l(i.PromiseRejectionEvent),b=d("Promise",function(){var j=c(o),T=j!==String(o);if(!T&&p===66||m&&(!g.catch||!g.finally))return!0;if(!p||p<51||!/native code/.test(j)){var O=new o(function(D){D(1)}),R=function(D){D(function(){},function(){})};if((O.constructor={})[x]=R,!(v=O.then(function(){})instanceof R))return!0}return!T&&(h||f)&&!y});s.exports={CONSTRUCTOR:b,REJECTION_EVENT:y,SUBCLASSING:v}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(r,s,a){var i=r("../internals/global");s.exports=i.Promise},{"../internals/global":274}],326:[function(r,s,a){var i=r("../internals/an-object"),o=r("../internals/is-object"),l=r("../internals/new-promise-capability");s.exports=function(d,c){if(i(d),o(c)&&c.constructor===d)return c;var u=l.f(d);return(0,u.resolve)(c),u.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(r,s,a){var i=r("../internals/promise-native-constructor"),o=r("../internals/check-correctness-of-iteration"),l=r("../internals/promise-constructor-detection").CONSTRUCTOR;s.exports=l||!o(function(d){i.all(d).then(void 0,function(){})})},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(r,s,a){var i=function(){this.head=null,this.tail=null};i.prototype={add:function(o){var l={item:o,next:null},d=this.tail;d?d.next=l:this.head=l,this.tail=l},get:function(){var o=this.head;if(o)return(this.head=o.next)===null&&(this.tail=null),o.item}},s.exports=i},{}],329:[function(r,s,a){var i=r("../internals/is-null-or-undefined"),o=TypeError;s.exports=function(l){if(i(l))throw new o("Can't call method on "+l);return l}},{"../internals/is-null-or-undefined":288}],330:[function(r,s,a){var i=r("../internals/get-built-in"),o=r("../internals/define-built-in-accessor"),l=r("../internals/well-known-symbol"),d=r("../internals/descriptors"),c=l("species");s.exports=function(u){var h=i(u);d&&h&&!h[c]&&o(h,c,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(r,s,a){var i=r("../internals/object-define-property").f,o=r("../internals/has-own-property"),l=r("../internals/well-known-symbol")("toStringTag");s.exports=function(d,c,u){d&&!u&&(d=d.prototype),d&&!o(d,l)&&i(d,l,{configurable:!0,value:c})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(r,s,a){var i=r("../internals/shared"),o=r("../internals/uid"),l=i("keys");s.exports=function(d){return l[d]||(l[d]=o(d))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/define-global-property"),l=i["__core-js_shared__"]||o("__core-js_shared__",{});s.exports=l},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(r,s,a){var i=r("../internals/is-pure"),o=r("../internals/shared-store");(s.exports=function(l,d){return o[l]||(o[l]=d!==void 0?d:{})})("versions",[]).push({version:"3.33.0",mode:i?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(r,s,a){var i=r("../internals/an-object"),o=r("../internals/a-constructor"),l=r("../internals/is-null-or-undefined"),d=r("../internals/well-known-symbol")("species");s.exports=function(c,u){var h,f=i(c).constructor;return f===void 0||l(h=i(f)[d])?u:o(h)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(r,s,a){var i=r("../internals/engine-v8-version"),o=r("../internals/fails"),l=r("../internals/global").String;s.exports=!!Object.getOwnPropertySymbols&&!o(function(){var d=Symbol("symbol detection");return!l(d)||!(Object(d)instanceof Symbol)||!Symbol.sham&&i&&i<41})},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(r,s,a){var i=r("../internals/function-call"),o=r("../internals/get-built-in"),l=r("../internals/well-known-symbol"),d=r("../internals/define-built-in");s.exports=function(){var c=o("Symbol"),u=c&&c.prototype,h=u&&u.valueOf,f=l("toPrimitive");u&&!u[f]&&d(u,f,function(m){return i(h,this)},{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(r,s,a){var i=r("../internals/symbol-constructor-detection");s.exports=i&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(r,s,a){var i,o,l,d,c=r("../internals/global"),u=r("../internals/function-apply"),h=r("../internals/function-bind-context"),f=r("../internals/is-callable"),m=r("../internals/has-own-property"),p=r("../internals/fails"),g=r("../internals/html"),x=r("../internals/array-slice"),v=r("../internals/document-create-element"),y=r("../internals/validate-arguments-length"),b=r("../internals/engine-is-ios"),j=r("../internals/engine-is-node"),T=c.setImmediate,O=c.clearImmediate,R=c.process,D=c.Dispatch,B=c.Function,q=c.MessageChannel,Y=c.String,G=0,I={};p(function(){i=c.location});var F=function(C){if(m(I,C)){var k=I[C];delete I[C],k()}},S=function(C){return function(){F(C)}},E=function(C){F(C.data)},N=function(C){c.postMessage(Y(C),i.protocol+"//"+i.host)};T&&O||(T=function(C){y(arguments.length,1);var k=f(C)?C:B(C),M=x(arguments,1);return I[++G]=function(){u(k,void 0,M)},o(G),G},O=function(C){delete I[C]},j?o=function(C){R.nextTick(S(C))}:D&&D.now?o=function(C){D.now(S(C))}:q&&!b?(d=(l=new q).port2,l.port1.onmessage=E,o=h(d.postMessage,d)):c.addEventListener&&f(c.postMessage)&&!c.importScripts&&i&&i.protocol!=="file:"&&!p(N)?(o=N,c.addEventListener("message",E,!1)):o="onreadystatechange"in v("script")?function(C){g.appendChild(v("script")).onreadystatechange=function(){g.removeChild(this),F(C)}}:function(C){setTimeout(S(C),0)}),s.exports={set:T,clear:O}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(r,s,a){var i=r("../internals/to-integer-or-infinity"),o=Math.max,l=Math.min;s.exports=function(d,c){var u=i(d);return u<0?o(u+c,0):l(u,c)}},{"../internals/to-integer-or-infinity":342}],341:[function(r,s,a){var i=r("../internals/indexed-object"),o=r("../internals/require-object-coercible");s.exports=function(l){return i(o(l))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(r,s,a){var i=r("../internals/math-trunc");s.exports=function(o){var l=+o;return l!=l||l===0?0:i(l)}},{"../internals/math-trunc":301}],343:[function(r,s,a){var i=r("../internals/to-integer-or-infinity"),o=Math.min;s.exports=function(l){return l>0?o(i(l),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(r,s,a){var i=r("../internals/require-object-coercible"),o=Object;s.exports=function(l){return o(i(l))}},{"../internals/require-object-coercible":329}],345:[function(r,s,a){var i=r("../internals/function-call"),o=r("../internals/is-object"),l=r("../internals/is-symbol"),d=r("../internals/get-method"),c=r("../internals/ordinary-to-primitive"),u=r("../internals/well-known-symbol"),h=TypeError,f=u("toPrimitive");s.exports=function(m,p){if(!o(m)||l(m))return m;var g,x=d(m,f);if(x){if(p===void 0&&(p="default"),g=i(x,m,p),!o(g)||l(g))return g;throw new h("Can't convert object to primitive value")}return p===void 0&&(p="number"),c(m,p)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(r,s,a){var i=r("../internals/to-primitive"),o=r("../internals/is-symbol");s.exports=function(l){var d=i(l,"string");return o(d)?d:d+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(r,s,a){var i={};i[r("../internals/well-known-symbol")("toStringTag")]="z",s.exports=String(i)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(r,s,a){var i=r("../internals/classof"),o=String;s.exports=function(l){if(i(l)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return o(l)}},{"../internals/classof":236}],349:[function(r,s,a){var i=String;s.exports=function(o){try{return i(o)}catch{return"Object"}}},{}],350:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=0,l=Math.random(),d=i(1 .toString);s.exports=function(c){return"Symbol("+(c===void 0?"":c)+")_"+d(++o+l,36)}},{"../internals/function-uncurry-this":268}],351:[function(r,s,a){var i=r("../internals/symbol-constructor-detection");s.exports=i&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/fails");s.exports=i&&o(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(r,s,a){var i=TypeError;s.exports=function(o,l){if(o<l)throw new i("Not enough arguments");return o}},{}],354:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/is-callable"),l=i.WeakMap;s.exports=o(l)&&/native code/.test(String(l))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(r,s,a){var i=r("../internals/path"),o=r("../internals/has-own-property"),l=r("../internals/well-known-symbol-wrapped"),d=r("../internals/object-define-property").f;s.exports=function(c){var u=i.Symbol||(i.Symbol={});o(u,c)||d(u,c,{value:l.f(c)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(r,s,a){var i=r("../internals/well-known-symbol");a.f=i},{"../internals/well-known-symbol":357}],357:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/shared"),l=r("../internals/has-own-property"),d=r("../internals/uid"),c=r("../internals/symbol-constructor-detection"),u=r("../internals/use-symbol-as-uid"),h=i.Symbol,f=o("wks"),m=u?h.for||h:h&&h.withoutSetter||d;s.exports=function(p){return l(f,p)||(f[p]=c&&l(h,p)?h[p]:m("Symbol."+p)),f[p]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/array-iteration").findIndex,l=r("../internals/add-to-unscopables"),d=!0;"findIndex"in[]&&Array(1).findIndex(function(){d=!1}),i({target:"Array",proto:!0,forced:d},{findIndex:function(c){return o(this,c,arguments.length>1?arguments[1]:void 0)}}),l("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/array-iteration").find,l=r("../internals/add-to-unscopables"),d=!0;"find"in[]&&Array(1).find(function(){d=!1}),i({target:"Array",proto:!0,forced:d},{find:function(c){return o(this,c,arguments.length>1?arguments[1]:void 0)}}),l("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/array-includes").includes,l=r("../internals/fails"),d=r("../internals/add-to-unscopables");i({target:"Array",proto:!0,forced:l(function(){return!Array(1).includes()})},{includes:function(c){return o(this,c,arguments.length>1?arguments[1]:void 0)}}),d("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(r,s,a){var i=r("../internals/to-indexed-object"),o=r("../internals/add-to-unscopables"),l=r("../internals/iterators"),d=r("../internals/internal-state"),c=r("../internals/object-define-property").f,u=r("../internals/iterator-define"),h=r("../internals/create-iter-result-object"),f=r("../internals/is-pure"),m=r("../internals/descriptors"),p=d.set,g=d.getterFor("Array Iterator");s.exports=u(Array,"Array",function(v,y){p(this,{type:"Array Iterator",target:i(v),index:0,kind:y})},function(){var v=g(this),y=v.target,b=v.kind,j=v.index++;if(!y||j>=y.length)return v.target=void 0,h(void 0,!0);switch(b){case"keys":return h(j,!1);case"values":return h(y[j],!1)}return h([j,y[j]],!1)},"values");var x=l.Arguments=l.Array;if(o("keys"),o("values"),o("entries"),!f&&m&&x.name!=="values")try{c(x,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/get-built-in"),l=r("../internals/function-apply"),d=r("../internals/function-call"),c=r("../internals/function-uncurry-this"),u=r("../internals/fails"),h=r("../internals/is-callable"),f=r("../internals/is-symbol"),m=r("../internals/array-slice"),p=r("../internals/get-json-replacer-function"),g=r("../internals/symbol-constructor-detection"),x=String,v=o("JSON","stringify"),y=c(/./.exec),b=c("".charAt),j=c("".charCodeAt),T=c("".replace),O=c(1 .toString),R=/[\uD800-\uDFFF]/g,D=/^[\uD800-\uDBFF]$/,B=/^[\uDC00-\uDFFF]$/,q=!g||u(function(){var F=o("Symbol")("stringify detection");return v([F])!=="[null]"||v({a:F})!=="{}"||v(Object(F))!=="{}"}),Y=u(function(){return v("\uDF06\uD834")!=='"\\udf06\\ud834"'||v("\uDEAD")!=='"\\udead"'}),G=function(F,S){var E=m(arguments),N=p(S);if(h(N)||F!==void 0&&!f(F))return E[1]=function(C,k){if(h(N)&&(k=d(N,this,x(C),k)),!f(k))return k},l(v,null,E)},I=function(F,S,E){var N=b(E,S-1),C=b(E,S+1);return y(D,F)&&!y(B,C)||y(B,F)&&!y(D,N)?"\\u"+O(j(F,0),16):F};v&&i({target:"JSON",stat:!0,arity:3,forced:q||Y},{stringify:function(F,S,E){var N=m(arguments),C=l(q?G:v,null,N);return Y&&typeof C=="string"?T(C,R,I):C}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(r,s,a){r("../internals/export")({target:"Number",stat:!0},{isNaN:function(i){return i!=i}})},{"../internals/export":259}],364:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/object-assign");i({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/symbol-constructor-detection"),l=r("../internals/fails"),d=r("../internals/object-get-own-property-symbols"),c=r("../internals/to-object");i({target:"Object",stat:!0,forced:!o||l(function(){d.f(1)})},{getOwnPropertySymbols:function(u){var h=d.f;return h?h(c(u)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/to-object"),l=r("../internals/object-keys");i({target:"Object",stat:!0,forced:r("../internals/fails")(function(){l(1)})},{keys:function(d){return l(o(d))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/object-to-array").values;i({target:"Object",stat:!0},{values:function(l){return o(l)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-call"),l=r("../internals/a-callable"),d=r("../internals/new-promise-capability"),c=r("../internals/perform"),u=r("../internals/iterate");i({target:"Promise",stat:!0,forced:r("../internals/promise-statics-incorrect-iteration")},{all:function(h){var f=this,m=d.f(f),p=m.resolve,g=m.reject,x=c(function(){var v=l(f.resolve),y=[],b=0,j=1;u(h,function(T){var O=b++,R=!1;j++,o(v,f,T).then(function(D){R||(R=!0,y[O]=D,--j||p(y))},g)}),--j||p(y)});return x.error&&g(x.value),m.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/is-pure"),l=r("../internals/promise-constructor-detection").CONSTRUCTOR,d=r("../internals/promise-native-constructor"),c=r("../internals/get-built-in"),u=r("../internals/is-callable"),h=r("../internals/define-built-in"),f=d&&d.prototype;if(i({target:"Promise",proto:!0,forced:l,real:!0},{catch:function(p){return this.then(void 0,p)}}),!o&&u(d)){var m=c("Promise").prototype.catch;f.catch!==m&&h(f,"catch",m,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(r,s,a){var i,o,l,d=r("../internals/export"),c=r("../internals/is-pure"),u=r("../internals/engine-is-node"),h=r("../internals/global"),f=r("../internals/function-call"),m=r("../internals/define-built-in"),p=r("../internals/object-set-prototype-of"),g=r("../internals/set-to-string-tag"),x=r("../internals/set-species"),v=r("../internals/a-callable"),y=r("../internals/is-callable"),b=r("../internals/is-object"),j=r("../internals/an-instance"),T=r("../internals/species-constructor"),O=r("../internals/task").set,R=r("../internals/microtask"),D=r("../internals/host-report-errors"),B=r("../internals/perform"),q=r("../internals/queue"),Y=r("../internals/internal-state"),G=r("../internals/promise-native-constructor"),I=r("../internals/promise-constructor-detection"),F=r("../internals/new-promise-capability"),S=I.CONSTRUCTOR,E=I.REJECTION_EVENT,N=I.SUBCLASSING,C=Y.getterFor("Promise"),k=Y.set,M=G&&G.prototype,U=G,$=M,X=h.TypeError,Z=h.document,re=h.process,W=F.f,J=W,V=!!(Z&&Z.createEvent&&h.dispatchEvent),H=function(ge){var _e;return!(!b(ge)||!y(_e=ge.then))&&_e},ee=function(ge,_e){var be,ye,Oe,Ne=_e.value,De=_e.state===1,Ge=De?ge.ok:ge.fail,Qe=ge.resolve,Ie=ge.reject,Ae=ge.domain;try{Ge?(De||(_e.rejection===2&&pe(_e),_e.rejection=1),Ge===!0?be=Ne:(Ae&&Ae.enter(),be=Ge(Ne),Ae&&(Ae.exit(),Oe=!0)),be===ge.promise?Ie(new X("Promise-chain cycle")):(ye=H(be))?f(ye,be,Qe,Ie):Qe(be)):Ie(Ne)}catch(st){Ae&&!Oe&&Ae.exit(),Ie(st)}},ie=function(ge,_e){ge.notified||(ge.notified=!0,R(function(){for(var be,ye=ge.reactions;be=ye.get();)ee(be,ge);ge.notified=!1,_e&&!ge.rejection&&se(ge)}))},oe=function(ge,_e,be){var ye,Oe;V?((ye=Z.createEvent("Event")).promise=_e,ye.reason=be,ye.initEvent(ge,!1,!0),h.dispatchEvent(ye)):ye={promise:_e,reason:be},!E&&(Oe=h["on"+ge])?Oe(ye):ge==="unhandledrejection"&&D("Unhandled promise rejection",be)},se=function(ge){f(O,h,function(){var _e,be=ge.facade,ye=ge.value;if(ue(ge)&&(_e=B(function(){u?re.emit("unhandledRejection",ye,be):oe("unhandledrejection",be,ye)}),ge.rejection=u||ue(ge)?2:1,_e.error))throw _e.value})},ue=function(ge){return ge.rejection!==1&&!ge.parent},pe=function(ge){f(O,h,function(){var _e=ge.facade;u?re.emit("rejectionHandled",_e):oe("rejectionhandled",_e,ge.value)})},ce=function(ge,_e,be){return function(ye){ge(_e,ye,be)}},ne=function(ge,_e,be){ge.done||(ge.done=!0,be&&(ge=be),ge.value=_e,ge.state=2,ie(ge,!0))},me=function(ge,_e,be){if(!ge.done){ge.done=!0,be&&(ge=be);try{if(ge.facade===_e)throw new X("Promise can't be resolved itself");var ye=H(_e);ye?R(function(){var Oe={done:!1};try{f(ye,_e,ce(me,Oe,ge),ce(ne,Oe,ge))}catch(Ne){ne(Oe,Ne,ge)}}):(ge.value=_e,ge.state=1,ie(ge,!1))}catch(Oe){ne({done:!1},Oe,ge)}}};if(S&&($=(U=function(ge){j(this,$),v(ge),f(i,this);var _e=C(this);try{ge(ce(me,_e),ce(ne,_e))}catch(be){ne(_e,be)}}).prototype,(i=function(ge){k(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new q,rejection:!1,state:0,value:void 0})}).prototype=m($,"then",function(ge,_e){var be=C(this),ye=W(T(this,U));return be.parent=!0,ye.ok=!y(ge)||ge,ye.fail=y(_e)&&_e,ye.domain=u?re.domain:void 0,be.state===0?be.reactions.add(ye):R(function(){ee(ye,be)}),ye.promise}),o=function(){var ge=new i,_e=C(ge);this.promise=ge,this.resolve=ce(me,_e),this.reject=ce(ne,_e)},F.f=W=function(ge){return ge===U||ge===void 0?new o(ge):J(ge)},!c&&y(G)&&M!==Object.prototype)){l=M.then,N||m(M,"then",function(ge,_e){var be=this;return new U(function(ye,Oe){f(l,be,ye,Oe)}).then(ge,_e)},{unsafe:!0});try{delete M.constructor}catch{}p&&p(M,$)}d({global:!0,constructor:!0,wrap:!0,forced:S},{Promise:U}),g(U,"Promise",!1,!0),x("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/is-pure"),l=r("../internals/promise-native-constructor"),d=r("../internals/fails"),c=r("../internals/get-built-in"),u=r("../internals/is-callable"),h=r("../internals/species-constructor"),f=r("../internals/promise-resolve"),m=r("../internals/define-built-in"),p=l&&l.prototype;if(i({target:"Promise",proto:!0,real:!0,forced:!!l&&d(function(){p.finally.call({then:function(){}},function(){})})},{finally:function(x){var v=h(this,c("Promise")),y=u(x);return this.then(y?function(b){return f(v,x()).then(function(){return b})}:x,y?function(b){return f(v,x()).then(function(){throw b})}:x)}}),!o&&u(l)){var g=c("Promise").prototype.finally;p.finally!==g&&m(p,"finally",g,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(r,s,a){r("../modules/es.promise.constructor"),r("../modules/es.promise.all"),r("../modules/es.promise.catch"),r("../modules/es.promise.race"),r("../modules/es.promise.reject"),r("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-call"),l=r("../internals/a-callable"),d=r("../internals/new-promise-capability"),c=r("../internals/perform"),u=r("../internals/iterate");i({target:"Promise",stat:!0,forced:r("../internals/promise-statics-incorrect-iteration")},{race:function(h){var f=this,m=d.f(f),p=m.reject,g=c(function(){var x=l(f.resolve);u(h,function(v){o(x,f,v).then(m.resolve,p)})});return g.error&&p(g.value),m.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-call"),l=r("../internals/new-promise-capability");i({target:"Promise",stat:!0,forced:r("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(d){var c=l.f(this);return o(c.reject,void 0,d),c.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/get-built-in"),l=r("../internals/is-pure"),d=r("../internals/promise-native-constructor"),c=r("../internals/promise-constructor-detection").CONSTRUCTOR,u=r("../internals/promise-resolve"),h=o("Promise"),f=l&&!c;i({target:"Promise",stat:!0,forced:l||c},{resolve:function(m){return u(f&&this===h?d:this,m)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-uncurry-this"),l=r("../internals/to-absolute-index"),d=RangeError,c=String.fromCharCode,u=String.fromCodePoint,h=o([].join);i({target:"String",stat:!0,arity:1,forced:!!u&&u.length!==1},{fromCodePoint:function(f){for(var m,p=[],g=arguments.length,x=0;g>x;){if(m=+arguments[x++],l(m,1114111)!==m)throw new d(m+" is not a valid code point");p[x]=m<65536?c(m):c(55296+((m-=65536)>>10),m%1024+56320)}return h(p,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-uncurry-this"),l=r("../internals/not-a-regexp"),d=r("../internals/require-object-coercible"),c=r("../internals/to-string"),u=r("../internals/correct-is-regexp-logic"),h=o("".indexOf);i({target:"String",proto:!0,forced:!u("includes")},{includes:function(f){return!!~h(c(d(this)),c(l(f)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(r,s,a){r("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/global"),l=r("../internals/function-call"),d=r("../internals/function-uncurry-this"),c=r("../internals/is-pure"),u=r("../internals/descriptors"),h=r("../internals/symbol-constructor-detection"),f=r("../internals/fails"),m=r("../internals/has-own-property"),p=r("../internals/object-is-prototype-of"),g=r("../internals/an-object"),x=r("../internals/to-indexed-object"),v=r("../internals/to-property-key"),y=r("../internals/to-string"),b=r("../internals/create-property-descriptor"),j=r("../internals/object-create"),T=r("../internals/object-keys"),O=r("../internals/object-get-own-property-names"),R=r("../internals/object-get-own-property-names-external"),D=r("../internals/object-get-own-property-symbols"),B=r("../internals/object-get-own-property-descriptor"),q=r("../internals/object-define-property"),Y=r("../internals/object-define-properties"),G=r("../internals/object-property-is-enumerable"),I=r("../internals/define-built-in"),F=r("../internals/define-built-in-accessor"),S=r("../internals/shared"),E=r("../internals/shared-key"),N=r("../internals/hidden-keys"),C=r("../internals/uid"),k=r("../internals/well-known-symbol"),M=r("../internals/well-known-symbol-wrapped"),U=r("../internals/well-known-symbol-define"),$=r("../internals/symbol-define-to-primitive"),X=r("../internals/set-to-string-tag"),Z=r("../internals/internal-state"),re=r("../internals/array-iteration").forEach,W=E("hidden"),J=Z.set,V=Z.getterFor("Symbol"),H=Object.prototype,ee=o.Symbol,ie=ee&&ee.prototype,oe=o.RangeError,se=o.TypeError,ue=o.QObject,pe=B.f,ce=q.f,ne=R.f,me=G.f,ge=d([].push),_e=S("symbols"),be=S("op-symbols"),ye=S("wks"),Oe=!ue||!ue.prototype||!ue.prototype.findChild,Ne=function(Je,Ue,Le){var Ze=pe(H,Ue);Ze&&delete H[Ue],ce(Je,Ue,Le),Ze&&Je!==H&&ce(H,Ue,Ze)},De=u&&f(function(){return j(ce({},"a",{get:function(){return ce(this,"a",{value:7}).a}})).a!==7})?Ne:ce,Ge=function(Je,Ue){var Le=_e[Je]=j(ie);return J(Le,{type:"Symbol",tag:Je,description:Ue}),u||(Le.description=Ue),Le},Qe=function(Je,Ue,Le){Je===H&&Qe(be,Ue,Le),g(Je);var Ze=v(Ue);return g(Le),m(_e,Ze)?(Le.enumerable?(m(Je,W)&&Je[W][Ze]&&(Je[W][Ze]=!1),Le=j(Le,{enumerable:b(0,!1)})):(m(Je,W)||ce(Je,W,b(1,{})),Je[W][Ze]=!0),De(Je,Ze,Le)):ce(Je,Ze,Le)},Ie=function(Je,Ue){g(Je);var Le=x(Ue),Ze=T(Le).concat(vt(Le));return re(Ze,function(ct){u&&!l(Ae,Le,ct)||Qe(Je,ct,Le[ct])}),Je},Ae=function(Je){var Ue=v(Je),Le=l(me,this,Ue);return!(this===H&&m(_e,Ue)&&!m(be,Ue))&&(!(Le||!m(this,Ue)||!m(_e,Ue)||m(this,W)&&this[W][Ue])||Le)},st=function(Je,Ue){var Le=x(Je),Ze=v(Ue);if(Le!==H||!m(_e,Ze)||m(be,Ze)){var ct=pe(Le,Ze);return!ct||!m(_e,Ze)||m(Le,W)&&Le[W][Ze]||(ct.enumerable=!0),ct}},nt=function(Je){var Ue=ne(x(Je)),Le=[];return re(Ue,function(Ze){m(_e,Ze)||m(N,Ze)||ge(Le,Ze)}),Le},vt=function(Je){var Ue=Je===H,Le=ne(Ue?be:x(Je)),Ze=[];return re(Le,function(ct){!m(_e,ct)||Ue&&!m(H,ct)||ge(Ze,_e[ct])}),Ze};h||(I(ie=(ee=function(){if(p(ie,this))throw new se("Symbol is not a constructor");var Je=arguments.length&&arguments[0]!==void 0?y(arguments[0]):void 0,Ue=C(Je),Le=function(Ze){this===H&&l(Le,be,Ze),m(this,W)&&m(this[W],Ue)&&(this[W][Ue]=!1);var ct=b(1,Ze);try{De(this,Ue,ct)}catch(ht){if(!(ht instanceof oe))throw ht;Ne(this,Ue,ct)}};return u&&Oe&&De(H,Ue,{configurable:!0,set:Le}),Ge(Ue,Je)}).prototype,"toString",function(){return V(this).tag}),I(ee,"withoutSetter",function(Je){return Ge(C(Je),Je)}),G.f=Ae,q.f=Qe,Y.f=Ie,B.f=st,O.f=R.f=nt,D.f=vt,M.f=function(Je){return Ge(k(Je),Je)},u&&(F(ie,"description",{configurable:!0,get:function(){return V(this).description}}),c||I(H,"propertyIsEnumerable",Ae,{unsafe:!0}))),i({global:!0,constructor:!0,wrap:!0,forced:!h,sham:!h},{Symbol:ee}),re(T(ye),function(Je){U(Je)}),i({target:"Symbol",stat:!0,forced:!h},{useSetter:function(){Oe=!0},useSimple:function(){Oe=!1}}),i({target:"Object",stat:!0,forced:!h,sham:!u},{create:function(Je,Ue){return Ue===void 0?j(Je):Ie(j(Je),Ue)},defineProperty:Qe,defineProperties:Ie,getOwnPropertyDescriptor:st}),i({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:nt}),$(),X(ee,"Symbol"),N[W]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/get-built-in"),l=r("../internals/has-own-property"),d=r("../internals/to-string"),c=r("../internals/shared"),u=r("../internals/symbol-registry-detection"),h=c("string-to-symbol-registry"),f=c("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!u},{for:function(m){var p=d(m);if(l(h,p))return h[p];var g=o("Symbol")(p);return h[p]=g,f[g]=p,g}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(r,s,a){r("../modules/es.symbol.constructor"),r("../modules/es.symbol.for"),r("../modules/es.symbol.key-for"),r("../modules/es.json.stringify"),r("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/has-own-property"),l=r("../internals/is-symbol"),d=r("../internals/try-to-string"),c=r("../internals/shared"),u=r("../internals/symbol-registry-detection"),h=c("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!u},{keyFor:function(f){if(!l(f))throw new TypeError(d(f)+" is not a symbol");if(o(h,f))return h[f]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(r,s,a){function i(o){return Object.prototype.toString.call(o)}a.isArray=function(o){return Array.isArray?Array.isArray(o):i(o)==="[object Array]"},a.isBoolean=function(o){return typeof o=="boolean"},a.isNull=function(o){return o===null},a.isNullOrUndefined=function(o){return o==null},a.isNumber=function(o){return typeof o=="number"},a.isString=function(o){return typeof o=="string"},a.isSymbol=function(o){return typeof o=="symbol"},a.isUndefined=function(o){return o===void 0},a.isRegExp=function(o){return i(o)==="[object RegExp]"},a.isObject=function(o){return typeof o=="object"&&o!==null},a.isDate=function(o){return i(o)==="[object Date]"},a.isError=function(o){return i(o)==="[object Error]"||o instanceof Error},a.isFunction=function(o){return typeof o=="function"},a.isPrimitive=function(o){return o===null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||typeof o=="symbol"||o===void 0},a.isBuffer=r("buffer").Buffer.isBuffer},{buffer:220}],384:[function(r,s,a){(function(i){(function(){var o=r("elliptic"),l=r("bn.js");s.exports=function(h){return new c(h)};var d={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function c(h){this.curveType=d[h],this.curveType||(this.curveType={name:h}),this.curve=new o.ec(this.curveType.name),this.keys=void 0}function u(h,f,m){Array.isArray(h)||(h=h.toArray());var p=new i(h);if(m&&p.length<m){var g=new i(m-p.length);g.fill(0),p=i.concat([g,p])}return f?p.toString(f):p}d.p224=d.secp224r1,d.p256=d.secp256r1=d.prime256v1,d.p192=d.secp192r1=d.prime192v1,d.p384=d.secp384r1,d.p521=d.secp521r1,c.prototype.generateKeys=function(h,f){return this.keys=this.curve.genKeyPair(),this.getPublicKey(h,f)},c.prototype.computeSecret=function(h,f,m){return f=f||"utf8",i.isBuffer(h)||(h=new i(h,f)),u(this.curve.keyFromPublic(h).getPublic().mul(this.keys.getPrivate()).getX(),m,this.curveType.byteLength)},c.prototype.getPublicKey=function(h,f){var m=this.keys.getPublic(f==="compressed",!0);return f==="hybrid"&&(m[m.length-1]%2?m[0]=7:m[0]=6),u(m,h)},c.prototype.getPrivateKey=function(h){return u(this.keys.getPrivate(),h)},c.prototype.setPublicKey=function(h,f){return f=f||"utf8",i.isBuffer(h)||(h=new i(h,f)),this.keys._importPublic(h),this},c.prototype.setPrivateKey=function(h,f){f=f||"utf8",i.isBuffer(h)||(h=new i(h,f));var m=new l(h);return m=m.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(m),this}}).call(this)}).call(this,r("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(r,s,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],386:[function(r,s,a){var i=r("inherits"),o=r("md5.js"),l=r("ripemd160"),d=r("sha.js"),c=r("cipher-base");function u(h){c.call(this,"digest"),this._hash=h}i(u,c),u.prototype._update=function(h){this._hash.update(h)},u.prototype._final=function(){return this._hash.digest()},s.exports=function(h){return(h=h.toLowerCase())==="md5"?new o:h==="rmd160"||h==="ripemd160"?new l:new u(d(h))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(r,s,a){var i=r("md5.js");s.exports=function(o){return new i().update(o).digest()}},{"md5.js":450}],388:[function(r,s,a){var i=r("inherits"),o=r("./legacy"),l=r("cipher-base"),d=r("safe-buffer").Buffer,c=r("create-hash/md5"),u=r("ripemd160"),h=r("sha.js"),f=d.alloc(128);function m(p,g){l.call(this,"digest"),typeof g=="string"&&(g=d.from(g));var x=p==="sha512"||p==="sha384"?128:64;this._alg=p,this._key=g,g.length>x?g=(p==="rmd160"?new u:h(p)).update(g).digest():g.length<x&&(g=d.concat([g,f],x));for(var v=this._ipad=d.allocUnsafe(x),y=this._opad=d.allocUnsafe(x),b=0;b<x;b++)v[b]=54^g[b],y[b]=92^g[b];this._hash=p==="rmd160"?new u:h(p),this._hash.update(v)}i(m,l),m.prototype._update=function(p){this._hash.update(p)},m.prototype._final=function(){var p=this._hash.digest();return(this._alg==="rmd160"?new u:h(this._alg)).update(this._opad).update(p).digest()},s.exports=function(p,g){return(p=p.toLowerCase())==="rmd160"||p==="ripemd160"?new m("rmd160",g):p==="md5"?new o(c,g):new m(p,g)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(r,s,a){var i=r("inherits"),o=r("safe-buffer").Buffer,l=r("cipher-base"),d=o.alloc(128);function c(u,h){l.call(this,"digest"),typeof h=="string"&&(h=o.from(h)),this._alg=u,this._key=h,h.length>64?h=u(h):h.length<64&&(h=o.concat([h,d],64));for(var f=this._ipad=o.allocUnsafe(64),m=this._opad=o.allocUnsafe(64),p=0;p<64;p++)f[p]=54^h[p],m[p]=92^h[p];this._hash=[f]}i(c,l),c.prototype._update=function(u){this._hash.push(u)},c.prototype._final=function(){var u=this._alg(o.concat(this._hash));return this._alg(o.concat([this._opad,u]))},s.exports=c},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(r,s,a){a.randomBytes=a.rng=a.pseudoRandomBytes=a.prng=r("randombytes"),a.createHash=a.Hash=r("create-hash"),a.createHmac=a.Hmac=r("create-hmac");var i=r("browserify-sign/algos"),o=Object.keys(i),l=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(o);a.getHashes=function(){return l};var d=r("pbkdf2");a.pbkdf2=d.pbkdf2,a.pbkdf2Sync=d.pbkdf2Sync;var c=r("browserify-cipher");a.Cipher=c.Cipher,a.createCipher=c.createCipher,a.Cipheriv=c.Cipheriv,a.createCipheriv=c.createCipheriv,a.Decipher=c.Decipher,a.createDecipher=c.createDecipher,a.Decipheriv=c.Decipheriv,a.createDecipheriv=c.createDecipheriv,a.getCiphers=c.getCiphers,a.listCiphers=c.listCiphers;var u=r("diffie-hellman");a.DiffieHellmanGroup=u.DiffieHellmanGroup,a.createDiffieHellmanGroup=u.createDiffieHellmanGroup,a.getDiffieHellman=u.getDiffieHellman,a.createDiffieHellman=u.createDiffieHellman,a.DiffieHellman=u.DiffieHellman;var h=r("browserify-sign");a.createSign=h.createSign,a.Sign=h.Sign,a.createVerify=h.createVerify,a.Verify=h.Verify,a.createECDH=r("create-ecdh");var f=r("public-encrypt");a.publicEncrypt=f.publicEncrypt,a.privateEncrypt=f.privateEncrypt,a.publicDecrypt=f.publicDecrypt,a.privateDecrypt=f.privateDecrypt;var m=r("randomfill");a.randomFill=m.randomFill,a.randomFillSync=m.randomFillSync,a.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},a.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(r,s,a){(function(i,o){typeof a=="object"&&s!==void 0?s.exports=o():(i=typeof globalThis<"u"?globalThis:i||self).dayjs=o()})(void 0,function(){var i=6e4,o=36e5,l="millisecond",d="second",c="minute",u="hour",h="day",f="week",m="month",p="quarter",g="year",x="date",v="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,j={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(E){var N=["th","st","nd","rd"],C=E%100;return"["+E+(N[(C-20)%10]||N[C]||N[0])+"]"}},T=function(E,N,C){var k=String(E);return!k||k.length>=N?E:""+Array(N+1-k.length).join(C)+E},O={s:T,z:function(E){var N=-E.utcOffset(),C=Math.abs(N),k=Math.floor(C/60),M=C%60;return(N<=0?"+":"-")+T(k,2,"0")+":"+T(M,2,"0")},m:function E(N,C){if(N.date()<C.date())return-E(C,N);var k=12*(C.year()-N.year())+(C.month()-N.month()),M=N.clone().add(k,m),U=C-M<0,$=N.clone().add(k+(U?-1:1),m);return+(-(k+(C-M)/(U?M-$:$-M))||0)},a:function(E){return E<0?Math.ceil(E)||0:Math.floor(E)},p:function(E){return{M:m,y:g,w:f,d:h,D:x,h:u,m:c,s:d,ms:l,Q:p}[E]||String(E||"").toLowerCase().replace(/s$/,"")},u:function(E){return E===void 0}},R="en",D={};D[R]=j;var B="$isDayjsObject",q=function(E){return E instanceof F||!(!E||!E[B])},Y=function E(N,C,k){var M;if(!N)return R;if(typeof N=="string"){var U=N.toLowerCase();D[U]&&(M=U),C&&(D[U]=C,M=U);var $=N.split("-");if(!M&&$.length>1)return E($[0])}else{var X=N.name;D[X]=N,M=X}return!k&&M&&(R=M),M||!k&&R},G=function(E,N){if(q(E))return E.clone();var C=typeof N=="object"?N:{};return C.date=E,C.args=arguments,new F(C)},I=O;I.l=Y,I.i=q,I.w=function(E,N){return G(E,{locale:N.$L,utc:N.$u,x:N.$x,$offset:N.$offset})};var F=function(){function E(C){this.$L=Y(C.locale,null,!0),this.parse(C),this.$x=this.$x||C.x||{},this[B]=!0}var N=E.prototype;return N.parse=function(C){this.$d=function(k){var M=k.date,U=k.utc;if(M===null)return new Date(NaN);if(I.u(M))return new Date;if(M instanceof Date)return new Date(M);if(typeof M=="string"&&!/Z$/i.test(M)){var $=M.match(y);if($){var X=$[2]-1||0,Z=($[7]||"0").substring(0,3);return U?new Date(Date.UTC($[1],X,$[3]||1,$[4]||0,$[5]||0,$[6]||0,Z)):new Date($[1],X,$[3]||1,$[4]||0,$[5]||0,$[6]||0,Z)}}return new Date(M)}(C),this.init()},N.init=function(){var C=this.$d;this.$y=C.getFullYear(),this.$M=C.getMonth(),this.$D=C.getDate(),this.$W=C.getDay(),this.$H=C.getHours(),this.$m=C.getMinutes(),this.$s=C.getSeconds(),this.$ms=C.getMilliseconds()},N.$utils=function(){return I},N.isValid=function(){return this.$d.toString()!==v},N.isSame=function(C,k){var M=G(C);return this.startOf(k)<=M&&M<=this.endOf(k)},N.isAfter=function(C,k){return G(C)<this.startOf(k)},N.isBefore=function(C,k){return this.endOf(k)<G(C)},N.$g=function(C,k,M){return I.u(C)?this[k]:this.set(M,C)},N.unix=function(){return Math.floor(this.valueOf()/1e3)},N.valueOf=function(){return this.$d.getTime()},N.startOf=function(C,k){var M=this,U=!!I.u(k)||k,$=I.p(C),X=function(ie,oe){var se=I.w(M.$u?Date.UTC(M.$y,oe,ie):new Date(M.$y,oe,ie),M);return U?se:se.endOf(h)},Z=function(ie,oe){return I.w(M.toDate()[ie].apply(M.toDate("s"),(U?[0,0,0,0]:[23,59,59,999]).slice(oe)),M)},re=this.$W,W=this.$M,J=this.$D,V="set"+(this.$u?"UTC":"");switch($){case g:return U?X(1,0):X(31,11);case m:return U?X(1,W):X(0,W+1);case f:var H=this.$locale().weekStart||0,ee=(re<H?re+7:re)-H;return X(U?J-ee:J+(6-ee),W);case h:case x:return Z(V+"Hours",0);case u:return Z(V+"Minutes",1);case c:return Z(V+"Seconds",2);case d:return Z(V+"Milliseconds",3);default:return this.clone()}},N.endOf=function(C){return this.startOf(C,!1)},N.$set=function(C,k){var M,U=I.p(C),$="set"+(this.$u?"UTC":""),X=(M={},M[h]=$+"Date",M[x]=$+"Date",M[m]=$+"Month",M[g]=$+"FullYear",M[u]=$+"Hours",M[c]=$+"Minutes",M[d]=$+"Seconds",M[l]=$+"Milliseconds",M)[U],Z=U===h?this.$D+(k-this.$W):k;if(U===m||U===g){var re=this.clone().set(x,1);re.$d[X](Z),re.init(),this.$d=re.set(x,Math.min(this.$D,re.daysInMonth())).$d}else X&&this.$d[X](Z);return this.init(),this},N.set=function(C,k){return this.clone().$set(C,k)},N.get=function(C){return this[I.p(C)]()},N.add=function(C,k){var M,U=this;C=Number(C);var $=I.p(k),X=function(W){var J=G(U);return I.w(J.date(J.date()+Math.round(W*C)),U)};if($===m)return this.set(m,this.$M+C);if($===g)return this.set(g,this.$y+C);if($===h)return X(1);if($===f)return X(7);var Z=(M={},M[c]=i,M[u]=o,M[d]=1e3,M)[$]||1,re=this.$d.getTime()+C*Z;return I.w(re,this)},N.subtract=function(C,k){return this.add(-1*C,k)},N.format=function(C){var k=this,M=this.$locale();if(!this.isValid())return M.invalidDate||v;var U=C||"YYYY-MM-DDTHH:mm:ssZ",$=I.z(this),X=this.$H,Z=this.$m,re=this.$M,W=M.weekdays,J=M.months,V=M.meridiem,H=function(oe,se,ue,pe){return oe&&(oe[se]||oe(k,U))||ue[se].slice(0,pe)},ee=function(oe){return I.s(X%12||12,oe,"0")},ie=V||function(oe,se,ue){var pe=oe<12?"AM":"PM";return ue?pe.toLowerCase():pe};return U.replace(b,function(oe,se){return se||function(ue){switch(ue){case"YY":return String(k.$y).slice(-2);case"YYYY":return I.s(k.$y,4,"0");case"M":return re+1;case"MM":return I.s(re+1,2,"0");case"MMM":return H(M.monthsShort,re,J,3);case"MMMM":return H(J,re);case"D":return k.$D;case"DD":return I.s(k.$D,2,"0");case"d":return String(k.$W);case"dd":return H(M.weekdaysMin,k.$W,W,2);case"ddd":return H(M.weekdaysShort,k.$W,W,3);case"dddd":return W[k.$W];case"H":return String(X);case"HH":return I.s(X,2,"0");case"h":return ee(1);case"hh":return ee(2);case"a":return ie(X,Z,!0);case"A":return ie(X,Z,!1);case"m":return String(Z);case"mm":return I.s(Z,2,"0");case"s":return String(k.$s);case"ss":return I.s(k.$s,2,"0");case"SSS":return I.s(k.$ms,3,"0");case"Z":return $}return null}(oe)||$.replace(":","")})},N.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},N.diff=function(C,k,M){var U,$=this,X=I.p(k),Z=G(C),re=(Z.utcOffset()-this.utcOffset())*i,W=this-Z,J=function(){return I.m($,Z)};switch(X){case g:U=J()/12;break;case m:U=J();break;case p:U=J()/3;break;case f:U=(W-re)/6048e5;break;case h:U=(W-re)/864e5;break;case u:U=W/o;break;case c:U=W/i;break;case d:U=W/1e3;break;default:U=W}return M?U:I.a(U)},N.daysInMonth=function(){return this.endOf(m).$D},N.$locale=function(){return D[this.$L]},N.locale=function(C,k){if(!C)return this.$L;var M=this.clone(),U=Y(C,k,!0);return U&&(M.$L=U),M},N.clone=function(){return I.w(this.$d,this)},N.toDate=function(){return new Date(this.valueOf())},N.toJSON=function(){return this.isValid()?this.toISOString():null},N.toISOString=function(){return this.$d.toISOString()},N.toString=function(){return this.$d.toUTCString()},E}(),S=F.prototype;return G.prototype=S,[["$ms",l],["$s",d],["$m",c],["$H",u],["$W",h],["$M",m],["$y",g],["$D",x]].forEach(function(E){S[E[1]]=function(N){return this.$g(N,E[0],E[1])}}),G.extend=function(E,N){return E.$i||(E(N,F,G),E.$i=!0),G},G.locale=Y,G.isDayjs=q,G.unix=function(E){return G(1e3*E)},G.en=D[R],G.Ls=D,G.p={},G})},{}],392:[function(r,s,a){(function(i,o){typeof a=="object"&&s!==void 0?s.exports=o():(i=typeof globalThis<"u"?globalThis:i||self).dayjs_plugin_customParseFormat=o()})(void 0,function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},o=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,l=/\d\d/,d=/\d\d?/,c=/\d*[^-_:/,()\s\d]+/,u={},h=function(y){return(y=+y)+(y>68?1900:2e3)},f=function(y){return function(b){this[y]=+b}},m=[/[+-]\d\d:?(\d\d)?|Z/,function(y){(this.zone||(this.zone={})).offset=function(b){if(!b||b==="Z")return 0;var j=b.match(/([+-]|\d\d)/g),T=60*j[1]+(+j[2]||0);return T===0?0:j[0]==="+"?-T:T}(y)}],p=function(y){var b=u[y];return b&&(b.indexOf?b:b.s.concat(b.f))},g=function(y,b){var j,T=u.meridiem;if(T){for(var O=1;O<=24;O+=1)if(y.indexOf(T(O,0,b))>-1){j=O>12;break}}else j=y===(b?"pm":"PM");return j},x={A:[c,function(y){this.afternoon=g(y,!1)}],a:[c,function(y){this.afternoon=g(y,!0)}],S:[/\d/,function(y){this.milliseconds=100*+y}],SS:[l,function(y){this.milliseconds=10*+y}],SSS:[/\d{3}/,function(y){this.milliseconds=+y}],s:[d,f("seconds")],ss:[d,f("seconds")],m:[d,f("minutes")],mm:[d,f("minutes")],H:[d,f("hours")],h:[d,f("hours")],HH:[d,f("hours")],hh:[d,f("hours")],D:[d,f("day")],DD:[l,f("day")],Do:[c,function(y){var b=u.ordinal,j=y.match(/\d+/);if(this.day=j[0],b)for(var T=1;T<=31;T+=1)b(T).replace(/\[|\]/g,"")===y&&(this.day=T)}],M:[d,f("month")],MM:[l,f("month")],MMM:[c,function(y){var b=p("months"),j=(p("monthsShort")||b.map(function(T){return T.slice(0,3)})).indexOf(y)+1;if(j<1)throw new Error;this.month=j%12||j}],MMMM:[c,function(y){var b=p("months").indexOf(y)+1;if(b<1)throw new Error;this.month=b%12||b}],Y:[/[+-]?\d+/,f("year")],YY:[l,function(y){this.year=h(y)}],YYYY:[/\d{4}/,f("year")],Z:m,ZZ:m};function v(y){var b,j;b=y,j=u&&u.formats;for(var T=(y=b.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(G,I,F){var S=F&&F.toUpperCase();return I||j[F]||i[F]||j[S].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(E,N,C){return N||C.slice(1)})})).match(o),O=T.length,R=0;R<O;R+=1){var D=T[R],B=x[D],q=B&&B[0],Y=B&&B[1];T[R]=Y?{regex:q,parser:Y}:D.replace(/^\[|\]$/g,"")}return function(G){for(var I={},F=0,S=0;F<O;F+=1){var E=T[F];if(typeof E=="string")S+=E.length;else{var N=E.regex,C=E.parser,k=G.slice(S),M=N.exec(k)[0];C.call(I,M),G=G.replace(M,"")}}return function(U){var $=U.afternoon;if($!==void 0){var X=U.hours;$?X<12&&(U.hours+=12):X===12&&(U.hours=0),delete U.afternoon}}(I),I}}return function(y,b,j){j.p.customParseFormat=!0,y&&y.parseTwoDigitYear&&(h=y.parseTwoDigitYear);var T=b.prototype,O=T.parse;T.parse=function(R){var D=R.date,B=R.utc,q=R.args;this.$u=B;var Y=q[1];if(typeof Y=="string"){var G=q[2]===!0,I=q[3]===!0,F=G||I,S=q[2];I&&(S=q[2]),u=this.$locale(),!G&&S&&(u=j.Ls[S]),this.$d=function(k,M,U){try{if(["x","X"].indexOf(M)>-1)return new Date((M==="X"?1e3:1)*k);var $=v(M)(k),X=$.year,Z=$.month,re=$.day,W=$.hours,J=$.minutes,V=$.seconds,H=$.milliseconds,ee=$.zone,ie=new Date,oe=re||(X||Z?1:ie.getDate()),se=X||ie.getFullYear(),ue=0;X&&!Z||(ue=Z>0?Z-1:ie.getMonth());var pe=W||0,ce=J||0,ne=V||0,me=H||0;return ee?new Date(Date.UTC(se,ue,oe,pe,ce,ne,me+60*ee.offset*1e3)):U?new Date(Date.UTC(se,ue,oe,pe,ce,ne,me)):new Date(se,ue,oe,pe,ce,ne,me)}catch{return new Date("")}}(D,Y,B),this.init(),S&&S!==!0&&(this.$L=this.locale(S).$L),F&&D!=this.format(Y)&&(this.$d=new Date("")),u={}}else if(Y instanceof Array)for(var E=Y.length,N=1;N<=E;N+=1){q[1]=Y[N-1];var C=j.apply(this,q);if(C.isValid()){this.$d=C.$d,this.$L=C.$L,this.init();break}N===E&&(this.$d=new Date(""))}else O.call(this,R)}}})},{}],393:[function(r,s,a){(function(i,o){typeof a=="object"&&s!==void 0?s.exports=o():(i=typeof globalThis<"u"?globalThis:i||self).dayjs_plugin_utc=o()})(void 0,function(){var i="minute",o=/[+-]\d\d(?::?\d\d)?/g,l=/([+-]|\d\d)/g;return function(d,c,u){var h=c.prototype;u.utc=function(y){var b={date:y,utc:!0,args:arguments};return new c(b)},h.utc=function(y){var b=u(this.toDate(),{locale:this.$L,utc:!0});return y?b.add(this.utcOffset(),i):b},h.local=function(){return u(this.toDate(),{locale:this.$L,utc:!1})};var f=h.parse;h.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),f.call(this,y)};var m=h.init;h.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else m.call(this)};var p=h.utcOffset;h.utcOffset=function(y,b){var j=this.$utils().u;if(j(y))return this.$u?0:j(this.$offset)?p.call(this):this.$offset;if(typeof y=="string"&&(y=function(D){D===void 0&&(D="");var B=D.match(o);if(!B)return null;var q=(""+B[0]).match(l)||["-",0,0],Y=q[0],G=60*+q[1]+ +q[2];return G===0?0:Y==="+"?G:-G}(y))===null)return this;var T=Math.abs(y)<=16?60*y:y,O=this;if(b)return O.$offset=T,O.$u=y===0,O;if(y!==0){var R=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(O=this.local().add(T+R,i)).$offset=T,O.$x.$localOffset=R}else O=this.utc();return O};var g=h.format;h.format=function(y){var b=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return g.call(this,b)},h.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},h.isUTC=function(){return!!this.$u},h.toISOString=function(){return this.toDate().toISOString()},h.toString=function(){return this.toDate().toUTCString()};var x=h.toDate;h.toDate=function(y){return y==="s"&&this.$offset?u(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():x.call(this)};var v=h.diff;h.diff=function(y,b,j){if(y&&this.$u===y.$u)return v.call(this,y,b,j);var T=this.local(),O=u(y).local();return v.call(T,O,b,j)}}})},{}],394:[function(r,s,a){a.utils=r("./des/utils"),a.Cipher=r("./des/cipher"),a.DES=r("./des/des"),a.CBC=r("./des/cbc"),a.EDE=r("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(r,s,a){var i=r("minimalistic-assert"),o=r("inherits"),l={};function d(c){i.equal(c.length,8,"Invalid IV length"),this.iv=new Array(8);for(var u=0;u<this.iv.length;u++)this.iv[u]=c[u]}a.instantiate=function(c){function u(p){c.call(this,p),this._cbcInit()}o(u,c);for(var h=Object.keys(l),f=0;f<h.length;f++){var m=h[f];u.prototype[m]=l[m]}return u.create=function(p){return new u(p)},u},l._cbcInit=function(){var c=new d(this.options.iv);this._cbcState=c},l._update=function(c,u,h,f){var m=this._cbcState,p=this.constructor.super_.prototype,g=m.iv;if(this.type==="encrypt"){for(var x=0;x<this.blockSize;x++)g[x]^=c[u+x];for(p._update.call(this,g,0,h,f),x=0;x<this.blockSize;x++)g[x]=h[f+x]}else{for(p._update.call(this,c,u,h,f),x=0;x<this.blockSize;x++)h[f+x]^=g[x];for(x=0;x<this.blockSize;x++)g[x]=c[u+x]}}},{inherits:440,"minimalistic-assert":453}],396:[function(r,s,a){var i=r("minimalistic-assert");function o(l){this.options=l,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=l.padding!==!1}s.exports=o,o.prototype._init=function(){},o.prototype.update=function(l){return l.length===0?[]:this.type==="decrypt"?this._updateDecrypt(l):this._updateEncrypt(l)},o.prototype._buffer=function(l,d){for(var c=Math.min(this.buffer.length-this.bufferOff,l.length-d),u=0;u<c;u++)this.buffer[this.bufferOff+u]=l[d+u];return this.bufferOff+=c,c},o.prototype._flushBuffer=function(l,d){return this._update(this.buffer,0,l,d),this.bufferOff=0,this.blockSize},o.prototype._updateEncrypt=function(l){var d=0,c=0,u=(this.bufferOff+l.length)/this.blockSize|0,h=new Array(u*this.blockSize);this.bufferOff!==0&&(d+=this._buffer(l,d),this.bufferOff===this.buffer.length&&(c+=this._flushBuffer(h,c)));for(var f=l.length-(l.length-d)%this.blockSize;d<f;d+=this.blockSize)this._update(l,d,h,c),c+=this.blockSize;for(;d<l.length;d++,this.bufferOff++)this.buffer[this.bufferOff]=l[d];return h},o.prototype._updateDecrypt=function(l){for(var d=0,c=0,u=Math.ceil((this.bufferOff+l.length)/this.blockSize)-1,h=new Array(u*this.blockSize);u>0;u--)d+=this._buffer(l,d),c+=this._flushBuffer(h,c);return d+=this._buffer(l,d),h},o.prototype.final=function(l){var d,c;return l&&(d=this.update(l)),c=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),d?d.concat(c):c},o.prototype._pad=function(l,d){if(d===0)return!1;for(;d<l.length;)l[d++]=0;return!0},o.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var l=new Array(this.blockSize);return this._update(this.buffer,0,l,0),l},o.prototype._unpad=function(l){return l},o.prototype._finalDecrypt=function(){i.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var l=new Array(this.blockSize);return this._flushBuffer(l,0),this._unpad(l)}},{"minimalistic-assert":453}],397:[function(r,s,a){var i=r("minimalistic-assert"),o=r("inherits"),l=r("./utils"),d=r("./cipher");function c(){this.tmp=new Array(2),this.keys=null}function u(f){d.call(this,f);var m=new c;this._desState=m,this.deriveKeys(m,f.key)}o(u,d),s.exports=u,u.create=function(f){return new u(f)};var h=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];u.prototype.deriveKeys=function(f,m){f.keys=new Array(32),i.equal(m.length,this.blockSize,"Invalid key length");var p=l.readUInt32BE(m,0),g=l.readUInt32BE(m,4);l.pc1(p,g,f.tmp,0),p=f.tmp[0],g=f.tmp[1];for(var x=0;x<f.keys.length;x+=2){var v=h[x>>>1];p=l.r28shl(p,v),g=l.r28shl(g,v),l.pc2(p,g,f.keys,x)}},u.prototype._update=function(f,m,p,g){var x=this._desState,v=l.readUInt32BE(f,m),y=l.readUInt32BE(f,m+4);l.ip(v,y,x.tmp,0),v=x.tmp[0],y=x.tmp[1],this.type==="encrypt"?this._encrypt(x,v,y,x.tmp,0):this._decrypt(x,v,y,x.tmp,0),v=x.tmp[0],y=x.tmp[1],l.writeUInt32BE(p,v,g),l.writeUInt32BE(p,y,g+4)},u.prototype._pad=function(f,m){if(this.padding===!1)return!1;for(var p=f.length-m,g=m;g<f.length;g++)f[g]=p;return!0},u.prototype._unpad=function(f){if(this.padding===!1)return f;for(var m=f[f.length-1],p=f.length-m;p<f.length;p++)i.equal(f[p],m);return f.slice(0,f.length-m)},u.prototype._encrypt=function(f,m,p,g,x){for(var v=m,y=p,b=0;b<f.keys.length;b+=2){var j=f.keys[b],T=f.keys[b+1];l.expand(y,f.tmp,0),j^=f.tmp[0],T^=f.tmp[1];var O=l.substitute(j,T),R=y;y=(v^l.permute(O))>>>0,v=R}l.rip(y,v,g,x)},u.prototype._decrypt=function(f,m,p,g,x){for(var v=p,y=m,b=f.keys.length-2;b>=0;b-=2){var j=f.keys[b],T=f.keys[b+1];l.expand(v,f.tmp,0),j^=f.tmp[0],T^=f.tmp[1];var O=l.substitute(j,T),R=v;v=(y^l.permute(O))>>>0,y=R}l.rip(v,y,g,x)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(r,s,a){var i=r("minimalistic-assert"),o=r("inherits"),l=r("./cipher"),d=r("./des");function c(h,f){i.equal(f.length,24,"Invalid key length");var m=f.slice(0,8),p=f.slice(8,16),g=f.slice(16,24);this.ciphers=h==="encrypt"?[d.create({type:"encrypt",key:m}),d.create({type:"decrypt",key:p}),d.create({type:"encrypt",key:g})]:[d.create({type:"decrypt",key:g}),d.create({type:"encrypt",key:p}),d.create({type:"decrypt",key:m})]}function u(h){l.call(this,h);var f=new c(this.type,this.options.key);this._edeState=f}o(u,l),s.exports=u,u.create=function(h){return new u(h)},u.prototype._update=function(h,f,m,p){var g=this._edeState;g.ciphers[0]._update(h,f,m,p),g.ciphers[1]._update(m,p,m,p),g.ciphers[2]._update(m,p,m,p)},u.prototype._pad=d.prototype._pad,u.prototype._unpad=d.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(r,s,a){a.readUInt32BE=function(d,c){return(d[0+c]<<24|d[1+c]<<16|d[2+c]<<8|d[3+c])>>>0},a.writeUInt32BE=function(d,c,u){d[0+u]=c>>>24,d[1+u]=c>>>16&255,d[2+u]=c>>>8&255,d[3+u]=255&c},a.ip=function(d,c,u,h){for(var f=0,m=0,p=6;p>=0;p-=2){for(var g=0;g<=24;g+=8)f<<=1,f|=c>>>g+p&1;for(g=0;g<=24;g+=8)f<<=1,f|=d>>>g+p&1}for(p=6;p>=0;p-=2){for(g=1;g<=25;g+=8)m<<=1,m|=c>>>g+p&1;for(g=1;g<=25;g+=8)m<<=1,m|=d>>>g+p&1}u[h+0]=f>>>0,u[h+1]=m>>>0},a.rip=function(d,c,u,h){for(var f=0,m=0,p=0;p<4;p++)for(var g=24;g>=0;g-=8)f<<=1,f|=c>>>g+p&1,f<<=1,f|=d>>>g+p&1;for(p=4;p<8;p++)for(g=24;g>=0;g-=8)m<<=1,m|=c>>>g+p&1,m<<=1,m|=d>>>g+p&1;u[h+0]=f>>>0,u[h+1]=m>>>0},a.pc1=function(d,c,u,h){for(var f=0,m=0,p=7;p>=5;p--){for(var g=0;g<=24;g+=8)f<<=1,f|=c>>g+p&1;for(g=0;g<=24;g+=8)f<<=1,f|=d>>g+p&1}for(g=0;g<=24;g+=8)f<<=1,f|=c>>g+p&1;for(p=1;p<=3;p++){for(g=0;g<=24;g+=8)m<<=1,m|=c>>g+p&1;for(g=0;g<=24;g+=8)m<<=1,m|=d>>g+p&1}for(g=0;g<=24;g+=8)m<<=1,m|=d>>g+p&1;u[h+0]=f>>>0,u[h+1]=m>>>0},a.r28shl=function(d,c){return d<<c&268435455|d>>>28-c};var i=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];a.pc2=function(d,c,u,h){for(var f=0,m=0,p=i.length>>>1,g=0;g<p;g++)f<<=1,f|=d>>>i[g]&1;for(g=p;g<i.length;g++)m<<=1,m|=c>>>i[g]&1;u[h+0]=f>>>0,u[h+1]=m>>>0},a.expand=function(d,c,u){var h=0,f=0;h=(1&d)<<5|d>>>27;for(var m=23;m>=15;m-=4)h<<=6,h|=d>>>m&63;for(m=11;m>=3;m-=4)f|=d>>>m&63,f<<=6;f|=(31&d)<<1|d>>>31,c[u+0]=h>>>0,c[u+1]=f>>>0};var o=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];a.substitute=function(d,c){for(var u=0,h=0;h<4;h++)u<<=4,u|=o[64*h+(d>>>18-6*h&63)];for(h=0;h<4;h++)u<<=4,u|=o[256+64*h+(c>>>18-6*h&63)];return u>>>0};var l=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];a.permute=function(d){for(var c=0,u=0;u<l.length;u++)c<<=1,c|=d>>>l[u]&1;return c>>>0},a.padSplit=function(d,c,u){for(var h=d.toString(2);h.length<c;)h="0"+h;for(var f=[],m=0;m<c;m+=u)f.push(h.slice(m,m+u));return f.join(" ")}},{}],400:[function(r,s,a){(function(i){(function(){var o=r("./lib/generatePrime"),l=r("./lib/primes.json"),d=r("./lib/dh"),c={binary:!0,hex:!0,base64:!0};a.DiffieHellmanGroup=a.createDiffieHellmanGroup=a.getDiffieHellman=function(u){var h=new i(l[u].prime,"hex"),f=new i(l[u].gen,"hex");return new d(h,f)},a.createDiffieHellman=a.DiffieHellman=function u(h,f,m,p){return i.isBuffer(f)||c[f]===void 0?u(h,"binary",f,m):(f=f||"binary",p=p||"binary",m=m||new i([2]),i.isBuffer(m)||(m=new i(m,p)),typeof h=="number"?new d(o(h,m),m,!0):(i.isBuffer(h)||(h=new i(h,f)),new d(h,m,!0)))}}).call(this)}).call(this,r("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(r,s,a){(function(i){(function(){var o=r("bn.js"),l=new(r("miller-rabin")),d=new o(24),c=new o(11),u=new o(10),h=new o(3),f=new o(7),m=r("./generatePrime"),p=r("randombytes");function g(j,T){return T=T||"utf8",i.isBuffer(j)||(j=new i(j,T)),this._pub=new o(j),this}function x(j,T){return T=T||"utf8",i.isBuffer(j)||(j=new i(j,T)),this._priv=new o(j),this}s.exports=y;var v={};function y(j,T,O){this.setGenerator(T),this.__prime=new o(j),this._prime=o.mont(this.__prime),this._primeLen=j.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,O?(this.setPublicKey=g,this.setPrivateKey=x):this._primeCode=8}function b(j,T){var O=new i(j.toArray());return T?O.toString(T):O}Object.defineProperty(y.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=function(j,T){var O=T.toString("hex"),R=[O,j.toString(16)].join("_");if(R in v)return v[R];var D,B=0;if(j.isEven()||!m.simpleSieve||!m.fermatTest(j)||!l.test(j))return B+=1,B+=O==="02"||O==="05"?8:4,v[R]=B,B;switch(l.test(j.shrn(1))||(B+=2),O){case"02":j.mod(d).cmp(c)&&(B+=8);break;case"05":(D=j.mod(u)).cmp(h)&&D.cmp(f)&&(B+=8);break;default:B+=4}return v[R]=B,B}(this.__prime,this.__gen)),this._primeCode}}),y.prototype.generateKeys=function(){return this._priv||(this._priv=new o(p(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},y.prototype.computeSecret=function(j){var T=(j=(j=new o(j)).toRed(this._prime)).redPow(this._priv).fromRed(),O=new i(T.toArray()),R=this.getPrime();if(O.length<R.length){var D=new i(R.length-O.length);D.fill(0),O=i.concat([D,O])}return O},y.prototype.getPublicKey=function(j){return b(this._pub,j)},y.prototype.getPrivateKey=function(j){return b(this._priv,j)},y.prototype.getPrime=function(j){return b(this.__prime,j)},y.prototype.getGenerator=function(j){return b(this._gen,j)},y.prototype.setGenerator=function(j,T){return T=T||"utf8",i.isBuffer(j)||(j=new i(j,T)),this.__gen=j,this._gen=new o(j),this}}).call(this)}).call(this,r("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(r,s,a){var i=r("randombytes");s.exports=j,j.simpleSieve=y,j.fermatTest=b;var o=r("bn.js"),l=new o(24),d=new(r("miller-rabin")),c=new o(1),u=new o(2),h=new o(5),f=(new o(16),new o(8),new o(10)),m=new o(3),p=(new o(7),new o(11)),g=new o(4),x=(new o(12),null);function v(){if(x!==null)return x;var T=[];T[0]=2;for(var O=1,R=3;R<1048576;R+=2){for(var D=Math.ceil(Math.sqrt(R)),B=0;B<O&&T[B]<=D&&R%T[B]!=0;B++);O!==B&&T[B]<=D||(T[O++]=R)}return x=T,T}function y(T){for(var O=v(),R=0;R<O.length;R++)if(T.modn(O[R])===0)return T.cmpn(O[R])===0;return!0}function b(T){var O=o.mont(T);return u.toRed(O).redPow(T.subn(1)).fromRed().cmpn(1)===0}function j(T,O){if(T<16)return new o(O===2||O===5?[140,123]:[140,39]);var R,D;for(O=new o(O);;){for(R=new o(i(Math.ceil(T/8)));R.bitLength()>T;)R.ishrn(1);if(R.isEven()&&R.iadd(c),R.testn(1)||R.iadd(u),O.cmp(u)){if(!O.cmp(h))for(;R.mod(f).cmp(m);)R.iadd(g)}else for(;R.mod(l).cmp(p);)R.iadd(g);if(y(D=R.shrn(1))&&y(R)&&b(D)&&b(R)&&d.test(D)&&d.test(R))return R}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(r,s,a){s.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(r,s,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],405:[function(r,s,a){var i=a;i.version=r("../package.json").version,i.utils=r("./elliptic/utils"),i.rand=r("brorand"),i.curve=r("./elliptic/curve"),i.curves=r("./elliptic/curves"),i.ec=r("./elliptic/ec"),i.eddsa=r("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(r,s,a){var i=r("bn.js"),o=r("../utils"),l=o.getNAF,d=o.getJSF,c=o.assert;function u(f,m){this.type=f,this.p=new i(m.p,16),this.red=m.prime?i.red(m.prime):i.mont(this.p),this.zero=new i(0).toRed(this.red),this.one=new i(1).toRed(this.red),this.two=new i(2).toRed(this.red),this.n=m.n&&new i(m.n,16),this.g=m.g&&this.pointFromJSON(m.g,m.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var p=this.n&&this.p.div(this.n);!p||p.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function h(f,m){this.curve=f,this.type=m,this.precomputed=null}s.exports=u,u.prototype.point=function(){throw new Error("Not implemented")},u.prototype.validate=function(){throw new Error("Not implemented")},u.prototype._fixedNafMul=function(f,m){c(f.precomputed);var p=f._getDoubles(),g=l(m,1,this._bitLength),x=(1<<p.step+1)-(p.step%2==0?2:1);x/=3;var v,y,b=[];for(v=0;v<g.length;v+=p.step){y=0;for(var j=v+p.step-1;j>=v;j--)y=(y<<1)+g[j];b.push(y)}for(var T=this.jpoint(null,null,null),O=this.jpoint(null,null,null),R=x;R>0;R--){for(v=0;v<b.length;v++)(y=b[v])===R?O=O.mixedAdd(p.points[v]):y===-R&&(O=O.mixedAdd(p.points[v].neg()));T=T.add(O)}return T.toP()},u.prototype._wnafMul=function(f,m){var p=4,g=f._getNAFPoints(p);p=g.wnd;for(var x=g.points,v=l(m,p,this._bitLength),y=this.jpoint(null,null,null),b=v.length-1;b>=0;b--){for(var j=0;b>=0&&v[b]===0;b--)j++;if(b>=0&&j++,y=y.dblp(j),b<0)break;var T=v[b];c(T!==0),y=f.type==="affine"?T>0?y.mixedAdd(x[T-1>>1]):y.mixedAdd(x[-T-1>>1].neg()):T>0?y.add(x[T-1>>1]):y.add(x[-T-1>>1].neg())}return f.type==="affine"?y.toP():y},u.prototype._wnafMulAdd=function(f,m,p,g,x){var v,y,b,j=this._wnafT1,T=this._wnafT2,O=this._wnafT3,R=0;for(v=0;v<g;v++){var D=(b=m[v])._getNAFPoints(f);j[v]=D.wnd,T[v]=D.points}for(v=g-1;v>=1;v-=2){var B=v-1,q=v;if(j[B]===1&&j[q]===1){var Y=[m[B],null,null,m[q]];m[B].y.cmp(m[q].y)===0?(Y[1]=m[B].add(m[q]),Y[2]=m[B].toJ().mixedAdd(m[q].neg())):m[B].y.cmp(m[q].y.redNeg())===0?(Y[1]=m[B].toJ().mixedAdd(m[q]),Y[2]=m[B].add(m[q].neg())):(Y[1]=m[B].toJ().mixedAdd(m[q]),Y[2]=m[B].toJ().mixedAdd(m[q].neg()));var G=[-3,-1,-5,-7,0,7,5,1,3],I=d(p[B],p[q]);for(R=Math.max(I[0].length,R),O[B]=new Array(R),O[q]=new Array(R),y=0;y<R;y++){var F=0|I[0][y],S=0|I[1][y];O[B][y]=G[3*(F+1)+(S+1)],O[q][y]=0,T[B]=Y}}else O[B]=l(p[B],j[B],this._bitLength),O[q]=l(p[q],j[q],this._bitLength),R=Math.max(O[B].length,R),R=Math.max(O[q].length,R)}var E=this.jpoint(null,null,null),N=this._wnafT4;for(v=R;v>=0;v--){for(var C=0;v>=0;){var k=!0;for(y=0;y<g;y++)N[y]=0|O[y][v],N[y]!==0&&(k=!1);if(!k)break;C++,v--}if(v>=0&&C++,E=E.dblp(C),v<0)break;for(y=0;y<g;y++){var M=N[y];M!==0&&(M>0?b=T[y][M-1>>1]:M<0&&(b=T[y][-M-1>>1].neg()),E=b.type==="affine"?E.mixedAdd(b):E.add(b))}}for(v=0;v<g;v++)T[v]=null;return x?E:E.toP()},u.BasePoint=h,h.prototype.eq=function(){throw new Error("Not implemented")},h.prototype.validate=function(){return this.curve.validate(this)},u.prototype.decodePoint=function(f,m){f=o.toArray(f,m);var p=this.p.byteLength();if((f[0]===4||f[0]===6||f[0]===7)&&f.length-1==2*p)return f[0]===6?c(f[f.length-1]%2==0):f[0]===7&&c(f[f.length-1]%2==1),this.point(f.slice(1,1+p),f.slice(1+p,1+2*p));if((f[0]===2||f[0]===3)&&f.length-1===p)return this.pointFromX(f.slice(1,1+p),f[0]===3);throw new Error("Unknown point format")},h.prototype.encodeCompressed=function(f){return this.encode(f,!0)},h.prototype._encode=function(f){var m=this.curve.p.byteLength(),p=this.getX().toArray("be",m);return f?[this.getY().isEven()?2:3].concat(p):[4].concat(p,this.getY().toArray("be",m))},h.prototype.encode=function(f,m){return o.encode(this._encode(m),f)},h.prototype.precompute=function(f){if(this.precomputed)return this;var m={doubles:null,naf:null,beta:null};return m.naf=this._getNAFPoints(8),m.doubles=this._getDoubles(4,f),m.beta=this._getBeta(),this.precomputed=m,this},h.prototype._hasDoubles=function(f){if(!this.precomputed)return!1;var m=this.precomputed.doubles;return!!m&&m.points.length>=Math.ceil((f.bitLength()+1)/m.step)},h.prototype._getDoubles=function(f,m){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var p=[this],g=this,x=0;x<m;x+=f){for(var v=0;v<f;v++)g=g.dbl();p.push(g)}return{step:f,points:p}},h.prototype._getNAFPoints=function(f){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var m=[this],p=(1<<f)-1,g=p===1?null:this.dbl(),x=1;x<p;x++)m[x]=m[x-1].add(g);return{wnd:f,points:m}},h.prototype._getBeta=function(){return null},h.prototype.dblp=function(f){for(var m=this,p=0;p<f;p++)m=m.dbl();return m}},{"../utils":419,"bn.js":420}],407:[function(r,s,a){var i=r("../utils"),o=r("bn.js"),l=r("inherits"),d=r("./base"),c=i.assert;function u(f){this.twisted=(0|f.a)!=1,this.mOneA=this.twisted&&(0|f.a)==-1,this.extended=this.mOneA,d.call(this,"edwards",f),this.a=new o(f.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new o(f.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new o(f.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),c(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|f.c)==1}function h(f,m,p,g,x){d.BasePoint.call(this,f,"projective"),m===null&&p===null&&g===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new o(m,16),this.y=new o(p,16),this.z=g?new o(g,16):this.curve.one,this.t=x&&new o(x,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}l(u,d),s.exports=u,u.prototype._mulA=function(f){return this.mOneA?f.redNeg():this.a.redMul(f)},u.prototype._mulC=function(f){return this.oneC?f:this.c.redMul(f)},u.prototype.jpoint=function(f,m,p,g){return this.point(f,m,p,g)},u.prototype.pointFromX=function(f,m){(f=new o(f,16)).red||(f=f.toRed(this.red));var p=f.redSqr(),g=this.c2.redSub(this.a.redMul(p)),x=this.one.redSub(this.c2.redMul(this.d).redMul(p)),v=g.redMul(x.redInvm()),y=v.redSqrt();if(y.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");var b=y.fromRed().isOdd();return(m&&!b||!m&&b)&&(y=y.redNeg()),this.point(f,y)},u.prototype.pointFromY=function(f,m){(f=new o(f,16)).red||(f=f.toRed(this.red));var p=f.redSqr(),g=p.redSub(this.c2),x=p.redMul(this.d).redMul(this.c2).redSub(this.a),v=g.redMul(x.redInvm());if(v.cmp(this.zero)===0){if(m)throw new Error("invalid point");return this.point(this.zero,f)}var y=v.redSqrt();if(y.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");return y.fromRed().isOdd()!==m&&(y=y.redNeg()),this.point(y,f)},u.prototype.validate=function(f){if(f.isInfinity())return!0;f.normalize();var m=f.x.redSqr(),p=f.y.redSqr(),g=m.redMul(this.a).redAdd(p),x=this.c2.redMul(this.one.redAdd(this.d.redMul(m).redMul(p)));return g.cmp(x)===0},l(h,d.BasePoint),u.prototype.pointFromJSON=function(f){return h.fromJSON(this,f)},u.prototype.point=function(f,m,p,g){return new h(this,f,m,p,g)},h.fromJSON=function(f,m){return new h(f,m[0],m[1],m[2])},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},h.prototype._extDbl=function(){var f=this.x.redSqr(),m=this.y.redSqr(),p=this.z.redSqr();p=p.redIAdd(p);var g=this.curve._mulA(f),x=this.x.redAdd(this.y).redSqr().redISub(f).redISub(m),v=g.redAdd(m),y=v.redSub(p),b=g.redSub(m),j=x.redMul(y),T=v.redMul(b),O=x.redMul(b),R=y.redMul(v);return this.curve.point(j,T,R,O)},h.prototype._projDbl=function(){var f,m,p,g,x,v,y=this.x.redAdd(this.y).redSqr(),b=this.x.redSqr(),j=this.y.redSqr();if(this.curve.twisted){var T=(g=this.curve._mulA(b)).redAdd(j);this.zOne?(f=y.redSub(b).redSub(j).redMul(T.redSub(this.curve.two)),m=T.redMul(g.redSub(j)),p=T.redSqr().redSub(T).redSub(T)):(x=this.z.redSqr(),v=T.redSub(x).redISub(x),f=y.redSub(b).redISub(j).redMul(v),m=T.redMul(g.redSub(j)),p=T.redMul(v))}else g=b.redAdd(j),x=this.curve._mulC(this.z).redSqr(),v=g.redSub(x).redSub(x),f=this.curve._mulC(y.redISub(g)).redMul(v),m=this.curve._mulC(g).redMul(b.redISub(j)),p=g.redMul(v);return this.curve.point(f,m,p)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},h.prototype._extAdd=function(f){var m=this.y.redSub(this.x).redMul(f.y.redSub(f.x)),p=this.y.redAdd(this.x).redMul(f.y.redAdd(f.x)),g=this.t.redMul(this.curve.dd).redMul(f.t),x=this.z.redMul(f.z.redAdd(f.z)),v=p.redSub(m),y=x.redSub(g),b=x.redAdd(g),j=p.redAdd(m),T=v.redMul(y),O=b.redMul(j),R=v.redMul(j),D=y.redMul(b);return this.curve.point(T,O,D,R)},h.prototype._projAdd=function(f){var m,p,g=this.z.redMul(f.z),x=g.redSqr(),v=this.x.redMul(f.x),y=this.y.redMul(f.y),b=this.curve.d.redMul(v).redMul(y),j=x.redSub(b),T=x.redAdd(b),O=this.x.redAdd(this.y).redMul(f.x.redAdd(f.y)).redISub(v).redISub(y),R=g.redMul(j).redMul(O);return this.curve.twisted?(m=g.redMul(T).redMul(y.redSub(this.curve._mulA(v))),p=j.redMul(T)):(m=g.redMul(T).redMul(y.redSub(v)),p=this.curve._mulC(j).redMul(T)),this.curve.point(R,m,p)},h.prototype.add=function(f){return this.isInfinity()?f:f.isInfinity()?this:this.curve.extended?this._extAdd(f):this._projAdd(f)},h.prototype.mul=function(f){return this._hasDoubles(f)?this.curve._fixedNafMul(this,f):this.curve._wnafMul(this,f)},h.prototype.mulAdd=function(f,m,p){return this.curve._wnafMulAdd(1,[this,m],[f,p],2,!1)},h.prototype.jmulAdd=function(f,m,p){return this.curve._wnafMulAdd(1,[this,m],[f,p],2,!0)},h.prototype.normalize=function(){if(this.zOne)return this;var f=this.z.redInvm();return this.x=this.x.redMul(f),this.y=this.y.redMul(f),this.t&&(this.t=this.t.redMul(f)),this.z=this.curve.one,this.zOne=!0,this},h.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},h.prototype.getX=function(){return this.normalize(),this.x.fromRed()},h.prototype.getY=function(){return this.normalize(),this.y.fromRed()},h.prototype.eq=function(f){return this===f||this.getX().cmp(f.getX())===0&&this.getY().cmp(f.getY())===0},h.prototype.eqXToP=function(f){var m=f.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(m)===0)return!0;for(var p=f.clone(),g=this.curve.redN.redMul(this.z);;){if(p.iadd(this.curve.n),p.cmp(this.curve.p)>=0)return!1;if(m.redIAdd(g),this.x.cmp(m)===0)return!0}},h.prototype.toP=h.prototype.normalize,h.prototype.mixedAdd=h.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(r,s,a){var i=a;i.base=r("./base"),i.short=r("./short"),i.mont=r("./mont"),i.edwards=r("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(r,s,a){var i=r("bn.js"),o=r("inherits"),l=r("./base"),d=r("../utils");function c(h){l.call(this,"mont",h),this.a=new i(h.a,16).toRed(this.red),this.b=new i(h.b,16).toRed(this.red),this.i4=new i(4).toRed(this.red).redInvm(),this.two=new i(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function u(h,f,m){l.BasePoint.call(this,h,"projective"),f===null&&m===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new i(f,16),this.z=new i(m,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}o(c,l),s.exports=c,c.prototype.validate=function(h){var f=h.normalize().x,m=f.redSqr(),p=m.redMul(f).redAdd(m.redMul(this.a)).redAdd(f);return p.redSqrt().redSqr().cmp(p)===0},o(u,l.BasePoint),c.prototype.decodePoint=function(h,f){return this.point(d.toArray(h,f),1)},c.prototype.point=function(h,f){return new u(this,h,f)},c.prototype.pointFromJSON=function(h){return u.fromJSON(this,h)},u.prototype.precompute=function(){},u.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},u.fromJSON=function(h,f){return new u(h,f[0],f[1]||h.one)},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.z.cmpn(0)===0},u.prototype.dbl=function(){var h=this.x.redAdd(this.z).redSqr(),f=this.x.redSub(this.z).redSqr(),m=h.redSub(f),p=h.redMul(f),g=m.redMul(f.redAdd(this.curve.a24.redMul(m)));return this.curve.point(p,g)},u.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.diffAdd=function(h,f){var m=this.x.redAdd(this.z),p=this.x.redSub(this.z),g=h.x.redAdd(h.z),x=h.x.redSub(h.z).redMul(m),v=g.redMul(p),y=f.z.redMul(x.redAdd(v).redSqr()),b=f.x.redMul(x.redISub(v).redSqr());return this.curve.point(y,b)},u.prototype.mul=function(h){for(var f=h.clone(),m=this,p=this.curve.point(null,null),g=[];f.cmpn(0)!==0;f.iushrn(1))g.push(f.andln(1));for(var x=g.length-1;x>=0;x--)g[x]===0?(m=m.diffAdd(p,this),p=p.dbl()):(p=m.diffAdd(p,this),m=m.dbl());return p},u.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.eq=function(h){return this.getX().cmp(h.getX())===0},u.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(r,s,a){var i=r("../utils"),o=r("bn.js"),l=r("inherits"),d=r("./base"),c=i.assert;function u(m){d.call(this,"short",m),this.a=new o(m.a,16).toRed(this.red),this.b=new o(m.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(m),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function h(m,p,g,x){d.BasePoint.call(this,m,"affine"),p===null&&g===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new o(p,16),this.y=new o(g,16),x&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function f(m,p,g,x){d.BasePoint.call(this,m,"jacobian"),p===null&&g===null&&x===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new o(0)):(this.x=new o(p,16),this.y=new o(g,16),this.z=new o(x,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}l(u,d),s.exports=u,u.prototype._getEndomorphism=function(m){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var p,g;if(m.beta)p=new o(m.beta,16).toRed(this.red);else{var x=this._getEndoRoots(this.p);p=(p=x[0].cmp(x[1])<0?x[0]:x[1]).toRed(this.red)}if(m.lambda)g=new o(m.lambda,16);else{var v=this._getEndoRoots(this.n);this.g.mul(v[0]).x.cmp(this.g.x.redMul(p))===0?g=v[0]:(g=v[1],c(this.g.mul(g).x.cmp(this.g.x.redMul(p))===0))}return{beta:p,lambda:g,basis:m.basis?m.basis.map(function(y){return{a:new o(y.a,16),b:new o(y.b,16)}}):this._getEndoBasis(g)}}},u.prototype._getEndoRoots=function(m){var p=m===this.p?this.red:o.mont(m),g=new o(2).toRed(p).redInvm(),x=g.redNeg(),v=new o(3).toRed(p).redNeg().redSqrt().redMul(g);return[x.redAdd(v).fromRed(),x.redSub(v).fromRed()]},u.prototype._getEndoBasis=function(m){for(var p,g,x,v,y,b,j,T,O,R=this.n.ushrn(Math.floor(this.n.bitLength()/2)),D=m,B=this.n.clone(),q=new o(1),Y=new o(0),G=new o(0),I=new o(1),F=0;D.cmpn(0)!==0;){var S=B.div(D);T=B.sub(S.mul(D)),O=G.sub(S.mul(q));var E=I.sub(S.mul(Y));if(!x&&T.cmp(R)<0)p=j.neg(),g=q,x=T.neg(),v=O;else if(x&&++F==2)break;j=T,B=D,D=T,G=q,q=O,I=Y,Y=E}y=T.neg(),b=O;var N=x.sqr().add(v.sqr());return y.sqr().add(b.sqr()).cmp(N)>=0&&(y=p,b=g),x.negative&&(x=x.neg(),v=v.neg()),y.negative&&(y=y.neg(),b=b.neg()),[{a:x,b:v},{a:y,b}]},u.prototype._endoSplit=function(m){var p=this.endo.basis,g=p[0],x=p[1],v=x.b.mul(m).divRound(this.n),y=g.b.neg().mul(m).divRound(this.n),b=v.mul(g.a),j=y.mul(x.a),T=v.mul(g.b),O=y.mul(x.b);return{k1:m.sub(b).sub(j),k2:T.add(O).neg()}},u.prototype.pointFromX=function(m,p){(m=new o(m,16)).red||(m=m.toRed(this.red));var g=m.redSqr().redMul(m).redIAdd(m.redMul(this.a)).redIAdd(this.b),x=g.redSqrt();if(x.redSqr().redSub(g).cmp(this.zero)!==0)throw new Error("invalid point");var v=x.fromRed().isOdd();return(p&&!v||!p&&v)&&(x=x.redNeg()),this.point(m,x)},u.prototype.validate=function(m){if(m.inf)return!0;var p=m.x,g=m.y,x=this.a.redMul(p),v=p.redSqr().redMul(p).redIAdd(x).redIAdd(this.b);return g.redSqr().redISub(v).cmpn(0)===0},u.prototype._endoWnafMulAdd=function(m,p,g){for(var x=this._endoWnafT1,v=this._endoWnafT2,y=0;y<m.length;y++){var b=this._endoSplit(p[y]),j=m[y],T=j._getBeta();b.k1.negative&&(b.k1.ineg(),j=j.neg(!0)),b.k2.negative&&(b.k2.ineg(),T=T.neg(!0)),x[2*y]=j,x[2*y+1]=T,v[2*y]=b.k1,v[2*y+1]=b.k2}for(var O=this._wnafMulAdd(1,x,v,2*y,g),R=0;R<2*y;R++)x[R]=null,v[R]=null;return O},l(h,d.BasePoint),u.prototype.point=function(m,p,g){return new h(this,m,p,g)},u.prototype.pointFromJSON=function(m,p){return h.fromJSON(this,m,p)},h.prototype._getBeta=function(){if(this.curve.endo){var m=this.precomputed;if(m&&m.beta)return m.beta;var p=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(m){var g=this.curve,x=function(v){return g.point(v.x.redMul(g.endo.beta),v.y)};m.beta=p,p.precomputed={beta:null,naf:m.naf&&{wnd:m.naf.wnd,points:m.naf.points.map(x)},doubles:m.doubles&&{step:m.doubles.step,points:m.doubles.points.map(x)}}}return p}},h.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},h.fromJSON=function(m,p,g){typeof p=="string"&&(p=JSON.parse(p));var x=m.point(p[0],p[1],g);if(!p[2])return x;function v(b){return m.point(b[0],b[1],g)}var y=p[2];return x.precomputed={beta:null,doubles:y.doubles&&{step:y.doubles.step,points:[x].concat(y.doubles.points.map(v))},naf:y.naf&&{wnd:y.naf.wnd,points:[x].concat(y.naf.points.map(v))}},x},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return this.inf},h.prototype.add=function(m){if(this.inf)return m;if(m.inf)return this;if(this.eq(m))return this.dbl();if(this.neg().eq(m))return this.curve.point(null,null);if(this.x.cmp(m.x)===0)return this.curve.point(null,null);var p=this.y.redSub(m.y);p.cmpn(0)!==0&&(p=p.redMul(this.x.redSub(m.x).redInvm()));var g=p.redSqr().redISub(this.x).redISub(m.x),x=p.redMul(this.x.redSub(g)).redISub(this.y);return this.curve.point(g,x)},h.prototype.dbl=function(){if(this.inf)return this;var m=this.y.redAdd(this.y);if(m.cmpn(0)===0)return this.curve.point(null,null);var p=this.curve.a,g=this.x.redSqr(),x=m.redInvm(),v=g.redAdd(g).redIAdd(g).redIAdd(p).redMul(x),y=v.redSqr().redISub(this.x.redAdd(this.x)),b=v.redMul(this.x.redSub(y)).redISub(this.y);return this.curve.point(y,b)},h.prototype.getX=function(){return this.x.fromRed()},h.prototype.getY=function(){return this.y.fromRed()},h.prototype.mul=function(m){return m=new o(m,16),this.isInfinity()?this:this._hasDoubles(m)?this.curve._fixedNafMul(this,m):this.curve.endo?this.curve._endoWnafMulAdd([this],[m]):this.curve._wnafMul(this,m)},h.prototype.mulAdd=function(m,p,g){var x=[this,p],v=[m,g];return this.curve.endo?this.curve._endoWnafMulAdd(x,v):this.curve._wnafMulAdd(1,x,v,2)},h.prototype.jmulAdd=function(m,p,g){var x=[this,p],v=[m,g];return this.curve.endo?this.curve._endoWnafMulAdd(x,v,!0):this.curve._wnafMulAdd(1,x,v,2,!0)},h.prototype.eq=function(m){return this===m||this.inf===m.inf&&(this.inf||this.x.cmp(m.x)===0&&this.y.cmp(m.y)===0)},h.prototype.neg=function(m){if(this.inf)return this;var p=this.curve.point(this.x,this.y.redNeg());if(m&&this.precomputed){var g=this.precomputed,x=function(v){return v.neg()};p.precomputed={naf:g.naf&&{wnd:g.naf.wnd,points:g.naf.points.map(x)},doubles:g.doubles&&{step:g.doubles.step,points:g.doubles.points.map(x)}}}return p},h.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},l(f,d.BasePoint),u.prototype.jpoint=function(m,p,g){return new f(this,m,p,g)},f.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var m=this.z.redInvm(),p=m.redSqr(),g=this.x.redMul(p),x=this.y.redMul(p).redMul(m);return this.curve.point(g,x)},f.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},f.prototype.add=function(m){if(this.isInfinity())return m;if(m.isInfinity())return this;var p=m.z.redSqr(),g=this.z.redSqr(),x=this.x.redMul(p),v=m.x.redMul(g),y=this.y.redMul(p.redMul(m.z)),b=m.y.redMul(g.redMul(this.z)),j=x.redSub(v),T=y.redSub(b);if(j.cmpn(0)===0)return T.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var O=j.redSqr(),R=O.redMul(j),D=x.redMul(O),B=T.redSqr().redIAdd(R).redISub(D).redISub(D),q=T.redMul(D.redISub(B)).redISub(y.redMul(R)),Y=this.z.redMul(m.z).redMul(j);return this.curve.jpoint(B,q,Y)},f.prototype.mixedAdd=function(m){if(this.isInfinity())return m.toJ();if(m.isInfinity())return this;var p=this.z.redSqr(),g=this.x,x=m.x.redMul(p),v=this.y,y=m.y.redMul(p).redMul(this.z),b=g.redSub(x),j=v.redSub(y);if(b.cmpn(0)===0)return j.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var T=b.redSqr(),O=T.redMul(b),R=g.redMul(T),D=j.redSqr().redIAdd(O).redISub(R).redISub(R),B=j.redMul(R.redISub(D)).redISub(v.redMul(O)),q=this.z.redMul(b);return this.curve.jpoint(D,B,q)},f.prototype.dblp=function(m){if(m===0)return this;if(this.isInfinity())return this;if(!m)return this.dbl();var p;if(this.curve.zeroA||this.curve.threeA){var g=this;for(p=0;p<m;p++)g=g.dbl();return g}var x=this.curve.a,v=this.curve.tinv,y=this.x,b=this.y,j=this.z,T=j.redSqr().redSqr(),O=b.redAdd(b);for(p=0;p<m;p++){var R=y.redSqr(),D=O.redSqr(),B=D.redSqr(),q=R.redAdd(R).redIAdd(R).redIAdd(x.redMul(T)),Y=y.redMul(D),G=q.redSqr().redISub(Y.redAdd(Y)),I=Y.redISub(G),F=q.redMul(I);F=F.redIAdd(F).redISub(B);var S=O.redMul(j);p+1<m&&(T=T.redMul(B)),y=G,j=S,O=F}return this.curve.jpoint(y,O.redMul(v),j)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},f.prototype._zeroDbl=function(){var m,p,g;if(this.zOne){var x=this.x.redSqr(),v=this.y.redSqr(),y=v.redSqr(),b=this.x.redAdd(v).redSqr().redISub(x).redISub(y);b=b.redIAdd(b);var j=x.redAdd(x).redIAdd(x),T=j.redSqr().redISub(b).redISub(b),O=y.redIAdd(y);O=(O=O.redIAdd(O)).redIAdd(O),m=T,p=j.redMul(b.redISub(T)).redISub(O),g=this.y.redAdd(this.y)}else{var R=this.x.redSqr(),D=this.y.redSqr(),B=D.redSqr(),q=this.x.redAdd(D).redSqr().redISub(R).redISub(B);q=q.redIAdd(q);var Y=R.redAdd(R).redIAdd(R),G=Y.redSqr(),I=B.redIAdd(B);I=(I=I.redIAdd(I)).redIAdd(I),m=G.redISub(q).redISub(q),p=Y.redMul(q.redISub(m)).redISub(I),g=(g=this.y.redMul(this.z)).redIAdd(g)}return this.curve.jpoint(m,p,g)},f.prototype._threeDbl=function(){var m,p,g;if(this.zOne){var x=this.x.redSqr(),v=this.y.redSqr(),y=v.redSqr(),b=this.x.redAdd(v).redSqr().redISub(x).redISub(y);b=b.redIAdd(b);var j=x.redAdd(x).redIAdd(x).redIAdd(this.curve.a),T=j.redSqr().redISub(b).redISub(b);m=T;var O=y.redIAdd(y);O=(O=O.redIAdd(O)).redIAdd(O),p=j.redMul(b.redISub(T)).redISub(O),g=this.y.redAdd(this.y)}else{var R=this.z.redSqr(),D=this.y.redSqr(),B=this.x.redMul(D),q=this.x.redSub(R).redMul(this.x.redAdd(R));q=q.redAdd(q).redIAdd(q);var Y=B.redIAdd(B),G=(Y=Y.redIAdd(Y)).redAdd(Y);m=q.redSqr().redISub(G),g=this.y.redAdd(this.z).redSqr().redISub(D).redISub(R);var I=D.redSqr();I=(I=(I=I.redIAdd(I)).redIAdd(I)).redIAdd(I),p=q.redMul(Y.redISub(m)).redISub(I)}return this.curve.jpoint(m,p,g)},f.prototype._dbl=function(){var m=this.curve.a,p=this.x,g=this.y,x=this.z,v=x.redSqr().redSqr(),y=p.redSqr(),b=g.redSqr(),j=y.redAdd(y).redIAdd(y).redIAdd(m.redMul(v)),T=p.redAdd(p),O=(T=T.redIAdd(T)).redMul(b),R=j.redSqr().redISub(O.redAdd(O)),D=O.redISub(R),B=b.redSqr();B=(B=(B=B.redIAdd(B)).redIAdd(B)).redIAdd(B);var q=j.redMul(D).redISub(B),Y=g.redAdd(g).redMul(x);return this.curve.jpoint(R,q,Y)},f.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var m=this.x.redSqr(),p=this.y.redSqr(),g=this.z.redSqr(),x=p.redSqr(),v=m.redAdd(m).redIAdd(m),y=v.redSqr(),b=this.x.redAdd(p).redSqr().redISub(m).redISub(x),j=(b=(b=(b=b.redIAdd(b)).redAdd(b).redIAdd(b)).redISub(y)).redSqr(),T=x.redIAdd(x);T=(T=(T=T.redIAdd(T)).redIAdd(T)).redIAdd(T);var O=v.redIAdd(b).redSqr().redISub(y).redISub(j).redISub(T),R=p.redMul(O);R=(R=R.redIAdd(R)).redIAdd(R);var D=this.x.redMul(j).redISub(R);D=(D=D.redIAdd(D)).redIAdd(D);var B=this.y.redMul(O.redMul(T.redISub(O)).redISub(b.redMul(j)));B=(B=(B=B.redIAdd(B)).redIAdd(B)).redIAdd(B);var q=this.z.redAdd(b).redSqr().redISub(g).redISub(j);return this.curve.jpoint(D,B,q)},f.prototype.mul=function(m,p){return m=new o(m,p),this.curve._wnafMul(this,m)},f.prototype.eq=function(m){if(m.type==="affine")return this.eq(m.toJ());if(this===m)return!0;var p=this.z.redSqr(),g=m.z.redSqr();if(this.x.redMul(g).redISub(m.x.redMul(p)).cmpn(0)!==0)return!1;var x=p.redMul(this.z),v=g.redMul(m.z);return this.y.redMul(v).redISub(m.y.redMul(x)).cmpn(0)===0},f.prototype.eqXToP=function(m){var p=this.z.redSqr(),g=m.toRed(this.curve.red).redMul(p);if(this.x.cmp(g)===0)return!0;for(var x=m.clone(),v=this.curve.redN.redMul(p);;){if(x.iadd(this.curve.n),x.cmp(this.curve.p)>=0)return!1;if(g.redIAdd(v),this.x.cmp(g)===0)return!0}},f.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},f.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(r,s,a){var i,o=a,l=r("hash.js"),d=r("./curve"),c=r("./utils").assert;function u(f){f.type==="short"?this.curve=new d.short(f):f.type==="edwards"?this.curve=new d.edwards(f):this.curve=new d.mont(f),this.g=this.curve.g,this.n=this.curve.n,this.hash=f.hash,c(this.g.validate(),"Invalid curve"),c(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function h(f,m){Object.defineProperty(o,f,{configurable:!0,enumerable:!0,get:function(){var p=new u(m);return Object.defineProperty(o,f,{configurable:!0,enumerable:!0,value:p}),p}})}o.PresetCurve=u,h("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:l.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),h("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:l.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),h("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:l.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),h("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:l.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),h("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:l.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),h("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:l.sha256,gRed:!1,g:["9"]}),h("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:l.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{i=r("./precomputed/secp256k1")}catch{i=void 0}h("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:l.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",i]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(r,s,a){var i=r("bn.js"),o=r("hmac-drbg"),l=r("../utils"),d=r("../curves"),c=r("brorand"),u=l.assert,h=r("./key"),f=r("./signature");function m(p){if(!(this instanceof m))return new m(p);typeof p=="string"&&(u(Object.prototype.hasOwnProperty.call(d,p),"Unknown curve "+p),p=d[p]),p instanceof d.PresetCurve&&(p={curve:p}),this.curve=p.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=p.curve.g,this.g.precompute(p.curve.n.bitLength()+1),this.hash=p.hash||p.curve.hash}s.exports=m,m.prototype.keyPair=function(p){return new h(this,p)},m.prototype.keyFromPrivate=function(p,g){return h.fromPrivate(this,p,g)},m.prototype.keyFromPublic=function(p,g){return h.fromPublic(this,p,g)},m.prototype.genKeyPair=function(p){p||(p={});for(var g=new o({hash:this.hash,pers:p.pers,persEnc:p.persEnc||"utf8",entropy:p.entropy||c(this.hash.hmacStrength),entropyEnc:p.entropy&&p.entropyEnc||"utf8",nonce:this.n.toArray()}),x=this.n.byteLength(),v=this.n.sub(new i(2));;){var y=new i(g.generate(x));if(!(y.cmp(v)>0))return y.iaddn(1),this.keyFromPrivate(y)}},m.prototype._truncateToN=function(p,g){var x=8*p.byteLength()-this.n.bitLength();return x>0&&(p=p.ushrn(x)),!g&&p.cmp(this.n)>=0?p.sub(this.n):p},m.prototype.sign=function(p,g,x,v){typeof x=="object"&&(v=x,x=null),v||(v={}),g=this.keyFromPrivate(g,x),p=this._truncateToN(new i(p,16));for(var y=this.n.byteLength(),b=g.getPrivate().toArray("be",y),j=p.toArray("be",y),T=new o({hash:this.hash,entropy:b,nonce:j,pers:v.pers,persEnc:v.persEnc||"utf8"}),O=this.n.sub(new i(1)),R=0;;R++){var D=v.k?v.k(R):new i(T.generate(this.n.byteLength()));if(!((D=this._truncateToN(D,!0)).cmpn(1)<=0||D.cmp(O)>=0)){var B=this.g.mul(D);if(!B.isInfinity()){var q=B.getX(),Y=q.umod(this.n);if(Y.cmpn(0)!==0){var G=D.invm(this.n).mul(Y.mul(g.getPrivate()).iadd(p));if((G=G.umod(this.n)).cmpn(0)!==0){var I=(B.getY().isOdd()?1:0)|(q.cmp(Y)!==0?2:0);return v.canonical&&G.cmp(this.nh)>0&&(G=this.n.sub(G),I^=1),new f({r:Y,s:G,recoveryParam:I})}}}}}},m.prototype.verify=function(p,g,x,v){p=this._truncateToN(new i(p,16)),x=this.keyFromPublic(x,v);var y=(g=new f(g,"hex")).r,b=g.s;if(y.cmpn(1)<0||y.cmp(this.n)>=0||b.cmpn(1)<0||b.cmp(this.n)>=0)return!1;var j,T=b.invm(this.n),O=T.mul(p).umod(this.n),R=T.mul(y).umod(this.n);return this.curve._maxwellTrick?!(j=this.g.jmulAdd(O,x.getPublic(),R)).isInfinity()&&j.eqXToP(y):!(j=this.g.mulAdd(O,x.getPublic(),R)).isInfinity()&&j.getX().umod(this.n).cmp(y)===0},m.prototype.recoverPubKey=function(p,g,x,v){u((3&x)===x,"The recovery param is more than two bits"),g=new f(g,v);var y=this.n,b=new i(p),j=g.r,T=g.s,O=1&x,R=x>>1;if(j.cmp(this.curve.p.umod(this.curve.n))>=0&&R)throw new Error("Unable to find sencond key candinate");j=R?this.curve.pointFromX(j.add(this.curve.n),O):this.curve.pointFromX(j,O);var D=g.r.invm(y),B=y.sub(b).mul(D).umod(y),q=T.mul(D).umod(y);return this.g.mulAdd(B,j,q)},m.prototype.getKeyRecoveryParam=function(p,g,x,v){if((g=new f(g,v)).recoveryParam!==null)return g.recoveryParam;for(var y=0;y<4;y++){var b;try{b=this.recoverPubKey(p,g,y)}catch{continue}if(b.eq(x))return y}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(r,s,a){var i=r("bn.js"),o=r("../utils").assert;function l(d,c){this.ec=d,this.priv=null,this.pub=null,c.priv&&this._importPrivate(c.priv,c.privEnc),c.pub&&this._importPublic(c.pub,c.pubEnc)}s.exports=l,l.fromPublic=function(d,c,u){return c instanceof l?c:new l(d,{pub:c,pubEnc:u})},l.fromPrivate=function(d,c,u){return c instanceof l?c:new l(d,{priv:c,privEnc:u})},l.prototype.validate=function(){var d=this.getPublic();return d.isInfinity()?{result:!1,reason:"Invalid public key"}:d.validate()?d.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},l.prototype.getPublic=function(d,c){return typeof d=="string"&&(c=d,d=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),c?this.pub.encode(c,d):this.pub},l.prototype.getPrivate=function(d){return d==="hex"?this.priv.toString(16,2):this.priv},l.prototype._importPrivate=function(d,c){this.priv=new i(d,c||16),this.priv=this.priv.umod(this.ec.curve.n)},l.prototype._importPublic=function(d,c){if(d.x||d.y)return this.ec.curve.type==="mont"?o(d.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||o(d.x&&d.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(d.x,d.y));this.pub=this.ec.curve.decodePoint(d,c)},l.prototype.derive=function(d){return d.validate()||o(d.validate(),"public point not validated"),d.mul(this.priv).getX()},l.prototype.sign=function(d,c,u){return this.ec.sign(d,this,c,u)},l.prototype.verify=function(d,c){return this.ec.verify(d,c,this)},l.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(r,s,a){var i=r("bn.js"),o=r("../utils"),l=o.assert;function d(m,p){if(m instanceof d)return m;this._importDER(m,p)||(l(m.r&&m.s,"Signature without r or s"),this.r=new i(m.r,16),this.s=new i(m.s,16),m.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=m.recoveryParam)}function c(){this.place=0}function u(m,p){var g=m[p.place++];if(!(128&g))return g;var x=15&g;if(x===0||x>4)return!1;for(var v=0,y=0,b=p.place;y<x;y++,b++)v<<=8,v|=m[b],v>>>=0;return!(v<=127)&&(p.place=b,v)}function h(m){for(var p=0,g=m.length-1;!m[p]&&!(128&m[p+1])&&p<g;)p++;return p===0?m:m.slice(p)}function f(m,p){if(p<128)m.push(p);else{var g=1+(Math.log(p)/Math.LN2>>>3);for(m.push(128|g);--g;)m.push(p>>>(g<<3)&255);m.push(p)}}s.exports=d,d.prototype._importDER=function(m,p){m=o.toArray(m,p);var g=new c;if(m[g.place++]!==48)return!1;var x=u(m,g);if(x===!1||x+g.place!==m.length||m[g.place++]!==2)return!1;var v=u(m,g);if(v===!1)return!1;var y=m.slice(g.place,v+g.place);if(g.place+=v,m[g.place++]!==2)return!1;var b=u(m,g);if(b===!1||m.length!==b+g.place)return!1;var j=m.slice(g.place,b+g.place);if(y[0]===0){if(!(128&y[1]))return!1;y=y.slice(1)}if(j[0]===0){if(!(128&j[1]))return!1;j=j.slice(1)}return this.r=new i(y),this.s=new i(j),this.recoveryParam=null,!0},d.prototype.toDER=function(m){var p=this.r.toArray(),g=this.s.toArray();for(128&p[0]&&(p=[0].concat(p)),128&g[0]&&(g=[0].concat(g)),p=h(p),g=h(g);!(g[0]||128&g[1]);)g=g.slice(1);var x=[2];f(x,p.length),(x=x.concat(p)).push(2),f(x,g.length);var v=x.concat(g),y=[48];return f(y,v.length),y=y.concat(v),o.encode(y,m)}},{"../utils":419,"bn.js":420}],415:[function(r,s,a){var i=r("hash.js"),o=r("../curves"),l=r("../utils"),d=l.assert,c=l.parseBytes,u=r("./key"),h=r("./signature");function f(m){if(d(m==="ed25519","only tested with ed25519 so far"),!(this instanceof f))return new f(m);m=o[m].curve,this.curve=m,this.g=m.g,this.g.precompute(m.n.bitLength()+1),this.pointClass=m.point().constructor,this.encodingLength=Math.ceil(m.n.bitLength()/8),this.hash=i.sha512}s.exports=f,f.prototype.sign=function(m,p){m=c(m);var g=this.keyFromSecret(p),x=this.hashInt(g.messagePrefix(),m),v=this.g.mul(x),y=this.encodePoint(v),b=this.hashInt(y,g.pubBytes(),m).mul(g.priv()),j=x.add(b).umod(this.curve.n);return this.makeSignature({R:v,S:j,Rencoded:y})},f.prototype.verify=function(m,p,g){m=c(m),p=this.makeSignature(p);var x=this.keyFromPublic(g),v=this.hashInt(p.Rencoded(),x.pubBytes(),m),y=this.g.mul(p.S());return p.R().add(x.pub().mul(v)).eq(y)},f.prototype.hashInt=function(){for(var m=this.hash(),p=0;p<arguments.length;p++)m.update(arguments[p]);return l.intFromLE(m.digest()).umod(this.curve.n)},f.prototype.keyFromPublic=function(m){return u.fromPublic(this,m)},f.prototype.keyFromSecret=function(m){return u.fromSecret(this,m)},f.prototype.makeSignature=function(m){return m instanceof h?m:new h(this,m)},f.prototype.encodePoint=function(m){var p=m.getY().toArray("le",this.encodingLength);return p[this.encodingLength-1]|=m.getX().isOdd()?128:0,p},f.prototype.decodePoint=function(m){var p=(m=l.parseBytes(m)).length-1,g=m.slice(0,p).concat(-129&m[p]),x=(128&m[p])!=0,v=l.intFromLE(g);return this.curve.pointFromY(v,x)},f.prototype.encodeInt=function(m){return m.toArray("le",this.encodingLength)},f.prototype.decodeInt=function(m){return l.intFromLE(m)},f.prototype.isPoint=function(m){return m instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(r,s,a){var i=r("../utils"),o=i.assert,l=i.parseBytes,d=i.cachedProperty;function c(u,h){this.eddsa=u,this._secret=l(h.secret),u.isPoint(h.pub)?this._pub=h.pub:this._pubBytes=l(h.pub)}c.fromPublic=function(u,h){return h instanceof c?h:new c(u,{pub:h})},c.fromSecret=function(u,h){return h instanceof c?h:new c(u,{secret:h})},c.prototype.secret=function(){return this._secret},d(c,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),d(c,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),d(c,"privBytes",function(){var u=this.eddsa,h=this.hash(),f=u.encodingLength-1,m=h.slice(0,u.encodingLength);return m[0]&=248,m[f]&=127,m[f]|=64,m}),d(c,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),d(c,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),d(c,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),c.prototype.sign=function(u){return o(this._secret,"KeyPair can only verify"),this.eddsa.sign(u,this)},c.prototype.verify=function(u,h){return this.eddsa.verify(u,h,this)},c.prototype.getSecret=function(u){return o(this._secret,"KeyPair is public only"),i.encode(this.secret(),u)},c.prototype.getPublic=function(u){return i.encode(this.pubBytes(),u)},s.exports=c},{"../utils":419}],417:[function(r,s,a){var i=r("bn.js"),o=r("../utils"),l=o.assert,d=o.cachedProperty,c=o.parseBytes;function u(h,f){this.eddsa=h,typeof f!="object"&&(f=c(f)),Array.isArray(f)&&(f={R:f.slice(0,h.encodingLength),S:f.slice(h.encodingLength)}),l(f.R&&f.S,"Signature without R or S"),h.isPoint(f.R)&&(this._R=f.R),f.S instanceof i&&(this._S=f.S),this._Rencoded=Array.isArray(f.R)?f.R:f.Rencoded,this._Sencoded=Array.isArray(f.S)?f.S:f.Sencoded}d(u,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),d(u,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),d(u,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),d(u,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),u.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},u.prototype.toHex=function(){return o.encode(this.toBytes(),"hex").toUpperCase()},s.exports=u},{"../utils":419,"bn.js":420}],418:[function(r,s,a){s.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(r,s,a){var i=a,o=r("bn.js"),l=r("minimalistic-assert"),d=r("minimalistic-crypto-utils");i.assert=l,i.toArray=d.toArray,i.zero2=d.zero2,i.toHex=d.toHex,i.encode=d.encode,i.getNAF=function(c,u,h){var f=new Array(Math.max(c.bitLength(),h)+1);f.fill(0);for(var m=1<<u+1,p=c.clone(),g=0;g<f.length;g++){var x,v=p.andln(m-1);p.isOdd()?(x=v>(m>>1)-1?(m>>1)-v:v,p.isubn(x)):x=0,f[g]=x,p.iushrn(1)}return f},i.getJSF=function(c,u){var h=[[],[]];c=c.clone(),u=u.clone();for(var f,m=0,p=0;c.cmpn(-m)>0||u.cmpn(-p)>0;){var g,x,v=c.andln(3)+m&3,y=u.andln(3)+p&3;v===3&&(v=-1),y===3&&(y=-1),g=1&v?(f=c.andln(7)+m&7)!==3&&f!==5||y!==2?v:-v:0,h[0].push(g),x=1&y?(f=u.andln(7)+p&7)!==3&&f!==5||v!==2?y:-y:0,h[1].push(x),2*m===g+1&&(m=1-m),2*p===x+1&&(p=1-p),c.iushrn(1),u.iushrn(1)}return h},i.cachedProperty=function(c,u,h){var f="_"+u;c.prototype[u]=function(){return this[f]!==void 0?this[f]:this[f]=h.call(this)}},i.parseBytes=function(c){return typeof c=="string"?i.toArray(c,"hex"):c},i.intFromLE=function(c){return new o(c,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(r,s,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],421:[function(r,s,a){s.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(r,s,a){var i=Object.create||function(D){var B=function(){};return B.prototype=D,new B},o=Object.keys||function(D){var B=[];for(var q in D)Object.prototype.hasOwnProperty.call(D,q)&&B.push(q);return q},l=Function.prototype.bind||function(D){var B=this;return function(){return B.apply(D,arguments)}};function d(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=i(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}s.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0;var c,u=10;try{var h={};Object.defineProperty&&Object.defineProperty(h,"x",{value:0}),c=h.x===0}catch{c=!1}function f(D){return D._maxListeners===void 0?d.defaultMaxListeners:D._maxListeners}function m(D,B,q){if(B)D.call(q);else for(var Y=D.length,G=R(D,Y),I=0;I<Y;++I)G[I].call(q)}function p(D,B,q,Y){if(B)D.call(q,Y);else for(var G=D.length,I=R(D,G),F=0;F<G;++F)I[F].call(q,Y)}function g(D,B,q,Y,G){if(B)D.call(q,Y,G);else for(var I=D.length,F=R(D,I),S=0;S<I;++S)F[S].call(q,Y,G)}function x(D,B,q,Y,G,I){if(B)D.call(q,Y,G,I);else for(var F=D.length,S=R(D,F),E=0;E<F;++E)S[E].call(q,Y,G,I)}function v(D,B,q,Y){if(B)D.apply(q,Y);else for(var G=D.length,I=R(D,G),F=0;F<G;++F)I[F].apply(q,Y)}function y(D,B,q,Y){var G,I,F;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if((I=D._events)?(I.newListener&&(D.emit("newListener",B,q.listener?q.listener:q),I=D._events),F=I[B]):(I=D._events=i(null),D._eventsCount=0),F){if(typeof F=="function"?F=I[B]=Y?[q,F]:[F,q]:Y?F.unshift(q):F.push(q),!F.warned&&(G=f(D))&&G>0&&F.length>G){F.warned=!0;var S=new Error("Possible EventEmitter memory leak detected. "+F.length+' "'+String(B)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');S.name="MaxListenersExceededWarning",S.emitter=D,S.type=B,S.count=F.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",S.name,S.message)}}else F=I[B]=q,++D._eventsCount;return D}function b(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var D=new Array(arguments.length),B=0;B<D.length;++B)D[B]=arguments[B];this.listener.apply(this.target,D)}}function j(D,B,q){var Y={fired:!1,wrapFn:void 0,target:D,type:B,listener:q},G=l.call(b,Y);return G.listener=q,Y.wrapFn=G,G}function T(D,B,q){var Y=D._events;if(!Y)return[];var G=Y[B];return G?typeof G=="function"?q?[G.listener||G]:[G]:q?function(I){for(var F=new Array(I.length),S=0;S<F.length;++S)F[S]=I[S].listener||I[S];return F}(G):R(G,G.length):[]}function O(D){var B=this._events;if(B){var q=B[D];if(typeof q=="function")return 1;if(q)return q.length}return 0}function R(D,B){for(var q=new Array(B),Y=0;Y<B;++Y)q[Y]=D[Y];return q}c?Object.defineProperty(d,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(D){if(typeof D!="number"||D<0||D!=D)throw new TypeError('"defaultMaxListeners" must be a positive number');u=D}}):d.defaultMaxListeners=u,d.prototype.setMaxListeners=function(D){if(typeof D!="number"||D<0||isNaN(D))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=D,this},d.prototype.getMaxListeners=function(){return f(this)},d.prototype.emit=function(D){var B,q,Y,G,I,F,S=D==="error";if(F=this._events)S=S&&F.error==null;else if(!S)return!1;if(S){if(arguments.length>1&&(B=arguments[1]),B instanceof Error)throw B;var E=new Error('Unhandled "error" event. ('+B+")");throw E.context=B,E}if(!(q=F[D]))return!1;var N=typeof q=="function";switch(Y=arguments.length){case 1:m(q,N,this);break;case 2:p(q,N,this,arguments[1]);break;case 3:g(q,N,this,arguments[1],arguments[2]);break;case 4:x(q,N,this,arguments[1],arguments[2],arguments[3]);break;default:for(G=new Array(Y-1),I=1;I<Y;I++)G[I-1]=arguments[I];v(q,N,this,G)}return!0},d.prototype.addListener=function(D,B){return y(this,D,B,!1)},d.prototype.on=d.prototype.addListener,d.prototype.prependListener=function(D,B){return y(this,D,B,!0)},d.prototype.once=function(D,B){if(typeof B!="function")throw new TypeError('"listener" argument must be a function');return this.on(D,j(this,D,B)),this},d.prototype.prependOnceListener=function(D,B){if(typeof B!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(D,j(this,D,B)),this},d.prototype.removeListener=function(D,B){var q,Y,G,I,F;if(typeof B!="function")throw new TypeError('"listener" argument must be a function');if(!(Y=this._events))return this;if(!(q=Y[D]))return this;if(q===B||q.listener===B)--this._eventsCount==0?this._events=i(null):(delete Y[D],Y.removeListener&&this.emit("removeListener",D,q.listener||B));else if(typeof q!="function"){for(G=-1,I=q.length-1;I>=0;I--)if(q[I]===B||q[I].listener===B){F=q[I].listener,G=I;break}if(G<0)return this;G===0?q.shift():function(S,E){for(var N=E,C=N+1,k=S.length;C<k;N+=1,C+=1)S[N]=S[C];S.pop()}(q,G),q.length===1&&(Y[D]=q[0]),Y.removeListener&&this.emit("removeListener",D,F||B)}return this},d.prototype.removeAllListeners=function(D){var B,q,Y;if(!(q=this._events))return this;if(!q.removeListener)return arguments.length===0?(this._events=i(null),this._eventsCount=0):q[D]&&(--this._eventsCount==0?this._events=i(null):delete q[D]),this;if(arguments.length===0){var G,I=o(q);for(Y=0;Y<I.length;++Y)(G=I[Y])!=="removeListener"&&this.removeAllListeners(G);return this.removeAllListeners("removeListener"),this._events=i(null),this._eventsCount=0,this}if(typeof(B=q[D])=="function")this.removeListener(D,B);else if(B)for(Y=B.length-1;Y>=0;Y--)this.removeListener(D,B[Y]);return this},d.prototype.listeners=function(D){return T(this,D,!0)},d.prototype.rawListeners=function(D){return T(this,D,!1)},d.listenerCount=function(D,B){return typeof D.listenerCount=="function"?D.listenerCount(B):O.call(D,B)},d.prototype.listenerCount=O,d.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("md5.js");s.exports=function(l,d,c,u){if(i.isBuffer(l)||(l=i.from(l,"binary")),d&&(i.isBuffer(d)||(d=i.from(d,"binary")),d.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var h=c/8,f=i.alloc(h),m=i.alloc(u||0),p=i.alloc(0);h>0||u>0;){var g=new o;g.update(p),g.update(l),d&&g.update(d),p=g.digest();var x=0;if(h>0){var v=f.length-h;x=Math.min(h,p.length),p.copy(f,v,0,x),h-=x}if(x<p.length&&u>0){var y=m.length-u,b=Math.min(u,p.length-x);p.copy(m,y,x,x+b),u-=b}}return p.fill(0),{key:f,iv:m}}},{"md5.js":450,"safe-buffer":494}],424:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvParserStream=a.ParserOptions=a.parseFile=a.parseStream=a.parseString=a.parse=a.FormatterOptions=a.CsvFormatterStream=a.writeToPath=a.writeToString=a.writeToBuffer=a.writeToStream=a.write=a.format=void 0;var i=r("@fast-csv/format");Object.defineProperty(a,"format",{enumerable:!0,get:function(){return i.format}}),Object.defineProperty(a,"write",{enumerable:!0,get:function(){return i.write}}),Object.defineProperty(a,"writeToStream",{enumerable:!0,get:function(){return i.writeToStream}}),Object.defineProperty(a,"writeToBuffer",{enumerable:!0,get:function(){return i.writeToBuffer}}),Object.defineProperty(a,"writeToString",{enumerable:!0,get:function(){return i.writeToString}}),Object.defineProperty(a,"writeToPath",{enumerable:!0,get:function(){return i.writeToPath}}),Object.defineProperty(a,"CsvFormatterStream",{enumerable:!0,get:function(){return i.CsvFormatterStream}}),Object.defineProperty(a,"FormatterOptions",{enumerable:!0,get:function(){return i.FormatterOptions}});var o=r("@fast-csv/parse");Object.defineProperty(a,"parse",{enumerable:!0,get:function(){return o.parse}}),Object.defineProperty(a,"parseString",{enumerable:!0,get:function(){return o.parseString}}),Object.defineProperty(a,"parseStream",{enumerable:!0,get:function(){return o.parseStream}}),Object.defineProperty(a,"parseFile",{enumerable:!0,get:function(){return o.parseFile}}),Object.defineProperty(a,"ParserOptions",{enumerable:!0,get:function(){return o.ParserOptions}}),Object.defineProperty(a,"CsvParserStream",{enumerable:!0,get:function(){return o.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("readable-stream").Transform;function l(d){o.call(this),this._block=i.allocUnsafe(d),this._blockSize=d,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}r("inherits")(l,o),l.prototype._transform=function(d,c,u){var h=null;try{this.update(d,c)}catch(f){h=f}u(h)},l.prototype._flush=function(d){var c=null;try{this.push(this.digest())}catch(u){c=u}d(c)},l.prototype.update=function(d,c){if(function(g,x){if(!i.isBuffer(g)&&typeof g!="string")throw new TypeError(x+" must be a string or a buffer")}(d,"Data"),this._finalized)throw new Error("Digest already called");i.isBuffer(d)||(d=i.from(d,c));for(var u=this._block,h=0;this._blockOffset+d.length-h>=this._blockSize;){for(var f=this._blockOffset;f<this._blockSize;)u[f++]=d[h++];this._update(),this._blockOffset=0}for(;h<d.length;)u[this._blockOffset++]=d[h++];for(var m=0,p=8*d.length;p>0;++m)this._length[m]+=p,(p=this._length[m]/4294967296|0)>0&&(this._length[m]-=4294967296*p);return this},l.prototype._update=function(){throw new Error("_update is not implemented")},l.prototype.digest=function(d){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var c=this._digest();d!==void 0&&(c=c.toString(d)),this._block.fill(0),this._blockOffset=0;for(var u=0;u<4;++u)this._length[u]=0;return c},l.prototype._digest=function(){throw new Error("_digest is not implemented")},s.exports=l},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(r,s,a){var i=a;i.utils=r("./hash/utils"),i.common=r("./hash/common"),i.sha=r("./hash/sha"),i.ripemd=r("./hash/ripemd"),i.hmac=r("./hash/hmac"),i.sha1=i.sha.sha1,i.sha256=i.sha.sha256,i.sha224=i.sha.sha224,i.sha384=i.sha.sha384,i.sha512=i.sha.sha512,i.ripemd160=i.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(r,s,a){var i=r("./utils"),o=r("minimalistic-assert");function l(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}a.BlockHash=l,l.prototype.update=function(d,c){if(d=i.toArray(d,c),this.pending?this.pending=this.pending.concat(d):this.pending=d,this.pendingTotal+=d.length,this.pending.length>=this._delta8){var u=(d=this.pending).length%this._delta8;this.pending=d.slice(d.length-u,d.length),this.pending.length===0&&(this.pending=null),d=i.join32(d,0,d.length-u,this.endian);for(var h=0;h<d.length;h+=this._delta32)this._update(d,h,h+this._delta32)}return this},l.prototype.digest=function(d){return this.update(this._pad()),o(this.pending===null),this._digest(d)},l.prototype._pad=function(){var d=this.pendingTotal,c=this._delta8,u=c-(d+this.padLength)%c,h=new Array(u+this.padLength);h[0]=128;for(var f=1;f<u;f++)h[f]=0;if(d<<=3,this.endian==="big"){for(var m=8;m<this.padLength;m++)h[f++]=0;h[f++]=0,h[f++]=0,h[f++]=0,h[f++]=0,h[f++]=d>>>24&255,h[f++]=d>>>16&255,h[f++]=d>>>8&255,h[f++]=255&d}else for(h[f++]=255&d,h[f++]=d>>>8&255,h[f++]=d>>>16&255,h[f++]=d>>>24&255,h[f++]=0,h[f++]=0,h[f++]=0,h[f++]=0,m=8;m<this.padLength;m++)h[f++]=0;return h}},{"./utils":437,"minimalistic-assert":453}],428:[function(r,s,a){var i=r("./utils"),o=r("minimalistic-assert");function l(d,c,u){if(!(this instanceof l))return new l(d,c,u);this.Hash=d,this.blockSize=d.blockSize/8,this.outSize=d.outSize/8,this.inner=null,this.outer=null,this._init(i.toArray(c,u))}s.exports=l,l.prototype._init=function(d){d.length>this.blockSize&&(d=new this.Hash().update(d).digest()),o(d.length<=this.blockSize);for(var c=d.length;c<this.blockSize;c++)d.push(0);for(c=0;c<d.length;c++)d[c]^=54;for(this.inner=new this.Hash().update(d),c=0;c<d.length;c++)d[c]^=106;this.outer=new this.Hash().update(d)},l.prototype.update=function(d,c){return this.inner.update(d,c),this},l.prototype.digest=function(d){return this.outer.update(this.inner.digest()),this.outer.digest(d)}},{"./utils":437,"minimalistic-assert":453}],429:[function(r,s,a){var i=r("./utils"),o=r("./common"),l=i.rotl32,d=i.sum32,c=i.sum32_3,u=i.sum32_4,h=o.BlockHash;function f(){if(!(this instanceof f))return new f;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function m(j,T,O,R){return j<=15?T^O^R:j<=31?T&O|~T&R:j<=47?(T|~O)^R:j<=63?T&R|O&~R:T^(O|~R)}function p(j){return j<=15?0:j<=31?1518500249:j<=47?1859775393:j<=63?2400959708:2840853838}function g(j){return j<=15?1352829926:j<=31?1548603684:j<=47?1836072691:j<=63?2053994217:0}i.inherits(f,h),a.ripemd160=f,f.blockSize=512,f.outSize=160,f.hmacStrength=192,f.padLength=64,f.prototype._update=function(j,T){for(var O=this.h[0],R=this.h[1],D=this.h[2],B=this.h[3],q=this.h[4],Y=O,G=R,I=D,F=B,S=q,E=0;E<80;E++){var N=d(l(u(O,m(E,R,D,B),j[x[E]+T],p(E)),y[E]),q);O=q,q=B,B=l(D,10),D=R,R=N,N=d(l(u(Y,m(79-E,G,I,F),j[v[E]+T],g(E)),b[E]),S),Y=S,S=F,F=l(I,10),I=G,G=N}N=c(this.h[1],D,F),this.h[1]=c(this.h[2],B,S),this.h[2]=c(this.h[3],q,Y),this.h[3]=c(this.h[4],O,G),this.h[4]=c(this.h[0],R,I),this.h[0]=N},f.prototype._digest=function(j){return j==="hex"?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var x=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],v=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],b=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(r,s,a){a.sha1=r("./sha/1"),a.sha224=r("./sha/224"),a.sha256=r("./sha/256"),a.sha384=r("./sha/384"),a.sha512=r("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(r,s,a){var i=r("../utils"),o=r("../common"),l=r("./common"),d=i.rotl32,c=i.sum32,u=i.sum32_5,h=l.ft_1,f=o.BlockHash,m=[1518500249,1859775393,2400959708,3395469782];function p(){if(!(this instanceof p))return new p;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}i.inherits(p,f),s.exports=p,p.blockSize=512,p.outSize=160,p.hmacStrength=80,p.padLength=64,p.prototype._update=function(g,x){for(var v=this.W,y=0;y<16;y++)v[y]=g[x+y];for(;y<v.length;y++)v[y]=d(v[y-3]^v[y-8]^v[y-14]^v[y-16],1);var b=this.h[0],j=this.h[1],T=this.h[2],O=this.h[3],R=this.h[4];for(y=0;y<v.length;y++){var D=~~(y/20),B=u(d(b,5),h(D,j,T,O),R,v[y],m[D]);R=O,O=T,T=d(j,30),j=b,b=B}this.h[0]=c(this.h[0],b),this.h[1]=c(this.h[1],j),this.h[2]=c(this.h[2],T),this.h[3]=c(this.h[3],O),this.h[4]=c(this.h[4],R)},p.prototype._digest=function(g){return g==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(r,s,a){var i=r("../utils"),o=r("./256");function l(){if(!(this instanceof l))return new l;o.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}i.inherits(l,o),s.exports=l,l.blockSize=512,l.outSize=224,l.hmacStrength=192,l.padLength=64,l.prototype._digest=function(d){return d==="hex"?i.toHex32(this.h.slice(0,7),"big"):i.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(r,s,a){var i=r("../utils"),o=r("../common"),l=r("./common"),d=r("minimalistic-assert"),c=i.sum32,u=i.sum32_4,h=i.sum32_5,f=l.ch32,m=l.maj32,p=l.s0_256,g=l.s1_256,x=l.g0_256,v=l.g1_256,y=o.BlockHash,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function j(){if(!(this instanceof j))return new j;y.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=b,this.W=new Array(64)}i.inherits(j,y),s.exports=j,j.blockSize=512,j.outSize=256,j.hmacStrength=192,j.padLength=64,j.prototype._update=function(T,O){for(var R=this.W,D=0;D<16;D++)R[D]=T[O+D];for(;D<R.length;D++)R[D]=u(v(R[D-2]),R[D-7],x(R[D-15]),R[D-16]);var B=this.h[0],q=this.h[1],Y=this.h[2],G=this.h[3],I=this.h[4],F=this.h[5],S=this.h[6],E=this.h[7];for(d(this.k.length===R.length),D=0;D<R.length;D++){var N=h(E,g(I),f(I,F,S),this.k[D],R[D]),C=c(p(B),m(B,q,Y));E=S,S=F,F=I,I=c(G,N),G=Y,Y=q,q=B,B=c(N,C)}this.h[0]=c(this.h[0],B),this.h[1]=c(this.h[1],q),this.h[2]=c(this.h[2],Y),this.h[3]=c(this.h[3],G),this.h[4]=c(this.h[4],I),this.h[5]=c(this.h[5],F),this.h[6]=c(this.h[6],S),this.h[7]=c(this.h[7],E)},j.prototype._digest=function(T){return T==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(r,s,a){var i=r("../utils"),o=r("./512");function l(){if(!(this instanceof l))return new l;o.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}i.inherits(l,o),s.exports=l,l.blockSize=1024,l.outSize=384,l.hmacStrength=192,l.padLength=128,l.prototype._digest=function(d){return d==="hex"?i.toHex32(this.h.slice(0,12),"big"):i.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(r,s,a){var i=r("../utils"),o=r("../common"),l=r("minimalistic-assert"),d=i.rotr64_hi,c=i.rotr64_lo,u=i.shr64_hi,h=i.shr64_lo,f=i.sum64,m=i.sum64_hi,p=i.sum64_lo,g=i.sum64_4_hi,x=i.sum64_4_lo,v=i.sum64_5_hi,y=i.sum64_5_lo,b=o.BlockHash,j=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function T(){if(!(this instanceof T))return new T;b.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=j,this.W=new Array(160)}function O(C,k,M,U,$){var X=C&M^~C&$;return X<0&&(X+=4294967296),X}function R(C,k,M,U,$,X){var Z=k&U^~k&X;return Z<0&&(Z+=4294967296),Z}function D(C,k,M,U,$){var X=C&M^C&$^M&$;return X<0&&(X+=4294967296),X}function B(C,k,M,U,$,X){var Z=k&U^k&X^U&X;return Z<0&&(Z+=4294967296),Z}function q(C,k){var M=d(C,k,28)^d(k,C,2)^d(k,C,7);return M<0&&(M+=4294967296),M}function Y(C,k){var M=c(C,k,28)^c(k,C,2)^c(k,C,7);return M<0&&(M+=4294967296),M}function G(C,k){var M=d(C,k,14)^d(C,k,18)^d(k,C,9);return M<0&&(M+=4294967296),M}function I(C,k){var M=c(C,k,14)^c(C,k,18)^c(k,C,9);return M<0&&(M+=4294967296),M}function F(C,k){var M=d(C,k,1)^d(C,k,8)^u(C,k,7);return M<0&&(M+=4294967296),M}function S(C,k){var M=c(C,k,1)^c(C,k,8)^h(C,k,7);return M<0&&(M+=4294967296),M}function E(C,k){var M=d(C,k,19)^d(k,C,29)^u(C,k,6);return M<0&&(M+=4294967296),M}function N(C,k){var M=c(C,k,19)^c(k,C,29)^h(C,k,6);return M<0&&(M+=4294967296),M}i.inherits(T,b),s.exports=T,T.blockSize=1024,T.outSize=512,T.hmacStrength=192,T.padLength=128,T.prototype._prepareBlock=function(C,k){for(var M=this.W,U=0;U<32;U++)M[U]=C[k+U];for(;U<M.length;U+=2){var $=E(M[U-4],M[U-3]),X=N(M[U-4],M[U-3]),Z=M[U-14],re=M[U-13],W=F(M[U-30],M[U-29]),J=S(M[U-30],M[U-29]),V=M[U-32],H=M[U-31];M[U]=g($,X,Z,re,W,J,V,H),M[U+1]=x($,X,Z,re,W,J,V,H)}},T.prototype._update=function(C,k){this._prepareBlock(C,k);var M=this.W,U=this.h[0],$=this.h[1],X=this.h[2],Z=this.h[3],re=this.h[4],W=this.h[5],J=this.h[6],V=this.h[7],H=this.h[8],ee=this.h[9],ie=this.h[10],oe=this.h[11],se=this.h[12],ue=this.h[13],pe=this.h[14],ce=this.h[15];l(this.k.length===M.length);for(var ne=0;ne<M.length;ne+=2){var me=pe,ge=ce,_e=G(H,ee),be=I(H,ee),ye=O(H,ee,ie,oe,se),Oe=R(H,ee,ie,oe,se,ue),Ne=this.k[ne],De=this.k[ne+1],Ge=M[ne],Qe=M[ne+1],Ie=v(me,ge,_e,be,ye,Oe,Ne,De,Ge,Qe),Ae=y(me,ge,_e,be,ye,Oe,Ne,De,Ge,Qe);me=q(U,$),ge=Y(U,$),_e=D(U,$,X,Z,re),be=B(U,$,X,Z,re,W);var st=m(me,ge,_e,be),nt=p(me,ge,_e,be);pe=se,ce=ue,se=ie,ue=oe,ie=H,oe=ee,H=m(J,V,Ie,Ae),ee=p(V,V,Ie,Ae),J=re,V=W,re=X,W=Z,X=U,Z=$,U=m(Ie,Ae,st,nt),$=p(Ie,Ae,st,nt)}f(this.h,0,U,$),f(this.h,2,X,Z),f(this.h,4,re,W),f(this.h,6,J,V),f(this.h,8,H,ee),f(this.h,10,ie,oe),f(this.h,12,se,ue),f(this.h,14,pe,ce)},T.prototype._digest=function(C){return C==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(r,s,a){var i=r("../utils").rotr32;function o(c,u,h){return c&u^~c&h}function l(c,u,h){return c&u^c&h^u&h}function d(c,u,h){return c^u^h}a.ft_1=function(c,u,h,f){return c===0?o(u,h,f):c===1||c===3?d(u,h,f):c===2?l(u,h,f):void 0},a.ch32=o,a.maj32=l,a.p32=d,a.s0_256=function(c){return i(c,2)^i(c,13)^i(c,22)},a.s1_256=function(c){return i(c,6)^i(c,11)^i(c,25)},a.g0_256=function(c){return i(c,7)^i(c,18)^c>>>3},a.g1_256=function(c){return i(c,17)^i(c,19)^c>>>10}},{"../utils":437}],437:[function(r,s,a){var i=r("minimalistic-assert"),o=r("inherits");function l(h,f){return(64512&h.charCodeAt(f))==55296&&!(f<0||f+1>=h.length)&&(64512&h.charCodeAt(f+1))==56320}function d(h){return(h>>>24|h>>>8&65280|h<<8&16711680|(255&h)<<24)>>>0}function c(h){return h.length===1?"0"+h:h}function u(h){return h.length===7?"0"+h:h.length===6?"00"+h:h.length===5?"000"+h:h.length===4?"0000"+h:h.length===3?"00000"+h:h.length===2?"000000"+h:h.length===1?"0000000"+h:h}a.inherits=o,a.toArray=function(h,f){if(Array.isArray(h))return h.slice();if(!h)return[];var m=[];if(typeof h=="string")if(f){if(f==="hex")for((h=h.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(h="0"+h),g=0;g<h.length;g+=2)m.push(parseInt(h[g]+h[g+1],16))}else for(var p=0,g=0;g<h.length;g++){var x=h.charCodeAt(g);x<128?m[p++]=x:x<2048?(m[p++]=x>>6|192,m[p++]=63&x|128):l(h,g)?(x=65536+((1023&x)<<10)+(1023&h.charCodeAt(++g)),m[p++]=x>>18|240,m[p++]=x>>12&63|128,m[p++]=x>>6&63|128,m[p++]=63&x|128):(m[p++]=x>>12|224,m[p++]=x>>6&63|128,m[p++]=63&x|128)}else for(g=0;g<h.length;g++)m[g]=0|h[g];return m},a.toHex=function(h){for(var f="",m=0;m<h.length;m++)f+=c(h[m].toString(16));return f},a.htonl=d,a.toHex32=function(h,f){for(var m="",p=0;p<h.length;p++){var g=h[p];f==="little"&&(g=d(g)),m+=u(g.toString(16))}return m},a.zero2=c,a.zero8=u,a.join32=function(h,f,m,p){var g=m-f;i(g%4==0);for(var x=new Array(g/4),v=0,y=f;v<x.length;v++,y+=4){var b;b=p==="big"?h[y]<<24|h[y+1]<<16|h[y+2]<<8|h[y+3]:h[y+3]<<24|h[y+2]<<16|h[y+1]<<8|h[y],x[v]=b>>>0}return x},a.split32=function(h,f){for(var m=new Array(4*h.length),p=0,g=0;p<h.length;p++,g+=4){var x=h[p];f==="big"?(m[g]=x>>>24,m[g+1]=x>>>16&255,m[g+2]=x>>>8&255,m[g+3]=255&x):(m[g+3]=x>>>24,m[g+2]=x>>>16&255,m[g+1]=x>>>8&255,m[g]=255&x)}return m},a.rotr32=function(h,f){return h>>>f|h<<32-f},a.rotl32=function(h,f){return h<<f|h>>>32-f},a.sum32=function(h,f){return h+f>>>0},a.sum32_3=function(h,f,m){return h+f+m>>>0},a.sum32_4=function(h,f,m,p){return h+f+m+p>>>0},a.sum32_5=function(h,f,m,p,g){return h+f+m+p+g>>>0},a.sum64=function(h,f,m,p){var g=h[f],x=p+h[f+1]>>>0,v=(x<p?1:0)+m+g;h[f]=v>>>0,h[f+1]=x},a.sum64_hi=function(h,f,m,p){return(f+p>>>0<f?1:0)+h+m>>>0},a.sum64_lo=function(h,f,m,p){return f+p>>>0},a.sum64_4_hi=function(h,f,m,p,g,x,v,y){var b=0,j=f;return b+=(j=j+p>>>0)<f?1:0,b+=(j=j+x>>>0)<x?1:0,h+m+g+v+(b+=(j=j+y>>>0)<y?1:0)>>>0},a.sum64_4_lo=function(h,f,m,p,g,x,v,y){return f+p+x+y>>>0},a.sum64_5_hi=function(h,f,m,p,g,x,v,y,b,j){var T=0,O=f;return T+=(O=O+p>>>0)<f?1:0,T+=(O=O+x>>>0)<x?1:0,T+=(O=O+y>>>0)<y?1:0,h+m+g+v+b+(T+=(O=O+j>>>0)<j?1:0)>>>0},a.sum64_5_lo=function(h,f,m,p,g,x,v,y,b,j){return f+p+x+y+j>>>0},a.rotr64_hi=function(h,f,m){return(f<<32-m|h>>>m)>>>0},a.rotr64_lo=function(h,f,m){return(h<<32-m|f>>>m)>>>0},a.shr64_hi=function(h,f,m){return h>>>m},a.shr64_lo=function(h,f,m){return(h<<32-m|f>>>m)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(r,s,a){var i=r("hash.js"),o=r("minimalistic-crypto-utils"),l=r("minimalistic-assert");function d(c){if(!(this instanceof d))return new d(c);this.hash=c.hash,this.predResist=!!c.predResist,this.outLen=this.hash.outSize,this.minEntropy=c.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var u=o.toArray(c.entropy,c.entropyEnc||"hex"),h=o.toArray(c.nonce,c.nonceEnc||"hex"),f=o.toArray(c.pers,c.persEnc||"hex");l(u.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(u,h,f)}s.exports=d,d.prototype._init=function(c,u,h){var f=c.concat(u).concat(h);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var m=0;m<this.V.length;m++)this.K[m]=0,this.V[m]=1;this._update(f),this._reseed=1,this.reseedInterval=281474976710656},d.prototype._hmac=function(){return new i.hmac(this.hash,this.K)},d.prototype._update=function(c){var u=this._hmac().update(this.V).update([0]);c&&(u=u.update(c)),this.K=u.digest(),this.V=this._hmac().update(this.V).digest(),c&&(this.K=this._hmac().update(this.V).update([1]).update(c).digest(),this.V=this._hmac().update(this.V).digest())},d.prototype.reseed=function(c,u,h,f){typeof u!="string"&&(f=h,h=u,u=null),c=o.toArray(c,u),h=o.toArray(h,f),l(c.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(c.concat(h||[])),this._reseed=1},d.prototype.generate=function(c,u,h,f){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof u!="string"&&(f=h,h=u,u=null),h&&(h=o.toArray(h,f||"hex"),this._update(h));for(var m=[];m.length<c;)this.V=this._hmac().update(this.V).digest(),m=m.concat(this.V);var p=m.slice(0,c);return this._update(h),this._reseed++,o.encode(p,u)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(r,s,a){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */a.read=function(i,o,l,d,c){var u,h,f=8*c-d-1,m=(1<<f)-1,p=m>>1,g=-7,x=l?c-1:0,v=l?-1:1,y=i[o+x];for(x+=v,u=y&(1<<-g)-1,y>>=-g,g+=f;g>0;u=256*u+i[o+x],x+=v,g-=8);for(h=u&(1<<-g)-1,u>>=-g,g+=d;g>0;h=256*h+i[o+x],x+=v,g-=8);if(u===0)u=1-p;else{if(u===m)return h?NaN:1/0*(y?-1:1);h+=Math.pow(2,d),u-=p}return(y?-1:1)*h*Math.pow(2,u-d)},a.write=function(i,o,l,d,c,u){var h,f,m,p=8*u-c-1,g=(1<<p)-1,x=g>>1,v=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=d?0:u-1,b=d?1:-1,j=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(f=isNaN(o)?1:0,h=g):(h=Math.floor(Math.log(o)/Math.LN2),o*(m=Math.pow(2,-h))<1&&(h--,m*=2),(o+=h+x>=1?v/m:v*Math.pow(2,1-x))*m>=2&&(h++,m/=2),h+x>=g?(f=0,h=g):h+x>=1?(f=(o*m-1)*Math.pow(2,c),h+=x):(f=o*Math.pow(2,x-1)*Math.pow(2,c),h=0));c>=8;i[l+y]=255&f,y+=b,f/=256,c-=8);for(h=h<<c|f,p+=c;p>0;i[l+y]=255&h,y+=b,h/=256,p-=8);i[l+y-b]|=128*j}},{}],440:[function(r,s,a){typeof Object.create=="function"?s.exports=function(i,o){o&&(i.super_=o,i.prototype=Object.create(o.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}))}:s.exports=function(i,o){if(o){i.super_=o;var l=function(){};l.prototype=o.prototype,i.prototype=new l,i.prototype.constructor=i}}},{}],441:[function(r,s,a){(function(i,o,l,d,c,u,h,f){(function(){/*!

	JSZip v3.10.1 - A JavaScript class for generating and reading zip files
	<http://stuartk.com/jszip>

	(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
	Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

	JSZip uses the library pako released under the MIT license :
	https://github.com/nodeca/pako/blob/main/LICENSE
	*/(function(m){typeof a=="object"&&s!==void 0?s.exports=m():(typeof window<"u"?window:o!==void 0?o:typeof self<"u"?self:this).JSZip=m()})(function(){return function m(p,g,x){function v(j,T){if(!g[j]){if(!p[j]){var O=typeof r=="function"&&r;if(!T&&O)return O(j,!0);if(y)return y(j,!0);var R=new Error("Cannot find module '"+j+"'");throw R.code="MODULE_NOT_FOUND",R}var D=g[j]={exports:{}};p[j][0].call(D.exports,function(B){return v(p[j][1][B]||B)},D,D.exports,m,p,g,x)}return g[j].exports}for(var y=typeof r=="function"&&r,b=0;b<x.length;b++)v(x[b]);return v}({1:[function(m,p,g){var x=m("./utils"),v=m("./support"),y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";g.encode=function(b){for(var j,T,O,R,D,B,q,Y=[],G=0,I=b.length,F=I,S=x.getTypeOf(b)!=="string";G<b.length;)F=I-G,O=S?(j=b[G++],T=G<I?b[G++]:0,G<I?b[G++]:0):(j=b.charCodeAt(G++),T=G<I?b.charCodeAt(G++):0,G<I?b.charCodeAt(G++):0),R=j>>2,D=(3&j)<<4|T>>4,B=1<F?(15&T)<<2|O>>6:64,q=2<F?63&O:64,Y.push(y.charAt(R)+y.charAt(D)+y.charAt(B)+y.charAt(q));return Y.join("")},g.decode=function(b){var j,T,O,R,D,B,q=0,Y=0,G="data:";if(b.substr(0,G.length)===G)throw new Error("Invalid base64 input, it looks like a data url.");var I,F=3*(b=b.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(b.charAt(b.length-1)===y.charAt(64)&&F--,b.charAt(b.length-2)===y.charAt(64)&&F--,F%1!=0)throw new Error("Invalid base64 input, bad content length.");for(I=v.uint8array?new Uint8Array(0|F):new Array(0|F);q<b.length;)j=y.indexOf(b.charAt(q++))<<2|(R=y.indexOf(b.charAt(q++)))>>4,T=(15&R)<<4|(D=y.indexOf(b.charAt(q++)))>>2,O=(3&D)<<6|(B=y.indexOf(b.charAt(q++))),I[Y++]=j,D!==64&&(I[Y++]=T),B!==64&&(I[Y++]=O);return I}},{"./support":30,"./utils":32}],2:[function(m,p,g){var x=m("./external"),v=m("./stream/DataWorker"),y=m("./stream/Crc32Probe"),b=m("./stream/DataLengthProbe");function j(T,O,R,D,B){this.compressedSize=T,this.uncompressedSize=O,this.crc32=R,this.compression=D,this.compressedContent=B}j.prototype={getContentWorker:function(){var T=new v(x.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new b("data_length")),O=this;return T.on("end",function(){if(this.streamInfo.data_length!==O.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),T},getCompressedWorker:function(){return new v(x.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},j.createWorkerFrom=function(T,O,R){return T.pipe(new y).pipe(new b("uncompressedSize")).pipe(O.compressWorker(R)).pipe(new b("compressedSize")).withStreamInfo("compression",O)},p.exports=j},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(m,p,g){var x=m("./stream/GenericWorker");g.STORE={magic:"\0\0",compressWorker:function(){return new x("STORE compression")},uncompressWorker:function(){return new x("STORE decompression")}},g.DEFLATE=m("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(m,p,g){var x=m("./utils"),v=function(){for(var y,b=[],j=0;j<256;j++){y=j;for(var T=0;T<8;T++)y=1&y?3988292384^y>>>1:y>>>1;b[j]=y}return b}();p.exports=function(y,b){return y!==void 0&&y.length?x.getTypeOf(y)!=="string"?function(j,T,O,R){var D=v,B=0+O;j^=-1;for(var q=0;q<B;q++)j=j>>>8^D[255&(j^T[q])];return-1^j}(0|b,y,y.length):function(j,T,O,R){var D=v,B=0+O;j^=-1;for(var q=0;q<B;q++)j=j>>>8^D[255&(j^T.charCodeAt(q))];return-1^j}(0|b,y,y.length):0}},{"./utils":32}],5:[function(m,p,g){g.base64=!1,g.binary=!1,g.dir=!1,g.createFolders=!0,g.date=null,g.compression=null,g.compressionOptions=null,g.comment=null,g.unixPermissions=null,g.dosPermissions=null},{}],6:[function(m,p,g){var x;x=typeof Promise<"u"?Promise:m("lie"),p.exports={Promise:x}},{lie:37}],7:[function(m,p,g){var x=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",v=m("pako"),y=m("./utils"),b=m("./stream/GenericWorker"),j=x?"uint8array":"array";function T(O,R){b.call(this,"FlateWorker/"+O),this._pako=null,this._pakoAction=O,this._pakoOptions=R,this.meta={}}g.magic="\b\0",y.inherits(T,b),T.prototype.processChunk=function(O){this.meta=O.meta,this._pako===null&&this._createPako(),this._pako.push(y.transformTo(j,O.data),!1)},T.prototype.flush=function(){b.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},T.prototype.cleanUp=function(){b.prototype.cleanUp.call(this),this._pako=null},T.prototype._createPako=function(){this._pako=new v[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var O=this;this._pako.onData=function(R){O.push({data:R,meta:O.meta})}},g.compressWorker=function(O){return new T("Deflate",O)},g.uncompressWorker=function(){return new T("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(m,p,g){function x(D,B){var q,Y="";for(q=0;q<B;q++)Y+=String.fromCharCode(255&D),D>>>=8;return Y}function v(D,B,q,Y,G,I){var F,S,E=D.file,N=D.compression,C=I!==j.utf8encode,k=y.transformTo("string",I(E.name)),M=y.transformTo("string",j.utf8encode(E.name)),U=E.comment,$=y.transformTo("string",I(U)),X=y.transformTo("string",j.utf8encode(U)),Z=M.length!==E.name.length,re=X.length!==U.length,W="",J="",V="",H=E.dir,ee=E.date,ie={crc32:0,compressedSize:0,uncompressedSize:0};B&&!q||(ie.crc32=D.crc32,ie.compressedSize=D.compressedSize,ie.uncompressedSize=D.uncompressedSize);var oe=0;B&&(oe|=8),C||!Z&&!re||(oe|=2048);var se=0,ue=0;H&&(se|=16),G==="UNIX"?(ue=798,se|=function(ce,ne){var me=ce;return ce||(me=ne?16893:33204),(65535&me)<<16}(E.unixPermissions,H)):(ue=20,se|=function(ce){return 63&(ce||0)}(E.dosPermissions)),F=ee.getUTCHours(),F<<=6,F|=ee.getUTCMinutes(),F<<=5,F|=ee.getUTCSeconds()/2,S=ee.getUTCFullYear()-1980,S<<=4,S|=ee.getUTCMonth()+1,S<<=5,S|=ee.getUTCDate(),Z&&(J=x(1,1)+x(T(k),4)+M,W+="up"+x(J.length,2)+J),re&&(V=x(1,1)+x(T($),4)+X,W+="uc"+x(V.length,2)+V);var pe="";return pe+=`
\0`,pe+=x(oe,2),pe+=N.magic,pe+=x(F,2),pe+=x(S,2),pe+=x(ie.crc32,4),pe+=x(ie.compressedSize,4),pe+=x(ie.uncompressedSize,4),pe+=x(k.length,2),pe+=x(W.length,2),{fileRecord:O.LOCAL_FILE_HEADER+pe+k+W,dirRecord:O.CENTRAL_FILE_HEADER+x(ue,2)+pe+x($.length,2)+"\0\0\0\0"+x(se,4)+x(Y,4)+k+W+$}}var y=m("../utils"),b=m("../stream/GenericWorker"),j=m("../utf8"),T=m("../crc32"),O=m("../signature");function R(D,B,q,Y){b.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=B,this.zipPlatform=q,this.encodeFileName=Y,this.streamFiles=D,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}y.inherits(R,b),R.prototype.push=function(D){var B=D.meta.percent||0,q=this.entriesCount,Y=this._sources.length;this.accumulate?this.contentBuffer.push(D):(this.bytesWritten+=D.data.length,b.prototype.push.call(this,{data:D.data,meta:{currentFile:this.currentFile,percent:q?(B+100*(q-Y-1))/q:100}}))},R.prototype.openedSource=function(D){this.currentSourceOffset=this.bytesWritten,this.currentFile=D.file.name;var B=this.streamFiles&&!D.file.dir;if(B){var q=v(D,B,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:q.fileRecord,meta:{percent:0}})}else this.accumulate=!0},R.prototype.closedSource=function(D){this.accumulate=!1;var B=this.streamFiles&&!D.file.dir,q=v(D,B,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(q.dirRecord),B)this.push({data:function(Y){return O.DATA_DESCRIPTOR+x(Y.crc32,4)+x(Y.compressedSize,4)+x(Y.uncompressedSize,4)}(D),meta:{percent:100}});else for(this.push({data:q.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},R.prototype.flush=function(){for(var D=this.bytesWritten,B=0;B<this.dirRecords.length;B++)this.push({data:this.dirRecords[B],meta:{percent:100}});var q=this.bytesWritten-D,Y=function(G,I,F,S,E){var N=y.transformTo("string",E(S));return O.CENTRAL_DIRECTORY_END+"\0\0\0\0"+x(G,2)+x(G,2)+x(I,4)+x(F,4)+x(N.length,2)+N}(this.dirRecords.length,q,D,this.zipComment,this.encodeFileName);this.push({data:Y,meta:{percent:100}})},R.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},R.prototype.registerPrevious=function(D){this._sources.push(D);var B=this;return D.on("data",function(q){B.processChunk(q)}),D.on("end",function(){B.closedSource(B.previous.streamInfo),B._sources.length?B.prepareNextSource():B.end()}),D.on("error",function(q){B.error(q)}),this},R.prototype.resume=function(){return!!b.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},R.prototype.error=function(D){var B=this._sources;if(!b.prototype.error.call(this,D))return!1;for(var q=0;q<B.length;q++)try{B[q].error(D)}catch{}return!0},R.prototype.lock=function(){b.prototype.lock.call(this);for(var D=this._sources,B=0;B<D.length;B++)D[B].lock()},p.exports=R},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(m,p,g){var x=m("../compressions"),v=m("./ZipFileWorker");g.generateWorker=function(y,b,j){var T=new v(b.streamFiles,j,b.platform,b.encodeFileName),O=0;try{y.forEach(function(R,D){O++;var B=function(I,F){var S=I||F,E=x[S];if(!E)throw new Error(S+" is not a valid compression method !");return E}(D.options.compression,b.compression),q=D.options.compressionOptions||b.compressionOptions||{},Y=D.dir,G=D.date;D._compressWorker(B,q).withStreamInfo("file",{name:R,dir:Y,date:G,comment:D.comment||"",unixPermissions:D.unixPermissions,dosPermissions:D.dosPermissions}).pipe(T)}),T.entriesCount=O}catch(R){T.error(R)}return T}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(m,p,g){function x(){if(!(this instanceof x))return new x;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var v=new x;for(var y in this)typeof this[y]!="function"&&(v[y]=this[y]);return v}}(x.prototype=m("./object")).loadAsync=m("./load"),x.support=m("./support"),x.defaults=m("./defaults"),x.version="3.10.1",x.loadAsync=function(v,y){return new x().loadAsync(v,y)},x.external=m("./external"),p.exports=x},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(m,p,g){var x=m("./utils"),v=m("./external"),y=m("./utf8"),b=m("./zipEntries"),j=m("./stream/Crc32Probe"),T=m("./nodejsUtils");function O(R){return new v.Promise(function(D,B){var q=R.decompressed.getContentWorker().pipe(new j);q.on("error",function(Y){B(Y)}).on("end",function(){q.streamInfo.crc32!==R.decompressed.crc32?B(new Error("Corrupted zip : CRC32 mismatch")):D()}).resume()})}p.exports=function(R,D){var B=this;return D=x.extend(D||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:y.utf8decode}),T.isNode&&T.isStream(R)?v.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):x.prepareContent("the loaded zip file",R,!0,D.optimizedBinaryString,D.base64).then(function(q){var Y=new b(D);return Y.load(q),Y}).then(function(q){var Y=[v.Promise.resolve(q)],G=q.files;if(D.checkCRC32)for(var I=0;I<G.length;I++)Y.push(O(G[I]));return v.Promise.all(Y)}).then(function(q){for(var Y=q.shift(),G=Y.files,I=0;I<G.length;I++){var F=G[I],S=F.fileNameStr,E=x.resolve(F.fileNameStr);B.file(E,F.decompressed,{binary:!0,optimizedBinaryString:!0,date:F.date,dir:F.dir,comment:F.fileCommentStr.length?F.fileCommentStr:null,unixPermissions:F.unixPermissions,dosPermissions:F.dosPermissions,createFolders:D.createFolders}),F.dir||(B.file(E).unsafeOriginalName=S)}return Y.zipComment.length&&(B.comment=Y.zipComment),B})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(m,p,g){var x=m("../utils"),v=m("../stream/GenericWorker");function y(b,j){v.call(this,"Nodejs stream input adapter for "+b),this._upstreamEnded=!1,this._bindStream(j)}x.inherits(y,v),y.prototype._bindStream=function(b){var j=this;(this._stream=b).pause(),b.on("data",function(T){j.push({data:T,meta:{percent:0}})}).on("error",function(T){j.isPaused?this.generatedError=T:j.error(T)}).on("end",function(){j.isPaused?j._upstreamEnded=!0:j.end()})},y.prototype.pause=function(){return!!v.prototype.pause.call(this)&&(this._stream.pause(),!0)},y.prototype.resume=function(){return!!v.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},p.exports=y},{"../stream/GenericWorker":28,"../utils":32}],13:[function(m,p,g){var x=m("readable-stream").Readable;function v(y,b,j){x.call(this,b),this._helper=y;var T=this;y.on("data",function(O,R){T.push(O)||T._helper.pause(),j&&j(R)}).on("error",function(O){T.emit("error",O)}).on("end",function(){T.push(null)})}m("../utils").inherits(v,x),v.prototype._read=function(){this._helper.resume()},p.exports=v},{"../utils":32,"readable-stream":16}],14:[function(m,p,g){p.exports={isNode:l!==void 0,newBufferFrom:function(x,v){if(l.from&&l.from!==Uint8Array.from)return l.from(x,v);if(typeof x=="number")throw new Error('The "data" argument must not be a number');return new l(x,v)},allocBuffer:function(x){if(l.alloc)return l.alloc(x);var v=new l(x);return v.fill(0),v},isBuffer:function(x){return l.isBuffer(x)},isStream:function(x){return x&&typeof x.on=="function"&&typeof x.pause=="function"&&typeof x.resume=="function"}}},{}],15:[function(m,p,g){function x(E,N,C){var k,M=y.getTypeOf(N),U=y.extend(C||{},T);U.date=U.date||new Date,U.compression!==null&&(U.compression=U.compression.toUpperCase()),typeof U.unixPermissions=="string"&&(U.unixPermissions=parseInt(U.unixPermissions,8)),U.unixPermissions&&16384&U.unixPermissions&&(U.dir=!0),U.dosPermissions&&16&U.dosPermissions&&(U.dir=!0),U.dir&&(E=G(E)),U.createFolders&&(k=Y(E))&&I.call(this,k,!0);var $=M==="string"&&U.binary===!1&&U.base64===!1;C&&C.binary!==void 0||(U.binary=!$),(N instanceof O&&N.uncompressedSize===0||U.dir||!N||N.length===0)&&(U.base64=!1,U.binary=!0,N="",U.compression="STORE",M="string");var X;X=N instanceof O||N instanceof b?N:B.isNode&&B.isStream(N)?new q(E,N):y.prepareContent(E,N,U.binary,U.optimizedBinaryString,U.base64);var Z=new R(E,X,U);this.files[E]=Z}var v=m("./utf8"),y=m("./utils"),b=m("./stream/GenericWorker"),j=m("./stream/StreamHelper"),T=m("./defaults"),O=m("./compressedObject"),R=m("./zipObject"),D=m("./generate"),B=m("./nodejsUtils"),q=m("./nodejs/NodejsStreamInputAdapter"),Y=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var N=E.lastIndexOf("/");return 0<N?E.substring(0,N):""},G=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},I=function(E,N){return N=N!==void 0?N:T.createFolders,E=G(E),this.files[E]||x.call(this,E,null,{dir:!0,createFolders:N}),this.files[E]};function F(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var S={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var N,C,k;for(N in this.files)k=this.files[N],(C=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&E(C,k)},filter:function(E){var N=[];return this.forEach(function(C,k){E(C,k)&&N.push(k)}),N},file:function(E,N,C){if(arguments.length!==1)return E=this.root+E,x.call(this,E,N,C),this;if(F(E)){var k=E;return this.filter(function(U,$){return!$.dir&&k.test(U)})}var M=this.files[this.root+E];return M&&!M.dir?M:null},folder:function(E){if(!E)return this;if(F(E))return this.filter(function(M,U){return U.dir&&E.test(M)});var N=this.root+E,C=I.call(this,N),k=this.clone();return k.root=C.name,k},remove:function(E){E=this.root+E;var N=this.files[E];if(N||(E.slice(-1)!=="/"&&(E+="/"),N=this.files[E]),N&&!N.dir)delete this.files[E];else for(var C=this.filter(function(M,U){return U.name.slice(0,E.length)===E}),k=0;k<C.length;k++)delete this.files[C[k].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var N,C={};try{if((C=y.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:v.utf8encode})).type=C.type.toLowerCase(),C.compression=C.compression.toUpperCase(),C.type==="binarystring"&&(C.type="string"),!C.type)throw new Error("No output type specified.");y.checkSupport(C.type),C.platform!=="darwin"&&C.platform!=="freebsd"&&C.platform!=="linux"&&C.platform!=="sunos"||(C.platform="UNIX"),C.platform==="win32"&&(C.platform="DOS");var k=C.comment||this.comment||"";N=D.generateWorker(this,C,k)}catch(M){(N=new b("error")).error(M)}return new j(N,C.type||"string",C.mimeType)},generateAsync:function(E,N){return this.generateInternalStream(E).accumulate(N)},generateNodeStream:function(E,N){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(N)}};p.exports=S},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(m,p,g){p.exports=m("stream")},{stream:void 0}],17:[function(m,p,g){var x=m("./DataReader");function v(y){x.call(this,y);for(var b=0;b<this.data.length;b++)y[b]=255&y[b]}m("../utils").inherits(v,x),v.prototype.byteAt=function(y){return this.data[this.zero+y]},v.prototype.lastIndexOfSignature=function(y){for(var b=y.charCodeAt(0),j=y.charCodeAt(1),T=y.charCodeAt(2),O=y.charCodeAt(3),R=this.length-4;0<=R;--R)if(this.data[R]===b&&this.data[R+1]===j&&this.data[R+2]===T&&this.data[R+3]===O)return R-this.zero;return-1},v.prototype.readAndCheckSignature=function(y){var b=y.charCodeAt(0),j=y.charCodeAt(1),T=y.charCodeAt(2),O=y.charCodeAt(3),R=this.readData(4);return b===R[0]&&j===R[1]&&T===R[2]&&O===R[3]},v.prototype.readData=function(y){if(this.checkOffset(y),y===0)return[];var b=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},p.exports=v},{"../utils":32,"./DataReader":18}],18:[function(m,p,g){var x=m("../utils");function v(y){this.data=y,this.length=y.length,this.index=0,this.zero=0}v.prototype={checkOffset:function(y){this.checkIndex(this.index+y)},checkIndex:function(y){if(this.length<this.zero+y||y<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+y+"). Corrupted zip ?")},setIndex:function(y){this.checkIndex(y),this.index=y},skip:function(y){this.setIndex(this.index+y)},byteAt:function(){},readInt:function(y){var b,j=0;for(this.checkOffset(y),b=this.index+y-1;b>=this.index;b--)j=(j<<8)+this.byteAt(b);return this.index+=y,j},readString:function(y){return x.transformTo("string",this.readData(y))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var y=this.readInt(4);return new Date(Date.UTC(1980+(y>>25&127),(y>>21&15)-1,y>>16&31,y>>11&31,y>>5&63,(31&y)<<1))}},p.exports=v},{"../utils":32}],19:[function(m,p,g){var x=m("./Uint8ArrayReader");function v(y){x.call(this,y)}m("../utils").inherits(v,x),v.prototype.readData=function(y){this.checkOffset(y);var b=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},p.exports=v},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(m,p,g){var x=m("./DataReader");function v(y){x.call(this,y)}m("../utils").inherits(v,x),v.prototype.byteAt=function(y){return this.data.charCodeAt(this.zero+y)},v.prototype.lastIndexOfSignature=function(y){return this.data.lastIndexOf(y)-this.zero},v.prototype.readAndCheckSignature=function(y){return y===this.readData(4)},v.prototype.readData=function(y){this.checkOffset(y);var b=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},p.exports=v},{"../utils":32,"./DataReader":18}],21:[function(m,p,g){var x=m("./ArrayReader");function v(y){x.call(this,y)}m("../utils").inherits(v,x),v.prototype.readData=function(y){if(this.checkOffset(y),y===0)return new Uint8Array(0);var b=this.data.subarray(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},p.exports=v},{"../utils":32,"./ArrayReader":17}],22:[function(m,p,g){var x=m("../utils"),v=m("../support"),y=m("./ArrayReader"),b=m("./StringReader"),j=m("./NodeBufferReader"),T=m("./Uint8ArrayReader");p.exports=function(O){var R=x.getTypeOf(O);return x.checkSupport(R),R!=="string"||v.uint8array?R==="nodebuffer"?new j(O):v.uint8array?new T(x.transformTo("uint8array",O)):new y(x.transformTo("array",O)):new b(O)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(m,p,g){g.LOCAL_FILE_HEADER="PK",g.CENTRAL_FILE_HEADER="PK",g.CENTRAL_DIRECTORY_END="PK",g.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",g.ZIP64_CENTRAL_DIRECTORY_END="PK",g.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(m,p,g){var x=m("./GenericWorker"),v=m("../utils");function y(b){x.call(this,"ConvertWorker to "+b),this.destType=b}v.inherits(y,x),y.prototype.processChunk=function(b){this.push({data:v.transformTo(this.destType,b.data),meta:b.meta})},p.exports=y},{"../utils":32,"./GenericWorker":28}],25:[function(m,p,g){var x=m("./GenericWorker"),v=m("../crc32");function y(){x.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}m("../utils").inherits(y,x),y.prototype.processChunk=function(b){this.streamInfo.crc32=v(b.data,this.streamInfo.crc32||0),this.push(b)},p.exports=y},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(m,p,g){var x=m("../utils"),v=m("./GenericWorker");function y(b){v.call(this,"DataLengthProbe for "+b),this.propName=b,this.withStreamInfo(b,0)}x.inherits(y,v),y.prototype.processChunk=function(b){if(b){var j=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=j+b.data.length}v.prototype.processChunk.call(this,b)},p.exports=y},{"../utils":32,"./GenericWorker":28}],27:[function(m,p,g){var x=m("../utils"),v=m("./GenericWorker");function y(b){v.call(this,"DataWorker");var j=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,b.then(function(T){j.dataIsReady=!0,j.data=T,j.max=T&&T.length||0,j.type=x.getTypeOf(T),j.isPaused||j._tickAndRepeat()},function(T){j.error(T)})}x.inherits(y,v),y.prototype.cleanUp=function(){v.prototype.cleanUp.call(this),this.data=null},y.prototype.resume=function(){return!!v.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,x.delay(this._tickAndRepeat,[],this)),!0)},y.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(x.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},y.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var b=null,j=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":b=this.data.substring(this.index,j);break;case"uint8array":b=this.data.subarray(this.index,j);break;case"array":case"nodebuffer":b=this.data.slice(this.index,j)}return this.index=j,this.push({data:b,meta:{percent:this.max?this.index/this.max*100:0}})},p.exports=y},{"../utils":32,"./GenericWorker":28}],28:[function(m,p,g){function x(v){this.name=v||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}x.prototype={push:function(v){this.emit("data",v)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(v){this.emit("error",v)}return!0},error:function(v){return!this.isFinished&&(this.isPaused?this.generatedError=v:(this.isFinished=!0,this.emit("error",v),this.previous&&this.previous.error(v),this.cleanUp()),!0)},on:function(v,y){return this._listeners[v].push(y),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(v,y){if(this._listeners[v])for(var b=0;b<this._listeners[v].length;b++)this._listeners[v][b].call(this,y)},pipe:function(v){return v.registerPrevious(this)},registerPrevious:function(v){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=v.streamInfo,this.mergeStreamInfo(),this.previous=v;var y=this;return v.on("data",function(b){y.processChunk(b)}),v.on("end",function(){y.end()}),v.on("error",function(b){y.error(b)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var v=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),v=!0),this.previous&&this.previous.resume(),!v},flush:function(){},processChunk:function(v){this.push(v)},withStreamInfo:function(v,y){return this.extraStreamInfo[v]=y,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var v in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,v)&&(this.streamInfo[v]=this.extraStreamInfo[v])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var v="Worker "+this.name;return this.previous?this.previous+" -> "+v:v}},p.exports=x},{}],29:[function(m,p,g){var x=m("../utils"),v=m("./ConvertWorker"),y=m("./GenericWorker"),b=m("../base64"),j=m("../support"),T=m("../external"),O=null;if(j.nodestream)try{O=m("../nodejs/NodejsStreamOutputAdapter")}catch{}function R(D,B,q){var Y=B;switch(B){case"blob":case"arraybuffer":Y="uint8array";break;case"base64":Y="string"}try{this._internalType=Y,this._outputType=B,this._mimeType=q,x.checkSupport(Y),this._worker=D.pipe(new v(Y)),D.lock()}catch(G){this._worker=new y("error"),this._worker.error(G)}}R.prototype={accumulate:function(D){return function(B,q){return new T.Promise(function(Y,G){var I=[],F=B._internalType,S=B._outputType,E=B._mimeType;B.on("data",function(N,C){I.push(N),q&&q(C)}).on("error",function(N){I=[],G(N)}).on("end",function(){try{var N=function(C,k,M){switch(C){case"blob":return x.newBlob(x.transformTo("arraybuffer",k),M);case"base64":return b.encode(k);default:return x.transformTo(C,k)}}(S,function(C,k){var M,U=0,$=null,X=0;for(M=0;M<k.length;M++)X+=k[M].length;switch(C){case"string":return k.join("");case"array":return Array.prototype.concat.apply([],k);case"uint8array":for($=new Uint8Array(X),M=0;M<k.length;M++)$.set(k[M],U),U+=k[M].length;return $;case"nodebuffer":return l.concat(k);default:throw new Error("concat : unsupported type '"+C+"'")}}(F,I),E);Y(N)}catch(C){G(C)}I=[]}).resume()})}(this,D)},on:function(D,B){var q=this;return D==="data"?this._worker.on(D,function(Y){B.call(q,Y.data,Y.meta)}):this._worker.on(D,function(){x.delay(B,arguments,q)}),this},resume:function(){return x.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(D){if(x.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new O(this,{objectMode:this._outputType!=="nodebuffer"},D)}},p.exports=R},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(m,p,g){if(g.base64=!0,g.array=!0,g.string=!0,g.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",g.nodebuffer=l!==void 0,g.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")g.blob=!1;else{var x=new ArrayBuffer(0);try{g.blob=new Blob([x],{type:"application/zip"}).size===0}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);v.append(x),g.blob=v.getBlob("application/zip").size===0}catch{g.blob=!1}}}try{g.nodestream=!!m("readable-stream").Readable}catch{g.nodestream=!1}},{"readable-stream":16}],31:[function(m,p,g){for(var x=m("./utils"),v=m("./support"),y=m("./nodejsUtils"),b=m("./stream/GenericWorker"),j=new Array(256),T=0;T<256;T++)j[T]=252<=T?6:248<=T?5:240<=T?4:224<=T?3:192<=T?2:1;function O(){b.call(this,"utf-8 decode"),this.leftOver=null}function R(){b.call(this,"utf-8 encode")}j[254]=j[254]=1,g.utf8encode=function(D){return v.nodebuffer?y.newBufferFrom(D,"utf-8"):function(B){var q,Y,G,I,F,S=B.length,E=0;for(I=0;I<S;I++)(64512&(Y=B.charCodeAt(I)))==55296&&I+1<S&&(64512&(G=B.charCodeAt(I+1)))==56320&&(Y=65536+(Y-55296<<10)+(G-56320),I++),E+=Y<128?1:Y<2048?2:Y<65536?3:4;for(q=v.uint8array?new Uint8Array(E):new Array(E),I=F=0;F<E;I++)(64512&(Y=B.charCodeAt(I)))==55296&&I+1<S&&(64512&(G=B.charCodeAt(I+1)))==56320&&(Y=65536+(Y-55296<<10)+(G-56320),I++),Y<128?q[F++]=Y:(Y<2048?q[F++]=192|Y>>>6:(Y<65536?q[F++]=224|Y>>>12:(q[F++]=240|Y>>>18,q[F++]=128|Y>>>12&63),q[F++]=128|Y>>>6&63),q[F++]=128|63&Y);return q}(D)},g.utf8decode=function(D){return v.nodebuffer?x.transformTo("nodebuffer",D).toString("utf-8"):function(B){var q,Y,G,I,F=B.length,S=new Array(2*F);for(q=Y=0;q<F;)if((G=B[q++])<128)S[Y++]=G;else if(4<(I=j[G]))S[Y++]=65533,q+=I-1;else{for(G&=I===2?31:I===3?15:7;1<I&&q<F;)G=G<<6|63&B[q++],I--;1<I?S[Y++]=65533:G<65536?S[Y++]=G:(G-=65536,S[Y++]=55296|G>>10&1023,S[Y++]=56320|1023&G)}return S.length!==Y&&(S.subarray?S=S.subarray(0,Y):S.length=Y),x.applyFromCharCode(S)}(D=x.transformTo(v.uint8array?"uint8array":"array",D))},x.inherits(O,b),O.prototype.processChunk=function(D){var B=x.transformTo(v.uint8array?"uint8array":"array",D.data);if(this.leftOver&&this.leftOver.length){if(v.uint8array){var q=B;(B=new Uint8Array(q.length+this.leftOver.length)).set(this.leftOver,0),B.set(q,this.leftOver.length)}else B=this.leftOver.concat(B);this.leftOver=null}var Y=function(I,F){var S;for((F=F||I.length)>I.length&&(F=I.length),S=F-1;0<=S&&(192&I[S])==128;)S--;return S<0||S===0?F:S+j[I[S]]>F?S:F}(B),G=B;Y!==B.length&&(v.uint8array?(G=B.subarray(0,Y),this.leftOver=B.subarray(Y,B.length)):(G=B.slice(0,Y),this.leftOver=B.slice(Y,B.length))),this.push({data:g.utf8decode(G),meta:D.meta})},O.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:g.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},g.Utf8DecodeWorker=O,x.inherits(R,b),R.prototype.processChunk=function(D){this.push({data:g.utf8encode(D.data),meta:D.meta})},g.Utf8EncodeWorker=R},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(m,p,g){var x=m("./support"),v=m("./base64"),y=m("./nodejsUtils"),b=m("./external");function j(q){return q}function T(q,Y){for(var G=0;G<q.length;++G)Y[G]=255&q.charCodeAt(G);return Y}m("setimmediate"),g.newBlob=function(q,Y){g.checkSupport("blob");try{return new Blob([q],{type:Y})}catch{try{var G=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return G.append(q),G.getBlob(Y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var O={stringifyByChunk:function(q,Y,G){var I=[],F=0,S=q.length;if(S<=G)return String.fromCharCode.apply(null,q);for(;F<S;)Y==="array"||Y==="nodebuffer"?I.push(String.fromCharCode.apply(null,q.slice(F,Math.min(F+G,S)))):I.push(String.fromCharCode.apply(null,q.subarray(F,Math.min(F+G,S)))),F+=G;return I.join("")},stringifyByChar:function(q){for(var Y="",G=0;G<q.length;G++)Y+=String.fromCharCode(q[G]);return Y},applyCanBeUsed:{uint8array:function(){try{return x.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return x.nodebuffer&&String.fromCharCode.apply(null,y.allocBuffer(1)).length===1}catch{return!1}}()}};function R(q){var Y=65536,G=g.getTypeOf(q),I=!0;if(G==="uint8array"?I=O.applyCanBeUsed.uint8array:G==="nodebuffer"&&(I=O.applyCanBeUsed.nodebuffer),I)for(;1<Y;)try{return O.stringifyByChunk(q,G,Y)}catch{Y=Math.floor(Y/2)}return O.stringifyByChar(q)}function D(q,Y){for(var G=0;G<q.length;G++)Y[G]=q[G];return Y}g.applyFromCharCode=R;var B={};B.string={string:j,array:function(q){return T(q,new Array(q.length))},arraybuffer:function(q){return B.string.uint8array(q).buffer},uint8array:function(q){return T(q,new Uint8Array(q.length))},nodebuffer:function(q){return T(q,y.allocBuffer(q.length))}},B.array={string:R,array:j,arraybuffer:function(q){return new Uint8Array(q).buffer},uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return y.newBufferFrom(q)}},B.arraybuffer={string:function(q){return R(new Uint8Array(q))},array:function(q){return D(new Uint8Array(q),new Array(q.byteLength))},arraybuffer:j,uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return y.newBufferFrom(new Uint8Array(q))}},B.uint8array={string:R,array:function(q){return D(q,new Array(q.length))},arraybuffer:function(q){return q.buffer},uint8array:j,nodebuffer:function(q){return y.newBufferFrom(q)}},B.nodebuffer={string:R,array:function(q){return D(q,new Array(q.length))},arraybuffer:function(q){return B.nodebuffer.uint8array(q).buffer},uint8array:function(q){return D(q,new Uint8Array(q.length))},nodebuffer:j},g.transformTo=function(q,Y){if(Y=Y||"",!q)return Y;g.checkSupport(q);var G=g.getTypeOf(Y);return B[G][q](Y)},g.resolve=function(q){for(var Y=q.split("/"),G=[],I=0;I<Y.length;I++){var F=Y[I];F==="."||F===""&&I!==0&&I!==Y.length-1||(F===".."?G.pop():G.push(F))}return G.join("/")},g.getTypeOf=function(q){return typeof q=="string"?"string":Object.prototype.toString.call(q)==="[object Array]"?"array":x.nodebuffer&&y.isBuffer(q)?"nodebuffer":x.uint8array&&q instanceof Uint8Array?"uint8array":x.arraybuffer&&q instanceof ArrayBuffer?"arraybuffer":void 0},g.checkSupport=function(q){if(!x[q.toLowerCase()])throw new Error(q+" is not supported by this platform")},g.MAX_VALUE_16BITS=65535,g.MAX_VALUE_32BITS=-1,g.pretty=function(q){var Y,G,I="";for(G=0;G<(q||"").length;G++)I+="\\x"+((Y=q.charCodeAt(G))<16?"0":"")+Y.toString(16).toUpperCase();return I},g.delay=function(q,Y,G){f(function(){q.apply(G||null,Y||[])})},g.inherits=function(q,Y){function G(){}G.prototype=Y.prototype,q.prototype=new G},g.extend=function(){var q,Y,G={};for(q=0;q<arguments.length;q++)for(Y in arguments[q])Object.prototype.hasOwnProperty.call(arguments[q],Y)&&G[Y]===void 0&&(G[Y]=arguments[q][Y]);return G},g.prepareContent=function(q,Y,G,I,F){return b.Promise.resolve(Y).then(function(S){return x.blob&&(S instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(S))!==-1)&&typeof FileReader<"u"?new b.Promise(function(E,N){var C=new FileReader;C.onload=function(k){E(k.target.result)},C.onerror=function(k){N(k.target.error)},C.readAsArrayBuffer(S)}):S}).then(function(S){var E=g.getTypeOf(S);return E?(E==="arraybuffer"?S=g.transformTo("uint8array",S):E==="string"&&(F?S=v.decode(S):G&&I!==!0&&(S=function(N){return T(N,x.uint8array?new Uint8Array(N.length):new Array(N.length))}(S))),S):b.Promise.reject(new Error("Can't read the data of '"+q+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(m,p,g){var x=m("./reader/readerFor"),v=m("./utils"),y=m("./signature"),b=m("./zipEntry"),j=m("./support");function T(O){this.files=[],this.loadOptions=O}T.prototype={checkSignature:function(O){if(!this.reader.readAndCheckSignature(O)){this.reader.index-=4;var R=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+v.pretty(R)+", expected "+v.pretty(O)+")")}},isSignature:function(O,R){var D=this.reader.index;this.reader.setIndex(O);var B=this.reader.readString(4)===R;return this.reader.setIndex(D),B},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var O=this.reader.readData(this.zipCommentLength),R=j.uint8array?"uint8array":"array",D=v.transformTo(R,O);this.zipComment=this.loadOptions.decodeFileName(D)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var O,R,D,B=this.zip64EndOfCentralSize-44;0<B;)O=this.reader.readInt(2),R=this.reader.readInt(4),D=this.reader.readData(R),this.zip64ExtensibleData[O]={id:O,length:R,value:D}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var O,R;for(O=0;O<this.files.length;O++)R=this.files[O],this.reader.setIndex(R.localHeaderOffset),this.checkSignature(y.LOCAL_FILE_HEADER),R.readLocalPart(this.reader),R.handleUTF8(),R.processAttributes()},readCentralDir:function(){var O;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(y.CENTRAL_FILE_HEADER);)(O=new b({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(O);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var O=this.reader.lastIndexOfSignature(y.CENTRAL_DIRECTORY_END);if(O<0)throw this.isSignature(0,y.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(O);var R=O;if(this.checkSignature(y.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===v.MAX_VALUE_16BITS||this.diskWithCentralDirStart===v.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===v.MAX_VALUE_16BITS||this.centralDirRecords===v.MAX_VALUE_16BITS||this.centralDirSize===v.MAX_VALUE_32BITS||this.centralDirOffset===v.MAX_VALUE_32BITS){if(this.zip64=!0,(O=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(O),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,y.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var D=this.centralDirOffset+this.centralDirSize;this.zip64&&(D+=20,D+=12+this.zip64EndOfCentralSize);var B=R-D;if(0<B)this.isSignature(R,y.CENTRAL_FILE_HEADER)||(this.reader.zero=B);else if(B<0)throw new Error("Corrupted zip: missing "+Math.abs(B)+" bytes.")},prepareReader:function(O){this.reader=x(O)},load:function(O){this.prepareReader(O),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},p.exports=T},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(m,p,g){var x=m("./reader/readerFor"),v=m("./utils"),y=m("./compressedObject"),b=m("./crc32"),j=m("./utf8"),T=m("./compressions"),O=m("./support");function R(D,B){this.options=D,this.loadOptions=B}R.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(D){var B,q;if(D.skip(22),this.fileNameLength=D.readInt(2),q=D.readInt(2),this.fileName=D.readData(this.fileNameLength),D.skip(q),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((B=function(Y){for(var G in T)if(Object.prototype.hasOwnProperty.call(T,G)&&T[G].magic===Y)return T[G];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+v.pretty(this.compressionMethod)+" unknown (inner file : "+v.transformTo("string",this.fileName)+")");this.decompressed=new y(this.compressedSize,this.uncompressedSize,this.crc32,B,D.readData(this.compressedSize))},readCentralPart:function(D){this.versionMadeBy=D.readInt(2),D.skip(2),this.bitFlag=D.readInt(2),this.compressionMethod=D.readString(2),this.date=D.readDate(),this.crc32=D.readInt(4),this.compressedSize=D.readInt(4),this.uncompressedSize=D.readInt(4);var B=D.readInt(2);if(this.extraFieldsLength=D.readInt(2),this.fileCommentLength=D.readInt(2),this.diskNumberStart=D.readInt(2),this.internalFileAttributes=D.readInt(2),this.externalFileAttributes=D.readInt(4),this.localHeaderOffset=D.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");D.skip(B),this.readExtraFields(D),this.parseZIP64ExtraField(D),this.fileComment=D.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var D=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),D==0&&(this.dosPermissions=63&this.externalFileAttributes),D==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var D=x(this.extraFields[1].value);this.uncompressedSize===v.MAX_VALUE_32BITS&&(this.uncompressedSize=D.readInt(8)),this.compressedSize===v.MAX_VALUE_32BITS&&(this.compressedSize=D.readInt(8)),this.localHeaderOffset===v.MAX_VALUE_32BITS&&(this.localHeaderOffset=D.readInt(8)),this.diskNumberStart===v.MAX_VALUE_32BITS&&(this.diskNumberStart=D.readInt(4))}},readExtraFields:function(D){var B,q,Y,G=D.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});D.index+4<G;)B=D.readInt(2),q=D.readInt(2),Y=D.readData(q),this.extraFields[B]={id:B,length:q,value:Y};D.setIndex(G)},handleUTF8:function(){var D=O.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=j.utf8decode(this.fileName),this.fileCommentStr=j.utf8decode(this.fileComment);else{var B=this.findExtraFieldUnicodePath();if(B!==null)this.fileNameStr=B;else{var q=v.transformTo(D,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(q)}var Y=this.findExtraFieldUnicodeComment();if(Y!==null)this.fileCommentStr=Y;else{var G=v.transformTo(D,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(G)}}},findExtraFieldUnicodePath:function(){var D=this.extraFields[28789];if(D){var B=x(D.value);return B.readInt(1)!==1||b(this.fileName)!==B.readInt(4)?null:j.utf8decode(B.readData(D.length-5))}return null},findExtraFieldUnicodeComment:function(){var D=this.extraFields[25461];if(D){var B=x(D.value);return B.readInt(1)!==1||b(this.fileComment)!==B.readInt(4)?null:j.utf8decode(B.readData(D.length-5))}return null}},p.exports=R},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(m,p,g){function x(B,q,Y){this.name=B,this.dir=Y.dir,this.date=Y.date,this.comment=Y.comment,this.unixPermissions=Y.unixPermissions,this.dosPermissions=Y.dosPermissions,this._data=q,this._dataBinary=Y.binary,this.options={compression:Y.compression,compressionOptions:Y.compressionOptions}}var v=m("./stream/StreamHelper"),y=m("./stream/DataWorker"),b=m("./utf8"),j=m("./compressedObject"),T=m("./stream/GenericWorker");x.prototype={internalStream:function(B){var q=null,Y="string";try{if(!B)throw new Error("No output type specified.");var G=(Y=B.toLowerCase())==="string"||Y==="text";Y!=="binarystring"&&Y!=="text"||(Y="string"),q=this._decompressWorker();var I=!this._dataBinary;I&&!G&&(q=q.pipe(new b.Utf8EncodeWorker)),!I&&G&&(q=q.pipe(new b.Utf8DecodeWorker))}catch(F){(q=new T("error")).error(F)}return new v(q,Y,"")},async:function(B,q){return this.internalStream(B).accumulate(q)},nodeStream:function(B,q){return this.internalStream(B||"nodebuffer").toNodejsStream(q)},_compressWorker:function(B,q){if(this._data instanceof j&&this._data.compression.magic===B.magic)return this._data.getCompressedWorker();var Y=this._decompressWorker();return this._dataBinary||(Y=Y.pipe(new b.Utf8EncodeWorker)),j.createWorkerFrom(Y,B,q)},_decompressWorker:function(){return this._data instanceof j?this._data.getContentWorker():this._data instanceof T?this._data:new y(this._data)}};for(var O=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],R=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},D=0;D<O.length;D++)x.prototype[O[D]]=R;p.exports=x},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(m,p,g){(function(x){var v,y,b=x.MutationObserver||x.WebKitMutationObserver;if(b){var j=0,T=new b(B),O=x.document.createTextNode("");T.observe(O,{characterData:!0}),v=function(){O.data=j=++j%2}}else if(x.setImmediate||x.MessageChannel===void 0)v="document"in x&&"onreadystatechange"in x.document.createElement("script")?function(){var q=x.document.createElement("script");q.onreadystatechange=function(){B(),q.onreadystatechange=null,q.parentNode.removeChild(q),q=null},x.document.documentElement.appendChild(q)}:function(){setTimeout(B,0)};else{var R=new x.MessageChannel;R.port1.onmessage=B,v=function(){R.port2.postMessage(0)}}var D=[];function B(){var q,Y;y=!0;for(var G=D.length;G;){for(Y=D,D=[],q=-1;++q<G;)Y[q]();G=D.length}y=!1}p.exports=function(q){D.push(q)!==1||y||v()}}).call(this,o!==void 0?o:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(m,p,g){var x=m("immediate");function v(){}var y={},b=["REJECTED"],j=["FULFILLED"],T=["PENDING"];function O(G){if(typeof G!="function")throw new TypeError("resolver must be a function");this.state=T,this.queue=[],this.outcome=void 0,G!==v&&q(this,G)}function R(G,I,F){this.promise=G,typeof I=="function"&&(this.onFulfilled=I,this.callFulfilled=this.otherCallFulfilled),typeof F=="function"&&(this.onRejected=F,this.callRejected=this.otherCallRejected)}function D(G,I,F){x(function(){var S;try{S=I(F)}catch(E){return y.reject(G,E)}S===G?y.reject(G,new TypeError("Cannot resolve promise with itself")):y.resolve(G,S)})}function B(G){var I=G&&G.then;if(G&&(typeof G=="object"||typeof G=="function")&&typeof I=="function")return function(){I.apply(G,arguments)}}function q(G,I){var F=!1;function S(C){F||(F=!0,y.reject(G,C))}function E(C){F||(F=!0,y.resolve(G,C))}var N=Y(function(){I(E,S)});N.status==="error"&&S(N.value)}function Y(G,I){var F={};try{F.value=G(I),F.status="success"}catch(S){F.status="error",F.value=S}return F}(p.exports=O).prototype.finally=function(G){if(typeof G!="function")return this;var I=this.constructor;return this.then(function(F){return I.resolve(G()).then(function(){return F})},function(F){return I.resolve(G()).then(function(){throw F})})},O.prototype.catch=function(G){return this.then(null,G)},O.prototype.then=function(G,I){if(typeof G!="function"&&this.state===j||typeof I!="function"&&this.state===b)return this;var F=new this.constructor(v);return this.state!==T?D(F,this.state===j?G:I,this.outcome):this.queue.push(new R(F,G,I)),F},R.prototype.callFulfilled=function(G){y.resolve(this.promise,G)},R.prototype.otherCallFulfilled=function(G){D(this.promise,this.onFulfilled,G)},R.prototype.callRejected=function(G){y.reject(this.promise,G)},R.prototype.otherCallRejected=function(G){D(this.promise,this.onRejected,G)},y.resolve=function(G,I){var F=Y(B,I);if(F.status==="error")return y.reject(G,F.value);var S=F.value;if(S)q(G,S);else{G.state=j,G.outcome=I;for(var E=-1,N=G.queue.length;++E<N;)G.queue[E].callFulfilled(I)}return G},y.reject=function(G,I){G.state=b,G.outcome=I;for(var F=-1,S=G.queue.length;++F<S;)G.queue[F].callRejected(I);return G},O.resolve=function(G){return G instanceof this?G:y.resolve(new this(v),G)},O.reject=function(G){var I=new this(v);return y.reject(I,G)},O.all=function(G){var I=this;if(Object.prototype.toString.call(G)!=="[object Array]")return this.reject(new TypeError("must be an array"));var F=G.length,S=!1;if(!F)return this.resolve([]);for(var E=new Array(F),N=0,C=-1,k=new this(v);++C<F;)M(G[C],C);return k;function M(U,$){I.resolve(U).then(function(X){E[$]=X,++N!==F||S||(S=!0,y.resolve(k,E))},function(X){S||(S=!0,y.reject(k,X))})}},O.race=function(G){if(Object.prototype.toString.call(G)!=="[object Array]")return this.reject(new TypeError("must be an array"));var I=G.length,F=!1;if(!I)return this.resolve([]);for(var S,E=-1,N=new this(v);++E<I;)S=G[E],this.resolve(S).then(function(C){F||(F=!0,y.resolve(N,C))},function(C){F||(F=!0,y.reject(N,C))});return N}},{immediate:36}],38:[function(m,p,g){var x={};(0,m("./lib/utils/common").assign)(x,m("./lib/deflate"),m("./lib/inflate"),m("./lib/zlib/constants")),p.exports=x},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(m,p,g){var x=m("./zlib/deflate"),v=m("./utils/common"),y=m("./utils/strings"),b=m("./zlib/messages"),j=m("./zlib/zstream"),T=Object.prototype.toString;function O(D){if(!(this instanceof O))return new O(D);this.options=v.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},D||{});var B=this.options;B.raw&&0<B.windowBits?B.windowBits=-B.windowBits:B.gzip&&0<B.windowBits&&B.windowBits<16&&(B.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new j,this.strm.avail_out=0;var q=x.deflateInit2(this.strm,B.level,B.method,B.windowBits,B.memLevel,B.strategy);if(q!==0)throw new Error(b[q]);if(B.header&&x.deflateSetHeader(this.strm,B.header),B.dictionary){var Y;if(Y=typeof B.dictionary=="string"?y.string2buf(B.dictionary):T.call(B.dictionary)==="[object ArrayBuffer]"?new Uint8Array(B.dictionary):B.dictionary,(q=x.deflateSetDictionary(this.strm,Y))!==0)throw new Error(b[q]);this._dict_set=!0}}function R(D,B){var q=new O(B);if(q.push(D,!0),q.err)throw q.msg||b[q.err];return q.result}O.prototype.push=function(D,B){var q,Y,G=this.strm,I=this.options.chunkSize;if(this.ended)return!1;Y=B===~~B?B:B===!0?4:0,typeof D=="string"?G.input=y.string2buf(D):T.call(D)==="[object ArrayBuffer]"?G.input=new Uint8Array(D):G.input=D,G.next_in=0,G.avail_in=G.input.length;do{if(G.avail_out===0&&(G.output=new v.Buf8(I),G.next_out=0,G.avail_out=I),(q=x.deflate(G,Y))!==1&&q!==0)return this.onEnd(q),!(this.ended=!0);G.avail_out!==0&&(G.avail_in!==0||Y!==4&&Y!==2)||(this.options.to==="string"?this.onData(y.buf2binstring(v.shrinkBuf(G.output,G.next_out))):this.onData(v.shrinkBuf(G.output,G.next_out)))}while((0<G.avail_in||G.avail_out===0)&&q!==1);return Y===4?(q=x.deflateEnd(this.strm),this.onEnd(q),this.ended=!0,q===0):Y!==2||(this.onEnd(0),!(G.avail_out=0))},O.prototype.onData=function(D){this.chunks.push(D)},O.prototype.onEnd=function(D){D===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=D,this.msg=this.strm.msg},g.Deflate=O,g.deflate=R,g.deflateRaw=function(D,B){return(B=B||{}).raw=!0,R(D,B)},g.gzip=function(D,B){return(B=B||{}).gzip=!0,R(D,B)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(m,p,g){var x=m("./zlib/inflate"),v=m("./utils/common"),y=m("./utils/strings"),b=m("./zlib/constants"),j=m("./zlib/messages"),T=m("./zlib/zstream"),O=m("./zlib/gzheader"),R=Object.prototype.toString;function D(q){if(!(this instanceof D))return new D(q);this.options=v.assign({chunkSize:16384,windowBits:0,to:""},q||{});var Y=this.options;Y.raw&&0<=Y.windowBits&&Y.windowBits<16&&(Y.windowBits=-Y.windowBits,Y.windowBits===0&&(Y.windowBits=-15)),!(0<=Y.windowBits&&Y.windowBits<16)||q&&q.windowBits||(Y.windowBits+=32),15<Y.windowBits&&Y.windowBits<48&&!(15&Y.windowBits)&&(Y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new T,this.strm.avail_out=0;var G=x.inflateInit2(this.strm,Y.windowBits);if(G!==b.Z_OK)throw new Error(j[G]);this.header=new O,x.inflateGetHeader(this.strm,this.header)}function B(q,Y){var G=new D(Y);if(G.push(q,!0),G.err)throw G.msg||j[G.err];return G.result}D.prototype.push=function(q,Y){var G,I,F,S,E,N,C=this.strm,k=this.options.chunkSize,M=this.options.dictionary,U=!1;if(this.ended)return!1;I=Y===~~Y?Y:Y===!0?b.Z_FINISH:b.Z_NO_FLUSH,typeof q=="string"?C.input=y.binstring2buf(q):R.call(q)==="[object ArrayBuffer]"?C.input=new Uint8Array(q):C.input=q,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new v.Buf8(k),C.next_out=0,C.avail_out=k),(G=x.inflate(C,b.Z_NO_FLUSH))===b.Z_NEED_DICT&&M&&(N=typeof M=="string"?y.string2buf(M):R.call(M)==="[object ArrayBuffer]"?new Uint8Array(M):M,G=x.inflateSetDictionary(this.strm,N)),G===b.Z_BUF_ERROR&&U===!0&&(G=b.Z_OK,U=!1),G!==b.Z_STREAM_END&&G!==b.Z_OK)return this.onEnd(G),!(this.ended=!0);C.next_out&&(C.avail_out!==0&&G!==b.Z_STREAM_END&&(C.avail_in!==0||I!==b.Z_FINISH&&I!==b.Z_SYNC_FLUSH)||(this.options.to==="string"?(F=y.utf8border(C.output,C.next_out),S=C.next_out-F,E=y.buf2string(C.output,F),C.next_out=S,C.avail_out=k-S,S&&v.arraySet(C.output,C.output,F,S,0),this.onData(E)):this.onData(v.shrinkBuf(C.output,C.next_out)))),C.avail_in===0&&C.avail_out===0&&(U=!0)}while((0<C.avail_in||C.avail_out===0)&&G!==b.Z_STREAM_END);return G===b.Z_STREAM_END&&(I=b.Z_FINISH),I===b.Z_FINISH?(G=x.inflateEnd(this.strm),this.onEnd(G),this.ended=!0,G===b.Z_OK):I!==b.Z_SYNC_FLUSH||(this.onEnd(b.Z_OK),!(C.avail_out=0))},D.prototype.onData=function(q){this.chunks.push(q)},D.prototype.onEnd=function(q){q===b.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=v.flattenChunks(this.chunks)),this.chunks=[],this.err=q,this.msg=this.strm.msg},g.Inflate=D,g.inflate=B,g.inflateRaw=function(q,Y){return(Y=Y||{}).raw=!0,B(q,Y)},g.ungzip=B},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(m,p,g){var x=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";g.assign=function(b){for(var j=Array.prototype.slice.call(arguments,1);j.length;){var T=j.shift();if(T){if(typeof T!="object")throw new TypeError(T+"must be non-object");for(var O in T)T.hasOwnProperty(O)&&(b[O]=T[O])}}return b},g.shrinkBuf=function(b,j){return b.length===j?b:b.subarray?b.subarray(0,j):(b.length=j,b)};var v={arraySet:function(b,j,T,O,R){if(j.subarray&&b.subarray)b.set(j.subarray(T,T+O),R);else for(var D=0;D<O;D++)b[R+D]=j[T+D]},flattenChunks:function(b){var j,T,O,R,D,B;for(j=O=0,T=b.length;j<T;j++)O+=b[j].length;for(B=new Uint8Array(O),j=R=0,T=b.length;j<T;j++)D=b[j],B.set(D,R),R+=D.length;return B}},y={arraySet:function(b,j,T,O,R){for(var D=0;D<O;D++)b[R+D]=j[T+D]},flattenChunks:function(b){return[].concat.apply([],b)}};g.setTyped=function(b){b?(g.Buf8=Uint8Array,g.Buf16=Uint16Array,g.Buf32=Int32Array,g.assign(g,v)):(g.Buf8=Array,g.Buf16=Array,g.Buf32=Array,g.assign(g,y))},g.setTyped(x)},{}],42:[function(m,p,g){var x=m("./common"),v=!0,y=!0;try{String.fromCharCode.apply(null,[0])}catch{v=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{y=!1}for(var b=new x.Buf8(256),j=0;j<256;j++)b[j]=252<=j?6:248<=j?5:240<=j?4:224<=j?3:192<=j?2:1;function T(O,R){if(R<65537&&(O.subarray&&y||!O.subarray&&v))return String.fromCharCode.apply(null,x.shrinkBuf(O,R));for(var D="",B=0;B<R;B++)D+=String.fromCharCode(O[B]);return D}b[254]=b[254]=1,g.string2buf=function(O){var R,D,B,q,Y,G=O.length,I=0;for(q=0;q<G;q++)(64512&(D=O.charCodeAt(q)))==55296&&q+1<G&&(64512&(B=O.charCodeAt(q+1)))==56320&&(D=65536+(D-55296<<10)+(B-56320),q++),I+=D<128?1:D<2048?2:D<65536?3:4;for(R=new x.Buf8(I),q=Y=0;Y<I;q++)(64512&(D=O.charCodeAt(q)))==55296&&q+1<G&&(64512&(B=O.charCodeAt(q+1)))==56320&&(D=65536+(D-55296<<10)+(B-56320),q++),D<128?R[Y++]=D:(D<2048?R[Y++]=192|D>>>6:(D<65536?R[Y++]=224|D>>>12:(R[Y++]=240|D>>>18,R[Y++]=128|D>>>12&63),R[Y++]=128|D>>>6&63),R[Y++]=128|63&D);return R},g.buf2binstring=function(O){return T(O,O.length)},g.binstring2buf=function(O){for(var R=new x.Buf8(O.length),D=0,B=R.length;D<B;D++)R[D]=O.charCodeAt(D);return R},g.buf2string=function(O,R){var D,B,q,Y,G=R||O.length,I=new Array(2*G);for(D=B=0;D<G;)if((q=O[D++])<128)I[B++]=q;else if(4<(Y=b[q]))I[B++]=65533,D+=Y-1;else{for(q&=Y===2?31:Y===3?15:7;1<Y&&D<G;)q=q<<6|63&O[D++],Y--;1<Y?I[B++]=65533:q<65536?I[B++]=q:(q-=65536,I[B++]=55296|q>>10&1023,I[B++]=56320|1023&q)}return T(I,B)},g.utf8border=function(O,R){var D;for((R=R||O.length)>O.length&&(R=O.length),D=R-1;0<=D&&(192&O[D])==128;)D--;return D<0||D===0?R:D+b[O[D]]>R?D:R}},{"./common":41}],43:[function(m,p,g){p.exports=function(x,v,y,b){for(var j=65535&x|0,T=x>>>16&65535|0,O=0;y!==0;){for(y-=O=2e3<y?2e3:y;T=T+(j=j+v[b++]|0)|0,--O;);j%=65521,T%=65521}return j|T<<16|0}},{}],44:[function(m,p,g){p.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(m,p,g){var x=function(){for(var v,y=[],b=0;b<256;b++){v=b;for(var j=0;j<8;j++)v=1&v?3988292384^v>>>1:v>>>1;y[b]=v}return y}();p.exports=function(v,y,b,j){var T=x,O=j+b;v^=-1;for(var R=j;R<O;R++)v=v>>>8^T[255&(v^y[R])];return-1^v}},{}],46:[function(m,p,g){var x,v=m("../utils/common"),y=m("./trees"),b=m("./adler32"),j=m("./crc32"),T=m("./messages"),O=-2,R=258,D=262,B=113;function q(W,J){return W.msg=T[J],J}function Y(W){return(W<<1)-(4<W?9:0)}function G(W){for(var J=W.length;0<=--J;)W[J]=0}function I(W){var J=W.state,V=J.pending;V>W.avail_out&&(V=W.avail_out),V!==0&&(v.arraySet(W.output,J.pending_buf,J.pending_out,V,W.next_out),W.next_out+=V,J.pending_out+=V,W.total_out+=V,W.avail_out-=V,J.pending-=V,J.pending===0&&(J.pending_out=0))}function F(W,J){y._tr_flush_block(W,0<=W.block_start?W.block_start:-1,W.strstart-W.block_start,J),W.block_start=W.strstart,I(W.strm)}function S(W,J){W.pending_buf[W.pending++]=J}function E(W,J){W.pending_buf[W.pending++]=J>>>8&255,W.pending_buf[W.pending++]=255&J}function N(W,J){var V,H,ee=W.max_chain_length,ie=W.strstart,oe=W.prev_length,se=W.nice_match,ue=W.strstart>W.w_size-D?W.strstart-(W.w_size-D):0,pe=W.window,ce=W.w_mask,ne=W.prev,me=W.strstart+R,ge=pe[ie+oe-1],_e=pe[ie+oe];W.prev_length>=W.good_match&&(ee>>=2),se>W.lookahead&&(se=W.lookahead);do if(pe[(V=J)+oe]===_e&&pe[V+oe-1]===ge&&pe[V]===pe[ie]&&pe[++V]===pe[ie+1]){ie+=2,V++;do;while(pe[++ie]===pe[++V]&&pe[++ie]===pe[++V]&&pe[++ie]===pe[++V]&&pe[++ie]===pe[++V]&&pe[++ie]===pe[++V]&&pe[++ie]===pe[++V]&&pe[++ie]===pe[++V]&&pe[++ie]===pe[++V]&&ie<me);if(H=R-(me-ie),ie=me-R,oe<H){if(W.match_start=J,se<=(oe=H))break;ge=pe[ie+oe-1],_e=pe[ie+oe]}}while((J=ne[J&ce])>ue&&--ee!=0);return oe<=W.lookahead?oe:W.lookahead}function C(W){var J,V,H,ee,ie,oe,se,ue,pe,ce,ne=W.w_size;do{if(ee=W.window_size-W.lookahead-W.strstart,W.strstart>=ne+(ne-D)){for(v.arraySet(W.window,W.window,ne,ne,0),W.match_start-=ne,W.strstart-=ne,W.block_start-=ne,J=V=W.hash_size;H=W.head[--J],W.head[J]=ne<=H?H-ne:0,--V;);for(J=V=ne;H=W.prev[--J],W.prev[J]=ne<=H?H-ne:0,--V;);ee+=ne}if(W.strm.avail_in===0)break;if(oe=W.strm,se=W.window,ue=W.strstart+W.lookahead,ce=void 0,(pe=ee)<(ce=oe.avail_in)&&(ce=pe),V=ce===0?0:(oe.avail_in-=ce,v.arraySet(se,oe.input,oe.next_in,ce,ue),oe.state.wrap===1?oe.adler=b(oe.adler,se,ce,ue):oe.state.wrap===2&&(oe.adler=j(oe.adler,se,ce,ue)),oe.next_in+=ce,oe.total_in+=ce,ce),W.lookahead+=V,W.lookahead+W.insert>=3)for(ie=W.strstart-W.insert,W.ins_h=W.window[ie],W.ins_h=(W.ins_h<<W.hash_shift^W.window[ie+1])&W.hash_mask;W.insert&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[ie+3-1])&W.hash_mask,W.prev[ie&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=ie,ie++,W.insert--,!(W.lookahead+W.insert<3)););}while(W.lookahead<D&&W.strm.avail_in!==0)}function k(W,J){for(var V,H;;){if(W.lookahead<D){if(C(W),W.lookahead<D&&J===0)return 1;if(W.lookahead===0)break}if(V=0,W.lookahead>=3&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+3-1])&W.hash_mask,V=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),V!==0&&W.strstart-V<=W.w_size-D&&(W.match_length=N(W,V)),W.match_length>=3)if(H=y._tr_tally(W,W.strstart-W.match_start,W.match_length-3),W.lookahead-=W.match_length,W.match_length<=W.max_lazy_match&&W.lookahead>=3){for(W.match_length--;W.strstart++,W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+3-1])&W.hash_mask,V=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart,--W.match_length!=0;);W.strstart++}else W.strstart+=W.match_length,W.match_length=0,W.ins_h=W.window[W.strstart],W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+1])&W.hash_mask;else H=y._tr_tally(W,0,W.window[W.strstart]),W.lookahead--,W.strstart++;if(H&&(F(W,!1),W.strm.avail_out===0))return 1}return W.insert=W.strstart<2?W.strstart:2,J===4?(F(W,!0),W.strm.avail_out===0?3:4):W.last_lit&&(F(W,!1),W.strm.avail_out===0)?1:2}function M(W,J){for(var V,H,ee;;){if(W.lookahead<D){if(C(W),W.lookahead<D&&J===0)return 1;if(W.lookahead===0)break}if(V=0,W.lookahead>=3&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+3-1])&W.hash_mask,V=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),W.prev_length=W.match_length,W.prev_match=W.match_start,W.match_length=2,V!==0&&W.prev_length<W.max_lazy_match&&W.strstart-V<=W.w_size-D&&(W.match_length=N(W,V),W.match_length<=5&&(W.strategy===1||W.match_length===3&&4096<W.strstart-W.match_start)&&(W.match_length=2)),W.prev_length>=3&&W.match_length<=W.prev_length){for(ee=W.strstart+W.lookahead-3,H=y._tr_tally(W,W.strstart-1-W.prev_match,W.prev_length-3),W.lookahead-=W.prev_length-1,W.prev_length-=2;++W.strstart<=ee&&(W.ins_h=(W.ins_h<<W.hash_shift^W.window[W.strstart+3-1])&W.hash_mask,V=W.prev[W.strstart&W.w_mask]=W.head[W.ins_h],W.head[W.ins_h]=W.strstart),--W.prev_length!=0;);if(W.match_available=0,W.match_length=2,W.strstart++,H&&(F(W,!1),W.strm.avail_out===0))return 1}else if(W.match_available){if((H=y._tr_tally(W,0,W.window[W.strstart-1]))&&F(W,!1),W.strstart++,W.lookahead--,W.strm.avail_out===0)return 1}else W.match_available=1,W.strstart++,W.lookahead--}return W.match_available&&(H=y._tr_tally(W,0,W.window[W.strstart-1]),W.match_available=0),W.insert=W.strstart<2?W.strstart:2,J===4?(F(W,!0),W.strm.avail_out===0?3:4):W.last_lit&&(F(W,!1),W.strm.avail_out===0)?1:2}function U(W,J,V,H,ee){this.good_length=W,this.max_lazy=J,this.nice_length=V,this.max_chain=H,this.func=ee}function $(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new v.Buf16(1146),this.dyn_dtree=new v.Buf16(122),this.bl_tree=new v.Buf16(78),G(this.dyn_ltree),G(this.dyn_dtree),G(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new v.Buf16(16),this.heap=new v.Buf16(573),G(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new v.Buf16(573),G(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function X(W){var J;return W&&W.state?(W.total_in=W.total_out=0,W.data_type=2,(J=W.state).pending=0,J.pending_out=0,J.wrap<0&&(J.wrap=-J.wrap),J.status=J.wrap?42:B,W.adler=J.wrap===2?0:1,J.last_flush=0,y._tr_init(J),0):q(W,O)}function Z(W){var J=X(W);return J===0&&function(V){V.window_size=2*V.w_size,G(V.head),V.max_lazy_match=x[V.level].max_lazy,V.good_match=x[V.level].good_length,V.nice_match=x[V.level].nice_length,V.max_chain_length=x[V.level].max_chain,V.strstart=0,V.block_start=0,V.lookahead=0,V.insert=0,V.match_length=V.prev_length=2,V.match_available=0,V.ins_h=0}(W.state),J}function re(W,J,V,H,ee,ie){if(!W)return O;var oe=1;if(J===-1&&(J=6),H<0?(oe=0,H=-H):15<H&&(oe=2,H-=16),ee<1||9<ee||V!==8||H<8||15<H||J<0||9<J||ie<0||4<ie)return q(W,O);H===8&&(H=9);var se=new $;return(W.state=se).strm=W,se.wrap=oe,se.gzhead=null,se.w_bits=H,se.w_size=1<<se.w_bits,se.w_mask=se.w_size-1,se.hash_bits=ee+7,se.hash_size=1<<se.hash_bits,se.hash_mask=se.hash_size-1,se.hash_shift=~~((se.hash_bits+3-1)/3),se.window=new v.Buf8(2*se.w_size),se.head=new v.Buf16(se.hash_size),se.prev=new v.Buf16(se.w_size),se.lit_bufsize=1<<ee+6,se.pending_buf_size=4*se.lit_bufsize,se.pending_buf=new v.Buf8(se.pending_buf_size),se.d_buf=1*se.lit_bufsize,se.l_buf=3*se.lit_bufsize,se.level=J,se.strategy=ie,se.method=V,Z(W)}x=[new U(0,0,0,0,function(W,J){var V=65535;for(V>W.pending_buf_size-5&&(V=W.pending_buf_size-5);;){if(W.lookahead<=1){if(C(W),W.lookahead===0&&J===0)return 1;if(W.lookahead===0)break}W.strstart+=W.lookahead,W.lookahead=0;var H=W.block_start+V;if((W.strstart===0||W.strstart>=H)&&(W.lookahead=W.strstart-H,W.strstart=H,F(W,!1),W.strm.avail_out===0)||W.strstart-W.block_start>=W.w_size-D&&(F(W,!1),W.strm.avail_out===0))return 1}return W.insert=0,J===4?(F(W,!0),W.strm.avail_out===0?3:4):(W.strstart>W.block_start&&(F(W,!1),W.strm.avail_out),1)}),new U(4,4,8,4,k),new U(4,5,16,8,k),new U(4,6,32,32,k),new U(4,4,16,16,M),new U(8,16,32,32,M),new U(8,16,128,128,M),new U(8,32,128,256,M),new U(32,128,258,1024,M),new U(32,258,258,4096,M)],g.deflateInit=function(W,J){return re(W,J,8,15,8,0)},g.deflateInit2=re,g.deflateReset=Z,g.deflateResetKeep=X,g.deflateSetHeader=function(W,J){return W&&W.state?W.state.wrap!==2?O:(W.state.gzhead=J,0):O},g.deflate=function(W,J){var V,H,ee,ie;if(!W||!W.state||5<J||J<0)return W?q(W,O):O;if(H=W.state,!W.output||!W.input&&W.avail_in!==0||H.status===666&&J!==4)return q(W,W.avail_out===0?-5:O);if(H.strm=W,V=H.last_flush,H.last_flush=J,H.status===42)if(H.wrap===2)W.adler=0,S(H,31),S(H,139),S(H,8),H.gzhead?(S(H,(H.gzhead.text?1:0)+(H.gzhead.hcrc?2:0)+(H.gzhead.extra?4:0)+(H.gzhead.name?8:0)+(H.gzhead.comment?16:0)),S(H,255&H.gzhead.time),S(H,H.gzhead.time>>8&255),S(H,H.gzhead.time>>16&255),S(H,H.gzhead.time>>24&255),S(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),S(H,255&H.gzhead.os),H.gzhead.extra&&H.gzhead.extra.length&&(S(H,255&H.gzhead.extra.length),S(H,H.gzhead.extra.length>>8&255)),H.gzhead.hcrc&&(W.adler=j(W.adler,H.pending_buf,H.pending,0)),H.gzindex=0,H.status=69):(S(H,0),S(H,0),S(H,0),S(H,0),S(H,0),S(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),S(H,3),H.status=B);else{var oe=8+(H.w_bits-8<<4)<<8;oe|=(2<=H.strategy||H.level<2?0:H.level<6?1:H.level===6?2:3)<<6,H.strstart!==0&&(oe|=32),oe+=31-oe%31,H.status=B,E(H,oe),H.strstart!==0&&(E(H,W.adler>>>16),E(H,65535&W.adler)),W.adler=1}if(H.status===69)if(H.gzhead.extra){for(ee=H.pending;H.gzindex<(65535&H.gzhead.extra.length)&&(H.pending!==H.pending_buf_size||(H.gzhead.hcrc&&H.pending>ee&&(W.adler=j(W.adler,H.pending_buf,H.pending-ee,ee)),I(W),ee=H.pending,H.pending!==H.pending_buf_size));)S(H,255&H.gzhead.extra[H.gzindex]),H.gzindex++;H.gzhead.hcrc&&H.pending>ee&&(W.adler=j(W.adler,H.pending_buf,H.pending-ee,ee)),H.gzindex===H.gzhead.extra.length&&(H.gzindex=0,H.status=73)}else H.status=73;if(H.status===73)if(H.gzhead.name){ee=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>ee&&(W.adler=j(W.adler,H.pending_buf,H.pending-ee,ee)),I(W),ee=H.pending,H.pending===H.pending_buf_size)){ie=1;break}ie=H.gzindex<H.gzhead.name.length?255&H.gzhead.name.charCodeAt(H.gzindex++):0,S(H,ie)}while(ie!==0);H.gzhead.hcrc&&H.pending>ee&&(W.adler=j(W.adler,H.pending_buf,H.pending-ee,ee)),ie===0&&(H.gzindex=0,H.status=91)}else H.status=91;if(H.status===91)if(H.gzhead.comment){ee=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>ee&&(W.adler=j(W.adler,H.pending_buf,H.pending-ee,ee)),I(W),ee=H.pending,H.pending===H.pending_buf_size)){ie=1;break}ie=H.gzindex<H.gzhead.comment.length?255&H.gzhead.comment.charCodeAt(H.gzindex++):0,S(H,ie)}while(ie!==0);H.gzhead.hcrc&&H.pending>ee&&(W.adler=j(W.adler,H.pending_buf,H.pending-ee,ee)),ie===0&&(H.status=103)}else H.status=103;if(H.status===103&&(H.gzhead.hcrc?(H.pending+2>H.pending_buf_size&&I(W),H.pending+2<=H.pending_buf_size&&(S(H,255&W.adler),S(H,W.adler>>8&255),W.adler=0,H.status=B)):H.status=B),H.pending!==0){if(I(W),W.avail_out===0)return H.last_flush=-1,0}else if(W.avail_in===0&&Y(J)<=Y(V)&&J!==4)return q(W,-5);if(H.status===666&&W.avail_in!==0)return q(W,-5);if(W.avail_in!==0||H.lookahead!==0||J!==0&&H.status!==666){var se=H.strategy===2?function(ue,pe){for(var ce;;){if(ue.lookahead===0&&(C(ue),ue.lookahead===0)){if(pe===0)return 1;break}if(ue.match_length=0,ce=y._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++,ce&&(F(ue,!1),ue.strm.avail_out===0))return 1}return ue.insert=0,pe===4?(F(ue,!0),ue.strm.avail_out===0?3:4):ue.last_lit&&(F(ue,!1),ue.strm.avail_out===0)?1:2}(H,J):H.strategy===3?function(ue,pe){for(var ce,ne,me,ge,_e=ue.window;;){if(ue.lookahead<=R){if(C(ue),ue.lookahead<=R&&pe===0)return 1;if(ue.lookahead===0)break}if(ue.match_length=0,ue.lookahead>=3&&0<ue.strstart&&(ne=_e[me=ue.strstart-1])===_e[++me]&&ne===_e[++me]&&ne===_e[++me]){ge=ue.strstart+R;do;while(ne===_e[++me]&&ne===_e[++me]&&ne===_e[++me]&&ne===_e[++me]&&ne===_e[++me]&&ne===_e[++me]&&ne===_e[++me]&&ne===_e[++me]&&me<ge);ue.match_length=R-(ge-me),ue.match_length>ue.lookahead&&(ue.match_length=ue.lookahead)}if(ue.match_length>=3?(ce=y._tr_tally(ue,1,ue.match_length-3),ue.lookahead-=ue.match_length,ue.strstart+=ue.match_length,ue.match_length=0):(ce=y._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++),ce&&(F(ue,!1),ue.strm.avail_out===0))return 1}return ue.insert=0,pe===4?(F(ue,!0),ue.strm.avail_out===0?3:4):ue.last_lit&&(F(ue,!1),ue.strm.avail_out===0)?1:2}(H,J):x[H.level].func(H,J);if(se!==3&&se!==4||(H.status=666),se===1||se===3)return W.avail_out===0&&(H.last_flush=-1),0;if(se===2&&(J===1?y._tr_align(H):J!==5&&(y._tr_stored_block(H,0,0,!1),J===3&&(G(H.head),H.lookahead===0&&(H.strstart=0,H.block_start=0,H.insert=0))),I(W),W.avail_out===0))return H.last_flush=-1,0}return J!==4?0:H.wrap<=0?1:(H.wrap===2?(S(H,255&W.adler),S(H,W.adler>>8&255),S(H,W.adler>>16&255),S(H,W.adler>>24&255),S(H,255&W.total_in),S(H,W.total_in>>8&255),S(H,W.total_in>>16&255),S(H,W.total_in>>24&255)):(E(H,W.adler>>>16),E(H,65535&W.adler)),I(W),0<H.wrap&&(H.wrap=-H.wrap),H.pending!==0?0:1)},g.deflateEnd=function(W){var J;return W&&W.state?(J=W.state.status)!==42&&J!==69&&J!==73&&J!==91&&J!==103&&J!==B&&J!==666?q(W,O):(W.state=null,J===B?q(W,-3):0):O},g.deflateSetDictionary=function(W,J){var V,H,ee,ie,oe,se,ue,pe,ce=J.length;if(!W||!W.state||(ie=(V=W.state).wrap)===2||ie===1&&V.status!==42||V.lookahead)return O;for(ie===1&&(W.adler=b(W.adler,J,ce,0)),V.wrap=0,ce>=V.w_size&&(ie===0&&(G(V.head),V.strstart=0,V.block_start=0,V.insert=0),pe=new v.Buf8(V.w_size),v.arraySet(pe,J,ce-V.w_size,V.w_size,0),J=pe,ce=V.w_size),oe=W.avail_in,se=W.next_in,ue=W.input,W.avail_in=ce,W.next_in=0,W.input=J,C(V);V.lookahead>=3;){for(H=V.strstart,ee=V.lookahead-2;V.ins_h=(V.ins_h<<V.hash_shift^V.window[H+3-1])&V.hash_mask,V.prev[H&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=H,H++,--ee;);V.strstart=H,V.lookahead=2,C(V)}return V.strstart+=V.lookahead,V.block_start=V.strstart,V.insert=V.lookahead,V.lookahead=0,V.match_length=V.prev_length=2,V.match_available=0,W.next_in=se,W.input=ue,W.avail_in=oe,V.wrap=ie,0},g.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(m,p,g){p.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(m,p,g){p.exports=function(x,v){var y,b,j,T,O,R,D,B,q,Y,G,I,F,S,E,N,C,k,M,U,$,X,Z,re,W;y=x.state,b=x.next_in,re=x.input,j=b+(x.avail_in-5),T=x.next_out,W=x.output,O=T-(v-x.avail_out),R=T+(x.avail_out-257),D=y.dmax,B=y.wsize,q=y.whave,Y=y.wnext,G=y.window,I=y.hold,F=y.bits,S=y.lencode,E=y.distcode,N=(1<<y.lenbits)-1,C=(1<<y.distbits)-1;e:do{F<15&&(I+=re[b++]<<F,F+=8,I+=re[b++]<<F,F+=8),k=S[I&N];t:for(;;){if(I>>>=M=k>>>24,F-=M,(M=k>>>16&255)==0)W[T++]=65535&k;else{if(!(16&M)){if(!(64&M)){k=S[(65535&k)+(I&(1<<M)-1)];continue t}if(32&M){y.mode=12;break e}x.msg="invalid literal/length code",y.mode=30;break e}U=65535&k,(M&=15)&&(F<M&&(I+=re[b++]<<F,F+=8),U+=I&(1<<M)-1,I>>>=M,F-=M),F<15&&(I+=re[b++]<<F,F+=8,I+=re[b++]<<F,F+=8),k=E[I&C];r:for(;;){if(I>>>=M=k>>>24,F-=M,!(16&(M=k>>>16&255))){if(!(64&M)){k=E[(65535&k)+(I&(1<<M)-1)];continue r}x.msg="invalid distance code",y.mode=30;break e}if($=65535&k,F<(M&=15)&&(I+=re[b++]<<F,(F+=8)<M&&(I+=re[b++]<<F,F+=8)),D<($+=I&(1<<M)-1)){x.msg="invalid distance too far back",y.mode=30;break e}if(I>>>=M,F-=M,(M=T-O)<$){if(q<(M=$-M)&&y.sane){x.msg="invalid distance too far back",y.mode=30;break e}if(Z=G,(X=0)===Y){if(X+=B-M,M<U){for(U-=M;W[T++]=G[X++],--M;);X=T-$,Z=W}}else if(Y<M){if(X+=B+Y-M,(M-=Y)<U){for(U-=M;W[T++]=G[X++],--M;);if(X=0,Y<U){for(U-=M=Y;W[T++]=G[X++],--M;);X=T-$,Z=W}}}else if(X+=Y-M,M<U){for(U-=M;W[T++]=G[X++],--M;);X=T-$,Z=W}for(;2<U;)W[T++]=Z[X++],W[T++]=Z[X++],W[T++]=Z[X++],U-=3;U&&(W[T++]=Z[X++],1<U&&(W[T++]=Z[X++]))}else{for(X=T-$;W[T++]=W[X++],W[T++]=W[X++],W[T++]=W[X++],2<(U-=3););U&&(W[T++]=W[X++],1<U&&(W[T++]=W[X++]))}break}}break}}while(b<j&&T<R);b-=U=F>>3,I&=(1<<(F-=U<<3))-1,x.next_in=b,x.next_out=T,x.avail_in=b<j?j-b+5:5-(b-j),x.avail_out=T<R?R-T+257:257-(T-R),y.hold=I,y.bits=F}},{}],49:[function(m,p,g){var x=m("../utils/common"),v=m("./adler32"),y=m("./crc32"),b=m("./inffast"),j=m("./inftrees"),T=-2;function O(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new x.Buf16(320),this.work=new x.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function D(N){var C;return N&&N.state?(C=N.state,N.total_in=N.total_out=C.total=0,N.msg="",C.wrap&&(N.adler=1&C.wrap),C.mode=1,C.last=0,C.havedict=0,C.dmax=32768,C.head=null,C.hold=0,C.bits=0,C.lencode=C.lendyn=new x.Buf32(852),C.distcode=C.distdyn=new x.Buf32(592),C.sane=1,C.back=-1,0):T}function B(N){var C;return N&&N.state?((C=N.state).wsize=0,C.whave=0,C.wnext=0,D(N)):T}function q(N,C){var k,M;return N&&N.state?(M=N.state,C<0?(k=0,C=-C):(k=1+(C>>4),C<48&&(C&=15)),C&&(C<8||15<C)?T:(M.window!==null&&M.wbits!==C&&(M.window=null),M.wrap=k,M.wbits=C,B(N))):T}function Y(N,C){var k,M;return N?(M=new R,(N.state=M).window=null,(k=q(N,C))!==0&&(N.state=null),k):T}var G,I,F=!0;function S(N){if(F){var C;for(G=new x.Buf32(512),I=new x.Buf32(32),C=0;C<144;)N.lens[C++]=8;for(;C<256;)N.lens[C++]=9;for(;C<280;)N.lens[C++]=7;for(;C<288;)N.lens[C++]=8;for(j(1,N.lens,0,288,G,0,N.work,{bits:9}),C=0;C<32;)N.lens[C++]=5;j(2,N.lens,0,32,I,0,N.work,{bits:5}),F=!1}N.lencode=G,N.lenbits=9,N.distcode=I,N.distbits=5}function E(N,C,k,M){var U,$=N.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new x.Buf8($.wsize)),M>=$.wsize?(x.arraySet($.window,C,k-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(M<(U=$.wsize-$.wnext)&&(U=M),x.arraySet($.window,C,k-M,U,$.wnext),(M-=U)?(x.arraySet($.window,C,k-M,M,0),$.wnext=M,$.whave=$.wsize):($.wnext+=U,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=U))),0}g.inflateReset=B,g.inflateReset2=q,g.inflateResetKeep=D,g.inflateInit=function(N){return Y(N,15)},g.inflateInit2=Y,g.inflate=function(N,C){var k,M,U,$,X,Z,re,W,J,V,H,ee,ie,oe,se,ue,pe,ce,ne,me,ge,_e,be,ye,Oe=0,Ne=new x.Buf8(4),De=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&N.avail_in!==0)return T;(k=N.state).mode===12&&(k.mode=13),X=N.next_out,U=N.output,re=N.avail_out,$=N.next_in,M=N.input,Z=N.avail_in,W=k.hold,J=k.bits,V=Z,H=re,_e=0;e:for(;;)switch(k.mode){case 1:if(k.wrap===0){k.mode=13;break}for(;J<16;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}if(2&k.wrap&&W===35615){Ne[k.check=0]=255&W,Ne[1]=W>>>8&255,k.check=y(k.check,Ne,2,0),J=W=0,k.mode=2;break}if(k.flags=0,k.head&&(k.head.done=!1),!(1&k.wrap)||(((255&W)<<8)+(W>>8))%31){N.msg="incorrect header check",k.mode=30;break}if((15&W)!=8){N.msg="unknown compression method",k.mode=30;break}if(J-=4,ge=8+(15&(W>>>=4)),k.wbits===0)k.wbits=ge;else if(ge>k.wbits){N.msg="invalid window size",k.mode=30;break}k.dmax=1<<ge,N.adler=k.check=1,k.mode=512&W?10:12,J=W=0;break;case 2:for(;J<16;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}if(k.flags=W,(255&k.flags)!=8){N.msg="unknown compression method",k.mode=30;break}if(57344&k.flags){N.msg="unknown header flags set",k.mode=30;break}k.head&&(k.head.text=W>>8&1),512&k.flags&&(Ne[0]=255&W,Ne[1]=W>>>8&255,k.check=y(k.check,Ne,2,0)),J=W=0,k.mode=3;case 3:for(;J<32;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}k.head&&(k.head.time=W),512&k.flags&&(Ne[0]=255&W,Ne[1]=W>>>8&255,Ne[2]=W>>>16&255,Ne[3]=W>>>24&255,k.check=y(k.check,Ne,4,0)),J=W=0,k.mode=4;case 4:for(;J<16;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}k.head&&(k.head.xflags=255&W,k.head.os=W>>8),512&k.flags&&(Ne[0]=255&W,Ne[1]=W>>>8&255,k.check=y(k.check,Ne,2,0)),J=W=0,k.mode=5;case 5:if(1024&k.flags){for(;J<16;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}k.length=W,k.head&&(k.head.extra_len=W),512&k.flags&&(Ne[0]=255&W,Ne[1]=W>>>8&255,k.check=y(k.check,Ne,2,0)),J=W=0}else k.head&&(k.head.extra=null);k.mode=6;case 6:if(1024&k.flags&&(Z<(ee=k.length)&&(ee=Z),ee&&(k.head&&(ge=k.head.extra_len-k.length,k.head.extra||(k.head.extra=new Array(k.head.extra_len)),x.arraySet(k.head.extra,M,$,ee,ge)),512&k.flags&&(k.check=y(k.check,M,ee,$)),Z-=ee,$+=ee,k.length-=ee),k.length))break e;k.length=0,k.mode=7;case 7:if(2048&k.flags){if(Z===0)break e;for(ee=0;ge=M[$+ee++],k.head&&ge&&k.length<65536&&(k.head.name+=String.fromCharCode(ge)),ge&&ee<Z;);if(512&k.flags&&(k.check=y(k.check,M,ee,$)),Z-=ee,$+=ee,ge)break e}else k.head&&(k.head.name=null);k.length=0,k.mode=8;case 8:if(4096&k.flags){if(Z===0)break e;for(ee=0;ge=M[$+ee++],k.head&&ge&&k.length<65536&&(k.head.comment+=String.fromCharCode(ge)),ge&&ee<Z;);if(512&k.flags&&(k.check=y(k.check,M,ee,$)),Z-=ee,$+=ee,ge)break e}else k.head&&(k.head.comment=null);k.mode=9;case 9:if(512&k.flags){for(;J<16;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}if(W!==(65535&k.check)){N.msg="header crc mismatch",k.mode=30;break}J=W=0}k.head&&(k.head.hcrc=k.flags>>9&1,k.head.done=!0),N.adler=k.check=0,k.mode=12;break;case 10:for(;J<32;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}N.adler=k.check=O(W),J=W=0,k.mode=11;case 11:if(k.havedict===0)return N.next_out=X,N.avail_out=re,N.next_in=$,N.avail_in=Z,k.hold=W,k.bits=J,2;N.adler=k.check=1,k.mode=12;case 12:if(C===5||C===6)break e;case 13:if(k.last){W>>>=7&J,J-=7&J,k.mode=27;break}for(;J<3;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}switch(k.last=1&W,J-=1,3&(W>>>=1)){case 0:k.mode=14;break;case 1:if(S(k),k.mode=20,C!==6)break;W>>>=2,J-=2;break e;case 2:k.mode=17;break;case 3:N.msg="invalid block type",k.mode=30}W>>>=2,J-=2;break;case 14:for(W>>>=7&J,J-=7&J;J<32;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}if((65535&W)!=(W>>>16^65535)){N.msg="invalid stored block lengths",k.mode=30;break}if(k.length=65535&W,J=W=0,k.mode=15,C===6)break e;case 15:k.mode=16;case 16:if(ee=k.length){if(Z<ee&&(ee=Z),re<ee&&(ee=re),ee===0)break e;x.arraySet(U,M,$,ee,X),Z-=ee,$+=ee,re-=ee,X+=ee,k.length-=ee;break}k.mode=12;break;case 17:for(;J<14;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}if(k.nlen=257+(31&W),W>>>=5,J-=5,k.ndist=1+(31&W),W>>>=5,J-=5,k.ncode=4+(15&W),W>>>=4,J-=4,286<k.nlen||30<k.ndist){N.msg="too many length or distance symbols",k.mode=30;break}k.have=0,k.mode=18;case 18:for(;k.have<k.ncode;){for(;J<3;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}k.lens[De[k.have++]]=7&W,W>>>=3,J-=3}for(;k.have<19;)k.lens[De[k.have++]]=0;if(k.lencode=k.lendyn,k.lenbits=7,be={bits:k.lenbits},_e=j(0,k.lens,0,19,k.lencode,0,k.work,be),k.lenbits=be.bits,_e){N.msg="invalid code lengths set",k.mode=30;break}k.have=0,k.mode=19;case 19:for(;k.have<k.nlen+k.ndist;){for(;ue=(Oe=k.lencode[W&(1<<k.lenbits)-1])>>>16&255,pe=65535&Oe,!((se=Oe>>>24)<=J);){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}if(pe<16)W>>>=se,J-=se,k.lens[k.have++]=pe;else{if(pe===16){for(ye=se+2;J<ye;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}if(W>>>=se,J-=se,k.have===0){N.msg="invalid bit length repeat",k.mode=30;break}ge=k.lens[k.have-1],ee=3+(3&W),W>>>=2,J-=2}else if(pe===17){for(ye=se+3;J<ye;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}J-=se,ge=0,ee=3+(7&(W>>>=se)),W>>>=3,J-=3}else{for(ye=se+7;J<ye;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}J-=se,ge=0,ee=11+(127&(W>>>=se)),W>>>=7,J-=7}if(k.have+ee>k.nlen+k.ndist){N.msg="invalid bit length repeat",k.mode=30;break}for(;ee--;)k.lens[k.have++]=ge}}if(k.mode===30)break;if(k.lens[256]===0){N.msg="invalid code -- missing end-of-block",k.mode=30;break}if(k.lenbits=9,be={bits:k.lenbits},_e=j(1,k.lens,0,k.nlen,k.lencode,0,k.work,be),k.lenbits=be.bits,_e){N.msg="invalid literal/lengths set",k.mode=30;break}if(k.distbits=6,k.distcode=k.distdyn,be={bits:k.distbits},_e=j(2,k.lens,k.nlen,k.ndist,k.distcode,0,k.work,be),k.distbits=be.bits,_e){N.msg="invalid distances set",k.mode=30;break}if(k.mode=20,C===6)break e;case 20:k.mode=21;case 21:if(6<=Z&&258<=re){N.next_out=X,N.avail_out=re,N.next_in=$,N.avail_in=Z,k.hold=W,k.bits=J,b(N,H),X=N.next_out,U=N.output,re=N.avail_out,$=N.next_in,M=N.input,Z=N.avail_in,W=k.hold,J=k.bits,k.mode===12&&(k.back=-1);break}for(k.back=0;ue=(Oe=k.lencode[W&(1<<k.lenbits)-1])>>>16&255,pe=65535&Oe,!((se=Oe>>>24)<=J);){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}if(ue&&!(240&ue)){for(ce=se,ne=ue,me=pe;ue=(Oe=k.lencode[me+((W&(1<<ce+ne)-1)>>ce)])>>>16&255,pe=65535&Oe,!(ce+(se=Oe>>>24)<=J);){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}W>>>=ce,J-=ce,k.back+=ce}if(W>>>=se,J-=se,k.back+=se,k.length=pe,ue===0){k.mode=26;break}if(32&ue){k.back=-1,k.mode=12;break}if(64&ue){N.msg="invalid literal/length code",k.mode=30;break}k.extra=15&ue,k.mode=22;case 22:if(k.extra){for(ye=k.extra;J<ye;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}k.length+=W&(1<<k.extra)-1,W>>>=k.extra,J-=k.extra,k.back+=k.extra}k.was=k.length,k.mode=23;case 23:for(;ue=(Oe=k.distcode[W&(1<<k.distbits)-1])>>>16&255,pe=65535&Oe,!((se=Oe>>>24)<=J);){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}if(!(240&ue)){for(ce=se,ne=ue,me=pe;ue=(Oe=k.distcode[me+((W&(1<<ce+ne)-1)>>ce)])>>>16&255,pe=65535&Oe,!(ce+(se=Oe>>>24)<=J);){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}W>>>=ce,J-=ce,k.back+=ce}if(W>>>=se,J-=se,k.back+=se,64&ue){N.msg="invalid distance code",k.mode=30;break}k.offset=pe,k.extra=15&ue,k.mode=24;case 24:if(k.extra){for(ye=k.extra;J<ye;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}k.offset+=W&(1<<k.extra)-1,W>>>=k.extra,J-=k.extra,k.back+=k.extra}if(k.offset>k.dmax){N.msg="invalid distance too far back",k.mode=30;break}k.mode=25;case 25:if(re===0)break e;if(ee=H-re,k.offset>ee){if((ee=k.offset-ee)>k.whave&&k.sane){N.msg="invalid distance too far back",k.mode=30;break}ie=ee>k.wnext?(ee-=k.wnext,k.wsize-ee):k.wnext-ee,ee>k.length&&(ee=k.length),oe=k.window}else oe=U,ie=X-k.offset,ee=k.length;for(re<ee&&(ee=re),re-=ee,k.length-=ee;U[X++]=oe[ie++],--ee;);k.length===0&&(k.mode=21);break;case 26:if(re===0)break e;U[X++]=k.length,re--,k.mode=21;break;case 27:if(k.wrap){for(;J<32;){if(Z===0)break e;Z--,W|=M[$++]<<J,J+=8}if(H-=re,N.total_out+=H,k.total+=H,H&&(N.adler=k.check=k.flags?y(k.check,U,H,X-H):v(k.check,U,H,X-H)),H=re,(k.flags?W:O(W))!==k.check){N.msg="incorrect data check",k.mode=30;break}J=W=0}k.mode=28;case 28:if(k.wrap&&k.flags){for(;J<32;){if(Z===0)break e;Z--,W+=M[$++]<<J,J+=8}if(W!==(4294967295&k.total)){N.msg="incorrect length check",k.mode=30;break}J=W=0}k.mode=29;case 29:_e=1;break e;case 30:_e=-3;break e;case 31:return-4;case 32:default:return T}return N.next_out=X,N.avail_out=re,N.next_in=$,N.avail_in=Z,k.hold=W,k.bits=J,(k.wsize||H!==N.avail_out&&k.mode<30&&(k.mode<27||C!==4))&&E(N,N.output,N.next_out,H-N.avail_out)?(k.mode=31,-4):(V-=N.avail_in,H-=N.avail_out,N.total_in+=V,N.total_out+=H,k.total+=H,k.wrap&&H&&(N.adler=k.check=k.flags?y(k.check,U,H,N.next_out-H):v(k.check,U,H,N.next_out-H)),N.data_type=k.bits+(k.last?64:0)+(k.mode===12?128:0)+(k.mode===20||k.mode===15?256:0),(V==0&&H===0||C===4)&&_e===0&&(_e=-5),_e)},g.inflateEnd=function(N){if(!N||!N.state)return T;var C=N.state;return C.window&&(C.window=null),N.state=null,0},g.inflateGetHeader=function(N,C){var k;return N&&N.state&&2&(k=N.state).wrap?((k.head=C).done=!1,0):T},g.inflateSetDictionary=function(N,C){var k,M=C.length;return N&&N.state?(k=N.state).wrap!==0&&k.mode!==11?T:k.mode===11&&v(1,C,M,0)!==k.check?-3:E(N,C,M,M)?(k.mode=31,-4):(k.havedict=1,0):T},g.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(m,p,g){var x=m("../utils/common"),v=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],b=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],j=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];p.exports=function(T,O,R,D,B,q,Y,G){var I,F,S,E,N,C,k,M,U,$=G.bits,X=0,Z=0,re=0,W=0,J=0,V=0,H=0,ee=0,ie=0,oe=0,se=null,ue=0,pe=new x.Buf16(16),ce=new x.Buf16(16),ne=null,me=0;for(X=0;X<=15;X++)pe[X]=0;for(Z=0;Z<D;Z++)pe[O[R+Z]]++;for(J=$,W=15;1<=W&&pe[W]===0;W--);if(W<J&&(J=W),W===0)return B[q++]=20971520,B[q++]=20971520,G.bits=1,0;for(re=1;re<W&&pe[re]===0;re++);for(J<re&&(J=re),X=ee=1;X<=15;X++)if(ee<<=1,(ee-=pe[X])<0)return-1;if(0<ee&&(T===0||W!==1))return-1;for(ce[1]=0,X=1;X<15;X++)ce[X+1]=ce[X]+pe[X];for(Z=0;Z<D;Z++)O[R+Z]!==0&&(Y[ce[O[R+Z]]++]=Z);if(C=T===0?(se=ne=Y,19):T===1?(se=v,ue-=257,ne=y,me-=257,256):(se=b,ne=j,-1),X=re,N=q,H=Z=oe=0,S=-1,E=(ie=1<<(V=J))-1,T===1&&852<ie||T===2&&592<ie)return 1;for(;;){for(k=X-H,U=Y[Z]<C?(M=0,Y[Z]):Y[Z]>C?(M=ne[me+Y[Z]],se[ue+Y[Z]]):(M=96,0),I=1<<X-H,re=F=1<<V;B[N+(oe>>H)+(F-=I)]=k<<24|M<<16|U|0,F!==0;);for(I=1<<X-1;oe&I;)I>>=1;if(I!==0?(oe&=I-1,oe+=I):oe=0,Z++,--pe[X]==0){if(X===W)break;X=O[R+Y[Z]]}if(J<X&&(oe&E)!==S){for(H===0&&(H=J),N+=re,ee=1<<(V=X-H);V+H<W&&!((ee-=pe[V+H])<=0);)V++,ee<<=1;if(ie+=1<<V,T===1&&852<ie||T===2&&592<ie)return 1;B[S=oe&E]=J<<24|V<<16|N-q|0}}return oe!==0&&(B[N+oe]=X-H<<24|64<<16|0),G.bits=J,0}},{"../utils/common":41}],51:[function(m,p,g){p.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(m,p,g){var x=m("../utils/common");function v(ne){for(var me=ne.length;0<=--me;)ne[me]=0}var y=256,b=286,j=30,T=15,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=new Array(576);v(q);var Y=new Array(60);v(Y);var G=new Array(512);v(G);var I=new Array(256);v(I);var F=new Array(29);v(F);var S,E,N,C=new Array(j);function k(ne,me,ge,_e,be){this.static_tree=ne,this.extra_bits=me,this.extra_base=ge,this.elems=_e,this.max_length=be,this.has_stree=ne&&ne.length}function M(ne,me){this.dyn_tree=ne,this.max_code=0,this.stat_desc=me}function U(ne){return ne<256?G[ne]:G[256+(ne>>>7)]}function $(ne,me){ne.pending_buf[ne.pending++]=255&me,ne.pending_buf[ne.pending++]=me>>>8&255}function X(ne,me,ge){ne.bi_valid>16-ge?(ne.bi_buf|=me<<ne.bi_valid&65535,$(ne,ne.bi_buf),ne.bi_buf=me>>16-ne.bi_valid,ne.bi_valid+=ge-16):(ne.bi_buf|=me<<ne.bi_valid&65535,ne.bi_valid+=ge)}function Z(ne,me,ge){X(ne,ge[2*me],ge[2*me+1])}function re(ne,me){for(var ge=0;ge|=1&ne,ne>>>=1,ge<<=1,0<--me;);return ge>>>1}function W(ne,me,ge){var _e,be,ye=new Array(16),Oe=0;for(_e=1;_e<=T;_e++)ye[_e]=Oe=Oe+ge[_e-1]<<1;for(be=0;be<=me;be++){var Ne=ne[2*be+1];Ne!==0&&(ne[2*be]=re(ye[Ne]++,Ne))}}function J(ne){var me;for(me=0;me<b;me++)ne.dyn_ltree[2*me]=0;for(me=0;me<j;me++)ne.dyn_dtree[2*me]=0;for(me=0;me<19;me++)ne.bl_tree[2*me]=0;ne.dyn_ltree[512]=1,ne.opt_len=ne.static_len=0,ne.last_lit=ne.matches=0}function V(ne){8<ne.bi_valid?$(ne,ne.bi_buf):0<ne.bi_valid&&(ne.pending_buf[ne.pending++]=ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0}function H(ne,me,ge,_e){var be=2*me,ye=2*ge;return ne[be]<ne[ye]||ne[be]===ne[ye]&&_e[me]<=_e[ge]}function ee(ne,me,ge){for(var _e=ne.heap[ge],be=ge<<1;be<=ne.heap_len&&(be<ne.heap_len&&H(me,ne.heap[be+1],ne.heap[be],ne.depth)&&be++,!H(me,_e,ne.heap[be],ne.depth));)ne.heap[ge]=ne.heap[be],ge=be,be<<=1;ne.heap[ge]=_e}function ie(ne,me,ge){var _e,be,ye,Oe,Ne=0;if(ne.last_lit!==0)for(;_e=ne.pending_buf[ne.d_buf+2*Ne]<<8|ne.pending_buf[ne.d_buf+2*Ne+1],be=ne.pending_buf[ne.l_buf+Ne],Ne++,_e===0?Z(ne,be,me):(Z(ne,(ye=I[be])+y+1,me),(Oe=O[ye])!==0&&X(ne,be-=F[ye],Oe),Z(ne,ye=U(--_e),ge),(Oe=R[ye])!==0&&X(ne,_e-=C[ye],Oe)),Ne<ne.last_lit;);Z(ne,256,me)}function oe(ne,me){var ge,_e,be,ye=me.dyn_tree,Oe=me.stat_desc.static_tree,Ne=me.stat_desc.has_stree,De=me.stat_desc.elems,Ge=-1;for(ne.heap_len=0,ne.heap_max=573,ge=0;ge<De;ge++)ye[2*ge]!==0?(ne.heap[++ne.heap_len]=Ge=ge,ne.depth[ge]=0):ye[2*ge+1]=0;for(;ne.heap_len<2;)ye[2*(be=ne.heap[++ne.heap_len]=Ge<2?++Ge:0)]=1,ne.depth[be]=0,ne.opt_len--,Ne&&(ne.static_len-=Oe[2*be+1]);for(me.max_code=Ge,ge=ne.heap_len>>1;1<=ge;ge--)ee(ne,ye,ge);for(be=De;ge=ne.heap[1],ne.heap[1]=ne.heap[ne.heap_len--],ee(ne,ye,1),_e=ne.heap[1],ne.heap[--ne.heap_max]=ge,ne.heap[--ne.heap_max]=_e,ye[2*be]=ye[2*ge]+ye[2*_e],ne.depth[be]=(ne.depth[ge]>=ne.depth[_e]?ne.depth[ge]:ne.depth[_e])+1,ye[2*ge+1]=ye[2*_e+1]=be,ne.heap[1]=be++,ee(ne,ye,1),2<=ne.heap_len;);ne.heap[--ne.heap_max]=ne.heap[1],function(Qe,Ie){var Ae,st,nt,vt,Je,Ue,Le=Ie.dyn_tree,Ze=Ie.max_code,ct=Ie.stat_desc.static_tree,ht=Ie.stat_desc.has_stree,yt=Ie.stat_desc.extra_bits,Re=Ie.stat_desc.extra_base,Ke=Ie.stat_desc.max_length,_t=0;for(vt=0;vt<=T;vt++)Qe.bl_count[vt]=0;for(Le[2*Qe.heap[Qe.heap_max]+1]=0,Ae=Qe.heap_max+1;Ae<573;Ae++)Ke<(vt=Le[2*Le[2*(st=Qe.heap[Ae])+1]+1]+1)&&(vt=Ke,_t++),Le[2*st+1]=vt,Ze<st||(Qe.bl_count[vt]++,Je=0,Re<=st&&(Je=yt[st-Re]),Ue=Le[2*st],Qe.opt_len+=Ue*(vt+Je),ht&&(Qe.static_len+=Ue*(ct[2*st+1]+Je)));if(_t!==0){do{for(vt=Ke-1;Qe.bl_count[vt]===0;)vt--;Qe.bl_count[vt]--,Qe.bl_count[vt+1]+=2,Qe.bl_count[Ke]--,_t-=2}while(0<_t);for(vt=Ke;vt!==0;vt--)for(st=Qe.bl_count[vt];st!==0;)Ze<(nt=Qe.heap[--Ae])||(Le[2*nt+1]!==vt&&(Qe.opt_len+=(vt-Le[2*nt+1])*Le[2*nt],Le[2*nt+1]=vt),st--)}}(ne,me),W(ye,Ge,ne.bl_count)}function se(ne,me,ge){var _e,be,ye=-1,Oe=me[1],Ne=0,De=7,Ge=4;for(Oe===0&&(De=138,Ge=3),me[2*(ge+1)+1]=65535,_e=0;_e<=ge;_e++)be=Oe,Oe=me[2*(_e+1)+1],++Ne<De&&be===Oe||(Ne<Ge?ne.bl_tree[2*be]+=Ne:be!==0?(be!==ye&&ne.bl_tree[2*be]++,ne.bl_tree[32]++):Ne<=10?ne.bl_tree[34]++:ne.bl_tree[36]++,ye=be,Ge=(Ne=0)===Oe?(De=138,3):be===Oe?(De=6,3):(De=7,4))}function ue(ne,me,ge){var _e,be,ye=-1,Oe=me[1],Ne=0,De=7,Ge=4;for(Oe===0&&(De=138,Ge=3),_e=0;_e<=ge;_e++)if(be=Oe,Oe=me[2*(_e+1)+1],!(++Ne<De&&be===Oe)){if(Ne<Ge)for(;Z(ne,be,ne.bl_tree),--Ne!=0;);else be!==0?(be!==ye&&(Z(ne,be,ne.bl_tree),Ne--),Z(ne,16,ne.bl_tree),X(ne,Ne-3,2)):Ne<=10?(Z(ne,17,ne.bl_tree),X(ne,Ne-3,3)):(Z(ne,18,ne.bl_tree),X(ne,Ne-11,7));ye=be,Ge=(Ne=0)===Oe?(De=138,3):be===Oe?(De=6,3):(De=7,4)}}v(C);var pe=!1;function ce(ne,me,ge,_e){X(ne,0+(_e?1:0),3),function(be,ye,Oe,Ne){V(be),$(be,Oe),$(be,~Oe),x.arraySet(be.pending_buf,be.window,ye,Oe,be.pending),be.pending+=Oe}(ne,me,ge)}g._tr_init=function(ne){pe||(function(){var me,ge,_e,be,ye,Oe=new Array(16);for(be=_e=0;be<28;be++)for(F[be]=_e,me=0;me<1<<O[be];me++)I[_e++]=be;for(I[_e-1]=be,be=ye=0;be<16;be++)for(C[be]=ye,me=0;me<1<<R[be];me++)G[ye++]=be;for(ye>>=7;be<j;be++)for(C[be]=ye<<7,me=0;me<1<<R[be]-7;me++)G[256+ye++]=be;for(ge=0;ge<=T;ge++)Oe[ge]=0;for(me=0;me<=143;)q[2*me+1]=8,me++,Oe[8]++;for(;me<=255;)q[2*me+1]=9,me++,Oe[9]++;for(;me<=279;)q[2*me+1]=7,me++,Oe[7]++;for(;me<=287;)q[2*me+1]=8,me++,Oe[8]++;for(W(q,287,Oe),me=0;me<j;me++)Y[2*me+1]=5,Y[2*me]=re(me,5);S=new k(q,O,257,b,T),E=new k(Y,R,0,j,T),N=new k(new Array(0),D,0,19,7)}(),pe=!0),ne.l_desc=new M(ne.dyn_ltree,S),ne.d_desc=new M(ne.dyn_dtree,E),ne.bl_desc=new M(ne.bl_tree,N),ne.bi_buf=0,ne.bi_valid=0,J(ne)},g._tr_stored_block=ce,g._tr_flush_block=function(ne,me,ge,_e){var be,ye,Oe=0;0<ne.level?(ne.strm.data_type===2&&(ne.strm.data_type=function(Ne){var De,Ge=4093624447;for(De=0;De<=31;De++,Ge>>>=1)if(1&Ge&&Ne.dyn_ltree[2*De]!==0)return 0;if(Ne.dyn_ltree[18]!==0||Ne.dyn_ltree[20]!==0||Ne.dyn_ltree[26]!==0)return 1;for(De=32;De<y;De++)if(Ne.dyn_ltree[2*De]!==0)return 1;return 0}(ne)),oe(ne,ne.l_desc),oe(ne,ne.d_desc),Oe=function(Ne){var De;for(se(Ne,Ne.dyn_ltree,Ne.l_desc.max_code),se(Ne,Ne.dyn_dtree,Ne.d_desc.max_code),oe(Ne,Ne.bl_desc),De=18;3<=De&&Ne.bl_tree[2*B[De]+1]===0;De--);return Ne.opt_len+=3*(De+1)+5+5+4,De}(ne),be=ne.opt_len+3+7>>>3,(ye=ne.static_len+3+7>>>3)<=be&&(be=ye)):be=ye=ge+5,ge+4<=be&&me!==-1?ce(ne,me,ge,_e):ne.strategy===4||ye===be?(X(ne,2+(_e?1:0),3),ie(ne,q,Y)):(X(ne,4+(_e?1:0),3),function(Ne,De,Ge,Qe){var Ie;for(X(Ne,De-257,5),X(Ne,Ge-1,5),X(Ne,Qe-4,4),Ie=0;Ie<Qe;Ie++)X(Ne,Ne.bl_tree[2*B[Ie]+1],3);ue(Ne,Ne.dyn_ltree,De-1),ue(Ne,Ne.dyn_dtree,Ge-1)}(ne,ne.l_desc.max_code+1,ne.d_desc.max_code+1,Oe+1),ie(ne,ne.dyn_ltree,ne.dyn_dtree)),J(ne),_e&&V(ne)},g._tr_tally=function(ne,me,ge){return ne.pending_buf[ne.d_buf+2*ne.last_lit]=me>>>8&255,ne.pending_buf[ne.d_buf+2*ne.last_lit+1]=255&me,ne.pending_buf[ne.l_buf+ne.last_lit]=255&ge,ne.last_lit++,me===0?ne.dyn_ltree[2*ge]++:(ne.matches++,me--,ne.dyn_ltree[2*(I[ge]+y+1)]++,ne.dyn_dtree[2*U(me)]++),ne.last_lit===ne.lit_bufsize-1},g._tr_align=function(ne){X(ne,2,3),Z(ne,256,q),function(me){me.bi_valid===16?($(me,me.bi_buf),me.bi_buf=0,me.bi_valid=0):8<=me.bi_valid&&(me.pending_buf[me.pending++]=255&me.bi_buf,me.bi_buf>>=8,me.bi_valid-=8)}(ne)}},{"../utils/common":41}],53:[function(m,p,g){p.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(m,p,g){(function(x){(function(v,y){if(!v.setImmediate){var b,j,T,O,R=1,D={},B=!1,q=v.document,Y=Object.getPrototypeOf&&Object.getPrototypeOf(v);Y=Y&&Y.setTimeout?Y:v,b={}.toString.call(v.process)==="[object process]"?function(S){i.nextTick(function(){I(S)})}:function(){if(v.postMessage&&!v.importScripts){var S=!0,E=v.onmessage;return v.onmessage=function(){S=!1},v.postMessage("","*"),v.onmessage=E,S}}()?(O="setImmediate$"+Math.random()+"$",v.addEventListener?v.addEventListener("message",F,!1):v.attachEvent("onmessage",F),function(S){v.postMessage(O+S,"*")}):v.MessageChannel?((T=new MessageChannel).port1.onmessage=function(S){I(S.data)},function(S){T.port2.postMessage(S)}):q&&"onreadystatechange"in q.createElement("script")?(j=q.documentElement,function(S){var E=q.createElement("script");E.onreadystatechange=function(){I(S),E.onreadystatechange=null,j.removeChild(E),E=null},j.appendChild(E)}):function(S){setTimeout(I,0,S)},Y.setImmediate=function(S){typeof S!="function"&&(S=new Function(""+S));for(var E=new Array(arguments.length-1),N=0;N<E.length;N++)E[N]=arguments[N+1];var C={callback:S,args:E};return D[R]=C,b(R),R++},Y.clearImmediate=G}function G(S){delete D[S]}function I(S){if(B)setTimeout(I,0,S);else{var E=D[S];if(E){B=!0;try{(function(N){var C=N.callback,k=N.args;switch(k.length){case 0:C();break;case 1:C(k[0]);break;case 2:C(k[0],k[1]);break;case 3:C(k[0],k[1],k[2]);break;default:C.apply(void 0,k)}})(E)}finally{G(S),B=!1}}}}function F(S){S.source===v&&typeof S.data=="string"&&S.data.indexOf(O)===0&&I(+S.data.slice(O.length))}})(typeof self>"u"?x===void 0?this:x:self)}).call(this,o!==void 0?o:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}).call(this)}).call(this,r("_process"),typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],r("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(r,s,a){(function(i){(function(){var o=/[\\^$.*+?()[\]{}|]/g,l=RegExp(o.source),d=typeof i=="object"&&i&&i.Object===Object&&i,c=typeof self=="object"&&self&&self.Object===Object&&self,u=d||c||Function("return this")(),h=Object.prototype.toString,f=u.Symbol,m=f?f.prototype:void 0,p=m?m.toString:void 0;function g(x){if(typeof x=="string")return x;if(function(y){return typeof y=="symbol"||function(b){return!!b&&typeof b=="object"}(y)&&h.call(y)=="[object Symbol]"}(x))return p?p.call(x):"";var v=x+"";return v=="0"&&1/x==-1/0?"-0":v}s.exports=function(x){var v;return(x=(v=x)==null?"":g(v))&&l.test(x)?x.replace(o,"\\$&"):x}}).call(this)}).call(this,typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(r,s,a){(function(i){(function(){var o="[object Arguments]",l="[object Map]",d="[object Object]",c="[object Set]",u=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h=/^\w*$/,f=/^\./,m=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,p=/\\(\\)?/g,g=/^\[object .+?Constructor\]$/,x=/^(?:0|[1-9]\d*)$/,v={};v["[object Float32Array]"]=v["[object Float64Array]"]=v["[object Int8Array]"]=v["[object Int16Array]"]=v["[object Int32Array]"]=v["[object Uint8Array]"]=v["[object Uint8ClampedArray]"]=v["[object Uint16Array]"]=v["[object Uint32Array]"]=!0,v[o]=v["[object Array]"]=v["[object ArrayBuffer]"]=v["[object Boolean]"]=v["[object DataView]"]=v["[object Date]"]=v["[object Error]"]=v["[object Function]"]=v[l]=v["[object Number]"]=v[d]=v["[object RegExp]"]=v[c]=v["[object String]"]=v["[object WeakMap]"]=!1;var y=typeof i=="object"&&i&&i.Object===Object&&i,b=typeof self=="object"&&self&&self.Object===Object&&self,j=y||b||Function("return this")(),T=typeof a=="object"&&a&&!a.nodeType&&a,O=T&&typeof s=="object"&&s&&!s.nodeType&&s,R=O&&O.exports===T&&y.process,D=function(){try{return R&&R.binding("util")}catch{}}(),B=D&&D.isTypedArray;function q(Ce,Xe,ft,ze){for(var Zt=-1,wt=Ce?Ce.length:0;++Zt<wt;){var kt=Ce[Zt];Xe(ze,kt,ft(kt),Ce)}return ze}function Y(Ce,Xe){for(var ft=-1,ze=Ce?Ce.length:0;++ft<ze;)if(Xe(Ce[ft],ft,Ce))return!0;return!1}function G(Ce){var Xe=!1;if(Ce!=null&&typeof Ce.toString!="function")try{Xe=!!(Ce+"")}catch{}return Xe}function I(Ce){var Xe=-1,ft=Array(Ce.size);return Ce.forEach(function(ze,Zt){ft[++Xe]=[Zt,ze]}),ft}function F(Ce){var Xe=-1,ft=Array(Ce.size);return Ce.forEach(function(ze){ft[++Xe]=ze}),ft}var S,E,N,C=Array.prototype,k=Function.prototype,M=Object.prototype,U=j["__core-js_shared__"],$=(S=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",X=k.toString,Z=M.hasOwnProperty,re=M.toString,W=RegExp("^"+X.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),J=j.Symbol,V=j.Uint8Array,H=M.propertyIsEnumerable,ee=C.splice,ie=(E=Object.keys,N=Object,function(Ce){return E(N(Ce))}),oe=ot(j,"DataView"),se=ot(j,"Map"),ue=ot(j,"Promise"),pe=ot(j,"Set"),ce=ot(j,"WeakMap"),ne=ot(Object,"create"),me=Me(oe),ge=Me(se),_e=Me(ue),be=Me(pe),ye=Me(ce),Oe=J?J.prototype:void 0,Ne=Oe?Oe.valueOf:void 0,De=Oe?Oe.toString:void 0;function Ge(Ce){var Xe=-1,ft=Ce?Ce.length:0;for(this.clear();++Xe<ft;){var ze=Ce[Xe];this.set(ze[0],ze[1])}}function Qe(Ce){var Xe=-1,ft=Ce?Ce.length:0;for(this.clear();++Xe<ft;){var ze=Ce[Xe];this.set(ze[0],ze[1])}}function Ie(Ce){var Xe=-1,ft=Ce?Ce.length:0;for(this.clear();++Xe<ft;){var ze=Ce[Xe];this.set(ze[0],ze[1])}}function Ae(Ce){var Xe=-1,ft=Ce?Ce.length:0;for(this.__data__=new Ie;++Xe<ft;)this.add(Ce[Xe])}function st(Ce){this.__data__=new Qe(Ce)}function nt(Ce,Xe){var ft=sr(Ce)||xr(Ce)?function(kt,Cr){for(var Jt=-1,tr=Array(kt);++Jt<kt;)tr[Jt]=Cr(Jt);return tr}(Ce.length,String):[],ze=ft.length,Zt=!!ze;for(var wt in Ce)!Z.call(Ce,wt)||Zt&&(wt=="length"||At(wt,ze))||ft.push(wt);return ft}function vt(Ce,Xe){for(var ft=Ce.length;ft--;)if(It(Ce[ft][0],Xe))return ft;return-1}function Je(Ce,Xe,ft,ze){return Le(Ce,function(Zt,wt,kt){Xe(ze,Zt,ft(Zt),kt)}),ze}Ge.prototype.clear=function(){this.__data__=ne?ne(null):{}},Ge.prototype.delete=function(Ce){return this.has(Ce)&&delete this.__data__[Ce]},Ge.prototype.get=function(Ce){var Xe=this.__data__;if(ne){var ft=Xe[Ce];return ft==="__lodash_hash_undefined__"?void 0:ft}return Z.call(Xe,Ce)?Xe[Ce]:void 0},Ge.prototype.has=function(Ce){var Xe=this.__data__;return ne?Xe[Ce]!==void 0:Z.call(Xe,Ce)},Ge.prototype.set=function(Ce,Xe){return this.__data__[Ce]=ne&&Xe===void 0?"__lodash_hash_undefined__":Xe,this},Qe.prototype.clear=function(){this.__data__=[]},Qe.prototype.delete=function(Ce){var Xe=this.__data__,ft=vt(Xe,Ce);return!(ft<0)&&(ft==Xe.length-1?Xe.pop():ee.call(Xe,ft,1),!0)},Qe.prototype.get=function(Ce){var Xe=this.__data__,ft=vt(Xe,Ce);return ft<0?void 0:Xe[ft][1]},Qe.prototype.has=function(Ce){return vt(this.__data__,Ce)>-1},Qe.prototype.set=function(Ce,Xe){var ft=this.__data__,ze=vt(ft,Ce);return ze<0?ft.push([Ce,Xe]):ft[ze][1]=Xe,this},Ie.prototype.clear=function(){this.__data__={hash:new Ge,map:new(se||Qe),string:new Ge}},Ie.prototype.delete=function(Ce){return tt(this,Ce).delete(Ce)},Ie.prototype.get=function(Ce){return tt(this,Ce).get(Ce)},Ie.prototype.has=function(Ce){return tt(this,Ce).has(Ce)},Ie.prototype.set=function(Ce,Xe){return tt(this,Ce).set(Ce,Xe),this},Ae.prototype.add=Ae.prototype.push=function(Ce){return this.__data__.set(Ce,"__lodash_hash_undefined__"),this},Ae.prototype.has=function(Ce){return this.__data__.has(Ce)},st.prototype.clear=function(){this.__data__=new Qe},st.prototype.delete=function(Ce){return this.__data__.delete(Ce)},st.prototype.get=function(Ce){return this.__data__.get(Ce)},st.prototype.has=function(Ce){return this.__data__.has(Ce)},st.prototype.set=function(Ce,Xe){var ft=this.__data__;if(ft instanceof Qe){var ze=ft.__data__;if(!se||ze.length<199)return ze.push([Ce,Xe]),this;ft=this.__data__=new Ie(ze)}return ft.set(Ce,Xe),this};var Ue,Le=(Ue=function(Ce,Xe){return Ce&&Ze(Ce,Xe,nr)},function(Ce,Xe){if(Ce==null)return Ce;if(!ir(Ce))return Ue(Ce,Xe);for(var ft=Ce.length,ze=-1,Zt=Object(Ce);++ze<ft&&Xe(Zt[ze],ze,Zt)!==!1;);return Ce}),Ze=function(Ce){return function(Xe,ft,ze){for(var Zt=-1,wt=Object(Xe),kt=ze(Xe),Cr=kt.length;Cr--;){var Jt=kt[++Zt];if(ft(wt[Jt],Jt,wt)===!1)break}return Xe}}();function ct(Ce,Xe){for(var ft=0,ze=(Xe=Nt(Xe,Ce)?[Xe]:Rt(Xe)).length;Ce!=null&&ft<ze;)Ce=Ce[Pe(Xe[ft++])];return ft&&ft==ze?Ce:void 0}function ht(Ce,Xe){return Ce!=null&&Xe in Object(Ce)}function yt(Ce,Xe,ft,ze,Zt){return Ce===Xe||(Ce==null||Xe==null||!jr(Ce)&&!rt(Xe)?Ce!=Ce&&Xe!=Xe:function(wt,kt,Cr,Jt,tr,Ut){var xn=sr(wt),vn=sr(kt),bn="[object Array]",Vr="[object Array]";xn||(bn=(bn=lt(wt))==o?d:bn),vn||(Vr=(Vr=lt(kt))==o?d:Vr);var Wn=bn==d&&!G(wt),Ta=Vr==d&&!G(kt),wn=bn==Vr;if(wn&&!Wn)return Ut||(Ut=new st),xn||rr(wt)?Se(wt,kt,Cr,Jt,tr,Ut):function(Br,Ye,Ee,ur,xs,Yn,Yo){switch(Ee){case"[object DataView]":if(Br.byteLength!=Ye.byteLength||Br.byteOffset!=Ye.byteOffset)return!1;Br=Br.buffer,Ye=Ye.buffer;case"[object ArrayBuffer]":return!(Br.byteLength!=Ye.byteLength||!ur(new V(Br),new V(Ye)));case"[object Boolean]":case"[object Date]":case"[object Number]":return It(+Br,+Ye);case"[object Error]":return Br.name==Ye.name&&Br.message==Ye.message;case"[object RegExp]":case"[object String]":return Br==Ye+"";case l:var wo=I;case c:var _a=2&Yn;if(wo||(wo=F),Br.size!=Ye.size&&!_a)return!1;var vr=Yo.get(Br);if(vr)return vr==Ye;Yn|=1,Yo.set(Br,Ye);var Rn=Se(wo(Br),wo(Ye),ur,xs,Yn,Yo);return Yo.delete(Br),Rn;case"[object Symbol]":if(Ne)return Ne.call(Br)==Ne.call(Ye)}return!1}(wt,kt,bn,Cr,Jt,tr,Ut);if(!(2&tr)){var Ka=Wn&&Z.call(wt,"__wrapped__"),vd=Ta&&Z.call(kt,"__wrapped__");if(Ka||vd){var Xi=Ka?wt.value():wt,_n=vd?kt.value():kt;return Ut||(Ut=new st),Cr(Xi,_n,Jt,tr,Ut)}}return wn?(Ut||(Ut=new st),function(Br,Ye,Ee,ur,xs,Yn){var Yo=2&xs,wo=nr(Br),_a=wo.length,vr=nr(Ye).length;if(_a!=vr&&!Yo)return!1;for(var Rn=_a;Rn--;){var Zo=wo[Rn];if(!(Yo?Zo in Ye:Z.call(Ye,Zo)))return!1}var O1=Yn.get(Br);if(O1&&Yn.get(Ye))return O1==Ye;var yd=!0;Yn.set(Br,Ye),Yn.set(Ye,Br);for(var bd=Yo;++Rn<_a;){Zo=wo[Rn];var wd=Br[Zo],Af=Ye[Zo];if(ur)var Fs=Yo?ur(Af,wd,Zo,Ye,Br,Yn):ur(wd,Af,Zo,Br,Ye,Yn);if(!(Fs===void 0?wd===Af||Ee(wd,Af,ur,xs,Yn):Fs)){yd=!1;break}bd||(bd=Zo=="constructor")}if(yd&&!bd){var Dl=Br.constructor,Yi=Ye.constructor;Dl==Yi||!("constructor"in Br)||!("constructor"in Ye)||typeof Dl=="function"&&Dl instanceof Dl&&typeof Yi=="function"&&Yi instanceof Yi||(yd=!1)}return Yn.delete(Br),Yn.delete(Ye),yd}(wt,kt,Cr,Jt,tr,Ut)):!1}(Ce,Xe,yt,ft,ze,Zt))}function Re(Ce){return!(!jr(Ce)||function(Xe){return!!$&&$ in Xe}(Ce))&&(_r(Ce)||G(Ce)?W:g).test(Me(Ce))}function Ke(Ce){return typeof Ce=="function"?Ce:Ce==null?Qt:typeof Ce=="object"?sr(Ce)?function(ze,Zt){return Nt(ze)&&ut(Zt)?lr(Pe(ze),Zt):function(wt){var kt=function(Cr,Jt,tr){var Ut=Cr==null?void 0:ct(Cr,Jt);return Ut===void 0?tr:Ut}(wt,ze);return kt===void 0&&kt===Zt?function(Cr,Jt){return Cr!=null&&function(tr,Ut,xn){Ut=Nt(Ut,tr)?[Ut]:Rt(Ut);for(var vn,bn=-1,Vr=Ut.length;++bn<Vr;){var Wn=Pe(Ut[bn]);if(!(vn=tr!=null&&xn(tr,Wn)))break;tr=tr[Wn]}return vn||!!(Vr=tr?tr.length:0)&&wr(Vr)&&At(Wn,Vr)&&(sr(tr)||xr(tr))}(Cr,Jt,ht)}(wt,ze):yt(Zt,kt,void 0,3)}}(Ce[0],Ce[1]):function(ze){var Zt=function(wt){for(var kt=nr(wt),Cr=kt.length;Cr--;){var Jt=kt[Cr],tr=wt[Jt];kt[Cr]=[Jt,tr,ut(tr)]}return kt}(ze);return Zt.length==1&&Zt[0][2]?lr(Zt[0][0],Zt[0][1]):function(wt){return wt===ze||function(kt,Cr,Jt,tr){var Ut=Jt.length,xn=Ut;if(kt==null)return!xn;for(kt=Object(kt);Ut--;){var vn=Jt[Ut];if(vn[2]?vn[1]!==kt[vn[0]]:!(vn[0]in kt))return!1}for(;++Ut<xn;){var bn=(vn=Jt[Ut])[0],Vr=kt[bn],Wn=vn[1];if(vn[2]){if(Vr===void 0&&!(bn in kt))return!1}else{var Ta=new st,wn;if(!(wn===void 0?yt(Wn,Vr,tr,3,Ta):wn))return!1}}return!0}(wt,ze,Zt)}}(Ce):Nt(Xe=Ce)?(ft=Pe(Xe),function(ze){return ze==null?void 0:ze[ft]}):function(ze){return function(Zt){return ct(Zt,ze)}}(Xe);var Xe,ft}function _t(Ce){if(ft=(Xe=Ce)&&Xe.constructor,ze=typeof ft=="function"&&ft.prototype||M,Xe!==ze)return ie(Ce);var Xe,ft,ze,Zt=[];for(var wt in Object(Ce))Z.call(Ce,wt)&&wt!="constructor"&&Zt.push(wt);return Zt}function Rt(Ce){return sr(Ce)?Ce:Pt(Ce)}function Se(Ce,Xe,ft,ze,Zt,wt){var kt=2&Zt,Cr=Ce.length,Jt=Xe.length;if(Cr!=Jt&&!(kt&&Jt>Cr))return!1;var tr=wt.get(Ce);if(tr&&wt.get(Xe))return tr==Xe;var Ut=-1,xn=!0,vn=1&Zt?new Ae:void 0;for(wt.set(Ce,Xe),wt.set(Xe,Ce);++Ut<Cr;){var bn=Ce[Ut],Vr=Xe[Ut];if(ze)var Wn=kt?ze(Vr,bn,Ut,Xe,Ce,wt):ze(bn,Vr,Ut,Ce,Xe,wt);if(Wn!==void 0){if(Wn)continue;xn=!1;break}if(vn){if(!Y(Xe,function(Ta,wn){if(!vn.has(wn)&&(bn===Ta||ft(bn,Ta,ze,Zt,wt)))return vn.add(wn)})){xn=!1;break}}else if(bn!==Vr&&!ft(bn,Vr,ze,Zt,wt)){xn=!1;break}}return wt.delete(Ce),wt.delete(Xe),xn}function tt(Ce,Xe){var ft,ze,Zt=Ce.__data__;return((ze=typeof(ft=Xe))=="string"||ze=="number"||ze=="symbol"||ze=="boolean"?ft!=="__proto__":ft===null)?Zt[typeof Xe=="string"?"string":"hash"]:Zt.map}function ot(Ce,Xe){var ft=function(ze,Zt){return ze==null?void 0:ze[Zt]}(Ce,Xe);return Re(ft)?ft:void 0}var lt=function(Ce){return re.call(Ce)};function At(Ce,Xe){return!!(Xe=Xe??9007199254740991)&&(typeof Ce=="number"||x.test(Ce))&&Ce>-1&&Ce%1==0&&Ce<Xe}function Nt(Ce,Xe){if(sr(Ce))return!1;var ft=typeof Ce;return!(ft!="number"&&ft!="symbol"&&ft!="boolean"&&Ce!=null&&!Ot(Ce))||h.test(Ce)||!u.test(Ce)||Xe!=null&&Ce in Object(Xe)}function ut(Ce){return Ce==Ce&&!jr(Ce)}function lr(Ce,Xe){return function(ft){return ft!=null&&ft[Ce]===Xe&&(Xe!==void 0||Ce in Object(ft))}}(oe&&lt(new oe(new ArrayBuffer(1)))!="[object DataView]"||se&&lt(new se)!=l||ue&&lt(ue.resolve())!="[object Promise]"||pe&&lt(new pe)!=c||ce&&lt(new ce)!="[object WeakMap]")&&(lt=function(Ce){var Xe=re.call(Ce),ft=Xe==d?Ce.constructor:void 0,ze=ft?Me(ft):void 0;if(ze)switch(ze){case me:return"[object DataView]";case ge:return l;case _e:return"[object Promise]";case be:return c;case ye:return"[object WeakMap]"}return Xe});var Pt=dt(function(Ce){var Xe;Ce=(Xe=Ce)==null?"":function(ze){if(typeof ze=="string")return ze;if(Ot(ze))return De?De.call(ze):"";var Zt=ze+"";return Zt=="0"&&1/ze==-1/0?"-0":Zt}(Xe);var ft=[];return f.test(Ce)&&ft.push(""),Ce.replace(m,function(ze,Zt,wt,kt){ft.push(wt?kt.replace(p,"$1"):Zt||ze)}),ft});function Pe(Ce){if(typeof Ce=="string"||Ot(Ce))return Ce;var Xe=Ce+"";return Xe=="0"&&1/Ce==-1/0?"-0":Xe}function Me(Ce){if(Ce!=null){try{return X.call(Ce)}catch{}try{return Ce+""}catch{}}return""}var it,gt=(it=function(Ce,Xe,ft){Z.call(Ce,ft)?Ce[ft].push(Xe):Ce[ft]=[Xe]},function(Ce,Xe){var ft=sr(Ce)?q:Je,ze={};return ft(Ce,it,Ke(Xe),ze)});function dt(Ce,Xe){if(typeof Ce!="function"||Xe&&typeof Xe!="function")throw new TypeError("Expected a function");var ft=function(){var ze=arguments,Zt=Xe?Xe.apply(this,ze):ze[0],wt=ft.cache;if(wt.has(Zt))return wt.get(Zt);var kt=Ce.apply(this,ze);return ft.cache=wt.set(Zt,kt),kt};return ft.cache=new(dt.Cache||Ie),ft}function It(Ce,Xe){return Ce===Xe||Ce!=Ce&&Xe!=Xe}function xr(Ce){return function(Xe){return rt(Xe)&&ir(Xe)}(Ce)&&Z.call(Ce,"callee")&&(!H.call(Ce,"callee")||re.call(Ce)==o)}dt.Cache=Ie;var sr=Array.isArray;function ir(Ce){return Ce!=null&&wr(Ce.length)&&!_r(Ce)}function _r(Ce){var Xe=jr(Ce)?re.call(Ce):"";return Xe=="[object Function]"||Xe=="[object GeneratorFunction]"}function wr(Ce){return typeof Ce=="number"&&Ce>-1&&Ce%1==0&&Ce<=9007199254740991}function jr(Ce){var Xe=typeof Ce;return!!Ce&&(Xe=="object"||Xe=="function")}function rt(Ce){return!!Ce&&typeof Ce=="object"}function Ot(Ce){return typeof Ce=="symbol"||rt(Ce)&&re.call(Ce)=="[object Symbol]"}var rr=B?function(Ce){return function(Xe){return Ce(Xe)}}(B):function(Ce){return rt(Ce)&&wr(Ce.length)&&!!v[re.call(Ce)]};function nr(Ce){return ir(Ce)?nt(Ce):_t(Ce)}function Qt(Ce){return Ce}s.exports=gt}).call(this)}).call(this,typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(r,s,a){var i=Object.prototype.toString;s.exports=function(o){return o===!0||o===!1||function(l){return!!l&&typeof l=="object"}(o)&&i.call(o)=="[object Boolean]"}},{}],445:[function(r,s,a){(function(i){(function(){var o="[object Arguments]",l="[object Map]",d="[object Object]",c="[object Set]",u=/^\[object .+?Constructor\]$/,h=/^(?:0|[1-9]\d*)$/,f={};f["[object Float32Array]"]=f["[object Float64Array]"]=f["[object Int8Array]"]=f["[object Int16Array]"]=f["[object Int32Array]"]=f["[object Uint8Array]"]=f["[object Uint8ClampedArray]"]=f["[object Uint16Array]"]=f["[object Uint32Array]"]=!0,f[o]=f["[object Array]"]=f["[object ArrayBuffer]"]=f["[object Boolean]"]=f["[object DataView]"]=f["[object Date]"]=f["[object Error]"]=f["[object Function]"]=f[l]=f["[object Number]"]=f[d]=f["[object RegExp]"]=f[c]=f["[object String]"]=f["[object WeakMap]"]=!1;var m=typeof i=="object"&&i&&i.Object===Object&&i,p=typeof self=="object"&&self&&self.Object===Object&&self,g=m||p||Function("return this")(),x=typeof a=="object"&&a&&!a.nodeType&&a,v=x&&typeof s=="object"&&s&&!s.nodeType&&s,y=v&&v.exports===x,b=y&&m.process,j=function(){try{return b&&b.binding&&b.binding("util")}catch{}}(),T=j&&j.isTypedArray;function O(Pe,Me){for(var it=-1,gt=Pe==null?0:Pe.length;++it<gt;)if(Me(Pe[it],it,Pe))return!0;return!1}function R(Pe){var Me=-1,it=Array(Pe.size);return Pe.forEach(function(gt,dt){it[++Me]=[dt,gt]}),it}function D(Pe){var Me=-1,it=Array(Pe.size);return Pe.forEach(function(gt){it[++Me]=gt}),it}var B,q,Y,G=Array.prototype,I=Function.prototype,F=Object.prototype,S=g["__core-js_shared__"],E=I.toString,N=F.hasOwnProperty,C=(B=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"",k=F.toString,M=RegExp("^"+E.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),U=y?g.Buffer:void 0,$=g.Symbol,X=g.Uint8Array,Z=F.propertyIsEnumerable,re=G.splice,W=$?$.toStringTag:void 0,J=Object.getOwnPropertySymbols,V=U?U.isBuffer:void 0,H=(q=Object.keys,Y=Object,function(Pe){return q(Y(Pe))}),ee=ht(g,"DataView"),ie=ht(g,"Map"),oe=ht(g,"Promise"),se=ht(g,"Set"),ue=ht(g,"WeakMap"),pe=ht(Object,"create"),ce=_t(ee),ne=_t(ie),me=_t(oe),ge=_t(se),_e=_t(ue),be=$?$.prototype:void 0,ye=be?be.valueOf:void 0;function Oe(Pe){var Me=-1,it=Pe==null?0:Pe.length;for(this.clear();++Me<it;){var gt=Pe[Me];this.set(gt[0],gt[1])}}function Ne(Pe){var Me=-1,it=Pe==null?0:Pe.length;for(this.clear();++Me<it;){var gt=Pe[Me];this.set(gt[0],gt[1])}}function De(Pe){var Me=-1,it=Pe==null?0:Pe.length;for(this.clear();++Me<it;){var gt=Pe[Me];this.set(gt[0],gt[1])}}function Ge(Pe){var Me=-1,it=Pe==null?0:Pe.length;for(this.__data__=new De;++Me<it;)this.add(Pe[Me])}function Qe(Pe){var Me=this.__data__=new Ne(Pe);this.size=Me.size}function Ie(Pe,Me){var it=tt(Pe),gt=!it&&Se(Pe),dt=!it&&!gt&&ot(Pe),It=!it&&!gt&&!dt&&lr(Pe),xr=it||gt||dt||It,sr=xr?function(wr,jr){for(var rt=-1,Ot=Array(wr);++rt<wr;)Ot[rt]=jr(rt);return Ot}(Pe.length,String):[],ir=sr.length;for(var _r in Pe)!N.call(Pe,_r)||xr&&(_r=="length"||dt&&(_r=="offset"||_r=="parent")||It&&(_r=="buffer"||_r=="byteLength"||_r=="byteOffset")||Ke(_r,ir))||sr.push(_r);return sr}function Ae(Pe,Me){for(var it=Pe.length;it--;)if(Rt(Pe[it][0],Me))return it;return-1}function st(Pe){return Pe==null?Pe===void 0?"[object Undefined]":"[object Null]":W&&W in Object(Pe)?function(Me){var it=N.call(Me,W),gt=Me[W];try{Me[W]=void 0;var dt=!0}catch{}var It=k.call(Me);return dt&&(it?Me[W]=gt:delete Me[W]),It}(Pe):function(Me){return k.call(Me)}(Pe)}function nt(Pe){return ut(Pe)&&st(Pe)==o}function vt(Pe,Me,it,gt,dt){return Pe===Me||(Pe==null||Me==null||!ut(Pe)&&!ut(Me)?Pe!=Pe&&Me!=Me:function(It,xr,sr,ir,_r,wr){var jr=tt(It),rt=tt(xr),Ot=jr?"[object Array]":Re(It),rr=rt?"[object Array]":Re(xr),nr=(Ot=Ot==o?d:Ot)==d,Qt=(rr=rr==o?d:rr)==d,Ce=Ot==rr;if(Ce&&ot(It)){if(!ot(xr))return!1;jr=!0,nr=!1}if(Ce&&!nr)return wr||(wr=new Qe),jr||lr(It)?Le(It,xr,sr,ir,_r,wr):function(wt,kt,Cr,Jt,tr,Ut,xn){switch(Cr){case"[object DataView]":if(wt.byteLength!=kt.byteLength||wt.byteOffset!=kt.byteOffset)return!1;wt=wt.buffer,kt=kt.buffer;case"[object ArrayBuffer]":return!(wt.byteLength!=kt.byteLength||!Ut(new X(wt),new X(kt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Rt(+wt,+kt);case"[object Error]":return wt.name==kt.name&&wt.message==kt.message;case"[object RegExp]":case"[object String]":return wt==kt+"";case l:var vn=R;case c:var bn=1&Jt;if(vn||(vn=D),wt.size!=kt.size&&!bn)return!1;var Vr=xn.get(wt);if(Vr)return Vr==kt;Jt|=2,xn.set(wt,kt);var Wn=Le(vn(wt),vn(kt),Jt,tr,Ut,xn);return xn.delete(wt),Wn;case"[object Symbol]":if(ye)return ye.call(wt)==ye.call(kt)}return!1}(It,xr,Ot,sr,ir,_r,wr);if(!(1&sr)){var Xe=nr&&N.call(It,"__wrapped__"),ft=Qt&&N.call(xr,"__wrapped__");if(Xe||ft){var ze=Xe?It.value():It,Zt=ft?xr.value():xr;return wr||(wr=new Qe),_r(ze,Zt,sr,ir,wr)}}return Ce?(wr||(wr=new Qe),function(wt,kt,Cr,Jt,tr,Ut){var xn=1&Cr,vn=Ze(wt),bn=vn.length,Vr=Ze(kt).length;if(bn!=Vr&&!xn)return!1;for(var Wn=bn;Wn--;){var Ta=vn[Wn];if(!(xn?Ta in kt:N.call(kt,Ta)))return!1}var wn=Ut.get(wt);if(wn&&Ut.get(kt))return wn==kt;var Ka=!0;Ut.set(wt,kt),Ut.set(kt,wt);for(var vd=xn;++Wn<bn;){Ta=vn[Wn];var Xi=wt[Ta],_n=kt[Ta];if(Jt)var Br=xn?Jt(_n,Xi,Ta,kt,wt,Ut):Jt(Xi,_n,Ta,wt,kt,Ut);if(!(Br===void 0?Xi===_n||tr(Xi,_n,Cr,Jt,Ut):Br)){Ka=!1;break}vd||(vd=Ta=="constructor")}if(Ka&&!vd){var Ye=wt.constructor,Ee=kt.constructor;Ye==Ee||!("constructor"in wt)||!("constructor"in kt)||typeof Ye=="function"&&Ye instanceof Ye&&typeof Ee=="function"&&Ee instanceof Ee||(Ka=!1)}return Ut.delete(wt),Ut.delete(kt),Ka}(It,xr,sr,ir,_r,wr)):!1}(Pe,Me,it,gt,vt,dt))}function Je(Pe){return!(!Nt(Pe)||function(Me){return!!C&&C in Me}(Pe))&&(lt(Pe)?M:u).test(_t(Pe))}function Ue(Pe){if(it=(Me=Pe)&&Me.constructor,gt=typeof it=="function"&&it.prototype||F,Me!==gt)return H(Pe);var Me,it,gt,dt=[];for(var It in Object(Pe))N.call(Pe,It)&&It!="constructor"&&dt.push(It);return dt}function Le(Pe,Me,it,gt,dt,It){var xr=1&it,sr=Pe.length,ir=Me.length;if(sr!=ir&&!(xr&&ir>sr))return!1;var _r=It.get(Pe);if(_r&&It.get(Me))return _r==Me;var wr=-1,jr=!0,rt=2&it?new Ge:void 0;for(It.set(Pe,Me),It.set(Me,Pe);++wr<sr;){var Ot=Pe[wr],rr=Me[wr];if(gt)var nr=xr?gt(rr,Ot,wr,Me,Pe,It):gt(Ot,rr,wr,Pe,Me,It);if(nr!==void 0){if(nr)continue;jr=!1;break}if(rt){if(!O(Me,function(Qt,Ce){if(Xe=Ce,!rt.has(Xe)&&(Ot===Qt||dt(Ot,Qt,it,gt,It)))return rt.push(Ce);var Xe})){jr=!1;break}}else if(Ot!==rr&&!dt(Ot,rr,it,gt,It)){jr=!1;break}}return It.delete(Pe),It.delete(Me),jr}function Ze(Pe){return function(Me,it,gt){var dt=it(Me);return tt(Me)?dt:function(It,xr){for(var sr=-1,ir=xr.length,_r=It.length;++sr<ir;)It[_r+sr]=xr[sr];return It}(dt,gt(Me))}(Pe,Pt,yt)}function ct(Pe,Me){var it,gt,dt=Pe.__data__;return((gt=typeof(it=Me))=="string"||gt=="number"||gt=="symbol"||gt=="boolean"?it!=="__proto__":it===null)?dt[typeof Me=="string"?"string":"hash"]:dt.map}function ht(Pe,Me){var it=function(gt,dt){return gt==null?void 0:gt[dt]}(Pe,Me);return Je(it)?it:void 0}Oe.prototype.clear=function(){this.__data__=pe?pe(null):{},this.size=0},Oe.prototype.delete=function(Pe){var Me=this.has(Pe)&&delete this.__data__[Pe];return this.size-=Me?1:0,Me},Oe.prototype.get=function(Pe){var Me=this.__data__;if(pe){var it=Me[Pe];return it==="__lodash_hash_undefined__"?void 0:it}return N.call(Me,Pe)?Me[Pe]:void 0},Oe.prototype.has=function(Pe){var Me=this.__data__;return pe?Me[Pe]!==void 0:N.call(Me,Pe)},Oe.prototype.set=function(Pe,Me){var it=this.__data__;return this.size+=this.has(Pe)?0:1,it[Pe]=pe&&Me===void 0?"__lodash_hash_undefined__":Me,this},Ne.prototype.clear=function(){this.__data__=[],this.size=0},Ne.prototype.delete=function(Pe){var Me=this.__data__,it=Ae(Me,Pe);return!(it<0)&&(it==Me.length-1?Me.pop():re.call(Me,it,1),--this.size,!0)},Ne.prototype.get=function(Pe){var Me=this.__data__,it=Ae(Me,Pe);return it<0?void 0:Me[it][1]},Ne.prototype.has=function(Pe){return Ae(this.__data__,Pe)>-1},Ne.prototype.set=function(Pe,Me){var it=this.__data__,gt=Ae(it,Pe);return gt<0?(++this.size,it.push([Pe,Me])):it[gt][1]=Me,this},De.prototype.clear=function(){this.size=0,this.__data__={hash:new Oe,map:new(ie||Ne),string:new Oe}},De.prototype.delete=function(Pe){var Me=ct(this,Pe).delete(Pe);return this.size-=Me?1:0,Me},De.prototype.get=function(Pe){return ct(this,Pe).get(Pe)},De.prototype.has=function(Pe){return ct(this,Pe).has(Pe)},De.prototype.set=function(Pe,Me){var it=ct(this,Pe),gt=it.size;return it.set(Pe,Me),this.size+=it.size==gt?0:1,this},Ge.prototype.add=Ge.prototype.push=function(Pe){return this.__data__.set(Pe,"__lodash_hash_undefined__"),this},Ge.prototype.has=function(Pe){return this.__data__.has(Pe)},Qe.prototype.clear=function(){this.__data__=new Ne,this.size=0},Qe.prototype.delete=function(Pe){var Me=this.__data__,it=Me.delete(Pe);return this.size=Me.size,it},Qe.prototype.get=function(Pe){return this.__data__.get(Pe)},Qe.prototype.has=function(Pe){return this.__data__.has(Pe)},Qe.prototype.set=function(Pe,Me){var it=this.__data__;if(it instanceof Ne){var gt=it.__data__;if(!ie||gt.length<199)return gt.push([Pe,Me]),this.size=++it.size,this;it=this.__data__=new De(gt)}return it.set(Pe,Me),this.size=it.size,this};var yt=J?function(Pe){return Pe==null?[]:(Pe=Object(Pe),function(Me,it){for(var gt=-1,dt=Me==null?0:Me.length,It=0,xr=[];++gt<dt;){var sr=Me[gt];it(sr,gt,Me)&&(xr[It++]=sr)}return xr}(J(Pe),function(Me){return Z.call(Pe,Me)}))}:function(){return[]},Re=st;function Ke(Pe,Me){return!!(Me=Me??9007199254740991)&&(typeof Pe=="number"||h.test(Pe))&&Pe>-1&&Pe%1==0&&Pe<Me}function _t(Pe){if(Pe!=null){try{return E.call(Pe)}catch{}try{return Pe+""}catch{}}return""}function Rt(Pe,Me){return Pe===Me||Pe!=Pe&&Me!=Me}(ee&&Re(new ee(new ArrayBuffer(1)))!="[object DataView]"||ie&&Re(new ie)!=l||oe&&Re(oe.resolve())!="[object Promise]"||se&&Re(new se)!=c||ue&&Re(new ue)!="[object WeakMap]")&&(Re=function(Pe){var Me=st(Pe),it=Me==d?Pe.constructor:void 0,gt=it?_t(it):"";if(gt)switch(gt){case ce:return"[object DataView]";case ne:return l;case me:return"[object Promise]";case ge:return c;case _e:return"[object WeakMap]"}return Me});var Se=nt(function(){return arguments}())?nt:function(Pe){return ut(Pe)&&N.call(Pe,"callee")&&!Z.call(Pe,"callee")},tt=Array.isArray,ot=V||function(){return!1};function lt(Pe){if(!Nt(Pe))return!1;var Me=st(Pe);return Me=="[object Function]"||Me=="[object GeneratorFunction]"||Me=="[object AsyncFunction]"||Me=="[object Proxy]"}function At(Pe){return typeof Pe=="number"&&Pe>-1&&Pe%1==0&&Pe<=9007199254740991}function Nt(Pe){var Me=typeof Pe;return Pe!=null&&(Me=="object"||Me=="function")}function ut(Pe){return Pe!=null&&typeof Pe=="object"}var lr=T?function(Pe){return function(Me){return Pe(Me)}}(T):function(Pe){return ut(Pe)&&At(Pe.length)&&!!f[st(Pe)]};function Pt(Pe){return(Me=Pe)!=null&&At(Me.length)&&!lt(Me)?Ie(Pe):Ue(Pe);var Me}s.exports=function(Pe,Me){return vt(Pe,Me)}}).call(this)}).call(this,typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(r,s,a){(function(i){(function(){var o=typeof i=="object"&&i&&i.Object===Object&&i,l=typeof self=="object"&&self&&self.Object===Object&&self,d=o||l||Function("return this")(),c=Object.prototype,u=c.hasOwnProperty,h=c.toString,f=d.Symbol,m=f?f.toStringTag:void 0;function p(g){return g==null?g===void 0?"[object Undefined]":"[object Null]":m&&m in Object(g)?function(x){var v=u.call(x,m),y=x[m];try{x[m]=void 0;var b=!0}catch{}var j=h.call(x);return b&&(v?x[m]=y:delete x[m]),j}(g):function(x){return h.call(x)}(g)}s.exports=function(g){if(!function(v){var y=typeof v;return v!=null&&(y=="object"||y=="function")}(g))return!1;var x=p(g);return x=="[object Function]"||x=="[object GeneratorFunction]"||x=="[object AsyncFunction]"||x=="[object Proxy]"}}).call(this)}).call(this,typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(r,s,a){s.exports=function(i){return i==null}},{}],448:[function(r,s,a){s.exports=function(i){return i===void 0}},{}],449:[function(r,s,a){(function(i){(function(){var o=/^\[object .+?Constructor\]$/,l=typeof i=="object"&&i&&i.Object===Object&&i,d=typeof self=="object"&&self&&self.Object===Object&&self,c=l||d||Function("return this")();function u($,X){return!!($&&$.length)&&function(Z,re,W){if(re!=re)return function(H,ee,ie,oe){for(var se=H.length,ue=ie+-1;++ue<se;)if(ee(H[ue],ue,H))return ue;return-1}(Z,h,W);for(var J=W-1,V=Z.length;++J<V;)if(Z[J]===re)return J;return-1}($,X,0)>-1}function h($){return $!=$}function f($,X){return $.has(X)}function m($){var X=-1,Z=Array($.size);return $.forEach(function(re){Z[++X]=re}),Z}var p,g=Array.prototype,x=Function.prototype,v=Object.prototype,y=c["__core-js_shared__"],b=(p=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+p:"",j=x.toString,T=v.hasOwnProperty,O=v.toString,R=RegExp("^"+j.call(T).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),D=g.splice,B=M(c,"Map"),q=M(c,"Set"),Y=M(Object,"create");function G($){var X=-1,Z=$?$.length:0;for(this.clear();++X<Z;){var re=$[X];this.set(re[0],re[1])}}function I($){var X=-1,Z=$?$.length:0;for(this.clear();++X<Z;){var re=$[X];this.set(re[0],re[1])}}function F($){var X=-1,Z=$?$.length:0;for(this.clear();++X<Z;){var re=$[X];this.set(re[0],re[1])}}function S($){var X=-1,Z=$?$.length:0;for(this.__data__=new F;++X<Z;)this.add($[X])}function E($,X){for(var Z,re,W=$.length;W--;)if((Z=$[W][0])===(re=X)||Z!=Z&&re!=re)return W;return-1}function N($){return!(!U($)||(X=$,b&&b in X))&&(function(Z){var re=U(Z)?O.call(Z):"";return re=="[object Function]"||re=="[object GeneratorFunction]"}($)||function(Z){var re=!1;if(Z!=null&&typeof Z.toString!="function")try{re=!!(Z+"")}catch{}return re}($)?R:o).test(function(Z){if(Z!=null){try{return j.call(Z)}catch{}try{return Z+""}catch{}}return""}($));var X}G.prototype.clear=function(){this.__data__=Y?Y(null):{}},G.prototype.delete=function($){return this.has($)&&delete this.__data__[$]},G.prototype.get=function($){var X=this.__data__;if(Y){var Z=X[$];return Z==="__lodash_hash_undefined__"?void 0:Z}return T.call(X,$)?X[$]:void 0},G.prototype.has=function($){var X=this.__data__;return Y?X[$]!==void 0:T.call(X,$)},G.prototype.set=function($,X){return this.__data__[$]=Y&&X===void 0?"__lodash_hash_undefined__":X,this},I.prototype.clear=function(){this.__data__=[]},I.prototype.delete=function($){var X=this.__data__,Z=E(X,$);return!(Z<0)&&(Z==X.length-1?X.pop():D.call(X,Z,1),!0)},I.prototype.get=function($){var X=this.__data__,Z=E(X,$);return Z<0?void 0:X[Z][1]},I.prototype.has=function($){return E(this.__data__,$)>-1},I.prototype.set=function($,X){var Z=this.__data__,re=E(Z,$);return re<0?Z.push([$,X]):Z[re][1]=X,this},F.prototype.clear=function(){this.__data__={hash:new G,map:new(B||I),string:new G}},F.prototype.delete=function($){return k(this,$).delete($)},F.prototype.get=function($){return k(this,$).get($)},F.prototype.has=function($){return k(this,$).has($)},F.prototype.set=function($,X){return k(this,$).set($,X),this},S.prototype.add=S.prototype.push=function($){return this.__data__.set($,"__lodash_hash_undefined__"),this},S.prototype.has=function($){return this.__data__.has($)};var C=q&&1/m(new q([,-0]))[1]==1/0?function($){return new q($)}:function(){};function k($,X){var Z,re,W=$.__data__;return((re=typeof(Z=X))=="string"||re=="number"||re=="symbol"||re=="boolean"?Z!=="__proto__":Z===null)?W[typeof X=="string"?"string":"hash"]:W.map}function M($,X){var Z=function(re,W){return re==null?void 0:re[W]}($,X);return N(Z)?Z:void 0}function U($){var X=typeof $;return!!$&&(X=="object"||X=="function")}s.exports=function($){return $&&$.length?function(X,Z,re){var W=-1,J=u,V=X.length,H=!0,ee=[],ie=ee;if(V>=200){var oe=C(X);if(oe)return m(oe);H=!1,J=f,ie=new S}else ie=ee;e:for(;++W<V;){var se=X[W],ue=se;if(se=se!==0?se:0,H&&ue==ue){for(var pe=ie.length;pe--;)if(ie[pe]===ue)continue e;ee.push(se)}else J(ie,ue,re)||(ie!==ee&&ie.push(ue),ee.push(se))}return ee}($):[]}}).call(this)}).call(this,typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(r,s,a){var i=r("inherits"),o=r("hash-base"),l=r("safe-buffer").Buffer,d=new Array(16);function c(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function u(g,x){return g<<x|g>>>32-x}function h(g,x,v,y,b,j,T){return u(g+(x&v|~x&y)+b+j|0,T)+x|0}function f(g,x,v,y,b,j,T){return u(g+(x&y|v&~y)+b+j|0,T)+x|0}function m(g,x,v,y,b,j,T){return u(g+(x^v^y)+b+j|0,T)+x|0}function p(g,x,v,y,b,j,T){return u(g+(v^(x|~y))+b+j|0,T)+x|0}i(c,o),c.prototype._update=function(){for(var g=d,x=0;x<16;++x)g[x]=this._block.readInt32LE(4*x);var v=this._a,y=this._b,b=this._c,j=this._d;v=h(v,y,b,j,g[0],3614090360,7),j=h(j,v,y,b,g[1],3905402710,12),b=h(b,j,v,y,g[2],606105819,17),y=h(y,b,j,v,g[3],3250441966,22),v=h(v,y,b,j,g[4],4118548399,7),j=h(j,v,y,b,g[5],1200080426,12),b=h(b,j,v,y,g[6],2821735955,17),y=h(y,b,j,v,g[7],4249261313,22),v=h(v,y,b,j,g[8],1770035416,7),j=h(j,v,y,b,g[9],2336552879,12),b=h(b,j,v,y,g[10],4294925233,17),y=h(y,b,j,v,g[11],2304563134,22),v=h(v,y,b,j,g[12],1804603682,7),j=h(j,v,y,b,g[13],4254626195,12),b=h(b,j,v,y,g[14],2792965006,17),v=f(v,y=h(y,b,j,v,g[15],1236535329,22),b,j,g[1],4129170786,5),j=f(j,v,y,b,g[6],3225465664,9),b=f(b,j,v,y,g[11],643717713,14),y=f(y,b,j,v,g[0],3921069994,20),v=f(v,y,b,j,g[5],3593408605,5),j=f(j,v,y,b,g[10],38016083,9),b=f(b,j,v,y,g[15],3634488961,14),y=f(y,b,j,v,g[4],3889429448,20),v=f(v,y,b,j,g[9],568446438,5),j=f(j,v,y,b,g[14],3275163606,9),b=f(b,j,v,y,g[3],4107603335,14),y=f(y,b,j,v,g[8],1163531501,20),v=f(v,y,b,j,g[13],2850285829,5),j=f(j,v,y,b,g[2],4243563512,9),b=f(b,j,v,y,g[7],1735328473,14),v=m(v,y=f(y,b,j,v,g[12],2368359562,20),b,j,g[5],4294588738,4),j=m(j,v,y,b,g[8],2272392833,11),b=m(b,j,v,y,g[11],1839030562,16),y=m(y,b,j,v,g[14],4259657740,23),v=m(v,y,b,j,g[1],2763975236,4),j=m(j,v,y,b,g[4],1272893353,11),b=m(b,j,v,y,g[7],4139469664,16),y=m(y,b,j,v,g[10],3200236656,23),v=m(v,y,b,j,g[13],681279174,4),j=m(j,v,y,b,g[0],3936430074,11),b=m(b,j,v,y,g[3],3572445317,16),y=m(y,b,j,v,g[6],76029189,23),v=m(v,y,b,j,g[9],3654602809,4),j=m(j,v,y,b,g[12],3873151461,11),b=m(b,j,v,y,g[15],530742520,16),v=p(v,y=m(y,b,j,v,g[2],3299628645,23),b,j,g[0],4096336452,6),j=p(j,v,y,b,g[7],1126891415,10),b=p(b,j,v,y,g[14],2878612391,15),y=p(y,b,j,v,g[5],4237533241,21),v=p(v,y,b,j,g[12],1700485571,6),j=p(j,v,y,b,g[3],2399980690,10),b=p(b,j,v,y,g[10],4293915773,15),y=p(y,b,j,v,g[1],2240044497,21),v=p(v,y,b,j,g[8],1873313359,6),j=p(j,v,y,b,g[15],4264355552,10),b=p(b,j,v,y,g[6],2734768916,15),y=p(y,b,j,v,g[13],1309151649,21),v=p(v,y,b,j,g[4],4149444226,6),j=p(j,v,y,b,g[11],3174756917,10),b=p(b,j,v,y,g[2],718787259,15),y=p(y,b,j,v,g[9],3951481745,21),this._a=this._a+v|0,this._b=this._b+y|0,this._c=this._c+b|0,this._d=this._d+j|0},c.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var g=l.allocUnsafe(16);return g.writeInt32LE(this._a,0),g.writeInt32LE(this._b,4),g.writeInt32LE(this._c,8),g.writeInt32LE(this._d,12),g},s.exports=c},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(r,s,a){var i=r("bn.js"),o=r("brorand");function l(d){this.rand=d||new o.Rand}s.exports=l,l.create=function(d){return new l(d)},l.prototype._randbelow=function(d){var c=d.bitLength(),u=Math.ceil(c/8);do var h=new i(this.rand.generate(u));while(h.cmp(d)>=0);return h},l.prototype._randrange=function(d,c){var u=c.sub(d);return d.add(this._randbelow(u))},l.prototype.test=function(d,c,u){var h=d.bitLength(),f=i.mont(d),m=new i(1).toRed(f);c||(c=Math.max(1,h/48|0));for(var p=d.subn(1),g=0;!p.testn(g);g++);for(var x=d.shrn(g),v=p.toRed(f);c>0;c--){var y=this._randrange(new i(2),p);u&&u(y);var b=y.toRed(f).redPow(x);if(b.cmp(m)!==0&&b.cmp(v)!==0){for(var j=1;j<g;j++){if((b=b.redSqr()).cmp(m)===0)return!1;if(b.cmp(v)===0)break}if(j===g)return!1}}return!0},l.prototype.getDivisor=function(d,c){var u=d.bitLength(),h=i.mont(d),f=new i(1).toRed(h);c||(c=Math.max(1,u/48|0));for(var m=d.subn(1),p=0;!m.testn(p);p++);for(var g=d.shrn(p),x=m.toRed(h);c>0;c--){var v=this._randrange(new i(2),m),y=d.gcd(v);if(y.cmpn(1)!==0)return y;var b=v.toRed(h).redPow(g);if(b.cmp(f)!==0&&b.cmp(x)!==0){for(var j=1;j<p;j++){if((b=b.redSqr()).cmp(f)===0)return b.fromRed().subn(1).gcd(d);if(b.cmp(x)===0)break}if(j===p)return(b=b.redSqr()).fromRed().subn(1).gcd(d)}}return!1}},{"bn.js":452,brorand:187}],452:[function(r,s,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],453:[function(r,s,a){function i(o,l){if(!o)throw new Error(l||"Assertion failed")}s.exports=i,i.equal=function(o,l,d){if(o!=l)throw new Error(d||"Assertion failed: "+o+" != "+l)}},{}],454:[function(r,s,a){var i=a;function o(d){return d.length===1?"0"+d:d}function l(d){for(var c="",u=0;u<d.length;u++)c+=o(d[u].toString(16));return c}i.toArray=function(d,c){if(Array.isArray(d))return d.slice();if(!d)return[];var u=[];if(typeof d!="string"){for(var h=0;h<d.length;h++)u[h]=0|d[h];return u}if(c==="hex")for((d=d.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(d="0"+d),h=0;h<d.length;h+=2)u.push(parseInt(d[h]+d[h+1],16));else for(h=0;h<d.length;h++){var f=d.charCodeAt(h),m=f>>8,p=255&f;m?u.push(m,p):u.push(p)}return u},i.zero2=o,i.toHex=l,i.encode=function(d,c){return c==="hex"?l(d):d}},{}],455:[function(r,s,a){s.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(r,s,a){var i=r("asn1.js");a.certificate=r("./certificate");var o=i.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});a.RSAPrivateKey=o;var l=i.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});a.RSAPublicKey=l;var d=i.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(c),this.key("subjectPublicKey").bitstr())});a.PublicKey=d;var c=i.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),u=i.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(c),this.key("subjectPrivateKey").octstr())});a.PrivateKey=u;var h=i.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});a.EncryptedPrivateKey=h;var f=i.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});a.DSAPrivateKey=f,a.DSAparam=i.define("DSAparam",function(){this.int()});var m=i.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(p),this.key("publicKey").optional().explicit(1).bitstr())});a.ECPrivateKey=m;var p=i.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});a.signature=i.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":457,"asn1.js":170}],457:[function(r,s,a){var i=r("asn1.js"),o=i.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),l=i.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),d=i.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),c=i.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(d),this.key("subjectPublicKey").bitstr())}),u=i.define("RelativeDistinguishedName",function(){this.setof(l)}),h=i.define("RDNSequence",function(){this.seqof(u)}),f=i.define("Name",function(){this.choice({rdnSequence:this.use(h)})}),m=i.define("Validity",function(){this.seq().obj(this.key("notBefore").use(o),this.key("notAfter").use(o))}),p=i.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),g=i.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(d),this.key("issuer").use(f),this.key("validity").use(m),this.key("subject").use(f),this.key("subjectPublicKeyInfo").use(c),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(p).optional())}),x=i.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(g),this.key("signatureAlgorithm").use(d),this.key("signatureValue").bitstr())});s.exports=x},{"asn1.js":170}],458:[function(r,s,a){var i=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,o=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,l=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,d=r("evp_bytestokey"),c=r("browserify-aes"),u=r("safe-buffer").Buffer;s.exports=function(h,f){var m,p=h.toString(),g=p.match(i);if(g){var x="aes"+g[1],v=u.from(g[2],"hex"),y=u.from(g[3].replace(/[\r\n]/g,""),"base64"),b=d(f,v.slice(0,8),parseInt(g[1],10)).key,j=[],T=c.createDecipheriv(x,b,v);j.push(T.update(y)),j.push(T.final()),m=u.concat(j)}else{var O=p.match(l);m=u.from(O[2].replace(/[\r\n]/g,""),"base64")}return{tag:p.match(o)[1],data:m}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(r,s,a){var i=r("./asn1"),o=r("./aesid.json"),l=r("./fixProc"),d=r("browserify-aes"),c=r("pbkdf2"),u=r("safe-buffer").Buffer;function h(f){var m;typeof f!="object"||u.isBuffer(f)||(m=f.passphrase,f=f.key),typeof f=="string"&&(f=u.from(f));var p,g,x=l(f,m),v=x.tag,y=x.data;switch(v){case"CERTIFICATE":g=i.certificate.decode(y,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(g||(g=i.PublicKey.decode(y,"der")),p=g.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPublicKey.decode(g.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return g.subjectPrivateKey=g.subjectPublicKey,{type:"ec",data:g};case"1.2.840.10040.4.1":return g.algorithm.params.pub_key=i.DSAparam.decode(g.subjectPublicKey.data,"der"),{type:"dsa",data:g.algorithm.params};default:throw new Error("unknown key id "+p)}case"ENCRYPTED PRIVATE KEY":y=function(b,j){var T=b.algorithm.decrypt.kde.kdeparams.salt,O=parseInt(b.algorithm.decrypt.kde.kdeparams.iters.toString(),10),R=o[b.algorithm.decrypt.cipher.algo.join(".")],D=b.algorithm.decrypt.cipher.iv,B=b.subjectPrivateKey,q=parseInt(R.split("-")[1],10)/8,Y=c.pbkdf2Sync(j,T,O,q,"sha1"),G=d.createDecipheriv(R,Y,D),I=[];return I.push(G.update(B)),I.push(G.final()),u.concat(I)}(y=i.EncryptedPrivateKey.decode(y,"der"),m);case"PRIVATE KEY":switch(p=(g=i.PrivateKey.decode(y,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPrivateKey.decode(g.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:g.algorithm.curve,privateKey:i.ECPrivateKey.decode(g.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return g.algorithm.params.priv_key=i.DSAparam.decode(g.subjectPrivateKey,"der"),{type:"dsa",params:g.algorithm.params};default:throw new Error("unknown key id "+p)}case"RSA PUBLIC KEY":return i.RSAPublicKey.decode(y,"der");case"RSA PRIVATE KEY":return i.RSAPrivateKey.decode(y,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:i.DSAPrivateKey.decode(y,"der")};case"EC PRIVATE KEY":return{curve:(y=i.ECPrivateKey.decode(y,"der")).parameters.value,privateKey:y.privateKey};default:throw new Error("unknown key type "+v)}}s.exports=h,h.signature=i.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(r,s,a){a.pbkdf2=r("./lib/async"),a.pbkdf2Sync=r("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(r,s,a){(function(i){(function(){var o,l,d=r("safe-buffer").Buffer,c=r("./precondition"),u=r("./default-encoding"),h=r("./sync"),f=r("./to-buffer"),m=i.crypto&&i.crypto.subtle,p={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},g=[];function x(){return l||(l=i.process&&i.process.nextTick?i.process.nextTick:i.queueMicrotask?i.queueMicrotask:i.setImmediate?i.setImmediate:i.setTimeout)}function v(y,b,j,T,O){return m.importKey("raw",y,{name:"PBKDF2"},!1,["deriveBits"]).then(function(R){return m.deriveBits({name:"PBKDF2",salt:b,iterations:j,hash:{name:O}},R,T<<3)}).then(function(R){return d.from(R)})}s.exports=function(y,b,j,T,O,R){typeof O=="function"&&(R=O,O=void 0);var D=p[(O=O||"sha1").toLowerCase()];if(D&&typeof i.Promise=="function"){if(c(j,T),y=f(y,u,"Password"),b=f(b,u,"Salt"),typeof R!="function")throw new Error("No callback provided to pbkdf2");(function(B,q){B.then(function(Y){x()(function(){q(null,Y)})},function(Y){x()(function(){q(Y)})})})(function(B){if(i.process&&!i.process.browser||!m||!m.importKey||!m.deriveBits)return Promise.resolve(!1);if(g[B]!==void 0)return g[B];var q=v(o=o||d.alloc(8),o,10,128,B).then(function(){return!0}).catch(function(){return!1});return g[B]=q,q}(D).then(function(B){return B?v(y,b,j,T,D):h(y,b,j,T,O)}),R)}else x()(function(){var B;try{B=h(y,b,j,T,O)}catch(q){return R(q)}R(null,B)})}}).call(this)}).call(this,typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(r,s,a){(function(i,o){(function(){var l;o.process&&o.process.browser?l="utf-8":o.process&&o.process.version?l=parseInt(i.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":l="utf-8",s.exports=l}).call(this)}).call(this,r("_process"),typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(r,s,a){var i=Math.pow(2,30)-1;s.exports=function(o,l){if(typeof o!="number")throw new TypeError("Iterations not a number");if(o<0)throw new TypeError("Bad iterations");if(typeof l!="number")throw new TypeError("Key length not a number");if(l<0||l>i||l!=l)throw new TypeError("Bad key length")}},{}],464:[function(r,s,a){var i=r("create-hash/md5"),o=r("ripemd160"),l=r("sha.js"),d=r("safe-buffer").Buffer,c=r("./precondition"),u=r("./default-encoding"),h=r("./to-buffer"),f=d.alloc(128),m={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function p(g,x,v){var y=function(D){function B(q){return l(D).update(q).digest()}return D==="rmd160"||D==="ripemd160"?function(q){return new o().update(q).digest()}:D==="md5"?i:B}(g),b=g==="sha512"||g==="sha384"?128:64;x.length>b?x=y(x):x.length<b&&(x=d.concat([x,f],b));for(var j=d.allocUnsafe(b+m[g]),T=d.allocUnsafe(b+m[g]),O=0;O<b;O++)j[O]=54^x[O],T[O]=92^x[O];var R=d.allocUnsafe(b+v+4);j.copy(R,0,0,b),this.ipad1=R,this.ipad2=j,this.opad=T,this.alg=g,this.blocksize=b,this.hash=y,this.size=m[g]}p.prototype.run=function(g,x){return g.copy(x,this.blocksize),this.hash(x).copy(this.opad,this.blocksize),this.hash(this.opad)},s.exports=function(g,x,v,y,b){c(v,y);var j=new p(b=b||"sha1",g=h(g,u,"Password"),(x=h(x,u,"Salt")).length),T=d.allocUnsafe(y),O=d.allocUnsafe(x.length+4);x.copy(O,0,0,x.length);for(var R=0,D=m[b],B=Math.ceil(y/D),q=1;q<=B;q++){O.writeUInt32BE(q,x.length);for(var Y=j.run(O,j.ipad1),G=Y,I=1;I<v;I++){G=j.run(G,j.ipad2);for(var F=0;F<D;F++)Y[F]^=G[F]}Y.copy(T,R),R+=D}return T}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(r,s,a){var i=r("safe-buffer").Buffer;s.exports=function(o,l,d){if(i.isBuffer(o))return o;if(typeof o=="string")return i.from(o,l);if(ArrayBuffer.isView(o))return i.from(o.buffer);throw new TypeError(d+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(r,s,a){(function(i){(function(){i===void 0||!i.version||i.version.indexOf("v0.")===0||i.version.indexOf("v1.")===0&&i.version.indexOf("v1.8.")!==0?s.exports={nextTick:function(o,l,d,c){if(typeof o!="function")throw new TypeError('"callback" argument must be a function');var u,h,f=arguments.length;switch(f){case 0:case 1:return i.nextTick(o);case 2:return i.nextTick(function(){o.call(null,l)});case 3:return i.nextTick(function(){o.call(null,l,d)});case 4:return i.nextTick(function(){o.call(null,l,d,c)});default:for(u=new Array(f-1),h=0;h<u.length;)u[h++]=arguments[h];return i.nextTick(function(){o.apply(null,u)})}}}:s.exports=i}).call(this)}).call(this,r("_process"))},{_process:467}],467:[function(r,s,a){var i,o,l=s.exports={};function d(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function u(b){if(i===setTimeout)return setTimeout(b,0);if((i===d||!i)&&setTimeout)return i=setTimeout,setTimeout(b,0);try{return i(b,0)}catch{try{return i.call(null,b,0)}catch{return i.call(this,b,0)}}}(function(){try{i=typeof setTimeout=="function"?setTimeout:d}catch{i=d}try{o=typeof clearTimeout=="function"?clearTimeout:c}catch{o=c}})();var h,f=[],m=!1,p=-1;function g(){m&&h&&(m=!1,h.length?f=h.concat(f):p=-1,f.length&&x())}function x(){if(!m){var b=u(g);m=!0;for(var j=f.length;j;){for(h=f,f=[];++p<j;)h&&h[p].run();p=-1,j=f.length}h=null,m=!1,function(T){if(o===clearTimeout)return clearTimeout(T);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(T);try{o(T)}catch{try{return o.call(null,T)}catch{return o.call(this,T)}}}(b)}}function v(b,j){this.fun=b,this.array=j}function y(){}l.nextTick=function(b){var j=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)j[T-1]=arguments[T];f.push(new v(b,j)),f.length!==1||m||u(x)},v.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=y,l.addListener=y,l.once=y,l.off=y,l.removeListener=y,l.removeAllListeners=y,l.emit=y,l.prependListener=y,l.prependOnceListener=y,l.listeners=function(b){return[]},l.binding=function(b){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(b){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],468:[function(r,s,a){a.publicEncrypt=r("./publicEncrypt"),a.privateDecrypt=r("./privateDecrypt"),a.privateEncrypt=function(i,o){return a.publicEncrypt(i,o,!0)},a.publicDecrypt=function(i,o){return a.privateDecrypt(i,o,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(r,s,a){var i=r("create-hash"),o=r("safe-buffer").Buffer;function l(d){var c=o.allocUnsafe(4);return c.writeUInt32BE(d,0),c}s.exports=function(d,c){for(var u,h=o.alloc(0),f=0;h.length<c;)u=l(f++),h=o.concat([h,i("sha1").update(d).update(u).digest()]);return h.slice(0,c)}},{"create-hash":386,"safe-buffer":494}],470:[function(r,s,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],471:[function(r,s,a){var i=r("parse-asn1"),o=r("./mgf"),l=r("./xor"),d=r("bn.js"),c=r("browserify-rsa"),u=r("create-hash"),h=r("./withPublic"),f=r("safe-buffer").Buffer;s.exports=function(m,p,g){var x;x=m.padding?m.padding:g?1:4;var v,y=i(m),b=y.modulus.byteLength();if(p.length>b||new d(p).cmp(y.modulus)>=0)throw new Error("decryption error");v=g?h(new d(p),y):c(p,y);var j=f.alloc(b-v.length);if(v=f.concat([j,v],b),x===4)return function(T,O){var R=T.modulus.byteLength(),D=u("sha1").update(f.alloc(0)).digest(),B=D.length;if(O[0]!==0)throw new Error("decryption error");var q=O.slice(1,B+1),Y=O.slice(B+1),G=l(q,o(Y,B)),I=l(Y,o(G,R-B-1));if(function(S,E){S=f.from(S),E=f.from(E);var N=0,C=S.length;S.length!==E.length&&(N++,C=Math.min(S.length,E.length));for(var k=-1;++k<C;)N+=S[k]^E[k];return N}(D,I.slice(0,B)))throw new Error("decryption error");for(var F=B;I[F]===0;)F++;if(I[F++]!==1)throw new Error("decryption error");return I.slice(F)}(y,v);if(x===1)return function(T,O,R){for(var D=O.slice(0,2),B=2,q=0;O[B++]!==0;)if(B>=O.length){q++;break}var Y=O.slice(2,B-1);if((D.toString("hex")!=="0002"&&!R||D.toString("hex")!=="0001"&&R)&&q++,Y.length<8&&q++,q)throw new Error("decryption error");return O.slice(B)}(0,v,g);if(x===3)return v;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(r,s,a){var i=r("parse-asn1"),o=r("randombytes"),l=r("create-hash"),d=r("./mgf"),c=r("./xor"),u=r("bn.js"),h=r("./withPublic"),f=r("browserify-rsa"),m=r("safe-buffer").Buffer;s.exports=function(p,g,x){var v;v=p.padding?p.padding:x?1:4;var y,b=i(p);if(v===4)y=function(j,T){var O=j.modulus.byteLength(),R=T.length,D=l("sha1").update(m.alloc(0)).digest(),B=D.length,q=2*B;if(R>O-q-2)throw new Error("message too long");var Y=m.alloc(O-R-q-2),G=O-B-1,I=o(B),F=c(m.concat([D,Y,m.alloc(1,1),T],G),d(I,G)),S=c(I,d(F,B));return new u(m.concat([m.alloc(1),S,F],O))}(b,g);else if(v===1)y=function(j,T,O){var R,D=T.length,B=j.modulus.byteLength();if(D>B-11)throw new Error("message too long");return R=O?m.alloc(B-D-3,255):function(q){for(var Y,G=m.allocUnsafe(q),I=0,F=o(2*q),S=0;I<q;)S===F.length&&(F=o(2*q),S=0),(Y=F[S++])&&(G[I++]=Y);return G}(B-D-3),new u(m.concat([m.from([0,O?1:2]),R,m.alloc(1),T],B))}(b,g,x);else{if(v!==3)throw new Error("unknown padding");if((y=new u(g)).cmp(b.modulus)>=0)throw new Error("data too long for modulus")}return x?f(y,b):h(y,b)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(r,s,a){var i=r("bn.js"),o=r("safe-buffer").Buffer;s.exports=function(l,d){return o.from(l.toRed(i.mont(d.modulus)).redPow(new i(d.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(r,s,a){s.exports=function(i,o){for(var l=i.length,d=-1;++d<l;)i[d]^=o[d];return i}},{}],475:[function(r,s,a){(function(i,o){(function(){var l=r("safe-buffer").Buffer,d=o.crypto||o.msCrypto;d&&d.getRandomValues?s.exports=function(c,u){if(c>4294967295)throw new RangeError("requested too many random bytes");var h=l.allocUnsafe(c);if(c>0)if(c>65536)for(var f=0;f<c;f+=65536)d.getRandomValues(h.slice(f,f+65536));else d.getRandomValues(h);return typeof u=="function"?i.nextTick(function(){u(null,h)}):h}:s.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,r("_process"),typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(r,s,a){(function(i,o){(function(){function l(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var d=r("safe-buffer"),c=r("randombytes"),u=d.Buffer,h=d.kMaxLength,f=o.crypto||o.msCrypto,m=Math.pow(2,32)-1;function p(v,y){if(typeof v!="number"||v!=v)throw new TypeError("offset must be a number");if(v>m||v<0)throw new TypeError("offset must be a uint32");if(v>h||v>y)throw new RangeError("offset out of range")}function g(v,y,b){if(typeof v!="number"||v!=v)throw new TypeError("size must be a number");if(v>m||v<0)throw new TypeError("size must be a uint32");if(v+y>b||v>h)throw new RangeError("buffer too small")}function x(v,y,b,j){if(i.browser){var T=v.buffer,O=new Uint8Array(T,y,b);return f.getRandomValues(O),j?void i.nextTick(function(){j(null,v)}):v}if(!j)return c(b).copy(v,y),v;c(b,function(R,D){if(R)return j(R);D.copy(v,y),j(null,v)})}f&&f.getRandomValues||!i.browser?(a.randomFill=function(v,y,b,j){if(!(u.isBuffer(v)||v instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof y=="function")j=y,y=0,b=v.length;else if(typeof b=="function")j=b,b=v.length-y;else if(typeof j!="function")throw new TypeError('"cb" argument must be a function');return p(y,v.length),g(b,y,v.length),x(v,y,b,j)},a.randomFillSync=function(v,y,b){if(y===void 0&&(y=0),!(u.isBuffer(v)||v instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return p(y,v.length),b===void 0&&(b=v.length-y),g(b,y,v.length),x(v,y,b)}):(a.randomFill=l,a.randomFillSync=l)}).call(this)}).call(this,r("_process"),typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(r,s,a){var i={};function o(d,c,u){u||(u=Error);var h=function(f){var m,p;function g(x,v,y){return f.call(this,function(b,j,T){return typeof c=="string"?c:c(b,j,T)}(x,v,y))||this}return p=f,(m=g).prototype=Object.create(p.prototype),m.prototype.constructor=m,m.__proto__=p,g}(u);h.prototype.name=u.name,h.prototype.code=d,i[d]=h}function l(d,c){if(Array.isArray(d)){var u=d.length;return d=d.map(function(h){return String(h)}),u>2?"one of ".concat(c," ").concat(d.slice(0,u-1).join(", "),", or ")+d[u-1]:u===2?"one of ".concat(c," ").concat(d[0]," or ").concat(d[1]):"of ".concat(c," ").concat(d[0])}return"of ".concat(c," ").concat(String(d))}o("ERR_INVALID_OPT_VALUE",function(d,c){return'The value "'+c+'" is invalid for option "'+d+'"'},TypeError),o("ERR_INVALID_ARG_TYPE",function(d,c,u){var h,f,m;if(typeof c=="string"&&(f="not ",c.substr(0,f.length)===f)?(h="must not be",c=c.replace(/^not /,"")):h="must be",function(g,x,v){return(v===void 0||v>g.length)&&(v=g.length),g.substring(v-x.length,v)===x}(d," argument"))m="The ".concat(d," ").concat(h," ").concat(l(c,"type"));else{var p=function(g,x,v){return typeof v!="number"&&(v=0),!(v+x.length>g.length)&&g.indexOf(x,v)!==-1}(d,".")?"property":"argument";m='The "'.concat(d,'" ').concat(p," ").concat(h," ").concat(l(c,"type"))}return m+=". Received type ".concat(typeof u)},TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",function(d){return"The "+d+" method is not implemented"}),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",function(d){return"Cannot call "+d+" after a stream was destroyed"}),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",function(d){return"Unknown encoding: "+d},TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),s.exports.codes=i},{}],478:[function(r,s,a){(function(i){(function(){var o=Object.keys||function(g){var x=[];for(var v in g)x.push(v);return x};s.exports=f;var l=r("./_stream_readable"),d=r("./_stream_writable");r("inherits")(f,l);for(var c=o(d.prototype),u=0;u<c.length;u++){var h=c[u];f.prototype[h]||(f.prototype[h]=d.prototype[h])}function f(g){if(!(this instanceof f))return new f(g);l.call(this,g),d.call(this,g),this.allowHalfOpen=!0,g&&(g.readable===!1&&(this.readable=!1),g.writable===!1&&(this.writable=!1),g.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",m)))}function m(){this._writableState.ended||i.nextTick(p,this)}function p(g){g.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}})}).call(this)}).call(this,r("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(r,s,a){s.exports=o;var i=r("./_stream_transform");function o(l){if(!(this instanceof o))return new o(l);i.call(this,l)}r("inherits")(o,i),o.prototype._transform=function(l,d,c){c(null,l)}},{"./_stream_transform":481,inherits:440}],480:[function(r,s,a){(function(i,o){(function(){var l;s.exports=G,G.ReadableState=Y,r("events").EventEmitter;var d=function(V,H){return V.listeners(H).length},c=r("./internal/streams/stream"),u=r("buffer").Buffer,h=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},f,m=r("util");f=m&&m.debuglog?m.debuglog("stream"):function(){};var p,g,x,v=r("./internal/streams/buffer_list"),y=r("./internal/streams/destroy"),b=r("./internal/streams/state").getHighWaterMark,j=r("../errors").codes,T=j.ERR_INVALID_ARG_TYPE,O=j.ERR_STREAM_PUSH_AFTER_EOF,R=j.ERR_METHOD_NOT_IMPLEMENTED,D=j.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r("inherits")(G,c);var B=y.errorOrDestroy,q=["error","close","destroy","pause","resume"];function Y(V,H,ee){l=l||r("./_stream_duplex"),V=V||{},typeof ee!="boolean"&&(ee=H instanceof l),this.objectMode=!!V.objectMode,ee&&(this.objectMode=this.objectMode||!!V.readableObjectMode),this.highWaterMark=b(this,V,"readableHighWaterMark",ee),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=V.emitClose!==!1,this.autoDestroy=!!V.autoDestroy,this.destroyed=!1,this.defaultEncoding=V.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,V.encoding&&(p||(p=r("string_decoder/").StringDecoder),this.decoder=new p(V.encoding),this.encoding=V.encoding)}function G(V){if(l=l||r("./_stream_duplex"),!(this instanceof G))return new G(V);var H=this instanceof l;this._readableState=new Y(V,this,H),this.readable=!0,V&&(typeof V.read=="function"&&(this._read=V.read),typeof V.destroy=="function"&&(this._destroy=V.destroy)),c.call(this)}function I(V,H,ee,ie,oe){f("readableAddChunk",H);var se,ue=V._readableState;if(H===null)ue.reading=!1,function(pe,ce){if(f("onEofChunk"),!ce.ended){if(ce.decoder){var ne=ce.decoder.end();ne&&ne.length&&(ce.buffer.push(ne),ce.length+=ce.objectMode?1:ne.length)}ce.ended=!0,ce.sync?E(pe):(ce.needReadable=!1,ce.emittedReadable||(ce.emittedReadable=!0,N(pe)))}}(V,ue);else if(oe||(se=function(pe,ce){var ne;me=ce,u.isBuffer(me)||me instanceof h||typeof ce=="string"||ce===void 0||pe.objectMode||(ne=new T("chunk",["string","Buffer","Uint8Array"],ce));var me;return ne}(ue,H)),se)B(V,se);else if(ue.objectMode||H&&H.length>0)if(typeof H=="string"||ue.objectMode||Object.getPrototypeOf(H)===u.prototype||(H=function(pe){return u.from(pe)}(H)),ie)ue.endEmitted?B(V,new D):F(V,ue,H,!0);else if(ue.ended)B(V,new O);else{if(ue.destroyed)return!1;ue.reading=!1,ue.decoder&&!ee?(H=ue.decoder.write(H),ue.objectMode||H.length!==0?F(V,ue,H,!1):C(V,ue)):F(V,ue,H,!1)}else ie||(ue.reading=!1,C(V,ue));return!ue.ended&&(ue.length<ue.highWaterMark||ue.length===0)}function F(V,H,ee,ie){H.flowing&&H.length===0&&!H.sync?(H.awaitDrain=0,V.emit("data",ee)):(H.length+=H.objectMode?1:ee.length,ie?H.buffer.unshift(ee):H.buffer.push(ee),H.needReadable&&E(V)),C(V,H)}Object.defineProperty(G.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(V){this._readableState&&(this._readableState.destroyed=V)}}),G.prototype.destroy=y.destroy,G.prototype._undestroy=y.undestroy,G.prototype._destroy=function(V,H){H(V)},G.prototype.push=function(V,H){var ee,ie=this._readableState;return ie.objectMode?ee=!0:typeof V=="string"&&((H=H||ie.defaultEncoding)!==ie.encoding&&(V=u.from(V,H),H=""),ee=!0),I(this,V,H,!1,ee)},G.prototype.unshift=function(V){return I(this,V,null,!0,!1)},G.prototype.isPaused=function(){return this._readableState.flowing===!1},G.prototype.setEncoding=function(V){p||(p=r("string_decoder/").StringDecoder);var H=new p(V);this._readableState.decoder=H,this._readableState.encoding=this._readableState.decoder.encoding;for(var ee=this._readableState.buffer.head,ie="";ee!==null;)ie+=H.write(ee.data),ee=ee.next;return this._readableState.buffer.clear(),ie!==""&&this._readableState.buffer.push(ie),this._readableState.length=ie.length,this};function S(V,H){return V<=0||H.length===0&&H.ended?0:H.objectMode?1:V!=V?H.flowing&&H.length?H.buffer.head.data.length:H.length:(V>H.highWaterMark&&(H.highWaterMark=function(ee){return ee>=1073741824?ee=1073741824:(ee--,ee|=ee>>>1,ee|=ee>>>2,ee|=ee>>>4,ee|=ee>>>8,ee|=ee>>>16,ee++),ee}(V)),V<=H.length?V:H.ended?H.length:(H.needReadable=!0,0))}function E(V){var H=V._readableState;f("emitReadable",H.needReadable,H.emittedReadable),H.needReadable=!1,H.emittedReadable||(f("emitReadable",H.flowing),H.emittedReadable=!0,i.nextTick(N,V))}function N(V){var H=V._readableState;f("emitReadable_",H.destroyed,H.length,H.ended),H.destroyed||!H.length&&!H.ended||(V.emit("readable"),H.emittedReadable=!1),H.needReadable=!H.flowing&&!H.ended&&H.length<=H.highWaterMark,X(V)}function C(V,H){H.readingMore||(H.readingMore=!0,i.nextTick(k,V,H))}function k(V,H){for(;!H.reading&&!H.ended&&(H.length<H.highWaterMark||H.flowing&&H.length===0);){var ee=H.length;if(f("maybeReadMore read 0"),V.read(0),ee===H.length)break}H.readingMore=!1}function M(V){var H=V._readableState;H.readableListening=V.listenerCount("readable")>0,H.resumeScheduled&&!H.paused?H.flowing=!0:V.listenerCount("data")>0&&V.resume()}function U(V){f("readable nexttick read 0"),V.read(0)}function $(V,H){f("resume",H.reading),H.reading||V.read(0),H.resumeScheduled=!1,V.emit("resume"),X(V),H.flowing&&!H.reading&&V.read(0)}function X(V){var H=V._readableState;for(f("flow",H.flowing);H.flowing&&V.read()!==null;);}function Z(V,H){return H.length===0?null:(H.objectMode?ee=H.buffer.shift():!V||V>=H.length?(ee=H.decoder?H.buffer.join(""):H.buffer.length===1?H.buffer.first():H.buffer.concat(H.length),H.buffer.clear()):ee=H.buffer.consume(V,H.decoder),ee);var ee}function re(V){var H=V._readableState;f("endReadable",H.endEmitted),H.endEmitted||(H.ended=!0,i.nextTick(W,H,V))}function W(V,H){if(f("endReadableNT",V.endEmitted,V.length),!V.endEmitted&&V.length===0&&(V.endEmitted=!0,H.readable=!1,H.emit("end"),V.autoDestroy)){var ee=H._writableState;(!ee||ee.autoDestroy&&ee.finished)&&H.destroy()}}function J(V,H){for(var ee=0,ie=V.length;ee<ie;ee++)if(V[ee]===H)return ee;return-1}G.prototype.read=function(V){f("read",V),V=parseInt(V,10);var H=this._readableState,ee=V;if(V!==0&&(H.emittedReadable=!1),V===0&&H.needReadable&&((H.highWaterMark!==0?H.length>=H.highWaterMark:H.length>0)||H.ended))return f("read: emitReadable",H.length,H.ended),H.length===0&&H.ended?re(this):E(this),null;if((V=S(V,H))===0&&H.ended)return H.length===0&&re(this),null;var ie,oe=H.needReadable;return f("need readable",oe),(H.length===0||H.length-V<H.highWaterMark)&&f("length less than watermark",oe=!0),H.ended||H.reading?f("reading or ended",oe=!1):oe&&(f("do read"),H.reading=!0,H.sync=!0,H.length===0&&(H.needReadable=!0),this._read(H.highWaterMark),H.sync=!1,H.reading||(V=S(ee,H))),(ie=V>0?Z(V,H):null)===null?(H.needReadable=H.length<=H.highWaterMark,V=0):(H.length-=V,H.awaitDrain=0),H.length===0&&(H.ended||(H.needReadable=!0),ee!==V&&H.ended&&re(this)),ie!==null&&this.emit("data",ie),ie},G.prototype._read=function(V){B(this,new R("_read()"))},G.prototype.pipe=function(V,H){var ee=this,ie=this._readableState;switch(ie.pipesCount){case 0:ie.pipes=V;break;case 1:ie.pipes=[ie.pipes,V];break;default:ie.pipes.push(V)}ie.pipesCount+=1,f("pipe count=%d opts=%j",ie.pipesCount,H);var oe=(!H||H.end!==!1)&&V!==i.stdout&&V!==i.stderr?ue:be;function se(ye,Oe){f("onunpipe"),ye===ee&&Oe&&Oe.hasUnpiped===!1&&(Oe.hasUnpiped=!0,f("cleanup"),V.removeListener("close",ge),V.removeListener("finish",_e),V.removeListener("drain",pe),V.removeListener("error",me),V.removeListener("unpipe",se),ee.removeListener("end",ue),ee.removeListener("end",be),ee.removeListener("data",ne),ce=!0,!ie.awaitDrain||V._writableState&&!V._writableState.needDrain||pe())}function ue(){f("onend"),V.end()}ie.endEmitted?i.nextTick(oe):ee.once("end",oe),V.on("unpipe",se);var pe=function(ye){return function(){var Oe=ye._readableState;f("pipeOnDrain",Oe.awaitDrain),Oe.awaitDrain&&Oe.awaitDrain--,Oe.awaitDrain===0&&d(ye,"data")&&(Oe.flowing=!0,X(ye))}}(ee);V.on("drain",pe);var ce=!1;function ne(ye){f("ondata");var Oe=V.write(ye);f("dest.write",Oe),Oe===!1&&((ie.pipesCount===1&&ie.pipes===V||ie.pipesCount>1&&J(ie.pipes,V)!==-1)&&!ce&&(f("false write response, pause",ie.awaitDrain),ie.awaitDrain++),ee.pause())}function me(ye){f("onerror",ye),be(),V.removeListener("error",me),d(V,"error")===0&&B(V,ye)}function ge(){V.removeListener("finish",_e),be()}function _e(){f("onfinish"),V.removeListener("close",ge),be()}function be(){f("unpipe"),ee.unpipe(V)}return ee.on("data",ne),function(ye,Oe,Ne){if(typeof ye.prependListener=="function")return ye.prependListener(Oe,Ne);ye._events&&ye._events[Oe]?Array.isArray(ye._events[Oe])?ye._events[Oe].unshift(Ne):ye._events[Oe]=[Ne,ye._events[Oe]]:ye.on(Oe,Ne)}(V,"error",me),V.once("close",ge),V.once("finish",_e),V.emit("pipe",ee),ie.flowing||(f("pipe resume"),ee.resume()),V},G.prototype.unpipe=function(V){var H=this._readableState,ee={hasUnpiped:!1};if(H.pipesCount===0)return this;if(H.pipesCount===1)return V&&V!==H.pipes||(V||(V=H.pipes),H.pipes=null,H.pipesCount=0,H.flowing=!1,V&&V.emit("unpipe",this,ee)),this;if(!V){var ie=H.pipes,oe=H.pipesCount;H.pipes=null,H.pipesCount=0,H.flowing=!1;for(var se=0;se<oe;se++)ie[se].emit("unpipe",this,{hasUnpiped:!1});return this}var ue=J(H.pipes,V);return ue===-1||(H.pipes.splice(ue,1),H.pipesCount-=1,H.pipesCount===1&&(H.pipes=H.pipes[0]),V.emit("unpipe",this,ee)),this},G.prototype.on=function(V,H){var ee=c.prototype.on.call(this,V,H),ie=this._readableState;return V==="data"?(ie.readableListening=this.listenerCount("readable")>0,ie.flowing!==!1&&this.resume()):V==="readable"&&(ie.endEmitted||ie.readableListening||(ie.readableListening=ie.needReadable=!0,ie.flowing=!1,ie.emittedReadable=!1,f("on readable",ie.length,ie.reading),ie.length?E(this):ie.reading||i.nextTick(U,this))),ee},G.prototype.addListener=G.prototype.on,G.prototype.removeListener=function(V,H){var ee=c.prototype.removeListener.call(this,V,H);return V==="readable"&&i.nextTick(M,this),ee},G.prototype.removeAllListeners=function(V){var H=c.prototype.removeAllListeners.apply(this,arguments);return V!=="readable"&&V!==void 0||i.nextTick(M,this),H},G.prototype.resume=function(){var V=this._readableState;return V.flowing||(f("resume"),V.flowing=!V.readableListening,function(H,ee){ee.resumeScheduled||(ee.resumeScheduled=!0,i.nextTick($,H,ee))}(this,V)),V.paused=!1,this},G.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},G.prototype.wrap=function(V){var H=this,ee=this._readableState,ie=!1;for(var oe in V.on("end",function(){if(f("wrapped end"),ee.decoder&&!ee.ended){var ue=ee.decoder.end();ue&&ue.length&&H.push(ue)}H.push(null)}),V.on("data",function(ue){f("wrapped data"),ee.decoder&&(ue=ee.decoder.write(ue)),ee.objectMode&&ue==null||(ee.objectMode||ue&&ue.length)&&(H.push(ue)||(ie=!0,V.pause()))}),V)this[oe]===void 0&&typeof V[oe]=="function"&&(this[oe]=function(ue){return function(){return V[ue].apply(V,arguments)}}(oe));for(var se=0;se<q.length;se++)V.on(q[se],this.emit.bind(this,q[se]));return this._read=function(ue){f("wrapped _read",ue),ie&&(ie=!1,V.resume())},this},typeof Symbol=="function"&&(G.prototype[Symbol.asyncIterator]=function(){return g===void 0&&(g=r("./internal/streams/async_iterator")),g(this)}),Object.defineProperty(G.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(G.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(G.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(V){this._readableState&&(this._readableState.flowing=V)}}),G._fromList=Z,Object.defineProperty(G.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(G.from=function(V,H){return x===void 0&&(x=r("./internal/streams/from")),x(G,V,H)})}).call(this)}).call(this,r("_process"),typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(r,s,a){s.exports=f;var i=r("../errors").codes,o=i.ERR_METHOD_NOT_IMPLEMENTED,l=i.ERR_MULTIPLE_CALLBACK,d=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,c=i.ERR_TRANSFORM_WITH_LENGTH_0,u=r("./_stream_duplex");function h(g,x){var v=this._transformState;v.transforming=!1;var y=v.writecb;if(y===null)return this.emit("error",new l);v.writechunk=null,v.writecb=null,x!=null&&this.push(x),y(g);var b=this._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}function f(g){if(!(this instanceof f))return new f(g);u.call(this,g),this._transformState={afterTransform:h.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,g&&(typeof g.transform=="function"&&(this._transform=g.transform),typeof g.flush=="function"&&(this._flush=g.flush)),this.on("prefinish",m)}function m(){var g=this;typeof this._flush!="function"||this._readableState.destroyed?p(this,null,null):this._flush(function(x,v){p(g,x,v)})}function p(g,x,v){if(x)return g.emit("error",x);if(v!=null&&g.push(v),g._writableState.length)throw new c;if(g._transformState.transforming)throw new d;return g.push(null)}r("inherits")(f,u),f.prototype.push=function(g,x){return this._transformState.needTransform=!1,u.prototype.push.call(this,g,x)},f.prototype._transform=function(g,x,v){v(new o("_transform()"))},f.prototype._write=function(g,x,v){var y=this._transformState;if(y.writecb=v,y.writechunk=g,y.writeencoding=x,!y.transforming){var b=this._readableState;(y.needTransform||b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}},f.prototype._read=function(g){var x=this._transformState;x.writechunk===null||x.transforming?x.needTransform=!0:(x.transforming=!0,this._transform(x.writechunk,x.writeencoding,x.afterTransform))},f.prototype._destroy=function(g,x){u.prototype._destroy.call(this,g,function(v){x(v)})}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(r,s,a){(function(i,o){(function(){function l(k){var M=this;this.next=null,this.entry=null,this.finish=function(){(function(U,$,X){var Z=U.entry;for(U.entry=null;Z;){var re=Z.callback;$.pendingcb--,re(X),Z=Z.next}$.corkedRequestsFree.next=U})(M,k)}}var d;s.exports=G,G.WritableState=Y;var c={deprecate:r("util-deprecate")},u=r("./internal/streams/stream"),h=r("buffer").Buffer,f=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},m,p=r("./internal/streams/destroy"),g=r("./internal/streams/state").getHighWaterMark,x=r("../errors").codes,v=x.ERR_INVALID_ARG_TYPE,y=x.ERR_METHOD_NOT_IMPLEMENTED,b=x.ERR_MULTIPLE_CALLBACK,j=x.ERR_STREAM_CANNOT_PIPE,T=x.ERR_STREAM_DESTROYED,O=x.ERR_STREAM_NULL_VALUES,R=x.ERR_STREAM_WRITE_AFTER_END,D=x.ERR_UNKNOWN_ENCODING,B=p.errorOrDestroy;function q(){}function Y(k,M,U){d=d||r("./_stream_duplex"),k=k||{},typeof U!="boolean"&&(U=M instanceof d),this.objectMode=!!k.objectMode,U&&(this.objectMode=this.objectMode||!!k.writableObjectMode),this.highWaterMark=g(this,k,"writableHighWaterMark",U),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var $=k.decodeStrings===!1;this.decodeStrings=!$,this.defaultEncoding=k.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(X){(function(Z,re){var W=Z._writableState,J=W.sync,V=W.writecb;if(typeof V!="function")throw new b;if(function(ee){ee.writing=!1,ee.writecb=null,ee.length-=ee.writelen,ee.writelen=0}(W),re)(function(ee,ie,oe,se,ue){--ie.pendingcb,oe?(i.nextTick(ue,se),i.nextTick(C,ee,ie),ee._writableState.errorEmitted=!0,B(ee,se)):(ue(se),ee._writableState.errorEmitted=!0,B(ee,se),C(ee,ie))})(Z,W,J,re,V);else{var H=E(W)||Z.destroyed;H||W.corked||W.bufferProcessing||!W.bufferedRequest||S(Z,W),J?i.nextTick(F,Z,W,H,V):F(Z,W,H,V)}})(M,X)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=k.emitClose!==!1,this.autoDestroy=!!k.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function G(k){var M=this instanceof(d=d||r("./_stream_duplex"));if(!M&&!m.call(G,this))return new G(k);this._writableState=new Y(k,this,M),this.writable=!0,k&&(typeof k.write=="function"&&(this._write=k.write),typeof k.writev=="function"&&(this._writev=k.writev),typeof k.destroy=="function"&&(this._destroy=k.destroy),typeof k.final=="function"&&(this._final=k.final)),u.call(this)}function I(k,M,U,$,X,Z,re){M.writelen=$,M.writecb=re,M.writing=!0,M.sync=!0,M.destroyed?M.onwrite(new T("write")):U?k._writev(X,M.onwrite):k._write(X,Z,M.onwrite),M.sync=!1}function F(k,M,U,$){U||function(X,Z){Z.length===0&&Z.needDrain&&(Z.needDrain=!1,X.emit("drain"))}(k,M),M.pendingcb--,$(),C(k,M)}function S(k,M){M.bufferProcessing=!0;var U=M.bufferedRequest;if(k._writev&&U&&U.next){var $=M.bufferedRequestCount,X=new Array($),Z=M.corkedRequestsFree;Z.entry=U;for(var re=0,W=!0;U;)X[re]=U,U.isBuf||(W=!1),U=U.next,re+=1;X.allBuffers=W,I(k,M,!0,M.length,X,"",Z.finish),M.pendingcb++,M.lastBufferedRequest=null,Z.next?(M.corkedRequestsFree=Z.next,Z.next=null):M.corkedRequestsFree=new l(M),M.bufferedRequestCount=0}else{for(;U;){var J=U.chunk,V=U.encoding,H=U.callback;if(I(k,M,!1,M.objectMode?1:J.length,J,V,H),U=U.next,M.bufferedRequestCount--,M.writing)break}U===null&&(M.lastBufferedRequest=null)}M.bufferedRequest=U,M.bufferProcessing=!1}function E(k){return k.ending&&k.length===0&&k.bufferedRequest===null&&!k.finished&&!k.writing}function N(k,M){k._final(function(U){M.pendingcb--,U&&B(k,U),M.prefinished=!0,k.emit("prefinish"),C(k,M)})}function C(k,M){var U=E(M);if(U&&(function(X,Z){Z.prefinished||Z.finalCalled||(typeof X._final!="function"||Z.destroyed?(Z.prefinished=!0,X.emit("prefinish")):(Z.pendingcb++,Z.finalCalled=!0,i.nextTick(N,X,Z)))}(k,M),M.pendingcb===0&&(M.finished=!0,k.emit("finish"),M.autoDestroy))){var $=k._readableState;(!$||$.autoDestroy&&$.endEmitted)&&k.destroy()}return U}r("inherits")(G,u),Y.prototype.getBuffer=function(){for(var k=this.bufferedRequest,M=[];k;)M.push(k),k=k.next;return M},function(){try{Object.defineProperty(Y.prototype,"buffer",{get:c.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(m=Function.prototype[Symbol.hasInstance],Object.defineProperty(G,Symbol.hasInstance,{value:function(k){return!!m.call(this,k)||this===G&&k&&k._writableState instanceof Y}})):m=function(k){return k instanceof this},G.prototype.pipe=function(){B(this,new j)},G.prototype.write=function(k,M,U){var $,X=this._writableState,Z=!1,re=!X.objectMode&&($=k,h.isBuffer($)||$ instanceof f);return re&&!h.isBuffer(k)&&(k=function(W){return h.from(W)}(k)),typeof M=="function"&&(U=M,M=null),re?M="buffer":M||(M=X.defaultEncoding),typeof U!="function"&&(U=q),X.ending?function(W,J){var V=new R;B(W,V),i.nextTick(J,V)}(this,U):(re||function(W,J,V,H){var ee;return V===null?ee=new O:typeof V=="string"||J.objectMode||(ee=new v("chunk",["string","Buffer"],V)),!ee||(B(W,ee),i.nextTick(H,ee),!1)}(this,X,k,U))&&(X.pendingcb++,Z=function(W,J,V,H,ee,ie){if(!V){var oe=function(ce,ne,me){return ce.objectMode||ce.decodeStrings===!1||typeof ne!="string"||(ne=h.from(ne,me)),ne}(J,H,ee);H!==oe&&(V=!0,ee="buffer",H=oe)}var se=J.objectMode?1:H.length;J.length+=se;var ue=J.length<J.highWaterMark;if(ue||(J.needDrain=!0),J.writing||J.corked){var pe=J.lastBufferedRequest;J.lastBufferedRequest={chunk:H,encoding:ee,isBuf:V,callback:ie,next:null},pe?pe.next=J.lastBufferedRequest:J.bufferedRequest=J.lastBufferedRequest,J.bufferedRequestCount+=1}else I(W,J,!1,se,H,ee,ie);return ue}(this,X,re,k,M,U)),Z},G.prototype.cork=function(){this._writableState.corked++},G.prototype.uncork=function(){var k=this._writableState;k.corked&&(k.corked--,k.writing||k.corked||k.bufferProcessing||!k.bufferedRequest||S(this,k))},G.prototype.setDefaultEncoding=function(k){if(typeof k=="string"&&(k=k.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((k+"").toLowerCase())>-1))throw new D(k);return this._writableState.defaultEncoding=k,this},Object.defineProperty(G.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(G.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),G.prototype._write=function(k,M,U){U(new y("_write()"))},G.prototype._writev=null,G.prototype.end=function(k,M,U){var $=this._writableState;return typeof k=="function"?(U=k,k=null,M=null):typeof M=="function"&&(U=M,M=null),k!=null&&this.write(k,M),$.corked&&($.corked=1,this.uncork()),$.ending||function(X,Z,re){Z.ending=!0,C(X,Z),re&&(Z.finished?i.nextTick(re):X.once("finish",re)),Z.ended=!0,X.writable=!1}(this,$,U),this},Object.defineProperty(G.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(G.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(k){this._writableState&&(this._writableState.destroyed=k)}}),G.prototype.destroy=p.destroy,G.prototype._undestroy=p.undestroy,G.prototype._destroy=function(k,M){M(k)}}).call(this)}).call(this,r("_process"),typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(r,s,a){(function(i){(function(){var o;function l(T,O,R){return(O=function(D){var B=function(q,Y){if(typeof q!="object"||q===null)return q;var G=q[Symbol.toPrimitive];if(G!==void 0){var I=G.call(q,Y||"default");if(typeof I!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Y==="string"?String:Number)(q)}(D,"string");return typeof B=="symbol"?B:String(B)}(O))in T?Object.defineProperty(T,O,{value:R,enumerable:!0,configurable:!0,writable:!0}):T[O]=R,T}var d=r("./end-of-stream"),c=Symbol("lastResolve"),u=Symbol("lastReject"),h=Symbol("error"),f=Symbol("ended"),m=Symbol("lastPromise"),p=Symbol("handlePromise"),g=Symbol("stream");function x(T,O){return{value:T,done:O}}function v(T){var O=T[c];if(O!==null){var R=T[g].read();R!==null&&(T[m]=null,T[c]=null,T[u]=null,O(x(R,!1)))}}function y(T){i.nextTick(v,T)}var b=Object.getPrototypeOf(function(){}),j=Object.setPrototypeOf((l(o={get stream(){return this[g]},next:function(){var T=this,O=this[h];if(O!==null)return Promise.reject(O);if(this[f])return Promise.resolve(x(void 0,!0));if(this[g].destroyed)return new Promise(function(q,Y){i.nextTick(function(){T[h]?Y(T[h]):q(x(void 0,!0))})});var R,D=this[m];if(D)R=new Promise(function(q,Y){return function(G,I){q.then(function(){Y[f]?G(x(void 0,!0)):Y[p](G,I)},I)}}(D,this));else{var B=this[g].read();if(B!==null)return Promise.resolve(x(B,!1));R=new Promise(this[p])}return this[m]=R,R}},Symbol.asyncIterator,function(){return this}),l(o,"return",function(){var T=this;return new Promise(function(O,R){T[g].destroy(null,function(D){D?R(D):O(x(void 0,!0))})})}),o),b);s.exports=function(T){var O,R=Object.create(j,(l(O={},g,{value:T,writable:!0}),l(O,c,{value:null,writable:!0}),l(O,u,{value:null,writable:!0}),l(O,h,{value:null,writable:!0}),l(O,f,{value:T._readableState.endEmitted,writable:!0}),l(O,p,{value:function(D,B){var q=R[g].read();q?(R[m]=null,R[c]=null,R[u]=null,D(x(q,!1))):(R[c]=D,R[u]=B)},writable:!0}),O));return R[m]=null,d(T,function(D){if(D&&D.code!=="ERR_STREAM_PREMATURE_CLOSE"){var B=R[u];return B!==null&&(R[m]=null,R[c]=null,R[u]=null,B(D)),void(R[h]=D)}var q=R[c];q!==null&&(R[m]=null,R[c]=null,R[u]=null,q(x(void 0,!0))),R[f]=!0}),T.on("readable",y.bind(null,R)),R}}).call(this)}).call(this,r("_process"))},{"./end-of-stream":486,_process:467}],484:[function(r,s,a){function i(m,p){var g=Object.keys(m);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(m);p&&(x=x.filter(function(v){return Object.getOwnPropertyDescriptor(m,v).enumerable})),g.push.apply(g,x)}return g}function o(m){for(var p=1;p<arguments.length;p++){var g=arguments[p]!=null?arguments[p]:{};p%2?i(Object(g),!0).forEach(function(x){l(m,x,g[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(g)):i(Object(g)).forEach(function(x){Object.defineProperty(m,x,Object.getOwnPropertyDescriptor(g,x))})}return m}function l(m,p,g){return(p=c(p))in m?Object.defineProperty(m,p,{value:g,enumerable:!0,configurable:!0,writable:!0}):m[p]=g,m}function d(m,p){for(var g=0;g<p.length;g++){var x=p[g];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(m,c(x.key),x)}}function c(m){var p=function(g,x){if(typeof g!="object"||g===null)return g;var v=g[Symbol.toPrimitive];if(v!==void 0){var y=v.call(g,x||"default");if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(g)}(m,"string");return typeof p=="symbol"?p:String(p)}var u=r("buffer").Buffer,h=r("util").inspect,f=h&&h.custom||"inspect";s.exports=function(){function m(){(function(x,v){if(!(x instanceof v))throw new TypeError("Cannot call a class as a function")})(this,m),this.head=null,this.tail=null,this.length=0}var p,g;return p=m,(g=[{key:"push",value:function(x){var v={data:x,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(x){var v={data:x,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var x=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,x}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(x){if(this.length===0)return"";for(var v=this.head,y=""+v.data;v=v.next;)y+=x+v.data;return y}},{key:"concat",value:function(x){if(this.length===0)return u.alloc(0);for(var v,y,b,j=u.allocUnsafe(x>>>0),T=this.head,O=0;T;)v=T.data,y=j,b=O,u.prototype.copy.call(v,y,b),O+=T.data.length,T=T.next;return j}},{key:"consume",value:function(x,v){var y;return x<this.head.data.length?(y=this.head.data.slice(0,x),this.head.data=this.head.data.slice(x)):y=x===this.head.data.length?this.shift():v?this._getString(x):this._getBuffer(x),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(x){var v=this.head,y=1,b=v.data;for(x-=b.length;v=v.next;){var j=v.data,T=x>j.length?j.length:x;if(T===j.length?b+=j:b+=j.slice(0,x),(x-=T)==0){T===j.length?(++y,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=j.slice(T));break}++y}return this.length-=y,b}},{key:"_getBuffer",value:function(x){var v=u.allocUnsafe(x),y=this.head,b=1;for(y.data.copy(v),x-=y.data.length;y=y.next;){var j=y.data,T=x>j.length?j.length:x;if(j.copy(v,v.length-x,0,T),(x-=T)==0){T===j.length?(++b,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=j.slice(T));break}++b}return this.length-=b,v}},{key:f,value:function(x,v){return h(this,o(o({},v),{},{depth:0,customInspect:!1}))}}])&&d(p.prototype,g),Object.defineProperty(p,"prototype",{writable:!1}),m}()},{buffer:220,util:188}],485:[function(r,s,a){(function(i){(function(){function o(c,u){d(c,u),l(c)}function l(c){c._writableState&&!c._writableState.emitClose||c._readableState&&!c._readableState.emitClose||c.emit("close")}function d(c,u){c.emit("error",u)}s.exports={destroy:function(c,u){var h=this,f=this._readableState&&this._readableState.destroyed,m=this._writableState&&this._writableState.destroyed;return f||m?(u?u(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(d,this,c)):i.nextTick(d,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,function(p){!u&&p?h._writableState?h._writableState.errorEmitted?i.nextTick(l,h):(h._writableState.errorEmitted=!0,i.nextTick(o,h,p)):i.nextTick(o,h,p):u?(i.nextTick(l,h),u(p)):i.nextTick(l,h)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(c,u){var h=c._readableState,f=c._writableState;h&&h.autoDestroy||f&&f.autoDestroy?c.destroy(u):c.emit("error",u)}}}).call(this)}).call(this,r("_process"))},{_process:467}],486:[function(r,s,a){var i=r("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function o(){}s.exports=function l(d,c,u){if(typeof c=="function")return l(d,null,c);c||(c={}),u=function(T){var O=!1;return function(){if(!O){O=!0;for(var R=arguments.length,D=new Array(R),B=0;B<R;B++)D[B]=arguments[B];T.apply(this,D)}}}(u||o);var h=c.readable||c.readable!==!1&&d.readable,f=c.writable||c.writable!==!1&&d.writable,m=function(){d.writable||g()},p=d._writableState&&d._writableState.finished,g=function(){f=!1,p=!0,h||u.call(d)},x=d._readableState&&d._readableState.endEmitted,v=function(){h=!1,x=!0,f||u.call(d)},y=function(T){u.call(d,T)},b=function(){var T;return h&&!x?(d._readableState&&d._readableState.ended||(T=new i),u.call(d,T)):f&&!p?(d._writableState&&d._writableState.ended||(T=new i),u.call(d,T)):void 0},j=function(){d.req.on("finish",g)};return function(T){return T.setHeader&&typeof T.abort=="function"}(d)?(d.on("complete",g),d.on("abort",b),d.req?j():d.on("request",j)):f&&!d._writableState&&(d.on("end",m),d.on("close",m)),d.on("end",v),d.on("finish",g),c.error!==!1&&d.on("error",y),d.on("close",b),function(){d.removeListener("complete",g),d.removeListener("abort",b),d.removeListener("request",j),d.req&&d.req.removeListener("finish",g),d.removeListener("end",m),d.removeListener("close",m),d.removeListener("finish",g),d.removeListener("end",v),d.removeListener("error",y),d.removeListener("close",b)}}},{"../../../errors":477}],487:[function(r,s,a){s.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(r,s,a){var i,o=r("../../../errors").codes,l=o.ERR_MISSING_ARGS,d=o.ERR_STREAM_DESTROYED;function c(p){if(p)throw p}function u(p,g,x,v){v=function(j){var T=!1;return function(){T||(T=!0,j.apply(void 0,arguments))}}(v);var y=!1;p.on("close",function(){y=!0}),i===void 0&&(i=r("./end-of-stream")),i(p,{readable:g,writable:x},function(j){if(j)return v(j);y=!0,v()});var b=!1;return function(j){if(!y&&!b)return b=!0,function(T){return T.setHeader&&typeof T.abort=="function"}(p)?p.abort():typeof p.destroy=="function"?p.destroy():void v(j||new d("pipe"))}}function h(p){p()}function f(p,g){return p.pipe(g)}function m(p){return p.length?typeof p[p.length-1]!="function"?c:p.pop():c}s.exports=function(){for(var p=arguments.length,g=new Array(p),x=0;x<p;x++)g[x]=arguments[x];var v,y=m(g);if(Array.isArray(g[0])&&(g=g[0]),g.length<2)throw new l("streams");var b=g.map(function(j,T){var O=T<g.length-1;return u(j,O,T>0,function(R){v||(v=R),R&&b.forEach(h),O||(b.forEach(h),y(v))})});return g.reduce(f)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(r,s,a){var i=r("../../../errors").codes.ERR_INVALID_OPT_VALUE;s.exports={getHighWaterMark:function(o,l,d,c){var u=function(h,f,m){return h.highWaterMark!=null?h.highWaterMark:f?h[m]:null}(l,c,d);if(u!=null){if(!isFinite(u)||Math.floor(u)!==u||u<0)throw new i(c?d:"highWaterMark",u);return Math.floor(u)}return o.objectMode?16:16384}}},{"../../../errors":477}],490:[function(r,s,a){s.exports=r("events").EventEmitter},{events:422}],491:[function(r,s,a){(a=s.exports=r("./lib/_stream_readable.js")).Stream=a,a.Readable=a,a.Writable=r("./lib/_stream_writable.js"),a.Duplex=r("./lib/_stream_duplex.js"),a.Transform=r("./lib/_stream_transform.js"),a.PassThrough=r("./lib/_stream_passthrough.js"),a.finished=r("./lib/internal/streams/end-of-stream.js"),a.pipeline=r("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(r,s,a){var i=function(o){var l=Object.prototype,d=l.hasOwnProperty,c=Object.defineProperty||function(C,k,M){C[k]=M.value},u=typeof Symbol=="function"?Symbol:{},h=u.iterator||"@@iterator",f=u.asyncIterator||"@@asyncIterator",m=u.toStringTag||"@@toStringTag";function p(C,k,M){return Object.defineProperty(C,k,{value:M,enumerable:!0,configurable:!0,writable:!0}),C[k]}try{p({},"")}catch{p=function(k,M,U){return k[M]=U}}function g(C,k,M,U){var $=k&&k.prototype instanceof y?k:y,X=Object.create($.prototype),Z=new S(U||[]);return c(X,"_invoke",{value:Y(C,M,Z)}),X}function x(C,k,M){try{return{type:"normal",arg:C.call(k,M)}}catch(U){return{type:"throw",arg:U}}}o.wrap=g;var v={};function y(){}function b(){}function j(){}var T={};p(T,h,function(){return this});var O=Object.getPrototypeOf,R=O&&O(O(E([])));R&&R!==l&&d.call(R,h)&&(T=R);var D=j.prototype=y.prototype=Object.create(T);function B(C){["next","throw","return"].forEach(function(k){p(C,k,function(M){return this._invoke(k,M)})})}function q(C,k){var M;c(this,"_invoke",{value:function(U,$){function X(){return new k(function(Z,re){(function W(J,V,H,ee){var ie=x(C[J],C,V);if(ie.type!=="throw"){var oe=ie.arg,se=oe.value;return se&&typeof se=="object"&&d.call(se,"__await")?k.resolve(se.__await).then(function(ue){W("next",ue,H,ee)},function(ue){W("throw",ue,H,ee)}):k.resolve(se).then(function(ue){oe.value=ue,H(oe)},function(ue){return W("throw",ue,H,ee)})}ee(ie.arg)})(U,$,Z,re)})}return M=M?M.then(X,X):X()}})}function Y(C,k,M){var U="suspendedStart";return function($,X){if(U==="executing")throw new Error("Generator is already running");if(U==="completed"){if($==="throw")throw X;return N()}for(M.method=$,M.arg=X;;){var Z=M.delegate;if(Z){var re=G(Z,M);if(re){if(re===v)continue;return re}}if(M.method==="next")M.sent=M._sent=M.arg;else if(M.method==="throw"){if(U==="suspendedStart")throw U="completed",M.arg;M.dispatchException(M.arg)}else M.method==="return"&&M.abrupt("return",M.arg);U="executing";var W=x(C,k,M);if(W.type==="normal"){if(U=M.done?"completed":"suspendedYield",W.arg===v)continue;return{value:W.arg,done:M.done}}W.type==="throw"&&(U="completed",M.method="throw",M.arg=W.arg)}}}function G(C,k){var M=k.method,U=C.iterator[M];if(U===void 0)return k.delegate=null,M==="throw"&&C.iterator.return&&(k.method="return",k.arg=void 0,G(C,k),k.method==="throw")||M!=="return"&&(k.method="throw",k.arg=new TypeError("The iterator does not provide a '"+M+"' method")),v;var $=x(U,C.iterator,k.arg);if($.type==="throw")return k.method="throw",k.arg=$.arg,k.delegate=null,v;var X=$.arg;return X?X.done?(k[C.resultName]=X.value,k.next=C.nextLoc,k.method!=="return"&&(k.method="next",k.arg=void 0),k.delegate=null,v):X:(k.method="throw",k.arg=new TypeError("iterator result is not an object"),k.delegate=null,v)}function I(C){var k={tryLoc:C[0]};1 in C&&(k.catchLoc=C[1]),2 in C&&(k.finallyLoc=C[2],k.afterLoc=C[3]),this.tryEntries.push(k)}function F(C){var k=C.completion||{};k.type="normal",delete k.arg,C.completion=k}function S(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(I,this),this.reset(!0)}function E(C){if(C){var k=C[h];if(k)return k.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var M=-1,U=function $(){for(;++M<C.length;)if(d.call(C,M))return $.value=C[M],$.done=!1,$;return $.value=void 0,$.done=!0,$};return U.next=U}}return{next:N}}function N(){return{value:void 0,done:!0}}return b.prototype=j,c(D,"constructor",{value:j,configurable:!0}),c(j,"constructor",{value:b,configurable:!0}),b.displayName=p(j,m,"GeneratorFunction"),o.isGeneratorFunction=function(C){var k=typeof C=="function"&&C.constructor;return!!k&&(k===b||(k.displayName||k.name)==="GeneratorFunction")},o.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,j):(C.__proto__=j,p(C,m,"GeneratorFunction")),C.prototype=Object.create(D),C},o.awrap=function(C){return{__await:C}},B(q.prototype),p(q.prototype,f,function(){return this}),o.AsyncIterator=q,o.async=function(C,k,M,U,$){$===void 0&&($=Promise);var X=new q(g(C,k,M,U),$);return o.isGeneratorFunction(k)?X:X.next().then(function(Z){return Z.done?Z.value:X.next()})},B(D),p(D,m,"Generator"),p(D,h,function(){return this}),p(D,"toString",function(){return"[object Generator]"}),o.keys=function(C){var k=Object(C),M=[];for(var U in k)M.push(U);return M.reverse(),function $(){for(;M.length;){var X=M.pop();if(X in k)return $.value=X,$.done=!1,$}return $.done=!0,$}},o.values=E,S.prototype={constructor:S,reset:function(C){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(F),!C)for(var k in this)k.charAt(0)==="t"&&d.call(this,k)&&!isNaN(+k.slice(1))&&(this[k]=void 0)},stop:function(){this.done=!0;var C=this.tryEntries[0].completion;if(C.type==="throw")throw C.arg;return this.rval},dispatchException:function(C){if(this.done)throw C;var k=this;function M(W,J){return X.type="throw",X.arg=C,k.next=W,J&&(k.method="next",k.arg=void 0),!!J}for(var U=this.tryEntries.length-1;U>=0;--U){var $=this.tryEntries[U],X=$.completion;if($.tryLoc==="root")return M("end");if($.tryLoc<=this.prev){var Z=d.call($,"catchLoc"),re=d.call($,"finallyLoc");if(Z&&re){if(this.prev<$.catchLoc)return M($.catchLoc,!0);if(this.prev<$.finallyLoc)return M($.finallyLoc)}else if(Z){if(this.prev<$.catchLoc)return M($.catchLoc,!0)}else{if(!re)throw new Error("try statement without catch or finally");if(this.prev<$.finallyLoc)return M($.finallyLoc)}}}},abrupt:function(C,k){for(var M=this.tryEntries.length-1;M>=0;--M){var U=this.tryEntries[M];if(U.tryLoc<=this.prev&&d.call(U,"finallyLoc")&&this.prev<U.finallyLoc){var $=U;break}}$&&(C==="break"||C==="continue")&&$.tryLoc<=k&&k<=$.finallyLoc&&($=null);var X=$?$.completion:{};return X.type=C,X.arg=k,$?(this.method="next",this.next=$.finallyLoc,v):this.complete(X)},complete:function(C,k){if(C.type==="throw")throw C.arg;return C.type==="break"||C.type==="continue"?this.next=C.arg:C.type==="return"?(this.rval=this.arg=C.arg,this.method="return",this.next="end"):C.type==="normal"&&k&&(this.next=k),v},finish:function(C){for(var k=this.tryEntries.length-1;k>=0;--k){var M=this.tryEntries[k];if(M.finallyLoc===C)return this.complete(M.completion,M.afterLoc),F(M),v}},catch:function(C){for(var k=this.tryEntries.length-1;k>=0;--k){var M=this.tryEntries[k];if(M.tryLoc===C){var U=M.completion;if(U.type==="throw"){var $=U.arg;F(M)}return $}}throw new Error("illegal catch attempt")},delegateYield:function(C,k,M){return this.delegate={iterator:E(C),resultName:k,nextLoc:M},this.method==="next"&&(this.arg=void 0),v}},o}(typeof s=="object"?s.exports:{});try{regeneratorRuntime=i}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},{}],493:[function(r,s,a){var i=r("buffer").Buffer,o=r("inherits"),l=r("hash-base"),d=new Array(16),c=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],u=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],h=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],f=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],m=[0,1518500249,1859775393,2400959708,2840853838],p=[1352829926,1548603684,1836072691,2053994217,0];function g(){l.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function x(O,R){return O<<R|O>>>32-R}function v(O,R,D,B,q,Y,G,I){return x(O+(R^D^B)+Y+G|0,I)+q|0}function y(O,R,D,B,q,Y,G,I){return x(O+(R&D|~R&B)+Y+G|0,I)+q|0}function b(O,R,D,B,q,Y,G,I){return x(O+((R|~D)^B)+Y+G|0,I)+q|0}function j(O,R,D,B,q,Y,G,I){return x(O+(R&B|D&~B)+Y+G|0,I)+q|0}function T(O,R,D,B,q,Y,G,I){return x(O+(R^(D|~B))+Y+G|0,I)+q|0}o(g,l),g.prototype._update=function(){for(var O=d,R=0;R<16;++R)O[R]=this._block.readInt32LE(4*R);for(var D=0|this._a,B=0|this._b,q=0|this._c,Y=0|this._d,G=0|this._e,I=0|this._a,F=0|this._b,S=0|this._c,E=0|this._d,N=0|this._e,C=0;C<80;C+=1){var k,M;C<16?(k=v(D,B,q,Y,G,O[c[C]],m[0],h[C]),M=T(I,F,S,E,N,O[u[C]],p[0],f[C])):C<32?(k=y(D,B,q,Y,G,O[c[C]],m[1],h[C]),M=j(I,F,S,E,N,O[u[C]],p[1],f[C])):C<48?(k=b(D,B,q,Y,G,O[c[C]],m[2],h[C]),M=b(I,F,S,E,N,O[u[C]],p[2],f[C])):C<64?(k=j(D,B,q,Y,G,O[c[C]],m[3],h[C]),M=y(I,F,S,E,N,O[u[C]],p[3],f[C])):(k=T(D,B,q,Y,G,O[c[C]],m[4],h[C]),M=v(I,F,S,E,N,O[u[C]],p[4],f[C])),D=G,G=Y,Y=x(q,10),q=B,B=k,I=N,N=E,E=x(S,10),S=F,F=M}var U=this._b+q+E|0;this._b=this._c+Y+N|0,this._c=this._d+G+I|0,this._d=this._e+D+F|0,this._e=this._a+B+S|0,this._a=U},g.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var O=i.alloc?i.alloc(20):new i(20);return O.writeInt32LE(this._a,0),O.writeInt32LE(this._b,4),O.writeInt32LE(this._c,8),O.writeInt32LE(this._d,12),O.writeInt32LE(this._e,16),O},s.exports=g},{buffer:220,"hash-base":425,inherits:440}],494:[function(r,s,a){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var i=r("buffer"),o=i.Buffer;function l(c,u){for(var h in c)u[h]=c[h]}function d(c,u,h){return o(c,u,h)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?s.exports=i:(l(i,a),a.Buffer=d),d.prototype=Object.create(o.prototype),l(o,d),d.from=function(c,u,h){if(typeof c=="number")throw new TypeError("Argument must not be a number");return o(c,u,h)},d.alloc=function(c,u,h){if(typeof c!="number")throw new TypeError("Argument must be a number");var f=o(c);return u!==void 0?typeof h=="string"?f.fill(u,h):f.fill(u):f.fill(0),f},d.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return o(c)},d.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return i.SlowBuffer(c)}},{buffer:220}],495:[function(r,s,a){(function(i){(function(){var o,l=r("buffer"),d=l.Buffer,c={};for(o in l)l.hasOwnProperty(o)&&o!=="SlowBuffer"&&o!=="Buffer"&&(c[o]=l[o]);var u=c.Buffer={};for(o in d)d.hasOwnProperty(o)&&o!=="allocUnsafe"&&o!=="allocUnsafeSlow"&&(u[o]=d[o]);if(c.Buffer.prototype=d.prototype,u.from&&u.from!==Uint8Array.from||(u.from=function(h,f,m){if(typeof h=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof h);if(h&&h.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h);return d(h,f,m)}),u.alloc||(u.alloc=function(h,f,m){if(typeof h!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof h);if(h<0||h>=2*(1<<30))throw new RangeError('The value "'+h+'" is invalid for option "size"');var p=d(h);return f&&f.length!==0?typeof m=="string"?p.fill(f,m):p.fill(f):p.fill(0),p}),!c.kStringMaxLength)try{c.kStringMaxLength=i.binding("buffer").kStringMaxLength}catch{}c.constants||(c.constants={MAX_LENGTH:c.kMaxLength},c.kStringMaxLength&&(c.constants.MAX_STRING_LENGTH=c.kStringMaxLength)),s.exports=c}).call(this)}).call(this,r("_process"))},{_process:467,buffer:220}],496:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0});const i=r("xmlchars/xml/1.0/ed5"),o=r("xmlchars/xml/1.1/ed2"),l=r("xmlchars/xmlns/1.0/ed3");var d=i.isS,c=i.isChar,u=i.isNameStartChar,h=i.isNameChar,f=i.S_LIST,m=i.NAME_RE,p=o.isChar,g=l.isNCNameStartChar,x=l.isNCNameChar,v=l.NC_NAME_RE;const y="http://www.w3.org/XML/1998/namespace",b="http://www.w3.org/2000/xmlns/",j={__proto__:null,xml:y,xmlns:b},T={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},O=E=>E===34||E===39,R=[34,39],D=[...R,91,62],B=[...R,60,93],q=[61,63,...f],Y=[...f,62,38,60];function G(E,N,C){switch(N){case"xml":C!==y&&E.fail(`xml prefix must be bound to ${y}.`);break;case"xmlns":C!==b&&E.fail(`xmlns prefix must be bound to ${b}.`)}switch(C){case b:E.fail(N===""?`the default namespace may not be set to ${C}.`:`may not assign a prefix (even "xmlns") to the URI ${b}.`);break;case y:switch(N){case"xml":break;case"":E.fail(`the default namespace may not be set to ${C}.`);break;default:E.fail("may not assign the xml namespace to another prefix.")}}}const I=E=>v.test(E),F=E=>m.test(E);a.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const S={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};a.SaxesParser=class{constructor(E){this.opt=E??{},this.fragmentOpt=!!this.opt.fragment;const N=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,N){this.nameStartCheck=g,this.nameCheck=x,this.isName=I,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},j);const C=this.opt.additionalNamespaces;C!=null&&(function(k,M){for(const U of Object.keys(M))G(k,U,M[U])}(this,C),Object.assign(this.ns,C))}else this.nameStartCheck=u,this.nameCheck=h,this.isName=F,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var E;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:N}=this;this.state=N?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=N,this.xmlDeclPossible=!N,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:C}=this.opt;if(C===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");C="1.0"}this.setXMLVersion(C),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(T),(E=this.readyHandler)===null||E===void 0||E.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(E,N){this[S[E]]=N}off(E){this[S[E]]=void 0}makeError(E){var N;let C=(N=this.fileName)!==null&&N!==void 0?N:"";return this.trackPosition&&(C.length>0&&(C+=":"),C+=`${this.line}:${this.column}`),C.length>0&&(C+=": "),new Error(C+E)}fail(E){const N=this.makeError(E),C=this.errorHandler;if(C===void 0)throw N;return C(N),this}write(E){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let N=!1;E===null?(N=!0,E=""):typeof E=="object"&&(E=E.toString()),this.carriedFromPrevious!==void 0&&(E=`${this.carriedFromPrevious}${E}`,this.carriedFromPrevious=void 0);let C=E.length;const k=E.charCodeAt(C-1);!N&&(k===13||k>=55296&&k<=56319)&&(this.carriedFromPrevious=E[C-1],C--,E=E.slice(0,C));const{stateTable:M}=this;for(this.chunk=E,this.i=0;this.i<C;)M[this.state].call(this);return this.chunkPosition+=C,N?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:E,i:N}=this;if(this.prevI=N,this.i=N+1,N>=E.length)return-1;const C=E.charCodeAt(N);if(this.column++,C<55296){if(C>=32||C===9)return C;switch(C){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return E.charCodeAt(N+1)===10&&(this.i=N+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),C}}if(C>56319)return C>=57344&&C<=65533||this.fail("disallowed character."),C;const k=65536+1024*(C-55296)+(E.charCodeAt(N+1)-56320);return this.i=N+2,k>1114111&&this.fail("disallowed character."),k}getCode11(){const{chunk:E,i:N}=this;if(this.prevI=N,this.i=N+1,N>=E.length)return-1;const C=E.charCodeAt(N);if(this.column++,C<55296){if(C>31&&C<127||C>159&&C!==8232||C===9)return C;switch(C){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const M=E.charCodeAt(N+1);M!==10&&M!==133||(this.i=N+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),C}}if(C>56319)return C>=57344&&C<=65533||this.fail("disallowed character."),C;const k=65536+1024*(C-55296)+(E.charCodeAt(N+1)-56320);return this.i=N+2,k>1114111&&this.fail("disallowed character."),k}getCodeNorm(){const E=this.getCode();return E===-2?10:E}unget(){this.i=this.prevI,this.column--}captureTo(E){let{i:N}=this;const{chunk:C}=this;for(;;){const k=this.getCode(),M=k===-2,U=M?10:k;if(U===-1||E.includes(U))return this.text+=C.slice(N,this.prevI),U;M&&(this.text+=C.slice(N,this.prevI)+`
`,N=this.i)}}captureToChar(E){let{i:N}=this;const{chunk:C}=this;for(;;){let k=this.getCode();switch(k){case-2:this.text+=C.slice(N,this.prevI)+`
`,N=this.i,k=10;break;case-1:return this.text+=C.slice(N),!1}if(k===E)return this.text+=C.slice(N,this.prevI),!0}}captureNameChars(){const{chunk:E,i:N}=this;for(;;){const C=this.getCode();if(C===-1)return this.name+=E.slice(N),-1;if(!h(C))return this.name+=E.slice(N,this.prevI),C===-2?10:C}}skipSpaces(){for(;;){const E=this.getCodeNorm();if(E===-1||!d(E))return E}}setXMLVersion(E){this.currentXMLVersion=E,E==="1.0"?(this.isChar=c,this.getCode=this.getCode10):(this.isChar=p,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const E=this.i,N=this.skipSpaces();switch(this.prevI!==E&&(this.xmlDeclPossible=!1),N){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var E;const N=this.captureTo(D);switch(N){case 62:(E=this.doctypeHandler)===null||E===void 0||E.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(N),N===91?this.state=4:O(N)&&(this.state=3,this.q=N)}}sDoctypeQuote(){const E=this.q;this.captureToChar(E)&&(this.text+=String.fromCodePoint(E),this.q=null,this.state=2)}sDTD(){const E=this.captureTo(B);E!==-1&&(this.text+=String.fromCodePoint(E),E===93?this.state=2:E===60?this.state=6:O(E)&&(this.state=5,this.q=E))}sDTDQuoted(){const E=this.q;this.captureToChar(E)&&(this.text+=String.fromCodePoint(E),this.state=4,this.q=null)}sDTDOpenWaka(){const E=this.getCodeNorm();switch(this.text+=String.fromCodePoint(E),E){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const E=String.fromCodePoint(this.getCodeNorm()),N=this.openWakaBang+=E;this.text+=E,N!=="-"&&(this.state=N==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const E=this.getCodeNorm();this.text+=String.fromCodePoint(E),this.state=E===45?10:8}sDTDCommentEnded(){const E=this.getCodeNorm();this.text+=String.fromCodePoint(E),E===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const E=this.getCodeNorm();this.text+=String.fromCodePoint(E),E===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:E}=this;const{chunk:N}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=N.slice(E,this.prevI)+`
`,E=this.i;break;case 59:{const{entityReturnState:C}=this,k=this.entity+N.slice(E,this.prevI);let M;this.state=C,k===""?(this.fail("empty entity name."),M="&;"):(M=this.parseEntity(k),this.entity=""),C===13&&this.textHandler===void 0||(this.text+=M);break e}case-1:this.entity+=N.slice(E);break e}}sOpenWaka(){const E=this.getCode();if(u(E))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(E){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var E;const N=this.getCodeNorm();N===45?(this.state=19,(E=this.commentHandler)===null||E===void 0||E.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(N),this.state=17)}sCommentEnded(){const E=this.getCodeNorm();E!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(E),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const E=this.getCodeNorm();E===93?this.state=22:(this.text+="]"+String.fromCodePoint(E),this.state=20)}sCDataEnding2(){var E;const N=this.getCodeNorm();switch(N){case 62:(E=this.cdataHandler)===null||E===void 0||E.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(N),this.state=20}}sPIFirstChar(){const E=this.getCodeNorm();this.nameStartCheck(E)?(this.piTarget+=String.fromCodePoint(E),this.state=24):E===63||d(E)?(this.fail("processing instruction without a target."),this.state=E===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(E),this.state=24)}sPIRest(){const{chunk:E,i:N}=this;for(;;){const C=this.getCodeNorm();if(C===-1)return void(this.piTarget+=E.slice(N));if(!this.nameCheck(C)){this.piTarget+=E.slice(N,this.prevI);const k=C===63;k||d(C)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=k?33:27):this.state=k?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(C));break}}}sPIBody(){if(this.text.length===0){const E=this.getCodeNorm();E===63?this.state=26:d(E)||(this.text=String.fromCodePoint(E))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var E;const N=this.getCodeNorm();if(N===62){const{piTarget:C}=this;C.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(E=this.piHandler)===null||E===void 0||E.call(this,{target:C,body:this.text}),this.piTarget=this.text="",this.state=13}else N===63?this.text+="?":(this.text+="?"+String.fromCodePoint(N),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const E=this.skipSpaces();E!==63?E!==-1&&(this.state=28,this.name=String.fromCodePoint(E)):this.state=33}sXMLDeclName(){const E=this.captureTo(q);if(E===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(d(E)||E===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=E===61?30:29}}sXMLDeclEq(){const E=this.getCodeNorm();if(E===63)return this.state=33,void this.fail("XML declaration is incomplete.");d(E)||(E!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const E=this.getCodeNorm();if(E===63)return this.state=33,void this.fail("XML declaration is incomplete.");d(E)||(O(E)?this.q=E:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const E=this.captureTo([this.q,63]);if(E===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(E===-1)return;const N=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const C=N;this.xmlDecl.version=C,/^1\.[0-9]+$/.test(C)?this.opt.forceXMLVersion||this.setXMLVersion(C):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(N)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=N;break;case"standalone":N!=="yes"&&N!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=N}this.name="",this.state=32}sXMLDeclSeparator(){const E=this.getCodeNorm();E!==63?(d(E)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var E;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(E=this.xmldeclHandler)===null||E===void 0||E.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var E;const N=this.captureNameChars();if(N===-1)return;const C=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=C.ns=Object.create(null)),(E=this.openTagStartHandler)===null||E===void 0||E.call(this,C),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),N){case 62:this.openTag();break;case 47:this.state=35;break;default:d(N)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const E=this.skipSpaces();E!==-1&&(u(E)?(this.unget(),this.state=37):E===62?this.openTag():E===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const E=this.captureNameChars();E===61?this.state=39:d(E)?this.state=38:E===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):E!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const E=this.skipSpaces();switch(E){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",E===62?this.openTag():u(E)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const E=this.getCodeNorm();O(E)?(this.q=E,this.state=40):d(E)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:E,chunk:N}=this;let{i:C}=this;for(;;)switch(this.getCode()){case E:return this.pushAttrib(this.name,this.text+N.slice(C,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=N.slice(C,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=N.slice(C,this.prevI)+" ",C=this.i;break;case 60:return this.text+=N.slice(C,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=N.slice(C))}}sAttribValueClosed(){const E=this.getCodeNorm();d(E)?this.state=36:E===62?this.openTag():E===47?this.state=35:u(E)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const E=this.captureTo(Y);switch(E){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",E===62?this.openTag():this.state=36}}sCloseTag(){const E=this.captureNameChars();E===62?this.closeTag():d(E)?this.state=44:E!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:E,forbiddenState:N}=this;const{chunk:C,textHandler:k}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,k!==void 0){const{text:M}=this,U=C.slice(E,this.prevI);M.length!==0?(k(M+U),this.text=""):U.length!==0&&k(U)}N=0;break e;case 38:this.state=14,this.entityReturnState=13,k!==void 0&&(this.text+=C.slice(E,this.prevI)),N=0;break e;case 93:switch(N){case 0:N=1;break;case 1:N=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:N===2&&this.fail('the string "]]>" is disallowed in char data.'),N=0;break;case-2:k!==void 0&&(this.text+=C.slice(E,this.prevI)+`
`),E=this.i,N=0;break;case-1:k!==void 0&&(this.text+=C.slice(E));break e;default:N=0}this.forbiddenState=N}handleTextOutsideRoot(){let{i:E}=this;const{chunk:N,textHandler:C}=this;let k=!1;e:for(;;){const M=this.getCode();switch(M){case 60:if(this.state=15,C!==void 0){const{text:U}=this,$=N.slice(E,this.prevI);U.length!==0?(C(U+$),this.text=""):$.length!==0&&C($)}break e;case 38:this.state=14,this.entityReturnState=13,C!==void 0&&(this.text+=N.slice(E,this.prevI)),k=!0;break e;case-2:C!==void 0&&(this.text+=N.slice(E,this.prevI)+`
`),E=this.i;break;case-1:C!==void 0&&(this.text+=N.slice(E));break e;default:d(M)||(k=!0)}}k&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(E,N){var C;const{prefix:k,local:M}=this.qname(E),U={name:E,prefix:k,local:M,value:N};if(this.attribList.push(U),(C=this.attributeHandler)===null||C===void 0||C.call(this,U),k==="xmlns"){const $=N.trim();this.currentXMLVersion==="1.0"&&$===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[M]=$,G(this,M,$)}else if(E==="xmlns"){const $=N.trim();this.topNS[""]=$,G(this,"",$)}}pushAttribPlain(E,N){var C;const k={name:E,value:N};this.attribList.push(k),(C=this.attributeHandler)===null||C===void 0||C.call(this,k)}end(){var E,N;this.sawRoot||this.fail("document must contain a root element.");const{tags:C}=this;for(;C.length>0;){const M=C.pop();this.fail("unclosed tag: "+M.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:k}=this;return k.length!==0&&((E=this.textHandler)===null||E===void 0||E.call(this,k),this.text=""),this._closed=!0,(N=this.endHandler)===null||N===void 0||N.call(this),this._init(),this}resolve(E){var N,C;let k=this.topNS[E];if(k!==void 0)return k;const{tags:M}=this;for(let U=M.length-1;U>=0;U--)if(k=M[U].ns[E],k!==void 0)return k;return k=this.ns[E],k!==void 0?k:(C=(N=this.opt).resolvePrefix)===null||C===void 0?void 0:C.call(N,E)}qname(E){const N=E.indexOf(":");if(N===-1)return{prefix:"",local:E};const C=E.slice(N+1),k=E.slice(0,N);return(k===""||C===""||C.includes(":"))&&this.fail(`malformed name: ${E}.`),{prefix:k,local:C}}processAttribsNS(){var E;const{attribList:N}=this,C=this.tag;{const{prefix:U,local:$}=this.qname(C.name);C.prefix=U,C.local=$;const X=C.uri=(E=this.resolve(U))!==null&&E!==void 0?E:"";U!==""&&(U==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),X===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(U)}.`),C.uri=U))}if(N.length===0)return;const{attributes:k}=C,M=new Set;for(const U of N){const{name:$,prefix:X,local:Z}=U;let re,W;X===""?(re=$==="xmlns"?b:"",W=$):(re=this.resolve(X),re===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(X)}.`),re=X),W=`{${re}}${Z}`),M.has(W)&&this.fail(`duplicate attribute: ${W}.`),M.add(W),U.uri=re,k[$]=U}this.attribList=[]}processAttribsPlain(){const{attribList:E}=this,N=this.tag.attributes;for(const{name:C,value:k}of E)N[C]!==void 0&&this.fail(`duplicate attribute: ${C}.`),N[C]=k;this.attribList=[]}openTag(){var E;this.processAttribs();const{tags:N}=this,C=this.tag;C.isSelfClosing=!1,(E=this.openTagHandler)===null||E===void 0||E.call(this,C),N.push(C),this.state=13,this.name=""}openSelfClosingTag(){var E,N,C;this.processAttribs();const{tags:k}=this,M=this.tag;M.isSelfClosing=!0,(E=this.openTagHandler)===null||E===void 0||E.call(this,M),(N=this.closeTagHandler)===null||N===void 0||N.call(this,M),(this.tag=(C=k[k.length-1])!==null&&C!==void 0?C:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:E,name:N}=this;if(this.state=13,this.name="",N==="")return this.fail("weird empty close tag."),void(this.text+="</>");const C=this.closeTagHandler;let k=E.length;for(;k-- >0;){const M=this.tag=E.pop();if(this.topNS=M.ns,C==null||C(M),M.name===N)break;this.fail("unexpected close tag.")}k===0?this.closedRoot=!0:k<0&&(this.fail(`unmatched closing tag: ${N}.`),this.text+=`</${N}>`)}parseEntity(E){if(E[0]!=="#"){const C=this.ENTITIES[E];return C!==void 0?C:(this.fail(this.isName(E)?"undefined entity.":"disallowed character in entity name."),`&${E};`)}let N=NaN;return E[1]==="x"&&/^#x[0-9a-f]+$/i.test(E)?N=parseInt(E.slice(2),16):/^#[0-9]+$/.test(E)&&(N=parseInt(E.slice(1),10)),this.isChar(N)?String.fromCodePoint(N):(this.fail("malformed character entity."),`&${E};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(r,s,a){var i=r("safe-buffer").Buffer;function o(l,d){this._block=i.alloc(l),this._finalSize=d,this._blockSize=l,this._len=0}o.prototype.update=function(l,d){typeof l=="string"&&(d=d||"utf8",l=i.from(l,d));for(var c=this._block,u=this._blockSize,h=l.length,f=this._len,m=0;m<h;){for(var p=f%u,g=Math.min(h-m,u-p),x=0;x<g;x++)c[p+x]=l[m+x];m+=g,(f+=g)%u==0&&this._update(c)}return this._len+=h,this},o.prototype.digest=function(l){var d=this._len%this._blockSize;this._block[d]=128,this._block.fill(0,d+1),d>=this._finalSize&&(this._update(this._block),this._block.fill(0));var c=8*this._len;if(c<=4294967295)this._block.writeUInt32BE(c,this._blockSize-4);else{var u=(4294967295&c)>>>0,h=(c-u)/4294967296;this._block.writeUInt32BE(h,this._blockSize-8),this._block.writeUInt32BE(u,this._blockSize-4)}this._update(this._block);var f=this._hash();return l?f.toString(l):f},o.prototype._update=function(){throw new Error("_update must be implemented by subclass")},s.exports=o},{"safe-buffer":494}],498:[function(r,s,a){var i=s.exports=function(o){o=o.toLowerCase();var l=i[o];if(!l)throw new Error(o+" is not supported (we accept pull requests)");return new l};i.sha=r("./sha"),i.sha1=r("./sha1"),i.sha224=r("./sha224"),i.sha256=r("./sha256"),i.sha384=r("./sha384"),i.sha512=r("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(r,s,a){var i=r("inherits"),o=r("./hash"),l=r("safe-buffer").Buffer,d=[1518500249,1859775393,-1894007588,-899497514],c=new Array(80);function u(){this.init(),this._w=c,o.call(this,64,56)}function h(m){return m<<30|m>>>2}function f(m,p,g,x){return m===0?p&g|~p&x:m===2?p&g|p&x|g&x:p^g^x}i(u,o),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(m){for(var p,g=this._w,x=0|this._a,v=0|this._b,y=0|this._c,b=0|this._d,j=0|this._e,T=0;T<16;++T)g[T]=m.readInt32BE(4*T);for(;T<80;++T)g[T]=g[T-3]^g[T-8]^g[T-14]^g[T-16];for(var O=0;O<80;++O){var R=~~(O/20),D=0|((p=x)<<5|p>>>27)+f(R,v,y,b)+j+g[O]+d[R];j=b,b=y,y=h(v),v=x,x=D}this._a=x+this._a|0,this._b=v+this._b|0,this._c=y+this._c|0,this._d=b+this._d|0,this._e=j+this._e|0},u.prototype._hash=function(){var m=l.allocUnsafe(20);return m.writeInt32BE(0|this._a,0),m.writeInt32BE(0|this._b,4),m.writeInt32BE(0|this._c,8),m.writeInt32BE(0|this._d,12),m.writeInt32BE(0|this._e,16),m},s.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(r,s,a){var i=r("inherits"),o=r("./hash"),l=r("safe-buffer").Buffer,d=[1518500249,1859775393,-1894007588,-899497514],c=new Array(80);function u(){this.init(),this._w=c,o.call(this,64,56)}function h(p){return p<<5|p>>>27}function f(p){return p<<30|p>>>2}function m(p,g,x,v){return p===0?g&x|~g&v:p===2?g&x|g&v|x&v:g^x^v}i(u,o),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(p){for(var g,x=this._w,v=0|this._a,y=0|this._b,b=0|this._c,j=0|this._d,T=0|this._e,O=0;O<16;++O)x[O]=p.readInt32BE(4*O);for(;O<80;++O)x[O]=(g=x[O-3]^x[O-8]^x[O-14]^x[O-16])<<1|g>>>31;for(var R=0;R<80;++R){var D=~~(R/20),B=h(v)+m(D,y,b,j)+T+x[R]+d[D]|0;T=j,j=b,b=f(y),y=v,v=B}this._a=v+this._a|0,this._b=y+this._b|0,this._c=b+this._c|0,this._d=j+this._d|0,this._e=T+this._e|0},u.prototype._hash=function(){var p=l.allocUnsafe(20);return p.writeInt32BE(0|this._a,0),p.writeInt32BE(0|this._b,4),p.writeInt32BE(0|this._c,8),p.writeInt32BE(0|this._d,12),p.writeInt32BE(0|this._e,16),p},s.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(r,s,a){var i=r("inherits"),o=r("./sha256"),l=r("./hash"),d=r("safe-buffer").Buffer,c=new Array(64);function u(){this.init(),this._w=c,l.call(this,64,56)}i(u,o),u.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},u.prototype._hash=function(){var h=d.allocUnsafe(28);return h.writeInt32BE(this._a,0),h.writeInt32BE(this._b,4),h.writeInt32BE(this._c,8),h.writeInt32BE(this._d,12),h.writeInt32BE(this._e,16),h.writeInt32BE(this._f,20),h.writeInt32BE(this._g,24),h},s.exports=u},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(r,s,a){var i=r("inherits"),o=r("./hash"),l=r("safe-buffer").Buffer,d=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],c=new Array(64);function u(){this.init(),this._w=c,o.call(this,64,56)}function h(x,v,y){return y^x&(v^y)}function f(x,v,y){return x&v|y&(x|v)}function m(x){return(x>>>2|x<<30)^(x>>>13|x<<19)^(x>>>22|x<<10)}function p(x){return(x>>>6|x<<26)^(x>>>11|x<<21)^(x>>>25|x<<7)}function g(x){return(x>>>7|x<<25)^(x>>>18|x<<14)^x>>>3}i(u,o),u.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},u.prototype._update=function(x){for(var v,y=this._w,b=0|this._a,j=0|this._b,T=0|this._c,O=0|this._d,R=0|this._e,D=0|this._f,B=0|this._g,q=0|this._h,Y=0;Y<16;++Y)y[Y]=x.readInt32BE(4*Y);for(;Y<64;++Y)y[Y]=0|(((v=y[Y-2])>>>17|v<<15)^(v>>>19|v<<13)^v>>>10)+y[Y-7]+g(y[Y-15])+y[Y-16];for(var G=0;G<64;++G){var I=q+p(R)+h(R,D,B)+d[G]+y[G]|0,F=m(b)+f(b,j,T)|0;q=B,B=D,D=R,R=O+I|0,O=T,T=j,j=b,b=I+F|0}this._a=b+this._a|0,this._b=j+this._b|0,this._c=T+this._c|0,this._d=O+this._d|0,this._e=R+this._e|0,this._f=D+this._f|0,this._g=B+this._g|0,this._h=q+this._h|0},u.prototype._hash=function(){var x=l.allocUnsafe(32);return x.writeInt32BE(this._a,0),x.writeInt32BE(this._b,4),x.writeInt32BE(this._c,8),x.writeInt32BE(this._d,12),x.writeInt32BE(this._e,16),x.writeInt32BE(this._f,20),x.writeInt32BE(this._g,24),x.writeInt32BE(this._h,28),x},s.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(r,s,a){var i=r("inherits"),o=r("./sha512"),l=r("./hash"),d=r("safe-buffer").Buffer,c=new Array(160);function u(){this.init(),this._w=c,l.call(this,128,112)}i(u,o),u.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},u.prototype._hash=function(){var h=d.allocUnsafe(48);function f(m,p,g){h.writeInt32BE(m,g),h.writeInt32BE(p,g+4)}return f(this._ah,this._al,0),f(this._bh,this._bl,8),f(this._ch,this._cl,16),f(this._dh,this._dl,24),f(this._eh,this._el,32),f(this._fh,this._fl,40),h},s.exports=u},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(r,s,a){var i=r("inherits"),o=r("./hash"),l=r("safe-buffer").Buffer,d=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],c=new Array(160);function u(){this.init(),this._w=c,o.call(this,128,112)}function h(j,T,O){return O^j&(T^O)}function f(j,T,O){return j&T|O&(j|T)}function m(j,T){return(j>>>28|T<<4)^(T>>>2|j<<30)^(T>>>7|j<<25)}function p(j,T){return(j>>>14|T<<18)^(j>>>18|T<<14)^(T>>>9|j<<23)}function g(j,T){return(j>>>1|T<<31)^(j>>>8|T<<24)^j>>>7}function x(j,T){return(j>>>1|T<<31)^(j>>>8|T<<24)^(j>>>7|T<<25)}function v(j,T){return(j>>>19|T<<13)^(T>>>29|j<<3)^j>>>6}function y(j,T){return(j>>>19|T<<13)^(T>>>29|j<<3)^(j>>>6|T<<26)}function b(j,T){return j>>>0<T>>>0?1:0}i(u,o),u.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},u.prototype._update=function(j){for(var T=this._w,O=0|this._ah,R=0|this._bh,D=0|this._ch,B=0|this._dh,q=0|this._eh,Y=0|this._fh,G=0|this._gh,I=0|this._hh,F=0|this._al,S=0|this._bl,E=0|this._cl,N=0|this._dl,C=0|this._el,k=0|this._fl,M=0|this._gl,U=0|this._hl,$=0;$<32;$+=2)T[$]=j.readInt32BE(4*$),T[$+1]=j.readInt32BE(4*$+4);for(;$<160;$+=2){var X=T[$-30],Z=T[$-30+1],re=g(X,Z),W=x(Z,X),J=v(X=T[$-4],Z=T[$-4+1]),V=y(Z,X),H=T[$-14],ee=T[$-14+1],ie=T[$-32],oe=T[$-32+1],se=W+ee|0,ue=re+H+b(se,W)|0;ue=(ue=ue+J+b(se=se+V|0,V)|0)+ie+b(se=se+oe|0,oe)|0,T[$]=ue,T[$+1]=se}for(var pe=0;pe<160;pe+=2){ue=T[pe],se=T[pe+1];var ce=f(O,R,D),ne=f(F,S,E),me=m(O,F),ge=m(F,O),_e=p(q,C),be=p(C,q),ye=d[pe],Oe=d[pe+1],Ne=h(q,Y,G),De=h(C,k,M),Ge=U+be|0,Qe=I+_e+b(Ge,U)|0;Qe=(Qe=(Qe=Qe+Ne+b(Ge=Ge+De|0,De)|0)+ye+b(Ge=Ge+Oe|0,Oe)|0)+ue+b(Ge=Ge+se|0,se)|0;var Ie=ge+ne|0,Ae=me+ce+b(Ie,ge)|0;I=G,U=M,G=Y,M=k,Y=q,k=C,q=B+Qe+b(C=N+Ge|0,N)|0,B=D,N=E,D=R,E=S,R=O,S=F,O=Qe+Ae+b(F=Ge+Ie|0,Ge)|0}this._al=this._al+F|0,this._bl=this._bl+S|0,this._cl=this._cl+E|0,this._dl=this._dl+N|0,this._el=this._el+C|0,this._fl=this._fl+k|0,this._gl=this._gl+M|0,this._hl=this._hl+U|0,this._ah=this._ah+O+b(this._al,F)|0,this._bh=this._bh+R+b(this._bl,S)|0,this._ch=this._ch+D+b(this._cl,E)|0,this._dh=this._dh+B+b(this._dl,N)|0,this._eh=this._eh+q+b(this._el,C)|0,this._fh=this._fh+Y+b(this._fl,k)|0,this._gh=this._gh+G+b(this._gl,M)|0,this._hh=this._hh+I+b(this._hl,U)|0},u.prototype._hash=function(){var j=l.allocUnsafe(64);function T(O,R,D){j.writeInt32BE(O,D),j.writeInt32BE(R,D+4)}return T(this._ah,this._al,0),T(this._bh,this._bl,8),T(this._ch,this._cl,16),T(this._dh,this._dl,24),T(this._eh,this._el,32),T(this._fh,this._fl,40),T(this._gh,this._gl,48),T(this._hh,this._hl,56),j},s.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(r,s,a){s.exports=o;var i=r("events").EventEmitter;function o(){i.call(this)}r("inherits")(o,i),o.Readable=r("readable-stream/readable.js"),o.Writable=r("readable-stream/writable.js"),o.Duplex=r("readable-stream/duplex.js"),o.Transform=r("readable-stream/transform.js"),o.PassThrough=r("readable-stream/passthrough.js"),o.Stream=o,o.prototype.pipe=function(l,d){var c=this;function u(v){l.writable&&l.write(v)===!1&&c.pause&&c.pause()}function h(){c.readable&&c.resume&&c.resume()}c.on("data",u),l.on("drain",h),l._isStdio||d&&d.end===!1||(c.on("end",m),c.on("close",p));var f=!1;function m(){f||(f=!0,l.end())}function p(){f||(f=!0,typeof l.destroy=="function"&&l.destroy())}function g(v){if(x(),i.listenerCount(this,"error")===0)throw v}function x(){c.removeListener("data",u),l.removeListener("drain",h),c.removeListener("end",m),c.removeListener("close",p),c.removeListener("error",g),l.removeListener("error",g),c.removeListener("end",x),c.removeListener("close",x),l.removeListener("close",x)}return c.on("error",g),l.on("error",g),c.on("end",x),c.on("close",x),l.on("close",x),l.emit("pipe",c),l}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(r,s,a){var i={}.toString;s.exports=Array.isArray||function(o){return i.call(o)=="[object Array]"}},{}],507:[function(r,s,a){s.exports=r("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(r,s,a){var i=r("process-nextick-args"),o=Object.keys||function(x){var v=[];for(var y in x)v.push(y);return v};s.exports=m;var l=Object.create(r("core-util-is"));l.inherits=r("inherits");var d=r("./_stream_readable"),c=r("./_stream_writable");l.inherits(m,d);for(var u=o(c.prototype),h=0;h<u.length;h++){var f=u[h];m.prototype[f]||(m.prototype[f]=c.prototype[f])}function m(x){if(!(this instanceof m))return new m(x);d.call(this,x),c.call(this,x),x&&x.readable===!1&&(this.readable=!1),x&&x.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,x&&x.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",p)}function p(){this.allowHalfOpen||this._writableState.ended||i.nextTick(g,this)}function g(x){x.end()}Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(m.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(x){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=x,this._writableState.destroyed=x)}}),m.prototype._destroy=function(x,v){this.push(null),this.end(),i.nextTick(v,x)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(r,s,a){s.exports=l;var i=r("./_stream_transform"),o=Object.create(r("core-util-is"));function l(d){if(!(this instanceof l))return new l(d);i.call(this,d)}o.inherits=r("inherits"),o.inherits(l,i),l.prototype._transform=function(d,c,u){u(null,d)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(r,s,a){(function(i,o){(function(){var l=r("process-nextick-args");s.exports=O;var d,c=r("isarray");O.ReadableState=T,r("events").EventEmitter;var u=function(U,$){return U.listeners($).length},h=r("./internal/streams/stream"),f=r("safe-buffer").Buffer,m=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},p=Object.create(r("core-util-is"));p.inherits=r("inherits");var g=r("util"),x=void 0;x=g&&g.debuglog?g.debuglog("stream"):function(){};var v,y=r("./internal/streams/BufferList"),b=r("./internal/streams/destroy");p.inherits(O,h);var j=["error","close","destroy","pause","resume"];function T(U,$){U=U||{};var X=$ instanceof(d=d||r("./_stream_duplex"));this.objectMode=!!U.objectMode,X&&(this.objectMode=this.objectMode||!!U.readableObjectMode);var Z=U.highWaterMark,re=U.readableHighWaterMark,W=this.objectMode?16:16384;this.highWaterMark=Z||Z===0?Z:X&&(re||re===0)?re:W,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=U.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,U.encoding&&(v||(v=r("string_decoder/").StringDecoder),this.decoder=new v(U.encoding),this.encoding=U.encoding)}function O(U){if(d=d||r("./_stream_duplex"),!(this instanceof O))return new O(U);this._readableState=new T(U,this),this.readable=!0,U&&(typeof U.read=="function"&&(this._read=U.read),typeof U.destroy=="function"&&(this._destroy=U.destroy)),h.call(this)}function R(U,$,X,Z,re){var W,J=U._readableState;return $===null?(J.reading=!1,function(V,H){if(!H.ended){if(H.decoder){var ee=H.decoder.end();ee&&ee.length&&(H.buffer.push(ee),H.length+=H.objectMode?1:ee.length)}H.ended=!0,q(V)}}(U,J)):(re||(W=function(V,H){var ee;ie=H,f.isBuffer(ie)||ie instanceof m||typeof H=="string"||H===void 0||V.objectMode||(ee=new TypeError("Invalid non-string/buffer chunk"));var ie;return ee}(J,$)),W?U.emit("error",W):J.objectMode||$&&$.length>0?(typeof $=="string"||J.objectMode||Object.getPrototypeOf($)===f.prototype||($=function(V){return f.from(V)}($)),Z?J.endEmitted?U.emit("error",new Error("stream.unshift() after end event")):D(U,J,$,!0):J.ended?U.emit("error",new Error("stream.push() after EOF")):(J.reading=!1,J.decoder&&!X?($=J.decoder.write($),J.objectMode||$.length!==0?D(U,J,$,!1):G(U,J)):D(U,J,$,!1))):Z||(J.reading=!1)),function(V){return!V.ended&&(V.needReadable||V.length<V.highWaterMark||V.length===0)}(J)}function D(U,$,X,Z){$.flowing&&$.length===0&&!$.sync?(U.emit("data",X),U.read(0)):($.length+=$.objectMode?1:X.length,Z?$.buffer.unshift(X):$.buffer.push(X),$.needReadable&&q(U)),G(U,$)}Object.defineProperty(O.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(U){this._readableState&&(this._readableState.destroyed=U)}}),O.prototype.destroy=b.destroy,O.prototype._undestroy=b.undestroy,O.prototype._destroy=function(U,$){this.push(null),$(U)},O.prototype.push=function(U,$){var X,Z=this._readableState;return Z.objectMode?X=!0:typeof U=="string"&&(($=$||Z.defaultEncoding)!==Z.encoding&&(U=f.from(U,$),$=""),X=!0),R(this,U,$,!1,X)},O.prototype.unshift=function(U){return R(this,U,null,!0,!1)},O.prototype.isPaused=function(){return this._readableState.flowing===!1},O.prototype.setEncoding=function(U){return v||(v=r("string_decoder/").StringDecoder),this._readableState.decoder=new v(U),this._readableState.encoding=U,this};function B(U,$){return U<=0||$.length===0&&$.ended?0:$.objectMode?1:U!=U?$.flowing&&$.length?$.buffer.head.data.length:$.length:(U>$.highWaterMark&&($.highWaterMark=function(X){return X>=8388608?X=8388608:(X--,X|=X>>>1,X|=X>>>2,X|=X>>>4,X|=X>>>8,X|=X>>>16,X++),X}(U)),U<=$.length?U:$.ended?$.length:($.needReadable=!0,0))}function q(U){var $=U._readableState;$.needReadable=!1,$.emittedReadable||(x("emitReadable",$.flowing),$.emittedReadable=!0,$.sync?l.nextTick(Y,U):Y(U))}function Y(U){x("emit readable"),U.emit("readable"),E(U)}function G(U,$){$.readingMore||($.readingMore=!0,l.nextTick(I,U,$))}function I(U,$){for(var X=$.length;!$.reading&&!$.flowing&&!$.ended&&$.length<$.highWaterMark&&(x("maybeReadMore read 0"),U.read(0),X!==$.length);)X=$.length;$.readingMore=!1}function F(U){x("readable nexttick read 0"),U.read(0)}function S(U,$){$.reading||(x("resume read 0"),U.read(0)),$.resumeScheduled=!1,$.awaitDrain=0,U.emit("resume"),E(U),$.flowing&&!$.reading&&U.read(0)}function E(U){var $=U._readableState;for(x("flow",$.flowing);$.flowing&&U.read()!==null;);}function N(U,$){return $.length===0?null:($.objectMode?X=$.buffer.shift():!U||U>=$.length?(X=$.decoder?$.buffer.join(""):$.buffer.length===1?$.buffer.head.data:$.buffer.concat($.length),$.buffer.clear()):X=function(Z,re,W){var J;return Z<re.head.data.length?(J=re.head.data.slice(0,Z),re.head.data=re.head.data.slice(Z)):J=Z===re.head.data.length?re.shift():W?function(V,H){var ee=H.head,ie=1,oe=ee.data;for(V-=oe.length;ee=ee.next;){var se=ee.data,ue=V>se.length?se.length:V;if(ue===se.length?oe+=se:oe+=se.slice(0,V),(V-=ue)===0){ue===se.length?(++ie,ee.next?H.head=ee.next:H.head=H.tail=null):(H.head=ee,ee.data=se.slice(ue));break}++ie}return H.length-=ie,oe}(Z,re):function(V,H){var ee=f.allocUnsafe(V),ie=H.head,oe=1;for(ie.data.copy(ee),V-=ie.data.length;ie=ie.next;){var se=ie.data,ue=V>se.length?se.length:V;if(se.copy(ee,ee.length-V,0,ue),(V-=ue)===0){ue===se.length?(++oe,ie.next?H.head=ie.next:H.head=H.tail=null):(H.head=ie,ie.data=se.slice(ue));break}++oe}return H.length-=oe,ee}(Z,re),J}(U,$.buffer,$.decoder),X);var X}function C(U){var $=U._readableState;if($.length>0)throw new Error('"endReadable()" called on non-empty stream');$.endEmitted||($.ended=!0,l.nextTick(k,$,U))}function k(U,$){U.endEmitted||U.length!==0||(U.endEmitted=!0,$.readable=!1,$.emit("end"))}function M(U,$){for(var X=0,Z=U.length;X<Z;X++)if(U[X]===$)return X;return-1}O.prototype.read=function(U){x("read",U),U=parseInt(U,10);var $=this._readableState,X=U;if(U!==0&&($.emittedReadable=!1),U===0&&$.needReadable&&($.length>=$.highWaterMark||$.ended))return x("read: emitReadable",$.length,$.ended),$.length===0&&$.ended?C(this):q(this),null;if((U=B(U,$))===0&&$.ended)return $.length===0&&C(this),null;var Z,re=$.needReadable;return x("need readable",re),($.length===0||$.length-U<$.highWaterMark)&&x("length less than watermark",re=!0),$.ended||$.reading?x("reading or ended",re=!1):re&&(x("do read"),$.reading=!0,$.sync=!0,$.length===0&&($.needReadable=!0),this._read($.highWaterMark),$.sync=!1,$.reading||(U=B(X,$))),(Z=U>0?N(U,$):null)===null?($.needReadable=!0,U=0):$.length-=U,$.length===0&&($.ended||($.needReadable=!0),X!==U&&$.ended&&C(this)),Z!==null&&this.emit("data",Z),Z},O.prototype._read=function(U){this.emit("error",new Error("_read() is not implemented"))},O.prototype.pipe=function(U,$){var X=this,Z=this._readableState;switch(Z.pipesCount){case 0:Z.pipes=U;break;case 1:Z.pipes=[Z.pipes,U];break;default:Z.pipes.push(U)}Z.pipesCount+=1,x("pipe count=%d opts=%j",Z.pipesCount,$);var re=(!$||$.end!==!1)&&U!==i.stdout&&U!==i.stderr?J:pe;function W(ce,ne){x("onunpipe"),ce===X&&ne&&ne.hasUnpiped===!1&&(ne.hasUnpiped=!0,x("cleanup"),U.removeListener("close",se),U.removeListener("finish",ue),U.removeListener("drain",V),U.removeListener("error",oe),U.removeListener("unpipe",W),X.removeListener("end",J),X.removeListener("end",pe),X.removeListener("data",ie),H=!0,!Z.awaitDrain||U._writableState&&!U._writableState.needDrain||V())}function J(){x("onend"),U.end()}Z.endEmitted?l.nextTick(re):X.once("end",re),U.on("unpipe",W);var V=function(ce){return function(){var ne=ce._readableState;x("pipeOnDrain",ne.awaitDrain),ne.awaitDrain&&ne.awaitDrain--,ne.awaitDrain===0&&u(ce,"data")&&(ne.flowing=!0,E(ce))}}(X);U.on("drain",V);var H=!1,ee=!1;function ie(ce){x("ondata"),ee=!1,U.write(ce)!==!1||ee||((Z.pipesCount===1&&Z.pipes===U||Z.pipesCount>1&&M(Z.pipes,U)!==-1)&&!H&&(x("false write response, pause",Z.awaitDrain),Z.awaitDrain++,ee=!0),X.pause())}function oe(ce){x("onerror",ce),pe(),U.removeListener("error",oe),u(U,"error")===0&&U.emit("error",ce)}function se(){U.removeListener("finish",ue),pe()}function ue(){x("onfinish"),U.removeListener("close",se),pe()}function pe(){x("unpipe"),X.unpipe(U)}return X.on("data",ie),function(ce,ne,me){if(typeof ce.prependListener=="function")return ce.prependListener(ne,me);ce._events&&ce._events[ne]?c(ce._events[ne])?ce._events[ne].unshift(me):ce._events[ne]=[me,ce._events[ne]]:ce.on(ne,me)}(U,"error",oe),U.once("close",se),U.once("finish",ue),U.emit("pipe",X),Z.flowing||(x("pipe resume"),X.resume()),U},O.prototype.unpipe=function(U){var $=this._readableState,X={hasUnpiped:!1};if($.pipesCount===0)return this;if($.pipesCount===1)return U&&U!==$.pipes||(U||(U=$.pipes),$.pipes=null,$.pipesCount=0,$.flowing=!1,U&&U.emit("unpipe",this,X)),this;if(!U){var Z=$.pipes,re=$.pipesCount;$.pipes=null,$.pipesCount=0,$.flowing=!1;for(var W=0;W<re;W++)Z[W].emit("unpipe",this,{hasUnpiped:!1});return this}var J=M($.pipes,U);return J===-1||($.pipes.splice(J,1),$.pipesCount-=1,$.pipesCount===1&&($.pipes=$.pipes[0]),U.emit("unpipe",this,X)),this},O.prototype.on=function(U,$){var X=h.prototype.on.call(this,U,$);if(U==="data")this._readableState.flowing!==!1&&this.resume();else if(U==="readable"){var Z=this._readableState;Z.endEmitted||Z.readableListening||(Z.readableListening=Z.needReadable=!0,Z.emittedReadable=!1,Z.reading?Z.length&&q(this):l.nextTick(F,this))}return X},O.prototype.addListener=O.prototype.on,O.prototype.resume=function(){var U=this._readableState;return U.flowing||(x("resume"),U.flowing=!0,function($,X){X.resumeScheduled||(X.resumeScheduled=!0,l.nextTick(S,$,X))}(this,U)),this},O.prototype.pause=function(){return x("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(x("pause"),this._readableState.flowing=!1,this.emit("pause")),this},O.prototype.wrap=function(U){var $=this,X=this._readableState,Z=!1;for(var re in U.on("end",function(){if(x("wrapped end"),X.decoder&&!X.ended){var J=X.decoder.end();J&&J.length&&$.push(J)}$.push(null)}),U.on("data",function(J){x("wrapped data"),X.decoder&&(J=X.decoder.write(J)),X.objectMode&&J==null||(X.objectMode||J&&J.length)&&($.push(J)||(Z=!0,U.pause()))}),U)this[re]===void 0&&typeof U[re]=="function"&&(this[re]=function(J){return function(){return U[J].apply(U,arguments)}}(re));for(var W=0;W<j.length;W++)U.on(j[W],this.emit.bind(this,j[W]));return this._read=function(J){x("wrapped _read",J),Z&&(Z=!1,U.resume())},this},Object.defineProperty(O.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),O._fromList=N}).call(this)}).call(this,r("_process"),typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(r,s,a){s.exports=d;var i=r("./_stream_duplex"),o=Object.create(r("core-util-is"));function l(h,f){var m=this._transformState;m.transforming=!1;var p=m.writecb;if(!p)return this.emit("error",new Error("write callback called multiple times"));m.writechunk=null,m.writecb=null,f!=null&&this.push(f),p(h);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function d(h){if(!(this instanceof d))return new d(h);i.call(this,h),this._transformState={afterTransform:l.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,h&&(typeof h.transform=="function"&&(this._transform=h.transform),typeof h.flush=="function"&&(this._flush=h.flush)),this.on("prefinish",c)}function c(){var h=this;typeof this._flush=="function"?this._flush(function(f,m){u(h,f,m)}):u(this,null,null)}function u(h,f,m){if(f)return h.emit("error",f);if(m!=null&&h.push(m),h._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(h._transformState.transforming)throw new Error("Calling transform done when still transforming");return h.push(null)}o.inherits=r("inherits"),o.inherits(d,i),d.prototype.push=function(h,f){return this._transformState.needTransform=!1,i.prototype.push.call(this,h,f)},d.prototype._transform=function(h,f,m){throw new Error("_transform() is not implemented")},d.prototype._write=function(h,f,m){var p=this._transformState;if(p.writecb=m,p.writechunk=h,p.writeencoding=f,!p.transforming){var g=this._readableState;(p.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},d.prototype._read=function(h){var f=this._transformState;f.writechunk!==null&&f.writecb&&!f.transforming?(f.transforming=!0,this._transform(f.writechunk,f.writeencoding,f.afterTransform)):f.needTransform=!0},d.prototype._destroy=function(h,f){var m=this;i.prototype._destroy.call(this,h,function(p){f(p),m.emit("close")})}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(r,s,a){(function(i,o,l){(function(){var d=r("process-nextick-args");function c(G){var I=this;this.next=null,this.entry=null,this.finish=function(){(function(F,S,E){var N=F.entry;for(F.entry=null;N;){var C=N.callback;S.pendingcb--,C(E),N=N.next}S.corkedRequestsFree.next=F})(I,G)}}s.exports=T;var u,h=!i.browser&&["v0.10","v0.9."].indexOf(i.version.slice(0,5))>-1?l:d.nextTick;T.WritableState=j;var f=Object.create(r("core-util-is"));f.inherits=r("inherits");var m={deprecate:r("util-deprecate")},p=r("./internal/streams/stream"),g=r("safe-buffer").Buffer,x=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},v,y=r("./internal/streams/destroy");function b(){}function j(G,I){u=u||r("./_stream_duplex"),G=G||{};var F=I instanceof u;this.objectMode=!!G.objectMode,F&&(this.objectMode=this.objectMode||!!G.writableObjectMode);var S=G.highWaterMark,E=G.writableHighWaterMark,N=this.objectMode?16:16384;this.highWaterMark=S||S===0?S:F&&(E||E===0)?E:N,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var C=G.decodeStrings===!1;this.decodeStrings=!C,this.defaultEncoding=G.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(k){(function(M,U){var $=M._writableState,X=$.sync,Z=$.writecb;if(function(W){W.writing=!1,W.writecb=null,W.length-=W.writelen,W.writelen=0}($),U)(function(W,J,V,H,ee){--J.pendingcb,V?(d.nextTick(ee,H),d.nextTick(Y,W,J),W._writableState.errorEmitted=!0,W.emit("error",H)):(ee(H),W._writableState.errorEmitted=!0,W.emit("error",H),Y(W,J))})(M,$,X,U,Z);else{var re=B($);re||$.corked||$.bufferProcessing||!$.bufferedRequest||D(M,$),X?h(R,M,$,re,Z):R(M,$,re,Z)}})(I,k)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new c(this)}function T(G){if(u=u||r("./_stream_duplex"),!(v.call(T,this)||this instanceof u))return new T(G);this._writableState=new j(G,this),this.writable=!0,G&&(typeof G.write=="function"&&(this._write=G.write),typeof G.writev=="function"&&(this._writev=G.writev),typeof G.destroy=="function"&&(this._destroy=G.destroy),typeof G.final=="function"&&(this._final=G.final)),p.call(this)}function O(G,I,F,S,E,N,C){I.writelen=S,I.writecb=C,I.writing=!0,I.sync=!0,F?G._writev(E,I.onwrite):G._write(E,N,I.onwrite),I.sync=!1}function R(G,I,F,S){F||function(E,N){N.length===0&&N.needDrain&&(N.needDrain=!1,E.emit("drain"))}(G,I),I.pendingcb--,S(),Y(G,I)}function D(G,I){I.bufferProcessing=!0;var F=I.bufferedRequest;if(G._writev&&F&&F.next){var S=I.bufferedRequestCount,E=new Array(S),N=I.corkedRequestsFree;N.entry=F;for(var C=0,k=!0;F;)E[C]=F,F.isBuf||(k=!1),F=F.next,C+=1;E.allBuffers=k,O(G,I,!0,I.length,E,"",N.finish),I.pendingcb++,I.lastBufferedRequest=null,N.next?(I.corkedRequestsFree=N.next,N.next=null):I.corkedRequestsFree=new c(I),I.bufferedRequestCount=0}else{for(;F;){var M=F.chunk,U=F.encoding,$=F.callback;if(O(G,I,!1,I.objectMode?1:M.length,M,U,$),F=F.next,I.bufferedRequestCount--,I.writing)break}F===null&&(I.lastBufferedRequest=null)}I.bufferedRequest=F,I.bufferProcessing=!1}function B(G){return G.ending&&G.length===0&&G.bufferedRequest===null&&!G.finished&&!G.writing}function q(G,I){G._final(function(F){I.pendingcb--,F&&G.emit("error",F),I.prefinished=!0,G.emit("prefinish"),Y(G,I)})}function Y(G,I){var F=B(I);return F&&(function(S,E){E.prefinished||E.finalCalled||(typeof S._final=="function"?(E.pendingcb++,E.finalCalled=!0,d.nextTick(q,S,E)):(E.prefinished=!0,S.emit("prefinish")))}(G,I),I.pendingcb===0&&(I.finished=!0,G.emit("finish"))),F}f.inherits(T,p),j.prototype.getBuffer=function(){for(var G=this.bufferedRequest,I=[];G;)I.push(G),G=G.next;return I},function(){try{Object.defineProperty(j.prototype,"buffer",{get:m.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(v=Function.prototype[Symbol.hasInstance],Object.defineProperty(T,Symbol.hasInstance,{value:function(G){return!!v.call(this,G)||this===T&&G&&G._writableState instanceof j}})):v=function(G){return G instanceof this},T.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},T.prototype.write=function(G,I,F){var S,E=this._writableState,N=!1,C=!E.objectMode&&(S=G,g.isBuffer(S)||S instanceof x);return C&&!g.isBuffer(G)&&(G=function(k){return g.from(k)}(G)),typeof I=="function"&&(F=I,I=null),C?I="buffer":I||(I=E.defaultEncoding),typeof F!="function"&&(F=b),E.ended?function(k,M){var U=new Error("write after end");k.emit("error",U),d.nextTick(M,U)}(this,F):(C||function(k,M,U,$){var X=!0,Z=!1;return U===null?Z=new TypeError("May not write null values to stream"):typeof U=="string"||U===void 0||M.objectMode||(Z=new TypeError("Invalid non-string/buffer chunk")),Z&&(k.emit("error",Z),d.nextTick($,Z),X=!1),X}(this,E,G,F))&&(E.pendingcb++,N=function(k,M,U,$,X,Z){if(!U){var re=function(H,ee,ie){return H.objectMode||H.decodeStrings===!1||typeof ee!="string"||(ee=g.from(ee,ie)),ee}(M,$,X);$!==re&&(U=!0,X="buffer",$=re)}var W=M.objectMode?1:$.length;M.length+=W;var J=M.length<M.highWaterMark;if(J||(M.needDrain=!0),M.writing||M.corked){var V=M.lastBufferedRequest;M.lastBufferedRequest={chunk:$,encoding:X,isBuf:U,callback:Z,next:null},V?V.next=M.lastBufferedRequest:M.bufferedRequest=M.lastBufferedRequest,M.bufferedRequestCount+=1}else O(k,M,!1,W,$,X,Z);return J}(this,E,C,G,I,F)),N},T.prototype.cork=function(){this._writableState.corked++},T.prototype.uncork=function(){var G=this._writableState;G.corked&&(G.corked--,G.writing||G.corked||G.bufferProcessing||!G.bufferedRequest||D(this,G))},T.prototype.setDefaultEncoding=function(G){if(typeof G=="string"&&(G=G.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((G+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+G);return this._writableState.defaultEncoding=G,this},Object.defineProperty(T.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),T.prototype._write=function(G,I,F){F(new Error("_write() is not implemented"))},T.prototype._writev=null,T.prototype.end=function(G,I,F){var S=this._writableState;typeof G=="function"?(F=G,G=null,I=null):typeof I=="function"&&(F=I,I=null),G!=null&&this.write(G,I),S.corked&&(S.corked=1,this.uncork()),S.ending||function(E,N,C){N.ending=!0,Y(E,N),C&&(N.finished?d.nextTick(C):E.once("finish",C)),N.ended=!0,E.writable=!1}(this,S,F)},Object.defineProperty(T.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(G){this._writableState&&(this._writableState.destroyed=G)}}),T.prototype.destroy=y.destroy,T.prototype._undestroy=y.undestroy,T.prototype._destroy=function(G,I){this.end(),I(G)}}).call(this)}).call(this,r("_process"),typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{},r("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("util");s.exports=function(){function l(){(function(d,c){if(!(d instanceof c))throw new TypeError("Cannot call a class as a function")})(this,l),this.head=null,this.tail=null,this.length=0}return l.prototype.push=function(d){var c={data:d,next:null};this.length>0?this.tail.next=c:this.head=c,this.tail=c,++this.length},l.prototype.unshift=function(d){var c={data:d,next:this.head};this.length===0&&(this.tail=c),this.head=c,++this.length},l.prototype.shift=function(){if(this.length!==0){var d=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,d}},l.prototype.clear=function(){this.head=this.tail=null,this.length=0},l.prototype.join=function(d){if(this.length===0)return"";for(var c=this.head,u=""+c.data;c=c.next;)u+=d+c.data;return u},l.prototype.concat=function(d){if(this.length===0)return i.alloc(0);for(var c,u,h,f=i.allocUnsafe(d>>>0),m=this.head,p=0;m;)c=m.data,u=f,h=p,c.copy(u,h),p+=m.data.length,m=m.next;return f},l}(),o&&o.inspect&&o.inspect.custom&&(s.exports.prototype[o.inspect.custom]=function(){var l=o.inspect({length:this.length});return this.constructor.name+" "+l})},{"safe-buffer":520,util:188}],514:[function(r,s,a){var i=r("process-nextick-args");function o(l,d){l.emit("error",d)}s.exports={destroy:function(l,d){var c=this,u=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return u||h?(d?d(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(o,this,l)):i.nextTick(o,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(f){!d&&f?c._writableState?c._writableState.errorEmitted||(c._writableState.errorEmitted=!0,i.nextTick(o,c,f)):i.nextTick(o,c,f):d&&d(f)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(r,s,a){arguments[4][490][0].apply(a,arguments)},{dup:490,events:422}],516:[function(r,s,a){s.exports=r("./readable").PassThrough},{"./readable":517}],517:[function(r,s,a){(a=s.exports=r("./lib/_stream_readable.js")).Stream=a,a.Readable=a,a.Writable=r("./lib/_stream_writable.js"),a.Duplex=r("./lib/_stream_duplex.js"),a.Transform=r("./lib/_stream_transform.js"),a.PassThrough=r("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(r,s,a){s.exports=r("./readable").Transform},{"./readable":517}],519:[function(r,s,a){s.exports=r("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(r,s,a){arguments[4][217][0].apply(a,arguments)},{buffer:220,dup:217}],521:[function(r,s,a){arguments[4][218][0].apply(a,arguments)},{dup:218,"safe-buffer":520}],522:[function(r,s,a){arguments[4][218][0].apply(a,arguments)},{dup:218,"safe-buffer":494}],523:[function(r,s,a){(function(i,o){(function(){var l=r("process/browser.js").nextTick,d=Function.prototype.apply,c=Array.prototype.slice,u={},h=0;function f(m,p){this._id=m,this._clearFn=p}a.setTimeout=function(){return new f(d.call(setTimeout,window,arguments),clearTimeout)},a.setInterval=function(){return new f(d.call(setInterval,window,arguments),clearInterval)},a.clearTimeout=a.clearInterval=function(m){m.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},a.enroll=function(m,p){clearTimeout(m._idleTimeoutId),m._idleTimeout=p},a.unenroll=function(m){clearTimeout(m._idleTimeoutId),m._idleTimeout=-1},a._unrefActive=a.active=function(m){clearTimeout(m._idleTimeoutId);var p=m._idleTimeout;p>=0&&(m._idleTimeoutId=setTimeout(function(){m._onTimeout&&m._onTimeout()},p))},a.setImmediate=typeof i=="function"?i:function(m){var p=h++,g=!(arguments.length<2)&&c.call(arguments,1);return u[p]=!0,l(function(){u[p]&&(g?m.apply(null,g):m.call(null),a.clearImmediate(p))}),p},a.clearImmediate=typeof o=="function"?o:function(m){delete u[m]}}).call(this)}).call(this,r("timers").setImmediate,r("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(r,s,a){(function(i){(function(){function o(l){try{if(!i.localStorage)return!1}catch{return!1}var d=i.localStorage[l];return d!=null&&String(d).toLowerCase()==="true"}s.exports=function(l,d){if(o("noDeprecation"))return l;var c=!1;return function(){if(!c){if(o("throwDeprecation"))throw new Error(d);o("traceDeprecation")?console.trace(d):console.warn(d),c=!0}return l.apply(this,arguments)}}}).call(this)}).call(this,typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(r,s,a){typeof Object.create=="function"?s.exports=function(i,o){i.super_=o,i.prototype=Object.create(o.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}})}:s.exports=function(i,o){i.super_=o;var l=function(){};l.prototype=o.prototype,i.prototype=new l,i.prototype.constructor=i}},{}],526:[function(r,s,a){s.exports=function(i){return i&&typeof i=="object"&&typeof i.copy=="function"&&typeof i.fill=="function"&&typeof i.readUInt8=="function"}},{}],527:[function(r,s,a){(function(i,o){(function(){var l=/%[sdj%]/g;a.format=function(E){if(!j(E)){for(var N=[],C=0;C<arguments.length;C++)N.push(u(arguments[C]));return N.join(" ")}C=1;for(var k=arguments,M=k.length,U=String(E).replace(l,function(X){if(X==="%%")return"%";if(C>=M)return X;switch(X){case"%s":return String(k[C++]);case"%d":return Number(k[C++]);case"%j":try{return JSON.stringify(k[C++])}catch{return"[Circular]"}default:return X}}),$=k[C];C<M;$=k[++C])y($)||!R($)?U+=" "+$:U+=" "+u($);return U},a.deprecate=function(E,N){if(T(o.process))return function(){return a.deprecate(E,N).apply(this,arguments)};if(i.noDeprecation===!0)return E;var C=!1;return function(){if(!C){if(i.throwDeprecation)throw new Error(N);i.traceDeprecation?console.trace(N):console.error(N),C=!0}return E.apply(this,arguments)}};var d,c={};function u(E,N){var C={seen:[],stylize:f};return arguments.length>=3&&(C.depth=arguments[2]),arguments.length>=4&&(C.colors=arguments[3]),v(N)?C.showHidden=N:N&&a._extend(C,N),T(C.showHidden)&&(C.showHidden=!1),T(C.depth)&&(C.depth=2),T(C.colors)&&(C.colors=!1),T(C.customInspect)&&(C.customInspect=!0),C.colors&&(C.stylize=h),m(C,E,C.depth)}function h(E,N){var C=u.styles[N];return C?"\x1B["+u.colors[C][0]+"m"+E+"\x1B["+u.colors[C][1]+"m":E}function f(E,N){return E}function m(E,N,C){if(E.customInspect&&N&&q(N.inspect)&&N.inspect!==a.inspect&&(!N.constructor||N.constructor.prototype!==N)){var k=N.inspect(C,E);return j(k)||(k=m(E,k,C)),k}var M=function(V,H){if(T(H))return V.stylize("undefined","undefined");if(j(H)){var ee="'"+JSON.stringify(H).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return V.stylize(ee,"string")}if(b(H))return V.stylize(""+H,"number");if(v(H))return V.stylize(""+H,"boolean");if(y(H))return V.stylize("null","null")}(E,N);if(M)return M;var U=Object.keys(N),$=function(V){var H={};return V.forEach(function(ee,ie){H[ee]=!0}),H}(U);if(E.showHidden&&(U=Object.getOwnPropertyNames(N)),B(N)&&(U.indexOf("message")>=0||U.indexOf("description")>=0))return p(N);if(U.length===0){if(q(N)){var X=N.name?": "+N.name:"";return E.stylize("[Function"+X+"]","special")}if(O(N))return E.stylize(RegExp.prototype.toString.call(N),"regexp");if(D(N))return E.stylize(Date.prototype.toString.call(N),"date");if(B(N))return p(N)}var Z,re="",W=!1,J=["{","}"];return x(N)&&(W=!0,J=["[","]"]),q(N)&&(re=" [Function"+(N.name?": "+N.name:"")+"]"),O(N)&&(re=" "+RegExp.prototype.toString.call(N)),D(N)&&(re=" "+Date.prototype.toUTCString.call(N)),B(N)&&(re=" "+p(N)),U.length!==0||W&&N.length!=0?C<0?O(N)?E.stylize(RegExp.prototype.toString.call(N),"regexp"):E.stylize("[Object]","special"):(E.seen.push(N),Z=W?function(V,H,ee,ie,oe){for(var se=[],ue=0,pe=H.length;ue<pe;++ue)S(H,String(ue))?se.push(g(V,H,ee,ie,String(ue),!0)):se.push("");return oe.forEach(function(ce){ce.match(/^\d+$/)||se.push(g(V,H,ee,ie,ce,!0))}),se}(E,N,C,$,U):U.map(function(V){return g(E,N,C,$,V,W)}),E.seen.pop(),function(V,H,ee){return V.reduce(function(ie,oe){return oe.indexOf(`
`)>=0,ie+oe.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?ee[0]+(H===""?"":H+`
 `)+" "+V.join(`,
  `)+" "+ee[1]:ee[0]+H+" "+V.join(", ")+" "+ee[1]}(Z,re,J)):J[0]+re+J[1]}function p(E){return"["+Error.prototype.toString.call(E)+"]"}function g(E,N,C,k,M,U){var $,X,Z;if((Z=Object.getOwnPropertyDescriptor(N,M)||{value:N[M]}).get?X=Z.set?E.stylize("[Getter/Setter]","special"):E.stylize("[Getter]","special"):Z.set&&(X=E.stylize("[Setter]","special")),S(k,M)||($="["+M+"]"),X||(E.seen.indexOf(Z.value)<0?(X=y(C)?m(E,Z.value,null):m(E,Z.value,C-1)).indexOf(`
`)>-1&&(X=U?X.split(`
`).map(function(re){return"  "+re}).join(`
`).substr(2):`
`+X.split(`
`).map(function(re){return"   "+re}).join(`
`)):X=E.stylize("[Circular]","special")),T($)){if(U&&M.match(/^\d+$/))return X;($=JSON.stringify(""+M)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?($=$.substr(1,$.length-2),$=E.stylize($,"name")):($=$.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),$=E.stylize($,"string"))}return $+": "+X}function x(E){return Array.isArray(E)}function v(E){return typeof E=="boolean"}function y(E){return E===null}function b(E){return typeof E=="number"}function j(E){return typeof E=="string"}function T(E){return E===void 0}function O(E){return R(E)&&Y(E)==="[object RegExp]"}function R(E){return typeof E=="object"&&E!==null}function D(E){return R(E)&&Y(E)==="[object Date]"}function B(E){return R(E)&&(Y(E)==="[object Error]"||E instanceof Error)}function q(E){return typeof E=="function"}function Y(E){return Object.prototype.toString.call(E)}function G(E){return E<10?"0"+E.toString(10):E.toString(10)}a.debuglog=function(E){if(T(d)&&(d=i.env.NODE_DEBUG||""),E=E.toUpperCase(),!c[E])if(new RegExp("\\b"+E+"\\b","i").test(d)){var N=i.pid;c[E]=function(){var C=a.format.apply(a,arguments);console.error("%s %d: %s",E,N,C)}}else c[E]=function(){};return c[E]},a.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},a.isArray=x,a.isBoolean=v,a.isNull=y,a.isNullOrUndefined=function(E){return E==null},a.isNumber=b,a.isString=j,a.isSymbol=function(E){return typeof E=="symbol"},a.isUndefined=T,a.isRegExp=O,a.isObject=R,a.isDate=D,a.isError=B,a.isFunction=q,a.isPrimitive=function(E){return E===null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"||typeof E=="symbol"||E===void 0},a.isBuffer=r("./support/isBuffer");var I=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function F(){var E=new Date,N=[G(E.getHours()),G(E.getMinutes()),G(E.getSeconds())].join(":");return[E.getDate(),I[E.getMonth()],N].join(" ")}function S(E,N){return Object.prototype.hasOwnProperty.call(E,N)}a.log=function(){console.log("%s - %s",F(),a.format.apply(a,arguments))},a.inherits=r("inherits"),a._extend=function(E,N){if(!N||!R(N))return E;for(var C=Object.keys(N),k=C.length;k--;)E[C[k]]=N[C[k]];return E}}).call(this)}).call(this,r("_process"),typeof Fr<"u"?Fr:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"v1",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(a,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(a,"v4",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(a,"v5",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(a,"NIL",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(a,"version",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(a,"validate",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(a,"stringify",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(a,"parse",{enumerable:!0,get:function(){return m.default}});var i=p(r("./v1.js")),o=p(r("./v3.js")),l=p(r("./v4.js")),d=p(r("./v5.js")),c=p(r("./nil.js")),u=p(r("./version.js")),h=p(r("./validate.js")),f=p(r("./stringify.js")),m=p(r("./parse.js"));function p(g){return g&&g.__esModule?g:{default:g}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(r,s,a){function i(m){return 14+(m+64>>>9<<4)+1}function o(m,p){const g=(65535&m)+(65535&p);return(m>>16)+(p>>16)+(g>>16)<<16|65535&g}function l(m,p,g,x,v,y){return o((b=o(o(p,m),o(x,y)))<<(j=v)|b>>>32-j,g);var b,j}function d(m,p,g,x,v,y,b){return l(p&g|~p&x,m,p,v,y,b)}function c(m,p,g,x,v,y,b){return l(p&x|g&~x,m,p,v,y,b)}function u(m,p,g,x,v,y,b){return l(p^g^x,m,p,v,y,b)}function h(m,p,g,x,v,y,b){return l(g^(p|~x),m,p,v,y,b)}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var f=function(m){if(typeof m=="string"){const p=unescape(encodeURIComponent(m));m=new Uint8Array(p.length);for(let g=0;g<p.length;++g)m[g]=p.charCodeAt(g)}return function(p){const g=[],x=32*p.length;for(let v=0;v<x;v+=8){const y=p[v>>5]>>>v%32&255,b=parseInt("0123456789abcdef".charAt(y>>>4&15)+"0123456789abcdef".charAt(15&y),16);g.push(b)}return g}(function(p,g){p[g>>5]|=128<<g%32,p[i(g)-1]=g;let x=1732584193,v=-271733879,y=-1732584194,b=271733878;for(let j=0;j<p.length;j+=16){const T=x,O=v,R=y,D=b;x=d(x,v,y,b,p[j],7,-680876936),b=d(b,x,v,y,p[j+1],12,-389564586),y=d(y,b,x,v,p[j+2],17,606105819),v=d(v,y,b,x,p[j+3],22,-1044525330),x=d(x,v,y,b,p[j+4],7,-176418897),b=d(b,x,v,y,p[j+5],12,1200080426),y=d(y,b,x,v,p[j+6],17,-1473231341),v=d(v,y,b,x,p[j+7],22,-45705983),x=d(x,v,y,b,p[j+8],7,1770035416),b=d(b,x,v,y,p[j+9],12,-1958414417),y=d(y,b,x,v,p[j+10],17,-42063),v=d(v,y,b,x,p[j+11],22,-1990404162),x=d(x,v,y,b,p[j+12],7,1804603682),b=d(b,x,v,y,p[j+13],12,-40341101),y=d(y,b,x,v,p[j+14],17,-1502002290),v=d(v,y,b,x,p[j+15],22,1236535329),x=c(x,v,y,b,p[j+1],5,-165796510),b=c(b,x,v,y,p[j+6],9,-1069501632),y=c(y,b,x,v,p[j+11],14,643717713),v=c(v,y,b,x,p[j],20,-373897302),x=c(x,v,y,b,p[j+5],5,-701558691),b=c(b,x,v,y,p[j+10],9,38016083),y=c(y,b,x,v,p[j+15],14,-660478335),v=c(v,y,b,x,p[j+4],20,-405537848),x=c(x,v,y,b,p[j+9],5,568446438),b=c(b,x,v,y,p[j+14],9,-1019803690),y=c(y,b,x,v,p[j+3],14,-187363961),v=c(v,y,b,x,p[j+8],20,1163531501),x=c(x,v,y,b,p[j+13],5,-1444681467),b=c(b,x,v,y,p[j+2],9,-51403784),y=c(y,b,x,v,p[j+7],14,1735328473),v=c(v,y,b,x,p[j+12],20,-1926607734),x=u(x,v,y,b,p[j+5],4,-378558),b=u(b,x,v,y,p[j+8],11,-2022574463),y=u(y,b,x,v,p[j+11],16,1839030562),v=u(v,y,b,x,p[j+14],23,-35309556),x=u(x,v,y,b,p[j+1],4,-1530992060),b=u(b,x,v,y,p[j+4],11,1272893353),y=u(y,b,x,v,p[j+7],16,-155497632),v=u(v,y,b,x,p[j+10],23,-1094730640),x=u(x,v,y,b,p[j+13],4,681279174),b=u(b,x,v,y,p[j],11,-358537222),y=u(y,b,x,v,p[j+3],16,-722521979),v=u(v,y,b,x,p[j+6],23,76029189),x=u(x,v,y,b,p[j+9],4,-640364487),b=u(b,x,v,y,p[j+12],11,-421815835),y=u(y,b,x,v,p[j+15],16,530742520),v=u(v,y,b,x,p[j+2],23,-995338651),x=h(x,v,y,b,p[j],6,-198630844),b=h(b,x,v,y,p[j+7],10,1126891415),y=h(y,b,x,v,p[j+14],15,-1416354905),v=h(v,y,b,x,p[j+5],21,-57434055),x=h(x,v,y,b,p[j+12],6,1700485571),b=h(b,x,v,y,p[j+3],10,-1894986606),y=h(y,b,x,v,p[j+10],15,-1051523),v=h(v,y,b,x,p[j+1],21,-2054922799),x=h(x,v,y,b,p[j+8],6,1873313359),b=h(b,x,v,y,p[j+15],10,-30611744),y=h(y,b,x,v,p[j+6],15,-1560198380),v=h(v,y,b,x,p[j+13],21,1309151649),x=h(x,v,y,b,p[j+4],6,-145523070),b=h(b,x,v,y,p[j+11],10,-1120210379),y=h(y,b,x,v,p[j+2],15,718787259),v=h(v,y,b,x,p[j+9],21,-343485551),x=o(x,T),v=o(v,O),y=o(y,R),b=o(b,D)}return[x,v,y,b]}(function(p){if(p.length===0)return[];const g=8*p.length,x=new Uint32Array(i(g));for(let v=0;v<g;v+=8)x[v>>5]|=(255&p[v/8])<<v%32;return x}(m),8*m.length))};a.default=f},{}],530:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=r("./validate.js"))&&i.__esModule?i:{default:i},l=function(d){if(!(0,o.default)(d))throw TypeError("Invalid UUID");let c;const u=new Uint8Array(16);return u[0]=(c=parseInt(d.slice(0,8),16))>>>24,u[1]=c>>>16&255,u[2]=c>>>8&255,u[3]=255&c,u[4]=(c=parseInt(d.slice(9,13),16))>>>8,u[5]=255&c,u[6]=(c=parseInt(d.slice(14,18),16))>>>8,u[7]=255&c,u[8]=(c=parseInt(d.slice(19,23),16))>>>8,u[9]=255&c,u[10]=(c=parseInt(d.slice(24,36),16))/1099511627776&255,u[11]=c/4294967296&255,u[12]=c>>>24&255,u[13]=c>>>16&255,u[14]=c>>>8&255,u[15]=255&c,u};a.default=l},{"./validate.js":541}],532:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(r,s,a){let i;Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(){if(!i&&(i=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(o)};const o=new Uint8Array(16)},{}],534:[function(r,s,a){function i(d,c,u,h){switch(d){case 0:return c&u^~c&h;case 1:return c^u^h;case 2:return c&u^c&h^u&h;case 3:return c^u^h}}function o(d,c){return d<<c|d>>>32-c}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var l=function(d){const c=[1518500249,1859775393,2400959708,3395469782],u=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof d=="string"){const p=unescape(encodeURIComponent(d));d=[];for(let g=0;g<p.length;++g)d.push(p.charCodeAt(g))}else Array.isArray(d)||(d=Array.prototype.slice.call(d));d.push(128);const h=d.length/4+2,f=Math.ceil(h/16),m=new Array(f);for(let p=0;p<f;++p){const g=new Uint32Array(16);for(let x=0;x<16;++x)g[x]=d[64*p+4*x]<<24|d[64*p+4*x+1]<<16|d[64*p+4*x+2]<<8|d[64*p+4*x+3];m[p]=g}m[f-1][14]=8*(d.length-1)/Math.pow(2,32),m[f-1][14]=Math.floor(m[f-1][14]),m[f-1][15]=8*(d.length-1)&4294967295;for(let p=0;p<f;++p){const g=new Uint32Array(80);for(let T=0;T<16;++T)g[T]=m[p][T];for(let T=16;T<80;++T)g[T]=o(g[T-3]^g[T-8]^g[T-14]^g[T-16],1);let x=u[0],v=u[1],y=u[2],b=u[3],j=u[4];for(let T=0;T<80;++T){const O=Math.floor(T/20),R=o(x,5)+i(O,v,y,b)+j+c[O]+g[T]>>>0;j=b,b=y,y=o(v,30)>>>0,v=x,x=R}u[0]=u[0]+x>>>0,u[1]=u[1]+v>>>0,u[2]=u[2]+y>>>0,u[3]=u[3]+b>>>0,u[4]=u[4]+j>>>0}return[u[0]>>24&255,u[0]>>16&255,u[0]>>8&255,255&u[0],u[1]>>24&255,u[1]>>16&255,u[1]>>8&255,255&u[1],u[2]>>24&255,u[2]>>16&255,u[2]>>8&255,255&u[2],u[3]>>24&255,u[3]>>16&255,u[3]>>8&255,255&u[3],u[4]>>24&255,u[4]>>16&255,u[4]>>8&255,255&u[4]]};a.default=l},{}],535:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=r("./validate.js"))&&i.__esModule?i:{default:i};const l=[];for(let c=0;c<256;++c)l.push((c+256).toString(16).substr(1));var d=function(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const h=(l[c[u+0]]+l[c[u+1]]+l[c[u+2]]+l[c[u+3]]+"-"+l[c[u+4]]+l[c[u+5]]+"-"+l[c[u+6]]+l[c[u+7]]+"-"+l[c[u+8]]+l[c[u+9]]+"-"+l[c[u+10]]+l[c[u+11]]+l[c[u+12]]+l[c[u+13]]+l[c[u+14]]+l[c[u+15]]).toLowerCase();if(!(0,o.default)(h))throw TypeError("Stringified UUID is invalid");return h};a.default=d},{"./validate.js":541}],536:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=l(r("./rng.js")),o=l(r("./stringify.js"));function l(m){return m&&m.__esModule?m:{default:m}}let d,c,u=0,h=0;var f=function(m,p,g){let x=p&&g||0;const v=p||new Array(16);let y=(m=m||{}).node||d,b=m.clockseq!==void 0?m.clockseq:c;if(y==null||b==null){const B=m.random||(m.rng||i.default)();y==null&&(y=d=[1|B[0],B[1],B[2],B[3],B[4],B[5]]),b==null&&(b=c=16383&(B[6]<<8|B[7]))}let j=m.msecs!==void 0?m.msecs:Date.now(),T=m.nsecs!==void 0?m.nsecs:h+1;const O=j-u+(T-h)/1e4;if(O<0&&m.clockseq===void 0&&(b=b+1&16383),(O<0||j>u)&&m.nsecs===void 0&&(T=0),T>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=j,h=T,c=b,j+=122192928e5;const R=(1e4*(268435455&j)+T)%4294967296;v[x++]=R>>>24&255,v[x++]=R>>>16&255,v[x++]=R>>>8&255,v[x++]=255&R;const D=j/4294967296*1e4&268435455;v[x++]=D>>>8&255,v[x++]=255&D,v[x++]=D>>>24&15|16,v[x++]=D>>>16&255,v[x++]=b>>>8|128,v[x++]=255&b;for(let B=0;B<6;++B)v[x+B]=y[B];return p||(0,o.default)(v)};a.default=f},{"./rng.js":533,"./stringify.js":535}],537:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=l(r("./v35.js")),o=l(r("./md5.js"));function l(c){return c&&c.__esModule?c:{default:c}}var d=(0,i.default)("v3",48,o.default);a.default=d},{"./md5.js":529,"./v35.js":538}],538:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(u,h,f){function m(p,g,x,v){if(typeof p=="string"&&(p=function(b){b=unescape(encodeURIComponent(b));const j=[];for(let T=0;T<b.length;++T)j.push(b.charCodeAt(T));return j}(p)),typeof g=="string"&&(g=(0,o.default)(g)),g.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let y=new Uint8Array(16+p.length);if(y.set(g),y.set(p,g.length),y=f(y),y[6]=15&y[6]|h,y[8]=63&y[8]|128,x){v=v||0;for(let b=0;b<16;++b)x[v+b]=y[b];return x}return(0,i.default)(y)}try{m.name=u}catch{}return m.DNS=d,m.URL=c,m},a.URL=a.DNS=void 0;var i=l(r("./stringify.js")),o=l(r("./parse.js"));function l(u){return u&&u.__esModule?u:{default:u}}const d="6ba7b810-9dad-11d1-80b4-00c04fd430c8";a.DNS=d;const c="6ba7b811-9dad-11d1-80b4-00c04fd430c8";a.URL=c},{"./parse.js":531,"./stringify.js":535}],539:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=l(r("./rng.js")),o=l(r("./stringify.js"));function l(c){return c&&c.__esModule?c:{default:c}}var d=function(c,u,h){const f=(c=c||{}).random||(c.rng||i.default)();if(f[6]=15&f[6]|64,f[8]=63&f[8]|128,u){h=h||0;for(let m=0;m<16;++m)u[h+m]=f[m];return u}return(0,o.default)(f)};a.default=d},{"./rng.js":533,"./stringify.js":535}],540:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=l(r("./v35.js")),o=l(r("./sha1.js"));function l(c){return c&&c.__esModule?c:{default:c}}var d=(0,i.default)("v5",80,o.default);a.default=d},{"./sha1.js":534,"./v35.js":538}],541:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=r("./regex.js"))&&i.__esModule?i:{default:i},l=function(d){return typeof d=="string"&&o.default.test(d)};a.default=l},{"./regex.js":532}],542:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=r("./validate.js"))&&i.__esModule?i:{default:i},l=function(d){if(!(0,o.default)(d))throw TypeError("Invalid UUID");return parseInt(d.substr(14,1),16)};a.default=l},{"./validate.js":541}],543:[function(r,s,a){/**
* Character classes and associated utilities for the 5th edition of XML 1.0.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(a,"__esModule",{value:!0}),a.CHAR=`	
\r ---`,a.S=` 	\r
`,a.NAME_START_CHAR=":A-Z_a-z-----------",a.NAME_CHAR="-"+a.NAME_START_CHAR+".0-9--",a.CHAR_RE=new RegExp("^["+a.CHAR+"]$","u"),a.S_RE=new RegExp("^["+a.S+"]+$","u"),a.NAME_START_CHAR_RE=new RegExp("^["+a.NAME_START_CHAR+"]$","u"),a.NAME_CHAR_RE=new RegExp("^["+a.NAME_CHAR+"]$","u"),a.NAME_RE=new RegExp("^["+a.NAME_START_CHAR+"]["+a.NAME_CHAR+"]*$","u"),a.NMTOKEN_RE=new RegExp("^["+a.NAME_CHAR+"]+$","u");function i(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}a.S_LIST=[32,10,13,9],a.isChar=function(o){return o>=32&&o<=55295||o===10||o===13||o===9||o>=57344&&o<=65533||o>=65536&&o<=1114111},a.isS=function(o){return o===32||o===10||o===13||o===9},a.isNameStartChar=i,a.isNameChar=function(o){return i(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],544:[function(r,s,a){/**
* Character classes and associated utilities for the 2nd edition of XML 1.1.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(a,"__esModule",{value:!0}),a.CHAR="---",a.RESTRICTED_CHAR="-\b\v\f---",a.S=` 	\r
`,a.NAME_START_CHAR=":A-Z_a-z-----------",a.NAME_CHAR="-"+a.NAME_START_CHAR+".0-9--",a.CHAR_RE=new RegExp("^["+a.CHAR+"]$","u"),a.RESTRICTED_CHAR_RE=new RegExp("^["+a.RESTRICTED_CHAR+"]$","u"),a.S_RE=new RegExp("^["+a.S+"]+$","u"),a.NAME_START_CHAR_RE=new RegExp("^["+a.NAME_START_CHAR+"]$","u"),a.NAME_CHAR_RE=new RegExp("^["+a.NAME_CHAR+"]$","u"),a.NAME_RE=new RegExp("^["+a.NAME_START_CHAR+"]["+a.NAME_CHAR+"]*$","u"),a.NMTOKEN_RE=new RegExp("^["+a.NAME_CHAR+"]+$","u");function i(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}a.S_LIST=[32,10,13,9],a.isChar=function(o){return o>=1&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},a.isRestrictedChar=function(o){return o>=1&&o<=8||o===11||o===12||o>=14&&o<=31||o>=127&&o<=132||o>=134&&o<=159},a.isCharAndNotRestricted=function(o){return o===9||o===10||o===13||o>31&&o<127||o===133||o>159&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},a.isS=function(o){return o===32||o===10||o===13||o===9},a.isNameStartChar=i,a.isNameChar=function(o){return i(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],545:[function(r,s,a){/**
* Character class utilities for XML NS 1.0 edition 3.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/function i(o){return o>=65&&o<=90||o===95||o>=97&&o<=122||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8204&&o<=8205||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}Object.defineProperty(a,"__esModule",{value:!0}),a.NC_NAME_START_CHAR="A-Z_a-z------------",a.NC_NAME_CHAR="-"+a.NC_NAME_START_CHAR+".0-9--",a.NC_NAME_START_CHAR_RE=new RegExp("^["+a.NC_NAME_START_CHAR+"]$","u"),a.NC_NAME_CHAR_RE=new RegExp("^["+a.NC_NAME_CHAR+"]$","u"),a.NC_NAME_RE=new RegExp("^["+a.NC_NAME_START_CHAR+"]["+a.NC_NAME_CHAR+"]*$","u"),a.isNCNameStartChar=i,a.isNCNameChar=function(o){return i(o)||o===45||o===46||o>=48&&o<=57||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}]},{},[15])(15)})})(rG);var l2e=rG.exports;const ww=Ln(l2e);function c2e(e,t,r){const s={...r||{}},a=e||{};for(const i of Object.keys(t)){const o=a[i]||0,d=(t[i]||0)-o;if(d<0){const c=Math.abs(d);s[i]=Math.max(0,(s[i]||0)-c)}}for(const i of Object.keys(s))s[i]===0&&delete s[i];return s}function d2e(e,t){const r=e||{},s=t||{},a={};for(const i of Object.keys(r)){const o=r[i]||0,l=s[i]||0;a[i]=Math.max(0,o-l)}return a}const u2e=["PP","P","M","G","GG","XG","XXG","XXXG","UN","U","UNICO","NICO","34","35","36","37","38","39","40","41","42","43","44","45","46","48","50","52"],h2e=["QT","QTDE","QUANTIDADE","TOTAL","SALDO"];function f2e(e){const t=e.trim().toUpperCase();return t==="U"||t==="UNICO"||t==="NICO"?"UN":t}function m2e(e){const t=e.trim().toUpperCase();return h2e.includes(t)}function A3(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}const cM={preto:"Preto",branco:"Branco",bege:"Bege",rosa:"Rosa",azul:"Azul",verde:"Verde",vermelho:"Vermelho",marrom:"Marrom",cinza:"Cinza",estampado:"Estampado","off white":"Off White",offwhite:"Off White","off-white":"Off White",chocolate:"Chocolate",menta:"Menta",nude:"Nude",caramelo:"Caramelo",mostarda:"Mostarda",vinho:"Vinho",laranja:"Laranja",amarelo:"Amarelo",lilas:"Lils",lils:"Lils",roxo:"Roxo",coral:"Coral"};function p2e(e){if(!e)return e;const t=e.trim().toLowerCase();return cM[t]?cM[t]:e.trim().split(/\s+/).map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" ")}function n8(e){if(e==null||e==="")return null;if(typeof e=="number")return isNaN(e)?null:e;let t=String(e).trim();if(t==="")return null;t=t.replace(/[R$\s]/g,"");const r=t.lastIndexOf(","),s=t.lastIndexOf(".");r>s&&r!==-1?(t=t.replace(/\./g,""),t=t.replace(",",".")):(s!==-1||r===-1)&&(t=t.replace(/,/g,""));const i=parseFloat(t);return isNaN(i)?null:i}function g2e(e){const t=n8(e);return t===null?0:t>1e4?(console.log(`[parsePrice] Auto-converting from centavos: ${t} -> ${t/100}`),t/100):t}function x2e(e){const t=n8(e);if(t===null)return 0;const r=Math.trunc(t);return r<0?0:r}function v2e(){var $,X;const e=pr(),{user:t,isLoading:r,rolesLoading:s,isMerchant:a}=qn(),[i,o]=P.useState(null),[l,d]=P.useState([]),[c,u]=P.useState(!1),[h,f]=P.useState(!1),[m,p]=P.useState(!1),[g,x]=P.useState([]),[v,y]=P.useState(!1),[b,j]=P.useState(!0),[T,O]=P.useState({updatedCount:0,createdCount:0,negativeValuesWarning:!1,showResult:!1}),[R,D]=P.useState(!1),[B,q]=P.useState(0);P.useEffect(()=>{!r&&!s&&(!t||!a())&&e("/login")},[t,r,s,a,e]),P.useEffect(()=>{t&&Y()},[t]);const Y=async()=>{const{data:Z,error:re}=await le.from("inventory_imports").select("id, filename, total_rows, matched_count, unmatched_count, created_at").order("created_at",{ascending:!1}).limit(20);!re&&Z&&x(Z)},G=P.useCallback(Z=>{var W;const re=(W=Z.target.files)==null?void 0:W[0];re&&(o(re),p(!1),d([]))},[]),I=async()=>{if(i){u(!0);try{const Z=await i.arrayBuffer(),re=new ww.Workbook;await re.xlsx.load(Z);const W=re.worksheets[0];if(!W){de.error("Planilha vazia"),u(!1);return}const J=[];W.eachRow({includeEmpty:!1},_e=>{J.push(_e.values?_e.values.slice(1):[])});const V=J[0]||[],H=_e=>String(_e??"").trim(),ee=_e=>H(_e).toUpperCase();let ie=V.findIndex(_e=>ee(_e)==="REFERE");ie===-1&&(ie=V.findIndex(_e=>ee(_e).includes("REFERENCIA")));const oe=V.findIndex(_e=>ee(_e).includes("TIPODESC")),se=V.findIndex(_e=>ee(_e).includes("COR1DESC")),ue=V.findIndex(_e=>ee(_e).includes("PRCVENDA")),pe={};for(let _e=0;_e<V.length;_e++){const be=H(V[_e]);if(!be)continue;const ye=be.toUpperCase();if(m2e(be)){console.log(`Ignoring column: "${be}" at index ${_e}`);continue}const Oe=/^\d+$/.test(be);let Ne=null;if(Oe){const De=Number(be);Number.isFinite(De)&&De>=34&&De<=46&&(Ne=String(De))}else{const De=f2e(ye);u2e.includes(De)&&(Ne=De)}Ne&&(pe[Ne]||(pe[Ne]=[]),pe[Ne].push(_e),pe[Ne].length>1?console.log(`Mapped duplicate size column: "${be}" -> "${Ne}" at index ${_e}`):console.log(`Mapped size column: "${be}" -> "${Ne}" at index ${_e}`))}if(console.log("Final mapped size columns:",pe),console.log("Header mapping:",{referenciaIndex:ie,tipoDescIndex:oe,cor1DescIndex:se,prcVendaIndex:ue,sizeColumnIndexes:pe,headerRow:V.slice(0,20)}),ie===-1||oe===-1||se===-1){de.error("Colunas obrigatrias no encontradas: REFERE/REFERENCIA, TIPODESC, COR1DESC"),u(!1);return}if(Object.keys(pe).length===0){de.error("Nenhuma coluna de tamanho encontrada (PP/P/M/G/GG/UN ou numricas 3446 como 36/38/40/42/44)"),u(!1);return}ue===-1&&de.warning("Coluna PRCVENDA no encontrada - preos sero definidos como 0");const ce=new Map;let ne=!1,me=0;for(let _e=1;_e<J.length;_e++){const be=J[_e],ye=String(be[ie]||"").trim(),Oe=String(be[oe]||"").trim(),Ne=String(be[se]||"").trim();if(!ye||!Ne)continue;me++;const De=A3(Ne),Ge=`${ye}-${De}`;ce.has(Ge)||ce.set(Ge,{referencia:ye,tipoDesc:Oe,cor1Desc:Ne,stockBySize:{},prices:[]});const Qe=ce.get(Ge);if(ue!==-1){const Ie=be[ue];_e<=5&&console.log(`[DEBUG Row ${_e}] PRCVENDA raw:`,Ie,`type: ${typeof Ie}`);const Ae=g2e(Ie);_e<=5&&console.log(`[DEBUG Row ${_e}] PRCVENDA parsed:`,Ae),Ae>0&&Qe.prices.push(Ae)}for(const[Ie,Ae]of Object.entries(pe)){let st=0;for(const nt of Ae){const vt=be[nt];_e<=5&&vt!==void 0&&vt!==null&&vt!==""&&console.log(`[DEBUG Row ${_e}] Stock ${Ie} raw:`,vt,`type: ${typeof vt}`);const Je=x2e(vt);_e<=5&&vt!==void 0&&vt!==null&&vt!==""&&console.log(`[DEBUG Row ${_e}] Stock ${Ie} parsed:`,Je);const Ue=n8(vt);Ue!==null&&Ue<0&&(ne=!0),st+=Je}Qe.stockBySize[Ie]=(Qe.stockBySize[Ie]||0)+st}}q(me);const ge=Object.values(pe).reduce((_e,be)=>_e+be.length,0);await F(Array.from(ce.values()),ne,ge),p(!0),ne&&de.warning("Valores negativos detectados e normalizados para 0")}catch(Z){console.error("Error parsing file:",Z),de.error("Erro ao ler arquivo")}finally{u(!1)}}},F=async(Z,re,W)=>{const J=Z.map(oe=>`${oe.referencia}-${A3(oe.cor1Desc)}`),{data:V,error:H}=await le.from("product_catalog").select("id, sku, group_key, name").in("sku",J);H&&console.error("Error fetching products:",H);const ee=new Map((V==null?void 0:V.map(oe=>[oe.sku,oe]))||[]),ie=Z.map(oe=>{const se=`${oe.referencia}-${A3(oe.cor1Desc)}`,ue=ee.get(se),ce=Object.values(oe.stockBySize).reduce((_e,be)=>_e+be,0)===0,ne=[...new Set(oe.prices)],me=ne.length>1,ge=ne.length>0?Math.max(...ne):0;return{groupKey:se,referencia:oe.referencia,color:p2e(oe.cor1Desc),productName:oe.tipoDesc,stockBySize:oe.stockBySize,price:ge,hasPriceVariation:me,existingProductId:ue==null?void 0:ue.id,isNew:!ue,hasNegativeValues:re,hasZeroStock:ce,mappedSizesCount:W}});d(ie)},S=async()=>{if(l.length===0){de.error("Nenhum produto para processar");return}f(!0);let Z=0,re=0;const W=l.some(J=>J.hasNegativeValues);try{for(const H of l){const ee=Object.entries(H.stockBySize).filter(([,ie])=>ie>0).map(([ie])=>ie);if(H.existingProductId){const{data:ie}=await le.from("product_catalog").select("erp_stock_by_size, committed_by_size").eq("id",H.existingProductId).single(),oe=(ie==null?void 0:ie.erp_stock_by_size)||{},se=(ie==null?void 0:ie.committed_by_size)||{},ue=c2e(oe,H.stockBySize,se),pe=d2e(H.stockBySize,ue),{error:ce}=await le.from("product_catalog").update({erp_stock_by_size:H.stockBySize,committed_by_size:ue,stock_by_size:pe,sizes:ee}).eq("id",H.existingProductId);ce?console.error("Error updating product:",H.groupKey,ce):Z++}else if(b){const ie=H.groupKey,oe=`${H.productName} - ${H.color} (${H.referencia})`,{error:se}=await le.from("product_catalog").insert({user_id:t==null?void 0:t.id,sku:ie,group_key:H.referencia,name:H.productName,color:H.color,description:oe,price:H.price,is_active:!1,created_from_import:!0,erp_stock_by_size:H.stockBySize,committed_by_size:{},stock_by_size:H.stockBySize,sizes:ee,tags:H.hasPriceVariation?["revisao-preco"]:[]});se?console.error("Error creating product:",H.groupKey,se):re++}}const J=l.filter(H=>H.isNew),V=l.filter(H=>!H.isNew);await le.from("inventory_imports").insert({user_id:t==null?void 0:t.id,filename:(i==null?void 0:i.name)||"import.xlsx",total_rows:B,matched_count:V.length,unmatched_count:b?0:J.length,updated_products:V.map(H=>({id:H.existingProductId,sku:H.groupKey,name:H.productName})),unmatched_skus:b?[]:J.map(H=>H.groupKey)}),Y(),O({updatedCount:Z,createdCount:re,negativeValuesWarning:W,showResult:!0}),o(null),d([]),p(!1),re>0?de.success(`${Z} produtos atualizados e ${re} produtos criados como rascunho!`):de.success(`${Z} produtos atualizados!`)}catch(J){console.error("Error applying changes:",J),de.error("Erro ao aplicar alteraes")}finally{f(!1)}},E=async()=>{D(!0);try{const{data:Z,error:re}=await le.from("product_catalog").select("id, name, sku, stock_by_size, group_key, created_from_import").eq("created_from_import",!0);if(re){de.error("Erro ao buscar produtos importados");return}if(!Z||Z.length===0){de.info("Nenhum produto importado encontrado para consolidar");return}const W=new Map;for(const H of Z){const ee=H.sku||H.group_key;ee&&(W.has(ee)||W.set(ee,[]),W.get(ee).push(H))}let J=0,V=0;for(const[H,ee]of W){if(ee.length<=1)continue;const ie=ee[0],oe=ie.stock_by_size||{};for(let ce=1;ce<ee.length;ce++){const me=ee[ce].stock_by_size||{};for(const[ge,_e]of Object.entries(me))oe[ge]=(oe[ge]||0)+_e}const{error:se}=await le.from("product_catalog").update({stock_by_size:oe,sizes:Object.keys(oe).filter(ce=>oe[ce]>0)}).eq("id",ie.id);if(se){console.error("Error updating main product:",se);continue}const ue=ee.slice(1).map(ce=>ce.id),{error:pe}=await le.from("product_catalog").delete().in("id",ue);pe?console.error("Error deleting duplicates:",pe):(J++,V+=ue.length)}J>0?de.success(`${J} produtos consolidados, ${V} duplicatas removidas!`):de.info("Nenhuma duplicata encontrada para consolidar")}catch(Z){console.error("Error merging products:",Z),de.error("Erro ao consolidar produtos")}finally{D(!1)}},N=async()=>{const Z=[["REFERENCIA","TIPODESC","COR1DESC","PRCVENDA","PP","P","M","G","GG","UN","36","38","40","42"],["YT00172","TOP CARLA","PRETO","129,90",2,5,3,1,0,0,0,0,0,0],["YT00172","TOP CARLA","BRANCO","129,90",1,4,2,2,1,0,0,0,0,0],["YT00015","TOP DANI","ROSA","89,90",0,3,5,2,0,0,0,0,0,0]],re=new ww.Workbook,W=re.addWorksheet("Estoque");Z.forEach(ie=>W.addRow(ie));const J=await re.xlsx.writeBuffer(),V=new Blob([J],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),H=window.URL.createObjectURL(V),ee=document.createElement("a");ee.href=H,ee.download="modelo_estoque_novo.xlsx",ee.click(),window.URL.revokeObjectURL(H)},C=Z=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Z),k=l.some(Z=>Z.hasPriceVariation);if(r||s)return n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Carregando..."});const M=l.filter(Z=>Z.isNew),U=l.filter(Z=>!Z.isNew);return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-serif font-bold",children:"Importar Estoque"}),n.jsx("p",{className:"text-muted-foreground",children:"Novo formato: REFERENCIA + COR = produto nico"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{variant:"outline",onClick:N,children:[n.jsx(vf,{className:"h-4 w-4 mr-2"}),"Baixar modelo"]}),n.jsxs(he,{variant:"outline",onClick:E,disabled:R,children:[n.jsx(sse,{className:"h-4 w-4 mr-2"}),R?"Consolidando...":"Consolidar duplicatas"]}),n.jsxs(he,{variant:"outline",onClick:()=>y(!0),children:[n.jsx(Gb,{className:"h-4 w-4 mr-2"}),"Histrico"]})]})]}),n.jsxs($e,{className:"mb-6",children:[n.jsxs(Dt,{children:[n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Gh,{className:"h-5 w-5"}),"Upload de Planilha"]}),n.jsx(qi,{children:"Formato: REFERENCIA, TIPODESC, COR1DESC, PRCVENDA e colunas de tamanho (PP, P, M, G, GG, UN, 36-42)"})]}),n.jsx(Fe,{children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[n.jsx("div",{className:"flex-1",children:n.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer hover:bg-muted/50 transition-colors",children:[n.jsx(Lh,{className:"h-8 w-8 text-muted-foreground mb-2"}),n.jsx("span",{className:"text-sm text-muted-foreground",children:i?i.name:"Clique ou arraste um arquivo"}),n.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls,.csv",onChange:G})]})}),n.jsx(he,{onClick:I,disabled:!i||c,className:"sm:self-end",children:c?"Processando...":"Processar arquivo"})]})})]}),m&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[n.jsx($e,{children:n.jsxs(Fe,{className:"pt-6",children:[n.jsx("div",{className:"text-2xl font-bold text-primary",children:B}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Linhas lidas"})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"pt-6",children:[n.jsx("div",{className:"text-2xl font-bold text-primary",children:l.length}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Produtos (Ref+Cor)"})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"pt-6",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(gn,{className:"h-5 w-5 text-green-500"}),n.jsx("span",{className:"text-2xl font-bold text-green-600",children:U.length}),n.jsx("span",{className:"text-muted-foreground",children:"/"}),n.jsx(kn,{className:"h-5 w-5 text-amber-500"}),n.jsx("span",{className:"text-2xl font-bold text-amber-600",children:M.length})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Existentes / Novos"})]})})]}),l.some(Z=>Z.hasNegativeValues)&&n.jsx($e,{className:"mb-6 border-amber-200 bg-amber-50",children:n.jsxs(Fe,{className:"pt-6 flex items-center gap-3",children:[n.jsx(Sn,{className:"h-5 w-5 text-amber-600"}),n.jsxs("span",{className:"text-amber-800",children:[n.jsx("strong",{children:"Ateno:"})," Valores negativos foram detectados na planilha e normalizados para 0."]})]})}),k&&n.jsx($e,{className:"mb-6 border-orange-200 bg-orange-50",children:n.jsxs(Fe,{className:"pt-6 flex items-center gap-3",children:[n.jsx(Sn,{className:"h-5 w-5 text-orange-600"}),n.jsxs("span",{className:"text-orange-800",children:[n.jsx("strong",{children:"Variao de preo:"})," Alguns produtos possuem preos diferentes entre tamanhos. O maior valor foi usado e os produtos foram marcados para reviso."]})]})}),l.some(Z=>Z.hasZeroStock)&&n.jsx($e,{className:"mb-6 border-red-200 bg-red-50",children:n.jsxs(Fe,{className:"pt-6 flex items-center gap-3",children:[n.jsx(Sn,{className:"h-5 w-5 text-red-600"}),n.jsxs("span",{className:"text-red-800",children:[n.jsx("strong",{children:"Estoque zerado:"})," ",l.filter(Z=>Z.hasZeroStock).length," produto(s) no possuem estoque ou as colunas de tamanho no foram mapeadas corretamente.",(($=l[0])==null?void 0:$.mappedSizesCount)>0&&n.jsxs("span",{className:"block text-sm mt-1",children:["Colunas de tamanho mapeadas: ",(X=l[0])==null?void 0:X.mappedSizesCount]})]})]})}),n.jsxs($e,{className:"mb-6",children:[n.jsxs(Dt,{children:[n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Gh,{className:"h-5 w-5"}),"Produtos (",l.length,")"]}),n.jsx(qi,{children:"Cada linha = REFERENCIA + COR (produto nico)"})]}),n.jsxs(Fe,{children:[b&&M.length>0&&n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-amber-50 rounded-lg border border-amber-200 mb-4",children:[n.jsx("input",{type:"checkbox",id:"autoCreate",checked:b,onChange:Z=>j(Z.target.checked),className:"h-4 w-4 rounded border-gray-300"}),n.jsx("label",{htmlFor:"autoCreate",className:"text-sm",children:n.jsxs("strong",{children:["Auto-cadastrar ",M.length," produto(s) novo(s) como rascunho"]})})]}),n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{children:"Status"}),n.jsx(St,{children:"Modelo"}),n.jsx(St,{children:"Cor"}),n.jsx(St,{children:"Nome"}),n.jsx(St,{children:"Preo"}),n.jsx(St,{children:"Estoque por Tamanho"})]})}),n.jsx(ya,{children:l.slice(0,30).map(Z=>n.jsxs(Kr,{children:[n.jsx(bt,{children:Z.isNew?n.jsxs(ke,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200",children:[n.jsx(kn,{className:"h-3 w-3 mr-1"}),"Novo"]}):n.jsxs(ke,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[n.jsx(gn,{className:"h-3 w-3 mr-1"}),"Atualizar"]})}),n.jsx(bt,{className:"font-mono font-bold",children:Z.referencia}),n.jsx(bt,{children:n.jsx(ke,{variant:"secondary",children:Z.color})}),n.jsx(bt,{children:Z.productName}),n.jsx(bt,{children:n.jsxs("div",{className:"flex items-center gap-1",children:[Z.price>0?n.jsx("span",{className:Z.hasPriceVariation?"text-orange-600 font-medium":"",children:C(Z.price)}):n.jsx("span",{className:"text-muted-foreground text-sm",children:"-"}),Z.hasPriceVariation&&n.jsx(ke,{variant:"outline",className:"text-xs bg-orange-50 text-orange-600 border-orange-200",children:"Variao"})]})}),n.jsx(bt,{children:n.jsx("div",{className:"flex flex-wrap gap-1",children:(()=>{const re=Object.entries(Z.stockBySize),W=re.filter(([,V])=>V>0),J=re.filter(([,V])=>V===0);return W.length===0&&re.length===0?n.jsx("span",{className:"text-xs text-red-500 font-medium",children:" Colunas no mapeadas"}):W.length===0?n.jsx("span",{className:"text-xs text-amber-600 font-medium",children:" Estoque zerado"}):n.jsxs(n.Fragment,{children:[W.map(([V,H])=>n.jsxs(ke,{variant:"default",className:"text-xs",children:[V,": ",H]},V)),J.slice(0,3).map(([V])=>n.jsxs(ke,{variant:"outline",className:"text-xs text-muted-foreground",children:[V,": 0"]},V)),J.length>3&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",J.length-3]})]})})()})})]},Z.groupKey))})]}),l.length>30&&n.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["E mais ",l.length-30," produtos..."]})]})]}),n.jsx(Ca,{className:"my-6"}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx(he,{variant:"outline",onClick:()=>{p(!1),o(null),d([])},children:"Cancelar"}),n.jsx(he,{onClick:S,disabled:h||l.length===0,children:h?"Aplicando...":`Aplicar (${U.length} atualizar${M.length>0&&b?` + ${M.length} criar`:""})`})]})]}),T.showResult&&n.jsxs($e,{className:"border-green-200 bg-green-50",children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2 text-green-700",children:[n.jsx(gn,{className:"h-5 w-5"}),"Importao Concluda!"]})}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"p-4 bg-white rounded-lg border",children:[n.jsx("div",{className:"text-2xl font-bold text-primary",children:T.updatedCount}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Produtos atualizados"})]}),n.jsxs("div",{className:"p-4 bg-white rounded-lg border",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:T.createdCount}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Produtos criados (rascunho)"})]}),T.negativeValuesWarning&&n.jsx("div",{className:"p-4 bg-amber-50 rounded-lg border border-amber-200",children:n.jsxs("div",{className:"flex items-center gap-2 text-amber-600",children:[n.jsx(Sn,{className:"h-5 w-5"}),n.jsx("span",{className:"font-medium",children:"Valores negativos normalizados"})]})})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(he,{variant:"outline",onClick:()=>O({updatedCount:0,createdCount:0,negativeValuesWarning:!1,showResult:!1}),children:"Fazer nova importao"}),T.createdCount>0&&n.jsxs(he,{onClick:()=>e("/dashboard?tab=products&filter=imported"),children:[n.jsx(jx,{className:"h-4 w-4 mr-2"}),"Ver produtos arquivados"]})]})]})]})]}),n.jsx(tn,{open:v,onOpenChange:y,children:n.jsxs(Jr,{className:"max-w-2xl",children:[n.jsx(ln,{children:n.jsx(rn,{children:"Histrico de Importaes"})}),n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{children:"Arquivo"}),n.jsx(St,{children:"Linhas"}),n.jsx(St,{children:"Atualizados"}),n.jsx(St,{children:"Novos"}),n.jsx(St,{children:"Data"})]})}),n.jsx(ya,{children:g.map(Z=>n.jsxs(Kr,{children:[n.jsx(bt,{className:"font-medium",children:Z.filename}),n.jsx(bt,{children:Z.total_rows}),n.jsx(bt,{className:"text-green-600",children:Z.matched_count}),n.jsx(bt,{className:"text-amber-600",children:Z.unmatched_count}),n.jsx(bt,{className:"text-muted-foreground",children:new Date(Z.created_at).toLocaleDateString("pt-BR")})]},Z.id))})]})]})})]})}function y2e({customer:e,hasQuiz:t,hasPrints:r}){const s=c=>{const u=c.replace(/\D/g,"");return u.length===11?`(${u.slice(0,2)}) ${u.slice(2,7)}-${u.slice(7)}`:u.length===13&&u.startsWith("55")?`(${u.slice(2,4)}) ${u.slice(4,9)}-${u.slice(9)}`:c},a=c=>new Date(c).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit"}),i=c=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c),o=!!e.name&&!!e.phone&&!!e.email,l=o?"Cadastro completo":"Cadastro incompleto",d=`Oi ${e.name||""}!  Sou da Lepoa, tudo bem?`;return n.jsxs("div",{className:"bg-card rounded-xl border border-border p-6",children:[n.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[n.jsxs(ke,{variant:"outline",className:"gap-1",children:[" ",e.total_orders," pedido",e.total_orders!==1?"s":""]}),n.jsxs(ke,{variant:"outline",className:"gap-1 text-primary",children:[" ",i(e.total_spent)]}),e.last_order_at&&n.jsxs(ke,{variant:"outline",className:"gap-1",children:[" ltima compra: ",a(e.last_order_at)]}),n.jsx(ke,{variant:t?"default":"secondary",className:"gap-1",children:t?" Quiz respondido":" Sem quiz"}),r&&n.jsx(ke,{variant:"outline",className:"gap-1",children:" Enviou prints"})]}),n.jsxs("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 rounded-full bg-secondary flex items-center justify-center shrink-0",children:n.jsx(Dn,{className:"h-8 w-8 text-muted-foreground"})}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h1",{className:"font-serif text-2xl",children:e.name||"Cliente sem nome"}),o?n.jsx(Sr,{className:"h-5 w-5 text-green-500"}):n.jsx(Sn,{className:"h-5 w-5 text-amber-500"})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-muted-foreground",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(kl,{className:"h-4 w-4"}),s(e.phone)]}),e.instagram&&n.jsxs("a",{href:`https://instagram.com/${e.instagram.replace("@","")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-primary hover:underline",children:[n.jsx(Dn,{className:"h-4 w-4"}),"@",e.instagram.replace("@","")]}),e.email&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(M6,{className:"h-4 w-4"}),e.email]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ns,{className:"h-4 w-4"}),"Desde ",a(e.created_at)]})]}),n.jsxs("div",{className:"flex flex-wrap gap-2 pt-1",children:[e.style_title&&n.jsxs(ke,{variant:"default",className:"gap-1",children:[" ",e.style_title]}),(e.size_letter||e.size_number)&&n.jsxs(ke,{variant:"secondary",children:["Tam. ",[e.size_letter,e.size_number].filter(Boolean).join(" / ")]})]}),n.jsx("p",{className:`text-xs ${o?"text-green-600":"text-amber-600"}`,children:l})]})]}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx(S_,{href:po(d,e.phone),variant:"primary",className:"w-auto"})})]})]})}function dM(e){const t=(e||"").replace(/\D/g,"").slice(0,11);return t.length===0?"":t.length<=3?t:t.length<=6?`${t.slice(0,3)}.${t.slice(3)}`:t.length<=9?`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6)}`:`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6,9)}-${t.slice(9)}`}function b2e({customer:e,onUpdate:t}){var f,m;const[r,s]=P.useState(!1),[a,i]=P.useState(!1),[o,l]=P.useState({name:e.name||"",email:e.email||"",instagram:e.instagram||"",document:((f=e.document)==null?void 0:f.replace(/\D/g,""))||""}),d=async()=>{i(!0);try{const p=o.document.replace(/\D/g,"");if(p&&p.length!==11){de.error("CPF deve ter 11 dgitos"),i(!1);return}const{error:g}=await le.from("customers").update({name:o.name||null,email:o.email||null,instagram:o.instagram||null,document:p||null}).eq("id",e.id);if(g)throw g;if(p){const{data:x}=await le.from("customer_addresses").select("id").eq("customer_id",e.id).eq("is_default",!0).maybeSingle();x&&await le.from("customer_addresses").update({document:p}).eq("id",x.id)}de.success("Dados atualizados!"),s(!1),t()}catch(p){console.error("Error updating customer:",p),de.error("Erro ao atualizar dados")}finally{i(!1)}},c=()=>{var p;l({name:e.name||"",email:e.email||"",instagram:e.instagram||"",document:((p=e.document)==null?void 0:p.replace(/\D/g,""))||""}),s(!1)},u=((m=e.document)==null?void 0:m.replace(/\D/g,""))||"",h=u.length===11;return n.jsxs($e,{children:[n.jsxs(Dt,{className:"flex flex-row items-center justify-between pb-2",children:[n.jsxs(Lt,{className:"text-lg flex items-center gap-2",children:[n.jsx(Dn,{className:"h-5 w-5 text-primary"}),"Dados do Cliente"]}),r?n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{variant:"ghost",size:"sm",onClick:c,children:[n.jsx(sn,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),n.jsxs(he,{size:"sm",onClick:d,disabled:a,children:[a?n.jsx(Et,{className:"h-4 w-4 animate-spin mr-1"}):n.jsx(uu,{className:"h-4 w-4 mr-1"}),"Salvar"]})]}):n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>s(!0),children:[n.jsx(Ql,{className:"h-4 w-4 mr-1"}),"Editar"]})]}),n.jsx(Fe,{className:"space-y-4",children:r?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"edit-name",children:"Nome"}),n.jsx(et,{id:"edit-name",value:o.name,onChange:p=>l({...o,name:p.target.value}),placeholder:"Nome completo"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"edit-email",children:"Email"}),n.jsx(et,{id:"edit-email",type:"email",value:o.email,onChange:p=>l({...o,email:p.target.value}),placeholder:"email@exemplo.com"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"edit-cpf",children:"CPF"}),n.jsx(et,{id:"edit-cpf",value:dM(o.document),onChange:p=>l({...o,document:p.target.value.replace(/\D/g,"").slice(0,11)}),placeholder:"000.000.000-00",maxLength:14}),o.document&&o.document.length>0&&o.document.length!==11&&n.jsxs("p",{className:"text-xs text-amber-600",children:["CPF deve ter 11 dgitos (",o.document.length,"/11)"]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"edit-instagram",children:"Instagram"}),n.jsx(et,{id:"edit-instagram",value:o.instagram,onChange:p=>l({...o,instagram:p.target.value}),placeholder:"@usuario"})]})]}):n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Dn,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-sm font-medium",children:"Nome:"}),n.jsx("span",{className:"text-sm",children:e.name||n.jsx("span",{className:"text-muted-foreground italic",children:"No informado"})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(kl,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-sm font-medium",children:"Telefone:"}),n.jsx("span",{className:"text-sm",children:mb(e.phone)})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(M6,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-sm font-medium",children:"Email:"}),n.jsx("span",{className:"text-sm",children:e.email||n.jsx("span",{className:"text-muted-foreground italic",children:"No informado"})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Kh,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-sm font-medium",children:"CPF:"}),h?n.jsx("span",{className:"text-sm font-mono",children:dM(u)}):n.jsx("span",{className:"text-sm text-muted-foreground italic",children:"No informado"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Dn,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-sm font-medium",children:"Instagram:"}),n.jsx("span",{className:"text-sm",children:e.instagram||n.jsx("span",{className:"text-muted-foreground italic",children:"No informado"})})]}),e.address_line&&n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(mo,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm font-medium",children:"Endereo:"}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.address_line,e.city&&`, ${e.city}`,e.state&&`/${e.state}`,e.zip_code&&` - CEP ${e.zip_code}`]})]})]})]})})]})}function w2e({customer:e,profileData:t,quizResponses:r,quizLink:s}){const a=r.length>0||!!e.style_title||!!(t!=null&&t.style_title),i=()=>{const o=`Oi ${e.name||""}!  Fizemos uma consultoria rpida no Provador VIP. Quer descobrir seu estilo e receber sugestes no seu tamanho? Responde em 2 min: ${s}`;navigator.clipboard.writeText(o),de.success("Mensagem copiada!")};return a?n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"text-lg flex items-center gap-2",children:[n.jsx(Gr,{className:"h-5 w-5 text-primary"}),"Perfil de Estilo"]})}),n.jsxs(Fe,{className:"space-y-4",children:[(t==null?void 0:t.quiz_points)&&n.jsxs("div",{className:"flex items-center gap-4 p-3 bg-primary/5 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Pontos VIP"}),n.jsxs("p",{className:"text-xl font-bold text-primary",children:[" ",t.quiz_points," pts"]})]}),t.quiz_level&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Nvel"}),n.jsxs("p",{className:"font-medium",children:["Nvel ",t.quiz_level]})]})]}),e.style_title&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Estilo Principal"}),n.jsxs(ke,{variant:"default",className:"text-base px-3 py-1",children:[" ",e.style_title]})]}),(e.size_letter||e.size_number)&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Tamanhos"}),n.jsxs("div",{className:"flex gap-2",children:[e.size_letter&&n.jsxs(ke,{variant:"secondary",children:["Letra: ",e.size_letter]}),e.size_number&&n.jsxs(ke,{variant:"secondary",children:["Nmero: ",e.size_number]})]})]}),(t==null?void 0:t.style_description)&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Descrio do Estilo"}),n.jsx("p",{className:"text-sm",children:t.style_description})]}),(t==null?void 0:t.color_palette)&&t.color_palette.length>0&&n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-muted-foreground mb-1 flex items-center gap-1",children:[n.jsx(n_,{className:"h-4 w-4"}),"Paleta de Cores"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:t.color_palette.map((o,l)=>n.jsx(ke,{variant:"outline",children:o},l))})]}),(t==null?void 0:t.avoid_items)&&t.avoid_items.length>0&&n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-muted-foreground mb-1 flex items-center gap-1",children:[n.jsx(qne,{className:"h-4 w-4"}),"No gosta / Evitar"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:t.avoid_items.map((o,l)=>n.jsx(ke,{variant:"destructive",className:"bg-red-100 text-red-700 hover:bg-red-100",children:o},l))})]}),(t==null?void 0:t.personal_tip)&&n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-muted-foreground mb-1 flex items-center gap-1",children:[n.jsx(r_,{className:"h-4 w-4"}),"Comentrio da cliente"]}),n.jsxs("p",{className:"text-sm italic bg-secondary/50 p-3 rounded-lg",children:['"',t.personal_tip,'"']})]}),r.length>0&&n.jsxs("div",{className:"pt-4 border-t",children:[n.jsx("p",{className:"text-sm font-medium mb-3",children:"Respostas do Quiz"}),n.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:r.map(o=>n.jsxs("div",{className:"text-sm",children:[n.jsxs("p",{className:"text-muted-foreground",children:[o.question_number,". ",o.question]}),n.jsx("p",{className:"font-medium text-primary",children:o.answer})]},o.id))})]})]})]}):n.jsx($e,{className:"border-amber-200 bg-amber-50/50",children:n.jsxs(Fe,{className:"py-8 text-center",children:[n.jsx(Gr,{className:"h-12 w-12 mx-auto mb-4 text-amber-500"}),n.jsx("h3",{className:"font-medium text-lg mb-2",children:"Cliente ainda no completou o Quiz"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Envie um convite personalizado para conhecer o estilo dela"}),n.jsxs(he,{onClick:i,variant:"outline",className:"gap-2",children:[n.jsx(Wa,{className:"h-4 w-4"}),"Copiar convite para Quiz"]})]})})}function _2e({orders:e}){const[t,r]=P.useState(new Set),s=c=>{r(u=>{const h=new Set(u);return h.has(c)?h.delete(c):h.add(c),h})},a=c=>new Date(c).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}),i=c=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c),o=c=>({pendente:{label:"Pendente",variant:"secondary"},aguardando_pagamento:{label:"Aguardando Pagamento",variant:"outline"},pago:{label:"Pago",variant:"default"},enviado:{label:"Enviado",variant:"default"},entregue:{label:"Entregue",variant:"default"},cancelado:{label:"Cancelado",variant:"destructive"}})[c]||{label:c,variant:"secondary"},l=c=>{switch(c){case"motoboy":return n.jsx(Zl,{className:"h-4 w-4"});case"pickup":return n.jsx(fa,{className:"h-4 w-4"});default:return n.jsx(yn,{className:"h-4 w-4"})}},d=(c,u)=>{switch(c){case"motoboy":return"Motoboy";case"pickup":return"Retirada na loja";default:return u||"Correios"}};return e.length===0?n.jsx($e,{children:n.jsxs(Fe,{className:"py-12 text-center text-muted-foreground",children:[n.jsx(hn,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhum pedido encontrado para esta cliente."})]})}):n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"text-lg flex items-center gap-2",children:[n.jsx(hn,{className:"h-5 w-5"}),"Histrico de Pedidos (",e.length,")"]})}),n.jsx(Fe,{className:"space-y-3",children:e.map(c=>{const u=t.has(c.id),h=o(c.status);return n.jsx(pg,{open:u,children:n.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[n.jsx(gg,{asChild:!0,children:n.jsxs("button",{onClick:()=>s(c.id),className:"w-full p-4 flex items-center justify-between hover:bg-muted/50 transition-colors text-left",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium",children:["#",c.id.slice(0,8).toUpperCase()]}),n.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[n.jsx(ns,{className:"h-3 w-3"}),a(c.created_at)]})]}),n.jsx(ke,{variant:h.variant,children:h.label})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-bold text-primary",children:i(c.total)}),n.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1 justify-end",children:[l(c.delivery_method),d(c.delivery_method,c.shipping_service)]})]}),u?n.jsx(ip,{className:"h-5 w-5 text-muted-foreground"}):n.jsx(zo,{className:"h-5 w-5 text-muted-foreground"})]})]})}),n.jsx(xg,{children:n.jsxs("div",{className:"border-t p-4 bg-muted/30 space-y-3",children:[c.items.map(f=>n.jsxs("div",{className:"flex items-center gap-3",children:[f.image_url?n.jsx("img",{src:f.image_url,alt:f.product_name,className:"w-12 h-12 object-cover rounded"}):n.jsx("div",{className:"w-12 h-12 bg-secondary rounded flex items-center justify-center",children:n.jsx(Vt,{className:"h-5 w-5 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-sm truncate",children:f.product_name}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[f.color&&`${f.color}  `,"Tam. ",f.size,"  Qtd. ",f.quantity]})]}),n.jsx("p",{className:"font-medium text-sm",children:i(f.product_price*f.quantity)})]},f.id)),c.tracking_code&&n.jsx("div",{className:"pt-2 border-t",children:n.jsxs("p",{className:"text-xs text-muted-foreground",children:["Cdigo de rastreio: ",n.jsx("span",{className:"font-mono font-medium",children:c.tracking_code})]})}),c.customer_notes&&n.jsxs("div",{className:"pt-2 border-t",children:[n.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-blue-700 mb-1",children:[n.jsx(nn,{className:"h-3 w-3"}),"Observao do cliente:"]}),n.jsx("div",{className:"text-xs bg-blue-50 border border-blue-200 rounded p-2",children:c.customer_notes})]}),c.customer_address&&n.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t",children:[n.jsx("p",{className:"font-medium",children:"Endereo:"}),n.jsx("p",{children:c.customer_address})]})]})})]})},c.id)})})]})}function j2e({prints:e,linkedProducts:t}){const[r,s]=P.useState(null),a=l=>{const{data:d}=le.storage.from("prints").getPublicUrl(l);return d.publicUrl},i=l=>new Date(l).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}),o=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l);return e.length===0?n.jsx($e,{children:n.jsxs(Fe,{className:"py-12 text-center text-muted-foreground",children:[n.jsx(ka,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhum print enviado por esta cliente."})]})}):n.jsxs(n.Fragment,{children:[n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"text-lg flex items-center gap-2",children:[n.jsx(ka,{className:"h-5 w-5"}),"Prints Enviados (",e.length,")"]})}),n.jsx(Fe,{children:n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:e.map(l=>{const d=l.linked_product_id?t[l.linked_product_id]:null;return n.jsxs("div",{className:"group relative cursor-pointer",onClick:()=>s(l),children:[n.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-secondary",children:n.jsx("img",{src:a(l.image_path),alt:"Print enviado",className:"w-full h-full object-cover group-hover:scale-105 transition-transform"})}),n.jsx(ke,{variant:d?"default":"secondary",className:"absolute top-2 right-2 text-xs",children:d?"Vinculado":"Pendente"}),n.jsxs("div",{className:"mt-2 space-y-1",children:[n.jsx("p",{className:"text-xs text-muted-foreground",children:i(l.created_at)}),l.size&&n.jsxs("p",{className:"text-xs",children:["Tam. ",l.size]}),d&&n.jsx("p",{className:"text-xs text-primary truncate font-medium",children:d.name})]})]},l.id)})})})]}),n.jsx(tn,{open:!!r,onOpenChange:()=>s(null),children:n.jsxs(Jr,{className:"max-w-2xl",children:[n.jsx(rn,{className:"sr-only",children:"Detalhes do Print"}),r&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"aspect-square max-h-[60vh] rounded-lg overflow-hidden bg-secondary",children:n.jsx("img",{src:a(r.image_path),alt:"Print enviado",className:"w-full h-full object-contain"})}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Enviado em ",i(r.created_at)]}),n.jsx(ke,{variant:r.linked_product_id?"default":"secondary",children:r.linked_product_id?"Produto vinculado":"Pendente de anlise"})]}),r.size&&n.jsxs("p",{className:"text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Tamanho:"})," ",r.size]}),r.preference&&n.jsxs("p",{className:"text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Preferncia:"})," ",r.preference==="ajustado"?"Mais ajustado":"Mais soltinho"]}),r.linked_product_id&&t[r.linked_product_id]&&n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg mt-3",children:[n.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Produto vinculado:"}),n.jsxs("div",{className:"flex items-center gap-3",children:[t[r.linked_product_id].image_url&&n.jsx("img",{src:t[r.linked_product_id].image_url,alt:t[r.linked_product_id].name,className:"w-12 h-12 object-cover rounded"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-sm",children:t[r.linked_product_id].name}),n.jsx("p",{className:"text-sm text-primary",children:o(t[r.linked_product_id].price)})]}),n.jsx(he,{variant:"outline",size:"sm",asChild:!0,children:n.jsxs("a",{href:`/produto/${r.linked_product_id}`,target:"_blank",rel:"noopener noreferrer",className:"gap-1",children:[n.jsx(Zs,{className:"h-4 w-4"}),"Ver"]})})]})]})]})]})]})})]})}function N2e({customer:e,quizLink:t,lastOrderId:r,lastOrderStatus:s}){const a=e.name||"",i=[e.size_letter,e.size_number].filter(Boolean).join(" / "),o=[{id:"quiz-invite",icon:n.jsx(Gr,{className:"h-4 w-4"}),title:"Convite para Quiz",description:"Enviar link do quiz de estilo",message:`Oi ${a}!  Fizemos uma consultoria rpida no Provador VIP. Quer descobrir seu estilo e receber sugestes no seu tamanho? Responde em 2 min: ${t}`},{id:"product-suggestion",icon:n.jsx(Vt,{className:"h-4 w-4"}),title:"Sugesto de Produto",description:"Avisar sobre pea nova",message:`Oi ${a}! Chegou uma pea que tem muito a ver com voc ${i?` No seu tamanho (${i}).`:""} Quer que eu te mostre? `},{id:"order-status",icon:n.jsx(yn,{className:"h-4 w-4"}),title:"Status do Pedido",description:"Atualizao de pedido",message:r?`Oi ${a}! Sobre o pedido #${r.slice(0,8).toUpperCase()}, ele est como: ${S2e(s||"pendente")}. Se quiser, posso te atualizar por aqui! `:`Oi ${a}! Sobre seu pedido, ele est em andamento. Se quiser, posso te atualizar por aqui! `}],l=(d,c)=>{navigator.clipboard.writeText(d),de.success(`${c} copiada!`)};return n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"text-lg flex items-center gap-2",children:[n.jsx(nn,{className:"h-5 w-5"}),"Mensagens Prontas"]})}),n.jsx(Fe,{className:"space-y-3",children:o.map(d=>n.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[n.jsx("div",{className:"p-2 bg-primary/10 rounded-lg text-primary",children:d.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-sm",children:d.title}),n.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:d.description}),n.jsx("p",{className:"text-sm text-muted-foreground bg-secondary/50 p-2 rounded text-ellipsis overflow-hidden",children:d.message.length>120?d.message.slice(0,120)+"...":d.message})]})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"shrink-0 gap-1",onClick:()=>l(d.message,d.title),children:[n.jsx(Wa,{className:"h-4 w-4"}),"Copiar"]})]})},d.id))})]})}function S2e(e){return{pendente:"Pendente",aguardando_pagamento:"Aguardando Pagamento",pago:"Pago ",enviado:"Enviado ",entregue:"Entregue ",cancelado:"Cancelado"}[e]||e}function C2e({customerId:e}){const[t,r]=P.useState([]),[s,a]=P.useState(!0);P.useEffect(()=>{i()},[e]);const i=async()=>{var c;a(!0);try{let{data:u,error:h}=await le.from("live_customers").select("id, live_event_id, whatsapp").eq("client_id",e);if(h)throw h;if(!u||u.length===0){const{data:g}=await le.from("customers").select("phone").eq("id",e).single(),x=(c=g==null?void 0:g.phone)==null?void 0:c.replace(/\D/g,"");if(x){const{data:v}=await le.from("live_customers").select("id, live_event_id, whatsapp").or(`whatsapp.ilike.%${x}%,whatsapp.ilike.%${x.slice(-8)}%`);u=v||[],u.length>0&&await le.from("live_customers").update({client_id:e}).in("id",u.map(y=>y.id))}}if(!u||u.length===0){r([]),a(!1);return}const f=u.map(g=>g.id),{data:m,error:p}=await le.from("live_carts").select(`
          id,
          status,
          subtotal,
          total,
          created_at,
          updated_at,
          live_event:live_events(id, titulo, data_hora_inicio, status),
          items:live_cart_items(
            id,
            qtd,
            preco_unitario,
            status,
            variante,
            product:product_catalog(id, name, image_url)
          )
        `).in("live_customer_id",f).order("created_at",{ascending:!1});if(p)throw p;r(m||[])}catch(u){console.error("Error loading live history:",u)}finally{a(!1)}},o=c=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c),l=c=>{switch(c){case"pago":return n.jsxs(ke,{className:"bg-green-500 text-white gap-1",children:[n.jsx(Sr,{className:"h-3 w-3"}),"Pago"]});case"cancelado":case"expirado":return n.jsxs(ke,{variant:"destructive",className:"gap-1",children:[n.jsx(Kn,{className:"h-3 w-3"}),c==="cancelado"?"Cancelado":"Expirado"]});case"aguardando_pagamento":return n.jsxs(ke,{className:"bg-amber-500 text-white gap-1",children:[n.jsx(Lr,{className:"h-3 w-3"}),"Aguardando Pagamento"]});default:return n.jsxs(ke,{variant:"secondary",className:"gap-1",children:[n.jsx(Ri,{className:"h-3 w-3"}),c==="aberto"?"Aberto":c]})}},d={totalLives:new Set(t.map(c=>{var u;return(u=c.live_event)==null?void 0:u.id})).size,totalCarts:t.length,paid:t.filter(c=>c.status==="pago").length,cancelled:t.filter(c=>["cancelado","expirado"].includes(c.status)).length,pending:t.filter(c=>!["pago","cancelado","expirado"].includes(c.status)).length,totalPaid:t.filter(c=>c.status==="pago").reduce((c,u)=>c+u.total,0),totalReserved:t.reduce((c,u)=>c+u.total,0)};return s?n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Ss,{className:"h-5 w-5"}),"Histrico de Lives"]})}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsx(Wr,{className:"h-20 w-full"}),n.jsx(Wr,{className:"h-20 w-full"})]})]}):t.length===0?n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Ss,{className:"h-5 w-5"}),"Histrico de Lives"]})}),n.jsx(Fe,{children:n.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Esta cliente ainda no participou de nenhuma live."})})]}):n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Ss,{className:"h-5 w-5"}),"Histrico de Lives"]})}),n.jsxs(Fe,{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold",children:d.totalLives}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Lives participadas"})]}),n.jsxs("div",{className:"p-3 bg-green-50 rounded-lg text-center border border-green-200",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.paid}),n.jsx("div",{className:"text-xs text-green-600",children:"Carrinhos pagos"})]}),n.jsxs("div",{className:"p-3 bg-red-50 rounded-lg text-center border border-red-200",children:[n.jsx("div",{className:"text-2xl font-bold text-red-600",children:d.cancelled}),n.jsx("div",{className:"text-xs text-red-600",children:"Cancelados/Expirados"})]}),n.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg text-center border border-amber-200",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:d.pending}),n.jsx("div",{className:"text-xs text-amber-600",children:"Pendentes"})]})]}),n.jsxs("div",{className:"flex gap-4 p-4 bg-gradient-to-r from-primary/10 to-primary/5 rounded-lg",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Reservado"}),n.jsx("div",{className:"text-xl font-bold",children:o(d.totalReserved)})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Pago"}),n.jsx("div",{className:"text-xl font-bold text-green-600",children:o(d.totalPaid)})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Taxa de Converso"}),n.jsx("div",{className:"text-xl font-bold",children:d.totalCarts>0?`${Math.round(d.paid/d.totalCarts*100)}%`:""})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Carrinhos"}),t.map(c=>{var u,h,f;return n.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ss,{className:"h-4 w-4 text-primary"}),n.jsx("span",{className:"font-medium",children:((u=c.live_event)==null?void 0:u.titulo)||"Live"})]}),n.jsx("div",{className:"text-sm text-muted-foreground",children:(h=c.live_event)!=null&&h.data_hora_inicio?Wt(new Date(c.live_event.data_hora_inicio),"dd/MM/yyyy 's' HH:mm",{locale:mr}):Wt(new Date(c.created_at),"dd/MM/yyyy 's' HH:mm",{locale:mr})})]}),n.jsxs("div",{className:"text-right",children:[l(c.status),n.jsx("div",{className:"text-lg font-bold mt-1",children:o(c.total)})]})]}),n.jsxs("div",{className:"space-y-2",children:[(c.items||[]).slice(0,3).map(m=>{var p,g,x,v;return n.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[n.jsx("div",{className:"w-10 h-10 bg-muted rounded overflow-hidden shrink-0",children:(p=m.product)!=null&&p.image_url?n.jsx("img",{src:m.product.image_url,alt:m.product.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ri,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"truncate",children:((g=m.product)==null?void 0:g.name)||"Produto"}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[((x=m.variante)==null?void 0:x.tamanho)&&`Tam: ${m.variante.tamanho}`,((v=m.variante)==null?void 0:v.cor)&&`  ${m.variante.cor}`,`  Qtd: ${m.qtd}`]})]}),n.jsx("div",{className:"text-right shrink-0",children:o(m.preco_unitario*m.qtd)})]},m.id)}),(((f=c.items)==null?void 0:f.length)||0)>3&&n.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:["+ ",c.items.length-3," outros itens"]})]})]},c.id)})]})]})]})}function E2e({customerId:e,customerPhone:t}){const[r,s]=P.useState([]),[a,i]=P.useState(!0),[o,l]=P.useState("all");P.useEffect(()=>{d()},[e,t]);const d=async()=>{i(!0);try{const g=t==null?void 0:t.replace(/\D/g,""),{data:x}=await le.from("orders").select(`
          id,
          status,
          total,
          created_at,
          live_event_id,
          items:order_items(
            id,
            product_name,
            product_price,
            quantity,
            size,
            color,
            image_url
          )
        `).eq("customer_id",e).order("created_at",{ascending:!1});let v=[];if(g){const{data:q}=await le.from("orders").select(`
            id,
            customer_phone,
            status,
            total,
            created_at,
            live_event_id,
            items:order_items(
              id,
              product_name,
              product_price,
              quantity,
              size,
              color,
              image_url
            )
          `).is("customer_id",null).order("created_at",{ascending:!1});v=(q||[]).filter(Y=>{var F;const G=(F=Y.customer_phone)==null?void 0:F.replace(/\D/g,"");if(!G||!g)return!1;if(G===g)return!0;const I=S=>S.startsWith("55")?S.slice(2):S;return I(G)===I(g)})}const y=[...x||[],...v],b=new Set,j=y.filter(q=>b.has(q.id)?!1:(b.add(q.id),!0)),{data:T}=await le.from("live_customers").select("id, live_event_id").eq("client_id",e);let O=[];if(T&&T.length>0){const q=T.map(G=>G.id),{data:Y}=await le.from("live_carts").select(`
            id,
            status,
            total,
            created_at,
            order_id,
            live_event:live_events(id, titulo),
            items:live_cart_items(
              id,
              qtd,
              preco_unitario,
              status,
              variante,
              product:product_catalog(id, name, image_url, color)
            )
          `).in("live_customer_id",q).order("created_at",{ascending:!1});O=(Y||[]).filter(G=>!G.order_id)}const R=j.map(q=>({id:q.id,type:q.live_event_id?"live":"regular",status:q.status,total:q.total,created_at:q.created_at,source_name:q.live_event_id?"Pedido de Live":"Loja Online",items:(q.items||[]).map(Y=>({id:Y.id,product_name:Y.product_name,product_price:Y.product_price,quantity:Y.quantity,size:Y.size,color:Y.color,image_url:Y.image_url}))})),D=O.map(q=>{var Y;return{id:q.id,type:"live",status:q.status,total:q.total,created_at:q.created_at,source_name:((Y=q.live_event)==null?void 0:Y.titulo)||"Live",items:(q.items||[]).map(G=>{var I,F,S,E,N;return{id:G.id,product_name:((I=G.product)==null?void 0:I.name)||"Produto",product_price:G.preco_unitario,quantity:G.qtd,size:((F=G.variante)==null?void 0:F.tamanho)||"",color:((S=G.product)==null?void 0:S.color)||((E=G.variante)==null?void 0:E.cor)||null,image_url:((N=G.product)==null?void 0:N.image_url)||null}})}}),B=[...R,...D].sort((q,Y)=>new Date(Y.created_at).getTime()-new Date(q.created_at).getTime());s(B)}catch(g){console.error("Error loading sales data:",g)}finally{i(!1)}},c=P.useMemo(()=>{if(o==="all")return r;const g=new Date;let x;switch(o){case"30d":x=new Date(g.getTime()-30*24*60*60*1e3);break;case"90d":x=new Date(g.getTime()-90*24*60*60*1e3);break;case"1y":x=new Date(g.getTime()-365*24*60*60*1e3);break;default:return r}return r.filter(v=>new Date(v.created_at)>=x)},[r,o]),u=P.useMemo(()=>{const g=["pago","entregue","enviado"],x=c.filter(T=>g.includes(T.status)),v=c.filter(T=>T.type==="live"),y=c.filter(T=>T.type==="regular"),b=v.filter(T=>g.includes(T.status)),j=y.filter(T=>g.includes(T.status));return{totalOrders:c.length,paidOrders:x.length,cancelledOrders:c.filter(T=>["cancelado","expirado"].includes(T.status)).length,pendingOrders:c.filter(T=>!g.includes(T.status)&&!["cancelado","expirado"].includes(T.status)).length,totalRevenue:x.reduce((T,O)=>T+O.total,0),avgTicket:x.length>0?x.reduce((T,O)=>T+O.total,0)/x.length:0,liveRevenue:b.reduce((T,O)=>T+O.total,0),regularRevenue:j.reduce((T,O)=>T+O.total,0),liveCount:v.length,regularCount:y.length,conversionRate:c.length>0?x.length/c.length*100:0}},[c]),h=P.useMemo(()=>{const g={},x=["pago","entregue","enviado"];return c.filter(v=>x.includes(v.status)).forEach(v=>{v.items.forEach(y=>{const b=y.product_name;g[b]||(g[b]={name:y.product_name,qty:0,revenue:0,image_url:y.image_url}),g[b].qty+=y.quantity,g[b].revenue+=y.product_price*y.quantity})}),Object.values(g).sort((v,y)=>y.qty-v.qty).slice(0,5)},[c]),f=g=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(g),m=g=>{switch(g){case"pago":case"entregue":case"enviado":return n.jsxs(ke,{className:"bg-green-500 text-white gap-1",children:[n.jsx(Sr,{className:"h-3 w-3"}),g==="pago"?"Pago":g==="enviado"?"Enviado":"Entregue"]});case"cancelado":case"expirado":return n.jsxs(ke,{variant:"destructive",className:"gap-1",children:[n.jsx(Kn,{className:"h-3 w-3"}),g==="cancelado"?"Cancelado":"Expirado"]});case"aguardando_pagamento":return n.jsxs(ke,{className:"bg-amber-500 text-white gap-1",children:[n.jsx(Lr,{className:"h-3 w-3"}),"Aguardando"]});default:return n.jsx(ke,{variant:"secondary",className:"gap-1",children:g==="pendente"?"Pendente":g})}},p=()=>{const g=["Data","Tipo","Origem","Status","Total","Itens"],x=c.map(j=>[Wt(new Date(j.created_at),"dd/MM/yyyy HH:mm"),j.type==="live"?"Live":"Loja",j.source_name,j.status,j.total.toFixed(2),j.items.map(T=>`${T.product_name} x${T.quantity}`).join("; ")]),v=[g,...x].map(j=>j.map(T=>`"${T}"`).join(",")).join(`
`),y=new Blob([v],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a");b.href=URL.createObjectURL(y),b.download=`vendas-cliente-${e.slice(0,8)}.csv`,b.click()};return a?n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(fc,{className:"h-5 w-5"}),"Relatrio de Vendas"]})}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsx(Wr,{className:"h-24 w-full"}),n.jsx(Wr,{className:"h-40 w-full"})]})]}):n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(fc,{className:"h-5 w-5"}),"Relatrio de Vendas Consolidado"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Xt,{value:o,onValueChange:l,children:[n.jsx(Ht,{className:"w-[140px]",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todo perodo"}),n.jsx(qe,{value:"30d",children:"ltimos 30 dias"}),n.jsx(qe,{value:"90d",children:"ltimos 90 dias"}),n.jsx(qe,{value:"1y",children:"ltimo ano"})]})]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:p,children:[n.jsx(vf,{className:"h-4 w-4 mr-1"}),"CSV"]})]})]})}),n.jsxs(Fe,{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"p-4 bg-gradient-to-br from-primary/10 to-primary/5 rounded-lg",children:[n.jsx("div",{className:"text-3xl font-bold",children:u.paidOrders}),n.jsx("div",{className:"text-sm text-muted-foreground",children:"Pedidos Pagos"})]}),n.jsxs("div",{className:"p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg border border-green-200",children:[n.jsx("div",{className:"text-3xl font-bold text-green-600",children:f(u.totalRevenue)}),n.jsx("div",{className:"text-sm text-green-600",children:"Receita Total"})]}),n.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[n.jsx("div",{className:"text-3xl font-bold",children:f(u.avgTicket)}),n.jsx("div",{className:"text-sm text-muted-foreground",children:"Ticket Mdio"})]}),n.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[n.jsxs("div",{className:"text-3xl font-bold",children:[u.conversionRate.toFixed(0),"%"]}),n.jsx("div",{className:"text-sm text-muted-foreground",children:"Converso"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"p-4 border rounded-lg space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[n.jsx(Ss,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm font-medium",children:"Lives"})]}),n.jsxs("div",{className:"flex justify-between items-end",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:u.liveCount}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"pedidos"})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-lg font-semibold text-green-600",children:f(u.liveRevenue)}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"receita"})]})]})]}),n.jsxs("div",{className:"p-4 border rounded-lg space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[n.jsx(hn,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm font-medium",children:"Loja Online"})]}),n.jsxs("div",{className:"flex justify-between items-end",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:u.regularCount}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"pedidos"})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-lg font-semibold text-green-600",children:f(u.regularRevenue)}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"receita"})]})]})]})]}),h.length>0&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h4",{className:"font-medium text-sm text-muted-foreground flex items-center gap-2",children:[n.jsx(Vs,{className:"h-4 w-4"}),"Produtos Mais Comprados"]}),n.jsx("div",{className:"space-y-2",children:h.map((g,x)=>n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-muted/30 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-primary/10 rounded-full text-sm font-bold",children:x+1}),n.jsx("div",{className:"w-10 h-10 bg-muted rounded overflow-hidden shrink-0",children:g.image_url?n.jsx("img",{src:g.image_url,alt:"",className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium truncate",children:g.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[g.qty,"x comprado"]})]}),n.jsx("div",{className:"text-right shrink-0",children:n.jsx("div",{className:"font-medium",children:f(g.revenue)})})]},g.name))})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h4",{className:"font-medium text-sm text-muted-foreground flex items-center gap-2",children:[n.jsx(ns,{className:"h-4 w-4"}),"Histrico Completo (",c.length,")"]}),c.length===0?n.jsx("p",{className:"text-center py-6 text-muted-foreground",children:"Nenhum pedido encontrado no perodo selecionado."}):n.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2",children:c.map(g=>n.jsxs("div",{className:"border rounded-lg p-3 space-y-2 hover:bg-muted/30 transition-colors",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[g.type==="live"?n.jsx(Ss,{className:"h-4 w-4 text-purple-500"}):n.jsx(hn,{className:"h-4 w-4 text-blue-500"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-sm",children:g.source_name}),n.jsx("div",{className:"text-xs text-muted-foreground",children:Wt(new Date(g.created_at),"dd/MM/yyyy 's' HH:mm",{locale:mr})})]})]}),n.jsxs("div",{className:"text-right",children:[m(g.status),n.jsx("div",{className:"font-bold mt-1",children:f(g.total)})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[g.items.slice(0,3).map(x=>n.jsxs(ke,{variant:"outline",className:"text-xs font-normal",children:[x.product_name," x",x.quantity]},x.id)),g.items.length>3&&n.jsxs(ke,{variant:"outline",className:"text-xs font-normal",children:["+",g.items.length-3]})]})]},g.id))})]})]})]})}function k2e({photos:e,onPhotosUpdate:t}){const[r,s]=P.useState(null),[a,i]=P.useState(!1),[o,l]=P.useState(""),[d,c]=P.useState(!1),u=p=>new Date(p).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit"}),h=async(p,g)=>{g.stopPropagation();try{const{error:x}=await le.from("customer_inspiration_photos").update({is_starred:!p.is_starred}).eq("id",p.id);if(x)throw x;t()}catch(x){console.error("Error updating star:",x),de.error("Erro ao atualizar")}},f=async()=>{if(r){c(!0);try{const{error:p}=await le.from("customer_inspiration_photos").update({merchant_notes:o}).eq("id",r.id);if(p)throw p;i(!1),t(),de.success("Anotao salva!")}catch(p){console.error("Error saving notes:",p),de.error("Erro ao salvar anotao")}finally{c(!1)}}},m=p=>{s(p),l(p.merchant_notes||""),i(!1)};return e.length===0?n.jsx($e,{children:n.jsxs(Fe,{className:"py-12 text-center text-muted-foreground",children:[n.jsx(ka,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhuma foto de inspirao enviada."}),n.jsx("p",{className:"text-sm mt-1",children:"Fotos enviadas no quiz aparecero aqui."})]})}):n.jsxs(n.Fragment,{children:[n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"text-lg flex items-center gap-2",children:[n.jsx(ka,{className:"h-5 w-5"}),"Inspiraes enviadas (",e.length,")"]})}),n.jsx(Fe,{children:n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:e.map(p=>n.jsxs("div",{className:"group relative cursor-pointer",onClick:()=>m(p),children:[n.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-secondary",children:n.jsx("img",{src:p.image_url,alt:"Inspirao",className:"w-full h-full object-cover group-hover:scale-105 transition-transform"})}),n.jsx("button",{onClick:g=>h(p,g),className:`absolute top-2 right-2 p-1.5 rounded-full transition-colors ${p.is_starred?"bg-yellow-400 text-yellow-900":"bg-white/80 text-muted-foreground hover:bg-white"}`,children:n.jsx(wi,{className:"h-3.5 w-3.5",fill:p.is_starred?"currentColor":"none"})}),p.merchant_notes&&n.jsxs(ke,{variant:"secondary",className:"absolute bottom-2 left-2 text-xs gap-1 bg-white/90",children:[n.jsx(Js,{className:"h-2.5 w-2.5"}),"Nota"]}),n.jsx(ke,{variant:"outline",className:"absolute top-2 left-2 text-xs bg-white/90",children:p.source==="quiz"?"Quiz":p.source==="mission"?"Misso":"Upload"})]},p.id))})})]}),n.jsx(tn,{open:!!r,onOpenChange:()=>s(null),children:n.jsxs(Jr,{className:"max-w-2xl",children:[n.jsx(rn,{className:"sr-only",children:"Detalhes da foto"}),r&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:r.image_url,alt:"Inspirao",className:"w-full max-h-[60vh] object-contain rounded-lg bg-secondary"}),n.jsx("button",{onClick:p=>h(r,p),className:`absolute top-4 right-4 p-2 rounded-full transition-colors ${r.is_starred?"bg-yellow-400 text-yellow-900":"bg-white/80 text-muted-foreground hover:bg-white"}`,children:n.jsx(wi,{className:"h-5 w-5",fill:r.is_starred?"currentColor":"none"})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ke,{variant:"outline",children:r.source==="quiz"?"Quiz":r.source==="mission"?"Misso":"Upload"}),n.jsx("span",{className:"text-sm text-muted-foreground",children:u(r.created_at)})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"text-sm font-medium",children:"Anotao do lojista"}),!a&&n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>i(!0),children:[n.jsx(Js,{className:"h-4 w-4 mr-1"}),"Editar"]})]}),a?n.jsxs("div",{className:"space-y-2",children:[n.jsx(rs,{value:o,onChange:p=>l(p.target.value),placeholder:"Adicione uma anotao sobre esta foto...",rows:3}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>{i(!1),l(r.merchant_notes||"")},children:[n.jsx(sn,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),n.jsxs(he,{size:"sm",onClick:f,disabled:d,children:[d?n.jsx(Et,{className:"h-4 w-4 animate-spin mr-1"}):n.jsx(gn,{className:"h-4 w-4 mr-1"}),"Salvar"]})]})]}):n.jsx("p",{className:"text-sm text-muted-foreground bg-secondary/50 rounded-lg p-3",children:r.merchant_notes||"Nenhuma anotao adicionada."})]})]})]})})]})}var EC=["Enter"," "],A2e=["ArrowDown","PageUp","Home"],nG=["ArrowUp","PageDown","End"],T2e=[...A2e,...nG],P2e={ltr:[...EC,"ArrowRight"],rtl:[...EC,"ArrowLeft"]},O2e={ltr:["ArrowLeft"],rtl:["ArrowRight"]},p1="Menu",[Xx,R2e,M2e]=J2(p1),[jf,sG]=ea(p1,[M2e,bc,fg]),V_=bc(),aG=fg(),[I2e,Nf]=jf(p1),[D2e,g1]=jf(p1),iG=e=>{const{__scopeMenu:t,open:r=!1,children:s,dir:a,onOpenChange:i,modal:o=!0}=e,l=V_(t),[d,c]=P.useState(null),u=P.useRef(!1),h=Us(i),f=hg(a);return P.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),n.jsx(Yv,{...l,children:n.jsx(I2e,{scope:t,open:r,onOpenChange:h,content:d,onContentChange:c,children:n.jsx(D2e,{scope:t,onClose:P.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:u,dir:f,modal:o,children:s})})})};iG.displayName=p1;var L2e="MenuAnchor",s8=P.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e,a=V_(r);return n.jsx(ng,{...a,...s,ref:t})});s8.displayName=L2e;var a8="MenuPortal",[B2e,oG]=jf(a8,{forceMount:void 0}),lG=e=>{const{__scopeMenu:t,forceMount:r,children:s,container:a}=e,i=Nf(a8,t);return n.jsx(B2e,{scope:t,forceMount:r,children:n.jsx(Ws,{present:r||i.open,children:n.jsx(Qp,{asChild:!0,container:a,children:s})})})};lG.displayName=a8;var Do="MenuContent",[$2e,i8]=jf(Do),cG=P.forwardRef((e,t)=>{const r=oG(Do,e.__scopeMenu),{forceMount:s=r.forceMount,...a}=e,i=Nf(Do,e.__scopeMenu),o=g1(Do,e.__scopeMenu);return n.jsx(Xx.Provider,{scope:e.__scopeMenu,children:n.jsx(Ws,{present:s||i.open,children:n.jsx(Xx.Slot,{scope:e.__scopeMenu,children:o.modal?n.jsx(F2e,{...a,ref:t}):n.jsx(z2e,{...a,ref:t})})})})}),F2e=P.forwardRef((e,t)=>{const r=Nf(Do,e.__scopeMenu),s=P.useRef(null),a=Rr(t,s);return P.useEffect(()=>{const i=s.current;if(i)return y_(i)},[]),n.jsx(o8,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Tt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),z2e=P.forwardRef((e,t)=>{const r=Nf(Do,e.__scopeMenu);return n.jsx(o8,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),U2e=yu("MenuContent.ScrollLock"),o8=P.forwardRef((e,t)=>{const{__scopeMenu:r,loop:s=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:d,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:m,disableOutsideScroll:p,...g}=e,x=Nf(Do,r),v=g1(Do,r),y=V_(r),b=aG(r),j=R2e(r),[T,O]=P.useState(null),R=P.useRef(null),D=Rr(t,R,x.onContentChange),B=P.useRef(0),q=P.useRef(""),Y=P.useRef(0),G=P.useRef(null),I=P.useRef("right"),F=P.useRef(0),S=p?t1:P.Fragment,E=p?{as:U2e,allowPinchZoom:!0}:void 0,N=k=>{var J,V;const M=q.current+k,U=j().filter(H=>!H.disabled),$=document.activeElement,X=(J=U.find(H=>H.ref.current===$))==null?void 0:J.textValue,Z=U.map(H=>H.textValue),re=e_e(Z,M,X),W=(V=U.find(H=>H.textValue===re))==null?void 0:V.ref.current;(function H(ee){q.current=ee,window.clearTimeout(B.current),ee!==""&&(B.current=window.setTimeout(()=>H(""),1e3))})(M),W&&setTimeout(()=>W.focus())};P.useEffect(()=>()=>window.clearTimeout(B.current),[]),x_();const C=P.useCallback(k=>{var U,$;return I.current===((U=G.current)==null?void 0:U.side)&&r_e(k,($=G.current)==null?void 0:$.area)},[]);return n.jsx($2e,{scope:r,searchRef:q,onItemEnter:P.useCallback(k=>{C(k)&&k.preventDefault()},[C]),onItemLeave:P.useCallback(k=>{var M;C(k)||((M=R.current)==null||M.focus(),O(null))},[C]),onTriggerLeave:P.useCallback(k=>{C(k)&&k.preventDefault()},[C]),pointerGraceTimerRef:Y,onPointerGraceIntentChange:P.useCallback(k=>{G.current=k},[]),children:n.jsx(S,{...E,children:n.jsx(e1,{asChild:!0,trapped:a,onMountAutoFocus:Tt(i,k=>{var M;k.preventDefault(),(M=R.current)==null||M.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:n.jsx(Ou,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:m,children:n.jsx(yk,{asChild:!0,...b,dir:v.dir,orientation:"vertical",loop:s,currentTabStopId:T,onCurrentTabStopIdChange:O,onEntryFocus:Tt(d,k=>{v.isUsingKeyboardRef.current||k.preventDefault()}),preventScrollOnEntryFocus:!0,children:n.jsx(Zv,{role:"menu","aria-orientation":"vertical","data-state":SG(x.open),"data-radix-menu-content":"",dir:v.dir,...y,...g,ref:D,style:{outline:"none",...g.style},onKeyDown:Tt(g.onKeyDown,k=>{const U=k.target.closest("[data-radix-menu-content]")===k.currentTarget,$=k.ctrlKey||k.altKey||k.metaKey,X=k.key.length===1;U&&(k.key==="Tab"&&k.preventDefault(),!$&&X&&N(k.key));const Z=R.current;if(k.target!==Z||!T2e.includes(k.key))return;k.preventDefault();const W=j().filter(J=>!J.disabled).map(J=>J.ref.current);nG.includes(k.key)&&W.reverse(),Q2e(W)}),onBlur:Tt(e.onBlur,k=>{k.currentTarget.contains(k.target)||(window.clearTimeout(B.current),q.current="")}),onPointerMove:Tt(e.onPointerMove,Yx(k=>{const M=k.target,U=F.current!==k.clientX;if(k.currentTarget.contains(M)&&U){const $=k.clientX>F.current?"right":"left";I.current=$,F.current=k.clientX}}))})})})})})})});cG.displayName=Do;var V2e="MenuGroup",l8=P.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e;return n.jsx(er.div,{role:"group",...s,ref:t})});l8.displayName=V2e;var q2e="MenuLabel",dG=P.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e;return n.jsx(er.div,{...s,ref:t})});dG.displayName=q2e;var _w="MenuItem",uM="menu.itemSelect",q_=P.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:s,...a}=e,i=P.useRef(null),o=g1(_w,e.__scopeMenu),l=i8(_w,e.__scopeMenu),d=Rr(t,i),c=P.useRef(!1),u=()=>{const h=i.current;if(!r&&h){const f=new CustomEvent(uM,{bubbles:!0,cancelable:!0});h.addEventListener(uM,m=>s==null?void 0:s(m),{once:!0}),C6(h,f),f.defaultPrevented?c.current=!1:o.onClose()}};return n.jsx(uG,{...a,ref:d,disabled:r,onClick:Tt(e.onClick,u),onPointerDown:h=>{var f;(f=e.onPointerDown)==null||f.call(e,h),c.current=!0},onPointerUp:Tt(e.onPointerUp,h=>{var f;c.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:Tt(e.onKeyDown,h=>{const f=l.searchRef.current!=="";r||f&&h.key===" "||EC.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});q_.displayName=_w;var uG=P.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:s=!1,textValue:a,...i}=e,o=i8(_w,r),l=aG(r),d=P.useRef(null),c=Rr(t,d),[u,h]=P.useState(!1),[f,m]=P.useState("");return P.useEffect(()=>{const p=d.current;p&&m((p.textContent??"").trim())},[i.children]),n.jsx(Xx.ItemSlot,{scope:r,disabled:s,textValue:a??f,children:n.jsx(bk,{asChild:!0,...l,focusable:!s,children:n.jsx(er.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:c,onPointerMove:Tt(e.onPointerMove,Yx(p=>{s?o.onItemLeave(p):(o.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Tt(e.onPointerLeave,Yx(p=>o.onItemLeave(p))),onFocus:Tt(e.onFocus,()=>h(!0)),onBlur:Tt(e.onBlur,()=>h(!1))})})})}),W2e="MenuCheckboxItem",hG=P.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:s,...a}=e;return n.jsx(xG,{scope:e.__scopeMenu,checked:r,children:n.jsx(q_,{role:"menuitemcheckbox","aria-checked":jw(r)?"mixed":r,...a,ref:t,"data-state":d8(r),onSelect:Tt(a.onSelect,()=>s==null?void 0:s(jw(r)?!0:!r),{checkForDefaultPrevented:!1})})})});hG.displayName=W2e;var fG="MenuRadioGroup",[H2e,G2e]=jf(fG,{value:void 0,onValueChange:()=>{}}),mG=P.forwardRef((e,t)=>{const{value:r,onValueChange:s,...a}=e,i=Us(s);return n.jsx(H2e,{scope:e.__scopeMenu,value:r,onValueChange:i,children:n.jsx(l8,{...a,ref:t})})});mG.displayName=fG;var pG="MenuRadioItem",gG=P.forwardRef((e,t)=>{const{value:r,...s}=e,a=G2e(pG,e.__scopeMenu),i=r===a.value;return n.jsx(xG,{scope:e.__scopeMenu,checked:i,children:n.jsx(q_,{role:"menuitemradio","aria-checked":i,...s,ref:t,"data-state":d8(i),onSelect:Tt(s.onSelect,()=>{var o;return(o=a.onValueChange)==null?void 0:o.call(a,r)},{checkForDefaultPrevented:!1})})})});gG.displayName=pG;var c8="MenuItemIndicator",[xG,K2e]=jf(c8,{checked:!1}),vG=P.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:s,...a}=e,i=K2e(c8,r);return n.jsx(Ws,{present:s||jw(i.checked)||i.checked===!0,children:n.jsx(er.span,{...a,ref:t,"data-state":d8(i.checked)})})});vG.displayName=c8;var X2e="MenuSeparator",yG=P.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e;return n.jsx(er.div,{role:"separator","aria-orientation":"horizontal",...s,ref:t})});yG.displayName=X2e;var Y2e="MenuArrow",bG=P.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e,a=V_(r);return n.jsx(Qv,{...a,...s,ref:t})});bG.displayName=Y2e;var Z2e="MenuSub",[iQe,wG]=jf(Z2e),P0="MenuSubTrigger",_G=P.forwardRef((e,t)=>{const r=Nf(P0,e.__scopeMenu),s=g1(P0,e.__scopeMenu),a=wG(P0,e.__scopeMenu),i=i8(P0,e.__scopeMenu),o=P.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:d}=i,c={__scopeMenu:e.__scopeMenu},u=P.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return P.useEffect(()=>u,[u]),P.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),d(null)}},[l,d]),n.jsx(s8,{asChild:!0,...c,children:n.jsx(uG,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":SG(r.open),...e,ref:Jc(t,a.onTriggerChange),onClick:h=>{var f;(f=e.onClick)==null||f.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Tt(e.onPointerMove,Yx(h=>{i.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!r.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:Tt(e.onPointerLeave,Yx(h=>{var m,p;u();const f=(m=r.content)==null?void 0:m.getBoundingClientRect();if(f){const g=(p=r.content)==null?void 0:p.dataset.side,x=g==="right",v=x?-5:5,y=f[x?"left":"right"],b=f[x?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+v,y:h.clientY},{x:y,y:f.top},{x:b,y:f.top},{x:b,y:f.bottom},{x:y,y:f.bottom}],side:g}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Tt(e.onKeyDown,h=>{var m;const f=i.searchRef.current!=="";e.disabled||f&&h.key===" "||P2e[s.dir].includes(h.key)&&(r.onOpenChange(!0),(m=r.content)==null||m.focus(),h.preventDefault())})})})});_G.displayName=P0;var jG="MenuSubContent",NG=P.forwardRef((e,t)=>{const r=oG(Do,e.__scopeMenu),{forceMount:s=r.forceMount,...a}=e,i=Nf(Do,e.__scopeMenu),o=g1(Do,e.__scopeMenu),l=wG(jG,e.__scopeMenu),d=P.useRef(null),c=Rr(t,d);return n.jsx(Xx.Provider,{scope:e.__scopeMenu,children:n.jsx(Ws,{present:s||i.open,children:n.jsx(Xx.Slot,{scope:e.__scopeMenu,children:n.jsx(o8,{id:l.contentId,"aria-labelledby":l.triggerId,...a,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var h;o.isUsingKeyboardRef.current&&((h=d.current)==null||h.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Tt(e.onFocusOutside,u=>{u.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Tt(e.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:Tt(e.onKeyDown,u=>{var m;const h=u.currentTarget.contains(u.target),f=O2e[o.dir].includes(u.key);h&&f&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),u.preventDefault())})})})})})});NG.displayName=jG;function SG(e){return e?"open":"closed"}function jw(e){return e==="indeterminate"}function d8(e){return jw(e)?"indeterminate":e?"checked":"unchecked"}function Q2e(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function J2e(e,t){return e.map((r,s)=>e[(t+s)%e.length])}function e_e(e,t,r){const a=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=J2e(e,Math.max(i,0));a.length===1&&(o=o.filter(c=>c!==r));const d=o.find(c=>c.toLowerCase().startsWith(a.toLowerCase()));return d!==r?d:void 0}function t_e(e,t){const{x:r,y:s}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],d=t[o],c=l.x,u=l.y,h=d.x,f=d.y;u>s!=f>s&&r<(h-c)*(s-u)/(f-u)+c&&(a=!a)}return a}function r_e(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return t_e(r,t)}function Yx(e){return t=>t.pointerType==="mouse"?e(t):void 0}var n_e=iG,s_e=s8,a_e=lG,i_e=cG,o_e=l8,l_e=dG,c_e=q_,d_e=hG,u_e=mG,h_e=gG,f_e=vG,m_e=yG,p_e=bG,g_e=_G,x_e=NG,W_="DropdownMenu",[v_e,oQe]=ea(W_,[sG]),Ci=sG(),[y_e,CG]=v_e(W_),EG=e=>{const{__scopeDropdownMenu:t,children:r,dir:s,open:a,defaultOpen:i,onOpenChange:o,modal:l=!0}=e,d=Ci(t),c=P.useRef(null),[u,h]=Ui({prop:a,defaultProp:i??!1,onChange:o,caller:W_});return n.jsx(y_e,{scope:t,triggerId:pa(),triggerRef:c,contentId:pa(),open:u,onOpenChange:h,onOpenToggle:P.useCallback(()=>h(f=>!f),[h]),modal:l,children:n.jsx(n_e,{...d,open:u,onOpenChange:h,dir:s,modal:l,children:r})})};EG.displayName=W_;var kG="DropdownMenuTrigger",AG=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:s=!1,...a}=e,i=CG(kG,r),o=Ci(r);return n.jsx(s_e,{asChild:!0,...o,children:n.jsx(er.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...a,ref:Jc(t,i.triggerRef),onPointerDown:Tt(e.onPointerDown,l=>{!s&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:Tt(e.onKeyDown,l=>{s||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});AG.displayName=kG;var b_e="DropdownMenuPortal",TG=e=>{const{__scopeDropdownMenu:t,...r}=e,s=Ci(t);return n.jsx(a_e,{...s,...r})};TG.displayName=b_e;var PG="DropdownMenuContent",OG=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=CG(PG,r),i=Ci(r),o=P.useRef(!1);return n.jsx(i_e,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...s,ref:t,onCloseAutoFocus:Tt(e.onCloseAutoFocus,l=>{var d;o.current||(d=a.triggerRef.current)==null||d.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:Tt(e.onInteractOutside,l=>{const d=l.detail.originalEvent,c=d.button===0&&d.ctrlKey===!0,u=d.button===2||c;(!a.modal||u)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});OG.displayName=PG;var w_e="DropdownMenuGroup",__e=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ci(r);return n.jsx(o_e,{...a,...s,ref:t})});__e.displayName=w_e;var j_e="DropdownMenuLabel",RG=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ci(r);return n.jsx(l_e,{...a,...s,ref:t})});RG.displayName=j_e;var N_e="DropdownMenuItem",MG=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ci(r);return n.jsx(c_e,{...a,...s,ref:t})});MG.displayName=N_e;var S_e="DropdownMenuCheckboxItem",IG=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ci(r);return n.jsx(d_e,{...a,...s,ref:t})});IG.displayName=S_e;var C_e="DropdownMenuRadioGroup",E_e=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ci(r);return n.jsx(u_e,{...a,...s,ref:t})});E_e.displayName=C_e;var k_e="DropdownMenuRadioItem",DG=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ci(r);return n.jsx(h_e,{...a,...s,ref:t})});DG.displayName=k_e;var A_e="DropdownMenuItemIndicator",LG=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ci(r);return n.jsx(f_e,{...a,...s,ref:t})});LG.displayName=A_e;var T_e="DropdownMenuSeparator",BG=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ci(r);return n.jsx(m_e,{...a,...s,ref:t})});BG.displayName=T_e;var P_e="DropdownMenuArrow",O_e=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ci(r);return n.jsx(p_e,{...a,...s,ref:t})});O_e.displayName=P_e;var R_e="DropdownMenuSubTrigger",$G=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ci(r);return n.jsx(g_e,{...a,...s,ref:t})});$G.displayName=R_e;var M_e="DropdownMenuSubContent",FG=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ci(r);return n.jsx(x_e,{...a,...s,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});FG.displayName=M_e;var I_e=EG,D_e=AG,L_e=TG,zG=OG,UG=RG,VG=MG,qG=IG,WG=DG,HG=LG,GG=BG,KG=$G,XG=FG;const H_=I_e,G_=D_e,B_e=P.forwardRef(({className:e,inset:t,children:r,...s},a)=>n.jsxs(KG,{ref:a,className:He("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",t&&"pl-8",e),...s,children:[r,n.jsx(In,{className:"ml-auto h-4 w-4"})]}));B_e.displayName=KG.displayName;const $_e=P.forwardRef(({className:e,...t},r)=>n.jsx(XG,{ref:r,className:He("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));$_e.displayName=XG.displayName;const x1=P.forwardRef(({className:e,sideOffset:t=4,...r},s)=>n.jsx(L_e,{children:n.jsx(zG,{ref:s,sideOffset:t,className:He("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));x1.displayName=zG.displayName;const pl=P.forwardRef(({className:e,inset:t,...r},s)=>n.jsx(VG,{ref:s,className:He("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t&&"pl-8",e),...r}));pl.displayName=VG.displayName;const F_e=P.forwardRef(({className:e,children:t,checked:r,...s},a)=>n.jsxs(qG,{ref:a,className:He("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),checked:r,...s,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(HG,{children:n.jsx(gn,{className:"h-4 w-4"})})}),t]}));F_e.displayName=qG.displayName;const z_e=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(WG,{ref:s,className:He("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...r,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(HG,{children:n.jsx(QF,{className:"h-2 w-2 fill-current"})})}),t]}));z_e.displayName=WG.displayName;const U_e=P.forwardRef(({className:e,inset:t,...r},s)=>n.jsx(UG,{ref:s,className:He("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));U_e.displayName=UG.displayName;const YG=P.forwardRef(({className:e,...t},r)=>n.jsx(GG,{ref:r,className:He("-mx-1 my-1 h-px bg-muted",e),...t}));YG.displayName=GG.displayName;const c0={nova:{label:"Nova",icon:Hb,color:"bg-orange-100 text-orange-700 border-orange-300"},mostrei:{label:"J mostrei",icon:ai,color:"bg-blue-100 text-blue-700 border-blue-300"},enviei:{label:"J enviei",icon:yf,color:"bg-purple-100 text-purple-700 border-purple-300"},gostou:{label:"Gostou",icon:pse,color:"bg-emerald-100 text-emerald-700 border-emerald-300"},nao_gostou:{label:"No gostou",icon:mse,color:"bg-red-100 text-red-700 border-red-300"}};function V_e({customerId:e,customer:t,suggestions:r,onRefresh:s}){const[a,i]=P.useState(null),o=[t.size_letter,t.size_number,"UN","nico"].filter(Boolean),l=async(m,p)=>{i(m);try{const{error:g}=await le.from("customer_product_suggestions").update({status:p}).eq("id",m);if(g)throw g;s(),de.success(`Status atualizado para "${c0[p].label}"`)}catch(g){console.error("Error updating status:",g),de.error("Erro ao atualizar status")}finally{i(null)}},d=m=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(m),c=m=>{if(!m)return null;if(m.images&&m.images.length>0){const p=m.main_image_index||0;return m.images[p]||m.images[0]}return m.image_url},u=m=>{if(!(m!=null&&m.stock_by_size))return 0;const p=m.stock_by_size;let g=0;return o.forEach(x=>{if(!x)return;const v=Object.keys(p).find(y=>y.toLowerCase()===x.toLowerCase());v&&(g+=p[v]||0)}),g},h=m=>{var b;const p=m.product;if(!p)return;const g=[t.size_letter,t.size_number].filter(Boolean).join("/"),x=((b=m.reasons)==null?void 0:b.length)>0?`

Essa pea combina com voc porque: ${m.reasons.slice(0,2).join(", ")}.`:"",v=`${window.location.origin}/produto/${p.id}`,y=`Oi${t.name?`, ${t.name}`:""} 

Separei essa pea porque combina MUITO com seu estilo${t.style_title?` ${t.style_title}`:""} e fica perfeita no seu tamanho ${g}.${x}

*${p.name}*
${d(p.price)}

Link: ${v}

Me conta o que achou! `;navigator.clipboard.writeText(y),de.success("Mensagem copiada!")},f=m=>{h(m);const p=t.phone.replace(/\D/g,""),g=p.startsWith("55")?p:`55${p}`;window.open(`https://wa.me/${g}`,"_blank")};return r.length===0?n.jsx($e,{children:n.jsxs(Fe,{className:"py-12 text-center text-muted-foreground",children:[n.jsx(Gr,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhuma sugesto disponvel ainda."}),n.jsx("p",{className:"text-sm mt-1",children:"Sugestes so geradas automaticamente baseadas no perfil da cliente."})]})}):n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"text-lg flex items-center gap-2",children:[n.jsx(Gr,{className:"h-5 w-5 text-primary"}),"Sugestes de Produtos",n.jsxs(ke,{variant:"secondary",className:"ml-2",children:[r.length," sugestes"]})]})}),n.jsx(Fe,{children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(m=>{var y,b,j;const p=m.product,g=m.status,x=((y=c0[g])==null?void 0:y.icon)||Hb,v=u(p);return n.jsxs("div",{className:"bg-secondary/30 rounded-lg overflow-hidden border border-border",children:[n.jsxs("div",{className:"aspect-square relative",children:[c(p)?n.jsx("img",{src:c(p),alt:(p==null?void 0:p.name)||"Produto",className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-secondary flex items-center justify-center",children:n.jsx(Vt,{className:"h-8 w-8 text-muted-foreground"})}),n.jsxs(H_,{children:[n.jsx(G_,{asChild:!0,children:n.jsxs("button",{className:`absolute top-2 left-2 px-2 py-1 rounded-full text-xs font-medium border flex items-center gap-1 ${((b=c0[g])==null?void 0:b.color)||"bg-gray-100"}`,disabled:a===m.id,children:[a===m.id?n.jsx(Et,{className:"h-3 w-3 animate-spin"}):n.jsx(x,{className:"h-3 w-3"}),((j=c0[g])==null?void 0:j.label)||"Nova"]})}),n.jsx(x1,{children:Object.entries(c0).map(([T,O])=>n.jsxs(pl,{onClick:()=>l(m.id,T),children:[n.jsx(O.icon,{className:"h-4 w-4 mr-2"}),O.label]},T))})]}),n.jsxs(ke,{variant:"secondary",className:"absolute top-2 right-2 text-xs bg-white/90",children:[v," em estoque"]})]}),n.jsxs("div",{className:"p-3 space-y-2",children:[n.jsx("p",{className:"font-medium text-sm line-clamp-2",children:p==null?void 0:p.name}),n.jsx("p",{className:"text-primary font-bold",children:p?d(p.price):"-"}),m.reasons&&m.reasons.length>0&&n.jsx("div",{className:"flex flex-wrap gap-1",children:m.reasons.slice(0,2).map((T,O)=>n.jsx(ke,{variant:"outline",className:"text-xs",children:T},O))}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"flex-1 gap-1 text-xs",onClick:()=>h(m),children:[n.jsx(Wa,{className:"h-3 w-3"}),"Copiar"]}),n.jsxs(he,{size:"sm",className:"flex-1 gap-1 text-xs bg-[#25D366] hover:bg-[#128C7E] text-white",onClick:()=>f(m),children:[n.jsx(nn,{className:"h-3 w-3"}),"Enviar"]})]})]})]},m.id)})})})]})}const q_e=["PP","P","M","G","GG","XG","XXG"],W_e=["34","36","38","40","42","44","46","48","50","52"];function H_e({customer:e,onUpdate:t}){var m;const[r,s]=P.useState(!1),[a,i]=P.useState(!1),o=CC(e.address_line,e.city,e.state,e.zip_code,e.address_reference||null,e.document||null),[l,d]=P.useState({name:e.name||"",email:e.email||"",size_letter:e.size_letter||"",size_number:e.size_number||"",document:((m=e.document)==null?void 0:m.replace(/\D/g,""))||""}),[c,u]=P.useState(o);P.useEffect(()=>{var p;d({name:e.name||"",email:e.email||"",size_letter:e.size_letter||"",size_number:e.size_number||"",document:((p=e.document)==null?void 0:p.replace(/\D/g,""))||""}),u(CC(e.address_line,e.city,e.state,e.zip_code,e.address_reference||null,e.document||null))},[e]);const h=[];if(e.name||h.push({key:"name",label:"Nome"}),e.email||h.push({key:"email",label:"Email"}),!e.size_letter&&!e.size_number&&h.push({key:"size",label:"Tamanho"}),e.address_line||h.push({key:"address_line",label:"Endereo"}),e.zip_code||h.push({key:"zip_code",label:"CEP"}),e.city||h.push({key:"city",label:"Cidade"}),e.state||h.push({key:"state",label:"Estado"}),h.length===0)return null;const f=async()=>{i(!0);try{const g=[c.street,c.number,c.complement,c.neighborhood].filter(Boolean).join(", "),x=(l.document||c.document||"").replace(/\D/g,""),{error:v}=await le.from("customers").update({name:l.name||null,email:l.email||null,size_letter:l.size_letter||null,size_number:l.size_number||null,address_line:g||null,city:c.city||null,state:c.state||null,zip_code:c.zipCode||null,address_reference:c.reference||null,document:x||null}).eq("id",e.id);if(v)throw v;if(x&&c.zipCode){const{data:y}=await le.from("customer_addresses").select("id").eq("customer_id",e.id).eq("is_default",!0).maybeSingle();y&&await le.from("customer_addresses").update({document:x}).eq("id",y.id)}de.success("Cadastro atualizado!"),s(!1),t()}catch(p){console.error("Error updating customer:",p),de.error("Erro ao atualizar cadastro")}finally{i(!1)}};return n.jsxs(n.Fragment,{children:[n.jsxs($e,{className:"border-amber-200 bg-amber-50/50",children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-base flex items-center gap-2 text-amber-700",children:[n.jsx(Sn,{className:"h-5 w-5"}),"Cadastro incompleto"]})}),n.jsxs(Fe,{className:"space-y-3",children:[n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("span",{className:"text-sm text-amber-700",children:"Faltam:"}),h.map(p=>n.jsx("span",{className:"px-2 py-0.5 rounded bg-amber-100 text-amber-700 text-sm",children:p.label},p.key))]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>s(!0),className:"border-amber-300 text-amber-700 hover:bg-amber-100",children:[n.jsx(hse,{className:"h-4 w-4 mr-2"}),"Completar cadastro manualmente"]})]})]}),n.jsx(tn,{open:r,onOpenChange:s,children:n.jsxs(Jr,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:[n.jsx(ln,{children:n.jsx(rn,{children:"Completar cadastro"})}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"font-medium text-sm text-muted-foreground uppercase tracking-wide",children:"Dados Pessoais"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"name",children:"Nome completo"}),n.jsx(et,{id:"name",value:l.name,onChange:p=>d({...l,name:p.target.value}),placeholder:"Nome da cliente"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"email",children:"Email"}),n.jsx(et,{id:"email",type:"email",value:l.email,onChange:p=>d({...l,email:p.target.value}),placeholder:"email@exemplo.com"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Tamanho (letra)"}),n.jsxs(Xt,{value:l.size_letter,onValueChange:p=>d({...l,size_letter:p==="_none"?"":p}),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecione"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"_none",children:"No informado"}),q_e.map(p=>n.jsx(qe,{value:p,children:p},p))]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Tamanho (nmero)"}),n.jsxs(Xt,{value:l.size_number,onValueChange:p=>d({...l,size_number:p==="_none"?"":p}),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecione"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"_none",children:"No informado"}),W_e.map(p=>n.jsx(qe,{value:p,children:p},p))]})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"document",children:"CPF"}),n.jsx(et,{id:"document",value:QH(l.document),onChange:p=>d({...l,document:p.target.value.replace(/\D/g,"").slice(0,11)}),placeholder:"000.000.000-00",maxLength:14}),l.document&&l.document.length>0&&l.document.length!==11&&n.jsxs("p",{className:"text-xs text-amber-600",children:["CPF deve ter 11 dgitos (",l.document.length,"/11)"]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"font-medium text-sm text-muted-foreground uppercase tracking-wide",children:"Endereo"}),n.jsx(U_,{value:c,onChange:u,showReference:!0,showCpf:!1})]})]}),n.jsxs(ba,{className:"gap-2 mt-6",children:[n.jsxs(he,{variant:"outline",onClick:()=>s(!1),children:[n.jsx(sn,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),n.jsxs(he,{onClick:f,disabled:a,children:[a?n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}):n.jsx(gn,{className:"h-4 w-4 mr-2"}),"Salvar"]})]})]})})]})}const G_e=()=>{var C,k;const{id:e}=ta(),t=pr(),{user:r,isMerchant:s,rolesLoading:a}=qn(),[i,o]=P.useState(null),[l,d]=P.useState([]),[c,u]=P.useState([]),[h,f]=P.useState(null),[m,p]=P.useState([]),[g,x]=P.useState({}),[v,y]=P.useState([]),[b,j]=P.useState([]),[T,O]=P.useState([]),[R,D]=P.useState(!0),[B,q]=P.useState(!1);P.useEffect(()=>{!a&&(!r||!s())&&t("/login")},[r,s,a,t]),P.useEffect(()=>{e&&r&&Y()},[e,r]);const Y=async()=>{var M,U;if(e){D(!0);try{const{data:$,error:X}=await le.from("customers").select("*").eq("id",e).single();if(X)throw X;let Z=X?null:$;if(Z&&!Z.instagram){let{data:me}=await le.from("live_customers").select("id, instagram_handle").eq("client_id",e).maybeSingle();if(!me){const ge=(M=Z.phone)==null?void 0:M.replace(/\D/g,"");if(ge){const{data:_e}=await le.from("live_customers").select("id, instagram_handle").or(`whatsapp.ilike.%${ge}%,whatsapp.ilike.%${ge.slice(-8)}%`).limit(1).maybeSingle();_e&&(me=_e,await le.from("live_customers").update({client_id:e}).eq("id",me.id))}}me!=null&&me.instagram_handle&&(await le.from("customers").update({instagram:me.instagram_handle}).eq("id",e),Z.instagram=me.instagram_handle)}o(Z);const{data:re}=await le.from("orders").select("*").eq("customer_id",e).order("created_at",{ascending:!1}),W=(U=$.phone)==null?void 0:U.replace(/\D/g,"");let J=[];if(W){const{data:me}=await le.from("orders").select("*").is("customer_id",null).order("created_at",{ascending:!1});J=(me||[]).filter(ge=>{var ye;const _e=(ye=ge.customer_phone)==null?void 0:ye.replace(/\D/g,"");if(!_e||!W)return!1;if(_e===W)return!0;const be=Oe=>Oe.startsWith("55")?Oe.slice(2):Oe;return be(_e)===be(W)})}const V=[...re||[],...J],H=new Set,ee=V.filter(me=>H.has(me.id)?!1:(H.add(me.id),!0)),ie=[];for(const me of ee){const{data:ge}=await le.from("order_items").select("*").eq("order_id",me.id);ie.push({...me,items:ge||[]})}d(ie);let oe=[];const{data:se}=await le.from("quiz_responses").select("*").eq("customer_id",e).order("question_number");if(se&&se.length>0)oe=se;else if($.user_id){const{data:me}=await le.from("quiz_responses").select("*").eq("user_id",$.user_id).order("created_at",{ascending:!1}).limit(10);oe=me||[]}if(u(oe),$.user_id){const{data:me}=await le.from("profiles").select("style_title, style_description, color_palette, avoid_items, personal_tip, size_letter, size_number, quiz_points, quiz_level, quiz_completed_at").eq("user_id",$.user_id).maybeSingle();me&&f(me)}const ue=le.from("print_requests").select("*").order("created_at",{ascending:!1});if($.user_id){const{data:me}=await ue.or(`customer_id.eq.${e},user_id.eq.${$.user_id}`);p(me||[]);const ge=(me||[]).filter(_e=>_e.linked_product_id).map(_e=>_e.linked_product_id);if(ge.length>0){const{data:_e}=await le.from("product_catalog").select("id, name, price, image_url").in("id",ge),be={};(_e||[]).forEach(ye=>{be[ye.id]=ye}),x(be)}}else{const{data:me}=await ue.eq("customer_id",e);p(me||[])}const{data:pe}=await le.from("product_catalog").select("*").eq("is_active",!0);y(pe||[]);const{data:ce}=await le.from("customer_inspiration_photos").select("*").eq("customer_id",e).order("is_starred",{ascending:!1}).order("created_at",{ascending:!1});j(ce||[]);const{data:ne}=await le.from("customer_product_suggestions").select("*").eq("customer_id",e).order("score",{ascending:!1});if(ne&&ne.length>0){const me=ne.map(ye=>ye.product_id),{data:ge}=await le.from("product_catalog").select("*").in("id",me),_e={};(ge||[]).forEach(ye=>{_e[ye.id]=ye});const be=ne.map(ye=>({id:ye.id,product_id:ye.product_id,status:ye.status||"nova",score:ye.score,reasons:Array.isArray(ye.reasons)?ye.reasons:[],product:_e[ye.product_id]}));O(be)}}catch($){console.error("Error loading customer data:",$),de.error("Erro ao carregar dados do cliente")}finally{D(!1)}}},G=`${window.location.origin}/quiz`;if(R||a)return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 flex justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]});if(!i)return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 text-center",children:[n.jsx("p",{className:"text-muted-foreground",children:"Cliente no encontrado"}),n.jsx(he,{onClick:()=>t("/dashboard?tab=clientes"),className:"mt-4",children:"Voltar"})]})]});const I=i.style_title||(h==null?void 0:h.style_title),F=i.size_letter||(h==null?void 0:h.size_letter),S=i.size_number||(h==null?void 0:h.size_number),E=c.length>0||!!I||!!(h!=null&&h.quiz_completed_at),N=m.length>0;return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-5xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>t("/dashboard?tab=clientes"),children:[n.jsx(Ts,{className:"h-4 w-4 mr-1"}),"Voltar para Clientes"]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>q(!0),className:"gap-1",children:[n.jsx(YF,{className:"h-4 w-4"}),"Montar catlogo"]})]}),n.jsx("div",{className:"mb-6",children:n.jsx(y2e,{customer:{id:i.id,phone:i.phone,name:i.name,email:i.email,instagram:i.instagram,style_title:I||null,size_letter:F||null,size_number:S||null,created_at:i.created_at,total_orders:i.total_orders||0,total_spent:Number(i.total_spent)||0,last_order_at:i.last_order_at},hasQuiz:E,hasPrints:N})}),n.jsx("div",{className:"mb-6",children:n.jsx(H_e,{customer:{id:i.id,name:i.name,phone:i.phone,email:i.email,size_letter:F||null,size_number:S||null,address_line:i.address_line,city:i.city,state:i.state,zip_code:i.zip_code,address_reference:i.address_reference,document:i.document},onUpdate:Y})}),n.jsxs(Hi,{defaultValue:"vendas",className:"space-y-6",children:[n.jsxs(Si,{className:"w-full justify-start flex-wrap h-auto gap-1",children:[n.jsxs(br,{value:"vendas",className:"gap-1",children:[n.jsx(fc,{className:"h-4 w-4"}),"Vendas"]}),n.jsxs(br,{value:"perfil",className:"gap-1",children:[n.jsx(Gr,{className:"h-4 w-4"}),"Perfil"]}),n.jsxs(br,{value:"pedidos",className:"gap-1",children:[n.jsx(hn,{className:"h-4 w-4"}),"Pedidos",l.length>0&&n.jsx(ke,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:l.length})]}),n.jsxs(br,{value:"inspiracoes",className:"gap-1",children:[n.jsx(ka,{className:"h-4 w-4"}),"Inspiraes",b.length>0&&n.jsx(ke,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:b.length})]}),n.jsxs(br,{value:"prints",className:"gap-1",children:[n.jsx(ka,{className:"h-4 w-4"}),"Prints",m.length>0&&n.jsx(ke,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:m.length})]}),n.jsxs(br,{value:"sugestoes",className:"gap-1",children:[n.jsx(Gr,{className:"h-4 w-4"}),"Sugestes",T.length>0&&n.jsx(ke,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:T.length})]}),n.jsxs(br,{value:"lives",className:"gap-1",children:[n.jsx(Ss,{className:"h-4 w-4"}),"Lives"]}),n.jsxs(br,{value:"mensagens",className:"gap-1",children:[n.jsx(nn,{className:"h-4 w-4"}),"Mensagens"]})]}),n.jsx(kr,{value:"vendas",children:n.jsx(E2e,{customerId:i.id,customerPhone:i.phone})}),n.jsxs(kr,{value:"perfil",className:"space-y-6",children:[n.jsx(b2e,{customer:{id:i.id,name:i.name,phone:i.phone,email:i.email,instagram:i.instagram,address_line:i.address_line,city:i.city,state:i.state,zip_code:i.zip_code,document:i.document},onUpdate:Y}),n.jsx(w2e,{customer:{name:i.name,style_title:I||null,size_letter:F||null,size_number:S||null},profileData:h,quizResponses:c,quizLink:G})]}),n.jsx(kr,{value:"pedidos",children:n.jsx(_2e,{orders:l})}),n.jsx(kr,{value:"inspiracoes",children:n.jsx(k2e,{photos:b,onPhotosUpdate:Y})}),n.jsx(kr,{value:"prints",children:n.jsx(j2e,{prints:m,linkedProducts:g})}),n.jsx(kr,{value:"sugestoes",children:n.jsx(V_e,{customerId:i.id,customer:{name:i.name,phone:i.phone,style_title:I||null,size_letter:F||null,size_number:S||null},suggestions:T,onRefresh:Y})}),n.jsx(kr,{value:"lives",children:n.jsx(C2e,{customerId:i.id})}),n.jsx(kr,{value:"mensagens",children:n.jsx(N2e,{customer:{name:i.name,size_letter:F||null,size_number:S||null},quizLink:G,lastOrderId:(C=l[0])==null?void 0:C.id,lastOrderStatus:(k=l[0])==null?void 0:k.status})})]})]}),n.jsx(eH,{open:B,onClose:()=>q(!1),customerId:i.id,customerName:i.name,customerPhone:i.phone,customerStyle:I||null,customerSizeLetter:F||null,customerSizeNumber:S||null,availableProducts:v})]})},K_e=()=>{const{link:e}=ta(),t=pr(),{user:r}=qn(),{addItem:s,items:a}=Lu(),[i,o]=P.useState(null),[l,d]=P.useState(new Set),[c,u]=P.useState(!0),[h,f]=P.useState(null),[m,p]=P.useState({}),[g,x]=P.useState(new Set);P.useEffect(()=>{e&&v()},[e]),P.useEffect(()=>{r&&i&&y()},[r,i]);const v=async()=>{try{const{data:R,error:D}=await le.from("customer_catalogs").select("*").eq("public_link",e).maybeSingle();if(D)throw D;if(!R){f("Catlogo no encontrado");return}const B=(R.products||[]).map(q=>q.id);if(B.length>0){const{data:q}=await le.from("product_catalog").select("id, stock_by_size").in("id",B),Y={};(q||[]).forEach(I=>{const F=I.stock_by_size;F&&(Y[I.id]=Object.entries(F).filter(([S,E])=>E>0).map(([S])=>S))});const G=(R.products||[]).map(I=>({...I,sizes:Y[I.id]||[]}));o({id:R.id,title:R.title,intro_text:R.intro_text,products:G,created_at:R.created_at,customer_id:R.customer_id})}else o({id:R.id,title:R.title,intro_text:R.intro_text,products:R.products||[],created_at:R.created_at,customer_id:R.customer_id})}catch(R){console.error("Error loading catalog:",R),f("Erro ao carregar catlogo")}finally{u(!1)}},y=async()=>{if(!r)return;const R=localStorage.getItem(`catalog_favorites_${i==null?void 0:i.id}`);R&&d(new Set(JSON.parse(R)))},b=async R=>{const D=new Set(l);if(l.has(R))D.delete(R),de.success("Removido dos favoritos");else if(D.add(R),de.success("Adicionado aos favoritos! "),r&&(i!=null&&i.customer_id))try{const{data:B}=await le.from("customer_product_suggestions").select("id, status").eq("customer_id",i.customer_id).eq("product_id",R).maybeSingle();B?await le.from("customer_product_suggestions").update({status:"gostou"}).eq("id",B.id):await le.from("customer_product_suggestions").insert({customer_id:i.customer_id,product_id:R,status:"gostou",score:100,reasons:[{type:"favorited_in_catalog",label:"Favoritou no catlogo"}]})}catch(B){console.error("Error saving favorite:",B)}d(D),localStorage.setItem(`catalog_favorites_${i==null?void 0:i.id}`,JSON.stringify(Array.from(D)))},j=R=>{const D=m[R.id];if(!D){de.error("Selecione um tamanho");return}s({productId:R.id,name:R.name,price:R.price,originalPrice:R.price,discountPercent:0,size:D,imageUrl:R.image}),x(B=>new Set(B).add(R.id)),de.success("Adicionado ao carrinho! "),setTimeout(()=>{x(B=>{const q=new Set(B);return q.delete(R.id),q})},2e3)},T=R=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(R),O=a.reduce((R,D)=>R+D.quantity,0);return c?n.jsx("div",{className:"min-h-screen bg-gradient-to-b from-stone-50 to-white flex items-center justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-primary"})}):h||!i?n.jsx("div",{className:"min-h-screen bg-gradient-to-b from-stone-50 to-white flex items-center justify-center",children:n.jsxs("div",{className:"text-center px-4",children:[n.jsx(Gr,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),n.jsx("h1",{className:"text-xl font-serif mb-2",children:h||"Catlogo no encontrado"}),n.jsx("p",{className:"text-muted-foreground",children:"Este link pode ter expirado ou no est mais disponvel."})]})}):n.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-stone-50 to-white",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-stone-100",children:n.jsx("div",{className:"container mx-auto px-4 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"font-serif text-lg",children:"Provador VIP"}),O>0&&n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>t("/carrinho"),children:[n.jsx(hn,{className:"h-4 w-4"}),n.jsx("span",{children:O})]})]})})}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsxs(ke,{variant:"secondary",className:"mb-4 gap-1",children:[n.jsx(Gr,{className:"h-3 w-3"}),"Seleo exclusiva"]}),n.jsx("h1",{className:"font-serif text-2xl md:text-3xl mb-4",children:i.title}),i.intro_text&&n.jsx("p",{className:"text-muted-foreground leading-relaxed whitespace-pre-line",children:i.intro_text})]}),n.jsx("div",{className:"grid grid-cols-1 gap-6 mb-8",children:i.products.map((R,D)=>n.jsxs("div",{className:"bg-white rounded-xl overflow-hidden border border-stone-100 shadow-sm",children:[n.jsxs("div",{className:"aspect-[4/5] relative bg-stone-100",children:[R.image?n.jsx("img",{src:R.image,alt:R.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(hn,{className:"h-8 w-8 text-muted-foreground"})}),n.jsx("button",{className:`absolute top-3 right-3 w-10 h-10 rounded-full flex items-center justify-center transition-colors ${l.has(R.id)?"bg-red-500 text-white":"bg-white/80 backdrop-blur-sm hover:bg-white text-stone-400 hover:text-red-500"}`,onClick:()=>b(R.id),children:n.jsx(bl,{className:`h-5 w-5 ${l.has(R.id)?"fill-current":""}`})}),R.color&&n.jsx(ke,{variant:"secondary",className:"absolute bottom-3 left-3 text-xs bg-white/90",children:R.color})]}),n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-lg",children:R.name}),n.jsx("p",{className:"text-primary font-bold text-xl",children:T(R.price)})]}),R.sizes&&R.sizes.length>0&&n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Tamanhos disponveis:"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:R.sizes.map(B=>n.jsx("button",{onClick:()=>p(q=>({...q,[R.id]:B})),className:`px-3 py-1.5 text-sm rounded-lg border transition-colors ${m[R.id]===B?"bg-primary text-primary-foreground border-primary":"border-stone-200 hover:border-primary"}`,children:B},B))})]}),n.jsx(he,{className:"w-full gap-2",onClick:()=>j(R),disabled:!R.sizes||R.sizes.length===0,variant:g.has(R.id)?"secondary":"default",children:g.has(R.id)?n.jsxs(n.Fragment,{children:[n.jsx(gn,{className:"h-4 w-4"}),"Adicionado!"]}):n.jsxs(n.Fragment,{children:[n.jsx(kn,{className:"h-4 w-4"}),"Adicionar ao carrinho"]})})]})]},R.id||D))}),l.size>0&&n.jsxs("div",{className:"mb-4 p-4 bg-red-50 rounded-xl border border-red-100",children:[n.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[n.jsx(bl,{className:"h-4 w-4 fill-current"}),n.jsxs("span",{className:"font-medium",children:[l.size," pea(s) favoritada(s)"]})]}),n.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Sua consultora ver suas peas preferidas!"})]}),n.jsx("div",{className:"sticky bottom-4",children:n.jsx(he,{size:"lg",className:"w-full bg-[#25D366] hover:bg-[#128C7E] text-white gap-2 shadow-lg",asChild:!0,children:n.jsxs("a",{href:"https://wa.me/5562991223519?text=Oi!%20Vi%20o%20catlogo%20que%20voc%20preparou%20pra%20mim%20e%20adorei!%20%F0%9F%92%9B",target:"_blank",rel:"noopener noreferrer",children:[n.jsx(nn,{className:"h-5 w-5"}),"Falar sobre essas peas"]})})})]})]})},X_e=()=>{const e=wc();return P.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),n.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),n.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),n.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})};function Y_e({quizPoints:e,quizLevel:t,hasCompletedQuiz:r,lastMissionId:s,lastMissionName:a,lastMissionCompletedAt:i,nextMissionId:o,nextMissionName:l,inProgressMissionId:d}){const{level:c,title:u}=ef(e),h=Jg[c-1]||0,f=Jg[c]||Jg[Jg.length-1],m=e-h,p=f-h,g=Math.min(m/p*100,100),x=c>=Jg.length,v=()=>{if(!i)return null;const y=new Date(i),j=Math.floor((new Date().getTime()-y.getTime())/(1e3*60*60*24));return j===0?"Hoje":j===1?"Ontem":j<7?`${j} dias atrs`:y.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})};return n.jsxs("div",{className:"bg-gradient-to-br from-accent/5 via-primary/5 to-accent/10 border border-accent/20 rounded-2xl p-5 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(ma,{className:"h-5 w-5 text-accent"}),n.jsx("h2",{className:"font-serif text-lg",children:"Seu Progresso VIP"})]}),n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("div",{className:"flex items-center gap-1.5 bg-accent/10 px-3 py-1.5 rounded-full",children:[n.jsx(wi,{className:"h-4 w-4 text-amber-500 fill-amber-500"}),n.jsxs("span",{className:"font-bold text-amber-700",children:[e," pts"]})]})}),n.jsxs("div",{className:"text-sm text-right",children:[n.jsxs("span",{className:"text-muted-foreground",children:["Nvel ",c,": "]}),n.jsx("span",{className:"font-medium text-accent",children:u})]})]}),!x&&n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-1.5",children:[n.jsxs("span",{children:["Progresso para Nvel ",c+1]}),n.jsxs("span",{children:[f-e," pts restantes"]})]}),n.jsx(dg,{value:g,className:"h-2 bg-secondary"})]}),x&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-accent mb-4",children:[n.jsx(mn,{className:"h-4 w-4"}),n.jsx("span",{className:"font-medium",children:"Nvel mximo alcanado! "})]}),n.jsx("div",{className:"mb-4",children:r?d?n.jsx(Ft,{to:`/missao/${d}`,children:n.jsxs(he,{className:"w-full gap-2 bg-amber-500 hover:bg-amber-600 text-white",children:[n.jsx(Lr,{className:"h-4 w-4"}),"Continuar de onde parei",n.jsx(hs,{className:"h-4 w-4"})]})}):o?n.jsx(Ft,{to:`/missao/${o}`,children:n.jsxs(he,{className:"w-full gap-2",children:[n.jsx(li,{className:"h-4 w-4"}),"Continuar Trilhas",n.jsx(hs,{className:"h-4 w-4"})]})}):n.jsxs("div",{className:"text-center text-sm text-muted-foreground bg-card/50 rounded-xl p-3",children:[n.jsx(mn,{className:"h-5 w-5 text-accent mx-auto mb-1"}),"Todas as misses completadas! "]}):n.jsx(Ft,{to:"/quiz",children:n.jsxs(he,{className:"w-full gap-2 bg-accent hover:bg-accent/90",children:[n.jsx(Gr,{className:"h-4 w-4"}),"Fazer Quiz Base",n.jsx(hs,{className:"h-4 w-4"})]})})}),r&&n.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[a&&n.jsxs("div",{className:"bg-card/50 rounded-xl p-3",children:[n.jsx("p",{className:"text-muted-foreground mb-0.5",children:"ltima misso"}),n.jsx("p",{className:"font-medium truncate",children:a}),i&&n.jsx("p",{className:"text-muted-foreground text-[10px]",children:v()})]}),l&&!d&&n.jsxs("div",{className:"bg-card/50 rounded-xl p-3",children:[n.jsx("p",{className:"text-muted-foreground mb-0.5",children:"Prxima sugerida"}),n.jsx("p",{className:"font-medium truncate",children:l})]})]}),r&&n.jsx("div",{className:"mt-4 pt-4 border-t border-border/50",children:n.jsxs(_c,{children:[n.jsx(o1,{asChild:!0,children:n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full text-muted-foreground hover:text-foreground gap-2",children:[n.jsx(Kv,{className:"h-4 w-4"}),"Refazer Quiz de Estilo"]})}),n.jsxs(Tl,{children:[n.jsxs(Pl,{children:[n.jsx(Ol,{children:"Refazer Quiz de Estilo?"}),n.jsxs(Rl,{children:["Voc pode refazer o quiz para atualizar seu perfil de estilo.",n.jsx("span",{className:"block mt-2 font-medium text-foreground",children:"Seus pontos sero mantidos  no sero somados novamente por respostas j dadas."})]})]}),n.jsxs(jc,{children:[n.jsx(Sc,{children:"Cancelar"}),n.jsx(Nc,{asChild:!0,children:n.jsx(Ft,{to:"/quiz?redo=true",children:n.jsx(he,{children:"Refazer Quiz"})})})]})]})]})})]})}const Z_e=ug({email:Ii().email("Email invlido"),password:Ii().min(6,"Senha deve ter no mnimo 6 caracteres")});function Q_e(){var D;const e=pr(),{user:t,isLoading:r}=qn(),[s,a]=P.useState(!0),[i,o]=P.useState(""),[l,d]=P.useState(""),[c,u]=P.useState(!1),[h,f]=P.useState(!1),[m,p]=P.useState(!1),[g,x]=P.useState(null),[v,y]=P.useState(!0),[b,j]=P.useState(null),T=async()=>{p(!0);try{sessionStorage.setItem("oauth_return_to","/minha-conta");const{error:B}=await KV.auth.signInWithOAuth("google",{redirect_uri:window.location.origin});if(B)throw B}catch(B){console.error("Google login error:",B),de.error("Erro ao conectar com Google"),p(!1)}};P.useEffect(()=>{t?O():y(!1)},[t]);const O=async()=>{if(t)try{let{data:B,error:q}=await le.from("profiles").select("full_name, quiz_points, quiz_level, completed_missions, style_title, last_mission_id, last_mission_completed_at").eq("user_id",t.id).maybeSingle();if(!B&&!q){const{data:G}=await le.from("profiles").insert({user_id:t.id}).select("full_name, quiz_points, quiz_level, completed_missions, style_title, last_mission_id, last_mission_completed_at").single();B=G}x({full_name:(B==null?void 0:B.full_name)||null,quiz_points:(B==null?void 0:B.quiz_points)||0,quiz_level:(B==null?void 0:B.quiz_level)||1,completed_missions:(B==null?void 0:B.completed_missions)||[],style_title:(B==null?void 0:B.style_title)||null,last_mission_id:(B==null?void 0:B.last_mission_id)||null,last_mission_completed_at:(B==null?void 0:B.last_mission_completed_at)||null});const{data:Y}=await le.from("mission_attempts").select("mission_id").eq("user_id",t.id).eq("status","in_progress").order("updated_at",{ascending:!1}).limit(1).maybeSingle();Y&&j(Y.mission_id)}catch(B){console.error("Error loading profile:",B)}finally{y(!1)}};if(!r&&t){const B=((g==null?void 0:g.quiz_points)||0)>0,q=(g==null?void 0:g.completed_missions)||[],Y=qx(q),G=Y.length>0?Y[0]:null,I=g!=null&&g.last_mission_id?dw(g.last_mission_id):null;return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-lg",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsxs("h1",{className:"font-serif text-2xl mb-2",children:["Ol, ",((D=g==null?void 0:g.full_name)==null?void 0:D.split(" ")[0])||"Visitante","! "]}),n.jsx("p",{className:"text-muted-foreground",children:t.email}),(g==null?void 0:g.style_title)&&n.jsxs("p",{className:"text-sm text-accent mt-1",children:["Estilo: ",g.style_title]})]}),!v&&n.jsx(Y_e,{quizPoints:(g==null?void 0:g.quiz_points)||0,quizLevel:(g==null?void 0:g.quiz_level)||1,hasCompletedQuiz:B,lastMissionId:g==null?void 0:g.last_mission_id,lastMissionName:I==null?void 0:I.title,lastMissionCompletedAt:g==null?void 0:g.last_mission_completed_at,nextMissionId:G==null?void 0:G.id,nextMissionName:G==null?void 0:G.title,inProgressMissionId:b}),n.jsxs("div",{className:"space-y-3 mb-8",children:[n.jsx(Ft,{to:"/meus-favoritos",children:n.jsx($e,{className:"hover:shadow-md transition-shadow cursor-pointer border-red-200 bg-gradient-to-r from-red-50/50 to-background",children:n.jsxs(Fe,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-red-100 flex items-center justify-center",children:n.jsx(bl,{className:"h-5 w-5 text-red-500 fill-red-500"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Meus Favoritos"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Produtos que voc amou"})]})]}),n.jsx(In,{className:"h-5 w-5 text-muted-foreground"})]})})}),n.jsx(Ft,{to:"/meus-pedidos",children:n.jsx($e,{className:"hover:shadow-md transition-shadow cursor-pointer",children:n.jsxs(Fe,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-accent/10 flex items-center justify-center",children:n.jsx(Vt,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Meus Pedidos"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Acompanhe suas compras"})]})]}),n.jsx(In,{className:"h-5 w-5 text-muted-foreground"})]})})}),n.jsx(Ft,{to:"/meus-prints",children:n.jsx($e,{className:"hover:shadow-md transition-shadow cursor-pointer",children:n.jsxs(Fe,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-accent/10 flex items-center justify-center",children:n.jsx(ka,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Meus Prints"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Prints enviados e resultados"})]})]}),n.jsx(In,{className:"h-5 w-5 text-muted-foreground"})]})})}),n.jsx(Ft,{to:"/meu-estilo",children:n.jsx($e,{className:"hover:shadow-md transition-shadow cursor-pointer border-accent/30 bg-gradient-to-r from-accent/5 to-primary/5",children:n.jsxs(Fe,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-accent/20 to-primary/20 flex items-center justify-center",children:n.jsx(Gr,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Meu Estilo"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:B?"Progresso e trilhas VIP":"Descubra seu estilo"})]})]}),n.jsx(In,{className:"h-5 w-5 text-muted-foreground"})]})})}),n.jsx(Ft,{to:"/minhas-sugestoes",children:n.jsx($e,{className:"hover:shadow-md transition-shadow cursor-pointer",children:n.jsxs(Fe,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-accent/10 flex items-center justify-center",children:n.jsx(li,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Sugestes pra mim"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Looks personalizados"})]})]}),n.jsx(In,{className:"h-5 w-5 text-muted-foreground"})]})})}),B&&n.jsx($e,{className:"hover:shadow-md transition-shadow cursor-pointer border-accent/30",onClick:()=>{var F;(F=document.getElementById("missions-section"))==null||F.scrollIntoView({behavior:"smooth"})},children:n.jsxs(Fe,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-amber-100 to-accent/20 flex items-center justify-center",children:n.jsx(li,{className:"h-5 w-5 text-amber-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Misses / Trilhas"}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[q.length,"/",q.length+Y.length," completadas"]})]})]}),n.jsx(In,{className:"h-5 w-5 text-muted-foreground"})]})}),n.jsx(Ft,{to:"/meu-perfil",children:n.jsx($e,{className:"hover:shadow-md transition-shadow cursor-pointer",children:n.jsxs(Fe,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-accent/10 flex items-center justify-center",children:n.jsx(Dn,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Meus Dados"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Endereo, senha e perfil"})]})]}),n.jsx(In,{className:"h-5 w-5 text-muted-foreground"})]})})}),n.jsx($e,{className:"hover:shadow-md transition-shadow cursor-pointer border-red-100 hover:bg-red-50/50",onClick:async()=>{await le.auth.signOut(),e("/login")},children:n.jsxs(Fe,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-red-50 flex items-center justify-center",children:n.jsx(Dn,{className:"h-5 w-5 text-red-500"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-red-600",children:"Sair da Conta"}),n.jsx("p",{className:"text-sm text-red-400",children:"Deslogar do dispositivo"})]})]}),n.jsx(In,{className:"h-5 w-5 text-red-300"})]})})]}),g&&g.quiz_points>0&&n.jsx("div",{id:"missions-section",className:"mt-8 pt-8 border-t border-border",children:n.jsx($V,{completedMissions:g.completed_missions,currentPoints:g.quiz_points,currentLevel:g.quiz_level})})]})]})}const R=async B=>{var Y,G;B.preventDefault();const q=Z_e.safeParse({email:i,password:l});if(!q.success){de.error(q.error.errors[0].message);return}f(!0);try{if(s){const{error:I}=await le.auth.signInWithPassword({email:i,password:l});if(I)throw I;de.success("Bem-vinda de volta!")}else{const{error:I}=await le.auth.signUp({email:i,password:l,options:{emailRedirectTo:`${window.location.origin}/minha-conta`}});if(I)throw I;de.success("Conta criada com sucesso!")}}catch(I){console.error("Auth error:",I);const F=I;(Y=F.message)!=null&&Y.includes("already registered")?de.error("Este email j est cadastrado. Tente fazer login."):(G=F.message)!=null&&G.includes("Invalid login")?de.error("Email ou senha incorretos."):de.error(F.message||"Erro ao autenticar. Tente novamente.")}finally{f(!1)}};return r?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("main",{className:"container mx-auto px-4 py-12 max-w-sm flex items-center justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-sm",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h1",{className:"font-serif text-2xl mb-2",children:s?"Entrar na sua conta":"Criar conta"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:s?"Acesse seus pedidos e preferncias":"Crie sua conta para acompanhar tudo"})]}),n.jsxs(he,{type:"button",variant:"outline",className:"w-full mb-4",onClick:T,disabled:m,children:[m?n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}):n.jsxs("svg",{className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",children:[n.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),n.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),n.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),n.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continuar com Google"]}),n.jsxs("div",{className:"relative mb-4",children:[n.jsx("div",{className:"absolute inset-0 flex items-center",children:n.jsx(Ca,{className:"w-full"})}),n.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:n.jsx("span",{className:"bg-background px-3 text-muted-foreground",children:"ou"})})]}),n.jsxs("form",{onSubmit:R,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"email",children:"Email"}),n.jsx(et,{id:"email",type:"email",placeholder:"seu@email.com",value:i,onChange:B=>o(B.target.value),required:!0})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"password",children:"Senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(et,{id:"password",type:c?"text":"password",placeholder:"",value:l,onChange:B=>d(B.target.value),required:!0}),n.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:c?n.jsx(ac,{className:"h-4 w-4"}):n.jsx(ai,{className:"h-4 w-4"})})]}),s&&n.jsx("div",{className:"mt-1 text-right",children:n.jsx(Ft,{to:"/esqueci-senha",className:"text-xs text-muted-foreground hover:text-accent transition-colors",children:"Esqueci minha senha"})})]}),n.jsx(he,{type:"submit",className:"w-full",disabled:h,children:h?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),s?"Entrando...":"Criando conta..."]}):s?"Entrar":"Criar conta"})]}),n.jsx("div",{className:"mt-6 text-center",children:n.jsx("button",{onClick:()=>a(!s),className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:s?"No tem conta? Criar agora":"J tem conta? Fazer login"})})]})]})}const J_e=[{label:"Viso Geral",href:"/minha-conta",icon:O6,description:"Seu resumo"},{label:"Meus Pedidos",href:"/meus-pedidos",icon:Vt,description:"Acompanhe suas compras"},{label:"Le.Po Club",href:"/minha-conta/club",icon:Vi,description:"Pontos & Recompensas",highlight:!0},{label:"Mdulos de Estilo",href:"/minha-conta/missoes",icon:li,description:"Refine seu perfil"},{label:"Meu Estilo",href:"/meu-estilo",icon:Gr,description:"Quiz & Preferncias"},{label:"Sugestes",href:"/minhas-sugestoes",icon:bl,description:"Looks para voc"},{label:"Meus Prints",href:"/meus-prints",icon:ka,description:"Fotos enviadas"},{label:"Perfil",href:"/meu-perfil",icon:Dn,description:"Dados e endereos"}],eje=[{label:"Incio",href:"/",icon:JF},{label:"Catlogo",href:"/catalogo",icon:hn},{label:"Club",href:"/minha-conta/club",icon:Vi},{label:"Conta",href:"/minha-conta",icon:Dn}];function yp({children:e,title:t,showBackButton:r}){var d;const s=wc(),a=pr(),i=e8(),{user:o}=qn(),l=async()=>{await le.auth.signOut(),de.success("At logo!"),a("/")};return i?n.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-6",children:[r&&n.jsxs("button",{onClick:()=>a(-1),className:"flex items-center gap-1 text-muted-foreground mb-4 text-sm",children:[n.jsx(In,{className:"h-4 w-4 rotate-180"}),"Voltar"]}),t&&n.jsx("h1",{className:"font-serif text-xl mb-5",children:t}),e]}),n.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border z-50",children:n.jsx("div",{className:"flex items-center justify-around h-16",children:eje.map(c=>{const u=s.pathname===c.href||c.href!=="/"&&s.pathname.startsWith(c.href),h=c.icon;return n.jsxs(Ft,{to:c.href,className:He("flex flex-col items-center justify-center gap-1 px-4 py-2 min-w-[64px]",u?"text-primary":"text-muted-foreground"),children:[n.jsx(h,{className:He("h-5 w-5",c.href==="/minha-conta/club"&&"text-accent")}),n.jsx("span",{className:"text-[10px] font-medium",children:c.label})]},c.href)})})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("div",{className:"container mx-auto px-4 py-8",children:n.jsxs("div",{className:"flex gap-8 max-w-6xl mx-auto",children:[n.jsx("aside",{className:"w-64 shrink-0",children:n.jsxs("div",{className:"sticky top-24",children:[n.jsxs("div",{className:"mb-6 px-2",children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Ol,"}),n.jsx("p",{className:"font-serif text-lg truncate",children:(d=o==null?void 0:o.email)==null?void 0:d.split("@")[0]})]}),n.jsx("nav",{className:"space-y-1",children:J_e.map(c=>{const u=s.pathname===c.href,h=c.icon;return n.jsxs(Ft,{to:c.href,className:He("flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors group",u?"bg-primary text-primary-foreground":"hover:bg-secondary text-foreground",c.highlight&&!u&&"text-accent"),children:[n.jsx(h,{className:He("h-5 w-5 shrink-0",c.highlight&&!u&&"text-accent")}),n.jsx("span",{className:"font-medium",children:c.label}),n.jsx(In,{className:He("h-4 w-4 ml-auto opacity-0 group-hover:opacity-100 transition-opacity",u&&"opacity-100")})]},c.href)})}),n.jsx("div",{className:"mt-8 pt-6 border-t",children:n.jsxs(he,{variant:"ghost",className:"w-full justify-start text-muted-foreground hover:text-destructive",onClick:l,children:[n.jsx(R6,{className:"h-5 w-5 mr-3"}),"Sair da conta"]})})]})}),n.jsxs("main",{className:"flex-1 min-w-0",children:[t&&n.jsx("h1",{className:"font-serif text-2xl mb-6",children:t}),e]})]})})]})}function tje({variant:e="full"}){const{loyalty:t,getProgressToNextTier:r,isLoading:s}=i1();if(s)return n.jsxs("div",{className:"bg-gradient-to-br from-primary/5 via-accent/5 to-primary/10 rounded-2xl p-6 animate-pulse",children:[n.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-4"}),n.jsx("div",{className:"h-8 bg-muted rounded w-24 mb-4"}),n.jsx("div",{className:"h-2 bg-muted rounded mb-4"}),n.jsx("div",{className:"h-10 bg-muted rounded"})]});const a=(t==null?void 0:t.currentTier)||"poa",i=es[a],{progress:o,pointsNeeded:l,nextTierName:d}=r((t==null?void 0:t.annualPoints)||0,a);return e==="compact"?n.jsx(Ft,{to:"/minha-conta/club",children:n.jsx("div",{className:"bg-gradient-to-r from-primary/5 to-accent/10 border border-accent/20 rounded-xl p-4 hover:shadow-md transition-shadow",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-accent/20 to-primary/20 flex items-center justify-center",children:n.jsx(Vi,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Le.Po Club"}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(wi,{className:"h-3.5 w-3.5 text-amber-500 fill-amber-500"}),n.jsx("span",{className:"font-semibold text-amber-700",children:(t==null?void 0:t.currentPoints)||0}),n.jsx("span",{children:"pontos"})]})]})]}),n.jsx(In,{className:"h-5 w-5 text-muted-foreground"})]})})}):n.jsxs("div",{className:"bg-gradient-to-br from-card via-accent/5 to-card border border-accent/20 rounded-2xl p-6 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-accent/20 to-primary/20 flex items-center justify-center",children:n.jsx(Vi,{className:"h-6 w-6 text-accent"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-serif text-lg",children:"Le.Po Club"}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Nvel ",n.jsx("span",{className:"font-medium text-foreground",children:i.name})]})]})]}),n.jsx("div",{className:"bg-card/80 rounded-xl p-4 mb-5 border border-border/50",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Seus pontos"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(wi,{className:"h-5 w-5 text-amber-500 fill-amber-500"}),n.jsx("span",{className:"font-serif text-2xl font-semibold text-amber-700",children:(t==null?void 0:t.currentPoints)||0})]})]}),d&&n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-xs text-muted-foreground",children:"Prximo nvel"}),n.jsx("p",{className:"text-sm font-medium text-accent",children:d})]})]})}),d&&n.jsxs("div",{className:"mb-5",children:[n.jsxs("div",{className:"flex items-center justify-between text-xs mb-2",children:[n.jsxs("span",{className:"text-muted-foreground",children:["Progresso para ",d]}),n.jsxs("span",{className:"font-medium text-accent",children:[l," pts restantes"]})]}),n.jsx(dg,{value:o,className:"h-2"})]}),n.jsx(Ft,{to:"/minha-conta/club",children:n.jsxs(he,{className:"w-full gap-2",variant:"outline",children:[n.jsx(Gr,{className:"h-4 w-4"}),"Ver Recompensas",n.jsx(In,{className:"h-4 w-4"})]})})]})}function Ay({title:e,description:t,href:r,icon:s,badge:a,highlight:i,status:o}){return n.jsx(Ft,{to:r,children:n.jsx("div",{className:He("bg-card border rounded-xl p-4 hover:shadow-md transition-all group",i&&"border-accent/30 bg-gradient-to-br from-card to-accent/5"),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:He("w-10 h-10 rounded-lg flex items-center justify-center shrink-0",i?"bg-gradient-to-br from-accent/20 to-primary/20":"bg-secondary"),children:n.jsx(s,{className:He("h-5 w-5",i?"text-accent":"text-muted-foreground")})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h3",{className:"font-medium text-sm",children:e}),a&&n.jsx("span",{className:"text-[10px] font-semibold px-1.5 py-0.5 rounded-full bg-accent text-accent-foreground",children:a})]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:t}),o&&n.jsx("div",{className:"mt-2",children:n.jsx("span",{className:He("text-[10px] font-medium px-2 py-1 rounded-full",o.variant==="success"&&"bg-success/10 text-success",o.variant==="warning"&&"bg-amber-100 text-amber-700",o.variant==="muted"&&"bg-muted text-muted-foreground",o.variant==="default"&&"bg-primary/10 text-primary"),children:o.label})})]}),n.jsx(In,{className:"h-5 w-5 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity shrink-0"})]})})})}function rje(){const e=pr(),{user:t,isLoading:r}=qn(),[s,a]=P.useState(null),[i,o]=P.useState(!0);P.useEffect(()=>{!r&&!t&&e("/minha-conta/auth")},[r,t,e]),P.useEffect(()=>{t?le.from("orders").select("id, status").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(1).maybeSingle().then(({data:d})=>{a(d),o(!1)}):o(!1)},[t]);const l=d=>({pendente:{label:"Aguardando pagamento",variant:"warning"},pago:{label:"Pago",variant:"success"},preparar_envio:{label:"Em preparao",variant:"default"},postado:{label:"Enviado",variant:"success"},entregue:{label:"Entregue",variant:"muted"}})[d]||{label:d,variant:"muted"};return i?n.jsx(yp,{children:n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})})}):n.jsxs(yp,{children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"font-serif text-2xl mb-1",children:"Ol! "}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Bem-vinda ao seu espao Le.Po"})]}),n.jsx("div",{className:"mb-6",children:n.jsx(tje,{variant:"full"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(Ay,{title:"Meus Pedidos",description:s?"Acompanhe seu ltimo pedido":"Voc ainda no fez pedidos",href:"/meus-pedidos",icon:Vt,status:s?l(s.status):void 0}),n.jsx(Ay,{title:"Misses do Dia",description:"Responda perguntas e ganhe pontos",href:"/minha-conta/missoes",icon:li,badge:"Novo",highlight:!0}),n.jsx(Ay,{title:"Meus Favoritos",description:"Produtos que voc amou",href:"/meus-favoritos",icon:bl,highlight:!0}),n.jsx(Ay,{title:"Sugestes pra Voc",description:"Looks personalizados para seu estilo",href:"/minhas-sugestoes",icon:li})]})]})}const nje={discount_fixed:Uo,discount_percentage:Uo,free_shipping:yn,gift:Pn,vip_access:Vi};function hM({reward:e,currentPoints:t,currentTier:r,onRedeem:s,isRedeeming:a,canRedeem:i}){const o=nje[e.type]||Pn,l=es[e.minTier]||es.poa,d=["poa","poa_gold","poa_platinum","poa_black"],c=d.indexOf(r)>=d.indexOf(e.minTier),u=t>=e.pointsCost,h=e.pointsCost-t;return n.jsxs("div",{className:He("bg-card border rounded-xl overflow-hidden transition-all",i.canRedeem&&"hover:shadow-md hover:border-accent/30",!i.canRedeem&&"opacity-70"),children:[n.jsxs("div",{className:"h-32 bg-gradient-to-br from-secondary to-muted flex items-center justify-center relative",children:[e.imageUrl?n.jsx("img",{src:e.imageUrl,alt:e.name,className:"w-full h-full object-cover"}):n.jsx(o,{className:"h-12 w-12 text-muted-foreground/50"}),e.minTier!=="poa"&&n.jsx("div",{className:"absolute top-2 right-2",children:n.jsxs("span",{className:"text-[10px] font-medium px-2 py-1 rounded-full bg-card/90 backdrop-blur border border-border",children:[l.name,"+"]})}),!e.unlimitedStock&&e.stockQty!==null&&e.stockQty<=0&&n.jsx("div",{className:"absolute inset-0 bg-background/80 flex items-center justify-center",children:n.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Esgotado"})})]}),n.jsxs("div",{className:"p-4",children:[n.jsx("h3",{className:"font-medium mb-1 line-clamp-1",children:e.name}),e.description&&n.jsx("p",{className:"text-xs text-muted-foreground mb-3 line-clamp-2",children:e.description}),n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(wi,{className:"h-4 w-4 text-amber-500 fill-amber-500"}),n.jsx("span",{className:"font-semibold text-amber-700",children:e.pointsCost}),n.jsx("span",{className:"text-sm text-muted-foreground",children:"pontos"})]}),i.canRedeem?n.jsxs(he,{className:"w-full gap-2",onClick:()=>s(e.id),disabled:a,children:[n.jsx(Pn,{className:"h-4 w-4"}),"Resgatar"]}):n.jsx("div",{className:"text-center",children:c?u?n.jsx("p",{className:"text-sm text-muted-foreground py-2",children:i.reason}):n.jsxs("div",{className:"text-center py-2",children:[n.jsx("p",{className:"text-xs text-muted-foreground",children:"Faltam"}),n.jsxs("p",{className:"font-medium text-accent",children:[h," pontos"]})]}):n.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground py-2",children:[n.jsx(Nl,{className:"h-4 w-4"}),n.jsxs("span",{children:["Nvel ",l.name," necessrio"]})]})})]})]})}const u8=P.createContext({});function h8(e){const t=P.useRef(null);return t.current===null&&(t.current=e()),t.current}const ZG=typeof window<"u",QG=ZG?P.useLayoutEffect:P.useEffect,K_=P.createContext(null);function f8(e,t){e.indexOf(t)===-1&&e.push(t)}function m8(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const xc=(e,t,r)=>r>t?t:r<e?e:r;let X_=()=>{},bp=()=>{};const sd={},JG=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function eK(e){return typeof e=="object"&&e!==null}const tK=e=>/^0[^.\s]+$/u.test(e);function p8(e){let t;return()=>(t===void 0&&(t=e()),t)}const Lo=e=>e,sje=(e,t)=>r=>t(e(r)),v1=(...e)=>e.reduce(sje),Zx=(e,t,r)=>{const s=t-e;return s===0?1:(r-e)/s};class g8{constructor(){this.subscriptions=[]}add(t){return f8(this.subscriptions,t),()=>m8(this.subscriptions,t)}notify(t,r,s){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,s);else for(let i=0;i<a;i++){const o=this.subscriptions[i];o&&o(t,r,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const cc=e=>e*1e3,Ro=e=>e/1e3;function rK(e,t){return t?e*(1e3/t):0}const nK=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,aje=1e-7,ije=12;function oje(e,t,r,s,a){let i,o,l=0;do o=t+(r-t)/2,i=nK(o,s,a)-e,i>0?r=o:t=o;while(Math.abs(i)>aje&&++l<ije);return o}function y1(e,t,r,s){if(e===t&&r===s)return Lo;const a=i=>oje(i,0,1,e,r);return i=>i===0||i===1?i:nK(a(i),t,s)}const sK=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,aK=e=>t=>1-e(1-t),iK=y1(.33,1.53,.69,.99),x8=aK(iK),oK=sK(x8),lK=e=>(e*=2)<1?.5*x8(e):.5*(2-Math.pow(2,-10*(e-1))),v8=e=>1-Math.sin(Math.acos(e)),cK=aK(v8),dK=sK(v8),lje=y1(.42,0,1,1),cje=y1(0,0,.58,1),uK=y1(.42,0,.58,1),dje=e=>Array.isArray(e)&&typeof e[0]!="number",hK=e=>Array.isArray(e)&&typeof e[0]=="number",fM={linear:Lo,easeIn:lje,easeInOut:uK,easeOut:cje,circIn:v8,circInOut:dK,circOut:cK,backIn:x8,backInOut:oK,backOut:iK,anticipate:lK},uje=e=>typeof e=="string",mM=e=>{if(hK(e)){bp(e.length===4,"Cubic bezier arrays must contain four numerical values.","cubic-bezier-length");const[t,r,s,a]=e;return y1(t,r,s,a)}else if(uje(e))return bp(fM[e]!==void 0,`Invalid easing type '${e}'`,"invalid-easing-type"),fM[e];return e},Ty=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],pM={value:null,addProjectionMetrics:null};function hje(e,t){let r=new Set,s=new Set,a=!1,i=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1},d=0;function c(h){o.has(h)&&(u.schedule(h),e()),d++,h(l)}const u={schedule:(h,f=!1,m=!1)=>{const g=m&&a?r:s;return f&&o.add(h),g.has(h)||g.add(h),h},cancel:h=>{s.delete(h),o.delete(h)},process:h=>{if(l=h,a){i=!0;return}a=!0,[r,s]=[s,r],r.forEach(c),t&&pM.value&&pM.value.frameloop[t].push(d),d=0,r.clear(),a=!1,i&&(i=!1,u.process(h))}};return u}const fje=40;function fK(e,t){let r=!1,s=!0;const a={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,o=Ty.reduce((b,j)=>(b[j]=hje(i,t?j:void 0),b),{}),{setup:l,read:d,resolveKeyframes:c,preUpdate:u,update:h,preRender:f,render:m,postRender:p}=o,g=()=>{const b=sd.useManualTiming?a.timestamp:performance.now();r=!1,sd.useManualTiming||(a.delta=s?1e3/60:Math.max(Math.min(b-a.timestamp,fje),1)),a.timestamp=b,a.isProcessing=!0,l.process(a),d.process(a),c.process(a),u.process(a),h.process(a),f.process(a),m.process(a),p.process(a),a.isProcessing=!1,r&&t&&(s=!1,e(g))},x=()=>{r=!0,s=!0,a.isProcessing||e(g)};return{schedule:Ty.reduce((b,j)=>{const T=o[j];return b[j]=(O,R=!1,D=!1)=>(r||x(),T.schedule(O,R,D)),b},{}),cancel:b=>{for(let j=0;j<Ty.length;j++)o[Ty[j]].cancel(b)},state:a,steps:o}}const{schedule:fs,cancel:Eu,state:Ba,steps:T3}=fK(typeof requestAnimationFrame<"u"?requestAnimationFrame:Lo,!0);let xb;function mje(){xb=void 0}const xi={now:()=>(xb===void 0&&xi.set(Ba.isProcessing||sd.useManualTiming?Ba.timestamp:performance.now()),xb),set:e=>{xb=e,queueMicrotask(mje)}},mK=e=>t=>typeof t=="string"&&t.startsWith(e),pK=mK("--"),pje=mK("var(--"),y8=e=>pje(e)?gje.test(e.split("/*")[0].trim()):!1,gje=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function gM(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const bg={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Qx={...bg,transform:e=>xc(0,1,e)},Py={...bg,default:1},Y0=e=>Math.round(e*1e5)/1e5,b8=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function xje(e){return e==null}const vje=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,w8=(e,t)=>r=>!!(typeof r=="string"&&vje.test(r)&&r.startsWith(e)||t&&!xje(r)&&Object.prototype.hasOwnProperty.call(r,t)),gK=(e,t,r)=>s=>{if(typeof s!="string")return s;const[a,i,o,l]=s.match(b8);return{[e]:parseFloat(a),[t]:parseFloat(i),[r]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},yje=e=>xc(0,255,e),P3={...bg,transform:e=>Math.round(yje(e))},wh={test:w8("rgb","red"),parse:gK("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:s=1})=>"rgba("+P3.transform(e)+", "+P3.transform(t)+", "+P3.transform(r)+", "+Y0(Qx.transform(s))+")"};function bje(e){let t="",r="",s="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),s=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),s=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,s+=s,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(s,16),alpha:a?parseInt(a,16)/255:1}}const kC={test:w8("#"),parse:bje,transform:wh.transform},b1=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Pd=b1("deg"),dc=b1("%"),hr=b1("px"),wje=b1("vh"),_je=b1("vw"),xM={...dc,parse:e=>dc.parse(e)/100,transform:e=>dc.transform(e*100)},bm={test:w8("hsl","hue"),parse:gK("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:s=1})=>"hsla("+Math.round(e)+", "+dc.transform(Y0(t))+", "+dc.transform(Y0(r))+", "+Y0(Qx.transform(s))+")"},Ks={test:e=>wh.test(e)||kC.test(e)||bm.test(e),parse:e=>wh.test(e)?wh.parse(e):bm.test(e)?bm.parse(e):kC.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?wh.transform(e):bm.transform(e),getAnimatableNone:e=>{const t=Ks.parse(e);return t.alpha=0,Ks.transform(t)}},jje=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Nje(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(b8))==null?void 0:t.length)||0)+(((r=e.match(jje))==null?void 0:r.length)||0)>0}const xK="number",vK="color",Sje="var",Cje="var(",vM="${}",Eje=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Jx(e){const t=e.toString(),r=[],s={color:[],number:[],var:[]},a=[];let i=0;const l=t.replace(Eje,d=>(Ks.test(d)?(s.color.push(i),a.push(vK),r.push(Ks.parse(d))):d.startsWith(Cje)?(s.var.push(i),a.push(Sje),r.push(d)):(s.number.push(i),a.push(xK),r.push(parseFloat(d))),++i,vM)).split(vM);return{values:r,split:l,indexes:s,types:a}}function yK(e){return Jx(e).values}function bK(e){const{split:t,types:r}=Jx(e),s=t.length;return a=>{let i="";for(let o=0;o<s;o++)if(i+=t[o],a[o]!==void 0){const l=r[o];l===xK?i+=Y0(a[o]):l===vK?i+=Ks.transform(a[o]):i+=a[o]}return i}}const kje=e=>typeof e=="number"?0:Ks.test(e)?Ks.getAnimatableNone(e):e;function Aje(e){const t=yK(e);return bK(e)(t.map(kje))}const ku={test:Nje,parse:yK,createTransformer:bK,getAnimatableNone:Aje};function O3(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Tje({hue:e,saturation:t,lightness:r,alpha:s}){e/=360,t/=100,r/=100;let a=0,i=0,o=0;if(!t)a=i=o=r;else{const l=r<.5?r*(1+t):r+t-r*t,d=2*r-l;a=O3(d,l,e+1/3),i=O3(d,l,e),o=O3(d,l,e-1/3)}return{red:Math.round(a*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}function Nw(e,t){return r=>r>0?t:e}const js=(e,t,r)=>e+(t-e)*r,R3=(e,t,r)=>{const s=e*e,a=r*(t*t-s)+s;return a<0?0:Math.sqrt(a)},Pje=[kC,wh,bm],Oje=e=>Pje.find(t=>t.test(e));function yM(e){const t=Oje(e);if(X_(!!t,`'${e}' is not an animatable color. Use the equivalent color code instead.`,"color-not-animatable"),!t)return!1;let r=t.parse(e);return t===bm&&(r=Tje(r)),r}const bM=(e,t)=>{const r=yM(e),s=yM(t);if(!r||!s)return Nw(e,t);const a={...r};return i=>(a.red=R3(r.red,s.red,i),a.green=R3(r.green,s.green,i),a.blue=R3(r.blue,s.blue,i),a.alpha=js(r.alpha,s.alpha,i),wh.transform(a))},AC=new Set(["none","hidden"]);function Rje(e,t){return AC.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function Mje(e,t){return r=>js(e,t,r)}function _8(e){return typeof e=="number"?Mje:typeof e=="string"?y8(e)?Nw:Ks.test(e)?bM:Lje:Array.isArray(e)?wK:typeof e=="object"?Ks.test(e)?bM:Ije:Nw}function wK(e,t){const r=[...e],s=r.length,a=e.map((i,o)=>_8(i)(i,t[o]));return i=>{for(let o=0;o<s;o++)r[o]=a[o](i);return r}}function Ije(e,t){const r={...e,...t},s={};for(const a in r)e[a]!==void 0&&t[a]!==void 0&&(s[a]=_8(e[a])(e[a],t[a]));return a=>{for(const i in s)r[i]=s[i](a);return r}}function Dje(e,t){const r=[],s={color:0,var:0,number:0};for(let a=0;a<t.values.length;a++){const i=t.types[a],o=e.indexes[i][s[i]],l=e.values[o]??0;r[a]=l,s[i]++}return r}const Lje=(e,t)=>{const r=ku.createTransformer(t),s=Jx(e),a=Jx(t);return s.indexes.var.length===a.indexes.var.length&&s.indexes.color.length===a.indexes.color.length&&s.indexes.number.length>=a.indexes.number.length?AC.has(e)&&!a.values.length||AC.has(t)&&!s.values.length?Rje(e,t):v1(wK(Dje(s,a),a.values),r):(X_(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`,"complex-values-different"),Nw(e,t))};function _K(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?js(e,t,r):_8(e)(e,t)}const Bje=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>fs.update(t,r),stop:()=>Eu(t),now:()=>Ba.isProcessing?Ba.timestamp:xi.now()}},jK=(e,t,r=10)=>{let s="";const a=Math.max(Math.round(t/r),2);for(let i=0;i<a;i++)s+=Math.round(e(i/(a-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},Sw=2e4;function j8(e){let t=0;const r=50;let s=e.next(t);for(;!s.done&&t<Sw;)t+=r,s=e.next(t);return t>=Sw?1/0:t}function $je(e,t=100,r){const s=r({...e,keyframes:[0,t]}),a=Math.min(j8(s),Sw);return{type:"keyframes",ease:i=>s.next(a*i).value/t,duration:Ro(a)}}const Fje=5;function NK(e,t,r){const s=Math.max(t-Fje,0);return rK(r-e(s),t-s)}const bs={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},M3=.001;function zje({duration:e=bs.duration,bounce:t=bs.bounce,velocity:r=bs.velocity,mass:s=bs.mass}){let a,i;X_(e<=cc(bs.maxDuration),"Spring duration must be 10 seconds or less","spring-duration-limit");let o=1-t;o=xc(bs.minDamping,bs.maxDamping,o),e=xc(bs.minDuration,bs.maxDuration,Ro(e)),o<1?(a=c=>{const u=c*o,h=u*e,f=u-r,m=TC(c,o),p=Math.exp(-h);return M3-f/m*p},i=c=>{const h=c*o*e,f=h*r+r,m=Math.pow(o,2)*Math.pow(c,2)*e,p=Math.exp(-h),g=TC(Math.pow(c,2),o);return(-a(c)+M3>0?-1:1)*((f-m)*p)/g}):(a=c=>{const u=Math.exp(-c*e),h=(c-r)*e+1;return-M3+u*h},i=c=>{const u=Math.exp(-c*e),h=(r-c)*(e*e);return u*h});const l=5/e,d=Vje(a,i,l);if(e=cc(e),isNaN(d))return{stiffness:bs.stiffness,damping:bs.damping,duration:e};{const c=Math.pow(d,2)*s;return{stiffness:c,damping:o*2*Math.sqrt(s*c),duration:e}}}const Uje=12;function Vje(e,t,r){let s=r;for(let a=1;a<Uje;a++)s=s-e(s)/t(s);return s}function TC(e,t){return e*Math.sqrt(1-t*t)}const qje=["duration","bounce"],Wje=["stiffness","damping","mass"];function wM(e,t){return t.some(r=>e[r]!==void 0)}function Hje(e){let t={velocity:bs.velocity,stiffness:bs.stiffness,damping:bs.damping,mass:bs.mass,isResolvedFromDuration:!1,...e};if(!wM(e,Wje)&&wM(e,qje))if(e.visualDuration){const r=e.visualDuration,s=2*Math.PI/(r*1.2),a=s*s,i=2*xc(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:bs.mass,stiffness:a,damping:i}}else{const r=zje(e);t={...t,...r,mass:bs.mass},t.isResolvedFromDuration=!0}return t}function Cw(e=bs.visualDuration,t=bs.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:s,restDelta:a}=r;const i=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],l={done:!1,value:i},{stiffness:d,damping:c,mass:u,duration:h,velocity:f,isResolvedFromDuration:m}=Hje({...r,velocity:-Ro(r.velocity||0)}),p=f||0,g=c/(2*Math.sqrt(d*u)),x=o-i,v=Ro(Math.sqrt(d/u)),y=Math.abs(x)<5;s||(s=y?bs.restSpeed.granular:bs.restSpeed.default),a||(a=y?bs.restDelta.granular:bs.restDelta.default);let b;if(g<1){const T=TC(v,g);b=O=>{const R=Math.exp(-g*v*O);return o-R*((p+g*v*x)/T*Math.sin(T*O)+x*Math.cos(T*O))}}else if(g===1)b=T=>o-Math.exp(-v*T)*(x+(p+v*x)*T);else{const T=v*Math.sqrt(g*g-1);b=O=>{const R=Math.exp(-g*v*O),D=Math.min(T*O,300);return o-R*((p+g*v*x)*Math.sinh(D)+T*x*Math.cosh(D))/T}}const j={calculatedDuration:m&&h||null,next:T=>{const O=b(T);if(m)l.done=T>=h;else{let R=T===0?p:0;g<1&&(R=T===0?cc(p):NK(b,T,O));const D=Math.abs(R)<=s,B=Math.abs(o-O)<=a;l.done=D&&B}return l.value=l.done?o:O,l},toString:()=>{const T=Math.min(j8(j),Sw),O=jK(R=>j.next(T*R).value,T,30);return T+"ms "+O},toTransition:()=>{}};return j}Cw.applyToOptions=e=>{const t=$je(e,100,Cw);return e.ease=t.ease,e.duration=cc(t.duration),e.type="keyframes",e};function PC({keyframes:e,velocity:t=0,power:r=.8,timeConstant:s=325,bounceDamping:a=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:d,restDelta:c=.5,restSpeed:u}){const h=e[0],f={done:!1,value:h},m=D=>l!==void 0&&D<l||d!==void 0&&D>d,p=D=>l===void 0?d:d===void 0||Math.abs(l-D)<Math.abs(d-D)?l:d;let g=r*t;const x=h+g,v=o===void 0?x:o(x);v!==x&&(g=v-h);const y=D=>-g*Math.exp(-D/s),b=D=>v+y(D),j=D=>{const B=y(D),q=b(D);f.done=Math.abs(B)<=c,f.value=f.done?v:q};let T,O;const R=D=>{m(f.value)&&(T=D,O=Cw({keyframes:[f.value,p(f.value)],velocity:NK(b,D,f.value),damping:a,stiffness:i,restDelta:c,restSpeed:u}))};return R(0),{calculatedDuration:null,next:D=>{let B=!1;return!O&&T===void 0&&(B=!0,j(D),R(D)),T!==void 0&&D>=T?O.next(D-T):(!B&&j(D),f)}}}function Gje(e,t,r){const s=[],a=r||sd.mix||_K,i=e.length-1;for(let o=0;o<i;o++){let l=a(e[o],e[o+1]);if(t){const d=Array.isArray(t)?t[o]||Lo:t;l=v1(d,l)}s.push(l)}return s}function Kje(e,t,{clamp:r=!0,ease:s,mixer:a}={}){const i=e.length;if(bp(i===t.length,"Both input and output ranges must be the same length","range-length"),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const l=Gje(t,s,a),d=l.length,c=u=>{if(o&&u<e[0])return t[0];let h=0;if(d>1)for(;h<e.length-2&&!(u<e[h+1]);h++);const f=Zx(e[h],e[h+1],u);return l[h](f)};return r?u=>c(xc(e[0],e[i-1],u)):c}function Xje(e,t){const r=e[e.length-1];for(let s=1;s<=t;s++){const a=Zx(0,t,s);e.push(js(r,1,a))}}function Yje(e){const t=[0];return Xje(t,e.length-1),t}function Zje(e,t){return e.map(r=>r*t)}function Qje(e,t){return e.map(()=>t||uK).splice(0,e.length-1)}function Z0({duration:e=300,keyframes:t,times:r,ease:s="easeInOut"}){const a=dje(s)?s.map(mM):mM(s),i={done:!1,value:t[0]},o=Zje(r&&r.length===t.length?r:Yje(t),e),l=Kje(o,t,{ease:Array.isArray(a)?a:Qje(t,a)});return{calculatedDuration:e,next:d=>(i.value=l(d),i.done=d>=e,i)}}const Jje=e=>e!==null;function N8(e,{repeat:t,repeatType:r="loop"},s,a=1){const i=e.filter(Jje),l=a<0||t&&r!=="loop"&&t%2===1?0:i.length-1;return!l||s===void 0?i[l]:s}const eNe={decay:PC,inertia:PC,tween:Z0,keyframes:Z0,spring:Cw};function SK(e){typeof e.type=="string"&&(e.type=eNe[e.type])}class S8{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const tNe=e=>e/100;class C8 extends S8{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,a;const{motionValue:r}=this.options;r&&r.updatedAt!==xi.now()&&this.tick(xi.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(a=(s=this.options).onStop)==null||a.call(s))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;SK(t);const{type:r=Z0,repeat:s=0,repeatDelay:a=0,repeatType:i,velocity:o=0}=t;let{keyframes:l}=t;const d=r||Z0;d!==Z0&&typeof l[0]!="number"&&(this.mixKeyframes=v1(tNe,_K(l[0],l[1])),l=[0,100]);const c=d({...t,keyframes:l});i==="mirror"&&(this.mirroredGenerator=d({...t,keyframes:[...l].reverse(),velocity:-o})),c.calculatedDuration===null&&(c.calculatedDuration=j8(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+a,this.totalDuration=this.resolvedDuration*(s+1)-a,this.generator=c}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:s,totalDuration:a,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:d}=this;if(this.startTime===null)return s.next(0);const{delay:c=0,keyframes:u,repeat:h,repeatType:f,repeatDelay:m,type:p,onUpdate:g,finalKeyframe:x}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-a/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const v=this.currentTime-c*(this.playbackSpeed>=0?1:-1),y=this.playbackSpeed>=0?v<0:v>a;this.currentTime=Math.max(v,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=a);let b=this.currentTime,j=s;if(h){const D=Math.min(this.currentTime,a)/l;let B=Math.floor(D),q=D%1;!q&&D>=1&&(q=1),q===1&&B--,B=Math.min(B,h+1),!!(B%2)&&(f==="reverse"?(q=1-q,m&&(q-=m/l)):f==="mirror"&&(j=o)),b=xc(0,1,q)*l}const T=y?{done:!1,value:u[0]}:j.next(b);i&&(T.value=i(T.value));let{done:O}=T;!y&&d!==null&&(O=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&O);return R&&p!==PC&&(T.value=N8(u,this.options,x,this.speed)),g&&g(T.value),R&&this.finish(),T}then(t,r){return this.finished.then(t,r)}get duration(){return Ro(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Ro(t)}get time(){return Ro(this.currentTime)}set time(t){var r;t=cc(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(xi.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Ro(this.currentTime))}play(){var a,i;if(this.isStopped)return;const{driver:t=Bje,startTime:r}=this.options;this.driver||(this.driver=t(o=>this.tick(o))),(i=(a=this.options).onPlay)==null||i.call(a);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(xi.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function rNe(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const _h=e=>e*180/Math.PI,OC=e=>{const t=_h(Math.atan2(e[1],e[0]));return RC(t)},nNe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:OC,rotateZ:OC,skewX:e=>_h(Math.atan(e[1])),skewY:e=>_h(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},RC=e=>(e=e%360,e<0&&(e+=360),e),_M=OC,jM=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),NM=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),sNe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:jM,scaleY:NM,scale:e=>(jM(e)+NM(e))/2,rotateX:e=>RC(_h(Math.atan2(e[6],e[5]))),rotateY:e=>RC(_h(Math.atan2(-e[2],e[0]))),rotateZ:_M,rotate:_M,skewX:e=>_h(Math.atan(e[4])),skewY:e=>_h(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function MC(e){return e.includes("scale")?1:0}function IC(e,t){if(!e||e==="none")return MC(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,a;if(r)s=sNe,a=r;else{const l=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=nNe,a=l}if(!a)return MC(t);const i=s[t],o=a[1].split(",").map(iNe);return typeof i=="function"?i(o):o[i]}const aNe=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return IC(r,t)};function iNe(e){return parseFloat(e.trim())}const wg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],_g=new Set(wg),SM=e=>e===bg||e===hr,oNe=new Set(["x","y","z"]),lNe=wg.filter(e=>!oNe.has(e));function cNe(e){const t=[];return lNe.forEach(r=>{const s=e.getValue(r);s!==void 0&&(t.push([r,s.get()]),s.set(r.startsWith("scale")?1:0))}),t}const Jd={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>IC(t,"x"),y:(e,{transform:t})=>IC(t,"y")};Jd.translateX=Jd.x;Jd.translateY=Jd.y;const Bh=new Set;let DC=!1,LC=!1,BC=!1;function CK(){if(LC){const e=Array.from(Bh).filter(s=>s.needsMeasurement),t=new Set(e.map(s=>s.element)),r=new Map;t.forEach(s=>{const a=cNe(s);a.length&&(r.set(s,a),s.render())}),e.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const a=r.get(s);a&&a.forEach(([i,o])=>{var l;(l=s.getValue(i))==null||l.set(o)})}),e.forEach(s=>s.measureEndState()),e.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}LC=!1,DC=!1,Bh.forEach(e=>e.complete(BC)),Bh.clear()}function EK(){Bh.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(LC=!0)})}function dNe(){BC=!0,EK(),CK(),BC=!1}class E8{constructor(t,r,s,a,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=s,this.motionValue=a,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Bh.add(this),DC||(DC=!0,fs.read(EK),fs.resolveKeyframes(CK))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:s,motionValue:a}=this;if(t[0]===null){const i=a==null?void 0:a.get(),o=t[t.length-1];if(i!==void 0)t[0]=i;else if(s&&r){const l=s.readValue(r,o);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=o),a&&i===void 0&&a.set(t[0])}rNe(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Bh.delete(this)}cancel(){this.state==="scheduled"&&(Bh.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const uNe=e=>e.startsWith("--");function hNe(e,t,r){uNe(t)?e.style.setProperty(t,r):e.style[t]=r}const fNe=p8(()=>window.ScrollTimeline!==void 0),mNe={};function pNe(e,t){const r=p8(e);return()=>mNe[t]??r()}const kK=pNe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),O0=([e,t,r,s])=>`cubic-bezier(${e}, ${t}, ${r}, ${s})`,CM={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:O0([0,.65,.55,1]),circOut:O0([.55,0,1,.45]),backIn:O0([.31,.01,.66,-.59]),backOut:O0([.33,1.53,.69,.99])};function AK(e,t){if(e)return typeof e=="function"?kK()?jK(e,t):"ease-out":hK(e)?O0(e):Array.isArray(e)?e.map(r=>AK(r,t)||CM.easeOut):CM[e]}function gNe(e,t,r,{delay:s=0,duration:a=300,repeat:i=0,repeatType:o="loop",ease:l="easeOut",times:d}={},c=void 0){const u={[t]:r};d&&(u.offset=d);const h=AK(l,a);Array.isArray(h)&&(u.easing=h);const f={delay:s,duration:a,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return c&&(f.pseudoElement=c),e.animate(u,f)}function TK(e){return typeof e=="function"&&"applyToOptions"in e}function xNe({type:e,...t}){return TK(e)&&kK()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class vNe extends S8{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:r,name:s,keyframes:a,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:l,onComplete:d}=t;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=t,bp(typeof t.type!="string",`Mini animate() doesn't support "type" as a string.`,"mini-spring");const c=xNe(t);this.animation=gNe(r,s,a,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=N8(a,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(u):hNe(r,s,u),this.animation.cancel()}d==null||d(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,s;const t=((s=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:s.call(r).duration)||0;return Ro(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Ro(t)}get time(){return Ro(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=cc(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&fNe()?(this.animation.timeline=t,Lo):r(this)}}const PK={anticipate:lK,backInOut:oK,circInOut:dK};function yNe(e){return e in PK}function bNe(e){typeof e.ease=="string"&&yNe(e.ease)&&(e.ease=PK[e.ease])}const I3=10;class wNe extends vNe{constructor(t){bNe(t),SK(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:s,onComplete:a,element:i,...o}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const l=new C8({...o,autoplay:!1}),d=Math.max(I3,xi.now()-this.startTime),c=xc(0,I3,d-I3);r.setWithVelocity(l.sample(Math.max(0,d-c)).value,l.sample(d).value,c),l.stop()}}const EM=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(ku.test(e)||e==="0")&&!e.startsWith("url("));function _Ne(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function jNe(e,t,r,s){const a=e[0];if(a===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],o=EM(a,t),l=EM(i,t);return X_(o===l,`You are trying to animate ${t} from "${a}" to "${i}". "${o?i:a}" is not an animatable value.`,"value-not-animatable"),!o||!l?!1:_Ne(e)||(r==="spring"||TK(r))&&s}function $C(e){e.duration=0,e.type="keyframes"}const NNe=new Set(["opacity","clipPath","filter","transform"]),SNe=p8(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function CNe(e){var u;const{motionValue:t,name:r,repeatDelay:s,repeatType:a,damping:i,type:o}=e;if(!(((u=t==null?void 0:t.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:d,transformTemplate:c}=t.owner.getProps();return SNe()&&r&&NNe.has(r)&&(r!=="transform"||!c)&&!d&&!s&&a!=="mirror"&&i!==0&&o!=="inertia"}const ENe=40;class kNe extends S8{constructor({autoplay:t=!0,delay:r=0,type:s="keyframes",repeat:a=0,repeatDelay:i=0,repeatType:o="loop",keyframes:l,name:d,motionValue:c,element:u,...h}){var p;super(),this.stop=()=>{var g,x;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(x=this.keyframeResolver)==null||x.cancel()},this.createdAt=xi.now();const f={autoplay:t,delay:r,type:s,repeat:a,repeatDelay:i,repeatType:o,name:d,motionValue:c,element:u,...h},m=(u==null?void 0:u.KeyframeResolver)||E8;this.keyframeResolver=new m(l,(g,x,v)=>this.onKeyframesResolved(g,x,f,!v),d,c,u),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(t,r,s,a){var x,v;this.keyframeResolver=void 0;const{name:i,type:o,velocity:l,delay:d,isHandoff:c,onUpdate:u}=s;this.resolvedAt=xi.now(),jNe(t,i,o,l)||((sd.instantAnimations||!d)&&(u==null||u(N8(t,s,r))),t[0]=t[t.length-1],$C(s),s.repeat=0);const f={startTime:a?this.resolvedAt?this.resolvedAt-this.createdAt>ENe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...s,keyframes:t},m=!c&&CNe(f),p=(v=(x=f.motionValue)==null?void 0:x.owner)==null?void 0:v.current,g=m?new wNe({...f,element:p}):new C8(f);g.finished.then(()=>{this.notifyFinished()}).catch(Lo),this.pendingTimeline&&(this.stopTimeline=g.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=g}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),dNe()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}function OK(e,t,r,s=0,a=1){const i=Array.from(e).sort((c,u)=>c.sortNodePosition(u)).indexOf(t),o=e.size,l=(o-1)*s;return typeof r=="function"?r(i,o):a===1?i*s:l-i*s}const ANe=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function TNe(e){const t=ANe.exec(e);if(!t)return[,];const[,r,s,a]=t;return[`--${r??s}`,a]}const PNe=4;function RK(e,t,r=1){bp(r<=PNe,`Max CSS variable fallback depth detected in property "${e}". This may indicate a circular fallback dependency.`,"max-css-var-depth");const[s,a]=TNe(e);if(!s)return;const i=window.getComputedStyle(t).getPropertyValue(s);if(i){const o=i.trim();return JG(o)?parseFloat(o):o}return y8(a)?RK(a,t,r+1):a}const ONe={type:"spring",stiffness:500,damping:25,restSpeed:10},RNe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),MNe={type:"keyframes",duration:.8},INe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},DNe=(e,{keyframes:t})=>t.length>2?MNe:_g.has(e)?e.startsWith("scale")?RNe(t[1]):ONe:INe,LNe=e=>e!==null;function BNe(e,{repeat:t,repeatType:r="loop"},s){const a=e.filter(LNe),i=t&&r!=="loop"&&t%2===1?0:a.length-1;return!i||s===void 0?a[i]:s}function k8(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}function $Ne({when:e,delay:t,delayChildren:r,staggerChildren:s,staggerDirection:a,repeat:i,repeatType:o,repeatDelay:l,from:d,elapsed:c,...u}){return!!Object.keys(u).length}const A8=(e,t,r,s={},a,i)=>o=>{const l=k8(s,e)||{},d=l.delay||s.delay||0;let{elapsed:c=0}=s;c=c-cc(d);const u={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...l,delay:-c,onUpdate:f=>{t.set(f),l.onUpdate&&l.onUpdate(f)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:e,motionValue:t,element:i?void 0:a};$Ne(l)||Object.assign(u,DNe(e,u)),u.duration&&(u.duration=cc(u.duration)),u.repeatDelay&&(u.repeatDelay=cc(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&($C(u),u.delay===0&&(h=!0)),(sd.instantAnimations||sd.skipAnimations)&&(h=!0,$C(u),u.delay=0),u.allowFlatten=!l.type&&!l.ease,h&&!i&&t.get()!==void 0){const f=BNe(u.keyframes,l);if(f!==void 0){fs.update(()=>{u.onUpdate(f),u.onComplete()});return}}return l.isSync?new C8(u):new kNe(u)};function kM(e){const t=[{},{}];return e==null||e.values.forEach((r,s)=>{t[0][s]=r.get(),t[1][s]=r.getVelocity()}),t}function T8(e,t,r,s){if(typeof t=="function"){const[a,i]=kM(s);t=t(r!==void 0?r:e.custom,a,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[a,i]=kM(s);t=t(r!==void 0?r:e.custom,a,i)}return t}function zm(e,t,r){const s=e.getProps();return T8(s,t,r!==void 0?r:s.custom,e)}const MK=new Set(["width","height","top","left","right","bottom",...wg]),AM=30,FNe=e=>!isNaN(parseFloat(e));class zNe{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var i;const a=xi.now();if(this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=xi.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=FNe(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new g8);const s=this.events[t].add(r);return t==="change"?()=>{s(),fs.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,s){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=xi.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>AM)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,AM);return rK(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function wp(e,t){return new zNe(e,t)}const FC=e=>Array.isArray(e);function UNe(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,wp(r))}function VNe(e){return FC(e)?e[e.length-1]||0:e}function qNe(e,t){const r=zm(e,t);let{transitionEnd:s={},transition:a={},...i}=r||{};i={...i,...s};for(const o in i){const l=VNe(i[o]);UNe(e,o,l)}}const si=e=>!!(e&&e.getVelocity);function WNe(e){return!!(si(e)&&e.add)}function zC(e,t){const r=e.getValue("willChange");if(WNe(r))return r.add(t);if(!r&&sd.WillChange){const s=new sd.WillChange("auto");e.addValue("willChange",s),s.add(t)}}function P8(e){return e.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)}const HNe="framerAppearId",IK="data-"+P8(HNe);function DK(e){return e.props[IK]}function GNe({protectedKeys:e,needsAnimating:t},r){const s=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,s}function LK(e,t,{delay:r=0,transitionOverride:s,type:a}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:o,...l}=t;const d=i==null?void 0:i.reduceMotion;s&&(i=s);const c=[],u=a&&e.animationState&&e.animationState.getState()[a];for(const h in l){const f=e.getValue(h,e.latestValues[h]??null),m=l[h];if(m===void 0||u&&GNe(u,h))continue;const p={delay:r,...k8(i||{},h)},g=f.get();if(g!==void 0&&!f.isAnimating&&!Array.isArray(m)&&m===g&&!p.velocity)continue;let x=!1;if(window.MotionHandoffAnimation){const b=DK(e);if(b){const j=window.MotionHandoffAnimation(b,h,fs);j!==null&&(p.startTime=j,x=!0)}}zC(e,h);const v=d??e.shouldReduceMotion;f.start(A8(h,f,m,v&&MK.has(h)?{type:!1}:p,e,x));const y=f.animation;y&&c.push(y)}return o&&Promise.all(c).then(()=>{fs.update(()=>{o&&qNe(e,o)})}),c}function UC(e,t,r={}){var d;const s=zm(e,t,r.type==="exit"?(d=e.presenceContext)==null?void 0:d.custom:void 0);let{transition:a=e.getDefaultTransition()||{}}=s||{};r.transitionOverride&&(a=r.transitionOverride);const i=s?()=>Promise.all(LK(e,s,r)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:f}=a;return KNe(e,t,c,u,h,f,r)}:()=>Promise.resolve(),{when:l}=a;if(l){const[c,u]=l==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(r.delay)])}function KNe(e,t,r=0,s=0,a=0,i=1,o){const l=[];for(const d of e.variantChildren)d.notify("AnimationStart",t),l.push(UC(d,t,{...o,delay:r+(typeof s=="function"?0:s)+OK(e.variantChildren,d,s,a,i)}).then(()=>d.notify("AnimationComplete",t)));return Promise.all(l)}function XNe(e,t,r={}){e.notify("AnimationStart",t);let s;if(Array.isArray(t)){const a=t.map(i=>UC(e,i,r));s=Promise.all(a)}else if(typeof t=="string")s=UC(e,t,r);else{const a=typeof t=="function"?zm(e,t,r.custom):t;s=Promise.all(LK(e,a,r))}return s.then(()=>{e.notify("AnimationComplete",t)})}const YNe={test:e=>e==="auto",parse:e=>e},BK=e=>t=>t.test(e),$K=[bg,hr,dc,Pd,_je,wje,YNe],TM=e=>$K.find(BK(e));function ZNe(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||tK(e):!0}const QNe=new Set(["brightness","contrast","saturate","opacity"]);function JNe(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[s]=r.match(b8)||[];if(!s)return e;const a=r.replace(s,"");let i=QNe.has(t)?1:0;return s!==r&&(i*=100),t+"("+i+a+")"}const e3e=/\b([a-z-]*)\(.*?\)/gu,VC={...ku,getAnimatableNone:e=>{const t=e.match(e3e);return t?t.map(JNe).join(" "):e}},PM={...bg,transform:Math.round},t3e={rotate:Pd,rotateX:Pd,rotateY:Pd,rotateZ:Pd,scale:Py,scaleX:Py,scaleY:Py,scaleZ:Py,skew:Pd,skewX:Pd,skewY:Pd,distance:hr,translateX:hr,translateY:hr,translateZ:hr,x:hr,y:hr,z:hr,perspective:hr,transformPerspective:hr,opacity:Qx,originX:xM,originY:xM,originZ:hr},O8={borderWidth:hr,borderTopWidth:hr,borderRightWidth:hr,borderBottomWidth:hr,borderLeftWidth:hr,borderRadius:hr,borderTopLeftRadius:hr,borderTopRightRadius:hr,borderBottomRightRadius:hr,borderBottomLeftRadius:hr,width:hr,maxWidth:hr,height:hr,maxHeight:hr,top:hr,right:hr,bottom:hr,left:hr,inset:hr,insetBlock:hr,insetBlockStart:hr,insetBlockEnd:hr,insetInline:hr,insetInlineStart:hr,insetInlineEnd:hr,padding:hr,paddingTop:hr,paddingRight:hr,paddingBottom:hr,paddingLeft:hr,paddingBlock:hr,paddingBlockStart:hr,paddingBlockEnd:hr,paddingInline:hr,paddingInlineStart:hr,paddingInlineEnd:hr,margin:hr,marginTop:hr,marginRight:hr,marginBottom:hr,marginLeft:hr,marginBlock:hr,marginBlockStart:hr,marginBlockEnd:hr,marginInline:hr,marginInlineStart:hr,marginInlineEnd:hr,fontSize:hr,backgroundPositionX:hr,backgroundPositionY:hr,...t3e,zIndex:PM,fillOpacity:Qx,strokeOpacity:Qx,numOctaves:PM},r3e={...O8,color:Ks,backgroundColor:Ks,outlineColor:Ks,fill:Ks,stroke:Ks,borderColor:Ks,borderTopColor:Ks,borderRightColor:Ks,borderBottomColor:Ks,borderLeftColor:Ks,filter:VC,WebkitFilter:VC},FK=e=>r3e[e];function zK(e,t){let r=FK(e);return r!==VC&&(r=ku),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const n3e=new Set(["auto","none","0"]);function s3e(e,t,r){let s=0,a;for(;s<e.length&&!a;){const i=e[s];typeof i=="string"&&!n3e.has(i)&&Jx(i).values.length&&(a=e[s]),s++}if(a&&r)for(const i of t)e[i]=zK(r,a)}class a3e extends E8{constructor(t,r,s,a,i){super(t,r,s,a,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:s}=this;if(!r||!r.current)return;super.readKeyframes();for(let u=0;u<t.length;u++){let h=t[u];if(typeof h=="string"&&(h=h.trim(),y8(h))){const f=RK(h,r.current);f!==void 0&&(t[u]=f),u===t.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!MK.has(s)||t.length!==2)return;const[a,i]=t,o=TM(a),l=TM(i),d=gM(a),c=gM(i);if(d!==c&&Jd[s]){this.needsMeasurement=!0;return}if(o!==l)if(SM(o)&&SM(l))for(let u=0;u<t.length;u++){const h=t[u];typeof h=="string"&&(t[u]=parseFloat(h))}else Jd[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,s=[];for(let a=0;a<t.length;a++)(t[a]===null||ZNe(t[a]))&&s.push(a);s.length&&s3e(t,s,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Jd[s](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const a=r[r.length-1];a!==void 0&&t.getValue(s,a).jump(a,!1)}measureEndState(){var l;const{element:t,name:r,unresolvedKeyframes:s}=this;if(!t||!t.current)return;const a=t.getValue(r);a&&a.jump(this.measuredOrigin,!1);const i=s.length-1,o=s[i];s[i]=Jd[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(l=this.removedTransforms)!=null&&l.length&&this.removedTransforms.forEach(([d,c])=>{t.getValue(d).set(c)}),this.resolveNoneKeyframes()}}function i3e(e,t,r){if(e==null)return[];if(e instanceof EventTarget)return[e];if(typeof e=="string"){const a=document.querySelectorAll(e);return a?Array.from(a):[]}return Array.from(e).filter(s=>s!=null)}const UK=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function qC(e){return eK(e)&&"offsetHeight"in e}const{schedule:R8,cancel:lQe}=fK(queueMicrotask,!1),al={x:!1,y:!1};function VK(){return al.x||al.y}function o3e(e){return e==="x"||e==="y"?al[e]?null:(al[e]=!0,()=>{al[e]=!1}):al.x||al.y?null:(al.x=al.y=!0,()=>{al.x=al.y=!1})}function qK(e,t){const r=i3e(e),s=new AbortController,a={passive:!0,...t,signal:s.signal};return[r,a,()=>s.abort()]}function OM(e){return!(e.pointerType==="touch"||VK())}function l3e(e,t,r={}){const[s,a,i]=qK(e,r),o=l=>{if(!OM(l))return;const{target:d}=l,c=t(d,l);if(typeof c!="function"||!d)return;const u=h=>{OM(h)&&(c(h),d.removeEventListener("pointerleave",u))};d.addEventListener("pointerleave",u,a)};return s.forEach(l=>{l.addEventListener("pointerenter",o,a)}),i}const WK=(e,t)=>t?e===t?!0:WK(e,t.parentElement):!1,M8=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,c3e=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function HK(e){return c3e.has(e.tagName)||e.isContentEditable===!0}const vb=new WeakSet;function RM(e){return t=>{t.key==="Enter"&&e(t)}}function D3(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const d3e=(e,t)=>{const r=e.currentTarget;if(!r)return;const s=RM(()=>{if(vb.has(r))return;D3(r,"down");const a=RM(()=>{D3(r,"up")}),i=()=>D3(r,"cancel");r.addEventListener("keyup",a,t),r.addEventListener("blur",i,t)});r.addEventListener("keydown",s,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",s),t)};function MM(e){return M8(e)&&!VK()}function u3e(e,t,r={}){const[s,a,i]=qK(e,r),o=l=>{const d=l.currentTarget;if(!MM(l))return;vb.add(d);const c=t(d,l),u=(m,p)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),vb.has(d)&&vb.delete(d),MM(m)&&typeof c=="function"&&c(m,{success:p})},h=m=>{u(m,d===window||d===document||r.useGlobalTarget||WK(d,m.target))},f=m=>{u(m,!1)};window.addEventListener("pointerup",h,a),window.addEventListener("pointercancel",f,a)};return s.forEach(l=>{(r.useGlobalTarget?window:l).addEventListener("pointerdown",o,a),qC(l)&&(l.addEventListener("focus",c=>d3e(c,a)),!HK(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),i}function GK(e){return eK(e)&&"ownerSVGElement"in e}function h3e(e){return GK(e)&&e.tagName==="svg"}const f3e=[...$K,Ks,ku],m3e=e=>f3e.find(BK(e)),IM=()=>({translate:0,scale:1,origin:0,originPoint:0}),wm=()=>({x:IM(),y:IM()}),DM=()=>({min:0,max:0}),oa=()=>({x:DM(),y:DM()}),WC={current:null},KK={current:!1},p3e=typeof window<"u";function g3e(){if(KK.current=!0,!!p3e)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>WC.current=e.matches;e.addEventListener("change",t),t()}else WC.current=!1}const x3e=new WeakMap;function Y_(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function ev(e){return typeof e=="string"||Array.isArray(e)}const I8=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],D8=["initial",...I8];function Z_(e){return Y_(e.animate)||D8.some(t=>ev(e[t]))}function XK(e){return!!(Z_(e)||e.variants)}function v3e(e,t,r){for(const s in t){const a=t[s],i=r[s];if(si(a))e.addValue(s,a);else if(si(i))e.addValue(s,wp(a,{owner:e}));else if(i!==a)if(e.hasValue(s)){const o=e.getValue(s);o.liveStyle===!0?o.jump(a):o.hasAnimated||o.set(a)}else{const o=e.getStaticValue(s);e.addValue(s,wp(o!==void 0?o:a,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const LM=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let Ew={};function YK(e){Ew=e}function y3e(){return Ew}class b3e{scrapeMotionValuesFromProps(t,r,s){return{}}constructor({parent:t,props:r,presenceContext:s,reducedMotionConfig:a,blockInitialAnimation:i,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=E8,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=xi.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,fs.render(this.render,!1,!0))};const{latestValues:d,renderState:c}=o;this.latestValues=d,this.baseTarget={...d},this.initialValues=r.initial?{...d}:{},this.renderState=c,this.parent=t,this.props=r,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=l,this.blockInitialAnimation=!!i,this.isControllingVariants=Z_(r),this.isVariantNode=XK(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const f in h){const m=h[f];d[f]!==void 0&&si(m)&&m.set(d[f])}}mount(t){var r;this.current=t,x3e.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,a)=>this.bindToMotionValue(a,s)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(KK.current||g3e(),this.shouldReduceMotion=WC.current),(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),Eu(this.notifyUpdate),Eu(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const s=this.features[r];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=_g.has(t);s&&this.onBindTransform&&this.onBindTransform();const a=r.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&fs.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;typeof window<"u"&&window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{a(),i&&i(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Ew){const r=Ew[t];if(!r)continue;const{isEnabled:s,Feature:a}=r;if(!this.features[t]&&a&&s(this.props)&&(this.features[t]=new a(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):oa()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let s=0;s<LM.length;s++){const a=LM[s];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const i="on"+a,o=t[i];o&&(this.propEventSubscriptions[a]=this.on(a,o))}this.prevMotionValues=v3e(this,this.scrapeMotionValuesFromProps(t,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const s=this.values.get(t);r!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&r!==void 0&&(s=wp(r===null?void 0:r,{owner:this}),this.addValue(t,s)),s}readValue(t,r){let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(JG(s)||tK(s))?s=parseFloat(s):!m3e(s)&&ku.test(r)&&(s=zK(t,r)),this.setBaseTarget(t,si(s)?s.get():s)),si(s)?s.get():s}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var i;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const o=T8(this.props,r,(i=this.presenceContext)==null?void 0:i.custom);o&&(s=o[t])}if(r&&s!==void 0)return s;const a=this.getBaseTargetFromProps(this.props,t);return a!==void 0&&!si(a)?a:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new g8),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){R8.render(this.render)}}class ZK extends b3e{constructor(){super(...arguments),this.KeyframeResolver=a3e}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){const s=t.style;return s?s[r]:void 0}removeValueFromRenderState(t,{vars:r,style:s}){delete r[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;si(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}class zu{constructor(t){this.isMounted=!1,this.node=t}update(){}}function QK({top:e,left:t,right:r,bottom:s}){return{x:{min:t,max:r},y:{min:e,max:s}}}function w3e({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function _3e(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),s=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:s.y,right:s.x}}function L3(e){return e===void 0||e===1}function HC({scale:e,scaleX:t,scaleY:r}){return!L3(e)||!L3(t)||!L3(r)}function uh(e){return HC(e)||JK(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function JK(e){return BM(e.x)||BM(e.y)}function BM(e){return e&&e!=="0%"}function kw(e,t,r){const s=e-r,a=t*s;return r+a}function $M(e,t,r,s,a){return a!==void 0&&(e=kw(e,a,s)),kw(e,r,s)+t}function GC(e,t=0,r=1,s,a){e.min=$M(e.min,t,r,s,a),e.max=$M(e.max,t,r,s,a)}function eX(e,{x:t,y:r}){GC(e.x,t.translate,t.scale,t.originPoint),GC(e.y,r.translate,r.scale,r.originPoint)}const FM=.999999999999,zM=1.0000000000001;function j3e(e,t,r,s=!1){const a=r.length;if(!a)return;t.x=t.y=1;let i,o;for(let l=0;l<a;l++){i=r[l],o=i.projectionDelta;const{visualElement:d}=i.options;d&&d.props.style&&d.props.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&jm(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,eX(e,o)),s&&uh(i.latestValues)&&jm(e,i.latestValues))}t.x<zM&&t.x>FM&&(t.x=1),t.y<zM&&t.y>FM&&(t.y=1)}function _m(e,t){e.min=e.min+t,e.max=e.max+t}function UM(e,t,r,s,a=.5){const i=js(e.min,e.max,a);GC(e,t,r,i,s)}function jm(e,t){UM(e.x,t.x,t.scaleX,t.scale,t.originX),UM(e.y,t.y,t.scaleY,t.scale,t.originY)}function tX(e,t){return QK(_3e(e.getBoundingClientRect(),t))}function N3e(e,t,r){const s=tX(e,r),{scroll:a}=t;return a&&(_m(s.x,a.offset.x),_m(s.y,a.offset.y)),s}const S3e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},C3e=wg.length;function E3e(e,t,r){let s="",a=!0;for(let i=0;i<C3e;i++){const o=wg[i],l=e[o];if(l===void 0)continue;let d=!0;if(typeof l=="number")d=l===(o.startsWith("scale")?1:0);else{const c=parseFloat(l);d=o.startsWith("scale")?c===1:c===0}if(!d||r){const c=UK(l,O8[o]);if(!d){a=!1;const u=S3e[o]||o;s+=`${u}(${c}) `}r&&(t[o]=c)}}return s=s.trim(),r?s=r(t,a?"":s):a&&(s="none"),s}function L8(e,t,r){const{style:s,vars:a,transformOrigin:i}=e;let o=!1,l=!1;for(const d in t){const c=t[d];if(_g.has(d)){o=!0;continue}else if(pK(d)){a[d]=c;continue}else{const u=UK(c,O8[d]);d.startsWith("origin")?(l=!0,i[d]=u):s[d]=u}}if(t.transform||(o||r?s.transform=E3e(t,e.transform,r):s.transform&&(s.transform="none")),l){const{originX:d="50%",originY:c="50%",originZ:u=0}=i;s.transformOrigin=`${d} ${c} ${u}`}}function rX(e,{style:t,vars:r},s,a){const i=e.style;let o;for(o in t)i[o]=t[o];a==null||a.applyProjectionStyles(i,s);for(o in r)i.setProperty(o,r[o])}function VM(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const d0={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(hr.test(e))e=parseFloat(e);else return e;const r=VM(e,t.target.x),s=VM(e,t.target.y);return`${r}% ${s}%`}},k3e={correct:(e,{treeScale:t,projectionDelta:r})=>{const s=e,a=ku.parse(e);if(a.length>5)return s;const i=ku.createTransformer(e),o=typeof a[0]!="number"?1:0,l=r.x.scale*t.x,d=r.y.scale*t.y;a[0+o]/=l,a[1+o]/=d;const c=js(l,d,.5);return typeof a[2+o]=="number"&&(a[2+o]/=c),typeof a[3+o]=="number"&&(a[3+o]/=c),i(a)}},KC={borderRadius:{...d0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:d0,borderTopRightRadius:d0,borderBottomLeftRadius:d0,borderBottomRightRadius:d0,boxShadow:k3e};function nX(e,{layout:t,layoutId:r}){return _g.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!KC[e]||e==="opacity")}function B8(e,t,r){var o;const s=e.style,a=t==null?void 0:t.style,i={};if(!s)return i;for(const l in s)(si(s[l])||a&&si(a[l])||nX(l,e)||((o=r==null?void 0:r.getValue(l))==null?void 0:o.liveStyle)!==void 0)&&(i[l]=s[l]);return i}function A3e(e){return window.getComputedStyle(e)}class T3e extends ZK{constructor(){super(...arguments),this.type="html",this.renderInstance=rX}readValueFromInstance(t,r){var s;if(_g.has(r))return(s=this.projection)!=null&&s.isProjecting?MC(r):aNe(t,r);{const a=A3e(t),i=(pK(r)?a.getPropertyValue(r):a[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:r}){return tX(t,r)}build(t,r,s){L8(t,r,s.transformTemplate)}scrapeMotionValuesFromProps(t,r,s){return B8(t,r,s)}}const P3e={offset:"stroke-dashoffset",array:"stroke-dasharray"},O3e={offset:"strokeDashoffset",array:"strokeDasharray"};function R3e(e,t,r=1,s=0,a=!0){e.pathLength=1;const i=a?P3e:O3e;e[i.offset]=`${-s}`,e[i.array]=`${t} ${r}`}const M3e=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function sX(e,{attrX:t,attrY:r,attrScale:s,pathLength:a,pathSpacing:i=1,pathOffset:o=0,...l},d,c,u){if(L8(e,l,c),d){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:f}=e;h.transform&&(f.transform=h.transform,delete h.transform),(f.transform||h.transformOrigin)&&(f.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),f.transform&&(f.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete h.transformBox);for(const m of M3e)h[m]!==void 0&&(f[m]=h[m],delete h[m]);t!==void 0&&(h.x=t),r!==void 0&&(h.y=r),s!==void 0&&(h.scale=s),a!==void 0&&R3e(h,a,i,o,!1)}const aX=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),iX=e=>typeof e=="string"&&e.toLowerCase()==="svg";function I3e(e,t,r,s){rX(e,t,void 0,s);for(const a in t.attrs)e.setAttribute(aX.has(a)?a:P8(a),t.attrs[a])}function oX(e,t,r){const s=B8(e,t,r);for(const a in e)if(si(e[a])||si(t[a])){const i=wg.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;s[i]=e[a]}return s}class D3e extends ZK{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=oa}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(_g.has(r)){const s=FK(r);return s&&s.default||0}return r=aX.has(r)?r:P8(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,s){return oX(t,r,s)}build(t,r,s){sX(t,r,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(t,r,s,a){I3e(t,r,s,a)}mount(t){this.isSVGTag=iX(t.tagName),super.mount(t)}}const L3e=D8.length;function lX(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?lX(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<L3e;r++){const s=D8[r],a=e.props[s];(ev(a)||a===!1)&&(t[s]=a)}return t}function cX(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(t[s]!==e[s])return!1;return!0}const B3e=[...I8].reverse(),$3e=I8.length;function F3e(e){return t=>Promise.all(t.map(({animation:r,options:s})=>XNe(e,r,s)))}function z3e(e){let t=F3e(e),r=qM(),s=!0;const a=d=>(c,u)=>{var f;const h=zm(e,u,d==="exit"?(f=e.presenceContext)==null?void 0:f.custom:void 0);if(h){const{transition:m,transitionEnd:p,...g}=h;c={...c,...g,...p}}return c};function i(d){t=d(e)}function o(d){const{props:c}=e,u=lX(e.parent)||{},h=[],f=new Set;let m={},p=1/0;for(let x=0;x<$3e;x++){const v=B3e[x],y=r[v],b=c[v]!==void 0?c[v]:u[v],j=ev(b),T=v===d?y.isActive:null;T===!1&&(p=x);let O=b===u[v]&&b!==c[v]&&j;if(O&&s&&e.manuallyAnimateOnMount&&(O=!1),y.protectedKeys={...m},!y.isActive&&T===null||!b&&!y.prevProp||Y_(b)||typeof b=="boolean")continue;const R=U3e(y.prevProp,b);let D=R||v===d&&y.isActive&&!O&&j||x>p&&j,B=!1;const q=Array.isArray(b)?b:[b];let Y=q.reduce(a(v),{});T===!1&&(Y={});const{prevResolvedValues:G={}}=y,I={...G,...Y},F=N=>{D=!0,f.has(N)&&(B=!0,f.delete(N)),y.needsAnimating[N]=!0;const C=e.getValue(N);C&&(C.liveStyle=!1)};for(const N in I){const C=Y[N],k=G[N];if(m.hasOwnProperty(N))continue;let M=!1;FC(C)&&FC(k)?M=!cX(C,k):M=C!==k,M?C!=null?F(N):f.add(N):C!==void 0&&f.has(N)?F(N):y.protectedKeys[N]=!0}y.prevProp=b,y.prevResolvedValues=Y,y.isActive&&(m={...m,...Y}),s&&e.blockInitialAnimation&&(D=!1);const S=O&&R;D&&(!S||B)&&h.push(...q.map(N=>{const C={type:v};if(typeof N=="string"&&s&&!S&&e.manuallyAnimateOnMount&&e.parent){const{parent:k}=e,M=zm(k,N);if(k.enteringChildren&&M){const{delayChildren:U}=M.transition||{};C.delay=OK(k.enteringChildren,e,U)}}return{animation:N,options:C}}))}if(f.size){const x={};if(typeof c.initial!="boolean"){const v=zm(e,Array.isArray(c.initial)?c.initial[0]:c.initial);v&&v.transition&&(x.transition=v.transition)}f.forEach(v=>{const y=e.getBaseTarget(v),b=e.getValue(v);b&&(b.liveStyle=!0),x[v]=y??null}),h.push({animation:x})}let g=!!h.length;return s&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(g=!1),s=!1,g?t(h):Promise.resolve()}function l(d,c){var h;if(r[d].isActive===c)return Promise.resolve();(h=e.variantChildren)==null||h.forEach(f=>{var m;return(m=f.animationState)==null?void 0:m.setActive(d,c)}),r[d].isActive=c;const u=o(d);for(const f in r)r[f].protectedKeys={};return u}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>r,reset:()=>{r=qM()}}}function U3e(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!cX(t,e):!1}function sh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function qM(){return{animate:sh(!0),whileInView:sh(),whileHover:sh(),whileTap:sh(),whileDrag:sh(),whileFocus:sh(),exit:sh()}}function WM(e,t){e.min=t.min,e.max=t.max}function tl(e,t){WM(e.x,t.x),WM(e.y,t.y)}function HM(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}const dX=1e-4,V3e=1-dX,q3e=1+dX,uX=.01,W3e=0-uX,H3e=0+uX;function vi(e){return e.max-e.min}function G3e(e,t,r){return Math.abs(e-t)<=r}function GM(e,t,r,s=.5){e.origin=s,e.originPoint=js(t.min,t.max,e.origin),e.scale=vi(r)/vi(t),e.translate=js(r.min,r.max,e.origin)-e.originPoint,(e.scale>=V3e&&e.scale<=q3e||isNaN(e.scale))&&(e.scale=1),(e.translate>=W3e&&e.translate<=H3e||isNaN(e.translate))&&(e.translate=0)}function Q0(e,t,r,s){GM(e.x,t.x,r.x,s?s.originX:void 0),GM(e.y,t.y,r.y,s?s.originY:void 0)}function KM(e,t,r){e.min=r.min+t.min,e.max=e.min+vi(t)}function K3e(e,t,r){KM(e.x,t.x,r.x),KM(e.y,t.y,r.y)}function XM(e,t,r){e.min=t.min-r.min,e.max=e.min+vi(t)}function Aw(e,t,r){XM(e.x,t.x,r.x),XM(e.y,t.y,r.y)}function YM(e,t,r,s,a){return e-=t,e=kw(e,1/r,s),a!==void 0&&(e=kw(e,1/a,s)),e}function X3e(e,t=0,r=1,s=.5,a,i=e,o=e){if(dc.test(t)&&(t=parseFloat(t),t=js(o.min,o.max,t/100)-o.min),typeof t!="number")return;let l=js(i.min,i.max,s);e===i&&(l-=t),e.min=YM(e.min,t,r,l,a),e.max=YM(e.max,t,r,l,a)}function ZM(e,t,[r,s,a],i,o){X3e(e,t[r],t[s],t[a],t.scale,i,o)}const Y3e=["x","scaleX","originX"],Z3e=["y","scaleY","originY"];function QM(e,t,r,s){ZM(e.x,t,Y3e,r?r.x:void 0,s?s.x:void 0),ZM(e.y,t,Z3e,r?r.y:void 0,s?s.y:void 0)}function JM(e){return e.translate===0&&e.scale===1}function hX(e){return JM(e.x)&&JM(e.y)}function e7(e,t){return e.min===t.min&&e.max===t.max}function Q3e(e,t){return e7(e.x,t.x)&&e7(e.y,t.y)}function t7(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function fX(e,t){return t7(e.x,t.x)&&t7(e.y,t.y)}function r7(e){return vi(e.x)/vi(e.y)}function n7(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}function Eo(e){return[e("x"),e("y")]}function J3e(e,t,r){let s="";const a=e.x.translate/t.x,i=e.y.translate/t.y,o=(r==null?void 0:r.z)||0;if((a||i||o)&&(s=`translate3d(${a}px, ${i}px, ${o}px) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:f,skewX:m,skewY:p}=r;c&&(s=`perspective(${c}px) ${s}`),u&&(s+=`rotate(${u}deg) `),h&&(s+=`rotateX(${h}deg) `),f&&(s+=`rotateY(${f}deg) `),m&&(s+=`skewX(${m}deg) `),p&&(s+=`skewY(${p}deg) `)}const l=e.x.scale*t.x,d=e.y.scale*t.y;return(l!==1||d!==1)&&(s+=`scale(${l}, ${d})`),s||"none"}const mX=["TopLeft","TopRight","BottomLeft","BottomRight"],e4e=mX.length,s7=e=>typeof e=="string"?parseFloat(e):e,a7=e=>typeof e=="number"||hr.test(e);function t4e(e,t,r,s,a,i){a?(e.opacity=js(0,r.opacity??1,r4e(s)),e.opacityExit=js(t.opacity??1,0,n4e(s))):i&&(e.opacity=js(t.opacity??1,r.opacity??1,s));for(let o=0;o<e4e;o++){const l=`border${mX[o]}Radius`;let d=i7(t,l),c=i7(r,l);if(d===void 0&&c===void 0)continue;d||(d=0),c||(c=0),d===0||c===0||a7(d)===a7(c)?(e[l]=Math.max(js(s7(d),s7(c),s),0),(dc.test(c)||dc.test(d))&&(e[l]+="%")):e[l]=c}(t.rotate||r.rotate)&&(e.rotate=js(t.rotate||0,r.rotate||0,s))}function i7(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const r4e=pX(0,.5,cK),n4e=pX(.5,.95,Lo);function pX(e,t,r){return s=>s<e?0:s>t?1:r(Zx(e,t,s))}function s4e(e,t,r){const s=si(e)?e:wp(e);return s.start(A8("",s,t,r)),s.animation}function tv(e,t,r,s={passive:!0}){return e.addEventListener(t,r,s),()=>e.removeEventListener(t,r)}const a4e=(e,t)=>e.depth-t.depth;class i4e{constructor(){this.children=[],this.isDirty=!1}add(t){f8(this.children,t),this.isDirty=!0}remove(t){m8(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(a4e),this.isDirty=!1,this.children.forEach(t)}}function o4e(e,t){const r=xi.now(),s=({timestamp:a})=>{const i=a-r;i>=t&&(Eu(s),e(i-t))};return fs.setup(s,!0),()=>Eu(s)}function yb(e){return si(e)?e.get():e}class l4e{constructor(){this.members=[]}add(t){f8(this.members,t),t.scheduleRender()}remove(t){if(m8(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let s;for(let a=r;a>=0;a--){const i=this.members[a];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(t,r){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender();const a=s.options.layoutDependency,i=t.options.layoutDependency;a!==void 0&&i!==void 0&&a===i||(t.resumeFrom=s,r&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0));const{crossfade:l}=t.options;l===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:s}=t;r.onExitComplete&&r.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const bb={hasAnimatedSinceResize:!0,hasEverUpdated:!1},B3=["","X","Y","Z"],c4e=1e3;let d4e=0;function $3(e,t,r,s){const{latestValues:a}=t;a[e]&&(r[e]=a[e],t.setStaticValue(e,0),s&&(s[e]=0))}function gX(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=DK(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:a,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",fs,!(a||i))}const{parent:s}=e;s&&!s.hasCheckedOptimisedAppear&&gX(s)}function xX({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:s,resetTransform:a}){return class{constructor(o={},l=t==null?void 0:t()){this.id=d4e++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(f4e),this.nodes.forEach(x4e),this.nodes.forEach(v4e),this.nodes.forEach(m4e)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let d=0;d<this.path.length;d++)this.path[d].shouldResetTransform=!0;this.root===this&&(this.nodes=new i4e)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new g8),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const d=this.eventHandlers.get(o);d&&d.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=GK(o)&&!h3e(o),this.instance=o;const{layoutId:l,layout:d,visualElement:c}=this.options;if(c&&!c.current&&c.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(d||l)&&(this.isLayoutDirty=!0),e){let u,h=0;const f=()=>this.root.updateBlockedByResize=!1;fs.read(()=>{h=window.innerWidth}),e(o,()=>{const m=window.innerWidth;m!==h&&(h=m,this.root.updateBlockedByResize=!0,u&&u(),u=o4e(f,250),bb.hasAnimatedSinceResize&&(bb.hasAnimatedSinceResize=!1,this.nodes.forEach(c7)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&c&&(l||d)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:h,hasRelativeLayoutChanged:f,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||c.getDefaultTransition()||j4e,{onLayoutAnimationStart:g,onLayoutAnimationComplete:x}=c.getProps(),v=!this.targetLayout||!fX(this.targetLayout,m),y=!h&&f;if(this.options.layoutRoot||this.resumeFrom||y||h&&(v||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const b={...k8(p,"layout"),onPlay:g,onComplete:x};(c.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b),this.setAnimationOrigin(u,y)}else h||c7(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Eu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(y4e),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&gX(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:d}=this.options;if(l===void 0&&!d)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(o7);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(l7);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(g4e),this.nodes.forEach(u4e),this.nodes.forEach(h4e)):this.nodes.forEach(l7),this.clearAllSnapshots();const l=xi.now();Ba.delta=xc(0,1e3/60,l-Ba.timestamp),Ba.timestamp=l,Ba.isProcessing=!0,T3.update.process(Ba),T3.preRender.process(Ba),T3.render.process(Ba),Ba.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,R8.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(p4e),this.sharedNodes.forEach(b4e)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,fs.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){fs.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!vi(this.snapshot.measuredBox.x)&&!vi(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let d=0;d<this.path.length;d++)this.path[d].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=oa(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const d=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:d,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:d}}}resetTransform(){if(!a)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!hX(this.projectionDelta),d=this.getTransformTemplate(),c=d?d(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&this.instance&&(l||uh(this.latestValues)||u)&&(a(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let d=this.removeElementScroll(l);return o&&(d=this.removeTransform(d)),N4e(d),{animationId:this.root.animationId,measuredBox:l,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:o}=this.options;if(!o)return oa();const l=o.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(S4e))){const{scroll:u}=this.root;u&&(_m(l.x,u.offset.x),_m(l.y,u.offset.y))}return l}removeElementScroll(o){var d;const l=oa();if(tl(l,o),(d=this.scroll)!=null&&d.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:h,options:f}=u;u!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&tl(l,o),_m(l.x,h.offset.x),_m(l.y,h.offset.y))}return l}applyTransform(o,l=!1){const d=oa();tl(d,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&jm(d,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),uh(u.latestValues)&&jm(d,u.latestValues)}return uh(this.latestValues)&&jm(d,this.latestValues),d}removeTransform(o){const l=oa();tl(l,o);for(let d=0;d<this.path.length;d++){const c=this.path[d];if(!c.instance||!uh(c.latestValues))continue;HC(c.latestValues)&&c.updateSnapshot();const u=oa(),h=c.measurePageBox();tl(u,h),QM(l,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return uh(this.latestValues)&&QM(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ba.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var m;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==l;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:h}=this.options;if(!this.layout||!(u||h))return;this.resolvedRelativeTargetAt=Ba.timestamp;const f=this.getClosestProjectingParent();f&&this.linkedParentVersion!==f.layoutVersion&&!f.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(f&&f.layout?this.createRelativeTarget(f,this.layout.layoutBox,f.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=oa(),this.targetWithTransforms=oa()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),K3e(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):tl(this.target,this.layout.layoutBox),eX(this.target,this.targetDelta)):tl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?this.createRelativeTarget(f,this.target,f.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||HC(this.parent.latestValues)||JK(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,l,d){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=oa(),this.relativeTargetOrigin=oa(),Aw(this.relativeTargetOrigin,l,d),tl(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var p;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let d=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(d=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Ba.timestamp&&(d=!1),d)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;tl(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;j3e(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=oa());const{target:m}=o;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(HM(this.prevProjectionDelta.x,this.projectionDelta.x),HM(this.prevProjectionDelta.y,this.projectionDelta.y)),Q0(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==f||!n7(this.projectionDelta.x,this.prevProjectionDelta.x)||!n7(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)==null||l.scheduleRender(),o){const d=this.getStack();d&&d.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=wm(),this.projectionDelta=wm(),this.projectionDeltaWithTransform=wm()}setAnimationOrigin(o,l=!1){const d=this.snapshot,c=d?d.latestValues:{},u={...this.latestValues},h=wm();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const f=oa(),m=d?d.source:void 0,p=this.layout?this.layout.source:void 0,g=m!==p,x=this.getStack(),v=!x||x.members.length<=1,y=!!(g&&!v&&this.options.crossfade===!0&&!this.path.some(_4e));this.animationProgress=0;let b;this.mixTargetDelta=j=>{const T=j/1e3;d7(h.x,o.x,T),d7(h.y,o.y,T),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Aw(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),w4e(this.relativeTarget,this.relativeTargetOrigin,f,T),b&&Q3e(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=oa()),tl(b,this.relativeTarget)),g&&(this.animationValues=u,t4e(u,c,this.latestValues,T,y,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=T},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var l,d,c;this.notifyListeners("animationStart"),(l=this.currentAnimation)==null||l.stop(),(c=(d=this.resumingFrom)==null?void 0:d.currentAnimation)==null||c.stop(),this.pendingAnimation&&(Eu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=fs.update(()=>{bb.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=wp(0)),this.currentAnimation=s4e(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(c4e),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:d,layout:c,latestValues:u}=o;if(!(!l||!d||!c)){if(this!==o&&this.layout&&c&&vX(this.options.animationType,this.layout.layoutBox,c.layoutBox)){d=this.target||oa();const h=vi(this.layout.layoutBox.x);d.x.min=o.target.x.min,d.x.max=d.x.min+h;const f=vi(this.layout.layoutBox.y);d.y.min=o.target.y.min,d.y.max=d.y.min+f}tl(l,d),jm(l,u),Q0(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new l4e),this.sharedNodes.get(o).add(l);const c=l.options.initialPromotionConfig;l.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var l;const{layoutId:o}=this.options;return o?((l=this.getStack())==null?void 0:l.lead)||this:this}getPrevLead(){var l;const{layoutId:o}=this.options;return o?(l=this.getStack())==null?void 0:l.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:d}={}){const c=this.getStack();c&&c.promote(this,d),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:d}=o;if((d.z||d.rotate||d.rotateX||d.rotateY||d.rotateZ||d.skewX||d.skewY)&&(l=!0),!l)return;const c={};d.z&&$3("z",o,c,this.animationValues);for(let u=0;u<B3.length;u++)$3(`rotate${B3[u]}`,o,c,this.animationValues),$3(`skew${B3[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const d=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=yb(l==null?void 0:l.pointerEvents)||"",o.transform=d?d(this.latestValues,""):"none";return}const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=yb(l==null?void 0:l.pointerEvents)||""),this.hasProjected&&!uh(this.latestValues)&&(o.transform=d?d({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=c.animationValues||c.latestValues;this.applyTransformsToTarget();let h=J3e(this.projectionDeltaWithTransform,this.treeScale,u);d&&(h=d(u,h)),o.transform=h;const{x:f,y:m}=this.projectionDelta;o.transformOrigin=`${f.origin*100}% ${m.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const p in KC){if(u[p]===void 0)continue;const{correct:g,applyTo:x,isCSSVariable:v}=KC[p],y=h==="none"?u[p]:g(u[p],c);if(x){const b=x.length;for(let j=0;j<b;j++)o[x[j]]=y}else v?this.options.visualElement.renderState.vars[p]=y:o[p]=y}this.options.layoutId&&(o.pointerEvents=c===this?yb(l==null?void 0:l.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)==null?void 0:l.stop()}),this.root.nodes.forEach(o7),this.root.sharedNodes.clear()}}}function u4e(e){e.updateLayout()}function h4e(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:a}=e.layout,{animationType:i}=e.options,o=t.source!==e.layout.source;i==="size"?Eo(h=>{const f=o?t.measuredBox[h]:t.layoutBox[h],m=vi(f);f.min=s[h].min,f.max=f.min+m}):vX(i,t.layoutBox,s)&&Eo(h=>{const f=o?t.measuredBox[h]:t.layoutBox[h],m=vi(s[h]);f.max=f.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+m)});const l=wm();Q0(l,s,t.layoutBox);const d=wm();o?Q0(d,e.applyTransform(a,!0),t.measuredBox):Q0(d,s,t.layoutBox);const c=!hX(l);let u=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:m}=h;if(f&&m){const p=oa();Aw(p,t.layoutBox,f.layoutBox);const g=oa();Aw(g,s,m.layoutBox),fX(p,g)||(u=!0),h.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=p,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:s,snapshot:t,delta:d,layoutDelta:l,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:s}=e.options;s&&s()}e.options.transition=void 0}function f4e(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function m4e(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function p4e(e){e.clearSnapshot()}function o7(e){e.clearMeasurements()}function l7(e){e.isLayoutDirty=!1}function g4e(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function c7(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function x4e(e){e.resolveTargetDelta()}function v4e(e){e.calcProjection()}function y4e(e){e.resetSkewAndRotation()}function b4e(e){e.removeLeadSnapshot()}function d7(e,t,r){e.translate=js(t.translate,0,r),e.scale=js(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function u7(e,t,r,s){e.min=js(t.min,r.min,s),e.max=js(t.max,r.max,s)}function w4e(e,t,r,s){u7(e.x,t.x,r.x,s),u7(e.y,t.y,r.y,s)}function _4e(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const j4e={duration:.45,ease:[.4,0,.1,1]},h7=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),f7=h7("applewebkit/")&&!h7("chrome/")?Math.round:Lo;function m7(e){e.min=f7(e.min),e.max=f7(e.max)}function N4e(e){m7(e.x),m7(e.y)}function vX(e,t,r){return e==="position"||e==="preserve-aspect"&&!G3e(r7(t),r7(r),.2)}function S4e(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const C4e=xX({attachResizeListener:(e,t)=>tv(e,"resize",t),measureScroll:()=>{var e,t;return{x:document.documentElement.scrollLeft||((e=document.body)==null?void 0:e.scrollLeft)||0,y:document.documentElement.scrollTop||((t=document.body)==null?void 0:t.scrollTop)||0}},checkIsScrollRoot:()=>!0}),F3={current:void 0},yX=xX({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!F3.current){const e=new C4e({});e.mount(window),e.setOptions({layoutScroll:!0}),F3.current=e}return F3.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),$8=P.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function p7(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function E4e(...e){return t=>{let r=!1;const s=e.map(a=>{const i=p7(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<s.length;a++){const i=s[a];typeof i=="function"?i():p7(e[a],null)}}}}function k4e(...e){return P.useCallback(E4e(...e),e)}class A4e extends P.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const s=r.offsetParent,a=qC(s)&&s.offsetWidth||0,i=qC(s)&&s.offsetHeight||0,o=this.props.sizeRef.current;o.height=r.offsetHeight||0,o.width=r.offsetWidth||0,o.top=r.offsetTop,o.left=r.offsetLeft,o.right=a-o.width-o.left,o.bottom=i-o.height-o.top}return null}componentDidUpdate(){}render(){return this.props.children}}function T4e({children:e,isPresent:t,anchorX:r,anchorY:s,root:a}){var h;const i=P.useId(),o=P.useRef(null),l=P.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:d}=P.useContext($8),c=((h=e.props)==null?void 0:h.ref)??(e==null?void 0:e.ref),u=k4e(o,c);return P.useInsertionEffect(()=>{const{width:f,height:m,top:p,left:g,right:x,bottom:v}=l.current;if(t||!o.current||!f||!m)return;const y=r==="left"?`left: ${g}`:`right: ${x}`,b=s==="bottom"?`bottom: ${v}`:`top: ${p}`;o.current.dataset.motionPopId=i;const j=document.createElement("style");d&&(j.nonce=d);const T=a??document.head;return T.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${f}px !important;
            height: ${m}px !important;
            ${y}px !important;
            ${b}px !important;
          }
        `),()=>{T.contains(j)&&T.removeChild(j)}},[t]),n.jsx(A4e,{isPresent:t,childRef:o,sizeRef:l,children:P.cloneElement(e,{ref:u})})}const P4e=({children:e,initial:t,isPresent:r,onExitComplete:s,custom:a,presenceAffectsLayout:i,mode:o,anchorX:l,anchorY:d,root:c})=>{const u=h8(O4e),h=P.useId();let f=!0,m=P.useMemo(()=>(f=!1,{id:h,initial:t,isPresent:r,custom:a,onExitComplete:p=>{u.set(p,!0);for(const g of u.values())if(!g)return;s&&s()},register:p=>(u.set(p,!1),()=>u.delete(p))}),[r,u,s]);return i&&f&&(m={...m}),P.useMemo(()=>{u.forEach((p,g)=>u.set(g,!1))},[r]),P.useEffect(()=>{!r&&!u.size&&s&&s()},[r]),o==="popLayout"&&(e=n.jsx(T4e,{isPresent:r,anchorX:l,anchorY:d,root:c,children:e})),n.jsx(K_.Provider,{value:m,children:e})};function O4e(){return new Map}function bX(e=!0){const t=P.useContext(K_);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:s,register:a}=t,i=P.useId();P.useEffect(()=>{if(e)return a(i)},[e]);const o=P.useCallback(()=>e&&s&&s(i),[i,s,e]);return!r&&s?[!1,o]:[!0]}const Oy=e=>e.key||"";function g7(e){const t=[];return P.Children.forEach(e,r=>{P.isValidElement(r)&&t.push(r)}),t}const R4e=({children:e,custom:t,initial:r=!0,onExitComplete:s,presenceAffectsLayout:a=!0,mode:i="sync",propagate:o=!1,anchorX:l="left",anchorY:d="top",root:c})=>{const[u,h]=bX(o),f=P.useMemo(()=>g7(e),[e]),m=o&&!u?[]:f.map(Oy),p=P.useRef(!0),g=P.useRef(f),x=h8(()=>new Map),v=P.useRef(new Set),[y,b]=P.useState(f),[j,T]=P.useState(f);QG(()=>{p.current=!1,g.current=f;for(let D=0;D<j.length;D++){const B=Oy(j[D]);m.includes(B)?(x.delete(B),v.current.delete(B)):x.get(B)!==!0&&x.set(B,!1)}},[j,m.length,m.join("-")]);const O=[];if(f!==y){let D=[...f];for(let B=0;B<j.length;B++){const q=j[B],Y=Oy(q);m.includes(Y)||(D.splice(B,0,q),O.push(q))}return i==="wait"&&O.length&&(D=O),T(g7(D)),b(f),null}const{forceRender:R}=P.useContext(u8);return n.jsx(n.Fragment,{children:j.map(D=>{const B=Oy(D),q=o&&!u?!1:f===j||m.includes(B),Y=()=>{if(v.current.has(B))return;if(v.current.add(B),x.has(B))x.set(B,!0);else return;let G=!0;x.forEach(I=>{I||(G=!1)}),G&&(R==null||R(),T(g.current),o&&(h==null||h()),s&&s())};return n.jsx(P4e,{isPresent:q,initial:!p.current||r?void 0:!1,custom:t,presenceAffectsLayout:a,mode:i,root:c,onExitComplete:q?void 0:Y,anchorX:l,anchorY:d,children:D},B)})})},wX=P.createContext({strict:!1}),x7={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let v7=!1;function M4e(){if(v7)return;const e={};for(const t in x7)e[t]={isEnabled:r=>x7[t].some(s=>!!r[s])};YK(e),v7=!0}function _X(){return M4e(),y3e()}function I4e(e){const t=_X();for(const r in e)t[r]={...t[r],...e[r]};YK(t)}const D4e=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Tw(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||D4e.has(e)}let jX=e=>!Tw(e);function L4e(e){typeof e=="function"&&(jX=t=>t.startsWith("on")?!Tw(t):e(t))}try{L4e(require("@emotion/is-prop-valid").default)}catch{}function B4e(e,t,r){const s={};for(const a in e)a==="values"&&typeof e.values=="object"||(jX(a)||r===!0&&Tw(a)||!t&&!Tw(a)||e.draggable&&a.startsWith("onDrag"))&&(s[a]=e[a]);return s}const Q_=P.createContext({});function $4e(e,t){if(Z_(e)){const{initial:r,animate:s}=e;return{initial:r===!1||ev(r)?r:void 0,animate:ev(s)?s:void 0}}return e.inherit!==!1?t:{}}function F4e(e){const{initial:t,animate:r}=$4e(e,P.useContext(Q_));return P.useMemo(()=>({initial:t,animate:r}),[y7(t),y7(r)])}function y7(e){return Array.isArray(e)?e.join(" "):e}const F8=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function NX(e,t,r){for(const s in t)!si(t[s])&&!nX(s,r)&&(e[s]=t[s])}function z4e({transformTemplate:e},t){return P.useMemo(()=>{const r=F8();return L8(r,t,e),Object.assign({},r.vars,r.style)},[t])}function U4e(e,t){const r=e.style||{},s={};return NX(s,r,e),Object.assign(s,z4e(e,t)),s}function V4e(e,t){const r={},s=U4e(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=s,r}const SX=()=>({...F8(),attrs:{}});function q4e(e,t,r,s){const a=P.useMemo(()=>{const i=SX();return sX(i,t,iX(s),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};NX(i,e.style,e),a.style={...i,...a.style}}return a}const W4e=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function z8(e){return typeof e!="string"||e.includes("-")?!1:!!(W4e.indexOf(e)>-1||/[A-Z]/u.test(e))}function H4e(e,t,r,{latestValues:s},a,i=!1,o){const d=(o??z8(e)?q4e:V4e)(t,s,a,e),c=B4e(t,typeof e=="string",i),u=e!==P.Fragment?{...c,...d,ref:r}:{},{children:h}=t,f=P.useMemo(()=>si(h)?h.get():h,[h]);return P.createElement(e,{...u,children:f})}function G4e({scrapeMotionValuesFromProps:e,createRenderState:t},r,s,a){return{latestValues:K4e(r,s,a,e),renderState:t()}}function K4e(e,t,r,s){const a={},i=s(e,{});for(const f in i)a[f]=yb(i[f]);let{initial:o,animate:l}=e;const d=Z_(e),c=XK(e);t&&c&&!d&&e.inherit!==!1&&(o===void 0&&(o=t.initial),l===void 0&&(l=t.animate));let u=r?r.initial===!1:!1;u=u||o===!1;const h=u?l:o;if(h&&typeof h!="boolean"&&!Y_(h)){const f=Array.isArray(h)?h:[h];for(let m=0;m<f.length;m++){const p=T8(e,f[m]);if(p){const{transitionEnd:g,transition:x,...v}=p;for(const y in v){let b=v[y];if(Array.isArray(b)){const j=u?b.length-1:0;b=b[j]}b!==null&&(a[y]=b)}for(const y in g)a[y]=g[y]}}}return a}const CX=e=>(t,r)=>{const s=P.useContext(Q_),a=P.useContext(K_),i=()=>G4e(e,t,s,a);return r?i():h8(i)},X4e=CX({scrapeMotionValuesFromProps:B8,createRenderState:F8}),Y4e=CX({scrapeMotionValuesFromProps:oX,createRenderState:SX}),Z4e=Symbol.for("motionComponentSymbol");function Q4e(e,t,r){const s=P.useRef(r);P.useInsertionEffect(()=>{s.current=r});const a=P.useRef(null);return P.useCallback(i=>{var l;i&&((l=e.onMount)==null||l.call(e,i)),t&&(i?t.mount(i):t.unmount());const o=s.current;if(typeof o=="function")if(i){const d=o(i);typeof d=="function"&&(a.current=d)}else a.current?(a.current(),a.current=null):o(i);else o&&(o.current=i)},[t])}const EX=P.createContext({});function R0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function J4e(e,t,r,s,a,i){var v,y;const{visualElement:o}=P.useContext(Q_),l=P.useContext(wX),d=P.useContext(K_),c=P.useContext($8).reducedMotion,u=P.useRef(null),h=P.useRef(!1);s=s||l.renderer,!u.current&&s&&(u.current=s(e,{visualState:t,parent:o,props:r,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:c,isSVG:i}),h.current&&u.current&&(u.current.manuallyAnimateOnMount=!0));const f=u.current,m=P.useContext(EX);f&&!f.projection&&a&&(f.type==="html"||f.type==="svg")&&eSe(u.current,r,a,m);const p=P.useRef(!1);P.useInsertionEffect(()=>{f&&p.current&&f.update(r,d)});const g=r[IK],x=P.useRef(!!g&&!((v=window.MotionHandoffIsComplete)!=null&&v.call(window,g))&&((y=window.MotionHasOptimisedAnimation)==null?void 0:y.call(window,g)));return QG(()=>{h.current=!0,f&&(p.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),x.current&&f.animationState&&f.animationState.animateChanges())}),P.useEffect(()=>{f&&(!x.current&&f.animationState&&f.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)==null||b.call(window,g)}),x.current=!1),f.enteringChildren=void 0)}),f}function eSe(e,t,r,s){const{layoutId:a,layout:i,drag:o,dragConstraints:l,layoutScroll:d,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:kX(e.parent)),e.projection.setOptions({layoutId:a,layout:i,alwaysMeasureLayout:!!o||l&&R0(l),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:s,crossfade:u,layoutScroll:d,layoutRoot:c})}function kX(e){if(e)return e.options.allowProjection!==!1?e.projection:kX(e.parent)}function z3(e,{forwardMotionProps:t=!1,type:r}={},s,a){s&&I4e(s);const i=r?r==="svg":z8(e),o=i?Y4e:X4e;function l(c,u){let h;const f={...P.useContext($8),...c,layoutId:tSe(c)},{isStatic:m}=f,p=F4e(c),g=o(c,m);if(!m&&ZG){rSe();const x=nSe(f);h=x.MeasureLayout,p.visualElement=J4e(e,g,f,a,x.ProjectionNode,i)}return n.jsxs(Q_.Provider,{value:p,children:[h&&p.visualElement?n.jsx(h,{visualElement:p.visualElement,...f}):null,H4e(e,c,Q4e(g,p.visualElement,u),g,m,t,i)]})}l.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const d=P.forwardRef(l);return d[Z4e]=e,d}function tSe({layoutId:e}){const t=P.useContext(u8).id;return t&&e!==void 0?t+"-"+e:e}function rSe(e,t){P.useContext(wX).strict}function nSe(e){const t=_X(),{drag:r,layout:s}=t;if(!r&&!s)return{};const a={...r,...s};return{MeasureLayout:r!=null&&r.isEnabled(e)||s!=null&&s.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function sSe(e,t){if(typeof Proxy>"u")return z3;const r=new Map,s=(i,o)=>z3(i,o,e,t),a=(i,o)=>s(i,o);return new Proxy(a,{get:(i,o)=>o==="create"?s:(r.has(o)||r.set(o,z3(o,void 0,e,t)),r.get(o))})}const aSe=(e,t)=>t.isSVG??z8(e)?new D3e(t):new T3e(t,{allowProjection:e!==P.Fragment});class iSe extends zu{constructor(t){super(t),t.animationState||(t.animationState=z3e(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Y_(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let oSe=0;class lSe extends zu{constructor(){super(...arguments),this.id=oSe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const a=this.node.animationState.setActive("exit",!t);r&&!t&&a.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const cSe={animation:{Feature:iSe},exit:{Feature:lSe}};function w1(e){return{point:{x:e.pageX,y:e.pageY}}}const dSe=e=>t=>M8(t)&&e(t,w1(t));function J0(e,t,r,s){return tv(e,t,dSe(r),s)}const AX=({current:e})=>e?e.ownerDocument.defaultView:null,b7=(e,t)=>Math.abs(e-t);function uSe(e,t){const r=b7(e.x,t.x),s=b7(e.y,t.y);return Math.sqrt(r**2+s**2)}const w7=new Set(["auto","scroll"]);class TX{constructor(t,r,{transformPagePoint:s,contextWindow:a=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3,element:l}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=m=>{this.handleScroll(m.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=V3(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,g=uSe(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!g)return;const{point:x}=m,{timestamp:v}=Ba;this.history.push({...x,timestamp:v});const{onStart:y,onMove:b}=this.handlers;p||(y&&y(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,m)},this.handlePointerMove=(m,p)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=U3(p,this.transformPagePoint),fs.update(this.updatePoint,!0)},this.handlePointerUp=(m,p)=>{this.end();const{onEnd:g,onSessionEnd:x,resumeAnimation:v}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=V3(m.type==="pointercancel"?this.lastMoveEventInfo:U3(p,this.transformPagePoint),this.history);this.startEvent&&g&&g(m,y),x&&x(m,y)},!M8(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=s,this.distanceThreshold=o,this.contextWindow=a||window;const d=w1(t),c=U3(d,this.transformPagePoint),{point:u}=c,{timestamp:h}=Ba;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=r;f&&f(t,V3(c,this.history)),this.removeListeners=v1(J0(this.contextWindow,"pointermove",this.handlePointerMove),J0(this.contextWindow,"pointerup",this.handlePointerUp),J0(this.contextWindow,"pointercancel",this.handlePointerUp)),l&&this.startScrollTracking(l)}startScrollTracking(t){let r=t.parentElement;for(;r;){const s=getComputedStyle(r);(w7.has(s.overflowX)||w7.has(s.overflowY))&&this.scrollPositions.set(r,{x:r.scrollLeft,y:r.scrollTop}),r=r.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const r=this.scrollPositions.get(t);if(!r)return;const s=t===window,a=s?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},i={x:a.x-r.x,y:a.y-r.y};i.x===0&&i.y===0||(s?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=i.x,this.lastMoveEventInfo.point.y+=i.y):this.history.length>0&&(this.history[0].x-=i.x,this.history[0].y-=i.y),this.scrollPositions.set(t,a),fs.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Eu(this.updatePoint)}}function U3(e,t){return t?{point:t(e.point)}:e}function _7(e,t){return{x:e.x-t.x,y:e.y-t.y}}function V3({point:e},t){return{point:e,delta:_7(e,PX(t)),offset:_7(e,hSe(t)),velocity:fSe(t,.1)}}function hSe(e){return e[0]}function PX(e){return e[e.length-1]}function fSe(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,s=null;const a=PX(e);for(;r>=0&&(s=e[r],!(a.timestamp-s.timestamp>cc(t)));)r--;if(!s)return{x:0,y:0};const i=Ro(a.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(a.x-s.x)/i,y:(a.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function mSe(e,{min:t,max:r},s){return t!==void 0&&e<t?e=s?js(t,e,s.min):Math.max(e,t):r!==void 0&&e>r&&(e=s?js(r,e,s.max):Math.min(e,r)),e}function j7(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function pSe(e,{top:t,left:r,bottom:s,right:a}){return{x:j7(e.x,r,a),y:j7(e.y,t,s)}}function N7(e,t){let r=t.min-e.min,s=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,s]=[s,r]),{min:r,max:s}}function gSe(e,t){return{x:N7(e.x,t.x),y:N7(e.y,t.y)}}function xSe(e,t){let r=.5;const s=vi(e),a=vi(t);return a>s?r=Zx(t.min,t.max-s,e.min):s>a&&(r=Zx(e.min,e.max-a,t.min)),xc(0,1,r)}function vSe(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const XC=.35;function ySe(e=XC){return e===!1?e=0:e===!0&&(e=XC),{x:S7(e,"left","right"),y:S7(e,"top","bottom")}}function S7(e,t,r){return{min:C7(e,t),max:C7(e,r)}}function C7(e,t){return typeof e=="number"?e:e[t]||0}const bSe=new WeakMap;class wSe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=oa(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:s}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const i=h=>{r?(this.stopAnimation(),this.snapToCursor(w1(h).point)):this.pauseAnimation()},o=(h,f)=>{this.stopAnimation();const{drag:m,dragPropagation:p,onDragStart:g}=this.getProps();if(m&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=o3e(m),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Eo(v=>{let y=this.getAxisMotionValue(v).get()||0;if(dc.test(y)){const{projection:b}=this.visualElement;if(b&&b.layout){const j=b.layout.layoutBox[v];j&&(y=vi(j)*(parseFloat(y)/100))}}this.originPoint[v]=y}),g&&fs.postRender(()=>g(h,f)),zC(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},l=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f;const{dragPropagation:m,dragDirectionLock:p,onDirectionLock:g,onDrag:x}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:v}=f;if(p&&this.currentDirection===null){this.currentDirection=_Se(v),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",f.point,v),this.updateAxis("y",f.point,v),this.visualElement.render(),x&&x(h,f)},d=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f,this.stop(h,f),this.latestPointerEvent=null,this.latestPanInfo=null},c=()=>Eo(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)==null?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new TX(t,{onSessionStart:i,onStart:o,onMove:l,onSessionEnd:d,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:s,contextWindow:AX(this.visualElement),element:this.visualElement.current})}stop(t,r){const s=t||this.latestPointerEvent,a=r||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!a||!s)return;const{velocity:o}=a;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&fs.postRender(()=>l(s,a))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(t,r,s){const{drag:a}=this.getProps();if(!s||!Ry(t,a,this.currentDirection))return;const i=this.getAxisMotionValue(t);let o=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(o=mSe(o,this.constraints[t],this.elastic[t])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,a=this.constraints;t&&R0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&s?this.constraints=pSe(s.layoutBox,t):this.constraints=!1,this.elastic=ySe(r),a!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Eo(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=vSe(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!R0(t))return!1;const s=t.current;bp(s!==null,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.","drag-constraints-ref");const{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const i=N3e(s,a.root,this.visualElement.getTransformPagePoint());let o=gSe(a.layout.layoutBox,i);if(r){const l=r(w3e(o));this.hasMutatedConstraints=!!l,l&&(o=QK(l))}return o}startAnimation(t){const{drag:r,dragMomentum:s,dragElastic:a,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),d=this.constraints||{},c=Eo(u=>{if(!Ry(u,r,this.currentDirection))return;let h=d&&d[u]||{};o&&(h={min:0,max:0});const f=a?200:1e6,m=a?40:1e7,p={type:"inertia",velocity:s?t[u]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,p)});return Promise.all(c).then(l)}startAxisValueAnimation(t,r){const s=this.getAxisMotionValue(t);return zC(this.visualElement,t),s.start(A8(t,s,0,r,this.visualElement,!1))}stopAnimation(){Eo(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Eo(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),a=s[r];return a||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){Eo(r=>{const{drag:s}=this.getProps();if(!Ry(r,s,this.currentDirection))return;const{projection:a}=this.visualElement,i=this.getAxisMotionValue(r);if(a&&a.layout){const{min:o,max:l}=a.layout.layoutBox[r],d=i.get()||0;i.set(t[r]-js(o,l,.5)+d)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:s}=this.visualElement;if(!R0(r)||!s||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Eo(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const d=l.get();a[o]=xSe({min:d,max:d},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),Eo(o=>{if(!Ry(o,t,null))return;const l=this.getAxisMotionValue(o),{min:d,max:c}=this.constraints[o];l.set(js(d,c,a[o]))})}addListeners(){if(!this.visualElement.current)return;bSe.set(this.visualElement,this);const t=this.visualElement.current,r=J0(t,"pointerdown",d=>{const{drag:c,dragListener:u=!0}=this.getProps(),h=d.target,f=h!==t&&HK(h);c&&u&&!f&&this.start(d)}),s=()=>{const{dragConstraints:d}=this.getProps();R0(d)&&d.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,i=a.addEventListener("measure",s);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),fs.read(s);const o=tv(window,"resize",()=>this.scalePositionWithinConstraints()),l=a.addEventListener("didUpdate",({delta:d,hasLayoutChanged:c})=>{this.isDragging&&c&&(Eo(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=d[u].translate,h.set(h.get()+d[u].translate))}),this.visualElement.render())});return()=>{o(),r(),i(),l&&l()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:s=!1,dragPropagation:a=!1,dragConstraints:i=!1,dragElastic:o=XC,dragMomentum:l=!0}=t;return{...t,drag:r,dragDirectionLock:s,dragPropagation:a,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function Ry(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function _Se(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class jSe extends zu{constructor(t){super(t),this.removeGroupControls=Lo,this.removeListeners=Lo,this.controls=new wSe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Lo}update(){const{dragControls:t}=this.node.getProps(),{dragControls:r}=this.node.prevProps||{};t!==r&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const E7=e=>(t,r)=>{e&&fs.postRender(()=>e(t,r))};class NSe extends zu{constructor(){super(...arguments),this.removePointerDownListener=Lo}onPointerDown(t){this.session=new TX(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:AX(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:s,onPanEnd:a}=this.node.getProps();return{onSessionStart:E7(t),onStart:E7(r),onMove:s,onEnd:(i,o)=>{delete this.session,a&&fs.postRender(()=>a(i,o))}}}mount(){this.removePointerDownListener=J0(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let q3=!1;class SSe extends P.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s,layoutId:a}=this.props,{projection:i}=t;i&&(r.group&&r.group.add(i),s&&s.register&&a&&s.register(i),q3&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),bb.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:s,drag:a,isPresent:i}=this.props,{projection:o}=s;return o&&(o.isPresent=i,t.layoutDependency!==r&&o.setOptions({...o.options,layoutDependency:r}),q3=!0,a||t.layoutDependency!==r||r===void 0||t.isPresent!==i?o.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?o.promote():o.relegate()||fs.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),R8.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s}=this.props,{projection:a}=t;q3=!0,a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),s&&s.deregister&&s.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function OX(e){const[t,r]=bX(),s=P.useContext(u8);return n.jsx(SSe,{...e,layoutGroup:s,switchLayoutGroup:P.useContext(EX),isPresent:t,safeToRemove:r})}const CSe={pan:{Feature:NSe},drag:{Feature:jSe,ProjectionNode:yX,MeasureLayout:OX}};function k7(e,t,r){const{props:s}=e;e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",r==="Start");const a="onHover"+r,i=s[a];i&&fs.postRender(()=>i(t,w1(t)))}class ESe extends zu{mount(){const{current:t}=this.node;t&&(this.unmount=l3e(t,(r,s)=>(k7(this.node,s,"Start"),a=>k7(this.node,a,"End"))))}unmount(){}}class kSe extends zu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=v1(tv(this.node.current,"focus",()=>this.onFocus()),tv(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function A7(e,t,r){const{props:s}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&s.whileTap&&e.animationState.setActive("whileTap",r==="Start");const a="onTap"+(r==="End"?"":r),i=s[a];i&&fs.postRender(()=>i(t,w1(t)))}class ASe extends zu{mount(){const{current:t}=this.node;t&&(this.unmount=u3e(t,(r,s)=>(A7(this.node,s,"Start"),(a,{success:i})=>A7(this.node,a,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const YC=new WeakMap,W3=new WeakMap,TSe=e=>{const t=YC.get(e.target);t&&t(e)},PSe=e=>{e.forEach(TSe)};function OSe({root:e,...t}){const r=e||document;W3.has(r)||W3.set(r,{});const s=W3.get(r),a=JSON.stringify(t);return s[a]||(s[a]=new IntersectionObserver(PSe,{root:e,...t})),s[a]}function RSe(e,t,r){const s=OSe(t);return YC.set(e,r),s.observe(e),()=>{YC.delete(e),s.unobserve(e)}}const MSe={some:0,all:1};class ISe extends zu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:s,amount:a="some",once:i}=t,o={root:r?r.current:void 0,rootMargin:s,threshold:typeof a=="number"?a:MSe[a]},l=d=>{const{isIntersecting:c}=d;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),f=c?u:h;f&&f(d)};return RSe(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(DSe(t,r))&&this.startObserver()}unmount(){}}function DSe({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const LSe={inView:{Feature:ISe},tap:{Feature:ASe},focus:{Feature:kSe},hover:{Feature:ESe}},BSe={layout:{ProjectionNode:yX,MeasureLayout:OX}},$Se={...cSe,...LSe,...CSe,...BSe},Ja=sSe($Se,aSe);function FSe(){const{loyalty:e,rewards:t,redemptions:r,isLoading:s,getProgressToNextTier:a,canRedeemReward:i,redeemReward:o,getExpiringPoints:l,getTierInfo:d}=i1(),[c,u]=P.useState(null),h=async j=>{u(j);try{const T=await o(j);T&&de.success(`Resgatado! Use o cupom: ${T}`,{duration:8e3})}catch(T){de.error(T.message||"Erro ao resgatar")}finally{u(null)}};if(s)return n.jsx(yp,{title:"Le.Po Club",children:n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})})});const f=(e==null?void 0:e.currentTier)||"poa",m=d(f),{progress:p,pointsNeeded:g,nextTierName:x}=a((e==null?void 0:e.annualPoints)||0,f),v=l(),y=t.filter(j=>j.isFeatured),b=j=>{switch(j){case"poa_black":return"from-zinc-900 to-black text-white";case"poa_platinum":return"from-slate-200 to-slate-400 text-slate-900";case"poa_gold":return"from-amber-200 to-amber-500 text-amber-950";default:return"from-rose-50 to-rose-200 text-rose-900"}};return n.jsxs(yp,{title:"Le.Po Club",showBackButton:!0,children:[n.jsxs(Ja.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:He("relative overflow-hidden rounded-3xl p-8 mb-8 shadow-xl border-none","bg-gradient-to-br",b(f)),children:[n.jsx("div",{className:"absolute top-0 right-0 p-12 opacity-10",children:n.jsx(Vi,{className:"w-64 h-64 -mr-16 -mt-16 rotate-12"})}),n.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1/2 bg-gradient-to-t from-black/10 to-transparent"}),n.jsxs("div",{className:"relative z-10",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-md flex items-center justify-center shadow-inner",children:n.jsx(Vi,{className:"h-8 w-8"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium opacity-80 uppercase tracking-wider",children:"Nvel Atual"}),n.jsx("h1",{className:"font-serif text-3xl font-bold tracking-tight",children:m.name})]})]}),x&&n.jsxs("div",{className:"text-right hidden sm:block",children:[n.jsx("p",{className:"text-xs opacity-70 mb-1",children:"Prximo Nvel"}),n.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[x," ",n.jsx(In,{className:"w-4 h-4"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[n.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl p-4",children:[n.jsx("p",{className:"text-sm opacity-70 mb-1",children:"Pontos Disponveis"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(wi,{className:"w-5 h-5 fill-current"}),n.jsx("span",{className:"text-3xl font-bold",children:(e==null?void 0:e.currentPoints)||0})]})]}),n.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl p-4",children:[n.jsx("p",{className:"text-sm opacity-70 mb-1",children:"Pontos por R$ 1"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Gr,{className:"w-5 h-5"}),n.jsxs("span",{className:"text-3xl font-bold",children:[m.multiplier,"x"]})]})]})]}),x&&n.jsxs("div",{className:"relative pt-2",children:[n.jsxs("div",{className:"flex justify-between text-xs font-medium mb-2 opacity-90",children:[n.jsxs("span",{children:[e==null?void 0:e.annualPoints," pontos anuais"]}),n.jsxs("span",{children:["Faltam ",g," para ",x]})]}),n.jsx("div",{className:"h-3 bg-black/20 rounded-full overflow-hidden backdrop-blur-sm",children:n.jsx(Ja.div,{initial:{width:0},animate:{width:`${p}%`},transition:{duration:1.5,ease:"easeOut"},className:"h-full bg-white/90 shadow-[0_0_10px_rgba(255,255,255,0.5)]"})})]})]})]}),n.jsxs("div",{className:"mb-8",children:[n.jsxs("h3",{className:"font-serif text-lg font-medium mb-4 flex items-center gap-2",children:[n.jsx(wi,{className:"w-5 h-5 text-accent"}),"Benefcios do seu nvel"]}),n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:m.benefits.map((j,T)=>n.jsxs(Ja.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:T*.1},className:"flex items-center gap-3 p-4 rounded-xl bg-card border border-border/50 shadow-sm",children:[n.jsx("div",{className:He("p-2 rounded-full",f==="poa_black"?"bg-zinc-100 text-black":"bg-accent/10 text-accent"),children:n.jsx(rse,{className:"w-4 h-4"})}),n.jsx("span",{className:"text-sm font-medium",children:j})]},T))})]}),v>0&&n.jsxs(Ja.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex items-center gap-3 p-4 mb-8 bg-amber-50 border border-amber-200 rounded-xl text-amber-800",children:[n.jsx(Sn,{className:"h-5 w-5 shrink-0"}),n.jsxs("div",{className:"text-sm",children:[n.jsxs("span",{className:"font-semibold",children:[v," pontos"]})," expiram em 30 dias. Aproveite para resgatar algo especial!"]})]}),n.jsxs(Hi,{defaultValue:"rewards",className:"w-full",children:[n.jsxs(Si,{className:"w-full mb-6 p-1 bg-muted/50 rounded-xl",children:[n.jsx(br,{value:"rewards",className:"flex-1 rounded-lg",children:"Recompensas"}),n.jsx(br,{value:"my-rewards",className:"flex-1 rounded-lg",children:"Meus Resgates"})]}),n.jsxs(kr,{value:"rewards",className:"space-y-8",children:[y.length>0&&n.jsxs("section",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(Gr,{className:"h-5 w-5 text-amber-500"}),n.jsx("h3",{className:"font-serif text-lg font-medium",children:"Destaques para voc"})]}),n.jsx("div",{className:"grid grid-cols-2 gap-4",children:y.map(j=>n.jsx(hM,{reward:j,currentPoints:(e==null?void 0:e.currentPoints)||0,currentTier:f,onRedeem:h,isRedeeming:c===j.id,canRedeem:i(j)},j.id))})]}),n.jsxs("section",{children:[n.jsx("h3",{className:"font-serif text-lg font-medium mb-4",children:"Todas as recompensas"}),n.jsx("div",{className:"grid grid-cols-2 gap-4",children:t.map(j=>n.jsx(hM,{reward:j,currentPoints:(e==null?void 0:e.currentPoints)||0,currentTier:f,onRedeem:h,isRedeeming:c===j.id,canRedeem:i(j)},j.id))})]})]}),n.jsx(kr,{value:"my-rewards",children:r.length===0?n.jsxs("div",{className:"text-center py-16 bg-muted/30 rounded-3xl border border-dashed",children:[n.jsx(Pn,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground/30"}),n.jsx("h3",{className:"text-lg font-medium mb-2",children:"Nenhum resgate ainda"}),n.jsx("p",{className:"text-muted-foreground text-sm max-w-xs mx-auto",children:"Seus pontos acumulados podem ser trocados por produtos e descontos incrveis."})]}):n.jsx("div",{className:"space-y-4",children:r.map(j=>{var T;return n.jsxs("div",{className:"bg-card border rounded-2xl p-5 shadow-sm hover:shadow-md transition-shadow",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-lg",children:((T=j.reward)==null?void 0:T.name)||"Recompensa"}),n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsx("div",{className:"bg-muted px-3 py-1 rounded-md font-mono text-sm font-medium select-all",children:j.couponCode}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Copie o cdigo"})]})]}),n.jsx("span",{className:`text-xs px-3 py-1 rounded-full font-medium ${j.status==="active"?"bg-green-100 text-green-700":j.status==="used"?"bg-gray-100 text-gray-500":"bg-red-100 text-red-700"}`,children:j.status==="active"?"Ativo":j.status==="used"?"Usado":"Expirado"})]}),n.jsxs("div",{className:"mt-4 pt-4 border-t flex justify-between items-center text-xs text-muted-foreground",children:[n.jsxs("span",{children:["Resgatado em ",new Date(j.createdAt).toLocaleDateString("pt-BR")]}),n.jsxs("span",{children:["Vlido at ",new Date(j.expiresAt).toLocaleDateString("pt-BR")]})]})]},j.id)})})})]})]})}function zSe(){const{user:e}=qn(),{loyalty:t,monthlyMissionLimit:r,getMissionPointsRemaining:s}=i1(),[a,i]=P.useState([]),[o,l]=P.useState([]),[d,c]=P.useState(!0);if(P.useEffect(()=>{e?Promise.all([le.from("mission_attempts").select("mission_id, status, completed_at").eq("user_id",e.id),le.from("profiles").select("completed_missions").eq("user_id",e.id).maybeSingle()]).then(([x,v])=>{var y;i(x.data||[]),l(((y=v.data)==null?void 0:y.completed_missions)||[]),c(!1)}):c(!1)},[e]),d)return n.jsx(yp,{title:"Mdulos de Estilo",showBackButton:!0,children:n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-foreground/20"})})});const u=qx(o),h=(t==null?void 0:t.currentPoints)||0,f=(t==null?void 0:t.weeklyMissionPoints)||0,m=s(f),p=a.filter(x=>x.status==="in_progress"),g=o.map(x=>{const v=a.find(y=>y.mission_id===x&&y.status==="completed");return{id:x,completedAt:v==null?void 0:v.completed_at}});return n.jsxs(yp,{title:"Mdulos de Estilo",showBackButton:!0,children:[n.jsx("div",{className:"border border-foreground/10 p-5 mb-6",children:n.jsxs("div",{className:"flex items-end justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] tracking-[0.3em] uppercase text-foreground/40 font-medium mb-1",children:"Seus pontos no Le.Po Club"}),n.jsx("p",{className:"text-3xl font-light text-foreground",children:h.toLocaleString()})]}),n.jsx("div",{className:"text-right",children:n.jsx("p",{className:"text-[11px] text-foreground/40 tracking-wide",children:(t==null?void 0:t.currentTier)==="poa"?"Po":(t==null?void 0:t.currentTier)==="poa_gold"?"Po Gold":(t==null?void 0:t.currentTier)==="poa_platinum"?"Po Platinum":(t==null?void 0:t.currentTier)==="poa_black"?"Po Black":"Po"})})]})}),n.jsxs("div",{className:"border border-foreground/10 p-4 mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("p",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/40 font-medium",children:"Progresso mensal de mdulos"}),n.jsxs("span",{className:"text-[11px] text-foreground/40",children:[m," pts restantes"]})]}),n.jsx("div",{className:"h-px bg-border relative",children:n.jsx("div",{className:"h-px bg-foreground transition-all duration-700",style:{width:`${f/r*100}%`}})}),n.jsxs("p",{className:"text-[11px] text-foreground/30 mt-2",children:[f," / ",r," Pos este ms"]})]}),p.length>0&&n.jsxs("div",{className:"mb-8",children:[n.jsx("h2",{className:"text-[11px] tracking-[0.2em] uppercase text-foreground/40 font-medium mb-4",children:"Em andamento"}),n.jsx("div",{className:"space-y-3",children:p.map(x=>{var y;const v=dw(x.mission_id);return v?n.jsx(H3,{id:v.id,title:v.title,description:v.subtitle,questionCount:(y=v.questions)==null?void 0:y.length,status:"in_progress"},x.mission_id):null})})]}),u.length>0&&n.jsxs("div",{className:"mb-8",children:[n.jsx("h2",{className:"text-[11px] tracking-[0.2em] uppercase text-foreground/40 font-medium mb-4",children:"Disponveis"}),n.jsx("div",{className:"space-y-3",children:u.map(x=>{var v;return n.jsx(H3,{id:x.id,title:x.title,description:x.subtitle,questionCount:(v=x.questions)==null?void 0:v.length,status:"available"},x.id)})})]}),g.length>0&&n.jsxs("div",{children:[n.jsx("h2",{className:"text-[11px] tracking-[0.2em] uppercase text-foreground/40 font-medium mb-4",children:"Concludos"}),n.jsx("div",{className:"space-y-3",children:g.map(({id:x,completedAt:v})=>{const y=dw(x);return y?n.jsx(H3,{id:y.id,title:y.title,description:y.subtitle,status:"completed",completedAt:v||void 0},x):null})})]}),u.length===0&&p.length===0&&g.length===0&&n.jsx("div",{className:"text-center py-16",children:n.jsx("p",{className:"text-foreground/40 text-sm font-light",children:"Faa o quiz de estilo primeiro para desbloquear mdulos"})})]})}function H3({id:e,title:t,description:r,questionCount:s,status:a,completedAt:i}){const o=a==="completed";return n.jsx("div",{className:He("border p-5 transition-all duration-300",o?"border-foreground/10 bg-foreground/[0.02]":"border-border hover:border-foreground/30"),children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:He("text-sm tracking-wide",o?"text-foreground/50":"font-medium"),children:t}),o&&n.jsx(mn,{className:"h-3.5 w-3.5 text-foreground/30 shrink-0"})]}),n.jsx("p",{className:"text-[12px] text-foreground/40 font-light",children:r}),n.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[s&&n.jsxs("span",{className:"text-[11px] text-foreground/30 tracking-wide",children:[s," perguntas"]}),o&&i&&n.jsxs("span",{className:"text-[11px] text-foreground/30",children:["Concludo em ",new Date(i).toLocaleDateString("pt-BR")]})]})]}),n.jsx("div",{className:"shrink-0",children:o?n.jsx("span",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/30 font-medium",children:"Concludo"}):n.jsx(Ft,{to:`/missao/${e}`,children:n.jsxs("button",{className:"px-5 py-2.5 border border-foreground/20 text-[11px] tracking-[0.15em] uppercase font-medium text-foreground/60 transition-all duration-300 hover:border-foreground hover:text-foreground flex items-center gap-2",children:[a==="in_progress"?"Continuar":"Iniciar",n.jsx(hs,{className:"h-3 w-3"})]})})})]})})}const Xf={pendente:{label:"Pendente",icon:Lr,color:"bg-amber-100 text-amber-800"},aguardando_pagamento:{label:"Pendente",icon:ms,color:"bg-orange-100 text-orange-800"},confirmado:{label:"Confirmado",icon:Sr,color:"bg-blue-100 text-blue-800"},pago:{label:"Pago",icon:Sr,color:"bg-green-100 text-green-800"},etiqueta_gerada:{label:"Enviado",icon:yn,color:"bg-purple-100 text-purple-800"},enviado:{label:"Enviado",icon:yn,color:"bg-purple-100 text-purple-800"},postado:{label:"Enviado",icon:yn,color:"bg-purple-100 text-purple-800"},em_rota:{label:"Em rota de entrega",icon:yn,color:"bg-indigo-100 text-indigo-800"},entregue:{label:"Entregue",icon:Sr,color:"bg-green-100 text-green-800"},cancelado:{label:"Cancelado",icon:sn,color:"bg-red-100 text-red-800"},aberto:{label:"Pendente",icon:Lr,color:"bg-amber-100 text-amber-800"},expirado:{label:"Pendente",icon:ms,color:"bg-orange-100 text-orange-800"},pagamento_rejeitado:{label:"Pagamento rejeitado",icon:sn,color:"bg-red-100 text-red-800"},reembolsado:{label:"Reembolsado",icon:Qr,color:"bg-gray-100 text-gray-800"}},USe={label:"Em andamento",icon:Lr,color:"bg-blue-100 text-blue-800"},ZC=e=>{if(!e||e.startsWith("ORD-")||e.startsWith("ORD"))return!1;const t=/^[A-Z]{2}\d{9}BR$/.test(e),r=/^\d{8,20}$/.test(e);return t||r},RX=(e,t)=>{if(ZC(t)){const r=Xf.enviado;return e==="entregue"?Xf.entregue:e==="cancelado"?Xf.cancelado:e==="reembolsado"?Xf.reembolsado:r}return e&&Xf[e]?Xf[e]:USe};function VSe(){const e=pr(),{user:t,isLoading:r}=qn(),[s,a]=P.useState([]),[i,o]=P.useState(!0);P.useEffect(()=>{!r&&!t&&e("/minha-conta")},[t,r,e]),P.useEffect(()=>{t&&l()},[t]);const l=async()=>{if(t)try{const{data:u,error:h}=await le.from("orders").select("id, created_at, status, total, customer_name, tracking_code").eq("user_id",t.id).order("created_at",{ascending:!1});if(h)throw h;const{data:f,error:m}=await le.from("live_carts").select("id, created_at, status, total").eq("user_id",t.id).order("created_at",{ascending:!1});m&&m.code!=="PGRST100"&&console.error("Error fetching live orders:",m);const p=await Promise.all((u||[]).map(async v=>{const{count:y}=await le.from("order_items").select("*",{count:"exact",head:!0}).eq("order_id",v.id);return{...v,items_count:y||0,type:"regular"}})),g=(f||[]).map(v=>{var y;return{id:v.id,created_at:v.created_at,status:v.status,total:v.total,customer_name:((y=t==null?void 0:t.user_metadata)==null?void 0:y.name)||"Cliente",tracking_code:null,items_count:1,type:"live"}}),x=[...p,...g].sort((v,y)=>new Date(y.created_at).getTime()-new Date(v.created_at).getTime());a(x)}catch(u){console.error("Error loading orders:",u)}finally{o(!1)}},d=u=>new Date(u).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"}),c=u=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(u);return r?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8",children:[n.jsx(Wr,{className:"h-8 w-48 mb-6"}),n.jsx("div",{className:"space-y-4",children:[1,2,3].map(u=>n.jsx(Wr,{className:"h-24 w-full"},u))})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[n.jsx("h1",{className:"font-serif text-2xl mb-6",children:"Meus Pedidos e Lives"}),i?n.jsx("div",{className:"space-y-4",children:[1,2,3].map(u=>n.jsx(Wr,{className:"h-24 w-full"},u))}):s.length===0?n.jsx($e,{children:n.jsxs(Fe,{className:"py-12 text-center",children:[n.jsx(Vt,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"Voc ainda no fez nenhum pedido"}),n.jsx(Ft,{to:"/catalogo",className:"text-accent hover:underline",children:"Conferir peas "})]})}):n.jsx("div",{className:"space-y-3",children:s.map(u=>{const h=RX(u.status,u.tracking_code),f=h.icon,m=u.id.slice(0,8).toUpperCase(),p=po(Mhe(m));return n.jsx($e,{className:"hover:shadow-md transition-shadow",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Ft,{to:`/meus-pedidos/${u.id}`,className:"flex-1",children:n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"font-medium text-sm",children:["Pedido #",m]}),n.jsxs(ke,{className:`${h.color} border-0 gap-1`,children:[n.jsx(f,{className:"h-3 w-3"}),h.label]})]}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[d(u.created_at),"  ",u.items_count," ",u.items_count===1?"item":"itens"]}),n.jsx("p",{className:"font-semibold",children:c(u.total)})]})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(S_,{href:p,variant:"circle"}),n.jsx(Ft,{to:`/meus-pedidos/${u.id}`,children:n.jsx(In,{className:"h-5 w-5 text-muted-foreground"})})]})]})})},u.id)})})]})]})}function qSe(){const e=pr(),{id:t}=ta(),{user:r,isLoading:s}=qn(),[a,i]=P.useState(null),[o,l]=P.useState([]),[d,c]=P.useState(!0),[u,h]=P.useState(!1),[f,m]=P.useState(!1),[p,g]=P.useState(null);P.useEffect(()=>{!s&&!r&&e("/minha-conta")},[r,s,e]),P.useEffect(()=>{r&&t&&x()},[r,t]);const x=async()=>{if(!r||!t)return;const{data:G,error:I}=await le.from("orders").select("*").eq("id",t).eq("user_id",r.id).maybeSingle();if(I||!G){de.error("Pedido no encontrado"),e("/meus-pedidos");return}i(G);const{data:F}=await le.from("order_items").select("*").eq("order_id",t);l(F||[]),c(!1)};P.useEffect(()=>{if(!(a!=null&&a.reserved_until)||a.status!=="aguardando_pagamento"){g(null);return}const G=()=>{const F=new Date,E=new Date(a.reserved_until).getTime()-F.getTime();if(E<=0){g("expirado");return}const N=Math.floor(E/6e4),C=Math.floor(E%6e4/1e3);g(`${N}:${C.toString().padStart(2,"0")}`)};G();const I=setInterval(G,1e3);return()=>clearInterval(I)},[a==null?void 0:a.reserved_until,a==null?void 0:a.status]);const v=async()=>{if(!a)return;h(!0);const{error:G}=await le.from("orders").update({status:"cancelado"}).eq("id",a.id);G?de.error("Erro ao cancelar pedido"):(de.success("Pedido cancelado"),i({...a,status:"cancelado"})),h(!1)},y=async()=>{if(a){if(console.log("[PedidoDetalhe] Iniciando pagamento...",{orderId:a.id}),a.mp_checkout_url){console.log("[PedidoDetalhe] Redirecionando para URL existente:",a.mp_checkout_url),window.location.href=a.mp_checkout_url;return}m(!0);try{console.log("[PedidoDetalhe] Invocando create-mp-preference...");const{data:G,error:I}=await le.functions.invoke("create-mp-preference",{body:{order_id:a.id,payer_email:(r==null?void 0:r.email)||""}});if(console.log("[PedidoDetalhe] Retorno da Edge Function:",{data:G,error:I}),I){console.error("[PedidoDetalhe] Erro RPC:",I);let S="Erro ao conectar com servidor de pagamento.";try{typeof I=="string"&&(S=I),I.message&&(S=I.message),I.message==="Failed to fetch"&&(S="Erro de conexo (CORS/Network). Verifique sua internet.")}catch{}de.error(`${S} Tente novamente.`);return}if(G!=null&&G.error_code||G!=null&&G.error){console.error("[PedidoDetalhe] Erro retornado pela API:",G),de.error(`Erro no pagamento: ${G.message||G.error||"Falha desconhecida"}`);return}const F=G.init_point||G.sandbox_init_point;if(F){console.log("[PedidoDetalhe] Link gerado:",F);const S={...a,mp_checkout_url:F,mp_preference_id:G.preference_id};i(S),await le.from("orders").update({mp_checkout_url:F,mp_preference_id:G.preference_id,total:G.calculated_total||a.total}).eq("id",a.id),window.location.href=F}else console.error("[PedidoDetalhe] Nenhuma URL retornada:",G),de.error("Link de pagamento no disponvel (resposta vazia).")}catch(G){console.error("[PedidoDetalhe] Exceo crtica:",G),de.error(`Erro de conexo: ${G.message||"Tente novamente."}`)}finally{m(!1)}}},b=G=>new Date(G).toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),j=G=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(G),T=G=>G.slice(0,8).toUpperCase(),O=()=>{if(!a)return"";const G=o.map(F=>({name:F.product_name,size:F.size,color:F.color,quantity:F.quantity})),I=Rhe(T(a.id),G,j(a.total));return po(I)},R=a!=null&&a.reserved_until?new Date(a.reserved_until)<new Date:!1,D=(a==null?void 0:a.status)==="aguardando_pagamento"&&!R,B=a&&(a.status==="pendente"||a.status==="aguardando_pagamento")&&!R;if(s||d)return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[n.jsx(Wr,{className:"h-8 w-48 mb-6"}),n.jsx(Wr,{className:"h-64 w-full"})]})]});if(!a)return null;const q=RX(a.status,a.tracking_code),Y=q.icon;return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>e("/meus-pedidos"),className:"mb-4",children:[n.jsx(Ts,{className:"h-4 w-4 mr-1"}),"Voltar"]}),n.jsxs("div",{className:"flex items-start justify-between mb-6",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"font-serif text-2xl mb-1",children:["Pedido #",T(a.id)]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:b(a.created_at)})]}),n.jsxs(ke,{className:`${q.color} border-0 gap-1`,children:[n.jsx(Y,{className:"h-3 w-3"}),q.label]})]}),ZC(a.tracking_code)&&n.jsx($e,{className:"mb-4 border-purple-200 bg-purple-50 dark:bg-purple-950/20",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(yn,{className:"h-5 w-5 text-purple-600 shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-purple-800 dark:text-purple-200",children:"Cdigo de rastreio"}),n.jsx("p",{className:"font-mono text-lg text-purple-900 dark:text-purple-100",children:a.tracking_code})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 border-purple-200 text-purple-700 hover:bg-purple-100",onClick:async()=>{await af(a.tracking_code)&&de.success("Cdigo copiado!")},children:[n.jsx(Wa,{className:"h-4 w-4"}),"Copiar cdigo"]}),n.jsxs(he,{variant:"default",size:"sm",className:"gap-2 bg-purple-600 hover:bg-purple-700",onClick:()=>{window.open(`https://rastreamento.correios.com.br/app/index.php?objeto=${a.tracking_code}`,"_blank")},children:[n.jsx(Zs,{className:"h-4 w-4"}),"Rastrear nos Correios"]})]})]})})}),a.status==="etiqueta_gerada"&&!ZC(a.tracking_code)&&n.jsx($e,{className:"mb-4 border-purple-200 bg-purple-50 dark:bg-purple-950/20",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(yn,{className:"h-5 w-5 text-purple-600 shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-purple-800 dark:text-purple-200",children:"Pedido em preparao para envio"}),n.jsx("p",{className:"text-xs text-purple-700 dark:text-purple-300",children:"O cdigo de rastreio estar disponvel em breve."})]})]})})}),n.jsxs($e,{className:"mb-4",children:[n.jsx(Dt,{className:"pb-2",children:n.jsx(Lt,{className:"text-sm font-medium text-muted-foreground",children:"Itens do pedido"})}),n.jsxs(Fe,{className:"space-y-4",children:[o.map(G=>n.jsxs("div",{className:"flex gap-3",children:[G.image_url?n.jsx("img",{src:G.image_url,alt:G.product_name,className:"w-16 h-16 object-cover rounded-lg"}):n.jsx("div",{className:"w-16 h-16 bg-secondary rounded-lg flex items-center justify-center",children:n.jsx(Vt,{className:"h-6 w-6 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:G.product_name}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Tamanho: ",G.size,G.color&&`  Cor: ${G.color}`]}),n.jsxs("div",{className:"flex justify-between items-center mt-1",children:[n.jsxs("span",{className:"text-sm text-muted-foreground",children:["Qtd: ",G.quantity]}),n.jsx("span",{className:"font-medium",children:j(G.product_price*G.quantity)})]})]})]},G.id)),n.jsx(Ca,{}),n.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{className:"text-accent",children:j(a.total)})]})]})]}),n.jsxs($e,{className:"mb-6",children:[n.jsx(Dt,{className:"pb-2",children:n.jsx(Lt,{className:"text-sm font-medium text-muted-foreground",children:"Endereo de entrega"})}),n.jsxs(Fe,{children:[n.jsx("p",{className:"font-medium",children:a.customer_name}),n.jsx("p",{className:"text-sm text-muted-foreground",children:a.customer_phone}),n.jsx("p",{className:"text-sm mt-2",children:a.customer_address})]})]}),n.jsxs("div",{className:"space-y-3",children:[a.status==="aguardando_pagamento"&&R&&n.jsx($e,{className:"border-amber-200 bg-amber-50 dark:bg-amber-950/20",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Or,{className:"h-5 w-5 text-amber-600 shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-amber-800 dark:text-amber-200",children:"Reserva expirada"}),n.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-300",children:"Os itens podem ter sido liberados para outros clientes. Entre em contato para verificar disponibilidade."})]})]})})}),a.status==="aguardando_pagamento"&&p&&p!=="expirado"&&n.jsx($e,{className:"border-orange-200 bg-orange-50 dark:bg-orange-950/20",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(kS,{className:"h-4 w-4 text-orange-600"}),n.jsx("span",{className:"text-sm text-orange-700 dark:text-orange-300",children:"Reserva expira em:"})]}),n.jsx("span",{className:"font-mono font-bold text-orange-800 dark:text-orange-200",children:p})]})})}),D&&n.jsxs(he,{className:"w-full gap-2",onClick:y,disabled:f,children:[f?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):n.jsx(ms,{className:"h-4 w-4"}),f?"Gerando link...":"Pagar agora"]}),!D&&a.payment_link&&a.status==="pendente"&&n.jsx(he,{className:"w-full gap-2",asChild:!0,children:n.jsxs("a",{href:a.payment_link,target:"_blank",rel:"noopener noreferrer",children:[n.jsx(ms,{className:"h-4 w-4"}),"Pagar agora"]})}),n.jsx(S_,{href:O(),label:a.status==="cancelado"?"Falar com a loja mesmo assim":"Falar no WhatsApp",showMicrocopy:a.status!=="cancelado"}),B&&n.jsxs(_c,{children:[n.jsx(o1,{asChild:!0,children:n.jsxs(he,{variant:"ghost",className:"w-full text-destructive hover:text-destructive gap-2",children:[n.jsx(sn,{className:"h-4 w-4"}),"Cancelar pedido"]})}),n.jsxs(Tl,{children:[n.jsxs(Pl,{children:[n.jsx(Ol,{children:"Cancelar pedido?"}),n.jsx(Rl,{children:"Esta ao no pode ser desfeita. O pedido ser cancelado permanentemente."})]}),n.jsxs(jc,{children:[n.jsx(Sc,{children:"Voltar"}),n.jsx(Nc,{onClick:v,disabled:u,className:"bg-destructive hover:bg-destructive/90",children:u?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):"Confirmar cancelamento"})]})]})]})]})]})]})}function WSe(){const e=pr(),{user:t,isLoading:r}=qn(),{addItem:s}=Lu(),[a,i]=P.useState([]),[o,l]=P.useState(!0);P.useEffect(()=>{!r&&!t&&e("/minha-conta")},[t,r,e]),P.useEffect(()=>{t&&d()},[t]);const d=async()=>{if(!t)return;const{data:m,error:p}=await le.from("print_requests").select("id, created_at, image_path, size, status, linked_product_id").eq("user_id",t.id).order("created_at",{ascending:!1});if(!p&&m){const g=await Promise.all(m.map(async x=>{if(x.linked_product_id){const{data:v}=await le.from("product_catalog").select("id, name, price, image_url, sizes").eq("id",x.linked_product_id).single();return{...x,linked_product:v}}return{...x,linked_product:null}}));i(g)}l(!1)},c=m=>{const{data:p}=le.storage.from("prints").getPublicUrl(m);return p.publicUrl},u=m=>new Date(m).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"}),h=m=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(m),f=m=>{!m.linked_product||!m.size||(s({productId:m.linked_product.id,name:m.linked_product.name,price:m.linked_product.price,originalPrice:m.linked_product.price,discountPercent:0,size:m.size,imageUrl:m.linked_product.image_url||void 0}),de.success("Produto adicionado ao carrinho!"),e("/carrinho"))};return r?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8",children:[n.jsx(Wr,{className:"h-8 w-48 mb-6"}),n.jsx("div",{className:"space-y-4",children:[1,2].map(m=>n.jsx(Wr,{className:"h-32 w-full"},m))})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h1",{className:"font-serif text-2xl",children:"Meus Prints"}),n.jsx(Ft,{to:"/enviar-print",children:n.jsxs(he,{size:"sm",className:"gap-2",children:[n.jsx(ka,{className:"h-4 w-4"}),"Enviar novo"]})})]}),o?n.jsx("div",{className:"space-y-4",children:[1,2].map(m=>n.jsx(Wr,{className:"h-32 w-full"},m))}):a.length===0?n.jsx($e,{children:n.jsxs(Fe,{className:"py-12 text-center",children:[n.jsx(ka,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"Voc ainda no enviou nenhum print"}),n.jsx(Ft,{to:"/enviar-print",className:"text-accent hover:underline",children:"Enviar print do story "})]})}):n.jsx("div",{className:"space-y-4",children:a.map(m=>n.jsx($e,{children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex gap-4",children:[n.jsx("div",{className:"w-20 h-24 bg-stone-50 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:c(m.image_path),alt:"Print enviado",className:"w-full h-full object-contain"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:u(m.created_at)}),m.linked_product?n.jsxs(ke,{className:"bg-green-100 text-green-800 border-0 gap-1",children:[n.jsx(Sr,{className:"h-3 w-3"}),"Encontrado"]}):n.jsxs(ke,{className:"bg-amber-100 text-amber-800 border-0 gap-1",children:[n.jsx(Lr,{className:"h-3 w-3"}),"Em anlise"]})]}),m.size&&n.jsxs("p",{className:"text-sm mb-2",children:["Tamanho: ",n.jsx("span",{className:"font-medium",children:m.size})]}),m.linked_product&&n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-secondary/50 rounded-lg",children:[m.linked_product.image_url&&n.jsx("div",{className:"w-12 h-14 bg-stone-50 rounded overflow-hidden",children:n.jsx("img",{src:m.linked_product.image_url,alt:m.linked_product.name,className:"w-full h-full object-contain"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-sm truncate",children:m.linked_product.name}),n.jsx("p",{className:"text-sm text-accent",children:h(m.linked_product.price)})]}),n.jsxs(he,{size:"sm",onClick:()=>f(m),className:"gap-1",children:[n.jsx(hn,{className:"h-4 w-4"}),"Comprar"]})]})]})]})})},m.id))})]})]})}const HSe=["PP","P","M","G","GG","34","36","38","40","42","44","46"],GSe={zipCode:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:"",reference:"",document:""};function KSe(){const e=pr(),{user:t,isLoading:r,signOut:s}=qn(),[a,i]=P.useState(!0),[o,l]=P.useState(!1),[d,c]=P.useState(!1),[u,h]=P.useState({name:"",whatsapp:"",instagram_handle:"",birth_date:"",preferred_sizes:[],style_preferences:"",addressData:GSe});P.useEffect(()=>{!r&&!t&&e("/minha-conta")},[t,r,e]),P.useEffect(()=>{t&&f()},[t]);const f=async()=>{if(!t)return;const{data:v,error:y}=await le.from("profiles").select("name, whatsapp, instagram_handle, birth_date, preferred_sizes, style_preferences, address_line, city, state, zip_code, address_reference").eq("user_id",t.id).single();if(!y&&v){let b="",j="",T="",O="";if(v.address_line){const R=v.address_line.split(",").map(D=>D.trim());if(R.length>=1&&(b=R[0]),R.length>=2){const D=R[1].match(/^(\d+)\s*(.*)/);D?(j=D[1],T=D[2]||""):O=R[1]}R.length>=3&&(O=R[2])}h({name:v.name||"",whatsapp:v.whatsapp||"",instagram_handle:v.instagram_handle||"",birth_date:v.birth_date||"",preferred_sizes:v.preferred_sizes||[],style_preferences:v.style_preferences||"",addressData:{zipCode:v.zip_code||"",street:b,number:j,complement:T,neighborhood:O,city:v.city||"",state:v.state||"",reference:v.address_reference||"",document:""}}),!v.address_line&&!v.zip_code&&c(!0)}i(!1)},m=async()=>{if(!t)return;l(!0);const v=[u.addressData.street];u.addressData.number&&v.push(u.addressData.number+(u.addressData.complement?" "+u.addressData.complement:"")),u.addressData.neighborhood&&v.push(u.addressData.neighborhood);const y=v.filter(Boolean).join(", "),b=u.instagram_handle.replace(/@/g,"").replace(/\s/g,"").toLowerCase().trim()||null,{error:j}=await le.from("profiles").update({name:u.name,whatsapp:u.whatsapp,instagram_handle:b,birth_date:u.birth_date||null,preferred_sizes:u.preferred_sizes,style_preferences:u.style_preferences,address_line:y,city:u.addressData.city,state:u.addressData.state,zip_code:u.addressData.zipCode,address_reference:u.addressData.reference}).eq("user_id",t.id);j?de.error("Erro ao salvar. Tente novamente."):(de.success("Perfil atualizado!"),c(!1)),l(!1)},p=v=>{h(y=>({...y,preferred_sizes:y.preferred_sizes.includes(v)?y.preferred_sizes.filter(b=>b!==v):[...y.preferred_sizes,v]}))},g=async()=>{await s(),e("/"),de.success("At logo!")},x=u.addressData.street||u.addressData.zipCode;return r||a?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-lg",children:[n.jsx(Wr,{className:"h-8 w-48 mb-6"}),n.jsxs("div",{className:"space-y-4",children:[n.jsx(Wr,{className:"h-24 w-full"}),n.jsx(Wr,{className:"h-24 w-full"})]})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-lg",children:[n.jsx("h1",{className:"font-serif text-2xl mb-6",children:"Meu Perfil"}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"text-base flex items-center gap-2",children:[n.jsx(Dn,{className:"h-4 w-4"}),"Dados pessoais"]})}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"name",children:"Nome"}),n.jsx(et,{id:"name",value:u.name,onChange:v=>h(y=>({...y,name:v.target.value})),placeholder:"Seu nome"})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"email",children:"Email"}),n.jsx(et,{id:"email",value:(t==null?void 0:t.email)||"",disabled:!0,className:"bg-muted"})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"whatsapp",children:"WhatsApp"}),n.jsx(et,{id:"whatsapp",value:u.whatsapp,onChange:v=>h(y=>({...y,whatsapp:v.target.value})),placeholder:"(11) 99999-9999"})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"instagram",children:"Instagram"}),n.jsx(et,{id:"instagram",value:u.instagram_handle,onChange:v=>h(y=>({...y,instagram_handle:v.target.value})),placeholder:"@seuinstagram"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Preencha para ver seus pedidos de live aqui na sua conta"})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"birth_date",children:"Data de nascimento"}),n.jsx(et,{id:"birth_date",type:"date",value:u.birth_date,onChange:v=>h(y=>({...y,birth_date:v.target.value}))}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Usada para sua ao exclusiva de aniversrio no Le.Po Club"})]})]})]}),n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"text-base flex items-center justify-between",children:[n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(mo,{className:"h-4 w-4"}),"Endereo de entrega"]}),x&&!d&&n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>c(!0),className:"text-muted-foreground hover:text-foreground",children:[n.jsx(Js,{className:"h-4 w-4 mr-1"}),"Editar"]})]})}),n.jsx(Fe,{children:d?n.jsxs("div",{className:"space-y-4",children:[n.jsx(U_,{value:u.addressData,onChange:v=>h(y=>({...y,addressData:v}))}),x&&n.jsx(he,{variant:"outline",size:"sm",onClick:()=>c(!1),className:"w-full",children:"Cancelar edio"})]}):x?n.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:n.jsx("p",{className:"text-sm",children:SC(u.addressData)})}):n.jsxs("div",{className:"text-center py-4",children:[n.jsx("p",{className:"text-muted-foreground text-sm mb-3",children:"Nenhum endereo cadastrado"}),n.jsx(he,{variant:"outline",size:"sm",onClick:()=>c(!0),children:"Adicionar endereo"})]})})]}),n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsx(Lt,{className:"text-base",children:"Preferncias de moda"})}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Be,{className:"mb-2 block",children:"Meus tamanhos favoritos"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:HSe.map(v=>n.jsx("button",{onClick:()=>p(v),className:`px-3 py-1.5 text-sm rounded-full border transition-colors ${u.preferred_sizes.includes(v)?"bg-accent text-accent-foreground border-accent":"border-border hover:border-accent/50"}`,children:v},v))})]}),n.jsxs("div",{children:[n.jsx(Be,{htmlFor:"style",children:"Estilo e preferncias"}),n.jsx(rs,{id:"style",value:u.style_preferences,onChange:v=>h(y=>({...y,style_preferences:v.target.value})),placeholder:"Ex: Gosto de peas confortveis, cores neutras, estampas florais...",rows:3})]})]})]}),n.jsx(he,{onClick:m,className:"w-full gap-2",disabled:o,children:o?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 animate-spin"}),"Salvando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(uu,{className:"h-4 w-4"}),"Salvar alteraes"]})}),n.jsx(he,{variant:"outline",onClick:g,className:"w-full text-muted-foreground",children:"Sair da conta"})]})]})]})}function XSe(){const e=pr(),{user:t,isLoading:r}=qn(),[s,a]=P.useState(!0),[i,o]=P.useState([]),[l,d]=P.useState(null),[c,u]=P.useState(!1);P.useEffect(()=>{!r&&!t&&e("/minha-conta")},[t,r,e]),P.useEffect(()=>{t&&h()},[t]);const h=async()=>{if(t)try{const{data:g}=await le.from("profiles").select("*").eq("user_id",t.id).single(),{data:x}=await le.from("customers").select("id, style_title, size_letter, size_number").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(1),v=x==null?void 0:x[0];let y=[],b=(g==null?void 0:g.quiz_points)||0;if(v){const{data:B}=await le.from("quiz_responses").select("question, answer, points").eq("customer_id",v.id).order("question_number");B&&(y=B,b||(b=B.reduce((q,Y)=>q+(Y.points||0),0)))}const j=(g==null?void 0:g.size_letter)||(v==null?void 0:v.size_letter),T=(g==null?void 0:g.size_number)||(v==null?void 0:v.size_number),O=(g==null?void 0:g.style_title)||(v==null?void 0:v.style_title);d({styleTitle:O,sizeLetter:j,sizeNumber:T,totalPoints:b,responses:y});const{data:R}=await le.from("product_catalog").select("*").eq("is_active",!0).limit(20),D=(R||[]).filter(B=>{const q=B.stock_by_size;return q?(q.UN||0)>0||j&&(q[j]||0)>0||T&&(q[T]||0)>0?!0:!j&&!T?Object.values(q).some(Y=>Y>0):!1:!1});o(D.slice(0,8))}catch(g){console.error("Error loading suggestions:",g)}finally{a(!1)}},f=async()=>{u(!0),await h(),de.success("Sugestes atualizadas!"),u(!1)},{level:m,title:p}=ef((l==null?void 0:l.totalPoints)||0);return r||s?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[n.jsx(Wr,{className:"h-8 w-48 mb-6"}),n.jsxs("div",{className:"grid gap-4",children:[n.jsx(Wr,{className:"h-32 w-full"}),n.jsx(Wr,{className:"h-64 w-full"})]})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h1",{className:"font-serif text-2xl",children:"Sugestes pra mim"}),n.jsxs(he,{variant:"outline",size:"sm",onClick:f,disabled:c,children:[c?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):n.jsx(Qr,{className:"h-4 w-4"}),n.jsx("span",{className:"ml-2 hidden sm:inline",children:"Atualizar"})]})]}),l&&l.totalPoints>0&&n.jsx($e,{className:"mb-6 bg-gradient-to-r from-amber-500/10 via-accent/10 to-amber-500/10 border-amber-500/30",children:n.jsx(Fe,{className:"py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-amber-500 to-accent flex items-center justify-center",children:n.jsx(ma,{className:"h-6 w-6 text-white"})}),n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium",children:["Nvel ",m,": ",p]}),n.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-muted-foreground",children:[n.jsx(wi,{className:"h-3.5 w-3.5 text-amber-500 fill-amber-500"}),n.jsxs("span",{children:[l.totalPoints," pontos acumulados"]})]})]})]}),l.styleTitle&&n.jsxs("div",{className:"text-right hidden sm:block",children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Seu estilo"}),n.jsx("p",{className:"font-medium",children:l.styleTitle})]})]})})}),(!l||!l.styleTitle)&&n.jsx($e,{className:"mb-6",children:n.jsxs(Fe,{className:"py-8 text-center",children:[n.jsx(Gr,{className:"h-12 w-12 mx-auto mb-4 text-accent"}),n.jsx("h2",{className:"font-serif text-xl mb-2",children:"Descubra seu estilo!"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"Faa o quiz de estilo e receba sugestes personalizadas de looks"}),n.jsx(Ft,{to:"/quiz",children:n.jsxs(he,{className:"gap-2",children:[n.jsx(Pn,{className:"h-4 w-4"}),"Fazer o Quiz"]})})]})}),((l==null?void 0:l.sizeLetter)||(l==null?void 0:l.sizeNumber))&&n.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm text-muted-foreground flex-wrap",children:[n.jsx("span",{children:"Mostrando peas nos tamanhos"}),l.sizeLetter&&n.jsx("span",{className:"font-bold text-foreground bg-secondary px-2 py-0.5 rounded",children:l.sizeLetter}),l.sizeLetter&&l.sizeNumber&&n.jsx("span",{children:"e"}),l.sizeNumber&&n.jsx("span",{className:"font-bold text-foreground bg-secondary px-2 py-0.5 rounded",children:l.sizeNumber})]}),i.length>0?n.jsxs("div",{children:[n.jsx("h2",{className:"font-serif text-xl mb-4",children:"Peas que combinam com voc"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:i.map(g=>n.jsx(Ft,{to:`/produto/${g.id}`,children:n.jsx(Qh,{name:g.name,price:g.price,imageUrl:g.image_url||void 0,sizes:g.sizes||[],badge:"Pra voc"})},g.id))})]}):l!=null&&l.sizeLetter||l!=null&&l.sizeNumber?n.jsx($e,{children:n.jsxs(Fe,{className:"py-8 text-center",children:[n.jsx("p",{className:"text-muted-foreground",children:"Ainda no temos peas nos seus tamanhos no momento."}),n.jsx(Ft,{to:"/catalogo",className:"mt-4 inline-block",children:n.jsx(he,{variant:"outline",children:"Ver catlogo completo"})})]})}):null,n.jsxs($e,{className:"mt-8",children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"text-base flex items-center gap-2",children:[n.jsx(Pn,{className:"h-4 w-4 text-accent"}),"Mini-Quiz Semanal"]})}),n.jsxs(Fe,{children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Responda mini-quizzes toda semana para ganhar mais pontos e melhorar suas sugestes!"}),n.jsxs(he,{variant:"outline",className:"gap-2",disabled:!0,children:[n.jsx(wi,{className:"h-4 w-4"}),"Em breve",n.jsx(In,{className:"h-4 w-4"})]})]})]})]})]})}function YSe(){const e=pr(),{user:t,isLoading:r}=qn(),{favorites:s,toggleFavorite:a,isLoading:i}=LH(),[o,l]=P.useState([]),[d,c]=P.useState(!0);P.useEffect(()=>{!r&&!t&&e("/minha-conta")},[t,r,e]),P.useEffect(()=>{i||(async()=>{if(s.length===0){l([]),c(!1);return}try{const{data:f,error:m}=await le.from("product_catalog").select("id, name, price, images, image_url, category, sizes, discount_type, discount_value").in("id",s).eq("is_active",!0);if(m)throw m;l(f||[])}catch(f){console.error("Error loading favorite products:",f)}finally{c(!1)}})()},[s,i]);const u=h=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(h);return r||d?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("main",{className:"container mx-auto px-4 py-12 flex items-center justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-6 max-w-6xl",children:[n.jsxs(he,{variant:"ghost",size:"sm",className:"mb-4",onClick:()=>e("/minha-conta"),children:[n.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Voltar"]}),n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:n.jsx(bl,{className:"h-6 w-6 text-red-500 fill-red-500"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"font-serif text-2xl",children:"Meus Favoritos"}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[o.length," ",o.length===1?"produto":"produtos"]})]})]}),o.length===0?n.jsxs("div",{className:"text-center py-16",children:[n.jsx(bl,{className:"h-16 w-16 text-muted-foreground/30 mx-auto mb-4"}),n.jsx("h2",{className:"font-serif text-xl mb-2",children:"Nenhum favorito ainda"}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Explore nosso catlogo e salve seus produtos favoritos"}),n.jsx(Ft,{to:"/catalogo",children:n.jsxs(he,{children:[n.jsx(hn,{className:"h-4 w-4 mr-2"}),"Ver Catlogo"]})})]}):n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:o.map(h=>{var g;let f=h.price,m=!1;h.discount_type&&h.discount_value&&h.discount_value>0&&(m=!0,h.discount_type==="percentage"?f=h.price*(1-h.discount_value/100):f=Math.max(0,h.price-h.discount_value));const p=((g=h.images)==null?void 0:g[0])||h.image_url||"/placeholder.svg";return n.jsxs("div",{className:"card-product group relative",children:[n.jsx("button",{onClick:x=>{x.preventDefault(),a(h.id)},className:"absolute top-2 right-2 z-10 p-2 bg-white/90 rounded-full hover:bg-white transition-colors",children:n.jsx(bl,{className:"h-4 w-4 text-red-500 fill-red-500"})}),n.jsxs(Ft,{to:`/produto/${h.id}`,children:[n.jsx("div",{className:"relative aspect-[3/4] overflow-hidden bg-secondary rounded-t-lg",children:n.jsx("img",{src:p,alt:h.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"})}),n.jsxs("div",{className:"p-3",children:[n.jsx("h3",{className:"font-medium text-sm line-clamp-2 mb-1",children:h.name}),h.sizes&&h.sizes.length>0&&n.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:["Tam: ",h.sizes.slice(0,4).join(", "),h.sizes.length>4?"...":""]}),n.jsx("div",{className:"flex flex-col",children:m?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"font-semibold text-green-600",children:u(f)}),n.jsx("span",{className:"text-xs text-muted-foreground line-through",children:u(h.price)})]}):n.jsx("span",{className:"font-semibold",children:u(h.price)})})]})]})]},h.id)})})]})]})}function My(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const ZSe=()=>{const[e]=hd(),t=pr(),r=e.get("order_id"),s=e.get("live_cart_id"),[a,i]=P.useState(!0),[o,l]=P.useState(null),[d,c]=P.useState(null),[u,h]=P.useState([]),[f,m]=P.useState(0);P.useEffect(()=>{r||s?p():i(!1)},[r,s]),P.useEffect(()=>{if((s||r)&&!o&&!d&&!a&&f<10){const T=setTimeout(()=>{m(O=>O+1),p()},3e3);return()=>clearTimeout(T)}},[s,r,o,d,a,f]);const p=async()=>{try{let T=null;if(r){const{data:O}=await le.from("orders").select("*").eq("id",r).single();T=O}else if(s){const{data:O}=await le.from("orders").select("*").eq("live_cart_id",s).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(T=O,!T){const{data:R}=await le.from("live_carts").select("*").eq("id",s).single();R&&c(R)}}if(T){l(T);const{data:O}=await le.from("order_items").select("*").eq("order_id",T.id);h(O||[])}}catch(T){console.error("Error loading order:",T)}finally{i(!1)}},g=(o==null?void 0:o.id)||r||s||"",x=(o==null?void 0:o.customer_name)||(d==null?void 0:d.customer_name)||"cliente",v=(o==null?void 0:o.total)||(d==null?void 0:d.total)||0,y=(o==null?void 0:o.shipping_fee)||(d==null?void 0:d.shipping_fee)||0,b=o||d,j=()=>`https://wa.me/5562991223519?text=${encodeURIComponent(`Oi! Sou ${x}. Acabei de fazer o pagamento do pedido #${g==null?void 0:g.slice(0,8).toUpperCase()}. Total: ${My(v)}. Aguardo confirmao! `)}`;return a?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-primary"})}):b?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx("div",{className:"w-20 h-20 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center mx-auto mb-6 animate-fade-in",children:n.jsx(mn,{className:"h-10 w-10 text-green-600 dark:text-green-400"})}),n.jsxs("h1",{className:"font-serif text-2xl mb-2",children:["Pagamento confirmado! ",""]}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Seu pedido foi pago com sucesso. Em breve voc receber atualizaes pelo WhatsApp."}),n.jsx($e,{className:"mb-6 text-left",children:n.jsxs(Fe,{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Pedido"}),n.jsxs("span",{className:"font-mono font-bold text-accent",children:["#",g.slice(0,8).toUpperCase()]})]}),u.length>0&&n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Itens"}),u.map(T=>n.jsxs("div",{className:"flex justify-between text-sm py-1",children:[n.jsxs("span",{children:[T.product_name," (",T.size,") x",T.quantity]}),n.jsx("span",{children:My(T.product_price*T.quantity)})]},T.id))]}),y>0&&n.jsxs("div",{className:"flex justify-between text-sm border-t pt-2",children:[n.jsx("span",{children:"Frete"}),n.jsx("span",{children:My(y)})]}),n.jsxs("div",{className:"flex justify-between font-medium text-lg border-t pt-2",children:[n.jsx("span",{children:"Total pago"}),n.jsx("span",{className:"text-green-600",children:My(v)})]})]})}),n.jsxs("a",{href:j(),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full bg-[#25D366] hover:bg-[#20BD5A] text-white font-medium py-3 px-4 rounded-xl transition-colors mb-4",children:[n.jsx(nn,{className:"h-5 w-5"}),"Confirmar no WhatsApp"]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(he,{variant:"outline",onClick:()=>t("/conta/meus-pedidos"),className:"flex-1",children:"Ver meus pedidos"}),n.jsx(he,{variant:"outline",onClick:()=>t("/"),className:"flex-1",children:"Voltar ao incio"})]})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx(Vt,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pedido no encontrado"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Seu pagamento pode estar sendo processado. Aguarde alguns segundos e atualize a pgina."}),n.jsxs("div",{className:"flex gap-2 justify-center",children:[n.jsx(he,{onClick:()=>window.location.reload(),variant:"outline",children:"Atualizar"}),n.jsx(he,{onClick:()=>t("/"),children:"Voltar ao incio"})]})]})]})};function T7(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const QSe=()=>{const[e]=hd(),t=pr(),r=e.get("order_id"),s=e.get("live_cart_id"),[a,i]=P.useState(!0),[o,l]=P.useState(null),[d,c]=P.useState(null),[u,h]=P.useState(0);P.useEffect(()=>{r||s?f():i(!1)},[r,s]),P.useEffect(()=>{if((s||r)&&!o&&!a&&u<10){const b=setTimeout(()=>{h(j=>j+1),f()},3e3);return()=>clearTimeout(b)}},[s,r,o,a,u]);const f=async()=>{try{let b=null;if(r){const{data:j}=await le.from("orders").select("*").eq("id",r).single();b=j}else if(s){const{data:j}=await le.from("orders").select("*").eq("live_cart_id",s).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(b=j,!b){const{data:T}=await le.from("live_carts").select("*").eq("id",s).single();if(T&&(c(T),T.status==="pago")){const{data:O}=await le.from("orders").select("id").eq("live_cart_id",s).limit(1).maybeSingle();if(O){t(`/meus-pedidos/${O.id}`,{replace:!0});return}}}}if(b&&(l(b),b.status==="pago")){s?t(`/pedido/sucesso?live_cart_id=${s}`,{replace:!0}):t(`/pedido/sucesso?order_id=${b.id}`,{replace:!0});return}}catch(b){console.error("Error loading order:",b)}finally{i(!1)}},m=(o==null?void 0:o.id)||r||s||"",p=(o==null?void 0:o.customer_name)||(d==null?void 0:d.customer_name)||"cliente",g=(o==null?void 0:o.total)||(d==null?void 0:d.total)||0,x=o||d,v=()=>`https://wa.me/5562991223519?text=${encodeURIComponent(`Oi! Sou ${p}. Tive um problema no pagamento do pedido #${m==null?void 0:m.slice(0,8).toUpperCase()}. Pode me ajudar? `)}`,y=()=>{const b=(o==null?void 0:o.mp_checkout_url)||(d==null?void 0:d.mp_checkout_url);b&&window.open(b,"_blank")};return a?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-primary"})}):d&&d.status==="pago"?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx("div",{className:"w-20 h-20 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-6",children:n.jsx(mn,{className:"h-10 w-10 text-green-600"})}),n.jsxs("h1",{className:"font-serif text-2xl mb-2",children:["Pagamento confirmado! ",""]}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Seu pedido foi pago com sucesso."}),n.jsx($e,{className:"mb-6",children:n.jsxs(Fe,{className:"p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Pedido"}),n.jsxs("span",{className:"font-mono font-bold text-accent",children:["#",(s||"").slice(0,8).toUpperCase()]})]}),n.jsxs("div",{className:"flex justify-between font-medium text-lg border-t pt-4",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{className:"text-green-600",children:T7(g)})]})]})}),n.jsx(he,{onClick:()=>t("/conta/meus-pedidos"),className:"w-full",children:"Ver meus pedidos"})]})]}):x?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx("div",{className:"w-20 h-20 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center mx-auto mb-6 animate-fade-in",children:n.jsx(Lr,{className:"h-10 w-10 text-yellow-600 dark:text-yellow-400"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pagamento pendente"}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Seu pagamento est sendo processado. Assim que for confirmado, voc receber uma notificao."}),n.jsx($e,{className:"mb-6",children:n.jsxs(Fe,{className:"p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Pedido"}),n.jsxs("span",{className:"font-mono font-bold text-accent",children:["#",m.slice(0,8).toUpperCase()]})]}),n.jsxs("div",{className:"flex justify-between font-medium text-lg border-t pt-4",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:T7(g)})]})]})}),((o==null?void 0:o.mp_checkout_url)||(d==null?void 0:d.mp_checkout_url))&&n.jsxs(he,{onClick:y,className:"w-full mb-4",children:[n.jsx(Qr,{className:"h-4 w-4 mr-2"}),"Tentar pagar novamente"]}),n.jsxs("a",{href:v(),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full border border-[#25D366] text-[#25D366] hover:bg-[#25D366]/10 font-medium py-3 px-4 rounded-xl transition-colors mb-4",children:[n.jsx(nn,{className:"h-5 w-5"}),"Falar no WhatsApp"]}),n.jsx(he,{variant:"outline",onClick:()=>t("/conta/meus-pedidos"),className:"w-full",children:"Ver meus pedidos"})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx(Vt,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pedido no encontrado"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Seu pagamento pode estar sendo processado. Aguarde alguns segundos e atualize a pgina."}),n.jsxs("div",{className:"flex gap-2 justify-center",children:[n.jsx(he,{onClick:()=>window.location.reload(),variant:"outline",children:"Atualizar"}),n.jsx(he,{onClick:()=>t("/"),children:"Voltar ao incio"})]})]})]})};function JSe(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const eCe=()=>{const[e]=hd(),t=pr(),r=e.get("order_id"),s=e.get("live_cart_id"),[a,i]=P.useState(!0),[o,l]=P.useState(null),[d,c]=P.useState(null);P.useEffect(()=>{(async()=>{try{if(r){const{data:g}=await le.from("orders").select("*").eq("id",r).single();g&&l(g)}if(s){const{data:g}=await le.from("live_carts").select("id, total, mp_checkout_url, bag_number, status").eq("id",s).single();g&&c(g)}}catch(g){console.error("Error loading data:",g)}finally{i(!1)}})()},[r,s]);const u=(o==null?void 0:o.total)||(d==null?void 0:d.total)||0,h=(r==null?void 0:r.slice(0,8).toUpperCase())||(d!=null&&d.bag_number?`Sacola #${d.bag_number}`:s==null?void 0:s.slice(0,8).toUpperCase()),f=(o==null?void 0:o.mp_checkout_url)||(d==null?void 0:d.mp_checkout_url),m=()=>{const p=(o==null?void 0:o.customer_name)||"cliente";return`https://wa.me/5562991223519?text=${encodeURIComponent(`Oi! Sou ${p}. Tive um problema no pagamento do pedido ${h||"pedido"}. Pode me ajudar? `)}`};return a?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-primary"})}):!r&&!s?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx(Vt,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pedido no encontrado"}),n.jsx(he,{onClick:()=>t("/"),children:"Voltar ao incio"})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx("div",{className:"w-20 h-20 rounded-full bg-destructive/10 flex items-center justify-center mx-auto mb-6 animate-fade-in",children:n.jsx(Kn,{className:"h-10 w-10 text-destructive"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pagamento no aprovado"}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"O Mercado Pago recusou o pagamento por motivos de segurana. Isso acontece s vezes  no se preocupe!"}),u>0&&n.jsx($e,{className:"mb-6",children:n.jsxs(Fe,{className:"p-6",children:[h&&n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Pedido"}),n.jsxs("span",{className:"font-mono font-bold text-accent",children:["#",h]})]}),n.jsxs("div",{className:"flex justify-between font-medium text-lg border-t pt-4",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:JSe(u)})]})]})}),n.jsx($e,{className:"mb-6 border-amber-200 bg-amber-50/50 dark:bg-amber-950/20 dark:border-amber-800",children:n.jsxs(Fe,{className:"p-5 text-left",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3 text-amber-700 dark:text-amber-400",children:[n.jsx(Or,{className:"h-5 w-5 flex-shrink-0"}),n.jsx("span",{className:"font-medium",children:"O que voc pode fazer:"})]}),n.jsxs("ul",{className:"space-y-2 text-sm text-amber-800 dark:text-amber-300",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"font-bold mt-0.5",children:"1."}),n.jsxs("span",{children:[n.jsx("strong",{children:"Tente pagar com PIX"}),"   mais rpido e raramente  recusado."]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"font-bold mt-0.5",children:"2."}),n.jsx("span",{children:"Use outro carto de crdito ou dbito."})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"font-bold mt-0.5",children:"3."}),n.jsx("span",{children:"Verifique se os dados do carto esto corretos."})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"font-bold mt-0.5",children:"4."}),n.jsx("span",{children:"Entre em contato com o banco se o problema persistir."})]})]})]})}),f&&n.jsxs(he,{onClick:()=>window.open(f,"_blank"),className:"w-full mb-3",size:"lg",children:[n.jsx(ms,{className:"h-4 w-4 mr-2"}),"Tentar pagar novamente (PIX/outro carto)"]}),n.jsxs("a",{href:m(),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full bg-[#25D366] hover:bg-[#20BD5A] text-white font-medium py-3 px-4 rounded-xl transition-colors mb-3",children:[n.jsx(nn,{className:"h-5 w-5"}),"Pedir ajuda no WhatsApp"]}),n.jsx(he,{variant:"outline",onClick:()=>t("/"),className:"w-full",children:"Voltar ao incio"})]})]})};function P7({stockBySize:e,value:t,onChange:r,reserveAll:s,onReserveAllChange:a,disabled:i=!1}){const o=P.useMemo(()=>e?gp(Object.keys(e).filter(u=>(e[u]||0)>0)):[],[e]),l=P.useMemo(()=>e?Object.values(e).reduce((u,h)=>u+(h||0),0):0,[e]),d=P.useMemo(()=>Object.values(t).reduce((u,h)=>u+(h||0),0),[t]);P.useEffect(()=>{if(s&&e){const u={};Object.entries(e).forEach(([h,f])=>{f&&f>0&&(u[h]=f)}),r(u)}},[s,e]);const c=(u,h)=>{const f=(e==null?void 0:e[u])||0,m=Math.max(0,Math.min(h,f));r({...t,[u]:m}),s&&m!==f&&a(!1)};return o.length===0?n.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg text-muted-foreground",children:[n.jsx(Vt,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm",children:"Sem estoque disponvel"})]}):n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${s?"bg-primary/10 border-primary":"bg-background hover:bg-muted/50"}`,children:[n.jsx(Va,{checked:s,onCheckedChange:u=>a(u===!0),disabled:i}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("span",{className:"font-medium text-sm flex items-center gap-2",children:[n.jsx(Nl,{className:"h-3.5 w-3.5"}),"Reservar todo o estoque para a live"]}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[l," unidades disponveis"]})]}),s&&n.jsx(ke,{variant:"default",className:"bg-primary",children:"100% reservado"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Be,{className:"text-sm font-medium",children:"Quantidade por tamanho"}),n.jsxs(ke,{variant:"outline",className:"text-xs",children:[d," de ",l]})]}),n.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-2",children:o.map(u=>{const h=(e==null?void 0:e[u])||0,f=t[u]||0;return n.jsxs("div",{className:`p-2 rounded-lg border text-center transition-colors ${f>0?"bg-primary/5 border-primary/30":"bg-background"}`,children:[n.jsx("div",{className:"font-medium text-sm mb-1",children:u}),n.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:["Disp: ",h]}),n.jsx(et,{type:"number",min:0,max:h,value:f||"",onChange:m=>c(u,parseInt(m.target.value)||0),disabled:i||s,className:"h-8 text-center text-sm",placeholder:"0"})]},u)})})]}),d>0&&!s&&n.jsxs("div",{className:"flex items-center justify-between p-2 bg-green-50 dark:bg-green-950/30 rounded-lg text-sm",children:[n.jsx("span",{className:"text-green-700 dark:text-green-400",children:"Total reservado para a live:"}),n.jsxs("span",{className:"font-bold text-green-700 dark:text-green-400",children:[d," unidades"]})]})]})}const G3={visibilidade:"catalogo_e_live",bloquear_desde_planejamento:!1,limite_unidades_live:null,live_discount_type:null,live_discount_value:null,stock_reservations:{},reserve_all:!0};function tCe(){const{eventId:e}=ta(),t=pr(),{event:r,products:s,kpis:a,isLoading:i,addProduct:o,removeProduct:l,fetchEvent:d}=B_(e),{updateEventStatus:c}=L_(),[u,h]=P.useState(!1),[f,m]=P.useState(""),[p,g]=P.useState([]),[x,v]=P.useState(new Map),[y,b]=P.useState(null),[j,T]=P.useState(G3),O=P.useRef(null);P.useEffect(()=>{},[u,y,j.live_discount_type,j.live_discount_value]);const[R,D]=P.useState(!1),[B,q]=P.useState(null),[Y,G]=P.useState(G3),[I,F]=P.useState(!1);P.useEffect(()=>{(async()=>{const{data:Z,error:re}=await le.from("product_catalog").select("id, name, image_url, images, price, color, stock_by_size, category, sku").eq("is_active",!0).order("name");if(re){console.error("[LivePlanning] Error fetching products:",re);return}const W=Z||[];g(W);const J=W.map(ie=>ie.id).filter(Boolean);if(J.length===0){v(new Map);return}const{data:V,error:H}=await le.from("product_available_stock").select("product_id, size, available").in("product_id",J);if(H){console.error("[LivePlanning] Error fetching available stock:",H),v(new Map);return}const ee=new Map;(V||[]).forEach(ie=>{const oe=Number(ie.available||0);oe<=0||(ee.has(ie.product_id)||ee.set(ie.product_id,new Map),ee.get(ie.product_id).set(ie.size,oe))}),v(ee)})()},[]);const S=X=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(X),E=X=>X?Object.values(X).reduce((Z,re)=>Z+(re||0),0):0,N=async()=>{if(!y)return;await o(y.id,j)&&(h(!1),b(null),T(G3))},C=X=>{var J;q(X);const Z=X.snapshot_variantes&&typeof X.snapshot_variantes=="object"?X.snapshot_variantes:{},re=Object.values(Z).reduce((V,H)=>V+(H||0),0),W=E(((J=X.product)==null?void 0:J.stock_by_size)||null);G({visibilidade:X.visibilidade,bloquear_desde_planejamento:X.bloquear_desde_planejamento,limite_unidades_live:X.limite_unidades_live,live_discount_type:X.live_discount_type,live_discount_value:X.live_discount_value,stock_reservations:Z,reserve_all:re===W&&W>0}),D(!0)},k=async()=>{if(!B)return;const X=Object.values(Y.stock_reservations).reduce((Z,re)=>Z+(re||0),0);F(!0);try{const{error:Z}=await le.from("live_products").update({visibilidade:Y.visibilidade,bloquear_desde_planejamento:Y.bloquear_desde_planejamento,limite_unidades_live:X>0?X:Y.limite_unidades_live,live_discount_type:Y.live_discount_type,live_discount_value:Y.live_discount_value,snapshot_variantes:Y.stock_reservations}).eq("id",B.id);if(Z)throw Z;de.success("Produto atualizado!"),D(!1),q(null),d()}catch(Z){console.error("Error updating live product:",Z),de.error("Erro ao atualizar produto")}finally{F(!1)}},M=async()=>{if(!r)return;await c(r.id,"ao_vivo")&&t(`/dashboard/lives/${r.id}/backstage`)},U=new Set(s.map(X=>X.product_id)),$=p.filter(X=>{var W,J;const Z=!f||X.name.toLowerCase().includes(f.toLowerCase())||((W=X.sku)==null?void 0:W.toLowerCase().includes(f.toLowerCase()))||((J=X.category)==null?void 0:J.toLowerCase().includes(f.toLowerCase())),re=!U.has(X.id);return Z&&re});return i||!r?n.jsxs("div",{className:"space-y-6",children:[n.jsx(Wr,{className:"h-10 w-48"}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[n.jsx(Wr,{className:"h-24"}),n.jsx(Wr,{className:"h-24"}),n.jsx(Wr,{className:"h-24"})]}),n.jsx(Wr,{className:"h-96"})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>t("/dashboard?tab=lives"),children:n.jsx(Ts,{className:"h-4 w-4"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"font-serif text-2xl font-semibold",children:r.titulo}),n.jsxs("p",{className:"text-muted-foreground text-sm flex items-center gap-1",children:[n.jsx(ns,{className:"h-3.5 w-3.5"}),Wt(new Date(r.data_hora_inicio),"dd 'de' MMMM 's' HH:mm",{locale:mr})]})]})]}),n.jsxs(he,{className:"gap-2 bg-red-600 hover:bg-red-700",onClick:M,disabled:s.length===0,children:[n.jsx(I6,{className:"h-4 w-4"}),"Iniciar Live"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx($e,{children:n.jsxs(Fe,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(Vt,{className:"h-4 w-4"}),"Produtos"]}),n.jsx("div",{className:"text-2xl font-semibold",children:s.length})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(hn,{className:"h-4 w-4"}),"Itens Planejados"]}),n.jsx("div",{className:"text-2xl font-semibold",children:a.totalPlanejado.itens})]})}),n.jsx($e,{className:"col-span-2",children:n.jsxs(Fe,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(ks,{className:"h-4 w-4"}),"Valor Planejado"]}),n.jsx("div",{className:"text-2xl font-semibold",children:S(a.totalPlanejado.valor)})]})})]}),n.jsxs($e,{children:[n.jsxs(Dt,{className:"flex flex-row items-center justify-between",children:[n.jsx(Lt,{children:"Produtos da Live"}),n.jsxs(he,{onClick:()=>h(!0),className:"gap-2",children:[n.jsx(kn,{className:"h-4 w-4"}),"Adicionar Produto"]})]}),n.jsx(Fe,{children:s.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(Vt,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhum produto adicionado ainda"}),n.jsx("p",{className:"text-sm",children:"Adicione produtos para planejar sua live"})]}):n.jsx("div",{className:"space-y-3",children:s.map((X,Z)=>{const re=X.product;if(!re)return null;const W=re.available_by_size,J=W?Object.values(W).reduce((V,H)=>V+(H||0),0):0;return n.jsxs("div",{className:"flex items-center gap-4 p-3 border rounded-lg bg-card hover:bg-muted/30 transition-colors",children:[n.jsx("div",{className:"cursor-grab text-muted-foreground hover:text-foreground",children:n.jsx(T6,{className:"h-5 w-5"})}),n.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-sm font-medium",children:Z+1}),n.jsx("div",{className:"w-16 h-16 bg-secondary rounded-lg overflow-hidden shrink-0",children:re.image_url?n.jsx("img",{src:re.image_url,alt:re.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-6 w-6 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium truncate",children:re.name}),n.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2 flex-wrap",children:[re.color&&n.jsx("span",{className:"bg-secondary px-2 py-0.5 rounded text-xs",children:re.color}),X.live_discount_type&&X.live_discount_value?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-green-600 font-medium",children:S(X.live_discount_type==="percentage"?re.price*(1-X.live_discount_value/100):Math.max(0,re.price-X.live_discount_value))}),n.jsx("span",{className:"line-through opacity-50",children:S(re.price)})]}):n.jsx("span",{children:S(re.price)}),n.jsx("span",{children:""}),n.jsxs("span",{children:[J," unid."]})]})]}),n.jsx(ke,{variant:X.visibilidade==="exclusivo_live"?"default":"outline",className:"shrink-0 gap-1",children:X.visibilidade==="exclusivo_live"?n.jsxs(n.Fragment,{children:[n.jsx(ac,{className:"h-3 w-3"}),"Exclusivo"]}):n.jsxs(n.Fragment,{children:[n.jsx(ai,{className:"h-3 w-3"}),"Catlogo + Live"]})}),X.bloquear_desde_planejamento&&n.jsxs(ke,{variant:"secondary",className:"shrink-0 gap-1",children:[n.jsx(Nl,{className:"h-3 w-3"}),"Bloqueado"]}),n.jsx(he,{variant:"ghost",size:"icon",className:"shrink-0",onClick:()=>C(X),children:n.jsx(Js,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive shrink-0",onClick:()=>l(X.id),children:n.jsx(ui,{className:"h-4 w-4"})})]},X.id)})})})]}),n.jsx(tn,{open:u,onOpenChange:h,children:n.jsxs(Jr,{className:"p-0 w-[min(920px,95vw)] max-h-[85vh] !flex !flex-col overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b shrink-0",children:n.jsxs(ln,{className:"p-0 m-0",children:[n.jsx(rn,{children:"Adicionar Produto  Live"}),n.jsx(Vo,{children:"Selecione um produto e configure as opes para a live"})]})}),n.jsx("div",{ref:O,className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto",children:y?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-muted/30 rounded-lg",children:[n.jsx("div",{className:"w-16 h-16 bg-secondary rounded overflow-hidden shrink-0",children:y.image_url?n.jsx("img",{src:y.image_url,alt:y.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-6 w-6 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium",children:y.name}),n.jsx("div",{className:"text-sm text-muted-foreground",children:(()=>{const X=x.get(y.id),Z=X?Array.from(X.values()).reduce((re,W)=>re+(W||0),0):0;return n.jsxs(n.Fragment,{children:[S(y.price),"  ",Z," unid."]})})()})]}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>b(null),children:"Trocar"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Visibilidade"}),n.jsxs(Xt,{value:j.visibilidade,onValueChange:X=>T(Z=>({...Z,visibilidade:X})),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"catalogo_e_live",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ai,{className:"h-4 w-4"}),"Catlogo + Live"]})}),n.jsx(qe,{value:"exclusivo_live",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ac,{className:"h-4 w-4"}),"Exclusivo da Live"]})})]})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:j.visibilidade==="exclusivo_live"?"O produto ficar oculto no catlogo durante a live":"O produto continuar visvel no catlogo, mas respeitar reservas"})]}),j.visibilidade==="exclusivo_live"&&n.jsxs("div",{className:"flex items-center justify-between py-2",children:[n.jsxs("div",{children:[n.jsx(Be,{children:"Bloquear desde o planejamento"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Oculta o produto do catlogo antes mesmo de iniciar a live"})]}),n.jsx(ii,{checked:j.bloquear_desde_planejamento,onCheckedChange:X=>T(Z=>({...Z,bloquear_desde_planejamento:X}))})]}),n.jsxs("div",{className:"space-y-2 border-t pt-4",children:[n.jsx(Be,{className:"font-medium",children:"Reserva de estoque por tamanho"}),n.jsx(P7,{stockBySize:y.stock_by_size,value:j.stock_reservations,onChange:X=>T(Z=>({...Z,stock_reservations:X})),reserveAll:j.reserve_all,onReserveAllChange:X=>T(Z=>({...Z,reserve_all:X}))})]}),n.jsxs("div",{className:"space-y-3 border-t pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ua,{className:"h-4 w-4 text-primary"}),n.jsx(Be,{className:"font-medium",children:"Desconto exclusivo da Live"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Tipo de desconto"}),n.jsxs(Xt,{value:j.live_discount_type||"_none",onValueChange:X=>T(Z=>({...Z,live_discount_type:X==="_none"?null:X,live_discount_value:X==="_none"?null:Z.live_discount_value})),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Sem desconto"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"_none",children:"Sem desconto"}),n.jsx(qe,{value:"percentage",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Uo,{className:"h-3.5 w-3.5"}),"Porcentagem"]})}),n.jsx(qe,{value:"fixed",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(ks,{className:"h-3.5 w-3.5"}),"Valor fixo"]})})]})]})]}),j.live_discount_type&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:j.live_discount_type==="percentage"?"Desconto (%)":"Desconto (R$)"}),n.jsx(et,{type:"number",min:0,max:j.live_discount_type==="percentage"?100:void 0,step:j.live_discount_type==="percentage"?1:.01,placeholder:j.live_discount_type==="percentage"?"Ex: 10":"Ex: 15.00",value:j.live_discount_value||"",onChange:X=>T(Z=>({...Z,live_discount_value:X.target.value?parseFloat(X.target.value):null}))})]})]}),j.live_discount_type&&j.live_discount_value&&n.jsx("div",{className:"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800 rounded-lg p-3",children:n.jsxs("p",{className:"text-sm text-green-700 dark:text-green-400",children:["Preo na live:"," ",n.jsx("span",{className:"font-bold",children:S(j.live_discount_type==="percentage"?y.price*(1-j.live_discount_value/100):Math.max(0,y.price-j.live_discount_value))}),n.jsx("span",{className:"text-xs ml-2 line-through opacity-70",children:S(y.price)})]})})]})]})]}):n.jsxs("div",{children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por nome, SKU ou categoria...",value:f,onChange:X=>m(X.target.value),className:"pl-10"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[$.map(X=>{const Z=x.get(X.id),re=Z?Array.from(Z.values()).reduce((W,J)=>W+(J||0),0):0;return n.jsxs("button",{className:"flex items-center gap-3 p-3 border rounded-lg text-left hover:bg-muted/50 transition-colors",onClick:()=>b(X),children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:X.image_url?n.jsx("img",{src:X.image_url,alt:X.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:X.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[S(X.price),"  ",re," unid."]})]})]},X.id)}),$.length===0&&n.jsx("div",{className:"col-span-2 text-center py-8 text-muted-foreground",children:"Nenhum produto encontrado"})]})]})}),n.jsxs("div",{className:"px-6 py-4 border-t shrink-0 flex justify-end gap-2",children:[n.jsx(he,{variant:"outline",onClick:()=>{h(!1),b(null)},children:"Cancelar"}),y&&n.jsxs(he,{onClick:N,className:"gap-2",children:[n.jsx(kn,{className:"h-4 w-4"}),"Adicionar  Live"]})]})]})}),n.jsx(tn,{open:R,onOpenChange:D,children:n.jsxs(Jr,{className:"p-0 w-[min(600px,95vw)] max-h-[85vh] !flex !flex-col overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b shrink-0",children:n.jsxs(ln,{className:"p-0 m-0 space-y-1",children:[n.jsx(rn,{children:"Editar Produto na Live"}),n.jsx(Vo,{children:"Altere as configuraes de reserva e desconto"})]})}),B&&B.product&&n.jsx("div",{className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-muted/30 rounded-lg",children:[n.jsx("div",{className:"w-16 h-16 bg-secondary rounded overflow-hidden shrink-0",children:B.product.image_url?n.jsx("img",{src:B.product.image_url,alt:B.product.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-6 w-6 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium",children:B.product.name}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:[S(B.product.price),"  ",E(B.product.stock_by_size)," unid."]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Visibilidade"}),n.jsxs(Xt,{value:Y.visibilidade,onValueChange:X=>G(Z=>({...Z,visibilidade:X})),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"catalogo_e_live",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ai,{className:"h-4 w-4"}),"Catlogo + Live"]})}),n.jsx(qe,{value:"exclusivo_live",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ac,{className:"h-4 w-4"}),"Exclusivo da Live"]})})]})]})]}),Y.visibilidade==="exclusivo_live"&&n.jsxs("div",{className:"flex items-center justify-between py-2",children:[n.jsxs("div",{children:[n.jsx(Be,{children:"Bloquear desde o planejamento"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Oculta o produto do catlogo antes da live"})]}),n.jsx(ii,{checked:Y.bloquear_desde_planejamento,onCheckedChange:X=>G(Z=>({...Z,bloquear_desde_planejamento:X}))})]}),n.jsxs("div",{className:"space-y-2 border-t pt-4",children:[n.jsx(Be,{className:"font-medium",children:"Reserva de estoque por tamanho"}),n.jsx(P7,{stockBySize:B.product.stock_by_size,value:Y.stock_reservations,onChange:X=>G(Z=>({...Z,stock_reservations:X})),reserveAll:Y.reserve_all,onReserveAllChange:X=>G(Z=>({...Z,reserve_all:X}))})]}),n.jsxs("div",{className:"space-y-3 border-t pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ua,{className:"h-4 w-4 text-primary"}),n.jsx(Be,{className:"font-medium",children:"Desconto exclusivo da Live"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Tipo de desconto"}),n.jsxs(Xt,{value:Y.live_discount_type||"_none",onValueChange:X=>G(Z=>({...Z,live_discount_type:X==="_none"?null:X,live_discount_value:X==="_none"?null:Z.live_discount_value})),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Sem desconto"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"_none",children:"Sem desconto"}),n.jsx(qe,{value:"percentage",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Uo,{className:"h-3.5 w-3.5"}),"Porcentagem"]})}),n.jsx(qe,{value:"fixed",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(ks,{className:"h-3.5 w-3.5"}),"Valor fixo"]})})]})]})]}),Y.live_discount_type&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:Y.live_discount_type==="percentage"?"Desconto (%)":"Desconto (R$)"}),n.jsx(et,{type:"number",min:0,max:Y.live_discount_type==="percentage"?100:void 0,step:Y.live_discount_type==="percentage"?1:.01,placeholder:Y.live_discount_type==="percentage"?"Ex: 10":"Ex: 15.00",value:Y.live_discount_value||"",onChange:X=>G(Z=>({...Z,live_discount_value:X.target.value?parseFloat(X.target.value):null}))})]})]}),Y.live_discount_type&&Y.live_discount_value&&n.jsx("div",{className:"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800 rounded-lg p-3",children:n.jsxs("p",{className:"text-sm text-green-700 dark:text-green-400",children:["Preo na live:"," ",n.jsx("span",{className:"font-bold",children:S(Y.live_discount_type==="percentage"?B.product.price*(1-Y.live_discount_value/100):Math.max(0,B.product.price-Y.live_discount_value))}),n.jsx("span",{className:"text-xs ml-2 line-through opacity-70",children:S(B.product.price)})]})})]})]})]})}),n.jsxs("div",{className:"px-6 py-4 border-t shrink-0 flex justify-end gap-2",children:[n.jsx(he,{variant:"outline",onClick:()=>{D(!1),q(null)},children:"Cancelar"}),n.jsx(he,{onClick:k,disabled:I,children:I?"Salvando...":"Salvar Alteraes"})]})]})})]})}function rCe(){const e=pr();ta();const[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await le.auth.getSession();if(!a){e("/login");return}const{data:i}=await le.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(l=>["merchant","admin"].includes(l.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Nr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8",children:n.jsx(tCe,{})})]})}function nCe(e,t){return P.useReducer((r,s)=>t[r][s]??r,e)}var U8="ScrollArea",[MX,dQe]=ea(U8),[sCe,Go]=MX(U8),IX=P.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:s="hover",dir:a,scrollHideDelay:i=600,...o}=e,[l,d]=P.useState(null),[c,u]=P.useState(null),[h,f]=P.useState(null),[m,p]=P.useState(null),[g,x]=P.useState(null),[v,y]=P.useState(0),[b,j]=P.useState(0),[T,O]=P.useState(!1),[R,D]=P.useState(!1),B=Rr(t,Y=>d(Y)),q=hg(a);return n.jsx(sCe,{scope:r,type:s,dir:q,scrollHideDelay:i,scrollArea:l,viewport:c,onViewportChange:u,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:p,scrollbarXEnabled:T,onScrollbarXEnabledChange:O,scrollbarY:g,onScrollbarYChange:x,scrollbarYEnabled:R,onScrollbarYEnabledChange:D,onCornerWidthChange:y,onCornerHeightChange:j,children:n.jsx(er.div,{dir:q,...o,ref:B,style:{position:"relative","--radix-scroll-area-corner-width":v+"px","--radix-scroll-area-corner-height":b+"px",...e.style}})})});IX.displayName=U8;var DX="ScrollAreaViewport",LX=P.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:s,nonce:a,...i}=e,o=Go(DX,r),l=P.useRef(null),d=Rr(t,l,o.onViewportChange);return n.jsxs(n.Fragment,{children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),n.jsx(er.div,{"data-radix-scroll-area-viewport":"",...i,ref:d,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:n.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});LX.displayName=DX;var Cc="ScrollAreaScrollbar",V8=P.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=Go(Cc,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,l=e.orientation==="horizontal";return P.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),a.type==="hover"?n.jsx(aCe,{...s,ref:t,forceMount:r}):a.type==="scroll"?n.jsx(iCe,{...s,ref:t,forceMount:r}):a.type==="auto"?n.jsx(BX,{...s,ref:t,forceMount:r}):a.type==="always"?n.jsx(q8,{...s,ref:t}):null});V8.displayName=Cc;var aCe=P.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=Go(Cc,e.__scopeScrollArea),[i,o]=P.useState(!1);return P.useEffect(()=>{const l=a.scrollArea;let d=0;if(l){const c=()=>{window.clearTimeout(d),o(!0)},u=()=>{d=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return l.addEventListener("pointerenter",c),l.addEventListener("pointerleave",u),()=>{window.clearTimeout(d),l.removeEventListener("pointerenter",c),l.removeEventListener("pointerleave",u)}}},[a.scrollArea,a.scrollHideDelay]),n.jsx(Ws,{present:r||i,children:n.jsx(BX,{"data-state":i?"visible":"hidden",...s,ref:t})})}),iCe=P.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=Go(Cc,e.__scopeScrollArea),i=e.orientation==="horizontal",o=ej(()=>d("SCROLL_END"),100),[l,d]=nCe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return P.useEffect(()=>{if(l==="idle"){const c=window.setTimeout(()=>d("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(c)}},[l,a.scrollHideDelay,d]),P.useEffect(()=>{const c=a.viewport,u=i?"scrollLeft":"scrollTop";if(c){let h=c[u];const f=()=>{const m=c[u];h!==m&&(d("SCROLL"),o()),h=m};return c.addEventListener("scroll",f),()=>c.removeEventListener("scroll",f)}},[a.viewport,i,d,o]),n.jsx(Ws,{present:r||l!=="hidden",children:n.jsx(q8,{"data-state":l==="hidden"?"hidden":"visible",...s,ref:t,onPointerEnter:Tt(e.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:Tt(e.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),BX=P.forwardRef((e,t)=>{const r=Go(Cc,e.__scopeScrollArea),{forceMount:s,...a}=e,[i,o]=P.useState(!1),l=e.orientation==="horizontal",d=ej(()=>{if(r.viewport){const c=r.viewport.offsetWidth<r.viewport.scrollWidth,u=r.viewport.offsetHeight<r.viewport.scrollHeight;o(l?c:u)}},10);return _p(r.viewport,d),_p(r.content,d),n.jsx(Ws,{present:s||i,children:n.jsx(q8,{"data-state":i?"visible":"hidden",...a,ref:t})})}),q8=P.forwardRef((e,t)=>{const{orientation:r="vertical",...s}=e,a=Go(Cc,e.__scopeScrollArea),i=P.useRef(null),o=P.useRef(0),[l,d]=P.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=VX(l.viewport,l.content),u={...s,sizes:l,onSizesChange:d,hasThumb:c>0&&c<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return hCe(f,o.current,l,m)}return r==="horizontal"?n.jsx(oCe,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const f=a.viewport.scrollLeft,m=O7(f,l,a.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{a.viewport&&(a.viewport.scrollLeft=f)},onDragScroll:f=>{a.viewport&&(a.viewport.scrollLeft=h(f,a.dir))}}):r==="vertical"?n.jsx(lCe,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const f=a.viewport.scrollTop,m=O7(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{a.viewport&&(a.viewport.scrollTop=f)},onDragScroll:f=>{a.viewport&&(a.viewport.scrollTop=h(f))}}):null}),oCe=P.forwardRef((e,t)=>{const{sizes:r,onSizesChange:s,...a}=e,i=Go(Cc,e.__scopeScrollArea),[o,l]=P.useState(),d=P.useRef(null),c=Rr(t,d,i.onScrollbarXChange);return P.useEffect(()=>{d.current&&l(getComputedStyle(d.current))},[d]),n.jsx(FX,{"data-orientation":"horizontal",...a,ref:c,sizes:r,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":J_(r)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(f),WX(f,h)&&u.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&s({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:Ow(o.paddingLeft),paddingEnd:Ow(o.paddingRight)}})}})}),lCe=P.forwardRef((e,t)=>{const{sizes:r,onSizesChange:s,...a}=e,i=Go(Cc,e.__scopeScrollArea),[o,l]=P.useState(),d=P.useRef(null),c=Rr(t,d,i.onScrollbarYChange);return P.useEffect(()=>{d.current&&l(getComputedStyle(d.current))},[d]),n.jsx(FX,{"data-orientation":"vertical",...a,ref:c,sizes:r,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":J_(r)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(i.viewport){const f=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(f),WX(f,h)&&u.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&s({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:Ow(o.paddingTop),paddingEnd:Ow(o.paddingBottom)}})}})}),[cCe,$X]=MX(Cc),FX=P.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:s,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:d,onDragScroll:c,onWheelScroll:u,onResize:h,...f}=e,m=Go(Cc,r),[p,g]=P.useState(null),x=Rr(t,B=>g(B)),v=P.useRef(null),y=P.useRef(""),b=m.viewport,j=s.content-s.viewport,T=Us(u),O=Us(d),R=ej(h,10);function D(B){if(v.current){const q=B.clientX-v.current.left,Y=B.clientY-v.current.top;c({x:q,y:Y})}}return P.useEffect(()=>{const B=q=>{const Y=q.target;(p==null?void 0:p.contains(Y))&&T(q,j)};return document.addEventListener("wheel",B,{passive:!1}),()=>document.removeEventListener("wheel",B,{passive:!1})},[b,p,j,T]),P.useEffect(O,[s,O]),_p(p,R),_p(m.content,R),n.jsx(cCe,{scope:r,scrollbar:p,hasThumb:a,onThumbChange:Us(i),onThumbPointerUp:Us(o),onThumbPositionChange:O,onThumbPointerDown:Us(l),children:n.jsx(er.div,{...f,ref:x,style:{position:"absolute",...f.style},onPointerDown:Tt(e.onPointerDown,B=>{B.button===0&&(B.target.setPointerCapture(B.pointerId),v.current=p.getBoundingClientRect(),y.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),D(B))}),onPointerMove:Tt(e.onPointerMove,D),onPointerUp:Tt(e.onPointerUp,B=>{const q=B.target;q.hasPointerCapture(B.pointerId)&&q.releasePointerCapture(B.pointerId),document.body.style.webkitUserSelect=y.current,m.viewport&&(m.viewport.style.scrollBehavior=""),v.current=null})})})}),Pw="ScrollAreaThumb",zX=P.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=$X(Pw,e.__scopeScrollArea);return n.jsx(Ws,{present:r||a.hasThumb,children:n.jsx(dCe,{ref:t,...s})})}),dCe=P.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:s,...a}=e,i=Go(Pw,r),o=$X(Pw,r),{onThumbPositionChange:l}=o,d=Rr(t,h=>o.onThumbChange(h)),c=P.useRef(void 0),u=ej(()=>{c.current&&(c.current(),c.current=void 0)},100);return P.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(u(),!c.current){const m=fCe(h,l);c.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,u,l]),n.jsx(er.div,{"data-state":o.hasThumb?"visible":"hidden",...a,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:Tt(e.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),p=h.clientX-m.left,g=h.clientY-m.top;o.onThumbPointerDown({x:p,y:g})}),onPointerUp:Tt(e.onPointerUp,o.onThumbPointerUp)})});zX.displayName=Pw;var W8="ScrollAreaCorner",UX=P.forwardRef((e,t)=>{const r=Go(W8,e.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&s?n.jsx(uCe,{...e,ref:t}):null});UX.displayName=W8;var uCe=P.forwardRef((e,t)=>{const{__scopeScrollArea:r,...s}=e,a=Go(W8,r),[i,o]=P.useState(0),[l,d]=P.useState(0),c=!!(i&&l);return _p(a.scrollbarX,()=>{var h;const u=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(u),d(u)}),_p(a.scrollbarY,()=>{var h;const u=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(u),o(u)}),c?n.jsx(er.div,{...s,ref:t,style:{width:i,height:l,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function Ow(e){return e?parseInt(e,10):0}function VX(e,t){const r=e/t;return isNaN(r)?0:r}function J_(e){const t=VX(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=(e.scrollbar.size-r)*t;return Math.max(s,18)}function hCe(e,t,r,s="ltr"){const a=J_(r),i=a/2,o=t||i,l=a-o,d=r.scrollbar.paddingStart+o,c=r.scrollbar.size-r.scrollbar.paddingEnd-l,u=r.content-r.viewport,h=s==="ltr"?[0,u]:[u*-1,0];return qX([d,c],h)(e)}function O7(e,t,r="ltr"){const s=J_(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-a,o=t.content-t.viewport,l=i-s,d=r==="ltr"?[0,o]:[o*-1,0],c=dC(e,d);return qX([0,o],[0,l])(c)}function qX(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(r-e[0])}}function WX(e,t){return e>0&&e<t}var fCe=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},s=0;return function a(){const i={left:e.scrollLeft,top:e.scrollTop},o=r.left!==i.left,l=r.top!==i.top;(o||l)&&t(),r=i,s=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(s)};function ej(e,t){const r=Us(e),s=P.useRef(0);return P.useEffect(()=>()=>window.clearTimeout(s.current),[]),P.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,t)},[r,t])}function _p(e,t){const r=Us(t);ga(()=>{let s=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(s),a.unobserve(e)}}},[e,r])}var HX=IX,mCe=LX,pCe=UX;const gi=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(HX,{ref:s,className:He("relative overflow-hidden",e),...r,children:[n.jsx(mCe,{className:"h-full w-full rounded-[inherit]",children:t}),n.jsx(GX,{}),n.jsx(pCe,{})]}));gi.displayName=HX.displayName;const GX=P.forwardRef(({className:e,orientation:t="vertical",...r},s)=>n.jsx(V8,{ref:s,orientation:t,className:He("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:n.jsx(zX,{className:"relative flex-1 rounded-full bg-border"})}));GX.displayName=V8.displayName;function gCe(e,t=!1){const[r,s]=P.useState([]),[a,i]=P.useState([]),[o,l]=P.useState([]),[d,c]=P.useState(!0),u=P.useRef(!0),h=P.useRef([]),f=P.useRef(t);f.current=t;const m=P.useCallback(async()=>{if(e){c(!0);try{const{data:C,error:k}=await le.from("live_customers").select("*").eq("live_event_id",e).order("created_at",{ascending:!1});if(k)throw k;u.current&&s(C||[]);const{data:M,error:U}=await le.from("live_carts").select(`
          *,
          live_customer:live_customers(*),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color)
          )
        `).eq("live_event_id",e).order("created_at",{ascending:!1});if(U)throw U;u.current&&i(M||[]);const{data:$,error:X}=await le.from("live_waitlist").select("*").eq("live_event_id",e).order("ordem");if(X)throw X;u.current&&l($||[])}catch(C){console.error("Error fetching backstage data:",C),u.current&&de.error("Erro ao carregar dados do backstage")}finally{u.current&&c(!1)}}},[e]);P.useEffect(()=>(u.current=!0,m(),()=>{u.current=!1}),[m]),P.useEffect(()=>{if(!e)return;h.current.forEach(re=>{le.removeChannel(re)}),h.current=[];const C=()=>{u.current&&!f.current&&m()},k=()=>{try{const re=new(window.AudioContext||window.webkitAudioContext),W=(J,V,H,ee)=>{const ie=re.createOscillator(),oe=re.createGain();ie.connect(oe),oe.connect(re.destination),ie.frequency.setValueAtTime(J,re.currentTime+V),ie.type="sine",oe.gain.setValueAtTime(0,re.currentTime+V),oe.gain.linearRampToValueAtTime(ee,re.currentTime+V+.01),oe.gain.exponentialRampToValueAtTime(.01,re.currentTime+V+H),ie.start(re.currentTime+V),ie.stop(re.currentTime+V+H)};W(523.25,0,.15,.3),W(659.25,.1,.15,.3),W(783.99,.2,.25,.4),W(1046.5,.35,.4,.5)}catch(re){console.log("Could not play notification sound:",re)}},M=re=>{var W,J;u.current&&(re.eventType==="UPDATE"&&((W=re.new)==null?void 0:W.status)==="pago"&&((J=re.old)==null?void 0:J.status)!=="pago"&&(k(),le.from("live_customers").select("instagram_handle, nome").eq("id",re.new.live_customer_id).single().then(({data:V})=>{const H=(V==null?void 0:V.nome)||(V==null?void 0:V.instagram_handle)||"Cliente",ee=re.new.total||0,ie=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(ee);f.current||de.success(` Pagamento Confirmado!
${H} pagou ${ie}`,{duration:8e3,icon:"",style:{background:"#22c55e",color:"white",fontWeight:"bold"}})})),f.current||m())},U=le.channel(`live_carts_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_carts",filter:`live_event_id=eq.${e}`},M).subscribe(),$=le.channel(`live_cart_items_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_cart_items"},C).subscribe(),X=le.channel(`live_customers_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_customers",filter:`live_event_id=eq.${e}`},C).subscribe(),Z=le.channel(`live_waitlist_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_waitlist",filter:`live_event_id=eq.${e}`},C).subscribe();return h.current=[U,$,X,Z],()=>{h.current.forEach(re=>{le.removeChannel(re)}),h.current=[]}},[e,m]);const p=async C=>{if(!e)return null;const k=C.replace(/@/g,"").replace(/\s/g,"").toLowerCase().trim();if(!k)return de.error("Instagram invlido"),null;try{const M=r.find(Z=>Z.instagram_handle.toLowerCase().replace(/@/g,"").trim()===k);if(M&&(!M.nome||!M.client_id)){const{data:Z}=await le.from("customers").select("id, name, phone, email").or(`instagram_handle.ilike.${k},instagram_handle.ilike.@${k}`).is("merged_into_customer_id",null).maybeSingle();if(Z){const{data:re}=await le.from("live_customers").update({client_id:Z.id,nome:Z.name,whatsapp:Z.phone}).eq("id",M.id).select().single();if(re)return m(),re}}if(M)return M;let{data:U}=await le.from("customers").select("id, name, phone, email, instagram_handle").or(`instagram_handle.ilike.${k},instagram_handle.ilike.@${k}`).is("merged_into_customer_id",null).maybeSingle();if(!U){const{data:Z}=await le.from("instagram_identities").select("customer_id").ilike("instagram_handle_normalized",k).maybeSingle();if(Z!=null&&Z.customer_id){const{data:re}=await le.from("customers").select("id, name, phone, email, instagram_handle").eq("id",Z.customer_id).is("merged_into_customer_id",null).maybeSingle();re&&(U=re)}}if(!U){const{data:Z}=await le.from("live_customers").select("client_id").ilike("instagram_handle",k).not("client_id","is",null).limit(1).maybeSingle();if(Z!=null&&Z.client_id){const{data:re}=await le.from("customers").select("id, name, phone, email, instagram_handle").eq("id",Z.client_id).is("merged_into_customer_id",null).maybeSingle();re&&(U=re)}}const{data:$,error:X}=await le.from("live_customers").insert({live_event_id:e,instagram_handle:k,status:"ativo",client_id:(U==null?void 0:U.id)||null,nome:(U==null?void 0:U.name)||null,whatsapp:(U==null?void 0:U.phone)||null}).select().single();if(X){if(X.code==="23505")return await m(),r.find(Z=>Z.instagram_handle.toLowerCase().replace(/@/g,"").trim()===k)||null;throw X}return U&&de.success(`Cliente ${U.name||`@${k}`} identificado no CRM!`),await m(),$}catch(M){return console.error("Error getting/creating customer:",M),de.error("Erro ao buscar/criar cliente"),null}},g=async C=>{var U;if(!e)return null;const{data:k}=await le.from("live_events").select("status").eq("id",e).single(),M=(k==null?void 0:k.status)==="encerrada"||(k==null?void 0:k.status)==="arquivada";try{const{data:$}=await le.from("live_carts").select(`
          *,
          live_customer:live_customers(*),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color)
          )
        `).eq("live_event_id",e).eq("live_customer_id",C).maybeSingle();if($){if($.status==="cancelado"||$.status==="expirado"){const{data:J,error:V}=await le.from("live_carts").update({status:"aguardando_pagamento",separation_status:"pendente"}).eq("id",$.id).select(`
              *,
              live_customer:live_customers(*),
              items:live_cart_items(
                *,
                product:product_catalog(id, name, image_url, color)
              )
            `).single();if(V)return console.error("Error reactivating cart:",V),$;{const H=((U=$.live_customer)==null?void 0:U.instagram_handle)||"cliente";return de.info(`Carrinho de ${H} reativado!`),m(),J}}return $}if(M)return de.error("Live encerrada! No  possvel criar novos carrinhos."),null;const{data:X}=await le.from("live_customers").select("client_id").eq("id",C).single();let Z=null;if(X!=null&&X.client_id){const{data:J}=await le.from("customers").select("user_id").eq("id",X.client_id).maybeSingle();Z=(J==null?void 0:J.user_id)||null}const{data:re,error:W}=await le.from("live_carts").insert({live_event_id:e,live_customer_id:C,user_id:Z,status:"aberto",subtotal:0,descontos:0,frete:0,total:0}).select().single();if(W)throw W;return await m(),re}catch($){return console.error("Error getting/creating cart:",$),de.error("Erro ao buscar/criar carrinho"),null}},x=async C=>{if(!e)return!1;const{data:k}=await le.from("live_events").select("status").eq("id",e).single();if((k==null?void 0:k.status)==="encerrada"||(k==null?void 0:k.status)==="arquivada")return de.error("Live encerrada! No  possvel adicionar novos itens."),!1;try{const M=await p(C.instagram_handle);if(!M)return!1;const U=await g(M.id);if(!U)return!1;const{data:$,error:X}=await le.from("product_catalog").select("price, stock_by_size").eq("id",C.product_id).single();if(X||!$)return de.error("Produto no encontrado"),!1;const{data:Z}=await le.from("live_products").select("live_discount_type, live_discount_value").eq("live_event_id",e).eq("product_id",C.product_id).maybeSingle();let re=$.price;Z!=null&&Z.live_discount_type&&(Z!=null&&Z.live_discount_value)&&(Z.live_discount_type==="percentage"?re=$.price*(1-Z.live_discount_value/100):Z.live_discount_type==="fixed"&&(re=Math.max(0,$.price-Z.live_discount_value)));const W=C.tamanho||"",{data:J}=await le.rpc("get_available_stock",{p_product_id:C.product_id,p_size:W}),V=J||0;if(V<C.qtd)return de.error(`Estoque insuficiente! Disponvel: ${V}`),!1;const{data:H}=await le.from("live_events").select("reservation_expiry_minutes").eq("id",e).single(),ee=(H==null?void 0:H.reservation_expiry_minutes)||30,ie=new Date;ie.setMinutes(ie.getMinutes()+ee);const{data:oe,error:se}=await le.rpc("upsert_live_cart_item",{p_live_cart_id:U.id,p_product_id:C.product_id,p_variante:{cor:C.cor,tamanho:C.tamanho},p_qtd:C.qtd,p_preco_unitario:re,p_expiracao_reserva_em:ie.toISOString()});if(se)throw se;return console.log("[quickLaunch] Upsert result:",oe),await v(U.id),await b(U.id),de.success(` Reservado para ${C.instagram_handle}!`),await m(),!0}catch(M){return console.error("Error in quick launch:",M),de.error("Erro ao adicionar item"),!1}},v=async C=>{var k;try{const{data:M}=await le.from("live_carts").select("live_event_id, live_customer:live_customers(client_id)").eq("id",C).single(),{data:U}=await le.from("live_cart_items").select("preco_unitario, qtd, status").eq("live_cart_id",C).in("status",["reservado","confirmado"]),$=(U||[]).reduce((X,Z)=>X+Z.preco_unitario*Z.qtd,0);await le.from("live_carts").update({subtotal:$,total:$}).eq("id",C),M&&e&&await y(C,$,e,((k=M.live_customer)==null?void 0:k.client_id)||void 0)}catch(M){console.error("Error updating cart totals:",M)}},y=async(C,k,M,U)=>{try{const $=new Date().toISOString(),{data:X}=await le.from("gift_rules").select("*, gift:gifts(*)").eq("is_active",!0).in("channel_scope",["live_only","both","live_specific"]).or(`start_at.is.null,start_at.lte.${$}`).or(`end_at.is.null,end_at.gte.${$}`).order("priority",{ascending:!1});if(!X||X.length===0)return;const Z=X.filter(J=>J.channel_scope==="live_specific"?J.live_event_id===M:!0),{data:re}=await le.from("order_gifts").select("id, gift_id, applied_by_rule_id, status").eq("live_cart_id",C).not("applied_by_rule_id","is",null).neq("status","removed"),W=new Set((re||[]).map(J=>J.applied_by_rule_id));for(const J of Z){const V=J.gift;if(!V)continue;let H=!1;switch(J.condition_type){case"all_purchases":H=!0;break;case"min_value":H=J.condition_value?k>=J.condition_value:!1;break;case"first_n_paid":case"first_n_reserved":H=J.condition_value?J.current_awards_count<J.condition_value:!1;break}J.max_total_awards&&J.current_awards_count>=J.max_total_awards&&(H=!1);const ee=W.has(J.id);if(H&&!ee){if(!V.unlimited_stock&&V.stock_qty<J.gift_qty){console.log(`Gift ${V.name} out of stock for rule ${J.name}`);continue}const{error:ie}=await le.from("order_gifts").insert({live_cart_id:C,gift_id:V.id,qty:J.gift_qty,status:"pending_separation",applied_by_rule_id:J.id});ie||(await le.rpc("decrement_gift_stock",{p_gift_id:V.id,p_qty:J.gift_qty}),await le.rpc("increment_gift_rule_awards",{p_rule_id:J.id,p_qty:1}),await b(C),de.success(` Brinde aplicado: ${V.name}`))}else if(!H&&ee){const ie=re==null?void 0:re.find(oe=>oe.applied_by_rule_id===J.id);ie&&ie.status==="pending_separation"&&(await le.from("order_gifts").update({status:"removed"}).eq("id",ie.id),await le.rpc("decrement_gift_stock",{p_gift_id:ie.gift_id,p_qty:-J.gift_qty}),await b(C),de.info(`Brinde removido: ${V.name} (condio no atendida)`))}}}catch($){console.error("Error evaluating gift rules:",$)}},b=async C=>{try{const{data:k}=await le.from("live_carts").select("bag_number, label_printed_at").eq("id",C).single();k!=null&&k.bag_number&&(k!=null&&k.label_printed_at)&&await le.from("live_carts").update({needs_label_reprint:!0,updated_at:new Date().toISOString()}).eq("id",C)}catch(k){console.error("Error marking cart for reprint:",k)}},j=async C=>{try{const{data:k}=await le.from("live_cart_items").select("live_cart_id, product_id, variante, separation_status, qtd").eq("id",C).single();if(!k)return{success:!1};if(k.separation_status==="separado"||k.separation_status==="retirado_confirmado")return{success:await O(C,`Cancelado - retirar ${k.qtd} unidade(s) da sacola`),productId:k.product_id};const{error:U}=await le.from("live_cart_items").update({status:"removido"}).eq("id",C);if(U)throw U;await v(k.live_cart_id),await b(k.live_cart_id);const $=k.variante,X=($==null?void 0:$.tamanho)||"",{data:Z}=await le.from("live_waitlist").select("*").eq("live_event_id",e).eq("product_id",k.product_id).eq("status","ativa").order("ordem").limit(1),re=Z&&Z.length>0;return re?de.warning(` Estoque liberado! ${Z[0].instagram_handle} est na fila para este item.`,{duration:8e3,action:{label:"Ver fila",onClick:()=>{}}}):de.success("Item removido do carrinho"),await m(),{success:!0,waitlistEntry:re?Z[0]:void 0,productId:k.product_id,size:X}}catch(k){return console.error("Error removing cart item:",k),de.error("Erro ao remover item"),{success:!1}}},T=async C=>{try{const{data:k}=await le.from("live_cart_items").select("live_cart_id, qtd, product_id, variante, separation_status, separation_notes").eq("id",C).single();if(!k)return de.error("Item no encontrado"),!1;const M=k.separation_status==="separado"||k.separation_status==="retirado_confirmado";if(k.qtd<=1)return M?await O(C,"Cancelado - retirar 1 unidade da sacola"):(await j(C)).success;let U=k.separation_notes||"",$=k.separation_status;if(M){const Z=U.match(/pending_removal:(\d+)/),W=(Z?parseInt(Z[1],10):0)+1;Z?U=U.replace(/pending_removal:\d+/,`pending_removal:${W}`):U=U?`${U} | pending_removal:${W}`:`pending_removal:${W}`,$="cancelado"}const{error:X}=await le.from("live_cart_items").update({qtd:k.qtd-1,separation_notes:M?U:k.separation_notes,separation_status:M?$:k.separation_status}).eq("id",C);if(X)throw X;if(await v(k.live_cart_id),await b(k.live_cart_id),M)await le.from("live_carts").update({separation_status:"atencao"}).eq("id",k.live_cart_id),de.warning(" 1 unidade cancelada! Retire da sacola fsica.",{duration:6e3});else{const Z=k.variante,re=(Z==null?void 0:Z.tamanho)||"",{data:W}=await le.from("live_waitlist").select("*").eq("live_event_id",e).eq("product_id",k.product_id).eq("status","ativa").order("ordem",{ascending:!0}).limit(1);W&&W.length>0?de.warning(` 1 unidade liberada! ${W[0].instagram_handle} est na fila.`,{duration:6e3}):de.success("1 unidade removida do carrinho")}return await m(),!0}catch(k){return console.error("Error reducing item quantity:",k),de.error("Erro ao reduzir quantidade"),!1}},O=async(C,k)=>{try{const{data:M}=await le.from("live_cart_items").select("live_cart_id, product_id, variante, preco_unitario, qtd").eq("id",C).single();if(!M)return de.error("Item no encontrado"),!1;const{error:U}=await le.from("live_cart_items").update({status:"cancelado",separation_status:"cancelado",separation_notes:k||"Cancelado pelo cliente - retirar da sacola"}).eq("id",C);if(U)throw U;return await v(M.live_cart_id),await b(M.live_cart_id),await le.from("live_carts").update({separation_status:"atencao"}).eq("id",M.live_cart_id),de.warning("Item cancelado! Retire da sacola fsica na separao.",{duration:5e3}),await m(),!0}catch(M){return console.error("Error cancelling item for separation:",M),de.error("Erro ao cancelar item"),!1}},R=async(C,k,M,U,$,X)=>{if(!e)return!1;const Z=M.startsWith("@")?M.toLowerCase():`@${M.toLowerCase()}`;try{const{error:re}=await le.from("live_waitlist").insert({live_event_id:e,product_id:C,variante:{...k,observacao:X},instagram_handle:Z,whatsapp:U||null,status:"ativa"});if(re)throw re;return de.success(` ${Z} adicionado  lista de espera!`),await m(),!0}catch(re){return console.error("Error adding to waitlist:",re),de.error("Erro ao adicionar  lista de espera"),!1}},D=async C=>{try{await le.from("live_waitlist").update({status:"cancelada"}).eq("id",C),de.info("Pulou para o prximo da fila"),await m()}catch(k){console.error("Error skipping waitlist entry:",k),de.error("Erro ao pular entrada")}},B=async(C,k)=>{try{const{error:M}=await le.from("live_waitlist").update({status:"cancelada"}).eq("live_event_id",e).eq("product_id",C).eq("status","ativa").filter("variante->tamanho","eq",k);if(M)throw M;de.info("Fila encerrada para esta variao"),await m()}catch(M){console.error("Error ending waitlist queue:",M),de.error("Erro ao encerrar fila")}},q=(C,k)=>o.find(M=>{var U;return M.product_id===C&&((U=M.variante)==null?void 0:U.tamanho)===k&&M.status==="ativa"})||null,Y=(C,k)=>o.filter(M=>{var U;return M.product_id===C&&((U=M.variante)==null?void 0:U.tamanho)===k&&M.status==="ativa"}).length,G=async C=>{try{const{data:k,error:M}=await le.from("live_waitlist").select("*").eq("id",C).single();if(M||!k)return console.error("Error fetching waitlist item:",M),de.error("Erro ao buscar item da lista de espera"),!1;const U=k.variante;if(await x({instagram_handle:k.instagram_handle,product_id:k.product_id,cor:U==null?void 0:U.cor,tamanho:U==null?void 0:U.tamanho,qtd:1})){try{const{data:X}=await le.from("live_customers").select("id").eq("live_event_id",e).ilike("instagram_handle",k.instagram_handle).maybeSingle();if(X!=null&&X.id){const{data:Z}=await le.from("live_carts").select("id").eq("live_event_id",e).eq("live_customer_id",X.id).maybeSingle();Z!=null&&Z.id&&await v(Z.id)}}catch(X){console.warn("Could not force-recalculate cart totals after waitlist allocation",X)}return await le.from("live_waitlist").update({status:"atendida"}).eq("id",C),de.success(` Alocado para ${k.instagram_handle}!`),await m(),!0}return!1}catch(k){return console.error("Error allocating from waitlist:",k),de.error("Erro ao alocar da lista de espera"),!1}},I=(C,k)=>{var $;const M=C.startsWith("@")?C.toLowerCase():`@${C.toLowerCase()}`;for(const X of a)if((($=X.live_customer)==null?void 0:$.instagram_handle.toLowerCase())===M){const Z=X.items||[],re=k?Z.filter(W=>W.product_id===k&&["reservado","confirmado"].includes(W.status)):Z.filter(W=>["reservado","confirmado"].includes(W.status));if(re.length>0)return{found:!0,status:"reservado",details:re.map(J=>{var V,H;return`${(V=J.product)==null?void 0:V.name} (${(H=J.variante)==null?void 0:H.tamanho})`}).join(", ")}}const U=o.find(X=>{const Z=X.instagram_handle.toLowerCase()===M,re=k?X.product_id===k:!0;return Z&&re});return U?{found:!0,status:"espera",details:`Posio ${U.ordem} na fila`}:{found:!1,status:"nao_consta"}},F=async C=>{try{const{data:k,error:M}=await le.functions.invoke("create-live-cart-payment",{body:{live_cart_id:C}});if(M)return console.error("Error generating payment:",M),{success:!1,error:"Erro de conexo ao gerar link"};if(k!=null&&k.success&&(k!=null&&k.init_point))return k.already_exists?de.info("Link j existia - copiando..."):de.success("Link de pagamento gerado!"),await m(),{success:!0,checkoutUrl:k.init_point};if(k!=null&&k.error_code){const U=k.message||"Erro ao gerar pagamento",$=k.action?` ${k.action}`:"";return console.error("Payment error:",k),{success:!1,error:`${U}${$}`}}return{success:!1,error:(k==null?void 0:k.error)||(k==null?void 0:k.message)||"Erro ao gerar pagamento"}}catch(k){return console.error("Error generating payment:",k),{success:!1,error:"Erro ao gerar link de pagamento"}}},S=async C=>{try{const{data:k}=await le.rpc("is_cart_in_committed_state",{p_cart_id:C});return k===!0}catch(k){return console.error("Error checking cart committed state:",k),!1}};return{customers:r,carts:a,waitlist:o,isLoading:d,fetchBackstageData:m,getOrCreateCustomer:p,getOrCreateCart:g,quickLaunch:x,removeCartItem:j,reduceItemQuantity:T,cancelItemForSeparation:O,addToWaitlist:R,allocateFromWaitlist:G,skipWaitlistEntry:D,endWaitlistQueue:B,getNextWaitlistEntry:q,getWaitlistCount:Y,checkCustomerHasProduct:I,updateCartTotals:v,generatePaymentLink:F,updateCartStatus:async(C,k,M)=>{var U;try{const $=a.find(V=>V.id===C),X=($==null?void 0:$.status)||null;if(k==="cancelado"&&$&&await S(C)){const ee=($.items||[]).filter(ie=>["reservado","confirmado"].includes(ie.status));for(const ie of ee){const oe=ie.variante;await le.rpc("log_live_attention",{p_cart_id:C,p_attention_type:"cancellation",p_product_id:ie.product_id,p_product_name:((U=ie.product)==null?void 0:U.name)||"Produto",p_size:(oe==null?void 0:oe.tamanho)||null,p_quantity:ie.qtd,p_origin_bag_number:$.bag_number||null,p_payload:{reason:"cart_cancellation",item_id:ie.id}}),await le.from("live_cart_items").update({status:"cancelado",separation_status:"cancelado",separation_notes:"Cancelado - RETIRAR DA SACOLA FSICA"}).eq("id",ie.id)}return await le.from("live_carts").update({separation_status:"atencao",needs_label_reprint:!!$.label_printed_at}).eq("id",C),de.warning(" Sacola requer ateno fsica! Itens marcados para retirada na separao.",{duration:6e3}),await m(),{success:!0,requiresAttention:!0}}const Z={status:k};if(k==="pago"&&$){await le.from("live_cart_items").update({status:"confirmado"}).eq("live_cart_id",C).in("status",["reservado"]);const V=$.live_customer,H=$.items||[],ee=(V==null?void 0:V.whatsapp)||"",ie=(V==null?void 0:V.nome)||(V==null?void 0:V.instagram_handle)||"Cliente Live",{data:oe,error:se}=await le.from("orders").insert({customer_name:ie,customer_phone:ee,customer_address:"Pagamento manual - verificar endereo",total:$.total||0,status:"pago",payment_status:"approved",delivery_method:($.frete||0)>0?"shipping":"pickup",shipping_fee:$.frete||0,live_event_id:$.live_event_id,live_cart_id:C,source:"live"}).select().single();if(se)console.error("Failed to create order from live cart:",se);else if(oe){console.log(`Created order ${oe.id} from manual live cart payment`);const pe=H.filter(ce=>ce.status==="reservado"||ce.status==="confirmado").map(ce=>{var ne,me,ge,_e;return{order_id:oe.id,product_id:ce.product_id,product_name:((ne=ce.product)==null?void 0:ne.name)||"Produto",product_price:ce.preco_unitario,quantity:ce.qtd,size:((me=ce.variante)==null?void 0:me.tamanho)||"",color:((ge=ce.product)==null?void 0:ge.color)||null,image_url:((_e=ce.product)==null?void 0:_e.image_url)||null}});if(pe.length>0){const{error:ce}=await le.from("order_items").insert(pe);ce&&console.error("Failed to create order items:",ce)}Z.order_id=oe.id}}k==="cancelado"&&$&&(await le.from("live_cart_items").update({status:"cancelado"}).eq("live_cart_id",C).in("status",["reservado","confirmado"]),Z.separation_status="cancelado",console.log(`Released reservations for cancelled cart ${C}`));const{error:re}=await le.from("live_carts").update(Z).eq("id",C);if(re)throw re;const{data:{user:W}}=await le.auth.getUser();await le.from("live_cart_status_history").insert({live_cart_id:C,old_status:X,new_status:k,payment_method:M||null,changed_by:(W==null?void 0:W.id)||null,notes:M?`Pagamento manual via ${M}`:null});const J={pago:M?`Pagamento via ${M} confirmado!`:"Pagamento confirmado!",cancelado:"Carrinho cancelado e estoque liberado",aberto:"Carrinho reaberto"};return de.success(J[k]||"Status atualizado!"),await m(),{success:!0}}catch($){return console.error("Error updating cart status:",$),de.error("Erro ao atualizar status do carrinho"),{success:!1}}},fetchCartStatusHistory:async C=>{try{const{data:k,error:M}=await le.from("live_cart_status_history").select("*").eq("live_cart_id",C).order("created_at",{ascending:!0});if(M)throw M;return k||[]}catch(k){return console.error("Error fetching cart history:",k),[]}}}}function xCe({open:e,onOpenChange:t,products:r,carts:s,waitlist:a,reservedStock:i}){var j,T,O,R,D,B,q;const[o,l]=P.useState("instagram"),[d,c]=P.useState(""),[u,h]=P.useState(""),[f,m]=P.useState(null),[p,g]=P.useState(null),x=Y=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Y),v=P.useMemo(()=>{if(!d.trim())return null;const Y=d.startsWith("@")?d.toLowerCase():`@${d.toLowerCase()}`,G=s.find(C=>{var k;return((k=C.live_customer)==null?void 0:k.instagram_handle.toLowerCase())===Y}),I=a.filter(C=>C.instagram_handle.toLowerCase()===Y);if(!G&&I.length===0)return{found:!1,handle:Y};const F=((G==null?void 0:G.items)||[]).filter(C=>["reservado","confirmado"].includes(C.status)),S=F.reduce((C,k)=>C+k.preco_unitario*k.qtd,0),E=F.filter(C=>C.status==="confirmado").length,N=F.filter(C=>C.status==="reservado").length;return{found:!0,handle:Y,cart:G,items:F,waitlistEntries:I,totalReservado:S,confirmedCount:E,reservedCount:N,status:G==null?void 0:G.status}},[d,s,a]),y=P.useMemo(()=>{if(!u.trim())return r;const Y=u.toLowerCase();return r.filter(G=>{var I,F,S,E,N;return((I=G.product)==null?void 0:I.name.toLowerCase().includes(Y))||((S=(F=G.product)==null?void 0:F.sku)==null?void 0:S.toLowerCase().includes(Y))||((N=(E=G.product)==null?void 0:E.group_key)==null?void 0:N.toLowerCase().includes(Y))})},[u,r]),b=P.useMemo(()=>{var N,C,k;if(!f||!p)return null;const Y=f.product_id,G=p.size,I=[];s.forEach(M=>{(M.items||[]).filter(U=>{var $;return U.product_id===Y&&(($=U.variante)==null?void 0:$.tamanho)===G&&["reservado","confirmado"].includes(U.status)}).forEach(U=>{var $;I.push({instagram:(($=M.live_customer)==null?void 0:$.instagram_handle)||"Desconhecido",time:Wt(new Date(U.reservado_em),"HH:mm",{locale:mr}),status:U.status,qty:U.qtd})})});const F=a.filter(M=>{var U;return M.product_id===Y&&((U=M.variante)==null?void 0:U.tamanho)===G&&M.status==="ativa"}).sort((M,U)=>M.ordem-U.ordem),S=((C=(N=f.product)==null?void 0:N.stock_by_size)==null?void 0:C[G])||0,E=((k=i[Y])==null?void 0:k[G])||0;return{totalStock:S,reserved:E,available:Math.max(0,S-E),reservations:I,waitlistEntries:F}},[f,p,s,a,i]);return n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"sm:max-w-2xl max-h-[85vh] overflow-hidden flex flex-col",children:[n.jsx(ln,{children:n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(Ha,{className:"h-5 w-5"}),"Quem garantiu?"]})}),n.jsxs(Hi,{value:o,onValueChange:Y=>l(Y),className:"flex-1 flex flex-col overflow-hidden",children:[n.jsxs(Si,{className:"grid grid-cols-2 shrink-0",children:[n.jsxs(br,{value:"instagram",className:"gap-1",children:[n.jsx(Ha,{className:"h-4 w-4"}),"Por @"]}),n.jsxs(br,{value:"produto",className:"gap-1",children:[n.jsx(Vt,{className:"h-4 w-4"}),"Por Produto"]})]}),n.jsxs(kr,{value:"instagram",className:"flex-1 overflow-auto mt-4 space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"@instagram",value:d,onChange:Y=>c(Y.target.value),className:"pl-10"})]}),v&&!v.found&&n.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(sn,{className:"h-5 w-5 text-red-600"}),n.jsxs("span",{className:"font-medium text-red-700",children:[v.handle," no consta"]})]})}),(v==null?void 0:v.found)&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"font-semibold text-lg",children:v.handle}),n.jsx(ke,{variant:v.status==="pago"?"default":v.status==="aguardando_pagamento"?"secondary":"outline",children:v.status==="pago"?"Pago":v.status==="aguardando_pagamento"?"Aguardando Pagamento":"Pendente"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Reservados:"}),n.jsx("span",{className:"ml-1 font-medium",children:v.reservedCount})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Confirmados:"}),n.jsx("span",{className:"ml-1 font-medium",children:v.confirmedCount})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Total:"}),n.jsx("span",{className:"ml-1 font-medium",children:x(v.totalReservado)})]})]})]}),v.items.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"font-medium text-sm",children:"Itens Reservados"}),v.items.map(Y=>{var G,I,F,S;return n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-green-50 border border-green-100 rounded-lg",children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:((G=Y.product)==null?void 0:G.image_url)&&n.jsx("img",{src:Y.product.image_url,alt:Y.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:(I=Y.product)==null?void 0:I.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[((F=Y.product)==null?void 0:F.color)&&`${Y.product.color}  `,"Tam: ",(S=Y.variante)==null?void 0:S.tamanho,"  Qtd: ",Y.qtd]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("div",{className:"font-medium text-sm",children:x(Y.preco_unitario*Y.qtd)}),n.jsx(ke,{variant:Y.status==="confirmado"?"default":"secondary",className:"text-xs",children:Y.status==="confirmado"?n.jsxs(n.Fragment,{children:[n.jsx(Sr,{className:"h-3 w-3 mr-1"}),"Confirmado"]}):n.jsxs(n.Fragment,{children:[n.jsx(Lr,{className:"h-3 w-3 mr-1"}),"Reservado"]})})]})]},Y.id)})]}),v.waitlistEntries.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"font-medium text-sm",children:"Na Lista de Espera"}),v.waitlistEntries.map(Y=>{var I,F;const G=r.find(S=>S.product_id===Y.product_id);return n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-amber-50 border border-amber-100 rounded-lg",children:[n.jsx(Oi,{className:"h-5 w-5 text-amber-600"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-sm",children:((I=G==null?void 0:G.product)==null?void 0:I.name)||"Produto"}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Tam: ",(F=Y.variante)==null?void 0:F.tamanho,"  Posio #",Y.ordem]})]})]},Y.id)})]})]})]}),n.jsx(kr,{value:"produto",className:"flex-1 overflow-hidden mt-4",children:f?p?n.jsxs("div",{className:"h-full flex flex-col",children:[n.jsx(he,{variant:"ghost",size:"sm",className:"self-start mb-4",onClick:()=>g(null),children:" Voltar"}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:((D=f.product)==null?void 0:D.image_url)&&n.jsx("img",{src:f.product.image_url,alt:f.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium",children:(B=f.product)==null?void 0:B.name}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:[(q=f.product)==null?void 0:q.color,"  Tam: ",p.size]})]}),b&&n.jsxs("div",{className:"text-right text-sm",children:[n.jsxs("div",{children:["Disponvel:"," ",n.jsx("span",{className:b.available>0?"text-green-600 font-medium":"text-red-600 font-medium",children:b.available})]}),n.jsxs("div",{className:"text-muted-foreground",children:["de ",b.totalStock," total"]})]})]}),n.jsx(gi,{className:"flex-1",children:b&&n.jsxs("div",{className:"space-y-4",children:[b.reservations.length>0?n.jsxs("div",{className:"space-y-2",children:[n.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2",children:[n.jsx(Sr,{className:"h-4 w-4 text-green-600"}),"Reservas (",b.reservations.length,")"]}),b.reservations.map((Y,G)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-green-50 border border-green-100 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:Y.instagram}),n.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:Y.time})]}),n.jsx(ke,{variant:Y.status==="confirmado"?"default":"secondary",children:Y.status==="confirmado"?"Confirmado":"Reservado"})]},G))]}):n.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Nenhuma reserva para esta variao"}),b.waitlistEntries.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2",children:[n.jsx(Oi,{className:"h-4 w-4 text-amber-600"}),"Lista de Espera (",b.waitlistEntries.length,")"]}),b.waitlistEntries.map((Y,G)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-amber-50 border border-amber-100 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:Y.instagram_handle}),Y.whatsapp&&n.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:Y.whatsapp})]}),n.jsxs(ke,{variant:"outline",children:["#",G+1," na fila"]})]},Y.id))]})]})})]}):n.jsxs("div",{className:"h-full flex flex-col",children:[n.jsx(he,{variant:"ghost",size:"sm",className:"self-start mb-4",onClick:()=>m(null),children:" Voltar"}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg mb-4",children:[n.jsx("div",{className:"w-16 h-16 bg-secondary rounded overflow-hidden shrink-0",children:((j=f.product)==null?void 0:j.image_url)&&n.jsx("img",{src:f.product.image_url,alt:f.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:(T=f.product)==null?void 0:T.name}),n.jsx("div",{className:"text-sm text-muted-foreground",children:(O=f.product)==null?void 0:O.color})]})]}),n.jsx("h4",{className:"font-medium mb-3",children:"Selecione um tamanho:"}),n.jsx("div",{className:"grid grid-cols-4 gap-2",children:gp(Object.keys(((R=f.product)==null?void 0:R.stock_by_size)||{})).map(Y=>{var E,N,C;const G=((N=(E=f.product)==null?void 0:E.stock_by_size)==null?void 0:N[Y])||0,I=((C=i[f.product_id])==null?void 0:C[Y])||0,F=Math.max(0,G-I),S=a.filter(k=>{var M;return k.product_id===f.product_id&&((M=k.variante)==null?void 0:M.tamanho)===Y&&k.status==="ativa"}).length;return n.jsxs("button",{className:`p-3 rounded-lg border text-center transition-colors hover:border-primary ${F===0?"bg-muted":""}`,onClick:()=>g({size:Y}),children:[n.jsx("div",{className:"font-bold text-lg",children:Y}),n.jsxs("div",{className:"text-xs text-muted-foreground space-y-0.5",children:[n.jsxs("div",{children:["Total: ",G]}),n.jsxs("div",{className:"text-amber-600",children:["Reserv: ",I]}),n.jsxs("div",{className:F>0?"text-green-600":"text-red-600",children:["Disp: ",F]}),S>0&&n.jsxs("div",{className:"text-blue-600",children:["Fila: ",S]})]})]},Y)})})]}):n.jsxs("div",{className:"h-full flex flex-col",children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar produto por nome ou cdigo...",value:u,onChange:Y=>h(Y.target.value),className:"pl-10"})]}),n.jsx(gi,{className:"flex-1",children:n.jsx("div",{className:"space-y-2",children:y.map(Y=>{const G=Y.product;return G?n.jsx("div",{className:"p-3 rounded-lg border hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>m(Y),children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:G.image_url&&n.jsx("img",{src:G.image_url,alt:G.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:G.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[G.sku||G.group_key,G.color&&`  ${G.color}`]})]}),n.jsx(Ri,{className:"h-4 w-4 text-muted-foreground"})]})},Y.id):null})})})]})})]})]})})}function vCe({open:e,onOpenChange:t,eventId:r,existingProductIds:s,onProductsAdded:a}){const[i,o]=P.useState(""),[l,d]=P.useState([]),[c,u]=P.useState(new Map),[h,f]=P.useState(new Set),[m,p]=P.useState(!1),[g,x]=P.useState(!1);P.useEffect(()=>{e&&(v(),f(new Set),o(""))},[e]);const v=async()=>{p(!0);try{const{data:O,error:R}=await le.from("product_available_stock").select("product_id, size, stock, available");if(R){console.error("Error fetching available stock:",R),de.error("Erro ao carregar estoque disponvel"),p(!1);return}const D=new Map;(O||[]).forEach(Y=>{Y.available>0&&(D.has(Y.product_id)||D.set(Y.product_id,new Map),D.get(Y.product_id).set(Y.size,Y.available))}),u(D),console.log("[AddProductsModal] Loaded available stock for",D.size,"products");const{data:B,error:q}=await le.from("product_catalog").select("id, name, image_url, price, color, sku, group_key").eq("is_active",!0).order("name");if(q)throw q;d((B||[]).map(Y=>({...Y,stock_by_size:null})))}catch(O){console.error("Error fetching products:",O),de.error("Erro ao carregar produtos")}finally{p(!1)}},y=O=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(O),b=P.useMemo(()=>{let O=l.filter(R=>!s.includes(R.id));if(i.trim()){const R=i.toLowerCase();O=O.filter(D=>{var B,q,Y;return D.name.toLowerCase().includes(R)||((B=D.sku)==null?void 0:B.toLowerCase().includes(R))||((q=D.group_key)==null?void 0:q.toLowerCase().includes(R))||((Y=D.color)==null?void 0:Y.toLowerCase().includes(R))})}return O},[l,s,i]),j=O=>{const R=new Set(h);R.has(O)?R.delete(O):R.add(O),f(R)},T=async()=>{var O;if(h.size!==0){x(!0);try{const{data:R}=await le.from("live_products").select("prioridade_ordem").eq("live_event_id",r).order("prioridade_ordem",{ascending:!1}).limit(1);let D=((O=R==null?void 0:R[0])==null?void 0:O.prioridade_ordem)||0;const B=Array.from(h).map(Y=>{D+=1;const G=c.get(Y),I={};return G&&G.forEach((F,S)=>{F>0&&(I[S]=F)}),{live_event_id:r,product_id:Y,prioridade_ordem:D,visibilidade:"catalogo_e_live",bloquear_desde_planejamento:!1,snapshot_variantes:I}}),{error:q}=await le.from("live_products").insert(B);if(q)throw q;de.success(`${h.size} produto(s) adicionado(s)  live!`),a(),t(!1)}catch(R){console.error("Error adding products:",R),de.error("Erro ao adicionar produtos")}finally{x(!1)}}};return n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"p-0 w-[min(720px,95vw)] max-h-[85vh] !flex !flex-col overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b shrink-0",children:n.jsx(ln,{className:"p-0 m-0",children:n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(kn,{className:"h-5 w-5"}),"Adicionar Produtos  Live"]})})}),n.jsxs("div",{className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto",children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por nome, cdigo ou cor...",value:i,onChange:O=>o(O.target.value),className:"pl-10"})]}),h.size>0&&n.jsxs("div",{className:"flex items-center justify-between p-2 bg-primary/10 rounded-lg mb-3",children:[n.jsxs("span",{className:"text-sm font-medium",children:[h.size," produto(s) selecionado(s)"]}),n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>f(new Set),children:[n.jsx(sn,{className:"h-4 w-4 mr-1"}),"Limpar"]})]}),m?n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando produtos..."}):b.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Vt,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhum produto encontrado"})]}):n.jsx("div",{className:"space-y-2",children:b.map(O=>{const R=h.has(O.id),D=c.get(O.id);let B=[],q=0;return D&&D.size>0&&(D.forEach((G,I)=>{B.push({size:I,available:G}),q+=G}),B=gp(B.map(G=>G.size)).map(G=>{const I=D.get(G)||0;return{size:G,available:I}}).filter(G=>G.available>0)),n.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${R?"border-primary bg-primary/5":"hover:bg-muted/50"}`,onClick:()=>j(O.id),children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Va,{checked:R}),n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:O.image_url?n.jsx("img",{src:O.image_url,alt:O.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:O.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[O.sku||O.group_key||"",O.color&&`  ${O.color}`,"  ",y(O.price)]}),n.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[B.slice(0,6).map(({size:Y,available:G})=>n.jsxs("span",{className:`px-1.5 py-0.5 rounded text-xs ${G>0?"bg-secondary":"bg-red-100 text-red-600"}`,children:[Y,": ",G]},Y)),B.length>6&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",B.length-6]})]})]}),n.jsx("div",{className:"text-right shrink-0",children:n.jsxs(ke,{variant:q>0?"secondary":"destructive",children:[q," un"]})})]})},O.id)})})]}),n.jsxs("div",{className:"px-6 py-4 border-t shrink-0 flex justify-end gap-2",children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),n.jsx(he,{onClick:T,disabled:h.size===0||g,children:g?"Adicionando...":n.jsxs(n.Fragment,{children:[n.jsx(gn,{className:"h-4 w-4 mr-1"}),"Adicionar ",h.size>0&&`(${h.size})`]})})]})]})})}function yCe({open:e,onOpenChange:t,liveProduct:r,onProductUpdated:s}){const[a,i]=P.useState("none"),[o,l]=P.useState(""),[d,c]=P.useState(""),[u,h]=P.useState("catalogo_e_live"),[f,m]=P.useState(!1),[p,g]=P.useState(!1);P.useEffect(()=>{var O,R;r&&(i(r.live_discount_type||"none"),l(((O=r.live_discount_value)==null?void 0:O.toString())||""),c(((R=r.limite_unidades_live)==null?void 0:R.toString())||""),h(r.visibilidade),m(r.bloquear_desde_planejamento))},[r]);const x=O=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(O),v=async()=>{if(r){g(!0);try{const O={visibilidade:u,bloquear_desde_planejamento:f,limite_unidades_live:d?parseInt(d):null};a==="none"?(O.live_discount_type=null,O.live_discount_value=null):(O.live_discount_type=a,O.live_discount_value=parseFloat(o)||null);const{error:R}=await le.from("live_products").update(O).eq("id",r.id);if(R)throw R;de.success("Produto atualizado com sucesso!"),s(),t(!1)}catch(O){console.error("Error updating live product:",O),de.error("Erro ao atualizar produto")}finally{g(!1)}}};if(!r||!r.product)return null;const y=r.product,b=y.price,j=a==="none"?null:a,T=a!=="none"&&parseFloat(o)>0?X0(b,j,parseFloat(o)):b;return n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"p-0 w-[min(480px,95vw)] max-h-[85vh] !flex !flex-col overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b shrink-0",children:n.jsx(ln,{className:"p-0 m-0",children:n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(Js,{className:"h-5 w-5"}),"Editar Produto na Live"]})})}),n.jsxs("div",{className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-lg",children:[y.image_url&&n.jsx("img",{src:y.image_url,alt:y.name,className:"w-14 h-14 rounded object-cover"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium truncate",children:y.name}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[y.color&&`${y.color}  `,x(b)]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Desconto na Live"}),n.jsxs(Xt,{value:a,onValueChange:O=>i(O),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"none",children:"Sem desconto"}),n.jsx(qe,{value:"percentage",children:"Percentual (%)"}),n.jsx(qe,{value:"fixed",children:"Valor fixo (R$)"})]})]})]}),a!=="none"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:a==="percentage"?"Desconto (%)":"Desconto (R$)"}),n.jsxs("div",{className:"relative",children:[n.jsx(et,{type:"number",placeholder:a==="percentage"?"10":"20.00",value:o,onChange:O=>l(O.target.value),className:"pr-10"}),n.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:a==="percentage"?n.jsx(Uo,{className:"h-4 w-4 text-muted-foreground"}):n.jsx(ks,{className:"h-4 w-4 text-muted-foreground"})})]}),parseFloat(o)>0&&n.jsxs("div",{className:"p-2 bg-green-50 rounded text-sm",children:[n.jsx("span",{className:"text-muted-foreground line-through mr-2",children:x(b)}),n.jsx("span",{className:"font-medium text-green-700",children:x(T)})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Limite de unidades na live (opcional)"}),n.jsx(et,{type:"number",placeholder:"Sem limite",value:d,onChange:O=>c(O.target.value)}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Deixe vazio para usar todo o estoque disponvel"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Visibilidade"}),n.jsxs(Xt,{value:u,onValueChange:O=>h(O),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"catalogo_e_live",children:"Catlogo e Live"}),n.jsx(qe,{value:"exclusivo_live",children:"Exclusivo da Live"})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsx(Be,{className:"cursor-pointer",children:"Bloquear desde planejamento"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Esconde do catlogo mesmo antes da live comear"})]}),n.jsx(ii,{checked:f,onCheckedChange:m})]})]}),n.jsxs("div",{className:"px-6 py-4 border-t shrink-0 flex justify-end gap-2",children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),n.jsx(he,{onClick:v,disabled:p,children:p?"Salvando...":"Salvar alteraes"})]})]})})}function bCe({open:e,onOpenChange:t,productName:r,productColor:s,size:a,queueCount:i,onSubmit:o}){const[l,d]=P.useState(""),[c,u]=P.useState(""),[h,f]=P.useState(""),[m,p]=P.useState(""),[g,x]=P.useState(!1),v=async()=>{if(!l.trim())return;x(!0);const y=await o({instagram:l.trim(),nome:c.trim()||void 0,whatsapp:h.trim()||void 0,observacao:m.trim()||void 0});x(!1),y&&(d(""),u(""),f(""),p(""),t(!1))};return n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"sm:max-w-md",children:[n.jsx(ln,{children:n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(Oi,{className:"h-5 w-5 text-amber-600"}),"Lista de Espera"]})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[n.jsx("div",{className:"font-medium",children:r}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:[s&&`${s}  `,"Tam: ",a]}),i>0&&n.jsxs("div",{className:"text-xs text-amber-600 mt-1",children:[i," pessoa(s) j na fila"]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{children:["@ do Instagram ",n.jsx("span",{className:"text-destructive",children:"*"})]}),n.jsx(et,{placeholder:"@cliente",value:l,onChange:y=>d(y.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Nome (opcional)"}),n.jsx(et,{placeholder:"Nome da cliente",value:c,onChange:y=>u(y.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"WhatsApp (opcional)"}),n.jsx(et,{placeholder:"(62) 99999-9999",value:h,onChange:y=>f(y.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Observao (opcional)"}),n.jsx(rs,{placeholder:"Ex: pode ser 38 ou 40",value:m,onChange:y=>p(y.target.value),rows:2})]})]})]}),n.jsxs(ba,{children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),n.jsx(he,{onClick:v,disabled:!l.trim()||g,children:g?"Adicionando...":"Entrar na Lista"})]})]})})}function wCe({open:e,onOpenChange:t,waitlistItem:r,product:s,onOffer:a,onSkip:i,onEndQueue:o}){var f,m,p,g;const[l,d]=P.useState(!1);if(!r||!s)return null;const c=async()=>{d(!0);const x=await a(r.id);d(!1),x&&t(!1)},u=async()=>{d(!0),await i(r.id),d(!1)},h=async()=>{var x;d(!0),await o(r.product_id,((x=r.variante)==null?void 0:x.tamanho)||""),d(!1),t(!1)};return n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"sm:max-w-[400px] p-0 overflow-hidden",children:[n.jsx(ln,{className:"p-5 pb-0",children:n.jsxs(rn,{className:"flex items-center gap-2 text-base",children:[n.jsx(Oi,{className:"h-5 w-5 text-amber-600 shrink-0"}),"Estoque Liberado!"]})}),n.jsxs("div",{className:"px-5 py-4 space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded-md overflow-hidden shrink-0",children:((f=s.product)==null?void 0:f.image_url)&&n.jsx("img",{src:s.product.image_url,alt:s.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:(m=s.product)==null?void 0:m.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[((p=s.product)==null?void 0:p.color)&&`${s.product.color}  `,"Tam: ",(g=r.variante)==null?void 0:g.tamanho]})]})]}),n.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[n.jsx(lz,{className:"h-4 w-4 text-amber-600 shrink-0"}),n.jsx("span",{className:"text-xs font-medium text-amber-800",children:"Prximo(a) na lista de espera:"})]}),n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("span",{className:"text-base font-bold text-amber-900 truncate block",children:r.instagram_handle}),r.whatsapp&&n.jsx("div",{className:"text-xs text-amber-700 truncate",children:r.whatsapp})]}),n.jsxs(ke,{variant:"outline",className:"border-amber-300 text-amber-700 text-xs shrink-0 whitespace-nowrap",children:["#",r.ordem," na fila"]})]})]}),n.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Deseja oferecer este item para"," ",n.jsx("strong",{className:"text-foreground",children:r.instagram_handle}),"?"]})]}),n.jsxs("div",{className:"px-5 pb-5 pt-0 flex flex-col gap-2",children:[n.jsxs(he,{onClick:c,disabled:l,className:"w-full gap-1.5 bg-green-600 hover:bg-green-700",children:[n.jsx(Sr,{className:"h-4 w-4"}),"Oferecer para ",r.instagram_handle.length>12?r.instagram_handle.substring(0,12)+"...":r.instagram_handle]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{variant:"outline",onClick:h,disabled:l,className:"flex-1 gap-1 text-xs h-9",children:[n.jsx(Kn,{className:"h-3.5 w-3.5"}),"Encerrar Fila"]}),n.jsxs(he,{variant:"secondary",onClick:u,disabled:l,className:"flex-1 gap-1 text-xs h-9",children:[n.jsx(D6,{className:"h-3.5 w-3.5"}),"Pular"]})]})]})]})})}function _Ce({carts:e,onCartClick:t,onSendWhatsApp:r,onDismiss:s}){const[a,i]=P.useState(!0),[o,l]=P.useState(new Set),d=new Date,c=new Date(d.getTime()-24*60*60*1e3),u=e.filter(p=>{if(!["aberto","aguardando_pagamento","em_confirmacao"].includes(p.status))return!1;const v=new Date(p.created_at)<c,y=o.has(p.id);return v&&!y}),h=(p,g)=>{g.stopPropagation(),l(x=>new Set([...x,p])),s==null||s(p)},f=p=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(p),m=p=>Vk(new Date(p),{addSuffix:!0,locale:mr});return u.length===0?null:n.jsx(pg,{open:a,onOpenChange:i,children:n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg overflow-hidden",children:[n.jsx(gg,{asChild:!0,children:n.jsxs("button",{className:"w-full px-4 py-3 flex items-center justify-between hover:bg-amber-100/50 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Or,{className:"h-5 w-5 text-amber-600"}),n.jsxs("span",{className:"font-medium text-amber-800",children:[u.length," carrinho",u.length!==1?"s":""," pendente",u.length!==1?"s":""," h +24h"]}),n.jsx(ke,{variant:"outline",className:"bg-amber-100 text-amber-700 border-amber-300",children:"Ao necessria"})]}),a?n.jsx(ip,{className:"h-4 w-4 text-amber-600"}):n.jsx(zo,{className:"h-4 w-4 text-amber-600"})]})}),n.jsx(xg,{children:n.jsxs("div",{className:"px-4 pb-4 space-y-2",children:[n.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"Estes carrinhos esto aguardando pagamento. Considere entrar em contato ou cancelar para liberar o estoque."}),u.map(p=>{const g=p.live_customer,x=(p.items||[]).filter(v=>["reservado","confirmado"].includes(v.status)).length;return n.jsxs("div",{className:"flex items-center justify-between gap-3 p-3 bg-white rounded-lg border border-amber-200 hover:border-amber-300 transition-colors cursor-pointer",onClick:()=>t(p),children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"font-medium text-sm truncate",children:["@",(g==null?void 0:g.instagram_handle)||"desconhecido"]}),(g==null?void 0:g.nome)&&n.jsxs("span",{className:"text-xs text-muted-foreground truncate",children:["(",g.nome.split(" ")[0],")"]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5",children:[n.jsx(Lr,{className:"h-3 w-3"}),n.jsx("span",{children:m(p.created_at)}),n.jsx("span",{children:""}),n.jsxs("span",{children:[x," item",x!==1?"s":""]}),n.jsx("span",{children:""}),n.jsx("span",{className:"font-medium text-amber-700",children:f(p.total)})]})]}),n.jsxs("div",{className:"flex items-center gap-1.5 shrink-0",children:[(g==null?void 0:g.whatsapp)&&n.jsx(he,{size:"sm",variant:"outline",className:"h-8 px-2 text-green-600 hover:text-green-700 hover:bg-green-50",onClick:v=>r(p,v),children:n.jsx(nn,{className:"h-4 w-4"})}),n.jsx(he,{size:"sm",variant:"ghost",className:"h-8 px-2 text-muted-foreground hover:text-foreground",onClick:v=>h(p.id,v),children:n.jsx(sn,{className:"h-4 w-4"})})]})]},p.id)})]})})]})})}const R7={ativa:{label:"Aguardando",icon:Lr,color:"bg-amber-100 text-amber-700"},chamada:{label:"Chamado",icon:kl,color:"bg-blue-100 text-blue-700"},atendida:{label:"Transferido",icon:Sr,color:"bg-green-100 text-green-700"},cancelada:{label:"Cancelado",icon:Kn,color:"bg-muted text-muted-foreground"}};function jCe({open:e,onOpenChange:t,productName:r,productColor:s,size:a,entries:i,hasStock:o,onAllocate:l,onSkip:d,onEndQueue:c,onAddToWaitlist:u}){const[h,f]=P.useState(null),m=i.filter(v=>v.status==="ativa"),p=i.filter(v=>v.status!=="ativa"),g=async v=>{f(v),await l(v),f(null)},x=async v=>{f(v),await d(v),f(null)};return n.jsx(_u,{open:e,onOpenChange:t,children:n.jsxs(rd,{className:"sm:max-w-md flex flex-col",children:[n.jsxs(ju,{className:"shrink-0",children:[n.jsxs(Zh,{className:"flex items-center gap-2",children:[n.jsx(Oi,{className:"h-5 w-5 text-amber-600"}),"Lista de Espera"]}),n.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg text-left",children:[n.jsx("div",{className:"font-medium",children:r}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:[s&&`${s}  `,"Tam: ",a]})]})]}),n.jsxs(gi,{className:"flex-1 -mx-6 px-6",children:[o&&m.length>0&&n.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg mb-4 animate-pulse",children:[n.jsxs("div",{className:"flex items-center gap-2 text-amber-800",children:[n.jsx(Sr,{className:"h-5 w-5"}),n.jsx("span",{className:"font-medium",children:"Estoque disponvel!"})]}),n.jsxs("p",{className:"text-sm text-amber-700 mt-1",children:["Oferea para ",m[0].instagram_handle]})]}),m.length>0?n.jsxs("div",{className:"space-y-2",children:[n.jsxs("h4",{className:"text-sm font-medium text-muted-foreground mb-2",children:["Fila ativa (",m.length,")"]}),m.map((v,y)=>{const b=y===0,j=h===v.id,T=v.variante;return n.jsx("div",{className:`p-3 rounded-lg border transition-colors ${b&&o?"border-amber-300 bg-amber-50":"hover:bg-muted/30"}`,children:n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(ke,{variant:"outline",className:`shrink-0 ${b?"border-amber-400 bg-amber-100 text-amber-800":""}`,children:["#",v.ordem]}),n.jsx("span",{className:"font-medium truncate",children:v.instagram_handle})]}),v.whatsapp&&n.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5 flex items-center gap-1",children:[n.jsx(kl,{className:"h-3 w-3"}),v.whatsapp]}),(T==null?void 0:T.observacao)&&n.jsxs("div",{className:"text-xs text-muted-foreground mt-1 italic",children:['"',T.observacao,'"']}),n.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:Wt(new Date(v.created_at),"dd/MM 's' HH:mm",{locale:mr})})]}),n.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[b&&o&&n.jsxs(he,{size:"sm",className:"gap-1 bg-green-600 hover:bg-green-700",disabled:j,onClick:()=>g(v.id),children:[n.jsx(Sr,{className:"h-3 w-3"}),"Transferir"]}),n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsx(he,{size:"icon",variant:"ghost",className:"h-8 w-8",disabled:j,onClick:()=>x(v.id),children:n.jsx(D6,{className:"h-4 w-4"})})}),n.jsx(Sa,{children:"Pular (no respondeu)"})]})]})]})},v.id)})]}):n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Oi,{className:"h-10 w-10 mx-auto mb-3 opacity-30"}),n.jsx("p",{className:"text-sm",children:"Nenhuma pessoa na fila"})]}),p.length>0&&n.jsxs("div",{className:"mt-6",children:[n.jsxs("h4",{className:"text-sm font-medium text-muted-foreground mb-2",children:["Histrico (",p.length,")"]}),n.jsx("div",{className:"space-y-1",children:p.slice(0,5).map(v=>{const y=R7[v.status]||R7.ativa,b=y.icon;return n.jsxs("div",{className:"flex items-center gap-2 p-2 text-sm rounded opacity-60",children:[n.jsx(b,{className:"h-3 w-3 shrink-0"}),n.jsx("span",{className:"truncate",children:v.instagram_handle}),n.jsx(ke,{variant:"outline",className:`text-xs ml-auto ${y.color}`,children:y.label})]},v.id)})})]})]}),n.jsxs(eV,{className:"shrink-0 gap-2 sm:gap-2 pt-4 border-t",children:[n.jsxs(he,{variant:"outline",className:"flex-1 gap-1",onClick:u,children:[n.jsx(lz,{className:"h-4 w-4"}),"Adicionar"]}),m.length>0&&n.jsxs(he,{variant:"destructive",className:"flex-1 gap-1",onClick:c,children:[n.jsx(Kn,{className:"h-4 w-4"}),"Encerrar Fila"]})]})]})})}function NCe({entries:e,products:t,getAvailableStock:r,onOfferClick:s}){const a=[];return e.forEach(i=>{var u;if(i.status!=="ativa")return;const o=t.find(h=>h.product_id===i.product_id);if(!(o!=null&&o.product))return;const l=((u=i.variante)==null?void 0:u.tamanho)||"",d=o.product.available_by_size||{},c=r(o.product_id,l,d[l]||0);c>0&&a.push({entry:i,product:o,availableStock:c})}),a.length===0?null:n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 animate-pulse",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Or,{className:"h-5 w-5 text-amber-600"}),n.jsxs("span",{className:"font-semibold text-amber-800",children:["Estoque Liberado - ",a.length," na Fila"]})]}),n.jsxs("div",{className:"space-y-2",children:[a.slice(0,3).map(({entry:i,product:o,availableStock:l})=>{var d,c,u;return n.jsxs("div",{className:"flex items-center justify-between gap-2 p-2 bg-white/50 rounded",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[n.jsx("div",{className:"w-8 h-8 bg-secondary rounded overflow-hidden shrink-0",children:((d=o.product)==null?void 0:d.image_url)&&n.jsx("img",{src:o.product.image_url,alt:"",className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("div",{className:"text-sm font-medium truncate",children:i.instagram_handle}),n.jsxs("div",{className:"text-xs text-amber-700",children:[(c=o.product)==null?void 0:c.name," - Tam: ",(u=i.variante)==null?void 0:u.tamanho]})]})]}),n.jsxs(he,{size:"sm",className:"shrink-0 gap-1 bg-amber-600 hover:bg-amber-700",onClick:()=>s(i,o),children:[n.jsx(hs,{className:"h-3 w-3"}),"Oferecer"]})]},i.id)}),a.length>3&&n.jsxs("div",{className:"text-xs text-amber-600 text-center",children:["+",a.length-3," mais na fila"]})]})]})}const K3={ativa:{label:"Aguardando",icon:Lr,color:"bg-amber-100 text-amber-800 border-amber-200"},chamada:{label:"Chamada",icon:kl,color:"bg-blue-100 text-blue-800 border-blue-200"},atendida:{label:"Atendida",icon:Sr,color:"bg-green-100 text-green-800 border-green-200"},cancelada:{label:"Cancelada",icon:Kn,color:"bg-muted text-muted-foreground border-muted"}};function M7({waitlist:e,products:t,onAllocate:r,onSkip:s,onEndQueue:a,getAvailableStock:i}){const[o,l]=P.useState(""),[d,c]=P.useState("all"),[u,h]=P.useState("all"),[f,m]=P.useState(null),p=P.useMemo(()=>e,[e]),g=P.useMemo(()=>p.filter(R=>{var Y;const D=!o||R.instagram_handle.toLowerCase().includes(o.toLowerCase())||((Y=R.whatsapp)==null?void 0:Y.includes(o)),B=d==="all"||R.status===d,q=u==="all"||R.product_id===u;return D&&B&&q}),[p,o,d,u]),x=P.useMemo(()=>{const R={};return p.forEach(D=>{var Y,G;const B=((Y=D.variante)==null?void 0:Y.tamanho)||"",q=`${D.product_id}_${B}`;if(!R[q]){const I=t.find(E=>E.product_id===D.product_id),F=((G=I==null?void 0:I.product)==null?void 0:G.available_by_size)||{},S=i(D.product_id,B,F[B]||0);R[q]={product:I,size:B,entries:[],activeCount:0,attendedCount:0,cancelledCount:0,hasStock:S>0,availableStock:S}}R[q].entries.push(D),D.status==="ativa"?R[q].activeCount++:D.status==="atendida"?R[q].attendedCount++:D.status==="cancelada"&&R[q].cancelledCount++}),Object.values(R).sort((D,B)=>D.hasStock&&D.activeCount>0&&!(B.hasStock&&B.activeCount>0)?-1:B.hasStock&&B.activeCount>0&&!(D.hasStock&&D.activeCount>0)?1:B.activeCount-D.activeCount)},[p,t,i]),v=P.useMemo(()=>{const R=p.filter(Y=>Y.status==="ativa").length,D=p.filter(Y=>Y.status==="atendida").length,B=p.filter(Y=>Y.status==="cancelada").length,q=x.filter(Y=>Y.hasStock&&Y.activeCount>0).length;return{active:R,attended:D,cancelled:B,withStockAvailable:q,total:p.length}},[p,x]),y=P.useMemo(()=>[...new Set(p.map(D=>D.product_id))].map(D=>t.find(B=>B.product_id===D)).filter(Boolean),[p,t]),b=async R=>{m(R),await r(R),m(null)},j=async R=>{m(R),await s(R),m(null)},T=R=>{var D;return(D=t.find(B=>B.product_id===R))==null?void 0:D.product},O=()=>{const R=["#","Instagram","WhatsApp","Produto","Cor","Tamanho","Status","Data/Hora"],D=g.map(G=>{var S;const I=T(G.product_id),F=G.variante;return[G.ordem,G.instagram_handle,G.whatsapp||"-",(I==null?void 0:I.name)||"-",(F==null?void 0:F.cor)||"-",(F==null?void 0:F.tamanho)||"-",((S=K3[G.status])==null?void 0:S.label)||G.status,Wt(new Date(G.created_at),"dd/MM/yyyy HH:mm",{locale:mr})]}),B=[R,...D].map(G=>G.join(",")).join(`
`),q=new Blob([B],{type:"text/csv;charset=utf-8;"}),Y=document.createElement("a");Y.href=URL.createObjectURL(q),Y.download=`lista-espera-${Wt(new Date,"yyyy-MM-dd")}.csv`,Y.click()};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[n.jsx($e,{className:"bg-gradient-to-br from-amber-50 to-amber-100/50 border-amber-200",children:n.jsxs(Fe,{className:"p-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Lr,{className:"h-4 w-4 text-amber-600"}),n.jsx("span",{className:"text-xs text-amber-700",children:"Aguardando"})]}),n.jsx("div",{className:"text-2xl font-bold text-amber-800",children:v.active})]})}),n.jsx($e,{className:"bg-gradient-to-br from-green-50 to-green-100/50 border-green-200",children:n.jsxs(Fe,{className:"p-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Sr,{className:"h-4 w-4 text-green-600"}),n.jsx("span",{className:"text-xs text-green-700",children:"Atendidas"})]}),n.jsx("div",{className:"text-2xl font-bold text-green-800",children:v.attended})]})}),n.jsx($e,{className:"bg-gradient-to-br from-muted to-muted/50",children:n.jsxs(Fe,{className:"p-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Kn,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"Canceladas"})]}),n.jsx("div",{className:"text-2xl font-bold",children:v.cancelled})]})}),v.withStockAvailable>0&&n.jsx($e,{className:"bg-gradient-to-br from-amber-100 to-orange-100 border-amber-300 animate-pulse col-span-2 md:col-span-2",children:n.jsxs(Fe,{className:"p-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Or,{className:"h-4 w-4 text-amber-700"}),n.jsx("span",{className:"text-xs font-medium text-amber-800",children:" Ao Necessria"})]}),n.jsxs("div",{className:"text-lg font-bold text-amber-900",children:[v.withStockAvailable," variao(es) com estoque liberado"]})]})})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por @ ou WhatsApp...",value:o,onChange:R=>l(R.target.value),className:"pl-9"})]}),n.jsxs(Xt,{value:d,onValueChange:R=>c(R),children:[n.jsx(Ht,{className:"w-full sm:w-40",children:n.jsx(Yt,{placeholder:"Status"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todos"}),n.jsx(qe,{value:"ativa",children:"Aguardando"}),n.jsx(qe,{value:"atendida",children:"Atendidas"}),n.jsx(qe,{value:"cancelada",children:"Canceladas"})]})]}),n.jsxs(Xt,{value:u,onValueChange:h,children:[n.jsx(Ht,{className:"w-full sm:w-48",children:n.jsx(Yt,{placeholder:"Produto"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todos os produtos"}),y.map(R=>{var D,B;return n.jsx(qe,{value:R.product_id,children:((B=(D=R.product)==null?void 0:D.name)==null?void 0:B.substring(0,25))||"Produto"},R.product_id)})]})]}),n.jsx(he,{variant:"outline",size:"icon",onClick:O,children:n.jsx(vf,{className:"h-4 w-4"})})]}),x.filter(R=>R.hasStock&&R.activeCount>0).length>0&&n.jsxs($e,{className:"border-amber-300 bg-amber-50/50",children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-sm flex items-center gap-2 text-amber-800",children:[n.jsx(Or,{className:"h-4 w-4"}),"Produtos com estoque liberado e fila ativa"]})}),n.jsx(Fe,{children:n.jsx("div",{className:"space-y-2",children:x.filter(R=>R.hasStock&&R.activeCount>0).map(R=>{var B,q,Y,G,I,F,S;const D=R.entries.find(E=>E.status==="ativa");return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-amber-200",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:((q=(B=R.product)==null?void 0:B.product)==null?void 0:q.image_url)&&n.jsx("img",{src:R.product.product.image_url,alt:R.product.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-sm",children:(G=(Y=R.product)==null?void 0:Y.product)==null?void 0:G.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[((F=(I=R.product)==null?void 0:I.product)==null?void 0:F.color)&&`${R.product.product.color}  `,"Tam: ",R.size,"  ",R.availableStock," disponvel  ",R.activeCount," na fila"]})]})]}),D&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm font-medium text-amber-800",children:D.instagram_handle}),n.jsxs(he,{size:"sm",className:"gap-1 bg-green-600 hover:bg-green-700",disabled:f===D.id,onClick:()=>b(D.id),children:[n.jsx(Sr,{className:"h-3 w-3"}),"Transferir"]})]})]},`${(S=R.product)==null?void 0:S.product_id}_${R.size}`)})})})]}),n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-sm flex items-center gap-2",children:[n.jsx(Oi,{className:"h-4 w-4"}),"Lista Completa (",g.length," registros)"]})}),n.jsx(Fe,{className:"p-0",children:n.jsx(gi,{className:"h-[400px]",children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{children:[n.jsx(St,{className:"w-12",children:"#"}),n.jsx(St,{children:"Cliente"}),n.jsx(St,{children:"Produto"}),n.jsx(St,{children:"Tamanho"}),n.jsx(St,{children:"Status"}),n.jsx(St,{children:"Data"}),n.jsx(St,{className:"text-right",children:"Aes"})]})}),n.jsx(ya,{children:g.length===0?n.jsx(Kr,{children:n.jsxs(bt,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:[n.jsx(Oi,{className:"h-8 w-8 mx-auto mb-2 opacity-30"}),n.jsx("p",{children:"Nenhum registro encontrado"})]})}):g.map(R=>{var E,N;const D=T(R.product_id),B=R.variante,q=K3[R.status]||K3.ativa,Y=q.icon,G=R.status==="ativa",I=((N=(E=t.find(C=>C.product_id===R.product_id))==null?void 0:E.product)==null?void 0:N.available_by_size)||{},F=i(R.product_id,(B==null?void 0:B.tamanho)||"",I[B==null?void 0:B.tamanho]||0),S=G&&F>0;return n.jsxs(Kr,{className:S?"bg-amber-50/50":"",children:[n.jsx(bt,{children:n.jsx(ke,{variant:"outline",className:"text-xs",children:R.ordem})}),n.jsxs(bt,{children:[n.jsx("div",{className:"font-medium",children:R.instagram_handle}),R.whatsapp&&n.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[n.jsx(kl,{className:"h-3 w-3"}),R.whatsapp]})]}),n.jsx(bt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 bg-secondary rounded overflow-hidden shrink-0",children:(D==null?void 0:D.image_url)&&n.jsx("img",{src:D.image_url,alt:D.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium truncate max-w-32",children:(D==null?void 0:D.name)||"Produto"}),(B==null?void 0:B.cor)&&n.jsx("div",{className:"text-xs text-muted-foreground",children:B.cor})]})]})}),n.jsx(bt,{children:n.jsx(ke,{variant:"secondary",children:(B==null?void 0:B.tamanho)||"-"})}),n.jsx(bt,{children:n.jsxs(ke,{variant:"outline",className:q.color,children:[n.jsx(Y,{className:"h-3 w-3 mr-1"}),q.label]})}),n.jsx(bt,{className:"text-xs text-muted-foreground",children:Wt(new Date(R.created_at),"dd/MM HH:mm",{locale:mr})}),n.jsx(bt,{className:"text-right",children:G&&n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[S&&n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsx(he,{size:"icon",variant:"default",className:"h-7 w-7 bg-green-600 hover:bg-green-700",disabled:f===R.id,onClick:()=>b(R.id),children:n.jsx(Sr,{className:"h-3 w-3"})})}),n.jsx(Sa,{children:"Transferir para carrinho"})]}),n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsx(he,{size:"icon",variant:"ghost",className:"h-7 w-7",disabled:f===R.id,onClick:()=>j(R.id),children:n.jsx(D6,{className:"h-3 w-3"})})}),n.jsx(Sa,{children:"Pular (no respondeu)"})]})]})})]},R.id)})})]})})})]}),n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-sm flex items-center gap-2",children:[n.jsx(Vt,{className:"h-4 w-4"}),"Resumo por Produto/Tamanho"]})}),n.jsx(Fe,{children:n.jsxs("div",{className:"space-y-2",children:[x.map(R=>{var D,B,q,Y,G,I,F;return n.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${R.hasStock&&R.activeCount>0?"border-amber-300 bg-amber-50/50":"bg-muted/30"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:((B=(D=R.product)==null?void 0:D.product)==null?void 0:B.image_url)&&n.jsx("img",{src:R.product.product.image_url,alt:R.product.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-sm",children:(Y=(q=R.product)==null?void 0:q.product)==null?void 0:Y.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[((I=(G=R.product)==null?void 0:G.product)==null?void 0:I.color)&&`${R.product.product.color}  `,"Tamanho: ",R.size]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[R.hasStock&&R.activeCount>0&&n.jsxs(ke,{className:"bg-amber-500 text-white animate-pulse text-xs",children:[R.availableStock," disponvel"]}),n.jsxs(ke,{variant:"outline",className:"text-xs",children:[n.jsx(Lr,{className:"h-3 w-3 mr-1"}),R.activeCount]}),n.jsxs(ke,{variant:"outline",className:"text-xs text-green-700",children:[n.jsx(Sr,{className:"h-3 w-3 mr-1"}),R.attendedCount]}),n.jsxs(ke,{variant:"outline",className:"text-xs text-muted-foreground",children:[n.jsx(Kn,{className:"h-3 w-3 mr-1"}),R.cancelledCount]})]})]},`${(F=R.product)==null?void 0:F.product_id}_${R.size}`)}),x.length===0&&n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Oi,{className:"h-8 w-8 mx-auto mb-2 opacity-30"}),n.jsx("p",{children:"Nenhum item na lista de espera"})]})]})})]})]})}function SCe({open:e,onClose:t,onCreated:r}){const[s,a]=P.useState(""),[i,o]=P.useState("1"),[l,d]=P.useState(""),[c,u]=P.useState(!1),h=async()=>{if(!s.trim()){de.error("Preencha o nome do brinde");return}u(!0);try{const{data:f,error:m}=await le.from("gifts").insert({name:s.trim(),stock_qty:parseInt(i)||1,image_url:l.trim()||null,is_active:!0,unlimited_stock:!1}).select().single();if(m)throw m;de.success(`Brinde "${s}" criado!`),r(f.id),a(""),o("1"),d(""),t()}catch(f){console.error("Error creating gift:",f),de.error("Erro ao criar brinde")}finally{u(!1)}};return n.jsx(tn,{open:e,onOpenChange:f=>!f&&t(),children:n.jsxs(Jr,{className:"sm:max-w-md",children:[n.jsx(ln,{children:n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(kn,{className:"h-5 w-5"}),"Criar Novo Brinde"]})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Nome do Brinde *"}),n.jsx(et,{placeholder:"Ex: Brinco Semijoia, Caixa de Bombom...",value:s,onChange:f=>a(f.target.value)})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Quantidade"}),n.jsx(et,{type:"number",min:"1",value:i,onChange:f=>o(f.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"URL da Imagem (opcional)"}),n.jsx(et,{placeholder:"https://...",value:l,onChange:f=>d(f.target.value)})]})]}),n.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[n.jsx(he,{variant:"outline",onClick:t,children:"Cancelar"}),n.jsx(he,{onClick:h,disabled:c,children:c?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Criando..."]}):"Criar e Selecionar"})]})]})]})})}function CCe({eventId:e,carts:t,onRefresh:r,onRaffleOverlayChange:s}){var H,ee,ie,oe,se,ue,pe;const[a,i]=P.useState([]),[o,l]=P.useState(!0),[d,c]=P.useState(""),[u,h]=P.useState(!1),[f,m]=P.useState(!1),[p,g]=P.useState("idle"),[x,v]=P.useState(null),[y,b]=P.useState([]),[j,T]=P.useState(!1),O=P.useRef(null),R=P.useRef("idle"),[D,B]=P.useState(null),[q,Y]=P.useState(""),[G,I]=P.useState(!1),[F,S]=P.useState(null);P.useEffect(()=>{const ce=p==="spinning"||p==="winner_revealed"||p==="applying_prize";R.current=p,s==null||s(ce)},[p,s]);const E=P.useCallback(async()=>{l(!0);try{const ce=new Date().toISOString(),{data:ne,error:me}=await le.from("gifts").select("*").eq("is_active",!0).or(`start_at.is.null,start_at.lte.${ce}`).or(`end_at.is.null,end_at.gte.${ce}`).order("name");if(me)throw me;const ge=(ne||[]).filter(_e=>_e.unlimited_stock||_e.stock_qty>0);i(ge)}catch(ce){console.error("Error fetching gifts:",ce)}finally{l(!1)}},[]),N=P.useCallback(async()=>{const{data:ce}=await le.from("live_raffles").select(`
        id,
        gift_id,
        winner_instagram_handle,
        winner_bag_number,
        winner_live_cart_id,
        created_at,
        status,
        applied_at,
        gift:gifts(*)
      `).eq("live_event_id",e).order("created_at",{ascending:!1}).limit(20);b(ce||[])},[e]);P.useEffect(()=>{E(),N()},[E,N]);const C=ce=>{const ne=t.find(me=>me.id===ce.winner_live_cart_id);return(ne==null?void 0:ne.status)==="pago"},k=async()=>{if(!(!D||!q)){if(C(D)){de.error("Este pedido j foi pago. Ajustes no so permitidos.");return}I(!0);try{const ce=a.find(ne=>ne.id===q);if(!ce)throw new Error("Brinde no encontrado");if(!ce.unlimited_stock&&ce.stock_qty<1){de.error(`Brinde "${ce.name}" sem estoque!`);return}if(D.status==="applied"){await le.from("order_gifts").delete().eq("applied_by_raffle_id",D.id),D.gift_id&&await le.rpc("decrement_gift_stock",{p_gift_id:D.gift_id,p_qty:-1}),await le.from("order_gifts").insert({live_cart_id:D.winner_live_cart_id,gift_id:q,qty:1,status:"pending_separation",applied_by_raffle_id:D.id}),await le.rpc("decrement_gift_stock",{p_gift_id:q,p_qty:1});const ne=t.find(ge=>ge.id===D.winner_live_cart_id),me=!!(ne!=null&&ne.bag_number&&(ne!=null&&ne.label_printed_at));await le.from("live_carts").update({raffle_prize:ce.name,raffle_name:`Sorteio - ${ce.name}`,needs_label_reprint:me}).eq("id",D.winner_live_cart_id)}await le.from("live_raffles").update({gift_id:q}).eq("id",D.id),de.success("Brinde atualizado com sucesso"),B(null),Y(""),N(),E(),r==null||r()}catch(ce){console.error("Error updating raffle:",ce),de.error("Erro ao atualizar brinde")}finally{I(!1)}}},M=async()=>{if(F){if(C(F)){de.error("Este pedido j foi pago. Cancelamento no  permitido."),S(null);return}I(!0);try{if(F.status==="applied"){await le.from("order_gifts").delete().eq("applied_by_raffle_id",F.id),F.gift_id&&await le.rpc("decrement_gift_stock",{p_gift_id:F.gift_id,p_qty:-1});const ce=t.find(me=>me.id===F.winner_live_cart_id),ne=!!(ce!=null&&ce.bag_number&&(ce!=null&&ce.label_printed_at));await le.from("live_carts").update({is_raffle_winner:!1,raffle_name:null,raffle_prize:null,raffle_applied:!1,needs_label_reprint:ne}).eq("id",F.winner_live_cart_id)}await le.from("live_raffles").update({status:"cancelled"}).eq("id",F.id),de.success("Sorteio cancelado"),S(null),N(),E(),r==null||r()}catch(ce){console.error("Error canceling raffle:",ce),de.error("Erro ao cancelar sorteio")}finally{I(!1)}}},U=t.filter(ce=>!(!(ce.items||[]).some(me=>["reservado","confirmado"].includes(me.status))||u&&ce.status!=="pago"||ce.status==="cancelado")),$=async()=>{var ge,_e,be;if(!d){de.error("Selecione um brinde para sortear");return}if(U.length===0){de.error("No h sacolas elegveis para o sorteio");return}const ce=a.find(ye=>ye.id===d);if(!ce)return;if(!ce.unlimited_stock&&ce.stock_qty<1){de.error(`Brinde "${ce.name}" sem estoque!`);return}m(!0),g("spinning"),await new Promise(ye=>setTimeout(ye,3e3));const ne=Math.floor(Math.random()*U.length),me=U[ne];try{const{data:ye}=await le.auth.getSession(),{data:Oe,error:Ne}=await le.from("live_raffles").insert({live_event_id:e,gift_id:d,winner_live_cart_id:me.id,winner_bag_number:me.bag_number,winner_instagram_handle:(ge=me.live_customer)==null?void 0:ge.instagram_handle,created_by:(be=(_e=ye==null?void 0:ye.session)==null?void 0:_e.user)==null?void 0:be.id,status:"pending"}).select().single();if(Ne)throw Ne;const De={cart:me,gift:ce,raffleId:Oe.id};O.current=De,v(De),g("winner_revealed"),N()}catch(ye){console.error("Error recording raffle:",ye),de.error("Erro ao registrar o sorteio"),m(!1),g("idle")}},X=async()=>{var ne;const ce=x||O.current;if(ce){g("applying_prize");try{const{cart:me,gift:ge,raffleId:_e}=ce,{error:be}=await le.from("order_gifts").insert({live_cart_id:me.id,gift_id:ge.id,qty:1,status:"pending_separation",applied_by_raffle_id:_e});if(be)throw be;await le.rpc("decrement_gift_stock",{p_gift_id:ge.id,p_qty:1});const ye=!!(me.bag_number&&me.label_printed_at);await le.from("live_carts").update({is_raffle_winner:!0,raffle_name:`Sorteio - ${ge.name}`,raffle_prize:ge.name,raffle_applied:!0,needs_label_reprint:ye}).eq("id",me.id),await le.from("live_raffles").update({status:"applied",applied_at:new Date().toISOString()}).eq("id",_e),de.success(` Prmio aplicado! ${(ne=me.live_customer)==null?void 0:ne.instagram_handle} ganhou ${ge.name}!`),g("done"),N(),E(),r==null||r()}catch(me){console.error("Error applying prize:",me),de.error("Erro ao aplicar o prmio"),g("winner_revealed")}}},Z=()=>{m(!1),v(null),O.current=null,g("idle")},re=ce=>{E(),c(ce)},W=a.find(ce=>ce.id===d),J=x||O.current,V=ce=>{switch(ce.status){case"pending":return n.jsx(ke,{variant:"outline",className:"bg-amber-100 text-amber-800 border-amber-300",children:"Pendente"});case"applied":return n.jsx(ke,{variant:"outline",className:"bg-green-100 text-green-800 border-green-300",children:"Aplicado"});case"cancelled":return n.jsx(ke,{variant:"outline",className:"bg-red-100 text-red-800 border-red-300",children:"Cancelado"});default:return null}};return n.jsxs(n.Fragment,{children:[n.jsxs($e,{children:[n.jsxs(Dt,{children:[n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(ma,{className:"h-5 w-5 text-amber-500"}),"Sorteio ao Vivo"]}),n.jsx(qi,{children:"Sorteie brindes entre as sacolas da live"})]}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Brinde para sortear"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(Xt,{value:d,onValueChange:c,children:[n.jsx(Ht,{className:"flex-1",children:n.jsx(Yt,{placeholder:"Selecione um brinde cadastrado"})}),n.jsx(Gt,{className:"bg-background z-50",children:o?n.jsxs("div",{className:"p-3 text-center text-sm text-muted-foreground",children:[n.jsx(Et,{className:"h-4 w-4 animate-spin mx-auto mb-1"}),"Carregando..."]}):a.length===0?n.jsx("div",{className:"p-3 text-center text-sm text-muted-foreground",children:"Nenhum brinde disponvel"}):a.map(ce=>n.jsx(qe,{value:ce.id,children:n.jsxs("span",{className:"flex items-center gap-2",children:[ce.image_url?n.jsx("img",{src:ce.image_url,alt:"",className:"w-5 h-5 rounded object-cover"}):n.jsx(Pn,{className:"h-4 w-4"}),ce.name,!ce.unlimited_stock&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",ce.stock_qty," disponveis)"]})]})},ce.id))})]}),n.jsx(he,{variant:"outline",size:"icon",onClick:()=>T(!0),title:"Criar novo brinde",children:n.jsx(kn,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:E,title:"Atualizar lista",children:n.jsx(Qr,{className:"h-4 w-4"})})]})]}),W&&n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg flex items-center gap-3",children:[W.image_url?n.jsx("img",{src:W.image_url,alt:W.name,className:"w-12 h-12 rounded object-cover"}):n.jsx("div",{className:"w-12 h-12 rounded bg-muted flex items-center justify-center",children:n.jsx(Pn,{className:"h-6 w-6 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium",children:W.name}),n.jsx("div",{className:"text-sm text-muted-foreground",children:W.unlimited_stock?"Estoque ilimitado":`${W.stock_qty} disponveis`})]})]}),n.jsx("div",{className:"flex items-center gap-4",children:n.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u,onChange:ce=>h(ce.target.checked),className:"rounded border-input"}),"Apenas sacolas pagas"]})}),n.jsx("div",{className:"p-3 bg-secondary/50 rounded-lg",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Sacolas elegveis:"}),n.jsx(ke,{variant:"secondary",className:"text-lg font-bold",children:U.length})]})}),n.jsx(he,{onClick:$,disabled:p!=="idle"||!d||U.length===0,className:"w-full gap-2 h-12 text-lg",size:"lg",children:p!=="idle"?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-5 w-5 animate-spin"}),"Sorteando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Gr,{className:"h-5 w-5"}),"Sortear Agora"]})}),y.length>0&&n.jsxs("div",{className:"pt-4 border-t space-y-2",children:[n.jsx("h4",{className:"text-sm font-medium",children:"Sorteios desta live"}),n.jsx("div",{className:"space-y-2",children:y.map(ce=>{var ge,_e;const ne=C(ce),me=ce.status==="cancelled";return n.jsxs("div",{className:`flex items-center gap-2 p-2 rounded text-sm ${me?"bg-secondary/20 opacity-60":"bg-secondary/30"}`,children:[n.jsx(ma,{className:`h-4 w-4 shrink-0 ${me?"text-muted-foreground":"text-amber-500"}`}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("span",{className:`font-medium ${me?"line-through":""}`,children:["@",(ge=ce.winner_instagram_handle)==null?void 0:ge.replace(/^@/,"")]}),ce.winner_bag_number&&n.jsxs("span",{className:"text-muted-foreground ml-1",children:["(Sacola #",ce.winner_bag_number,")"]})]}),n.jsx(ke,{variant:"outline",className:"shrink-0",children:((_e=ce.gift)==null?void 0:_e.name)||"Brinde"}),V(ce),!me&&n.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[n.jsx(he,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{if(ne){de.error("Este pedido j foi pago. Ajustes no so permitidos.");return}B(ce),Y(ce.gift_id||"")},title:ne?"Pedido pago - no pode editar":"Editar brinde",disabled:ne,children:n.jsx(Js,{className:"h-3.5 w-3.5"})}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive hover:text-destructive",onClick:()=>{if(ne){de.error("Este pedido j foi pago. Cancelamento no  permitido.");return}S(ce)},title:ne?"Pedido pago - no pode cancelar":"Cancelar sorteio",disabled:ne,children:n.jsx(Kn,{className:"h-3.5 w-3.5"})})]}),ne&&n.jsx(ke,{variant:"secondary",className:"shrink-0 text-xs",children:"Pago"})]},ce.id)})})]})]})]}),n.jsx(SCe,{open:j,onClose:()=>T(!1),onCreated:re}),n.jsx(tn,{open:!!D,onOpenChange:ce=>!ce&&B(null),children:n.jsxs(Jr,{className:"sm:max-w-md",children:[n.jsx(ln,{children:n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(Js,{className:"h-5 w-5"}),"Editar Brinde do Sorteio"]})}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg",children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Ganhadora:"}),n.jsxs("p",{className:"font-medium",children:["@",(H=D==null?void 0:D.winner_instagram_handle)==null?void 0:H.replace(/^@/,"")]}),(D==null?void 0:D.winner_bag_number)&&n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Sacola #",D.winner_bag_number]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Novo brinde"}),n.jsxs(Xt,{value:q,onValueChange:Y,children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecione um brinde"})}),n.jsx(Gt,{className:"bg-background z-50",children:a.map(ce=>n.jsx(qe,{value:ce.id,children:n.jsxs("span",{className:"flex items-center gap-2",children:[ce.image_url?n.jsx("img",{src:ce.image_url,alt:"",className:"w-5 h-5 rounded object-cover"}):n.jsx(Pn,{className:"h-4 w-4"}),ce.name,!ce.unlimited_stock&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",ce.stock_qty," disp.)"]})]})},ce.id))})]})]})]}),n.jsxs(ba,{children:[n.jsx(he,{variant:"outline",onClick:()=>B(null),disabled:G,children:"Cancelar"}),n.jsx(he,{onClick:k,disabled:!q||q===(D==null?void 0:D.gift_id)||G,children:G?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}),"Salvando..."]}):"Salvar"})]})]})}),n.jsx(_c,{open:!!F,onOpenChange:ce=>!ce&&S(null),children:n.jsxs(Tl,{children:[n.jsxs(Pl,{children:[n.jsx(Ol,{children:"Cancelar Sorteio?"}),n.jsxs(Rl,{children:["Deseja cancelar este sorteio?",(F==null?void 0:F.status)==="applied"&&n.jsxs(n.Fragment,{children:["O brinde ser removido da sacola de"," ",n.jsxs("strong",{children:["@",(ee=F==null?void 0:F.winner_instagram_handle)==null?void 0:ee.replace(/^@/,"")]}),"."]}),(F==null?void 0:F.status)==="pending"&&n.jsxs(n.Fragment,{children:["O sorteio pendente de"," ",n.jsxs("strong",{children:["@",(ie=F==null?void 0:F.winner_instagram_handle)==null?void 0:ie.replace(/^@/,"")]})," ser cancelado."]}),n.jsx("br",{}),n.jsx("br",{}),"Esta ao no pode ser desfeita."]})]}),n.jsxs(jc,{children:[n.jsx(Sc,{disabled:G,children:"Manter"}),n.jsx(Nc,{onClick:M,disabled:G,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:G?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}),"Cancelando..."]}):"Sim, Cancelar Sorteio"})]})]})}),n.jsx(tn,{open:f,onOpenChange:ce=>{!ce&&p==="done"&&Z()},children:n.jsx(Jr,{className:"sm:max-w-lg p-0 overflow-hidden border-0 bg-transparent shadow-none",onPointerDownOutside:ce=>{ce.preventDefault()},onEscapeKeyDown:ce=>{ce.preventDefault()},children:n.jsxs("div",{className:"bg-gradient-to-br from-[#faf8f5] via-white to-[#f5f0eb] rounded-2xl overflow-hidden shadow-2xl border border-amber-100",children:[n.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-amber-50 to-amber-100/50 border-b border-amber-200/50 flex justify-center",children:n.jsx("img",{src:bf,alt:"LE.PO",className:"h-10 object-contain"})}),n.jsx("div",{className:"p-8 text-center space-y-6",children:n.jsxs(R4e,{mode:"wait",children:[p==="spinning"&&n.jsxs(Ja.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-6",children:[n.jsx(Ja.div,{animate:{rotate:360},transition:{duration:.8,repeat:1/0,ease:"linear"},className:"w-28 h-28 mx-auto rounded-full bg-gradient-to-br from-amber-100 to-amber-200 flex items-center justify-center shadow-lg border-4 border-white",children:n.jsx(Pn,{className:"h-14 w-14 text-amber-600"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("h2",{className:"text-2xl font-serif text-amber-900",children:"Sorteando..."}),n.jsx("p",{className:"text-sm text-amber-700/70",children:"Selecionando a ganhadora"})]}),n.jsx("div",{className:"flex flex-wrap justify-center gap-1.5 max-h-24 overflow-hidden px-4",children:U.slice(0,15).map((ce,ne)=>{var me,ge;return n.jsx(Ja.div,{animate:{scale:[1,1.15,1],opacity:[.4,1,.4]},transition:{duration:.25,delay:ne*.06%.9,repeat:1/0},className:"px-2.5 py-1 bg-amber-100 rounded-full text-xs font-medium text-amber-800",children:(ge=(me=ce.live_customer)==null?void 0:me.instagram_handle)==null?void 0:ge.replace(/^@/,"")},ce.id)})})]},"spinning"),p==="winner_revealed"&&J&&n.jsxs(Ja.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",bounce:.4,duration:.6},className:"space-y-6",children:[n.jsxs(Ja.div,{initial:{y:-30,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"relative",children:[n.jsx(Ja.div,{animate:{scale:[1,1.05,1]},transition:{duration:1.5,repeat:1/0},className:"w-32 h-32 mx-auto rounded-full bg-gradient-to-br from-amber-300 via-amber-400 to-amber-500 flex items-center justify-center shadow-xl border-4 border-white",children:n.jsx(ma,{className:"h-16 w-16 text-white drop-shadow-lg"})}),[...Array(6)].map((ce,ne)=>n.jsx(Ja.div,{initial:{scale:0,x:0,y:0,opacity:0},animate:{scale:[0,1.2,0],x:Math.cos(ne*Math.PI/3)*70,y:Math.sin(ne*Math.PI/3)*70,opacity:[0,1,0]},transition:{delay:.3,duration:.8},className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:n.jsx(Gr,{className:"h-5 w-5 text-amber-400"})},ne))]}),n.jsxs(Ja.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"space-y-4",children:[n.jsx("h2",{className:"text-xl font-serif text-amber-800",children:" Temos uma vencedora! "}),n.jsxs("div",{className:"p-5 bg-gradient-to-br from-amber-50 to-white rounded-xl border border-amber-200 shadow-md space-y-3",children:[n.jsxs("div",{className:"text-3xl font-bold text-amber-900 tracking-tight",children:["@",(se=(oe=J.cart.live_customer)==null?void 0:oe.instagram_handle)==null?void 0:se.replace(/^@/,"")]}),J.cart.bag_number&&n.jsxs("div",{className:"flex items-center justify-center gap-2 text-amber-700",children:[n.jsx(hn,{className:"h-4 w-4"}),n.jsxs("span",{className:"font-medium",children:["Sacola #",String(J.cart.bag_number).padStart(3,"0")]})]})]}),n.jsxs("div",{className:"flex items-center justify-center gap-2 text-lg",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsxs("span",{className:"text-amber-800",children:["Ganhou: ",n.jsx("strong",{className:"text-amber-900",children:J.gift.name})]})]})]}),n.jsxs(Ja.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.6},className:"flex flex-col gap-3",children:[n.jsxs(he,{onClick:X,className:"gap-2 px-8 bg-amber-600 hover:bg-amber-700 text-white shadow-lg",size:"lg",children:[n.jsx(Pn,{className:"h-4 w-4"}),"Aplicar prmio no carrinho"]}),n.jsx(he,{onClick:Z,variant:"ghost",className:"text-amber-700 hover:text-amber-900",children:"Fechar (no aplicar)"}),n.jsx("p",{className:"text-xs text-amber-600/70",children:"O sorteio ficar como pendente na lista"})]})]},"winner_revealed"),p==="applying_prize"&&J&&n.jsxs(Ja.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[n.jsx("div",{className:"w-28 h-28 mx-auto rounded-full bg-gradient-to-br from-amber-100 to-amber-200 flex items-center justify-center shadow-lg border-4 border-white",children:n.jsx(Et,{className:"h-14 w-14 text-amber-600 animate-spin"})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h2",{className:"text-xl font-serif text-amber-900",children:"Aplicando prmio..."}),n.jsx("p",{className:"text-sm text-amber-700/70",children:"Adicionando brinde ao carrinho"})]})]},"applying"),p==="done"&&J&&n.jsxs(Ja.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",bounce:.3},className:"space-y-6",children:[n.jsx(Ja.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.1},className:"w-28 h-28 mx-auto rounded-full bg-gradient-to-br from-green-400 to-green-500 flex items-center justify-center shadow-xl border-4 border-white",children:n.jsx(gn,{className:"h-14 w-14 text-white"})}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h2",{className:"text-xl font-serif text-green-800",children:"Prmio aplicado! "}),n.jsxs("div",{className:"p-4 bg-green-50 rounded-xl border border-green-200",children:[n.jsxs("p",{className:"text-green-800",children:[n.jsxs("strong",{children:["@",(pe=(ue=J.cart.live_customer)==null?void 0:ue.instagram_handle)==null?void 0:pe.replace(/^@/,"")]})," ","ganhou"," ",n.jsx("strong",{children:J.gift.name})]}),n.jsx("p",{className:"text-sm text-green-600 mt-1",children:"O brinde foi adicionado ao carrinho e aparecer na separao"})]})]}),n.jsxs(he,{onClick:Z,className:"gap-2 px-8 bg-green-600 hover:bg-green-700 text-white shadow-lg",size:"lg",children:[n.jsx(gn,{className:"h-4 w-4"}),"Fechar"]})]},"done")]})})]})})})]})}function KX({history:e,isLoading:t}){const r=i=>Wt(new Date(i),"dd/MM 's' HH:mm",{locale:mr}),s=i=>({aberto:{label:"Aberto",color:"bg-blue-100 text-blue-700",icon:Ri},em_confirmacao:{label:"Confirmando",color:"bg-amber-100 text-amber-700",icon:Lr},aguardando_pagamento:{label:"Aguardando",color:"bg-orange-100 text-orange-700",icon:Lr},pago:{label:"Pago",color:"bg-green-100 text-green-700",icon:Sr},cancelado:{label:"Cancelado",color:"bg-red-100 text-red-700",icon:Kn},expirado:{label:"Expirado",color:"bg-gray-100 text-gray-600",icon:Lr}})[i]||{label:i,color:"bg-gray-100 text-gray-600",icon:Gb},a=i=>{if(!i)return ms;const o=i.toLowerCase();return o.includes("dinheiro")?Wne:o.includes("loja")?fa:(o.includes("pix"),ms)};return t?n.jsx("div",{className:"flex items-center justify-center py-4",children:n.jsx(Et,{className:"h-5 w-5 animate-spin text-muted-foreground"})}):e.length===0?null:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[n.jsx(Gb,{className:"h-4 w-4"}),"Histrico de Status"]}),n.jsx("div",{className:"space-y-2",children:e.map((i,o)=>{const l=s(i.new_status),d=i.old_status?s(i.old_status):null,c=a(i.payment_method);return n.jsxs("div",{className:"flex items-start gap-3 p-2.5 rounded-lg bg-muted/50 text-sm",children:[n.jsxs("div",{className:"flex flex-col items-center shrink-0",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${i.new_status==="pago"?"bg-green-500":i.new_status==="cancelado"?"bg-red-500":"bg-primary"}`}),o<e.length-1&&n.jsx("div",{className:"w-0.5 h-full bg-border mt-1"})]}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[d&&n.jsxs(n.Fragment,{children:[n.jsx(ke,{variant:"outline",className:`${d.color} text-xs`,children:d.label}),n.jsx(hs,{className:"h-3 w-3 text-muted-foreground"})]}),n.jsx(ke,{variant:"outline",className:`${l.color} text-xs`,children:l.label}),i.payment_method&&n.jsxs("span",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[n.jsx(c,{className:"h-3 w-3"}),i.payment_method]})]}),i.notes&&n.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 truncate",children:i.notes}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r(i.created_at)})]})]},i.id)})})]})}function XX(e){const[t,r]=P.useState([]),[s,a]=P.useState(!0),[i,o]=P.useState({status:"all",priority:"all",type:"all",liveEventId:e||"",search:"",assignedTo:""}),l=P.useCallback(async()=>{a(!0);let g=le.from("live_pendencias").select(`
        *,
        live_cart:live_carts(
          bag_number,
          total,
          live_customer:live_customers(instagram_handle, nome)
        ),
        live_event:live_events(titulo)
      `).order("created_at",{ascending:!1});i.liveEventId&&(g=g.eq("live_event_id",i.liveEventId)),i.status!=="all"&&(g=g.eq("status",i.status)),i.priority!=="all"&&(g=g.eq("priority",i.priority)),i.type!=="all"&&(g=g.eq("type",i.type)),i.assignedTo&&(g=g.eq("assigned_to",i.assignedTo));const{data:x,error:v}=await g;if(v){console.error("Error fetching pendencias:",v),de.error("Erro ao carregar pendncias");return}let y=x||[];if(i.search){const b=i.search.toLowerCase();y=y.filter(j=>{var T,O,R,D,B,q,Y,G,I,F;return((T=j.title)==null?void 0:T.toLowerCase().includes(b))||((O=j.description)==null?void 0:O.toLowerCase().includes(b))||((B=(D=(R=j.live_cart)==null?void 0:R.live_customer)==null?void 0:D.instagram_handle)==null?void 0:B.toLowerCase().includes(b))||((G=(Y=(q=j.live_cart)==null?void 0:q.live_customer)==null?void 0:Y.nome)==null?void 0:G.toLowerCase().includes(b))||((F=(I=j.live_cart)==null?void 0:I.bag_number)==null?void 0:F.toString().includes(b))})}r(y),a(!1)},[i]);P.useEffect(()=>{l()},[l]);const d=async g=>{const{data:x}=await le.from("live_pendencias").select("id").eq("live_cart_id",g.live_cart_id).eq("type",g.type||"observacao_cliente").maybeSingle();if(x){const{error:v}=await le.from("live_pendencias").update({title:g.title,description:g.description,priority:g.priority||"media",updated_at:new Date().toISOString()}).eq("id",x.id);return v?(de.error("Erro ao atualizar pendncia"),null):(de.success("Pendncia atualizada!"),l(),x.id)}else{const{data:v,error:y}=await le.from("live_pendencias").insert({live_cart_id:g.live_cart_id,live_event_id:g.live_event_id,live_customer_id:g.live_customer_id,type:g.type||"observacao_cliente",title:g.title,description:g.description,priority:g.priority||"media",status:"aberta"}).select("id").single();return y?(console.error("Error creating pendencia:",y),de.error("Erro ao criar pendncia"),null):(de.success("Pendncia criada!"),l(),v.id)}},c=async(g,x)=>{const v={status:x};x==="resolvida"&&(v.resolved_at=new Date().toISOString());const{error:y}=await le.from("live_pendencias").update(v).eq("id",g);return y?(de.error("Erro ao atualizar status"),!1):(de.success(`Status atualizado para ${x}`),l(),!0)},u=async(g,x)=>{const{error:v}=await le.from("live_pendencias").update({assigned_to:x}).eq("id",g);return v?(de.error("Erro ao atribuir responsvel"),!1):(de.success("Responsvel atribudo!"),l(),!0)},h=async(g,x)=>{const{error:v}=await le.from("live_pendencias").update({due_date:x}).eq("id",g);return v?(de.error("Erro ao definir prazo"),!1):(de.success("Prazo definido!"),l(),!0)},f=async g=>{const{data:x,error:v}=await le.from("live_pendencias").select("*").eq("live_cart_id",g).maybeSingle();return v?(console.error("Error fetching pendencia:",v),null):x},m=t.filter(g=>g.status==="aberta").length,p=t.filter(g=>g.status==="em_andamento").length;return{pendencias:t,isLoading:s,filters:i,setFilters:o,fetchPendencias:l,upsertPendencia:d,updateStatus:c,assignTo:u,setDueDate:h,getPendenciaForCart:f,countOpen:m,countInProgress:p}}function ECe({cart:e,onClose:t,onRemoveItem:r,onReduceQuantity:s,onCancelCart:a,products:i,onWaitlistOffer:o,cartHistory:l,historyLoading:d}){var S;const[c,u]=P.useState((e==null?void 0:e.customer_live_notes)||""),[h,f]=P.useState(!1),[m,p]=P.useState(!1),[g,x]=P.useState(!1),[v,y]=P.useState(null),{upsertPendencia:b,getPendenciaForCart:j}=XX();P.useEffect(()=>{e&&(u(e.customer_live_notes||""),j(e.id).then(y))},[e==null?void 0:e.id,e==null?void 0:e.customer_live_notes]);const T=E=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(E),O=async()=>{if(!e)return;f(!0);const{error:E}=await le.from("live_carts").update({customer_live_notes:c}).eq("id",e.id);f(!1),E?de.error("Erro ao salvar observaes"):de.success("Observaes salvas!")},R=async()=>{var M;if(!e)return;p(!0);const{error:E}=await le.from("live_carts").update({customer_live_notes:c}).eq("id",e.id);if(E){de.error("Erro ao salvar observaes"),p(!1);return}const N=e.bag_number?`#${String(e.bag_number).padStart(3,"0")}`:"",C=((M=e.live_customer)==null?void 0:M.instagram_handle)||"cliente";await b({live_cart_id:e.id,live_event_id:e.live_event_id,live_customer_id:e.live_customer_id,type:"observacao_cliente",title:`Observao ${N} @${C}`,description:c,priority:"media"});const k=await j(e.id);y(k),p(!1)},D=async()=>{e&&confirm("Tem certeza que deseja cancelar este carrinho?")&&(x(!0),await a(e.id),x(!1),t())};if(!e)return null;const B=(e.items||[]).filter(E=>["reservado","confirmado","expirado"].includes(E.status)),q=(e.items||[]).filter(E=>E.status==="cancelado"),Y=e.bag_number,G=e.needs_label_reprint,I=e.status!=="pago"&&e.status!=="cancelado",F=()=>{if(!v)return null;switch(v.status){case"aberta":return n.jsxs(ke,{variant:"outline",className:"border-amber-300 bg-amber-50 text-amber-700 text-xs",children:[n.jsx(Lr,{className:"h-3 w-3 mr-1"}),"Pendncia Aberta"]});case"em_andamento":return n.jsxs(ke,{variant:"outline",className:"border-blue-300 bg-blue-50 text-blue-700 text-xs",children:[n.jsx(Sn,{className:"h-3 w-3 mr-1"}),"Em Andamento"]});case"resolvida":return n.jsxs(ke,{variant:"outline",className:"border-green-300 bg-green-50 text-green-700 text-xs",children:[n.jsx(Sr,{className:"h-3 w-3 mr-1"}),"Resolvida"]})}};return n.jsx(tn,{open:!!e,onOpenChange:()=>t(),children:n.jsxs(Jr,{className:"w-[95vw] max-w-lg max-h-[85vh] flex flex-col p-0 gap-0",children:[n.jsx(ln,{className:"px-4 sm:px-6 pt-4 sm:pt-6 pb-3 border-b shrink-0",children:n.jsxs(rn,{className:"flex items-center gap-2 flex-wrap text-base sm:text-lg",children:[n.jsxs("span",{className:"truncate",children:["Carrinho de ",(S=e.live_customer)==null?void 0:S.instagram_handle]}),e.is_raffle_winner&&n.jsxs(ke,{className:"bg-amber-500 text-white gap-1 shrink-0 text-xs",children:[n.jsx(ma,{className:"h-3 w-3"}),"Ganhadora"]}),G&&n.jsxs(ke,{variant:"outline",className:"gap-1 text-amber-600 border-amber-300 shrink-0 text-xs",children:[n.jsx(Gv,{className:"h-3 w-3"}),"Reimprimir"]})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 min-h-0",children:n.jsxs("div",{className:"space-y-4",children:[Y&&I&&n.jsx("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(Sn,{className:"h-4 w-4 text-amber-600 shrink-0 mt-0.5"}),n.jsxs("div",{className:"min-w-0",children:[n.jsxs("span",{className:"text-sm font-medium text-amber-800",children:["Sacola #",String(Y).padStart(3,"0")," j tem etiqueta"]}),n.jsx("p",{className:"text-xs text-amber-600 mt-0.5",children:"Se modificar itens, reimprima a etiqueta."})]})]})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{className:"text-sm text-muted-foreground",children:"Itens do pedido:"}),B.map(E=>{var N,C,k;return n.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-muted/30 rounded-lg",children:[n.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-secondary rounded overflow-hidden shrink-0",children:(N=E.product)!=null&&N.image_url?n.jsx("img",{src:E.product.image_url,alt:E.product.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:(C=E.product)==null?void 0:C.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Tam: ",(k=E.variante)==null?void 0:k.tamanho,"  Qtd: ",E.qtd]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("div",{className:"font-medium text-sm",children:T(E.preco_unitario*E.qtd)}),I&&n.jsxs("div",{className:"flex gap-1 justify-end mt-1",children:[E.qtd>1&&n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsx(he,{variant:"ghost",size:"sm",className:"text-muted-foreground h-7 w-7 p-0 hover:text-foreground",onClick:()=>s(E.id),children:n.jsx(op,{className:"h-3 w-3"})})}),n.jsx(Sa,{children:"Remover 1 unidade"})]}),n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsx(he,{variant:"ghost",size:"sm",className:"text-muted-foreground h-7 w-7 p-0 hover:text-foreground",onClick:async()=>{const M=await r(E.id);if(M.success&&M.waitlistEntry){const U=i.find($=>$.product_id===M.productId);U&&o(M.waitlistEntry,U)}},children:n.jsx(sn,{className:"h-3 w-3"})})}),n.jsx(Sa,{children:E.qtd>1?`Remover todas ${E.qtd} unidades`:"Remover (devolve ao estoque)"})]})]})]})]},E.id)}),q.length>0&&n.jsxs("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Sn,{className:"h-4 w-4 text-amber-600"}),n.jsx("span",{className:"text-sm font-medium text-amber-800",children:"Itens cancelados - retirar da sacola"})]}),q.map(E=>{var N,C,k;return n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-amber-100/50 rounded mt-1",children:[n.jsx("div",{className:"w-8 h-8 bg-secondary rounded overflow-hidden shrink-0 opacity-60",children:(N=E.product)!=null&&N.image_url?n.jsx("img",{src:E.product.image_url,alt:E.product.name,className:"w-full h-full object-cover"}):n.jsx(Vt,{className:"h-3 w-3 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm text-amber-800 truncate line-through",children:(C=E.product)==null?void 0:C.name}),n.jsxs("div",{className:"text-xs text-amber-600",children:["Tam: ",(k=E.variante)==null?void 0:k.tamanho,"  Qtd: ",E.qtd]})]}),n.jsx(ke,{variant:"outline",className:"bg-amber-100 text-amber-700 border-amber-300 text-xs shrink-0",children:"Retirar"})]},E.id)})]})]}),n.jsxs("div",{className:"flex justify-between items-center p-3 bg-primary/10 rounded-lg",children:[n.jsx("span",{className:"font-medium",children:"Total"}),n.jsx("span",{className:"text-xl font-bold",children:T(B.reduce((E,N)=>E+N.preco_unitario*N.qtd,0))})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg flex-wrap gap-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Status atual:"}),n.jsxs(ke,{className:e.status==="pago"?"bg-green-100 text-green-700":e.status==="cancelado"?"bg-red-100 text-red-700":["aguardando_pagamento","em_confirmacao","expirado"].includes(e.status)?"bg-amber-100 text-amber-700":"bg-blue-100 text-blue-700",children:[e.status==="pago"&&" Pago",e.status==="aberto"&&" Aberto",e.status==="aguardando_pagamento"&&" Aguardando pagamento",e.status==="cancelado"&&" Cancelado",e.status==="expirado"&&" Aguardando pagamento",e.status==="em_confirmacao"&&" Confirmando"]})]}),l.length>0&&n.jsx(KX,{history:l,isLoading:d}),n.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Be,{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(Wb,{className:"h-4 w-4"}),"Observaes da Cliente"]}),F()]}),n.jsx(rs,{placeholder:"Ex: blusa branca  presente  look viagem",value:c,onChange:E=>u(E.target.value),className:"min-h-[60px] text-sm resize-none",style:{height:"auto",minHeight:"60px"},onInput:E=>{const N=E.target;N.style.height="auto",N.style.height=`${Math.min(N.scrollHeight,150)}px`}})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsx(he,{variant:"default",className:"flex-1 h-11",onClick:R,disabled:m||!c.trim(),children:m?"Salvando...":v?"Atualizar Pendncia":"Salvar e Criar Pendncia"}),n.jsx(he,{variant:"outline",className:"flex-1 h-11",onClick:O,disabled:h,children:h?"Salvando...":"Salvar apenas no pedido"})]}),(e==null?void 0:e.is_raffle_winner)&&n.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg border border-amber-200",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ma,{className:"h-4 w-4 text-amber-600"}),n.jsx("span",{className:"text-sm font-medium text-amber-800",children:"Ganhadora de Sorteio"})]}),e.raffle_name&&n.jsx("p",{className:"text-xs text-amber-700 mt-1",children:e.raffle_name}),e.raffle_prize&&n.jsxs("p",{className:"text-xs text-amber-600 mt-0.5",children:[" ",e.raffle_prize]})]})]}),I&&n.jsxs(he,{variant:"outline",className:"w-full gap-1 text-destructive border-destructive/20 hover:bg-destructive/10 h-11",disabled:g,onClick:D,children:[n.jsx(Kn,{className:"h-4 w-4"}),"Cancelar Carrinho"]})]})})]})})}function kCe(){var _r,wr,jr;const{eventId:e}=ta(),t=pr(),{event:r,products:s,kpis:a,isLoading:i,fetchEvent:o}=B_(e),{updateEventStatus:l}=L_(),[d,c]=P.useState(!1),{customers:u,carts:h,waitlist:f,isLoading:m,quickLaunch:p,removeCartItem:g,reduceItemQuantity:x,cancelItemForSeparation:v,addToWaitlist:y,allocateFromWaitlist:b,skipWaitlistEntry:j,endWaitlistQueue:T,getWaitlistCount:O,getNextWaitlistEntry:R,checkCustomerHasProduct:D,fetchBackstageData:B,generatePaymentLink:q,updateCartStatus:Y,fetchCartStatusHistory:G}=gCe(e,d),[I,F]=P.useState(""),[S,E]=P.useState(""),[N,C]=P.useState(""),[k,M]=P.useState(""),[U,$]=P.useState(1),[X,Z]=P.useState(""),[re,W]=P.useState(""),[J,V]=P.useState("all"),[H,ee]=P.useState(!1),[ie,oe]=P.useState(!1),[se,ue]=P.useState(null),[pe,ce]=P.useState(null),[ne,me]=P.useState(null),[ge,_e]=P.useState(null),[be,ye]=P.useState(!1),[Oe,Ne]=P.useState(null),[De,Ge]=P.useState(!1),[Qe,Ie]=P.useState("lancador");P.useState(null);const[Ae,st]=P.useState(!1);P.useState(!1);const[nt,vt]=P.useState(null),[Je,Ue]=P.useState([]),[Le,Ze]=P.useState(!1),[ct,ht]=P.useState({}),yt=P.useMemo(()=>{const rt=h.filter(Qt=>Qt.status!=="cancelado"),Ot=new Set;let rr=0,nr=0;return rt.forEach(Qt=>{const Ce=Qt.items||[];let Xe=!1;Ce.forEach(ft=>{["reservado","confirmado"].includes(ft.status)&&(rr+=ft.qtd,nr+=ft.preco_unitario*ft.qtd,Xe=!0)}),Xe&&Ot.add(Qt.live_customer_id)}),{totalItems:rr,totalCustomers:Ot.size,totalValue:nr}},[h]);P.useEffect(()=>{const rt={};h.forEach(Ot=>{(Ot.items||[]).forEach(rr=>{var nr;if(["reservado","confirmado"].includes(rr.status)){const Qt=rr.product_id,Ce=((nr=rr.variante)==null?void 0:nr.tamanho)||"";rt[Qt]||(rt[Qt]={}),rt[Qt][Ce]=(rt[Qt][Ce]||0)+rr.qtd}})}),ht(rt)},[h]),P.useEffect(()=>{if(se){const rt=h.find(Ot=>Ot.id===se.id);rt&&JSON.stringify(rt)!==JSON.stringify(se)&&ue(rt)}},[h,se]),P.useEffect(()=>{se?(Ze(!0),G(se.id).then(rt=>{Ue(rt),Ze(!1)})):Ue([])},[se==null?void 0:se.id]);const Re=rt=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(rt),Ke=(rt,Ot,rr)=>Math.max(0,rr),_t=async()=>{if(!I.trim()||!S||!N){de.error("Preencha todos os campos obrigatrios");return}if(Ae){console.log("[handleQuickLaunch] Already in progress, ignoring duplicate click");return}st(!0),console.log("[handleQuickLaunch] Starting - button disabled");try{const rt=await p({instagram_handle:I.trim(),product_id:S,cor:k||void 0,tamanho:N,qtd:U});console.log("[handleQuickLaunch] RPC returned, success:",rt),rt&&(F(""),C(""),$(1),o())}finally{st(!1),console.log("[handleQuickLaunch] Complete - button re-enabled")}},Rt=async()=>{r&&confirm("Tem certeza que deseja encerrar a live?")&&(await l(r.id,"encerrada"),t(`/dashboard/lives/${r.id}/relatorio`))},Se=async rt=>pe?await y(pe.productId,{cor:pe.productColor,tamanho:pe.size},rt.instagram,rt.whatsapp,rt.nome,rt.observacao):!1,tt=async rt=>await b(rt),ot=async rt=>{await j(rt);const Ot=f.find(rr=>rr.id!==rt&&rr.status==="ativa");if(Ot){const rr=s.find(nr=>nr.product_id===Ot.product_id);me({waitlistItem:Ot,product:rr||null})}else me(null)},lt=async(rt,Ot)=>{await T(rt,Ot),_e(null)},At=(rt,Ot)=>f.filter(rr=>{var nr;return rr.product_id===rt&&((nr=rr.variante)==null?void 0:nr.tamanho)===Ot}),Nt=(rt,Ot)=>{me({waitlistItem:rt,product:Ot})},ut=s.find(rt=>rt.product_id===S),lr=s.filter(rt=>{var rr;if(!X)return!0;const Ot=rt.product;return Ot?Ot.name.toLowerCase().includes(X.toLowerCase())||((rr=Ot.sku)==null?void 0:rr.toLowerCase().includes(X.toLowerCase())):!1}),Pt=h.filter(rt=>{var Qt,Ce,Xe,ft;const Ot=!re||((Qt=rt.live_customer)==null?void 0:Qt.instagram_handle.toLowerCase().includes(re.toLowerCase()))||((Xe=(Ce=rt.live_customer)==null?void 0:Ce.nome)==null?void 0:Xe.toLowerCase().includes(re.toLowerCase())),rr=!!((ft=rt.live_customer)!=null&&ft.client_id);return Ot&&(J==="all"||J==="registered"&&rr||J==="new"&&!rr)}),Pe=h.filter(rt=>{var Ot;return(Ot=rt.live_customer)==null?void 0:Ot.client_id}).length,Me=h.filter(rt=>{var Ot;return!((Ot=rt.live_customer)!=null&&Ot.client_id)}).length,it=i||m,gt=rt=>{const Ot=rt.product;if(!Ot)return null;const rr=Ot.stock_by_size||{},nr=Ot.available_by_size||{},Qt=gp(Object.keys(rr)),Ce=Qt.reduce((Zt,wt)=>Zt+O(rt.product_id,wt),0),Xe=Qt.some(Zt=>{const wt=Math.max(0,nr[Zt]||0),kt=O(rt.product_id,Zt);return wt>0&&kt>0}),ze=Qt.reduce((Zt,wt)=>Zt+Math.max(0,nr[wt]||0),0)===0;return n.jsxs("div",{className:`p-3 rounded-lg border transition-colors cursor-pointer ${S===rt.product_id?"border-primary bg-primary/5":Xe?"border-amber-300 bg-amber-50/50":ze?"opacity-60 hover:opacity-100":"hover:bg-muted/50"}`,onClick:()=>{E(rt.product_id),M(Ot.color||""),C(""),Ie("lancador")},children:[n.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[n.jsxs("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-secondary rounded overflow-hidden shrink-0 relative",children:[Ot.image_url?n.jsx("img",{src:Ot.image_url,alt:Ot.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})}),ze&&n.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:n.jsx("span",{className:"text-[8px] sm:text-[10px] font-bold text-white",children:"ESGOTADO"})})]}),n.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[n.jsx("div",{className:"font-medium text-sm leading-tight truncate",children:Ot.name}),n.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[ym(rt.live_discount_type,rt.live_discount_value)?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-destructive font-medium",children:Re(X0(Ot.price,rt.live_discount_type,rt.live_discount_value))}),n.jsx("span",{className:"line-through ml-1 opacity-60",children:Re(Ot.price)})]}):Re(Ot.price),Ot.color&&n.jsxs("span",{className:"hidden sm:inline",children:["  ",Ot.color]})]}),n.jsxs("div",{className:"flex items-center gap-1 mt-1 flex-wrap",children:[ym(rt.live_discount_type,rt.live_discount_value)&&n.jsx(ke,{className:"text-[10px] px-1.5 py-0 h-4 bg-destructive text-destructive-foreground",children:RW(rt.live_discount_type,rt.live_discount_value)}),rt.visibilidade==="exclusivo_live"&&n.jsx(ke,{variant:"secondary",className:"text-[10px] px-1.5 py-0 h-4",children:"Exclusivo"})]})]}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0",onClick:Zt=>{Zt.stopPropagation(),Ne(rt)},children:n.jsx(Js,{className:"h-3.5 w-3.5"})})]}),n.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:Qt.map(Zt=>{const wt=Math.max(0,nr[Zt]||0),kt=wt<=0,Cr=O(rt.product_id,Zt),Jt=wt>0&&Cr>0;return n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsxs("button",{className:`px-2 py-0.5 rounded text-xs font-medium transition-colors ${Jt?"bg-amber-500 text-white animate-pulse":kt?"bg-destructive/10 text-destructive line-through":wt<=2?"bg-amber-100 text-amber-700":"bg-secondary text-foreground hover:bg-primary hover:text-primary-foreground"}`,onClick:tr=>{tr.stopPropagation(),Cr>0?_e({productId:rt.product_id,productName:Ot.name,productColor:Ot.color||void 0,size:Zt}):kt?ce({productId:rt.product_id,productName:Ot.name,productColor:Ot.color||void 0,size:Zt}):(E(rt.product_id),M(Ot.color||""),C(Zt),Ie("lancador"))},children:[Zt,Cr>0&&n.jsxs("span",{className:"ml-1",children:["(",Cr,")"]})]})}),n.jsx(Sa,{children:Jt?` Estoque liberado! ${Cr} na fila`:Cr>0?`Esgotado - ${Cr} na lista de espera`:kt?"Esgotado - Clique para lista de espera":`${wt} disponveis`})]},Zt)})}),Ce>0&&n.jsxs("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-dashed",children:[n.jsxs("div",{className:"flex items-center gap-1 text-xs text-amber-700",children:[n.jsx(Oi,{className:"h-3 w-3"}),n.jsxs("span",{children:[Ce," na lista de espera"]})]}),Xe&&n.jsx(ke,{className:"bg-amber-500 text-white text-xs animate-pulse",children:"Estoque liberado!"})]})]},rt.id)},dt=()=>n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"@ do Instagram *"}),n.jsx(et,{placeholder:"@cliente",value:I,onChange:rt=>F(rt.target.value),onKeyDown:rt=>{rt.key==="Enter"&&I.trim()&&S&&N&&(rt.preventDefault(),_t())},className:"text-lg"})]}),ut!=null&&ut.product?n.jsx("div",{className:"p-3 bg-muted/50 rounded-lg",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:ut.product.image_url?n.jsx("img",{src:ut.product.image_url,alt:ut.product.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-sm",children:ut.product.name}),n.jsx("div",{className:"text-xs text-muted-foreground",children:ym(ut.live_discount_type,ut.live_discount_value)?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-destructive font-medium",children:Re(X0(ut.product.price,ut.live_discount_type,ut.live_discount_value))}),n.jsx("span",{className:"line-through ml-1 opacity-60",children:Re(ut.product.price)})]}):Re(ut.product.price)})]})]})}):n.jsxs("div",{className:"p-4 border-2 border-dashed rounded-lg text-center text-muted-foreground",children:[n.jsx(Vt,{className:"h-6 w-6 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm",children:"Selecione um produto na aba Produtos"})]}),(ut==null?void 0:ut.product)&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Tamanho *"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{const rt=ut.product.stock_by_size||{},Ot=ut.product.available_by_size||{},rr=gp(Object.keys(rt));return rr.length===0?n.jsx("p",{className:"text-sm text-muted-foreground italic",children:"Nenhum tamanho cadastrado"}):rr.map(nr=>{const Qt=Math.max(0,Ot[nr]||0),Ce=N===nr,Xe=Qt<=0,ft=O(ut.product_id,nr),ze=Qt>0&&ft>0;return n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsxs("button",{className:`px-4 py-2 rounded-lg border text-sm font-medium transition-colors ${ze?"bg-amber-500 text-white border-amber-500 animate-pulse":Xe?"bg-muted text-muted-foreground line-through cursor-pointer hover:bg-destructive/10 hover:text-destructive hover:no-underline":Ce?"bg-primary text-primary-foreground border-primary":"hover:bg-muted"}`,onClick:()=>{ft>0?_e({productId:ut.product_id,productName:ut.product.name,productColor:ut.product.color||void 0,size:nr}):Xe?ce({productId:ut.product_id,productName:ut.product.name,productColor:ut.product.color||void 0,size:nr}):C(nr)},children:[nr,ft>0?n.jsxs("span",{className:"ml-1 text-xs",children:["(",ft," fila)"]}):Xe?n.jsx("span",{className:"ml-1 text-xs",children:"(esgotado)"}):n.jsxs("span",{className:"ml-1 text-xs opacity-70",children:["(",Qt,")"]})]})}),n.jsx(Sa,{children:ze?` Estoque liberado! ${ft} na fila - clique para gerenciar`:ft>0?`${ft} na lista de espera - clique para gerenciar`:Xe?"Esgotado - Clique para adicionar  lista de espera":`${Qt} disponveis`})]},nr)})})()})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Quantidade"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(he,{variant:"outline",size:"icon",onClick:()=>$(rt=>Math.max(1,rt-1)),children:n.jsx(op,{className:"h-4 w-4"})}),n.jsx("span",{className:"text-xl font-semibold w-12 text-center",children:U}),n.jsx(he,{variant:"outline",size:"icon",onClick:()=>$(rt=>rt+1),children:n.jsx(kn,{className:"h-4 w-4"})})]})]}),(ut==null?void 0:ut.product)&&N&&n.jsxs("div",{className:"p-4 bg-primary/10 rounded-lg text-center",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"}),n.jsx("div",{className:"text-2xl font-bold text-primary",children:Re(X0(ut.product.price,ut.live_discount_type,ut.live_discount_value)*U)}),ym(ut.live_discount_type,ut.live_discount_value)&&n.jsx("div",{className:"text-xs text-muted-foreground line-through mt-1",children:Re(ut.product.price*U)})]}),n.jsx(he,{className:"w-full h-12 text-lg gap-2",onClick:_t,disabled:!I.trim()||!S||!N||Ae,children:Ae?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-5 w-5 animate-spin"}),"Adicionando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(kn,{className:"h-5 w-5"}),"Adicionar ao Carrinho"]})})]}),It=rt=>{const Ot=window.location.origin,rr=h.find(Qt=>Qt.id===rt),nr=rr==null?void 0:rr.public_token;return nr?`${Ot}/live-checkout/${rt}?token=${nr}`:`${Ot}/live-checkout/${rt}`},xr=rt=>{var Ce,Xe;const Ot=(rt.items||[]).filter(ft=>["reservado","confirmado"].includes(ft.status)),rr=((Ce=rt.live_customer)==null?void 0:Ce.nome)||((Xe=rt.live_customer)==null?void 0:Xe.instagram_handle)||"",nr=It(rt.id);let Qt=`Oi${rr?` ${rr.split(" ")[0]}`:""}! 

`;return Qt+=`Separei seus itens da live pra voc 

`,Ot.forEach(ft=>{var wt,kt,Cr,Jt;const ze=((wt=ft.variante)==null?void 0:wt.tamanho)||"",Zt=((kt=ft.variante)==null?void 0:kt.cor)||((Cr=ft.product)==null?void 0:Cr.color)||"";Qt+=` ${((Jt=ft.product)==null?void 0:Jt.name)||"Produto"}`,ze&&(Qt+=` - Tam: ${ze}`),Zt&&(Qt+=` (${Zt})`),Qt+=` - ${Re(ft.preco_unitario)}
`}),Qt+=`
 Total: ${Re(rt.total)}

`,Qt+=`Finalize seu pedido por aqui:
${nr}

`,Qt+="Qualquer ajuste me chama aqui ",Qt},sr=(rt,Ot)=>{var Qt,Ce;Ot&&Ot.stopPropagation();const rr=((Ce=(Qt=rt.live_customer)==null?void 0:Qt.whatsapp)==null?void 0:Ce.replace(/\D/g,""))||"",nr=xr(rt);if(rr){const Xe=`https://wa.me/${rr}?text=${encodeURIComponent(nr)}`;window.open(Xe,"_blank")}else navigator.clipboard.writeText(nr),de.success("Mensagem copiada! Envie pelo Instagram DM.")},ir=rt=>{const Ot=rt.live_customer,rr=rt.items||[],nr=rr.filter(kt=>["reservado","confirmado","expirado"].includes(kt.status)),Qt=nr.reduce((kt,Cr)=>kt+Cr.preco_unitario*Cr.qtd,0),Ce={aberto:{label:"Aberto",color:"bg-blue-100 text-blue-700"},em_confirmacao:{label:"Confirmando",color:"bg-amber-100 text-amber-700"},aguardando_pagamento:{label:"Aguardando",color:"bg-orange-100 text-orange-700"},pago:{label:"Pago",color:"bg-green-100 text-green-700"},cancelado:{label:"Cancelado",color:"bg-red-100 text-red-700"},expirado:{label:"Aguardando pagamento",color:"bg-amber-100 text-amber-700"}},Xe=Ce[rt.status]||Ce.aberto,ft=rt.bag_number,ze=rr.some(kt=>kt.status==="cancelado"),Zt=rt.is_raffle_winner,wt=rt.needs_label_reprint;return n.jsxs("div",{className:`p-3 rounded-lg border hover:bg-muted/30 transition-colors cursor-pointer ${ze?"border-amber-300 bg-amber-50/30":""}`,onClick:()=>ue(rt),children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[ft&&n.jsxs(ke,{variant:"outline",className:"text-xs px-1.5 py-0 font-mono shrink-0",children:["#",String(ft).padStart(3,"0")]}),n.jsx("span",{className:"font-medium text-lg truncate",children:Ot==null?void 0:Ot.instagram_handle}),Ot!=null&&Ot.client_id?n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsx("div",{className:"w-5 h-5 rounded-full bg-green-100 flex items-center justify-center shrink-0",children:n.jsx(gn,{className:"h-3 w-3 text-green-600"})})}),n.jsx(Sa,{children:"Cliente cadastrado no CRM"})]}):n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsx("div",{className:"w-5 h-5 rounded-full bg-amber-100 flex items-center justify-center shrink-0",children:n.jsx(Dn,{className:"h-3 w-3 text-amber-600"})})}),n.jsx(Sa,{children:"Novo cliente (sem cadastro)"})]}),Zt&&n.jsxs(ke,{className:"bg-amber-500 text-white text-xs gap-1",children:[n.jsx(ma,{className:"h-3 w-3"}),"Ganhadora"]})]}),(Ot==null?void 0:Ot.nome)&&n.jsx("div",{className:"text-xs text-muted-foreground truncate",children:Ot.nome})]}),n.jsxs("div",{className:"flex flex-col items-end gap-1 shrink-0 ml-2",children:[n.jsx(ke,{className:Xe.color,children:Xe.label}),ze&&n.jsxs(ke,{variant:"outline",className:"text-xs bg-amber-100 text-amber-700 border-amber-300",children:[n.jsx(Sn,{className:"h-3 w-3 mr-1"}),"Retirar item"]}),wt&&n.jsx(ke,{variant:"outline",className:"text-xs text-orange-600 border-orange-300",children:"Reimprimir"})]})]}),n.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[nr.length," ",nr.length===1?"item":"itens"]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsx("span",{className:"font-semibold",children:Re(Qt)})})]},rt.id)};return it||!r?n.jsx("div",{className:"h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ss,{className:"h-12 w-12 animate-pulse text-primary mx-auto mb-4"}),n.jsx("p",{className:"text-muted-foreground",children:"Carregando backstage..."})]})}):n.jsxs("div",{className:"h-screen flex flex-col bg-background",children:[n.jsxs("header",{className:"border-b bg-card px-2 sm:px-4 py-2 sm:py-3 shrink-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(he,{variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0",onClick:()=>t("/dashboard?tab=lives"),children:n.jsx(Ts,{className:"h-4 w-4"})}),n.jsxs(ke,{variant:"destructive",className:"gap-1 animate-pulse shrink-0",children:[n.jsx(Ss,{className:"h-3 w-3"}),n.jsx("span",{className:"hidden sm:inline",children:"AO VIVO"})]}),n.jsx("h1",{className:"font-medium text-sm sm:text-base truncate",children:r.titulo}),n.jsxs("div",{className:"hidden sm:flex items-center gap-3 text-sm ml-auto",children:[n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"font-medium",children:yt.totalItems})]})}),n.jsx(Sa,{children:"Peas vendidas na live"})]}),n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ha,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"font-medium",children:yt.totalCustomers})]})}),n.jsx(Sa,{children:"Clientes comprando"})]}),n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsxs("div",{className:"flex items-center gap-1 text-green-600 font-medium",children:[n.jsx(ks,{className:"h-4 w-4"}),n.jsx("span",{children:Re(yt.totalValue)})]})}),n.jsx(Sa,{children:"Valor total de vendas"})]})]})]}),n.jsxs("div",{className:"flex sm:hidden items-center gap-3 text-xs mb-2 px-1",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Vt,{className:"h-3.5 w-3.5 text-muted-foreground"}),n.jsx("span",{className:"font-medium",children:yt.totalItems})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ha,{className:"h-3.5 w-3.5 text-muted-foreground"}),n.jsx("span",{className:"font-medium",children:yt.totalCustomers})]}),n.jsxs("div",{className:"flex items-center gap-1 text-green-600 font-medium",children:[n.jsx(ks,{className:"h-3.5 w-3.5"}),n.jsx("span",{children:Re(yt.totalValue)})]})]}),n.jsxs("div",{className:"flex items-center gap-1.5 overflow-x-auto pb-1 -mx-2 px-2 sm:mx-0 sm:px-0",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 shrink-0",onClick:()=>oe(!0),children:[n.jsx(kn,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Produtos"})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 shrink-0",onClick:()=>t(`/dashboard/lives/${r.id}/separacao`),children:[n.jsx(Vt,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Separao"})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 shrink-0",onClick:()=>t(`/dashboard/lives/${r.id}/relatorio`),children:[n.jsx(fc,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Relatrio"})]}),f.filter(rt=>rt.status==="ativa").length>0&&n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 border-amber-300 bg-amber-50 text-amber-800 hover:bg-amber-100 relative shrink-0",onClick:()=>ye(!0),children:[n.jsx(Oi,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Fila"}),n.jsx(ke,{className:"bg-amber-500 text-white h-4 w-4 p-0 text-[10px] flex items-center justify-center rounded-full ml-0.5",children:f.filter(rt=>rt.status==="ativa").length})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 shrink-0",onClick:()=>ee(!0),children:[n.jsx(CS,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Quem?"})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 border-amber-300 bg-amber-50 text-amber-700 hover:bg-amber-100 shrink-0",onClick:()=>Ge(!0),children:[n.jsx(ma,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Sorteio"})]}),n.jsxs(he,{variant:"destructive",size:"sm",className:"gap-1 h-8 shrink-0",onClick:Rt,children:[n.jsx(iz,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Encerrar"})]})]})]}),n.jsxs("div",{className:"shrink-0 px-4 pt-4 space-y-2",children:[n.jsx(NCe,{entries:f,products:s,getAvailableStock:Ke,onOfferClick:Nt}),n.jsx(_Ce,{carts:h,onCartClick:rt=>ue(rt),onSendWhatsApp:sr})]}),n.jsx("div",{className:"flex-1 overflow-hidden lg:hidden",children:n.jsxs(Hi,{value:Qe,onValueChange:rt=>Ie(rt),className:"h-full flex flex-col",children:[n.jsxs(Si,{className:"shrink-0 mx-4 mt-2 grid grid-cols-4",children:[n.jsxs(br,{value:"produtos",className:"gap-1 text-xs",children:[n.jsx(Vt,{className:"h-3 w-3"}),"Produtos"]}),n.jsxs(br,{value:"lancador",className:"gap-1 text-xs",children:[n.jsx(kn,{className:"h-3 w-3"}),"Lanador"]}),n.jsxs(br,{value:"carrinhos",className:"gap-1 text-xs",children:[n.jsx(Ri,{className:"h-3 w-3"}),"Carrinhos"]}),n.jsxs(br,{value:"fila",className:"gap-1 text-xs relative",children:[n.jsx(Oi,{className:"h-3 w-3"}),"Fila",f.filter(rt=>rt.status==="ativa").length>0&&n.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-amber-500 text-white text-[10px] rounded-full flex items-center justify-center",children:f.filter(rt=>rt.status==="ativa").length})]})]}),n.jsx(kr,{value:"produtos",className:"flex-1 overflow-hidden m-0 p-4",children:n.jsxs($e,{className:"h-full flex flex-col",children:[n.jsxs(Dt,{className:"shrink-0 pb-3",children:[n.jsxs(Lt,{className:"text-base flex items-center gap-2",children:[n.jsx(Vt,{className:"h-4 w-4"}),"Produtos (",s.length,")"]}),n.jsxs("div",{className:"relative mt-2",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar produto...",value:X,onChange:rt=>Z(rt.target.value),className:"pl-10 h-9"})]})]}),n.jsx(Fe,{className:"flex-1 overflow-hidden p-0",children:n.jsx(gi,{className:"h-full",children:n.jsx("div",{className:"p-4 pt-0 space-y-2",children:lr.map(rt=>gt(rt))})})})]})}),n.jsx(kr,{value:"lancador",className:"flex-1 overflow-hidden m-0 p-4",children:n.jsxs($e,{className:"h-full flex flex-col",children:[n.jsx(Dt,{className:"shrink-0 pb-3",children:n.jsxs(Lt,{className:"text-base flex items-center gap-2",children:[n.jsx(kn,{className:"h-4 w-4"}),"Lanador Rpido"]})}),n.jsx(Fe,{className:"flex-1 overflow-auto",children:dt()})]})}),n.jsx(kr,{value:"carrinhos",className:"flex-1 overflow-hidden m-0 p-4",children:n.jsxs($e,{className:"h-full flex flex-col",children:[n.jsxs(Dt,{className:"shrink-0 pb-3",children:[n.jsxs(Lt,{className:"text-base flex items-center gap-2",children:[n.jsx(Ri,{className:"h-4 w-4"}),"Carrinhos (",h.length,")"]}),n.jsxs("div",{className:"relative mt-2",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar @instagram...",value:re,onChange:rt=>W(rt.target.value),className:"pl-10 h-9"})]}),n.jsxs("div",{className:"flex gap-1.5 mt-2",children:[n.jsxs("button",{onClick:()=>V("all"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors ${J==="all"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:["Todos (",h.length,")"]}),n.jsxs("button",{onClick:()=>V("registered"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors flex items-center gap-1 ${J==="registered"?"bg-green-600 text-white":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[n.jsx(gn,{className:"h-3 w-3"}),"Cadastrados (",Pe,")"]}),n.jsxs("button",{onClick:()=>V("new"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors flex items-center gap-1 ${J==="new"?"bg-amber-600 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"}`,children:[n.jsx(Dn,{className:"h-3 w-3"}),"Novos (",Me,")"]})]})]}),n.jsx(Fe,{className:"flex-1 overflow-hidden p-0",children:n.jsx(gi,{className:"h-full",children:n.jsxs("div",{className:"p-4 pt-0 space-y-2",children:[Pt.map(rt=>ir(rt)),Pt.length===0&&n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Ri,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm",children:"Nenhum carrinho ainda"})]})]})})})]})}),n.jsx(kr,{value:"fila",className:"flex-1 overflow-hidden m-0 p-4",children:n.jsxs($e,{className:"h-full flex flex-col",children:[n.jsx(Dt,{className:"shrink-0 pb-3",children:n.jsxs(Lt,{className:"text-base flex items-center gap-2",children:[n.jsx(Oi,{className:"h-4 w-4"}),"Lista de Espera",f.filter(rt=>rt.status==="ativa").length>0&&n.jsxs(ke,{variant:"secondary",className:"ml-auto",children:[f.filter(rt=>rt.status==="ativa").length," aguardando"]})]})}),n.jsx(Fe,{className:"flex-1 overflow-auto p-4 pt-0",children:n.jsx(M7,{waitlist:f,products:s,onAllocate:tt,onSkip:ot,onEndQueue:lt,getAvailableStock:Ke})})]})})]})}),n.jsxs("div",{className:"hidden lg:grid flex-1 grid-cols-3 gap-4 p-4 overflow-hidden",children:[n.jsxs($e,{className:"flex flex-col overflow-hidden",children:[n.jsxs(Dt,{className:"shrink-0 pb-3",children:[n.jsx(Lt,{className:"text-base flex items-center justify-between",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Vt,{className:"h-4 w-4"}),"Produtos (",s.length,")"]})}),n.jsxs("div",{className:"relative mt-2",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar produto...",value:X,onChange:rt=>Z(rt.target.value),className:"pl-10 h-9"})]})]}),n.jsx(Fe,{className:"flex-1 overflow-hidden p-0",children:n.jsx(gi,{className:"h-full",children:n.jsx("div",{className:"p-4 pt-0 space-y-2",children:lr.map(rt=>gt(rt))})})})]}),n.jsxs($e,{className:"flex flex-col overflow-hidden",children:[n.jsx(Dt,{className:"shrink-0 pb-3",children:n.jsxs(Lt,{className:"text-base flex items-center gap-2",children:[n.jsx(kn,{className:"h-4 w-4"}),"Lanador Rpido"]})}),n.jsx(Fe,{className:"flex-1 overflow-auto",children:dt()})]}),n.jsxs($e,{className:"flex flex-col overflow-hidden",children:[n.jsxs(Dt,{className:"shrink-0 pb-3",children:[n.jsx(Lt,{className:"text-base flex items-center justify-between",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Ri,{className:"h-4 w-4"}),"Carrinhos (",h.length,")"]})}),n.jsxs("div",{className:"relative mt-2",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar @instagram...",value:re,onChange:rt=>W(rt.target.value),className:"pl-10 h-9"})]}),n.jsxs("div",{className:"flex gap-1.5 mt-2",children:[n.jsxs("button",{onClick:()=>V("all"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors ${J==="all"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:["Todos (",h.length,")"]}),n.jsxs("button",{onClick:()=>V("registered"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors flex items-center gap-1 ${J==="registered"?"bg-green-600 text-white":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[n.jsx(gn,{className:"h-3 w-3"}),"Cadastrados (",Pe,")"]}),n.jsxs("button",{onClick:()=>V("new"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors flex items-center gap-1 ${J==="new"?"bg-amber-600 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"}`,children:[n.jsx(Dn,{className:"h-3 w-3"}),"Novos (",Me,")"]})]})]}),n.jsx(Fe,{className:"flex-1 overflow-hidden p-0",children:n.jsx(gi,{className:"h-full",children:n.jsxs("div",{className:"p-4 pt-0 space-y-2",children:[Pt.map(rt=>ir(rt)),Pt.length===0&&n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Ri,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm",children:"Nenhum carrinho ainda"})]})]})})})]})]}),n.jsx(xCe,{open:H,onOpenChange:ee,products:s,carts:h,waitlist:f,reservedStock:ct}),n.jsx(vCe,{open:ie,onOpenChange:oe,eventId:e||"",existingProductIds:s.map(rt=>rt.product_id),onProductsAdded:o}),pe&&n.jsx(bCe,{open:!!pe,onOpenChange:()=>ce(null),productId:pe.productId,productName:pe.productName,productColor:pe.productColor,size:pe.size,queueCount:O(pe.productId,pe.size),onSubmit:Se}),ne&&n.jsx(wCe,{open:!!ne,onOpenChange:()=>me(null),waitlistItem:ne.waitlistItem,product:ne.product,onOffer:tt,onSkip:ot,onEndQueue:lt}),ge&&n.jsx(jCe,{open:!!ge,onOpenChange:()=>_e(null),productName:ge.productName,productColor:ge.productColor,size:ge.size,entries:At(ge.productId,ge.size),hasStock:Ke(ge.productId,ge.size,((jr=(wr=(_r=s.find(rt=>rt.product_id===ge.productId))==null?void 0:_r.product)==null?void 0:wr.available_by_size)==null?void 0:jr[ge.size])||0)>0,onAllocate:tt,onSkip:ot,onEndQueue:()=>lt(ge.productId,ge.size),onAddToWaitlist:()=>{ce({productId:ge.productId,productName:ge.productName,productColor:ge.productColor,size:ge.size})}}),n.jsx(ECe,{cart:se,onClose:()=>ue(null),onRemoveItem:g,onReduceQuantity:x,onCancelCart:async rt=>{await Y(rt,"cancelado")},products:s,onWaitlistOffer:(rt,Ot)=>{me({waitlistItem:rt,product:Ot})},cartHistory:Je,historyLoading:Le}),n.jsx(_u,{open:be,onOpenChange:ye,children:n.jsxs(rd,{side:"right",className:"sm:max-w-2xl w-full",children:[n.jsx(ju,{children:n.jsxs(Zh,{className:"flex items-center gap-2",children:[n.jsx(Oi,{className:"h-5 w-5 text-amber-600"}),"Gerenciar Lista de Espera",f.filter(rt=>rt.status==="ativa").length>0&&n.jsxs(ke,{className:"bg-amber-500 text-white",children:[f.filter(rt=>rt.status==="ativa").length," aguardando"]})]})}),n.jsx(gi,{className:"h-[calc(100vh-120px)] mt-4",children:n.jsx(M7,{waitlist:f,products:s,onAllocate:tt,onSkip:ot,onEndQueue:lt,getAvailableStock:Ke})})]})}),n.jsx(_c,{open:!!nt,onOpenChange:()=>vt(null),children:n.jsxs(Tl,{children:[n.jsxs(Pl,{children:[n.jsx(Ol,{children:"Cancelar item do pedido?"}),n.jsxs(Rl,{children:["Voc est prestes a cancelar ",n.jsx("strong",{children:nt==null?void 0:nt.productName})," (Tam: ",nt==null?void 0:nt.size,").",n.jsx("br",{}),n.jsx("br",{}),"Este item ser marcado para ",n.jsx("strong",{children:"retirada fsica da sacola"})," durante a separao. O estoque ",n.jsx("strong",{children:"no ser devolvido automaticamente"}),"."]})]}),n.jsxs(jc,{children:[n.jsx(Sc,{children:"Voltar"}),n.jsx(Nc,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:async()=>{nt&&(await v(nt.itemId),vt(null),ue(null))},children:"Confirmar Cancelamento"})]})]})}),n.jsx(yCe,{open:!!Oe,onOpenChange:rt=>!rt&&Ne(null),liveProduct:Oe,onProductUpdated:o}),n.jsx(_u,{open:De,onOpenChange:Ge,children:n.jsxs(rd,{side:"right",className:"w-full sm:max-w-md p-0",children:[n.jsx(ju,{className:"px-6 py-4 border-b",children:n.jsxs(Zh,{className:"flex items-center gap-2",children:[n.jsx(ma,{className:"h-5 w-5 text-amber-500"}),"Sorteio ao Vivo"]})}),n.jsx("div",{className:"p-4",children:e&&n.jsx(CCe,{eventId:e,carts:h,onRefresh:B,onRaffleOverlayChange:c})})]})})]})}function ACe(){const e=pr();ta();const[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await le.auth.getSession();if(!a){e("/login");return}const{data:i}=await le.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(l=>["merchant","admin"].includes(l.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsx(kCe,{})}function TCe(e){const[t,r]=P.useState(null),[s,a]=P.useState(null),[i,o]=P.useState(null),[l,d]=P.useState([]),[c,u]=P.useState([]),[h,f]=P.useState([]),[m,p]=P.useState([]),[g,x]=P.useState([]),[v,y]=P.useState([]),[b,j]=P.useState(!0),T=P.useRef(!1),O=P.useRef([]),R=P.useRef(null),D=P.useCallback(async B=>{if(e){B!=null&&B.silent||j(!0);try{const{data:q,error:Y}=await le.from("live_events").select("*").eq("id",e).maybeSingle();if(Y)throw Y;if(!q){j(!1);return}r(q);const{data:G}=await le.from("live_events").select("*").lt("data_hora_inicio",q.data_hora_inicio).order("data_hora_inicio",{ascending:!1}).limit(1).maybeSingle();a(G);const{data:I,error:F}=await le.from("live_carts").select(`
          *,
          live_customer:live_customers(*),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color)
          ),
          seller:sellers(id, name)
        `).eq("live_event_id",e);if(F)throw F;const S=I||[];let E=[];if(G){const{data:Re}=await le.from("live_carts").select(`
            *,
            items:live_cart_items(*)
          `).eq("live_event_id",G.id);E=Re||[]}const{data:N}=await le.from("sellers").select("id, name").eq("is_active",!0),C=N||[],k=S.filter(Re=>Re.status!=="cancelado"),M=S.filter(Re=>Re.status==="pago"),U=k.reduce((Re,Ke)=>Re+(Ke.subtotal||0),0),$=M.reduce((Re,Ke)=>Re+(Ke.subtotal||0),0),X=k.length,Z=U>0?$/U*100:0,re=M.length>0?$/M.length:0;let W=0;M.forEach(Re=>{(Re.items||[]).forEach(Ke=>{Ke.status==="confirmado"&&(W+=Ke.qtd)})});const J=M.length>0?W/M.length:0;let V={totalReservado:null,totalPago:null,pedidosAtivos:null,taxaConversao:null,ticketMedio:null,pecasPorAtendimento:null};if(E.length>0){const Re=E.filter(Nt=>Nt.status!=="cancelado"),Ke=E.filter(Nt=>Nt.status==="pago"),_t=Re.reduce((Nt,ut)=>Nt+(ut.subtotal||0),0),Rt=Ke.reduce((Nt,ut)=>Nt+(ut.subtotal||0),0),Se=Re.length,tt=_t>0?Rt/_t*100:0,ot=Ke.length>0?Rt/Ke.length:0;let lt=0;Ke.forEach(Nt=>{(Nt.items||[]).forEach(ut=>{ut.status==="confirmado"&&(lt+=ut.qtd)})});const At=Ke.length>0?lt/Ke.length:0;V={totalReservado:_t>0?(U-_t)/_t*100:null,totalPago:Rt>0?($-Rt)/Rt*100:null,pedidosAtivos:Se>0?(X-Se)/Se*100:null,taxaConversao:tt>0?Z-tt:null,ticketMedio:ot>0?(re-ot)/ot*100:null,pecasPorAtendimento:At>0?(J-At)/At*100:null}}o({totalReservado:U,totalPago:$,pedidosAtivos:X,taxaConversao:Z,ticketMedio:re,pecasPorAtendimento:J,comparison:V,previousLive:G?{id:G.id,titulo:G.titulo}:null});const H=[],ee=k;H.push({key:"reservado",label:"Reservado",count:ee.length,value:U,conversionFromPrevious:100,color:"blue"});const ie=k.filter(Re=>(Re.charge_attempts||0)>0),oe=ie.reduce((Re,Ke)=>Re+(Ke.subtotal||0),0);H.push({key:"cobrado",label:"Cobrado",count:ie.length,value:oe,conversionFromPrevious:ee.length>0?ie.length/ee.length*100:0,color:"amber"}),H.push({key:"pago",label:"Pago",count:M.length,value:$,conversionFromPrevious:ie.length>0?M.length/ie.length*100:0,color:"green"});const se=M.filter(Re=>Re.separation_status==="separado"||["etiqueta_gerada","postado","em_rota","entregue","retirado"].includes(Re.operational_status||"")),ue=se.reduce((Re,Ke)=>Re+(Ke.subtotal||0),0);H.push({key:"separado",label:"Separado",count:se.length,value:ue,conversionFromPrevious:M.length>0?se.length/M.length*100:0,color:"purple"});const pe=M.filter(Re=>["postado","em_rota","entregue","retirado"].includes(Re.operational_status||"")),ce=pe.reduce((Re,Ke)=>Re+(Ke.subtotal||0),0);H.push({key:"enviado",label:"Enviado/Retirado",count:pe.length,value:ce,conversionFromPrevious:se.length>0?pe.length/se.length*100:0,color:"indigo"});const ne=M.filter(Re=>Re.operational_status==="entregue"||Re.operational_status==="retirado"),me=ne.reduce((Re,Ke)=>Re+(Ke.subtotal||0),0);H.push({key:"entregue",label:"Entregue",count:ne.length,value:me,conversionFromPrevious:pe.length>0?ne.length/pe.length*100:100,color:"emerald"}),d(H);const ge=new Map;k.forEach(Re=>{const Ke=Re.seller_id||null,_t=ge.get(Ke)||{pedidos:0,valorPago:0,valorReservado:0,pecas:0};_t.valorReservado+=Re.subtotal||0,Re.status==="pago"&&(_t.pedidos+=1,_t.valorPago+=Re.subtotal||0,(Re.items||[]).forEach(Rt=>{Rt.status==="confirmado"&&(_t.pecas+=Rt.qtd)})),ge.set(Ke,_t)});const _e=[];ge.forEach((Re,Ke)=>{const _t=C.find(Rt=>Rt.id===Ke);_e.push({sellerId:Ke,sellerName:(_t==null?void 0:_t.name)||"Sem vendedora",pedidos:Re.pedidos,valorReservado:Re.valorReservado,valorPago:Re.valorPago,ticketMedio:Re.pedidos>0?Re.valorPago/Re.pedidos:0,taxaConversao:Re.valorReservado>0?Re.valorPago/Re.valorReservado*100:0,rank:0,badges:[],performanceScore:0})}),_e.sort((Re,Ke)=>Ke.valorPago-Re.valorPago),_e.forEach((Re,Ke)=>{Re.rank=Ke+1});const be=_e.filter(Re=>Re.valorPago>0);if(be.length>0){const Re=Math.max(...be.map(lt=>lt.valorPago)),Ke=be.find(lt=>lt.valorPago===Re);Ke&&Ke.badges.push("maior_faturamento");const _t=Math.max(...be.map(lt=>lt.pedidos)),Rt=be.find(lt=>lt.pedidos===_t);Rt&&Rt.badges.push("mais_pedidos");const Se=be.filter(lt=>lt.pedidos>=3||lt.valorReservado>=300);if(Se.length>0){const lt=Math.max(...Se.map(Nt=>Nt.taxaConversao)),At=Se.find(Nt=>Nt.taxaConversao===lt);At&&At.taxaConversao>0&&At.badges.push("maior_conversao")}const tt=Math.max(...be.map(lt=>lt.valorPago),1),ot=Math.max(...be.map(lt=>lt.pedidos),1);if(be.forEach(lt=>{const At=lt.valorPago/tt,Nt=lt.taxaConversao/100,ut=lt.pedidos/ot;lt.performanceScore=.45*At+.35*Nt+.2*ut}),be.length>=2){const At=[...be].sort((Nt,ut)=>ut.performanceScore-Nt.performanceScore)[0];At.badges.length<3&&At.performanceScore>.5&&At.badges.push("melhor_performance")}}_e.forEach(Re=>{Re.taxaConversao<30&&Re.valorReservado>200&&Re.pedidos===0&&Re.badges.push("attention")}),u(_e);const ye=Date.now(),Oe=24*60*60*1e3,Ne=12*60*60*1e3,De=[],Ge=k.filter(Re=>{if(Re.status!=="aguardando_pagamento"||(Re.charge_attempts||0)===0)return!1;const Ke=Re.last_charge_at?new Date(Re.last_charge_at).getTime():0;return ye-Ke>Oe});Ge.length>0&&De.push({key:"aguardando_retorno_24h",label:"Aguardando retorno >24h",count:Ge.length,value:Ge.reduce((Re,Ke)=>Re+(Ke.subtotal||0),0),severity:"danger",filterKey:"aguardando_retorno",icon:"clock"});const Qe=k.filter(Re=>Re.status==="aguardando_pagamento"&&(Re.charge_attempts||0)===0);Qe.length>0&&De.push({key:"nao_cobrados",label:"Pedidos no cobrados",count:Qe.length,value:Qe.reduce((Re,Ke)=>Re+(Ke.subtotal||0),0),severity:"warning",filterKey:"needs_charge",icon:"send"});const Ie=M.filter(Re=>!Re.operational_status||Re.operational_status==="aguardando_pagamento"||Re.operational_status==="pago");if(Ie.length>0){const Re=Ie.filter(Ke=>{const _t=Ke.paid_at?new Date(Ke.paid_at).getTime():new Date(Ke.updated_at).getTime();return ye-_t>Ne});Re.length>0&&De.push({key:"pagos_sem_logistica",label:"Pagos sem logstica iniciada",count:Re.length,value:Re.reduce((Ke,_t)=>Ke+(_t.subtotal||0),0),severity:"warning",filterKey:"preparar_envio",icon:"package"})}const Ae=M.filter(Re=>Re.delivery_method==="correios"&&(!Re.operational_status||!["etiqueta_gerada","postado","entregue"].includes(Re.operational_status)));Ae.length>0&&De.push({key:"etiquetas_pendentes",label:"Etiquetas pendentes",count:Ae.length,value:Ae.reduce((Re,Ke)=>Re+(Ke.subtotal||0),0),severity:"info",filterKey:"correios",icon:"tag"});const st=k.filter(Re=>!Re.seller_id);st.length>0&&De.push({key:"sem_vendedora",label:"Pedidos sem vendedora",count:st.length,value:st.reduce((Re,Ke)=>Re+(Ke.subtotal||0),0),severity:"info",filterKey:"none",icon:"user"});const nt=k.filter(Re=>Re.payment_review_status==="pending_review");nt.length>0&&De.push({key:"pending_validation",label:"Pagamentos pendentes de validao",count:nt.length,value:nt.reduce((Re,Ke)=>Re+(Ke.subtotal||0),0),severity:"danger",filterKey:"pending_proof",icon:"shield"}),f(De);const vt=new Map;M.forEach(Re=>{(Re.items||[]).forEach(Ke=>{if(Ke.status==="confirmado"&&Ke.product){const _t=vt.get(Ke.product_id);_t?(_t.quantidadeVendida+=Ke.qtd,_t.valorTotal+=Ke.preco_unitario*Ke.qtd):vt.set(Ke.product_id,{productId:Ke.product_id,productName:Ke.product.name,productImage:Ke.product.image_url,productColor:Ke.product.color,quantidadeVendida:Ke.qtd,valorTotal:Ke.preco_unitario*Ke.qtd})}})}),p(Array.from(vt.values()).sort((Re,Ke)=>Ke.valorTotal-Re.valorTotal));const Je=["reservado","confirmado","expirado","removido","cancelado"],Ue=["reservado","confirmado"],Le=S.filter(Re=>Re.live_customer&&Re.status!=="cancelado").map(Re=>{var Rt,Se,tt;const Ke=(Re.items||[]).filter(ot=>Je.includes(ot.status)),_t=(Re.items||[]).filter(ot=>Ue.includes(ot.status));return{customerId:Re.live_customer_id,cartId:Re.id,instagram:((Rt=Re.live_customer)==null?void 0:Rt.instagram_handle)||"",nome:((Se=Re.live_customer)==null?void 0:Se.nome)||null,whatsapp:((tt=Re.live_customer)==null?void 0:tt.whatsapp)||null,valorTotal:Re.total,itens:Ke.length,activeItens:_t.length,status:Re.status,items:Ke,mpCheckoutUrl:Re.mp_checkout_url||null,publicToken:Re.public_token||null}}).sort((Re,Ke)=>Ke.valorTotal-Re.valorTotal);x(Le);const Ze=[];S.forEach(Re=>{const Ke=Re.status==="pago";(Re.items||[]).forEach(_t=>{if(["reservado","confirmado","expirado"].includes(_t.status)){const Rt=new Date(_t.reservado_em).getTime();Ze.push({timestamp:Rt,valor:_t.preco_unitario*_t.qtd,isPago:Ke})}})}),Ze.sort((Re,Ke)=>Re.timestamp-Ke.timestamp);let ct=0,ht=0;const yt=Ze.map(Re=>(ct+=Re.valor,Re.isPago&&(ht+=Re.valor),{time:new Date(Re.timestamp).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),timestamp:Re.timestamp,reservadoMomento:Re.valor,reservadoAcumulado:ct,pagoAcumulado:ht}));y(yt)}catch(q){console.error("Error fetching report data:",q)}finally{T.current=!0,B!=null&&B.silent||j(!1)}}},[e]);return P.useEffect(()=>{D()},[D]),P.useEffect(()=>{if(!e)return;O.current.forEach(G=>le.removeChannel(G)),O.current=[],R.current&&(window.clearTimeout(R.current),R.current=null);const B=()=>{R.current&&window.clearTimeout(R.current),R.current=window.setTimeout(()=>{D({silent:T.current})},350)},q=le.channel(`live_reports_v2_carts_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_carts",filter:`live_event_id=eq.${e}`},B).subscribe(),Y=le.channel(`live_reports_v2_items_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_cart_items"},B).subscribe();return O.current=[q,Y],()=>{O.current.forEach(G=>le.removeChannel(G)),O.current=[],R.current&&(window.clearTimeout(R.current),R.current=null)}},[e,D]),{event:t,previousEvent:s,kpis:i,funnel:l,sellerPerformance:c,insights:h,topProducts:m,customerSales:g,timelineData:v,isLoading:b,refetch:D}}function PCe({kpis:e}){const t=i=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i),r=i=>i===null?null:`${i>0?"+":""}${i.toFixed(1)}%`,s=(i,o=!1)=>{if(i===null)return null;const l=i>0;return Math.abs(i)<.5?n.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"(=)"}):n.jsxs("span",{className:`inline-flex items-center gap-0.5 text-xs ${l?"text-green-600":"text-red-600"}`,children:[l?n.jsx(Vs,{className:"h-3 w-3"}):n.jsx(Sx,{className:"h-3 w-3"}),o?`${i>0?"+":""}${i.toFixed(1)}pp`:r(i)]})},a=[{title:"Total Reservado",value:t(e.totalReservado),comparison:e.comparison.totalReservado,icon:ks,iconBg:"bg-blue-100",iconColor:"text-blue-600",highlight:!0,highlightColor:"border-blue-200 bg-gradient-to-br from-blue-50 to-white"},{title:"Total Pago",value:t(e.totalPago),comparison:e.comparison.totalPago,icon:Sr,iconBg:"bg-green-100",iconColor:"text-green-600",highlight:!0,highlightColor:"border-green-200 bg-gradient-to-br from-green-50 to-white"},{title:"Pedidos Ativos",value:e.pedidosAtivos.toString(),comparison:e.comparison.pedidosAtivos,icon:hn,iconBg:"bg-purple-100",iconColor:"text-purple-600"},{title:"Taxa de Converso",value:`${e.taxaConversao.toFixed(1)}%`,comparison:e.comparison.taxaConversao,isPercentagePoint:!0,icon:li,iconBg:"bg-amber-100",iconColor:"text-amber-600"},{title:"Ticket Mdio",value:t(e.ticketMedio),comparison:e.comparison.ticketMedio,icon:ms,iconBg:"bg-teal-100",iconColor:"text-teal-600"},{title:"P.A. (Peas/Atend.)",value:e.pecasPorAtendimento.toFixed(1),comparison:e.comparison.pecasPorAtendimento,icon:Vt,iconBg:"bg-indigo-100",iconColor:"text-indigo-600"}];return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-lg font-semibold",children:"Viso Geral"}),e.previousLive&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["Comparado com: ",e.previousLive.titulo]})]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:a.map((i,o)=>n.jsx($e,{className:`relative overflow-hidden ${i.highlight?`border-2 ${i.highlightColor}`:""}`,children:n.jsxs(Fe,{className:"p-4",children:[n.jsx("div",{className:"flex items-start justify-between mb-2",children:n.jsx("div",{className:`p-2 rounded-lg ${i.iconBg}`,children:n.jsx(i.icon,{className:`h-4 w-4 ${i.iconColor}`})})}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-baseline gap-1 flex-wrap",children:[n.jsx("span",{className:`text-xl font-bold ${i.highlight?o===0?"text-blue-700":"text-green-700":""}`,children:i.value}),s(i.comparison,i.isPercentagePoint)]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:i.title})]})]})},o))})]})}function OCe({funnel:e}){const t=pr(),{eventId:r}=ta(),s=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l),a=(l,d)=>{const c={blue:{bg:"bg-blue-500",text:"text-blue-700",border:"border-blue-300",light:"bg-blue-50"},amber:{bg:"bg-amber-500",text:"text-amber-700",border:"border-amber-300",light:"bg-amber-50"},green:{bg:"bg-green-500",text:"text-green-700",border:"border-green-300",light:"bg-green-50"},purple:{bg:"bg-purple-500",text:"text-purple-700",border:"border-purple-300",light:"bg-purple-50"},indigo:{bg:"bg-indigo-500",text:"text-indigo-700",border:"border-indigo-300",light:"bg-indigo-50"},emerald:{bg:"bg-emerald-500",text:"text-emerald-700",border:"border-emerald-300",light:"bg-emerald-50"}};return c[l]||c.blue},i=l=>{if(!r)return;const c={reservado:"all",cobrado:"cobrado",pago:"pago",separado:"separado",enviado:"postado",entregue:"entregue"}[l]||"all";t(`/dashboard/lives/${r}/pedidos?status=${c}`)},o=Math.max(...e.map(l=>l.count),1);return n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-3",children:n.jsx(Lt,{className:"text-base font-medium",children:"Funil da Live"})}),n.jsxs(Fe,{className:"space-y-3",children:[e.map((l,d)=>{const c=a(l.color),u=Math.max(l.count/o*100,10),h=d>0&&e[d-1].count>0;return n.jsxs("div",{className:"space-y-1",children:[h&&n.jsxs("div",{className:"flex items-center justify-center gap-1 py-1",children:[n.jsx("div",{className:"h-px flex-1 bg-muted"}),n.jsxs(ke,{variant:"outline",className:`text-xs ${l.conversionFromPrevious>=70?"border-green-300 text-green-600":l.conversionFromPrevious>=40?"border-amber-300 text-amber-600":"border-red-300 text-red-600"}`,children:[l.conversionFromPrevious.toFixed(0),"%"]}),n.jsx("div",{className:"h-px flex-1 bg-muted"})]}),n.jsx("button",{onClick:()=>i(l.key),className:`w-full group relative overflow-hidden rounded-lg border ${c.border} ${c.light} hover:shadow-md transition-all`,style:{width:`${u}%`,minWidth:"200px",marginLeft:"auto",marginRight:"auto"},children:n.jsxs("div",{className:"flex items-center justify-between p-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-2 h-8 rounded-full ${c.bg}`}),n.jsxs("div",{className:"text-left",children:[n.jsx("p",{className:`font-medium text-sm ${c.text}`,children:l.label}),n.jsx("p",{className:"text-xs text-muted-foreground",children:s(l.value)})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`text-xl font-bold ${c.text}`,children:l.count}),n.jsx(In,{className:"h-4 w-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"})]})]})})]},l.key)}),n.jsx("div",{className:"pt-3 border-t text-xs text-muted-foreground text-center",children:"Clique em uma etapa para filtrar os pedidos"})]})]})}function RCe({sellers:e}){const t=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l),r=l=>{switch(l){case 1:return n.jsx("div",{className:"flex items-center justify-center w-7 h-7 rounded-full bg-yellow-100",children:n.jsx(Vi,{className:"h-4 w-4 text-yellow-600"})});case 2:return n.jsx("div",{className:"flex items-center justify-center w-7 h-7 rounded-full bg-slate-200 text-slate-600 text-xs font-bold",children:"2"});case 3:return n.jsx("div",{className:"flex items-center justify-center w-7 h-7 rounded-full bg-amber-100 text-amber-700 text-xs font-bold",children:"3"});default:return n.jsxs("div",{className:"flex items-center justify-center w-7 h-7 rounded-full bg-muted text-muted-foreground text-xs font-bold",children:[l,""]})}},s=l=>{switch(l){case"maior_faturamento":return{icon:ks,label:"Maior Faturamento",className:"bg-green-100 text-green-700 border-green-300"};case"maior_conversao":return{icon:li,label:"Maior Converso",className:"bg-blue-100 text-blue-700 border-blue-300"};case"mais_pedidos":return{icon:hn,label:"Mais Pedidos",className:"bg-purple-100 text-purple-700 border-purple-300"};case"melhor_performance":return{icon:XF,label:"Melhor Performance",className:"bg-yellow-100 text-yellow-700 border-yellow-300"};case"attention":return{icon:Or,label:"Ateno",className:"border-red-300 text-red-600 bg-red-50"}}},a=l=>l.length===0?null:n.jsx("div",{className:"flex flex-wrap gap-1",children:l.map(d=>{const c=s(d),u=c.icon;return n.jsxs(ke,{className:`${c.className} gap-1 text-[10px] px-1.5 py-0.5`,children:[n.jsx(u,{className:"h-3 w-3"}),n.jsx("span",{className:"hidden sm:inline",children:c.label})]},d)})}),i=[...e].filter(l=>l.valorPago>0),o=e.filter(l=>l.valorPago===0);return e.length===0?n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-3",children:n.jsxs(Lt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(Ha,{className:"h-4 w-4"}),"Performance por Vendedora"]})}),n.jsx(Fe,{children:n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Ha,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm",children:"Nenhuma vendedora atribuda ainda"})]})})]}):n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Lt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(Vs,{className:"h-4 w-4"}),"Performance por Vendedora"]}),n.jsx(dp,{children:n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsx("span",{className:"text-xs text-muted-foreground cursor-help underline decoration-dotted",children:" Critrios dos badges"})}),n.jsx(Sa,{side:"left",className:"max-w-xs",children:n.jsxs("div",{className:"space-y-1 text-xs",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Maior Faturamento:"})," Maior valor pago"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Mais Pedidos:"})," Maior n de pedidos pagos"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Maior Converso:"})," Maior % converso (base mnima: 3 pedidos OU R$300 reservado)"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Melhor Performance:"})," Score ponderado (45% valor + 35% converso + 20% pedidos)"]})]})})]})})]})}),n.jsx(Fe,{children:n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{className:"bg-muted/50",children:[n.jsx(St,{className:"w-12 text-center",children:"#"}),n.jsx(St,{children:"Vendedora"}),n.jsx(St,{className:"text-center",children:"Pedidos"}),n.jsx(St,{className:"text-right",children:"Valor Pago"}),n.jsx(St,{className:"text-center hidden sm:table-cell",children:"Ticket Mdio"}),n.jsx(St,{className:"text-center hidden md:table-cell",children:"Converso"}),n.jsx(St,{className:"text-center",children:"Status"})]})}),n.jsxs(ya,{children:[i.map(l=>n.jsxs(Kr,{className:l.rank<=3?"bg-muted/20":"",children:[n.jsx(bt,{className:"text-center",children:r(l.rank)}),n.jsx(bt,{children:n.jsx("span",{className:`font-medium ${l.sellerId?"":"text-muted-foreground italic"}`,children:l.sellerName})}),n.jsx(bt,{className:"text-center font-medium",children:l.pedidos}),n.jsx(bt,{className:"text-right",children:n.jsx("span",{className:"font-bold text-green-600",children:t(l.valorPago)})}),n.jsx(bt,{className:"text-center hidden sm:table-cell",children:t(l.ticketMedio)}),n.jsx(bt,{className:"text-center hidden md:table-cell",children:n.jsxs("span",{className:`font-medium ${l.taxaConversao>=70?"text-green-600":l.taxaConversao>=40?"text-amber-600":"text-red-600"}`,children:[l.taxaConversao.toFixed(0),"%"]})}),n.jsx(bt,{className:"text-center",children:a(l.badges)})]},l.sellerId||"none")),o.length>0&&n.jsx(Kr,{className:"bg-muted/10",children:n.jsxs(bt,{colSpan:7,className:"text-center text-xs text-muted-foreground py-2",children:[o.length," vendedora(s) sem vendas pagas nesta live"]})})]})]})})})]})}function MCe({insights:e}){const t=pr(),{eventId:r}=ta(),s=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l),a=l=>({clock:Lr,send:yf,package:Vt,tag:ua,user:Dn,shield:dse})[l]||Or,i=l=>{switch(l){case"danger":return{bg:"bg-red-50 hover:bg-red-100",border:"border-red-200",iconBg:"bg-red-100",iconColor:"text-red-600",textColor:"text-red-700"};case"warning":return{bg:"bg-amber-50 hover:bg-amber-100",border:"border-amber-200",iconBg:"bg-amber-100",iconColor:"text-amber-600",textColor:"text-amber-700"};default:return{bg:"bg-blue-50 hover:bg-blue-100",border:"border-blue-200",iconBg:"bg-blue-100",iconColor:"text-blue-600",textColor:"text-blue-700"}}},o=l=>{r&&t(`/dashboard/lives/${r}/pedidos?filter=${l.filterKey}`)};return e.length===0?n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-3",children:n.jsxs(Lt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(PN,{className:"h-4 w-4"}),"Insights Acionveis"]})}),n.jsx(Fe,{children:n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(PN,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm font-medium text-green-600",children:"Tudo em ordem!"}),n.jsx("p",{className:"text-xs mt-1",children:"Nenhuma pendncia identificada"})]})})]}):n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-3",children:n.jsxs(Lt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(PN,{className:"h-4 w-4"}),"Insights Acionveis",n.jsxs("span",{className:"ml-auto text-xs font-normal text-muted-foreground",children:[e.length," pendncia(s)"]})]})}),n.jsx(Fe,{className:"space-y-2",children:e.map(l=>{const d=a(l.icon),c=i(l.severity);return n.jsxs("button",{onClick:()=>o(l),className:`w-full flex items-center gap-3 p-3 rounded-lg border transition-all ${c.bg} ${c.border} group`,children:[n.jsx("div",{className:`p-2 rounded-lg ${c.iconBg}`,children:n.jsx(d,{className:`h-4 w-4 ${c.iconColor}`})}),n.jsxs("div",{className:"flex-1 text-left",children:[n.jsx("p",{className:`text-sm font-medium ${c.textColor}`,children:l.label}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[l.count," pedido(s)  ",s(l.value)]})]}),n.jsx(In,{className:"h-4 w-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"})]},l.key)})})]})}function QC({products:e}){var s;const t=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a);if(e.length===0)return n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(ma,{className:"h-5 w-5 text-amber-500"}),"Produtos Mais Vendidos"]})}),n.jsx(Fe,{children:n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhuma venda registrada"})})]});const r=((s=e[0])==null?void 0:s.valorTotal)||1;return n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(ma,{className:"h-5 w-5 text-amber-500"}),"Produtos Mais Vendidos"]})}),n.jsx(Fe,{className:"space-y-3",children:e.slice(0,10).map((a,i)=>n.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/50 transition-colors",children:[n.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ${i===0?"bg-amber-100 text-amber-700":i===1?"bg-gray-200 text-gray-700":i===2?"bg-orange-100 text-orange-700":"bg-muted text-muted-foreground"}`,children:i+1}),n.jsx("div",{className:"w-10 h-10 rounded-lg bg-secondary overflow-hidden shrink-0",children:a.productImage?n.jsx("img",{src:a.productImage,alt:a.productName,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:a.productName}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.productColor&&`${a.productColor}  `,a.quantidadeVendida," ",a.quantidadeVendida===1?"unidade":"unidades"]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("div",{className:"font-semibold text-sm",children:t(a.valorTotal)}),n.jsx("div",{className:"w-16 h-1 bg-muted rounded-full mt-1",children:n.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${a.valorTotal/r*100}%`}})})]})]},a.productId))})]})}function ICe({sales:e,onRefresh:t}){const[r,s]=P.useState(null),[a,i]=P.useState([]),[o,l]=P.useState(!1),[d,c]=P.useState(!1),u=v=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(v),h={pago:{label:"Pago",variant:"default",icon:Sr},aguardando_pagamento:{label:"Aguardando",variant:"secondary",icon:Lr},aberto:{label:"Aberto",variant:"outline",icon:Lr},em_confirmacao:{label:"Confirmando",variant:"secondary",icon:Lr},cancelado:{label:"Cancelado",variant:"destructive",icon:Kn},expirado:{label:"Aguardando pagamento",variant:"secondary",icon:Lr}};P.useEffect(()=>{r?(l(!0),le.from("live_cart_status_history").select("*").eq("live_cart_id",r.cartId).order("created_at",{ascending:!0}).then(({data:v})=>{i(v||[]),l(!1)})):i([])},[r==null?void 0:r.cartId]);const f=(v,y)=>{const b=window.location.origin;return y?`${b}/live-checkout/${v}?token=${y}`:`${b}/live-checkout/${v}`},m=v=>{const y=v.nome||v.instagram,b=v.mpCheckoutUrl||f(v.cartId,v.publicToken);let j=`Oi${y?` ${y.split(" ")[0]}`:""}! 

`;return j+=`Vi aqui que seu pedido da live ainda est aguardando pagamento.

`,v.items.forEach(T=>{var D,B,q,Y;const O=((D=T.variante)==null?void 0:D.tamanho)||"",R=((B=T.variante)==null?void 0:B.cor)||((q=T.product)==null?void 0:q.color)||"";j+=` ${((Y=T.product)==null?void 0:Y.name)||"Produto"}`,O&&(j+=` - Tam: ${O}`),R&&(j+=` (${R})`),j+=` - ${u(T.preco_unitario)}
`}),j+=`
 Total: ${u(v.valorTotal)}

`,j+=`Ainda quer garantir? Finalize por aqui:
${b}

`,j+="Me avisa se precisar de ajuda! ",j},p=v=>{var j;const y=((j=v.whatsapp)==null?void 0:j.replace(/\D/g,""))||"",b=m(v);if(y){const T=`https://wa.me/${y}?text=${encodeURIComponent(b)}`;window.open(T,"_blank")}else navigator.clipboard.writeText(b),de.success("Mensagem copiada! Envie pelo Instagram DM.")},g=async v=>{var y;c(!0);try{const{data:b,error:j}=await le.functions.invoke("create-live-cart-payment",{body:{live_cart_id:v}});if(j)throw j;if(b!=null&&b.success&&(b!=null&&b.init_point))b.already_exists?de.info("Link j existia - abrindo..."):de.success("Link de pagamento gerado!"),window.open(b.init_point,"_blank"),t==null||t();else if(b!=null&&b.error_code){const T=b.message||"Erro ao gerar pagamento",O=b.action?` ${b.action}`:"";de.error(`${T}${O}`),console.error("Payment generation error:",b)}else de.error((b==null?void 0:b.error)||(b==null?void 0:b.message)||"Erro ao gerar pagamento")}catch(b){console.error("Error generating payment:",b);const j=((y=b==null?void 0:b.context)==null?void 0:y.json)||(b==null?void 0:b.data);j!=null&&j.error_code?de.error(j.message||"Erro ao gerar link de pagamento"):de.error("Erro de conexo ao gerar link")}finally{c(!1)}},x=v=>{const y=f(v.cartId,v.publicToken);navigator.clipboard.writeText(y),de.success("Link copiado!")};return e.length===0?n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Ha,{className:"h-5 w-5 text-primary"}),"Vendas por Cliente"]})}),n.jsx(Fe,{children:n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum carrinho registrado"})})]}):n.jsxs(n.Fragment,{children:[n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Ha,{className:"h-5 w-5 text-primary"}),"Vendas por Cliente"]})}),n.jsx(Fe,{className:"space-y-2",children:e.map((v,y)=>{const b=h[v.status]||h.aberto,j=b.icon;return n.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>s(v),children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:n.jsx("span",{className:"text-sm font-semibold text-primary",children:v.instagram.replace("@","").charAt(0).toUpperCase()})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium truncate",children:v.instagram}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[v.nome||"","  ",v.itens," ",v.itens===1?"item":"itens"]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("div",{className:"font-semibold",children:u(v.valorTotal)}),n.jsxs(ke,{variant:b.variant,className:"text-xs mt-1",children:[n.jsx(j,{className:"h-3 w-3 mr-1"}),b.label]})]})]},`${v.customerId}-${y}`)})})]}),n.jsx(tn,{open:!!r,onOpenChange:v=>{v||s(null)},children:n.jsxs(Jr,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[n.jsx(ln,{children:n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:n.jsx("span",{className:"text-sm font-semibold text-primary",children:r==null?void 0:r.instagram.replace("@","").charAt(0).toUpperCase()})}),r==null?void 0:r.instagram]})}),r&&n.jsxs("div",{className:"space-y-4",children:[r.nome&&n.jsxs("div",{className:"text-sm text-muted-foreground",children:[r.nome,r.whatsapp&&`  ${r.whatsapp}`]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Itens do Carrinho"}),r.items.length===0?n.jsx("div",{className:"text-center py-4 text-sm text-muted-foreground",children:"Nenhum item no carrinho"}):r.items.map(v=>{var j,T,O;const y=v.status,b=["expirado","removido","cancelado"].includes(y);return n.jsxs("div",{className:`flex items-center gap-3 p-2 rounded-lg ${b?"bg-muted/20 opacity-70":"bg-muted/30"}`,children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:(j=v.product)!=null&&j.image_url?n.jsx("img",{src:v.product.image_url,alt:v.product.name,className:"w-full h-full object-cover"}):n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground m-auto mt-3"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"font-medium text-sm truncate flex items-center gap-2",children:[(T=v.product)==null?void 0:T.name,b&&n.jsx(ke,{variant:"outline",className:"text-[10px] px-1.5 py-0 bg-muted text-muted-foreground",children:y==="expirado"?"Expirado":y==="removido"?"Removido":"Cancelado"})]}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Tam: ",(O=v.variante)==null?void 0:O.tamanho,"  Qtd: ",v.qtd]})]}),n.jsx("div",{className:`font-medium text-sm ${b?"line-through text-muted-foreground":""}`,children:u(v.preco_unitario*v.qtd)})]},v.id)})]}),n.jsxs("div",{className:"flex justify-between items-center p-3 bg-primary/10 rounded-lg",children:[n.jsx("span",{className:"font-medium",children:"Total"}),n.jsx("span",{className:"text-xl font-bold",children:u(r.valorTotal)})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Status atual:"}),n.jsxs(ke,{className:r.status==="pago"?"bg-green-100 text-green-700":r.status==="cancelado"?"bg-red-100 text-red-700":["aguardando_pagamento","em_confirmacao","expirado"].includes(r.status)?"bg-amber-100 text-amber-700":"bg-blue-100 text-blue-700",children:[r.status==="pago"&&" Pago",r.status==="aberto"&&" Aberto",r.status==="aguardando_pagamento"&&" Aguardando",r.status==="cancelado"&&" Cancelado",r.status==="expirado"&&" Aguardando pagamento",r.status==="em_confirmacao"&&" Confirmando"]})]}),n.jsx(KX,{history:a,isLoading:o}),!["pago","cancelado"].includes(r.status)&&n.jsxs("div",{className:"space-y-3 pt-4 border-t mt-4",children:[n.jsx("div",{className:"text-sm font-medium",children:"Cobrar cliente"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs(he,{variant:"outline",className:"gap-1.5",onClick:()=>x(r),children:[n.jsx(Wa,{className:"h-4 w-4"}),"Copiar Link"]}),n.jsxs(he,{variant:"outline",className:"gap-1.5 text-green-600 border-green-200 hover:bg-green-50",onClick:()=>p(r),children:[n.jsx(nn,{className:"h-4 w-4"}),r.whatsapp?"WhatsApp":"Copiar Msg"]})]}),r.mpCheckoutUrl?n.jsxs(he,{variant:"outline",className:"w-full gap-1.5 text-blue-600",onClick:()=>window.open(r.mpCheckoutUrl,"_blank"),children:[n.jsx(Zs,{className:"h-4 w-4"}),"Abrir Link Mercado Pago"]}):n.jsxs(he,{className:"w-full gap-1.5",onClick:()=>g(r.cartId),disabled:d,children:[d?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):n.jsx(ms,{className:"h-4 w-4"}),"Gerar Link Mercado Pago"]})]})]})]})})]})}var DCe=Array.isArray,Ki=DCe,LCe=typeof Fr=="object"&&Fr&&Fr.Object===Object&&Fr,YX=LCe,BCe=YX,$Ce=typeof self=="object"&&self&&self.Object===Object&&self,FCe=BCe||$Ce||Function("return this")(),Ec=FCe,zCe=Ec,UCe=zCe.Symbol,_1=UCe,I7=_1,ZX=Object.prototype,VCe=ZX.hasOwnProperty,qCe=ZX.toString,u0=I7?I7.toStringTag:void 0;function WCe(e){var t=VCe.call(e,u0),r=e[u0];try{e[u0]=void 0;var s=!0}catch{}var a=qCe.call(e);return s&&(t?e[u0]=r:delete e[u0]),a}var HCe=WCe,GCe=Object.prototype,KCe=GCe.toString;function XCe(e){return KCe.call(e)}var YCe=XCe,D7=_1,ZCe=HCe,QCe=YCe,JCe="[object Null]",e5e="[object Undefined]",L7=D7?D7.toStringTag:void 0;function t5e(e){return e==null?e===void 0?e5e:JCe:L7&&L7 in Object(e)?ZCe(e):QCe(e)}var pd=t5e;function r5e(e){return e!=null&&typeof e=="object"}var gd=r5e,n5e=pd,s5e=gd,a5e="[object Symbol]";function i5e(e){return typeof e=="symbol"||s5e(e)&&n5e(e)==a5e}var jg=i5e,o5e=Ki,l5e=jg,c5e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,d5e=/^\w*$/;function u5e(e,t){if(o5e(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||l5e(e)?!0:d5e.test(e)||!c5e.test(e)||t!=null&&e in Object(t)}var H8=u5e;function h5e(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Uu=h5e;const Ng=Ln(Uu);var f5e=pd,m5e=Uu,p5e="[object AsyncFunction]",g5e="[object Function]",x5e="[object GeneratorFunction]",v5e="[object Proxy]";function y5e(e){if(!m5e(e))return!1;var t=f5e(e);return t==g5e||t==x5e||t==p5e||t==v5e}var G8=y5e;const Yr=Ln(G8);var b5e=Ec,w5e=b5e["__core-js_shared__"],_5e=w5e,X3=_5e,B7=function(){var e=/[^.]+$/.exec(X3&&X3.keys&&X3.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function j5e(e){return!!B7&&B7 in e}var N5e=j5e,S5e=Function.prototype,C5e=S5e.toString;function E5e(e){if(e!=null){try{return C5e.call(e)}catch{}try{return e+""}catch{}}return""}var QX=E5e,k5e=G8,A5e=N5e,T5e=Uu,P5e=QX,O5e=/[\\^$.*+?()[\]{}|]/g,R5e=/^\[object .+?Constructor\]$/,M5e=Function.prototype,I5e=Object.prototype,D5e=M5e.toString,L5e=I5e.hasOwnProperty,B5e=RegExp("^"+D5e.call(L5e).replace(O5e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function $5e(e){if(!T5e(e)||A5e(e))return!1;var t=k5e(e)?B5e:R5e;return t.test(P5e(e))}var F5e=$5e;function z5e(e,t){return e==null?void 0:e[t]}var U5e=z5e,V5e=F5e,q5e=U5e;function W5e(e,t){var r=q5e(e,t);return V5e(r)?r:void 0}var Sf=W5e,H5e=Sf,G5e=H5e(Object,"create"),tj=G5e,$7=tj;function K5e(){this.__data__=$7?$7(null):{},this.size=0}var X5e=K5e;function Y5e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Z5e=Y5e,Q5e=tj,J5e="__lodash_hash_undefined__",eEe=Object.prototype,tEe=eEe.hasOwnProperty;function rEe(e){var t=this.__data__;if(Q5e){var r=t[e];return r===J5e?void 0:r}return tEe.call(t,e)?t[e]:void 0}var nEe=rEe,sEe=tj,aEe=Object.prototype,iEe=aEe.hasOwnProperty;function oEe(e){var t=this.__data__;return sEe?t[e]!==void 0:iEe.call(t,e)}var lEe=oEe,cEe=tj,dEe="__lodash_hash_undefined__";function uEe(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=cEe&&t===void 0?dEe:t,this}var hEe=uEe,fEe=X5e,mEe=Z5e,pEe=nEe,gEe=lEe,xEe=hEe;function Sg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}Sg.prototype.clear=fEe;Sg.prototype.delete=mEe;Sg.prototype.get=pEe;Sg.prototype.has=gEe;Sg.prototype.set=xEe;var vEe=Sg;function yEe(){this.__data__=[],this.size=0}var bEe=yEe;function wEe(e,t){return e===t||e!==e&&t!==t}var K8=wEe,_Ee=K8;function jEe(e,t){for(var r=e.length;r--;)if(_Ee(e[r][0],t))return r;return-1}var rj=jEe,NEe=rj,SEe=Array.prototype,CEe=SEe.splice;function EEe(e){var t=this.__data__,r=NEe(t,e);if(r<0)return!1;var s=t.length-1;return r==s?t.pop():CEe.call(t,r,1),--this.size,!0}var kEe=EEe,AEe=rj;function TEe(e){var t=this.__data__,r=AEe(t,e);return r<0?void 0:t[r][1]}var PEe=TEe,OEe=rj;function REe(e){return OEe(this.__data__,e)>-1}var MEe=REe,IEe=rj;function DEe(e,t){var r=this.__data__,s=IEe(r,e);return s<0?(++this.size,r.push([e,t])):r[s][1]=t,this}var LEe=DEe,BEe=bEe,$Ee=kEe,FEe=PEe,zEe=MEe,UEe=LEe;function Cg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}Cg.prototype.clear=BEe;Cg.prototype.delete=$Ee;Cg.prototype.get=FEe;Cg.prototype.has=zEe;Cg.prototype.set=UEe;var nj=Cg,VEe=Sf,qEe=Ec,WEe=VEe(qEe,"Map"),X8=WEe,F7=vEe,HEe=nj,GEe=X8;function KEe(){this.size=0,this.__data__={hash:new F7,map:new(GEe||HEe),string:new F7}}var XEe=KEe;function YEe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var ZEe=YEe,QEe=ZEe;function JEe(e,t){var r=e.__data__;return QEe(t)?r[typeof t=="string"?"string":"hash"]:r.map}var sj=JEe,e6e=sj;function t6e(e){var t=e6e(this,e).delete(e);return this.size-=t?1:0,t}var r6e=t6e,n6e=sj;function s6e(e){return n6e(this,e).get(e)}var a6e=s6e,i6e=sj;function o6e(e){return i6e(this,e).has(e)}var l6e=o6e,c6e=sj;function d6e(e,t){var r=c6e(this,e),s=r.size;return r.set(e,t),this.size+=r.size==s?0:1,this}var u6e=d6e,h6e=XEe,f6e=r6e,m6e=a6e,p6e=l6e,g6e=u6e;function Eg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}Eg.prototype.clear=h6e;Eg.prototype.delete=f6e;Eg.prototype.get=m6e;Eg.prototype.has=p6e;Eg.prototype.set=g6e;var Y8=Eg,JX=Y8,x6e="Expected a function";function Z8(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(x6e);var r=function(){var s=arguments,a=t?t.apply(this,s):s[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,s);return r.cache=i.set(a,o)||i,o};return r.cache=new(Z8.Cache||JX),r}Z8.Cache=JX;var eY=Z8;const v6e=Ln(eY);var y6e=eY,b6e=500;function w6e(e){var t=y6e(e,function(s){return r.size===b6e&&r.clear(),s}),r=t.cache;return t}var _6e=w6e,j6e=_6e,N6e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,S6e=/\\(\\)?/g,C6e=j6e(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(N6e,function(r,s,a,i){t.push(a?i.replace(S6e,"$1"):s||r)}),t}),E6e=C6e;function k6e(e,t){for(var r=-1,s=e==null?0:e.length,a=Array(s);++r<s;)a[r]=t(e[r],r,e);return a}var Q8=k6e,z7=_1,A6e=Q8,T6e=Ki,P6e=jg,O6e=1/0,U7=z7?z7.prototype:void 0,V7=U7?U7.toString:void 0;function tY(e){if(typeof e=="string")return e;if(T6e(e))return A6e(e,tY)+"";if(P6e(e))return V7?V7.call(e):"";var t=e+"";return t=="0"&&1/e==-O6e?"-0":t}var R6e=tY,M6e=R6e;function I6e(e){return e==null?"":M6e(e)}var rY=I6e,D6e=Ki,L6e=H8,B6e=E6e,$6e=rY;function F6e(e,t){return D6e(e)?e:L6e(e,t)?[e]:B6e($6e(e))}var nY=F6e,z6e=jg,U6e=1/0;function V6e(e){if(typeof e=="string"||z6e(e))return e;var t=e+"";return t=="0"&&1/e==-U6e?"-0":t}var aj=V6e,q6e=nY,W6e=aj;function H6e(e,t){t=q6e(t,e);for(var r=0,s=t.length;e!=null&&r<s;)e=e[W6e(t[r++])];return r&&r==s?e:void 0}var J8=H6e,G6e=J8;function K6e(e,t,r){var s=e==null?void 0:G6e(e,t);return s===void 0?r:s}var sY=K6e;const Bo=Ln(sY);function X6e(e){return e==null}var Y6e=X6e;const un=Ln(Y6e);var Z6e=pd,Q6e=Ki,J6e=gd,eke="[object String]";function tke(e){return typeof e=="string"||!Q6e(e)&&J6e(e)&&Z6e(e)==eke}var rke=tke;const df=Ln(rke);var aY={exports:{}},Fn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eA=Symbol.for("react.element"),tA=Symbol.for("react.portal"),ij=Symbol.for("react.fragment"),oj=Symbol.for("react.strict_mode"),lj=Symbol.for("react.profiler"),cj=Symbol.for("react.provider"),dj=Symbol.for("react.context"),nke=Symbol.for("react.server_context"),uj=Symbol.for("react.forward_ref"),hj=Symbol.for("react.suspense"),fj=Symbol.for("react.suspense_list"),mj=Symbol.for("react.memo"),pj=Symbol.for("react.lazy"),ske=Symbol.for("react.offscreen"),iY;iY=Symbol.for("react.module.reference");function Ko(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case eA:switch(e=e.type,e){case ij:case lj:case oj:case hj:case fj:return e;default:switch(e=e&&e.$$typeof,e){case nke:case dj:case uj:case pj:case mj:case cj:return e;default:return t}}case tA:return t}}}Fn.ContextConsumer=dj;Fn.ContextProvider=cj;Fn.Element=eA;Fn.ForwardRef=uj;Fn.Fragment=ij;Fn.Lazy=pj;Fn.Memo=mj;Fn.Portal=tA;Fn.Profiler=lj;Fn.StrictMode=oj;Fn.Suspense=hj;Fn.SuspenseList=fj;Fn.isAsyncMode=function(){return!1};Fn.isConcurrentMode=function(){return!1};Fn.isContextConsumer=function(e){return Ko(e)===dj};Fn.isContextProvider=function(e){return Ko(e)===cj};Fn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===eA};Fn.isForwardRef=function(e){return Ko(e)===uj};Fn.isFragment=function(e){return Ko(e)===ij};Fn.isLazy=function(e){return Ko(e)===pj};Fn.isMemo=function(e){return Ko(e)===mj};Fn.isPortal=function(e){return Ko(e)===tA};Fn.isProfiler=function(e){return Ko(e)===lj};Fn.isStrictMode=function(e){return Ko(e)===oj};Fn.isSuspense=function(e){return Ko(e)===hj};Fn.isSuspenseList=function(e){return Ko(e)===fj};Fn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===ij||e===lj||e===oj||e===hj||e===fj||e===ske||typeof e=="object"&&e!==null&&(e.$$typeof===pj||e.$$typeof===mj||e.$$typeof===cj||e.$$typeof===dj||e.$$typeof===uj||e.$$typeof===iY||e.getModuleId!==void 0)};Fn.typeOf=Ko;aY.exports=Fn;var ake=aY.exports,ike=pd,oke=gd,lke="[object Number]";function cke(e){return typeof e=="number"||oke(e)&&ike(e)==lke}var oY=cke;const dke=Ln(oY);var uke=oY;function hke(e){return uke(e)&&e!=+e}var fke=hke;const kg=Ln(fke);var xl=function(t){return t===0?0:t>0?1:-1},jh=function(t){return df(t)&&t.indexOf("%")===t.length-1},Kt=function(t){return dke(t)&&!kg(t)},mke=function(t){return un(t)},ha=function(t){return Kt(t)||df(t)},pke=0,j1=function(t){var r=++pke;return"".concat(t||"").concat(r)},uf=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Kt(t)&&!df(t))return s;var i;if(jh(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return kg(i)&&(i=s),a&&i>r&&(i=r),i},zd=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},gke=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,s={},a=0;a<r;a++)if(!s[t[a]])s[t[a]]=!0;else return!0;return!1},Po=function(t,r){return Kt(t)&&Kt(r)?function(s){return t+s*(r-t)}:function(){return r}};function Rw(e,t,r){return!e||!e.length?null:e.find(function(s){return s&&(typeof t=="function"?t(s):Bo(s,t))===r})}var xke=function(t,r){return Kt(t)&&Kt(r)?t-r:df(t)&&df(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Um(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var s in t)if({}.hasOwnProperty.call(t,s)&&!{}.hasOwnProperty.call(e,s))return!1;return!0}function JC(e){"@babel/helpers - typeof";return JC=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},JC(e)}var vke=["viewBox","children"],yke=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],q7=["points","pathLength"],Y3={svg:vke,polygon:q7,polyline:q7},rA=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],Mw=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(P.isValidElement(t)&&(s=t.props),!Ng(s))return null;var a={};return Object.keys(s).forEach(function(i){rA.includes(i)&&(a[i]=r||function(o){return s[i](s,o)})}),a},bke=function(t,r,s){return function(a){return t(r,s,a),null}},Iw=function(t,r,s){if(!Ng(t)||JC(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var o=t[i];rA.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=bke(o,r,s))}),a},wke=["children"],_ke=["children"];function W7(e,t){if(e==null)return{};var r=jke(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function jke(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function e5(e){"@babel/helpers - typeof";return e5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e5(e)}var H7={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Wc=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},G7=null,Z3=null,nA=function e(t){if(t===G7&&Array.isArray(Z3))return Z3;var r=[];return P.Children.forEach(t,function(s){un(s)||(ake.isFragment(s)?r=r.concat(e(s.props.children)):r.push(s))}),Z3=r,G7=t,r};function _l(e,t){var r=[],s=[];return Array.isArray(t)?s=t.map(function(a){return Wc(a)}):s=[Wc(t)],nA(e).forEach(function(a){var i=Bo(a,"type.displayName")||Bo(a,"type.name");s.indexOf(i)!==-1&&r.push(a)}),r}function ro(e,t){var r=_l(e,t);return r&&r[0]}var K7=function(t){if(!t||!t.props)return!1;var r=t.props,s=r.width,a=r.height;return!(!Kt(s)||s<=0||!Kt(a)||a<=0)},Nke=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Ske=function(t){return t&&t.type&&df(t.type)&&Nke.indexOf(t.type)>=0},Cke=function(t){return t&&e5(t)==="object"&&"clipDot"in t},Eke=function(t,r,s,a){var i,o=(i=Y3==null?void 0:Y3[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Yr(t)&&(a&&o.includes(r)||yke.includes(r))||s&&rA.includes(r)},on=function(t,r,s){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(P.isValidElement(t)&&(a=t.props),!Ng(a))return null;var i={};return Object.keys(a).forEach(function(o){var l;Eke((l=a)===null||l===void 0?void 0:l[o],o,r,s)&&(i[o]=a[o])}),i},t5=function e(t,r){if(t===r)return!0;var s=P.Children.count(t);if(s!==P.Children.count(r))return!1;if(s===0)return!0;if(s===1)return X7(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<s;a++){var i=t[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!X7(i,o))return!1}return!0},X7=function(t,r){if(un(t)&&un(r))return!0;if(!un(t)&&!un(r)){var s=t.props||{},a=s.children,i=W7(s,wke),o=r.props||{},l=o.children,d=W7(o,_ke);return a&&l?Um(i,d)&&t5(a,l):!a&&!l?Um(i,d):!1}return!1},Y7=function(t,r){var s=[],a={};return nA(t).forEach(function(i,o){if(Ske(i))s.push(i);else if(i){var l=Wc(i.type),d=r[l]||{},c=d.handler,u=d.once;if(c&&(!u||!a[l])){var h=c(i,l,o);s.push(h),a[l]=!0}}}),s},kke=function(t){var r=t&&t.type;return r&&H7[r]?H7[r]:null},Ake=function(t,r){return nA(r).indexOf(t)},Tke=["children","width","height","viewBox","className","style","title","desc"];function r5(){return r5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},r5.apply(this,arguments)}function Pke(e,t){if(e==null)return{};var r=Oke(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function Oke(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function n5(e){var t=e.children,r=e.width,s=e.height,a=e.viewBox,i=e.className,o=e.style,l=e.title,d=e.desc,c=Pke(e,Tke),u=a||{width:r,height:s,x:0,y:0},h=pn("recharts-surface",i);return je.createElement("svg",r5({},on(c,!0,"svg"),{className:h,width:r,height:s,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),je.createElement("title",null,l),je.createElement("desc",null,d),t)}var Rke=["children","className"];function s5(){return s5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},s5.apply(this,arguments)}function Mke(e,t){if(e==null)return{};var r=Ike(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function Ike(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}var Ns=je.forwardRef(function(e,t){var r=e.children,s=e.className,a=Mke(e,Rke),i=pn("recharts-layer",s);return je.createElement("g",s5({className:i},on(a,!0),{ref:t}),r)}),Hc=function(t,r){for(var s=arguments.length,a=new Array(s>2?s-2:0),i=2;i<s;i++)a[i-2]=arguments[i]};function Dke(e,t,r){var s=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++s<a;)i[s]=e[s+t];return i}var Lke=Dke,Bke=Lke;function $ke(e,t,r){var s=e.length;return r=r===void 0?s:r,!t&&r>=s?e:Bke(e,t,r)}var Fke=$ke,zke="\\ud800-\\udfff",Uke="\\u0300-\\u036f",Vke="\\ufe20-\\ufe2f",qke="\\u20d0-\\u20ff",Wke=Uke+Vke+qke,Hke="\\ufe0e\\ufe0f",Gke="\\u200d",Kke=RegExp("["+Gke+zke+Wke+Hke+"]");function Xke(e){return Kke.test(e)}var lY=Xke;function Yke(e){return e.split("")}var Zke=Yke,cY="\\ud800-\\udfff",Qke="\\u0300-\\u036f",Jke="\\ufe20-\\ufe2f",e8e="\\u20d0-\\u20ff",t8e=Qke+Jke+e8e,r8e="\\ufe0e\\ufe0f",n8e="["+cY+"]",a5="["+t8e+"]",i5="\\ud83c[\\udffb-\\udfff]",s8e="(?:"+a5+"|"+i5+")",dY="[^"+cY+"]",uY="(?:\\ud83c[\\udde6-\\uddff]){2}",hY="[\\ud800-\\udbff][\\udc00-\\udfff]",a8e="\\u200d",fY=s8e+"?",mY="["+r8e+"]?",i8e="(?:"+a8e+"(?:"+[dY,uY,hY].join("|")+")"+mY+fY+")*",o8e=mY+fY+i8e,l8e="(?:"+[dY+a5+"?",a5,uY,hY,n8e].join("|")+")",c8e=RegExp(i5+"(?="+i5+")|"+l8e+o8e,"g");function d8e(e){return e.match(c8e)||[]}var u8e=d8e,h8e=Zke,f8e=lY,m8e=u8e;function p8e(e){return f8e(e)?m8e(e):h8e(e)}var g8e=p8e,x8e=Fke,v8e=lY,y8e=g8e,b8e=rY;function w8e(e){return function(t){t=b8e(t);var r=v8e(t)?y8e(t):void 0,s=r?r[0]:t.charAt(0),a=r?x8e(r,1).join(""):t.slice(1);return s[e]()+a}}var _8e=w8e,j8e=_8e,N8e=j8e("toUpperCase"),S8e=N8e;const gj=Ln(S8e);function Qn(e){return function(){return e}}const pY=Math.cos,Dw=Math.sin,Il=Math.sqrt,Lw=Math.PI,xj=2*Lw,o5=Math.PI,l5=2*o5,hh=1e-6,C8e=l5-hh;function gY(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function E8e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return gY;const r=10**t;return function(s){this._+=s[0];for(let a=1,i=s.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+s[a]}}class k8e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?gY:E8e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,s,a){this._append`Q${+t},${+r},${this._x1=+s},${this._y1=+a}`}bezierCurveTo(t,r,s,a,i,o){this._append`C${+t},${+r},${+s},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,s,a,i){if(t=+t,r=+r,s=+s,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,d=s-t,c=a-r,u=o-t,h=l-r,f=u*u+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>hh)if(!(Math.abs(h*d-c*u)>hh)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=s-o,p=a-l,g=d*d+c*c,x=m*m+p*p,v=Math.sqrt(g),y=Math.sqrt(f),b=i*Math.tan((o5-Math.acos((g+f-x)/(2*v*y)))/2),j=b/y,T=b/v;Math.abs(j-1)>hh&&this._append`L${t+j*u},${r+j*h}`,this._append`A${i},${i},0,0,${+(h*m>u*p)},${this._x1=t+T*d},${this._y1=r+T*c}`}}arc(t,r,s,a,i,o){if(t=+t,r=+r,s=+s,o=!!o,s<0)throw new Error(`negative radius: ${s}`);let l=s*Math.cos(a),d=s*Math.sin(a),c=t+l,u=r+d,h=1^o,f=o?a-i:i-a;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>hh||Math.abs(this._y1-u)>hh)&&this._append`L${c},${u}`,s&&(f<0&&(f=f%l5+l5),f>C8e?this._append`A${s},${s},0,1,${h},${t-l},${r-d}A${s},${s},0,1,${h},${this._x1=c},${this._y1=u}`:f>hh&&this._append`A${s},${s},0,${+(f>=o5)},${h},${this._x1=t+s*Math.cos(i)},${this._y1=r+s*Math.sin(i)}`)}rect(t,r,s,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${s=+s}v${+a}h${-s}Z`}toString(){return this._}}function sA(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const s=Math.floor(r);if(!(s>=0))throw new RangeError(`invalid digits: ${r}`);t=s}return e},()=>new k8e(t)}function aA(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function xY(e){this._context=e}xY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function vj(e){return new xY(e)}function vY(e){return e[0]}function yY(e){return e[1]}function bY(e,t){var r=Qn(!0),s=null,a=vj,i=null,o=sA(l);e=typeof e=="function"?e:e===void 0?vY:Qn(e),t=typeof t=="function"?t:t===void 0?yY:Qn(t);function l(d){var c,u=(d=aA(d)).length,h,f=!1,m;for(s==null&&(i=a(m=o())),c=0;c<=u;++c)!(c<u&&r(h=d[c],c,d))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(h,c,d),+t(h,c,d));if(m)return i=null,m+""||null}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:Qn(+d),l):e},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:Qn(+d),l):t},l.defined=function(d){return arguments.length?(r=typeof d=="function"?d:Qn(!!d),l):r},l.curve=function(d){return arguments.length?(a=d,s!=null&&(i=a(s)),l):a},l.context=function(d){return arguments.length?(d==null?s=i=null:i=a(s=d),l):s},l}function Iy(e,t,r){var s=null,a=Qn(!0),i=null,o=vj,l=null,d=sA(c);e=typeof e=="function"?e:e===void 0?vY:Qn(+e),t=typeof t=="function"?t:Qn(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?yY:Qn(+r);function c(h){var f,m,p,g=(h=aA(h)).length,x,v=!1,y,b=new Array(g),j=new Array(g);for(i==null&&(l=o(y=d())),f=0;f<=g;++f){if(!(f<g&&a(x=h[f],f,h))===v)if(v=!v)m=f,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),p=f-1;p>=m;--p)l.point(b[p],j[p]);l.lineEnd(),l.areaEnd()}v&&(b[f]=+e(x,f,h),j[f]=+t(x,f,h),l.point(s?+s(x,f,h):b[f],r?+r(x,f,h):j[f]))}if(y)return l=null,y+""||null}function u(){return bY().defined(a).curve(o).context(i)}return c.x=function(h){return arguments.length?(e=typeof h=="function"?h:Qn(+h),s=null,c):e},c.x0=function(h){return arguments.length?(e=typeof h=="function"?h:Qn(+h),c):e},c.x1=function(h){return arguments.length?(s=h==null?null:typeof h=="function"?h:Qn(+h),c):s},c.y=function(h){return arguments.length?(t=typeof h=="function"?h:Qn(+h),r=null,c):t},c.y0=function(h){return arguments.length?(t=typeof h=="function"?h:Qn(+h),c):t},c.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:Qn(+h),c):r},c.lineX0=c.lineY0=function(){return u().x(e).y(t)},c.lineY1=function(){return u().x(e).y(r)},c.lineX1=function(){return u().x(s).y(t)},c.defined=function(h){return arguments.length?(a=typeof h=="function"?h:Qn(!!h),c):a},c.curve=function(h){return arguments.length?(o=h,i!=null&&(l=o(i)),c):o},c.context=function(h){return arguments.length?(h==null?i=l=null:l=o(i=h),c):i},c}class wY{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function A8e(e){return new wY(e,!0)}function T8e(e){return new wY(e,!1)}const iA={draw(e,t){const r=Il(t/Lw);e.moveTo(r,0),e.arc(0,0,r,0,xj)}},P8e={draw(e,t){const r=Il(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},_Y=Il(1/3),O8e=_Y*2,R8e={draw(e,t){const r=Il(t/O8e),s=r*_Y;e.moveTo(0,-r),e.lineTo(s,0),e.lineTo(0,r),e.lineTo(-s,0),e.closePath()}},M8e={draw(e,t){const r=Il(t),s=-r/2;e.rect(s,s,r,r)}},I8e=.8908130915292852,jY=Dw(Lw/10)/Dw(7*Lw/10),D8e=Dw(xj/10)*jY,L8e=-pY(xj/10)*jY,B8e={draw(e,t){const r=Il(t*I8e),s=D8e*r,a=L8e*r;e.moveTo(0,-r),e.lineTo(s,a);for(let i=1;i<5;++i){const o=xj*i/5,l=pY(o),d=Dw(o);e.lineTo(d*r,-l*r),e.lineTo(l*s-d*a,d*s+l*a)}e.closePath()}},Q3=Il(3),$8e={draw(e,t){const r=-Il(t/(Q3*3));e.moveTo(0,r*2),e.lineTo(-Q3*r,-r),e.lineTo(Q3*r,-r),e.closePath()}},jo=-.5,No=Il(3)/2,c5=1/Il(12),F8e=(c5/2+1)*3,z8e={draw(e,t){const r=Il(t/F8e),s=r/2,a=r*c5,i=s,o=r*c5+r,l=-i,d=o;e.moveTo(s,a),e.lineTo(i,o),e.lineTo(l,d),e.lineTo(jo*s-No*a,No*s+jo*a),e.lineTo(jo*i-No*o,No*i+jo*o),e.lineTo(jo*l-No*d,No*l+jo*d),e.lineTo(jo*s+No*a,jo*a-No*s),e.lineTo(jo*i+No*o,jo*o-No*i),e.lineTo(jo*l+No*d,jo*d-No*l),e.closePath()}};function U8e(e,t){let r=null,s=sA(a);e=typeof e=="function"?e:Qn(e||iA),t=typeof t=="function"?t:Qn(t===void 0?64:+t);function a(){let i;if(r||(r=i=s()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Qn(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Qn(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Bw(){}function $w(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function NY(e){this._context=e}NY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$w(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$w(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function V8e(e){return new NY(e)}function SY(e){this._context=e}SY.prototype={areaStart:Bw,areaEnd:Bw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:$w(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function q8e(e){return new SY(e)}function CY(e){this._context=e}CY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,s):this._context.moveTo(r,s);break;case 3:this._point=4;default:$w(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function W8e(e){return new CY(e)}function EY(e){this._context=e}EY.prototype={areaStart:Bw,areaEnd:Bw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function H8e(e){return new EY(e)}function Z7(e){return e<0?-1:1}function Q7(e,t,r){var s=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(s||a<0&&-0),o=(r-e._y1)/(a||s<0&&-0),l=(i*a+o*s)/(s+a);return(Z7(i)+Z7(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function J7(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function J3(e,t,r){var s=e._x0,a=e._y0,i=e._x1,o=e._y1,l=(i-s)/3;e._context.bezierCurveTo(s+l,a+l*t,i-l,o-l*r,i,o)}function Fw(e){this._context=e}Fw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:J3(this,this._t0,J7(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,J3(this,J7(this,r=Q7(this,e,t)),r);break;default:J3(this,this._t0,r=Q7(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function kY(e){this._context=new AY(e)}(kY.prototype=Object.create(Fw.prototype)).point=function(e,t){Fw.prototype.point.call(this,t,e)};function AY(e){this._context=e}AY.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,s,a,i){this._context.bezierCurveTo(t,e,s,r,i,a)}};function G8e(e){return new Fw(e)}function K8e(e){return new kY(e)}function TY(e){this._context=e}TY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var s=eI(e),a=eI(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(s[0][i],a[0][i],s[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function eI(e){var t,r=e.length-1,s,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)s=a[t]/i[t-1],i[t]-=s,o[t]-=s*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function X8e(e){return new TY(e)}function yj(e,t){this._context=e,this._t=t}yj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function Y8e(e){return new yj(e,.5)}function Z8e(e){return new yj(e,0)}function Q8e(e){return new yj(e,1)}function jp(e,t){if((o=e.length)>1)for(var r=1,s,a,i=e[t[0]],o,l=i.length;r<o;++r)for(a=i,i=e[t[r]],s=0;s<l;++s)i[s][1]+=i[s][0]=isNaN(a[s][1])?a[s][0]:a[s][1]}function d5(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function J8e(e,t){return e[t]}function eAe(e){const t=[];return t.key=e,t}function tAe(){var e=Qn([]),t=d5,r=jp,s=J8e;function a(i){var o=Array.from(e.apply(this,arguments),eAe),l,d=o.length,c=-1,u;for(const h of i)for(l=0,++c;l<d;++l)(o[l][c]=[0,+s(h,o[l].key,c,i)]).data=h;for(l=0,u=aA(t(o));l<d;++l)o[u[l]].index=l;return r(o,u),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Qn(Array.from(i)),a):e},a.value=function(i){return arguments.length?(s=typeof i=="function"?i:Qn(+i),a):s},a.order=function(i){return arguments.length?(t=i==null?d5:typeof i=="function"?i:Qn(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??jp,a):r},a}function rAe(e,t){if((s=e.length)>0){for(var r,s,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<s;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<s;++r)e[r][a][1]/=o}jp(e,t)}}function nAe(e,t){if((a=e.length)>0){for(var r=0,s=e[t[0]],a,i=s.length;r<i;++r){for(var o=0,l=0;o<a;++o)l+=e[o][r][1]||0;s[r][1]+=s[r][0]=-l/2}jp(e,t)}}function sAe(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,s=1,a,i,o;s<i;++s){for(var l=0,d=0,c=0;l<o;++l){for(var u=e[t[l]],h=u[s][1]||0,f=u[s-1][1]||0,m=(h-f)/2,p=0;p<l;++p){var g=e[t[p]],x=g[s][1]||0,v=g[s-1][1]||0;m+=x-v}d+=h,c+=m*h}a[s-1][1]+=a[s-1][0]=r,d&&(r-=c/d)}a[s-1][1]+=a[s-1][0]=r,jp(e,t)}}function rv(e){"@babel/helpers - typeof";return rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rv(e)}var aAe=["type","size","sizeType"];function u5(){return u5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},u5.apply(this,arguments)}function tI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function rI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tI(Object(r),!0).forEach(function(s){iAe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tI(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function iAe(e,t,r){return t=oAe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oAe(e){var t=lAe(e,"string");return rv(t)=="symbol"?t:t+""}function lAe(e,t){if(rv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(rv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cAe(e,t){if(e==null)return{};var r=dAe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function dAe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}var PY={symbolCircle:iA,symbolCross:P8e,symbolDiamond:R8e,symbolSquare:M8e,symbolStar:B8e,symbolTriangle:$8e,symbolWye:z8e},uAe=Math.PI/180,hAe=function(t){var r="symbol".concat(gj(t));return PY[r]||iA},fAe=function(t,r,s){if(r==="area")return t;switch(s){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*uAe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},mAe=function(t,r){PY["symbol".concat(gj(t))]=r},oA=function(t){var r=t.type,s=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,o=t.sizeType,l=o===void 0?"area":o,d=cAe(t,aAe),c=rI(rI({},d),{},{type:s,size:i,sizeType:l}),u=function(){var x=hAe(s),v=U8e().type(x).size(fAe(i,l,s));return v()},h=c.className,f=c.cx,m=c.cy,p=on(c,!0);return f===+f&&m===+m&&i===+i?je.createElement("path",u5({},p,{className:pn("recharts-symbols",h),transform:"translate(".concat(f,", ").concat(m,")"),d:u()})):null};oA.registerSymbol=mAe;function Np(e){"@babel/helpers - typeof";return Np=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Np(e)}function h5(){return h5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},h5.apply(this,arguments)}function nI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function pAe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nI(Object(r),!0).forEach(function(s){nv(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nI(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function gAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xAe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,RY(s.key),s)}}function vAe(e,t,r){return t&&xAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function yAe(e,t,r){return t=zw(t),bAe(e,OY()?Reflect.construct(t,r||[],zw(e).constructor):t.apply(e,r))}function bAe(e,t){if(t&&(Np(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wAe(e)}function wAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OY=function(){return!!e})()}function zw(e){return zw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},zw(e)}function _Ae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f5(e,t)}function f5(e,t){return f5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},f5(e,t)}function nv(e,t,r){return t=RY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RY(e){var t=jAe(e,"string");return Np(t)=="symbol"?t:t+""}function jAe(e,t){if(Np(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Np(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var So=32,lA=function(e){function t(){return gAe(this,t),yAe(this,t,arguments)}return _Ae(t,e),vAe(t,[{key:"renderIcon",value:function(s){var a=this.props.inactiveColor,i=So/2,o=So/6,l=So/3,d=s.inactive?a:s.color;if(s.type==="plainline")return je.createElement("line",{strokeWidth:4,fill:"none",stroke:d,strokeDasharray:s.payload.strokeDasharray,x1:0,y1:i,x2:So,y2:i,className:"recharts-legend-icon"});if(s.type==="line")return je.createElement("path",{strokeWidth:4,fill:"none",stroke:d,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(So,"M").concat(2*l,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(s.type==="rect")return je.createElement("path",{stroke:"none",fill:d,d:"M0,".concat(So/8,"h").concat(So,"v").concat(So*3/4,"h").concat(-So,"z"),className:"recharts-legend-icon"});if(je.isValidElement(s.legendIcon)){var c=pAe({},s);return delete c.legendIcon,je.cloneElement(s.legendIcon,c)}return je.createElement(oA,{fill:d,cx:i,cy:i,size:So,sizeType:"diameter",type:s.type})}},{key:"renderItems",value:function(){var s=this,a=this.props,i=a.payload,o=a.iconSize,l=a.layout,d=a.formatter,c=a.inactiveColor,u={x:0,y:0,width:So,height:So},h={display:l==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(m,p){var g=m.formatter||d,x=pn(nv(nv({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",m.inactive));if(m.type==="none")return null;var v=Yr(m.value)?null:m.value;Hc(!Yr(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var y=m.inactive?c:m.color;return je.createElement("li",h5({className:x,style:h,key:"legend-item-".concat(p)},Iw(s.props,m,p)),je.createElement(n5,{width:o,height:o,viewBox:u,style:f},s.renderIcon(m)),je.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},g?g(v,m,p):v))})}},{key:"render",value:function(){var s=this.props,a=s.payload,i=s.layout,o=s.align;if(!a||!a.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return je.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(P.PureComponent);nv(lA,"displayName","Legend");nv(lA,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var NAe=nj;function SAe(){this.__data__=new NAe,this.size=0}var CAe=SAe;function EAe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var kAe=EAe;function AAe(e){return this.__data__.get(e)}var TAe=AAe;function PAe(e){return this.__data__.has(e)}var OAe=PAe,RAe=nj,MAe=X8,IAe=Y8,DAe=200;function LAe(e,t){var r=this.__data__;if(r instanceof RAe){var s=r.__data__;if(!MAe||s.length<DAe-1)return s.push([e,t]),this.size=++r.size,this;r=this.__data__=new IAe(s)}return r.set(e,t),this.size=r.size,this}var BAe=LAe,$Ae=nj,FAe=CAe,zAe=kAe,UAe=TAe,VAe=OAe,qAe=BAe;function Ag(e){var t=this.__data__=new $Ae(e);this.size=t.size}Ag.prototype.clear=FAe;Ag.prototype.delete=zAe;Ag.prototype.get=UAe;Ag.prototype.has=VAe;Ag.prototype.set=qAe;var MY=Ag,WAe="__lodash_hash_undefined__";function HAe(e){return this.__data__.set(e,WAe),this}var GAe=HAe;function KAe(e){return this.__data__.has(e)}var XAe=KAe,YAe=Y8,ZAe=GAe,QAe=XAe;function Uw(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new YAe;++t<r;)this.add(e[t])}Uw.prototype.add=Uw.prototype.push=ZAe;Uw.prototype.has=QAe;var IY=Uw;function JAe(e,t){for(var r=-1,s=e==null?0:e.length;++r<s;)if(t(e[r],r,e))return!0;return!1}var DY=JAe;function eTe(e,t){return e.has(t)}var LY=eTe,tTe=IY,rTe=DY,nTe=LY,sTe=1,aTe=2;function iTe(e,t,r,s,a,i){var o=r&sTe,l=e.length,d=t.length;if(l!=d&&!(o&&d>l))return!1;var c=i.get(e),u=i.get(t);if(c&&u)return c==t&&u==e;var h=-1,f=!0,m=r&aTe?new tTe:void 0;for(i.set(e,t),i.set(t,e);++h<l;){var p=e[h],g=t[h];if(s)var x=o?s(g,p,h,t,e,i):s(p,g,h,e,t,i);if(x!==void 0){if(x)continue;f=!1;break}if(m){if(!rTe(t,function(v,y){if(!nTe(m,y)&&(p===v||a(p,v,r,s,i)))return m.push(y)})){f=!1;break}}else if(!(p===g||a(p,g,r,s,i))){f=!1;break}}return i.delete(e),i.delete(t),f}var BY=iTe,oTe=Ec,lTe=oTe.Uint8Array,cTe=lTe;function dTe(e){var t=-1,r=Array(e.size);return e.forEach(function(s,a){r[++t]=[a,s]}),r}var uTe=dTe;function hTe(e){var t=-1,r=Array(e.size);return e.forEach(function(s){r[++t]=s}),r}var cA=hTe,sI=_1,aI=cTe,fTe=K8,mTe=BY,pTe=uTe,gTe=cA,xTe=1,vTe=2,yTe="[object Boolean]",bTe="[object Date]",wTe="[object Error]",_Te="[object Map]",jTe="[object Number]",NTe="[object RegExp]",STe="[object Set]",CTe="[object String]",ETe="[object Symbol]",kTe="[object ArrayBuffer]",ATe="[object DataView]",iI=sI?sI.prototype:void 0,e4=iI?iI.valueOf:void 0;function TTe(e,t,r,s,a,i,o){switch(r){case ATe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case kTe:return!(e.byteLength!=t.byteLength||!i(new aI(e),new aI(t)));case yTe:case bTe:case jTe:return fTe(+e,+t);case wTe:return e.name==t.name&&e.message==t.message;case NTe:case CTe:return e==t+"";case _Te:var l=pTe;case STe:var d=s&xTe;if(l||(l=gTe),e.size!=t.size&&!d)return!1;var c=o.get(e);if(c)return c==t;s|=vTe,o.set(e,t);var u=mTe(l(e),l(t),s,a,i,o);return o.delete(e),u;case ETe:if(e4)return e4.call(e)==e4.call(t)}return!1}var PTe=TTe;function OTe(e,t){for(var r=-1,s=t.length,a=e.length;++r<s;)e[a+r]=t[r];return e}var $Y=OTe,RTe=$Y,MTe=Ki;function ITe(e,t,r){var s=t(e);return MTe(e)?s:RTe(s,r(e))}var DTe=ITe;function LTe(e,t){for(var r=-1,s=e==null?0:e.length,a=0,i=[];++r<s;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}var BTe=LTe;function $Te(){return[]}var FTe=$Te,zTe=BTe,UTe=FTe,VTe=Object.prototype,qTe=VTe.propertyIsEnumerable,oI=Object.getOwnPropertySymbols,WTe=oI?function(e){return e==null?[]:(e=Object(e),zTe(oI(e),function(t){return qTe.call(e,t)}))}:UTe,HTe=WTe;function GTe(e,t){for(var r=-1,s=Array(e);++r<e;)s[r]=t(r);return s}var KTe=GTe,XTe=pd,YTe=gd,ZTe="[object Arguments]";function QTe(e){return YTe(e)&&XTe(e)==ZTe}var JTe=QTe,lI=JTe,ePe=gd,FY=Object.prototype,tPe=FY.hasOwnProperty,rPe=FY.propertyIsEnumerable,nPe=lI(function(){return arguments}())?lI:function(e){return ePe(e)&&tPe.call(e,"callee")&&!rPe.call(e,"callee")},dA=nPe,Vw={exports:{}};function sPe(){return!1}var aPe=sPe;Vw.exports;(function(e,t){var r=Ec,s=aPe,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===a,l=o?r.Buffer:void 0,d=l?l.isBuffer:void 0,c=d||s;e.exports=c})(Vw,Vw.exports);var zY=Vw.exports,iPe=9007199254740991,oPe=/^(?:0|[1-9]\d*)$/;function lPe(e,t){var r=typeof e;return t=t??iPe,!!t&&(r=="number"||r!="symbol"&&oPe.test(e))&&e>-1&&e%1==0&&e<t}var uA=lPe,cPe=9007199254740991;function dPe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=cPe}var hA=dPe,uPe=pd,hPe=hA,fPe=gd,mPe="[object Arguments]",pPe="[object Array]",gPe="[object Boolean]",xPe="[object Date]",vPe="[object Error]",yPe="[object Function]",bPe="[object Map]",wPe="[object Number]",_Pe="[object Object]",jPe="[object RegExp]",NPe="[object Set]",SPe="[object String]",CPe="[object WeakMap]",EPe="[object ArrayBuffer]",kPe="[object DataView]",APe="[object Float32Array]",TPe="[object Float64Array]",PPe="[object Int8Array]",OPe="[object Int16Array]",RPe="[object Int32Array]",MPe="[object Uint8Array]",IPe="[object Uint8ClampedArray]",DPe="[object Uint16Array]",LPe="[object Uint32Array]",cs={};cs[APe]=cs[TPe]=cs[PPe]=cs[OPe]=cs[RPe]=cs[MPe]=cs[IPe]=cs[DPe]=cs[LPe]=!0;cs[mPe]=cs[pPe]=cs[EPe]=cs[gPe]=cs[kPe]=cs[xPe]=cs[vPe]=cs[yPe]=cs[bPe]=cs[wPe]=cs[_Pe]=cs[jPe]=cs[NPe]=cs[SPe]=cs[CPe]=!1;function BPe(e){return fPe(e)&&hPe(e.length)&&!!cs[uPe(e)]}var $Pe=BPe;function FPe(e){return function(t){return e(t)}}var UY=FPe,qw={exports:{}};qw.exports;(function(e,t){var r=YX,s=t&&!t.nodeType&&t,a=s&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===s,o=i&&r.process,l=function(){try{var d=a&&a.require&&a.require("util").types;return d||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(qw,qw.exports);var zPe=qw.exports,UPe=$Pe,VPe=UY,cI=zPe,dI=cI&&cI.isTypedArray,qPe=dI?VPe(dI):UPe,VY=qPe,WPe=KTe,HPe=dA,GPe=Ki,KPe=zY,XPe=uA,YPe=VY,ZPe=Object.prototype,QPe=ZPe.hasOwnProperty;function JPe(e,t){var r=GPe(e),s=!r&&HPe(e),a=!r&&!s&&KPe(e),i=!r&&!s&&!a&&YPe(e),o=r||s||a||i,l=o?WPe(e.length,String):[],d=l.length;for(var c in e)(t||QPe.call(e,c))&&!(o&&(c=="length"||a&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||XPe(c,d)))&&l.push(c);return l}var eOe=JPe,tOe=Object.prototype;function rOe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||tOe;return e===r}var nOe=rOe;function sOe(e,t){return function(r){return e(t(r))}}var qY=sOe,aOe=qY,iOe=aOe(Object.keys,Object),oOe=iOe,lOe=nOe,cOe=oOe,dOe=Object.prototype,uOe=dOe.hasOwnProperty;function hOe(e){if(!lOe(e))return cOe(e);var t=[];for(var r in Object(e))uOe.call(e,r)&&r!="constructor"&&t.push(r);return t}var fOe=hOe,mOe=G8,pOe=hA;function gOe(e){return e!=null&&pOe(e.length)&&!mOe(e)}var N1=gOe,xOe=eOe,vOe=fOe,yOe=N1;function bOe(e){return yOe(e)?xOe(e):vOe(e)}var bj=bOe,wOe=DTe,_Oe=HTe,jOe=bj;function NOe(e){return wOe(e,jOe,_Oe)}var SOe=NOe,uI=SOe,COe=1,EOe=Object.prototype,kOe=EOe.hasOwnProperty;function AOe(e,t,r,s,a,i){var o=r&COe,l=uI(e),d=l.length,c=uI(t),u=c.length;if(d!=u&&!o)return!1;for(var h=d;h--;){var f=l[h];if(!(o?f in t:kOe.call(t,f)))return!1}var m=i.get(e),p=i.get(t);if(m&&p)return m==t&&p==e;var g=!0;i.set(e,t),i.set(t,e);for(var x=o;++h<d;){f=l[h];var v=e[f],y=t[f];if(s)var b=o?s(y,v,f,t,e,i):s(v,y,f,e,t,i);if(!(b===void 0?v===y||a(v,y,r,s,i):b)){g=!1;break}x||(x=f=="constructor")}if(g&&!x){var j=e.constructor,T=t.constructor;j!=T&&"constructor"in e&&"constructor"in t&&!(typeof j=="function"&&j instanceof j&&typeof T=="function"&&T instanceof T)&&(g=!1)}return i.delete(e),i.delete(t),g}var TOe=AOe,POe=Sf,OOe=Ec,ROe=POe(OOe,"DataView"),MOe=ROe,IOe=Sf,DOe=Ec,LOe=IOe(DOe,"Promise"),BOe=LOe,$Oe=Sf,FOe=Ec,zOe=$Oe(FOe,"Set"),WY=zOe,UOe=Sf,VOe=Ec,qOe=UOe(VOe,"WeakMap"),WOe=qOe,m5=MOe,p5=X8,g5=BOe,x5=WY,v5=WOe,HY=pd,Tg=QX,hI="[object Map]",HOe="[object Object]",fI="[object Promise]",mI="[object Set]",pI="[object WeakMap]",gI="[object DataView]",GOe=Tg(m5),KOe=Tg(p5),XOe=Tg(g5),YOe=Tg(x5),ZOe=Tg(v5),fh=HY;(m5&&fh(new m5(new ArrayBuffer(1)))!=gI||p5&&fh(new p5)!=hI||g5&&fh(g5.resolve())!=fI||x5&&fh(new x5)!=mI||v5&&fh(new v5)!=pI)&&(fh=function(e){var t=HY(e),r=t==HOe?e.constructor:void 0,s=r?Tg(r):"";if(s)switch(s){case GOe:return gI;case KOe:return hI;case XOe:return fI;case YOe:return mI;case ZOe:return pI}return t});var QOe=fh,t4=MY,JOe=BY,eRe=PTe,tRe=TOe,xI=QOe,vI=Ki,yI=zY,rRe=VY,nRe=1,bI="[object Arguments]",wI="[object Array]",Dy="[object Object]",sRe=Object.prototype,_I=sRe.hasOwnProperty;function aRe(e,t,r,s,a,i){var o=vI(e),l=vI(t),d=o?wI:xI(e),c=l?wI:xI(t);d=d==bI?Dy:d,c=c==bI?Dy:c;var u=d==Dy,h=c==Dy,f=d==c;if(f&&yI(e)){if(!yI(t))return!1;o=!0,u=!1}if(f&&!u)return i||(i=new t4),o||rRe(e)?JOe(e,t,r,s,a,i):eRe(e,t,d,r,s,a,i);if(!(r&nRe)){var m=u&&_I.call(e,"__wrapped__"),p=h&&_I.call(t,"__wrapped__");if(m||p){var g=m?e.value():e,x=p?t.value():t;return i||(i=new t4),a(g,x,r,s,i)}}return f?(i||(i=new t4),tRe(e,t,r,s,a,i)):!1}var iRe=aRe,oRe=iRe,jI=gd;function GY(e,t,r,s,a){return e===t?!0:e==null||t==null||!jI(e)&&!jI(t)?e!==e&&t!==t:oRe(e,t,r,s,GY,a)}var fA=GY,lRe=MY,cRe=fA,dRe=1,uRe=2;function hRe(e,t,r,s){var a=r.length,i=a,o=!s;if(e==null)return!i;for(e=Object(e);a--;){var l=r[a];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++a<i;){l=r[a];var d=l[0],c=e[d],u=l[1];if(o&&l[2]){if(c===void 0&&!(d in e))return!1}else{var h=new lRe;if(s)var f=s(c,u,d,e,t,h);if(!(f===void 0?cRe(u,c,dRe|uRe,s,h):f))return!1}}return!0}var fRe=hRe,mRe=Uu;function pRe(e){return e===e&&!mRe(e)}var KY=pRe,gRe=KY,xRe=bj;function vRe(e){for(var t=xRe(e),r=t.length;r--;){var s=t[r],a=e[s];t[r]=[s,a,gRe(a)]}return t}var yRe=vRe;function bRe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var XY=bRe,wRe=fRe,_Re=yRe,jRe=XY;function NRe(e){var t=_Re(e);return t.length==1&&t[0][2]?jRe(t[0][0],t[0][1]):function(r){return r===e||wRe(r,e,t)}}var SRe=NRe;function CRe(e,t){return e!=null&&t in Object(e)}var ERe=CRe,kRe=nY,ARe=dA,TRe=Ki,PRe=uA,ORe=hA,RRe=aj;function MRe(e,t,r){t=kRe(t,e);for(var s=-1,a=t.length,i=!1;++s<a;){var o=RRe(t[s]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++s!=a?i:(a=e==null?0:e.length,!!a&&ORe(a)&&PRe(o,a)&&(TRe(e)||ARe(e)))}var IRe=MRe,DRe=ERe,LRe=IRe;function BRe(e,t){return e!=null&&LRe(e,t,DRe)}var $Re=BRe,FRe=fA,zRe=sY,URe=$Re,VRe=H8,qRe=KY,WRe=XY,HRe=aj,GRe=1,KRe=2;function XRe(e,t){return VRe(e)&&qRe(t)?WRe(HRe(e),t):function(r){var s=zRe(r,e);return s===void 0&&s===t?URe(r,e):FRe(t,s,GRe|KRe)}}var YRe=XRe;function ZRe(e){return e}var Pg=ZRe;function QRe(e){return function(t){return t==null?void 0:t[e]}}var JRe=QRe,eMe=J8;function tMe(e){return function(t){return eMe(t,e)}}var rMe=tMe,nMe=JRe,sMe=rMe,aMe=H8,iMe=aj;function oMe(e){return aMe(e)?nMe(iMe(e)):sMe(e)}var lMe=oMe,cMe=SRe,dMe=YRe,uMe=Pg,hMe=Ki,fMe=lMe;function mMe(e){return typeof e=="function"?e:e==null?uMe:typeof e=="object"?hMe(e)?dMe(e[0],e[1]):cMe(e):fMe(e)}var Vu=mMe;function pMe(e,t,r,s){for(var a=e.length,i=r+(s?1:-1);s?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var YY=pMe;function gMe(e){return e!==e}var xMe=gMe;function vMe(e,t,r){for(var s=r-1,a=e.length;++s<a;)if(e[s]===t)return s;return-1}var yMe=vMe,bMe=YY,wMe=xMe,_Me=yMe;function jMe(e,t,r){return t===t?_Me(e,t,r):bMe(e,wMe,r)}var NMe=jMe,SMe=NMe;function CMe(e,t){var r=e==null?0:e.length;return!!r&&SMe(e,t,0)>-1}var EMe=CMe;function kMe(e,t,r){for(var s=-1,a=e==null?0:e.length;++s<a;)if(r(t,e[s]))return!0;return!1}var AMe=kMe;function TMe(){}var PMe=TMe,r4=WY,OMe=PMe,RMe=cA,MMe=1/0,IMe=r4&&1/RMe(new r4([,-0]))[1]==MMe?function(e){return new r4(e)}:OMe,DMe=IMe,LMe=IY,BMe=EMe,$Me=AMe,FMe=LY,zMe=DMe,UMe=cA,VMe=200;function qMe(e,t,r){var s=-1,a=BMe,i=e.length,o=!0,l=[],d=l;if(r)o=!1,a=$Me;else if(i>=VMe){var c=t?null:zMe(e);if(c)return UMe(c);o=!1,a=FMe,d=new LMe}else d=t?[]:l;e:for(;++s<i;){var u=e[s],h=t?t(u):u;if(u=r||u!==0?u:0,o&&h===h){for(var f=d.length;f--;)if(d[f]===h)continue e;t&&d.push(h),l.push(u)}else a(d,h,r)||(d!==l&&d.push(h),l.push(u))}return l}var WMe=qMe,HMe=Vu,GMe=WMe;function KMe(e,t){return e&&e.length?GMe(e,HMe(t)):[]}var XMe=KMe;const NI=Ln(XMe);function ZY(e,t,r){return t===!0?NI(e,r):Yr(t)?NI(e,t):e}function Sp(e){"@babel/helpers - typeof";return Sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sp(e)}var YMe=["ref"];function SI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Oc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SI(Object(r),!0).forEach(function(s){wj(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SI(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function ZMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CI(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,JY(s.key),s)}}function QMe(e,t,r){return t&&CI(e.prototype,t),r&&CI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function JMe(e,t,r){return t=Ww(t),e7e(e,QY()?Reflect.construct(t,r||[],Ww(e).constructor):t.apply(e,r))}function e7e(e,t){if(t&&(Sp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return t7e(e)}function t7e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QY(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QY=function(){return!!e})()}function Ww(e){return Ww=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Ww(e)}function r7e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&y5(e,t)}function y5(e,t){return y5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},y5(e,t)}function wj(e,t,r){return t=JY(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JY(e){var t=n7e(e,"string");return Sp(t)=="symbol"?t:t+""}function n7e(e,t){if(Sp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Sp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function s7e(e,t){if(e==null)return{};var r=a7e(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function a7e(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function i7e(e){return e.value}function o7e(e,t){if(je.isValidElement(e))return je.cloneElement(e,t);if(typeof e=="function")return je.createElement(e,t);t.ref;var r=s7e(t,YMe);return je.createElement(lA,r)}var EI=1,$h=function(e){function t(){var r;ZMe(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return r=JMe(this,t,[].concat(a)),wj(r,"lastBoundingBox",{width:-1,height:-1}),r}return r7e(t,e),QMe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();return s.height=this.wrapperNode.offsetHeight,s.width=this.wrapperNode.offsetWidth,s}return null}},{key:"updateBBox",value:function(){var s=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>EI||Math.abs(a.height-this.lastBoundingBox.height)>EI)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,s&&s(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,s&&s(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?Oc({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(s){var a=this.props,i=a.layout,o=a.align,l=a.verticalAlign,d=a.margin,c=a.chartWidth,u=a.chartHeight,h,f;if(!s||(s.left===void 0||s.left===null)&&(s.right===void 0||s.right===null))if(o==="center"&&i==="vertical"){var m=this.getBBoxSnapshot();h={left:((c||0)-m.width)/2}}else h=o==="right"?{right:d&&d.right||0}:{left:d&&d.left||0};if(!s||(s.top===void 0||s.top===null)&&(s.bottom===void 0||s.bottom===null))if(l==="middle"){var p=this.getBBoxSnapshot();f={top:((u||0)-p.height)/2}}else f=l==="bottom"?{bottom:d&&d.bottom||0}:{top:d&&d.top||0};return Oc(Oc({},h),f)}},{key:"render",value:function(){var s=this,a=this.props,i=a.content,o=a.width,l=a.height,d=a.wrapperStyle,c=a.payloadUniqBy,u=a.payload,h=Oc(Oc({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(d)),d);return je.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(m){s.wrapperNode=m}},o7e(i,Oc(Oc({},this.props),{},{payload:ZY(u,c,i7e)})))}}],[{key:"getWithHeight",value:function(s,a){var i=Oc(Oc({},this.defaultProps),s.props),o=i.layout;return o==="vertical"&&Kt(s.props.height)?{height:s.props.height}:o==="horizontal"?{width:s.props.width||a}:null}}])}(P.PureComponent);wj($h,"displayName","Legend");wj($h,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var kI=_1,l7e=dA,c7e=Ki,AI=kI?kI.isConcatSpreadable:void 0;function d7e(e){return c7e(e)||l7e(e)||!!(AI&&e&&e[AI])}var u7e=d7e,h7e=$Y,f7e=u7e;function eZ(e,t,r,s,a){var i=-1,o=e.length;for(r||(r=f7e),a||(a=[]);++i<o;){var l=e[i];t>0&&r(l)?t>1?eZ(l,t-1,r,s,a):h7e(a,l):s||(a[a.length]=l)}return a}var tZ=eZ;function m7e(e){return function(t,r,s){for(var a=-1,i=Object(t),o=s(t),l=o.length;l--;){var d=o[e?l:++a];if(r(i[d],d,i)===!1)break}return t}}var p7e=m7e,g7e=p7e,x7e=g7e(),v7e=x7e,y7e=v7e,b7e=bj;function w7e(e,t){return e&&y7e(e,t,b7e)}var rZ=w7e,_7e=N1;function j7e(e,t){return function(r,s){if(r==null)return r;if(!_7e(r))return e(r,s);for(var a=r.length,i=t?a:-1,o=Object(r);(t?i--:++i<a)&&s(o[i],i,o)!==!1;);return r}}var N7e=j7e,S7e=rZ,C7e=N7e,E7e=C7e(S7e),mA=E7e,k7e=mA,A7e=N1;function T7e(e,t){var r=-1,s=A7e(e)?Array(e.length):[];return k7e(e,function(a,i,o){s[++r]=t(a,i,o)}),s}var nZ=T7e;function P7e(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var O7e=P7e,TI=jg;function R7e(e,t){if(e!==t){var r=e!==void 0,s=e===null,a=e===e,i=TI(e),o=t!==void 0,l=t===null,d=t===t,c=TI(t);if(!l&&!c&&!i&&e>t||i&&o&&d&&!l&&!c||s&&o&&d||!r&&d||!a)return 1;if(!s&&!i&&!c&&e<t||c&&r&&a&&!s&&!i||l&&r&&a||!o&&a||!d)return-1}return 0}var M7e=R7e,I7e=M7e;function D7e(e,t,r){for(var s=-1,a=e.criteria,i=t.criteria,o=a.length,l=r.length;++s<o;){var d=I7e(a[s],i[s]);if(d){if(s>=l)return d;var c=r[s];return d*(c=="desc"?-1:1)}}return e.index-t.index}var L7e=D7e,n4=Q8,B7e=J8,$7e=Vu,F7e=nZ,z7e=O7e,U7e=UY,V7e=L7e,q7e=Pg,W7e=Ki;function H7e(e,t,r){t.length?t=n4(t,function(i){return W7e(i)?function(o){return B7e(o,i.length===1?i[0]:i)}:i}):t=[q7e];var s=-1;t=n4(t,U7e($7e));var a=F7e(e,function(i,o,l){var d=n4(t,function(c){return c(i)});return{criteria:d,index:++s,value:i}});return z7e(a,function(i,o){return V7e(i,o,r)})}var G7e=H7e;function K7e(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var X7e=K7e,Y7e=X7e,PI=Math.max;function Z7e(e,t,r){return t=PI(t===void 0?e.length-1:t,0),function(){for(var s=arguments,a=-1,i=PI(s.length-t,0),o=Array(i);++a<i;)o[a]=s[t+a];a=-1;for(var l=Array(t+1);++a<t;)l[a]=s[a];return l[t]=r(o),Y7e(e,this,l)}}var Q7e=Z7e;function J7e(e){return function(){return e}}var eIe=J7e,tIe=Sf,rIe=function(){try{var e=tIe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),sZ=rIe,nIe=eIe,OI=sZ,sIe=Pg,aIe=OI?function(e,t){return OI(e,"toString",{configurable:!0,enumerable:!1,value:nIe(t),writable:!0})}:sIe,iIe=aIe,oIe=800,lIe=16,cIe=Date.now;function dIe(e){var t=0,r=0;return function(){var s=cIe(),a=lIe-(s-r);if(r=s,a>0){if(++t>=oIe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var uIe=dIe,hIe=iIe,fIe=uIe,mIe=fIe(hIe),pIe=mIe,gIe=Pg,xIe=Q7e,vIe=pIe;function yIe(e,t){return vIe(xIe(e,t,gIe),e+"")}var bIe=yIe,wIe=K8,_Ie=N1,jIe=uA,NIe=Uu;function SIe(e,t,r){if(!NIe(r))return!1;var s=typeof t;return(s=="number"?_Ie(r)&&jIe(t,r.length):s=="string"&&t in r)?wIe(r[t],e):!1}var _j=SIe,CIe=tZ,EIe=G7e,kIe=bIe,RI=_j,AIe=kIe(function(e,t){if(e==null)return[];var r=t.length;return r>1&&RI(e,t[0],t[1])?t=[]:r>2&&RI(t[0],t[1],t[2])&&(t=[t[0]]),EIe(e,CIe(t,1),[])}),TIe=AIe;const pA=Ln(TIe);function sv(e){"@babel/helpers - typeof";return sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sv(e)}function b5(){return b5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},b5.apply(this,arguments)}function PIe(e,t){return IIe(e)||MIe(e,t)||RIe(e,t)||OIe()}function OIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RIe(e,t){if(e){if(typeof e=="string")return MI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return MI(e,t)}}function MI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function MIe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,l=[],d=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(l.push(s.value),l.length!==t);d=!0);}catch(u){c=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function IIe(e){if(Array.isArray(e))return e}function II(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function s4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?II(Object(r),!0).forEach(function(s){DIe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):II(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function DIe(e,t,r){return t=LIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LIe(e){var t=BIe(e,"string");return sv(t)=="symbol"?t:t+""}function BIe(e,t){if(sv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(sv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $Ie(e){return Array.isArray(e)&&ha(e[0])&&ha(e[1])?e.join(" ~ "):e}var FIe=function(t){var r=t.separator,s=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,o=t.itemStyle,l=o===void 0?{}:o,d=t.labelStyle,c=d===void 0?{}:d,u=t.payload,h=t.formatter,f=t.itemSorter,m=t.wrapperClassName,p=t.labelClassName,g=t.label,x=t.labelFormatter,v=t.accessibilityLayer,y=v===void 0?!1:v,b=function(){if(u&&u.length){var G={padding:0,margin:0},I=(f?pA(u,f):u).map(function(F,S){if(F.type==="none")return null;var E=s4({display:"block",paddingTop:4,paddingBottom:4,color:F.color||"#000"},l),N=F.formatter||h||$Ie,C=F.value,k=F.name,M=C,U=k;if(N&&M!=null&&U!=null){var $=N(C,k,F,S,u);if(Array.isArray($)){var X=PIe($,2);M=X[0],U=X[1]}else M=$}return je.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(S),style:E},ha(U)?je.createElement("span",{className:"recharts-tooltip-item-name"},U):null,ha(U)?je.createElement("span",{className:"recharts-tooltip-item-separator"},s):null,je.createElement("span",{className:"recharts-tooltip-item-value"},M),je.createElement("span",{className:"recharts-tooltip-item-unit"},F.unit||""))});return je.createElement("ul",{className:"recharts-tooltip-item-list",style:G},I)}return null},j=s4({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),T=s4({margin:0},c),O=!un(g),R=O?g:"",D=pn("recharts-default-tooltip",m),B=pn("recharts-tooltip-label",p);O&&x&&u!==void 0&&u!==null&&(R=x(g,u));var q=y?{role:"status","aria-live":"assertive"}:{};return je.createElement("div",b5({className:D,style:j},q),je.createElement("p",{className:B,style:T},je.isValidElement(R)?R:"".concat(R)),b())};function av(e){"@babel/helpers - typeof";return av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},av(e)}function Ly(e,t,r){return t=zIe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zIe(e){var t=UIe(e,"string");return av(t)=="symbol"?t:t+""}function UIe(e,t){if(av(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(av(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h0="recharts-tooltip-wrapper",VIe={visibility:"hidden"};function qIe(e){var t=e.coordinate,r=e.translateX,s=e.translateY;return pn(h0,Ly(Ly(Ly(Ly({},"".concat(h0,"-right"),Kt(r)&&t&&Kt(t.x)&&r>=t.x),"".concat(h0,"-left"),Kt(r)&&t&&Kt(t.x)&&r<t.x),"".concat(h0,"-bottom"),Kt(s)&&t&&Kt(t.y)&&s>=t.y),"".concat(h0,"-top"),Kt(s)&&t&&Kt(t.y)&&s<t.y))}function DI(e){var t=e.allowEscapeViewBox,r=e.coordinate,s=e.key,a=e.offsetTopLeft,i=e.position,o=e.reverseDirection,l=e.tooltipDimension,d=e.viewBox,c=e.viewBoxDimension;if(i&&Kt(i[s]))return i[s];var u=r[s]-l-a,h=r[s]+a;if(t[s])return o[s]?u:h;if(o[s]){var f=u,m=d[s];return f<m?Math.max(h,d[s]):Math.max(u,d[s])}var p=h+l,g=d[s]+c;return p>g?Math.max(u,d[s]):Math.max(h,d[s])}function WIe(e){var t=e.translateX,r=e.translateY,s=e.useTranslate3d;return{transform:s?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function HIe(e){var t=e.allowEscapeViewBox,r=e.coordinate,s=e.offsetTopLeft,a=e.position,i=e.reverseDirection,o=e.tooltipBox,l=e.useTranslate3d,d=e.viewBox,c,u,h;return o.height>0&&o.width>0&&r?(u=DI({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:d,viewBoxDimension:d.width}),h=DI({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:d,viewBoxDimension:d.height}),c=WIe({translateX:u,translateY:h,useTranslate3d:l})):c=VIe,{cssProperties:c,cssClasses:qIe({translateX:u,translateY:h,coordinate:r})}}function Cp(e){"@babel/helpers - typeof";return Cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cp(e)}function LI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function BI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LI(Object(r),!0).forEach(function(s){_5(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LI(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function GIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KIe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,iZ(s.key),s)}}function XIe(e,t,r){return t&&KIe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function YIe(e,t,r){return t=Hw(t),ZIe(e,aZ()?Reflect.construct(t,r||[],Hw(e).constructor):t.apply(e,r))}function ZIe(e,t){if(t&&(Cp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return QIe(e)}function QIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aZ=function(){return!!e})()}function Hw(e){return Hw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Hw(e)}function JIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&w5(e,t)}function w5(e,t){return w5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},w5(e,t)}function _5(e,t,r){return t=iZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iZ(e){var t=e9e(e,"string");return Cp(t)=="symbol"?t:t+""}function e9e(e,t){if(Cp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Cp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $I=1,t9e=function(e){function t(){var r;GIe(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return r=YIe(this,t,[].concat(a)),_5(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),_5(r,"handleKeyDown",function(o){if(o.key==="Escape"){var l,d,c,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(d=r.props.coordinate)===null||d===void 0?void 0:d.x)!==null&&l!==void 0?l:0,y:(c=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&c!==void 0?c:0}})}}),r}return JIe(t,e),XIe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();(Math.abs(s.width-this.state.lastBoundingBox.width)>$I||Math.abs(s.height-this.state.lastBoundingBox.height)>$I)&&this.setState({lastBoundingBox:{width:s.width,height:s.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var s,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var s=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,l=a.animationDuration,d=a.animationEasing,c=a.children,u=a.coordinate,h=a.hasPayload,f=a.isAnimationActive,m=a.offset,p=a.position,g=a.reverseDirection,x=a.useTranslate3d,v=a.viewBox,y=a.wrapperStyle,b=HIe({allowEscapeViewBox:o,coordinate:u,offsetTopLeft:m,position:p,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:x,viewBox:v}),j=b.cssClasses,T=b.cssProperties,O=BI(BI({transition:f&&i?"transform ".concat(l,"ms ").concat(d):void 0},T),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&h?"visible":"hidden",position:"absolute",top:0,left:0},y);return je.createElement("div",{tabIndex:-1,className:j,style:O,ref:function(D){s.wrapperNode=D}},c)}}])}(P.PureComponent),r9e=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Gc={isSsr:r9e(),get:function(t){return Gc[t]},set:function(t,r){if(typeof t=="string")Gc[t]=r;else{var s=Object.keys(t);s&&s.length&&s.forEach(function(a){Gc[a]=t[a]})}}};function Ep(e){"@babel/helpers - typeof";return Ep=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ep(e)}function FI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function zI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FI(Object(r),!0).forEach(function(s){gA(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FI(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function n9e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s9e(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,lZ(s.key),s)}}function a9e(e,t,r){return t&&s9e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function i9e(e,t,r){return t=Gw(t),o9e(e,oZ()?Reflect.construct(t,r||[],Gw(e).constructor):t.apply(e,r))}function o9e(e,t){if(t&&(Ep(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return l9e(e)}function l9e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oZ=function(){return!!e})()}function Gw(e){return Gw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Gw(e)}function c9e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j5(e,t)}function j5(e,t){return j5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},j5(e,t)}function gA(e,t,r){return t=lZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lZ(e){var t=d9e(e,"string");return Ep(t)=="symbol"?t:t+""}function d9e(e,t){if(Ep(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Ep(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function u9e(e){return e.dataKey}function h9e(e,t){return je.isValidElement(e)?je.cloneElement(e,t):typeof e=="function"?je.createElement(e,t):je.createElement(FIe,t)}var Vl=function(e){function t(){return n9e(this,t),i9e(this,t,arguments)}return c9e(t,e),a9e(t,[{key:"render",value:function(){var s=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,l=a.animationDuration,d=a.animationEasing,c=a.content,u=a.coordinate,h=a.filterNull,f=a.isAnimationActive,m=a.offset,p=a.payload,g=a.payloadUniqBy,x=a.position,v=a.reverseDirection,y=a.useTranslate3d,b=a.viewBox,j=a.wrapperStyle,T=p??[];h&&T.length&&(T=ZY(p.filter(function(R){return R.value!=null&&(R.hide!==!0||s.props.includeHidden)}),g,u9e));var O=T.length>0;return je.createElement(t9e,{allowEscapeViewBox:o,animationDuration:l,animationEasing:d,isAnimationActive:f,active:i,coordinate:u,hasPayload:O,offset:m,position:x,reverseDirection:v,useTranslate3d:y,viewBox:b,wrapperStyle:j},h9e(c,zI(zI({},this.props),{},{payload:T})))}}])}(P.PureComponent);gA(Vl,"displayName","Tooltip");gA(Vl,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Gc.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var f9e=Ec,m9e=function(){return f9e.Date.now()},p9e=m9e,g9e=/\s/;function x9e(e){for(var t=e.length;t--&&g9e.test(e.charAt(t)););return t}var v9e=x9e,y9e=v9e,b9e=/^\s+/;function w9e(e){return e&&e.slice(0,y9e(e)+1).replace(b9e,"")}var _9e=w9e,j9e=_9e,UI=Uu,N9e=jg,VI=NaN,S9e=/^[-+]0x[0-9a-f]+$/i,C9e=/^0b[01]+$/i,E9e=/^0o[0-7]+$/i,k9e=parseInt;function A9e(e){if(typeof e=="number")return e;if(N9e(e))return VI;if(UI(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=UI(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=j9e(e);var r=C9e.test(e);return r||E9e.test(e)?k9e(e.slice(2),r?2:8):S9e.test(e)?VI:+e}var cZ=A9e,T9e=Uu,a4=p9e,qI=cZ,P9e="Expected a function",O9e=Math.max,R9e=Math.min;function M9e(e,t,r){var s,a,i,o,l,d,c=0,u=!1,h=!1,f=!0;if(typeof e!="function")throw new TypeError(P9e);t=qI(t)||0,T9e(r)&&(u=!!r.leading,h="maxWait"in r,i=h?O9e(qI(r.maxWait)||0,t):i,f="trailing"in r?!!r.trailing:f);function m(O){var R=s,D=a;return s=a=void 0,c=O,o=e.apply(D,R),o}function p(O){return c=O,l=setTimeout(v,t),u?m(O):o}function g(O){var R=O-d,D=O-c,B=t-R;return h?R9e(B,i-D):B}function x(O){var R=O-d,D=O-c;return d===void 0||R>=t||R<0||h&&D>=i}function v(){var O=a4();if(x(O))return y(O);l=setTimeout(v,g(O))}function y(O){return l=void 0,f&&s?m(O):(s=a=void 0,o)}function b(){l!==void 0&&clearTimeout(l),c=0,s=d=a=l=void 0}function j(){return l===void 0?o:y(a4())}function T(){var O=a4(),R=x(O);if(s=arguments,a=this,d=O,R){if(l===void 0)return p(d);if(h)return clearTimeout(l),l=setTimeout(v,t),m(d)}return l===void 0&&(l=setTimeout(v,t)),o}return T.cancel=b,T.flush=j,T}var I9e=M9e,D9e=I9e,L9e=Uu,B9e="Expected a function";function $9e(e,t,r){var s=!0,a=!0;if(typeof e!="function")throw new TypeError(B9e);return L9e(r)&&(s="leading"in r?!!r.leading:s,a="trailing"in r?!!r.trailing:a),D9e(e,t,{leading:s,maxWait:t,trailing:a})}var F9e=$9e;const dZ=Ln(F9e);function iv(e){"@babel/helpers - typeof";return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iv(e)}function WI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function By(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WI(Object(r),!0).forEach(function(s){z9e(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WI(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function z9e(e,t,r){return t=U9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U9e(e){var t=V9e(e,"string");return iv(t)=="symbol"?t:t+""}function V9e(e,t){if(iv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(iv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q9e(e,t){return K9e(e)||G9e(e,t)||H9e(e,t)||W9e()}function W9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H9e(e,t){if(e){if(typeof e=="string")return HI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return HI(e,t)}}function HI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function G9e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,l=[],d=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(l.push(s.value),l.length!==t);d=!0);}catch(u){c=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function K9e(e){if(Array.isArray(e))return e}var X9e=P.forwardRef(function(e,t){var r=e.aspect,s=e.initialDimension,a=s===void 0?{width:-1,height:-1}:s,i=e.width,o=i===void 0?"100%":i,l=e.height,d=l===void 0?"100%":l,c=e.minWidth,u=c===void 0?0:c,h=e.minHeight,f=e.maxHeight,m=e.children,p=e.debounce,g=p===void 0?0:p,x=e.id,v=e.className,y=e.onResize,b=e.style,j=b===void 0?{}:b,T=P.useRef(null),O=P.useRef();O.current=y,P.useImperativeHandle(t,function(){return Object.defineProperty(T.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),T.current},configurable:!0})});var R=P.useState({containerWidth:a.width,containerHeight:a.height}),D=q9e(R,2),B=D[0],q=D[1],Y=P.useCallback(function(I,F){q(function(S){var E=Math.round(I),N=Math.round(F);return S.containerWidth===E&&S.containerHeight===N?S:{containerWidth:E,containerHeight:N}})},[]);P.useEffect(function(){var I=function(k){var M,U=k[0].contentRect,$=U.width,X=U.height;Y($,X),(M=O.current)===null||M===void 0||M.call(O,$,X)};g>0&&(I=dZ(I,g,{trailing:!0,leading:!1}));var F=new ResizeObserver(I),S=T.current.getBoundingClientRect(),E=S.width,N=S.height;return Y(E,N),F.observe(T.current),function(){F.disconnect()}},[Y,g]);var G=P.useMemo(function(){var I=B.containerWidth,F=B.containerHeight;if(I<0||F<0)return null;Hc(jh(o)||jh(d),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,d),Hc(!r||r>0,"The aspect(%s) must be greater than zero.",r);var S=jh(o)?I:o,E=jh(d)?F:d;r&&r>0&&(S?E=S/r:E&&(S=E*r),f&&E>f&&(E=f)),Hc(S>0||E>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,S,E,o,d,u,h,r);var N=!Array.isArray(m)&&Wc(m.type).endsWith("Chart");return je.Children.map(m,function(C){return je.isValidElement(C)?P.cloneElement(C,By({width:S,height:E},N?{style:By({height:"100%",width:"100%",maxHeight:E,maxWidth:S},C.props.style)}:{})):C})},[r,m,d,f,h,u,B,o]);return je.createElement("div",{id:x?"".concat(x):void 0,className:pn("recharts-responsive-container",v),style:By(By({},j),{},{width:o,height:d,minWidth:u,minHeight:h,maxHeight:f}),ref:T},G)}),uZ=function(t){return null};uZ.displayName="Cell";function ov(e){"@babel/helpers - typeof";return ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ov(e)}function GI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function N5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GI(Object(r),!0).forEach(function(s){Y9e(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GI(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Y9e(e,t,r){return t=Z9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z9e(e){var t=Q9e(e,"string");return ov(t)=="symbol"?t:t+""}function Q9e(e,t){if(ov(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(ov(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yf={widthCache:{},cacheCount:0},J9e=2e3,eDe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},KI="recharts_measurement_span";function tDe(e){var t=N5({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var ex=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Gc.isSsr)return{width:0,height:0};var s=tDe(r),a=JSON.stringify({text:t,copyStyle:s});if(Yf.widthCache[a])return Yf.widthCache[a];try{var i=document.getElementById(KI);i||(i=document.createElement("span"),i.setAttribute("id",KI),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=N5(N5({},eDe),s);Object.assign(i.style,o),i.textContent="".concat(t);var l=i.getBoundingClientRect(),d={width:l.width,height:l.height};return Yf.widthCache[a]=d,++Yf.cacheCount>J9e&&(Yf.cacheCount=0,Yf.widthCache={}),d}catch{return{width:0,height:0}}},rDe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function lv(e){"@babel/helpers - typeof";return lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lv(e)}function Kw(e,t){return iDe(e)||aDe(e,t)||sDe(e,t)||nDe()}function nDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sDe(e,t){if(e){if(typeof e=="string")return XI(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XI(e,t)}}function XI(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function aDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,l=[],d=!0,c=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;d=!1}else for(;!(d=(s=i.call(r)).done)&&(l.push(s.value),l.length!==t);d=!0);}catch(u){c=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function iDe(e){if(Array.isArray(e))return e}function oDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function YI(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,cDe(s.key),s)}}function lDe(e,t,r){return t&&YI(e.prototype,t),r&&YI(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function cDe(e){var t=dDe(e,"string");return lv(t)=="symbol"?t:t+""}function dDe(e,t){if(lv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(lv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var ZI=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,QI=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,uDe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,hDe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,hZ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},fDe=Object.keys(hZ),Nm="NaN";function mDe(e,t){return e*hZ[t]}var $y=function(){function e(t,r){oDe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!uDe.test(r)&&(this.num=NaN,this.unit=""),fDe.includes(r)&&(this.num=mDe(t,r),this.unit="px")}return lDe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var s,a=(s=hDe.exec(r))!==null&&s!==void 0?s:[],i=Kw(a,3),o=i[1],l=i[2];return new e(parseFloat(o),l??"")}}])}();function fZ(e){if(e.includes(Nm))return Nm;for(var t=e;t.includes("*")||t.includes("/");){var r,s=(r=ZI.exec(t))!==null&&r!==void 0?r:[],a=Kw(s,4),i=a[1],o=a[2],l=a[3],d=$y.parse(i??""),c=$y.parse(l??""),u=o==="*"?d.multiply(c):d.divide(c);if(u.isNaN())return Nm;t=t.replace(ZI,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var h,f=(h=QI.exec(t))!==null&&h!==void 0?h:[],m=Kw(f,4),p=m[1],g=m[2],x=m[3],v=$y.parse(p??""),y=$y.parse(x??""),b=g==="+"?v.add(y):v.subtract(y);if(b.isNaN())return Nm;t=t.replace(QI,b.toString())}return t}var JI=/\(([^()]*)\)/;function pDe(e){for(var t=e;t.includes("(");){var r=JI.exec(t),s=Kw(r,2),a=s[1];t=t.replace(JI,fZ(a))}return t}function gDe(e){var t=e.replace(/\s+/g,"");return t=pDe(t),t=fZ(t),t}function xDe(e){try{return gDe(e)}catch{return Nm}}function i4(e){var t=xDe(e.slice(5,-1));return t===Nm?"":t}var vDe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],yDe=["dx","dy","angle","className","breakAll"];function S5(){return S5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},S5.apply(this,arguments)}function e9(e,t){if(e==null)return{};var r=bDe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function bDe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function t9(e,t){return NDe(e)||jDe(e,t)||_De(e,t)||wDe()}function wDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _De(e,t){if(e){if(typeof e=="string")return r9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return r9(e,t)}}function r9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function jDe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,l=[],d=!0,c=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;d=!1}else for(;!(d=(s=i.call(r)).done)&&(l.push(s.value),l.length!==t);d=!0);}catch(u){c=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function NDe(e){if(Array.isArray(e))return e}var mZ=/[ \f\n\r\t\v\u2028\u2029]+/,pZ=function(t){var r=t.children,s=t.breakAll,a=t.style;try{var i=[];un(r)||(s?i=r.toString().split(""):i=r.toString().split(mZ));var o=i.map(function(d){return{word:d,width:ex(d,a).width}}),l=s?0:ex("",a).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch{return null}},SDe=function(t,r,s,a,i){var o=t.maxLines,l=t.children,d=t.style,c=t.breakAll,u=Kt(o),h=l,f=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return S.reduce(function(E,N){var C=N.word,k=N.width,M=E[E.length-1];if(M&&(a==null||i||M.width+k+s<Number(a)))M.words.push(C),M.width+=k+s;else{var U={words:[C],width:k};E.push(U)}return E},[])},m=f(r),p=function(S){return S.reduce(function(E,N){return E.width>N.width?E:N})};if(!u)return m;for(var g="",x=function(S){var E=h.slice(0,S),N=pZ({breakAll:c,style:d,children:E+g}).wordsWithComputedWidth,C=f(N),k=C.length>o||p(C).width>Number(a);return[k,C]},v=0,y=h.length-1,b=0,j;v<=y&&b<=h.length-1;){var T=Math.floor((v+y)/2),O=T-1,R=x(O),D=t9(R,2),B=D[0],q=D[1],Y=x(T),G=t9(Y,1),I=G[0];if(!B&&!I&&(v=T+1),B&&I&&(y=T-1),!B&&I){j=q;break}b++}return j||m},n9=function(t){var r=un(t)?[]:t.toString().split(mZ);return[{words:r}]},CDe=function(t){var r=t.width,s=t.scaleToFit,a=t.children,i=t.style,o=t.breakAll,l=t.maxLines;if((r||s)&&!Gc.isSsr){var d,c,u=pZ({breakAll:o,children:a,style:i});if(u){var h=u.wordsWithComputedWidth,f=u.spaceWidth;d=h,c=f}else return n9(a);return SDe({breakAll:o,children:a,maxLines:l,style:i},d,c,r,s)}return n9(a)},s9="#808080",Xw=function(t){var r=t.x,s=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.lineHeight,l=o===void 0?"1em":o,d=t.capHeight,c=d===void 0?"0.71em":d,u=t.scaleToFit,h=u===void 0?!1:u,f=t.textAnchor,m=f===void 0?"start":f,p=t.verticalAnchor,g=p===void 0?"end":p,x=t.fill,v=x===void 0?s9:x,y=e9(t,vDe),b=P.useMemo(function(){return CDe({breakAll:y.breakAll,children:y.children,maxLines:y.maxLines,scaleToFit:h,style:y.style,width:y.width})},[y.breakAll,y.children,y.maxLines,h,y.style,y.width]),j=y.dx,T=y.dy,O=y.angle,R=y.className,D=y.breakAll,B=e9(y,yDe);if(!ha(s)||!ha(i))return null;var q=s+(Kt(j)?j:0),Y=i+(Kt(T)?T:0),G;switch(g){case"start":G=i4("calc(".concat(c,")"));break;case"middle":G=i4("calc(".concat((b.length-1)/2," * -").concat(l," + (").concat(c," / 2))"));break;default:G=i4("calc(".concat(b.length-1," * -").concat(l,")"));break}var I=[];if(h){var F=b[0].width,S=y.width;I.push("scale(".concat((Kt(S)?S/F:1)/F,")"))}return O&&I.push("rotate(".concat(O,", ").concat(q,", ").concat(Y,")")),I.length&&(B.transform=I.join(" ")),je.createElement("text",S5({},on(B,!0),{x:q,y:Y,className:pn("recharts-text",R),textAnchor:m,fill:v.includes("url")?s9:v}),b.map(function(E,N){var C=E.words.join(D?"":" ");return je.createElement("tspan",{x:q,dy:N===0?G:l,key:"".concat(C,"-").concat(N)},C)}))};function pu(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function EDe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function xA(e){let t,r,s;e.length!==2?(t=pu,r=(l,d)=>pu(e(l),d),s=(l,d)=>e(l)-d):(t=e===pu||e===EDe?e:kDe,r=e,s=e);function a(l,d,c=0,u=l.length){if(c<u){if(t(d,d)!==0)return u;do{const h=c+u>>>1;r(l[h],d)<0?c=h+1:u=h}while(c<u)}return c}function i(l,d,c=0,u=l.length){if(c<u){if(t(d,d)!==0)return u;do{const h=c+u>>>1;r(l[h],d)<=0?c=h+1:u=h}while(c<u)}return c}function o(l,d,c=0,u=l.length){const h=a(l,d,c,u-1);return h>c&&s(l[h-1],d)>-s(l[h],d)?h-1:h}return{left:a,center:o,right:i}}function kDe(){return 0}function gZ(e){return e===null?NaN:+e}function*ADe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const TDe=xA(pu),S1=TDe.right;xA(gZ).center;class a9 extends Map{constructor(t,r=RDe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[s,a]of t)this.set(s,a)}get(t){return super.get(i9(this,t))}has(t){return super.has(i9(this,t))}set(t,r){return super.set(PDe(this,t),r)}delete(t){return super.delete(ODe(this,t))}}function i9({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):r}function PDe({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):(e.set(s,r),r)}function ODe({_intern:e,_key:t},r){const s=t(r);return e.has(s)&&(r=e.get(s),e.delete(s)),r}function RDe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function MDe(e=pu){if(e===pu)return xZ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const s=e(t,r);return s||s===0?s:(e(r,r)===0)-(e(t,t)===0)}}function xZ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const IDe=Math.sqrt(50),DDe=Math.sqrt(10),LDe=Math.sqrt(2);function Yw(e,t,r){const s=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(s)),i=s/Math.pow(10,a),o=i>=IDe?10:i>=DDe?5:i>=LDe?2:1;let l,d,c;return a<0?(c=Math.pow(10,-a)/o,l=Math.round(e*c),d=Math.round(t*c),l/c<e&&++l,d/c>t&&--d,c=-c):(c=Math.pow(10,a)*o,l=Math.round(e/c),d=Math.round(t/c),l*c<e&&++l,d*c>t&&--d),d<l&&.5<=r&&r<2?Yw(e,t,r*2):[l,d,c]}function C5(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const s=t<e,[a,i,o]=s?Yw(t,e,r):Yw(e,t,r);if(!(i>=a))return[];const l=i-a+1,d=new Array(l);if(s)if(o<0)for(let c=0;c<l;++c)d[c]=(i-c)/-o;else for(let c=0;c<l;++c)d[c]=(i-c)*o;else if(o<0)for(let c=0;c<l;++c)d[c]=(a+c)/-o;else for(let c=0;c<l;++c)d[c]=(a+c)*o;return d}function E5(e,t,r){return t=+t,e=+e,r=+r,Yw(e,t,r)[2]}function k5(e,t,r){t=+t,e=+e,r=+r;const s=t<e,a=s?E5(t,e,r):E5(e,t,r);return(s?-1:1)*(a<0?1/-a:a)}function o9(e,t){let r;for(const s of e)s!=null&&(r<s||r===void 0&&s>=s)&&(r=s);return r}function l9(e,t){let r;for(const s of e)s!=null&&(r>s||r===void 0&&s>=s)&&(r=s);return r}function vZ(e,t,r=0,s=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),s=Math.floor(Math.min(e.length-1,s)),!(r<=t&&t<=s))return e;for(a=a===void 0?xZ:MDe(a);s>r;){if(s-r>600){const d=s-r+1,c=t-r+1,u=Math.log(d),h=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*h*(d-h)/d)*(c-d/2<0?-1:1),m=Math.max(r,Math.floor(t-c*h/d+f)),p=Math.min(s,Math.floor(t+(d-c)*h/d+f));vZ(e,t,m,p,a)}const i=e[t];let o=r,l=s;for(f0(e,r,t),a(e[s],i)>0&&f0(e,r,s);o<l;){for(f0(e,o,l),++o,--l;a(e[o],i)<0;)++o;for(;a(e[l],i)>0;)--l}a(e[r],i)===0?f0(e,r,l):(++l,f0(e,l,s)),l<=t&&(r=l+1),t<=l&&(s=l-1)}return e}function f0(e,t,r){const s=e[t];e[t]=e[r],e[r]=s}function BDe(e,t,r){if(e=Float64Array.from(ADe(e)),!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return l9(e);if(t>=1)return o9(e);var s,a=(s-1)*t,i=Math.floor(a),o=o9(vZ(e,i).subarray(0,i+1)),l=l9(e.subarray(i+1));return o+(l-o)*(a-i)}}function $De(e,t,r=gZ){if(!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return+r(e[0],0,e);if(t>=1)return+r(e[s-1],s-1,e);var s,a=(s-1)*t,i=Math.floor(a),o=+r(e[i],i,e),l=+r(e[i+1],i+1,e);return o+(l-o)*(a-i)}}function FDe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var s=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++s<a;)i[s]=e+s*r;return i}function Xo(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function xd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const A5=Symbol("implicit");function vA(){var e=new a9,t=[],r=[],s=A5;function a(i){let o=e.get(i);if(o===void 0){if(s!==A5)return s;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new a9;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(s=i,a):s},a.copy=function(){return vA(t,r).unknown(s)},Xo.apply(a,arguments),a}function cv(){var e=vA().unknown(void 0),t=e.domain,r=e.range,s=0,a=1,i,o,l=!1,d=0,c=0,u=.5;delete e.unknown;function h(){var f=t().length,m=a<s,p=m?a:s,g=m?s:a;i=(g-p)/Math.max(1,f-d+c*2),l&&(i=Math.floor(i)),p+=(g-p-i*(f-d))*u,o=i*(1-d),l&&(p=Math.round(p),o=Math.round(o));var x=FDe(f).map(function(v){return p+i*v});return r(m?x.reverse():x)}return e.domain=function(f){return arguments.length?(t(f),h()):t()},e.range=function(f){return arguments.length?([s,a]=f,s=+s,a=+a,h()):[s,a]},e.rangeRound=function(f){return[s,a]=f,s=+s,a=+a,l=!0,h()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(l=!!f,h()):l},e.padding=function(f){return arguments.length?(d=Math.min(1,c=+f),h()):d},e.paddingInner=function(f){return arguments.length?(d=Math.min(1,f),h()):d},e.paddingOuter=function(f){return arguments.length?(c=+f,h()):c},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),h()):u},e.copy=function(){return cv(t(),[s,a]).round(l).paddingInner(d).paddingOuter(c).align(u)},Xo.apply(h(),arguments)}function yZ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return yZ(t())},e}function tx(){return yZ(cv.apply(null,arguments).paddingInner(1))}function yA(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function bZ(e,t){var r=Object.create(e.prototype);for(var s in t)r[s]=t[s];return r}function C1(){}var dv=.7,Zw=1/dv,Vm="\\s*([+-]?\\d+)\\s*",uv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",uc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",zDe=/^#([0-9a-f]{3,8})$/,UDe=new RegExp(`^rgb\\(${Vm},${Vm},${Vm}\\)$`),VDe=new RegExp(`^rgb\\(${uc},${uc},${uc}\\)$`),qDe=new RegExp(`^rgba\\(${Vm},${Vm},${Vm},${uv}\\)$`),WDe=new RegExp(`^rgba\\(${uc},${uc},${uc},${uv}\\)$`),HDe=new RegExp(`^hsl\\(${uv},${uc},${uc}\\)$`),GDe=new RegExp(`^hsla\\(${uv},${uc},${uc},${uv}\\)$`),c9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};yA(C1,hv,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:d9,formatHex:d9,formatHex8:KDe,formatHsl:XDe,formatRgb:u9,toString:u9});function d9(){return this.rgb().formatHex()}function KDe(){return this.rgb().formatHex8()}function XDe(){return wZ(this).formatHsl()}function u9(){return this.rgb().formatRgb()}function hv(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=zDe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?h9(t):r===3?new Bi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Fy(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Fy(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=UDe.exec(e))?new Bi(t[1],t[2],t[3],1):(t=VDe.exec(e))?new Bi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=qDe.exec(e))?Fy(t[1],t[2],t[3],t[4]):(t=WDe.exec(e))?Fy(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=HDe.exec(e))?p9(t[1],t[2]/100,t[3]/100,1):(t=GDe.exec(e))?p9(t[1],t[2]/100,t[3]/100,t[4]):c9.hasOwnProperty(e)?h9(c9[e]):e==="transparent"?new Bi(NaN,NaN,NaN,0):null}function h9(e){return new Bi(e>>16&255,e>>8&255,e&255,1)}function Fy(e,t,r,s){return s<=0&&(e=t=r=NaN),new Bi(e,t,r,s)}function YDe(e){return e instanceof C1||(e=hv(e)),e?(e=e.rgb(),new Bi(e.r,e.g,e.b,e.opacity)):new Bi}function T5(e,t,r,s){return arguments.length===1?YDe(e):new Bi(e,t,r,s??1)}function Bi(e,t,r,s){this.r=+e,this.g=+t,this.b=+r,this.opacity=+s}yA(Bi,T5,bZ(C1,{brighter(e){return e=e==null?Zw:Math.pow(Zw,e),new Bi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?dv:Math.pow(dv,e),new Bi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Bi(Fh(this.r),Fh(this.g),Fh(this.b),Qw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:f9,formatHex:f9,formatHex8:ZDe,formatRgb:m9,toString:m9}));function f9(){return`#${Nh(this.r)}${Nh(this.g)}${Nh(this.b)}`}function ZDe(){return`#${Nh(this.r)}${Nh(this.g)}${Nh(this.b)}${Nh((isNaN(this.opacity)?1:this.opacity)*255)}`}function m9(){const e=Qw(this.opacity);return`${e===1?"rgb(":"rgba("}${Fh(this.r)}, ${Fh(this.g)}, ${Fh(this.b)}${e===1?")":`, ${e})`}`}function Qw(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Fh(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Nh(e){return e=Fh(e),(e<16?"0":"")+e.toString(16)}function p9(e,t,r,s){return s<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new gl(e,t,r,s)}function wZ(e){if(e instanceof gl)return new gl(e.h,e.s,e.l,e.opacity);if(e instanceof C1||(e=hv(e)),!e)return new gl;if(e instanceof gl)return e;e=e.rgb();var t=e.r/255,r=e.g/255,s=e.b/255,a=Math.min(t,r,s),i=Math.max(t,r,s),o=NaN,l=i-a,d=(i+a)/2;return l?(t===i?o=(r-s)/l+(r<s)*6:r===i?o=(s-t)/l+2:o=(t-r)/l+4,l/=d<.5?i+a:2-i-a,o*=60):l=d>0&&d<1?0:o,new gl(o,l,d,e.opacity)}function QDe(e,t,r,s){return arguments.length===1?wZ(e):new gl(e,t,r,s??1)}function gl(e,t,r,s){this.h=+e,this.s=+t,this.l=+r,this.opacity=+s}yA(gl,QDe,bZ(C1,{brighter(e){return e=e==null?Zw:Math.pow(Zw,e),new gl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?dv:Math.pow(dv,e),new gl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*t,a=2*r-s;return new Bi(o4(e>=240?e-240:e+120,a,s),o4(e,a,s),o4(e<120?e+240:e-120,a,s),this.opacity)},clamp(){return new gl(g9(this.h),zy(this.s),zy(this.l),Qw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Qw(this.opacity);return`${e===1?"hsl(":"hsla("}${g9(this.h)}, ${zy(this.s)*100}%, ${zy(this.l)*100}%${e===1?")":`, ${e})`}`}}));function g9(e){return e=(e||0)%360,e<0?e+360:e}function zy(e){return Math.max(0,Math.min(1,e||0))}function o4(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const bA=e=>()=>e;function JDe(e,t){return function(r){return e+r*t}}function eLe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(s){return Math.pow(e+s*t,r)}}function tLe(e){return(e=+e)==1?_Z:function(t,r){return r-t?eLe(t,r,e):bA(isNaN(t)?r:t)}}function _Z(e,t){var r=t-e;return r?JDe(e,r):bA(isNaN(e)?t:e)}const x9=function e(t){var r=tLe(t);function s(a,i){var o=r((a=T5(a)).r,(i=T5(i)).r),l=r(a.g,i.g),d=r(a.b,i.b),c=_Z(a.opacity,i.opacity);return function(u){return a.r=o(u),a.g=l(u),a.b=d(u),a.opacity=c(u),a+""}}return s.gamma=e,s}(1);function rLe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,s=t.slice(),a;return function(i){for(a=0;a<r;++a)s[a]=e[a]*(1-i)+t[a]*i;return s}}function nLe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function sLe(e,t){var r=t?t.length:0,s=e?Math.min(r,e.length):0,a=new Array(s),i=new Array(r),o;for(o=0;o<s;++o)a[o]=Og(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(l){for(o=0;o<s;++o)i[o]=a[o](l);return i}}function aLe(e,t){var r=new Date;return e=+e,t=+t,function(s){return r.setTime(e*(1-s)+t*s),r}}function Jw(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function iLe(e,t){var r={},s={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Og(e[a],t[a]):s[a]=t[a];return function(i){for(a in r)s[a]=r[a](i);return s}}var P5=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,l4=new RegExp(P5.source,"g");function oLe(e){return function(){return e}}function lLe(e){return function(t){return e(t)+""}}function cLe(e,t){var r=P5.lastIndex=l4.lastIndex=0,s,a,i,o=-1,l=[],d=[];for(e=e+"",t=t+"";(s=P5.exec(e))&&(a=l4.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),l[o]?l[o]+=i:l[++o]=i),(s=s[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,d.push({i:o,x:Jw(s,a)})),r=l4.lastIndex;return r<t.length&&(i=t.slice(r),l[o]?l[o]+=i:l[++o]=i),l.length<2?d[0]?lLe(d[0].x):oLe(t):(t=d.length,function(c){for(var u=0,h;u<t;++u)l[(h=d[u]).i]=h.x(c);return l.join("")})}function Og(e,t){var r=typeof t,s;return t==null||r==="boolean"?bA(t):(r==="number"?Jw:r==="string"?(s=hv(t))?(t=s,x9):cLe:t instanceof hv?x9:t instanceof Date?aLe:nLe(t)?rLe:Array.isArray(t)?sLe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?iLe:Jw)(e,t)}function wA(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function dLe(e,t){t===void 0&&(t=e,e=Og);for(var r=0,s=t.length-1,a=t[0],i=new Array(s<0?0:s);r<s;)i[r]=e(a,a=t[++r]);return function(o){var l=Math.max(0,Math.min(s-1,Math.floor(o*=s)));return i[l](o-l)}}function uLe(e){return function(){return e}}function e2(e){return+e}var v9=[0,1];function yi(e){return e}function O5(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:uLe(isNaN(t)?NaN:.5)}function hLe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(s){return Math.max(e,Math.min(t,s))}}function fLe(e,t,r){var s=e[0],a=e[1],i=t[0],o=t[1];return a<s?(s=O5(a,s),i=r(o,i)):(s=O5(s,a),i=r(i,o)),function(l){return i(s(l))}}function mLe(e,t,r){var s=Math.min(e.length,t.length)-1,a=new Array(s),i=new Array(s),o=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<s;)a[o]=O5(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(l){var d=S1(e,l,1,s)-1;return i[d](a[d](l))}}function E1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function jj(){var e=v9,t=v9,r=Og,s,a,i,o=yi,l,d,c;function u(){var f=Math.min(e.length,t.length);return o!==yi&&(o=hLe(e[0],e[f-1])),l=f>2?mLe:fLe,d=c=null,h}function h(f){return f==null||isNaN(f=+f)?i:(d||(d=l(e.map(s),t,r)))(s(o(f)))}return h.invert=function(f){return o(a((c||(c=l(t,e.map(s),Jw)))(f)))},h.domain=function(f){return arguments.length?(e=Array.from(f,e2),u()):e.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),r=wA,u()},h.clamp=function(f){return arguments.length?(o=f?!0:yi,u()):o!==yi},h.interpolate=function(f){return arguments.length?(r=f,u()):r},h.unknown=function(f){return arguments.length?(i=f,h):i},function(f,m){return s=f,a=m,u()}}function _A(){return jj()(yi,yi)}function pLe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function t2(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,s=e.slice(0,r);return[s.length>1?s[0]+s.slice(2):s,+e.slice(r+1)]}function kp(e){return e=t2(Math.abs(e)),e?e[1]:NaN}function gLe(e,t){return function(r,s){for(var a=r.length,i=[],o=0,l=e[0],d=0;a>0&&l>0&&(d+l+1>s&&(l=Math.max(1,s-d)),i.push(r.substring(a-=l,a+l)),!((d+=l+1)>s));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function xLe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var vLe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function fv(e){if(!(t=vLe.exec(e)))throw new Error("invalid format: "+e);var t;return new jA({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}fv.prototype=jA.prototype;function jA(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}jA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function yLe(e){e:for(var t=e.length,r=1,s=-1,a;r<t;++r)switch(e[r]){case".":s=a=r;break;case"0":s===0&&(s=r),a=r;break;default:if(!+e[r])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(a+1):e}var jZ;function bLe(e,t){var r=t2(e,t);if(!r)return e+"";var s=r[0],a=r[1],i=a-(jZ=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=s.length;return i===o?s:i>o?s+new Array(i-o+1).join("0"):i>0?s.slice(0,i)+"."+s.slice(i):"0."+new Array(1-i).join("0")+t2(e,Math.max(0,t+i-1))[0]}function y9(e,t){var r=t2(e,t);if(!r)return e+"";var s=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+s:s.length>a+1?s.slice(0,a+1)+"."+s.slice(a+1):s+new Array(a-s.length+2).join("0")}const b9={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:pLe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>y9(e*100,t),r:y9,s:bLe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function w9(e){return e}var _9=Array.prototype.map,j9=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function wLe(e){var t=e.grouping===void 0||e.thousands===void 0?w9:gLe(_9.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?w9:xLe(_9.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",d=e.nan===void 0?"NaN":e.nan+"";function c(h){h=fv(h);var f=h.fill,m=h.align,p=h.sign,g=h.symbol,x=h.zero,v=h.width,y=h.comma,b=h.precision,j=h.trim,T=h.type;T==="n"?(y=!0,T="g"):b9[T]||(b===void 0&&(b=12),j=!0,T="g"),(x||f==="0"&&m==="=")&&(x=!0,f="0",m="=");var O=g==="$"?r:g==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",R=g==="$"?s:/[%p]/.test(T)?o:"",D=b9[T],B=/[defgprs%]/.test(T);b=b===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function q(Y){var G=O,I=R,F,S,E;if(T==="c")I=D(Y)+I,Y="";else{Y=+Y;var N=Y<0||1/Y<0;if(Y=isNaN(Y)?d:D(Math.abs(Y),b),j&&(Y=yLe(Y)),N&&+Y==0&&p!=="+"&&(N=!1),G=(N?p==="("?p:l:p==="-"||p==="("?"":p)+G,I=(T==="s"?j9[8+jZ/3]:"")+I+(N&&p==="("?")":""),B){for(F=-1,S=Y.length;++F<S;)if(E=Y.charCodeAt(F),48>E||E>57){I=(E===46?a+Y.slice(F+1):Y.slice(F))+I,Y=Y.slice(0,F);break}}}y&&!x&&(Y=t(Y,1/0));var C=G.length+Y.length+I.length,k=C<v?new Array(v-C+1).join(f):"";switch(y&&x&&(Y=t(k+Y,k.length?v-I.length:1/0),k=""),m){case"<":Y=G+Y+I+k;break;case"=":Y=G+k+Y+I;break;case"^":Y=k.slice(0,C=k.length>>1)+G+Y+I+k.slice(C);break;default:Y=k+G+Y+I;break}return i(Y)}return q.toString=function(){return h+""},q}function u(h,f){var m=c((h=fv(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(kp(f)/3)))*3,g=Math.pow(10,-p),x=j9[8+p/3];return function(v){return m(g*v)+x}}return{format:c,formatPrefix:u}}var Uy,NA,NZ;_Le({thousands:",",grouping:[3],currency:["$",""]});function _Le(e){return Uy=wLe(e),NA=Uy.format,NZ=Uy.formatPrefix,Uy}function jLe(e){return Math.max(0,-kp(Math.abs(e)))}function NLe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(kp(t)/3)))*3-kp(Math.abs(e)))}function SLe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,kp(t)-kp(e))+1}function SZ(e,t,r,s){var a=k5(e,t,r),i;switch(s=fv(s??",f"),s.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(i=NLe(a,o))&&(s.precision=i),NZ(s,o)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(i=SLe(a,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=i-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(i=jLe(a))&&(s.precision=i-(s.type==="%")*2);break}}return NA(s)}function qu(e){var t=e.domain;return e.ticks=function(r){var s=t();return C5(s[0],s[s.length-1],r??10)},e.tickFormat=function(r,s){var a=t();return SZ(a[0],a[a.length-1],r??10,s)},e.nice=function(r){r==null&&(r=10);var s=t(),a=0,i=s.length-1,o=s[a],l=s[i],d,c,u=10;for(l<o&&(c=o,o=l,l=c,c=a,a=i,i=c);u-- >0;){if(c=E5(o,l,r),c===d)return s[a]=o,s[i]=l,t(s);if(c>0)o=Math.floor(o/c)*c,l=Math.ceil(l/c)*c;else if(c<0)o=Math.ceil(o*c)/c,l=Math.floor(l*c)/c;else break;d=c}return e},e}function r2(){var e=_A();return e.copy=function(){return E1(e,r2())},Xo.apply(e,arguments),qu(e)}function CZ(e){var t;function r(s){return s==null||isNaN(s=+s)?t:s}return r.invert=r,r.domain=r.range=function(s){return arguments.length?(e=Array.from(s,e2),r):e.slice()},r.unknown=function(s){return arguments.length?(t=s,r):t},r.copy=function(){return CZ(e).unknown(t)},e=arguments.length?Array.from(e,e2):[0,1],qu(r)}function EZ(e,t){e=e.slice();var r=0,s=e.length-1,a=e[r],i=e[s],o;return i<a&&(o=r,r=s,s=o,o=a,a=i,i=o),e[r]=t.floor(a),e[s]=t.ceil(i),e}function N9(e){return Math.log(e)}function S9(e){return Math.exp(e)}function CLe(e){return-Math.log(-e)}function ELe(e){return-Math.exp(-e)}function kLe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ALe(e){return e===10?kLe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function TLe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function C9(e){return(t,r)=>-e(-t,r)}function SA(e){const t=e(N9,S9),r=t.domain;let s=10,a,i;function o(){return a=TLe(s),i=ALe(s),r()[0]<0?(a=C9(a),i=C9(i),e(CLe,ELe)):e(N9,S9),t}return t.base=function(l){return arguments.length?(s=+l,o()):s},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const d=r();let c=d[0],u=d[d.length-1];const h=u<c;h&&([c,u]=[u,c]);let f=a(c),m=a(u),p,g;const x=l==null?10:+l;let v=[];if(!(s%1)&&m-f<x){if(f=Math.floor(f),m=Math.ceil(m),c>0){for(;f<=m;++f)for(p=1;p<s;++p)if(g=f<0?p/i(-f):p*i(f),!(g<c)){if(g>u)break;v.push(g)}}else for(;f<=m;++f)for(p=s-1;p>=1;--p)if(g=f>0?p/i(-f):p*i(f),!(g<c)){if(g>u)break;v.push(g)}v.length*2<x&&(v=C5(c,u,x))}else v=C5(f,m,Math.min(m-f,x)).map(i);return h?v.reverse():v},t.tickFormat=(l,d)=>{if(l==null&&(l=10),d==null&&(d=s===10?"s":","),typeof d!="function"&&(!(s%1)&&(d=fv(d)).precision==null&&(d.trim=!0),d=NA(d)),l===1/0)return d;const c=Math.max(1,s*l/t.ticks().length);return u=>{let h=u/i(Math.round(a(u)));return h*s<s-.5&&(h*=s),h<=c?d(u):""}},t.nice=()=>r(EZ(r(),{floor:l=>i(Math.floor(a(l))),ceil:l=>i(Math.ceil(a(l)))})),t}function kZ(){const e=SA(jj()).domain([1,10]);return e.copy=()=>E1(e,kZ()).base(e.base()),Xo.apply(e,arguments),e}function E9(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function k9(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function CA(e){var t=1,r=e(E9(t),k9(t));return r.constant=function(s){return arguments.length?e(E9(t=+s),k9(t)):t},qu(r)}function AZ(){var e=CA(jj());return e.copy=function(){return E1(e,AZ()).constant(e.constant())},Xo.apply(e,arguments)}function A9(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function PLe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function OLe(e){return e<0?-e*e:e*e}function EA(e){var t=e(yi,yi),r=1;function s(){return r===1?e(yi,yi):r===.5?e(PLe,OLe):e(A9(r),A9(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,s()):r},qu(t)}function kA(){var e=EA(jj());return e.copy=function(){return E1(e,kA()).exponent(e.exponent())},Xo.apply(e,arguments),e}function RLe(){return kA.apply(null,arguments).exponent(.5)}function T9(e){return Math.sign(e)*e*e}function MLe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function TZ(){var e=_A(),t=[0,1],r=!1,s;function a(i){var o=MLe(e(i));return isNaN(o)?s:r?Math.round(o):o}return a.invert=function(i){return e.invert(T9(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,e2)).map(T9)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(s=i,a):s},a.copy=function(){return TZ(e.domain(),t).round(r).clamp(e.clamp()).unknown(s)},Xo.apply(a,arguments),qu(a)}function PZ(){var e=[],t=[],r=[],s;function a(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=$De(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?s:t[S1(r,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(pu),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(s=o,i):s},i.quantiles=function(){return r.slice()},i.copy=function(){return PZ().domain(e).range(t).unknown(s)},Xo.apply(i,arguments)}function OZ(){var e=0,t=1,r=1,s=[.5],a=[0,1],i;function o(d){return d!=null&&d<=d?a[S1(s,d,0,r)]:i}function l(){var d=-1;for(s=new Array(r);++d<r;)s[d]=((d+1)*t-(d-r)*e)/(r+1);return o}return o.domain=function(d){return arguments.length?([e,t]=d,e=+e,t=+t,l()):[e,t]},o.range=function(d){return arguments.length?(r=(a=Array.from(d)).length-1,l()):a.slice()},o.invertExtent=function(d){var c=a.indexOf(d);return c<0?[NaN,NaN]:c<1?[e,s[0]]:c>=r?[s[r-1],t]:[s[c-1],s[c]]},o.unknown=function(d){return arguments.length&&(i=d),o},o.thresholds=function(){return s.slice()},o.copy=function(){return OZ().domain([e,t]).range(a).unknown(i)},Xo.apply(qu(o),arguments)}function RZ(){var e=[.5],t=[0,1],r,s=1;function a(i){return i!=null&&i<=i?t[S1(e,i,0,s)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),s=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),s=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return RZ().domain(e).range(t).unknown(r)},Xo.apply(a,arguments)}const c4=new Date,d4=new Date;function wa(e,t,r,s){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),l=a.ceil(i);return i-o<l-i?o:l},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,l)=>{const d=[];if(i=a.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return d;let c;do d.push(c=new Date(+i)),t(i,l),e(i);while(c<i&&i<o);return d},a.filter=i=>wa(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(c4.setTime(+i),d4.setTime(+o),e(c4),e(d4),Math.floor(r(c4,d4))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(s?o=>s(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const n2=wa(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);n2.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?wa(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):n2);n2.range;const zc=1e3,Mo=zc*60,Uc=Mo*60,ad=Uc*24,AA=ad*7,P9=ad*30,u4=ad*365,Sh=wa(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*zc)},(e,t)=>(t-e)/zc,e=>e.getUTCSeconds());Sh.range;const TA=wa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*zc)},(e,t)=>{e.setTime(+e+t*Mo)},(e,t)=>(t-e)/Mo,e=>e.getMinutes());TA.range;const PA=wa(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Mo)},(e,t)=>(t-e)/Mo,e=>e.getUTCMinutes());PA.range;const OA=wa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*zc-e.getMinutes()*Mo)},(e,t)=>{e.setTime(+e+t*Uc)},(e,t)=>(t-e)/Uc,e=>e.getHours());OA.range;const RA=wa(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Uc)},(e,t)=>(t-e)/Uc,e=>e.getUTCHours());RA.range;const k1=wa(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Mo)/ad,e=>e.getDate()-1);k1.range;const Nj=wa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ad,e=>e.getUTCDate()-1);Nj.range;const MZ=wa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ad,e=>Math.floor(e/ad));MZ.range;function Cf(e){return wa(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Mo)/AA)}const Sj=Cf(0),s2=Cf(1),ILe=Cf(2),DLe=Cf(3),Ap=Cf(4),LLe=Cf(5),BLe=Cf(6);Sj.range;s2.range;ILe.range;DLe.range;Ap.range;LLe.range;BLe.range;function Ef(e){return wa(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/AA)}const Cj=Ef(0),a2=Ef(1),$Le=Ef(2),FLe=Ef(3),Tp=Ef(4),zLe=Ef(5),ULe=Ef(6);Cj.range;a2.range;$Le.range;FLe.range;Tp.range;zLe.range;ULe.range;const MA=wa(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());MA.range;const IA=wa(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());IA.range;const id=wa(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());id.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:wa(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});id.range;const od=wa(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());od.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:wa(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});od.range;function IZ(e,t,r,s,a,i){const o=[[Sh,1,zc],[Sh,5,5*zc],[Sh,15,15*zc],[Sh,30,30*zc],[i,1,Mo],[i,5,5*Mo],[i,15,15*Mo],[i,30,30*Mo],[a,1,Uc],[a,3,3*Uc],[a,6,6*Uc],[a,12,12*Uc],[s,1,ad],[s,2,2*ad],[r,1,AA],[t,1,P9],[t,3,3*P9],[e,1,u4]];function l(c,u,h){const f=u<c;f&&([c,u]=[u,c]);const m=h&&typeof h.range=="function"?h:d(c,u,h),p=m?m.range(c,+u+1):[];return f?p.reverse():p}function d(c,u,h){const f=Math.abs(u-c)/h,m=xA(([,,x])=>x).right(o,f);if(m===o.length)return e.every(k5(c/u4,u/u4,h));if(m===0)return n2.every(Math.max(k5(c,u,h),1));const[p,g]=o[f/o[m-1][2]<o[m][2]/f?m-1:m];return p.every(g)}return[l,d]}const[VLe,qLe]=IZ(od,IA,Cj,MZ,RA,PA),[WLe,HLe]=IZ(id,MA,Sj,k1,OA,TA);function h4(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function f4(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function m0(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function GLe(e){var t=e.dateTime,r=e.date,s=e.time,a=e.periods,i=e.days,o=e.shortDays,l=e.months,d=e.shortMonths,c=p0(a),u=g0(a),h=p0(i),f=g0(i),m=p0(o),p=g0(o),g=p0(l),x=g0(l),v=p0(d),y=g0(d),b={a:N,A:C,b:k,B:M,c:null,d:L9,e:L9,f:gBe,g:CBe,G:kBe,H:fBe,I:mBe,j:pBe,L:DZ,m:xBe,M:vBe,p:U,q:$,Q:F9,s:z9,S:yBe,u:bBe,U:wBe,V:_Be,w:jBe,W:NBe,x:null,X:null,y:SBe,Y:EBe,Z:ABe,"%":$9},j={a:X,A:Z,b:re,B:W,c:null,d:B9,e:B9,f:RBe,g:VBe,G:WBe,H:TBe,I:PBe,j:OBe,L:BZ,m:MBe,M:IBe,p:J,q:V,Q:F9,s:z9,S:DBe,u:LBe,U:BBe,V:$Be,w:FBe,W:zBe,x:null,X:null,y:UBe,Y:qBe,Z:HBe,"%":$9},T={a:q,A:Y,b:G,B:I,c:F,d:I9,e:I9,f:cBe,g:M9,G:R9,H:D9,I:D9,j:aBe,L:lBe,m:sBe,M:iBe,p:B,q:nBe,Q:uBe,s:hBe,S:oBe,u:QLe,U:JLe,V:eBe,w:ZLe,W:tBe,x:S,X:E,y:M9,Y:R9,Z:rBe,"%":dBe};b.x=O(r,b),b.X=O(s,b),b.c=O(t,b),j.x=O(r,j),j.X=O(s,j),j.c=O(t,j);function O(H,ee){return function(ie){var oe=[],se=-1,ue=0,pe=H.length,ce,ne,me;for(ie instanceof Date||(ie=new Date(+ie));++se<pe;)H.charCodeAt(se)===37&&(oe.push(H.slice(ue,se)),(ne=O9[ce=H.charAt(++se)])!=null?ce=H.charAt(++se):ne=ce==="e"?" ":"0",(me=ee[ce])&&(ce=me(ie,ne)),oe.push(ce),ue=se+1);return oe.push(H.slice(ue,se)),oe.join("")}}function R(H,ee){return function(ie){var oe=m0(1900,void 0,1),se=D(oe,H,ie+="",0),ue,pe;if(se!=ie.length)return null;if("Q"in oe)return new Date(oe.Q);if("s"in oe)return new Date(oe.s*1e3+("L"in oe?oe.L:0));if(ee&&!("Z"in oe)&&(oe.Z=0),"p"in oe&&(oe.H=oe.H%12+oe.p*12),oe.m===void 0&&(oe.m="q"in oe?oe.q:0),"V"in oe){if(oe.V<1||oe.V>53)return null;"w"in oe||(oe.w=1),"Z"in oe?(ue=f4(m0(oe.y,0,1)),pe=ue.getUTCDay(),ue=pe>4||pe===0?a2.ceil(ue):a2(ue),ue=Nj.offset(ue,(oe.V-1)*7),oe.y=ue.getUTCFullYear(),oe.m=ue.getUTCMonth(),oe.d=ue.getUTCDate()+(oe.w+6)%7):(ue=h4(m0(oe.y,0,1)),pe=ue.getDay(),ue=pe>4||pe===0?s2.ceil(ue):s2(ue),ue=k1.offset(ue,(oe.V-1)*7),oe.y=ue.getFullYear(),oe.m=ue.getMonth(),oe.d=ue.getDate()+(oe.w+6)%7)}else("W"in oe||"U"in oe)&&("w"in oe||(oe.w="u"in oe?oe.u%7:"W"in oe?1:0),pe="Z"in oe?f4(m0(oe.y,0,1)).getUTCDay():h4(m0(oe.y,0,1)).getDay(),oe.m=0,oe.d="W"in oe?(oe.w+6)%7+oe.W*7-(pe+5)%7:oe.w+oe.U*7-(pe+6)%7);return"Z"in oe?(oe.H+=oe.Z/100|0,oe.M+=oe.Z%100,f4(oe)):h4(oe)}}function D(H,ee,ie,oe){for(var se=0,ue=ee.length,pe=ie.length,ce,ne;se<ue;){if(oe>=pe)return-1;if(ce=ee.charCodeAt(se++),ce===37){if(ce=ee.charAt(se++),ne=T[ce in O9?ee.charAt(se++):ce],!ne||(oe=ne(H,ie,oe))<0)return-1}else if(ce!=ie.charCodeAt(oe++))return-1}return oe}function B(H,ee,ie){var oe=c.exec(ee.slice(ie));return oe?(H.p=u.get(oe[0].toLowerCase()),ie+oe[0].length):-1}function q(H,ee,ie){var oe=m.exec(ee.slice(ie));return oe?(H.w=p.get(oe[0].toLowerCase()),ie+oe[0].length):-1}function Y(H,ee,ie){var oe=h.exec(ee.slice(ie));return oe?(H.w=f.get(oe[0].toLowerCase()),ie+oe[0].length):-1}function G(H,ee,ie){var oe=v.exec(ee.slice(ie));return oe?(H.m=y.get(oe[0].toLowerCase()),ie+oe[0].length):-1}function I(H,ee,ie){var oe=g.exec(ee.slice(ie));return oe?(H.m=x.get(oe[0].toLowerCase()),ie+oe[0].length):-1}function F(H,ee,ie){return D(H,t,ee,ie)}function S(H,ee,ie){return D(H,r,ee,ie)}function E(H,ee,ie){return D(H,s,ee,ie)}function N(H){return o[H.getDay()]}function C(H){return i[H.getDay()]}function k(H){return d[H.getMonth()]}function M(H){return l[H.getMonth()]}function U(H){return a[+(H.getHours()>=12)]}function $(H){return 1+~~(H.getMonth()/3)}function X(H){return o[H.getUTCDay()]}function Z(H){return i[H.getUTCDay()]}function re(H){return d[H.getUTCMonth()]}function W(H){return l[H.getUTCMonth()]}function J(H){return a[+(H.getUTCHours()>=12)]}function V(H){return 1+~~(H.getUTCMonth()/3)}return{format:function(H){var ee=O(H+="",b);return ee.toString=function(){return H},ee},parse:function(H){var ee=R(H+="",!1);return ee.toString=function(){return H},ee},utcFormat:function(H){var ee=O(H+="",j);return ee.toString=function(){return H},ee},utcParse:function(H){var ee=R(H+="",!0);return ee.toString=function(){return H},ee}}}var O9={"-":"",_:" ",0:"0"},Aa=/^\s*\d+/,KLe=/^%/,XLe=/[\\^$*+?|[\]().{}]/g;function Tn(e,t,r){var s=e<0?"-":"",a=(s?-e:e)+"",i=a.length;return s+(i<r?new Array(r-i+1).join(t)+a:a)}function YLe(e){return e.replace(XLe,"\\$&")}function p0(e){return new RegExp("^(?:"+e.map(YLe).join("|")+")","i")}function g0(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function ZLe(e,t,r){var s=Aa.exec(t.slice(r,r+1));return s?(e.w=+s[0],r+s[0].length):-1}function QLe(e,t,r){var s=Aa.exec(t.slice(r,r+1));return s?(e.u=+s[0],r+s[0].length):-1}function JLe(e,t,r){var s=Aa.exec(t.slice(r,r+2));return s?(e.U=+s[0],r+s[0].length):-1}function eBe(e,t,r){var s=Aa.exec(t.slice(r,r+2));return s?(e.V=+s[0],r+s[0].length):-1}function tBe(e,t,r){var s=Aa.exec(t.slice(r,r+2));return s?(e.W=+s[0],r+s[0].length):-1}function R9(e,t,r){var s=Aa.exec(t.slice(r,r+4));return s?(e.y=+s[0],r+s[0].length):-1}function M9(e,t,r){var s=Aa.exec(t.slice(r,r+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),r+s[0].length):-1}function rBe(e,t,r){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),r+s[0].length):-1}function nBe(e,t,r){var s=Aa.exec(t.slice(r,r+1));return s?(e.q=s[0]*3-3,r+s[0].length):-1}function sBe(e,t,r){var s=Aa.exec(t.slice(r,r+2));return s?(e.m=s[0]-1,r+s[0].length):-1}function I9(e,t,r){var s=Aa.exec(t.slice(r,r+2));return s?(e.d=+s[0],r+s[0].length):-1}function aBe(e,t,r){var s=Aa.exec(t.slice(r,r+3));return s?(e.m=0,e.d=+s[0],r+s[0].length):-1}function D9(e,t,r){var s=Aa.exec(t.slice(r,r+2));return s?(e.H=+s[0],r+s[0].length):-1}function iBe(e,t,r){var s=Aa.exec(t.slice(r,r+2));return s?(e.M=+s[0],r+s[0].length):-1}function oBe(e,t,r){var s=Aa.exec(t.slice(r,r+2));return s?(e.S=+s[0],r+s[0].length):-1}function lBe(e,t,r){var s=Aa.exec(t.slice(r,r+3));return s?(e.L=+s[0],r+s[0].length):-1}function cBe(e,t,r){var s=Aa.exec(t.slice(r,r+6));return s?(e.L=Math.floor(s[0]/1e3),r+s[0].length):-1}function dBe(e,t,r){var s=KLe.exec(t.slice(r,r+1));return s?r+s[0].length:-1}function uBe(e,t,r){var s=Aa.exec(t.slice(r));return s?(e.Q=+s[0],r+s[0].length):-1}function hBe(e,t,r){var s=Aa.exec(t.slice(r));return s?(e.s=+s[0],r+s[0].length):-1}function L9(e,t){return Tn(e.getDate(),t,2)}function fBe(e,t){return Tn(e.getHours(),t,2)}function mBe(e,t){return Tn(e.getHours()%12||12,t,2)}function pBe(e,t){return Tn(1+k1.count(id(e),e),t,3)}function DZ(e,t){return Tn(e.getMilliseconds(),t,3)}function gBe(e,t){return DZ(e,t)+"000"}function xBe(e,t){return Tn(e.getMonth()+1,t,2)}function vBe(e,t){return Tn(e.getMinutes(),t,2)}function yBe(e,t){return Tn(e.getSeconds(),t,2)}function bBe(e){var t=e.getDay();return t===0?7:t}function wBe(e,t){return Tn(Sj.count(id(e)-1,e),t,2)}function LZ(e){var t=e.getDay();return t>=4||t===0?Ap(e):Ap.ceil(e)}function _Be(e,t){return e=LZ(e),Tn(Ap.count(id(e),e)+(id(e).getDay()===4),t,2)}function jBe(e){return e.getDay()}function NBe(e,t){return Tn(s2.count(id(e)-1,e),t,2)}function SBe(e,t){return Tn(e.getFullYear()%100,t,2)}function CBe(e,t){return e=LZ(e),Tn(e.getFullYear()%100,t,2)}function EBe(e,t){return Tn(e.getFullYear()%1e4,t,4)}function kBe(e,t){var r=e.getDay();return e=r>=4||r===0?Ap(e):Ap.ceil(e),Tn(e.getFullYear()%1e4,t,4)}function ABe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Tn(t/60|0,"0",2)+Tn(t%60,"0",2)}function B9(e,t){return Tn(e.getUTCDate(),t,2)}function TBe(e,t){return Tn(e.getUTCHours(),t,2)}function PBe(e,t){return Tn(e.getUTCHours()%12||12,t,2)}function OBe(e,t){return Tn(1+Nj.count(od(e),e),t,3)}function BZ(e,t){return Tn(e.getUTCMilliseconds(),t,3)}function RBe(e,t){return BZ(e,t)+"000"}function MBe(e,t){return Tn(e.getUTCMonth()+1,t,2)}function IBe(e,t){return Tn(e.getUTCMinutes(),t,2)}function DBe(e,t){return Tn(e.getUTCSeconds(),t,2)}function LBe(e){var t=e.getUTCDay();return t===0?7:t}function BBe(e,t){return Tn(Cj.count(od(e)-1,e),t,2)}function $Z(e){var t=e.getUTCDay();return t>=4||t===0?Tp(e):Tp.ceil(e)}function $Be(e,t){return e=$Z(e),Tn(Tp.count(od(e),e)+(od(e).getUTCDay()===4),t,2)}function FBe(e){return e.getUTCDay()}function zBe(e,t){return Tn(a2.count(od(e)-1,e),t,2)}function UBe(e,t){return Tn(e.getUTCFullYear()%100,t,2)}function VBe(e,t){return e=$Z(e),Tn(e.getUTCFullYear()%100,t,2)}function qBe(e,t){return Tn(e.getUTCFullYear()%1e4,t,4)}function WBe(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Tp(e):Tp.ceil(e),Tn(e.getUTCFullYear()%1e4,t,4)}function HBe(){return"+0000"}function $9(){return"%"}function F9(e){return+e}function z9(e){return Math.floor(+e/1e3)}var Zf,FZ,zZ;GBe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function GBe(e){return Zf=GLe(e),FZ=Zf.format,Zf.parse,zZ=Zf.utcFormat,Zf.utcParse,Zf}function KBe(e){return new Date(e)}function XBe(e){return e instanceof Date?+e:+new Date(+e)}function DA(e,t,r,s,a,i,o,l,d,c){var u=_A(),h=u.invert,f=u.domain,m=c(".%L"),p=c(":%S"),g=c("%I:%M"),x=c("%I %p"),v=c("%a %d"),y=c("%b %d"),b=c("%B"),j=c("%Y");function T(O){return(d(O)<O?m:l(O)<O?p:o(O)<O?g:i(O)<O?x:s(O)<O?a(O)<O?v:y:r(O)<O?b:j)(O)}return u.invert=function(O){return new Date(h(O))},u.domain=function(O){return arguments.length?f(Array.from(O,XBe)):f().map(KBe)},u.ticks=function(O){var R=f();return e(R[0],R[R.length-1],O??10)},u.tickFormat=function(O,R){return R==null?T:c(R)},u.nice=function(O){var R=f();return(!O||typeof O.range!="function")&&(O=t(R[0],R[R.length-1],O??10)),O?f(EZ(R,O)):u},u.copy=function(){return E1(u,DA(e,t,r,s,a,i,o,l,d,c))},u}function YBe(){return Xo.apply(DA(WLe,HLe,id,MA,Sj,k1,OA,TA,Sh,FZ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ZBe(){return Xo.apply(DA(VLe,qLe,od,IA,Cj,Nj,RA,PA,Sh,zZ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Ej(){var e=0,t=1,r,s,a,i,o=yi,l=!1,d;function c(h){return h==null||isNaN(h=+h)?d:o(a===0?.5:(h=(i(h)-r)*a,l?Math.max(0,Math.min(1,h)):h))}c.domain=function(h){return arguments.length?([e,t]=h,r=i(e=+e),s=i(t=+t),a=r===s?0:1/(s-r),c):[e,t]},c.clamp=function(h){return arguments.length?(l=!!h,c):l},c.interpolator=function(h){return arguments.length?(o=h,c):o};function u(h){return function(f){var m,p;return arguments.length?([m,p]=f,o=h(m,p),c):[o(0),o(1)]}}return c.range=u(Og),c.rangeRound=u(wA),c.unknown=function(h){return arguments.length?(d=h,c):d},function(h){return i=h,r=h(e),s=h(t),a=r===s?0:1/(s-r),c}}function Wu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function UZ(){var e=qu(Ej()(yi));return e.copy=function(){return Wu(e,UZ())},xd.apply(e,arguments)}function VZ(){var e=SA(Ej()).domain([1,10]);return e.copy=function(){return Wu(e,VZ()).base(e.base())},xd.apply(e,arguments)}function qZ(){var e=CA(Ej());return e.copy=function(){return Wu(e,qZ()).constant(e.constant())},xd.apply(e,arguments)}function LA(){var e=EA(Ej());return e.copy=function(){return Wu(e,LA()).exponent(e.exponent())},xd.apply(e,arguments)}function QBe(){return LA.apply(null,arguments).exponent(.5)}function WZ(){var e=[],t=yi;function r(s){if(s!=null&&!isNaN(s=+s))return t((S1(e,s,1)-1)/(e.length-1))}return r.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(pu),r},r.interpolator=function(s){return arguments.length?(t=s,r):t},r.range=function(){return e.map((s,a)=>t(a/(e.length-1)))},r.quantiles=function(s){return Array.from({length:s+1},(a,i)=>BDe(e,i/s))},r.copy=function(){return WZ(t).domain(e)},xd.apply(r,arguments)}function kj(){var e=0,t=.5,r=1,s=1,a,i,o,l,d,c=yi,u,h=!1,f;function m(g){return isNaN(g=+g)?f:(g=.5+((g=+u(g))-i)*(s*g<s*i?l:d),c(h?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([e,t,r]=g,a=u(e=+e),i=u(t=+t),o=u(r=+r),l=a===i?0:.5/(i-a),d=i===o?0:.5/(o-i),s=i<a?-1:1,m):[e,t,r]},m.clamp=function(g){return arguments.length?(h=!!g,m):h},m.interpolator=function(g){return arguments.length?(c=g,m):c};function p(g){return function(x){var v,y,b;return arguments.length?([v,y,b]=x,c=dLe(g,[v,y,b]),m):[c(0),c(.5),c(1)]}}return m.range=p(Og),m.rangeRound=p(wA),m.unknown=function(g){return arguments.length?(f=g,m):f},function(g){return u=g,a=g(e),i=g(t),o=g(r),l=a===i?0:.5/(i-a),d=i===o?0:.5/(o-i),s=i<a?-1:1,m}}function HZ(){var e=qu(kj()(yi));return e.copy=function(){return Wu(e,HZ())},xd.apply(e,arguments)}function GZ(){var e=SA(kj()).domain([.1,1,10]);return e.copy=function(){return Wu(e,GZ()).base(e.base())},xd.apply(e,arguments)}function KZ(){var e=CA(kj());return e.copy=function(){return Wu(e,KZ()).constant(e.constant())},xd.apply(e,arguments)}function BA(){var e=EA(kj());return e.copy=function(){return Wu(e,BA()).exponent(e.exponent())},xd.apply(e,arguments)}function JBe(){return BA.apply(null,arguments).exponent(.5)}const U9=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:cv,scaleDiverging:HZ,scaleDivergingLog:GZ,scaleDivergingPow:BA,scaleDivergingSqrt:JBe,scaleDivergingSymlog:KZ,scaleIdentity:CZ,scaleImplicit:A5,scaleLinear:r2,scaleLog:kZ,scaleOrdinal:vA,scalePoint:tx,scalePow:kA,scaleQuantile:PZ,scaleQuantize:OZ,scaleRadial:TZ,scaleSequential:UZ,scaleSequentialLog:VZ,scaleSequentialPow:LA,scaleSequentialQuantile:WZ,scaleSequentialSqrt:QBe,scaleSequentialSymlog:qZ,scaleSqrt:RLe,scaleSymlog:AZ,scaleThreshold:RZ,scaleTime:YBe,scaleUtc:ZBe,tickFormat:SZ},Symbol.toStringTag,{value:"Module"}));var e$e=jg;function t$e(e,t,r){for(var s=-1,a=e.length;++s<a;){var i=e[s],o=t(i);if(o!=null&&(l===void 0?o===o&&!e$e(o):r(o,l)))var l=o,d=i}return d}var XZ=t$e;function r$e(e,t){return e>t}var n$e=r$e,s$e=XZ,a$e=n$e,i$e=Pg;function o$e(e){return e&&e.length?s$e(e,i$e,a$e):void 0}var l$e=o$e;const eu=Ln(l$e);function c$e(e,t){return e<t}var d$e=c$e,u$e=XZ,h$e=d$e,f$e=Pg;function m$e(e){return e&&e.length?u$e(e,f$e,h$e):void 0}var p$e=m$e;const Aj=Ln(p$e);var g$e=Q8,x$e=Vu,v$e=nZ,y$e=Ki;function b$e(e,t){var r=y$e(e)?g$e:v$e;return r(e,x$e(t))}var w$e=b$e,_$e=tZ,j$e=w$e;function N$e(e,t){return _$e(j$e(e,t),1)}var S$e=N$e;const C$e=Ln(S$e);var E$e=fA;function k$e(e,t){return E$e(e,t)}var A$e=k$e;const mv=Ln(A$e);var Rg=1e9,T$e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},FA,gs=!0,Wo="[DecimalError] ",zh=Wo+"Invalid argument: ",$A=Wo+"Exponent out of range: ",Mg=Math.floor,mh=Math.pow,P$e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,lo,ja=1e7,ds=7,YZ=9007199254740991,i2=Mg(YZ/ds),dr={};dr.absoluteValue=dr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};dr.comparedTo=dr.cmp=function(e){var t,r,s,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(s=i.d.length,a=e.d.length,t=0,r=s<a?s:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return s===a?0:s>a^i.s<0?1:-1};dr.decimalPlaces=dr.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*ds;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};dr.dividedBy=dr.div=function(e){return Kc(this,new this.constructor(e))};dr.dividedToIntegerBy=dr.idiv=function(e){var t=this,r=t.constructor;return Xn(Kc(t,new r(e),0,1),r.precision)};dr.equals=dr.eq=function(e){return!this.cmp(e)};dr.exponent=function(){return Qs(this)};dr.greaterThan=dr.gt=function(e){return this.cmp(e)>0};dr.greaterThanOrEqualTo=dr.gte=function(e){return this.cmp(e)>=0};dr.isInteger=dr.isint=function(){return this.e>this.d.length-2};dr.isNegative=dr.isneg=function(){return this.s<0};dr.isPositive=dr.ispos=function(){return this.s>0};dr.isZero=function(){return this.s===0};dr.lessThan=dr.lt=function(e){return this.cmp(e)<0};dr.lessThanOrEqualTo=dr.lte=function(e){return this.cmp(e)<1};dr.logarithm=dr.log=function(e){var t,r=this,s=r.constructor,a=s.precision,i=a+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(lo))throw Error(Wo+"NaN");if(r.s<1)throw Error(Wo+(r.s?"NaN":"-Infinity"));return r.eq(lo)?new s(0):(gs=!1,t=Kc(pv(r,i),pv(e,i),i),gs=!0,Xn(t,a))};dr.minus=dr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?JZ(t,e):ZZ(t,(e.s=-e.s,e))};dr.modulo=dr.mod=function(e){var t,r=this,s=r.constructor,a=s.precision;if(e=new s(e),!e.s)throw Error(Wo+"NaN");return r.s?(gs=!1,t=Kc(r,e,0,1).times(e),gs=!0,r.minus(t)):Xn(new s(r),a)};dr.naturalExponential=dr.exp=function(){return QZ(this)};dr.naturalLogarithm=dr.ln=function(){return pv(this)};dr.negated=dr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};dr.plus=dr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?ZZ(t,e):JZ(t,(e.s=-e.s,e))};dr.precision=dr.sd=function(e){var t,r,s,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(zh+e);if(t=Qs(a)+1,s=a.d.length-1,r=s*ds+1,s=a.d[s],s){for(;s%10==0;s/=10)r--;for(s=a.d[0];s>=10;s/=10)r++}return e&&t>r?t:r};dr.squareRoot=dr.sqrt=function(){var e,t,r,s,a,i,o,l=this,d=l.constructor;if(l.s<1){if(!l.s)return new d(0);throw Error(Wo+"NaN")}for(e=Qs(l),gs=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=tc(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Mg((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new d(t)):s=new d(a.toString()),r=d.precision,a=o=r+3;;)if(i=s,s=i.plus(Kc(l,i,o+2)).times(.5),tc(i.d).slice(0,o)===(t=tc(s.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(Xn(i,r+1,0),i.times(i).eq(l)){s=i;break}}else if(t!="9999")break;o+=4}return gs=!0,Xn(s,r)};dr.times=dr.mul=function(e){var t,r,s,a,i,o,l,d,c,u=this,h=u.constructor,f=u.d,m=(e=new h(e)).d;if(!u.s||!e.s)return new h(0);for(e.s*=u.s,r=u.e+e.e,d=f.length,c=m.length,d<c&&(i=f,f=m,m=i,o=d,d=c,c=o),i=[],o=d+c,s=o;s--;)i.push(0);for(s=c;--s>=0;){for(t=0,a=d+s;a>s;)l=i[a]+m[s]*f[a-s-1]+t,i[a--]=l%ja|0,t=l/ja|0;i[a]=(i[a]+t)%ja|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,gs?Xn(e,h.precision):e};dr.toDecimalPlaces=dr.todp=function(e,t){var r=this,s=r.constructor;return r=new s(r),e===void 0?r:(vc(e,0,Rg),t===void 0?t=s.rounding:vc(t,0,8),Xn(r,e+Qs(r)+1,t))};dr.toExponential=function(e,t){var r,s=this,a=s.constructor;return e===void 0?r=hf(s,!0):(vc(e,0,Rg),t===void 0?t=a.rounding:vc(t,0,8),s=Xn(new a(s),e+1,t),r=hf(s,!0,e+1)),r};dr.toFixed=function(e,t){var r,s,a=this,i=a.constructor;return e===void 0?hf(a):(vc(e,0,Rg),t===void 0?t=i.rounding:vc(t,0,8),s=Xn(new i(a),e+Qs(a)+1,t),r=hf(s.abs(),!1,e+Qs(s)+1),a.isneg()&&!a.isZero()?"-"+r:r)};dr.toInteger=dr.toint=function(){var e=this,t=e.constructor;return Xn(new t(e),Qs(e)+1,t.rounding)};dr.toNumber=function(){return+this};dr.toPower=dr.pow=function(e){var t,r,s,a,i,o,l=this,d=l.constructor,c=12,u=+(e=new d(e));if(!e.s)return new d(lo);if(l=new d(l),!l.s){if(e.s<1)throw Error(Wo+"Infinity");return l}if(l.eq(lo))return l;if(s=d.precision,e.eq(lo))return Xn(l,s);if(t=e.e,r=e.d.length-1,o=t>=r,i=l.s,o){if((r=u<0?-u:u)<=YZ){for(a=new d(lo),t=Math.ceil(s/ds+4),gs=!1;r%2&&(a=a.times(l),q9(a.d,t)),r=Mg(r/2),r!==0;)l=l.times(l),q9(l.d,t);return gs=!0,e.s<0?new d(lo).div(a):Xn(a,s)}}else if(i<0)throw Error(Wo+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,gs=!1,a=e.times(pv(l,s+c)),gs=!0,a=QZ(a),a.s=i,a};dr.toPrecision=function(e,t){var r,s,a=this,i=a.constructor;return e===void 0?(r=Qs(a),s=hf(a,r<=i.toExpNeg||r>=i.toExpPos)):(vc(e,1,Rg),t===void 0?t=i.rounding:vc(t,0,8),a=Xn(new i(a),e,t),r=Qs(a),s=hf(a,e<=r||r<=i.toExpNeg,e)),s};dr.toSignificantDigits=dr.tosd=function(e,t){var r=this,s=r.constructor;return e===void 0?(e=s.precision,t=s.rounding):(vc(e,1,Rg),t===void 0?t=s.rounding:vc(t,0,8)),Xn(new s(r),e,t)};dr.toString=dr.valueOf=dr.val=dr.toJSON=dr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Qs(e),r=e.constructor;return hf(e,t<=r.toExpNeg||t>=r.toExpPos)};function ZZ(e,t){var r,s,a,i,o,l,d,c,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),gs?Xn(t,h):t;if(d=e.d,c=t.d,o=e.e,a=t.e,d=d.slice(),i=o-a,i){for(i<0?(s=d,i=-i,l=c.length):(s=c,a=o,l=d.length),o=Math.ceil(h/ds),l=o>l?o+1:l+1,i>l&&(i=l,s.length=1),s.reverse();i--;)s.push(0);s.reverse()}for(l=d.length,i=c.length,l-i<0&&(i=l,s=c,c=d,d=s),r=0;i;)r=(d[--i]=d[i]+c[i]+r)/ja|0,d[i]%=ja;for(r&&(d.unshift(r),++a),l=d.length;d[--l]==0;)d.pop();return t.d=d,t.e=a,gs?Xn(t,h):t}function vc(e,t,r){if(e!==~~e||e<t||e>r)throw Error(zh+e)}function tc(e){var t,r,s,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)s=e[t]+"",r=ds-s.length,r&&(i+=Ld(r)),i+=s;o=e[t],s=o+"",r=ds-s.length,r&&(i+=Ld(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var Kc=function(){function e(s,a){var i,o=0,l=s.length;for(s=s.slice();l--;)i=s[l]*a+o,s[l]=i%ja|0,o=i/ja|0;return o&&s.unshift(o),s}function t(s,a,i,o){var l,d;if(i!=o)d=i>o?1:-1;else for(l=d=0;l<i;l++)if(s[l]!=a[l]){d=s[l]>a[l]?1:-1;break}return d}function r(s,a,i){for(var o=0;i--;)s[i]-=o,o=s[i]<a[i]?1:0,s[i]=o*ja+s[i]-a[i];for(;!s[0]&&s.length>1;)s.shift()}return function(s,a,i,o){var l,d,c,u,h,f,m,p,g,x,v,y,b,j,T,O,R,D,B=s.constructor,q=s.s==a.s?1:-1,Y=s.d,G=a.d;if(!s.s)return new B(s);if(!a.s)throw Error(Wo+"Division by zero");for(d=s.e-a.e,R=G.length,T=Y.length,m=new B(q),p=m.d=[],c=0;G[c]==(Y[c]||0);)++c;if(G[c]>(Y[c]||0)&&--d,i==null?y=i=B.precision:o?y=i+(Qs(s)-Qs(a))+1:y=i,y<0)return new B(0);if(y=y/ds+2|0,c=0,R==1)for(u=0,G=G[0],y++;(c<T||u)&&y--;c++)b=u*ja+(Y[c]||0),p[c]=b/G|0,u=b%G|0;else{for(u=ja/(G[0]+1)|0,u>1&&(G=e(G,u),Y=e(Y,u),R=G.length,T=Y.length),j=R,g=Y.slice(0,R),x=g.length;x<R;)g[x++]=0;D=G.slice(),D.unshift(0),O=G[0],G[1]>=ja/2&&++O;do u=0,l=t(G,g,R,x),l<0?(v=g[0],R!=x&&(v=v*ja+(g[1]||0)),u=v/O|0,u>1?(u>=ja&&(u=ja-1),h=e(G,u),f=h.length,x=g.length,l=t(h,g,f,x),l==1&&(u--,r(h,R<f?D:G,f))):(u==0&&(l=u=1),h=G.slice()),f=h.length,f<x&&h.unshift(0),r(g,h,x),l==-1&&(x=g.length,l=t(G,g,R,x),l<1&&(u++,r(g,R<x?D:G,x))),x=g.length):l===0&&(u++,g=[0]),p[c++]=u,l&&g[0]?g[x++]=Y[j]||0:(g=[Y[j]],x=1);while((j++<T||g[0]!==void 0)&&y--)}return p[0]||p.shift(),m.e=d,Xn(m,o?i+Qs(m)+1:i)}}();function QZ(e,t){var r,s,a,i,o,l,d=0,c=0,u=e.constructor,h=u.precision;if(Qs(e)>16)throw Error($A+Qs(e));if(!e.s)return new u(lo);for(t==null?(gs=!1,l=h):l=t,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),c+=5;for(s=Math.log(mh(2,c))/Math.LN10*2+5|0,l+=s,r=a=i=new u(lo),u.precision=l;;){if(a=Xn(a.times(e),l),r=r.times(++d),o=i.plus(Kc(a,r,l)),tc(o.d).slice(0,l)===tc(i.d).slice(0,l)){for(;c--;)i=Xn(i.times(i),l);return u.precision=h,t==null?(gs=!0,Xn(i,h)):i}i=o}}function Qs(e){for(var t=e.e*ds,r=e.d[0];r>=10;r/=10)t++;return t}function m4(e,t,r){if(t>e.LN10.sd())throw gs=!0,r&&(e.precision=r),Error(Wo+"LN10 precision limit exceeded");return Xn(new e(e.LN10),t)}function Ld(e){for(var t="";e--;)t+="0";return t}function pv(e,t){var r,s,a,i,o,l,d,c,u,h=1,f=10,m=e,p=m.d,g=m.constructor,x=g.precision;if(m.s<1)throw Error(Wo+(m.s?"NaN":"-Infinity"));if(m.eq(lo))return new g(0);if(t==null?(gs=!1,c=x):c=t,m.eq(10))return t==null&&(gs=!0),m4(g,c);if(c+=f,g.precision=c,r=tc(p),s=r.charAt(0),i=Qs(m),Math.abs(i)<15e14){for(;s<7&&s!=1||s==1&&r.charAt(1)>3;)m=m.times(e),r=tc(m.d),s=r.charAt(0),h++;i=Qs(m),s>1?(m=new g("0."+r),i++):m=new g(s+"."+r.slice(1))}else return d=m4(g,c+2,x).times(i+""),m=pv(new g(s+"."+r.slice(1)),c-f).plus(d),g.precision=x,t==null?(gs=!0,Xn(m,x)):m;for(l=o=m=Kc(m.minus(lo),m.plus(lo),c),u=Xn(m.times(m),c),a=3;;){if(o=Xn(o.times(u),c),d=l.plus(Kc(o,new g(a),c)),tc(d.d).slice(0,c)===tc(l.d).slice(0,c))return l=l.times(2),i!==0&&(l=l.plus(m4(g,c+2,x).times(i+""))),l=Kc(l,new g(h),c),g.precision=x,t==null?(gs=!0,Xn(l,x)):l;l=d,a+=2}}function V9(e,t){var r,s,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(r<0&&(r=s),r+=+t.slice(s+1),t=t.substring(0,s)):r<0&&(r=t.length),s=0;t.charCodeAt(s)===48;)++s;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(s,a),t){if(a-=s,r=r-s-1,e.e=Mg(r/ds),e.d=[],s=(r+1)%ds,r<0&&(s+=ds),s<a){for(s&&e.d.push(+t.slice(0,s)),a-=ds;s<a;)e.d.push(+t.slice(s,s+=ds));t=t.slice(s),s=ds-t.length}else s-=a;for(;s--;)t+="0";if(e.d.push(+t),gs&&(e.e>i2||e.e<-i2))throw Error($A+r)}else e.s=0,e.e=0,e.d=[0];return e}function Xn(e,t,r){var s,a,i,o,l,d,c,u,h=e.d;for(o=1,i=h[0];i>=10;i/=10)o++;if(s=t-o,s<0)s+=ds,a=t,c=h[u=0];else{if(u=Math.ceil((s+1)/ds),i=h.length,u>=i)return e;for(c=i=h[u],o=1;i>=10;i/=10)o++;s%=ds,a=s-ds+o}if(r!==void 0&&(i=mh(10,o-a-1),l=c/i%10|0,d=t<0||h[u+1]!==void 0||c%i,d=r<4?(l||d)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||d||r==6&&(s>0?a>0?c/mh(10,o-a):0:h[u-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return d?(i=Qs(e),h.length=1,t=t-i-1,h[0]=mh(10,(ds-t%ds)%ds),e.e=Mg(-t/ds)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(s==0?(h.length=u,i=1,u--):(h.length=u+1,i=mh(10,ds-s),h[u]=a>0?(c/mh(10,o-a)%mh(10,a)|0)*i:0),d)for(;;)if(u==0){(h[0]+=i)==ja&&(h[0]=1,++e.e);break}else{if(h[u]+=i,h[u]!=ja)break;h[u--]=0,i=1}for(s=h.length;h[--s]===0;)h.pop();if(gs&&(e.e>i2||e.e<-i2))throw Error($A+Qs(e));return e}function JZ(e,t){var r,s,a,i,o,l,d,c,u,h,f=e.constructor,m=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),gs?Xn(t,m):t;if(d=e.d,h=t.d,s=t.e,c=e.e,d=d.slice(),o=c-s,o){for(u=o<0,u?(r=d,o=-o,l=h.length):(r=h,s=c,l=d.length),a=Math.max(Math.ceil(m/ds),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=d.length,l=h.length,u=a<l,u&&(l=a),a=0;a<l;a++)if(d[a]!=h[a]){u=d[a]<h[a];break}o=0}for(u&&(r=d,d=h,h=r,t.s=-t.s),l=d.length,a=h.length-l;a>0;--a)d[l++]=0;for(a=h.length;a>o;){if(d[--a]<h[a]){for(i=a;i&&d[--i]===0;)d[i]=ja-1;--d[i],d[a]+=ja}d[a]-=h[a]}for(;d[--l]===0;)d.pop();for(;d[0]===0;d.shift())--s;return d[0]?(t.d=d,t.e=s,gs?Xn(t,m):t):new f(0)}function hf(e,t,r){var s,a=Qs(e),i=tc(e.d),o=i.length;return t?(r&&(s=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+Ld(s):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Ld(-a-1)+i,r&&(s=r-o)>0&&(i+=Ld(s))):a>=o?(i+=Ld(a+1-o),r&&(s=r-a-1)>0&&(i=i+"."+Ld(s))):((s=a+1)<o&&(i=i.slice(0,s)+"."+i.slice(s)),r&&(s=r-o)>0&&(a+1===o&&(i+="."),i+=Ld(s))),e.s<0?"-"+i:i}function q9(e,t){if(e.length>t)return e.length=t,!0}function eQ(e){var t,r,s;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(zh+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return V9(o,i.toString())}else if(typeof i!="string")throw Error(zh+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,P$e.test(i))V9(o,i);else throw Error(zh+i)}if(a.prototype=dr,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=eQ,a.config=a.set=O$e,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(r=s[t++])||(e[r]=this[r]);return a.config(e),a}function O$e(e){if(!e||typeof e!="object")throw Error(Wo+"Object expected");var t,r,s,a=["precision",1,Rg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((s=e[r=a[t]])!==void 0)if(Mg(s)===s&&s>=a[t+1]&&s<=a[t+2])this[r]=s;else throw Error(zh+r+": "+s);if((s=e[r="LN10"])!==void 0)if(s==Math.LN10)this[r]=new this(s);else throw Error(zh+r+": "+s);return this}var FA=eQ(T$e);lo=new FA(1);const Un=FA;function R$e(e){return L$e(e)||D$e(e)||I$e(e)||M$e()}function M$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I$e(e,t){if(e){if(typeof e=="string")return R5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R5(e,t)}}function D$e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function L$e(e){if(Array.isArray(e))return R5(e)}function R5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}var B$e=function(t){return t},tQ={"@@functional/placeholder":!0},rQ=function(t){return t===tQ},W9=function(t){return function r(){return arguments.length===0||arguments.length===1&&rQ(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},$$e=function e(t,r){return t===1?r:W9(function(){for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];var o=a.filter(function(l){return l!==tQ}).length;return o>=t?r.apply(void 0,a):e(t-o,W9(function(){for(var l=arguments.length,d=new Array(l),c=0;c<l;c++)d[c]=arguments[c];var u=a.map(function(h){return rQ(h)?d.shift():h});return r.apply(void 0,R$e(u).concat(d))}))})},Tj=function(t){return $$e(t.length,t)},M5=function(t,r){for(var s=[],a=t;a<r;++a)s[a-t]=a;return s},F$e=Tj(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),z$e=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];if(!r.length)return B$e;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(l,d){return d(l)},i.apply(void 0,arguments))}},I5=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},nQ=function(t){var r=null,s=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(l,d){return l===r[d]})||(r=i,s=t.apply(void 0,i)),s}};function U$e(e){var t;return e===0?t=1:t=Math.floor(new Un(e).abs().log(10).toNumber())+1,t}function V$e(e,t,r){for(var s=new Un(e),a=0,i=[];s.lt(t)&&a<1e5;)i.push(s.toNumber()),s=s.add(r),a++;return i}var q$e=Tj(function(e,t,r){var s=+e,a=+t;return s+r*(a-s)}),W$e=Tj(function(e,t,r){var s=t-+e;return s=s||1/0,(r-e)/s}),H$e=Tj(function(e,t,r){var s=t-+e;return s=s||1/0,Math.max(0,Math.min(1,(r-e)/s))});const Pj={rangeStep:V$e,getDigitCount:U$e,interpolateNumber:q$e,uninterpolateNumber:W$e,uninterpolateTruncation:H$e};function D5(e){return X$e(e)||K$e(e)||sQ(e)||G$e()}function G$e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function K$e(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function X$e(e){if(Array.isArray(e))return L5(e)}function gv(e,t){return Q$e(e)||Z$e(e,t)||sQ(e,t)||Y$e()}function Y$e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sQ(e,t){if(e){if(typeof e=="string")return L5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L5(e,t)}}function L5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function Z$e(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],s=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),l;!(s=(l=o.next()).done)&&(r.push(l.value),!(t&&r.length===t));s=!0);}catch(d){a=!0,i=d}finally{try{!s&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function Q$e(e){if(Array.isArray(e))return e}function aQ(e){var t=gv(e,2),r=t[0],s=t[1],a=r,i=s;return r>s&&(a=s,i=r),[a,i]}function iQ(e,t,r){if(e.lte(0))return new Un(0);var s=Pj.getDigitCount(e.toNumber()),a=new Un(10).pow(s),i=e.div(a),o=s!==1?.05:.1,l=new Un(Math.ceil(i.div(o).toNumber())).add(r).mul(o),d=l.mul(a);return t?d:new Un(Math.ceil(d))}function J$e(e,t,r){var s=1,a=new Un(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(s=new Un(10).pow(Pj.getDigitCount(e)-1),a=new Un(Math.floor(a.div(s).toNumber())).mul(s)):i>1&&(a=new Un(Math.floor(e)))}else e===0?a=new Un(Math.floor((t-1)/2)):r||(a=new Un(Math.floor(e)));var o=Math.floor((t-1)/2),l=z$e(F$e(function(d){return a.add(new Un(d-o).mul(s)).toNumber()}),M5);return l(0,t)}function oQ(e,t,r,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Un(0),tickMin:new Un(0),tickMax:new Un(0)};var i=iQ(new Un(t).sub(e).div(r-1),s,a),o;e<=0&&t>=0?o=new Un(0):(o=new Un(e).add(t).div(2),o=o.sub(new Un(o).mod(i)));var l=Math.ceil(o.sub(e).div(i).toNumber()),d=Math.ceil(new Un(t).sub(o).div(i).toNumber()),c=l+d+1;return c>r?oQ(e,t,r,s,a+1):(c<r&&(d=t>0?d+(r-c):d,l=t>0?l:l+(r-c)),{step:i,tickMin:o.sub(new Un(l).mul(i)),tickMax:o.add(new Un(d).mul(i))})}function eFe(e){var t=gv(e,2),r=t[0],s=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),l=aQ([r,s]),d=gv(l,2),c=d[0],u=d[1];if(c===-1/0||u===1/0){var h=u===1/0?[c].concat(D5(M5(0,a-1).map(function(){return 1/0}))):[].concat(D5(M5(0,a-1).map(function(){return-1/0})),[u]);return r>s?I5(h):h}if(c===u)return J$e(c,a,i);var f=oQ(c,u,o,i),m=f.step,p=f.tickMin,g=f.tickMax,x=Pj.rangeStep(p,g.add(new Un(.1).mul(m)),m);return r>s?I5(x):x}function tFe(e,t){var r=gv(e,2),s=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=aQ([s,a]),l=gv(o,2),d=l[0],c=l[1];if(d===-1/0||c===1/0)return[s,a];if(d===c)return[d];var u=Math.max(t,2),h=iQ(new Un(c).sub(d).div(u-1),i,0),f=[].concat(D5(Pj.rangeStep(new Un(d),new Un(c).sub(new Un(.99).mul(h)),h)),[c]);return s>a?I5(f):f}var rFe=nQ(eFe),nFe=nQ(tFe),sFe="Invariant failed";function ff(e,t){throw new Error(sFe)}var aFe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function Pp(e){"@babel/helpers - typeof";return Pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pp(e)}function o2(){return o2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},o2.apply(this,arguments)}function iFe(e,t){return dFe(e)||cFe(e,t)||lFe(e,t)||oFe()}function oFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lFe(e,t){if(e){if(typeof e=="string")return H9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H9(e,t)}}function H9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function cFe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,l=[],d=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(l.push(s.value),l.length!==t);d=!0);}catch(u){c=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function dFe(e){if(Array.isArray(e))return e}function uFe(e,t){if(e==null)return{};var r=hFe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function hFe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function fFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mFe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,dQ(s.key),s)}}function pFe(e,t,r){return t&&mFe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function gFe(e,t,r){return t=l2(t),xFe(e,lQ()?Reflect.construct(t,r||[],l2(e).constructor):t.apply(e,r))}function xFe(e,t){if(t&&(Pp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return vFe(e)}function vFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lQ=function(){return!!e})()}function l2(e){return l2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},l2(e)}function yFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B5(e,t)}function B5(e,t){return B5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},B5(e,t)}function cQ(e,t,r){return t=dQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dQ(e){var t=bFe(e,"string");return Pp(t)=="symbol"?t:t+""}function bFe(e,t){if(Pp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Pp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oj=function(e){function t(){return fFe(this,t),gFe(this,t,arguments)}return yFe(t,e),pFe(t,[{key:"render",value:function(){var s=this.props,a=s.offset,i=s.layout,o=s.width,l=s.dataKey,d=s.data,c=s.dataPointFormatter,u=s.xAxis,h=s.yAxis,f=uFe(s,aFe),m=on(f,!1);this.props.direction==="x"&&u.type!=="number"&&ff();var p=d.map(function(g){var x=c(g,l),v=x.x,y=x.y,b=x.value,j=x.errorVal;if(!j)return null;var T=[],O,R;if(Array.isArray(j)){var D=iFe(j,2);O=D[0],R=D[1]}else O=R=j;if(i==="vertical"){var B=u.scale,q=y+a,Y=q+o,G=q-o,I=B(b-O),F=B(b+R);T.push({x1:F,y1:Y,x2:F,y2:G}),T.push({x1:I,y1:q,x2:F,y2:q}),T.push({x1:I,y1:Y,x2:I,y2:G})}else if(i==="horizontal"){var S=h.scale,E=v+a,N=E-o,C=E+o,k=S(b-O),M=S(b+R);T.push({x1:N,y1:M,x2:C,y2:M}),T.push({x1:E,y1:k,x2:E,y2:M}),T.push({x1:N,y1:k,x2:C,y2:k})}return je.createElement(Ns,o2({className:"recharts-errorBar",key:"bar-".concat(T.map(function(U){return"".concat(U.x1,"-").concat(U.x2,"-").concat(U.y1,"-").concat(U.y2)}))},m),T.map(function(U){return je.createElement("line",o2({},U,{key:"line-".concat(U.x1,"-").concat(U.x2,"-").concat(U.y1,"-").concat(U.y2)}))}))});return je.createElement(Ns,{className:"recharts-errorBars"},p)}}])}(je.Component);cQ(Oj,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});cQ(Oj,"displayName","ErrorBar");function xv(e){"@babel/helpers - typeof";return xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xv(e)}function G9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function ah(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G9(Object(r),!0).forEach(function(s){wFe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function wFe(e,t,r){return t=_Fe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Fe(e){var t=jFe(e,"string");return xv(t)=="symbol"?t:t+""}function jFe(e,t){if(xv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(xv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uQ=function(t){var r=t.children,s=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,o=ro(r,$h);if(!o)return null;var l=$h.defaultProps,d=l!==void 0?ah(ah({},l),o.props):{},c;return o.props&&o.props.payload?c=o.props&&o.props.payload:i==="children"?c=(s||[]).reduce(function(u,h){var f=h.item,m=h.props,p=m.sectors||m.data||[];return u.concat(p.map(function(g){return{type:o.props.iconType||f.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):c=(s||[]).map(function(u){var h=u.item,f=h.type.defaultProps,m=f!==void 0?ah(ah({},f),h.props):{},p=m.dataKey,g=m.name,x=m.legendType,v=m.hide;return{inactive:v,dataKey:p,type:d.iconType||x||"square",color:zA(h),value:g||p,payload:m}}),ah(ah(ah({},d),$h.getWithHeight(o,a)),{},{payload:c,item:o})};function vv(e){"@babel/helpers - typeof";return vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vv(e)}function K9(e){return EFe(e)||CFe(e)||SFe(e)||NFe()}function NFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function SFe(e,t){if(e){if(typeof e=="string")return $5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $5(e,t)}}function CFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function EFe(e){if(Array.isArray(e))return $5(e)}function $5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function X9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function $s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X9(Object(r),!0).forEach(function(s){qm(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function qm(e,t,r){return t=kFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kFe(e){var t=AFe(e,"string");return vv(t)=="symbol"?t:t+""}function AFe(e,t){if(vv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(vv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xo(e,t,r){return un(e)||un(t)?r:ha(t)?Bo(e,t,r):Yr(t)?t(e):r}function rx(e,t,r,s){var a=C$e(e,function(l){return xo(l,t)});if(r==="number"){var i=a.filter(function(l){return Kt(l)||parseFloat(l)});return i.length?[Aj(i),eu(i)]:[1/0,-1/0]}var o=s?a.filter(function(l){return!un(l)}):a;return o.map(function(l){return ha(l)||l instanceof Date?l:""})}var TFe=function(t){var r,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,l=(r=s==null?void 0:s.length)!==null&&r!==void 0?r:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var d=i.range,c=0;c<l;c++){var u=c>0?a[c-1].coordinate:a[l-1].coordinate,h=a[c].coordinate,f=c>=l-1?a[0].coordinate:a[c+1].coordinate,m=void 0;if(xl(h-u)!==xl(f-h)){var p=[];if(xl(f-h)===xl(d[1]-d[0])){m=f;var g=h+d[1]-d[0];p[0]=Math.min(g,(g+u)/2),p[1]=Math.max(g,(g+u)/2)}else{m=u;var x=f+d[1]-d[0];p[0]=Math.min(h,(x+h)/2),p[1]=Math.max(h,(x+h)/2)}var v=[Math.min(h,(m+h)/2),Math.max(h,(m+h)/2)];if(t>v[0]&&t<=v[1]||t>=p[0]&&t<=p[1]){o=a[c].index;break}}else{var y=Math.min(u,f),b=Math.max(u,f);if(t>(y+h)/2&&t<=(b+h)/2){o=a[c].index;break}}}else for(var j=0;j<l;j++)if(j===0&&t<=(s[j].coordinate+s[j+1].coordinate)/2||j>0&&j<l-1&&t>(s[j].coordinate+s[j-1].coordinate)/2&&t<=(s[j].coordinate+s[j+1].coordinate)/2||j===l-1&&t>(s[j].coordinate+s[j-1].coordinate)/2){o=s[j].index;break}return o},zA=function(t){var r,s=t,a=s.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?$s($s({},t.type.defaultProps),t.props):t.props,o=i.stroke,l=i.fill,d;switch(a){case"Line":d=o;break;case"Area":case"Radar":d=o&&o!=="none"?o:l;break;default:d=l;break}return d},PFe=function(t){var r=t.barSize,s=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},l=Object.keys(i),d=0,c=l.length;d<c;d++)for(var u=i[l[d]].stackGroups,h=Object.keys(u),f=0,m=h.length;f<m;f++){var p=u[h[f]],g=p.items,x=p.cateAxisId,v=g.filter(function(R){return Wc(R.type).indexOf("Bar")>=0});if(v&&v.length){var y=v[0].type.defaultProps,b=y!==void 0?$s($s({},y),v[0].props):v[0].props,j=b.barSize,T=b[x];o[T]||(o[T]=[]);var O=un(j)?r:j;o[T].push({item:v[0],stackList:v.slice(1),barSize:un(O)?void 0:uf(O,s,0)})}}return o},OFe=function(t){var r=t.barGap,s=t.barCategoryGap,a=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,l=t.maxBarSize,d=o.length;if(d<1)return null;var c=uf(r,a,0,!0),u,h=[];if(o[0].barSize===+o[0].barSize){var f=!1,m=a/d,p=o.reduce(function(j,T){return j+T.barSize||0},0);p+=(d-1)*c,p>=a&&(p-=(d-1)*c,c=0),p>=a&&m>0&&(f=!0,m*=.9,p=d*m);var g=(a-p)/2>>0,x={offset:g-c,size:0};u=o.reduce(function(j,T){var O={item:T.item,position:{offset:x.offset+x.size+c,size:f?m:T.barSize}},R=[].concat(K9(j),[O]);return x=R[R.length-1].position,T.stackList&&T.stackList.length&&T.stackList.forEach(function(D){R.push({item:D,position:x})}),R},h)}else{var v=uf(s,a,0,!0);a-2*v-(d-1)*c<=0&&(c=0);var y=(a-2*v-(d-1)*c)/d;y>1&&(y>>=0);var b=l===+l?Math.min(y,l):y;u=o.reduce(function(j,T,O){var R=[].concat(K9(j),[{item:T.item,position:{offset:v+(y+c)*O+(y-b)/2,size:b}}]);return T.stackList&&T.stackList.length&&T.stackList.forEach(function(D){R.push({item:D,position:R[R.length-1].position})}),R},h)}return u},RFe=function(t,r,s,a){var i=s.children,o=s.width,l=s.margin,d=o-(l.left||0)-(l.right||0),c=uQ({children:i,legendWidth:d});if(c){var u=a||{},h=u.width,f=u.height,m=c.align,p=c.verticalAlign,g=c.layout;if((g==="vertical"||g==="horizontal"&&p==="middle")&&m!=="center"&&Kt(t[m]))return $s($s({},t),{},qm({},m,t[m]+(h||0)));if((g==="horizontal"||g==="vertical"&&m==="center")&&p!=="middle"&&Kt(t[p]))return $s($s({},t),{},qm({},p,t[p]+(f||0)))}return t},MFe=function(t,r,s){return un(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||s==="x"?r==="xAxis":s==="y"?r==="yAxis":!0},hQ=function(t,r,s,a,i){var o=r.props.children,l=_l(o,Oj).filter(function(c){return MFe(a,i,c.props.direction)});if(l&&l.length){var d=l.map(function(c){return c.props.dataKey});return t.reduce(function(c,u){var h=xo(u,s);if(un(h))return c;var f=Array.isArray(h)?[Aj(h),eu(h)]:[h,h],m=d.reduce(function(p,g){var x=xo(u,g,0),v=f[0]-Math.abs(Array.isArray(x)?x[0]:x),y=f[1]+Math.abs(Array.isArray(x)?x[1]:x);return[Math.min(v,p[0]),Math.max(y,p[1])]},[1/0,-1/0]);return[Math.min(m[0],c[0]),Math.max(m[1],c[1])]},[1/0,-1/0])}return null},IFe=function(t,r,s,a,i){var o=r.map(function(l){return hQ(t,l,s,i,a)}).filter(function(l){return!un(l)});return o&&o.length?o.reduce(function(l,d){return[Math.min(l[0],d[0]),Math.max(l[1],d[1])]},[1/0,-1/0]):null},fQ=function(t,r,s,a,i){var o=r.map(function(d){var c=d.props.dataKey;return s==="number"&&c&&hQ(t,d,c,a)||rx(t,c,s,i)});if(s==="number")return o.reduce(function(d,c){return[Math.min(d[0],c[0]),Math.max(d[1],c[1])]},[1/0,-1/0]);var l={};return o.reduce(function(d,c){for(var u=0,h=c.length;u<h;u++)l[c[u]]||(l[c[u]]=!0,d.push(c[u]));return d},[])},mQ=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},pQ=function(t,r,s,a){if(a)return t.map(function(d){return d.coordinate});var i,o,l=t.map(function(d){return d.coordinate===r&&(i=!0),d.coordinate===s&&(o=!0),d.coordinate});return i||l.push(r),o||l.push(s),l},Vc=function(t,r,s){if(!t)return null;var a=t.scale,i=t.duplicateDomain,o=t.type,l=t.range,d=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,c=(r||s)&&o==="category"&&a.bandwidth?a.bandwidth()/d:0;if(c=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?xl(l[0]-l[1])*2*c:c,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(h){var f=i?i.indexOf(h):h;return{coordinate:a(f)+c,value:h,offset:c}});return u.filter(function(h){return!kg(h.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(h,f){return{coordinate:a(h)+c,value:h,index:f,offset:c}}):a.ticks&&!s?a.ticks(t.tickCount).map(function(h){return{coordinate:a(h)+c,value:h,offset:c}}):a.domain().map(function(h,f){return{coordinate:a(h)+c,value:i?i[h]:h,index:f,offset:c}})},p4=new WeakMap,Vy=function(t,r){if(typeof r!="function")return t;p4.has(t)||p4.set(t,new WeakMap);var s=p4.get(t);if(s.has(r))return s.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return s.set(r,a),a},DFe=function(t,r,s){var a=t.scale,i=t.type,o=t.layout,l=t.axisType;if(a==="auto")return o==="radial"&&l==="radiusAxis"?{scale:cv(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:r2(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!s)?{scale:tx(),realScaleType:"point"}:i==="category"?{scale:cv(),realScaleType:"band"}:{scale:r2(),realScaleType:"linear"};if(df(a)){var d="scale".concat(gj(a));return{scale:(U9[d]||tx)(),realScaleType:U9[d]?d:"point"}}return Yr(a)?{scale:a}:{scale:tx(),realScaleType:"point"}},Y9=1e-4,LFe=function(t){var r=t.domain();if(!(!r||r.length<=2)){var s=r.length,a=t.range(),i=Math.min(a[0],a[1])-Y9,o=Math.max(a[0],a[1])+Y9,l=t(r[0]),d=t(r[s-1]);(l<i||l>o||d<i||d>o)&&t.domain([r[0],r[s-1]])}},BFe=function(t,r){if(!t)return null;for(var s=0,a=t.length;s<a;s++)if(t[s].item===r)return t[s].position;return null},$Fe=function(t,r){if(!r||r.length!==2||!Kt(r[0])||!Kt(r[1]))return t;var s=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!Kt(t[0])||t[0]<s)&&(i[0]=s),(!Kt(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<s&&(i[1]=s),i},FFe=function(t){var r=t.length;if(!(r<=0))for(var s=0,a=t[0].length;s<a;++s)for(var i=0,o=0,l=0;l<r;++l){var d=kg(t[l][s][1])?t[l][s][0]:t[l][s][1];d>=0?(t[l][s][0]=i,t[l][s][1]=i+d,i=t[l][s][1]):(t[l][s][0]=o,t[l][s][1]=o+d,o=t[l][s][1])}},zFe=function(t){var r=t.length;if(!(r<=0))for(var s=0,a=t[0].length;s<a;++s)for(var i=0,o=0;o<r;++o){var l=kg(t[o][s][1])?t[o][s][0]:t[o][s][1];l>=0?(t[o][s][0]=i,t[o][s][1]=i+l,i=t[o][s][1]):(t[o][s][0]=0,t[o][s][1]=0)}},UFe={sign:FFe,expand:rAe,none:jp,silhouette:nAe,wiggle:sAe,positive:zFe},VFe=function(t,r,s){var a=r.map(function(l){return l.props.dataKey}),i=UFe[s],o=tAe().keys(a).value(function(l,d){return+xo(l,d,0)}).order(d5).offset(i);return o(t)},qFe=function(t,r,s,a,i,o){if(!t)return null;var l=o?r.reverse():r,d={},c=l.reduce(function(h,f){var m,p=(m=f.type)!==null&&m!==void 0&&m.defaultProps?$s($s({},f.type.defaultProps),f.props):f.props,g=p.stackId,x=p.hide;if(x)return h;var v=p[s],y=h[v]||{hasStack:!1,stackGroups:{}};if(ha(g)){var b=y.stackGroups[g]||{numericAxisId:s,cateAxisId:a,items:[]};b.items.push(f),y.hasStack=!0,y.stackGroups[g]=b}else y.stackGroups[j1("_stackId_")]={numericAxisId:s,cateAxisId:a,items:[f]};return $s($s({},h),{},qm({},v,y))},d),u={};return Object.keys(c).reduce(function(h,f){var m=c[f];if(m.hasStack){var p={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(g,x){var v=m.stackGroups[x];return $s($s({},g),{},qm({},x,{numericAxisId:s,cateAxisId:a,items:v.items,stackedData:VFe(t,v.items,i)}))},p)}return $s($s({},h),{},qm({},f,m))},u)},WFe=function(t,r){var s=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,l=r.allowDecimals,d=s||r.scale;if(d!=="auto"&&d!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var c=t.domain();if(!c.length)return null;var u=rFe(c,i,l);return t.domain([Aj(u),eu(u)]),{niceTicks:u}}if(i&&a==="number"){var h=t.domain(),f=nFe(h,i,l);return{niceTicks:f}}return null};function Z9(e){var t=e.axis,r=e.ticks,s=e.bandSize,a=e.entry,i=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!un(a[t.dataKey])){var l=Rw(r,"value",a[t.dataKey]);if(l)return l.coordinate+s/2}return r[i]?r[i].coordinate+s/2:null}var d=xo(a,un(o)?t.dataKey:o);return un(d)?null:t.scale(d)}var Q9=function(t){var r=t.axis,s=t.ticks,a=t.offset,i=t.bandSize,o=t.entry,l=t.index;if(r.type==="category")return s[l]?s[l].coordinate+a:null;var d=xo(o,r.dataKey,r.domain[l]);return un(d)?null:r.scale(d)-i/2+a},HFe=function(t){var r=t.numericAxis,s=r.scale.domain();if(r.type==="number"){var a=Math.min(s[0],s[1]),i=Math.max(s[0],s[1]);return a<=0&&i>=0?0:i<0?i:a}return s[0]},GFe=function(t,r){var s,a=(s=t.type)!==null&&s!==void 0&&s.defaultProps?$s($s({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(ha(i)){var o=r[i];if(o){var l=o.items.indexOf(t);return l>=0?o.stackedData[l]:null}}return null},KFe=function(t){return t.reduce(function(r,s){return[Aj(s.concat([r[0]]).filter(Kt)),eu(s.concat([r[1]]).filter(Kt))]},[1/0,-1/0])},gQ=function(t,r,s){return Object.keys(t).reduce(function(a,i){var o=t[i],l=o.stackedData,d=l.reduce(function(c,u){var h=KFe(u.slice(r,s+1));return[Math.min(c[0],h[0]),Math.max(c[1],h[1])]},[1/0,-1/0]);return[Math.min(d[0],a[0]),Math.max(d[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},J9=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,eD=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,F5=function(t,r,s){if(Yr(t))return t(r,s);if(!Array.isArray(t))return r;var a=[];if(Kt(t[0]))a[0]=s?t[0]:Math.min(t[0],r[0]);else if(J9.test(t[0])){var i=+J9.exec(t[0])[1];a[0]=r[0]-i}else Yr(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Kt(t[1]))a[1]=s?t[1]:Math.max(t[1],r[1]);else if(eD.test(t[1])){var o=+eD.exec(t[1])[1];a[1]=r[1]+o}else Yr(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},c2=function(t,r,s){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!s||a>0)return a}if(t&&r&&r.length>=2){for(var i=pA(r,function(h){return h.coordinate}),o=1/0,l=1,d=i.length;l<d;l++){var c=i[l],u=i[l-1];o=Math.min((c.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return s?void 0:0},tD=function(t,r,s){return!t||!t.length||mv(t,Bo(s,"type.defaultProps.domain"))?r:t},xQ=function(t,r){var s=t.type.defaultProps?$s($s({},t.type.defaultProps),t.props):t.props,a=s.dataKey,i=s.name,o=s.unit,l=s.formatter,d=s.tooltipType,c=s.chartType,u=s.hide;return $s($s({},on(t,!1)),{},{dataKey:a,unit:o,formatter:l,name:i||a,color:zA(t),value:xo(r,a),type:d,payload:r,chartType:c,hide:u})};function yv(e){"@babel/helpers - typeof";return yv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yv(e)}function rD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function nD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rD(Object(r),!0).forEach(function(s){XFe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function XFe(e,t,r){return t=YFe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YFe(e){var t=ZFe(e,"string");return yv(t)=="symbol"?t:t+""}function ZFe(e,t){if(yv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(yv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var d2=Math.PI/180,QFe=function(t){return t*180/Math.PI},za=function(t,r,s,a){return{x:t+Math.cos(-d2*a)*s,y:r+Math.sin(-d2*a)*s}},JFe=function(t,r){var s=t.x,a=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(s-i,2)+Math.pow(a-o,2))},eze=function(t,r){var s=t.x,a=t.y,i=r.cx,o=r.cy,l=JFe({x:s,y:a},{x:i,y:o});if(l<=0)return{radius:l};var d=(s-i)/l,c=Math.acos(d);return a>o&&(c=2*Math.PI-c),{radius:l,angle:QFe(c),angleInRadian:c}},tze=function(t){var r=t.startAngle,s=t.endAngle,a=Math.floor(r/360),i=Math.floor(s/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:s-o*360}},rze=function(t,r){var s=r.startAngle,a=r.endAngle,i=Math.floor(s/360),o=Math.floor(a/360),l=Math.min(i,o);return t+l*360},sD=function(t,r){var s=t.x,a=t.y,i=eze({x:s,y:a},r),o=i.radius,l=i.angle,d=r.innerRadius,c=r.outerRadius;if(o<d||o>c)return!1;if(o===0)return!0;var u=tze(r),h=u.startAngle,f=u.endAngle,m=l,p;if(h<=f){for(;m>f;)m-=360;for(;m<h;)m+=360;p=m>=h&&m<=f}else{for(;m>h;)m-=360;for(;m<f;)m+=360;p=m>=f&&m<=h}return p?nD(nD({},r),{},{radius:o,angle:rze(m,r)}):null};function bv(e){"@babel/helpers - typeof";return bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bv(e)}var nze=["offset"];function sze(e){return lze(e)||oze(e)||ize(e)||aze()}function aze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ize(e,t){if(e){if(typeof e=="string")return z5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z5(e,t)}}function oze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function lze(e){if(Array.isArray(e))return z5(e)}function z5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function cze(e,t){if(e==null)return{};var r=dze(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function dze(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function aD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function sa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aD(Object(r),!0).forEach(function(s){uze(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function uze(e,t,r){return t=hze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hze(e){var t=fze(e,"string");return bv(t)=="symbol"?t:t+""}function fze(e,t){if(bv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(bv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wv(){return wv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},wv.apply(this,arguments)}var mze=function(t){var r=t.value,s=t.formatter,a=un(t.children)?r:t.children;return Yr(s)?s(a):a},pze=function(t,r){var s=xl(r-t),a=Math.min(Math.abs(r-t),360);return s*a},gze=function(t,r,s){var a=t.position,i=t.viewBox,o=t.offset,l=t.className,d=i,c=d.cx,u=d.cy,h=d.innerRadius,f=d.outerRadius,m=d.startAngle,p=d.endAngle,g=d.clockWise,x=(h+f)/2,v=pze(m,p),y=v>=0?1:-1,b,j;a==="insideStart"?(b=m+y*o,j=g):a==="insideEnd"?(b=p-y*o,j=!g):a==="end"&&(b=p+y*o,j=g),j=v<=0?j:!j;var T=za(c,u,x,b),O=za(c,u,x,b+(j?1:-1)*359),R="M".concat(T.x,",").concat(T.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(j?0:1,`,
    `).concat(O.x,",").concat(O.y),D=un(t.id)?j1("recharts-radial-line-"):t.id;return je.createElement("text",wv({},s,{dominantBaseline:"central",className:pn("recharts-radial-bar-label",l)}),je.createElement("defs",null,je.createElement("path",{id:D,d:R})),je.createElement("textPath",{xlinkHref:"#".concat(D)},r))},xze=function(t){var r=t.viewBox,s=t.offset,a=t.position,i=r,o=i.cx,l=i.cy,d=i.innerRadius,c=i.outerRadius,u=i.startAngle,h=i.endAngle,f=(u+h)/2;if(a==="outside"){var m=za(o,l,c+s,f),p=m.x,g=m.y;return{x:p,y:g,textAnchor:p>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var x=(d+c)/2,v=za(o,l,x,f),y=v.x,b=v.y;return{x:y,y:b,textAnchor:"middle",verticalAnchor:"middle"}},vze=function(t){var r=t.viewBox,s=t.parentViewBox,a=t.offset,i=t.position,o=r,l=o.x,d=o.y,c=o.width,u=o.height,h=u>=0?1:-1,f=h*a,m=h>0?"end":"start",p=h>0?"start":"end",g=c>=0?1:-1,x=g*a,v=g>0?"end":"start",y=g>0?"start":"end";if(i==="top"){var b={x:l+c/2,y:d-h*a,textAnchor:"middle",verticalAnchor:m};return sa(sa({},b),s?{height:Math.max(d-s.y,0),width:c}:{})}if(i==="bottom"){var j={x:l+c/2,y:d+u+f,textAnchor:"middle",verticalAnchor:p};return sa(sa({},j),s?{height:Math.max(s.y+s.height-(d+u),0),width:c}:{})}if(i==="left"){var T={x:l-x,y:d+u/2,textAnchor:v,verticalAnchor:"middle"};return sa(sa({},T),s?{width:Math.max(T.x-s.x,0),height:u}:{})}if(i==="right"){var O={x:l+c+x,y:d+u/2,textAnchor:y,verticalAnchor:"middle"};return sa(sa({},O),s?{width:Math.max(s.x+s.width-O.x,0),height:u}:{})}var R=s?{width:c,height:u}:{};return i==="insideLeft"?sa({x:l+x,y:d+u/2,textAnchor:y,verticalAnchor:"middle"},R):i==="insideRight"?sa({x:l+c-x,y:d+u/2,textAnchor:v,verticalAnchor:"middle"},R):i==="insideTop"?sa({x:l+c/2,y:d+f,textAnchor:"middle",verticalAnchor:p},R):i==="insideBottom"?sa({x:l+c/2,y:d+u-f,textAnchor:"middle",verticalAnchor:m},R):i==="insideTopLeft"?sa({x:l+x,y:d+f,textAnchor:y,verticalAnchor:p},R):i==="insideTopRight"?sa({x:l+c-x,y:d+f,textAnchor:v,verticalAnchor:p},R):i==="insideBottomLeft"?sa({x:l+x,y:d+u-f,textAnchor:y,verticalAnchor:m},R):i==="insideBottomRight"?sa({x:l+c-x,y:d+u-f,textAnchor:v,verticalAnchor:m},R):Ng(i)&&(Kt(i.x)||jh(i.x))&&(Kt(i.y)||jh(i.y))?sa({x:l+uf(i.x,c),y:d+uf(i.y,u),textAnchor:"end",verticalAnchor:"end"},R):sa({x:l+c/2,y:d+u/2,textAnchor:"middle",verticalAnchor:"middle"},R)},yze=function(t){return"cx"in t&&Kt(t.cx)};function ri(e){var t=e.offset,r=t===void 0?5:t,s=cze(e,nze),a=sa({offset:r},s),i=a.viewBox,o=a.position,l=a.value,d=a.children,c=a.content,u=a.className,h=u===void 0?"":u,f=a.textBreakAll;if(!i||un(l)&&un(d)&&!P.isValidElement(c)&&!Yr(c))return null;if(P.isValidElement(c))return P.cloneElement(c,a);var m;if(Yr(c)){if(m=P.createElement(c,a),P.isValidElement(m))return m}else m=mze(a);var p=yze(i),g=on(a,!0);if(p&&(o==="insideStart"||o==="insideEnd"||o==="end"))return gze(a,m,g);var x=p?xze(a):vze(a);return je.createElement(Xw,wv({className:pn("recharts-label",h)},g,x,{breakAll:f}),m)}ri.displayName="Label";var vQ=function(t){var r=t.cx,s=t.cy,a=t.angle,i=t.startAngle,o=t.endAngle,l=t.r,d=t.radius,c=t.innerRadius,u=t.outerRadius,h=t.x,f=t.y,m=t.top,p=t.left,g=t.width,x=t.height,v=t.clockWise,y=t.labelViewBox;if(y)return y;if(Kt(g)&&Kt(x)){if(Kt(h)&&Kt(f))return{x:h,y:f,width:g,height:x};if(Kt(m)&&Kt(p))return{x:m,y:p,width:g,height:x}}return Kt(h)&&Kt(f)?{x:h,y:f,width:0,height:0}:Kt(r)&&Kt(s)?{cx:r,cy:s,startAngle:i||a||0,endAngle:o||a||0,innerRadius:c||0,outerRadius:u||d||l||0,clockWise:v}:t.viewBox?t.viewBox:{}},bze=function(t,r){return t?t===!0?je.createElement(ri,{key:"label-implicit",viewBox:r}):ha(t)?je.createElement(ri,{key:"label-implicit",viewBox:r,value:t}):P.isValidElement(t)?t.type===ri?P.cloneElement(t,{key:"label-implicit",viewBox:r}):je.createElement(ri,{key:"label-implicit",content:t,viewBox:r}):Yr(t)?je.createElement(ri,{key:"label-implicit",content:t,viewBox:r}):Ng(t)?je.createElement(ri,wv({viewBox:r},t,{key:"label-implicit"})):null:null},wze=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&s&&!t.label)return null;var a=t.children,i=vQ(t),o=_l(a,ri).map(function(d,c){return P.cloneElement(d,{viewBox:r||i,key:"label-".concat(c)})});if(!s)return o;var l=bze(t.label,r||i);return[l].concat(sze(o))};ri.parseViewBox=vQ;ri.renderCallByParent=wze;function _ze(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var jze=_ze;const Nze=Ln(jze);function _v(e){"@babel/helpers - typeof";return _v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_v(e)}var Sze=["valueAccessor"],Cze=["data","dataKey","clockWise","id","textBreakAll"];function Eze(e){return Pze(e)||Tze(e)||Aze(e)||kze()}function kze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Aze(e,t){if(e){if(typeof e=="string")return U5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U5(e,t)}}function Tze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Pze(e){if(Array.isArray(e))return U5(e)}function U5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function u2(){return u2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},u2.apply(this,arguments)}function iD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function oD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iD(Object(r),!0).forEach(function(s){Oze(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Oze(e,t,r){return t=Rze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rze(e){var t=Mze(e,"string");return _v(t)=="symbol"?t:t+""}function Mze(e,t){if(_v(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(_v(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lD(e,t){if(e==null)return{};var r=Ize(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function Ize(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}var Dze=function(t){return Array.isArray(t.value)?Nze(t.value):t.value};function gu(e){var t=e.valueAccessor,r=t===void 0?Dze:t,s=lD(e,Sze),a=s.data,i=s.dataKey,o=s.clockWise,l=s.id,d=s.textBreakAll,c=lD(s,Cze);return!a||!a.length?null:je.createElement(Ns,{className:"recharts-label-list"},a.map(function(u,h){var f=un(i)?r(u,h):xo(u&&u.payload,i),m=un(l)?{}:{id:"".concat(l,"-").concat(h)};return je.createElement(ri,u2({},on(u,!0),c,m,{parentViewBox:u.parentViewBox,value:f,textBreakAll:d,viewBox:ri.parseViewBox(un(o)?u:oD(oD({},u),{},{clockWise:o})),key:"label-".concat(h),index:h}))}))}gu.displayName="LabelList";function Lze(e,t){return e?e===!0?je.createElement(gu,{key:"labelList-implicit",data:t}):je.isValidElement(e)||Yr(e)?je.createElement(gu,{key:"labelList-implicit",data:t,content:e}):Ng(e)?je.createElement(gu,u2({data:t},e,{key:"labelList-implicit"})):null:null}function Bze(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var s=e.children,a=_l(s,gu).map(function(o,l){return P.cloneElement(o,{data:t,key:"labelList-".concat(l)})});if(!r)return a;var i=Lze(e.label,t);return[i].concat(Eze(a))}gu.renderCallByParent=Bze;function jv(e){"@babel/helpers - typeof";return jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jv(e)}function V5(){return V5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},V5.apply(this,arguments)}function cD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function dD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cD(Object(r),!0).forEach(function(s){$ze(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function $ze(e,t,r){return t=Fze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fze(e){var t=zze(e,"string");return jv(t)=="symbol"?t:t+""}function zze(e,t){if(jv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(jv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uze=function(t,r){var s=xl(r-t),a=Math.min(Math.abs(r-t),359.999);return s*a},qy=function(t){var r=t.cx,s=t.cy,a=t.radius,i=t.angle,o=t.sign,l=t.isExternal,d=t.cornerRadius,c=t.cornerIsExternal,u=d*(l?1:-1)+a,h=Math.asin(d/u)/d2,f=c?i:i+o*h,m=za(r,s,u,f),p=za(r,s,a,f),g=c?i-o*h:i,x=za(r,s,u*Math.cos(h*d2),g);return{center:m,circleTangency:p,lineTangency:x,theta:h}},yQ=function(t){var r=t.cx,s=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.startAngle,l=t.endAngle,d=Uze(o,l),c=o+d,u=za(r,s,i,o),h=za(r,s,i,c),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(d)>180),",").concat(+(o>c),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(a>0){var m=za(r,s,a,o),p=za(r,s,a,c);f+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(d)>180),",").concat(+(o<=c),`,
            `).concat(m.x,",").concat(m.y," Z")}else f+="L ".concat(r,",").concat(s," Z");return f},Vze=function(t){var r=t.cx,s=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,d=t.cornerIsExternal,c=t.startAngle,u=t.endAngle,h=xl(u-c),f=qy({cx:r,cy:s,radius:i,angle:c,sign:h,cornerRadius:o,cornerIsExternal:d}),m=f.circleTangency,p=f.lineTangency,g=f.theta,x=qy({cx:r,cy:s,radius:i,angle:u,sign:-h,cornerRadius:o,cornerIsExternal:d}),v=x.circleTangency,y=x.lineTangency,b=x.theta,j=d?Math.abs(c-u):Math.abs(c-u)-g-b;if(j<0)return l?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):yQ({cx:r,cy:s,innerRadius:a,outerRadius:i,startAngle:c,endAngle:u});var T="M ".concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(j>180),",").concat(+(h<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(y.x,",").concat(y.y,`
  `);if(a>0){var O=qy({cx:r,cy:s,radius:a,angle:c,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),R=O.circleTangency,D=O.lineTangency,B=O.theta,q=qy({cx:r,cy:s,radius:a,angle:u,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),Y=q.circleTangency,G=q.lineTangency,I=q.theta,F=d?Math.abs(c-u):Math.abs(c-u)-B-I;if(F<0&&o===0)return"".concat(T,"L").concat(r,",").concat(s,"Z");T+="L".concat(G.x,",").concat(G.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(Y.x,",").concat(Y.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(F>180),",").concat(+(h>0),",").concat(R.x,",").concat(R.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(D.x,",").concat(D.y,"Z")}else T+="L".concat(r,",").concat(s,"Z");return T},qze={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},bQ=function(t){var r=dD(dD({},qze),t),s=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,l=r.cornerRadius,d=r.forceCornerRadius,c=r.cornerIsExternal,u=r.startAngle,h=r.endAngle,f=r.className;if(o<i||u===h)return null;var m=pn("recharts-sector",f),p=o-i,g=uf(l,p,0,!0),x;return g>0&&Math.abs(u-h)<360?x=Vze({cx:s,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(g,p/2),forceCornerRadius:d,cornerIsExternal:c,startAngle:u,endAngle:h}):x=yQ({cx:s,cy:a,innerRadius:i,outerRadius:o,startAngle:u,endAngle:h}),je.createElement("path",V5({},on(r,!0),{className:m,d:x,role:"img"}))};function Nv(e){"@babel/helpers - typeof";return Nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nv(e)}function q5(){return q5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},q5.apply(this,arguments)}function uD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function hD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uD(Object(r),!0).forEach(function(s){Wze(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Wze(e,t,r){return t=Hze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hze(e){var t=Gze(e,"string");return Nv(t)=="symbol"?t:t+""}function Gze(e,t){if(Nv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Nv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fD={curveBasisClosed:q8e,curveBasisOpen:W8e,curveBasis:V8e,curveBumpX:A8e,curveBumpY:T8e,curveLinearClosed:H8e,curveLinear:vj,curveMonotoneX:G8e,curveMonotoneY:K8e,curveNatural:X8e,curveStep:Y8e,curveStepAfter:Q8e,curveStepBefore:Z8e},Wy=function(t){return t.x===+t.x&&t.y===+t.y},x0=function(t){return t.x},v0=function(t){return t.y},Kze=function(t,r){if(Yr(t))return t;var s="curve".concat(gj(t));return(s==="curveMonotone"||s==="curveBump")&&r?fD["".concat(s).concat(r==="vertical"?"Y":"X")]:fD[s]||vj},Xze=function(t){var r=t.type,s=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,o=t.baseLine,l=t.layout,d=t.connectNulls,c=d===void 0?!1:d,u=Kze(s,l),h=c?i.filter(function(g){return Wy(g)}):i,f;if(Array.isArray(o)){var m=c?o.filter(function(g){return Wy(g)}):o,p=h.map(function(g,x){return hD(hD({},g),{},{base:m[x]})});return l==="vertical"?f=Iy().y(v0).x1(x0).x0(function(g){return g.base.x}):f=Iy().x(x0).y1(v0).y0(function(g){return g.base.y}),f.defined(Wy).curve(u),f(p)}return l==="vertical"&&Kt(o)?f=Iy().y(v0).x1(x0).x0(o):Kt(o)?f=Iy().x(x0).y1(v0).y0(o):f=bY().x(x0).y(v0),f.defined(Wy).curve(u),f(h)},nx=function(t){var r=t.className,s=t.points,a=t.path,i=t.pathRef;if((!s||!s.length)&&!a)return null;var o=s&&s.length?Xze(t):a;return P.createElement("path",q5({},on(t,!1),Mw(t),{className:pn("recharts-curve",r),d:o,ref:i}))},wQ={exports:{}},Yze="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Zze=Yze,Qze=Zze;function _Q(){}function jQ(){}jQ.resetWarningCache=_Q;var Jze=function(){function e(s,a,i,o,l,d){if(d!==Qze){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:jQ,resetWarningCache:_Q};return r.PropTypes=r,r};wQ.exports=Jze();var eUe=wQ.exports;const Mn=Ln(eUe);var tUe=Object.getOwnPropertyNames,rUe=Object.getOwnPropertySymbols,nUe=Object.prototype.hasOwnProperty;function mD(e,t){return function(s,a,i){return e(s,a,i)&&t(s,a,i)}}function Hy(e){return function(r,s,a){if(!r||!s||typeof r!="object"||typeof s!="object")return e(r,s,a);var i=a.cache,o=i.get(r),l=i.get(s);if(o&&l)return o===s&&l===r;i.set(r,s),i.set(s,r);var d=e(r,s,a);return i.delete(r),i.delete(s),d}}function pD(e){return tUe(e).concat(rUe(e))}var sUe=Object.hasOwn||function(e,t){return nUe.call(e,t)};function kf(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var aUe="__v",iUe="__o",oUe="_owner",gD=Object.getOwnPropertyDescriptor,xD=Object.keys;function lUe(e,t,r){var s=e.length;if(t.length!==s)return!1;for(;s-- >0;)if(!r.equals(e[s],t[s],s,s,e,t,r))return!1;return!0}function cUe(e,t){return kf(e.getTime(),t.getTime())}function dUe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function uUe(e,t){return e===t}function vD(e,t,r){var s=e.size;if(s!==t.size)return!1;if(!s)return!0;for(var a=new Array(s),i=e.entries(),o,l,d=0;(o=i.next())&&!o.done;){for(var c=t.entries(),u=!1,h=0;(l=c.next())&&!l.done;){if(a[h]){h++;continue}var f=o.value,m=l.value;if(r.equals(f[0],m[0],d,h,e,t,r)&&r.equals(f[1],m[1],f[0],m[0],e,t,r)){u=a[h]=!0;break}h++}if(!u)return!1;d++}return!0}var hUe=kf;function fUe(e,t,r){var s=xD(e),a=s.length;if(xD(t).length!==a)return!1;for(;a-- >0;)if(!NQ(e,t,r,s[a]))return!1;return!0}function y0(e,t,r){var s=pD(e),a=s.length;if(pD(t).length!==a)return!1;for(var i,o,l;a-- >0;)if(i=s[a],!NQ(e,t,r,i)||(o=gD(e,i),l=gD(t,i),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function mUe(e,t){return kf(e.valueOf(),t.valueOf())}function pUe(e,t){return e.source===t.source&&e.flags===t.flags}function yD(e,t,r){var s=e.size;if(s!==t.size)return!1;if(!s)return!0;for(var a=new Array(s),i=e.values(),o,l;(o=i.next())&&!o.done;){for(var d=t.values(),c=!1,u=0;(l=d.next())&&!l.done;){if(!a[u]&&r.equals(o.value,l.value,o.value,l.value,e,t,r)){c=a[u]=!0;break}u++}if(!c)return!1}return!0}function gUe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function xUe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function NQ(e,t,r,s){return(s===oUe||s===iUe||s===aUe)&&(e.$$typeof||t.$$typeof)?!0:sUe(t,s)&&r.equals(e[s],t[s],s,s,e,t,r)}var vUe="[object Arguments]",yUe="[object Boolean]",bUe="[object Date]",wUe="[object Error]",_Ue="[object Map]",jUe="[object Number]",NUe="[object Object]",SUe="[object RegExp]",CUe="[object Set]",EUe="[object String]",kUe="[object URL]",AUe=Array.isArray,bD=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,wD=Object.assign,TUe=Object.prototype.toString.call.bind(Object.prototype.toString);function PUe(e){var t=e.areArraysEqual,r=e.areDatesEqual,s=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,o=e.areNumbersEqual,l=e.areObjectsEqual,d=e.arePrimitiveWrappersEqual,c=e.areRegExpsEqual,u=e.areSetsEqual,h=e.areTypedArraysEqual,f=e.areUrlsEqual;return function(p,g,x){if(p===g)return!0;if(p==null||g==null)return!1;var v=typeof p;if(v!==typeof g)return!1;if(v!=="object")return v==="number"?o(p,g,x):v==="function"?a(p,g,x):!1;var y=p.constructor;if(y!==g.constructor)return!1;if(y===Object)return l(p,g,x);if(AUe(p))return t(p,g,x);if(bD!=null&&bD(p))return h(p,g,x);if(y===Date)return r(p,g,x);if(y===RegExp)return c(p,g,x);if(y===Map)return i(p,g,x);if(y===Set)return u(p,g,x);var b=TUe(p);return b===bUe?r(p,g,x):b===SUe?c(p,g,x):b===_Ue?i(p,g,x):b===CUe?u(p,g,x):b===NUe?typeof p.then!="function"&&typeof g.then!="function"&&l(p,g,x):b===kUe?f(p,g,x):b===wUe?s(p,g,x):b===vUe?l(p,g,x):b===yUe||b===jUe||b===EUe?d(p,g,x):!1}}function OUe(e){var t=e.circular,r=e.createCustomConfig,s=e.strict,a={areArraysEqual:s?y0:lUe,areDatesEqual:cUe,areErrorsEqual:dUe,areFunctionsEqual:uUe,areMapsEqual:s?mD(vD,y0):vD,areNumbersEqual:hUe,areObjectsEqual:s?y0:fUe,arePrimitiveWrappersEqual:mUe,areRegExpsEqual:pUe,areSetsEqual:s?mD(yD,y0):yD,areTypedArraysEqual:s?y0:gUe,areUrlsEqual:xUe};if(r&&(a=wD({},a,r(a))),t){var i=Hy(a.areArraysEqual),o=Hy(a.areMapsEqual),l=Hy(a.areObjectsEqual),d=Hy(a.areSetsEqual);a=wD({},a,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:d})}return a}function RUe(e){return function(t,r,s,a,i,o,l){return e(t,r,l)}}function MUe(e){var t=e.circular,r=e.comparator,s=e.createState,a=e.equals,i=e.strict;if(s)return function(d,c){var u=s(),h=u.cache,f=h===void 0?t?new WeakMap:void 0:h,m=u.meta;return r(d,c,{cache:f,equals:a,meta:m,strict:i})};if(t)return function(d,c){return r(d,c,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var o={cache:void 0,equals:a,meta:void 0,strict:i};return function(d,c){return r(d,c,o)}}var IUe=Hu();Hu({strict:!0});Hu({circular:!0});Hu({circular:!0,strict:!0});Hu({createInternalComparator:function(){return kf}});Hu({strict:!0,createInternalComparator:function(){return kf}});Hu({circular:!0,createInternalComparator:function(){return kf}});Hu({circular:!0,createInternalComparator:function(){return kf},strict:!0});function Hu(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,s=e.createInternalComparator,a=e.createState,i=e.strict,o=i===void 0?!1:i,l=OUe(e),d=PUe(l),c=s?s(d):RUe(d);return MUe({circular:r,comparator:d,createState:a,equals:c,strict:o})}function DUe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function _D(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,s=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):DUe(a)};requestAnimationFrame(s)}function W5(e){"@babel/helpers - typeof";return W5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W5(e)}function LUe(e){return zUe(e)||FUe(e)||$Ue(e)||BUe()}function BUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $Ue(e,t){if(e){if(typeof e=="string")return jD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jD(e,t)}}function jD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function FUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function zUe(e){if(Array.isArray(e))return e}function UUe(){var e={},t=function(){return null},r=!1,s=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,l=LUe(o),d=l[0],c=l.slice(1);if(typeof d=="number"){_D(a.bind(null,c),d);return}a(d),_D(a.bind(null,c));return}W5(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,s(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function Sv(e){"@babel/helpers - typeof";return Sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sv(e)}function ND(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function SD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ND(Object(r),!0).forEach(function(s){SQ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ND(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function SQ(e,t,r){return t=VUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VUe(e){var t=qUe(e,"string");return Sv(t)==="symbol"?t:String(t)}function qUe(e,t){if(Sv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Sv(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WUe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(s,a){return s.filter(function(i){return a.includes(i)})})},HUe=function(t){return t},GUe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},sx=function(t,r){return Object.keys(r).reduce(function(s,a){return SD(SD({},s),{},SQ({},a,t(a,r[a])))},{})},CD=function(t,r,s){return t.map(function(a){return"".concat(GUe(a)," ").concat(r,"ms ").concat(s)}).join(",")};function KUe(e,t){return ZUe(e)||YUe(e,t)||CQ(e,t)||XUe()}function XUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function YUe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,l=[],d=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(l.push(s.value),l.length!==t);d=!0);}catch(u){c=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function ZUe(e){if(Array.isArray(e))return e}function QUe(e){return tVe(e)||eVe(e)||CQ(e)||JUe()}function JUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CQ(e,t){if(e){if(typeof e=="string")return H5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H5(e,t)}}function eVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tVe(e){if(Array.isArray(e))return H5(e)}function H5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}var h2=1e-4,EQ=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},kQ=function(t,r){return t.map(function(s,a){return s*Math.pow(r,a)}).reduce(function(s,a){return s+a})},ED=function(t,r){return function(s){var a=EQ(t,r);return kQ(a,s)}},rVe=function(t,r){return function(s){var a=EQ(t,r),i=[].concat(QUe(a.map(function(o,l){return o*l}).slice(1)),[0]);return kQ(i,s)}},kD=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];var a=r[0],i=r[1],o=r[2],l=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,l=1;break;case"ease":a=.25,i=.1,o=.25,l=1;break;case"ease-in":a=.42,i=0,o=1,l=1;break;case"ease-out":a=.42,i=0,o=.58,l=1;break;case"ease-in-out":a=0,i=0,o=.58,l=1;break;default:{var d=r[0].split("(");if(d[0]==="cubic-bezier"&&d[1].split(")")[0].split(",").length===4){var c=d[1].split(")")[0].split(",").map(function(x){return parseFloat(x)}),u=KUe(c,4);a=u[0],i=u[1],o=u[2],l=u[3]}}}var h=ED(a,o),f=ED(i,l),m=rVe(a,o),p=function(v){return v>1?1:v<0?0:v},g=function(v){for(var y=v>1?1:v,b=y,j=0;j<8;++j){var T=h(b)-y,O=m(b);if(Math.abs(T-y)<h2||O<h2)return f(b);b=p(b-T/O)}return f(b)};return g.isStepper=!1,g},nVe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,s=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,o=t.dt,l=o===void 0?17:o,d=function(u,h,f){var m=-(u-h)*s,p=f*i,g=f+(m-p)*l/1e3,x=f*l/1e3+u;return Math.abs(x-h)<h2&&Math.abs(g)<h2?[h,0]:[x,g]};return d.isStepper=!0,d.dt=l,d},sVe=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return kD(a);case"spring":return nVe();default:if(a.split("(")[0]==="cubic-bezier")return kD(a)}return typeof a=="function"?a:null};function Cv(e){"@babel/helpers - typeof";return Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cv(e)}function AD(e){return oVe(e)||iVe(e)||AQ(e)||aVe()}function aVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oVe(e){if(Array.isArray(e))return K5(e)}function TD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Da(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TD(Object(r),!0).forEach(function(s){G5(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function G5(e,t,r){return t=lVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lVe(e){var t=cVe(e,"string");return Cv(t)==="symbol"?t:String(t)}function cVe(e,t){if(Cv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Cv(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dVe(e,t){return fVe(e)||hVe(e,t)||AQ(e,t)||uVe()}function uVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AQ(e,t){if(e){if(typeof e=="string")return K5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K5(e,t)}}function K5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function hVe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,l=[],d=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(l.push(s.value),l.length!==t);d=!0);}catch(u){c=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function fVe(e){if(Array.isArray(e))return e}var f2=function(t,r,s){return t+(r-t)*s},X5=function(t){var r=t.from,s=t.to;return r!==s},mVe=function e(t,r,s){var a=sx(function(i,o){if(X5(o)){var l=t(o.from,o.to,o.velocity),d=dVe(l,2),c=d[0],u=d[1];return Da(Da({},o),{},{from:c,velocity:u})}return o},r);return s<1?sx(function(i,o){return X5(o)?Da(Da({},o),{},{velocity:f2(o.velocity,a[i].velocity,s),from:f2(o.from,a[i].from,s)}):o},r):e(t,a,s-1)};const pVe=function(e,t,r,s,a){var i=WUe(e,t),o=i.reduce(function(x,v){return Da(Da({},x),{},G5({},v,[e[v],t[v]]))},{}),l=i.reduce(function(x,v){return Da(Da({},x),{},G5({},v,{from:e[v],velocity:0,to:t[v]}))},{}),d=-1,c,u,h=function(){return null},f=function(){return sx(function(v,y){return y.from},l)},m=function(){return!Object.values(l).filter(X5).length},p=function(v){c||(c=v);var y=v-c,b=y/r.dt;l=mVe(r,l,b),a(Da(Da(Da({},e),t),f())),c=v,m()||(d=requestAnimationFrame(h))},g=function(v){u||(u=v);var y=(v-u)/s,b=sx(function(T,O){return f2.apply(void 0,AD(O).concat([r(y)]))},o);if(a(Da(Da(Da({},e),t),b)),y<1)d=requestAnimationFrame(h);else{var j=sx(function(T,O){return f2.apply(void 0,AD(O).concat([r(1)]))},o);a(Da(Da(Da({},e),t),j))}};return h=r.isStepper?p:g,function(){return requestAnimationFrame(h),function(){cancelAnimationFrame(d)}}};function Op(e){"@babel/helpers - typeof";return Op=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Op(e)}var gVe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function xVe(e,t){if(e==null)return{};var r=vVe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function vVe(e,t){if(e==null)return{};var r={},s=Object.keys(e),a,i;for(i=0;i<s.length;i++)a=s[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function g4(e){return _Ve(e)||wVe(e)||bVe(e)||yVe()}function yVe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bVe(e,t){if(e){if(typeof e=="string")return Y5(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y5(e,t)}}function wVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function _Ve(e){if(Array.isArray(e))return Y5(e)}function Y5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function PD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function rl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PD(Object(r),!0).forEach(function(s){M0(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function M0(e,t,r){return t=TQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jVe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function NVe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,TQ(s.key),s)}}function SVe(e,t,r){return t&&NVe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function TQ(e){var t=CVe(e,"string");return Op(t)==="symbol"?t:String(t)}function CVe(e,t){if(Op(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Op(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EVe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Z5(e,t)}function Z5(e,t){return Z5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},Z5(e,t)}function kVe(e){var t=AVe();return function(){var s=m2(e),a;if(t){var i=m2(this).constructor;a=Reflect.construct(s,arguments,i)}else a=s.apply(this,arguments);return Q5(this,a)}}function Q5(e,t){if(t&&(Op(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J5(e)}function J5(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function AVe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function m2(e){return m2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},m2(e)}var ld=function(e){EVe(r,e);var t=kVe(r);function r(s,a){var i;jVe(this,r),i=t.call(this,s,a);var o=i.props,l=o.isActive,d=o.attributeName,c=o.from,u=o.to,h=o.steps,f=o.children,m=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(J5(i)),i.changeStyle=i.changeStyle.bind(J5(i)),!l||m<=0)return i.state={style:{}},typeof f=="function"&&(i.state={style:u}),Q5(i);if(h&&h.length)i.state={style:h[0].style};else if(c){if(typeof f=="function")return i.state={style:c},Q5(i);i.state={style:d?M0({},d,c):c}}else i.state={style:{}};return i}return SVe(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,l=i.canBegin,d=i.attributeName,c=i.shouldReAnimate,u=i.to,h=i.from,f=this.state.style;if(l){if(!o){var m={style:d?M0({},d,u):u};this.state&&f&&(d&&f[d]!==u||!d&&f!==u)&&this.setState(m);return}if(!(IUe(a.to,u)&&a.canBegin&&a.isActive)){var p=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=p||c?h:a.to;if(this.state&&f){var x={style:d?M0({},d,g):g};(d&&f[d]!==g||!d&&f!==g)&&this.setState(x)}this.runAnimation(rl(rl({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,l=a.to,d=a.duration,c=a.easing,u=a.begin,h=a.onAnimationEnd,f=a.onAnimationStart,m=pVe(o,l,sVe(c),d,this.changeStyle),p=function(){i.stopJSAnimation=m()};this.manager.start([f,u,p,d,h])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,l=a.begin,d=a.onAnimationStart,c=o[0],u=c.style,h=c.duration,f=h===void 0?0:h,m=function(g,x,v){if(v===0)return g;var y=x.duration,b=x.easing,j=b===void 0?"ease":b,T=x.style,O=x.properties,R=x.onAnimationEnd,D=v>0?o[v-1]:x,B=O||Object.keys(T);if(typeof j=="function"||j==="spring")return[].concat(g4(g),[i.runJSAnimation.bind(i,{from:D.style,to:T,duration:y,easing:j}),y]);var q=CD(B,y,j),Y=rl(rl(rl({},D.style),T),{},{transition:q});return[].concat(g4(g),[Y,y,R]).filter(HUe)};return this.manager.start([d].concat(g4(o.reduce(m,[u,Math.max(f,l)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=UUe());var i=a.begin,o=a.duration,l=a.attributeName,d=a.to,c=a.easing,u=a.onAnimationStart,h=a.onAnimationEnd,f=a.steps,m=a.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof c=="function"||typeof m=="function"||c==="spring"){this.runJSAnimation(a);return}if(f.length>1){this.runStepAnimation(a);return}var g=l?M0({},l,d):d,x=CD(Object.keys(g),o,c);p.start([u,i,rl(rl({},g),{},{transition:x}),o,h])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var l=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var d=xVe(a,gVe),c=P.Children.count(i),u=this.state.style;if(typeof i=="function")return i(u);if(!l||c===0||o<=0)return i;var h=function(m){var p=m.props,g=p.style,x=g===void 0?{}:g,v=p.className,y=P.cloneElement(m,rl(rl({},d),{},{style:rl(rl({},x),u),className:v}));return y};return c===1?h(P.Children.only(i)):je.createElement("div",null,P.Children.map(i,function(f){return h(f)}))}}]),r}(P.PureComponent);ld.displayName="Animate";ld.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};ld.propTypes={from:Mn.oneOfType([Mn.object,Mn.string]),to:Mn.oneOfType([Mn.object,Mn.string]),attributeName:Mn.string,duration:Mn.number,begin:Mn.number,easing:Mn.oneOfType([Mn.string,Mn.func]),steps:Mn.arrayOf(Mn.shape({duration:Mn.number.isRequired,style:Mn.object.isRequired,easing:Mn.oneOfType([Mn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),Mn.func]),properties:Mn.arrayOf("string"),onAnimationEnd:Mn.func})),children:Mn.oneOfType([Mn.node,Mn.func]),isActive:Mn.bool,canBegin:Mn.bool,onAnimationEnd:Mn.func,shouldReAnimate:Mn.bool,onAnimationStart:Mn.func,onAnimationReStart:Mn.func};function Ev(e){"@babel/helpers - typeof";return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ev(e)}function p2(){return p2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},p2.apply(this,arguments)}function TVe(e,t){return MVe(e)||RVe(e,t)||OVe(e,t)||PVe()}function PVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OVe(e,t){if(e){if(typeof e=="string")return OD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return OD(e,t)}}function OD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function RVe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,l=[],d=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(l.push(s.value),l.length!==t);d=!0);}catch(u){c=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function MVe(e){if(Array.isArray(e))return e}function RD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function MD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RD(Object(r),!0).forEach(function(s){IVe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function IVe(e,t,r){return t=DVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DVe(e){var t=LVe(e,"string");return Ev(t)=="symbol"?t:t+""}function LVe(e,t){if(Ev(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Ev(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ID=function(t,r,s,a,i){var o=Math.min(Math.abs(s)/2,Math.abs(a)/2),l=a>=0?1:-1,d=s>=0?1:-1,c=a>=0&&s>=0||a<0&&s<0?1:0,u;if(o>0&&i instanceof Array){for(var h=[0,0,0,0],f=0,m=4;f<m;f++)h[f]=i[f]>o?o:i[f];u="M".concat(t,",").concat(r+l*h[0]),h[0]>0&&(u+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(c,",").concat(t+d*h[0],",").concat(r)),u+="L ".concat(t+s-d*h[1],",").concat(r),h[1]>0&&(u+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(c,`,
        `).concat(t+s,",").concat(r+l*h[1])),u+="L ".concat(t+s,",").concat(r+a-l*h[2]),h[2]>0&&(u+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(c,`,
        `).concat(t+s-d*h[2],",").concat(r+a)),u+="L ".concat(t+d*h[3],",").concat(r+a),h[3]>0&&(u+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(c,`,
        `).concat(t,",").concat(r+a-l*h[3])),u+="Z"}else if(o>0&&i===+i&&i>0){var p=Math.min(o,i);u="M ".concat(t,",").concat(r+l*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+d*p,",").concat(r,`
            L `).concat(t+s-d*p,",").concat(r,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+s,",").concat(r+l*p,`
            L `).concat(t+s,",").concat(r+a-l*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t+s-d*p,",").concat(r+a,`
            L `).concat(t+d*p,",").concat(r+a,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(t,",").concat(r+a-l*p," Z")}else u="M ".concat(t,",").concat(r," h ").concat(s," v ").concat(a," h ").concat(-s," Z");return u},BVe=function(t,r){if(!t||!r)return!1;var s=t.x,a=t.y,i=r.x,o=r.y,l=r.width,d=r.height;if(Math.abs(l)>0&&Math.abs(d)>0){var c=Math.min(i,i+l),u=Math.max(i,i+l),h=Math.min(o,o+d),f=Math.max(o,o+d);return s>=c&&s<=u&&a>=h&&a<=f}return!1},$Ve={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},UA=function(t){var r=MD(MD({},$Ve),t),s=P.useRef(),a=P.useState(-1),i=TVe(a,2),o=i[0],l=i[1];P.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var j=s.current.getTotalLength();j&&l(j)}catch{}},[]);var d=r.x,c=r.y,u=r.width,h=r.height,f=r.radius,m=r.className,p=r.animationEasing,g=r.animationDuration,x=r.animationBegin,v=r.isAnimationActive,y=r.isUpdateAnimationActive;if(d!==+d||c!==+c||u!==+u||h!==+h||u===0||h===0)return null;var b=pn("recharts-rectangle",m);return y?je.createElement(ld,{canBegin:o>0,from:{width:u,height:h,x:d,y:c},to:{width:u,height:h,x:d,y:c},duration:g,animationEasing:p,isActive:y},function(j){var T=j.width,O=j.height,R=j.x,D=j.y;return je.createElement(ld,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:x,duration:g,isActive:v,easing:p},je.createElement("path",p2({},on(r,!0),{className:b,d:ID(R,D,T,O,f),ref:s})))}):je.createElement("path",p2({},on(r,!0),{className:b,d:ID(d,c,u,h,f)}))};function eE(){return eE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},eE.apply(this,arguments)}var VA=function(t){var r=t.cx,s=t.cy,a=t.r,i=t.className,o=pn("recharts-dot",i);return r===+r&&s===+s&&a===+a?P.createElement("circle",eE({},on(t,!1),Mw(t),{className:o,cx:r,cy:s,r:a})):null};function kv(e){"@babel/helpers - typeof";return kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kv(e)}var FVe=["x","y","top","left","width","height","className"];function tE(){return tE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},tE.apply(this,arguments)}function DD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function zVe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DD(Object(r),!0).forEach(function(s){UVe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function UVe(e,t,r){return t=VVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VVe(e){var t=qVe(e,"string");return kv(t)=="symbol"?t:t+""}function qVe(e,t){if(kv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(kv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WVe(e,t){if(e==null)return{};var r=HVe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function HVe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}var GVe=function(t,r,s,a,i,o){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(s)},KVe=function(t){var r=t.x,s=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.top,l=o===void 0?0:o,d=t.left,c=d===void 0?0:d,u=t.width,h=u===void 0?0:u,f=t.height,m=f===void 0?0:f,p=t.className,g=WVe(t,FVe),x=zVe({x:s,y:i,top:l,left:c,width:h,height:m},g);return!Kt(s)||!Kt(i)||!Kt(h)||!Kt(m)||!Kt(l)||!Kt(c)?null:je.createElement("path",tE({},on(x,!0),{className:pn("recharts-cross",p),d:GVe(s,i,h,m,l,c)}))},XVe=qY,YVe=XVe(Object.getPrototypeOf,Object),ZVe=YVe,QVe=pd,JVe=ZVe,eqe=gd,tqe="[object Object]",rqe=Function.prototype,nqe=Object.prototype,PQ=rqe.toString,sqe=nqe.hasOwnProperty,aqe=PQ.call(Object);function iqe(e){if(!eqe(e)||QVe(e)!=tqe)return!1;var t=JVe(e);if(t===null)return!0;var r=sqe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&PQ.call(r)==aqe}var oqe=iqe;const lqe=Ln(oqe);var cqe=pd,dqe=gd,uqe="[object Boolean]";function hqe(e){return e===!0||e===!1||dqe(e)&&cqe(e)==uqe}var fqe=hqe;const mqe=Ln(fqe);function Av(e){"@babel/helpers - typeof";return Av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Av(e)}function g2(){return g2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},g2.apply(this,arguments)}function pqe(e,t){return yqe(e)||vqe(e,t)||xqe(e,t)||gqe()}function gqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xqe(e,t){if(e){if(typeof e=="string")return LD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LD(e,t)}}function LD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function vqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,l=[],d=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(l.push(s.value),l.length!==t);d=!0);}catch(u){c=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function yqe(e){if(Array.isArray(e))return e}function BD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function $D(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BD(Object(r),!0).forEach(function(s){bqe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function bqe(e,t,r){return t=wqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wqe(e){var t=_qe(e,"string");return Av(t)=="symbol"?t:t+""}function _qe(e,t){if(Av(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Av(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FD=function(t,r,s,a,i){var o=s-a,l;return l="M ".concat(t,",").concat(r),l+="L ".concat(t+s,",").concat(r),l+="L ".concat(t+s-o/2,",").concat(r+i),l+="L ".concat(t+s-o/2-a,",").concat(r+i),l+="L ".concat(t,",").concat(r," Z"),l},jqe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Nqe=function(t){var r=$D($D({},jqe),t),s=P.useRef(),a=P.useState(-1),i=pqe(a,2),o=i[0],l=i[1];P.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var b=s.current.getTotalLength();b&&l(b)}catch{}},[]);var d=r.x,c=r.y,u=r.upperWidth,h=r.lowerWidth,f=r.height,m=r.className,p=r.animationEasing,g=r.animationDuration,x=r.animationBegin,v=r.isUpdateAnimationActive;if(d!==+d||c!==+c||u!==+u||h!==+h||f!==+f||u===0&&h===0||f===0)return null;var y=pn("recharts-trapezoid",m);return v?je.createElement(ld,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:f,x:d,y:c},to:{upperWidth:u,lowerWidth:h,height:f,x:d,y:c},duration:g,animationEasing:p,isActive:v},function(b){var j=b.upperWidth,T=b.lowerWidth,O=b.height,R=b.x,D=b.y;return je.createElement(ld,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:x,duration:g,easing:p},je.createElement("path",g2({},on(r,!0),{className:y,d:FD(R,D,j,T,O),ref:s})))}):je.createElement("g",null,je.createElement("path",g2({},on(r,!0),{className:y,d:FD(d,c,u,h,f)})))},Sqe=["option","shapeType","propTransformer","activeClassName","isActive"];function Tv(e){"@babel/helpers - typeof";return Tv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tv(e)}function Cqe(e,t){if(e==null)return{};var r=Eqe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function Eqe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function zD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function x2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zD(Object(r),!0).forEach(function(s){kqe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function kqe(e,t,r){return t=Aqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Aqe(e){var t=Tqe(e,"string");return Tv(t)=="symbol"?t:t+""}function Tqe(e,t){if(Tv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Tv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pqe(e,t){return x2(x2({},t),e)}function Oqe(e,t){return e==="symbols"}function UD(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return je.createElement(UA,r);case"trapezoid":return je.createElement(Nqe,r);case"sector":return je.createElement(bQ,r);case"symbols":if(Oqe(t))return je.createElement(oA,r);break;default:return null}}function Rqe(e){return P.isValidElement(e)?e.props:e}function Mqe(e){var t=e.option,r=e.shapeType,s=e.propTransformer,a=s===void 0?Pqe:s,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,l=e.isActive,d=Cqe(e,Sqe),c;if(P.isValidElement(t))c=P.cloneElement(t,x2(x2({},d),Rqe(t)));else if(Yr(t))c=t(d);else if(lqe(t)&&!mqe(t)){var u=a(t,d);c=je.createElement(UD,{shapeType:r,elementProps:u})}else{var h=d;c=je.createElement(UD,{shapeType:r,elementProps:h})}return l?je.createElement(Ns,{className:o},c):c}function Rj(e,t){return t!=null&&"trapezoids"in e.props}function Mj(e,t){return t!=null&&"sectors"in e.props}function Pv(e,t){return t!=null&&"points"in e.props}function Iqe(e,t){var r,s,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(s=t.labelViewBox)===null||s===void 0?void 0:s.y)||e.y===t.y;return a&&i}function Dqe(e,t){var r=e.endAngle===t.endAngle,s=e.startAngle===t.startAngle;return r&&s}function Lqe(e,t){var r=e.x===t.x,s=e.y===t.y,a=e.z===t.z;return r&&s&&a}function Bqe(e,t){var r;return Rj(e,t)?r=Iqe:Mj(e,t)?r=Dqe:Pv(e,t)&&(r=Lqe),r}function $qe(e,t){var r;return Rj(e,t)?r="trapezoids":Mj(e,t)?r="sectors":Pv(e,t)&&(r="points"),r}function Fqe(e,t){if(Rj(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(Mj(e,t)){var s;return(s=t.tooltipPayload)===null||s===void 0||(s=s[0])===null||s===void 0||(s=s.payload)===null||s===void 0?void 0:s.payload}return Pv(e,t)?t.payload:{}}function zqe(e){var t=e.activeTooltipItem,r=e.graphicalItem,s=e.itemData,a=$qe(r,t),i=Fqe(r,t),o=s.filter(function(d,c){var u=mv(i,d),h=r.props[a].filter(function(p){var g=Bqe(r,t);return g(p,t)}),f=r.props[a].indexOf(h[h.length-1]),m=c===f;return u&&m}),l=s.indexOf(o[o.length-1]);return l}var Uqe=Math.ceil,Vqe=Math.max;function qqe(e,t,r,s){for(var a=-1,i=Vqe(Uqe((t-e)/(r||1)),0),o=Array(i);i--;)o[s?i:++a]=e,e+=r;return o}var Wqe=qqe,Hqe=cZ,VD=1/0,Gqe=17976931348623157e292;function Kqe(e){if(!e)return e===0?e:0;if(e=Hqe(e),e===VD||e===-VD){var t=e<0?-1:1;return t*Gqe}return e===e?e:0}var OQ=Kqe,Xqe=Wqe,Yqe=_j,x4=OQ;function Zqe(e){return function(t,r,s){return s&&typeof s!="number"&&Yqe(t,r,s)&&(r=s=void 0),t=x4(t),r===void 0?(r=t,t=0):r=x4(r),s=s===void 0?t<r?1:-1:x4(s),Xqe(t,r,s,e)}}var Qqe=Zqe,Jqe=Qqe,eWe=Jqe(),tWe=eWe;const v2=Ln(tWe);function Ov(e){"@babel/helpers - typeof";return Ov=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ov(e)}function qD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function WD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qD(Object(r),!0).forEach(function(s){RQ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function RQ(e,t,r){return t=rWe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rWe(e){var t=nWe(e,"string");return Ov(t)=="symbol"?t:t+""}function nWe(e,t){if(Ov(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Ov(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sWe=["Webkit","Moz","O","ms"],aWe=function(t,r){var s=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=sWe.reduce(function(i,o){return WD(WD({},i),{},RQ({},o+s,r))},{});return a[t]=r,a};function Rp(e){"@babel/helpers - typeof";return Rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rp(e)}function y2(){return y2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},y2.apply(this,arguments)}function HD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function v4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HD(Object(r),!0).forEach(function(s){eo(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function iWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GD(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,IQ(s.key),s)}}function oWe(e,t,r){return t&&GD(e.prototype,t),r&&GD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lWe(e,t,r){return t=b2(t),cWe(e,MQ()?Reflect.construct(t,r||[],b2(e).constructor):t.apply(e,r))}function cWe(e,t){if(t&&(Rp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dWe(e)}function dWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function MQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(MQ=function(){return!!e})()}function b2(e){return b2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},b2(e)}function uWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rE(e,t)}function rE(e,t){return rE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},rE(e,t)}function eo(e,t,r){return t=IQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IQ(e){var t=hWe(e,"string");return Rp(t)=="symbol"?t:t+""}function hWe(e,t){if(Rp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Rp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fWe=function(t){var r=t.data,s=t.startIndex,a=t.endIndex,i=t.x,o=t.width,l=t.travellerWidth;if(!r||!r.length)return{};var d=r.length,c=tx().domain(v2(0,d)).range([i,i+o-l]),u=c.domain().map(function(h){return c(h)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(s),endX:c(a),scale:c,scaleValues:u}},KD=function(t){return t.changedTouches&&!!t.changedTouches.length},Mp=function(e){function t(r){var s;return iWe(this,t),s=lWe(this,t,[r]),eo(s,"handleDrag",function(a){s.leaveTimer&&(clearTimeout(s.leaveTimer),s.leaveTimer=null),s.state.isTravellerMoving?s.handleTravellerMove(a):s.state.isSlideMoving&&s.handleSlideDrag(a)}),eo(s,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&s.handleDrag(a.changedTouches[0])}),eo(s,"handleDragEnd",function(){s.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=s.props,i=a.endIndex,o=a.onDragEnd,l=a.startIndex;o==null||o({endIndex:i,startIndex:l})}),s.detachDragEndListener()}),eo(s,"handleLeaveWrapper",function(){(s.state.isTravellerMoving||s.state.isSlideMoving)&&(s.leaveTimer=window.setTimeout(s.handleDragEnd,s.props.leaveTimeOut))}),eo(s,"handleEnterSlideOrTraveller",function(){s.setState({isTextActive:!0})}),eo(s,"handleLeaveSlideOrTraveller",function(){s.setState({isTextActive:!1})}),eo(s,"handleSlideDragStart",function(a){var i=KD(a)?a.changedTouches[0]:a;s.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),s.attachDragEndListener()}),s.travellerDragStartHandlers={startX:s.handleTravellerDragStart.bind(s,"startX"),endX:s.handleTravellerDragStart.bind(s,"endX")},s.state={},s}return uWe(t,e),oWe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(s){var a=s.startX,i=s.endX,o=this.state.scaleValues,l=this.props,d=l.gap,c=l.data,u=c.length-1,h=Math.min(a,i),f=Math.max(a,i),m=t.getIndexInRange(o,h),p=t.getIndexInRange(o,f);return{startIndex:m-m%d,endIndex:p===u?u:p-p%d}}},{key:"getTextOfTick",value:function(s){var a=this.props,i=a.data,o=a.tickFormatter,l=a.dataKey,d=xo(i[s],l,s);return Yr(o)?o(d,s):d}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(s){var a=this.state,i=a.slideMoveStartX,o=a.startX,l=a.endX,d=this.props,c=d.x,u=d.width,h=d.travellerWidth,f=d.startIndex,m=d.endIndex,p=d.onChange,g=s.pageX-i;g>0?g=Math.min(g,c+u-h-l,c+u-h-o):g<0&&(g=Math.max(g,c-o,c-l));var x=this.getIndex({startX:o+g,endX:l+g});(x.startIndex!==f||x.endIndex!==m)&&p&&p(x),this.setState({startX:o+g,endX:l+g,slideMoveStartX:s.pageX})}},{key:"handleTravellerDragStart",value:function(s,a){var i=KD(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:s,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(s){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,l=a.endX,d=a.startX,c=this.state[o],u=this.props,h=u.x,f=u.width,m=u.travellerWidth,p=u.onChange,g=u.gap,x=u.data,v={startX:this.state.startX,endX:this.state.endX},y=s.pageX-i;y>0?y=Math.min(y,h+f-m-c):y<0&&(y=Math.max(y,h-c)),v[o]=c+y;var b=this.getIndex(v),j=b.startIndex,T=b.endIndex,O=function(){var D=x.length-1;return o==="startX"&&(l>d?j%g===0:T%g===0)||l<d&&T===D||o==="endX"&&(l>d?T%g===0:j%g===0)||l>d&&T===D};this.setState(eo(eo({},o,c+y),"brushMoveStartX",s.pageX),function(){p&&O()&&p(b)})}},{key:"handleTravellerMoveKeyboard",value:function(s,a){var i=this,o=this.state,l=o.scaleValues,d=o.startX,c=o.endX,u=this.state[a],h=l.indexOf(u);if(h!==-1){var f=h+s;if(!(f===-1||f>=l.length)){var m=l[f];a==="startX"&&m>=c||a==="endX"&&m<=d||this.setState(eo({},a,m),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var s=this.props,a=s.x,i=s.y,o=s.width,l=s.height,d=s.fill,c=s.stroke;return je.createElement("rect",{stroke:c,fill:d,x:a,y:i,width:o,height:l})}},{key:"renderPanorama",value:function(){var s=this.props,a=s.x,i=s.y,o=s.width,l=s.height,d=s.data,c=s.children,u=s.padding,h=P.Children.only(c);return h?je.cloneElement(h,{x:a,y:i,width:o,height:l,margin:u,compact:!0,data:d}):null}},{key:"renderTravellerLayer",value:function(s,a){var i,o,l=this,d=this.props,c=d.y,u=d.travellerWidth,h=d.height,f=d.traveller,m=d.ariaLabel,p=d.data,g=d.startIndex,x=d.endIndex,v=Math.max(s,this.props.x),y=v4(v4({},on(this.props,!1)),{},{x:v,y:c,width:u,height:h}),b=m||"Min value: ".concat((i=p[g])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=p[x])===null||o===void 0?void 0:o.name);return je.createElement(Ns,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":s,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(T){["ArrowLeft","ArrowRight"].includes(T.key)&&(T.preventDefault(),T.stopPropagation(),l.handleTravellerMoveKeyboard(T.key==="ArrowRight"?1:-1,a))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(f,y))}},{key:"renderSlide",value:function(s,a){var i=this.props,o=i.y,l=i.height,d=i.stroke,c=i.travellerWidth,u=Math.min(s,a)+c,h=Math.max(Math.abs(a-s)-c,0);return je.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:d,fillOpacity:.2,x:u,y:o,width:h,height:l})}},{key:"renderText",value:function(){var s=this.props,a=s.startIndex,i=s.endIndex,o=s.y,l=s.height,d=s.travellerWidth,c=s.stroke,u=this.state,h=u.startX,f=u.endX,m=5,p={pointerEvents:"none",fill:c};return je.createElement(Ns,{className:"recharts-brush-texts"},je.createElement(Xw,y2({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,f)-m,y:o+l/2},p),this.getTextOfTick(a)),je.createElement(Xw,y2({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,f)+d+m,y:o+l/2},p),this.getTextOfTick(i)))}},{key:"render",value:function(){var s=this.props,a=s.data,i=s.className,o=s.children,l=s.x,d=s.y,c=s.width,u=s.height,h=s.alwaysShowText,f=this.state,m=f.startX,p=f.endX,g=f.isTextActive,x=f.isSlideMoving,v=f.isTravellerMoving,y=f.isTravellerFocused;if(!a||!a.length||!Kt(l)||!Kt(d)||!Kt(c)||!Kt(u)||c<=0||u<=0)return null;var b=pn("recharts-brush",i),j=je.Children.count(o)===1,T=aWe("userSelect","none");return je.createElement(Ns,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:T},this.renderBackground(),j&&this.renderPanorama(),this.renderSlide(m,p),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(p,"endX"),(g||x||v||y||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(s){var a=s.x,i=s.y,o=s.width,l=s.height,d=s.stroke,c=Math.floor(i+l/2)-1;return je.createElement(je.Fragment,null,je.createElement("rect",{x:a,y:i,width:o,height:l,fill:d,stroke:"none"}),je.createElement("line",{x1:a+1,y1:c,x2:a+o-1,y2:c,fill:"none",stroke:"#fff"}),je.createElement("line",{x1:a+1,y1:c+2,x2:a+o-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(s,a){var i;return je.isValidElement(s)?i=je.cloneElement(s,a):Yr(s)?i=s(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(s,a){var i=s.data,o=s.width,l=s.x,d=s.travellerWidth,c=s.updateId,u=s.startIndex,h=s.endIndex;if(i!==a.prevData||c!==a.prevUpdateId)return v4({prevData:i,prevTravellerWidth:d,prevUpdateId:c,prevX:l,prevWidth:o},i&&i.length?fWe({data:i,width:o,x:l,travellerWidth:d,startIndex:u,endIndex:h}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||l!==a.prevX||d!==a.prevTravellerWidth)){a.scale.range([l,l+o-d]);var f=a.scale.domain().map(function(m){return a.scale(m)});return{prevData:i,prevTravellerWidth:d,prevUpdateId:c,prevX:l,prevWidth:o,startX:a.scale(s.startIndex),endX:a.scale(s.endIndex),scaleValues:f}}return null}},{key:"getIndexInRange",value:function(s,a){for(var i=s.length,o=0,l=i-1;l-o>1;){var d=Math.floor((o+l)/2);s[d]>a?l=d:o=d}return a>=s[l]?l:o}}])}(P.PureComponent);eo(Mp,"displayName","Brush");eo(Mp,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var mWe=mA;function pWe(e,t){var r;return mWe(e,function(s,a,i){return r=t(s,a,i),!r}),!!r}var gWe=pWe,xWe=DY,vWe=Vu,yWe=gWe,bWe=Ki,wWe=_j;function _We(e,t,r){var s=bWe(e)?xWe:yWe;return r&&wWe(e,t,r)&&(t=void 0),s(e,vWe(t))}var jWe=_We;const NWe=Ln(jWe);var hc=function(t,r){var s=t.alwaysShow,a=t.ifOverflow;return s&&(a="extendDomain"),a===r},XD=sZ;function SWe(e,t,r){t=="__proto__"&&XD?XD(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var CWe=SWe,EWe=CWe,kWe=rZ,AWe=Vu;function TWe(e,t){var r={};return t=AWe(t),kWe(e,function(s,a,i){EWe(r,a,t(s,a,i))}),r}var PWe=TWe;const OWe=Ln(PWe);function RWe(e,t){for(var r=-1,s=e==null?0:e.length;++r<s;)if(!t(e[r],r,e))return!1;return!0}var MWe=RWe,IWe=mA;function DWe(e,t){var r=!0;return IWe(e,function(s,a,i){return r=!!t(s,a,i),r}),r}var LWe=DWe,BWe=MWe,$We=LWe,FWe=Vu,zWe=Ki,UWe=_j;function VWe(e,t,r){var s=zWe(e)?BWe:$We;return r&&UWe(e,t,r)&&(t=void 0),s(e,FWe(t))}var qWe=VWe;const DQ=Ln(qWe);var WWe=["x","y"];function Rv(e){"@babel/helpers - typeof";return Rv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rv(e)}function nE(){return nE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},nE.apply(this,arguments)}function YD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function b0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YD(Object(r),!0).forEach(function(s){HWe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function HWe(e,t,r){return t=GWe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GWe(e){var t=KWe(e,"string");return Rv(t)=="symbol"?t:t+""}function KWe(e,t){if(Rv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Rv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XWe(e,t){if(e==null)return{};var r=YWe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function YWe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function ZWe(e,t){var r=e.x,s=e.y,a=XWe(e,WWe),i="".concat(r),o=parseInt(i,10),l="".concat(s),d=parseInt(l,10),c="".concat(t.height||a.height),u=parseInt(c,10),h="".concat(t.width||a.width),f=parseInt(h,10);return b0(b0(b0(b0(b0({},t),a),o?{x:o}:{}),d?{y:d}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function ZD(e){return je.createElement(Mqe,nE({shapeType:"rectangle",propTransformer:ZWe,activeClassName:"recharts-active-bar"},e))}var QWe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(s,a){if(typeof t=="number")return t;var i=Kt(s)||mke(s);return i?t(s,a):(i||ff(),r)}},JWe=["value","background"],LQ;function Ip(e){"@babel/helpers - typeof";return Ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ip(e)}function eHe(e,t){if(e==null)return{};var r=tHe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function tHe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function w2(){return w2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},w2.apply(this,arguments)}function QD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Hs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QD(Object(r),!0).forEach(function(s){tu(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function rHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JD(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,$Q(s.key),s)}}function nHe(e,t,r){return t&&JD(e.prototype,t),r&&JD(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sHe(e,t,r){return t=_2(t),aHe(e,BQ()?Reflect.construct(t,r||[],_2(e).constructor):t.apply(e,r))}function aHe(e,t){if(t&&(Ip(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iHe(e)}function iHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function BQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(BQ=function(){return!!e})()}function _2(e){return _2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_2(e)}function oHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sE(e,t)}function sE(e,t){return sE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},sE(e,t)}function tu(e,t,r){return t=$Q(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $Q(e){var t=lHe(e,"string");return Ip(t)=="symbol"?t:t+""}function lHe(e,t){if(Ip(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Ip(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var A1=function(e){function t(){var r;rHe(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return r=sHe(this,t,[].concat(a)),tu(r,"state",{isAnimationFinished:!1}),tu(r,"id",j1("recharts-bar-")),tu(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),tu(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return oHe(t,e),nHe(t,[{key:"renderRectanglesStatically",value:function(s){var a=this,i=this.props,o=i.shape,l=i.dataKey,d=i.activeIndex,c=i.activeBar,u=on(this.props,!1);return s&&s.map(function(h,f){var m=f===d,p=m?c:o,g=Hs(Hs(Hs({},u),h),{},{isActive:m,option:p,index:f,dataKey:l,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return je.createElement(Ns,w2({className:"recharts-bar-rectangle"},Iw(a.props,h,f),{key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(f)}),je.createElement(ZD,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var s=this,a=this.props,i=a.data,o=a.layout,l=a.isAnimationActive,d=a.animationBegin,c=a.animationDuration,u=a.animationEasing,h=a.animationId,f=this.state.prevData;return je.createElement(ld,{begin:d,duration:c,isActive:l,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var p=m.t,g=i.map(function(x,v){var y=f&&f[v];if(y){var b=Po(y.x,x.x),j=Po(y.y,x.y),T=Po(y.width,x.width),O=Po(y.height,x.height);return Hs(Hs({},x),{},{x:b(p),y:j(p),width:T(p),height:O(p)})}if(o==="horizontal"){var R=Po(0,x.height),D=R(p);return Hs(Hs({},x),{},{y:x.y+x.height-D,height:D})}var B=Po(0,x.width),q=B(p);return Hs(Hs({},x),{},{width:q})});return je.createElement(Ns,null,s.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var s=this.props,a=s.data,i=s.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!mv(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var s=this,a=this.props,i=a.data,o=a.dataKey,l=a.activeIndex,d=on(this.props.background,!1);return i.map(function(c,u){c.value;var h=c.background,f=eHe(c,JWe);if(!h)return null;var m=Hs(Hs(Hs(Hs(Hs({},f),{},{fill:"#eee"},h),d),Iw(s.props,c,u)),{},{onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd,dataKey:o,index:u,className:"recharts-bar-background-rectangle"});return je.createElement(ZD,w2({key:"background-bar-".concat(u),option:s.props.background,isActive:u===l},m))})}},{key:"renderErrorBar",value:function(s,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,l=i.xAxis,d=i.yAxis,c=i.layout,u=i.children,h=_l(u,Oj);if(!h)return null;var f=c==="vertical"?o[0].height/2:o[0].width/2,m=function(x,v){var y=Array.isArray(x.value)?x.value[1]:x.value;return{x:x.x,y:x.y,value:y,errorVal:xo(x,v)}},p={clipPath:s?"url(#clipPath-".concat(a,")"):null};return je.createElement(Ns,p,h.map(function(g){return je.cloneElement(g,{key:"error-bar-".concat(a,"-").concat(g.props.dataKey),data:o,xAxis:l,yAxis:d,layout:c,offset:f,dataPointFormatter:m})}))}},{key:"render",value:function(){var s=this.props,a=s.hide,i=s.data,o=s.className,l=s.xAxis,d=s.yAxis,c=s.left,u=s.top,h=s.width,f=s.height,m=s.isAnimationActive,p=s.background,g=s.id;if(a||!i||!i.length)return null;var x=this.state.isAnimationFinished,v=pn("recharts-bar",o),y=l&&l.allowDataOverflow,b=d&&d.allowDataOverflow,j=y||b,T=un(g)?this.id:g;return je.createElement(Ns,{className:v},y||b?je.createElement("defs",null,je.createElement("clipPath",{id:"clipPath-".concat(T)},je.createElement("rect",{x:y?c:c-h/2,y:b?u:u-f/2,width:y?h:h*2,height:b?f:f*2}))):null,je.createElement(Ns,{className:"recharts-bar-rectangles",clipPath:j?"url(#clipPath-".concat(T,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(j,T),(!m||x)&&gu.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(s,a){return s.animationId!==a.prevAnimationId?{prevAnimationId:s.animationId,curData:s.data,prevData:a.curData}:s.data!==a.curData?{curData:s.data}:null}}])}(P.PureComponent);LQ=A1;tu(A1,"displayName","Bar");tu(A1,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Gc.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});tu(A1,"getComposedData",function(e){var t=e.props,r=e.item,s=e.barPosition,a=e.bandSize,i=e.xAxis,o=e.yAxis,l=e.xAxisTicks,d=e.yAxisTicks,c=e.stackedData,u=e.dataStartIndex,h=e.displayedData,f=e.offset,m=BFe(s,r);if(!m)return null;var p=t.layout,g=r.type.defaultProps,x=g!==void 0?Hs(Hs({},g),r.props):r.props,v=x.dataKey,y=x.children,b=x.minPointSize,j=p==="horizontal"?o:i,T=c?j.scale.domain():null,O=HFe({numericAxis:j}),R=_l(y,uZ),D=h.map(function(B,q){var Y,G,I,F,S,E;c?Y=$Fe(c[u+q],T):(Y=xo(B,v),Array.isArray(Y)||(Y=[O,Y]));var N=QWe(b,LQ.defaultProps.minPointSize)(Y[1],q);if(p==="horizontal"){var C,k=[o.scale(Y[0]),o.scale(Y[1])],M=k[0],U=k[1];G=Q9({axis:i,ticks:l,bandSize:a,offset:m.offset,entry:B,index:q}),I=(C=U??M)!==null&&C!==void 0?C:void 0,F=m.size;var $=M-U;if(S=Number.isNaN($)?0:$,E={x:G,y:o.y,width:F,height:o.height},Math.abs(N)>0&&Math.abs(S)<Math.abs(N)){var X=xl(S||N)*(Math.abs(N)-Math.abs(S));I-=X,S+=X}}else{var Z=[i.scale(Y[0]),i.scale(Y[1])],re=Z[0],W=Z[1];if(G=re,I=Q9({axis:o,ticks:d,bandSize:a,offset:m.offset,entry:B,index:q}),F=W-re,S=m.size,E={x:i.x,y:I,width:i.width,height:S},Math.abs(N)>0&&Math.abs(F)<Math.abs(N)){var J=xl(F||N)*(Math.abs(N)-Math.abs(F));F+=J}}return Hs(Hs(Hs({},B),{},{x:G,y:I,width:F,height:S,value:c?Y:Y[1],payload:B,background:E},R&&R[q]&&R[q].props),{},{tooltipPayload:[xQ(r,B)],tooltipPosition:{x:G+F/2,y:I+S/2}})});return Hs({data:D,layout:p},f)});function Mv(e){"@babel/helpers - typeof";return Mv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mv(e)}function cHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function eL(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,FQ(s.key),s)}}function dHe(e,t,r){return t&&eL(e.prototype,t),r&&eL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function tL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function fl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tL(Object(r),!0).forEach(function(s){Ij(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Ij(e,t,r){return t=FQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FQ(e){var t=uHe(e,"string");return Mv(t)=="symbol"?t:t+""}function uHe(e,t){if(Mv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Mv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hHe=function(t,r,s,a,i){var o=t.width,l=t.height,d=t.layout,c=t.children,u=Object.keys(r),h={left:s.left,leftMirror:s.left,right:o-s.right,rightMirror:o-s.right,top:s.top,topMirror:s.top,bottom:l-s.bottom,bottomMirror:l-s.bottom},f=!!ro(c,A1);return u.reduce(function(m,p){var g=r[p],x=g.orientation,v=g.domain,y=g.padding,b=y===void 0?{}:y,j=g.mirror,T=g.reversed,O="".concat(x).concat(j?"Mirror":""),R,D,B,q,Y;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var G=v[1]-v[0],I=1/0,F=g.categoricalDomain.sort(xke);if(F.forEach(function(Z,re){re>0&&(I=Math.min((Z||0)-(F[re-1]||0),I))}),Number.isFinite(I)){var S=I/G,E=g.layout==="vertical"?s.height:s.width;if(g.padding==="gap"&&(R=S*E/2),g.padding==="no-gap"){var N=uf(t.barCategoryGap,S*E),C=S*E/2;R=C-N-(C-N)/E*N}}}a==="xAxis"?D=[s.left+(b.left||0)+(R||0),s.left+s.width-(b.right||0)-(R||0)]:a==="yAxis"?D=d==="horizontal"?[s.top+s.height-(b.bottom||0),s.top+(b.top||0)]:[s.top+(b.top||0)+(R||0),s.top+s.height-(b.bottom||0)-(R||0)]:D=g.range,T&&(D=[D[1],D[0]]);var k=DFe(g,i,f),M=k.scale,U=k.realScaleType;M.domain(v).range(D),LFe(M);var $=WFe(M,fl(fl({},g),{},{realScaleType:U}));a==="xAxis"?(Y=x==="top"&&!j||x==="bottom"&&j,B=s.left,q=h[O]-Y*g.height):a==="yAxis"&&(Y=x==="left"&&!j||x==="right"&&j,B=h[O]-Y*g.width,q=s.top);var X=fl(fl(fl({},g),$),{},{realScaleType:U,x:B,y:q,scale:M,width:a==="xAxis"?s.width:g.width,height:a==="yAxis"?s.height:g.height});return X.bandSize=c2(X,$),!g.hide&&a==="xAxis"?h[O]+=(Y?-1:1)*X.height:g.hide||(h[O]+=(Y?-1:1)*X.width),fl(fl({},m),{},Ij({},p,X))},{})},zQ=function(t,r){var s=t.x,a=t.y,i=r.x,o=r.y;return{x:Math.min(s,i),y:Math.min(a,o),width:Math.abs(i-s),height:Math.abs(o-a)}},fHe=function(t){var r=t.x1,s=t.y1,a=t.x2,i=t.y2;return zQ({x:r,y:s},{x:a,y:i})},UQ=function(){function e(t){cHe(this,e),this.scale=t}return dHe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=s.bandAware,i=s.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(r)+l}default:return this.scale(r)}if(a){var d=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+d}return this.scale(r)}}},{key:"isInRange",value:function(r){var s=this.range(),a=s[0],i=s[s.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();Ij(UQ,"EPS",1e-4);var qA=function(t){var r=Object.keys(t).reduce(function(s,a){return fl(fl({},s),{},Ij({},a,UQ.create(t[a])))},{});return fl(fl({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,l=i.position;return OWe(a,function(d,c){return r[c].apply(d,{bandAware:o,position:l})})},isInRange:function(a){return DQ(a,function(i,o){return r[o].isInRange(i)})}})};function mHe(e){return(e%180+180)%180}var pHe=function(t){var r=t.width,s=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=mHe(a),o=i*Math.PI/180,l=Math.atan(s/r),d=o>l&&o<Math.PI-l?s/Math.sin(o):r/Math.cos(o);return Math.abs(d)},gHe=Vu,xHe=N1,vHe=bj;function yHe(e){return function(t,r,s){var a=Object(t);if(!xHe(t)){var i=gHe(r);t=vHe(t),r=function(l){return i(a[l],l,a)}}var o=e(t,r,s);return o>-1?a[i?t[o]:o]:void 0}}var bHe=yHe,wHe=OQ;function _He(e){var t=wHe(e),r=t%1;return t===t?r?t-r:t:0}var jHe=_He,NHe=YY,SHe=Vu,CHe=jHe,EHe=Math.max;function kHe(e,t,r){var s=e==null?0:e.length;if(!s)return-1;var a=r==null?0:CHe(r);return a<0&&(a=EHe(s+a,0)),NHe(e,SHe(t),a)}var AHe=kHe,THe=bHe,PHe=AHe,OHe=THe(PHe),RHe=OHe;const MHe=Ln(RHe);var IHe=v6e(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),WA=P.createContext(void 0),HA=P.createContext(void 0),VQ=P.createContext(void 0),qQ=P.createContext({}),WQ=P.createContext(void 0),HQ=P.createContext(0),GQ=P.createContext(0),rL=function(t){var r=t.state,s=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=t.clipPathId,l=t.children,d=t.width,c=t.height,u=IHe(i);return je.createElement(WA.Provider,{value:s},je.createElement(HA.Provider,{value:a},je.createElement(qQ.Provider,{value:i},je.createElement(VQ.Provider,{value:u},je.createElement(WQ.Provider,{value:o},je.createElement(HQ.Provider,{value:c},je.createElement(GQ.Provider,{value:d},l)))))))},DHe=function(){return P.useContext(WQ)},KQ=function(t){var r=P.useContext(WA);r==null&&ff();var s=r[t];return s==null&&ff(),s},LHe=function(){var t=P.useContext(WA);return zd(t)},BHe=function(){var t=P.useContext(HA),r=MHe(t,function(s){return DQ(s.domain,Number.isFinite)});return r||zd(t)},XQ=function(t){var r=P.useContext(HA);r==null&&ff();var s=r[t];return s==null&&ff(),s},$He=function(){var t=P.useContext(VQ);return t},FHe=function(){return P.useContext(qQ)},GA=function(){return P.useContext(GQ)},KA=function(){return P.useContext(HQ)};function Dp(e){"@babel/helpers - typeof";return Dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dp(e)}function zHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UHe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,ZQ(s.key),s)}}function VHe(e,t,r){return t&&UHe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qHe(e,t,r){return t=j2(t),WHe(e,YQ()?Reflect.construct(t,r||[],j2(e).constructor):t.apply(e,r))}function WHe(e,t){if(t&&(Dp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HHe(e)}function HHe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function YQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(YQ=function(){return!!e})()}function j2(e){return j2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},j2(e)}function GHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aE(e,t)}function aE(e,t){return aE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},aE(e,t)}function nL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function sL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nL(Object(r),!0).forEach(function(s){XA(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function XA(e,t,r){return t=ZQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZQ(e){var t=KHe(e,"string");return Dp(t)=="symbol"?t:t+""}function KHe(e,t){if(Dp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Dp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XHe(e,t){return JHe(e)||QHe(e,t)||ZHe(e,t)||YHe()}function YHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZHe(e,t){if(e){if(typeof e=="string")return aL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return aL(e,t)}}function aL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function QHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,l=[],d=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(l.push(s.value),l.length!==t);d=!0);}catch(u){c=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function JHe(e){if(Array.isArray(e))return e}function iE(){return iE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},iE.apply(this,arguments)}var eGe=function(t,r){var s;return je.isValidElement(t)?s=je.cloneElement(t,r):Yr(t)?s=t(r):s=je.createElement("line",iE({},r,{className:"recharts-reference-line-line"})),s},tGe=function(t,r,s,a,i,o,l,d,c){var u=i.x,h=i.y,f=i.width,m=i.height;if(s){var p=c.y,g=t.y.apply(p,{position:o});if(hc(c,"discard")&&!t.y.isInRange(g))return null;var x=[{x:u+f,y:g},{x:u,y:g}];return d==="left"?x.reverse():x}if(r){var v=c.x,y=t.x.apply(v,{position:o});if(hc(c,"discard")&&!t.x.isInRange(y))return null;var b=[{x:y,y:h+m},{x:y,y:h}];return l==="top"?b.reverse():b}if(a){var j=c.segment,T=j.map(function(O){return t.apply(O,{position:o})});return hc(c,"discard")&&NWe(T,function(O){return!t.isInRange(O)})?null:T}return null};function rGe(e){var t=e.x,r=e.y,s=e.segment,a=e.xAxisId,i=e.yAxisId,o=e.shape,l=e.className,d=e.alwaysShow,c=DHe(),u=KQ(a),h=XQ(i),f=$He();if(!c||!f)return null;Hc(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=qA({x:u.scale,y:h.scale}),p=ha(t),g=ha(r),x=s&&s.length===2,v=tGe(m,p,g,x,f,e.position,u.orientation,h.orientation,e);if(!v)return null;var y=XHe(v,2),b=y[0],j=b.x,T=b.y,O=y[1],R=O.x,D=O.y,B=hc(e,"hidden")?"url(#".concat(c,")"):void 0,q=sL(sL({clipPath:B},on(e,!0)),{},{x1:j,y1:T,x2:R,y2:D});return je.createElement(Ns,{className:pn("recharts-reference-line",l)},eGe(o,q),ri.renderCallByParent(e,fHe({x1:j,y1:T,x2:R,y2:D})))}var YA=function(e){function t(){return zHe(this,t),qHe(this,t,arguments)}return GHe(t,e),VHe(t,[{key:"render",value:function(){return je.createElement(rGe,this.props)}}])}(je.Component);XA(YA,"displayName","ReferenceLine");XA(YA,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function oE(){return oE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},oE.apply(this,arguments)}function Lp(e){"@babel/helpers - typeof";return Lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lp(e)}function iL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function oL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iL(Object(r),!0).forEach(function(s){Dj(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function nGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sGe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,JQ(s.key),s)}}function aGe(e,t,r){return t&&sGe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function iGe(e,t,r){return t=N2(t),oGe(e,QQ()?Reflect.construct(t,r||[],N2(e).constructor):t.apply(e,r))}function oGe(e,t){if(t&&(Lp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lGe(e)}function lGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QQ=function(){return!!e})()}function N2(e){return N2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},N2(e)}function cGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&lE(e,t)}function lE(e,t){return lE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},lE(e,t)}function Dj(e,t,r){return t=JQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JQ(e){var t=dGe(e,"string");return Lp(t)=="symbol"?t:t+""}function dGe(e,t){if(Lp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Lp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uGe=function(t){var r=t.x,s=t.y,a=t.xAxis,i=t.yAxis,o=qA({x:a.scale,y:i.scale}),l=o.apply({x:r,y:s},{bandAware:!0});return hc(t,"discard")&&!o.isInRange(l)?null:l},Lj=function(e){function t(){return nGe(this,t),iGe(this,t,arguments)}return cGe(t,e),aGe(t,[{key:"render",value:function(){var s=this.props,a=s.x,i=s.y,o=s.r,l=s.alwaysShow,d=s.clipPathId,c=ha(a),u=ha(i);if(Hc(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!u)return null;var h=uGe(this.props);if(!h)return null;var f=h.x,m=h.y,p=this.props,g=p.shape,x=p.className,v=hc(this.props,"hidden")?"url(#".concat(d,")"):void 0,y=oL(oL({clipPath:v},on(this.props,!0)),{},{cx:f,cy:m});return je.createElement(Ns,{className:pn("recharts-reference-dot",x)},t.renderDot(g,y),ri.renderCallByParent(this.props,{x:f-o,y:m-o,width:2*o,height:2*o}))}}])}(je.Component);Dj(Lj,"displayName","ReferenceDot");Dj(Lj,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});Dj(Lj,"renderDot",function(e,t){var r;return je.isValidElement(e)?r=je.cloneElement(e,t):Yr(e)?r=e(t):r=je.createElement(VA,oE({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function cE(){return cE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},cE.apply(this,arguments)}function Bp(e){"@babel/helpers - typeof";return Bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bp(e)}function lL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function cL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lL(Object(r),!0).forEach(function(s){Bj(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function hGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fGe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,tJ(s.key),s)}}function mGe(e,t,r){return t&&fGe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pGe(e,t,r){return t=S2(t),gGe(e,eJ()?Reflect.construct(t,r||[],S2(e).constructor):t.apply(e,r))}function gGe(e,t){if(t&&(Bp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xGe(e)}function xGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(eJ=function(){return!!e})()}function S2(e){return S2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},S2(e)}function vGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&dE(e,t)}function dE(e,t){return dE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},dE(e,t)}function Bj(e,t,r){return t=tJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tJ(e){var t=yGe(e,"string");return Bp(t)=="symbol"?t:t+""}function yGe(e,t){if(Bp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Bp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bGe=function(t,r,s,a,i){var o=i.x1,l=i.x2,d=i.y1,c=i.y2,u=i.xAxis,h=i.yAxis;if(!u||!h)return null;var f=qA({x:u.scale,y:h.scale}),m={x:t?f.x.apply(o,{position:"start"}):f.x.rangeMin,y:s?f.y.apply(d,{position:"start"}):f.y.rangeMin},p={x:r?f.x.apply(l,{position:"end"}):f.x.rangeMax,y:a?f.y.apply(c,{position:"end"}):f.y.rangeMax};return hc(i,"discard")&&(!f.isInRange(m)||!f.isInRange(p))?null:zQ(m,p)},$j=function(e){function t(){return hGe(this,t),pGe(this,t,arguments)}return vGe(t,e),mGe(t,[{key:"render",value:function(){var s=this.props,a=s.x1,i=s.x2,o=s.y1,l=s.y2,d=s.className,c=s.alwaysShow,u=s.clipPathId;Hc(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=ha(a),f=ha(i),m=ha(o),p=ha(l),g=this.props.shape;if(!h&&!f&&!m&&!p&&!g)return null;var x=bGe(h,f,m,p,this.props);if(!x&&!g)return null;var v=hc(this.props,"hidden")?"url(#".concat(u,")"):void 0;return je.createElement(Ns,{className:pn("recharts-reference-area",d)},t.renderRect(g,cL(cL({clipPath:v},on(this.props,!0)),x)),ri.renderCallByParent(this.props,x))}}])}(je.Component);Bj($j,"displayName","ReferenceArea");Bj($j,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});Bj($j,"renderRect",function(e,t){var r;return je.isValidElement(e)?r=je.cloneElement(e,t):Yr(e)?r=e(t):r=je.createElement(UA,cE({},t,{className:"recharts-reference-area-rect"})),r});function rJ(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var s=[],a=0;a<e.length;a+=t)s.push(e[a]);return s}function wGe(e,t,r){var s={width:e.width+t.width,height:e.height+t.height};return pHe(s,r)}function _Ge(e,t,r){var s=r==="width",a=e.x,i=e.y,o=e.width,l=e.height;return t===1?{start:s?a:i,end:s?a+o:i+l}:{start:s?a+o:i+l,end:s?a:i}}function C2(e,t,r,s,a){if(e*t<e*s||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-s)>=0&&e*(t+e*i/2-a)<=0}function jGe(e,t){return rJ(e,t+1)}function NGe(e,t,r,s,a){for(var i=(s||[]).slice(),o=t.start,l=t.end,d=0,c=1,u=o,h=function(){var p=s==null?void 0:s[d];if(p===void 0)return{v:rJ(s,c)};var g=d,x,v=function(){return x===void 0&&(x=r(p,g)),x},y=p.coordinate,b=d===0||C2(e,y,v,u,l);b||(d=0,u=o,c+=1),b&&(u=y+e*(v()/2+a),d+=c)},f;c<=i.length;)if(f=h(),f)return f.v;return[]}function Iv(e){"@babel/helpers - typeof";return Iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Iv(e)}function dL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function ei(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dL(Object(r),!0).forEach(function(s){SGe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function SGe(e,t,r){return t=CGe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CGe(e){var t=EGe(e,"string");return Iv(t)=="symbol"?t:t+""}function EGe(e,t){if(Iv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Iv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kGe(e,t,r,s,a){for(var i=(s||[]).slice(),o=i.length,l=t.start,d=t.end,c=function(f){var m=i[f],p,g=function(){return p===void 0&&(p=r(m,f)),p};if(f===o-1){var x=e*(m.coordinate+e*g()/2-d);i[f]=m=ei(ei({},m),{},{tickCoord:x>0?m.coordinate-x*e:m.coordinate})}else i[f]=m=ei(ei({},m),{},{tickCoord:m.coordinate});var v=C2(e,m.tickCoord,g,l,d);v&&(d=m.tickCoord-e*(g()/2+a),i[f]=ei(ei({},m),{},{isShow:!0}))},u=o-1;u>=0;u--)c(u);return i}function AGe(e,t,r,s,a,i){var o=(s||[]).slice(),l=o.length,d=t.start,c=t.end;if(i){var u=s[l-1],h=r(u,l-1),f=e*(u.coordinate+e*h/2-c);o[l-1]=u=ei(ei({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate});var m=C2(e,u.tickCoord,function(){return h},d,c);m&&(c=u.tickCoord-e*(h/2+a),o[l-1]=ei(ei({},u),{},{isShow:!0}))}for(var p=i?l-1:l,g=function(y){var b=o[y],j,T=function(){return j===void 0&&(j=r(b,y)),j};if(y===0){var O=e*(b.coordinate-e*T()/2-d);o[y]=b=ei(ei({},b),{},{tickCoord:O<0?b.coordinate-O*e:b.coordinate})}else o[y]=b=ei(ei({},b),{},{tickCoord:b.coordinate});var R=C2(e,b.tickCoord,T,d,c);R&&(d=b.tickCoord+e*(T()/2+a),o[y]=ei(ei({},b),{},{isShow:!0}))},x=0;x<p;x++)g(x);return o}function ZA(e,t,r){var s=e.tick,a=e.ticks,i=e.viewBox,o=e.minTickGap,l=e.orientation,d=e.interval,c=e.tickFormatter,u=e.unit,h=e.angle;if(!a||!a.length||!s)return[];if(Kt(d)||Gc.isSsr)return jGe(a,typeof d=="number"&&Kt(d)?d:0);var f=[],m=l==="top"||l==="bottom"?"width":"height",p=u&&m==="width"?ex(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=function(b,j){var T=Yr(c)?c(b.value,j):b.value;return m==="width"?wGe(ex(T,{fontSize:t,letterSpacing:r}),p,h):ex(T,{fontSize:t,letterSpacing:r})[m]},x=a.length>=2?xl(a[1].coordinate-a[0].coordinate):1,v=_Ge(i,x,m);return d==="equidistantPreserveStart"?NGe(x,v,g,a,o):(d==="preserveStart"||d==="preserveStartEnd"?f=AGe(x,v,g,a,o,d==="preserveStartEnd"):f=kGe(x,v,g,a,o),f.filter(function(y){return y.isShow}))}var TGe=["viewBox"],PGe=["viewBox"],OGe=["ticks"];function $p(e){"@babel/helpers - typeof";return $p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$p(e)}function Sm(){return Sm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Sm.apply(this,arguments)}function uL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function na(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uL(Object(r),!0).forEach(function(s){QA(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function y4(e,t){if(e==null)return{};var r=RGe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function RGe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function MGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hL(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,sJ(s.key),s)}}function IGe(e,t,r){return t&&hL(e.prototype,t),r&&hL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DGe(e,t,r){return t=E2(t),LGe(e,nJ()?Reflect.construct(t,r||[],E2(e).constructor):t.apply(e,r))}function LGe(e,t){if(t&&($p(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BGe(e)}function BGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nJ=function(){return!!e})()}function E2(e){return E2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},E2(e)}function $Ge(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uE(e,t)}function uE(e,t){return uE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},uE(e,t)}function QA(e,t,r){return t=sJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sJ(e){var t=FGe(e,"string");return $p(t)=="symbol"?t:t+""}function FGe(e,t){if($p(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if($p(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ig=function(e){function t(r){var s;return MGe(this,t),s=DGe(this,t,[r]),s.state={fontSize:"",letterSpacing:""},s}return $Ge(t,e),IGe(t,[{key:"shouldComponentUpdate",value:function(s,a){var i=s.viewBox,o=y4(s,TGe),l=this.props,d=l.viewBox,c=y4(l,PGe);return!Um(i,d)||!Um(o,c)||!Um(a,this.state)}},{key:"componentDidMount",value:function(){var s=this.layerReference;if(s){var a=s.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(s){var a=this.props,i=a.x,o=a.y,l=a.width,d=a.height,c=a.orientation,u=a.tickSize,h=a.mirror,f=a.tickMargin,m,p,g,x,v,y,b=h?-1:1,j=s.tickSize||u,T=Kt(s.tickCoord)?s.tickCoord:s.coordinate;switch(c){case"top":m=p=s.coordinate,x=o+ +!h*d,g=x-b*j,y=g-b*f,v=T;break;case"left":g=x=s.coordinate,p=i+ +!h*l,m=p-b*j,v=m-b*f,y=T;break;case"right":g=x=s.coordinate,p=i+ +h*l,m=p+b*j,v=m+b*f,y=T;break;default:m=p=s.coordinate,x=o+ +h*d,g=x+b*j,y=g+b*f,v=T;break}return{line:{x1:m,y1:g,x2:p,y2:x},tick:{x:v,y}}}},{key:"getTickTextAnchor",value:function(){var s=this.props,a=s.orientation,i=s.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var s=this.props,a=s.orientation,i=s.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var s=this.props,a=s.x,i=s.y,o=s.width,l=s.height,d=s.orientation,c=s.mirror,u=s.axisLine,h=na(na(na({},on(this.props,!1)),on(u,!1)),{},{fill:"none"});if(d==="top"||d==="bottom"){var f=+(d==="top"&&!c||d==="bottom"&&c);h=na(na({},h),{},{x1:a,y1:i+f*l,x2:a+o,y2:i+f*l})}else{var m=+(d==="left"&&!c||d==="right"&&c);h=na(na({},h),{},{x1:a+m*o,y1:i,x2:a+m*o,y2:i+l})}return je.createElement("line",Sm({},h,{className:pn("recharts-cartesian-axis-line",Bo(u,"className"))}))}},{key:"renderTicks",value:function(s,a,i){var o=this,l=this.props,d=l.tickLine,c=l.stroke,u=l.tick,h=l.tickFormatter,f=l.unit,m=ZA(na(na({},this.props),{},{ticks:s}),a,i),p=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),x=on(this.props,!1),v=on(u,!1),y=na(na({},x),{},{fill:"none"},on(d,!1)),b=m.map(function(j,T){var O=o.getTickLineCoord(j),R=O.line,D=O.tick,B=na(na(na(na({textAnchor:p,verticalAnchor:g},x),{},{stroke:"none",fill:c},v),D),{},{index:T,payload:j,visibleTicksCount:m.length,tickFormatter:h});return je.createElement(Ns,Sm({className:"recharts-cartesian-axis-tick",key:"tick-".concat(j.value,"-").concat(j.coordinate,"-").concat(j.tickCoord)},Iw(o.props,j,T)),d&&je.createElement("line",Sm({},y,R,{className:pn("recharts-cartesian-axis-tick-line",Bo(d,"className"))})),u&&t.renderTickItem(u,B,"".concat(Yr(h)?h(j.value,T):j.value).concat(f||"")))});return je.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var s=this,a=this.props,i=a.axisLine,o=a.width,l=a.height,d=a.ticksGenerator,c=a.className,u=a.hide;if(u)return null;var h=this.props,f=h.ticks,m=y4(h,OGe),p=f;return Yr(d)&&(p=f&&f.length>0?d(this.props):d(m)),o<=0||l<=0||!p||!p.length?null:je.createElement(Ns,{className:pn("recharts-cartesian-axis",c),ref:function(x){s.layerReference=x}},i&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),ri.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(s,a,i){var o,l=pn(a.className,"recharts-cartesian-axis-tick-value");return je.isValidElement(s)?o=je.cloneElement(s,na(na({},a),{},{className:l})):Yr(s)?o=s(na(na({},a),{},{className:l})):o=je.createElement(Xw,Sm({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(P.Component);QA(Ig,"displayName","CartesianAxis");QA(Ig,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var zGe=["x1","y1","x2","y2","key"],UGe=["offset"];function mf(e){"@babel/helpers - typeof";return mf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mf(e)}function fL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fL(Object(r),!0).forEach(function(s){VGe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function VGe(e,t,r){return t=qGe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qGe(e){var t=WGe(e,"string");return mf(t)=="symbol"?t:t+""}function WGe(e,t){if(mf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(mf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ch(){return Ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ch.apply(this,arguments)}function mL(e,t){if(e==null)return{};var r=HGe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function HGe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}var GGe=function(t){var r=t.fill;if(!r||r==="none")return null;var s=t.fillOpacity,a=t.x,i=t.y,o=t.width,l=t.height,d=t.ry;return je.createElement("rect",{x:a,y:i,ry:d,width:o,height:l,stroke:"none",fill:r,fillOpacity:s,className:"recharts-cartesian-grid-bg"})};function aJ(e,t){var r;if(je.isValidElement(e))r=je.cloneElement(e,t);else if(Yr(e))r=e(t);else{var s=t.x1,a=t.y1,i=t.x2,o=t.y2,l=t.key,d=mL(t,zGe),c=on(d,!1);c.offset;var u=mL(c,UGe);r=je.createElement("line",Ch({},u,{x1:s,y1:a,x2:i,y2:o,fill:"none",key:l}))}return r}function KGe(e){var t=e.x,r=e.width,s=e.horizontal,a=s===void 0?!0:s,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(l,d){var c=ni(ni({},e),{},{x1:t,y1:l,x2:t+r,y2:l,key:"line-".concat(d),index:d});return aJ(a,c)});return je.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function XGe(e){var t=e.y,r=e.height,s=e.vertical,a=s===void 0?!0:s,i=e.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(l,d){var c=ni(ni({},e),{},{x1:l,y1:t,x2:l,y2:t+r,key:"line-".concat(d),index:d});return aJ(a,c)});return je.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function YGe(e){var t=e.horizontalFill,r=e.fillOpacity,s=e.x,a=e.y,i=e.width,o=e.height,l=e.horizontalPoints,d=e.horizontal,c=d===void 0?!0:d;if(!c||!t||!t.length)return null;var u=l.map(function(f){return Math.round(f+a-a)}).sort(function(f,m){return f-m});a!==u[0]&&u.unshift(0);var h=u.map(function(f,m){var p=!u[m+1],g=p?a+o-f:u[m+1]-f;if(g<=0)return null;var x=m%t.length;return je.createElement("rect",{key:"react-".concat(m),y:f,x:s,height:g,width:i,stroke:"none",fill:t[x],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return je.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function ZGe(e){var t=e.vertical,r=t===void 0?!0:t,s=e.verticalFill,a=e.fillOpacity,i=e.x,o=e.y,l=e.width,d=e.height,c=e.verticalPoints;if(!r||!s||!s.length)return null;var u=c.map(function(f){return Math.round(f+i-i)}).sort(function(f,m){return f-m});i!==u[0]&&u.unshift(0);var h=u.map(function(f,m){var p=!u[m+1],g=p?i+l-f:u[m+1]-f;if(g<=0)return null;var x=m%s.length;return je.createElement("rect",{key:"react-".concat(m),x:f,y:o,width:g,height:d,stroke:"none",fill:s[x],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return je.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var QGe=function(t,r){var s=t.xAxis,a=t.width,i=t.height,o=t.offset;return pQ(ZA(ni(ni(ni({},Ig.defaultProps),s),{},{ticks:Vc(s,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},JGe=function(t,r){var s=t.yAxis,a=t.width,i=t.height,o=t.offset;return pQ(ZA(ni(ni(ni({},Ig.defaultProps),s),{},{ticks:Vc(s,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},Qf={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function iJ(e){var t,r,s,a,i,o,l=GA(),d=KA(),c=FHe(),u=ni(ni({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Qf.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:Qf.fill,horizontal:(s=e.horizontal)!==null&&s!==void 0?s:Qf.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:Qf.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Qf.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:Qf.verticalFill,x:Kt(e.x)?e.x:c.left,y:Kt(e.y)?e.y:c.top,width:Kt(e.width)?e.width:c.width,height:Kt(e.height)?e.height:c.height}),h=u.x,f=u.y,m=u.width,p=u.height,g=u.syncWithTicks,x=u.horizontalValues,v=u.verticalValues,y=LHe(),b=BHe();if(!Kt(m)||m<=0||!Kt(p)||p<=0||!Kt(h)||h!==+h||!Kt(f)||f!==+f)return null;var j=u.verticalCoordinatesGenerator||QGe,T=u.horizontalCoordinatesGenerator||JGe,O=u.horizontalPoints,R=u.verticalPoints;if((!O||!O.length)&&Yr(T)){var D=x&&x.length,B=T({yAxis:b?ni(ni({},b),{},{ticks:D?x:b.ticks}):void 0,width:l,height:d,offset:c},D?!0:g);Hc(Array.isArray(B),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(mf(B),"]")),Array.isArray(B)&&(O=B)}if((!R||!R.length)&&Yr(j)){var q=v&&v.length,Y=j({xAxis:y?ni(ni({},y),{},{ticks:q?v:y.ticks}):void 0,width:l,height:d,offset:c},q?!0:g);Hc(Array.isArray(Y),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(mf(Y),"]")),Array.isArray(Y)&&(R=Y)}return je.createElement("g",{className:"recharts-cartesian-grid"},je.createElement(GGe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),je.createElement(KGe,Ch({},u,{offset:c,horizontalPoints:O,xAxis:y,yAxis:b})),je.createElement(XGe,Ch({},u,{offset:c,verticalPoints:R,xAxis:y,yAxis:b})),je.createElement(YGe,Ch({},u,{horizontalPoints:O})),je.createElement(ZGe,Ch({},u,{verticalPoints:R})))}iJ.displayName="CartesianGrid";var eKe=["layout","type","stroke","connectNulls","isRange","ref"],tKe=["key"],oJ;function Fp(e){"@babel/helpers - typeof";return Fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fp(e)}function lJ(e,t){if(e==null)return{};var r=rKe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function rKe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function Eh(){return Eh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Eh.apply(this,arguments)}function pL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Od(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pL(Object(r),!0).forEach(function(s){rc(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function nKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gL(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,dJ(s.key),s)}}function sKe(e,t,r){return t&&gL(e.prototype,t),r&&gL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aKe(e,t,r){return t=k2(t),iKe(e,cJ()?Reflect.construct(t,r||[],k2(e).constructor):t.apply(e,r))}function iKe(e,t){if(t&&(Fp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oKe(e)}function oKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cJ=function(){return!!e})()}function k2(e){return k2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},k2(e)}function lKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hE(e,t)}function hE(e,t){return hE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},hE(e,t)}function rc(e,t,r){return t=dJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dJ(e){var t=cKe(e,"string");return Fp(t)=="symbol"?t:t+""}function cKe(e,t){if(Fp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Fp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cd=function(e){function t(){var r;nKe(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return r=aKe(this,t,[].concat(a)),rc(r,"state",{isAnimationFinished:!0}),rc(r,"id",j1("recharts-area-")),rc(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Yr(o)&&o()}),rc(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Yr(o)&&o()}),r}return lKe(t,e),sKe(t,[{key:"renderDots",value:function(s,a,i){var o=this.props.isAnimationActive,l=this.state.isAnimationFinished;if(o&&!l)return null;var d=this.props,c=d.dot,u=d.points,h=d.dataKey,f=on(this.props,!1),m=on(c,!0),p=u.map(function(x,v){var y=Od(Od(Od({key:"dot-".concat(v),r:3},f),m),{},{index:v,cx:x.x,cy:x.y,dataKey:h,value:x.value,payload:x.payload,points:u});return t.renderDotItem(c,y)}),g={clipPath:s?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return je.createElement(Ns,Eh({className:"recharts-area-dots"},g),p)}},{key:"renderHorizontalRect",value:function(s){var a=this.props,i=a.baseLine,o=a.points,l=a.strokeWidth,d=o[0].x,c=o[o.length-1].x,u=s*Math.abs(d-c),h=eu(o.map(function(f){return f.y||0}));return Kt(i)&&typeof i=="number"?h=Math.max(i,h):i&&Array.isArray(i)&&i.length&&(h=Math.max(eu(i.map(function(f){return f.y||0})),h)),Kt(h)?je.createElement("rect",{x:d<c?d:d-u,y:0,width:u,height:Math.floor(h+(l?parseInt("".concat(l),10):1))}):null}},{key:"renderVerticalRect",value:function(s){var a=this.props,i=a.baseLine,o=a.points,l=a.strokeWidth,d=o[0].y,c=o[o.length-1].y,u=s*Math.abs(d-c),h=eu(o.map(function(f){return f.x||0}));return Kt(i)&&typeof i=="number"?h=Math.max(i,h):i&&Array.isArray(i)&&i.length&&(h=Math.max(eu(i.map(function(f){return f.x||0})),h)),Kt(h)?je.createElement("rect",{x:0,y:d<c?d:d-u,width:h+(l?parseInt("".concat(l),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(s){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(s):this.renderHorizontalRect(s)}},{key:"renderAreaStatically",value:function(s,a,i,o){var l=this.props,d=l.layout,c=l.type,u=l.stroke,h=l.connectNulls,f=l.isRange;l.ref;var m=lJ(l,eKe);return je.createElement(Ns,{clipPath:i?"url(#clipPath-".concat(o,")"):null},je.createElement(nx,Eh({},on(m,!0),{points:s,connectNulls:h,type:c,baseLine:a,layout:d,stroke:"none",className:"recharts-area-area"})),u!=="none"&&je.createElement(nx,Eh({},on(this.props,!1),{className:"recharts-area-curve",layout:d,type:c,connectNulls:h,fill:"none",points:s})),u!=="none"&&f&&je.createElement(nx,Eh({},on(this.props,!1),{className:"recharts-area-curve",layout:d,type:c,connectNulls:h,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(s,a){var i=this,o=this.props,l=o.points,d=o.baseLine,c=o.isAnimationActive,u=o.animationBegin,h=o.animationDuration,f=o.animationEasing,m=o.animationId,p=this.state,g=p.prevPoints,x=p.prevBaseLine;return je.createElement(ld,{begin:u,duration:h,isActive:c,easing:f,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(v){var y=v.t;if(g){var b=g.length/l.length,j=l.map(function(D,B){var q=Math.floor(B*b);if(g[q]){var Y=g[q],G=Po(Y.x,D.x),I=Po(Y.y,D.y);return Od(Od({},D),{},{x:G(y),y:I(y)})}return D}),T;if(Kt(d)&&typeof d=="number"){var O=Po(x,d);T=O(y)}else if(un(d)||kg(d)){var R=Po(x,0);T=R(y)}else T=d.map(function(D,B){var q=Math.floor(B*b);if(x[q]){var Y=x[q],G=Po(Y.x,D.x),I=Po(Y.y,D.y);return Od(Od({},D),{},{x:G(y),y:I(y)})}return D});return i.renderAreaStatically(j,T,s,a)}return je.createElement(Ns,null,je.createElement("defs",null,je.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(y))),je.createElement(Ns,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(l,d,s,a)))})}},{key:"renderArea",value:function(s,a){var i=this.props,o=i.points,l=i.baseLine,d=i.isAnimationActive,c=this.state,u=c.prevPoints,h=c.prevBaseLine,f=c.totalLength;return d&&o&&o.length&&(!u&&f>0||!mv(u,o)||!mv(h,l))?this.renderAreaWithAnimation(s,a):this.renderAreaStatically(o,l,s,a)}},{key:"render",value:function(){var s,a=this.props,i=a.hide,o=a.dot,l=a.points,d=a.className,c=a.top,u=a.left,h=a.xAxis,f=a.yAxis,m=a.width,p=a.height,g=a.isAnimationActive,x=a.id;if(i||!l||!l.length)return null;var v=this.state.isAnimationFinished,y=l.length===1,b=pn("recharts-area",d),j=h&&h.allowDataOverflow,T=f&&f.allowDataOverflow,O=j||T,R=un(x)?this.id:x,D=(s=on(o,!1))!==null&&s!==void 0?s:{r:3,strokeWidth:2},B=D.r,q=B===void 0?3:B,Y=D.strokeWidth,G=Y===void 0?2:Y,I=Cke(o)?o:{},F=I.clipDot,S=F===void 0?!0:F,E=q*2+G;return je.createElement(Ns,{className:b},j||T?je.createElement("defs",null,je.createElement("clipPath",{id:"clipPath-".concat(R)},je.createElement("rect",{x:j?u:u-m/2,y:T?c:c-p/2,width:j?m:m*2,height:T?p:p*2})),!S&&je.createElement("clipPath",{id:"clipPath-dots-".concat(R)},je.createElement("rect",{x:u-E/2,y:c-E/2,width:m+E,height:p+E}))):null,y?null:this.renderArea(O,R),(o||y)&&this.renderDots(O,S,R),(!g||v)&&gu.renderCallByParent(this.props,l))}}],[{key:"getDerivedStateFromProps",value:function(s,a){return s.animationId!==a.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,curBaseLine:s.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:s.points!==a.curPoints||s.baseLine!==a.curBaseLine?{curPoints:s.points,curBaseLine:s.baseLine}:null}}])}(P.PureComponent);oJ=cd;rc(cd,"displayName","Area");rc(cd,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!Gc.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});rc(cd,"getBaseValue",function(e,t,r,s){var a=e.layout,i=e.baseValue,o=t.props.baseValue,l=o??i;if(Kt(l)&&typeof l=="number")return l;var d=a==="horizontal"?s:r,c=d.scale.domain();if(d.type==="number"){var u=Math.max(c[0],c[1]),h=Math.min(c[0],c[1]);return l==="dataMin"?h:l==="dataMax"||u<0?u:Math.max(Math.min(c[0],c[1]),0)}return l==="dataMin"?c[0]:l==="dataMax"?c[1]:c[0]});rc(cd,"getComposedData",function(e){var t=e.props,r=e.item,s=e.xAxis,a=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,l=e.bandSize,d=e.dataKey,c=e.stackedData,u=e.dataStartIndex,h=e.displayedData,f=e.offset,m=t.layout,p=c&&c.length,g=oJ.getBaseValue(t,r,s,a),x=m==="horizontal",v=!1,y=h.map(function(j,T){var O;p?O=c[u+T]:(O=xo(j,d),Array.isArray(O)?v=!0:O=[g,O]);var R=O[1]==null||p&&xo(j,d)==null;return x?{x:Z9({axis:s,ticks:i,bandSize:l,entry:j,index:T}),y:R?null:a.scale(O[1]),value:O,payload:j}:{x:R?null:s.scale(O[1]),y:Z9({axis:a,ticks:o,bandSize:l,entry:j,index:T}),value:O,payload:j}}),b;return p||v?b=y.map(function(j){var T=Array.isArray(j.value)?j.value[0]:null;return x?{x:j.x,y:T!=null&&j.y!=null?a.scale(T):null}:{x:T!=null?s.scale(T):null,y:j.y}}):b=x?a.scale(g):s.scale(g),Od({points:y,baseLine:b,layout:m,isRange:v},f)});rc(cd,"renderDotItem",function(e,t){var r;if(je.isValidElement(e))r=je.cloneElement(e,t);else if(Yr(e))r=e(t);else{var s=pn("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,i=lJ(t,tKe);r=je.createElement(VA,Eh({},i,{key:a,className:s}))}return r});function zp(e){"@babel/helpers - typeof";return zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zp(e)}function dKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uKe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,fJ(s.key),s)}}function hKe(e,t,r){return t&&uKe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function fKe(e,t,r){return t=A2(t),mKe(e,uJ()?Reflect.construct(t,r||[],A2(e).constructor):t.apply(e,r))}function mKe(e,t){if(t&&(zp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pKe(e)}function pKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uJ=function(){return!!e})()}function A2(e){return A2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},A2(e)}function gKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fE(e,t)}function fE(e,t){return fE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},fE(e,t)}function hJ(e,t,r){return t=fJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fJ(e){var t=xKe(e,"string");return zp(t)=="symbol"?t:t+""}function xKe(e,t){if(zp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(zp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mE(){return mE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},mE.apply(this,arguments)}function vKe(e){var t=e.xAxisId,r=GA(),s=KA(),a=KQ(t);return a==null?null:P.createElement(Ig,mE({},a,{className:pn("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:s},ticksGenerator:function(o){return Vc(o,!0)}}))}var Fj=function(e){function t(){return dKe(this,t),fKe(this,t,arguments)}return gKe(t,e),hKe(t,[{key:"render",value:function(){return P.createElement(vKe,this.props)}}])}(P.Component);hJ(Fj,"displayName","XAxis");hJ(Fj,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function Up(e){"@babel/helpers - typeof";return Up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Up(e)}function yKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bKe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,gJ(s.key),s)}}function wKe(e,t,r){return t&&bKe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ke(e,t,r){return t=T2(t),jKe(e,mJ()?Reflect.construct(t,r||[],T2(e).constructor):t.apply(e,r))}function jKe(e,t){if(t&&(Up(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NKe(e)}function NKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mJ=function(){return!!e})()}function T2(e){return T2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},T2(e)}function SKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pE(e,t)}function pE(e,t){return pE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},pE(e,t)}function pJ(e,t,r){return t=gJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gJ(e){var t=CKe(e,"string");return Up(t)=="symbol"?t:t+""}function CKe(e,t){if(Up(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Up(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gE(){return gE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},gE.apply(this,arguments)}var EKe=function(t){var r=t.yAxisId,s=GA(),a=KA(),i=XQ(r);return i==null?null:P.createElement(Ig,gE({},i,{className:pn("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:s,height:a},ticksGenerator:function(l){return Vc(l,!0)}}))},zj=function(e){function t(){return yKe(this,t),_Ke(this,t,arguments)}return SKe(t,e),wKe(t,[{key:"render",value:function(){return P.createElement(EKe,this.props)}}])}(P.Component);pJ(zj,"displayName","YAxis");pJ(zj,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function xL(e){return PKe(e)||TKe(e)||AKe(e)||kKe()}function kKe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AKe(e,t){if(e){if(typeof e=="string")return xE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xE(e,t)}}function TKe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function PKe(e){if(Array.isArray(e))return xE(e)}function xE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}var vE=function(t,r,s,a,i){var o=_l(t,YA),l=_l(t,Lj),d=[].concat(xL(o),xL(l)),c=_l(t,$j),u="".concat(a,"Id"),h=a[0],f=r;if(d.length&&(f=d.reduce(function(g,x){if(x.props[u]===s&&hc(x.props,"extendDomain")&&Kt(x.props[h])){var v=x.props[h];return[Math.min(g[0],v),Math.max(g[1],v)]}return g},f)),c.length){var m="".concat(h,"1"),p="".concat(h,"2");f=c.reduce(function(g,x){if(x.props[u]===s&&hc(x.props,"extendDomain")&&Kt(x.props[m])&&Kt(x.props[p])){var v=x.props[m],y=x.props[p];return[Math.min(g[0],v,y),Math.max(g[1],v,y)]}return g},f)}return i&&i.length&&(f=i.reduce(function(g,x){return Kt(x)?[Math.min(g[0],x),Math.max(g[1],x)]:g},f)),f},xJ={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function a(d,c,u){this.fn=d,this.context=c,this.once=u||!1}function i(d,c,u,h,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new a(u,h||d,f),p=r?r+c:c;return d._events[p]?d._events[p].fn?d._events[p]=[d._events[p],m]:d._events[p].push(m):(d._events[p]=m,d._eventsCount++),d}function o(d,c){--d._eventsCount===0?d._events=new s:delete d._events[c]}function l(){this._events=new s,this._eventsCount=0}l.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)t.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},l.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,m=h.length,p=new Array(m);f<m;f++)p[f]=h[f].fn;return p},l.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},l.prototype.emit=function(c,u,h,f,m,p){var g=r?r+c:c;if(!this._events[g])return!1;var x=this._events[g],v=arguments.length,y,b;if(x.fn){switch(x.once&&this.removeListener(c,x.fn,void 0,!0),v){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,h),!0;case 4:return x.fn.call(x.context,u,h,f),!0;case 5:return x.fn.call(x.context,u,h,f,m),!0;case 6:return x.fn.call(x.context,u,h,f,m,p),!0}for(b=1,y=new Array(v-1);b<v;b++)y[b-1]=arguments[b];x.fn.apply(x.context,y)}else{var j=x.length,T;for(b=0;b<j;b++)switch(x[b].once&&this.removeListener(c,x[b].fn,void 0,!0),v){case 1:x[b].fn.call(x[b].context);break;case 2:x[b].fn.call(x[b].context,u);break;case 3:x[b].fn.call(x[b].context,u,h);break;case 4:x[b].fn.call(x[b].context,u,h,f);break;default:if(!y)for(T=1,y=new Array(v-1);T<v;T++)y[T-1]=arguments[T];x[b].fn.apply(x[b].context,y)}}return!0},l.prototype.on=function(c,u,h){return i(this,c,u,h,!1)},l.prototype.once=function(c,u,h){return i(this,c,u,h,!0)},l.prototype.removeListener=function(c,u,h,f){var m=r?r+c:c;if(!this._events[m])return this;if(!u)return o(this,m),this;var p=this._events[m];if(p.fn)p.fn===u&&(!f||p.once)&&(!h||p.context===h)&&o(this,m);else{for(var g=0,x=[],v=p.length;g<v;g++)(p[g].fn!==u||f&&!p[g].once||h&&p[g].context!==h)&&x.push(p[g]);x.length?this._events[m]=x.length===1?x[0]:x:o(this,m)}return this},l.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&o(this,u)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(xJ);var OKe=xJ.exports;const RKe=Ln(OKe);var b4=new RKe,w4="recharts.syncMouseEvents";function Dv(e){"@babel/helpers - typeof";return Dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dv(e)}function MKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IKe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,vJ(s.key),s)}}function DKe(e,t,r){return t&&IKe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _4(e,t,r){return t=vJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vJ(e){var t=LKe(e,"string");return Dv(t)=="symbol"?t:t+""}function LKe(e,t){if(Dv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(Dv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var BKe=function(){function e(){MKe(this,e),_4(this,"activeIndex",0),_4(this,"coordinateList",[]),_4(this,"layout","horizontal")}return DKe(e,[{key:"setDetails",value:function(r){var s,a=r.coordinateList,i=a===void 0?null:a,o=r.container,l=o===void 0?null:o,d=r.layout,c=d===void 0?null:d,u=r.offset,h=u===void 0?null:u,f=r.mouseHandlerCallback,m=f===void 0?null:f;this.coordinateList=(s=i??this.coordinateList)!==null&&s!==void 0?s:[],this.container=l??this.container,this.layout=c??this.layout,this.offset=h??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,s;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,l=a.height,d=this.coordinateList[this.activeIndex].coordinate,c=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((s=window)===null||s===void 0?void 0:s.scrollY)||0,h=i+d+c,f=o+this.offset.top+l/2+u;this.mouseHandlerCallback({pageX:h,pageY:f})}}}])}();function $Ke(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var s=e==null?void 0:e[0],a=e==null?void 0:e[1];if(s&&a&&Kt(s)&&Kt(a))return!0}return!1}function FKe(e,t,r,s){var a=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?s:r.width-1,height:e==="horizontal"?r.height-1:s}}function yJ(e){var t=e.cx,r=e.cy,s=e.radius,a=e.startAngle,i=e.endAngle,o=za(t,r,s,a),l=za(t,r,s,i);return{points:[o,l],cx:t,cy:r,radius:s,startAngle:a,endAngle:i}}function zKe(e,t,r){var s,a,i,o;if(e==="horizontal")s=t.x,i=s,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,s=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,d=t.cy,c=t.innerRadius,u=t.outerRadius,h=t.angle,f=za(l,d,c,h),m=za(l,d,u,h);s=f.x,a=f.y,i=m.x,o=m.y}else return yJ(t);return[{x:s,y:a},{x:i,y:o}]}function Lv(e){"@babel/helpers - typeof";return Lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lv(e)}function vL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Gy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vL(Object(r),!0).forEach(function(s){UKe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function UKe(e,t,r){return t=VKe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VKe(e){var t=qKe(e,"string");return Lv(t)=="symbol"?t:t+""}function qKe(e,t){if(Lv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Lv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WKe(e){var t,r,s=e.element,a=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,l=e.activePayload,d=e.offset,c=e.activeTooltipIndex,u=e.tooltipAxisBandSize,h=e.layout,f=e.chartName,m=(t=s.props.cursor)!==null&&t!==void 0?t:(r=s.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!s||!m||!i||!o||f!=="ScatterChart"&&a!=="axis")return null;var p,g=nx;if(f==="ScatterChart")p=o,g=KVe;else if(f==="BarChart")p=FKe(h,o,d,u),g=UA;else if(h==="radial"){var x=yJ(o),v=x.cx,y=x.cy,b=x.radius,j=x.startAngle,T=x.endAngle;p={cx:v,cy:y,startAngle:j,endAngle:T,innerRadius:b,outerRadius:b},g=bQ}else p={points:zKe(h,o,d)},g=nx;var O=Gy(Gy(Gy(Gy({stroke:"#ccc",pointerEvents:"none"},d),p),on(m,!1)),{},{payload:l,payloadIndex:c,className:pn("recharts-tooltip-cursor",m.className)});return P.isValidElement(m)?P.cloneElement(m,O):P.createElement(g,O)}var HKe=["item"],GKe=["children","className","width","height","style","compact","title","desc"];function Vp(e){"@babel/helpers - typeof";return Vp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vp(e)}function Cm(){return Cm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Cm.apply(this,arguments)}function yL(e,t){return YKe(e)||XKe(e,t)||wJ(e,t)||KKe()}function KKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XKe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,l=[],d=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(l.push(s.value),l.length!==t);d=!0);}catch(u){c=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(c)throw a}}return l}}function YKe(e){if(Array.isArray(e))return e}function bL(e,t){if(e==null)return{};var r=ZKe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function ZKe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function QKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JKe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,_J(s.key),s)}}function eXe(e,t,r){return t&&JKe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tXe(e,t,r){return t=P2(t),rXe(e,bJ()?Reflect.construct(t,r||[],P2(e).constructor):t.apply(e,r))}function rXe(e,t){if(t&&(Vp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nXe(e)}function nXe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function bJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(bJ=function(){return!!e})()}function P2(e){return P2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},P2(e)}function sXe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yE(e,t)}function yE(e,t){return yE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},yE(e,t)}function qp(e){return oXe(e)||iXe(e)||wJ(e)||aXe()}function aXe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wJ(e,t){if(e){if(typeof e=="string")return bE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bE(e,t)}}function iXe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oXe(e){if(Array.isArray(e))return bE(e)}function bE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function wL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function jt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wL(Object(r),!0).forEach(function(s){Ar(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Ar(e,t,r){return t=_J(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _J(e){var t=lXe(e,"string");return Vp(t)=="symbol"?t:t+""}function lXe(e,t){if(Vp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Vp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cXe={xAxis:["bottom","top"],yAxis:["left","right"]},dXe={width:"100%",height:"100%"},jJ={x:0,y:0};function Ky(e){return e}var uXe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},hXe=function(t,r,s,a){var i=r.find(function(u){return u&&u.index===s});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,l=a.radius;return jt(jt(jt({},a),za(a.cx,a.cy,l,o)),{},{angle:o,radius:l})}var d=i.coordinate,c=a.angle;return jt(jt(jt({},a),za(a.cx,a.cy,d,c)),{},{angle:c,radius:d})}return jJ},Uj=function(t,r){var s=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(s??[]).reduce(function(l,d){var c=d.props.data;return c&&c.length?[].concat(qp(l),qp(c)):l},[]);return o.length>0?o:t&&t.length&&Kt(a)&&Kt(i)?t.slice(a,i+1):[]};function NJ(e){return e==="number"?[0,"auto"]:void 0}var wE=function(t,r,s,a){var i=t.graphicalItems,o=t.tooltipAxis,l=Uj(r,t);return s<0||!i||!i.length||s>=l.length?null:i.reduce(function(d,c){var u,h=(u=c.props.data)!==null&&u!==void 0?u:r;h&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=s&&(h=h.slice(t.dataStartIndex,t.dataEndIndex+1));var f;if(o.dataKey&&!o.allowDuplicatedCategory){var m=h===void 0?l:h;f=Rw(m,o.dataKey,a)}else f=h&&h[s]||l[s];return f?[].concat(qp(d),[xQ(c,f)]):d},[])},_L=function(t,r,s,a){var i=a||{x:t.chartX,y:t.chartY},o=uXe(i,s),l=t.orderedTooltipTicks,d=t.tooltipAxis,c=t.tooltipTicks,u=TFe(o,l,c,d);if(u>=0&&c){var h=c[u]&&c[u].value,f=wE(t,r,u,h),m=hXe(s,l,u,i);return{activeTooltipIndex:u,activeLabel:h,activePayload:f,activeCoordinate:m}}return null},fXe=function(t,r){var s=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,d=r.dataStartIndex,c=r.dataEndIndex,u=t.layout,h=t.children,f=t.stackOffset,m=mQ(u,i);return s.reduce(function(p,g){var x,v=g.type.defaultProps!==void 0?jt(jt({},g.type.defaultProps),g.props):g.props,y=v.type,b=v.dataKey,j=v.allowDataOverflow,T=v.allowDuplicatedCategory,O=v.scale,R=v.ticks,D=v.includeHidden,B=v[o];if(p[B])return p;var q=Uj(t.data,{graphicalItems:a.filter(function($){var X,Z=o in $.props?$.props[o]:(X=$.type.defaultProps)===null||X===void 0?void 0:X[o];return Z===B}),dataStartIndex:d,dataEndIndex:c}),Y=q.length,G,I,F;$Ke(v.domain,j,y)&&(G=F5(v.domain,null,j),m&&(y==="number"||O!=="auto")&&(F=rx(q,b,"category")));var S=NJ(y);if(!G||G.length===0){var E,N=(E=v.domain)!==null&&E!==void 0?E:S;if(b){if(G=rx(q,b,y),y==="category"&&m){var C=gke(G);T&&C?(I=G,G=v2(0,Y)):T||(G=tD(N,G,g).reduce(function($,X){return $.indexOf(X)>=0?$:[].concat(qp($),[X])},[]))}else if(y==="category")T?G=G.filter(function($){return $!==""&&!un($)}):G=tD(N,G,g).reduce(function($,X){return $.indexOf(X)>=0||X===""||un(X)?$:[].concat(qp($),[X])},[]);else if(y==="number"){var k=IFe(q,a.filter(function($){var X,Z,re=o in $.props?$.props[o]:(X=$.type.defaultProps)===null||X===void 0?void 0:X[o],W="hide"in $.props?$.props.hide:(Z=$.type.defaultProps)===null||Z===void 0?void 0:Z.hide;return re===B&&(D||!W)}),b,i,u);k&&(G=k)}m&&(y==="number"||O!=="auto")&&(F=rx(q,b,"category"))}else m?G=v2(0,Y):l&&l[B]&&l[B].hasStack&&y==="number"?G=f==="expand"?[0,1]:gQ(l[B].stackGroups,d,c):G=fQ(q,a.filter(function($){var X=o in $.props?$.props[o]:$.type.defaultProps[o],Z="hide"in $.props?$.props.hide:$.type.defaultProps.hide;return X===B&&(D||!Z)}),y,u,!0);if(y==="number")G=vE(h,G,B,i,R),N&&(G=F5(N,G,j));else if(y==="category"&&N){var M=N,U=G.every(function($){return M.indexOf($)>=0});U&&(G=M)}}return jt(jt({},p),{},Ar({},B,jt(jt({},v),{},{axisType:i,domain:G,categoricalDomain:F,duplicateDomain:I,originalDomain:(x=v.domain)!==null&&x!==void 0?x:S,isCategorical:m,layout:u})))},{})},mXe=function(t,r){var s=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,l=r.stackGroups,d=r.dataStartIndex,c=r.dataEndIndex,u=t.layout,h=t.children,f=Uj(t.data,{graphicalItems:s,dataStartIndex:d,dataEndIndex:c}),m=f.length,p=mQ(u,i),g=-1;return s.reduce(function(x,v){var y=v.type.defaultProps!==void 0?jt(jt({},v.type.defaultProps),v.props):v.props,b=y[o],j=NJ("number");if(!x[b]){g++;var T;return p?T=v2(0,m):l&&l[b]&&l[b].hasStack?(T=gQ(l[b].stackGroups,d,c),T=vE(h,T,b,i)):(T=F5(j,fQ(f,s.filter(function(O){var R,D,B=o in O.props?O.props[o]:(R=O.type.defaultProps)===null||R===void 0?void 0:R[o],q="hide"in O.props?O.props.hide:(D=O.type.defaultProps)===null||D===void 0?void 0:D.hide;return B===b&&!q}),"number",u),a.defaultProps.allowDataOverflow),T=vE(h,T,b,i)),jt(jt({},x),{},Ar({},b,jt(jt({axisType:i},a.defaultProps),{},{hide:!0,orientation:Bo(cXe,"".concat(i,".").concat(g%2),null),domain:T,originalDomain:j,isCategorical:p,layout:u})))}return x},{})},pXe=function(t,r){var s=r.axisType,a=s===void 0?"xAxis":s,i=r.AxisComp,o=r.graphicalItems,l=r.stackGroups,d=r.dataStartIndex,c=r.dataEndIndex,u=t.children,h="".concat(a,"Id"),f=_l(u,i),m={};return f&&f.length?m=fXe(t,{axes:f,graphicalItems:o,axisType:a,axisIdKey:h,stackGroups:l,dataStartIndex:d,dataEndIndex:c}):o&&o.length&&(m=mXe(t,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:h,stackGroups:l,dataStartIndex:d,dataEndIndex:c})),m},gXe=function(t){var r=zd(t),s=Vc(r,!1,!0);return{tooltipTicks:s,orderedTooltipTicks:pA(s,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:c2(r,s)}},jL=function(t){var r=t.children,s=t.defaultShowTooltip,a=ro(r,Mp),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!s}},xXe=function(t){return!t||!t.length?!1:t.some(function(r){var s=Wc(r&&r.type);return s&&s.indexOf("Bar")>=0})},NL=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},vXe=function(t,r){var s=t.props,a=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,l=t.yAxisMap,d=l===void 0?{}:l,c=s.width,u=s.height,h=s.children,f=s.margin||{},m=ro(h,Mp),p=ro(h,$h),g=Object.keys(d).reduce(function(T,O){var R=d[O],D=R.orientation;return!R.mirror&&!R.hide?jt(jt({},T),{},Ar({},D,T[D]+R.width)):T},{left:f.left||0,right:f.right||0}),x=Object.keys(o).reduce(function(T,O){var R=o[O],D=R.orientation;return!R.mirror&&!R.hide?jt(jt({},T),{},Ar({},D,Bo(T,"".concat(D))+R.height)):T},{top:f.top||0,bottom:f.bottom||0}),v=jt(jt({},x),g),y=v.bottom;m&&(v.bottom+=m.props.height||Mp.defaultProps.height),p&&r&&(v=RFe(v,a,s,r));var b=c-v.left-v.right,j=u-v.top-v.bottom;return jt(jt({brushBottom:y},v),{},{width:Math.max(b,0),height:Math.max(j,0)})},yXe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},bXe=function(t){var r=t.chartName,s=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,o=t.validateTooltipEventTypes,l=o===void 0?["axis"]:o,d=t.axisComponents,c=t.legendContent,u=t.formatAxisMap,h=t.defaultProps,f=function(v,y){var b=y.graphicalItems,j=y.stackGroups,T=y.offset,O=y.updateId,R=y.dataStartIndex,D=y.dataEndIndex,B=v.barSize,q=v.layout,Y=v.barGap,G=v.barCategoryGap,I=v.maxBarSize,F=NL(q),S=F.numericAxisName,E=F.cateAxisName,N=xXe(b),C=[];return b.forEach(function(k,M){var U=Uj(v.data,{graphicalItems:[k],dataStartIndex:R,dataEndIndex:D}),$=k.type.defaultProps!==void 0?jt(jt({},k.type.defaultProps),k.props):k.props,X=$.dataKey,Z=$.maxBarSize,re=$["".concat(S,"Id")],W=$["".concat(E,"Id")],J={},V=d.reduce(function(be,ye){var Oe=y["".concat(ye.axisType,"Map")],Ne=$["".concat(ye.axisType,"Id")];Oe&&Oe[Ne]||ye.axisType==="zAxis"||ff();var De=Oe[Ne];return jt(jt({},be),{},Ar(Ar({},ye.axisType,De),"".concat(ye.axisType,"Ticks"),Vc(De)))},J),H=V[E],ee=V["".concat(E,"Ticks")],ie=j&&j[re]&&j[re].hasStack&&GFe(k,j[re].stackGroups),oe=Wc(k.type).indexOf("Bar")>=0,se=c2(H,ee),ue=[],pe=N&&PFe({barSize:B,stackGroups:j,totalSize:yXe(V,E)});if(oe){var ce,ne,me=un(Z)?I:Z,ge=(ce=(ne=c2(H,ee,!0))!==null&&ne!==void 0?ne:me)!==null&&ce!==void 0?ce:0;ue=OFe({barGap:Y,barCategoryGap:G,bandSize:ge!==se?ge:se,sizeList:pe[W],maxBarSize:me}),ge!==se&&(ue=ue.map(function(be){return jt(jt({},be),{},{position:jt(jt({},be.position),{},{offset:be.position.offset-ge/2})})}))}var _e=k&&k.type&&k.type.getComposedData;_e&&C.push({props:jt(jt({},_e(jt(jt({},V),{},{displayedData:U,props:v,dataKey:X,item:k,bandSize:se,barPosition:ue,offset:T,stackedData:ie,layout:q,dataStartIndex:R,dataEndIndex:D}))),{},Ar(Ar(Ar({key:k.key||"item-".concat(M)},S,V[S]),E,V[E]),"animationId",O)),childIndex:Ake(k,v.children),item:k})}),C},m=function(v,y){var b=v.props,j=v.dataStartIndex,T=v.dataEndIndex,O=v.updateId;if(!K7({props:b}))return null;var R=b.children,D=b.layout,B=b.stackOffset,q=b.data,Y=b.reverseStackOrder,G=NL(D),I=G.numericAxisName,F=G.cateAxisName,S=_l(R,s),E=qFe(q,S,"".concat(I,"Id"),"".concat(F,"Id"),B,Y),N=d.reduce(function($,X){var Z="".concat(X.axisType,"Map");return jt(jt({},$),{},Ar({},Z,pXe(b,jt(jt({},X),{},{graphicalItems:S,stackGroups:X.axisType===I&&E,dataStartIndex:j,dataEndIndex:T}))))},{}),C=vXe(jt(jt({},N),{},{props:b,graphicalItems:S}),y==null?void 0:y.legendBBox);Object.keys(N).forEach(function($){N[$]=u(b,N[$],C,$.replace("Map",""),r)});var k=N["".concat(F,"Map")],M=gXe(k),U=f(b,jt(jt({},N),{},{dataStartIndex:j,dataEndIndex:T,updateId:O,graphicalItems:S,stackGroups:E,offset:C}));return jt(jt({formattedGraphicalItems:U,graphicalItems:S,offset:C,stackGroups:E},M),N)},p=function(x){function v(y){var b,j,T;return QKe(this,v),T=tXe(this,v,[y]),Ar(T,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Ar(T,"accessibilityManager",new BKe),Ar(T,"handleLegendBBoxUpdate",function(O){if(O){var R=T.state,D=R.dataStartIndex,B=R.dataEndIndex,q=R.updateId;T.setState(jt({legendBBox:O},m({props:T.props,dataStartIndex:D,dataEndIndex:B,updateId:q},jt(jt({},T.state),{},{legendBBox:O}))))}}),Ar(T,"handleReceiveSyncEvent",function(O,R,D){if(T.props.syncId===O){if(D===T.eventEmitterSymbol&&typeof T.props.syncMethod!="function")return;T.applySyncEvent(R)}}),Ar(T,"handleBrushChange",function(O){var R=O.startIndex,D=O.endIndex;if(R!==T.state.dataStartIndex||D!==T.state.dataEndIndex){var B=T.state.updateId;T.setState(function(){return jt({dataStartIndex:R,dataEndIndex:D},m({props:T.props,dataStartIndex:R,dataEndIndex:D,updateId:B},T.state))}),T.triggerSyncEvent({dataStartIndex:R,dataEndIndex:D})}}),Ar(T,"handleMouseEnter",function(O){var R=T.getMouseInfo(O);if(R){var D=jt(jt({},R),{},{isTooltipActive:!0});T.setState(D),T.triggerSyncEvent(D);var B=T.props.onMouseEnter;Yr(B)&&B(D,O)}}),Ar(T,"triggeredAfterMouseMove",function(O){var R=T.getMouseInfo(O),D=R?jt(jt({},R),{},{isTooltipActive:!0}):{isTooltipActive:!1};T.setState(D),T.triggerSyncEvent(D);var B=T.props.onMouseMove;Yr(B)&&B(D,O)}),Ar(T,"handleItemMouseEnter",function(O){T.setState(function(){return{isTooltipActive:!0,activeItem:O,activePayload:O.tooltipPayload,activeCoordinate:O.tooltipPosition||{x:O.cx,y:O.cy}}})}),Ar(T,"handleItemMouseLeave",function(){T.setState(function(){return{isTooltipActive:!1}})}),Ar(T,"handleMouseMove",function(O){O.persist(),T.throttleTriggeredAfterMouseMove(O)}),Ar(T,"handleMouseLeave",function(O){T.throttleTriggeredAfterMouseMove.cancel();var R={isTooltipActive:!1};T.setState(R),T.triggerSyncEvent(R);var D=T.props.onMouseLeave;Yr(D)&&D(R,O)}),Ar(T,"handleOuterEvent",function(O){var R=kke(O),D=Bo(T.props,"".concat(R));if(R&&Yr(D)){var B,q;/.*touch.*/i.test(R)?q=T.getMouseInfo(O.changedTouches[0]):q=T.getMouseInfo(O),D((B=q)!==null&&B!==void 0?B:{},O)}}),Ar(T,"handleClick",function(O){var R=T.getMouseInfo(O);if(R){var D=jt(jt({},R),{},{isTooltipActive:!0});T.setState(D),T.triggerSyncEvent(D);var B=T.props.onClick;Yr(B)&&B(D,O)}}),Ar(T,"handleMouseDown",function(O){var R=T.props.onMouseDown;if(Yr(R)){var D=T.getMouseInfo(O);R(D,O)}}),Ar(T,"handleMouseUp",function(O){var R=T.props.onMouseUp;if(Yr(R)){var D=T.getMouseInfo(O);R(D,O)}}),Ar(T,"handleTouchMove",function(O){O.changedTouches!=null&&O.changedTouches.length>0&&T.throttleTriggeredAfterMouseMove(O.changedTouches[0])}),Ar(T,"handleTouchStart",function(O){O.changedTouches!=null&&O.changedTouches.length>0&&T.handleMouseDown(O.changedTouches[0])}),Ar(T,"handleTouchEnd",function(O){O.changedTouches!=null&&O.changedTouches.length>0&&T.handleMouseUp(O.changedTouches[0])}),Ar(T,"handleDoubleClick",function(O){var R=T.props.onDoubleClick;if(Yr(R)){var D=T.getMouseInfo(O);R(D,O)}}),Ar(T,"handleContextMenu",function(O){var R=T.props.onContextMenu;if(Yr(R)){var D=T.getMouseInfo(O);R(D,O)}}),Ar(T,"triggerSyncEvent",function(O){T.props.syncId!==void 0&&b4.emit(w4,T.props.syncId,O,T.eventEmitterSymbol)}),Ar(T,"applySyncEvent",function(O){var R=T.props,D=R.layout,B=R.syncMethod,q=T.state.updateId,Y=O.dataStartIndex,G=O.dataEndIndex;if(O.dataStartIndex!==void 0||O.dataEndIndex!==void 0)T.setState(jt({dataStartIndex:Y,dataEndIndex:G},m({props:T.props,dataStartIndex:Y,dataEndIndex:G,updateId:q},T.state)));else if(O.activeTooltipIndex!==void 0){var I=O.chartX,F=O.chartY,S=O.activeTooltipIndex,E=T.state,N=E.offset,C=E.tooltipTicks;if(!N)return;if(typeof B=="function")S=B(C,O);else if(B==="value"){S=-1;for(var k=0;k<C.length;k++)if(C[k].value===O.activeLabel){S=k;break}}var M=jt(jt({},N),{},{x:N.left,y:N.top}),U=Math.min(I,M.x+M.width),$=Math.min(F,M.y+M.height),X=C[S]&&C[S].value,Z=wE(T.state,T.props.data,S),re=C[S]?{x:D==="horizontal"?C[S].coordinate:U,y:D==="horizontal"?$:C[S].coordinate}:jJ;T.setState(jt(jt({},O),{},{activeLabel:X,activeCoordinate:re,activePayload:Z,activeTooltipIndex:S}))}else T.setState(O)}),Ar(T,"renderCursor",function(O){var R,D=T.state,B=D.isTooltipActive,q=D.activeCoordinate,Y=D.activePayload,G=D.offset,I=D.activeTooltipIndex,F=D.tooltipAxisBandSize,S=T.getTooltipEventType(),E=(R=O.props.active)!==null&&R!==void 0?R:B,N=T.props.layout,C=O.key||"_recharts-cursor";return je.createElement(WKe,{key:C,activeCoordinate:q,activePayload:Y,activeTooltipIndex:I,chartName:r,element:O,isActive:E,layout:N,offset:G,tooltipAxisBandSize:F,tooltipEventType:S})}),Ar(T,"renderPolarAxis",function(O,R,D){var B=Bo(O,"type.axisType"),q=Bo(T.state,"".concat(B,"Map")),Y=O.type.defaultProps,G=Y!==void 0?jt(jt({},Y),O.props):O.props,I=q&&q[G["".concat(B,"Id")]];return P.cloneElement(O,jt(jt({},I),{},{className:pn(B,I.className),key:O.key||"".concat(R,"-").concat(D),ticks:Vc(I,!0)}))}),Ar(T,"renderPolarGrid",function(O){var R=O.props,D=R.radialLines,B=R.polarAngles,q=R.polarRadius,Y=T.state,G=Y.radiusAxisMap,I=Y.angleAxisMap,F=zd(G),S=zd(I),E=S.cx,N=S.cy,C=S.innerRadius,k=S.outerRadius;return P.cloneElement(O,{polarAngles:Array.isArray(B)?B:Vc(S,!0).map(function(M){return M.coordinate}),polarRadius:Array.isArray(q)?q:Vc(F,!0).map(function(M){return M.coordinate}),cx:E,cy:N,innerRadius:C,outerRadius:k,key:O.key||"polar-grid",radialLines:D})}),Ar(T,"renderLegend",function(){var O=T.state.formattedGraphicalItems,R=T.props,D=R.children,B=R.width,q=R.height,Y=T.props.margin||{},G=B-(Y.left||0)-(Y.right||0),I=uQ({children:D,formattedGraphicalItems:O,legendWidth:G,legendContent:c});if(!I)return null;var F=I.item,S=bL(I,HKe);return P.cloneElement(F,jt(jt({},S),{},{chartWidth:B,chartHeight:q,margin:Y,onBBoxUpdate:T.handleLegendBBoxUpdate}))}),Ar(T,"renderTooltip",function(){var O,R=T.props,D=R.children,B=R.accessibilityLayer,q=ro(D,Vl);if(!q)return null;var Y=T.state,G=Y.isTooltipActive,I=Y.activeCoordinate,F=Y.activePayload,S=Y.activeLabel,E=Y.offset,N=(O=q.props.active)!==null&&O!==void 0?O:G;return P.cloneElement(q,{viewBox:jt(jt({},E),{},{x:E.left,y:E.top}),active:N,label:S,payload:N?F:[],coordinate:I,accessibilityLayer:B})}),Ar(T,"renderBrush",function(O){var R=T.props,D=R.margin,B=R.data,q=T.state,Y=q.offset,G=q.dataStartIndex,I=q.dataEndIndex,F=q.updateId;return P.cloneElement(O,{key:O.key||"_recharts-brush",onChange:Vy(T.handleBrushChange,O.props.onChange),data:B,x:Kt(O.props.x)?O.props.x:Y.left,y:Kt(O.props.y)?O.props.y:Y.top+Y.height+Y.brushBottom-(D.bottom||0),width:Kt(O.props.width)?O.props.width:Y.width,startIndex:G,endIndex:I,updateId:"brush-".concat(F)})}),Ar(T,"renderReferenceElement",function(O,R,D){if(!O)return null;var B=T,q=B.clipPathId,Y=T.state,G=Y.xAxisMap,I=Y.yAxisMap,F=Y.offset,S=O.type.defaultProps||{},E=O.props,N=E.xAxisId,C=N===void 0?S.xAxisId:N,k=E.yAxisId,M=k===void 0?S.yAxisId:k;return P.cloneElement(O,{key:O.key||"".concat(R,"-").concat(D),xAxis:G[C],yAxis:I[M],viewBox:{x:F.left,y:F.top,width:F.width,height:F.height},clipPathId:q})}),Ar(T,"renderActivePoints",function(O){var R=O.item,D=O.activePoint,B=O.basePoint,q=O.childIndex,Y=O.isRange,G=[],I=R.props.key,F=R.item.type.defaultProps!==void 0?jt(jt({},R.item.type.defaultProps),R.item.props):R.item.props,S=F.activeDot,E=F.dataKey,N=jt(jt({index:q,dataKey:E,cx:D.x,cy:D.y,r:4,fill:zA(R.item),strokeWidth:2,stroke:"#fff",payload:D.payload,value:D.value},on(S,!1)),Mw(S));return G.push(v.renderActiveDot(S,N,"".concat(I,"-activePoint-").concat(q))),B?G.push(v.renderActiveDot(S,jt(jt({},N),{},{cx:B.x,cy:B.y}),"".concat(I,"-basePoint-").concat(q))):Y&&G.push(null),G}),Ar(T,"renderGraphicChild",function(O,R,D){var B=T.filterFormatItem(O,R,D);if(!B)return null;var q=T.getTooltipEventType(),Y=T.state,G=Y.isTooltipActive,I=Y.tooltipAxis,F=Y.activeTooltipIndex,S=Y.activeLabel,E=T.props.children,N=ro(E,Vl),C=B.props,k=C.points,M=C.isRange,U=C.baseLine,$=B.item.type.defaultProps!==void 0?jt(jt({},B.item.type.defaultProps),B.item.props):B.item.props,X=$.activeDot,Z=$.hide,re=$.activeBar,W=$.activeShape,J=!!(!Z&&G&&N&&(X||re||W)),V={};q!=="axis"&&N&&N.props.trigger==="click"?V={onClick:Vy(T.handleItemMouseEnter,O.props.onClick)}:q!=="axis"&&(V={onMouseLeave:Vy(T.handleItemMouseLeave,O.props.onMouseLeave),onMouseEnter:Vy(T.handleItemMouseEnter,O.props.onMouseEnter)});var H=P.cloneElement(O,jt(jt({},B.props),V));function ee(ye){return typeof I.dataKey=="function"?I.dataKey(ye.payload):null}if(J)if(F>=0){var ie,oe;if(I.dataKey&&!I.allowDuplicatedCategory){var se=typeof I.dataKey=="function"?ee:"payload.".concat(I.dataKey.toString());ie=Rw(k,se,S),oe=M&&U&&Rw(U,se,S)}else ie=k==null?void 0:k[F],oe=M&&U&&U[F];if(W||re){var ue=O.props.activeIndex!==void 0?O.props.activeIndex:F;return[P.cloneElement(O,jt(jt(jt({},B.props),V),{},{activeIndex:ue})),null,null]}if(!un(ie))return[H].concat(qp(T.renderActivePoints({item:B,activePoint:ie,basePoint:oe,childIndex:F,isRange:M})))}else{var pe,ce=(pe=T.getItemByXY(T.state.activeCoordinate))!==null&&pe!==void 0?pe:{graphicalItem:H},ne=ce.graphicalItem,me=ne.item,ge=me===void 0?O:me,_e=ne.childIndex,be=jt(jt(jt({},B.props),V),{},{activeIndex:_e});return[P.cloneElement(ge,be),null,null]}return M?[H,null,null]:[H,null]}),Ar(T,"renderCustomized",function(O,R,D){return P.cloneElement(O,jt(jt({key:"recharts-customized-".concat(D)},T.props),T.state))}),Ar(T,"renderMap",{CartesianGrid:{handler:Ky,once:!0},ReferenceArea:{handler:T.renderReferenceElement},ReferenceLine:{handler:Ky},ReferenceDot:{handler:T.renderReferenceElement},XAxis:{handler:Ky},YAxis:{handler:Ky},Brush:{handler:T.renderBrush,once:!0},Bar:{handler:T.renderGraphicChild},Line:{handler:T.renderGraphicChild},Area:{handler:T.renderGraphicChild},Radar:{handler:T.renderGraphicChild},RadialBar:{handler:T.renderGraphicChild},Scatter:{handler:T.renderGraphicChild},Pie:{handler:T.renderGraphicChild},Funnel:{handler:T.renderGraphicChild},Tooltip:{handler:T.renderCursor,once:!0},PolarGrid:{handler:T.renderPolarGrid,once:!0},PolarAngleAxis:{handler:T.renderPolarAxis},PolarRadiusAxis:{handler:T.renderPolarAxis},Customized:{handler:T.renderCustomized}}),T.clipPathId="".concat((b=y.id)!==null&&b!==void 0?b:j1("recharts"),"-clip"),T.throttleTriggeredAfterMouseMove=dZ(T.triggeredAfterMouseMove,(j=y.throttleDelay)!==null&&j!==void 0?j:1e3/60),T.state={},T}return sXe(v,x),eXe(v,[{key:"componentDidMount",value:function(){var b,j;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,j=b.children,T=b.data,O=b.height,R=b.layout,D=ro(j,Vl);if(D){var B=D.props.defaultIndex;if(!(typeof B!="number"||B<0||B>this.state.tooltipTicks.length-1)){var q=this.state.tooltipTicks[B]&&this.state.tooltipTicks[B].value,Y=wE(this.state,T,B,q),G=this.state.tooltipTicks[B].coordinate,I=(this.state.offset.top+O)/2,F=R==="horizontal",S=F?{x:G,y:I}:{y:G,x:I},E=this.state.formattedGraphicalItems.find(function(C){var k=C.item;return k.type.name==="Scatter"});E&&(S=jt(jt({},S),E.props.points[B].tooltipPosition),Y=E.props.points[B].tooltipPayload);var N={activeTooltipIndex:B,isTooltipActive:!0,activeLabel:q,activePayload:Y,activeCoordinate:S};this.setState(N),this.renderCursor(D),this.accessibilityManager.setIndex(B)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,j){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==j.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var T,O;this.accessibilityManager.setDetails({offset:{left:(T=this.props.margin.left)!==null&&T!==void 0?T:0,top:(O=this.props.margin.top)!==null&&O!==void 0?O:0}})}return null}},{key:"componentDidUpdate",value:function(b){t5([ro(b.children,Vl)],[ro(this.props.children,Vl)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=ro(this.props.children,Vl);if(b&&typeof b.props.shared=="boolean"){var j=b.props.shared?"axis":"item";return l.indexOf(j)>=0?j:i}return i}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var j=this.container,T=j.getBoundingClientRect(),O=rDe(T),R={chartX:Math.round(b.pageX-O.left),chartY:Math.round(b.pageY-O.top)},D=T.width/j.offsetWidth||1,B=this.inRange(R.chartX,R.chartY,D);if(!B)return null;var q=this.state,Y=q.xAxisMap,G=q.yAxisMap,I=this.getTooltipEventType(),F=_L(this.state,this.props.data,this.props.layout,B);if(I!=="axis"&&Y&&G){var S=zd(Y).scale,E=zd(G).scale,N=S&&S.invert?S.invert(R.chartX):null,C=E&&E.invert?E.invert(R.chartY):null;return jt(jt({},R),{},{xValue:N,yValue:C},F)}return F?jt(jt({},R),F):null}},{key:"inRange",value:function(b,j){var T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,O=this.props.layout,R=b/T,D=j/T;if(O==="horizontal"||O==="vertical"){var B=this.state.offset,q=R>=B.left&&R<=B.left+B.width&&D>=B.top&&D<=B.top+B.height;return q?{x:R,y:D}:null}var Y=this.state,G=Y.angleAxisMap,I=Y.radiusAxisMap;if(G&&I){var F=zd(G);return sD({x:R,y:D},F)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,j=this.getTooltipEventType(),T=ro(b,Vl),O={};T&&j==="axis"&&(T.props.trigger==="click"?O={onClick:this.handleClick}:O={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var R=Mw(this.props,this.handleOuterEvent);return jt(jt({},R),O)}},{key:"addListener",value:function(){b4.on(w4,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){b4.removeListener(w4,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,j,T){for(var O=this.state.formattedGraphicalItems,R=0,D=O.length;R<D;R++){var B=O[R];if(B.item===b||B.props.key===b.key||j===Wc(B.item.type)&&T===B.childIndex)return B}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,j=this.state.offset,T=j.left,O=j.top,R=j.height,D=j.width;return je.createElement("defs",null,je.createElement("clipPath",{id:b},je.createElement("rect",{x:T,y:O,height:R,width:D})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(j,T){var O=yL(T,2),R=O[0],D=O[1];return jt(jt({},j),{},Ar({},R,D.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(j,T){var O=yL(T,2),R=O[0],D=O[1];return jt(jt({},j),{},Ar({},R,D.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var j;return(j=this.state.xAxisMap)===null||j===void 0||(j=j[b])===null||j===void 0?void 0:j.scale}},{key:"getYScaleByAxisId",value:function(b){var j;return(j=this.state.yAxisMap)===null||j===void 0||(j=j[b])===null||j===void 0?void 0:j.scale}},{key:"getItemByXY",value:function(b){var j=this.state,T=j.formattedGraphicalItems,O=j.activeItem;if(T&&T.length)for(var R=0,D=T.length;R<D;R++){var B=T[R],q=B.props,Y=B.item,G=Y.type.defaultProps!==void 0?jt(jt({},Y.type.defaultProps),Y.props):Y.props,I=Wc(Y.type);if(I==="Bar"){var F=(q.data||[]).find(function(C){return BVe(b,C)});if(F)return{graphicalItem:B,payload:F}}else if(I==="RadialBar"){var S=(q.data||[]).find(function(C){return sD(b,C)});if(S)return{graphicalItem:B,payload:S}}else if(Rj(B,O)||Mj(B,O)||Pv(B,O)){var E=zqe({graphicalItem:B,activeTooltipItem:O,itemData:G.data}),N=G.activeIndex===void 0?E:G.activeIndex;return{graphicalItem:jt(jt({},B),{},{childIndex:N}),payload:Pv(B,O)?G.data[E]:B.props.data[E]}}}return null}},{key:"render",value:function(){var b=this;if(!K7(this))return null;var j=this.props,T=j.children,O=j.className,R=j.width,D=j.height,B=j.style,q=j.compact,Y=j.title,G=j.desc,I=bL(j,GKe),F=on(I,!1);if(q)return je.createElement(rL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},je.createElement(n5,Cm({},F,{width:R,height:D,title:Y,desc:G}),this.renderClipPath(),Y7(T,this.renderMap)));if(this.props.accessibilityLayer){var S,E;F.tabIndex=(S=this.props.tabIndex)!==null&&S!==void 0?S:0,F.role=(E=this.props.role)!==null&&E!==void 0?E:"application",F.onKeyDown=function(C){b.accessibilityManager.keyboardEvent(C)},F.onFocus=function(){b.accessibilityManager.focus()}}var N=this.parseEventsOfWrapper();return je.createElement(rL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},je.createElement("div",Cm({className:pn("recharts-wrapper",O),style:jt({position:"relative",cursor:"default",width:R,height:D},B)},N,{ref:function(k){b.container=k}}),je.createElement(n5,Cm({},F,{width:R,height:D,title:Y,desc:G,style:dXe}),this.renderClipPath(),Y7(T,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(P.Component);Ar(p,"displayName",r),Ar(p,"defaultProps",jt({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),Ar(p,"getDerivedStateFromProps",function(x,v){var y=x.dataKey,b=x.data,j=x.children,T=x.width,O=x.height,R=x.layout,D=x.stackOffset,B=x.margin,q=v.dataStartIndex,Y=v.dataEndIndex;if(v.updateId===void 0){var G=jL(x);return jt(jt(jt({},G),{},{updateId:0},m(jt(jt({props:x},G),{},{updateId:0}),v)),{},{prevDataKey:y,prevData:b,prevWidth:T,prevHeight:O,prevLayout:R,prevStackOffset:D,prevMargin:B,prevChildren:j})}if(y!==v.prevDataKey||b!==v.prevData||T!==v.prevWidth||O!==v.prevHeight||R!==v.prevLayout||D!==v.prevStackOffset||!Um(B,v.prevMargin)){var I=jL(x),F={chartX:v.chartX,chartY:v.chartY,isTooltipActive:v.isTooltipActive},S=jt(jt({},_L(v,b,R)),{},{updateId:v.updateId+1}),E=jt(jt(jt({},I),F),S);return jt(jt(jt({},E),m(jt({props:x},E),v)),{},{prevDataKey:y,prevData:b,prevWidth:T,prevHeight:O,prevLayout:R,prevStackOffset:D,prevMargin:B,prevChildren:j})}if(!t5(j,v.prevChildren)){var N,C,k,M,U=ro(j,Mp),$=U&&(N=(C=U.props)===null||C===void 0?void 0:C.startIndex)!==null&&N!==void 0?N:q,X=U&&(k=(M=U.props)===null||M===void 0?void 0:M.endIndex)!==null&&k!==void 0?k:Y,Z=$!==q||X!==Y,re=!un(b),W=re&&!Z?v.updateId:v.updateId+1;return jt(jt({updateId:W},m(jt(jt({props:x},v),{},{updateId:W,dataStartIndex:$,dataEndIndex:X}),v)),{},{prevChildren:j,dataStartIndex:$,dataEndIndex:X})}return null}),Ar(p,"renderActiveDot",function(x,v,y){var b;return P.isValidElement(x)?b=P.cloneElement(x,v):Yr(x)?b=x(v):b=je.createElement(VA,v),je.createElement(Ns,{className:"recharts-active-dot",key:y},b)});var g=P.forwardRef(function(v,y){return je.createElement(p,Cm({},v,{ref:y}))});return g.displayName=p.displayName,g},wXe=bXe({chartName:"AreaChart",GraphicalChild:cd,axisComponents:[{axisType:"xAxis",AxisComp:Fj},{axisType:"yAxis",AxisComp:zj}],formatAxisMap:hHe});function _E({data:e}){const t=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(s);if(e.length===0)return n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Vs,{className:"h-5 w-5 text-primary"}),"Evoluo das Vendas"]})}),n.jsx(Fe,{children:n.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Nenhum dado de vendas para exibir"})})]});const r=({active:s,payload:a,label:i})=>s&&a&&a.length?n.jsxs("div",{className:"bg-background border rounded-lg shadow-lg p-3",children:[n.jsx("p",{className:"font-medium text-sm mb-2",children:i}),a.map((o,l)=>n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:o.color}}),n.jsxs("span",{className:"text-muted-foreground",children:[o.name,":"]}),n.jsx("span",{className:"font-medium",children:t(o.value)})]},l))]}):null;return n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Vs,{className:"h-5 w-5 text-primary"}),"Evoluo das Vendas"]})}),n.jsx(Fe,{children:n.jsx("div",{className:"h-[300px] w-full",children:n.jsx(X9e,{width:"100%",height:"100%",children:n.jsxs(wXe,{data:e,margin:{top:10,right:30,left:0,bottom:0},children:[n.jsxs("defs",{children:[n.jsxs("linearGradient",{id:"colorReservado",x1:"0",y1:"0",x2:"0",y2:"1",children:[n.jsx("stop",{offset:"5%",stopColor:"hsl(217, 91%, 60%)",stopOpacity:.3}),n.jsx("stop",{offset:"95%",stopColor:"hsl(217, 91%, 60%)",stopOpacity:0})]}),n.jsxs("linearGradient",{id:"colorPago",x1:"0",y1:"0",x2:"0",y2:"1",children:[n.jsx("stop",{offset:"5%",stopColor:"hsl(142, 76%, 36%)",stopOpacity:.4}),n.jsx("stop",{offset:"95%",stopColor:"hsl(142, 76%, 36%)",stopOpacity:0})]})]}),n.jsx(iJ,{strokeDasharray:"3 3",className:"stroke-muted"}),n.jsx(Fj,{dataKey:"time",tick:{fontSize:12},tickLine:!1,axisLine:!1,className:"text-muted-foreground"}),n.jsx(zj,{tick:{fontSize:12},tickLine:!1,axisLine:!1,tickFormatter:s=>t(s),className:"text-muted-foreground",width:80}),n.jsx(Vl,{content:n.jsx(r,{})}),n.jsx($h,{verticalAlign:"top",height:36,formatter:s=>n.jsx("span",{className:"text-sm text-foreground",children:s})}),n.jsx(cd,{type:"monotone",dataKey:"reservadoAcumulado",name:"Total Reservado",stroke:"hsl(217, 91%, 60%)",strokeWidth:2,fillOpacity:1,fill:"url(#colorReservado)"}),n.jsx(cd,{type:"monotone",dataKey:"pagoAcumulado",name:"Total Pago",stroke:"hsl(142, 76%, 36%)",strokeWidth:2,fillOpacity:1,fill:"url(#colorPago)"})]})})})})]})}function _Xe(){const{eventId:e}=ta(),t=pr(),{event:r,kpis:s,funnel:a,sellerPerformance:i,insights:o,topProducts:l,customerSales:d,timelineData:c,isLoading:u,refetch:h}=TCe(e);if(u)return n.jsx("div",{className:"min-h-screen bg-background p-4 md:p-6",children:n.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[n.jsx(Wr,{className:"h-10 w-64"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[...Array(6)].map((p,g)=>n.jsx(Wr,{className:"h-24"},g))}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(Wr,{className:"h-80"}),n.jsx(Wr,{className:"h-80"})]})]})});if(!r)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Kh,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Live no encontrada"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"O evento solicitado no existe."}),n.jsxs(he,{variant:"outline",onClick:()=>t("/dashboard"),children:[n.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Voltar ao Dashboard"]})]})});const f={planejada:{label:"Planejada",color:"bg-blue-100 text-blue-700"},ao_vivo:{label:"Ao Vivo",color:"bg-red-100 text-red-700 animate-pulse"},encerrada:{label:"Encerrada",color:"bg-muted text-muted-foreground"},arquivada:{label:"Arquivada",color:"bg-secondary text-secondary-foreground"}},m=f[r.status]||f.encerrada;return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>t("/dashboard"),children:n.jsx(Ts,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h1",{className:"text-lg font-semibold",children:r.titulo}),n.jsx(ke,{className:m.color,children:m.label})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(ns,{className:"h-3.5 w-3.5"}),Wt(new Date(r.data_hora_inicio),"dd 'de' MMMM 's' HH:mm",{locale:mr}),r.data_hora_fim&&n.jsxs(n.Fragment,{children:["  ",Wt(new Date(r.data_hora_fim),"HH:mm",{locale:mr})]})]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${r.id}/pedidos`),children:[n.jsx(Vt,{className:"h-4 w-4 mr-2"}),"Pedidos"]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${r.id}/separacao`),children:[n.jsx(lse,{className:"h-4 w-4 mr-2"}),"Separao"]}),r.status!=="ao_vivo"&&n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${r.id}/backstage`),children:[n.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Backstage"]}),n.jsx(he,{variant:"outline",size:"icon",onClick:()=>h(),children:n.jsx(Qr,{className:"h-4 w-4"})})]})]})}),n.jsxs("main",{className:"max-w-7xl mx-auto p-4 md:p-6 space-y-6",children:[s&&n.jsx(PCe,{kpis:s}),n.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[n.jsx(OCe,{funnel:a}),n.jsx(MCe,{insights:o})]}),n.jsx(RCe,{sellers:i}),n.jsx(_E,{data:c}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(QC,{products:l}),n.jsx(ICe,{sales:d,onRefresh:h})]})]})]})}function jXe(){const e=pr();ta();const[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await le.auth.getSession();if(!a){e("/login");return}const{data:i}=await le.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(l=>["merchant","admin"].includes(l.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsx(_Xe,{})}function SL(e,t){const[r,s]=P.useState([]),[a,i]=P.useState(null),[o,l]=P.useState([]),[d,c]=P.useState([]),[u,h]=P.useState(!1),f=P.useCallback(async()=>{if(!(!e||!t)){h(!0);try{const m=new Date(t);m.setHours(23,59,59,999);const{data:p,error:g}=await le.from("live_events").select("*").gte("data_hora_inicio",e.toISOString()).lte("data_hora_inicio",m.toISOString()).order("data_hora_inicio",{ascending:!1});if(g)throw g;if(!p||p.length===0){s([]),i(null),l([]),c([]),h(!1);return}const x=p.map(X=>X.id),{data:v,error:y}=await le.from("live_carts").select(`
          *,
          live_customer:live_customers(*),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color)
          )
        `).in("live_event_id",x);if(y)throw y;const b=v||[],j=new Map;b.forEach(X=>{const Z=j.get(X.live_event_id)||[];Z.push(X),j.set(X.live_event_id,Z)});const T=p.map(X=>{const Z=j.get(X.id)||[],re=Z.filter(J=>!["cancelado","expirado"].includes(J.status)),W=Z.filter(J=>J.status==="pago");return{id:X.id,titulo:X.titulo,data_hora_inicio:X.data_hora_inicio,data_hora_fim:X.data_hora_fim,status:X.status,totalReservado:re.reduce((J,V)=>J+V.total,0),totalPago:W.reduce((J,V)=>J+V.total,0),totalCarrinhos:Z.length,carrinhosPagos:W.length}});s(T);const O=b.filter(X=>X.status==="pago"),R=b.filter(X=>X.status==="aguardando_pagamento"||X.status==="em_confirmacao"),D=b.filter(X=>X.status==="aberto"),B=b.filter(X=>!["cancelado","expirado"].includes(X.status)),q=B.reduce((X,Z)=>X+Z.total,0),Y=O.reduce((X,Z)=>X+Z.total,0);let G=0;B.forEach(X=>{(X.items||[]).forEach(Z=>{["reservado","confirmado"].includes(Z.status)&&(G+=Z.qtd)})});let I=0;O.forEach(X=>{(X.items||[]).forEach(Z=>{Z.status==="confirmado"&&(I+=Z.qtd)})});let F=0;p.forEach(X=>{X.data_hora_fim&&X.data_hora_inicio&&(F+=Math.round((new Date(X.data_hora_fim).getTime()-new Date(X.data_hora_inicio).getTime())/6e4))});const S={totalReservado:q,totalItensReservados:G,ticketMedioReservado:B.length>0?q/B.length:0,totalPago:Y,totalItensPagos:I,ticketMedioPago:O.length>0?Y/O.length:0,totalCarrinhos:b.length,carrinhosAbertos:D.length,carrinhosAguardando:R.length,carrinhosPagos:O.length,taxaConversao:b.length>0?O.length/b.length*100:0,taxaPagamento:q>0?Y/q*100:0,duracaoMinutos:F,vendasPorHora:F>0?q/(F/60):q};i(S);const E=new Map;O.forEach(X=>{(X.items||[]).forEach(Z=>{if(Z.status==="confirmado"&&Z.product){const re=E.get(Z.product_id);re?(re.quantidadeVendida+=Z.qtd,re.valorTotal+=Z.preco_unitario*Z.qtd):E.set(Z.product_id,{productId:Z.product_id,productName:Z.product.name,productImage:Z.product.image_url,productColor:Z.product.color,quantidadeVendida:Z.qtd,valorTotal:Z.preco_unitario*Z.qtd})}})});const N=Array.from(E.values()).sort((X,Z)=>Z.valorTotal-X.valorTotal);l(N);const C=new Map;b.forEach(X=>{const Z=X.status==="pago";if(!!["cancelado","expirado"].includes(X.status))return;const W=new Date(X.created_at).toISOString().split("T")[0],J=C.get(W)||{reservado:0,pago:0};J.reservado+=X.total,Z&&(J.pago+=X.total),C.set(W,J)});const k=Array.from(C.entries()).sort((X,Z)=>X[0].localeCompare(Z[0]));let M=0,U=0;const $=k.map(([X,Z])=>{M+=Z.reservado,U+=Z.pago;const re=new Date(X);return{time:re.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"}),timestamp:re.getTime(),reservadoAcumulado:M,pagoAcumulado:U,reservadoMomento:Z.reservado}});c($)}catch(m){console.error("Error fetching period report data:",m)}finally{h(!1)}}},[e,t]);return P.useEffect(()=>{e&&t&&f()},[f,e,t]),{events:r,kpis:a,topProducts:o,timelineData:d,isLoading:u,totalEvents:r.length,refetch:f}}function CL({kpis:e}){const t=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a),r=a=>{const i=Math.floor(a/60),o=a%60;return i>0?`${i}h ${o}min`:`${o}min`},s=[{title:"Total Reservado",value:t(e.totalReservado),subtitle:`${e.totalItensReservados} itens em ${e.totalCarrinhos-e.carrinhosPagos} carrinhos`,icon:Ri,iconBg:"bg-blue-100",iconColor:"text-blue-600",highlight:!0},{title:"Total Pago",value:t(e.totalPago),subtitle:`${e.carrinhosPagos} vendas confirmadas`,icon:Sr,iconBg:"bg-green-100",iconColor:"text-green-600"},{title:"Ticket Mdio",value:t(e.ticketMedioReservado),subtitle:"Por carrinho",icon:ms,iconBg:"bg-purple-100",iconColor:"text-purple-600"},{title:"Taxa de Converso",value:`${e.taxaConversao.toFixed(1)}%`,subtitle:`${e.carrinhosPagos} de ${e.totalCarrinhos} carrinhos`,icon:li,iconBg:"bg-orange-100",iconColor:"text-orange-600"},{title:"Vendas por Hora",value:t(e.vendasPorHora),subtitle:e.duracaoMinutos>0?r(e.duracaoMinutos):"Durao no registrada",icon:Vs,iconBg:"bg-amber-100",iconColor:"text-amber-600"},{title:"Taxa de Pagamento",value:`${e.taxaPagamento.toFixed(1)}%`,subtitle:"Valor pago vs. reservado",icon:ks,iconBg:"bg-teal-100",iconColor:"text-teal-600"}];return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx($e,{className:"relative overflow-hidden border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-white",children:n.jsxs(Fe,{className:"p-5",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsx("div",{className:"p-2.5 rounded-lg bg-blue-100",children:n.jsx(Ri,{className:"h-5 w-5 text-blue-600"})}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded-full",children:[n.jsx(Lr,{className:"h-3 w-3"}),n.jsxs("span",{children:[e.carrinhosAbertos+e.carrinhosAguardando," pendentes"]})]})]}),n.jsx("div",{className:"text-3xl font-bold tracking-tight text-blue-700",children:t(e.totalReservado)}),n.jsx("div",{className:"text-sm font-medium text-blue-600 mt-1",children:"Total Reservado na Live"}),n.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[e.totalItensReservados," itens  ",e.totalCarrinhos," carrinhos"]})]})}),n.jsx($e,{className:"relative overflow-hidden border-2 border-green-200 bg-gradient-to-br from-green-50 to-white",children:n.jsxs(Fe,{className:"p-5",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsx("div",{className:"p-2.5 rounded-lg bg-green-100",children:n.jsx(Sr,{className:"h-5 w-5 text-green-600"})}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 bg-green-100 px-2 py-1 rounded-full",children:[n.jsx(Sr,{className:"h-3 w-3"}),n.jsxs("span",{children:[e.carrinhosPagos," pagos"]})]})]}),n.jsx("div",{className:"text-3xl font-bold tracking-tight text-green-700",children:t(e.totalPago)}),n.jsx("div",{className:"text-sm font-medium text-green-600 mt-1",children:"Total Pago"}),n.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[e.totalItensPagos," itens confirmados  Ticket mdio: ",t(e.ticketMedioPago)]})]})})]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.slice(2).map((a,i)=>n.jsx($e,{className:"relative overflow-hidden",children:n.jsxs(Fe,{className:"p-4",children:[n.jsx("div",{className:"flex items-start justify-between mb-2",children:n.jsx("div",{className:`p-2 rounded-lg ${a.iconBg}`,children:n.jsx(a.icon,{className:`h-4 w-4 ${a.iconColor}`})})}),n.jsx("div",{className:"text-2xl font-bold tracking-tight",children:a.value}),n.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:a.title}),n.jsx("div",{className:"text-xs text-muted-foreground/70 mt-0.5",children:a.subtitle})]})},i))})]})}function jE(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function Co(e,t){return t===0?e>0?100:0:(e-t)/t*100}function NXe({variation:e,inverted:t=!1}){const r=t?e<0:e>0;return Math.abs(e)<.5?n.jsxs(ke,{variant:"secondary",className:"gap-1 text-xs",children:[n.jsx(op,{className:"h-3 w-3"}),"0%"]}):n.jsxs(ke,{variant:"secondary",className:He("gap-1 text-xs",r?"bg-green-100 text-green-700 hover:bg-green-100":"bg-red-100 text-red-700 hover:bg-red-100"),children:[r?n.jsx(Une,{className:"h-3 w-3"}):n.jsx(zne,{className:"h-3 w-3"}),e>0?"+":"",e.toFixed(1),"%"]})}function SXe({label:e,currentValue:t,previousValue:r,variation:s,formatAsPrice:a=!1,formatAsPercent:i=!1,inverted:o=!1}){const l=d=>typeof d=="string"?d:a?jE(d):i?`${d.toFixed(1)}%`:d.toLocaleString("pt-BR");return n.jsxs("div",{className:"grid grid-cols-4 gap-2 py-2 border-b last:border-0 items-center",children:[n.jsx("div",{className:"text-sm text-muted-foreground font-medium",children:e}),n.jsx("div",{className:"text-right font-semibold",children:l(t)}),n.jsx("div",{className:"text-right text-muted-foreground",children:l(r)}),n.jsx("div",{className:"flex justify-end",children:n.jsx(NXe,{variation:s,inverted:o})})]})}function CXe({data:e}){const{current:t,previous:r,currentEvents:s,previousEvents:a,currentLabel:i,previousLabel:o}=e;if(!t||!r)return n.jsx($e,{children:n.jsx(Fe,{className:"py-8 text-center text-muted-foreground",children:"Selecione dois perodos com dados para visualizar a comparao."})});const l=[{label:"Total de Lives",current:s,previous:a,variation:Co(s,a)},{label:"Faturamento Pago",current:t.totalPago,previous:r.totalPago,variation:Co(t.totalPago,r.totalPago),formatAsPrice:!0},{label:"Total Reservado",current:t.totalReservado,previous:r.totalReservado,variation:Co(t.totalReservado,r.totalReservado),formatAsPrice:!0},{label:"Ticket Mdio",current:t.ticketMedioPago,previous:r.ticketMedioPago,variation:Co(t.ticketMedioPago,r.ticketMedioPago),formatAsPrice:!0},{label:"Total de Carrinhos",current:t.totalCarrinhos,previous:r.totalCarrinhos,variation:Co(t.totalCarrinhos,r.totalCarrinhos)},{label:"Carrinhos Pagos",current:t.carrinhosPagos,previous:r.carrinhosPagos,variation:Co(t.carrinhosPagos,r.carrinhosPagos)},{label:"Itens Vendidos",current:t.totalItensPagos,previous:r.totalItensPagos,variation:Co(t.totalItensPagos,r.totalItensPagos)},{label:"Taxa de Converso",current:t.taxaConversao,previous:r.taxaConversao,variation:Co(t.taxaConversao,r.taxaConversao),formatAsPercent:!0},{label:"Taxa de Pagamento",current:t.taxaPagamento,previous:r.taxaPagamento,variation:Co(t.taxaPagamento,r.taxaPagamento),formatAsPercent:!0},{label:"Horas de Live",current:(t.duracaoMinutos/60).toFixed(1)+"h",previous:(r.duracaoMinutos/60).toFixed(1)+"h",variation:Co(t.duracaoMinutos,r.duracaoMinutos)}],d=Co(t.totalPago,r.totalPago),c=Co(t.taxaConversao,r.taxaConversao);return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx($e,{className:He("border-2",d>0?"border-green-200 bg-green-50/50":d<0?"border-red-200 bg-red-50/50":"border-muted"),children:n.jsxs(Fe,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Crescimento Faturamento"}),n.jsxs("p",{className:He("text-2xl font-bold",d>0?"text-green-600":d<0?"text-red-600":""),children:[d>0?"+":"",d.toFixed(1),"%"]})]}),d>0?n.jsx(Vs,{className:"h-8 w-8 text-green-500"}):d<0?n.jsx(Sx,{className:"h-8 w-8 text-red-500"}):n.jsx(op,{className:"h-8 w-8 text-muted-foreground"})]}),n.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[jE(t.totalPago)," vs ",jE(r.totalPago)]})]})}),n.jsx($e,{className:He("border-2",c>0?"border-green-200 bg-green-50/50":c<0?"border-red-200 bg-red-50/50":"border-muted"),children:n.jsxs(Fe,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Evoluo da Converso"}),n.jsxs("p",{className:He("text-2xl font-bold",c>0?"text-green-600":c<0?"text-red-600":""),children:[c>0?"+":"",c.toFixed(1),"%"]})]}),c>0?n.jsx(Vs,{className:"h-8 w-8 text-green-500"}):c<0?n.jsx(Sx,{className:"h-8 w-8 text-red-500"}):n.jsx(op,{className:"h-8 w-8 text-muted-foreground"})]}),n.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[t.taxaConversao.toFixed(1),"% vs ",r.taxaConversao.toFixed(1),"%"]})]})}),n.jsx($e,{className:"border-2 border-primary/20 bg-primary/5",children:n.jsx(Fe,{className:"pt-4",children:n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Comparando"}),n.jsx("p",{className:"text-lg font-semibold",children:i}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:["vs ",o]})]})})})})]}),n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-base flex items-center gap-2",children:[n.jsx(Vs,{className:"h-4 w-4 text-primary"}),"Comparativo Detalhado"]})}),n.jsxs(Fe,{children:[n.jsxs("div",{className:"grid grid-cols-4 gap-2 py-2 border-b-2 text-sm font-medium text-muted-foreground",children:[n.jsx("div",{children:"Mtrica"}),n.jsx("div",{className:"text-right",children:i}),n.jsx("div",{className:"text-right",children:o}),n.jsx("div",{className:"text-right",children:"Variao"})]}),l.map((u,h)=>n.jsx(SXe,{label:u.label,currentValue:u.current,previousValue:u.previous,variation:u.variation,formatAsPrice:u.formatAsPrice,formatAsPercent:u.formatAsPercent},h))]})]})]})}const ih=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),SJ=e=>Wt(new Date(e),"dd/MM/yyyy HH:mm",{locale:mr}),EL=e=>`${e.toFixed(1)}%`;async function EXe(e,t){const r=await e.xlsx.writeBuffer(),s=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.download=t,i.click(),window.URL.revokeObjectURL(a)}function kXe(e){const{events:t,kpis:r,topProducts:s,startDate:a,endDate:i}=e,o=`${Wt(a,"dd-MM-yyyy")}_a_${Wt(i,"dd-MM-yyyy")}`;let l="";l+=`Relatrio de Lives - ${Wt(a,"dd/MM/yyyy")} a ${Wt(i,"dd/MM/yyyy")}

`,l+=`=== RESUMO DO PERODO ===
`,r&&(l+=`Total Reservado;${ih(r.totalReservado)}
`,l+=`Total Pago;${ih(r.totalPago)}
`,l+=`Itens Reservados;${r.totalItensReservados}
`,l+=`Itens Pagos;${r.totalItensPagos}
`,l+=`Ticket Mdio;${ih(r.ticketMedioPago)}
`,l+=`Total de Carrinhos;${r.totalCarrinhos}
`,l+=`Carrinhos Pagos;${r.carrinhosPagos}
`,l+=`Taxa de Converso;${EL(r.taxaConversao)}
`,l+=`Taxa de Pagamento;${EL(r.taxaPagamento)}
`,l+=`Durao Total;${(r.duracaoMinutos/60).toFixed(1)} horas
`,l+=`Vendas por Hora;${ih(r.vendasPorHora)}
`),l+=`
`,l+=`=== LIVES NO PERODO ===
`,l+=`Ttulo;Data/Hora Incio;Status;Total Reservado;Total Pago;Carrinhos;Carrinhos Pagos
`,t.forEach(h=>{l+=`${h.titulo};${SJ(h.data_hora_inicio)};${h.status};${ih(h.totalReservado)};${ih(h.totalPago)};${h.totalCarrinhos};${h.carrinhosPagos}
`}),l+=`
`,l+=`=== TOP PRODUTOS ===
`,l+=`Produto;Cor;Quantidade Vendida;Valor Total
`,s.forEach(h=>{l+=`${h.productName};${h.productColor||"-"};${h.quantidadeVendida};${ih(h.valorTotal)}
`});const d=new Blob(["\uFEFF"+l],{type:"text/csv;charset=utf-8;"}),c=window.URL.createObjectURL(d),u=document.createElement("a");u.href=c,u.download=`relatorio_lives_${o}.csv`,u.click(),window.URL.revokeObjectURL(c)}async function AXe(e){const{events:t,kpis:r,topProducts:s,startDate:a,endDate:i}=e,o=`${Wt(a,"dd-MM-yyyy")}_a_${Wt(i,"dd-MM-yyyy")}`,l=new ww.Workbook,d=l.addWorksheet("Resumo");d.columns=[{width:25},{width:20}],d.addRow(["RELATRIO DE LIVES POR PERODO"]),d.addRow([`Perodo: ${Wt(a,"dd/MM/yyyy")} a ${Wt(i,"dd/MM/yyyy")}`]),d.addRow([]),d.addRow(["INDICADOR","VALOR"]),r&&(d.addRow(["Total de Lives",t.length]),d.addRow(["Total Reservado",r.totalReservado]),d.addRow(["Total Pago",r.totalPago]),d.addRow(["Itens Reservados",r.totalItensReservados]),d.addRow(["Itens Pagos",r.totalItensPagos]),d.addRow(["Ticket Mdio Reservado",r.ticketMedioReservado]),d.addRow(["Ticket Mdio Pago",r.ticketMedioPago]),d.addRow(["Total de Carrinhos",r.totalCarrinhos]),d.addRow(["Carrinhos Abertos",r.carrinhosAbertos]),d.addRow(["Carrinhos Aguardando",r.carrinhosAguardando]),d.addRow(["Carrinhos Pagos",r.carrinhosPagos]),d.addRow(["Taxa de Converso (%)",r.taxaConversao]),d.addRow(["Taxa de Pagamento (%)",r.taxaPagamento]),d.addRow(["Durao Total (min)",r.duracaoMinutos]),d.addRow(["Vendas por Hora",r.vendasPorHora]));const c=l.addWorksheet("Lives");c.columns=[{width:30},{width:18},{width:12},{width:18},{width:15},{width:12},{width:15},{width:18}],c.addRow(["TTULO","DATA/HORA","STATUS","TOTAL RESERVADO","TOTAL PAGO","CARRINHOS","CARRINHOS PAGOS","TAXA CONVERSO (%)"]),t.forEach(h=>{const f=h.totalCarrinhos>0?h.carrinhosPagos/h.totalCarrinhos*100:0;c.addRow([h.titulo,SJ(h.data_hora_inicio),h.status,h.totalReservado,h.totalPago,h.totalCarrinhos,h.carrinhosPagos,Number(f.toFixed(1))])});const u=l.addWorksheet("Produtos");u.columns=[{width:40},{width:15},{width:20},{width:18}],u.addRow(["PRODUTO","COR","QUANTIDADE VENDIDA","VALOR TOTAL"]),s.forEach(h=>{u.addRow([h.productName,h.productColor||"-",h.quantidadeVendida,h.valorTotal])}),await EXe(l,`relatorio_lives_${o}.xlsx`)}function TXe(e,t,r){const s=t.getTime()-e.getTime();switch(r){case"previousPeriod":return{start:new Date(e.getTime()-s-864e5),end:new Date(e.getTime()-864e5)};case"previousMonth":return{start:so(e,1),end:so(t,1)};case"previousYear":return{start:BR(e,1),end:BR(t,1)};default:return{start:so(e,1),end:so(t,1)}}}function PXe(e){switch(e){case"previousPeriod":return"Perodo anterior";case"previousMonth":return"Ms anterior";case"previousYear":return"Ano anterior";default:return"Perodo anterior"}}function kL({totalEvents:e,kpis:t,formatPrice:r}){return n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx($e,{children:n.jsxs(Fe,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(Ss,{className:"h-4 w-4"}),"Total de Lives"]}),n.jsx("div",{className:"text-2xl font-bold",children:e})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(ks,{className:"h-4 w-4"}),"Mdia por Live"]}),n.jsx("div",{className:"text-2xl font-bold",children:r(t?t.totalPago/e:0)})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(Ri,{className:"h-4 w-4"}),"Carrinhos/Live"]}),n.jsx("div",{className:"text-2xl font-bold",children:t?(t.totalCarrinhos/e).toFixed(1):0})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(Vs,{className:"h-4 w-4"}),"Horas de Live"]}),n.jsxs("div",{className:"text-2xl font-bold",children:[t?(t.duracaoMinutos/60).toFixed(1):0,"h"]})]})})]})}function AL({events:e,statusLabels:t,formatPrice:r,navigate:s}){return n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Ss,{className:"h-5 w-5 text-primary"}),"Lives no Perodo"]})}),n.jsx(Fe,{className:"space-y-2 max-h-[400px] overflow-y-auto",children:e.map(a=>{const i=t[a.status]||t.encerrada;return n.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>s(`/dashboard/lives/${a.id}/relatorio`),children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium truncate",children:a.titulo}),n.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[n.jsx(ns,{className:"h-3 w-3"}),Wt(new Date(a.data_hora_inicio),"dd/MM/yyyy HH:mm",{locale:mr})]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("div",{className:"font-semibold text-green-600",children:r(a.totalPago)}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.carrinhosPagos,"/",a.totalCarrinhos," pagos"]})]}),n.jsx(ke,{className:i.color,children:i.label})]},a.id)})})]})}function OXe(){const e=pr(),[t,r]=P.useState("30d"),[s,a]=P.useState(()=>fn(new Date,30)),[i,o]=P.useState(()=>new Date),[l,d]=P.useState(!1),[c,u]=P.useState("previousPeriod"),[h,f]=P.useState("overview"),{events:m,kpis:p,topProducts:g,timelineData:x,isLoading:v,totalEvents:y}=SL(s,i),b=s&&i?TXe(s,i,c):{start:void 0,end:void 0},{kpis:j,totalEvents:T,isLoading:O}=SL(l?b.start:void 0,l?b.end:void 0),R=F=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(F),D=F=>{r(F);const S=new Date;switch(F){case"7d":a(fn(S,7)),o(S);break;case"30d":a(fn(S,30)),o(S);break;case"thisMonth":a(Cs(S)),o(lc(S));break;case"lastMonth":const E=so(S,1);a(Cs(E)),o(lc(E));break;case"thisYear":a(Fk(S)),o(xxe(S));break}},B={planejada:{label:"Planejada",color:"bg-blue-100 text-blue-700"},ao_vivo:{label:"Ao Vivo",color:"bg-red-100 text-red-700"},encerrada:{label:"Encerrada",color:"bg-muted text-muted-foreground"},arquivada:{label:"Arquivada",color:"bg-secondary text-secondary-foreground"}},q=s&&i?`${Wt(s,"dd/MM",{locale:mr})} - ${Wt(i,"dd/MM",{locale:mr})}`:"Perodo atual",Y=b.start&&b.end?`${Wt(b.start,"dd/MM",{locale:mr})} - ${Wt(b.end,"dd/MM",{locale:mr})}`:PXe(c),G=()=>{!s||!i||kXe({events:m,kpis:p,topProducts:g,startDate:s,endDate:i})},I=()=>{!s||!i||AXe({events:m,kpis:p,topProducts:g,startDate:s,endDate:i})};return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>e("/dashboard"),children:n.jsx(Ts,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(fc,{className:"h-5 w-5 text-primary"}),n.jsx("h1",{className:"text-lg font-semibold",children:"Relatrio de Lives por Perodo"})]}),n.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:s&&i&&n.jsxs(n.Fragment,{children:[n.jsx(ns,{className:"h-3.5 w-3.5"}),Wt(s,"dd/MM/yyyy",{locale:mr}),"  ",Wt(i,"dd/MM/yyyy",{locale:mr}),n.jsxs("span",{className:"text-primary font-medium",children:["(",y," lives)"]})]})})]})]}),y>0&&n.jsxs(H_,{children:[n.jsx(G_,{asChild:!0,children:n.jsxs(he,{variant:"outline",size:"sm",children:[n.jsx(vf,{className:"h-4 w-4 mr-2"}),"Exportar"]})}),n.jsxs(x1,{align:"end",children:[n.jsxs(pl,{onClick:I,children:[n.jsx(Gh,{className:"h-4 w-4 mr-2"}),"Excel (.xlsx)"]}),n.jsxs(pl,{onClick:G,children:[n.jsx(Kh,{className:"h-4 w-4 mr-2"}),"CSV (.csv)"]})]})]})]})}),n.jsxs("main",{className:"max-w-7xl mx-auto p-4 md:p-6 space-y-6",children:[n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-3",children:n.jsxs(Lt,{className:"flex items-center gap-2 text-base",children:[n.jsx(Ru,{className:"h-4 w-4"}),"Filtrar Perodo"]})}),n.jsx(Fe,{children:n.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[n.jsxs(Xt,{value:t,onValueChange:F=>D(F),children:[n.jsx(Ht,{className:"w-[180px]",children:n.jsx(Yt,{placeholder:"Selecione o perodo"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"7d",children:"ltimos 7 dias"}),n.jsx(qe,{value:"30d",children:"ltimos 30 dias"}),n.jsx(qe,{value:"thisMonth",children:"Este ms"}),n.jsx(qe,{value:"lastMonth",children:"Ms passado"}),n.jsx(qe,{value:"thisYear",children:"Este ano"}),n.jsx(qe,{value:"custom",children:"Personalizado"})]})]}),t==="custom"&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("w-[140px] justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),s?Wt(s,"dd/MM/yyyy"):"Incio"]})}),n.jsx(Ga,{className:"w-auto p-0",align:"start",children:n.jsx(_i,{mode:"single",selected:s,onSelect:a,initialFocus:!0,className:He("p-3 pointer-events-auto")})})]}),n.jsx("span",{className:"text-muted-foreground",children:"at"}),n.jsxs(ci,{children:[n.jsx(di,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:He("w-[140px] justify-start text-left font-normal",!i&&"text-muted-foreground"),children:[n.jsx(ns,{className:"mr-2 h-4 w-4"}),i?Wt(i,"dd/MM/yyyy"):"Fim"]})}),n.jsx(Ga,{className:"w-auto p-0",align:"start",children:n.jsx(_i,{mode:"single",selected:i,onSelect:o,initialFocus:!0,className:He("p-3 pointer-events-auto")})})]})]})]})})]}),n.jsx($e,{children:n.jsx(Fe,{className:"py-4",children:n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(ii,{id:"comparison-mode",checked:l,onCheckedChange:F=>{d(F),f(F?"comparison":"overview")}}),n.jsxs(Be,{htmlFor:"comparison-mode",className:"flex items-center gap-2 cursor-pointer",children:[n.jsx(IP,{className:"h-4 w-4 text-primary"}),"Comparar com outro perodo"]})]}),l&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Comparar com:"}),n.jsxs(Xt,{value:c,onValueChange:F=>u(F),children:[n.jsx(Ht,{className:"w-[180px]",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"previousPeriod",children:"Perodo anterior"}),n.jsx(qe,{value:"previousMonth",children:"Mesmo perodo ms anterior"}),n.jsx(qe,{value:"previousYear",children:"Mesmo perodo ano anterior"})]})]}),b.start&&b.end&&n.jsxs(ke,{variant:"secondary",className:"text-xs",children:[Wt(b.start,"dd/MM",{locale:mr})," - ",Wt(b.end,"dd/MM",{locale:mr})]})]})]})})}),v||l&&O?n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[...Array(6)].map((F,S)=>n.jsx(Wr,{className:"h-32"},S))}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(Wr,{className:"h-96"}),n.jsx(Wr,{className:"h-96"})]})]}):y===0?n.jsx($e,{className:"py-12",children:n.jsxs(Fe,{className:"text-center",children:[n.jsx(Ss,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Nenhuma live encontrada"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"No h lives registradas no perodo selecionado."}),n.jsx(he,{variant:"outline",onClick:()=>D("thisYear"),children:"Ver todo o ano"})]})}):l?n.jsxs(Hi,{value:h,onValueChange:F=>f(F),children:[n.jsxs(Si,{className:"mb-4",children:[n.jsx(br,{value:"overview",children:"Viso Geral"}),n.jsxs(br,{value:"comparison",children:[n.jsx(IP,{className:"h-4 w-4 mr-1"}),"Comparativo"]})]}),n.jsx(kr,{value:"comparison",children:n.jsx(CXe,{data:{current:p,previous:j,currentEvents:y,previousEvents:T,currentLabel:q,previousLabel:Y}})}),n.jsx(kr,{value:"overview",children:n.jsxs("div",{className:"space-y-6",children:[p&&n.jsx(CL,{kpis:p}),n.jsx(kL,{totalEvents:y,kpis:p,formatPrice:R}),n.jsx(_E,{data:x}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(QC,{products:g}),n.jsx(AL,{events:m,statusLabels:B,formatPrice:R,navigate:e})]})]})})]}):n.jsxs(n.Fragment,{children:[p&&n.jsx(CL,{kpis:p}),n.jsx(kL,{totalEvents:y,kpis:p,formatPrice:R}),n.jsx(_E,{data:x}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(QC,{products:g}),n.jsx(AL,{events:m,statusLabels:B,formatPrice:R,navigate:e})]}),p&&p.totalReservado>0&&n.jsxs("div",{className:"bg-gradient-to-r from-primary/10 via-primary/5 to-transparent rounded-xl p-6",children:[n.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Resumo do Perodo"}),n.jsxs("div",{className:"grid sm:grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Total de Lives:"}),n.jsx("div",{className:"font-bold text-lg",children:y})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Total Reservado:"}),n.jsx("div",{className:"font-bold text-lg",children:R(p.totalReservado)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Total Pago:"}),n.jsx("div",{className:"font-bold text-lg text-green-600",children:R(p.totalPago)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Itens Vendidos:"}),n.jsxs("div",{className:"font-bold text-lg",children:[p.totalItensPagos," unidades"]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Taxa de Pagamento:"}),n.jsxs("div",{className:"font-bold text-lg",children:[p.taxaPagamento.toFixed(1),"%"]})]})]})]})]})]})]})}function RXe(){const e=pr(),[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await le.auth.getSession();if(!a){e("/login");return}const{data:i}=await le.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(l=>["merchant","admin"].includes(l.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsx(OXe,{})}function MXe(e){const[t,r]=P.useState([]),[s,a]=P.useState([]),[i,o]=P.useState({totalBags:0,bagsSeparated:0,bagsPending:0,bagsAttention:0,bagsCancelled:0,itemsCancelled:0,separationPercentage:0}),[l,d]=P.useState(!0),[c,u]=P.useState(!1),h=P.useRef(!0),f=P.useRef([]),m=P.useCallback(async()=>{if(e){d(!0);try{const{data:I,error:F}=await le.from("live_carts").select(`
          *,
          live_customer:live_customers(id, instagram_handle, nome, whatsapp),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color, sku)
          ),
          gifts:order_gifts(
            id,
            gift_id,
            qty,
            status,
            separation_confirmed,
            applied_by_rule_id,
            applied_by_raffle_id,
            gift:gifts(id, name, image_url, sku)
          ),
          attention_logs:live_attention_log(
            id,
            attention_type,
            product_id,
            product_name,
            size,
            quantity,
            origin_bag_number,
            destination_bag_number,
            destination_instagram,
            payload,
            resolved_at,
            resolved_by,
            created_at
          )
        `).eq("live_event_id",e).order("bag_number",{ascending:!0,nullsFirst:!1});if(F)throw F;const S=(I||[]).filter(C=>!!C.bag_number).filter(C=>Array.isArray(C.items)&&C.items.length>0).filter(C=>C.status!=="cancelado"&&C.status!=="pago").filter(C=>(C.items||[]).filter(M=>["reservado","confirmado"].includes(M.status)).length===0).filter(C=>{const k=!!C.label_printed_at,M=C.separation_status==="separado",U=C.status==="etiqueta_gerada"||C.operational_status==="etiqueta_gerada";return!(k||M||U)}).map(C=>C.id);S.length>0&&await Promise.all(S.map(C=>le.from("live_carts").update({status:"cancelado",separation_status:"cancelado"}).eq("id",C).neq("status","pago")));const N=(I||[]).map(C=>{var pe,ce;const k=C.label_printed_at||null,M=!!k,U=C.separation_status,$=M||U==="separado"||C.status==="etiqueta_gerada"||C.operational_status==="etiqueta_gerada",X=(C.items||[]).filter(ne=>ne.status!=="removido"?!0:["separado","cancelado","retirado_confirmado"].includes(ne.separation_status)).map(ne=>{var Ge,Qe,Ie,Ae,st,nt;const me=ne.status==="cancelado"||ne.status==="removido",ge=ne.separation_status==="cancelado",_e=ne.separation_status==="separado"||ne.separation_status==="retirado_confirmado";let be=0;if(ne.separation_notes){const vt=ne.separation_notes.match(/removed_confirmed:(\d+)/);vt&&(be=parseInt(vt[1],10))}let ye=0;if(ne.separation_notes){const vt=ne.separation_notes.match(/pending_removal:(\d+)/);vt&&(ye=parseInt(vt[1],10))}let Oe=ne.separation_status||"em_separacao";me&&!ge&&Oe!=="retirado_confirmado"&&(Oe="cancelado"),ye>0&&Oe!=="retirado_confirmado"&&(Oe="cancelado");const Ne=ye>0?Math.max(0,ye-be):0,De=$&&me;return{id:ne.id,bagId:C.id,bagNumber:C.bag_number||0,productId:ne.product_id,productName:((Ge=ne.product)==null?void 0:Ge.name)||"Produto",productImage:((Qe=ne.product)==null?void 0:Qe.image_url)||null,color:((Ie=ne.variante)==null?void 0:Ie.cor)||((Ae=ne.product)==null?void 0:Ae.color)||null,size:((st=ne.variante)==null?void 0:st.tamanho)||null,quantity:ne.qtd,unitPrice:ne.preco_unitario,status:Oe,notes:ne.separation_notes||null,instagramHandle:((nt=C.live_customer)==null?void 0:nt.instagram_handle)||"@unknown",cartItemStatus:ne.status,removedConfirmedCount:be,pendingRemovalFromQuantityReduction:ye,wasSeparatedBeforeCancellation:_e&&me||ye>0||De}}),Z=(C.gifts||[]).filter(ne=>ne.status!=="removed").map(ne=>{var me,ge,_e;return{id:`gift-${ne.id}`,bagId:C.id,bagNumber:C.bag_number||0,productId:ne.gift_id,productName:` ${((me=ne.gift)==null?void 0:me.name)||"Brinde"}`,productImage:((ge=ne.gift)==null?void 0:ge.image_url)||null,color:null,size:null,quantity:ne.qty,unitPrice:0,status:ne.separation_confirmed?"separado":"em_separacao",notes:null,instagramHandle:((_e=C.live_customer)==null?void 0:_e.instagram_handle)||"@unknown",cartItemStatus:ne.status,removedConfirmedCount:0,isGift:!0,giftSource:ne.applied_by_raffle_id?"raffle":ne.applied_by_rule_id?"rule":null}}),re=[...X,...Z],W=re.some(ne=>ne.status==="cancelado"||ne.cartItemStatus==="cancelado"||ne.cartItemStatus==="removido"),J=re.some(ne=>ne.status==="em_separacao"&&!["cancelado","removido"].includes(ne.cartItemStatus));let V=0;re.forEach(ne=>{if(ne.pendingRemovalFromQuantityReduction&&ne.pendingRemovalFromQuantityReduction>0){const me=Math.max(0,ne.pendingRemovalFromQuantityReduction-ne.removedConfirmedCount);V+=me}else if(ne.status==="cancelado"||ne.cartItemStatus==="cancelado"||ne.cartItemStatus==="removido"){const me=ne.quantity-ne.removedConfirmedCount;me>0&&(V+=me)}});const H=k&&C.needs_label_reprint===!0,ee=[],ie=C.attention_logs||[];ie.forEach(ne=>{var me;if(!ne.resolved_at){const ge={itemId:((me=ne.payload)==null?void 0:me.item_id)||ne.id,productName:ne.product_name||"Produto",productImage:null,color:null,size:ne.size,quantity:ne.quantity||1,originBagId:C.id,originBagNumber:ne.origin_bag_number||C.bag_number||0,destinationBagId:ne.destination_bag_number?"pending":null,destinationBagNumber:ne.destination_bag_number,destinationInstagram:ne.destination_instagram,createdAt:ne.created_at,removedFromOriginConfirmed:!1,placedInDestinationConfirmed:!1};ee.push({type:ne.attention_type,reallocationInfo:ge,description:ne.attention_type==="cancellation"?"Pedido cancelado - retirar itens da sacola":ne.attention_type==="reallocation"?`Pea realocada para Sacola #${ne.destination_bag_number}`:"Pea cancelada - retirar da sacola",resolved:!1})}}),re.forEach(ne=>{var ye;const me=ne.wasSeparatedBeforeCancellation,ge=ne.status==="cancelado"||ne.cartItemStatus==="cancelado"||ne.cartItemStatus==="removido",_e=(ne.pendingRemovalFromQuantityReduction??0)>0;if(!ie.some(Oe=>{var Ne;return((Ne=Oe.payload)==null?void 0:Ne.item_id)===ne.id&&!Oe.resolved_at})&&(me||_e)&&(ge||_e)){const Oe=_e?ne.pendingRemovalFromQuantityReduction??0:ne.quantity,Ne=Math.max(0,Oe-ne.removedConfirmedCount);if(Ne>0){let De=null,Ge=null,Qe=null;if(ne.notes){const Ae=ne.notes.match(/reallocation:([^:]+):(\d+):([^|]+)/);Ae&&(De=Ae[1]==="null"?null:Ae[1],Ge=parseInt(Ae[2],10)||null,Qe=((ye=Ae[3])==null?void 0:ye.trim())||null)}const Ie={itemId:ne.id,productName:ne.productName,productImage:ne.productImage,color:ne.color,size:ne.size,quantity:Ne,originBagId:C.id,originBagNumber:C.bag_number||0,destinationBagId:De,destinationBagNumber:Ge,destinationInstagram:Qe,createdAt:C.updated_at||C.created_at,removedFromOriginConfirmed:!1,placedInDestinationConfirmed:!1};ee.push({type:De?"reallocation":_e?"quantity_reduction":"cancellation",reallocationInfo:Ie,description:De?`Pea realocada para Sacola #${Ge}`:"Pea cancelada - retirar da sacola",resolved:!1})}}});const oe=ee.some(ne=>!ne.resolved),se=oe;let ue="em_separacao";return oe||V>0?ue="atencao":C.separation_status==="cancelado"||C.status==="cancelado"?ue="cancelado":!J&&re.length>0?ue="separado":C.separation_status==="pendente"&&(ue="pendente"),{id:C.id,bagNumber:C.bag_number||0,instagramHandle:((pe=C.live_customer)==null?void 0:pe.instagram_handle)||"@unknown",customerName:((ce=C.live_customer)==null?void 0:ce.nome)||null,totalItems:re.reduce((ne,me)=>ne+me.quantity,0),totalValue:C.total||0,status:ue,items:re,hasCancelledItems:W,hasUnseparatedItems:J,cartStatus:C.status,createdAt:C.created_at,needsReprintLabel:H,pendingRemovalCount:V,labelPrintedAt:k,attentionRequirements:ee,hasUnresolvedAttention:oe,isBlocked:se}}).filter(C=>C.bagNumber>0);if(h.current){r(N);const C=p(N);a(C);const k=g(N);o(k)}}catch(I){console.error("Error fetching separation data:",I),h.current&&de.error("Erro ao carregar dados de separao")}finally{h.current&&d(!1)}}},[e]),p=I=>{const F=new Map;return I.forEach(S=>{S.items.forEach(E=>{const N=`${E.productId}_${E.color||""}_${E.size||""}`;F.has(N)||F.set(N,{productId:E.productId,productName:E.productName,productImage:E.productImage,color:E.color,size:E.size,sku:null,totalNeeded:0,totalSeparated:0,totalPending:0,totalCancelled:0,bags:[]});const C=F.get(N);C.bags.push({bagId:S.id,bagNumber:S.bagNumber,instagramHandle:S.instagramHandle,itemId:E.id,quantity:E.quantity,status:E.status}),E.status==="separado"||E.status==="retirado_confirmado"?C.totalSeparated+=E.quantity:E.status==="cancelado"?C.totalCancelled+=E.quantity:C.totalPending+=E.quantity,C.totalNeeded+=E.quantity})}),Array.from(F.values()).sort((S,E)=>{const N=S.productName.localeCompare(E.productName);return N!==0?N:(S.size||"").localeCompare(E.size||"")})},g=I=>{const F=I.length,S=I.filter($=>$.status==="separado").length,E=I.filter($=>$.status==="em_separacao"||$.status==="pendente").length,N=I.filter($=>$.status==="atencao").length,C=I.filter($=>$.status==="cancelado").length;let k=0;I.forEach($=>{$.items.forEach(X=>{X.status==="cancelado"&&(k+=X.quantity)})});const M=F-C,U=M>0?Math.round(S/M*100):0;return{totalBags:F,bagsSeparated:S,bagsPending:E,bagsAttention:N,bagsCancelled:C,itemsCancelled:k,separationPercentage:U}},x=async()=>{if(!e)return!1;u(!0);try{const{data:I,error:F}=await le.from("live_carts").select("id, bag_number").eq("live_event_id",e).neq("status","cancelado");if(F)throw F;if(!I||I.length===0)return de.warning("No h carrinhos nesta live para separar. Somente carrinhos cancelados no so includos."),u(!1),!1;const{data:S,error:E}=await le.from("live_carts").select("id, created_at, status").eq("live_event_id",e).is("bag_number",null).neq("status","cancelado").order("created_at",{ascending:!0});if(E)throw E;if(!S||S.length===0)return de.info("Todas as sacolas ativas j foram numeradas"),await m(),!0;const{data:N}=await le.from("live_carts").select("bag_number").eq("live_event_id",e).not("bag_number","is",null).order("bag_number",{ascending:!1}).limit(1).maybeSingle();let C=((N==null?void 0:N.bag_number)||0)+1;for(const k of S)await le.from("live_carts").update({bag_number:C,separation_status:"em_separacao"}).eq("id",k.id),await le.from("live_cart_items").update({separation_status:"em_separacao"}).eq("live_cart_id",k.id).is("separation_status",null),C++;return de.success(`${S.length} sacolas criadas!`),await m(),!0}catch(I){return console.error("Error generating bag numbers:",I),de.error("Erro ao gerar sacolas"),!1}finally{u(!1)}},v=async I=>{try{if(I.startsWith("gift-")){const E=I.replace("gift-",""),{error:N}=await le.from("order_gifts").update({separation_confirmed:!0}).eq("id",E);if(N)throw N}else{const{error:E}=await le.from("live_cart_items").update({separation_status:"separado"}).eq("id",I);if(E)throw E}const S=t.flatMap(E=>E.items).find(E=>E.id===I);return S&&await O(S.bagId),await m(),!0}catch(F){return console.error("Error marking item separated:",F),de.error("Erro ao marcar item como separado"),!1}},y=async(I,F)=>{try{const{error:S}=await le.from("live_cart_items").update({separation_status:"cancelado",separation_notes:F||"Retirar do pedido"}).eq("id",I);if(S)throw S;const E=t.flatMap(N=>N.items).find(N=>N.id===I);return E&&await le.from("live_carts").update({separation_status:"atencao"}).eq("id",E.bagId),de.warning("Item marcado para retirar"),await m(),!0}catch(S){return console.error("Error marking item cancelled:",S),de.error("Erro ao marcar item como cancelado"),!1}},b=async(I,F)=>{try{const S=t.flatMap(U=>U.items).find(U=>U.id===I);if(!S)return!1;const E=F!==void 0?F:S.quantity,N=S.pendingRemovalFromQuantityReduction&&S.pendingRemovalFromQuantityReduction>0?S.pendingRemovalFromQuantityReduction:S.quantity;let C=S.notes||"";C.includes("removed_confirmed:")?C=C.replace(/removed_confirmed:\d+/,`removed_confirmed:${E}`):C=C?`${C} | removed_confirmed:${E}`:`removed_confirmed:${E}`;const k=E>=N,{error:M}=await le.from("live_cart_items").update({separation_status:k?"retirado_confirmado":"cancelado",separation_notes:C}).eq("id",I);if(M)throw M;if(k&&e){const{error:U}=await le.from("live_attention_log").update({resolved_at:new Date().toISOString(),resolved_by:"manual_confirmation"}).eq("live_event_id",e).is("resolved_at",null).contains("payload",{item_id:I});U&&console.error("Error resolving attention log:",U)}return S&&await O(S.bagId),k&&de.success("Retirada confirmada"),await m(),!0}catch(S){return console.error("Error confirming item removed:",S),de.error("Erro ao confirmar retirada"),!1}},j=async I=>{try{const{error:F}=await le.from("live_cart_items").update({separation_status:"separado"}).eq("live_cart_id",I).in("separation_status",["em_separacao",null]);if(F)throw F;const{error:S}=await le.from("order_gifts").update({separation_confirmed:!0}).eq("live_cart_id",I).eq("separation_confirmed",!1);if(S)throw S;return await le.from("live_carts").update({separation_status:"separado"}).eq("id",I),de.success("Sacola marcada como separada"),await m(),!0}catch(F){return console.error("Error marking bag separated:",F),de.error("Erro ao marcar sacola como separada"),!1}},T=async(I,F,S)=>{try{const E=t.flatMap(M=>M.items).filter(M=>M.productId===I&&M.color===F&&M.size===S&&M.status==="em_separacao");if(E.length===0)return de.info("No h itens pendentes para este produto"),!0;const N=E.map(M=>M.id),{error:C}=await le.from("live_cart_items").update({separation_status:"separado"}).in("id",N);if(C)throw C;const k=[...new Set(E.map(M=>M.bagId))];for(const M of k)await O(M);return de.success(`${E.length} itens marcados como separados`),await m(),!0}catch(E){return console.error("Error marking all product items separated:",E),de.error("Erro ao marcar itens como separados"),!1}},O=async I=>{try{const{data:F}=await le.from("live_cart_items").select("separation_status, status").eq("live_cart_id",I).neq("status","expirado"),{data:S}=await le.from("order_gifts").select("separation_confirmed, status").eq("live_cart_id",I).neq("status","removed");if(!F)return;const E=F.filter(X=>["reservado","confirmado"].includes(X.status)),N=(S||[]).filter(X=>X.status!=="removed");if(F.length>0&&E.length===0&&N.length===0){await le.from("live_carts").update({status:"cancelado",separation_status:"cancelado"}).eq("id",I).neq("status","pago");return}const C=E.some(X=>X.separation_status==="em_separacao"||X.separation_status===null),k=N.some(X=>!X.separation_confirmed),M=C||k,U=F.some(X=>X.separation_status==="cancelado"||["cancelado","removido"].includes(X.status));let $="em_separacao";U?$="atencao":M||($="separado"),await le.from("live_carts").update({separation_status:$}).eq("id",I)}catch(F){console.error("Error updating bag status:",F)}},R=async I=>{try{const{error:F}=await le.from("live_carts").update({label_printed_at:new Date().toISOString(),needs_label_reprint:!1}).eq("id",I);if(F)throw F;return await m(),!0}catch(F){return console.error("Error marking label printed:",F),de.error("Erro ao registrar impresso de etiqueta"),!1}},D=async I=>{try{const{error:F}=await le.from("live_carts").update({label_printed_at:new Date().toISOString(),needs_label_reprint:!1}).in("id",I);if(F)throw F;return await m(),!0}catch(F){return console.error("Error marking labels printed:",F),de.error("Erro ao registrar impresses"),!1}},B=async I=>{if(e)try{const{data:F}=await le.from("live_carts").select("bag_number").eq("live_event_id",e).not("bag_number","is",null).order("bag_number",{ascending:!1}).limit(1).maybeSingle(),S=((F==null?void 0:F.bag_number)||0)+1;await le.from("live_carts").update({bag_number:S,separation_status:"em_separacao"}).eq("id",I).is("bag_number",null),await le.from("live_cart_items").update({separation_status:"em_separacao"}).eq("live_cart_id",I).is("separation_status",null)}catch(F){console.error("Error auto-generating bag number:",F)}};return P.useEffect(()=>(h.current=!0,m(),()=>{h.current=!1}),[m]),P.useEffect(()=>{if(!e)return;f.current.forEach(E=>{le.removeChannel(E)}),f.current=[];const I=async E=>{if(h.current){if((E==null?void 0:E.table)==="live_carts"&&(E!=null&&E.new)){const N=E.new;N.live_event_id===e&&N.bag_number===null&&N.status!=="cancelado"&&await B(N.id)}m()}},F=le.channel(`separation_carts_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_carts",filter:`live_event_id=eq.${e}`},I).subscribe(),S=le.channel(`separation_items_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_cart_items"},()=>{h.current&&m()}).subscribe();return f.current=[F,S],()=>{f.current.forEach(E=>{le.removeChannel(E)}),f.current=[]}},[e,m]),{bags:t,productGroups:s,kpis:i,isLoading:l,isGeneratingBags:c,fetchSeparationData:m,generateBagNumbers:x,markItemSeparated:v,markItemCancelled:y,confirmItemRemoved:b,markBagSeparated:j,markAllProductItemsSeparated:T,markLabelPrinted:R,markLabelsAsPrinted:D,filterBags:(I,F,S)=>{let E=[...t];if(S.trim()){const N=S.toLowerCase();E=E.filter(C=>{var k;return C.instagramHandle.toLowerCase().includes(N)||C.bagNumber.toString().includes(N)||((k=C.customerName)==null?void 0:k.toLowerCase().includes(N))||C.items.some(M=>M.productName.toLowerCase().includes(N))})}switch(I){case"pending":E=E.filter(N=>N.status==="em_separacao"||N.status==="pendente");break;case"separated":E=E.filter(N=>N.status==="separado");break;case"cancelled":E=E.filter(N=>N.status==="cancelado");break;case"attention":E=E.filter(N=>N.status==="atencao");break}switch(F){case"bag_number":E.sort((C,k)=>C.bagNumber-k.bagNumber);break;case"instagram":E.sort((C,k)=>C.instagramHandle.localeCompare(k.instagramHandle));break;case"status":const N={pendente:0,em_separacao:1,atencao:2,separado:3,cancelado:4};E.sort((C,k)=>N[C.status]-N[k.status]);break}return E},filterProductGroups:I=>{if(!I.trim())return s;const F=I.toLowerCase();return s.filter(S=>{var E,N,C;return S.productName.toLowerCase().includes(F)||((E=S.color)==null?void 0:E.toLowerCase().includes(F))||((N=S.size)==null?void 0:N.toLowerCase().includes(F))||((C=S.sku)==null?void 0:C.toLowerCase().includes(F))})},resolveReallocation:async(I,F,S)=>{try{if(!F)return de.error("Confirme que retirou a pea da sacola original"),!1;if(I.destinationBagId&&!S)return de.error("Confirme que colocou a pea na nova sacola"),!1;const E=t.flatMap(U=>U.items).find(U=>U.id===I.itemId);if(!E)return!1;let N=E.notes||"";const C=E.pendingRemovalFromQuantityReduction&&E.pendingRemovalFromQuantityReduction>0?E.pendingRemovalFromQuantityReduction:E.quantity;N.includes("removed_confirmed:")?N=N.replace(/removed_confirmed:\d+/,`removed_confirmed:${C}`):N=N?`${N} | removed_confirmed:${C}`:`removed_confirmed:${C}`,N.includes("reallocation_resolved")||(N=N?`${N} | reallocation_resolved:${new Date().toISOString()}`:`reallocation_resolved:${new Date().toISOString()}`);const{error:k}=await le.from("live_cart_items").update({separation_status:"retirado_confirmado",separation_notes:N}).eq("id",I.itemId);if(k)throw k;await O(I.originBagId);const M=t.find(U=>U.id===I.originBagId);return M!=null&&M.labelPrintedAt&&await le.from("live_carts").update({needs_label_reprint:!0}).eq("id",I.originBagId),de.success("Realocao confirmada"),await m(),!0}catch(E){return console.error("Error resolving reallocation:",E),de.error("Erro ao confirmar realocao"),!1}}}}function IXe({kpis:e}){return n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Vt,{className:"h-5 w-5 text-primary"}),n.jsx("span",{className:"text-sm text-muted-foreground",children:"Sacolas"})]}),n.jsx("p",{className:"text-2xl font-bold mt-1",children:e.totalBags})]})}),n.jsx($e,{className:"border-green-200 bg-green-50/50",children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(mn,{className:"h-5 w-5 text-green-600"}),n.jsx("span",{className:"text-sm text-green-700",children:"Separadas"})]}),n.jsx("p",{className:"text-2xl font-bold text-green-700 mt-1",children:e.bagsSeparated})]})}),n.jsx($e,{className:"border-blue-200 bg-blue-50/50",children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Qr,{className:"h-5 w-5 text-blue-600"}),n.jsx("span",{className:"text-sm text-blue-700",children:"Pendentes"})]}),n.jsx("p",{className:"text-2xl font-bold text-blue-700 mt-1",children:e.bagsPending})]})}),n.jsx($e,{className:"border-amber-200 bg-amber-50/50",children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Or,{className:"h-5 w-5 text-amber-600"}),n.jsx("span",{className:"text-sm text-amber-700",children:"Ateno"})]}),n.jsx("p",{className:"text-2xl font-bold text-amber-700 mt-1",children:e.bagsAttention})]})}),n.jsx($e,{className:"border-red-200 bg-red-50/50",children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Kn,{className:"h-5 w-5 text-red-600"}),n.jsx("span",{className:"text-sm text-red-700",children:"Cancelados"})]}),n.jsx("p",{className:"text-2xl font-bold text-red-700 mt-1",children:e.bagsCancelled})]})}),n.jsx($e,{className:"border-primary/20 bg-primary/5",children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Vs,{className:"h-5 w-5 text-primary"}),n.jsx("span",{className:"text-sm text-primary",children:"Progresso"})]}),n.jsxs("p",{className:"text-2xl font-bold text-primary mt-1",children:[e.separationPercentage,"%"]})]})})]})}var T1={},DXe=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},CJ={},bo={};let JA;const LXe=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];bo.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};bo.getSymbolTotalCodewords=function(t){return LXe[t]};bo.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};bo.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');JA=t};bo.isKanjiModeEnabled=function(){return typeof JA<"u"};bo.toSJIS=function(t){return JA(t)};var Vj={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+r)}}e.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},e.from=function(s,a){if(e.isValid(s))return s;try{return t(s)}catch{return a}}})(Vj);function EJ(){this.buffer=[],this.length=0}EJ.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var BXe=EJ;function P1(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}P1.prototype.set=function(e,t,r,s){const a=e*this.size+t;this.data[a]=r,s&&(this.reservedBit[a]=!0)};P1.prototype.get=function(e,t){return this.data[e*this.size+t]};P1.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r};P1.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var $Xe=P1,kJ={};(function(e){const t=bo.getSymbolSize;e.getRowColCoords=function(s){if(s===1)return[];const a=Math.floor(s/7)+2,i=t(s),o=i===145?26:Math.ceil((i-13)/(2*a-2))*2,l=[i-7];for(let d=1;d<a-1;d++)l[d]=l[d-1]-o;return l.push(6),l.reverse()},e.getPositions=function(s){const a=[],i=e.getRowColCoords(s),o=i.length;for(let l=0;l<o;l++)for(let d=0;d<o;d++)l===0&&d===0||l===0&&d===o-1||l===o-1&&d===0||a.push([i[l],i[d]]);return a}})(kJ);var AJ={};const FXe=bo.getSymbolSize,TL=7;AJ.getPositions=function(t){const r=FXe(t);return[[0,0],[r-TL,0],[0,r-TL]]};var TJ={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},e.from=function(a){return e.isValid(a)?parseInt(a,10):void 0},e.getPenaltyN1=function(a){const i=a.size;let o=0,l=0,d=0,c=null,u=null;for(let h=0;h<i;h++){l=d=0,c=u=null;for(let f=0;f<i;f++){let m=a.get(h,f);m===c?l++:(l>=5&&(o+=t.N1+(l-5)),c=m,l=1),m=a.get(f,h),m===u?d++:(d>=5&&(o+=t.N1+(d-5)),u=m,d=1)}l>=5&&(o+=t.N1+(l-5)),d>=5&&(o+=t.N1+(d-5))}return o},e.getPenaltyN2=function(a){const i=a.size;let o=0;for(let l=0;l<i-1;l++)for(let d=0;d<i-1;d++){const c=a.get(l,d)+a.get(l,d+1)+a.get(l+1,d)+a.get(l+1,d+1);(c===4||c===0)&&o++}return o*t.N2},e.getPenaltyN3=function(a){const i=a.size;let o=0,l=0,d=0;for(let c=0;c<i;c++){l=d=0;for(let u=0;u<i;u++)l=l<<1&2047|a.get(c,u),u>=10&&(l===1488||l===93)&&o++,d=d<<1&2047|a.get(u,c),u>=10&&(d===1488||d===93)&&o++}return o*t.N3},e.getPenaltyN4=function(a){let i=0;const o=a.data.length;for(let d=0;d<o;d++)i+=a.data[d];return Math.abs(Math.ceil(i*100/o/5)-10)*t.N4};function r(s,a,i){switch(s){case e.Patterns.PATTERN000:return(a+i)%2===0;case e.Patterns.PATTERN001:return a%2===0;case e.Patterns.PATTERN010:return i%3===0;case e.Patterns.PATTERN011:return(a+i)%3===0;case e.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(i/3))%2===0;case e.Patterns.PATTERN101:return a*i%2+a*i%3===0;case e.Patterns.PATTERN110:return(a*i%2+a*i%3)%2===0;case e.Patterns.PATTERN111:return(a*i%3+(a+i)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}e.applyMask=function(a,i){const o=i.size;for(let l=0;l<o;l++)for(let d=0;d<o;d++)i.isReserved(d,l)||i.xor(d,l,r(a,d,l))},e.getBestMask=function(a,i){const o=Object.keys(e.Patterns).length;let l=0,d=1/0;for(let c=0;c<o;c++){i(c),e.applyMask(c,a);const u=e.getPenaltyN1(a)+e.getPenaltyN2(a)+e.getPenaltyN3(a)+e.getPenaltyN4(a);e.applyMask(c,a),u<d&&(d=u,l=c)}return l}})(TJ);var qj={};const ru=Vj,Xy=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Yy=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];qj.getBlocksCount=function(t,r){switch(r){case ru.L:return Xy[(t-1)*4+0];case ru.M:return Xy[(t-1)*4+1];case ru.Q:return Xy[(t-1)*4+2];case ru.H:return Xy[(t-1)*4+3];default:return}};qj.getTotalCodewordsCount=function(t,r){switch(r){case ru.L:return Yy[(t-1)*4+0];case ru.M:return Yy[(t-1)*4+1];case ru.Q:return Yy[(t-1)*4+2];case ru.H:return Yy[(t-1)*4+3];default:return}};var PJ={},Wj={};const ax=new Uint8Array(512),O2=new Uint8Array(256);(function(){let t=1;for(let r=0;r<255;r++)ax[r]=t,O2[t]=r,t<<=1,t&256&&(t^=285);for(let r=255;r<512;r++)ax[r]=ax[r-255]})();Wj.log=function(t){if(t<1)throw new Error("log("+t+")");return O2[t]};Wj.exp=function(t){return ax[t]};Wj.mul=function(t,r){return t===0||r===0?0:ax[O2[t]+O2[r]]};(function(e){const t=Wj;e.mul=function(s,a){const i=new Uint8Array(s.length+a.length-1);for(let o=0;o<s.length;o++)for(let l=0;l<a.length;l++)i[o+l]^=t.mul(s[o],a[l]);return i},e.mod=function(s,a){let i=new Uint8Array(s);for(;i.length-a.length>=0;){const o=i[0];for(let d=0;d<a.length;d++)i[d]^=t.mul(a[d],o);let l=0;for(;l<i.length&&i[l]===0;)l++;i=i.slice(l)}return i},e.generateECPolynomial=function(s){let a=new Uint8Array([1]);for(let i=0;i<s;i++)a=e.mul(a,new Uint8Array([1,t.exp(i)]));return a}})(PJ);const OJ=PJ;function eT(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}eT.prototype.initialize=function(t){this.degree=t,this.genPoly=OJ.generateECPolynomial(this.degree)};eT.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(t.length+this.degree);r.set(t);const s=OJ.mod(r,this.genPoly),a=this.degree-s.length;if(a>0){const i=new Uint8Array(this.degree);return i.set(s,a),i}return s};var zXe=eT,RJ={},Gu={},tT={};tT.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var kc={};const MJ="[0-9]+",UXe="[A-Z $%*+\\-./:]+";let Bv="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Bv=Bv.replace(/u/g,"\\u");const VXe="(?:(?![A-Z0-9 $%*+\\-./:]|"+Bv+`)(?:.|[\r
]))+`;kc.KANJI=new RegExp(Bv,"g");kc.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");kc.BYTE=new RegExp(VXe,"g");kc.NUMERIC=new RegExp(MJ,"g");kc.ALPHANUMERIC=new RegExp(UXe,"g");const qXe=new RegExp("^"+Bv+"$"),WXe=new RegExp("^"+MJ+"$"),HXe=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");kc.testKanji=function(t){return qXe.test(t)};kc.testNumeric=function(t){return WXe.test(t)};kc.testAlphanumeric=function(t){return HXe.test(t)};(function(e){const t=tT,r=kc;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},e.getBestModeForData=function(i){return r.testNumeric(i)?e.NUMERIC:r.testAlphanumeric(i)?e.ALPHANUMERIC:r.testKanji(i)?e.KANJI:e.BYTE},e.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},e.isValid=function(i){return i&&i.bit&&i.ccBits};function s(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+a)}}e.from=function(i,o){if(e.isValid(i))return i;try{return s(i)}catch{return o}}})(Gu);(function(e){const t=bo,r=qj,s=Vj,a=Gu,i=tT,o=7973,l=t.getBCHDigit(o);function d(f,m,p){for(let g=1;g<=40;g++)if(m<=e.getCapacity(g,p,f))return g}function c(f,m){return a.getCharCountIndicator(f,m)+4}function u(f,m){let p=0;return f.forEach(function(g){const x=c(g.mode,m);p+=x+g.getBitsLength()}),p}function h(f,m){for(let p=1;p<=40;p++)if(u(f,p)<=e.getCapacity(p,m,a.MIXED))return p}e.from=function(m,p){return i.isValid(m)?parseInt(m,10):p},e.getCapacity=function(m,p,g){if(!i.isValid(m))throw new Error("Invalid QR Code version");typeof g>"u"&&(g=a.BYTE);const x=t.getSymbolTotalCodewords(m),v=r.getTotalCodewordsCount(m,p),y=(x-v)*8;if(g===a.MIXED)return y;const b=y-c(g,m);switch(g){case a.NUMERIC:return Math.floor(b/10*3);case a.ALPHANUMERIC:return Math.floor(b/11*2);case a.KANJI:return Math.floor(b/13);case a.BYTE:default:return Math.floor(b/8)}},e.getBestVersionForData=function(m,p){let g;const x=s.from(p,s.M);if(Array.isArray(m)){if(m.length>1)return h(m,x);if(m.length===0)return 1;g=m[0]}else g=m;return d(g.mode,g.getLength(),x)},e.getEncodedBits=function(m){if(!i.isValid(m)||m<7)throw new Error("Invalid QR Code version");let p=m<<12;for(;t.getBCHDigit(p)-l>=0;)p^=o<<t.getBCHDigit(p)-l;return m<<12|p}})(RJ);var IJ={};const NE=bo,DJ=1335,GXe=21522,PL=NE.getBCHDigit(DJ);IJ.getEncodedBits=function(t,r){const s=t.bit<<3|r;let a=s<<10;for(;NE.getBCHDigit(a)-PL>=0;)a^=DJ<<NE.getBCHDigit(a)-PL;return(s<<10|a)^GXe};var LJ={};const KXe=Gu;function Wp(e){this.mode=KXe.NUMERIC,this.data=e.toString()}Wp.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};Wp.prototype.getLength=function(){return this.data.length};Wp.prototype.getBitsLength=function(){return Wp.getBitsLength(this.data.length)};Wp.prototype.write=function(t){let r,s,a;for(r=0;r+3<=this.data.length;r+=3)s=this.data.substr(r,3),a=parseInt(s,10),t.put(a,10);const i=this.data.length-r;i>0&&(s=this.data.substr(r),a=parseInt(s,10),t.put(a,i*3+1))};var XXe=Wp;const YXe=Gu,j4=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Hp(e){this.mode=YXe.ALPHANUMERIC,this.data=e}Hp.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};Hp.prototype.getLength=function(){return this.data.length};Hp.prototype.getBitsLength=function(){return Hp.getBitsLength(this.data.length)};Hp.prototype.write=function(t){let r;for(r=0;r+2<=this.data.length;r+=2){let s=j4.indexOf(this.data[r])*45;s+=j4.indexOf(this.data[r+1]),t.put(s,11)}this.data.length%2&&t.put(j4.indexOf(this.data[r]),6)};var ZXe=Hp;const QXe=Gu;function Gp(e){this.mode=QXe.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}Gp.getBitsLength=function(t){return t*8};Gp.prototype.getLength=function(){return this.data.length};Gp.prototype.getBitsLength=function(){return Gp.getBitsLength(this.data.length)};Gp.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)};var JXe=Gp;const eYe=Gu,tYe=bo;function Kp(e){this.mode=eYe.KANJI,this.data=e}Kp.getBitsLength=function(t){return t*13};Kp.prototype.getLength=function(){return this.data.length};Kp.prototype.getBitsLength=function(){return Kp.getBitsLength(this.data.length)};Kp.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=tYe.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),e.put(r,13)}};var rYe=Kp,BJ={exports:{}};(function(e){var t={single_source_shortest_paths:function(r,s,a){var i={},o={};o[s]=0;var l=t.PriorityQueue.make();l.push(s,0);for(var d,c,u,h,f,m,p,g,x;!l.empty();){d=l.pop(),c=d.value,h=d.cost,f=r[c]||{};for(u in f)f.hasOwnProperty(u)&&(m=f[u],p=h+m,g=o[u],x=typeof o[u]>"u",(x||g>p)&&(o[u]=p,l.push(u,p),i[u]=c))}if(typeof a<"u"&&typeof o[a]>"u"){var v=["Could not find a path from ",s," to ",a,"."].join("");throw new Error(v)}return i},extract_shortest_path_from_predecessor_list:function(r,s){for(var a=[],i=s;i;)a.push(i),r[i],i=r[i];return a.reverse(),a},find_path:function(r,s,a){var i=t.single_source_shortest_paths(r,s,a);return t.extract_shortest_path_from_predecessor_list(i,a)},PriorityQueue:{make:function(r){var s=t.PriorityQueue,a={},i;r=r||{};for(i in s)s.hasOwnProperty(i)&&(a[i]=s[i]);return a.queue=[],a.sorter=r.sorter||s.default_sorter,a},default_sorter:function(r,s){return r.cost-s.cost},push:function(r,s){var a={value:r,cost:s};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(BJ);var nYe=BJ.exports;(function(e){const t=Gu,r=XXe,s=ZXe,a=JXe,i=rYe,o=kc,l=bo,d=nYe;function c(v){return unescape(encodeURIComponent(v)).length}function u(v,y,b){const j=[];let T;for(;(T=v.exec(b))!==null;)j.push({data:T[0],index:T.index,mode:y,length:T[0].length});return j}function h(v){const y=u(o.NUMERIC,t.NUMERIC,v),b=u(o.ALPHANUMERIC,t.ALPHANUMERIC,v);let j,T;return l.isKanjiModeEnabled()?(j=u(o.BYTE,t.BYTE,v),T=u(o.KANJI,t.KANJI,v)):(j=u(o.BYTE_KANJI,t.BYTE,v),T=[]),y.concat(b,j,T).sort(function(R,D){return R.index-D.index}).map(function(R){return{data:R.data,mode:R.mode,length:R.length}})}function f(v,y){switch(y){case t.NUMERIC:return r.getBitsLength(v);case t.ALPHANUMERIC:return s.getBitsLength(v);case t.KANJI:return i.getBitsLength(v);case t.BYTE:return a.getBitsLength(v)}}function m(v){return v.reduce(function(y,b){const j=y.length-1>=0?y[y.length-1]:null;return j&&j.mode===b.mode?(y[y.length-1].data+=b.data,y):(y.push(b),y)},[])}function p(v){const y=[];for(let b=0;b<v.length;b++){const j=v[b];switch(j.mode){case t.NUMERIC:y.push([j,{data:j.data,mode:t.ALPHANUMERIC,length:j.length},{data:j.data,mode:t.BYTE,length:j.length}]);break;case t.ALPHANUMERIC:y.push([j,{data:j.data,mode:t.BYTE,length:j.length}]);break;case t.KANJI:y.push([j,{data:j.data,mode:t.BYTE,length:c(j.data)}]);break;case t.BYTE:y.push([{data:j.data,mode:t.BYTE,length:c(j.data)}])}}return y}function g(v,y){const b={},j={start:{}};let T=["start"];for(let O=0;O<v.length;O++){const R=v[O],D=[];for(let B=0;B<R.length;B++){const q=R[B],Y=""+O+B;D.push(Y),b[Y]={node:q,lastCount:0},j[Y]={};for(let G=0;G<T.length;G++){const I=T[G];b[I]&&b[I].node.mode===q.mode?(j[I][Y]=f(b[I].lastCount+q.length,q.mode)-f(b[I].lastCount,q.mode),b[I].lastCount+=q.length):(b[I]&&(b[I].lastCount=q.length),j[I][Y]=f(q.length,q.mode)+4+t.getCharCountIndicator(q.mode,y))}}T=D}for(let O=0;O<T.length;O++)j[T[O]].end=0;return{map:j,table:b}}function x(v,y){let b;const j=t.getBestModeForData(v);if(b=t.from(y,j),b!==t.BYTE&&b.bit<j.bit)throw new Error('"'+v+'" cannot be encoded with mode '+t.toString(b)+`.
 Suggested mode is: `+t.toString(j));switch(b===t.KANJI&&!l.isKanjiModeEnabled()&&(b=t.BYTE),b){case t.NUMERIC:return new r(v);case t.ALPHANUMERIC:return new s(v);case t.KANJI:return new i(v);case t.BYTE:return new a(v)}}e.fromArray=function(y){return y.reduce(function(b,j){return typeof j=="string"?b.push(x(j,null)):j.data&&b.push(x(j.data,j.mode)),b},[])},e.fromString=function(y,b){const j=h(y,l.isKanjiModeEnabled()),T=p(j),O=g(T,b),R=d.find_path(O.map,"start","end"),D=[];for(let B=1;B<R.length-1;B++)D.push(O.table[R[B]].node);return e.fromArray(m(D))},e.rawSplit=function(y){return e.fromArray(h(y,l.isKanjiModeEnabled()))}})(LJ);const Hj=bo,N4=Vj,sYe=BXe,aYe=$Xe,iYe=kJ,oYe=AJ,SE=TJ,CE=qj,lYe=zXe,R2=RJ,cYe=IJ,dYe=Gu,S4=LJ;function uYe(e,t){const r=e.size,s=oYe.getPositions(t);for(let a=0;a<s.length;a++){const i=s[a][0],o=s[a][1];for(let l=-1;l<=7;l++)if(!(i+l<=-1||r<=i+l))for(let d=-1;d<=7;d++)o+d<=-1||r<=o+d||(l>=0&&l<=6&&(d===0||d===6)||d>=0&&d<=6&&(l===0||l===6)||l>=2&&l<=4&&d>=2&&d<=4?e.set(i+l,o+d,!0,!0):e.set(i+l,o+d,!1,!0))}}function hYe(e){const t=e.size;for(let r=8;r<t-8;r++){const s=r%2===0;e.set(r,6,s,!0),e.set(6,r,s,!0)}}function fYe(e,t){const r=iYe.getPositions(t);for(let s=0;s<r.length;s++){const a=r[s][0],i=r[s][1];for(let o=-2;o<=2;o++)for(let l=-2;l<=2;l++)o===-2||o===2||l===-2||l===2||o===0&&l===0?e.set(a+o,i+l,!0,!0):e.set(a+o,i+l,!1,!0)}}function mYe(e,t){const r=e.size,s=R2.getEncodedBits(t);let a,i,o;for(let l=0;l<18;l++)a=Math.floor(l/3),i=l%3+r-8-3,o=(s>>l&1)===1,e.set(a,i,o,!0),e.set(i,a,o,!0)}function C4(e,t,r){const s=e.size,a=cYe.getEncodedBits(t,r);let i,o;for(i=0;i<15;i++)o=(a>>i&1)===1,i<6?e.set(i,8,o,!0):i<8?e.set(i+1,8,o,!0):e.set(s-15+i,8,o,!0),i<8?e.set(8,s-i-1,o,!0):i<9?e.set(8,15-i-1+1,o,!0):e.set(8,15-i-1,o,!0);e.set(s-8,8,1,!0)}function pYe(e,t){const r=e.size;let s=-1,a=r-1,i=7,o=0;for(let l=r-1;l>0;l-=2)for(l===6&&l--;;){for(let d=0;d<2;d++)if(!e.isReserved(a,l-d)){let c=!1;o<t.length&&(c=(t[o]>>>i&1)===1),e.set(a,l-d,c),i--,i===-1&&(o++,i=7)}if(a+=s,a<0||r<=a){a-=s,s=-s;break}}}function gYe(e,t,r){const s=new sYe;r.forEach(function(d){s.put(d.mode.bit,4),s.put(d.getLength(),dYe.getCharCountIndicator(d.mode,e)),d.write(s)});const a=Hj.getSymbolTotalCodewords(e),i=CE.getTotalCodewordsCount(e,t),o=(a-i)*8;for(s.getLengthInBits()+4<=o&&s.put(0,4);s.getLengthInBits()%8!==0;)s.putBit(0);const l=(o-s.getLengthInBits())/8;for(let d=0;d<l;d++)s.put(d%2?17:236,8);return xYe(s,e,t)}function xYe(e,t,r){const s=Hj.getSymbolTotalCodewords(t),a=CE.getTotalCodewordsCount(t,r),i=s-a,o=CE.getBlocksCount(t,r),l=s%o,d=o-l,c=Math.floor(s/o),u=Math.floor(i/o),h=u+1,f=c-u,m=new lYe(f);let p=0;const g=new Array(o),x=new Array(o);let v=0;const y=new Uint8Array(e.buffer);for(let R=0;R<o;R++){const D=R<d?u:h;g[R]=y.slice(p,p+D),x[R]=m.encode(g[R]),p+=D,v=Math.max(v,D)}const b=new Uint8Array(s);let j=0,T,O;for(T=0;T<v;T++)for(O=0;O<o;O++)T<g[O].length&&(b[j++]=g[O][T]);for(T=0;T<f;T++)for(O=0;O<o;O++)b[j++]=x[O][T];return b}function vYe(e,t,r,s){let a;if(Array.isArray(e))a=S4.fromArray(e);else if(typeof e=="string"){let c=t;if(!c){const u=S4.rawSplit(e);c=R2.getBestVersionForData(u,r)}a=S4.fromString(e,c||40)}else throw new Error("Invalid data");const i=R2.getBestVersionForData(a,r);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=i;else if(t<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=gYe(t,r,a),l=Hj.getSymbolSize(t),d=new aYe(l);return uYe(d,t),hYe(d),fYe(d,t),C4(d,r,0),t>=7&&mYe(d,t),pYe(d,o),isNaN(s)&&(s=SE.getBestMask(d,C4.bind(null,d,r))),SE.applyMask(s,d),C4(d,r,s),{modules:d,version:t,errorCorrectionLevel:r,maskPattern:s,segments:a}}CJ.create=function(t,r){if(typeof t>"u"||t==="")throw new Error("No input text");let s=N4.M,a,i;return typeof r<"u"&&(s=N4.from(r.errorCorrectionLevel,N4.M),a=R2.from(r.version),i=SE.from(r.maskPattern),r.toSJISFunc&&Hj.setToSJISFunction(r.toSJISFunc)),vYe(t,a,s,i)};var $J={},rT={};(function(e){function t(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let s=r.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+r);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(i){return[i,i]}))),s.length===6&&s.push("F","F");const a=parseInt(s.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+s.slice(0,6).join("")}}e.getOptions=function(s){s||(s={}),s.color||(s.color={});const a=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,i=s.width&&s.width>=21?s.width:void 0,o=s.scale||4;return{width:i,scale:i?4:o,margin:a,color:{dark:t(s.color.dark||"#000000ff"),light:t(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},e.getScale=function(s,a){return a.width&&a.width>=s+a.margin*2?a.width/(s+a.margin*2):a.scale},e.getImageWidth=function(s,a){const i=e.getScale(s,a);return Math.floor((s+a.margin*2)*i)},e.qrToImageData=function(s,a,i){const o=a.modules.size,l=a.modules.data,d=e.getScale(o,i),c=Math.floor((o+i.margin*2)*d),u=i.margin*d,h=[i.color.light,i.color.dark];for(let f=0;f<c;f++)for(let m=0;m<c;m++){let p=(f*c+m)*4,g=i.color.light;if(f>=u&&m>=u&&f<c-u&&m<c-u){const x=Math.floor((f-u)/d),v=Math.floor((m-u)/d);g=h[l[x*o+v]?1:0]}s[p++]=g.r,s[p++]=g.g,s[p++]=g.b,s[p]=g.a}}})(rT);(function(e){const t=rT;function r(a,i,o){a.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(i,o,l){let d=l,c=o;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),o||(c=s()),d=t.getOptions(d);const u=t.getImageWidth(i.modules.size,d),h=c.getContext("2d"),f=h.createImageData(u,u);return t.qrToImageData(f.data,i,d),r(h,c,u),h.putImageData(f,0,0),c},e.renderToDataURL=function(i,o,l){let d=l;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),d||(d={});const c=e.render(i,o,d),u=d.type||"image/png",h=d.rendererOpts||{};return c.toDataURL(u,h.quality)}})($J);var FJ={};const yYe=rT;function OL(e,t){const r=e.a/255,s=t+'="'+e.hex+'"';return r<1?s+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':s}function E4(e,t,r){let s=e+t;return typeof r<"u"&&(s+=" "+r),s}function bYe(e,t,r){let s="",a=0,i=!1,o=0;for(let l=0;l<e.length;l++){const d=Math.floor(l%t),c=Math.floor(l/t);!d&&!i&&(i=!0),e[l]?(o++,l>0&&d>0&&e[l-1]||(s+=i?E4("M",d+r,.5+c+r):E4("m",a,0),a=0,i=!1),d+1<t&&e[l+1]||(s+=E4("h",o),o=0)):a++}return s}FJ.render=function(t,r,s){const a=yYe.getOptions(r),i=t.modules.size,o=t.modules.data,l=i+a.margin*2,d=a.color.light.a?"<path "+OL(a.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",c="<path "+OL(a.color.dark,"stroke")+' d="'+bYe(o,i,a.margin)+'"/>',u='viewBox="0 0 '+l+" "+l+'"',f='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+u+' shape-rendering="crispEdges">'+d+c+`</svg>
`;return typeof s=="function"&&s(null,f),f};const wYe=DXe,EE=CJ,zJ=$J,_Ye=FJ;function nT(e,t,r,s,a){const i=[].slice.call(arguments,1),o=i.length,l=typeof i[o-1]=="function";if(!l&&!wYe())throw new Error("Callback required as last argument");if(l){if(o<2)throw new Error("Too few arguments provided");o===2?(a=r,r=t,t=s=void 0):o===3&&(t.getContext&&typeof a>"u"?(a=s,s=void 0):(a=s,s=r,r=t,t=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(r=t,t=s=void 0):o===2&&!t.getContext&&(s=r,r=t,t=void 0),new Promise(function(d,c){try{const u=EE.create(r,s);d(e(u,t,s))}catch(u){c(u)}})}try{const d=EE.create(r,s);a(null,e(d,t,s))}catch(d){a(d)}}T1.create=EE.create;T1.toCanvas=nT.bind(null,zJ.render);T1.toDataURL=nT.bind(null,zJ.renderToDataURL);T1.toString=nT.bind(null,function(e,t,r){return _Ye.render(e,r)});const jYe=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),UJ=async e=>{try{return await T1.toDataURL(e,{width:150,margin:1,color:{dark:"#000000",light:"#ffffff"}})}catch(t){return console.error("Error generating QR code:",t),""}},VJ=()=>`
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    max-width: 300px;
    margin: 0 auto;
  }
  .label {
    border: 2px solid #000;
    border-radius: 8px;
    padding: 16px;
    text-align: center;
    page-break-inside: avoid;
    margin-bottom: 20px;
  }
  .event-title {
    font-size: 10px;
    color: #666;
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  .bag-number {
    font-size: 48px;
    font-weight: bold;
    margin-bottom: 4px;
  }
  .instagram {
    font-size: 18px;
    font-weight: 600;
    color: #e1306c;
    margin-bottom: 8px;
  }
  .customer-name {
    font-size: 12px;
    color: #666;
    margin-bottom: 8px;
  }
  .qr-container {
    display: flex;
    justify-content: center;
    margin: 12px 0;
  }
  .qr-container img {
    width: 120px;
    height: 120px;
  }
  .details {
    display: flex;
    justify-content: space-between;
    padding-top: 12px;
    border-top: 1px dashed #ccc;
    margin-top: 8px;
  }
  .detail-item {
    text-align: center;
  }
  .detail-label {
    font-size: 10px;
    color: #666;
    text-transform: uppercase;
  }
  .detail-value {
    font-size: 16px;
    font-weight: bold;
  }
  .items-list {
    text-align: left;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px dashed #ccc;
    font-size: 11px;
  }
  .items-list-title {
    font-weight: bold;
    margin-bottom: 6px;
    font-size: 10px;
    text-transform: uppercase;
    color: #666;
  }
  .item-row {
    display: flex;
    justify-content: space-between;
    padding: 2px 0;
  }
  .item-name {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 180px;
  }
  .item-size {
    font-weight: 600;
    margin-left: 8px;
  }
  .separator {
    border: none;
    border-top: 2px dashed #999;
    margin: 30px 0;
    position: relative;
    page-break-before: always;
  }
  .separator-text {
    text-align: center;
    font-size: 10px;
    color: #666;
    margin-bottom: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
  }
  @media print {
    body {
      padding: 0;
    }
    .label {
      page-break-after: always;
    }
    .label:last-child {
      page-break-after: avoid;
    }
  }
`,qJ=(e,t,r)=>`
    <div class="label">
      <div class="event-title">${t}</div>
      <div class="bag-number">#${e.bagNumber.toString().padStart(3,"0")}</div>
      <div class="instagram">${e.instagramHandle}</div>
      ${e.customerName?`<div class="customer-name">${e.customerName}</div>`:""}
      
      <div class="qr-container">
        <img src="${r}" alt="QR Code" />
      </div>
      
      <div class="details">
        <div class="detail-item">
          <div class="detail-label">Itens</div>
          <div class="detail-value">${e.totalItems}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">Total</div>
          <div class="detail-value">${jYe(e.totalValue)}</div>
        </div>
      </div>
      
      ${e.items.length>0?`
        <div class="items-list">
          <div class="items-list-title">Itens da Sacola</div>
          ${e.items.map(s=>`
            <div class="item-row">
              <span class="item-name">${s.quantity}x ${s.productName}${s.color?` - ${s.color}`:""}</span>
              <span class="item-size">${s.size||""}</span>
            </div>
          `).join("")}
        </div>
      `:""}
    </div>
  `;function NYe({bag:e,eventTitle:t,onPrint:r,onLabelPrinted:s}){const a=async()=>{const d=`${window.location.origin}/sacola/${e.id}`,c=await UJ(d);if(!c){de.error("Erro ao gerar QR code");return}const u=window.open("","_blank","width=400,height=700");if(!u){de.error("No foi possvel abrir janela de impresso");return}u.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Etiqueta Sacola #${e.bagNumber.toString().padStart(3,"0")}</title>
          <style>${VJ()}</style>
        </head>
        <body>
          ${qJ(e,t,c)}
          <script>
            // Wait for image to load before printing
            const img = document.querySelector('.qr-container img');
            if (img.complete) {
              setTimeout(() => { window.print(); window.close(); }, 300);
            } else {
              img.onload = () => { setTimeout(() => { window.print(); window.close(); }, 300); };
            }
          <\/script>
        </body>
      </html>
    `),u.document.close(),s&&await s(e.id),r==null||r()},i=!!e.labelPrintedAt,o=e.needsReprintLabel,l=e.labelPrintedAt?Wt(new Date(e.labelPrintedAt),"HH:mm"):null;return n.jsx(dp,{children:n.jsxs("div",{className:"flex items-center gap-2",onClick:d=>d.stopPropagation(),children:[o&&n.jsx(ke,{className:"text-xs bg-orange-500 hover:bg-orange-600 text-white border-transparent",children:"Alterada"}),i&&n.jsxs("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:["Impressa ",l,o?"  Alterada":""]}),o?n.jsxs($a,{children:[n.jsx(Fa,{asChild:!0,children:n.jsxs(he,{variant:"default",size:"sm",className:"h-8 gap-1",onClick:a,children:[n.jsx(ua,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Gerar etiqueta"})]})}),n.jsx(Sa,{children:n.jsx("p",{children:"Houve alterao aps impresso. Gere a etiqueta novamente."})})]}):i?n.jsxs(he,{variant:"outline",size:"sm",className:"h-8 gap-1",onClick:a,children:[n.jsx(Gv,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Imprimir novamente"})]}):n.jsxs(he,{variant:"default",size:"sm",className:"h-8 gap-1",onClick:a,children:[n.jsx(ua,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Gerar etiqueta"})]})]})})}function SYe({bags:e,eventTitle:t,onLabelsAsPrinted:r}){const s=async()=>{if(e.length===0)return;const o=window.location.origin,l=await Promise.all(e.map(async u=>{const h=`${o}/sacola/${u.id}`,f=await UJ(h);return{bag:u,qrDataUrl:f}})),d=window.open("","_blank","width=400,height=800");if(!d){de.error("No foi possvel abrir janela de impresso");return}const c=l.map(({bag:u,qrDataUrl:h},f)=>{const m=qJ(u,t,h);return f>0?`
            <div class="separator-text"> CORTE AQUI </div>
            <hr class="separator" />
            ${m}
          `:m}).join("");if(d.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Etiquetas - ${t}</title>
          <style>${VJ()}</style>
        </head>
        <body>
          ${c}
          <script>
            // Wait for all images to load before printing
            const images = document.querySelectorAll('.qr-container img');
            let loaded = 0;
            const total = images.length;
            
            function checkPrint() {
              loaded++;
              if (loaded >= total) {
                setTimeout(() => { window.print(); window.close(); }, 500);
              }
            }
            
            images.forEach(img => {
              if (img.complete) {
                checkPrint();
              } else {
                img.onload = checkPrint;
                img.onerror = checkPrint;
              }
            });
            
            // Fallback timeout
            setTimeout(() => { window.print(); window.close(); }, 3000);
          <\/script>
        </body>
      </html>
    `),d.document.close(),r){const u=e.map(h=>h.id);await r(u)}},a=e.filter(o=>o.needsReprintLabel).length,i=e.filter(o=>!o.labelPrintedAt).length;return n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2",onClick:s,disabled:e.length===0,children:[n.jsx(Gv,{className:"h-4 w-4"}),"Imprimir Todas (",e.length,")",a>0&&n.jsxs(ke,{variant:"destructive",className:"ml-1 text-xs",children:[a," alterada",a>1?"s":""]}),i>0&&a===0&&n.jsxs(ke,{variant:"secondary",className:"ml-1 text-xs",children:[i," nova",i>1?"s":""]})]})}function CYe({open:e,onOpenChange:t,reallocation:r,onConfirm:s,isProcessing:a=!1}){var h,f;const[i,o]=P.useState((r==null?void 0:r.removedFromOriginConfirmed)||!1),[l,d]=P.useState((r==null?void 0:r.placedInDestinationConfirmed)||!1);if(!r)return null;const c=i&&(!r.destinationBagId||l),u=async()=>{await s(i,l),t(!1)};return n.jsx(_c,{open:e,onOpenChange:t,children:n.jsxs(Tl,{className:"max-w-md",children:[n.jsxs(Pl,{children:[n.jsxs(Ol,{className:"flex items-center gap-2 text-amber-700",children:[n.jsx(Or,{className:"h-5 w-5"}),"Confirmao de Realocao Obrigatria"]}),n.jsx(Rl,{className:"text-left",children:"Uma pea foi movida entre sacolas. Confirme manualmente cada etapa fsica."})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50 border",children:[n.jsx("div",{className:"h-12 w-12 rounded overflow-hidden bg-muted flex-shrink-0",children:r.productImage?n.jsx("img",{src:r.productImage,alt:r.productName,className:"h-full w-full object-cover"}):n.jsx("div",{className:"h-full w-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-5 w-5 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-sm truncate",children:r.productName}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[r.color&&n.jsx("span",{children:r.color}),r.size&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsx("span",{className:"font-medium",children:r.size})]}),n.jsx("span",{children:""}),n.jsxs("span",{children:["Qtd: ",r.quantity]})]})]})]}),n.jsxs("div",{className:"flex items-center justify-center gap-3 py-4",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 border-2 border-red-300 flex items-center justify-center mx-auto mb-1",children:n.jsx(hn,{className:"h-5 w-5 text-red-600"})}),n.jsxs(ke,{variant:"outline",className:"text-xs",children:["Sacola #",r.originBagNumber.toString().padStart(3,"0")]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Origem"})]}),n.jsx(hs,{className:"h-6 w-6 text-muted-foreground flex-shrink-0"}),n.jsx("div",{className:"text-center",children:r.destinationBagId?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 border-2 border-green-300 flex items-center justify-center mx-auto mb-1",children:n.jsx(hn,{className:"h-5 w-5 text-green-600"})}),n.jsxs(ke,{variant:"outline",className:"text-xs",children:["Sacola #",(h=r.destinationBagNumber)==null?void 0:h.toString().padStart(3,"0")]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r.destinationInstagram})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-100 border-2 border-gray-300 flex items-center justify-center mx-auto mb-1",children:n.jsx(Vt,{className:"h-5 w-5 text-gray-400"})}),n.jsx(ke,{variant:"secondary",className:"text-xs",children:"Cancelado"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Devolver ao estoque"})]})})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${i?"bg-green-50 border-green-300":"bg-red-50 border-red-300 hover:bg-red-100"}`,children:[n.jsx(Va,{checked:i,onCheckedChange:m=>o(m===!0),disabled:a,className:"mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("p",{className:"font-medium text-sm",children:[i&&n.jsx(mn,{className:"h-4 w-4 inline mr-1 text-green-600"}),"Confirmo que retirei a pea da Sacola #",r.originBagNumber.toString().padStart(3,"0")]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"A pea foi fisicamente removida da sacola original"})]})]}),r.destinationBagId&&n.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${l?"bg-green-50 border-green-300":"bg-amber-50 border-amber-300 hover:bg-amber-100"} ${i?"":"opacity-50 pointer-events-none"}`,children:[n.jsx(Va,{checked:l,onCheckedChange:m=>d(m===!0),disabled:a||!i,className:"mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("p",{className:"font-medium text-sm",children:[l&&n.jsx(mn,{className:"h-4 w-4 inline mr-1 text-green-600"}),"Confirmo que coloquei a pea na Sacola #",(f=r.destinationBagNumber)==null?void 0:f.toString().padStart(3,"0")]}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:["A pea foi fisicamente colocada na nova sacola (",r.destinationInstagram,")"]})]})]})]}),n.jsxs("div",{className:"flex gap-2 mt-4",children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),disabled:a,className:"flex-1",children:"Voltar"}),n.jsx(he,{onClick:u,disabled:!c||a,className:"flex-1 gap-2",children:a?n.jsx(n.Fragment,{children:"Salvando..."}):n.jsxs(n.Fragment,{children:[n.jsx(mn,{className:"h-4 w-4"}),"Confirmar Realocao"]})})]})]})})}function EYe({bag:e,attentionRequirements:t,onResolveReallocation:r}){const[s,a]=P.useState(null),[i,o]=P.useState(!1),l=t.filter(u=>!u.resolved);if(!(l.length>0))return null;const c=async(u,h)=>{if(s){o(!0);try{await r(s,u,h)}finally{o(!1),a(null)}}};return n.jsxs(n.Fragment,{children:[n.jsx($e,{className:"border-amber-400 bg-amber-50",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"h-10 w-10 rounded-full bg-amber-100 border-2 border-amber-400 flex items-center justify-center flex-shrink-0",children:n.jsx(Or,{className:"h-5 w-5 text-amber-600"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-amber-800",children:" Ateno Obrigatria"}),n.jsxs(ke,{className:"bg-amber-200 text-amber-800 border-amber-300",children:[l.length," pendncia(s)"]})]}),n.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"Esta sacola requer confirmao manual antes de continuar. Aes bloqueadas at resoluo."}),n.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[n.jsxs(ke,{variant:"outline",className:"text-amber-700 border-amber-300 bg-amber-100/50",children:[n.jsx(Nl,{className:"h-3 w-3 mr-1"}),"Impresso bloqueada"]}),n.jsxs(ke,{variant:"outline",className:"text-amber-700 border-amber-300 bg-amber-100/50",children:[n.jsx(Nl,{className:"h-3 w-3 mr-1"}),"Finalizao bloqueada"]})]}),n.jsx("div",{className:"space-y-2",children:l.map((u,h)=>{var f;return n.jsxs("div",{className:"p-3 rounded-lg bg-white border border-amber-200",children:[u.type==="reallocation"&&u.reallocationInfo&&n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[n.jsx("div",{className:"h-10 w-10 rounded overflow-hidden bg-muted flex-shrink-0",children:u.reallocationInfo.productImage?n.jsx("img",{src:u.reallocationInfo.productImage,alt:u.reallocationInfo.productName,className:"h-full w-full object-cover"}):n.jsx("div",{className:"h-full w-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:u.reallocationInfo.productName}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(hn,{className:"h-3 w-3"}),"#",u.reallocationInfo.originBagNumber.toString().padStart(3,"0")]}),n.jsx(hs,{className:"h-3 w-3"}),u.reallocationInfo.destinationBagId?n.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[n.jsx(hn,{className:"h-3 w-3"}),"#",(f=u.reallocationInfo.destinationBagNumber)==null?void 0:f.toString().padStart(3,"0")]}):n.jsx("span",{className:"text-gray-500",children:"Cancelado"})]})]})]}),n.jsxs(he,{size:"sm",variant:"outline",className:"border-amber-400 text-amber-700 hover:bg-amber-100",onClick:()=>a(u.reallocationInfo),children:[n.jsx(mn,{className:"h-4 w-4 mr-1"}),"Confirmar"]})]}),u.type!=="reallocation"&&n.jsx("p",{className:"text-sm",children:u.description})]},h)})})]})]})})}),n.jsx(CYe,{open:!!s,onOpenChange:u=>!u&&a(null),reallocation:s,onConfirm:c,isProcessing:i})]})}function kYe({bags:e,eventTitle:t,onMarkItemSeparated:r,onMarkItemCancelled:s,onConfirmItemRemoved:a,onMarkBagSeparated:i,onLabelPrinted:o,onResolveReallocation:l}){const[d,c]=P.useState(new Set),[u,h]=P.useState({}),[f,m]=P.useState({});P.useEffect(()=>{const O={},R={};e.forEach(D=>{D.items.forEach(B=>{B.status==="separado"||B.status==="retirado_confirmado"?O[B.id]=B.quantity:B.status==="em_separacao"&&(O[B.id]=u[B.id]??0);const q=(B.pendingRemovalFromQuantityReduction??0)>0,Y=B.status==="cancelado"||B.cartItemStatus==="cancelado"||B.cartItemStatus==="removido";if((q||Y)&&(R[B.id]=B.removedConfirmedCount||f[B.id]||0),B.status==="retirado_confirmado"){const G=q?B.pendingRemovalFromQuantityReduction??0:B.quantity;R[B.id]=G}})}),h(D=>({...D,...O})),m(D=>({...D,...R}))},[e]);const[p,g]=P.useState(new Set),x=O=>{c(R=>{const D=new Set(R);return D.has(O)?D.delete(O):D.add(O),D})},v=async(O,R,D)=>{const B=u[O]||0;if(R<B)h(Y=>({...Y,[O]:Math.max(0,B-1)}));else{const Y=B+1;h(G=>({...G,[O]:Y})),Y>=D.quantity&&(g(G=>new Set(G).add(O)),await r(O),g(G=>{const I=new Set(G);return I.delete(O),I}))}},y=async(O,R,D)=>{const B=f[O]||0;if(R<B){const Y=Math.max(0,B-1);m(G=>({...G,[O]:Y})),g(G=>new Set(G).add(O)),await a(O,Y),g(G=>{const I=new Set(G);return I.delete(O),I})}else{const Y=B+1;m(G=>({...G,[O]:Y})),g(G=>new Set(G).add(O)),await a(O,Y),g(G=>{const I=new Set(G);return I.delete(O),I})}},b=O=>{switch(O){case"separado":return n.jsxs(ke,{className:"bg-green-100 text-green-700 border-green-200",children:[n.jsx(mn,{className:"h-3 w-3 mr-1"})," Separada"]});case"em_separacao":case"pendente":return n.jsxs(ke,{variant:"secondary",className:"bg-blue-100 text-blue-700 border-blue-200",children:[n.jsx(Qr,{className:"h-3 w-3 mr-1"})," Em separao"]});case"atencao":return n.jsxs(ke,{className:"bg-amber-100 text-amber-700 border-amber-200",children:[n.jsx(Or,{className:"h-3 w-3 mr-1"})," Ateno"]});case"cancelado":return n.jsxs(ke,{variant:"destructive",children:[n.jsx(Kn,{className:"h-3 w-3 mr-1"})," Cancelada"]});default:return n.jsx(ke,{variant:"outline",children:O})}},j=O=>{switch(O){case"separado":return n.jsx(ke,{className:"bg-green-100 text-green-700 border-green-200 text-xs",children:n.jsx(mn,{className:"h-3 w-3"})});case"em_separacao":return n.jsx(ke,{variant:"secondary",className:"bg-gray-100 text-gray-600 border-gray-200 text-xs",children:n.jsx(Qr,{className:"h-3 w-3"})});case"cancelado":return n.jsx(ke,{variant:"destructive",className:"text-xs",children:n.jsx(Kn,{className:"h-3 w-3"})});case"retirado_confirmado":return n.jsx(ke,{className:"bg-gray-200 text-gray-600 text-xs",children:"Retirado "});default:return null}},T=O=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(O);return e.length===0?n.jsx($e,{className:"border-dashed",children:n.jsxs(Fe,{className:"flex flex-col items-center justify-center py-12",children:[n.jsx(Vt,{className:"h-12 w-12 text-muted-foreground mb-3"}),n.jsx("p",{className:"text-muted-foreground",children:"Nenhuma sacola encontrada"})]})}):n.jsx("div",{className:"space-y-3",children:e.map(O=>n.jsx(pg,{open:d.has(O.id),onOpenChange:()=>x(O.id),children:n.jsxs($e,{className:`transition-all ${O.status==="atencao"?"border-amber-300 bg-amber-50/30":O.status==="separado"?"border-green-300 bg-green-50/30":O.status==="cancelado"?"border-red-300 bg-red-50/30 opacity-60":""}`,children:[n.jsx(gg,{className:"w-full",children:n.jsx(Dt,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[d.has(O.id)?n.jsx(zo,{className:"h-5 w-5 text-muted-foreground"}):n.jsx(In,{className:"h-5 w-5 text-muted-foreground"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"font-bold text-lg",children:["Sacola #",O.bagNumber.toString().padStart(3,"0")]}),n.jsx("span",{className:"text-muted-foreground",children:""}),n.jsx("span",{className:"font-medium text-primary",children:O.instagramHandle}),O.customerName&&n.jsxs("span",{className:"text-sm text-muted-foreground hidden sm:inline",children:["(",O.customerName,")"]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[O.isBlocked?n.jsx(ke,{variant:"outline",className:"text-amber-600 border-amber-300 bg-amber-50",children:" Bloqueado"}):n.jsx(NYe,{bag:O,eventTitle:t,onLabelPrinted:o}),n.jsxs("div",{className:"text-right hidden sm:block",children:[n.jsxs("p",{className:"text-sm text-muted-foreground",children:[O.totalItems," ",O.totalItems===1?"item":"itens"]}),n.jsx("p",{className:"font-semibold",children:T(O.totalValue)})]}),b(O.status)]})]})})}),n.jsx(xg,{children:n.jsxs(Fe,{className:"pt-0 pb-4 px-4",children:[O.hasUnresolvedAttention&&n.jsx("div",{className:"mb-4",children:n.jsx(EYe,{bag:O,attentionRequirements:O.attentionRequirements,onResolveReallocation:async(R,D,B)=>{await l(R,D,B)}})}),n.jsx("div",{className:"space-y-2 mb-4",children:O.items.map(R=>{const D=u[R.id]||0,B=f[R.id]||0,q=R.status==="separado"||R.status==="retirado_confirmado",Y=R.status==="cancelado"||R.cartItemStatus==="cancelado"||R.cartItemStatus==="removido",G=(R.pendingRemovalFromQuantityReduction??0)>0,I=Y||G,F=G?R.pendingRemovalFromQuantityReduction??0:Y?R.quantity:0,S=Math.max(0,F-B),E=I&&S>0,N=Y;return n.jsxs("div",{className:`p-3 rounded-lg border ${E?"bg-red-50 border-red-200":I&&S===0?"bg-gray-100 border-gray-200":q?"bg-green-50/50 border-green-200":"bg-background"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"h-12 w-12 rounded overflow-hidden bg-muted flex-shrink-0",children:R.productImage?n.jsx("img",{src:R.productImage,alt:R.productName,className:"h-full w-full object-cover"}):n.jsx("div",{className:"h-full w-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-5 w-5 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("p",{className:`font-medium text-sm truncate ${N?"line-through text-muted-foreground":""}`,children:R.productName}),R.isGift&&n.jsx(ke,{className:"bg-amber-100 text-amber-700 border-amber-200 text-xs shrink-0",children:R.giftSource==="raffle"?" SORTEIO":" BRINDE"})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[R.color&&n.jsx("span",{children:R.color}),R.size&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsx("span",{className:"font-medium",children:R.size})]}),n.jsx("span",{children:""}),n.jsxs("span",{children:["Qtd: ",R.quantity]}),G&&n.jsxs("span",{className:"text-red-600 font-medium",children:["(+ ",R.pendingRemovalFromQuantityReduction," cancelada",(R.pendingRemovalFromQuantityReduction??0)>1?"s":"",")"]}),R.status==="em_separacao"&&D>0&&!G&&n.jsxs("span",{className:"text-green-600 font-medium",children:["(",D,"/",R.quantity," separados)"]}),I&&B>0&&B<F&&n.jsxs("span",{className:"text-amber-600 font-medium",children:["(",B,"/",F," retirados)"]})]})]}),n.jsx("div",{className:"flex-shrink-0",children:G&&S>0?n.jsxs(ke,{className:"bg-red-100 text-red-700 border-red-200 text-xs",children:[n.jsx(Or,{className:"h-3 w-3 mr-1"}),"Retirar ",S]}):j(R.status)})]}),R.status==="em_separacao"&&n.jsx("div",{className:"mt-3 pt-3 border-t border-dashed",children:n.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[Array.from({length:R.quantity}).map((C,k)=>{const M=q||k<D;return n.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border cursor-pointer transition-colors ${M?"bg-green-100 border-green-300 text-green-700":"bg-background border-muted hover:bg-muted/50"}`,onClick:U=>U.stopPropagation(),children:[n.jsx(Va,{checked:M,disabled:p.has(R.id),onCheckedChange:()=>v(R.id,k,R)}),n.jsxs("span",{className:"text-sm font-medium",children:["Unid. ",k+1]}),M&&n.jsx(mn,{className:"h-4 w-4"})]},k)}),p.has(R.id)&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(Qr,{className:"h-4 w-4 animate-spin"}),"Salvando..."]})]})}),E&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-dashed border-red-200",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(ui,{className:"h-4 w-4 text-red-600"}),n.jsx("span",{className:"text-sm font-medium text-red-700",children:R.wasSeparatedBeforeCancellation?` ${G?`${F} unidade(s)`:"Item"} J SEPARADO foi cancelado! Retire da sacola:`:"Confirme a retirada fsica da sacola:"})]}),R.wasSeparatedBeforeCancellation&&n.jsx("div",{className:"mb-2 p-2 rounded text-xs bg-muted/60 border border-border text-foreground",children:G?`${F} unidade(s) deste produto j estava(m) na sacola fsica e precisa(m) ser removida(s) manualmente.`:"Este produto j estava na sacola fsica e precisa ser removido manualmente."}),n.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[Array.from({length:F}).map((C,k)=>{const M=k<B;return n.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border cursor-pointer transition-colors ${M?"bg-gray-200 border-gray-400 text-gray-700":"bg-red-50 border-red-300 hover:bg-red-100 text-red-700"}`,onClick:U=>U.stopPropagation(),children:[n.jsx(Va,{checked:M,disabled:p.has(R.id),onCheckedChange:()=>y(R.id,k)}),n.jsx("span",{className:"text-sm font-medium",children:M?" Retirado":`Retirar unid. ${k+1}`})]},k)}),p.has(R.id)&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(Qr,{className:"h-4 w-4 animate-spin"}),"Salvando..."]})]})]}),I&&S===0&&F>0&&n.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(mn,{className:"h-4 w-4"}),n.jsx("span",{children:"Retirada confirmada"})]})]},R.id)})}),O.needsReprintLabel&&n.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg bg-orange-100 border border-orange-300 mb-4",children:[n.jsx(Vt,{className:"h-5 w-5 text-orange-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-orange-800",children:" Reimprimir Etiqueta"}),n.jsx("p",{className:"text-sm text-orange-700",children:"Esta sacola foi modificada aps a etiqueta ser impressa. Reimprima a etiqueta aps confirmar as retiradas."})]})]}),O.pendingRemovalCount>0&&n.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg bg-red-100 border border-red-300 mb-4",children:[n.jsx(Or,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium text-red-800",children:["Ateno: ",O.pendingRemovalCount," unidade(s) cancelada(s) para retirar"]}),n.jsx("p",{className:"text-sm text-red-700",children:"Marque cada checkbox abaixo aps retirar fisicamente cada unidade da sacola."})]})]}),O.hasUnseparatedItems&&!O.hasCancelledItems&&!O.isBlocked&&n.jsxs(_c,{children:[n.jsx(o1,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:"w-full gap-2",children:[n.jsx(mn,{className:"h-4 w-4"}),"Marcar toda sacola como separada"]})}),n.jsxs(Tl,{children:[n.jsxs(Pl,{children:[n.jsx(Ol,{children:"Confirmar separao completa?"}),n.jsxs(Rl,{children:["Todos os ",O.items.filter(R=>R.status==="em_separacao").length," itens pendentes sero marcados como separados."]})]}),n.jsxs(jc,{children:[n.jsx(Sc,{children:"Cancelar"}),n.jsx(Nc,{onClick:()=>i(O.id),children:"Confirmar"})]})]})]}),O.hasUnseparatedItems&&!O.hasCancelledItems&&O.isBlocked&&n.jsx("div",{className:"p-3 rounded-lg bg-amber-50 border border-amber-200 text-center",children:n.jsx("p",{className:"text-sm text-amber-700",children:" Resolva as pendncias acima antes de finalizar a separao"})})]})})]})},O.id))})}function AYe({productGroups:e,onMarkItemSeparated:t,onMarkAllSeparated:r}){const[s,a]=P.useState(new Set),[i,o]=P.useState(new Set),[l,d]=P.useState(new Set),c=m=>`${m.productId}_${m.color||""}_${m.size||""}`,u=m=>{a(p=>{const g=new Set(p);return g.has(m)?g.delete(m):g.add(m),g})},h=async m=>{o(p=>new Set(p).add(m)),await t(m),o(p=>{const g=new Set(p);return g.delete(m),g})},f=async m=>{const p=c(m);d(g=>new Set(g).add(p)),await r(m.productId,m.color,m.size),d(g=>{const x=new Set(g);return x.delete(p),x})};return e.length===0?n.jsx($e,{className:"border-dashed",children:n.jsxs(Fe,{className:"flex flex-col items-center justify-center py-12",children:[n.jsx(Vt,{className:"h-12 w-12 text-muted-foreground mb-3"}),n.jsx("p",{className:"text-muted-foreground",children:"Nenhum produto encontrado"})]})}):n.jsx("div",{className:"space-y-3",children:e.map(m=>{const p=c(m),g=s.has(p),x=m.totalNeeded>0?Math.round(m.totalSeparated/m.totalNeeded*100):0,v=m.totalPending===0;return n.jsx(pg,{open:g,onOpenChange:()=>u(p),children:n.jsxs($e,{className:`transition-all ${v?"border-green-300 bg-green-50/30":""}`,children:[n.jsx(gg,{className:"w-full",children:n.jsx(Dt,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[g?n.jsx(zo,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"}):n.jsx(In,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"}),n.jsx("div",{className:"h-14 w-14 rounded overflow-hidden bg-muted flex-shrink-0",children:m.productImage?n.jsx("img",{src:m.productImage,alt:m.productName,className:"h-full w-full object-cover"}):n.jsx("div",{className:"h-full w-full flex items-center justify-center",children:n.jsx(Vt,{className:"h-6 w-6 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[n.jsx("p",{className:"font-medium truncate",children:m.productName}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[m.color&&n.jsx(ke,{variant:"outline",className:"text-xs",children:m.color}),m.size&&n.jsx(ke,{variant:"secondary",className:"text-xs font-bold",children:m.size})]})]}),n.jsxs("div",{className:"flex-shrink-0 text-right",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsxs("span",{className:"text-sm font-medium",children:[m.totalSeparated,"/",m.totalNeeded]}),v?n.jsx(mn,{className:"h-4 w-4 text-green-600"}):n.jsx(Qr,{className:"h-4 w-4 text-blue-600"})]}),n.jsx(dg,{value:x,className:"w-20 h-2"})]})]})})}),n.jsx(xg,{children:n.jsxs(Fe,{className:"pt-0 pb-4 px-4",children:[n.jsxs("div",{className:"space-y-2 mb-4",children:[n.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Sacolas que precisam deste item:"}),m.bags.sort((y,b)=>y.bagNumber-b.bagNumber).map(y=>n.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${y.status==="separado"||y.status==="retirado_confirmado"?"bg-green-50 border-green-200":y.status==="cancelado"?"bg-red-50 border-red-200":"bg-background"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("span",{className:"font-bold text-lg",children:["#",y.bagNumber.toString().padStart(3,"0")]}),n.jsx("span",{className:"text-primary font-medium",children:y.instagramHandle}),n.jsxs(ke,{variant:"outline",className:"text-xs",children:["Qtd: ",y.quantity]})]}),n.jsx("div",{className:"flex items-center gap-2",children:y.status==="separado"?n.jsxs(ke,{className:"bg-green-100 text-green-700 border-green-200",children:[n.jsx(mn,{className:"h-3 w-3 mr-1"})," Separado"]}):y.status==="cancelado"?n.jsx(ke,{variant:"destructive",children:"Cancelado"}):n.jsx(he,{size:"sm",variant:"outline",className:"h-8 bg-green-50 border-green-200 hover:bg-green-100 text-green-700",onClick:b=>{b.stopPropagation(),h(y.itemId)},disabled:i.has(y.itemId),children:i.has(y.itemId)?n.jsx(Qr,{className:"h-4 w-4 animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(mn,{className:"h-4 w-4 mr-1"}),"Separado"]})})})]},y.itemId))]}),m.totalPending>0&&n.jsxs(_c,{children:[n.jsx(o1,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:"w-full gap-2",disabled:l.has(p),children:[l.has(p)?n.jsx(Qr,{className:"h-4 w-4 animate-spin"}):n.jsx(mn,{className:"h-4 w-4"}),"Marcar todos como separado (",m.totalPending," pendentes)"]})}),n.jsxs(Tl,{children:[n.jsxs(Pl,{children:[n.jsx(Ol,{children:"Marcar todos como separados?"}),n.jsx(Rl,{children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("p",{children:[m.totalPending," unidades de ",n.jsx("strong",{children:m.productName}),m.color&&` (${m.color})`,m.size&&` - Tam. ${m.size}`," sero marcadas como separadas."]}),n.jsxs("div",{className:"flex items-start gap-2 p-2 bg-amber-50 rounded border border-amber-200 mt-2",children:[n.jsx(Or,{className:"h-4 w-4 text-amber-600 flex-shrink-0 mt-0.5"}),n.jsx("p",{className:"text-sm text-amber-700",children:"Certifique-se de ter todas as peas em mos antes de confirmar."})]})]})})]}),n.jsxs(jc,{children:[n.jsx(Sc,{children:"Cancelar"}),n.jsx(Nc,{onClick:()=>f(m),children:"Confirmar todos"})]})]})]})]})})]})},p)})})}var or;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(or||(or={}));var RL=new Map([[or.QR_CODE,"QR_CODE"],[or.AZTEC,"AZTEC"],[or.CODABAR,"CODABAR"],[or.CODE_39,"CODE_39"],[or.CODE_93,"CODE_93"],[or.CODE_128,"CODE_128"],[or.DATA_MATRIX,"DATA_MATRIX"],[or.MAXICODE,"MAXICODE"],[or.ITF,"ITF"],[or.EAN_13,"EAN_13"],[or.EAN_8,"EAN_8"],[or.PDF_417,"PDF_417"],[or.RSS_14,"RSS_14"],[or.RSS_EXPANDED,"RSS_EXPANDED"],[or.UPC_A,"UPC_A"],[or.UPC_E,"UPC_E"],[or.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),ML;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(ML||(ML={}));function TYe(e){return Object.values(or).includes(e)}var M2;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(M2||(M2={}));var PYe=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[M2.SCAN_TYPE_CAMERA,M2.SCAN_TYPE_FILE],e}(),WJ=function(){function e(t,r){this.format=t,this.formatName=r}return e.prototype.toString=function(){return this.formatName},e.create=function(t){if(!RL.has(t))throw"".concat(t," not in html5QrcodeSupportedFormatsTextMap");return new e(t,RL.get(t))},e}(),IL=function(){function e(){}return e.createFromText=function(t){var r={text:t};return{decodedText:t,result:r}},e.createFromQrcodeResult=function(t){return{decodedText:t.text,result:t}},e}(),kE;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(kE||(kE={}));var OYe=function(){function e(){}return e.createFrom=function(t){return{errorMessage:t,type:kE.UNKWOWN_ERROR}},e}(),RYe=function(){function e(t){this.verbose=t}return e.prototype.log=function(t){this.verbose&&console.log(t)},e.prototype.warn=function(t){this.verbose&&console.warn(t)},e.prototype.logError=function(t,r){(this.verbose||r===!0)&&console.error(t)},e.prototype.logErrors=function(t){if(t.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(t)},e}();function Mc(e){return typeof e>"u"||e===null}var Em=function(){function e(){}return e.codeParseError=function(t){return"QR code parse error, error = ".concat(t)},e.errorGettingUserMedia=function(t){return"Error getting userMedia, error = ".concat(t)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),HJ=function(){function e(){}return e.isMediaStreamConstraintsValid=function(t,r){if(typeof t!="object"){var s=typeof t;return r.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(s,"."),!0),!1}for(var a=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],i=new Set(a),o=Object.keys(t),l=0,d=o;l<d.length;l++){var c=d[l];if(i.has(c))return r.logError("".concat(c," is not supported videoConstaints."),!0),!1}return!0},e}(),AE={exports:{}};(function(e,t){(function(r,s){s(t)})(Fr,function(r){function s(xe){return xe==null}var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(xe,w){xe.__proto__=w}||function(xe,w){for(var _ in w)w.hasOwnProperty(_)&&(xe[_]=w[_])};function i(xe,w){a(xe,w);function _(){this.constructor=xe}xe.prototype=w===null?Object.create(w):(_.prototype=w.prototype,new _)}function o(xe,w){var _=Object.setPrototypeOf;_?_(xe,w):xe.__proto__=w}function l(xe,w){w===void 0&&(w=xe.constructor);var _=Error.captureStackTrace;_&&_(xe,w)}var d=function(xe){i(w,xe);function w(_){var A=this.constructor,L=xe.call(this,_)||this;return Object.defineProperty(L,"name",{value:A.name,enumerable:!1}),o(L,A.prototype),l(L),L}return w}(Error);class c extends d{constructor(w=void 0){super(w),this.message=w}getKind(){return this.constructor.kind}}c.kind="Exception";class u extends c{}u.kind="ArgumentException";class h extends c{}h.kind="IllegalArgumentException";class f{constructor(w){if(this.binarizer=w,w===null)throw new h("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(w,_){return this.binarizer.getBlackRow(w,_)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(w,_,A,L){const z=this.binarizer.getLuminanceSource().crop(w,_,A,L);return new f(this.binarizer.createBinarizer(z))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const w=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new f(this.binarizer.createBinarizer(w))}rotateCounterClockwise45(){const w=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new f(this.binarizer.createBinarizer(w))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class m extends c{static getChecksumInstance(){return new m}}m.kind="ChecksumException";class p{constructor(w){this.source=w}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class g{static arraycopy(w,_,A,L,z){for(;z--;)A[L++]=w[_++]}static currentTimeMillis(){return Date.now()}}class x extends c{}x.kind="IndexOutOfBoundsException";class v extends x{constructor(w=void 0,_=void 0){super(_),this.index=w,this.message=_}}v.kind="ArrayIndexOutOfBoundsException";class y{static fill(w,_){for(let A=0,L=w.length;A<L;A++)w[A]=_}static fillWithin(w,_,A,L){y.rangeCheck(w.length,_,A);for(let z=_;z<A;z++)w[z]=L}static rangeCheck(w,_,A){if(_>A)throw new h("fromIndex("+_+") > toIndex("+A+")");if(_<0)throw new v(_);if(A>w)throw new v(A)}static asList(...w){return w}static create(w,_,A){return Array.from({length:w}).map(z=>Array.from({length:_}).fill(A))}static createInt32Array(w,_,A){return Array.from({length:w}).map(z=>Int32Array.from({length:_}).fill(A))}static equals(w,_){if(!w||!_||!w.length||!_.length||w.length!==_.length)return!1;for(let A=0,L=w.length;A<L;A++)if(w[A]!==_[A])return!1;return!0}static hashCode(w){if(w===null)return 0;let _=1;for(const A of w)_=31*_+A;return _}static fillUint8Array(w,_){for(let A=0;A!==w.length;A++)w[A]=_}static copyOf(w,_){return w.slice(0,_)}static copyOfUint8Array(w,_){if(w.length<=_){const A=new Uint8Array(_);return A.set(w),A}return w.slice(0,_)}static copyOfRange(w,_,A){const L=A-_,z=new Int32Array(L);return g.arraycopy(w,_,z,0,L),z}static binarySearch(w,_,A){A===void 0&&(A=y.numberComparator);let L=0,z=w.length-1;for(;L<=z;){const K=z+L>>1,Q=A(_,w[K]);if(Q>0)L=K+1;else if(Q<0)z=K-1;else return K}return-L-1}static numberComparator(w,_){return w-_}}class b{static numberOfTrailingZeros(w){let _;if(w===0)return 32;let A=31;return _=w<<16,_!==0&&(A-=16,w=_),_=w<<8,_!==0&&(A-=8,w=_),_=w<<4,_!==0&&(A-=4,w=_),_=w<<2,_!==0&&(A-=2,w=_),A-(w<<1>>>31)}static numberOfLeadingZeros(w){if(w===0)return 32;let _=1;return w>>>16||(_+=16,w<<=16),w>>>24||(_+=8,w<<=8),w>>>28||(_+=4,w<<=4),w>>>30||(_+=2,w<<=2),_-=w>>>31,_}static toHexString(w){return w.toString(16)}static toBinaryString(w){return String(parseInt(String(w),2))}static bitCount(w){return w=w-(w>>>1&1431655765),w=(w&858993459)+(w>>>2&858993459),w=w+(w>>>4)&252645135,w=w+(w>>>8),w=w+(w>>>16),w&63}static truncDivision(w,_){return Math.trunc(w/_)}static parseInt(w,_=void 0){return parseInt(w,_)}}b.MIN_VALUE_32_BITS=-2147483648,b.MAX_VALUE=Number.MAX_SAFE_INTEGER;class j{constructor(w,_){w===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=w,_==null?this.bits=j.makeArray(w):this.bits=_)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(w){if(w>this.bits.length*32){const _=j.makeArray(w);g.arraycopy(this.bits,0,_,0,this.bits.length),this.bits=_}}get(w){return(this.bits[Math.floor(w/32)]&1<<(w&31))!==0}set(w){this.bits[Math.floor(w/32)]|=1<<(w&31)}flip(w){this.bits[Math.floor(w/32)]^=1<<(w&31)}getNextSet(w){const _=this.size;if(w>=_)return _;const A=this.bits;let L=Math.floor(w/32),z=A[L];z&=~((1<<(w&31))-1);const K=A.length;for(;z===0;){if(++L===K)return _;z=A[L]}const Q=L*32+b.numberOfTrailingZeros(z);return Q>_?_:Q}getNextUnset(w){const _=this.size;if(w>=_)return _;const A=this.bits;let L=Math.floor(w/32),z=~A[L];z&=~((1<<(w&31))-1);const K=A.length;for(;z===0;){if(++L===K)return _;z=~A[L]}const Q=L*32+b.numberOfTrailingZeros(z);return Q>_?_:Q}setBulk(w,_){this.bits[Math.floor(w/32)]=_}setRange(w,_){if(_<w||w<0||_>this.size)throw new h;if(_===w)return;_--;const A=Math.floor(w/32),L=Math.floor(_/32),z=this.bits;for(let K=A;K<=L;K++){const Q=K>A?0:w&31,ae=(2<<(K<L?31:_&31))-(1<<Q);z[K]|=ae}}clear(){const w=this.bits.length,_=this.bits;for(let A=0;A<w;A++)_[A]=0}isRange(w,_,A){if(_<w||w<0||_>this.size)throw new h;if(_===w)return!0;_--;const L=Math.floor(w/32),z=Math.floor(_/32),K=this.bits;for(let Q=L;Q<=z;Q++){const te=Q>L?0:w&31,fe=(2<<(Q<z?31:_&31))-(1<<te)&4294967295;if((K[Q]&fe)!==(A?fe:0))return!1}return!0}appendBit(w){this.ensureCapacity(this.size+1),w&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(w,_){if(_<0||_>32)throw new h("Num bits must be between 0 and 32");this.ensureCapacity(this.size+_);for(let A=_;A>0;A--)this.appendBit((w>>A-1&1)===1)}appendBitArray(w){const _=w.size;this.ensureCapacity(this.size+_);for(let A=0;A<_;A++)this.appendBit(w.get(A))}xor(w){if(this.size!==w.size)throw new h("Sizes don't match");const _=this.bits;for(let A=0,L=_.length;A<L;A++)_[A]^=w.bits[A]}toBytes(w,_,A,L){for(let z=0;z<L;z++){let K=0;for(let Q=0;Q<8;Q++)this.get(w)&&(K|=1<<7-Q),w++;_[A+z]=K}}getBitArray(){return this.bits}reverse(){const w=new Int32Array(this.bits.length),_=Math.floor((this.size-1)/32),A=_+1,L=this.bits;for(let z=0;z<A;z++){let K=L[z];K=K>>1&1431655765|(K&1431655765)<<1,K=K>>2&858993459|(K&858993459)<<2,K=K>>4&252645135|(K&252645135)<<4,K=K>>8&16711935|(K&16711935)<<8,K=K>>16&65535|(K&65535)<<16,w[_-z]=K}if(this.size!==A*32){const z=A*32-this.size;let K=w[0]>>>z;for(let Q=1;Q<A;Q++){const te=w[Q];K|=te<<32-z,w[Q-1]=K,K=te>>>z}w[A-1]=K}this.bits=w}static makeArray(w){return new Int32Array(Math.floor((w+31)/32))}equals(w){if(!(w instanceof j))return!1;const _=w;return this.size===_.size&&y.equals(this.bits,_.bits)}hashCode(){return 31*this.size+y.hashCode(this.bits)}toString(){let w="";for(let _=0,A=this.size;_<A;_++)_&7||(w+=" "),w+=this.get(_)?"X":".";return w}clone(){return new j(this.size,this.bits.slice())}}var T;(function(xe){xe[xe.OTHER=0]="OTHER",xe[xe.PURE_BARCODE=1]="PURE_BARCODE",xe[xe.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",xe[xe.TRY_HARDER=3]="TRY_HARDER",xe[xe.CHARACTER_SET=4]="CHARACTER_SET",xe[xe.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",xe[xe.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",xe[xe.ASSUME_GS1=7]="ASSUME_GS1",xe[xe.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",xe[xe.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",xe[xe.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(T||(T={}));var O=T;class R extends c{static getFormatInstance(){return new R}}R.kind="FormatException";var D;(function(xe){xe[xe.Cp437=0]="Cp437",xe[xe.ISO8859_1=1]="ISO8859_1",xe[xe.ISO8859_2=2]="ISO8859_2",xe[xe.ISO8859_3=3]="ISO8859_3",xe[xe.ISO8859_4=4]="ISO8859_4",xe[xe.ISO8859_5=5]="ISO8859_5",xe[xe.ISO8859_6=6]="ISO8859_6",xe[xe.ISO8859_7=7]="ISO8859_7",xe[xe.ISO8859_8=8]="ISO8859_8",xe[xe.ISO8859_9=9]="ISO8859_9",xe[xe.ISO8859_10=10]="ISO8859_10",xe[xe.ISO8859_11=11]="ISO8859_11",xe[xe.ISO8859_13=12]="ISO8859_13",xe[xe.ISO8859_14=13]="ISO8859_14",xe[xe.ISO8859_15=14]="ISO8859_15",xe[xe.ISO8859_16=15]="ISO8859_16",xe[xe.SJIS=16]="SJIS",xe[xe.Cp1250=17]="Cp1250",xe[xe.Cp1251=18]="Cp1251",xe[xe.Cp1252=19]="Cp1252",xe[xe.Cp1256=20]="Cp1256",xe[xe.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",xe[xe.UTF8=22]="UTF8",xe[xe.ASCII=23]="ASCII",xe[xe.Big5=24]="Big5",xe[xe.GB18030=25]="GB18030",xe[xe.EUC_KR=26]="EUC_KR"})(D||(D={}));class B{constructor(w,_,A,...L){this.valueIdentifier=w,this.name=A,typeof _=="number"?this.values=Int32Array.from([_]):this.values=_,this.otherEncodingNames=L,B.VALUE_IDENTIFIER_TO_ECI.set(w,this),B.NAME_TO_ECI.set(A,this);const z=this.values;for(let K=0,Q=z.length;K!==Q;K++){const te=z[K];B.VALUES_TO_ECI.set(te,this)}for(const K of L)B.NAME_TO_ECI.set(K,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(w){if(w<0||w>=900)throw new R("incorect value");const _=B.VALUES_TO_ECI.get(w);if(_===void 0)throw new R("incorect value");return _}static getCharacterSetECIByName(w){const _=B.NAME_TO_ECI.get(w);if(_===void 0)throw new R("incorect value");return _}equals(w){if(!(w instanceof B))return!1;const _=w;return this.getName()===_.getName()}}B.VALUE_IDENTIFIER_TO_ECI=new Map,B.VALUES_TO_ECI=new Map,B.NAME_TO_ECI=new Map,B.Cp437=new B(D.Cp437,Int32Array.from([0,2]),"Cp437"),B.ISO8859_1=new B(D.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),B.ISO8859_2=new B(D.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),B.ISO8859_3=new B(D.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),B.ISO8859_4=new B(D.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),B.ISO8859_5=new B(D.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),B.ISO8859_6=new B(D.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),B.ISO8859_7=new B(D.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),B.ISO8859_8=new B(D.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),B.ISO8859_9=new B(D.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),B.ISO8859_10=new B(D.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),B.ISO8859_11=new B(D.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),B.ISO8859_13=new B(D.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),B.ISO8859_14=new B(D.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),B.ISO8859_15=new B(D.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),B.ISO8859_16=new B(D.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),B.SJIS=new B(D.SJIS,20,"SJIS","Shift_JIS"),B.Cp1250=new B(D.Cp1250,21,"Cp1250","windows-1250"),B.Cp1251=new B(D.Cp1251,22,"Cp1251","windows-1251"),B.Cp1252=new B(D.Cp1252,23,"Cp1252","windows-1252"),B.Cp1256=new B(D.Cp1256,24,"Cp1256","windows-1256"),B.UnicodeBigUnmarked=new B(D.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),B.UTF8=new B(D.UTF8,26,"UTF8","UTF-8"),B.ASCII=new B(D.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),B.Big5=new B(D.Big5,28,"Big5"),B.GB18030=new B(D.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),B.EUC_KR=new B(D.EUC_KR,30,"EUC_KR","EUC-KR");class q extends c{}q.kind="UnsupportedOperationException";class Y{static decode(w,_){const A=this.encodingName(_);return this.customDecoder?this.customDecoder(w,A):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(A)?this.decodeFallback(w,A):new TextDecoder(A).decode(w)}static shouldDecodeOnFallback(w){return!Y.isBrowser()&&w==="ISO-8859-1"}static encode(w,_){const A=this.encodingName(_);return this.customEncoder?this.customEncoder(w,A):typeof TextEncoder>"u"?this.encodeFallback(w):new TextEncoder().encode(w)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(w){return typeof w=="string"?w:w.getName()}static encodingCharacterSet(w){return w instanceof B?w:B.getCharacterSetECIByName(w)}static decodeFallback(w,_){const A=this.encodingCharacterSet(_);if(Y.isDecodeFallbackSupported(A)){let L="";for(let z=0,K=w.length;z<K;z++){let Q=w[z].toString(16);Q.length<2&&(Q="0"+Q),L+="%"+Q}return decodeURIComponent(L)}if(A.equals(B.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(w.buffer));throw new q(`Encoding ${this.encodingName(_)} not supported by fallback.`)}static isDecodeFallbackSupported(w){return w.equals(B.UTF8)||w.equals(B.ISO8859_1)||w.equals(B.ASCII)}static encodeFallback(w){const A=btoa(unescape(encodeURIComponent(w))).split(""),L=[];for(let z=0;z<A.length;z++)L.push(A[z].charCodeAt(0));return new Uint8Array(L)}}class G{static castAsNonUtf8Char(w,_=null){const A=_?_.getName():this.ISO88591;return Y.decode(new Uint8Array([w]),A)}static guessEncoding(w,_){if(_!=null&&_.get(O.CHARACTER_SET)!==void 0)return _.get(O.CHARACTER_SET).toString();const A=w.length;let L=!0,z=!0,K=!0,Q=0,te=0,ae=0,fe=0,ve=0,we=0,Te=0,Ve=0,We=0,at=0,pt=0;const $t=w.length>3&&w[0]===239&&w[1]===187&&w[2]===191;for(let zt=0;zt<A&&(L||z||K);zt++){const Mt=w[zt]&255;K&&(Q>0?Mt&128?Q--:K=!1:Mt&128&&(Mt&64?(Q++,Mt&32?(Q++,Mt&16?(Q++,Mt&8?K=!1:fe++):ae++):te++):K=!1)),L&&(Mt>127&&Mt<160?L=!1:Mt>159&&(Mt<192||Mt===215||Mt===247)&&pt++),z&&(ve>0?Mt<64||Mt===127||Mt>252?z=!1:ve--:Mt===128||Mt===160||Mt>239?z=!1:Mt>160&&Mt<224?(we++,Ve=0,Te++,Te>We&&(We=Te)):Mt>127?(ve++,Te=0,Ve++,Ve>at&&(at=Ve)):(Te=0,Ve=0))}return K&&Q>0&&(K=!1),z&&ve>0&&(z=!1),K&&($t||te+ae+fe>0)?G.UTF8:z&&(G.ASSUME_SHIFT_JIS||We>=3||at>=3)?G.SHIFT_JIS:L&&z?We===2&&we===2||pt*10>=A?G.SHIFT_JIS:G.ISO88591:L?G.ISO88591:z?G.SHIFT_JIS:K?G.UTF8:G.PLATFORM_DEFAULT_ENCODING}static format(w,..._){let A=-1;function L(K,Q,te,ae,fe,ve){if(K==="%%")return"%";if(_[++A]===void 0)return;K=ae?parseInt(ae.substr(1)):void 0;let we=fe?parseInt(fe.substr(1)):void 0,Te;switch(ve){case"s":Te=_[A];break;case"c":Te=_[A][0];break;case"f":Te=parseFloat(_[A]).toFixed(K);break;case"p":Te=parseFloat(_[A]).toPrecision(K);break;case"e":Te=parseFloat(_[A]).toExponential(K);break;case"x":Te=parseInt(_[A]).toString(we||16);break;case"d":Te=parseFloat(parseInt(_[A],we||10).toPrecision(K)).toFixed(0);break}Te=typeof Te=="object"?JSON.stringify(Te):(+Te).toString(we);let Ve=parseInt(te),We=te&&te[0]+""=="0"?"0":" ";for(;Te.length<Ve;)Te=Q!==void 0?Te+We:We+Te;return Te}let z=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return w.replace(z,L)}static getBytes(w,_){return Y.encode(w,_)}static getCharCode(w,_=0){return w.charCodeAt(_)}static getCharAt(w){return String.fromCharCode(w)}}G.SHIFT_JIS=B.SJIS.getName(),G.GB2312="GB2312",G.ISO88591=B.ISO8859_1.getName(),G.EUC_JP="EUC_JP",G.UTF8=B.UTF8.getName(),G.PLATFORM_DEFAULT_ENCODING=G.UTF8,G.ASSUME_SHIFT_JIS=!1;class I{constructor(w=""){this.value=w}enableDecoding(w){return this.encoding=w,this}append(w){return typeof w=="string"?this.value+=w.toString():this.encoding?this.value+=G.castAsNonUtf8Char(w,this.encoding):this.value+=String.fromCharCode(w),this}appendChars(w,_,A){for(let L=_;_<_+A;L++)this.append(w[L]);return this}length(){return this.value.length}charAt(w){return this.value.charAt(w)}deleteCharAt(w){this.value=this.value.substr(0,w)+this.value.substring(w+1)}setCharAt(w,_){this.value=this.value.substr(0,w)+_+this.value.substr(w+1)}substring(w,_){return this.value.substring(w,_)}setLengthToZero(){this.value=""}toString(){return this.value}insert(w,_){this.value=this.value.substr(0,w)+_+this.value.substr(w+_.length)}}class F{constructor(w,_,A,L){if(this.width=w,this.height=_,this.rowSize=A,this.bits=L,_==null&&(_=w),this.height=_,w<1||_<1)throw new h("Both dimensions must be greater than 0");A==null&&(A=Math.floor((w+31)/32)),this.rowSize=A,L==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(w){const _=w.length,A=w[0].length,L=new F(A,_);for(let z=0;z<_;z++){const K=w[z];for(let Q=0;Q<A;Q++)K[Q]&&L.set(Q,z)}return L}static parseFromString(w,_,A){if(w===null)throw new h("stringRepresentation cannot be null");const L=new Array(w.length);let z=0,K=0,Q=-1,te=0,ae=0;for(;ae<w.length;)if(w.charAt(ae)===`
`||w.charAt(ae)==="\r"){if(z>K){if(Q===-1)Q=z-K;else if(z-K!==Q)throw new h("row lengths do not match");K=z,te++}ae++}else if(w.substring(ae,ae+_.length)===_)ae+=_.length,L[z]=!0,z++;else if(w.substring(ae,ae+A.length)===A)ae+=A.length,L[z]=!1,z++;else throw new h("illegal character encountered: "+w.substring(ae));if(z>K){if(Q===-1)Q=z-K;else if(z-K!==Q)throw new h("row lengths do not match");te++}const fe=new F(Q,te);for(let ve=0;ve<z;ve++)L[ve]&&fe.set(Math.floor(ve%Q),Math.floor(ve/Q));return fe}get(w,_){const A=_*this.rowSize+Math.floor(w/32);return(this.bits[A]>>>(w&31)&1)!==0}set(w,_){const A=_*this.rowSize+Math.floor(w/32);this.bits[A]|=1<<(w&31)&4294967295}unset(w,_){const A=_*this.rowSize+Math.floor(w/32);this.bits[A]&=~(1<<(w&31)&4294967295)}flip(w,_){const A=_*this.rowSize+Math.floor(w/32);this.bits[A]^=1<<(w&31)&4294967295}xor(w){if(this.width!==w.getWidth()||this.height!==w.getHeight()||this.rowSize!==w.getRowSize())throw new h("input matrix dimensions do not match");const _=new j(Math.floor(this.width/32)+1),A=this.rowSize,L=this.bits;for(let z=0,K=this.height;z<K;z++){const Q=z*A,te=w.getRow(z,_).getBitArray();for(let ae=0;ae<A;ae++)L[Q+ae]^=te[ae]}}clear(){const w=this.bits,_=w.length;for(let A=0;A<_;A++)w[A]=0}setRegion(w,_,A,L){if(_<0||w<0)throw new h("Left and top must be nonnegative");if(L<1||A<1)throw new h("Height and width must be at least 1");const z=w+A,K=_+L;if(K>this.height||z>this.width)throw new h("The region must fit inside the matrix");const Q=this.rowSize,te=this.bits;for(let ae=_;ae<K;ae++){const fe=ae*Q;for(let ve=w;ve<z;ve++)te[fe+Math.floor(ve/32)]|=1<<(ve&31)&4294967295}}getRow(w,_){_==null||_.getSize()<this.width?_=new j(this.width):_.clear();const A=this.rowSize,L=this.bits,z=w*A;for(let K=0;K<A;K++)_.setBulk(K*32,L[z+K]);return _}setRow(w,_){g.arraycopy(_.getBitArray(),0,this.bits,w*this.rowSize,this.rowSize)}rotate180(){const w=this.getWidth(),_=this.getHeight();let A=new j(w),L=new j(w);for(let z=0,K=Math.floor((_+1)/2);z<K;z++)A=this.getRow(z,A),L=this.getRow(_-1-z,L),A.reverse(),L.reverse(),this.setRow(z,L),this.setRow(_-1-z,A)}getEnclosingRectangle(){const w=this.width,_=this.height,A=this.rowSize,L=this.bits;let z=w,K=_,Q=-1,te=-1;for(let ae=0;ae<_;ae++)for(let fe=0;fe<A;fe++){const ve=L[ae*A+fe];if(ve!==0){if(ae<K&&(K=ae),ae>te&&(te=ae),fe*32<z){let we=0;for(;!(ve<<31-we&4294967295);)we++;fe*32+we<z&&(z=fe*32+we)}if(fe*32+31>Q){let we=31;for(;!(ve>>>we);)we--;fe*32+we>Q&&(Q=fe*32+we)}}}return Q<z||te<K?null:Int32Array.from([z,K,Q-z+1,te-K+1])}getTopLeftOnBit(){const w=this.rowSize,_=this.bits;let A=0;for(;A<_.length&&_[A]===0;)A++;if(A===_.length)return null;const L=A/w;let z=A%w*32;const K=_[A];let Q=0;for(;!(K<<31-Q&4294967295);)Q++;return z+=Q,Int32Array.from([z,L])}getBottomRightOnBit(){const w=this.rowSize,_=this.bits;let A=_.length-1;for(;A>=0&&_[A]===0;)A--;if(A<0)return null;const L=Math.floor(A/w);let z=Math.floor(A%w)*32;const K=_[A];let Q=31;for(;!(K>>>Q);)Q--;return z+=Q,Int32Array.from([z,L])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(w){if(!(w instanceof F))return!1;const _=w;return this.width===_.width&&this.height===_.height&&this.rowSize===_.rowSize&&y.equals(this.bits,_.bits)}hashCode(){let w=this.width;return w=31*w+this.width,w=31*w+this.height,w=31*w+this.rowSize,w=31*w+y.hashCode(this.bits),w}toString(w="X ",_="  ",A=`
`){return this.buildToString(w,_,A)}buildToString(w,_,A){let L=new I;for(let z=0,K=this.height;z<K;z++){for(let Q=0,te=this.width;Q<te;Q++)L.append(this.get(Q,z)?w:_);L.append(A)}return L.toString()}clone(){return new F(this.width,this.height,this.rowSize,this.bits.slice())}}class S extends c{static getNotFoundInstance(){return new S}}S.kind="NotFoundException";class E extends p{constructor(w){super(w),this.luminances=E.EMPTY,this.buckets=new Int32Array(E.LUMINANCE_BUCKETS)}getBlackRow(w,_){const A=this.getLuminanceSource(),L=A.getWidth();_==null||_.getSize()<L?_=new j(L):_.clear(),this.initArrays(L);const z=A.getRow(w,this.luminances),K=this.buckets;for(let te=0;te<L;te++)K[(z[te]&255)>>E.LUMINANCE_SHIFT]++;const Q=E.estimateBlackPoint(K);if(L<3)for(let te=0;te<L;te++)(z[te]&255)<Q&&_.set(te);else{let te=z[0]&255,ae=z[1]&255;for(let fe=1;fe<L-1;fe++){const ve=z[fe+1]&255;(ae*4-te-ve)/2<Q&&_.set(fe),te=ae,ae=ve}}return _}getBlackMatrix(){const w=this.getLuminanceSource(),_=w.getWidth(),A=w.getHeight(),L=new F(_,A);this.initArrays(_);const z=this.buckets;for(let te=1;te<5;te++){const ae=Math.floor(A*te/5),fe=w.getRow(ae,this.luminances),ve=Math.floor(_*4/5);for(let we=Math.floor(_/5);we<ve;we++){const Te=fe[we]&255;z[Te>>E.LUMINANCE_SHIFT]++}}const K=E.estimateBlackPoint(z),Q=w.getMatrix();for(let te=0;te<A;te++){const ae=te*_;for(let fe=0;fe<_;fe++)(Q[ae+fe]&255)<K&&L.set(fe,te)}return L}createBinarizer(w){return new E(w)}initArrays(w){this.luminances.length<w&&(this.luminances=new Uint8ClampedArray(w));const _=this.buckets;for(let A=0;A<E.LUMINANCE_BUCKETS;A++)_[A]=0}static estimateBlackPoint(w){const _=w.length;let A=0,L=0,z=0;for(let fe=0;fe<_;fe++)w[fe]>z&&(L=fe,z=w[fe]),w[fe]>A&&(A=w[fe]);let K=0,Q=0;for(let fe=0;fe<_;fe++){const ve=fe-L,we=w[fe]*ve*ve;we>Q&&(K=fe,Q=we)}if(L>K){const fe=L;L=K,K=fe}if(K-L<=_/16)throw new S;let te=K-1,ae=-1;for(let fe=K-1;fe>L;fe--){const ve=fe-L,we=ve*ve*(K-fe)*(A-w[fe]);we>ae&&(te=fe,ae=we)}return te<<E.LUMINANCE_SHIFT}}E.LUMINANCE_BITS=5,E.LUMINANCE_SHIFT=8-E.LUMINANCE_BITS,E.LUMINANCE_BUCKETS=1<<E.LUMINANCE_BITS,E.EMPTY=Uint8ClampedArray.from([0]);class N extends E{constructor(w){super(w),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const w=this.getLuminanceSource(),_=w.getWidth(),A=w.getHeight();if(_>=N.MINIMUM_DIMENSION&&A>=N.MINIMUM_DIMENSION){const L=w.getMatrix();let z=_>>N.BLOCK_SIZE_POWER;_&N.BLOCK_SIZE_MASK&&z++;let K=A>>N.BLOCK_SIZE_POWER;A&N.BLOCK_SIZE_MASK&&K++;const Q=N.calculateBlackPoints(L,z,K,_,A),te=new F(_,A);N.calculateThresholdForBlock(L,z,K,_,A,Q,te),this.matrix=te}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(w){return new N(w)}static calculateThresholdForBlock(w,_,A,L,z,K,Q){const te=z-N.BLOCK_SIZE,ae=L-N.BLOCK_SIZE;for(let fe=0;fe<A;fe++){let ve=fe<<N.BLOCK_SIZE_POWER;ve>te&&(ve=te);const we=N.cap(fe,2,A-3);for(let Te=0;Te<_;Te++){let Ve=Te<<N.BLOCK_SIZE_POWER;Ve>ae&&(Ve=ae);const We=N.cap(Te,2,_-3);let at=0;for(let $t=-2;$t<=2;$t++){const zt=K[we+$t];at+=zt[We-2]+zt[We-1]+zt[We]+zt[We+1]+zt[We+2]}const pt=at/25;N.thresholdBlock(w,Ve,ve,pt,L,Q)}}}static cap(w,_,A){return w<_?_:w>A?A:w}static thresholdBlock(w,_,A,L,z,K){for(let Q=0,te=A*z+_;Q<N.BLOCK_SIZE;Q++,te+=z)for(let ae=0;ae<N.BLOCK_SIZE;ae++)(w[te+ae]&255)<=L&&K.set(_+ae,A+Q)}static calculateBlackPoints(w,_,A,L,z){const K=z-N.BLOCK_SIZE,Q=L-N.BLOCK_SIZE,te=new Array(A);for(let ae=0;ae<A;ae++){te[ae]=new Int32Array(_);let fe=ae<<N.BLOCK_SIZE_POWER;fe>K&&(fe=K);for(let ve=0;ve<_;ve++){let we=ve<<N.BLOCK_SIZE_POWER;we>Q&&(we=Q);let Te=0,Ve=255,We=0;for(let pt=0,$t=fe*L+we;pt<N.BLOCK_SIZE;pt++,$t+=L){for(let zt=0;zt<N.BLOCK_SIZE;zt++){const Mt=w[$t+zt]&255;Te+=Mt,Mt<Ve&&(Ve=Mt),Mt>We&&(We=Mt)}if(We-Ve>N.MIN_DYNAMIC_RANGE)for(pt++,$t+=L;pt<N.BLOCK_SIZE;pt++,$t+=L)for(let zt=0;zt<N.BLOCK_SIZE;zt++)Te+=w[$t+zt]&255}let at=Te>>N.BLOCK_SIZE_POWER*2;if(We-Ve<=N.MIN_DYNAMIC_RANGE&&(at=Ve/2,ae>0&&ve>0)){const pt=(te[ae-1][ve]+2*te[ae][ve-1]+te[ae-1][ve-1])/4;Ve<pt&&(at=pt)}te[ae][ve]=at}}return te}}N.BLOCK_SIZE_POWER=3,N.BLOCK_SIZE=1<<N.BLOCK_SIZE_POWER,N.BLOCK_SIZE_MASK=N.BLOCK_SIZE-1,N.MINIMUM_DIMENSION=N.BLOCK_SIZE*5,N.MIN_DYNAMIC_RANGE=24;class C{constructor(w,_){this.width=w,this.height=_}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(w,_,A,L){throw new q("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new q("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new q("This luminance source does not support rotation by 45 degrees.")}toString(){const w=new Uint8ClampedArray(this.width);let _=new I;for(let A=0;A<this.height;A++){const L=this.getRow(A,w);for(let z=0;z<this.width;z++){const K=L[z]&255;let Q;K<64?Q="#":K<128?Q="+":K<192?Q=".":Q=" ",_.append(Q)}_.append(`
`)}return _.toString()}}class k extends C{constructor(w){super(w.getWidth(),w.getHeight()),this.delegate=w}getRow(w,_){const A=this.delegate.getRow(w,_),L=this.getWidth();for(let z=0;z<L;z++)A[z]=255-(A[z]&255);return A}getMatrix(){const w=this.delegate.getMatrix(),_=this.getWidth()*this.getHeight(),A=new Uint8ClampedArray(_);for(let L=0;L<_;L++)A[L]=255-(w[L]&255);return A}isCropSupported(){return this.delegate.isCropSupported()}crop(w,_,A,L){return new k(this.delegate.crop(w,_,A,L))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new k(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new k(this.delegate.rotateCounterClockwise45())}}class M extends C{constructor(w){super(w.width,w.height),this.canvas=w,this.tempCanvasElement=null,this.buffer=M.makeBufferFromCanvasImageData(w)}static makeBufferFromCanvasImageData(w){const _=w.getContext("2d").getImageData(0,0,w.width,w.height);return M.toGrayscaleBuffer(_.data,w.width,w.height)}static toGrayscaleBuffer(w,_,A){const L=new Uint8ClampedArray(_*A);for(let z=0,K=0,Q=w.length;z<Q;z+=4,K++){let te;if(w[z+3]===0)te=255;else{const fe=w[z],ve=w[z+1],we=w[z+2];te=306*fe+601*ve+117*we+512>>10}L[K]=te}return L}getRow(w,_){if(w<0||w>=this.getHeight())throw new h("Requested row is outside the image: "+w);const A=this.getWidth(),L=w*A;return _===null?_=this.buffer.slice(L,L+A):(_.length<A&&(_=new Uint8ClampedArray(A)),_.set(this.buffer.slice(L,L+A))),_}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(w,_,A,L){return super.crop(w,_,A,L),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const w=this.canvas.ownerDocument.createElement("canvas");w.width=this.canvas.width,w.height=this.canvas.height,this.tempCanvasElement=w}return this.tempCanvasElement}rotate(w){const _=this.getTempCanvasElement(),A=_.getContext("2d"),L=w*M.DEGREE_TO_RADIANS,z=this.canvas.width,K=this.canvas.height,Q=Math.ceil(Math.abs(Math.cos(L))*z+Math.abs(Math.sin(L))*K),te=Math.ceil(Math.abs(Math.sin(L))*z+Math.abs(Math.cos(L))*K);return _.width=Q,_.height=te,A.translate(Q/2,te/2),A.rotate(L),A.drawImage(this.canvas,z/-2,K/-2),this.buffer=M.makeBufferFromCanvasImageData(_),this}invert(){return new k(this)}}M.DEGREE_TO_RADIANS=Math.PI/180;class U{constructor(w,_,A){this.deviceId=w,this.label=_,this.kind="videoinput",this.groupId=A||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var $=(globalThis||Fr||self||window||void 0)&&(globalThis||Fr||self||window||void 0).__awaiter||function(xe,w,_,A){function L(z){return z instanceof _?z:new _(function(K){K(z)})}return new(_||(_=Promise))(function(z,K){function Q(fe){try{ae(A.next(fe))}catch(ve){K(ve)}}function te(fe){try{ae(A.throw(fe))}catch(ve){K(ve)}}function ae(fe){fe.done?z(fe.value):L(fe.value).then(Q,te)}ae((A=A.apply(xe,w||[])).next())})};class X{constructor(w,_=500,A){this.reader=w,this.timeBetweenScansMillis=_,this._hints=A,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(w){this._timeBetweenDecodingAttempts=w<0?0:w}set hints(w){this._hints=w||null}get hints(){return this._hints}listVideoInputDevices(){return $(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const w=yield navigator.mediaDevices.enumerateDevices(),_=[];for(const A of w){const L=A.kind==="video"?"videoinput":A.kind;if(L!=="videoinput")continue;const z=A.deviceId||A.id,K=A.label||`Video device ${_.length+1}`,Q=A.groupId,te={deviceId:z,label:K,kind:L,groupId:Q};_.push(te)}return _})}getVideoInputDevices(){return $(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(_=>new U(_.deviceId,_.label))})}findDeviceById(w){return $(this,void 0,void 0,function*(){const _=yield this.listVideoInputDevices();return _?_.find(A=>A.deviceId===w):null})}decodeFromInputVideoDevice(w,_){return $(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(w,_)})}decodeOnceFromVideoDevice(w,_){return $(this,void 0,void 0,function*(){this.reset();let A;w?A={deviceId:{exact:w}}:A={facingMode:"environment"};const L={video:A};return yield this.decodeOnceFromConstraints(L,_)})}decodeOnceFromConstraints(w,_){return $(this,void 0,void 0,function*(){const A=yield navigator.mediaDevices.getUserMedia(w);return yield this.decodeOnceFromStream(A,_)})}decodeOnceFromStream(w,_){return $(this,void 0,void 0,function*(){this.reset();const A=yield this.attachStreamToVideo(w,_);return yield this.decodeOnce(A)})}decodeFromInputVideoDeviceContinuously(w,_,A){return $(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(w,_,A)})}decodeFromVideoDevice(w,_,A){return $(this,void 0,void 0,function*(){let L;w?L={deviceId:{exact:w}}:L={facingMode:"environment"};const z={video:L};return yield this.decodeFromConstraints(z,_,A)})}decodeFromConstraints(w,_,A){return $(this,void 0,void 0,function*(){const L=yield navigator.mediaDevices.getUserMedia(w);return yield this.decodeFromStream(L,_,A)})}decodeFromStream(w,_,A){return $(this,void 0,void 0,function*(){this.reset();const L=yield this.attachStreamToVideo(w,_);return yield this.decodeContinuously(L,A)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(w,_){return $(this,void 0,void 0,function*(){const A=this.prepareVideoElement(_);return this.addVideoSource(A,w),this.videoElement=A,this.stream=w,yield this.playVideoOnLoadAsync(A),A})}playVideoOnLoadAsync(w){return new Promise((_,A)=>this.playVideoOnLoad(w,()=>_()))}playVideoOnLoad(w,_){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(w),w.addEventListener("ended",this.videoEndedListener),w.addEventListener("canplay",this.videoCanPlayListener),w.addEventListener("playing",_),this.tryPlayVideo(w)}isVideoPlaying(w){return w.currentTime>0&&!w.paused&&!w.ended&&w.readyState>2}tryPlayVideo(w){return $(this,void 0,void 0,function*(){if(this.isVideoPlaying(w)){console.warn("Trying to play video that is already playing.");return}try{yield w.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(w,_){const A=document.getElementById(w);if(!A)throw new u(`element with id '${w}' not found`);if(A.nodeName.toLowerCase()!==_.toLowerCase())throw new u(`element with id '${w}' must be an ${_} element`);return A}decodeFromImage(w,_){if(!w&&!_)throw new u("either imageElement with a src set or an url must be provided");return _&&!w?this.decodeFromImageUrl(_):this.decodeFromImageElement(w)}decodeFromVideo(w,_){if(!w&&!_)throw new u("Either an element with a src set or an URL must be provided");return _&&!w?this.decodeFromVideoUrl(_):this.decodeFromVideoElement(w)}decodeFromVideoContinuously(w,_,A){if(w===void 0&&_===void 0)throw new u("Either an element with a src set or an URL must be provided");return _&&!w?this.decodeFromVideoUrlContinuously(_,A):this.decodeFromVideoElementContinuously(w,A)}decodeFromImageElement(w){if(!w)throw new u("An image element must be provided.");this.reset();const _=this.prepareImageElement(w);this.imageElement=_;let A;return this.isImageLoaded(_)?A=this.decodeOnce(_,!1,!0):A=this._decodeOnLoadImage(_),A}decodeFromVideoElement(w){const _=this._decodeFromVideoElementSetup(w);return this._decodeOnLoadVideo(_)}decodeFromVideoElementContinuously(w,_){const A=this._decodeFromVideoElementSetup(w);return this._decodeOnLoadVideoContinuously(A,_)}_decodeFromVideoElementSetup(w){if(!w)throw new u("A video element must be provided.");this.reset();const _=this.prepareVideoElement(w);return this.videoElement=_,_}decodeFromImageUrl(w){if(!w)throw new u("An URL must be provided.");this.reset();const _=this.prepareImageElement();this.imageElement=_;const A=this._decodeOnLoadImage(_);return _.src=w,A}decodeFromVideoUrl(w){if(!w)throw new u("An URL must be provided.");this.reset();const _=this.prepareVideoElement(),A=this.decodeFromVideoElement(_);return _.src=w,A}decodeFromVideoUrlContinuously(w,_){if(!w)throw new u("An URL must be provided.");this.reset();const A=this.prepareVideoElement(),L=this.decodeFromVideoElementContinuously(A,_);return A.src=w,L}_decodeOnLoadImage(w){return new Promise((_,A)=>{this.imageLoadedListener=()=>this.decodeOnce(w,!1,!0).then(_,A),w.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(w){return $(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(w),yield this.decodeOnce(w)})}_decodeOnLoadVideoContinuously(w,_){return $(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(w),this.decodeContinuously(w,_)})}isImageLoaded(w){return!(!w.complete||w.naturalWidth===0)}prepareImageElement(w){let _;return typeof w>"u"&&(_=document.createElement("img"),_.width=200,_.height=200),typeof w=="string"&&(_=this.getMediaElement(w,"img")),w instanceof HTMLImageElement&&(_=w),_}prepareVideoElement(w){let _;return!w&&typeof document<"u"&&(_=document.createElement("video"),_.width=200,_.height=200),typeof w=="string"&&(_=this.getMediaElement(w,"video")),w instanceof HTMLVideoElement&&(_=w),_.setAttribute("autoplay","true"),_.setAttribute("muted","true"),_.setAttribute("playsinline","true"),_}decodeOnce(w,_=!0,A=!0){this._stopAsyncDecode=!1;const L=(z,K)=>{if(this._stopAsyncDecode){K(new S("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const Q=this.decode(w);z(Q)}catch(Q){const te=_&&Q instanceof S,fe=(Q instanceof m||Q instanceof R)&&A;if(te||fe)return setTimeout(L,this._timeBetweenDecodingAttempts,z,K);K(Q)}};return new Promise((z,K)=>L(z,K))}decodeContinuously(w,_){this._stopContinuousDecode=!1;const A=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const L=this.decode(w);_(L,null),setTimeout(A,this.timeBetweenScansMillis)}catch(L){_(null,L);const z=L instanceof m||L instanceof R,K=L instanceof S;(z||K)&&setTimeout(A,this._timeBetweenDecodingAttempts)}};A()}decode(w){const _=this.createBinaryBitmap(w);return this.decodeBitmap(_)}_isHTMLVideoElement(w){return w.videoWidth!==0}drawFrameOnCanvas(w,_,A){_||(_={sx:0,sy:0,sWidth:w.videoWidth,sHeight:w.videoHeight,dx:0,dy:0,dWidth:w.videoWidth,dHeight:w.videoHeight}),A||(A=this.captureCanvasContext),A.drawImage(w,_.sx,_.sy,_.sWidth,_.sHeight,_.dx,_.dy,_.dWidth,_.dHeight)}drawImageOnCanvas(w,_,A=this.captureCanvasContext){_||(_={sx:0,sy:0,sWidth:w.naturalWidth,sHeight:w.naturalHeight,dx:0,dy:0,dWidth:w.naturalWidth,dHeight:w.naturalHeight}),A||(A=this.captureCanvasContext),A.drawImage(w,_.sx,_.sy,_.sWidth,_.sHeight,_.dx,_.dy,_.dWidth,_.dHeight)}createBinaryBitmap(w){this.getCaptureCanvasContext(w),this._isHTMLVideoElement(w)?this.drawFrameOnCanvas(w):this.drawImageOnCanvas(w);const _=this.getCaptureCanvas(w),A=new M(_),L=new N(A);return new f(L)}getCaptureCanvasContext(w){if(!this.captureCanvasContext){const A=this.getCaptureCanvas(w).getContext("2d");this.captureCanvasContext=A}return this.captureCanvasContext}getCaptureCanvas(w){if(!this.captureCanvas){const _=this.createCaptureCanvas(w);this.captureCanvas=_}return this.captureCanvas}decodeBitmap(w){return this.reader.decode(w,this._hints)}createCaptureCanvas(w){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const _=document.createElement("canvas");let A,L;return typeof w<"u"&&(w instanceof HTMLVideoElement?(A=w.videoWidth,L=w.videoHeight):w instanceof HTMLImageElement&&(A=w.naturalWidth||w.width,L=w.naturalHeight||w.height)),_.style.width=A+"px",_.style.height=L+"px",_.width=A,_.height=L,_}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(w=>w.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(w,_){try{w.srcObject=_}catch{w.src=URL.createObjectURL(_)}}cleanVideoSource(w){try{w.srcObject=null}catch{w.src=""}this.videoElement.removeAttribute("src")}}class Z{constructor(w,_,A=_==null?0:8*_.length,L,z,K=g.currentTimeMillis()){this.text=w,this.rawBytes=_,this.numBits=A,this.resultPoints=L,this.format=z,this.timestamp=K,this.text=w,this.rawBytes=_,A==null?this.numBits=_==null?0:8*_.length:this.numBits=A,this.resultPoints=L,this.format=z,this.resultMetadata=null,K==null?this.timestamp=g.currentTimeMillis():this.timestamp=K}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(w,_){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(w,_)}putAllMetadata(w){w!==null&&(this.resultMetadata===null?this.resultMetadata=w:this.resultMetadata=new Map(w))}addResultPoints(w){const _=this.resultPoints;if(_===null)this.resultPoints=w;else if(w!==null&&w.length>0){const A=new Array(_.length+w.length);g.arraycopy(_,0,A,0,_.length),g.arraycopy(w,0,A,_.length,w.length),this.resultPoints=A}}getTimestamp(){return this.timestamp}toString(){return this.text}}var re;(function(xe){xe[xe.AZTEC=0]="AZTEC",xe[xe.CODABAR=1]="CODABAR",xe[xe.CODE_39=2]="CODE_39",xe[xe.CODE_93=3]="CODE_93",xe[xe.CODE_128=4]="CODE_128",xe[xe.DATA_MATRIX=5]="DATA_MATRIX",xe[xe.EAN_8=6]="EAN_8",xe[xe.EAN_13=7]="EAN_13",xe[xe.ITF=8]="ITF",xe[xe.MAXICODE=9]="MAXICODE",xe[xe.PDF_417=10]="PDF_417",xe[xe.QR_CODE=11]="QR_CODE",xe[xe.RSS_14=12]="RSS_14",xe[xe.RSS_EXPANDED=13]="RSS_EXPANDED",xe[xe.UPC_A=14]="UPC_A",xe[xe.UPC_E=15]="UPC_E",xe[xe.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(re||(re={}));var W=re,J;(function(xe){xe[xe.OTHER=0]="OTHER",xe[xe.ORIENTATION=1]="ORIENTATION",xe[xe.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",xe[xe.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",xe[xe.ISSUE_NUMBER=4]="ISSUE_NUMBER",xe[xe.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",xe[xe.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",xe[xe.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",xe[xe.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",xe[xe.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",xe[xe.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(J||(J={}));var V=J;class H{constructor(w,_,A,L,z=-1,K=-1){this.rawBytes=w,this.text=_,this.byteSegments=A,this.ecLevel=L,this.structuredAppendSequenceNumber=z,this.structuredAppendParity=K,this.numBits=w==null?0:8*w.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(w){this.numBits=w}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(w){this.errorsCorrected=w}getErasures(){return this.erasures}setErasures(w){this.erasures=w}getOther(){return this.other}setOther(w){this.other=w}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class ee{exp(w){return this.expTable[w]}log(w){if(w===0)throw new h;return this.logTable[w]}static addOrSubtract(w,_){return w^_}}class ie{constructor(w,_){if(_.length===0)throw new h;this.field=w;const A=_.length;if(A>1&&_[0]===0){let L=1;for(;L<A&&_[L]===0;)L++;L===A?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(A-L),g.arraycopy(_,L,this.coefficients,0,this.coefficients.length))}else this.coefficients=_}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(w){return this.coefficients[this.coefficients.length-1-w]}evaluateAt(w){if(w===0)return this.getCoefficient(0);const _=this.coefficients;let A;if(w===1){A=0;for(let K=0,Q=_.length;K!==Q;K++){const te=_[K];A=ee.addOrSubtract(A,te)}return A}A=_[0];const L=_.length,z=this.field;for(let K=1;K<L;K++)A=ee.addOrSubtract(z.multiply(w,A),_[K]);return A}addOrSubtract(w){if(!this.field.equals(w.field))throw new h("GenericGFPolys do not have same GenericGF field");if(this.isZero())return w;if(w.isZero())return this;let _=this.coefficients,A=w.coefficients;if(_.length>A.length){const K=_;_=A,A=K}let L=new Int32Array(A.length);const z=A.length-_.length;g.arraycopy(A,0,L,0,z);for(let K=z;K<A.length;K++)L[K]=ee.addOrSubtract(_[K-z],A[K]);return new ie(this.field,L)}multiply(w){if(!this.field.equals(w.field))throw new h("GenericGFPolys do not have same GenericGF field");if(this.isZero()||w.isZero())return this.field.getZero();const _=this.coefficients,A=_.length,L=w.coefficients,z=L.length,K=new Int32Array(A+z-1),Q=this.field;for(let te=0;te<A;te++){const ae=_[te];for(let fe=0;fe<z;fe++)K[te+fe]=ee.addOrSubtract(K[te+fe],Q.multiply(ae,L[fe]))}return new ie(Q,K)}multiplyScalar(w){if(w===0)return this.field.getZero();if(w===1)return this;const _=this.coefficients.length,A=this.field,L=new Int32Array(_),z=this.coefficients;for(let K=0;K<_;K++)L[K]=A.multiply(z[K],w);return new ie(A,L)}multiplyByMonomial(w,_){if(w<0)throw new h;if(_===0)return this.field.getZero();const A=this.coefficients,L=A.length,z=new Int32Array(L+w),K=this.field;for(let Q=0;Q<L;Q++)z[Q]=K.multiply(A[Q],_);return new ie(K,z)}divide(w){if(!this.field.equals(w.field))throw new h("GenericGFPolys do not have same GenericGF field");if(w.isZero())throw new h("Divide by 0");const _=this.field;let A=_.getZero(),L=this;const z=w.getCoefficient(w.getDegree()),K=_.inverse(z);for(;L.getDegree()>=w.getDegree()&&!L.isZero();){const Q=L.getDegree()-w.getDegree(),te=_.multiply(L.getCoefficient(L.getDegree()),K),ae=w.multiplyByMonomial(Q,te),fe=_.buildMonomial(Q,te);A=A.addOrSubtract(fe),L=L.addOrSubtract(ae)}return[A,L]}toString(){let w="";for(let _=this.getDegree();_>=0;_--){let A=this.getCoefficient(_);if(A!==0){if(A<0?(w+=" - ",A=-A):w.length>0&&(w+=" + "),_===0||A!==1){const L=this.field.log(A);L===0?w+="1":L===1?w+="a":(w+="a^",w+=L)}_!==0&&(_===1?w+="x":(w+="x^",w+=_))}}return w}}class oe extends c{}oe.kind="ArithmeticException";class se extends ee{constructor(w,_,A){super(),this.primitive=w,this.size=_,this.generatorBase=A;const L=new Int32Array(_);let z=1;for(let Q=0;Q<_;Q++)L[Q]=z,z*=2,z>=_&&(z^=w,z&=_-1);this.expTable=L;const K=new Int32Array(_);for(let Q=0;Q<_-1;Q++)K[L[Q]]=Q;this.logTable=K,this.zero=new ie(this,Int32Array.from([0])),this.one=new ie(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(w,_){if(w<0)throw new h;if(_===0)return this.zero;const A=new Int32Array(w+1);return A[0]=_,new ie(this,A)}inverse(w){if(w===0)throw new oe;return this.expTable[this.size-this.logTable[w]-1]}multiply(w,_){return w===0||_===0?0:this.expTable[(this.logTable[w]+this.logTable[_])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+b.toHexString(this.primitive)+","+this.size+")"}equals(w){return w===this}}se.AZTEC_DATA_12=new se(4201,4096,1),se.AZTEC_DATA_10=new se(1033,1024,1),se.AZTEC_DATA_6=new se(67,64,1),se.AZTEC_PARAM=new se(19,16,1),se.QR_CODE_FIELD_256=new se(285,256,0),se.DATA_MATRIX_FIELD_256=new se(301,256,1),se.AZTEC_DATA_8=se.DATA_MATRIX_FIELD_256,se.MAXICODE_FIELD_64=se.AZTEC_DATA_6;class ue extends c{}ue.kind="ReedSolomonException";class pe extends c{}pe.kind="IllegalStateException";class ce{constructor(w){this.field=w}decode(w,_){const A=this.field,L=new ie(A,w),z=new Int32Array(_);let K=!0;for(let Te=0;Te<_;Te++){const Ve=L.evaluateAt(A.exp(Te+A.getGeneratorBase()));z[z.length-1-Te]=Ve,Ve!==0&&(K=!1)}if(K)return;const Q=new ie(A,z),te=this.runEuclideanAlgorithm(A.buildMonomial(_,1),Q,_),ae=te[0],fe=te[1],ve=this.findErrorLocations(ae),we=this.findErrorMagnitudes(fe,ve);for(let Te=0;Te<ve.length;Te++){const Ve=w.length-1-A.log(ve[Te]);if(Ve<0)throw new ue("Bad error location");w[Ve]=se.addOrSubtract(w[Ve],we[Te])}}runEuclideanAlgorithm(w,_,A){if(w.getDegree()<_.getDegree()){const Te=w;w=_,_=Te}const L=this.field;let z=w,K=_,Q=L.getZero(),te=L.getOne();for(;K.getDegree()>=(A/2|0);){let Te=z,Ve=Q;if(z=K,Q=te,z.isZero())throw new ue("r_{i-1} was zero");K=Te;let We=L.getZero();const at=z.getCoefficient(z.getDegree()),pt=L.inverse(at);for(;K.getDegree()>=z.getDegree()&&!K.isZero();){const $t=K.getDegree()-z.getDegree(),zt=L.multiply(K.getCoefficient(K.getDegree()),pt);We=We.addOrSubtract(L.buildMonomial($t,zt)),K=K.addOrSubtract(z.multiplyByMonomial($t,zt))}if(te=We.multiply(Q).addOrSubtract(Ve),K.getDegree()>=z.getDegree())throw new pe("Division algorithm failed to reduce polynomial?")}const ae=te.getCoefficient(0);if(ae===0)throw new ue("sigmaTilde(0) was zero");const fe=L.inverse(ae),ve=te.multiplyScalar(fe),we=K.multiplyScalar(fe);return[ve,we]}findErrorLocations(w){const _=w.getDegree();if(_===1)return Int32Array.from([w.getCoefficient(1)]);const A=new Int32Array(_);let L=0;const z=this.field;for(let K=1;K<z.getSize()&&L<_;K++)w.evaluateAt(K)===0&&(A[L]=z.inverse(K),L++);if(L!==_)throw new ue("Error locator degree does not match number of roots");return A}findErrorMagnitudes(w,_){const A=_.length,L=new Int32Array(A),z=this.field;for(let K=0;K<A;K++){const Q=z.inverse(_[K]);let te=1;for(let ae=0;ae<A;ae++)if(K!==ae){const fe=z.multiply(_[ae],Q),ve=fe&1?fe&-2:fe|1;te=z.multiply(te,ve)}L[K]=z.multiply(w.evaluateAt(Q),z.inverse(te)),z.getGeneratorBase()!==0&&(L[K]=z.multiply(L[K],Q))}return L}}var ne;(function(xe){xe[xe.UPPER=0]="UPPER",xe[xe.LOWER=1]="LOWER",xe[xe.MIXED=2]="MIXED",xe[xe.DIGIT=3]="DIGIT",xe[xe.PUNCT=4]="PUNCT",xe[xe.BINARY=5]="BINARY"})(ne||(ne={}));class me{decode(w){this.ddata=w;let _=w.getBits(),A=this.extractBits(_),L=this.correctBits(A),z=me.convertBoolArrayToByteArray(L),K=me.getEncodedData(L),Q=new H(z,K,null,null);return Q.setNumBits(L.length),Q}static highLevelDecode(w){return this.getEncodedData(w)}static getEncodedData(w){let _=w.length,A=ne.UPPER,L=ne.UPPER,z="",K=0;for(;K<_;)if(L===ne.BINARY){if(_-K<5)break;let Q=me.readCode(w,K,5);if(K+=5,Q===0){if(_-K<11)break;Q=me.readCode(w,K,11)+31,K+=11}for(let te=0;te<Q;te++){if(_-K<8){K=_;break}const ae=me.readCode(w,K,8);z+=G.castAsNonUtf8Char(ae),K+=8}L=A}else{let Q=L===ne.DIGIT?4:5;if(_-K<Q)break;let te=me.readCode(w,K,Q);K+=Q;let ae=me.getCharacter(L,te);ae.startsWith("CTRL_")?(A=L,L=me.getTable(ae.charAt(5)),ae.charAt(6)==="L"&&(A=L)):(z+=ae,L=A)}return z}static getTable(w){switch(w){case"L":return ne.LOWER;case"P":return ne.PUNCT;case"M":return ne.MIXED;case"D":return ne.DIGIT;case"B":return ne.BINARY;case"U":default:return ne.UPPER}}static getCharacter(w,_){switch(w){case ne.UPPER:return me.UPPER_TABLE[_];case ne.LOWER:return me.LOWER_TABLE[_];case ne.MIXED:return me.MIXED_TABLE[_];case ne.PUNCT:return me.PUNCT_TABLE[_];case ne.DIGIT:return me.DIGIT_TABLE[_];default:throw new pe("Bad table")}}correctBits(w){let _,A;this.ddata.getNbLayers()<=2?(A=6,_=se.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(A=8,_=se.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(A=10,_=se.AZTEC_DATA_10):(A=12,_=se.AZTEC_DATA_12);let L=this.ddata.getNbDatablocks(),z=w.length/A;if(z<L)throw new R;let K=w.length%A,Q=new Int32Array(z);for(let we=0;we<z;we++,K+=A)Q[we]=me.readCode(w,K,A);try{new ce(_).decode(Q,z-L)}catch(we){throw new R(we)}let te=(1<<A)-1,ae=0;for(let we=0;we<L;we++){let Te=Q[we];if(Te===0||Te===te)throw new R;(Te===1||Te===te-1)&&ae++}let fe=new Array(L*A-ae),ve=0;for(let we=0;we<L;we++){let Te=Q[we];if(Te===1||Te===te-1)fe.fill(Te>1,ve,ve+A-1),ve+=A-1;else for(let Ve=A-1;Ve>=0;--Ve)fe[ve++]=(Te&1<<Ve)!==0}return fe}extractBits(w){let _=this.ddata.isCompact(),A=this.ddata.getNbLayers(),L=(_?11:14)+A*4,z=new Int32Array(L),K=new Array(this.totalBitsInLayer(A,_));if(_)for(let Q=0;Q<z.length;Q++)z[Q]=Q;else{let Q=L+1+2*b.truncDivision(b.truncDivision(L,2)-1,15),te=L/2,ae=b.truncDivision(Q,2);for(let fe=0;fe<te;fe++){let ve=fe+b.truncDivision(fe,15);z[te-fe-1]=ae-ve-1,z[te+fe]=ae+ve+1}}for(let Q=0,te=0;Q<A;Q++){let ae=(A-Q)*4+(_?9:12),fe=Q*2,ve=L-1-fe;for(let we=0;we<ae;we++){let Te=we*2;for(let Ve=0;Ve<2;Ve++)K[te+Te+Ve]=w.get(z[fe+Ve],z[fe+we]),K[te+2*ae+Te+Ve]=w.get(z[fe+we],z[ve-Ve]),K[te+4*ae+Te+Ve]=w.get(z[ve-Ve],z[ve-we]),K[te+6*ae+Te+Ve]=w.get(z[ve-we],z[fe+Ve])}te+=ae*8}return K}static readCode(w,_,A){let L=0;for(let z=_;z<_+A;z++)L<<=1,w[z]&&(L|=1);return L}static readByte(w,_){let A=w.length-_;return A>=8?me.readCode(w,_,8):me.readCode(w,_,A)<<8-A}static convertBoolArrayToByteArray(w){let _=new Uint8Array((w.length+7)/8);for(let A=0;A<_.length;A++)_[A]=me.readByte(w,8*A);return _}totalBitsInLayer(w,_){return((_?88:112)+16*w)*w}}me.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],me.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],me.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],me.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],me.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class ge{constructor(){}static round(w){return w===NaN?0:w<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:w>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:w+(w<0?-.5:.5)|0}static distance(w,_,A,L){const z=w-A,K=_-L;return Math.sqrt(z*z+K*K)}static sum(w){let _=0;for(let A=0,L=w.length;A!==L;A++){const z=w[A];_+=z}return _}}class _e{static floatToIntBits(w){return w}}_e.MAX_VALUE=Number.MAX_SAFE_INTEGER;class be{constructor(w,_){this.x=w,this.y=_}getX(){return this.x}getY(){return this.y}equals(w){if(w instanceof be){const _=w;return this.x===_.x&&this.y===_.y}return!1}hashCode(){return 31*_e.floatToIntBits(this.x)+_e.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(w){const _=this.distance(w[0],w[1]),A=this.distance(w[1],w[2]),L=this.distance(w[0],w[2]);let z,K,Q;if(A>=_&&A>=L?(K=w[0],z=w[1],Q=w[2]):L>=A&&L>=_?(K=w[1],z=w[0],Q=w[2]):(K=w[2],z=w[0],Q=w[1]),this.crossProductZ(z,K,Q)<0){const te=z;z=Q,Q=te}w[0]=z,w[1]=K,w[2]=Q}static distance(w,_){return ge.distance(w.x,w.y,_.x,_.y)}static crossProductZ(w,_,A){const L=_.x,z=_.y;return(A.x-L)*(w.y-z)-(A.y-z)*(w.x-L)}}class ye{constructor(w,_){this.bits=w,this.points=_}getBits(){return this.bits}getPoints(){return this.points}}class Oe extends ye{constructor(w,_,A,L,z){super(w,_),this.compact=A,this.nbDatablocks=L,this.nbLayers=z}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Ne{constructor(w,_,A,L){this.image=w,this.height=w.getHeight(),this.width=w.getWidth(),_==null&&(_=Ne.INIT_SIZE),A==null&&(A=w.getWidth()/2|0),L==null&&(L=w.getHeight()/2|0);const z=_/2|0;if(this.leftInit=A-z,this.rightInit=A+z,this.upInit=L-z,this.downInit=L+z,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new S}detect(){let w=this.leftInit,_=this.rightInit,A=this.upInit,L=this.downInit,z=!1,K=!0,Q=!1,te=!1,ae=!1,fe=!1,ve=!1;const we=this.width,Te=this.height;for(;K;){K=!1;let Ve=!0;for(;(Ve||!te)&&_<we;)Ve=this.containsBlackPoint(A,L,_,!1),Ve?(_++,K=!0,te=!0):te||_++;if(_>=we){z=!0;break}let We=!0;for(;(We||!ae)&&L<Te;)We=this.containsBlackPoint(w,_,L,!0),We?(L++,K=!0,ae=!0):ae||L++;if(L>=Te){z=!0;break}let at=!0;for(;(at||!fe)&&w>=0;)at=this.containsBlackPoint(A,L,w,!1),at?(w--,K=!0,fe=!0):fe||w--;if(w<0){z=!0;break}let pt=!0;for(;(pt||!ve)&&A>=0;)pt=this.containsBlackPoint(w,_,A,!0),pt?(A--,K=!0,ve=!0):ve||A--;if(A<0){z=!0;break}K&&(Q=!0)}if(!z&&Q){const Ve=_-w;let We=null;for(let zt=1;We===null&&zt<Ve;zt++)We=this.getBlackPointOnSegment(w,L-zt,w+zt,L);if(We==null)throw new S;let at=null;for(let zt=1;at===null&&zt<Ve;zt++)at=this.getBlackPointOnSegment(w,A+zt,w+zt,A);if(at==null)throw new S;let pt=null;for(let zt=1;pt===null&&zt<Ve;zt++)pt=this.getBlackPointOnSegment(_,A+zt,_-zt,A);if(pt==null)throw new S;let $t=null;for(let zt=1;$t===null&&zt<Ve;zt++)$t=this.getBlackPointOnSegment(_,L-zt,_-zt,L);if($t==null)throw new S;return this.centerEdges($t,We,pt,at)}else throw new S}getBlackPointOnSegment(w,_,A,L){const z=ge.round(ge.distance(w,_,A,L)),K=(A-w)/z,Q=(L-_)/z,te=this.image;for(let ae=0;ae<z;ae++){const fe=ge.round(w+ae*K),ve=ge.round(_+ae*Q);if(te.get(fe,ve))return new be(fe,ve)}return null}centerEdges(w,_,A,L){const z=w.getX(),K=w.getY(),Q=_.getX(),te=_.getY(),ae=A.getX(),fe=A.getY(),ve=L.getX(),we=L.getY(),Te=Ne.CORR;return z<this.width/2?[new be(ve-Te,we+Te),new be(Q+Te,te+Te),new be(ae-Te,fe-Te),new be(z+Te,K-Te)]:[new be(ve+Te,we+Te),new be(Q+Te,te-Te),new be(ae-Te,fe+Te),new be(z-Te,K-Te)]}containsBlackPoint(w,_,A,L){const z=this.image;if(L){for(let K=w;K<=_;K++)if(z.get(K,A))return!0}else for(let K=w;K<=_;K++)if(z.get(A,K))return!0;return!1}}Ne.INIT_SIZE=10,Ne.CORR=1;class De{static checkAndNudgePoints(w,_){const A=w.getWidth(),L=w.getHeight();let z=!0;for(let K=0;K<_.length&&z;K+=2){const Q=Math.floor(_[K]),te=Math.floor(_[K+1]);if(Q<-1||Q>A||te<-1||te>L)throw new S;z=!1,Q===-1?(_[K]=0,z=!0):Q===A&&(_[K]=A-1,z=!0),te===-1?(_[K+1]=0,z=!0):te===L&&(_[K+1]=L-1,z=!0)}z=!0;for(let K=_.length-2;K>=0&&z;K-=2){const Q=Math.floor(_[K]),te=Math.floor(_[K+1]);if(Q<-1||Q>A||te<-1||te>L)throw new S;z=!1,Q===-1?(_[K]=0,z=!0):Q===A&&(_[K]=A-1,z=!0),te===-1?(_[K+1]=0,z=!0):te===L&&(_[K+1]=L-1,z=!0)}}}class Ge{constructor(w,_,A,L,z,K,Q,te,ae){this.a11=w,this.a21=_,this.a31=A,this.a12=L,this.a22=z,this.a32=K,this.a13=Q,this.a23=te,this.a33=ae}static quadrilateralToQuadrilateral(w,_,A,L,z,K,Q,te,ae,fe,ve,we,Te,Ve,We,at){const pt=Ge.quadrilateralToSquare(w,_,A,L,z,K,Q,te);return Ge.squareToQuadrilateral(ae,fe,ve,we,Te,Ve,We,at).times(pt)}transformPoints(w){const _=w.length,A=this.a11,L=this.a12,z=this.a13,K=this.a21,Q=this.a22,te=this.a23,ae=this.a31,fe=this.a32,ve=this.a33;for(let we=0;we<_;we+=2){const Te=w[we],Ve=w[we+1],We=z*Te+te*Ve+ve;w[we]=(A*Te+K*Ve+ae)/We,w[we+1]=(L*Te+Q*Ve+fe)/We}}transformPointsWithValues(w,_){const A=this.a11,L=this.a12,z=this.a13,K=this.a21,Q=this.a22,te=this.a23,ae=this.a31,fe=this.a32,ve=this.a33,we=w.length;for(let Te=0;Te<we;Te++){const Ve=w[Te],We=_[Te],at=z*Ve+te*We+ve;w[Te]=(A*Ve+K*We+ae)/at,_[Te]=(L*Ve+Q*We+fe)/at}}static squareToQuadrilateral(w,_,A,L,z,K,Q,te){const ae=w-A+z-Q,fe=_-L+K-te;if(ae===0&&fe===0)return new Ge(A-w,z-A,w,L-_,K-L,_,0,0,1);{const ve=A-z,we=Q-z,Te=L-K,Ve=te-K,We=ve*Ve-we*Te,at=(ae*Ve-we*fe)/We,pt=(ve*fe-ae*Te)/We;return new Ge(A-w+at*A,Q-w+pt*Q,w,L-_+at*L,te-_+pt*te,_,at,pt,1)}}static quadrilateralToSquare(w,_,A,L,z,K,Q,te){return Ge.squareToQuadrilateral(w,_,A,L,z,K,Q,te).buildAdjoint()}buildAdjoint(){return new Ge(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(w){return new Ge(this.a11*w.a11+this.a21*w.a12+this.a31*w.a13,this.a11*w.a21+this.a21*w.a22+this.a31*w.a23,this.a11*w.a31+this.a21*w.a32+this.a31*w.a33,this.a12*w.a11+this.a22*w.a12+this.a32*w.a13,this.a12*w.a21+this.a22*w.a22+this.a32*w.a23,this.a12*w.a31+this.a22*w.a32+this.a32*w.a33,this.a13*w.a11+this.a23*w.a12+this.a33*w.a13,this.a13*w.a21+this.a23*w.a22+this.a33*w.a23,this.a13*w.a31+this.a23*w.a32+this.a33*w.a33)}}class Qe extends De{sampleGrid(w,_,A,L,z,K,Q,te,ae,fe,ve,we,Te,Ve,We,at,pt,$t,zt){const Mt=Ge.quadrilateralToQuadrilateral(L,z,K,Q,te,ae,fe,ve,we,Te,Ve,We,at,pt,$t,zt);return this.sampleGridWithTransform(w,_,A,Mt)}sampleGridWithTransform(w,_,A,L){if(_<=0||A<=0)throw new S;const z=new F(_,A),K=new Float32Array(2*_);for(let Q=0;Q<A;Q++){const te=K.length,ae=Q+.5;for(let fe=0;fe<te;fe+=2)K[fe]=fe/2+.5,K[fe+1]=ae;L.transformPoints(K),De.checkAndNudgePoints(w,K);try{for(let fe=0;fe<te;fe+=2)w.get(Math.floor(K[fe]),Math.floor(K[fe+1]))&&z.set(fe/2,Q)}catch{throw new S}}return z}}class Ie{static setGridSampler(w){Ie.gridSampler=w}static getInstance(){return Ie.gridSampler}}Ie.gridSampler=new Qe;class Ae{constructor(w,_){this.x=w,this.y=_}toResultPoint(){return new be(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class st{constructor(w){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=w}detect(){return this.detectMirror(!1)}detectMirror(w){let _=this.getMatrixCenter(),A=this.getBullsEyeCorners(_);if(w){let K=A[0];A[0]=A[2],A[2]=K}this.extractParameters(A);let L=this.sampleGrid(this.image,A[this.shift%4],A[(this.shift+1)%4],A[(this.shift+2)%4],A[(this.shift+3)%4]),z=this.getMatrixCornerPoints(A);return new Oe(L,z,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(w){if(!this.isValidPoint(w[0])||!this.isValidPoint(w[1])||!this.isValidPoint(w[2])||!this.isValidPoint(w[3]))throw new S;let _=2*this.nbCenterLayers,A=new Int32Array([this.sampleLine(w[0],w[1],_),this.sampleLine(w[1],w[2],_),this.sampleLine(w[2],w[3],_),this.sampleLine(w[3],w[0],_)]);this.shift=this.getRotation(A,_);let L=0;for(let K=0;K<4;K++){let Q=A[(this.shift+K)%4];this.compact?(L<<=7,L+=Q>>1&127):(L<<=10,L+=(Q>>2&992)+(Q>>1&31))}let z=this.getCorrectedParameterData(L,this.compact);this.compact?(this.nbLayers=(z>>6)+1,this.nbDataBlocks=(z&63)+1):(this.nbLayers=(z>>11)+1,this.nbDataBlocks=(z&2047)+1)}getRotation(w,_){let A=0;w.forEach((L,z,K)=>{let Q=(L>>_-2<<1)+(L&1);A=(A<<3)+Q}),A=((A&1)<<11)+(A>>1);for(let L=0;L<4;L++)if(b.bitCount(A^this.EXPECTED_CORNER_BITS[L])<=2)return L;throw new S}getCorrectedParameterData(w,_){let A,L;_?(A=7,L=2):(A=10,L=4);let z=A-L,K=new Int32Array(A);for(let te=A-1;te>=0;--te)K[te]=w&15,w>>=4;try{new ce(se.AZTEC_PARAM).decode(K,z)}catch{throw new S}let Q=0;for(let te=0;te<L;te++)Q=(Q<<4)+K[te];return Q}getBullsEyeCorners(w){let _=w,A=w,L=w,z=w,K=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let ve=this.getFirstDifferent(_,K,1,-1),we=this.getFirstDifferent(A,K,1,1),Te=this.getFirstDifferent(L,K,-1,1),Ve=this.getFirstDifferent(z,K,-1,-1);if(this.nbCenterLayers>2){let We=this.distancePoint(Ve,ve)*this.nbCenterLayers/(this.distancePoint(z,_)*(this.nbCenterLayers+2));if(We<.75||We>1.25||!this.isWhiteOrBlackRectangle(ve,we,Te,Ve))break}_=ve,A=we,L=Te,z=Ve,K=!K}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new S;this.compact=this.nbCenterLayers===5;let Q=new be(_.getX()+.5,_.getY()-.5),te=new be(A.getX()+.5,A.getY()+.5),ae=new be(L.getX()-.5,L.getY()+.5),fe=new be(z.getX()-.5,z.getY()-.5);return this.expandSquare([Q,te,ae,fe],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let w,_,A,L;try{let Q=new Ne(this.image).detect();w=Q[0],_=Q[1],A=Q[2],L=Q[3]}catch{let te=this.image.getWidth()/2,ae=this.image.getHeight()/2;w=this.getFirstDifferent(new Ae(te+7,ae-7),!1,1,-1).toResultPoint(),_=this.getFirstDifferent(new Ae(te+7,ae+7),!1,1,1).toResultPoint(),A=this.getFirstDifferent(new Ae(te-7,ae+7),!1,-1,1).toResultPoint(),L=this.getFirstDifferent(new Ae(te-7,ae-7),!1,-1,-1).toResultPoint()}let z=ge.round((w.getX()+L.getX()+_.getX()+A.getX())/4),K=ge.round((w.getY()+L.getY()+_.getY()+A.getY())/4);try{let Q=new Ne(this.image,15,z,K).detect();w=Q[0],_=Q[1],A=Q[2],L=Q[3]}catch{w=this.getFirstDifferent(new Ae(z+7,K-7),!1,1,-1).toResultPoint(),_=this.getFirstDifferent(new Ae(z+7,K+7),!1,1,1).toResultPoint(),A=this.getFirstDifferent(new Ae(z-7,K+7),!1,-1,1).toResultPoint(),L=this.getFirstDifferent(new Ae(z-7,K-7),!1,-1,-1).toResultPoint()}return z=ge.round((w.getX()+L.getX()+_.getX()+A.getX())/4),K=ge.round((w.getY()+L.getY()+_.getY()+A.getY())/4),new Ae(z,K)}getMatrixCornerPoints(w){return this.expandSquare(w,2*this.nbCenterLayers,this.getDimension())}sampleGrid(w,_,A,L,z){let K=Ie.getInstance(),Q=this.getDimension(),te=Q/2-this.nbCenterLayers,ae=Q/2+this.nbCenterLayers;return K.sampleGrid(w,Q,Q,te,te,ae,te,ae,ae,te,ae,_.getX(),_.getY(),A.getX(),A.getY(),L.getX(),L.getY(),z.getX(),z.getY())}sampleLine(w,_,A){let L=0,z=this.distanceResultPoint(w,_),K=z/A,Q=w.getX(),te=w.getY(),ae=K*(_.getX()-w.getX())/z,fe=K*(_.getY()-w.getY())/z;for(let ve=0;ve<A;ve++)this.image.get(ge.round(Q+ve*ae),ge.round(te+ve*fe))&&(L|=1<<A-ve-1);return L}isWhiteOrBlackRectangle(w,_,A,L){let z=3;w=new Ae(w.getX()-z,w.getY()+z),_=new Ae(_.getX()-z,_.getY()-z),A=new Ae(A.getX()+z,A.getY()-z),L=new Ae(L.getX()+z,L.getY()+z);let K=this.getColor(L,w);if(K===0)return!1;let Q=this.getColor(w,_);return Q!==K||(Q=this.getColor(_,A),Q!==K)?!1:(Q=this.getColor(A,L),Q===K)}getColor(w,_){let A=this.distancePoint(w,_),L=(_.getX()-w.getX())/A,z=(_.getY()-w.getY())/A,K=0,Q=w.getX(),te=w.getY(),ae=this.image.get(w.getX(),w.getY()),fe=Math.ceil(A);for(let we=0;we<fe;we++)Q+=L,te+=z,this.image.get(ge.round(Q),ge.round(te))!==ae&&K++;let ve=K/A;return ve>.1&&ve<.9?0:ve<=.1===ae?1:-1}getFirstDifferent(w,_,A,L){let z=w.getX()+A,K=w.getY()+L;for(;this.isValid(z,K)&&this.image.get(z,K)===_;)z+=A,K+=L;for(z-=A,K-=L;this.isValid(z,K)&&this.image.get(z,K)===_;)z+=A;for(z-=A;this.isValid(z,K)&&this.image.get(z,K)===_;)K+=L;return K-=L,new Ae(z,K)}expandSquare(w,_,A){let L=A/(2*_),z=w[0].getX()-w[2].getX(),K=w[0].getY()-w[2].getY(),Q=(w[0].getX()+w[2].getX())/2,te=(w[0].getY()+w[2].getY())/2,ae=new be(Q+L*z,te+L*K),fe=new be(Q-L*z,te-L*K);z=w[1].getX()-w[3].getX(),K=w[1].getY()-w[3].getY(),Q=(w[1].getX()+w[3].getX())/2,te=(w[1].getY()+w[3].getY())/2;let ve=new be(Q+L*z,te+L*K),we=new be(Q-L*z,te-L*K);return[ae,ve,fe,we]}isValid(w,_){return w>=0&&w<this.image.getWidth()&&_>0&&_<this.image.getHeight()}isValidPoint(w){let _=ge.round(w.getX()),A=ge.round(w.getY());return this.isValid(_,A)}distancePoint(w,_){return ge.distance(w.getX(),w.getY(),_.getX(),_.getY())}distanceResultPoint(w,_){return ge.distance(w.getX(),w.getY(),_.getX(),_.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(b.truncDivision(this.nbLayers-4,8)+1)+15}}class nt{decode(w,_=null){let A=null,L=new st(w.getBlackMatrix()),z=null,K=null;try{let fe=L.detectMirror(!1);z=fe.getPoints(),this.reportFoundResultPoints(_,z),K=new me().decode(fe)}catch(fe){A=fe}if(K==null)try{let fe=L.detectMirror(!0);z=fe.getPoints(),this.reportFoundResultPoints(_,z),K=new me().decode(fe)}catch(fe){throw A??fe}let Q=new Z(K.getText(),K.getRawBytes(),K.getNumBits(),z,W.AZTEC,g.currentTimeMillis()),te=K.getByteSegments();te!=null&&Q.putMetadata(V.BYTE_SEGMENTS,te);let ae=K.getECLevel();return ae!=null&&Q.putMetadata(V.ERROR_CORRECTION_LEVEL,ae),Q}reportFoundResultPoints(w,_){if(w!=null){let A=w.get(O.NEED_RESULT_POINT_CALLBACK);A!=null&&_.forEach((L,z,K)=>{A.foundPossibleResultPoint(L)})}}reset(){}}class vt extends X{constructor(w=500){super(new nt,w)}}class Je{decode(w,_){try{return this.doDecode(w,_)}catch{if(_&&_.get(O.TRY_HARDER)===!0&&w.isRotateSupported()){const z=w.rotateCounterClockwise(),K=this.doDecode(z,_),Q=K.getResultMetadata();let te=270;Q!==null&&Q.get(V.ORIENTATION)===!0&&(te=te+Q.get(V.ORIENTATION)%360),K.putMetadata(V.ORIENTATION,te);const ae=K.getResultPoints();if(ae!==null){const fe=z.getHeight();for(let ve=0;ve<ae.length;ve++)ae[ve]=new be(fe-ae[ve].getY()-1,ae[ve].getX())}return K}else throw new S}}reset(){}doDecode(w,_){const A=w.getWidth(),L=w.getHeight();let z=new j(A);const K=_&&_.get(O.TRY_HARDER)===!0,Q=Math.max(1,L>>(K?8:5));let te;K?te=L:te=15;const ae=Math.trunc(L/2);for(let fe=0;fe<te;fe++){const ve=Math.trunc((fe+1)/2),we=(fe&1)===0,Te=ae+Q*(we?ve:-ve);if(Te<0||Te>=L)break;try{z=w.getBlackRow(Te,z)}catch{continue}for(let Ve=0;Ve<2;Ve++){if(Ve===1&&(z.reverse(),_&&_.get(O.NEED_RESULT_POINT_CALLBACK)===!0)){const We=new Map;_.forEach((at,pt)=>We.set(pt,at)),We.delete(O.NEED_RESULT_POINT_CALLBACK),_=We}try{const We=this.decodeRow(Te,z,_);if(Ve===1){We.putMetadata(V.ORIENTATION,180);const at=We.getResultPoints();at!==null&&(at[0]=new be(A-at[0].getX()-1,at[0].getY()),at[1]=new be(A-at[1].getX()-1,at[1].getY()))}return We}catch{}}}throw new S}static recordPattern(w,_,A){const L=A.length;for(let ae=0;ae<L;ae++)A[ae]=0;const z=w.getSize();if(_>=z)throw new S;let K=!w.get(_),Q=0,te=_;for(;te<z;){if(w.get(te)!==K)A[Q]++;else{if(++Q===L)break;A[Q]=1,K=!K}te++}if(!(Q===L||Q===L-1&&te===z))throw new S}static recordPatternInReverse(w,_,A){let L=A.length,z=w.get(_);for(;_>0&&L>=0;)w.get(--_)!==z&&(L--,z=!z);if(L>=0)throw new S;Je.recordPattern(w,_+1,A)}static patternMatchVariance(w,_,A){const L=w.length;let z=0,K=0;for(let ae=0;ae<L;ae++)z+=w[ae],K+=_[ae];if(z<K)return Number.POSITIVE_INFINITY;const Q=z/K;A*=Q;let te=0;for(let ae=0;ae<L;ae++){const fe=w[ae],ve=_[ae]*Q,we=fe>ve?fe-ve:ve-fe;if(we>A)return Number.POSITIVE_INFINITY;te+=we}return te/z}}class Ue extends Je{static findStartPattern(w){const _=w.getSize(),A=w.getNextSet(0);let L=0,z=Int32Array.from([0,0,0,0,0,0]),K=A,Q=!1;const te=6;for(let ae=A;ae<_;ae++)if(w.get(ae)!==Q)z[L]++;else{if(L===te-1){let fe=Ue.MAX_AVG_VARIANCE,ve=-1;for(let we=Ue.CODE_START_A;we<=Ue.CODE_START_C;we++){const Te=Je.patternMatchVariance(z,Ue.CODE_PATTERNS[we],Ue.MAX_INDIVIDUAL_VARIANCE);Te<fe&&(fe=Te,ve=we)}if(ve>=0&&w.isRange(Math.max(0,K-(ae-K)/2),K,!1))return Int32Array.from([K,ae,ve]);K+=z[0]+z[1],z=z.slice(2,z.length-1),z[L-1]=0,z[L]=0,L--}else L++;z[L]=1,Q=!Q}throw new S}static decodeCode(w,_,A){Je.recordPattern(w,A,_);let L=Ue.MAX_AVG_VARIANCE,z=-1;for(let K=0;K<Ue.CODE_PATTERNS.length;K++){const Q=Ue.CODE_PATTERNS[K],te=this.patternMatchVariance(_,Q,Ue.MAX_INDIVIDUAL_VARIANCE);te<L&&(L=te,z=K)}if(z>=0)return z;throw new S}decodeRow(w,_,A){const L=A&&A.get(O.ASSUME_GS1)===!0,z=Ue.findStartPattern(_),K=z[2];let Q=0;const te=new Uint8Array(20);te[Q++]=K;let ae;switch(K){case Ue.CODE_START_A:ae=Ue.CODE_CODE_A;break;case Ue.CODE_START_B:ae=Ue.CODE_CODE_B;break;case Ue.CODE_START_C:ae=Ue.CODE_CODE_C;break;default:throw new R}let fe=!1,ve=!1,we="",Te=z[0],Ve=z[1];const We=Int32Array.from([0,0,0,0,0,0]);let at=0,pt=0,$t=K,zt=0,Mt=!0,dn=!1,Hr=!1;for(;!fe;){const Rf=ve;switch(ve=!1,at=pt,pt=Ue.decodeCode(_,We,Ve),te[Q++]=pt,pt!==Ue.CODE_STOP&&(Mt=!0),pt!==Ue.CODE_STOP&&(zt++,$t+=zt*pt),Te=Ve,Ve+=We.reduce((mee,pee)=>mee+pee,0),pt){case Ue.CODE_START_A:case Ue.CODE_START_B:case Ue.CODE_START_C:throw new R}switch(ae){case Ue.CODE_CODE_A:if(pt<64)Hr===dn?we+=String.fromCharCode(32+pt):we+=String.fromCharCode(32+pt+128),Hr=!1;else if(pt<96)Hr===dn?we+=String.fromCharCode(pt-64):we+=String.fromCharCode(pt+64),Hr=!1;else switch(pt!==Ue.CODE_STOP&&(Mt=!1),pt){case Ue.CODE_FNC_1:L&&(we.length===0?we+="]C1":we+="");break;case Ue.CODE_FNC_2:case Ue.CODE_FNC_3:break;case Ue.CODE_FNC_4_A:!dn&&Hr?(dn=!0,Hr=!1):dn&&Hr?(dn=!1,Hr=!1):Hr=!0;break;case Ue.CODE_SHIFT:ve=!0,ae=Ue.CODE_CODE_B;break;case Ue.CODE_CODE_B:ae=Ue.CODE_CODE_B;break;case Ue.CODE_CODE_C:ae=Ue.CODE_CODE_C;break;case Ue.CODE_STOP:fe=!0;break}break;case Ue.CODE_CODE_B:if(pt<96)Hr===dn?we+=String.fromCharCode(32+pt):we+=String.fromCharCode(32+pt+128),Hr=!1;else switch(pt!==Ue.CODE_STOP&&(Mt=!1),pt){case Ue.CODE_FNC_1:L&&(we.length===0?we+="]C1":we+="");break;case Ue.CODE_FNC_2:case Ue.CODE_FNC_3:break;case Ue.CODE_FNC_4_B:!dn&&Hr?(dn=!0,Hr=!1):dn&&Hr?(dn=!1,Hr=!1):Hr=!0;break;case Ue.CODE_SHIFT:ve=!0,ae=Ue.CODE_CODE_A;break;case Ue.CODE_CODE_A:ae=Ue.CODE_CODE_A;break;case Ue.CODE_CODE_C:ae=Ue.CODE_CODE_C;break;case Ue.CODE_STOP:fe=!0;break}break;case Ue.CODE_CODE_C:if(pt<100)pt<10&&(we+="0"),we+=pt;else switch(pt!==Ue.CODE_STOP&&(Mt=!1),pt){case Ue.CODE_FNC_1:L&&(we.length===0?we+="]C1":we+="");break;case Ue.CODE_CODE_A:ae=Ue.CODE_CODE_A;break;case Ue.CODE_CODE_B:ae=Ue.CODE_CODE_B;break;case Ue.CODE_STOP:fe=!0;break}break}Rf&&(ae=ae===Ue.CODE_CODE_A?Ue.CODE_CODE_B:Ue.CODE_CODE_A)}const ki=Ve-Te;if(Ve=_.getNextUnset(Ve),!_.isRange(Ve,Math.min(_.getSize(),Ve+(Ve-Te)/2),!1))throw new S;if($t-=zt*at,$t%103!==at)throw new m;const Qo=we.length;if(Qo===0)throw new S;Qo>0&&Mt&&(ae===Ue.CODE_CODE_C?we=we.substring(0,Qo-2):we=we.substring(0,Qo-1));const Ai=(z[1]+z[0])/2,Gn=Te+ki/2,Ra=te.length,Zi=new Uint8Array(Ra);for(let Rf=0;Rf<Ra;Rf++)Zi[Rf]=te[Rf];const Of=[new be(Ai,w),new be(Gn,w)];return new Z(we,Zi,0,Of,W.CODE_128,new Date().getTime())}}Ue.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Ue.MAX_AVG_VARIANCE=.25,Ue.MAX_INDIVIDUAL_VARIANCE=.7,Ue.CODE_SHIFT=98,Ue.CODE_CODE_C=99,Ue.CODE_CODE_B=100,Ue.CODE_CODE_A=101,Ue.CODE_FNC_1=102,Ue.CODE_FNC_2=97,Ue.CODE_FNC_3=96,Ue.CODE_FNC_4_A=101,Ue.CODE_FNC_4_B=100,Ue.CODE_START_A=103,Ue.CODE_START_B=104,Ue.CODE_START_C=105,Ue.CODE_STOP=106;class Le extends Je{constructor(w=!1,_=!1){super(),this.usingCheckDigit=w,this.extendedMode=_,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(w,_,A){let L=this.counters;L.fill(0),this.decodeRowResult="";let z=Le.findAsteriskPattern(_,L),K=_.getNextSet(z[1]),Q=_.getSize(),te,ae;do{Le.recordPattern(_,K,L);let We=Le.toNarrowWidePattern(L);if(We<0)throw new S;te=Le.patternToChar(We),this.decodeRowResult+=te,ae=K;for(let at of L)K+=at;K=_.getNextSet(K)}while(te!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let fe=0;for(let We of L)fe+=We;let ve=K-ae-fe;if(K!==Q&&ve*2<fe)throw new S;if(this.usingCheckDigit){let We=this.decodeRowResult.length-1,at=0;for(let pt=0;pt<We;pt++)at+=Le.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(pt));if(this.decodeRowResult.charAt(We)!==Le.ALPHABET_STRING.charAt(at%43))throw new m;this.decodeRowResult=this.decodeRowResult.substring(0,We)}if(this.decodeRowResult.length===0)throw new S;let we;this.extendedMode?we=Le.decodeExtended(this.decodeRowResult):we=this.decodeRowResult;let Te=(z[1]+z[0])/2,Ve=ae+fe/2;return new Z(we,null,0,[new be(Te,w),new be(Ve,w)],W.CODE_39,new Date().getTime())}static findAsteriskPattern(w,_){let A=w.getSize(),L=w.getNextSet(0),z=0,K=L,Q=!1,te=_.length;for(let ae=L;ae<A;ae++)if(w.get(ae)!==Q)_[z]++;else{if(z===te-1){if(this.toNarrowWidePattern(_)===Le.ASTERISK_ENCODING&&w.isRange(Math.max(0,K-Math.floor((ae-K)/2)),K,!1))return[K,ae];K+=_[0]+_[1],_.copyWithin(0,2,2+z-1),_[z-1]=0,_[z]=0,z--}else z++;_[z]=1,Q=!Q}throw new S}static toNarrowWidePattern(w){let _=w.length,A=0,L;do{let z=2147483647;for(let te of w)te<z&&te>A&&(z=te);A=z,L=0;let K=0,Q=0;for(let te=0;te<_;te++){let ae=w[te];ae>A&&(Q|=1<<_-1-te,L++,K+=ae)}if(L===3){for(let te=0;te<_&&L>0;te++){let ae=w[te];if(ae>A&&(L--,ae*2>=K))return-1}return Q}}while(L>3);return-1}static patternToChar(w){for(let _=0;_<Le.CHARACTER_ENCODINGS.length;_++)if(Le.CHARACTER_ENCODINGS[_]===w)return Le.ALPHABET_STRING.charAt(_);if(w===Le.ASTERISK_ENCODING)return"*";throw new S}static decodeExtended(w){let _=w.length,A="";for(let L=0;L<_;L++){let z=w.charAt(L);if(z==="+"||z==="$"||z==="%"||z==="/"){let K=w.charAt(L+1),Q="\0";switch(z){case"+":if(K>="A"&&K<="Z")Q=String.fromCharCode(K.charCodeAt(0)+32);else throw new R;break;case"$":if(K>="A"&&K<="Z")Q=String.fromCharCode(K.charCodeAt(0)-64);else throw new R;break;case"%":if(K>="A"&&K<="E")Q=String.fromCharCode(K.charCodeAt(0)-38);else if(K>="F"&&K<="J")Q=String.fromCharCode(K.charCodeAt(0)-11);else if(K>="K"&&K<="O")Q=String.fromCharCode(K.charCodeAt(0)+16);else if(K>="P"&&K<="T")Q=String.fromCharCode(K.charCodeAt(0)+43);else if(K==="U")Q="\0";else if(K==="V")Q="@";else if(K==="W")Q="`";else if(K==="X"||K==="Y"||K==="Z")Q="";else throw new R;break;case"/":if(K>="A"&&K<="O")Q=String.fromCharCode(K.charCodeAt(0)-32);else if(K==="Z")Q=":";else throw new R;break}A+=Q,L++}else A+=z}return A}}Le.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Le.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Le.ASTERISK_ENCODING=148;class Ze extends Je{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(w,_,A){let L=this.decodeStart(_),z=this.decodeEnd(_),K=new I;Ze.decodeMiddle(_,L[1],z[0],K);let Q=K.toString(),te=null;A!=null&&(te=A.get(O.ALLOWED_LENGTHS)),te==null&&(te=Ze.DEFAULT_ALLOWED_LENGTHS);let ae=Q.length,fe=!1,ve=0;for(let Ve of te){if(ae===Ve){fe=!0;break}Ve>ve&&(ve=Ve)}if(!fe&&ae>ve&&(fe=!0),!fe)throw new R;const we=[new be(L[1],w),new be(z[0],w)];return new Z(Q,null,0,we,W.ITF,new Date().getTime())}static decodeMiddle(w,_,A,L){let z=new Int32Array(10),K=new Int32Array(5),Q=new Int32Array(5);for(z.fill(0),K.fill(0),Q.fill(0);_<A;){Je.recordPattern(w,_,z);for(let ae=0;ae<5;ae++){let fe=2*ae;K[ae]=z[fe],Q[ae]=z[fe+1]}let te=Ze.decodeDigit(K);L.append(te.toString()),te=this.decodeDigit(Q),L.append(te.toString()),z.forEach(function(ae){_+=ae})}}decodeStart(w){let _=Ze.skipWhiteSpace(w),A=Ze.findGuardPattern(w,_,Ze.START_PATTERN);return this.narrowLineWidth=(A[1]-A[0])/4,this.validateQuietZone(w,A[0]),A}validateQuietZone(w,_){let A=this.narrowLineWidth*10;A=A<_?A:_;for(let L=_-1;A>0&&L>=0&&!w.get(L);L--)A--;if(A!==0)throw new S}static skipWhiteSpace(w){const _=w.getSize(),A=w.getNextSet(0);if(A===_)throw new S;return A}decodeEnd(w){w.reverse();try{let _=Ze.skipWhiteSpace(w),A;try{A=Ze.findGuardPattern(w,_,Ze.END_PATTERN_REVERSED[0])}catch(z){z instanceof S&&(A=Ze.findGuardPattern(w,_,Ze.END_PATTERN_REVERSED[1]))}this.validateQuietZone(w,A[0]);let L=A[0];return A[0]=w.getSize()-A[1],A[1]=w.getSize()-L,A}finally{w.reverse()}}static findGuardPattern(w,_,A){let L=A.length,z=new Int32Array(L),K=w.getSize(),Q=!1,te=0,ae=_;z.fill(0);for(let fe=_;fe<K;fe++)if(w.get(fe)!==Q)z[te]++;else{if(te===L-1){if(Je.patternMatchVariance(z,A,Ze.MAX_INDIVIDUAL_VARIANCE)<Ze.MAX_AVG_VARIANCE)return[ae,fe];ae+=z[0]+z[1],g.arraycopy(z,2,z,0,te-1),z[te-1]=0,z[te]=0,te--}else te++;z[te]=1,Q=!Q}throw new S}static decodeDigit(w){let _=Ze.MAX_AVG_VARIANCE,A=-1,L=Ze.PATTERNS.length;for(let z=0;z<L;z++){let K=Ze.PATTERNS[z],Q=Je.patternMatchVariance(w,K,Ze.MAX_INDIVIDUAL_VARIANCE);Q<_?(_=Q,A=z):Q===_&&(A=-1)}if(A>=0)return A%10;throw new S}}Ze.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Ze.MAX_AVG_VARIANCE=.38,Ze.MAX_INDIVIDUAL_VARIANCE=.5,Ze.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Ze.START_PATTERN=Int32Array.from([1,1,1,1]),Ze.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class ct extends Je{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(w){let _=!1,A,L=0,z=Int32Array.from([0,0,0]);for(;!_;){z=Int32Array.from([0,0,0]),A=ct.findGuardPattern(w,L,!1,this.START_END_PATTERN,z);let K=A[0];L=A[1];let Q=K-(L-K);Q>=0&&(_=w.isRange(Q,K,!1))}return A}static checkChecksum(w){return ct.checkStandardUPCEANChecksum(w)}static checkStandardUPCEANChecksum(w){let _=w.length;if(_===0)return!1;let A=parseInt(w.charAt(_-1),10);return ct.getStandardUPCEANChecksum(w.substring(0,_-1))===A}static getStandardUPCEANChecksum(w){let _=w.length,A=0;for(let L=_-1;L>=0;L-=2){let z=w.charAt(L).charCodeAt(0)-48;if(z<0||z>9)throw new R;A+=z}A*=3;for(let L=_-2;L>=0;L-=2){let z=w.charAt(L).charCodeAt(0)-48;if(z<0||z>9)throw new R;A+=z}return(1e3-A)%10}static decodeEnd(w,_){return ct.findGuardPattern(w,_,!1,ct.START_END_PATTERN,new Int32Array(ct.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(w,_,A,L){return this.findGuardPattern(w,_,A,L,new Int32Array(L.length))}static findGuardPattern(w,_,A,L,z){let K=w.getSize();_=A?w.getNextUnset(_):w.getNextSet(_);let Q=0,te=_,ae=L.length,fe=A;for(let ve=_;ve<K;ve++)if(w.get(ve)!==fe)z[Q]++;else{if(Q===ae-1){if(Je.patternMatchVariance(z,L,ct.MAX_INDIVIDUAL_VARIANCE)<ct.MAX_AVG_VARIANCE)return Int32Array.from([te,ve]);te+=z[0]+z[1];let we=z.slice(2,z.length-1);for(let Te=0;Te<Q-1;Te++)z[Te]=we[Te];z[Q-1]=0,z[Q]=0,Q--}else Q++;z[Q]=1,fe=!fe}throw new S}static decodeDigit(w,_,A,L){this.recordPattern(w,A,_);let z=this.MAX_AVG_VARIANCE,K=-1,Q=L.length;for(let te=0;te<Q;te++){let ae=L[te],fe=Je.patternMatchVariance(_,ae,ct.MAX_INDIVIDUAL_VARIANCE);fe<z&&(z=fe,K=te)}if(K>=0)return K;throw new S}}ct.MAX_AVG_VARIANCE=.48,ct.MAX_INDIVIDUAL_VARIANCE=.7,ct.START_END_PATTERN=Int32Array.from([1,1,1]),ct.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),ct.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),ct.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class ht{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(w,_,A){let L=this.decodeRowStringBuffer,z=this.decodeMiddle(_,A,L),K=L.toString(),Q=ht.parseExtensionString(K),te=[new be((A[0]+A[1])/2,w),new be(z,w)],ae=new Z(K,null,0,te,W.UPC_EAN_EXTENSION,new Date().getTime());return Q!=null&&ae.putAllMetadata(Q),ae}decodeMiddle(w,_,A){let L=this.decodeMiddleCounters;L[0]=0,L[1]=0,L[2]=0,L[3]=0;let z=w.getSize(),K=_[1],Q=0;for(let ae=0;ae<5&&K<z;ae++){let fe=ct.decodeDigit(w,L,K,ct.L_AND_G_PATTERNS);A+=String.fromCharCode(48+fe%10);for(let ve of L)K+=ve;fe>=10&&(Q|=1<<4-ae),ae!==4&&(K=w.getNextSet(K),K=w.getNextUnset(K))}if(A.length!==5)throw new S;let te=this.determineCheckDigit(Q);if(ht.extensionChecksum(A.toString())!==te)throw new S;return K}static extensionChecksum(w){let _=w.length,A=0;for(let L=_-2;L>=0;L-=2)A+=w.charAt(L).charCodeAt(0)-48;A*=3;for(let L=_-1;L>=0;L-=2)A+=w.charAt(L).charCodeAt(0)-48;return A*=3,A%10}determineCheckDigit(w){for(let _=0;_<10;_++)if(w===this.CHECK_DIGIT_ENCODINGS[_])return _;throw new S}static parseExtensionString(w){if(w.length!==5)return null;let _=ht.parseExtension5String(w);return _==null?null:new Map([[V.SUGGESTED_PRICE,_]])}static parseExtension5String(w){let _;switch(w.charAt(0)){case"0":_="";break;case"5":_="$";break;case"9":switch(w){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}_="";break;default:_="";break}let A=parseInt(w.substring(1)),L=(A/100).toString(),z=A%100,K=z<10?"0"+z:z.toString();return _+L+"."+K}}class yt{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(w,_,A){let L=this.decodeRowStringBuffer,z=this.decodeMiddle(_,A,L),K=L.toString(),Q=yt.parseExtensionString(K),te=[new be((A[0]+A[1])/2,w),new be(z,w)],ae=new Z(K,null,0,te,W.UPC_EAN_EXTENSION,new Date().getTime());return Q!=null&&ae.putAllMetadata(Q),ae}decodeMiddle(w,_,A){let L=this.decodeMiddleCounters;L[0]=0,L[1]=0,L[2]=0,L[3]=0;let z=w.getSize(),K=_[1],Q=0;for(let te=0;te<2&&K<z;te++){let ae=ct.decodeDigit(w,L,K,ct.L_AND_G_PATTERNS);A+=String.fromCharCode(48+ae%10);for(let fe of L)K+=fe;ae>=10&&(Q|=1<<1-te),te!==1&&(K=w.getNextSet(K),K=w.getNextUnset(K))}if(A.length!==2)throw new S;if(parseInt(A.toString())%4!==Q)throw new S;return K}static parseExtensionString(w){return w.length!==2?null:new Map([[V.ISSUE_NUMBER,parseInt(w)]])}}class Re{static decodeRow(w,_,A){let L=ct.findGuardPattern(_,A,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new ht().decodeRow(w,_,L)}catch{return new yt().decodeRow(w,_,L)}}}Re.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Ke extends ct{constructor(){super(),this.decodeRowStringBuffer="",Ke.L_AND_G_PATTERNS=Ke.L_PATTERNS.map(w=>Int32Array.from(w));for(let w=10;w<20;w++){let _=Ke.L_PATTERNS[w-10],A=new Int32Array(_.length);for(let L=0;L<_.length;L++)A[L]=_[_.length-L-1];Ke.L_AND_G_PATTERNS[w]=A}}decodeRow(w,_,A){let L=Ke.findStartGuardPattern(_),z=A==null?null:A.get(O.NEED_RESULT_POINT_CALLBACK);if(z!=null){const Mt=new be((L[0]+L[1])/2,w);z.foundPossibleResultPoint(Mt)}let K=this.decodeMiddle(_,L,this.decodeRowStringBuffer),Q=K.rowOffset,te=K.resultString;if(z!=null){const Mt=new be(Q,w);z.foundPossibleResultPoint(Mt)}let ae=this.decodeEnd(_,Q);if(z!=null){const Mt=new be((ae[0]+ae[1])/2,w);z.foundPossibleResultPoint(Mt)}let fe=ae[1],ve=fe+(fe-ae[0]);if(ve>=_.getSize()||!_.isRange(fe,ve,!1))throw new S;let we=te.toString();if(we.length<8)throw new R;if(!Ke.checkChecksum(we))throw new m;let Te=(L[1]+L[0])/2,Ve=(ae[1]+ae[0])/2,We=this.getBarcodeFormat(),at=[new be(Te,w),new be(Ve,w)],pt=new Z(we,null,0,at,We,new Date().getTime()),$t=0;try{let Mt=Re.decodeRow(w,_,ae[1]);pt.putMetadata(V.UPC_EAN_EXTENSION,Mt.getText()),pt.putAllMetadata(Mt.getResultMetadata()),pt.addResultPoints(Mt.getResultPoints()),$t=Mt.getText().length}catch{}let zt=A==null?null:A.get(O.ALLOWED_EAN_EXTENSIONS);if(zt!=null){let Mt=!1;for(let dn in zt)if($t.toString()===dn){Mt=!0;break}if(!Mt)throw new S}return pt}decodeEnd(w,_){return Ke.findGuardPattern(w,_,!1,Ke.START_END_PATTERN,new Int32Array(Ke.START_END_PATTERN.length).fill(0))}static checkChecksum(w){return Ke.checkStandardUPCEANChecksum(w)}static checkStandardUPCEANChecksum(w){let _=w.length;if(_===0)return!1;let A=parseInt(w.charAt(_-1),10);return Ke.getStandardUPCEANChecksum(w.substring(0,_-1))===A}static getStandardUPCEANChecksum(w){let _=w.length,A=0;for(let L=_-1;L>=0;L-=2){let z=w.charAt(L).charCodeAt(0)-48;if(z<0||z>9)throw new R;A+=z}A*=3;for(let L=_-2;L>=0;L-=2){let z=w.charAt(L).charCodeAt(0)-48;if(z<0||z>9)throw new R;A+=z}return(1e3-A)%10}}class _t extends Ke{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(w,_,A){let L=this.decodeMiddleCounters;L[0]=0,L[1]=0,L[2]=0,L[3]=0;let z=w.getSize(),K=_[1],Q=0;for(let ae=0;ae<6&&K<z;ae++){let fe=Ke.decodeDigit(w,L,K,Ke.L_AND_G_PATTERNS);A+=String.fromCharCode(48+fe%10);for(let ve of L)K+=ve;fe>=10&&(Q|=1<<5-ae)}A=_t.determineFirstDigit(A,Q),K=Ke.findGuardPattern(w,K,!0,Ke.MIDDLE_PATTERN,new Int32Array(Ke.MIDDLE_PATTERN.length).fill(0))[1];for(let ae=0;ae<6&&K<z;ae++){let fe=Ke.decodeDigit(w,L,K,Ke.L_PATTERNS);A+=String.fromCharCode(48+fe);for(let ve of L)K+=ve}return{rowOffset:K,resultString:A}}getBarcodeFormat(){return W.EAN_13}static determineFirstDigit(w,_){for(let A=0;A<10;A++)if(_===this.FIRST_DIGIT_ENCODINGS[A])return w=String.fromCharCode(48+A)+w,w;throw new S}}_t.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Rt extends Ke{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(w,_,A){const L=this.decodeMiddleCounters;L[0]=0,L[1]=0,L[2]=0,L[3]=0;let z=w.getSize(),K=_[1];for(let te=0;te<4&&K<z;te++){let ae=Ke.decodeDigit(w,L,K,Ke.L_PATTERNS);A+=String.fromCharCode(48+ae);for(let fe of L)K+=fe}K=Ke.findGuardPattern(w,K,!0,Ke.MIDDLE_PATTERN,new Int32Array(Ke.MIDDLE_PATTERN.length).fill(0))[1];for(let te=0;te<4&&K<z;te++){let ae=Ke.decodeDigit(w,L,K,Ke.L_PATTERNS);A+=String.fromCharCode(48+ae);for(let fe of L)K+=fe}return{rowOffset:K,resultString:A}}getBarcodeFormat(){return W.EAN_8}}class Se extends Ke{constructor(){super(...arguments),this.ean13Reader=new _t}getBarcodeFormat(){return W.UPC_A}decode(w,_){return this.maybeReturnResult(this.ean13Reader.decode(w))}decodeRow(w,_,A){return this.maybeReturnResult(this.ean13Reader.decodeRow(w,_,A))}decodeMiddle(w,_,A){return this.ean13Reader.decodeMiddle(w,_,A)}maybeReturnResult(w){let _=w.getText();if(_.charAt(0)==="0"){let A=new Z(_.substring(1),null,null,w.getResultPoints(),W.UPC_A);return w.getResultMetadata()!=null&&A.putAllMetadata(w.getResultMetadata()),A}else throw new S}reset(){this.ean13Reader.reset()}}class tt extends Ke{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(w,_,A){const L=this.decodeMiddleCounters.map(ae=>ae);L[0]=0,L[1]=0,L[2]=0,L[3]=0;const z=w.getSize();let K=_[1],Q=0;for(let ae=0;ae<6&&K<z;ae++){const fe=tt.decodeDigit(w,L,K,tt.L_AND_G_PATTERNS);A+=String.fromCharCode(48+fe%10);for(let ve of L)K+=ve;fe>=10&&(Q|=1<<5-ae)}let te=tt.determineNumSysAndCheckDigit(A,Q);return{rowOffset:K,resultString:te}}decodeEnd(w,_){return tt.findGuardPatternWithoutCounters(w,_,!0,tt.MIDDLE_END_PATTERN)}checkChecksum(w){return Ke.checkChecksum(tt.convertUPCEtoUPCA(w))}static determineNumSysAndCheckDigit(w,_){for(let A=0;A<=1;A++)for(let L=0;L<10;L++)if(_===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[A][L]){let z=String.fromCharCode(48+A),K=String.fromCharCode(48+L);return z+w+K}throw S.getNotFoundInstance()}getBarcodeFormat(){return W.UPC_E}static convertUPCEtoUPCA(w){const _=w.slice(1,7).split("").map(z=>z.charCodeAt(0)),A=new I;A.append(w.charAt(0));let L=_[5];switch(L){case 0:case 1:case 2:A.appendChars(_,0,2),A.append(L),A.append("0000"),A.appendChars(_,2,3);break;case 3:A.appendChars(_,0,3),A.append("00000"),A.appendChars(_,3,2);break;case 4:A.appendChars(_,0,4),A.append("00000"),A.append(_[4]);break;default:A.appendChars(_,0,5),A.append("0000"),A.append(L);break}return w.length>=8&&A.append(w.charAt(7)),A.toString()}}tt.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),tt.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class ot extends Je{constructor(w){super();let _=w==null?null:w.get(O.POSSIBLE_FORMATS),A=[];s(_)?(A.push(new _t),A.push(new Se),A.push(new Rt),A.push(new tt)):(_.indexOf(W.EAN_13)>-1&&A.push(new _t),_.indexOf(W.UPC_A)>-1&&A.push(new Se),_.indexOf(W.EAN_8)>-1&&A.push(new Rt),_.indexOf(W.UPC_E)>-1&&A.push(new tt)),this.readers=A}decodeRow(w,_,A){for(let L of this.readers)try{const z=L.decodeRow(w,_,A),K=z.getBarcodeFormat()===W.EAN_13&&z.getText().charAt(0)==="0",Q=A==null?null:A.get(O.POSSIBLE_FORMATS),te=Q==null||Q.includes(W.UPC_A);if(K&&te){const ae=z.getRawBytes(),fe=new Z(z.getText().substring(1),ae,ae?ae.length:null,z.getResultPoints(),W.UPC_A);return fe.putAllMetadata(z.getResultMetadata()),fe}return z}catch{}throw new S}reset(){for(let w of this.readers)w.reset()}}class lt extends Je{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(w,_){for(let A=0;A<_.length;A++)if(Je.patternMatchVariance(w,_[A],lt.MAX_INDIVIDUAL_VARIANCE)<lt.MAX_AVG_VARIANCE)return A;throw new S}static count(w){return ge.sum(new Int32Array(w))}static increment(w,_){let A=0,L=_[0];for(let z=1;z<w.length;z++)_[z]>L&&(L=_[z],A=z);w[A]++}static decrement(w,_){let A=0,L=_[0];for(let z=1;z<w.length;z++)_[z]<L&&(L=_[z],A=z);w[A]--}static isFinderPattern(w){let _=w[0]+w[1],A=_+w[2]+w[3],L=_/A;if(L>=lt.MIN_FINDER_PATTERN_RATIO&&L<=lt.MAX_FINDER_PATTERN_RATIO){let z=Number.MAX_SAFE_INTEGER,K=Number.MIN_SAFE_INTEGER;for(let Q of w)Q>K&&(K=Q),Q<z&&(z=Q);return K<10*z}return!1}}lt.MAX_AVG_VARIANCE=.2,lt.MAX_INDIVIDUAL_VARIANCE=.45,lt.MIN_FINDER_PATTERN_RATIO=9.5/12,lt.MAX_FINDER_PATTERN_RATIO=12.5/14;class At{constructor(w,_){this.value=w,this.checksumPortion=_}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(w){if(!(w instanceof At))return!1;const _=w;return this.value===_.value&&this.checksumPortion===_.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Nt{constructor(w,_,A,L,z){this.value=w,this.startEnd=_,this.value=w,this.startEnd=_,this.resultPoints=new Array,this.resultPoints.push(new be(A,z)),this.resultPoints.push(new be(L,z))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(w){if(!(w instanceof Nt))return!1;const _=w;return this.value===_.value}hashCode(){return this.value}}class ut{constructor(){}static getRSSvalue(w,_,A){let L=0;for(let te of w)L+=te;let z=0,K=0,Q=w.length;for(let te=0;te<Q-1;te++){let ae;for(ae=1,K|=1<<te;ae<w[te];ae++,K&=~(1<<te)){let fe=ut.combins(L-ae-1,Q-te-2);if(A&&K===0&&L-ae-(Q-te-1)>=Q-te-1&&(fe-=ut.combins(L-ae-(Q-te),Q-te-2)),Q-te-1>1){let ve=0;for(let we=L-ae-(Q-te-2);we>_;we--)ve+=ut.combins(L-ae-we-1,Q-te-3);fe-=ve*(Q-1-te)}else L-ae>_&&fe--;z+=fe}L-=ae}return z}static combins(w,_){let A,L;w-_>_?(L=_,A=w-_):(L=w-_,A=_);let z=1,K=1;for(let Q=w;Q>A;Q--)z*=Q,K<=L&&(z/=K,K++);for(;K<=L;)z/=K,K++;return z}}class lr{static buildBitArray(w){let _=w.length*2-1;w[w.length-1].getRightChar()==null&&(_-=1);let A=12*_,L=new j(A),z=0,Q=w[0].getRightChar().getValue();for(let te=11;te>=0;--te)Q&1<<te&&L.set(z),z++;for(let te=1;te<w.length;++te){let ae=w[te],fe=ae.getLeftChar().getValue();for(let ve=11;ve>=0;--ve)fe&1<<ve&&L.set(z),z++;if(ae.getRightChar()!=null){let ve=ae.getRightChar().getValue();for(let we=11;we>=0;--we)ve&1<<we&&L.set(z),z++}}return L}}class Pt{constructor(w,_){_?this.decodedInformation=null:(this.finished=w,this.decodedInformation=_)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Pe{constructor(w){this.newPosition=w}getNewPosition(){return this.newPosition}}class Me extends Pe{constructor(w,_){super(w),this.value=_}getValue(){return this.value}isFNC1(){return this.value===Me.FNC1}}Me.FNC1="$";class it extends Pe{constructor(w,_,A){super(w),A?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=_}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class gt extends Pe{constructor(w,_,A){if(super(w),_<0||_>10||A<0||A>10)throw new R;this.firstDigit=_,this.secondDigit=A}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===gt.FNC1}isSecondDigitFNC1(){return this.secondDigit===gt.FNC1}isAnyFNC1(){return this.firstDigit===gt.FNC1||this.secondDigit===gt.FNC1}}gt.FNC1=10;class dt{constructor(){}static parseFieldsInGeneralPurpose(w){if(!w)return null;if(w.length<2)throw new S;let _=w.substring(0,2);for(let z of dt.TWO_DIGIT_DATA_LENGTH)if(z[0]===_)return z[1]===dt.VARIABLE_LENGTH?dt.processVariableAI(2,z[2],w):dt.processFixedAI(2,z[1],w);if(w.length<3)throw new S;let A=w.substring(0,3);for(let z of dt.THREE_DIGIT_DATA_LENGTH)if(z[0]===A)return z[1]===dt.VARIABLE_LENGTH?dt.processVariableAI(3,z[2],w):dt.processFixedAI(3,z[1],w);for(let z of dt.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(z[0]===A)return z[1]===dt.VARIABLE_LENGTH?dt.processVariableAI(4,z[2],w):dt.processFixedAI(4,z[1],w);if(w.length<4)throw new S;let L=w.substring(0,4);for(let z of dt.FOUR_DIGIT_DATA_LENGTH)if(z[0]===L)return z[1]===dt.VARIABLE_LENGTH?dt.processVariableAI(4,z[2],w):dt.processFixedAI(4,z[1],w);throw new S}static processFixedAI(w,_,A){if(A.length<w)throw new S;let L=A.substring(0,w);if(A.length<w+_)throw new S;let z=A.substring(w,w+_),K=A.substring(w+_),Q="("+L+")"+z,te=dt.parseFieldsInGeneralPurpose(K);return te==null?Q:Q+te}static processVariableAI(w,_,A){let L=A.substring(0,w),z;A.length<w+_?z=A.length:z=w+_;let K=A.substring(w,z),Q=A.substring(z),te="("+L+")"+K,ae=dt.parseFieldsInGeneralPurpose(Q);return ae==null?te:te+ae}}dt.VARIABLE_LENGTH=[],dt.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",dt.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",dt.VARIABLE_LENGTH,20],["22",dt.VARIABLE_LENGTH,29],["30",dt.VARIABLE_LENGTH,8],["37",dt.VARIABLE_LENGTH,8],["90",dt.VARIABLE_LENGTH,30],["91",dt.VARIABLE_LENGTH,30],["92",dt.VARIABLE_LENGTH,30],["93",dt.VARIABLE_LENGTH,30],["94",dt.VARIABLE_LENGTH,30],["95",dt.VARIABLE_LENGTH,30],["96",dt.VARIABLE_LENGTH,30],["97",dt.VARIABLE_LENGTH,3],["98",dt.VARIABLE_LENGTH,30],["99",dt.VARIABLE_LENGTH,30]],dt.THREE_DIGIT_DATA_LENGTH=[["240",dt.VARIABLE_LENGTH,30],["241",dt.VARIABLE_LENGTH,30],["242",dt.VARIABLE_LENGTH,6],["250",dt.VARIABLE_LENGTH,30],["251",dt.VARIABLE_LENGTH,30],["253",dt.VARIABLE_LENGTH,17],["254",dt.VARIABLE_LENGTH,20],["400",dt.VARIABLE_LENGTH,30],["401",dt.VARIABLE_LENGTH,30],["402",17],["403",dt.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",dt.VARIABLE_LENGTH,20],["421",dt.VARIABLE_LENGTH,15],["422",3],["423",dt.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],dt.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",dt.VARIABLE_LENGTH,15],["391",dt.VARIABLE_LENGTH,18],["392",dt.VARIABLE_LENGTH,15],["393",dt.VARIABLE_LENGTH,18],["703",dt.VARIABLE_LENGTH,30]],dt.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",dt.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",dt.VARIABLE_LENGTH,20],["8003",dt.VARIABLE_LENGTH,30],["8004",dt.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",dt.VARIABLE_LENGTH,30],["8008",dt.VARIABLE_LENGTH,12],["8018",18],["8020",dt.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",dt.VARIABLE_LENGTH,70],["8200",dt.VARIABLE_LENGTH,70]];class It{constructor(w){this.buffer=new I,this.information=w}decodeAllCodes(w,_){let A=_,L=null;do{let z=this.decodeGeneralPurposeField(A,L),K=dt.parseFieldsInGeneralPurpose(z.getNewString());if(K!=null&&w.append(K),z.isRemaining()?L=""+z.getRemainingValue():L=null,A===z.getNewPosition())break;A=z.getNewPosition()}while(!0);return w.toString()}isStillNumeric(w){if(w+7>this.information.getSize())return w+4<=this.information.getSize();for(let _=w;_<w+3;++_)if(this.information.get(_))return!0;return this.information.get(w+3)}decodeNumeric(w){if(w+7>this.information.getSize()){let z=this.extractNumericValueFromBitArray(w,4);return z===0?new gt(this.information.getSize(),gt.FNC1,gt.FNC1):new gt(this.information.getSize(),z-1,gt.FNC1)}let _=this.extractNumericValueFromBitArray(w,7),A=(_-8)/11,L=(_-8)%11;return new gt(w+7,A,L)}extractNumericValueFromBitArray(w,_){return It.extractNumericValueFromBitArray(this.information,w,_)}static extractNumericValueFromBitArray(w,_,A){let L=0;for(let z=0;z<A;++z)w.get(_+z)&&(L|=1<<A-z-1);return L}decodeGeneralPurposeField(w,_){this.buffer.setLengthToZero(),_!=null&&this.buffer.append(_),this.current.setPosition(w);let A=this.parseBlocks();return A!=null&&A.isRemaining()?new it(this.current.getPosition(),this.buffer.toString(),A.getRemainingValue()):new it(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let w,_;do{let A=this.current.getPosition();if(this.current.isAlpha()?(_=this.parseAlphaBlock(),w=_.isFinished()):this.current.isIsoIec646()?(_=this.parseIsoIec646Block(),w=_.isFinished()):(_=this.parseNumericBlock(),w=_.isFinished()),!(A!==this.current.getPosition())&&!w)break}while(!w);return _.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let w=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(w.getNewPosition()),w.isFirstDigitFNC1()){let _;return w.isSecondDigitFNC1()?_=new it(this.current.getPosition(),this.buffer.toString()):_=new it(this.current.getPosition(),this.buffer.toString(),w.getSecondDigit()),new Pt(!0,_)}if(this.buffer.append(w.getFirstDigit()),w.isSecondDigitFNC1()){let _=new it(this.current.getPosition(),this.buffer.toString());return new Pt(!0,_)}this.buffer.append(w.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Pt(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let w=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(w.getNewPosition()),w.isFNC1()){let _=new it(this.current.getPosition(),this.buffer.toString());return new Pt(!0,_)}this.buffer.append(w.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Pt(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let w=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(w.getNewPosition()),w.isFNC1()){let _=new it(this.current.getPosition(),this.buffer.toString());return new Pt(!0,_)}this.buffer.append(w.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Pt(!1)}isStillIsoIec646(w){if(w+5>this.information.getSize())return!1;let _=this.extractNumericValueFromBitArray(w,5);if(_>=5&&_<16)return!0;if(w+7>this.information.getSize())return!1;let A=this.extractNumericValueFromBitArray(w,7);if(A>=64&&A<116)return!0;if(w+8>this.information.getSize())return!1;let L=this.extractNumericValueFromBitArray(w,8);return L>=232&&L<253}decodeIsoIec646(w){let _=this.extractNumericValueFromBitArray(w,5);if(_===15)return new Me(w+5,Me.FNC1);if(_>=5&&_<15)return new Me(w+5,"0"+(_-5));let A=this.extractNumericValueFromBitArray(w,7);if(A>=64&&A<90)return new Me(w+7,""+(A+1));if(A>=90&&A<116)return new Me(w+7,""+(A+7));let L=this.extractNumericValueFromBitArray(w,8),z;switch(L){case 232:z="!";break;case 233:z='"';break;case 234:z="%";break;case 235:z="&";break;case 236:z="'";break;case 237:z="(";break;case 238:z=")";break;case 239:z="*";break;case 240:z="+";break;case 241:z=",";break;case 242:z="-";break;case 243:z=".";break;case 244:z="/";break;case 245:z=":";break;case 246:z=";";break;case 247:z="<";break;case 248:z="=";break;case 249:z=">";break;case 250:z="?";break;case 251:z="_";break;case 252:z=" ";break;default:throw new R}return new Me(w+8,z)}isStillAlpha(w){if(w+5>this.information.getSize())return!1;let _=this.extractNumericValueFromBitArray(w,5);if(_>=5&&_<16)return!0;if(w+6>this.information.getSize())return!1;let A=this.extractNumericValueFromBitArray(w,6);return A>=16&&A<63}decodeAlphanumeric(w){let _=this.extractNumericValueFromBitArray(w,5);if(_===15)return new Me(w+5,Me.FNC1);if(_>=5&&_<15)return new Me(w+5,"0"+(_-5));let A=this.extractNumericValueFromBitArray(w,6);if(A>=32&&A<58)return new Me(w+6,""+(A+33));let L;switch(A){case 58:L="*";break;case 59:L=",";break;case 60:L="-";break;case 61:L=".";break;case 62:L="/";break;default:throw new pe("Decoding invalid alphanumeric value: "+A)}return new Me(w+6,L)}isAlphaTo646ToAlphaLatch(w){if(w+1>this.information.getSize())return!1;for(let _=0;_<5&&_+w<this.information.getSize();++_)if(_===2){if(!this.information.get(w+2))return!1}else if(this.information.get(w+_))return!1;return!0}isAlphaOr646ToNumericLatch(w){if(w+3>this.information.getSize())return!1;for(let _=w;_<w+3;++_)if(this.information.get(_))return!1;return!0}isNumericToAlphaNumericLatch(w){if(w+1>this.information.getSize())return!1;for(let _=0;_<4&&_+w<this.information.getSize();++_)if(this.information.get(w+_))return!1;return!0}}class xr{constructor(w){this.information=w,this.generalDecoder=new It(w)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class sr extends xr{constructor(w){super(w)}encodeCompressedGtin(w,_){w.append("(01)");let A=w.length();w.append("9"),this.encodeCompressedGtinWithoutAI(w,_,A)}encodeCompressedGtinWithoutAI(w,_,A){for(let L=0;L<4;++L){let z=this.getGeneralDecoder().extractNumericValueFromBitArray(_+10*L,10);z/100===0&&w.append("0"),z/10===0&&w.append("0"),w.append(z)}sr.appendCheckDigit(w,A)}static appendCheckDigit(w,_){let A=0;for(let L=0;L<13;L++){let z=w.charAt(L+_).charCodeAt(0)-48;A+=L&1?z:3*z}A=10-A%10,A===10&&(A=0),w.append(A)}}sr.GTIN_SIZE=40;class ir extends sr{constructor(w){super(w)}parseInformation(){let w=new I;w.append("(01)");let _=w.length(),A=this.getGeneralDecoder().extractNumericValueFromBitArray(ir.HEADER_SIZE,4);return w.append(A),this.encodeCompressedGtinWithoutAI(w,ir.HEADER_SIZE+4,_),this.getGeneralDecoder().decodeAllCodes(w,ir.HEADER_SIZE+44)}}ir.HEADER_SIZE=4;class _r extends xr{constructor(w){super(w)}parseInformation(){let w=new I;return this.getGeneralDecoder().decodeAllCodes(w,_r.HEADER_SIZE)}}_r.HEADER_SIZE=5;class wr extends sr{constructor(w){super(w)}encodeCompressedWeight(w,_,A){let L=this.getGeneralDecoder().extractNumericValueFromBitArray(_,A);this.addWeightCode(w,L);let z=this.checkWeight(L),K=1e5;for(let Q=0;Q<5;++Q)z/K===0&&w.append("0"),K/=10;w.append(z)}}class jr extends wr{constructor(w){super(w)}parseInformation(){if(this.getInformation().getSize()!=jr.HEADER_SIZE+wr.GTIN_SIZE+jr.WEIGHT_SIZE)throw new S;let w=new I;return this.encodeCompressedGtin(w,jr.HEADER_SIZE),this.encodeCompressedWeight(w,jr.HEADER_SIZE+wr.GTIN_SIZE,jr.WEIGHT_SIZE),w.toString()}}jr.HEADER_SIZE=5,jr.WEIGHT_SIZE=15;class rt extends jr{constructor(w){super(w)}addWeightCode(w,_){w.append("(3103)")}checkWeight(w){return w}}class Ot extends jr{constructor(w){super(w)}addWeightCode(w,_){_<1e4?w.append("(3202)"):w.append("(3203)")}checkWeight(w){return w<1e4?w:w-1e4}}class rr extends sr{constructor(w){super(w)}parseInformation(){if(this.getInformation().getSize()<rr.HEADER_SIZE+sr.GTIN_SIZE)throw new S;let w=new I;this.encodeCompressedGtin(w,rr.HEADER_SIZE);let _=this.getGeneralDecoder().extractNumericValueFromBitArray(rr.HEADER_SIZE+sr.GTIN_SIZE,rr.LAST_DIGIT_SIZE);w.append("(392"),w.append(_),w.append(")");let A=this.getGeneralDecoder().decodeGeneralPurposeField(rr.HEADER_SIZE+sr.GTIN_SIZE+rr.LAST_DIGIT_SIZE,null);return w.append(A.getNewString()),w.toString()}}rr.HEADER_SIZE=8,rr.LAST_DIGIT_SIZE=2;class nr extends sr{constructor(w){super(w)}parseInformation(){if(this.getInformation().getSize()<nr.HEADER_SIZE+sr.GTIN_SIZE)throw new S;let w=new I;this.encodeCompressedGtin(w,nr.HEADER_SIZE);let _=this.getGeneralDecoder().extractNumericValueFromBitArray(nr.HEADER_SIZE+sr.GTIN_SIZE,nr.LAST_DIGIT_SIZE);w.append("(393"),w.append(_),w.append(")");let A=this.getGeneralDecoder().extractNumericValueFromBitArray(nr.HEADER_SIZE+sr.GTIN_SIZE+nr.LAST_DIGIT_SIZE,nr.FIRST_THREE_DIGITS_SIZE);A/100==0&&w.append("0"),A/10==0&&w.append("0"),w.append(A);let L=this.getGeneralDecoder().decodeGeneralPurposeField(nr.HEADER_SIZE+sr.GTIN_SIZE+nr.LAST_DIGIT_SIZE+nr.FIRST_THREE_DIGITS_SIZE,null);return w.append(L.getNewString()),w.toString()}}nr.HEADER_SIZE=8,nr.LAST_DIGIT_SIZE=2,nr.FIRST_THREE_DIGITS_SIZE=10;class Qt extends wr{constructor(w,_,A){super(w),this.dateCode=A,this.firstAIdigits=_}parseInformation(){if(this.getInformation().getSize()!=Qt.HEADER_SIZE+Qt.GTIN_SIZE+Qt.WEIGHT_SIZE+Qt.DATE_SIZE)throw new S;let w=new I;return this.encodeCompressedGtin(w,Qt.HEADER_SIZE),this.encodeCompressedWeight(w,Qt.HEADER_SIZE+Qt.GTIN_SIZE,Qt.WEIGHT_SIZE),this.encodeCompressedDate(w,Qt.HEADER_SIZE+Qt.GTIN_SIZE+Qt.WEIGHT_SIZE),w.toString()}encodeCompressedDate(w,_){let A=this.getGeneralDecoder().extractNumericValueFromBitArray(_,Qt.DATE_SIZE);if(A==38400)return;w.append("("),w.append(this.dateCode),w.append(")");let L=A%32;A/=32;let z=A%12+1;A/=12;let K=A;K/10==0&&w.append("0"),w.append(K),z/10==0&&w.append("0"),w.append(z),L/10==0&&w.append("0"),w.append(L)}addWeightCode(w,_){w.append("("),w.append(this.firstAIdigits),w.append(_/1e5),w.append(")")}checkWeight(w){return w%1e5}}Qt.HEADER_SIZE=8,Qt.WEIGHT_SIZE=20,Qt.DATE_SIZE=16;function Ce(xe){try{if(xe.get(1))return new ir(xe);if(!xe.get(2))return new _r(xe);switch(It.extractNumericValueFromBitArray(xe,1,4)){case 4:return new rt(xe);case 5:return new Ot(xe)}switch(It.extractNumericValueFromBitArray(xe,1,5)){case 12:return new rr(xe);case 13:return new nr(xe)}switch(It.extractNumericValueFromBitArray(xe,1,7)){case 56:return new Qt(xe,"310","11");case 57:return new Qt(xe,"320","11");case 58:return new Qt(xe,"310","13");case 59:return new Qt(xe,"320","13");case 60:return new Qt(xe,"310","15");case 61:return new Qt(xe,"320","15");case 62:return new Qt(xe,"310","17");case 63:return new Qt(xe,"320","17")}}catch(w){throw console.log(w),new pe("unknown decoder: "+xe)}}class Xe{constructor(w,_,A,L){this.leftchar=w,this.rightchar=_,this.finderpattern=A,this.maybeLast=L}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(w,_){return w instanceof Xe?Xe.equalsOrNull(w.leftchar,_.leftchar)&&Xe.equalsOrNull(w.rightchar,_.rightchar)&&Xe.equalsOrNull(w.finderpattern,_.finderpattern):!1}static equalsOrNull(w,_){return w===null?_===null:Xe.equals(w,_)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class ft{constructor(w,_,A){this.pairs=w,this.rowNumber=_,this.wasReversed=A}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(w){return this.checkEqualitity(this,w)}toString(){return"{ "+this.pairs+" }"}equals(w,_){return w instanceof ft?this.checkEqualitity(w,_)&&w.wasReversed===_.wasReversed:!1}checkEqualitity(w,_){if(!w||!_)return;let A;return w.forEach((L,z)=>{_.forEach(K=>{L.getLeftChar().getValue()===K.getLeftChar().getValue()&&L.getRightChar().getValue()===K.getRightChar().getValue()&&L.getFinderPatter().getValue()===K.getFinderPatter().getValue()&&(A=!0)})}),A}}class ze extends lt{constructor(w){super(...arguments),this.pairs=new Array(ze.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=w===!0}decodeRow(w,_,A){this.pairs.length=0,this.startFromEven=!1;try{return ze.constructResult(this.decodeRow2pairs(w,_))}catch(L){this.verbose&&console.log(L)}return this.pairs.length=0,this.startFromEven=!0,ze.constructResult(this.decodeRow2pairs(w,_))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(w,_){let A=!1;for(;!A;)try{this.pairs.push(this.retrieveNextPair(_,this.pairs,w))}catch(z){if(z instanceof S){if(!this.pairs.length)throw new S;A=!0}}if(this.checkChecksum())return this.pairs;let L;if(this.rows.length?L=!0:L=!1,this.storeRow(w,!1),L){let z=this.checkRowsBoolean(!1);if(z!=null||(z=this.checkRowsBoolean(!0),z!=null))return z}throw new S}checkRowsBoolean(w){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,w&&(this.rows=this.rows.reverse());let _=null;try{_=this.checkRows(new Array,0)}catch(A){this.verbose&&console.log(A)}return w&&(this.rows=this.rows.reverse()),_}checkRows(w,_){for(let A=_;A<this.rows.length;A++){let L=this.rows[A];this.pairs.length=0;for(let K of w)this.pairs.push(K.getPairs());if(this.pairs.push(L.getPairs()),!ze.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let z=new Array(w);z.push(L);try{return this.checkRows(z,A+1)}catch(K){this.verbose&&console.log(K)}}throw new S}static isValidSequence(w){for(let _ of ze.FINDER_PATTERN_SEQUENCES){if(w.length>_.length)continue;let A=!0;for(let L=0;L<w.length;L++)if(w[L].getFinderPattern().getValue()!=_[L]){A=!1;break}if(A)return!0}return!1}storeRow(w,_){let A=0,L=!1,z=!1;for(;A<this.rows.length;){let K=this.rows[A];if(K.getRowNumber()>w){z=K.isEquivalent(this.pairs);break}L=K.isEquivalent(this.pairs),A++}z||L||ze.isPartialRow(this.pairs,this.rows)||(this.rows.push(A,new ft(this.pairs,w,_)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(w,_){for(let A of _)if(A.getPairs().length!==w.length){for(let L of A.getPairs())for(let z of w)if(Xe.equals(L,z))break}}static isPartialRow(w,_){for(let A of _){let L=!0;for(let z of w){let K=!1;for(let Q of A.getPairs())if(z.equals(Q)){K=!0;break}if(!K){L=!1;break}}if(L)return!0}return!1}getRows(){return this.rows}static constructResult(w){let _=lr.buildBitArray(w),L=Ce(_).parseInformation(),z=w[0].getFinderPattern().getResultPoints(),K=w[w.length-1].getFinderPattern().getResultPoints(),Q=[z[0],z[1],K[0],K[1]];return new Z(L,null,null,Q,W.RSS_EXPANDED,null)}checkChecksum(){let w=this.pairs.get(0),_=w.getLeftChar(),A=w.getRightChar();if(A==null)return!1;let L=A.getChecksumPortion(),z=2;for(let Q=1;Q<this.pairs.size();++Q){let te=this.pairs.get(Q);L+=te.getLeftChar().getChecksumPortion(),z++;let ae=te.getRightChar();ae!=null&&(L+=ae.getChecksumPortion(),z++)}return L%=211,211*(z-4)+L==_.getValue()}static getNextSecondBar(w,_){let A;return w.get(_)?(A=w.getNextUnset(_),A=w.getNextSet(A)):(A=w.getNextSet(_),A=w.getNextUnset(A)),A}retrieveNextPair(w,_,A){let L=_.length%2==0;this.startFromEven&&(L=!L);let z,K=!0,Q=-1;do this.findNextPair(w,_,Q),z=this.parseFoundFinderPattern(w,A,L),z==null?Q=ze.getNextSecondBar(w,this.startEnd[0]):K=!1;while(K);let te=this.decodeDataCharacter(w,z,L,!0);if(!this.isEmptyPair(_)&&_[_.length-1].mustBeLast())throw new S;let ae;try{ae=this.decodeDataCharacter(w,z,L,!1)}catch(fe){ae=null,this.verbose&&console.log(fe)}return new Xe(te,ae,z,!0)}isEmptyPair(w){return w.length===0}findNextPair(w,_,A){let L=this.getDecodeFinderCounters();L[0]=0,L[1]=0,L[2]=0,L[3]=0;let z=w.getSize(),K;A>=0?K=A:this.isEmptyPair(_)?K=0:K=_[_.length-1].getFinderPattern().getStartEnd()[1];let Q=_.length%2!=0;this.startFromEven&&(Q=!Q);let te=!1;for(;K<z&&(te=!w.get(K),!!te);)K++;let ae=0,fe=K;for(let ve=K;ve<z;ve++)if(w.get(ve)!=te)L[ae]++;else{if(ae==3){if(Q&&ze.reverseCounters(L),ze.isFinderPattern(L)){this.startEnd[0]=fe,this.startEnd[1]=ve;return}Q&&ze.reverseCounters(L),fe+=L[0]+L[1],L[0]=L[2],L[1]=L[3],L[2]=0,L[3]=0,ae--}else ae++;L[ae]=1,te=!te}throw new S}static reverseCounters(w){let _=w.length;for(let A=0;A<_/2;++A){let L=w[A];w[A]=w[_-A-1],w[_-A-1]=L}}parseFoundFinderPattern(w,_,A){let L,z,K;if(A){let ae=this.startEnd[0]-1;for(;ae>=0&&!w.get(ae);)ae--;ae++,L=this.startEnd[0]-ae,z=ae,K=this.startEnd[1]}else z=this.startEnd[0],K=w.getNextUnset(this.startEnd[1]+1),L=K-this.startEnd[1];let Q=this.getDecodeFinderCounters();g.arraycopy(Q,0,Q,1,Q.length-1),Q[0]=L;let te;try{te=this.parseFinderValue(Q,ze.FINDER_PATTERNS)}catch{return null}return new Nt(te,[z,K],z,K,_)}decodeDataCharacter(w,_,A,L){let z=this.getDataCharacterCounters();for(let Gn=0;Gn<z.length;Gn++)z[Gn]=0;if(L)ze.recordPatternInReverse(w,_.getStartEnd()[0],z);else{ze.recordPattern(w,_.getStartEnd()[1],z);for(let Gn=0,Ra=z.length-1;Gn<Ra;Gn++,Ra--){let Zi=z[Gn];z[Gn]=z[Ra],z[Ra]=Zi}}let K=17,Q=ge.sum(new Int32Array(z))/K,te=(_.getStartEnd()[1]-_.getStartEnd()[0])/15;if(Math.abs(Q-te)/te>.3)throw new S;let ae=this.getOddCounts(),fe=this.getEvenCounts(),ve=this.getOddRoundingErrors(),we=this.getEvenRoundingErrors();for(let Gn=0;Gn<z.length;Gn++){let Ra=1*z[Gn]/Q,Zi=Ra+.5;if(Zi<1){if(Ra<.3)throw new S;Zi=1}else if(Zi>8){if(Ra>8.7)throw new S;Zi=8}let Of=Gn/2;Gn&1?(fe[Of]=Zi,we[Of]=Ra-Zi):(ae[Of]=Zi,ve[Of]=Ra-Zi)}this.adjustOddEvenCounts(K);let Te=4*_.getValue()+(A?0:2)+(L?0:1)-1,Ve=0,We=0;for(let Gn=ae.length-1;Gn>=0;Gn--){if(ze.isNotA1left(_,A,L)){let Ra=ze.WEIGHTS[Te][2*Gn];We+=ae[Gn]*Ra}Ve+=ae[Gn]}let at=0;for(let Gn=fe.length-1;Gn>=0;Gn--)if(ze.isNotA1left(_,A,L)){let Ra=ze.WEIGHTS[Te][2*Gn+1];at+=fe[Gn]*Ra}let pt=We+at;if(Ve&1||Ve>13||Ve<4)throw new S;let $t=(13-Ve)/2,zt=ze.SYMBOL_WIDEST[$t],Mt=9-zt,dn=ut.getRSSvalue(ae,zt,!0),Hr=ut.getRSSvalue(fe,Mt,!1),ki=ze.EVEN_TOTAL_SUBSET[$t],Qo=ze.GSUM[$t],Ai=dn*ki+Hr+Qo;return new At(Ai,pt)}static isNotA1left(w,_,A){return!(w.getValue()==0&&_&&A)}adjustOddEvenCounts(w){let _=ge.sum(new Int32Array(this.getOddCounts())),A=ge.sum(new Int32Array(this.getEvenCounts())),L=!1,z=!1;_>13?z=!0:_<4&&(L=!0);let K=!1,Q=!1;A>13?Q=!0:A<4&&(K=!0);let te=_+A-w,ae=(_&1)==1,fe=(A&1)==0;if(te==1)if(ae){if(fe)throw new S;z=!0}else{if(!fe)throw new S;Q=!0}else if(te==-1)if(ae){if(fe)throw new S;L=!0}else{if(!fe)throw new S;K=!0}else if(te==0){if(ae){if(!fe)throw new S;_<A?(L=!0,Q=!0):(z=!0,K=!0)}else if(fe)throw new S}else throw new S;if(L){if(z)throw new S;ze.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(z&&ze.decrement(this.getOddCounts(),this.getOddRoundingErrors()),K){if(Q)throw new S;ze.increment(this.getEvenCounts(),this.getOddRoundingErrors())}Q&&ze.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ze.SYMBOL_WIDEST=[7,5,4,3,1],ze.EVEN_TOTAL_SUBSET=[4,20,52,104,204],ze.GSUM=[0,348,1388,2948,3988],ze.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],ze.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],ze.FINDER_PAT_A=0,ze.FINDER_PAT_B=1,ze.FINDER_PAT_C=2,ze.FINDER_PAT_D=3,ze.FINDER_PAT_E=4,ze.FINDER_PAT_F=5,ze.FINDER_PATTERN_SEQUENCES=[[ze.FINDER_PAT_A,ze.FINDER_PAT_A],[ze.FINDER_PAT_A,ze.FINDER_PAT_B,ze.FINDER_PAT_B],[ze.FINDER_PAT_A,ze.FINDER_PAT_C,ze.FINDER_PAT_B,ze.FINDER_PAT_D],[ze.FINDER_PAT_A,ze.FINDER_PAT_E,ze.FINDER_PAT_B,ze.FINDER_PAT_D,ze.FINDER_PAT_C],[ze.FINDER_PAT_A,ze.FINDER_PAT_E,ze.FINDER_PAT_B,ze.FINDER_PAT_D,ze.FINDER_PAT_D,ze.FINDER_PAT_F],[ze.FINDER_PAT_A,ze.FINDER_PAT_E,ze.FINDER_PAT_B,ze.FINDER_PAT_D,ze.FINDER_PAT_E,ze.FINDER_PAT_F,ze.FINDER_PAT_F],[ze.FINDER_PAT_A,ze.FINDER_PAT_A,ze.FINDER_PAT_B,ze.FINDER_PAT_B,ze.FINDER_PAT_C,ze.FINDER_PAT_C,ze.FINDER_PAT_D,ze.FINDER_PAT_D],[ze.FINDER_PAT_A,ze.FINDER_PAT_A,ze.FINDER_PAT_B,ze.FINDER_PAT_B,ze.FINDER_PAT_C,ze.FINDER_PAT_C,ze.FINDER_PAT_D,ze.FINDER_PAT_E,ze.FINDER_PAT_E],[ze.FINDER_PAT_A,ze.FINDER_PAT_A,ze.FINDER_PAT_B,ze.FINDER_PAT_B,ze.FINDER_PAT_C,ze.FINDER_PAT_C,ze.FINDER_PAT_D,ze.FINDER_PAT_E,ze.FINDER_PAT_F,ze.FINDER_PAT_F],[ze.FINDER_PAT_A,ze.FINDER_PAT_A,ze.FINDER_PAT_B,ze.FINDER_PAT_B,ze.FINDER_PAT_C,ze.FINDER_PAT_D,ze.FINDER_PAT_D,ze.FINDER_PAT_E,ze.FINDER_PAT_E,ze.FINDER_PAT_F,ze.FINDER_PAT_F]],ze.MAX_PAIRS=11;class Zt extends At{constructor(w,_,A){super(w,_),this.count=0,this.finderPattern=A}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class wt extends lt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(w,_,A){const L=this.decodePair(_,!1,w,A);wt.addOrTally(this.possibleLeftPairs,L),_.reverse();let z=this.decodePair(_,!0,w,A);wt.addOrTally(this.possibleRightPairs,z),_.reverse();for(let K of this.possibleLeftPairs)if(K.getCount()>1){for(let Q of this.possibleRightPairs)if(Q.getCount()>1&&wt.checkChecksum(K,Q))return wt.constructResult(K,Q)}throw new S}static addOrTally(w,_){if(_==null)return;let A=!1;for(let L of w)if(L.getValue()===_.getValue()){L.incrementCount(),A=!0;break}A||w.push(_)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(w,_){let A=4537077*w.getValue()+_.getValue(),L=new String(A).toString(),z=new I;for(let ae=13-L.length;ae>0;ae--)z.append("0");z.append(L);let K=0;for(let ae=0;ae<13;ae++){let fe=z.charAt(ae).charCodeAt(0)-48;K+=ae&1?fe:3*fe}K=10-K%10,K===10&&(K=0),z.append(K.toString());let Q=w.getFinderPattern().getResultPoints(),te=_.getFinderPattern().getResultPoints();return new Z(z.toString(),null,0,[Q[0],Q[1],te[0],te[1]],W.RSS_14,new Date().getTime())}static checkChecksum(w,_){let A=(w.getChecksumPortion()+16*_.getChecksumPortion())%79,L=9*w.getFinderPattern().getValue()+_.getFinderPattern().getValue();return L>72&&L--,L>8&&L--,A===L}decodePair(w,_,A,L){try{let z=this.findFinderPattern(w,_),K=this.parseFoundFinderPattern(w,A,_,z),Q=L==null?null:L.get(O.NEED_RESULT_POINT_CALLBACK);if(Q!=null){let fe=(z[0]+z[1])/2;_&&(fe=w.getSize()-1-fe),Q.foundPossibleResultPoint(new be(fe,A))}let te=this.decodeDataCharacter(w,K,!0),ae=this.decodeDataCharacter(w,K,!1);return new Zt(1597*te.getValue()+ae.getValue(),te.getChecksumPortion()+4*ae.getChecksumPortion(),K)}catch{return null}}decodeDataCharacter(w,_,A){let L=this.getDataCharacterCounters();for(let at=0;at<L.length;at++)L[at]=0;if(A)Je.recordPatternInReverse(w,_.getStartEnd()[0],L);else{Je.recordPattern(w,_.getStartEnd()[1]+1,L);for(let at=0,pt=L.length-1;at<pt;at++,pt--){let $t=L[at];L[at]=L[pt],L[pt]=$t}}let z=A?16:15,K=ge.sum(new Int32Array(L))/z,Q=this.getOddCounts(),te=this.getEvenCounts(),ae=this.getOddRoundingErrors(),fe=this.getEvenRoundingErrors();for(let at=0;at<L.length;at++){let pt=L[at]/K,$t=Math.floor(pt+.5);$t<1?$t=1:$t>8&&($t=8);let zt=Math.floor(at/2);at&1?(te[zt]=$t,fe[zt]=pt-$t):(Q[zt]=$t,ae[zt]=pt-$t)}this.adjustOddEvenCounts(A,z);let ve=0,we=0;for(let at=Q.length-1;at>=0;at--)we*=9,we+=Q[at],ve+=Q[at];let Te=0,Ve=0;for(let at=te.length-1;at>=0;at--)Te*=9,Te+=te[at],Ve+=te[at];let We=we+3*Te;if(A){if(ve&1||ve>12||ve<4)throw new S;let at=(12-ve)/2,pt=wt.OUTSIDE_ODD_WIDEST[at],$t=9-pt,zt=ut.getRSSvalue(Q,pt,!1),Mt=ut.getRSSvalue(te,$t,!0),dn=wt.OUTSIDE_EVEN_TOTAL_SUBSET[at],Hr=wt.OUTSIDE_GSUM[at];return new At(zt*dn+Mt+Hr,We)}else{if(Ve&1||Ve>10||Ve<4)throw new S;let at=(10-Ve)/2,pt=wt.INSIDE_ODD_WIDEST[at],$t=9-pt,zt=ut.getRSSvalue(Q,pt,!0),Mt=ut.getRSSvalue(te,$t,!1),dn=wt.INSIDE_ODD_TOTAL_SUBSET[at],Hr=wt.INSIDE_GSUM[at];return new At(Mt*dn+zt+Hr,We)}}findFinderPattern(w,_){let A=this.getDecodeFinderCounters();A[0]=0,A[1]=0,A[2]=0,A[3]=0;let L=w.getSize(),z=!1,K=0;for(;K<L&&(z=!w.get(K),_!==z);)K++;let Q=0,te=K;for(let ae=K;ae<L;ae++)if(w.get(ae)!==z)A[Q]++;else{if(Q===3){if(lt.isFinderPattern(A))return[te,ae];te+=A[0]+A[1],A[0]=A[2],A[1]=A[3],A[2]=0,A[3]=0,Q--}else Q++;A[Q]=1,z=!z}throw new S}parseFoundFinderPattern(w,_,A,L){let z=w.get(L[0]),K=L[0]-1;for(;K>=0&&z!==w.get(K);)K--;K++;const Q=L[0]-K,te=this.getDecodeFinderCounters(),ae=new Int32Array(te.length);g.arraycopy(te,0,ae,1,te.length-1),ae[0]=Q;const fe=this.parseFinderValue(ae,wt.FINDER_PATTERNS);let ve=K,we=L[1];return A&&(ve=w.getSize()-1-ve,we=w.getSize()-1-we),new Nt(fe,[K,L[1]],ve,we,_)}adjustOddEvenCounts(w,_){let A=ge.sum(new Int32Array(this.getOddCounts())),L=ge.sum(new Int32Array(this.getEvenCounts())),z=!1,K=!1,Q=!1,te=!1;w?(A>12?K=!0:A<4&&(z=!0),L>12?te=!0:L<4&&(Q=!0)):(A>11?K=!0:A<5&&(z=!0),L>10?te=!0:L<4&&(Q=!0));let ae=A+L-_,fe=(A&1)===(w?1:0),ve=(L&1)===1;if(ae===1)if(fe){if(ve)throw new S;K=!0}else{if(!ve)throw new S;te=!0}else if(ae===-1)if(fe){if(ve)throw new S;z=!0}else{if(!ve)throw new S;Q=!0}else if(ae===0){if(fe){if(!ve)throw new S;A<L?(z=!0,te=!0):(K=!0,Q=!0)}else if(ve)throw new S}else throw new S;if(z){if(K)throw new S;lt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(K&&lt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),Q){if(te)throw new S;lt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}te&&lt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}wt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],wt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],wt.OUTSIDE_GSUM=[0,161,961,2015,2715],wt.INSIDE_GSUM=[0,336,1036,1516],wt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],wt.INSIDE_ODD_WIDEST=[2,4,6,8],wt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class kt extends Je{constructor(w,_){super(),this.readers=[],this.verbose=_===!0;const A=w?w.get(O.POSSIBLE_FORMATS):null,L=w&&w.get(O.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;A?((A.includes(W.EAN_13)||A.includes(W.UPC_A)||A.includes(W.EAN_8)||A.includes(W.UPC_E))&&this.readers.push(new ot(w)),A.includes(W.CODE_39)&&this.readers.push(new Le(L)),A.includes(W.CODE_128)&&this.readers.push(new Ue),A.includes(W.ITF)&&this.readers.push(new Ze),A.includes(W.RSS_14)&&this.readers.push(new wt),A.includes(W.RSS_EXPANDED)&&this.readers.push(new ze(this.verbose))):(this.readers.push(new ot(w)),this.readers.push(new Le),this.readers.push(new ot(w)),this.readers.push(new Ue),this.readers.push(new Ze),this.readers.push(new wt),this.readers.push(new ze(this.verbose)))}decodeRow(w,_,A){for(let L=0;L<this.readers.length;L++)try{return this.readers[L].decodeRow(w,_,A)}catch{}throw new S}reset(){this.readers.forEach(w=>w.reset())}}class Cr extends X{constructor(w=500,_){super(new kt(_),w,_)}}class Jt{constructor(w,_,A){this.ecCodewords=w,this.ecBlocks=[_],A&&this.ecBlocks.push(A)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class tr{constructor(w,_){this.count=w,this.dataCodewords=_}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ut{constructor(w,_,A,L,z,K){this.versionNumber=w,this.symbolSizeRows=_,this.symbolSizeColumns=A,this.dataRegionSizeRows=L,this.dataRegionSizeColumns=z,this.ecBlocks=K;let Q=0;const te=K.getECCodewords(),ae=K.getECBlocks();for(let fe of ae)Q+=fe.getCount()*(fe.getDataCodewords()+te);this.totalCodewords=Q}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(w,_){if(w&1||_&1)throw new R;for(let A of Ut.VERSIONS)if(A.symbolSizeRows===w&&A.symbolSizeColumns===_)return A;throw new R}toString(){return""+this.versionNumber}static buildVersions(){return[new Ut(1,10,10,8,8,new Jt(5,new tr(1,3))),new Ut(2,12,12,10,10,new Jt(7,new tr(1,5))),new Ut(3,14,14,12,12,new Jt(10,new tr(1,8))),new Ut(4,16,16,14,14,new Jt(12,new tr(1,12))),new Ut(5,18,18,16,16,new Jt(14,new tr(1,18))),new Ut(6,20,20,18,18,new Jt(18,new tr(1,22))),new Ut(7,22,22,20,20,new Jt(20,new tr(1,30))),new Ut(8,24,24,22,22,new Jt(24,new tr(1,36))),new Ut(9,26,26,24,24,new Jt(28,new tr(1,44))),new Ut(10,32,32,14,14,new Jt(36,new tr(1,62))),new Ut(11,36,36,16,16,new Jt(42,new tr(1,86))),new Ut(12,40,40,18,18,new Jt(48,new tr(1,114))),new Ut(13,44,44,20,20,new Jt(56,new tr(1,144))),new Ut(14,48,48,22,22,new Jt(68,new tr(1,174))),new Ut(15,52,52,24,24,new Jt(42,new tr(2,102))),new Ut(16,64,64,14,14,new Jt(56,new tr(2,140))),new Ut(17,72,72,16,16,new Jt(36,new tr(4,92))),new Ut(18,80,80,18,18,new Jt(48,new tr(4,114))),new Ut(19,88,88,20,20,new Jt(56,new tr(4,144))),new Ut(20,96,96,22,22,new Jt(68,new tr(4,174))),new Ut(21,104,104,24,24,new Jt(56,new tr(6,136))),new Ut(22,120,120,18,18,new Jt(68,new tr(6,175))),new Ut(23,132,132,20,20,new Jt(62,new tr(8,163))),new Ut(24,144,144,22,22,new Jt(62,new tr(8,156),new tr(2,155))),new Ut(25,8,18,6,16,new Jt(7,new tr(1,5))),new Ut(26,8,32,6,14,new Jt(11,new tr(1,10))),new Ut(27,12,26,10,24,new Jt(14,new tr(1,16))),new Ut(28,12,36,10,16,new Jt(18,new tr(1,22))),new Ut(29,16,36,14,16,new Jt(24,new tr(1,32))),new Ut(30,16,48,14,22,new Jt(28,new tr(1,49)))]}}Ut.VERSIONS=Ut.buildVersions();class xn{constructor(w){const _=w.getHeight();if(_<8||_>144||_&1)throw new R;this.version=xn.readVersion(w),this.mappingBitMatrix=this.extractDataRegion(w),this.readMappingMatrix=new F(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(w){const _=w.getHeight(),A=w.getWidth();return Ut.getVersionForDimensions(_,A)}readCodewords(){const w=new Int8Array(this.version.getTotalCodewords());let _=0,A=4,L=0;const z=this.mappingBitMatrix.getHeight(),K=this.mappingBitMatrix.getWidth();let Q=!1,te=!1,ae=!1,fe=!1;do if(A===z&&L===0&&!Q)w[_++]=this.readCorner1(z,K)&255,A-=2,L+=2,Q=!0;else if(A===z-2&&L===0&&K&3&&!te)w[_++]=this.readCorner2(z,K)&255,A-=2,L+=2,te=!0;else if(A===z+4&&L===2&&!(K&7)&&!ae)w[_++]=this.readCorner3(z,K)&255,A-=2,L+=2,ae=!0;else if(A===z-2&&L===0&&(K&7)===4&&!fe)w[_++]=this.readCorner4(z,K)&255,A-=2,L+=2,fe=!0;else{do A<z&&L>=0&&!this.readMappingMatrix.get(L,A)&&(w[_++]=this.readUtah(A,L,z,K)&255),A-=2,L+=2;while(A>=0&&L<K);A+=1,L+=3;do A>=0&&L<K&&!this.readMappingMatrix.get(L,A)&&(w[_++]=this.readUtah(A,L,z,K)&255),A+=2,L-=2;while(A<z&&L>=0);A+=3,L+=1}while(A<z||L<K);if(_!==this.version.getTotalCodewords())throw new R;return w}readModule(w,_,A,L){return w<0&&(w+=A,_+=4-(A+4&7)),_<0&&(_+=L,w+=4-(L+4&7)),this.readMappingMatrix.set(_,w),this.mappingBitMatrix.get(_,w)}readUtah(w,_,A,L){let z=0;return this.readModule(w-2,_-2,A,L)&&(z|=1),z<<=1,this.readModule(w-2,_-1,A,L)&&(z|=1),z<<=1,this.readModule(w-1,_-2,A,L)&&(z|=1),z<<=1,this.readModule(w-1,_-1,A,L)&&(z|=1),z<<=1,this.readModule(w-1,_,A,L)&&(z|=1),z<<=1,this.readModule(w,_-2,A,L)&&(z|=1),z<<=1,this.readModule(w,_-1,A,L)&&(z|=1),z<<=1,this.readModule(w,_,A,L)&&(z|=1),z}readCorner1(w,_){let A=0;return this.readModule(w-1,0,w,_)&&(A|=1),A<<=1,this.readModule(w-1,1,w,_)&&(A|=1),A<<=1,this.readModule(w-1,2,w,_)&&(A|=1),A<<=1,this.readModule(0,_-2,w,_)&&(A|=1),A<<=1,this.readModule(0,_-1,w,_)&&(A|=1),A<<=1,this.readModule(1,_-1,w,_)&&(A|=1),A<<=1,this.readModule(2,_-1,w,_)&&(A|=1),A<<=1,this.readModule(3,_-1,w,_)&&(A|=1),A}readCorner2(w,_){let A=0;return this.readModule(w-3,0,w,_)&&(A|=1),A<<=1,this.readModule(w-2,0,w,_)&&(A|=1),A<<=1,this.readModule(w-1,0,w,_)&&(A|=1),A<<=1,this.readModule(0,_-4,w,_)&&(A|=1),A<<=1,this.readModule(0,_-3,w,_)&&(A|=1),A<<=1,this.readModule(0,_-2,w,_)&&(A|=1),A<<=1,this.readModule(0,_-1,w,_)&&(A|=1),A<<=1,this.readModule(1,_-1,w,_)&&(A|=1),A}readCorner3(w,_){let A=0;return this.readModule(w-1,0,w,_)&&(A|=1),A<<=1,this.readModule(w-1,_-1,w,_)&&(A|=1),A<<=1,this.readModule(0,_-3,w,_)&&(A|=1),A<<=1,this.readModule(0,_-2,w,_)&&(A|=1),A<<=1,this.readModule(0,_-1,w,_)&&(A|=1),A<<=1,this.readModule(1,_-3,w,_)&&(A|=1),A<<=1,this.readModule(1,_-2,w,_)&&(A|=1),A<<=1,this.readModule(1,_-1,w,_)&&(A|=1),A}readCorner4(w,_){let A=0;return this.readModule(w-3,0,w,_)&&(A|=1),A<<=1,this.readModule(w-2,0,w,_)&&(A|=1),A<<=1,this.readModule(w-1,0,w,_)&&(A|=1),A<<=1,this.readModule(0,_-2,w,_)&&(A|=1),A<<=1,this.readModule(0,_-1,w,_)&&(A|=1),A<<=1,this.readModule(1,_-1,w,_)&&(A|=1),A<<=1,this.readModule(2,_-1,w,_)&&(A|=1),A<<=1,this.readModule(3,_-1,w,_)&&(A|=1),A}extractDataRegion(w){const _=this.version.getSymbolSizeRows(),A=this.version.getSymbolSizeColumns();if(w.getHeight()!==_)throw new h("Dimension of bitMatrix must match the version size");const L=this.version.getDataRegionSizeRows(),z=this.version.getDataRegionSizeColumns(),K=_/L|0,Q=A/z|0,te=K*L,ae=Q*z,fe=new F(ae,te);for(let ve=0;ve<K;++ve){const we=ve*L;for(let Te=0;Te<Q;++Te){const Ve=Te*z;for(let We=0;We<L;++We){const at=ve*(L+2)+1+We,pt=we+We;for(let $t=0;$t<z;++$t){const zt=Te*(z+2)+1+$t;if(w.get(zt,at)){const Mt=Ve+$t;fe.set(Mt,pt)}}}}}return fe}}class vn{constructor(w,_){this.numDataCodewords=w,this.codewords=_}static getDataBlocks(w,_){const A=_.getECBlocks();let L=0;const z=A.getECBlocks();for(let We of z)L+=We.getCount();const K=new Array(L);let Q=0;for(let We of z)for(let at=0;at<We.getCount();at++){const pt=We.getDataCodewords(),$t=A.getECCodewords()+pt;K[Q++]=new vn(pt,new Uint8Array($t))}const ae=K[0].codewords.length-A.getECCodewords(),fe=ae-1;let ve=0;for(let We=0;We<fe;We++)for(let at=0;at<Q;at++)K[at].codewords[We]=w[ve++];const we=_.getVersionNumber()===24,Te=we?8:Q;for(let We=0;We<Te;We++)K[We].codewords[ae-1]=w[ve++];const Ve=K[0].codewords.length;for(let We=ae;We<Ve;We++)for(let at=0;at<Q;at++){const pt=we?(at+8)%Q:at,$t=we&&pt>7?We-1:We;K[pt].codewords[$t]=w[ve++]}if(ve!==w.length)throw new h;return K}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class bn{constructor(w){this.bytes=w,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(w){if(w<1||w>32||w>this.available())throw new h(""+w);let _=0,A=this.bitOffset,L=this.byteOffset;const z=this.bytes;if(A>0){const K=8-A,Q=w<K?w:K,te=K-Q,ae=255>>8-Q<<te;_=(z[L]&ae)>>te,w-=Q,A+=Q,A===8&&(A=0,L++)}if(w>0){for(;w>=8;)_=_<<8|z[L]&255,L++,w-=8;if(w>0){const K=8-w,Q=255>>K<<K;_=_<<w|(z[L]&Q)>>K,A+=w}}return this.bitOffset=A,this.byteOffset=L,_}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Vr;(function(xe){xe[xe.PAD_ENCODE=0]="PAD_ENCODE",xe[xe.ASCII_ENCODE=1]="ASCII_ENCODE",xe[xe.C40_ENCODE=2]="C40_ENCODE",xe[xe.TEXT_ENCODE=3]="TEXT_ENCODE",xe[xe.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",xe[xe.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",xe[xe.BASE256_ENCODE=6]="BASE256_ENCODE"})(Vr||(Vr={}));class Wn{static decode(w){const _=new bn(w),A=new I,L=new I,z=new Array;let K=Vr.ASCII_ENCODE;do if(K===Vr.ASCII_ENCODE)K=this.decodeAsciiSegment(_,A,L);else{switch(K){case Vr.C40_ENCODE:this.decodeC40Segment(_,A);break;case Vr.TEXT_ENCODE:this.decodeTextSegment(_,A);break;case Vr.ANSIX12_ENCODE:this.decodeAnsiX12Segment(_,A);break;case Vr.EDIFACT_ENCODE:this.decodeEdifactSegment(_,A);break;case Vr.BASE256_ENCODE:this.decodeBase256Segment(_,A,z);break;default:throw new R}K=Vr.ASCII_ENCODE}while(K!==Vr.PAD_ENCODE&&_.available()>0);return L.length()>0&&A.append(L.toString()),new H(w,A.toString(),z.length===0?null:z,null)}static decodeAsciiSegment(w,_,A){let L=!1;do{let z=w.readBits(8);if(z===0)throw new R;if(z<=128)return L&&(z+=128),_.append(String.fromCharCode(z-1)),Vr.ASCII_ENCODE;if(z===129)return Vr.PAD_ENCODE;if(z<=229){const K=z-130;K<10&&_.append("0"),_.append(""+K)}else switch(z){case 230:return Vr.C40_ENCODE;case 231:return Vr.BASE256_ENCODE;case 232:_.append("");break;case 233:case 234:break;case 235:L=!0;break;case 236:_.append("[)>05"),A.insert(0,"");break;case 237:_.append("[)>06"),A.insert(0,"");break;case 238:return Vr.ANSIX12_ENCODE;case 239:return Vr.TEXT_ENCODE;case 240:return Vr.EDIFACT_ENCODE;case 241:break;default:if(z!==254||w.available()!==0)throw new R;break}}while(w.available()>0);return Vr.ASCII_ENCODE}static decodeC40Segment(w,_){let A=!1;const L=[];let z=0;do{if(w.available()===8)return;const K=w.readBits(8);if(K===254)return;this.parseTwoBytes(K,w.readBits(8),L);for(let Q=0;Q<3;Q++){const te=L[Q];switch(z){case 0:if(te<3)z=te+1;else if(te<this.C40_BASIC_SET_CHARS.length){const ae=this.C40_BASIC_SET_CHARS[te];A?(_.append(String.fromCharCode(ae.charCodeAt(0)+128)),A=!1):_.append(ae)}else throw new R;break;case 1:A?(_.append(String.fromCharCode(te+128)),A=!1):_.append(String.fromCharCode(te)),z=0;break;case 2:if(te<this.C40_SHIFT2_SET_CHARS.length){const ae=this.C40_SHIFT2_SET_CHARS[te];A?(_.append(String.fromCharCode(ae.charCodeAt(0)+128)),A=!1):_.append(ae)}else switch(te){case 27:_.append("");break;case 30:A=!0;break;default:throw new R}z=0;break;case 3:A?(_.append(String.fromCharCode(te+224)),A=!1):_.append(String.fromCharCode(te+96)),z=0;break;default:throw new R}}}while(w.available()>0)}static decodeTextSegment(w,_){let A=!1,L=[],z=0;do{if(w.available()===8)return;const K=w.readBits(8);if(K===254)return;this.parseTwoBytes(K,w.readBits(8),L);for(let Q=0;Q<3;Q++){const te=L[Q];switch(z){case 0:if(te<3)z=te+1;else if(te<this.TEXT_BASIC_SET_CHARS.length){const ae=this.TEXT_BASIC_SET_CHARS[te];A?(_.append(String.fromCharCode(ae.charCodeAt(0)+128)),A=!1):_.append(ae)}else throw new R;break;case 1:A?(_.append(String.fromCharCode(te+128)),A=!1):_.append(String.fromCharCode(te)),z=0;break;case 2:if(te<this.TEXT_SHIFT2_SET_CHARS.length){const ae=this.TEXT_SHIFT2_SET_CHARS[te];A?(_.append(String.fromCharCode(ae.charCodeAt(0)+128)),A=!1):_.append(ae)}else switch(te){case 27:_.append("");break;case 30:A=!0;break;default:throw new R}z=0;break;case 3:if(te<this.TEXT_SHIFT3_SET_CHARS.length){const ae=this.TEXT_SHIFT3_SET_CHARS[te];A?(_.append(String.fromCharCode(ae.charCodeAt(0)+128)),A=!1):_.append(ae),z=0}else throw new R;break;default:throw new R}}}while(w.available()>0)}static decodeAnsiX12Segment(w,_){const A=[];do{if(w.available()===8)return;const L=w.readBits(8);if(L===254)return;this.parseTwoBytes(L,w.readBits(8),A);for(let z=0;z<3;z++){const K=A[z];switch(K){case 0:_.append("\r");break;case 1:_.append("*");break;case 2:_.append(">");break;case 3:_.append(" ");break;default:if(K<14)_.append(String.fromCharCode(K+44));else if(K<40)_.append(String.fromCharCode(K+51));else throw new R;break}}}while(w.available()>0)}static parseTwoBytes(w,_,A){let L=(w<<8)+_-1,z=Math.floor(L/1600);A[0]=z,L-=z*1600,z=Math.floor(L/40),A[1]=z,A[2]=L-z*40}static decodeEdifactSegment(w,_){do{if(w.available()<=16)return;for(let A=0;A<4;A++){let L=w.readBits(6);if(L===31){const z=8-w.getBitOffset();z!==8&&w.readBits(z);return}L&32||(L|=64),_.append(String.fromCharCode(L))}}while(w.available()>0)}static decodeBase256Segment(w,_,A){let L=1+w.getByteOffset();const z=this.unrandomize255State(w.readBits(8),L++);let K;if(z===0?K=w.available()/8|0:z<250?K=z:K=250*(z-249)+this.unrandomize255State(w.readBits(8),L++),K<0)throw new R;const Q=new Uint8Array(K);for(let te=0;te<K;te++){if(w.available()<8)throw new R;Q[te]=this.unrandomize255State(w.readBits(8),L++)}A.push(Q);try{_.append(Y.decode(Q,G.ISO88591))}catch(te){throw new pe("Platform does not support required encoding: "+te.message)}}static unrandomize255State(w,_){const A=149*_%255+1,L=w-A;return L>=0?L:L+256}}Wn.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Wn.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Wn.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Wn.TEXT_SHIFT2_SET_CHARS=Wn.C40_SHIFT2_SET_CHARS,Wn.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Ta{constructor(){this.rsDecoder=new ce(se.DATA_MATRIX_FIELD_256)}decode(w){const _=new xn(w),A=_.getVersion(),L=_.readCodewords(),z=vn.getDataBlocks(L,A);let K=0;for(let ae of z)K+=ae.getNumDataCodewords();const Q=new Uint8Array(K),te=z.length;for(let ae=0;ae<te;ae++){const fe=z[ae],ve=fe.getCodewords(),we=fe.getNumDataCodewords();this.correctErrors(ve,we);for(let Te=0;Te<we;Te++)Q[Te*te+ae]=ve[Te]}return Wn.decode(Q)}correctErrors(w,_){const A=new Int32Array(w);try{this.rsDecoder.decode(A,w.length-_)}catch{throw new m}for(let L=0;L<_;L++)w[L]=A[L]}}class wn{constructor(w){this.image=w,this.rectangleDetector=new Ne(this.image)}detect(){const w=this.rectangleDetector.detect();let _=this.detectSolid1(w);if(_=this.detectSolid2(_),_[3]=this.correctTopRight(_),!_[3])throw new S;_=this.shiftToModuleCenter(_);const A=_[0],L=_[1],z=_[2],K=_[3];let Q=this.transitionsBetween(A,K)+1,te=this.transitionsBetween(z,K)+1;(Q&1)===1&&(Q+=1),(te&1)===1&&(te+=1),4*Q<7*te&&4*te<7*Q&&(Q=te=Math.max(Q,te));let ae=wn.sampleGrid(this.image,A,L,z,K,Q,te);return new ye(ae,[A,L,z,K])}static shiftPoint(w,_,A){let L=(_.getX()-w.getX())/(A+1),z=(_.getY()-w.getY())/(A+1);return new be(w.getX()+L,w.getY()+z)}static moveAway(w,_,A){let L=w.getX(),z=w.getY();return L<_?L-=1:L+=1,z<A?z-=1:z+=1,new be(L,z)}detectSolid1(w){let _=w[0],A=w[1],L=w[3],z=w[2],K=this.transitionsBetween(_,A),Q=this.transitionsBetween(A,L),te=this.transitionsBetween(L,z),ae=this.transitionsBetween(z,_),fe=K,ve=[z,_,A,L];return fe>Q&&(fe=Q,ve[0]=_,ve[1]=A,ve[2]=L,ve[3]=z),fe>te&&(fe=te,ve[0]=A,ve[1]=L,ve[2]=z,ve[3]=_),fe>ae&&(ve[0]=L,ve[1]=z,ve[2]=_,ve[3]=A),ve}detectSolid2(w){let _=w[0],A=w[1],L=w[2],z=w[3],K=this.transitionsBetween(_,z),Q=wn.shiftPoint(A,L,(K+1)*4),te=wn.shiftPoint(L,A,(K+1)*4),ae=this.transitionsBetween(Q,_),fe=this.transitionsBetween(te,z);return ae<fe?(w[0]=_,w[1]=A,w[2]=L,w[3]=z):(w[0]=A,w[1]=L,w[2]=z,w[3]=_),w}correctTopRight(w){let _=w[0],A=w[1],L=w[2],z=w[3],K=this.transitionsBetween(_,z),Q=this.transitionsBetween(A,z),te=wn.shiftPoint(_,A,(Q+1)*4),ae=wn.shiftPoint(L,A,(K+1)*4);K=this.transitionsBetween(te,z),Q=this.transitionsBetween(ae,z);let fe=new be(z.getX()+(L.getX()-A.getX())/(K+1),z.getY()+(L.getY()-A.getY())/(K+1)),ve=new be(z.getX()+(_.getX()-A.getX())/(Q+1),z.getY()+(_.getY()-A.getY())/(Q+1));if(!this.isValid(fe))return this.isValid(ve)?ve:null;if(!this.isValid(ve))return fe;let we=this.transitionsBetween(te,fe)+this.transitionsBetween(ae,fe),Te=this.transitionsBetween(te,ve)+this.transitionsBetween(ae,ve);return we>Te?fe:ve}shiftToModuleCenter(w){let _=w[0],A=w[1],L=w[2],z=w[3],K=this.transitionsBetween(_,z)+1,Q=this.transitionsBetween(L,z)+1,te=wn.shiftPoint(_,A,Q*4),ae=wn.shiftPoint(L,A,K*4);K=this.transitionsBetween(te,z)+1,Q=this.transitionsBetween(ae,z)+1,(K&1)===1&&(K+=1),(Q&1)===1&&(Q+=1);let fe=(_.getX()+A.getX()+L.getX()+z.getX())/4,ve=(_.getY()+A.getY()+L.getY()+z.getY())/4;_=wn.moveAway(_,fe,ve),A=wn.moveAway(A,fe,ve),L=wn.moveAway(L,fe,ve),z=wn.moveAway(z,fe,ve);let we,Te;return te=wn.shiftPoint(_,A,Q*4),te=wn.shiftPoint(te,z,K*4),we=wn.shiftPoint(A,_,Q*4),we=wn.shiftPoint(we,L,K*4),ae=wn.shiftPoint(L,z,Q*4),ae=wn.shiftPoint(ae,A,K*4),Te=wn.shiftPoint(z,L,Q*4),Te=wn.shiftPoint(Te,_,K*4),[te,we,ae,Te]}isValid(w){return w.getX()>=0&&w.getX()<this.image.getWidth()&&w.getY()>0&&w.getY()<this.image.getHeight()}static sampleGrid(w,_,A,L,z,K,Q){return Ie.getInstance().sampleGrid(w,K,Q,.5,.5,K-.5,.5,K-.5,Q-.5,.5,Q-.5,_.getX(),_.getY(),z.getX(),z.getY(),L.getX(),L.getY(),A.getX(),A.getY())}transitionsBetween(w,_){let A=Math.trunc(w.getX()),L=Math.trunc(w.getY()),z=Math.trunc(_.getX()),K=Math.trunc(_.getY()),Q=Math.abs(K-L)>Math.abs(z-A);if(Q){let We=A;A=L,L=We,We=z,z=K,K=We}let te=Math.abs(z-A),ae=Math.abs(K-L),fe=-te/2,ve=L<K?1:-1,we=A<z?1:-1,Te=0,Ve=this.image.get(Q?L:A,Q?A:L);for(let We=A,at=L;We!==z;We+=we){let pt=this.image.get(Q?at:We,Q?We:at);if(pt!==Ve&&(Te++,Ve=pt),fe+=ae,fe>0){if(at===K)break;at+=ve,fe-=te}}return Te}}class Ka{constructor(){this.decoder=new Ta}decode(w,_=null){let A,L;if(_!=null&&_.has(O.PURE_BARCODE)){const ae=Ka.extractPureBits(w.getBlackMatrix());A=this.decoder.decode(ae),L=Ka.NO_POINTS}else{const ae=new wn(w.getBlackMatrix()).detect();A=this.decoder.decode(ae.getBits()),L=ae.getPoints()}const z=A.getRawBytes(),K=new Z(A.getText(),z,8*z.length,L,W.DATA_MATRIX,g.currentTimeMillis()),Q=A.getByteSegments();Q!=null&&K.putMetadata(V.BYTE_SEGMENTS,Q);const te=A.getECLevel();return te!=null&&K.putMetadata(V.ERROR_CORRECTION_LEVEL,te),K}reset(){}static extractPureBits(w){const _=w.getTopLeftOnBit(),A=w.getBottomRightOnBit();if(_==null||A==null)throw new S;const L=this.moduleSize(_,w);let z=_[1];const K=A[1];let Q=_[0];const ae=(A[0]-Q+1)/L,fe=(K-z+1)/L;if(ae<=0||fe<=0)throw new S;const ve=L/2;z+=ve,Q+=ve;const we=new F(ae,fe);for(let Te=0;Te<fe;Te++){const Ve=z+Te*L;for(let We=0;We<ae;We++)w.get(Q+We*L,Ve)&&we.set(We,Te)}return we}static moduleSize(w,_){const A=_.getWidth();let L=w[0];const z=w[1];for(;L<A&&_.get(L,z);)L++;if(L===A)throw new S;const K=L-w[0];if(K===0)throw new S;return K}}Ka.NO_POINTS=[];class vd extends X{constructor(w=500){super(new Ka,w)}}var Xi;(function(xe){xe[xe.L=0]="L",xe[xe.M=1]="M",xe[xe.Q=2]="Q",xe[xe.H=3]="H"})(Xi||(Xi={}));class _n{constructor(w,_,A){this.value=w,this.stringValue=_,this.bits=A,_n.FOR_BITS.set(A,this),_n.FOR_VALUE.set(w,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(w){switch(w){case"L":return _n.L;case"M":return _n.M;case"Q":return _n.Q;case"H":return _n.H;default:throw new u(w+"not available")}}toString(){return this.stringValue}equals(w){if(!(w instanceof _n))return!1;const _=w;return this.value===_.value}static forBits(w){if(w<0||w>=_n.FOR_BITS.size)throw new h;return _n.FOR_BITS.get(w)}}_n.FOR_BITS=new Map,_n.FOR_VALUE=new Map,_n.L=new _n(Xi.L,"L",1),_n.M=new _n(Xi.M,"M",0),_n.Q=new _n(Xi.Q,"Q",3),_n.H=new _n(Xi.H,"H",2);class Br{constructor(w){this.errorCorrectionLevel=_n.forBits(w>>3&3),this.dataMask=w&7}static numBitsDiffering(w,_){return b.bitCount(w^_)}static decodeFormatInformation(w,_){const A=Br.doDecodeFormatInformation(w,_);return A!==null?A:Br.doDecodeFormatInformation(w^Br.FORMAT_INFO_MASK_QR,_^Br.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(w,_){let A=Number.MAX_SAFE_INTEGER,L=0;for(const z of Br.FORMAT_INFO_DECODE_LOOKUP){const K=z[0];if(K===w||K===_)return new Br(z[1]);let Q=Br.numBitsDiffering(w,K);Q<A&&(L=z[1],A=Q),w!==_&&(Q=Br.numBitsDiffering(_,K),Q<A&&(L=z[1],A=Q))}return A<=3?new Br(L):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(w){if(!(w instanceof Br))return!1;const _=w;return this.errorCorrectionLevel===_.errorCorrectionLevel&&this.dataMask===_.dataMask}}Br.FORMAT_INFO_MASK_QR=21522,Br.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class Ye{constructor(w,..._){this.ecCodewordsPerBlock=w,this.ecBlocks=_}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let w=0;const _=this.ecBlocks;for(const A of _)w+=A.getCount();return w}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class Ee{constructor(w,_){this.count=w,this.dataCodewords=_}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ur{constructor(w,_,...A){this.versionNumber=w,this.alignmentPatternCenters=_,this.ecBlocks=A;let L=0;const z=A[0].getECCodewordsPerBlock(),K=A[0].getECBlocks();for(const Q of K)L+=Q.getCount()*(Q.getDataCodewords()+z);this.totalCodewords=L}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(w){return this.ecBlocks[w.getValue()]}static getProvisionalVersionForDimension(w){if(w%4!==1)throw new R;try{return this.getVersionForNumber((w-17)/4)}catch{throw new R}}static getVersionForNumber(w){if(w<1||w>40)throw new h;return ur.VERSIONS[w-1]}static decodeVersionInformation(w){let _=Number.MAX_SAFE_INTEGER,A=0;for(let L=0;L<ur.VERSION_DECODE_INFO.length;L++){const z=ur.VERSION_DECODE_INFO[L];if(z===w)return ur.getVersionForNumber(L+7);const K=Br.numBitsDiffering(w,z);K<_&&(A=L+7,_=K)}return _<=3?ur.getVersionForNumber(A):null}buildFunctionPattern(){const w=this.getDimensionForVersion(),_=new F(w);_.setRegion(0,0,9,9),_.setRegion(w-8,0,8,9),_.setRegion(0,w-8,9,8);const A=this.alignmentPatternCenters.length;for(let L=0;L<A;L++){const z=this.alignmentPatternCenters[L]-2;for(let K=0;K<A;K++)L===0&&(K===0||K===A-1)||L===A-1&&K===0||_.setRegion(this.alignmentPatternCenters[K]-2,z,5,5)}return _.setRegion(6,9,1,w-17),_.setRegion(9,6,w-17,1),this.versionNumber>6&&(_.setRegion(w-11,0,3,6),_.setRegion(0,w-11,6,3)),_}toString(){return""+this.versionNumber}}ur.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ur.VERSIONS=[new ur(1,new Int32Array(0),new Ye(7,new Ee(1,19)),new Ye(10,new Ee(1,16)),new Ye(13,new Ee(1,13)),new Ye(17,new Ee(1,9))),new ur(2,Int32Array.from([6,18]),new Ye(10,new Ee(1,34)),new Ye(16,new Ee(1,28)),new Ye(22,new Ee(1,22)),new Ye(28,new Ee(1,16))),new ur(3,Int32Array.from([6,22]),new Ye(15,new Ee(1,55)),new Ye(26,new Ee(1,44)),new Ye(18,new Ee(2,17)),new Ye(22,new Ee(2,13))),new ur(4,Int32Array.from([6,26]),new Ye(20,new Ee(1,80)),new Ye(18,new Ee(2,32)),new Ye(26,new Ee(2,24)),new Ye(16,new Ee(4,9))),new ur(5,Int32Array.from([6,30]),new Ye(26,new Ee(1,108)),new Ye(24,new Ee(2,43)),new Ye(18,new Ee(2,15),new Ee(2,16)),new Ye(22,new Ee(2,11),new Ee(2,12))),new ur(6,Int32Array.from([6,34]),new Ye(18,new Ee(2,68)),new Ye(16,new Ee(4,27)),new Ye(24,new Ee(4,19)),new Ye(28,new Ee(4,15))),new ur(7,Int32Array.from([6,22,38]),new Ye(20,new Ee(2,78)),new Ye(18,new Ee(4,31)),new Ye(18,new Ee(2,14),new Ee(4,15)),new Ye(26,new Ee(4,13),new Ee(1,14))),new ur(8,Int32Array.from([6,24,42]),new Ye(24,new Ee(2,97)),new Ye(22,new Ee(2,38),new Ee(2,39)),new Ye(22,new Ee(4,18),new Ee(2,19)),new Ye(26,new Ee(4,14),new Ee(2,15))),new ur(9,Int32Array.from([6,26,46]),new Ye(30,new Ee(2,116)),new Ye(22,new Ee(3,36),new Ee(2,37)),new Ye(20,new Ee(4,16),new Ee(4,17)),new Ye(24,new Ee(4,12),new Ee(4,13))),new ur(10,Int32Array.from([6,28,50]),new Ye(18,new Ee(2,68),new Ee(2,69)),new Ye(26,new Ee(4,43),new Ee(1,44)),new Ye(24,new Ee(6,19),new Ee(2,20)),new Ye(28,new Ee(6,15),new Ee(2,16))),new ur(11,Int32Array.from([6,30,54]),new Ye(20,new Ee(4,81)),new Ye(30,new Ee(1,50),new Ee(4,51)),new Ye(28,new Ee(4,22),new Ee(4,23)),new Ye(24,new Ee(3,12),new Ee(8,13))),new ur(12,Int32Array.from([6,32,58]),new Ye(24,new Ee(2,92),new Ee(2,93)),new Ye(22,new Ee(6,36),new Ee(2,37)),new Ye(26,new Ee(4,20),new Ee(6,21)),new Ye(28,new Ee(7,14),new Ee(4,15))),new ur(13,Int32Array.from([6,34,62]),new Ye(26,new Ee(4,107)),new Ye(22,new Ee(8,37),new Ee(1,38)),new Ye(24,new Ee(8,20),new Ee(4,21)),new Ye(22,new Ee(12,11),new Ee(4,12))),new ur(14,Int32Array.from([6,26,46,66]),new Ye(30,new Ee(3,115),new Ee(1,116)),new Ye(24,new Ee(4,40),new Ee(5,41)),new Ye(20,new Ee(11,16),new Ee(5,17)),new Ye(24,new Ee(11,12),new Ee(5,13))),new ur(15,Int32Array.from([6,26,48,70]),new Ye(22,new Ee(5,87),new Ee(1,88)),new Ye(24,new Ee(5,41),new Ee(5,42)),new Ye(30,new Ee(5,24),new Ee(7,25)),new Ye(24,new Ee(11,12),new Ee(7,13))),new ur(16,Int32Array.from([6,26,50,74]),new Ye(24,new Ee(5,98),new Ee(1,99)),new Ye(28,new Ee(7,45),new Ee(3,46)),new Ye(24,new Ee(15,19),new Ee(2,20)),new Ye(30,new Ee(3,15),new Ee(13,16))),new ur(17,Int32Array.from([6,30,54,78]),new Ye(28,new Ee(1,107),new Ee(5,108)),new Ye(28,new Ee(10,46),new Ee(1,47)),new Ye(28,new Ee(1,22),new Ee(15,23)),new Ye(28,new Ee(2,14),new Ee(17,15))),new ur(18,Int32Array.from([6,30,56,82]),new Ye(30,new Ee(5,120),new Ee(1,121)),new Ye(26,new Ee(9,43),new Ee(4,44)),new Ye(28,new Ee(17,22),new Ee(1,23)),new Ye(28,new Ee(2,14),new Ee(19,15))),new ur(19,Int32Array.from([6,30,58,86]),new Ye(28,new Ee(3,113),new Ee(4,114)),new Ye(26,new Ee(3,44),new Ee(11,45)),new Ye(26,new Ee(17,21),new Ee(4,22)),new Ye(26,new Ee(9,13),new Ee(16,14))),new ur(20,Int32Array.from([6,34,62,90]),new Ye(28,new Ee(3,107),new Ee(5,108)),new Ye(26,new Ee(3,41),new Ee(13,42)),new Ye(30,new Ee(15,24),new Ee(5,25)),new Ye(28,new Ee(15,15),new Ee(10,16))),new ur(21,Int32Array.from([6,28,50,72,94]),new Ye(28,new Ee(4,116),new Ee(4,117)),new Ye(26,new Ee(17,42)),new Ye(28,new Ee(17,22),new Ee(6,23)),new Ye(30,new Ee(19,16),new Ee(6,17))),new ur(22,Int32Array.from([6,26,50,74,98]),new Ye(28,new Ee(2,111),new Ee(7,112)),new Ye(28,new Ee(17,46)),new Ye(30,new Ee(7,24),new Ee(16,25)),new Ye(24,new Ee(34,13))),new ur(23,Int32Array.from([6,30,54,78,102]),new Ye(30,new Ee(4,121),new Ee(5,122)),new Ye(28,new Ee(4,47),new Ee(14,48)),new Ye(30,new Ee(11,24),new Ee(14,25)),new Ye(30,new Ee(16,15),new Ee(14,16))),new ur(24,Int32Array.from([6,28,54,80,106]),new Ye(30,new Ee(6,117),new Ee(4,118)),new Ye(28,new Ee(6,45),new Ee(14,46)),new Ye(30,new Ee(11,24),new Ee(16,25)),new Ye(30,new Ee(30,16),new Ee(2,17))),new ur(25,Int32Array.from([6,32,58,84,110]),new Ye(26,new Ee(8,106),new Ee(4,107)),new Ye(28,new Ee(8,47),new Ee(13,48)),new Ye(30,new Ee(7,24),new Ee(22,25)),new Ye(30,new Ee(22,15),new Ee(13,16))),new ur(26,Int32Array.from([6,30,58,86,114]),new Ye(28,new Ee(10,114),new Ee(2,115)),new Ye(28,new Ee(19,46),new Ee(4,47)),new Ye(28,new Ee(28,22),new Ee(6,23)),new Ye(30,new Ee(33,16),new Ee(4,17))),new ur(27,Int32Array.from([6,34,62,90,118]),new Ye(30,new Ee(8,122),new Ee(4,123)),new Ye(28,new Ee(22,45),new Ee(3,46)),new Ye(30,new Ee(8,23),new Ee(26,24)),new Ye(30,new Ee(12,15),new Ee(28,16))),new ur(28,Int32Array.from([6,26,50,74,98,122]),new Ye(30,new Ee(3,117),new Ee(10,118)),new Ye(28,new Ee(3,45),new Ee(23,46)),new Ye(30,new Ee(4,24),new Ee(31,25)),new Ye(30,new Ee(11,15),new Ee(31,16))),new ur(29,Int32Array.from([6,30,54,78,102,126]),new Ye(30,new Ee(7,116),new Ee(7,117)),new Ye(28,new Ee(21,45),new Ee(7,46)),new Ye(30,new Ee(1,23),new Ee(37,24)),new Ye(30,new Ee(19,15),new Ee(26,16))),new ur(30,Int32Array.from([6,26,52,78,104,130]),new Ye(30,new Ee(5,115),new Ee(10,116)),new Ye(28,new Ee(19,47),new Ee(10,48)),new Ye(30,new Ee(15,24),new Ee(25,25)),new Ye(30,new Ee(23,15),new Ee(25,16))),new ur(31,Int32Array.from([6,30,56,82,108,134]),new Ye(30,new Ee(13,115),new Ee(3,116)),new Ye(28,new Ee(2,46),new Ee(29,47)),new Ye(30,new Ee(42,24),new Ee(1,25)),new Ye(30,new Ee(23,15),new Ee(28,16))),new ur(32,Int32Array.from([6,34,60,86,112,138]),new Ye(30,new Ee(17,115)),new Ye(28,new Ee(10,46),new Ee(23,47)),new Ye(30,new Ee(10,24),new Ee(35,25)),new Ye(30,new Ee(19,15),new Ee(35,16))),new ur(33,Int32Array.from([6,30,58,86,114,142]),new Ye(30,new Ee(17,115),new Ee(1,116)),new Ye(28,new Ee(14,46),new Ee(21,47)),new Ye(30,new Ee(29,24),new Ee(19,25)),new Ye(30,new Ee(11,15),new Ee(46,16))),new ur(34,Int32Array.from([6,34,62,90,118,146]),new Ye(30,new Ee(13,115),new Ee(6,116)),new Ye(28,new Ee(14,46),new Ee(23,47)),new Ye(30,new Ee(44,24),new Ee(7,25)),new Ye(30,new Ee(59,16),new Ee(1,17))),new ur(35,Int32Array.from([6,30,54,78,102,126,150]),new Ye(30,new Ee(12,121),new Ee(7,122)),new Ye(28,new Ee(12,47),new Ee(26,48)),new Ye(30,new Ee(39,24),new Ee(14,25)),new Ye(30,new Ee(22,15),new Ee(41,16))),new ur(36,Int32Array.from([6,24,50,76,102,128,154]),new Ye(30,new Ee(6,121),new Ee(14,122)),new Ye(28,new Ee(6,47),new Ee(34,48)),new Ye(30,new Ee(46,24),new Ee(10,25)),new Ye(30,new Ee(2,15),new Ee(64,16))),new ur(37,Int32Array.from([6,28,54,80,106,132,158]),new Ye(30,new Ee(17,122),new Ee(4,123)),new Ye(28,new Ee(29,46),new Ee(14,47)),new Ye(30,new Ee(49,24),new Ee(10,25)),new Ye(30,new Ee(24,15),new Ee(46,16))),new ur(38,Int32Array.from([6,32,58,84,110,136,162]),new Ye(30,new Ee(4,122),new Ee(18,123)),new Ye(28,new Ee(13,46),new Ee(32,47)),new Ye(30,new Ee(48,24),new Ee(14,25)),new Ye(30,new Ee(42,15),new Ee(32,16))),new ur(39,Int32Array.from([6,26,54,82,110,138,166]),new Ye(30,new Ee(20,117),new Ee(4,118)),new Ye(28,new Ee(40,47),new Ee(7,48)),new Ye(30,new Ee(43,24),new Ee(22,25)),new Ye(30,new Ee(10,15),new Ee(67,16))),new ur(40,Int32Array.from([6,30,58,86,114,142,170]),new Ye(30,new Ee(19,118),new Ee(6,119)),new Ye(28,new Ee(18,47),new Ee(31,48)),new Ye(30,new Ee(34,24),new Ee(34,25)),new Ye(30,new Ee(20,15),new Ee(61,16)))];var xs;(function(xe){xe[xe.DATA_MASK_000=0]="DATA_MASK_000",xe[xe.DATA_MASK_001=1]="DATA_MASK_001",xe[xe.DATA_MASK_010=2]="DATA_MASK_010",xe[xe.DATA_MASK_011=3]="DATA_MASK_011",xe[xe.DATA_MASK_100=4]="DATA_MASK_100",xe[xe.DATA_MASK_101=5]="DATA_MASK_101",xe[xe.DATA_MASK_110=6]="DATA_MASK_110",xe[xe.DATA_MASK_111=7]="DATA_MASK_111"})(xs||(xs={}));class Yn{constructor(w,_){this.value=w,this.isMasked=_}unmaskBitMatrix(w,_){for(let A=0;A<_;A++)for(let L=0;L<_;L++)this.isMasked(A,L)&&w.flip(L,A)}}Yn.values=new Map([[xs.DATA_MASK_000,new Yn(xs.DATA_MASK_000,(xe,w)=>(xe+w&1)===0)],[xs.DATA_MASK_001,new Yn(xs.DATA_MASK_001,(xe,w)=>(xe&1)===0)],[xs.DATA_MASK_010,new Yn(xs.DATA_MASK_010,(xe,w)=>w%3===0)],[xs.DATA_MASK_011,new Yn(xs.DATA_MASK_011,(xe,w)=>(xe+w)%3===0)],[xs.DATA_MASK_100,new Yn(xs.DATA_MASK_100,(xe,w)=>(Math.floor(xe/2)+Math.floor(w/3)&1)===0)],[xs.DATA_MASK_101,new Yn(xs.DATA_MASK_101,(xe,w)=>xe*w%6===0)],[xs.DATA_MASK_110,new Yn(xs.DATA_MASK_110,(xe,w)=>xe*w%6<3)],[xs.DATA_MASK_111,new Yn(xs.DATA_MASK_111,(xe,w)=>(xe+w+xe*w%3&1)===0)]]);class Yo{constructor(w){const _=w.getHeight();if(_<21||(_&3)!==1)throw new R;this.bitMatrix=w}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let w=0;for(let z=0;z<6;z++)w=this.copyBit(z,8,w);w=this.copyBit(7,8,w),w=this.copyBit(8,8,w),w=this.copyBit(8,7,w);for(let z=5;z>=0;z--)w=this.copyBit(8,z,w);const _=this.bitMatrix.getHeight();let A=0;const L=_-7;for(let z=_-1;z>=L;z--)A=this.copyBit(8,z,A);for(let z=_-8;z<_;z++)A=this.copyBit(z,8,A);if(this.parsedFormatInfo=Br.decodeFormatInformation(w,A),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new R}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const w=this.bitMatrix.getHeight(),_=Math.floor((w-17)/4);if(_<=6)return ur.getVersionForNumber(_);let A=0;const L=w-11;for(let K=5;K>=0;K--)for(let Q=w-9;Q>=L;Q--)A=this.copyBit(Q,K,A);let z=ur.decodeVersionInformation(A);if(z!==null&&z.getDimensionForVersion()===w)return this.parsedVersion=z,z;A=0;for(let K=5;K>=0;K--)for(let Q=w-9;Q>=L;Q--)A=this.copyBit(K,Q,A);if(z=ur.decodeVersionInformation(A),z!==null&&z.getDimensionForVersion()===w)return this.parsedVersion=z,z;throw new R}copyBit(w,_,A){return(this.isMirror?this.bitMatrix.get(_,w):this.bitMatrix.get(w,_))?A<<1|1:A<<1}readCodewords(){const w=this.readFormatInformation(),_=this.readVersion(),A=Yn.values.get(w.getDataMask()),L=this.bitMatrix.getHeight();A.unmaskBitMatrix(this.bitMatrix,L);const z=_.buildFunctionPattern();let K=!0;const Q=new Uint8Array(_.getTotalCodewords());let te=0,ae=0,fe=0;for(let ve=L-1;ve>0;ve-=2){ve===6&&ve--;for(let we=0;we<L;we++){const Te=K?L-1-we:we;for(let Ve=0;Ve<2;Ve++)z.get(ve-Ve,Te)||(fe++,ae<<=1,this.bitMatrix.get(ve-Ve,Te)&&(ae|=1),fe===8&&(Q[te++]=ae,fe=0,ae=0))}K=!K}if(te!==_.getTotalCodewords())throw new R;return Q}remask(){if(this.parsedFormatInfo===null)return;const w=Yn.values[this.parsedFormatInfo.getDataMask()],_=this.bitMatrix.getHeight();w.unmaskBitMatrix(this.bitMatrix,_)}setMirror(w){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=w}mirror(){const w=this.bitMatrix;for(let _=0,A=w.getWidth();_<A;_++)for(let L=_+1,z=w.getHeight();L<z;L++)w.get(_,L)!==w.get(L,_)&&(w.flip(L,_),w.flip(_,L))}}class wo{constructor(w,_){this.numDataCodewords=w,this.codewords=_}static getDataBlocks(w,_,A){if(w.length!==_.getTotalCodewords())throw new h;const L=_.getECBlocksForLevel(A);let z=0;const K=L.getECBlocks();for(const Ve of K)z+=Ve.getCount();const Q=new Array(z);let te=0;for(const Ve of K)for(let We=0;We<Ve.getCount();We++){const at=Ve.getDataCodewords(),pt=L.getECCodewordsPerBlock()+at;Q[te++]=new wo(at,new Uint8Array(pt))}const ae=Q[0].codewords.length;let fe=Q.length-1;for(;fe>=0&&Q[fe].codewords.length!==ae;)fe--;fe++;const ve=ae-L.getECCodewordsPerBlock();let we=0;for(let Ve=0;Ve<ve;Ve++)for(let We=0;We<te;We++)Q[We].codewords[Ve]=w[we++];for(let Ve=fe;Ve<te;Ve++)Q[Ve].codewords[ve]=w[we++];const Te=Q[0].codewords.length;for(let Ve=ve;Ve<Te;Ve++)for(let We=0;We<te;We++){const at=We<fe?Ve:Ve+1;Q[We].codewords[at]=w[we++]}return Q}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var _a;(function(xe){xe[xe.TERMINATOR=0]="TERMINATOR",xe[xe.NUMERIC=1]="NUMERIC",xe[xe.ALPHANUMERIC=2]="ALPHANUMERIC",xe[xe.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",xe[xe.BYTE=4]="BYTE",xe[xe.ECI=5]="ECI",xe[xe.KANJI=6]="KANJI",xe[xe.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",xe[xe.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",xe[xe.HANZI=9]="HANZI"})(_a||(_a={}));class vr{constructor(w,_,A,L){this.value=w,this.stringValue=_,this.characterCountBitsForVersions=A,this.bits=L,vr.FOR_BITS.set(L,this),vr.FOR_VALUE.set(w,this)}static forBits(w){const _=vr.FOR_BITS.get(w);if(_===void 0)throw new h;return _}getCharacterCountBits(w){const _=w.getVersionNumber();let A;return _<=9?A=0:_<=26?A=1:A=2,this.characterCountBitsForVersions[A]}getValue(){return this.value}getBits(){return this.bits}equals(w){if(!(w instanceof vr))return!1;const _=w;return this.value===_.value}toString(){return this.stringValue}}vr.FOR_BITS=new Map,vr.FOR_VALUE=new Map,vr.TERMINATOR=new vr(_a.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),vr.NUMERIC=new vr(_a.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),vr.ALPHANUMERIC=new vr(_a.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),vr.STRUCTURED_APPEND=new vr(_a.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),vr.BYTE=new vr(_a.BYTE,"BYTE",Int32Array.from([8,16,16]),4),vr.ECI=new vr(_a.ECI,"ECI",Int32Array.from([0,0,0]),7),vr.KANJI=new vr(_a.KANJI,"KANJI",Int32Array.from([8,10,12]),8),vr.FNC1_FIRST_POSITION=new vr(_a.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),vr.FNC1_SECOND_POSITION=new vr(_a.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),vr.HANZI=new vr(_a.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Rn{static decode(w,_,A,L){const z=new bn(w);let K=new I;const Q=new Array;let te=-1,ae=-1;try{let fe=null,ve=!1,we;do{if(z.available()<4)we=vr.TERMINATOR;else{const Te=z.readBits(4);we=vr.forBits(Te)}switch(we){case vr.TERMINATOR:break;case vr.FNC1_FIRST_POSITION:case vr.FNC1_SECOND_POSITION:ve=!0;break;case vr.STRUCTURED_APPEND:if(z.available()<16)throw new R;te=z.readBits(8),ae=z.readBits(8);break;case vr.ECI:const Te=Rn.parseECIValue(z);if(fe=B.getCharacterSetECIByValue(Te),fe===null)throw new R;break;case vr.HANZI:const Ve=z.readBits(4),We=z.readBits(we.getCharacterCountBits(_));Ve===Rn.GB2312_SUBSET&&Rn.decodeHanziSegment(z,K,We);break;default:const at=z.readBits(we.getCharacterCountBits(_));switch(we){case vr.NUMERIC:Rn.decodeNumericSegment(z,K,at);break;case vr.ALPHANUMERIC:Rn.decodeAlphanumericSegment(z,K,at,ve);break;case vr.BYTE:Rn.decodeByteSegment(z,K,at,fe,Q,L);break;case vr.KANJI:Rn.decodeKanjiSegment(z,K,at);break;default:throw new R}break}}while(we!==vr.TERMINATOR)}catch{throw new R}return new H(w,K.toString(),Q.length===0?null:Q,A===null?null:A.toString(),te,ae)}static decodeHanziSegment(w,_,A){if(A*13>w.available())throw new R;const L=new Uint8Array(2*A);let z=0;for(;A>0;){const K=w.readBits(13);let Q=K/96<<8&4294967295|K%96;Q<959?Q+=41377:Q+=42657,L[z]=Q>>8&255,L[z+1]=Q&255,z+=2,A--}try{_.append(Y.decode(L,G.GB2312))}catch(K){throw new R(K)}}static decodeKanjiSegment(w,_,A){if(A*13>w.available())throw new R;const L=new Uint8Array(2*A);let z=0;for(;A>0;){const K=w.readBits(13);let Q=K/192<<8&4294967295|K%192;Q<7936?Q+=33088:Q+=49472,L[z]=Q>>8,L[z+1]=Q,z+=2,A--}try{_.append(Y.decode(L,G.SHIFT_JIS))}catch(K){throw new R(K)}}static decodeByteSegment(w,_,A,L,z,K){if(8*A>w.available())throw new R;const Q=new Uint8Array(A);for(let ae=0;ae<A;ae++)Q[ae]=w.readBits(8);let te;L===null?te=G.guessEncoding(Q,K):te=L.getName();try{_.append(Y.decode(Q,te))}catch(ae){throw new R(ae)}z.push(Q)}static toAlphaNumericChar(w){if(w>=Rn.ALPHANUMERIC_CHARS.length)throw new R;return Rn.ALPHANUMERIC_CHARS[w]}static decodeAlphanumericSegment(w,_,A,L){const z=_.length();for(;A>1;){if(w.available()<11)throw new R;const K=w.readBits(11);_.append(Rn.toAlphaNumericChar(Math.floor(K/45))),_.append(Rn.toAlphaNumericChar(K%45)),A-=2}if(A===1){if(w.available()<6)throw new R;_.append(Rn.toAlphaNumericChar(w.readBits(6)))}if(L)for(let K=z;K<_.length();K++)_.charAt(K)==="%"&&(K<_.length()-1&&_.charAt(K+1)==="%"?_.deleteCharAt(K+1):_.setCharAt(K,""))}static decodeNumericSegment(w,_,A){for(;A>=3;){if(w.available()<10)throw new R;const L=w.readBits(10);if(L>=1e3)throw new R;_.append(Rn.toAlphaNumericChar(Math.floor(L/100))),_.append(Rn.toAlphaNumericChar(Math.floor(L/10)%10)),_.append(Rn.toAlphaNumericChar(L%10)),A-=3}if(A===2){if(w.available()<7)throw new R;const L=w.readBits(7);if(L>=100)throw new R;_.append(Rn.toAlphaNumericChar(Math.floor(L/10))),_.append(Rn.toAlphaNumericChar(L%10))}else if(A===1){if(w.available()<4)throw new R;const L=w.readBits(4);if(L>=10)throw new R;_.append(Rn.toAlphaNumericChar(L))}}static parseECIValue(w){const _=w.readBits(8);if(!(_&128))return _&127;if((_&192)===128){const A=w.readBits(8);return(_&63)<<8&4294967295|A}if((_&224)===192){const A=w.readBits(16);return(_&31)<<16&4294967295|A}throw new R}}Rn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Rn.GB2312_SUBSET=1;class Zo{constructor(w){this.mirrored=w}isMirrored(){return this.mirrored}applyMirroredCorrection(w){if(!this.mirrored||w===null||w.length<3)return;const _=w[0];w[0]=w[2],w[2]=_}}class O1{constructor(){this.rsDecoder=new ce(se.QR_CODE_FIELD_256)}decodeBooleanArray(w,_){return this.decodeBitMatrix(F.parseFromBooleanArray(w),_)}decodeBitMatrix(w,_){const A=new Yo(w);let L=null;try{return this.decodeBitMatrixParser(A,_)}catch(z){L=z}try{A.remask(),A.setMirror(!0),A.readVersion(),A.readFormatInformation(),A.mirror();const z=this.decodeBitMatrixParser(A,_);return z.setOther(new Zo(!0)),z}catch(z){throw L!==null?L:z}}decodeBitMatrixParser(w,_){const A=w.readVersion(),L=w.readFormatInformation().getErrorCorrectionLevel(),z=w.readCodewords(),K=wo.getDataBlocks(z,A,L);let Q=0;for(const fe of K)Q+=fe.getNumDataCodewords();const te=new Uint8Array(Q);let ae=0;for(const fe of K){const ve=fe.getCodewords(),we=fe.getNumDataCodewords();this.correctErrors(ve,we);for(let Te=0;Te<we;Te++)te[ae++]=ve[Te]}return Rn.decode(te,A,L,_)}correctErrors(w,_){const A=new Int32Array(w);try{this.rsDecoder.decode(A,w.length-_)}catch{throw new m}for(let L=0;L<_;L++)w[L]=A[L]}}class yd extends be{constructor(w,_,A){super(w,_),this.estimatedModuleSize=A}aboutEquals(w,_,A){if(Math.abs(_-this.getY())<=w&&Math.abs(A-this.getX())<=w){const L=Math.abs(w-this.estimatedModuleSize);return L<=1||L<=this.estimatedModuleSize}return!1}combineEstimate(w,_,A){const L=(this.getX()+_)/2,z=(this.getY()+w)/2,K=(this.estimatedModuleSize+A)/2;return new yd(L,z,K)}}class bd{constructor(w,_,A,L,z,K,Q){this.image=w,this.startX=_,this.startY=A,this.width=L,this.height=z,this.moduleSize=K,this.resultPointCallback=Q,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const w=this.startX,_=this.height,A=this.width,L=w+A,z=this.startY+_/2,K=new Int32Array(3),Q=this.image;for(let te=0;te<_;te++){const ae=z+(te&1?-Math.floor((te+1)/2):Math.floor((te+1)/2));K[0]=0,K[1]=0,K[2]=0;let fe=w;for(;fe<L&&!Q.get(fe,ae);)fe++;let ve=0;for(;fe<L;){if(Q.get(fe,ae))if(ve===1)K[1]++;else if(ve===2){if(this.foundPatternCross(K)){const we=this.handlePossibleCenter(K,ae,fe);if(we!==null)return we}K[0]=K[2],K[1]=1,K[2]=0,ve=1}else K[++ve]++;else ve===1&&ve++,K[ve]++;fe++}if(this.foundPatternCross(K)){const we=this.handlePossibleCenter(K,ae,L);if(we!==null)return we}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new S}static centerFromEnd(w,_){return _-w[2]-w[1]/2}foundPatternCross(w){const _=this.moduleSize,A=_/2;for(let L=0;L<3;L++)if(Math.abs(_-w[L])>=A)return!1;return!0}crossCheckVertical(w,_,A,L){const z=this.image,K=z.getHeight(),Q=this.crossCheckStateCount;Q[0]=0,Q[1]=0,Q[2]=0;let te=w;for(;te>=0&&z.get(_,te)&&Q[1]<=A;)Q[1]++,te--;if(te<0||Q[1]>A)return NaN;for(;te>=0&&!z.get(_,te)&&Q[0]<=A;)Q[0]++,te--;if(Q[0]>A)return NaN;for(te=w+1;te<K&&z.get(_,te)&&Q[1]<=A;)Q[1]++,te++;if(te===K||Q[1]>A)return NaN;for(;te<K&&!z.get(_,te)&&Q[2]<=A;)Q[2]++,te++;if(Q[2]>A)return NaN;const ae=Q[0]+Q[1]+Q[2];return 5*Math.abs(ae-L)>=2*L?NaN:this.foundPatternCross(Q)?bd.centerFromEnd(Q,te):NaN}handlePossibleCenter(w,_,A){const L=w[0]+w[1]+w[2],z=bd.centerFromEnd(w,A),K=this.crossCheckVertical(_,z,2*w[1],L);if(!isNaN(K)){const Q=(w[0]+w[1]+w[2])/3;for(const ae of this.possibleCenters)if(ae.aboutEquals(Q,K,z))return ae.combineEstimate(K,z,Q);const te=new yd(z,K,Q);this.possibleCenters.push(te),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(te)}return null}}class wd extends be{constructor(w,_,A,L){super(w,_),this.estimatedModuleSize=A,this.count=L,L===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(w,_,A){if(Math.abs(_-this.getY())<=w&&Math.abs(A-this.getX())<=w){const L=Math.abs(w-this.estimatedModuleSize);return L<=1||L<=this.estimatedModuleSize}return!1}combineEstimate(w,_,A){const L=this.count+1,z=(this.count*this.getX()+_)/L,K=(this.count*this.getY()+w)/L,Q=(this.count*this.estimatedModuleSize+A)/L;return new wd(z,K,Q,L)}}class Af{constructor(w){this.bottomLeft=w[0],this.topLeft=w[1],this.topRight=w[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Fs{constructor(w,_){this.image=w,this.resultPointCallback=_,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=_}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(w){const _=w!=null&&w.get(O.TRY_HARDER)!==void 0,A=w!=null&&w.get(O.PURE_BARCODE)!==void 0,L=this.image,z=L.getHeight(),K=L.getWidth();let Q=Math.floor(3*z/(4*Fs.MAX_MODULES));(Q<Fs.MIN_SKIP||_)&&(Q=Fs.MIN_SKIP);let te=!1;const ae=new Int32Array(5);for(let ve=Q-1;ve<z&&!te;ve+=Q){ae[0]=0,ae[1]=0,ae[2]=0,ae[3]=0,ae[4]=0;let we=0;for(let Te=0;Te<K;Te++)if(L.get(Te,ve))(we&1)===1&&we++,ae[we]++;else if(we&1)ae[we]++;else if(we===4)if(Fs.foundPatternCross(ae)){if(this.handlePossibleCenter(ae,ve,Te,A)===!0)if(Q=2,this.hasSkipped===!0)te=this.haveMultiplyConfirmedCenters();else{const We=this.findRowSkip();We>ae[2]&&(ve+=We-ae[2]-Q,Te=K-1)}else{ae[0]=ae[2],ae[1]=ae[3],ae[2]=ae[4],ae[3]=1,ae[4]=0,we=3;continue}we=0,ae[0]=0,ae[1]=0,ae[2]=0,ae[3]=0,ae[4]=0}else ae[0]=ae[2],ae[1]=ae[3],ae[2]=ae[4],ae[3]=1,ae[4]=0,we=3;else ae[++we]++;Fs.foundPatternCross(ae)&&this.handlePossibleCenter(ae,ve,K,A)===!0&&(Q=ae[0],this.hasSkipped&&(te=this.haveMultiplyConfirmedCenters()))}const fe=this.selectBestPatterns();return be.orderBestPatterns(fe),new Af(fe)}static centerFromEnd(w,_){return _-w[4]-w[3]-w[2]/2}static foundPatternCross(w){let _=0;for(let z=0;z<5;z++){const K=w[z];if(K===0)return!1;_+=K}if(_<7)return!1;const A=_/7,L=A/2;return Math.abs(A-w[0])<L&&Math.abs(A-w[1])<L&&Math.abs(3*A-w[2])<3*L&&Math.abs(A-w[3])<L&&Math.abs(A-w[4])<L}getCrossCheckStateCount(){const w=this.crossCheckStateCount;return w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w}crossCheckDiagonal(w,_,A,L){const z=this.getCrossCheckStateCount();let K=0;const Q=this.image;for(;w>=K&&_>=K&&Q.get(_-K,w-K);)z[2]++,K++;if(w<K||_<K)return!1;for(;w>=K&&_>=K&&!Q.get(_-K,w-K)&&z[1]<=A;)z[1]++,K++;if(w<K||_<K||z[1]>A)return!1;for(;w>=K&&_>=K&&Q.get(_-K,w-K)&&z[0]<=A;)z[0]++,K++;if(z[0]>A)return!1;const te=Q.getHeight(),ae=Q.getWidth();for(K=1;w+K<te&&_+K<ae&&Q.get(_+K,w+K);)z[2]++,K++;if(w+K>=te||_+K>=ae)return!1;for(;w+K<te&&_+K<ae&&!Q.get(_+K,w+K)&&z[3]<A;)z[3]++,K++;if(w+K>=te||_+K>=ae||z[3]>=A)return!1;for(;w+K<te&&_+K<ae&&Q.get(_+K,w+K)&&z[4]<A;)z[4]++,K++;if(z[4]>=A)return!1;const fe=z[0]+z[1]+z[2]+z[3]+z[4];return Math.abs(fe-L)<2*L&&Fs.foundPatternCross(z)}crossCheckVertical(w,_,A,L){const z=this.image,K=z.getHeight(),Q=this.getCrossCheckStateCount();let te=w;for(;te>=0&&z.get(_,te);)Q[2]++,te--;if(te<0)return NaN;for(;te>=0&&!z.get(_,te)&&Q[1]<=A;)Q[1]++,te--;if(te<0||Q[1]>A)return NaN;for(;te>=0&&z.get(_,te)&&Q[0]<=A;)Q[0]++,te--;if(Q[0]>A)return NaN;for(te=w+1;te<K&&z.get(_,te);)Q[2]++,te++;if(te===K)return NaN;for(;te<K&&!z.get(_,te)&&Q[3]<A;)Q[3]++,te++;if(te===K||Q[3]>=A)return NaN;for(;te<K&&z.get(_,te)&&Q[4]<A;)Q[4]++,te++;if(Q[4]>=A)return NaN;const ae=Q[0]+Q[1]+Q[2]+Q[3]+Q[4];return 5*Math.abs(ae-L)>=2*L?NaN:Fs.foundPatternCross(Q)?Fs.centerFromEnd(Q,te):NaN}crossCheckHorizontal(w,_,A,L){const z=this.image,K=z.getWidth(),Q=this.getCrossCheckStateCount();let te=w;for(;te>=0&&z.get(te,_);)Q[2]++,te--;if(te<0)return NaN;for(;te>=0&&!z.get(te,_)&&Q[1]<=A;)Q[1]++,te--;if(te<0||Q[1]>A)return NaN;for(;te>=0&&z.get(te,_)&&Q[0]<=A;)Q[0]++,te--;if(Q[0]>A)return NaN;for(te=w+1;te<K&&z.get(te,_);)Q[2]++,te++;if(te===K)return NaN;for(;te<K&&!z.get(te,_)&&Q[3]<A;)Q[3]++,te++;if(te===K||Q[3]>=A)return NaN;for(;te<K&&z.get(te,_)&&Q[4]<A;)Q[4]++,te++;if(Q[4]>=A)return NaN;const ae=Q[0]+Q[1]+Q[2]+Q[3]+Q[4];return 5*Math.abs(ae-L)>=L?NaN:Fs.foundPatternCross(Q)?Fs.centerFromEnd(Q,te):NaN}handlePossibleCenter(w,_,A,L){const z=w[0]+w[1]+w[2]+w[3]+w[4];let K=Fs.centerFromEnd(w,A),Q=this.crossCheckVertical(_,Math.floor(K),w[2],z);if(!isNaN(Q)&&(K=this.crossCheckHorizontal(Math.floor(K),Math.floor(Q),w[2],z),!isNaN(K)&&(!L||this.crossCheckDiagonal(Math.floor(Q),Math.floor(K),w[2],z)))){const te=z/7;let ae=!1;const fe=this.possibleCenters;for(let ve=0,we=fe.length;ve<we;ve++){const Te=fe[ve];if(Te.aboutEquals(te,Q,K)){fe[ve]=Te.combineEstimate(Q,K,te),ae=!0;break}}if(!ae){const ve=new wd(K,Q,te);fe.push(ve),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(ve)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let _=null;for(const A of this.possibleCenters)if(A.getCount()>=Fs.CENTER_QUORUM)if(_==null)_=A;else return this.hasSkipped=!0,Math.floor((Math.abs(_.getX()-A.getX())-Math.abs(_.getY()-A.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let w=0,_=0;const A=this.possibleCenters.length;for(const K of this.possibleCenters)K.getCount()>=Fs.CENTER_QUORUM&&(w++,_+=K.getEstimatedModuleSize());if(w<3)return!1;const L=_/A;let z=0;for(const K of this.possibleCenters)z+=Math.abs(K.getEstimatedModuleSize()-L);return z<=.05*_}selectBestPatterns(){const w=this.possibleCenters.length;if(w<3)throw new S;const _=this.possibleCenters;let A;if(w>3){let L=0,z=0;for(const te of this.possibleCenters){const ae=te.getEstimatedModuleSize();L+=ae,z+=ae*ae}A=L/w;let K=Math.sqrt(z/w-A*A);_.sort((te,ae)=>{const fe=Math.abs(ae.getEstimatedModuleSize()-A),ve=Math.abs(te.getEstimatedModuleSize()-A);return fe<ve?-1:fe>ve?1:0});const Q=Math.max(.2*A,K);for(let te=0;te<_.length&&_.length>3;te++){const ae=_[te];Math.abs(ae.getEstimatedModuleSize()-A)>Q&&(_.splice(te,1),te--)}}if(_.length>3){let L=0;for(const z of _)L+=z.getEstimatedModuleSize();A=L/_.length,_.sort((z,K)=>{if(K.getCount()===z.getCount()){const Q=Math.abs(K.getEstimatedModuleSize()-A),te=Math.abs(z.getEstimatedModuleSize()-A);return Q<te?1:Q>te?-1:0}else return K.getCount()-z.getCount()}),_.splice(3)}return[_[0],_[1],_[2]]}}Fs.CENTER_QUORUM=2,Fs.MIN_SKIP=3,Fs.MAX_MODULES=57;class Dl{constructor(w){this.image=w}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(w){this.resultPointCallback=w==null?null:w.get(O.NEED_RESULT_POINT_CALLBACK);const A=new Fs(this.image,this.resultPointCallback).find(w);return this.processFinderPatternInfo(A)}processFinderPatternInfo(w){const _=w.getTopLeft(),A=w.getTopRight(),L=w.getBottomLeft(),z=this.calculateModuleSize(_,A,L);if(z<1)throw new S("No pattern found in proccess finder.");const K=Dl.computeDimension(_,A,L,z),Q=ur.getProvisionalVersionForDimension(K),te=Q.getDimensionForVersion()-7;let ae=null;if(Q.getAlignmentPatternCenters().length>0){const Te=A.getX()-_.getX()+L.getX(),Ve=A.getY()-_.getY()+L.getY(),We=1-3/te,at=Math.floor(_.getX()+We*(Te-_.getX())),pt=Math.floor(_.getY()+We*(Ve-_.getY()));for(let $t=4;$t<=16;$t<<=1)try{ae=this.findAlignmentInRegion(z,at,pt,$t);break}catch(zt){if(!(zt instanceof S))throw zt}}const fe=Dl.createTransform(_,A,L,ae,K),ve=Dl.sampleGrid(this.image,fe,K);let we;return ae===null?we=[L,_,A]:we=[L,_,A,ae],new ye(ve,we)}static createTransform(w,_,A,L,z){const K=z-3.5;let Q,te,ae,fe;return L!==null?(Q=L.getX(),te=L.getY(),ae=K-3,fe=ae):(Q=_.getX()-w.getX()+A.getX(),te=_.getY()-w.getY()+A.getY(),ae=K,fe=K),Ge.quadrilateralToQuadrilateral(3.5,3.5,K,3.5,ae,fe,3.5,K,w.getX(),w.getY(),_.getX(),_.getY(),Q,te,A.getX(),A.getY())}static sampleGrid(w,_,A){return Ie.getInstance().sampleGridWithTransform(w,A,A,_)}static computeDimension(w,_,A,L){const z=ge.round(be.distance(w,_)/L),K=ge.round(be.distance(w,A)/L);let Q=Math.floor((z+K)/2)+7;switch(Q&3){case 0:Q++;break;case 2:Q--;break;case 3:throw new S("Dimensions could be not found.")}return Q}calculateModuleSize(w,_,A){return(this.calculateModuleSizeOneWay(w,_)+this.calculateModuleSizeOneWay(w,A))/2}calculateModuleSizeOneWay(w,_){const A=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(w.getX()),Math.floor(w.getY()),Math.floor(_.getX()),Math.floor(_.getY())),L=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(_.getX()),Math.floor(_.getY()),Math.floor(w.getX()),Math.floor(w.getY()));return isNaN(A)?L/7:isNaN(L)?A/7:(A+L)/14}sizeOfBlackWhiteBlackRunBothWays(w,_,A,L){let z=this.sizeOfBlackWhiteBlackRun(w,_,A,L),K=1,Q=w-(A-w);Q<0?(K=w/(w-Q),Q=0):Q>=this.image.getWidth()&&(K=(this.image.getWidth()-1-w)/(Q-w),Q=this.image.getWidth()-1);let te=Math.floor(_-(L-_)*K);return K=1,te<0?(K=_/(_-te),te=0):te>=this.image.getHeight()&&(K=(this.image.getHeight()-1-_)/(te-_),te=this.image.getHeight()-1),Q=Math.floor(w+(Q-w)*K),z+=this.sizeOfBlackWhiteBlackRun(w,_,Q,te),z-1}sizeOfBlackWhiteBlackRun(w,_,A,L){const z=Math.abs(L-_)>Math.abs(A-w);if(z){let Te=w;w=_,_=Te,Te=A,A=L,L=Te}const K=Math.abs(A-w),Q=Math.abs(L-_);let te=-K/2;const ae=w<A?1:-1,fe=_<L?1:-1;let ve=0;const we=A+ae;for(let Te=w,Ve=_;Te!==we;Te+=ae){const We=z?Ve:Te,at=z?Te:Ve;if(ve===1===this.image.get(We,at)){if(ve===2)return ge.distance(Te,Ve,w,_);ve++}if(te+=Q,te>0){if(Ve===L)break;Ve+=fe,te-=K}}return ve===2?ge.distance(A+ae,L,w,_):NaN}findAlignmentInRegion(w,_,A,L){const z=Math.floor(L*w),K=Math.max(0,_-z),Q=Math.min(this.image.getWidth()-1,_+z);if(Q-K<w*3)throw new S("Alignment top exceeds estimated module size.");const te=Math.max(0,A-z),ae=Math.min(this.image.getHeight()-1,A+z);if(ae-te<w*3)throw new S("Alignment bottom exceeds estimated module size.");return new bd(this.image,K,te,Q-K,ae-te,w,this.resultPointCallback).find()}}class Yi{constructor(){this.decoder=new O1}getDecoder(){return this.decoder}decode(w,_){let A,L;if(_!=null&&_.get(O.PURE_BARCODE)!==void 0){const te=Yi.extractPureBits(w.getBlackMatrix());A=this.decoder.decodeBitMatrix(te,_),L=Yi.NO_POINTS}else{const te=new Dl(w.getBlackMatrix()).detect(_);A=this.decoder.decodeBitMatrix(te.getBits(),_),L=te.getPoints()}A.getOther()instanceof Zo&&A.getOther().applyMirroredCorrection(L);const z=new Z(A.getText(),A.getRawBytes(),void 0,L,W.QR_CODE,void 0),K=A.getByteSegments();K!==null&&z.putMetadata(V.BYTE_SEGMENTS,K);const Q=A.getECLevel();return Q!==null&&z.putMetadata(V.ERROR_CORRECTION_LEVEL,Q),A.hasStructuredAppend()&&(z.putMetadata(V.STRUCTURED_APPEND_SEQUENCE,A.getStructuredAppendSequenceNumber()),z.putMetadata(V.STRUCTURED_APPEND_PARITY,A.getStructuredAppendParity())),z}reset(){}static extractPureBits(w){const _=w.getTopLeftOnBit(),A=w.getBottomRightOnBit();if(_===null||A===null)throw new S;const L=this.moduleSize(_,w);let z=_[1],K=A[1],Q=_[0],te=A[0];if(Q>=te||z>=K)throw new S;if(K-z!==te-Q&&(te=Q+(K-z),te>=w.getWidth()))throw new S;const ae=Math.round((te-Q+1)/L),fe=Math.round((K-z+1)/L);if(ae<=0||fe<=0)throw new S;if(fe!==ae)throw new S;const ve=Math.floor(L/2);z+=ve,Q+=ve;const we=Q+Math.floor((ae-1)*L)-te;if(we>0){if(we>ve)throw new S;Q-=we}const Te=z+Math.floor((fe-1)*L)-K;if(Te>0){if(Te>ve)throw new S;z-=Te}const Ve=new F(ae,fe);for(let We=0;We<fe;We++){const at=z+Math.floor(We*L);for(let pt=0;pt<ae;pt++)w.get(Q+Math.floor(pt*L),at)&&Ve.set(pt,We)}return Ve}static moduleSize(w,_){const A=_.getHeight(),L=_.getWidth();let z=w[0],K=w[1],Q=!0,te=0;for(;z<L&&K<A;){if(Q!==_.get(z,K)){if(++te===5)break;Q=!Q}z++,K++}if(z===L||K===A)throw new S;return(z-w[0])/7}}Yi.NO_POINTS=new Array;class Mr{PDF417Common(){}static getBitCountSum(w){return ge.sum(w)}static toIntArray(w){if(w==null||!w.length)return Mr.EMPTY_INT_ARRAY;const _=new Int32Array(w.length);let A=0;for(const L of w)_[A++]=L;return _}static getCodeword(w){const _=y.binarySearch(Mr.SYMBOL_TABLE,w&262143);return _<0?-1:(Mr.CODEWORD_TABLE[_]-1)%Mr.NUMBER_OF_CODEWORDS}}Mr.NUMBER_OF_CODEWORDS=929,Mr.MAX_CODEWORDS_IN_BARCODE=Mr.NUMBER_OF_CODEWORDS-1,Mr.MIN_ROWS_IN_BARCODE=3,Mr.MAX_ROWS_IN_BARCODE=90,Mr.MODULES_IN_CODEWORD=17,Mr.MODULES_IN_STOP_PATTERN=18,Mr.BARS_IN_MODULE=8,Mr.EMPTY_INT_ARRAY=new Int32Array([]),Mr.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Mr.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class YJ{constructor(w,_){this.bits=w,this.points=_}getBits(){return this.bits}getPoints(){return this.points}}class Zr{static detectMultiple(w,_,A){let L=w.getBlackMatrix(),z=Zr.detect(A,L);return z.length||(L=L.clone(),L.rotate180(),z=Zr.detect(A,L)),new YJ(L,z)}static detect(w,_){const A=new Array;let L=0,z=0,K=!1;for(;L<_.getHeight();){const Q=Zr.findVertices(_,L,z);if(Q[0]==null&&Q[3]==null){if(!K)break;K=!1,z=0;for(const te of A)te[1]!=null&&(L=Math.trunc(Math.max(L,te[1].getY()))),te[3]!=null&&(L=Math.max(L,Math.trunc(te[3].getY())));L+=Zr.ROW_STEP;continue}if(K=!0,A.push(Q),!w)break;Q[2]!=null?(z=Math.trunc(Q[2].getX()),L=Math.trunc(Q[2].getY())):(z=Math.trunc(Q[4].getX()),L=Math.trunc(Q[4].getY()))}return A}static findVertices(w,_,A){const L=w.getHeight(),z=w.getWidth(),K=new Array(8);return Zr.copyToResult(K,Zr.findRowsWithPattern(w,L,z,_,A,Zr.START_PATTERN),Zr.INDEXES_START_PATTERN),K[4]!=null&&(A=Math.trunc(K[4].getX()),_=Math.trunc(K[4].getY())),Zr.copyToResult(K,Zr.findRowsWithPattern(w,L,z,_,A,Zr.STOP_PATTERN),Zr.INDEXES_STOP_PATTERN),K}static copyToResult(w,_,A){for(let L=0;L<A.length;L++)w[A[L]]=_[L]}static findRowsWithPattern(w,_,A,L,z,K){const Q=new Array(4);let te=!1;const ae=new Int32Array(K.length);for(;L<_;L+=Zr.ROW_STEP){let ve=Zr.findGuardPattern(w,z,L,A,!1,K,ae);if(ve!=null){for(;L>0;){const we=Zr.findGuardPattern(w,z,--L,A,!1,K,ae);if(we!=null)ve=we;else{L++;break}}Q[0]=new be(ve[0],L),Q[1]=new be(ve[1],L),te=!0;break}}let fe=L+1;if(te){let ve=0,we=Int32Array.from([Math.trunc(Q[0].getX()),Math.trunc(Q[1].getX())]);for(;fe<_;fe++){const Te=Zr.findGuardPattern(w,we[0],fe,A,!1,K,ae);if(Te!=null&&Math.abs(we[0]-Te[0])<Zr.MAX_PATTERN_DRIFT&&Math.abs(we[1]-Te[1])<Zr.MAX_PATTERN_DRIFT)we=Te,ve=0;else{if(ve>Zr.SKIPPED_ROW_COUNT_MAX)break;ve++}}fe-=ve+1,Q[2]=new be(we[0],fe),Q[3]=new be(we[1],fe)}return fe-L<Zr.BARCODE_MIN_HEIGHT&&y.fill(Q,null),Q}static findGuardPattern(w,_,A,L,z,K,Q){y.fillWithin(Q,0,Q.length,0);let te=_,ae=0;for(;w.get(te,A)&&te>0&&ae++<Zr.MAX_PIXEL_DRIFT;)te--;let fe=te,ve=0,we=K.length;for(let Te=z;fe<L;fe++)if(w.get(fe,A)!==Te)Q[ve]++;else{if(ve===we-1){if(Zr.patternMatchVariance(Q,K,Zr.MAX_INDIVIDUAL_VARIANCE)<Zr.MAX_AVG_VARIANCE)return new Int32Array([te,fe]);te+=Q[0]+Q[1],g.arraycopy(Q,2,Q,0,ve-1),Q[ve-1]=0,Q[ve]=0,ve--}else ve++;Q[ve]=1,Te=!Te}return ve===we-1&&Zr.patternMatchVariance(Q,K,Zr.MAX_INDIVIDUAL_VARIANCE)<Zr.MAX_AVG_VARIANCE?new Int32Array([te,fe-1]):null}static patternMatchVariance(w,_,A){let L=w.length,z=0,K=0;for(let ae=0;ae<L;ae++)z+=w[ae],K+=_[ae];if(z<K)return 1/0;let Q=z/K;A*=Q;let te=0;for(let ae=0;ae<L;ae++){let fe=w[ae],ve=_[ae]*Q,we=fe>ve?fe-ve:ve-fe;if(we>A)return 1/0;te+=we}return te/z}}Zr.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Zr.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Zr.MAX_AVG_VARIANCE=.42,Zr.MAX_INDIVIDUAL_VARIANCE=.8,Zr.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Zr.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Zr.MAX_PIXEL_DRIFT=3,Zr.MAX_PATTERN_DRIFT=5,Zr.SKIPPED_ROW_COUNT_MAX=25,Zr.ROW_STEP=5,Zr.BARCODE_MIN_HEIGHT=10;class Pa{constructor(w,_){if(_.length===0)throw new h;this.field=w;let A=_.length;if(A>1&&_[0]===0){let L=1;for(;L<A&&_[L]===0;)L++;L===A?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(A-L),g.arraycopy(_,L,this.coefficients,0,this.coefficients.length))}else this.coefficients=_}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(w){return this.coefficients[this.coefficients.length-1-w]}evaluateAt(w){if(w===0)return this.getCoefficient(0);if(w===1){let L=0;for(let z of this.coefficients)L=this.field.add(L,z);return L}let _=this.coefficients[0],A=this.coefficients.length;for(let L=1;L<A;L++)_=this.field.add(this.field.multiply(w,_),this.coefficients[L]);return _}add(w){if(!this.field.equals(w.field))throw new h("ModulusPolys do not have same ModulusGF field");if(this.isZero())return w;if(w.isZero())return this;let _=this.coefficients,A=w.coefficients;if(_.length>A.length){let K=_;_=A,A=K}let L=new Int32Array(A.length),z=A.length-_.length;g.arraycopy(A,0,L,0,z);for(let K=z;K<A.length;K++)L[K]=this.field.add(_[K-z],A[K]);return new Pa(this.field,L)}subtract(w){if(!this.field.equals(w.field))throw new h("ModulusPolys do not have same ModulusGF field");return w.isZero()?this:this.add(w.negative())}multiply(w){return w instanceof Pa?this.multiplyOther(w):this.multiplyScalar(w)}multiplyOther(w){if(!this.field.equals(w.field))throw new h("ModulusPolys do not have same ModulusGF field");if(this.isZero()||w.isZero())return new Pa(this.field,new Int32Array([0]));let _=this.coefficients,A=_.length,L=w.coefficients,z=L.length,K=new Int32Array(A+z-1);for(let Q=0;Q<A;Q++){let te=_[Q];for(let ae=0;ae<z;ae++)K[Q+ae]=this.field.add(K[Q+ae],this.field.multiply(te,L[ae]))}return new Pa(this.field,K)}negative(){let w=this.coefficients.length,_=new Int32Array(w);for(let A=0;A<w;A++)_[A]=this.field.subtract(0,this.coefficients[A]);return new Pa(this.field,_)}multiplyScalar(w){if(w===0)return new Pa(this.field,new Int32Array([0]));if(w===1)return this;let _=this.coefficients.length,A=new Int32Array(_);for(let L=0;L<_;L++)A[L]=this.field.multiply(this.coefficients[L],w);return new Pa(this.field,A)}multiplyByMonomial(w,_){if(w<0)throw new h;if(_===0)return new Pa(this.field,new Int32Array([0]));let A=this.coefficients.length,L=new Int32Array(A+w);for(let z=0;z<A;z++)L[z]=this.field.multiply(this.coefficients[z],_);return new Pa(this.field,L)}toString(){let w=new I;for(let _=this.getDegree();_>=0;_--){let A=this.getCoefficient(_);A!==0&&(A<0?(w.append(" - "),A=-A):w.length()>0&&w.append(" + "),(_===0||A!==1)&&w.append(A),_!==0&&(_===1?w.append("x"):(w.append("x^"),w.append(_))))}return w.toString()}}class ZJ{add(w,_){return(w+_)%this.modulus}subtract(w,_){return(this.modulus+w-_)%this.modulus}exp(w){return this.expTable[w]}log(w){if(w===0)throw new h;return this.logTable[w]}inverse(w){if(w===0)throw new oe;return this.expTable[this.modulus-this.logTable[w]-1]}multiply(w,_){return w===0||_===0?0:this.expTable[(this.logTable[w]+this.logTable[_])%(this.modulus-1)]}getSize(){return this.modulus}equals(w){return w===this}}class Gj extends ZJ{constructor(w,_){super(),this.modulus=w,this.expTable=new Int32Array(w),this.logTable=new Int32Array(w);let A=1;for(let L=0;L<w;L++)this.expTable[L]=A,A=A*_%w;for(let L=0;L<w-1;L++)this.logTable[this.expTable[L]]=L;this.zero=new Pa(this,new Int32Array([0])),this.one=new Pa(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(w,_){if(w<0)throw new h;if(_===0)return this.zero;let A=new Int32Array(w+1);return A[0]=_,new Pa(this,A)}}Gj.PDF417_GF=new Gj(Mr.NUMBER_OF_CODEWORDS,3);class aT{constructor(){this.field=Gj.PDF417_GF}decode(w,_,A){let L=new Pa(this.field,w),z=new Int32Array(_),K=!1;for(let Ve=_;Ve>0;Ve--){let We=L.evaluateAt(this.field.exp(Ve));z[_-Ve]=We,We!==0&&(K=!0)}if(!K)return 0;let Q=this.field.getOne();if(A!=null)for(const Ve of A){let We=this.field.exp(w.length-1-Ve),at=new Pa(this.field,new Int32Array([this.field.subtract(0,We),1]));Q=Q.multiply(at)}let te=new Pa(this.field,z),ae=this.runEuclideanAlgorithm(this.field.buildMonomial(_,1),te,_),fe=ae[0],ve=ae[1],we=this.findErrorLocations(fe),Te=this.findErrorMagnitudes(ve,fe,we);for(let Ve=0;Ve<we.length;Ve++){let We=w.length-1-this.field.log(we[Ve]);if(We<0)throw m.getChecksumInstance();w[We]=this.field.subtract(w[We],Te[Ve])}return we.length}runEuclideanAlgorithm(w,_,A){if(w.getDegree()<_.getDegree()){let we=w;w=_,_=we}let L=w,z=_,K=this.field.getZero(),Q=this.field.getOne();for(;z.getDegree()>=Math.round(A/2);){let we=L,Te=K;if(L=z,K=Q,L.isZero())throw m.getChecksumInstance();z=we;let Ve=this.field.getZero(),We=L.getCoefficient(L.getDegree()),at=this.field.inverse(We);for(;z.getDegree()>=L.getDegree()&&!z.isZero();){let pt=z.getDegree()-L.getDegree(),$t=this.field.multiply(z.getCoefficient(z.getDegree()),at);Ve=Ve.add(this.field.buildMonomial(pt,$t)),z=z.subtract(L.multiplyByMonomial(pt,$t))}Q=Ve.multiply(K).subtract(Te).negative()}let te=Q.getCoefficient(0);if(te===0)throw m.getChecksumInstance();let ae=this.field.inverse(te),fe=Q.multiply(ae),ve=z.multiply(ae);return[fe,ve]}findErrorLocations(w){let _=w.getDegree(),A=new Int32Array(_),L=0;for(let z=1;z<this.field.getSize()&&L<_;z++)w.evaluateAt(z)===0&&(A[L]=this.field.inverse(z),L++);if(L!==_)throw m.getChecksumInstance();return A}findErrorMagnitudes(w,_,A){let L=_.getDegree(),z=new Int32Array(L);for(let ae=1;ae<=L;ae++)z[L-ae]=this.field.multiply(ae,_.getCoefficient(ae));let K=new Pa(this.field,z),Q=A.length,te=new Int32Array(Q);for(let ae=0;ae<Q;ae++){let fe=this.field.inverse(A[ae]),ve=this.field.subtract(0,w.evaluateAt(fe)),we=this.field.inverse(K.evaluateAt(fe));te[ae]=this.field.multiply(ve,we)}return te}}class Ku{constructor(w,_,A,L,z){w instanceof Ku?this.constructor_2(w):this.constructor_1(w,_,A,L,z)}constructor_1(w,_,A,L,z){const K=_==null||A==null,Q=L==null||z==null;if(K&&Q)throw new S;K?(_=new be(0,L.getY()),A=new be(0,z.getY())):Q&&(L=new be(w.getWidth()-1,_.getY()),z=new be(w.getWidth()-1,A.getY())),this.image=w,this.topLeft=_,this.bottomLeft=A,this.topRight=L,this.bottomRight=z,this.minX=Math.trunc(Math.min(_.getX(),A.getX())),this.maxX=Math.trunc(Math.max(L.getX(),z.getX())),this.minY=Math.trunc(Math.min(_.getY(),L.getY())),this.maxY=Math.trunc(Math.max(A.getY(),z.getY()))}constructor_2(w){this.image=w.image,this.topLeft=w.getTopLeft(),this.bottomLeft=w.getBottomLeft(),this.topRight=w.getTopRight(),this.bottomRight=w.getBottomRight(),this.minX=w.getMinX(),this.maxX=w.getMaxX(),this.minY=w.getMinY(),this.maxY=w.getMaxY()}static merge(w,_){return w==null?_:_==null?w:new Ku(w.image,w.topLeft,w.bottomLeft,_.topRight,_.bottomRight)}addMissingRows(w,_,A){let L=this.topLeft,z=this.bottomLeft,K=this.topRight,Q=this.bottomRight;if(w>0){let te=A?this.topLeft:this.topRight,ae=Math.trunc(te.getY()-w);ae<0&&(ae=0);let fe=new be(te.getX(),ae);A?L=fe:K=fe}if(_>0){let te=A?this.bottomLeft:this.bottomRight,ae=Math.trunc(te.getY()+_);ae>=this.image.getHeight()&&(ae=this.image.getHeight()-1);let fe=new be(te.getX(),ae);A?z=fe:Q=fe}return new Ku(this.image,L,z,K,Q)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class QJ{constructor(w,_,A,L){this.columnCount=w,this.errorCorrectionLevel=L,this.rowCountUpperPart=_,this.rowCountLowerPart=A,this.rowCount=_+A}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Dg{constructor(){this.buffer=""}static form(w,_){let A=-1;function L(K,Q,te,ae,fe,ve){if(K==="%%")return"%";if(_[++A]===void 0)return;K=ae?parseInt(ae.substr(1)):void 0;let we=fe?parseInt(fe.substr(1)):void 0,Te;switch(ve){case"s":Te=_[A];break;case"c":Te=_[A][0];break;case"f":Te=parseFloat(_[A]).toFixed(K);break;case"p":Te=parseFloat(_[A]).toPrecision(K);break;case"e":Te=parseFloat(_[A]).toExponential(K);break;case"x":Te=parseInt(_[A]).toString(we||16);break;case"d":Te=parseFloat(parseInt(_[A],we||10).toPrecision(K)).toFixed(0);break}Te=typeof Te=="object"?JSON.stringify(Te):(+Te).toString(we);let Ve=parseInt(te),We=te&&te[0]+""=="0"?"0":" ";for(;Te.length<Ve;)Te=Q!==void 0?Te+We:We+Te;return Te}let z=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return w.replace(z,L)}format(w,..._){this.buffer+=Dg.form(w,_)}toString(){return this.buffer}}class Lg{constructor(w){this.boundingBox=new Ku(w),this.codewords=new Array(w.getMaxY()-w.getMinY()+1)}getCodewordNearby(w){let _=this.getCodeword(w);if(_!=null)return _;for(let A=1;A<Lg.MAX_NEARBY_DISTANCE;A++){let L=this.imageRowToCodewordIndex(w)-A;if(L>=0&&(_=this.codewords[L],_!=null)||(L=this.imageRowToCodewordIndex(w)+A,L<this.codewords.length&&(_=this.codewords[L],_!=null)))return _}return null}imageRowToCodewordIndex(w){return w-this.boundingBox.getMinY()}setCodeword(w,_){this.codewords[this.imageRowToCodewordIndex(w)]=_}getCodeword(w){return this.codewords[this.imageRowToCodewordIndex(w)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const w=new Dg;let _=0;for(const A of this.codewords){if(A==null){w.format("%3d:    |   %n",_++);continue}w.format("%3d: %3d|%3d%n",_++,A.getRowNumber(),A.getValue())}return w.toString()}}Lg.MAX_NEARBY_DISTANCE=5;class Bg{constructor(){this.values=new Map}setValue(w){w=Math.trunc(w);let _=this.values.get(w);_==null&&(_=0),_++,this.values.set(w,_)}getValue(){let w=-1,_=new Array;for(const[A,L]of this.values.entries()){const z={getKey:()=>A,getValue:()=>L};z.getValue()>w?(w=z.getValue(),_=[],_.push(z.getKey())):z.getValue()===w&&_.push(z.getKey())}return Mr.toIntArray(_)}getConfidence(w){return this.values.get(w)}}class iT extends Lg{constructor(w,_){super(w),this._isLeft=_}setRowNumbers(){for(let w of this.getCodewords())w!=null&&w.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(w){let _=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(_,w);let A=this.getBoundingBox(),L=this._isLeft?A.getTopLeft():A.getTopRight(),z=this._isLeft?A.getBottomLeft():A.getBottomRight(),K=this.imageRowToCodewordIndex(Math.trunc(L.getY())),Q=this.imageRowToCodewordIndex(Math.trunc(z.getY())),te=-1,ae=1,fe=0;for(let ve=K;ve<Q;ve++){if(_[ve]==null)continue;let we=_[ve],Te=we.getRowNumber()-te;if(Te===0)fe++;else if(Te===1)ae=Math.max(ae,fe),fe=1,te=we.getRowNumber();else if(Te<0||we.getRowNumber()>=w.getRowCount()||Te>ve)_[ve]=null;else{let Ve;ae>2?Ve=(ae-2)*Te:Ve=Te;let We=Ve>=ve;for(let at=1;at<=Ve&&!We;at++)We=_[ve-at]!=null;We?_[ve]=null:(te=we.getRowNumber(),fe=1)}}}getRowHeights(){let w=this.getBarcodeMetadata();if(w==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(w);let _=new Int32Array(w.getRowCount());for(let A of this.getCodewords())if(A!=null){let L=A.getRowNumber();if(L>=_.length)continue;_[L]++}return _}adjustIncompleteIndicatorColumnRowNumbers(w){let _=this.getBoundingBox(),A=this._isLeft?_.getTopLeft():_.getTopRight(),L=this._isLeft?_.getBottomLeft():_.getBottomRight(),z=this.imageRowToCodewordIndex(Math.trunc(A.getY())),K=this.imageRowToCodewordIndex(Math.trunc(L.getY())),Q=this.getCodewords(),te=-1;for(let ae=z;ae<K;ae++){if(Q[ae]==null)continue;let fe=Q[ae];fe.setRowNumberAsRowIndicatorColumn();let ve=fe.getRowNumber()-te;ve===0||(ve===1?te=fe.getRowNumber():fe.getRowNumber()>=w.getRowCount()?Q[ae]=null:te=fe.getRowNumber())}}getBarcodeMetadata(){let w=this.getCodewords(),_=new Bg,A=new Bg,L=new Bg,z=new Bg;for(let Q of w){if(Q==null)continue;Q.setRowNumberAsRowIndicatorColumn();let te=Q.getValue()%30,ae=Q.getRowNumber();switch(this._isLeft||(ae+=2),ae%3){case 0:A.setValue(te*3+1);break;case 1:z.setValue(te/3),L.setValue(te%3);break;case 2:_.setValue(te+1);break}}if(_.getValue().length===0||A.getValue().length===0||L.getValue().length===0||z.getValue().length===0||_.getValue()[0]<1||A.getValue()[0]+L.getValue()[0]<Mr.MIN_ROWS_IN_BARCODE||A.getValue()[0]+L.getValue()[0]>Mr.MAX_ROWS_IN_BARCODE)return null;let K=new QJ(_.getValue()[0],A.getValue()[0],L.getValue()[0],z.getValue()[0]);return this.removeIncorrectCodewords(w,K),K}removeIncorrectCodewords(w,_){for(let A=0;A<w.length;A++){let L=w[A];if(w[A]==null)continue;let z=L.getValue()%30,K=L.getRowNumber();if(K>_.getRowCount()){w[A]=null;continue}switch(this._isLeft||(K+=2),K%3){case 0:z*3+1!==_.getRowCountUpperPart()&&(w[A]=null);break;case 1:(Math.trunc(z/3)!==_.getErrorCorrectionLevel()||z%3!==_.getRowCountLowerPart())&&(w[A]=null);break;case 2:z+1!==_.getColumnCount()&&(w[A]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class $g{constructor(w,_){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=w,this.barcodeColumnCount=w.getColumnCount(),this.boundingBox=_,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let w=Mr.MAX_CODEWORDS_IN_BARCODE,_;do _=w,w=this.adjustRowNumbersAndGetCount();while(w>0&&w<_);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(w){w!=null&&w.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let w=this.adjustRowNumbersByRow();if(w===0)return 0;for(let _=1;_<this.barcodeColumnCount+1;_++){let A=this.detectionResultColumns[_].getCodewords();for(let L=0;L<A.length;L++)A[L]!=null&&(A[L].hasValidRowNumber()||this.adjustRowNumbers(_,L,A))}return w}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let w=this.detectionResultColumns[0].getCodewords(),_=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let A=0;A<w.length;A++)if(w[A]!=null&&_[A]!=null&&w[A].getRowNumber()===_[A].getRowNumber())for(let L=1;L<=this.barcodeColumnCount;L++){let z=this.detectionResultColumns[L].getCodewords()[A];z!=null&&(z.setRowNumber(w[A].getRowNumber()),z.hasValidRowNumber()||(this.detectionResultColumns[L].getCodewords()[A]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let w=0,_=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let A=0;A<_.length;A++){if(_[A]==null)continue;let L=_[A].getRowNumber(),z=0;for(let K=this.barcodeColumnCount+1;K>0&&z<this.ADJUST_ROW_NUMBER_SKIP;K--){let Q=this.detectionResultColumns[K].getCodewords()[A];Q!=null&&(z=$g.adjustRowNumberIfValid(L,z,Q),Q.hasValidRowNumber()||w++)}}return w}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let w=0,_=this.detectionResultColumns[0].getCodewords();for(let A=0;A<_.length;A++){if(_[A]==null)continue;let L=_[A].getRowNumber(),z=0;for(let K=1;K<this.barcodeColumnCount+1&&z<this.ADJUST_ROW_NUMBER_SKIP;K++){let Q=this.detectionResultColumns[K].getCodewords()[A];Q!=null&&(z=$g.adjustRowNumberIfValid(L,z,Q),Q.hasValidRowNumber()||w++)}}return w}static adjustRowNumberIfValid(w,_,A){return A==null||A.hasValidRowNumber()||(A.isValidRowNumber(w)?(A.setRowNumber(w),_=0):++_),_}adjustRowNumbers(w,_,A){if(!this.detectionResultColumns[w-1])return;let L=A[_],z=this.detectionResultColumns[w-1].getCodewords(),K=z;this.detectionResultColumns[w+1]!=null&&(K=this.detectionResultColumns[w+1].getCodewords());let Q=new Array(14);Q[2]=z[_],Q[3]=K[_],_>0&&(Q[0]=A[_-1],Q[4]=z[_-1],Q[5]=K[_-1]),_>1&&(Q[8]=A[_-2],Q[10]=z[_-2],Q[11]=K[_-2]),_<A.length-1&&(Q[1]=A[_+1],Q[6]=z[_+1],Q[7]=K[_+1]),_<A.length-2&&(Q[9]=A[_+2],Q[12]=z[_+2],Q[13]=K[_+2]);for(let te of Q)if($g.adjustRowNumber(L,te))return}static adjustRowNumber(w,_){return _==null?!1:_.hasValidRowNumber()&&_.getBucket()===w.getBucket()?(w.setRowNumber(_.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(w){this.boundingBox=w}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(w,_){this.detectionResultColumns[w]=_}getDetectionResultColumn(w){return this.detectionResultColumns[w]}toString(){let w=this.detectionResultColumns[0];w==null&&(w=this.detectionResultColumns[this.barcodeColumnCount+1]);let _=new Dg;for(let A=0;A<w.getCodewords().length;A++){_.format("CW %3d:",A);for(let L=0;L<this.barcodeColumnCount+2;L++){if(this.detectionResultColumns[L]==null){_.format("    |   ");continue}let z=this.detectionResultColumns[L].getCodewords()[A];if(z==null){_.format("    |   ");continue}_.format(" %3d|%3d",z.getRowNumber(),z.getValue())}_.format("%n")}return _.toString()}}class Fg{constructor(w,_,A,L){this.rowNumber=Fg.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(w),this.endX=Math.trunc(_),this.bucket=Math.trunc(A),this.value=Math.trunc(L)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(w){return w!==Fg.BARCODE_ROW_UNKNOWN&&this.bucket===w%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(w){this.rowNumber=w}toString(){return this.rowNumber+"|"+this.value}}Fg.BARCODE_ROW_UNKNOWN=-1;class Ei{static initialize(){for(let w=0;w<Mr.SYMBOL_TABLE.length;w++){let _=Mr.SYMBOL_TABLE[w],A=_&1;for(let L=0;L<Mr.BARS_IN_MODULE;L++){let z=0;for(;(_&1)===A;)z+=1,_>>=1;A=_&1,Ei.RATIOS_TABLE[w]||(Ei.RATIOS_TABLE[w]=new Array(Mr.BARS_IN_MODULE)),Ei.RATIOS_TABLE[w][Mr.BARS_IN_MODULE-L-1]=Math.fround(z/Mr.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(w){let _=Ei.getDecodedCodewordValue(Ei.sampleBitCounts(w));return _!==-1?_:Ei.getClosestDecodedValue(w)}static sampleBitCounts(w){let _=ge.sum(w),A=new Int32Array(Mr.BARS_IN_MODULE),L=0,z=0;for(let K=0;K<Mr.MODULES_IN_CODEWORD;K++){let Q=_/(2*Mr.MODULES_IN_CODEWORD)+K*_/Mr.MODULES_IN_CODEWORD;z+w[L]<=Q&&(z+=w[L],L++),A[L]++}return A}static getDecodedCodewordValue(w){let _=Ei.getBitValue(w);return Mr.getCodeword(_)===-1?-1:_}static getBitValue(w){let _=0;for(let A=0;A<w.length;A++)for(let L=0;L<w[A];L++)_=_<<1|(A%2===0?1:0);return Math.trunc(_)}static getClosestDecodedValue(w){let _=ge.sum(w),A=new Array(Mr.BARS_IN_MODULE);if(_>1)for(let K=0;K<A.length;K++)A[K]=Math.fround(w[K]/_);let L=_e.MAX_VALUE,z=-1;this.bSymbolTableReady||Ei.initialize();for(let K=0;K<Ei.RATIOS_TABLE.length;K++){let Q=0,te=Ei.RATIOS_TABLE[K];for(let ae=0;ae<Mr.BARS_IN_MODULE;ae++){let fe=Math.fround(te[ae]-A[ae]);if(Q+=Math.fround(fe*fe),Q>=L)break}Q<L&&(L=Q,z=Mr.SYMBOL_TABLE[K])}return z}}Ei.bSymbolTableReady=!1,Ei.RATIOS_TABLE=new Array(Mr.SYMBOL_TABLE.length).map(xe=>new Array(Mr.BARS_IN_MODULE));class oT{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(w){this.segmentIndex=w}getFileId(){return this.fileId}setFileId(w){this.fileId=w}getOptionalData(){return this.optionalData}setOptionalData(w){this.optionalData=w}isLastSegment(){return this.lastSegment}setLastSegment(w){this.lastSegment=w}getSegmentCount(){return this.segmentCount}setSegmentCount(w){this.segmentCount=w}getSender(){return this.sender||null}setSender(w){this.sender=w}getAddressee(){return this.addressee||null}setAddressee(w){this.addressee=w}getFileName(){return this.fileName}setFileName(w){this.fileName=w}getFileSize(){return this.fileSize}setFileSize(w){this.fileSize=w}getChecksum(){return this.checksum}setChecksum(w){this.checksum=w}getTimestamp(){return this.timestamp}setTimestamp(w){this.timestamp=w}}class lT{static parseLong(w,_=void 0){return parseInt(w,_)}}class cT extends c{}cT.kind="NullPointerException";class JJ{writeBytes(w){this.writeBytesOffset(w,0,w.length)}writeBytesOffset(w,_,A){if(w==null)throw new cT;if(_<0||_>w.length||A<0||_+A>w.length||_+A<0)throw new x;if(A===0)return;for(let L=0;L<A;L++)this.write(w[_+L])}flush(){}close(){}}class eee extends c{}class tee extends JJ{constructor(w=32){if(super(),this.count=0,w<0)throw new h("Negative initial size: "+w);this.buf=new Uint8Array(w)}ensureCapacity(w){w-this.buf.length>0&&this.grow(w)}grow(w){let A=this.buf.length<<1;if(A-w<0&&(A=w),A<0){if(w<0)throw new eee;A=b.MAX_VALUE}this.buf=y.copyOfUint8Array(this.buf,A)}write(w){this.ensureCapacity(this.count+1),this.buf[this.count]=w,this.count+=1}writeBytesOffset(w,_,A){if(_<0||_>w.length||A<0||_+A-w.length>0)throw new x;this.ensureCapacity(this.count+A),g.arraycopy(w,_,this.buf,this.count,A),this.count+=A}writeTo(w){w.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return y.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(w){return w?typeof w=="string"?this.toString_string(w):this.toString_number(w):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(w){return new String(this.buf).toString()}toString_number(w){return new String(this.buf).toString()}close(){}}var zn;(function(xe){xe[xe.ALPHA=0]="ALPHA",xe[xe.LOWER=1]="LOWER",xe[xe.MIXED=2]="MIXED",xe[xe.PUNCT=3]="PUNCT",xe[xe.ALPHA_SHIFT=4]="ALPHA_SHIFT",xe[xe.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(zn||(zn={}));function dT(){if(typeof window<"u")return window.BigInt||null;if(typeof Fr<"u")return Fr.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let R1;function _d(xe){if(typeof R1>"u"&&(R1=dT()),R1===null)throw new Error("BigInt is not supported!");return R1(xe)}function ree(){let xe=[];xe[0]=_d(1);let w=_d(900);xe[1]=w;for(let _=2;_<16;_++)xe[_]=xe[_-1]*w;return xe}class mt{static decode(w,_){let A=new I(""),L=B.ISO8859_1;A.enableDecoding(L);let z=1,K=w[z++],Q=new oT;for(;z<w[0];){switch(K){case mt.TEXT_COMPACTION_MODE_LATCH:z=mt.textCompaction(w,z,A);break;case mt.BYTE_COMPACTION_MODE_LATCH:case mt.BYTE_COMPACTION_MODE_LATCH_6:z=mt.byteCompaction(K,w,L,z,A);break;case mt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:A.append(w[z++]);break;case mt.NUMERIC_COMPACTION_MODE_LATCH:z=mt.numericCompaction(w,z,A);break;case mt.ECI_CHARSET:B.getCharacterSetECIByValue(w[z++]);break;case mt.ECI_GENERAL_PURPOSE:z+=2;break;case mt.ECI_USER_DEFINED:z++;break;case mt.BEGIN_MACRO_PDF417_CONTROL_BLOCK:z=mt.decodeMacroBlock(w,z,Q);break;case mt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case mt.MACRO_PDF417_TERMINATOR:throw new R;default:z--,z=mt.textCompaction(w,z,A);break}if(z<w.length)K=w[z++];else throw R.getFormatInstance()}if(A.length()===0)throw R.getFormatInstance();let te=new H(null,A.toString(),null,_);return te.setOther(Q),te}static decodeMacroBlock(w,_,A){if(_+mt.NUMBER_OF_SEQUENCE_CODEWORDS>w[0])throw R.getFormatInstance();let L=new Int32Array(mt.NUMBER_OF_SEQUENCE_CODEWORDS);for(let Q=0;Q<mt.NUMBER_OF_SEQUENCE_CODEWORDS;Q++,_++)L[Q]=w[_];A.setSegmentIndex(b.parseInt(mt.decodeBase900toBase10(L,mt.NUMBER_OF_SEQUENCE_CODEWORDS)));let z=new I;_=mt.textCompaction(w,_,z),A.setFileId(z.toString());let K=-1;for(w[_]===mt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(K=_+1);_<w[0];)switch(w[_]){case mt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(_++,w[_]){case mt.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let Q=new I;_=mt.textCompaction(w,_+1,Q),A.setFileName(Q.toString());break;case mt.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let te=new I;_=mt.textCompaction(w,_+1,te),A.setSender(te.toString());break;case mt.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let ae=new I;_=mt.textCompaction(w,_+1,ae),A.setAddressee(ae.toString());break;case mt.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let fe=new I;_=mt.numericCompaction(w,_+1,fe),A.setSegmentCount(b.parseInt(fe.toString()));break;case mt.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let ve=new I;_=mt.numericCompaction(w,_+1,ve),A.setTimestamp(lT.parseLong(ve.toString()));break;case mt.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let we=new I;_=mt.numericCompaction(w,_+1,we),A.setChecksum(b.parseInt(we.toString()));break;case mt.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let Te=new I;_=mt.numericCompaction(w,_+1,Te),A.setFileSize(lT.parseLong(Te.toString()));break;default:throw R.getFormatInstance()}break;case mt.MACRO_PDF417_TERMINATOR:_++,A.setLastSegment(!0);break;default:throw R.getFormatInstance()}if(K!==-1){let Q=_-K;A.isLastSegment()&&Q--,A.setOptionalData(y.copyOfRange(w,K,K+Q))}return _}static textCompaction(w,_,A){let L=new Int32Array((w[0]-_)*2),z=new Int32Array((w[0]-_)*2),K=0,Q=!1;for(;_<w[0]&&!Q;){let te=w[_++];if(te<mt.TEXT_COMPACTION_MODE_LATCH)L[K]=te/30,L[K+1]=te%30,K+=2;else switch(te){case mt.TEXT_COMPACTION_MODE_LATCH:L[K++]=mt.TEXT_COMPACTION_MODE_LATCH;break;case mt.BYTE_COMPACTION_MODE_LATCH:case mt.BYTE_COMPACTION_MODE_LATCH_6:case mt.NUMERIC_COMPACTION_MODE_LATCH:case mt.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case mt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case mt.MACRO_PDF417_TERMINATOR:_--,Q=!0;break;case mt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:L[K]=mt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,te=w[_++],z[K]=te,K++;break}}return mt.decodeTextCompaction(L,z,K,A),_}static decodeTextCompaction(w,_,A,L){let z=zn.ALPHA,K=zn.ALPHA,Q=0;for(;Q<A;){let te=w[Q],ae="";switch(z){case zn.ALPHA:if(te<26)ae=String.fromCharCode(65+te);else switch(te){case 26:ae=" ";break;case mt.LL:z=zn.LOWER;break;case mt.ML:z=zn.MIXED;break;case mt.PS:K=z,z=zn.PUNCT_SHIFT;break;case mt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:L.append(_[Q]);break;case mt.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break;case zn.LOWER:if(te<26)ae=String.fromCharCode(97+te);else switch(te){case 26:ae=" ";break;case mt.AS:K=z,z=zn.ALPHA_SHIFT;break;case mt.ML:z=zn.MIXED;break;case mt.PS:K=z,z=zn.PUNCT_SHIFT;break;case mt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:L.append(_[Q]);break;case mt.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break;case zn.MIXED:if(te<mt.PL)ae=mt.MIXED_CHARS[te];else switch(te){case mt.PL:z=zn.PUNCT;break;case 26:ae=" ";break;case mt.LL:z=zn.LOWER;break;case mt.AL:z=zn.ALPHA;break;case mt.PS:K=z,z=zn.PUNCT_SHIFT;break;case mt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:L.append(_[Q]);break;case mt.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break;case zn.PUNCT:if(te<mt.PAL)ae=mt.PUNCT_CHARS[te];else switch(te){case mt.PAL:z=zn.ALPHA;break;case mt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:L.append(_[Q]);break;case mt.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break;case zn.ALPHA_SHIFT:if(z=K,te<26)ae=String.fromCharCode(65+te);else switch(te){case 26:ae=" ";break;case mt.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break;case zn.PUNCT_SHIFT:if(z=K,te<mt.PAL)ae=mt.PUNCT_CHARS[te];else switch(te){case mt.PAL:z=zn.ALPHA;break;case mt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:L.append(_[Q]);break;case mt.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break}ae!==""&&L.append(ae),Q++}}static byteCompaction(w,_,A,L,z){let K=new tee,Q=0,te=0,ae=!1;switch(w){case mt.BYTE_COMPACTION_MODE_LATCH:let fe=new Int32Array(6),ve=_[L++];for(;L<_[0]&&!ae;)switch(fe[Q++]=ve,te=900*te+ve,ve=_[L++],ve){case mt.TEXT_COMPACTION_MODE_LATCH:case mt.BYTE_COMPACTION_MODE_LATCH:case mt.NUMERIC_COMPACTION_MODE_LATCH:case mt.BYTE_COMPACTION_MODE_LATCH_6:case mt.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case mt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case mt.MACRO_PDF417_TERMINATOR:L--,ae=!0;break;default:if(Q%5===0&&Q>0){for(let we=0;we<6;++we)K.write(Number(_d(te)>>_d(8*(5-we))));te=0,Q=0}break}L===_[0]&&ve<mt.TEXT_COMPACTION_MODE_LATCH&&(fe[Q++]=ve);for(let we=0;we<Q;we++)K.write(fe[we]);break;case mt.BYTE_COMPACTION_MODE_LATCH_6:for(;L<_[0]&&!ae;){let we=_[L++];if(we<mt.TEXT_COMPACTION_MODE_LATCH)Q++,te=900*te+we;else switch(we){case mt.TEXT_COMPACTION_MODE_LATCH:case mt.BYTE_COMPACTION_MODE_LATCH:case mt.NUMERIC_COMPACTION_MODE_LATCH:case mt.BYTE_COMPACTION_MODE_LATCH_6:case mt.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case mt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case mt.MACRO_PDF417_TERMINATOR:L--,ae=!0;break}if(Q%5===0&&Q>0){for(let Te=0;Te<6;++Te)K.write(Number(_d(te)>>_d(8*(5-Te))));te=0,Q=0}}break}return z.append(Y.decode(K.toByteArray(),A)),L}static numericCompaction(w,_,A){let L=0,z=!1,K=new Int32Array(mt.MAX_NUMERIC_CODEWORDS);for(;_<w[0]&&!z;){let Q=w[_++];if(_===w[0]&&(z=!0),Q<mt.TEXT_COMPACTION_MODE_LATCH)K[L]=Q,L++;else switch(Q){case mt.TEXT_COMPACTION_MODE_LATCH:case mt.BYTE_COMPACTION_MODE_LATCH:case mt.BYTE_COMPACTION_MODE_LATCH_6:case mt.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case mt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case mt.MACRO_PDF417_TERMINATOR:_--,z=!0;break}(L%mt.MAX_NUMERIC_CODEWORDS===0||Q===mt.NUMERIC_COMPACTION_MODE_LATCH||z)&&L>0&&(A.append(mt.decodeBase900toBase10(K,L)),L=0)}return _}static decodeBase900toBase10(w,_){let A=_d(0);for(let z=0;z<_;z++)A+=mt.EXP900[_-z-1]*_d(w[z]);let L=A.toString();if(L.charAt(0)!=="1")throw new R;return L.substring(1)}}mt.TEXT_COMPACTION_MODE_LATCH=900,mt.BYTE_COMPACTION_MODE_LATCH=901,mt.NUMERIC_COMPACTION_MODE_LATCH=902,mt.BYTE_COMPACTION_MODE_LATCH_6=924,mt.ECI_USER_DEFINED=925,mt.ECI_GENERAL_PURPOSE=926,mt.ECI_CHARSET=927,mt.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,mt.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,mt.MACRO_PDF417_TERMINATOR=922,mt.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,mt.MAX_NUMERIC_CODEWORDS=15,mt.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,mt.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,mt.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,mt.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,mt.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,mt.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,mt.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,mt.PL=25,mt.LL=27,mt.AS=27,mt.ML=28,mt.AL=28,mt.PS=29,mt.PAL=29,mt.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,mt.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",mt.EXP900=dT()?ree():[],mt.NUMBER_OF_SEQUENCE_CODEWORDS=2;class en{constructor(){}static decode(w,_,A,L,z,K,Q){let te=new Ku(w,_,A,L,z),ae=null,fe=null,ve;for(let Ve=!0;;Ve=!1){if(_!=null&&(ae=en.getRowIndicatorColumn(w,te,_,!0,K,Q)),L!=null&&(fe=en.getRowIndicatorColumn(w,te,L,!1,K,Q)),ve=en.merge(ae,fe),ve==null)throw S.getNotFoundInstance();let We=ve.getBoundingBox();if(Ve&&We!=null&&(We.getMinY()<te.getMinY()||We.getMaxY()>te.getMaxY()))te=We;else break}ve.setBoundingBox(te);let we=ve.getBarcodeColumnCount()+1;ve.setDetectionResultColumn(0,ae),ve.setDetectionResultColumn(we,fe);let Te=ae!=null;for(let Ve=1;Ve<=we;Ve++){let We=Te?Ve:we-Ve;if(ve.getDetectionResultColumn(We)!==void 0)continue;let at;We===0||We===we?at=new iT(te,We===0):at=new Lg(te),ve.setDetectionResultColumn(We,at);let pt=-1,$t=pt;for(let zt=te.getMinY();zt<=te.getMaxY();zt++){if(pt=en.getStartColumn(ve,We,zt,Te),pt<0||pt>te.getMaxX()){if($t===-1)continue;pt=$t}let Mt=en.detectCodeword(w,te.getMinX(),te.getMaxX(),Te,pt,zt,K,Q);Mt!=null&&(at.setCodeword(zt,Mt),$t=pt,K=Math.min(K,Mt.getWidth()),Q=Math.max(Q,Mt.getWidth()))}}return en.createDecoderResult(ve)}static merge(w,_){if(w==null&&_==null)return null;let A=en.getBarcodeMetadata(w,_);if(A==null)return null;let L=Ku.merge(en.adjustBoundingBox(w),en.adjustBoundingBox(_));return new $g(A,L)}static adjustBoundingBox(w){if(w==null)return null;let _=w.getRowHeights();if(_==null)return null;let A=en.getMax(_),L=0;for(let Q of _)if(L+=A-Q,Q>0)break;let z=w.getCodewords();for(let Q=0;L>0&&z[Q]==null;Q++)L--;let K=0;for(let Q=_.length-1;Q>=0&&(K+=A-_[Q],!(_[Q]>0));Q--);for(let Q=z.length-1;K>0&&z[Q]==null;Q--)K--;return w.getBoundingBox().addMissingRows(L,K,w.isLeft())}static getMax(w){let _=-1;for(let A of w)_=Math.max(_,A);return _}static getBarcodeMetadata(w,_){let A;if(w==null||(A=w.getBarcodeMetadata())==null)return _==null?null:_.getBarcodeMetadata();let L;return _==null||(L=_.getBarcodeMetadata())==null?A:A.getColumnCount()!==L.getColumnCount()&&A.getErrorCorrectionLevel()!==L.getErrorCorrectionLevel()&&A.getRowCount()!==L.getRowCount()?null:A}static getRowIndicatorColumn(w,_,A,L,z,K){let Q=new iT(_,L);for(let te=0;te<2;te++){let ae=te===0?1:-1,fe=Math.trunc(Math.trunc(A.getX()));for(let ve=Math.trunc(Math.trunc(A.getY()));ve<=_.getMaxY()&&ve>=_.getMinY();ve+=ae){let we=en.detectCodeword(w,0,w.getWidth(),L,fe,ve,z,K);we!=null&&(Q.setCodeword(ve,we),L?fe=we.getStartX():fe=we.getEndX())}}return Q}static adjustCodewordCount(w,_){let A=_[0][1],L=A.getValue(),z=w.getBarcodeColumnCount()*w.getBarcodeRowCount()-en.getNumberOfECCodeWords(w.getBarcodeECLevel());if(L.length===0){if(z<1||z>Mr.MAX_CODEWORDS_IN_BARCODE)throw S.getNotFoundInstance();A.setValue(z)}else L[0]!==z&&A.setValue(z)}static createDecoderResult(w){let _=en.createBarcodeMatrix(w);en.adjustCodewordCount(w,_);let A=new Array,L=new Int32Array(w.getBarcodeRowCount()*w.getBarcodeColumnCount()),z=[],K=new Array;for(let te=0;te<w.getBarcodeRowCount();te++)for(let ae=0;ae<w.getBarcodeColumnCount();ae++){let fe=_[te][ae+1].getValue(),ve=te*w.getBarcodeColumnCount()+ae;fe.length===0?A.push(ve):fe.length===1?L[ve]=fe[0]:(K.push(ve),z.push(fe))}let Q=new Array(z.length);for(let te=0;te<Q.length;te++)Q[te]=z[te];return en.createDecoderResultFromAmbiguousValues(w.getBarcodeECLevel(),L,Mr.toIntArray(A),Mr.toIntArray(K),Q)}static createDecoderResultFromAmbiguousValues(w,_,A,L,z){let K=new Int32Array(L.length),Q=100;for(;Q-- >0;){for(let te=0;te<K.length;te++)_[L[te]]=z[te][K[te]];try{return en.decodeCodewords(_,w,A)}catch(te){if(!(te instanceof m))throw te}if(K.length===0)throw m.getChecksumInstance();for(let te=0;te<K.length;te++)if(K[te]<z[te].length-1){K[te]++;break}else if(K[te]=0,te===K.length-1)throw m.getChecksumInstance()}throw m.getChecksumInstance()}static createBarcodeMatrix(w){let _=Array.from({length:w.getBarcodeRowCount()},()=>new Array(w.getBarcodeColumnCount()+2));for(let L=0;L<_.length;L++)for(let z=0;z<_[L].length;z++)_[L][z]=new Bg;let A=0;for(let L of w.getDetectionResultColumns()){if(L!=null){for(let z of L.getCodewords())if(z!=null){let K=z.getRowNumber();if(K>=0){if(K>=_.length)continue;_[K][A].setValue(z.getValue())}}}A++}return _}static isValidBarcodeColumn(w,_){return _>=0&&_<=w.getBarcodeColumnCount()+1}static getStartColumn(w,_,A,L){let z=L?1:-1,K=null;if(en.isValidBarcodeColumn(w,_-z)&&(K=w.getDetectionResultColumn(_-z).getCodeword(A)),K!=null)return L?K.getEndX():K.getStartX();if(K=w.getDetectionResultColumn(_).getCodewordNearby(A),K!=null)return L?K.getStartX():K.getEndX();if(en.isValidBarcodeColumn(w,_-z)&&(K=w.getDetectionResultColumn(_-z).getCodewordNearby(A)),K!=null)return L?K.getEndX():K.getStartX();let Q=0;for(;en.isValidBarcodeColumn(w,_-z);){_-=z;for(let te of w.getDetectionResultColumn(_).getCodewords())if(te!=null)return(L?te.getEndX():te.getStartX())+z*Q*(te.getEndX()-te.getStartX());Q++}return L?w.getBoundingBox().getMinX():w.getBoundingBox().getMaxX()}static detectCodeword(w,_,A,L,z,K,Q,te){z=en.adjustCodewordStartColumn(w,_,A,L,z,K);let ae=en.getModuleBitCount(w,_,A,L,z,K);if(ae==null)return null;let fe,ve=ge.sum(ae);if(L)fe=z+ve;else{for(let Ve=0;Ve<ae.length/2;Ve++){let We=ae[Ve];ae[Ve]=ae[ae.length-1-Ve],ae[ae.length-1-Ve]=We}fe=z,z=fe-ve}if(!en.checkCodewordSkew(ve,Q,te))return null;let we=Ei.getDecodedValue(ae),Te=Mr.getCodeword(we);return Te===-1?null:new Fg(z,fe,en.getCodewordBucketNumber(we),Te)}static getModuleBitCount(w,_,A,L,z,K){let Q=z,te=new Int32Array(8),ae=0,fe=L?1:-1,ve=L;for(;(L?Q<A:Q>=_)&&ae<te.length;)w.get(Q,K)===ve?(te[ae]++,Q+=fe):(ae++,ve=!ve);return ae===te.length||Q===(L?A:_)&&ae===te.length-1?te:null}static getNumberOfECCodeWords(w){return 2<<w}static adjustCodewordStartColumn(w,_,A,L,z,K){let Q=z,te=L?-1:1;for(let ae=0;ae<2;ae++){for(;(L?Q>=_:Q<A)&&L===w.get(Q,K);){if(Math.abs(z-Q)>en.CODEWORD_SKEW_SIZE)return z;Q+=te}te=-te,L=!L}return Q}static checkCodewordSkew(w,_,A){return _-en.CODEWORD_SKEW_SIZE<=w&&w<=A+en.CODEWORD_SKEW_SIZE}static decodeCodewords(w,_,A){if(w.length===0)throw R.getFormatInstance();let L=1<<_+1,z=en.correctErrors(w,A,L);en.verifyCodewordCount(w,L);let K=mt.decode(w,""+_);return K.setErrorsCorrected(z),K.setErasures(A.length),K}static correctErrors(w,_,A){if(_!=null&&_.length>A/2+en.MAX_ERRORS||A<0||A>en.MAX_EC_CODEWORDS)throw m.getChecksumInstance();return en.errorCorrection.decode(w,A,_)}static verifyCodewordCount(w,_){if(w.length<4)throw R.getFormatInstance();let A=w[0];if(A>w.length)throw R.getFormatInstance();if(A===0)if(_<w.length)w[0]=w.length-_;else throw R.getFormatInstance()}static getBitCountForCodeword(w){let _=new Int32Array(8),A=0,L=_.length-1;for(;!((w&1)!==A&&(A=w&1,L--,L<0));)_[L]++,w>>=1;return _}static getCodewordBucketNumber(w){return w instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(w):this.getCodewordBucketNumber_number(w)}static getCodewordBucketNumber_number(w){return en.getCodewordBucketNumber(en.getBitCountForCodeword(w))}static getCodewordBucketNumber_Int32Array(w){return(w[0]-w[2]+w[4]-w[6]+9)%9}static toString(w){let _=new Dg;for(let A=0;A<w.length;A++){_.format("Row %2d: ",A);for(let L=0;L<w[A].length;L++){let z=w[A][L];z.getValue().length===0?_.format("        ",null):_.format("%4d(%2d)",z.getValue()[0],z.getConfidence(z.getValue()[0]))}_.format("%n")}return _.toString()}}en.CODEWORD_SKEW_SIZE=2,en.MAX_ERRORS=3,en.MAX_EC_CODEWORDS=512,en.errorCorrection=new aT;class Oa{decode(w,_=null){let A=Oa.decode(w,_,!1);if(A==null||A.length===0||A[0]==null)throw S.getNotFoundInstance();return A[0]}decodeMultiple(w,_=null){try{return Oa.decode(w,_,!0)}catch(A){throw A instanceof R||A instanceof m?S.getNotFoundInstance():A}}static decode(w,_,A){const L=new Array,z=Zr.detectMultiple(w,_,A);for(const K of z.getPoints()){const Q=en.decode(z.getBits(),K[4],K[5],K[6],K[7],Oa.getMinCodewordWidth(K),Oa.getMaxCodewordWidth(K)),te=new Z(Q.getText(),Q.getRawBytes(),void 0,K,W.PDF_417);te.putMetadata(V.ERROR_CORRECTION_LEVEL,Q.getECLevel());const ae=Q.getOther();ae!=null&&te.putMetadata(V.PDF417_EXTRA_METADATA,ae),L.push(te)}return L.map(K=>K)}static getMaxWidth(w,_){return w==null||_==null?0:Math.trunc(Math.abs(w.getX()-_.getX()))}static getMinWidth(w,_){return w==null||_==null?b.MAX_VALUE:Math.trunc(Math.abs(w.getX()-_.getX()))}static getMaxCodewordWidth(w){return Math.floor(Math.max(Math.max(Oa.getMaxWidth(w[0],w[4]),Oa.getMaxWidth(w[6],w[2])*Mr.MODULES_IN_CODEWORD/Mr.MODULES_IN_STOP_PATTERN),Math.max(Oa.getMaxWidth(w[1],w[5]),Oa.getMaxWidth(w[7],w[3])*Mr.MODULES_IN_CODEWORD/Mr.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(w){return Math.floor(Math.min(Math.min(Oa.getMinWidth(w[0],w[4]),Oa.getMinWidth(w[6],w[2])*Mr.MODULES_IN_CODEWORD/Mr.MODULES_IN_STOP_PATTERN),Math.min(Oa.getMinWidth(w[1],w[5]),Oa.getMinWidth(w[7],w[3])*Mr.MODULES_IN_CODEWORD/Mr.MODULES_IN_STOP_PATTERN)))}reset(){}}class M1 extends c{}M1.kind="ReaderException";class uT{constructor(w,_){this.verbose=w===!0,_&&this.setHints(_)}decode(w,_){return _&&this.setHints(_),this.decodeInternal(w)}decodeWithState(w){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(w)}setHints(w){this.hints=w;const _=!s(w)&&w.get(O.TRY_HARDER)===!0,A=s(w)?null:w.get(O.POSSIBLE_FORMATS),L=new Array;if(!s(A)){const z=A.some(K=>K===W.UPC_A||K===W.UPC_E||K===W.EAN_13||K===W.EAN_8||K===W.CODABAR||K===W.CODE_39||K===W.CODE_93||K===W.CODE_128||K===W.ITF||K===W.RSS_14||K===W.RSS_EXPANDED);z&&!_&&L.push(new kt(w,this.verbose)),A.includes(W.QR_CODE)&&L.push(new Yi),A.includes(W.DATA_MATRIX)&&L.push(new Ka),A.includes(W.AZTEC)&&L.push(new nt),A.includes(W.PDF_417)&&L.push(new Oa),z&&_&&L.push(new kt(w,this.verbose))}L.length===0&&(_||L.push(new kt(w,this.verbose)),L.push(new Yi),L.push(new Ka),L.push(new nt),L.push(new Oa),_&&L.push(new kt(w,this.verbose))),this.readers=L}reset(){if(this.readers!==null)for(const w of this.readers)w.reset()}decodeInternal(w){if(this.readers===null)throw new M1("No readers where selected, nothing can be read.");for(const _ of this.readers)try{return _.decode(w,this.hints)}catch(A){if(A instanceof M1)continue}throw new S("No MultiFormat Readers were able to detect the code.")}}class nee extends X{constructor(w=null,_=500){const A=new uT;A.setHints(w),super(A,_)}decodeBitmap(w){return this.reader.decodeWithState(w)}}class see extends X{constructor(w=500){super(new Oa,w)}}class aee extends X{constructor(w=500){super(new Yi,w)}}var Kj;(function(xe){xe[xe.ERROR_CORRECTION=0]="ERROR_CORRECTION",xe[xe.CHARACTER_SET=1]="CHARACTER_SET",xe[xe.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",xe[xe.MIN_SIZE=3]="MIN_SIZE",xe[xe.MAX_SIZE=4]="MAX_SIZE",xe[xe.MARGIN=5]="MARGIN",xe[xe.PDF417_COMPACT=6]="PDF417_COMPACT",xe[xe.PDF417_COMPACTION=7]="PDF417_COMPACTION",xe[xe.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",xe[xe.AZTEC_LAYERS=9]="AZTEC_LAYERS",xe[xe.QR_VERSION=10]="QR_VERSION"})(Kj||(Kj={}));var ra=Kj;class Xj{constructor(w){this.field=w,this.cachedGenerators=[],this.cachedGenerators.push(new ie(w,Int32Array.from([1])))}buildGenerator(w){const _=this.cachedGenerators;if(w>=_.length){let A=_[_.length-1];const L=this.field;for(let z=_.length;z<=w;z++){const K=A.multiply(new ie(L,Int32Array.from([1,L.exp(z-1+L.getGeneratorBase())])));_.push(K),A=K}}return _[w]}encode(w,_){if(_===0)throw new h("No error correction bytes");const A=w.length-_;if(A<=0)throw new h("No data bytes provided");const L=this.buildGenerator(_),z=new Int32Array(A);g.arraycopy(w,0,z,0,A);let K=new ie(this.field,z);K=K.multiplyByMonomial(_,1);const te=K.divide(L)[1].getCoefficients(),ae=_-te.length;for(let fe=0;fe<ae;fe++)w[A+fe]=0;g.arraycopy(te,0,w,A+ae,te.length)}}class Ps{constructor(){}static applyMaskPenaltyRule1(w){return Ps.applyMaskPenaltyRule1Internal(w,!0)+Ps.applyMaskPenaltyRule1Internal(w,!1)}static applyMaskPenaltyRule2(w){let _=0;const A=w.getArray(),L=w.getWidth(),z=w.getHeight();for(let K=0;K<z-1;K++){const Q=A[K];for(let te=0;te<L-1;te++){const ae=Q[te];ae===Q[te+1]&&ae===A[K+1][te]&&ae===A[K+1][te+1]&&_++}}return Ps.N2*_}static applyMaskPenaltyRule3(w){let _=0;const A=w.getArray(),L=w.getWidth(),z=w.getHeight();for(let K=0;K<z;K++)for(let Q=0;Q<L;Q++){const te=A[K];Q+6<L&&te[Q]===1&&te[Q+1]===0&&te[Q+2]===1&&te[Q+3]===1&&te[Q+4]===1&&te[Q+5]===0&&te[Q+6]===1&&(Ps.isWhiteHorizontal(te,Q-4,Q)||Ps.isWhiteHorizontal(te,Q+7,Q+11))&&_++,K+6<z&&A[K][Q]===1&&A[K+1][Q]===0&&A[K+2][Q]===1&&A[K+3][Q]===1&&A[K+4][Q]===1&&A[K+5][Q]===0&&A[K+6][Q]===1&&(Ps.isWhiteVertical(A,Q,K-4,K)||Ps.isWhiteVertical(A,Q,K+7,K+11))&&_++}return _*Ps.N3}static isWhiteHorizontal(w,_,A){_=Math.max(_,0),A=Math.min(A,w.length);for(let L=_;L<A;L++)if(w[L]===1)return!1;return!0}static isWhiteVertical(w,_,A,L){A=Math.max(A,0),L=Math.min(L,w.length);for(let z=A;z<L;z++)if(w[z][_]===1)return!1;return!0}static applyMaskPenaltyRule4(w){let _=0;const A=w.getArray(),L=w.getWidth(),z=w.getHeight();for(let te=0;te<z;te++){const ae=A[te];for(let fe=0;fe<L;fe++)ae[fe]===1&&_++}const K=w.getHeight()*w.getWidth();return Math.floor(Math.abs(_*2-K)*10/K)*Ps.N4}static getDataMaskBit(w,_,A){let L,z;switch(w){case 0:L=A+_&1;break;case 1:L=A&1;break;case 2:L=_%3;break;case 3:L=(A+_)%3;break;case 4:L=Math.floor(A/2)+Math.floor(_/3)&1;break;case 5:z=A*_,L=(z&1)+z%3;break;case 6:z=A*_,L=(z&1)+z%3&1;break;case 7:z=A*_,L=z%3+(A+_&1)&1;break;default:throw new h("Invalid mask pattern: "+w)}return L===0}static applyMaskPenaltyRule1Internal(w,_){let A=0;const L=_?w.getHeight():w.getWidth(),z=_?w.getWidth():w.getHeight(),K=w.getArray();for(let Q=0;Q<L;Q++){let te=0,ae=-1;for(let fe=0;fe<z;fe++){const ve=_?K[Q][fe]:K[fe][Q];ve===ae?te++:(te>=5&&(A+=Ps.N1+(te-5)),te=1,ae=ve)}te>=5&&(A+=Ps.N1+(te-5))}return A}}Ps.N1=3,Ps.N2=3,Ps.N3=40,Ps.N4=10;class I1{constructor(w,_){this.width=w,this.height=_;const A=new Array(_);for(let L=0;L!==_;L++)A[L]=new Uint8Array(w);this.bytes=A}getHeight(){return this.height}getWidth(){return this.width}get(w,_){return this.bytes[_][w]}getArray(){return this.bytes}setNumber(w,_,A){this.bytes[_][w]=A}setBoolean(w,_,A){this.bytes[_][w]=A?1:0}clear(w){for(const _ of this.bytes)y.fill(_,w)}equals(w){if(!(w instanceof I1))return!1;const _=w;if(this.width!==_.width||this.height!==_.height)return!1;for(let A=0,L=this.height;A<L;++A){const z=this.bytes[A],K=_.bytes[A];for(let Q=0,te=this.width;Q<te;++Q)if(z[Q]!==K[Q])return!1}return!0}toString(){const w=new I;for(let _=0,A=this.height;_<A;++_){const L=this.bytes[_];for(let z=0,K=this.width;z<K;++z)switch(L[z]){case 0:w.append(" 0");break;case 1:w.append(" 1");break;default:w.append("  ");break}w.append(`
`)}return w.toString()}}class Xu{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const w=new I;return w.append(`<<
`),w.append(" mode: "),w.append(this.mode?this.mode.toString():"null"),w.append(`
 ecLevel: `),w.append(this.ecLevel?this.ecLevel.toString():"null"),w.append(`
 version: `),w.append(this.version?this.version.toString():"null"),w.append(`
 maskPattern: `),w.append(this.maskPattern.toString()),this.matrix?(w.append(`
 matrix:
`),w.append(this.matrix.toString())):w.append(`
 matrix: null
`),w.append(`>>
`),w.toString()}setMode(w){this.mode=w}setECLevel(w){this.ecLevel=w}setVersion(w){this.version=w}setMaskPattern(w){this.maskPattern=w}setMatrix(w){this.matrix=w}static isValidMaskPattern(w){return w>=0&&w<Xu.NUM_MASK_PATTERNS}}Xu.NUM_MASK_PATTERNS=8;class Hn extends c{}Hn.kind="WriterException";class Er{constructor(){}static clearMatrix(w){w.clear(255)}static buildMatrix(w,_,A,L,z){Er.clearMatrix(z),Er.embedBasicPatterns(A,z),Er.embedTypeInfo(_,L,z),Er.maybeEmbedVersionInfo(A,z),Er.embedDataBits(w,L,z)}static embedBasicPatterns(w,_){Er.embedPositionDetectionPatternsAndSeparators(_),Er.embedDarkDotAtLeftBottomCorner(_),Er.maybeEmbedPositionAdjustmentPatterns(w,_),Er.embedTimingPatterns(_)}static embedTypeInfo(w,_,A){const L=new j;Er.makeTypeInfoBits(w,_,L);for(let z=0,K=L.getSize();z<K;++z){const Q=L.get(L.getSize()-1-z),te=Er.TYPE_INFO_COORDINATES[z],ae=te[0],fe=te[1];if(A.setBoolean(ae,fe,Q),z<8){const ve=A.getWidth()-z-1;A.setBoolean(ve,8,Q)}else{const we=A.getHeight()-7+(z-8);A.setBoolean(8,we,Q)}}}static maybeEmbedVersionInfo(w,_){if(w.getVersionNumber()<7)return;const A=new j;Er.makeVersionInfoBits(w,A);let L=6*3-1;for(let z=0;z<6;++z)for(let K=0;K<3;++K){const Q=A.get(L);L--,_.setBoolean(z,_.getHeight()-11+K,Q),_.setBoolean(_.getHeight()-11+K,z,Q)}}static embedDataBits(w,_,A){let L=0,z=-1,K=A.getWidth()-1,Q=A.getHeight()-1;for(;K>0;){for(K===6&&(K-=1);Q>=0&&Q<A.getHeight();){for(let te=0;te<2;++te){const ae=K-te;if(!Er.isEmpty(A.get(ae,Q)))continue;let fe;L<w.getSize()?(fe=w.get(L),++L):fe=!1,_!==255&&Ps.getDataMaskBit(_,ae,Q)&&(fe=!fe),A.setBoolean(ae,Q,fe)}Q+=z}z=-z,Q+=z,K-=2}if(L!==w.getSize())throw new Hn("Not all bits consumed: "+L+"/"+w.getSize())}static findMSBSet(w){return 32-b.numberOfLeadingZeros(w)}static calculateBCHCode(w,_){if(_===0)throw new h("0 polynomial");const A=Er.findMSBSet(_);for(w<<=A-1;Er.findMSBSet(w)>=A;)w^=_<<Er.findMSBSet(w)-A;return w}static makeTypeInfoBits(w,_,A){if(!Xu.isValidMaskPattern(_))throw new Hn("Invalid mask pattern");const L=w.getBits()<<3|_;A.appendBits(L,5);const z=Er.calculateBCHCode(L,Er.TYPE_INFO_POLY);A.appendBits(z,10);const K=new j;if(K.appendBits(Er.TYPE_INFO_MASK_PATTERN,15),A.xor(K),A.getSize()!==15)throw new Hn("should not happen but we got: "+A.getSize())}static makeVersionInfoBits(w,_){_.appendBits(w.getVersionNumber(),6);const A=Er.calculateBCHCode(w.getVersionNumber(),Er.VERSION_INFO_POLY);if(_.appendBits(A,12),_.getSize()!==18)throw new Hn("should not happen but we got: "+_.getSize())}static isEmpty(w){return w===255}static embedTimingPatterns(w){for(let _=8;_<w.getWidth()-8;++_){const A=(_+1)%2;Er.isEmpty(w.get(_,6))&&w.setNumber(_,6,A),Er.isEmpty(w.get(6,_))&&w.setNumber(6,_,A)}}static embedDarkDotAtLeftBottomCorner(w){if(w.get(8,w.getHeight()-8)===0)throw new Hn;w.setNumber(8,w.getHeight()-8,1)}static embedHorizontalSeparationPattern(w,_,A){for(let L=0;L<8;++L){if(!Er.isEmpty(A.get(w+L,_)))throw new Hn;A.setNumber(w+L,_,0)}}static embedVerticalSeparationPattern(w,_,A){for(let L=0;L<7;++L){if(!Er.isEmpty(A.get(w,_+L)))throw new Hn;A.setNumber(w,_+L,0)}}static embedPositionAdjustmentPattern(w,_,A){for(let L=0;L<5;++L){const z=Er.POSITION_ADJUSTMENT_PATTERN[L];for(let K=0;K<5;++K)A.setNumber(w+K,_+L,z[K])}}static embedPositionDetectionPattern(w,_,A){for(let L=0;L<7;++L){const z=Er.POSITION_DETECTION_PATTERN[L];for(let K=0;K<7;++K)A.setNumber(w+K,_+L,z[K])}}static embedPositionDetectionPatternsAndSeparators(w){const _=Er.POSITION_DETECTION_PATTERN[0].length;Er.embedPositionDetectionPattern(0,0,w),Er.embedPositionDetectionPattern(w.getWidth()-_,0,w),Er.embedPositionDetectionPattern(0,w.getWidth()-_,w);const A=8;Er.embedHorizontalSeparationPattern(0,A-1,w),Er.embedHorizontalSeparationPattern(w.getWidth()-A,A-1,w),Er.embedHorizontalSeparationPattern(0,w.getWidth()-A,w);const L=7;Er.embedVerticalSeparationPattern(L,0,w),Er.embedVerticalSeparationPattern(w.getHeight()-L-1,0,w),Er.embedVerticalSeparationPattern(L,w.getHeight()-L,w)}static maybeEmbedPositionAdjustmentPatterns(w,_){if(w.getVersionNumber()<2)return;const A=w.getVersionNumber()-1,L=Er.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[A];for(let z=0,K=L.length;z!==K;z++){const Q=L[z];if(Q>=0)for(let te=0;te!==K;te++){const ae=L[te];ae>=0&&Er.isEmpty(_.get(ae,Q))&&Er.embedPositionAdjustmentPattern(ae-2,Q-2,_)}}}}Er.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Er.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Er.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Er.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Er.VERSION_INFO_POLY=7973,Er.TYPE_INFO_POLY=1335,Er.TYPE_INFO_MASK_PATTERN=21522;class iee{constructor(w,_){this.dataBytes=w,this.errorCorrectionBytes=_}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class as{constructor(){}static calculateMaskPenalty(w){return Ps.applyMaskPenaltyRule1(w)+Ps.applyMaskPenaltyRule2(w)+Ps.applyMaskPenaltyRule3(w)+Ps.applyMaskPenaltyRule4(w)}static encode(w,_,A=null){let L=as.DEFAULT_BYTE_MODE_ENCODING;const z=A!==null&&A.get(ra.CHARACTER_SET)!==void 0;z&&(L=A.get(ra.CHARACTER_SET).toString());const K=this.chooseMode(w,L),Q=new j;if(K===vr.BYTE&&(z||as.DEFAULT_BYTE_MODE_ENCODING!==L)){const zt=B.getCharacterSetECIByName(L);zt!==void 0&&this.appendECI(zt,Q)}this.appendModeInfo(K,Q);const te=new j;this.appendBytes(w,K,te,L);let ae;if(A!==null&&A.get(ra.QR_VERSION)!==void 0){const zt=Number.parseInt(A.get(ra.QR_VERSION).toString(),10);ae=ur.getVersionForNumber(zt);const Mt=this.calculateBitsNeeded(K,Q,te,ae);if(!this.willFit(Mt,ae,_))throw new Hn("Data too big for requested version")}else ae=this.recommendVersion(_,K,Q,te);const fe=new j;fe.appendBitArray(Q);const ve=K===vr.BYTE?te.getSizeInBytes():w.length;this.appendLengthInfo(ve,ae,K,fe),fe.appendBitArray(te);const we=ae.getECBlocksForLevel(_),Te=ae.getTotalCodewords()-we.getTotalECCodewords();this.terminateBits(Te,fe);const Ve=this.interleaveWithECBytes(fe,ae.getTotalCodewords(),Te,we.getNumBlocks()),We=new Xu;We.setECLevel(_),We.setMode(K),We.setVersion(ae);const at=ae.getDimensionForVersion(),pt=new I1(at,at),$t=this.chooseMaskPattern(Ve,_,ae,pt);return We.setMaskPattern($t),Er.buildMatrix(Ve,_,ae,$t,pt),We.setMatrix(pt),We}static recommendVersion(w,_,A,L){const z=this.calculateBitsNeeded(_,A,L,ur.getVersionForNumber(1)),K=this.chooseVersion(z,w),Q=this.calculateBitsNeeded(_,A,L,K);return this.chooseVersion(Q,w)}static calculateBitsNeeded(w,_,A,L){return _.getSize()+w.getCharacterCountBits(L)+A.getSize()}static getAlphanumericCode(w){return w<as.ALPHANUMERIC_TABLE.length?as.ALPHANUMERIC_TABLE[w]:-1}static chooseMode(w,_=null){if(B.SJIS.getName()===_&&this.isOnlyDoubleByteKanji(w))return vr.KANJI;let A=!1,L=!1;for(let z=0,K=w.length;z<K;++z){const Q=w.charAt(z);if(as.isDigit(Q))A=!0;else if(this.getAlphanumericCode(Q.charCodeAt(0))!==-1)L=!0;else return vr.BYTE}return L?vr.ALPHANUMERIC:A?vr.NUMERIC:vr.BYTE}static isOnlyDoubleByteKanji(w){let _;try{_=Y.encode(w,B.SJIS)}catch{return!1}const A=_.length;if(A%2!==0)return!1;for(let L=0;L<A;L+=2){const z=_[L]&255;if((z<129||z>159)&&(z<224||z>235))return!1}return!0}static chooseMaskPattern(w,_,A,L){let z=Number.MAX_SAFE_INTEGER,K=-1;for(let Q=0;Q<Xu.NUM_MASK_PATTERNS;Q++){Er.buildMatrix(w,_,A,Q,L);let te=this.calculateMaskPenalty(L);te<z&&(z=te,K=Q)}return K}static chooseVersion(w,_){for(let A=1;A<=40;A++){const L=ur.getVersionForNumber(A);if(as.willFit(w,L,_))return L}throw new Hn("Data too big")}static willFit(w,_,A){const L=_.getTotalCodewords(),K=_.getECBlocksForLevel(A).getTotalECCodewords(),Q=L-K,te=(w+7)/8;return Q>=te}static terminateBits(w,_){const A=w*8;if(_.getSize()>A)throw new Hn("data bits cannot fit in the QR Code"+_.getSize()+" > "+A);for(let K=0;K<4&&_.getSize()<A;++K)_.appendBit(!1);const L=_.getSize()&7;if(L>0)for(let K=L;K<8;K++)_.appendBit(!1);const z=w-_.getSizeInBytes();for(let K=0;K<z;++K)_.appendBits(K&1?17:236,8);if(_.getSize()!==A)throw new Hn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(w,_,A,L,z,K){if(L>=A)throw new Hn("Block ID too large");const Q=w%A,te=A-Q,ae=Math.floor(w/A),fe=ae+1,ve=Math.floor(_/A),we=ve+1,Te=ae-ve,Ve=fe-we;if(Te!==Ve)throw new Hn("EC bytes mismatch");if(A!==te+Q)throw new Hn("RS blocks mismatch");if(w!==(ve+Te)*te+(we+Ve)*Q)throw new Hn("Total bytes mismatch");L<te?(z[0]=ve,K[0]=Te):(z[0]=we,K[0]=Ve)}static interleaveWithECBytes(w,_,A,L){if(w.getSizeInBytes()!==A)throw new Hn("Number of bits and data bytes does not match");let z=0,K=0,Q=0;const te=new Array;for(let fe=0;fe<L;++fe){const ve=new Int32Array(1),we=new Int32Array(1);as.getNumDataBytesAndNumECBytesForBlockID(_,A,L,fe,ve,we);const Te=ve[0],Ve=new Uint8Array(Te);w.toBytes(8*z,Ve,0,Te);const We=as.generateECBytes(Ve,we[0]);te.push(new iee(Ve,We)),K=Math.max(K,Te),Q=Math.max(Q,We.length),z+=ve[0]}if(A!==z)throw new Hn("Data bytes does not match offset");const ae=new j;for(let fe=0;fe<K;++fe)for(const ve of te){const we=ve.getDataBytes();fe<we.length&&ae.appendBits(we[fe],8)}for(let fe=0;fe<Q;++fe)for(const ve of te){const we=ve.getErrorCorrectionBytes();fe<we.length&&ae.appendBits(we[fe],8)}if(_!==ae.getSizeInBytes())throw new Hn("Interleaving error: "+_+" and "+ae.getSizeInBytes()+" differ.");return ae}static generateECBytes(w,_){const A=w.length,L=new Int32Array(A+_);for(let K=0;K<A;K++)L[K]=w[K]&255;new Xj(se.QR_CODE_FIELD_256).encode(L,_);const z=new Uint8Array(_);for(let K=0;K<_;K++)z[K]=L[A+K];return z}static appendModeInfo(w,_){_.appendBits(w.getBits(),4)}static appendLengthInfo(w,_,A,L){const z=A.getCharacterCountBits(_);if(w>=1<<z)throw new Hn(w+" is bigger than "+((1<<z)-1));L.appendBits(w,z)}static appendBytes(w,_,A,L){switch(_){case vr.NUMERIC:as.appendNumericBytes(w,A);break;case vr.ALPHANUMERIC:as.appendAlphanumericBytes(w,A);break;case vr.BYTE:as.append8BitBytes(w,A,L);break;case vr.KANJI:as.appendKanjiBytes(w,A);break;default:throw new Hn("Invalid mode: "+_)}}static getDigit(w){return w.charCodeAt(0)-48}static isDigit(w){const _=as.getDigit(w);return _>=0&&_<=9}static appendNumericBytes(w,_){const A=w.length;let L=0;for(;L<A;){const z=as.getDigit(w.charAt(L));if(L+2<A){const K=as.getDigit(w.charAt(L+1)),Q=as.getDigit(w.charAt(L+2));_.appendBits(z*100+K*10+Q,10),L+=3}else if(L+1<A){const K=as.getDigit(w.charAt(L+1));_.appendBits(z*10+K,7),L+=2}else _.appendBits(z,4),L++}}static appendAlphanumericBytes(w,_){const A=w.length;let L=0;for(;L<A;){const z=as.getAlphanumericCode(w.charCodeAt(L));if(z===-1)throw new Hn;if(L+1<A){const K=as.getAlphanumericCode(w.charCodeAt(L+1));if(K===-1)throw new Hn;_.appendBits(z*45+K,11),L+=2}else _.appendBits(z,6),L++}}static append8BitBytes(w,_,A){let L;try{L=Y.encode(w,A)}catch(z){throw new Hn(z)}for(let z=0,K=L.length;z!==K;z++){const Q=L[z];_.appendBits(Q,8)}}static appendKanjiBytes(w,_){let A;try{A=Y.encode(w,B.SJIS)}catch(z){throw new Hn(z)}const L=A.length;for(let z=0;z<L;z+=2){const K=A[z]&255,Q=A[z+1]&255,te=K<<8&4294967295|Q;let ae=-1;if(te>=33088&&te<=40956?ae=te-33088:te>=57408&&te<=60351&&(ae=te-49472),ae===-1)throw new Hn("Invalid byte sequence");const fe=(ae>>8)*192+(ae&255);_.appendBits(fe,13)}}static appendECI(w,_){_.appendBits(vr.ECI.getBits(),4),_.appendBits(w.getValue(),8)}}as.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),as.DEFAULT_BYTE_MODE_ENCODING=B.UTF8.getName();class Yu{write(w,_,A,L=null){if(w.length===0)throw new h("Found empty contents");if(_<0||A<0)throw new h("Requested dimensions are too small: "+_+"x"+A);let z=_n.L,K=Yu.QUIET_ZONE_SIZE;L!==null&&(L.get(ra.ERROR_CORRECTION)!==void 0&&(z=_n.fromString(L.get(ra.ERROR_CORRECTION).toString())),L.get(ra.MARGIN)!==void 0&&(K=Number.parseInt(L.get(ra.MARGIN).toString(),10)));const Q=as.encode(w,z,L);return this.renderResult(Q,_,A,K)}writeToDom(w,_,A,L,z=null){typeof w=="string"&&(w=document.querySelector(w));const K=this.write(_,A,L,z);w&&w.appendChild(K)}renderResult(w,_,A,L){const z=w.getMatrix();if(z===null)throw new pe;const K=z.getWidth(),Q=z.getHeight(),te=K+L*2,ae=Q+L*2,fe=Math.max(_,te),ve=Math.max(A,ae),we=Math.min(Math.floor(fe/te),Math.floor(ve/ae)),Te=Math.floor((fe-K*we)/2),Ve=Math.floor((ve-Q*we)/2),We=this.createSVGElement(fe,ve);for(let at=0,pt=Ve;at<Q;at++,pt+=we)for(let $t=0,zt=Te;$t<K;$t++,zt+=we)if(z.get($t,at)===1){const Mt=this.createSvgRectElement(zt,pt,we,we);We.appendChild(Mt)}return We}createSVGElement(w,_){const A=document.createElementNS(Yu.SVG_NS,"svg");return A.setAttributeNS(null,"height",w.toString()),A.setAttributeNS(null,"width",_.toString()),A}createSvgRectElement(w,_,A,L){const z=document.createElementNS(Yu.SVG_NS,"rect");return z.setAttributeNS(null,"x",w.toString()),z.setAttributeNS(null,"y",_.toString()),z.setAttributeNS(null,"height",A.toString()),z.setAttributeNS(null,"width",L.toString()),z.setAttributeNS(null,"fill","#000000"),z}}Yu.QUIET_ZONE_SIZE=4,Yu.SVG_NS="http://www.w3.org/2000/svg";class Tf{encode(w,_,A,L,z){if(w.length===0)throw new h("Found empty contents");if(_!==W.QR_CODE)throw new h("Can only encode QR_CODE, but got "+_);if(A<0||L<0)throw new h(`Requested dimensions are too small: ${A}x${L}`);let K=_n.L,Q=Tf.QUIET_ZONE_SIZE;z!==null&&(z.get(ra.ERROR_CORRECTION)!==void 0&&(K=_n.fromString(z.get(ra.ERROR_CORRECTION).toString())),z.get(ra.MARGIN)!==void 0&&(Q=Number.parseInt(z.get(ra.MARGIN).toString(),10)));const te=as.encode(w,K,z);return Tf.renderResult(te,A,L,Q)}static renderResult(w,_,A,L){const z=w.getMatrix();if(z===null)throw new pe;const K=z.getWidth(),Q=z.getHeight(),te=K+L*2,ae=Q+L*2,fe=Math.max(_,te),ve=Math.max(A,ae),we=Math.min(Math.floor(fe/te),Math.floor(ve/ae)),Te=Math.floor((fe-K*we)/2),Ve=Math.floor((ve-Q*we)/2),We=new F(fe,ve);for(let at=0,pt=Ve;at<Q;at++,pt+=we)for(let $t=0,zt=Te;$t<K;$t++,zt+=we)z.get($t,at)===1&&We.setRegion(zt,pt,we,we);return We}}Tf.QUIET_ZONE_SIZE=4;class oee{encode(w,_,A,L,z){let K;switch(_){case W.QR_CODE:K=new Tf;break;default:throw new h("No encoder available for format "+_)}return K.encode(w,_,A,L,z)}}class Ll extends C{constructor(w,_,A,L,z,K,Q,te){if(super(K,Q),this.yuvData=w,this.dataWidth=_,this.dataHeight=A,this.left=L,this.top=z,L+K>_||z+Q>A)throw new h("Crop rectangle does not fit within image data.");te&&this.reverseHorizontal(K,Q)}getRow(w,_){if(w<0||w>=this.getHeight())throw new h("Requested row is outside the image: "+w);const A=this.getWidth();(_==null||_.length<A)&&(_=new Uint8ClampedArray(A));const L=(w+this.top)*this.dataWidth+this.left;return g.arraycopy(this.yuvData,L,_,0,A),_}getMatrix(){const w=this.getWidth(),_=this.getHeight();if(w===this.dataWidth&&_===this.dataHeight)return this.yuvData;const A=w*_,L=new Uint8ClampedArray(A);let z=this.top*this.dataWidth+this.left;if(w===this.dataWidth)return g.arraycopy(this.yuvData,z,L,0,A),L;for(let K=0;K<_;K++){const Q=K*w;g.arraycopy(this.yuvData,z,L,Q,w),z+=this.dataWidth}return L}isCropSupported(){return!0}crop(w,_,A,L){return new Ll(this.yuvData,this.dataWidth,this.dataHeight,this.left+w,this.top+_,A,L,!1)}renderThumbnail(){const w=this.getWidth()/Ll.THUMBNAIL_SCALE_FACTOR,_=this.getHeight()/Ll.THUMBNAIL_SCALE_FACTOR,A=new Int32Array(w*_),L=this.yuvData;let z=this.top*this.dataWidth+this.left;for(let K=0;K<_;K++){const Q=K*w;for(let te=0;te<w;te++){const ae=L[z+te*Ll.THUMBNAIL_SCALE_FACTOR]&255;A[Q+te]=4278190080|ae*65793}z+=this.dataWidth*Ll.THUMBNAIL_SCALE_FACTOR}return A}getThumbnailWidth(){return this.getWidth()/Ll.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Ll.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(w,_){const A=this.yuvData;for(let L=0,z=this.top*this.dataWidth+this.left;L<_;L++,z+=this.dataWidth){const K=z+w/2;for(let Q=z,te=z+w-1;Q<K;Q++,te--){const ae=A[Q];A[Q]=A[te],A[te]=ae}}}invert(){return new k(this)}}Ll.THUMBNAIL_SCALE_FACTOR=2;class Yj extends C{constructor(w,_,A,L,z,K,Q){if(super(_,A),this.dataWidth=L,this.dataHeight=z,this.left=K,this.top=Q,w.BYTES_PER_ELEMENT===4){const te=_*A,ae=new Uint8ClampedArray(te);for(let fe=0;fe<te;fe++){const ve=w[fe],we=ve>>16&255,Te=ve>>7&510,Ve=ve&255;ae[fe]=(we+Te+Ve)/4&255}this.luminances=ae}else this.luminances=w;if(L===void 0&&(this.dataWidth=_),z===void 0&&(this.dataHeight=A),K===void 0&&(this.left=0),Q===void 0&&(this.top=0),this.left+_>this.dataWidth||this.top+A>this.dataHeight)throw new h("Crop rectangle does not fit within image data.")}getRow(w,_){if(w<0||w>=this.getHeight())throw new h("Requested row is outside the image: "+w);const A=this.getWidth();(_==null||_.length<A)&&(_=new Uint8ClampedArray(A));const L=(w+this.top)*this.dataWidth+this.left;return g.arraycopy(this.luminances,L,_,0,A),_}getMatrix(){const w=this.getWidth(),_=this.getHeight();if(w===this.dataWidth&&_===this.dataHeight)return this.luminances;const A=w*_,L=new Uint8ClampedArray(A);let z=this.top*this.dataWidth+this.left;if(w===this.dataWidth)return g.arraycopy(this.luminances,z,L,0,A),L;for(let K=0;K<_;K++){const Q=K*w;g.arraycopy(this.luminances,z,L,Q,w),z+=this.dataWidth}return L}isCropSupported(){return!0}crop(w,_,A,L){return new Yj(this.luminances,A,L,this.dataWidth,this.dataHeight,this.left+w,this.top+_)}invert(){return new k(this)}}class hT extends B{static forName(w){return this.getCharacterSetECIByName(w)}}class Zj{}Zj.ISO_8859_1=B.ISO8859_1;class fT{isCompact(){return this.compact}setCompact(w){this.compact=w}getSize(){return this.size}setSize(w){this.size=w}getLayers(){return this.layers}setLayers(w){this.layers=w}getCodeWords(){return this.codeWords}setCodeWords(w){this.codeWords=w}getMatrix(){return this.matrix}setMatrix(w){this.matrix=w}}class mT{static singletonList(w){return[w]}static min(w,_){return w.sort(_)[0]}}class lee{constructor(w){this.previous=w}getPrevious(){return this.previous}}class Pf extends lee{constructor(w,_,A){super(w),this.value=_,this.bitCount=A}appendTo(w,_){w.appendBits(this.value,this.bitCount)}add(w,_){return new Pf(this,w,_)}addBinaryShift(w,_){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Pf(this,w,_)}toString(){let w=this.value&(1<<this.bitCount)-1;return w|=1<<this.bitCount,"<"+b.toBinaryString(w|1<<this.bitCount).substring(1)+">"}}class Qj extends Pf{constructor(w,_,A){super(w,0,0),this.binaryShiftStart=_,this.binaryShiftByteCount=A}appendTo(w,_){for(let A=0;A<this.binaryShiftByteCount;A++)(A===0||A===31&&this.binaryShiftByteCount<=62)&&(w.appendBits(31,5),this.binaryShiftByteCount>62?w.appendBits(this.binaryShiftByteCount-31,16):A===0?w.appendBits(Math.min(this.binaryShiftByteCount,31),5):w.appendBits(this.binaryShiftByteCount-31,5)),w.appendBits(_[this.binaryShiftStart+A],8)}addBinaryShift(w,_){return new Qj(this,w,_)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function cee(xe,w,_){return new Qj(xe,w,_)}function zg(xe,w,_){return new Pf(xe,w,_)}const dee=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],jd=0,D1=1,_o=2,pT=3,Bl=4,uee=new Pf(null,0,0),Jj=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function hee(xe){for(let w of xe)y.fill(w,-1);return xe[jd][Bl]=0,xe[D1][Bl]=0,xe[D1][jd]=28,xe[pT][Bl]=0,xe[_o][Bl]=0,xe[_o][jd]=15,xe}const gT=hee(y.createInt32Array(6,6));class $l{constructor(w,_,A,L){this.token=w,this.mode=_,this.binaryShiftByteCount=A,this.bitCount=L}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(w,_){let A=this.bitCount,L=this.token;if(w!==this.mode){let K=Jj[this.mode][w];L=zg(L,K&65535,K>>16),A+=K>>16}let z=w===_o?4:5;return L=zg(L,_,z),new $l(L,w,0,A+z)}shiftAndAppend(w,_){let A=this.token,L=this.mode===_o?4:5;return A=zg(A,gT[this.mode][w],L),A=zg(A,_,5),new $l(A,this.mode,0,this.bitCount+L+5)}addBinaryShiftChar(w){let _=this.token,A=this.mode,L=this.bitCount;if(this.mode===Bl||this.mode===_o){let Q=Jj[A][jd];_=zg(_,Q&65535,Q>>16),L+=Q>>16,A=jd}let z=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,K=new $l(_,A,this.binaryShiftByteCount+1,L+z);return K.binaryShiftByteCount===2078&&(K=K.endBinaryShift(w+1)),K}endBinaryShift(w){if(this.binaryShiftByteCount===0)return this;let _=this.token;return _=cee(_,w-this.binaryShiftByteCount,this.binaryShiftByteCount),new $l(_,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(w){let _=this.bitCount+(Jj[this.mode][w.mode]>>16);return this.binaryShiftByteCount<w.binaryShiftByteCount?_+=$l.calculateBinaryShiftCost(w)-$l.calculateBinaryShiftCost(this):this.binaryShiftByteCount>w.binaryShiftByteCount&&w.binaryShiftByteCount>0&&(_+=10),_<=w.bitCount}toBitArray(w){let _=[];for(let L=this.endBinaryShift(w.length).token;L!==null;L=L.getPrevious())_.unshift(L);let A=new j;for(const L of _)L.appendTo(A,w);return A}toString(){return G.format("%s bits=%d bytes=%d",dee[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(w){return w.binaryShiftByteCount>62?21:w.binaryShiftByteCount>31?20:w.binaryShiftByteCount>0?10:0}}$l.INITIAL_STATE=new $l(uee,jd,0,0);function fee(xe){const w=G.getCharCode(" "),_=G.getCharCode("."),A=G.getCharCode(",");xe[jd][w]=1;const L=G.getCharCode("Z"),z=G.getCharCode("A");for(let we=z;we<=L;we++)xe[jd][we]=we-z+2;xe[D1][w]=1;const K=G.getCharCode("z"),Q=G.getCharCode("a");for(let we=Q;we<=K;we++)xe[D1][we]=we-Q+2;xe[_o][w]=1;const te=G.getCharCode("9"),ae=G.getCharCode("0");for(let we=ae;we<=te;we++)xe[_o][we]=we-ae+2;xe[_o][A]=12,xe[_o][_]=13;const fe=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let we=0;we<fe.length;we++)xe[pT][G.getCharCode(fe[we])]=we;const ve=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let we=0;we<ve.length;we++)G.getCharCode(ve[we])>0&&(xe[Bl][G.getCharCode(ve[we])]=we);return xe}const eN=fee(y.createInt32Array(5,256));class Ug{constructor(w){this.text=w}encode(){const w=G.getCharCode(" "),_=G.getCharCode(`
`);let A=mT.singletonList($l.INITIAL_STATE);for(let z=0;z<this.text.length;z++){let K,Q=z+1<this.text.length?this.text[z+1]:0;switch(this.text[z]){case G.getCharCode("\r"):K=Q===_?2:0;break;case G.getCharCode("."):K=Q===w?3:0;break;case G.getCharCode(","):K=Q===w?4:0;break;case G.getCharCode(":"):K=Q===w?5:0;break;default:K=0}K>0?(A=Ug.updateStateListForPair(A,z,K),z++):A=this.updateStateListForChar(A,z)}return mT.min(A,(z,K)=>z.getBitCount()-K.getBitCount()).toBitArray(this.text)}updateStateListForChar(w,_){const A=[];for(let L of w)this.updateStateForChar(L,_,A);return Ug.simplifyStates(A)}updateStateForChar(w,_,A){let L=this.text[_]&255,z=eN[w.getMode()][L]>0,K=null;for(let Q=0;Q<=Bl;Q++){let te=eN[Q][L];if(te>0){if(K==null&&(K=w.endBinaryShift(_)),!z||Q===w.getMode()||Q===_o){const ae=K.latchAndAppend(Q,te);A.push(ae)}if(!z&&gT[w.getMode()][Q]>=0){const ae=K.shiftAndAppend(Q,te);A.push(ae)}}}if(w.getBinaryShiftByteCount()>0||eN[w.getMode()][L]===0){let Q=w.addBinaryShiftChar(_);A.push(Q)}}static updateStateListForPair(w,_,A){const L=[];for(let z of w)this.updateStateForPair(z,_,A,L);return this.simplifyStates(L)}static updateStateForPair(w,_,A,L){let z=w.endBinaryShift(_);if(L.push(z.latchAndAppend(Bl,A)),w.getMode()!==Bl&&L.push(z.shiftAndAppend(Bl,A)),A===3||A===4){let K=z.latchAndAppend(_o,16-A).latchAndAppend(_o,1);L.push(K)}if(w.getBinaryShiftByteCount()>0){let K=w.addBinaryShiftChar(_).addBinaryShiftChar(_+1);L.push(K)}}static simplifyStates(w){let _=[];for(const A of w){let L=!0;for(const z of _){if(z.isBetterThanOrEqualTo(A)){L=!1;break}A.isBetterThanOrEqualTo(z)&&(_=_.filter(K=>K!==z))}L&&_.push(A)}return _}}class jn{constructor(){}static encodeBytes(w){return jn.encode(w,jn.DEFAULT_EC_PERCENT,jn.DEFAULT_AZTEC_LAYERS)}static encode(w,_,A){let L=new Ug(w).encode(),z=b.truncDivision(L.getSize()*_,100)+11,K=L.getSize()+z,Q,te,ae,fe,ve;if(A!==jn.DEFAULT_AZTEC_LAYERS){if(Q=A<0,te=Math.abs(A),te>(Q?jn.MAX_NB_BITS_COMPACT:jn.MAX_NB_BITS))throw new h(G.format("Illegal value %s for layers",A));ae=jn.totalBitsInLayer(te,Q),fe=jn.WORD_SIZE[te];let Mt=ae-ae%fe;if(ve=jn.stuffBits(L,fe),ve.getSize()+z>Mt)throw new h("Data to large for user specified layer");if(Q&&ve.getSize()>fe*64)throw new h("Data to large for user specified layer")}else{fe=0,ve=null;for(let Mt=0;;Mt++){if(Mt>jn.MAX_NB_BITS)throw new h("Data too large for an Aztec code");if(Q=Mt<=3,te=Q?Mt+1:Mt,ae=jn.totalBitsInLayer(te,Q),K>ae)continue;(ve==null||fe!==jn.WORD_SIZE[te])&&(fe=jn.WORD_SIZE[te],ve=jn.stuffBits(L,fe));let dn=ae-ae%fe;if(!(Q&&ve.getSize()>fe*64)&&ve.getSize()+z<=dn)break}}let we=jn.generateCheckWords(ve,ae,fe),Te=ve.getSize()/fe,Ve=jn.generateModeMessage(Q,te,Te),We=(Q?11:14)+te*4,at=new Int32Array(We),pt;if(Q){pt=We;for(let Mt=0;Mt<at.length;Mt++)at[Mt]=Mt}else{pt=We+1+2*b.truncDivision(b.truncDivision(We,2)-1,15);let Mt=b.truncDivision(We,2),dn=b.truncDivision(pt,2);for(let Hr=0;Hr<Mt;Hr++){let ki=Hr+b.truncDivision(Hr,15);at[Mt-Hr-1]=dn-ki-1,at[Mt+Hr]=dn+ki+1}}let $t=new F(pt);for(let Mt=0,dn=0;Mt<te;Mt++){let Hr=(te-Mt)*4+(Q?9:12);for(let ki=0;ki<Hr;ki++){let Qo=ki*2;for(let Ai=0;Ai<2;Ai++)we.get(dn+Qo+Ai)&&$t.set(at[Mt*2+Ai],at[Mt*2+ki]),we.get(dn+Hr*2+Qo+Ai)&&$t.set(at[Mt*2+ki],at[We-1-Mt*2-Ai]),we.get(dn+Hr*4+Qo+Ai)&&$t.set(at[We-1-Mt*2-Ai],at[We-1-Mt*2-ki]),we.get(dn+Hr*6+Qo+Ai)&&$t.set(at[We-1-Mt*2-ki],at[Mt*2+Ai])}dn+=Hr*8}if(jn.drawModeMessage($t,Q,pt,Ve),Q)jn.drawBullsEye($t,b.truncDivision(pt,2),5);else{jn.drawBullsEye($t,b.truncDivision(pt,2),7);for(let Mt=0,dn=0;Mt<b.truncDivision(We,2)-1;Mt+=15,dn+=16)for(let Hr=b.truncDivision(pt,2)&1;Hr<pt;Hr+=2)$t.set(b.truncDivision(pt,2)-dn,Hr),$t.set(b.truncDivision(pt,2)+dn,Hr),$t.set(Hr,b.truncDivision(pt,2)-dn),$t.set(Hr,b.truncDivision(pt,2)+dn)}let zt=new fT;return zt.setCompact(Q),zt.setSize(pt),zt.setLayers(te),zt.setCodeWords(Te),zt.setMatrix($t),zt}static drawBullsEye(w,_,A){for(let L=0;L<A;L+=2)for(let z=_-L;z<=_+L;z++)w.set(z,_-L),w.set(z,_+L),w.set(_-L,z),w.set(_+L,z);w.set(_-A,_-A),w.set(_-A+1,_-A),w.set(_-A,_-A+1),w.set(_+A,_-A),w.set(_+A,_-A+1),w.set(_+A,_+A-1)}static generateModeMessage(w,_,A){let L=new j;return w?(L.appendBits(_-1,2),L.appendBits(A-1,6),L=jn.generateCheckWords(L,28,4)):(L.appendBits(_-1,5),L.appendBits(A-1,11),L=jn.generateCheckWords(L,40,4)),L}static drawModeMessage(w,_,A,L){let z=b.truncDivision(A,2);if(_)for(let K=0;K<7;K++){let Q=z-3+K;L.get(K)&&w.set(Q,z-5),L.get(K+7)&&w.set(z+5,Q),L.get(20-K)&&w.set(Q,z+5),L.get(27-K)&&w.set(z-5,Q)}else for(let K=0;K<10;K++){let Q=z-5+K+b.truncDivision(K,5);L.get(K)&&w.set(Q,z-7),L.get(K+10)&&w.set(z+7,Q),L.get(29-K)&&w.set(Q,z+7),L.get(39-K)&&w.set(z-7,Q)}}static generateCheckWords(w,_,A){let L=w.getSize()/A,z=new Xj(jn.getGF(A)),K=b.truncDivision(_,A),Q=jn.bitsToWords(w,A,K);z.encode(Q,K-L);let te=_%A,ae=new j;ae.appendBits(0,te);for(const fe of Array.from(Q))ae.appendBits(fe,A);return ae}static bitsToWords(w,_,A){let L=new Int32Array(A),z,K;for(z=0,K=w.getSize()/_;z<K;z++){let Q=0;for(let te=0;te<_;te++)Q|=w.get(z*_+te)?1<<_-te-1:0;L[z]=Q}return L}static getGF(w){switch(w){case 4:return se.AZTEC_PARAM;case 6:return se.AZTEC_DATA_6;case 8:return se.AZTEC_DATA_8;case 10:return se.AZTEC_DATA_10;case 12:return se.AZTEC_DATA_12;default:throw new h("Unsupported word size "+w)}}static stuffBits(w,_){let A=new j,L=w.getSize(),z=(1<<_)-2;for(let K=0;K<L;K+=_){let Q=0;for(let te=0;te<_;te++)(K+te>=L||w.get(K+te))&&(Q|=1<<_-1-te);(Q&z)===z?(A.appendBits(Q&z,_),K--):Q&z?A.appendBits(Q,_):(A.appendBits(Q|1,_),K--)}return A}static totalBitsInLayer(w,_){return((_?88:112)+16*w)*w}}jn.DEFAULT_EC_PERCENT=33,jn.DEFAULT_AZTEC_LAYERS=0,jn.MAX_NB_BITS=32,jn.MAX_NB_BITS_COMPACT=4,jn.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class L1{encode(w,_,A,L){return this.encodeWithHints(w,_,A,L,null)}encodeWithHints(w,_,A,L,z){let K=Zj.ISO_8859_1,Q=jn.DEFAULT_EC_PERCENT,te=jn.DEFAULT_AZTEC_LAYERS;return z!=null&&(z.has(ra.CHARACTER_SET)&&(K=hT.forName(z.get(ra.CHARACTER_SET).toString())),z.has(ra.ERROR_CORRECTION)&&(Q=b.parseInt(z.get(ra.ERROR_CORRECTION).toString())),z.has(ra.AZTEC_LAYERS)&&(te=b.parseInt(z.get(ra.AZTEC_LAYERS).toString()))),L1.encodeLayers(w,_,A,L,K,Q,te)}static encodeLayers(w,_,A,L,z,K,Q){if(_!==W.AZTEC)throw new h("Can only encode AZTEC, but got "+_);let te=jn.encode(G.getBytes(w,z),K,Q);return L1.renderResult(te,A,L)}static renderResult(w,_,A){let L=w.getMatrix();if(L==null)throw new pe;let z=L.getWidth(),K=L.getHeight(),Q=Math.max(_,z),te=Math.max(A,K),ae=Math.min(Q/z,te/K),fe=(Q-z*ae)/2,ve=(te-K*ae)/2,we=new F(Q,te);for(let Te=0,Ve=ve;Te<K;Te++,Ve+=ae)for(let We=0,at=fe;We<z;We++,at+=ae)L.get(We,Te)&&we.setRegion(at,Ve,ae,ae);return we}}r.AbstractExpandedDecoder=xr,r.ArgumentException=u,r.ArithmeticException=oe,r.AztecCode=fT,r.AztecCodeReader=nt,r.AztecCodeWriter=L1,r.AztecDecoder=me,r.AztecDetector=st,r.AztecDetectorResult=Oe,r.AztecEncoder=jn,r.AztecHighLevelEncoder=Ug,r.AztecPoint=Ae,r.BarcodeFormat=W,r.Binarizer=p,r.BinaryBitmap=f,r.BitArray=j,r.BitMatrix=F,r.BitSource=bn,r.BrowserAztecCodeReader=vt,r.BrowserBarcodeReader=Cr,r.BrowserCodeReader=X,r.BrowserDatamatrixCodeReader=vd,r.BrowserMultiFormatReader=nee,r.BrowserPDF417Reader=see,r.BrowserQRCodeReader=aee,r.BrowserQRCodeSvgWriter=Yu,r.CharacterSetECI=B,r.ChecksumException=m,r.Code128Reader=Ue,r.Code39Reader=Le,r.DataMatrixDecodedBitStreamParser=Wn,r.DataMatrixReader=Ka,r.DecodeHintType=O,r.DecoderResult=H,r.DefaultGridSampler=Qe,r.DetectorResult=ye,r.EAN13Reader=_t,r.EncodeHintType=ra,r.Exception=c,r.FormatException=R,r.GenericGF=se,r.GenericGFPoly=ie,r.GlobalHistogramBinarizer=E,r.GridSampler=De,r.GridSamplerInstance=Ie,r.HTMLCanvasElementLuminanceSource=M,r.HybridBinarizer=N,r.ITFReader=Ze,r.IllegalArgumentException=h,r.IllegalStateException=pe,r.InvertedLuminanceSource=k,r.LuminanceSource=C,r.MathUtils=ge,r.MultiFormatOneDReader=kt,r.MultiFormatReader=uT,r.MultiFormatWriter=oee,r.NotFoundException=S,r.OneDReader=Je,r.PDF417DecodedBitStreamParser=mt,r.PDF417DecoderErrorCorrection=aT,r.PDF417Reader=Oa,r.PDF417ResultMetadata=oT,r.PerspectiveTransform=Ge,r.PlanarYUVLuminanceSource=Ll,r.QRCodeByteMatrix=I1,r.QRCodeDataMask=Yn,r.QRCodeDecodedBitStreamParser=Rn,r.QRCodeDecoderErrorCorrectionLevel=_n,r.QRCodeDecoderFormatInformation=Br,r.QRCodeEncoder=as,r.QRCodeEncoderQRCode=Xu,r.QRCodeMaskUtil=Ps,r.QRCodeMatrixUtil=Er,r.QRCodeMode=vr,r.QRCodeReader=Yi,r.QRCodeVersion=ur,r.QRCodeWriter=Tf,r.RGBLuminanceSource=Yj,r.RSS14Reader=wt,r.RSSExpandedReader=ze,r.ReaderException=M1,r.ReedSolomonDecoder=ce,r.ReedSolomonEncoder=Xj,r.ReedSolomonException=ue,r.Result=Z,r.ResultMetadataType=V,r.ResultPoint=be,r.StringUtils=G,r.UnsupportedOperationException=q,r.VideoInputDevice=U,r.WhiteRectangleDetector=Ne,r.WriterException=Hn,r.ZXingArrays=y,r.ZXingCharset=hT,r.ZXingInteger=b,r.ZXingStandardCharsets=Zj,r.ZXingStringBuilder=I,r.ZXingStringEncoding=Y,r.ZXingSystem=g,r.createAbstractExpandedDecoder=Ce,Object.defineProperty(r,"__esModule",{value:!0})})})(AE,AE.exports);var ls=AE.exports;const MYe=Ln(ls),IYe=aB({__proto__:null,default:MYe},[ls]);var DL=function(){function e(t,r,s){if(this.formatMap=new Map([[or.QR_CODE,ls.BarcodeFormat.QR_CODE],[or.AZTEC,ls.BarcodeFormat.AZTEC],[or.CODABAR,ls.BarcodeFormat.CODABAR],[or.CODE_39,ls.BarcodeFormat.CODE_39],[or.CODE_93,ls.BarcodeFormat.CODE_93],[or.CODE_128,ls.BarcodeFormat.CODE_128],[or.DATA_MATRIX,ls.BarcodeFormat.DATA_MATRIX],[or.MAXICODE,ls.BarcodeFormat.MAXICODE],[or.ITF,ls.BarcodeFormat.ITF],[or.EAN_13,ls.BarcodeFormat.EAN_13],[or.EAN_8,ls.BarcodeFormat.EAN_8],[or.PDF_417,ls.BarcodeFormat.PDF_417],[or.RSS_14,ls.BarcodeFormat.RSS_14],[or.RSS_EXPANDED,ls.BarcodeFormat.RSS_EXPANDED],[or.UPC_A,ls.BarcodeFormat.UPC_A],[or.UPC_E,ls.BarcodeFormat.UPC_E],[or.UPC_EAN_EXTENSION,ls.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!IYe)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=r,this.logger=s;var a=this.createZXingFormats(t),i=new Map;i.set(ls.DecodeHintType.POSSIBLE_FORMATS,a),i.set(ls.DecodeHintType.TRY_HARDER,!1),this.hints=i}return e.prototype.decodeAsync=function(t){var r=this;return new Promise(function(s,a){try{s(r.decode(t))}catch(i){a(i)}})},e.prototype.decode=function(t){var r=new ls.MultiFormatReader(this.verbose,this.hints),s=new ls.HTMLCanvasElementLuminanceSource(t),a=new ls.BinaryBitmap(new ls.HybridBinarizer(s)),i=r.decode(a);return{text:i.text,format:WJ.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(r,s,a){t.set(r,s)}),t},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createZXingFormats=function(t){for(var r=[],s=0,a=t;s<a.length;s++){var i=a[s];this.formatMap.has(i)?r.push(this.formatMap.get(i)):this.logger.logError("".concat(i," is not supported by")+"ZXingHtml5QrcodeShim")}return r},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),DYe=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function d(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(l,d)}c((s=s.apply(e,t||[])).next())})},LYe=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,a,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(c){return function(u){return d([c,u])}}function d(c){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(r=0)),r;)try{if(s=1,a&&(i=c[0]&2?a.return:c[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,c[1])).done)return i;switch(a=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,a=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(u){c=[6,u],a=0}finally{s=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},LL=function(){function e(t,r,s){if(this.formatMap=new Map([[or.QR_CODE,"qr_code"],[or.AZTEC,"aztec"],[or.CODABAR,"codabar"],[or.CODE_39,"code_39"],[or.CODE_93,"code_93"],[or.CODE_128,"code_128"],[or.DATA_MATRIX,"data_matrix"],[or.ITF,"itf"],[or.EAN_13,"ean_13"],[or.EAN_8,"ean_8"],[or.PDF_417,"pdf417"],[or.UPC_A,"upc_a"],[or.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=r,this.logger=s;var a=this.createBarcodeDetectorFormats(t);if(this.detector=new BarcodeDetector(a),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var t=new BarcodeDetector({formats:["qr_code"]});return typeof t<"u"},e.prototype.decodeAsync=function(t){return DYe(this,void 0,void 0,function(){var r,s;return LYe(this,function(a){switch(a.label){case 0:return[4,this.detector.detect(t)];case 1:if(r=a.sent(),!r||r.length===0)throw"No barcode or QR code detected.";return s=this.selectLargestBarcode(r),[2,{text:s.rawValue,format:WJ.create(this.toHtml5QrcodeSupportedFormats(s.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(t){for(var r=null,s=0,a=0,i=t;a<i.length;a++){var o=i[a],l=o.boundingBox.width*o.boundingBox.height;l>s&&(s=l,r=o)}if(!r)throw"No largest barcode found";return r},e.prototype.createBarcodeDetectorFormats=function(t){for(var r=[],s=0,a=t;s<a.length;s++){var i=a[s];this.formatMap.has(i)?r.push(this.formatMap.get(i)):this.logger.warn("".concat(i," is not supported by")+"BarcodeDetectorDelegate")}return{formats:r}},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(r,s,a){t.set(r,s)}),t},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),BL=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function d(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(l,d)}c((s=s.apply(e,t||[])).next())})},$L=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,a,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(c){return function(u){return d([c,u])}}function d(c){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(r=0)),r;)try{if(s=1,a&&(i=c[0]&2?a.return:c[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,c[1])).done)return i;switch(a=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,a=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(u){c=[6,u],a=0}finally{s=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},BYe=function(){function e(t,r,s,a){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=s,r&&LL.isSupported()?(this.primaryDecoder=new LL(t,s,a),this.secondaryDecoder=new DL(t,s,a)):this.primaryDecoder=new DL(t,s,a)}return e.prototype.decodeAsync=function(t){return BL(this,void 0,void 0,function(){var r;return $L(this,function(s){switch(s.label){case 0:r=performance.now(),s.label=1;case 1:return s.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(t)];case 2:return[2,s.sent()];case 3:return this.possiblyLogPerformance(r),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(t){return BL(this,void 0,void 0,function(){var r,s;return $L(this,function(a){switch(a.label){case 0:r=performance.now(),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(t)];case 2:return[2,a.sent()];case 3:if(s=a.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(t)];throw s;case 4:return this.possiblyLogPerformance(r),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(t){if(this.verbose){var r=performance.now()-t;this.executionResults.push(r),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var t=0,r=0,s=this.executionResults;r<s.length;r++){var a=s[r];t+=a}var i=t/this.executionResults.length;console.log("".concat(i," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e}(),sT=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(s[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function s(){this.constructor=t}t.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}(),I2=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function d(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(l,d)}c((s=s.apply(e,t||[])).next())})},D2=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,a,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(c){return function(u){return d([c,u])}}function d(c){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(r=0)),r;)try{if(s=1,a&&(i=c[0]&2?a.return:c[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,c[1])).done)return i;switch(a=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,a=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(u){c=[6,u],a=0}finally{s=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},GJ=function(){function e(t,r){this.name=t,this.track=r}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(t){var r={};r[this.name]=t;var s={advanced:[r]};return this.track.applyConstraints(s)},e.prototype.value=function(){var t=this.track.getSettings();if(this.name in t){var r=t[this.name];return r}return null},e}(),$Ye=function(e){sT(t,e);function t(r,s){return e.call(this,r,s)||this}return t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(r){var s={};s[this.name]=r;var a={advanced:[s]};return this.track.applyConstraints(a)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var r=this.track.getCapabilities(),s=r[this.name];return{min:s.min,max:s.max,step:s.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(GJ),FYe=function(e){sT(t,e);function t(r){return e.call(this,"zoom",r)||this}return t}($Ye),zYe=function(e){sT(t,e);function t(r){return e.call(this,"torch",r)||this}return t}(GJ),UYe=function(){function e(t){this.track=t}return e.prototype.zoomFeature=function(){return new FYe(this.track)},e.prototype.torchFeature=function(){return new zYe(this.track)},e}(),VYe=function(){function e(t,r,s){this.isClosed=!1,this.parentElement=t,this.mediaStream=r,this.callbacks=s,this.surface=this.createVideoElement(this.parentElement.clientWidth),t.append(this.surface)}return e.prototype.createVideoElement=function(t){var r=document.createElement("video");return r.style.width="".concat(t,"px"),r.style.display="block",r.muted=!0,r.setAttribute("muted","true"),r.playsInline=!0,r},e.prototype.setupSurface=function(){var t=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var r=function(){var s=t.surface.clientWidth,a=t.surface.clientHeight;t.callbacks.onRenderSurfaceReady(s,a),t.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(t,r,s,a){return I2(this,void 0,void 0,function(){var i,o;return D2(this,function(l){switch(l.label){case 0:return i=new e(t,r,a),s.aspectRatio?(o={aspectRatio:s.aspectRatio},[4,i.getFirstTrackOrFail().applyConstraints(o)]):[3,2];case 1:l.sent(),l.label=2;case 2:return i.setupSurface(),[2,i]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(t){this.failIfClosed();var r=this,s=function(){setTimeout(t,200),r.surface.removeEventListener("playing",s)};this.surface.addEventListener("playing",s),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(t){return I2(this,void 0,void 0,function(){return D2(this,function(r){if("aspectRatio"in t)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(t)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var t=this;return new Promise(function(r,s){var a=t.mediaStream.getVideoTracks(),i=a.length,o=0;t.mediaStream.getVideoTracks().forEach(function(l){t.mediaStream.removeTrack(l),l.stop(),++o,o>=i&&(t.isClosed=!0,t.parentElement.removeChild(t.surface),r())})})},e.prototype.getCapabilities=function(){return new UYe(this.getFirstTrackOrFail())},e}(),qYe=function(){function e(t){this.mediaStream=t}return e.prototype.render=function(t,r,s){return I2(this,void 0,void 0,function(){return D2(this,function(a){return[2,VYe.create(t,this.mediaStream,r,s)]})})},e.create=function(t){return I2(this,void 0,void 0,function(){var r,s;return D2(this,function(a){switch(a.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return r={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(r)];case 1:return s=a.sent(),[2,new e(s)]}})})},e}(),FL=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function d(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(l,d)}c((s=s.apply(e,t||[])).next())})},zL=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,a,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(c){return function(u){return d([c,u])}}function d(c){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(r=0)),r;)try{if(s=1,a&&(i=c[0]&2?a.return:c[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,c[1])).done)return i;switch(a=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,a=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(u){c=[6,u],a=0}finally{s=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},WYe=function(){function e(){}return e.failIfNotSupported=function(){return FL(this,void 0,void 0,function(){return zL(this,function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(t){return FL(this,void 0,void 0,function(){return zL(this,function(r){return[2,qYe.create(t)]})})},e}(),HYe=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function l(u){try{c(s.next(u))}catch(h){o(h)}}function d(u){try{c(s.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):a(u.value).then(l,d)}c((s=s.apply(e,t||[])).next())})},GYe=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,a,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(c){return function(u){return d([c,u])}}function d(c){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(r=0)),r;)try{if(s=1,a&&(i=c[0]&2?a.return:c[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,c[1])).done)return i;switch(a=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,a=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=t.call(e,r)}catch(u){c=[6,u],a=0}finally{s=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}},KYe=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var t=Em.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(t=Em.insecureContextCameraQueryError()),Promise.reject(t)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var t=location.host.split(":")[0];return t==="127.0.0.1"||t==="localhost"},e.getCamerasFromMediaDevices=function(){return HYe(this,void 0,void 0,function(){var t,r,s,a,i,o,l;return GYe(this,function(d){switch(d.label){case 0:return t=function(c){for(var u=c.getVideoTracks(),h=0,f=u;h<f.length;h++){var m=f[h];m.enabled=!1,m.stop(),c.removeTrack(m)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return r=d.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(s=d.sent(),a=[],i=0,o=s;i<o.length;i++)l=o[i],l.kind==="videoinput"&&a.push({id:l.deviceId,label:l.label});return t(r),[2,a]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(t,r){var s=function(i){for(var o=[],l=0,d=i;l<d.length;l++){var c=d[l];c.kind==="video"&&o.push({id:c.id,label:c.label})}t(o)},a=MediaStreamTrack;a.getSources(s)})},e}(),Ms;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(Ms||(Ms={}));var XYe=function(){function e(){this.state=Ms.NOT_STARTED,this.onGoingTransactionNewState=Ms.UNKNOWN}return e.prototype.directTransition=function(t){this.failIfTransitionOngoing(),this.validateTransition(t),this.state=t},e.prototype.startTransition=function(t){return this.failIfTransitionOngoing(),this.validateTransition(t),this.onGoingTransactionNewState=t,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===Ms.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var t=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Ms.UNKNOWN,this.directTransition(t)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===Ms.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Ms.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Ms.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(t){switch(this.state){case Ms.UNKNOWN:throw"Transition from unknown is not allowed";case Ms.NOT_STARTED:this.failIfNewStateIs(t,[Ms.PAUSED]);break;case Ms.SCANNING:break;case Ms.PAUSED:break}},e.prototype.failIfNewStateIs=function(t,r){for(var s=0,a=r;s<a.length;s++){var i=a[s];if(t===i)throw"Cannot transition from ".concat(this.state," to ").concat(t)}},e}(),YYe=function(){function e(t){this.stateManager=t}return e.prototype.startTransition=function(t){return this.stateManager.startTransition(t)},e.prototype.directTransition=function(t){this.stateManager.directTransition(t)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===Ms.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==Ms.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Ms.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===Ms.PAUSED},e}(),ZYe=function(){function e(){}return e.create=function(){return new YYe(new XYe)},e}(),QYe=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(s[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function s(){this.constructor=t}t.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}(),Ji=function(e){QYe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t}(PYe),JYe=function(){function e(t,r){this.logger=r,this.fps=Ji.SCAN_DEFAULT_FPS,t?(t.fps&&(this.fps=t.fps),this.disableFlip=t.disableFlip===!0,this.qrbox=t.qrbox,this.aspectRatio=t.aspectRatio,this.videoConstraints=t.videoConstraints):this.disableFlip=Ji.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?HJ.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!Mc(this.qrbox)},e.create=function(t,r){return new e(t,r)},e}(),KJ=function(){function e(t,r){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.elementId=t,this.verbose=!1;var s;typeof r=="boolean"?this.verbose=r===!0:r&&(s=r,this.verbose=s.verbose===!0,s.experimentalFeatures),this.logger=new RYe(this.verbose),this.qrcode=new BYe(this.getSupportedFormats(r),this.getUseBarCodeDetectorIfSupported(s),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=ZYe.create()}return e.prototype.start=function(t,r,s,a){var i=this;if(!t)throw"cameraIdOrConfig is required";if(!s||typeof s!="function")throw"qrCodeSuccessCallback is required and should be a function.";var o;a?o=a:o=this.verbose?this.logger.log:function(){};var l=JYe.create(r,this.logger);this.clearElement();var d=!1;l.videoConstraints&&(l.isMediaStreamConstraintsValid()?d=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var c=d,u=document.getElementById(this.elementId);u.clientWidth?u.clientWidth:Ji.DEFAULT_WIDTH,u.style.position="relative",this.shouldScan=!0,this.element=u;var h=this,f=this.stateManagerProxy.startTransition(Ms.SCANNING);return new Promise(function(m,p){var g=c?l.videoConstraints:h.createVideoConstraints(t);if(!g){f.cancel(),p("videoConstraints should be defined");return}var x={};(!c||l.aspectRatio)&&(x.aspectRatio=l.aspectRatio);var v={onRenderSurfaceReady:function(y,b){h.setupUi(y,b,l),h.isScanning=!0,h.foreverScan(l,s,o)}};WYe.failIfNotSupported().then(function(y){y.create(g).then(function(b){return b.render(i.element,x,v).then(function(j){h.renderedCamera=j,f.execute(),m(null)}).catch(function(j){f.cancel(),p(j)})}).catch(function(b){f.cancel(),p(Em.errorGettingUserMedia(b))})}).catch(function(y){f.cancel(),p(Em.cameraStreamingNotSupported())})})},e.prototype.pause=function(t){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Ms.PAUSED),this.showPausedState(),(Mc(t)||t!==!0)&&(t=!1),t&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var t=this,r=function(){t.stateManagerProxy.directTransition(Ms.SCANNING),t.hidePausedState()};if(!this.renderedCamera.isPaused()){r();return}this.renderedCamera.resume(function(){r()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var t=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var r=this.stateManagerProxy.startTransition(Ms.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var s=function(){if(t.element){var i=document.getElementById(Ji.SHADED_REGION_ELEMENT_ID);i&&t.element.removeChild(i)}},a=this;return this.renderedCamera.close().then(function(){return a.renderedCamera=null,a.element&&(a.element.removeChild(a.canvasElement),a.canvasElement=null),s(),a.qrRegion&&(a.qrRegion=null),a.context&&(a.context=null),r.execute(),a.hidePausedState(),a.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(t,r){return this.scanFileV2(t,r).then(function(s){return s.decodedText})},e.prototype.scanFileV2=function(t,r){var s=this;if(!t||!(t instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Mc(r)&&(r=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(a,i){s.possiblyCloseLastScanImageFile(),s.clearElement(),s.lastScanImageFile=URL.createObjectURL(t);var o=new Image;o.onload=function(){var l=o.width,d=o.height,c=document.getElementById(s.elementId),u=c.clientWidth?c.clientWidth:Ji.DEFAULT_WIDTH,h=Math.max(c.clientHeight?c.clientHeight:d,Ji.FILE_SCAN_MIN_HEIGHT),f=s.computeCanvasDrawConfig(l,d,u,h);if(r){var m=s.createCanvasElement(u,h,"qr-canvas-visible");m.style.display="inline-block",c.appendChild(m);var p=m.getContext("2d");if(!p)throw"Unable to get 2d context from canvas";p.canvas.width=u,p.canvas.height=h,p.drawImage(o,0,0,l,d,f.x,f.y,f.width,f.height)}var g=Ji.FILE_SCAN_HIDDEN_CANVAS_PADDING,x=Math.max(o.width,f.width),v=Math.max(o.height,f.height),y=x+2*g,b=v+2*g,j=s.createCanvasElement(y,b);c.appendChild(j);var T=j.getContext("2d");if(!T)throw"Unable to get 2d context from canvas";T.canvas.width=y,T.canvas.height=b,T.drawImage(o,0,0,l,d,g,g,x,v);try{s.qrcode.decodeRobustlyAsync(j).then(function(O){a(IL.createFromQrcodeResult(O))}).catch(i)}catch(O){i("QR code parse error, error = ".concat(O))}},o.onerror=i,o.onabort=i,o.onstalled=i,o.onsuspend=i,o.src=URL.createObjectURL(t)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return KYe.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(t){if(t){if(!HJ.isMediaStreamConstraintsValid(t,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(t)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(t){var r=[or.QR_CODE,or.AZTEC,or.CODABAR,or.CODE_39,or.CODE_93,or.CODE_128,or.DATA_MATRIX,or.MAXICODE,or.ITF,or.EAN_13,or.EAN_8,or.PDF_417,or.RSS_14,or.RSS_EXPANDED,or.UPC_A,or.UPC_E,or.UPC_EAN_EXTENSION];if(!t||typeof t=="boolean"||!t.formatsToSupport)return r;if(!Array.isArray(t.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(t.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var s=[],a=0,i=t.formatsToSupport;a<i.length;a++){var o=i[a];TYe(o)?s.push(o):this.logger.warn("Invalid format: ".concat(o," passed in config, ignoring."))}if(s.length===0)throw"None of formatsToSupport match supported values.";return s},e.prototype.getUseBarCodeDetectorIfSupported=function(t){if(Mc(t))return!0;if(!Mc(t.useBarCodeDetectorIfSupported))return t.useBarCodeDetectorIfSupported!==!1;if(Mc(t.experimentalFeatures))return!0;var r=t.experimentalFeatures;return Mc(r.useBarCodeDetectorIfSupported)?!0:r.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(t,r,s){var a=this,i=s.qrbox;this.validateQrboxConfig(i);var o=this.toQrdimensions(t,r,i),l=function(c){if(c<Ji.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Ji.MIN_QR_BOX_SIZE,"px.")},d=function(c){return c>t&&(a.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),c=t),c};l(o.width),l(o.height),o.width=d(o.width)},e.prototype.validateQrboxConfig=function(t){if(typeof t!="number"&&typeof t!="function"&&(t.width===void 0||t.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(t,r,s){if(typeof s=="number")return{width:s,height:s};if(typeof s=="function")try{return s(t,r)}catch(a){throw new Error("qrbox config was passed as a function but it failed with unknown error"+a)}return s},e.prototype.setupUi=function(t,r,s){s.isShadedBoxEnabled()&&this.validateQrboxSize(t,r,s);var a=Mc(s.qrbox)?{width:t,height:r}:s.qrbox;this.validateQrboxConfig(a);var i=this.toQrdimensions(t,r,a);i.height>r&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var o=s.isShadedBoxEnabled()&&i.height<=r,l={x:0,y:0,width:t,height:r},d=o?this.getShadedRegionBounds(t,r,i):l,c=this.createCanvasElement(d.width,d.height),u={willReadFrequently:!0},h=c.getContext("2d",u);h.canvas.width=d.width,h.canvas.height=d.height,this.element.append(c),o&&this.possiblyInsertShadingElement(this.element,t,r,i),this.createScannerPausedUiElement(this.element),this.qrRegion=d,this.context=h,this.canvasElement=c},e.prototype.createScannerPausedUiElement=function(t){var r=document.createElement("div");r.innerText=Em.scannerPaused(),r.style.display="none",r.style.position="absolute",r.style.top="0px",r.style.zIndex="1",r.style.background="rgba(9, 9, 9, 0.46)",r.style.color="#FFECEC",r.style.textAlign="center",r.style.width="100%",t.appendChild(r),this.scannerPausedUiElement=r},e.prototype.scanContext=function(t,r){var s=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(a){return t(a.text,IL.createFromQrcodeResult(a)),s.possiblyUpdateShaders(!0),!0}).catch(function(a){s.possiblyUpdateShaders(!1);var i=Em.codeParseError(a);return r(i,OYe.createFrom(i)),!1})},e.prototype.foreverScan=function(t,r,s){var a=this;if(this.shouldScan&&this.renderedCamera){var i=this.renderedCamera.getSurface(),o=i.videoWidth/i.clientWidth,l=i.videoHeight/i.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var d=this.qrRegion.width*o,c=this.qrRegion.height*l,u=this.qrRegion.x*o,h=this.qrRegion.y*l;this.context.drawImage(i,u,h,d,c,0,0,this.qrRegion.width,this.qrRegion.height);var f=function(){a.foreverScanTimeout=setTimeout(function(){a.foreverScan(t,r,s)},a.getTimeoutFps(t.fps))};this.scanContext(r,s).then(function(m){!m&&t.disableFlip!==!0?(a.context.translate(a.context.canvas.width,0),a.context.scale(-1,1),a.scanContext(r,s).finally(function(){f()})):f()}).catch(function(m){a.logger.logError("Error happend while scanning context",m),f()})}},e.prototype.createVideoConstraints=function(t){if(typeof t=="string")return{deviceId:{exact:t}};if(typeof t=="object"){var r="facingMode",s="deviceId",a={user:!0,environment:!0},i="exact",o=function(p){if(p in a)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(p,"'")},l=Object.keys(t);if(l.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(l.length," keys");var d=Object.keys(t)[0];if(d!==r&&d!==s)throw"Only '".concat(r,"' and '").concat(s,"' ")+" are supported for 'cameraIdOrConfig'";if(d===r){var c=t.facingMode;if(typeof c=="string"){if(o(c))return{facingMode:c}}else if(typeof c=="object")if(i in c){if(o(c["".concat(i)]))return{facingMode:{exact:c["".concat(i)]}}}else throw"'facingMode' should be string or object with"+" ".concat(i," as key.");else{var u=typeof c;throw"Invalid type of 'facingMode' = ".concat(u)}}else{var h=t.deviceId;if(typeof h=="string")return{deviceId:h};if(typeof h=="object"){if(i in h)return{deviceId:{exact:h["".concat(i)]}};throw"'deviceId' should be string or object with"+" ".concat(i," as key.")}else{var f=typeof h;throw"Invalid type of 'deviceId' = ".concat(f)}}}var m=typeof t;throw"Invalid type of 'cameraIdOrConfig' = ".concat(m)},e.prototype.computeCanvasDrawConfig=function(t,r,s,a){if(t<=s&&r<=a){var i=(s-t)/2,o=(a-r)/2;return{x:i,y:o,width:t,height:r}}else{var l=t,d=r;return t>s&&(r=s/t*r,t=s),r>a&&(t=a/r*t,r=a),this.logger.log("Image downsampled from "+"".concat(l,"X").concat(d)+" to ".concat(t,"X").concat(r,".")),this.computeCanvasDrawConfig(t,r,s,a)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var t=document.getElementById(this.elementId);t&&(t.innerHTML="")},e.prototype.possiblyUpdateShaders=function(t){this.qrMatch!==t&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(r){r.style.backgroundColor=t?Ji.BORDER_SHADER_MATCH_COLOR:Ji.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=t)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(t,r,s){var a=t,i=r,o=document.createElement("canvas");return o.style.width="".concat(a,"px"),o.style.height="".concat(i,"px"),o.style.display="none",o.id=Mc(s)?"qr-canvas":s,o},e.prototype.getShadedRegionBounds=function(t,r,s){if(s.width>t||s.height>r)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(t-s.width)/2,y:(r-s.height)/2,width:s.width,height:s.height}},e.prototype.possiblyInsertShadingElement=function(t,r,s,a){if(!(r-a.width<1||s-a.height<1)){var i=document.createElement("div");i.style.position="absolute";var o=(r-a.width)/2,l=(s-a.height)/2;if(i.style.borderLeft="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderRight="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderTop="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderBottom="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),i.style.boxSizing="border-box",i.style.top="0px",i.style.bottom="0px",i.style.left="0px",i.style.right="0px",i.id="".concat(Ji.SHADED_REGION_ELEMENT_ID),r-a.width<11||s-a.height<11)this.hasBorderShaders=!1;else{var d=5,c=40;this.insertShaderBorders(i,c,d,-d,null,0,!0),this.insertShaderBorders(i,c,d,-d,null,0,!1),this.insertShaderBorders(i,c,d,null,-d,0,!0),this.insertShaderBorders(i,c,d,null,-d,0,!1),this.insertShaderBorders(i,d,c+d,-d,null,-d,!0),this.insertShaderBorders(i,d,c+d,null,-d,-d,!0),this.insertShaderBorders(i,d,c+d,-d,null,-d,!1),this.insertShaderBorders(i,d,c+d,null,-d,-d,!1),this.hasBorderShaders=!0}t.append(i)}},e.prototype.insertShaderBorders=function(t,r,s,a,i,o,l){var d=document.createElement("div");d.style.position="absolute",d.style.backgroundColor=Ji.BORDER_SHADER_DEFAULT_COLOR,d.style.width="".concat(r,"px"),d.style.height="".concat(s,"px"),a!==null&&(d.style.top="".concat(a,"px")),i!==null&&(d.style.bottom="".concat(i,"px")),l?d.style.left="".concat(o,"px"):d.style.right="".concat(o,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(d),t.appendChild(d)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(t){return 1e3/t},e}(),UL;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(UL||(UL={}));function eZe({bags:e,onMarkBagSeparated:t,onMarkItemSeparated:r}){const[s,a]=P.useState(!1),[i,o]=P.useState(!1),[l,d]=P.useState(null),[c,u]=P.useState(null),[h,f]=P.useState([]),m=P.useRef(null),p="qr-scanner-container",g=async()=>{try{const q=new KJ(p);m.current=q,await q.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},y,()=>{}),o(!0)}catch(q){console.error("Error starting scanner:",q),de.error("No foi possvel acessar a cmera")}},x=async()=>{if(m.current&&i)try{await m.current.stop(),m.current=null,o(!1)}catch(q){console.error("Error stopping scanner:",q)}},v=q=>{const Y={...q,id:crypto.randomUUID(),timestamp:new Date};f(G=>[Y,...G].slice(0,50))},y=async q=>{try{let Y=null;const G=q.match(/\/sacola\/([a-f0-9-]+)/i);if(G)Y=G[1];else try{Y=JSON.parse(q).bagId}catch{Y=null}const I=Y?e.find(N=>N.id===Y):null;if(!I){u("not_found"),d(null),v({bagNumber:0,instagram:"QR Invlido",result:"not_found"}),b("error");return}const F={bagId:I.id,bagNumber:I.bagNumber,instagram:I.instagramHandle,items:I.totalItems,total:I.totalValue};if(I.status==="separado"){u("already_done"),d(F),v({bagNumber:I.bagNumber,instagram:I.instagramHandle,result:"already_done",itemsCount:I.totalItems}),b("warning");return}const S=I.items.filter(N=>N.status==="em_separacao");let E=!0;for(const N of S)await r(N.id)||(E=!1);E&&S.length>0?(u("success"),d(F),v({bagNumber:I.bagNumber,instagram:I.instagramHandle,result:"success",itemsCount:S.length}),b("success"),de.success(`Sacola #${I.bagNumber.toString().padStart(3,"0")} marcada como separada!`)):S.length===0&&(u("already_done"),d(F),v({bagNumber:I.bagNumber,instagram:I.instagramHandle,result:"already_done",itemsCount:I.totalItems}),b("warning")),setTimeout(()=>{u(null),d(null)},2e3)}catch(Y){console.error("Invalid QR code data:",Y),u("not_found"),v({bagNumber:0,instagram:"QR Invlido",result:"not_found"}),b("error"),setTimeout(()=>{u(null)},2e3)}},b=q=>{const Y={success:[523.25,659.25,783.99],warning:[440,440],error:[311.13,233.08]};try{const G=new(window.AudioContext||window.webkitAudioContext);Y[q].forEach((F,S)=>{const E=G.createOscillator(),N=G.createGain();E.connect(N),N.connect(G.destination),E.frequency.value=F,E.type="sine",N.gain.setValueAtTime(.3,G.currentTime),N.gain.exponentialRampToValueAtTime(.01,G.currentTime+.3),E.start(G.currentTime+S*.1),E.stop(G.currentTime+.3+S*.1)})}catch{}},j=q=>q.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),T=q=>{switch(q){case"success":return n.jsx(ke,{className:"bg-green-100 text-green-700 border-green-200 text-xs",children:"Separada"});case"already_done":return n.jsx(ke,{className:"bg-amber-100 text-amber-700 border-amber-200 text-xs",children:"J feita"});case"not_found":return n.jsx(ke,{variant:"destructive",className:"text-xs",children:"No encontrada"})}},O=()=>{a(!0),u(null),d(null)},R=async()=>{await x(),a(!1),u(null),d(null)},D=()=>{f([])};P.useEffect(()=>{if(s&&!i){const q=setTimeout(()=>{g()},100);return()=>clearTimeout(q)}},[s]),P.useEffect(()=>()=>{x()},[]);const B={success:h.filter(q=>q.result==="success").length,alreadyDone:h.filter(q=>q.result==="already_done").length,notFound:h.filter(q=>q.result==="not_found").length};return n.jsxs(n.Fragment,{children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:O,className:"gap-2",children:[n.jsx(Nx,{className:"h-4 w-4"}),"Scanner QR"]}),n.jsx(tn,{open:s,onOpenChange:q=>!q&&R(),children:n.jsxs(Jr,{className:"sm:max-w-lg max-h-[90vh] flex flex-col",children:[n.jsxs(ln,{children:[n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(ka,{className:"h-5 w-5"}),"Scanner de Sacolas"]}),n.jsx(Vo,{children:"Aponte a cmera para o QR code da etiqueta da sacola"})]}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{id:p,className:"w-full aspect-square rounded-lg overflow-hidden bg-muted"}),c&&n.jsxs("div",{className:`absolute inset-0 flex flex-col items-center justify-center rounded-lg ${c==="success"?"bg-green-500/90":c==="already_done"?"bg-amber-500/90":"bg-red-500/90"}`,children:[c==="success"&&n.jsxs(n.Fragment,{children:[n.jsx(mn,{className:"h-16 w-16 text-white mb-3"}),n.jsx("p",{className:"text-white font-bold text-xl",children:"Separada!"}),l&&n.jsxs("p",{className:"text-white/90 text-lg",children:["Sacola #",l.bagNumber.toString().padStart(3,"0")]})]}),c==="already_done"&&n.jsxs(n.Fragment,{children:[n.jsx(Vt,{className:"h-16 w-16 text-white mb-3"}),n.jsx("p",{className:"text-white font-bold text-xl",children:"J Separada"}),l&&n.jsxs("p",{className:"text-white/90 text-lg",children:["Sacola #",l.bagNumber.toString().padStart(3,"0")]})]}),c==="not_found"&&n.jsxs(n.Fragment,{children:[n.jsx(Or,{className:"h-16 w-16 text-white mb-3"}),n.jsx("p",{className:"text-white font-bold text-xl",children:"No Encontrada"}),n.jsx("p",{className:"text-white/90 text-sm",children:"QR code no pertence a esta live"})]})]})]}),n.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("span",{className:"text-green-600 font-medium",children:[" ",B.success]}),n.jsxs("span",{className:"text-amber-600 font-medium",children:[" ",B.alreadyDone]}),n.jsxs("span",{className:"text-red-600 font-medium",children:[" ",B.notFound]})]}),n.jsxs("div",{className:"text-muted-foreground",children:["Pendentes: ",e.filter(q=>q.status!=="separado"&&q.status!=="cancelado").length]})]}),h.length>0&&n.jsxs("div",{className:"border-t pt-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(Gb,{className:"h-4 w-4"}),"Histrico de Leituras"]}),n.jsx(he,{variant:"ghost",size:"sm",onClick:D,className:"h-7 text-xs text-muted-foreground",children:"Limpar"})]}),n.jsx(gi,{className:"h-[150px]",children:n.jsx("div",{className:"space-y-2 pr-3",children:h.map(q=>n.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg text-sm ${q.result==="success"?"bg-green-50 border border-green-100":q.result==="already_done"?"bg-amber-50 border border-amber-100":"bg-red-50 border border-red-100"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"font-bold text-base",children:["#",q.bagNumber.toString().padStart(3,"0")]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-primary",children:q.instagram}),q.itemsCount!==void 0&&n.jsxs("div",{className:"text-xs text-muted-foreground",children:[q.itemsCount," ",q.itemsCount===1?"item":"itens"]})]})]}),n.jsxs("div",{className:"flex flex-col items-end gap-1",children:[T(q.result),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[n.jsx(Lr,{className:"h-3 w-3"}),j(q.timestamp)]})]})]},q.id))})})]}),n.jsxs(he,{variant:"outline",onClick:R,className:"w-full gap-2",children:[n.jsx(sn,{className:"h-4 w-4"}),"Fechar Scanner"]})]})})]})}function tZe({eventId:e,eventTitle:t="Live"}){const[r,s]=P.useState("by_bag"),[a,i]=P.useState("all"),[o,l]=P.useState("bag_number"),[d,c]=P.useState(""),{bags:u,productGroups:h,kpis:f,isLoading:m,isGeneratingBags:p,generateBagNumbers:g,markItemSeparated:x,markItemCancelled:v,confirmItemRemoved:y,markBagSeparated:b,markAllProductItemsSeparated:j,markLabelPrinted:T,markLabelsAsPrinted:O,filterBags:R,filterProductGroups:D,fetchSeparationData:B,resolveReallocation:q}=MXe(e),Y=R(a,o,d),G=D(d);if(m)return n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Qr,{className:"h-8 w-8 animate-spin text-muted-foreground"})});const I=u.length===0;return n.jsxs("div",{className:"space-y-6",children:[n.jsx(IXe,{kpis:f}),I&&n.jsx($e,{className:"border-dashed",children:n.jsxs(Fe,{className:"flex flex-col items-center justify-center py-12 gap-4",children:[n.jsx(Vt,{className:"h-16 w-16 text-muted-foreground"}),n.jsxs("div",{className:"text-center",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Iniciar Separao"}),n.jsx("p",{className:"text-sm text-muted-foreground max-w-md mx-auto mt-1",children:"Clique para gerar sacolas numeradas para todos os pedidos da live. Cada pedido receber um nmero sequencial nico."})]}),n.jsx(he,{size:"lg",onClick:g,disabled:p,className:"gap-2",children:p?n.jsxs(n.Fragment,{children:[n.jsx(Qr,{className:"h-4 w-4 animate-spin"}),"Gerando sacolas..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Xne,{className:"h-4 w-4"}),"Iniciar Separao"]})})]})}),!I&&n.jsx(n.Fragment,{children:n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs(Hi,{value:r,onValueChange:F=>s(F),children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs(Si,{className:"grid w-full sm:w-auto grid-cols-2",children:[n.jsxs(br,{value:"by_bag",className:"gap-2",children:[n.jsx(hn,{className:"h-4 w-4"}),"Por Sacola"]}),n.jsxs(br,{value:"by_product",className:"gap-2",children:[n.jsx(Hne,{className:"h-4 w-4"}),"Por Produto"]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[r==="by_bag"&&u.length>0&&n.jsx(eZe,{bags:u,onMarkBagSeparated:b,onMarkItemSeparated:x}),r==="by_bag"&&Y.length>0&&n.jsx(SYe,{bags:Y,eventTitle:t,onLabelsAsPrinted:O}),n.jsxs(he,{variant:"outline",size:"sm",onClick:g,disabled:p,className:"gap-2",children:[p?n.jsx(Qr,{className:"h-4 w-4 animate-spin"}):n.jsx(Qr,{className:"h-4 w-4"}),"Re-sincronizar"]})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-4",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por @, nmero, produto...",value:d,onChange:F=>c(F.target.value),className:"pl-9"})]}),r==="by_bag"&&n.jsxs(n.Fragment,{children:[n.jsxs(Xt,{value:a,onValueChange:F=>i(F),children:[n.jsxs(Ht,{className:"w-full sm:w-[160px]",children:[n.jsx(Ru,{className:"h-4 w-4 mr-2"}),n.jsx(Yt,{placeholder:"Filtrar"})]}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todos"}),n.jsx(qe,{value:"pending",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Qr,{className:"h-3 w-3"})," Pendentes"]})}),n.jsx(qe,{value:"separated",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(mn,{className:"h-3 w-3"})," Separados"]})}),n.jsx(qe,{value:"attention",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Or,{className:"h-3 w-3"})," Ateno"]})}),n.jsx(qe,{value:"cancelled",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Kn,{className:"h-3 w-3"})," Cancelados"]})})]})]}),n.jsxs(Xt,{value:o,onValueChange:F=>l(F),children:[n.jsxs(Ht,{className:"w-full sm:w-[160px]",children:[n.jsx(KF,{className:"h-4 w-4 mr-2"}),n.jsx(Yt,{placeholder:"Ordenar"})]}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"bag_number",children:"N Sacola"}),n.jsx(qe,{value:"instagram",children:"@Instagram"}),n.jsx(qe,{value:"status",children:"Status"})]})]})]})]}),n.jsx(kr,{value:"by_bag",className:"mt-4",children:n.jsx(kYe,{bags:Y,eventTitle:t,onMarkItemSeparated:x,onMarkItemCancelled:v,onConfirmItemRemoved:y,onMarkBagSeparated:b,onLabelPrinted:T,onResolveReallocation:q})}),n.jsx(kr,{value:"by_product",className:"mt-4",children:n.jsx(AYe,{productGroups:G,onMarkItemSeparated:x,onMarkAllSeparated:j})})]})})})]})}function rZe(){const e=pr(),{eventId:t}=ta(),[r,s]=P.useState(!0),[a,i]=P.useState("");return P.useEffect(()=>{(async()=>{const{data:{session:l}}=await le.auth.getSession();if(!l){e("/login");return}const{data:d}=await le.from("user_roles").select("role").eq("user_id",l.user.id);if(!(d==null?void 0:d.some(u=>["merchant","admin"].includes(u.role)))){e("/");return}if(t){const{data:u}=await le.from("live_events").select("titulo").eq("id",t).single();u&&i(u.titulo)}s(!1)})()},[e,t]),r?n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsx(Vt,{className:"h-8 w-8 animate-pulse text-muted-foreground"})}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:n.jsxs("div",{className:"container flex h-14 items-center gap-4 px-4",children:[n.jsx(he,{variant:"ghost",size:"icon",asChild:!0,children:n.jsx(Ft,{to:`/dashboard/lives/${t}/backstage`,children:n.jsx(Ts,{className:"h-5 w-5"})})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Vt,{className:"h-5 w-5 text-primary"}),n.jsx("h1",{className:"text-lg font-semibold",children:"Separao (Ps-Live)"})]}),a&&n.jsxs("span",{className:"text-sm text-muted-foreground hidden sm:block",children:[" ",a]})]})}),n.jsx("main",{className:"container px-4 py-6",children:n.jsx(tZe,{eventId:t,eventTitle:a})})]})}function nZe(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function sZe({zipCode:e,onZipCodeChange:t,cartWeight:r=.5,cartDimensions:s={length:30,width:20,height:10},selectedQuote:a,onQuoteSelect:i,disabled:o=!1}){const[l,d]=P.useState(e),[c,u]=P.useState(!1),[h,f]=P.useState([]),[m,p]=P.useState(null),[g,x]=P.useState(null),v=b=>{const j=b.replace(/\D/g,"").slice(0,8);d(j),t==null||t(j)},y=async()=>{const b=l.replace(/\D/g,"");if(b.length!==8){p("CEP deve ter 8 dgitos");return}u(!0),p(null),x(null);try{const j={toZipCode:b,weight:r,length:s.length,width:s.width,height:s.height};console.log("[ShippingCalculator] Calculating shipping:",j);const{data:T,error:O}=await le.functions.invoke("calculate-shipping",{body:j});if(console.log("[ShippingCalculator] Response:",T),O){console.error("[ShippingCalculator] Function error:",O),p("Erro ao calcular frete"),x(O.message||"Erro na comunicao com o servidor");return}if(T!=null&&T.error){p(T.error),x(T.details||null),T.quotes&&f(T.quotes);return}if(T!=null&&T.quotes&&T.quotes.length>0)if(f(T.quotes),!a)i(T.quotes[0]),de.success("Frete calculado! Selecione uma opo.");else{const R=T.quotes.find(D=>D.id===a.id);i(R||T.quotes[0]),de.success("Frete atualizado!")}else f([]),p("Nenhuma opo de frete disponvel"),x("Verifique se o CEP est correto ou tente outro CEP")}catch(j){console.error("[ShippingCalculator] Exception:",j),p("Erro de conexo"),x((j==null?void 0:j.message)||"Verifique sua conexo e tente novamente")}finally{u(!1)}};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{className:"flex items-center gap-2",children:[n.jsx(mo,{className:"h-4 w-4"}),"CEP de destino"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(et,{value:l,onChange:b=>v(b.target.value),placeholder:"00000-000",maxLength:9,disabled:o||c,className:"flex-1"}),n.jsx(he,{variant:"secondary",onClick:y,disabled:o||c||l.length<8,children:c?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}),"Calculando..."]}):h.length>0?n.jsxs(n.Fragment,{children:[n.jsx(Qr,{className:"h-4 w-4 mr-2"}),"Recalcular"]}):"Calcular frete"})]})]}),m&&n.jsx($e,{className:"border-destructive/50 bg-destructive/5",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Or,{className:"h-5 w-5 text-destructive mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-destructive",children:m}),g&&n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g}),n.jsxs(he,{variant:"outline",size:"sm",className:"mt-3",onClick:y,disabled:c,children:[n.jsx(Qr,{className:"h-4 w-4 mr-2"}),"Tentar novamente"]})]})]})})}),h.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{className:"flex items-center gap-2",children:[n.jsx(yn,{className:"h-4 w-4"}),"Escolha o servio"]}),n.jsx(gc,{value:(a==null?void 0:a.id)||"",onValueChange:b=>{const j=h.find(T=>T.id===b);j&&i(j)},children:h.map(b=>n.jsxs("label",{className:`flex items-center justify-between p-4 rounded-lg border cursor-pointer hover:bg-muted/50 transition-colors ${(a==null?void 0:a.id)===b.id?"border-primary bg-primary/5":"border-border"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Li,{value:b.id}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:b.name||b.serviceName}),n.jsx("p",{className:"text-sm text-muted-foreground",children:b.deliveryRange?`${b.deliveryRange.min}-${b.deliveryRange.max} dias teis`:`${b.deliveryDays||b.deliveryTime} dias teis`})]})]}),n.jsx("span",{className:"font-semibold",children:nZe(b.price)})]},b.id))})]})]})}function aZe(){const{cartId:e}=ta(),t=pr(),r=new URLSearchParams(window.location.search).get("token"),{user:s,isLoading:a}=qn();P.useEffect(()=>{if(!a&&!s){const Ie=encodeURIComponent(window.location.pathname+window.location.search);t(`/entrar?redirect=${Ie}`)}},[s,a,t]),P.useEffect(()=>{s&&le.from("profiles").select("*").eq("user_id",s.id).single().then(({data:Ie})=>{Ie&&(Ie.name&&p(Ie.name),Ie.whatsapp&&v.setDisplayValue(Ie.whatsapp))})},[s]);const[i,o]=P.useState(null),[l,d]=P.useState(!0),[c,u]=P.useState(null),[h,f]=P.useState("cart"),[m,p]=P.useState(""),[g,x]=P.useState(""),v=vk(""),[y,b]=P.useState(""),[j,T]=P.useState(""),[O,R]=P.useState(""),[D,B]=P.useState(""),[q,Y]=P.useState(""),[G,I]=P.useState(""),[F,S]=P.useState(""),[E,N]=P.useState(""),[C,k]=P.useState(""),{isLoading:M,lookup:U}=r8(),[$,X]=P.useState("motoboy"),[Z,re]=P.useState(null),[W,J]=P.useState(!1),[V,H]=P.useState("qualquer"),[ee,ie]=P.useState(""),[oe,se]=P.useState(!1),[ue,pe]=P.useState(!1);m.trim()&&v.isValid;const ce=P.useCallback(async()=>{if(!e||!r){u("Link invlido - token ausente"),d(!1);return}try{const{data:Ie,error:Ae}=await le.rpc("get_live_checkout",{p_cart_id:e,p_token:r});if(Ae){console.error("RPC error:",Ae),u("Erro ao carregar sacola"),d(!1);return}const st=Ie;if(st!=null&&st.error){u(st.error),d(!1);return}if(st.status==="pago"){de.success("Pagamento confirmado!"),t(`/pedido/sucesso?live_cart_id=${e}`);return}if(o(st),st.customer_name&&p(st.customer_name),st.known_phone?v.setDisplayValue(st.known_phone):st.customer_whatsapp&&v.setDisplayValue(st.customer_whatsapp),st.known_email?x(st.known_email):s!=null&&s.email&&x(s.email),st.shipping_address_snapshot){const nt=st.shipping_address_snapshot;nt.street&&R(nt.street),nt.number&&B(nt.number),nt.complement&&Y(nt.complement),nt.neighborhood&&I(nt.neighborhood),nt.city&&S(nt.city),nt.state&&N(nt.state),nt.zip_code&&T(nt.zip_code),nt.reference&&k(nt.reference),nt.document&&b(nt.document)}}catch(Ie){console.error("Error loading cart:",Ie),u("Erro ao carregar carrinho")}finally{d(!1)}},[e,r]);P.useEffect(()=>{ce()},[ce]),P.useEffect(()=>{let Ie;return(i==null?void 0:i.status)==="aguardando_pagamento"&&(Ie=setInterval(()=>{ce()},5e3)),()=>clearInterval(Ie)},[i==null?void 0:i.status,ce]);const ne=async()=>{const Ie=j.replace(/\D/g,"");if(Ie.length!==8){de.error("CEP invlido");return}const Ae=await U(Ie);Ae&&(R(Ae.street),I(Ae.neighborhood),S(Ae.city),N(Ae.state))},me=async()=>{if(!m.trim()){de.error("Preencha seu nome");return}if(!v.isValid){de.error("WhatsApp invlido");return}f("delivery")},ge=()=>$==="motoboy"?Xs.motoboyFee:$==="pickup"?0:$==="shipping"&&Z?Z.price:0,_e=()=>((i==null?void 0:i.subtotal)||0)+ge(),be=()=>(y||"").replace(/\D/g,"").length===11,ye=()=>$==="pickup"?!0:$==="motoboy"?eG(W,V):$==="shipping"?!!Z&&be():!1,Oe=async()=>{if(!ye()){$==="motoboy"&&!W&&de.error("Confirme seu endereo de entrega"),$==="shipping"&&!Z&&de.error("Selecione uma opo de frete"),$==="shipping"&&!be()&&de.error("CPF obrigatrio para Correios");return}const Ie=ge(),st=[O,D,q,G].filter(Boolean).join(", "),nt=y.replace(/\D/g,""),vt={name:m,street:O,number:D,complement:q,neighborhood:G,city:F,state:E,zip_code:j,reference:C,document:nt,full_address:`${st}, ${F} - ${E}, CEP ${j}`},Je=$==="pickup"?"retirada":$==="shipping"?"correios":"motoboy";pe(!0);try{const{data:Ue,error:Le}=await le.rpc("save_live_checkout_details",{p_cart_id:e,p_token:r,p_name:m.trim(),p_phone:v.getNormalizedValue(),p_delivery_method:Je,p_delivery_period:$==="motoboy"?V:null,p_delivery_notes:(ee==null?void 0:ee.trim())||null,p_address_snapshot:vt,p_shipping_fee:Ie,p_shipping_service_name:$==="shipping"&&Z?Z.name||Z.serviceName:null,p_shipping_deadline_days:$==="shipping"&&Z&&(Z.deliveryDays||Z.deliveryTime)||null,p_customer_notes:(ee==null?void 0:ee.trim())||null,p_user_id:(s==null?void 0:s.id)||null});if(Le)throw Le;const Ze=Ue;if(Ze!=null&&Ze.error){de.error(Ze.error);return}o(ct=>ct?{...ct,frete:Ie,total:Ze.total||_e(),delivery_method:Je}:null),f("payment")}catch(Ue){console.error("Error saving checkout details:",Ue),de.error((Ue==null?void 0:Ue.message)||"Erro ao salvar dados")}finally{pe(!1)}},Ne=async()=>{if(e){console.log("[Checkout] Iniciando pagamento...",{cartId:e,deliveryFee:ge(),payer:{email:g,nome:m,cpf:y.replace(/\D/g,"")}}),se(!0);try{console.log("[Checkout] Invocando create-live-cart-payment...");const{data:Ie,error:Ae}=await le.functions.invoke("create-live-cart-payment",{body:{live_cart_id:e,public_token:r,shipping_fee:ge(),payer_email:g.trim()||void 0,payer_name:m.trim()||void 0,payer_phone:v.getNormalizedValue()||void 0,payer_cpf:y.replace(/\D/g,"")||void 0,customer_notes:(ee==null?void 0:ee.trim())||null}});if(console.log("[Checkout] Retorno da Edge Function:",{data:Ie,error:Ae}),Ae){console.error("[Checkout] Erro na chamada RPC:",Ae);let nt="Erro de conexo com o servidor.";try{typeof Ae=="string"&&(nt=Ae),Ae.message&&(nt=Ae.message),Ae.message==="Failed to fetch"&&(nt="Erro de conexo (CORS/Network). Verifique sua internet.")}catch{}de.error(`${nt} Tente novamente.`);return}if(Ie!=null&&Ie.error||Ie!=null&&Ie.error_code||Ie!=null&&Ie.message&&!(Ie!=null&&Ie.init_point)){console.error("[Checkout] Erro retornado pela API:",Ie),de.error(`Erro no pagamento: ${Ie.message||"Falha desconhecida"}`);return}const st=Ie.init_point||Ie.sandbox_init_point;st?(console.log("[Checkout] URL gerada com sucesso:",st),await le.rpc("set_live_cart_preference",{p_cart_id:e,p_preference_id:Ie.preference_id,p_checkout_url:st,p_total:Ie.calculated_total||void 0}),window.location.href=st):(console.error("[Checkout] Nenhuma URL retornada:",Ie),de.error("O Mercado Pago no retornou o link. Tente novamente."))}catch(Ie){console.error("[Checkout] Exceo crtica:",Ie),de.error(`Erro crtico: ${Ie.message||"Falha inesperada"}`)}finally{se(!1)}}},De=Ie=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Ie);if(l)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[n.jsx(Et,{className:"h-5 w-5 animate-spin"}),n.jsx("span",{children:"Carregando carrinho..."})]})});if(c)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:n.jsx($e,{className:"max-w-md w-full",children:n.jsxs(Fe,{className:"pt-6 text-center",children:[n.jsx(Or,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),n.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Ops!"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:c}),n.jsx(he,{variant:"outline",onClick:()=>t("/"),children:"Voltar para a loja"})]})})});const Ge=((i==null?void 0:i.items)||[]).filter(Ie=>["reservado","confirmado","expirado","pending_separation"].includes(Ie.status)),Qe=[{id:"cart",label:"Carrinho",icon:Ri},{id:"registration",label:"Dados",icon:Dn},{id:"delivery",label:"Entrega",icon:yn},{id:"payment",label:"Pagamento",icon:ms}];return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:n.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-3 flex items-center gap-3",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>t(-1),children:n.jsx(Ts,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-lg font-semibold",children:"Finalizar Pedido"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:i==null?void 0:i.instagram_handle})]})]})}),n.jsx("div",{className:"max-w-2xl mx-auto px-4 py-4",children:n.jsx("div",{className:"flex items-center justify-between",children:Qe.map((Ie,Ae)=>{const st=Ie.id===h,nt=Qe.findIndex(Je=>Je.id===h)>Ae,vt=Ie.icon;return n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:`flex items-center gap-2 ${st?"text-primary":nt?"text-green-600":"text-muted-foreground"}`,children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${st?"bg-primary text-primary-foreground":nt?"bg-green-100 text-green-600":"bg-muted"}`,children:nt?n.jsx(Sr,{className:"h-4 w-4"}):n.jsx(vt,{className:"h-4 w-4"})}),n.jsx("span",{className:"text-xs hidden sm:inline",children:Ie.label})]}),Ae<Qe.length-1&&n.jsx("div",{className:`w-8 sm:w-16 h-0.5 mx-2 ${nt?"bg-green-300":"bg-muted"}`})]},Ie.id)})})}),n.jsxs("main",{className:"max-w-2xl mx-auto p-4 pb-32 space-y-4",children:[h==="cart"&&n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Ri,{className:"h-5 w-5"}),"Seus Itens"]})}),n.jsxs(Fe,{className:"space-y-4",children:[Ge.map(Ie=>n.jsxs("div",{className:`flex gap-3 p-3 border rounded-lg ${Ie.is_gift?"bg-green-50/50 border-green-100":""}`,children:[Ie.product_image?n.jsx("img",{src:Ie.product_image,alt:Ie.product_name,className:"w-16 h-16 object-cover rounded-md"}):Ie.is_gift?n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-md flex items-center justify-center",children:n.jsx(Vt,{className:"h-8 w-8 text-green-600"})}):null,n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("h4",{className:"font-medium truncate text-sm sm:text-base",children:Ie.product_name}),Ie.is_gift&&n.jsx("span",{className:"text-[10px] bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"Brinde"})]}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:[Ie.size&&Ie.size!=="nico"&&n.jsxs("span",{children:["Tam: ",Ie.size]}),Ie.color&&Ie.color!=="nico"&&n.jsxs("span",{children:["  ",Ie.color]})]}),n.jsxs("div",{className:"flex items-center justify-between mt-1",children:[n.jsxs("span",{className:"text-sm",children:["Qtd: ",Ie.quantity]}),n.jsx("span",{className:`font-semibold ${Ie.is_gift?"text-green-600":""}`,children:Ie.is_gift?"Grtis":De(Ie.unit_price*Ie.quantity)})]})]})]},Ie.id)),n.jsx(Ca,{}),n.jsxs("div",{className:"flex items-center justify-between text-lg font-semibold",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:De((i==null?void 0:i.subtotal)||0)})]}),n.jsx(he,{className:"w-full",size:"lg",onClick:()=>f("registration"),children:"Continuar"})]})]}),h==="registration"&&n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(Dn,{className:"h-5 w-5"}),"Seus Dados"]})}),n.jsxs(Fe,{className:"space-y-4",children:[(i==null?void 0:i.known_phone)&&n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-sm text-green-700 flex items-center gap-2",children:[n.jsx(Sr,{className:"h-4 w-4 flex-shrink-0"}),n.jsx("span",{children:"Reconhecemos voc! WhatsApp preenchido automaticamente."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Nome completo *"}),n.jsx(et,{value:m,onChange:Ie=>p(Ie.target.value),placeholder:"Seu nome completo"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"WhatsApp *"}),n.jsx(et,{value:v.displayValue,onChange:Ie=>v.setDisplayValue(Ie.target.value),placeholder:"(62) 99999-9999"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"E-mail"}),n.jsx(et,{type:"email",value:g,onChange:Ie=>x(Ie.target.value),placeholder:"seu@email.com"})]}),n.jsx(Ca,{}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Endereo (necessrio para entrega)"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"CEP"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(et,{value:j,onChange:Ie=>T(Ie.target.value.replace(/\D/g,"").slice(0,8)),placeholder:"00000-000",maxLength:9}),n.jsx(he,{variant:"outline",onClick:ne,disabled:M,children:M?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):"Buscar"})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{className:"col-span-2 space-y-2",children:[n.jsx(Be,{children:"Rua"}),n.jsx(et,{value:O,onChange:Ie=>R(Ie.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Nmero"}),n.jsx(et,{value:D,onChange:Ie=>B(Ie.target.value)})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Complemento"}),n.jsx(et,{value:q,onChange:Ie=>Y(Ie.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Bairro"}),n.jsx(et,{value:G,onChange:Ie=>I(Ie.target.value)})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Cidade"}),n.jsx(et,{value:F,onChange:Ie=>S(Ie.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Estado"}),n.jsx(et,{value:E,onChange:Ie=>N(Ie.target.value),maxLength:2})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"CPF (obrigatrio para Correios)"}),n.jsx(et,{value:y.replace(/\D/g,"").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"),onChange:Ie=>b(Ie.target.value.replace(/\D/g,"").slice(0,11)),placeholder:"000.000.000-00",maxLength:14})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Referncia"}),n.jsx(et,{value:C,onChange:Ie=>k(Ie.target.value),placeholder:"Prximo a..."})]}),n.jsxs("div",{className:"flex gap-2 pt-4",children:[n.jsx(he,{variant:"outline",onClick:()=>f("cart"),children:"Voltar"}),n.jsx(he,{className:"flex-1",onClick:me,disabled:!m.trim()||!v.isValid,children:"Continuar"})]})]})]}),h==="delivery"&&n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(yn,{className:"h-5 w-5"}),"Entrega"]})}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs(gc,{value:$,onValueChange:Ie=>{X(Ie),Ie!=="motoboy"&&J(!1)},children:[n.jsxs("label",{className:`flex items-center gap-3 p-4 border rounded-lg cursor-pointer hover:bg-muted/50 transition-colors ${$==="motoboy"?"border-primary bg-primary/5":""}`,children:[n.jsx(Li,{value:"motoboy"}),n.jsx(Vt,{className:"h-5 w-5 text-muted-foreground"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:"Motoboy (Anpolis)"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:Xs.motoboyDeliveryText})]}),n.jsx("span",{className:"font-semibold",children:De(Xs.motoboyFee)})]}),n.jsxs("label",{className:`flex items-center gap-3 p-4 border rounded-lg cursor-pointer hover:bg-muted/50 transition-colors ${$==="pickup"?"border-primary bg-primary/5":""}`,children:[n.jsx(Li,{value:"pickup"}),n.jsx(fa,{className:"h-5 w-5 text-muted-foreground"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:"Retirar na Loja"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:Xs.storeAddress}),n.jsx("p",{className:"text-xs text-muted-foreground",children:Xs.storeHours})]}),n.jsx("span",{className:"font-semibold text-green-600",children:"Grtis"})]}),n.jsxs("label",{className:`flex items-start gap-3 p-4 border rounded-lg cursor-pointer hover:bg-muted/50 transition-colors ${$==="shipping"?"border-primary bg-primary/5":""}`,children:[n.jsx(Li,{value:"shipping",className:"mt-1"}),n.jsx(mo,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:"Enviar para outra cidade"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Correios (PAC/SEDEX)"})]})]})]}),$==="motoboy"&&n.jsx(JH,{address:{street:O,number:D,complement:q,neighborhood:G,city:F,state:E,zipCode:j,reference:C},onAddressConfirmed:({period:Ie,notes:Ae})=>{J(!0),H(Ie),ie(Ae)},onEditAddress:()=>f("registration"),initialPeriod:V,initialNotes:ee}),$==="pickup"&&n.jsx(tG,{notes:ee,onNotesChange:ie}),$==="shipping"&&n.jsxs(n.Fragment,{children:[n.jsx(sZe,{zipCode:j,onZipCodeChange:T,cartWeight:.5,cartDimensions:{length:30,width:20,height:15},selectedQuote:Z,onQuoteSelect:re}),n.jsxs("div",{className:"space-y-2 pt-2",children:[n.jsxs(Be,{htmlFor:"cpf-shipping",className:"flex items-center gap-1",children:["CPF do destinatrio ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx(et,{id:"cpf-shipping",value:y?y.replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"):"",onChange:Ie=>b(Ie.target.value.replace(/\D/g,"").slice(0,11)),placeholder:"000.000.000-00",maxLength:14,className:be()?"":"border-red-500"}),!be()&&n.jsxs("p",{className:"text-xs text-red-600 flex items-center gap-1",children:[n.jsx(Or,{className:"h-3 w-3"}),"CPF obrigatrio para gerar etiqueta dos Correios (11 dgitos)"]})]})]}),n.jsx(Ca,{}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Subtotal"}),n.jsx("span",{children:De((i==null?void 0:i.subtotal)||0)})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Entrega"}),n.jsx("span",{children:ge()===0?n.jsx("span",{className:"text-green-600",children:"Grtis"}):De(ge())})]}),n.jsxs("div",{className:"flex justify-between text-lg font-semibold pt-2 border-t",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:De(_e())})]})]}),n.jsxs("div",{className:"flex gap-2 pt-4",children:[n.jsx(he,{variant:"outline",onClick:()=>f("registration"),children:"Voltar"}),n.jsxs(he,{className:"flex-1",onClick:Oe,disabled:ue||!ye(),children:[ue?n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}):null,"Continuar para Pagamento"]})]})]})]}),h==="payment"&&n.jsxs($e,{children:[n.jsx(Dt,{children:n.jsxs(Lt,{className:"flex items-center gap-2",children:[n.jsx(ms,{className:"h-5 w-5"}),"Pagamento"]})}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[n.jsx("h4",{className:"font-medium",children:"Resumo do Pedido"}),n.jsxs("div",{className:"text-sm space-y-1",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{children:[Ge.length," ",Ge.length===1?"item":"itens"]}),n.jsx("span",{children:De((i==null?void 0:i.subtotal)||0)})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Entrega"}),n.jsx("span",{children:De((i==null?void 0:i.frete)||0)})]})]}),n.jsxs("div",{className:"flex justify-between text-lg font-semibold pt-2 border-t",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:De((i==null?void 0:i.total)||_e())})]})]}),n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-green-700 font-medium mb-2",children:[n.jsx(Sr,{className:"h-5 w-5"}),"Pagamento Seguro"]}),n.jsx("p",{className:"text-sm text-green-600",children:"Voc ser redirecionada para o Mercado Pago para concluir o pagamento com segurana."})]}),n.jsxs("div",{className:"flex gap-2 pt-4",children:[n.jsx(he,{variant:"outline",onClick:()=>f("delivery"),children:"Voltar"}),n.jsx(he,{className:"flex-1 bg-[#009ee3] hover:bg-[#007bbd]",size:"lg",onClick:Ne,disabled:oe,children:oe?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}),"Gerando pagamento..."]}):n.jsxs(n.Fragment,{children:[n.jsx(ms,{className:"h-4 w-4 mr-2"}),"Pagar com Mercado Pago"]})})]})]})]})]})]})}const VL=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),iZe=e=>{switch(e){case"pago":return{label:"Pago",variant:"default",icon:mn,tone:"primary"};case"aguardando_pagamento":return{label:"Aguardando Pagamento",variant:"secondary",icon:Lr,tone:"muted"};case"cancelado":case"expirado":return{label:e==="cancelado"?"Cancelado":"Expirado",variant:"destructive",icon:Kn,tone:"destructive"};default:return{label:"Em Aberto",variant:"outline",icon:Vt,tone:"muted"}}},oZe=e=>{switch(e){case"motoboy":return{label:"Entrega Motoboy",icon:Zl};case"pickup":return{label:"Retirada na Loja",icon:fa};case"shipping":return{label:"Envio Correios",icon:yn};default:return{label:"No definido",icon:yn}}};function lZe(){const{bagId:e}=ta(),t=new URLSearchParams(window.location.search).get("token"),[r,s]=P.useState(null),[a,i]=P.useState(!0),[o,l]=P.useState(null),[d,c]=P.useState(!1);P.useEffect(()=>{e&&u()},[e]);const u=async()=>{try{i(!0),l(null);const{data:b,error:j}=await le.functions.invoke("get-live-cart-public",{body:{live_cart_id:e,public_token:t}});if(j){console.error("Error invoking get-live-cart-public:",j),l("Sacola no encontrada");return}if(!(b!=null&&b.id)){l("Sacola no encontrada");return}s(b)}catch(b){console.error("Error fetching bag details:",b),l("Erro ao carregar detalhes da sacola")}finally{i(!1)}},h=async()=>{if(r){c(!0);try{const{data:b,error:j}=await le.functions.invoke("create-live-cart-payment",{body:{live_cart_id:r.id}});if(j)throw j;const T=b==null?void 0:b.init_point;T?(s(O=>O?{...O,mpCheckoutUrl:T}:null),de.success("Link de pagamento gerado!")):de.error("No foi possvel obter o link de pagamento")}catch(b){console.error("Error generating payment:",b),de.error("Erro ao gerar link de pagamento")}finally{c(!1)}}};if(a)return n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Et,{className:"h-8 w-8 animate-spin text-primary mx-auto mb-4"}),n.jsx("p",{className:"text-muted-foreground",children:"Carregando detalhes..."})]})});if(o||!r)return n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:n.jsx($e,{className:"max-w-md w-full",children:n.jsxs(Fe,{className:"pt-6 text-center",children:[n.jsx(Or,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Sacola no encontrada"}),n.jsx("p",{className:"text-muted-foreground",children:o||"O QR code pode ser invlido ou a sacola foi removida."})]})})});const f=iZe(r.status),m=oZe(r.deliveryMethod),p=f.icon,g=m.icon,x=f.tone==="destructive"?"text-destructive":f.tone==="primary"?"text-primary":"text-muted-foreground",v=r.status==="pago",y=!v&&r.status!=="cancelado"&&r.status!=="expirado";return n.jsx("div",{className:"min-h-screen bg-background py-8 px-4",children:n.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[n.jsx($e,{children:n.jsxs(Dt,{className:"text-center pb-2",children:[n.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:r.eventTitle}),n.jsxs(Lt,{className:"text-4xl font-bold",children:["#",r.bagNumber.toString().padStart(3,"0")]}),n.jsx("p",{className:"text-lg font-semibold text-primary",children:r.instagramHandle}),r.customerName&&n.jsx("p",{className:"text-sm text-muted-foreground",children:r.customerName})]})}),n.jsx($e,{className:"border-2 border-border",children:n.jsx(Fe,{className:"pt-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(p,{className:`h-8 w-8 ${x}`}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Status do Pagamento"}),n.jsx("p",{className:`text-lg font-bold ${x}`,children:f.label})]})]}),n.jsx(ke,{variant:f.variant,className:"text-base px-4 py-1",children:v?"OK":"Pendente"})]})})}),n.jsx($e,{children:n.jsx(Fe,{className:"pt-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center",children:n.jsx(g,{className:"h-6 w-6 text-muted-foreground"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Mtodo de Entrega"}),n.jsx("p",{className:"text-lg font-semibold",children:m.label})]})]})})}),n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-base flex items-center gap-2",children:[n.jsx(Vt,{className:"h-4 w-4"}),"Itens da Sacola (",r.totalItems,")"]})}),n.jsxs(Fe,{className:"space-y-3",children:[r.items.map(b=>n.jsxs("div",{className:"flex justify-between items-start py-2 border-b last:border-0",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-sm",children:b.productName}),n.jsx("p",{className:"text-xs text-muted-foreground",children:[b.color,b.size].filter(Boolean).join("  ")})]}),n.jsx("div",{className:"text-right",children:n.jsxs("p",{className:"text-sm font-medium",children:[b.quantity,"x ",VL(b.unitPrice)]})})]},b.id)),n.jsx(Ca,{}),n.jsxs("div",{className:"flex justify-between items-center pt-2",children:[n.jsx("span",{className:"text-lg font-bold",children:"Total"}),n.jsx("span",{className:"text-xl font-bold text-primary",children:VL(r.totalValue)})]})]})]}),y&&n.jsx($e,{className:"border-primary",children:n.jsxs(Fe,{className:"pt-4 space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 text-primary",children:[n.jsx(ms,{className:"h-6 w-6"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-semibold",children:"Pagamento Pendente"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Clique abaixo para gerar ou acessar o link de pagamento"})]})]}),r.mpCheckoutUrl?n.jsxs(he,{className:"w-full gap-2",size:"lg",onClick:()=>window.open(r.mpCheckoutUrl,"_blank"),children:[n.jsx(Zs,{className:"h-4 w-4"}),"Ir para Pagamento"]}):n.jsxs(he,{className:"w-full gap-2",size:"lg",onClick:h,disabled:d,children:[d?n.jsx(Et,{className:"h-4 w-4 animate-spin"}):n.jsx(ms,{className:"h-4 w-4"}),d?"Gerando...":"Gerar Link de Pagamento"]})]})}),v&&n.jsx($e,{className:"bg-secondary border-border",children:n.jsx(Fe,{className:"pt-4",children:n.jsxs("div",{className:"flex items-center gap-3 text-primary",children:[n.jsx(mn,{className:"h-8 w-8"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold text-lg",children:"Pagamento Confirmado!"}),n.jsx("p",{className:"text-sm",children:"Esta sacola est pronta para separao/entrega."})]})]})})}),n.jsxs("p",{className:"text-center text-xs text-muted-foreground pt-4",children:["Sacola criada em ",new Date(r.createdAt).toLocaleDateString("pt-BR")]})]})})}const cZe=e=>{const t=e.total>0?e.paid/e.total*100:0,r=e.totalValue>0?e.paidValue/e.totalValue*100:0,s=e.paid>0?e.paidValue/e.paid:0,a=Math.min(s/500*100,100);return t*.4+r*.4+a*.2},dZe=e=>{switch(e){case 1:return n.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-yellow-100",children:n.jsx(Vi,{className:"h-5 w-5 text-yellow-600"})});case 2:return n.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-slate-200",children:n.jsx(DP,{className:"h-5 w-5 text-slate-500"})});case 3:return n.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-amber-100",children:n.jsx(DP,{className:"h-5 w-5 text-amber-700"})});default:return n.jsxs("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-muted text-muted-foreground font-bold text-sm",children:[e,""]})}},uZe=e=>e>=70?n.jsxs(ke,{className:"bg-green-100 text-green-700 border-green-300 gap-1",children:[n.jsx(Vne,{className:"h-3 w-3"}),"Excelente"]}):e>=50?n.jsxs(ke,{className:"bg-blue-100 text-blue-700 border-blue-300 gap-1",children:[n.jsx(li,{className:"h-3 w-3"}),"Bom"]}):e>=30?n.jsx(ke,{className:"bg-amber-100 text-amber-700 border-amber-300 gap-1",children:"Regular"}):n.jsxs(ke,{className:"bg-red-100 text-red-700 border-red-300 gap-1",children:[n.jsx(GF,{className:"h-3 w-3"}),"Baixo"]});function hZe({liveStats:e,formatCurrency:t}){if(e.length<2)return null;const r=e.map(d=>({...d,conversionRate:d.total>0?d.paid/d.total*100:0,valueConversionRate:d.totalValue>0?d.paidValue/d.totalValue*100:0,averageTicket:d.paid>0?d.paidValue/d.paid:0,score:cZe(d),rank:0})).sort((d,c)=>c.score-d.score).map((d,c)=>({...d,rank:c+1})),s=r.reduce((d,c)=>d+c.conversionRate,0)/r.length,a=r.reduce((d,c)=>d+c.valueConversionRate,0)/r.length,i=r.filter(d=>d.averageTicket>0).reduce((d,c)=>d+c.averageTicket,0)/r.filter(d=>d.averageTicket>0).length||0,o=r[0],l=r[r.length-1];return n.jsxs($e,{children:[n.jsxs(Dt,{className:"pb-3",children:[n.jsxs(Lt,{className:"flex items-center gap-2 text-lg",children:[n.jsx(ma,{className:"h-5 w-5 text-yellow-500"}),"Ranking de Performance"]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Comparao automtica entre lives rastreadas"})]}),n.jsxs(Fe,{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[n.jsx($e,{className:"bg-gradient-to-br from-yellow-50 to-amber-50 border-yellow-200",children:n.jsxs(Fe,{className:"pt-4 pb-3",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Vi,{className:"h-5 w-5 text-yellow-600"}),n.jsx("span",{className:"text-xs font-medium text-yellow-700",children:"Melhor Performance"})]}),n.jsx("p",{className:"font-semibold text-sm truncate",children:o.eventTitle}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsxs("span",{className:"text-lg font-bold text-yellow-700",children:[o.conversionRate.toFixed(0),"%"]}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"converso"})]})]})}),n.jsx($e,{className:"bg-muted/30",children:n.jsxs(Fe,{className:"pt-4 pb-3",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(li,{className:"h-5 w-5 text-muted-foreground"}),n.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Mdia Geral"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-lg font-bold",children:[s.toFixed(0),"%"]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Converso"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-lg font-bold",children:t(i)}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Ticket"})]})]})]})}),n.jsx($e,{className:"bg-red-50/50 border-red-200",children:n.jsxs(Fe,{className:"pt-4 pb-3",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(GF,{className:"h-5 w-5 text-red-500"}),n.jsx("span",{className:"text-xs font-medium text-red-700",children:"Menor Performance"})]}),n.jsx("p",{className:"font-semibold text-sm truncate",children:l.eventTitle}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsxs("span",{className:"text-lg font-bold text-red-600",children:[l.conversionRate.toFixed(0),"%"]}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"converso"})]})]})})]}),n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{className:"bg-muted/50",children:[n.jsx(St,{className:"w-12 text-center",children:"#"}),n.jsx(St,{children:"Live"}),n.jsx(St,{className:"text-center",children:"Converso"}),n.jsx(St,{className:"text-center hidden sm:table-cell",children:"Valor Conv."}),n.jsx(St,{className:"text-center hidden md:table-cell",children:"Ticket Mdio"}),n.jsx(St,{className:"text-center",children:"Performance"})]})}),n.jsx(ya,{children:r.map(d=>{const c=d.conversionRate>s;return n.jsxs(Kr,{className:d.rank<=3?"bg-muted/20":"",children:[n.jsx(bt,{className:"text-center",children:dZe(d.rank)}),n.jsx(bt,{children:n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm truncate max-w-[150px]",children:d.eventTitle}),n.jsx("p",{className:"text-xs text-muted-foreground",children:Wt(new Date(d.eventDate),"dd/MM/yy",{locale:mr})})]})}),n.jsx(bt,{className:"text-center",children:n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsxs("span",{className:`font-semibold ${c?"text-green-600":"text-muted-foreground"}`,children:[d.conversionRate.toFixed(0),"%"]}),n.jsxs("span",{className:"text-xs text-muted-foreground",children:[d.paid,"/",d.total]})]})}),n.jsx(bt,{className:"text-center hidden sm:table-cell",children:n.jsxs("span",{className:`font-medium ${d.valueConversionRate>a?"text-green-600":"text-muted-foreground"}`,children:[d.valueConversionRate.toFixed(0),"%"]})}),n.jsx(bt,{className:"text-center hidden md:table-cell",children:n.jsx("span",{className:"font-medium",children:t(d.averageTicket)})}),n.jsx(bt,{className:"text-center",children:uZe(d.score)})]},d.eventTitle)})})]})}),n.jsx("div",{className:"flex flex-wrap gap-2 justify-center text-xs text-muted-foreground pt-2",children:n.jsx("span",{children:"Score = 40% converso + 40% valor + 20% ticket"})})]})]})}const qL="bag-tracker-bags",WL="bag-tracker-alert-days",HL=3,k4=e=>{const t=new Date(e),s=new Date().getTime()-t.getTime();return Math.floor(s/(1e3*60*60*24))},fZe=(e,t)=>e>=7?{label:`${e}d`,color:"bg-red-100 text-red-700 border-red-300",urgent:!0}:e>=t?{label:`${e}d`,color:"bg-amber-100 text-amber-700 border-amber-300",urgent:!0}:e>=1?{label:`${e}d`,color:"bg-muted text-muted-foreground",urgent:!1}:{label:"Hoje",color:"bg-muted text-muted-foreground",urgent:!1};function mZe(){const[e,t]=P.useState(!1),[r,s]=P.useState(()=>{try{const W=localStorage.getItem(qL);return W?JSON.parse(W):[]}catch{return[]}}),[a,i]=P.useState(!1),[o,l]=P.useState(""),[d,c]=P.useState("all"),[u,h]=P.useState(()=>{try{const W=localStorage.getItem(WL);return W?parseInt(W,10):HL}catch{return HL}}),f=P.useRef(null),m="bag-tracker-scanner";P.useEffect(()=>{localStorage.setItem(WL,u.toString())},[u]),P.useEffect(()=>{localStorage.setItem(qL,JSON.stringify(r))},[r]);const p=async()=>{try{const W=new KJ(m);f.current=W,await W.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},x,()=>{}),t(!0)}catch(W){console.error("Error starting scanner:",W),de.error("No foi possvel acessar a cmera")}},g=async()=>{if(f.current&&e)try{await f.current.stop(),f.current=null,t(!1)}catch(W){console.error("Error stopping scanner:",W)}},x=async W=>{let J=null;const V=W.match(/\/sacola\/([a-f0-9-]+)/i);if(V)J=V[1];else try{J=JSON.parse(W).bagId}catch{J=null}if(!J){B("error"),de.error("QR code invlido");return}if(r.some(H=>H.id===J)){B("warning"),de.info("Sacola j adicionada  lista");return}await v(J)},v=async W=>{var J,V,H,ee,ie;i(!0);try{const{data:oe,error:se}=await le.functions.invoke("get-live-cart-public",{body:{bagId:W}});if(se||!(oe!=null&&oe.bag)){B("error"),de.error("Sacola no encontrada");return}const ue=oe.bag;let pe="No definido";ue.order_id&&(pe="Ver pedido");const ce={id:ue.id,bagNumber:ue.bag_number||0,instagram:((J=ue.live_customers)==null?void 0:J.instagram_handle)||"Desconhecido",whatsapp:(V=ue.live_customers)==null?void 0:V.whatsapp,status:ue.status,deliveryMethod:pe,total:ue.total||0,itemsCount:((H=oe.items)==null?void 0:H.length)||0,eventTitle:((ee=ue.live_events)==null?void 0:ee.titulo)||"Live",eventDate:((ie=ue.live_events)==null?void 0:ie.data_hora_inicio)||ue.created_at,createdAt:ue.created_at,mpCheckoutUrl:ue.mp_checkout_url};s(ne=>[ce,...ne]),B("success"),de.success(`Sacola #${ce.bagNumber.toString().padStart(3,"0")} adicionada`)}catch(oe){console.error("Error fetching bag:",oe),B("error"),de.error("Erro ao buscar sacola")}finally{i(!1)}},y=W=>{s(J=>J.filter(V=>V.id!==W))},b=()=>{s([]),de.success("Lista limpa")},j=async W=>{var V;const J=r.findIndex(H=>H.id===W);if(J!==-1)try{const{data:H,error:ee}=await le.functions.invoke("get-live-cart-public",{body:{bagId:W}});if(ee||!(H!=null&&H.bag)){de.error("Erro ao atualizar");return}const ie=H.bag,oe={...r[J],status:ie.status,total:ie.total||0,itemsCount:((V=H.items)==null?void 0:V.length)||0,mpCheckoutUrl:ie.mp_checkout_url};s(se=>{const ue=[...se];return ue[J]=oe,ue}),de.success("Status atualizado")}catch{de.error("Erro ao atualizar")}},T=async()=>{for(const W of r)await j(W.id)},O=W=>{navigator.clipboard.writeText(W),de.success("Link copiado!")},R=(W,J)=>{const V=`Ol! Sua sacola #${J.bagNumber.toString().padStart(3,"0")} da live "${J.eventTitle}" est aguardando. Total: ${q(J.total)}`,H=`https://wa.me/55${W.replace(/\D/g,"")}?text=${encodeURIComponent(V)}`;window.open(H,"_blank")},D=()=>{const W=E.filter(H=>H.whatsapp);if(W.length===0){de.error("Nenhuma sacola pendente tem WhatsApp cadastrado");return}let J=0;W.forEach((H,ee)=>{setTimeout(()=>{const ie=`Ol! Sua sacola #${H.bagNumber.toString().padStart(3,"0")} da live "${H.eventTitle}" est aguardando pagamento h ${k4(H.createdAt)} dias. Total: ${q(H.total)}. Podemos ajudar a finalizar?`,oe=`https://wa.me/55${H.whatsapp.replace(/\D/g,"")}?text=${encodeURIComponent(ie)}`;window.open(oe,"_blank"),J++,J===W.length&&de.success(`${J} conversa(s) aberta(s) no WhatsApp`)},ee*800)});const V=E.length-W.length;V>0&&de.warning(`${V} sacola(s) sem WhatsApp cadastrado`)},B=W=>{const J={success:[523.25,659.25,783.99],warning:[440,440],error:[311.13,233.08]};try{const V=new(window.AudioContext||window.webkitAudioContext);J[W].forEach((ee,ie)=>{const oe=V.createOscillator(),se=V.createGain();oe.connect(se),se.connect(V.destination),oe.frequency.value=ee,oe.type="sine",se.gain.setValueAtTime(.3,V.currentTime),se.gain.exponentialRampToValueAtTime(.01,V.currentTime+.3),oe.start(V.currentTime+ie*.1),oe.stop(V.currentTime+.3+ie*.1)})}catch{}},q=W=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(W),Y=W=>{switch(W){case"pago":return"Pago";case"aguardando_pagamento":return"Aguardando Pagamento";case"cancelado":return"Cancelado";case"expirado":return"Expirado";default:return W}},G=W=>{switch(W){case"pago":return n.jsxs(ke,{className:"bg-green-100 text-green-700 border-green-200 gap-1",children:[n.jsx(mn,{className:"h-3 w-3"}),"Pago"]});case"aguardando_pagamento":return n.jsxs(ke,{className:"bg-amber-100 text-amber-700 border-amber-200 gap-1",children:[n.jsx(Lr,{className:"h-3 w-3"}),"Aguardando"]});case"cancelado":case"expirado":return n.jsxs(ke,{variant:"destructive",className:"gap-1",children:[n.jsx(sn,{className:"h-3 w-3"}),"Cancelado"]});default:return n.jsxs(ke,{variant:"outline",className:"gap-1",children:[n.jsx(Vt,{className:"h-3 w-3"}),W]})}},I=()=>{if(S.length===0){de.error("Nenhuma sacola para exportar");return}let W="";W+=`Rastreador de Sacolas - Exportado em ${Wt(new Date,"dd/MM/yyyy HH:mm",{locale:mr})}

`,W+=`=== RESUMO ===
`,W+=`Total de Sacolas;${N.total}
`,W+=`Sacolas Pagas;${N.paid}
`,W+=`Sacolas Pendentes;${N.pending}
`,W+=`Sacolas Canceladas;${N.cancelled}
`,W+=`Valor Total;${q(N.totalValue)}
`,W+=`Valor Pago;${q(N.paidValue)}

`,W+=`=== SACOLAS ===
`,W+=`Nmero;Instagram;Status;Live;Data Live;Itens;Valor;WhatsApp;Link Pagamento
`,S.forEach(ee=>{W+=`#${ee.bagNumber.toString().padStart(3,"0")};`,W+=`@${ee.instagram};`,W+=`${Y(ee.status)};`,W+=`${ee.eventTitle};`,W+=`${Wt(new Date(ee.eventDate),"dd/MM/yyyy",{locale:mr})};`,W+=`${ee.itemsCount};`,W+=`${q(ee.total)};`,W+=`${ee.whatsapp||"-"};`,W+=`${ee.mpCheckoutUrl||"-"}
`});const J=new Blob(["\uFEFF"+W],{type:"text/csv;charset=utf-8;"}),V=window.URL.createObjectURL(J),H=document.createElement("a");H.href=V,H.download=`rastreador_sacolas_${Wt(new Date,"yyyy-MM-dd_HHmm")}.csv`,H.click(),window.URL.revokeObjectURL(V),de.success("CSV exportado!")},F=async()=>{if(S.length===0){de.error("Nenhuma sacola para exportar");return}const W=new ww.Workbook,J=W.addWorksheet("Resumo");J.columns=[{width:25},{width:20}],[["RASTREADOR DE SACOLAS"],[`Exportado em: ${Wt(new Date,"dd/MM/yyyy HH:mm",{locale:mr})}`],[],["INDICADOR","VALOR"],["Total de Sacolas",N.total],["Sacolas Pagas",N.paid],["Sacolas Pendentes",N.pending],["Sacolas Canceladas",N.cancelled],["Valor Total",N.totalValue],["Valor Pago",N.paidValue]].forEach(se=>J.addRow(se));const V=W.addWorksheet("Sacolas");V.columns=[{width:10},{width:20},{width:20},{width:25},{width:12},{width:8},{width:15},{width:18},{width:50}],V.addRow(["NMERO","INSTAGRAM","STATUS","LIVE","DATA LIVE","ITENS","VALOR","WHATSAPP","LINK PAGAMENTO"]),S.forEach(se=>{V.addRow([`#${se.bagNumber.toString().padStart(3,"0")}`,`@${se.instagram}`,Y(se.status),se.eventTitle,Wt(new Date(se.eventDate),"dd/MM/yyyy",{locale:mr}),se.itemsCount,se.total,se.whatsapp||"-",se.mpCheckoutUrl||"-"])});const H=await W.xlsx.writeBuffer(),ee=new Blob([H],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ie=window.URL.createObjectURL(ee),oe=document.createElement("a");oe.href=ie,oe.download=`rastreador_sacolas_${Wt(new Date,"yyyy-MM-dd_HHmm")}.xlsx`,oe.click(),window.URL.revokeObjectURL(ie),de.success("Excel exportado!")},S=r.filter(W=>{const J=W.instagram.toLowerCase().includes(o.toLowerCase())||W.bagNumber.toString().includes(o)||W.eventTitle.toLowerCase().includes(o.toLowerCase()),V=d==="all"||W.status===d;return J&&V}).sort((W,J)=>W.status==="aguardando_pagamento"&&J.status==="aguardando_pagamento"?new Date(W.createdAt).getTime()-new Date(J.createdAt).getTime():W.status==="aguardando_pagamento"?-1:J.status==="aguardando_pagamento"?1:0),E=r.filter(W=>W.status==="aguardando_pagamento"&&k4(W.createdAt)>=u),N={total:r.length,paid:r.filter(W=>W.status==="pago").length,pending:r.filter(W=>W.status==="aguardando_pagamento").length,cancelled:r.filter(W=>["cancelado","expirado"].includes(W.status)).length,totalValue:r.reduce((W,J)=>W+J.total,0),paidValue:r.filter(W=>W.status==="pago").reduce((W,J)=>W+J.total,0),oldPending:E.length,oldPendingValue:E.reduce((W,J)=>W+J.total,0)},C=N.total>0?N.paid/N.total*100:0,k=N.totalValue>0?N.paidValue/N.totalValue*100:0,M=r.reduce((W,J)=>{const V=J.eventTitle;return W[V]||(W[V]={eventTitle:J.eventTitle,eventDate:J.eventDate,total:0,paid:0,pending:0,cancelled:0,totalValue:0,paidValue:0}),W[V].total++,W[V].totalValue+=J.total,J.status==="pago"?(W[V].paid++,W[V].paidValue+=J.total):J.status==="aguardando_pagamento"?W[V].pending++:W[V].cancelled++,W},{}),U=Object.values(M).sort((W,J)=>new Date(J.eventDate).getTime()-new Date(W.eventDate).getTime()),[$,X]=P.useState(!1),[Z,re]=P.useState(!1);return P.useEffect(()=>()=>{g()},[]),n.jsxs("div",{className:"space-y-6",children:[n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs(Lt,{className:"flex items-center gap-2 text-lg",children:[n.jsx(ka,{className:"h-5 w-5 text-primary"}),"Scanner de Sacolas"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(az,{className:"h-4 w-4 text-muted-foreground"}),n.jsxs(Xt,{value:u.toString(),onValueChange:W=>h(parseInt(W,10)),children:[n.jsx(Ht,{className:"w-[130px] h-8 text-xs",children:n.jsx(Yt,{placeholder:"Alerta em..."})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"1",children:"Alerta: 1 dia"}),n.jsx(qe,{value:"2",children:"Alerta: 2 dias"}),n.jsx(qe,{value:"3",children:"Alerta: 3 dias"}),n.jsx(qe,{value:"5",children:"Alerta: 5 dias"}),n.jsx(qe,{value:"7",children:"Alerta: 7 dias"}),n.jsx(qe,{value:"10",children:"Alerta: 10 dias"}),n.jsx(qe,{value:"14",children:"Alerta: 14 dias"})]})]})]})]})}),n.jsx(Fe,{children:e?n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{id:m,className:"w-full max-w-sm mx-auto aspect-square rounded-lg overflow-hidden bg-muted"}),n.jsxs(he,{variant:"outline",onClick:g,className:"w-full gap-2",children:[n.jsx(sn,{className:"h-4 w-4"}),"Parar Scanner"]})]}):n.jsxs(he,{onClick:p,className:"w-full gap-2",size:"lg",children:[n.jsx(Nx,{className:"h-5 w-5"}),"Iniciar Scanner"]})})]}),N.oldPending>0&&n.jsx($e,{className:"bg-red-50 border-red-300 border-2 animate-fade-in",children:n.jsx(Fe,{className:"py-4",children:n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"rounded-full bg-red-100 p-2 shrink-0",children:n.jsx(Or,{className:"h-5 w-5 text-red-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("h4",{className:"font-semibold text-red-800",children:[N.oldPending," ",N.oldPending===1?"sacola pendente":"sacolas pendentes"," h mais de ",u," dias"]}),n.jsxs("p",{className:"text-sm text-red-700",children:["Valor total pendente: ",q(N.oldPendingValue),"  Considere entrar em contato para cobrana"]})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-2 justify-end",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>c("aguardando_pagamento"),className:"border-red-300 text-red-700 hover:bg-red-100 gap-1",children:[n.jsx(On,{className:"h-3 w-3"}),"Ver todas"]}),n.jsxs(he,{size:"sm",onClick:D,className:"bg-[#25D366] hover:bg-[#1EBE5D] text-white gap-1",children:[n.jsx(nn,{className:"h-4 w-4"}),n.jsx(yf,{className:"h-3 w-3"}),"Cobrar todas (",E.filter(W=>W.whatsapp).length,")"]})]})]})})}),r.length>0&&n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx($e,{className:"bg-muted/50",children:n.jsxs(Fe,{className:"pt-4",children:[n.jsx("div",{className:"text-2xl font-bold",children:N.total}),n.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Sacolas"})]})}),n.jsx($e,{className:"bg-green-50 border-green-200",children:n.jsxs(Fe,{className:"pt-4",children:[n.jsx("div",{className:"text-2xl font-bold text-green-700",children:N.paid}),n.jsx("div",{className:"text-sm text-green-600",children:"Pagas"})]})}),n.jsx($e,{className:`${N.oldPending>0?"bg-red-50 border-red-300":"bg-amber-50 border-amber-200"}`,children:n.jsxs(Fe,{className:"pt-4",children:[n.jsxs("div",{className:`text-2xl font-bold ${N.oldPending>0?"text-red-700":"text-amber-700"}`,children:[N.pending,N.oldPending>0&&n.jsxs("span",{className:"text-sm font-normal ml-1",children:["(",N.oldPending," antigas)"]})]}),n.jsx("div",{className:`text-sm ${N.oldPending>0?"text-red-600":"text-amber-600"}`,children:"Pendentes"})]})}),n.jsx($e,{className:"bg-primary/5 border-primary/20",children:n.jsxs(Fe,{className:"pt-4",children:[n.jsx("div",{className:"text-2xl font-bold text-primary",children:q(N.paidValue)}),n.jsx("div",{className:"text-sm text-muted-foreground",children:"Valor Pago"})]})})]}),r.length>0&&n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs("button",{onClick:()=>X(!$),className:"flex items-center justify-between w-full text-left",children:[n.jsxs(Lt,{className:"flex items-center gap-2 text-lg",children:[n.jsx(fc,{className:"h-5 w-5 text-primary"}),"Estatsticas de Converso"]}),$?n.jsx(ip,{className:"h-5 w-5 text-muted-foreground"}):n.jsx(zo,{className:"h-5 w-5 text-muted-foreground"})]})}),n.jsx(Fe,{className:"pb-3",children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1 text-2xl font-bold text-primary",children:[n.jsx(Vs,{className:"h-5 w-5"}),C.toFixed(1),"%"]}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Taxa de Converso"}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["(",N.paid,"/",N.total," sacolas)"]})]}),n.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50",children:[n.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[k.toFixed(1),"%"]}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Converso em Valor"}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[q(N.paidValue)," de ",q(N.totalValue)]})]}),n.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50",children:[n.jsx("div",{className:"text-2xl font-bold",children:N.total>0?q(N.paidValue/N.paid||0):"R$ 0"}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Ticket Mdio Pago"})]}),n.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:q(N.totalValue-N.paidValue)}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Valor Pendente"})]})]})}),$&&U.length>0&&n.jsx(Fe,{className:"pt-0",children:n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("h4",{className:"font-medium text-sm text-muted-foreground mb-3",children:"Converso por Live"}),n.jsx("div",{className:"space-y-3",children:U.map(W=>{const J=W.total>0?W.paid/W.total*100:0;return W.totalValue>0&&W.paidValue/W.totalValue*100,n.jsxs("div",{className:"p-3 rounded-lg border bg-card",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-2",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:W.eventTitle}),n.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:Wt(new Date(W.eventDate),"dd/MM/yy",{locale:mr})})]}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs(ke,{variant:"outline",className:`${J>=70?"bg-green-100 text-green-700 border-green-300":J>=40?"bg-amber-100 text-amber-700 border-amber-300":"bg-red-100 text-red-700 border-red-300"}`,children:[n.jsx(Vs,{className:"h-3 w-3 mr-1"}),J.toFixed(0),"% converso"]})})]}),n.jsx("div",{className:"w-full bg-muted rounded-full h-2 mb-2",children:n.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all",style:{width:`${J}%`}})}),n.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-semibold",children:W.total}),n.jsx("div",{className:"text-muted-foreground",children:"Total"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-semibold text-green-600",children:W.paid}),n.jsx("div",{className:"text-muted-foreground",children:"Pagas"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-semibold text-amber-600",children:W.pending}),n.jsx("div",{className:"text-muted-foreground",children:"Pendentes"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-semibold text-primary",children:q(W.paidValue)}),n.jsx("div",{className:"text-muted-foreground",children:"Pago"})]})]})]},W.eventTitle)})})]})})]}),r.length>0&&U.length>=2&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs("button",{onClick:()=>re(!Z),className:"flex items-center gap-2 text-left w-full",children:[n.jsx(ma,{className:"h-5 w-5 text-yellow-500"}),n.jsx("span",{className:"font-semibold",children:"Comparao de Performance"}),n.jsxs(ke,{variant:"secondary",className:"ml-2",children:[U.length," lives"]}),Z?n.jsx(ip,{className:"h-4 w-4 text-muted-foreground ml-auto"}):n.jsx(zo,{className:"h-4 w-4 text-muted-foreground ml-auto"})]}),Z&&n.jsx(hZe,{liveStats:U,formatCurrency:q})]}),r.length>0&&n.jsxs($e,{children:[n.jsxs(Dt,{className:"pb-3",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[n.jsxs(Lt,{className:"text-lg",children:["Sacolas Rastreadas (",r.length,")"]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(H_,{children:[n.jsx(G_,{asChild:!0,children:n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1",children:[n.jsx(vf,{className:"h-4 w-4"}),"Exportar"]})}),n.jsxs(x1,{align:"end",children:[n.jsxs(pl,{onClick:I,className:"gap-2",children:[n.jsx(Gh,{className:"h-4 w-4"}),"Exportar CSV"]}),n.jsxs(pl,{onClick:F,className:"gap-2",children:[n.jsx(Gh,{className:"h-4 w-4"}),"Exportar Excel"]})]})]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:T,className:"gap-1",children:[n.jsx(Qr,{className:"h-4 w-4"}),"Atualizar"]}),n.jsxs(he,{variant:"ghost",size:"sm",onClick:b,className:"gap-1 text-destructive",children:[n.jsx(ui,{className:"h-4 w-4"}),"Limpar"]})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por @instagram, nmero ou live...",value:o,onChange:W=>l(W.target.value),className:"pl-9"})]}),n.jsx(Hi,{value:d,onValueChange:c,className:"w-full sm:w-auto",children:n.jsxs(Si,{className:"grid w-full grid-cols-4",children:[n.jsx(br,{value:"all",className:"text-xs",children:"Todos"}),n.jsx(br,{value:"pago",className:"text-xs",children:"Pagos"}),n.jsx(br,{value:"aguardando_pagamento",className:"text-xs",children:"Pendentes"}),n.jsx(br,{value:"cancelado",className:"text-xs",children:"Cancelados"})]})})]})]}),n.jsx(Fe,{children:n.jsx(gi,{className:"h-[500px] pr-4",children:n.jsxs("div",{className:"space-y-3",children:[S.map(W=>{const J=k4(W.createdAt),V=fZe(J,u),H=W.status==="aguardando_pagamento"&&J>=u;return n.jsx($e,{className:`border transition-all ${H?"border-red-300 border-2 bg-red-50/50 shadow-sm":""}`,children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3",children:[n.jsxs("div",{className:"flex-1 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsxs("span",{className:"text-xl font-bold",children:["#",W.bagNumber.toString().padStart(3,"0")]}),G(W.status),W.status==="aguardando_pagamento"&&n.jsxs(ke,{variant:"outline",className:`gap-1 text-xs ${V.color}`,children:[V.urgent&&n.jsx(Lr,{className:"h-3 w-3"}),V.label]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:[n.jsx("div",{className:"flex items-center gap-1 text-muted-foreground",children:n.jsxs("span",{className:"font-medium text-primary",children:["@",W.instagram]})}),n.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[n.jsx(Vt,{className:"h-3 w-3"}),W.itemsCount," itens"]}),n.jsx("div",{className:"text-muted-foreground text-xs",children:W.eventTitle}),n.jsx("div",{className:"text-muted-foreground text-xs",children:Wt(new Date(W.eventDate),"dd/MM/yy",{locale:mr})})]}),n.jsx("div",{className:"text-lg font-semibold text-primary",children:q(W.total)})]}),n.jsxs("div",{className:"flex flex-row sm:flex-col gap-2 justify-end",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>window.open(`/sacola/${W.id}`,"_blank"),className:"gap-1",children:[n.jsx(Zs,{className:"h-3 w-3"}),"Detalhes"]}),W.status==="aguardando_pagamento"&&W.mpCheckoutUrl&&n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>O(W.mpCheckoutUrl),className:"gap-1",children:[n.jsx(Wa,{className:"h-3 w-3"}),"Link Pgto"]}),W.whatsapp&&W.status==="aguardando_pagamento"&&n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>R(W.whatsapp,W),className:"gap-1 text-green-600 border-green-200 hover:bg-green-50",children:[n.jsx(kl,{className:"h-3 w-3"}),"WhatsApp"]}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>j(W.id),className:"gap-1",children:n.jsx(Qr,{className:"h-3 w-3"})}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>y(W.id),className:"gap-1 text-destructive hover:text-destructive",children:n.jsx(sn,{className:"h-3 w-3"})})]})]})})},W.id)}),S.length===0&&n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:o||d!=="all"?"Nenhuma sacola encontrada com esses filtros":"Escaneie QR codes de sacolas para rastre-las"})]})})})]}),r.length===0&&!e&&n.jsx($e,{className:"border-dashed",children:n.jsxs(Fe,{className:"flex flex-col items-center justify-center py-12 text-center",children:[n.jsx(Nx,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),n.jsx("h3",{className:"font-medium text-lg mb-2",children:"Nenhuma sacola rastreada"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-4 max-w-sm",children:"Use o scanner para ler QR codes de sacolas de diversas lives e acompanhar o status de pagamento"}),n.jsxs(he,{onClick:p,className:"gap-2",children:[n.jsx(ka,{className:"h-4 w-4"}),"Iniciar Scanner"]})]})})]})}function pZe(){const e=pr(),[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await le.auth.getSession();if(!a){e("/login");return}const{data:i}=await le.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(l=>["merchant","admin"].includes(l.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:n.jsxs("div",{className:"container flex h-14 items-center gap-4 px-4",children:[n.jsx(he,{variant:"ghost",size:"icon",asChild:!0,children:n.jsx(Ft,{to:"/dashboard",children:n.jsx(Ts,{className:"h-5 w-5"})})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Nx,{className:"h-5 w-5 text-primary"}),n.jsx("h1",{className:"text-lg font-semibold",children:"Rastreador de Sacolas"})]})]})}),n.jsx("main",{className:"container mx-auto px-4 py-6",children:n.jsx(mZe,{})})]})}function gZe(e){const[t,r]=P.useState([]),[s,a]=P.useState([]),[i,o]=P.useState(!0),[l,d]=P.useState(null),c=P.useRef(!0),u=P.useRef(null);P.useEffect(()=>{(async()=>{const{data:{user:U}}=await le.auth.getUser();U&&d(U.id)})()},[]);const h=P.useCallback(async()=>{if(e){o(!0);try{const{data:M,error:U}=await le.from("live_carts").select(`
          *,
          live_customer:live_customers(*),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color, sku)
          ),
          seller:sellers(id, name)
        `).eq("live_event_id",e).order("created_at",{ascending:!1});if(U)throw U;c.current&&r(M||[]);const{data:$}=await le.from("sellers").select("id, name").eq("is_active",!0).order("name");c.current&&$&&a($)}catch(M){console.error("Error fetching orders:",M),c.current&&de.error("Erro ao carregar pedidos")}finally{c.current&&o(!1)}}},[e]);P.useEffect(()=>(c.current=!0,h(),()=>{c.current=!1}),[h]),P.useEffect(()=>{if(!e)return;u.current&&le.removeChannel(u.current);const M=le.channel(`live_orders_${e}`).on("postgres_changes",{event:"*",schema:"public",table:"live_carts",filter:`live_event_id=eq.${e}`},()=>{c.current&&h()}).on("postgres_changes",{event:"*",schema:"public",table:"live_cart_items"},()=>{c.current&&h()}).subscribe();return u.current=M,()=>{u.current&&le.removeChannel(u.current)}},[e,h]);const f=P.useCallback(M=>{const U=Date.now(),$=(U-new Date(M.created_at).getTime())/(1e3*60*60),X=M.paid_at?(U-new Date(M.paid_at).getTime())/(1e3*60*60):0,Z=M.last_charge_at?(U-new Date(M.last_charge_at).getTime())/(1e3*60*60):null,re=M.operational_status||M.status;if(re==="aguardando_pagamento"||re==="aberto"){if(!M.last_charge_at&&$>24)return{isUrgent:!0,reason:"Nunca cobrado +24h",hoursOverdue:$-24};if(Z&&Z>24)return{isUrgent:!0,reason:"Cobrar novamente +24h",hoursOverdue:Z-24}}if(re==="aguardando_retorno"&&Z&&Z>24)return{isUrgent:!0,reason:"Sem retorno +24h",hoursOverdue:Z-24};if(re==="pago"&&X>12)return{isUrgent:!0,reason:"Pago +12h sem avano",hoursOverdue:X-12};if(re==="etiqueta_gerada"){const W=M.label_printed_at?(U-new Date(M.label_printed_at).getTime())/36e5:X;if(W>24)return{isUrgent:!0,reason:"Etiqueta +24h sem postar",hoursOverdue:W-24}}if(re==="em_rota"){const W=X;if(W>8)return{isUrgent:!0,reason:"Em rota +8h",hoursOverdue:W-8}}return{isUrgent:!1,reason:null,hoursOverdue:0}},[]),m=P.useMemo(()=>{const M=t.filter(pe=>pe.status!=="cancelado"),$=Date.now()-24*60*60*1e3,X=pe=>{var ne;return(((ne=pe.items)==null?void 0:ne.reduce((me,ge)=>ge.preco_unitario===0?me:["reservado","confirmado"].includes(ge.status)?me+ge.preco_unitario*ge.qtd:me,0))||0)+(pe.frete||0)-(pe.descontos||0)},Z=M.filter(pe=>(pe.operational_status||pe.status)==="pago"||pe.status==="pago"?!1:pe.last_charge_at?new Date(pe.last_charge_at).getTime()<$:!0).length,re=M.filter(pe=>f(pe).isUrgent).length,W=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue","retirado"],V=M.filter(pe=>pe.status==="pago"||W.includes(pe.operational_status||"")).reduce((pe,ce)=>pe+X(ce),0),H=M.filter(pe=>(pe.operational_status==="aguardando_pagamento"||pe.status==="aguardando_pagamento"||pe.status==="aberto")&&pe.operational_status!=="aguardando_retorno"),ee=M.filter(pe=>pe.operational_status==="aguardando_retorno"),ie=M.filter(pe=>pe.status==="pago"&&!["preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"].includes(pe.operational_status||"")),oe=M.filter(pe=>pe.operational_status==="preparar_envio"),se=M.filter(pe=>pe.operational_status==="entregue"||pe.operational_status==="retirado"),ue=M.filter(pe=>pe.operational_status==="aguardando_validacao_pagamento");return{aguardandoPagamento:H.length,aguardandoRetorno:ee.length,pago:ie.length,prepararEnvio:oe.length,etiquetaGerada:M.filter(pe=>pe.operational_status==="etiqueta_gerada").length,postado:M.filter(pe=>pe.operational_status==="postado").length,emRota:M.filter(pe=>pe.operational_status==="em_rota").length,retirada:M.filter(pe=>pe.operational_status==="retirada"||pe.delivery_method==="retirada"&&pe.status==="pago"&&pe.operational_status!=="entregue").length,motoboy:M.filter(pe=>pe.delivery_method==="motoboy"&&pe.status==="pago"&&!["entregue"].includes(pe.operational_status||"")).length,entregue:se.length,pendencias:M.filter(pe=>pe.operational_status==="pendencia_dados").length,semResponsavel:M.filter(pe=>!pe.seller_id&&pe.status!=="cancelado").length,needsCharge:Z,urgentCount:re,pendingProof:M.filter(pe=>pe.payment_review_status==="pending_review").length,totalPago:V,totalPedidos:M.length,valorAguardandoPagamento:H.reduce((pe,ce)=>pe+X(ce),0),valorAguardandoRetorno:ee.reduce((pe,ce)=>pe+X(ce),0),valorPago:ie.reduce((pe,ce)=>pe+X(ce),0),valorPrepararEnvio:oe.reduce((pe,ce)=>pe+X(ce),0),valorEntregue:se.reduce((pe,ce)=>pe+X(ce),0),aguardandoValidacao:ue.length,valorAguardandoValidacao:ue.reduce((pe,ce)=>pe+X(ce),0)}},[t,f]),p=P.useCallback(M=>{const $=Date.now()-24*60*60*1e3;return t.filter(X=>{var Z,re,W,J,V;if(X.status==="cancelado")return!1;if(M.search){const H=M.search.toLowerCase();if(!(((Z=X.live_customer)==null?void 0:Z.instagram_handle.toLowerCase().includes(H))||((W=(re=X.live_customer)==null?void 0:re.nome)==null?void 0:W.toLowerCase().includes(H))||((J=X.bag_number)==null?void 0:J.toString().includes(H))||((V=X.items)==null?void 0:V.some(ie=>{var oe,se,ue;return((se=(oe=ie.product)==null?void 0:oe.sku)==null?void 0:se.toLowerCase().includes(H))||((ue=ie.product)==null?void 0:ue.name.toLowerCase().includes(H))}))))return!1}if(M.status&&M.status!=="all"){if(M.status==="aguardando_pagamento"){if(X.status!=="aguardando_pagamento"&&X.status!=="aberto")return!1}else if(M.status==="pago"){if(X.status!=="pago")return!1}else if(X.operational_status!==M.status)return!1}if(M.deliveryMethod&&M.deliveryMethod!=="all"&&X.delivery_method!==M.deliveryMethod||M.sellerId&&(M.sellerId==="none"&&X.seller_id||M.sellerId!=="none"&&X.seller_id!==M.sellerId))return!1;if(M.urgentOnly){const H=new Date(X.created_at);if((Date.now()-H.getTime())/(1e3*60*60)<24||X.status==="pago")return!1}return!(M.needsCharge&&(X.status==="pago"||X.last_charge_at&&new Date(X.last_charge_at).getTime()>=$)||M.pendingProof&&X.payment_review_status!=="pending_review")})},[t]),g=P.useCallback(async(M,U)=>{r(Z=>Z.map(re=>re.id===M?{...re,seller_id:U,seller:U?s.find(W=>W.id===U):void 0}:re));const{data:$,error:X}=await le.from("live_carts").update({seller_id:U,updated_at:new Date().toISOString()}).eq("id",M).select("*, seller:sellers(id, name)").single();return X?(de.error("Erro ao atribuir vendedora"),h(),!1):($&&r(Z=>Z.map(re=>re.id===M?{...re,...$}:re)),de.success(U?"Vendedora atribuda":"Vendedora removida"),!0)},[s,h]),x=P.useCallback(async(M,U)=>{const{error:$}=await le.from("live_carts").update({operational_status:U,updated_at:new Date().toISOString()}).eq("id",M);return $?(de.error("Erro ao atualizar status"),!1):(de.success("Status atualizado"),!0)},[]),v=P.useCallback(async(M,U)=>{const{error:$}=await le.from("live_carts").update({delivery_method:U,updated_at:new Date().toISOString()}).eq("id",M);return $?(de.error("Erro ao atualizar mtodo de entrega"),!1):(de.success("Mtodo de entrega atualizado"),!0)},[]),y=P.useCallback(async(M,U,$,X)=>{const Z=t.find(V=>V.id===M);if(!Z)return de.error("Pedido no encontrado"),!1;if(Z.status==="pago")return de.error("No  possvel alterar entrega de pedido j pago"),!1;const re=Z.subtotal-Z.descontos+$,W={delivery_method:U,frete:$,total:re,updated_at:new Date().toISOString()};X&&(W.shipping_service_name=X);const{error:J}=await le.from("live_carts").update(W).eq("id",M);return J?(de.error("Erro ao atualizar entrega"),!1):(r(V=>V.map(H=>H.id===M?{...H,delivery_method:U,frete:$,total:re,shipping_service_name:X||H.shipping_service_name}:H)),de.success("Entrega configurada!"),!0)},[t]),b=P.useCallback(async(M,U)=>{const{error:$}=await le.from("customers").update({zip_code:U,updated_at:new Date().toISOString()}).eq("id",M);return $?(console.error("Error updating customer ZIP:",$),!1):(console.log("[useLiveOrders] Customer ZIP updated:",M,U),!0)},[]),j=P.useCallback(async(M,U,$)=>{const{error:X}=await le.from("live_carts").update({delivery_period:U,delivery_notes:$,updated_at:new Date().toISOString()}).eq("id",M);return X?(de.error("Erro ao atualizar detalhes de entrega"),!1):(de.success("Detalhes de entrega atualizados"),!0)},[]),T=P.useCallback(async M=>{try{const{data:U,error:$}=await le.rpc("apply_live_cart_paid_effects",{p_live_cart_id:M});if($)return console.error("[applyPaidEffects] RPC error:",$),!1;console.log("[applyPaidEffects] Result:",U);const X=typeof U=="object"?U:null;return X!=null&&X.success?(X.already_processed?console.log("[applyPaidEffects] Stock already decremented (idempotent)"):console.log("[applyPaidEffects] Stock decremented:",X.items_count,"items"),!0):!1}catch(U){return console.error("[applyPaidEffects] Exception:",U),!1}},[]),O=P.useCallback(async(M,U)=>{if(["rede","pix_itau","pix_rede","link_rede","dinheiro","pix","cartao"].includes(U.toLowerCase()))return de.error("Pagamento manual requer comprovante. Use o boto 'Pago' no card do pedido."),!1;const X=t.find(J=>J.id===M),{error:Z}=await le.from("live_cart_items").update({status:"confirmado"}).eq("live_cart_id",M).eq("status","reservado");Z&&console.error("[markAsPaid] Failed to confirm items:",Z);const{error:re}=await le.from("live_carts").update({status:"pago",operational_status:"pago",paid_method:U,paid_at:new Date().toISOString(),paid_by_user:l,payment_review_status:"approved",updated_at:new Date().toISOString()}).eq("id",M);return re?(de.error("Erro ao marcar como pago"),!1):(await le.from("live_cart_status_history").insert({live_cart_id:M,old_status:(X==null?void 0:X.operational_status)||"aguardando_pagamento",new_status:"pago",payment_method:U,changed_by:l}),await T(M)||console.warn("[markAsPaid] Stock decrement may have failed for:",M),de.success("Pagamento confirmado!"),!0)},[l,t,T]),R=P.useCallback(async(M,U,$,X)=>{if(!$||$.trim()==="")return de.error("Comprovante obrigatrio para pagamento manual"),!1;if(!["rede","pix_itau","pix_rede","link_rede","dinheiro"].includes(U.toLowerCase()))return de.error("Mtodo de pagamento invlido"),!1;const re=t.find(H=>H.id===M),{error:W}=await le.from("live_cart_items").update({status:"confirmado"}).eq("live_cart_id",M).eq("status","reservado");if(W)return console.error("[markAsPaidWithProof] Failed to confirm items:",W),de.error("Erro ao confirmar itens do carrinho"),!1;const{error:J}=await le.from("live_carts").update({status:"pago",operational_status:"pago",paid_method:U,paid_at:new Date().toISOString(),paid_by_user:l,payment_proof_url:$,payment_review_status:"pending_review",updated_at:new Date().toISOString()}).eq("id",M);return J?(de.error("Erro ao marcar como pago"),!1):(await le.from("live_cart_status_history").insert({live_cart_id:M,old_status:(re==null?void 0:re.operational_status)||"aguardando_pagamento",new_status:"pago",payment_method:U,changed_by:l,notes:X||`Pagamento manual (${U}) com comprovante`}),await T(M)||console.warn("[markAsPaidWithProof] Stock decrement may have failed for:",M),de.success("Pagamento registrado (pendente validao)"),!0)},[l,t,T]),D=P.useCallback(async M=>{const U=new Date().toISOString(),{error:$}=await le.from("live_carts").update({payment_review_status:"approved",validated_at:U,validated_by_user_id:l,updated_at:U}).eq("id",M);return $?(de.error("Erro ao aprovar pagamento"),!1):(await le.from("live_cart_status_history").insert({live_cart_id:M,old_status:"pago",new_status:"pago",notes:"Pagamento manual validado pelo admin",changed_by:l}),await T(M)||console.warn("[approveManualPayment] Stock decrement may have failed for:",M),de.success("Pagamento validado!"),!0)},[l,T]),B=P.useCallback(async(M,U)=>{if(!U.trim())return de.error("Motivo da rejeio  obrigatrio"),!1;const $=new Date().toISOString(),{error:X}=await le.from("live_carts").update({status:"aguardando_pagamento",operational_status:"aguardando_retorno",payment_review_status:"rejected",rejection_reason:U,validated_at:$,validated_by_user_id:l,updated_at:$}).eq("id",M);return X?(de.error("Erro ao rejeitar pagamento"),!1):(await le.from("live_cart_status_history").insert({live_cart_id:M,old_status:"pago",new_status:"aguardando_retorno",notes:`Pagamento rejeitado: ${U}`,changed_by:l}),await le.from("live_cart_items").update({status:"reservado"}).eq("live_cart_id",M).eq("status","confirmado"),de.success("Pagamento rejeitado. Vendedora pode cobrar novamente."),!0)},[l]),q=P.useCallback(async(M,U)=>{const $=new Date().toISOString(),X=t.find(J=>J.id===M),Z=((X==null?void 0:X.charge_attempts)||0)+1,re={last_charge_at:$,charge_attempts:Z,charge_channel:U,charge_by_user:l,operational_status:"aguardando_retorno",updated_at:$},{error:W}=await le.from("live_carts").update(re).eq("id",M);return W?(console.error("Error recording charge:",W),de.error("Erro ao registrar cobrana"),!1):(await le.from("live_charge_logs").insert({live_cart_id:M,charged_by:l,channel:U}),await le.from("live_cart_status_history").insert({live_cart_id:M,old_status:(X==null?void 0:X.operational_status)||"aguardando_pagamento",new_status:"aguardando_retorno",notes:`Cobrana registrada via ${U}`,changed_by:l}),r(J=>J.map(V=>V.id===M?{...V,last_charge_at:$,charge_attempts:Z,charge_channel:U,operational_status:"aguardando_retorno"}:V)),de.success("Cobrana registrada! Status: Aguardando retorno"),!0)},[t,l]),Y=P.useCallback(async M=>{const U=t.find(re=>re.id===M);if(!U)return!1;if(U.payment_review_status==="pending_review")return de.error("Pagamento aguardando validao do admin. No  possvel avanar."),!1;const $=U.operational_status||"aguardando_pagamento";let X=null;if(U.delivery_method==="correios"&&$==="postado"){if(!U.shipping_tracking_code)return de.error("Correios: necessrio cdigo de rastreio para marcar entregue"),!1;X="entregue"}else if(U.delivery_method==="correios"&&$==="etiqueta_gerada"){if(!U.me_label_url&&!U.shipping_tracking_code)return de.error("Correios: necessrio gerar etiqueta primeiro"),!1;X="postado"}else if(U.delivery_method==="motoboy"&&$!=="em_rota"&&$==="pago")X="em_rota";else if(U.delivery_method==="motoboy"&&$==="em_rota")X="entregue";else if(U.delivery_method==="retirada"&&$!=="retirada"&&$==="pago")X="retirada";else if(U.delivery_method==="retirada"&&$==="retirada")X="entregue";else switch($){case"pago":U.delivery_method==="correios"?X="preparar_envio":U.delivery_method==="motoboy"?X="em_rota":X="retirada";break;case"preparar_envio":return de.info("Gere a etiqueta Melhor Envio primeiro"),!1;case"postado":X="entregue";break;default:return de.error("No  possvel avanar deste status"),!1}if(!X)return!1;const{error:Z}=await le.from("live_carts").update({operational_status:X,updated_at:new Date().toISOString()}).eq("id",M);return Z?(de.error("Erro ao avanar status"),!1):(await le.from("live_cart_status_history").insert({live_cart_id:M,old_status:$,new_status:X,changed_by:l}),r(re=>re.map(W=>W.id===M?{...W,operational_status:X}:W)),de.success(`Status atualizado para ${X.replace(/_/g," ")}`),!0)},[t,l]),G=P.useCallback(async(M,U,$,X)=>{const Z=t.find(V=>V.id===M);if(!Z)return!1;if(!X){if(Z.payment_review_status==="approved"&&["pago","preparar_envio","etiqueta_gerada"].includes(U))return de.error("Apenas admin pode reverter pagamentos validados"),!1;const V=["aguardando_pagamento","aguardando_retorno","pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"],H=V.indexOf(Z.operational_status),ee=V.indexOf(U);if(H-ee>1)return de.error("Vendedora pode voltar apenas 1 etapa"),!1}if(X&&!$.trim())return de.error("Admin deve informar motivo para reverso"),!1;const re=new Date().toISOString(),W={operational_status:U,updated_at:re};["aguardando_pagamento","aguardando_retorno"].includes(U)&&(W.status="aguardando_pagamento");const{error:J}=await le.from("live_carts").update(W).eq("id",M);return J?(de.error("Erro ao reverter status"),!1):(await le.from("live_cart_status_history").insert({live_cart_id:M,old_status:Z.operational_status,new_status:U,notes:`REVERSO: ${$||"Sem motivo informado"}`,changed_by:l}),r(V=>V.map(H=>H.id===M?{...H,operational_status:U,...W}:H)),de.success(`Status revertido para ${U.replace(/_/g," ")}`),!0)},[t,l]),I=P.useCallback(async M=>{const U=t.find($=>$.id===M);if(!U)return{success:!1,error:"Pedido no encontrado"};if(!U.shipping_address_snapshot)return await le.from("live_carts").update({operational_status:"pendencia_dados"}).eq("id",M),{success:!1,error:"Dados de envio pendentes"};try{const{data:$,error:X}=await le.functions.invoke("generate-shipping-label",{body:{cartId:M}});if(X)throw X;return{success:!0,labelUrl:$.label_url,trackingCode:$.tracking_code}}catch($){return de.error("Erro ao gerar etiqueta"),{success:!1,error:$.message}}},[t]),F=P.useCallback(async M=>{const U=t.find(X=>X.id===M);if((U==null?void 0:U.separation_status)!=="separado")return de.error("Pedido precisa ser separado antes de postar"),!1;const{error:$}=await le.from("live_carts").update({operational_status:"postado",updated_at:new Date().toISOString()}).eq("id",M);return $?(de.error("Erro ao marcar como postado"),!1):(de.success("Pedido marcado como postado"),!0)},[t]),S=P.useCallback(async M=>{const U=t.find(W=>W.id===M);if(!U)return de.error("Pedido no encontrado"),!1;const $=U.operational_status;let X,Z;if(U.delivery_method==="motoboy")if($==="pago")X="em_rota",Z="Pedido em rota de entrega";else if($==="em_rota")X="entregue",Z="Pedido entregue!";else return de.error("Status atual no permite esta ao"),!1;else if(U.delivery_method==="correios"){if($!=="postado")return de.error("Correios: pedido precisa estar postado para marcar entregue"),!1;X="entregue",Z="Pedido entregue!"}else return de.error("Use 'Marcar como Retirado' para pedidos de retirada"),!1;const{error:re}=await le.from("live_carts").update({operational_status:X,updated_at:new Date().toISOString()}).eq("id",M);return re?(de.error("Erro ao atualizar status"),!1):(await le.from("live_cart_status_history").insert({live_cart_id:M,old_status:$,new_status:X,changed_by:l}),r(W=>W.map(J=>J.id===M?{...J,operational_status:X}:J)),de.success(Z),!0)},[t,l]),E=P.useCallback(async M=>{const U=t.find(W=>W.id===M);if(!U)return de.error("Pedido no encontrado"),!1;if(U.delivery_method!=="retirada")return de.error("Ao s disponvel para pedidos de retirada na loja"),!1;const $=U.operational_status;let X,Z;if($==="pago")X="retirada",Z="Pedido aguardando retirada";else if($==="retirada")X="entregue",Z="Pedido retirado pelo cliente!";else return de.error("Status atual no permite esta ao"),!1;const{error:re}=await le.from("live_carts").update({operational_status:X,updated_at:new Date().toISOString()}).eq("id",M);return re?(de.error("Erro ao atualizar status"),!1):(await le.from("live_cart_status_history").insert({live_cart_id:M,old_status:$,new_status:X,changed_by:l}),r(W=>W.map(J=>J.id===M?{...J,operational_status:X}:J)),de.success(Z),!0)},[t,l]),N=P.useMemo(()=>{const U=Date.now()-24*60*60*1e3;return t.filter($=>$.status==="pago"||$.status==="cancelado"?!1:$.last_charge_at?new Date($.last_charge_at).getTime()<U:!0)},[t]),C=P.useCallback(async M=>{const{data:U,error:$}=await le.from("live_charge_logs").select("channel, created_at, charged_by").eq("live_cart_id",M).order("created_at",{ascending:!1}).limit(20);return $?(console.error("Error fetching charge history:",$),[]):U||[]},[]),k=P.useCallback((M,U)=>{r($=>$.map(X=>X.id===M?{...X,shipping_tracking_code:U}:X))},[]);return{orders:t,sellers:s,kpis:m,isLoading:i,currentUserId:l,filterOrders:p,ordersNeedingCharge:N,getOrderUrgency:f,assignSeller:g,updateOperationalStatus:x,updateDeliveryMethod:v,updateDeliveryWithShipping:y,updateCustomerZipCode:b,updateDeliveryDetails:j,markAsPaid:O,markAsPaidWithProof:R,approveManualPayment:D,rejectManualPayment:B,applyPaidEffects:T,recordCharge:q,advanceStatus:Y,revertStatus:G,generateShippingLabel:I,markAsPosted:F,markAsDelivered:S,markAsPickedUp:E,fetchChargeHistory:C,updateTrackingCode:k,refetch:h}}function xZe({kpis:e,activeFilter:t,onFilterClick:r}){const s=o=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o),a=[{label:"Aguardando Pgto",value:e.aguardandoPagamento,valorTotal:e.valorAguardandoPagamento||0,icon:Lr,color:"text-amber-600",bg:"bg-amber-50",border:"border-amber-200",activeBg:"bg-amber-100",filter:"aguardando_pagamento"},{label:"Aguardando Retorno",value:e.aguardandoRetorno,valorTotal:e.valorAguardandoRetorno||0,icon:Kv,color:"text-orange-600",bg:"bg-orange-50",border:"border-orange-200",activeBg:"bg-orange-100",filter:"aguardando_retorno"},{label:"Pago",value:e.pago,valorTotal:e.valorPago||0,icon:Sr,color:"text-green-600",bg:"bg-green-50",border:"border-green-200",activeBg:"bg-green-100",filter:"pago"},{label:"Preparar Envio",value:e.prepararEnvio,valorTotal:e.valorPrepararEnvio||0,icon:Vt,color:"text-blue-600",bg:"bg-blue-50",border:"border-blue-200",activeBg:"bg-blue-100",filter:"preparar_envio"},{label:"Etiqueta Gerada",value:e.etiquetaGerada,icon:Dh,color:"text-indigo-600",bg:"bg-indigo-50",border:"border-indigo-200",activeBg:"bg-indigo-100",filter:"etiqueta_gerada"},{label:"Postado",value:e.postado,icon:yn,color:"text-purple-600",bg:"bg-purple-50",border:"border-purple-200",activeBg:"bg-purple-100",filter:"postado"},{label:"Em Rota",value:e.emRota,icon:Zl,color:"text-cyan-600",bg:"bg-cyan-50",border:"border-cyan-200",activeBg:"bg-cyan-100",filter:"em_rota"},{label:"Entregue ",value:e.entregue,valorTotal:e.valorEntregue||0,icon:Kne,color:"text-emerald-600",bg:"bg-emerald-50",border:"border-emerald-200",activeBg:"bg-emerald-100",filter:"entregue"}],i=[{label:"Retirada",value:e.retirada,icon:fa,color:"text-teal-600",bg:"bg-teal-50",border:"border-teal-200",filter:"retirada"},{label:"Validar Pgto",value:e.pendingProof,icon:ks,color:"text-violet-600",bg:"bg-violet-50",border:"border-violet-200",filter:"pending_proof",highlight:e.pendingProof>0},{label:"Urgentes",value:e.urgentCount,icon:Sn,color:"text-rose-600",bg:"bg-rose-50",border:"border-rose-200",filter:"urgent",highlight:e.urgentCount>0},{label:"Cobrar",value:e.needsCharge,icon:nn,color:"text-red-600",bg:"bg-red-50",border:"border-red-200",filter:"needs_charge",highlight:e.needsCharge>0}];return n.jsxs("div",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[n.jsx("div",{className:"scroll-container-x",children:n.jsx("div",{className:"flex sm:grid sm:grid-cols-4 md:grid-cols-8 gap-2 w-max sm:w-full",children:a.map(o=>{const l=t===o.filter;return n.jsx($e,{className:He("p-2 sm:p-3 cursor-pointer transition-all hover:shadow-md border shrink-0 w-[80px] sm:w-auto",l?o.activeBg:o.bg,o.border,l&&"ring-2 ring-offset-1 ring-primary/50"),onClick:()=>r(o.filter),children:n.jsxs("div",{className:"flex flex-col items-center text-center",children:[n.jsx(o.icon,{className:He("h-4 w-4 sm:h-5 sm:w-5 mb-1",o.color)}),n.jsx("span",{className:He("text-lg sm:text-2xl font-bold",o.color),children:o.value}),n.jsx("span",{className:"text-[9px] sm:text-xs text-muted-foreground leading-tight line-clamp-2",children:o.label}),o.valorTotal!==void 0&&o.valorTotal>0&&n.jsx("span",{className:"text-[9px] sm:text-xs font-medium text-muted-foreground mt-0.5 hidden sm:block",children:s(o.valorTotal)})]})},o.label)})})}),n.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:i.map(o=>{const l=t===o.filter;return n.jsxs($e,{className:He("p-2 cursor-pointer transition-all hover:shadow-md border flex items-center gap-2",l?"bg-primary/10":o.bg,o.border,o.highlight&&!l&&"ring-2 ring-offset-1 ring-red-300",l&&"ring-2 ring-offset-1 ring-primary/50"),onClick:()=>r(o.filter),children:[n.jsx(o.icon,{className:He("h-4 w-4 shrink-0",o.color)}),n.jsx("span",{className:He("font-bold text-lg",o.color),children:o.value}),n.jsx("span",{className:"text-xs text-muted-foreground truncate",children:o.label})]},o.label)})}),n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 bg-gradient-to-r from-primary/5 via-transparent to-transparent rounded-lg px-3 sm:px-4 py-2 border border-border/40",children:[n.jsxs("div",{className:"flex items-center gap-4 sm:gap-6 flex-wrap",children:[n.jsxs("button",{onClick:()=>r("none"),className:He("flex items-center gap-2 hover:underline transition-colors text-sm",t==="none"&&"font-medium text-primary"),children:[n.jsx(Ha,{className:"h-4 w-4 text-muted-foreground"}),n.jsxs("span",{children:[n.jsx("span",{className:"font-medium",children:e.semResponsavel})," ",n.jsx("span",{className:"text-muted-foreground",children:"sem resp."})]})]}),n.jsxs("button",{onClick:()=>r("all"),className:He("text-sm text-muted-foreground hover:text-foreground hover:underline transition-colors",t==="all"&&"font-medium text-primary"),children:["Todos (",e.totalPedidos,")"]})]}),n.jsxs("div",{className:"text-left sm:text-right",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Pago: "}),n.jsx("span",{className:"text-base sm:text-lg font-bold text-green-600",children:s(e.totalPago)})]})]})]})}function GL({order:e,sellers:t,urgency:r,compact:s=!1,onSelect:a,onAssignSeller:i,onMarkAsPaid:o,onMarkAsPosted:l,onMarkAsDelivered:d,onMarkAsPickedUp:c,onAdvanceStatus:u,onRecordCharge:h,onOpenManualPayment:f}){var M,U,$;const[m,p]=P.useState(e.seller_id);P.useEffect(()=>{p(e.seller_id)},[e.seller_id]);const g=X=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(X),x=e.status==="pago",v=e.status==="aguardando_pagamento"||e.status==="aberto"||e.operational_status==="aguardando_pagamento",y=e.operational_status==="aguardando_retorno",b=e.status==="cancelado",j=e.operational_status==="entregue"||e.operational_status==="retirado",T=e.payment_review_status==="pending_review",O=r.isUrgent,R=()=>{const X=`${window.location.origin}/live-checkout/${e.id}`;return e.public_token?`${X}?token=${e.public_token}`:X},D=()=>{if(x)return null;if(!e.last_charge_at){const Z=(Date.now()-new Date(e.created_at).getTime())/36e5;return Z>24?{text:`Nunca cobrada (+${Math.floor(Z)}h)`,needsCharge:!0}:{text:"Nunca cobrada",needsCharge:!0}}const X=(Date.now()-new Date(e.last_charge_at).getTime())/(1e3*60*60);return X>24?{text:`Cobrar novamente (+${Math.floor(X)}h)`,needsCharge:!0}:{text:`Cobrada ${Vk(new Date(e.last_charge_at),{locale:mr,addSuffix:!0})}`,needsCharge:!1}},B=e.delivery_method==="correios"?yn:e.delivery_method==="motoboy"?Zl:fa,q=()=>b?{label:"Cancelado",color:"text-muted-foreground bg-muted border-muted"}:j?{label:"Entregue ",color:"text-emerald-700 bg-emerald-50 border-emerald-200"}:T?{label:"Validar Pagamento",color:"text-violet-700 bg-violet-50 border-violet-200"}:x?e.operational_status==="preparar_envio"?{label:"Preparar Envio",color:"text-blue-700 bg-blue-50 border-blue-200"}:e.operational_status==="etiqueta_gerada"?{label:"Etiqueta Gerada",color:"text-indigo-700 bg-indigo-50 border-indigo-200"}:e.operational_status==="postado"?{label:"Postado",color:"text-purple-700 bg-purple-50 border-purple-200"}:e.operational_status==="em_rota"?{label:"Em Rota",color:"text-cyan-700 bg-cyan-50 border-cyan-200"}:e.operational_status==="retirada"?{label:"Aguardando Retirada",color:"text-teal-700 bg-teal-50 border-teal-200"}:{label:"Pago",color:"text-green-700 bg-green-50 border-green-200"}:y?{label:"Aguardando Retorno",color:"text-orange-700 bg-orange-50 border-orange-200"}:v&&!x?{label:"Aguardando Pagamento",color:"text-amber-700 bg-amber-50 border-amber-200"}:null,Y=async()=>{const X=R(),Z=Fx(X,e.bag_number||void 0);await af(Z)?de.success("Mensagem copiada com link!"):de.error("Erro ao copiar.")},G=()=>{const X=e.live_customer;if(!(X!=null&&X.whatsapp)){de.error("Cliente sem WhatsApp cadastrado");return}const Z=R(),re=Fx(Z,e.bag_number||void 0),W=po(X.whatsapp,re);window.open(W,"_blank")},I=async()=>{var re;const X=(re=e.live_customer)!=null&&re.whatsapp?"whatsapp":"direct";await h(e.id,X,!0)&&de.success("Cobrana registrada  Aguardando retorno")},F=async X=>{const Z=X==="unassigned"?null:X;p(Z),await i(e.id,Z)},S=D(),E=q(),N=iw(((M=e.live_customer)==null?void 0:M.instagram_handle)||""),C=rV(((U=e.live_customer)==null?void 0:U.instagram_handle)||""),k=()=>{const X=(Date.now()-new Date(e.updated_at).getTime())/36e5;return X<1?`${Math.floor(X*60)}min`:X<24?`${Math.floor(X)}h`:`${Math.floor(X/24)}d`};return s?n.jsxs($e,{className:He("p-3 cursor-pointer hover:shadow-sm transition-all border-border/60",O&&"border-l-2 border-l-amber-500",b&&"opacity-50"),onClick:a,children:[n.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsxs("span",{className:"text-xs font-mono text-muted-foreground",children:["#",e.bag_number]}),n.jsx("span",{className:"font-medium text-sm truncate",children:N})]}),n.jsx(B,{className:"h-4 w-4 text-muted-foreground shrink-0"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"font-semibold",children:g(e.total)}),E&&n.jsx(ke,{variant:"outline",className:He("text-xs",E.color),children:E.label})]})]}):n.jsxs($e,{className:He("p-3 sm:p-4 transition-all border-border/60",O&&"border-l-4 border-l-amber-500 bg-amber-50/20",(S==null?void 0:S.needsCharge)&&!x&&!y&&"border-l-4 border-l-rose-400",b&&"opacity-50 bg-muted/30"),children:[n.jsxs("div",{className:"flex items-start justify-between gap-2 sm:gap-4 mb-2 sm:mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[n.jsxs("span",{className:"text-xs sm:text-sm font-mono text-muted-foreground shrink-0",children:["#",e.bag_number]}),n.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[n.jsx("span",{className:"font-semibold text-sm sm:text-base truncate",children:N}),C&&n.jsx("a",{href:C,target:"_blank",rel:"noopener noreferrer",onClick:X=>X.stopPropagation(),className:"text-muted-foreground hover:text-blue-600 shrink-0",children:n.jsx(Zs,{className:"h-3 w-3"})})]})]}),n.jsx("div",{className:"shrink-0",children:E&&n.jsx(ke,{variant:"outline",className:He("text-[10px] sm:text-xs font-medium",E.color),children:E.label})})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 sm:gap-2 mb-2 sm:mb-3 text-xs sm:text-sm",children:[n.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[n.jsx(B,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"text-[10px] sm:text-xs",children:e.delivery_method==="correios"?"Correios":e.delivery_method==="motoboy"?"Motoboy":"Retirada"})]}),n.jsx("div",{className:"flex items-center",onClick:X=>X.stopPropagation(),children:n.jsxs(Xt,{value:m||"unassigned",onValueChange:F,children:[n.jsxs(Ht,{className:"h-6 sm:h-7 w-auto min-w-[70px] sm:min-w-[90px] text-[10px] sm:text-xs border-dashed bg-transparent px-1.5",children:[n.jsx(Dn,{className:"h-3 w-3 mr-0.5 text-muted-foreground"}),n.jsx(Yt,{placeholder:"Resp."})]}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"unassigned",children:"Sem responsvel"}),t.map(X=>n.jsx(qe,{value:X.id,children:X.name},X.id))]})]})}),n.jsx("span",{className:"text-[10px] sm:text-xs text-muted-foreground",children:k()}),O&&r.reason&&n.jsxs(ke,{variant:"destructive",className:"text-[10px] sm:text-xs h-5",children:[n.jsx(Or,{className:"h-3 w-3 mr-0.5"}),n.jsx("span",{className:"hidden sm:inline",children:r.reason})]}),S&&!x&&n.jsx("span",{className:He("text-[10px] sm:text-xs",S.needsCharge?"text-rose-600 font-medium":"text-muted-foreground"),children:S.text}),e.is_raffle_winner&&n.jsx(ke,{className:"text-[10px] bg-amber-100 text-amber-800 border-amber-300 h-5",children:n.jsx(ma,{className:"h-3 w-3"})})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 pt-2 sm:pt-3 border-t border-border/40",children:[n.jsx("span",{className:"text-lg sm:text-xl font-bold tracking-tight",children:g(e.total)}),n.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 flex-wrap",onClick:X=>X.stopPropagation(),children:[(v||y)&&!x&&!b&&n.jsxs(n.Fragment,{children:[(($=e.live_customer)==null?void 0:$.whatsapp)&&n.jsxs(he,{variant:"outline",size:"sm",className:"h-9 sm:h-8 text-xs flex-1 sm:flex-none min-w-0",onClick:G,title:"Abrir WhatsApp com mensagem",children:[n.jsx(nn,{className:"h-3.5 w-3.5 sm:mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:y?"Reenviar":"Cobrar"})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"h-9 sm:h-8 text-xs",onClick:Y,title:"Copiar mensagem com link",children:[n.jsx(Wa,{className:"h-3.5 w-3.5 sm:mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:"Copiar"})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"h-9 sm:h-8 text-xs border-amber-300 text-amber-700 hover:bg-amber-50",onClick:I,title:"Registrar cobrana",children:[n.jsx(gn,{className:"h-3.5 w-3.5 sm:mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:"Registrar"})]}),n.jsxs(he,{variant:"default",size:"sm",className:"h-9 sm:h-8 text-xs bg-emerald-600 hover:bg-emerald-700",onClick:()=>f(e.id),title:"Marcar como pago",children:[n.jsx(ks,{className:"h-3.5 w-3.5 sm:mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:"Pago"})]})]}),x&&!j&&!b&&!T&&n.jsxs(he,{variant:"default",size:"sm",className:"h-9 sm:h-8 text-xs",onClick:()=>u(e.id),title:"Avanar para prximo status",children:[n.jsx(In,{className:"h-3.5 w-3.5 sm:mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:"Avanar"})]}),n.jsxs(he,{variant:"ghost",size:"sm",className:"h-9 sm:h-8 text-xs text-muted-foreground hover:text-foreground",onClick:a,children:["Detalhes",n.jsx(In,{className:"h-3.5 w-3.5 ml-0.5"})]})]})]})]})}const vZe={rede:"Maquininha REDE",pix_itau:"PIX Ita",pix_rede:"PIX REDE",link_rede:"Link Externo REDE",dinheiro:"Dinheiro",pix:"PIX",cartao:"Carto"};function yZe({order:e,isAdmin:t,onApprove:r,onReject:s}){const[a,i]=P.useState(!1),[o,l]=P.useState(""),[d,c]=P.useState(!1),[u,h]=P.useState(!1),[f,m]=P.useState(!1),p=e.payment_review_status==="pending_review",g=e.payment_review_status==="approved",x=e.payment_review_status==="rejected",v=!!e.payment_proof_url;if(!v&&!p&&!g&&!x)return null;const y=async()=>{c(!0);const j=await r(e.id);return c(!1),j},b=async()=>{if(!o.trim())return;h(!0);const j=await s(e.id,o);h(!1),j&&(l(""),m(!1))};return n.jsxs("div",{className:"space-y-3",children:[n.jsx(Ca,{}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[n.jsx(s_,{className:"h-4 w-4"}),"Pagamento Manual"]}),p&&n.jsxs(ke,{className:"bg-violet-100 text-violet-700 border-violet-300",children:[n.jsx(Lr,{className:"h-3 w-3 mr-1"}),"Aguardando Validao"]}),g&&n.jsxs(ke,{className:"bg-green-100 text-green-700 border-green-300",children:[n.jsx(Sr,{className:"h-3 w-3 mr-1"}),"Validado"]}),x&&n.jsxs(ke,{className:"bg-red-100 text-red-700 border-red-300",children:[n.jsx(Kn,{className:"h-3 w-3 mr-1"}),"Rejeitado"]})]}),n.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Mtodo"}),n.jsx("span",{className:"font-medium",children:vZe[e.paid_method||""]||e.paid_method})]}),e.paid_at&&n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Data/hora"}),n.jsx("span",{children:Wt(new Date(e.paid_at),"dd/MM/yyyy 's' HH:mm",{locale:mr})})]}),e.validated_at&&n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:x?"Rejeitado em":"Validado em"}),n.jsx("span",{children:Wt(new Date(e.validated_at),"dd/MM/yyyy 's' HH:mm",{locale:mr})})]})]}),v&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{className:"text-sm font-medium",children:"Comprovante"}),n.jsxs("div",{className:"relative cursor-pointer group",onClick:()=>i(!0),children:[n.jsx("img",{src:e.payment_proof_url,alt:"Comprovante de pagamento",className:"w-full max-h-48 object-contain rounded-lg border bg-muted"}),n.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors rounded-lg flex items-center justify-center",children:n.jsx(nse,{className:"h-6 w-6 text-white opacity-0 group-hover:opacity-100 transition-opacity drop-shadow-lg"})})]})]}),x&&e.rejection_reason&&n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:n.jsxs("p",{className:"text-sm text-red-800",children:[n.jsx("strong",{children:"Motivo:"})," ",e.rejection_reason]})}),t&&p&&n.jsx("div",{className:"space-y-3 pt-2",children:f?n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Motivo da rejeio *"}),n.jsx(rs,{value:o,onChange:j=>l(j.target.value),placeholder:"Ex: Valor divergente, comprovante invlido...",rows:2}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{variant:"outline",onClick:()=>{m(!1),l("")},disabled:u,children:"Cancelar"}),n.jsxs(he,{variant:"destructive",className:"flex-1",onClick:b,disabled:u||!o.trim(),children:[u?n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}):n.jsx(Kn,{className:"h-4 w-4 mr-2"}),"Confirmar Rejeio"]})]})]}):n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{className:"flex-1 bg-green-600 hover:bg-green-700",onClick:y,disabled:d,children:[d?n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}):n.jsx(Sr,{className:"h-4 w-4 mr-2"}),"Validar Pagamento"]}),n.jsxs(he,{variant:"outline",className:"border-red-300 text-red-600 hover:bg-red-50",onClick:()=>m(!0),children:[n.jsx(Kn,{className:"h-4 w-4 mr-2"}),"Rejeitar"]})]})}),!t&&p&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-start gap-2",children:[n.jsx(Or,{className:"h-5 w-5 text-amber-500 shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-amber-800",children:[n.jsx("p",{className:"font-medium",children:"Aguardando validao do admin"}),n.jsx("p",{className:"text-amber-700",children:"O pagamento foi registrado e est sendo revisado. Voc ser notificada quando for aprovado."})]})]})]}),n.jsx(tn,{open:a,onOpenChange:i,children:n.jsxs(Jr,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:[n.jsx(ln,{children:n.jsx(rn,{children:"Comprovante de Pagamento"})}),v&&n.jsx("img",{src:e.payment_proof_url,alt:"Comprovante de pagamento",className:"w-full object-contain"})]})})]})}const bZe=[{value:"rede",label:"Maquininha REDE"},{value:"pix_itau",label:"PIX Ita"},{value:"pix_rede",label:"PIX REDE"},{value:"link_rede",label:"Link Externo REDE"},{value:"dinheiro",label:"Dinheiro"}];function XJ({open:e,onClose:t,orderId:r,orderTotal:s,onConfirm:a}){const[i,o]=P.useState(""),[l,d]=P.useState(""),[c,u]=P.useState(null),[h,f]=P.useState(""),[m,p]=P.useState(!1),[g,x]=P.useState(!1),v=P.useRef(null),y=R=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(R),b=R=>{var B;const D=(B=R.target.files)==null?void 0:B[0];if(D){if(D.size>5*1024*1024){de.error("Arquivo muito grande. Mximo 5MB.");return}u(D);const q=new FileReader;q.onload=Y=>{var G;f((G=Y.target)==null?void 0:G.result)},q.readAsDataURL(D)}},j=async()=>{if(!c)return null;p(!0);try{const R=c.name.split(".").pop(),B=`payment-proofs/${`payment-proof-${r}-${Date.now()}.${R}`}`,{error:q}=await le.storage.from("products").upload(B,c);if(q)return console.error("Upload error:",q),de.error("Erro ao fazer upload do comprovante"),null;const{data:{publicUrl:Y}}=le.storage.from("products").getPublicUrl(B);return Y}catch(R){return console.error("Upload error:",R),de.error("Erro ao fazer upload"),null}finally{p(!1)}},T=async()=>{if(!i){de.error("Selecione o mtodo de pagamento");return}if(!c){de.error("Comprovante obrigatrio para pagamento manual");return}x(!0);const R=await j();if(!R){x(!1);return}const D=await a(i,R,l);x(!1),D&&(o(""),d(""),u(null),f(""),t())},O=()=>{o(""),d(""),u(null),f(""),t()};return n.jsx(tn,{open:e,onOpenChange:O,children:n.jsxs(Jr,{className:"sm:max-w-md",children:[n.jsxs(ln,{children:[n.jsx(rn,{children:"Registrar Pagamento Manual"}),n.jsxs(Vo,{children:["Valor: ",n.jsx("span",{className:"font-bold text-foreground",children:y(s)})]})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-start gap-2",children:[n.jsx(Or,{className:"h-5 w-5 text-amber-500 shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-amber-800",children:[n.jsx("p",{className:"font-medium",children:"Comprovante obrigatrio"}),n.jsx("p",{className:"text-amber-700",children:"Pagamentos manuais passam por validao administrativa."})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Mtodo de Pagamento *"}),n.jsxs(Xt,{value:i,onValueChange:o,children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecione o mtodo"})}),n.jsx(Gt,{children:bZe.map(R=>n.jsx(qe,{value:R.value,children:R.label},R.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Comprovante *"}),n.jsx("input",{type:"file",ref:v,onChange:b,accept:"image/*",className:"hidden"}),h?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:h,alt:"Comprovante",className:"w-full h-48 object-contain border rounded-lg bg-muted"}),n.jsx(he,{variant:"outline",size:"sm",className:"absolute bottom-2 right-2",onClick:()=>{var R;return(R=v.current)==null?void 0:R.click()},children:"Trocar"})]}):n.jsxs("div",{onClick:()=>{var R;return(R=v.current)==null?void 0:R.click()},className:"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer hover:border-primary transition-colors",children:[n.jsx(Lh,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Clique para anexar foto do comprovante"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG at 5MB"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Observaes (opcional)"}),n.jsx(rs,{value:l,onChange:R=>d(R.target.value),placeholder:"Informaes adicionais sobre o pagamento...",rows:2})]})]}),n.jsxs(ba,{children:[n.jsx(he,{variant:"outline",onClick:O,children:"Cancelar"}),n.jsxs(he,{onClick:T,disabled:g||m||!i||!c,children:[(g||m)&&n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Confirmar Pagamento"]})]})]})})}function wZe({orderId:e,currentMethod:t,currentShipping:r,currentShippingService:s,subtotal:a,discounts:i,isPaid:o,isAwaitingPayment:l,customerZipCode:d,customerId:c,orderItems:u=[],onUpdateDelivery:h,onUpdateCustomerZip:f}){const[m,p]=P.useState(t),[g,x]=P.useState(t==="correios"&&r>0?r.toString():""),[v,y]=P.useState(s||""),[b,j]=P.useState(!1),[T,O]=P.useState(d||""),[R,D]=P.useState(!1),[B,q]=P.useState([]),[Y,G]=P.useState(""),[I,F]=P.useState(null),[S,E]=P.useState(!1),[N,C]=P.useState(""),k=()=>!t||t==="retirada"?t==="retirada":t==="motoboy"?r===Xs.motoboyFee:t==="correios"?r>0:!1;P.useEffect(()=>{d&&!T&&O(d)},[d]),P.useEffect(()=>{m!=="correios"&&(q([]),G(""),F(null),E(!1))},[m]);const M=se=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(se),U=async()=>{const se=T.replace(/\D/g,"");if(se.length!==8){F("CEP deve ter 8 dgitos");return}D(!0),F(null),q([]),G(""),E(!1);try{const ue=u.reduce((me,ge)=>me+ge.qtd*.3,0)||.5,pe={toZipCode:se,weight:Math.max(.3,ue),length:30,width:20,height:Math.min(100,10+u.reduce((me,ge)=>me+ge.qtd*3,0))};console.log("[DeliverySection] Calculating shipping:",pe);const{data:ce,error:ne}=await le.functions.invoke("calculate-shipping",{body:pe});if(console.log("[DeliverySection] Response:",ce),ne){console.error("[DeliverySection] Function error:",ne),F("Erro ao calcular frete. Use o frete manual."),E(!0);return}if(ce!=null&&ce.error){F(ce.error),E(!0);return}ce!=null&&ce.quotes&&ce.quotes.length>0?(q(ce.quotes),de.success("Opes de frete carregadas!")):(F("Nenhuma opo de frete disponvel para este CEP"),E(!0))}catch(ue){console.error("[DeliverySection] Exception:",ue),F("Erro de conexo. Use o frete manual."),E(!0)}finally{D(!1)}},$=se=>{G(se);const ue=B.find(pe=>pe.id===se);ue&&(x(ue.price.toString()),y(ue.name||ue.serviceName),E(!1),C(""))},X=()=>{const se=parseFloat(N.replace(",","."));if(isNaN(se)||se<=0){de.error("Informe um valor vlido");return}x(se.toString()),y("Manual"),G("")},Z=se=>{if(se==="retirada")return 0;if(se==="motoboy")return Xs.motoboyFee;if(se==="correios"){const ue=parseFloat(g.replace(",","."));return isNaN(ue)?0:ue}return 0},re=se=>{const ue=Z(se);return a-i+ue},W=()=>{if(m==="correios"){if(T.replace(/\D/g,"").length!==8)return!1;const ue=parseFloat(g.replace(",","."));return!isNaN(ue)&&ue>0}return!0},J=()=>m!==t?!0:m==="correios"?(parseFloat(g.replace(",","."))||0)!==r:m==="motoboy"&&r!==Xs.motoboyFee||m==="retirada"&&r!==0,V=()=>k()?J()&&W():W(),H=async()=>{if(!W())return;j(!0);const se=Z(m),pe=await h(e,m,se,m==="correios"?v:void 0);if(pe&&m==="correios"&&c&&f){const ce=T.replace(/\D/g,"");ce.length===8&&ce!==(d==null?void 0:d.replace(/\D/g,""))&&await f(c,ce)}j(!1),pe&&x(se.toString())},ee=se=>{p(se),se!=="correios"&&(x(""),q([]),G(""),E(!1))},ie=m==="correios"?yn:m==="motoboy"?Zl:fa,oe=m==="correios"?"Correios":m==="motoboy"?"Motoboy":"Retirada na Loja";return o?n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[n.jsx(ie,{className:"h-4 w-4"}),"Entrega: ",oe]}),n.jsxs(ke,{className:"bg-green-100 text-green-700 border-green-300",children:[n.jsx(Sr,{className:"h-3 w-3 mr-1"}),"Confirmada"]})]}),r>0&&n.jsxs("div",{className:"text-sm text-muted-foreground",children:["Frete: ",M(r),s&&` (${s})`]})]}):n.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/30",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[n.jsx(ie,{className:"h-4 w-4"}),"ETAPA 1: Forma de Envio"]}),k()?n.jsxs(ke,{className:"bg-green-100 text-green-700 border-green-300",children:[n.jsx(Sr,{className:"h-3 w-3 mr-1"}),"Confirmada"]}):n.jsxs(ke,{variant:"outline",className:"border-amber-300 text-amber-700 bg-amber-50",children:[n.jsx(Or,{className:"h-3 w-3 mr-1"}),"Pendente"]})]}),n.jsxs(Xt,{value:m,onValueChange:se=>ee(se),children:[n.jsx(Ht,{children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"retirada",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(fa,{className:"h-4 w-4"}),"Retirada na Loja (Grtis)"]})}),n.jsx(qe,{value:"motoboy",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Zl,{className:"h-4 w-4"}),"Motoboy - ",M(Xs.motoboyFee)]})}),n.jsx(qe,{value:"correios",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(yn,{className:"h-4 w-4"}),"Correios"]})})]})]}),m==="correios"&&n.jsxs("div",{className:"space-y-4 border-t pt-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{className:"flex items-center gap-2",children:[n.jsx(mo,{className:"h-4 w-4"}),"CEP de destino *"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(et,{value:Kx(T),onChange:se=>O(se.target.value.replace(/\D/g,"").slice(0,8)),placeholder:"00000-000",maxLength:9,disabled:R,className:"flex-1"}),n.jsx(he,{variant:"secondary",onClick:U,disabled:R||T.replace(/\D/g,"").length!==8,children:R?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 animate-spin mr-2"}),"Calculando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Gne,{className:"h-4 w-4 mr-2"}),"Calcular"]})})]}),T.replace(/\D/g,"").length!==8&&n.jsx("p",{className:"text-xs text-muted-foreground",children:"Informe o CEP para calcular o frete"})]}),I&&n.jsxs("div",{className:"bg-destructive/10 border border-destructive/30 rounded-lg p-3 text-sm text-destructive",children:[n.jsx(Or,{className:"h-4 w-4 inline mr-2"}),I]}),B.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{className:"flex items-center gap-2",children:[n.jsx(yn,{className:"h-4 w-4"}),"Escolha o servio"]}),n.jsx(gc,{value:Y,onValueChange:$,children:B.map(se=>n.jsxs("label",{className:He("flex items-center justify-between p-3 rounded-lg border cursor-pointer hover:bg-muted/50 transition-colors",Y===se.id?"border-primary bg-primary/5":"border-border"),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Li,{value:se.id}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:se.name||se.serviceName}),n.jsx("p",{className:"text-xs text-muted-foreground",children:se.deliveryRange?`${se.deliveryRange.min}-${se.deliveryRange.max} dias teis`:`${se.deliveryDays||se.deliveryTime} dias teis`})]})]}),n.jsx("span",{className:"font-semibold",children:M(se.price)})]},se.id))})]}),(B.length>0||I)&&n.jsx("div",{className:"pt-2 border-t",children:n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>E(!S),className:"text-muted-foreground",children:[n.jsx(ise,{className:"h-4 w-4 mr-2"}),S?"Ocultar frete manual":"Inserir frete manual"]})}),S&&n.jsxs("div",{className:"space-y-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[n.jsx(Be,{className:"text-sm text-amber-800",children:"Valor do frete (manual)"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(et,{type:"text",inputMode:"decimal",placeholder:"Ex: 25,90",value:N,onChange:se=>C(se.target.value),className:"flex-1"}),n.jsx(he,{variant:"outline",onClick:X,disabled:!N,children:"Usar"})]})]}),parseFloat(g)>0&&n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-800",children:"Frete selecionado"}),n.jsxs("p",{className:"text-sm text-green-600",children:[v||"Manual",": ",M(parseFloat(g))]})]}),n.jsx(Sr,{className:"h-5 w-5 text-green-600"})]})]}),n.jsxs("div",{className:"bg-background p-3 rounded-md space-y-1",children:[n.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[n.jsx("span",{children:"Subtotal"}),n.jsx("span",{children:M(a)})]}),i>0&&n.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[n.jsx("span",{children:"Descontos"}),n.jsxs("span",{children:["-",M(i)]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Frete"}),n.jsx("span",{className:He(Z(m)>0?"text-foreground":"text-muted-foreground"),children:Z(m)>0?M(Z(m)):"Grtis"})]}),n.jsxs("div",{className:"flex justify-between text-base font-bold pt-2 border-t",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:M(re(m))})]})]}),V()&&n.jsxs(he,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:H,disabled:!W()||b,children:[b?n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}):n.jsx(ase,{className:"h-4 w-4 mr-2"}),"Confirmar Forma de Envio"]}),k()&&!J()&&n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 flex items-center gap-3",children:[n.jsx(Sr,{className:"h-5 w-5 text-green-600 shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-green-800",children:"Entrega confirmada"}),n.jsxs("p",{className:"text-sm text-green-700",children:[m==="retirada"&&"Retirada na loja - Grtis",m==="motoboy"&&`Motoboy - ${M(Xs.motoboyFee)}`,m==="correios"&&`${s||"Correios"} - ${M(r)}`]})]})]}),l&&!k()&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-start gap-2",children:[n.jsx(Or,{className:"h-5 w-5 text-amber-500 shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-amber-800",children:[n.jsx("p",{className:"font-medium",children:"Confirme a entrega antes do pagamento"}),n.jsx("p",{className:"text-amber-700",children:m?m==="correios"&&T.replace(/\D/g,"").length!==8?"Informe o CEP de destino para calcular o frete.":m==="correios"&&parseFloat(g)===0?"Selecione uma opo de frete ou informe manualmente.":"Clique em 'Confirmar Forma de Envio' para prosseguir.":"Selecione um mtodo de entrega."})]})]})]})}function _Ze(e,t,r){return e?e==="retirada"?t===0:e==="motoboy"?t===10:e==="correios"?t>0:!1:!1}const jZe=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],KL=["name","phone","zip_code","street","number","neighborhood","city","state","document"];function TE(e){if(!e)return[...KL];const t=[];return KL.forEach(r=>{const s=e[r];(!s||s.trim()===""||r==="document"&&s.replace(/\D/g,"").length!==11)&&t.push(r)}),t}const XL={name:"Nome completo",document:"CPF",phone:"Telefone",zip_code:"CEP",street:"Rua",number:"Nmero",complement:"Complemento",neighborhood:"Bairro",city:"Cidade",state:"Estado",reference:"Referncia"};function NZe({orderId:e,customerId:t,currentData:r,customerName:s,customerPhone:a,onSaved:i,onCancel:o}){const l=r8(),[d,c]=P.useState(!1),[u,h]=P.useState({name:(r==null?void 0:r.name)||s||"",document:(r==null?void 0:r.document)||"",phone:(r==null?void 0:r.phone)||(a==null?void 0:a.replace(/\D/g,""))||"",zip_code:(r==null?void 0:r.zip_code)||"",street:(r==null?void 0:r.street)||"",number:(r==null?void 0:r.number)||"",complement:(r==null?void 0:r.complement)||"",neighborhood:(r==null?void 0:r.neighborhood)||"",city:(r==null?void 0:r.city)||"",state:(r==null?void 0:r.state)||"",reference:(r==null?void 0:r.reference)||""}),f=async()=>{const v=u.zip_code.replace(/\D/g,"");if(v.length===8){const y=await l.lookup(v);y&&h(b=>({...b,zip_code:y.cep,street:y.street||b.street,neighborhood:y.neighborhood||b.neighborhood,city:y.city||b.city,state:y.state||b.state}))}},m=(v,y)=>{h(b=>({...b,[v]:y}))},p=TE(u),g=p.length===0,x=async()=>{if(!g){de.error(`Preencha: ${p.map(v=>XL[v]).join(", ")}`);return}c(!0);try{const v=JSON.parse(JSON.stringify(u)),{error:y}=await le.from("live_carts").update({shipping_address_snapshot:v,updated_at:new Date().toISOString()}).eq("id",e);if(y)throw y;if(t){const{error:b}=await le.from("customers").update({name:u.name||void 0,phone:u.phone||void 0,address_line:`${u.street}, ${u.number}`,city:u.city,state:u.state,zip_code:u.zip_code,address_reference:u.reference||void 0,updated_at:new Date().toISOString()}).eq("id",t);b&&console.error("Failed to update customer:",b)}de.success("Dados de envio salvos!"),i()}catch(v){console.error("Error saving shipping data:",v),de.error("Erro ao salvar dados")}finally{c(!1)}};return n.jsxs("div",{className:"space-y-4",children:[p.length>0&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-start gap-2",children:[n.jsx(Or,{className:"h-4 w-4 text-amber-600 mt-0.5 shrink-0"}),n.jsxs("div",{className:"text-sm",children:[n.jsx("p",{className:"font-medium text-amber-800",children:"Campos obrigatrios faltando:"}),n.jsx("p",{className:"text-amber-700",children:p.map(v=>XL[v]).join(", ")})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{htmlFor:"name",className:"flex items-center gap-2",children:[n.jsx(Dn,{className:"h-4 w-4"}),"Nome completo *"]}),n.jsx(et,{id:"name",value:u.name,onChange:v=>m("name",v.target.value),placeholder:"Nome completo do destinatrio"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{htmlFor:"document",className:"flex items-center gap-2",children:[n.jsx(Kh,{className:"h-4 w-4"}),"CPF *"]}),n.jsx(et,{id:"document",value:u.document,onChange:v=>{const b=v.target.value.replace(/\D/g,"").slice(0,11).replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2");m("document",b)},placeholder:"000.000.000-00",className:u.document&&u.document.replace(/\D/g,"").length!==11?"border-amber-500":""}),u.document&&u.document.replace(/\D/g,"").length>0&&u.document.replace(/\D/g,"").length!==11&&n.jsx("p",{className:"text-xs text-amber-600",children:"CPF deve ter 11 dgitos"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{htmlFor:"phone",className:"flex items-center gap-2",children:[n.jsx(kl,{className:"h-4 w-4"}),"Telefone *"]}),n.jsx(et,{id:"phone",value:u.phone,onChange:v=>{const y=v.target.value.replace(/\D/g,"").slice(0,11);let b=y;y.length>2&&(b=`(${y.slice(0,2)}) ${y.slice(2)}`),y.length>7&&(b=`(${y.slice(0,2)}) ${y.slice(2,7)}-${y.slice(7)}`),m("phone",b)},placeholder:"(00) 00000-0000"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Be,{htmlFor:"zip_code",className:"flex items-center gap-2",children:[n.jsx(mo,{className:"h-4 w-4"}),"CEP *"]}),n.jsx(et,{id:"zip_code",value:Kx(u.zip_code),onChange:v=>m("zip_code",v.target.value.replace(/\D/g,"").slice(0,8)),onBlur:f,placeholder:"00000-000",maxLength:9}),l.isLoading&&n.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[n.jsx(Et,{className:"h-3 w-3 animate-spin"}),"Buscando endereo..."]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"street",children:"Rua / Avenida *"}),n.jsx(et,{id:"street",value:u.street,onChange:v=>m("street",v.target.value),placeholder:"Nome da rua"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"number",children:"Nmero *"}),n.jsx(et,{id:"number",value:u.number,onChange:v=>m("number",v.target.value),placeholder:"N"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"complement",children:"Complemento"}),n.jsx(et,{id:"complement",value:u.complement,onChange:v=>m("complement",v.target.value),placeholder:"Apto, Bloco..."})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"neighborhood",children:"Bairro *"}),n.jsx(et,{id:"neighborhood",value:u.neighborhood,onChange:v=>m("neighborhood",v.target.value),placeholder:"Bairro"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"col-span-2 space-y-2",children:[n.jsx(Be,{htmlFor:"city",children:"Cidade *"}),n.jsx(et,{id:"city",value:u.city,onChange:v=>m("city",v.target.value),placeholder:"Cidade"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{children:"Estado *"}),n.jsxs(Xt,{value:u.state,onValueChange:v=>m("state",v),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"UF"})}),n.jsx(Gt,{children:jZe.map(v=>n.jsx(qe,{value:v,children:v},v))})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{htmlFor:"reference",children:"Ponto de referncia"}),n.jsx(et,{id:"reference",value:u.reference,onChange:v=>m("reference",v.target.value),placeholder:"Prximo a..."})]}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[o&&n.jsx(he,{variant:"outline",onClick:o,className:"flex-1",children:"Cancelar"}),n.jsx(he,{onClick:x,disabled:!g||d,className:He("flex-1",g&&"bg-green-600 hover:bg-green-700"),children:d?n.jsxs(n.Fragment,{children:[n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(uu,{className:"h-4 w-4 mr-2"}),"Salvar Dados de Envio"]})})]})]})}const SZe=e=>/^[A-Z]{2}\d{9}BR$/.test(e),CZe=e=>/^\d{8,20}$/.test(e),YL=e=>!e||e.startsWith("ORD-")||e.startsWith("ORD")?!1:SZe(e)||CZe(e);function EZe({order:e,sellers:t,isAdmin:r,onClose:s,onAssignSeller:a,onMarkAsPaid:i,onMarkAsPaidWithProof:o,onMarkAsPosted:l,onMarkAsDelivered:d,onMarkAsPickedUp:c,onGenerateLabel:u,onUpdateDeliveryMethod:h,onUpdateDeliveryWithShipping:f,onUpdateCustomerZipCode:m,onRecordCharge:p,onApprovePayment:g,onRejectPayment:x,onRevertStatus:v,onTrackingSynced:y,chargeHistory:b=[]}){var _e,be,ye,Oe,Ne,De,Ge,Qe,Ie;const[j,T]=P.useState(!1),[O,R]=P.useState(!1),[D,B]=P.useState(!1),[q,Y]=P.useState(!1),[G,I]=P.useState(""),[F,S]=P.useState(!1),[E,N]=P.useState(0),[C,k]=P.useState(!1);if(!e)return null;const M=Ae=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Ae),U=e.status==="pago",$=e.status==="aguardando_pagamento"||e.status==="aberto",X=e.operational_status==="aguardando_retorno",Z=e.status==="cancelado",re=(Date.now()-new Date(e.created_at).getTime())/(1e3*60*60),W=($||X)&&re>24,J=()=>{const Ae=`${window.location.origin}/live-checkout/${e.id}`;return e.public_token?`${Ae}?token=${e.public_token}`:Ae},V=()=>{const Ae=e.live_customer;if(!(Ae!=null&&Ae.whatsapp))return null;const st=J(),nt=Fx(st);return po(Ae.whatsapp,nt)},H=async()=>{const Ae=J(),st=Fx(Ae);await af(st)?de.success("Mensagem copiada "):de.error("Erro ao copiar. Tente selecionar o texto manualmente.")},ee=async Ae=>{p&&(await p(e.id,Ae,!0),de.success("Cobrana registrada!"))},ie=()=>{var st,nt;const Ae=(nt=(st=e.live_customer)==null?void 0:st.instagram_handle)==null?void 0:nt.replace(/@/g,"").trim();return Ae?`https://www.instagram.com/${Ae}`:null},oe=()=>{const Ae=e.live_customer;if(!(Ae!=null&&Ae.whatsapp))return null;const st=`Ol${Ae.nome?` ${Ae.nome.split(" ")[0]}`:""}! 

Para enviar seu pedido da sacola #${e.bag_number}, preciso dos dados de entrega:

 Nome completo
 CEP
 Endereo completo (rua, nmero, complemento)
 Telefone

Pode me enviar? `;return po(Ae.whatsapp,st)},se=async(Ae,st,nt)=>{const vt=await o(e.id,Ae,st,nt);return vt&&R(!1),vt},ue=async()=>{T(!0);const Ae=await u(e.id);T(!1),Ae.success&&Ae.labelUrl?(window.open(Ae.labelUrl,"_blank"),de.success("Etiqueta gerada com sucesso!")):Ae.error&&(Ae.error.includes("incompletos")?(S(!0),de.error("Complete os dados de envio para gerar a etiqueta",{description:Ae.error,duration:5e3})):de.error(Ae.error))},pe=async()=>{if(e){k(!0);try{const{data:Ae,error:st}=await le.functions.invoke("sync-live-cart-tracking",{body:{cartId:e.id}});if(st){console.error("Sync tracking error:",st),de.error("Erro ao sincronizar rastreio");return}if(Ae.error){Ae.status==="tracking_not_found"?de.info("Cdigo de rastreio ainda no disponvel",{description:"Pode levar alguns minutos aps a compra da etiqueta. Tente novamente em breve."}):de.error(Ae.error);return}Ae.success&&Ae.tracking_code&&(de.success(`Rastreio sincronizado: ${Ae.tracking_code}`),y&&y(e.id,Ae.tracking_code))}catch(Ae){console.error("Sync tracking error:",Ae),de.error("Erro ao sincronizar rastreio")}finally{k(!1)}}},ce=async Ae=>{if(!v)return;if(r&&!G.trim()){de.error("Informe o motivo da reverso");return}await v(e.id,Ae,G)&&(Y(!1),I(""))},ne=()=>{const Ae=e.operational_status,st=[];return(Ae==="entregue"||Ae==="retirado")&&(e.delivery_method==="correios"&&st.push("postado"),e.delivery_method==="motoboy"&&st.push("em_rota"),e.delivery_method==="retirada"&&st.push("retirada")),Ae==="postado"&&st.push("etiqueta_gerada"),Ae==="etiqueta_gerada"&&st.push("preparar_envio"),(Ae==="preparar_envio"||Ae==="em_rota"||Ae==="retirada")&&st.push("pago"),Ae==="pago"&&r&&st.push("aguardando_retorno","aguardando_pagamento"),Ae==="aguardando_retorno"&&st.push("aguardando_pagamento"),st},me=e.delivery_method==="correios"?yn:e.delivery_method==="motoboy"?Zl:fa,ge=e.delivery_method==="correios"?"Correios":e.delivery_method==="motoboy"?"Motoboy":"Retirada na Loja";return n.jsxs(_u,{open:!!e,onOpenChange:()=>s(),children:[n.jsxs(rd,{className:"w-full sm:max-w-lg overflow-hidden flex flex-col p-0 max-w-[100vw]",children:[n.jsxs(ju,{className:"shrink-0 p-3 sm:p-6 pb-2 sm:pb-4",children:[n.jsx("div",{className:"flex items-start justify-between gap-2 pr-6",children:n.jsxs(Zh,{className:"flex items-center gap-2 flex-wrap min-w-0",children:[n.jsxs(ke,{variant:"secondary",className:"text-sm sm:text-lg px-2 sm:px-3 shrink-0",children:["#",e.bag_number]}),n.jsxs("span",{className:"text-sm truncate",children:["@",(_e=e.live_customer)==null?void 0:_e.instagram_handle]})]})}),((be=e.live_customer)==null?void 0:be.nome)&&n.jsx("p",{className:"text-sm text-muted-foreground truncate",children:e.live_customer.nome})]}),n.jsx(gi,{className:"flex-1 px-3 sm:px-6",children:n.jsxs("div",{className:"space-y-6 pb-6",children:[n.jsxs("div",{className:"flex flex-wrap gap-2",children:[Z&&n.jsx(ke,{variant:"destructive",children:"Cancelado"}),$&&!X&&n.jsxs(ke,{variant:"outline",className:"border-amber-300 text-amber-700 bg-amber-50",children:[n.jsx(Lr,{className:"h-3 w-3 mr-1"}),"Aguardando Pagamento"]}),X&&n.jsxs(ke,{variant:"outline",className:"border-orange-300 text-orange-700 bg-orange-50",children:[n.jsx(Lr,{className:"h-3 w-3 mr-1"}),"Aguardando Retorno"]}),U&&e.operational_status==="pago"&&n.jsxs(ke,{variant:"outline",className:"border-green-300 text-green-700 bg-green-50",children:[n.jsx(Sr,{className:"h-3 w-3 mr-1"}),"Pago"]}),e.operational_status==="preparar_envio"&&n.jsx(ke,{variant:"outline",className:"border-blue-300 text-blue-700 bg-blue-50",children:"Preparar Envio"}),e.operational_status==="etiqueta_gerada"&&n.jsx(ke,{variant:"outline",className:"border-indigo-300 text-indigo-700 bg-indigo-50",children:"Etiqueta Gerada"}),e.operational_status==="postado"&&n.jsx(ke,{variant:"outline",className:"border-purple-300 text-purple-700 bg-purple-50",children:"Postado"}),e.operational_status==="em_rota"&&n.jsxs(ke,{variant:"outline",className:"border-cyan-300 text-cyan-700 bg-cyan-50",children:[n.jsx(Zl,{className:"h-3 w-3 mr-1"}),"Em Rota"]}),e.operational_status==="retirada"&&n.jsxs(ke,{variant:"outline",className:"border-teal-300 text-teal-700 bg-teal-50",children:[n.jsx(fa,{className:"h-3 w-3 mr-1"}),"Aguardando Retirada"]}),(e.operational_status==="entregue"||e.operational_status==="retirado")&&n.jsxs(ke,{variant:"outline",className:"border-emerald-300 text-emerald-700 bg-emerald-50",children:[n.jsx(Sr,{className:"h-3 w-3 mr-1"}),"Entregue"]}),e.is_raffle_winner&&n.jsxs(ke,{className:"bg-yellow-100 text-yellow-800 border-yellow-300",children:[n.jsx(ma,{className:"h-3 w-3 mr-1"}),e.raffle_name||"Sorteio"]}),W&&n.jsxs(ke,{variant:"destructive",children:[n.jsx(Or,{className:"h-3 w-3 mr-1"}),"+",Math.floor(re),"h pendente"]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-sm font-medium",children:"Vendedora Responsvel"}),n.jsxs(Xt,{value:e.seller_id||"unassigned",onValueChange:Ae=>a(e.id,Ae==="unassigned"?null:Ae),children:[n.jsx(Ht,{children:n.jsx(Yt,{placeholder:"Selecionar vendedora"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"unassigned",children:"Nenhuma"}),t.map(Ae=>n.jsx(qe,{value:Ae.id,children:Ae.name},Ae.id))]})]})]}),n.jsx(Ca,{}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("h4",{className:"font-medium",children:"Itens do Pedido"}),(ye=e.items)==null?void 0:ye.map(Ae=>{var st,nt,vt,Je;return n.jsxs("div",{className:He("flex items-center gap-3 p-2 rounded-lg border",Ae.status==="cancelado"&&"opacity-50 bg-muted"),children:[(st=Ae.product)!=null&&st.image_url?n.jsx("img",{src:Ae.product.image_url,alt:"",className:"w-12 h-12 rounded object-cover"}):n.jsx("div",{className:"w-12 h-12 rounded bg-muted flex items-center justify-center",children:n.jsx(Vt,{className:"h-5 w-5 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-sm truncate",children:(nt=Ae.product)==null?void 0:nt.name}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[n.jsx("span",{children:((vt=Ae.variante)==null?void 0:vt.tamanho)||"-"}),((Je=Ae.product)==null?void 0:Je.color)&&n.jsxs("span",{children:[" ",Ae.product.color]}),n.jsxs("span",{children:[" x",Ae.qtd]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-medium",children:M(Ae.preco_unitario*Ae.qtd)}),Ae.status==="cancelado"&&n.jsx(ke,{variant:"destructive",className:"text-xs",children:"Cancelado"})]})]},Ae.id)})]}),n.jsx(Ca,{}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),n.jsx("span",{children:M(e.subtotal)})]}),e.descontos>0&&n.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[n.jsx("span",{children:"Descontos"}),n.jsxs("span",{children:["-",M(e.descontos)]})]}),e.frete>0&&n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Frete"}),n.jsx("span",{children:M(e.frete)})]}),n.jsxs("div",{className:"flex justify-between text-lg font-bold pt-2 border-t",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:M(e.total)})]})]}),n.jsx(Ca,{}),($||X)&&!Z&&n.jsx(wZe,{orderId:e.id,currentMethod:e.delivery_method,currentShipping:e.frete,currentShippingService:e.shipping_service_name,subtotal:e.subtotal,discounts:e.descontos,isPaid:U,isAwaitingPayment:$||X,customerZipCode:(Oe=e.shipping_address_snapshot)==null?void 0:Oe.zip_code,customerId:(Ne=e.live_customer)==null?void 0:Ne.client_id,orderItems:((De=e.items)==null?void 0:De.map(Ae=>({qtd:Ae.qtd,product_id:Ae.product_id})))||[],onUpdateDelivery:f,onUpdateCustomerZip:m}),U&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[n.jsx(me,{className:"h-4 w-4"}),"Entrega: ",ge]}),n.jsxs(ke,{className:"bg-green-100 text-green-700 border-green-300",children:[n.jsx(Sr,{className:"h-3 w-3 mr-1"}),"Confirmada"]})]}),e.frete>0&&n.jsxs("div",{className:"text-sm text-muted-foreground",children:["Frete: ",M(e.frete)]}),e.delivery_method==="correios"&&n.jsx("div",{className:"bg-muted/50 rounded-lg p-3 space-y-2",children:(()=>{var vt,Je,Ue,Le,Ze;const Ae=e.shipping_address_snapshot,nt=TE(Ae).length===0;return F||!nt?n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h4",{className:"font-medium text-amber-700 flex items-center gap-2",children:[n.jsx(Or,{className:"h-4 w-4"}),"Completar dados de envio"]}),nt&&n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>S(!1),children:n.jsx(sn,{className:"h-4 w-4"})})]}),n.jsx(NZe,{orderId:e.id,customerId:(vt=e.live_customer)==null?void 0:vt.client_id,currentData:Ae,customerName:(Je=e.live_customer)==null?void 0:Je.nome,customerPhone:(Ue=e.live_customer)==null?void 0:Ue.whatsapp,onSaved:()=>{S(!1),N(ct=>ct+1)},onCancel:nt?()=>S(!1):void 0}),((Le=e.live_customer)==null?void 0:Le.whatsapp)&&n.jsx("div",{className:"pt-2 border-t",children:n.jsx(he,{variant:"ghost",size:"sm",className:"text-muted-foreground w-full",asChild:!0,children:n.jsxs("a",{href:oe()||"#",target:"_blank",rel:"noopener noreferrer",children:[n.jsx(nn,{className:"h-4 w-4 mr-2"}),"Solicitar via WhatsApp"]})})})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(mo,{className:"h-4 w-4 text-muted-foreground shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm",children:[n.jsx("p",{className:"font-medium",children:(Ae==null?void 0:Ae.name)||((Ze=e.live_customer)==null?void 0:Ze.nome)}),n.jsxs("p",{children:[Ae==null?void 0:Ae.street,", ",Ae==null?void 0:Ae.number]}),(Ae==null?void 0:Ae.complement)&&n.jsx("p",{children:Ae.complement}),n.jsx("p",{children:Ae==null?void 0:Ae.neighborhood}),n.jsxs("p",{children:[Ae==null?void 0:Ae.city,"/",Ae==null?void 0:Ae.state]}),n.jsxs("p",{className:"font-medium",children:["CEP: ",Ae==null?void 0:Ae.zip_code]}),(Ae==null?void 0:Ae.phone)&&n.jsxs("p",{className:"text-muted-foreground",children:["Tel: ",Ae.phone]})]})]}),n.jsx(he,{variant:"ghost",size:"icon",className:"shrink-0",onClick:()=>S(!0),children:n.jsx(Ql,{className:"h-4 w-4"})})]}),(()=>{const ct=YL(e.shipping_tracking_code),ht=!!e.me_label_url||!!e.me_shipment_id;return ht||e.shipping_tracking_code?n.jsx("div",{className:"pt-3 mt-3 border-t space-y-2",children:ct?n.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(yn,{className:"h-4 w-4 text-purple-600"}),n.jsx("span",{className:"text-sm font-medium text-purple-800",children:"Cdigo de rastreio"})]}),n.jsx("p",{className:"font-mono text-lg text-purple-900",children:e.shipping_tracking_code}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 border-purple-200 text-purple-700 hover:bg-purple-100",onClick:async()=>{await navigator.clipboard.writeText(e.shipping_tracking_code),de.success("Cdigo copiado!")},children:[n.jsx(Wa,{className:"h-3 w-3"}),"Copiar"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 border-purple-200 text-purple-700 hover:bg-purple-100",onClick:()=>{window.open(`https://rastreamento.correios.com.br/app/index.php?objeto=${e.shipping_tracking_code}`,"_blank")},children:[n.jsx(Zs,{className:"h-3 w-3"}),"Rastrear nos Correios"]})]})]}):ht?n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[n.jsx(Or,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm font-medium",children:"Etiqueta gerada, aguardando rastreio"})]}),n.jsx("p",{className:"text-xs text-amber-600",children:"O cdigo de rastreio pode levar alguns minutos para ficar disponvel aps a compra da etiqueta."}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 border-amber-300 text-amber-700 hover:bg-amber-100",onClick:pe,disabled:C,children:[C?n.jsx(Et,{className:"h-3 w-3 animate-spin"}):n.jsx(Qr,{className:"h-3 w-3"}),"Sincronizar Rastreio"]})]}):null}):null})()]})})()},E)]}),n.jsx(yZe,{order:e,isAdmin:r,onApprove:g,onReject:x}),b.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Ca,{}),n.jsx("h4",{className:"font-medium text-sm",children:"Histrico de Cobranas"}),n.jsx("div",{className:"space-y-1",children:b.map((Ae,st)=>n.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[n.jsx("span",{className:"capitalize",children:Ae.channel==="whatsapp"?" WhatsApp":" Direct"}),n.jsx("span",{children:""}),n.jsx("span",{children:Wt(new Date(Ae.created_at),"dd/MM HH:mm",{locale:mr})})]},st))})]}),(e.customer_checkout_notes||e.customer_live_notes||e.delivery_notes)&&n.jsxs(n.Fragment,{children:[n.jsx(Ca,{}),n.jsxs("div",{className:"space-y-3",children:[e.customer_checkout_notes&&n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2 text-blue-700 mb-2",children:[n.jsx(nn,{className:"h-4 w-4"}),"Observao do cliente"]}),n.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:e.customer_checkout_notes})]}),e.customer_live_notes&&n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2 text-purple-700 mb-2",children:[n.jsx(nn,{className:"h-4 w-4"}),"Obs. da Live"]}),n.jsx("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg text-sm",children:e.customer_live_notes})]}),e.delivery_notes&&e.delivery_method==="motoboy"&&n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2 text-amber-700 mb-2",children:[n.jsx(Zl,{className:"h-4 w-4"}),"Instrues de entrega"]}),n.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg text-sm",children:[e.delivery_notes,e.delivery_period&&n.jsxs("p",{className:"mt-1 text-xs text-amber-600",children:["Perodo: ",e.delivery_period==="manha"?"Manh":e.delivery_period==="tarde"?"Tarde":"Qualquer horrio"]})]})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[((Ge=e.live_customer)==null?void 0:Ge.whatsapp)&&n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(kl,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{children:e.live_customer.whatsapp})]}),ie()&&n.jsxs("a",{href:ie(),target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[n.jsx(Zs,{className:"h-3 w-3"}),iw(((Qe=e.live_customer)==null?void 0:Qe.instagram_handle)||"")]})]}),n.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[n.jsxs("p",{children:["Criado: ",Wt(new Date(e.created_at),"dd/MM/yyyy 's' HH:mm",{locale:mr})]}),n.jsxs("p",{children:["Atualizado: ",Wt(new Date(e.updated_at),"dd/MM/yyyy 's' HH:mm",{locale:mr})]}),e.last_charge_at&&n.jsxs("p",{children:["ltima cobrana: ",Wt(new Date(e.last_charge_at),"dd/MM HH:mm",{locale:mr})]}),e.label_printed_at&&n.jsxs("p",{children:["Etiqueta impressa: ",Wt(new Date(e.label_printed_at),"dd/MM HH:mm",{locale:mr})]})]})]})}),n.jsxs("div",{className:"shrink-0 border-t pt-4 space-y-3",children:[($||X)&&!Z&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex gap-2",children:[((Ie=e.live_customer)==null?void 0:Ie.whatsapp)&&n.jsx(he,{variant:"outline",className:"flex-1",asChild:!0,children:n.jsxs("a",{href:V()||"#",target:"_blank",rel:"noopener noreferrer",children:[n.jsx(nn,{className:"h-4 w-4 mr-2"}),X?"Cobrar novamente":"Cobrar WhatsApp"]})}),n.jsxs(he,{variant:"outline",onClick:H,children:[n.jsx(Wa,{className:"h-4 w-4 mr-2"}),"Copiar Mensagem"]})]}),ie()&&n.jsx(he,{variant:"outline",className:"w-full",asChild:!0,children:n.jsxs("a",{href:ie(),target:"_blank",rel:"noopener noreferrer",children:[n.jsx(Zs,{className:"h-4 w-4 mr-2"}),"Abrir Instagram para Direct"]})}),p&&n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{variant:"outline",className:"flex-1 border-amber-300 text-amber-700 hover:bg-amber-50",onClick:()=>ee("whatsapp"),children:"Registrar via WhatsApp"}),n.jsx(he,{variant:"outline",className:"flex-1 border-purple-300 text-purple-700 hover:bg-purple-50",onClick:()=>ee("direct"),children:"Registrar via Direct"})]})]}),n.jsx(Ca,{}),(()=>{const Ae=_Ze(e.delivery_method,e.frete);return n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"font-medium text-sm",children:"ETAPA 2: Confirmar Pagamento"}),Ae?n.jsxs(ke,{className:"bg-green-100 text-green-700 border-green-300 text-xs",children:[n.jsx(Sr,{className:"h-3 w-3 mr-1"}),"Liberado"]}):n.jsxs(ke,{variant:"outline",className:"border-gray-300 text-gray-500 text-xs",children:[n.jsx(Or,{className:"h-3 w-3 mr-1"}),"Aguardando Etapa 1"]})]}),n.jsxs(he,{className:"w-full bg-emerald-600 hover:bg-emerald-700 disabled:opacity-50",onClick:()=>R(!0),disabled:!Ae,children:[n.jsx(ks,{className:"h-4 w-4 mr-2"}),"Marcar como Pago (com comprovante)"]}),!Ae&&n.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-2 flex items-center gap-2 text-xs",children:[n.jsx(ES,{className:"h-4 w-4 text-gray-500 shrink-0"}),n.jsx("span",{className:"text-gray-600",children:"Complete a Etapa 1 (Confirmar forma de envio) para liberar o pagamento"})]}),n.jsxs(he,{variant:"outline",className:"w-full gap-2 border-amber-300 text-amber-700 hover:bg-amber-50",onClick:()=>B(!0),children:[n.jsx(Qr,{className:"h-4 w-4"}),"Revalidar Pagamento MP"]})]})})()]}),U&&!Z&&e.payment_review_status!=="pending_review"&&(()=>{const Ae=e.operational_status,st=e.delivery_method;return Ae==="entregue"||Ae==="retirado"?null:n.jsxs("div",{className:"space-y-3",children:[n.jsx(Ca,{}),st==="correios"&&n.jsxs(n.Fragment,{children:[(Ae==="pago"||Ae==="preparar_envio")&&(()=>{const vt=e.shipping_address_snapshot,Ue=TE(vt).length===0;return n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Prximo passo: Gerar etiqueta Melhor Envio"}),n.jsxs(he,{className:"w-full",onClick:ue,disabled:j||!Ue,children:[j?n.jsx(Et,{className:"h-4 w-4 mr-2 animate-spin"}):n.jsx(ua,{className:"h-4 w-4 mr-2"}),"Gerar Etiqueta"]}),!Ue&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-2 space-y-2",children:[n.jsxs("div",{className:"text-xs text-amber-700 flex items-center gap-1",children:[n.jsx(Or,{className:"h-3 w-3"}),"Complete os dados de envio acima para gerar a etiqueta"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"w-full border-amber-300 text-amber-700 hover:bg-amber-100",onClick:()=>S(!0),children:[n.jsx(Ql,{className:"h-3 w-3 mr-2"}),"Completar dados de envio"]})]})]})})(),Ae==="etiqueta_gerada"&&e.me_label_url&&n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{variant:"outline",className:"flex-1",asChild:!0,children:n.jsxs("a",{href:e.me_label_url,target:"_blank",rel:"noopener noreferrer",children:[n.jsx(Gv,{className:"h-4 w-4 mr-2"}),"Imprimir Etiqueta"]})}),n.jsxs(he,{className:"flex-1",onClick:()=>l(e.id),children:[n.jsx(yn,{className:"h-4 w-4 mr-2"}),"Marcar Postado"]})]}),Ae==="postado"&&(YL(e.shipping_tracking_code)?n.jsxs(he,{className:"w-full bg-emerald-600 hover:bg-emerald-700",onClick:()=>d(e.id),children:[n.jsx(Sr,{className:"h-4 w-4 mr-2"}),"Marcar como Entregue"]}):n.jsx("div",{className:"space-y-2",children:n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[n.jsx(Or,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm font-medium",children:"Aguardando cdigo de rastreio"})]}),n.jsx("p",{className:"text-xs text-amber-600",children:"No  possvel marcar como entregue sem um cdigo de rastreio vlido."}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 border-amber-300 text-amber-700 hover:bg-amber-100 w-full",onClick:pe,disabled:C,children:[C?n.jsx(Et,{className:"h-3 w-3 animate-spin"}):n.jsx(Qr,{className:"h-3 w-3"}),"Sincronizar Rastreio"]})]})}))]}),st==="motoboy"&&n.jsxs(n.Fragment,{children:[Ae==="pago"&&n.jsxs(he,{className:"w-full",onClick:()=>d(e.id),children:[n.jsx(Zl,{className:"h-4 w-4 mr-2"}),"Marcar Em Rota"]}),Ae==="em_rota"&&n.jsxs(he,{className:"w-full bg-emerald-600 hover:bg-emerald-700",onClick:()=>d(e.id),children:[n.jsx(Sr,{className:"h-4 w-4 mr-2"}),"Marcar como Entregue"]})]}),st==="retirada"&&n.jsxs(n.Fragment,{children:[Ae==="pago"&&n.jsxs(he,{className:"w-full",onClick:()=>c(e.id),children:[n.jsx(fa,{className:"h-4 w-4 mr-2"}),"Marcar Aguardando Retirada"]}),Ae==="retirada"&&n.jsxs(he,{className:"w-full bg-emerald-600 hover:bg-emerald-700",onClick:()=>c(e.id),children:[n.jsx(Sr,{className:"h-4 w-4 mr-2"}),"Marcar como Retirado"]})]})]})})(),v&&ne().length>0&&!Z&&n.jsx("div",{className:"pt-2 border-t border-border/40",children:q?n.jsxs("div",{className:"space-y-2",children:[n.jsx(Be,{className:"text-sm",children:"Voltar para:"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:ne().map(Ae=>n.jsx(he,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>ce(Ae),children:Ae.replace(/_/g," ")},Ae))}),r&&n.jsx(et,{placeholder:"Motivo da reverso (obrigatrio para admin)",value:G,onChange:Ae=>I(Ae.target.value),className:"text-sm"}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>{Y(!1),I("")},children:"Cancelar"})]}):n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full text-muted-foreground hover:text-foreground",onClick:()=>Y(!0),children:[n.jsx(gse,{className:"h-4 w-4 mr-2"}),"Voltar Status"]})})]})]}),n.jsx(XJ,{open:O,onClose:()=>R(!1),orderId:e.id,orderTotal:e.total,onConfirm:se}),n.jsx(BW,{open:D,onClose:()=>B(!1),onSuccess:s,liveCartId:e.id})]})}function kZe({isOpen:e,onClose:t,message:r,phone:s}){const a=async()=>{await af(r),de.success("Mensagem copiada!")},i=s.replace(/^55(\d{2})(\d{5})(\d{4})$/,"($1) $2-$3"),o=()=>{const l=encodeURIComponent(r),d=`https://wa.me/${s}?text=${l}`;window.location.href=d};return n.jsx(tn,{open:e,onOpenChange:t,children:n.jsxs(Jr,{className:"max-w-md",children:[n.jsxs(ln,{children:[n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(nn,{className:"h-5 w-5 text-whatsapp"}),"WhatsApp"]}),n.jsx(Vo,{children:"O WhatsApp no pde ser aberto automaticamente. Copie a mensagem abaixo e envie manualmente."})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[n.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Nmero da loja:"}),n.jsx("p",{className:"font-mono text-lg",children:i})]}),n.jsxs("div",{className:"p-3 bg-muted rounded-lg max-h-48 overflow-y-auto",children:[n.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Mensagem:"}),n.jsx("p",{className:"text-sm whitespace-pre-wrap",children:r})]})]}),n.jsxs(ba,{className:"flex-col sm:flex-row gap-2",children:[n.jsxs(he,{variant:"outline",onClick:o,className:"gap-2",children:[n.jsx(Zs,{className:"h-4 w-4"}),"Tentar novamente"]}),n.jsxs(he,{onClick:a,className:"btn-whatsapp gap-2",children:[n.jsx(Wa,{className:"h-4 w-4"}),"Copiar mensagem"]})]})]})})}function AZe({open:e,onClose:t,orders:r,onRecordCharge:s}){const[a,i]=P.useState(new Set),[o,l]=P.useState("whatsapp"),[d,c]=P.useState(!1),[u,h]=P.useState(0),[f,m]=P.useState(new Set),[p,g]=P.useState(new Set),[x,v]=P.useState({open:!1,message:"",phone:""}),[y,b]=P.useState(r),[j,T]=P.useState(null),[O,R]=P.useState("");P.useEffect(()=>{b(r)},[r]),P.useEffect(()=>{e&&(i(new Set(r.map($=>$.id))),m(new Set),g(new Set),h(0),T(null))},[e,r]);const D=$=>{var X;T($.id),R(((X=$.live_customer)==null?void 0:X.whatsapp)||"")},B=async $=>{if(!O.trim())return;const{error:X}=await le.from("live_customers").update({whatsapp:O}).eq("id",$.live_customer.id);if(X){de.error("Erro ao salvar telefone");return}b(Z=>Z.map(re=>re.id===$.id?{...re,live_customer:{...re.live_customer,whatsapp:O}}:re)),i(Z=>new Set([...Z,$.id])),T(null),de.success("Telefone salvo!")},q=$=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format($),Y=$=>{const X=new Set(a);X.has($)?X.delete($):X.add($),i(X)},G=()=>{a.size===r.length?i(new Set):i(new Set(r.map($=>$.id)))},I=y.filter($=>a.has($.id)),F=$=>{const X=`${window.location.origin}/live-checkout/${$.id}`;return $.public_token?`${X}?token=${$.public_token}`:X},S=$=>Fx(F($),$.bag_number||void 0),E=async()=>{const $=I.filter(X=>{var Z;return(Z=X.live_customer)==null?void 0:Z.whatsapp});if($.length===0){de.error("Nenhum pedido selecionado tem WhatsApp");return}c(!0),h(0);for(let X=0;X<$.length;X++){const Z=$[X],re=S(Z),W=po(Z.live_customer.whatsapp,re);try{window.open(W,"_blank")}catch{v({open:!0,message:re,phone:Z.live_customer.whatsapp})}await s(Z.id,"whatsapp",!0),h(X+1),X<$.length-1&&await new Promise(J=>setTimeout(J,600))}c(!1),de.success(`${$.length} cobranas registradas!`)},N=async($,X)=>{const Z=S($);await navigator.clipboard.writeText(Z),m(re=>new Set([...re,X])),de.success("Mensagem copiada!")},C=async $=>{const X=F($);await navigator.clipboard.writeText(X),de.success("Link copiado!")},k=async($,X)=>{await s($.id,"direct",!0),g(Z=>new Set([...Z,X])),de.success("Cobrana registrada!")},M=p.size,U=r.filter($=>{var X;return(X=$.live_customer)==null?void 0:X.whatsapp}).length;return n.jsxs(n.Fragment,{children:[n.jsx(tn,{open:e,onOpenChange:()=>t(),children:n.jsxs(Jr,{className:"max-w-2xl max-h-[85vh] flex flex-col",children:[n.jsxs(ln,{children:[n.jsxs(rn,{className:"flex items-center gap-2",children:[n.jsx(yf,{className:"h-5 w-5"}),"Cobrar Pendentes",n.jsxs(ke,{variant:"secondary",children:[r.length," pedidos"]})]}),n.jsxs(Vo,{className:"text-muted-foreground",children:["Envie cobranas elegantes com link de pagamento. O modal ",n.jsx("strong",{children:"no fecha"})," ao copiar."]})]}),n.jsxs(Hi,{value:o,onValueChange:$=>l($),children:[n.jsxs(Si,{className:"grid w-full grid-cols-2",children:[n.jsxs(br,{value:"whatsapp",className:"flex items-center gap-2",children:[n.jsx(nn,{className:"h-4 w-4"}),"WhatsApp (",U,")"]}),n.jsxs(br,{value:"direct",className:"flex items-center gap-2",children:[n.jsx(ez,{className:"h-4 w-4"}),"Direct (",r.length,")"]})]}),n.jsx(kr,{value:"whatsapp",className:"mt-4",children:n.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-3 text-sm text-emerald-800",children:[n.jsx("p",{className:"font-medium mb-1",children:" Via WhatsApp"}),n.jsx("p",{className:"text-emerald-700",children:"Abre o WhatsApp para cada cliente selecionado. Se bloqueado, copie a mensagem manualmente."})]})}),n.jsx(kr,{value:"direct",className:"mt-4",children:n.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 text-sm text-purple-800",children:[n.jsx("p",{className:"font-medium mb-1",children:" Via Direct Instagram"}),n.jsx("p",{className:"text-purple-700",children:'Para cada cliente: copie a mensagem  abra o perfil  envie  clique em "Registrar".'})]})})]}),o==="whatsapp"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center gap-2 py-2 border-b mt-2",children:[n.jsx(Va,{checked:a.size===r.length,onCheckedChange:G}),n.jsxs("span",{className:"text-sm font-medium",children:["Selecionar todos (",a.size,"/",r.length,")"]}),n.jsxs("span",{className:"ml-auto text-sm text-muted-foreground",children:["Total: ",q(I.reduce(($,X)=>$+X.total,0))]})]}),n.jsx(gi,{className:"flex-1 min-h-[200px] max-h-[300px]",children:n.jsx("div",{className:"space-y-2 pr-4",children:y.map($=>{var re,W,J;const X=!!((re=$.live_customer)!=null&&re.whatsapp),Z=j===$.id;return n.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${!X&&!Z?"opacity-90 bg-muted/30":"hover:bg-muted/50"}`,children:[n.jsx(Va,{checked:a.has($.id),onCheckedChange:()=>Y($.id),disabled:!X&&!Z}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(ke,{variant:"outline",className:"font-mono text-xs",children:["#",$.bag_number]}),n.jsx("span",{className:"font-medium truncate",children:iw(((W=$.live_customer)==null?void 0:W.instagram_handle)||"")})]}),Z?n.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[n.jsx(et,{value:O,onChange:V=>R(V.target.value),placeholder:"1199...",className:"h-7 text-xs w-32 bg-white",autoFocus:!0,onKeyDown:V=>{V.key==="Enter"&&B($),V.key==="Escape"&&T(null)}}),n.jsx(he,{size:"icon",variant:"ghost",className:"h-7 w-7 text-emerald-600 hover:text-emerald-700 hover:bg-emerald-100",onClick:()=>B($),children:n.jsx(uu,{className:"h-4 w-4"})}),n.jsx(he,{size:"icon",variant:"ghost",className:"h-7 w-7 text-muted-foreground hover:bg-muted",onClick:()=>T(null),children:n.jsx(sn,{className:"h-4 w-4"})})]}):n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1 h-7",children:[X?n.jsxs("span",{className:"text-emerald-600 flex items-center gap-1 bg-emerald-50 px-2 py-0.5 rounded-full border border-emerald-100",children:[" ",(J=$.live_customer)==null?void 0:J.whatsapp,n.jsx("button",{onClick:()=>D($),className:"ml-1 text-emerald-400 hover:text-emerald-700 p-0.5 rounded-full hover:bg-emerald-100 transition-colors",title:"Editar",children:n.jsx(Js,{className:"h-3 w-3"})})]}):n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-rose-600 font-medium flex items-center gap-1 bg-rose-50 px-2 py-0.5 rounded-full border border-rose-100",children:[n.jsx(Or,{className:"h-3 w-3"}),"Sem WhatsApp"]}),n.jsx(he,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs border-dashed text-muted-foreground hover:text-foreground hover:border-solid hover:bg-white transition-all",onClick:()=>D($),children:"+ Adicionar"})]}),$.charge_attempts>0&&n.jsxs("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded text-[10px] font-medium",children:[" ",$.charge_attempts,"x cobrada"]})]})]}),n.jsx("span",{className:"font-bold text-sm",children:q($.total)})]},$.id)})})}),n.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:u>0&&`${u} enviadas`}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{variant:"outline",onClick:t,children:"Fechar"}),n.jsx(he,{onClick:E,disabled:d||I.filter($=>{var X;return(X=$.live_customer)==null?void 0:X.whatsapp}).length===0,className:"bg-emerald-600 hover:bg-emerald-700",children:d?n.jsxs(n.Fragment,{children:["Enviando ",u,"/",I.filter($=>{var X;return(X=$.live_customer)==null?void 0:X.whatsapp}).length,"..."]}):n.jsxs(n.Fragment,{children:[n.jsx(nn,{className:"h-4 w-4 mr-2"}),"Abrir WhatsApp (",I.filter($=>{var X;return(X=$.live_customer)==null?void 0:X.whatsapp}).length,")"]})})]})]})]}),o==="direct"&&n.jsxs(n.Fragment,{children:[n.jsx(gi,{className:"flex-1 min-h-[200px] max-h-[400px] mt-2",children:n.jsx("div",{className:"space-y-3 pr-4",children:r.map(($,X)=>{var V,H;const Z=((V=$.live_customer)==null?void 0:V.instagram_handle)||"",re=f.has(X),W=p.has(X),J=rV(Z);return n.jsxs("div",{className:`p-4 rounded-lg border ${W?"bg-emerald-50 border-emerald-200":re?"bg-amber-50 border-amber-200":"bg-background"}`,children:[n.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(ke,{variant:"outline",className:"font-mono text-xs",children:["#",$.bag_number]}),n.jsx("span",{className:"font-semibold",children:iw(Z)}),W&&n.jsxs(ke,{className:"bg-emerald-100 text-emerald-700 text-xs",children:[n.jsx(gn,{className:"h-3 w-3 mr-1"}),"Registrada"]}),re&&!W&&n.jsx(ke,{className:"bg-amber-100 text-amber-700 text-xs",children:"Copiada"})]}),((H=$.live_customer)==null?void 0:H.nome)&&n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:$.live_customer.nome}),J&&n.jsxs("a",{href:J,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline flex items-center gap-1 mt-1",children:[n.jsx(Zs,{className:"h-3 w-3"}),J]})]}),n.jsx("span",{className:"font-bold",children:q($.total)})]}),n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>N($,X),children:[n.jsx(Wa,{className:"h-4 w-4 mr-2"}),"Copiar mensagem"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>C($),children:[n.jsx(Wa,{className:"h-4 w-4 mr-2"}),"S link"]}),J&&n.jsx(he,{variant:"outline",size:"sm",asChild:!0,children:n.jsx("a",{href:J,target:"_blank",rel:"noopener noreferrer",children:n.jsx(Zs,{className:"h-4 w-4"})})})]}),!W&&n.jsxs(he,{size:"sm",variant:"secondary",className:"w-full border-amber-300 text-amber-700 hover:bg-amber-100",onClick:()=>k($,X),children:[n.jsx(gn,{className:"h-4 w-4 mr-2"}),"Registrar cobrana"]})]})]},$.id)})})}),n.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:M>0&&`${M} de ${r.length} registradas`}),n.jsx(he,{variant:"outline",onClick:t,children:"Fechar"})]})]})]})}),n.jsx(kZe,{isOpen:x.open,onClose:()=>v({...x,open:!1}),message:x.message,phone:x.phone})]})}function TZe(){const{eventId:e}=ta(),t=pr(),{hasRole:r,rolesLoading:s}=qn(),a=!s&&r("admin"),{event:i,isLoading:o}=B_(e),{orders:l,sellers:d,kpis:c,isLoading:u,filterOrders:h,ordersNeedingCharge:f,getOrderUrgency:m,assignSeller:p,markAsPaid:g,markAsPaidWithProof:x,approveManualPayment:v,rejectManualPayment:y,markAsPosted:b,markAsDelivered:j,markAsPickedUp:T,advanceStatus:O,revertStatus:R,generateShippingLabel:D,updateDeliveryMethod:B,updateDeliveryWithShipping:q,updateCustomerZipCode:Y,updateDeliveryDetails:G,recordCharge:I,fetchChargeHistory:F,updateTrackingCode:S,refetch:E}=gZe(e),[N,C]=P.useState("list"),[k,M]=P.useState(!1),[U,$]=P.useState(null),[X,Z]=P.useState({search:"",status:"all",deliveryMethod:"all",sellerId:"",urgentOnly:!1,needsCharge:!1,pendingProof:!1}),[re,W]=P.useState(null),[J,V]=P.useState([]);P.useEffect(()=>{re!=null&&re.id?F(re.id).then(V):V([])},[re==null?void 0:re.id,F]);const H=P.useMemo(()=>l.find(ce=>ce.id===U),[l,U]),ee=P.useMemo(()=>h(X),[h,X]),ie=P.useMemo(()=>({aguardando:ee.filter(ce=>ce.status==="aguardando_pagamento"||ce.status==="aberto"),pago:ee.filter(ce=>ce.status==="pago"&&!["etiqueta_gerada","postado","entregue","retirado"].includes(ce.operational_status||"")),etiqueta:ee.filter(ce=>ce.operational_status==="etiqueta_gerada"),enviado:ee.filter(ce=>["postado","entregue","retirado","em_rota"].includes(ce.operational_status||""))}),[ee]),oe=ce=>{const ne={search:"",status:"all",deliveryMethod:"all",sellerId:"",urgentOnly:!1,needsCharge:!1,pendingProof:!1};ce==="needs_charge"?ne.needsCharge=!0:ce==="pending_proof"?ne.pendingProof=!0:ce==="urgent"?ne.urgentOnly=!0:ce==="none"?ne.sellerId="none":ce==="retirada"||ce==="motoboy"||ce==="correios"?(ne.deliveryMethod=ce,ne.status="pago"):ce!=="all"&&(ne.status=ce),Z(ne)};P.useMemo(()=>{if(re){const ce=l.find(ne=>ne.id===re.id);ce&&W(ce)}},[l,re==null?void 0:re.id]);const se=async(ce,ne,me)=>U?x(U,ce,ne,me):!1;if(o||u)return n.jsx("div",{className:"min-h-screen bg-background p-4 md:p-6",children:n.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[n.jsx(Wr,{className:"h-10 w-64"}),n.jsx("div",{className:"grid grid-cols-4 gap-4",children:[...Array(8)].map((ce,ne)=>n.jsx(Wr,{className:"h-20"},ne))}),n.jsx(Wr,{className:"h-96"})]})});if(!i)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Vt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Live no encontrada"}),n.jsxs(he,{variant:"outline",onClick:()=>t("/dashboard"),children:[n.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Voltar ao Dashboard"]})]})});const ue={planejada:{label:"Planejada",color:"bg-blue-100 text-blue-700"},ao_vivo:{label:"Ao Vivo",color:"bg-red-100 text-red-700"},encerrada:{label:"Encerrada",color:"bg-muted text-muted-foreground"}},pe=ue[i.status]||ue.encerrada;return n.jsxs("div",{className:"min-h-screen bg-background overflow-x-hidden",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-3",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>t("/dashboard"),className:"shrink-0",children:n.jsx(Ts,{className:"h-5 w-5"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:i.titulo}),n.jsx(ke,{className:`${pe.color} shrink-0 text-xs`,children:pe.label})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-muted-foreground",children:[n.jsx(ns,{className:"h-3 w-3"}),n.jsx("span",{className:"truncate",children:Wt(new Date(i.data_hora_inicio),"dd 'de' MMMM",{locale:mr})})]})]})]}),n.jsx("div",{className:"flex items-center gap-1 sm:gap-2 shrink-0",children:n.jsx(he,{variant:"outline",size:"icon",onClick:E,className:"h-9 w-9",children:n.jsx(Qr,{className:"h-4 w-4"})})})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-3 flex-wrap",children:[f.length>0&&n.jsxs(he,{variant:"default",size:"sm",onClick:()=>M(!0),className:"bg-rose-600 hover:bg-rose-700 h-9",children:[n.jsx(yf,{className:"h-4 w-4 mr-1 sm:mr-2"}),n.jsx("span",{className:"hidden sm:inline",children:"Cobrar"})," (",f.length,")"]}),n.jsx(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${e}/pendencias`),className:"h-9",children:"Pendncias"}),n.jsx(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${e}/relatorio`),className:"h-9",children:"Relatrio"}),n.jsx(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${e}/separacao`),className:"h-9",children:"Separao"})]})]})}),n.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:n.jsx(xZe,{kpis:c,activeFilter:X.status,onFilterClick:oe})}),n.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 pb-4",children:n.jsxs("div",{className:"flex flex-col gap-3 bg-muted/30 rounded-lg p-3 border",children:[n.jsxs("div",{className:"relative w-full",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar @instagram, nome, sacola...",className:"pl-9 bg-background w-full",value:X.search,onChange:ce=>Z(ne=>({...ne,search:ce.target.value}))})]}),n.jsxs("div",{className:"grid grid-cols-2 sm:flex sm:flex-wrap gap-2",children:[n.jsxs(Xt,{value:X.status,onValueChange:ce=>Z(ne=>({...ne,status:ce,needsCharge:!1,pendingProof:!1,urgentOnly:!1})),children:[n.jsx(Ht,{className:"w-full sm:w-[160px] bg-background h-10",children:n.jsx(Yt,{placeholder:"Status"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todos os status"}),n.jsx(qe,{value:"aguardando_pagamento",children:"Aguardando Pgto"}),n.jsx(qe,{value:"aguardando_retorno",children:"Aguardando Retorno"}),n.jsx(qe,{value:"pago",children:"Pago"}),n.jsx(qe,{value:"preparar_envio",children:"Preparar Envio"}),n.jsx(qe,{value:"etiqueta_gerada",children:"Etiqueta Gerada"}),n.jsx(qe,{value:"postado",children:"Postado"}),n.jsx(qe,{value:"em_rota",children:"Em Rota"}),n.jsx(qe,{value:"entregue",children:"Entregue"})]})]}),n.jsxs(Xt,{value:X.deliveryMethod,onValueChange:ce=>Z(ne=>({...ne,deliveryMethod:ce})),children:[n.jsx(Ht,{className:"w-full sm:w-[130px] bg-background h-10",children:n.jsx(Yt,{placeholder:"Entrega"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todas"}),n.jsx(qe,{value:"correios",children:"Correios"}),n.jsx(qe,{value:"motoboy",children:"Motoboy"}),n.jsx(qe,{value:"retirada",children:"Retirada"})]})]}),n.jsxs(Xt,{value:X.sellerId||"all_sellers",onValueChange:ce=>Z(ne=>({...ne,sellerId:ce==="all_sellers"?"":ce})),children:[n.jsx(Ht,{className:"w-full sm:w-[150px] bg-background h-10 col-span-2 sm:col-span-1",children:n.jsx(Yt,{placeholder:"Responsvel"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all_sellers",children:"Todas"}),n.jsx(qe,{value:"none",children:"Sem responsvel"}),d.map(ce=>n.jsx(qe,{value:ce.id,children:ce.name},ce.id))]})]}),n.jsxs("div",{className:"hidden sm:flex gap-1 border rounded-md p-1 ml-auto bg-background",children:[n.jsx(he,{variant:N==="list"?"default":"ghost",size:"sm",onClick:()=>C("list"),className:"h-8",children:n.jsx(tse,{className:"h-4 w-4"})}),n.jsx(he,{variant:N==="kanban"?"default":"ghost",size:"sm",onClick:()=>C("kanban"),className:"h-8",children:n.jsx(ese,{className:"h-4 w-4"})})]})]}),(X.urgentOnly||X.needsCharge||X.pendingProof)&&n.jsxs("div",{className:"flex gap-1 flex-wrap",children:[X.urgentOnly&&n.jsxs(ke,{variant:"outline",className:"cursor-pointer border-amber-300 text-amber-700 bg-amber-50",onClick:()=>Z(ce=>({...ce,urgentOnly:!1})),children:[n.jsx(Or,{className:"h-3 w-3 mr-1"}),"Urgentes "]}),X.needsCharge&&n.jsxs(ke,{variant:"outline",className:"cursor-pointer border-rose-300 text-rose-700 bg-rose-50",onClick:()=>Z(ce=>({...ce,needsCharge:!1})),children:[n.jsx(nn,{className:"h-3 w-3 mr-1"}),"Cobrar "]}),X.pendingProof&&n.jsx(ke,{variant:"outline",className:"cursor-pointer border-purple-300 text-purple-700 bg-purple-50",onClick:()=>Z(ce=>({...ce,pendingProof:!1})),children:"Validar Pgto "})]})]})}),n.jsx("main",{className:"max-w-7xl mx-auto px-4 pb-8",children:N==="list"?n.jsx("div",{className:"space-y-3",children:ee.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(Vt,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhum pedido encontrado"})]}):ee.map(ce=>n.jsx(GL,{order:ce,sellers:d,urgency:m(ce),onSelect:()=>W(ce),onAssignSeller:p,onMarkAsPaid:g,onMarkAsPosted:b,onMarkAsDelivered:j,onMarkAsPickedUp:T,onAdvanceStatus:O,onRecordCharge:I,onOpenManualPayment:ne=>$(ne)},ce.id))}):n.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0 pb-4",children:n.jsx("div",{className:"flex sm:grid sm:grid-cols-4 gap-3 sm:gap-4 min-w-max sm:min-w-0",children:[{key:"aguardando",label:"Aguardando",data:ie.aguardando,color:"amber"},{key:"pago",label:"Pago",data:ie.pago,color:"emerald"},{key:"etiqueta",label:"Etiqueta",data:ie.etiqueta,color:"blue"},{key:"enviado",label:"Enviado",data:ie.enviado,color:"violet"}].map(ce=>n.jsxs("div",{className:"w-72 sm:w-auto shrink-0 sm:shrink space-y-2 sm:space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 px-2 sm:px-3 py-1.5 sm:py-2 bg-muted/50 rounded-lg border sticky top-0",children:[n.jsx("span",{className:"font-medium text-xs sm:text-sm",children:ce.label}),n.jsx(ke,{variant:"secondary",className:"ml-auto text-xs",children:ce.data.length})]}),ce.data.map(ne=>n.jsx(GL,{order:ne,sellers:d,urgency:m(ne),compact:!0,onSelect:()=>W(ne),onAssignSeller:p,onMarkAsPaid:g,onMarkAsPosted:b,onMarkAsDelivered:j,onMarkAsPickedUp:T,onAdvanceStatus:O,onRecordCharge:I,onOpenManualPayment:me=>$(me)},ne.id)),ce.data.length===0&&n.jsx("div",{className:"text-center py-6 text-muted-foreground text-xs sm:text-sm",children:"Nenhum pedido"})]},ce.key))})})}),n.jsx(EZe,{order:re,sellers:d,isAdmin:a,onClose:()=>W(null),onAssignSeller:p,onMarkAsPaid:g,onMarkAsPaidWithProof:x,onMarkAsPosted:b,onMarkAsDelivered:j,onMarkAsPickedUp:T,onGenerateLabel:D,onUpdateDeliveryMethod:B,onUpdateDeliveryWithShipping:q,onUpdateCustomerZipCode:Y,onRecordCharge:I,onApprovePayment:v,onRejectPayment:y,onRevertStatus:(ce,ne,me)=>R(ce,ne,me,a),onTrackingSynced:S,chargeHistory:J}),n.jsx(AZe,{open:k,onClose:()=>M(!1),orders:f,onRecordCharge:I}),H&&n.jsx(XJ,{open:!!U,onClose:()=>$(null),orderId:U,orderTotal:H.total,onConfirm:se})]})}function PZe(){const e=pr();ta();const[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await le.auth.getSession();if(!a){e("/login");return}const{data:i}=await le.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(l=>["merchant","admin"].includes(l.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsx(TZe,{})}function OZe({liveEventId:e}){e8(),Dk();const{pendencias:t,isLoading:r,filters:s,setFilters:a,updateStatus:i,assignTo:o,countOpen:l,countInProgress:d}=XX(e),c=p=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(p),u=p=>{switch(p){case"aberta":return n.jsxs(ke,{variant:"outline",className:"border-amber-300 bg-amber-50 text-amber-700",children:[n.jsx(Lr,{className:"h-3 w-3 mr-1"}),"Aberta"]});case"em_andamento":return n.jsxs(ke,{variant:"outline",className:"border-blue-300 bg-blue-50 text-blue-700",children:[n.jsx(Sn,{className:"h-3 w-3 mr-1"}),"Em Andamento"]});case"resolvida":return n.jsxs(ke,{variant:"outline",className:"border-green-300 bg-green-50 text-green-700",children:[n.jsx(Sr,{className:"h-3 w-3 mr-1"}),"Resolvida"]})}},h=p=>{switch(p){case"alta":return n.jsx(ke,{variant:"destructive",className:"text-xs",children:"Alta"});case"media":return n.jsx(ke,{variant:"secondary",className:"text-xs",children:"Mdia"});case"baixa":return n.jsx(ke,{variant:"outline",className:"text-xs",children:"Baixa"})}},f=p=>({observacao_cliente:"Observao",ajuste_tamanho:"Ajuste Tamanho",troca:"Troca",enviar_opcoes:"Enviar Opes",outros:"Outros"})[p],m=()=>{const p=["Data","Sacola","Cliente","Tipo","Ttulo","Descrio","Status","Prioridade"],g=t.map(b=>{var j,T,O;return[Wt(new Date(b.created_at),"dd/MM/yyyy HH:mm"),((j=b.live_cart)==null?void 0:j.bag_number)||"-",((O=(T=b.live_cart)==null?void 0:T.live_customer)==null?void 0:O.instagram_handle)||"-",f(b.type),b.title,b.description||"",b.status,b.priority]}),x=[p,...g].map(b=>b.join(",")).join(`
`),v=new Blob([x],{type:"text/csv;charset=utf-8;"}),y=document.createElement("a");y.href=URL.createObjectURL(v),y.download=`pendencias_${Wt(new Date,"yyyy-MM-dd")}.csv`,y.click()};return r?n.jsxs("div",{className:"space-y-4 p-4",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[n.jsx(Wr,{className:"h-20"}),n.jsx(Wr,{className:"h-20"}),n.jsx(Wr,{className:"h-20 hidden md:block"})]}),n.jsx(Wr,{className:"h-12"}),n.jsx("div",{className:"space-y-3",children:[...Array(5)].map((p,g)=>n.jsx(Wr,{className:"h-24"},g))})]}):n.jsxs("div",{className:"space-y-4 p-4 md:p-6 overflow-x-hidden",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[n.jsx($e,{className:`cursor-pointer transition-colors ${s.status==="aberta"?"ring-2 ring-primary":""}`,onClick:()=>a(p=>({...p,status:p.status==="aberta"?"all":"aberta"})),children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-amber-100 rounded-lg shrink-0",children:n.jsx(Lr,{className:"h-5 w-5 text-amber-600"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-2xl font-bold",children:l}),n.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Abertas"})]})]})})}),n.jsx($e,{className:`cursor-pointer transition-colors ${s.status==="em_andamento"?"ring-2 ring-primary":""}`,onClick:()=>a(p=>({...p,status:p.status==="em_andamento"?"all":"em_andamento"})),children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-blue-100 rounded-lg shrink-0",children:n.jsx(Sn,{className:"h-5 w-5 text-blue-600"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-2xl font-bold",children:d}),n.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Em Andamento"})]})]})})}),n.jsx($e,{className:"hidden md:block",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-green-100 rounded-lg shrink-0",children:n.jsx(Sr,{className:"h-5 w-5 text-green-600"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-2xl font-bold",children:t.filter(p=>p.status==="resolvida").length}),n.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Resolvidas"})]})]})})})]}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"relative",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar @instagram, sacola, ttulo...",className:"pl-9",value:s.search,onChange:p=>a(g=>({...g,search:p.target.value}))})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(Xt,{value:s.status,onValueChange:p=>a(g=>({...g,status:p})),children:[n.jsx(Ht,{className:"w-full sm:w-[140px]",children:n.jsx(Yt,{placeholder:"Status"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todos"}),n.jsx(qe,{value:"aberta",children:"Abertas"}),n.jsx(qe,{value:"em_andamento",children:"Em Andamento"}),n.jsx(qe,{value:"resolvida",children:"Resolvidas"})]})]}),n.jsxs(Xt,{value:s.priority,onValueChange:p=>a(g=>({...g,priority:p})),children:[n.jsx(Ht,{className:"w-full sm:w-[140px]",children:n.jsx(Yt,{placeholder:"Prioridade"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todas"}),n.jsx(qe,{value:"alta",children:"Alta"}),n.jsx(qe,{value:"media",children:"Mdia"}),n.jsx(qe,{value:"baixa",children:"Baixa"})]})]}),n.jsxs(Xt,{value:s.type,onValueChange:p=>a(g=>({...g,type:p})),children:[n.jsx(Ht,{className:"w-full sm:w-[150px]",children:n.jsx(Yt,{placeholder:"Tipo"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todos"}),n.jsx(qe,{value:"observacao_cliente",children:"Observao"}),n.jsx(qe,{value:"ajuste_tamanho",children:"Ajuste Tam."}),n.jsx(qe,{value:"troca",children:"Troca"}),n.jsx(qe,{value:"enviar_opcoes",children:"Enviar Opes"}),n.jsx(qe,{value:"outros",children:"Outros"})]})]}),n.jsx(he,{variant:"outline",size:"icon",onClick:m,className:"shrink-0 ml-auto",children:n.jsx(vf,{className:"h-4 w-4"})})]})]}),n.jsx("div",{className:"space-y-3",children:t.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(r_,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhuma pendncia encontrada"})]}):t.map(p=>{var g,x,v,y;return n.jsx($e,{className:"overflow-hidden",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[((g=p.live_cart)==null?void 0:g.bag_number)&&n.jsxs(ke,{variant:"secondary",className:"shrink-0",children:["#",String(p.live_cart.bag_number).padStart(3,"0")]}),n.jsxs("span",{className:"font-medium truncate",children:["@",((v=(x=p.live_cart)==null?void 0:x.live_customer)==null?void 0:v.instagram_handle)||"Desconhecido"]})]}),n.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[h(p.priority),n.jsxs(H_,{children:[n.jsx(G_,{asChild:!0,children:n.jsx(he,{variant:"ghost",size:"icon",className:"h-8 w-8",children:n.jsx(Zne,{className:"h-4 w-4"})})}),n.jsxs(x1,{align:"end",className:"w-48",children:[n.jsxs(pl,{onClick:()=>i(p.id,"aberta"),children:[n.jsx(Lr,{className:"h-4 w-4 mr-2"}),"Marcar como Aberta"]}),n.jsxs(pl,{onClick:()=>i(p.id,"em_andamento"),children:[n.jsx(Sn,{className:"h-4 w-4 mr-2"}),"Em Andamento"]}),n.jsxs(pl,{onClick:()=>i(p.id,"resolvida"),children:[n.jsx(Sr,{className:"h-4 w-4 mr-2"}),"Marcar como Resolvida"]}),n.jsx(YG,{}),n.jsxs(pl,{children:[n.jsx(Dn,{className:"h-4 w-4 mr-2"}),"Atribuir Responsvel"]}),n.jsxs(pl,{children:[n.jsx(ns,{className:"h-4 w-4 mr-2"}),"Definir Prazo"]})]})]})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[u(p.status),n.jsx(ke,{variant:"outline",className:"text-xs",children:f(p.type)})]}),n.jsx("p",{className:"font-medium text-sm line-clamp-1",children:p.title}),p.description&&n.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:p.description})]}),n.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground pt-2 border-t",children:[n.jsx("span",{children:Wt(new Date(p.created_at),"dd/MM 's' HH:mm",{locale:mr})}),((y=p.live_cart)==null?void 0:y.total)&&n.jsx("span",{className:"font-medium",children:c(p.live_cart.total)})]})]})})},p.id)})})]})}function RZe(){const e=pr(),{eventId:t}=ta(),{event:r,isLoading:s}=B_(t);if(s)return n.jsx("div",{className:"min-h-screen bg-background p-4",children:n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[n.jsx(Wr,{className:"h-10 w-64"}),n.jsx(Wr,{className:"h-96"})]})});if(!r)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Vt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Live no encontrada"}),n.jsxs(he,{variant:"outline",onClick:()=>e("/dashboard"),children:[n.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Voltar ao Dashboard"]})]})});const a={planejada:{label:"Planejada",color:"bg-blue-100 text-blue-700"},ao_vivo:{label:"Ao Vivo",color:"bg-red-100 text-red-700"},encerrada:{label:"Encerrada",color:"bg-muted text-muted-foreground"}},i=a[r.status]||a.encerrada;return n.jsxs("div",{className:"min-h-screen bg-background overflow-x-hidden",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:n.jsx("div",{className:"max-w-4xl mx-auto px-4 py-3 flex items-center justify-between",children:n.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>e(`/dashboard/lives/${t}/pedidos`),className:"shrink-0",children:n.jsx(Ts,{className:"h-5 w-5"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("h1",{className:"text-lg font-semibold truncate",children:r.titulo}),n.jsx(ke,{className:i.color,children:i.label})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(Wb,{className:"h-3.5 w-3.5"}),n.jsx("span",{children:"Pendncias"})]})]})]})})}),n.jsx("main",{className:"max-w-4xl mx-auto",children:n.jsx(OZe,{liveEventId:t})})]})}const Jf=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"],w0=["cancelado"];function MZe(e){const[t,r]=P.useState(null),[s,a]=P.useState([]),[i,o]=P.useState([]),[l,d]=P.useState([]),[c,u]=P.useState([]),[h,f]=P.useState([]),[m,p]=P.useState(!0),{startDate:g,endDate:x,prevStartDate:v,prevEndDate:y}=P.useMemo(()=>{var B,q;const j=new Date;let T,O,R,D;switch(e.period){case"today":T=Vn(j),O=Jn(j),R=Vn(fn(j,1)),D=Jn(fn(j,1));break;case"7d":T=Vn(fn(j,6)),O=Jn(j),R=Vn(fn(j,13)),D=Jn(fn(j,7));break;case"30d":T=Vn(fn(j,29)),O=Jn(j),R=Vn(fn(j,59)),D=Jn(fn(j,30));break;case"thisMonth":T=Cs(j),O=Jn(j),R=Cs(so(j,1)),D=lc(so(j,1));break;case"custom":T=((B=e.customDateRange)==null?void 0:B.from)||Vn(j),O=((q=e.customDateRange)==null?void 0:q.to)||Jn(j);const Y=Math.ceil((O.getTime()-T.getTime())/(1e3*60*60*24));R=fn(T,Y),D=fn(O,Y);break;default:T=Vn(fn(j,6)),O=Jn(j),R=Vn(fn(j,13)),D=Jn(fn(j,7))}return{startDate:T,endDate:O,prevStartDate:R,prevEndDate:D}},[e.period,e.customDateRange]),b=P.useCallback(async()=>{p(!0);try{const j=await le.from("sellers").select("id, name").eq("is_active",!0);f(j.data||[]);let T=le.from("orders").select("*, order_items(*)").gte("created_at",g.toISOString()).lte("created_at",x.toISOString());e.source==="catalog"?T=T.is("live_event_id",null):e.source==="live"&&(T=T.not("live_event_id","is",null)),e.sellerId&&(T=T.eq("seller_id",e.sellerId));let O=le.from("orders").select("*, order_items(*)").gte("created_at",v.toISOString()).lte("created_at",y.toISOString());e.source==="catalog"?O=O.is("live_event_id",null):e.source==="live"&&(O=O.not("live_event_id","is",null));const R=le.from("product_available_stock").select("product_id, size, available"),[D,B,q]=await Promise.all([T,O,R]),Y=D.data||[],G=B.data||[],I=q.data||[],F=new Map,S=new Map;I.forEach(ye=>{ye.product_id&&F.set(ye.product_id,(F.get(ye.product_id)||0)+(ye.available||0)),ye.size&&S.set(ye.size,(S.get(ye.size)||0)+(ye.available||0))});const E=ye=>e.status==="all"?ye:e.status==="pago"?ye.filter(Oe=>Jf.includes(Oe.status)):e.status==="reservado"?ye.filter(Oe=>Oe.status==="aguardando_pagamento"):e.status==="cancelado"?ye.filter(Oe=>w0.includes(Oe.status)):ye,N=E(Y),C=E(G),k=Y.filter(ye=>Jf.includes(ye.status)),M=G.filter(ye=>Jf.includes(ye.status)),U=Y.filter(ye=>w0.includes(ye.status)),$=Y.filter(ye=>ye.status==="aguardando_pagamento"),X=Y.filter(ye=>ye.live_event_id),Z=Y.filter(ye=>!ye.live_event_id),re=X.filter(ye=>Jf.includes(ye.status)),W=Z.filter(ye=>Jf.includes(ye.status)),J=X.filter(ye=>!w0.includes(ye.status)),V=Z.filter(ye=>!w0.includes(ye.status)),H=k.reduce((ye,Oe)=>ye+(Oe.total||0),0),ee=M.reduce((ye,Oe)=>ye+(Oe.total||0),0),ie=k.reduce((ye,Oe)=>{const Ne=Oe.order_items||[];return ye+Ne.reduce((De,Ge)=>De+(Ge.quantity||0),0)},0),oe=M.reduce((ye,Oe)=>{const Ne=Oe.order_items||[];return ye+Ne.reduce((De,Ge)=>De+(Ge.quantity||0),0)},0);r({receita:H,receitaPrev:ee,itensSold:ie,itensSoldPrev:oe,ticketMedio:k.length>0?H/k.length:0,ticketMedioPrev:M.length>0?ee/M.length:0,conversaoLive:J.length>0?re.length/J.length*100:0,conversaoCatalog:V.length>0?W.length/V.length*100:0,percentLive:k.length>0?re.length/k.length*100:0,percentCatalog:k.length>0?W.length/k.length*100:0,cancelamentoRate:Y.length>0?U.length/Y.length*100:0,ordersCount:k.length});const se=new Map;k.forEach(ye=>{const Oe=!!ye.live_event_id;(ye.order_items||[]).forEach(De=>{const Ge=De.product_name||"Unknown",Qe=se.get(Ge)||{productId:null,productName:De.product_name||"Unknown",productSku:De.product_sku,imageUrl:De.image_url,qtySold:0,revenue:0,liveQty:0,catalogQty:0,reservedQty:0,reservedValue:0,canceledQty:0,lastSaleAt:null};Qe.qtySold+=De.quantity||0,Qe.revenue+=(De.product_price||0)*(De.quantity||0),Oe?Qe.liveQty+=De.quantity||0:Qe.catalogQty+=De.quantity||0,(!Qe.lastSaleAt||ye.paid_at&&ye.paid_at>Qe.lastSaleAt)&&(Qe.lastSaleAt=ye.paid_at||ye.created_at),se.set(Ge,Qe)})}),$.forEach(ye=>{(ye.order_items||[]).forEach(Ne=>{const De=Ne.product_name||"Unknown",Ge=se.get(De)||{productId:null,productName:Ne.product_name||"Unknown",productSku:Ne.product_sku,imageUrl:Ne.image_url,qtySold:0,revenue:0,liveQty:0,catalogQty:0,reservedQty:0,reservedValue:0,canceledQty:0,lastSaleAt:null};Ge.reservedQty+=Ne.quantity||0,Ge.reservedValue+=(Ne.product_price||0)*(Ne.quantity||0),se.set(De,Ge)})}),U.forEach(ye=>{(ye.order_items||[]).forEach(Ne=>{const De=Ne.product_name||"Unknown",Ge=se.get(De);Ge&&(Ge.canceledQty+=Ne.quantity||0)})});const ue=Array.from(se.values()).map(ye=>{const Oe=ye.qtySold+ye.reservedQty+ye.canceledQty,Ne=Oe>0?ye.qtySold/Oe*100:0,De=Oe>0?ye.canceledQty/Oe*100:0,Ge=ye.qtySold>0?ye.liveQty/ye.qtySold*100:0,Qe=ye.qtySold>0?ye.revenue/ye.qtySold:0;let Ie="ok";const Ae=0;return Ne<30&&ye.reservedQty>3&&(Ie="warning"),De>30&&(Ie="warning"),(De>50||Ne<20&&ye.reservedQty>5)&&(Ie="critical"),{productId:ye.productId,productName:ye.productName,productSku:ye.productSku,imageUrl:ye.imageUrl,qtySold:ye.qtySold,revenue:ye.revenue,avgPrice:Qe,percentLive:Ge,reservedQty:ye.reservedQty,reservedValue:ye.reservedValue,conversaoRate:Ne,canceledQty:ye.canceledQty,cancelamentoRate:De,stockAvailable:Ae,lastSaleAt:ye.lastSaleAt,riskLevel:Ie}}),pe=e.search.toLowerCase(),ce=pe?ue.filter(ye=>ye.productName.toLowerCase().includes(pe)||ye.productSku&&ye.productSku.toLowerCase().includes(pe)):ue;ce.sort((ye,Oe)=>Oe.revenue-ye.revenue),a(ce);const ne=new Map;k.forEach(ye=>{(ye.order_items||[]).forEach(Ne=>{const De=Ne.size||"N/A",Ge=ne.get(De)||{size:De,qtySold:0,revenue:0,reservedQty:0,canceledQty:0,stockAvailable:S.get(De)||0};Ge.qtySold+=Ne.quantity||0,Ge.revenue+=(Ne.product_price||0)*(Ne.quantity||0),ne.set(De,Ge)})}),$.forEach(ye=>{(ye.order_items||[]).forEach(Ne=>{const De=Ne.size||"N/A",Ge=ne.get(De);Ge&&(Ge.reservedQty+=Ne.quantity||0)})}),U.forEach(ye=>{(ye.order_items||[]).forEach(Ne=>{const De=Ne.size||"N/A",Ge=ne.get(De);Ge&&(Ge.canceledQty+=Ne.quantity||0)})}),o(Array.from(ne.values()).sort((ye,Oe)=>Oe.revenue-ye.revenue));const me=new Map,ge=new Map;(j.data||[]).forEach(ye=>ge.set(ye.id,ye.name)),Y.forEach(ye=>{if(!ye.seller_id)return;const Oe=ye.seller_id,Ne=ge.get(Oe)||"Desconhecido",De=me.get(Oe)||{id:Oe,name:Ne,revenue:0,qtySold:0,ordersCount:0,paidCount:0,canceledCount:0,productCounts:new Map};De.ordersCount+=1,Jf.includes(ye.status)&&(De.paidCount+=1,De.revenue+=ye.total||0,(ye.order_items||[]).forEach(Qe=>{De.qtySold+=Qe.quantity||0;const Ie=Qe.product_name||"Unknown";De.productCounts.set(Ie,(De.productCounts.get(Ie)||0)+(Qe.quantity||0))})),w0.includes(ye.status)&&(De.canceledCount+=1),me.set(Oe,De)});const _e=Array.from(me.values()).map(ye=>{const Oe=Array.from(ye.productCounts.entries()).sort((Ne,De)=>De[1]-Ne[1]).slice(0,3).map(([Ne,De])=>({name:Ne,qty:De}));return{id:ye.id,name:ye.name,revenue:ye.revenue,qtySold:ye.qtySold,ordersCount:ye.ordersCount,conversaoRate:ye.ordersCount>0?ye.paidCount/ye.ordersCount*100:0,cancelamentoRate:ye.ordersCount>0?ye.canceledCount/ye.ordersCount*100:0,topProducts:Oe}});_e.sort((ye,Oe)=>Oe.revenue-ye.revenue),d(_e);const be=[];ue.forEach((ye,Oe)=>{ye.reservedQty>3&&ye.conversaoRate<30&&be.push({id:`conv-${Oe}`,type:"baixa_conversao",severity:ye.conversaoRate<20?"error":"warning",productName:ye.productName,productId:ye.productId,message:`Converso de ${ye.conversaoRate.toFixed(0)}% com ${ye.reservedQty} reservados`,value:ye.reservedValue}),ye.cancelamentoRate>30&&be.push({id:`cancel-${Oe}`,type:"alto_cancelamento",severity:ye.cancelamentoRate>50?"error":"warning",productName:ye.productName,productId:ye.productId,message:`${ye.cancelamentoRate.toFixed(0)}% de cancelamento (${ye.canceledQty} cancelados)`,value:ye.canceledQty})}),u(be)}catch(j){console.error("Error fetching insights data:",j)}finally{p(!1)}},[g,x,v,y,e.source,e.sellerId,e.status,e.search]);return P.useEffect(()=>{b()},[b]),{kpis:t,productRanking:s,sizeRanking:i,sellerRanking:l,alerts:c,sellers:h,isLoading:m,refetch:b,dateRange:{startDate:g,endDate:x}}}function IZe({data:e,sortBy:t,isLoading:r,onProductClick:s}){const a=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(l),i=l=>`${l.toFixed(1)}%`,o=[...e].sort((l,d)=>t==="revenue"?d.revenue-l.revenue:d.qtySold-l.qtySold);return r?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.length===0?n.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Nenhum produto encontrado no perodo"}):n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{className:"bg-muted/50",children:[n.jsx(St,{className:"w-12",children:"#"}),n.jsx(St,{children:"Produto"}),n.jsx(St,{className:"text-right",children:"Qtd"}),n.jsx(St,{className:"text-right",children:"Receita"}),n.jsx(St,{className:"text-right",children:"Preo Mdio"}),n.jsx(St,{className:"text-right",children:"% Live"}),n.jsx(St,{className:"text-right",children:"Reservados"}),n.jsx(St,{className:"text-right",children:"Converso"}),n.jsx(St,{className:"text-right",children:"Cancelados"}),n.jsx(St,{className:"text-center",children:"Risco"})]})}),n.jsx(ya,{children:o.map((l,d)=>n.jsxs(Kr,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>s(l.productName),children:[n.jsx(bt,{className:"font-mono text-muted-foreground",children:d+1}),n.jsx(bt,{children:n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"font-medium truncate max-w-[200px]",children:l.productName}),l.productSku&&n.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:l.productSku})]})}),n.jsx(bt,{className:"text-right font-medium",children:l.qtySold}),n.jsx(bt,{className:"text-right font-medium text-green-600",children:a(l.revenue)}),n.jsx(bt,{className:"text-right",children:a(l.avgPrice)}),n.jsx(bt,{className:"text-right",children:l.percentLive>0?n.jsx(ke,{variant:"outline",className:"border-pink-200 text-pink-700 text-xs",children:i(l.percentLive)}):n.jsx("span",{className:"text-muted-foreground",children:""})}),n.jsx(bt,{className:"text-right",children:l.reservedQty>0?n.jsxs("div",{children:[n.jsx("span",{className:"font-medium text-amber-600",children:l.reservedQty}),n.jsx("p",{className:"text-[10px] text-muted-foreground",children:a(l.reservedValue)})]}):n.jsx("span",{className:"text-muted-foreground",children:""})}),n.jsx(bt,{className:"text-right",children:n.jsx("span",{className:l.conversaoRate>=70?"text-green-600":l.conversaoRate>=40?"text-amber-600":"text-red-600",children:i(l.conversaoRate)})}),n.jsx(bt,{className:"text-right",children:l.canceledQty>0?n.jsxs("div",{children:[n.jsx("span",{className:"text-red-600",children:l.canceledQty}),n.jsx("p",{className:"text-[10px] text-muted-foreground",children:i(l.cancelamentoRate)})]}):n.jsx("span",{className:"text-muted-foreground",children:""})}),n.jsx(bt,{className:"text-center",children:n.jsx(ke,{className:l.riskLevel==="critical"?"bg-red-100 text-red-700 border-0":l.riskLevel==="warning"?"bg-amber-100 text-amber-700 border-0":"bg-green-100 text-green-700 border-0",children:l.riskLevel==="critical"?"Crtico":l.riskLevel==="warning"?"Ateno":"OK"})})]},d))})]})})})}function DZe({data:e,isLoading:t}){const r=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(a);if(t)return n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(e.length===0)return n.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Nenhum dado de tamanho encontrado"});const s=e.reduce((a,i)=>a+i.qtySold,0);return e.reduce((a,i)=>a+i.revenue,0),n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{className:"bg-muted/50",children:[n.jsx(St,{children:"Tamanho"}),n.jsx(St,{className:"text-right",children:"Qtd Vendida"}),n.jsx(St,{className:"text-right",children:"% do Total"}),n.jsx(St,{className:"text-right",children:"Receita"}),n.jsx(St,{className:"text-right",children:"Reservados"}),n.jsx(St,{className:"text-right",children:"Cancelados"}),n.jsx(St,{className:"text-right",children:"Estoque"})]})}),n.jsx(ya,{children:e.map((a,i)=>{const o=s>0?a.qtySold/s*100:0;return n.jsxs(Kr,{children:[n.jsx(bt,{children:n.jsx(ke,{variant:"outline",className:"font-mono text-sm",children:a.size})}),n.jsx(bt,{className:"text-right font-medium",children:a.qtySold}),n.jsx(bt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-2",children:[n.jsx("div",{className:"w-16 h-2 bg-muted rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${Math.min(o,100)}%`}})}),n.jsxs("span",{className:"text-xs text-muted-foreground w-10",children:[o.toFixed(1),"%"]})]})}),n.jsx(bt,{className:"text-right font-medium text-green-600",children:r(a.revenue)}),n.jsx(bt,{className:"text-right",children:a.reservedQty>0?n.jsx("span",{className:"text-amber-600 font-medium",children:a.reservedQty}):n.jsx("span",{className:"text-muted-foreground",children:""})}),n.jsx(bt,{className:"text-right",children:a.canceledQty>0?n.jsx("span",{className:"text-red-600",children:a.canceledQty}):n.jsx("span",{className:"text-muted-foreground",children:""})}),n.jsx(bt,{className:"text-right",children:a.stockAvailable>0?n.jsx(ke,{className:a.stockAvailable<5?"bg-red-100 text-red-700 border-0":a.stockAvailable<15?"bg-amber-100 text-amber-700 border-0":"bg-green-100 text-green-700 border-0",children:a.stockAvailable}):n.jsx(ke,{className:"bg-muted text-muted-foreground border-0",children:"0"})})]},i)})})]})})}function LZe({data:e,isLoading:t}){const r=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(l),s=l=>`${l.toFixed(1)}%`;if(t)return n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(e.length===0)return n.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Nenhuma vendedora encontrada no perodo"});const a=e.reduce((l,d)=>d.revenue>l.revenue?d:l,e[0]),i=e.filter(l=>l.ordersCount>=3).reduce((l,d)=>d.conversaoRate>l.conversaoRate?d:l,e[0]),o=e.reduce((l,d)=>d.qtySold>l.qtySold?d:l,e[0]);return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs($e,{className:"border-yellow-200 bg-yellow-50/50",children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-sm flex items-center gap-2",children:[n.jsx(ma,{className:"h-4 w-4 text-yellow-600"}),"Maior Faturamento"]})}),n.jsxs(Fe,{children:[n.jsx("p",{className:"font-bold text-lg",children:a.name}),n.jsx("p",{className:"text-green-600 font-medium",children:r(a.revenue)})]})]}),n.jsxs($e,{className:"border-blue-200 bg-blue-50/50",children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-sm flex items-center gap-2",children:[n.jsx(Vs,{className:"h-4 w-4 text-blue-600"}),"Maior Converso"]})}),n.jsxs(Fe,{children:[n.jsx("p",{className:"font-bold text-lg",children:i.name}),n.jsx("p",{className:"text-blue-600 font-medium",children:s(i.conversaoRate)})]})]}),n.jsxs($e,{className:"border-purple-200 bg-purple-50/50",children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-sm flex items-center gap-2",children:[n.jsx(wi,{className:"h-4 w-4 text-purple-600"}),"Mais Peas"]})}),n.jsxs(Fe,{children:[n.jsx("p",{className:"font-bold text-lg",children:o.name}),n.jsxs("p",{className:"text-purple-600 font-medium",children:[o.qtySold," peas"]})]})]})]}),n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs(xa,{children:[n.jsx(va,{children:n.jsxs(Kr,{className:"bg-muted/50",children:[n.jsx(St,{className:"w-12",children:"#"}),n.jsx(St,{children:"Vendedora"}),n.jsx(St,{className:"text-right",children:"Receita"}),n.jsx(St,{className:"text-right",children:"Peas"}),n.jsx(St,{className:"text-right",children:"Pedidos"}),n.jsx(St,{className:"text-right",children:"Converso"}),n.jsx(St,{className:"text-right",children:"Cancelamento"}),n.jsx(St,{children:"Top 3 Produtos"})]})}),n.jsx(ya,{children:e.map((l,d)=>n.jsxs(Kr,{children:[n.jsx(bt,{className:"font-mono text-muted-foreground",children:d+1}),n.jsx(bt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-medium",children:l.name}),l.id===a.id&&n.jsx(ke,{className:"bg-yellow-100 text-yellow-700 border-0 text-[10px]",children:" Top"}),l.id===i.id&&l.id!==a.id&&n.jsx(ke,{className:"bg-blue-100 text-blue-700 border-0 text-[10px]",children:" Converso"})]})}),n.jsx(bt,{className:"text-right font-medium text-green-600",children:r(l.revenue)}),n.jsx(bt,{className:"text-right",children:l.qtySold}),n.jsx(bt,{className:"text-right",children:l.ordersCount}),n.jsx(bt,{className:"text-right",children:n.jsx("span",{className:l.conversaoRate>=70?"text-green-600 font-medium":l.conversaoRate>=40?"text-amber-600":"text-red-600",children:s(l.conversaoRate)})}),n.jsx(bt,{className:"text-right",children:l.cancelamentoRate>0?n.jsx("span",{className:l.cancelamentoRate>20?"text-red-600":"text-muted-foreground",children:s(l.cancelamentoRate)}):n.jsx("span",{className:"text-green-600",children:"0%"})}),n.jsx(bt,{children:n.jsx("div",{className:"flex flex-wrap gap-1",children:l.topProducts.slice(0,3).map((c,u)=>n.jsxs(ke,{variant:"outline",className:"text-[10px] truncate max-w-[100px]",children:[c.name," (",c.qty,")"]},u))})})]},l.id))})]})})]})}function BZe({alerts:e,onViewProduct:t}){const r=pr(),s=c=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(c),a=c=>{switch(c){case"baixa_conversao":return n.jsx(Sx,{className:"h-5 w-5"});case"alto_cancelamento":return n.jsx(Kn,{className:"h-5 w-5"});case"ruptura":return n.jsx(Or,{className:"h-5 w-5"})}},i=(c,u)=>{if(u==="error")return"border-red-200 bg-red-50";switch(c){case"baixa_conversao":return"border-amber-200 bg-amber-50";case"alto_cancelamento":return"border-red-200 bg-red-50";case"ruptura":return"border-orange-200 bg-orange-50";default:return"border-muted"}},o=c=>{switch(c){case"baixa_conversao":return"text-amber-700";case"alto_cancelamento":return"text-red-700";case"ruptura":return"text-orange-700"}},l=c=>{switch(c){case"baixa_conversao":return"Baixa Converso";case"alto_cancelamento":return"Alto Cancelamento";case"ruptura":return"Risco de Ruptura"}},d=e.reduce((c,u)=>(c[u.type]||(c[u.type]=[]),c[u.type].push(u),c),{});return e.length===0?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:n.jsx(Or,{className:"h-8 w-8 text-green-600"})}),n.jsx("h3",{className:"text-lg font-medium text-green-700",children:"Tudo OK!"}),n.jsx("p",{className:"text-muted-foreground mt-1",children:"Nenhum alerta operacional ativo no momento"})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(d).map(([c,u])=>n.jsx($e,{className:i(c,"warning"),children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:o(c),children:a(c)}),n.jsx("span",{className:`font-medium ${o(c)}`,children:l(c)})]}),n.jsx("p",{className:"text-2xl font-bold",children:u.length}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"produtos afetados"})]})},c))}),n.jsx("div",{className:"space-y-3",children:e.map(c=>n.jsx($e,{className:i(c.type,c.severity),children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("span",{className:o(c.type),children:a(c.type)}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-medium",children:c.productName}),n.jsx(ke,{variant:"outline",className:`text-[10px] ${c.severity==="error"?"border-red-300 text-red-700":"border-amber-300 text-amber-700"}`,children:c.severity==="error"?"Crtico":"Ateno"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:c.message}),c.type==="baixa_conversao"&&n.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Valor em reserva: ",n.jsx("span",{className:"font-medium",children:s(c.value)})]})]})]}),n.jsxs("div",{className:"flex gap-2 shrink-0",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>t(c.productName),className:"gap-1",children:[n.jsx(ai,{className:"h-4 w-4"}),"Detalhes"]}),c.type==="baixa_conversao"&&n.jsxs(he,{variant:"default",size:"sm",onClick:()=>r(`/dashboard?tab=orders&status=aguardando_pagamento&search=${encodeURIComponent(c.productName)}`),className:"gap-1",children:[n.jsx(Zs,{className:"h-4 w-4"}),"Ver reservas"]})]})]})})},c.id))})]})}const $Ze=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"];function FZe({productName:e,isOpen:t,onClose:r,filters:s}){const a=pr(),[i,o]=P.useState(null),[l,d]=P.useState(!1);P.useEffect(()=>{e&&t&&u()},[e,t,s]);const c=()=>{const p=new Date;switch(s.period){case"today":return{start:Vn(p),end:Jn(p)};case"7d":return{start:Vn(fn(p,6)),end:Jn(p)};case"30d":return{start:Vn(fn(p,29)),end:Jn(p)};case"thisMonth":return{start:Cs(p),end:Jn(p)};default:return{start:Vn(fn(p,6)),end:Jn(p)}}},u=async()=>{if(e){d(!0);try{const{start:p,end:g}=c(),{data:x}=await le.from("orders").select("*, order_items(*)").gte("created_at",p.toISOString()).lte("created_at",g.toISOString()),{data:v}=await le.from("sellers").select("id, name"),y=new Map;(v||[]).forEach(F=>y.set(F.id,F.name));const b=(x||[]).filter(F=>(F.order_items||[]).some(E=>E.product_name===e));let j=0,T=0,O=0,R=0,D=0,B=0;const q=new Map,Y=new Map,G=new Map,I=new Map;b.forEach(F=>{const S=$Ze.includes(F.status),E=F.status==="aguardando_pagamento",N=F.status==="cancelado",C=!!F.live_event_id,k=Wt(new Date(F.created_at),"yyyy-MM-dd");if((F.order_items||[]).forEach(U=>{if(U.product_name!==e)return;const $=U.quantity||0,X=(U.product_price||0)*$,Z=U.size||"N/A",re=q.get(Z)||{sold:0,reserved:0,canceled:0};if(S&&(re.sold+=$),E&&(re.reserved+=$),N&&(re.canceled+=$),q.set(Z,re),S){if(j+=$,T+=X,C?(O+=$,D+=X):(R+=$,B+=X),F.seller_id){const J=y.get(F.seller_id)||"Desconhecido",V=Y.get(J)||{sold:0,revenue:0};V.sold+=$,V.revenue+=X,Y.set(J,V)}const W=I.get(k)||{sold:0,revenue:0};W.sold+=$,W.revenue+=X,I.set(k,W)}}),S){const U="Mercado Pago",$=G.get(U)||{count:0,total:0};$.count+=1,$.total+=F.total||0,G.set(U,$)}}),o({totalSold:j,totalRevenue:T,liveSold:O,catalogSold:R,liveRevenue:D,catalogRevenue:B,bySizeData:Array.from(q.entries()).map(([F,S])=>({size:F,sold:S.sold,reserved:S.reserved,canceled:S.canceled,stock:0})),bySellerData:Array.from(Y.entries()).map(([F,S])=>({name:F,sold:S.sold,revenue:S.revenue})).sort((F,S)=>S.revenue-F.revenue),byPaymentData:Array.from(G.entries()).map(([F,S])=>({method:F,count:S.count,total:S.total})),dailyData:Array.from(I.entries()).map(([F,S])=>({date:F,sold:S.sold,revenue:S.revenue})).sort((F,S)=>F.date.localeCompare(S.date))})}catch(p){console.error("Error loading drilldown data:",p)}finally{d(!1)}}},h=p=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(p),f=p=>Wt(new Date(p),"dd/MM"),m=p=>{const g=new URLSearchParams;g.set("tab","orders"),g.set("status",p),g.set("search",e||""),a(`/dashboard?${g.toString()}`),r()};return n.jsx(_u,{open:t,onOpenChange:p=>!p&&r(),children:n.jsxs(rd,{className:"sm:max-w-lg overflow-y-auto",children:[n.jsx(ju,{children:n.jsxs(Zh,{className:"flex items-center gap-2",children:[n.jsx(Vt,{className:"h-5 w-5"}),n.jsx("span",{className:"truncate",children:e})]})}),l?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(Et,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):i?n.jsxs("div",{className:"mt-6 space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx($e,{children:n.jsxs(Fe,{className:"p-3",children:[n.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Vendido"}),n.jsxs("p",{className:"text-lg font-bold",children:[i.totalSold," peas"]}),n.jsx("p",{className:"text-sm text-green-600",children:h(i.totalRevenue)})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-3",children:[n.jsx("p",{className:"text-xs text-muted-foreground",children:"Live vs Catlogo"}),n.jsxs("div",{className:"flex gap-2 mt-1",children:[n.jsxs(ke,{className:"bg-pink-100 text-pink-700 border-0",children:["Live: ",i.liveSold]}),n.jsxs(ke,{className:"bg-blue-100 text-blue-700 border-0",children:["Cat: ",i.catalogSold]})]})]})})]}),n.jsxs(Hi,{defaultValue:"tamanhos",children:[n.jsxs(Si,{className:"w-full",children:[n.jsx(br,{value:"tamanhos",className:"flex-1",children:"Tamanhos"}),n.jsx(br,{value:"vendedoras",className:"flex-1",children:"Vendedoras"}),n.jsx(br,{value:"acoes",className:"flex-1",children:"Aes"})]}),n.jsx(kr,{value:"tamanhos",className:"mt-4 space-y-2",children:i.bySizeData.length===0?n.jsx("p",{className:"text-muted-foreground text-sm text-center py-4",children:"Sem dados de tamanho"}):i.bySizeData.map((p,g)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-lg",children:[n.jsx(ke,{variant:"outline",className:"font-mono",children:p.size}),n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsxs("span",{className:"text-green-600",children:["Vendido: ",p.sold]}),p.reserved>0&&n.jsxs("span",{className:"text-amber-600",children:["Reservado: ",p.reserved]}),p.canceled>0&&n.jsxs("span",{className:"text-red-600",children:["Cancelado: ",p.canceled]})]})]},g))}),n.jsx(kr,{value:"vendedoras",className:"mt-4 space-y-2",children:i.bySellerData.length===0?n.jsx("p",{className:"text-muted-foreground text-sm text-center py-4",children:"Sem vendas por vendedora"}):i.bySellerData.map((p,g)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[g===0&&n.jsx("span",{className:"text-yellow-600",children:""}),n.jsx("span",{className:"font-medium",children:p.name})]}),n.jsxs("div",{className:"text-sm",children:[n.jsxs("span",{className:"text-muted-foreground",children:[p.sold," peas  "]}),n.jsx("span",{className:"text-green-600 font-medium",children:h(p.revenue)})]})]},g))}),n.jsxs(kr,{value:"acoes",className:"mt-4 space-y-3",children:[n.jsxs(he,{variant:"outline",className:"w-full justify-start gap-2",onClick:()=>m("pago"),children:[n.jsx(Zs,{className:"h-4 w-4"}),"Ver pedidos pagos"]}),n.jsxs(he,{variant:"outline",className:"w-full justify-start gap-2",onClick:()=>m("aguardando_pagamento"),children:[n.jsx(Zs,{className:"h-4 w-4"}),"Ver reservas (cobrar)"]}),n.jsxs(he,{variant:"outline",className:"w-full justify-start gap-2",onClick:()=>m("cancelado"),children:[n.jsx(Zs,{className:"h-4 w-4"}),"Ver cancelados"]})]})]}),i.dailyData.length>1&&n.jsxs($e,{children:[n.jsx(Dt,{className:"pb-2",children:n.jsxs(Lt,{className:"text-sm flex items-center gap-2",children:[n.jsx(Vs,{className:"h-4 w-4"}),"Evoluo Diria"]})}),n.jsx(Fe,{children:n.jsx("div",{className:"flex items-end gap-1 h-16",children:i.dailyData.map((p,g)=>{const x=Math.max(...i.dailyData.map(y=>y.sold),1),v=p.sold/x*100;return n.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[n.jsx("div",{className:"w-full bg-primary rounded-t",style:{height:`${v}%`,minHeight:p.sold>0?4:0}}),n.jsx("span",{className:"text-[10px] text-muted-foreground",children:f(p.date)})]},g)})})})]})]}):null]})})}const zZe=()=>{const e=pr(),[t,r]=hd(),[s,a]=P.useState({period:t.get("period")||"7d",source:t.get("source")||"all",status:t.get("status")||"pago",sellerId:t.get("seller")||null,paymentMethod:null,search:t.get("search")||""}),[i,o]=P.useState(t.get("tab")||"produtos"),[l,d]=P.useState(null),[c,u]=P.useState(t.get("sort")||"revenue"),{kpis:h,productRanking:f,sizeRanking:m,sellerRanking:p,alerts:g,sellers:x,isLoading:v,refetch:y,dateRange:b}=MZe(s),j=B=>{a(Y=>({...Y,...B}));const q=new URLSearchParams(t);Object.entries(B).forEach(([Y,G])=>{G?q.set(Y,String(G)):q.delete(Y)}),r(q)},T=()=>{const B=[...f].sort((E,N)=>c==="revenue"?N.revenue-E.revenue:N.qtySold-E.qtySold),q=["Rank","Produto","SKU","Qtd Vendida","Receita","Preo Mdio","% Live","Reservados","Converso %","Cancelados","Cancel %"],Y=B.map((E,N)=>[N+1,E.productName,E.productSku||"",E.qtySold,E.revenue.toFixed(2),E.avgPrice.toFixed(2),E.percentLive.toFixed(0),E.reservedQty,E.conversaoRate.toFixed(1),E.canceledQty,E.cancelamentoRate.toFixed(1)]),G=[q.join(","),...Y.map(E=>E.join(","))].join(`
`),I=new Blob([G],{type:"text/csv;charset=utf-8;"}),F=URL.createObjectURL(I),S=document.createElement("a");S.href=F,S.download=`ranking-produtos-${new Date().toISOString().split("T")[0]}.csv`,S.click()},O=B=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(B),R=B=>`${B.toFixed(1)}%`,D=(B,q)=>{if(q===0)return null;const Y=(B-q)/q*100,G=Y>0;return n.jsxs("span",{className:`text-xs ${G?"text-green-600":"text-red-600"}`,children:[G?"+":"",Y.toFixed(0),"%"]})};return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b border-border",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 h-14 flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>e("/dashboard"),children:n.jsx(Ts,{className:"h-5 w-5"})}),n.jsx("img",{src:bf,alt:"LE.PO",className:"h-6 hidden sm:block"}),n.jsx("div",{className:"h-6 w-px bg-border hidden sm:block"}),n.jsx("h1",{className:"text-sm sm:text-base font-semibold",children:"Centro de Inteligncia"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:y,className:"gap-2",children:[n.jsx(Qr,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Atualizar"})]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:T,className:"gap-2",children:[n.jsx(vf,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Exportar CSV"})]})]})]})}),n.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-4 sm:py-6 space-y-6",children:[n.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[n.jsxs(Xt,{value:s.period,onValueChange:B=>j({period:B}),children:[n.jsx(Ht,{className:"w-[130px]",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"today",children:"Hoje"}),n.jsx(qe,{value:"7d",children:"ltimos 7 dias"}),n.jsx(qe,{value:"30d",children:"ltimos 30 dias"}),n.jsx(qe,{value:"thisMonth",children:"Este ms"})]})]}),n.jsxs(Xt,{value:s.source,onValueChange:B=>j({source:B}),children:[n.jsx(Ht,{className:"w-[120px]",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todas origens"}),n.jsx(qe,{value:"live",children:"Live"}),n.jsx(qe,{value:"catalog",children:"Catlogo"})]})]}),n.jsxs(Xt,{value:s.status,onValueChange:B=>j({status:B}),children:[n.jsx(Ht,{className:"w-[130px]",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"pago",children:"Pagos"}),n.jsx(qe,{value:"reservado",children:"Reservados"}),n.jsx(qe,{value:"cancelado",children:"Cancelados"}),n.jsx(qe,{value:"all",children:"Todos"})]})]}),n.jsxs(Xt,{value:s.sellerId||"all",onValueChange:B=>j({sellerId:B==="all"?null:B}),children:[n.jsx(Ht,{className:"w-[140px]",children:n.jsx(Yt,{placeholder:"Vendedora"})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"all",children:"Todas vendedoras"}),x.map(B=>n.jsx(qe,{value:B.id,children:B.name},B.id))]})]}),n.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[n.jsx(On,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(et,{placeholder:"Buscar por nome ou SKU...",value:s.search,onChange:B=>j({search:B.target.value}),className:"pl-9"})]})]}),h&&n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(sz,{className:"h-3.5 w-3.5"}),"Receita"]}),n.jsx("div",{className:"text-lg font-bold",children:O(h.receita)}),D(h.receita,h.receitaPrev)]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(hn,{className:"h-3.5 w-3.5"}),"Itens vendidos"]}),n.jsx("div",{className:"text-lg font-bold",children:h.itensSold}),D(h.itensSold,h.itensSoldPrev)]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(fc,{className:"h-3.5 w-3.5"}),"Ticket mdio"]}),n.jsx("div",{className:"text-lg font-bold",children:O(h.ticketMedio)}),D(h.ticketMedio,h.ticketMedioPrev)]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(Vs,{className:"h-3.5 w-3.5"}),"Converso Live"]}),n.jsx("div",{className:"text-lg font-bold",children:R(h.conversaoLive)})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(Vs,{className:"h-3.5 w-3.5"}),"Converso Catlogo"]}),n.jsx("div",{className:"text-lg font-bold",children:R(h.conversaoCatalog)})]})}),n.jsx($e,{children:n.jsxs(Fe,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(Or,{className:"h-3.5 w-3.5"}),"Cancelamento"]}),n.jsx("div",{className:"text-lg font-bold text-red-600",children:R(h.cancelamentoRate)})]})})]}),h&&n.jsxs("div",{className:"flex gap-2 flex-wrap",children:[n.jsxs(ke,{variant:"outline",className:"gap-1",children:[n.jsx("span",{className:"w-2 h-2 rounded-full bg-pink-500"}),"Live: ",R(h.percentLive)]}),n.jsxs(ke,{variant:"outline",className:"gap-1",children:[n.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),"Catlogo: ",R(h.percentCatalog)]})]}),g.length>0&&n.jsx($e,{className:"border-amber-200 bg-amber-50",children:n.jsx(Fe,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Or,{className:"h-5 w-5 text-amber-600"}),n.jsxs("span",{className:"font-medium text-amber-800",children:[g.length," alertas ativos"]})]}),n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>o("alertas"),className:"gap-1 text-amber-700",children:["Ver todos ",n.jsx(In,{className:"h-4 w-4"})]})]})})}),n.jsxs(Hi,{value:i,onValueChange:o,children:[n.jsxs(Si,{children:[n.jsxs(br,{value:"produtos",className:"gap-2",children:[n.jsx(hn,{className:"h-4 w-4"}),"Produtos"]}),n.jsxs(br,{value:"tamanhos",className:"gap-2",children:[n.jsx(fc,{className:"h-4 w-4"}),"Tamanhos"]}),n.jsxs(br,{value:"vendedoras",className:"gap-2",children:[n.jsx(Ha,{className:"h-4 w-4"}),"Vendedoras"]}),n.jsxs(br,{value:"alertas",className:"gap-2",children:[n.jsx(Or,{className:"h-4 w-4"}),"Alertas",g.length>0&&n.jsx(ke,{variant:"destructive",className:"ml-1 h-5 w-5 p-0 text-[10px]",children:g.length})]})]}),n.jsxs(kr,{value:"produtos",className:"mt-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Ordenar por:"}),n.jsxs(Xt,{value:c,onValueChange:B=>u(B),children:[n.jsx(Ht,{className:"w-[120px]",children:n.jsx(Yt,{})}),n.jsxs(Gt,{children:[n.jsx(qe,{value:"revenue",children:"Receita"}),n.jsx(qe,{value:"qty",children:"Quantidade"})]})]})]}),n.jsxs("span",{className:"text-sm text-muted-foreground",children:[f.length," produtos"]})]}),n.jsx(IZe,{data:f,sortBy:c,isLoading:v,onProductClick:B=>d(B)})]}),n.jsx(kr,{value:"tamanhos",className:"mt-4",children:n.jsx(DZe,{data:m,isLoading:v})}),n.jsx(kr,{value:"vendedoras",className:"mt-4",children:n.jsx(LZe,{data:p,isLoading:v})}),n.jsx(kr,{value:"alertas",className:"mt-4",children:n.jsx(BZe,{alerts:g,onViewProduct:B=>d(B)})})]})]}),n.jsx(FZe,{productName:l,isOpen:!!l,onClose:()=>d(null),filters:s})]})},UZe=new zoe,VZe=()=>n.jsx(Voe,{client:UZe,children:n.jsx(Cue,{children:n.jsxs(dp,{children:[n.jsx(tae,{}),n.jsx(Rae,{}),n.jsx(Fle,{children:n.jsxs(Ole,{children:[n.jsx(Ir,{path:"/",element:n.jsx(kfe,{})}),n.jsx(Ir,{path:"/meu-estilo",element:n.jsx(tme,{})}),n.jsx(Ir,{path:"/quiz",element:n.jsx(lme,{})}),n.jsx(Ir,{path:"/resultado/:customerId",element:n.jsx(dme,{})}),n.jsx(Ir,{path:"/missao/:missionId",element:n.jsx(fme,{})}),n.jsx(Ir,{path:"/enviar-print",element:n.jsx(Cme,{})}),n.jsx(Ir,{path:"/print-story",element:n.jsx(cO,{to:"/enviar-print",replace:!0})}),n.jsx(Ir,{path:"/buscar-por-foto",element:n.jsx(cO,{to:"/enviar-print",replace:!0})}),n.jsx(Ir,{path:"/entrar",element:n.jsx(vpe,{})}),n.jsx(Ir,{path:"/auth/callback",element:n.jsx(ype,{})}),n.jsx(Ir,{path:"/esqueci-senha",element:n.jsx(bpe,{})}),n.jsx(Ir,{path:"/redefinir-senha",element:n.jsx(_pe,{})}),n.jsx(Ir,{path:"/resetar-senha",element:n.jsx(Npe,{})}),n.jsx(Ir,{path:"/minha-conta",element:n.jsx(rje,{})}),n.jsx(Ir,{path:"/minha-conta/club",element:n.jsx(FSe,{})}),n.jsx(Ir,{path:"/minha-conta/missoes",element:n.jsx(zSe,{})}),n.jsx(Ir,{path:"/minha-conta/auth",element:n.jsx(Q_e,{})}),n.jsx(Ir,{path:"/meus-pedidos",element:n.jsx(VSe,{})}),n.jsx(Ir,{path:"/meus-pedidos/:id",element:n.jsx(qSe,{})}),n.jsx(Ir,{path:"/meus-prints",element:n.jsx(WSe,{})}),n.jsx(Ir,{path:"/meu-perfil",element:n.jsx(KSe,{})}),n.jsx(Ir,{path:"/minhas-sugestoes",element:n.jsx(XSe,{})}),n.jsx(Ir,{path:"/meus-favoritos",element:n.jsx(YSe,{})}),n.jsx(Ir,{path:"/login",element:n.jsx(vR,{})}),n.jsx(Ir,{path:"/area-lojista",element:n.jsx(vR,{})}),n.jsx(Ir,{path:"/dashboard",element:n.jsx(Dwe,{})}),n.jsx(Ir,{path:"/dashboard/clientes/:id",element:n.jsx(G_e,{})}),n.jsx(Ir,{path:"/dashboard/lives/relatorio",element:n.jsx(RXe,{})}),n.jsx(Ir,{path:"/dashboard/lives/rastreador",element:n.jsx(pZe,{})}),n.jsx(Ir,{path:"/dashboard/lives/:eventId/planejar",element:n.jsx(rCe,{})}),n.jsx(Ir,{path:"/dashboard/lives/:eventId/backstage",element:n.jsx(ACe,{})}),n.jsx(Ir,{path:"/dashboard/lives/:eventId/relatorio",element:n.jsx(jXe,{})}),n.jsx(Ir,{path:"/dashboard/lives/:eventId/pedidos",element:n.jsx(PZe,{})}),n.jsx(Ir,{path:"/dashboard/lives/:eventId/pendencias",element:n.jsx(RZe,{})}),n.jsx(Ir,{path:"/dashboard/lives/:eventId/separacao",element:n.jsx(rZe,{})}),n.jsx(Ir,{path:"/dashboard/insights",element:n.jsx(zZe,{})}),n.jsx(Ir,{path:"/importar-estoque",element:n.jsx(v2e,{})}),n.jsx(Ir,{path:"/catalogo",element:n.jsx(Fwe,{})}),n.jsx(Ir,{path:"/produto/:productId",element:n.jsx(zwe,{})}),n.jsx(Ir,{path:"/carrinho",element:n.jsx(Uwe,{})}),n.jsx(Ir,{path:"/checkout",element:n.jsx(o2e,{})}),n.jsx(Ir,{path:"/pedido/sucesso",element:n.jsx(ZSe,{})}),n.jsx(Ir,{path:"/pedido/pendente",element:n.jsx(QSe,{})}),n.jsx(Ir,{path:"/pedido/erro",element:n.jsx(eCe,{})}),n.jsx(Ir,{path:"/live-checkout/:cartId",element:n.jsx(aZe,{})}),n.jsx(Ir,{path:"/sacola/:bagId",element:n.jsx(lZe,{})}),n.jsx(Ir,{path:"/c/:link",element:n.jsx(K_e,{})}),n.jsx(Ir,{path:"*",element:n.jsx(X_e,{})})]})})]})})});yF(document.getElementById("root")).render(n.jsx(VZe,{}))});export default qZe();
