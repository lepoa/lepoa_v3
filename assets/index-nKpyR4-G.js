var XT=e=>{throw TypeError(e)};var Pte=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var NN=(e,t,r)=>t.has(e)||XT("Cannot "+r);var Nt=(e,t,r)=>(NN(e,t,"read from private field"),r?r.call(e):t.get(e)),kn=(e,t,r)=>t.has(e)?XT("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Gr=(e,t,r,s)=>(NN(e,t,"write to private field"),s?s.call(e,r):t.set(e,r),r),ei=(e,t,r)=>(NN(e,t,"access private method"),r);var ay=(e,t,r,s)=>({set _(a){Gr(e,t,a,r)},get _(){return Nt(e,t,s)}});var tet=Pte((jet,k1)=>{function JB(e,t){for(var r=0;r<t.length;r++){const s=t[r];if(typeof s!="string"&&!Array.isArray(s)){for(const a in s)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(s,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>s[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Ur=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function On(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var e$={exports:{}},a_={},t$={exports:{}},un={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i1=Symbol.for("react.element"),Ote=Symbol.for("react.portal"),Rte=Symbol.for("react.fragment"),Mte=Symbol.for("react.strict_mode"),Ite=Symbol.for("react.profiler"),Dte=Symbol.for("react.provider"),Lte=Symbol.for("react.context"),Bte=Symbol.for("react.forward_ref"),$te=Symbol.for("react.suspense"),Fte=Symbol.for("react.memo"),zte=Symbol.for("react.lazy"),YT=Symbol.iterator;function Ute(e){return e===null||typeof e!="object"?null:(e=YT&&e[YT]||e["@@iterator"],typeof e=="function"?e:null)}var r$={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},n$=Object.assign,s$={};function ug(e,t,r){this.props=e,this.context=t,this.refs=s$,this.updater=r||r$}ug.prototype.isReactComponent={};ug.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};ug.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function a$(){}a$.prototype=ug.prototype;function s6(e,t,r){this.props=e,this.context=t,this.refs=s$,this.updater=r||r$}var a6=s6.prototype=new a$;a6.constructor=s6;n$(a6,ug.prototype);a6.isPureReactComponent=!0;var ZT=Array.isArray,i$=Object.prototype.hasOwnProperty,i6={current:null},o$={key:!0,ref:!0,__self:!0,__source:!0};function l$(e,t,r){var s,a={},i=null,o=null;if(t!=null)for(s in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)i$.call(t,s)&&!o$.hasOwnProperty(s)&&(a[s]=t[s]);var c=arguments.length-2;if(c===1)a.children=r;else if(1<c){for(var d=Array(c),l=0;l<c;l++)d[l]=arguments[l+2];a.children=d}if(e&&e.defaultProps)for(s in c=e.defaultProps,c)a[s]===void 0&&(a[s]=c[s]);return{$$typeof:i1,type:e,key:i,ref:o,props:a,_owner:i6.current}}function Vte(e,t){return{$$typeof:i1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function o6(e){return typeof e=="object"&&e!==null&&e.$$typeof===i1}function qte(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var QT=/\/+/g;function SN(e,t){return typeof e=="object"&&e!==null&&e.key!=null?qte(""+e.key):t.toString(36)}function vb(e,t,r,s,a){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case i1:case Ote:o=!0}}if(o)return o=e,a=a(o),e=s===""?"."+SN(o,0):s,ZT(a)?(r="",e!=null&&(r=e.replace(QT,"$&/")+"/"),vb(a,t,r,"",function(l){return l})):a!=null&&(o6(a)&&(a=Vte(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(QT,"$&/")+"/")+e)),t.push(a)),1;if(o=0,s=s===""?".":s+":",ZT(e))for(var c=0;c<e.length;c++){i=e[c];var d=s+SN(i,c);o+=vb(i,t,r,d,a)}else if(d=Ute(e),typeof d=="function")for(e=d.call(e),c=0;!(i=e.next()).done;)i=i.value,d=s+SN(i,c++),o+=vb(i,t,r,d,a);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function iy(e,t,r){if(e==null)return e;var s=[],a=0;return vb(e,s,"","",function(i){return t.call(r,i,a++)}),s}function Wte(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Pi={current:null},yb={transition:null},Hte={ReactCurrentDispatcher:Pi,ReactCurrentBatchConfig:yb,ReactCurrentOwner:i6};function c$(){throw Error("act(...) is not supported in production builds of React.")}un.Children={map:iy,forEach:function(e,t,r){iy(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return iy(e,function(){t++}),t},toArray:function(e){return iy(e,function(t){return t})||[]},only:function(e){if(!o6(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};un.Component=ug;un.Fragment=Rte;un.Profiler=Ite;un.PureComponent=s6;un.StrictMode=Mte;un.Suspense=$te;un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Hte;un.act=c$;un.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=n$({},e.props),a=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=i6.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(d in t)i$.call(t,d)&&!o$.hasOwnProperty(d)&&(s[d]=t[d]===void 0&&c!==void 0?c[d]:t[d])}var d=arguments.length-2;if(d===1)s.children=r;else if(1<d){c=Array(d);for(var l=0;l<d;l++)c[l]=arguments[l+2];s.children=c}return{$$typeof:i1,type:e.type,key:a,ref:i,props:s,_owner:o}};un.createContext=function(e){return e={$$typeof:Lte,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Dte,_context:e},e.Consumer=e};un.createElement=l$;un.createFactory=function(e){var t=l$.bind(null,e);return t.type=e,t};un.createRef=function(){return{current:null}};un.forwardRef=function(e){return{$$typeof:Bte,render:e}};un.isValidElement=o6;un.lazy=function(e){return{$$typeof:zte,_payload:{_status:-1,_result:e},_init:Wte}};un.memo=function(e,t){return{$$typeof:Fte,type:e,compare:t===void 0?null:t}};un.startTransition=function(e){var t=yb.transition;yb.transition={};try{e()}finally{yb.transition=t}};un.unstable_act=c$;un.useCallback=function(e,t){return Pi.current.useCallback(e,t)};un.useContext=function(e){return Pi.current.useContext(e)};un.useDebugValue=function(){};un.useDeferredValue=function(e){return Pi.current.useDeferredValue(e)};un.useEffect=function(e,t){return Pi.current.useEffect(e,t)};un.useId=function(){return Pi.current.useId()};un.useImperativeHandle=function(e,t,r){return Pi.current.useImperativeHandle(e,t,r)};un.useInsertionEffect=function(e,t){return Pi.current.useInsertionEffect(e,t)};un.useLayoutEffect=function(e,t){return Pi.current.useLayoutEffect(e,t)};un.useMemo=function(e,t){return Pi.current.useMemo(e,t)};un.useReducer=function(e,t,r){return Pi.current.useReducer(e,t,r)};un.useRef=function(e){return Pi.current.useRef(e)};un.useState=function(e){return Pi.current.useState(e)};un.useSyncExternalStore=function(e,t,r){return Pi.current.useSyncExternalStore(e,t,r)};un.useTransition=function(){return Pi.current.useTransition()};un.version="18.3.1";t$.exports=un;var P=t$.exports;const we=On(P),l6=JB({__proto__:null,default:we},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gte=P,Kte=Symbol.for("react.element"),Xte=Symbol.for("react.fragment"),Yte=Object.prototype.hasOwnProperty,Zte=Gte.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Qte={key:!0,ref:!0,__self:!0,__source:!0};function d$(e,t,r){var s,a={},i=null,o=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(s in t)Yte.call(t,s)&&!Qte.hasOwnProperty(s)&&(a[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps,t)a[s]===void 0&&(a[s]=t[s]);return{$$typeof:Kte,type:e,key:i,ref:o,props:a,_owner:Zte.current}}a_.Fragment=Xte;a_.jsx=d$;a_.jsxs=d$;e$.exports=a_;var n=e$.exports,u$={exports:{}},Co={},h$={exports:{}},f$={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(C,k){var I=C.length;C.push(k);e:for(;0<I;){var U=I-1>>>1,$=C[U];if(0<a($,k))C[U]=k,C[I]=$,I=U;else break e}}function r(C){return C.length===0?null:C[0]}function s(C){if(C.length===0)return null;var k=C[0],I=C.pop();if(I!==k){C[0]=I;e:for(var U=0,$=C.length,Y=$>>>1;U<Y;){var Z=2*(U+1)-1,re=C[Z],G=Z+1,J=C[G];if(0>a(re,I))G<$&&0>a(J,re)?(C[U]=J,C[G]=I,U=G):(C[U]=re,C[Z]=I,U=Z);else if(G<$&&0>a(J,I))C[U]=J,C[G]=I,U=G;else break e}}return k}function a(C,k){var I=C.sortIndex-k.sortIndex;return I!==0?I:C.id-k.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,c=o.now();e.unstable_now=function(){return o.now()-c}}var d=[],l=[],u=1,h=null,f=3,m=!1,p=!1,g=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(C){for(var k=r(l);k!==null;){if(k.callback===null)s(l);else if(k.startTime<=C)s(l),k.sortIndex=k.expirationTime,t(d,k);else break;k=r(l)}}function j(C){if(g=!1,b(C),!p)if(r(d)!==null)p=!0,E(T);else{var k=r(l);k!==null&&N(j,k.startTime-C)}}function T(C,k){p=!1,g&&(g=!1,x(D),D=-1),m=!0;var I=f;try{for(b(k),h=r(d);h!==null&&(!(h.expirationTime>k)||C&&!X());){var U=h.callback;if(typeof U=="function"){h.callback=null,f=h.priorityLevel;var $=U(h.expirationTime<=k);k=e.unstable_now(),typeof $=="function"?h.callback=$:h===r(d)&&s(d),b(k)}else s(d);h=r(d)}if(h!==null)var Y=!0;else{var Z=r(l);Z!==null&&N(j,Z.startTime-k),Y=!1}return Y}finally{h=null,f=I,m=!1}}var O=!1,R=null,D=-1,L=5,q=-1;function X(){return!(e.unstable_now()-q<L)}function H(){if(R!==null){var C=e.unstable_now();q=C;var k=!0;try{k=R(!0,C)}finally{k?M():(O=!1,R=null)}}else O=!1}var M;if(typeof y=="function")M=function(){y(H)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,S=F.port2;F.port1.onmessage=H,M=function(){S.postMessage(null)}}else M=function(){v(H,0)};function E(C){R=C,O||(O=!0,M())}function N(C,k){D=v(function(){C(e.unstable_now())},k)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(C){C.callback=null},e.unstable_continueExecution=function(){p||m||(p=!0,E(T))},e.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<C?Math.floor(1e3/C):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return r(d)},e.unstable_next=function(C){switch(f){case 1:case 2:case 3:var k=3;break;default:k=f}var I=f;f=k;try{return C()}finally{f=I}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(C,k){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var I=f;f=C;try{return k()}finally{f=I}},e.unstable_scheduleCallback=function(C,k,I){var U=e.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?U+I:U):I=U,C){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=I+$,C={id:u++,callback:k,priorityLevel:C,startTime:I,expirationTime:$,sortIndex:-1},I>U?(C.sortIndex=I,t(l,C),r(d)===null&&C===r(l)&&(g?(x(D),D=-1):g=!0,N(j,I-U))):(C.sortIndex=$,t(d,C),p||m||(p=!0,E(T))),C},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(C){var k=f;return function(){var I=f;f=k;try{return C.apply(this,arguments)}finally{f=I}}}})(f$);h$.exports=f$;var Jte=h$.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ere=P,wo=Jte;function Bt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var m$=new Set,Sx={};function Cf(e,t){up(e,t),up(e+"Capture",t)}function up(e,t){for(Sx[e]=t,e=0;e<t.length;e++)m$.add(t[e])}var ad=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),J4=Object.prototype.hasOwnProperty,tre=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,JT={},eP={};function rre(e){return J4.call(eP,e)?!0:J4.call(JT,e)?!1:tre.test(e)?eP[e]=!0:(JT[e]=!0,!1)}function nre(e,t,r,s){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return s?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function sre(e,t,r,s){if(t===null||typeof t>"u"||nre(e,t,r,s))return!0;if(s)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Oi(e,t,r,s,a,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=s,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Ya={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ya[e]=new Oi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ya[t]=new Oi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ya[e]=new Oi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ya[e]=new Oi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ya[e]=new Oi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ya[e]=new Oi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ya[e]=new Oi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ya[e]=new Oi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ya[e]=new Oi(e,5,!1,e.toLowerCase(),null,!1,!1)});var c6=/[\-:]([a-z])/g;function d6(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(c6,d6);Ya[t]=new Oi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(c6,d6);Ya[t]=new Oi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(c6,d6);Ya[t]=new Oi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ya[e]=new Oi(e,1,!1,e.toLowerCase(),null,!1,!1)});Ya.xlinkHref=new Oi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ya[e]=new Oi(e,1,!1,e.toLowerCase(),null,!0,!0)});function u6(e,t,r,s){var a=Ya.hasOwnProperty(t)?Ya[t]:null;(a!==null?a.type!==0:s||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(sre(t,r,a,s)&&(r=null),s||a===null?rre(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,s=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,s?e.setAttributeNS(s,t,r):e.setAttribute(t,r))))}var bd=ere.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,oy=Symbol.for("react.element"),pm=Symbol.for("react.portal"),gm=Symbol.for("react.fragment"),h6=Symbol.for("react.strict_mode"),eS=Symbol.for("react.profiler"),p$=Symbol.for("react.provider"),g$=Symbol.for("react.context"),f6=Symbol.for("react.forward_ref"),tS=Symbol.for("react.suspense"),rS=Symbol.for("react.suspense_list"),m6=Symbol.for("react.memo"),Vd=Symbol.for("react.lazy"),x$=Symbol.for("react.offscreen"),tP=Symbol.iterator;function i0(e){return e===null||typeof e!="object"?null:(e=tP&&e[tP]||e["@@iterator"],typeof e=="function"?e:null)}var Rs=Object.assign,CN;function F0(e){if(CN===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);CN=t&&t[1]||""}return`
`+CN+e}var EN=!1;function kN(e,t){if(!e||EN)return"";EN=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var s=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){s=l}e.call(t.prototype)}else{try{throw Error()}catch(l){s=l}e()}}catch(l){if(l&&s&&typeof l.stack=="string"){for(var a=l.stack.split(`
`),i=s.stack.split(`
`),o=a.length-1,c=i.length-1;1<=o&&0<=c&&a[o]!==i[c];)c--;for(;1<=o&&0<=c;o--,c--)if(a[o]!==i[c]){if(o!==1||c!==1)do if(o--,c--,0>c||a[o]!==i[c]){var d=`
`+a[o].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=o&&0<=c);break}}}finally{EN=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?F0(e):""}function are(e){switch(e.tag){case 5:return F0(e.type);case 16:return F0("Lazy");case 13:return F0("Suspense");case 19:return F0("SuspenseList");case 0:case 2:case 15:return e=kN(e.type,!1),e;case 11:return e=kN(e.type.render,!1),e;case 1:return e=kN(e.type,!0),e;default:return""}}function nS(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case gm:return"Fragment";case pm:return"Portal";case eS:return"Profiler";case h6:return"StrictMode";case tS:return"Suspense";case rS:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case g$:return(e.displayName||"Context")+".Consumer";case p$:return(e._context.displayName||"Context")+".Provider";case f6:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case m6:return t=e.displayName||null,t!==null?t:nS(e.type)||"Memo";case Vd:t=e._payload,e=e._init;try{return nS(e(t))}catch{}}return null}function ire(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return nS(t);case 8:return t===h6?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Su(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function v$(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ore(e){var t=v$(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,i=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ly(e){e._valueTracker||(e._valueTracker=ore(e))}function y$(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),s="";return e&&(s=v$(e)?e.checked?"true":"false":e.value),e=s,e!==r?(t.setValue(e),!0):!1}function Vb(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function sS(e,t){var r=t.checked;return Rs({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function rP(e,t){var r=t.defaultValue==null?"":t.defaultValue,s=t.checked!=null?t.checked:t.defaultChecked;r=Su(t.value!=null?t.value:r),e._wrapperState={initialChecked:s,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function b$(e,t){t=t.checked,t!=null&&u6(e,"checked",t,!1)}function aS(e,t){b$(e,t);var r=Su(t.value),s=t.type;if(r!=null)s==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(s==="submit"||s==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?iS(e,t.type,r):t.hasOwnProperty("defaultValue")&&iS(e,t.type,Su(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function nP(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var s=t.type;if(!(s!=="submit"&&s!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function iS(e,t,r){(t!=="number"||Vb(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var z0=Array.isArray;function $m(e,t,r,s){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&s&&(e[r].defaultSelected=!0)}else{for(r=""+Su(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,s&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function oS(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Bt(91));return Rs({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function sP(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Bt(92));if(z0(r)){if(1<r.length)throw Error(Bt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Su(r)}}function w$(e,t){var r=Su(t.value),s=Su(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),s!=null&&(e.defaultValue=""+s)}function aP(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function _$(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lS(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?_$(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var cy,j$=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,s,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,s,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(cy=cy||document.createElement("div"),cy.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=cy.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Cx(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var J0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lre=["Webkit","ms","Moz","O"];Object.keys(J0).forEach(function(e){lre.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),J0[t]=J0[e]})});function N$(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||J0.hasOwnProperty(e)&&J0[e]?(""+t).trim():t+"px"}function S$(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var s=r.indexOf("--")===0,a=N$(r,t[r],s);r==="float"&&(r="cssFloat"),s?e.setProperty(r,a):e[r]=a}}var cre=Rs({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cS(e,t){if(t){if(cre[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Bt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Bt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Bt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Bt(62))}}function dS(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var uS=null;function p6(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hS=null,Fm=null,zm=null;function iP(e){if(e=c1(e)){if(typeof hS!="function")throw Error(Bt(280));var t=e.stateNode;t&&(t=d_(t),hS(e.stateNode,e.type,t))}}function C$(e){Fm?zm?zm.push(e):zm=[e]:Fm=e}function E$(){if(Fm){var e=Fm,t=zm;if(zm=Fm=null,iP(e),t)for(e=0;e<t.length;e++)iP(t[e])}}function k$(e,t){return e(t)}function A$(){}var AN=!1;function T$(e,t,r){if(AN)return e(t,r);AN=!0;try{return k$(e,t,r)}finally{AN=!1,(Fm!==null||zm!==null)&&(A$(),E$())}}function Ex(e,t){var r=e.stateNode;if(r===null)return null;var s=d_(r);if(s===null)return null;r=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Bt(231,t,typeof r));return r}var fS=!1;if(ad)try{var o0={};Object.defineProperty(o0,"passive",{get:function(){fS=!0}}),window.addEventListener("test",o0,o0),window.removeEventListener("test",o0,o0)}catch{fS=!1}function dre(e,t,r,s,a,i,o,c,d){var l=Array.prototype.slice.call(arguments,3);try{t.apply(r,l)}catch(u){this.onError(u)}}var ex=!1,qb=null,Wb=!1,mS=null,ure={onError:function(e){ex=!0,qb=e}};function hre(e,t,r,s,a,i,o,c,d){ex=!1,qb=null,dre.apply(ure,arguments)}function fre(e,t,r,s,a,i,o,c,d){if(hre.apply(this,arguments),ex){if(ex){var l=qb;ex=!1,qb=null}else throw Error(Bt(198));Wb||(Wb=!0,mS=l)}}function Ef(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function P$(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function oP(e){if(Ef(e)!==e)throw Error(Bt(188))}function mre(e){var t=e.alternate;if(!t){if(t=Ef(e),t===null)throw Error(Bt(188));return t!==e?null:e}for(var r=e,s=t;;){var a=r.return;if(a===null)break;var i=a.alternate;if(i===null){if(s=a.return,s!==null){r=s;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===r)return oP(a),e;if(i===s)return oP(a),t;i=i.sibling}throw Error(Bt(188))}if(r.return!==s.return)r=a,s=i;else{for(var o=!1,c=a.child;c;){if(c===r){o=!0,r=a,s=i;break}if(c===s){o=!0,s=a,r=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===r){o=!0,r=i,s=a;break}if(c===s){o=!0,s=i,r=a;break}c=c.sibling}if(!o)throw Error(Bt(189))}}if(r.alternate!==s)throw Error(Bt(190))}if(r.tag!==3)throw Error(Bt(188));return r.stateNode.current===r?e:t}function O$(e){return e=mre(e),e!==null?R$(e):null}function R$(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=R$(e);if(t!==null)return t;e=e.sibling}return null}var M$=wo.unstable_scheduleCallback,lP=wo.unstable_cancelCallback,pre=wo.unstable_shouldYield,gre=wo.unstable_requestPaint,qs=wo.unstable_now,xre=wo.unstable_getCurrentPriorityLevel,g6=wo.unstable_ImmediatePriority,I$=wo.unstable_UserBlockingPriority,Hb=wo.unstable_NormalPriority,vre=wo.unstable_LowPriority,D$=wo.unstable_IdlePriority,i_=null,lc=null;function yre(e){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(i_,e,void 0,(e.current.flags&128)===128)}catch{}}var Sl=Math.clz32?Math.clz32:_re,bre=Math.log,wre=Math.LN2;function _re(e){return e>>>=0,e===0?32:31-(bre(e)/wre|0)|0}var dy=64,uy=4194304;function U0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Gb(e,t){var r=e.pendingLanes;if(r===0)return 0;var s=0,a=e.suspendedLanes,i=e.pingedLanes,o=r&268435455;if(o!==0){var c=o&~a;c!==0?s=U0(c):(i&=o,i!==0&&(s=U0(i)))}else o=r&~a,o!==0?s=U0(o):i!==0&&(s=U0(i));if(s===0)return 0;if(t!==0&&t!==s&&!(t&a)&&(a=s&-s,i=t&-t,a>=i||a===16&&(i&4194240)!==0))return t;if(s&4&&(s|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=s;0<t;)r=31-Sl(t),a=1<<r,s|=e[r],t&=~a;return s}function jre(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nre(e,t){for(var r=e.suspendedLanes,s=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Sl(i),c=1<<o,d=a[o];d===-1?(!(c&r)||c&s)&&(a[o]=jre(c,t)):d<=t&&(e.expiredLanes|=c),i&=~c}}function pS(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function L$(){var e=dy;return dy<<=1,!(dy&4194240)&&(dy=64),e}function TN(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function o1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Sl(t),e[t]=r}function Sre(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var s=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Sl(r),i=1<<a;t[a]=0,s[a]=-1,e[a]=-1,r&=~i}}function x6(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var s=31-Sl(r),a=1<<s;a&t|e[s]&t&&(e[s]|=t),r&=~a}}var $n=0;function B$(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var $$,v6,F$,z$,U$,gS=!1,hy=[],fu=null,mu=null,pu=null,kx=new Map,Ax=new Map,Kd=[],Cre="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cP(e,t){switch(e){case"focusin":case"focusout":fu=null;break;case"dragenter":case"dragleave":mu=null;break;case"mouseover":case"mouseout":pu=null;break;case"pointerover":case"pointerout":kx.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ax.delete(t.pointerId)}}function l0(e,t,r,s,a,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:r,eventSystemFlags:s,nativeEvent:i,targetContainers:[a]},t!==null&&(t=c1(t),t!==null&&v6(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function Ere(e,t,r,s,a){switch(t){case"focusin":return fu=l0(fu,e,t,r,s,a),!0;case"dragenter":return mu=l0(mu,e,t,r,s,a),!0;case"mouseover":return pu=l0(pu,e,t,r,s,a),!0;case"pointerover":var i=a.pointerId;return kx.set(i,l0(kx.get(i)||null,e,t,r,s,a)),!0;case"gotpointercapture":return i=a.pointerId,Ax.set(i,l0(Ax.get(i)||null,e,t,r,s,a)),!0}return!1}function V$(e){var t=Eh(e.target);if(t!==null){var r=Ef(t);if(r!==null){if(t=r.tag,t===13){if(t=P$(r),t!==null){e.blockedOn=t,U$(e.priority,function(){F$(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function bb(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=xS(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var s=new r.constructor(r.type,r);uS=s,r.target.dispatchEvent(s),uS=null}else return t=c1(r),t!==null&&v6(t),e.blockedOn=r,!1;t.shift()}return!0}function dP(e,t,r){bb(e)&&r.delete(t)}function kre(){gS=!1,fu!==null&&bb(fu)&&(fu=null),mu!==null&&bb(mu)&&(mu=null),pu!==null&&bb(pu)&&(pu=null),kx.forEach(dP),Ax.forEach(dP)}function c0(e,t){e.blockedOn===t&&(e.blockedOn=null,gS||(gS=!0,wo.unstable_scheduleCallback(wo.unstable_NormalPriority,kre)))}function Tx(e){function t(a){return c0(a,e)}if(0<hy.length){c0(hy[0],e);for(var r=1;r<hy.length;r++){var s=hy[r];s.blockedOn===e&&(s.blockedOn=null)}}for(fu!==null&&c0(fu,e),mu!==null&&c0(mu,e),pu!==null&&c0(pu,e),kx.forEach(t),Ax.forEach(t),r=0;r<Kd.length;r++)s=Kd[r],s.blockedOn===e&&(s.blockedOn=null);for(;0<Kd.length&&(r=Kd[0],r.blockedOn===null);)V$(r),r.blockedOn===null&&Kd.shift()}var Um=bd.ReactCurrentBatchConfig,Kb=!0;function Are(e,t,r,s){var a=$n,i=Um.transition;Um.transition=null;try{$n=1,y6(e,t,r,s)}finally{$n=a,Um.transition=i}}function Tre(e,t,r,s){var a=$n,i=Um.transition;Um.transition=null;try{$n=4,y6(e,t,r,s)}finally{$n=a,Um.transition=i}}function y6(e,t,r,s){if(Kb){var a=xS(e,t,r,s);if(a===null)FN(e,t,s,Xb,r),cP(e,s);else if(Ere(a,e,t,r,s))s.stopPropagation();else if(cP(e,s),t&4&&-1<Cre.indexOf(e)){for(;a!==null;){var i=c1(a);if(i!==null&&$$(i),i=xS(e,t,r,s),i===null&&FN(e,t,s,Xb,r),i===a)break;a=i}a!==null&&s.stopPropagation()}else FN(e,t,s,null,r)}}var Xb=null;function xS(e,t,r,s){if(Xb=null,e=p6(s),e=Eh(e),e!==null)if(t=Ef(e),t===null)e=null;else if(r=t.tag,r===13){if(e=P$(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xb=e,null}function q$(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xre()){case g6:return 1;case I$:return 4;case Hb:case vre:return 16;case D$:return 536870912;default:return 16}default:return 16}}var nu=null,b6=null,wb=null;function W$(){if(wb)return wb;var e,t=b6,r=t.length,s,a="value"in nu?nu.value:nu.textContent,i=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(s=1;s<=o&&t[r-s]===a[i-s];s++);return wb=a.slice(e,1<s?1-s:void 0)}function _b(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function fy(){return!0}function uP(){return!1}function Eo(e){function t(r,s,a,i,o){this._reactName=r,this._targetInst=a,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(r=e[c],this[c]=r?r(i):i[c]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?fy:uP,this.isPropagationStopped=uP,this}return Rs(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=fy)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=fy)},persist:function(){},isPersistent:fy}),t}var hg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},w6=Eo(hg),l1=Rs({},hg,{view:0,detail:0}),Pre=Eo(l1),PN,ON,d0,o_=Rs({},l1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_6,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==d0&&(d0&&e.type==="mousemove"?(PN=e.screenX-d0.screenX,ON=e.screenY-d0.screenY):ON=PN=0,d0=e),PN)},movementY:function(e){return"movementY"in e?e.movementY:ON}}),hP=Eo(o_),Ore=Rs({},o_,{dataTransfer:0}),Rre=Eo(Ore),Mre=Rs({},l1,{relatedTarget:0}),RN=Eo(Mre),Ire=Rs({},hg,{animationName:0,elapsedTime:0,pseudoElement:0}),Dre=Eo(Ire),Lre=Rs({},hg,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Bre=Eo(Lre),$re=Rs({},hg,{data:0}),fP=Eo($re),Fre={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zre={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ure={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vre(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Ure[e])?!!t[e]:!1}function _6(){return Vre}var qre=Rs({},l1,{key:function(e){if(e.key){var t=Fre[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=_b(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?zre[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_6,charCode:function(e){return e.type==="keypress"?_b(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?_b(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Wre=Eo(qre),Hre=Rs({},o_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),mP=Eo(Hre),Gre=Rs({},l1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_6}),Kre=Eo(Gre),Xre=Rs({},hg,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yre=Eo(Xre),Zre=Rs({},o_,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Qre=Eo(Zre),Jre=[9,13,27,32],j6=ad&&"CompositionEvent"in window,tx=null;ad&&"documentMode"in document&&(tx=document.documentMode);var ene=ad&&"TextEvent"in window&&!tx,H$=ad&&(!j6||tx&&8<tx&&11>=tx),pP=" ",gP=!1;function G$(e,t){switch(e){case"keyup":return Jre.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function K$(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xm=!1;function tne(e,t){switch(e){case"compositionend":return K$(t);case"keypress":return t.which!==32?null:(gP=!0,pP);case"textInput":return e=t.data,e===pP&&gP?null:e;default:return null}}function rne(e,t){if(xm)return e==="compositionend"||!j6&&G$(e,t)?(e=W$(),wb=b6=nu=null,xm=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return H$&&t.locale!=="ko"?null:t.data;default:return null}}var nne={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xP(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!nne[e.type]:t==="textarea"}function X$(e,t,r,s){C$(s),t=Yb(t,"onChange"),0<t.length&&(r=new w6("onChange","change",null,r,s),e.push({event:r,listeners:t}))}var rx=null,Px=null;function sne(e){iF(e,0)}function l_(e){var t=bm(e);if(y$(t))return e}function ane(e,t){if(e==="change")return t}var Y$=!1;if(ad){var MN;if(ad){var IN="oninput"in document;if(!IN){var vP=document.createElement("div");vP.setAttribute("oninput","return;"),IN=typeof vP.oninput=="function"}MN=IN}else MN=!1;Y$=MN&&(!document.documentMode||9<document.documentMode)}function yP(){rx&&(rx.detachEvent("onpropertychange",Z$),Px=rx=null)}function Z$(e){if(e.propertyName==="value"&&l_(Px)){var t=[];X$(t,Px,e,p6(e)),T$(sne,t)}}function ine(e,t,r){e==="focusin"?(yP(),rx=t,Px=r,rx.attachEvent("onpropertychange",Z$)):e==="focusout"&&yP()}function one(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return l_(Px)}function lne(e,t){if(e==="click")return l_(t)}function cne(e,t){if(e==="input"||e==="change")return l_(t)}function dne(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tl=typeof Object.is=="function"?Object.is:dne;function Ox(e,t){if(Tl(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;for(s=0;s<r.length;s++){var a=r[s];if(!J4.call(t,a)||!Tl(e[a],t[a]))return!1}return!0}function bP(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function wP(e,t){var r=bP(e);e=0;for(var s;r;){if(r.nodeType===3){if(s=e+r.textContent.length,e<=t&&s>=t)return{node:r,offset:t-e};e=s}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=bP(r)}}function Q$(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Q$(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function J$(){for(var e=window,t=Vb();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Vb(e.document)}return t}function N6(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function une(e){var t=J$(),r=e.focusedElem,s=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Q$(r.ownerDocument.documentElement,r)){if(s!==null&&N6(r)){if(t=s.start,e=s.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,i=Math.min(s.start,a);s=s.end===void 0?i:Math.min(s.end,a),!e.extend&&i>s&&(a=s,s=i,i=a),a=wP(r,i);var o=wP(r,s);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),i>s?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var hne=ad&&"documentMode"in document&&11>=document.documentMode,vm=null,vS=null,nx=null,yS=!1;function _P(e,t,r){var s=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;yS||vm==null||vm!==Vb(s)||(s=vm,"selectionStart"in s&&N6(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),nx&&Ox(nx,s)||(nx=s,s=Yb(vS,"onSelect"),0<s.length&&(t=new w6("onSelect","select",null,t,r),e.push({event:t,listeners:s}),t.target=vm)))}function my(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var ym={animationend:my("Animation","AnimationEnd"),animationiteration:my("Animation","AnimationIteration"),animationstart:my("Animation","AnimationStart"),transitionend:my("Transition","TransitionEnd")},DN={},eF={};ad&&(eF=document.createElement("div").style,"AnimationEvent"in window||(delete ym.animationend.animation,delete ym.animationiteration.animation,delete ym.animationstart.animation),"TransitionEvent"in window||delete ym.transitionend.transition);function c_(e){if(DN[e])return DN[e];if(!ym[e])return e;var t=ym[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in eF)return DN[e]=t[r];return e}var tF=c_("animationend"),rF=c_("animationiteration"),nF=c_("animationstart"),sF=c_("transitionend"),aF=new Map,jP="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lu(e,t){aF.set(e,t),Cf(t,[e])}for(var LN=0;LN<jP.length;LN++){var BN=jP[LN],fne=BN.toLowerCase(),mne=BN[0].toUpperCase()+BN.slice(1);Lu(fne,"on"+mne)}Lu(tF,"onAnimationEnd");Lu(rF,"onAnimationIteration");Lu(nF,"onAnimationStart");Lu("dblclick","onDoubleClick");Lu("focusin","onFocus");Lu("focusout","onBlur");Lu(sF,"onTransitionEnd");up("onMouseEnter",["mouseout","mouseover"]);up("onMouseLeave",["mouseout","mouseover"]);up("onPointerEnter",["pointerout","pointerover"]);up("onPointerLeave",["pointerout","pointerover"]);Cf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var V0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pne=new Set("cancel close invalid load scroll toggle".split(" ").concat(V0));function NP(e,t,r){var s=e.type||"unknown-event";e.currentTarget=r,fre(s,t,void 0,e),e.currentTarget=null}function iF(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var s=e[r],a=s.event;s=s.listeners;e:{var i=void 0;if(t)for(var o=s.length-1;0<=o;o--){var c=s[o],d=c.instance,l=c.currentTarget;if(c=c.listener,d!==i&&a.isPropagationStopped())break e;NP(a,c,l),i=d}else for(o=0;o<s.length;o++){if(c=s[o],d=c.instance,l=c.currentTarget,c=c.listener,d!==i&&a.isPropagationStopped())break e;NP(a,c,l),i=d}}}if(Wb)throw e=mS,Wb=!1,mS=null,e}function ds(e,t){var r=t[NS];r===void 0&&(r=t[NS]=new Set);var s=e+"__bubble";r.has(s)||(oF(t,e,2,!1),r.add(s))}function $N(e,t,r){var s=0;t&&(s|=4),oF(r,e,s,t)}var py="_reactListening"+Math.random().toString(36).slice(2);function Rx(e){if(!e[py]){e[py]=!0,m$.forEach(function(r){r!=="selectionchange"&&(pne.has(r)||$N(r,!1,e),$N(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[py]||(t[py]=!0,$N("selectionchange",!1,t))}}function oF(e,t,r,s){switch(q$(t)){case 1:var a=Are;break;case 4:a=Tre;break;default:a=y6}r=a.bind(null,t,r,e),a=void 0,!fS||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),s?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function FN(e,t,r,s,a){var i=s;if(!(t&1)&&!(t&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var c=s.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(o===4)for(o=s.return;o!==null;){var d=o.tag;if((d===3||d===4)&&(d=o.stateNode.containerInfo,d===a||d.nodeType===8&&d.parentNode===a))return;o=o.return}for(;c!==null;){if(o=Eh(c),o===null)return;if(d=o.tag,d===5||d===6){s=i=o;continue e}c=c.parentNode}}s=s.return}T$(function(){var l=i,u=p6(r),h=[];e:{var f=aF.get(e);if(f!==void 0){var m=w6,p=e;switch(e){case"keypress":if(_b(r)===0)break e;case"keydown":case"keyup":m=Wre;break;case"focusin":p="focus",m=RN;break;case"focusout":p="blur",m=RN;break;case"beforeblur":case"afterblur":m=RN;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=hP;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Rre;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Kre;break;case tF:case rF:case nF:m=Dre;break;case sF:m=Yre;break;case"scroll":m=Pre;break;case"wheel":m=Qre;break;case"copy":case"cut":case"paste":m=Bre;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=mP}var g=(t&4)!==0,v=!g&&e==="scroll",x=g?f!==null?f+"Capture":null:f;g=[];for(var y=l,b;y!==null;){b=y;var j=b.stateNode;if(b.tag===5&&j!==null&&(b=j,x!==null&&(j=Ex(y,x),j!=null&&g.push(Mx(y,j,b)))),v)break;y=y.return}0<g.length&&(f=new m(f,p,null,r,u),h.push({event:f,listeners:g}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",f&&r!==uS&&(p=r.relatedTarget||r.fromElement)&&(Eh(p)||p[id]))break e;if((m||f)&&(f=u.window===u?u:(f=u.ownerDocument)?f.defaultView||f.parentWindow:window,m?(p=r.relatedTarget||r.toElement,m=l,p=p?Eh(p):null,p!==null&&(v=Ef(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(m=null,p=l),m!==p)){if(g=hP,j="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=mP,j="onPointerLeave",x="onPointerEnter",y="pointer"),v=m==null?f:bm(m),b=p==null?f:bm(p),f=new g(j,y+"leave",m,r,u),f.target=v,f.relatedTarget=b,j=null,Eh(u)===l&&(g=new g(x,y+"enter",p,r,u),g.target=b,g.relatedTarget=v,j=g),v=j,m&&p)t:{for(g=m,x=p,y=0,b=g;b;b=Vf(b))y++;for(b=0,j=x;j;j=Vf(j))b++;for(;0<y-b;)g=Vf(g),y--;for(;0<b-y;)x=Vf(x),b--;for(;y--;){if(g===x||x!==null&&g===x.alternate)break t;g=Vf(g),x=Vf(x)}g=null}else g=null;m!==null&&SP(h,f,m,g,!1),p!==null&&v!==null&&SP(h,v,p,g,!0)}}e:{if(f=l?bm(l):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var T=ane;else if(xP(f))if(Y$)T=cne;else{T=one;var O=ine}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(T=lne);if(T&&(T=T(e,l))){X$(h,T,r,u);break e}O&&O(e,f,l),e==="focusout"&&(O=f._wrapperState)&&O.controlled&&f.type==="number"&&iS(f,"number",f.value)}switch(O=l?bm(l):window,e){case"focusin":(xP(O)||O.contentEditable==="true")&&(vm=O,vS=l,nx=null);break;case"focusout":nx=vS=vm=null;break;case"mousedown":yS=!0;break;case"contextmenu":case"mouseup":case"dragend":yS=!1,_P(h,r,u);break;case"selectionchange":if(hne)break;case"keydown":case"keyup":_P(h,r,u)}var R;if(j6)e:{switch(e){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else xm?G$(e,r)&&(D="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(D="onCompositionStart");D&&(H$&&r.locale!=="ko"&&(xm||D!=="onCompositionStart"?D==="onCompositionEnd"&&xm&&(R=W$()):(nu=u,b6="value"in nu?nu.value:nu.textContent,xm=!0)),O=Yb(l,D),0<O.length&&(D=new fP(D,e,null,r,u),h.push({event:D,listeners:O}),R?D.data=R:(R=K$(r),R!==null&&(D.data=R)))),(R=ene?tne(e,r):rne(e,r))&&(l=Yb(l,"onBeforeInput"),0<l.length&&(u=new fP("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:l}),u.data=R))}iF(h,t)})}function Mx(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Yb(e,t){for(var r=t+"Capture",s=[];e!==null;){var a=e,i=a.stateNode;a.tag===5&&i!==null&&(a=i,i=Ex(e,r),i!=null&&s.unshift(Mx(e,i,a)),i=Ex(e,t),i!=null&&s.push(Mx(e,i,a))),e=e.return}return s}function Vf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function SP(e,t,r,s,a){for(var i=t._reactName,o=[];r!==null&&r!==s;){var c=r,d=c.alternate,l=c.stateNode;if(d!==null&&d===s)break;c.tag===5&&l!==null&&(c=l,a?(d=Ex(r,i),d!=null&&o.unshift(Mx(r,d,c))):a||(d=Ex(r,i),d!=null&&o.push(Mx(r,d,c)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var gne=/\r\n?/g,xne=/\u0000|\uFFFD/g;function CP(e){return(typeof e=="string"?e:""+e).replace(gne,`
`).replace(xne,"")}function gy(e,t,r){if(t=CP(t),CP(e)!==t&&r)throw Error(Bt(425))}function Zb(){}var bS=null,wS=null;function _S(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var jS=typeof setTimeout=="function"?setTimeout:void 0,vne=typeof clearTimeout=="function"?clearTimeout:void 0,EP=typeof Promise=="function"?Promise:void 0,yne=typeof queueMicrotask=="function"?queueMicrotask:typeof EP<"u"?function(e){return EP.resolve(null).then(e).catch(bne)}:jS;function bne(e){setTimeout(function(){throw e})}function zN(e,t){var r=t,s=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(s===0){e.removeChild(a),Tx(t);return}s--}else r!=="$"&&r!=="$?"&&r!=="$!"||s++;r=a}while(r);Tx(t)}function gu(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function kP(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var fg=Math.random().toString(36).slice(2),Ql="__reactFiber$"+fg,Ix="__reactProps$"+fg,id="__reactContainer$"+fg,NS="__reactEvents$"+fg,wne="__reactListeners$"+fg,_ne="__reactHandles$"+fg;function Eh(e){var t=e[Ql];if(t)return t;for(var r=e.parentNode;r;){if(t=r[id]||r[Ql]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=kP(e);e!==null;){if(r=e[Ql])return r;e=kP(e)}return t}e=r,r=e.parentNode}return null}function c1(e){return e=e[Ql]||e[id],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function bm(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Bt(33))}function d_(e){return e[Ix]||null}var SS=[],wm=-1;function Bu(e){return{current:e}}function ms(e){0>wm||(e.current=SS[wm],SS[wm]=null,wm--)}function ss(e,t){wm++,SS[wm]=e.current,e.current=t}var Cu={},ui=Bu(Cu),Gi=Bu(!1),Qh=Cu;function hp(e,t){var r=e.type.contextTypes;if(!r)return Cu;var s=e.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===t)return s.__reactInternalMemoizedMaskedChildContext;var a={},i;for(i in r)a[i]=t[i];return s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ki(e){return e=e.childContextTypes,e!=null}function Qb(){ms(Gi),ms(ui)}function AP(e,t,r){if(ui.current!==Cu)throw Error(Bt(168));ss(ui,t),ss(Gi,r)}function lF(e,t,r){var s=e.stateNode;if(t=t.childContextTypes,typeof s.getChildContext!="function")return r;s=s.getChildContext();for(var a in s)if(!(a in t))throw Error(Bt(108,ire(e)||"Unknown",a));return Rs({},r,s)}function Jb(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cu,Qh=ui.current,ss(ui,e),ss(Gi,Gi.current),!0}function TP(e,t,r){var s=e.stateNode;if(!s)throw Error(Bt(169));r?(e=lF(e,t,Qh),s.__reactInternalMemoizedMergedChildContext=e,ms(Gi),ms(ui),ss(ui,e)):ms(Gi),ss(Gi,r)}var Gc=null,u_=!1,UN=!1;function cF(e){Gc===null?Gc=[e]:Gc.push(e)}function jne(e){u_=!0,cF(e)}function $u(){if(!UN&&Gc!==null){UN=!0;var e=0,t=$n;try{var r=Gc;for($n=1;e<r.length;e++){var s=r[e];do s=s(!0);while(s!==null)}Gc=null,u_=!1}catch(a){throw Gc!==null&&(Gc=Gc.slice(e+1)),M$(g6,$u),a}finally{$n=t,UN=!1}}return null}var _m=[],jm=0,ew=null,tw=0,Bo=[],$o=0,Jh=null,Xc=1,Yc="";function gh(e,t){_m[jm++]=tw,_m[jm++]=ew,ew=e,tw=t}function dF(e,t,r){Bo[$o++]=Xc,Bo[$o++]=Yc,Bo[$o++]=Jh,Jh=e;var s=Xc;e=Yc;var a=32-Sl(s)-1;s&=~(1<<a),r+=1;var i=32-Sl(t)+a;if(30<i){var o=a-a%5;i=(s&(1<<o)-1).toString(32),s>>=o,a-=o,Xc=1<<32-Sl(t)+a|r<<a|s,Yc=i+e}else Xc=1<<i|r<<a|s,Yc=e}function S6(e){e.return!==null&&(gh(e,1),dF(e,1,0))}function C6(e){for(;e===ew;)ew=_m[--jm],_m[jm]=null,tw=_m[--jm],_m[jm]=null;for(;e===Jh;)Jh=Bo[--$o],Bo[$o]=null,Yc=Bo[--$o],Bo[$o]=null,Xc=Bo[--$o],Bo[$o]=null}var vo=null,xo=null,ys=!1,jl=null;function uF(e,t){var r=zo(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function PP(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,vo=e,xo=gu(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,vo=e,xo=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Jh!==null?{id:Xc,overflow:Yc}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=zo(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,vo=e,xo=null,!0):!1;default:return!1}}function CS(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ES(e){if(ys){var t=xo;if(t){var r=t;if(!PP(e,t)){if(CS(e))throw Error(Bt(418));t=gu(r.nextSibling);var s=vo;t&&PP(e,t)?uF(s,r):(e.flags=e.flags&-4097|2,ys=!1,vo=e)}}else{if(CS(e))throw Error(Bt(418));e.flags=e.flags&-4097|2,ys=!1,vo=e}}}function OP(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;vo=e}function xy(e){if(e!==vo)return!1;if(!ys)return OP(e),ys=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!_S(e.type,e.memoizedProps)),t&&(t=xo)){if(CS(e))throw hF(),Error(Bt(418));for(;t;)uF(e,t),t=gu(t.nextSibling)}if(OP(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Bt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){xo=gu(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}xo=null}}else xo=vo?gu(e.stateNode.nextSibling):null;return!0}function hF(){for(var e=xo;e;)e=gu(e.nextSibling)}function fp(){xo=vo=null,ys=!1}function E6(e){jl===null?jl=[e]:jl.push(e)}var Nne=bd.ReactCurrentBatchConfig;function u0(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Bt(309));var s=r.stateNode}if(!s)throw Error(Bt(147,e));var a=s,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var c=a.refs;o===null?delete c[i]:c[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Bt(284));if(!r._owner)throw Error(Bt(290,e))}return e}function vy(e,t){throw e=Object.prototype.toString.call(t),Error(Bt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function RP(e){var t=e._init;return t(e._payload)}function fF(e){function t(x,y){if(e){var b=x.deletions;b===null?(x.deletions=[y],x.flags|=16):b.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function s(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function a(x,y){return x=bu(x,y),x.index=0,x.sibling=null,x}function i(x,y,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<y?(x.flags|=2,y):b):(x.flags|=2,y)):(x.flags|=1048576,y)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function c(x,y,b,j){return y===null||y.tag!==6?(y=XN(b,x.mode,j),y.return=x,y):(y=a(y,b),y.return=x,y)}function d(x,y,b,j){var T=b.type;return T===gm?u(x,y,b.props.children,j,b.key):y!==null&&(y.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Vd&&RP(T)===y.type)?(j=a(y,b.props),j.ref=u0(x,y,b),j.return=x,j):(j=Ab(b.type,b.key,b.props,null,x.mode,j),j.ref=u0(x,y,b),j.return=x,j)}function l(x,y,b,j){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=YN(b,x.mode,j),y.return=x,y):(y=a(y,b.children||[]),y.return=x,y)}function u(x,y,b,j,T){return y===null||y.tag!==7?(y=Wh(b,x.mode,j,T),y.return=x,y):(y=a(y,b),y.return=x,y)}function h(x,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=XN(""+y,x.mode,b),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case oy:return b=Ab(y.type,y.key,y.props,null,x.mode,b),b.ref=u0(x,null,y),b.return=x,b;case pm:return y=YN(y,x.mode,b),y.return=x,y;case Vd:var j=y._init;return h(x,j(y._payload),b)}if(z0(y)||i0(y))return y=Wh(y,x.mode,b,null),y.return=x,y;vy(x,y)}return null}function f(x,y,b,j){var T=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return T!==null?null:c(x,y,""+b,j);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case oy:return b.key===T?d(x,y,b,j):null;case pm:return b.key===T?l(x,y,b,j):null;case Vd:return T=b._init,f(x,y,T(b._payload),j)}if(z0(b)||i0(b))return T!==null?null:u(x,y,b,j,null);vy(x,b)}return null}function m(x,y,b,j,T){if(typeof j=="string"&&j!==""||typeof j=="number")return x=x.get(b)||null,c(y,x,""+j,T);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case oy:return x=x.get(j.key===null?b:j.key)||null,d(y,x,j,T);case pm:return x=x.get(j.key===null?b:j.key)||null,l(y,x,j,T);case Vd:var O=j._init;return m(x,y,b,O(j._payload),T)}if(z0(j)||i0(j))return x=x.get(b)||null,u(y,x,j,T,null);vy(y,j)}return null}function p(x,y,b,j){for(var T=null,O=null,R=y,D=y=0,L=null;R!==null&&D<b.length;D++){R.index>D?(L=R,R=null):L=R.sibling;var q=f(x,R,b[D],j);if(q===null){R===null&&(R=L);break}e&&R&&q.alternate===null&&t(x,R),y=i(q,y,D),O===null?T=q:O.sibling=q,O=q,R=L}if(D===b.length)return r(x,R),ys&&gh(x,D),T;if(R===null){for(;D<b.length;D++)R=h(x,b[D],j),R!==null&&(y=i(R,y,D),O===null?T=R:O.sibling=R,O=R);return ys&&gh(x,D),T}for(R=s(x,R);D<b.length;D++)L=m(R,x,D,b[D],j),L!==null&&(e&&L.alternate!==null&&R.delete(L.key===null?D:L.key),y=i(L,y,D),O===null?T=L:O.sibling=L,O=L);return e&&R.forEach(function(X){return t(x,X)}),ys&&gh(x,D),T}function g(x,y,b,j){var T=i0(b);if(typeof T!="function")throw Error(Bt(150));if(b=T.call(b),b==null)throw Error(Bt(151));for(var O=T=null,R=y,D=y=0,L=null,q=b.next();R!==null&&!q.done;D++,q=b.next()){R.index>D?(L=R,R=null):L=R.sibling;var X=f(x,R,q.value,j);if(X===null){R===null&&(R=L);break}e&&R&&X.alternate===null&&t(x,R),y=i(X,y,D),O===null?T=X:O.sibling=X,O=X,R=L}if(q.done)return r(x,R),ys&&gh(x,D),T;if(R===null){for(;!q.done;D++,q=b.next())q=h(x,q.value,j),q!==null&&(y=i(q,y,D),O===null?T=q:O.sibling=q,O=q);return ys&&gh(x,D),T}for(R=s(x,R);!q.done;D++,q=b.next())q=m(R,x,D,q.value,j),q!==null&&(e&&q.alternate!==null&&R.delete(q.key===null?D:q.key),y=i(q,y,D),O===null?T=q:O.sibling=q,O=q);return e&&R.forEach(function(H){return t(x,H)}),ys&&gh(x,D),T}function v(x,y,b,j){if(typeof b=="object"&&b!==null&&b.type===gm&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case oy:e:{for(var T=b.key,O=y;O!==null;){if(O.key===T){if(T=b.type,T===gm){if(O.tag===7){r(x,O.sibling),y=a(O,b.props.children),y.return=x,x=y;break e}}else if(O.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Vd&&RP(T)===O.type){r(x,O.sibling),y=a(O,b.props),y.ref=u0(x,O,b),y.return=x,x=y;break e}r(x,O);break}else t(x,O);O=O.sibling}b.type===gm?(y=Wh(b.props.children,x.mode,j,b.key),y.return=x,x=y):(j=Ab(b.type,b.key,b.props,null,x.mode,j),j.ref=u0(x,y,b),j.return=x,x=j)}return o(x);case pm:e:{for(O=b.key;y!==null;){if(y.key===O)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(x,y.sibling),y=a(y,b.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=YN(b,x.mode,j),y.return=x,x=y}return o(x);case Vd:return O=b._init,v(x,y,O(b._payload),j)}if(z0(b))return p(x,y,b,j);if(i0(b))return g(x,y,b,j);vy(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(x,y.sibling),y=a(y,b),y.return=x,x=y):(r(x,y),y=XN(b,x.mode,j),y.return=x,x=y),o(x)):r(x,y)}return v}var mp=fF(!0),mF=fF(!1),rw=Bu(null),nw=null,Nm=null,k6=null;function A6(){k6=Nm=nw=null}function T6(e){var t=rw.current;ms(rw),e._currentValue=t}function kS(e,t,r){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===r)break;e=e.return}}function Vm(e,t){nw=e,k6=Nm=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ui=!0),e.firstContext=null)}function Ko(e){var t=e._currentValue;if(k6!==e)if(e={context:e,memoizedValue:t,next:null},Nm===null){if(nw===null)throw Error(Bt(308));Nm=e,nw.dependencies={lanes:0,firstContext:e}}else Nm=Nm.next=e;return t}var kh=null;function P6(e){kh===null?kh=[e]:kh.push(e)}function pF(e,t,r,s){var a=t.interleaved;return a===null?(r.next=r,P6(t)):(r.next=a.next,a.next=r),t.interleaved=r,od(e,s)}function od(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var qd=!1;function O6(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gF(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ed(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function xu(e,t,r){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,Sn&2){var a=s.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),s.pending=t,od(e,r)}return a=s.interleaved,a===null?(t.next=t,P6(s)):(t.next=a.next,a.next=t),s.interleaved=t,od(e,r)}function jb(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,x6(e,r)}}function MP(e,t){var r=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,r===s)){var a=null,i=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};i===null?a=i=o:i=i.next=o,r=r.next}while(r!==null);i===null?a=i=t:i=i.next=t}else a=i=t;r={baseState:s.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:s.shared,effects:s.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function sw(e,t,r,s){var a=e.updateQueue;qd=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var d=c,l=d.next;d.next=null,o===null?i=l:o.next=l,o=d;var u=e.alternate;u!==null&&(u=u.updateQueue,c=u.lastBaseUpdate,c!==o&&(c===null?u.firstBaseUpdate=l:c.next=l,u.lastBaseUpdate=d))}if(i!==null){var h=a.baseState;o=0,u=l=d=null,c=i;do{var f=c.lane,m=c.eventTime;if((s&f)===f){u!==null&&(u=u.next={eventTime:m,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var p=e,g=c;switch(f=t,m=r,g.tag){case 1:if(p=g.payload,typeof p=="function"){h=p.call(m,h,f);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,f=typeof p=="function"?p.call(m,h,f):p,f==null)break e;h=Rs({},h,f);break e;case 2:qd=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,f=a.effects,f===null?a.effects=[c]:f.push(c))}else m={eventTime:m,lane:f,tag:c.tag,payload:c.payload,callback:c.callback,next:null},u===null?(l=u=m,d=h):u=u.next=m,o|=f;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;f=c,c=f.next,f.next=null,a.lastBaseUpdate=f,a.shared.pending=null}}while(!0);if(u===null&&(d=h),a.baseState=d,a.firstBaseUpdate=l,a.lastBaseUpdate=u,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else i===null&&(a.shared.lanes=0);tf|=o,e.lanes=o,e.memoizedState=h}}function IP(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var s=e[t],a=s.callback;if(a!==null){if(s.callback=null,s=r,typeof a!="function")throw Error(Bt(191,a));a.call(s)}}}var d1={},cc=Bu(d1),Dx=Bu(d1),Lx=Bu(d1);function Ah(e){if(e===d1)throw Error(Bt(174));return e}function R6(e,t){switch(ss(Lx,t),ss(Dx,e),ss(cc,d1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:lS(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=lS(t,e)}ms(cc),ss(cc,t)}function pp(){ms(cc),ms(Dx),ms(Lx)}function xF(e){Ah(Lx.current);var t=Ah(cc.current),r=lS(t,e.type);t!==r&&(ss(Dx,e),ss(cc,r))}function M6(e){Dx.current===e&&(ms(cc),ms(Dx))}var Es=Bu(0);function aw(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var VN=[];function I6(){for(var e=0;e<VN.length;e++)VN[e]._workInProgressVersionPrimary=null;VN.length=0}var Nb=bd.ReactCurrentDispatcher,qN=bd.ReactCurrentBatchConfig,ef=0,Os=null,da=null,ka=null,iw=!1,sx=!1,Bx=0,Sne=0;function ti(){throw Error(Bt(321))}function D6(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Tl(e[r],t[r]))return!1;return!0}function L6(e,t,r,s,a,i){if(ef=i,Os=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Nb.current=e===null||e.memoizedState===null?Ane:Tne,e=r(s,a),sx){i=0;do{if(sx=!1,Bx=0,25<=i)throw Error(Bt(301));i+=1,ka=da=null,t.updateQueue=null,Nb.current=Pne,e=r(s,a)}while(sx)}if(Nb.current=ow,t=da!==null&&da.next!==null,ef=0,ka=da=Os=null,iw=!1,t)throw Error(Bt(300));return e}function B6(){var e=Bx!==0;return Bx=0,e}function Kl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ka===null?Os.memoizedState=ka=e:ka=ka.next=e,ka}function Xo(){if(da===null){var e=Os.alternate;e=e!==null?e.memoizedState:null}else e=da.next;var t=ka===null?Os.memoizedState:ka.next;if(t!==null)ka=t,da=e;else{if(e===null)throw Error(Bt(310));da=e,e={memoizedState:da.memoizedState,baseState:da.baseState,baseQueue:da.baseQueue,queue:da.queue,next:null},ka===null?Os.memoizedState=ka=e:ka=ka.next=e}return ka}function $x(e,t){return typeof t=="function"?t(e):t}function WN(e){var t=Xo(),r=t.queue;if(r===null)throw Error(Bt(311));r.lastRenderedReducer=e;var s=da,a=s.baseQueue,i=r.pending;if(i!==null){if(a!==null){var o=a.next;a.next=i.next,i.next=o}s.baseQueue=a=i,r.pending=null}if(a!==null){i=a.next,s=s.baseState;var c=o=null,d=null,l=i;do{var u=l.lane;if((ef&u)===u)d!==null&&(d=d.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),s=l.hasEagerState?l.eagerState:e(s,l.action);else{var h={lane:u,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};d===null?(c=d=h,o=s):d=d.next=h,Os.lanes|=u,tf|=u}l=l.next}while(l!==null&&l!==i);d===null?o=s:d.next=c,Tl(s,t.memoizedState)||(Ui=!0),t.memoizedState=s,t.baseState=o,t.baseQueue=d,r.lastRenderedState=s}if(e=r.interleaved,e!==null){a=e;do i=a.lane,Os.lanes|=i,tf|=i,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function HN(e){var t=Xo(),r=t.queue;if(r===null)throw Error(Bt(311));r.lastRenderedReducer=e;var s=r.dispatch,a=r.pending,i=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do i=e(i,o.action),o=o.next;while(o!==a);Tl(i,t.memoizedState)||(Ui=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),r.lastRenderedState=i}return[i,s]}function vF(){}function yF(e,t){var r=Os,s=Xo(),a=t(),i=!Tl(s.memoizedState,a);if(i&&(s.memoizedState=a,Ui=!0),s=s.queue,$6(_F.bind(null,r,s,e),[e]),s.getSnapshot!==t||i||ka!==null&&ka.memoizedState.tag&1){if(r.flags|=2048,Fx(9,wF.bind(null,r,s,a,t),void 0,null),Ra===null)throw Error(Bt(349));ef&30||bF(r,t,a)}return a}function bF(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Os.updateQueue,t===null?(t={lastEffect:null,stores:null},Os.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function wF(e,t,r,s){t.value=r,t.getSnapshot=s,jF(t)&&NF(e)}function _F(e,t,r){return r(function(){jF(t)&&NF(e)})}function jF(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Tl(e,r)}catch{return!0}}function NF(e){var t=od(e,1);t!==null&&Cl(t,e,1,-1)}function DP(e){var t=Kl();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$x,lastRenderedState:e},t.queue=e,e=e.dispatch=kne.bind(null,Os,e),[t.memoizedState,e]}function Fx(e,t,r,s){return e={tag:e,create:t,destroy:r,deps:s,next:null},t=Os.updateQueue,t===null?(t={lastEffect:null,stores:null},Os.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(s=r.next,r.next=e,e.next=s,t.lastEffect=e)),e}function SF(){return Xo().memoizedState}function Sb(e,t,r,s){var a=Kl();Os.flags|=e,a.memoizedState=Fx(1|t,r,void 0,s===void 0?null:s)}function h_(e,t,r,s){var a=Xo();s=s===void 0?null:s;var i=void 0;if(da!==null){var o=da.memoizedState;if(i=o.destroy,s!==null&&D6(s,o.deps)){a.memoizedState=Fx(t,r,i,s);return}}Os.flags|=e,a.memoizedState=Fx(1|t,r,i,s)}function LP(e,t){return Sb(8390656,8,e,t)}function $6(e,t){return h_(2048,8,e,t)}function CF(e,t){return h_(4,2,e,t)}function EF(e,t){return h_(4,4,e,t)}function kF(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function AF(e,t,r){return r=r!=null?r.concat([e]):null,h_(4,4,kF.bind(null,t,e),r)}function F6(){}function TF(e,t){var r=Xo();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&D6(t,s[1])?s[0]:(r.memoizedState=[e,t],e)}function PF(e,t){var r=Xo();t=t===void 0?null:t;var s=r.memoizedState;return s!==null&&t!==null&&D6(t,s[1])?s[0]:(e=e(),r.memoizedState=[e,t],e)}function OF(e,t,r){return ef&21?(Tl(r,t)||(r=L$(),Os.lanes|=r,tf|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ui=!0),e.memoizedState=r)}function Cne(e,t){var r=$n;$n=r!==0&&4>r?r:4,e(!0);var s=qN.transition;qN.transition={};try{e(!1),t()}finally{$n=r,qN.transition=s}}function RF(){return Xo().memoizedState}function Ene(e,t,r){var s=yu(e);if(r={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null},MF(e))IF(t,r);else if(r=pF(e,t,r,s),r!==null){var a=Ci();Cl(r,e,s,a),DF(r,t,s)}}function kne(e,t,r){var s=yu(e),a={lane:s,action:r,hasEagerState:!1,eagerState:null,next:null};if(MF(e))IF(t,a);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,c=i(o,r);if(a.hasEagerState=!0,a.eagerState=c,Tl(c,o)){var d=t.interleaved;d===null?(a.next=a,P6(t)):(a.next=d.next,d.next=a),t.interleaved=a;return}}catch{}finally{}r=pF(e,t,a,s),r!==null&&(a=Ci(),Cl(r,e,s,a),DF(r,t,s))}}function MF(e){var t=e.alternate;return e===Os||t!==null&&t===Os}function IF(e,t){sx=iw=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function DF(e,t,r){if(r&4194240){var s=t.lanes;s&=e.pendingLanes,r|=s,t.lanes=r,x6(e,r)}}var ow={readContext:Ko,useCallback:ti,useContext:ti,useEffect:ti,useImperativeHandle:ti,useInsertionEffect:ti,useLayoutEffect:ti,useMemo:ti,useReducer:ti,useRef:ti,useState:ti,useDebugValue:ti,useDeferredValue:ti,useTransition:ti,useMutableSource:ti,useSyncExternalStore:ti,useId:ti,unstable_isNewReconciler:!1},Ane={readContext:Ko,useCallback:function(e,t){return Kl().memoizedState=[e,t===void 0?null:t],e},useContext:Ko,useEffect:LP,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Sb(4194308,4,kF.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Sb(4194308,4,e,t)},useInsertionEffect:function(e,t){return Sb(4,2,e,t)},useMemo:function(e,t){var r=Kl();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var s=Kl();return t=r!==void 0?r(t):t,s.memoizedState=s.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},s.queue=e,e=e.dispatch=Ene.bind(null,Os,e),[s.memoizedState,e]},useRef:function(e){var t=Kl();return e={current:e},t.memoizedState=e},useState:DP,useDebugValue:F6,useDeferredValue:function(e){return Kl().memoizedState=e},useTransition:function(){var e=DP(!1),t=e[0];return e=Cne.bind(null,e[1]),Kl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var s=Os,a=Kl();if(ys){if(r===void 0)throw Error(Bt(407));r=r()}else{if(r=t(),Ra===null)throw Error(Bt(349));ef&30||bF(s,t,r)}a.memoizedState=r;var i={value:r,getSnapshot:t};return a.queue=i,LP(_F.bind(null,s,i,e),[e]),s.flags|=2048,Fx(9,wF.bind(null,s,i,r,t),void 0,null),r},useId:function(){var e=Kl(),t=Ra.identifierPrefix;if(ys){var r=Yc,s=Xc;r=(s&~(1<<32-Sl(s)-1)).toString(32)+r,t=":"+t+"R"+r,r=Bx++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Sne++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Tne={readContext:Ko,useCallback:TF,useContext:Ko,useEffect:$6,useImperativeHandle:AF,useInsertionEffect:CF,useLayoutEffect:EF,useMemo:PF,useReducer:WN,useRef:SF,useState:function(){return WN($x)},useDebugValue:F6,useDeferredValue:function(e){var t=Xo();return OF(t,da.memoizedState,e)},useTransition:function(){var e=WN($x)[0],t=Xo().memoizedState;return[e,t]},useMutableSource:vF,useSyncExternalStore:yF,useId:RF,unstable_isNewReconciler:!1},Pne={readContext:Ko,useCallback:TF,useContext:Ko,useEffect:$6,useImperativeHandle:AF,useInsertionEffect:CF,useLayoutEffect:EF,useMemo:PF,useReducer:HN,useRef:SF,useState:function(){return HN($x)},useDebugValue:F6,useDeferredValue:function(e){var t=Xo();return da===null?t.memoizedState=e:OF(t,da.memoizedState,e)},useTransition:function(){var e=HN($x)[0],t=Xo().memoizedState;return[e,t]},useMutableSource:vF,useSyncExternalStore:yF,useId:RF,unstable_isNewReconciler:!1};function pl(e,t){if(e&&e.defaultProps){t=Rs({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function AS(e,t,r,s){t=e.memoizedState,r=r(s,t),r=r==null?t:Rs({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var f_={isMounted:function(e){return(e=e._reactInternals)?Ef(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var s=Ci(),a=yu(e),i=ed(s,a);i.payload=t,r!=null&&(i.callback=r),t=xu(e,i,a),t!==null&&(Cl(t,e,a,s),jb(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var s=Ci(),a=yu(e),i=ed(s,a);i.tag=1,i.payload=t,r!=null&&(i.callback=r),t=xu(e,i,a),t!==null&&(Cl(t,e,a,s),jb(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ci(),s=yu(e),a=ed(r,s);a.tag=2,t!=null&&(a.callback=t),t=xu(e,a,s),t!==null&&(Cl(t,e,s,r),jb(t,e,s))}};function BP(e,t,r,s,a,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,i,o):t.prototype&&t.prototype.isPureReactComponent?!Ox(r,s)||!Ox(a,i):!0}function LF(e,t,r){var s=!1,a=Cu,i=t.contextType;return typeof i=="object"&&i!==null?i=Ko(i):(a=Ki(t)?Qh:ui.current,s=t.contextTypes,i=(s=s!=null)?hp(e,a):Cu),t=new t(r,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=f_,e.stateNode=t,t._reactInternals=e,s&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function $P(e,t,r,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,s),t.state!==e&&f_.enqueueReplaceState(t,t.state,null)}function TS(e,t,r,s){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},O6(e);var i=t.contextType;typeof i=="object"&&i!==null?a.context=Ko(i):(i=Ki(t)?Qh:ui.current,a.context=hp(e,i)),a.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(AS(e,t,i,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&f_.enqueueReplaceState(a,a.state,null),sw(e,r,a,s),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function gp(e,t){try{var r="",s=t;do r+=are(s),s=s.return;while(s);var a=r}catch(i){a=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:a,digest:null}}function GN(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function PS(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var One=typeof WeakMap=="function"?WeakMap:Map;function BF(e,t,r){r=ed(-1,r),r.tag=3,r.payload={element:null};var s=t.value;return r.callback=function(){cw||(cw=!0,zS=s),PS(e,t)},r}function $F(e,t,r){r=ed(-1,r),r.tag=3;var s=e.type.getDerivedStateFromError;if(typeof s=="function"){var a=t.value;r.payload=function(){return s(a)},r.callback=function(){PS(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(r.callback=function(){PS(e,t),typeof s!="function"&&(vu===null?vu=new Set([this]):vu.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function FP(e,t,r){var s=e.pingCache;if(s===null){s=e.pingCache=new One;var a=new Set;s.set(t,a)}else a=s.get(t),a===void 0&&(a=new Set,s.set(t,a));a.has(r)||(a.add(r),e=Hne.bind(null,e,t,r),t.then(e,e))}function zP(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function UP(e,t,r,s,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ed(-1,1),t.tag=2,xu(r,t,1))),r.lanes|=1),e)}var Rne=bd.ReactCurrentOwner,Ui=!1;function xi(e,t,r,s){t.child=e===null?mF(t,null,r,s):mp(t,e.child,r,s)}function VP(e,t,r,s,a){r=r.render;var i=t.ref;return Vm(t,a),s=L6(e,t,r,s,i,a),r=B6(),e!==null&&!Ui?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ld(e,t,a)):(ys&&r&&S6(t),t.flags|=1,xi(e,t,s,a),t.child)}function qP(e,t,r,s,a){if(e===null){var i=r.type;return typeof i=="function"&&!K6(i)&&i.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=i,FF(e,t,i,s,a)):(e=Ab(r.type,null,s,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&a)){var o=i.memoizedProps;if(r=r.compare,r=r!==null?r:Ox,r(o,s)&&e.ref===t.ref)return ld(e,t,a)}return t.flags|=1,e=bu(i,s),e.ref=t.ref,e.return=t,t.child=e}function FF(e,t,r,s,a){if(e!==null){var i=e.memoizedProps;if(Ox(i,s)&&e.ref===t.ref)if(Ui=!1,t.pendingProps=s=i,(e.lanes&a)!==0)e.flags&131072&&(Ui=!0);else return t.lanes=e.lanes,ld(e,t,a)}return OS(e,t,r,s,a)}function zF(e,t,r){var s=t.pendingProps,a=s.children,i=e!==null?e.memoizedState:null;if(s.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ss(Cm,oo),oo|=r;else{if(!(r&1073741824))return e=i!==null?i.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ss(Cm,oo),oo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:r,ss(Cm,oo),oo|=s}else i!==null?(s=i.baseLanes|r,t.memoizedState=null):s=r,ss(Cm,oo),oo|=s;return xi(e,t,a,r),t.child}function UF(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function OS(e,t,r,s,a){var i=Ki(r)?Qh:ui.current;return i=hp(t,i),Vm(t,a),r=L6(e,t,r,s,i,a),s=B6(),e!==null&&!Ui?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,ld(e,t,a)):(ys&&s&&S6(t),t.flags|=1,xi(e,t,r,a),t.child)}function WP(e,t,r,s,a){if(Ki(r)){var i=!0;Jb(t)}else i=!1;if(Vm(t,a),t.stateNode===null)Cb(e,t),LF(t,r,s),TS(t,r,s,a),s=!0;else if(e===null){var o=t.stateNode,c=t.memoizedProps;o.props=c;var d=o.context,l=r.contextType;typeof l=="object"&&l!==null?l=Ko(l):(l=Ki(r)?Qh:ui.current,l=hp(t,l));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==s||d!==l)&&$P(t,o,s,l),qd=!1;var f=t.memoizedState;o.state=f,sw(t,s,o,a),d=t.memoizedState,c!==s||f!==d||Gi.current||qd?(typeof u=="function"&&(AS(t,r,u,s),d=t.memoizedState),(c=qd||BP(t,r,c,s,f,d,l))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=d),o.props=s,o.state=d,o.context=l,s=c):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{o=t.stateNode,gF(e,t),c=t.memoizedProps,l=t.type===t.elementType?c:pl(t.type,c),o.props=l,h=t.pendingProps,f=o.context,d=r.contextType,typeof d=="object"&&d!==null?d=Ko(d):(d=Ki(r)?Qh:ui.current,d=hp(t,d));var m=r.getDerivedStateFromProps;(u=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(c!==h||f!==d)&&$P(t,o,s,d),qd=!1,f=t.memoizedState,o.state=f,sw(t,s,o,a);var p=t.memoizedState;c!==h||f!==p||Gi.current||qd?(typeof m=="function"&&(AS(t,r,m,s),p=t.memoizedState),(l=qd||BP(t,r,l,s,f,p,d)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,p,d),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,p,d)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=p),o.props=s,o.state=p,o.context=d,s=l):(typeof o.componentDidUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),s=!1)}return RS(e,t,r,s,i,a)}function RS(e,t,r,s,a,i){UF(e,t);var o=(t.flags&128)!==0;if(!s&&!o)return a&&TP(t,r,!1),ld(e,t,i);s=t.stateNode,Rne.current=t;var c=o&&typeof r.getDerivedStateFromError!="function"?null:s.render();return t.flags|=1,e!==null&&o?(t.child=mp(t,e.child,null,i),t.child=mp(t,null,c,i)):xi(e,t,c,i),t.memoizedState=s.state,a&&TP(t,r,!0),t.child}function VF(e){var t=e.stateNode;t.pendingContext?AP(e,t.pendingContext,t.pendingContext!==t.context):t.context&&AP(e,t.context,!1),R6(e,t.containerInfo)}function HP(e,t,r,s,a){return fp(),E6(a),t.flags|=256,xi(e,t,r,s),t.child}var MS={dehydrated:null,treeContext:null,retryLane:0};function IS(e){return{baseLanes:e,cachePool:null,transitions:null}}function qF(e,t,r){var s=t.pendingProps,a=Es.current,i=!1,o=(t.flags&128)!==0,c;if((c=o)||(c=e!==null&&e.memoizedState===null?!1:(a&2)!==0),c?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),ss(Es,a&1),e===null)return ES(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=s.children,e=s.fallback,i?(s=t.mode,i=t.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=g_(o,s,0,null),e=Wh(e,s,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=IS(r),t.memoizedState=MS,e):z6(t,o));if(a=e.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return Mne(e,t,o,s,c,a,r);if(i){i=s.fallback,o=t.mode,a=e.child,c=a.sibling;var d={mode:"hidden",children:s.children};return!(o&1)&&t.child!==a?(s=t.child,s.childLanes=0,s.pendingProps=d,t.deletions=null):(s=bu(a,d),s.subtreeFlags=a.subtreeFlags&14680064),c!==null?i=bu(c,i):(i=Wh(i,o,r,null),i.flags|=2),i.return=t,s.return=t,s.sibling=i,t.child=s,s=i,i=t.child,o=e.child.memoizedState,o=o===null?IS(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=MS,s}return i=e.child,e=i.sibling,s=bu(i,{mode:"visible",children:s.children}),!(t.mode&1)&&(s.lanes=r),s.return=t,s.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=s,t.memoizedState=null,s}function z6(e,t){return t=g_({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function yy(e,t,r,s){return s!==null&&E6(s),mp(t,e.child,null,r),e=z6(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Mne(e,t,r,s,a,i,o){if(r)return t.flags&256?(t.flags&=-257,s=GN(Error(Bt(422))),yy(e,t,o,s)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=s.fallback,a=t.mode,s=g_({mode:"visible",children:s.children},a,0,null),i=Wh(i,a,o,null),i.flags|=2,s.return=t,i.return=t,s.sibling=i,t.child=s,t.mode&1&&mp(t,e.child,null,o),t.child.memoizedState=IS(o),t.memoizedState=MS,i);if(!(t.mode&1))return yy(e,t,o,null);if(a.data==="$!"){if(s=a.nextSibling&&a.nextSibling.dataset,s)var c=s.dgst;return s=c,i=Error(Bt(419)),s=GN(i,s,void 0),yy(e,t,o,s)}if(c=(o&e.childLanes)!==0,Ui||c){if(s=Ra,s!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(s.suspendedLanes|o)?0:a,a!==0&&a!==i.retryLane&&(i.retryLane=a,od(e,a),Cl(s,e,a,-1))}return G6(),s=GN(Error(Bt(421))),yy(e,t,o,s)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=Gne.bind(null,e),a._reactRetry=t,null):(e=i.treeContext,xo=gu(a.nextSibling),vo=t,ys=!0,jl=null,e!==null&&(Bo[$o++]=Xc,Bo[$o++]=Yc,Bo[$o++]=Jh,Xc=e.id,Yc=e.overflow,Jh=t),t=z6(t,s.children),t.flags|=4096,t)}function GP(e,t,r){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),kS(e.return,t,r)}function KN(e,t,r,s,a){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:r,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=r,i.tailMode=a)}function WF(e,t,r){var s=t.pendingProps,a=s.revealOrder,i=s.tail;if(xi(e,t,s.children,r),s=Es.current,s&2)s=s&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&GP(e,r,t);else if(e.tag===19)GP(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}if(ss(Es,s),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&aw(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),KN(t,!1,a,r,i);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&aw(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}KN(t,!0,r,null,i);break;case"together":KN(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Cb(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ld(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),tf|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Bt(153));if(t.child!==null){for(e=t.child,r=bu(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=bu(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Ine(e,t,r){switch(t.tag){case 3:VF(t),fp();break;case 5:xF(t);break;case 1:Ki(t.type)&&Jb(t);break;case 4:R6(t,t.stateNode.containerInfo);break;case 10:var s=t.type._context,a=t.memoizedProps.value;ss(rw,s._currentValue),s._currentValue=a;break;case 13:if(s=t.memoizedState,s!==null)return s.dehydrated!==null?(ss(Es,Es.current&1),t.flags|=128,null):r&t.child.childLanes?qF(e,t,r):(ss(Es,Es.current&1),e=ld(e,t,r),e!==null?e.sibling:null);ss(Es,Es.current&1);break;case 19:if(s=(r&t.childLanes)!==0,e.flags&128){if(s)return WF(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ss(Es,Es.current),s)break;return null;case 22:case 23:return t.lanes=0,zF(e,t,r)}return ld(e,t,r)}var HF,DS,GF,KF;HF=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};DS=function(){};GF=function(e,t,r,s){var a=e.memoizedProps;if(a!==s){e=t.stateNode,Ah(cc.current);var i=null;switch(r){case"input":a=sS(e,a),s=sS(e,s),i=[];break;case"select":a=Rs({},a,{value:void 0}),s=Rs({},s,{value:void 0}),i=[];break;case"textarea":a=oS(e,a),s=oS(e,s),i=[];break;default:typeof a.onClick!="function"&&typeof s.onClick=="function"&&(e.onclick=Zb)}cS(r,s);var o;r=null;for(l in a)if(!s.hasOwnProperty(l)&&a.hasOwnProperty(l)&&a[l]!=null)if(l==="style"){var c=a[l];for(o in c)c.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Sx.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in s){var d=s[l];if(c=a!=null?a[l]:void 0,s.hasOwnProperty(l)&&d!==c&&(d!=null||c!=null))if(l==="style")if(c){for(o in c)!c.hasOwnProperty(o)||d&&d.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in d)d.hasOwnProperty(o)&&c[o]!==d[o]&&(r||(r={}),r[o]=d[o])}else r||(i||(i=[]),i.push(l,r)),r=d;else l==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,c=c?c.__html:void 0,d!=null&&c!==d&&(i=i||[]).push(l,d)):l==="children"?typeof d!="string"&&typeof d!="number"||(i=i||[]).push(l,""+d):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(Sx.hasOwnProperty(l)?(d!=null&&l==="onScroll"&&ds("scroll",e),i||c===d||(i=[])):(i=i||[]).push(l,d))}r&&(i=i||[]).push("style",r);var l=i;(t.updateQueue=l)&&(t.flags|=4)}};KF=function(e,t,r,s){r!==s&&(t.flags|=4)};function h0(e,t){if(!ys)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var s=null;r!==null;)r.alternate!==null&&(s=r),r=r.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function ri(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,s=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,s|=a.subtreeFlags&14680064,s|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,s|=a.subtreeFlags,s|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=s,e.childLanes=r,t}function Dne(e,t,r){var s=t.pendingProps;switch(C6(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ri(t),null;case 1:return Ki(t.type)&&Qb(),ri(t),null;case 3:return s=t.stateNode,pp(),ms(Gi),ms(ui),I6(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(e===null||e.child===null)&&(xy(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,jl!==null&&(qS(jl),jl=null))),DS(e,t),ri(t),null;case 5:M6(t);var a=Ah(Lx.current);if(r=t.type,e!==null&&t.stateNode!=null)GF(e,t,r,s,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!s){if(t.stateNode===null)throw Error(Bt(166));return ri(t),null}if(e=Ah(cc.current),xy(t)){s=t.stateNode,r=t.type;var i=t.memoizedProps;switch(s[Ql]=t,s[Ix]=i,e=(t.mode&1)!==0,r){case"dialog":ds("cancel",s),ds("close",s);break;case"iframe":case"object":case"embed":ds("load",s);break;case"video":case"audio":for(a=0;a<V0.length;a++)ds(V0[a],s);break;case"source":ds("error",s);break;case"img":case"image":case"link":ds("error",s),ds("load",s);break;case"details":ds("toggle",s);break;case"input":rP(s,i),ds("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},ds("invalid",s);break;case"textarea":sP(s,i),ds("invalid",s)}cS(r,i),a=null;for(var o in i)if(i.hasOwnProperty(o)){var c=i[o];o==="children"?typeof c=="string"?s.textContent!==c&&(i.suppressHydrationWarning!==!0&&gy(s.textContent,c,e),a=["children",c]):typeof c=="number"&&s.textContent!==""+c&&(i.suppressHydrationWarning!==!0&&gy(s.textContent,c,e),a=["children",""+c]):Sx.hasOwnProperty(o)&&c!=null&&o==="onScroll"&&ds("scroll",s)}switch(r){case"input":ly(s),nP(s,i,!0);break;case"textarea":ly(s),aP(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=Zb)}s=a,t.updateQueue=s,s!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=_$(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof s.is=="string"?e=o.createElement(r,{is:s.is}):(e=o.createElement(r),r==="select"&&(o=e,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):e=o.createElementNS(e,r),e[Ql]=t,e[Ix]=s,HF(e,t,!1,!1),t.stateNode=e;e:{switch(o=dS(r,s),r){case"dialog":ds("cancel",e),ds("close",e),a=s;break;case"iframe":case"object":case"embed":ds("load",e),a=s;break;case"video":case"audio":for(a=0;a<V0.length;a++)ds(V0[a],e);a=s;break;case"source":ds("error",e),a=s;break;case"img":case"image":case"link":ds("error",e),ds("load",e),a=s;break;case"details":ds("toggle",e),a=s;break;case"input":rP(e,s),a=sS(e,s),ds("invalid",e);break;case"option":a=s;break;case"select":e._wrapperState={wasMultiple:!!s.multiple},a=Rs({},s,{value:void 0}),ds("invalid",e);break;case"textarea":sP(e,s),a=oS(e,s),ds("invalid",e);break;default:a=s}cS(r,a),c=a;for(i in c)if(c.hasOwnProperty(i)){var d=c[i];i==="style"?S$(e,d):i==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&j$(e,d)):i==="children"?typeof d=="string"?(r!=="textarea"||d!=="")&&Cx(e,d):typeof d=="number"&&Cx(e,""+d):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Sx.hasOwnProperty(i)?d!=null&&i==="onScroll"&&ds("scroll",e):d!=null&&u6(e,i,d,o))}switch(r){case"input":ly(e),nP(e,s,!1);break;case"textarea":ly(e),aP(e);break;case"option":s.value!=null&&e.setAttribute("value",""+Su(s.value));break;case"select":e.multiple=!!s.multiple,i=s.value,i!=null?$m(e,!!s.multiple,i,!1):s.defaultValue!=null&&$m(e,!!s.multiple,s.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Zb)}switch(r){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ri(t),null;case 6:if(e&&t.stateNode!=null)KF(e,t,e.memoizedProps,s);else{if(typeof s!="string"&&t.stateNode===null)throw Error(Bt(166));if(r=Ah(Lx.current),Ah(cc.current),xy(t)){if(s=t.stateNode,r=t.memoizedProps,s[Ql]=t,(i=s.nodeValue!==r)&&(e=vo,e!==null))switch(e.tag){case 3:gy(s.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&gy(s.nodeValue,r,(e.mode&1)!==0)}i&&(t.flags|=4)}else s=(r.nodeType===9?r:r.ownerDocument).createTextNode(s),s[Ql]=t,t.stateNode=s}return ri(t),null;case 13:if(ms(Es),s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ys&&xo!==null&&t.mode&1&&!(t.flags&128))hF(),fp(),t.flags|=98560,i=!1;else if(i=xy(t),s!==null&&s.dehydrated!==null){if(e===null){if(!i)throw Error(Bt(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Bt(317));i[Ql]=t}else fp(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ri(t),i=!1}else jl!==null&&(qS(jl),jl=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(s=s!==null,s!==(e!==null&&e.memoizedState!==null)&&s&&(t.child.flags|=8192,t.mode&1&&(e===null||Es.current&1?ha===0&&(ha=3):G6())),t.updateQueue!==null&&(t.flags|=4),ri(t),null);case 4:return pp(),DS(e,t),e===null&&Rx(t.stateNode.containerInfo),ri(t),null;case 10:return T6(t.type._context),ri(t),null;case 17:return Ki(t.type)&&Qb(),ri(t),null;case 19:if(ms(Es),i=t.memoizedState,i===null)return ri(t),null;if(s=(t.flags&128)!==0,o=i.rendering,o===null)if(s)h0(i,!1);else{if(ha!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=aw(e),o!==null){for(t.flags|=128,h0(i,!1),s=o.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),t.subtreeFlags=0,s=r,r=t.child;r!==null;)i=r,e=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ss(Es,Es.current&1|2),t.child}e=e.sibling}i.tail!==null&&qs()>xp&&(t.flags|=128,s=!0,h0(i,!1),t.lanes=4194304)}else{if(!s)if(e=aw(o),e!==null){if(t.flags|=128,s=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),h0(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ys)return ri(t),null}else 2*qs()-i.renderingStartTime>xp&&r!==1073741824&&(t.flags|=128,s=!0,h0(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(r=i.last,r!==null?r.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=qs(),t.sibling=null,r=Es.current,ss(Es,s?r&1|2:r&1),t):(ri(t),null);case 22:case 23:return H6(),s=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==s&&(t.flags|=8192),s&&t.mode&1?oo&1073741824&&(ri(t),t.subtreeFlags&6&&(t.flags|=8192)):ri(t),null;case 24:return null;case 25:return null}throw Error(Bt(156,t.tag))}function Lne(e,t){switch(C6(t),t.tag){case 1:return Ki(t.type)&&Qb(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pp(),ms(Gi),ms(ui),I6(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return M6(t),null;case 13:if(ms(Es),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Bt(340));fp()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ms(Es),null;case 4:return pp(),null;case 10:return T6(t.type._context),null;case 22:case 23:return H6(),null;case 24:return null;default:return null}}var by=!1,ii=!1,Bne=typeof WeakSet=="function"?WeakSet:Set,cr=null;function Sm(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(s){Fs(e,t,s)}else r.current=null}function LS(e,t,r){try{r()}catch(s){Fs(e,t,s)}}var KP=!1;function $ne(e,t){if(bS=Kb,e=J$(),N6(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var s=r.getSelection&&r.getSelection();if(s&&s.rangeCount!==0){r=s.anchorNode;var a=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{r.nodeType,i.nodeType}catch{r=null;break e}var o=0,c=-1,d=-1,l=0,u=0,h=e,f=null;t:for(;;){for(var m;h!==r||a!==0&&h.nodeType!==3||(c=o+a),h!==i||s!==0&&h.nodeType!==3||(d=o+s),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===e)break t;if(f===r&&++l===a&&(c=o),f===i&&++u===s&&(d=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}r=c===-1||d===-1?null:{start:c,end:d}}else r=null}r=r||{start:0,end:0}}else r=null;for(wS={focusedElem:e,selectionRange:r},Kb=!1,cr=t;cr!==null;)if(t=cr,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,cr=e;else for(;cr!==null;){t=cr;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,v=p.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:pl(t.type,g),v);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Bt(163))}}catch(j){Fs(t,t.return,j)}if(e=t.sibling,e!==null){e.return=t.return,cr=e;break}cr=t.return}return p=KP,KP=!1,p}function ax(e,t,r){var s=t.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var a=s=s.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,i!==void 0&&LS(t,r,i)}a=a.next}while(a!==s)}}function m_(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var s=r.create;r.destroy=s()}r=r.next}while(r!==t)}}function BS(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function XF(e){var t=e.alternate;t!==null&&(e.alternate=null,XF(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ql],delete t[Ix],delete t[NS],delete t[wne],delete t[_ne])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function YF(e){return e.tag===5||e.tag===3||e.tag===4}function XP(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||YF(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $S(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Zb));else if(s!==4&&(e=e.child,e!==null))for($S(e,t,r),e=e.sibling;e!==null;)$S(e,t,r),e=e.sibling}function FS(e,t,r){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(s!==4&&(e=e.child,e!==null))for(FS(e,t,r),e=e.sibling;e!==null;)FS(e,t,r),e=e.sibling}var Wa=null,bl=!1;function Md(e,t,r){for(r=r.child;r!==null;)ZF(e,t,r),r=r.sibling}function ZF(e,t,r){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(i_,r)}catch{}switch(r.tag){case 5:ii||Sm(r,t);case 6:var s=Wa,a=bl;Wa=null,Md(e,t,r),Wa=s,bl=a,Wa!==null&&(bl?(e=Wa,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Wa.removeChild(r.stateNode));break;case 18:Wa!==null&&(bl?(e=Wa,r=r.stateNode,e.nodeType===8?zN(e.parentNode,r):e.nodeType===1&&zN(e,r),Tx(e)):zN(Wa,r.stateNode));break;case 4:s=Wa,a=bl,Wa=r.stateNode.containerInfo,bl=!0,Md(e,t,r),Wa=s,bl=a;break;case 0:case 11:case 14:case 15:if(!ii&&(s=r.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){a=s=s.next;do{var i=a,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&LS(r,t,o),a=a.next}while(a!==s)}Md(e,t,r);break;case 1:if(!ii&&(Sm(r,t),s=r.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=r.memoizedProps,s.state=r.memoizedState,s.componentWillUnmount()}catch(c){Fs(r,t,c)}Md(e,t,r);break;case 21:Md(e,t,r);break;case 22:r.mode&1?(ii=(s=ii)||r.memoizedState!==null,Md(e,t,r),ii=s):Md(e,t,r);break;default:Md(e,t,r)}}function YP(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Bne),t.forEach(function(s){var a=Kne.bind(null,e,s);r.has(s)||(r.add(s),s.then(a,a))})}}function ll(e,t){var r=t.deletions;if(r!==null)for(var s=0;s<r.length;s++){var a=r[s];try{var i=e,o=t,c=o;e:for(;c!==null;){switch(c.tag){case 5:Wa=c.stateNode,bl=!1;break e;case 3:Wa=c.stateNode.containerInfo,bl=!0;break e;case 4:Wa=c.stateNode.containerInfo,bl=!0;break e}c=c.return}if(Wa===null)throw Error(Bt(160));ZF(i,o,a),Wa=null,bl=!1;var d=a.alternate;d!==null&&(d.return=null),a.return=null}catch(l){Fs(a,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)QF(t,e),t=t.sibling}function QF(e,t){var r=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ll(t,e),Hl(e),s&4){try{ax(3,e,e.return),m_(3,e)}catch(g){Fs(e,e.return,g)}try{ax(5,e,e.return)}catch(g){Fs(e,e.return,g)}}break;case 1:ll(t,e),Hl(e),s&512&&r!==null&&Sm(r,r.return);break;case 5:if(ll(t,e),Hl(e),s&512&&r!==null&&Sm(r,r.return),e.flags&32){var a=e.stateNode;try{Cx(a,"")}catch(g){Fs(e,e.return,g)}}if(s&4&&(a=e.stateNode,a!=null)){var i=e.memoizedProps,o=r!==null?r.memoizedProps:i,c=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{c==="input"&&i.type==="radio"&&i.name!=null&&b$(a,i),dS(c,o);var l=dS(c,i);for(o=0;o<d.length;o+=2){var u=d[o],h=d[o+1];u==="style"?S$(a,h):u==="dangerouslySetInnerHTML"?j$(a,h):u==="children"?Cx(a,h):u6(a,u,h,l)}switch(c){case"input":aS(a,i);break;case"textarea":w$(a,i);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?$m(a,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?$m(a,!!i.multiple,i.defaultValue,!0):$m(a,!!i.multiple,i.multiple?[]:"",!1))}a[Ix]=i}catch(g){Fs(e,e.return,g)}}break;case 6:if(ll(t,e),Hl(e),s&4){if(e.stateNode===null)throw Error(Bt(162));a=e.stateNode,i=e.memoizedProps;try{a.nodeValue=i}catch(g){Fs(e,e.return,g)}}break;case 3:if(ll(t,e),Hl(e),s&4&&r!==null&&r.memoizedState.isDehydrated)try{Tx(t.containerInfo)}catch(g){Fs(e,e.return,g)}break;case 4:ll(t,e),Hl(e);break;case 13:ll(t,e),Hl(e),a=e.child,a.flags&8192&&(i=a.memoizedState!==null,a.stateNode.isHidden=i,!i||a.alternate!==null&&a.alternate.memoizedState!==null||(q6=qs())),s&4&&YP(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(ii=(l=ii)||u,ll(t,e),ii=l):ll(t,e),Hl(e),s&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!u&&e.mode&1)for(cr=e,u=e.child;u!==null;){for(h=cr=u;cr!==null;){switch(f=cr,m=f.child,f.tag){case 0:case 11:case 14:case 15:ax(4,f,f.return);break;case 1:Sm(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){s=f,r=f.return;try{t=s,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(g){Fs(s,r,g)}}break;case 5:Sm(f,f.return);break;case 22:if(f.memoizedState!==null){QP(h);continue}}m!==null?(m.return=f,cr=m):QP(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{a=h.stateNode,l?(i=a.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(c=h.stateNode,d=h.memoizedProps.style,o=d!=null&&d.hasOwnProperty("display")?d.display:null,c.style.display=N$("display",o))}catch(g){Fs(e,e.return,g)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(g){Fs(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ll(t,e),Hl(e),s&4&&YP(e);break;case 21:break;default:ll(t,e),Hl(e)}}function Hl(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(YF(r)){var s=r;break e}r=r.return}throw Error(Bt(160))}switch(s.tag){case 5:var a=s.stateNode;s.flags&32&&(Cx(a,""),s.flags&=-33);var i=XP(e);FS(e,i,a);break;case 3:case 4:var o=s.stateNode.containerInfo,c=XP(e);$S(e,c,o);break;default:throw Error(Bt(161))}}catch(d){Fs(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Fne(e,t,r){cr=e,JF(e)}function JF(e,t,r){for(var s=(e.mode&1)!==0;cr!==null;){var a=cr,i=a.child;if(a.tag===22&&s){var o=a.memoizedState!==null||by;if(!o){var c=a.alternate,d=c!==null&&c.memoizedState!==null||ii;c=by;var l=ii;if(by=o,(ii=d)&&!l)for(cr=a;cr!==null;)o=cr,d=o.child,o.tag===22&&o.memoizedState!==null?JP(a):d!==null?(d.return=o,cr=d):JP(a);for(;i!==null;)cr=i,JF(i),i=i.sibling;cr=a,by=c,ii=l}ZP(e)}else a.subtreeFlags&8772&&i!==null?(i.return=a,cr=i):ZP(e)}}function ZP(e){for(;cr!==null;){var t=cr;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:ii||m_(5,t);break;case 1:var s=t.stateNode;if(t.flags&4&&!ii)if(r===null)s.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:pl(t.type,r.memoizedProps);s.componentDidUpdate(a,r.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&IP(t,i,s);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}IP(t,o,r)}break;case 5:var c=t.stateNode;if(r===null&&t.flags&4){r=c;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&r.focus();break;case"img":d.src&&(r.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var u=l.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Tx(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Bt(163))}ii||t.flags&512&&BS(t)}catch(f){Fs(t,t.return,f)}}if(t===e){cr=null;break}if(r=t.sibling,r!==null){r.return=t.return,cr=r;break}cr=t.return}}function QP(e){for(;cr!==null;){var t=cr;if(t===e){cr=null;break}var r=t.sibling;if(r!==null){r.return=t.return,cr=r;break}cr=t.return}}function JP(e){for(;cr!==null;){var t=cr;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{m_(4,t)}catch(d){Fs(t,r,d)}break;case 1:var s=t.stateNode;if(typeof s.componentDidMount=="function"){var a=t.return;try{s.componentDidMount()}catch(d){Fs(t,a,d)}}var i=t.return;try{BS(t)}catch(d){Fs(t,i,d)}break;case 5:var o=t.return;try{BS(t)}catch(d){Fs(t,o,d)}}}catch(d){Fs(t,t.return,d)}if(t===e){cr=null;break}var c=t.sibling;if(c!==null){c.return=t.return,cr=c;break}cr=t.return}}var zne=Math.ceil,lw=bd.ReactCurrentDispatcher,U6=bd.ReactCurrentOwner,qo=bd.ReactCurrentBatchConfig,Sn=0,Ra=null,Qs=null,Xa=0,oo=0,Cm=Bu(0),ha=0,zx=null,tf=0,p_=0,V6=0,ix=null,Bi=null,q6=0,xp=1/0,qc=null,cw=!1,zS=null,vu=null,wy=!1,su=null,dw=0,ox=0,US=null,Eb=-1,kb=0;function Ci(){return Sn&6?qs():Eb!==-1?Eb:Eb=qs()}function yu(e){return e.mode&1?Sn&2&&Xa!==0?Xa&-Xa:Nne.transition!==null?(kb===0&&(kb=L$()),kb):(e=$n,e!==0||(e=window.event,e=e===void 0?16:q$(e.type)),e):1}function Cl(e,t,r,s){if(50<ox)throw ox=0,US=null,Error(Bt(185));o1(e,r,s),(!(Sn&2)||e!==Ra)&&(e===Ra&&(!(Sn&2)&&(p_|=r),ha===4&&Xd(e,Xa)),Xi(e,s),r===1&&Sn===0&&!(t.mode&1)&&(xp=qs()+500,u_&&$u()))}function Xi(e,t){var r=e.callbackNode;Nre(e,t);var s=Gb(e,e===Ra?Xa:0);if(s===0)r!==null&&lP(r),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(r!=null&&lP(r),t===1)e.tag===0?jne(eO.bind(null,e)):cF(eO.bind(null,e)),yne(function(){!(Sn&6)&&$u()}),r=null;else{switch(B$(s)){case 1:r=g6;break;case 4:r=I$;break;case 16:r=Hb;break;case 536870912:r=D$;break;default:r=Hb}r=oz(r,ez.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ez(e,t){if(Eb=-1,kb=0,Sn&6)throw Error(Bt(327));var r=e.callbackNode;if(qm()&&e.callbackNode!==r)return null;var s=Gb(e,e===Ra?Xa:0);if(s===0)return null;if(s&30||s&e.expiredLanes||t)t=uw(e,s);else{t=s;var a=Sn;Sn|=2;var i=rz();(Ra!==e||Xa!==t)&&(qc=null,xp=qs()+500,qh(e,t));do try{qne();break}catch(c){tz(e,c)}while(!0);A6(),lw.current=i,Sn=a,Qs!==null?t=0:(Ra=null,Xa=0,t=ha)}if(t!==0){if(t===2&&(a=pS(e),a!==0&&(s=a,t=VS(e,a))),t===1)throw r=zx,qh(e,0),Xd(e,s),Xi(e,qs()),r;if(t===6)Xd(e,s);else{if(a=e.current.alternate,!(s&30)&&!Une(a)&&(t=uw(e,s),t===2&&(i=pS(e),i!==0&&(s=i,t=VS(e,i))),t===1))throw r=zx,qh(e,0),Xd(e,s),Xi(e,qs()),r;switch(e.finishedWork=a,e.finishedLanes=s,t){case 0:case 1:throw Error(Bt(345));case 2:xh(e,Bi,qc);break;case 3:if(Xd(e,s),(s&130023424)===s&&(t=q6+500-qs(),10<t)){if(Gb(e,0)!==0)break;if(a=e.suspendedLanes,(a&s)!==s){Ci(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=jS(xh.bind(null,e,Bi,qc),t);break}xh(e,Bi,qc);break;case 4:if(Xd(e,s),(s&4194240)===s)break;for(t=e.eventTimes,a=-1;0<s;){var o=31-Sl(s);i=1<<o,o=t[o],o>a&&(a=o),s&=~i}if(s=a,s=qs()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*zne(s/1960))-s,10<s){e.timeoutHandle=jS(xh.bind(null,e,Bi,qc),s);break}xh(e,Bi,qc);break;case 5:xh(e,Bi,qc);break;default:throw Error(Bt(329))}}}return Xi(e,qs()),e.callbackNode===r?ez.bind(null,e):null}function VS(e,t){var r=ix;return e.current.memoizedState.isDehydrated&&(qh(e,t).flags|=256),e=uw(e,t),e!==2&&(t=Bi,Bi=r,t!==null&&qS(t)),e}function qS(e){Bi===null?Bi=e:Bi.push.apply(Bi,e)}function Une(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var s=0;s<r.length;s++){var a=r[s],i=a.getSnapshot;a=a.value;try{if(!Tl(i(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Xd(e,t){for(t&=~V6,t&=~p_,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Sl(t),s=1<<r;e[r]=-1,t&=~s}}function eO(e){if(Sn&6)throw Error(Bt(327));qm();var t=Gb(e,0);if(!(t&1))return Xi(e,qs()),null;var r=uw(e,t);if(e.tag!==0&&r===2){var s=pS(e);s!==0&&(t=s,r=VS(e,s))}if(r===1)throw r=zx,qh(e,0),Xd(e,t),Xi(e,qs()),r;if(r===6)throw Error(Bt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xh(e,Bi,qc),Xi(e,qs()),null}function W6(e,t){var r=Sn;Sn|=1;try{return e(t)}finally{Sn=r,Sn===0&&(xp=qs()+500,u_&&$u())}}function rf(e){su!==null&&su.tag===0&&!(Sn&6)&&qm();var t=Sn;Sn|=1;var r=qo.transition,s=$n;try{if(qo.transition=null,$n=1,e)return e()}finally{$n=s,qo.transition=r,Sn=t,!(Sn&6)&&$u()}}function H6(){oo=Cm.current,ms(Cm)}function qh(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,vne(r)),Qs!==null)for(r=Qs.return;r!==null;){var s=r;switch(C6(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Qb();break;case 3:pp(),ms(Gi),ms(ui),I6();break;case 5:M6(s);break;case 4:pp();break;case 13:ms(Es);break;case 19:ms(Es);break;case 10:T6(s.type._context);break;case 22:case 23:H6()}r=r.return}if(Ra=e,Qs=e=bu(e.current,null),Xa=oo=t,ha=0,zx=null,V6=p_=tf=0,Bi=ix=null,kh!==null){for(t=0;t<kh.length;t++)if(r=kh[t],s=r.interleaved,s!==null){r.interleaved=null;var a=s.next,i=r.pending;if(i!==null){var o=i.next;i.next=a,s.next=o}r.pending=s}kh=null}return e}function tz(e,t){do{var r=Qs;try{if(A6(),Nb.current=ow,iw){for(var s=Os.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}iw=!1}if(ef=0,ka=da=Os=null,sx=!1,Bx=0,U6.current=null,r===null||r.return===null){ha=1,zx=t,Qs=null;break}e:{var i=e,o=r.return,c=r,d=t;if(t=Xa,c.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var l=d,u=c,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var m=zP(o);if(m!==null){m.flags&=-257,UP(m,o,c,i,t),m.mode&1&&FP(i,l,t),t=m,d=l;var p=t.updateQueue;if(p===null){var g=new Set;g.add(d),t.updateQueue=g}else p.add(d);break e}else{if(!(t&1)){FP(i,l,t),G6();break e}d=Error(Bt(426))}}else if(ys&&c.mode&1){var v=zP(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),UP(v,o,c,i,t),E6(gp(d,c));break e}}i=d=gp(d,c),ha!==4&&(ha=2),ix===null?ix=[i]:ix.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=BF(i,d,t);MP(i,x);break e;case 1:c=d;var y=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(vu===null||!vu.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var j=$F(i,c,t);MP(i,j);break e}}i=i.return}while(i!==null)}sz(r)}catch(T){t=T,Qs===r&&r!==null&&(Qs=r=r.return);continue}break}while(!0)}function rz(){var e=lw.current;return lw.current=ow,e===null?ow:e}function G6(){(ha===0||ha===3||ha===2)&&(ha=4),Ra===null||!(tf&268435455)&&!(p_&268435455)||Xd(Ra,Xa)}function uw(e,t){var r=Sn;Sn|=2;var s=rz();(Ra!==e||Xa!==t)&&(qc=null,qh(e,t));do try{Vne();break}catch(a){tz(e,a)}while(!0);if(A6(),Sn=r,lw.current=s,Qs!==null)throw Error(Bt(261));return Ra=null,Xa=0,ha}function Vne(){for(;Qs!==null;)nz(Qs)}function qne(){for(;Qs!==null&&!pre();)nz(Qs)}function nz(e){var t=iz(e.alternate,e,oo);e.memoizedProps=e.pendingProps,t===null?sz(e):Qs=t,U6.current=null}function sz(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Lne(r,t),r!==null){r.flags&=32767,Qs=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ha=6,Qs=null;return}}else if(r=Dne(r,t,oo),r!==null){Qs=r;return}if(t=t.sibling,t!==null){Qs=t;return}Qs=t=e}while(t!==null);ha===0&&(ha=5)}function xh(e,t,r){var s=$n,a=qo.transition;try{qo.transition=null,$n=1,Wne(e,t,r,s)}finally{qo.transition=a,$n=s}return null}function Wne(e,t,r,s){do qm();while(su!==null);if(Sn&6)throw Error(Bt(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Bt(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(Sre(e,i),e===Ra&&(Qs=Ra=null,Xa=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||wy||(wy=!0,oz(Hb,function(){return qm(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=qo.transition,qo.transition=null;var o=$n;$n=1;var c=Sn;Sn|=4,U6.current=null,$ne(e,r),QF(r,e),une(wS),Kb=!!bS,wS=bS=null,e.current=r,Fne(r),gre(),Sn=c,$n=o,qo.transition=i}else e.current=r;if(wy&&(wy=!1,su=e,dw=a),i=e.pendingLanes,i===0&&(vu=null),yre(r.stateNode),Xi(e,qs()),t!==null)for(s=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],s(a.value,{componentStack:a.stack,digest:a.digest});if(cw)throw cw=!1,e=zS,zS=null,e;return dw&1&&e.tag!==0&&qm(),i=e.pendingLanes,i&1?e===US?ox++:(ox=0,US=e):ox=0,$u(),null}function qm(){if(su!==null){var e=B$(dw),t=qo.transition,r=$n;try{if(qo.transition=null,$n=16>e?16:e,su===null)var s=!1;else{if(e=su,su=null,dw=0,Sn&6)throw Error(Bt(331));var a=Sn;for(Sn|=4,cr=e.current;cr!==null;){var i=cr,o=i.child;if(cr.flags&16){var c=i.deletions;if(c!==null){for(var d=0;d<c.length;d++){var l=c[d];for(cr=l;cr!==null;){var u=cr;switch(u.tag){case 0:case 11:case 15:ax(8,u,i)}var h=u.child;if(h!==null)h.return=u,cr=h;else for(;cr!==null;){u=cr;var f=u.sibling,m=u.return;if(XF(u),u===l){cr=null;break}if(f!==null){f.return=m,cr=f;break}cr=m}}}var p=i.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(g!==null)}}cr=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,cr=o;else e:for(;cr!==null;){if(i=cr,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ax(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,cr=x;break e}cr=i.return}}var y=e.current;for(cr=y;cr!==null;){o=cr;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,cr=b;else e:for(o=y;cr!==null;){if(c=cr,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:m_(9,c)}}catch(T){Fs(c,c.return,T)}if(c===o){cr=null;break e}var j=c.sibling;if(j!==null){j.return=c.return,cr=j;break e}cr=c.return}}if(Sn=a,$u(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(i_,e)}catch{}s=!0}return s}finally{$n=r,qo.transition=t}}return!1}function tO(e,t,r){t=gp(r,t),t=BF(e,t,1),e=xu(e,t,1),t=Ci(),e!==null&&(o1(e,1,t),Xi(e,t))}function Fs(e,t,r){if(e.tag===3)tO(e,e,r);else for(;t!==null;){if(t.tag===3){tO(t,e,r);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(vu===null||!vu.has(s))){e=gp(r,e),e=$F(t,e,1),t=xu(t,e,1),e=Ci(),t!==null&&(o1(t,1,e),Xi(t,e));break}}t=t.return}}function Hne(e,t,r){var s=e.pingCache;s!==null&&s.delete(t),t=Ci(),e.pingedLanes|=e.suspendedLanes&r,Ra===e&&(Xa&r)===r&&(ha===4||ha===3&&(Xa&130023424)===Xa&&500>qs()-q6?qh(e,0):V6|=r),Xi(e,t)}function az(e,t){t===0&&(e.mode&1?(t=uy,uy<<=1,!(uy&130023424)&&(uy=4194304)):t=1);var r=Ci();e=od(e,t),e!==null&&(o1(e,t,r),Xi(e,r))}function Gne(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),az(e,r)}function Kne(e,t){var r=0;switch(e.tag){case 13:var s=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:s=e.stateNode;break;default:throw Error(Bt(314))}s!==null&&s.delete(t),az(e,r)}var iz;iz=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Gi.current)Ui=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ui=!1,Ine(e,t,r);Ui=!!(e.flags&131072)}else Ui=!1,ys&&t.flags&1048576&&dF(t,tw,t.index);switch(t.lanes=0,t.tag){case 2:var s=t.type;Cb(e,t),e=t.pendingProps;var a=hp(t,ui.current);Vm(t,r),a=L6(null,t,s,e,a,r);var i=B6();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ki(s)?(i=!0,Jb(t)):i=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,O6(t),a.updater=f_,t.stateNode=a,a._reactInternals=t,TS(t,s,e,r),t=RS(null,t,s,!0,i,r)):(t.tag=0,ys&&i&&S6(t),xi(null,t,a,r),t=t.child),t;case 16:s=t.elementType;e:{switch(Cb(e,t),e=t.pendingProps,a=s._init,s=a(s._payload),t.type=s,a=t.tag=Yne(s),e=pl(s,e),a){case 0:t=OS(null,t,s,e,r);break e;case 1:t=WP(null,t,s,e,r);break e;case 11:t=VP(null,t,s,e,r);break e;case 14:t=qP(null,t,s,pl(s.type,e),r);break e}throw Error(Bt(306,s,""))}return t;case 0:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:pl(s,a),OS(e,t,s,a,r);case 1:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:pl(s,a),WP(e,t,s,a,r);case 3:e:{if(VF(t),e===null)throw Error(Bt(387));s=t.pendingProps,i=t.memoizedState,a=i.element,gF(e,t),sw(t,s,null,r);var o=t.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){a=gp(Error(Bt(423)),t),t=HP(e,t,s,r,a);break e}else if(s!==a){a=gp(Error(Bt(424)),t),t=HP(e,t,s,r,a);break e}else for(xo=gu(t.stateNode.containerInfo.firstChild),vo=t,ys=!0,jl=null,r=mF(t,null,s,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(fp(),s===a){t=ld(e,t,r);break e}xi(e,t,s,r)}t=t.child}return t;case 5:return xF(t),e===null&&ES(t),s=t.type,a=t.pendingProps,i=e!==null?e.memoizedProps:null,o=a.children,_S(s,a)?o=null:i!==null&&_S(s,i)&&(t.flags|=32),UF(e,t),xi(e,t,o,r),t.child;case 6:return e===null&&ES(t),null;case 13:return qF(e,t,r);case 4:return R6(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=mp(t,null,s,r):xi(e,t,s,r),t.child;case 11:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:pl(s,a),VP(e,t,s,a,r);case 7:return xi(e,t,t.pendingProps,r),t.child;case 8:return xi(e,t,t.pendingProps.children,r),t.child;case 12:return xi(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(s=t.type._context,a=t.pendingProps,i=t.memoizedProps,o=a.value,ss(rw,s._currentValue),s._currentValue=o,i!==null)if(Tl(i.value,o)){if(i.children===a.children&&!Gi.current){t=ld(e,t,r);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var c=i.dependencies;if(c!==null){o=i.child;for(var d=c.firstContext;d!==null;){if(d.context===s){if(i.tag===1){d=ed(-1,r&-r),d.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var u=l.pending;u===null?d.next=d:(d.next=u.next,u.next=d),l.pending=d}}i.lanes|=r,d=i.alternate,d!==null&&(d.lanes|=r),kS(i.return,r,t),c.lanes|=r;break}d=d.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Bt(341));o.lanes|=r,c=o.alternate,c!==null&&(c.lanes|=r),kS(o,r,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}xi(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,s=t.pendingProps.children,Vm(t,r),a=Ko(a),s=s(a),t.flags|=1,xi(e,t,s,r),t.child;case 14:return s=t.type,a=pl(s,t.pendingProps),a=pl(s.type,a),qP(e,t,s,a,r);case 15:return FF(e,t,t.type,t.pendingProps,r);case 17:return s=t.type,a=t.pendingProps,a=t.elementType===s?a:pl(s,a),Cb(e,t),t.tag=1,Ki(s)?(e=!0,Jb(t)):e=!1,Vm(t,r),LF(t,s,a),TS(t,s,a,r),RS(null,t,s,!0,e,r);case 19:return WF(e,t,r);case 22:return zF(e,t,r)}throw Error(Bt(156,t.tag))};function oz(e,t){return M$(e,t)}function Xne(e,t,r,s){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zo(e,t,r,s){return new Xne(e,t,r,s)}function K6(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Yne(e){if(typeof e=="function")return K6(e)?1:0;if(e!=null){if(e=e.$$typeof,e===f6)return 11;if(e===m6)return 14}return 2}function bu(e,t){var r=e.alternate;return r===null?(r=zo(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ab(e,t,r,s,a,i){var o=2;if(s=e,typeof e=="function")K6(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case gm:return Wh(r.children,a,i,t);case h6:o=8,a|=8;break;case eS:return e=zo(12,r,t,a|2),e.elementType=eS,e.lanes=i,e;case tS:return e=zo(13,r,t,a),e.elementType=tS,e.lanes=i,e;case rS:return e=zo(19,r,t,a),e.elementType=rS,e.lanes=i,e;case x$:return g_(r,a,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case p$:o=10;break e;case g$:o=9;break e;case f6:o=11;break e;case m6:o=14;break e;case Vd:o=16,s=null;break e}throw Error(Bt(130,e==null?e:typeof e,""))}return t=zo(o,r,t,a),t.elementType=e,t.type=s,t.lanes=i,t}function Wh(e,t,r,s){return e=zo(7,e,s,t),e.lanes=r,e}function g_(e,t,r,s){return e=zo(22,e,s,t),e.elementType=x$,e.lanes=r,e.stateNode={isHidden:!1},e}function XN(e,t,r){return e=zo(6,e,null,t),e.lanes=r,e}function YN(e,t,r){return t=zo(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Zne(e,t,r,s,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=TN(0),this.expirationTimes=TN(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=TN(0),this.identifierPrefix=s,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function X6(e,t,r,s,a,i,o,c,d){return e=new Zne(e,t,r,c,d),t===1?(t=1,i===!0&&(t|=8)):t=0,i=zo(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:s,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},O6(i),e}function Qne(e,t,r){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:pm,key:s==null?null:""+s,children:e,containerInfo:t,implementation:r}}function lz(e){if(!e)return Cu;e=e._reactInternals;e:{if(Ef(e)!==e||e.tag!==1)throw Error(Bt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ki(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Bt(171))}if(e.tag===1){var r=e.type;if(Ki(r))return lF(e,r,t)}return t}function cz(e,t,r,s,a,i,o,c,d){return e=X6(r,s,!0,e,a,i,o,c,d),e.context=lz(null),r=e.current,s=Ci(),a=yu(r),i=ed(s,a),i.callback=t??null,xu(r,i,a),e.current.lanes=a,o1(e,a,s),Xi(e,s),e}function x_(e,t,r,s){var a=t.current,i=Ci(),o=yu(a);return r=lz(r),t.context===null?t.context=r:t.pendingContext=r,t=ed(i,o),t.payload={element:e},s=s===void 0?null:s,s!==null&&(t.callback=s),e=xu(a,t,o),e!==null&&(Cl(e,a,o,i),jb(e,a,o)),o}function hw(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function rO(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Y6(e,t){rO(e,t),(e=e.alternate)&&rO(e,t)}function Jne(){return null}var dz=typeof reportError=="function"?reportError:function(e){console.error(e)};function Z6(e){this._internalRoot=e}v_.prototype.render=Z6.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Bt(409));x_(e,t,null,null)};v_.prototype.unmount=Z6.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;rf(function(){x_(null,e,null,null)}),t[id]=null}};function v_(e){this._internalRoot=e}v_.prototype.unstable_scheduleHydration=function(e){if(e){var t=z$();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Kd.length&&t!==0&&t<Kd[r].priority;r++);Kd.splice(r,0,e),r===0&&V$(e)}};function Q6(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function y_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function nO(){}function ese(e,t,r,s,a){if(a){if(typeof s=="function"){var i=s;s=function(){var l=hw(o);i.call(l)}}var o=cz(t,s,e,0,null,!1,!1,"",nO);return e._reactRootContainer=o,e[id]=o.current,Rx(e.nodeType===8?e.parentNode:e),rf(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof s=="function"){var c=s;s=function(){var l=hw(d);c.call(l)}}var d=X6(e,0,!1,null,null,!1,!1,"",nO);return e._reactRootContainer=d,e[id]=d.current,Rx(e.nodeType===8?e.parentNode:e),rf(function(){x_(t,d,r,s)}),d}function b_(e,t,r,s,a){var i=r._reactRootContainer;if(i){var o=i;if(typeof a=="function"){var c=a;a=function(){var d=hw(o);c.call(d)}}x_(t,o,e,a)}else o=ese(r,t,e,a,s);return hw(o)}$$=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=U0(t.pendingLanes);r!==0&&(x6(t,r|1),Xi(t,qs()),!(Sn&6)&&(xp=qs()+500,$u()))}break;case 13:rf(function(){var s=od(e,1);if(s!==null){var a=Ci();Cl(s,e,1,a)}}),Y6(e,1)}};v6=function(e){if(e.tag===13){var t=od(e,134217728);if(t!==null){var r=Ci();Cl(t,e,134217728,r)}Y6(e,134217728)}};F$=function(e){if(e.tag===13){var t=yu(e),r=od(e,t);if(r!==null){var s=Ci();Cl(r,e,t,s)}Y6(e,t)}};z$=function(){return $n};U$=function(e,t){var r=$n;try{return $n=e,t()}finally{$n=r}};hS=function(e,t,r){switch(t){case"input":if(aS(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var s=r[t];if(s!==e&&s.form===e.form){var a=d_(s);if(!a)throw Error(Bt(90));y$(s),aS(s,a)}}}break;case"textarea":w$(e,r);break;case"select":t=r.value,t!=null&&$m(e,!!r.multiple,t,!1)}};k$=W6;A$=rf;var tse={usingClientEntryPoint:!1,Events:[c1,bm,d_,C$,E$,W6]},f0={findFiberByHostInstance:Eh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rse={bundleType:f0.bundleType,version:f0.version,rendererPackageName:f0.rendererPackageName,rendererConfig:f0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bd.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=O$(e),e===null?null:e.stateNode},findFiberByHostInstance:f0.findFiberByHostInstance||Jne,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var _y=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!_y.isDisabled&&_y.supportsFiber)try{i_=_y.inject(rse),lc=_y}catch{}}Co.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tse;Co.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Q6(t))throw Error(Bt(200));return Qne(e,t,null,r)};Co.createRoot=function(e,t){if(!Q6(e))throw Error(Bt(299));var r=!1,s="",a=dz;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=X6(e,1,!1,null,null,r,!1,s,a),e[id]=t.current,Rx(e.nodeType===8?e.parentNode:e),new Z6(t)};Co.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Bt(188)):(e=Object.keys(e).join(","),Error(Bt(268,e)));return e=O$(t),e=e===null?null:e.stateNode,e};Co.flushSync=function(e){return rf(e)};Co.hydrate=function(e,t,r){if(!y_(t))throw Error(Bt(200));return b_(null,e,t,!0,r)};Co.hydrateRoot=function(e,t,r){if(!Q6(e))throw Error(Bt(405));var s=r!=null&&r.hydratedSources||null,a=!1,i="",o=dz;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(i=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=cz(t,null,e,1,r??null,a,!1,i,o),e[id]=t.current,Rx(e),s)for(e=0;e<s.length;e++)r=s[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new v_(t)};Co.render=function(e,t,r){if(!y_(t))throw Error(Bt(200));return b_(null,e,t,!1,r)};Co.unmountComponentAtNode=function(e){if(!y_(e))throw Error(Bt(40));return e._reactRootContainer?(rf(function(){b_(null,null,e,!1,function(){e._reactRootContainer=null,e[id]=null})}),!0):!1};Co.unstable_batchedUpdates=W6;Co.unstable_renderSubtreeIntoContainer=function(e,t,r,s){if(!y_(r))throw Error(Bt(200));if(e==null||e._reactInternals===void 0)throw Error(Bt(38));return b_(e,t,r,!1,s)};Co.version="18.3.1-next-f1338f8080-20240426";function uz(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(uz)}catch(e){console.error(e)}}uz(),u$.exports=Co;var kf=u$.exports;const hz=On(kf);var fz,sO=kf;fz=sO.createRoot,sO.hydrateRoot;const nse=1,sse=1e6;let ZN=0;function ase(){return ZN=(ZN+1)%Number.MAX_SAFE_INTEGER,ZN.toString()}const QN=new Map,aO=e=>{if(QN.has(e))return;const t=setTimeout(()=>{QN.delete(e),lx({type:"REMOVE_TOAST",toastId:e})},sse);QN.set(e,t)},ise=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,nse)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?aO(r):e.toasts.forEach(s=>{aO(s.id)}),{...e,toasts:e.toasts.map(s=>s.id===r||r===void 0?{...s,open:!1}:s)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},Tb=[];let Pb={toasts:[]};function lx(e){Pb=ise(Pb,e),Tb.forEach(t=>{t(Pb)})}function ose({...e}){const t=ase(),r=a=>lx({type:"UPDATE_TOAST",toast:{...a,id:t}}),s=()=>lx({type:"DISMISS_TOAST",toastId:t});return lx({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||s()}}}),{id:t,dismiss:s,update:r}}function lse(){const[e,t]=P.useState(Pb);return P.useEffect(()=>(Tb.push(t),()=>{const r=Tb.indexOf(t);r>-1&&Tb.splice(r,1)}),[e]),{...e,toast:ose,dismiss:r=>lx({type:"DISMISS_TOAST",toastId:r})}}function kt(e,t,{checkForDefaultPrevented:r=!0}={}){return function(a){if(e==null||e(a),r===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function iO(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function cd(...e){return t=>{let r=!1;const s=e.map(a=>{const i=iO(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<s.length;a++){const i=s[a];typeof i=="function"?i():iO(e[a],null)}}}}function Ir(...e){return P.useCallback(cd(...e),e)}function cse(e,t){const r=P.createContext(t),s=i=>{const{children:o,...c}=i,d=P.useMemo(()=>c,Object.values(c));return n.jsx(r.Provider,{value:d,children:o})};s.displayName=e+"Provider";function a(i){const o=P.useContext(r);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[s,a]}function ta(e,t=[]){let r=[];function s(i,o){const c=P.createContext(o),d=r.length;r=[...r,o];const l=h=>{var x;const{scope:f,children:m,...p}=h,g=((x=f==null?void 0:f[e])==null?void 0:x[d])||c,v=P.useMemo(()=>p,Object.values(p));return n.jsx(g.Provider,{value:v,children:m})};l.displayName=i+"Provider";function u(h,f){var g;const m=((g=f==null?void 0:f[e])==null?void 0:g[d])||c,p=P.useContext(m);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[l,u]}const a=()=>{const i=r.map(o=>P.createContext(o));return function(c){const d=(c==null?void 0:c[e])||i;return P.useMemo(()=>({[`__scope${e}`]:{...c,[e]:d}}),[c,d])}};return a.scopeName=e,[s,dse(a,...t)]}function dse(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const s=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=s.reduce((c,{useScope:d,scopeName:l})=>{const h=d(i)[`__scope${l}`];return{...c,...h}},{});return P.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return r.scopeName=t.scopeName,r}function Eu(e){const t=hse(e),r=P.forwardRef((s,a)=>{const{children:i,...o}=s,c=P.Children.toArray(i),d=c.find(fse);if(d){const l=d.props.children,u=c.map(h=>h===d?P.Children.count(l)>1?P.Children.only(null):P.isValidElement(l)?l.props.children:null:h);return n.jsx(t,{...o,ref:a,children:P.isValidElement(l)?P.cloneElement(l,void 0,u):null})}return n.jsx(t,{...o,ref:a,children:i})});return r.displayName=`${e}.Slot`,r}var use=Eu("Slot");function hse(e){const t=P.forwardRef((r,s)=>{const{children:a,...i}=r;if(P.isValidElement(a)){const o=pse(a),c=mse(i,a.props);return a.type!==P.Fragment&&(c.ref=s?cd(s,o):o),P.cloneElement(a,c)}return P.Children.count(a)>1?P.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var mz=Symbol("radix.slottable");function pz(e){const t=({children:r})=>n.jsx(n.Fragment,{children:r});return t.displayName=`${e}.Slottable`,t.__radixId=mz,t}function fse(e){return P.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===mz}function mse(e,t){const r={...t};for(const s in t){const a=e[s],i=t[s];/^on[A-Z]/.test(s)?a&&i?r[s]=(...c)=>{const d=i(...c);return a(...c),d}:a&&(r[s]=a):s==="style"?r[s]={...a,...i}:s==="className"&&(r[s]=[a,i].filter(Boolean).join(" "))}return{...e,...r}}function pse(e){var s,a;let t=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function w_(e){const t=e+"CollectionProvider",[r,s]=ta(t),[a,i]=r(t,{collectionRef:{current:null},itemMap:new Map}),o=g=>{const{scope:v,children:x}=g,y=we.useRef(null),b=we.useRef(new Map).current;return n.jsx(a,{scope:v,itemMap:b,collectionRef:y,children:x})};o.displayName=t;const c=e+"CollectionSlot",d=Eu(c),l=we.forwardRef((g,v)=>{const{scope:x,children:y}=g,b=i(c,x),j=Ir(v,b.collectionRef);return n.jsx(d,{ref:j,children:y})});l.displayName=c;const u=e+"CollectionItemSlot",h="data-radix-collection-item",f=Eu(u),m=we.forwardRef((g,v)=>{const{scope:x,children:y,...b}=g,j=we.useRef(null),T=Ir(v,j),O=i(u,x);return we.useEffect(()=>(O.itemMap.set(j,{ref:j,...b}),()=>void O.itemMap.delete(j))),n.jsx(f,{[h]:"",ref:T,children:y})});m.displayName=u;function p(g){const v=i(e+"CollectionConsumer",g);return we.useCallback(()=>{const y=v.collectionRef.current;if(!y)return[];const b=Array.from(y.querySelectorAll(`[${h}]`));return Array.from(v.itemMap.values()).sort((O,R)=>b.indexOf(O.ref.current)-b.indexOf(R.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:l,ItemSlot:m},p,s]}var gse=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],er=gse.reduce((e,t)=>{const r=Eu(`Primitive.${t}`),s=P.forwardRef((a,i)=>{const{asChild:o,...c}=a,d=o?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),n.jsx(d,{...c,ref:i})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{});function J6(e,t){e&&kf.flushSync(()=>e.dispatchEvent(t))}function Ws(e){const t=P.useRef(e);return P.useEffect(()=>{t.current=e}),P.useMemo(()=>(...r)=>{var s;return(s=t.current)==null?void 0:s.call(t,...r)},[])}function xse(e,t=globalThis==null?void 0:globalThis.document){const r=Ws(e);P.useEffect(()=>{const s=a=>{a.key==="Escape"&&r(a)};return t.addEventListener("keydown",s,{capture:!0}),()=>t.removeEventListener("keydown",s,{capture:!0})},[r,t])}var vse="DismissableLayer",WS="dismissableLayer.update",yse="dismissableLayer.pointerDownOutside",bse="dismissableLayer.focusOutside",oO,gz=P.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Fu=P.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,onDismiss:c,...d}=e,l=P.useContext(gz),[u,h]=P.useState(null),f=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=P.useState({}),p=Ir(t,R=>h(R)),g=Array.from(l.layers),[v]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),x=g.indexOf(v),y=u?g.indexOf(u):-1,b=l.layersWithOutsidePointerEventsDisabled.size>0,j=y>=x,T=_se(R=>{const D=R.target,L=[...l.branches].some(q=>q.contains(D));!j||L||(a==null||a(R),o==null||o(R),R.defaultPrevented||c==null||c())},f),O=jse(R=>{const D=R.target;[...l.branches].some(q=>q.contains(D))||(i==null||i(R),o==null||o(R),R.defaultPrevented||c==null||c())},f);return xse(R=>{y===l.layers.size-1&&(s==null||s(R),!R.defaultPrevented&&c&&(R.preventDefault(),c()))},f),P.useEffect(()=>{if(u)return r&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(oO=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(u)),l.layers.add(u),lO(),()=>{r&&l.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=oO)}},[u,f,r,l]),P.useEffect(()=>()=>{u&&(l.layers.delete(u),l.layersWithOutsidePointerEventsDisabled.delete(u),lO())},[u,l]),P.useEffect(()=>{const R=()=>m({});return document.addEventListener(WS,R),()=>document.removeEventListener(WS,R)},[]),n.jsx(er.div,{...d,ref:p,style:{pointerEvents:b?j?"auto":"none":void 0,...e.style},onFocusCapture:kt(e.onFocusCapture,O.onFocusCapture),onBlurCapture:kt(e.onBlurCapture,O.onBlurCapture),onPointerDownCapture:kt(e.onPointerDownCapture,T.onPointerDownCapture)})});Fu.displayName=vse;var wse="DismissableLayerBranch",xz=P.forwardRef((e,t)=>{const r=P.useContext(gz),s=P.useRef(null),a=Ir(t,s);return P.useEffect(()=>{const i=s.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),n.jsx(er.div,{...e,ref:a})});xz.displayName=wse;function _se(e,t=globalThis==null?void 0:globalThis.document){const r=Ws(e),s=P.useRef(!1),a=P.useRef(()=>{});return P.useEffect(()=>{const i=c=>{if(c.target&&!s.current){let d=function(){vz(yse,r,l,{discrete:!0})};const l={originalEvent:c};c.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=d,t.addEventListener("click",a.current,{once:!0})):d()}else t.removeEventListener("click",a.current);s.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",a.current)}},[t,r]),{onPointerDownCapture:()=>s.current=!0}}function jse(e,t=globalThis==null?void 0:globalThis.document){const r=Ws(e),s=P.useRef(!1);return P.useEffect(()=>{const a=i=>{i.target&&!s.current&&vz(bse,r,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,r]),{onFocusCapture:()=>s.current=!0,onBlurCapture:()=>s.current=!1}}function lO(){const e=new CustomEvent(WS);document.dispatchEvent(e)}function vz(e,t,r,{discrete:s}){const a=r.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),s?J6(a,i):a.dispatchEvent(i)}var Nse=Fu,Sse=xz,ya=globalThis!=null&&globalThis.document?P.useLayoutEffect:()=>{},Cse="Portal",mg=P.forwardRef((e,t)=>{var c;const{container:r,...s}=e,[a,i]=P.useState(!1);ya(()=>i(!0),[]);const o=r||a&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return o?hz.createPortal(n.jsx(er.div,{...s,ref:t}),o):null});mg.displayName=Cse;function Ese(e,t){return P.useReducer((r,s)=>t[r][s]??r,e)}var Gs=e=>{const{present:t,children:r}=e,s=kse(t),a=typeof r=="function"?r({present:s.isPresent}):P.Children.only(r),i=Ir(s.ref,Ase(a));return typeof r=="function"||s.isPresent?P.cloneElement(a,{ref:i}):null};Gs.displayName="Presence";function kse(e){const[t,r]=P.useState(),s=P.useRef(null),a=P.useRef(e),i=P.useRef("none"),o=e?"mounted":"unmounted",[c,d]=Ese(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return P.useEffect(()=>{const l=jy(s.current);i.current=c==="mounted"?l:"none"},[c]),ya(()=>{const l=s.current,u=a.current;if(u!==e){const f=i.current,m=jy(l);e?d("MOUNT"):m==="none"||(l==null?void 0:l.display)==="none"?d("UNMOUNT"):d(u&&f!==m?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,d]),ya(()=>{if(t){let l;const u=t.ownerDocument.defaultView??window,h=m=>{const g=jy(s.current).includes(m.animationName);if(m.target===t&&g&&(d("ANIMATION_END"),!a.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",l=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},f=m=>{m.target===t&&(i.current=jy(s.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{u.clearTimeout(l),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else d("ANIMATION_END")},[t,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:P.useCallback(l=>{s.current=l?getComputedStyle(l):null,r(l)},[])}}function jy(e){return(e==null?void 0:e.animationName)||"none"}function Ase(e){var s,a;let t=(s=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Tse=l6[" useInsertionEffect ".trim().toString()]||ya;function Yi({prop:e,defaultProp:t,onChange:r=()=>{},caller:s}){const[a,i,o]=Pse({defaultProp:t,onChange:r}),c=e!==void 0,d=c?e:a;{const u=P.useRef(e!==void 0);P.useEffect(()=>{const h=u.current;h!==c&&console.warn(`${s} is changing from ${h?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=c},[c,s])}const l=P.useCallback(u=>{var h;if(c){const f=Ose(u)?u(e):u;f!==e&&((h=o.current)==null||h.call(o,f))}else i(u)},[c,e,i,o]);return[d,l]}function Pse({defaultProp:e,onChange:t}){const[r,s]=P.useState(e),a=P.useRef(r),i=P.useRef(t);return Tse(()=>{i.current=t},[t]),P.useEffect(()=>{var o;a.current!==r&&((o=i.current)==null||o.call(i,r),a.current=r)},[r,a]),[r,s,i]}function Ose(e){return typeof e=="function"}var yz=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Rse="VisuallyHidden",__=P.forwardRef((e,t)=>n.jsx(er.span,{...e,ref:t,style:{...yz,...e.style}}));__.displayName=Rse;var Mse=__,ek="ToastProvider",[tk,Ise,Dse]=w_("Toast"),[bz,net]=ta("Toast",[Dse]),[Lse,j_]=bz(ek),wz=e=>{const{__scopeToast:t,label:r="Notification",duration:s=5e3,swipeDirection:a="right",swipeThreshold:i=50,children:o}=e,[c,d]=P.useState(null),[l,u]=P.useState(0),h=P.useRef(!1),f=P.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${ek}\`. Expected non-empty \`string\`.`),n.jsx(tk.Provider,{scope:t,children:n.jsx(Lse,{scope:t,label:r,duration:s,swipeDirection:a,swipeThreshold:i,toastCount:l,viewport:c,onViewportChange:d,onToastAdd:P.useCallback(()=>u(m=>m+1),[]),onToastRemove:P.useCallback(()=>u(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};wz.displayName=ek;var _z="ToastViewport",Bse=["F8"],HS="toast.viewportPause",GS="toast.viewportResume",jz=P.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:s=Bse,label:a="Notifications ({hotkey})",...i}=e,o=j_(_z,r),c=Ise(r),d=P.useRef(null),l=P.useRef(null),u=P.useRef(null),h=P.useRef(null),f=Ir(t,h,o.onViewportChange),m=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;P.useEffect(()=>{const v=x=>{var b;s.length!==0&&s.every(j=>x[j]||x.code===j)&&((b=h.current)==null||b.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[s]),P.useEffect(()=>{const v=d.current,x=h.current;if(p&&v&&x){const y=()=>{if(!o.isClosePausedRef.current){const O=new CustomEvent(HS);x.dispatchEvent(O),o.isClosePausedRef.current=!0}},b=()=>{if(o.isClosePausedRef.current){const O=new CustomEvent(GS);x.dispatchEvent(O),o.isClosePausedRef.current=!1}},j=O=>{!v.contains(O.relatedTarget)&&b()},T=()=>{v.contains(document.activeElement)||b()};return v.addEventListener("focusin",y),v.addEventListener("focusout",j),v.addEventListener("pointermove",y),v.addEventListener("pointerleave",T),window.addEventListener("blur",y),window.addEventListener("focus",b),()=>{v.removeEventListener("focusin",y),v.removeEventListener("focusout",j),v.removeEventListener("pointermove",y),v.removeEventListener("pointerleave",T),window.removeEventListener("blur",y),window.removeEventListener("focus",b)}}},[p,o.isClosePausedRef]);const g=P.useCallback(({tabbingDirection:v})=>{const y=c().map(b=>{const j=b.ref.current,T=[j,...Zse(j)];return v==="forwards"?T:T.reverse()});return(v==="forwards"?y.reverse():y).flat()},[c]);return P.useEffect(()=>{const v=h.current;if(v){const x=y=>{var T,O,R;const b=y.altKey||y.ctrlKey||y.metaKey;if(y.key==="Tab"&&!b){const D=document.activeElement,L=y.shiftKey;if(y.target===v&&L){(T=l.current)==null||T.focus();return}const H=g({tabbingDirection:L?"backwards":"forwards"}),M=H.findIndex(F=>F===D);JN(H.slice(M+1))?y.preventDefault():L?(O=l.current)==null||O.focus():(R=u.current)==null||R.focus()}};return v.addEventListener("keydown",x),()=>v.removeEventListener("keydown",x)}},[c,g]),n.jsxs(Sse,{ref:d,role:"region","aria-label":a.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&n.jsx(KS,{ref:l,onFocusFromOutsideViewport:()=>{const v=g({tabbingDirection:"forwards"});JN(v)}}),n.jsx(tk.Slot,{scope:r,children:n.jsx(er.ol,{tabIndex:-1,...i,ref:f})}),p&&n.jsx(KS,{ref:u,onFocusFromOutsideViewport:()=>{const v=g({tabbingDirection:"backwards"});JN(v)}})]})});jz.displayName=_z;var Nz="ToastFocusProxy",KS=P.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:s,...a}=e,i=j_(Nz,r);return n.jsx(__,{"aria-hidden":!0,tabIndex:0,...a,ref:t,style:{position:"fixed"},onFocus:o=>{var l;const c=o.relatedTarget;!((l=i.viewport)!=null&&l.contains(c))&&s()}})});KS.displayName=Nz;var u1="Toast",$se="toast.swipeStart",Fse="toast.swipeMove",zse="toast.swipeCancel",Use="toast.swipeEnd",Sz=P.forwardRef((e,t)=>{const{forceMount:r,open:s,defaultOpen:a,onOpenChange:i,...o}=e,[c,d]=Yi({prop:s,defaultProp:a??!0,onChange:i,caller:u1});return n.jsx(Gs,{present:r||c,children:n.jsx(Wse,{open:c,...o,ref:t,onClose:()=>d(!1),onPause:Ws(e.onPause),onResume:Ws(e.onResume),onSwipeStart:kt(e.onSwipeStart,l=>{l.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:kt(e.onSwipeMove,l=>{const{x:u,y:h}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","move"),l.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:kt(e.onSwipeCancel,l=>{l.currentTarget.setAttribute("data-swipe","cancel"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:kt(e.onSwipeEnd,l=>{const{x:u,y:h}=l.detail.delta;l.currentTarget.setAttribute("data-swipe","end"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),l.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),l.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),l.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),d(!1)})})})});Sz.displayName=u1;var[Vse,qse]=bz(u1,{onClose(){}}),Wse=P.forwardRef((e,t)=>{const{__scopeToast:r,type:s="foreground",duration:a,open:i,onClose:o,onEscapeKeyDown:c,onPause:d,onResume:l,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...p}=e,g=j_(u1,r),[v,x]=P.useState(null),y=Ir(t,F=>x(F)),b=P.useRef(null),j=P.useRef(null),T=a||g.duration,O=P.useRef(0),R=P.useRef(T),D=P.useRef(0),{onToastAdd:L,onToastRemove:q}=g,X=Ws(()=>{var S;(v==null?void 0:v.contains(document.activeElement))&&((S=g.viewport)==null||S.focus()),o()}),H=P.useCallback(F=>{!F||F===1/0||(window.clearTimeout(D.current),O.current=new Date().getTime(),D.current=window.setTimeout(X,F))},[X]);P.useEffect(()=>{const F=g.viewport;if(F){const S=()=>{H(R.current),l==null||l()},E=()=>{const N=new Date().getTime()-O.current;R.current=R.current-N,window.clearTimeout(D.current),d==null||d()};return F.addEventListener(HS,E),F.addEventListener(GS,S),()=>{F.removeEventListener(HS,E),F.removeEventListener(GS,S)}}},[g.viewport,T,d,l,H]),P.useEffect(()=>{i&&!g.isClosePausedRef.current&&H(T)},[i,T,g.isClosePausedRef,H]),P.useEffect(()=>(L(),()=>q()),[L,q]);const M=P.useMemo(()=>v?Oz(v):null,[v]);return g.viewport?n.jsxs(n.Fragment,{children:[M&&n.jsx(Hse,{__scopeToast:r,role:"status","aria-live":s==="foreground"?"assertive":"polite","aria-atomic":!0,children:M}),n.jsx(Vse,{scope:r,onClose:X,children:kf.createPortal(n.jsx(tk.ItemSlot,{scope:r,children:n.jsx(Nse,{asChild:!0,onEscapeKeyDown:kt(c,()=>{g.isFocusedToastEscapeKeyDownRef.current||X(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:n.jsx(er.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":g.swipeDirection,...p,ref:y,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:kt(e.onKeyDown,F=>{F.key==="Escape"&&(c==null||c(F.nativeEvent),F.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,X()))}),onPointerDown:kt(e.onPointerDown,F=>{F.button===0&&(b.current={x:F.clientX,y:F.clientY})}),onPointerMove:kt(e.onPointerMove,F=>{if(!b.current)return;const S=F.clientX-b.current.x,E=F.clientY-b.current.y,N=!!j.current,C=["left","right"].includes(g.swipeDirection),k=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,I=C?k(0,S):0,U=C?0:k(0,E),$=F.pointerType==="touch"?10:2,Y={x:I,y:U},Z={originalEvent:F,delta:Y};N?(j.current=Y,Ny(Fse,h,Z,{discrete:!1})):cO(Y,g.swipeDirection,$)?(j.current=Y,Ny($se,u,Z,{discrete:!1}),F.target.setPointerCapture(F.pointerId)):(Math.abs(S)>$||Math.abs(E)>$)&&(b.current=null)}),onPointerUp:kt(e.onPointerUp,F=>{const S=j.current,E=F.target;if(E.hasPointerCapture(F.pointerId)&&E.releasePointerCapture(F.pointerId),j.current=null,b.current=null,S){const N=F.currentTarget,C={originalEvent:F,delta:S};cO(S,g.swipeDirection,g.swipeThreshold)?Ny(Use,m,C,{discrete:!0}):Ny(zse,f,C,{discrete:!0}),N.addEventListener("click",k=>k.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),Hse=e=>{const{__scopeToast:t,children:r,...s}=e,a=j_(u1,t),[i,o]=P.useState(!1),[c,d]=P.useState(!1);return Xse(()=>o(!0)),P.useEffect(()=>{const l=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(l)},[]),c?null:n.jsx(mg,{asChild:!0,children:n.jsx(__,{...s,children:i&&n.jsxs(n.Fragment,{children:[a.label," ",r]})})})},Gse="ToastTitle",Cz=P.forwardRef((e,t)=>{const{__scopeToast:r,...s}=e;return n.jsx(er.div,{...s,ref:t})});Cz.displayName=Gse;var Kse="ToastDescription",Ez=P.forwardRef((e,t)=>{const{__scopeToast:r,...s}=e;return n.jsx(er.div,{...s,ref:t})});Ez.displayName=Kse;var kz="ToastAction",Az=P.forwardRef((e,t)=>{const{altText:r,...s}=e;return r.trim()?n.jsx(Pz,{altText:r,asChild:!0,children:n.jsx(rk,{...s,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${kz}\`. Expected non-empty \`string\`.`),null)});Az.displayName=kz;var Tz="ToastClose",rk=P.forwardRef((e,t)=>{const{__scopeToast:r,...s}=e,a=qse(Tz,r);return n.jsx(Pz,{asChild:!0,children:n.jsx(er.button,{type:"button",...s,ref:t,onClick:kt(e.onClick,a.onClose)})})});rk.displayName=Tz;var Pz=P.forwardRef((e,t)=>{const{__scopeToast:r,altText:s,...a}=e;return n.jsx(er.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":s||void 0,...a,ref:t})});function Oz(e){const t=[];return Array.from(e.childNodes).forEach(s=>{if(s.nodeType===s.TEXT_NODE&&s.textContent&&t.push(s.textContent),Yse(s)){const a=s.ariaHidden||s.hidden||s.style.display==="none",i=s.dataset.radixToastAnnounceExclude==="";if(!a)if(i){const o=s.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...Oz(s))}}),t}function Ny(e,t,r,{discrete:s}){const a=r.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&a.addEventListener(e,t,{once:!0}),s?J6(a,i):a.dispatchEvent(i)}var cO=(e,t,r=0)=>{const s=Math.abs(e.x),a=Math.abs(e.y),i=s>a;return t==="left"||t==="right"?i&&s>r:!i&&a>r};function Xse(e=()=>{}){const t=Ws(e);ya(()=>{let r=0,s=0;return r=window.requestAnimationFrame(()=>s=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(s)}},[t])}function Yse(e){return e.nodeType===e.ELEMENT_NODE}function Zse(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function JN(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var Qse=wz,Rz=jz,Mz=Sz,Iz=Cz,Dz=Ez,Lz=Az,Bz=rk;function $z(e){var t,r,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=$z(e[t]))&&(s&&(s+=" "),s+=r)}else for(r in e)e[r]&&(s&&(s+=" "),s+=r);return s}function Xr(){for(var e,t,r=0,s="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=$z(e))&&(s&&(s+=" "),s+=t);return s}const dO=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,uO=Xr,pg=(e,t)=>r=>{var s;if((t==null?void 0:t.variants)==null)return uO(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:a,defaultVariants:i}=t,o=Object.keys(a).map(l=>{const u=r==null?void 0:r[l],h=i==null?void 0:i[l];if(u===null)return null;const f=dO(u)||dO(h);return a[l][f]}),c=r&&Object.entries(r).reduce((l,u)=>{let[h,f]=u;return f===void 0||(l[h]=f),l},{}),d=t==null||(s=t.compoundVariants)===null||s===void 0?void 0:s.reduce((l,u)=>{let{class:h,className:f,...m}=u;return Object.entries(m).every(p=>{let[g,v]=p;return Array.isArray(v)?v.includes({...i,...c}[g]):{...i,...c}[g]===v})?[...l,h,f]:l},[]);return uO(e,o,d,r==null?void 0:r.class,r==null?void 0:r.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jse=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Fz=(...e)=>e.filter((t,r,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var eae={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tae=P.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:a="",children:i,iconNode:o,...c},d)=>P.createElement("svg",{ref:d,...eae,width:t,height:t,stroke:e,strokeWidth:s?Number(r)*24/Number(t):r,className:Fz("lucide",a),...c},[...o.map(([l,u])=>P.createElement(l,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=(e,t)=>{const r=P.forwardRef(({className:s,...a},i)=>P.createElement(tae,{ref:i,iconNode:t,className:Fz(`lucide-${Jse(e)}`,s),...a}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ux=mt("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rae=mt("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zz=mt("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=mt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ps=mt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uz=mt("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=mt("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nae=mt("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qz=mt("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sae=mt("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wz=mt("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rc=mt("Bike",[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hz=mt("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hO=mt("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aae=mt("Boxes",[["path",{d:"M2.97 12.92A2 2 0 0 0 2 14.63v3.24a2 2 0 0 0 .97 1.71l3 1.8a2 2 0 0 0 2.06 0L12 19v-5.5l-5-3-4.03 2.42Z",key:"lc1i9w"}],["path",{d:"m7 16.5-4.74-2.85",key:"1o9zyk"}],["path",{d:"m7 16.5 5-3",key:"va8pkn"}],["path",{d:"M7 16.5v5.17",key:"jnp8gn"}],["path",{d:"M12 13.5V19l3.97 2.38a2 2 0 0 0 2.06 0l3-1.8a2 2 0 0 0 .97-1.71v-3.24a2 2 0 0 0-.97-1.71L17 10.5l-5 3Z",key:"8zsnat"}],["path",{d:"m17 16.5-5-3",key:"8arw3v"}],["path",{d:"m17 16.5 4.74-2.85",key:"8rfmw"}],["path",{d:"M17 16.5v5.17",key:"k6z78m"}],["path",{d:"M7.97 4.42A2 2 0 0 0 7 6.13v4.37l5 3 5-3V6.13a2 2 0 0 0-.97-1.71l-3-1.8a2 2 0 0 0-2.06 0l-3 1.8Z",key:"1xygjf"}],["path",{d:"M12 8 7.26 5.15",key:"1vbdud"}],["path",{d:"m12 8 4.74-2.85",key:"3rx089"}],["path",{d:"M12 13.5V8",key:"1io7kd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=mt("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fw=mt("Cake",[["path",{d:"M20 21v-8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v8",key:"1w3rig"}],["path",{d:"M4 16s.5-1 2-1 2.5 2 4 2 2.5-2 4-2 2.5 2 4 2 2-1 2-1",key:"n2jgmb"}],["path",{d:"M2 21h20",key:"1nyx9w"}],["path",{d:"M7 8v3",key:"1qtyvj"}],["path",{d:"M12 8v3",key:"hwp4zt"}],["path",{d:"M17 8v3",key:"1i6e5u"}],["path",{d:"M7 4h.01",key:"1bh4kh"}],["path",{d:"M12 4h.01",key:"1ujb9j"}],["path",{d:"M17 4h.01",key:"1upcoc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iae=mt("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=mt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=mt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pl=mt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oae=mt("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xn=mt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=mt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gz=mt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dn=mt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nf=mt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cn=mt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=mt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=mt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=mt("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lae=mt("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cae=mt("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=mt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kz=mt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mw=mt("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=mt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=mt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=mt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=mt("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=mt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Af=mt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dae=mt("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=mt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=mt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=mt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uae=mt("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sf=mt("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const af=mt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=mt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pw=mt("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=mt("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fO=mt("GitCompare",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["path",{d:"M11 18H8a2 2 0 0 1-2-2V9",key:"19pyzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nk=mt("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const El=mt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gw=mt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xz=mt("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sk=mt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hae=mt("Infinity",[["path",{d:"M12 12c-2-2.67-4-4-6-4a4 4 0 1 0 0 8c2 0 4-1.33 6-4Zm0 0c2 2.67 4 4 6 4a4 4 0 0 0 0-8c-2 0-4 1.33-6 4Z",key:"1z0uae"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yz=mt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zz=mt("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ak=mt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fae=mt("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=mt("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qz=mt("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=mt("ListOrdered",[["path",{d:"M10 12h11",key:"6m4ad9"}],["path",{d:"M10 18h11",key:"11hvi2"}],["path",{d:"M10 6h11",key:"c7qv1k"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mae=mt("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=mt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pae=mt("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=mt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ik=mt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ok=mt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=mt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gae=mt("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mO=mt("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jz=mt("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eU=mt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xae=mt("Merge",[["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M12 2v10.3a4 4 0 0 1-1.172 2.872L4 22",key:"1hyw0i"}],["path",{d:"m20 22-5-5",key:"1m27yz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=mt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N_=mt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vp=mt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vae=mt("PackageCheck",[["path",{d:"m16 16 2 2 4-4",key:"gfu2re"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=mt("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lk=mt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yae=mt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=mt("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=mt("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=mt("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=mt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ck=mt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=mt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h1=mt("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=mt("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tU=mt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const en=mt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f1=mt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bae=mt("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const td=mt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=mt("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wae=mt("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=mt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zu=mt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dk=mt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _ae=mt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jae=mt("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nae=mt("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sae=mt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cae=mt("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=mt("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=mt("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uk=mt("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=mt("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eae=mt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rU=mt("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=mt("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kae=mt("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=mt("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=mt("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=mt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aae=mt("ThumbsDown",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tae=mt("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hh=mt("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=mt("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uu=mt("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vu=mt("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=mt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qx=mt("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=mt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mr=mt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=mt("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=mt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pae=mt("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gh=mt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nU=mt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sU=mt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oae=mt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=mt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hk=mt("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=mt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rae=mt("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cx=mt("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=mt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aU=mt("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),fk="-",Mae=e=>{const t=Dae(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:s}=e;return{getClassGroupId:o=>{const c=o.split(fk);return c[0]===""&&c.length!==1&&c.shift(),iU(c,t)||Iae(o)},getConflictingClassGroupIds:(o,c)=>{const d=r[o]||[];return c&&s[o]?[...d,...s[o]]:d}}},iU=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const r=e[0],s=t.nextPart.get(r),a=s?iU(e.slice(1),s):void 0;if(a)return a;if(t.validators.length===0)return;const i=e.join(fk);return(o=t.validators.find(({validator:c})=>c(i)))==null?void 0:o.classGroupId},pO=/^\[(.+)\]$/,Iae=e=>{if(pO.test(e)){const t=pO.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},Dae=e=>{const{theme:t,prefix:r}=e,s={nextPart:new Map,validators:[]};return Bae(Object.entries(e.classGroups),r).forEach(([i,o])=>{QS(o,s,i,t)}),s},QS=(e,t,r,s)=>{e.forEach(a=>{if(typeof a=="string"){const i=a===""?t:gO(t,a);i.classGroupId=r;return}if(typeof a=="function"){if(Lae(a)){QS(a(s),t,r,s);return}t.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,o])=>{QS(o,gO(t,i),r,s)})})},gO=(e,t)=>{let r=e;return t.split(fk).forEach(s=>{r.nextPart.has(s)||r.nextPart.set(s,{nextPart:new Map,validators:[]}),r=r.nextPart.get(s)}),r},Lae=e=>e.isThemeGetter,Bae=(e,t)=>t?e.map(([r,s])=>{const a=s.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,c])=>[t+o,c])):i);return[r,a]}):e,$ae=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,s=new Map;const a=(i,o)=>{r.set(i,o),t++,t>e&&(t=0,s=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=s.get(i))!==void 0)return a(i,o),o},set(i,o){r.has(i)?r.set(i,o):a(i,o)}}},oU="!",Fae=e=>{const{separator:t,experimentalParseClassName:r}=e,s=t.length===1,a=t[0],i=t.length,o=c=>{const d=[];let l=0,u=0,h;for(let v=0;v<c.length;v++){let x=c[v];if(l===0){if(x===a&&(s||c.slice(v,v+i)===t)){d.push(c.slice(u,v)),u=v+i;continue}if(x==="/"){h=v;continue}}x==="["?l++:x==="]"&&l--}const f=d.length===0?c:c.substring(u),m=f.startsWith(oU),p=m?f.substring(1):f,g=h&&h>u?h-u:void 0;return{modifiers:d,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:g}};return r?c=>r({className:c,parseClassName:o}):o},zae=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(s=>{s[0]==="["?(t.push(...r.sort(),s),r=[]):r.push(s)}),t.push(...r.sort()),t},Uae=e=>({cache:$ae(e.cacheSize),parseClassName:Fae(e),...Mae(e)}),Vae=/\s+/,qae=(e,t)=>{const{parseClassName:r,getClassGroupId:s,getConflictingClassGroupIds:a}=t,i=[],o=e.trim().split(Vae);let c="";for(let d=o.length-1;d>=0;d-=1){const l=o[d],{modifiers:u,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:m}=r(l);let p=!!m,g=s(p?f.substring(0,m):f);if(!g){if(!p){c=l+(c.length>0?" "+c:c);continue}if(g=s(f),!g){c=l+(c.length>0?" "+c:c);continue}p=!1}const v=zae(u).join(":"),x=h?v+oU:v,y=x+g;if(i.includes(y))continue;i.push(y);const b=a(g,p);for(let j=0;j<b.length;++j){const T=b[j];i.push(x+T)}c=l+(c.length>0?" "+c:c)}return c};function Wae(){let e=0,t,r,s="";for(;e<arguments.length;)(t=arguments[e++])&&(r=lU(t))&&(s&&(s+=" "),s+=r);return s}const lU=e=>{if(typeof e=="string")return e;let t,r="";for(let s=0;s<e.length;s++)e[s]&&(t=lU(e[s]))&&(r&&(r+=" "),r+=t);return r};function Hae(e,...t){let r,s,a,i=o;function o(d){const l=t.reduce((u,h)=>h(u),e());return r=Uae(l),s=r.cache.get,a=r.cache.set,i=c,c(d)}function c(d){const l=s(d);if(l)return l;const u=qae(d,r);return a(d,u),u}return function(){return i(Wae.apply(null,arguments))}}const cs=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},cU=/^\[(?:([a-z-]+):)?(.+)\]$/i,Gae=/^\d+\/\d+$/,Kae=new Set(["px","full","screen"]),Xae=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Yae=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Zae=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Qae=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Jae=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Bc=e=>Wm(e)||Kae.has(e)||Gae.test(e),Id=e=>gg(e,"length",oie),Wm=e=>!!e&&!Number.isNaN(Number(e)),t3=e=>gg(e,"number",Wm),m0=e=>!!e&&Number.isInteger(Number(e)),eie=e=>e.endsWith("%")&&Wm(e.slice(0,-1)),Jr=e=>cU.test(e),Dd=e=>Xae.test(e),tie=new Set(["length","size","percentage"]),rie=e=>gg(e,tie,dU),nie=e=>gg(e,"position",dU),sie=new Set(["image","url"]),aie=e=>gg(e,sie,cie),iie=e=>gg(e,"",lie),p0=()=>!0,gg=(e,t,r)=>{const s=cU.exec(e);return s?s[1]?typeof t=="string"?s[1]===t:t.has(s[1]):r(s[2]):!1},oie=e=>Yae.test(e)&&!Zae.test(e),dU=()=>!1,lie=e=>Qae.test(e),cie=e=>Jae.test(e),die=()=>{const e=cs("colors"),t=cs("spacing"),r=cs("blur"),s=cs("brightness"),a=cs("borderColor"),i=cs("borderRadius"),o=cs("borderSpacing"),c=cs("borderWidth"),d=cs("contrast"),l=cs("grayscale"),u=cs("hueRotate"),h=cs("invert"),f=cs("gap"),m=cs("gradientColorStops"),p=cs("gradientColorStopPositions"),g=cs("inset"),v=cs("margin"),x=cs("opacity"),y=cs("padding"),b=cs("saturate"),j=cs("scale"),T=cs("sepia"),O=cs("skew"),R=cs("space"),D=cs("translate"),L=()=>["auto","contain","none"],q=()=>["auto","hidden","clip","visible","scroll"],X=()=>["auto",Jr,t],H=()=>[Jr,t],M=()=>["",Bc,Id],F=()=>["auto",Wm,Jr],S=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],E=()=>["solid","dashed","dotted","double","none"],N=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],C=()=>["start","end","center","between","around","evenly","stretch"],k=()=>["","0",Jr],I=()=>["auto","avoid","all","avoid-page","page","left","right","column"],U=()=>[Wm,Jr];return{cacheSize:500,separator:":",theme:{colors:[p0],spacing:[Bc,Id],blur:["none","",Dd,Jr],brightness:U(),borderColor:[e],borderRadius:["none","","full",Dd,Jr],borderSpacing:H(),borderWidth:M(),contrast:U(),grayscale:k(),hueRotate:U(),invert:k(),gap:H(),gradientColorStops:[e],gradientColorStopPositions:[eie,Id],inset:X(),margin:X(),opacity:U(),padding:H(),saturate:U(),scale:U(),sepia:k(),skew:U(),space:H(),translate:H()},classGroups:{aspect:[{aspect:["auto","square","video",Jr]}],container:["container"],columns:[{columns:[Dd]}],"break-after":[{"break-after":I()}],"break-before":[{"break-before":I()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...S(),Jr]}],overflow:[{overflow:q()}],"overflow-x":[{"overflow-x":q()}],"overflow-y":[{"overflow-y":q()}],overscroll:[{overscroll:L()}],"overscroll-x":[{"overscroll-x":L()}],"overscroll-y":[{"overscroll-y":L()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",m0,Jr]}],basis:[{basis:X()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Jr]}],grow:[{grow:k()}],shrink:[{shrink:k()}],order:[{order:["first","last","none",m0,Jr]}],"grid-cols":[{"grid-cols":[p0]}],"col-start-end":[{col:["auto",{span:["full",m0,Jr]},Jr]}],"col-start":[{"col-start":F()}],"col-end":[{"col-end":F()}],"grid-rows":[{"grid-rows":[p0]}],"row-start-end":[{row:["auto",{span:[m0,Jr]},Jr]}],"row-start":[{"row-start":F()}],"row-end":[{"row-end":F()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Jr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Jr]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...C()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...C(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...C(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[R]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[R]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Jr,t]}],"min-w":[{"min-w":[Jr,t,"min","max","fit"]}],"max-w":[{"max-w":[Jr,t,"none","full","min","max","fit","prose",{screen:[Dd]},Dd]}],h:[{h:[Jr,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Jr,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Jr,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Jr,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Dd,Id]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",t3]}],"font-family":[{font:[p0]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Jr]}],"line-clamp":[{"line-clamp":["none",Wm,t3]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Bc,Jr]}],"list-image":[{"list-image":["none",Jr]}],"list-style-type":[{list:["none","disc","decimal",Jr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...E(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Bc,Id]}],"underline-offset":[{"underline-offset":["auto",Bc,Jr]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:H()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Jr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Jr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...S(),nie]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",rie]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},aie]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...E(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:E()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...E()]}],"outline-offset":[{"outline-offset":[Bc,Jr]}],"outline-w":[{outline:[Bc,Id]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Bc,Id]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Dd,iie]}],"shadow-color":[{shadow:[p0]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...N(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":N()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[s]}],contrast:[{contrast:[d]}],"drop-shadow":[{"drop-shadow":["","none",Dd,Jr]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[s]}],"backdrop-contrast":[{"backdrop-contrast":[d]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Jr]}],duration:[{duration:U()}],ease:[{ease:["linear","in","out","in-out",Jr]}],delay:[{delay:U()}],animate:[{animate:["none","spin","ping","pulse","bounce",Jr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[m0,Jr]}],"translate-x":[{"translate-x":[D]}],"translate-y":[{"translate-y":[D]}],"skew-x":[{"skew-x":[O]}],"skew-y":[{"skew-y":[O]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Jr]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Jr]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":H()}],"scroll-mx":[{"scroll-mx":H()}],"scroll-my":[{"scroll-my":H()}],"scroll-ms":[{"scroll-ms":H()}],"scroll-me":[{"scroll-me":H()}],"scroll-mt":[{"scroll-mt":H()}],"scroll-mr":[{"scroll-mr":H()}],"scroll-mb":[{"scroll-mb":H()}],"scroll-ml":[{"scroll-ml":H()}],"scroll-p":[{"scroll-p":H()}],"scroll-px":[{"scroll-px":H()}],"scroll-py":[{"scroll-py":H()}],"scroll-ps":[{"scroll-ps":H()}],"scroll-pe":[{"scroll-pe":H()}],"scroll-pt":[{"scroll-pt":H()}],"scroll-pr":[{"scroll-pr":H()}],"scroll-pb":[{"scroll-pb":H()}],"scroll-pl":[{"scroll-pl":H()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Jr]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Bc,Id,t3]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},uie=Hae(die);function We(...e){return uie(Xr(e))}const hie=Qse,uU=P.forwardRef(({className:e,...t},r)=>n.jsx(Rz,{ref:r,className:We("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));uU.displayName=Rz.displayName;const fie=pg("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),hU=P.forwardRef(({className:e,variant:t,...r},s)=>n.jsx(Mz,{ref:s,className:We(fie({variant:t}),e),...r}));hU.displayName=Mz.displayName;const mie=P.forwardRef(({className:e,...t},r)=>n.jsx(Lz,{ref:r,className:We("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",e),...t}));mie.displayName=Lz.displayName;const fU=P.forwardRef(({className:e,...t},r)=>n.jsx(Bz,{ref:r,className:We("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:n.jsx(an,{className:"h-4 w-4"})}));fU.displayName=Bz.displayName;const mU=P.forwardRef(({className:e,...t},r)=>n.jsx(Iz,{ref:r,className:We("text-sm font-semibold",e),...t}));mU.displayName=Iz.displayName;const pU=P.forwardRef(({className:e,...t},r)=>n.jsx(Dz,{ref:r,className:We("text-sm opacity-90",e),...t}));pU.displayName=Dz.displayName;function pie(){const{toasts:e}=lse();return n.jsxs(hie,{children:[e.map(function({id:t,title:r,description:s,action:a,...i}){return n.jsxs(hU,{...i,children:[n.jsxs("div",{className:"grid gap-1",children:[r&&n.jsx(mU,{children:r}),s&&n.jsx(pU,{children:s})]}),a,n.jsx(fU,{})]},t)}),n.jsx(uU,{})]})}var xO=["light","dark"],gie="(prefers-color-scheme: dark)",xie=P.createContext(void 0),vie={setTheme:e=>{},themes:[]},yie=()=>{var e;return(e=P.useContext(xie))!=null?e:vie};P.memo(({forcedTheme:e,storageKey:t,attribute:r,enableSystem:s,enableColorScheme:a,defaultTheme:i,value:o,attrs:c,nonce:d})=>{let l=i==="system",u=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${c.map(p=>`'${p}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,h=a?xO.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(p,g=!1,v=!0)=>{let x=o?o[p]:p,y=g?p+"|| ''":`'${x}'`,b="";return a&&v&&!g&&xO.includes(p)&&(b+=`d.style.colorScheme = '${p}';`),r==="class"?g||x?b+=`c.add(${y})`:b+="null":x&&(b+=`d[s](n,${y})`),b},m=e?`!function(){${u}${f(e)}}()`:s?`!function(){try{${u}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${l})){var t='${gie}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${l?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${u}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return P.createElement("script",{nonce:d,dangerouslySetInnerHTML:{__html:m}})});var bie=e=>{switch(e){case"success":return jie;case"info":return Sie;case"warning":return Nie;case"error":return Cie;default:return null}},wie=Array(12).fill(0),_ie=({visible:e,className:t})=>we.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},we.createElement("div",{className:"sonner-spinner"},wie.map((r,s)=>we.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),jie=we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},we.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Nie=we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},we.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Sie=we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},we.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Cie=we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},we.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Eie=we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},we.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),we.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),kie=()=>{let[e,t]=we.useState(document.hidden);return we.useEffect(()=>{let r=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),e},JS=1,Aie=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:r,...s}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:JS++,i=this.toasts.find(c=>c.id===a),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),i?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...e,id:a,title:r}),{...c,...e,id:a,dismissible:o,title:r}):c):this.addToast({title:r,...s,dismissible:o,id:a}),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(r=>r({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let r;t.loading!==void 0&&(r=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let s=e instanceof Promise?e:e(),a=r!==void 0,i,o=s.then(async d=>{if(i=["resolve",d],we.isValidElement(d))a=!1,this.create({id:r,type:"default",message:d});else if(Pie(d)&&!d.ok){a=!1;let l=typeof t.error=="function"?await t.error(`HTTP error! status: ${d.status}`):t.error,u=typeof t.description=="function"?await t.description(`HTTP error! status: ${d.status}`):t.description;this.create({id:r,type:"error",message:l,description:u})}else if(t.success!==void 0){a=!1;let l=typeof t.success=="function"?await t.success(d):t.success,u=typeof t.description=="function"?await t.description(d):t.description;this.create({id:r,type:"success",message:l,description:u})}}).catch(async d=>{if(i=["reject",d],t.error!==void 0){a=!1;let l=typeof t.error=="function"?await t.error(d):t.error,u=typeof t.description=="function"?await t.description(d):t.description;this.create({id:r,type:"error",message:l,description:u})}}).finally(()=>{var d;a&&(this.dismiss(r),r=void 0),(d=t.finally)==null||d.call(t)}),c=()=>new Promise((d,l)=>o.then(()=>i[0]==="reject"?l(i[1]):d(i[1])).catch(l));return typeof r!="string"&&typeof r!="number"?{unwrap:c}:Object.assign(r,{unwrap:c})},this.custom=(e,t)=>{let r=(t==null?void 0:t.id)||JS++;return this.create({jsx:e(r),id:r,...t}),r},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Li=new Aie,Tie=(e,t)=>{let r=(t==null?void 0:t.id)||JS++;return Li.addToast({title:e,...t,id:r}),r},Pie=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",Oie=Tie,Rie=()=>Li.toasts,Mie=()=>Li.getActiveToasts(),de=Object.assign(Oie,{success:Li.success,info:Li.info,warning:Li.warning,error:Li.error,custom:Li.custom,message:Li.message,promise:Li.promise,dismiss:Li.dismiss,loading:Li.loading},{getHistory:Rie,getToasts:Mie});function Iie(e,{insertAt:t}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t==="top"&&r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}Iie(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Sy(e){return e.label!==void 0}var Die=3,Lie="32px",Bie="16px",vO=4e3,$ie=356,Fie=14,zie=20,Uie=200;function cl(...e){return e.filter(Boolean).join(" ")}function Vie(e){let[t,r]=e.split("-"),s=[];return t&&s.push(t),r&&s.push(r),s}var qie=e=>{var t,r,s,a,i,o,c,d,l,u,h;let{invert:f,toast:m,unstyled:p,interacting:g,setHeights:v,visibleToasts:x,heights:y,index:b,toasts:j,expanded:T,removeToast:O,defaultRichColors:R,closeButton:D,style:L,cancelButtonStyle:q,actionButtonStyle:X,className:H="",descriptionClassName:M="",duration:F,position:S,gap:E,loadingIcon:N,expandByDefault:C,classNames:k,icons:I,closeButtonAriaLabel:U="Close toast",pauseWhenPageIsHidden:$}=e,[Y,Z]=we.useState(null),[re,G]=we.useState(null),[J,V]=we.useState(!1),[W,ee]=we.useState(!1),[ie,oe]=we.useState(!1),[se,le]=we.useState(!1),[ye,ue]=we.useState(!1),[ne,pe]=we.useState(0),[ge,Ne]=we.useState(0),_e=we.useRef(m.duration||F||vO),be=we.useRef(null),Me=we.useRef(null),Se=b===0,$e=b+1<=x,Ke=m.type,Ze=m.dismissible!==!1,it=m.className||"",Re=m.descriptionClassName||"",ot=we.useMemo(()=>y.findIndex(ct=>ct.toastId===m.id)||0,[y,m.id]),ut=we.useMemo(()=>{var ct;return(ct=m.closeButton)!=null?ct:D},[m.closeButton,D]),bt=we.useMemo(()=>m.duration||F||vO,[m.duration,F]),Je=we.useRef(0),Ce=we.useRef(0),Ge=we.useRef(0),Pe=we.useRef(null),[Ve,st]=S.split("-"),xt=we.useMemo(()=>y.reduce((ct,at,gt)=>gt>=ot?ct:ct+at.height,0),[y,ot]),fe=kie(),Ie=m.invert||f,tt=Ke==="loading";Ce.current=we.useMemo(()=>ot*E+xt,[ot,xt]),we.useEffect(()=>{_e.current=bt},[bt]),we.useEffect(()=>{V(!0)},[]),we.useEffect(()=>{let ct=Me.current;if(ct){let at=ct.getBoundingClientRect().height;return Ne(at),v(gt=>[{toastId:m.id,height:at,position:m.position},...gt]),()=>v(gt=>gt.filter(Yt=>Yt.toastId!==m.id))}},[v,m.id]),we.useLayoutEffect(()=>{if(!J)return;let ct=Me.current,at=ct.style.height;ct.style.height="auto";let gt=ct.getBoundingClientRect().height;ct.style.height=at,Ne(gt),v(Yt=>Yt.find(St=>St.toastId===m.id)?Yt.map(St=>St.toastId===m.id?{...St,height:gt}:St):[{toastId:m.id,height:gt,position:m.position},...Yt])},[J,m.title,m.description,v,m.id]);let lt=we.useCallback(()=>{ee(!0),pe(Ce.current),v(ct=>ct.filter(at=>at.toastId!==m.id)),setTimeout(()=>{O(m)},Uie)},[m,O,v,Ce]);we.useEffect(()=>{if(m.promise&&Ke==="loading"||m.duration===1/0||m.type==="loading")return;let ct;return T||g||$&&fe?(()=>{if(Ge.current<Je.current){let at=new Date().getTime()-Je.current;_e.current=_e.current-at}Ge.current=new Date().getTime()})():_e.current!==1/0&&(Je.current=new Date().getTime(),ct=setTimeout(()=>{var at;(at=m.onAutoClose)==null||at.call(m,m),lt()},_e.current)),()=>clearTimeout(ct)},[T,g,m,Ke,$,fe,lt]),we.useEffect(()=>{m.delete&&lt()},[lt,m.delete]);function It(){var ct,at,gt;return I!=null&&I.loading?we.createElement("div",{className:cl(k==null?void 0:k.loader,(ct=m==null?void 0:m.classNames)==null?void 0:ct.loader,"sonner-loader"),"data-visible":Ke==="loading"},I.loading):N?we.createElement("div",{className:cl(k==null?void 0:k.loader,(at=m==null?void 0:m.classNames)==null?void 0:at.loader,"sonner-loader"),"data-visible":Ke==="loading"},N):we.createElement(_ie,{className:cl(k==null?void 0:k.loader,(gt=m==null?void 0:m.classNames)==null?void 0:gt.loader),visible:Ke==="loading"})}return we.createElement("li",{tabIndex:0,ref:Me,className:cl(H,it,k==null?void 0:k.toast,(t=m==null?void 0:m.classNames)==null?void 0:t.toast,k==null?void 0:k.default,k==null?void 0:k[Ke],(r=m==null?void 0:m.classNames)==null?void 0:r[Ke]),"data-sonner-toast":"","data-rich-colors":(s=m.richColors)!=null?s:R,"data-styled":!(m.jsx||m.unstyled||p),"data-mounted":J,"data-promise":!!m.promise,"data-swiped":ye,"data-removed":W,"data-visible":$e,"data-y-position":Ve,"data-x-position":st,"data-index":b,"data-front":Se,"data-swiping":ie,"data-dismissible":Ze,"data-type":Ke,"data-invert":Ie,"data-swipe-out":se,"data-swipe-direction":re,"data-expanded":!!(T||C&&J),style:{"--index":b,"--toasts-before":b,"--z-index":j.length-b,"--offset":`${W?ne:Ce.current}px`,"--initial-height":C?"auto":`${ge}px`,...L,...m.style},onDragEnd:()=>{oe(!1),Z(null),Pe.current=null},onPointerDown:ct=>{tt||!Ze||(be.current=new Date,pe(Ce.current),ct.target.setPointerCapture(ct.pointerId),ct.target.tagName!=="BUTTON"&&(oe(!0),Pe.current={x:ct.clientX,y:ct.clientY}))},onPointerUp:()=>{var ct,at,gt,Yt;if(se||!Ze)return;Pe.current=null;let St=Number(((ct=Me.current)==null?void 0:ct.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),rt=Number(((at=Me.current)==null?void 0:at.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),ir=new Date().getTime()-((gt=be.current)==null?void 0:gt.getTime()),Ct=Y==="x"?St:rt,Te=Math.abs(Ct)/ir;if(Math.abs(Ct)>=zie||Te>.11){pe(Ce.current),(Yt=m.onDismiss)==null||Yt.call(m,m),G(Y==="x"?St>0?"right":"left":rt>0?"down":"up"),lt(),le(!0),ue(!1);return}oe(!1),Z(null)},onPointerMove:ct=>{var at,gt,Yt,St;if(!Pe.current||!Ze||((at=window.getSelection())==null?void 0:at.toString().length)>0)return;let rt=ct.clientY-Pe.current.y,ir=ct.clientX-Pe.current.x,Ct=(gt=e.swipeDirections)!=null?gt:Vie(S);!Y&&(Math.abs(ir)>1||Math.abs(rt)>1)&&Z(Math.abs(ir)>Math.abs(rt)?"x":"y");let Te={x:0,y:0};Y==="y"?(Ct.includes("top")||Ct.includes("bottom"))&&(Ct.includes("top")&&rt<0||Ct.includes("bottom")&&rt>0)&&(Te.y=rt):Y==="x"&&(Ct.includes("left")||Ct.includes("right"))&&(Ct.includes("left")&&ir<0||Ct.includes("right")&&ir>0)&&(Te.x=ir),(Math.abs(Te.x)>0||Math.abs(Te.y)>0)&&ue(!0),(Yt=Me.current)==null||Yt.style.setProperty("--swipe-amount-x",`${Te.x}px`),(St=Me.current)==null||St.style.setProperty("--swipe-amount-y",`${Te.y}px`)}},ut&&!m.jsx?we.createElement("button",{"aria-label":U,"data-disabled":tt,"data-close-button":!0,onClick:tt||!Ze?()=>{}:()=>{var ct;lt(),(ct=m.onDismiss)==null||ct.call(m,m)},className:cl(k==null?void 0:k.closeButton,(a=m==null?void 0:m.classNames)==null?void 0:a.closeButton)},(i=I==null?void 0:I.close)!=null?i:Eie):null,m.jsx||P.isValidElement(m.title)?m.jsx?m.jsx:typeof m.title=="function"?m.title():m.title:we.createElement(we.Fragment,null,Ke||m.icon||m.promise?we.createElement("div",{"data-icon":"",className:cl(k==null?void 0:k.icon,(o=m==null?void 0:m.classNames)==null?void 0:o.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||It():null,m.type!=="loading"?m.icon||(I==null?void 0:I[Ke])||bie(Ke):null):null,we.createElement("div",{"data-content":"",className:cl(k==null?void 0:k.content,(c=m==null?void 0:m.classNames)==null?void 0:c.content)},we.createElement("div",{"data-title":"",className:cl(k==null?void 0:k.title,(d=m==null?void 0:m.classNames)==null?void 0:d.title)},typeof m.title=="function"?m.title():m.title),m.description?we.createElement("div",{"data-description":"",className:cl(M,Re,k==null?void 0:k.description,(l=m==null?void 0:m.classNames)==null?void 0:l.description)},typeof m.description=="function"?m.description():m.description):null),P.isValidElement(m.cancel)?m.cancel:m.cancel&&Sy(m.cancel)?we.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||q,onClick:ct=>{var at,gt;Sy(m.cancel)&&Ze&&((gt=(at=m.cancel).onClick)==null||gt.call(at,ct),lt())},className:cl(k==null?void 0:k.cancelButton,(u=m==null?void 0:m.classNames)==null?void 0:u.cancelButton)},m.cancel.label):null,P.isValidElement(m.action)?m.action:m.action&&Sy(m.action)?we.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||X,onClick:ct=>{var at,gt;Sy(m.action)&&((gt=(at=m.action).onClick)==null||gt.call(at,ct),!ct.defaultPrevented&&lt())},className:cl(k==null?void 0:k.actionButton,(h=m==null?void 0:m.classNames)==null?void 0:h.actionButton)},m.action.label):null))};function yO(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function Wie(e,t){let r={};return[e,t].forEach((s,a)=>{let i=a===1,o=i?"--mobile-offset":"--offset",c=i?Bie:Lie;function d(l){["top","right","bottom","left"].forEach(u=>{r[`${o}-${u}`]=typeof l=="number"?`${l}px`:l})}typeof s=="number"||typeof s=="string"?d(s):typeof s=="object"?["top","right","bottom","left"].forEach(l=>{s[l]===void 0?r[`${o}-${l}`]=c:r[`${o}-${l}`]=typeof s[l]=="number"?`${s[l]}px`:s[l]}):d(c)}),r}var Hie=P.forwardRef(function(e,t){let{invert:r,position:s="bottom-right",hotkey:a=["altKey","KeyT"],expand:i,closeButton:o,className:c,offset:d,mobileOffset:l,theme:u="light",richColors:h,duration:f,style:m,visibleToasts:p=Die,toastOptions:g,dir:v=yO(),gap:x=Fie,loadingIcon:y,icons:b,containerAriaLabel:j="Notifications",pauseWhenPageIsHidden:T}=e,[O,R]=we.useState([]),D=we.useMemo(()=>Array.from(new Set([s].concat(O.filter($=>$.position).map($=>$.position)))),[O,s]),[L,q]=we.useState([]),[X,H]=we.useState(!1),[M,F]=we.useState(!1),[S,E]=we.useState(u!=="system"?u:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),N=we.useRef(null),C=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),k=we.useRef(null),I=we.useRef(!1),U=we.useCallback($=>{R(Y=>{var Z;return(Z=Y.find(re=>re.id===$.id))!=null&&Z.delete||Li.dismiss($.id),Y.filter(({id:re})=>re!==$.id)})},[]);return we.useEffect(()=>Li.subscribe($=>{if($.dismiss){R(Y=>Y.map(Z=>Z.id===$.id?{...Z,delete:!0}:Z));return}setTimeout(()=>{hz.flushSync(()=>{R(Y=>{let Z=Y.findIndex(re=>re.id===$.id);return Z!==-1?[...Y.slice(0,Z),{...Y[Z],...$},...Y.slice(Z+1)]:[$,...Y]})})})}),[]),we.useEffect(()=>{if(u!=="system"){E(u);return}if(u==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?E("dark"):E("light")),typeof window>"u")return;let $=window.matchMedia("(prefers-color-scheme: dark)");try{$.addEventListener("change",({matches:Y})=>{E(Y?"dark":"light")})}catch{$.addListener(({matches:Z})=>{try{E(Z?"dark":"light")}catch(re){console.error(re)}})}},[u]),we.useEffect(()=>{O.length<=1&&H(!1)},[O]),we.useEffect(()=>{let $=Y=>{var Z,re;a.every(G=>Y[G]||Y.code===G)&&(H(!0),(Z=N.current)==null||Z.focus()),Y.code==="Escape"&&(document.activeElement===N.current||(re=N.current)!=null&&re.contains(document.activeElement))&&H(!1)};return document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)},[a]),we.useEffect(()=>{if(N.current)return()=>{k.current&&(k.current.focus({preventScroll:!0}),k.current=null,I.current=!1)}},[N.current]),we.createElement("section",{ref:t,"aria-label":`${j} ${C}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},D.map(($,Y)=>{var Z;let[re,G]=$.split("-");return O.length?we.createElement("ol",{key:$,dir:v==="auto"?yO():v,tabIndex:-1,ref:N,className:c,"data-sonner-toaster":!0,"data-theme":S,"data-y-position":re,"data-lifted":X&&O.length>1&&!i,"data-x-position":G,style:{"--front-toast-height":`${((Z=L[0])==null?void 0:Z.height)||0}px`,"--width":`${$ie}px`,"--gap":`${x}px`,...m,...Wie(d,l)},onBlur:J=>{I.current&&!J.currentTarget.contains(J.relatedTarget)&&(I.current=!1,k.current&&(k.current.focus({preventScroll:!0}),k.current=null))},onFocus:J=>{J.target instanceof HTMLElement&&J.target.dataset.dismissible==="false"||I.current||(I.current=!0,k.current=J.relatedTarget)},onMouseEnter:()=>H(!0),onMouseMove:()=>H(!0),onMouseLeave:()=>{M||H(!1)},onDragEnd:()=>H(!1),onPointerDown:J=>{J.target instanceof HTMLElement&&J.target.dataset.dismissible==="false"||F(!0)},onPointerUp:()=>F(!1)},O.filter(J=>!J.position&&Y===0||J.position===$).map((J,V)=>{var W,ee;return we.createElement(qie,{key:J.id,icons:b,index:V,toast:J,defaultRichColors:h,duration:(W=g==null?void 0:g.duration)!=null?W:f,className:g==null?void 0:g.className,descriptionClassName:g==null?void 0:g.descriptionClassName,invert:r,visibleToasts:p,closeButton:(ee=g==null?void 0:g.closeButton)!=null?ee:o,interacting:M,position:$,style:g==null?void 0:g.style,unstyled:g==null?void 0:g.unstyled,classNames:g==null?void 0:g.classNames,cancelButtonStyle:g==null?void 0:g.cancelButtonStyle,actionButtonStyle:g==null?void 0:g.actionButtonStyle,removeToast:U,toasts:O.filter(ie=>ie.position==J.position),heights:L.filter(ie=>ie.position==J.position),setHeights:q,expandByDefault:i,gap:x,loadingIcon:y,expanded:X,pauseWhenPageIsHidden:T,swipeDirections:e.swipeDirections})})):null}))});const Gie=({...e})=>{const{theme:t="system"}=yie();return n.jsx(Hie,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var Kie=l6[" useId ".trim().toString()]||(()=>{}),Xie=0;function xa(e){const[t,r]=P.useState(Kie());return ya(()=>{e||r(s=>s??String(Xie++))},[e]),e||(t?`radix-${t}`:"")}const Yie=["top","right","bottom","left"],ku=Math.min,co=Math.max,xw=Math.round,Cy=Math.floor,uc=e=>({x:e,y:e}),Zie={left:"right",right:"left",bottom:"top",top:"bottom"},Qie={start:"end",end:"start"};function eC(e,t,r){return co(e,ku(t,r))}function dd(e,t){return typeof e=="function"?e(t):e}function ud(e){return e.split("-")[0]}function xg(e){return e.split("-")[1]}function mk(e){return e==="x"?"y":"x"}function pk(e){return e==="y"?"height":"width"}const Jie=new Set(["top","bottom"]);function sc(e){return Jie.has(ud(e))?"y":"x"}function gk(e){return mk(sc(e))}function eoe(e,t,r){r===void 0&&(r=!1);const s=xg(e),a=gk(e),i=pk(a);let o=a==="x"?s===(r?"end":"start")?"right":"left":s==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=vw(o)),[o,vw(o)]}function toe(e){const t=vw(e);return[tC(e),t,tC(t)]}function tC(e){return e.replace(/start|end/g,t=>Qie[t])}const bO=["left","right"],wO=["right","left"],roe=["top","bottom"],noe=["bottom","top"];function soe(e,t,r){switch(e){case"top":case"bottom":return r?t?wO:bO:t?bO:wO;case"left":case"right":return t?roe:noe;default:return[]}}function aoe(e,t,r,s){const a=xg(e);let i=soe(ud(e),r==="start",s);return a&&(i=i.map(o=>o+"-"+a),t&&(i=i.concat(i.map(tC)))),i}function vw(e){return e.replace(/left|right|bottom|top/g,t=>Zie[t])}function ioe(e){return{top:0,right:0,bottom:0,left:0,...e}}function gU(e){return typeof e!="number"?ioe(e):{top:e,right:e,bottom:e,left:e}}function yw(e){const{x:t,y:r,width:s,height:a}=e;return{width:s,height:a,top:r,left:t,right:t+s,bottom:r+a,x:t,y:r}}function _O(e,t,r){let{reference:s,floating:a}=e;const i=sc(t),o=gk(t),c=pk(o),d=ud(t),l=i==="y",u=s.x+s.width/2-a.width/2,h=s.y+s.height/2-a.height/2,f=s[c]/2-a[c]/2;let m;switch(d){case"top":m={x:u,y:s.y-a.height};break;case"bottom":m={x:u,y:s.y+s.height};break;case"right":m={x:s.x+s.width,y:h};break;case"left":m={x:s.x-a.width,y:h};break;default:m={x:s.x,y:s.y}}switch(xg(t)){case"start":m[o]-=f*(r&&l?-1:1);break;case"end":m[o]+=f*(r&&l?-1:1);break}return m}const ooe=async(e,t,r)=>{const{placement:s="bottom",strategy:a="absolute",middleware:i=[],platform:o}=r,c=i.filter(Boolean),d=await(o.isRTL==null?void 0:o.isRTL(t));let l=await o.getElementRects({reference:e,floating:t,strategy:a}),{x:u,y:h}=_O(l,s,d),f=s,m={},p=0;for(let g=0;g<c.length;g++){const{name:v,fn:x}=c[g],{x:y,y:b,data:j,reset:T}=await x({x:u,y:h,initialPlacement:s,placement:f,strategy:a,middlewareData:m,rects:l,platform:o,elements:{reference:e,floating:t}});u=y??u,h=b??h,m={...m,[v]:{...m[v],...j}},T&&p<=50&&(p++,typeof T=="object"&&(T.placement&&(f=T.placement),T.rects&&(l=T.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:a}):T.rects),{x:u,y:h}=_O(l,f,d)),g=-1)}return{x:u,y:h,placement:f,strategy:a,middlewareData:m}};async function Wx(e,t){var r;t===void 0&&(t={});const{x:s,y:a,platform:i,rects:o,elements:c,strategy:d}=e,{boundary:l="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=dd(t,e),p=gU(m),v=c[f?h==="floating"?"reference":"floating":h],x=yw(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(v)))==null||r?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(c.floating)),boundary:l,rootBoundary:u,strategy:d})),y=h==="floating"?{x:s,y:a,width:o.floating.width,height:o.floating.height}:o.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(c.floating)),j=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},T=yw(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:y,offsetParent:b,strategy:d}):y);return{top:(x.top-T.top+p.top)/j.y,bottom:(T.bottom-x.bottom+p.bottom)/j.y,left:(x.left-T.left+p.left)/j.x,right:(T.right-x.right+p.right)/j.x}}const loe=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:s,placement:a,rects:i,platform:o,elements:c,middlewareData:d}=t,{element:l,padding:u=0}=dd(e,t)||{};if(l==null)return{};const h=gU(u),f={x:r,y:s},m=gk(a),p=pk(m),g=await o.getDimensions(l),v=m==="y",x=v?"top":"left",y=v?"bottom":"right",b=v?"clientHeight":"clientWidth",j=i.reference[p]+i.reference[m]-f[m]-i.floating[p],T=f[m]-i.reference[m],O=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l));let R=O?O[b]:0;(!R||!await(o.isElement==null?void 0:o.isElement(O)))&&(R=c.floating[b]||i.floating[p]);const D=j/2-T/2,L=R/2-g[p]/2-1,q=ku(h[x],L),X=ku(h[y],L),H=q,M=R-g[p]-X,F=R/2-g[p]/2+D,S=eC(H,F,M),E=!d.arrow&&xg(a)!=null&&F!==S&&i.reference[p]/2-(F<H?q:X)-g[p]/2<0,N=E?F<H?F-H:F-M:0;return{[m]:f[m]+N,data:{[m]:S,centerOffset:F-S-N,...E&&{alignmentOffset:N}},reset:E}}}),coe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,s;const{placement:a,middlewareData:i,rects:o,initialPlacement:c,platform:d,elements:l}=t,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...v}=dd(e,t);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const x=ud(a),y=sc(c),b=ud(c)===c,j=await(d.isRTL==null?void 0:d.isRTL(l.floating)),T=f||(b||!g?[vw(c)]:toe(c)),O=p!=="none";!f&&O&&T.push(...aoe(c,g,p,j));const R=[c,...T],D=await Wx(t,v),L=[];let q=((s=i.flip)==null?void 0:s.overflows)||[];if(u&&L.push(D[x]),h){const F=eoe(a,o,j);L.push(D[F[0]],D[F[1]])}if(q=[...q,{placement:a,overflows:L}],!L.every(F=>F<=0)){var X,H;const F=(((X=i.flip)==null?void 0:X.index)||0)+1,S=R[F];if(S&&(!(h==="alignment"?y!==sc(S):!1)||q.every(C=>C.overflows[0]>0&&sc(C.placement)===y)))return{data:{index:F,overflows:q},reset:{placement:S}};let E=(H=q.filter(N=>N.overflows[0]<=0).sort((N,C)=>N.overflows[1]-C.overflows[1])[0])==null?void 0:H.placement;if(!E)switch(m){case"bestFit":{var M;const N=(M=q.filter(C=>{if(O){const k=sc(C.placement);return k===y||k==="y"}return!0}).map(C=>[C.placement,C.overflows.filter(k=>k>0).reduce((k,I)=>k+I,0)]).sort((C,k)=>C[1]-k[1])[0])==null?void 0:M[0];N&&(E=N);break}case"initialPlacement":E=c;break}if(a!==E)return{reset:{placement:E}}}return{}}}};function jO(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function NO(e){return Yie.some(t=>e[t]>=0)}const doe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:s="referenceHidden",...a}=dd(e,t);switch(s){case"referenceHidden":{const i=await Wx(t,{...a,elementContext:"reference"}),o=jO(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:NO(o)}}}case"escaped":{const i=await Wx(t,{...a,altBoundary:!0}),o=jO(i,r.floating);return{data:{escapedOffsets:o,escaped:NO(o)}}}default:return{}}}}},xU=new Set(["left","top"]);async function uoe(e,t){const{placement:r,platform:s,elements:a}=e,i=await(s.isRTL==null?void 0:s.isRTL(a.floating)),o=ud(r),c=xg(r),d=sc(r)==="y",l=xU.has(o)?-1:1,u=i&&d?-1:1,h=dd(t,e);let{mainAxis:f,crossAxis:m,alignmentAxis:p}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return c&&typeof p=="number"&&(m=c==="end"?p*-1:p),d?{x:m*u,y:f*l}:{x:f*l,y:m*u}}const hoe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,s;const{x:a,y:i,placement:o,middlewareData:c}=t,d=await uoe(t,e);return o===((r=c.offset)==null?void 0:r.placement)&&(s=c.arrow)!=null&&s.alignmentOffset?{}:{x:a+d.x,y:i+d.y,data:{...d,placement:o}}}}},foe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:s,placement:a}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:c={fn:v=>{let{x,y}=v;return{x,y}}},...d}=dd(e,t),l={x:r,y:s},u=await Wx(t,d),h=sc(ud(a)),f=mk(h);let m=l[f],p=l[h];if(i){const v=f==="y"?"top":"left",x=f==="y"?"bottom":"right",y=m+u[v],b=m-u[x];m=eC(y,m,b)}if(o){const v=h==="y"?"top":"left",x=h==="y"?"bottom":"right",y=p+u[v],b=p-u[x];p=eC(y,p,b)}const g=c.fn({...t,[f]:m,[h]:p});return{...g,data:{x:g.x-r,y:g.y-s,enabled:{[f]:i,[h]:o}}}}}},moe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:s,placement:a,rects:i,middlewareData:o}=t,{offset:c=0,mainAxis:d=!0,crossAxis:l=!0}=dd(e,t),u={x:r,y:s},h=sc(a),f=mk(h);let m=u[f],p=u[h];const g=dd(c,t),v=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(d){const b=f==="y"?"height":"width",j=i.reference[f]-i.floating[b]+v.mainAxis,T=i.reference[f]+i.reference[b]-v.mainAxis;m<j?m=j:m>T&&(m=T)}if(l){var x,y;const b=f==="y"?"width":"height",j=xU.has(ud(a)),T=i.reference[h]-i.floating[b]+(j&&((x=o.offset)==null?void 0:x[h])||0)+(j?0:v.crossAxis),O=i.reference[h]+i.reference[b]+(j?0:((y=o.offset)==null?void 0:y[h])||0)-(j?v.crossAxis:0);p<T?p=T:p>O&&(p=O)}return{[f]:m,[h]:p}}}},poe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,s;const{placement:a,rects:i,platform:o,elements:c}=t,{apply:d=()=>{},...l}=dd(e,t),u=await Wx(t,l),h=ud(a),f=xg(a),m=sc(a)==="y",{width:p,height:g}=i.floating;let v,x;h==="top"||h==="bottom"?(v=h,x=f===(await(o.isRTL==null?void 0:o.isRTL(c.floating))?"start":"end")?"left":"right"):(x=h,v=f==="end"?"top":"bottom");const y=g-u.top-u.bottom,b=p-u.left-u.right,j=ku(g-u[v],y),T=ku(p-u[x],b),O=!t.middlewareData.shift;let R=j,D=T;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(D=b),(s=t.middlewareData.shift)!=null&&s.enabled.y&&(R=y),O&&!f){const q=co(u.left,0),X=co(u.right,0),H=co(u.top,0),M=co(u.bottom,0);m?D=p-2*(q!==0||X!==0?q+X:co(u.left,u.right)):R=g-2*(H!==0||M!==0?H+M:co(u.top,u.bottom))}await d({...t,availableWidth:D,availableHeight:R});const L=await o.getDimensions(c.floating);return p!==L.width||g!==L.height?{reset:{rects:!0}}:{}}}};function S_(){return typeof window<"u"}function vg(e){return vU(e)?(e.nodeName||"").toLowerCase():"#document"}function yo(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Sc(e){var t;return(t=(vU(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function vU(e){return S_()?e instanceof Node||e instanceof yo(e).Node:!1}function Ol(e){return S_()?e instanceof Element||e instanceof yo(e).Element:!1}function yc(e){return S_()?e instanceof HTMLElement||e instanceof yo(e).HTMLElement:!1}function SO(e){return!S_()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof yo(e).ShadowRoot}const goe=new Set(["inline","contents"]);function m1(e){const{overflow:t,overflowX:r,overflowY:s,display:a}=Rl(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+r)&&!goe.has(a)}const xoe=new Set(["table","td","th"]);function voe(e){return xoe.has(vg(e))}const yoe=[":popover-open",":modal"];function C_(e){return yoe.some(t=>{try{return e.matches(t)}catch{return!1}})}const boe=["transform","translate","scale","rotate","perspective"],woe=["transform","translate","scale","rotate","perspective","filter"],_oe=["paint","layout","strict","content"];function xk(e){const t=vk(),r=Ol(e)?Rl(e):e;return boe.some(s=>r[s]?r[s]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||woe.some(s=>(r.willChange||"").includes(s))||_oe.some(s=>(r.contain||"").includes(s))}function joe(e){let t=Au(e);for(;yc(t)&&!yp(t);){if(xk(t))return t;if(C_(t))return null;t=Au(t)}return null}function vk(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Noe=new Set(["html","body","#document"]);function yp(e){return Noe.has(vg(e))}function Rl(e){return yo(e).getComputedStyle(e)}function E_(e){return Ol(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Au(e){if(vg(e)==="html")return e;const t=e.assignedSlot||e.parentNode||SO(e)&&e.host||Sc(e);return SO(t)?t.host:t}function yU(e){const t=Au(e);return yp(t)?e.ownerDocument?e.ownerDocument.body:e.body:yc(t)&&m1(t)?t:yU(t)}function Hx(e,t,r){var s;t===void 0&&(t=[]),r===void 0&&(r=!0);const a=yU(e),i=a===((s=e.ownerDocument)==null?void 0:s.body),o=yo(a);if(i){const c=rC(o);return t.concat(o,o.visualViewport||[],m1(a)?a:[],c&&r?Hx(c):[])}return t.concat(a,Hx(a,[],r))}function rC(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function bU(e){const t=Rl(e);let r=parseFloat(t.width)||0,s=parseFloat(t.height)||0;const a=yc(e),i=a?e.offsetWidth:r,o=a?e.offsetHeight:s,c=xw(r)!==i||xw(s)!==o;return c&&(r=i,s=o),{width:r,height:s,$:c}}function yk(e){return Ol(e)?e:e.contextElement}function Hm(e){const t=yk(e);if(!yc(t))return uc(1);const r=t.getBoundingClientRect(),{width:s,height:a,$:i}=bU(t);let o=(i?xw(r.width):r.width)/s,c=(i?xw(r.height):r.height)/a;return(!o||!Number.isFinite(o))&&(o=1),(!c||!Number.isFinite(c))&&(c=1),{x:o,y:c}}const Soe=uc(0);function wU(e){const t=yo(e);return!vk()||!t.visualViewport?Soe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Coe(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==yo(e)?!1:t}function of(e,t,r,s){t===void 0&&(t=!1),r===void 0&&(r=!1);const a=e.getBoundingClientRect(),i=yk(e);let o=uc(1);t&&(s?Ol(s)&&(o=Hm(s)):o=Hm(e));const c=Coe(i,r,s)?wU(i):uc(0);let d=(a.left+c.x)/o.x,l=(a.top+c.y)/o.y,u=a.width/o.x,h=a.height/o.y;if(i){const f=yo(i),m=s&&Ol(s)?yo(s):s;let p=f,g=rC(p);for(;g&&s&&m!==p;){const v=Hm(g),x=g.getBoundingClientRect(),y=Rl(g),b=x.left+(g.clientLeft+parseFloat(y.paddingLeft))*v.x,j=x.top+(g.clientTop+parseFloat(y.paddingTop))*v.y;d*=v.x,l*=v.y,u*=v.x,h*=v.y,d+=b,l+=j,p=yo(g),g=rC(p)}}return yw({width:u,height:h,x:d,y:l})}function bk(e,t){const r=E_(e).scrollLeft;return t?t.left+r:of(Sc(e)).left+r}function _U(e,t,r){r===void 0&&(r=!1);const s=e.getBoundingClientRect(),a=s.left+t.scrollLeft-(r?0:bk(e,s)),i=s.top+t.scrollTop;return{x:a,y:i}}function Eoe(e){let{elements:t,rect:r,offsetParent:s,strategy:a}=e;const i=a==="fixed",o=Sc(s),c=t?C_(t.floating):!1;if(s===o||c&&i)return r;let d={scrollLeft:0,scrollTop:0},l=uc(1);const u=uc(0),h=yc(s);if((h||!h&&!i)&&((vg(s)!=="body"||m1(o))&&(d=E_(s)),yc(s))){const m=of(s);l=Hm(s),u.x=m.x+s.clientLeft,u.y=m.y+s.clientTop}const f=o&&!h&&!i?_U(o,d,!0):uc(0);return{width:r.width*l.x,height:r.height*l.y,x:r.x*l.x-d.scrollLeft*l.x+u.x+f.x,y:r.y*l.y-d.scrollTop*l.y+u.y+f.y}}function koe(e){return Array.from(e.getClientRects())}function Aoe(e){const t=Sc(e),r=E_(e),s=e.ownerDocument.body,a=co(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),i=co(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight);let o=-r.scrollLeft+bk(e);const c=-r.scrollTop;return Rl(s).direction==="rtl"&&(o+=co(t.clientWidth,s.clientWidth)-a),{width:a,height:i,x:o,y:c}}function Toe(e,t){const r=yo(e),s=Sc(e),a=r.visualViewport;let i=s.clientWidth,o=s.clientHeight,c=0,d=0;if(a){i=a.width,o=a.height;const l=vk();(!l||l&&t==="fixed")&&(c=a.offsetLeft,d=a.offsetTop)}return{width:i,height:o,x:c,y:d}}const Poe=new Set(["absolute","fixed"]);function Ooe(e,t){const r=of(e,!0,t==="fixed"),s=r.top+e.clientTop,a=r.left+e.clientLeft,i=yc(e)?Hm(e):uc(1),o=e.clientWidth*i.x,c=e.clientHeight*i.y,d=a*i.x,l=s*i.y;return{width:o,height:c,x:d,y:l}}function CO(e,t,r){let s;if(t==="viewport")s=Toe(e,r);else if(t==="document")s=Aoe(Sc(e));else if(Ol(t))s=Ooe(t,r);else{const a=wU(e);s={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return yw(s)}function jU(e,t){const r=Au(e);return r===t||!Ol(r)||yp(r)?!1:Rl(r).position==="fixed"||jU(r,t)}function Roe(e,t){const r=t.get(e);if(r)return r;let s=Hx(e,[],!1).filter(c=>Ol(c)&&vg(c)!=="body"),a=null;const i=Rl(e).position==="fixed";let o=i?Au(e):e;for(;Ol(o)&&!yp(o);){const c=Rl(o),d=xk(o);!d&&c.position==="fixed"&&(a=null),(i?!d&&!a:!d&&c.position==="static"&&!!a&&Poe.has(a.position)||m1(o)&&!d&&jU(e,o))?s=s.filter(u=>u!==o):a=c,o=Au(o)}return t.set(e,s),s}function Moe(e){let{element:t,boundary:r,rootBoundary:s,strategy:a}=e;const o=[...r==="clippingAncestors"?C_(t)?[]:Roe(t,this._c):[].concat(r),s],c=o[0],d=o.reduce((l,u)=>{const h=CO(t,u,a);return l.top=co(h.top,l.top),l.right=ku(h.right,l.right),l.bottom=ku(h.bottom,l.bottom),l.left=co(h.left,l.left),l},CO(t,c,a));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function Ioe(e){const{width:t,height:r}=bU(e);return{width:t,height:r}}function Doe(e,t,r){const s=yc(t),a=Sc(t),i=r==="fixed",o=of(e,!0,i,t);let c={scrollLeft:0,scrollTop:0};const d=uc(0);function l(){d.x=bk(a)}if(s||!s&&!i)if((vg(t)!=="body"||m1(a))&&(c=E_(t)),s){const m=of(t,!0,i,t);d.x=m.x+t.clientLeft,d.y=m.y+t.clientTop}else a&&l();i&&!s&&a&&l();const u=a&&!s&&!i?_U(a,c):uc(0),h=o.left+c.scrollLeft-d.x-u.x,f=o.top+c.scrollTop-d.y-u.y;return{x:h,y:f,width:o.width,height:o.height}}function r3(e){return Rl(e).position==="static"}function EO(e,t){if(!yc(e)||Rl(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Sc(e)===r&&(r=r.ownerDocument.body),r}function NU(e,t){const r=yo(e);if(C_(e))return r;if(!yc(e)){let a=Au(e);for(;a&&!yp(a);){if(Ol(a)&&!r3(a))return a;a=Au(a)}return r}let s=EO(e,t);for(;s&&voe(s)&&r3(s);)s=EO(s,t);return s&&yp(s)&&r3(s)&&!xk(s)?r:s||joe(e)||r}const Loe=async function(e){const t=this.getOffsetParent||NU,r=this.getDimensions,s=await r(e.floating);return{reference:Doe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}};function Boe(e){return Rl(e).direction==="rtl"}const $oe={convertOffsetParentRelativeRectToViewportRelativeRect:Eoe,getDocumentElement:Sc,getClippingRect:Moe,getOffsetParent:NU,getElementRects:Loe,getClientRects:koe,getDimensions:Ioe,getScale:Hm,isElement:Ol,isRTL:Boe};function SU(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Foe(e,t){let r=null,s;const a=Sc(e);function i(){var c;clearTimeout(s),(c=r)==null||c.disconnect(),r=null}function o(c,d){c===void 0&&(c=!1),d===void 0&&(d=1),i();const l=e.getBoundingClientRect(),{left:u,top:h,width:f,height:m}=l;if(c||t(),!f||!m)return;const p=Cy(h),g=Cy(a.clientWidth-(u+f)),v=Cy(a.clientHeight-(h+m)),x=Cy(u),b={rootMargin:-p+"px "+-g+"px "+-v+"px "+-x+"px",threshold:co(0,ku(1,d))||1};let j=!0;function T(O){const R=O[0].intersectionRatio;if(R!==d){if(!j)return o();R?o(!1,R):s=setTimeout(()=>{o(!1,1e-7)},1e3)}R===1&&!SU(l,e.getBoundingClientRect())&&o(),j=!1}try{r=new IntersectionObserver(T,{...b,root:a.ownerDocument})}catch{r=new IntersectionObserver(T,b)}r.observe(e)}return o(!0),i}function zoe(e,t,r,s){s===void 0&&(s={});const{ancestorScroll:a=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:d=!1}=s,l=yk(e),u=a||i?[...l?Hx(l):[],...Hx(t)]:[];u.forEach(x=>{a&&x.addEventListener("scroll",r,{passive:!0}),i&&x.addEventListener("resize",r)});const h=l&&c?Foe(l,r):null;let f=-1,m=null;o&&(m=new ResizeObserver(x=>{let[y]=x;y&&y.target===l&&m&&(m.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=m)==null||b.observe(t)})),r()}),l&&!d&&m.observe(l),m.observe(t));let p,g=d?of(e):null;d&&v();function v(){const x=of(e);g&&!SU(g,x)&&r(),g=x,p=requestAnimationFrame(v)}return r(),()=>{var x;u.forEach(y=>{a&&y.removeEventListener("scroll",r),i&&y.removeEventListener("resize",r)}),h==null||h(),(x=m)==null||x.disconnect(),m=null,d&&cancelAnimationFrame(p)}}const Uoe=hoe,Voe=foe,qoe=coe,Woe=poe,Hoe=doe,kO=loe,Goe=moe,Koe=(e,t,r)=>{const s=new Map,a={platform:$oe,...r},i={...a.platform,_c:s};return ooe(e,t,{...a,platform:i})};var Xoe=typeof document<"u",Yoe=function(){},Ob=Xoe?P.useLayoutEffect:Yoe;function bw(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,s,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(s=r;s--!==0;)if(!bw(e[s],t[s]))return!1;return!0}if(a=Object.keys(e),r=a.length,r!==Object.keys(t).length)return!1;for(s=r;s--!==0;)if(!{}.hasOwnProperty.call(t,a[s]))return!1;for(s=r;s--!==0;){const i=a[s];if(!(i==="_owner"&&e.$$typeof)&&!bw(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function CU(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function AO(e,t){const r=CU(e);return Math.round(t*r)/r}function n3(e){const t=P.useRef(e);return Ob(()=>{t.current=e}),t}function Zoe(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:s=[],platform:a,elements:{reference:i,floating:o}={},transform:c=!0,whileElementsMounted:d,open:l}=e,[u,h]=P.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[f,m]=P.useState(s);bw(f,s)||m(s);const[p,g]=P.useState(null),[v,x]=P.useState(null),y=P.useCallback(C=>{C!==O.current&&(O.current=C,g(C))},[]),b=P.useCallback(C=>{C!==R.current&&(R.current=C,x(C))},[]),j=i||p,T=o||v,O=P.useRef(null),R=P.useRef(null),D=P.useRef(u),L=d!=null,q=n3(d),X=n3(a),H=n3(l),M=P.useCallback(()=>{if(!O.current||!R.current)return;const C={placement:t,strategy:r,middleware:f};X.current&&(C.platform=X.current),Koe(O.current,R.current,C).then(k=>{const I={...k,isPositioned:H.current!==!1};F.current&&!bw(D.current,I)&&(D.current=I,kf.flushSync(()=>{h(I)}))})},[f,t,r,X,H]);Ob(()=>{l===!1&&D.current.isPositioned&&(D.current.isPositioned=!1,h(C=>({...C,isPositioned:!1})))},[l]);const F=P.useRef(!1);Ob(()=>(F.current=!0,()=>{F.current=!1}),[]),Ob(()=>{if(j&&(O.current=j),T&&(R.current=T),j&&T){if(q.current)return q.current(j,T,M);M()}},[j,T,M,q,L]);const S=P.useMemo(()=>({reference:O,floating:R,setReference:y,setFloating:b}),[y,b]),E=P.useMemo(()=>({reference:j,floating:T}),[j,T]),N=P.useMemo(()=>{const C={position:r,left:0,top:0};if(!E.floating)return C;const k=AO(E.floating,u.x),I=AO(E.floating,u.y);return c?{...C,transform:"translate("+k+"px, "+I+"px)",...CU(E.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:k,top:I}},[r,c,E.floating,u.x,u.y]);return P.useMemo(()=>({...u,update:M,refs:S,elements:E,floatingStyles:N}),[u,M,S,E,N])}const Qoe=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:s,padding:a}=typeof e=="function"?e(r):e;return s&&t(s)?s.current!=null?kO({element:s.current,padding:a}).fn(r):{}:s?kO({element:s,padding:a}).fn(r):{}}}},Joe=(e,t)=>({...Uoe(e),options:[e,t]}),ele=(e,t)=>({...Voe(e),options:[e,t]}),tle=(e,t)=>({...Goe(e),options:[e,t]}),rle=(e,t)=>({...qoe(e),options:[e,t]}),nle=(e,t)=>({...Woe(e),options:[e,t]}),sle=(e,t)=>({...Hoe(e),options:[e,t]}),ale=(e,t)=>({...Qoe(e),options:[e,t]});var ile="Arrow",EU=P.forwardRef((e,t)=>{const{children:r,width:s=10,height:a=5,...i}=e;return n.jsx(er.svg,{...i,ref:t,width:s,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:n.jsx("polygon",{points:"0,0 30,0 15,10"})})});EU.displayName=ile;var ole=EU;function k_(e){const[t,r]=P.useState(void 0);return ya(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const s=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const i=a[0];let o,c;if("borderBoxSize"in i){const d=i.borderBoxSize,l=Array.isArray(d)?d[0]:d;o=l.inlineSize,c=l.blockSize}else o=e.offsetWidth,c=e.offsetHeight;r({width:o,height:c})});return s.observe(e,{box:"border-box"}),()=>s.unobserve(e)}else r(void 0)},[e]),t}var wk="Popper",[kU,Cc]=ta(wk),[lle,AU]=kU(wk),TU=e=>{const{__scopePopper:t,children:r}=e,[s,a]=P.useState(null);return n.jsx(lle,{scope:t,anchor:s,onAnchorChange:a,children:r})};TU.displayName=wk;var PU="PopperAnchor",OU=P.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:s,...a}=e,i=AU(PU,r),o=P.useRef(null),c=Ir(t,o);return P.useEffect(()=>{i.onAnchorChange((s==null?void 0:s.current)||o.current)}),s?null:n.jsx(er.div,{...a,ref:c})});OU.displayName=PU;var _k="PopperContent",[cle,dle]=kU(_k),RU=P.forwardRef((e,t)=>{var J,V,W,ee,ie,oe;const{__scopePopper:r,side:s="bottom",sideOffset:a=0,align:i="center",alignOffset:o=0,arrowPadding:c=0,avoidCollisions:d=!0,collisionBoundary:l=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:p,...g}=e,v=AU(_k,r),[x,y]=P.useState(null),b=Ir(t,se=>y(se)),[j,T]=P.useState(null),O=k_(j),R=(O==null?void 0:O.width)??0,D=(O==null?void 0:O.height)??0,L=s+(i!=="center"?"-"+i:""),q=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},X=Array.isArray(l)?l:[l],H=X.length>0,M={padding:q,boundary:X.filter(hle),altBoundary:H},{refs:F,floatingStyles:S,placement:E,isPositioned:N,middlewareData:C}=Zoe({strategy:"fixed",placement:L,whileElementsMounted:(...se)=>zoe(...se,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[Joe({mainAxis:a+D,alignmentAxis:o}),d&&ele({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?tle():void 0,...M}),d&&rle({...M}),nle({...M,apply:({elements:se,rects:le,availableWidth:ye,availableHeight:ue})=>{const{width:ne,height:pe}=le.reference,ge=se.floating.style;ge.setProperty("--radix-popper-available-width",`${ye}px`),ge.setProperty("--radix-popper-available-height",`${ue}px`),ge.setProperty("--radix-popper-anchor-width",`${ne}px`),ge.setProperty("--radix-popper-anchor-height",`${pe}px`)}}),j&&ale({element:j,padding:c}),fle({arrowWidth:R,arrowHeight:D}),f&&sle({strategy:"referenceHidden",...M})]}),[k,I]=DU(E),U=Ws(p);ya(()=>{N&&(U==null||U())},[N,U]);const $=(J=C.arrow)==null?void 0:J.x,Y=(V=C.arrow)==null?void 0:V.y,Z=((W=C.arrow)==null?void 0:W.centerOffset)!==0,[re,G]=P.useState();return ya(()=>{x&&G(window.getComputedStyle(x).zIndex)},[x]),n.jsx("div",{ref:F.setFloating,"data-radix-popper-content-wrapper":"",style:{...S,transform:N?S.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:re,"--radix-popper-transform-origin":[(ee=C.transformOrigin)==null?void 0:ee.x,(ie=C.transformOrigin)==null?void 0:ie.y].join(" "),...((oe=C.hide)==null?void 0:oe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:n.jsx(cle,{scope:r,placedSide:k,onArrowChange:T,arrowX:$,arrowY:Y,shouldHideArrow:Z,children:n.jsx(er.div,{"data-side":k,"data-align":I,...g,ref:b,style:{...g.style,animation:N?void 0:"none"}})})})});RU.displayName=_k;var MU="PopperArrow",ule={top:"bottom",right:"left",bottom:"top",left:"right"},IU=P.forwardRef(function(t,r){const{__scopePopper:s,...a}=t,i=dle(MU,s),o=ule[i.placedSide];return n.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:n.jsx(ole,{...a,ref:r,style:{...a.style,display:"block"}})})});IU.displayName=MU;function hle(e){return e!==null}var fle=e=>({name:"transformOrigin",options:e,fn(t){var v,x,y;const{placement:r,rects:s,middlewareData:a}=t,o=((v=a.arrow)==null?void 0:v.centerOffset)!==0,c=o?0:e.arrowWidth,d=o?0:e.arrowHeight,[l,u]=DU(r),h={start:"0%",center:"50%",end:"100%"}[u],f=(((x=a.arrow)==null?void 0:x.x)??0)+c/2,m=(((y=a.arrow)==null?void 0:y.y)??0)+d/2;let p="",g="";return l==="bottom"?(p=o?h:`${f}px`,g=`${-d}px`):l==="top"?(p=o?h:`${f}px`,g=`${s.floating.height+d}px`):l==="right"?(p=`${-d}px`,g=o?h:`${m}px`):l==="left"&&(p=`${s.floating.width+d}px`,g=o?h:`${m}px`),{data:{x:p,y:g}}}});function DU(e){const[t,r="center"]=e.split("-");return[t,r]}var p1=TU,yg=OU,g1=RU,x1=IU,[A_,set]=ta("Tooltip",[Cc]),T_=Cc(),LU="TooltipProvider",mle=700,nC="tooltip.open",[ple,jk]=A_(LU),BU=e=>{const{__scopeTooltip:t,delayDuration:r=mle,skipDelayDuration:s=300,disableHoverableContent:a=!1,children:i}=e,o=P.useRef(!0),c=P.useRef(!1),d=P.useRef(0);return P.useEffect(()=>{const l=d.current;return()=>window.clearTimeout(l)},[]),n.jsx(ple,{scope:t,isOpenDelayedRef:o,delayDuration:r,onOpen:P.useCallback(()=>{window.clearTimeout(d.current),o.current=!1},[]),onClose:P.useCallback(()=>{window.clearTimeout(d.current),d.current=window.setTimeout(()=>o.current=!0,s)},[s]),isPointerInTransitRef:c,onPointerInTransitChange:P.useCallback(l=>{c.current=l},[]),disableHoverableContent:a,children:i})};BU.displayName=LU;var Gx="Tooltip",[gle,P_]=A_(Gx),$U=e=>{const{__scopeTooltip:t,children:r,open:s,defaultOpen:a,onOpenChange:i,disableHoverableContent:o,delayDuration:c}=e,d=jk(Gx,e.__scopeTooltip),l=T_(t),[u,h]=P.useState(null),f=xa(),m=P.useRef(0),p=o??d.disableHoverableContent,g=c??d.delayDuration,v=P.useRef(!1),[x,y]=Yi({prop:s,defaultProp:a??!1,onChange:R=>{R?(d.onOpen(),document.dispatchEvent(new CustomEvent(nC))):d.onClose(),i==null||i(R)},caller:Gx}),b=P.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),j=P.useCallback(()=>{window.clearTimeout(m.current),m.current=0,v.current=!1,y(!0)},[y]),T=P.useCallback(()=>{window.clearTimeout(m.current),m.current=0,y(!1)},[y]),O=P.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{v.current=!0,y(!0),m.current=0},g)},[g,y]);return P.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),n.jsx(p1,{...l,children:n.jsx(gle,{scope:t,contentId:f,open:x,stateAttribute:b,trigger:u,onTriggerChange:h,onTriggerEnter:P.useCallback(()=>{d.isOpenDelayedRef.current?O():j()},[d.isOpenDelayedRef,O,j]),onTriggerLeave:P.useCallback(()=>{p?T():(window.clearTimeout(m.current),m.current=0)},[T,p]),onOpen:j,onClose:T,disableHoverableContent:p,children:r})})};$U.displayName=Gx;var sC="TooltipTrigger",FU=P.forwardRef((e,t)=>{const{__scopeTooltip:r,...s}=e,a=P_(sC,r),i=jk(sC,r),o=T_(r),c=P.useRef(null),d=Ir(t,c,a.onTriggerChange),l=P.useRef(!1),u=P.useRef(!1),h=P.useCallback(()=>l.current=!1,[]);return P.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),n.jsx(yg,{asChild:!0,...o,children:n.jsx(er.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...s,ref:d,onPointerMove:kt(e.onPointerMove,f=>{f.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),u.current=!0)}),onPointerLeave:kt(e.onPointerLeave,()=>{a.onTriggerLeave(),u.current=!1}),onPointerDown:kt(e.onPointerDown,()=>{a.open&&a.onClose(),l.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:kt(e.onFocus,()=>{l.current||a.onOpen()}),onBlur:kt(e.onBlur,a.onClose),onClick:kt(e.onClick,a.onClose)})})});FU.displayName=sC;var xle="TooltipPortal",[aet,vle]=A_(xle,{forceMount:void 0}),bp="TooltipContent",zU=P.forwardRef((e,t)=>{const r=vle(bp,e.__scopeTooltip),{forceMount:s=r.forceMount,side:a="top",...i}=e,o=P_(bp,e.__scopeTooltip);return n.jsx(Gs,{present:s||o.open,children:o.disableHoverableContent?n.jsx(UU,{side:a,...i,ref:t}):n.jsx(yle,{side:a,...i,ref:t})})}),yle=P.forwardRef((e,t)=>{const r=P_(bp,e.__scopeTooltip),s=jk(bp,e.__scopeTooltip),a=P.useRef(null),i=Ir(t,a),[o,c]=P.useState(null),{trigger:d,onClose:l}=r,u=a.current,{onPointerInTransitChange:h}=s,f=P.useCallback(()=>{c(null),h(!1)},[h]),m=P.useCallback((p,g)=>{const v=p.currentTarget,x={x:p.clientX,y:p.clientY},y=Nle(x,v.getBoundingClientRect()),b=Sle(x,y),j=Cle(g.getBoundingClientRect()),T=kle([...b,...j]);c(T),h(!0)},[h]);return P.useEffect(()=>()=>f(),[f]),P.useEffect(()=>{if(d&&u){const p=v=>m(v,u),g=v=>m(v,d);return d.addEventListener("pointerleave",p),u.addEventListener("pointerleave",g),()=>{d.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",g)}}},[d,u,m,f]),P.useEffect(()=>{if(o){const p=g=>{const v=g.target,x={x:g.clientX,y:g.clientY},y=(d==null?void 0:d.contains(v))||(u==null?void 0:u.contains(v)),b=!Ele(x,o);y?f():b&&(f(),l())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[d,u,o,l,f]),n.jsx(UU,{...e,ref:i})}),[ble,wle]=A_(Gx,{isInside:!1}),_le=pz("TooltipContent"),UU=P.forwardRef((e,t)=>{const{__scopeTooltip:r,children:s,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...c}=e,d=P_(bp,r),l=T_(r),{onClose:u}=d;return P.useEffect(()=>(document.addEventListener(nC,u),()=>document.removeEventListener(nC,u)),[u]),P.useEffect(()=>{if(d.trigger){const h=f=>{const m=f.target;m!=null&&m.contains(d.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[d.trigger,u]),n.jsx(Fu,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:n.jsxs(g1,{"data-state":d.stateAttribute,...l,...c,ref:t,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[n.jsx(_le,{children:s}),n.jsx(ble,{scope:r,isInside:!0,children:n.jsx(Mse,{id:d.contentId,role:"tooltip",children:a||s})})]})})});zU.displayName=bp;var VU="TooltipArrow",jle=P.forwardRef((e,t)=>{const{__scopeTooltip:r,...s}=e,a=T_(r);return wle(VU,r).isInside?null:n.jsx(x1,{...a,...s,ref:t})});jle.displayName=VU;function Nle(e,t){const r=Math.abs(t.top-e.y),s=Math.abs(t.bottom-e.y),a=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,s,a,i)){case i:return"left";case a:return"right";case r:return"top";case s:return"bottom";default:throw new Error("unreachable")}}function Sle(e,t,r=5){const s=[];switch(t){case"top":s.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":s.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":s.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":s.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r});break}return s}function Cle(e){const{top:t,right:r,bottom:s,left:a}=e;return[{x:a,y:t},{x:r,y:t},{x:r,y:s},{x:a,y:s}]}function Ele(e,t){const{x:r,y:s}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const c=t[i],d=t[o],l=c.x,u=c.y,h=d.x,f=d.y;u>s!=f>s&&r<(h-l)*(s-u)/(f-u)+l&&(a=!a)}return a}function kle(e){const t=e.slice();return t.sort((r,s)=>r.x<s.x?-1:r.x>s.x?1:r.y<s.y?-1:r.y>s.y?1:0),Ale(t)}function Ale(e){if(e.length<=1)return e.slice();const t=[];for(let s=0;s<e.length;s++){const a=e[s];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))t.pop();else break}t.push(a)}t.pop();const r=[];for(let s=e.length-1;s>=0;s--){const a=e[s];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))r.pop();else break}r.push(a)}return r.pop(),t.length===1&&r.length===1&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}var Tle=BU,Ple=$U,Ole=FU,qU=zU;const wp=Tle,Ga=Ple,Ka=Ole,Aa=P.forwardRef(({className:e,sideOffset:t=4,...r},s)=>n.jsx(qU,{ref:s,sideOffset:t,className:We("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r}));Aa.displayName=qU.displayName;var O_=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},R_=typeof window>"u"||"Deno"in globalThis;function gl(){}function Rle(e,t){return typeof e=="function"?e(t):e}function Mle(e){return typeof e=="number"&&e>=0&&e!==1/0}function Ile(e,t){return Math.max(e+(t||0)-Date.now(),0)}function aC(e,t){return typeof e=="function"?e(t):e}function Dle(e,t){return typeof e=="function"?e(t):e}function TO(e,t){const{type:r="all",exact:s,fetchStatus:a,predicate:i,queryKey:o,stale:c}=e;if(o){if(s){if(t.queryHash!==Nk(o,t.options))return!1}else if(!Xx(t.queryKey,o))return!1}if(r!=="all"){const d=t.isActive();if(r==="active"&&!d||r==="inactive"&&d)return!1}return!(typeof c=="boolean"&&t.isStale()!==c||a&&a!==t.state.fetchStatus||i&&!i(t))}function PO(e,t){const{exact:r,status:s,predicate:a,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(r){if(Kx(t.options.mutationKey)!==Kx(i))return!1}else if(!Xx(t.options.mutationKey,i))return!1}return!(s&&t.state.status!==s||a&&!a(t))}function Nk(e,t){return((t==null?void 0:t.queryKeyHashFn)||Kx)(e)}function Kx(e){return JSON.stringify(e,(t,r)=>iC(r)?Object.keys(r).sort().reduce((s,a)=>(s[a]=r[a],s),{}):r)}function Xx(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Xx(e[r],t[r])):!1}function WU(e,t){if(e===t)return e;const r=OO(e)&&OO(t);if(r||iC(e)&&iC(t)){const s=r?e:Object.keys(e),a=s.length,i=r?t:Object.keys(t),o=i.length,c=r?[]:{},d=new Set(s);let l=0;for(let u=0;u<o;u++){const h=r?u:i[u];(!r&&d.has(h)||r)&&e[h]===void 0&&t[h]===void 0?(c[h]=void 0,l++):(c[h]=WU(e[h],t[h]),c[h]===e[h]&&e[h]!==void 0&&l++)}return a===o&&l===a?e:c}return t}function OO(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function iC(e){if(!RO(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!RO(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function RO(e){return Object.prototype.toString.call(e)==="[object Object]"}function Lle(e){return new Promise(t=>{setTimeout(t,e)})}function Ble(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?WU(e,t):t}function $le(e,t,r=0){const s=[...e,t];return r&&s.length>r?s.slice(1):s}function Fle(e,t,r=0){const s=[t,...e];return r&&s.length>r?s.slice(0,-1):s}var Sk=Symbol();function HU(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Sk?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Bh,Qd,np,WB,zle=(WB=class extends O_{constructor(){super();kn(this,Bh);kn(this,Qd);kn(this,np);Gr(this,np,t=>{if(!R_&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){Nt(this,Qd)||this.setEventListener(Nt(this,np))}onUnsubscribe(){var t;this.hasListeners()||((t=Nt(this,Qd))==null||t.call(this),Gr(this,Qd,void 0))}setEventListener(t){var r;Gr(this,np,t),(r=Nt(this,Qd))==null||r.call(this),Gr(this,Qd,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){Nt(this,Bh)!==t&&(Gr(this,Bh,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof Nt(this,Bh)=="boolean"?Nt(this,Bh):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Bh=new WeakMap,Qd=new WeakMap,np=new WeakMap,WB),GU=new zle,sp,Jd,ap,HB,Ule=(HB=class extends O_{constructor(){super();kn(this,sp,!0);kn(this,Jd);kn(this,ap);Gr(this,ap,t=>{if(!R_&&window.addEventListener){const r=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",s)}}})}onSubscribe(){Nt(this,Jd)||this.setEventListener(Nt(this,ap))}onUnsubscribe(){var t;this.hasListeners()||((t=Nt(this,Jd))==null||t.call(this),Gr(this,Jd,void 0))}setEventListener(t){var r;Gr(this,ap,t),(r=Nt(this,Jd))==null||r.call(this),Gr(this,Jd,t(this.setOnline.bind(this)))}setOnline(t){Nt(this,sp)!==t&&(Gr(this,sp,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return Nt(this,sp)}},sp=new WeakMap,Jd=new WeakMap,ap=new WeakMap,HB),ww=new Ule;function Vle(){let e,t;const r=new Promise((a,i)=>{e=a,t=i});r.status="pending",r.catch(()=>{});function s(a){Object.assign(r,a),delete r.resolve,delete r.reject}return r.resolve=a=>{s({status:"fulfilled",value:a}),e(a)},r.reject=a=>{s({status:"rejected",reason:a}),t(a)},r}function qle(e){return Math.min(1e3*2**e,3e4)}function KU(e){return(e??"online")==="online"?ww.isOnline():!0}var XU=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function s3(e){return e instanceof XU}function YU(e){let t=!1,r=0,s=!1,a;const i=Vle(),o=g=>{var v;s||(f(new XU(g)),(v=e.abort)==null||v.call(e))},c=()=>{t=!0},d=()=>{t=!1},l=()=>GU.isFocused()&&(e.networkMode==="always"||ww.isOnline())&&e.canRun(),u=()=>KU(e.networkMode)&&e.canRun(),h=g=>{var v;s||(s=!0,(v=e.onSuccess)==null||v.call(e,g),a==null||a(),i.resolve(g))},f=g=>{var v;s||(s=!0,(v=e.onError)==null||v.call(e,g),a==null||a(),i.reject(g))},m=()=>new Promise(g=>{var v;a=x=>{(s||l())&&g(x)},(v=e.onPause)==null||v.call(e)}).then(()=>{var g;a=void 0,s||(g=e.onContinue)==null||g.call(e)}),p=()=>{if(s)return;let g;const v=r===0?e.initialPromise:void 0;try{g=v??e.fn()}catch(x){g=Promise.reject(x)}Promise.resolve(g).then(h).catch(x=>{var O;if(s)return;const y=e.retry??(R_?0:3),b=e.retryDelay??qle,j=typeof b=="function"?b(r,x):b,T=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,x);if(t||!T){f(x);return}r++,(O=e.onFail)==null||O.call(e,r,x),Lle(j).then(()=>l()?void 0:m()).then(()=>{t?f(x):p()})})};return{promise:i,cancel:o,continue:()=>(a==null||a(),i),cancelRetry:c,continueRetry:d,canStart:u,start:()=>(u()?p():m().then(p),i)}}var Wle=e=>setTimeout(e,0);function Hle(){let e=[],t=0,r=c=>{c()},s=c=>{c()},a=Wle;const i=c=>{t?e.push(c):a(()=>{r(c)})},o=()=>{const c=e;e=[],c.length&&a(()=>{s(()=>{c.forEach(d=>{r(d)})})})};return{batch:c=>{let d;t++;try{d=c()}finally{t--,t||o()}return d},batchCalls:c=>(...d)=>{i(()=>{c(...d)})},schedule:i,setNotifyFunction:c=>{r=c},setBatchNotifyFunction:c=>{s=c},setScheduler:c=>{a=c}}}var yi=Hle(),$h,GB,ZU=(GB=class{constructor(){kn(this,$h)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Mle(this.gcTime)&&Gr(this,$h,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(R_?1/0:5*60*1e3))}clearGcTimeout(){Nt(this,$h)&&(clearTimeout(Nt(this,$h)),Gr(this,$h,void 0))}},$h=new WeakMap,GB),ip,Fh,Do,zh,ni,s1,Uh,vl,Uc,KB,Gle=(KB=class extends ZU{constructor(t){super();kn(this,vl);kn(this,ip);kn(this,Fh);kn(this,Do);kn(this,zh);kn(this,ni);kn(this,s1);kn(this,Uh);Gr(this,Uh,!1),Gr(this,s1,t.defaultOptions),this.setOptions(t.options),this.observers=[],Gr(this,zh,t.client),Gr(this,Do,Nt(this,zh).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Gr(this,ip,Xle(this.options)),this.state=t.state??Nt(this,ip),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Nt(this,ni))==null?void 0:t.promise}setOptions(t){this.options={...Nt(this,s1),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Nt(this,Do).remove(this)}setData(t,r){const s=Ble(this.state.data,t,this.options);return ei(this,vl,Uc).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(t,r){ei(this,vl,Uc).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var s,a;const r=(s=Nt(this,ni))==null?void 0:s.promise;return(a=Nt(this,ni))==null||a.cancel(t),r?r.then(gl).catch(gl):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Nt(this,ip))}isActive(){return this.observers.some(t=>Dle(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Sk||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>aC(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Ile(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=Nt(this,ni))==null||r.continue()}onOnline(){var r;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=Nt(this,ni))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Nt(this,Do).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(Nt(this,ni)&&(Nt(this,Uh)?Nt(this,ni).cancel({revert:!0}):Nt(this,ni).cancelRetry()),this.scheduleGc()),Nt(this,Do).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ei(this,vl,Uc).call(this,{type:"invalidate"})}fetch(t,r){var l,u,h;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Nt(this,ni))return Nt(this,ni).continueRetry(),Nt(this,ni).promise}if(t&&this.setOptions(t),!this.options.queryFn){const f=this.observers.find(m=>m.options.queryFn);f&&this.setOptions(f.options)}const s=new AbortController,a=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>(Gr(this,Uh,!0),s.signal)})},i=()=>{const f=HU(this.options,r),p=(()=>{const g={client:Nt(this,zh),queryKey:this.queryKey,meta:this.meta};return a(g),g})();return Gr(this,Uh,!1),this.options.persister?this.options.persister(f,p,this):f(p)},c=(()=>{const f={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Nt(this,zh),state:this.state,fetchFn:i};return a(f),f})();(l=this.options.behavior)==null||l.onFetch(c,this),Gr(this,Fh,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=c.fetchOptions)==null?void 0:u.meta))&&ei(this,vl,Uc).call(this,{type:"fetch",meta:(h=c.fetchOptions)==null?void 0:h.meta});const d=f=>{var m,p,g,v;s3(f)&&f.silent||ei(this,vl,Uc).call(this,{type:"error",error:f}),s3(f)||((p=(m=Nt(this,Do).config).onError)==null||p.call(m,f,this),(v=(g=Nt(this,Do).config).onSettled)==null||v.call(g,this.state.data,f,this)),this.scheduleGc()};return Gr(this,ni,YU({initialPromise:r==null?void 0:r.initialPromise,fn:c.fetchFn,abort:s.abort.bind(s),onSuccess:f=>{var m,p,g,v;if(f===void 0){d(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(x){d(x);return}(p=(m=Nt(this,Do).config).onSuccess)==null||p.call(m,f,this),(v=(g=Nt(this,Do).config).onSettled)==null||v.call(g,f,this.state.error,this),this.scheduleGc()},onError:d,onFail:(f,m)=>{ei(this,vl,Uc).call(this,{type:"failed",failureCount:f,error:m})},onPause:()=>{ei(this,vl,Uc).call(this,{type:"pause"})},onContinue:()=>{ei(this,vl,Uc).call(this,{type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0})),Nt(this,ni).start()}},ip=new WeakMap,Fh=new WeakMap,Do=new WeakMap,zh=new WeakMap,ni=new WeakMap,s1=new WeakMap,Uh=new WeakMap,vl=new WeakSet,Uc=function(t){const r=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...Kle(s.data,this.options),fetchMeta:t.meta??null};case"success":return Gr(this,Fh,void 0),{...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return s3(a)&&a.revert&&Nt(this,Fh)?{...Nt(this,Fh),fetchStatus:"idle"}:{...s,error:a,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=r(this.state),yi.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),Nt(this,Do).notify({query:this,type:"updated",action:t})})},KB);function Kle(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:KU(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Xle(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,s=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var Xl,XB,Yle=(XB=class extends O_{constructor(t={}){super();kn(this,Xl);this.config=t,Gr(this,Xl,new Map)}build(t,r,s){const a=r.queryKey,i=r.queryHash??Nk(a,r);let o=this.get(i);return o||(o=new Gle({client:t,queryKey:a,queryHash:i,options:t.defaultQueryOptions(r),state:s,defaultOptions:t.getQueryDefaults(a)}),this.add(o)),o}add(t){Nt(this,Xl).has(t.queryHash)||(Nt(this,Xl).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=Nt(this,Xl).get(t.queryHash);r&&(t.destroy(),r===t&&Nt(this,Xl).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){yi.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Nt(this,Xl).get(t)}getAll(){return[...Nt(this,Xl).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(s=>TO(r,s))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(s=>TO(t,s)):r}notify(t){yi.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){yi.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){yi.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Xl=new WeakMap,XB),Yl,gi,Vh,Zl,$d,YB,Zle=(YB=class extends ZU{constructor(t){super();kn(this,Zl);kn(this,Yl);kn(this,gi);kn(this,Vh);this.mutationId=t.mutationId,Gr(this,gi,t.mutationCache),Gr(this,Yl,[]),this.state=t.state||Qle(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Nt(this,Yl).includes(t)||(Nt(this,Yl).push(t),this.clearGcTimeout(),Nt(this,gi).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Gr(this,Yl,Nt(this,Yl).filter(r=>r!==t)),this.scheduleGc(),Nt(this,gi).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Nt(this,Yl).length||(this.state.status==="pending"?this.scheduleGc():Nt(this,gi).remove(this))}continue(){var t;return((t=Nt(this,Vh))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,o,c,d,l,u,h,f,m,p,g,v,x,y,b,j,T,O,R,D;const r=()=>{ei(this,Zl,$d).call(this,{type:"continue"})};Gr(this,Vh,YU({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(L,q)=>{ei(this,Zl,$d).call(this,{type:"failed",failureCount:L,error:q})},onPause:()=>{ei(this,Zl,$d).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Nt(this,gi).canRun(this)}));const s=this.state.status==="pending",a=!Nt(this,Vh).canStart();try{if(s)r();else{ei(this,Zl,$d).call(this,{type:"pending",variables:t,isPaused:a}),await((o=(i=Nt(this,gi).config).onMutate)==null?void 0:o.call(i,t,this));const q=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t));q!==this.state.context&&ei(this,Zl,$d).call(this,{type:"pending",context:q,variables:t,isPaused:a})}const L=await Nt(this,Vh).start();return await((u=(l=Nt(this,gi).config).onSuccess)==null?void 0:u.call(l,L,t,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,L,t,this.state.context)),await((p=(m=Nt(this,gi).config).onSettled)==null?void 0:p.call(m,L,null,this.state.variables,this.state.context,this)),await((v=(g=this.options).onSettled)==null?void 0:v.call(g,L,null,t,this.state.context)),ei(this,Zl,$d).call(this,{type:"success",data:L}),L}catch(L){try{throw await((y=(x=Nt(this,gi).config).onError)==null?void 0:y.call(x,L,t,this.state.context,this)),await((j=(b=this.options).onError)==null?void 0:j.call(b,L,t,this.state.context)),await((O=(T=Nt(this,gi).config).onSettled)==null?void 0:O.call(T,void 0,L,this.state.variables,this.state.context,this)),await((D=(R=this.options).onSettled)==null?void 0:D.call(R,void 0,L,t,this.state.context)),L}finally{ei(this,Zl,$d).call(this,{type:"error",error:L})}}finally{Nt(this,gi).runNext(this)}}},Yl=new WeakMap,gi=new WeakMap,Vh=new WeakMap,Zl=new WeakSet,$d=function(t){const r=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),yi.batch(()=>{Nt(this,Yl).forEach(s=>{s.onMutationUpdate(t)}),Nt(this,gi).notify({mutation:this,type:"updated",action:t})})},YB);function Qle(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Kc,yl,a1,ZB,Jle=(ZB=class extends O_{constructor(t={}){super();kn(this,Kc);kn(this,yl);kn(this,a1);this.config=t,Gr(this,Kc,new Set),Gr(this,yl,new Map),Gr(this,a1,0)}build(t,r,s){const a=new Zle({mutationCache:this,mutationId:++ay(this,a1)._,options:t.defaultMutationOptions(r),state:s});return this.add(a),a}add(t){Nt(this,Kc).add(t);const r=Ey(t);if(typeof r=="string"){const s=Nt(this,yl).get(r);s?s.push(t):Nt(this,yl).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Nt(this,Kc).delete(t)){const r=Ey(t);if(typeof r=="string"){const s=Nt(this,yl).get(r);if(s)if(s.length>1){const a=s.indexOf(t);a!==-1&&s.splice(a,1)}else s[0]===t&&Nt(this,yl).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Ey(t);if(typeof r=="string"){const s=Nt(this,yl).get(r),a=s==null?void 0:s.find(i=>i.state.status==="pending");return!a||a===t}else return!0}runNext(t){var s;const r=Ey(t);if(typeof r=="string"){const a=(s=Nt(this,yl).get(r))==null?void 0:s.find(i=>i!==t&&i.state.isPaused);return(a==null?void 0:a.continue())??Promise.resolve()}else return Promise.resolve()}clear(){yi.batch(()=>{Nt(this,Kc).forEach(t=>{this.notify({type:"removed",mutation:t})}),Nt(this,Kc).clear(),Nt(this,yl).clear()})}getAll(){return Array.from(Nt(this,Kc))}find(t){const r={exact:!0,...t};return this.getAll().find(s=>PO(r,s))}findAll(t={}){return this.getAll().filter(r=>PO(t,r))}notify(t){yi.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return yi.batch(()=>Promise.all(t.map(r=>r.continue().catch(gl))))}},Kc=new WeakMap,yl=new WeakMap,a1=new WeakMap,ZB);function Ey(e){var t;return(t=e.options.scope)==null?void 0:t.id}function MO(e){return{onFetch:(t,r)=>{var u,h,f,m,p;const s=t.options,a=(f=(h=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((m=t.state.data)==null?void 0:m.pages)||[],o=((p=t.state.data)==null?void 0:p.pageParams)||[];let c={pages:[],pageParams:[]},d=0;const l=async()=>{let g=!1;const v=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},x=HU(t.options,t.fetchOptions),y=async(b,j,T)=>{if(g)return Promise.reject();if(j==null&&b.pages.length)return Promise.resolve(b);const R=(()=>{const X={client:t.client,queryKey:t.queryKey,pageParam:j,direction:T?"backward":"forward",meta:t.options.meta};return v(X),X})(),D=await x(R),{maxPages:L}=t.options,q=T?Fle:$le;return{pages:q(b.pages,D,L),pageParams:q(b.pageParams,j,L)}};if(a&&i.length){const b=a==="backward",j=b?ece:IO,T={pages:i,pageParams:o},O=j(s,T);c=await y(T,O,b)}else{const b=e??i.length;do{const j=d===0?o[0]??s.initialPageParam:IO(s,c);if(d>0&&j==null)break;c=await y(c,j),d++}while(d<b)}return c};t.options.persister?t.fetchFn=()=>{var g,v;return(v=(g=t.options).persister)==null?void 0:v.call(g,l,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=l}}}function IO(e,{pages:t,pageParams:r}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,r[s],r):void 0}function ece(e,{pages:t,pageParams:r}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,r[0],r):void 0}var Ds,eu,tu,op,lp,ru,cp,dp,QB,tce=(QB=class{constructor(e={}){kn(this,Ds);kn(this,eu);kn(this,tu);kn(this,op);kn(this,lp);kn(this,ru);kn(this,cp);kn(this,dp);Gr(this,Ds,e.queryCache||new Yle),Gr(this,eu,e.mutationCache||new Jle),Gr(this,tu,e.defaultOptions||{}),Gr(this,op,new Map),Gr(this,lp,new Map),Gr(this,ru,0)}mount(){ay(this,ru)._++,Nt(this,ru)===1&&(Gr(this,cp,GU.subscribe(async e=>{e&&(await this.resumePausedMutations(),Nt(this,Ds).onFocus())})),Gr(this,dp,ww.subscribe(async e=>{e&&(await this.resumePausedMutations(),Nt(this,Ds).onOnline())})))}unmount(){var e,t;ay(this,ru)._--,Nt(this,ru)===0&&((e=Nt(this,cp))==null||e.call(this),Gr(this,cp,void 0),(t=Nt(this,dp))==null||t.call(this),Gr(this,dp,void 0))}isFetching(e){return Nt(this,Ds).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Nt(this,eu).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Nt(this,Ds).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=Nt(this,Ds).build(this,t),s=r.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(aC(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return Nt(this,Ds).findAll(e).map(({queryKey:t,state:r})=>{const s=r.data;return[t,s]})}setQueryData(e,t,r){const s=this.defaultQueryOptions({queryKey:e}),a=Nt(this,Ds).get(s.queryHash),i=a==null?void 0:a.state.data,o=Rle(t,i);if(o!==void 0)return Nt(this,Ds).build(this,s).setData(o,{...r,manual:!0})}setQueriesData(e,t,r){return yi.batch(()=>Nt(this,Ds).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Nt(this,Ds).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=Nt(this,Ds);yi.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=Nt(this,Ds);return yi.batch(()=>(r.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},s=yi.batch(()=>Nt(this,Ds).findAll(e).map(a=>a.cancel(r)));return Promise.all(s).then(gl).catch(gl)}invalidateQueries(e,t={}){return yi.batch(()=>(Nt(this,Ds).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},s=yi.batch(()=>Nt(this,Ds).findAll(e).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let i=a.fetch(void 0,r);return r.throwOnError||(i=i.catch(gl)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(gl)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=Nt(this,Ds).build(this,t);return r.isStaleByTime(aC(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(gl).catch(gl)}fetchInfiniteQuery(e){return e.behavior=MO(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(gl).catch(gl)}ensureInfiniteQueryData(e){return e.behavior=MO(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return ww.isOnline()?Nt(this,eu).resumePausedMutations():Promise.resolve()}getQueryCache(){return Nt(this,Ds)}getMutationCache(){return Nt(this,eu)}getDefaultOptions(){return Nt(this,tu)}setDefaultOptions(e){Gr(this,tu,e)}setQueryDefaults(e,t){Nt(this,op).set(Kx(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Nt(this,op).values()],r={};return t.forEach(s=>{Xx(e,s.queryKey)&&Object.assign(r,s.defaultOptions)}),r}setMutationDefaults(e,t){Nt(this,lp).set(Kx(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Nt(this,lp).values()],r={};return t.forEach(s=>{Xx(e,s.mutationKey)&&Object.assign(r,s.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Nt(this,tu).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Nk(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Sk&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Nt(this,tu).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Nt(this,Ds).clear(),Nt(this,eu).clear()}},Ds=new WeakMap,eu=new WeakMap,tu=new WeakMap,op=new WeakMap,lp=new WeakMap,ru=new WeakMap,cp=new WeakMap,dp=new WeakMap,QB),rce=P.createContext(void 0),nce=({client:e,children:t})=>(P.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),n.jsx(rce.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yx(){return Yx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Yx.apply(this,arguments)}var au;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(au||(au={}));const DO="popstate";function sce(e){e===void 0&&(e={});function t(s,a){let{pathname:i,search:o,hash:c}=s.location;return oC("",{pathname:i,search:o,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(s,a){return typeof a=="string"?a:_w(a)}return ice(t,r,null,e)}function Hs(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function QU(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function ace(){return Math.random().toString(36).substr(2,8)}function LO(e,t){return{usr:e.state,key:e.key,idx:t}}function oC(e,t,r,s){return r===void 0&&(r=null),Yx({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?bg(t):t,{state:r,key:t&&t.key||s||ace()})}function _w(e){let{pathname:t="/",search:r="",hash:s=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),s&&s!=="#"&&(t+=s.charAt(0)==="#"?s:"#"+s),t}function bg(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let s=e.indexOf("?");s>=0&&(t.search=e.substr(s),e=e.substr(0,s)),e&&(t.pathname=e)}return t}function ice(e,t,r,s){s===void 0&&(s={});let{window:a=document.defaultView,v5Compat:i=!1}=s,o=a.history,c=au.Pop,d=null,l=u();l==null&&(l=0,o.replaceState(Yx({},o.state,{idx:l}),""));function u(){return(o.state||{idx:null}).idx}function h(){c=au.Pop;let v=u(),x=v==null?null:v-l;l=v,d&&d({action:c,location:g.location,delta:x})}function f(v,x){c=au.Push;let y=oC(g.location,v,x);l=u()+1;let b=LO(y,l),j=g.createHref(y);try{o.pushState(b,"",j)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;a.location.assign(j)}i&&d&&d({action:c,location:g.location,delta:1})}function m(v,x){c=au.Replace;let y=oC(g.location,v,x);l=u();let b=LO(y,l),j=g.createHref(y);o.replaceState(b,"",j),i&&d&&d({action:c,location:g.location,delta:0})}function p(v){let x=a.location.origin!=="null"?a.location.origin:a.location.href,y=typeof v=="string"?v:_w(v);return y=y.replace(/ $/,"%20"),Hs(x,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,x)}let g={get action(){return c},get location(){return e(a,o)},listen(v){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(DO,h),d=v,()=>{a.removeEventListener(DO,h),d=null}},createHref(v){return t(a,v)},createURL:p,encodeLocation(v){let x=p(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:m,go(v){return o.go(v)}};return g}var BO;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(BO||(BO={}));function oce(e,t,r){return r===void 0&&(r="/"),lce(e,t,r,!1)}function lce(e,t,r,s){let a=typeof t=="string"?bg(t):t,i=Ck(a.pathname||"/",r);if(i==null)return null;let o=JU(e);cce(o);let c=null;for(let d=0;c==null&&d<o.length;++d){let l=bce(i);c=vce(o[d],l,s)}return c}function JU(e,t,r,s){t===void 0&&(t=[]),r===void 0&&(r=[]),s===void 0&&(s="");let a=(i,o,c)=>{let d={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};d.relativePath.startsWith("/")&&(Hs(d.relativePath.startsWith(s),'Absolute route path "'+d.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),d.relativePath=d.relativePath.slice(s.length));let l=wu([s,d.relativePath]),u=r.concat(d);i.children&&i.children.length>0&&(Hs(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),JU(i.children,t,u,l)),!(i.path==null&&!i.index)&&t.push({path:l,score:gce(l,i.index),routesMeta:u})};return e.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))a(i,o);else for(let d of eV(i.path))a(i,o,d)}),t}function eV(e){let t=e.split("/");if(t.length===0)return[];let[r,...s]=t,a=r.endsWith("?"),i=r.replace(/\?$/,"");if(s.length===0)return a?[i,""]:[i];let o=eV(s.join("/")),c=[];return c.push(...o.map(d=>d===""?i:[i,d].join("/"))),a&&c.push(...o),c.map(d=>e.startsWith("/")&&d===""?"/":d)}function cce(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:xce(t.routesMeta.map(s=>s.childrenIndex),r.routesMeta.map(s=>s.childrenIndex)))}const dce=/^:[\w-]+$/,uce=3,hce=2,fce=1,mce=10,pce=-2,$O=e=>e==="*";function gce(e,t){let r=e.split("/"),s=r.length;return r.some($O)&&(s+=pce),t&&(s+=hce),r.filter(a=>!$O(a)).reduce((a,i)=>a+(dce.test(i)?uce:i===""?fce:mce),s)}function xce(e,t){return e.length===t.length&&e.slice(0,-1).every((s,a)=>s===t[a])?e[e.length-1]-t[t.length-1]:0}function vce(e,t,r){let{routesMeta:s}=e,a={},i="/",o=[];for(let c=0;c<s.length;++c){let d=s[c],l=c===s.length-1,u=i==="/"?t:t.slice(i.length)||"/",h=FO({path:d.relativePath,caseSensitive:d.caseSensitive,end:l},u),f=d.route;if(!h&&l&&r&&!s[s.length-1].route.index&&(h=FO({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},u)),!h)return null;Object.assign(a,h.params),o.push({params:a,pathname:wu([i,h.pathname]),pathnameBase:Nce(wu([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=wu([i,h.pathnameBase]))}return o}function FO(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,s]=yce(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:s.reduce((l,u,h)=>{let{paramName:f,isOptional:m}=u;if(f==="*"){let g=c[h]||"";o=i.slice(0,i.length-g.length).replace(/(.)\/+$/,"$1")}const p=c[h];return m&&!p?l[f]=void 0:l[f]=(p||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:o,pattern:e}}function yce(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),QU(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let s=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,d)=>(s.push({paramName:c,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(s.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),s]}function bce(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return QU(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Ck(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,s=e.charAt(r);return s&&s!=="/"?null:e.slice(r)||"/"}function wce(e,t){t===void 0&&(t="/");let{pathname:r,search:s="",hash:a=""}=typeof e=="string"?bg(e):e;return{pathname:r?r.startsWith("/")?r:_ce(r,t):t,search:Sce(s),hash:Cce(a)}}function _ce(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function a3(e,t,r,s){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function jce(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function Ek(e,t){let r=jce(e);return t?r.map((s,a)=>a===r.length-1?s.pathname:s.pathnameBase):r.map(s=>s.pathnameBase)}function kk(e,t,r,s){s===void 0&&(s=!1);let a;typeof e=="string"?a=bg(e):(a=Yx({},e),Hs(!a.pathname||!a.pathname.includes("?"),a3("?","pathname","search",a)),Hs(!a.pathname||!a.pathname.includes("#"),a3("#","pathname","hash",a)),Hs(!a.search||!a.search.includes("#"),a3("#","search","hash",a)));let i=e===""||a.pathname==="",o=i?"/":a.pathname,c;if(o==null)c=r;else{let h=t.length-1;if(!s&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;a.pathname=f.join("/")}c=h>=0?t[h]:"/"}let d=wce(a,c),l=o&&o!=="/"&&o.endsWith("/"),u=(i||o===".")&&r.endsWith("/");return!d.pathname.endsWith("/")&&(l||u)&&(d.pathname+="/"),d}const wu=e=>e.join("/").replace(/\/\/+/g,"/"),Nce=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Sce=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Cce=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Ece(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const tV=["post","put","patch","delete"];new Set(tV);const kce=["get",...tV];new Set(kce);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zx(){return Zx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Zx.apply(this,arguments)}const Ak=P.createContext(null),Ace=P.createContext(null),qu=P.createContext(null),M_=P.createContext(null),_d=P.createContext({outlet:null,matches:[],isDataRoute:!1}),rV=P.createContext(null);function Tce(e,t){let{relative:r}=t===void 0?{}:t;wg()||Hs(!1);let{basename:s,navigator:a}=P.useContext(qu),{hash:i,pathname:o,search:c}=sV(e,{relative:r}),d=o;return s!=="/"&&(d=o==="/"?s:wu([s,o])),a.createHref({pathname:d,search:c,hash:i})}function wg(){return P.useContext(M_)!=null}function Ec(){return wg()||Hs(!1),P.useContext(M_).location}function nV(e){P.useContext(qu).static||P.useLayoutEffect(e)}function fr(){let{isDataRoute:e}=P.useContext(_d);return e?Vce():Pce()}function Pce(){wg()||Hs(!1);let e=P.useContext(Ak),{basename:t,future:r,navigator:s}=P.useContext(qu),{matches:a}=P.useContext(_d),{pathname:i}=Ec(),o=JSON.stringify(Ek(a,r.v7_relativeSplatPath)),c=P.useRef(!1);return nV(()=>{c.current=!0}),P.useCallback(function(l,u){if(u===void 0&&(u={}),!c.current)return;if(typeof l=="number"){s.go(l);return}let h=kk(l,JSON.parse(o),i,u.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:wu([t,h.pathname])),(u.replace?s.replace:s.push)(h,u.state,u)},[t,s,o,i,e])}function ra(){let{matches:e}=P.useContext(_d),t=e[e.length-1];return t?t.params:{}}function sV(e,t){let{relative:r}=t===void 0?{}:t,{future:s}=P.useContext(qu),{matches:a}=P.useContext(_d),{pathname:i}=Ec(),o=JSON.stringify(Ek(a,s.v7_relativeSplatPath));return P.useMemo(()=>kk(e,JSON.parse(o),i,r==="path"),[e,o,i,r])}function Oce(e,t){return Rce(e,t)}function Rce(e,t,r,s){wg()||Hs(!1);let{navigator:a}=P.useContext(qu),{matches:i}=P.useContext(_d),o=i[i.length-1],c=o?o.params:{};o&&o.pathname;let d=o?o.pathnameBase:"/";o&&o.route;let l=Ec(),u;if(t){var h;let v=typeof t=="string"?bg(t):t;d==="/"||(h=v.pathname)!=null&&h.startsWith(d)||Hs(!1),u=v}else u=l;let f=u.pathname||"/",m=f;if(d!=="/"){let v=d.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let p=oce(e,{pathname:m}),g=Bce(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},c,v.params),pathname:wu([d,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?d:wu([d,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,r,s);return t&&g?P.createElement(M_.Provider,{value:{location:Zx({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:au.Pop}},g):g}function Mce(){let e=Uce(),t=Ece(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},t),r?P.createElement("pre",{style:a},r):null,null)}const Ice=P.createElement(Mce,null);class Dce extends P.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?P.createElement(_d.Provider,{value:this.props.routeContext},P.createElement(rV.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Lce(e){let{routeContext:t,match:r,children:s}=e,a=P.useContext(Ak);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),P.createElement(_d.Provider,{value:t},s)}function Bce(e,t,r,s){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),s===void 0&&(s=null),e==null){var i;if(!r)return null;if(r.errors)e=r.matches;else if((i=s)!=null&&i.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,c=(a=r)==null?void 0:a.errors;if(c!=null){let u=o.findIndex(h=>h.route.id&&(c==null?void 0:c[h.route.id])!==void 0);u>=0||Hs(!1),o=o.slice(0,Math.min(o.length,u+1))}let d=!1,l=-1;if(r&&s&&s.v7_partialHydration)for(let u=0;u<o.length;u++){let h=o[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(l=u),h.route.id){let{loaderData:f,errors:m}=r,p=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||p){d=!0,l>=0?o=o.slice(0,l+1):o=[o[0]];break}}}return o.reduceRight((u,h,f)=>{let m,p=!1,g=null,v=null;r&&(m=c&&h.route.id?c[h.route.id]:void 0,g=h.route.errorElement||Ice,d&&(l<0&&f===0?(p=!0,v=null):l===f&&(p=!0,v=h.route.hydrateFallbackElement||null)));let x=t.concat(o.slice(0,f+1)),y=()=>{let b;return m?b=g:p?b=v:h.route.Component?b=P.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=u,P.createElement(Lce,{match:h,routeContext:{outlet:u,matches:x,isDataRoute:r!=null},children:b})};return r&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?P.createElement(Dce,{location:r.location,revalidation:r.revalidation,component:g,error:m,children:y(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):y()},null)}var aV=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(aV||{}),jw=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(jw||{});function $ce(e){let t=P.useContext(Ak);return t||Hs(!1),t}function Fce(e){let t=P.useContext(Ace);return t||Hs(!1),t}function zce(e){let t=P.useContext(_d);return t||Hs(!1),t}function iV(e){let t=zce(),r=t.matches[t.matches.length-1];return r.route.id||Hs(!1),r.route.id}function Uce(){var e;let t=P.useContext(rV),r=Fce(jw.UseRouteError),s=iV(jw.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[s]}function Vce(){let{router:e}=$ce(aV.UseNavigateStable),t=iV(jw.UseNavigateStable),r=P.useRef(!1);return nV(()=>{r.current=!0}),P.useCallback(function(a,i){i===void 0&&(i={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Zx({fromRouteId:t},i)))},[e,t])}function qce(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function zO(e){let{to:t,replace:r,state:s,relative:a}=e;wg()||Hs(!1);let{future:i,static:o}=P.useContext(qu),{matches:c}=P.useContext(_d),{pathname:d}=Ec(),l=fr(),u=kk(t,Ek(c,i.v7_relativeSplatPath),d,a==="path"),h=JSON.stringify(u);return P.useEffect(()=>l(JSON.parse(h),{replace:r,state:s,relative:a}),[l,h,a,r,s]),null}function Tr(e){Hs(!1)}function Wce(e){let{basename:t="/",children:r=null,location:s,navigationType:a=au.Pop,navigator:i,static:o=!1,future:c}=e;wg()&&Hs(!1);let d=t.replace(/^\/*/,"/"),l=P.useMemo(()=>({basename:d,navigator:i,static:o,future:Zx({v7_relativeSplatPath:!1},c)}),[d,c,i,o]);typeof s=="string"&&(s=bg(s));let{pathname:u="/",search:h="",hash:f="",state:m=null,key:p="default"}=s,g=P.useMemo(()=>{let v=Ck(u,d);return v==null?null:{location:{pathname:v,search:h,hash:f,state:m,key:p},navigationType:a}},[d,u,h,f,m,p,a]);return g==null?null:P.createElement(qu.Provider,{value:l},P.createElement(M_.Provider,{children:r,value:g}))}function Hce(e){let{children:t,location:r}=e;return Oce(lC(t),r)}new Promise(()=>{});function lC(e,t){t===void 0&&(t=[]);let r=[];return P.Children.forEach(e,(s,a)=>{if(!P.isValidElement(s))return;let i=[...t,a];if(s.type===P.Fragment){r.push.apply(r,lC(s.props.children,i));return}s.type!==Tr&&Hs(!1),!s.props.index||!s.props.children||Hs(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=lC(s.props.children,i)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function cC(){return cC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},cC.apply(this,arguments)}function Gce(e,t){if(e==null)return{};var r={},s=Object.keys(e),a,i;for(i=0;i<s.length;i++)a=s[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function Kce(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Xce(e,t){return e.button===0&&(!t||t==="_self")&&!Kce(e)}function dC(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let s=e[r];return t.concat(Array.isArray(s)?s.map(a=>[r,a]):[[r,s]])},[]))}function Yce(e,t){let r=dC(e);return t&&t.forEach((s,a)=>{r.has(a)||t.getAll(a).forEach(i=>{r.append(a,i)})}),r}const Zce=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Qce="6";try{window.__reactRouterVersion=Qce}catch{}const Jce="startTransition",UO=l6[Jce];function ede(e){let{basename:t,children:r,future:s,window:a}=e,i=P.useRef();i.current==null&&(i.current=sce({window:a,v5Compat:!0}));let o=i.current,[c,d]=P.useState({action:o.action,location:o.location}),{v7_startTransition:l}=s||{},u=P.useCallback(h=>{l&&UO?UO(()=>d(h)):d(h)},[d,l]);return P.useLayoutEffect(()=>o.listen(u),[o,u]),P.useEffect(()=>qce(s),[s]),P.createElement(Wce,{basename:t,children:r,location:c.location,navigationType:c.action,navigator:o,future:s})}const tde=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",rde=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gt=P.forwardRef(function(t,r){let{onClick:s,relative:a,reloadDocument:i,replace:o,state:c,target:d,to:l,preventScrollReset:u,viewTransition:h}=t,f=Gce(t,Zce),{basename:m}=P.useContext(qu),p,g=!1;if(typeof l=="string"&&rde.test(l)&&(p=l,tde))try{let b=new URL(window.location.href),j=l.startsWith("//")?new URL(b.protocol+l):new URL(l),T=Ck(j.pathname,m);j.origin===b.origin&&T!=null?l=T+j.search+j.hash:g=!0}catch{}let v=Tce(l,{relative:a}),x=nde(l,{replace:o,state:c,target:d,preventScrollReset:u,relative:a,viewTransition:h});function y(b){s&&s(b),b.defaultPrevented||x(b)}return P.createElement("a",cC({},f,{href:p||v,onClick:g||i?s:y,ref:r,target:d}))});var VO;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(VO||(VO={}));var qO;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(qO||(qO={}));function nde(e,t){let{target:r,replace:s,state:a,preventScrollReset:i,relative:o,viewTransition:c}=t===void 0?{}:t,d=fr(),l=Ec(),u=sV(e,{relative:o});return P.useCallback(h=>{if(Xce(h,r)){h.preventDefault();let f=s!==void 0?s:_w(l)===_w(u);d(e,{replace:f,state:a,preventScrollReset:i,relative:o,viewTransition:c})}},[l,d,u,s,a,r,e,i,o,c])}function kc(e){let t=P.useRef(dC(e)),r=P.useRef(!1),s=Ec(),a=P.useMemo(()=>Yce(s.search,r.current?null:t.current),[s.search]),i=fr(),o=P.useCallback((c,d)=>{const l=dC(typeof c=="function"?c(a):c);r.current=!0,i("?"+l,d)},[i,a]);return[a,o]}var Jl=function(){return Jl=Object.assign||function(t){for(var r,s=1,a=arguments.length;s<a;s++){r=arguments[s];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},Jl.apply(this,arguments)};function _g(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r}function sde(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{l(s.next(u))}catch(h){o(h)}}function d(u){try{l(s.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):a(u.value).then(c,d)}l((s=s.apply(e,t||[])).next())})}function ade(e,t,r){if(r||arguments.length===2)for(var s=0,a=t.length,i;s<a;s++)(i||!(s in t))&&(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}const ide=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class Tk extends Error{constructor(t,r="FunctionsError",s){super(t),this.name=r,this.context=s}}class ode extends Tk{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class WO extends Tk{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class HO extends Tk{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var uC;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(uC||(uC={}));class lde{constructor(t,{headers:r={},customFetch:s,region:a=uC.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=ide(s)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return sde(this,arguments,void 0,function*(r,s={}){var a;let i,o;try{const{headers:c,method:d,body:l,signal:u,timeout:h}=s;let f={},{region:m}=s;m||(m=this.region);const p=new URL(`${this.url}/${r}`);m&&m!=="any"&&(f["x-region"]=m,p.searchParams.set("forceFunctionRegion",m));let g;l&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",g=l):typeof l=="string"?(f["Content-Type"]="text/plain",g=l):typeof FormData<"u"&&l instanceof FormData?g=l:(f["Content-Type"]="application/json",g=JSON.stringify(l)):l&&typeof l!="string"&&!(typeof Blob<"u"&&l instanceof Blob)&&!(l instanceof ArrayBuffer)&&!(typeof FormData<"u"&&l instanceof FormData)?g=JSON.stringify(l):g=l;let v=u;h&&(o=new AbortController,i=setTimeout(()=>o.abort(),h),u?(v=o.signal,u.addEventListener("abort",()=>o.abort())):v=o.signal);const x=yield this.fetch(p.toString(),{method:d||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),c),body:g,signal:v}).catch(T=>{throw new ode(T)}),y=x.headers.get("x-relay-error");if(y&&y==="true")throw new WO(x);if(!x.ok)throw new HO(x);let b=((a=x.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),j;return b==="application/json"?j=yield x.json():b==="application/octet-stream"||b==="application/pdf"?j=yield x.blob():b==="text/event-stream"?j=x:b==="multipart/form-data"?j=yield x.formData():j=yield x.text(),{data:j,error:null,response:x}}catch(c){return{data:null,error:c,response:c instanceof HO||c instanceof WO?c.context:void 0}}finally{i&&clearTimeout(i)}})}}var cde=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},dde=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const s=this.fetch;let a=s(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let o=null,c=null,d=null,l=i.status,u=i.statusText;if(i.ok){var h,f;if(r.method!=="HEAD"){var m;const x=await i.text();x===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((m=r.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?c=x:c=JSON.parse(x))}const g=(h=r.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),v=(f=i.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");g&&v&&v.length>1&&(d=parseInt(v[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(c)&&(c.length>1?(o={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,l=406,u="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var p;const g=await i.text();try{o=JSON.parse(g),Array.isArray(o)&&i.status===404&&(c=[],o=null,l=200,u="OK")}catch{i.status===404&&g===""?(l=204,u="No Content"):o={message:g}}if(o&&r.isMaybeSingle&&(!(o==null||(p=o.details)===null||p===void 0)&&p.includes("0 rows"))&&(o=null,l=200,u="OK"),o&&r.shouldThrowOnError)throw new cde(o)}return{error:o,data:c,count:d,status:l,statusText:u}});return this.shouldThrowOnError||(a=a.catch(i=>{var o;let c="";const d=i==null?void 0:i.cause;if(d){var l,u,h,f;const p=(l=d==null?void 0:d.message)!==null&&l!==void 0?l:"",g=(u=d==null?void 0:d.code)!==null&&u!==void 0?u:"";c=`${(h=i==null?void 0:i.name)!==null&&h!==void 0?h:"FetchError"}: ${i==null?void 0:i.message}`,c+=`

Caused by: ${(f=d==null?void 0:d.name)!==null&&f!==void 0?f:"Error"}: ${p}`,g&&(c+=` (${g})`),d!=null&&d.stack&&(c+=`
${d.stack}`)}else{var m;c=(m=i==null?void 0:i.stack)!==null&&m!==void 0?m:""}return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},ude=class extends dde{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:a=s}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){const a=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:a=!1,format:i="text"}={}){var o;const c=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),d=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${d}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const GO=new RegExp("[,()]");var cm=class extends ude{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&GO.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(s=>typeof s=="string"&&GO.test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},hde=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:s}=t??{},a=r?"HEAD":"GET";let i=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join(""),{url:c,headers:d}=this.cloneRequestState();return c.searchParams.set("select",o),s&&d.append("Prefer",`count=${s}`),new cm({method:a,url:c,headers:d,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;const a="POST",{url:i,headers:o}=this.cloneRequestState();if(t&&o.append("Prefer",`count=${t}`),r||o.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((d,l)=>d.concat(Object.keys(l)),[]);if(c.length>0){const d=[...new Set(c)].map(l=>`"${l}"`);i.searchParams.set("columns",d.join(","))}}return new cm({method:a,url:i,headers:o,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:a=!0}={}){var i;const o="POST",{url:c,headers:d}=this.cloneRequestState();if(d.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&c.searchParams.set("on_conflict",t),s&&d.append("Prefer",`count=${s}`),a||d.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(l.length>0){const u=[...new Set(l)].map(h=>`"${h}"`);c.searchParams.set("columns",u.join(","))}}return new cm({method:o,url:c,headers:d,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:t}={}){var r;const s="PATCH",{url:a,headers:i}=this.cloneRequestState();return t&&i.append("Prefer",`count=${t}`),new cm({method:s,url:a,headers:i,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:s,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new cm({method:r,url:s,headers:a,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},fde=class oV{constructor(t,{headers:r={},schema:s,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=s,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new hde(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new oV(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:s=!1,get:a=!1,count:i}={}){var o;let c;const d=new URL(`${this.url}/rpc/${t}`);let l;const u=m=>m!==null&&typeof m=="object"&&(!Array.isArray(m)||m.some(u)),h=s&&Object.values(r).some(u);h?(c="POST",l=r):s||a?(c=s?"HEAD":"GET",Object.entries(r).filter(([m,p])=>p!==void 0).map(([m,p])=>[m,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([m,p])=>{d.searchParams.append(m,p)})):(c="POST",l=r);const f=new Headers(this.headers);return h?f.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&f.set("Prefer",`count=${i}`),new cm({method:c,url:d,headers:f,schema:this.schemaName,body:l,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};class mde{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const s=r.versions;if(s&&s.node){const a=s.node,i=parseInt(a.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const s=this.getWebSocketConstructor();return new s(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const pde="2.91.0",gde=`realtime-js/${pde}`,xde="1.0.0",lV="2.0.0",KO=lV,hC=1e4,vde=1e3,yde=100;var Wd;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Wd||(Wd={}));var ia;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ia||(ia={}));var wl;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(wl||(wl={}));var fC;(function(e){e.websocket="websocket"})(fC||(fC={}));var Nh;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Nh||(Nh={}));class bde{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let s=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(s))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,s;const a=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,s;const a=(s=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&s!==void 0?s:{},o=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,s){var a,i;const o=t.topic,c=(a=t.ref)!==null&&a!==void 0?a:"",d=(i=t.join_ref)!==null&&i!==void 0?i:"",l=t.payload.event,u=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},h=Object.keys(u).length===0?"":JSON.stringify(u);if(d.length>255)throw new Error(`joinRef length ${d.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`userEvent length ${l.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const f=this.USER_BROADCAST_PUSH_META_LENGTH+d.length+c.length+o.length+l.length+h.length,m=new ArrayBuffer(this.HEADER_LENGTH+f);let p=new DataView(m),g=0;p.setUint8(g++,this.KINDS.userBroadcastPush),p.setUint8(g++,d.length),p.setUint8(g++,c.length),p.setUint8(g++,o.length),p.setUint8(g++,l.length),p.setUint8(g++,h.length),p.setUint8(g++,r),Array.from(d,x=>p.setUint8(g++,x.charCodeAt(0))),Array.from(c,x=>p.setUint8(g++,x.charCodeAt(0))),Array.from(o,x=>p.setUint8(g++,x.charCodeAt(0))),Array.from(l,x=>p.setUint8(g++,x.charCodeAt(0))),Array.from(h,x=>p.setUint8(g++,x.charCodeAt(0)));var v=new Uint8Array(m.byteLength+s.byteLength);return v.set(new Uint8Array(m),0),v.set(new Uint8Array(s),m.byteLength),v.buffer}decode(t,r){if(this._isArrayBuffer(t)){let s=this._binaryDecode(t);return r(s)}if(typeof t=="string"){const s=JSON.parse(t),[a,i,o,c,d]=s;return r({join_ref:a,ref:i,topic:o,event:c,payload:d})}return r({})}_binaryDecode(t){const r=new DataView(t),s=r.getUint8(0),a=new TextDecoder;switch(s){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,s){const a=r.getUint8(1),i=r.getUint8(2),o=r.getUint8(3),c=r.getUint8(4);let d=this.HEADER_LENGTH+4;const l=s.decode(t.slice(d,d+a));d=d+a;const u=s.decode(t.slice(d,d+i));d=d+i;const h=s.decode(t.slice(d,d+o));d=d+o;const f=t.slice(d,t.byteLength),m=c===this.JSON_ENCODING?JSON.parse(s.decode(f)):f,p={type:this.BROADCAST_EVENT,event:u,payload:m};return o>0&&(p.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([s])=>r.includes(s)))}}class cV{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Jn;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Jn||(Jn={}));const XO=(e,t,r={})=>{var s;const a=(s=r.skipTypes)!==null&&s!==void 0?s:[];return t?Object.keys(t).reduce((i,o)=>(i[o]=wde(o,e,t,a),i),{}):{}},wde=(e,t,r,s)=>{const a=t.find(c=>c.name===e),i=a==null?void 0:a.type,o=r[e];return i&&!s.includes(i)?dV(i,o):mC(o)},dV=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return Sde(t,r)}switch(e){case Jn.bool:return _de(t);case Jn.float4:case Jn.float8:case Jn.int2:case Jn.int4:case Jn.int8:case Jn.numeric:case Jn.oid:return jde(t);case Jn.json:case Jn.jsonb:return Nde(t);case Jn.timestamp:return Cde(t);case Jn.abstime:case Jn.date:case Jn.daterange:case Jn.int4range:case Jn.int8range:case Jn.money:case Jn.reltime:case Jn.text:case Jn.time:case Jn.timestamptz:case Jn.timetz:case Jn.tsrange:case Jn.tstzrange:return mC(t);default:return mC(t)}},mC=e=>e,_de=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},jde=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Nde=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},Sde=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,s=e[r];if(e[0]==="{"&&s==="}"){let i;const o=e.slice(1,r);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(c=>dV(t,c))}return e},Cde=e=>typeof e=="string"?e.replace(" ","T"):e,uV=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class i3{constructor(t,r,s={},a=hC){this.channel=t,this.event=r,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var s;return this._hasReceived(t)&&r((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(s=>s.status===t).forEach(s=>s.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var YO;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(YO||(YO={}));class dx{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},a=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=dx.syncState(this.state,a,i,o),this.pendingDiffs.forEach(d=>{this.state=dx.syncDiff(this.state,d,i,o)}),this.pendingDiffs=[],c()}),this.channel._on(s.diff,{},a=>{const{onJoin:i,onLeave:o,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=dx.syncDiff(this.state,a,i,o),c())}),this.onJoin((a,i,o)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:o})}),this.onLeave((a,i,o)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,s,a){const i=this.cloneDeep(t),o=this.transformState(r),c={},d={};return this.map(i,(l,u)=>{o[l]||(d[l]=u)}),this.map(o,(l,u)=>{const h=i[l];if(h){const f=u.map(v=>v.presence_ref),m=h.map(v=>v.presence_ref),p=u.filter(v=>m.indexOf(v.presence_ref)<0),g=h.filter(v=>f.indexOf(v.presence_ref)<0);p.length>0&&(c[l]=p),g.length>0&&(d[l]=g)}else c[l]=u}),this.syncDiff(i,{joins:c,leaves:d},s,a)}static syncDiff(t,r,s,a){const{joins:i,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return s||(s=()=>{}),a||(a=()=>{}),this.map(i,(c,d)=>{var l;const u=(l=t[c])!==null&&l!==void 0?l:[];if(t[c]=this.cloneDeep(d),u.length>0){const h=t[c].map(m=>m.presence_ref),f=u.filter(m=>h.indexOf(m.presence_ref)<0);t[c].unshift(...f)}s(c,u,d)}),this.map(o,(c,d)=>{let l=t[c];if(!l)return;const u=d.map(h=>h.presence_ref);l=l.filter(h=>u.indexOf(h.presence_ref)<0),t[c]=l,a(c,l,d),l.length===0&&delete t[c]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(s=>r(s,t[s]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,s)=>{const a=t[s];return"metas"in a?r[s]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[s]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ZO;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(ZO||(ZO={}));var ux;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(ux||(ux={}));var Wc;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Wc||(Wc={}));class Em{constructor(t,r={config:{}},s){var a,i;if(this.topic=t,this.params=r,this.socket=s,this.bindings={},this.state=ia.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new i3(this,wl.join,this.params,this.timeout),this.rejoinTimer=new cV(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ia.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ia.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ia.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ia.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ia.errored,this.rejoinTimer.scheduleTimeout())}),this._on(wl.reply,{},(o,c)=>{this._trigger(this._replyEventName(c),o)}),this.presence=new dx(this),this.broadcastEndpointURL=uV(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var s,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==ia.closed){const{config:{broadcast:o,presence:c,private:d}}=this.params,l=(a=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(m=>m.filter))!==null&&a!==void 0?a:[],u=!!this.bindings[ux.PRESENCE]&&this.bindings[ux.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},f={broadcast:o,presence:Object.assign(Object.assign({},c),{enabled:u}),postgres_changes:l,private:d};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(Wc.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(Wc.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var p;if(this.socket._isManualToken()||this.socket.setAuth(),m===void 0){t==null||t(Wc.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,v=(p=g==null?void 0:g.length)!==null&&p!==void 0?p:0,x=[];for(let y=0;y<v;y++){const b=g[y],{filter:{event:j,schema:T,table:O,filter:R}}=b,D=m&&m[y];if(D&&D.event===j&&Em.isFilterValueEqual(D.schema,T)&&Em.isFilterValueEqual(D.table,O)&&Em.isFilterValueEqual(D.filter,R))x.push(Object.assign(Object.assign({},b),{id:D.id}));else{this.unsubscribe(),this.state=ia.errored,t==null||t(Wc.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=x,t&&t(Wc.SUBSCRIBED);return}}).receive("error",m=>{this.state=ia.errored,t==null||t(Wc.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Wc.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,s){return this.state===ia.joined&&t===ux.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,s)}async httpSend(t,r,s={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(a=s.timeout)!==null&&a!==void 0?a:this.timeout);if(c.status===202)return{success:!0};let d=c.statusText;try{const l=await c.json();d=l.error||l.message||d}catch{}return Promise.reject(new Error(d))}async send(t,r={}){var s,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=t,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const d={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,d,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);return await((a=l.body)===null||a===void 0?void 0:a.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,c,d;const l=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((d=(c=(o=this.params)===null||o===void 0?void 0:o.config)===null||c===void 0?void 0:c.broadcast)===null||d===void 0)&&d.ack)&&i("ok"),l.receive("ok",()=>i("ok")),l.receive("error",()=>i("error")),l.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ia.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(wl.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(a=>{s=new i3(this,wl.leave,{},t),s.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ia.closed,this.bindings={}}async _fetchWithTimeout(t,r,s){const a=new AbortController,i=setTimeout(()=>a.abort(),s),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),o}_push(t,r,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new i3(this,t,r,s);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>yde){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,s){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,s){var a,i;const o=t.toLocaleLowerCase(),{close:c,error:d,leave:l,join:u}=wl;if(s&&[c,d,l,u].indexOf(o)>=0&&s!==this._joinRef())return;let f=this._onMessage(o,r,s);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(m=>{var p,g,v;return((p=m.filter)===null||p===void 0?void 0:p.event)==="*"||((v=(g=m.filter)===null||g===void 0?void 0:g.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(m=>m.callback(f,s)):(i=this.bindings[o])===null||i===void 0||i.filter(m=>{var p,g,v,x,y,b,j,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const O=m.id,R=(p=m.filter)===null||p===void 0?void 0:p.event;return O&&((g=r.ids)===null||g===void 0?void 0:g.includes(O))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((v=r.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))&&(!(!((x=m.filter)===null||x===void 0)&&x.table)||m.filter.table===((y=r.data)===null||y===void 0?void 0:y.table))}else{const O=(j=(b=m==null?void 0:m.filter)===null||b===void 0?void 0:b.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return O==="*"||O===((T=r==null?void 0:r.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof f=="object"&&"ids"in f){const p=f.data,{schema:g,table:v,commit_timestamp:x,type:y,errors:b}=p;f=Object.assign(Object.assign({},{schema:g,table:v,commit_timestamp:x,eventType:y,new:{},old:{},errors:b}),this._getPayloadRecords(p))}m.callback(f,s)})}_isClosed(){return this.state===ia.closed}_isJoined(){return this.state===ia.joined}_isJoining(){return this.state===ia.joining}_isLeaving(){return this.state===ia.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,s){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:s};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const s=t.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&Em.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const s in t)if(t[s]!==r[s])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(wl.close,{},t)}_onError(t){this._on(wl.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ia.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=XO(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=XO(t.columns,t.old_record)),r}}const o3=()=>{},ky={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ede=[1e3,2e3,5e3,1e4],kde=1e4,Ade=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Tde{constructor(t,r){var s;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=hC,this.transport=null,this.heartbeatIntervalMs=ky.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=o3,this.ref=0,this.reconnectTimer=null,this.vsn=KO,this.logger=o3,this.conn=null,this.sendBuffer=[],this.serializer=new bde,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((s=r==null?void 0:r.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${fC.websocket}`,this.httpEndpoint=uV(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=mde.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,s){this.logger(t,r,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Wd.connecting:return Nh.Connecting;case Wd.open:return Nh.Open;case Wd.closing:return Nh.Closing;default:return Nh.Closed}}isConnected(){return this.connectionState()===Nh.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const s=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===s);if(a)return a;{const i=new Em(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:s,payload:a,ref:i}=t,o=()=>{this.encode(t,c=>{var d;(d=this.conn)===null||d===void 0||d.send(c)})};this.log("push",`${r} ${s} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(vde,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},ky.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(s=>s.topic===t&&(s._isJoined()||s._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const l=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",l)}catch(u){this.log("error","error in heartbeat callback",u)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:s,event:a,payload:i,ref:o}=r,c=o?`(${o})`:"",d=i.status||"";this.log("receive",`${d} ${s} ${a} ${c}`.trim(),i),this.channels.filter(l=>l._isMember(s)).forEach(l=>l._trigger(a,i,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Wd.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Wd.open||this.conn.readyState===Wd.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(wl.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const s=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${s}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const s=new Blob([Ade],{type:"application/javascript"});r=URL.createObjectURL(s)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,s=!1;if(t)r=t,s=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;s?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const i={access_token:r,version:gde};r&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(wl.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(s=>{try{s(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(s){this.log("error",`error triggering ${t} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new cV(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ky.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,s,a,i,o,c,d,l,u,h,f,m;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(s=t==null?void 0:t.timeout)!==null&&s!==void 0?s:hC,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:ky.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(c=t==null?void 0:t.heartbeatCallback)!==null&&c!==void 0?c:o3,this.vsn=(d=t==null?void 0:t.vsn)!==null&&d!==void 0?d:KO,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:p=>Ede[p-1]||kde,this.vsn){case xde:this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(p,g)=>g(JSON.stringify(p)),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:(p,g)=>g(JSON.parse(p));break;case lV:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:this.serializer.encode.bind(this.serializer),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var Qx=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Pde(e,t,r){const s=new URL(t,e);if(r)for(const[a,i]of Object.entries(r))i!==void 0&&s.searchParams.set(a,i);return s.toString()}async function Ode(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function Rde(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:a,body:i,headers:o}){const c=Pde(e.baseUrl,s,a),d=await Ode(e.auth),l=await t(c,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...d,...o},body:i?JSON.stringify(i):void 0}),u=await l.text(),h=(l.headers.get("content-type")||"").includes("application/json"),f=h&&u?JSON.parse(u):u;if(!l.ok){const m=h?f:void 0,p=m==null?void 0:m.error;throw new Qx((p==null?void 0:p.message)??`Request failed with status ${l.status}`,{status:l.status,icebergType:p==null?void 0:p.type,icebergCode:p==null?void 0:p.code,details:m})}return{status:l.status,headers:l.headers,data:f}}}}function Ay(e){return e.join("")}var Mde=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Ay(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(s=>({namespace:s}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ay(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ay(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ay(e.namespace)}`}),!0}catch(t){if(t instanceof Qx&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Qx&&r.status===409)return;throw r}}};function qf(e){return e.join("")}var Ide=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${qf(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${qf(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${qf(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${qf(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${qf(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${qf(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Qx&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Qx&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},Dde=class{constructor(e){var s;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=Rde({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(s=e.accessDelegation)==null?void 0:s.join(","),this.namespaceOps=new Mde(this.client,t),this.tableOps=new Ide(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},I_=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Ns(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var Lde=class extends I_{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},pC=class extends I_{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const Pk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Bde=()=>Response,gC=e=>{if(Array.isArray(e))return e.map(r=>gC(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,s])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=gC(s)}),t},$de=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Fde=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Jx(e){"@babel/helpers - typeof";return Jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jx(e)}function zde(e,t){if(Jx(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Jx(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ude(e){var t=zde(e,"string");return Jx(t)=="symbol"?t:t+""}function Vde(e,t,r){return(t=Ude(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Rr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QO(Object(r),!0).forEach(function(s){Vde(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QO(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const l3=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},qde=async(e,t,r)=>{e instanceof await Bde()&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const a=e.status||500,i=(s==null?void 0:s.statusCode)||a+"";t(new Lde(l3(s),a,i))}).catch(s=>{t(new pC(l3(s),s))}):t(new pC(l3(e),e))},Wde=(e,t,r,s)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!s?a:($de(s)?(a.headers=Rr({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,t!=null&&t.duplex&&(a.duplex=t.duplex),Rr(Rr({},a),r))};async function v1(e,t,r,s,a,i){return new Promise((o,c)=>{e(r,Wde(t,s,a,i)).then(d=>{if(!d.ok)throw d;return s!=null&&s.noResolveJson?d:d.json()}).then(d=>o(d)).catch(d=>qde(d,c,s))})}async function ev(e,t,r,s){return v1(e,"GET",t,r,s)}async function xl(e,t,r,s,a){return v1(e,"POST",t,s,a,r)}async function xC(e,t,r,s,a){return v1(e,"PUT",t,s,a,r)}async function Hde(e,t,r,s){return v1(e,"HEAD",t,Rr(Rr({},r),{},{noResolveJson:!0}),s)}async function Ok(e,t,r,s,a){return v1(e,"DELETE",t,s,a,r)}var Gde=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ns(t))return{data:null,error:t};throw t}}};let hV;hV=Symbol.toStringTag;var Kde=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[hV]="BlobDownloadBuilder",this.promise=null}asStream(){return new Gde(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ns(t))return{data:null,error:t};throw t}}};const Xde={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},JO={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Yde=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=Pk(s)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,s){var a=this;try{let i;const o=Rr(Rr({},JO),s);let c=Rr(Rr({},a.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const d=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),d&&i.append("metadata",a.encodeMetadata(d)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),d&&!i.has("metadata")&&i.append("metadata",a.encodeMetadata(d))):(i=r,c["cache-control"]=`max-age=${o.cacheControl}`,c["content-type"]=o.contentType,d&&(c["x-metadata"]=a.toBase64(a.encodeMetadata(d))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),s!=null&&s.headers&&(c=Rr(Rr({},c),s.headers));const l=a._removeEmptyFolders(t),u=a._getFinalPath(l),h=await(e=="PUT"?xC:xl)(a.fetch,`${a.url}/object/${u}`,i,Rr({headers:c},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:l,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(Ns(i))return{data:null,error:i};throw i}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,s){var a=this;const i=a._removeEmptyFolders(e),o=a._getFinalPath(i),c=new URL(a.url+`/object/upload/sign/${o}`);c.searchParams.set("token",t);try{let d;const l=Rr({upsert:JO.upsert},s),u=Rr(Rr({},a.headers),{"x-upsert":String(l.upsert)});return typeof Blob<"u"&&r instanceof Blob?(d=new FormData,d.append("cacheControl",l.cacheControl),d.append("",r)):typeof FormData<"u"&&r instanceof FormData?(d=r,d.append("cacheControl",l.cacheControl)):(d=r,u["cache-control"]=`max-age=${l.cacheControl}`,u["content-type"]=l.contentType),{data:{path:i,fullPath:(await xC(a.fetch,c.toString(),d,{headers:u})).Key},error:null}}catch(d){if(a.shouldThrowOnError)throw d;if(Ns(d))return{data:null,error:d};throw d}}async createSignedUploadUrl(e,t){var r=this;try{let s=r._getFinalPath(e);const a=Rr({},r.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const i=await xl(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:a}),o=new URL(r.url+i.url),c=o.searchParams.get("token");if(!c)throw new I_("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:c},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ns(s))return{data:null,error:s};throw s}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var s=this;try{return{data:await xl(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers}),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Ns(a))return{data:null,error:a};throw a}}async copy(e,t,r){var s=this;try{return{data:{path:(await xl(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:s.headers})).Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Ns(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,r){var s=this;try{let a=s._getFinalPath(e),i=await xl(s.fetch,`${s.url}/object/sign/${a}`,Rr({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:s.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${s.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Ns(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,r){var s=this;try{const a=await xl(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:t,paths:e},{headers:s.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(o=>Rr(Rr({},o),{},{signedUrl:o.signedURL?encodeURI(`${s.url}${o.signedURL}${i}`):null})),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Ns(a))return{data:null,error:a};throw a}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=s?`?${s}`:"",i=this._getFinalPath(e),o=()=>ev(this.fetch,`${this.url}/${r}/${i}${a}`,{headers:this.headers,noResolveJson:!0});return new Kde(o,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:gC(await ev(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Ns(s))return{data:null,error:s};throw s}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await Hde(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(s){if(t.shouldThrowOnError)throw s;if(Ns(s)&&s instanceof pC){const a=s.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:s}}throw s}}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&s.push(a);const i=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",o=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});o!==""&&s.push(o);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${c}`)}}}async remove(e){var t=this;try{return{data:await Ok(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ns(r))return{data:null,error:r};throw r}}async list(e,t,r){var s=this;try{const a=Rr(Rr(Rr({},Xde),t),{},{prefix:e||""});return{data:await xl(s.fetch,`${s.url}/object/list/${s.bucketId}`,a,{headers:s.headers},r),error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Ns(a))return{data:null,error:a};throw a}}async listV2(e,t){var r=this;try{const s=Rr({},e);return{data:await xl(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},t),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ns(s))return{data:null,error:s};throw s}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const fV="2.91.0",mV={"X-Client-Info":`storage-js/${fV}`};var Zde=class{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const a=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Rr(Rr({},mV),t),this.fetch=Pk(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await ev(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ns(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await ev(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ns(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await xl(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ns(s))return{data:null,error:s};throw s}}async updateBucket(e,t){var r=this;try{return{data:await xC(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Ns(s))return{data:null,error:s};throw s}}async emptyBucket(e){var t=this;try{return{data:await xl(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ns(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Ok(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ns(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Qde=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Rr(Rr({},mV),t),this.fetch=Pk(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await xl(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ns(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const s=r.toString(),a=s?`${t.url}/bucket?${s}`:`${t.url}/bucket`;return{data:await ev(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ns(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await Ok(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ns(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!Fde(e))throw new I_("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Dde({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(a,i){const o=a[i];return typeof o!="function"?o:async(...c)=>{try{return{data:await o.apply(a,c),error:null}}catch(d){if(s)throw d;return{data:null,error:d}}}}})}};const Rk={"X-Client-Info":`storage-js/${fV}`,"Content-Type":"application/json"};var pV=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function ho(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var c3=class extends pV{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Jde=class extends pV{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const Mk=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),eue=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},eR=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),tue=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const s=e.status||500,a=e;if(typeof a.json=="function")a.json().then(i=>{const o=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||s+"";t(new c3(eR(i),s,o))}).catch(()=>{const i=s+"";t(new c3(a.statusText||`HTTP ${s} error`,s,i))});else{const i=s+"";t(new c3(a.statusText||`HTTP ${s} error`,s,i))}}else t(new Jde(eR(e),e))},rue=(e,t,r,s)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return s?(eue(s)?(a.headers=Rr({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,Rr(Rr({},a),r)):a};async function nue(e,t,r,s,a,i){return new Promise((o,c)=>{e(r,rue(t,s,a,i)).then(d=>{if(!d.ok)throw d;if(s!=null&&s.noResolveJson)return d;const l=d.headers.get("content-type");return!l||!l.includes("application/json")?{}:d.json()}).then(d=>o(d)).catch(d=>tue(d,c,s))})}async function fo(e,t,r,s,a){return nue(e,"POST",t,s,a,r)}var sue=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Rr(Rr({},Rk),t),this.fetch=Mk(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await fo(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ho(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await fo(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ho(s))return{data:null,error:s};throw s}}async listIndexes(e){var t=this;try{return{data:await fo(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ho(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await fo(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(ho(s))return{data:null,error:s};throw s}}},aue=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Rr(Rr({},Rk),t),this.fetch=Mk(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await fo(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ho(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await fo(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ho(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await fo(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ho(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await fo(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ho(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await fo(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ho(r))return{data:null,error:r};throw r}}},iue=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Rr(Rr({},Rk),t),this.fetch=Mk(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await fo(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ho(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await fo(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ho(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await fo(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ho(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await fo(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(ho(r))return{data:null,error:r};throw r}}},oue=class extends iue{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new lue(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},lue=class extends sue{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Rr(Rr({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Rr(Rr({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new cue(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},cue=class extends aue{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Rr(Rr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Rr(Rr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Rr(Rr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Rr(Rr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Rr(Rr({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},due=class extends Zde{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new Yde(this.url,this.headers,e,this.fetch)}get vectors(){return new oue(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Qde(this.url+"/iceberg",this.headers,this.fetch)}};const gV="2.91.0",dm=30*1e3,vC=3,d3=vC*dm,uue="http://localhost:9999",hue="supabase.auth.token",fue={"X-Client-Info":`gotrue-js/${gV}`},yC="X-Supabase-Api-Version",xV={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},mue=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,pue=10*60*1e3;class tv extends Error{constructor(t,r,s){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=s}}function yr(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class gue extends tv{constructor(t,r,s){super(t,r,s),this.name="AuthApiError",this.status=r,this.code=s}}function xue(e){return yr(e)&&e.name==="AuthApiError"}class Sh extends tv{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class jd extends tv{constructor(t,r,s,a){super(t,s,a),this.name=r,this.status=s}}class so extends jd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function vue(e){return yr(e)&&e.name==="AuthSessionMissingError"}class Wf extends jd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ty extends jd{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Py extends jd{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function yue(e){return yr(e)&&e.name==="AuthImplicitGrantRedirectError"}class tR extends jd{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class bue extends jd{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class bC extends jd{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function u3(e){return yr(e)&&e.name==="AuthRetryableFetchError"}class rR extends jd{constructor(t,r,s){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=s}}class wC extends jd{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Nw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),nR=` 	
\r=`.split(""),wue=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<nR.length;t+=1)e[nR[t].charCodeAt(0)]=-2;for(let t=0;t<Nw.length;t+=1)e[Nw[t].charCodeAt(0)]=t;return e})();function sR(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Nw[s]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const s=t.queue>>t.queuedBits-6&63;r(Nw[s]),t.queuedBits-=6}}function vV(e,t,r){const s=wue[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function aR(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=o=>{Nue(o,s,r)};for(let o=0;o<e.length;o+=1)vV(e.charCodeAt(o),a,i);return t.join("")}function _ue(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function jue(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){const a=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}_ue(s,t)}}function Nue(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Gm(e){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)vV(e.charCodeAt(a),r,s);return new Uint8Array(t)}function Sue(e){const t=[];return jue(e,r=>t.push(r)),new Uint8Array(t)}function Th(e){const t=[],r={queue:0,queuedBits:0},s=a=>{t.push(a)};return e.forEach(a=>sR(a,r,s)),sR(null,r,s),t.join("")}function Cue(e){return Math.round(Date.now()/1e3)+e}function Eue(){return Symbol("auth-callback")}const Va=()=>typeof window<"u"&&typeof document<"u",sh={tested:!1,writable:!1},yV=()=>{if(!Va())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(sh.tested)return sh.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),sh.tested=!0,sh.writable=!0}catch{sh.tested=!0,sh.writable=!1}return sh.writable};function kue(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((s,a)=>{t[a]=s}),t}const bV=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Aue=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",um=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ah=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Ua=async(e,t)=>{await e.removeItem(t)};class D_{constructor(){this.promise=new D_.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}D_.promiseConstructor=Promise;function h3(e){const t=e.split(".");if(t.length!==3)throw new wC("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!mue.test(t[s]))throw new wC("JWT not in base64url format");return{header:JSON.parse(aR(t[0])),payload:JSON.parse(aR(t[1])),signature:Gm(t[2]),raw:{header:t[0],payload:t[1]}}}async function Tue(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Pue(e,t){return new Promise((s,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){s(o);return}}catch(o){if(!t(i,o)){a(o);return}}})()})}function Oue(e){return("0"+e.toString(16)).substr(-2)}function Rue(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*s));return a}return crypto.getRandomValues(t),Array.from(t,Oue).join("")}async function Mue(e){const r=new TextEncoder().encode(e),s=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(s);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function Iue(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Mue(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Hf(e,t,r=!1){const s=Rue();let a=s;r&&(a+="/PASSWORD_RECOVERY"),await um(e,`${t}-code-verifier`,a);const i=await Iue(s);return[i,s===i?"plain":"s256"]}const Due=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Lue(e){const t=e.headers.get(yC);if(!t||!t.match(Due))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function Bue(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function $ue(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Fue=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Gf(e){if(!Fue.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function f3(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const s=r.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function zue(e,t){return new Proxy(e,{get:(r,s,a)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,s,a)}return!t.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,s,a)}})}function iR(e){return JSON.parse(JSON.stringify(e))}const vh=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Uue=[502,503,504];async function oR(e){var t;if(!Aue(e))throw new bC(vh(e),0);if(Uue.includes(e.status))throw new bC(vh(e),e.status);let r;try{r=await e.json()}catch(i){throw new Sh(vh(i),i)}let s;const a=Lue(e);if(a&&a.getTime()>=xV["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?s=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(s=r.error_code),s){if(s==="weak_password")throw new rR(vh(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(s==="session_not_found")throw new so}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new rR(vh(r),e.status,r.weak_password.reasons);throw new gue(vh(r),e.status||500,s)}const Vue=(e,t,r,s)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),r))};async function Or(e,t,r,s){var a;const i=Object.assign({},s==null?void 0:s.headers);i[yC]||(i[yC]=xV["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(a=s==null?void 0:s.query)!==null&&a!==void 0?a:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const c=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",d=await que(e,t,r+c,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(d):{data:Object.assign({},d),error:null}}async function que(e,t,r,s,a,i){const o=Vue(t,s,a,i);let c;try{c=await e(r,Object.assign({},o))}catch(d){throw console.error(d),new bC(vh(d),0)}if(c.ok||await oR(c),s!=null&&s.noResolveJson)return c;try{return await c.json()}catch(d){await oR(d)}}function hl(e){var t;let r=null;Gue(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Cue(e.expires_in)));const s=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:s},error:null}}function lR(e){const t=hl(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,s)=>r&&typeof s=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Yd(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Wue(e){return{data:e,error:null}}function Hue(e){const{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:i}=e,o=_g(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:i},d=Object.assign({},o);return{data:{properties:c,user:d},error:null}}function cR(e){return e}function Gue(e){return e.access_token&&e.refresh_token&&e.expires_in}const m3=["global","local","others"];class Kue{constructor({url:t="",headers:r={},fetch:s}){this.url=t,this.headers=r,this.fetch=bV(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=m3[0]){if(m3.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${m3.join(", ")}`);try{return await Or(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(s){if(yr(s))return{data:null,error:s};throw s}}async inviteUserByEmail(t,r={}){try{return await Or(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Yd})}catch(s){if(yr(s))return{data:{user:null},error:s};throw s}}async generateLink(t){try{const{options:r}=t,s=_g(t,["options"]),a=Object.assign(Object.assign({},s),r);return"newEmail"in s&&(a.new_email=s==null?void 0:s.newEmail,delete a.newEmail),await Or(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Hue,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(yr(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Or(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Yd})}catch(r){if(yr(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,s,a,i,o,c,d;try{const l={nextPage:null,lastPage:0,total:0},u=await Or(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:cR});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(d=(c=u.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return m.length>0&&(m.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(p.split(";")[1].split("=")[1]);l[`${v}Page`]=g}),l.total=parseInt(f)),{data:Object.assign(Object.assign({},h),l),error:null}}catch(l){if(yr(l))return{data:{users:[]},error:l};throw l}}async getUserById(t){Gf(t);try{return await Or(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Yd})}catch(r){if(yr(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Gf(t);try{return await Or(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Yd})}catch(s){if(yr(s))return{data:{user:null},error:s};throw s}}async deleteUser(t,r=!1){Gf(t);try{return await Or(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Yd})}catch(s){if(yr(s))return{data:{user:null},error:s};throw s}}async _listFactors(t){Gf(t.userId);try{const{data:r,error:s}=await Or(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:s}}catch(r){if(yr(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Gf(t.userId),Gf(t.id);try{return{data:await Or(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(yr(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,s,a,i,o,c,d;try{const l={nextPage:null,lastPage:0,total:0},u=await Or(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:cR});if(u.error)throw u.error;const h=await u.json(),f=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(d=(c=u.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&d!==void 0?d:[];return m.length>0&&(m.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(p.split(";")[1].split("=")[1]);l[`${v}Page`]=g}),l.total=parseInt(f)),{data:Object.assign(Object.assign({},h),l),error:null}}catch(l){if(yr(l))return{data:{clients:[]},error:l};throw l}}async _createOAuthClient(t){try{return await Or(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(yr(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Or(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(yr(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Or(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(yr(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(t){try{return await Or(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(yr(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Or(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(yr(r))return{data:null,error:r};throw r}}}function dR(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Kf={debug:!!(globalThis&&yV()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class wV extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Xue extends wV{}async function Yue(e,t,r){Kf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),Kf.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async a=>{if(a){Kf.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Kf.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Kf.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Xue(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Kf.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function Zue(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function _V(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Que(e){return parseInt(e,16)}function Jue(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,s=>s.toString(16).padStart(2,"0")).join("")}function ehe(e){var t;const{chainId:r,domain:s,expirationTime:a,issuedAt:i=new Date,nonce:o,notBefore:c,requestId:d,resources:l,scheme:u,uri:h,version:f}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(f!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${f}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=_V(e.address),p=u?`${u}://${s}`:s,g=e.statement?`${e.statement}
`:"",v=`${p} wants you to sign in with your Ethereum account:
${m}

${g}`;let x=`URI: ${h}
Version: ${f}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(a&&(x+=`
Expiration Time: ${a.toISOString()}`),c&&(x+=`
Not Before: ${c.toISOString()}`),d&&(x+=`
Request ID: ${d}`),l){let y=`
Resources:`;for(const b of l){if(!b||typeof b!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${b}`);y+=`
- ${b}`}x+=y}return`${v}
${x}`}class Xs extends Error{constructor({message:t,code:r,cause:s,name:a}){var i;super(t,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=a??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class Sw extends Xs{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function the({error:e,options:t}){var r,s,a;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Xs({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Xs({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Xs({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new Xs({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Xs({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Xs({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new Xs({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Xs({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(jV(o)){if(i.rp.id!==o)return new Xs({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Xs({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Xs({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Xs({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Xs({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function rhe({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Xs({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Xs({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(jV(s)){if(r.rpId!==s)return new Xs({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Xs({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Xs({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Xs({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class nhe{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const she=new nhe;function ahe(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:s}=e,a=_g(e,["challenge","user","excludeCredentials"]),i=Gm(t).buffer,o=Object.assign(Object.assign({},r),{id:Gm(r.id).buffer}),c=Object.assign(Object.assign({},a),{challenge:i,user:o});if(s&&s.length>0){c.excludeCredentials=new Array(s.length);for(let d=0;d<s.length;d++){const l=s[d];c.excludeCredentials[d]=Object.assign(Object.assign({},l),{id:Gm(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return c}function ihe(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,s=_g(e,["challenge","allowCredentials"]),a=Gm(t).buffer,i=Object.assign(Object.assign({},s),{challenge:a});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const c=r[o];i.allowCredentials[o]=Object.assign(Object.assign({},c),{id:Gm(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return i}function ohe(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Th(new Uint8Array(e.response.attestationObject)),clientDataJSON:Th(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function lhe(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,s=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Th(new Uint8Array(a.authenticatorData)),clientDataJSON:Th(new Uint8Array(a.clientDataJSON)),signature:Th(new Uint8Array(a.signature)),userHandle:a.userHandle?Th(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function jV(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function uR(){var e,t;return!!(Va()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function che(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Sw("Browser returned unexpected credential type",t)}:{data:null,error:new Sw("Empty credential response",t)}}catch(t){return{data:null,error:the({error:t,options:e})}}}async function dhe(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Sw("Browser returned unexpected credential type",t)}:{data:null,error:new Sw("Empty credential response",t)}}catch(t){return{data:null,error:rhe({error:t,options:e})}}}const uhe={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},hhe={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Cw(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),s={};for(const a of e)if(a)for(const i in a){const o=a[i];if(o!==void 0)if(Array.isArray(o))s[i]=o;else if(r(o))s[i]=o;else if(t(o)){const c=s[i];t(c)?s[i]=Cw(c,o):s[i]=Cw(o)}else s[i]=o}return s}function fhe(e,t){return Cw(uhe,e,t||{})}function mhe(e,t){return Cw(hhe,e,t||{})}class phe{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:s,signal:a},i){try{const{data:o,error:c}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:c};const d=a??she.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:l}=o.webauthn.credential_options.publicKey;l.name||(l.name=`${l.id}:${s}`),l.displayName||(l.displayName=l.name)}switch(o.webauthn.type){case"create":{const l=fhe(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:u,error:h}=await che({publicKey:l,signal:d});return u?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const l=mhe(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:u,error:h}=await dhe(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:l,signal:d}));return u?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(o){return yr(o)?{data:null,error:o}:{data:null,error:new Sh("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:s}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:s})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new tv("rpId is required for WebAuthn authentication")};try{if(!uR())return{data:null,error:new Sh("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:s},signal:a},{request:i});if(!o)return{data:null,error:c};const{webauthn:d}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:d.type,rpId:r,rpOrigins:s,credential_response:d.credential_response}})}catch(o){return yr(o)?{data:null,error:o}:{data:null,error:new Sh("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new tv("rpId is required for WebAuthn registration")};try{if(!uR())return{data:null,error:new Sh("Browser does not support WebAuthn",null)};const{data:o,error:c}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(f=>f.factor_type==="webauthn"&&f.friendly_name===t&&f.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u==null?void 0:u.id}):void 0),{data:null,error:c};const{data:d,error:l}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:s},signal:a},{create:i});return d?this._verify({factorId:o.id,challengeId:d.challengeId,webauthn:{rpId:r,rpOrigins:s,type:d.webauthn.type,credential_response:d.webauthn.credential_response}}):{data:null,error:l}}catch(o){return yr(o)?{data:null,error:o}:{data:null,error:new Sh("Unexpected error in register",o)}}}}Zue();const ghe={url:uue,storageKey:hue,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:fue,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function hR(e,t,r){return await r()}const Xf={};class rv{get jwks(){var t,r;return(r=(t=Xf[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Xf[this.storageKey]=Object.assign(Object.assign({},Xf[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Xf[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Xf[this.storageKey]=Object.assign(Object.assign({},Xf[this.storageKey]),{cachedAt:t})}constructor(t){var r,s,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},ghe),t);if(this.storageKey=i.storageKey,this.instanceID=(r=rv.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,rv.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Va()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Kue({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=bV(i.fetch),this.lock=i.lock||hR,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&Va()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=Yue:this.lock=hR,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new phe(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:yV()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=dR(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=dR(this.memoryStorage)),Va()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${gV}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},s="none";if(Va()&&(r=kue(window.location.href),this._isImplicitGrantCallback(r)?s="implicit":await this._isPKCECallback(r)&&(s="pkce")),Va()&&this.detectSessionInUrl&&s!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),yue(i)){const d=(t=i.details)===null||t===void 0?void 0:t.code;if(d==="identity_already_exists"||d==="identity_not_found"||d==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:o,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",o,"redirect type",c),await this._saveSession(o),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return yr(r)?this._returnResult({error:r}):this._returnResult({error:new Sh("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,s,a;try{const i=await Or(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:hl}),{data:o,error:c}=i;if(c||!o)return this._returnResult({data:{user:null,session:null},error:c});const d=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:l,session:d},error:null})}catch(i){if(yr(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,s,a;try{let i;if("email"in t){const{email:u,password:h,options:f}=t;let m=null,p=null;this.flowType==="pkce"&&([m,p]=await Hf(this.storage,this.storageKey)),i=await Or(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:u,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:m,code_challenge_method:p},xform:hl})}else if("phone"in t){const{phone:u,password:h,options:f}=t;i=await Or(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(s=f==null?void 0:f.data)!==null&&s!==void 0?s:{},channel:(a=f==null?void 0:f.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:hl})}else throw new Ty("You must provide either an email or phone number and a password");const{data:o,error:c}=i;if(c||!o)return await Ua(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const d=o.session,l=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",d)),this._returnResult({data:{user:l,session:d},error:null})}catch(i){if(await Ua(this.storage,`${this.storageKey}-code-verifier`),yr(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:o,options:c}=t;r=await Or(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:lR})}else if("phone"in t){const{phone:i,password:o,options:c}=t;r=await Or(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:lR})}else throw new Ty("You must provide either an email or phone number and a password");const{data:s,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!s||!s.session||!s.user){const i=new Wf;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:a})}catch(r){if(yr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,s,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(s=t.options)===null||s===void 0?void 0:s.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,s,a,i,o,c,d,l,u,h,f;let m,p;if("message"in t)m=t.message,p=t.signature;else{const{chain:g,wallet:v,statement:x,options:y}=t;let b;if(Va())if(typeof v=="object")b=v;else{const L=window;if("ethereum"in L&&typeof L.ethereum=="object"&&"request"in L.ethereum&&typeof L.ethereum.request=="function")b=L.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=v}const j=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href),T=await b.request({method:"eth_requestAccounts"}).then(L=>L).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!T||T.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const O=_V(T[0]);let R=(s=y==null?void 0:y.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!R){const L=await b.request({method:"eth_chainId"});R=Que(L)}const D={domain:j.host,address:O,statement:x,uri:j.href,version:"1",chainId:R,nonce:(a=y==null?void 0:y.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(o=(i=y==null?void 0:y.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(c=y==null?void 0:y.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(d=y==null?void 0:y.signInWithEthereum)===null||d===void 0?void 0:d.notBefore,requestId:(l=y==null?void 0:y.signInWithEthereum)===null||l===void 0?void 0:l.requestId,resources:(u=y==null?void 0:y.signInWithEthereum)===null||u===void 0?void 0:u.resources};m=ehe(D),p=await b.request({method:"personal_sign",params:[Jue(m),O]})}try{const{data:g,error:v}=await Or(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:p},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:hl});if(v)throw v;if(!g||!g.session||!g.user){const x=new Wf;return this._returnResult({data:{user:null,session:null},error:x})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:v})}catch(g){if(yr(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async signInWithSolana(t){var r,s,a,i,o,c,d,l,u,h,f,m;let p,g;if("message"in t)p=t.message,g=t.signature;else{const{chain:v,wallet:x,statement:y,options:b}=t;let j;if(Va())if(typeof x=="object")j=x;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))j=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=x}const T=new URL((r=b==null?void 0:b.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const O=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),y?{statement:y}:null));let R;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")R=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)R=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)p=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),g=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${T.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(a=(s=b==null?void 0:b.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((d=b==null?void 0:b.signInWithSolana)===null||d===void 0)&&d.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(u=b==null?void 0:b.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const O=await j.signMessage(new TextEncoder().encode(p),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=O}}try{const{data:v,error:x}=await Or(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:Th(g)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:hl});if(x)throw x;if(!v||!v.session||!v.user){const y=new Wf;return this._returnResult({data:{user:null,session:null},error:y})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:x})}catch(v){if(yr(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async _exchangeCodeForSession(t){const r=await ah(this.storage,`${this.storageKey}-code-verifier`),[s,a]=(r??"").split("/");try{if(!s&&this.flowType==="pkce")throw new bue;const{data:i,error:o}=await Or(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:s},xform:hl});if(await Ua(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const c=new Wf;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return i.session&&(await this._saveSession(i.session),setTimeout(async()=>{await this._notifyAllSubscribers("SIGNED_IN",i.session)},0)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:o})}catch(i){if(await Ua(this.storage,`${this.storageKey}-code-verifier`),yr(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:s,token:a,access_token:i,nonce:o}=t,c=await Or(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:a,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:hl}),{data:d,error:l}=c;if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!d||!d.session||!d.user){const u=new Wf;return this._returnResult({data:{user:null,session:null},error:u})}return d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("SIGNED_IN",d.session)),this._returnResult({data:d,error:l})}catch(r){if(yr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,s,a,i,o;try{if("email"in t){const{email:c,options:d}=t;let l=null,u=null;this.flowType==="pkce"&&([l,u]=await Hf(this.storage,this.storageKey));const{error:h}=await Or(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=d==null?void 0:d.data)!==null&&r!==void 0?r:{},create_user:(s=d==null?void 0:d.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:l,code_challenge_method:u},redirectTo:d==null?void 0:d.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:c,options:d}=t,{data:l,error:u}=await Or(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=d==null?void 0:d.data)!==null&&a!==void 0?a:{},create_user:(i=d==null?void 0:d.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},channel:(o=d==null?void 0:d.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:u})}throw new Ty("You must provide either an email or phone number.")}catch(c){if(await Ua(this.storage,`${this.storageKey}-code-verifier`),yr(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(t){var r,s;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(s=t.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:c}=await Or(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:hl});if(c)throw c;if(!o)throw new Error("An error occurred on token verification.");const d=o.session,l=o.user;return d!=null&&d.access_token&&(await this._saveSession(d),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",d)),this._returnResult({data:{user:l,session:d},error:null})}catch(a){if(yr(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,s,a,i,o;try{let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Hf(this.storage,this.storageKey));const l=await Or(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&s!==void 0?s:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:d}),headers:this.headers,xform:Wue});return!((i=l.data)===null||i===void 0)&&i.url&&Va()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(c){if(await Ua(this.storage,`${this.storageKey}-code-verifier`),yr(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;if(s)throw s;if(!r)throw new so;const{error:a}=await Or(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(yr(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:s,type:a,options:i}=t,{error:o}=await Or(this.fetch,"POST",r,{headers:this.headers,body:{email:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:s,type:a,options:i}=t,{data:o,error:c}=await Or(this.fetch,"POST",r,{headers:this.headers,body:{phone:s,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:c})}throw new Ty("You must provide either an email or phone number and a type")}catch(r){if(yr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await s,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=r();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ah(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const s=t.expires_at?t.expires_at*1e3-Date.now()<d3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){const o=await ah(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=f3()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=zue(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Or(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Yd}):await this._useSession(async r=>{var s,a,i;const{data:o,error:c}=r;if(c)throw c;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new so}:await Or(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:Yd})})}catch(r){if(yr(r))return vue(r)&&(await this._removeSession(),await Ua(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async s=>{const{data:a,error:i}=s;if(i)throw i;if(!a.session)throw new so;const o=a.session;let c=null,d=null;this.flowType==="pkce"&&t.email!=null&&([c,d]=await Hf(this.storage,this.storageKey));const{data:l,error:u}=await Or(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:d}),jwt:o.access_token,xform:Yd});if(u)throw u;return o.user=l.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(await Ua(this.storage,`${this.storageKey}-code-verifier`),yr(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new so;const r=Date.now()/1e3;let s=r,a=!0,i=null;const{payload:o}=h3(t.access_token);if(o.exp&&(s=o.exp,a=s<=r),a){const{data:c,error:d}=await this._callRefreshToken(t.refresh_token);if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:d}=await this._getUser(t.access_token);if(d)throw d;i={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:s-r,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(yr(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var s;if(!t){const{data:o,error:c}=r;if(c)throw c;t=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(t!=null&&t.refresh_token))throw new so;const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(yr(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!Va())throw new Py("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Py(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new tR("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Py("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new tR("No code detected.");const{data:y,error:b}=await this._exchangeCodeForSession(t.code);if(b)throw b;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:a,access_token:i,refresh_token:o,expires_in:c,expires_at:d,token_type:l}=t;if(!i||!c||!o||!l)throw new Py("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(c);let f=u+h;d&&(f=parseInt(d));const m=f-u;m*1e3<=dm&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const p=f-h;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,f,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,f,u);const{data:g,error:v}=await this._getUser(i);if(v)throw v;const x={provider_token:s,provider_refresh_token:a,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:l,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:x,redirectType:t.type},error:null})}catch(s){if(yr(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ah(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var s;const{data:a,error:i}=r;if(i)return this._returnResult({error:i});const o=(s=a.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:c}=await this.admin.signOut(o,t);if(c&&!(xue(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return t!=="others"&&(await this._removeSession(),await Ua(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Eue(),s={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,s),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:s}}}async _emitInitialSession(t){return await this._useSession(async r=>{var s,a;try{const{data:{session:i},error:o}=r;if(o)throw o;await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let s=null,a=null;this.flowType==="pkce"&&([s,a]=await Hf(this.storage,this.storageKey,!0));try{return await Or(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:s,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await Ua(this.storage,`${this.storageKey}-code-verifier`),yr(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:s,error:a}=await this._useSession(async i=>{var o,c,d,l,u;const{data:h,error:f}=i;if(f)throw f;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(d=t.options)===null||d===void 0?void 0:d.queryParams,skipBrowserRedirect:!0});return await Or(this.fetch,"GET",m,{headers:this.headers,jwt:(u=(l=h.session)===null||l===void 0?void 0:l.access_token)!==null&&u!==void 0?u:void 0})});if(a)throw a;return Va()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:t.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(yr(s))return this._returnResult({data:{provider:t.provider,url:null},error:s});throw s}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var s;try{const{error:a,data:{session:i}}=r;if(a)throw a;const{options:o,provider:c,token:d,access_token:l,nonce:u}=t,h=await Or(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:c,id_token:d,access_token:l,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:hl}),{data:f,error:m}=h;return m?this._returnResult({data:{user:null,session:null},error:m}):!f||!f.session||!f.user?this._returnResult({data:{user:null,session:null},error:new Wf}):(f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("USER_UPDATED",f.session)),this._returnResult({data:f,error:m}))}catch(a){if(await Ua(this.storage,`${this.storageKey}-code-verifier`),yr(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var s,a;const{data:i,error:o}=r;if(o)throw o;return await Or(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const s=Date.now();return await Pue(async a=>(a>0&&await Tue(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Or(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:hl})),(a,i)=>{const o=200*Math.pow(2,a);return i&&u3(i)&&Date.now()+o-s<dm})}catch(s){if(this._debug(r,"error",s),yr(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const s=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",s),Va()&&!r.skipBrowserRedirect&&window.location.assign(s),{data:{provider:t,url:s},error:null}}async _recoverAndRefresh(){var t,r;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const a=await ah(this.storage,this.storageKey);if(a&&this.userStorage){let o=await ah(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:a.user},await um(this.userStorage,this.storageKey+"-user",o)),a.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:f3()}else if(a&&!a.user&&!a.user){const o=await ah(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(a.user=o.user,await Ua(this.storage,this.storageKey+"-user"),await um(this.storage,this.storageKey,a)):a.user=f3()}if(this._debug(s,"session from storage",a),!this._isValidSession(a)){this._debug(s,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<d3;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${d3}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:o}=await this._callRefreshToken(a.refresh_token);o&&(console.error(o),u3(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:c}=await this._getUser(a.access_token);!c&&(o!=null&&o.user)?(a.user=o.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(s,"error",a),console.error(a);return}finally{this._debug(s,"end")}}async _callRefreshToken(t){var r,s;if(!t)throw new so;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new D_;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new so;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={data:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(a,"error",i),yr(i)){const o={data:null,error:i};return u3(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,s=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,r)}catch(d){i.push(d)}});if(await Promise.all(o),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Ua(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),s=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&r.user&&await um(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=iR(a);await um(this.storage,this.storageKey,i)}else{const a=iR(r);await um(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ua(this.storage,this.storageKey),await Ua(this.storage,this.storageKey+"-code-verifier"),await Ua(this.storage,this.storageKey+"-user"),this.userStorage&&await Ua(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Va()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),dm);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:s}}=r;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((s.expires_at*1e3-t)/dm);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${dm}ms, refresh threshold is ${vC} ticks`),a<=vC&&await this._callRefreshToken(s.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof wV)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Va()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,s){const a=[`provider=${encodeURIComponent(r)}`];if(s!=null&&s.redirectTo&&a.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&a.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Hf(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});a.push(c.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);a.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&a.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;return i?this._returnResult({data:null,error:i}):await Or(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token})})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var s,a;const{data:i,error:o}=r;if(o)return this._returnResult({data:null,error:o});const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:d,error:l}=await Or(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return l?this._returnResult({data:null,error:l}):(t.factorType==="totp"&&d.type==="totp"&&(!((a=d==null?void 0:d.totp)===null||a===void 0)&&a.qr_code)&&(d.totp.qr_code=`data:image/svg+xml;utf-8,${d.totp.qr_code}`),this._returnResult({data:d,error:null}))})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?ohe(t.webauthn.credential_response):lhe(t.webauthn.credential_response)})}:{code:t.code}),{data:c,error:d}=await Or(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:d}))})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var s;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=await Or(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(s=a==null?void 0:a.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:c}=o;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:ahe(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:ihe(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:s}=await this._challenge({factorId:t.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:s}=await this.getUser();if(s)return{data:null,error:s};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:s},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=h3(s.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const l=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:l},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;return a?this._returnResult({data:null,error:a}):s?await Or(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new so})})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:a},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new so});const o=await Or(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&Va()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(yr(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(t,r){try{return await this._useSession(async s=>{const{data:{session:a},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new so});const o=await Or(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return o.data&&o.data.redirect_url&&Va()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(yr(s))return this._returnResult({data:null,error:s});throw s}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await Or(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new so})})}catch(t){if(yr(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;return a?this._returnResult({data:null,error:a}):s?(await Or(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:s.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new so})})}catch(r){if(yr(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let s=r.keys.find(c=>c.kid===t);if(s)return s;const a=Date.now();if(s=this.jwks.keys.find(c=>c.kid===t),s&&this.jwks_cached_at+pue>a)return s;const{data:i,error:o}=await Or(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,s=i.keys.find(c=>c.kid===t),!s)?null:s}async getClaims(t,r={}){try{let s=t;if(!s){const{data:m,error:p}=await this.getSession();if(p||!m.session)return this._returnResult({data:null,error:p});s=m.session.access_token}const{header:a,payload:i,signature:o,raw:{header:c,payload:d}}=h3(s);r!=null&&r.allowExpired||Bue(i.exp);const l=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!l){const{error:m}=await this.getUser(s);if(m)throw m;return{data:{claims:i,header:a,signature:o},error:null}}const u=$ue(a.alg),h=await crypto.subtle.importKey("jwk",l,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,Sue(`${c}.${d}`)))throw new wC("Invalid JWT signature");return{data:{claims:i,header:a,signature:o},error:null}}catch(s){if(yr(s))return this._returnResult({data:null,error:s});throw s}}}rv.nextInstanceID={};const xhe=rv,vhe="2.91.0";let q0="";typeof Deno<"u"?q0="deno":typeof document<"u"?q0="web":typeof navigator<"u"&&navigator.product==="ReactNative"?q0="react-native":q0="node";const yhe={"X-Client-Info":`supabase-js-${q0}/${vhe}`},bhe={headers:yhe},whe={schema:"public"},_he={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},jhe={};function nv(e){"@babel/helpers - typeof";return nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nv(e)}function Nhe(e,t){if(nv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(nv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function She(e){var t=Nhe(e,"string");return nv(t)=="symbol"?t:t+""}function Che(e,t,r){return(t=She(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Bs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fR(Object(r),!0).forEach(function(s){Che(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fR(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}const Ehe=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),khe=()=>Headers,Ahe=(e,t,r)=>{const s=Ehe(r),a=khe();return async(i,o)=>{var c;const d=(c=await t())!==null&&c!==void 0?c:e;let l=new a(o==null?void 0:o.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${d}`),s(i,Bs(Bs({},o),{},{headers:l}))}};function The(e){return e.endsWith("/")?e:e+"/"}function Phe(e,t){var r,s;const{db:a,auth:i,realtime:o,global:c}=e,{db:d,auth:l,realtime:u,global:h}=t,f={db:Bs(Bs({},d),a),auth:Bs(Bs({},l),i),realtime:Bs(Bs({},u),o),storage:{},global:Bs(Bs(Bs({},h),c),{},{headers:Bs(Bs({},(r=h==null?void 0:h.headers)!==null&&r!==void 0?r:{}),(s=c==null?void 0:c.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}function Ohe(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(The(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Rhe=class extends xhe{constructor(e){super(e)}},Mhe=class{constructor(e,t,r){var s,a;this.supabaseUrl=e,this.supabaseKey=t;const i=Ohe(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const o=`sb-${i.hostname.split(".")[0]}-auth-token`,c={db:whe,realtime:jhe,auth:Bs(Bs({},_he),{},{storageKey:o}),global:bhe},d=Phe(r??{},c);if(this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=d.global.headers)!==null&&a!==void 0?a:{},d.accessToken)this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(u,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var l;this.auth=this._initSupabaseAuthClient((l=d.auth)!==null&&l!==void 0?l:{},this.headers,d.global.fetch)}this.fetch=Ahe(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Bs({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new fde(new URL("rest/v1",i).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new due(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new lde(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:s}=await e.auth.getSession();return(t=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:i,flowType:o,lock:c,debug:d,throwOnError:l},u,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Rhe({url:this.authUrl.href,headers:Bs(Bs({},f),u),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:o,lock:c,debug:d,throwOnError:l,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Tde(this.realtimeUrl.href,Bs(Bs({},e),{},{params:Bs(Bs({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Ihe=(e,t,r)=>new Mhe(e,t,r);function Dhe(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Dhe()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Lhe="https://deibjfkveiyogvtscyeh.supabase.co",Bhe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRlaWJqZmt2ZWl5b2d2dHNjeWVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA2MDA3MzMsImV4cCI6MjA4NjE3NjczM30.eYGXOHLLJq6wpRT605kxSc8t_qS15_ux174d0rUOmfY",ce=Ihe(Lhe,Bhe,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}});function $he(){const e=P.useCallback(async u=>{const h=new Date().toISOString();let f=ce.from("gift_rules").select(`
        *,
        gift:gifts(*)
      `).eq("is_active",!0).or(`start_at.is.null,start_at.lte.${h}`).or(`end_at.is.null,end_at.gte.${h}`).order("priority",{ascending:!1});u.channel==="catalog"?f=f.in("channel_scope",["catalog_only","both"]):f=f.in("channel_scope",["live_only","both","live_specific"]);const{data:m,error:p}=await f;if(p)return console.error("Error fetching gift rules:",p),[];let g=m||[];return u.liveEventId?g=g.filter(v=>v.channel_scope==="live_specific"?v.live_event_id===u.liveEventId:!0):g=g.filter(v=>v.channel_scope!=="live_specific"),g},[]),t=P.useCallback(async(u,h)=>{switch(u.condition_type){case"all_purchases":return!0;case"min_value":return u.condition_value?h.cartTotal>=u.condition_value:!1;case"first_n_paid":return u.condition_value?u.current_awards_count<u.condition_value:!1;case"first_n_reserved":return u.condition_value?u.current_awards_count<u.condition_value:!1;default:return!1}},[]),r=P.useCallback(async(u,h,f)=>{var g;if(!u.max_per_customer||!h&&!f)return!0;let m=ce.from("order_gifts").select("id",{count:"exact"}).eq("applied_by_rule_id",u.id);if(f){const{data:v}=await ce.from("live_carts").select("live_customer:live_customers(instagram_handle)").eq("id",f).single();if((g=v==null?void 0:v.live_customer)!=null&&g.instagram_handle){const{data:x}=await ce.from("live_carts").select("id").eq("live_customers.instagram_handle",v.live_customer.instagram_handle);x&&x.length>0&&(m=m.in("live_cart_id",x.map(y=>y.id)))}}const{count:p}=await m;return(p||0)<u.max_per_customer},[]),s=P.useCallback(u=>u.max_total_awards?u.current_awards_count<u.max_total_awards:!0,[]),a=P.useCallback(async(u,h)=>{const f=u.gift;if(!f)return!1;if(!f.unlimited_stock&&f.stock_qty<u.gift_qty)return console.log(`Gift ${f.name} out of stock`),!1;if(h.simulateOnly)return!0;try{const{error:m}=await ce.from("order_gifts").insert({order_id:h.orderId||null,live_cart_id:h.liveCartId||null,gift_id:f.id,qty:u.gift_qty,status:"pending_separation",applied_by_rule_id:u.id});if(m)throw m;return await ce.rpc("decrement_gift_stock",{p_gift_id:f.id,p_qty:u.gift_qty}),await ce.rpc("increment_gift_rule_awards",{p_rule_id:u.id,p_qty:1}),!0}catch(m){return console.error("Error applying gift:",m),!1}},[]),i=P.useCallback(async u=>{const h=[];try{const f=await e(u);for(const m of f){if(!await t(m,u))continue;if(!u.simulateOnly){if(!await r(m,u.customerId,u.liveCartId)||!s(m))continue;const y=ce.from("order_gifts").select("id").eq("gift_id",m.gift_id).eq("applied_by_rule_id",m.id);u.orderId?y.eq("order_id",u.orderId):u.liveCartId&&y.eq("live_cart_id",u.liveCartId);const{data:b}=await y;if(b&&b.length>0)continue}await a(m,u)&&m.gift&&h.push({giftId:m.gift.id,giftName:m.gift.name,giftImage:m.gift.image_url,ruleId:m.id,qty:m.gift_qty})}!u.simulateOnly&&h.length>0&&de.success(` Brinde aplicado: ${h.map(m=>m.giftName).join(", ")}`)}catch(f){console.error("Error evaluating gifts:",f)}return h},[e,t,r,s,a]),o=P.useCallback(async u=>{try{let h=ce.from("order_gifts").select(`
          id,
          gift_id,
          applied_by_rule_id,
          gift_rule:gift_rules(*)
        `).not("applied_by_rule_id","is",null);u.orderId?h=h.eq("order_id",u.orderId):u.liveCartId&&(h=h.eq("live_cart_id",u.liveCartId));const{data:f}=await h;if(!f||f.length===0)return;for(const m of f){const p=m.gift_rule;if(!p)continue;await t(p,u)||(await ce.from("order_gifts").update({status:"removed"}).eq("id",m.id),await ce.rpc("decrement_gift_stock",{p_gift_id:m.gift_id,p_qty:-1}),de.info("Brinde removido (condio no atendida)"))}}catch(h){console.error("Error reevaluating gifts:",h)}},[t]),c=P.useCallback(async(u,h)=>{let f=ce.from("order_gifts").select(`
        *,
        gift:gifts(*),
        gift_rule:gift_rules(*)
      `).neq("status","removed");if(u)f=f.eq("order_id",u);else if(h)f=f.eq("live_cart_id",h);else return[];const{data:m,error:p}=await f;return p?(console.error("Error fetching applied gifts:",p),[]):m||[]},[]),d=P.useCallback(async u=>{const{data:h,error:f}=await ce.from("order_gifts").select(`
        id,
        gift_id,
        qty,
        status,
        applied_by_rule_id,
        applied_by_raffle_id,
        gift:gifts(id, name, image_url, sku)
      `).eq("live_cart_id",u).neq("status","removed");return f?(console.error("Error fetching live cart gifts:",f),[]):h||[]},[]),l=P.useCallback(async(u,h,f,m)=>{try{const{error:p}=await ce.from("order_gifts").insert({live_cart_id:u,gift_id:h,qty:1,status:"pending_separation",applied_by_rule_id:f==="rule"?m:null,applied_by_raffle_id:f==="raffle"?m:null});if(p)throw p;return await ce.rpc("decrement_gift_stock",{p_gift_id:h,p_qty:1}),!0}catch(p){return console.error("Error adding gift to cart:",p),!1}},[]);return{evaluateAndApplyGifts:i,reevaluateGifts:o,getAppliedGifts:c,getLiveCartGifts:d,addGiftToLiveCart:l}}const NV=P.createContext(void 0),mR="loja_cart";function Fhe({children:e}){const[t,r]=P.useState(()=>{if(typeof window<"u"){const f=localStorage.getItem(mR);if(f)try{return JSON.parse(f).map(p=>({...p,originalPrice:p.originalPrice??p.price,discountPercent:p.discountPercent??0}))}catch{return[]}}return[]}),{evaluateAndApplyGifts:s}=$he(),[a,i]=P.useState([]);P.useEffect(()=>{localStorage.setItem(mR,JSON.stringify(t))},[t]);const o=t.reduce((f,m)=>f+m.price*m.quantity,0),c=t.reduce((f,m)=>f+m.quantity,0);P.useEffect(()=>{(async()=>{if(o>0){const p=(await s({channel:"catalog",cartTotal:o,simulateOnly:!0})).map(g=>({productId:g.giftId,name:g.giftName,price:0,originalPrice:0,discountPercent:100,size:"nico",quantity:g.qty,imageUrl:g.giftImage,isGift:!0}));i(p)}else i([])})()},[o,s]);const d=f=>{r(m=>m.find(g=>g.productId===f.productId&&g.size===f.size)?m.map(g=>g.productId===f.productId&&g.size===f.size?{...g,quantity:g.quantity+1}:g):[...m,{...f,quantity:1}])},l=(f,m)=>{r(p=>p.filter(g=>!(g.productId===f&&g.size===m)))},u=(f,m,p)=>{if(p<=0){l(f,m);return}r(g=>g.map(v=>v.productId===f&&v.size===m?{...v,quantity:p}:v))},h=()=>r([]);return n.jsx(NV.Provider,{value:{items:t,addItem:d,removeItem:l,updateQuantity:u,clearCart:h,total:o,itemCount:c,gifts:a},children:e})}function Wu(){const e=P.useContext(NV);if(!e)throw new Error("useCart must be used within a CartProvider");return e}const hd="/assets/logo-lepoa-sOM5Pm3c.png",sv=pg("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),he=P.forwardRef(({className:e,variant:t,size:r,asChild:s=!1,...a},i)=>{const o=s?use:"button";return n.jsx(o,{className:We(sv({variant:t,size:r,className:e})),ref:i,...a})});he.displayName="Button";var p3="focusScope.autoFocusOnMount",g3="focusScope.autoFocusOnUnmount",pR={bubbles:!1,cancelable:!0},zhe="FocusScope",y1=P.forwardRef((e,t)=>{const{loop:r=!1,trapped:s=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=e,[c,d]=P.useState(null),l=Ws(a),u=Ws(i),h=P.useRef(null),f=Ir(t,g=>d(g)),m=P.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;P.useEffect(()=>{if(s){let g=function(b){if(m.paused||!c)return;const j=b.target;c.contains(j)?h.current=j:Fd(h.current,{select:!0})},v=function(b){if(m.paused||!c)return;const j=b.relatedTarget;j!==null&&(c.contains(j)||Fd(h.current,{select:!0}))},x=function(b){if(document.activeElement===document.body)for(const T of b)T.removedNodes.length>0&&Fd(c)};document.addEventListener("focusin",g),document.addEventListener("focusout",v);const y=new MutationObserver(x);return c&&y.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",v),y.disconnect()}}},[s,c,m.paused]),P.useEffect(()=>{if(c){xR.add(m);const g=document.activeElement;if(!c.contains(g)){const x=new CustomEvent(p3,pR);c.addEventListener(p3,l),c.dispatchEvent(x),x.defaultPrevented||(Uhe(Ghe(SV(c)),{select:!0}),document.activeElement===g&&Fd(c))}return()=>{c.removeEventListener(p3,l),setTimeout(()=>{const x=new CustomEvent(g3,pR);c.addEventListener(g3,u),c.dispatchEvent(x),x.defaultPrevented||Fd(g??document.body,{select:!0}),c.removeEventListener(g3,u),xR.remove(m)},0)}}},[c,l,u,m]);const p=P.useCallback(g=>{if(!r&&!s||m.paused)return;const v=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,x=document.activeElement;if(v&&x){const y=g.currentTarget,[b,j]=Vhe(y);b&&j?!g.shiftKey&&x===j?(g.preventDefault(),r&&Fd(b,{select:!0})):g.shiftKey&&x===b&&(g.preventDefault(),r&&Fd(j,{select:!0})):x===y&&g.preventDefault()}},[r,s,m.paused]);return n.jsx(er.div,{tabIndex:-1,...o,ref:f,onKeyDown:p})});y1.displayName=zhe;function Uhe(e,{select:t=!1}={}){const r=document.activeElement;for(const s of e)if(Fd(s,{select:t}),document.activeElement!==r)return}function Vhe(e){const t=SV(e),r=gR(t,e),s=gR(t.reverse(),e);return[r,s]}function SV(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{const a=s.tagName==="INPUT"&&s.type==="hidden";return s.disabled||s.hidden||a?NodeFilter.FILTER_SKIP:s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function gR(e,t){for(const r of e)if(!qhe(r,{upTo:t}))return r}function qhe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Whe(e){return e instanceof HTMLInputElement&&"select"in e}function Fd(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&Whe(e)&&t&&e.select()}}var xR=Hhe();function Hhe(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=vR(e,t),e.unshift(t)},remove(t){var r;e=vR(e,t),(r=e[0])==null||r.resume()}}}function vR(e,t){const r=[...e],s=r.indexOf(t);return s!==-1&&r.splice(s,1),r}function Ghe(e){return e.filter(t=>t.tagName!=="A")}var x3=0;function L_(){P.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??yR()),document.body.insertAdjacentElement("beforeend",e[1]??yR()),x3++,()=>{x3===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),x3--}},[])}function yR(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Rb="right-scroll-bar-position",Mb="width-before-scroll-bar",Khe="with-scroll-bars-hidden",Xhe="--removed-body-scroll-bar-size";function v3(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Yhe(e,t){var r=P.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(s){var a=r.value;a!==s&&(r.value=s,r.callback(s,a))}}}})[0];return r.callback=t,r.facade}var Zhe=typeof window<"u"?P.useLayoutEffect:P.useEffect,bR=new WeakMap;function Qhe(e,t){var r=Yhe(null,function(s){return e.forEach(function(a){return v3(a,s)})});return Zhe(function(){var s=bR.get(r);if(s){var a=new Set(s),i=new Set(e),o=r.current;a.forEach(function(c){i.has(c)||v3(c,null)}),i.forEach(function(c){a.has(c)||v3(c,o)})}bR.set(r,e)},[e]),r}function Jhe(e){return e}function efe(e,t){t===void 0&&(t=Jhe);var r=[],s=!1,a={read:function(){if(s)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(i){var o=t(i,s);return r.push(o),function(){r=r.filter(function(c){return c!==o})}},assignSyncMedium:function(i){for(s=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(c){return i(c)},filter:function(){return r}}},assignMedium:function(i){s=!0;var o=[];if(r.length){var c=r;r=[],c.forEach(i),o=r}var d=function(){var u=o;o=[],u.forEach(i)},l=function(){return Promise.resolve().then(d)};l(),r={push:function(u){o.push(u),l()},filter:function(u){return o=o.filter(u),r}}}};return a}function tfe(e){e===void 0&&(e={});var t=efe(null);return t.options=Jl({async:!0,ssr:!1},e),t}var CV=function(e){var t=e.sideCar,r=_g(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var s=t.read();if(!s)throw new Error("Sidecar medium not found");return P.createElement(s,Jl({},r))};CV.isSideCarExport=!0;function rfe(e,t){return e.useMedium(t),CV}var EV=tfe(),y3=function(){},B_=P.forwardRef(function(e,t){var r=P.useRef(null),s=P.useState({onScrollCapture:y3,onWheelCapture:y3,onTouchMoveCapture:y3}),a=s[0],i=s[1],o=e.forwardProps,c=e.children,d=e.className,l=e.removeScrollBar,u=e.enabled,h=e.shards,f=e.sideCar,m=e.noRelative,p=e.noIsolation,g=e.inert,v=e.allowPinchZoom,x=e.as,y=x===void 0?"div":x,b=e.gapMode,j=_g(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),T=f,O=Qhe([r,t]),R=Jl(Jl({},j),a);return P.createElement(P.Fragment,null,u&&P.createElement(T,{sideCar:EV,removeScrollBar:l,shards:h,noRelative:m,noIsolation:p,inert:g,setCallbacks:i,allowPinchZoom:!!v,lockRef:r,gapMode:b}),o?P.cloneElement(P.Children.only(c),Jl(Jl({},R),{ref:O})):P.createElement(y,Jl({},R,{className:d,ref:O}),c))});B_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};B_.classNames={fullWidth:Mb,zeroRight:Rb};var nfe=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function sfe(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=nfe();return t&&e.setAttribute("nonce",t),e}function afe(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function ife(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var ofe=function(){var e=0,t=null;return{add:function(r){e==0&&(t=sfe())&&(afe(t,r),ife(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},lfe=function(){var e=ofe();return function(t,r){P.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},kV=function(){var e=lfe(),t=function(r){var s=r.styles,a=r.dynamic;return e(s,a),null};return t},cfe={left:0,top:0,right:0,gap:0},b3=function(e){return parseInt(e||"",10)||0},dfe=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],s=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[b3(r),b3(s),b3(a)]},ufe=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return cfe;var t=dfe(e),r=document.documentElement.clientWidth,s=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,s-r+t[2]-t[0])}},hfe=kV(),Km="data-scroll-locked",ffe=function(e,t,r,s){var a=e.left,i=e.top,o=e.right,c=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(Khe,` {
   overflow: hidden `).concat(s,`;
   padding-right: `).concat(c,"px ").concat(s,`;
  }
  body[`).concat(Km,`] {
    overflow: hidden `).concat(s,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(s,";"),r==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(s,`;
    `),r==="padding"&&"padding-right: ".concat(c,"px ").concat(s,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Rb,` {
    right: `).concat(c,"px ").concat(s,`;
  }
  
  .`).concat(Mb,` {
    margin-right: `).concat(c,"px ").concat(s,`;
  }
  
  .`).concat(Rb," .").concat(Rb,` {
    right: 0 `).concat(s,`;
  }
  
  .`).concat(Mb," .").concat(Mb,` {
    margin-right: 0 `).concat(s,`;
  }
  
  body[`).concat(Km,`] {
    `).concat(Xhe,": ").concat(c,`px;
  }
`)},wR=function(){var e=parseInt(document.body.getAttribute(Km)||"0",10);return isFinite(e)?e:0},mfe=function(){P.useEffect(function(){return document.body.setAttribute(Km,(wR()+1).toString()),function(){var e=wR()-1;e<=0?document.body.removeAttribute(Km):document.body.setAttribute(Km,e.toString())}},[])},pfe=function(e){var t=e.noRelative,r=e.noImportant,s=e.gapMode,a=s===void 0?"margin":s;mfe();var i=P.useMemo(function(){return ufe(a)},[a]);return P.createElement(hfe,{styles:ffe(i,!t,a,r?"":"!important")})},_C=!1;if(typeof window<"u")try{var Oy=Object.defineProperty({},"passive",{get:function(){return _C=!0,!0}});window.addEventListener("test",Oy,Oy),window.removeEventListener("test",Oy,Oy)}catch{_C=!1}var Yf=_C?{passive:!1}:!1,gfe=function(e){return e.tagName==="TEXTAREA"},AV=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!gfe(e)&&r[t]==="visible")},xfe=function(e){return AV(e,"overflowY")},vfe=function(e){return AV(e,"overflowX")},_R=function(e,t){var r=t.ownerDocument,s=t;do{typeof ShadowRoot<"u"&&s instanceof ShadowRoot&&(s=s.host);var a=TV(e,s);if(a){var i=PV(e,s),o=i[1],c=i[2];if(o>c)return!0}s=s.parentNode}while(s&&s!==r.body);return!1},yfe=function(e){var t=e.scrollTop,r=e.scrollHeight,s=e.clientHeight;return[t,r,s]},bfe=function(e){var t=e.scrollLeft,r=e.scrollWidth,s=e.clientWidth;return[t,r,s]},TV=function(e,t){return e==="v"?xfe(t):vfe(t)},PV=function(e,t){return e==="v"?yfe(t):bfe(t)},wfe=function(e,t){return e==="h"&&t==="rtl"?-1:1},_fe=function(e,t,r,s,a){var i=wfe(e,window.getComputedStyle(t).direction),o=i*s,c=r.target,d=t.contains(c),l=!1,u=o>0,h=0,f=0;do{if(!c)break;var m=PV(e,c),p=m[0],g=m[1],v=m[2],x=g-v-i*p;(p||x)&&TV(e,c)&&(h+=x,f+=p);var y=c.parentNode;c=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!d&&c!==document.body||d&&(t.contains(c)||t===c));return(u&&(Math.abs(h)<1||!a)||!u&&(Math.abs(f)<1||!a))&&(l=!0),l},Ry=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},jR=function(e){return[e.deltaX,e.deltaY]},NR=function(e){return e&&"current"in e?e.current:e},jfe=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Nfe=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Sfe=0,Zf=[];function Cfe(e){var t=P.useRef([]),r=P.useRef([0,0]),s=P.useRef(),a=P.useState(Sfe++)[0],i=P.useState(kV)[0],o=P.useRef(e);P.useEffect(function(){o.current=e},[e]),P.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var g=ade([e.lockRef.current],(e.shards||[]).map(NR),!0).filter(Boolean);return g.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),g.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var c=P.useCallback(function(g,v){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!o.current.allowPinchZoom;var x=Ry(g),y=r.current,b="deltaX"in g?g.deltaX:y[0]-x[0],j="deltaY"in g?g.deltaY:y[1]-x[1],T,O=g.target,R=Math.abs(b)>Math.abs(j)?"h":"v";if("touches"in g&&R==="h"&&O.type==="range")return!1;var D=_R(R,O);if(!D)return!0;if(D?T=R:(T=R==="v"?"h":"v",D=_R(R,O)),!D)return!1;if(!s.current&&"changedTouches"in g&&(b||j)&&(s.current=T),!T)return!0;var L=s.current||T;return _fe(L,v,g,L==="h"?b:j,!0)},[]),d=P.useCallback(function(g){var v=g;if(!(!Zf.length||Zf[Zf.length-1]!==i)){var x="deltaY"in v?jR(v):Ry(v),y=t.current.filter(function(T){return T.name===v.type&&(T.target===v.target||v.target===T.shadowParent)&&jfe(T.delta,x)})[0];if(y&&y.should){v.cancelable&&v.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(NR).filter(Boolean).filter(function(T){return T.contains(v.target)}),j=b.length>0?c(v,b[0]):!o.current.noIsolation;j&&v.cancelable&&v.preventDefault()}}},[]),l=P.useCallback(function(g,v,x,y){var b={name:g,delta:v,target:x,should:y,shadowParent:Efe(x)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(j){return j!==b})},1)},[]),u=P.useCallback(function(g){r.current=Ry(g),s.current=void 0},[]),h=P.useCallback(function(g){l(g.type,jR(g),g.target,c(g,e.lockRef.current))},[]),f=P.useCallback(function(g){l(g.type,Ry(g),g.target,c(g,e.lockRef.current))},[]);P.useEffect(function(){return Zf.push(i),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",d,Yf),document.addEventListener("touchmove",d,Yf),document.addEventListener("touchstart",u,Yf),function(){Zf=Zf.filter(function(g){return g!==i}),document.removeEventListener("wheel",d,Yf),document.removeEventListener("touchmove",d,Yf),document.removeEventListener("touchstart",u,Yf)}},[]);var m=e.removeScrollBar,p=e.inert;return P.createElement(P.Fragment,null,p?P.createElement(i,{styles:Nfe(a)}):null,m?P.createElement(pfe,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function Efe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const kfe=rfe(EV,Cfe);var b1=P.forwardRef(function(e,t){return P.createElement(B_,Jl({},e,{ref:t,sideCar:kfe}))});b1.classNames=B_.classNames;var Afe=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Qf=new WeakMap,My=new WeakMap,Iy={},w3=0,OV=function(e){return e&&(e.host||OV(e.parentNode))},Tfe=function(e,t){return t.map(function(r){if(e.contains(r))return r;var s=OV(r);return s&&e.contains(s)?s:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},Pfe=function(e,t,r,s){var a=Tfe(t,Array.isArray(e)?e:[e]);Iy[r]||(Iy[r]=new WeakMap);var i=Iy[r],o=[],c=new Set,d=new Set(a),l=function(h){!h||c.has(h)||(c.add(h),l(h.parentNode))};a.forEach(l);var u=function(h){!h||d.has(h)||Array.prototype.forEach.call(h.children,function(f){if(c.has(f))u(f);else try{var m=f.getAttribute(s),p=m!==null&&m!=="false",g=(Qf.get(f)||0)+1,v=(i.get(f)||0)+1;Qf.set(f,g),i.set(f,v),o.push(f),g===1&&p&&My.set(f,!0),v===1&&f.setAttribute(r,"true"),p||f.setAttribute(s,"true")}catch(x){console.error("aria-hidden: cannot operate on ",f,x)}})};return u(t),c.clear(),w3++,function(){o.forEach(function(h){var f=Qf.get(h)-1,m=i.get(h)-1;Qf.set(h,f),i.set(h,m),f||(My.has(h)||h.removeAttribute(s),My.delete(h)),m||h.removeAttribute(r)}),w3--,w3||(Qf=new WeakMap,Qf=new WeakMap,My=new WeakMap,Iy={})}},$_=function(e,t,r){r===void 0&&(r="data-aria-hidden");var s=Array.from(Array.isArray(e)?e:[e]),a=Afe(e);return a?(s.push.apply(s,Array.from(a.querySelectorAll("[aria-live]"))),Pfe(s,a,r,"aria-hidden")):function(){return null}},F_="Dialog",[RV,MV]=ta(F_),[Ofe,Il]=RV(F_),IV=e=>{const{__scopeDialog:t,children:r,open:s,defaultOpen:a,onOpenChange:i,modal:o=!0}=e,c=P.useRef(null),d=P.useRef(null),[l,u]=Yi({prop:s,defaultProp:a??!1,onChange:i,caller:F_});return n.jsx(Ofe,{scope:t,triggerRef:c,contentRef:d,contentId:xa(),titleId:xa(),descriptionId:xa(),open:l,onOpenChange:u,onOpenToggle:P.useCallback(()=>u(h=>!h),[u]),modal:o,children:r})};IV.displayName=F_;var DV="DialogTrigger",LV=P.forwardRef((e,t)=>{const{__scopeDialog:r,...s}=e,a=Il(DV,r),i=Ir(t,a.triggerRef);return n.jsx(er.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Lk(a.open),...s,ref:i,onClick:kt(e.onClick,a.onOpenToggle)})});LV.displayName=DV;var Ik="DialogPortal",[Rfe,BV]=RV(Ik,{forceMount:void 0}),$V=e=>{const{__scopeDialog:t,forceMount:r,children:s,container:a}=e,i=Il(Ik,t);return n.jsx(Rfe,{scope:t,forceMount:r,children:P.Children.map(s,o=>n.jsx(Gs,{present:r||i.open,children:n.jsx(mg,{asChild:!0,container:a,children:o})}))})};$V.displayName=Ik;var Ew="DialogOverlay",FV=P.forwardRef((e,t)=>{const r=BV(Ew,e.__scopeDialog),{forceMount:s=r.forceMount,...a}=e,i=Il(Ew,e.__scopeDialog);return i.modal?n.jsx(Gs,{present:s||i.open,children:n.jsx(Ife,{...a,ref:t})}):null});FV.displayName=Ew;var Mfe=Eu("DialogOverlay.RemoveScroll"),Ife=P.forwardRef((e,t)=>{const{__scopeDialog:r,...s}=e,a=Il(Ew,r);return n.jsx(b1,{as:Mfe,allowPinchZoom:!0,shards:[a.contentRef],children:n.jsx(er.div,{"data-state":Lk(a.open),...s,ref:t,style:{pointerEvents:"auto",...s.style}})})}),lf="DialogContent",zV=P.forwardRef((e,t)=>{const r=BV(lf,e.__scopeDialog),{forceMount:s=r.forceMount,...a}=e,i=Il(lf,e.__scopeDialog);return n.jsx(Gs,{present:s||i.open,children:i.modal?n.jsx(Dfe,{...a,ref:t}):n.jsx(Lfe,{...a,ref:t})})});zV.displayName=lf;var Dfe=P.forwardRef((e,t)=>{const r=Il(lf,e.__scopeDialog),s=P.useRef(null),a=Ir(t,r.contentRef,s);return P.useEffect(()=>{const i=s.current;if(i)return $_(i)},[]),n.jsx(UV,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:kt(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=r.triggerRef.current)==null||o.focus()}),onPointerDownOutside:kt(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,c=o.button===0&&o.ctrlKey===!0;(o.button===2||c)&&i.preventDefault()}),onFocusOutside:kt(e.onFocusOutside,i=>i.preventDefault())})}),Lfe=P.forwardRef((e,t)=>{const r=Il(lf,e.__scopeDialog),s=P.useRef(!1),a=P.useRef(!1);return n.jsx(UV,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,c;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(s.current||(c=r.triggerRef.current)==null||c.focus(),i.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:i=>{var d,l;(d=e.onInteractOutside)==null||d.call(e,i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((l=r.triggerRef.current)==null?void 0:l.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),UV=P.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,...o}=e,c=Il(lf,r),d=P.useRef(null),l=Ir(t,d);return L_(),n.jsxs(n.Fragment,{children:[n.jsx(y1,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:i,children:n.jsx(Fu,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":Lk(c.open),...o,ref:l,onDismiss:()=>c.onOpenChange(!1)})}),n.jsxs(n.Fragment,{children:[n.jsx($fe,{titleId:c.titleId}),n.jsx(zfe,{contentRef:d,descriptionId:c.descriptionId})]})]})}),Dk="DialogTitle",VV=P.forwardRef((e,t)=>{const{__scopeDialog:r,...s}=e,a=Il(Dk,r);return n.jsx(er.h2,{id:a.titleId,...s,ref:t})});VV.displayName=Dk;var qV="DialogDescription",WV=P.forwardRef((e,t)=>{const{__scopeDialog:r,...s}=e,a=Il(qV,r);return n.jsx(er.p,{id:a.descriptionId,...s,ref:t})});WV.displayName=qV;var HV="DialogClose",GV=P.forwardRef((e,t)=>{const{__scopeDialog:r,...s}=e,a=Il(HV,r);return n.jsx(er.button,{type:"button",...s,ref:t,onClick:kt(e.onClick,()=>a.onOpenChange(!1))})});GV.displayName=HV;function Lk(e){return e?"open":"closed"}var KV="DialogTitleWarning",[Bfe,XV]=cse(KV,{contentName:lf,titleName:Dk,docsSlug:"dialog"}),$fe=({titleId:e})=>{const t=XV(KV),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return P.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},Ffe="DialogDescriptionWarning",zfe=({contentRef:e,descriptionId:t})=>{const s=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${XV(Ffe).contentName}}.`;return P.useEffect(()=>{var i;const a=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(s))},[s,e,t]),null},w1=IV,z_=LV,_1=$V,Tf=FV,Pf=zV,jg=VV,Ng=WV,j1=GV;const Tu=w1,Bk=z_,Ufe=_1,YV=P.forwardRef(({className:e,...t},r)=>n.jsx(Tf,{className:We("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));YV.displayName=Tf.displayName;const Vfe=pg("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500 overflow-y-auto",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top max-h-[85vh]",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom max-h-[85vh]",left:"inset-y-0 left-0 h-full w-[min(92vw,320px)] sm:w-[min(92vw,360px)] max-w-full border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left",right:"inset-y-0 right-0 h-full w-[min(92vw,320px)] sm:w-[min(92vw,400px)] max-w-full border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right"}},defaultVariants:{side:"right"}}),fd=P.forwardRef(({side:e="right",className:t,children:r,...s},a)=>n.jsxs(Ufe,{children:[n.jsx(YV,{}),n.jsxs(Pf,{ref:a,className:We(Vfe({side:e}),t),...s,children:[r,n.jsxs(j1,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[n.jsx(an,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));fd.displayName=Pf.displayName;const Pu=({className:e,...t})=>n.jsx("div",{className:We("flex flex-col space-y-2 text-center sm:text-left",e),...t});Pu.displayName="SheetHeader";const ZV=({className:e,...t})=>n.jsx("div",{className:We("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});ZV.displayName="SheetFooter";const cf=P.forwardRef(({className:e,...t},r)=>n.jsx(jg,{ref:r,className:We("text-lg font-semibold text-foreground",e),...t}));cf.displayName=jg.displayName;const qfe=P.forwardRef(({className:e,...t},r)=>n.jsx(Ng,{ref:r,className:We("text-sm text-muted-foreground",e),...t}));qfe.displayName=Ng.displayName;function SR(){const e=fr(),{itemCount:t}=Wu();return n.jsxs(he,{variant:"ghost",size:"icon",className:"relative",onClick:()=>e("/carrinho"),"aria-label":"Ver carrinho",children:[n.jsx(ln,{className:"h-5 w-5"}),t>0&&n.jsx("span",{className:"absolute -top-1 -right-1 h-5 w-5 rounded-full bg-accent text-accent-foreground text-xs flex items-center justify-center font-medium",children:t>9?"9+":t})]})}const Wfe="5562991223519";function No(e,t){let r,s;t===void 0?(r=Wfe,s=e):(r=e,s=t);const a=Hfe(r),i=encodeURIComponent(s);return`https://wa.me/${a}?text=${i}`}function Hfe(e){const t=e.replace(/\D/g,"");return t.startsWith("55")&&t.length===13?t:t.length===11?`55${t}`:t}function QV(e){return e?e.replace(/@/g,"").replace(/\s/g,"").toLowerCase().trim():""}function kw(e){if(!e)return"";const t=QV(e);return t?`@${t}`:""}function JV(e){const t=QV(e);return t?`https://www.instagram.com/${t}`:null}function av(e,t){return`Oi, tudo bem? 
Aqui  da LE.PO. Muito obrigada por participar da nossa Live Shop.

${t?`Sua sacola #${t} j est pronta.`:"Sua sacola j est pronta."}
Para manter tudo organizado, pedimos que finalize seu pedido pelo link abaixo:
 ${e}

Qualquer dvida, fico  disposio.`}function Gfe(e,t,r){const s=t.map(a=>{let i=`${a.name} tam ${a.size}`;return a.color&&(i+=` (${a.color})`),i+=` x${a.quantity}`,i}).join(", ");return`Oi! Quero ajuda com meu pedido #${e}. Itens: ${s}. Total: ${r}.`}function Kfe(e){return`Oi! Quero falar sobre o pedido #${e}.`}function Xfe(){return"Oi! Vim pelo Provador VIP e queria tirar uma dvida "}function Cr({showCart:e=!0}){const t=No(Xfe());return n.jsx("header",{className:"sticky top-0 z-50 bg-background/80 backdrop-blur-lg border-b border-gold/10",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 h-14 sm:h-16 flex items-center justify-between gap-2",children:[n.jsx(Gt,{to:"/",className:"flex items-center shrink-0",children:n.jsx("img",{src:hd,alt:"LE.PO",className:"h-7 sm:h-10 w-auto max-w-[100px] sm:max-w-none"})}),n.jsxs("nav",{className:"hidden md:flex items-center gap-6 lg:gap-8",children:[n.jsx(Gt,{to:"/catalogo",className:"text-[10px] tracking-[0.25em] uppercase font-bold text-primary/60 hover:text-gold transition-colors whitespace-nowrap",children:"Colees"}),n.jsx(Gt,{to:"/meu-estilo",className:"text-[10px] tracking-[0.25em] uppercase font-bold text-primary/60 hover:text-gold transition-colors whitespace-nowrap",children:"Meu Estilo"}),n.jsx(Gt,{to:"/enviar-print",className:"text-[10px] tracking-[0.25em] uppercase font-bold text-primary/60 hover:text-gold transition-colors whitespace-nowrap",children:"Buscar Look"}),n.jsx("div",{className:"h-6 w-px bg-gold/10 mx-2"}),e&&n.jsx(SR,{}),n.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",children:n.jsxs(he,{variant:"ghost",size:"sm",className:"text-gold hover:text-gold hover:bg-gold/5 flex items-center gap-2 px-4 rounded-full border border-gold/20",children:[n.jsx(nn,{className:"h-4 w-4"}),n.jsx("span",{className:"text-[10px] tracking-widest uppercase font-bold",children:"Atendimento"})]})}),n.jsx(Gt,{to:"/minha-conta",children:n.jsx(he,{variant:"ghost",size:"icon",className:"h-10 w-10 text-primary/40 hover:text-primary transition-all rounded-full bg-primary/5",children:n.jsx(Wn,{className:"h-5 w-5"})})})]}),n.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 md:hidden",children:[e&&n.jsx(SR,{}),n.jsxs(Tu,{children:[n.jsx(Bk,{asChild:!0,children:n.jsx(he,{variant:"ghost",size:"icon",className:"h-9 w-9",children:n.jsx(eU,{className:"h-5 w-5"})})}),n.jsx(fd,{side:"right",className:"w-[min(92vw,360px)] p-0 bg-background border-l border-gold/10",children:n.jsxs("div",{className:"flex flex-col h-full bg-background",children:[n.jsx("div",{className:"p-8 border-b border-gold/10 text-center",children:n.jsx("img",{src:hd,alt:"LE.PO",className:"h-8 mx-auto"})}),n.jsxs("nav",{className:"flex flex-col flex-1 px-8 py-10 gap-8",children:[n.jsxs(Gt,{to:"/catalogo",className:"group",children:[n.jsx("span",{className:"text-[10px] tracking-[0.3em] uppercase text-primary/40 group-hover:text-gold block mb-1 transition-colors",children:"Ver Colees"}),n.jsx("span",{className:"font-serif text-3xl italic text-primary lowercase",children:"Catlogo 2024"})]}),n.jsxs(Gt,{to:"/meu-estilo",className:"group",children:[n.jsx("span",{className:"text-[10px] tracking-[0.3em] uppercase text-primary/40 group-hover:text-gold block mb-1 transition-colors",children:"rea VIP"}),n.jsx("span",{className:"font-serif text-3xl italic text-primary lowercase",children:"Meu Estilo"})]}),n.jsxs(Gt,{to:"/enviar-print",className:"group",children:[n.jsx("span",{className:"text-[10px] tracking-[0.3em] uppercase text-primary/40 group-hover:text-gold block mb-1 transition-colors",children:"Busca Inteligente"}),n.jsx("span",{className:"font-serif text-3xl italic text-primary lowercase",children:"Buscar por Foto"})]}),n.jsx("div",{className:"h-px bg-gold/10 w-full my-4"}),n.jsxs("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-between group",children:[n.jsx("span",{className:"font-serif text-xl italic text-gold lowercase",children:"Personal Stylist"}),n.jsx(nn,{className:"h-5 w-5 text-gold"})]})]}),n.jsx("div",{className:"p-8 mt-auto",children:n.jsx(Gt,{to:"/minha-conta",children:n.jsxs(he,{className:"w-full h-14 rounded-full btn-gold text-white text-[10px] tracking-[0.2em] font-bold uppercase shadow-xl",children:[n.jsx(Wn,{className:"h-4 w-4 mr-2"}),"Minha Conta"]})})})]})})]})]})]})})}const Yfe=[{icon:xs,text:"3x sem juros"},{icon:nn,text:"Atendimento no WhatsApp"},{icon:gn,text:"Envio para todo Brasil"}];function Xm(){return n.jsx("div",{className:"bg-primary text-primary-foreground py-2 text-center text-sm",children:n.jsx("div",{className:"container mx-auto flex flex-wrap items-center justify-center gap-x-4 gap-y-1 md:gap-8",children:Yfe.map((e,t)=>n.jsxs("div",{className:"flex items-center gap-1.5 text-[10px] md:text-sm tracking-wide uppercase font-medium",children:[n.jsx(e.icon,{className:"h-3 w-3 md:h-4 md:w-4"}),n.jsx("span",{children:e.text})]},t))})})}function Zfe(){const[e,t]=P.useState([]),[r,s]=P.useState(!0);return P.useEffect(()=>{async function a(){try{const{data:i,error:o}=await ce.rpc("get_weekly_trending_products");if(o)throw o;t(i||[])}catch(i){console.error("Error fetching trending products:",i)}finally{s(!1)}}a()},[]),{trendingProducts:e,isLoading:r}}function _p({name:e,price:t,effectivePrice:r,imageUrl:s,tags:a=[],sizes:i=[],badge:o,onAddToLook:c,isOutOfStock:d=!1,hasPromotionalDiscount:l=!1,discountPercent:u=0,discountType:h,discountValue:f}){const m=x=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(x);let p=t,g=!1,v=null;return r!==void 0&&r<t?(p=r,g=!0,v=u>0?`-${u}%`:`-R$ ${(t-r).toFixed(2)}`):h&&f&&f>0&&(g=!0,h==="percentage"?(p=t*(1-f/100),v=`-${f}%`):(p=Math.max(0,t-f),v=`-R$ ${f.toFixed(2)}`)),n.jsxs("div",{className:We("card-product group",d&&"opacity-60"),children:[n.jsxs("div",{className:"relative aspect-[3/4] overflow-hidden bg-secondary",children:[g&&v&&n.jsxs("span",{className:"absolute top-3 right-3 z-10 bg-gold text-white text-[10px] font-bold px-3 py-1 rounded-full flex items-center gap-1 shadow-lg",children:[n.jsx(Oa,{className:"h-3 w-3 shadow-sm"}),v]}),o&&n.jsx("span",{className:"badge-promo",children:o}),n.jsx("img",{src:s||"/placeholder.svg",alt:e,className:We("w-full h-full object-cover transition-transform duration-500",!d&&"group-hover:scale-105")}),n.jsx("div",{className:We("absolute inset-0 bg-gradient-to-t from-black/20 to-transparent transition-opacity",d?"opacity-30":"opacity-0 group-hover:opacity-100")})]}),n.jsxs("div",{className:"p-4 md:p-5 text-center",children:[n.jsx("h3",{className:"font-serif text-base md:text-lg line-clamp-2 mb-2 text-primary",children:e}),i.length>0&&n.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:["Tam: ",i.slice(0,4).join(", "),i.length>4?"...":""]}),n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("div",{className:"flex flex-col",children:g?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:We("font-bold text-lg md:text-xl text-primary",d&&"text-muted-foreground"),children:m(p)}),n.jsx("span",{className:"text-xs text-muted-foreground/60 line-through",children:m(t)})]}):n.jsx("span",{className:We("font-bold text-lg md:text-xl text-primary",d&&"text-muted-foreground"),children:m(t)})}),c&&!d&&n.jsx(he,{size:"sm",variant:"ghost",onClick:x=>{x.preventDefault(),c()},className:"h-10 w-10 rounded-full bg-secondary text-primary hover:bg-gold hover:text-white transition-all duration-300 p-0",children:n.jsx(ln,{className:"h-4 w-4"})})]})]})]})}function $k(e={}){const{channel:t="catalog",productIds:r,enabled:s=!0}=e,[a,i]=P.useState(new Map),[o,c]=P.useState(!0),[d,l]=P.useState(null),u=P.useCallback(async()=>{if(!s){c(!1);return}try{c(!0),l(null);const{data:y,error:b}=await ce.rpc("get_products_effective_prices",{p_channel:t,p_product_ids:r||null});if(b){console.error("[useEffectivePrices] RPC error:",b),l(b.message);return}const j=new Map;(y||[]).forEach(T=>{j.set(T.product_id,T)}),i(j)}catch(y){console.error("[useEffectivePrices] Error:",y),l(y instanceof Error?y.message:"Unknown error")}finally{c(!1)}},[t,r,s]);P.useEffect(()=>{u()},[u]);const h=P.useCallback((y,b)=>{const j=a.get(y);return(j==null?void 0:j.effective_price)??b},[a]),f=P.useCallback((y,b)=>{const j=a.get(y);return(j==null?void 0:j.original_price)??b},[a]),m=P.useCallback(y=>{const b=a.get(y);return b?b.effective_price<b.original_price:!1},[a]),p=P.useCallback(y=>{const b=a.get(y);return!b||b.effective_price>=b.original_price?0:Math.round((b.original_price-b.effective_price)/b.original_price*100)},[a]),g=P.useCallback(y=>{const b=a.get(y);return!b||!b.discount_type||b.effective_price>=b.original_price?null:b.discount_type==="percentage"&&b.discount_value?`-${b.discount_value}%`:b.discount_type==="fixed"&&b.discount_value?`-R$ ${b.discount_value.toFixed(2)}`:null},[a]),v=P.useCallback(y=>a.get(y)||null,[a]),x=P.useMemo(()=>Array.from(a.values()),[a]);return{priceData:a,allPriceData:x,isLoading:o,error:d,refetch:u,getEffectivePrice:h,getOriginalPrice:f,hasDiscount:m,getDiscountPercent:p,getDiscountLabel:g,getPromotionInfo:v}}function Qfe(e,t="catalog"){const[r,s]=P.useState(null),[a,i]=P.useState(!0);P.useEffect(()=>{if(!e){i(!1);return}async function d(){try{i(!0);const{data:l,error:u}=await ce.rpc("get_products_effective_prices",{p_channel:t,p_product_ids:[e]});if(u){console.error("[useSingleProductEffectivePrice] Error:",u);return}l&&l.length>0&&s(l[0])}catch(l){console.error("[useSingleProductEffectivePrice] Error:",l)}finally{i(!1)}}d()},[e,t]);const o=r?r.effective_price<r.original_price:!1,c=o&&r?Math.round((r.original_price-r.effective_price)/r.original_price*100):0;return{data:r,isLoading:a,effectivePrice:(r==null?void 0:r.effective_price)??0,originalPrice:(r==null?void 0:r.original_price)??0,hasDiscount:o,discountPercent:c,promotionName:(r==null?void 0:r.promotion_name)??null,discountSource:(r==null?void 0:r.discount_source)??null}}function N1(e){const[t,r]=P.useState(new Map),[s,a]=P.useState(!0),[i,o]=P.useState(null),c=P.useCallback(async()=>{try{a(!0);let v=ce.from("product_available_stock").select("*");e&&e.length>0&&(v=v.in("product_id",e));const{data:x,error:y}=await v;if(y)throw y;const b=new Map;(x||[]).forEach(j=>{b.has(j.product_id)||b.set(j.product_id,new Map),b.get(j.product_id).set(j.size,j)}),r(b),o(null)}catch(v){console.error("Error fetching available stock:",v),o(v)}finally{a(!1)}},[e==null?void 0:e.join(",")]);P.useEffect(()=>{c();const v=ce.channel("stock-changes-view").on("postgres_changes",{event:"*",schema:"public",table:"live_carts"},()=>c()).on("postgres_changes",{event:"*",schema:"public",table:"live_cart_items"},()=>c()).on("postgres_changes",{event:"*",schema:"public",table:"product_catalog"},()=>c()).on("postgres_changes",{event:"*",schema:"public",table:"orders"},()=>c()).subscribe();return()=>{ce.removeChannel(v)}},[c]);const d=P.useCallback((v,x)=>{const y=t.get(v);if(!y)return 0;const b=y.get(x);return(b==null?void 0:b.available)??0},[t]),l=P.useCallback(v=>{const x=t.get(v);if(!x)return[];const y=[];x.forEach((T,O)=>{T.available>0&&y.push(O)});const b=["34","36","38","40","42","44","46"],j=["PP","P","M","G","GG"];return y.sort((T,O)=>{const R=b.indexOf(T),D=b.indexOf(O),L=j.indexOf(T),q=j.indexOf(O);return R!==-1&&D!==-1?R-D:R!==-1?-1:D!==-1?1:L!==-1&&q!==-1?L-q:L!==-1?-1:q!==-1?1:T.localeCompare(O)})},[t]),u=P.useCallback((v,x)=>d(v,x)<=0,[d]),h=P.useCallback((v,x)=>{const y=d(v,x);return y>0&&y<=2},[d]),f=P.useCallback(v=>{const x=t.get(v);if(!x)return 0;let y=0;return x.forEach(b=>{y+=b.available}),y},[t]),m=P.useCallback(v=>f(v)<=0,[f]),p=P.useCallback((v,x)=>{const y=t.get(v);if(!y)return 0;const b=y.get(x);return(b==null?void 0:b.reserved)??0},[t]),g=P.useCallback(v=>{const x=t.get(v);if(!x)return 0;let y=0;return x.forEach(b=>{y+=b.reserved}),y},[t]);return{stockData:t,isLoading:s,error:i,refresh:c,getAvailable:d,getAvailableSizes:l,isSizeOutOfStock:u,isSizeLowStock:h,getReserved:p,getTotalAvailable:f,getTotalReserved:g,isProductOutOfStock:m}}function Jfe(e){const t=P.useMemo(()=>e?[e]:[],[e]),r=N1(t);return{...r,available:s=>e?r.getAvailable(e,s):0,availableSizes:e?r.getAvailableSizes(e):[],isOutOfStock:s=>e?r.isSizeOutOfStock(e,s):!0,isLowStock:s=>e?r.isSizeLowStock(e,s):!1,totalAvailable:e?r.getTotalAvailable(e):0,isProductOutOfStock:e?r.isProductOutOfStock(e):!0}}function eme(e){return Object.prototype.toString.call(e)==="[object Object]"}function CR(e){return eme(e)||Array.isArray(e)}function tme(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function Fk(e,t){const r=Object.keys(e),s=Object.keys(t);if(r.length!==s.length)return!1;const a=JSON.stringify(Object.keys(e.breakpoints||{})),i=JSON.stringify(Object.keys(t.breakpoints||{}));return a!==i?!1:r.every(o=>{const c=e[o],d=t[o];return typeof c=="function"?`${c}`==`${d}`:!CR(c)||!CR(d)?c===d:Fk(c,d)})}function ER(e){return e.concat().sort((t,r)=>t.name>r.name?1:-1).map(t=>t.options)}function rme(e,t){if(e.length!==t.length)return!1;const r=ER(e),s=ER(t);return r.every((a,i)=>{const o=s[i];return Fk(a,o)})}function zk(e){return typeof e=="number"}function jC(e){return typeof e=="string"}function U_(e){return typeof e=="boolean"}function kR(e){return Object.prototype.toString.call(e)==="[object Object]"}function ks(e){return Math.abs(e)}function Uk(e){return Math.sign(e)}function hx(e,t){return ks(e-t)}function nme(e,t){if(e===0||t===0||ks(e)<=ks(t))return 0;const r=hx(ks(e),ks(t));return ks(r/e)}function sme(e){return Math.round(e*100)/100}function iv(e){return ov(e).map(Number)}function kl(e){return e[S1(e)]}function S1(e){return Math.max(0,e.length-1)}function Vk(e,t){return t===S1(e)}function AR(e,t=0){return Array.from(Array(e),(r,s)=>t+s)}function ov(e){return Object.keys(e)}function eq(e,t){return[e,t].reduce((r,s)=>(ov(s).forEach(a=>{const i=r[a],o=s[a],c=kR(i)&&kR(o);r[a]=c?eq(i,o):o}),r),{})}function NC(e,t){return typeof t.MouseEvent<"u"&&e instanceof t.MouseEvent}function ame(e,t){const r={start:s,center:a,end:i};function s(){return 0}function a(d){return i(d)/2}function i(d){return t-d}function o(d,l){return jC(e)?r[e](d):e(t,d,l)}return{measure:o}}function lv(){let e=[];function t(a,i,o,c={passive:!0}){let d;if("addEventListener"in a)a.addEventListener(i,o,c),d=()=>a.removeEventListener(i,o,c);else{const l=a;l.addListener(o),d=()=>l.removeListener(o)}return e.push(d),s}function r(){e=e.filter(a=>a())}const s={add:t,clear:r};return s}function ime(e,t,r,s){const a=lv(),i=1e3/60;let o=null,c=0,d=0;function l(){a.add(e,"visibilitychange",()=>{e.hidden&&p()})}function u(){m(),a.clear()}function h(v){if(!d)return;o||(o=v,r(),r());const x=v-o;for(o=v,c+=x;c>=i;)r(),c-=i;const y=c/i;s(y),d&&(d=t.requestAnimationFrame(h))}function f(){d||(d=t.requestAnimationFrame(h))}function m(){t.cancelAnimationFrame(d),o=null,c=0,d=0}function p(){o=null,c=0}return{init:l,destroy:u,start:f,stop:m,update:r,render:s}}function ome(e,t){const r=t==="rtl",s=e==="y",a=s?"y":"x",i=s?"x":"y",o=!s&&r?-1:1,c=u(),d=h();function l(p){const{height:g,width:v}=p;return s?g:v}function u(){return s?"top":r?"right":"left"}function h(){return s?"bottom":r?"left":"right"}function f(p){return p*o}return{scroll:a,cross:i,startEdge:c,endEdge:d,measureSize:l,direction:f}}function df(e=0,t=0){const r=ks(e-t);function s(l){return l<e}function a(l){return l>t}function i(l){return s(l)||a(l)}function o(l){return i(l)?s(l)?e:t:l}function c(l){return r?l-r*Math.ceil((l-t)/r):l}return{length:r,max:t,min:e,constrain:o,reachedAny:i,reachedMax:a,reachedMin:s,removeOffset:c}}function tq(e,t,r){const{constrain:s}=df(0,e),a=e+1;let i=o(t);function o(f){return r?ks((a+f)%a):s(f)}function c(){return i}function d(f){return i=o(f),h}function l(f){return u().set(c()+f)}function u(){return tq(e,c(),r)}const h={get:c,set:d,add:l,clone:u};return h}function lme(e,t,r,s,a,i,o,c,d,l,u,h,f,m,p,g,v,x,y){const{cross:b,direction:j}=e,T=["INPUT","SELECT","TEXTAREA"],O={passive:!1},R=lv(),D=lv(),L=df(50,225).constrain(m.measure(20)),q={mouse:300,touch:400},X={mouse:500,touch:600},H=p?43:25;let M=!1,F=0,S=0,E=!1,N=!1,C=!1,k=!1;function I(oe){if(!y)return;function se(ye){(U_(y)||y(oe,ye))&&G(ye)}const le=t;R.add(le,"dragstart",ye=>ye.preventDefault(),O).add(le,"touchmove",()=>{},O).add(le,"touchend",()=>{}).add(le,"touchstart",se).add(le,"mousedown",se).add(le,"touchcancel",V).add(le,"contextmenu",V).add(le,"click",W,!0)}function U(){R.clear(),D.clear()}function $(){const oe=k?r:t;D.add(oe,"touchmove",J,O).add(oe,"touchend",V).add(oe,"mousemove",J,O).add(oe,"mouseup",V)}function Y(oe){const se=oe.nodeName||"";return T.includes(se)}function Z(){return(p?X:q)[k?"mouse":"touch"]}function re(oe,se){const le=h.add(Uk(oe)*-1),ye=u.byDistance(oe,!p).distance;return p||ks(oe)<L?ye:v&&se?ye*.5:u.byIndex(le.get(),0).distance}function G(oe){const se=NC(oe,s);k=se,C=p&&se&&!oe.buttons&&M,M=hx(a.get(),o.get())>=2,!(se&&oe.button!==0)&&(Y(oe.target)||(E=!0,i.pointerDown(oe),l.useFriction(0).useDuration(0),a.set(o),$(),F=i.readPoint(oe),S=i.readPoint(oe,b),f.emit("pointerDown")))}function J(oe){if(!NC(oe,s)&&oe.touches.length>=2)return V(oe);const le=i.readPoint(oe),ye=i.readPoint(oe,b),ue=hx(le,F),ne=hx(ye,S);if(!N&&!k&&(!oe.cancelable||(N=ue>ne,!N)))return V(oe);const pe=i.pointerMove(oe);ue>g&&(C=!0),l.useFriction(.3).useDuration(.75),c.start(),a.add(j(pe)),oe.preventDefault()}function V(oe){const le=u.byDistance(0,!1).index!==h.get(),ye=i.pointerUp(oe)*Z(),ue=re(j(ye),le),ne=nme(ye,ue),pe=H-10*ne,ge=x+ne/50;N=!1,E=!1,D.clear(),l.useDuration(pe).useFriction(ge),d.distance(ue,!p),k=!1,f.emit("pointerUp")}function W(oe){C&&(oe.stopPropagation(),oe.preventDefault(),C=!1)}function ee(){return E}return{init:I,destroy:U,pointerDown:ee}}function cme(e,t){let s,a;function i(h){return h.timeStamp}function o(h,f){const p=`client${(f||e.scroll)==="x"?"X":"Y"}`;return(NC(h,t)?h:h.touches[0])[p]}function c(h){return s=h,a=h,o(h)}function d(h){const f=o(h)-o(a),m=i(h)-i(s)>170;return a=h,m&&(s=h),f}function l(h){if(!s||!a)return 0;const f=o(a)-o(s),m=i(h)-i(s),p=i(h)-i(a)>170,g=f/m;return m&&!p&&ks(g)>.1?g:0}return{pointerDown:c,pointerMove:d,pointerUp:l,readPoint:o}}function dme(){function e(r){const{offsetTop:s,offsetLeft:a,offsetWidth:i,offsetHeight:o}=r;return{top:s,right:a+i,bottom:s+o,left:a,width:i,height:o}}return{measure:e}}function ume(e){function t(s){return e*(s/100)}return{measure:t}}function hme(e,t,r,s,a,i,o){const c=[e].concat(s);let d,l,u=[],h=!1;function f(v){return a.measureSize(o.measure(v))}function m(v){if(!i)return;l=f(e),u=s.map(f);function x(y){for(const b of y){if(h)return;const j=b.target===e,T=s.indexOf(b.target),O=j?l:u[T],R=f(j?e:s[T]);if(ks(R-O)>=.5){v.reInit(),t.emit("resize");break}}}d=new ResizeObserver(y=>{(U_(i)||i(v,y))&&x(y)}),r.requestAnimationFrame(()=>{c.forEach(y=>d.observe(y))})}function p(){h=!0,d&&d.disconnect()}return{init:m,destroy:p}}function fme(e,t,r,s,a,i){let o=0,c=0,d=a,l=i,u=e.get(),h=0;function f(){const O=s.get()-e.get(),R=!d;let D=0;return R?(o=0,r.set(s),e.set(s),D=O):(r.set(e),o+=O/d,o*=l,u+=o,e.add(o),D=u-h),c=Uk(D),h=u,T}function m(){const O=s.get()-t.get();return ks(O)<.001}function p(){return d}function g(){return c}function v(){return o}function x(){return b(a)}function y(){return j(i)}function b(O){return d=O,T}function j(O){return l=O,T}const T={direction:g,duration:p,velocity:v,seek:f,settled:m,useBaseFriction:y,useBaseDuration:x,useFriction:j,useDuration:b};return T}function mme(e,t,r,s,a){const i=a.measure(10),o=a.measure(50),c=df(.1,.99);let d=!1;function l(){return!(d||!e.reachedAny(r.get())||!e.reachedAny(t.get()))}function u(m){if(!l())return;const p=e.reachedMin(t.get())?"min":"max",g=ks(e[p]-t.get()),v=r.get()-t.get(),x=c.constrain(g/o);r.subtract(v*x),!m&&ks(v)<i&&(r.set(e.constrain(r.get())),s.useDuration(25).useBaseFriction())}function h(m){d=!m}return{shouldConstrain:l,constrain:u,toggleActive:h}}function pme(e,t,r,s,a){const i=df(-t+e,0),o=h(),c=u(),d=f();function l(p,g){return hx(p,g)<=1}function u(){const p=o[0],g=kl(o),v=o.lastIndexOf(p),x=o.indexOf(g)+1;return df(v,x)}function h(){return r.map((p,g)=>{const{min:v,max:x}=i,y=i.constrain(p),b=!g,j=Vk(r,g);return b?x:j||l(v,y)?v:l(x,y)?x:y}).map(p=>parseFloat(p.toFixed(3)))}function f(){if(t<=e+a)return[i.max];if(s==="keepSnaps")return o;const{min:p,max:g}=c;return o.slice(p,g)}return{snapsContained:d,scrollContainLimit:c}}function gme(e,t,r){const s=t[0],a=r?s-e:kl(t);return{limit:df(a,s)}}function xme(e,t,r,s){const i=t.min+.1,o=t.max+.1,{reachedMin:c,reachedMax:d}=df(i,o);function l(f){return f===1?d(r.get()):f===-1?c(r.get()):!1}function u(f){if(!l(f))return;const m=e*(f*-1);s.forEach(p=>p.add(m))}return{loop:u}}function vme(e){const{max:t,length:r}=e;function s(i){const o=i-t;return r?o/-r:0}return{get:s}}function yme(e,t,r,s,a){const{startEdge:i,endEdge:o}=e,{groupSlides:c}=a,d=h().map(t.measure),l=f(),u=m();function h(){return c(s).map(g=>kl(g)[o]-g[0][i]).map(ks)}function f(){return s.map(g=>r[i]-g[i]).map(g=>-ks(g))}function m(){return c(l).map(g=>g[0]).map((g,v)=>g+d[v])}return{snaps:l,snapsAligned:u}}function bme(e,t,r,s,a,i){const{groupSlides:o}=a,{min:c,max:d}=s,l=u();function u(){const f=o(i),m=!e||t==="keepSnaps";return r.length===1?[i]:m?f:f.slice(c,d).map((p,g,v)=>{const x=!g,y=Vk(v,g);if(x){const b=kl(v[0])+1;return AR(b)}if(y){const b=S1(i)-kl(v)[0]+1;return AR(b,kl(v)[0])}return p})}return{slideRegistry:l}}function wme(e,t,r,s,a){const{reachedAny:i,removeOffset:o,constrain:c}=s;function d(p){return p.concat().sort((g,v)=>ks(g)-ks(v))[0]}function l(p){const g=e?o(p):c(p),v=t.map((y,b)=>({diff:u(y-g,0),index:b})).sort((y,b)=>ks(y.diff)-ks(b.diff)),{index:x}=v[0];return{index:x,distance:g}}function u(p,g){const v=[p,p+r,p-r];if(!e)return p;if(!g)return d(v);const x=v.filter(y=>Uk(y)===g);return x.length?d(x):kl(v)-r}function h(p,g){const v=t[p]-a.get(),x=u(v,g);return{index:p,distance:x}}function f(p,g){const v=a.get()+p,{index:x,distance:y}=l(v),b=!e&&i(v);if(!g||b)return{index:x,distance:p};const j=t[x]-y,T=p+u(j,0);return{index:x,distance:T}}return{byDistance:f,byIndex:h,shortcut:u}}function _me(e,t,r,s,a,i,o){function c(h){const f=h.distance,m=h.index!==t.get();i.add(f),f&&(s.duration()?e.start():(e.update(),e.render(1),e.update())),m&&(r.set(t.get()),t.set(h.index),o.emit("select"))}function d(h,f){const m=a.byDistance(h,f);c(m)}function l(h,f){const m=t.clone().set(h),p=a.byIndex(m.get(),f);c(p)}return{distance:d,index:l}}function jme(e,t,r,s,a,i,o,c){const d={passive:!0,capture:!0};let l=0;function u(m){if(!c)return;function p(g){if(new Date().getTime()-l>10)return;o.emit("slideFocusStart"),e.scrollLeft=0;const y=r.findIndex(b=>b.includes(g));zk(y)&&(a.useDuration(0),s.index(y,0),o.emit("slideFocus"))}i.add(document,"keydown",h,!1),t.forEach((g,v)=>{i.add(g,"focus",x=>{(U_(c)||c(m,x))&&p(v)},d)})}function h(m){m.code==="Tab"&&(l=new Date().getTime())}return{init:u}}function W0(e){let t=e;function r(){return t}function s(d){t=o(d)}function a(d){t+=o(d)}function i(d){t-=o(d)}function o(d){return zk(d)?d:d.get()}return{get:r,set:s,add:a,subtract:i}}function rq(e,t){const r=e.scroll==="x"?o:c,s=t.style;let a=null,i=!1;function o(f){return`translate3d(${f}px,0px,0px)`}function c(f){return`translate3d(0px,${f}px,0px)`}function d(f){if(i)return;const m=sme(e.direction(f));m!==a&&(s.transform=r(m),a=m)}function l(f){i=!f}function u(){i||(s.transform="",t.getAttribute("style")||t.removeAttribute("style"))}return{clear:u,to:d,toggleActive:l}}function Nme(e,t,r,s,a,i,o,c,d){const u=iv(a),h=iv(a).reverse(),f=x().concat(y());function m(R,D){return R.reduce((L,q)=>L-a[q],D)}function p(R,D){return R.reduce((L,q)=>m(L,D)>0?L.concat([q]):L,[])}function g(R){return i.map((D,L)=>({start:D-s[L]+.5+R,end:D+t-.5+R}))}function v(R,D,L){const q=g(D);return R.map(X=>{const H=L?0:-r,M=L?r:0,F=L?"end":"start",S=q[X][F];return{index:X,loopPoint:S,slideLocation:W0(-1),translate:rq(e,d[X]),target:()=>c.get()>S?H:M}})}function x(){const R=o[0],D=p(h,R);return v(D,r,!1)}function y(){const R=t-o[0]-1,D=p(u,R);return v(D,-r,!0)}function b(){return f.every(({index:R})=>{const D=u.filter(L=>L!==R);return m(D,t)<=.1})}function j(){f.forEach(R=>{const{target:D,translate:L,slideLocation:q}=R,X=D();X!==q.get()&&(L.to(X),q.set(X))})}function T(){f.forEach(R=>R.translate.clear())}return{canLoop:b,clear:T,loop:j,loopPoints:f}}function Sme(e,t,r){let s,a=!1;function i(d){if(!r)return;function l(u){for(const h of u)if(h.type==="childList"){d.reInit(),t.emit("slidesChanged");break}}s=new MutationObserver(u=>{a||(U_(r)||r(d,u))&&l(u)}),s.observe(e,{childList:!0})}function o(){s&&s.disconnect(),a=!0}return{init:i,destroy:o}}function Cme(e,t,r,s){const a={};let i=null,o=null,c,d=!1;function l(){c=new IntersectionObserver(p=>{d||(p.forEach(g=>{const v=t.indexOf(g.target);a[v]=g}),i=null,o=null,r.emit("slidesInView"))},{root:e.parentElement,threshold:s}),t.forEach(p=>c.observe(p))}function u(){c&&c.disconnect(),d=!0}function h(p){return ov(a).reduce((g,v)=>{const x=parseInt(v),{isIntersecting:y}=a[x];return(p&&y||!p&&!y)&&g.push(x),g},[])}function f(p=!0){if(p&&i)return i;if(!p&&o)return o;const g=h(p);return p&&(i=g),p||(o=g),g}return{init:l,destroy:u,get:f}}function Eme(e,t,r,s,a,i){const{measureSize:o,startEdge:c,endEdge:d}=e,l=r[0]&&a,u=p(),h=g(),f=r.map(o),m=v();function p(){if(!l)return 0;const y=r[0];return ks(t[c]-y[c])}function g(){if(!l)return 0;const y=i.getComputedStyle(kl(s));return parseFloat(y.getPropertyValue(`margin-${d}`))}function v(){return r.map((y,b,j)=>{const T=!b,O=Vk(j,b);return T?f[b]+u:O?f[b]+h:j[b+1][c]-y[c]}).map(ks)}return{slideSizes:f,slideSizesWithGaps:m,startGap:u,endGap:h}}function kme(e,t,r,s,a,i,o,c,d){const{startEdge:l,endEdge:u,direction:h}=e,f=zk(r);function m(x,y){return iv(x).filter(b=>b%y===0).map(b=>x.slice(b,b+y))}function p(x){return x.length?iv(x).reduce((y,b,j)=>{const T=kl(y)||0,O=T===0,R=b===S1(x),D=a[l]-i[T][l],L=a[l]-i[b][u],q=!s&&O?h(o):0,X=!s&&R?h(c):0,H=ks(L-X-(D+q));return j&&H>t+d&&y.push(b),R&&y.push(x.length),y},[]).map((y,b,j)=>{const T=Math.max(j[b-1]||0);return x.slice(T,y)}):[]}function g(x){return f?m(x,r):p(x)}return{groupSlides:g}}function Ame(e,t,r,s,a,i,o){const{align:c,axis:d,direction:l,startIndex:u,loop:h,duration:f,dragFree:m,dragThreshold:p,inViewThreshold:g,slidesToScroll:v,skipSnaps:x,containScroll:y,watchResize:b,watchSlides:j,watchDrag:T,watchFocus:O}=i,R=2,D=dme(),L=D.measure(t),q=r.map(D.measure),X=ome(d,l),H=X.measureSize(L),M=ume(H),F=ame(c,H),S=!h&&!!y,E=h||!!y,{slideSizes:N,slideSizesWithGaps:C,startGap:k,endGap:I}=Eme(X,L,q,r,E,a),U=kme(X,H,v,h,L,q,k,I,R),{snaps:$,snapsAligned:Y}=yme(X,F,L,q,U),Z=-kl($)+kl(C),{snapsContained:re,scrollContainLimit:G}=pme(H,Z,Y,y,R),J=S?re:Y,{limit:V}=gme(Z,J,h),W=tq(S1(J),u,h),ee=W.clone(),ie=iv(r),oe=({dragHandler:ot,scrollBody:ut,scrollBounds:bt,options:{loop:Je}})=>{Je||bt.constrain(ot.pointerDown()),ut.seek()},se=({scrollBody:ot,translate:ut,location:bt,offsetLocation:Je,previousLocation:Ce,scrollLooper:Ge,slideLooper:Pe,dragHandler:Ve,animation:st,eventHandler:xt,scrollBounds:fe,options:{loop:Ie}},tt)=>{const lt=ot.settled(),It=!fe.shouldConstrain(),ct=Ie?lt:lt&&It,at=ct&&!Ve.pointerDown();at&&st.stop();const gt=bt.get()*tt+Ce.get()*(1-tt);Je.set(gt),Ie&&(Ge.loop(ot.direction()),Pe.loop()),ut.to(Je.get()),at&&xt.emit("settle"),ct||xt.emit("scroll")},le=ime(s,a,()=>oe(Re),ot=>se(Re,ot)),ye=.68,ue=J[W.get()],ne=W0(ue),pe=W0(ue),ge=W0(ue),Ne=W0(ue),_e=fme(ne,ge,pe,Ne,f,ye),be=wme(h,J,Z,V,Ne),Me=_me(le,W,ee,_e,be,Ne,o),Se=vme(V),$e=lv(),Ke=Cme(t,r,o,g),{slideRegistry:Ze}=bme(S,y,J,G,U,ie),it=jme(e,r,Ze,Me,_e,$e,o,O),Re={ownerDocument:s,ownerWindow:a,eventHandler:o,containerRect:L,slideRects:q,animation:le,axis:X,dragHandler:lme(X,e,s,a,Ne,cme(X,a),ne,le,Me,_e,be,W,o,M,m,p,x,ye,T),eventStore:$e,percentOfView:M,index:W,indexPrevious:ee,limit:V,location:ne,offsetLocation:ge,previousLocation:pe,options:i,resizeHandler:hme(t,o,a,r,X,b,D),scrollBody:_e,scrollBounds:mme(V,ge,Ne,_e,M),scrollLooper:xme(Z,V,ge,[ne,ge,pe,Ne]),scrollProgress:Se,scrollSnapList:J.map(Se.get),scrollSnaps:J,scrollTarget:be,scrollTo:Me,slideLooper:Nme(X,H,Z,N,C,$,J,ge,r),slideFocus:it,slidesHandler:Sme(t,o,j),slidesInView:Ke,slideIndexes:ie,slideRegistry:Ze,slidesToScroll:U,target:Ne,translate:rq(X,t)};return Re}function Tme(){let e={},t;function r(l){t=l}function s(l){return e[l]||[]}function a(l){return s(l).forEach(u=>u(t,l)),d}function i(l,u){return e[l]=s(l).concat([u]),d}function o(l,u){return e[l]=s(l).filter(h=>h!==u),d}function c(){e={}}const d={init:r,emit:a,off:o,on:i,clear:c};return d}const Pme={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function Ome(e){function t(i,o){return eq(i,o||{})}function r(i){const o=i.breakpoints||{},c=ov(o).filter(d=>e.matchMedia(d).matches).map(d=>o[d]).reduce((d,l)=>t(d,l),{});return t(i,c)}function s(i){return i.map(o=>ov(o.breakpoints||{})).reduce((o,c)=>o.concat(c),[]).map(e.matchMedia)}return{mergeOptions:t,optionsAtMedia:r,optionsMediaQueries:s}}function Rme(e){let t=[];function r(i,o){return t=o.filter(({options:c})=>e.optionsAtMedia(c).active!==!1),t.forEach(c=>c.init(i,e)),o.reduce((c,d)=>Object.assign(c,{[d.name]:d}),{})}function s(){t=t.filter(i=>i.destroy())}return{init:r,destroy:s}}function Aw(e,t,r){const s=e.ownerDocument,a=s.defaultView,i=Ome(a),o=Rme(i),c=lv(),d=Tme(),{mergeOptions:l,optionsAtMedia:u,optionsMediaQueries:h}=i,{on:f,off:m,emit:p}=d,g=X;let v=!1,x,y=l(Pme,Aw.globalOptions),b=l(y),j=[],T,O,R;function D(){const{container:ie,slides:oe}=b;O=(jC(ie)?e.querySelector(ie):ie)||e.children[0];const le=jC(oe)?O.querySelectorAll(oe):oe;R=[].slice.call(le||O.children)}function L(ie){const oe=Ame(e,O,R,s,a,ie,d);if(ie.loop&&!oe.slideLooper.canLoop()){const se=Object.assign({},ie,{loop:!1});return L(se)}return oe}function q(ie,oe){v||(y=l(y,ie),b=u(y),j=oe||j,D(),x=L(b),h([y,...j.map(({options:se})=>se)]).forEach(se=>c.add(se,"change",X)),b.active&&(x.translate.to(x.location.get()),x.animation.init(),x.slidesInView.init(),x.slideFocus.init(ee),x.eventHandler.init(ee),x.resizeHandler.init(ee),x.slidesHandler.init(ee),x.options.loop&&x.slideLooper.loop(),O.offsetParent&&R.length&&x.dragHandler.init(ee),T=o.init(ee,j)))}function X(ie,oe){const se=U();H(),q(l({startIndex:se},ie),oe),d.emit("reInit")}function H(){x.dragHandler.destroy(),x.eventStore.clear(),x.translate.clear(),x.slideLooper.clear(),x.resizeHandler.destroy(),x.slidesHandler.destroy(),x.slidesInView.destroy(),x.animation.destroy(),o.destroy(),c.clear()}function M(){v||(v=!0,c.clear(),H(),d.emit("destroy"),d.clear())}function F(ie,oe,se){!b.active||v||(x.scrollBody.useBaseFriction().useDuration(oe===!0?0:b.duration),x.scrollTo.index(ie,se||0))}function S(ie){const oe=x.index.add(1).get();F(oe,ie,-1)}function E(ie){const oe=x.index.add(-1).get();F(oe,ie,1)}function N(){return x.index.add(1).get()!==U()}function C(){return x.index.add(-1).get()!==U()}function k(){return x.scrollSnapList}function I(){return x.scrollProgress.get(x.offsetLocation.get())}function U(){return x.index.get()}function $(){return x.indexPrevious.get()}function Y(){return x.slidesInView.get()}function Z(){return x.slidesInView.get(!1)}function re(){return T}function G(){return x}function J(){return e}function V(){return O}function W(){return R}const ee={canScrollNext:N,canScrollPrev:C,containerNode:V,internalEngine:G,destroy:M,off:m,on:f,emit:p,plugins:re,previousScrollSnap:$,reInit:g,rootNode:J,scrollNext:S,scrollPrev:E,scrollProgress:I,scrollSnapList:k,scrollTo:F,selectedScrollSnap:U,slideNodes:W,slidesInView:Y,slidesNotInView:Z};return q(t,r),setTimeout(()=>d.emit("init"),0),ee}Aw.globalOptions=void 0;function qk(e={},t=[]){const r=P.useRef(e),s=P.useRef(t),[a,i]=P.useState(),[o,c]=P.useState(),d=P.useCallback(()=>{a&&a.reInit(r.current,s.current)},[a]);return P.useEffect(()=>{Fk(r.current,e)||(r.current=e,d())},[e,d]),P.useEffect(()=>{rme(s.current,t)||(s.current=t,d())},[t,d]),P.useEffect(()=>{if(tme()&&o){Aw.globalOptions=qk.globalOptions;const l=Aw(o,r.current,s.current);return i(l),()=>l.destroy()}else i(void 0)},[o,i]),[c,a]}qk.globalOptions=void 0;const nq=P.createContext(null);function V_(){const e=P.useContext(nq);if(!e)throw new Error("useCarousel must be used within a <Carousel />");return e}const sq=P.forwardRef(({orientation:e="horizontal",opts:t,setApi:r,plugins:s,className:a,children:i,...o},c)=>{const[d,l]=qk({...t,axis:e==="horizontal"?"x":"y"},s),[u,h]=P.useState(!1),[f,m]=P.useState(!1),p=P.useCallback(y=>{y&&(h(y.canScrollPrev()),m(y.canScrollNext()))},[]),g=P.useCallback(()=>{l==null||l.scrollPrev()},[l]),v=P.useCallback(()=>{l==null||l.scrollNext()},[l]),x=P.useCallback(y=>{y.key==="ArrowLeft"?(y.preventDefault(),g()):y.key==="ArrowRight"&&(y.preventDefault(),v())},[g,v]);return P.useEffect(()=>{!l||!r||r(l)},[l,r]),P.useEffect(()=>{if(l)return p(l),l.on("reInit",p),l.on("select",p),()=>{l==null||l.off("select",p)}},[l,p]),n.jsx(nq.Provider,{value:{carouselRef:d,api:l,opts:t,orientation:e||((t==null?void 0:t.axis)==="y"?"vertical":"horizontal"),scrollPrev:g,scrollNext:v,canScrollPrev:u,canScrollNext:f},children:n.jsx("div",{ref:c,onKeyDownCapture:x,className:We("relative",a),role:"region","aria-roledescription":"carousel",...o,children:i})})});sq.displayName="Carousel";const aq=P.forwardRef(({className:e,...t},r)=>{const{carouselRef:s,orientation:a}=V_();return n.jsx("div",{ref:s,className:"overflow-hidden",children:n.jsx("div",{ref:r,className:We("flex",a==="horizontal"?"-ml-4":"-mt-4 flex-col",e),...t})})});aq.displayName="CarouselContent";const iq=P.forwardRef(({className:e,...t},r)=>{const{orientation:s}=V_();return n.jsx("div",{ref:r,role:"group","aria-roledescription":"slide",className:We("min-w-0 shrink-0 grow-0 basis-full",s==="horizontal"?"pl-4":"pt-4",e),...t})});iq.displayName="CarouselItem";const oq=P.forwardRef(({className:e,variant:t="outline",size:r="icon",...s},a)=>{const{orientation:i,scrollPrev:o,canScrollPrev:c}=V_();return n.jsxs(he,{ref:a,variant:t,size:r,className:We("absolute h-8 w-8 rounded-full",i==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",e),disabled:!c,onClick:o,...s,children:[n.jsx(vs,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Previous slide"})]})});oq.displayName="CarouselPrevious";const lq=P.forwardRef(({className:e,variant:t="outline",size:r="icon",...s},a)=>{const{orientation:i,scrollNext:o,canScrollNext:c}=V_();return n.jsxs(he,{ref:a,variant:t,size:r,className:We("absolute h-8 w-8 rounded-full",i==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",e),disabled:!c,onClick:o,...s,children:[n.jsx(ps,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Next slide"})]})});lq.displayName="CarouselNext";function Mme(){const{trendingProducts:e,isLoading:t}=Zfe(),r=e.map(u=>u.product_id),{getEffectivePrice:s,getOriginalPrice:a,hasDiscount:i,getDiscountPercent:o}=$k({channel:"catalog",productIds:r.length>0?r:void 0,enabled:r.length>0}),{getAvailableSizes:c,isProductOutOfStock:d}=N1(r.length>0?r:void 0);if(t)return n.jsx("section",{className:"py-14 px-5",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsx("div",{className:"h-8 bg-secondary animate-pulse w-48 mb-8 rounded"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[...Array(4)].map((u,h)=>n.jsx("div",{className:"aspect-[3/4] bg-secondary animate-pulse rounded-xl"},h))})]})});if(e.length===0)return n.jsx("section",{className:"py-14 px-5 border-y border-dashed border-accent/20 bg-accent/5",children:n.jsxs("div",{className:"max-w-6xl mx-auto text-center opacity-40",children:[n.jsx(pw,{className:"h-6 w-6 mx-auto mb-2"}),n.jsx("p",{className:"text-sm",children:"O carrossel de tendncias aparecer aqui assim que houver pedidos pagos."})]})});const l=u=>{var h;return(h=u.images)!=null&&h.length?u.images[u.main_image_index||0]||u.images[0]:u.image_url||void 0};return n.jsx("section",{className:"py-14 md:py-20 px-5 overflow-hidden",children:n.jsxs("div",{className:"max-w-6xl mx-auto",children:[n.jsx("div",{className:"flex flex-col md:flex-row md:items-end justify-between mb-8 gap-4",children:n.jsxs("div",{className:"text-center md:text-left",children:[n.jsx("div",{className:"flex items-center justify-center md:justify-start gap-2 mb-4",children:n.jsxs("span",{className:"bg-secondary text-primary text-[10px] font-bold px-4 py-1.5 rounded-full flex items-center gap-2 uppercase tracking-[0.2em] border border-gold/20 shadow-sm",children:[n.jsx(pw,{className:"h-3.5 w-3.5 text-gold"}),"Escolha do Personal Stylist"]})}),n.jsxs("h2",{className:"font-serif text-4xl md:text-5xl font-medium text-primary leading-tight mb-4",children:["Coleo em ",n.jsx("span",{className:"italic",children:"Destaque"})]}),n.jsx("p",{className:"text-muted-foreground text-sm md:text-lg font-light max-w-lg",children:"Peas curadas estrategicamente para elevar seu guarda-roupa."})]})}),n.jsxs(sq,{opts:{align:"start",loop:!0},className:"w-full relative",children:[n.jsx(aq,{className:"-ml-4",children:e.map(u=>n.jsx(iq,{className:"pl-4 basis-1/2 md:basis-1/3 lg:basis-1/4",children:n.jsx(Gt,{to:`/produto/${u.product_id}`,className:"block h-full group",children:n.jsx(_p,{name:u.name,price:a(u.product_id,u.price),effectivePrice:s(u.product_id,u.price),imageUrl:l(u),sizes:c(u.product_id),isOutOfStock:d(u.product_id),hasPromotionalDiscount:i(u.product_id),discountPercent:o(u.product_id)})})},u.product_id))}),n.jsxs("div",{className:"absolute -top-16 right-12 hidden md:flex gap-2",children:[n.jsx(oq,{className:"static translate-y-0"}),n.jsx(lq,{className:"static translate-y-0"})]})]})]})})}const Qe=P.forwardRef(({className:e,type:t,...r},s)=>n.jsx("input",{type:t,className:We("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:s,...r}));Qe.displayName="Input";const De=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:We("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));De.displayName="Card";const Ot=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:We("flex flex-col space-y-1.5 p-6",e),...t}));Ot.displayName="CardHeader";const Mt=P.forwardRef(({className:e,...t},r)=>n.jsx("h3",{ref:r,className:We("text-2xl font-semibold leading-none tracking-tight",e),...t}));Mt.displayName="CardTitle";const Ai=P.forwardRef(({className:e,...t},r)=>n.jsx("p",{ref:r,className:We("text-sm text-muted-foreground",e),...t}));Ai.displayName="CardDescription";const Be=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:We("p-6 pt-0",e),...t}));Be.displayName="CardContent";const Ime=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:We("flex items-center p-6 pt-0",e),...t}));Ime.displayName="CardFooter";function Hn(){const[e,t]=P.useState({user:null,session:null,isLoading:!0,rolesLoading:!0,roles:[]}),r=P.useCallback(async c=>{t(u=>({...u,rolesLoading:!0}));const{data:d,error:l}=await ce.from("user_roles").select("role").eq("user_id",c);!l&&d?t(u=>({...u,roles:d.map(h=>h.role),rolesLoading:!1})):(console.error("Error fetching roles:",l),t(u=>({...u,rolesLoading:!1})))},[]);P.useEffect(()=>{const{data:{subscription:c}}=ce.auth.onAuthStateChange((d,l)=>{t(u=>({...u,session:l,user:(l==null?void 0:l.user)??null,isLoading:!1})),l!=null&&l.user?setTimeout(()=>{r(l.user.id)},0):t(u=>({...u,roles:[],rolesLoading:!1}))});return ce.auth.getSession().then(({data:{session:d}})=>{t(l=>({...l,session:d,user:(d==null?void 0:d.user)??null,isLoading:!1})),d!=null&&d.user?r(d.user.id):t(l=>({...l,rolesLoading:!1}))}),()=>c.unsubscribe()},[r]);const s=P.useCallback(c=>e.roles.includes(c),[e.roles]),a=P.useCallback(()=>s("merchant")||s("admin"),[s]),i=P.useCallback(()=>s("admin"),[s]);return{...e,hasRole:s,isMerchant:a,isAdmin:i,signOut:async()=>{await ce.auth.signOut()}}}function Wk(){const{user:e}=Hn();return{trackEvent:async(r,s={})=>{try{let a=localStorage.getItem("analytics_session_id");a||(a=crypto.randomUUID(),localStorage.setItem("analytics_session_id",a)),await ce.from("analytics_events").insert({event_name:r,user_id:(e==null?void 0:e.id)||null,session_id:a,metadata:s})}catch(a){console.error("Failed to track event:",a)}}}}const Dme=["Jantar romntico","Reunio de trabalho","Casamento de dia","Look casual chic"];function Lme(){const{user:e}=Hn(),[t,r]=P.useState(""),[s,a]=P.useState(!1),[i,o]=P.useState([{id:"welcome",type:"bot",text:"Ol! Sou sua consultora de estilo Le.Po. Me conte: qual a ocasio de hoje para eu montar o look ideal para voc?"}]),c=P.useRef(null),{trackEvent:d}=Wk();P.useEffect(()=>{c.current&&(c.current.scrollTop=c.current.scrollHeight)},[i,s]);const l=i.filter(p=>p.look).flatMap(p=>p.look.products),{getEffectivePrice:u}=$k({channel:"catalog",productIds:l.length>0?l:void 0,enabled:l.length>0}),h=async p=>{var v;if(!p.trim()||!e)return;const g={id:crypto.randomUUID(),type:"user",text:p};o(x=>[...x,g]),r(""),a(!0);try{const{data:x,error:y}=await ce.functions.invoke("generate-ai-look",{body:{input_text:p,user_id:e==null?void 0:e.id,session_id:localStorage.getItem("analytics_session_id")||crypto.randomUUID(),history:i.slice(1).map(O=>({type:O.type,text:O.text}))}});if(y)throw y;if(!x.success)throw new Error(x.error||"Erro ao gerar look");const b=x.data;let j=[];if(b.type==="look"&&((v=b.products)==null?void 0:v.length)>0){const{data:O,error:R}=await ce.from("product_catalog").select("id, name, price, image_url, images, main_image_index").in("id",b.products);if(R)throw R;j=O||[]}const T={id:crypto.randomUUID(),type:"bot",text:b.text,look:b.type==="look"?{title:b.title,description:b.text,products:b.products}:void 0,products:j};o(O=>[...O,T]),b.type==="look"&&d("ai_look_generated",{occasion:p,title:b.title,products_count:b.products.length})}catch(x){console.error("DEBUG: Error generating AI look:",x);const y=(x==null?void 0:x.message)||"Erro desconhecido";o(b=>[...b,{id:crypto.randomUUID(),type:"bot",text:`Desculpe, tive um probleminha para montar seu look: "${y}".`}])}finally{a(!1)}},f=p=>{var g;return(g=p.images)!=null&&g.length?p.images[p.main_image_index||0]||p.images[0]:p.image_url||void 0},m=p=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(p);return n.jsxs("section",{id:"consultora-ai",className:"py-16 md:py-24 px-5 bg-primary relative overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-gold/5 rounded-full blur-[100px] -mr-48 -mt-48"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-secondary/5 rounded-full blur-[100px] -ml-48 -mb-48"}),n.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-12",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-gold/10 text-gold mb-6 border border-gold/20 shadow-lg",children:n.jsx(Wr,{className:"h-8 w-8"})}),n.jsxs("h2",{className:"font-serif text-4xl md:text-5xl font-medium mb-4 text-white italic",children:["Atelier de Estilo ",n.jsx("span",{className:"text-gold",children:"IA"})]}),n.jsx("p",{className:"text-white/60 font-light text-base md:text-lg max-w-lg mx-auto",children:"Sua consultora exclusiva 24/7. Conte qual a ocasio e ns criamos o visual perfeito."})]}),n.jsxs(De,{className:"border-none shadow-xl overflow-hidden rounded-3xl bg-white/80 backdrop-blur-sm relative",children:[!e&&n.jsxs("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center p-8 bg-primary/80 backdrop-blur-md text-center",children:[n.jsx("div",{className:"w-16 h-16 bg-gold/10 rounded-full flex items-center justify-center mb-6",children:n.jsx(ln,{className:"h-8 w-8 text-gold"})}),n.jsx("h3",{className:"text-2xl font-serif font-medium mb-4 text-white italic",children:"Acesso Exclusivo Le.Po"}),n.jsx("p",{className:"text-white/60 max-w-sm mb-10 leading-relaxed font-light",children:"Inicie sua jornada de estilo personalizada agora. Faa login para acessar nossa curadoria guiada por IA."}),n.jsx("div",{className:"flex flex-col sm:flex-row gap-4 w-full max-w-xs",children:n.jsx(Gt,{to:"/auth",className:"flex-1",children:n.jsx(he,{className:"btn-gold w-full rounded-full h-14",children:"ENTRAR NO MEU ATELIER"})})}),n.jsx("p",{className:"mt-6 text-[11px] uppercase tracking-widest text-muted-foreground/60",children:"Acesso gratuito e instantneo"})]}),n.jsxs(Be,{className:We("p-0 flex flex-col h-[600px] transition-all duration-500",!e&&"blur-[2px] pointer-events-none select-none"),children:[n.jsxs("div",{ref:c,className:"flex-1 overflow-y-auto p-6 space-y-6 scroll-smooth",children:[i.map(p=>n.jsx("div",{className:We("flex w-full mb-4 animate-fade-in",p.type==="user"?"justify-end":"justify-start"),children:n.jsxs("div",{className:We("flex gap-3 max-w-[85%] md:max-w-[70%]",p.type==="user"?"flex-row-reverse":"flex-row"),children:[n.jsx("div",{className:We("w-9 h-9 rounded-full flex items-center justify-center flex-shrink-0 mt-1 shadow-md",p.type==="user"?"bg-gold text-white":"bg-primary border border-gold/20"),children:p.type==="user"?n.jsx(Wn,{className:"h-4 w-4"}):n.jsx(hO,{className:"h-4 w-4 text-gold"})}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:We("rounded-2xl px-6 py-4 text-sm leading-relaxed shadow-sm",p.type==="user"?"bg-gold text-white rounded-tr-none font-medium":"bg-white border border-border/50 text-gray-800 rounded-tl-none"),children:p.text}),p.look&&p.products&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("p",{className:"text-xs font-bold uppercase tracking-widest text-accent px-1",children:p.look.title}),n.jsx("div",{className:"grid grid-cols-2 gap-3",children:p.products.map(g=>n.jsxs(Gt,{to:`/produto/${g.id}?from=ai_look`,className:"bg-white rounded-xl border border-border/40 overflow-hidden shadow-sm hover:shadow-md transition-all group",children:[n.jsx("div",{className:"aspect-[3/4] overflow-hidden bg-secondary",children:n.jsx("img",{src:f(g),alt:g.name,className:"w-full h-full object-cover transition-transform group-hover:scale-105"})}),n.jsxs("div",{className:"p-3",children:[n.jsx("p",{className:"text-[10px] font-bold tracking-widest uppercase text-muted-foreground/50 mb-1",children:g.name}),n.jsx("p",{className:"text-base font-bold text-primary",children:m(u(g.id,g.price))})]})]},g.id))})]})]})]})},p.id)),s&&n.jsx("div",{className:"flex justify-start animate-fade-in",children:n.jsxs("div",{className:"flex gap-3",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-card border border-border flex items-center justify-center",children:n.jsx(hO,{className:"h-4 w-4 text-accent"})}),n.jsx("div",{className:"bg-white border border-border/50 rounded-2xl rounded-tl-none px-5 py-3.5 shadow-sm",children:n.jsxs("div",{className:"flex gap-1.5 pt-1",children:[n.jsx("span",{className:"w-1.5 h-1.5 bg-accent/40 rounded-full animate-bounce"}),n.jsx("span",{className:"w-1.5 h-1.5 bg-accent/60 rounded-full animate-bounce [animation-delay:0.2s]"}),n.jsx("span",{className:"w-1.5 h-1.5 bg-accent/80 rounded-full animate-bounce [animation-delay:0.4s]"})]})})]})})]}),n.jsxs("div",{className:"p-5 bg-card/30 border-t border-border/40",children:[i.length===1&&!s&&n.jsx("div",{className:"flex flex-wrap gap-2 mb-4 animate-fade-in",children:Dme.map(p=>n.jsx("button",{onClick:()=>h(p),className:"text-[10px] font-bold tracking-widest uppercase border border-gold/20 bg-white/50 text-primary hover:bg-gold hover:text-white px-5 py-2.5 rounded-full transition-all backdrop-blur-sm",children:p},p))}),n.jsxs("div",{className:"relative group",children:[n.jsx(Qe,{placeholder:"Conte-nos o que voc precisa...",className:"h-14 pl-6 pr-24 rounded-full border border-gold/20 bg-white shadow-inner focus-visible:ring-gold focus-visible:ring-offset-0 focus-visible:border-gold transition-all text-sm",value:t,onChange:p=>r(p.target.value),onKeyDown:p=>p.key==="Enter"&&h(t),disabled:s}),n.jsx(he,{size:"icon",className:"absolute right-2 top-2 bottom-2 w-10 h-10 rounded-full bg-primary hover:bg-gold text-white transition-all duration-300 shadow-md",disabled:s||!t.trim(),onClick:()=>h(t),children:n.jsx(zu,{className:"h-4 w-4"})})]})]})]})]})]})]})}const Bme="https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?w=1200&q=80",$me=["Trabalho","Jantar","Evento","Igreja","Viagem","Dia a dia chic"],Fme=[{icon:en,label:"Troca fcil",desc:"Sem burocracia"},{icon:xs,label:"3x sem juros",desc:"No carto"},{icon:nn,label:"Suporte WhatsApp",desc:"Resposta rpida"},{icon:gn,label:"Envio Brasil",desc:"Todo o pas"}],zme=()=>n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(Xm,{}),n.jsx(Cr,{}),n.jsxs("section",{className:"relative min-h-[90vh] flex items-center overflow-hidden bg-primary",children:[n.jsxs("div",{className:"absolute inset-0 z-0",children:[n.jsx("img",{src:Bme,alt:"LE.PO Editorial",className:"w-full h-full object-cover object-top opacity-40 mix-blend-luminosity"}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-primary/20 via-primary/60 to-primary"})]}),n.jsx("div",{className:"relative z-10 w-full max-w-7xl mx-auto px-5 py-20",children:n.jsxs("div",{className:"max-w-2xl animate-fade-in text-center mx-auto md:text-left md:mx-0",children:[n.jsxs("span",{className:"inline-flex items-center gap-2 text-gold text-[10px] tracking-[0.4em] uppercase font-bold mb-8",children:[n.jsx(Wr,{className:"h-3 w-3"}),"Elegncia Redefinida por IA"]}),n.jsxs("h1",{className:"font-serif text-5xl md:text-7xl lg:text-8xl font-medium leading-[0.95] mb-8 text-white drop-shadow-sm",children:["Sua melhor verso,",n.jsx("br",{}),n.jsx("span",{className:"text-white italic",children:"todos os dias."})]}),n.jsx("p",{className:"text-lg md:text-xl text-white/80 leading-relaxed mb-10 max-w-lg font-light",children:"Curadoria estratgica e consultoria de imagem guiada por inteligncia artificial para mulheres que escolhem o extraordinrio."}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-5 justify-center md:justify-start",children:[n.jsx(Gt,{to:"/meu-estilo",children:n.jsx("button",{className:"btn-gold px-12 py-5 rounded-full text-xs tracking-widest uppercase font-bold",children:"Comear Provador VIP"})}),n.jsx(Gt,{to:"/enviar-print",children:n.jsx("button",{className:"px-12 py-5 rounded-full border border-white/30 text-white text-xs tracking-widest uppercase font-bold backdrop-blur-md hover:bg-white/10 transition-all",children:"Buscar por foto"})})]})]})}),n.jsx("div",{className:"absolute bottom-10 right-10 hidden lg:block animate-float",children:n.jsxs("div",{className:"emerald-glass p-6 rounded-2xl border-gold/20 gold-border max-w-[200px]",children:[n.jsx("p",{className:"font-serif text-white text-xl italic leading-tight mb-2",children:'"O luxo est no detalhe."'}),n.jsx("div",{className:"w-10 h-px bg-gold/50"})]})})]}),n.jsx("section",{className:"py-14 md:py-20 px-5",children:n.jsxs("div",{className:"max-w-5xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-10 md:mb-14",children:[n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mb-3",children:"Como podemos te ajudar?"}),n.jsx("p",{className:"text-muted-foreground text-sm md:text-base font-light max-w-lg mx-auto",children:"Escolha como quer comear. Em poucos minutos a gente te ajuda a encontrar o look perfeito."})]}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-6 md:gap-8",children:[n.jsx(_3,{to:"/meu-estilo",icon:n.jsx(Wr,{className:"h-8 w-8 text-gold"}),title:"Style Quiz VIP",subtitle:"IA Fashion Advisor",description:"Descubra as peas que mais valorizam seu biotipo e estilo pessoal em apenas 2 minutos.",accent:!0}),n.jsx(_3,{to:"/enviar-print",icon:n.jsx(Ma,{className:"h-8 w-8 text-primary"}),title:"Look Finder",subtitle:"Busca Visual por IA",description:"Viu uma inspirao no Pinterest ou Instagram? Mande a foto e ns encontramos para voc."}),n.jsx(_3,{to:"/catalogo",icon:n.jsx(ln,{className:"h-8 w-8 text-primary"}),title:"Curadoria Exclusiva",subtitle:"Shop the Look",description:"Explore nossa coleo selecionada por especialistas para mulheres sofisticadas."})]})]})}),n.jsx(Mme,{}),n.jsx(Lme,{}),n.jsx("section",{className:"py-14 md:py-20 px-5",children:n.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-medium",children:"Para cada momento"}),n.jsxs("h2",{className:"font-serif text-2xl md:text-3xl mt-2 mb-3",children:["Qual ocasio voc precisa",n.jsx("br",{className:"hidden sm:block"})," se vestir hoje?"]}),n.jsx("p",{className:"text-muted-foreground text-sm font-light mb-10 max-w-md mx-auto",children:"Conte pra gente e a nossa curadoria encontra opes perfeitas para voc."}),n.jsx("div",{className:"flex flex-wrap justify-center gap-x-8 gap-y-5",children:$me.map(e=>n.jsxs(Gt,{to:`/catalogo?occasion=${encodeURIComponent(e)}`,className:"group relative",children:[n.jsx("span",{className:"font-serif text-lg md:text-xl text-foreground/70 transition-colors duration-300 group-hover:text-foreground",children:e}),n.jsx("span",{className:"absolute -bottom-1 left-0 w-0 h-px bg-accent transition-all duration-500 group-hover:w-full"})]},e))})]})}),n.jsx("section",{className:"py-14 md:py-20 px-5 bg-[hsl(35,30%,94%)]/60",children:n.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-medium",children:"Por que escolher a LE.PO"}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mt-2 mb-3",children:"Mais de 8 anos vestindo mulheres reais."}),n.jsx("p",{className:"text-muted-foreground text-sm font-light mb-10 max-w-md mx-auto",children:"No somos s uma loja. Somos sua parceira de estilo para cada momento da sua vida."}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-8",children:Fme.map(e=>n.jsxs("div",{className:"flex flex-col items-center gap-3 group",children:[n.jsx("div",{className:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm group-hover:shadow-md group-hover:border-accent/40 transition-all duration-300",children:n.jsx(e.icon,{className:"h-6 w-6 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:e.label}),n.jsx("p",{className:"text-xs text-muted-foreground",children:e.desc})]})]},e.label))})]})}),n.jsx("section",{className:"py-16 md:py-24 px-5",children:n.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[n.jsx("div",{className:"w-px h-12 bg-accent/40 mx-auto mb-6"}),n.jsx("h2",{className:"font-serif text-3xl md:text-4xl mb-4 italic",children:"Pronta para se sentir incrvel?"}),n.jsx("p",{className:"text-muted-foreground font-light mb-8 max-w-md mx-auto",children:"Monte seu provador VIP em 2 minutos e receba sugestes personalizadas direto no seu WhatsApp."}),n.jsx(Gt,{to:"/meu-estilo",children:n.jsx("button",{className:"px-12 py-4 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white",children:"Quero meu provador VIP"})}),n.jsx("p",{className:"text-[11px] text-muted-foreground mt-6 tracking-wide",children:"Gratuito  Leva menos de 2 minutos"})]})}),n.jsx("footer",{className:"border-t border-border py-10 px-5",children:n.jsxs("div",{className:"max-w-5xl mx-auto",children:[n.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[n.jsxs("div",{className:"text-center md:text-left",children:[n.jsx("p",{className:"font-serif text-lg mb-1",children:"LE.PO"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Curadoria de moda feminina  Anpolis, GO"})]}),n.jsxs("div",{className:"flex items-center gap-5 text-sm text-muted-foreground",children:[n.jsx(Gt,{to:"/catalogo",className:"hover:text-foreground transition-colors",children:"Catlogo"}),n.jsx(Gt,{to:"/meu-estilo",className:"hover:text-foreground transition-colors",children:"Provador VIP"}),n.jsx(Gt,{to:"/enviar-print",className:"hover:text-foreground transition-colors",children:"Buscar por foto"}),n.jsx("a",{href:No("Ol! Gostaria de saber mais sobre a LE.PO "),target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors",children:"WhatsApp"})]})]}),n.jsxs("div",{className:"border-t border-border mt-6 pt-6 flex flex-col sm:flex-row items-center justify-between gap-2",children:[n.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",new Date().getFullYear()," LE.PO. Todos os direitos reservados."]}),n.jsx(Gt,{to:"/area-lojista",className:"text-[10px] text-muted-foreground/40 hover:text-muted-foreground transition-colors",children:"rea do Lojista"})]})]})})]});function _3({to:e,icon:t,title:r,subtitle:s,description:a,accent:i=!1}){return n.jsx(Gt,{to:e,className:"group",children:n.jsxs("div",{className:`
          relative overflow-hidden rounded-3xl p-8 md:p-10 h-full
          transition-all duration-500 group-hover:-translate-y-2
          ${i?"bg-primary text-white border border-gold/30 shadow-[0_20px_40px_rgba(6,41,31,0.2)]":"bg-white border border-border hover:border-gold/30 shadow-sm hover:shadow-xl"}
        `,children:[n.jsx("div",{className:`
            inline-flex items-center justify-center w-16 h-16 rounded-2xl mb-8
            transition-transform duration-500 group-hover:scale-110
            ${i?"bg-white/10 text-gold":"bg-secondary text-primary"}
          `,children:t}),n.jsx("p",{className:`text-[10px] tracking-[0.3em] uppercase font-bold mb-3 ${i?"text-gold":"text-muted-foreground"}`,children:s}),n.jsx("h3",{className:"font-serif text-2xl mb-4",children:r}),n.jsx("p",{className:`text-sm leading-relaxed ${i?"text-white/70":"text-muted-foreground"}`,children:a}),n.jsxs("div",{className:`mt-8 inline-flex items-center gap-2 text-xs tracking-widest uppercase font-bold transition-all duration-300 ${i?"text-gold":"text-primary group-hover:text-gold"}`,children:["Explorar",n.jsx(ps,{className:"h-4 w-4 transition-transform group-hover:translate-x-1"})]})]})})}const mo={perQuestion:10,photoUpload:50,completionBonus:20};function Ume(e){return e.questions.length*mo.perQuestion+mo.photoUpload+mo.completionBonus}const Tw=[{id:"blazer-week",title:"O Blazer Perfeito",subtitle:"Descubra qual modelagem e styling combinam com voc",emoji:"",theme:"blazer",pointsReward:mo.completionBonus,tags:["blazer-lover","power-dressing"],photoPrompt:"Envie referncias de blazers que te atraem ou que gostaria de ter",questions:[{id:1,question:"Qual modelagem de blazer combina mais com voc?",subtext:"A modelagem certa muda tudo",options:[{text:"Oversized e descontrado",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}},{text:"Ajustado e estruturado",styleBonus:{elegante:3,classica:2,minimal:0,romantica:0}},{text:"Alongado  abaixo do quadril",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Com detalhes femininos como lao ou pregas",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}}]},{id:2,question:"Para qual momento voc mais usaria blazer?",subtext:"Vou sugerir o blazer certo para essa ocasio",options:[{text:"Reunies importantes e apresentaes",styleBonus:{elegante:3,classica:2,minimal:1,romantica:0}},{text:"Happy hour e eventos casuais",styleBonus:{elegante:2,classica:1,minimal:0,romantica:2}},{text:"Dia a dia no escritrio",styleBonus:{elegante:1,classica:3,minimal:2,romantica:0}},{text:"Fim de semana com estilo",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}}]},{id:3,question:"Qual cor de blazer te atrai mais?",subtext:"A cor define todo o impacto da pea",options:[{text:"Preto clssico  sempre seguro",styleBonus:{elegante:3,classica:2,minimal:2,romantica:0}},{text:"Bege ou caramelo  neutro e sofisticado",styleBonus:{elegante:1,classica:3,minimal:2,romantica:1}},{text:"Cores vibrantes  vermelho, azul, verde",styleBonus:{elegante:1,classica:0,minimal:0,romantica:2}},{text:"Branco ou off-white  leveza e modernidade",styleBonus:{elegante:2,classica:1,minimal:3,romantica:1}}]},{id:4,question:"Com o que voc combinaria seu blazer ideal?",subtext:"A composio completa o look",options:[{text:"Cala de alfaiataria",styleBonus:{elegante:2,classica:3,minimal:2,romantica:0}},{text:"Jeans bem cortado",styleBonus:{elegante:1,classica:2,minimal:3,romantica:0}},{text:"Vestido fluido",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}},{text:"Saia lpis",styleBonus:{elegante:3,classica:2,minimal:1,romantica:1}}]},{id:5,question:"Qual detalhe faria seu blazer especial?",subtext:"O que diferencia uma pea comum de uma pea sua",options:[{text:"Botes dourados ou detalhes metalizados",styleBonus:{elegante:3,classica:2,minimal:0,romantica:1}},{text:"Nenhum  corte limpo e minimalista",styleBonus:{elegante:1,classica:1,minimal:3,romantica:0}},{text:"Lapela diferenciada ou corte assimtrico",styleBonus:{elegante:2,classica:3,minimal:0,romantica:1}},{text:"Bordados, texturas ou aplicaes delicadas",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}}]}]},{id:"work-style",title:"Seu Visual Profissional",subtitle:"Refine seu estilo para o ambiente de trabalho",emoji:"",theme:"work",pointsReward:mo.completionBonus,tags:["work-ready","professional"],photoPrompt:"Envie referncias de looks de trabalho que voc admira",questions:[{id:1,question:"Como  o dress code do seu trabalho?",subtext:"Cada ambiente pede uma abordagem diferente",options:[{text:"Formal e sofisticado",styleBonus:{elegante:3,classica:2,minimal:0,romantica:0}},{text:"Smart casual  elegante mas relaxado",styleBonus:{elegante:1,classica:3,minimal:2,romantica:0}},{text:"Casual e flexvel",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}},{text:"Criativo e expressivo",styleBonus:{elegante:1,classica:0,minimal:1,romantica:3}}]},{id:2,question:"Qual pea no pode faltar no seu closet de trabalho?",subtext:"A base do seu guarda-roupa profissional",options:[{text:"Cala de alfaiataria bem cortada",styleBonus:{elegante:2,classica:3,minimal:2,romantica:0}},{text:"Blazer que funciona com tudo",styleBonus:{elegante:3,classica:2,minimal:1,romantica:0}},{text:"Vestido midi que resolve o look",styleBonus:{elegante:2,classica:1,minimal:0,romantica:3}},{text:"Camiseta premium  bsico elevado",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}}]},{id:3,question:"Reunio importante amanh. O que voc veste?",subtext:"A roupa certa te d confiana antes de abrir a boca",options:[{text:"Conjunto alfaiataria  impecvel",styleBonus:{elegante:3,classica:3,minimal:1,romantica:0}},{text:"Vestido midi elegante e estruturado",styleBonus:{elegante:2,classica:1,minimal:0,romantica:2}},{text:"Blazer com jeans premium",styleBonus:{elegante:1,classica:2,minimal:3,romantica:0}},{text:"Saia e blusa bem combinadas",styleBonus:{elegante:2,classica:2,minimal:1,romantica:2}}]},{id:4,question:"Qual sapato te leva do escritrio ao happy hour?",subtext:"Versatilidade sem abrir mo de estilo",options:[{text:"Scarpin clssico",styleBonus:{elegante:3,classica:2,minimal:0,romantica:1}},{text:"Mocassim ou loafer de couro",styleBonus:{elegante:1,classica:3,minimal:2,romantica:0}},{text:"Tnis elegante  conforto com estilo",styleBonus:{elegante:0,classica:1,minimal:3,romantica:0}},{text:"Sandlia com salto mdio",styleBonus:{elegante:1,classica:0,minimal:1,romantica:3}}]},{id:5,question:"Qual acessrio completa seu visual profissional?",subtext:"O detalhe que mostra quem voc  sem exagerar",options:[{text:"Relgio sofisticado",styleBonus:{elegante:3,classica:2,minimal:1,romantica:0}},{text:"Bolsa estruturada de couro",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Brincos discretos e delicados",styleBonus:{elegante:1,classica:2,minimal:2,romantica:2}},{text:"Leno de seda no pescoo",styleBonus:{elegante:1,classica:1,minimal:0,romantica:3}}]}]},{id:"weekend-vibes",title:"Seu Estilo no Fim de Semana",subtitle:"Como voc se veste quando  s para se sentir bem",emoji:"",theme:"casual",pointsReward:mo.completionBonus,tags:["weekend-ready","casual-chic"],photoPrompt:"Envie fotos de looks de fim de semana que voc ama ou gostaria de experimentar",questions:[{id:1,question:"O que voc mais valoriza num look de lazer?",subtext:"Quando no tem compromisso formal",options:[{text:"Conforto acima de tudo",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}},{text:"Quero estar bem vestida mesmo relaxando",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Feminilidade e leveza",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}},{text:"Praticidade  vestir rpido e sair",styleBonus:{elegante:1,classica:2,minimal:3,romantica:0}}]},{id:2,question:"Qual combinao  a sua cara?",subtext:"Aquela que voc monta de olhos fechados",options:[{text:"Jeans reto e camiseta premium",styleBonus:{elegante:1,classica:2,minimal:3,romantica:0}},{text:"Vestido fluido e rasteirinha de couro",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}},{text:"Cala wide e blusa elegante",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Saia midi e tnis branco",styleBonus:{elegante:0,classica:1,minimal:2,romantica:2}}]},{id:3,question:"Brunch com amigas  o que voc veste?",subtext:"Look para se divertir e se sentir bonita",options:[{text:"Vestido midi com estampa sutil",styleBonus:{elegante:1,classica:1,minimal:0,romantica:3}},{text:"Cala e blusa elegante",styleBonus:{elegante:2,classica:2,minimal:2,romantica:0}},{text:"Jeans, blazer leve e sapatilha",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Conjunto confortvel e estiloso",styleBonus:{elegante:0,classica:1,minimal:3,romantica:1}}]},{id:4,question:"Qual  a sua bolsa ideal para o fim de semana?",subtext:"Funcionalidade com personalidade",options:[{text:"Grande e espaosa  levo tudo comigo",styleBonus:{elegante:1,classica:2,minimal:2,romantica:0}},{text:"Crossbody compacta  s o essencial",styleBonus:{elegante:1,classica:1,minimal:3,romantica:1}},{text:"Bolsa de couro estruturada",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Clutch ou bolsa delicada",styleBonus:{elegante:2,classica:0,minimal:0,romantica:3}}]},{id:5,question:"Seu calado favorito para dias livres?",subtext:"O que seus ps escolhem quando so livres",options:[{text:"Tnis branco minimalista",styleBonus:{elegante:1,classica:2,minimal:3,romantica:0}},{text:"Sandlia colorida ou estampada",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}},{text:"Plataforma ou chunky sneaker",styleBonus:{elegante:2,classica:1,minimal:1,romantica:1}},{text:"Mocassim ou loafer",styleBonus:{elegante:0,classica:3,minimal:2,romantica:1}}]}]},{id:"color-discovery",title:"Sua Paleta Pessoal",subtitle:"Descubra as cores que mais te valorizam",emoji:"",theme:"colors",pointsReward:mo.completionBonus,tags:["color-confident","palette-defined"],photoPrompt:"Envie fotos de peas ou looks com cores que te atraem",questions:[{id:1,question:"Qual paleta mais te representa?",subtext:"As cores que dominam o seu closet",options:[{text:"Preto, branco e cinza  seguro e sofisticado",styleBonus:{elegante:3,classica:1,minimal:3,romantica:0}},{text:"Bege, caramelo e off-white  quente e acolhedor",styleBonus:{elegante:1,classica:3,minimal:2,romantica:1}},{text:"Rosa, lavanda e pssego  suave e feminino",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}},{text:"Azul, verde e terrosos  natural e moderno",styleBonus:{elegante:1,classica:2,minimal:2,romantica:1}}]},{id:2,question:"Qual a sua relao com estampas coloridas?",subtext:"Isso define o nvel de ousadia da sua curadoria",options:[{text:"Prefiro tons lisos  a cor fala por si",styleBonus:{elegante:2,classica:2,minimal:3,romantica:0}},{text:"Gosto de listras e geomtricos clssicos",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Adoro florais delicados",styleBonus:{elegante:0,classica:1,minimal:0,romantica:3}},{text:"Curto animal print e estampas marcantes",styleBonus:{elegante:3,classica:1,minimal:0,romantica:1}}]},{id:3,question:"Tem alguma cor que voc evita?",subtext:"Importante saber isso para a sua curadoria",options:[{text:"Cores neon e muito chamativas",styleBonus:{elegante:2,classica:3,minimal:2,romantica:1}},{text:"Tons pastis  acho que no combinam comigo",styleBonus:{elegante:2,classica:1,minimal:2,romantica:0}},{text:"Preto total  acho pesado demais",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}},{text:"Neutros demais  quero mais vida",styleBonus:{elegante:1,classica:0,minimal:0,romantica:2}}]},{id:4,question:"Qual cor voc gostaria de usar com mais confiana?",subtext:"Aquela que te atrai mas voc ainda no ousou",options:[{text:"Vermelho  poderoso e marcante",styleBonus:{elegante:3,classica:1,minimal:0,romantica:1}},{text:"Azul profundo  elegncia discreta",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Verde  sofisticao natural",styleBonus:{elegante:1,classica:2,minimal:2,romantica:1}},{text:"Rosa intenso  feminino e ousado",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}}]},{id:5,question:"Como voc monta um look colorido?",subtext:"A estratgia com cor diz muito sobre seu estilo",options:[{text:"Uma pea statement e o restante neutro",styleBonus:{elegante:2,classica:3,minimal:2,romantica:0}},{text:"Total color  uma cor da cabea aos ps",styleBonus:{elegante:3,classica:1,minimal:1,romantica:1}},{text:"Mix de tons prximos  monocromtico suave",styleBonus:{elegante:1,classica:2,minimal:3,romantica:1}},{text:"Contrastes ousados  adoro misturar",styleBonus:{elegante:1,classica:0,minimal:0,romantica:3}}]}]},{id:"special-occasions",title:"Looks para Ocasies Especiais",subtitle:"O que vestir nos momentos mais importantes",emoji:"",theme:"events",pointsReward:mo.completionBonus,tags:["event-ready","celebration-style"],photoPrompt:"Envie referncias de looks de festa ou eventos que te inspiram",questions:[{id:1,question:"Jantar especial  o que voc escolheria?",subtext:"O look que te faz sentir confiante e bonita",options:[{text:"Vestido elegante e estruturado",styleBonus:{elegante:3,classica:2,minimal:0,romantica:1}},{text:"Conjunto sofisticado de alfaiataria",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Look monocromtico impactante",styleBonus:{elegante:1,classica:1,minimal:3,romantica:0}},{text:"Vestido fluido com movimento e cor",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}}]},{id:2,question:"Qual acessrio eleva seu look de evento?",subtext:"O toque final que transforma o visual",options:[{text:"Joia statement  brinco ou colar marcante",styleBonus:{elegante:3,classica:1,minimal:0,romantica:1}},{text:"Bolsa clssica de qualidade",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Peas minimalistas e discretas",styleBonus:{elegante:1,classica:1,minimal:3,romantica:0}},{text:"Detalhes delicados e femininos",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}}]},{id:3,question:"Casamento como convidada  seu estilo?",subtext:"O equilbrio entre elegncia e personalidade",options:[{text:"Vestido midi elegante e discreto",styleBonus:{elegante:3,classica:2,minimal:1,romantica:1}},{text:"Conjunto com alfaiataria impecvel",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Vestido longo e fluido",styleBonus:{elegante:1,classica:1,minimal:0,romantica:3}},{text:"Jumpsuit sofisticado e moderno",styleBonus:{elegante:2,classica:1,minimal:3,romantica:0}}]},{id:4,question:"Qual salto combina com voc em eventos?",subtext:"O sapato certo completa todo o visual",options:[{text:"Stiletto alto  impacto mximo",styleBonus:{elegante:3,classica:1,minimal:0,romantica:1}},{text:"Salto bloco  elegncia com conforto",styleBonus:{elegante:1,classica:3,minimal:2,romantica:0}},{text:"Mule com salto mdio",styleBonus:{elegante:2,classica:2,minimal:3,romantica:0}},{text:"Sandlia delicada com tiras finas",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}}]},{id:5,question:"Como voc prefere sua maquiagem em eventos?",subtext:"O make complementa a histria do look",options:[{text:"Batom marcante  vermelho ou vinho",styleBonus:{elegante:3,classica:2,minimal:0,romantica:0}},{text:"Olho marcado e boca nude",styleBonus:{elegante:2,classica:3,minimal:1,romantica:0}},{text:"Natural, luminoso e clean",styleBonus:{elegante:1,classica:1,minimal:3,romantica:1}},{text:"Tons rosados e pele iluminada",styleBonus:{elegante:0,classica:0,minimal:0,romantica:3}}]}]}];function cv(e){return Tw.filter(t=>!e.includes(t.id))}function Pw(e){return Tw.find(t=>t.id===e)}const ns={poa:{id:"poa",name:"Po",minPoints:0,maxPoints:999,multiplier:1,color:"bg-stone-500",benefits:["Acumule 1 ponto a cada R$ 1 gasto","Acesso antecipado a promoes","Presente de aniversrio"]},poa_gold:{id:"poa_gold",name:"Po Gold",minPoints:1e3,maxPoints:2999,multiplier:1.1,color:"#C5A572",benefits:["Todos os benefcios Po","Acumule 1.1 pontos a cada R$ 1 gasto","Frete grtis em 1 pedido por ms","Consultoria de estilo express"]},poa_platinum:{id:"poa_platinum",name:"Po Platinum",minPoints:3e3,maxPoints:5999,multiplier:1.2,color:"#E5E4E2",benefits:["Todos os benefcios Gold","Acumule 1.2 pontos a cada R$ 1 gasto","Frete grtis ilimitado","Acesso a eventos exclusivos"]},poa_black:{id:"poa_black",name:"Po Black",minPoints:6e3,maxPoints:1/0,multiplier:1.3,color:"#000000",benefits:["Todos os benefcios Platinum","Acumule 1.3 pontos a cada R$ 1 gasto","Concierge pessoal","Presentes exclusivos da marca"]}},j3=["poa","poa_gold","poa_platinum","poa_black"];function Vme(e){return e>=ns.poa_black.minPoints?ns.poa_black:e>=ns.poa_platinum.minPoints?ns.poa_platinum:e>=ns.poa_gold.minPoints?ns.poa_gold:ns.poa}const TR=[{points:500,value:25},{points:1e3,value:60},{points:2e3,value:150}],qme=.2,N3=200,Wme={basic_profile:{name:"Perfil Bsico",points:150,oneTime:!0},preferences:{name:"Preferncias de Estilo",points:150,oneTime:!0},measurements:{name:"Minhas Medidas",points:200,oneTime:!0},prints_photos:{name:"Meus Prints/Fotos",points:150,oneTime:!0}},Hme={update_style:{name:"Atualizar Estilo",points:80,interval:"monthly"},post_purchase_feedback:{name:"Feedback Ps-Compra",points:50,interval:"monthly"},occasion_month:{name:"Ocasio do Ms",points:50,interval:"monthly"}};function C1(){const{user:e}=Hn(),[t,r]=P.useState(null),[s,a]=P.useState([]),[i,o]=P.useState([]),[c,d]=P.useState([]),[l,u]=P.useState(!0),h=P.useCallback(D=>ns[D],[]),f=P.useCallback(D=>{const L=j3.indexOf(D);return L<j3.length-1?j3[L+1]:null},[]),m=P.useCallback((D,L)=>{const q=f(L);if(!q)return{progress:100,pointsNeeded:0,nextTierName:null};const X=ns[L],H=ns[q],M=D-X.minPoints,F=H.minPoints-X.minPoints,S=Math.min(M/F*100,100),E=Math.max(H.minPoints-D,0);return{progress:S,pointsNeeded:E,nextTierName:H.name}},[f]),p=P.useCallback(D=>D<N3,[]),g=P.useCallback(D=>Math.max(N3-D,0),[]),v=P.useCallback(D=>{const L=D*qme,q=TR.filter(H=>H.value<=L);if(q.length===0)return{maxPoints:0,maxDiscount:0};const X=q[q.length-1];return{maxPoints:X.points,maxDiscount:X.value}},[]),x=P.useCallback(async()=>{if(!e){r(null),u(!1);return}try{let{data:D,error:L}=await ce.from("customer_loyalty").select("*").eq("user_id",e.id).maybeSingle();if(!D&&!L){const{data:q,error:X}=await ce.from("customer_loyalty").insert({user_id:e.id}).select().single();if(X)throw X;D=q}D&&r({id:D.id,currentPoints:D.current_points,lifetimePoints:D.lifetime_points,annualPoints:D.annual_points,currentTier:D.current_tier,weeklyMissionPoints:D.weekly_mission_points,weeklyMissionResetAt:D.weekly_mission_reset_at})}catch(D){console.error("Error fetching loyalty:",D)}finally{u(!1)}},[e]),y=P.useCallback(async()=>{if(e)try{const{data:D,error:L}=await ce.from("point_transactions").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(50);if(L)throw L;a((D||[]).map(q=>({id:q.id,type:q.type,points:q.points,description:q.description,orderId:q.order_id,missionId:q.mission_id,rewardId:q.reward_id,expiresAt:q.expires_at,expired:q.expired,multiplier:q.multiplier||1,basePoints:q.base_points,createdAt:q.created_at})))}catch(D){console.error("Error fetching transactions:",D)}},[e]),b=P.useCallback(async()=>{try{const{data:D,error:L}=await ce.from("loyalty_rewards").select("*").eq("is_active",!0).order("points_cost",{ascending:!0});if(L)throw L;o((D||[]).map(q=>({id:q.id,name:q.name,description:q.description,imageUrl:q.image_url,type:q.type,pointsCost:q.points_cost,discountValue:q.discount_value,minTier:q.min_tier,stockQty:q.stock_qty,unlimitedStock:q.unlimited_stock,isActive:q.is_active,isFeatured:q.is_featured})))}catch(D){console.error("Error fetching rewards:",D)}},[]),j=P.useCallback(async()=>{if(e)try{const{data:D,error:L}=await ce.from("reward_redemptions").select("*, loyalty_rewards(*)").eq("user_id",e.id).order("created_at",{ascending:!1});if(L)throw L;d((D||[]).map(q=>({id:q.id,rewardId:q.reward_id,pointsSpent:q.points_spent,couponCode:q.coupon_code,rewardType:q.reward_type,discountValue:q.discount_value,status:q.status,expiresAt:q.expires_at,createdAt:q.created_at,reward:q.loyalty_rewards?{id:q.loyalty_rewards.id,name:q.loyalty_rewards.name,description:q.loyalty_rewards.description,imageUrl:q.loyalty_rewards.image_url,type:q.loyalty_rewards.type,pointsCost:q.loyalty_rewards.points_cost,discountValue:q.loyalty_rewards.discount_value,minTier:q.loyalty_rewards.min_tier,stockQty:q.loyalty_rewards.stock_qty,unlimitedStock:q.loyalty_rewards.unlimited_stock,isActive:q.loyalty_rewards.is_active,isFeatured:q.loyalty_rewards.is_featured}:void 0})))}catch(D){console.error("Error fetching redemptions:",D)}},[e]),T=P.useCallback(D=>{if(!t)return{canRedeem:!1,reason:"Faa login para resgatar"};if(t.currentPoints<D.pointsCost)return{canRedeem:!1,reason:`Faltam ${D.pointsCost-t.currentPoints} pontos`};const L=["poa","poa_gold","poa_platinum","poa_black"];return L.indexOf(t.currentTier)<L.indexOf(D.minTier)?{canRedeem:!1,reason:`Necessrio nvel ${ns[D.minTier].name}`}:!D.unlimitedStock&&(D.stockQty===null||D.stockQty<=0)?{canRedeem:!1,reason:"Esgotado"}:{canRedeem:!0,reason:null}},[t]),O=P.useCallback(async D=>{if(!e||!t)return null;const L=i.find(H=>H.id===D);if(!L)return null;const{canRedeem:q,reason:X}=T(L);if(!q)throw new Error(X||"No  possvel resgatar");try{const{data:H,error:M}=await ce.rpc("generate_reward_coupon");if(M)throw M;const F=H,S=new Date;S.setDate(S.getDate()+30);const{data:E,error:N}=await ce.from("reward_redemptions").insert({user_id:e.id,reward_id:D,points_spent:L.pointsCost,coupon_code:F,reward_type:L.type,discount_value:L.discountValue,expires_at:S.toISOString()}).select().single();if(N)throw N;const{error:C}=await ce.from("point_transactions").insert({user_id:e.id,type:"redemption",points:-L.pointsCost,description:`Resgate: ${L.name}`,reward_id:D,redemption_id:E.id});if(C)throw C;const{error:k}=await ce.from("customer_loyalty").update({current_points:t.currentPoints-L.pointsCost,updated_at:new Date().toISOString()}).eq("id",t.id);if(k)throw k;return await Promise.all([x(),j(),y()]),F}catch(H){throw console.error("Error redeeming reward:",H),H}},[e,t,i,T,x,j,y]),R=P.useCallback(()=>{const D=new Date;return D.setDate(D.getDate()+30),s.filter(L=>L.points>0&&!L.expired&&L.expiresAt&&new Date(L.expiresAt)<=D).reduce((L,q)=>L+q.points,0)},[s]);return P.useEffect(()=>{x(),b()},[x,b]),P.useEffect(()=>{e&&(y(),j())},[e,y,j]),{loyalty:t,transactions:s,rewards:i,redemptions:c,isLoading:l,getTierInfo:h,getNextTier:f,getProgressToNextTier:m,canEarnMissionPoints:p,getMissionPointsRemaining:g,monthlyMissionLimit:N3,canRedeemReward:T,redeemReward:O,getExpiringPoints:R,getMaxRedeemablePoints:v,fixedMissions:Wme,recurringMissions:Hme,redemptionDiscounts:TR,refetch:x}}var cq="AlertDialog",[Gme,iet]=ta(cq,[MV]),Nd=MV(),dq=e=>{const{__scopeAlertDialog:t,...r}=e,s=Nd(t);return n.jsx(w1,{...s,...r,modal:!0})};dq.displayName=cq;var Kme="AlertDialogTrigger",uq=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,a=Nd(r);return n.jsx(z_,{...a,...s,ref:t})});uq.displayName=Kme;var Xme="AlertDialogPortal",hq=e=>{const{__scopeAlertDialog:t,...r}=e,s=Nd(t);return n.jsx(_1,{...s,...r})};hq.displayName=Xme;var Yme="AlertDialogOverlay",fq=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,a=Nd(r);return n.jsx(Tf,{...a,...s,ref:t})});fq.displayName=Yme;var Ym="AlertDialogContent",[Zme,Qme]=Gme(Ym),Jme=pz("AlertDialogContent"),mq=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,children:s,...a}=e,i=Nd(r),o=P.useRef(null),c=Ir(t,o),d=P.useRef(null);return n.jsx(Bfe,{contentName:Ym,titleName:pq,docsSlug:"alert-dialog",children:n.jsx(Zme,{scope:r,cancelRef:d,children:n.jsxs(Pf,{role:"alertdialog",...i,...a,ref:c,onOpenAutoFocus:kt(a.onOpenAutoFocus,l=>{var u;l.preventDefault(),(u=d.current)==null||u.focus({preventScroll:!0})}),onPointerDownOutside:l=>l.preventDefault(),onInteractOutside:l=>l.preventDefault(),children:[n.jsx(Jme,{children:s}),n.jsx(tpe,{contentRef:o})]})})})});mq.displayName=Ym;var pq="AlertDialogTitle",gq=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,a=Nd(r);return n.jsx(jg,{...a,...s,ref:t})});gq.displayName=pq;var xq="AlertDialogDescription",vq=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,a=Nd(r);return n.jsx(Ng,{...a,...s,ref:t})});vq.displayName=xq;var epe="AlertDialogAction",yq=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,a=Nd(r);return n.jsx(j1,{...a,...s,ref:t})});yq.displayName=epe;var bq="AlertDialogCancel",wq=P.forwardRef((e,t)=>{const{__scopeAlertDialog:r,...s}=e,{cancelRef:a}=Qme(bq,r),i=Nd(r),o=Ir(t,a);return n.jsx(j1,{...i,...s,ref:o})});wq.displayName=bq;var tpe=({contentRef:e})=>{const t=`\`${Ym}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Ym}\` by passing a \`${xq}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Ym}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return P.useEffect(()=>{var s;document.getElementById((s=e.current)==null?void 0:s.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},rpe=dq,npe=uq,spe=hq,_q=fq,jq=mq,Nq=yq,Sq=wq,Cq=gq,Eq=vq;const Ac=rpe,E1=npe,ape=spe,kq=P.forwardRef(({className:e,...t},r)=>n.jsx(_q,{className:We("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:r}));kq.displayName=_q.displayName;const Dl=P.forwardRef(({className:e,...t},r)=>n.jsxs(ape,{children:[n.jsx(kq,{}),n.jsx(jq,{ref:r,className:We("fixed left-[50%] top-[50%] z-50 grid w-[min(92vw,480px)] max-w-[92vw] max-h-[85vh] overflow-y-auto translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-4 sm:p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg",e),...t})]}));Dl.displayName=jq.displayName;const Ll=({className:e,...t})=>n.jsx("div",{className:We("flex flex-col space-y-2 text-center sm:text-left",e),...t});Ll.displayName="AlertDialogHeader";const Tc=({className:e,...t})=>n.jsx("div",{className:We("flex flex-col gap-2 sm:flex-row sm:justify-end sm:space-x-2",e),...t});Tc.displayName="AlertDialogFooter";const Bl=P.forwardRef(({className:e,...t},r)=>n.jsx(Cq,{ref:r,className:We("text-lg font-semibold",e),...t}));Bl.displayName=Cq.displayName;const $l=P.forwardRef(({className:e,...t},r)=>n.jsx(Eq,{ref:r,className:We("text-sm text-muted-foreground",e),...t}));$l.displayName=Eq.displayName;const Pc=P.forwardRef(({className:e,...t},r)=>n.jsx(Nq,{ref:r,className:We(sv(),e),...t}));Pc.displayName=Nq.displayName;const Oc=P.forwardRef(({className:e,...t},r)=>n.jsx(Sq,{ref:r,className:We(sv({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));Oc.displayName=Sq.displayName;const ipe=()=>{const e=fr(),{user:t,isLoading:r}=Hn(),[s,a]=P.useState(null),[i,o]=P.useState(!0),[c,d]=P.useState(null);P.useEffect(()=>{if(!r){if(!t){e("/entrar",{state:{from:"/meu-estilo",message:"Entre ou crie sua conta para salvar seu estilo e receber sugestes no seu tamanho."}});return}l(),u()}},[t,r,e]);const l=async()=>{if(t)try{const{data:X,error:H}=await ce.from("profiles").select(`
          name, full_name, style_title, style_description, 
          size_letter, size_number, quiz_points, quiz_level, 
          quiz_completed_at, completed_missions, last_mission_id,
          last_mission_completed_at, color_palette, personal_tip
        `).eq("user_id",t.id).maybeSingle();if(H)throw H;a(X||{name:null,full_name:null,style_title:null,style_description:null,size_letter:null,size_number:null,quiz_points:0,quiz_level:1,quiz_completed_at:null,completed_missions:[],last_mission_id:null,last_mission_completed_at:null,color_palette:null,personal_tip:null})}catch(X){console.error("Error loading profile:",X)}finally{o(!1)}},u=async()=>{if(t)try{const{data:X}=await ce.from("mission_attempts").select("mission_id").eq("user_id",t.id).eq("status","in_progress").order("updated_at",{ascending:!1}).limit(1).maybeSingle();d((X==null?void 0:X.mission_id)||null)}catch(X){console.error("Error checking in-progress mission:",X)}},h=!!(s!=null&&s.quiz_completed_at)&&!!(s!=null&&s.style_title),{loyalty:f,getTierInfo:m,getProgressToNextTier:p,isLoading:g}=C1();if(P.useEffect(()=>{!i&&s&&!h&&e("/quiz")},[i,s,h,e]),r||i||g)return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gold"})})]});if(!s||!h)return null;const v=(f==null?void 0:f.currentPoints)||0,x=(f==null?void 0:f.currentTier)||"poa",y=m(x),{progress:b,pointsNeeded:j,nextTierName:T}=p((f==null?void 0:f.annualPoints)||0,x);s.full_name||s.name;const O=[s.size_letter,s.size_number].filter(Boolean).join(" / "),R=s.completed_missions||[],D=Tw.filter(X=>R.includes(X.id)),L=Tw.filter(X=>!R.includes(X.id)),q=L[0];return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-6 max-w-lg",children:[n.jsx("div",{className:"text-center mb-6",children:n.jsx("p",{className:"text-xs text-muted-foreground",children:"Quanto mais voc completa misses, mais perfeito fica seu provador no seu tamanho "})}),n.jsxs("div",{className:"bg-primary text-white border border-gold/20 rounded-3xl p-8 mb-8 relative overflow-hidden shadow-2xl",children:[n.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-gold/10 rounded-full blur-2xl -mr-16 -mt-16"}),n.jsxs("div",{className:"text-center relative z-10",children:[n.jsx("span",{className:"text-gold text-[10px] tracking-[0.4em] uppercase font-bold mb-3 block",children:"Peronal Stylist VIP"}),n.jsxs("h1",{className:"font-serif text-3xl mb-2 italic",children:["Ol, ",s.name||"voc"," "]}),n.jsx("p",{className:"text-gold font-medium tracking-wide uppercase text-xs mb-4",children:s.style_title}),O&&n.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 bg-white/5 rounded-full border border-white/10 text-xs font-light",children:["Tamanho Ideal: ",n.jsx("span",{className:"font-bold text-white",children:O})]})]}),s.color_palette&&s.color_palette.length>0&&n.jsxs("div",{className:"flex flex-col items-center gap-3 mt-8",children:[n.jsx("p",{className:"text-[10px] tracking-widest uppercase text-white/40 font-bold",children:"Sua Paleta de Cores"}),n.jsx("div",{className:"flex gap-2",children:s.color_palette.slice(0,5).map((X,H)=>n.jsx("div",{className:"w-8 h-8 rounded-full border border-white/20 shadow-inner",style:{backgroundColor:X},title:X},H))})]})]}),n.jsxs("div",{className:"bg-white border border-gold/10 rounded-3xl p-6 mb-8 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gold/10 flex items-center justify-center text-gold",children:n.jsx(ga,{className:"h-5 w-5"})}),n.jsx("h2",{className:"font-serif text-xl text-primary",children:"Status Club Le.Po"})]}),n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-[10px] tracking-widest uppercase text-muted-foreground mb-1",children:"Pontuao Acumulada"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ki,{className:"h-4 w-4 text-gold fill-gold"}),n.jsx("span",{className:"text-2xl font-bold text-primary",children:v})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("span",{className:"text-[10px] tracking-widest uppercase text-muted-foreground mb-1 block",children:"Nvel Atual"}),n.jsx("span",{className:"font-bold text-gold tracking-[0.1em] uppercase",children:y.name})]})]}),T?n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between text-[11px] mb-2",children:[n.jsxs("span",{className:"text-muted-foreground",children:["Prximo nvel: ",n.jsx("span",{className:"text-primary font-bold",children:T})]}),n.jsxs("span",{className:"text-gold font-bold",children:[j," pts para subir"]})]}),n.jsx("div",{className:"h-1.5 w-full bg-secondary rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-gold transition-all duration-1000",style:{width:`${b}%`}})})]}):n.jsxs("div",{className:"flex items-center gap-2 text-sm text-gold mb-6 py-2 px-4 bg-gold/5 rounded-full border border-gold/10",children:[n.jsx(pn,{className:"h-4 w-4"}),n.jsx("span",{className:"font-bold tracking-wide uppercase text-[10px]",children:"MEMBRO DIAMANTE  Nvel Mximo"})]}),n.jsx("p",{className:"text-[10px] text-muted-foreground italic text-center px-4 leading-relaxed",children:"Avance de nvel para desbloquear pr-vendas exclusivas, frete grtis e presentes surpresa."})]}),n.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 border border-amber-200 dark:border-amber-800 rounded-xl p-4 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Rn,{className:"h-5 w-5 text-amber-600"}),n.jsx("h3",{className:"font-medium text-amber-800 dark:text-amber-200",children:"Recompensas"})]}),n.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:"Seus pontos podem virar presentes e vantagens exclusivas (em breve). "})]}),n.jsxs("div",{className:"space-y-3 mb-6",children:[c?n.jsx(Gt,{to:`/missao/${c}`,children:n.jsxs(he,{className:"w-full gap-2 bg-amber-500 hover:bg-amber-600 text-white",children:[n.jsx(Br,{className:"h-4 w-4"}),"Continuar de onde parei",n.jsx(ps,{className:"h-4 w-4"})]})}):q?n.jsx(Gt,{to:`/missao/${q.id}`,children:n.jsxs(he,{className:"btn-gold w-full h-14 rounded-full gap-2 shadow-lg group",children:[n.jsx(ba,{className:"h-5 w-5"}),"CONTINUAR TRILHA DE ESTILO",n.jsx(ps,{className:"h-4 w-4 transition-transform group-hover:translate-x-1"})]})}):n.jsxs("div",{className:"text-center text-sm text-muted-foreground bg-card rounded-xl p-3 border",children:[n.jsx(pn,{className:"h-5 w-5 text-accent mx-auto mb-1"}),"Todas as misses completadas! "]}),n.jsx(Gt,{to:"/minhas-sugestoes",children:n.jsxs(he,{variant:"outline",className:"w-full gap-2",children:[n.jsx(ci,{className:"h-4 w-4"}),"Ver minhas sugestes"]})})]}),n.jsxs("div",{className:"space-y-6",children:[L.length>0&&n.jsxs("div",{children:[n.jsxs("h3",{className:"font-serif text-lg mb-3 flex items-center gap-2",children:[n.jsx(ba,{className:"h-4 w-4 text-accent"}),"Misses Disponveis"]}),n.jsx("div",{className:"space-y-3",children:L.map((X,H)=>n.jsx(PR,{mission:X,isCompleted:!1,isInProgress:c===X.id,isNextSuggested:H===0&&!c},X.id))})]}),D.length>0&&n.jsxs("div",{children:[n.jsxs("h3",{className:"font-serif text-lg mb-3 flex items-center gap-2",children:[n.jsx(pn,{className:"h-4 w-4 text-green-500"}),"Misses Concludas (",D.length,")"]}),n.jsx("div",{className:"space-y-3",children:D.map(X=>n.jsx(PR,{mission:X,isCompleted:!0},X.id))})]})]}),n.jsx("div",{className:"mt-8 pt-6 border-t border-border",children:n.jsxs(Ac,{children:[n.jsx(E1,{asChild:!0,children:n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full text-muted-foreground hover:text-foreground gap-2",children:[n.jsx(f1,{className:"h-4 w-4"}),"Refazer Quiz Base"]})}),n.jsxs(Dl,{children:[n.jsxs(Ll,{children:[n.jsx(Bl,{children:"Refazer Quiz Base?"}),n.jsxs($l,{children:["Voc pode refazer o quiz para atualizar seu perfil de estilo.",n.jsx("span",{className:"block mt-2 font-medium text-foreground",children:"Seus pontos sero mantidos  no sero somados novamente."})]})]}),n.jsxs(Tc,{children:[n.jsx(Oc,{children:"Cancelar"}),n.jsx(Pc,{asChild:!0,children:n.jsx(Gt,{to:"/quiz?redo=true",children:n.jsx(he,{children:"Refazer Quiz"})})})]})]})]})})]})]})};function PR({mission:e,isCompleted:t,isInProgress:r,isNextSuggested:s}){const a=Ume(e);return n.jsx(Gt,{to:`/missao/${e.id}`,children:n.jsx(De,{className:`transition-all duration-300 hover:shadow-lg rounded-[2rem] overflow-hidden ${t?"bg-muted/10 border-transparent opacity-60":r?"border-gold/30 bg-gold/5 shadow-sm":s?"border-primary/10 bg-white":"border-border shadow-none"}`,children:n.jsx(Be,{className:"p-6",children:n.jsxs("div",{className:"flex items-center gap-5",children:[n.jsx("div",{className:"w-14 h-14 rounded-2xl bg-secondary flex items-center justify-center text-3xl shadow-header",children:e.emoji}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:"font-serif text-lg text-primary truncate",children:e.title}),t&&n.jsx(pn,{className:"h-4 w-4 text-emerald-600 flex-shrink-0"}),r&&n.jsx("span",{className:"text-[9px] font-bold tracking-widest uppercase text-gold",children:"Em andamento"})]}),n.jsx("p",{className:"text-xs text-muted-foreground truncate font-light tracking-wide",children:e.subtitle}),n.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[n.jsxs("div",{className:"px-2.5 py-1 rounded-full bg-secondary text-primary text-[9px] font-bold uppercase tracking-wider",children:["+",a," PTS"]}),n.jsxs("div",{className:"text-[10px] text-muted-foreground",children:[" ",e.questions.length," Questes"]})]})]}),n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground/30 flex-shrink-0"})]})})})})}const Yn=P.forwardRef(({className:e,...t},r)=>n.jsx("textarea",{className:We("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...t}));Yn.displayName="Textarea";function ope({current:e,total:t}){const r=e/t*100;return n.jsxs("div",{className:"w-full space-y-5",children:[n.jsx("div",{className:"text-center",children:n.jsx("p",{className:"text-[10px] tracking-[0.3em] uppercase text-foreground/40 font-medium",children:"Sua consultoria de estilo"})}),n.jsxs("div",{children:[n.jsx("div",{className:"h-px bg-border relative",children:n.jsx("div",{className:"h-px bg-foreground transition-all duration-700 ease-out",style:{width:`${r}%`}})}),n.jsxs("div",{className:"flex justify-between mt-2.5",children:[n.jsxs("span",{className:"text-[11px] text-foreground/40 tracking-wide",children:[e," de ",t]}),n.jsxs("span",{className:"text-[11px] text-foreground/40 tracking-wide",children:[Math.round(r),"%"]})]})]})]})}function Aq({text:e,imageUrl:t,isSelected:r,onClick:s}){return n.jsx("button",{onClick:s,className:We("relative w-full p-6 transition-all duration-500 text-left rounded-[2rem] border-2 group","active:scale-[0.98]",r?"border-gold bg-gold/5 shadow-md":"border-primary/5 bg-white hover:border-primary/20 hover:shadow-lg"),children:n.jsxs("div",{className:"flex items-center gap-5",children:[t&&n.jsx("div",{className:"w-16 h-16 rounded-2xl overflow-hidden shadow-sm border border-primary/5 flex-shrink-0",children:n.jsx("img",{src:t,alt:e,className:We("w-full h-full object-cover transition-all duration-300",r&&"scale-110")})}),n.jsx("span",{className:We("font-serif text-lg flex-1 transition-colors duration-300 tracking-wide",r?"text-primary font-bold":"text-primary/60"),children:e}),n.jsx("div",{className:`
          flex-shrink-0 w-6 h-6 rounded-full border-2 flex items-center justify-center transition-all duration-300
          ${r?"border-gold bg-gold":"border-primary/10 group-hover:border-primary/30"}
        `,children:r&&n.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})})]})})}const lpe=["PP","P","M","G","GG"],cpe=["34","36","38","40","42","44","46"];function dpe({selectedLetterSize:e,selectedNumberSize:t,onSelectLetter:r,onSelectNumber:s}){const a=o=>{r(e===o?null:o)},i=o=>{s(t===o?null:o)};return n.jsxs("div",{className:"space-y-8",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/40 font-medium mb-4",children:["Tamanho em letras ",n.jsx("span",{className:"text-foreground/60",children:"(opcional)"})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:lpe.map((o,c)=>n.jsx("button",{onClick:()=>a(o),style:{animationDelay:`${c*50}ms`},className:We("w-14 h-14 border font-light tracking-wide text-sm transition-all duration-300 animate-slide-in-up","hover:border-foreground/40",e===o?"border-foreground bg-foreground text-background font-normal":"border-border bg-transparent text-foreground/60"),children:o},o))})]}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/40 font-medium mb-4",children:["Numerao ",n.jsx("span",{className:"text-foreground/60",children:"(opcional)"})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:cpe.map((o,c)=>n.jsx("button",{onClick:()=>i(o),style:{animationDelay:`${(c+5)*50}ms`},className:We("w-14 h-14 border font-light tracking-wide text-sm transition-all duration-300 animate-slide-in-up","hover:border-foreground/40",t===o?"border-foreground bg-foreground text-background font-normal":"border-border bg-transparent text-foreground/60"),children:o},o))})]}),(e||t)&&n.jsx("div",{className:"border-t border-border pt-4",children:n.jsx("p",{className:"text-sm text-foreground/70 text-center font-light",children:e&&t?n.jsxs(n.Fragment,{children:["Seus tamanhos: ",n.jsx("span",{className:"font-medium text-foreground",children:e})," e ",n.jsx("span",{className:"font-medium text-foreground",children:t})]}):e?n.jsxs(n.Fragment,{children:["Seu tamanho: ",n.jsx("span",{className:"font-medium text-foreground",children:e})]}):n.jsxs(n.Fragment,{children:["Sua numerao: ",n.jsx("span",{className:"font-medium text-foreground",children:t})]})})})]})}function Tq({points:e,show:t,onComplete:r}){const[s,a]=P.useState(!1),[i,o]=P.useState(0);return P.useEffect(()=>{if(t&&e>0){a(!0),requestAnimationFrame(()=>{o(1)});const c=setTimeout(()=>{o(0),setTimeout(()=>{a(!1),r==null||r()},300)},1500);return()=>clearTimeout(c)}},[t,e,r]),s?n.jsx("div",{className:"fixed bottom-24 right-4 pointer-events-none z-40",children:n.jsx("div",{className:We("transition-all duration-300 ease-out",i===1?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:n.jsx("div",{className:"bg-stone-900/90 backdrop-blur-sm rounded-lg px-4 py-2 shadow-lg border border-stone-700",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Wr,{className:"h-4 w-4 text-amber-400"}),n.jsxs("span",{className:"text-sm font-medium text-white",children:["+",e," pontos"]})]})})})}):null}const Dy=[{id:1,question:"Como voc gostaria de ser percebida quando entra em um lugar?",subtext:"Sua consultora pessoal comea aqui",type:"single",pointsType:"key",options:[{text:"Sofisticada e poderosa  comando respeito",points:{elegante:3,classica:1,minimal:0,romantica:0}},{text:"Elegante sem esforo  tudo parece natural em mim",points:{elegante:1,classica:3,minimal:1,romantica:0}},{text:"Moderna e despojada  menos  mais",points:{elegante:0,classica:1,minimal:3,romantica:0}},{text:"Feminina e marcante  os detalhes me definem",points:{elegante:0,classica:0,minimal:0,romantica:3}}]},{id:2,question:"Como  a sua rotina na maior parte da semana?",subtext:"Para montar sugestes que funcionem na sua vida real",type:"single",pointsType:"common",options:[{text:"Escritrio, reunies e ambientes corporativos",points:{elegante:3,classica:2,minimal:0,romantica:0}},{text:"Flexvel  misturo trabalho, casa e compromissos",points:{elegante:1,classica:2,minimal:3,romantica:0}},{text:"Home office, mas saio bastante nos fins de semana",points:{elegante:0,classica:1,minimal:3,romantica:1}},{text:"Vida social ativa  eventos, encontros e sadas",points:{elegante:1,classica:0,minimal:0,romantica:3}}]},{id:3,question:"Quais cores te fazem se sentir mais bonita?",subtext:"Cores revelam muito sobre quem voc ",type:"single",pointsType:"key",options:[{text:"Preto, marinho e tons escuros  no erro nunca",points:{elegante:3,classica:1,minimal:2,romantica:0}},{text:"Neutros quentes  bege, caramelo, terracota",points:{elegante:1,classica:3,minimal:2,romantica:0}},{text:"Cores vibrantes  vermelho, verde, azul royal, pink",points:{elegante:2,classica:0,minimal:0,romantica:2}},{text:"Tons suaves  rosa, lavanda, pssego, verde menta",points:{elegante:0,classica:0,minimal:1,romantica:3}},{text:"Branco e off-white  gosto de leveza e limpeza",points:{elegante:1,classica:1,minimal:3,romantica:1}}]},{id:4,question:"O que voc mais gosta de valorizar no seu corpo?",subtext:"Para escolher cortes que te favoream de verdade",type:"single",pointsType:"key",options:[{text:"A cintura  adoro peas que marquem",points:{elegante:3,classica:1,minimal:0,romantica:2}},{text:"Os ombros e a postura  gosto de estrutura",points:{elegante:3,classica:2,minimal:1,romantica:0}},{text:"Prefiro no marcar  gosto de caimento solto",points:{elegante:0,classica:1,minimal:3,romantica:1}},{text:"As pernas  saias e vestidos so meu forte",points:{elegante:1,classica:0,minimal:0,romantica:3}}]},{id:5,question:"Qual a sua maior dificuldade na hora de se vestir?",subtext:"Entender isso me ajuda a cuidar melhor de voc",type:"single",pointsType:"common",options:[{text:"No sei combinar peas  fico insegura",points:{elegante:0,classica:3,minimal:1,romantica:1}},{text:"No encontro roupas que valorizem meu corpo",points:{elegante:2,classica:1,minimal:1,romantica:1}},{text:"Canso de usar sempre a mesma coisa",points:{elegante:1,classica:0,minimal:0,romantica:3}},{text:"Compro e depois no uso  falta estratgia",points:{elegante:0,classica:1,minimal:3,romantica:0}}]},{id:6,question:"Se pudesse ter s 3 peas no closet, qual no ficaria de fora?",subtext:"A pea essencial diz muito sobre seu estilo",type:"single",pointsType:"common",options:[{text:"Blazer bem cortado",points:{elegante:3,classica:2,minimal:1,romantica:0}},{text:"Jeans perfeito + camisa atemporal",points:{elegante:0,classica:3,minimal:2,romantica:0}},{text:"Conjunto confortvel e estiloso",points:{elegante:0,classica:0,minimal:3,romantica:1}},{text:"Vestido que funciona pra tudo",points:{elegante:1,classica:1,minimal:0,romantica:3}}]},{id:7,question:"Qual a sua relao com estampas?",subtext:"Isso define o nvel de ousadia da sua curadoria",type:"single",pointsType:"common",options:[{text:"Prefiro peas lisas  a elegncia est no corte",points:{elegante:3,classica:1,minimal:2,romantica:0}},{text:"Gosto de listras, po e estampas clssicas",points:{elegante:1,classica:3,minimal:0,romantica:1}},{text:"Adoro  floral, animal print, estampa colorida",points:{elegante:0,classica:0,minimal:0,romantica:3}},{text:"Gosto de textura  tricot, linho, couro, tule",points:{elegante:1,classica:1,minimal:3,romantica:1}}]},{id:8,question:"Tem algum look que te inspira?",subtext:"Envie uma referncia  isso me ajuda a entender voc ainda melhor",type:"photos",pointsType:"photos"},{id:9,question:"Quer me contar mais sobre o que procura?",subtext:"Quanto mais eu souber, mais precisa ser a sua curadoria",type:"open",pointsType:"open"},{id:10,question:"Qual  o seu tamanho?",subtext:"Vou selecionar apenas peas disponveis na sua numerao",type:"size",pointsType:"key"}],SC={elegante:{id:"elegante",title:"Elegante Estratgica",subtitle:"Poder e sofisticao em cada detalhe",description:"Voc transmite confiana e autoridade sem dizer uma palavra. Suas escolhas so intencionais  cada pea  um statement. Voc sabe que a roupa certa abre portas, e busca qualidade, corte impecvel e presena.",highlights:["Voc valoriza qualidade sobre quantidade","Seu olhar  atrado por cortes impecveis e acabamento nobre","A roupa  sua ferramenta de poder e expresso"],valorizes:["estrutura","acabamento impecvel","tecidos nobres","cores fortes e sbrias"],tags:["elegante","power","luxo","trabalho","sofisticada"],emoji:"",colorPalette:["preto","branco","marinho","dourado","vermelho escuro"],keyPieces:["Blazer estruturado","Scarpin clssico","Bolsa de couro","Cala de alfaiataria"]},classica:{id:"classica",title:"Clssica Moderna",subtitle:"Atemporal com um toque contemporneo",description:"Voc constri um guarda-roupa com inteno. Prefere peas que atravessam temporadas a tendncias passageiras. Seu estilo  uma curadoria inteligente  cada pea combina com as outras, e vestir-se  simples porque tudo funciona junto.",highlights:["Seu closet  curado com estratgia  nada ali  acidente","Elegncia discreta  sua marca registrada","Voc investe em peas que duram anos, no semanas"],valorizes:["versatilidade","cortes clean","paleta neutra e harmnica","peas atemporais"],tags:["clssico","atemporal","neutro","trabalho","curado"],emoji:"",colorPalette:["bege","marinho","branco","caramelo","cinza"],keyPieces:["Camisa branca","Cala de alfaiataria","Trench coat","Scarpin nude"]},minimal:{id:"minimal",title:"Chic Minimal",subtitle:"Menos  mais  e voc prova isso todos os dias",description:"Voc encontra beleza na simplicidade e conforto no que  bem pensado. Cortes limpos, cores neutras e uma curadoria intencional definem quem voc . Seu visual parece fcil, mas por trs tem uma mulher que sabe exatamente o que quer.",highlights:["Praticidade e estilo caminham juntos na sua vida","Voc prefere menos peas, mas que todas conversem entre si","Conforto no  abrir mo de estilo   seu superpoder"],valorizes:["conforto inteligente","silhueta relaxada","tecidos macios de qualidade","funcionalidade"],tags:["minimal","moderno","verstil","confortvel","clean"],emoji:"",colorPalette:["branco","cinza","bege","oliva","terracota"],keyPieces:["T-shirt premium","Jeans reto perfeito","Tnis branco","Cardigan oversized"]},romantica:{id:"romantica",title:"Romntica Contempornea",subtitle:"Delicadeza com personalidade e ousadia",description:"Voc celebra sua feminilidade com graa e autenticidade. Ama detalhes que contam uma histria  um lao, uma estampa, uma textura inesperada. Cores te atraem, movimento te encanta, e voc no tem medo de ser vista.",highlights:["Detalhes so tudo para voc  cada pea conta uma histria","Feminilidade  sua forma de expresso e fora","Voc se permite experimentar, misturar e ousar"],valorizes:["delicadeza","movimento fluido","estampas e cores","detalhes especiais"],tags:["romntico","floral","feminino","colorido","ousada"],emoji:"",colorPalette:["rosa","lavanda","pssego","vermelho","verde esmeralda"],keyPieces:["Vestido midi","Saia fluida","Blusa com detalhes","Acessrios statement"]}};function upe(e){const t={elegante:0,classica:0,minimal:0,romantica:0};e.forEach(s=>{s.points&&(t.elegante+=s.points.elegante||0,t.classica+=s.points.classica||0,t.minimal+=s.points.minimal||0,t.romantica+=s.points.romantica||0)});const r=Object.entries(t).reduce((s,a)=>s[1]>a[1]?s:a)[0];return SC[r]}const g0=[ns.poa.minPoints,ns.poa_gold.minPoints,ns.poa_platinum.minPoints,ns.poa_black.minPoints];ns.poa.name,ns.poa_gold.name,ns.poa_platinum.name,ns.poa_black.name;function uf(e){const t=Vme(e);return t.id==="poa_black"?{level:3,title:t.name,nextLevel:99999,minPoints:t.minPoints}:t.id==="poa_platinum"?{level:2,title:t.name,nextLevel:ns.poa_black.minPoints,minPoints:t.minPoints}:t.id==="poa_gold"?{level:1,title:t.name,nextLevel:ns.poa_platinum.minPoints,minPoints:t.minPoints}:{level:0,title:ns.poa.name,nextLevel:ns.poa_gold.minPoints,minPoints:0}}function S3(e){return e==="key"?20:e==="open"?CC:e==="photos"?0:10}const CC=30,ih=50,Jf=5;function hpe({userId:e,onPhotosChange:t,photos:r,onPointsEarned:s}){const[a,i]=P.useState(!1),o=async l=>{try{const{data:u,error:h}=await ce.functions.invoke("analyze-product-image",{body:{image_url:l}});return h?(console.error("Analysis error:",h),null):u!=null&&u.success&&(u!=null&&u.analysis)?u.analysis:null}catch(u){return console.error("Error analyzing photo:",u),null}},c=async l=>{const u=l.target.files;if(!u||u.length===0)return;const h=Jf-r.length;if(h<=0){de.error(`Mximo de ${Jf} fotos`);return}const f=Array.from(u).slice(0,h);i(!0);try{let m=[...r],p=0;for(const g of f){const v=`${e}/inspiration/${Date.now()}-${g.name}`,{error:x}=await ce.storage.from("prints").upload(v,g);if(x)throw x;const{data:y}=ce.storage.from("prints").getPublicUrl(v),b={url:y.publicUrl,isAnalyzing:!0};m=[...m,b],p+=ih,t(m,p),s(ih),de.success(`+${ih} pontos! `),o(y.publicUrl).then(j=>{const T=m.map(O=>O.url===y.publicUrl?{...O,analysis:j||void 0,isAnalyzing:!1}:O);t(T,p)})}}catch(m){console.error("Error uploading photos:",m),de.error("Erro ao enviar fotos")}finally{i(!1),l.target.value=""}},d=l=>{const u=r.filter(f=>f.url!==l),h=u.length*ih;t(u,h)};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-3",children:[r.map((l,u)=>n.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden border-2 border-accent/30 group shadow-sm",children:[n.jsx("img",{src:l.url,alt:`Inspirao ${u+1}`,className:"w-full h-full object-cover"}),l.isAnalyzing&&n.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center",children:n.jsx(At,{className:"h-5 w-5 text-white animate-spin"})}),!l.isAnalyzing&&l.analysis&&n.jsx("div",{className:"absolute top-1.5 left-1.5",children:n.jsx("div",{className:"bg-accent text-accent-foreground rounded-full p-1",children:n.jsx(xn,{className:"h-3 w-3"})})}),n.jsx("button",{onClick:()=>d(l.url),className:"absolute top-1.5 right-1.5 bg-black/60 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:n.jsx(an,{className:"h-3 w-3"})}),n.jsxs("div",{className:"absolute bottom-1.5 left-1.5 bg-amber-500 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full",children:["+",ih]})]},l.url)),r.length<Jf&&n.jsx("button",{type:"button",onClick:()=>{var l;return(l=document.getElementById("quiz-photo-upload"))==null?void 0:l.click()},disabled:a,className:"aspect-square rounded-xl border-2 border-dashed border-accent/40 hover:border-accent bg-accent/5 hover:bg-accent/10 flex flex-col items-center justify-center transition-all disabled:opacity-50 gap-1.5",children:a?n.jsx(At,{className:"h-6 w-6 text-accent animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(Gh,{className:"h-6 w-6 text-accent"}),n.jsxs("span",{className:"text-xs font-medium text-accent",children:["+",ih,"pts"]})]})}),n.jsx("input",{id:"quiz-photo-upload",type:"file",accept:"image/*",multiple:!0,onChange:c,className:"hidden"})]}),r.length>0&&r.some(l=>l.analysis)&&n.jsxs("div",{className:"bg-accent/10 border border-accent/30 rounded-xl p-4 flex items-start gap-3",children:[n.jsx(Wr,{className:"h-5 w-5 text-accent shrink-0 mt-0.5 animate-pulse"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-accent mb-1",children:"IA analisando seus looks..."}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Estou identificando cores, estilos e peas que voc ama"})]})]}),r.length===0&&!a&&n.jsxs(he,{variant:"outline",className:"w-full gap-2 h-12 border-accent/30 hover:border-accent hover:bg-accent/5",onClick:()=>{var l;return(l=document.getElementById("quiz-photo-upload"))==null?void 0:l.click()},children:[n.jsx(Ma,{className:"h-5 w-5 text-accent"}),n.jsx("span",{children:"Adicionar fotos de inspirao"})]}),n.jsx("p",{className:"text-center text-sm text-muted-foreground",children:r.length===0?"Opcional: envie at 5 fotos":r.length<Jf?n.jsxs(n.Fragment,{children:[n.jsxs("span",{className:"font-medium text-accent",children:[r.length,"/",Jf]})," fotos  Voc pode ganhar mais ",n.jsxs("span",{className:"font-medium text-amber-600",children:["+",(Jf-r.length)*ih," pontos"]})]}):n.jsx("span",{className:"text-accent font-medium",children:" Mximo de fotos atingido!"})})]})}var k1={};(function e(t,r,s,a){var i=!!(t.Worker&&t.Blob&&t.Promise&&t.OffscreenCanvas&&t.OffscreenCanvasRenderingContext2D&&t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype.transferControlToOffscreen&&t.URL&&t.URL.createObjectURL),o=typeof Path2D=="function"&&typeof DOMMatrix=="function",c=function(){if(!t.OffscreenCanvas)return!1;try{var I=new OffscreenCanvas(1,1),U=I.getContext("2d");U.fillRect(0,0,1,1);var $=I.transferToImageBitmap();U.createPattern($,"no-repeat")}catch{return!1}return!0}();function d(){}function l(I){var U=r.exports.Promise,$=U!==void 0?U:t.Promise;return typeof $=="function"?new $(I):(I(d,d),null)}var u=function(I,U){return{transform:function($){if(I)return $;if(U.has($))return U.get($);var Y=new OffscreenCanvas($.width,$.height),Z=Y.getContext("2d");return Z.drawImage($,0,0),U.set($,Y),Y},clear:function(){U.clear()}}}(c,new Map),h=function(){var I=Math.floor(16.666666666666668),U,$,Y={},Z=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(U=function(re){var G=Math.random();return Y[G]=requestAnimationFrame(function J(V){Z===V||Z+I-1<V?(Z=V,delete Y[G],re()):Y[G]=requestAnimationFrame(J)}),G},$=function(re){Y[re]&&cancelAnimationFrame(Y[re])}):(U=function(re){return setTimeout(re,I)},$=function(re){return clearTimeout(re)}),{frame:U,cancel:$}}(),f=function(){var I,U,$={};function Y(Z){function re(G,J){Z.postMessage({options:G||{},callback:J})}Z.init=function(J){var V=J.transferControlToOffscreen();Z.postMessage({canvas:V},[V])},Z.fire=function(J,V,W){if(U)return re(J,null),U;var ee=Math.random().toString(36).slice(2);return U=l(function(ie){function oe(se){se.data.callback===ee&&(delete $[ee],Z.removeEventListener("message",oe),U=null,u.clear(),W(),ie())}Z.addEventListener("message",oe),re(J,ee),$[ee]=oe.bind(null,{data:{callback:ee}})}),U},Z.reset=function(){Z.postMessage({reset:!0});for(var J in $)$[J](),delete $[J]}}return function(){if(I)return I;if(!s&&i){var Z=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{I=new Worker(URL.createObjectURL(new Blob([Z])))}catch(re){return typeof console<"u"&&typeof console.warn=="function"&&console.warn(" Could not load worker",re),null}Y(I)}return I}}(),m={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function p(I,U){return U?U(I):I}function g(I){return I!=null}function v(I,U,$){return p(I&&g(I[U])?I[U]:m[U],$)}function x(I){return I<0?0:Math.floor(I)}function y(I,U){return Math.floor(Math.random()*(U-I))+I}function b(I){return parseInt(I,16)}function j(I){return I.map(T)}function T(I){var U=String(I).replace(/[^0-9a-f]/gi,"");return U.length<6&&(U=U[0]+U[0]+U[1]+U[1]+U[2]+U[2]),{r:b(U.substring(0,2)),g:b(U.substring(2,4)),b:b(U.substring(4,6))}}function O(I){var U=v(I,"origin",Object);return U.x=v(U,"x",Number),U.y=v(U,"y",Number),U}function R(I){I.width=document.documentElement.clientWidth,I.height=document.documentElement.clientHeight}function D(I){var U=I.getBoundingClientRect();I.width=U.width,I.height=U.height}function L(I){var U=document.createElement("canvas");return U.style.position="fixed",U.style.top="0px",U.style.left="0px",U.style.pointerEvents="none",U.style.zIndex=I,U}function q(I,U,$,Y,Z,re,G,J,V){I.save(),I.translate(U,$),I.rotate(re),I.scale(Y,Z),I.arc(0,0,1,G,J,V),I.restore()}function X(I){var U=I.angle*(Math.PI/180),$=I.spread*(Math.PI/180);return{x:I.x,y:I.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:I.startVelocity*.5+Math.random()*I.startVelocity,angle2D:-U+(.5*$-Math.random()*$),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:I.color,shape:I.shape,tick:0,totalTicks:I.ticks,decay:I.decay,drift:I.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:I.gravity*3,ovalScalar:.6,scalar:I.scalar,flat:I.flat}}function H(I,U){U.x+=Math.cos(U.angle2D)*U.velocity+U.drift,U.y+=Math.sin(U.angle2D)*U.velocity+U.gravity,U.velocity*=U.decay,U.flat?(U.wobble=0,U.wobbleX=U.x+10*U.scalar,U.wobbleY=U.y+10*U.scalar,U.tiltSin=0,U.tiltCos=0,U.random=1):(U.wobble+=U.wobbleSpeed,U.wobbleX=U.x+10*U.scalar*Math.cos(U.wobble),U.wobbleY=U.y+10*U.scalar*Math.sin(U.wobble),U.tiltAngle+=.1,U.tiltSin=Math.sin(U.tiltAngle),U.tiltCos=Math.cos(U.tiltAngle),U.random=Math.random()+2);var $=U.tick++/U.totalTicks,Y=U.x+U.random*U.tiltCos,Z=U.y+U.random*U.tiltSin,re=U.wobbleX+U.random*U.tiltCos,G=U.wobbleY+U.random*U.tiltSin;if(I.fillStyle="rgba("+U.color.r+", "+U.color.g+", "+U.color.b+", "+(1-$)+")",I.beginPath(),o&&U.shape.type==="path"&&typeof U.shape.path=="string"&&Array.isArray(U.shape.matrix))I.fill(N(U.shape.path,U.shape.matrix,U.x,U.y,Math.abs(re-Y)*.1,Math.abs(G-Z)*.1,Math.PI/10*U.wobble));else if(U.shape.type==="bitmap"){var J=Math.PI/10*U.wobble,V=Math.abs(re-Y)*.1,W=Math.abs(G-Z)*.1,ee=U.shape.bitmap.width*U.scalar,ie=U.shape.bitmap.height*U.scalar,oe=new DOMMatrix([Math.cos(J)*V,Math.sin(J)*V,-Math.sin(J)*W,Math.cos(J)*W,U.x,U.y]);oe.multiplySelf(new DOMMatrix(U.shape.matrix));var se=I.createPattern(u.transform(U.shape.bitmap),"no-repeat");se.setTransform(oe),I.globalAlpha=1-$,I.fillStyle=se,I.fillRect(U.x-ee/2,U.y-ie/2,ee,ie),I.globalAlpha=1}else if(U.shape==="circle")I.ellipse?I.ellipse(U.x,U.y,Math.abs(re-Y)*U.ovalScalar,Math.abs(G-Z)*U.ovalScalar,Math.PI/10*U.wobble,0,2*Math.PI):q(I,U.x,U.y,Math.abs(re-Y)*U.ovalScalar,Math.abs(G-Z)*U.ovalScalar,Math.PI/10*U.wobble,0,2*Math.PI);else if(U.shape==="star")for(var le=Math.PI/2*3,ye=4*U.scalar,ue=8*U.scalar,ne=U.x,pe=U.y,ge=5,Ne=Math.PI/ge;ge--;)ne=U.x+Math.cos(le)*ue,pe=U.y+Math.sin(le)*ue,I.lineTo(ne,pe),le+=Ne,ne=U.x+Math.cos(le)*ye,pe=U.y+Math.sin(le)*ye,I.lineTo(ne,pe),le+=Ne;else I.moveTo(Math.floor(U.x),Math.floor(U.y)),I.lineTo(Math.floor(U.wobbleX),Math.floor(Z)),I.lineTo(Math.floor(re),Math.floor(G)),I.lineTo(Math.floor(Y),Math.floor(U.wobbleY));return I.closePath(),I.fill(),U.tick<U.totalTicks}function M(I,U,$,Y,Z){var re=U.slice(),G=I.getContext("2d"),J,V,W=l(function(ee){function ie(){J=V=null,G.clearRect(0,0,Y.width,Y.height),u.clear(),Z(),ee()}function oe(){s&&!(Y.width===a.width&&Y.height===a.height)&&(Y.width=I.width=a.width,Y.height=I.height=a.height),!Y.width&&!Y.height&&($(I),Y.width=I.width,Y.height=I.height),G.clearRect(0,0,Y.width,Y.height),re=re.filter(function(se){return H(G,se)}),re.length?J=h.frame(oe):ie()}J=h.frame(oe),V=ie});return{addFettis:function(ee){return re=re.concat(ee),W},canvas:I,promise:W,reset:function(){J&&h.cancel(J),V&&V()}}}function F(I,U){var $=!I,Y=!!v(U||{},"resize"),Z=!1,re=v(U,"disableForReducedMotion",Boolean),G=i&&!!v(U||{},"useWorker"),J=G?f():null,V=$?R:D,W=I&&J?!!I.__confetti_initialized:!1,ee=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,ie;function oe(le,ye,ue){for(var ne=v(le,"particleCount",x),pe=v(le,"angle",Number),ge=v(le,"spread",Number),Ne=v(le,"startVelocity",Number),_e=v(le,"decay",Number),be=v(le,"gravity",Number),Me=v(le,"drift",Number),Se=v(le,"colors",j),$e=v(le,"ticks",Number),Ke=v(le,"shapes"),Ze=v(le,"scalar"),it=!!v(le,"flat"),Re=O(le),ot=ne,ut=[],bt=I.width*Re.x,Je=I.height*Re.y;ot--;)ut.push(X({x:bt,y:Je,angle:pe,spread:ge,startVelocity:Ne,color:Se[ot%Se.length],shape:Ke[y(0,Ke.length)],ticks:$e,decay:_e,gravity:be,drift:Me,scalar:Ze,flat:it}));return ie?ie.addFettis(ut):(ie=M(I,ut,V,ye,ue),ie.promise)}function se(le){var ye=re||v(le,"disableForReducedMotion",Boolean),ue=v(le,"zIndex",Number);if(ye&&ee)return l(function(Ne){Ne()});$&&ie?I=ie.canvas:$&&!I&&(I=L(ue),document.body.appendChild(I)),Y&&!W&&V(I);var ne={width:I.width,height:I.height};J&&!W&&J.init(I),W=!0,J&&(I.__confetti_initialized=!0);function pe(){if(J){var Ne={getBoundingClientRect:function(){if(!$)return I.getBoundingClientRect()}};V(Ne),J.postMessage({resize:{width:Ne.width,height:Ne.height}});return}ne.width=ne.height=null}function ge(){ie=null,Y&&(Z=!1,t.removeEventListener("resize",pe)),$&&I&&(document.body.contains(I)&&document.body.removeChild(I),I=null,W=!1)}return Y&&!Z&&(Z=!0,t.addEventListener("resize",pe,!1)),J?J.fire(le,ne,ge):oe(le,ne,ge)}return se.reset=function(){J&&J.reset(),ie&&ie.reset()},se}var S;function E(){return S||(S=F(null,{useWorker:!0,resize:!0})),S}function N(I,U,$,Y,Z,re,G){var J=new Path2D(I),V=new Path2D;V.addPath(J,new DOMMatrix(U));var W=new Path2D;return W.addPath(V,new DOMMatrix([Math.cos(G)*Z,Math.sin(G)*Z,-Math.sin(G)*re,Math.cos(G)*re,$,Y])),W}function C(I){if(!o)throw new Error("path confetti are not supported in this browser");var U,$;typeof I=="string"?U=I:(U=I.path,$=I.matrix);var Y=new Path2D(U),Z=document.createElement("canvas"),re=Z.getContext("2d");if(!$){for(var G=1e3,J=G,V=G,W=0,ee=0,ie,oe,se=0;se<G;se+=2)for(var le=0;le<G;le+=2)re.isPointInPath(Y,se,le,"nonzero")&&(J=Math.min(J,se),V=Math.min(V,le),W=Math.max(W,se),ee=Math.max(ee,le));ie=W-J,oe=ee-V;var ye=10,ue=Math.min(ye/ie,ye/oe);$=[ue,0,0,ue,-Math.round(ie/2+J)*ue,-Math.round(oe/2+V)*ue]}return{type:"path",path:U,matrix:$}}function k(I){var U,$=1,Y="#000000",Z='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof I=="string"?U=I:(U=I.text,$="scalar"in I?I.scalar:$,Z="fontFamily"in I?I.fontFamily:Z,Y="color"in I?I.color:Y);var re=10*$,G=""+re+"px "+Z,J=new OffscreenCanvas(re,re),V=J.getContext("2d");V.font=G;var W=V.measureText(U),ee=Math.ceil(W.actualBoundingBoxRight+W.actualBoundingBoxLeft),ie=Math.ceil(W.actualBoundingBoxAscent+W.actualBoundingBoxDescent),oe=2,se=W.actualBoundingBoxLeft+oe,le=W.actualBoundingBoxAscent+oe;ee+=oe+oe,ie+=oe+oe,J=new OffscreenCanvas(ee,ie),V=J.getContext("2d"),V.font=G,V.fillStyle=Y,V.fillText(U,se,le);var ye=1/$;return{type:"bitmap",bitmap:J.transferToImageBitmap(),matrix:[ye,0,0,ye,-ee*ye/2,-ie*ye/2]}}r.exports=function(){return E().apply(this,arguments)},r.exports.reset=function(){E().reset()},r.exports.create=F,r.exports.shapeFromPath=C,r.exports.shapeFromText=k})(function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}}(),k1,!1);const oh=k1.exports;k1.exports.create;function Hk(){const e=P.useCallback((s={})=>{const{type:a="default"}=s;switch(a){case"stars":oh({particleCount:50,spread:60,origin:{y:.6},colors:["#FFD700","#FFA500","#FF6B6B","#9333EA"],shapes:["star"],scalar:1.2});break;case"emoji":oh({particleCount:30,spread:70,origin:{y:.5},colors:["#FFD700","#E91E63","#9C27B0","#4CAF50"]});break;case"celebration":let o=function(h,f){return Math.random()*(f-h)+h};const c=2e3,d=Date.now()+c,l={startVelocity:30,spread:360,ticks:60,zIndex:1e3},u=setInterval(function(){const h=d-Date.now();if(h<=0)return clearInterval(u);const f=50*(h/c);oh({...l,particleCount:f,origin:{x:o(.1,.3),y:Math.random()-.2},colors:["#FFD700","#FF6B6B","#9333EA","#22C55E"]}),oh({...l,particleCount:f,origin:{x:o(.7,.9),y:Math.random()-.2},colors:["#FFD700","#FF6B6B","#9333EA","#22C55E"]})},250);break;default:oh({particleCount:80,spread:70,origin:{y:.6},colors:["#FFD700","#9333EA","#22C55E","#FF6B6B","#3B82F6"]})}},[]),t=P.useCallback(s=>{const a=Math.min(30+s,100);oh({particleCount:a,spread:50+s,origin:{y:.7,x:.5},colors:["#FFD700","#FFA500","#9333EA"],shapes:["star","circle"],scalar:.8})},[]),r=P.useCallback(()=>{const a={origin:{y:.7},zIndex:1e3};function i(o,c){oh({...a,...c,particleCount:Math.floor(200*o)})}i(.25,{spread:26,startVelocity:55,colors:["#FFD700"]}),i(.2,{spread:60,colors:["#9333EA"]}),i(.35,{spread:100,decay:.91,scalar:.8,colors:["#22C55E","#FFD700"]}),i(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2,colors:["#FF6B6B","#9333EA"]}),i(.1,{spread:120,startVelocity:45,colors:["#FFD700","#FFA500"]})},[]);return{fireConfetti:e,firePoints:t,fireLevelUp:r}}const fpe=()=>{var ye;const e=fr(),[t]=kc(),r=t.get("redo")==="true",{user:s,isLoading:a}=Hn(),{firePoints:i,fireLevelUp:o}=Hk(),[c,d]=P.useState(0),[l,u]=P.useState([]),[h,f]=P.useState(null),[m,p]=P.useState(null),[g,v]=P.useState(null),[x,y]=P.useState(""),[b,j]=P.useState([]),[T,O]=P.useState(0),[R,D]=P.useState(!1),[L,q]=P.useState(0),[X,H]=P.useState(0),[M,F]=P.useState(0),[S,E]=P.useState(!1),[N,C]=P.useState(1),[k,I]=P.useState(!1);P.useEffect(()=>{!a&&!s&&e("/entrar?redirect=/quiz",{replace:!0})},[s,a,e]),P.useEffect(()=>{(async()=>{if(s&&r){const{data:ne}=await ce.from("profiles").select("quiz_points").eq("user_id",s.id).single();ne!=null&&ne.quiz_points&&H(ne.quiz_points)}})()},[s,r]);const U=Dy[c],$=c===Dy.length-1,Y=(U==null?void 0:U.type)==="size",Z=(U==null?void 0:U.type)==="photos",re=(U==null?void 0:U.type)==="open",G=Y?m!==null||g!==null:Z||re?!0:h!==null,J=P.useCallback(ue=>{const{level:ne}=uf(ue);ne>N&&(C(ne),setTimeout(()=>{o(),de.success(` Parabns! Voc alcanou o Nvel ${ne}!`,{duration:3e3})},800))},[N,o]);P.useEffect(()=>{if(M>0){const ue=setTimeout(()=>F(0),1500);return()=>clearTimeout(ue)}},[M]);const V=ue=>{f(ue)},W=ue=>{p(ue)},ee=ue=>{v(ue)},ie=(ue,ne)=>{j(ue),O(ne)},oe=ue=>{if(r)return;const ne=L+ue;q(ne),F(ue),E(!0),i(ue),J(ne)},se=async()=>{var Ne,_e;if(Z){I(!0),setTimeout(()=>{d(c+1),f(null),I(!1)},300);return}if(re){const be=r?0:x.trim()?CC:0;if(be>0){const Me=L+be;q(Me),F(be),E(!0),i(be),J(Me)}I(!0),setTimeout(()=>{d(c+1),f(null),I(!1)},300);return}if(Y){if(!m&&!g)return;D(!0);try{const be=r?0:S3(U.pointsType),Me=r?X:L+be,Se=upe(l),$e=l.map(Ge=>({question:Ge.question,answer:Ge.answer,points:Ge.earnedPoints})),Ke=[m,g].filter(Boolean).join(" / ");let Ze=null;try{const{data:Ge,error:Pe}=await ce.functions.invoke("analyze-quiz",{body:{answers:$e,size:Ke,additionalNotes:x||void 0,totalPoints:Me,inspirationPhotos:b.filter(Ve=>Ve.analysis).map(Ve=>({url:Ve.url,analysis:Ve.analysis}))}});!Pe&&Ge&&!Ge.error&&(Ze=Ge)}catch(Ge){console.log("AI analysis skipped:",Ge)}let it="",Re="",ot="";if(s){const{data:Ge}=await ce.from("profiles").select("name, whatsapp, full_name").eq("user_id",s.id).maybeSingle();it=(Ge==null?void 0:Ge.full_name)||(Ge==null?void 0:Ge.name)||((Ne=s.user_metadata)==null?void 0:Ne.name)||"",Re=(Ge==null?void 0:Ge.whatsapp)||((_e=s.user_metadata)==null?void 0:_e.whatsapp)||"",ot=s.email||""}const{data:ut,error:bt}=await ce.from("customers").upsert({phone:Re,name:it,email:ot||null,style_title:(Ze==null?void 0:Ze.styleTitle)||Se.title,size_letter:m,size_number:g,user_id:s==null?void 0:s.id},{onConflict:"user_id",ignoreDuplicates:!1}).select().single();if(bt)throw bt;if(s){const{level:Ge}=uf(Me),Ve=b.filter(st=>st.analysis).map(st=>st.analysis).map(st=>{var xt;return(xt=st==null?void 0:st.cor)==null?void 0:xt.value}).filter(Boolean).slice(0,3);await ce.from("profiles").update({size_letter:m,size_number:g,style_title:(Ze==null?void 0:Ze.styleTitle)||Se.title,quiz_points:Me,quiz_level:Ge,quiz_completed_at:new Date().toISOString(),style_description:(Ze==null?void 0:Ze.description)||Se.description,color_palette:(Ze==null?void 0:Ze.colorPalette)||[...Ve,...Se.colorPalette||[]].slice(0,5),personal_tip:Ze==null?void 0:Ze.personalTip,avoid_items:(Ze==null?void 0:Ze.avoidColors)||[]}).eq("user_id",s.id)}const Je=l.map((Ge,Pe)=>({customer_id:ut.id,user_id:s==null?void 0:s.id,question_number:Pe+1,question:Ge.question,answer:Ge.answer,points:Ge.earnedPoints}));if(b.length>0&&Je.push({customer_id:ut.id,user_id:s==null?void 0:s.id,question_number:l.length+1,question:"Fotos de inspirao",answer:`${b.length} fotos enviadas`,points:T}),x&&Je.push({customer_id:ut.id,user_id:s==null?void 0:s.id,question_number:l.length+2,question:"Quer me contar mais?",answer:x,points:x.trim()?CC:0}),m||g){const Ge=[m,g].filter(Boolean).join(" e ");Je.push({customer_id:ut.id,user_id:s==null?void 0:s.id,question_number:l.length+3,question:"Qual  o seu tamanho?",answer:Ge,points:be})}if(!r&&s&&Me>0){const{error:Ge}=await ce.rpc("award_loyalty_points",{p_user_id:s.id,p_points:Me,p_description:"Quiz de Estilo Inicial"});Ge&&(console.error("Error awarding loyalty points:",Ge),de.error("Erro ao computar pontos do clube, mas seu estilo foi salvo!"))}const{error:Ce}=await ce.from("quiz_responses").insert(Je);if(Ce)throw Ce;e(`/resultado/${ut.id}`,{state:{aiAnalysis:Ze,totalPoints:Me,sizeLetter:m,sizeNumber:g,showCelebration:!0,profile:Se}})}catch(be){console.error("Error saving quiz:",be),de.error("Ops! Algo deu errado. Tente novamente."),D(!1)}return}if(h===null||!U.options)return;const ue=U.options[h],ne=r?0:S3(U.pointsType),pe={questionId:U.id,question:U.question,answer:ue.text,points:ue.points,earnedPoints:ne},ge=L+ne;ne>0&&(i(ne),E(!0),F(ne),J(ge)),u([...l,pe]),q(ge),I(!0),setTimeout(()=>{d(c+1),f(null),I(!1)},300)},le=()=>{if(c>0){if(Dy[c-1].type==="single"){const ne=l[l.length-1];ne&&(q(pe=>pe-ne.earnedPoints),u(l.slice(0,-1)))}I(!0),setTimeout(()=>{d(c-1),f(null),I(!1)},150)}};return a?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(At,{className:"h-8 w-8 animate-spin text-accent mx-auto mb-4"}),n.jsx("p",{className:"text-muted-foreground",children:"Carregando..."})]})}):s?(U&&S3(U.pointsType),n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(Cr,{}),n.jsx(Tq,{points:M,show:S,onComplete:()=>E(!1)}),n.jsxs("main",{className:"flex-1 container mx-auto px-4 py-6 max-w-2xl",children:[r&&n.jsxs("div",{className:"mb-6 border border-foreground/10 p-4 flex items-center gap-2 text-sm text-foreground/60",children:[n.jsx(f1,{className:"h-4 w-4 flex-shrink-0"}),n.jsxs("span",{children:["Voc est atualizando seu perfil de estilo. ",n.jsx("strong",{className:"text-foreground/80",children:"Seus pontos sero mantidos."})]})]}),n.jsx(ope,{current:c+1,total:Dy.length,points:r?X:L,pointsJustEarned:r?0:M}),n.jsxs("div",{className:`mt-8 transition-all duration-300 ease-out ${k?"opacity-0 translate-y-4":"opacity-100 translate-y-0"}`,children:[U.subtext&&n.jsx("p",{className:"text-[11px] tracking-[0.2em] uppercase text-foreground/40 font-medium mb-4 animate-slide-in-up",children:U.subtext}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mb-8 animate-slide-in-up",style:{animationDelay:"50ms"},children:U.question}),Z&&n.jsx("div",{className:"animate-slide-in-up",style:{animationDelay:"100ms"},children:n.jsx(hpe,{userId:s.id,photos:b,onPhotosChange:ie,onPointsEarned:oe})}),re&&n.jsxs("div",{className:"animate-slide-in-up",style:{animationDelay:"100ms"},children:[n.jsx("p",{className:"text-foreground/50 text-sm font-light mb-5 leading-relaxed",children:"Cores favoritas, ocasies especiais, peas que ama ou evita  tudo conta."}),n.jsx(Yn,{value:x,onChange:ue=>y(ue.target.value),placeholder:"Ex: Adoro peas confortveis pra trabalhar de casa, gosto muito de azul e verde, evito estampas muito grandes...",className:"min-h-[140px] border-border bg-transparent focus:ring-1 focus:ring-foreground/20 focus:border-foreground/30 transition-all font-light text-sm placeholder:text-foreground/25 resize-none"}),x.trim()&&n.jsx("p",{className:"text-[11px] text-foreground/40 mt-3 tracking-wide",children:"Quanto mais detalhes, mais precisa ser a sua curadoria."})]}),Y&&n.jsx("div",{className:"animate-slide-in-up",style:{animationDelay:"100ms"},children:n.jsx(dpe,{selectedLetterSize:m,selectedNumberSize:g,onSelectLetter:W,onSelectNumber:ee})}),U.type==="single"&&n.jsx("div",{className:"space-y-3",children:(ye=U.options)==null?void 0:ye.map((ue,ne)=>n.jsx("div",{className:"animate-slide-in-up",style:{animationDelay:`${100+ne*50}ms`},children:n.jsx(Aq,{text:ue.text,emoji:ue.emoji,imageUrl:ue.imageUrl,isSelected:h===ne,onClick:()=>V(ne)})},ne))})]},c),n.jsxs("div",{className:"mt-10 flex gap-4",children:[c>0&&n.jsx("button",{onClick:le,disabled:R||k,className:"px-6 py-3.5 border border-foreground/20 text-xs tracking-[0.2em] uppercase font-medium text-foreground/60 transition-all duration-300 hover:border-foreground/40 hover:text-foreground disabled:opacity-40",children:"Voltar"}),n.jsx("button",{onClick:se,disabled:!G||R||k,className:"flex-1 py-3.5 bg-foreground text-background text-xs tracking-[0.2em] uppercase font-medium transition-all duration-500 hover:bg-accent disabled:opacity-30 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:R?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 animate-spin"}),"Preparando seu resultado"]}):$?"Descobrir meu estilo":Z?b.length>0?"Continuar":"Pular esta etapa":re?x.trim()?"Continuar":"Pular esta etapa":"Prxima"})]})]})]})):n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Yo,{className:"h-8 w-8 text-muted-foreground mx-auto mb-4"}),n.jsx("p",{className:"text-muted-foreground",children:"Redirecionando para login..."})]})})};function q_({href:e,variant:t="primary",label:r="Falar no WhatsApp",showMicrocopy:s=!1,className:a}){return t==="circle"?n.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer","aria-label":"Falar no WhatsApp",onClick:i=>i.stopPropagation(),className:We("flex items-center justify-center w-10 h-10 rounded-full","bg-[#25D366] text-white","hover:bg-[#1EBE5D] active:bg-[#18A84F]","transition-colors",a),children:n.jsx(nn,{className:"h-5 w-5"})}):n.jsxs("div",{className:"w-full",children:[n.jsxs("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:We("flex items-center justify-center gap-2 w-full h-12","bg-[#25D366] text-white font-medium","rounded-xl","hover:bg-[#1EBE5D] active:bg-[#18A84F]","transition-colors",a),children:[n.jsx(nn,{className:"h-5 w-5"}),r]}),s&&n.jsx("p",{className:"text-center text-xs text-muted-foreground mt-2",children:"Abrimos o WhatsApp com a mensagem pronta "})]})}function Pq({completedMissions:e,currentPoints:t,currentLevel:r}){const s=cv(e),a=[...cv([])];return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-end justify-between",children:[n.jsx("h3",{className:"font-serif text-xl",children:"Aprofunde seu perfil"}),n.jsxs("span",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/40",children:[e.length," de ",a.length," concludas"]})]}),n.jsx("p",{className:"text-sm text-foreground/50 font-light leading-relaxed",children:"Cada mdulo refina sua curadoria em uma rea especfica  quanto mais eu te conhecer, melhores sero as sugestes."}),n.jsx("div",{className:"grid gap-3",children:a.map(i=>{const o=e.includes(i.id);return n.jsx(mpe,{mission:i,isCompleted:o},i.id)})}),s.length===0&&n.jsxs("div",{className:"text-center py-10 border border-border",children:[n.jsx(pn,{className:"h-8 w-8 text-foreground/30 mx-auto mb-3"}),n.jsx("p",{className:"text-sm font-light text-foreground/60",children:"Todos os mdulos concludos"}),n.jsx("p",{className:"text-[11px] text-foreground/40 mt-1 tracking-wide",children:"Novos mdulos em breve"})]})]})}function mpe({mission:e,isCompleted:t}){const r=e.questions.length;return n.jsx("div",{className:We("border p-5 transition-all duration-300",t?"border-foreground/10 bg-foreground/[0.02]":"border-border hover:border-foreground/30"),children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h4",{className:We("text-sm tracking-wide",t?"text-foreground/50":"font-medium"),children:e.title}),t&&n.jsx(pn,{className:"h-3.5 w-3.5 text-foreground/30 shrink-0"})]}),n.jsx("p",{className:"text-[12px] text-foreground/40 font-light",children:e.subtitle}),n.jsxs("p",{className:"text-[11px] text-foreground/30 mt-1.5 tracking-wide",children:[r," perguntas + referncias visuais"]})]}),n.jsx("div",{className:"shrink-0",children:t?n.jsx("span",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/30 font-medium",children:"Concluda"}):n.jsx(Gt,{to:`/missao/${e.id}`,children:n.jsxs("button",{className:"px-5 py-2.5 border border-foreground/20 text-[11px] tracking-[0.15em] uppercase font-medium text-foreground/60 transition-all duration-300 hover:border-foreground hover:text-foreground flex items-center gap-2",children:["Iniciar",n.jsx(ps,{className:"h-3 w-3"})]})})})]})})}const ppe=()=>{var E,N,C,k,I,U,$;const{customerId:e}=ra(),t=Ec();Hn();const{addItem:r}=Wu(),{fireConfetti:s}=Hk(),{loyalty:a}=C1(),[i,o]=P.useState(null),[c,d]=P.useState([]),[l,u]=P.useState([]),[h,f]=P.useState(!0),[m,p]=P.useState(!1),[g,v]=P.useState(0),x=(E=t.state)==null?void 0:E.aiAnalysis,y=((N=t.state)==null?void 0:N.totalPoints)||0,b=(C=t.state)==null?void 0:C.sizeLetter,j=(k=t.state)==null?void 0:k.sizeNumber,T=(I=t.state)==null?void 0:I.showCelebration,O=(U=t.state)==null?void 0:U.profile;P.useEffect(()=>{y>0?v(y):a!=null&&a.currentPoints&&v(a.currentPoints)},[y,a]),P.useEffect(()=>{T&&!m&&!h&&(p(!0),setTimeout(()=>{s({type:"celebration"})},500))},[T,m,h,s]);const R=i!=null&&i.style_title?Object.values(SC).find(Y=>Y.title===i.style_title):x!=null&&x.styleId?SC[x.styleId]:O||null,{level:D,title:L}=uf(g),q=(x==null?void 0:x.highlights)||(R==null?void 0:R.highlights)||["Voc valoriza qualidade sobre quantidade","Seu olhar  atrado por cortes impecveis","Voc sabe o poder de uma boa escolha"],X=(x==null?void 0:x.valorizes)||(R==null?void 0:R.valorizes)||["estilo","conforto","versatilidade"];P.useEffect(()=>{async function Y(){if(e)try{const{data:Z,error:re}=await ce.from("customers").select("*").eq("id",e).single();if(re)throw re;o(Z);const G=b||Z.size_letter,J=j||Z.size_number;let V=ce.from("product_catalog").select("*").eq("is_active",!0);const{data:W,error:ee}=await V.limit(50);if(ee)throw ee;const ie=(W||[]).filter(ye=>{const ue=ye.stock_by_size;return ue?(ue.UN||0)>0||G&&(ue[G]||0)>0||J&&(ue[J]||0)>0?!0:!G&&!J?Object.values(ue).some(pe=>pe>0):!1:!1}),oe=(x==null?void 0:x.tags)||(R==null?void 0:R.tags)||[],se=ie.map(ye=>{let ue=0;ye.style&&oe.includes(ye.style)&&(ue+=3);const ne=ye.tags||[];return oe.forEach(pe=>{ne.some(ge=>ge.toLowerCase().includes(pe.toLowerCase()))&&(ue+=1)}),ye.category&&((x==null?void 0:x.keyPieces)||(R==null?void 0:R.keyPieces)||[]).some(pe=>{var ge;return pe.toLowerCase().includes(((ge=ye.category)==null?void 0:ge.toLowerCase())||"")})&&(ue+=2),{...ye,score:ue}}).sort((ye,ue)=>ue.score-ye.score);d(se.slice(0,12));const le=H(se,x||R);u(le)}catch(Z){console.error("Error loading data:",Z),de.error("Erro ao carregar resultados")}finally{f(!1)}}Y()},[e,x,b,j]);const H=(Y,Z)=>{var V;if(Y.length<3)return[];const re=[],G=new Set,J=((V=x==null?void 0:x.keyPieces)==null?void 0:V.slice(0,3).map((W,ee)=>`Look ${W}`))||["Look Principal","Look Alternativo","Look Verstil"];for(let W=0;W<3&&G.size<Y.length;W++){const ee=[];for(const ie of Y)if(!G.has(ie.id)&&ee.length<3&&(ee.push(ie),G.add(ie.id)),ee.length>=2&&(ee.length>=3||G.size>=Y.length-2))break;ee.length>=2&&re.push({name:J[W]||`Look ${W+1}`,products:ee})}return re},M=Y=>{const Z=b||(i==null?void 0:i.size_letter),re=j||(i==null?void 0:i.size_number),G=Y.stock_by_size;let J=null;if(G&&((G.UN||0)>0?J="UN":Z&&(G[Z]||0)>0?J=Z:re&&(G[re]||0)>0&&(J=re)),!J){de.error("Tamanho no disponvel");return}r({productId:Y.id,name:Y.name,price:Y.price,originalPrice:Y.price,discountPercent:0,size:J,imageUrl:Y.image_url||void 0}),de.success("Adicionado ao carrinho!")},F=()=>`Ol!  Fiz o quiz do Provador VIP e descobri que sou "${(x==null?void 0:x.styleTitle)||(R==null?void 0:R.title)||"meu estilo"}"! 

Ganhei ${g} pontos e cheguei no nvel ${D} (${L})! 

${(x==null?void 0:x.description)||(R==null?void 0:R.description)||""}

Quero ver mais looks que combinam com meu estilo! `,S=Y=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Y);return h?n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Wr,{className:"h-8 w-8 animate-pulse-soft mx-auto mb-4 text-accent"}),n.jsx("p",{className:"text-muted-foreground",children:"Preparando seu resultado..."})]})}):i?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("div",{className:"bg-gradient-to-r from-amber-500/20 via-accent/20 to-amber-500/20 border-b border-amber-500/30",children:n.jsx("div",{className:"container mx-auto px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm animate-slide-in-up",children:[n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx(ki,{className:"h-4 w-4 text-amber-500 fill-amber-500 animate-pulse"}),n.jsxs("span",{className:"font-bold text-amber-700",children:[g," pontos"]})]}),n.jsx("div",{className:"w-px h-4 bg-amber-500/30"}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx(ga,{className:"h-4 w-4 text-accent"}),n.jsxs("span",{className:"font-medium",children:["Nvel ",D,": ",L]})]})]})})}),n.jsx("section",{className:"py-10 md:py-14 bg-gradient-to-b from-secondary/50 to-background",children:n.jsx("div",{className:"container mx-auto px-4 max-w-3xl text-center",children:n.jsxs("div",{className:"animate-bounce-in",children:[n.jsx("span",{className:"text-6xl mb-4 block animate-float",children:(R==null?void 0:R.emoji)||""}),n.jsx("p",{className:"text-sm text-accent font-medium mb-2 animate-slide-in-up",style:{animationDelay:"100ms"},children:"Seu estilo predominante :"}),n.jsx("h1",{className:"font-serif text-3xl md:text-5xl mb-3 animate-slide-in-up",style:{animationDelay:"200ms"},children:(x==null?void 0:x.styleTitle)||(R==null?void 0:R.title)||i.style_title}),n.jsx("p",{className:"text-accent text-lg mb-6 animate-slide-in-up",style:{animationDelay:"300ms"},children:(x==null?void 0:x.styleSubtitle)||(R==null?void 0:R.subtitle)}),n.jsx("div",{className:"bg-card border border-border rounded-2xl p-6 max-w-xl mx-auto mb-6 animate-slide-in-up",style:{animationDelay:"400ms"},children:n.jsx("div",{className:"space-y-3",children:q.map((Y,Z)=>n.jsxs("div",{className:"flex items-start gap-3 text-left",children:[n.jsx(pn,{className:"h-5 w-5 text-accent shrink-0 mt-0.5"}),n.jsx("p",{className:"text-foreground",children:Y})]},Z))})}),n.jsxs("div",{className:"bg-accent/10 border border-accent/30 rounded-xl p-4 max-w-lg mx-auto mb-6 animate-slide-in-up",style:{animationDelay:"500ms"},children:[n.jsxs("p",{className:"text-sm font-medium text-accent mb-2 flex items-center justify-center gap-2",children:[n.jsx(Cae,{className:"h-4 w-4"}),"Suas melhores escolhas valorizam:"]}),n.jsx("div",{className:"flex items-center justify-center gap-2 flex-wrap",children:X.map((Y,Z)=>n.jsx("span",{className:"px-3 py-1 bg-card border border-border rounded-full text-sm font-medium",children:Y},Z))})]}),(x==null?void 0:x.personalTip)&&n.jsxs("div",{className:"bg-amber-50/80 border border-amber-200 rounded-xl p-4 max-w-lg mx-auto mb-6 animate-slide-in-up",style:{animationDelay:"600ms"},children:[n.jsx("p",{className:"text-sm font-medium text-amber-700 mb-1",children:" Dica da sua consultora"}),n.jsx("p",{className:"text-sm text-amber-900",children:x.personalTip})]}),((x==null?void 0:x.colorPalette)||(R==null?void 0:R.colorPalette))&&n.jsxs("div",{className:"mt-6 animate-slide-in-up",style:{animationDelay:"700ms"},children:[n.jsxs("p",{className:"text-sm text-muted-foreground mb-2 flex items-center justify-center gap-2",children:[n.jsx(lk,{className:"h-4 w-4"}),"Suas cores"]}),n.jsx("div",{className:"flex items-center justify-center gap-2",children:($=(x==null?void 0:x.colorPalette)||(R==null?void 0:R.colorPalette))==null?void 0:$.map((Y,Z)=>n.jsx("span",{className:"px-3 py-1 bg-card border border-border rounded-full text-sm",children:Y},Z))})]}),(b||j||(i==null?void 0:i.size_letter)||(i==null?void 0:i.size_number))&&n.jsxs("div",{className:"mt-4 inline-flex items-center gap-2 bg-primary/10 px-4 py-2 rounded-full flex-wrap justify-center",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Seus tamanhos:"}),(b||(i==null?void 0:i.size_letter))&&n.jsx("span",{className:"font-bold",children:b||(i==null?void 0:i.size_letter)}),(b||(i==null?void 0:i.size_letter))&&(j||(i==null?void 0:i.size_number))&&n.jsx("span",{className:"text-muted-foreground",children:"e"}),(j||(i==null?void 0:i.size_number))&&n.jsx("span",{className:"font-bold",children:j||(i==null?void 0:i.size_number)})]})]})})}),l.length>0&&n.jsx("section",{className:"py-10 md:py-14",children:n.jsxs("div",{className:"container mx-auto px-4",children:[n.jsx("h2",{className:"font-serif text-2xl md:text-3xl text-center mb-2",children:"Sugestes de looks pra voc"}),n.jsx("p",{className:"text-center text-muted-foreground mb-8",children:"Todas as peas tm estoque no seu tamanho "}),n.jsx("div",{className:"space-y-8 max-w-5xl mx-auto",children:l.map((Y,Z)=>n.jsxs("div",{className:"bg-card rounded-2xl p-5 border border-border",children:[n.jsxs("h3",{className:"font-serif text-xl mb-4 flex items-center gap-2",children:[n.jsx("span",{className:"w-8 h-8 rounded-full bg-accent/10 text-accent flex items-center justify-center text-sm font-medium",children:Z+1}),Y.name]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Y.products.map(re=>n.jsxs("div",{className:"relative group",children:[n.jsx(Gt,{to:`/produto/${re.id}`,children:n.jsx(_p,{name:re.name,price:re.price,imageUrl:re.image_url||void 0,sizes:re.sizes||[],badge:"Tem no seu tamanho"})}),n.jsxs(he,{size:"sm",variant:"secondary",className:"absolute bottom-4 right-2 opacity-0 group-hover:opacity-100 transition-opacity gap-1",onClick:()=>M(re),children:[n.jsx(El,{className:"h-3 w-3"}),"Quero"]})]},re.id))}),n.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total do look: ",n.jsx("span",{className:"font-semibold text-foreground",children:S(Y.products.reduce((re,G)=>re+G.price,0))})]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>Y.products.forEach(re=>M(re)),children:[n.jsx(ln,{className:"h-4 w-4 mr-1"}),"Quero esse look"]})]})]},Z))})]})}),c.length>0&&n.jsx("section",{className:"py-10 md:py-14 bg-secondary/30",children:n.jsxs("div",{className:"container mx-auto px-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"font-serif text-2xl md:text-3xl",children:"Mais peas que combinam com voc"}),n.jsx(Gt,{to:"/catalogo",children:n.jsxs(he,{variant:"outline",className:"gap-2",children:["Ver catlogo",n.jsx(ps,{className:"h-4 w-4"})]})})]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6",children:c.slice(0,8).map(Y=>n.jsx(Gt,{to:`/produto/${Y.id}`,children:n.jsx(_p,{name:Y.name,price:Y.price,imageUrl:Y.image_url||void 0,sizes:Y.sizes||[],badge:"Combina com voc"})},Y.id))}),c.length===0&&n.jsx("p",{className:"text-center text-muted-foreground",children:"Estamos preparando looks especiais para voc!"})]})}),n.jsx("section",{className:"py-10 md:py-14 bg-gradient-to-b from-background to-secondary/30",children:n.jsxs("div",{className:"container mx-auto px-4 max-w-2xl",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("p",{className:"text-[10px] tracking-[0.3em] uppercase text-foreground/40 font-medium mb-4",children:"Prximo passo"}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mb-2",children:"Aprofunde seu perfil"}),n.jsx("p",{className:"text-foreground/50 font-light",children:"Responda mdulos especficos para refinar ainda mais a sua curadoria"})]}),n.jsx(Pq,{completedMissions:[],currentPoints:g,currentLevel:D})]})}),n.jsx("section",{className:"py-10 md:py-14",children:n.jsxs("div",{className:"container mx-auto px-4 max-w-md",children:[n.jsxs("div",{className:"bg-card rounded-2xl p-6 border border-border shadow-sm",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx(nn,{className:"h-10 w-10 mx-auto text-whatsapp mb-3"}),n.jsx("h3",{className:"font-serif text-xl mb-2",children:"Fale com sua consultora"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Receba mais sugestes personalizadas no WhatsApp!"})]}),n.jsx(q_,{href:`https://wa.me/5511999999999?text=${encodeURIComponent(F())}`,label:"Conversar no WhatsApp"})]}),n.jsxs("div",{className:"mt-6 text-center space-y-2",children:[n.jsx(Gt,{to:"/minha-conta",children:n.jsxs(he,{variant:"ghost",className:"gap-2 w-full",children:[n.jsx(Wr,{className:"h-4 w-4"}),"Ver minhas sugestes"]})}),n.jsx(Gt,{to:"/quiz",children:n.jsxs(he,{variant:"ghost",className:"gap-2",children:[n.jsx(ps,{className:"h-4 w-4 rotate-180"}),"Refazer o quiz"]})})]})]})})]}):n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-muted-foreground mb-4",children:"Resultado no encontrado"}),n.jsx(Gt,{to:"/quiz",children:n.jsx(he,{children:"Fazer o quiz novamente"})})]})})};function gpe({missionId:e,userId:t,theme:r,photoPrompt:s,maxPhotos:a=5,onPhotosChange:i,onPointsEarned:o}){const[c,d]=P.useState([]),[l,u]=P.useState(!1),h=P.useRef(null),f=async v=>{const x=v.target.files;if(!x||x.length===0)return;const y=a-c.length,b=Array.from(x).slice(0,y);b.length<x.length&&de.info(`Mximo de ${a} fotos permitidas`),u(!0);for(const j of b)await m(j);u(!1),h.current&&(h.current.value="")},m=async v=>{try{const y=`${Date.now()}-${v.name.replace(/[^a-zA-Z0-9.-]/g,"_")}`,b=`${t}/missions/${e}/${y}`,{error:j}=await ce.storage.from("prints").upload(b,v,{cacheControl:"3600",upsert:!1});if(j)throw j;const{data:T}=ce.storage.from("prints").getPublicUrl(b),O=T.publicUrl,R={url:O,analysis:null,isAnalyzing:!0};d(D=>{const L=[...D,R];return i(L),L}),o(50);try{const{data:D,error:L}=await ce.functions.invoke("analyze-product-image",{body:{image_url:O}});L&&console.error("Analysis error:",L),d(q=>{const X=q.map(H=>H.url===O?{...H,analysis:(D==null?void 0:D.analysis)||null,isAnalyzing:!1}:H);return i(X),X})}catch(D){console.error("Failed to analyze:",D),d(L=>{const q=L.map(X=>X.url===O?{...X,isAnalyzing:!1}:X);return i(q),q})}}catch(x){console.error("Upload error:",x),de.error("Erro ao enviar foto")}},p=v=>{d(x=>{const y=x.filter(b=>b.url!==v);return i(y),y})},g=c.length<a;return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"text-center",children:[n.jsxs("div",{className:"inline-flex items-center gap-2 bg-accent/10 px-4 py-2 rounded-full mb-3",children:[n.jsx(Ma,{className:"h-4 w-4 text-accent"}),n.jsx("span",{className:"text-sm font-medium text-accent",children:"Etapa opcional: +50pts por foto"})]}),n.jsx("p",{className:"text-muted-foreground text-sm",children:s})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[c.map((v,x)=>n.jsxs("div",{className:"relative aspect-square rounded-xl overflow-hidden border-2 border-accent/30 bg-secondary",children:[n.jsx("img",{src:v.url,alt:`Inspirao ${x+1}`,className:"w-full h-full object-cover"}),v.isAnalyzing&&n.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:n.jsx(At,{className:"h-6 w-6 text-white animate-spin"})}),v.analysis&&n.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/70 to-transparent p-2",children:n.jsxs("div",{className:"flex items-center gap-1 text-white text-xs",children:[n.jsx(Wr,{className:"h-3 w-3"}),n.jsx("span",{className:"truncate",children:v.analysis.estilo||v.analysis.cor||"Analisado"})]})}),n.jsx("button",{onClick:()=>p(v.url),className:"absolute top-1 right-1 w-6 h-6 rounded-full bg-black/60 text-white flex items-center justify-center hover:bg-red-500 transition-colors",children:n.jsx(an,{className:"h-4 w-4"})}),!v.isAnalyzing&&n.jsx("div",{className:"absolute top-1 left-1 w-6 h-6 rounded-full bg-green-500 text-white flex items-center justify-center",children:n.jsx(xn,{className:"h-4 w-4"})})]},v.url)),g&&n.jsx("button",{onClick:()=>{var v;return(v=h.current)==null?void 0:v.click()},disabled:l,className:We("aspect-square rounded-xl border-2 border-dashed border-accent/30 flex flex-col items-center justify-center gap-2 text-muted-foreground hover:border-accent hover:text-accent transition-colors",l&&"opacity-50 cursor-not-allowed"),children:l?n.jsx(At,{className:"h-6 w-6 animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(Ma,{className:"h-6 w-6"}),n.jsx("span",{className:"text-xs",children:"Adicionar"})]})})]}),n.jsx("input",{ref:h,type:"file",accept:"image/*",multiple:!0,onChange:f,className:"hidden"}),n.jsxs("div",{className:"text-center text-sm text-muted-foreground",children:[c.length,"/",a," fotos ",c.length>0&&n.jsxs("span",{className:"text-amber-600 font-medium ml-1",children:["+",c.length*50," pts"]})]})]})}function xpe({mission:e,earnedPoints:t,totalPoints:r,previousLevel:s,newLevel:a,nextMissionId:i,nextMissionName:o}){const c=fr(),{title:d}=uf(r),l=a>s;return n.jsxs("div",{className:"text-center animate-fade-in",children:[n.jsx("div",{className:"w-16 h-16 mx-auto mb-8 border border-foreground/10 rounded-full flex items-center justify-center",children:n.jsx(Er,{className:"h-7 w-7 text-foreground/40"})}),n.jsx("h1",{className:"font-serif text-3xl mb-2",children:"Mdulo concludo"}),n.jsx("p",{className:"text-foreground/50 font-light mb-8",children:e.title}),n.jsx("div",{className:"border border-foreground/10 p-5 mb-8 max-w-sm mx-auto",children:n.jsx("p",{className:"text-sm text-foreground/60 font-light",children:"Suas sugestes de estilo foram refinadas com base nas suas respostas."})}),n.jsxs("div",{className:"border border-foreground/10 p-6 mb-8 max-w-sm mx-auto",children:[n.jsx("p",{className:"text-[11px] tracking-[0.2em] uppercase text-foreground/40 mb-3",children:"Pontos conquistados"}),n.jsxs("p",{className:"text-2xl font-light text-foreground",children:["+",t]}),l&&n.jsx("div",{className:"border-t border-foreground/10 mt-4 pt-4",children:n.jsxs("p",{className:"text-sm text-foreground/60",children:["Voc subiu para ",n.jsx("span",{className:"font-medium text-foreground",children:d})]})}),n.jsxs("p",{className:"text-[11px] text-foreground/30 mt-3 tracking-wide",children:[d,"  ",r," pontos acumulados"]})]}),n.jsxs("div",{className:"space-y-3 max-w-sm mx-auto",children:[n.jsx("button",{onClick:()=>c("/minhas-sugestoes"),className:"w-full py-3.5 bg-foreground text-background text-xs tracking-[0.2em] uppercase font-medium transition-all duration-300 hover:bg-accent",children:"Ver minhas sugestes atualizadas"}),i&&n.jsxs("button",{onClick:()=>c(`/missao/${i}`),className:"w-full py-3.5 border border-foreground/20 text-xs tracking-[0.2em] uppercase font-medium text-foreground/60 transition-all duration-300 hover:border-foreground hover:text-foreground flex items-center justify-center gap-2",children:["Prximo mdulo",n.jsx(ps,{className:"h-3.5 w-3.5"})]}),n.jsx("button",{onClick:()=>c("/minha-conta"),className:"w-full py-3 text-xs tracking-[0.15em] uppercase text-foreground/40 hover:text-foreground/60 transition-colors",children:"Voltar para minha conta"})]}),i&&o&&n.jsxs("div",{className:"mt-8 text-[11px] text-foreground/30 tracking-wide",children:[n.jsx("p",{children:"Prximo mdulo recomendado:"}),n.jsx("p",{className:"font-medium text-foreground/50 mt-0.5",children:o})]})]})}const vpe=()=>{const e=fr(),{missionId:t}=ra(),{user:r,isLoading:s}=Hn(),{firePoints:a,fireLevelUp:i,fireConfetti:o}=Hk(),[c,d]=P.useState(null),[l,u]=P.useState(0),[h,f]=P.useState([]),[m,p]=P.useState(null),[g,v]=P.useState([]),[x,y]=P.useState(0),[b,j]=P.useState(!1),[T,O]=P.useState(!1),[R,D]=P.useState(!1),[L,q]=P.useState(10),[X,H]=P.useState(1),[M,F]=P.useState(0),[S,E]=P.useState(0),[N,C]=P.useState(1),[k,I]=P.useState(!1),[U,$]=P.useState(null),[Y,Z]=P.useState(null);P.useEffect(()=>{if(!s&&!r){e("/entrar?redirect=/missao/"+t,{replace:!0});return}const pe=Pw(t||"");if(!pe){de.error("Misso no encontrada"),e("/minha-conta");return}d(pe),r&&re()},[t,r,s,e]);const re=async()=>{if(!r||!t)return;const{data:pe}=await ce.from("profiles").select("quiz_points, quiz_level, completed_missions").eq("user_id",r.id).single();if(pe){F(pe.quiz_points||0),H(pe.quiz_level||1);const Ne=pe.completed_missions||[];if(Ne.includes(t)){de.info("Voc j completou essa misso!"),e("/minha-conta");return}const _e=cv([...Ne,t]);_e.length>0&&Z({id:_e[0].id,name:_e[0].title})}const{data:ge}=await ce.from("mission_attempts").select("*").eq("user_id",r.id).eq("mission_id",t).eq("status","in_progress").maybeSingle();if(ge){$(ge.id),u(ge.current_question||0);const Ne=ge.answers_json;if(f(Ne||[]),ge.images_urls&&ge.images_urls.length>0){const _e=ge.images_urls.map(be=>({url:be,analysis:null,isAnalyzing:!1}));v(_e),y(_e.length*mo.photoUpload)}}};if(!c||s)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-accent"})});const G=c.questions.length,J=l===G,V=l===G-1,W=J?null:c.questions[l],ee=pe=>{p(pe)},ie=pe=>{v(pe)},oe=pe=>{y(ge=>ge+pe),q(pe),D(!0),a(pe)},se=async(pe,ge)=>{if(!r||!t)return;const Ne={user_id:r.id,mission_id:t,status:"in_progress",current_question:pe,answers_json:JSON.parse(JSON.stringify(ge)),images_urls:g.map(_e=>_e.url),score_earned:0};if(U)await ce.from("mission_attempts").update(Ne).eq("id",U);else{const{data:_e}=await ce.from("mission_attempts").insert([Ne]).select("id").single();_e&&$(_e.id)}},le=async()=>{if(!(!r||!c)){j(!0);try{const ge=h.length*mo.perQuestion+x+mo.completionBonus,Ne=M+ge,{level:_e}=uf(Ne);E(ge),C(_e);const be=g.filter(Ke=>Ke.analysis).map(Ke=>JSON.parse(JSON.stringify(Ke.analysis)));U?await ce.from("mission_attempts").update({status:"completed",completed_at:new Date().toISOString(),score_earned:ge,images_urls:g.map(Ke=>Ke.url),analysis_json:JSON.parse(JSON.stringify({photos:be}))}).eq("id",U):await ce.from("mission_attempts").insert([{user_id:r.id,mission_id:c.id,status:"completed",completed_at:new Date().toISOString(),current_question:G,answers_json:JSON.parse(JSON.stringify(h)),score_earned:ge,images_urls:g.map(Ke=>Ke.url),analysis_json:JSON.parse(JSON.stringify({photos:be}))}]),await ce.from("missions_log").insert([{user_id:r.id,mission_id:c.id,points_earned:ge,answers:JSON.parse(JSON.stringify(h))}]);const{error:Me}=await ce.rpc("award_loyalty_points",{p_user_id:r.id,p_points:ge,p_description:`Misso: ${c.title}`,p_mission_id:c.id});Me&&console.error("Error awarding loyalty points:",Me);const{data:Se}=await ce.from("profiles").select("completed_missions, quiz_points, quiz_level").eq("user_id",r.id).single(),$e=[...(Se==null?void 0:Se.completed_missions)||[],c.id];await ce.from("profiles").update({quiz_points:Ne,quiz_level:_e,completed_missions:$e,last_mission_id:c.id,last_mission_completed_at:new Date().toISOString(),suggestions_updated_at:new Date().toISOString()}).eq("user_id",r.id),_e>X&&setTimeout(()=>{i(),de.success(` Voc subiu para o Nvel ${_e}!`)},500),o({type:"celebration"}),F(Ne),O(!0)}catch(pe){console.error("Error completing mission:",pe),de.error("Erro ao salvar misso")}finally{j(!1)}}},ye=async()=>{if(J){await le();return}if(m===null||!W)return;const pe=W.options[m],ge={questionId:W.id,answer:pe.text,styleBonus:pe.styleBonus},Ne=[...h,ge];f(Ne),q(mo.perQuestion),D(!0),a(mo.perQuestion),await se(l+1,Ne),I(!0),setTimeout(()=>{u(l+1),p(null),I(!1)},300)},ue=()=>{l>0&&(I(!0),setTimeout(()=>{J?u(G-1):(u(l-1),f(h.slice(0,-1))),p(null),I(!1)},150))},ne=async()=>{await le()};return T?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("main",{className:"container mx-auto px-4 py-12 max-w-lg",children:n.jsx(xpe,{mission:c,earnedPoints:S,totalPoints:M,previousLevel:X,newLevel:N,nextMissionId:Y==null?void 0:Y.id,nextMissionName:Y==null?void 0:Y.name})})]}):n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(Cr,{}),n.jsx(Tq,{points:L,show:R,onComplete:()=>D(!1)}),n.jsxs("main",{className:"flex-1 container mx-auto px-4 py-6 max-w-2xl",children:[n.jsxs("div",{className:"text-center mb-10",children:[n.jsx("span",{className:"inline-block text-[10px] tracking-[0.4em] uppercase text-gold font-bold mb-4",children:"Misso de Estilo"}),n.jsx("h1",{className:"font-serif text-3xl md:text-4xl text-primary lowercase italic",children:c.title}),n.jsx("p",{className:"text-xs text-primary/40 mt-3 tracking-widest uppercase font-light",children:c.subtitle})]}),n.jsxs("div",{className:"mb-12",children:[n.jsxs("div",{className:"flex justify-between items-end mb-3",children:[n.jsxs("div",{className:"flex flex-col",children:[n.jsx("span",{className:"text-[9px] tracking-[0.2em] uppercase text-primary/40 font-bold mb-1",children:J?"RECONHECIMENTO VISUAL":`ETAPA ${l+1} / ${G}`}),n.jsx("span",{className:"font-serif text-lg italic text-primary",children:"Progresso da Misso"})]}),n.jsxs("span",{className:"text-gold font-bold text-sm tracking-widest",children:[Math.round((l+1)/(G+1)*100),"%"]})]}),n.jsx("div",{className:"h-1 bg-primary/5 rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-gold transition-all duration-1000 ease-out",style:{width:`${(l+1)/(G+1)*100}%`}})})]}),n.jsx("div",{className:We("transition-all duration-300 ease-out",k?"opacity-0 translate-y-4":"opacity-100 translate-y-0"),children:J?n.jsx(gpe,{missionId:c.id,userId:(r==null?void 0:r.id)||"",theme:c.theme,photoPrompt:c.photoPrompt,maxPhotos:5,onPhotosChange:ie,onPointsEarned:oe}):W&&n.jsxs(n.Fragment,{children:[W.subtext&&n.jsx("p",{className:"text-[10px] tracking-[0.3em] uppercase text-gold font-bold mb-4 text-center",children:W.subtext}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl text-primary text-center leading-snug mb-10",children:W.question}),n.jsx("div",{className:"space-y-3",children:W.options.map((pe,ge)=>n.jsx("div",{className:"animate-slide-in-up",style:{animationDelay:`${100+ge*50}ms`},children:n.jsx(Aq,{text:pe.text,emoji:pe.emoji,isSelected:m===ge,onClick:()=>ee(ge)})},ge))})]})},l),n.jsxs("div",{className:"mt-10 flex gap-4",children:[l>0&&n.jsxs("button",{onClick:ue,disabled:b||k,className:"px-8 py-5 text-[10px] tracking-[0.2em] uppercase font-bold text-primary/40 transition-all hover:text-primary disabled:opacity-40",children:[n.jsx(vs,{className:"h-4 w-4 mr-2 inline"}),"Voltar"]}),J?n.jsxs("div",{className:"flex-1 flex gap-4",children:[n.jsx("button",{onClick:ne,disabled:b,className:"flex-1 h-16 rounded-full border border-primary/20 text-[10px] tracking-[0.2em] uppercase font-bold text-primary/60 transition-all hover:bg-white disabled:opacity-40",children:"Pular Fotos"}),n.jsx("button",{onClick:ye,disabled:b,className:"flex-1 h-16 rounded-full btn-gold text-white text-[10px] tracking-[0.2em] uppercase font-bold shadow-xl transition-all disabled:opacity-30 flex items-center justify-center gap-2",children:b?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 animate-spin"}),"SALVANDO..."]}):"CONCLUIR MISSO"})]}):n.jsx("button",{onClick:ye,disabled:m===null||b||k,className:`
                flex-1 h-16 rounded-full text-[10px] tracking-[0.2em] uppercase font-bold shadow-xl transition-all duration-500 flex items-center justify-center gap-3
                ${m!==null?"btn-gold text-white":"bg-primary/5 text-primary/20 cursor-not-allowed"}
                ${b?"opacity-70":""}
              `,children:b?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 animate-spin"}),"SALVANDO..."]}):V?"FINALIZAR ETAPA":n.jsxs(n.Fragment,{children:["PRXIMA ETAPA",n.jsx(ps,{className:"h-4 w-4"})]})})]})]})]})},ype=pg("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ae({className:e,variant:t,...r}){return n.jsx("div",{className:We(ype({variant:t}),e),...r})}function Oq(){const[e,t]=P.useState(!1),[r,s]=P.useState(null);return{isAnalyzing:e,analysisResult:r,analyzeImage:async o=>{t(!0),s(null);try{const d=o.startsWith("http://")||o.startsWith("https://")?{image_url:o}:{image_base64:o},{data:l,error:u}=await ce.functions.invoke("analyze-product-image",{body:d});return u?(console.error("Edge function error:",u),de.error("Erro ao analisar imagem"),null):l!=null&&l.error?(de.error(l.error),null):l!=null&&l.success&&(l!=null&&l.analysis)?(s(l.analysis),de.success("Anlise concluda! Confira as sugestes."),l.analysis):null}catch(c){return console.error("Error analyzing image:",c),de.error("Erro ao conectar com o servio de anlise"),null}finally{t(!1)}},clearAnalysis:()=>{s(null)}}}const bpe={default:{category:35,color:20,modeling:20,details:15,style:10},color:{category:25,color:35,modeling:20,details:10,style:10},modeling:{category:25,color:20,modeling:35,details:10,style:10},elegant:{category:25,color:20,modeling:20,details:10,style:25,tagBonus:["elegante","alfaiataria","sofisticado","clssico","chic"]},casual:{category:25,color:20,modeling:20,details:10,style:25,tagBonus:["casual","dia a dia","bsico","confortvel","despojado"]},category:{category:45,color:20,modeling:20,details:10,style:5}};function iu(e){return e?e.toLowerCase().trim().replace(/[_-]/g," "):""}function H0(e,t){const r=iu(e),s=iu(t);return!r||!s?!1:r===s}function wpe(e,t){if(H0(e,t))return!0;const r={neutro:["preto","branco","cinza","bege","nude","off white","creme","areia"],quente:["vermelho","laranja","amarelo","dourado","coral","terracota","mostarda"],frio:["azul","verde","roxo","prata","turquesa","menta","lavanda"],rosa:["rosa","pink","magenta","coral","salmo","blush"],marrom:["marrom","caramelo","chocolate","caf","terra","camel"],vinho:["vinho","bord","marsala","burgundy","cereja"]},s=iu(e),a=iu(t);for(const i of Object.values(r)){const o=i.some(d=>s.includes(d)),c=i.some(d=>a.includes(d));if(o&&c)return!0}return!1}function _pe(e,t,r){if(!e)return!1;if(e.UN&&e.UN>0||e.U&&e.U>0)return!0;for(const s of t){const a=s.toUpperCase().trim();if(e[a]&&e[a]>0)return!0}for(const s of r){const a=s.trim();if(e[a]&&e[a]>0)return!0}return!1}function jpe(e,t,r="default"){var h,f,m,p,g;const s=bpe[r];let a=0;const i=[],o={category:!1,color:!1,style:!1,occasion:!1,modeling:!1,matchingTags:[]};H0(e.category,(h=t.categoria)==null?void 0:h.value)&&(a+=s.category,o.category=!0,i.push("categoria")),wpe(e.color,(f=t.cor)==null?void 0:f.value)&&(a+=s.color,o.color=!0,i.push("cor")),H0(e.modeling,(m=t.modelagem)==null?void 0:m.value)&&(a+=s.modeling,o.modeling=!0,i.push("modelagem")),H0(e.style,(p=t.estilo)==null?void 0:p.value)&&(a+=s.style,o.style=!0,i.push("estilo")),H0(e.occasion,(g=t.ocasiao)==null?void 0:g.value)&&(o.occasion=!0);const c=t.tags_extras||[],d=e.tags||[];let l=0;const u=3;for(const v of c){if(l>=u)break;const x=iu(v);for(const y of d){const b=iu(y);if(x&&b&&(x.includes(b)||b.includes(x))){l++,o.matchingTags.push(y);break}}}return l>0&&(a+=Math.round(l/u*s.details),i.push("detalhes")),s.tagBonus&&d.length>0&&s.tagBonus.some(x=>d.some(y=>iu(y).includes(iu(x))))&&(a+=10),{score:a,matchDetails:o,matchReasons:i}}function Npe(e,t,r){const{letterSizes:s,numberSizes:a,limit:i=9,refinementMode:o="default"}=r,c=[];for(const m of e){if(!m.is_active)continue;const p=_pe(m.stock_by_size,s,a),{score:g,matchDetails:v,matchReasons:x}=jpe(m,t,o);c.push({id:m.id,name:m.name,price:m.price,image_url:m.image_url,sizes:m.sizes||[],stock_by_size:m.stock_by_size||{},is_active:m.is_active??!0,category:m.category,color:m.color,style:m.style,occasion:m.occasion,modeling:m.modeling,tags:m.tags||[],group_key:m.group_key,score:g,matchReasons:x,matchDetails:v,outOfStockInSelectedSize:!p,_hasStock:p})}c.sort((m,p)=>p.score-m.score);const d=c.length>0?c[0]:null,l=c.filter(m=>m._hasStock),u=l.length>0;let h=null,f=[];if(d){const{_hasStock:m,...p}=d;h=p,d._hasStock?f=l.filter(g=>g.id!==d.id).slice(0,i-1).map(({_hasStock:g,...v})=>v):f=l.slice(0,i).map(({_hasStock:g,...v})=>v)}return{identifiedProduct:h,alternatives:f,hasStockAvailable:u}}function Spe(){const[e,t]=P.useState(!1),[r,s]=P.useState({identifiedProduct:null,alternatives:[],hasStockAvailable:!0}),a=P.useCallback(async(o,c)=>{t(!0);const d={identifiedProduct:null,alternatives:[],hasStockAvailable:!1};s({identifiedProduct:null,alternatives:[],hasStockAvailable:!0});try{const{data:l,error:u}=await ce.from("product_catalog").select("id, name, price, image_url, sizes, stock_by_size, is_active, category, color, style, occasion, modeling, tags, group_key").eq("is_active",!0);if(u)return console.error("Error fetching products:",u),d;if(!l||l.length===0)return s(d),d;const h=l.map(m=>({...m,stock_by_size:typeof m.stock_by_size=="object"?m.stock_by_size:null})),f=Npe(h,o,c);return s(f),f}catch(l){return console.error("Error finding matches:",l),d}finally{t(!1)}},[]),i=P.useCallback(()=>{s({identifiedProduct:null,alternatives:[],hasStockAvailable:!0})},[]);return{isLoading:e,identifiedProduct:r.identifiedProduct,alternatives:r.alternatives,hasStockAvailable:r.hasStockAvailable,findMatches:a,clearMatches:i}}function Cpe(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const Epe=["PP","P","M","G","GG"],kpe=["34","36","38","40","42","44","46"],Ape=[{mode:"color",label:"Mais parecido com a COR"},{mode:"modeling",label:"Mais parecido com a MODELAGEM"},{mode:"category",label:"Mais parecido com a CATEGORIA"},{mode:"elegant",label:"Mais elegante"},{mode:"casual",label:"Mais casual"}],Tpe=[{icon:Ma,number:"01",title:"Envie sua foto",desc:"Print do Instagram, selfie no espelho, foto de revista qualquer imagem serve."},{icon:Wr,number:"02",title:"IA identifica a pea",desc:"Nossa inteligncia artificial analisa cor, modelagem, tecido e estilo em segundos."},{icon:Ln,number:"03",title:"Encontre peas parecidas",desc:"Mostramos opes similares do nosso catlogo, disponveis no seu tamanho."}],Ppe=[{icon:en,label:"Troca fcil",desc:"Sem burocracia"},{icon:xs,label:"3x sem juros",desc:"No carto"},{icon:nn,label:"Suporte WhatsApp",desc:"Resposta rpida"},{icon:gn,label:"Envio Brasil",desc:"Todo o pas"}],Ope=()=>{const e=fr(),{addItem:t}=Wu(),{user:r}=Hn(),[s,a]=P.useState(1),[i,o]=P.useState(null),[c,d]=P.useState(null),[l,u]=P.useState([]),[h,f]=P.useState([]),[m,p]=P.useState("default"),{isAnalyzing:g,analysisResult:v,analyzeImage:x,clearAnalysis:y}=Oq(),{isLoading:b,identifiedProduct:j,alternatives:T,hasStockAvailable:O,findMatches:R,clearMatches:D}=Spe(),L=[...l,...h].join(" / ")||"",q=l.length>0||h.length>0,X=$=>{u(Y=>Y.includes($)?Y.filter(Z=>Z!==$):[...Y,$])},H=$=>{f(Y=>Y.includes($)?Y.filter(Z=>Z!==$):[...Y,$])},M=$=>{var Z;const Y=(Z=$.target.files)==null?void 0:Z[0];if(Y){o(Y);const re=new FileReader;re.onloadend=()=>{d(re.result)},re.readAsDataURL(Y),y(),D(),p("default")}},F=async()=>{if(!c){de.error("Envie uma imagem primeiro");return}await x(c)&&a(2)},S=async()=>{if(!(!v||!i)){try{const $=`${Date.now()}-${i.name}`,{error:Y}=await ce.storage.from("prints").upload($,i);Y||await ce.from("print_requests").insert({image_path:$,size:L||null,user_id:(r==null?void 0:r.id)||null,status:"pending"})}catch($){console.error("Error saving print request:",$)}await R(v,{letterSizes:l,numberSizes:h,refinementMode:"default"}),a(3)}},E=async $=>{if(!v)return;const Y=m===$?"default":$;p(Y);const Z=await R(v,{letterSizes:l,numberSizes:h,refinementMode:Y});!Z.identifiedProduct&&Z.alternatives.length===0&&de.info("No encontrei produtos com esse filtro nos seus tamanhos")},N=$=>{const Y=[...l,...h].find(Z=>{const re=$.stock_by_size[Z]||$.stock_by_size[Z.toUpperCase()];return re&&re>0})||l[0]||h[0]||"";t({productId:$.id,name:$.name,price:$.price,originalPrice:$.price,discountPercent:0,size:Y,imageUrl:$.image_url}),de.success("Adicionado ao carrinho!"),e("/carrinho")},C=()=>{const $=l.length>0?l.join(", "):"",Y=h.length>0?h.join(", "):"";let Z="";return $&&Y?Z=`${$} / ${Y}`:$?Z=$:Y?Z=Y:Z="no informado",`https://wa.me/5562991223519?text=${encodeURIComponent(`Oi! Usei o Buscar por Foto no Provador VIP 
Meu tamanho : ${Z}
Pode me ajudar a achar uma pea parecida?`)}`},k=()=>{a(1),o(null),d(null),u([]),f([]),p("default"),y(),D()},I=()=>{var Z,re,G,J;if(!v)return"";const $=v;if($.resumo_visual)return $.resumo_visual;const Y=[];return(Z=$.categoria)!=null&&Z.value&&Y.push($.categoria.value),(re=$.cor)!=null&&re.value&&Y.push(`em tom ${$.cor.value}`),(G=$.decote)!=null&&G.value&&Y.push(`com decote ${$.decote.value}`),(J=$.estilo)!=null&&J.value&&Y.push(`e vibe ${$.estilo.value}`),Y.length>0?`Parece ${Y.join(" ")}`:"Pea identificada"},U=()=>{var $;($=document.getElementById("buscar-foto-tool"))==null||$.scrollIntoView({behavior:"smooth"})};return n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(Xm,{}),n.jsx(Cr,{}),n.jsx("section",{className:"py-14 md:py-20 px-5 text-center",children:n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsxs("span",{className:"inline-flex items-center gap-2 text-accent text-xs tracking-[0.2em] uppercase font-medium mb-4",children:[n.jsx(Wr,{className:"h-3.5 w-3.5"}),"Inteligncia Artificial"]}),n.jsxs("h1",{className:"font-serif text-3xl md:text-4xl lg:text-5xl leading-[1.15] mb-4",children:["Viu um look e"," ",n.jsxs("span",{className:"text-accent italic",children:["quer encontrar",n.jsx("br",{className:"hidden sm:block"}),"pea parecida?"]})]}),n.jsx("p",{className:"text-muted-foreground font-light text-sm md:text-base max-w-lg mx-auto leading-relaxed mb-8",children:"Envie qualquer foto  print do Instagram, selfie no espelho, inspirao do Pinterest  e a nossa IA encontra opes similares no seu tamanho em segundos."}),n.jsx("button",{onClick:U,className:"px-12 py-4 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white",children:"Enviar minha foto"}),n.jsx("p",{className:"text-[11px] text-muted-foreground mt-4 tracking-wide",children:"Grtis  Sem cadastro  Resultado em segundos"})]})}),n.jsx("section",{className:"py-14 md:py-20 px-5 bg-secondary/30",children:n.jsxs("div",{className:"max-w-4xl mx-auto",children:[n.jsxs("div",{className:"text-center mb-10 md:mb-14",children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-medium",children:"Como funciona"}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mt-2 mb-3",children:"3 passos simples, resultado incrvel."}),n.jsx("p",{className:"text-muted-foreground text-sm font-light max-w-md mx-auto",children:"A ferramenta mais inteligente para encontrar looks que voc ama."})]}),n.jsx("div",{className:"grid md:grid-cols-3 gap-6 md:gap-8",children:Tpe.map($=>n.jsxs("div",{className:"relative text-center group",children:[n.jsx("div",{className:"w-16 h-16 rounded-full bg-card border-2 border-border flex items-center justify-center mx-auto mb-5 shadow-sm group-hover:shadow-md group-hover:border-accent/40 transition-all duration-300",children:n.jsx($.icon,{className:"h-7 w-7 text-accent"})}),n.jsxs("span",{className:"text-[10px] tracking-[0.2em] uppercase text-accent font-semibold",children:["Passo ",$.number]}),n.jsx("h3",{className:"font-serif text-lg mt-1 mb-2",children:$.title}),n.jsx("p",{className:"text-sm text-muted-foreground font-light leading-relaxed",children:$.desc})]},$.number))})]})}),n.jsx("section",{className:"py-14 md:py-20 px-5",children:n.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-medium",children:"Funciona com tudo"}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mt-2 mb-3",children:"Qualquer foto, a gente encontra."}),n.jsx("p",{className:"text-muted-foreground text-sm font-light mb-10 max-w-md mx-auto",children:"No precisa ser foto profissional. Vale qualquer inspirao."}),n.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-4 md:gap-x-8",children:["Print do Instagram","Selfie no espelho","Foto do Pinterest","Screenshot de srie","Foto de revista","Look de amiga"].map($=>n.jsx("span",{className:"font-serif text-base md:text-lg text-foreground/60",children:$},$))})]})}),n.jsx("section",{id:"buscar-foto-tool",className:"py-14 md:py-20 px-5 bg-[hsl(35,30%,94%)]/60",children:n.jsxs("div",{className:"max-w-lg mx-auto",children:[n.jsx("div",{className:"flex items-center justify-center gap-3 mb-8",children:[1,2,3].map($=>n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`
                    w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium transition-all duration-300
                    ${s>=$?"bg-foreground text-background":"border-2 border-foreground/20 text-foreground/40"}
                  `,children:s>$?n.jsx(xn,{className:"h-4 w-4"}):$}),$<3&&n.jsx("div",{className:`w-8 h-px transition-colors duration-300 ${s>$?"bg-foreground":"bg-foreground/15"}`})]},$))}),s===1&&n.jsxs("div",{className:"animate-fade-in space-y-6",children:[n.jsxs("div",{className:"text-center mb-2",children:[n.jsx("h3",{className:"font-serif text-xl mb-1",children:"Envie sua foto"}),n.jsx("p",{className:"text-sm text-muted-foreground font-light",children:"Print, selfie, inspirao  qualquer imagem funciona."})]}),n.jsxs("div",{className:"border-2 border-dashed border-foreground/15 rounded-xl p-8 text-center cursor-pointer hover:border-accent/50 transition-all duration-300 bg-card/50",onClick:()=>{var $;return($=document.getElementById("file-input"))==null?void 0:$.click()},children:[c?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:c,alt:"Preview",className:"max-h-64 mx-auto rounded-lg shadow-sm"}),n.jsx("button",{className:"mt-4 text-xs text-muted-foreground hover:text-foreground transition-colors tracking-wide",onClick:$=>{$.stopPropagation(),o(null),d(null),y(),D()},children:"Trocar imagem"})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"w-14 h-14 rounded-full bg-secondary/60 flex items-center justify-center mx-auto mb-3",children:n.jsx(sk,{className:"h-6 w-6 text-muted-foreground"})}),n.jsx("p",{className:"text-sm text-muted-foreground font-light",children:"Clique para enviar ou arraste sua imagem"}),n.jsx("p",{className:"text-[10px] text-muted-foreground/60 mt-1 tracking-wide",children:"JPG, PNG ou WEBP"})]}),n.jsx("input",{id:"file-input",type:"file",accept:"image/*",onChange:M,className:"hidden"})]}),c&&n.jsx("button",{onClick:F,disabled:g,className:"w-full px-10 py-3.5 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white disabled:opacity-50",children:g?n.jsxs("span",{className:"inline-flex items-center gap-2",children:[n.jsx(At,{className:"h-4 w-4 animate-spin"}),"Identificando pea..."]}):n.jsxs("span",{className:"inline-flex items-center gap-2",children:[n.jsx(Wr,{className:"h-4 w-4"}),"Identificar e buscar"]})})]}),s===2&&n.jsxs("div",{className:"animate-fade-in space-y-6",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-green-500/10 flex items-center justify-center mx-auto mb-3",children:n.jsx(xn,{className:"h-6 w-6 text-green-600"})}),n.jsx("h3",{className:"font-serif text-xl mb-1",children:"Pea identificada!"}),n.jsx("p",{className:"text-sm text-muted-foreground font-light",children:"Selecione seu tamanho para ver as opes disponveis."})]}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-3 text-center",children:["Tamanhos letras ",n.jsx("span",{className:"text-accent",children:"(pode marcar mais de um)"})]}),n.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Epe.map($=>n.jsx("button",{onClick:()=>X($),className:`w-12 h-12 rounded-full border-2 font-medium text-sm transition-all duration-200 ${l.includes($)?"border-foreground bg-foreground text-background":"border-foreground/20 bg-card hover:border-foreground/40"}`,children:$},$))})]}),n.jsxs("div",{children:[n.jsxs("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-3 text-center",children:["Numerao ",n.jsx("span",{className:"text-accent",children:"(pode marcar mais de um)"})]}),n.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:kpe.map($=>n.jsx("button",{onClick:()=>H($),className:`w-12 h-12 rounded-full border-2 font-medium text-sm transition-all duration-200 ${h.includes($)?"border-foreground bg-foreground text-background":"border-foreground/20 bg-card hover:border-foreground/40"}`,children:$},$))})]}),q?n.jsx("div",{className:"border border-accent/30 rounded-xl p-3 text-center bg-accent/5",children:n.jsxs("p",{className:"text-sm",children:["Buscando tamanhos: ",n.jsx("span",{className:"font-medium text-accent",children:L})]})}):n.jsx("div",{className:"border border-foreground/10 rounded-xl p-3 text-center",children:n.jsx("p",{className:"text-sm text-muted-foreground font-light",children:"Selecione pelo menos um tamanho"})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>a(1),className:"px-6 py-3 border border-foreground/20 text-foreground text-xs tracking-[0.15em] uppercase font-medium transition-all duration-300 hover:border-foreground/40",children:"Voltar"}),n.jsx("button",{onClick:S,disabled:!q||b,className:"flex-1 px-6 py-3 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white disabled:opacity-50",children:b?n.jsxs("span",{className:"inline-flex items-center gap-2 justify-center",children:[n.jsx(At,{className:"h-4 w-4 animate-spin"}),"Buscando..."]}):"Buscar sugestes"})]})]}),s===3&&n.jsxs("div",{className:"animate-fade-in space-y-6",children:[n.jsxs("div",{className:"border border-foreground/10 rounded-xl p-4 bg-card/50",children:[n.jsx("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-1",children:"O que a IA identificou"}),n.jsxs("p",{className:"text-sm font-medium italic font-serif",children:['"',I(),'"']})]}),j&&j.outOfStockInSelectedSize&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"border border-amber-300/50 bg-amber-50/50 rounded-xl p-4",children:n.jsxs("p",{className:"text-sm text-foreground font-light",children:["Encontramos uma pea muito parecida, mas no seu tamanho ela est esgotada.",T.length>0&&n.jsxs("span",{className:"font-medium",children:[" ","Veja opes similares abaixo."]})]})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-2",children:"Pea identificada"}),n.jsx(C3,{product:j,onView:()=>e(`/produto/${j.id}`),onBuy:()=>e(`/produto/${j.id}`),outOfStock:!0})]})]}),(T.length>0||j&&!j.outOfStockInSelectedSize)&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"text-center border border-accent/20 bg-accent/5 rounded-xl p-4",children:[n.jsx(Wr,{className:"h-5 w-5 text-accent mx-auto mb-2"}),n.jsx("p",{className:"font-serif text-lg",children:j!=null&&j.outOfStockInSelectedSize?"Opes similares no seu tamanho":"Sugestes no seu tamanho"}),n.jsxs("p",{className:"text-[11px] text-muted-foreground mt-1 tracking-wide",children:[(j&&!j.outOfStockInSelectedSize?1:0)+T.length," ",(j&&!j.outOfStockInSelectedSize?1:0)+T.length===1?"opo encontrada":"opes encontradas"," ","com estoque em ",L]})]}),j&&!j.outOfStockInSelectedSize&&n.jsxs("div",{children:[n.jsxs("p",{className:"text-[10px] tracking-[0.15em] uppercase text-accent font-medium mb-2 flex items-center gap-1",children:[n.jsx(Wr,{className:"h-3 w-3"})," Pea mais provvel"]}),n.jsx(C3,{product:j,onView:()=>e(`/produto/${j.id}`),onBuy:()=>N(j)})]}),T.length>0&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"grid grid-cols-2 gap-3",children:T.slice(0,6).map($=>n.jsx(C3,{product:$,onView:()=>e(`/produto/${$.id}`),onBuy:()=>N($)},$.id))}),T.length>6&&n.jsx(Gt,{to:"/catalogo",children:n.jsx("button",{className:"w-full px-6 py-3 border border-foreground/20 text-foreground text-xs tracking-[0.15em] uppercase font-medium transition-all duration-300 hover:border-accent hover:text-accent",children:"Ver mais opes no catlogo"})})]}),n.jsxs("div",{className:"border-t border-foreground/8 pt-4",children:[n.jsx("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-3 text-center",children:"Refinar busca"}),n.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Ape.map(({mode:$,label:Y})=>n.jsx(Rpe,{label:Y,active:m===$,onClick:()=>E($),isLoading:b&&m===$},$))})]})]}),!j&&T.length===0&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"text-center border border-foreground/10 rounded-xl p-6",children:[n.jsx(Ut,{className:"h-8 w-8 text-muted-foreground mx-auto mb-3"}),n.jsx("p",{className:"font-serif text-lg mb-1",children:"Nenhuma pea encontrada"}),n.jsx("p",{className:"text-sm text-muted-foreground font-light",children:l.length>0&&h.length===0?"Tente selecionar tambm os tamanhos numricos (34-46).":h.length>0&&l.length===0?"Tente selecionar tambm os tamanhos letras (PP-GG).":"Me chama no WhatsApp que te ajudo a achar algo especial!"})]}),n.jsx("button",{onClick:()=>a(2),className:"w-full px-6 py-3 border border-foreground/20 text-foreground text-xs tracking-[0.15em] uppercase font-medium transition-all duration-300 hover:border-foreground/40",children:"Alterar tamanhos"}),n.jsx(Gt,{to:"/catalogo",children:n.jsx("button",{className:"w-full px-6 py-3 border border-foreground/20 text-foreground text-xs tracking-[0.15em] uppercase font-medium transition-all duration-300 hover:border-accent hover:text-accent",children:"Ver catlogo completo"})})]}),n.jsxs("a",{href:C(),target:"_blank",rel:"noopener noreferrer",className:`flex items-center justify-center gap-2 w-full font-medium py-3.5 px-4 rounded-xl text-xs tracking-wide uppercase transition-all duration-300 ${!j&&T.length===0?"bg-[#25D366] hover:bg-[#20BD5A] text-white":"border border-[#25D366]/40 text-[#25D366] hover:bg-[#25D366]/5"}`,children:[n.jsx(nn,{className:"h-4 w-4"}),"Falar no WhatsApp"]}),n.jsxs("button",{onClick:k,className:"w-full text-xs tracking-wide text-muted-foreground hover:text-foreground transition-colors py-2 inline-flex items-center justify-center gap-1.5",children:[n.jsx(en,{className:"h-3.5 w-3.5"}),"Buscar outra foto"]})]})]})}),n.jsx("section",{className:"py-14 md:py-20 px-5",children:n.jsx("div",{className:"max-w-4xl mx-auto text-center",children:n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-8",children:Ppe.map($=>n.jsxs("div",{className:"flex flex-col items-center gap-3 group",children:[n.jsx("div",{className:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm group-hover:shadow-md group-hover:border-accent/40 transition-all duration-300",children:n.jsx($.icon,{className:"h-6 w-6 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:$.label}),n.jsx("p",{className:"text-xs text-muted-foreground",children:$.desc})]})]},$.label))})})}),n.jsx("section",{className:"py-16 md:py-24 px-5 bg-secondary/30",children:n.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[n.jsx("div",{className:"w-px h-12 bg-accent/40 mx-auto mb-6"}),n.jsx("h2",{className:"font-serif text-3xl md:text-4xl mb-4 italic",children:"Pronta para se sentir incrvel?"}),n.jsx("p",{className:"text-muted-foreground font-light mb-8 max-w-md mx-auto",children:"Monte seu provador VIP em 2 minutos e receba sugestes personalizadas direto no seu WhatsApp."}),n.jsx(Gt,{to:"/meu-estilo",children:n.jsx("button",{className:"px-12 py-4 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white",children:"Quero meu provador VIP"})}),n.jsx("p",{className:"text-[11px] text-muted-foreground mt-6 tracking-wide",children:"Gratuito  Leva menos de 2 minutos"})]})}),n.jsx("footer",{className:"border-t border-border py-10 px-5",children:n.jsxs("div",{className:"max-w-5xl mx-auto",children:[n.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[n.jsxs("div",{className:"text-center md:text-left",children:[n.jsx("p",{className:"font-serif text-lg mb-1",children:"LE.PO"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Curadoria de moda feminina  Anpolis, GO"})]}),n.jsxs("div",{className:"flex items-center gap-5 text-sm text-muted-foreground",children:[n.jsx(Gt,{to:"/catalogo",className:"hover:text-foreground transition-colors",children:"Catlogo"}),n.jsx(Gt,{to:"/meu-estilo",className:"hover:text-foreground transition-colors",children:"Provador VIP"}),n.jsx(Gt,{to:"/enviar-print",className:"hover:text-foreground transition-colors",children:"Buscar por foto"}),n.jsx("a",{href:No("Ol! Gostaria de saber mais sobre a LE.PO "),target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors",children:"WhatsApp"})]})]}),n.jsxs("div",{className:"border-t border-border mt-6 pt-6 flex flex-col sm:flex-row items-center justify-between gap-2",children:[n.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",new Date().getFullYear()," LE.PO. Todos os direitos reservados."]}),n.jsx(Gt,{to:"/area-lojista",className:"text-[10px] text-muted-foreground/40 hover:text-muted-foreground transition-colors",children:"rea do Lojista"})]})]})})]})};function C3({product:e,onView:t,onBuy:r,outOfStock:s}){return n.jsxs(De,{className:`overflow-hidden border-foreground/10 ${s?"ring-1 ring-amber-300/50":""}`,children:[n.jsxs("div",{className:"w-full aspect-[3/4] bg-secondary/30 flex items-center justify-center cursor-pointer relative",onClick:t,children:[e.image_url?n.jsx("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-contain"}):n.jsx(Ut,{className:"h-8 w-8 text-muted-foreground"}),s?n.jsx(Ae,{className:"absolute top-2 left-2 bg-foreground/80 text-background text-[9px] px-1.5 py-0.5 tracking-wider",children:"Esgotado no seu tam"}):n.jsx(Ae,{className:"absolute top-2 left-2 bg-green-600/90 text-white text-[9px] px-1.5 py-0.5 tracking-wider",children:" No seu tamanho"})]}),n.jsxs(Be,{className:"p-3 space-y-2",children:[n.jsx("h4",{className:"text-sm font-medium line-clamp-2 min-h-[2.5rem]",children:e.name}),e.matchReasons.length>0&&n.jsxs("div",{className:"flex flex-wrap gap-1",children:[n.jsx("span",{className:"text-[9px] text-muted-foreground tracking-wide",children:"Parecido por:"}),e.matchReasons.slice(0,2).map(a=>n.jsx(Ae,{variant:"secondary",className:"text-[9px] px-1.5 py-0 tracking-wide",children:a},a))]}),n.jsx("p",{className:"font-semibold text-accent text-sm",children:Cpe(e.price)}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:t,className:"flex-1 text-[10px] tracking-wide uppercase py-2 border border-foreground/15 hover:border-foreground/30 transition-colors inline-flex items-center justify-center gap-1",children:[n.jsx(ci,{className:"h-3 w-3"}),"Ver"]}),s?n.jsxs("button",{onClick:t,className:"flex-1 text-[10px] tracking-wide uppercase py-2 bg-secondary text-foreground/70 inline-flex items-center justify-center gap-1",children:[n.jsx(ci,{className:"h-3 w-3"}),"Tamanhos"]}):n.jsxs("button",{onClick:r,className:"flex-1 text-[10px] tracking-wide uppercase py-2 bg-foreground text-background hover:bg-accent transition-colors inline-flex items-center justify-center gap-1",children:[n.jsx(ln,{className:"h-3 w-3"}),"Comprar"]})]})]})]})}function Rpe({label:e,active:t,onClick:r,isLoading:s}){return n.jsx("button",{onClick:r,disabled:s,className:`text-xs px-3 py-1.5 rounded-full border transition-all duration-200 tracking-wide ${t?"bg-foreground text-background border-foreground":"border-foreground/15 text-foreground/70 hover:border-foreground/30"} ${s?"opacity-50":""}`,children:s?n.jsx(At,{className:"h-3 w-3 animate-spin"}):e})}var Mpe="Label",Rq=P.forwardRef((e,t)=>n.jsx(er.label,{...e,ref:t,onMouseDown:r=>{var a;r.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Rq.displayName=Mpe;var Mq=Rq;const Ipe=pg("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Le=P.forwardRef(({className:e,...t},r)=>n.jsx(Mq,{ref:r,className:We(Ipe(),e),...t}));Le.displayName=Mq.displayName;var Tn;(function(e){e.assertEqual=a=>{};function t(a){}e.assertIs=t;function r(a){throw new Error}e.assertNever=r,e.arrayToEnum=a=>{const i={};for(const o of a)i[o]=o;return i},e.getValidEnumValues=a=>{const i=e.objectKeys(a).filter(c=>typeof a[a[c]]!="number"),o={};for(const c of i)o[c]=a[c];return e.objectValues(o)},e.objectValues=a=>e.objectKeys(a).map(function(i){return a[i]}),e.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.push(o);return i},e.find=(a,i)=>{for(const o of a)if(i(o))return o},e.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&Number.isFinite(a)&&Math.floor(a)===a;function s(a,i=" | "){return a.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}e.joinValues=s,e.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(Tn||(Tn={}));var OR;(function(e){e.mergeShapes=(t,r)=>({...t,...r})})(OR||(OR={}));const mr=Tn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Hd=e=>{switch(typeof e){case"undefined":return mr.undefined;case"string":return mr.string;case"number":return Number.isNaN(e)?mr.nan:mr.number;case"boolean":return mr.boolean;case"function":return mr.function;case"bigint":return mr.bigint;case"symbol":return mr.symbol;case"object":return Array.isArray(e)?mr.array:e===null?mr.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?mr.promise:typeof Map<"u"&&e instanceof Map?mr.map:typeof Set<"u"&&e instanceof Set?mr.set:typeof Date<"u"&&e instanceof Date?mr.date:mr.object;default:return mr.unknown}},Wt=Tn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class md extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=t}format(t){const r=t||function(i){return i.message},s={_errors:[]},a=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(a);else if(o.code==="invalid_return_type")a(o.returnTypeError);else if(o.code==="invalid_arguments")a(o.argumentsError);else if(o.path.length===0)s._errors.push(r(o));else{let c=s,d=0;for(;d<o.path.length;){const l=o.path[d];d===o.path.length-1?(c[l]=c[l]||{_errors:[]},c[l]._errors.push(r(o))):c[l]=c[l]||{_errors:[]},c=c[l],d++}}};return a(this),s}static assert(t){if(!(t instanceof md))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Tn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=r=>r.message){const r={},s=[];for(const a of this.issues)if(a.path.length>0){const i=a.path[0];r[i]=r[i]||[],r[i].push(t(a))}else s.push(t(a));return{formErrors:s,fieldErrors:r}}get formErrors(){return this.flatten()}}md.create=e=>new md(e);const EC=(e,t)=>{let r;switch(e.code){case Wt.invalid_type:e.received===mr.undefined?r="Required":r=`Expected ${e.expected}, received ${e.received}`;break;case Wt.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,Tn.jsonStringifyReplacer)}`;break;case Wt.unrecognized_keys:r=`Unrecognized key(s) in object: ${Tn.joinValues(e.keys,", ")}`;break;case Wt.invalid_union:r="Invalid input";break;case Wt.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Tn.joinValues(e.options)}`;break;case Wt.invalid_enum_value:r=`Invalid enum value. Expected ${Tn.joinValues(e.options)}, received '${e.received}'`;break;case Wt.invalid_arguments:r="Invalid function arguments";break;case Wt.invalid_return_type:r="Invalid function return type";break;case Wt.invalid_date:r="Invalid date";break;case Wt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:Tn.assertNever(e.validation):e.validation!=="regex"?r=`Invalid ${e.validation}`:r="Invalid";break;case Wt.too_small:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="bigint"?r=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:r="Invalid input";break;case Wt.too_big:e.type==="array"?r=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?r=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?r=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?r=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?r=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:r="Invalid input";break;case Wt.custom:r="Invalid input";break;case Wt.invalid_intersection_types:r="Intersection results could not be merged";break;case Wt.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case Wt.not_finite:r="Number must be finite";break;default:r=t.defaultError,Tn.assertNever(e)}return{message:r}};let Dpe=EC;function Lpe(){return Dpe}const Bpe=e=>{const{data:t,path:r,errorMaps:s,issueData:a}=e,i=[...r,...a.path||[]],o={...a,path:i};if(a.message!==void 0)return{...a,path:i,message:a.message};let c="";const d=s.filter(l=>!!l).slice().reverse();for(const l of d)c=l(o,{data:t,defaultError:c}).message;return{...a,path:i,message:c}};function ar(e,t){const r=Lpe(),s=Bpe({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,r,r===EC?void 0:EC].filter(a=>!!a)});e.common.issues.push(s)}class So{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,r){const s=[];for(const a of r){if(a.status==="aborted")return Vr;a.status==="dirty"&&t.dirty(),s.push(a.value)}return{status:t.value,value:s}}static async mergeObjectAsync(t,r){const s=[];for(const a of r){const i=await a.key,o=await a.value;s.push({key:i,value:o})}return So.mergeObjectSync(t,s)}static mergeObjectSync(t,r){const s={};for(const a of r){const{key:i,value:o}=a;if(i.status==="aborted"||o.status==="aborted")return Vr;i.status==="dirty"&&t.dirty(),o.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||a.alwaysSet)&&(s[i.value]=o.value)}return{status:t.value,value:s}}}const Vr=Object.freeze({status:"aborted"}),G0=e=>({status:"dirty",value:e}),tl=e=>({status:"valid",value:e}),RR=e=>e.status==="aborted",MR=e=>e.status==="dirty",jp=e=>e.status==="valid",Ow=e=>typeof Promise<"u"&&e instanceof Promise;var xr;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(xr||(xr={}));class Ou{constructor(t,r,s,a){this._cachedPath=[],this.parent=t,this.data=r,this._path=s,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const IR=(e,t)=>{if(jp(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new md(e.common.issues);return this._error=r,this._error}}};function on(e){if(!e)return{};const{errorMap:t,invalid_type_error:r,required_error:s,description:a}=e;if(t&&(r||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:a}:{errorMap:(o,c)=>{const{message:d}=e;return o.code==="invalid_enum_value"?{message:d??c.defaultError}:typeof c.data>"u"?{message:d??s??c.defaultError}:o.code!=="invalid_type"?{message:c.defaultError}:{message:d??r??c.defaultError}},description:a}}class En{get description(){return this._def.description}_getType(t){return Hd(t.data)}_getOrReturnCtx(t,r){return r||{common:t.parent.common,data:t.data,parsedType:Hd(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new So,ctx:{common:t.parent.common,data:t.data,parsedType:Hd(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const r=this._parse(t);if(Ow(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(t){const r=this._parse(t);return Promise.resolve(r)}parse(t,r){const s=this.safeParse(t,r);if(s.success)return s.data;throw s.error}safeParse(t,r){const s={common:{issues:[],async:(r==null?void 0:r.async)??!1,contextualErrorMap:r==null?void 0:r.errorMap},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Hd(t)},a=this._parseSync({data:t,path:s.path,parent:s});return IR(s,a)}"~validate"(t){var s,a;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Hd(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:r});return jp(i)?{value:i.value}:{issues:r.common.issues}}catch(i){(a=(s=i==null?void 0:i.message)==null?void 0:s.toLowerCase())!=null&&a.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:r}).then(i=>jp(i)?{value:i.value}:{issues:r.common.issues})}async parseAsync(t,r){const s=await this.safeParseAsync(t,r);if(s.success)return s.data;throw s.error}async safeParseAsync(t,r){const s={common:{issues:[],contextualErrorMap:r==null?void 0:r.errorMap,async:!0},path:(r==null?void 0:r.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:Hd(t)},a=this._parse({data:t,path:s.path,parent:s}),i=await(Ow(a)?a:Promise.resolve(a));return IR(s,i)}refine(t,r){const s=a=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(a):r;return this._refinement((a,i)=>{const o=t(a),c=()=>i.addIssue({code:Wt.custom,...s(a)});return typeof Promise<"u"&&o instanceof Promise?o.then(d=>d?!0:(c(),!1)):o?!0:(c(),!1)})}refinement(t,r){return this._refinement((s,a)=>t(s)?!0:(a.addIssue(typeof r=="function"?r(s,a):r),!1))}_refinement(t){return new Sp({schema:this,typeName:qr.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return _u.create(this,this._def)}nullable(){return Cp.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return hc.create(this)}promise(){return Dw.create(this,this._def)}or(t){return Mw.create([this,t],this._def)}and(t){return Iw.create(this,t,this._def)}transform(t){return new Sp({...on(this._def),schema:this,typeName:qr.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const r=typeof t=="function"?t:()=>t;return new AC({...on(this._def),innerType:this,defaultValue:r,typeName:qr.ZodDefault})}brand(){return new oge({typeName:qr.ZodBranded,type:this,...on(this._def)})}catch(t){const r=typeof t=="function"?t:()=>t;return new TC({...on(this._def),innerType:this,catchValue:r,typeName:qr.ZodCatch})}describe(t){const r=this.constructor;return new r({...this._def,description:t})}pipe(t){return Gk.create(this,t)}readonly(){return PC.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const $pe=/^c[^\s-]{8,}$/i,Fpe=/^[0-9a-z]+$/,zpe=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Upe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Vpe=/^[a-z0-9_-]{21}$/i,qpe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Wpe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Hpe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Gpe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let E3;const Kpe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Xpe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Ype=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,Zpe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Qpe=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Jpe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Iq="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ege=new RegExp(`^${Iq}$`);function Dq(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}function tge(e){return new RegExp(`^${Dq(e)}$`)}function rge(e){let t=`${Iq}T${Dq(e)}`;const r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,new RegExp(`^${t}$`)}function nge(e,t){return!!((t==="v4"||!t)&&Kpe.test(e)||(t==="v6"||!t)&&Ype.test(e))}function sge(e,t){if(!qpe.test(e))return!1;try{const[r]=e.split(".");if(!r)return!1;const s=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(s));return!(typeof a!="object"||a===null||"typ"in a&&(a==null?void 0:a.typ)!=="JWT"||!a.alg||t&&a.alg!==t)}catch{return!1}}function age(e,t){return!!((t==="v4"||!t)&&Xpe.test(e)||(t==="v6"||!t)&&Zpe.test(e))}class ou extends En{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==mr.string){const i=this._getOrReturnCtx(t);return ar(i,{code:Wt.invalid_type,expected:mr.string,received:i.parsedType}),Vr}const s=new So;let a;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(a=this._getOrReturnCtx(t,a),ar(a,{code:Wt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")t.data.length>i.value&&(a=this._getOrReturnCtx(t,a),ar(a,{code:Wt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){const o=t.data.length>i.value,c=t.data.length<i.value;(o||c)&&(a=this._getOrReturnCtx(t,a),o?ar(a,{code:Wt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):c&&ar(a,{code:Wt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")Hpe.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"email",code:Wt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")E3||(E3=new RegExp(Gpe,"u")),E3.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"emoji",code:Wt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")Upe.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"uuid",code:Wt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")Vpe.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"nanoid",code:Wt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")$pe.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"cuid",code:Wt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")Fpe.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"cuid2",code:Wt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")zpe.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"ulid",code:Wt.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{a=this._getOrReturnCtx(t,a),ar(a,{validation:"url",code:Wt.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"regex",code:Wt.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(t,a),ar(a,{code:Wt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(a=this._getOrReturnCtx(t,a),ar(a,{code:Wt.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(a=this._getOrReturnCtx(t,a),ar(a,{code:Wt.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?rge(i).test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{code:Wt.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?ege.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{code:Wt.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?tge(i).test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{code:Wt.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?Wpe.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"duration",code:Wt.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?nge(t.data,i.version)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"ip",code:Wt.invalid_string,message:i.message}),s.dirty()):i.kind==="jwt"?sge(t.data,i.alg)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"jwt",code:Wt.invalid_string,message:i.message}),s.dirty()):i.kind==="cidr"?age(t.data,i.version)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"cidr",code:Wt.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?Qpe.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"base64",code:Wt.invalid_string,message:i.message}),s.dirty()):i.kind==="base64url"?Jpe.test(t.data)||(a=this._getOrReturnCtx(t,a),ar(a,{validation:"base64url",code:Wt.invalid_string,message:i.message}),s.dirty()):Tn.assertNever(i);return{status:s.value,value:t.data}}_regex(t,r,s){return this.refinement(a=>t.test(a),{validation:r,code:Wt.invalid_string,...xr.errToObj(s)})}_addCheck(t){return new ou({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...xr.errToObj(t)})}url(t){return this._addCheck({kind:"url",...xr.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...xr.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...xr.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...xr.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...xr.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...xr.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...xr.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...xr.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...xr.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...xr.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...xr.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...xr.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...xr.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...xr.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...xr.errToObj(t)})}regex(t,r){return this._addCheck({kind:"regex",regex:t,...xr.errToObj(r)})}includes(t,r){return this._addCheck({kind:"includes",value:t,position:r==null?void 0:r.position,...xr.errToObj(r==null?void 0:r.message)})}startsWith(t,r){return this._addCheck({kind:"startsWith",value:t,...xr.errToObj(r)})}endsWith(t,r){return this._addCheck({kind:"endsWith",value:t,...xr.errToObj(r)})}min(t,r){return this._addCheck({kind:"min",value:t,...xr.errToObj(r)})}max(t,r){return this._addCheck({kind:"max",value:t,...xr.errToObj(r)})}length(t,r){return this._addCheck({kind:"length",value:t,...xr.errToObj(r)})}nonempty(t){return this.min(1,xr.errToObj(t))}trim(){return new ou({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ou({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ou({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxLength(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}ou.create=e=>new ou({checks:[],typeName:qr.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...on(e)});function ige(e,t){const r=(e.toString().split(".")[1]||"").length,s=(t.toString().split(".")[1]||"").length,a=r>s?r:s,i=Number.parseInt(e.toFixed(a).replace(".","")),o=Number.parseInt(t.toFixed(a).replace(".",""));return i%o/10**a}class dv extends En{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==mr.number){const i=this._getOrReturnCtx(t);return ar(i,{code:Wt.invalid_type,expected:mr.number,received:i.parsedType}),Vr}let s;const a=new So;for(const i of this._def.checks)i.kind==="int"?Tn.isInteger(t.data)||(s=this._getOrReturnCtx(t,s),ar(s,{code:Wt.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(s=this._getOrReturnCtx(t,s),ar(s,{code:Wt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(s=this._getOrReturnCtx(t,s),ar(s,{code:Wt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?ige(t.data,i.value)!==0&&(s=this._getOrReturnCtx(t,s),ar(s,{code:Wt.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(s=this._getOrReturnCtx(t,s),ar(s,{code:Wt.not_finite,message:i.message}),a.dirty()):Tn.assertNever(i);return{status:a.value,value:t.data}}gte(t,r){return this.setLimit("min",t,!0,xr.toString(r))}gt(t,r){return this.setLimit("min",t,!1,xr.toString(r))}lte(t,r){return this.setLimit("max",t,!0,xr.toString(r))}lt(t,r){return this.setLimit("max",t,!1,xr.toString(r))}setLimit(t,r,s,a){return new dv({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:s,message:xr.toString(a)}]})}_addCheck(t){return new dv({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:xr.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:xr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:xr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:xr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:xr.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:xr.toString(r)})}finite(t){return this._addCheck({kind:"finite",message:xr.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:xr.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:xr.toString(t)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&Tn.isInteger(t.value))}get isFinite(){let t=null,r=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(r===null||s.value>r)&&(r=s.value):s.kind==="max"&&(t===null||s.value<t)&&(t=s.value)}return Number.isFinite(r)&&Number.isFinite(t)}}dv.create=e=>new dv({checks:[],typeName:qr.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...on(e)});class uv extends En{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==mr.bigint)return this._getInvalidInput(t);let s;const a=new So;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(s=this._getOrReturnCtx(t,s),ar(s,{code:Wt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(s=this._getOrReturnCtx(t,s),ar(s,{code:Wt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(t,s),ar(s,{code:Wt.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):Tn.assertNever(i);return{status:a.value,value:t.data}}_getInvalidInput(t){const r=this._getOrReturnCtx(t);return ar(r,{code:Wt.invalid_type,expected:mr.bigint,received:r.parsedType}),Vr}gte(t,r){return this.setLimit("min",t,!0,xr.toString(r))}gt(t,r){return this.setLimit("min",t,!1,xr.toString(r))}lte(t,r){return this.setLimit("max",t,!0,xr.toString(r))}lt(t,r){return this.setLimit("max",t,!1,xr.toString(r))}setLimit(t,r,s,a){return new uv({...this._def,checks:[...this._def.checks,{kind:t,value:r,inclusive:s,message:xr.toString(a)}]})}_addCheck(t){return new uv({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:xr.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:xr.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:xr.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:xr.toString(t)})}multipleOf(t,r){return this._addCheck({kind:"multipleOf",value:t,message:xr.toString(r)})}get minValue(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t}get maxValue(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t}}uv.create=e=>new uv({checks:[],typeName:qr.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...on(e)});class DR extends En{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==mr.boolean){const s=this._getOrReturnCtx(t);return ar(s,{code:Wt.invalid_type,expected:mr.boolean,received:s.parsedType}),Vr}return tl(t.data)}}DR.create=e=>new DR({typeName:qr.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...on(e)});class Rw extends En{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==mr.date){const i=this._getOrReturnCtx(t);return ar(i,{code:Wt.invalid_type,expected:mr.date,received:i.parsedType}),Vr}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return ar(i,{code:Wt.invalid_date}),Vr}const s=new So;let a;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(a=this._getOrReturnCtx(t,a),ar(a,{code:Wt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(a=this._getOrReturnCtx(t,a),ar(a,{code:Wt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):Tn.assertNever(i);return{status:s.value,value:new Date(t.data.getTime())}}_addCheck(t){return new Rw({...this._def,checks:[...this._def.checks,t]})}min(t,r){return this._addCheck({kind:"min",value:t.getTime(),message:xr.toString(r)})}max(t,r){return this._addCheck({kind:"max",value:t.getTime(),message:xr.toString(r)})}get minDate(){let t=null;for(const r of this._def.checks)r.kind==="min"&&(t===null||r.value>t)&&(t=r.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const r of this._def.checks)r.kind==="max"&&(t===null||r.value<t)&&(t=r.value);return t!=null?new Date(t):null}}Rw.create=e=>new Rw({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:qr.ZodDate,...on(e)});class LR extends En{_parse(t){if(this._getType(t)!==mr.symbol){const s=this._getOrReturnCtx(t);return ar(s,{code:Wt.invalid_type,expected:mr.symbol,received:s.parsedType}),Vr}return tl(t.data)}}LR.create=e=>new LR({typeName:qr.ZodSymbol,...on(e)});class BR extends En{_parse(t){if(this._getType(t)!==mr.undefined){const s=this._getOrReturnCtx(t);return ar(s,{code:Wt.invalid_type,expected:mr.undefined,received:s.parsedType}),Vr}return tl(t.data)}}BR.create=e=>new BR({typeName:qr.ZodUndefined,...on(e)});class $R extends En{_parse(t){if(this._getType(t)!==mr.null){const s=this._getOrReturnCtx(t);return ar(s,{code:Wt.invalid_type,expected:mr.null,received:s.parsedType}),Vr}return tl(t.data)}}$R.create=e=>new $R({typeName:qr.ZodNull,...on(e)});class FR extends En{constructor(){super(...arguments),this._any=!0}_parse(t){return tl(t.data)}}FR.create=e=>new FR({typeName:qr.ZodAny,...on(e)});class zR extends En{constructor(){super(...arguments),this._unknown=!0}_parse(t){return tl(t.data)}}zR.create=e=>new zR({typeName:qr.ZodUnknown,...on(e)});class Ru extends En{_parse(t){const r=this._getOrReturnCtx(t);return ar(r,{code:Wt.invalid_type,expected:mr.never,received:r.parsedType}),Vr}}Ru.create=e=>new Ru({typeName:qr.ZodNever,...on(e)});class UR extends En{_parse(t){if(this._getType(t)!==mr.undefined){const s=this._getOrReturnCtx(t);return ar(s,{code:Wt.invalid_type,expected:mr.void,received:s.parsedType}),Vr}return tl(t.data)}}UR.create=e=>new UR({typeName:qr.ZodVoid,...on(e)});class hc extends En{_parse(t){const{ctx:r,status:s}=this._processInputParams(t),a=this._def;if(r.parsedType!==mr.array)return ar(r,{code:Wt.invalid_type,expected:mr.array,received:r.parsedType}),Vr;if(a.exactLength!==null){const o=r.data.length>a.exactLength.value,c=r.data.length<a.exactLength.value;(o||c)&&(ar(r,{code:o?Wt.too_big:Wt.too_small,minimum:c?a.exactLength.value:void 0,maximum:o?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),s.dirty())}if(a.minLength!==null&&r.data.length<a.minLength.value&&(ar(r,{code:Wt.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),s.dirty()),a.maxLength!==null&&r.data.length>a.maxLength.value&&(ar(r,{code:Wt.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),s.dirty()),r.common.async)return Promise.all([...r.data].map((o,c)=>a.type._parseAsync(new Ou(r,o,r.path,c)))).then(o=>So.mergeArray(s,o));const i=[...r.data].map((o,c)=>a.type._parseSync(new Ou(r,o,r.path,c)));return So.mergeArray(s,i)}get element(){return this._def.type}min(t,r){return new hc({...this._def,minLength:{value:t,message:xr.toString(r)}})}max(t,r){return new hc({...this._def,maxLength:{value:t,message:xr.toString(r)}})}length(t,r){return new hc({...this._def,exactLength:{value:t,message:xr.toString(r)}})}nonempty(t){return this.min(1,t)}}hc.create=(e,t)=>new hc({type:e,minLength:null,maxLength:null,exactLength:null,typeName:qr.ZodArray,...on(t)});function hm(e){if(e instanceof $s){const t={};for(const r in e.shape){const s=e.shape[r];t[r]=_u.create(hm(s))}return new $s({...e._def,shape:()=>t})}else return e instanceof hc?new hc({...e._def,type:hm(e.element)}):e instanceof _u?_u.create(hm(e.unwrap())):e instanceof Cp?Cp.create(hm(e.unwrap())):e instanceof hf?hf.create(e.items.map(t=>hm(t))):e}class $s extends En{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),r=Tn.objectKeys(t);return this._cached={shape:t,keys:r},this._cached}_parse(t){if(this._getType(t)!==mr.object){const l=this._getOrReturnCtx(t);return ar(l,{code:Wt.invalid_type,expected:mr.object,received:l.parsedType}),Vr}const{status:s,ctx:a}=this._processInputParams(t),{shape:i,keys:o}=this._getCached(),c=[];if(!(this._def.catchall instanceof Ru&&this._def.unknownKeys==="strip"))for(const l in a.data)o.includes(l)||c.push(l);const d=[];for(const l of o){const u=i[l],h=a.data[l];d.push({key:{status:"valid",value:l},value:u._parse(new Ou(a,h,a.path,l)),alwaysSet:l in a.data})}if(this._def.catchall instanceof Ru){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of c)d.push({key:{status:"valid",value:u},value:{status:"valid",value:a.data[u]}});else if(l==="strict")c.length>0&&(ar(a,{code:Wt.unrecognized_keys,keys:c}),s.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of c){const h=a.data[u];d.push({key:{status:"valid",value:u},value:l._parse(new Ou(a,h,a.path,u)),alwaysSet:u in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of d){const h=await u.key,f=await u.value;l.push({key:h,value:f,alwaysSet:u.alwaysSet})}return l}).then(l=>So.mergeObjectSync(s,l)):So.mergeObjectSync(s,d)}get shape(){return this._def.shape()}strict(t){return xr.errToObj,new $s({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(r,s)=>{var i,o;const a=((o=(i=this._def).errorMap)==null?void 0:o.call(i,r,s).message)??s.defaultError;return r.code==="unrecognized_keys"?{message:xr.errToObj(t).message??a}:{message:a}}}:{}})}strip(){return new $s({...this._def,unknownKeys:"strip"})}passthrough(){return new $s({...this._def,unknownKeys:"passthrough"})}extend(t){return new $s({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new $s({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:qr.ZodObject})}setKey(t,r){return this.augment({[t]:r})}catchall(t){return new $s({...this._def,catchall:t})}pick(t){const r={};for(const s of Tn.objectKeys(t))t[s]&&this.shape[s]&&(r[s]=this.shape[s]);return new $s({...this._def,shape:()=>r})}omit(t){const r={};for(const s of Tn.objectKeys(this.shape))t[s]||(r[s]=this.shape[s]);return new $s({...this._def,shape:()=>r})}deepPartial(){return hm(this)}partial(t){const r={};for(const s of Tn.objectKeys(this.shape)){const a=this.shape[s];t&&!t[s]?r[s]=a:r[s]=a.optional()}return new $s({...this._def,shape:()=>r})}required(t){const r={};for(const s of Tn.objectKeys(this.shape))if(t&&!t[s])r[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof _u;)i=i._def.innerType;r[s]=i}return new $s({...this._def,shape:()=>r})}keyof(){return Lq(Tn.objectKeys(this.shape))}}$s.create=(e,t)=>new $s({shape:()=>e,unknownKeys:"strip",catchall:Ru.create(),typeName:qr.ZodObject,...on(t)});$s.strictCreate=(e,t)=>new $s({shape:()=>e,unknownKeys:"strict",catchall:Ru.create(),typeName:qr.ZodObject,...on(t)});$s.lazycreate=(e,t)=>new $s({shape:e,unknownKeys:"strip",catchall:Ru.create(),typeName:qr.ZodObject,...on(t)});class Mw extends En{_parse(t){const{ctx:r}=this._processInputParams(t),s=this._def.options;function a(i){for(const c of i)if(c.result.status==="valid")return c.result;for(const c of i)if(c.result.status==="dirty")return r.common.issues.push(...c.ctx.common.issues),c.result;const o=i.map(c=>new md(c.ctx.common.issues));return ar(r,{code:Wt.invalid_union,unionErrors:o}),Vr}if(r.common.async)return Promise.all(s.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(a);{let i;const o=[];for(const d of s){const l={...r,common:{...r.common,issues:[]},parent:null},u=d._parseSync({data:r.data,path:r.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const c=o.map(d=>new md(d));return ar(r,{code:Wt.invalid_union,unionErrors:c}),Vr}}get options(){return this._def.options}}Mw.create=(e,t)=>new Mw({options:e,typeName:qr.ZodUnion,...on(t)});function kC(e,t){const r=Hd(e),s=Hd(t);if(e===t)return{valid:!0,data:e};if(r===mr.object&&s===mr.object){const a=Tn.objectKeys(t),i=Tn.objectKeys(e).filter(c=>a.indexOf(c)!==-1),o={...e,...t};for(const c of i){const d=kC(e[c],t[c]);if(!d.valid)return{valid:!1};o[c]=d.data}return{valid:!0,data:o}}else if(r===mr.array&&s===mr.array){if(e.length!==t.length)return{valid:!1};const a=[];for(let i=0;i<e.length;i++){const o=e[i],c=t[i],d=kC(o,c);if(!d.valid)return{valid:!1};a.push(d.data)}return{valid:!0,data:a}}else return r===mr.date&&s===mr.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class Iw extends En{_parse(t){const{status:r,ctx:s}=this._processInputParams(t),a=(i,o)=>{if(RR(i)||RR(o))return Vr;const c=kC(i.value,o.value);return c.valid?((MR(i)||MR(o))&&r.dirty(),{status:r.value,value:c.data}):(ar(s,{code:Wt.invalid_intersection_types}),Vr)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,o])=>a(i,o)):a(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}Iw.create=(e,t,r)=>new Iw({left:e,right:t,typeName:qr.ZodIntersection,...on(r)});class hf extends En{_parse(t){const{status:r,ctx:s}=this._processInputParams(t);if(s.parsedType!==mr.array)return ar(s,{code:Wt.invalid_type,expected:mr.array,received:s.parsedType}),Vr;if(s.data.length<this._def.items.length)return ar(s,{code:Wt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Vr;!this._def.rest&&s.data.length>this._def.items.length&&(ar(s,{code:Wt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...s.data].map((o,c)=>{const d=this._def.items[c]||this._def.rest;return d?d._parse(new Ou(s,o,s.path,c)):null}).filter(o=>!!o);return s.common.async?Promise.all(i).then(o=>So.mergeArray(r,o)):So.mergeArray(r,i)}get items(){return this._def.items}rest(t){return new hf({...this._def,rest:t})}}hf.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new hf({items:e,typeName:qr.ZodTuple,rest:null,...on(t)})};class VR extends En{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:r,ctx:s}=this._processInputParams(t);if(s.parsedType!==mr.map)return ar(s,{code:Wt.invalid_type,expected:mr.map,received:s.parsedType}),Vr;const a=this._def.keyType,i=this._def.valueType,o=[...s.data.entries()].map(([c,d],l)=>({key:a._parse(new Ou(s,c,s.path,[l,"key"])),value:i._parse(new Ou(s,d,s.path,[l,"value"]))}));if(s.common.async){const c=new Map;return Promise.resolve().then(async()=>{for(const d of o){const l=await d.key,u=await d.value;if(l.status==="aborted"||u.status==="aborted")return Vr;(l.status==="dirty"||u.status==="dirty")&&r.dirty(),c.set(l.value,u.value)}return{status:r.value,value:c}})}else{const c=new Map;for(const d of o){const l=d.key,u=d.value;if(l.status==="aborted"||u.status==="aborted")return Vr;(l.status==="dirty"||u.status==="dirty")&&r.dirty(),c.set(l.value,u.value)}return{status:r.value,value:c}}}}VR.create=(e,t,r)=>new VR({valueType:t,keyType:e,typeName:qr.ZodMap,...on(r)});class hv extends En{_parse(t){const{status:r,ctx:s}=this._processInputParams(t);if(s.parsedType!==mr.set)return ar(s,{code:Wt.invalid_type,expected:mr.set,received:s.parsedType}),Vr;const a=this._def;a.minSize!==null&&s.data.size<a.minSize.value&&(ar(s,{code:Wt.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),r.dirty()),a.maxSize!==null&&s.data.size>a.maxSize.value&&(ar(s,{code:Wt.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),r.dirty());const i=this._def.valueType;function o(d){const l=new Set;for(const u of d){if(u.status==="aborted")return Vr;u.status==="dirty"&&r.dirty(),l.add(u.value)}return{status:r.value,value:l}}const c=[...s.data.values()].map((d,l)=>i._parse(new Ou(s,d,s.path,l)));return s.common.async?Promise.all(c).then(d=>o(d)):o(c)}min(t,r){return new hv({...this._def,minSize:{value:t,message:xr.toString(r)}})}max(t,r){return new hv({...this._def,maxSize:{value:t,message:xr.toString(r)}})}size(t,r){return this.min(t,r).max(t,r)}nonempty(t){return this.min(1,t)}}hv.create=(e,t)=>new hv({valueType:e,minSize:null,maxSize:null,typeName:qr.ZodSet,...on(t)});class qR extends En{get schema(){return this._def.getter()}_parse(t){const{ctx:r}=this._processInputParams(t);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}qR.create=(e,t)=>new qR({getter:e,typeName:qr.ZodLazy,...on(t)});class WR extends En{_parse(t){if(t.data!==this._def.value){const r=this._getOrReturnCtx(t);return ar(r,{received:r.data,code:Wt.invalid_literal,expected:this._def.value}),Vr}return{status:"valid",value:t.data}}get value(){return this._def.value}}WR.create=(e,t)=>new WR({value:e,typeName:qr.ZodLiteral,...on(t)});function Lq(e,t){return new Np({values:e,typeName:qr.ZodEnum,...on(t)})}class Np extends En{_parse(t){if(typeof t.data!="string"){const r=this._getOrReturnCtx(t),s=this._def.values;return ar(r,{expected:Tn.joinValues(s),received:r.parsedType,code:Wt.invalid_type}),Vr}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const r=this._getOrReturnCtx(t),s=this._def.values;return ar(r,{received:r.data,code:Wt.invalid_enum_value,options:s}),Vr}return tl(t.data)}get options(){return this._def.values}get enum(){const t={};for(const r of this._def.values)t[r]=r;return t}get Values(){const t={};for(const r of this._def.values)t[r]=r;return t}get Enum(){const t={};for(const r of this._def.values)t[r]=r;return t}extract(t,r=this._def){return Np.create(t,{...this._def,...r})}exclude(t,r=this._def){return Np.create(this.options.filter(s=>!t.includes(s)),{...this._def,...r})}}Np.create=Lq;class HR extends En{_parse(t){const r=Tn.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(t);if(s.parsedType!==mr.string&&s.parsedType!==mr.number){const a=Tn.objectValues(r);return ar(s,{expected:Tn.joinValues(a),received:s.parsedType,code:Wt.invalid_type}),Vr}if(this._cache||(this._cache=new Set(Tn.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const a=Tn.objectValues(r);return ar(s,{received:s.data,code:Wt.invalid_enum_value,options:a}),Vr}return tl(t.data)}get enum(){return this._def.values}}HR.create=(e,t)=>new HR({values:e,typeName:qr.ZodNativeEnum,...on(t)});class Dw extends En{unwrap(){return this._def.type}_parse(t){const{ctx:r}=this._processInputParams(t);if(r.parsedType!==mr.promise&&r.common.async===!1)return ar(r,{code:Wt.invalid_type,expected:mr.promise,received:r.parsedType}),Vr;const s=r.parsedType===mr.promise?r.data:Promise.resolve(r.data);return tl(s.then(a=>this._def.type.parseAsync(a,{path:r.path,errorMap:r.common.contextualErrorMap})))}}Dw.create=(e,t)=>new Dw({type:e,typeName:qr.ZodPromise,...on(t)});class Sp extends En{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===qr.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:r,ctx:s}=this._processInputParams(t),a=this._def.effect||null,i={addIssue:o=>{ar(s,o),o.fatal?r.abort():r.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="preprocess"){const o=a.transform(s.data,i);if(s.common.async)return Promise.resolve(o).then(async c=>{if(r.value==="aborted")return Vr;const d=await this._def.schema._parseAsync({data:c,path:s.path,parent:s});return d.status==="aborted"?Vr:d.status==="dirty"||r.value==="dirty"?G0(d.value):d});{if(r.value==="aborted")return Vr;const c=this._def.schema._parseSync({data:o,path:s.path,parent:s});return c.status==="aborted"?Vr:c.status==="dirty"||r.value==="dirty"?G0(c.value):c}}if(a.type==="refinement"){const o=c=>{const d=a.refinement(c,i);if(s.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return c};if(s.common.async===!1){const c=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return c.status==="aborted"?Vr:(c.status==="dirty"&&r.dirty(),o(c.value),{status:r.value,value:c.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(c=>c.status==="aborted"?Vr:(c.status==="dirty"&&r.dirty(),o(c.value).then(()=>({status:r.value,value:c.value}))))}if(a.type==="transform")if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!jp(o))return Vr;const c=a.transform(o.value,i);if(c instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:c}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>jp(o)?Promise.resolve(a.transform(o.value,i)).then(c=>({status:r.value,value:c})):Vr);Tn.assertNever(a)}}Sp.create=(e,t,r)=>new Sp({schema:e,typeName:qr.ZodEffects,effect:t,...on(r)});Sp.createWithPreprocess=(e,t,r)=>new Sp({schema:t,effect:{type:"preprocess",transform:e},typeName:qr.ZodEffects,...on(r)});class _u extends En{_parse(t){return this._getType(t)===mr.undefined?tl(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}_u.create=(e,t)=>new _u({innerType:e,typeName:qr.ZodOptional,...on(t)});class Cp extends En{_parse(t){return this._getType(t)===mr.null?tl(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Cp.create=(e,t)=>new Cp({innerType:e,typeName:qr.ZodNullable,...on(t)});class AC extends En{_parse(t){const{ctx:r}=this._processInputParams(t);let s=r.data;return r.parsedType===mr.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}AC.create=(e,t)=>new AC({innerType:e,typeName:qr.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...on(t)});class TC extends En{_parse(t){const{ctx:r}=this._processInputParams(t),s={...r,common:{...r.common,issues:[]}},a=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Ow(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new md(s.common.issues)},input:s.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new md(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}TC.create=(e,t)=>new TC({innerType:e,typeName:qr.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...on(t)});class GR extends En{_parse(t){if(this._getType(t)!==mr.nan){const s=this._getOrReturnCtx(t);return ar(s,{code:Wt.invalid_type,expected:mr.nan,received:s.parsedType}),Vr}return{status:"valid",value:t.data}}}GR.create=e=>new GR({typeName:qr.ZodNaN,...on(e)});class oge extends En{_parse(t){const{ctx:r}=this._processInputParams(t),s=r.data;return this._def.type._parse({data:s,path:r.path,parent:r})}unwrap(){return this._def.type}}class Gk extends En{_parse(t){const{status:r,ctx:s}=this._processInputParams(t);if(s.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?Vr:i.status==="dirty"?(r.dirty(),G0(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{const a=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return a.status==="aborted"?Vr:a.status==="dirty"?(r.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:s.path,parent:s})}}static create(t,r){return new Gk({in:t,out:r,typeName:qr.ZodPipeline})}}class PC extends En{_parse(t){const r=this._def.innerType._parse(t),s=a=>(jp(a)&&(a.value=Object.freeze(a.value)),a);return Ow(r)?r.then(a=>s(a)):s(r)}unwrap(){return this._def.innerType}}PC.create=(e,t)=>new PC({innerType:e,typeName:qr.ZodReadonly,...on(t)});$s.lazycreate;var qr;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(qr||(qr={}));const Vi=ou.create;Ru.create;hc.create;const Sg=$s.create;$s.strictCreate;Mw.create;Iw.create;hf.create;Np.create;Dw.create;_u.create;Cp.create;const lge=Sg({email:Vi().email("Email invlido"),password:Vi().min(6,"Senha deve ter no mnimo 6 caracteres")}),KR=()=>{const e=fr(),{user:t,isMerchant:r,isLoading:s}=Hn(),[a,i]=P.useState(""),[o,c]=P.useState(""),[d,l]=P.useState(!1),[u,h]=P.useState(!1);P.useEffect(()=>{!s&&t&&r()&&e("/dashboard")},[t,s,r,e]);const f=async m=>{var g;m.preventDefault();const p=lge.safeParse({email:a,password:o});if(!p.success){de.error(p.error.errors[0].message);return}h(!0);try{const{error:v}=await ce.auth.signInWithPassword({email:a,password:o});if(v)throw v;const{data:x}=await ce.from("user_roles").select("role").eq("user_id",(g=(await ce.auth.getUser()).data.user)==null?void 0:g.id);if(!(x==null?void 0:x.some(b=>b.role==="merchant"||b.role==="admin"))){await ce.auth.signOut(),de.error("Acesso restrito. Esta rea  apenas para lojistas autorizados.");return}de.success("Bem-vinda de volta!"),e("/dashboard")}catch(v){console.error("Auth error:",v),v.message.includes("Invalid login")?de.error("Email ou senha incorretos."):de.error(v.message||"Erro ao autenticar. Tente novamente.")}finally{h(!1)}};return s?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center px-4",children:n.jsxs("div",{className:"w-full max-w-sm",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"rea do Lojista"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Acesso restrito a lojistas autorizados"})]}),n.jsxs("form",{onSubmit:f,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"email",children:"Email"}),n.jsx(Qe,{id:"email",type:"email",placeholder:"seu@email.com",value:a,onChange:m=>i(m.target.value),required:!0})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"password",children:"Senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(Qe,{id:"password",type:d?"text":"password",placeholder:"",value:o,onChange:m=>c(m.target.value),required:!0}),n.jsx("button",{type:"button",onClick:()=>l(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:d?n.jsx(dc,{className:"h-4 w-4"}):n.jsx(ci,{className:"h-4 w-4"})})]})]}),n.jsx(he,{type:"submit",className:"w-full",disabled:u,children:u?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),"Entrando..."]}):"Entrar"})]}),n.jsx("p",{className:"mt-6 text-center text-xs text-muted-foreground",children:"Cadastro de lojistas apenas por convite."})]})})};var cge="Separator",XR="horizontal",dge=["horizontal","vertical"],Bq=P.forwardRef((e,t)=>{const{decorative:r,orientation:s=XR,...a}=e,i=uge(s)?s:XR,c=r?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return n.jsx(er.div,{"data-orientation":i,...c,...a,ref:t})});Bq.displayName=cge;function uge(e){return dge.includes(e)}var $q=Bq;const Ta=P.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...s},a)=>n.jsx($q,{ref:a,decorative:r,orientation:t,className:We("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...s}));Ta.displayName=$q.displayName;var hge="authorization_response",fge="/~oauth/initiate",mge=["https://oauth.lovable.app"];function pge(e){let t;const r=new Promise(i=>{t=i}),s=i=>{if(!e.some(d=>i.origin===d))return;const c=i.data;!c||typeof c!="object"||c.type===hge&&t(c.response)},a=()=>{window.removeEventListener("message",s)};return window.addEventListener("message",s),{cleanup:a,messagePromise:r}}function gge(e){const t=window.screenX!==0||window.screenY!==0||!e,r=t?window.outerWidth*.5:window.screen.width*.5,s=t?window.outerHeight*.5:window.screen.height*.5,a=t?window.screenX+(window.outerWidth-r)/2:(window.screen.width-r)/2,i=t?window.screenY+(window.outerHeight-s)/2:(window.screen.height-s)/2;return{width:r,height:s,left:a,top:i}}function xge(){return typeof crypto<"u"&&crypto.getRandomValues?[...crypto.getRandomValues(new Uint8Array(16))].map(e=>e.toString(16).padStart(2,"0")).join(""):Math.random().toString(36).substring(2)+Date.now().toString(36)}function vge(e={}){const t=e.oauthBrokerUrl??fge,r=e.supportedOAuthOrigins??mge;async function s(a,i={}){let o=!1;try{o=window.self!==window.top}catch{o=!0}const c=xge(),d=i.redirect_uri??window.location.origin,l=new URLSearchParams({provider:a,redirect_uri:d,state:c,...i.extraParams});if(!o)return window.location.href=`${t}?${l.toString()}`,{error:null,redirected:!0};l.set("response_mode","web_message");const u=`${t}?${l.toString()}`,{messagePromise:h,cleanup:f}=pge(r),m=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent);let p;if(m)p=window.open(u,"_blank");else{const{width:x,height:y,left:b,top:j}=gge(o);p=window.open(u,"oauth",`width=${x},height=${y},left=${b},top=${j}`)}if(!p)return f(),{error:new Error("Popup was blocked")};let g;const v=new Promise((x,y)=>{g=setInterval(()=>{p.closed&&(clearInterval(g),y(new Error("Sign in was cancelled")))},500)});try{const x=await Promise.race([h,v]);return x.error?x.error==="legacy_flow"?{error:new Error("This flow is not supported in Preview mode. Please open the app in a new tab to sign in.")}:{error:new Error(x.error_description??"Sign in failed")}:x.state!==c?{error:new Error("State is invalid")}:!x.access_token||!x.refresh_token?{error:new Error("No tokens received")}:{tokens:{access_token:x.access_token,refresh_token:x.refresh_token},error:null}}catch(x){return{error:x instanceof Error?x:new Error(String(x))}}finally{clearInterval(g),f(),p==null||p.close()}}return{signInWithOAuth:s}}function yge(e){return vge(e)}const bge=yge({}),Fq={auth:{signInWithOAuth:async(e,t)=>{const r=await bge.signInWithOAuth(e,{redirect_uri:t==null?void 0:t.redirect_uri,extraParams:{...t==null?void 0:t.extraParams}});if(r.redirected||r.error)return r;try{await ce.auth.setSession(r.tokens)}catch(s){return{error:s instanceof Error?s:new Error(String(s))}}return r}}};function Ib(e){const t=e.replace(/\D/g,""),r=t.startsWith("55")&&t.length>11?t.slice(2):t;return r.length===0?"":r.length<=2?`(${r}`:r.length<=7?`(${r.slice(0,2)}) ${r.slice(2)}`:`(${r.slice(0,2)}) ${r.slice(2,7)}-${r.slice(7,11)}`}function wge(e){const t=e.replace(/\D/g,"");return t.startsWith("55")&&t.length===13||t.startsWith("55")&&t.length===12?t:t.length===11?`55${t}`:t.length===10?`55${t}`:t.startsWith("55")?t:`55${t}`}function k3(e){const t=e.replace(/\D/g,"");return(t.startsWith("55")?t.slice(2):t).length===11}function Kk(e=""){const[t,r]=P.useState(()=>Ib(e)),[s,a]=P.useState(()=>e?k3(e):!0),[i,o]=P.useState(!1),c=P.useCallback(h=>{const f=h.target.value,m=Ib(f);r(m);const p=f.replace(/\D/g,"");p.length>0?a(k3(p)):a(!0)},[]),d=P.useCallback(()=>{o(!0)},[]),l=P.useCallback(()=>wge(t),[t]),u=i&&t.length>0&&!s;return{displayValue:t,setDisplayValue:h=>{r(Ib(h)),a(k3(h))},isValid:s,hasError:u,handleChange:c,handleBlur:d,getNormalizedValue:l}}const _ge=Sg({email:Vi().email("Email invlido"),password:Vi().min(6,"Senha deve ter no mnimo 6 caracteres")}),jge=Sg({name:Vi().min(2,"Nome deve ter no mnimo 2 caracteres"),email:Vi().email("Email invlido"),password:Vi().min(6,"Senha deve ter no mnimo 6 caracteres"),whatsapp:Vi().min(14,"WhatsApp invlido")}),Nge=()=>{const e=fr(),t=Ec(),{user:r,isLoading:s}=Hn(),[a,i]=P.useState(!1),[o,c]=P.useState(""),[d,l]=P.useState(""),[u,h]=P.useState(""),[f,m]=P.useState(""),[p,g]=P.useState(!1),[v,x]=P.useState(!1),[y,b]=P.useState(!1),{displayValue:j,handleChange:T,getNormalizedValue:O,isValid:R}=Kk(""),D=new URLSearchParams(t.search),L=t.state,q=D.get("redirect")||(L==null?void 0:L.returnTo)||(L==null?void 0:L.redirectTo)||(L==null?void 0:L.from)||"/",X=L==null?void 0:L.message;P.useEffect(()=>{!s&&r&&e(q,{replace:!0})},[r,s,e,q]);const H=async S=>{S.preventDefault();const E=_ge.safeParse({email:o,password:d});if(!E.success){de.error(E.error.errors[0].message);return}x(!0);try{const{error:N}=await ce.auth.signInWithPassword({email:o,password:d});if(N)throw N;de.success("Bem-vinda de volta! "),e(q,{replace:!0})}catch(N){console.error("Auth error:",N),N.message.includes("Invalid login")?de.error("Email ou senha incorretos."):de.error(N.message||"Erro ao entrar. Tente novamente.")}finally{x(!1)}},M=async S=>{S.preventDefault();const E=jge.safeParse({name:u,email:o,password:d,whatsapp:j});if(!E.success||!R){de.error(R?E.error.errors[0].message:"WhatsApp invlido"),de.error(E.error.errors[0].message);return}x(!0);try{const N=`${window.location.origin}${q}`,C=O(),k=f.replace(/@/g,"").replace(/\s/g,"").toLowerCase().trim()||null,{data:I,error:U}=await ce.auth.signUp({email:o,password:d,options:{emailRedirectTo:N,data:{name:u,whatsapp:C,instagram_handle:k}}});if(U)throw U;if(I.user){const{error:$}=await ce.from("profiles").update({name:u,whatsapp:C,instagram_handle:k}).eq("user_id",I.user.id);$&&console.error("Profile update error:",$)}de.success("Conta criada com sucesso! "),e(q,{replace:!0})}catch(N){console.error("Signup error:",N),N.message.includes("already registered")?(de.error("Este email j est cadastrado. Faa login."),i(!1)):de.error(N.message||"Erro ao criar conta. Tente novamente.")}finally{x(!1)}},F=async()=>{b(!0);try{sessionStorage.setItem("oauth_return_to",q);const{error:S}=await Fq.auth.signInWithOAuth("google",{redirect_uri:window.location.origin});if(S)throw S}catch(S){console.error("Google auth error:",S),de.error("Erro ao entrar com Google. Tente novamente."),b(!1)}};return s?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-md",children:[n.jsxs(Gt,{to:"/",className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-6",children:[n.jsx(vs,{className:"h-4 w-4"}),"Voltar"]}),n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-accent/10 mb-4",children:n.jsx(Wr,{className:"h-8 w-8 text-accent"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:a?"Criar sua conta":"Entrar"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:X||(a?"Crie sua conta para fazer o quiz e receber looks personalizados":"Entre para acessar seus looks e pedidos")})]}),X&&n.jsx("div",{className:"mb-6 p-4 bg-accent/10 rounded-xl border border-accent/30 text-center",children:n.jsx("p",{className:"text-sm",children:" Ao entrar, voc ter acesso ao seu perfil de estilo e sugestes personalizadas!"})}),n.jsxs("form",{onSubmit:a?M:H,className:"space-y-4",children:[a&&n.jsxs("div",{className:"animate-slide-in-up",children:[n.jsx(Le,{htmlFor:"name",children:"Seu nome"}),n.jsx(Qe,{id:"name",type:"text",placeholder:"Como podemos te chamar?",value:u,onChange:S=>h(S.target.value),required:!0})]}),n.jsxs("div",{className:a?"animate-slide-in-up":"",style:a?{animationDelay:"50ms"}:{},children:[n.jsx(Le,{htmlFor:"email",children:"Email"}),n.jsx(Qe,{id:"email",type:"email",placeholder:"seu@email.com",value:o,onChange:S=>c(S.target.value),required:!0})]}),a&&n.jsxs("div",{className:"animate-slide-in-up",style:{animationDelay:"100ms"},children:[n.jsx(Le,{htmlFor:"whatsapp",children:"WhatsApp"}),n.jsx(Qe,{id:"whatsapp",type:"tel",placeholder:"(62) 99999-9999",value:j,onChange:T,required:!0}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Usaremos para enviar novidades e looks no seu tamanho"})]}),a&&n.jsxs("div",{className:"animate-slide-in-up",style:{animationDelay:"120ms"},children:[n.jsx(Le,{htmlFor:"instagram",children:"Instagram (opcional)"}),n.jsx(Qe,{id:"instagram",type:"text",placeholder:"@seuinstagram",value:f,onChange:S=>m(S.target.value)}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Se voc compra nas nossas lives, coloque seu @ para ver seus pedidos aqui"})]}),n.jsxs("div",{className:a?"animate-slide-in-up":"",style:a?{animationDelay:"150ms"}:{},children:[n.jsx(Le,{htmlFor:"password",children:"Senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(Qe,{id:"password",type:p?"text":"password",placeholder:"",value:d,onChange:S=>l(S.target.value),required:!0}),n.jsx("button",{type:"button",onClick:()=>g(!p),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:p?n.jsx(dc,{className:"h-4 w-4"}):n.jsx(ci,{className:"h-4 w-4"})})]}),!a&&n.jsx("div",{className:"mt-1 text-right",children:n.jsx(Gt,{to:"/esqueci-senha",className:"text-xs text-muted-foreground hover:text-accent transition-colors",children:"Esqueci minha senha"})})]}),n.jsx(he,{type:"submit",className:"w-full gap-2 transition-all hover:scale-[1.02]",disabled:v,children:v?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 animate-spin"}),a?"Criando conta...":"Entrando..."]}):a?n.jsxs(n.Fragment,{children:[n.jsx(Wr,{className:"h-4 w-4"}),"Criar conta"]}):"Entrar"})]}),n.jsxs("div",{className:"relative my-6",children:[n.jsx(Ta,{}),n.jsx("span",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-background px-3 text-xs text-muted-foreground",children:"ou continue com"})]}),n.jsxs(he,{type:"button",variant:"outline",className:"w-full gap-2",onClick:F,disabled:y||v,children:[y?n.jsx(At,{className:"h-4 w-4 animate-spin"}):n.jsxs("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",children:[n.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),n.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),n.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),n.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Google"]}),n.jsx("div",{className:"mt-6 text-center",children:n.jsx("button",{type:"button",onClick:()=>i(!a),className:"text-sm text-accent hover:underline",children:a?"J tem uma conta? Fazer login":"No tem conta? Criar agora"})}),q.includes("quiz")&&n.jsxs("div",{className:"mt-8 p-4 bg-accent/10 rounded-xl border border-accent/30 text-center",children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Ao criar sua conta, voc ter acesso a:"}),n.jsxs("ul",{className:"mt-2 text-sm space-y-1",children:[n.jsx("li",{children:" Looks personalizados no seu tamanho"}),n.jsx("li",{children:" Histrico de pedidos"}),n.jsx("li",{children:" Sugestes exclusivas"})]})]})]})]})};function Sge(){const e=fr();return P.useEffect(()=>{(async()=>{try{const{error:r}=await ce.auth.exchangeCodeForSession(window.location.href);if(r){console.error("OAuth callback error:",r),e("/entrar",{replace:!0});return}const s=sessionStorage.getItem("oauth_return_to");sessionStorage.removeItem("oauth_return_to"),e(s||"/minha-conta",{replace:!0})}catch(r){console.error("OAuth callback exception:",r),e("/entrar",{replace:!0})}})()},[e]),n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center space-y-4",children:[n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground mx-auto"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Finalizando login..."})]})})}const Cge=()=>{const t=No("Oi! Esqueci minha senha do Provador VIP e preciso recuperar meu acesso ");return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-md",children:[n.jsxs(Gt,{to:"/entrar",className:"inline-flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground mb-6",children:[n.jsx(vs,{className:"h-4 w-4"}),"Voltar para login"]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-accent/10 mb-4",children:n.jsx(El,{className:"h-8 w-8 text-accent"})}),n.jsx("h1",{className:"font-serif text-2xl mb-4",children:"Esqueceu sua senha?"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-2",children:"No se preocupe "}),n.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:"Para sua segurana, a recuperao de acesso ao Provador VIP  feita com nosso time pelo WhatsApp."}),n.jsx("p",{className:"text-muted-foreground text-sm mb-8",children:"Assim garantimos um atendimento rpido e personalizado pra voc voltar a usar seu provador sem dor de cabea "}),n.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"block",children:n.jsxs(he,{className:"w-full gap-2 bg-[#25D366] hover:bg-[#20BD5A] text-white rounded-xl py-6 text-base font-medium",size:"lg",children:[n.jsx(nn,{className:"h-5 w-5"}),"Recuperar acesso no WhatsApp"]})}),n.jsxs("p",{className:"mt-8 text-center text-xs text-muted-foreground",children:["Lembrou sua senha?"," ",n.jsx(Gt,{to:"/entrar",className:"text-accent hover:underline",children:"Fazer login"})]})]})]})]})},Ege=Sg({password:Vi().min(6,"Senha deve ter no mnimo 6 caracteres"),confirmPassword:Vi().min(6,"Confirmao deve ter no mnimo 6 caracteres")}).refine(e=>e.password===e.confirmPassword,{message:"As senhas no conferem",path:["confirmPassword"]}),kge=()=>{const e=fr(),[t,r]=P.useState(""),[s,a]=P.useState(""),[i,o]=P.useState(!1),[c,d]=P.useState(!1),[l,u]=P.useState(!1),[h,f]=P.useState(!1),[m,p]=P.useState(null);P.useEffect(()=>{(async()=>{const{data:{session:y}}=await ce.auth.getSession(),b=new URLSearchParams(window.location.hash.substring(1)),j=b.get("access_token");if(b.get("type")==="recovery"&&j){const{error:O}=await ce.auth.setSession({access_token:j,refresh_token:b.get("refresh_token")||""});O?p(!1):(p(!0),window.history.replaceState({},document.title,window.location.pathname))}else p(!!y)})()},[]);const g=async x=>{x.preventDefault();const y=Ege.safeParse({password:t,confirmPassword:s});if(!y.success){de.error(y.error.errors[0].message);return}u(!0);try{const{error:b}=await ce.auth.updateUser({password:t});if(b)throw b;f(!0),de.success("Senha redefinida com sucesso!")}catch(b){console.error("Password update error:",b),de.error(b.message||"Erro ao redefinir senha. Tente novamente.")}finally{u(!1)}},v=async()=>{await ce.auth.signOut(),e("/entrar")};return m===null?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 max-w-md flex items-center justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}):m?h?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 max-w-md",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4",children:n.jsx(Er,{className:"h-8 w-8 text-green-600"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Senha redefinida!"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:"Sua senha foi alterada com sucesso. Agora voc pode fazer login com sua nova senha."}),n.jsx(he,{className:"w-full",onClick:v,children:"Entrar"})]})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-md",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-accent/10 mb-4",children:n.jsx(Yo,{className:"h-8 w-8 text-accent"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Criar nova senha"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Digite sua nova senha abaixo. Escolha uma senha segura com no mnimo 6 caracteres."})]}),n.jsxs("form",{onSubmit:g,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"password",children:"Nova senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(Qe,{id:"password",type:i?"text":"password",placeholder:"",value:t,onChange:x=>r(x.target.value),required:!0,autoFocus:!0}),n.jsx("button",{type:"button",onClick:()=>o(!i),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:i?n.jsx(dc,{className:"h-4 w-4"}):n.jsx(ci,{className:"h-4 w-4"})})]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Mnimo de 6 caracteres"})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"confirmPassword",children:"Confirmar nova senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(Qe,{id:"confirmPassword",type:c?"text":"password",placeholder:"",value:s,onChange:x=>a(x.target.value),required:!0}),n.jsx("button",{type:"button",onClick:()=>d(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:c?n.jsx(dc,{className:"h-4 w-4"}):n.jsx(ci,{className:"h-4 w-4"})})]})]}),n.jsx(he,{type:"submit",className:"w-full",disabled:l,children:l?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),"Redefinindo..."]}):"Redefinir senha"})]})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 max-w-md",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-red-100 mb-4",children:n.jsx(Cn,{className:"h-8 w-8 text-red-600"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Link invlido ou expirado"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:"Este link de recuperao de senha no  mais vlido. Isso pode acontecer se o link j foi usado ou expirou."}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(Gt,{to:"/esqueci-senha",children:n.jsx(he,{className:"w-full",children:"Solicitar novo link"})}),n.jsx(Gt,{to:"/entrar",children:n.jsx(he,{variant:"outline",className:"w-full",children:"Voltar para login"})})]})]})})]})},Age=Sg({password:Vi().min(6,"Senha deve ter no mnimo 6 caracteres"),confirmPassword:Vi().min(6,"Confirmao deve ter no mnimo 6 caracteres")}).refine(e=>e.password===e.confirmPassword,{message:"As senhas no conferem",path:["confirmPassword"]}),Tge=()=>{const e=fr(),[t]=kc(),r=t.get("token"),[s,a]=P.useState(""),[i,o]=P.useState(""),[c,d]=P.useState(!1),[l,u]=P.useState(!1),[h,f]=P.useState(!1),[m,p]=P.useState(!1),[g,v]=P.useState(null);P.useEffect(()=>{r||v("Link invlido. Solicite um novo link de recuperao.")},[r]);const x=async j=>{j.preventDefault();const T=Age.safeParse({password:s,confirmPassword:i});if(!T.success){de.error(T.error.errors[0].message);return}f(!0),v(null);try{const{data:O,error:R}=await ce.functions.invoke("reset-password",{body:{token:r,newPassword:s}});if(R)throw new Error(R.message||"Erro ao redefinir senha");if(O!=null&&O.error)throw new Error(O.error);p(!0),de.success("Senha atualizada com sucesso! ")}catch(O){console.error("Password reset error:",O);const R=O.message||"Erro ao redefinir senha. Tente novamente.";v(R),de.error(R)}finally{f(!1)}},y=()=>{e("/meu-estilo")},b=()=>{e("/entrar")};return!r||g?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 max-w-md",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-red-100 mb-4",children:n.jsx(Cn,{className:"h-8 w-8 text-red-600"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Link invlido ou expirado"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:g||"Este link de recuperao de senha no  mais vlido. Isso pode acontecer se o link j foi usado ou expirou."}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(Gt,{to:"/esqueci-senha",children:n.jsx(he,{className:"w-full",children:"Solicitar novo link"})}),n.jsx(Gt,{to:"/entrar",children:n.jsx(he,{variant:"outline",className:"w-full",children:"Voltar para login"})})]})]})})]}):m?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 max-w-md",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-green-100 mb-4",children:n.jsx(Er,{className:"h-8 w-8 text-green-600"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:" Senha atualizada com sucesso!"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:"Voc j pode acessar o seu Provador VIP e conferir suas sugestes personalizadas."}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs(he,{className:"w-full gap-2",onClick:y,children:[n.jsx(Wr,{className:"h-4 w-4"}),"Ir para Meu Estilo"]}),n.jsx(he,{variant:"outline",className:"w-full",onClick:b,children:"Fazer login"})]}),n.jsx("div",{className:"mt-8 p-4 bg-accent/10 rounded-xl border border-accent/30",children:n.jsx("p",{className:"text-sm text-muted-foreground",children:' Acesse "Meu Estilo" para ver seu nvel VIP, pontos acumulados e sugestes exclusivas!'})})]})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-md",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-accent/10 mb-4",children:n.jsx(Yo,{className:"h-8 w-8 text-accent"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Criar nova senha"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Digite sua nova senha abaixo. Escolha uma senha segura com no mnimo 6 caracteres."})]}),n.jsxs("form",{onSubmit:x,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"password",children:"Nova senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(Qe,{id:"password",type:c?"text":"password",placeholder:"",value:s,onChange:j=>a(j.target.value),required:!0,autoFocus:!0}),n.jsx("button",{type:"button",onClick:()=>d(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:c?n.jsx(dc,{className:"h-4 w-4"}):n.jsx(ci,{className:"h-4 w-4"})})]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Mnimo de 6 caracteres"})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"confirmPassword",children:"Confirmar nova senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(Qe,{id:"confirmPassword",type:l?"text":"password",placeholder:"",value:i,onChange:j=>o(j.target.value),required:!0}),n.jsx("button",{type:"button",onClick:()=>u(!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:l?n.jsx(dc,{className:"h-4 w-4"}):n.jsx(ci,{className:"h-4 w-4"})})]})]}),n.jsx(he,{type:"submit",className:"w-full",disabled:h,children:h?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar nova senha"})]})]})]})};var Pge=P.createContext(void 0);function Cg(e){const t=P.useContext(Pge);return e||t||"ltr"}var A3="rovingFocusGroup.onEntryFocus",Oge={bubbles:!1,cancelable:!0},A1="RovingFocusGroup",[OC,zq,Rge]=w_(A1),[Mge,Eg]=ta(A1,[Rge]),[Ige,Dge]=Mge(A1),Uq=P.forwardRef((e,t)=>n.jsx(OC.Provider,{scope:e.__scopeRovingFocusGroup,children:n.jsx(OC.Slot,{scope:e.__scopeRovingFocusGroup,children:n.jsx(Lge,{...e,ref:t})})}));Uq.displayName=A1;var Lge=P.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:s,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:d,onEntryFocus:l,preventScrollOnEntryFocus:u=!1,...h}=e,f=P.useRef(null),m=Ir(t,f),p=Cg(i),[g,v]=Yi({prop:o,defaultProp:c??null,onChange:d,caller:A1}),[x,y]=P.useState(!1),b=Ws(l),j=zq(r),T=P.useRef(!1),[O,R]=P.useState(0);return P.useEffect(()=>{const D=f.current;if(D)return D.addEventListener(A3,b),()=>D.removeEventListener(A3,b)},[b]),n.jsx(Ige,{scope:r,orientation:s,dir:p,loop:a,currentTabStopId:g,onItemFocus:P.useCallback(D=>v(D),[v]),onItemShiftTab:P.useCallback(()=>y(!0),[]),onFocusableItemAdd:P.useCallback(()=>R(D=>D+1),[]),onFocusableItemRemove:P.useCallback(()=>R(D=>D-1),[]),children:n.jsx(er.div,{tabIndex:x||O===0?-1:0,"data-orientation":s,...h,ref:m,style:{outline:"none",...e.style},onMouseDown:kt(e.onMouseDown,()=>{T.current=!0}),onFocus:kt(e.onFocus,D=>{const L=!T.current;if(D.target===D.currentTarget&&L&&!x){const q=new CustomEvent(A3,Oge);if(D.currentTarget.dispatchEvent(q),!q.defaultPrevented){const X=j().filter(E=>E.focusable),H=X.find(E=>E.active),M=X.find(E=>E.id===g),S=[H,M,...X].filter(Boolean).map(E=>E.ref.current);Wq(S,u)}}T.current=!1}),onBlur:kt(e.onBlur,()=>y(!1))})})}),Vq="RovingFocusGroupItem",qq=P.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:s=!0,active:a=!1,tabStopId:i,children:o,...c}=e,d=xa(),l=i||d,u=Dge(Vq,r),h=u.currentTabStopId===l,f=zq(r),{onFocusableItemAdd:m,onFocusableItemRemove:p,currentTabStopId:g}=u;return P.useEffect(()=>{if(s)return m(),()=>p()},[s,m,p]),n.jsx(OC.ItemSlot,{scope:r,id:l,focusable:s,active:a,children:n.jsx(er.span,{tabIndex:h?0:-1,"data-orientation":u.orientation,...c,ref:t,onMouseDown:kt(e.onMouseDown,v=>{s?u.onItemFocus(l):v.preventDefault()}),onFocus:kt(e.onFocus,()=>u.onItemFocus(l)),onKeyDown:kt(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const x=Fge(v,u.orientation,u.dir);if(x!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let b=f().filter(j=>j.focusable).map(j=>j.ref.current);if(x==="last")b.reverse();else if(x==="prev"||x==="next"){x==="prev"&&b.reverse();const j=b.indexOf(v.currentTarget);b=u.loop?zge(b,j+1):b.slice(j+1)}setTimeout(()=>Wq(b))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:g!=null}):o})})});qq.displayName=Vq;var Bge={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function $ge(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Fge(e,t,r){const s=$ge(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return Bge[s]}function Wq(e,t=!1){const r=document.activeElement;for(const s of e)if(s===r||(s.focus({preventScroll:t}),document.activeElement!==r))return}function zge(e,t){return e.map((r,s)=>e[(t+s)%e.length])}var Xk=Uq,Yk=qq,W_="Tabs",[Uge,oet]=ta(W_,[Eg]),Hq=Eg(),[Vge,Zk]=Uge(W_),Gq=P.forwardRef((e,t)=>{const{__scopeTabs:r,value:s,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:c,activationMode:d="automatic",...l}=e,u=Cg(c),[h,f]=Yi({prop:s,onChange:a,defaultProp:i??"",caller:W_});return n.jsx(Vge,{scope:r,baseId:xa(),value:h,onValueChange:f,orientation:o,dir:u,activationMode:d,children:n.jsx(er.div,{dir:u,"data-orientation":o,...l,ref:t})})});Gq.displayName=W_;var Kq="TabsList",Xq=P.forwardRef((e,t)=>{const{__scopeTabs:r,loop:s=!0,...a}=e,i=Zk(Kq,r),o=Hq(r);return n.jsx(Xk,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:s,children:n.jsx(er.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:t})})});Xq.displayName=Kq;var Yq="TabsTrigger",Zq=P.forwardRef((e,t)=>{const{__scopeTabs:r,value:s,disabled:a=!1,...i}=e,o=Zk(Yq,r),c=Hq(r),d=eW(o.baseId,s),l=tW(o.baseId,s),u=s===o.value;return n.jsx(Yk,{asChild:!0,...c,focusable:!a,active:u,children:n.jsx(er.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":l,"data-state":u?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:d,...i,ref:t,onMouseDown:kt(e.onMouseDown,h=>{!a&&h.button===0&&h.ctrlKey===!1?o.onValueChange(s):h.preventDefault()}),onKeyDown:kt(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(s)}),onFocus:kt(e.onFocus,()=>{const h=o.activationMode!=="manual";!u&&!a&&h&&o.onValueChange(s)})})})});Zq.displayName=Yq;var Qq="TabsContent",Jq=P.forwardRef((e,t)=>{const{__scopeTabs:r,value:s,forceMount:a,children:i,...o}=e,c=Zk(Qq,r),d=eW(c.baseId,s),l=tW(c.baseId,s),u=s===c.value,h=P.useRef(u);return P.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),n.jsx(Gs,{present:a||u,children:({present:f})=>n.jsx(er.div,{"data-state":u?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!f,id:l,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});Jq.displayName=Qq;function eW(e,t){return`${e}-trigger-${t}`}function tW(e,t){return`${e}-content-${t}`}var qge=Gq,rW=Xq,nW=Zq,sW=Jq;const pi=qge,Qa=P.forwardRef(({className:e,...t},r)=>n.jsx(rW,{ref:r,className:We("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Qa.displayName=rW.displayName;const pr=P.forwardRef(({className:e,...t},r)=>n.jsx(nW,{ref:r,className:We("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",e),...t}));pr.displayName=nW.displayName;const wr=P.forwardRef(({className:e,...t},r)=>n.jsx(sW,{ref:r,className:We("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));wr.displayName=sW.displayName;const _a=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{className:"relative w-full overflow-auto",children:n.jsx("table",{ref:r,className:We("w-full caption-bottom text-sm",e),...t})}));_a.displayName="Table";const ja=P.forwardRef(({className:e,...t},r)=>n.jsx("thead",{ref:r,className:We("[&_tr]:border-b",e),...t}));ja.displayName="TableHeader";const Na=P.forwardRef(({className:e,...t},r)=>n.jsx("tbody",{ref:r,className:We("[&_tr:last-child]:border-0",e),...t}));Na.displayName="TableBody";const Wge=P.forwardRef(({className:e,...t},r)=>n.jsx("tfoot",{ref:r,className:We("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Wge.displayName="TableFooter";const Qr=P.forwardRef(({className:e,...t},r)=>n.jsx("tr",{ref:r,className:We("border-b transition-colors data-[state=selected]:bg-muted hover:bg-muted/50",e),...t}));Qr.displayName="TableRow";const jt=P.forwardRef(({className:e,...t},r)=>n.jsx("th",{ref:r,className:We("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));jt.displayName="TableHead";const yt=P.forwardRef(({className:e,...t},r)=>n.jsx("td",{ref:r,className:We("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));yt.displayName="TableCell";const Hge=P.forwardRef(({className:e,...t},r)=>n.jsx("caption",{ref:r,className:We("mt-4 text-sm text-muted-foreground",e),...t}));Hge.displayName="TableCaption";const aW=we.forwardRef(({value:e,onChange:t,className:r,...s},a)=>{const i=c=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:2,maximumFractionDigits:2}).format(c),o=c=>{const d=c.target.value.replace(/\D/g,""),u=(parseInt(d,10)||0)/100;t(u)};return n.jsx(Qe,{...s,ref:a,className:We("font-mono",r),value:i(e),onChange:o,inputMode:"numeric"})});aW.displayName="MoneyInput";function H_(e){const t=P.useRef({value:e,previous:e});return P.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var G_="Checkbox",[Gge,cet]=ta(G_),[Kge,Qk]=Gge(G_);function Xge(e){const{__scopeCheckbox:t,checked:r,children:s,defaultChecked:a,disabled:i,form:o,name:c,onCheckedChange:d,required:l,value:u="on",internal_do_not_use_render:h}=e,[f,m]=Yi({prop:r,defaultProp:a??!1,onChange:d,caller:G_}),[p,g]=P.useState(null),[v,x]=P.useState(null),y=P.useRef(!1),b=p?!!o||!!p.closest("form"):!0,j={checked:f,disabled:i,setChecked:m,control:p,setControl:g,name:c,form:o,value:u,hasConsumerStoppedPropagationRef:y,required:l,defaultChecked:ju(a)?!1:a,isFormControl:b,bubbleInput:v,setBubbleInput:x};return n.jsx(Kge,{scope:t,...j,children:Yge(h)?h(j):s})}var iW="CheckboxTrigger",oW=P.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...s},a)=>{const{control:i,value:o,disabled:c,checked:d,required:l,setControl:u,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:p}=Qk(iW,e),g=Ir(a,u),v=P.useRef(d);return P.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const y=()=>h(v.current);return x.addEventListener("reset",y),()=>x.removeEventListener("reset",y)}},[i,h]),n.jsx(er.button,{type:"button",role:"checkbox","aria-checked":ju(d)?"mixed":d,"aria-required":l,"data-state":hW(d),"data-disabled":c?"":void 0,disabled:c,value:o,...s,ref:g,onKeyDown:kt(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:kt(r,x=>{h(y=>ju(y)?!0:!y),p&&m&&(f.current=x.isPropagationStopped(),f.current||x.stopPropagation())})})});oW.displayName=iW;var Jk=P.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:s,checked:a,defaultChecked:i,required:o,disabled:c,value:d,onCheckedChange:l,form:u,...h}=e;return n.jsx(Xge,{__scopeCheckbox:r,checked:a,defaultChecked:i,disabled:c,required:o,onCheckedChange:l,name:s,form:u,value:d,internal_do_not_use_render:({isFormControl:f})=>n.jsxs(n.Fragment,{children:[n.jsx(oW,{...h,ref:t,__scopeCheckbox:r}),f&&n.jsx(uW,{__scopeCheckbox:r})]})})});Jk.displayName=G_;var lW="CheckboxIndicator",cW=P.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:s,...a}=e,i=Qk(lW,r);return n.jsx(Gs,{present:s||ju(i.checked)||i.checked===!0,children:n.jsx(er.span,{"data-state":hW(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t,style:{pointerEvents:"none",...e.style}})})});cW.displayName=lW;var dW="CheckboxBubbleInput",uW=P.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:s,hasConsumerStoppedPropagationRef:a,checked:i,defaultChecked:o,required:c,disabled:d,name:l,value:u,form:h,bubbleInput:f,setBubbleInput:m}=Qk(dW,e),p=Ir(r,m),g=H_(i),v=k_(s);P.useEffect(()=>{const y=f;if(!y)return;const b=window.HTMLInputElement.prototype,T=Object.getOwnPropertyDescriptor(b,"checked").set,O=!a.current;if(g!==i&&T){const R=new Event("click",{bubbles:O});y.indeterminate=ju(i),T.call(y,ju(i)?!1:i),y.dispatchEvent(R)}},[f,g,i,a]);const x=P.useRef(ju(i)?!1:i);return n.jsx(er.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??x.current,required:c,disabled:d,name:l,value:u,form:h,...t,tabIndex:-1,ref:p,style:{...t.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});uW.displayName=dW;function Yge(e){return typeof e=="function"}function ju(e){return e==="indeterminate"}function hW(e){return ju(e)?"indeterminate":e?"checked":"unchecked"}const va=P.forwardRef(({className:e,...t},r)=>n.jsx(Jk,{ref:r,className:We("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(cW,{className:We("flex items-center justify-center text-current"),children:n.jsx(xn,{className:"h-4 w-4"})})}));va.displayName=Jk.displayName;const cn=w1,Zge=z_,Qge=_1,fW=P.forwardRef(({className:e,...t},r)=>n.jsx(Tf,{ref:r,className:We("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));fW.displayName=Tf.displayName;const sn=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(Qge,{children:[n.jsx(fW,{}),n.jsxs(Pf,{ref:s,className:We("fixed left-[50%] top-[50%] z-50 grid w-[min(92vw,520px)] max-w-[92vw] max-h-[85vh] overflow-y-auto translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-4 sm:p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-lg",e),...r,children:[t,n.jsxs(j1,{className:"absolute right-3 top-3 sm:right-4 sm:top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[n.jsx(an,{className:"h-4 w-4"}),n.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));sn.displayName=Pf.displayName;const fn=({className:e,...t})=>n.jsx("div",{className:We("flex flex-col space-y-1.5 text-center sm:text-left pr-8",e),...t});fn.displayName="DialogHeader";const Da=({className:e,...t})=>n.jsx("div",{className:We("flex flex-col gap-2 sm:flex-row sm:justify-end sm:space-x-2",e),...t});Da.displayName="DialogFooter";const dn=P.forwardRef(({className:e,...t},r)=>n.jsx(jg,{ref:r,className:We("text-lg font-semibold leading-none tracking-tight",e),...t}));dn.displayName=jg.displayName;const Zo=P.forwardRef(({className:e,...t},r)=>n.jsx(Ng,{ref:r,className:We("text-sm text-muted-foreground",e),...t}));Zo.displayName=Ng.displayName;function RC(e,[t,r]){return Math.min(r,Math.max(t,e))}var Jge=[" ","Enter","ArrowUp","ArrowDown"],e0e=[" ","Enter"],ff="Select",[K_,X_,t0e]=w_(ff),[kg,det]=ta(ff,[t0e,Cc]),Y_=Cc(),[r0e,Hu]=kg(ff),[n0e,s0e]=kg(ff),mW=e=>{const{__scopeSelect:t,children:r,open:s,defaultOpen:a,onOpenChange:i,value:o,defaultValue:c,onValueChange:d,dir:l,name:u,autoComplete:h,disabled:f,required:m,form:p}=e,g=Y_(t),[v,x]=P.useState(null),[y,b]=P.useState(null),[j,T]=P.useState(!1),O=Cg(l),[R,D]=Yi({prop:s,defaultProp:a??!1,onChange:i,caller:ff}),[L,q]=Yi({prop:o,defaultProp:c,onChange:d,caller:ff}),X=P.useRef(null),H=v?p||!!v.closest("form"):!0,[M,F]=P.useState(new Set),S=Array.from(M).map(E=>E.props.value).join(";");return n.jsx(p1,{...g,children:n.jsxs(r0e,{required:m,scope:t,trigger:v,onTriggerChange:x,valueNode:y,onValueNodeChange:b,valueNodeHasChildren:j,onValueNodeHasChildrenChange:T,contentId:xa(),value:L,onValueChange:q,open:R,onOpenChange:D,dir:O,triggerPointerDownPosRef:X,disabled:f,children:[n.jsx(K_.Provider,{scope:t,children:n.jsx(n0e,{scope:e.__scopeSelect,onNativeOptionAdd:P.useCallback(E=>{F(N=>new Set(N).add(E))},[]),onNativeOptionRemove:P.useCallback(E=>{F(N=>{const C=new Set(N);return C.delete(E),C})},[]),children:r})}),H?n.jsxs(BW,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:h,value:L,onChange:E=>q(E.target.value),disabled:f,form:p,children:[L===void 0?n.jsx("option",{value:""}):null,Array.from(M)]},S):null]})})};mW.displayName=ff;var pW="SelectTrigger",gW=P.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:s=!1,...a}=e,i=Y_(r),o=Hu(pW,r),c=o.disabled||s,d=Ir(t,o.onTriggerChange),l=X_(r),u=P.useRef("touch"),[h,f,m]=FW(g=>{const v=l().filter(b=>!b.disabled),x=v.find(b=>b.value===o.value),y=zW(v,g,x);y!==void 0&&o.onValueChange(y.value)}),p=g=>{c||(o.onOpenChange(!0),m()),g&&(o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return n.jsx(yg,{asChild:!0,...i,children:n.jsx(er.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":$W(o.value)?"":void 0,...a,ref:d,onClick:kt(a.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&p(g)}),onPointerDown:kt(a.onPointerDown,g=>{u.current=g.pointerType;const v=g.target;v.hasPointerCapture(g.pointerId)&&v.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(p(g),g.preventDefault())}),onKeyDown:kt(a.onKeyDown,g=>{const v=h.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&f(g.key),!(v&&g.key===" ")&&Jge.includes(g.key)&&(p(),g.preventDefault())})})})});gW.displayName=pW;var xW="SelectValue",vW=P.forwardRef((e,t)=>{const{__scopeSelect:r,className:s,style:a,children:i,placeholder:o="",...c}=e,d=Hu(xW,r),{onValueNodeHasChildrenChange:l}=d,u=i!==void 0,h=Ir(t,d.onValueNodeChange);return ya(()=>{l(u)},[l,u]),n.jsx(er.span,{...c,ref:h,style:{pointerEvents:"none"},children:$W(d.value)?n.jsx(n.Fragment,{children:o}):i})});vW.displayName=xW;var a0e="SelectIcon",yW=P.forwardRef((e,t)=>{const{__scopeSelect:r,children:s,...a}=e;return n.jsx(er.span,{"aria-hidden":!0,...a,ref:t,children:s||""})});yW.displayName=a0e;var i0e="SelectPortal",bW=e=>n.jsx(mg,{asChild:!0,...e});bW.displayName=i0e;var mf="SelectContent",wW=P.forwardRef((e,t)=>{const r=Hu(mf,e.__scopeSelect),[s,a]=P.useState();if(ya(()=>{a(new DocumentFragment)},[]),!r.open){const i=s;return i?kf.createPortal(n.jsx(_W,{scope:e.__scopeSelect,children:n.jsx(K_.Slot,{scope:e.__scopeSelect,children:n.jsx("div",{children:e.children})})}),i):null}return n.jsx(jW,{...e,ref:t})});wW.displayName=mf;var fl=10,[_W,Gu]=kg(mf),o0e="SelectContentImpl",l0e=Eu("SelectContent.RemoveScroll"),jW=P.forwardRef((e,t)=>{const{__scopeSelect:r,position:s="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:i,onPointerDownOutside:o,side:c,sideOffset:d,align:l,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:p,hideWhenDetached:g,avoidCollisions:v,...x}=e,y=Hu(mf,r),[b,j]=P.useState(null),[T,O]=P.useState(null),R=Ir(t,J=>j(J)),[D,L]=P.useState(null),[q,X]=P.useState(null),H=X_(r),[M,F]=P.useState(!1),S=P.useRef(!1);P.useEffect(()=>{if(b)return $_(b)},[b]),L_();const E=P.useCallback(J=>{const[V,...W]=H().map(oe=>oe.ref.current),[ee]=W.slice(-1),ie=document.activeElement;for(const oe of J)if(oe===ie||(oe==null||oe.scrollIntoView({block:"nearest"}),oe===V&&T&&(T.scrollTop=0),oe===ee&&T&&(T.scrollTop=T.scrollHeight),oe==null||oe.focus(),document.activeElement!==ie))return},[H,T]),N=P.useCallback(()=>E([D,b]),[E,D,b]);P.useEffect(()=>{M&&N()},[M,N]);const{onOpenChange:C,triggerPointerDownPosRef:k}=y;P.useEffect(()=>{if(b){let J={x:0,y:0};const V=ee=>{var ie,oe;J={x:Math.abs(Math.round(ee.pageX)-(((ie=k.current)==null?void 0:ie.x)??0)),y:Math.abs(Math.round(ee.pageY)-(((oe=k.current)==null?void 0:oe.y)??0))}},W=ee=>{J.x<=10&&J.y<=10?ee.preventDefault():b.contains(ee.target)||C(!1),document.removeEventListener("pointermove",V),k.current=null};return k.current!==null&&(document.addEventListener("pointermove",V),document.addEventListener("pointerup",W,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",V),document.removeEventListener("pointerup",W,{capture:!0})}}},[b,C,k]),P.useEffect(()=>{const J=()=>C(!1);return window.addEventListener("blur",J),window.addEventListener("resize",J),()=>{window.removeEventListener("blur",J),window.removeEventListener("resize",J)}},[C]);const[I,U]=FW(J=>{const V=H().filter(ie=>!ie.disabled),W=V.find(ie=>ie.ref.current===document.activeElement),ee=zW(V,J,W);ee&&setTimeout(()=>ee.ref.current.focus())}),$=P.useCallback((J,V,W)=>{const ee=!S.current&&!W;(y.value!==void 0&&y.value===V||ee)&&(L(J),ee&&(S.current=!0))},[y.value]),Y=P.useCallback(()=>b==null?void 0:b.focus(),[b]),Z=P.useCallback((J,V,W)=>{const ee=!S.current&&!W;(y.value!==void 0&&y.value===V||ee)&&X(J)},[y.value]),re=s==="popper"?MC:NW,G=re===MC?{side:c,sideOffset:d,align:l,alignOffset:u,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:p,hideWhenDetached:g,avoidCollisions:v}:{};return n.jsx(_W,{scope:r,content:b,viewport:T,onViewportChange:O,itemRefCallback:$,selectedItem:D,onItemLeave:Y,itemTextRefCallback:Z,focusSelectedItem:N,selectedItemText:q,position:s,isPositioned:M,searchRef:I,children:n.jsx(b1,{as:l0e,allowPinchZoom:!0,children:n.jsx(y1,{asChild:!0,trapped:y.open,onMountAutoFocus:J=>{J.preventDefault()},onUnmountAutoFocus:kt(a,J=>{var V;(V=y.trigger)==null||V.focus({preventScroll:!0}),J.preventDefault()}),children:n.jsx(Fu,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:J=>J.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:n.jsx(re,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:J=>J.preventDefault(),...x,...G,onPlaced:()=>F(!0),ref:R,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:kt(x.onKeyDown,J=>{const V=J.ctrlKey||J.altKey||J.metaKey;if(J.key==="Tab"&&J.preventDefault(),!V&&J.key.length===1&&U(J.key),["ArrowUp","ArrowDown","Home","End"].includes(J.key)){let ee=H().filter(ie=>!ie.disabled).map(ie=>ie.ref.current);if(["ArrowUp","End"].includes(J.key)&&(ee=ee.slice().reverse()),["ArrowUp","ArrowDown"].includes(J.key)){const ie=J.target,oe=ee.indexOf(ie);ee=ee.slice(oe+1)}setTimeout(()=>E(ee)),J.preventDefault()}})})})})})})});jW.displayName=o0e;var c0e="SelectItemAlignedPosition",NW=P.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:s,...a}=e,i=Hu(mf,r),o=Gu(mf,r),[c,d]=P.useState(null),[l,u]=P.useState(null),h=Ir(t,R=>u(R)),f=X_(r),m=P.useRef(!1),p=P.useRef(!0),{viewport:g,selectedItem:v,selectedItemText:x,focusSelectedItem:y}=o,b=P.useCallback(()=>{if(i.trigger&&i.valueNode&&c&&l&&g&&v&&x){const R=i.trigger.getBoundingClientRect(),D=l.getBoundingClientRect(),L=i.valueNode.getBoundingClientRect(),q=x.getBoundingClientRect();if(i.dir!=="rtl"){const ie=q.left-D.left,oe=L.left-ie,se=R.left-oe,le=R.width+se,ye=Math.max(le,D.width),ue=window.innerWidth-fl,ne=RC(oe,[fl,Math.max(fl,ue-ye)]);c.style.minWidth=le+"px",c.style.left=ne+"px"}else{const ie=D.right-q.right,oe=window.innerWidth-L.right-ie,se=window.innerWidth-R.right-oe,le=R.width+se,ye=Math.max(le,D.width),ue=window.innerWidth-fl,ne=RC(oe,[fl,Math.max(fl,ue-ye)]);c.style.minWidth=le+"px",c.style.right=ne+"px"}const X=f(),H=window.innerHeight-fl*2,M=g.scrollHeight,F=window.getComputedStyle(l),S=parseInt(F.borderTopWidth,10),E=parseInt(F.paddingTop,10),N=parseInt(F.borderBottomWidth,10),C=parseInt(F.paddingBottom,10),k=S+E+M+C+N,I=Math.min(v.offsetHeight*5,k),U=window.getComputedStyle(g),$=parseInt(U.paddingTop,10),Y=parseInt(U.paddingBottom,10),Z=R.top+R.height/2-fl,re=H-Z,G=v.offsetHeight/2,J=v.offsetTop+G,V=S+E+J,W=k-V;if(V<=Z){const ie=X.length>0&&v===X[X.length-1].ref.current;c.style.bottom="0px";const oe=l.clientHeight-g.offsetTop-g.offsetHeight,se=Math.max(re,G+(ie?Y:0)+oe+N),le=V+se;c.style.height=le+"px"}else{const ie=X.length>0&&v===X[0].ref.current;c.style.top="0px";const se=Math.max(Z,S+g.offsetTop+(ie?$:0)+G)+W;c.style.height=se+"px",g.scrollTop=V-Z+g.offsetTop}c.style.margin=`${fl}px 0`,c.style.minHeight=I+"px",c.style.maxHeight=H+"px",s==null||s(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,c,l,g,v,x,i.dir,s]);ya(()=>b(),[b]);const[j,T]=P.useState();ya(()=>{l&&T(window.getComputedStyle(l).zIndex)},[l]);const O=P.useCallback(R=>{R&&p.current===!0&&(b(),y==null||y(),p.current=!1)},[b,y]);return n.jsx(u0e,{scope:r,contentWrapper:c,shouldExpandOnScrollRef:m,onScrollButtonChange:O,children:n.jsx("div",{ref:d,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:n.jsx(er.div,{...a,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});NW.displayName=c0e;var d0e="SelectPopperPosition",MC=P.forwardRef((e,t)=>{const{__scopeSelect:r,align:s="start",collisionPadding:a=fl,...i}=e,o=Y_(r);return n.jsx(g1,{...o,...i,ref:t,align:s,collisionPadding:a,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});MC.displayName=d0e;var[u0e,e8]=kg(mf,{}),IC="SelectViewport",SW=P.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:s,...a}=e,i=Gu(IC,r),o=e8(IC,r),c=Ir(t,i.onViewportChange),d=P.useRef(0);return n.jsxs(n.Fragment,{children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),n.jsx(K_.Slot,{scope:r,children:n.jsx(er.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:kt(a.onScroll,l=>{const u=l.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:f}=o;if(f!=null&&f.current&&h){const m=Math.abs(d.current-u.scrollTop);if(m>0){const p=window.innerHeight-fl*2,g=parseFloat(h.style.minHeight),v=parseFloat(h.style.height),x=Math.max(g,v);if(x<p){const y=x+m,b=Math.min(p,y),j=y-b;h.style.height=b+"px",h.style.bottom==="0px"&&(u.scrollTop=j>0?j:0,h.style.justifyContent="flex-end")}}}d.current=u.scrollTop})})})]})});SW.displayName=IC;var CW="SelectGroup",[h0e,f0e]=kg(CW),m0e=P.forwardRef((e,t)=>{const{__scopeSelect:r,...s}=e,a=xa();return n.jsx(h0e,{scope:r,id:a,children:n.jsx(er.div,{role:"group","aria-labelledby":a,...s,ref:t})})});m0e.displayName=CW;var EW="SelectLabel",kW=P.forwardRef((e,t)=>{const{__scopeSelect:r,...s}=e,a=f0e(EW,r);return n.jsx(er.div,{id:a.id,...s,ref:t})});kW.displayName=EW;var Lw="SelectItem",[p0e,AW]=kg(Lw),TW=P.forwardRef((e,t)=>{const{__scopeSelect:r,value:s,disabled:a=!1,textValue:i,...o}=e,c=Hu(Lw,r),d=Gu(Lw,r),l=c.value===s,[u,h]=P.useState(i??""),[f,m]=P.useState(!1),p=Ir(t,y=>{var b;return(b=d.itemRefCallback)==null?void 0:b.call(d,y,s,a)}),g=xa(),v=P.useRef("touch"),x=()=>{a||(c.onValueChange(s),c.onOpenChange(!1))};if(s==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return n.jsx(p0e,{scope:r,value:s,disabled:a,textId:g,isSelected:l,onItemTextChange:P.useCallback(y=>{h(b=>b||((y==null?void 0:y.textContent)??"").trim())},[]),children:n.jsx(K_.ItemSlot,{scope:r,value:s,disabled:a,textValue:u,children:n.jsx(er.div,{role:"option","aria-labelledby":g,"data-highlighted":f?"":void 0,"aria-selected":l&&f,"data-state":l?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...o,ref:p,onFocus:kt(o.onFocus,()=>m(!0)),onBlur:kt(o.onBlur,()=>m(!1)),onClick:kt(o.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:kt(o.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:kt(o.onPointerDown,y=>{v.current=y.pointerType}),onPointerMove:kt(o.onPointerMove,y=>{var b;v.current=y.pointerType,a?(b=d.onItemLeave)==null||b.call(d):v.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:kt(o.onPointerLeave,y=>{var b;y.currentTarget===document.activeElement&&((b=d.onItemLeave)==null||b.call(d))}),onKeyDown:kt(o.onKeyDown,y=>{var j;((j=d.searchRef)==null?void 0:j.current)!==""&&y.key===" "||(e0e.includes(y.key)&&x(),y.key===" "&&y.preventDefault())})})})})});TW.displayName=Lw;var K0="SelectItemText",PW=P.forwardRef((e,t)=>{const{__scopeSelect:r,className:s,style:a,...i}=e,o=Hu(K0,r),c=Gu(K0,r),d=AW(K0,r),l=s0e(K0,r),[u,h]=P.useState(null),f=Ir(t,x=>h(x),d.onItemTextChange,x=>{var y;return(y=c.itemTextRefCallback)==null?void 0:y.call(c,x,d.value,d.disabled)}),m=u==null?void 0:u.textContent,p=P.useMemo(()=>n.jsx("option",{value:d.value,disabled:d.disabled,children:m},d.value),[d.disabled,d.value,m]),{onNativeOptionAdd:g,onNativeOptionRemove:v}=l;return ya(()=>(g(p),()=>v(p)),[g,v,p]),n.jsxs(n.Fragment,{children:[n.jsx(er.span,{id:d.textId,...i,ref:f}),d.isSelected&&o.valueNode&&!o.valueNodeHasChildren?kf.createPortal(i.children,o.valueNode):null]})});PW.displayName=K0;var OW="SelectItemIndicator",RW=P.forwardRef((e,t)=>{const{__scopeSelect:r,...s}=e;return AW(OW,r).isSelected?n.jsx(er.span,{"aria-hidden":!0,...s,ref:t}):null});RW.displayName=OW;var DC="SelectScrollUpButton",MW=P.forwardRef((e,t)=>{const r=Gu(DC,e.__scopeSelect),s=e8(DC,e.__scopeSelect),[a,i]=P.useState(!1),o=Ir(t,s.onScrollButtonChange);return ya(()=>{if(r.viewport&&r.isPositioned){let c=function(){const l=d.scrollTop>0;i(l)};const d=r.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),a?n.jsx(DW,{...e,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=r;c&&d&&(c.scrollTop=c.scrollTop-d.offsetHeight)}}):null});MW.displayName=DC;var LC="SelectScrollDownButton",IW=P.forwardRef((e,t)=>{const r=Gu(LC,e.__scopeSelect),s=e8(LC,e.__scopeSelect),[a,i]=P.useState(!1),o=Ir(t,s.onScrollButtonChange);return ya(()=>{if(r.viewport&&r.isPositioned){let c=function(){const l=d.scrollHeight-d.clientHeight,u=Math.ceil(d.scrollTop)<l;i(u)};const d=r.viewport;return c(),d.addEventListener("scroll",c),()=>d.removeEventListener("scroll",c)}},[r.viewport,r.isPositioned]),a?n.jsx(DW,{...e,ref:o,onAutoScroll:()=>{const{viewport:c,selectedItem:d}=r;c&&d&&(c.scrollTop=c.scrollTop+d.offsetHeight)}}):null});IW.displayName=LC;var DW=P.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:s,...a}=e,i=Gu("SelectScrollButton",r),o=P.useRef(null),c=X_(r),d=P.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return P.useEffect(()=>()=>d(),[d]),ya(()=>{var u;const l=c().find(h=>h.ref.current===document.activeElement);(u=l==null?void 0:l.ref.current)==null||u.scrollIntoView({block:"nearest"})},[c]),n.jsx(er.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:kt(a.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(s,50))}),onPointerMove:kt(a.onPointerMove,()=>{var l;(l=i.onItemLeave)==null||l.call(i),o.current===null&&(o.current=window.setInterval(s,50))}),onPointerLeave:kt(a.onPointerLeave,()=>{d()})})}),g0e="SelectSeparator",LW=P.forwardRef((e,t)=>{const{__scopeSelect:r,...s}=e;return n.jsx(er.div,{"aria-hidden":!0,...s,ref:t})});LW.displayName=g0e;var BC="SelectArrow",x0e=P.forwardRef((e,t)=>{const{__scopeSelect:r,...s}=e,a=Y_(r),i=Hu(BC,r),o=Gu(BC,r);return i.open&&o.position==="popper"?n.jsx(x1,{...a,...s,ref:t}):null});x0e.displayName=BC;var v0e="SelectBubbleInput",BW=P.forwardRef(({__scopeSelect:e,value:t,...r},s)=>{const a=P.useRef(null),i=Ir(s,a),o=H_(t);return P.useEffect(()=>{const c=a.current;if(!c)return;const d=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(d,"value").set;if(o!==t&&u){const h=new Event("change",{bubbles:!0});u.call(c,t),c.dispatchEvent(h)}},[o,t]),n.jsx(er.select,{...r,style:{...yz,...r.style},ref:i,defaultValue:t})});BW.displayName=v0e;function $W(e){return e===""||e===void 0}function FW(e){const t=Ws(e),r=P.useRef(""),s=P.useRef(0),a=P.useCallback(o=>{const c=r.current+o;t(c),function d(l){r.current=l,window.clearTimeout(s.current),l!==""&&(s.current=window.setTimeout(()=>d(""),1e3))}(c)},[t]),i=P.useCallback(()=>{r.current="",window.clearTimeout(s.current)},[]);return P.useEffect(()=>()=>window.clearTimeout(s.current),[]),[r,a,i]}function zW(e,t,r){const a=t.length>1&&Array.from(t).every(l=>l===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=y0e(e,Math.max(i,0));a.length===1&&(o=o.filter(l=>l!==r));const d=o.find(l=>l.textValue.toLowerCase().startsWith(a.toLowerCase()));return d!==r?d:void 0}function y0e(e,t){return e.map((r,s)=>e[(t+s)%e.length])}var b0e=mW,UW=gW,w0e=vW,_0e=yW,j0e=bW,VW=wW,N0e=SW,qW=kW,WW=TW,S0e=PW,C0e=RW,HW=MW,GW=IW,KW=LW;const Kt=b0e,Xt=w0e,Vt=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(UW,{ref:s,className:We("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,n.jsx(_0e,{asChild:!0,children:n.jsx(Zi,{className:"h-4 w-4 opacity-50"})})]}));Vt.displayName=UW.displayName;const XW=P.forwardRef(({className:e,...t},r)=>n.jsx(HW,{ref:r,className:We("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx(nf,{className:"h-4 w-4"})}));XW.displayName=HW.displayName;const YW=P.forwardRef(({className:e,...t},r)=>n.jsx(GW,{ref:r,className:We("flex cursor-default items-center justify-center py-1",e),...t,children:n.jsx(Zi,{className:"h-4 w-4"})}));YW.displayName=GW.displayName;const qt=P.forwardRef(({className:e,children:t,position:r="popper",...s},a)=>n.jsx(j0e,{children:n.jsxs(VW,{ref:a,className:We("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...s,children:[n.jsx(XW,{}),n.jsx(N0e,{className:We("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),n.jsx(YW,{})]})}));qt.displayName=VW.displayName;const E0e=P.forwardRef(({className:e,...t},r)=>n.jsx(qW,{ref:r,className:We("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));E0e.displayName=qW.displayName;const ze=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(WW,{ref:s,className:We("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...r,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(C0e,{children:n.jsx(xn,{className:"h-4 w-4"})})}),n.jsx(S0e,{children:t})]}));ze.displayName=WW.displayName;const k0e=P.forwardRef(({className:e,...t},r)=>n.jsx(KW,{ref:r,className:We("-mx-1 my-1 h-px bg-muted",e),...t}));k0e.displayName=KW.displayName;var YR=1,A0e=.9,T0e=.8,P0e=.17,T3=.1,P3=.999,O0e=.9999,R0e=.99,M0e=/[\\\/_+.#"@\[\(\{&]/,I0e=/[\\\/_+.#"@\[\(\{&]/g,D0e=/[\s-]/,ZW=/[\s-]/g;function $C(e,t,r,s,a,i,o){if(i===t.length)return a===e.length?YR:R0e;var c=`${a},${i}`;if(o[c]!==void 0)return o[c];for(var d=s.charAt(i),l=r.indexOf(d,a),u=0,h,f,m,p;l>=0;)h=$C(e,t,r,s,l+1,i+1,o),h>u&&(l===a?h*=YR:M0e.test(e.charAt(l-1))?(h*=T0e,m=e.slice(a,l-1).match(I0e),m&&a>0&&(h*=Math.pow(P3,m.length))):D0e.test(e.charAt(l-1))?(h*=A0e,p=e.slice(a,l-1).match(ZW),p&&a>0&&(h*=Math.pow(P3,p.length))):(h*=P0e,a>0&&(h*=Math.pow(P3,l-a))),e.charAt(l)!==t.charAt(i)&&(h*=O0e)),(h<T3&&r.charAt(l-1)===s.charAt(i+1)||s.charAt(i+1)===s.charAt(i)&&r.charAt(l-1)!==s.charAt(i))&&(f=$C(e,t,r,s,l+1,i+2,o),f*T3>h&&(h=f*T3)),h>u&&(u=h),l=r.indexOf(d,l+1);return o[c]=u,u}function ZR(e){return e.toLowerCase().replace(ZW," ")}function L0e(e,t,r){return e=r&&r.length>0?`${e+" "+r.join(" ")}`:e,$C(e,t,ZR(e),ZR(t),0,0,{})}var x0='[cmdk-group=""]',O3='[cmdk-group-items=""]',B0e='[cmdk-group-heading=""]',QW='[cmdk-item=""]',QR=`${QW}:not([aria-disabled="true"])`,FC="cmdk-item-select",fm="data-value",$0e=(e,t,r)=>L0e(e,t,r),JW=P.createContext(void 0),T1=()=>P.useContext(JW),eH=P.createContext(void 0),t8=()=>P.useContext(eH),tH=P.createContext(void 0),rH=P.forwardRef((e,t)=>{let r=mm(()=>{var $,Y;return{search:"",value:(Y=($=e.value)!=null?$:e.defaultValue)!=null?Y:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),s=mm(()=>new Set),a=mm(()=>new Map),i=mm(()=>new Map),o=mm(()=>new Set),c=nH(e),{label:d,children:l,value:u,onValueChange:h,filter:f,shouldFilter:m,loop:p,disablePointerSelection:g=!1,vimBindings:v=!0,...x}=e,y=xa(),b=xa(),j=xa(),T=P.useRef(null),O=Y0e();pf(()=>{if(u!==void 0){let $=u.trim();r.current.value=$,R.emit()}},[u]),pf(()=>{O(6,M)},[]);let R=P.useMemo(()=>({subscribe:$=>(o.current.add($),()=>o.current.delete($)),snapshot:()=>r.current,setState:($,Y,Z)=>{var re,G,J,V;if(!Object.is(r.current[$],Y)){if(r.current[$]=Y,$==="search")H(),q(),O(1,X);else if($==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let W=document.getElementById(j);W?W.focus():(re=document.getElementById(y))==null||re.focus()}if(O(7,()=>{var W;r.current.selectedItemId=(W=F())==null?void 0:W.id,R.emit()}),Z||O(5,M),((G=c.current)==null?void 0:G.value)!==void 0){let W=Y??"";(V=(J=c.current).onValueChange)==null||V.call(J,W);return}}R.emit()}},emit:()=>{o.current.forEach($=>$())}}),[]),D=P.useMemo(()=>({value:($,Y,Z)=>{var re;Y!==((re=i.current.get($))==null?void 0:re.value)&&(i.current.set($,{value:Y,keywords:Z}),r.current.filtered.items.set($,L(Y,Z)),O(2,()=>{q(),R.emit()}))},item:($,Y)=>(s.current.add($),Y&&(a.current.has(Y)?a.current.get(Y).add($):a.current.set(Y,new Set([$]))),O(3,()=>{H(),q(),r.current.value||X(),R.emit()}),()=>{i.current.delete($),s.current.delete($),r.current.filtered.items.delete($);let Z=F();O(4,()=>{H(),(Z==null?void 0:Z.getAttribute("id"))===$&&X(),R.emit()})}),group:$=>(a.current.has($)||a.current.set($,new Set),()=>{i.current.delete($),a.current.delete($)}),filter:()=>c.current.shouldFilter,label:d||e["aria-label"],getDisablePointerSelection:()=>c.current.disablePointerSelection,listId:y,inputId:j,labelId:b,listInnerRef:T}),[]);function L($,Y){var Z,re;let G=(re=(Z=c.current)==null?void 0:Z.filter)!=null?re:$0e;return $?G($,r.current.search,Y):0}function q(){if(!r.current.search||c.current.shouldFilter===!1)return;let $=r.current.filtered.items,Y=[];r.current.filtered.groups.forEach(re=>{let G=a.current.get(re),J=0;G.forEach(V=>{let W=$.get(V);J=Math.max(W,J)}),Y.push([re,J])});let Z=T.current;S().sort((re,G)=>{var J,V;let W=re.getAttribute("id"),ee=G.getAttribute("id");return((J=$.get(ee))!=null?J:0)-((V=$.get(W))!=null?V:0)}).forEach(re=>{let G=re.closest(O3);G?G.appendChild(re.parentElement===G?re:re.closest(`${O3} > *`)):Z.appendChild(re.parentElement===Z?re:re.closest(`${O3} > *`))}),Y.sort((re,G)=>G[1]-re[1]).forEach(re=>{var G;let J=(G=T.current)==null?void 0:G.querySelector(`${x0}[${fm}="${encodeURIComponent(re[0])}"]`);J==null||J.parentElement.appendChild(J)})}function X(){let $=S().find(Z=>Z.getAttribute("aria-disabled")!=="true"),Y=$==null?void 0:$.getAttribute(fm);R.setState("value",Y||void 0)}function H(){var $,Y,Z,re;if(!r.current.search||c.current.shouldFilter===!1){r.current.filtered.count=s.current.size;return}r.current.filtered.groups=new Set;let G=0;for(let J of s.current){let V=(Y=($=i.current.get(J))==null?void 0:$.value)!=null?Y:"",W=(re=(Z=i.current.get(J))==null?void 0:Z.keywords)!=null?re:[],ee=L(V,W);r.current.filtered.items.set(J,ee),ee>0&&G++}for(let[J,V]of a.current)for(let W of V)if(r.current.filtered.items.get(W)>0){r.current.filtered.groups.add(J);break}r.current.filtered.count=G}function M(){var $,Y,Z;let re=F();re&&((($=re.parentElement)==null?void 0:$.firstChild)===re&&((Z=(Y=re.closest(x0))==null?void 0:Y.querySelector(B0e))==null||Z.scrollIntoView({block:"nearest"})),re.scrollIntoView({block:"nearest"}))}function F(){var $;return($=T.current)==null?void 0:$.querySelector(`${QW}[aria-selected="true"]`)}function S(){var $;return Array.from((($=T.current)==null?void 0:$.querySelectorAll(QR))||[])}function E($){let Y=S()[$];Y&&R.setState("value",Y.getAttribute(fm))}function N($){var Y;let Z=F(),re=S(),G=re.findIndex(V=>V===Z),J=re[G+$];(Y=c.current)!=null&&Y.loop&&(J=G+$<0?re[re.length-1]:G+$===re.length?re[0]:re[G+$]),J&&R.setState("value",J.getAttribute(fm))}function C($){let Y=F(),Z=Y==null?void 0:Y.closest(x0),re;for(;Z&&!re;)Z=$>0?K0e(Z,x0):X0e(Z,x0),re=Z==null?void 0:Z.querySelector(QR);re?R.setState("value",re.getAttribute(fm)):N($)}let k=()=>E(S().length-1),I=$=>{$.preventDefault(),$.metaKey?k():$.altKey?C(1):N(1)},U=$=>{$.preventDefault(),$.metaKey?E(0):$.altKey?C(-1):N(-1)};return P.createElement(er.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:$=>{var Y;(Y=x.onKeyDown)==null||Y.call(x,$);let Z=$.nativeEvent.isComposing||$.keyCode===229;if(!($.defaultPrevented||Z))switch($.key){case"n":case"j":{v&&$.ctrlKey&&I($);break}case"ArrowDown":{I($);break}case"p":case"k":{v&&$.ctrlKey&&U($);break}case"ArrowUp":{U($);break}case"Home":{$.preventDefault(),E(0);break}case"End":{$.preventDefault(),k();break}case"Enter":{$.preventDefault();let re=F();if(re){let G=new Event(FC);re.dispatchEvent(G)}}}}},P.createElement("label",{"cmdk-label":"",htmlFor:D.inputId,id:D.labelId,style:Q0e},d),Z_(e,$=>P.createElement(eH.Provider,{value:R},P.createElement(JW.Provider,{value:D},$))))}),F0e=P.forwardRef((e,t)=>{var r,s;let a=xa(),i=P.useRef(null),o=P.useContext(tH),c=T1(),d=nH(e),l=(s=(r=d.current)==null?void 0:r.forceMount)!=null?s:o==null?void 0:o.forceMount;pf(()=>{if(!l)return c.item(a,o==null?void 0:o.id)},[l]);let u=sH(a,i,[e.value,e.children,i],e.keywords),h=t8(),f=Mu(O=>O.value&&O.value===u.current),m=Mu(O=>l||c.filter()===!1?!0:O.search?O.filtered.items.get(a)>0:!0);P.useEffect(()=>{let O=i.current;if(!(!O||e.disabled))return O.addEventListener(FC,p),()=>O.removeEventListener(FC,p)},[m,e.onSelect,e.disabled]);function p(){var O,R;g(),(R=(O=d.current).onSelect)==null||R.call(O,u.current)}function g(){h.setState("value",u.current,!0)}if(!m)return null;let{disabled:v,value:x,onSelect:y,forceMount:b,keywords:j,...T}=e;return P.createElement(er.div,{ref:cd(i,t),...T,id:a,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!f,"data-disabled":!!v,"data-selected":!!f,onPointerMove:v||c.getDisablePointerSelection()?void 0:g,onClick:v?void 0:p},e.children)}),z0e=P.forwardRef((e,t)=>{let{heading:r,children:s,forceMount:a,...i}=e,o=xa(),c=P.useRef(null),d=P.useRef(null),l=xa(),u=T1(),h=Mu(m=>a||u.filter()===!1?!0:m.search?m.filtered.groups.has(o):!0);pf(()=>u.group(o),[]),sH(o,c,[e.value,e.heading,d]);let f=P.useMemo(()=>({id:o,forceMount:a}),[a]);return P.createElement(er.div,{ref:cd(c,t),...i,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},r&&P.createElement("div",{ref:d,"cmdk-group-heading":"","aria-hidden":!0,id:l},r),Z_(e,m=>P.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":r?l:void 0},P.createElement(tH.Provider,{value:f},m))))}),U0e=P.forwardRef((e,t)=>{let{alwaysRender:r,...s}=e,a=P.useRef(null),i=Mu(o=>!o.search);return!r&&!i?null:P.createElement(er.div,{ref:cd(a,t),...s,"cmdk-separator":"",role:"separator"})}),V0e=P.forwardRef((e,t)=>{let{onValueChange:r,...s}=e,a=e.value!=null,i=t8(),o=Mu(l=>l.search),c=Mu(l=>l.selectedItemId),d=T1();return P.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),P.createElement(er.input,{ref:t,...s,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":d.listId,"aria-labelledby":d.labelId,"aria-activedescendant":c,id:d.inputId,type:"text",value:a?e.value:o,onChange:l=>{a||i.setState("search",l.target.value),r==null||r(l.target.value)}})}),q0e=P.forwardRef((e,t)=>{let{children:r,label:s="Suggestions",...a}=e,i=P.useRef(null),o=P.useRef(null),c=Mu(l=>l.selectedItemId),d=T1();return P.useEffect(()=>{if(o.current&&i.current){let l=o.current,u=i.current,h,f=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let m=l.offsetHeight;u.style.setProperty("--cmdk-list-height",m.toFixed(1)+"px")})});return f.observe(l),()=>{cancelAnimationFrame(h),f.unobserve(l)}}},[]),P.createElement(er.div,{ref:cd(i,t),...a,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":c,"aria-label":s,id:d.listId},Z_(e,l=>P.createElement("div",{ref:cd(o,d.listInnerRef),"cmdk-list-sizer":""},l)))}),W0e=P.forwardRef((e,t)=>{let{open:r,onOpenChange:s,overlayClassName:a,contentClassName:i,container:o,...c}=e;return P.createElement(w1,{open:r,onOpenChange:s},P.createElement(_1,{container:o},P.createElement(Tf,{"cmdk-overlay":"",className:a}),P.createElement(Pf,{"aria-label":e.label,"cmdk-dialog":"",className:i},P.createElement(rH,{ref:t,...c}))))}),H0e=P.forwardRef((e,t)=>Mu(r=>r.filtered.count===0)?P.createElement(er.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),G0e=P.forwardRef((e,t)=>{let{progress:r,children:s,label:a="Loading...",...i}=e;return P.createElement(er.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":r,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},Z_(e,o=>P.createElement("div",{"aria-hidden":!0},o)))}),Ji=Object.assign(rH,{List:q0e,Item:F0e,Input:V0e,Group:z0e,Separator:U0e,Dialog:W0e,Empty:H0e,Loading:G0e});function K0e(e,t){let r=e.nextElementSibling;for(;r;){if(r.matches(t))return r;r=r.nextElementSibling}}function X0e(e,t){let r=e.previousElementSibling;for(;r;){if(r.matches(t))return r;r=r.previousElementSibling}}function nH(e){let t=P.useRef(e);return pf(()=>{t.current=e}),t}var pf=typeof window>"u"?P.useEffect:P.useLayoutEffect;function mm(e){let t=P.useRef();return t.current===void 0&&(t.current=e()),t}function Mu(e){let t=t8(),r=()=>e(t.snapshot());return P.useSyncExternalStore(t.subscribe,r,r)}function sH(e,t,r,s=[]){let a=P.useRef(),i=T1();return pf(()=>{var o;let c=(()=>{var l;for(let u of r){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(l=u.current.textContent)==null?void 0:l.trim():a.current}})(),d=s.map(l=>l.trim());i.value(e,c,d),(o=t.current)==null||o.setAttribute(fm,c),a.current=c}),a}var Y0e=()=>{let[e,t]=P.useState(),r=mm(()=>new Map);return pf(()=>{r.current.forEach(s=>s()),r.current=new Map},[e]),(s,a)=>{r.current.set(s,a),t({})}};function Z0e(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function Z_({asChild:e,children:t},r){return e&&P.isValidElement(t)?P.cloneElement(Z0e(t),{ref:t.ref},r(t.props.children)):r(t)}var Q0e={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const r8=P.forwardRef(({className:e,...t},r)=>n.jsx(Ji,{ref:r,className:We("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));r8.displayName=Ji.displayName;const aH=P.forwardRef(({className:e,...t},r)=>n.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[n.jsx(Ln,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),n.jsx(Ji.Input,{ref:r,className:We("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));aH.displayName=Ji.Input.displayName;const n8=P.forwardRef(({className:e,...t},r)=>n.jsx(Ji.List,{ref:r,className:We("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));n8.displayName=Ji.List.displayName;const s8=P.forwardRef((e,t)=>n.jsx(Ji.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));s8.displayName=Ji.Empty.displayName;const a8=P.forwardRef(({className:e,...t},r)=>n.jsx(Ji.Group,{ref:r,className:We("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));a8.displayName=Ji.Group.displayName;const J0e=P.forwardRef(({className:e,...t},r)=>n.jsx(Ji.Separator,{ref:r,className:We("-mx-1 h-px bg-border",e),...t}));J0e.displayName=Ji.Separator.displayName;const i8=P.forwardRef(({className:e,...t},r)=>n.jsx(Ji.Item,{ref:r,className:We("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...t}));i8.displayName=Ji.Item.displayName;var Q_="Popover",[iH,uet]=ta(Q_,[Cc]),P1=Cc(),[exe,Ku]=iH(Q_),oH=e=>{const{__scopePopover:t,children:r,open:s,defaultOpen:a,onOpenChange:i,modal:o=!1}=e,c=P1(t),d=P.useRef(null),[l,u]=P.useState(!1),[h,f]=Yi({prop:s,defaultProp:a??!1,onChange:i,caller:Q_});return n.jsx(p1,{...c,children:n.jsx(exe,{scope:t,contentId:xa(),triggerRef:d,open:h,onOpenChange:f,onOpenToggle:P.useCallback(()=>f(m=>!m),[f]),hasCustomAnchor:l,onCustomAnchorAdd:P.useCallback(()=>u(!0),[]),onCustomAnchorRemove:P.useCallback(()=>u(!1),[]),modal:o,children:r})})};oH.displayName=Q_;var lH="PopoverAnchor",txe=P.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=Ku(lH,r),i=P1(r),{onCustomAnchorAdd:o,onCustomAnchorRemove:c}=a;return P.useEffect(()=>(o(),()=>c()),[o,c]),n.jsx(yg,{...i,...s,ref:t})});txe.displayName=lH;var cH="PopoverTrigger",dH=P.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=Ku(cH,r),i=P1(r),o=Ir(t,a.triggerRef),c=n.jsx(er.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":pH(a.open),...s,ref:o,onClick:kt(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?c:n.jsx(yg,{asChild:!0,...i,children:c})});dH.displayName=cH;var o8="PopoverPortal",[rxe,nxe]=iH(o8,{forceMount:void 0}),uH=e=>{const{__scopePopover:t,forceMount:r,children:s,container:a}=e,i=Ku(o8,t);return n.jsx(rxe,{scope:t,forceMount:r,children:n.jsx(Gs,{present:r||i.open,children:n.jsx(mg,{asChild:!0,container:a,children:s})})})};uH.displayName=o8;var Ep="PopoverContent",hH=P.forwardRef((e,t)=>{const r=nxe(Ep,e.__scopePopover),{forceMount:s=r.forceMount,...a}=e,i=Ku(Ep,e.__scopePopover);return n.jsx(Gs,{present:s||i.open,children:i.modal?n.jsx(axe,{...a,ref:t}):n.jsx(ixe,{...a,ref:t})})});hH.displayName=Ep;var sxe=Eu("PopoverContent.RemoveScroll"),axe=P.forwardRef((e,t)=>{const r=Ku(Ep,e.__scopePopover),s=P.useRef(null),a=Ir(t,s),i=P.useRef(!1);return P.useEffect(()=>{const o=s.current;if(o)return $_(o)},[]),n.jsx(b1,{as:sxe,allowPinchZoom:!0,children:n.jsx(fH,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:kt(e.onCloseAutoFocus,o=>{var c;o.preventDefault(),i.current||(c=r.triggerRef.current)==null||c.focus()}),onPointerDownOutside:kt(e.onPointerDownOutside,o=>{const c=o.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,l=c.button===2||d;i.current=l},{checkForDefaultPrevented:!1}),onFocusOutside:kt(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),ixe=P.forwardRef((e,t)=>{const r=Ku(Ep,e.__scopePopover),s=P.useRef(!1),a=P.useRef(!1);return n.jsx(fH,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,c;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(s.current||(c=r.triggerRef.current)==null||c.focus(),i.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:i=>{var d,l;(d=e.onInteractOutside)==null||d.call(e,i),i.defaultPrevented||(s.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;((l=r.triggerRef.current)==null?void 0:l.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),fH=P.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:l,onInteractOutside:u,...h}=e,f=Ku(Ep,r),m=P1(r);return L_(),n.jsx(y1,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:i,children:n.jsx(Fu,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:c,onPointerDownOutside:d,onFocusOutside:l,onDismiss:()=>f.onOpenChange(!1),children:n.jsx(g1,{"data-state":pH(f.open),role:"dialog",id:f.contentId,...m,...h,ref:t,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),mH="PopoverClose",oxe=P.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=Ku(mH,r);return n.jsx(er.button,{type:"button",...s,ref:t,onClick:kt(e.onClick,()=>a.onOpenChange(!1))})});oxe.displayName=mH;var lxe="PopoverArrow",cxe=P.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=P1(r);return n.jsx(x1,{...a,...s,ref:t})});cxe.displayName=lxe;function pH(e){return e?"open":"closed"}var dxe=oH,uxe=dH,hxe=uH,gH=hH;const hi=dxe,fi=uxe,Za=P.forwardRef(({className:e,align:t="center",sideOffset:r=4,...s},a)=>n.jsx(hxe,{children:n.jsx(gH,{ref:a,align:t,sideOffset:r,className:We("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})}));Za.displayName=gH.displayName;const fxe=["Vestidos","Blusas","Calas","Saias","Conjuntos","Acessrios","Blazers","Shorts","Casacos","Macaces","Camisas"],mxe=["Preto","Branco","Bege","Rosa","Azul","Verde","Vermelho","Marrom","Cinza","Estampado"],pxe=["elegante","clssico","minimal","romntico","casual","moderno","fashion","sexy_chic"],gxe=["trabalho","jantar","evento","igreja","viagem","dia_a_dia_chic"],xxe=["ajustado","regular","soltinho","oversized","acinturado","slim","reto","amplo"],JR={trabalho:"Trabalho",jantar:"Jantar",evento:"Evento",igreja:"Igreja",viagem:"Viagem",dia_a_dia_chic:"Dia a dia chic"},vxe=["premium","bsico","tendncia","atemporal","verstil","sofisticado","confortvel","leve","estruturado","fluido","minimalista","estampado","bordado","renda","cetim","linho","algodo","seda","alfaiataria","vero","inverno","meia-estao","praia","escritrio","noite"],yxe={category:"Categoria",color:"Cor",style:"Estilo",occasion:"Ocasio",modeling:"Modelagem"},bxe={category:fxe,color:mxe,style:pxe,occasion:gxe,modeling:xxe},wxe={vestido:"Vestidos",blazer:"Blazers",cala:"Calas",camisa:"Camisas",saia:"Saias",conjunto:"Conjuntos",short:"Shorts",casaco:"Casacos",macaco:"Macaces",blusa:"Blusas"},_xe={preto:"Preto",branco:"Branco",bege:"Bege",rosa:"Rosa",azul:"Azul",verde:"Verde",vermelho:"Vermelho",marrom:"Marrom",cinza:"Cinza",estampado:"Estampado"};function eM(e,t){return t?e==="category"?wxe[t.toString().toLowerCase()]||t:e==="color"?_xe[t.toString().toLowerCase()]||t:e==="occasion"?Array.isArray(t)?t:typeof t=="string"?[t]:[]:t:e==="occasion"?[]:null}function jxe({confidence:e}){return e>=.8?n.jsx(Ae,{variant:"secondary",className:"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300 text-xs",children:"Alta"}):e>=.5?n.jsx(Ae,{variant:"secondary",className:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900 dark:text-yellow-300 text-xs",children:"Mdia"}):n.jsx(Ae,{variant:"secondary",className:"bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-300 text-xs",children:"Baixa"})}function Nxe({fieldKey:e,aiValue:t,confidence:r,editedValue:s,isSelected:a,onValueChange:i,onSelectionChange:o}){const c=bxe[e]||[],d=s||"";return n.jsxs("div",{className:"border rounded-lg p-3 space-y-2 bg-background",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(va,{id:`select-${e}`,checked:a,onCheckedChange:l=>o(l===!0)}),n.jsx("label",{htmlFor:`select-${e}`,className:"font-medium text-sm flex-1 cursor-pointer",children:yxe[e]}),n.jsx(jxe,{confidence:r})]}),e==="occasion"?n.jsx("div",{className:"grid grid-cols-2 gap-1.5 mt-1 p-2 border rounded bg-accent/5",children:c.map(l=>n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx(va,{id:`sug-occ-${l}`,checked:Array.isArray(s)&&s.includes(l),onCheckedChange:u=>{const h=Array.isArray(s)?s:[],f=u?[...h,l]:h.filter(m=>m!==l);i(f)}}),n.jsx("label",{htmlFor:`sug-occ-${l}`,className:"text-[11px] truncate cursor-pointer",children:JR[l]||l})]},l))}):n.jsxs(Kt,{value:d,onValueChange:l=>i(l||null),children:[n.jsx(Vt,{className:"w-full h-9",children:n.jsx(Xt,{placeholder:"Selecione..."})}),n.jsx(qt,{children:c.map(l=>n.jsx(ze,{value:l,className:"capitalize",children:l},l))})]}),t&&JSON.stringify(s)!==JSON.stringify(t)&&n.jsxs("p",{className:"text-[10px] text-muted-foreground italic",children:["Sugesto original: ",e==="occasion"&&Array.isArray(t)?t.map(l=>JR[l]||l).join(", "):t]})]})}function Sxe({tags:e,onTagsChange:t}){const[r,s]=P.useState(""),[a,i]=P.useState(!1),o=P.useRef(null),c=vxe.filter(h=>!e.includes(h)&&h.toLowerCase().includes(r.toLowerCase())).slice(0,6),d=h=>{var m;const f=h.trim().toLowerCase();f&&!e.includes(f)&&t([...e,f]),s(""),i(!1),(m=o.current)==null||m.focus()},l=h=>{t(e.filter(f=>f!==h))},u=h=>{h.key==="Enter"&&r.trim()&&(h.preventDefault(),d(r))};return n.jsxs("div",{className:"border rounded-lg p-3 space-y-3 bg-background",children:[n.jsx("span",{className:"font-medium text-sm",children:"Tags Sugeridas"}),n.jsx("div",{className:"flex flex-wrap gap-1.5",children:e.map(h=>n.jsxs(Ae,{variant:"secondary",className:"capitalize flex items-center gap-1 pr-1",children:[h,n.jsx("button",{type:"button",onClick:()=>l(h),className:"ml-1 hover:bg-muted rounded-full p-0.5",children:n.jsx(an,{className:"h-3 w-3"})})]},h))}),n.jsxs(hi,{open:a,onOpenChange:i,children:[n.jsx(fi,{asChild:!0,children:n.jsxs("div",{className:"relative",children:[n.jsx(Qe,{ref:o,value:r,onChange:h=>{s(h.target.value),h.target.value&&i(!0)},onFocus:()=>r&&i(!0),onKeyDown:u,placeholder:"Adicionar tag...",className:"pr-8"}),n.jsx(he,{type:"button",variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 -translate-y-1/2 h-6 w-6 p-0",onClick:()=>r&&d(r),children:n.jsx(An,{className:"h-4 w-4"})})]})}),c.length>0&&n.jsx(Za,{className:"p-0 w-[var(--radix-popover-trigger-width)]",align:"start",children:n.jsx(r8,{children:n.jsxs(n8,{children:[n.jsx(s8,{children:"Nenhuma sugesto"}),n.jsx(a8,{children:c.map(h=>n.jsx(i8,{value:h,onSelect:()=>d(h),className:"capitalize cursor-pointer",children:h},h))})]})})})]})]})}function Cxe({analysis:e,onApply:t,onApplyAll:r,onApplySelected:s,onDismiss:a,currentValues:i}){const o=["category","color","style","occasion","modeling"],c={category:"categoria",color:"cor",style:"estilo",occasion:"ocasiao",modeling:"modelagem"},[d,l]=P.useState(()=>{const v={category:{selected:!0,value:null},color:{selected:!0,value:null},style:{selected:!0,value:null},occasion:{selected:!0,value:[]},modeling:{selected:!0,value:null},tags:[]};return o.forEach(x=>{const y=e[c[x]],b=eM(x,y.value);v[x]={selected:!!b,value:b}}),v.tags=e.tags_extras||[],v}),u=(v,x)=>{l(y=>({...y,[v]:{...y[v],value:x}}))},h=(v,x)=>{l(y=>({...y,[v]:{...y[v],selected:x}}))},f=v=>{l(x=>({...x,tags:v}))},m=()=>{s(d)},p=()=>{const v={...d};o.forEach(x=>{v[x]={...v[x],selected:!0}}),s(v)},g=o.filter(v=>d[v].selected&&d[v].value).length;return n.jsxs("div",{className:"bg-accent/30 border border-accent rounded-xl p-4 space-y-4 animate-fade-in",children:[n.jsxs("div",{className:"flex items-center gap-2 text-accent-foreground",children:[n.jsx(Wr,{className:"h-5 w-5"}),n.jsx("h4",{className:"font-medium",children:"Sugestes da IA"}),n.jsx("span",{className:"text-xs text-muted-foreground ml-auto",children:"Edite os valores antes de aplicar"})]}),n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:o.map(v=>{const x=e[c[v]];return n.jsx(Nxe,{fieldKey:v,aiValue:eM(v,x.value),confidence:x.confidence,editedValue:d[v].value,isSelected:d[v].selected,onValueChange:y=>u(v,y),onSelectionChange:y=>h(v,y)},v)})}),n.jsx(Sxe,{tags:d.tags,onTagsChange:f}),n.jsxs("div",{className:"flex flex-wrap gap-2 pt-2",children:[n.jsxs(he,{type:"button",size:"sm",onClick:m,disabled:g===0,className:"flex-1 min-w-[140px]",children:[n.jsx(xn,{className:"h-4 w-4 mr-1"}),"Aplicar selecionados (",g,")"]}),n.jsx(he,{type:"button",size:"sm",variant:"secondary",onClick:p,className:"flex-1 min-w-[140px]",children:"Aplicar todas sugestes"}),n.jsx(he,{type:"button",size:"sm",variant:"ghost",onClick:a,children:"Dispensar"})]})]})}const v0=5;function Exe({images:e,mainImageIndex:t,videoUrl:r,onImagesChange:s,onVideoChange:a,userId:i}){const[o,c]=P.useState(!1),[d,l]=P.useState(!1),[u,h]=P.useState(null),f=async b=>{const j=b.target.files;if(!j||j.length===0)return;const T=v0-e.length;if(T<=0){de.error(`Mximo de ${v0} imagens`);return}const O=Array.from(j).slice(0,T);c(!0);try{const R=[];for(const D of O){const L=`${i}/${Date.now()}-${D.name}`,{error:q}=await ce.storage.from("products").upload(L,D);if(q)throw q;const{data:X}=ce.storage.from("products").getPublicUrl(L);R.push(X.publicUrl)}s([...e,...R],t),de.success(`${R.length} imagem(ns) enviada(s)`)}catch(R){console.error("Error uploading images:",R),de.error("Erro ao enviar imagens")}finally{c(!1),b.target.value=""}},m=async b=>{var T;const j=(T=b.target.files)==null?void 0:T[0];if(j){if(j.size>50*1024*1024){de.error("Vdeo muito grande (mx 50MB)");return}l(!0);try{const O=`${i}/videos/${Date.now()}-${j.name}`,{error:R}=await ce.storage.from("products").upload(O,j);if(R)throw R;const{data:D}=ce.storage.from("products").getPublicUrl(O);a(D.publicUrl),de.success("Vdeo enviado!")}catch(O){console.error("Error uploading video:",O),de.error("Erro ao enviar vdeo")}finally{l(!1),b.target.value=""}}},p=b=>{const j=e.filter((O,R)=>R!==b);let T=t;b===t?T=0:b<t&&(T=t-1),s(j,Math.min(T,j.length-1))},g=b=>{s(e,b),de.success("Imagem principal atualizada")},v=b=>{h(b)},x=(b,j)=>{if(b.preventDefault(),u===null||u===j)return;const T=[...e],[O]=T.splice(u,1);T.splice(j,0,O);let R=t;t===u?R=j:u<t&&j>=t?R=t-1:u>t&&j<=t&&(R=t+1),s(T,R),h(j)},y=()=>{h(null)};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-sm font-medium",children:["Imagens (",e.length,"/",v0,")"]}),e.length<v0&&n.jsxs(he,{type:"button",variant:"outline",size:"sm",onClick:()=>{var b;return(b=document.getElementById("multi-image-upload"))==null?void 0:b.click()},disabled:o,children:[n.jsx(Gh,{className:"h-4 w-4 mr-1"}),o?"Enviando...":"Adicionar"]}),n.jsx("input",{id:"multi-image-upload",type:"file",accept:"image/*",multiple:!0,onChange:f,className:"hidden"})]}),n.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-5 gap-2",children:[e.map((b,j)=>n.jsxs("div",{draggable:!0,onDragStart:()=>v(j),onDragOver:T=>x(T,j),onDragEnd:y,className:`relative aspect-square rounded-lg overflow-hidden border-2 cursor-move group ${j===t?"border-accent ring-2 ring-accent/30":"border-border"} ${u===j?"opacity-50":""}`,children:[n.jsx("img",{src:b,alt:`Imagem ${j+1}`,className:"w-full h-full object-cover"}),n.jsxs("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-1",children:[n.jsx(he,{type:"button",size:"icon",variant:"ghost",className:"h-7 w-7 text-white hover:bg-white/20",onClick:()=>g(j),title:"Definir como principal",children:n.jsx(ki,{className:`h-4 w-4 ${j===t?"fill-yellow-400 text-yellow-400":""}`})}),n.jsx(he,{type:"button",size:"icon",variant:"ghost",className:"h-7 w-7 text-white hover:bg-white/20",onClick:()=>p(j),title:"Remover",children:n.jsx(an,{className:"h-4 w-4"})})]}),j===t&&n.jsx("span",{className:"absolute top-1 left-1 text-[10px] bg-accent text-accent-foreground px-1.5 py-0.5 rounded",children:"Principal"}),n.jsx("div",{className:"absolute bottom-1 right-1 text-white/60",children:n.jsx(nk,{className:"h-3 w-3"})})]},b)),e.length<v0&&n.jsx("button",{type:"button",onClick:()=>{var b;return(b=document.getElementById("multi-image-upload"))==null?void 0:b.click()},className:"aspect-square rounded-lg border-2 border-dashed border-border hover:border-accent flex items-center justify-center transition-colors",children:n.jsx(Gh,{className:"h-5 w-5 text-muted-foreground"})})]}),n.jsxs("div",{className:"pt-4 border-t border-border",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("span",{className:"text-sm font-medium flex items-center gap-1.5",children:[n.jsx(Rae,{className:"h-4 w-4"}),"Vdeo (opcional)"]}),!r&&n.jsxs(he,{type:"button",variant:"outline",size:"sm",onClick:()=>{var b;return(b=document.getElementById("video-upload"))==null?void 0:b.click()},disabled:d,children:[n.jsx(Gh,{className:"h-4 w-4 mr-1"}),d?"Enviando...":"Adicionar vdeo"]}),n.jsx("input",{id:"video-upload",type:"file",accept:"video/*",onChange:m,className:"hidden"})]}),r&&n.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden bg-black",children:[n.jsx("video",{src:r,controls:!0,className:"w-full h-full object-contain"}),n.jsx(he,{type:"button",size:"icon",variant:"secondary",className:"absolute top-2 right-2 h-7 w-7",onClick:()=>a(null),children:n.jsx(an,{className:"h-4 w-4"})})]})]})]})}const kxe={"elegante estratgica":["elegante","clssico","minimal"],"romntica sofisticada":["romntico","elegante","fashion"],"moderna urbana":["moderno","casual","minimal"],"clssica atemporal":["clssico","elegante","minimal"],"fashion ousada":["fashion","moderno","sexy_chic"],"casual chic":["casual","moderno","minimal"]},Axe={trabalho:["trabalho","office","reunio","escritrio"],casual:["casual","dia a dia","passeio","lazer"],festa:["festa","balada","evento","especial"]},Txe={neutros:["preto","branco","bege","cinza","nude","off white"],cores:["azul","verde","vermelho","rosa","amarelo","laranja","roxo","lils"],estampado:["estampado","floral","animal print"]};function Ld(e){return e?e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""):""}function Pxe(e,t,r){const s=[];let a=0;const i=Ld(e.category),o=Ld(e.style),c=Ld(e.occasion),d=Ld(e.color),l=Ld(t.style_title),u=r.map(h=>Ld(h.answer)).join(" ");if(r.map(h=>Ld(h.question)).join(" "),i&&({vestidos:["vestido","dress"],blusas:["blusa","top","camisa"],calas:["calca","pants"],saias:["saia","skirt"],conjuntos:["conjunto","set"],blazers:["blazer","casaco"]}[i]||[i]).some(m=>u.includes(m))&&(a+=3,s.push({type:"category",label:`Categoria ${e.category}`,points:3})),o&&l){if(l.includes(o))a+=3,s.push({type:"style",label:`Estilo ${e.style}`,points:3});else for(const[h,f]of Object.entries(kxe))if(l.includes(Ld(h))&&f.includes(o)){a+=3,s.push({type:"style",label:`Estilo combina com ${t.style_title}`,points:3});break}}if(c){for(const[h,f]of Object.entries(Axe))if(f.some(m=>c.includes(m))&&f.some(m=>u.includes(m))){a+=2,s.push({type:"occasion",label:`Ocasio ${e.occasion}`,points:2});break}}if(d){if(u.includes(d))a+=2,s.push({type:"color",label:`Cor ${e.color}`,points:2});else for(const[h,f]of Object.entries(Txe))if(f.includes(d)&&(u.includes(h)||u.includes(f[0]))){a+=2,s.push({type:"color",label:`Cor ${e.color}`,points:2});break}}return t.size&&e.stock_by_size&&(e.stock_by_size[t.size]||0)>0&&(a+=5,s.push({type:"size",label:`Tamanho ${t.size} disponvel`,points:5})),a===0?null:{customer_id:t.id,score:a,reasons:s}}async function xH(e){try{const{data:t,error:r}=await ce.from("product_catalog").select("id, category, color, style, occasion, stock_by_size, name").eq("id",e).single();if(r||!t)return{success:!1,count:0,error:"Produto no encontrado"};const{data:s,error:a}=await ce.from("customers").select("id, phone, name, size, style_title");if(a)return{success:!1,count:0,error:"Erro ao carregar clientes"};const i=(s||[]).filter(f=>f.style_title);if(i.length===0)return{success:!0,count:0};const o=i.map(f=>f.id),{data:c}=await ce.from("quiz_responses").select("customer_id, question, answer").in("customer_id",o),d={};(c||[]).forEach(f=>{d[f.customer_id]||(d[f.customer_id]=[]),d[f.customer_id].push(f)});const l=[];for(const f of i){const m=d[f.id]||[],p=Pxe(t,f,m);p&&l.push(p)}if(l.length===0)return await ce.from("customer_product_suggestions").delete().eq("product_id",e),{success:!0,count:0};await ce.from("customer_product_suggestions").delete().eq("product_id",e);const u=l.map(f=>({product_id:e,customer_id:f.customer_id,score:f.score,reasons:JSON.parse(JSON.stringify(f.reasons))})),{error:h}=await ce.from("customer_product_suggestions").insert(u);return h?(console.error("Error inserting suggestions:",h),{success:!1,count:0,error:"Erro ao salvar sugestes"}):{success:!0,count:l.length}}catch(t){return console.error("Error in suggestCustomersForProduct:",t),{success:!1,count:0,error:"Erro inesperado"}}}function Oxe({productId:e,productName:t}){const r=fr(),[s,a]=P.useState([]),[i,o]=P.useState(!0),[c,d]=P.useState(!1),[l,u]=P.useState(null);P.useEffect(()=>{h()},[e]);const h=async()=>{try{const{data:y,error:b}=await ce.from("customer_product_suggestions").select("*").eq("product_id",e).order("score",{ascending:!1});if(b)throw b;if(!y||y.length===0){a([]);return}const j=y.map(D=>D.customer_id),{data:T}=await ce.from("customers").select("id, name, phone, size, style_title").in("id",j),O={};(T||[]).forEach(D=>{O[D.id]=D});const R=y.filter(D=>O[D.customer_id]).map(D=>({...D,reasons:D.reasons,customer:O[D.customer_id]}));a(R)}catch(y){console.error("Error loading suggestions:",y)}finally{o(!1)}},f=async()=>{d(!0);try{const y=await xH(e);y.success?(de.success(`${y.count} cliente(s) sugerido(s)`),h()):de.error(y.error||"Erro ao atualizar sugestes")}catch{de.error("Erro ao atualizar sugestes")}finally{d(!1)}},m=y=>{const b=y.replace(/\D/g,"");return b.length===11?`(${b.slice(0,2)}) ${b.slice(2,7)}-${b.slice(7)}`:y},p=y=>{const b=y.customer.name||"",j=y.customer.size,T=j?` Tenho no seu tamanho ${j}`:"";return`Oi${b?` ${b}`:""}! Chegou uma pea que tem tudo a ver com voc ${t}${T} `},g=y=>{const b=p(y);navigator.clipboard.writeText(b),u(y.id),de.success("Mensagem copiada!"),setTimeout(()=>u(null),2e3)},v=async y=>{await ce.from("customer_product_suggestions").update({notified:!0}).eq("id",y),a(b=>b.map(j=>j.id===y?{...j,notified:!0}:j))},x=y=>{switch(y){case"style":return n.jsx(Wr,{className:"h-3 w-3"});case"size":return n.jsx(bae,{className:"h-3 w-3"});case"category":return n.jsx(Oa,{className:"h-3 w-3"});case"color":return n.jsx(lk,{className:"h-3 w-3"});case"occasion":return n.jsx(is,{className:"h-3 w-3"});default:return null}};return i?n.jsx(De,{children:n.jsx(Be,{className:"py-8 flex justify-center",children:n.jsx(At,{className:"h-6 w-6 animate-spin text-muted-foreground"})})}):n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Mt,{className:"text-lg flex items-center gap-2",children:[n.jsx(wa,{className:"h-5 w-5"}),"Clientes para avisar",s.length>0&&n.jsx(Ae,{variant:"secondary",children:s.length})]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:f,disabled:c,className:"gap-1",children:[c?n.jsx(At,{className:"h-4 w-4 animate-spin"}):n.jsx(en,{className:"h-4 w-4"}),"Atualizar"]})]})}),n.jsx(Be,{children:s.length===0?n.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[n.jsx(wa,{className:"h-10 w-10 mx-auto mb-3 opacity-50"}),n.jsx("p",{className:"mb-2",children:"Nenhum cliente sugerido ainda."}),n.jsx("p",{className:"text-sm",children:"Clientes com quiz completado sero sugeridos com base no match de estilo."})]}):n.jsx("div",{className:"space-y-3",children:s.map(y=>n.jsx("div",{className:`border rounded-lg p-4 ${y.notified?"bg-muted/30 border-border":"bg-card border-primary/20"}`,children:n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("button",{onClick:()=>r(`/dashboard/clientes/${y.customer.id}`),className:"font-medium hover:text-primary transition-colors truncate",children:y.customer.name||"Cliente sem nome"}),n.jsxs(Ae,{variant:y.score>=10?"default":"secondary",className:"shrink-0",children:["Score: ",y.score]}),y.notified&&n.jsxs(Ae,{variant:"outline",className:"shrink-0 text-green-600",children:[n.jsx(xn,{className:"h-3 w-3 mr-1"}),"Avisado"]})]}),n.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[m(y.customer.phone),y.customer.size&&`  Tam. ${y.customer.size}`,y.customer.style_title&&`  ${y.customer.style_title}`]}),n.jsx("div",{className:"flex flex-wrap gap-1.5",children:y.reasons.map((b,j)=>n.jsxs(Ae,{variant:"outline",className:"text-xs gap-1 bg-background",children:[x(b.type),b.label,n.jsxs("span",{className:"text-primary",children:["+",b.points]})]},j))})]}),n.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[n.jsx(he,{variant:"outline",size:"sm",onClick:()=>g(y),className:"gap-1",children:l===y.id?n.jsx(xn,{className:"h-4 w-4"}):n.jsx(Ia,{className:"h-4 w-4"})}),n.jsxs("a",{href:No(p(y)),target:"_blank",rel:"noopener noreferrer",onClick:()=>v(y.id),className:"inline-flex items-center justify-center gap-1.5 h-9 px-3 rounded-md text-sm font-medium bg-[#25D366] text-white hover:bg-[#1EBE5D] transition-colors",children:[n.jsx(nn,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"WhatsApp"})]})]})]})},y.id))})})]})}const Rxe=["34","36","38","40","42","44","46"],Mxe=["PP","P","M","G","GG"],tM=[...Rxe,...Mxe];function kp(e){return[...e].sort((t,r)=>{const s=tM.indexOf(t),a=tM.indexOf(r);return s!==-1&&a!==-1?s-a:s!==-1?-1:a!==-1?1:t.localeCompare(r)})}function Ixe(e){return!e||typeof e!="object"?0:Object.values(e).reduce((r,s)=>r+(typeof s=="number"?s:0),0)}const Dxe=["PP","P","M","G","GG"],Lxe=["34","36","38","40","42","44","46"];function Bxe({stock:e,onChange:t}){const r=(a,i)=>{const o=parseInt(i)||0,c={...e,[a]:Math.max(0,o)};t(c)},s=Object.values(e).reduce((a,i)=>a+(i||0),0);return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Le,{className:"text-base",children:"Estoque por Tamanho"}),n.jsxs("span",{className:"text-sm text-muted-foreground",children:["Total: ",n.jsx("span",{className:"font-medium text-foreground",children:s})," unidades"]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-xs text-muted-foreground block mb-2",children:"Tamanhos letras"}),n.jsx("div",{className:"grid grid-cols-5 gap-2",children:Dxe.map(a=>n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-xs font-medium text-center block",children:a}),n.jsx(Qe,{type:"number",min:"0",value:e[a]||"",onChange:i=>r(a,i.target.value),placeholder:"0",className:"text-center h-9"})]},a))})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-xs text-muted-foreground block mb-2",children:"Tamanhos numricos"}),n.jsx("div",{className:"grid grid-cols-7 gap-2",children:Lxe.map(a=>n.jsxs("div",{className:"space-y-1",children:[n.jsx("label",{className:"text-xs font-medium text-center block",children:a}),n.jsx(Qe,{type:"number",min:"0",value:e[a]||"",onChange:i=>r(a,i.target.value),placeholder:"0",className:"text-center h-9"})]},a))})]})]})}function vH(e){if(!e||typeof e!="object")return[];const r=Object.entries(e).filter(([s,a])=>typeof a=="number"&&a>0).map(([s])=>s);return kp(r)}function rM(e,t){return!e||typeof e!="object"?0:e[t]||0}function $xe(e,t){return rM(e,t)>0&&rM(e,t)<=2}function Fxe({discountType:e,discountValue:t,onDiscountTypeChange:r,onDiscountValueChange:s,label:a="Desconto"}){return n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:a}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(Kt,{value:e||"_none",onValueChange:i=>r(i==="_none"?null:i),children:[n.jsx(Vt,{className:"w-[140px]",children:n.jsx(Xt,{placeholder:"Sem desconto"})}),n.jsxs(qt,{className:"bg-background z-50",children:[n.jsx(ze,{value:"_none",children:"Sem desconto"}),n.jsx(ze,{value:"percentage",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(jo,{className:"h-3 w-3"})," Porcentagem"]})}),n.jsx(ze,{value:"fixed",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ws,{className:"h-3 w-3"})," Valor fixo"]})})]})]}),e&&n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Qe,{type:"number",min:"0",step:e==="percentage"?"1":"0.01",max:e==="percentage"?"100":void 0,value:t??"",onChange:i=>s(i.target.value?parseFloat(i.target.value):null),placeholder:e==="percentage"?"Ex: 10":"Ex: 15.00",className:"pr-8"}),n.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm",children:e==="percentage"?"%":"R$"})]})]}),e&&t&&n.jsx("p",{className:"text-xs text-muted-foreground",children:e==="percentage"?`${t}% de desconto ser aplicado`:`R$ ${t.toFixed(2)} de desconto ser aplicado`})]})}function zxe(e,t,r){return!t||!r?e:t==="percentage"?e*(1-r/100):Math.max(0,e-r)}const R3={Blusas:.25,Vestidos:.45,Calas:.6,Blazers:.7,Casacos:.8,Camisas:.25,Saias:.3,Shorts:.25,Conjuntos:.85,Macaces:.85,Acessrios:.2},$c={length:30,width:20,height:10},Uxe=["Vestidos","Blusas","Calas","Saias","Conjuntos","Acessrios","Blazers","Shorts","Casacos","Macaces","Camisas"],y0=["Preto","Branco","Bege","Rosa","Azul","Verde","Vermelho","Marrom","Cinza","Estampado","Off White","Chocolate","Menta","Nude","Caramelo","Mostarda","Vinho","Laranja","Amarelo","Lils","Roxo","Coral"],Vxe=["elegante","clssico","minimal","romntico","casual","moderno","fashion","sexy_chic"],qxe=["trabalho","jantar","evento","igreja","viagem","dia_a_dia_chic"],Wxe=["ajustado","regular","soltinho","oversized","acinturado","slim","reto","amplo"],Hxe={trabalho:"Trabalho",jantar:"Jantar",evento:"Evento",igreja:"Igreja",viagem:"Viagem",dia_a_dia_chic:"Dia a dia chic"},zC={preto:"Preto",branco:"Branco",bege:"Bege",rosa:"Rosa",azul:"Azul",verde:"Verde",vermelho:"Vermelho",marrom:"Marrom",cinza:"Cinza",estampado:"Estampado","off white":"Off White",offwhite:"Off White","off-white":"Off White",chocolate:"Chocolate",menta:"Menta",nude:"Nude",caramelo:"Caramelo",mostarda:"Mostarda",vinho:"Vinho",laranja:"Laranja",amarelo:"Amarelo",lilas:"Lils",lils:"Lils",roxo:"Roxo",coral:"Coral"};function Gxe(e){if(!e)return null;const t=e.trim().toLowerCase();return zC[t]?zC[t]:e.trim().split(/\s+/).map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" ")}const nM={vestido:"Vestidos",blazer:"Blazers",cala:"Calas",camisa:"Camisas",saia:"Saias",conjunto:"Conjuntos",short:"Shorts",casaco:"Casacos",macaco:"Macaces",blusa:"Blusas"},sM=zC;function Kxe({open:e,onOpenChange:t,product:r,onSuccess:s,userId:a}){const[i,o]=P.useState(!1),[c,d]=P.useState(!1),[l,u]=P.useState([]),[h,f]=P.useState(0),[m,p]=P.useState(null),[g,v]=P.useState({}),[x,y]=P.useState({name:"",sku:null,category:null,price:0,color:null,style:null,modeling:null,sizes:[],is_active:!0,image_url:null,tags:[],description:null,occasion:[],weight_kg:.3,length_cm:$c.length,width_cm:$c.width,height_cm:$c.height,discount_type:null,discount_value:null}),{isAnalyzing:b,analysisResult:j,analyzeImage:T,clearAnalysis:O}=Oq(),[R,D]=P.useState(y0);P.useEffect(()=>{if(r){const N=Gxe(r.color);y({...r,sku:r.sku||r.group_key||null,color:N,modeling:r.modeling??null,sizes:r.sizes||[],tags:r.tags||[],occasion:Array.isArray(r.occasion)?r.occasion:r.occasion?[r.occasion]:[]}),u(r.images||(r.image_url?[r.image_url]:[])),f(r.main_image_index||0),p(r.video_url||null),v(r.stock_by_size||{}),N&&!y0.includes(N)?D([...y0,N]):D(y0)}else y({name:"",sku:null,category:null,price:0,color:null,style:null,modeling:null,sizes:[],is_active:!0,image_url:null,tags:[],description:null,occasion:[],weight_kg:.3,length_cm:$c.length,width_cm:$c.width,height_cm:$c.height,discount_type:null,discount_value:null}),u([]),f(0),p(null),v({}),D(y0);O()},[r,e]);const L=(N,C)=>{u(N),f(C)},q=async()=>{const N=l[h]||l[0];if(!N){de.error("Envie uma imagem primeiro");return}await T(N)},X=(N,C)=>{let k=C;N==="category"?k=nM[C.toLowerCase()]||C:N==="color"&&(k=sM[C.toLowerCase()]||C),y(I=>({...I,[N]:k}))},H=()=>{if(!j)return;const N={};j.categoria.value&&(N.category=nM[j.categoria.value.toLowerCase()]||j.categoria.value),j.cor.value&&(N.color=sM[j.cor.value.toLowerCase()]||j.cor.value),j.estilo.value&&(N.style=j.estilo.value),j.ocasiao.value&&(N.occasion=j.ocasiao.value),j.modelagem.value&&(N.modeling=j.modelagem.value),y(C=>({...C,...N})),de.success("Sugestes aplicadas!")},M=N=>{const C={};["category","color","style","occasion","modeling"].forEach(I=>{I==="occasion"?N.occasion.selected&&Array.isArray(N.occasion.value)&&(C.occasion=[...new Set([...x.occasion||[],...N.occasion.value])]):N[I].selected&&N[I].value&&(C[I]=N[I].value)}),N.tags.length>0&&(C.tags=[...new Set([...x.tags,...N.tags])]),y(I=>({...I,...C})),de.success("Sugestes aplicadas!")},F=async()=>{const N=l[h]||l[0];if(!N){de.error("Adicione uma imagem do produto primeiro");return}d(!0);try{const{data:C,error:k}=await ce.functions.invoke("generate-product-description",{body:{image_url:N,product_name:x.name||null}});if(k){console.error("Edge function error:",k),de.error("Erro ao gerar descrio");return}if(C!=null&&C.error){de.error(C.error);return}if(C!=null&&C.success&&(C!=null&&C.data)){const I=C.data;let U=I.descricao_completa||"";I.diferenciais&&I.diferenciais.length>0&&(U+=`

 Diferenciais:
`,I.diferenciais.forEach($=>{U+=` ${$}
`})),I.palavras_chave&&I.palavras_chave.length>0&&(U+=`
 Tags: ${I.palavras_chave.join(", ")}`),y($=>({...$,description:U,name:$.name||I.nome_produto||$.name})),de.success("Descrio premium gerada com sucesso!"),I.frase_anuncio&&setTimeout(()=>{de.info(` Frase para anncio: "${I.frase_anuncio}"`)},1500)}}catch(C){console.error("Error generating description:",C),de.error("Erro ao conectar com o servio de IA")}finally{d(!1)}},S=()=>{const N=[];return x.style&&N.push(x.style),x.occasion&&x.occasion.length>0&&N.push(...x.occasion),x.category&&N.push(x.category.toLowerCase()),x.modeling&&N.push(x.modeling),j!=null&&j.tags_extras&&N.push(...j.tags_extras),[...new Set(N)]},E=async(N,C=!1)=>{if(N.preventDefault(),!x.name||!x.price){de.error("Nome e preo so obrigatrios");return}o(!0);try{const k=vH(g),I=l[h]||l[0]||null,U={name:x.name,sku:x.sku||null,category:x.category,price:x.price,color:x.color,style:x.style,occasion:x.occasion,modeling:x.modeling,sizes:k,is_active:x.is_active,image_url:I,tags:S(),user_id:a,images:l,video_url:m,main_image_index:h,stock_by_size:g,description:x.description,weight_kg:x.weight_kg||null,length_cm:x.length_cm||null,width_cm:x.width_cm||null,height_cm:x.height_cm||null,discount_type:x.discount_type||null,discount_value:x.discount_value||null};let $=r==null?void 0:r.id;if(r!=null&&r.id){const{error:Y}=await ce.from("product_catalog").update(U).eq("id",r.id);if(Y)throw Y;de.success("Produto atualizado!")}else{const{data:Y,error:Z}=await ce.from("product_catalog").insert(U).select("id").single();if(Z)throw Z;$=Y==null?void 0:Y.id,de.success("Produto criado!")}$&&x.is_active&&xH($).then(Y=>{Y.count>0&&de.info(`${Y.count} cliente(s) sugerido(s) para avisar!`)}),s(),C||t(!1)}catch(k){console.error("Error saving product:",k),de.error("Erro ao salvar produto")}finally{o(!1)}};return n.jsx(cn,{open:e,onOpenChange:t,children:n.jsxs(sn,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[n.jsx(fn,{children:n.jsx(dn,{className:"font-serif",children:r?"Editar Produto":"Novo Produto"})}),n.jsxs("form",{onSubmit:N=>E(N,!1),className:"space-y-6",children:[n.jsxs("div",{className:"border border-border rounded-lg p-4",children:[n.jsx(Exe,{images:l,mainImageIndex:h,videoUrl:m,onImagesChange:L,onVideoChange:p,userId:a}),l.length>0&&!j&&n.jsx(he,{type:"button",variant:"outline",onClick:q,disabled:b,className:"w-full mt-4",children:b?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),"Analisando foto..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Wr,{className:"h-4 w-4 mr-2"}),"Analisar foto e sugerir campos"]})})]}),j&&n.jsx(Cxe,{analysis:j,onApply:X,onApplyAll:H,onApplySelected:M,onDismiss:O,currentValues:{category:x.category,color:x.color,style:x.style,occasion:x.occasion,modeling:x.modeling}}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"name",children:"Nome *"}),n.jsx(Qe,{id:"name",value:x.name,onChange:N=>y(C=>({...C,name:N.target.value})),placeholder:"Nome do produto"})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"sku",children:"SKU (cdigo nico)"}),n.jsx(Qe,{id:"sku",value:x.sku||"",onChange:N=>y(C=>({...C,sku:N.target.value||null})),placeholder:"Ex: VEST-001",className:"font-mono"})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"price",children:"Preo *"}),n.jsx(aW,{id:"price",value:x.price,onChange:N=>y(C=>({...C,price:N})),placeholder:"0,00"})]}),n.jsxs("div",{children:[n.jsx(Le,{children:"Categoria"}),n.jsxs(Kt,{value:x.category||"",onValueChange:N=>y(C=>({...C,category:N})),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecione"})}),n.jsx(qt,{children:Uxe.map(N=>n.jsx(ze,{value:N,children:N},N))})]})]}),n.jsxs("div",{className:"col-span-2 space-y-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-1",children:[n.jsx(Le,{htmlFor:"weight_kg",children:"Peso (kg) *"}),x.category&&R3[x.category]&&n.jsxs(he,{type:"button",variant:"ghost",size:"sm",className:"h-6 px-2 text-xs",onClick:()=>y(N=>({...N,weight_kg:R3[N.category]})),children:["Usar sugesto: ",R3[x.category],"kg"]})]}),n.jsx(Qe,{id:"weight_kg",type:"number",step:"0.01",min:"0",max:"30",value:x.weight_kg??"",onChange:N=>y(C=>({...C,weight_kg:N.target.value?parseFloat(N.target.value):null})),placeholder:"Ex: 0.45"}),!x.weight_kg&&x.is_active&&n.jsx("p",{className:"text-xs text-amber-600 mt-1",children:" Peso obrigatrio para produtos ativos. O frete usar 0.30kg como padro."})]}),n.jsxs("div",{children:[n.jsxs(Le,{className:"text-muted-foreground text-xs mb-2 block",children:["Dimenses (cm) - opcional, padro: ",$c.length,"x",$c.width,"x",$c.height]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsx("div",{children:n.jsx(Qe,{type:"number",step:"0.1",min:"0",max:"100",value:x.length_cm??"",onChange:N=>y(C=>({...C,length_cm:N.target.value?parseFloat(N.target.value):null})),placeholder:"Comp."})}),n.jsx("div",{children:n.jsx(Qe,{type:"number",step:"0.1",min:"0",max:"100",value:x.width_cm??"",onChange:N=>y(C=>({...C,width_cm:N.target.value?parseFloat(N.target.value):null})),placeholder:"Larg."})}),n.jsx("div",{children:n.jsx(Qe,{type:"number",step:"0.1",min:"0",max:"100",value:x.height_cm??"",onChange:N=>y(C=>({...C,height_cm:N.target.value?parseFloat(N.target.value):null})),placeholder:"Alt."})})]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx(Le,{children:"Cor"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Kt,{value:R.includes(x.color||"")?x.color||"":"new_color",onValueChange:N=>{y(N==="new_color"?C=>({...C,color:""}):C=>({...C,color:N}))},children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecione"})}),n.jsxs(qt,{children:[R.map(N=>n.jsx(ze,{value:N,children:N},N)),n.jsx(ze,{value:"new_color",className:"font-medium text-primary",children:"+ Nova Cor..."})]})]}),(!R.includes(x.color||"")||x.color==="")&&n.jsx(Qe,{placeholder:"Digite a cor...",value:x.color||"",onChange:N=>y(C=>({...C,color:N.target.value})),className:"mt-2 animate-in fade-in slide-in-from-top-1",autoFocus:!0})]})]}),n.jsxs("div",{children:[n.jsx(Le,{children:"Estilo"}),n.jsxs(Kt,{value:x.style||"",onValueChange:N=>y(C=>({...C,style:N})),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecione"})}),n.jsx(qt,{children:Vxe.map(N=>n.jsx(ze,{value:N,children:N},N))})]})]}),n.jsxs("div",{children:[n.jsx(Le,{children:"Ocasio (marque quantas quiser)"}),n.jsx("div",{className:"grid grid-cols-2 gap-2 mt-2 p-3 border rounded-md",children:qxe.map(N=>{var C;return n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(va,{id:`occ-${N}`,checked:(C=x.occasion)==null?void 0:C.includes(N),onCheckedChange:k=>{const I=x.occasion||[],U=k?[...I,N]:I.filter($=>$!==N);y($=>({...$,occasion:U}))}}),n.jsx("label",{htmlFor:`occ-${N}`,className:"text-sm cursor-pointer hover:text-accent transition-colors",children:Hxe[N]||N})]},N)})})]}),n.jsxs("div",{children:[n.jsx(Le,{children:"Modelagem"}),n.jsxs(Kt,{value:x.modeling||"",onValueChange:N=>y(C=>({...C,modeling:N})),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecione"})}),n.jsx(qt,{children:Wxe.map(N=>n.jsx(ze,{value:N,children:N},N))})]})]})]}),n.jsx("div",{className:"border border-border rounded-lg p-4",children:n.jsx(Bxe,{stock:g,onChange:v})}),n.jsxs("div",{className:"border border-border rounded-lg p-4",children:[n.jsx(Fxe,{discountType:x.discount_type||null,discountValue:x.discount_value??null,onDiscountTypeChange:N=>y(C=>({...C,discount_type:N})),onDiscountValueChange:N=>y(C=>({...C,discount_value:N})),label:"Desconto no Catlogo"}),x.discount_type&&x.discount_value&&x.price>0&&n.jsxs("div",{className:"mt-3 p-2 bg-green-50 dark:bg-green-950/30 rounded text-sm",children:[n.jsxs("span",{className:"text-muted-foreground line-through",children:["R$ ",x.price.toFixed(2)]}),n.jsxs("span",{className:"ml-2 font-bold text-green-600",children:["R$ ",zxe(x.price,x.discount_type,x.discount_value).toFixed(2)]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Le,{htmlFor:"description",children:"Descrio"}),n.jsxs(he,{type:"button",variant:"ghost",size:"sm",onClick:F,disabled:c||l.length===0,title:l.length===0?"Adicione uma imagem primeiro":"Gerar descrio premium com IA",children:[c?n.jsx(At,{className:"h-4 w-4 mr-1 animate-spin"}):n.jsx(Wr,{className:"h-4 w-4 mr-1"}),c?"Gerando...":"Gerar com IA"]})]}),n.jsx(Yn,{id:"description",value:x.description||"",onChange:N=>y(C=>({...C,description:N.target.value})),placeholder:"Descrio detalhada do produto...",rows:3})]}),(r==null?void 0:r.id)&&n.jsx("div",{className:"border-t pt-6",children:n.jsx(Oxe,{productId:r.id,productName:x.name||r.name})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(va,{id:"is_active",checked:x.is_active,onCheckedChange:N=>y(C=>({...C,is_active:N}))}),n.jsx(Le,{htmlFor:"is_active",className:"cursor-pointer",children:"Produto ativo (visvel no catlogo)"})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(he,{type:"button",variant:"outline",onClick:()=>t(!1),className:"flex-1",children:"Cancelar"}),n.jsx(he,{type:"button",variant:"secondary",disabled:i,onClick:N=>E(N,!0),children:i?n.jsx(At,{className:"h-4 w-4 animate-spin"}):"Salvar rpido"}),n.jsx(he,{type:"submit",disabled:i,className:"flex-1",children:i?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):"Salvar completo"})]})]})]})})}var M3,J_="HoverCard",[yH,het]=ta(J_,[Cc]),ej=Cc(),[Xxe,l8]=yH(J_),bH=e=>{const{__scopeHoverCard:t,children:r,open:s,defaultOpen:a,onOpenChange:i,openDelay:o=700,closeDelay:c=300}=e,d=ej(t),l=P.useRef(0),u=P.useRef(0),h=P.useRef(!1),f=P.useRef(!1),[m,p]=Yi({prop:s,defaultProp:a??!1,onChange:i,caller:J_}),g=P.useCallback(()=>{clearTimeout(u.current),l.current=window.setTimeout(()=>p(!0),o)},[o,p]),v=P.useCallback(()=>{clearTimeout(l.current),!h.current&&!f.current&&(u.current=window.setTimeout(()=>p(!1),c))},[c,p]),x=P.useCallback(()=>p(!1),[p]);return P.useEffect(()=>()=>{clearTimeout(l.current),clearTimeout(u.current)},[]),n.jsx(Xxe,{scope:t,open:m,onOpenChange:p,onOpen:g,onClose:v,onDismiss:x,hasSelectionRef:h,isPointerDownOnContentRef:f,children:n.jsx(p1,{...d,children:r})})};bH.displayName=J_;var wH="HoverCardTrigger",_H=P.forwardRef((e,t)=>{const{__scopeHoverCard:r,...s}=e,a=l8(wH,r),i=ej(r);return n.jsx(yg,{asChild:!0,...i,children:n.jsx(er.a,{"data-state":a.open?"open":"closed",...s,ref:t,onPointerEnter:kt(e.onPointerEnter,$w(a.onOpen)),onPointerLeave:kt(e.onPointerLeave,$w(a.onClose)),onFocus:kt(e.onFocus,a.onOpen),onBlur:kt(e.onBlur,a.onClose),onTouchStart:kt(e.onTouchStart,o=>o.preventDefault())})})});_H.displayName=wH;var Yxe="HoverCardPortal",[fet,Zxe]=yH(Yxe,{forceMount:void 0}),Bw="HoverCardContent",jH=P.forwardRef((e,t)=>{const r=Zxe(Bw,e.__scopeHoverCard),{forceMount:s=r.forceMount,...a}=e,i=l8(Bw,e.__scopeHoverCard);return n.jsx(Gs,{present:s||i.open,children:n.jsx(Qxe,{"data-state":i.open?"open":"closed",...a,onPointerEnter:kt(e.onPointerEnter,$w(i.onOpen)),onPointerLeave:kt(e.onPointerLeave,$w(i.onClose)),ref:t})})});jH.displayName=Bw;var Qxe=P.forwardRef((e,t)=>{const{__scopeHoverCard:r,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:i,onInteractOutside:o,...c}=e,d=l8(Bw,r),l=ej(r),u=P.useRef(null),h=Ir(t,u),[f,m]=P.useState(!1);return P.useEffect(()=>{if(f){const p=document.body;return M3=p.style.userSelect||p.style.webkitUserSelect,p.style.userSelect="none",p.style.webkitUserSelect="none",()=>{p.style.userSelect=M3,p.style.webkitUserSelect=M3}}},[f]),P.useEffect(()=>{if(u.current){const p=()=>{m(!1),d.isPointerDownOnContentRef.current=!1,setTimeout(()=>{var v;((v=document.getSelection())==null?void 0:v.toString())!==""&&(d.hasSelectionRef.current=!0)})};return document.addEventListener("pointerup",p),()=>{document.removeEventListener("pointerup",p),d.hasSelectionRef.current=!1,d.isPointerDownOnContentRef.current=!1}}},[d.isPointerDownOnContentRef,d.hasSelectionRef]),P.useEffect(()=>{u.current&&tve(u.current).forEach(g=>g.setAttribute("tabindex","-1"))}),n.jsx(Fu,{asChild:!0,disableOutsidePointerEvents:!1,onInteractOutside:o,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:kt(i,p=>{p.preventDefault()}),onDismiss:d.onDismiss,children:n.jsx(g1,{...l,...c,onPointerDown:kt(c.onPointerDown,p=>{p.currentTarget.contains(p.target)&&m(!0),d.hasSelectionRef.current=!1,d.isPointerDownOnContentRef.current=!0}),ref:h,style:{...c.style,userSelect:f?"text":void 0,WebkitUserSelect:f?"text":void 0,"--radix-hover-card-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-hover-card-content-available-width":"var(--radix-popper-available-width)","--radix-hover-card-content-available-height":"var(--radix-popper-available-height)","--radix-hover-card-trigger-width":"var(--radix-popper-anchor-width)","--radix-hover-card-trigger-height":"var(--radix-popper-anchor-height)"}})})}),Jxe="HoverCardArrow",eve=P.forwardRef((e,t)=>{const{__scopeHoverCard:r,...s}=e,a=ej(r);return n.jsx(x1,{...a,...s,ref:t})});eve.displayName=Jxe;function $w(e){return t=>t.pointerType==="touch"?void 0:e()}function tve(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:s=>s.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;r.nextNode();)t.push(r.currentNode);return t}var rve=bH,nve=_H,NH=jH;const aM=rve,iM=nve,UC=P.forwardRef(({className:e,align:t="center",sideOffset:r=4,...s},a)=>n.jsx(NH,{ref:a,align:t,sideOffset:r,className:We("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s}));UC.displayName=NH.displayName;function Ly({size:e,stock:t,variant:r="badge",hasReservations:s=!1}){const a=t!=null&&typeof t.stock=="number"&&!isNaN(t.stock),i=n.jsxs("div",{className:"space-y-2 min-w-[180px]",children:[n.jsxs("p",{className:"font-semibold text-sm border-b pb-1",children:["Detalhe: ",e]}),a?n.jsx(n.Fragment,{children:n.jsxs("div",{className:"space-y-1 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Total Fsico:"}),n.jsx("span",{className:"font-medium",children:t.stock})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Reservado:"}),n.jsx("span",{className:`font-medium ${t.reserved>0?"text-orange-600":""}`,children:t.reserved})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Vendido:"}),n.jsx("span",{className:`font-medium ${t.committed>0?"text-blue-600":""}`,children:t.committed})]}),n.jsxs("div",{className:"flex justify-between pt-1 border-t mt-1",children:[n.jsx("span",{className:"font-medium",children:"Disponvel Venda:"}),n.jsx("span",{className:`font-bold ${t.available>0?"text-green-600":"text-red-600"}`,children:t.available})]})]})}):n.jsx("p",{className:"text-sm text-muted-foreground italic",children:"Sem detalhamento disponvel no momento."})]});return r==="icon"?n.jsxs(aM,{openDelay:0,closeDelay:0,children:[n.jsx(iM,{asChild:!0,children:n.jsx("button",{type:"button",className:"inline-flex items-center justify-center cursor-help focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-1 rounded-sm","aria-label":`Ver detalhes de estoque para tamanho ${e}`,children:n.jsx(YS,{className:"h-4 w-4 text-muted-foreground hover:text-foreground transition-colors"})})}),n.jsx(UC,{className:"w-auto p-3 z-50 bg-white shadow-xl border-2",side:"top",align:"center",children:i})]}):n.jsxs(aM,{openDelay:0,closeDelay:0,children:[n.jsx(iM,{asChild:!0,children:n.jsxs("div",{className:`
            inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full border text-xs font-semibold transition-colors cursor-help
            ${a&&t.available>0?"bg-secondary text-secondary-foreground hover:bg-secondary/80":"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80 opacity-50"}
            ${s?"border-orange-200 bg-orange-50 text-orange-700":""}
          `,tabIndex:0,role:"button",children:[n.jsxs("span",{children:[e,": ",a?t.available:0]}),n.jsx(YS,{className:"h-3 w-3 opacity-50 ml-0.5"})]})}),n.jsx(UC,{className:"w-auto p-3 z-50 bg-white shadow-xl border-2",side:"top",align:"center",children:i})]})}function fx(e,t,r){return!t||!r||r<=0?e:t==="percentage"?e*(1-r/100):t==="fixed"?Math.max(0,e-r):e}function km(e,t){return!!(e&&t&&t>0)}function SH(e,t){return km(e,t)?e==="percentage"?`-${t}%`:e==="fixed"?`-R$ ${t==null?void 0:t.toFixed(2)}`:null:null}function sve({userId:e,initialFilter:t}){const[r,s]=P.useState([]),[a,i]=P.useState(new Map),[o,c]=P.useState(!0),[d,l]=P.useState(""),[u,h]=P.useState(()=>t==="imported"?"imported":"active"),[f,m]=P.useState(!1),[p,g]=P.useState(null),[v,x]=P.useState(!1),[y,b]=P.useState(null),j=P.useCallback(async S=>{if(S.length!==0)try{const{data:E,error:N}=await ce.from("product_available_stock").select("*").in("product_id",S);if(N)throw N;const C=new Map;(E||[]).forEach(k=>{C.has(k.product_id)||C.set(k.product_id,new Map);const I={product_id:k.product_id,size:k.size,on_hand:k.on_hand||k.stock||0,committed:k.committed||0,reserved:k.reserved||0,available:k.available||0};C.get(k.product_id).set(k.size,I)}),i(C)}catch(E){console.error("Error loading available stock:",E)}},[]),T=async()=>{try{let S=ce.from("product_catalog").select("*").order("group_key",{ascending:!0,nullsFirst:!1}).order("color",{ascending:!0,nullsFirst:!1}).order("created_at",{ascending:!1});S=S.or(`user_id.eq.${e},user_id.is.null`),u==="active"?S=S.eq("is_active",!0):u==="archived"?S=S.eq("is_active",!1):u==="imported"&&(S=S.eq("is_active",!1).eq("created_from_import",!0));const{data:E,error:N}=await S;if(N)throw N;s(E||[]),E&&E.length>0&&j(E.map(C=>C.id))}catch(S){console.error("Error loading products:",S),de.error("Erro ao carregar produtos")}finally{c(!1)}};P.useEffect(()=>{T()},[e,u]);const O=async S=>{try{const{error:E}=await ce.from("product_catalog").update({is_active:!S.is_active}).eq("id",S.id);if(E)throw E;de.success(S.is_active?"Produto arquivado":"Produto reativado"),T()}catch(E){console.error("Error archiving product:",E),de.error("Erro ao arquivar produto")}},R=S=>{b(S),x(!0)},D=async()=>{if(y)try{const{error:S}=await ce.from("product_catalog").delete().eq("id",y.id);if(S)throw S;de.success("Produto excludo permanentemente"),T()}catch(S){console.error("Error deleting product:",S),de.error("Erro ao excluir produto")}finally{x(!1),b(null)}},L=S=>{g(S),m(!0)},q=()=>{g(null),m(!0)},X=r.filter(S=>{var E,N,C,k;return S.name.toLowerCase().includes(d.toLowerCase())||((E=S.sku)==null?void 0:E.toLowerCase().includes(d.toLowerCase()))||((N=S.group_key)==null?void 0:N.toLowerCase().includes(d.toLowerCase()))||((C=S.category)==null?void 0:C.toLowerCase().includes(d.toLowerCase()))||((k=S.color)==null?void 0:k.toLowerCase().includes(d.toLowerCase()))}),H=S=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(S),M=S=>!S||typeof S!="object"?{}:S,F=S=>{const E=["PP","P","M","G","GG","XG","XXG","XXXG","UN"];return S.sort(([N],[C])=>{const k=E.includes(N.toUpperCase()),I=E.includes(C.toUpperCase()),U=/^\d+$/.test(N),$=/^\d+$/.test(C);return k&&!I?-1:!k&&I?1:k&&I?E.indexOf(N.toUpperCase())-E.indexOf(C.toUpperCase()):U&&$?parseInt(N)-parseInt(C):N.localeCompare(C)})};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-between",children:[n.jsxs("div",{className:"relative flex-1 max-w-sm",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar produtos...",value:d,onChange:S=>l(S.target.value),className:"pl-10"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{variant:u==="active"?"secondary":"outline",onClick:()=>h("active"),className:"gap-2",size:"sm",children:"Ativos"}),n.jsxs(he,{variant:u==="archived"?"secondary":"outline",onClick:()=>h("archived"),className:"gap-2",size:"sm",children:[n.jsx(Ux,{className:"h-4 w-4"}),"Arquivados"]}),n.jsxs(he,{variant:u==="imported"?"secondary":"outline",onClick:()=>h("imported"),className:"gap-2",size:"sm",children:[n.jsx(Ut,{className:"h-4 w-4"}),"Importados (ERP)"]}),n.jsxs(he,{onClick:q,className:"gap-2",children:[n.jsx(An,{className:"h-4 w-4"}),"Novo Produto"]})]})]}),n.jsx("div",{className:"bg-card rounded-xl border border-border overflow-hidden",children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{className:"w-[80px]",children:"Imagem"}),n.jsx(jt,{children:"Produto"}),n.jsx(jt,{children:"Modelo"}),n.jsx(jt,{children:"Preo"}),n.jsx(jt,{children:"Estoque"}),n.jsx(jt,{children:"Status"}),n.jsx(jt,{className:"text-right",children:"Aes"})]})}),n.jsxs(Na,{children:[X.map(S=>n.jsxs(Qr,{children:[n.jsx(yt,{children:S.image_url?n.jsx("img",{src:S.image_url,alt:S.name,className:"w-12 h-12 object-cover rounded-lg"}):n.jsx("div",{className:"w-12 h-12 bg-secondary rounded-lg flex items-center justify-center",children:n.jsx(Ut,{className:"h-5 w-5 text-muted-foreground"})})}),n.jsx(yt,{children:n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:S.name}),n.jsxs("div",{className:"flex items-center gap-1.5 mt-0.5",children:[S.category&&n.jsx("span",{className:"text-xs text-muted-foreground",children:S.category}),S.category&&S.color&&n.jsx("span",{className:"text-xs text-muted-foreground",children:""}),S.color?n.jsx(Ae,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 font-normal",children:S.color}):n.jsx("span",{className:"text-xs text-amber-600",children:"Cor pendente"})]})]})}),n.jsx(yt,{children:S.group_key?n.jsx(Ae,{variant:"outline",className:"font-mono",children:S.group_key}):S.sku?n.jsx("span",{className:"font-mono text-xs text-muted-foreground",children:S.sku}):"-"}),n.jsx(yt,{children:S.price>0?n.jsx("div",{className:"flex flex-col",children:km(S.discount_type,S.discount_value)?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"font-medium text-green-600",children:H(fx(S.price,S.discount_type,S.discount_value))}),n.jsx("span",{className:"text-xs text-muted-foreground line-through",children:H(S.price)}),n.jsxs(Ae,{variant:"outline",className:"text-[10px] px-1 py-0 h-4 w-fit text-green-600 border-green-200 mt-0.5",children:[n.jsx(Oa,{className:"h-2.5 w-2.5 mr-0.5"}),SH(S.discount_type,S.discount_value)]})]}):H(S.price)}):n.jsx("span",{className:"text-muted-foreground text-xs",children:"A definir"})}),n.jsx(yt,{children:n.jsx("div",{className:"flex flex-wrap gap-1",children:(()=>{const E=a.get(S.id);if(E&&E.size>0){const Y=Array.from(E.entries()).filter(([,G])=>G.on_hand>0||G.available>0),Z=F(Y.map(([G])=>[G,0])).map(([G])=>{const J=E.get(G);return{size:G,entry:J}});return Z.length===0?n.jsx("span",{className:"text-xs text-amber-600",children:" Grade no definida"}):Z.every(({entry:G})=>((G==null?void 0:G.available)||0)<=0)?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-xs text-amber-600 mr-1",children:" Esgotado"}),Z.slice(0,5).map(({size:G,entry:J})=>{const V=J?{stock:J.on_hand,reserved:J.reserved,committed:J.committed,available:J.available}:null;return n.jsx(Ly,{size:G,stock:V,hasReservations:((J==null?void 0:J.reserved)||0)>0},G)}),Z.length>5&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",Z.length-5]})]}):n.jsxs(n.Fragment,{children:[Z.slice(0,6).map(({size:G,entry:J})=>{const V=(J==null?void 0:J.reserved)||0,W=(J==null?void 0:J.committed)||0,ee=V>0||W>0,ie=J?{stock:J.on_hand,reserved:J.reserved,committed:J.committed,available:J.available}:null;return n.jsx(Ly,{size:G,stock:ie,hasReservations:ee},G)}),Z.length>6&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",Z.length-6]})]})}const N=M(S.stock_by_size),C=Object.entries(N),k=F(C),I=k.filter(([,$])=>$>0),U=k.filter(([,$])=>$===0);return C.length===0?n.jsx("span",{className:"text-xs text-amber-600",children:" Grade no definida"}):I.length===0?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-xs text-amber-600 mr-1",children:" Zerado"}),U.slice(0,4).map(([$])=>n.jsx(Ly,{size:$,stock:{stock:0,reserved:0,committed:0,available:0}},$)),U.length>4&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",U.length-4]})]}):n.jsxs(n.Fragment,{children:[I.slice(0,5).map(([$,Y])=>n.jsx(Ly,{size:$,stock:{stock:Y,reserved:0,committed:0,available:Y}},$)),I.length>5&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",I.length-5]})]})})()})}),n.jsx(yt,{children:n.jsxs("div",{className:"flex flex-col items-start gap-1",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${S.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:S.is_active?"Ativo":"Arquivado"}),S.created_from_import&&n.jsx("span",{className:"text-xs px-2 py-1 rounded-full bg-amber-100 text-amber-700",children:"ERP"})]}),S.is_active&&!S.weight_kg&&n.jsx("span",{className:"text-xs text-amber-600",children:" Peso faltando"})]})}),n.jsx(yt,{className:"text-right",children:n.jsxs("div",{className:"flex justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>L(S),title:"Editar",children:n.jsx(ea,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>O(S),title:S.is_active?"Arquivar":"Reativar",children:n.jsx(Ux,{className:"h-4 w-4"})}),S.created_from_import&&n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>R(S),title:"Excluir permanentemente",className:"text-destructive hover:text-destructive",children:n.jsx(mi,{className:"h-4 w-4"})})]})})]},S.id)),X.length===0&&n.jsx(Qr,{children:n.jsx(yt,{colSpan:7,className:"text-center py-12 text-muted-foreground",children:o?"Carregando...":"Nenhum produto encontrado"})})]})]})}),n.jsx(Kxe,{open:f,onOpenChange:m,product:p?{...p,sizes:p.sizes||[],tags:p.tags||[],is_active:p.is_active??!0,stock_by_size:M(p.stock_by_size),group_key:p.group_key,created_from_import:p.created_from_import}:null,onSuccess:T,userId:e},f?"open":"closed"),n.jsx(Ac,{open:v,onOpenChange:x,children:n.jsxs(Dl,{children:[n.jsxs(Ll,{children:[n.jsx(Bl,{children:"Excluir produto?"}),n.jsxs($l,{children:['Esta ao  irreversvel. O produto "',y==null?void 0:y.name,'" ser excludo permanentemente.']})]}),n.jsxs(Tc,{children:[n.jsx(Oc,{children:"Cancelar"}),n.jsx(Pc,{onClick:D,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Excluir"})]})]})})]})}async function gf(e){try{if(navigator.clipboard&&typeof ClipboardItem<"u"){const t=new Blob([e],{type:"text/plain;charset=utf-8"});return await navigator.clipboard.write([new ClipboardItem({"text/plain":t})]),!0}return navigator.clipboard?(await navigator.clipboard.writeText(e),!0):oM(e)}catch(t){return console.warn("Clipboard API failed, using fallback:",t),oM(e)}}function oM(e){const t=document.createElement("textarea");t.value=e,t.style.cssText=`
    position: fixed;
    top: 0;
    left: -9999px;
    width: 1px;
    height: 1px;
    padding: 0;
    border: none;
    outline: none;
    box-shadow: none;
    background: transparent;
  `,document.body.appendChild(t),t.focus(),t.select();let r=!1;try{r=document.execCommand("copy")}catch(s){console.error("execCommand copy failed:",s)}return document.body.removeChild(t),r}function ave({open:e,onOpenChange:t,print:r,customerPhone:s,onSuccess:a}){var R;const[i,o]=P.useState([]),[c,d]=P.useState([]),[l,u]=P.useState(""),[h,f]=P.useState(null),[m,p]=P.useState(!0),[g,v]=P.useState(!1);P.useEffect(()=>{e&&x()},[e,r]);const x=async()=>{try{const{data:D,error:L}=await ce.from("product_catalog").select("*").eq("is_active",!0).order("name");if(L)throw L;if(o(D||[]),r.size||r.preference){const q=r.preference==="ajustado"?["ajustado","regular"]:["soltinho","oversized"],X=(D||[]).filter(H=>{var S;const M=!r.size||((S=H.sizes)==null?void 0:S.includes(r.size)),F=!r.preference||q.some(E=>{var N,C;return((N=H.tags)==null?void 0:N.includes(E))||((C=H.style)==null?void 0:C.includes(E))});return M||F}).slice(0,6);d(X)}if(r.linked_product_id){const q=(D||[]).find(X=>X.id===r.linked_product_id);q&&f(q)}}catch(D){console.error("Error loading products:",D)}finally{p(!1)}},y=i.filter(D=>{var L;return D.name.toLowerCase().includes(l.toLowerCase())||((L=D.category)==null?void 0:L.toLowerCase().includes(l.toLowerCase()))}),b=async()=>{if(h){v(!0);try{const{error:D}=await ce.from("print_requests").update({linked_product_id:h.id}).eq("id",r.id);if(D)throw D;de.success("Produto vinculado!"),a(),t(!1)}catch(D){console.error("Error linking product:",D),de.error("Erro ao vincular produto")}finally{v(!1)}}},j=()=>{var L;const D=q=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(q);return h?r.size&&((L=h.sizes)==null?void 0:L.includes(r.size))?`Oi!  Achei a pea que voc procura: ${h.name} - ${D(h.price)}. Tenho no seu tamanho (${r.size})! Posso reservar para voc?`:`Oi!  Encontrei uma pea parecida com o que voc procura: ${h.name} - ${D(h.price)}. Vou verificar os tamanhos disponveis e te aviso!`:"Oi!  Vi o print que voc mandou! Estou procurando essa pea para voc. Em breve te dou um retorno!"},T=async()=>{const D=j(),q=`https://wa.me/55${s.replace(/\D/g,"")}?text=${encodeURIComponent(D)}`,X=window.open(q,"_blank","noopener,noreferrer");(!X||X.closed||typeof X.closed>"u")&&(await gf(D),de.success("Link bloqueado. Mensagem copiada para rea de transferncia!"))},O=D=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(D);return n.jsx(cn,{open:e,onOpenChange:t,children:n.jsxs(sn,{className:"max-w-2xl max-h-[85vh] overflow-y-auto",children:[n.jsx(fn,{children:n.jsx(dn,{className:"font-serif",children:"Vincular a Produto"})}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar produto...",value:l,onChange:D=>u(D.target.value),className:"pl-10"})]}),h&&n.jsxs("div",{className:"p-4 bg-accent/10 rounded-xl border border-accent/20",children:[n.jsx("p",{className:"text-xs text-accent font-medium mb-2",children:"Produto selecionado"}),n.jsxs("div",{className:"flex gap-4",children:[h.image_url?n.jsx("img",{src:h.image_url,alt:h.name,className:"w-16 h-16 object-cover rounded-lg"}):n.jsx("div",{className:"w-16 h-16 bg-secondary rounded-lg flex items-center justify-center",children:n.jsx(Ut,{className:"h-6 w-6 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:h.name}),n.jsx("p",{className:"text-sm text-muted-foreground",children:O(h.price)}),r.size&&n.jsx("p",{className:"text-xs mt-1",children:(R=h.sizes)!=null&&R.includes(r.size)?n.jsxs("span",{className:"text-green-600",children:[" Tem no tamanho ",r.size]}):n.jsxs("span",{className:"text-amber-600",children:[" Verificar tamanho ",r.size]})})]}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>f(null),children:"Trocar"})]})]}),!h&&c.length>0&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium mb-3",children:"Sugestes baseadas nas preferncias"}),n.jsx("div",{className:"grid grid-cols-3 gap-3",children:c.map(D=>n.jsxs("button",{onClick:()=>f(D),className:"text-left p-3 rounded-xl border border-border hover:border-accent transition-colors",children:[D.image_url?n.jsx("img",{src:D.image_url,alt:D.name,className:"w-full aspect-square object-cover rounded-lg mb-2"}):n.jsx("div",{className:"w-full aspect-square bg-secondary rounded-lg mb-2 flex items-center justify-center",children:n.jsx(Ut,{className:"h-8 w-8 text-muted-foreground"})}),n.jsx("p",{className:"text-sm font-medium truncate",children:D.name}),n.jsx("p",{className:"text-xs text-muted-foreground",children:O(D.price)})]},D.id))})]}),!h&&l&&n.jsxs("div",{className:"max-h-[300px] overflow-y-auto space-y-2",children:[y.map(D=>n.jsxs("button",{onClick:()=>f(D),className:"w-full flex items-center gap-3 p-3 rounded-xl border border-border hover:border-accent transition-colors text-left",children:[D.image_url?n.jsx("img",{src:D.image_url,alt:D.name,className:"w-12 h-12 object-cover rounded-lg"}):n.jsx("div",{className:"w-12 h-12 bg-secondary rounded-lg flex items-center justify-center",children:n.jsx(Ut,{className:"h-5 w-5 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:D.name}),n.jsx("p",{className:"text-sm text-muted-foreground",children:O(D.price)})]})]},D.id)),y.length===0&&n.jsx("p",{className:"text-center text-muted-foreground py-4",children:"Nenhum produto encontrado"})]}),n.jsxs("div",{className:"flex flex-col gap-3 pt-4 border-t border-border",children:[n.jsxs("div",{className:"flex gap-3",children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),className:"flex-1",children:"Cancelar"}),n.jsxs(he,{onClick:b,disabled:!h||g,className:"flex-1 gap-2",children:[n.jsx(Qz,{className:"h-4 w-4"}),"Vincular"]})]}),n.jsxs(he,{variant:"secondary",onClick:T,className:"gap-2",children:[n.jsx(nn,{className:"h-4 w-4"}),"Enviar resposta no WhatsApp"]})]})]})]})})}const ive=pg("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),xf=P.forwardRef(({className:e,variant:t,...r},s)=>n.jsx("div",{ref:s,role:"alert",className:We(ive({variant:t}),e),...r}));xf.displayName="Alert";const ove=P.forwardRef(({className:e,...t},r)=>n.jsx("h5",{ref:r,className:We("mb-1 font-medium leading-none tracking-tight",e),...t}));ove.displayName="AlertTitle";const vf=P.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:We("text-sm [&_p]:leading-relaxed",e),...t}));vf.displayName="AlertDescription";var tj="Collapsible",[lve,met]=ta(tj),[cve,c8]=lve(tj),CH=P.forwardRef((e,t)=>{const{__scopeCollapsible:r,open:s,defaultOpen:a,disabled:i,onOpenChange:o,...c}=e,[d,l]=Yi({prop:s,defaultProp:a??!1,onChange:o,caller:tj});return n.jsx(cve,{scope:r,disabled:i,contentId:xa(),open:d,onOpenToggle:P.useCallback(()=>l(u=>!u),[l]),children:n.jsx(er.div,{"data-state":u8(d),"data-disabled":i?"":void 0,...c,ref:t})})});CH.displayName=tj;var EH="CollapsibleTrigger",kH=P.forwardRef((e,t)=>{const{__scopeCollapsible:r,...s}=e,a=c8(EH,r);return n.jsx(er.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":u8(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...s,ref:t,onClick:kt(e.onClick,a.onOpenToggle)})});kH.displayName=EH;var d8="CollapsibleContent",AH=P.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=c8(d8,e.__scopeCollapsible);return n.jsx(Gs,{present:r||a.open,children:({present:i})=>n.jsx(dve,{...s,ref:t,present:i})})});AH.displayName=d8;var dve=P.forwardRef((e,t)=>{const{__scopeCollapsible:r,present:s,children:a,...i}=e,o=c8(d8,r),[c,d]=P.useState(s),l=P.useRef(null),u=Ir(t,l),h=P.useRef(0),f=h.current,m=P.useRef(0),p=m.current,g=o.open||c,v=P.useRef(g),x=P.useRef(void 0);return P.useEffect(()=>{const y=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(y)},[]),ya(()=>{const y=l.current;if(y){x.current=x.current||{transitionDuration:y.style.transitionDuration,animationName:y.style.animationName},y.style.transitionDuration="0s",y.style.animationName="none";const b=y.getBoundingClientRect();h.current=b.height,m.current=b.width,v.current||(y.style.transitionDuration=x.current.transitionDuration,y.style.animationName=x.current.animationName),d(s)}},[o.open,s]),n.jsx(er.div,{"data-state":u8(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!g,...i,ref:u,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":p?`${p}px`:void 0,...e.style},children:g&&a})});function u8(e){return e?"open":"closed"}var uve=CH;const Ag=uve,Tg=kH,Pg=AH;function h8(){const[e,t]=P.useState([]),[r,s]=P.useState(!0),a=async()=>{const{data:l,error:u}=await ce.from("sellers").select("*").eq("is_active",!0).order("name");if(u){console.error("Error loading sellers:",u);return}t(l||[]),s(!1)},i=async()=>{const{data:l,error:u}=await ce.from("sellers").select("*").order("name");if(u){console.error("Error loading sellers:",u);return}t(l||[]),s(!1)},o=async l=>{const{data:u,error:h}=await ce.from("sellers").insert(l).select().single();if(h)throw de.error("Erro ao criar vendedora"),h;return t(f=>[...f,u]),de.success("Vendedora cadastrada!"),u},c=async(l,u)=>{const{error:h}=await ce.from("sellers").update(u).eq("id",l);if(h)throw de.error("Erro ao atualizar vendedora"),h;t(f=>f.map(m=>m.id===l?{...m,...u}:m)),de.success("Vendedora atualizada!")},d=async(l,u)=>{await c(l,{is_active:u})};return P.useEffect(()=>{a()},[]),{sellers:e,isLoading:r,loadSellers:a,loadAllSellers:i,createSeller:o,updateSeller:c,toggleSellerActive:d,refetch:a}}function TH({open:e,onClose:t,onSuccess:r,orderId:s,liveCartId:a}){const[i,o]=P.useState(""),[c,d]=P.useState(!1),[l,u]=P.useState(null),h=async()=>{var m,p,g;if(!i.trim()){de.error("Informe o ID do pagamento");return}d(!0),u(null);try{const{data:v,error:x}=await ce.functions.invoke("revalidate-payment",{body:{payment_id:i.trim(),order_id:s||void 0}});if(x){console.error("Revalidate error:",x),console.error("Revalidate backend payload:",v);const T=(v==null?void 0:v.error)||(v==null?void 0:v.message)||x.message||"Erro ao revalidar";u({success:!1,message:T}),de.error(T);return}const y=v;console.log("[RevalidatePaymentModal] Response:",y);const b=((m=y.order)==null?void 0:m.status)==="pago"||((p=y.order)==null?void 0:p.payment_status)==="approved"||((g=y.live_cart)==null?void 0:g.status)==="pago";if(y.success&&b)u({success:!0,message:y.message,amount:y.amount,already_paid:y.already_paid,order_id:y.order_id,order:y.order,live_cart_id:y.live_cart_id,live_cart:y.live_cart,paid_at:y.paid_at}),y.already_paid?de.info("Este pedido j estava marcado como pago."):de.success(" Pagamento revalidado e pedido atualizado para PAGO!"),r==null||r(y);else if(y.success&&!b)console.error("[RevalidatePaymentModal] API success but status not pago:",y),u({success:!1,message:y.error||"Revalidao falhou. Status no atualizado para 'pago'."}),de.error("Falha na persistncia. Status no atualizado.");else{const j=y.error||y.message||"Falha na revalidao";u({success:!1,message:j}),de.error(j)}}catch(v){console.error("Revalidate exception:",v),u({success:!1,message:"Erro de conexo. Tente novamente."}),de.error("Erro de conexo")}finally{d(!1)}},f=()=>{o(""),u(null),t()};return n.jsx(cn,{open:e,onOpenChange:f,children:n.jsxs(sn,{className:"sm:max-w-md",children:[n.jsxs(fn,{children:[n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(en,{className:"h-5 w-5"}),"Revalidar Pagamento Mercado Pago"]}),n.jsx(Zo,{children:"Cole o ID do pagamento do Mercado Pago para buscar e atualizar o status do pedido."})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsx(xf,{variant:"default",className:"bg-blue-50 border-blue-200",children:n.jsxs(vf,{className:"text-sm",children:[n.jsx("strong",{children:"Como encontrar o Payment ID:"}),n.jsxs("ol",{className:"list-decimal list-inside mt-2 space-y-1",children:[n.jsxs("li",{children:["Acesse o ",n.jsx("a",{href:"https://www.mercadopago.com.br/activities",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"painel do Mercado Pago"})]}),n.jsx("li",{children:"Encontre a transao (aprovada)"}),n.jsx("li",{children:"Copie o nmero do pagamento (ex: 12345678901)"})]})]})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"payment_id",children:"ID do Pagamento"}),n.jsx(Qe,{id:"payment_id",placeholder:"Ex: 12345678901",value:i,onChange:m=>o(m.target.value),disabled:c,onKeyDown:m=>{m.key==="Enter"&&!c&&i.trim()&&h()}})]}),l&&n.jsxs(xf,{variant:l.success?"default":"destructive",className:l.success?"bg-green-50 border-green-200":"",children:[l.success?n.jsx(Er,{className:"h-4 w-4 text-green-600"}):n.jsx(Mr,{className:"h-4 w-4"}),n.jsxs(vf,{children:[n.jsx("span",{className:l.success?"text-green-800":"",children:l.message}),l.amount&&n.jsxs("div",{className:"mt-1 font-medium text-green-700",children:["Valor confirmado: R$ ",l.amount.toFixed(2)]}),l.paid_at&&n.jsxs("div",{className:"mt-1 text-sm text-green-600",children:["Data do pagamento: ",new Date(l.paid_at).toLocaleString("pt-BR")]}),l.order&&n.jsxs("div",{className:"mt-2 text-xs text-muted-foreground font-mono space-y-1",children:[n.jsxs("div",{children:["Pedido: ",l.order.id.slice(0,8),"..."]}),n.jsxs("div",{children:["Status: ",n.jsx("span",{className:"font-semibold text-green-700",children:l.order.status})]}),n.jsxs("div",{children:["Payment Status: ",n.jsx("span",{className:"font-semibold",children:l.order.payment_status})]})]}),l.live_cart&&n.jsxs("div",{className:"mt-2 text-xs text-muted-foreground font-mono space-y-1",children:[n.jsxs("div",{children:["Sacola: ",l.live_cart.id.slice(0,8),"..."]}),n.jsxs("div",{children:["Status: ",n.jsx("span",{className:"font-semibold text-green-700",children:l.live_cart.status})]})]})]})]}),(s||a)&&!l&&n.jsxs("p",{className:"text-xs text-muted-foreground",children:[s&&n.jsxs(n.Fragment,{children:["Pedido: ",n.jsx("span",{className:"font-mono",children:s.slice(0,8)})]}),a&&n.jsxs(n.Fragment,{children:["Sacola: ",n.jsx("span",{className:"font-mono",children:a.slice(0,8)})]})]})]}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx(he,{variant:"outline",onClick:f,disabled:c,children:l!=null&&l.success?"Fechar":"Cancelar"}),!(l!=null&&l.success)&&n.jsxs(he,{onClick:h,disabled:c||!i.trim(),children:[c?n.jsx(en,{className:"h-4 w-4 mr-2 animate-spin"}):n.jsx(en,{className:"h-4 w-4 mr-2"}),"Revalidar"]})]})]})})}function zr(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Qi(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function vi(e,t){const r=zr(e);return isNaN(t)?Qi(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Qo(e,t){const r=zr(e);if(isNaN(t))return Qi(e,NaN);if(!t)return r;const s=r.getDate(),a=Qi(e,r.getTime());a.setMonth(r.getMonth()+t+1,0);const i=a.getDate();return s>=i?a:(r.setFullYear(a.getFullYear(),a.getMonth(),s),r)}const f8=6048e5,hve=864e5,PH=6e4,m8=36e5,By=43200,lM=1440;let fve={};function Og(){return fve}function bc(e,t){var c,d,l,u;const r=Og(),s=(t==null?void 0:t.weekStartsOn)??((d=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??r.weekStartsOn??((u=(l=r.locale)==null?void 0:l.options)==null?void 0:u.weekStartsOn)??0,a=zr(e),i=a.getDay(),o=(i<s?7:0)+i-s;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function yf(e){return bc(e,{weekStartsOn:1})}function OH(e){const t=zr(e),r=t.getFullYear(),s=Qi(e,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const a=yf(s),i=Qi(e,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=yf(i);return t.getTime()>=a.getTime()?r+1:t.getTime()>=o.getTime()?r:r-1}function Vn(e){const t=zr(e);return t.setHours(0,0,0,0),t}function Ap(e){const t=zr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function ac(e,t){const r=Vn(e),s=Vn(t),a=+r-Ap(r),i=+s-Ap(s);return Math.round((a-i)/hve)}function mve(e){const t=OH(e),r=Qi(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),yf(r)}function VC(e,t){const r=t*7;return vi(e,r)}function RH(e,t){return Qo(e,t*12)}function pve(e){let t;return e.forEach(function(r){const s=zr(r);(t===void 0||t<s||isNaN(Number(s)))&&(t=s)}),t||new Date(NaN)}function gve(e){let t;return e.forEach(r=>{const s=zr(r);(!t||t>s||isNaN(+s))&&(t=s)}),t||new Date(NaN)}function Db(e,t){const r=zr(e),s=zr(t),a=r.getTime()-s.getTime();return a<0?-1:a>0?1:a}function xve(e){return Qi(e,Date.now())}function qi(e,t){const r=Vn(e),s=Vn(t);return+r==+s}function p8(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function vve(e){if(!p8(e)&&typeof e!="number")return!1;const t=zr(e);return!isNaN(Number(t))}function Tp(e,t){const r=zr(e),s=zr(t),a=r.getFullYear()-s.getFullYear(),i=r.getMonth()-s.getMonth();return a*12+i}function yve(e,t,r){const s=bc(e,r),a=bc(t,r),i=+s-Ap(s),o=+a-Ap(a);return Math.round((i-o)/f8)}function MH(e){return t=>{const s=(e?Math[e]:Math.trunc)(t);return s===0?0:s}}function IH(e,t){return+zr(e)-+zr(t)}function cM(e,t,r){const s=IH(e,t)/m8;return MH(r==null?void 0:r.roundingMethod)(s)}function rs(e){const t=zr(e);return t.setHours(23,59,59,999),t}function fc(e){const t=zr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}function bve(e){const t=zr(e);return+rs(t)==+fc(t)}function wve(e,t){const r=zr(e),s=zr(t),a=Db(r,s),i=Math.abs(Tp(r,s));let o;if(i<1)o=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*i);let c=Db(r,s)===-a;bve(zr(e))&&i===1&&Db(e,s)===1&&(c=!1),o=a*(i-Number(c))}return o===0?0:o}function _ve(e,t,r){const s=IH(e,t)/1e3;return MH(r==null?void 0:r.roundingMethod)(s)}function Ps(e){const t=zr(e);return t.setDate(1),t.setHours(0,0,0,0),t}function jve(e){const t=zr(e),r=t.getFullYear();return t.setFullYear(r+1,0,0),t.setHours(23,59,59,999),t}function g8(e){const t=zr(e),r=Qi(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}function x8(e,t){var c,d,l,u;const r=Og(),s=(t==null?void 0:t.weekStartsOn)??((d=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??r.weekStartsOn??((u=(l=r.locale)==null?void 0:l.options)==null?void 0:u.weekStartsOn)??0,a=zr(e),i=a.getDay(),o=(i<s?-7:0)+6-(i-s);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}function DH(e){return x8(e,{weekStartsOn:1})}const Nve={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Sve=(e,t,r)=>{let s;const a=Nve[e];return typeof a=="string"?s=a:t===1?s=a.one:s=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+s:s+" ago":s};function Zm(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Cve={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Eve={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},kve={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ave={date:Zm({formats:Cve,defaultWidth:"full"}),time:Zm({formats:Eve,defaultWidth:"full"}),dateTime:Zm({formats:kve,defaultWidth:"full"})},Tve={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Pve=(e,t,r,s)=>Tve[e];function ec(e){return(t,r)=>{const s=r!=null&&r.context?String(r.context):"standalone";let a;if(s==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,c=r!=null&&r.width?String(r.width):o;a=e.formattingValues[c]||e.formattingValues[o]}else{const o=e.defaultWidth,c=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[c]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const Ove={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Rve={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Mve={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Ive={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Dve={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Lve={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Bve=(e,t)=>{const r=Number(e),s=r%100;if(s>20||s<10)switch(s%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},$ve={ordinalNumber:Bve,era:ec({values:Ove,defaultWidth:"wide"}),quarter:ec({values:Rve,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ec({values:Mve,defaultWidth:"wide"}),day:ec({values:Ive,defaultWidth:"wide"}),dayPeriod:ec({values:Dve,defaultWidth:"wide",formattingValues:Lve,defaultFormattingWidth:"wide"})};function tc(e){return(t,r={})=>{const s=r.width,a=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const o=i[0],c=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],d=Array.isArray(c)?zve(c,h=>h.test(o)):Fve(c,h=>h.test(o));let l;l=e.valueCallback?e.valueCallback(d):d,l=r.valueCallback?r.valueCallback(l):l;const u=t.slice(o.length);return{value:l,rest:u}}}function Fve(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function zve(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function LH(e){return(t,r={})=>{const s=t.match(e.matchPattern);if(!s)return null;const a=s[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const c=t.slice(a.length);return{value:o,rest:c}}}const Uve=/^(\d+)(th|st|nd|rd)?/i,Vve=/\d+/i,qve={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Wve={any:[/^b/i,/^(a|c)/i]},Hve={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Gve={any:[/1/i,/2/i,/3/i,/4/i]},Kve={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Xve={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Yve={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Zve={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Qve={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Jve={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},e1e={ordinalNumber:LH({matchPattern:Uve,parsePattern:Vve,valueCallback:e=>parseInt(e,10)}),era:tc({matchPatterns:qve,defaultMatchWidth:"wide",parsePatterns:Wve,defaultParseWidth:"any"}),quarter:tc({matchPatterns:Hve,defaultMatchWidth:"wide",parsePatterns:Gve,defaultParseWidth:"any",valueCallback:e=>e+1}),month:tc({matchPatterns:Kve,defaultMatchWidth:"wide",parsePatterns:Xve,defaultParseWidth:"any"}),day:tc({matchPatterns:Yve,defaultMatchWidth:"wide",parsePatterns:Zve,defaultParseWidth:"any"}),dayPeriod:tc({matchPatterns:Qve,defaultMatchWidth:"any",parsePatterns:Jve,defaultParseWidth:"any"})},v8={code:"en-US",formatDistance:Sve,formatLong:Ave,formatRelative:Pve,localize:$ve,match:e1e,options:{weekStartsOn:0,firstWeekContainsDate:1}};function t1e(e){const t=zr(e);return ac(t,g8(t))+1}function BH(e){const t=zr(e),r=+yf(t)-+mve(t);return Math.round(r/f8)+1}function $H(e,t){var u,h,f,m;const r=zr(e),s=r.getFullYear(),a=Og(),i=(t==null?void 0:t.firstWeekContainsDate)??((h=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((m=(f=a.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=Qi(e,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const c=bc(o,t),d=Qi(e,0);d.setFullYear(s,0,i),d.setHours(0,0,0,0);const l=bc(d,t);return r.getTime()>=c.getTime()?s+1:r.getTime()>=l.getTime()?s:s-1}function r1e(e,t){var c,d,l,u;const r=Og(),s=(t==null?void 0:t.firstWeekContainsDate)??((d=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(l=r.locale)==null?void 0:l.options)==null?void 0:u.firstWeekContainsDate)??1,a=$H(e,t),i=Qi(e,0);return i.setFullYear(a,0,s),i.setHours(0,0,0,0),bc(i,t)}function FH(e,t){const r=zr(e),s=+bc(r,t)-+r1e(r,t);return Math.round(s/f8)+1}function Bn(e,t){const r=e<0?"-":"",s=Math.abs(e).toString().padStart(t,"0");return r+s}const Bd={y(e,t){const r=e.getFullYear(),s=r>0?r:1-r;return Bn(t==="yy"?s%100:s,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Bn(r+1,2)},d(e,t){return Bn(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Bn(e.getHours()%12||12,t.length)},H(e,t){return Bn(e.getHours(),t.length)},m(e,t){return Bn(e.getMinutes(),t.length)},s(e,t){return Bn(e.getSeconds(),t.length)},S(e,t){const r=t.length,s=e.getMilliseconds(),a=Math.trunc(s*Math.pow(10,r-3));return Bn(a,t.length)}},em={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},dM={G:function(e,t,r){const s=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(s,{width:"abbreviated"});case"GGGGG":return r.era(s,{width:"narrow"});case"GGGG":default:return r.era(s,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const s=e.getFullYear(),a=s>0?s:1-s;return r.ordinalNumber(a,{unit:"year"})}return Bd.y(e,t)},Y:function(e,t,r,s){const a=$H(e,s),i=a>0?a:1-a;if(t==="YY"){const o=i%100;return Bn(o,2)}return t==="Yo"?r.ordinalNumber(i,{unit:"year"}):Bn(i,t.length)},R:function(e,t){const r=OH(e);return Bn(r,t.length)},u:function(e,t){const r=e.getFullYear();return Bn(r,t.length)},Q:function(e,t,r){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return Bn(s,2);case"Qo":return r.ordinalNumber(s,{unit:"quarter"});case"QQQ":return r.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,t,r){const s=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return Bn(s,2);case"qo":return r.ordinalNumber(s,{unit:"quarter"});case"qqq":return r.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,t,r){const s=e.getMonth();switch(t){case"M":case"MM":return Bd.M(e,t);case"Mo":return r.ordinalNumber(s+1,{unit:"month"});case"MMM":return r.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(s,{width:"wide",context:"formatting"})}},L:function(e,t,r){const s=e.getMonth();switch(t){case"L":return String(s+1);case"LL":return Bn(s+1,2);case"Lo":return r.ordinalNumber(s+1,{unit:"month"});case"LLL":return r.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(s,{width:"wide",context:"standalone"})}},w:function(e,t,r,s){const a=FH(e,s);return t==="wo"?r.ordinalNumber(a,{unit:"week"}):Bn(a,t.length)},I:function(e,t,r){const s=BH(e);return t==="Io"?r.ordinalNumber(s,{unit:"week"}):Bn(s,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Bd.d(e,t)},D:function(e,t,r){const s=t1e(e);return t==="Do"?r.ordinalNumber(s,{unit:"dayOfYear"}):Bn(s,t.length)},E:function(e,t,r){const s=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(s,{width:"short",context:"formatting"});case"EEEE":default:return r.day(s,{width:"wide",context:"formatting"})}},e:function(e,t,r,s){const a=e.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return Bn(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,r,s){const a=e.getDay(),i=(a-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return Bn(i,t.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,r){const s=e.getDay(),a=s===0?7:s;switch(t){case"i":return String(a);case"ii":return Bn(a,t.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(s,{width:"short",context:"formatting"});case"iiii":default:return r.day(s,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const s=e.getHours();let a;switch(s===12?a=em.noon:s===0?a=em.midnight:a=s/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,r){const s=e.getHours();let a;switch(s>=17?a=em.evening:s>=12?a=em.afternoon:s>=4?a=em.morning:a=em.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let s=e.getHours()%12;return s===0&&(s=12),r.ordinalNumber(s,{unit:"hour"})}return Bd.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Bd.H(e,t)},K:function(e,t,r){const s=e.getHours()%12;return t==="Ko"?r.ordinalNumber(s,{unit:"hour"}):Bn(s,t.length)},k:function(e,t,r){let s=e.getHours();return s===0&&(s=24),t==="ko"?r.ordinalNumber(s,{unit:"hour"}):Bn(s,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Bd.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Bd.s(e,t)},S:function(e,t){return Bd.S(e,t)},X:function(e,t,r){const s=e.getTimezoneOffset();if(s===0)return"Z";switch(t){case"X":return hM(s);case"XXXX":case"XX":return yh(s);case"XXXXX":case"XXX":default:return yh(s,":")}},x:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"x":return hM(s);case"xxxx":case"xx":return yh(s);case"xxxxx":case"xxx":default:return yh(s,":")}},O:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+uM(s,":");case"OOOO":default:return"GMT"+yh(s,":")}},z:function(e,t,r){const s=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+uM(s,":");case"zzzz":default:return"GMT"+yh(s,":")}},t:function(e,t,r){const s=Math.trunc(e.getTime()/1e3);return Bn(s,t.length)},T:function(e,t,r){const s=e.getTime();return Bn(s,t.length)}};function uM(e,t=""){const r=e>0?"-":"+",s=Math.abs(e),a=Math.trunc(s/60),i=s%60;return i===0?r+String(a):r+String(a)+t+Bn(i,2)}function hM(e,t){return e%60===0?(e>0?"-":"+")+Bn(Math.abs(e)/60,2):yh(e,t)}function yh(e,t=""){const r=e>0?"-":"+",s=Math.abs(e),a=Bn(Math.trunc(s/60),2),i=Bn(s%60,2);return r+a+t+i}const fM=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},zH=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},n1e=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],s=r[1],a=r[2];if(!a)return fM(e,t);let i;switch(s){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",fM(s,t)).replace("{{time}}",zH(a,t))},s1e={p:zH,P:n1e},a1e=/^D+$/,i1e=/^Y+$/,o1e=["D","DD","YY","YYYY"];function l1e(e){return a1e.test(e)}function c1e(e){return i1e.test(e)}function d1e(e,t,r){const s=u1e(e,t,r);if(console.warn(s),o1e.includes(e))throw new RangeError(s)}function u1e(e,t,r){const s=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${s} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const h1e=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,f1e=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,m1e=/^'([^]*?)'?$/,p1e=/''/g,g1e=/[a-zA-Z]/;function Ht(e,t,r){var u,h,f,m,p,g,v,x;const s=Og(),a=(r==null?void 0:r.locale)??s.locale??v8,i=(r==null?void 0:r.firstWeekContainsDate)??((h=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(f=s.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((g=(p=r==null?void 0:r.locale)==null?void 0:p.options)==null?void 0:g.weekStartsOn)??s.weekStartsOn??((x=(v=s.locale)==null?void 0:v.options)==null?void 0:x.weekStartsOn)??0,c=zr(e);if(!vve(c))throw new RangeError("Invalid time value");let d=t.match(f1e).map(y=>{const b=y[0];if(b==="p"||b==="P"){const j=s1e[b];return j(y,a.formatLong)}return y}).join("").match(h1e).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const b=y[0];if(b==="'")return{isToken:!1,value:x1e(y)};if(dM[b])return{isToken:!0,value:y};if(b.match(g1e))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:y}});a.localize.preprocessor&&(d=a.localize.preprocessor(c,d));const l={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return d.map(y=>{if(!y.isToken)return y.value;const b=y.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&c1e(b)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&l1e(b))&&d1e(b,t,String(e));const j=dM[b[0]];return j(c,b,a.localize,l)}).join("")}function x1e(e){const t=e.match(m1e);return t?t[1].replace(p1e,"'"):e}function v1e(e,t,r){const s=Og(),a=(r==null?void 0:r.locale)??s.locale??v8,i=2520,o=Db(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const c=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o});let d,l;o>0?(d=zr(t),l=zr(e)):(d=zr(e),l=zr(t));const u=_ve(l,d),h=(Ap(l)-Ap(d))/1e3,f=Math.round((u-h)/60);let m;if(f<2)return r!=null&&r.includeSeconds?u<5?a.formatDistance("lessThanXSeconds",5,c):u<10?a.formatDistance("lessThanXSeconds",10,c):u<20?a.formatDistance("lessThanXSeconds",20,c):u<40?a.formatDistance("halfAMinute",0,c):u<60?a.formatDistance("lessThanXMinutes",1,c):a.formatDistance("xMinutes",1,c):f===0?a.formatDistance("lessThanXMinutes",1,c):a.formatDistance("xMinutes",f,c);if(f<45)return a.formatDistance("xMinutes",f,c);if(f<90)return a.formatDistance("aboutXHours",1,c);if(f<lM){const p=Math.round(f/60);return a.formatDistance("aboutXHours",p,c)}else{if(f<i)return a.formatDistance("xDays",1,c);if(f<By){const p=Math.round(f/lM);return a.formatDistance("xDays",p,c)}else if(f<By*2)return m=Math.round(f/By),a.formatDistance("aboutXMonths",m,c)}if(m=wve(l,d),m<12){const p=Math.round(f/By);return a.formatDistance("xMonths",p,c)}else{const p=m%12,g=Math.trunc(m/12);return p<3?a.formatDistance("aboutXYears",g,c):p<9?a.formatDistance("overXYears",g,c):a.formatDistance("almostXYears",g+1,c)}}function y8(e,t){return v1e(e,xve(e),t)}function y1e(e){const t=zr(e),r=t.getFullYear(),s=t.getMonth(),a=Qi(e,0);return a.setFullYear(r,s+1,0),a.setHours(0,0,0,0),a.getDate()}function b1e(e){return Math.trunc(+zr(e)/1e3)}function w1e(e){const t=zr(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(0,0,0,0),t}function _1e(e,t){return yve(w1e(e),Ps(e),t)+1}function Fw(e,t){const r=zr(e),s=zr(t);return r.getTime()>s.getTime()}function b8(e,t){const r=zr(e),s=zr(t);return+r<+s}function w8(e,t){const r=zr(e),s=zr(t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function j1e(e,t){const r=zr(e),s=zr(t);return r.getFullYear()===s.getFullYear()}function mn(e,t){return vi(e,-t)}function lu(e,t){const s=E1e(e);let a;if(s.date){const d=k1e(s.date,2);a=A1e(d.restDateString,d.year)}if(!a||isNaN(a.getTime()))return new Date(NaN);const i=a.getTime();let o=0,c;if(s.time&&(o=T1e(s.time),isNaN(o)))return new Date(NaN);if(s.timezone){if(c=P1e(s.timezone),isNaN(c))return new Date(NaN)}else{const d=new Date(i+o),l=new Date(0);return l.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),l.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),l}return new Date(i+o+c)}const $y={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},N1e=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,S1e=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,C1e=/^([+-])(\d{2})(?::?(\d{2}))?$/;function E1e(e){const t={},r=e.split($y.dateTimeDelimiter);let s;if(r.length>2)return t;if(/:/.test(r[0])?s=r[0]:(t.date=r[0],s=r[1],$y.timeZoneDelimiter.test(t.date)&&(t.date=e.split($y.timeZoneDelimiter)[0],s=e.substr(t.date.length,e.length))),s){const a=$y.timezone.exec(s);a?(t.time=s.replace(a[1],""),t.timezone=a[1]):t.time=s}return t}function k1e(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),s=e.match(r);if(!s)return{year:NaN,restDateString:""};const a=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?a:i*100,restDateString:e.slice((s[1]||s[2]).length)}}function A1e(e,t){if(t===null)return new Date(NaN);const r=e.match(N1e);if(!r)return new Date(NaN);const s=!!r[4],a=b0(r[1]),i=b0(r[2])-1,o=b0(r[3]),c=b0(r[4]),d=b0(r[5])-1;if(s)return D1e(t,c,d)?O1e(t,c,d):new Date(NaN);{const l=new Date(0);return!M1e(t,i,o)||!I1e(t,a)?new Date(NaN):(l.setUTCFullYear(t,i,Math.max(a,o)),l)}}function b0(e){return e?parseInt(e):1}function T1e(e){const t=e.match(S1e);if(!t)return NaN;const r=I3(t[1]),s=I3(t[2]),a=I3(t[3]);return L1e(r,s,a)?r*m8+s*PH+a*1e3:NaN}function I3(e){return e&&parseFloat(e.replace(",","."))||0}function P1e(e){if(e==="Z")return 0;const t=e.match(C1e);if(!t)return 0;const r=t[1]==="+"?-1:1,s=parseInt(t[2]),a=t[3]&&parseInt(t[3])||0;return B1e(s,a)?r*(s*m8+a*PH):NaN}function O1e(e,t,r){const s=new Date(0);s.setUTCFullYear(e,0,4);const a=s.getUTCDay()||7,i=(t-1)*7+r+1-a;return s.setUTCDate(s.getUTCDate()+i),s}const R1e=[31,null,31,30,31,30,31,31,30,31,30,31];function UH(e){return e%400===0||e%4===0&&e%100!==0}function M1e(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(R1e[t]||(UH(e)?29:28))}function I1e(e,t){return t>=1&&t<=(UH(e)?366:365)}function D1e(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function L1e(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function B1e(e,t){return t>=0&&t<=59}function D3(e,t){const r=zr(e),s=r.getFullYear(),a=r.getDate(),i=Qi(e,0);i.setFullYear(s,t,15),i.setHours(0,0,0,0);const o=y1e(i);return r.setMonth(t,Math.min(a,o)),r}function mM(e,t){const r=zr(e);return isNaN(+r)?Qi(e,NaN):(r.setFullYear(t),r)}function uo(e,t){return Qo(e,-t)}function pM(e,t){return RH(e,-t)}const $1e={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},F1e=(e,t,r)=>{let s;const a=$1e[e];return typeof a=="string"?s=a:t===1?s=a.one:s=a.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"em "+s:"h "+s:s},z1e={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},U1e={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},V1e={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},q1e={date:Zm({formats:z1e,defaultWidth:"full"}),time:Zm({formats:U1e,defaultWidth:"full"}),dateTime:Zm({formats:V1e,defaultWidth:"full"})},W1e={lastWeek:e=>{const t=e.getDay();return"'"+(t===0||t===6?"ltimo":"ltima")+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},H1e=(e,t,r,s)=>{const a=W1e[e];return typeof a=="function"?a(t):a},G1e={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},K1e={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},X1e={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},Y1e={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},Z1e={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},Q1e={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},J1e=(e,t)=>{const r=Number(e);return(t==null?void 0:t.unit)==="week"?r+"":r+""},eye={ordinalNumber:J1e,era:ec({values:G1e,defaultWidth:"wide"}),quarter:ec({values:K1e,defaultWidth:"wide",argumentCallback:e=>e-1}),month:ec({values:X1e,defaultWidth:"wide"}),day:ec({values:Y1e,defaultWidth:"wide"}),dayPeriod:ec({values:Z1e,defaultWidth:"wide",formattingValues:Q1e,defaultFormattingWidth:"wide"})},tye=/^(\d+)[o]?/i,rye=/\d+/i,nye={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},sye={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},aye={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},iye={any:[/1/i,/2/i,/3/i,/4/i]},oye={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},lye={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},cye={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},dye={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},uye={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},hye={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},fye={ordinalNumber:LH({matchPattern:tye,parsePattern:rye,valueCallback:e=>parseInt(e,10)}),era:tc({matchPatterns:nye,defaultMatchWidth:"wide",parsePatterns:sye,defaultParseWidth:"any"}),quarter:tc({matchPatterns:aye,defaultMatchWidth:"wide",parsePatterns:iye,defaultParseWidth:"any",valueCallback:e=>e+1}),month:tc({matchPatterns:oye,defaultMatchWidth:"wide",parsePatterns:lye,defaultParseWidth:"any"}),day:tc({matchPatterns:cye,defaultMatchWidth:"wide",parsePatterns:dye,defaultParseWidth:"any"}),dayPeriod:tc({matchPatterns:uye,defaultMatchWidth:"any",parsePatterns:hye,defaultParseWidth:"any"})},gr={code:"pt-BR",formatDistance:F1e,formatLong:q1e,formatRelative:H1e,localize:eye,match:fye,options:{weekStartsOn:0,firstWeekContainsDate:1}},w0=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),mye=e=>{switch(e){case"motoboy":return"Motoboy";case"pickup":return"Retirada na loja";case"shipping":return"Correios";default:return"No definido"}},VH=()=>`
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  body {
    font-family: 'Segoe UI', Arial, sans-serif;
    padding: 20px;
    max-width: 800px;
    margin: 0 auto;
    font-size: 12px;
    color: #1a1a1a;
  }
  .packing-slip {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 24px;
    page-break-inside: avoid;
    margin-bottom: 20px;
  }
  .header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    border-bottom: 2px solid #000;
    padding-bottom: 16px;
    margin-bottom: 16px;
  }
  .logo-section {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .logo-section img {
    height: 40px;
    object-fit: contain;
  }
  .store-name {
    font-size: 24px;
    font-weight: bold;
  }
  .document-title {
    font-size: 18px;
    font-weight: bold;
    text-transform: uppercase;
    color: #666;
  }
  .order-info {
    text-align: right;
  }
  .order-number {
    font-size: 20px;
    font-weight: bold;
    font-family: monospace;
  }
  .order-date {
    font-size: 11px;
    color: #666;
  }
  .section {
    margin-bottom: 16px;
  }
  .section-title {
    font-size: 11px;
    font-weight: bold;
    text-transform: uppercase;
    color: #666;
    margin-bottom: 8px;
    border-bottom: 1px solid #eee;
    padding-bottom: 4px;
  }
  .customer-info {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
  }
  .info-block {
    padding: 12px;
    background: #f9f9f9;
    border-radius: 6px;
  }
  .info-label {
    font-size: 10px;
    color: #666;
    text-transform: uppercase;
    margin-bottom: 2px;
  }
  .info-value {
    font-size: 13px;
    font-weight: 500;
  }
  .items-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 16px;
  }
  .items-table th {
    background: #f3f3f3;
    padding: 10px 8px;
    text-align: left;
    font-size: 10px;
    text-transform: uppercase;
    font-weight: 600;
    border-bottom: 2px solid #ddd;
  }
  .items-table td {
    padding: 12px 8px;
    border-bottom: 1px solid #eee;
    vertical-align: top;
  }
  .items-table tr:last-child td {
    border-bottom: none;
  }
  .item-name {
    font-weight: 500;
    font-size: 13px;
  }
  .item-sku {
    font-size: 11px;
    color: #444;
    font-family: monospace;
    margin-top: 2px;
  }
  .item-details {
    font-size: 11px;
    color: #666;
    margin-top: 2px;
  }
  .item-photo-col {
    width: 50px;
    text-align: center;
    vertical-align: middle;
  }
  .item-thumbnail {
    width: 40px;
    height: 40px;
    object-fit: cover;
    border-radius: 4px;
    border: 1px solid #ddd;
  }
  .no-photo {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f5f5f5;
    border-radius: 4px;
    font-size: 16px;
    margin: 0 auto;
  }
  .item-size {
    font-weight: 600;
    font-size: 14px;
    text-align: center;
  }
  .item-qty {
    font-weight: 600;
    font-size: 14px;
    text-align: center;
  }
  .item-price {
    text-align: right;
    font-weight: 500;
  }
  .checkbox-col {
    width: 30px;
    text-align: center;
  }
  .checkbox {
    width: 16px;
    height: 16px;
    border: 2px solid #000;
    display: inline-block;
    border-radius: 3px;
  }
  .totals {
    display: flex;
    justify-content: flex-end;
  }
  .totals-box {
    text-align: right;
    background: #f9f9f9;
    padding: 12px 16px;
    border-radius: 6px;
    min-width: 200px;
  }
  .total-row {
    display: flex;
    justify-content: space-between;
    padding: 4px 0;
    font-size: 12px;
  }
  .total-row.grand-total {
    font-size: 16px;
    font-weight: bold;
    border-top: 2px solid #000;
    margin-top: 8px;
    padding-top: 8px;
  }
  .notes-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
    margin-top: 16px;
  }
  .notes-box {
    padding: 12px;
    border: 1px dashed #ccc;
    border-radius: 6px;
    min-height: 60px;
  }
  .notes-title {
    font-size: 10px;
    font-weight: bold;
    text-transform: uppercase;
    color: #666;
    margin-bottom: 6px;
  }
  .notes-content {
    font-size: 11px;
    white-space: pre-wrap;
  }
  .signature-section {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 24px;
    margin-top: 24px;
    padding-top: 16px;
    border-top: 2px dashed #ccc;
  }
  .signature-box {
    text-align: center;
  }
  .signature-line {
    border-bottom: 1px solid #000;
    height: 40px;
    margin-bottom: 8px;
  }
  .signature-label {
    font-size: 11px;
    color: #666;
  }
  .delivery-badge {
    display: inline-block;
    padding: 4px 12px;
    background: #e0f2fe;
    color: #0369a1;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
  }
  .delivery-badge.motoboy {
    background: #fef3c7;
    color: #92400e;
  }
  .delivery-badge.pickup {
    background: #d1fae5;
    color: #065f46;
  }
  @media print {
    body {
      padding: 0;
    }
    .packing-slip {
      border: none;
      page-break-after: always;
    }
    .packing-slip:last-child {
      page-break-after: avoid;
    }
  }
`,qH=(e,t,r)=>{var d,l,u;const s=e.id.slice(0,8).toUpperCase(),a=Ht(new Date(e.created_at),"dd 'de' MMMM 'de' yyyy 's' HH:mm",{locale:gr}),i=e.delivery_method==="motoboy"?"motoboy":e.delivery_method==="pickup"?"pickup":"",o=t.map(h=>`
    <tr>
      <td class="checkbox-col"><span class="checkbox"></span></td>
      <td class="item-photo-col">
        ${h.image_url?`<img src="${h.image_url}" alt="${h.product_name}" class="item-thumbnail" />`:'<div class="no-photo"></div>'}
      </td>
      <td>
        <div class="item-name">${h.product_name}</div>
        ${h.product_sku?`<div class="item-sku">SKU: ${h.product_sku}</div>`:""}
        ${h.color?`<div class="item-details">Cor: ${h.color}</div>`:""}
      </td>
      <td class="item-size">${h.size||"-"}</td>
      <td class="item-qty">${h.quantity}</td>
      <td class="item-price">${w0(h.product_price*h.quantity)}</td>
    </tr>
  `).join(""),c=t.reduce((h,f)=>h+f.quantity,0);return`
    <div class="packing-slip">
      <div class="header">
        <div class="logo-section">
          ${r?`<img src="${r}" alt="Logo" />`:""}
          <div>
            <div class="document-title">Romaneio de Separao</div>
          </div>
        </div>
        <div class="order-info">
          <div class="order-number">#${s}</div>
          <div class="order-date">${a}</div>
          <div style="margin-top: 8px;">
            <span class="delivery-badge ${i}">${mye(e.delivery_method)}</span>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="section-title">Dados do Cliente</div>
        <div class="customer-info">
          <div class="info-block">
            <div class="info-label">Nome</div>
            <div class="info-value">${e.customer_name}</div>
          </div>
          <div class="info-block">
            <div class="info-label">Telefone</div>
            <div class="info-value">${e.customer_phone}</div>
          </div>
        </div>
        ${e.delivery_method!=="pickup"?`
          <div class="info-block" style="margin-top: 8px;">
            <div class="info-label">Endereo de Entrega</div>
            <div class="info-value">${e.customer_address||"No informado"}</div>
          </div>
        `:""}
      </div>

      <div class="section">
        <div class="section-title">Itens do Pedido (${c} ${c===1?"item":"itens"})</div>
        <table class="items-table">
          <thead>
            <tr>
              <th class="checkbox-col"></th>
              <th style="width: 50px;">Foto</th>
              <th>Produto / SKU</th>
              <th style="text-align: center; width: 80px;">Tamanho</th>
              <th style="text-align: center; width: 50px;">Qtd</th>
              <th style="text-align: right; width: 100px;">Subtotal</th>
            </tr>
          </thead>
          <tbody>
            ${o}
          </tbody>
        </table>

        <div class="totals">
          <div class="totals-box">
            <div class="total-row">
              <span>Subtotal:</span>
              <span>${w0(t.reduce((h,f)=>h+f.product_price*f.quantity,0))}</span>
            </div>
            ${e.coupon_discount&&e.coupon_discount>0?`
              <div class="total-row" style="color: #166534;">
                <span>Desconto (${((d=e.coupon)==null?void 0:d.code)||"CUPOM"}${(u=(l=e.coupon)==null?void 0:l.code)!=null&&u.startsWith("ANIVER-")?" - Aniversrio":""}):</span>
                <span>-${w0(e.coupon_discount)}</span>
              </div>
            `:""}
            ${e.shipping_fee&&e.shipping_fee>0?`
              <div class="total-row">
                <span>Frete:</span>
                <span>${w0(e.shipping_fee)}</span>
              </div>
            `:""}
            <div class="total-row grand-total">
              <span>Total:</span>
              <span>${w0(e.total)}</span>
            </div>
          </div>
        </div>
      </div>

      ${e.customer_notes||e.internal_notes?`
        <div class="notes-section">
          ${e.customer_notes?`
            <div class="notes-box">
              <div class="notes-title"> Observao do Cliente</div>
              <div class="notes-content">${e.customer_notes}${e.delivery_period?`

Perodo: ${e.delivery_period==="manha"?"Manh":e.delivery_period==="tarde"?"Tarde":"Qualquer horrio"}`:""}</div>
            </div>
          `:"<div></div>"}
          ${e.internal_notes?`
            <div class="notes-box">
              <div class="notes-title"> Observao Interna</div>
              <div class="notes-content">${e.internal_notes}</div>
            </div>
          `:"<div></div>"}
        </div>
      `:""}

      <div class="signature-section">
        <div class="signature-box">
          <div class="signature-line"></div>
          <div class="signature-label">Separado por</div>
        </div>
        <div class="signature-box">
          <div class="signature-line"></div>
          <div class="signature-label">Conferido por</div>
        </div>
      </div>
    </div>
  `},WH=async e=>new Promise(t=>{const r=new Image;r.crossOrigin="anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.width,s.height=r.height;const a=s.getContext("2d");a==null||a.drawImage(r,0,0),t(s.toDataURL("image/png"))},r.onerror=()=>t(""),r.src=e});function pye({order:e,items:t,variant:r="button"}){const s=async()=>{if(t.length===0){de.error("Nenhum item no pedido");return}const a=await WH(hd),i=window.open("","_blank","width=900,height=700");if(!i){de.error("No foi possvel abrir janela de impresso");return}i.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Romaneio #${e.id.slice(0,8).toUpperCase()}</title>
          <style>${VH()}</style>
        </head>
        <body>
          ${qH(e,t,a)}
          <script>
            setTimeout(() => { window.print(); }, 500);
          <\/script>
        </body>
      </html>
    `),i.document.close()};return r==="icon"?n.jsx(he,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:a=>{a.stopPropagation(),s()},title:"Imprimir romaneio",children:n.jsx(af,{className:"h-4 w-4"})}):n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2",onClick:a=>{a.stopPropagation(),s()},children:[n.jsx(af,{className:"h-4 w-4"}),"Imprimir Pedido"]})}function gye({orders:e}){const t=async()=>{if(e.length===0){de.error("Nenhum pedido selecionado");return}const r=await WH(hd),s=window.open("","_blank","width=900,height=700");if(!s){de.error("No foi possvel abrir janela de impresso");return}const a=e.map(({order:i,items:o})=>qH(i,o,r)).join('<div style="page-break-before: always;"></div>');s.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Romaneios - ${e.length} pedidos</title>
          <style>${VH()}</style>
        </head>
        <body>
          ${a}
          <script>
            setTimeout(() => { window.print(); }, 500);
          <\/script>
        </body>
      </html>
    `),s.document.close()};return n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2",onClick:t,disabled:e.length===0,children:[n.jsx(h1,{className:"h-4 w-4"}),"Imprimir Romaneios (",e.length,")"]})}function Fy(e){const t=e.replace(/\D/g,"").slice(0,11);return t.length===0?"":t.length<=3?t:t.length<=6?`${t.slice(0,3)}.${t.slice(3)}`:t.length<=9?`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6)}`:`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6,9)}-${t.slice(9)}`}function gM(e){if(e.paid_at)return!0;const t=e.status.toLowerCase().trim();return["pago","paid","approved","payment_approved"].includes(t)}function xye(e){if(e.paid_at)return!1;const t=e.status.toLowerCase().trim();return t==="pendente"||t==="aguardando_pagamento"||t==="pagamento_rejeitado"||t==="pending"}function xM(e){return!!e.me_label_url||!!e.tracking_code||e.shipping_status==="etiqueta_gerada"}function vye({order:e,variant:t="button",onLabelGenerated:r,onOrderUpdated:s}){const[a,i]=P.useState(!1),[o,c]=P.useState(!1),[d,l]=P.useState(!1),[u,h]=P.useState(""),[f,m]=P.useState(!1),[p,g]=P.useState(e.status),v=e.delivery_method==="shipping",x=!!e.me_label_url,y=xM(e),b=gM(e),j=xye(e),T=x,O=e.address_snapshot,R=O&&O.zip_code&&(O.street||O.address_line)&&O.city&&O.state,D=((O==null?void 0:O.document)||(O==null?void 0:O.cpf)||"").replace(/\D/g,""),L=D.length===11,q=b&&v&&!y&&R,X=q&&L,H=()=>{h(D),l(!0)},M=async()=>{const N=u.replace(/\D/g,"");if(N.length!==11){de.error("CPF deve ter 11 dgitos");return}m(!0);try{const C={...e.address_snapshot,document:N},{error:k}=await ce.from("orders").update({address_snapshot:C,updated_at:new Date().toISOString()}).eq("id",e.id);if(k)throw k;if(e.customer_id){await ce.from("customers").update({document:N}).eq("id",e.customer_id);const{data:I}=await ce.from("customer_addresses").select("id").eq("customer_id",e.customer_id).eq("is_default",!0).maybeSingle();I&&await ce.from("customer_addresses").update({document:N}).eq("id",I.id)}de.success("CPF salvo com sucesso!"),l(!1),s&&s({...e,address_snapshot:C})}catch(C){console.error("Error saving CPF:",C),de.error("Erro ao salvar CPF")}finally{m(!1)}},F=async()=>{if(!R){de.error("Endereo incompleto. Verifique CEP, rua, cidade e estado.");return}if(!L){H();return}c(!0)},S=async()=>{c(!1),i(!0),console.log("[ShippingLabel] Starting label generation",{orderId:e.id,currentStatus:e.status,normalizedStatus:e.status.toLowerCase().trim()});try{const{data:N,error:C}=await ce.from("orders").select("id, status, paid_at, tracking_code, me_label_url, shipping_status").eq("id",e.id).single();if(C||!N){console.error("[ShippingLabel] Failed to refetch order:",C),de.error("Erro ao verificar status do pedido. Tente novamente.");return}if(console.log("[ShippingLabel] Refetched order:",{orderId:N.id,dbStatus:N.status,paid_at:N.paid_at,shipping_status:N.shipping_status,tracking_code:N.tracking_code,me_label_url:N.me_label_url}),g(N.status),xM(N)){de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Etiqueta j foi gerada"})}),n.jsx("p",{className:"text-sm",children:"Este pedido j possui uma etiqueta gerada."}),N.tracking_code&&n.jsxs("p",{className:"text-xs text-muted-foreground",children:["Rastreio: ",N.tracking_code]})]}),{duration:6e3});return}if(!gM(N)){de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Pedido ainda no est pago"})}),n.jsxs("p",{className:"text-sm",children:["Status atual: ",N.status]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:N.paid_at?`Pagamento registrado: ${new Date(N.paid_at).toLocaleString("pt-BR")}`:"Aguarde a confirmao do pagamento para gerar a etiqueta."})]}),{duration:6e3});return}const{data:I,error:U}=await ce.functions.invoke("generate-order-shipping-label",{body:{orderId:e.id}});if(console.log("[ShippingLabel] Edge Function response:",{orderId:e.id,hasError:!!U,errorMessage:U==null?void 0:U.message,errorContext:U==null?void 0:U.context,data:I}),U){console.error("[ShippingLabel] Edge function invoke error:",U);let $=null;try{const Y=U==null?void 0:U.context;Y&&(typeof Y.json=="function"?$=await Y.json():Y.body?$=Y.body:typeof Y=="object"&&($=Y))}catch(Y){console.error("[ShippingLabel] Failed to parse error context:",Y)}if(console.log("[ShippingLabel] Extracted error body:",$),$!=null&&$.error){if($.action==="recharge_wallet"){de.error(n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{children:n.jsx("strong",{children:"Saldo insuficiente no Melhor Envio"})}),n.jsx("p",{className:"text-sm",children:$.details||"Recarregue a carteira e tente novamente."}),$.wallet_url&&n.jsx("a",{href:$.wallet_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline text-sm block",children:"Recarregar carteira "})]}),{duration:1e4});return}if($.missing_fields){de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Dados faltando para gerar etiqueta"})}),n.jsx("p",{className:"text-sm",children:$.missing_fields.join(", ")})]}));return}de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Erro ao gerar etiqueta"})}),n.jsx("p",{className:"text-sm",children:$.error||$.message}),$.details&&n.jsx("p",{className:"text-xs text-muted-foreground",children:$.details})]}),{duration:8e3});return}de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Erro ao gerar etiqueta"})}),n.jsx("p",{className:"text-sm",children:U.message||"Erro desconhecido"})]}),{duration:8e3});return}if(I!=null&&I.error){if(console.error("[ShippingLabel] Edge function error in response:",I),I.action==="recharge_wallet"){de.error(n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{children:n.jsx("strong",{children:"Saldo insuficiente no Melhor Envio"})}),n.jsx("p",{className:"text-sm",children:I.details}),n.jsx("a",{href:I.wallet_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline text-sm",children:"Recarregar carteira "})]}),{duration:1e4});return}if(I.missing_fields){de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Dados faltando para gerar etiqueta"})}),n.jsx("p",{className:"text-sm",children:I.missing_fields.join(", ")})]}));return}const $=I.status||I.statusCode||"Erro";de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsxs("strong",{children:["Erro ao gerar etiqueta (",$,")"]})}),n.jsx("p",{className:"text-sm",children:I.error||I.message||"Erro desconhecido"}),I.details&&n.jsx("p",{className:"text-xs text-muted-foreground",children:I.details})]}),{duration:8e3});return}(I!=null&&I.success||I!=null&&I.label_url)&&(de.success(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Etiqueta gerada com sucesso!"})}),I.tracking_code&&n.jsxs("p",{className:"text-sm",children:["Rastreio: ",I.tracking_code]})]})),r&&r(I.label_url,I.tracking_code),I.label_url&&window.open(I.label_url,"_blank"))}catch(N){console.error("[ShippingLabel] Unexpected error:",N),de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Erro inesperado"})}),n.jsx("p",{className:"text-sm",children:(N==null?void 0:N.message)||"Falha ao gerar etiqueta"})]}),{duration:8e3})}finally{i(!1)}},E=()=>{e.me_label_url&&window.open(e.me_label_url,"_blank")};return v?q?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex flex-col gap-2",children:[!L&&n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 border-amber-300 text-amber-700 hover:bg-amber-50",onClick:H,children:[n.jsx(nc,{className:"h-4 w-4"}),"Cadastrar CPF para Etiqueta"]}),n.jsxs("span",{className:"text-xs text-amber-600 flex items-center gap-1",children:[n.jsx(Cn,{className:"h-3 w-3"}),"CPF obrigatrio para gerar etiqueta Correios"]})]}),n.jsx(he,{variant:t==="full"?"default":"outline",size:"sm",className:t==="full"?`gap-2 ${X?"bg-orange-600 hover:bg-orange-700":"bg-muted text-muted-foreground cursor-not-allowed"}`:`gap-2 ${X?"border-orange-300 text-orange-700 hover:bg-orange-50":"border-muted text-muted-foreground cursor-not-allowed"}`,onClick:N=>{N.stopPropagation(),X&&F()},disabled:a||!X,children:a?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 animate-spin"}),"Gerando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(gn,{className:"h-4 w-4"}),t==="full"?"Gerar Etiqueta (Melhor Envio)":"Gerar Etiqueta"]})}),L&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs text-green-600",children:["CPF: ",Fy(D)]}),n.jsxs(he,{variant:"ghost",size:"sm",className:"h-5 px-1 text-xs text-muted-foreground hover:text-foreground",onClick:N=>{N.stopPropagation(),H()},children:[n.jsx(nc,{className:"h-3 w-3 mr-1"}),"Editar"]})]})]}),n.jsx(Ac,{open:o,onOpenChange:c,children:n.jsxs(Dl,{children:[n.jsxs(Ll,{children:[n.jsx(Bl,{children:"Gerar Etiqueta dos Correios?"}),n.jsxs($l,{className:"space-y-2",children:[n.jsx("p",{children:"Esta ao ir:"}),n.jsxs("ul",{className:"list-disc list-inside text-sm space-y-1",children:[n.jsx("li",{children:"Comprar a etiqueta no Melhor Envio (dbito na carteira)"}),n.jsx("li",{children:"Gerar o PDF oficial para postagem nos Correios"}),n.jsx("li",{children:'Atualizar o status do pedido para "Etiqueta Gerada"'})]}),n.jsxs("p",{className:"font-medium mt-2",children:["Destinatrio: ",e.customer_name,n.jsx("br",{}),"CPF: ",Fy(D),n.jsx("br",{}),"CEP: ",O==null?void 0:O.zip_code]})]})]}),n.jsxs(Tc,{children:[n.jsx(Oc,{children:"Cancelar"}),n.jsx(Pc,{onClick:S,className:"bg-orange-600 hover:bg-orange-700",children:"Confirmar e Gerar"})]})]})}),n.jsx(cn,{open:d,onOpenChange:l,children:n.jsxs(sn,{className:"sm:max-w-md",children:[n.jsxs(fn,{children:[n.jsxs(dn,{children:[L?"Editar":"Cadastrar"," CPF do Destinatrio"]}),n.jsx(Zo,{children:"O CPF  obrigatrio para gerar etiquetas dos Correios via Melhor Envio."})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"cpf",children:"CPF (11 dgitos)"}),n.jsx(Qe,{id:"cpf",value:Fy(u),onChange:N=>h(N.target.value.replace(/\D/g,"").slice(0,11)),placeholder:"000.000.000-00",maxLength:14}),u&&u.length>0&&u.length!==11&&n.jsxs("p",{className:"text-xs text-amber-600",children:["CPF deve ter 11 dgitos (",u.length,"/11)"]})]}),n.jsxs("div",{className:"bg-muted/50 rounded p-3 text-sm",children:[n.jsx("p",{className:"font-medium",children:"Destinatrio:"}),n.jsx("p",{children:e.customer_name}),n.jsxs("p",{className:"text-muted-foreground text-xs mt-1",children:[O==null?void 0:O.city,"/",O==null?void 0:O.state," - CEP ",O==null?void 0:O.zip_code]})]})]}),n.jsxs(Da,{children:[n.jsx(he,{variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),n.jsxs(he,{onClick:M,disabled:u.length!==11||f,className:"gap-2",children:[f?n.jsx(At,{className:"h-4 w-4 animate-spin"}):n.jsx(td,{className:"h-4 w-4"}),"Salvar CPF"]})]})]})})]}):T?n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsxs(he,{variant:t==="full"?"default":"outline",size:"sm",className:t==="full"?"gap-2 bg-green-600 hover:bg-green-700":"gap-2 border-green-300 text-green-700 hover:bg-green-50",onClick:N=>{N.stopPropagation(),E()},children:[n.jsx(ma,{className:"h-4 w-4"}),t==="full"?"Imprimir Etiqueta Correios":"Imprimir Etiqueta"]}),e.tracking_code&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["Rastreio: ",e.tracking_code]}),L&&n.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[n.jsx(Yo,{className:"h-3 w-3"}),n.jsxs("span",{children:["CPF: ",Fy(D)]}),n.jsx("span",{className:"text-[10px] italic",children:"(no editvel aps etiqueta)"})]})]}):j?n.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-amber-50 border border-amber-200 rounded-lg",children:[n.jsx(Yo,{className:"h-4 w-4 text-amber-600"}),n.jsx("span",{className:"text-xs text-amber-700 font-medium",children:" Aguardando pagamento para liberar envio"})]}):y&&!x?n.jsxs("div",{className:"flex items-center gap-2 px-2 py-1.5 bg-green-50 border border-green-200 rounded-lg",children:[n.jsx(gn,{className:"h-4 w-4 text-green-600"}),n.jsxs("span",{className:"text-xs text-green-700 font-medium",children:[" Etiqueta j gerada ",e.tracking_code?` ${e.tracking_code}`:""]})]}):R?null:n.jsxs("span",{className:"text-xs text-red-500 flex items-center gap-1",children:[n.jsx(Cn,{className:"h-3 w-3"}),"Endereo incompleto"]}):null}const yye={pendente:e=>`Oi, ${e.customerName}! 

Seu pedido #${e.shortId} foi recebido e est aguardando confirmao.

Qualquer dvida, estou por aqui! `,aguardando_pagamento:e=>`Oi, ${e.customerName}! 

Seu pedido #${e.shortId} est aguardando pagamento.

${e.total?`*Total:* ${e.total}

`:""}Assim que o pagamento for confirmado, j comeamos a preparar! `,pago:e=>`Oi, ${e.customerName}! 

Pagamento confirmado 

J vamos preparar seu pedido #${e.shortId} com muito carinho!

Qualquer coisa, estou por aqui! `,confirmado:e=>`Oi, ${e.customerName}! 

Seu pedido #${e.shortId} foi confirmado e est sendo preparado!

Em breve voc receber as atualizaes de envio. `,enviado:e=>`Oi, ${e.customerName}! 

Boa notcia! Seu pedido #${e.shortId} foi enviado!

${e.trackingCode?` *Cdigo de rastreio:* ${e.trackingCode}

Voc pode acompanhar pelo site dos Correios.`:"Em breve voc receber o cdigo de rastreio."}

Qualquer coisa, estou por aqui! `,entregue:e=>`Oi, ${e.customerName}! 

Seu pedido #${e.shortId} foi entregue! 

Esperamos que tenha gostado! Se puder, compartilha uma foto usando as peas - adoramos ver! 

Obrigada pela confiana! `,cancelado:e=>`Oi, ${e.customerName}.

Informamos que seu pedido #${e.shortId} foi cancelado.

Se precisar de algo ou tiver dvidas, estamos  disposio! `,pagamento_rejeitado:e=>`Oi, ${e.customerName}! 

Houve um problema com o pagamento do pedido #${e.shortId}.

Por favor, tente novamente ou entre em contato para resolvermos juntos! `,reembolsado:e=>`Oi, ${e.customerName}.

O reembolso do pedido #${e.shortId} foi processado.

O valor ser estornado conforme a poltica do seu mtodo de pagamento.

Se precisar de algo, estamos aqui! `};function tm(e,t){const r=yye[e];return r?r(t):`Oi, ${t.customerName}! Qualquer dvida sobre o pedido #${t.shortId}, estou  disposio! `}function rm(e){return e.slice(0,8).toUpperCase()}function Is(e){const t=new URLSearchParams;return t.set("tab","orders"),e.status&&t.set("status",e.status),e.source&&t.set("source",e.source),e.seller&&t.set("seller",e.seller),e.specialFilter&&t.set("filter",e.specialFilter),e.startDate&&t.set("from",e.startDate),e.endDate&&t.set("to",e.endDate),`/dashboard?${t.toString()}`}const zs={pendencias:()=>Is({specialFilter:"pendencias"}),faturamentoPago:()=>Is({status:"pago"}),reservado:()=>Is({status:"aguardando_pagamento"}),conversao:()=>Is({specialFilter:"funil"}),pagos:()=>Is({status:"pago"}),pendentes:()=>Is({status:"aguardando_pagamento"}),cancelados:()=>Is({status:"cancelado"}),catalogPagos:()=>Is({source:"catalog",status:"pago"}),catalogPendentes:()=>Is({source:"catalog",status:"aguardando_pagamento"}),catalogAll:()=>Is({source:"catalog"}),livePagos:()=>Is({source:"live",status:"pago"}),livePendentes:()=>Is({source:"live",status:"aguardando_pagamento"}),liveAll:()=>Is({source:"live"}),aguardandoPagamento24h:()=>Is({specialFilter:"aguardando-24h"}),aguardandoRetorno24h:()=>Is({specialFilter:"aguardando-retorno"}),naoCobrado:()=>Is({specialFilter:"nao-cobrado"}),pagoSemLogistica:()=>Is({status:"pago",specialFilter:"sem-logistica"}),etiquetaPendente:()=>Is({specialFilter:"etiqueta-pendente"}),semVendedora:()=>Is({specialFilter:"sem-vendedora"}),urgente:()=>Is({specialFilter:"urgente"}),liveEventOrders:e=>Is({source:"live",specialFilter:`live-event:${e}`}),sellerOrders:e=>Is({seller:e})};function vM(e){const t=e.get("status")||"all",r=e.get("source")||"all",s=e.get("seller"),a=e.get("filter");let i=null;return a!=null&&a.startsWith("live-event:")&&(i=a.replace("live-event:","")),{status:t,source:r,seller:s,specialFilter:a,liveEventId:i}}function bye(e){if(!e)return null;const t={pendencias:"Pendncias operacionais",funil:"Anlise de funil","aguardando-24h":"Aguardando pagamento +24h","aguardando-retorno":"Aguardando retorno +24h","nao-cobrado":"No cobrados","sem-logistica":"Pagos sem logstica definida","etiqueta-pendente":"Etiqueta pendente","sem-vendedora":"Sem vendedora atribuda",urgente:"Urgentes"};return e.startsWith("live-event:")?"Pedidos da Live":t[e]||null}function yM(e){return e!==null&&["pendencias","aguardando-24h","aguardando-retorno","nao-cobrado","sem-logistica","etiqueta-pendente","sem-vendedora","urgente"].includes(e)}const wye=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"],bM=["postado","em_rota","retirada","entregue"];async function qC(e={}){const t=new Date;new Date(t.getTime()-24*60*60*1e3),new Date(t.getTime()-12*60*60*1e3),new Date(t.getTime()-8*60*60*1e3);let r=ce.from("orders").select("*").neq("status","cancelado");e.startDate&&(r=r.gte("created_at",e.startDate.toISOString())),e.endDate&&(r=r.lte("created_at",e.endDate.toISOString())),e.liveEventId&&(r=r.eq("live_event_id",e.liveEventId)),e.sellerId&&(r=r.eq("seller_id",e.sellerId));const s=`SELECT * FROM orders WHERE status != 'cancelado'${e.startDate?` AND created_at >= '${e.startDate.toISOString()}'`:""}${e.endDate?` AND created_at <= '${e.endDate.toISOString()}'`:""}`,{data:a,error:i}=await r;if(i)return console.error("[getOperationalPendingOrders] Error:",i),{summary:[],allOrders:[],debug:`Error: ${i.message}`};const o=[],c=new Map,d=(h,f,m)=>({type:h,title:f,count:0,value:0,severity:m,orders:[]});c.set("aguardando_pagamento_24h",d("aguardando_pagamento_24h","Aguardando pagamento >24h","error")),c.set("aguardando_retorno_24h",d("aguardando_retorno_24h","Aguardando retorno >24h","error")),c.set("pago_sem_logistica",d("pago_sem_logistica","Pagos sem logstica >12h","warning")),c.set("etiqueta_pendente",d("etiqueta_pendente","Etiqueta gerada sem postagem >24h","warning")),c.set("sem_vendedora",d("sem_vendedora","Pedidos sem vendedora","info")),c.set("urgente",d("urgente","Pedidos em rota >8h","error")),(a||[]).forEach(h=>{const f=new Date(h.created_at),m=new Date(h.updated_at),p=Math.round((t.getTime()-m.getTime())/(1e3*60*60)),g=Math.round((t.getTime()-f.getTime())/(1e3*60*60)),v={id:h.id,customer_name:h.customer_name,customer_phone:h.customer_phone,total:h.total||0,status:h.status,created_at:h.created_at,updated_at:h.updated_at,delivery_method:h.delivery_method,seller_id:h.seller_id,live_event_id:h.live_event_id,hoursStalled:p};if((h.status==="pendente"||h.status==="aguardando_pagamento"||h.payment_status==="pending")&&g>24){const x={...v,type:"aguardando_pagamento_24h"},y=c.get("aguardando_pagamento_24h");y.count++,y.value+=h.total||0,y.orders.push(x),o.push(x);return}if(h.status==="aguardando_retorno"&&p>24){const x={...v,type:"aguardando_retorno_24h"},y=c.get("aguardando_retorno_24h");y.count++,y.value+=h.total||0,y.orders.push(x),o.push(x);return}if(wye.slice(0,2).includes(h.status)&&h.delivery_method==="shipping"&&!bM.includes(h.status)&&p>12){const x={...v,type:"pago_sem_logistica"},y=c.get("pago_sem_logistica");y.count++,y.value+=h.total||0,y.orders.push(x),o.push(x);return}if(h.status==="etiqueta_gerada"&&p>24){const x={...v,type:"etiqueta_pendente"},y=c.get("etiqueta_pendente");y.count++,y.value+=h.total||0,y.orders.push(x),o.push(x);return}if(!h.seller_id&&!bM.includes(h.status)){const x={...v,type:"sem_vendedora"},y=c.get("sem_vendedora");y.count++,y.value+=h.total||0,y.orders.push(x),o.push(x);return}if(h.status==="em_rota"&&p>8){const x={...v,type:"urgente"},y=c.get("urgente");y.count++,y.value+=h.total||0,y.orders.push(x),o.push(x);return}});let l=Array.from(c.values()).filter(h=>h.count>0);e.type&&(l=l.filter(h=>h.type===e.type));const u=`${s} | Total orders: ${(a==null?void 0:a.length)||0} | Pending: ${o.length}`;return{summary:l,allOrders:o,debug:u}}const zy={aberto:{label:"Sacola Aberta",icon:Br,color:"bg-blue-50 text-blue-600 border-blue-200"},aguardando_retorno:{label:"Aguardando Retorno",icon:Br,color:"bg-orange-50 text-orange-600 border-orange-200"},pendente:{label:"Pendente",icon:Br,color:"bg-amber-100 text-amber-800"},aguardando_pagamento:{label:"Aguardando Pagamento",icon:xs,color:"bg-orange-100 text-orange-800"},pago:{label:"Pago",icon:Er,color:"bg-green-100 text-green-800"},etiqueta_gerada:{label:"Etiqueta Gerada",icon:af,color:"bg-cyan-100 text-cyan-800"},confirmado:{label:"Confirmado",icon:Er,color:"bg-blue-100 text-blue-800"},enviado:{label:"Enviado",icon:gn,color:"bg-purple-100 text-purple-800"},entregue:{label:"Entregue",icon:Er,color:"bg-green-100 text-green-800"},cancelado:{label:"Cancelado",icon:an,color:"bg-red-100 text-red-800"},pagamento_rejeitado:{label:"Pagamento Rejeitado",icon:an,color:"bg-red-100 text-red-800"},reembolsado:{label:"Reembolsado",icon:Br,color:"bg-gray-100 text-gray-800"},abandonado:{label:"Abandonado",icon:an,color:"bg-gray-100 text-gray-400"},aguardando_pagamento_frete:{label:"Aguardando Pag. Frete",icon:xs,color:"bg-yellow-100 text-yellow-800"}},wM=[{value:"aberto",label:"Sacola Aberta"},{value:"aguardando_retorno",label:"Aguardando Retorno"},{value:"pendente",label:"Pendente"},{value:"aguardando_pagamento",label:"Aguardando Pagamento"},{value:"pago",label:"Pago"},{value:"etiqueta_gerada",label:"Etiqueta Gerada"},{value:"confirmado",label:"Confirmado"},{value:"enviado",label:"Enviado"},{value:"entregue",label:"Entregue"},{value:"cancelado",label:"Cancelado"},{value:"pagamento_rejeitado",label:"Pagamento Rejeitado"},{value:"reembolsado",label:"Reembolsado"},{value:"aguardando_pagamento_frete",label:"Aguardando Pag. Frete"}],_ye={"aguardando-24h":"aguardando_pagamento_24h","aguardando-retorno":"aguardando_retorno_24h","nao-cobrado":"nao_cobrado","sem-logistica":"pago_sem_logistica","etiqueta-pendente":"etiqueta_pendente","sem-vendedora":"sem_vendedora",urgente:"urgente"};function jye({initialFilter:e}){var st,xt;const[t,r]=kc(),s=P.useMemo(()=>vM(t),[t]),[a,i]=P.useState([]),[o,c]=P.useState({}),[d,l]=P.useState(!0),[u,h]=P.useState(null),[f,m]=P.useState(()=>s.status!=="all"?s.status:ue(e)||"all"),[p,g]=P.useState(()=>s.source||"all"),[v,x]=P.useState(()=>s.seller),[y,b]=P.useState(()=>s.specialFilter),[j,T]=P.useState(new Set),[O,R]=P.useState(""),[D,L]=P.useState(null),[q,X]=P.useState(""),[H,M]=P.useState(null),[F,S]=P.useState(""),[E,N]=P.useState(!1),[C,k]=P.useState(null),[I,U]=P.useState({}),[$,Y]=P.useState({}),[Z,re]=P.useState(null),[G,J]=P.useState(new Set),[V,W]=P.useState(null),[ee,ie]=P.useState(""),{sellers:oe}=h8(),se=fe=>{J(Ie=>{const tt=new Set(Ie);return tt.has(fe)?tt.delete(fe):tt.add(fe),tt})},le=()=>{G.size===Ve.length?J(new Set):J(new Set(Ve.map(fe=>fe.id)))},ye=()=>Array.from(G).map(fe=>{const Ie=a.find(lt=>lt.id===fe),tt=o[fe]||[];return Ie?{order:Ie,items:tt}:null}).filter(fe=>fe!==null);function ue(fe){return fe?{aguardando:"aguardando_pagamento",pagos:"pago",separar:"pago",envio:"enviado",retirada:"pago",cancelado:"cancelado"}[fe]||fe:void 0}P.useEffect(()=>{const fe=vM(t);fe.status!=="all"&&m(fe.status),fe.source!=="all"&&g(fe.source),fe.seller&&x(fe.seller),fe.specialFilter&&b(fe.specialFilter)},[t]),P.useEffect(()=>{ne()},[]),P.useEffect(()=>{y&&yM(y)?pe():T(new Set)},[y]);const ne=async()=>{l(!0);try{const{data:fe,error:Ie}=await ce.from("orders").select(`
          *,
          live_event:live_events(titulo),
          coupon:coupons(code)
        `).order("created_at",{ascending:!1});if(Ie)throw Ie;const{data:tt,error:lt}=await ce.from("live_carts").select(`
        *,
          live_customer: live_customers(*),
          live_event: live_events(titulo)
          `).is("order_id",null).in("status",["aberto","em_confirmacao","aguardando_pagamento","pago"]).order("created_at",{ascending:!1});lt&&console.error("Error fetching live carts:",lt);const It=(tt||[]).map(at=>{var gt,Yt,St,rt;return{id:at.id,created_at:at.created_at,status:at.operational_status||at.status,total:at.total,customer_name:((gt=at.live_customer)==null?void 0:gt.nome)||((Yt=at.live_customer)==null?void 0:Yt.instagram_handle)||"Cliente Live",customer_phone:((St=at.live_customer)==null?void 0:St.whatsapp)||"",customer_address:((rt=at.shipping_address_snapshot)==null?void 0:rt.full_address)||"Endereo no capturado",customer_id:at.user_id||null,payment_link:null,tracking_code:at.shipping_tracking_code||null,delivery_method:at.delivery_method,live_event_id:at.live_event_id,seller_id:at.seller_id,internal_notes:null,mp_checkout_url:null,customer_notes:at.customer_checkout_notes||at.customer_live_notes,delivery_period:at.delivery_period,last_whatsapp_status:null,last_whatsapp_sent_at:null,whatsapp_message_override:null,reserved_until:null,address_snapshot:at.shipping_address_snapshot,me_shipment_id:at.me_shipment_id,me_label_url:at.me_label_url,paid_at:at.paid_at,source:"live",live_cart_id:at.id,live_bag_number:at.bag_number,live_event:at.live_event,requires_physical_cancel:!1}}),ct=[...fe||[],...It].sort((at,gt)=>new Date(gt.created_at).getTime()-new Date(at.created_at).getTime());i(ct)}catch(fe){console.error("Error loading orders:",fe),de.error("Erro ao carregar pedidos")}finally{l(!1)}},pe=async()=>{if(!y)return;if(y==="pendencias"){const lt=await qC({}),It=new Set(lt.allOrders.map(ct=>ct.id));T(It);return}const fe=_ye[y];if(!fe)return;const Ie=await qC({type:fe}),tt=new Set(Ie.allOrders.map(lt=>lt.id));T(tt)},ge=()=>{m("all"),g("all"),x(null),b(null),R("");const fe=new URLSearchParams;fe.set("tab","orders"),r(fe)},Ne=async fe=>{if(o[fe])return;const{data:Ie}=await ce.from("order_items").select("*").eq("order_id",fe);Ie&&c(tt=>({...tt,[fe]:Ie}))},_e=async(fe,Ie)=>{const tt=a.find(St=>St.id===fe);if(!tt)return;const lt=Ie.toLowerCase().trim(),It=["pago","paid","approved","payment_approved"].includes(lt),ct={status:Ie,updated_at:new Date().toISOString()};It&&!tt.paid_at&&(ct.paid_at=new Date().toISOString());const{error:at}=await ce.from("orders").update(ct).eq("id",fe);if(at){de.error("Erro ao atualizar status");return}i(St=>St.map(rt=>rt.id===fe?{...rt,status:Ie,paid_at:ct.paid_at||rt.paid_at}:rt));const gt={customerName:tt.customer_name.split(" ")[0],shortId:rm(fe),trackingCode:tt.tracking_code,total:it(tt.total)},Yt=tm(Ie,gt);U(St=>({...St,[fe]:Yt})),Y(St=>({...St,[fe]:!0})),de.success("Status atualizado  mensagem pronta para enviar!")},be=async(fe,Ie)=>{const{error:tt}=await ce.from("orders").update({seller_id:Ie==="none"?null:Ie}).eq("id",fe);if(tt){de.error("Erro ao atualizar vendedora");return}i(lt=>lt.map(It=>It.id===fe?{...It,seller_id:Ie==="none"?null:Ie}:It)),de.success("Vendedora atualizada")},Me=fe=>{const Ie=(fe.status||"").toLowerCase().trim();return["pago","paid","approved","payment_approved","etiqueta_gerada","enviado","entregue"].includes(Ie)||!!fe.paid_at?{allowed:!1,reason:"No  possvel alterar entrega aps pagamento confirmado."}:fe.tracking_code||fe.me_label_url||fe.me_shipment_id?{allowed:!1,reason:"No  possvel alterar entrega com etiqueta/rastreio gerado."}:{allowed:!0}},Se=async(fe,Ie)=>{const tt=a.find(ct=>ct.id===fe);if(!tt)return;const lt=Me(tt);if(!lt.allowed){de.error(n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{children:n.jsx("strong",{children:"Alterao bloqueada"})}),n.jsx("p",{className:"text-sm",children:lt.reason}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Coloque o pedido em ATENO para ajuste manual."})]}),{duration:6e3});return}const{error:It}=await ce.from("orders").update({delivery_method:Ie,updated_at:new Date().toISOString()}).eq("id",fe);if(It){de.error("Erro ao atualizar mtodo de entrega");return}i(ct=>ct.map(at=>at.id===fe?{...at,delivery_method:Ie}:at)),W(null),de.success(`Mtodo de entrega alterado para ${ut(Ie)}`)},$e=async fe=>{const{error:Ie}=await ce.from("orders").update({internal_notes:F||null}).eq("id",fe);if(Ie){de.error("Erro ao salvar observao");return}i(tt=>tt.map(lt=>lt.id===fe?{...lt,internal_notes:F||null}:lt)),M(null),de.success("Observao salva")},Ke=async fe=>{const{error:Ie}=await ce.from("orders").update({tracking_code:q||null}).eq("id",fe);if(Ie){de.error("Erro ao salvar cdigo");return}i(tt=>tt.map(lt=>lt.id===fe?{...lt,tracking_code:q||null}:lt)),L(null),de.success("Cdigo de rastreio salvo")},Ze=fe=>new Date(fe).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}),it=fe=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(fe),Re=fe=>fe.slice(0,8).toUpperCase(),ot=fe=>{var Ie;if(fe.source==="live"||fe.live_event_id){const tt=(Ie=fe.live_event)!=null&&Ie.titulo?`  ${fe.live_event.titulo}`:"",lt=fe.live_bag_number?`  Sacola #${fe.live_bag_number}`:"";return{label:"Live",icon:Ts,color:"bg-pink-100 text-pink-700",details:`${tt}${lt}`.replace(/^  /,"")}}return{label:"Loja Online",icon:pa,color:"bg-blue-100 text-blue-700",details:""}},ut=fe=>{switch(fe){case"motoboy":return"Motoboy";case"pickup":return"Retirada na loja";case"shipping":return"Correios";default:return"No definido"}},bt=fe=>{if(!fe)return null;const Ie=oe.find(tt=>tt.id===fe);return(Ie==null?void 0:Ie.name)||null},Je=fe=>{if(fe.status!=="aguardando_pagamento"||!fe.reserved_until)return null;const Ie=new Date,lt=new Date(fe.reserved_until).getTime()-Ie.getTime();if(lt<=0)return{expired:!0,text:"Expirado",minutesLeft:0};const It=Math.ceil(lt/(1e3*60)),ct=Math.floor(It/60),at=Math.floor(ct/24);if(fe.source==="live"||fe.live_event_id){if(at>=1){const Yt=ct%24;return{expired:!1,text:Yt>0?`${at}d ${Yt}h`:`${at}d`,minutesLeft:It,urgent:at<1}}else if(ct>=1)return{expired:!1,text:`${ct}h`,minutesLeft:It,urgent:ct<6};return{expired:!1,text:`${It}min`,minutesLeft:It,urgent:!0}}return It<=5?{expired:!1,text:`${It}min`,minutesLeft:It,urgent:!0}:{expired:!1,text:`${It}min`,minutesLeft:It,urgent:!1}},Ce=a.filter(fe=>fe.requires_physical_cancel).length,Ge=f!=="all"||p!=="all"||v!==null||y!==null||O!=="",Pe=bye(y),Ve=P.useMemo(()=>a.filter(fe=>{if(y&&yM(y))return j.has(fe.id);const Ie=f==="all"||f==="attention"&&fe.requires_physical_cancel||fe.status===f,tt=p==="all"||p==="live"&&(fe.source==="live"||fe.live_event_id)||p==="catalog"&&fe.source!=="live"&&!fe.live_event_id,lt=!v||fe.seller_id===v,It=O===""||fe.customer_name.toLowerCase().includes(O.toLowerCase())||fe.customer_phone.includes(O)||fe.id.toLowerCase().includes(O.toLowerCase())||fe.live_bag_number&&fe.live_bag_number.toString().includes(O);return Ie&&tt&&lt&&It}),[a,f,p,v,y,j,O]);return d?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})}):n.jsxs("div",{className:"space-y-4",children:[Ge&&n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[n.jsx(wd,{className:"h-4 w-4"}),n.jsx("span",{children:"Filtros ativos:"})]}),Pe&&n.jsxs(Ae,{variant:"secondary",className:"gap-1",children:[Pe,n.jsx("button",{onClick:()=>b(null),className:"ml-1 hover:text-destructive",children:n.jsx(qn,{className:"h-3 w-3"})})]}),f!=="all"&&!y&&n.jsxs(Ae,{variant:"secondary",className:"gap-1",children:["Status: ",((st=zy[f])==null?void 0:st.label)||f,n.jsx("button",{onClick:()=>m("all"),className:"ml-1 hover:text-destructive",children:n.jsx(qn,{className:"h-3 w-3"})})]}),p!=="all"&&n.jsxs(Ae,{variant:"secondary",className:"gap-1",children:["Origem: ",p==="live"?"Live":"Catlogo",n.jsx("button",{onClick:()=>g("all"),className:"ml-1 hover:text-destructive",children:n.jsx(qn,{className:"h-3 w-3"})})]}),v&&n.jsxs(Ae,{variant:"secondary",className:"gap-1",children:["Vendedora: ",((xt=oe.find(fe=>fe.id===v))==null?void 0:xt.name)||v,n.jsx("button",{onClick:()=>x(null),className:"ml-1 hover:text-destructive",children:n.jsx(qn,{className:"h-3 w-3"})})]}),n.jsx(he,{variant:"ghost",size:"sm",onClick:ge,className:"h-6 text-xs",children:"Limpar todos"})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar por nome, telefone ou n pedido...",value:O,onChange:fe=>R(fe.target.value),className:"pl-9"})]}),n.jsxs(Kt,{value:p,onValueChange:g,children:[n.jsx(Vt,{className:"w-full sm:w-[120px]",children:n.jsx(Xt,{placeholder:"Origem"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todas origens"}),n.jsx(ze,{value:"catalog",children:"Loja Online"}),n.jsx(ze,{value:"live",children:"Live"})]})]}),n.jsxs(Kt,{value:f,onValueChange:fe=>{m(fe),y&&b(null)},children:[n.jsx(Vt,{className:"w-full sm:w-[200px]",children:n.jsx(Xt,{placeholder:"Filtrar por status"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos os status"}),Ce>0&&n.jsxs(ze,{value:"attention",className:"text-amber-600",children:[" Requerem ateno (",Ce,")"]}),wM.map(fe=>n.jsx(ze,{value:fe.value,children:fe.label},fe.value))]})]})]}),G.size>0&&n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-primary/5 border border-primary/20 rounded-lg",children:[n.jsxs("span",{className:"text-sm font-medium",children:[G.size," pedido",G.size>1?"s":""," selecionado",G.size>1?"s":""]}),n.jsx("div",{className:"flex-1"}),n.jsx(gye,{orders:ye()}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>J(new Set),children:"Limpar seleo"})]}),n.jsxs("div",{className:"bg-card rounded-xl border border-border overflow-hidden",children:[n.jsxs("div",{className:"hidden md:grid grid-cols-[32px_40px_80px_1fr_80px_minmax(160px,auto)_80px_90px] gap-3 px-4 py-3 bg-muted/40 border-b border-border text-sm font-medium text-muted-foreground",children:[n.jsx("div",{className:"flex items-center justify-center",children:n.jsx(va,{checked:G.size===Ve.length&&Ve.length>0,onCheckedChange:le})}),n.jsx("div",{}),n.jsx("div",{children:"Pedido"}),n.jsx("div",{children:"Cliente"}),n.jsx("div",{children:"Origem"}),n.jsx("div",{children:"Status"}),n.jsx("div",{className:"text-right",children:"Total"}),n.jsx("div",{className:"text-right",children:"Data"})]}),n.jsx("div",{className:"divide-y divide-border",children:Ve.map(fe=>{var Yt,St;const Ie=zy[fe.status]||zy.pendente,tt=Ie.icon,lt=ot(fe),It=lt.icon,ct=u===fe.id,at=bt(fe.seller_id),gt=Je(fe);return n.jsxs(Ag,{open:ct,onOpenChange:rt=>{h(rt?fe.id:null),rt&&Ne(fe.id)},children:[n.jsx(Tg,{asChild:!0,children:n.jsxs("div",{className:"cursor-pointer hover:bg-muted/50 transition-colors",children:[n.jsxs("div",{className:"hidden md:grid grid-cols-[32px_40px_80px_1fr_80px_minmax(160px,auto)_80px_90px] gap-3 px-4 py-3 items-center",children:[n.jsx("div",{className:"flex items-center justify-center",onClick:rt=>rt.stopPropagation(),children:n.jsx(va,{checked:G.has(fe.id),onCheckedChange:()=>{se(fe.id),Ne(fe.id)}})}),n.jsx("div",{children:n.jsx(Zi,{className:`h-4 w-4 text-muted-foreground transition-transform ${ct?"rotate-180":""}`})}),n.jsxs("div",{className:"font-mono text-xs text-muted-foreground",children:["#",Re(fe.id)]}),n.jsxs("div",{className:"min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("p",{className:"font-medium truncate text-sm",children:fe.customer_name}),at&&n.jsxs(Ae,{variant:"outline",className:"text-[10px] shrink-0 px-1.5 py-0",children:[n.jsx(Wn,{className:"h-2.5 w-2.5 mr-0.5"}),at]})]}),n.jsx("p",{className:"text-xs text-muted-foreground truncate",children:fe.customer_phone})]}),n.jsxs("div",{className:"flex flex-col gap-0.5 items-start",children:[n.jsxs(Ae,{className:`${lt.color} border-0 gap-1 text-[10px] px-1.5`,children:[n.jsx(It,{className:"h-2.5 w-2.5"}),lt.label]}),lt.details&&n.jsx("span",{className:"text-[9px] text-muted-foreground truncate max-w-[100px]",title:lt.details,children:lt.details})]}),n.jsxs("div",{className:"flex flex-col gap-1 items-start",children:[n.jsxs(Ae,{className:`${Ie.color} border-0 gap-1 text-xs`,children:[n.jsx(tt,{className:"h-3 w-3"}),Ie.label]}),gt&&n.jsxs(Ae,{className:`border-0 gap-1 text-[10px] px-1.5 py-0 ${gt.expired?"bg-destructive text-destructive-foreground":gt.urgent?"bg-amber-100 text-amber-700 animate-pulse-soft":"bg-secondary text-muted-foreground"}`,children:[n.jsx(ZS,{className:"h-2.5 w-2.5"}),gt.expired?"Reserva expirada":`Reserva: ${gt.text}`]}),fe.requires_physical_cancel&&n.jsxs(Ae,{className:"border-0 gap-1 text-[10px] px-1.5 py-0 bg-orange-100 text-orange-700 animate-pulse",children:[n.jsx(Cn,{className:"h-2.5 w-2.5"}),"Cancelar sacola fsica"]})]}),n.jsx("div",{className:"text-right font-semibold tabular-nums text-sm",children:it(fe.total)}),n.jsx("div",{className:"text-right text-xs text-muted-foreground whitespace-nowrap",children:Ze(fe.created_at)})]}),n.jsxs("div",{className:"md:hidden p-3",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Zi,{className:`h-4 w-4 text-muted-foreground transition-transform shrink-0 ${ct?"rotate-180":""}`}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:fe.customer_name}),n.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["#",Re(fe.id),"  ",Ze(fe.created_at)]})]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("p",{className:"font-semibold text-sm tabular-nums",children:it(fe.total)}),n.jsx(Ae,{className:`${lt.color} border-0 text-[10px] px-1.5 mt-1`,children:lt.label})]})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 ml-6",children:[n.jsxs(Ae,{className:`${Ie.color} border-0 gap-1 text-xs`,children:[n.jsx(tt,{className:"h-3 w-3"}),Ie.label]}),gt&&n.jsxs(Ae,{className:`border-0 gap-1 text-[10px] px-1.5 ${gt.expired?"bg-destructive text-destructive-foreground":gt.urgent?"bg-amber-100 text-amber-700 animate-pulse-soft":"bg-secondary text-muted-foreground"}`,children:[n.jsx(ZS,{className:"h-2.5 w-2.5"}),gt.expired?"Expirada":gt.text]}),fe.requires_physical_cancel&&n.jsxs(Ae,{className:"border-0 gap-1 text-[10px] px-1.5 bg-orange-100 text-orange-700 animate-pulse",children:[n.jsx(Cn,{className:"h-2.5 w-2.5"}),"Cancelar sacola"]}),at&&n.jsxs(Ae,{variant:"outline",className:"text-[10px] px-1.5 py-0",children:[n.jsx(Wn,{className:"h-2.5 w-2.5 mr-0.5"}),at]})]})]})]})}),n.jsx(Pg,{children:n.jsxs("div",{className:"px-4 py-4 bg-muted/20 border-t border-border",children:[fe.requires_physical_cancel&&n.jsxs(xf,{className:"mb-4 border-orange-200 bg-orange-50",children:[n.jsx(Cn,{className:"h-4 w-4 text-orange-600"}),n.jsxs(vf,{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-orange-700",children:[n.jsx("strong",{children:" Ateno:"})," Reserva expirada.  necessrio cancelar a sacola fsica da Live.",fe.live_bag_number&&` (Sacola #${fe.live_bag_number})`]}),n.jsx(he,{variant:"outline",size:"sm",className:"ml-2 border-orange-300 text-orange-700 hover:bg-orange-100",onClick:async rt=>{rt.stopPropagation();const{error:ir}=await ce.from("orders").update({requires_physical_cancel:!1,attention_reason:null,attention_at:null}).eq("id",fe.id);if(ir){de.error("Erro ao resolver ateno");return}i(Ct=>Ct.map(Te=>Te.id===fe.id?{...Te,requires_physical_cancel:!1,attention_reason:null,attention_at:null}:Te)),de.success("Ateno resolvida!")},children:" Marcar como resolvido"})]})]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsxs("div",{children:[n.jsx("h4",{className:"font-medium mb-3 text-sm",children:"Itens do pedido"}),n.jsx("div",{className:"space-y-2",children:((Yt=o[fe.id])==null?void 0:Yt.map(rt=>n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-background rounded-lg",children:[rt.image_url?n.jsx("img",{src:rt.image_url,alt:rt.product_name,className:"w-10 h-10 object-cover rounded"}):n.jsx("div",{className:"w-10 h-10 bg-secondary rounded flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:rt.product_name}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[rt.size,rt.color&&`  ${rt.color}`,"  x",rt.quantity]})]}),n.jsx("span",{className:"text-sm font-medium",children:it(rt.product_price*rt.quantity)})]},rt.id)))||n.jsx("p",{className:"text-sm text-muted-foreground",children:"Carregando..."})}),n.jsx(Ta,{className:"my-4"}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-muted-foreground",children:"Entrega: "}),V===fe.id?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Kt,{value:ee||fe.delivery_method||"",onValueChange:rt=>ie(rt),children:[n.jsx(Vt,{className:"h-7 w-[140px] text-xs",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"pickup",children:"Retirada na loja"}),n.jsx(ze,{value:"motoboy",children:"Motoboy"}),n.jsx(ze,{value:"shipping",children:"Correios"})]})]}),n.jsx(he,{size:"sm",className:"h-7 px-2",onClick:()=>Se(fe.id,ee||fe.delivery_method||""),disabled:!ee||ee===fe.delivery_method,children:n.jsx(td,{className:"h-3 w-3"})}),n.jsx(he,{size:"sm",variant:"ghost",className:"h-7 px-2",onClick:()=>{W(null),ie("")},children:n.jsx(an,{className:"h-3 w-3"})})]}):n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"font-medium",children:ut(fe.delivery_method)}),Me(fe).allowed?n.jsxs(he,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs gap-1 text-muted-foreground hover:text-foreground",onClick:ir=>{ir.stopPropagation(),W(fe.id),ie(fe.delivery_method||"")},children:[n.jsx(nc,{className:"h-3 w-3"}),"Alterar"]}):n.jsxs("span",{className:"text-xs text-muted-foreground flex items-center gap-1 ml-2",children:[n.jsx(Yo,{className:"h-3 w-3"}),"Bloqueado"]})]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Endereo: "}),n.jsx("span",{children:fe.customer_address})]}),fe.delivery_method==="shipping"&&n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"CPF: "}),(()=>{var ir,Ct;const rt=(((ir=fe.address_snapshot)==null?void 0:ir.document)||((Ct=fe.address_snapshot)==null?void 0:Ct.cpf)||"").replace(/\D/g,"");return rt.length===11?n.jsx("span",{className:"font-medium text-green-700",children:rt.replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4")}):n.jsx("span",{className:"text-amber-600 font-medium",children:"No cadastrado"})})()]}),fe.delivery_method==="shipping"&&(fe.tracking_code||fe.me_label_url||fe.status==="etiqueta_gerada")&&n.jsx("div",{className:"mt-2 pt-2 border-t border-dashed border-border",children:(Ct=>{if(!Ct||Ct.startsWith("ORD-")||Ct.startsWith("ORD"))return!1;const Te=/^[A-Z]{2}\d{9}BR$/.test(Ct),qe=/^\d{8,20}$/.test(Ct);return Te||qe})(fe.tracking_code)?n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsx("span",{className:"text-muted-foreground",children:"Rastreio:"}),n.jsx(Ae,{variant:"outline",className:"font-mono text-xs bg-purple-50 text-purple-700 border-purple-200",children:fe.tracking_code}),n.jsxs(he,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs gap-1",onClick:async Ct=>{Ct.stopPropagation(),await gf(fe.tracking_code)?de.success("Cdigo de rastreio copiado!"):de.error("Erro ao copiar")},children:[n.jsx(Ia,{className:"h-3 w-3"}),"Copiar"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs gap-1",onClick:Ct=>{Ct.stopPropagation(),window.open(`https://www.correios.com.br/rastreamento?objetos=${fe.tracking_code}`,"_blank")},children:[n.jsx(gn,{className:"h-3 w-3"}),"Acompanhar"]}),n.jsx(he,{variant:"ghost",size:"sm",className:"h-6 px-2 text-xs gap-1 text-muted-foreground",onClick:Ct=>{Ct.stopPropagation(),L(fe.id),X(fe.tracking_code||"")},children:n.jsx(nc,{className:"h-3 w-3"})})]}):n.jsx("div",{className:"space-y-2",children:D===fe.id?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Qe,{value:q,onChange:Ct=>X(Ct.target.value.toUpperCase()),placeholder:"Ex: AB123456789BR",className:"h-8 text-sm font-mono flex-1 max-w-[200px]",onClick:Ct=>Ct.stopPropagation()}),n.jsx(he,{size:"sm",className:"h-8",onClick:async Ct=>{Ct.stopPropagation(),await Ke(fe.id)},children:n.jsx(td,{className:"h-3 w-3"})}),n.jsx(he,{size:"sm",variant:"ghost",className:"h-8",onClick:Ct=>{Ct.stopPropagation(),L(null)},children:n.jsx(an,{className:"h-3 w-3"})})]}):n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsxs("div",{className:"flex items-center gap-1 text-amber-600",children:[n.jsx(Cn,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs",children:"Rastreio no encontrado"})]}),fe.me_shipment_id&&n.jsxs(he,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs gap-1",onClick:async Ct=>{Ct.stopPropagation(),de.loading("Sincronizando rastreio...",{id:`sync-${fe.id}`});try{const{data:Te,error:qe}=await ce.functions.invoke("sync-order-tracking",{body:{orderId:fe.id}});qe||Te!=null&&Te.error?de.error((Te==null?void 0:Te.error)||"Erro ao sincronizar",{id:`sync-${fe.id}`}):Te!=null&&Te.tracking_code?(de.success(`Rastreio sincronizado: ${Te.tracking_code}`,{id:`sync-${fe.id}`}),ne()):de.error("Rastreio ainda no disponvel",{id:`sync-${fe.id}`})}catch{de.error("Erro ao sincronizar rastreio",{id:`sync-${fe.id}`})}},children:[n.jsx(en,{className:"h-3 w-3"}),"Sincronizar"]}),(fe.me_label_url||fe.status==="etiqueta_gerada")&&n.jsxs(he,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs gap-1",onClick:Ct=>{Ct.stopPropagation(),L(fe.id),X(fe.tracking_code||"")},children:[n.jsx(nc,{className:"h-3 w-3"}),"Editar rastreio"]})]})})})]}),n.jsxs("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-dashed border-border",children:[n.jsx(pye,{order:fe,items:o[fe.id]||[]}),n.jsx(vye,{order:fe,onLabelGenerated:(rt,ir)=>{i(Ct=>Ct.map(Te=>Te.id===fe.id?{...Te,me_label_url:rt,tracking_code:ir,shipping_status:"etiqueta_gerada",shipping_label_generated_at:new Date().toISOString()}:Te))},onOrderUpdated:rt=>{i(ir=>ir.map(Ct=>Ct.id===rt.id?{...Ct,address_snapshot:rt.address_snapshot}:Ct))}})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Alterar status"}),n.jsxs(Kt,{value:fe.status,onValueChange:rt=>_e(fe.id,rt),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsx(qt,{children:wM.map(rt=>n.jsx(ze,{value:rt.value,children:rt.label},rt.value))})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"text-sm font-medium mb-2 block flex items-center gap-2",children:[n.jsx(Wn,{className:"h-4 w-4"}),"Vendedora responsvel"]}),n.jsxs(Kt,{value:fe.seller_id||"none",onValueChange:rt=>be(fe.id,rt),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecionar vendedora"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"none",children:"Nenhuma"}),oe.map(rt=>n.jsx(ze,{value:rt.id,children:rt.name},rt.id))]})]})]}),fe.customer_notes&&n.jsxs("div",{children:[n.jsxs("label",{className:"text-sm font-medium mb-2 block flex items-center gap-2",children:[n.jsx(nn,{className:"h-4 w-4 text-blue-500"}),"Observao do cliente"]}),n.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[fe.customer_notes,fe.delivery_period&&n.jsxs("p",{className:"mt-2 text-xs text-blue-600",children:["Perodo preferido: ",fe.delivery_period==="manha"?"Manh":fe.delivery_period==="tarde"?"Tarde":"Qualquer horrio"]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"text-sm font-medium mb-2 block flex items-center gap-2",children:[n.jsx(kae,{className:"h-4 w-4"}),"Observao interna"]}),H===fe.id?n.jsxs("div",{className:"space-y-2",children:[n.jsx(Yn,{placeholder:"Ex: Cliente vai passar na loja dia 30/01 para experimentar...",value:F,onChange:rt=>S(rt.target.value),rows:3}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{size:"sm",onClick:()=>$e(fe.id),children:[n.jsx(td,{className:"h-4 w-4 mr-1"}),"Salvar"]}),n.jsx(he,{size:"sm",variant:"ghost",onClick:()=>M(null),children:"Cancelar"})]})]}):n.jsxs("div",{className:"flex items-start gap-2",children:[fe.internal_notes?n.jsx("div",{className:"flex-1 p-3 bg-amber-50 border border-amber-200 rounded-lg text-sm",children:fe.internal_notes}):n.jsx("span",{className:"text-sm text-muted-foreground italic",children:"Sem observaes"}),n.jsx(he,{size:"sm",variant:"ghost",onClick:()=>{S(fe.internal_notes||""),M(fe.id)},children:n.jsx(nc,{className:"h-4 w-4"})})]})]}),fe.status==="enviado"&&n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Cdigo de rastreio"}),D===fe.id?n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Qe,{placeholder:"Ex: BR123456789BR",value:q,onChange:rt=>X(rt.target.value)}),n.jsx(he,{size:"sm",onClick:()=>Ke(fe.id),children:"Salvar"}),n.jsx(he,{size:"sm",variant:"ghost",onClick:()=>L(null),children:"Cancelar"})]}):n.jsx("div",{className:"flex items-center gap-2",children:fe.tracking_code?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"font-mono",children:fe.tracking_code}),n.jsx(he,{size:"sm",variant:"ghost",onClick:()=>{X(fe.tracking_code||""),L(fe.id)},children:"Editar"})]}):n.jsx(he,{size:"sm",variant:"outline",onClick:()=>{X(""),L(fe.id)},children:"Adicionar cdigo"})})]}),(fe.status==="aguardando_pagamento"||fe.status==="pendente")&&n.jsxs(he,{variant:"outline",className:"w-full gap-2 border-amber-300 text-amber-700 hover:bg-amber-50",onClick:()=>{k(fe.id),N(!0)},children:[n.jsx(en,{className:"h-4 w-4"}),"Revalidar Pagamento MP"]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:"text-sm font-medium mb-2 block flex items-center gap-2",children:[n.jsx(nn,{className:"h-4 w-4 text-green-600"}),"Mensagem WhatsApp"]}),$[fe.id]&&n.jsxs(xf,{className:"border-green-300 bg-green-50",children:[n.jsx(Cn,{className:"h-4 w-4 text-green-600"}),n.jsxs(vf,{className:"text-green-800",children:[n.jsx("strong",{children:"Mensagem atualizada!"}),' Clique em "Enviar WhatsApp" para notificar a cliente.']})]}),fe.last_whatsapp_sent_at&&n.jsxs("p",{className:"text-xs text-muted-foreground",children:["ltima notificao: ",new Date(fe.last_whatsapp_sent_at).toLocaleString("pt-BR"),fe.last_whatsapp_status&&` (${((St=zy[fe.last_whatsapp_status])==null?void 0:St.label)||fe.last_whatsapp_status})`]}),Z===fe.id?n.jsxs("div",{className:"space-y-2",children:[n.jsx(Yn,{value:I[fe.id]||tm(fe.status,{customerName:fe.customer_name.split(" ")[0],shortId:rm(fe.id),trackingCode:fe.tracking_code,total:it(fe.total)}),onChange:rt=>U(ir=>({...ir,[fe.id]:rt.target.value})),rows:5,className:"text-sm"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{size:"sm",variant:"ghost",onClick:()=>re(null),children:"Fechar editor"}),n.jsx(he,{size:"sm",variant:"outline",onClick:()=>{const rt=tm(fe.status,{customerName:fe.customer_name.split(" ")[0],shortId:rm(fe.id),trackingCode:fe.tracking_code,total:it(fe.total)});U(ir=>({...ir,[fe.id]:rt}))},children:"Resetar para template"})]})]}):n.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg text-sm cursor-pointer hover:bg-muted transition-colors",onClick:()=>re(fe.id),children:[n.jsx("p",{className:"whitespace-pre-wrap line-clamp-3",children:I[fe.id]||tm(fe.status,{customerName:fe.customer_name.split(" ")[0],shortId:rm(fe.id),trackingCode:fe.tracking_code,total:it(fe.total)})}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Clique para editar"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{variant:"outline",className:"flex-1 gap-2",onClick:async()=>{const rt=I[fe.id]||tm(fe.status,{customerName:fe.customer_name.split(" ")[0],shortId:rm(fe.id),trackingCode:fe.tracking_code,total:it(fe.total)});await gf(rt),de.success("Mensagem copiada!")},children:[n.jsx(Ia,{className:"h-4 w-4"}),"Copiar msg"]}),n.jsxs(he,{className:`flex-1 gap-2 ${$[fe.id]?"bg-green-600 hover:bg-green-700 animate-pulse":"btn-whatsapp"}`,onClick:async()=>{const rt=I[fe.id]||tm(fe.status,{customerName:fe.customer_name.split(" ")[0],shortId:rm(fe.id),trackingCode:fe.tracking_code,total:it(fe.total)}),ir=fe.customer_phone.replace(/\D/g,""),Te=`https://wa.me/${ir.startsWith("55")?ir:`55${ir}`}?text=${encodeURIComponent(rt)}`;window.open(Te,"_blank","noopener,noreferrer"),await ce.from("orders").update({last_whatsapp_status:fe.status,last_whatsapp_sent_at:new Date().toISOString(),whatsapp_message_override:I[fe.id]||null}).eq("id",fe.id),i(qe=>qe.map(ht=>ht.id===fe.id?{...ht,last_whatsapp_status:fe.status,last_whatsapp_sent_at:new Date().toISOString()}:ht)),Y(qe=>({...qe,[fe.id]:!1})),de.success("WhatsApp aberto  notificao registrada!")},children:[n.jsx(zu,{className:"h-4 w-4"}),$[fe.id]?"Enviar Agora!":"Enviar WhatsApp"]})]})]})]})]})]})})]},fe.id)})}),Ve.length===0&&n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:a.length===0?"Nenhum pedido ainda.":"Nenhum pedido encontrado com os filtros aplicados."})]}),n.jsx(TH,{open:E,onClose:()=>{N(!1),k(null)},onSuccess:ne,orderId:C||void 0})]})}function Nye({customer:e,onOpenCatalog:t}){const r=fr(),s=[e.name,e.phone,e.email,e.size_letter||e.size_number,e.address_line,e.city,e.zip_code],a=s.filter(Boolean).length,i=Math.round(a/s.length*100),o=i===100,c=m=>{const p=m.replace(/\D/g,"");return p.length===11?`(${p.slice(0,2)}) ${p.slice(2,7)}-${p.slice(7)}`:p.length===13&&p.startsWith("55")?`(${p.slice(2,4)}) ${p.slice(4,9)}-${p.slice(9)}`:m},d=m=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(m),l=m=>m?new Date(m).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit"}):null,u=()=>{var m;return e.name?e.name.split(" ").map(p=>p[0]).join("").slice(0,2).toUpperCase():((m=e.phone)==null?void 0:m.slice(-2))||"?"},h=e.phone.replace(/\D/g,""),f=`https://wa.me/${h.startsWith("55")?h:`55${h}`}`;return n.jsx(De,{className:"hover:shadow-md transition-shadow",children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:n.jsx("span",{className:"text-sm font-semibold text-primary",children:u()})}),n.jsx("div",{className:"flex-1 min-w-0",children:n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium text-sm line-clamp-1",children:e.name||"Sem nome"}),n.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground text-xs mt-0.5",children:[n.jsx(el,{className:"h-3 w-3"}),n.jsx("span",{children:c(e.phone)})]})]}),o?n.jsxs(Ae,{variant:"default",className:"bg-emerald-500 text-xs gap-0.5 flex-shrink-0",children:[n.jsx(xn,{className:"h-3 w-3"}),"Completo"]}):n.jsxs(Ae,{variant:"outline",className:"text-amber-600 border-amber-300 text-xs gap-0.5 flex-shrink-0",children:[n.jsx(Cn,{className:"h-3 w-3"}),i,"%"]})]})})]}),n.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-3",children:[e.style_title&&n.jsxs(Ae,{variant:"secondary",className:"gap-1 text-xs",children:[n.jsx(Wr,{className:"h-3 w-3"}),e.style_title]}),(e.size_letter||e.size_number)&&n.jsx(Ae,{variant:"outline",className:"text-xs",children:[e.size_letter,e.size_number].filter(Boolean).join(" / ")})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3 text-xs",children:[n.jsxs("div",{className:"bg-secondary/50 rounded-lg p-2 text-center",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1 text-muted-foreground mb-0.5",children:[n.jsx(ln,{className:"h-3 w-3"}),n.jsx("span",{children:"Pedidos"})]}),n.jsx("p",{className:"font-semibold",children:e.total_orders||0})]}),n.jsxs("div",{className:"bg-secondary/50 rounded-lg p-2 text-center col-span-2",children:[n.jsx("div",{className:"text-muted-foreground mb-0.5",children:"Total gasto"}),n.jsx("p",{className:"font-semibold text-primary",children:e.total_spent>0?d(e.total_spent):""})]})]}),e.last_order_at&&n.jsxs("p",{className:"text-xs text-muted-foreground mb-3",children:["ltima compra: ",l(e.last_order_at)]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{size:"sm",variant:"default",className:"flex-1 bg-[#25D366] hover:bg-[#128C7E] text-white gap-1",asChild:!0,children:n.jsxs("a",{href:f,target:"_blank",rel:"noopener noreferrer",children:[n.jsx(nn,{className:"h-3.5 w-3.5"}),"WhatsApp"]})}),n.jsxs(he,{size:"sm",variant:"outline",className:"gap-1",onClick:()=>r(`/dashboard/clientes/${e.id}`),children:[n.jsx(ci,{className:"h-3.5 w-3.5"}),"Perfil"]}),n.jsxs(he,{size:"sm",variant:"outline",className:"gap-1",onClick:()=>t==null?void 0:t(e.id),children:[n.jsx(Hz,{className:"h-3.5 w-3.5"}),"Catlogo"]})]})]})})}const Sye=[{value:"all",label:"Todos"},{value:"incomplete",label:"Cadastro incompleto"},{value:"has_orders",label:"J compraram"},{value:"no_orders",label:"Nunca compraram"},{value:"has_quiz",label:"Com quiz"},{value:"no_quiz",label:"Sem quiz"},{value:"recent",label:"ltimos 7 dias"}],Cye=[{value:"_all",label:"Todos tamanhos"},{value:"PP",label:"PP"},{value:"P",label:"P"},{value:"M",label:"M"},{value:"G",label:"G"},{value:"GG",label:"GG"},{value:"34",label:"34"},{value:"36",label:"36"},{value:"38",label:"38"},{value:"40",label:"40"},{value:"42",label:"42"},{value:"44",label:"44"},{value:"46",label:"46"}];function Eye({search:e,onSearchChange:t,filter:r,onFilterChange:s,styleFilter:a,onStyleFilterChange:i,sizeFilter:o,onSizeFilterChange:c,totalCount:d,filteredCount:l,availableStyles:u}){return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[n.jsxs("div",{className:"relative flex-1 max-w-md",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar por nome, telefone ou estilo...",value:e,onChange:h=>t(h.target.value),className:"pl-9"})]}),n.jsxs(Kt,{value:a,onValueChange:i,children:[n.jsx(Vt,{className:"w-full sm:w-[180px]",children:n.jsx(Xt,{placeholder:"Estilo"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"_all",children:"Todos estilos"}),u.map(h=>n.jsx(ze,{value:h,children:h},h))]})]}),n.jsxs(Kt,{value:o,onValueChange:c,children:[n.jsx(Vt,{className:"w-full sm:w-[140px]",children:n.jsx(Xt,{placeholder:"Tamanho"})}),n.jsx(qt,{children:Cye.map(h=>n.jsx(ze,{value:h.value,children:h.label},h.value))})]}),n.jsxs(Ae,{variant:"secondary",className:"h-10 px-3 flex items-center gap-1 whitespace-nowrap",children:[l," / ",d," clientes"]})]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:Sye.map(h=>n.jsx("button",{onClick:()=>s(h.value),className:`px-3 py-1.5 rounded-full text-sm transition-colors ${r===h.value?"bg-primary text-primary-foreground":"bg-secondary hover:bg-secondary/80 text-muted-foreground"}`,children:h.label},h.value))})]})}function HH({open:e,onClose:t,customerId:r,customerName:s,customerPhone:a,customerStyle:i,customerSizeLetter:o,customerSizeNumber:c,availableProducts:d}){const[l,u]=P.useState(`Catlogo da ${s||"Cliente"}`),[h,f]=P.useState(""),[m,p]=P.useState([]),[g,v]=P.useState(!1),[x,y]=P.useState(!1),[b,j]=P.useState(null),[T,O]=P.useState(!1),[R,D]=P.useState("_all"),[L,q]=P.useState("_all"),[X,H]=P.useState("_all"),M=[o,c,"UN","nico"].filter(Boolean),[F,S]=P.useState("all"),E=["34","36","38","40","42","44","46","PP","P","M","G","GG","UN","nico"],N=[...new Set(d.flatMap(se=>{if(!se.stock_by_size)return[];const le=se.stock_by_size;return Object.entries(le).filter(([ye,ue])=>ue>0).map(([ye])=>ye)}))].sort((se,le)=>{const ye=E.indexOf(se),ue=E.indexOf(le);return ye===-1&&ue===-1?se.localeCompare(le):ye===-1?1:ue===-1?-1:ye-ue}),C=[...new Set(d.filter(se=>se.category).map(se=>se.category))].sort(),k=[...new Set(d.filter(se=>se.color).map(se=>se.color))].sort(),I=d.filter(se=>{if(!se.stock_by_size)return!1;const le=se.stock_by_size;return Object.values(le).reduce((ue,ne)=>ue+ne,0)>0}),U=M.length>0?d.filter(se=>{if(!se.stock_by_size)return!1;const le=se.stock_by_size;return M.some(ye=>{if(!ye)return!1;const ue=Object.keys(le).find(ne=>ne.toLowerCase()===ye.toLowerCase());return ue&&le[ue]>0})}):[],Z=(se=>se.filter(le=>{if(L!=="_all"&&le.category!==L||X!=="_all"&&le.color!==X)return!1;if(R!=="_all"){if(!le.stock_by_size)return!1;const ye=le.stock_by_size,ue=Object.keys(ye).find(ne=>ne.toLowerCase()===R.toLowerCase());if(!ue||ye[ue]<=0)return!1}return!0}))(F==="suggested"?U:I);P.useEffect(()=>{e&&(u(`Catlogo da ${s||"Cliente"}`),re(),S(U.length>0?"suggested":"all"),D("_all"),q("_all"),H("_all"))},[e,s]);const re=async()=>{v(!0);const se=[o,c].filter(Boolean).join("/"),le=[`${s||"Querida"}, montei esse provador pensando no seu estilo ${i?`${i} `:""}e no seu tamanho${se?` ${se}`:""}, com peas que vo te deixar ainda mais confiante e sofisticada. Me diz qual voc amou primeiro `,`Oi ${s||""}! Selecionei essas peas especialmente pra voc, todas no seu tamanho${se?` ${se}`:""} e com a sua cara${i?`, combinando com seu estilo ${i}`:""}. Qual delas te conquistou? `,`${s||"Linda"}, preparei uma seleo exclusiva pensando em voc! Peas que valorizam seu corpo${se?` (${se})`:""} e combinam perfeitamente com ${i?`seu estilo ${i}`:"seu estilo nico"}. Me conta sua favorita! `];f(le[Math.floor(Math.random()*le.length)]),v(!1)},G=se=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(se),J=se=>{if(se.images&&se.images.length>0){const le=se.main_image_index||0;return se.images[le]||se.images[0]}return se.image_url},V=se=>{m.find(le=>le.id===se.id)||p([...m,se]),O(!1)},W=se=>{p(m.filter(le=>le.id!==se))},ee=async()=>{if(m.length===0){de.error("Adicione pelo menos um produto ao catlogo");return}y(!0);try{const se=`catalogo-${r.slice(0,8)}-${Date.now()}`,{data:le,error:ye}=await ce.from("customer_catalogs").insert({customer_id:r,title:l,intro_text:h,products:m.map(ne=>({id:ne.id,name:ne.name,price:ne.price,image:J(ne),color:ne.color})),public_link:se}).select().single();if(ye)throw ye;const ue=`${window.location.origin}/c/${se}`;j(ue),de.success("Catlogo criado com sucesso!")}catch(se){console.error("Error saving catalog:",se),de.error("Erro ao salvar catlogo")}finally{y(!1)}},ie=()=>{b&&(navigator.clipboard.writeText(b),de.success("Link copiado!"))},oe=()=>{const se=a.replace(/\D/g,""),le=se.startsWith("55")?se:`55${se}`,ye=encodeURIComponent(`${h}

 Veja seu catlogo personalizado:
${b}`);window.open(`https://wa.me/${le}?text=${ye}`,"_blank")};return n.jsx(cn,{open:e,onOpenChange:t,children:n.jsxs(sn,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[n.jsxs(fn,{children:[n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(Wr,{className:"h-5 w-5 text-primary"}),"Montar Catlogo Personalizado"]}),n.jsxs(Zo,{children:["Selecione produtos para criar um catlogo exclusivo para ",s||"esta cliente","."]})]}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Nome do catlogo"}),n.jsx(Qe,{value:l,onChange:se=>u(se.target.value),placeholder:"Catlogo da Cliente"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"text-sm font-medium",children:"Texto de abertura"}),n.jsxs(he,{variant:"ghost",size:"sm",onClick:re,disabled:g,children:[g?n.jsx(At,{className:"h-4 w-4 animate-spin"}):n.jsx(Wr,{className:"h-4 w-4"}),"Gerar novo"]})]}),n.jsx(Yn,{value:h,onChange:se=>f(se.target.value),rows:4,placeholder:"Texto personalizado para a cliente..."})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("label",{className:"text-sm font-medium",children:["Produtos (",m.length,")"]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>O(!0),children:[n.jsx(An,{className:"h-4 w-4 mr-1"}),"Adicionar"]})]}),m.length===0?n.jsxs("div",{className:"border border-dashed rounded-lg p-8 text-center text-muted-foreground",children:[n.jsx("p",{children:"Nenhum produto selecionado"}),n.jsx("p",{className:"text-sm",children:'Clique em "Adicionar" para incluir produtos'})]}):n.jsx("div",{className:"space-y-2",children:m.map((se,le)=>n.jsxs("div",{className:"flex items-center gap-3 bg-secondary/50 rounded-lg p-2",children:[n.jsx(nk,{className:"h-4 w-4 text-muted-foreground cursor-grab"}),n.jsx("div",{className:"w-12 h-12 rounded overflow-hidden bg-secondary flex-shrink-0",children:J(se)?n.jsx("img",{src:J(se),alt:se.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:"?"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:se.name}),n.jsx("p",{className:"text-sm text-primary",children:G(se.price)})]}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>W(se.id),children:n.jsx(mi,{className:"h-4 w-4 text-muted-foreground"})})]},se.id))})]}),T&&n.jsxs("div",{className:"border rounded-lg p-4 bg-background",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("h4",{className:"font-medium",children:"Selecionar produto"}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>O(!1),children:n.jsx(an,{className:"h-4 w-4"})})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[n.jsxs(Kt,{value:R,onValueChange:D,children:[n.jsx(Vt,{className:"h-9",children:n.jsx(Xt,{placeholder:"Tamanho"})}),n.jsxs(qt,{className:"bg-background z-50",children:[n.jsx(ze,{value:"_all",children:"Todos tam."}),N.map(se=>n.jsx(ze,{value:se,children:se},se))]})]}),n.jsxs(Kt,{value:L,onValueChange:q,children:[n.jsx(Vt,{className:"h-9",children:n.jsx(Xt,{placeholder:"Categoria"})}),n.jsxs(qt,{className:"bg-background z-50",children:[n.jsx(ze,{value:"_all",children:"Todas cat."}),C.map(se=>n.jsx(ze,{value:se,children:se},se))]})]}),n.jsxs(Kt,{value:X,onValueChange:H,children:[n.jsx(Vt,{className:"h-9",children:n.jsx(Xt,{placeholder:"Cor"})}),n.jsxs(qt,{className:"bg-background z-50",children:[n.jsx(ze,{value:"_all",children:"Todas cores"}),k.map(se=>n.jsx(ze,{value:se,children:se},se))]})]})]}),n.jsx(pi,{value:F,onValueChange:se=>S(se),className:"mb-3",children:n.jsxs(Qa,{className:"grid w-full grid-cols-2",children:[n.jsxs(pr,{value:"suggested",disabled:U.length===0,children:[n.jsx(wd,{className:"h-3 w-3 mr-1"}),"Sugeridos (",U.length,")"]}),n.jsxs(pr,{value:"all",children:["Todos (",I.length,")"]})]})}),n.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:[Z.filter(se=>!m.find(le=>le.id===se.id)).length," produtos encontrados"]}),Z.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx("p",{className:"text-sm",children:"Nenhum produto encontrado"}),(R!=="_all"||L!=="_all"||X!=="_all")&&n.jsx(he,{variant:"link",size:"sm",onClick:()=>{D("_all"),q("_all"),H("_all")},className:"mt-2",children:"Limpar filtros"})]}):n.jsx("div",{className:"grid grid-cols-3 gap-2 max-h-60 overflow-y-auto",children:Z.filter(se=>!m.find(le=>le.id===se.id)).map(se=>n.jsxs("button",{onClick:()=>V(se),className:"text-left p-2 rounded-lg hover:bg-secondary transition-colors",children:[n.jsx("div",{className:"aspect-square rounded overflow-hidden bg-secondary mb-1",children:J(se)?n.jsx("img",{src:J(se),alt:se.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:"?"})}),n.jsx("p",{className:"text-xs truncate",children:se.name}),n.jsx("p",{className:"text-xs text-primary",children:G(se.price)})]},se.id))})]}),b&&n.jsxs("div",{className:"border rounded-lg p-4 bg-emerald-50/50",children:[n.jsx("p",{className:"text-sm font-medium text-emerald-700 mb-2",children:" Catlogo criado!"}),n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(Qe,{value:b,readOnly:!0,className:"flex-1 text-sm"}),n.jsx(he,{variant:"outline",size:"icon",onClick:ie,children:n.jsx(Ia,{className:"h-4 w-4"})}),n.jsx(he,{variant:"outline",size:"icon",asChild:!0,children:n.jsx("a",{href:b,target:"_blank",rel:"noopener noreferrer",children:n.jsx(ma,{className:"h-4 w-4"})})})]}),n.jsxs(he,{className:"w-full bg-[#25D366] hover:bg-[#128C7E] text-white",onClick:oe,children:[n.jsx(nn,{className:"h-4 w-4 mr-2"}),"Enviar no WhatsApp"]})]}),!b&&n.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[n.jsx(he,{variant:"outline",onClick:t,className:"flex-1",children:"Cancelar"}),n.jsxs(he,{onClick:ee,disabled:x||m.length===0,className:"flex-1",children:[x?n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}):n.jsx(Wr,{className:"h-4 w-4 mr-2"}),"Criar Catlogo"]})]})]})]})})}function kye(){const[e,t]=P.useState([]),[r,s]=P.useState([]),[a,i]=P.useState(!0),[o,c]=P.useState(""),[d,l]=P.useState("all"),[u,h]=P.useState("_all"),[f,m]=P.useState("_all"),[p,g]=P.useState(!1),[v,x]=P.useState(null);P.useEffect(()=>{y()},[]);const y=async()=>{try{const[R,D]=await Promise.all([ce.from("customers").select("*").order("last_order_at",{ascending:!1,nullsFirst:!1}),ce.from("product_catalog").select("id, name, price, image_url, images, main_image_index, stock_by_size, color, category").eq("is_active",!0)]);if(R.error)throw R.error;if(D.error)throw D.error;const L=(R.data||[]).map(q=>({id:q.id,phone:q.phone,name:q.name,email:q.email,size:q.size,size_letter:q.size_letter,size_number:q.size_number,style_title:q.style_title,created_at:q.created_at,total_orders:q.total_orders||0,last_order_at:q.last_order_at,total_spent:Number(q.total_spent)||0,address_line:q.address_line,city:q.city,state:q.state,zip_code:q.zip_code,user_id:q.user_id,document:q.document}));L.sort((q,X)=>q.last_order_at&&X.last_order_at?new Date(X.last_order_at).getTime()-new Date(q.last_order_at).getTime():q.last_order_at?-1:X.last_order_at?1:new Date(X.created_at).getTime()-new Date(q.created_at).getTime()),t(L),s(D.data||[])}catch(R){console.error("Error loading data:",R),de.error("Erro ao carregar dados")}finally{i(!1)}},b=[...new Set(e.map(R=>R.style_title).filter(Boolean))],j=R=>{const D=[R.name,R.phone,R.email,R.size_letter||R.size_number,R.address_line,R.city,R.zip_code];return D.filter(Boolean).length===D.length},T=e.filter(R=>{var X,H,M,F,S;const D=o.toLowerCase();if(!(!o||((X=R.name)==null?void 0:X.toLowerCase().includes(D))||((H=R.phone)==null?void 0:H.includes(o))||((M=R.style_title)==null?void 0:M.toLowerCase().includes(D))||((F=R.email)==null?void 0:F.toLowerCase().includes(D))))return!1;const q=new Date;switch(q.setDate(q.getDate()-7),d){case"incomplete":if(j(R))return!1;break;case"has_orders":if(R.total_orders===0)return!1;break;case"no_orders":if(R.total_orders>0)return!1;break;case"has_quiz":if(!R.style_title)return!1;break;case"no_quiz":if(R.style_title)return!1;break;case"recent":const E=R.last_order_at||R.created_at;if(new Date(E)<q)return!1;break}return!(u!=="_all"&&R.style_title!==u||f!=="_all"&&!(((S=R.size_letter)==null?void 0:S.toLowerCase())===f.toLowerCase()||R.size_number===f))}),O=R=>{const D=e.find(L=>L.id===R);D&&(x(D),g(!0))};return a?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):n.jsxs("div",{className:"space-y-6",children:[n.jsx(Eye,{search:o,onSearchChange:c,filter:d,onFilterChange:l,styleFilter:u,onStyleFilterChange:h,sizeFilter:f,onSizeFilterChange:m,totalCount:e.length,filteredCount:T.length,availableStyles:b}),T.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(wa,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:o||d!=="all"||u!=="_all"||f!=="_all"?"Nenhum cliente encontrado com esses filtros":"Nenhum cliente cadastrado ainda"})]}):n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(R=>n.jsx(Nye,{customer:R,onOpenCatalog:O},R.id))}),v&&n.jsx(HH,{open:p,onClose:()=>{g(!1),x(null)},customerId:v.id,customerName:v.name,customerPhone:v.phone,customerStyle:v.style_title,customerSizeLetter:v.size_letter,customerSizeNumber:v.size_number,availableProducts:r})]})}function Kr({className:e,...t}){return n.jsx("div",{className:We("animate-pulse rounded-md bg-muted",e),...t})}function rj(){const[e,t]=P.useState([]),[r,s]=P.useState(!0),[a,i]=P.useState(null),o=P.useCallback(async()=>{s(!0);try{const{data:u,error:h}=await ce.from("live_events").select("*").order("data_hora_inicio",{ascending:!1});if(h)throw h;const f=await Promise.all((u||[]).map(async m=>{const{count:p}=await ce.from("live_products").select("*",{count:"exact",head:!0}).eq("live_event_id",m.id),{count:g}=await ce.from("live_carts").select("*",{count:"exact",head:!0}).eq("live_event_id",m.id),{data:v}=await ce.from("live_carts").select("total").eq("live_event_id",m.id).eq("status","pago"),x=(v||[]).reduce((y,b)=>y+(b.total||0),0);return{...m,productsCount:p||0,cartsCount:g||0,totalPaid:x}}));t(f)}catch(u){console.error("Error fetching live events:",u),i(u.message),de.error("Erro ao carregar lives")}finally{s(!1)}},[]);return P.useEffect(()=>{o()},[o]),{events:e,isLoading:r,error:a,fetchEvents:o,createEvent:async u=>{try{const{data:{user:h}}=await ce.auth.getUser(),{data:f,error:m}=await ce.from("live_events").insert({titulo:u.titulo,data_hora_inicio:u.data_hora_inicio,observacoes:u.observacoes||null,reservation_expiry_minutes:u.reservation_expiry_minutes||30,user_id:h==null?void 0:h.id}).select().single();if(m)throw m;return de.success("Live criada com sucesso!"),o(),f}catch(h){return console.error("Error creating live event:",h),de.error("Erro ao criar live"),null}},updateEventStatus:async(u,h)=>{try{const f={status:h};h==="ao_vivo"&&(f.data_hora_inicio=new Date().toISOString()),h==="encerrada"&&(f.data_hora_fim=new Date().toISOString());const{error:m}=await ce.from("live_events").update(f).eq("id",u);if(m)throw m;const p={planejada:"Planejada",ao_vivo:"Ao Vivo",encerrada:"Encerrada",arquivada:"Arquivada"};return de.success(`Live ${p[h]}!`),o(),!0}catch(f){return console.error("Error updating live event status:",f),de.error("Erro ao atualizar status da live"),!1}},deleteEvent:async u=>{try{const{error:h}=await ce.from("live_events").delete().eq("id",u);if(h)throw h;return de.success("Live excluda com sucesso!"),o(),!0}catch(h){return console.error("Error deleting live event:",h),de.error("Erro ao excluir live"),!1}}}}function nj(e){const[t,r]=P.useState(null),[s,a]=P.useState([]),[i,o]=P.useState({totalPlanejado:{itens:0,valor:0},totalReservado:{itens:0,valor:0},totalVendido:{itens:0,valor:0},totalEmAberto:{itens:0,valor:0},percentualPago:0}),[c,d]=P.useState(!0),l=P.useCallback(async()=>{if(e){d(!0);try{const{data:p,error:g}=await ce.from("live_events").select("*").eq("id",e).single();if(g)throw g;r(p);const{data:v,error:x}=await ce.from("live_products").select(`
          *,
          product:product_catalog(
            id, name, image_url, images, price, color, 
            stock_by_size, category, sku, group_key
          )
        `).eq("live_event_id",e).order("prioridade_ordem");if(x)throw x;const y=(v||[]).map(T=>T.product_id).filter(Boolean);let b={};if(y.length>0){const{data:T,error:O}=await ce.from("product_available_stock").select("product_id, size, available").in("product_id",y);!O&&T&&T.forEach(R=>{b[R.product_id]||(b[R.product_id]={}),R.available>0&&(b[R.product_id][R.size]=R.available)})}const j=(v||[]).map(T=>{const O=b[T.product_id]||{};return{...T,product:T.product?{...T.product,available_by_size:O}:null}});a(j),await u(e)}catch(p){console.error("Error fetching live event:",p),de.error("Erro ao carregar live")}finally{d(!1)}}},[e]),u=async p=>{try{const{data:g}=await ce.from("live_carts").select(`
          *,
          items:live_cart_items(*)
        `).eq("live_event_id",p),v=g||[];let x=0,y=0,b=0,j=0,T=0,O=0;v.forEach(H=>{const M=H.items||[],F=M.reduce((E,N)=>E+N.preco_unitario*N.qtd,0),S=M.reduce((E,N)=>E+N.qtd,0);if(H.status==="pago")b+=S,j+=F;else if(["aberto","em_confirmacao","aguardando_pagamento"].includes(H.status)){const E=M.filter(k=>["reservado","confirmado"].includes(k.status)),N=E.reduce((k,I)=>k+I.preco_unitario*I.qtd,0),C=E.reduce((k,I)=>k+I.qtd,0);x+=C,y+=N,T+=C,O+=N}});const{data:R}=await ce.from("live_products").select(`
          *,
          product:product_catalog(price, stock_by_size)
        `).eq("live_event_id",p);let D=0,L=0;(R||[]).forEach(H=>{var E,N;const M=((E=H.product)==null?void 0:E.stock_by_size)||{},F=H.limite_unidades_live||Object.values(M).reduce((C,k)=>C+(k||0),0),S=((N=H.product)==null?void 0:N.price)||0;D+=F,L+=F*S});const q=b+T,X=q>0?Math.round(b/q*100):0;o({totalPlanejado:{itens:D,valor:L},totalReservado:{itens:x,valor:y},totalVendido:{itens:b,valor:j},totalEmAberto:{itens:T,valor:O},percentualPago:X})}catch(g){console.error("Error calculating KPIs:",g)}};return P.useEffect(()=>{l()},[l]),{event:t,products:s,kpis:i,isLoading:c,fetchEvent:l,addProduct:async(p,g)=>{if(!e)return!1;try{const v=s.reduce((D,L)=>Math.max(D,L.prioridade_ordem),0),{data:x,error:y}=await ce.from("product_available_stock").select("size, available").eq("product_id",p);y&&console.error("[useLiveEvent.addProduct] Error fetching availability:",y);const b={};(x||[]).forEach(D=>{const L=Number(D.available||0);L>0&&(b[D.size]=L)});let j={},T=null;const O=Object.fromEntries(Object.entries(g.stock_reservations||{}).filter(([,D])=>Number(D||0)>0));Object.keys(O).length>0?(j=O,T=Object.values(j).reduce((D,L)=>D+(L||0),0)):(j=b,g.reserve_all?T=Object.values(j).reduce((D,L)=>D+(L||0),0):T=g.limite_unidades_live??null);const{error:R}=await ce.from("live_products").insert({live_event_id:e,product_id:p,prioridade_ordem:v+1,visibilidade:g.visibilidade,bloquear_desde_planejamento:g.bloquear_desde_planejamento,limite_unidades_live:T,snapshot_variantes:j,live_discount_type:g.live_discount_type||null,live_discount_value:g.live_discount_value||null});if(R){if(R.code==="23505")return de.error("Este produto j est na live"),!1;throw R}return de.success("Produto adicionado  live!"),l(),!0}catch(v){return console.error("Error adding product to live:",v),de.error("Erro ao adicionar produto"),!1}},removeProduct:async p=>{try{const{error:g}=await ce.from("live_products").delete().eq("id",p);if(g)throw g;return de.success("Produto removido da live!"),l(),!0}catch(g){return console.error("Error removing product from live:",g),de.error("Erro ao remover produto"),!1}},updateProductOrder:async p=>{try{const g=p.map((v,x)=>ce.from("live_products").update({prioridade_ordem:x}).eq("id",v));return await Promise.all(g),l(),!0}catch(g){return console.error("Error updating product order:",g),de.error("Erro ao reordenar produtos"),!1}}}}function Aye({open:e,onOpenChange:t}){const r=fr(),{createEvent:s}=rj(),[a,i]=P.useState(!1),[o,c]=P.useState(""),[d,l]=P.useState(()=>{const g=new Date;return g.setMinutes(0),g.setSeconds(0),Ht(g,"yyyy-MM-dd'T'HH:mm")}),[u,h]=P.useState(""),[f,m]=P.useState(7),p=async g=>{if(g.preventDefault(),!!o.trim()){i(!0);try{const v=await s({titulo:o.trim(),data_hora_inicio:new Date(d).toISOString(),observacoes:u.trim()||void 0,reservation_expiry_minutes:Math.max(7,f)*24*60});v&&(t(!1),c(""),h(""),r(`/dashboard/lives/${v.id}/planejar`))}finally{i(!1)}}};return n.jsx(cn,{open:e,onOpenChange:t,children:n.jsxs(sn,{className:"sm:max-w-md",children:[n.jsxs(fn,{children:[n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(Ts,{className:"h-5 w-5 text-primary"}),"Nova Live"]}),n.jsx(Zo,{children:"Crie um evento de live para gerenciar vendas em tempo real"})]}),n.jsxs("form",{onSubmit:p,className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"titulo",children:"Ttulo da Live *"}),n.jsx(Qe,{id:"titulo",placeholder:"Ex: Live de Tera - Novidades",value:o,onChange:g=>c(g.target.value),required:!0})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"dataHora",children:"Data e Hora *"}),n.jsxs("div",{className:"relative",children:[n.jsx(is,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{id:"dataHora",type:"datetime-local",value:d,onChange:g=>l(g.target.value),className:"pl-10",required:!0})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"expiryDays",children:"Tempo de Reserva (dias)"}),n.jsxs("div",{className:"relative",children:[n.jsx(Br,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{id:"expiryDays",type:"number",min:7,max:30,step:1,value:f,onChange:g=>m(parseInt(g.target.value)||7),className:"pl-10"})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Mnimo de 7 dias. Reservas ficam separadas por pelo menos esse perodo."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"observacoes",children:"Observaes"}),n.jsx(Yn,{id:"observacoes",placeholder:"Anotaes sobre a live...",value:u,onChange:g=>h(g.target.value),rows:3})]}),n.jsxs(Da,{children:[n.jsx(he,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),n.jsx(he,{type:"submit",disabled:a||!o.trim(),children:a?"Criando...":"Criar e Planejar"})]})]})]})})}const Tye={planejada:{label:"Planejada",color:"text-blue-600",bgColor:"bg-blue-50 border-blue-200",icon:n.jsx(is,{className:"h-4 w-4"})},ao_vivo:{label:"AO VIVO",color:"text-red-600",bgColor:"bg-red-50 border-red-200",icon:n.jsx(Ts,{className:"h-4 w-4 animate-pulse"})},encerrada:{label:"Encerrada",color:"text-green-600",bgColor:"bg-green-50 border-green-200",icon:n.jsx(Er,{className:"h-4 w-4"})},arquivada:{label:"Arquivada",color:"text-muted-foreground",bgColor:"bg-muted border-muted",icon:n.jsx(Ux,{className:"h-4 w-4"})}};function Pye(){const e=fr(),{events:t,isLoading:r,updateEventStatus:s}=rj(),[a,i]=P.useState(!1),o=async h=>{await s(h.id,"ao_vivo"),e(`/dashboard/lives/${h.id}/backstage`)},c=async h=>{await s(h.id,"encerrada")};if(r)return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx(Kr,{className:"h-8 w-48"}),n.jsx(Kr,{className:"h-10 w-32"})]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3].map(h=>n.jsx(Kr,{className:"h-64"},h))})]});const d=t.filter(h=>h.status==="ao_vivo"),l=t.filter(h=>h.status==="planejada"),u=t.filter(h=>["encerrada","arquivada"].includes(h.status));return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"font-serif text-2xl font-semibold",children:"Lives"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Gerencie suas vendas durante transmisses ao vivo"})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(he,{variant:"outline",onClick:()=>e("/dashboard/lives/rastreador"),className:"gap-2",children:[n.jsx(Vx,{className:"h-4 w-4"}),"Rastreador"]}),n.jsxs(he,{variant:"outline",onClick:()=>e("/dashboard/lives/relatorio"),className:"gap-2",children:[n.jsx(Pl,{className:"h-4 w-4"}),"Relatrio"]}),n.jsxs(he,{onClick:()=>i(!0),className:"gap-2",children:[n.jsx(An,{className:"h-4 w-4"}),"Nova Live"]})]})]}),d.length>0&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h3",{className:"font-medium text-red-600 flex items-center gap-2",children:[n.jsx(Ts,{className:"h-4 w-4 animate-pulse"}),"Ao Vivo Agora"]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(h=>n.jsx(L3,{event:h,onOpenBackstage:()=>e(`/dashboard/lives/${h.id}/backstage`),onEndLive:()=>c(h)},h.id))})]}),l.length>0&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h3",{className:"font-medium text-blue-600 flex items-center gap-2",children:[n.jsx(is,{className:"h-4 w-4"}),"Prximas Lives"]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(h=>n.jsx(L3,{event:h,onPlan:()=>e(`/dashboard/lives/${h.id}/planejar`),onStartLive:()=>o(h)},h.id))})]}),u.length>0&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h3",{className:"font-medium text-muted-foreground flex items-center gap-2",children:[n.jsx(Ux,{className:"h-4 w-4"}),"Lives Anteriores"]}),n.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.slice(0,6).map(h=>n.jsx(L3,{event:h,onViewReport:()=>e(`/dashboard/lives/${h.id}/relatorio`)},h.id))})]}),t.length===0&&n.jsx(De,{className:"border-dashed",children:n.jsxs(Be,{className:"flex flex-col items-center justify-center py-12 text-center",children:[n.jsx(Ts,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),n.jsx("h3",{className:"font-medium text-lg mb-2",children:"Nenhuma live ainda"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-4 max-w-sm",children:"Crie sua primeira live para vender durante transmisses do Instagram"}),n.jsxs(he,{onClick:()=>i(!0),className:"gap-2",children:[n.jsx(An,{className:"h-4 w-4"}),"Criar primeira live"]})]})}),n.jsx(Aye,{open:a,onOpenChange:i})]})}function L3({event:e,onPlan:t,onStartLive:r,onOpenBackstage:s,onEndLive:a,onViewReport:i}){const o=Tye[e.status];return n.jsxs(De,{className:`transition-all hover:shadow-md ${o.bgColor}`,children:[n.jsx(Ot,{className:"pb-3",children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsx(Mt,{className:"text-lg font-medium line-clamp-1",children:e.titulo}),n.jsxs(Ae,{variant:"outline",className:`${o.color} shrink-0 gap-1`,children:[o.icon,o.label]})]})}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(Br,{className:"h-4 w-4"}),Ht(new Date(e.data_hora_inicio),"dd 'de' MMMM 's' HH:mm",{locale:gr})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[n.jsxs("div",{className:"bg-background/80 rounded-lg p-2",children:[n.jsx("div",{className:"text-lg font-semibold",children:e.productsCount}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Produtos"})]}),n.jsxs("div",{className:"bg-background/80 rounded-lg p-2",children:[n.jsx("div",{className:"text-lg font-semibold",children:e.cartsCount}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Carrinhos"})]}),n.jsxs("div",{className:"bg-background/80 rounded-lg p-2",children:[n.jsx("div",{className:"text-lg font-semibold",children:e.totalPaid>0?new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e.totalPaid):"R$ 0"}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Vendas"})]})]}),n.jsxs("div",{className:"flex gap-2",children:[e.status==="planejada"&&n.jsxs(n.Fragment,{children:[n.jsx(he,{variant:"outline",size:"sm",className:"flex-1",onClick:t,children:"Planejar"}),n.jsxs(he,{size:"sm",className:"flex-1 gap-1 bg-red-600 hover:bg-red-700",onClick:r,children:[n.jsx(ck,{className:"h-3 w-3"}),"Iniciar"]})]}),e.status==="ao_vivo"&&n.jsxs(n.Fragment,{children:[n.jsxs(he,{size:"sm",className:"flex-1 gap-1 bg-red-600 hover:bg-red-700",onClick:s,children:[n.jsx(Ts,{className:"h-3 w-3"}),"Backstage"]}),n.jsx(he,{variant:"outline",size:"sm",onClick:a,children:n.jsx(rU,{className:"h-3 w-3"})})]}),["encerrada","arquivada"].includes(e.status)&&n.jsx(he,{variant:"outline",size:"sm",className:"flex-1",onClick:i,children:"Ver Relatrio"})]})]})]})}var $r=function(){return $r=Object.assign||function(t){for(var r,s=1,a=arguments.length;s<a;s++){r=arguments[s];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},$r.apply(this,arguments)};function Oye(e,t){var r={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(r[s]=e[s]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(r[s[a]]=e[s[a]]);return r}function GH(e,t,r){for(var s=0,a=t.length,i;s<a;s++)(i||!(s in t))&&(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))}function O1(e){return e.mode==="multiple"}function R1(e){return e.mode==="range"}function sj(e){return e.mode==="single"}var Rye={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Mye(e,t){return Ht(e,"LLLL y",t)}function Iye(e,t){return Ht(e,"d",t)}function Dye(e,t){return Ht(e,"LLLL",t)}function Lye(e){return"".concat(e)}function Bye(e,t){return Ht(e,"cccccc",t)}function $ye(e,t){return Ht(e,"yyyy",t)}var Fye=Object.freeze({__proto__:null,formatCaption:Mye,formatDay:Iye,formatMonthCaption:Dye,formatWeekNumber:Lye,formatWeekdayName:Bye,formatYearCaption:$ye}),zye=function(e,t,r){return Ht(e,"do MMMM (EEEE)",r)},Uye=function(){return"Month: "},Vye=function(){return"Go to next month"},qye=function(){return"Go to previous month"},Wye=function(e,t){return Ht(e,"cccc",t)},Hye=function(e){return"Week n. ".concat(e)},Gye=function(){return"Year: "},Kye=Object.freeze({__proto__:null,labelDay:zye,labelMonthDropdown:Uye,labelNext:Vye,labelPrevious:qye,labelWeekNumber:Hye,labelWeekday:Wye,labelYearDropdown:Gye});function Xye(){var e="buttons",t=Rye,r=v8,s={},a={},i=1,o={},c=new Date;return{captionLayout:e,classNames:t,formatters:Fye,labels:Kye,locale:r,modifiersClassNames:s,modifiers:a,numberOfMonths:i,styles:o,today:c,mode:"default"}}function Yye(e){var t=e.fromYear,r=e.toYear,s=e.fromMonth,a=e.toMonth,i=e.fromDate,o=e.toDate;return s?i=Ps(s):t&&(i=new Date(t,0,1)),a?o=fc(a):r&&(o=new Date(r,11,31)),{fromDate:i?Vn(i):void 0,toDate:o?Vn(o):void 0}}var KH=P.createContext(void 0);function Zye(e){var t,r=e.initialProps,s=Xye(),a=Yye(r),i=a.fromDate,o=a.toDate,c=(t=r.captionLayout)!==null&&t!==void 0?t:s.captionLayout;c!=="buttons"&&(!i||!o)&&(c="buttons");var d;(sj(r)||O1(r)||R1(r))&&(d=r.onSelect);var l=$r($r($r({},s),r),{captionLayout:c,classNames:$r($r({},s.classNames),r.classNames),components:$r({},r.components),formatters:$r($r({},s.formatters),r.formatters),fromDate:i,labels:$r($r({},s.labels),r.labels),mode:r.mode||s.mode,modifiers:$r($r({},s.modifiers),r.modifiers),modifiersClassNames:$r($r({},s.modifiersClassNames),r.modifiersClassNames),onSelect:d,styles:$r($r({},s.styles),r.styles),toDate:o});return n.jsx(KH.Provider,{value:l,children:e.children})}function os(){var e=P.useContext(KH);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function XH(e){var t=os(),r=t.locale,s=t.classNames,a=t.styles,i=t.formatters.formatCaption;return n.jsx("div",{className:s.caption_label,style:a.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:i(e.displayMonth,{locale:r})})}function Qye(e){return n.jsx("svg",$r({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:n.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function YH(e){var t,r,s=e.onChange,a=e.value,i=e.children,o=e.caption,c=e.className,d=e.style,l=os(),u=(r=(t=l.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&r!==void 0?r:Qye;return n.jsxs("div",{className:c,style:d,children:[n.jsx("span",{className:l.classNames.vhidden,children:e["aria-label"]}),n.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:l.classNames.dropdown,style:l.styles.dropdown,value:a,onChange:s,children:i}),n.jsxs("div",{className:l.classNames.caption_label,style:l.styles.caption_label,"aria-hidden":"true",children:[o,n.jsx(u,{className:l.classNames.dropdown_icon,style:l.styles.dropdown_icon})]})]})}function Jye(e){var t,r=os(),s=r.fromDate,a=r.toDate,i=r.styles,o=r.locale,c=r.formatters.formatMonthCaption,d=r.classNames,l=r.components,u=r.labels.labelMonthDropdown;if(!s)return n.jsx(n.Fragment,{});if(!a)return n.jsx(n.Fragment,{});var h=[];if(j1e(s,a))for(var f=Ps(s),m=s.getMonth();m<=a.getMonth();m++)h.push(D3(f,m));else for(var f=Ps(new Date),m=0;m<=11;m++)h.push(D3(f,m));var p=function(v){var x=Number(v.target.value),y=D3(Ps(e.displayMonth),x);e.onChange(y)},g=(t=l==null?void 0:l.Dropdown)!==null&&t!==void 0?t:YH;return n.jsx(g,{name:"months","aria-label":u(),className:d.dropdown_month,style:i.dropdown_month,onChange:p,value:e.displayMonth.getMonth(),caption:c(e.displayMonth,{locale:o}),children:h.map(function(v){return n.jsx("option",{value:v.getMonth(),children:c(v,{locale:o})},v.getMonth())})})}function ebe(e){var t,r=e.displayMonth,s=os(),a=s.fromDate,i=s.toDate,o=s.locale,c=s.styles,d=s.classNames,l=s.components,u=s.formatters.formatYearCaption,h=s.labels.labelYearDropdown,f=[];if(!a)return n.jsx(n.Fragment,{});if(!i)return n.jsx(n.Fragment,{});for(var m=a.getFullYear(),p=i.getFullYear(),g=m;g<=p;g++)f.push(mM(g8(new Date),g));var v=function(y){var b=mM(Ps(r),Number(y.target.value));e.onChange(b)},x=(t=l==null?void 0:l.Dropdown)!==null&&t!==void 0?t:YH;return n.jsx(x,{name:"years","aria-label":h(),className:d.dropdown_year,style:c.dropdown_year,onChange:v,value:r.getFullYear(),caption:u(r,{locale:o}),children:f.map(function(y){return n.jsx("option",{value:y.getFullYear(),children:u(y,{locale:o})},y.getFullYear())})})}function tbe(e,t){var r=P.useState(e),s=r[0],a=r[1],i=t===void 0?s:t;return[i,a]}function rbe(e){var t=e.month,r=e.defaultMonth,s=e.today,a=t||r||s||new Date,i=e.toDate,o=e.fromDate,c=e.numberOfMonths,d=c===void 0?1:c;if(i&&Tp(i,a)<0){var l=-1*(d-1);a=Qo(i,l)}return o&&Tp(a,o)<0&&(a=o),Ps(a)}function nbe(){var e=os(),t=rbe(e),r=tbe(t,e.month),s=r[0],a=r[1],i=function(o){var c;if(!e.disableNavigation){var d=Ps(o);a(d),(c=e.onMonthChange)===null||c===void 0||c.call(e,d)}};return[s,i]}function sbe(e,t){for(var r=t.reverseMonths,s=t.numberOfMonths,a=Ps(e),i=Ps(Qo(a,s)),o=Tp(i,a),c=[],d=0;d<o;d++){var l=Qo(a,d);c.push(l)}return r&&(c=c.reverse()),c}function abe(e,t){if(!t.disableNavigation){var r=t.toDate,s=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,o=s?i:1,c=Ps(e);if(!r)return Qo(c,o);var d=Tp(r,e);if(!(d<i))return Qo(c,o)}}function ibe(e,t){if(!t.disableNavigation){var r=t.fromDate,s=t.pagedNavigation,a=t.numberOfMonths,i=a===void 0?1:a,o=s?i:1,c=Ps(e);if(!r)return Qo(c,-o);var d=Tp(c,r);if(!(d<=0))return Qo(c,-o)}}var ZH=P.createContext(void 0);function obe(e){var t=os(),r=nbe(),s=r[0],a=r[1],i=sbe(s,t),o=abe(s,t),c=ibe(s,t),d=function(h){return i.some(function(f){return w8(h,f)})},l=function(h,f){d(h)||(f&&b8(h,f)?a(Qo(h,1+t.numberOfMonths*-1)):a(h))},u={currentMonth:s,displayMonths:i,goToMonth:a,goToDate:l,previousMonth:c,nextMonth:o,isDateDisplayed:d};return n.jsx(ZH.Provider,{value:u,children:e.children})}function M1(){var e=P.useContext(ZH);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function _M(e){var t,r=os(),s=r.classNames,a=r.styles,i=r.components,o=M1().goToMonth,c=function(u){o(Qo(u,e.displayIndex?-e.displayIndex:0))},d=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:XH,l=n.jsx(d,{id:e.id,displayMonth:e.displayMonth});return n.jsxs("div",{className:s.caption_dropdowns,style:a.caption_dropdowns,children:[n.jsx("div",{className:s.vhidden,children:l}),n.jsx(Jye,{onChange:c,displayMonth:e.displayMonth}),n.jsx(ebe,{onChange:c,displayMonth:e.displayMonth})]})}function lbe(e){return n.jsx("svg",$r({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function cbe(e){return n.jsx("svg",$r({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:n.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var zw=P.forwardRef(function(e,t){var r=os(),s=r.classNames,a=r.styles,i=[s.button_reset,s.button];e.className&&i.push(e.className);var o=i.join(" "),c=$r($r({},a.button_reset),a.button);return e.style&&Object.assign(c,e.style),n.jsx("button",$r({},e,{ref:t,type:"button",className:o,style:c}))});function dbe(e){var t,r,s=os(),a=s.dir,i=s.locale,o=s.classNames,c=s.styles,d=s.labels,l=d.labelPrevious,u=d.labelNext,h=s.components;if(!e.nextMonth&&!e.previousMonth)return n.jsx(n.Fragment,{});var f=l(e.previousMonth,{locale:i}),m=[o.nav_button,o.nav_button_previous].join(" "),p=u(e.nextMonth,{locale:i}),g=[o.nav_button,o.nav_button_next].join(" "),v=(t=h==null?void 0:h.IconRight)!==null&&t!==void 0?t:cbe,x=(r=h==null?void 0:h.IconLeft)!==null&&r!==void 0?r:lbe;return n.jsxs("div",{className:o.nav,style:c.nav,children:[!e.hidePrevious&&n.jsx(zw,{name:"previous-month","aria-label":f,className:m,style:c.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:a==="rtl"?n.jsx(v,{className:o.nav_icon,style:c.nav_icon}):n.jsx(x,{className:o.nav_icon,style:c.nav_icon})}),!e.hideNext&&n.jsx(zw,{name:"next-month","aria-label":p,className:g,style:c.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:a==="rtl"?n.jsx(x,{className:o.nav_icon,style:c.nav_icon}):n.jsx(v,{className:o.nav_icon,style:c.nav_icon})})]})}function jM(e){var t=os().numberOfMonths,r=M1(),s=r.previousMonth,a=r.nextMonth,i=r.goToMonth,o=r.displayMonths,c=o.findIndex(function(p){return w8(e.displayMonth,p)}),d=c===0,l=c===o.length-1,u=t>1&&(d||!l),h=t>1&&(l||!d),f=function(){s&&i(s)},m=function(){a&&i(a)};return n.jsx(dbe,{displayMonth:e.displayMonth,hideNext:u,hidePrevious:h,nextMonth:a,previousMonth:s,onPreviousClick:f,onNextClick:m})}function ube(e){var t,r=os(),s=r.classNames,a=r.disableNavigation,i=r.styles,o=r.captionLayout,c=r.components,d=(t=c==null?void 0:c.CaptionLabel)!==null&&t!==void 0?t:XH,l;return a?l=n.jsx(d,{id:e.id,displayMonth:e.displayMonth}):o==="dropdown"?l=n.jsx(_M,{displayMonth:e.displayMonth,id:e.id}):o==="dropdown-buttons"?l=n.jsxs(n.Fragment,{children:[n.jsx(_M,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),n.jsx(jM,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):l=n.jsxs(n.Fragment,{children:[n.jsx(d,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(jM,{displayMonth:e.displayMonth,id:e.id})]}),n.jsx("div",{className:s.caption,style:i.caption,children:l})}function hbe(e){var t=os(),r=t.footer,s=t.styles,a=t.classNames.tfoot;return r?n.jsx("tfoot",{className:a,style:s.tfoot,children:n.jsx("tr",{children:n.jsx("td",{colSpan:8,children:r})})}):n.jsx(n.Fragment,{})}function fbe(e,t,r){for(var s=r?yf(new Date):bc(new Date,{locale:e,weekStartsOn:t}),a=[],i=0;i<7;i++){var o=vi(s,i);a.push(o)}return a}function mbe(){var e=os(),t=e.classNames,r=e.styles,s=e.showWeekNumber,a=e.locale,i=e.weekStartsOn,o=e.ISOWeek,c=e.formatters.formatWeekdayName,d=e.labels.labelWeekday,l=fbe(a,i,o);return n.jsxs("tr",{style:r.head_row,className:t.head_row,children:[s&&n.jsx("td",{style:r.head_cell,className:t.head_cell}),l.map(function(u,h){return n.jsx("th",{scope:"col",className:t.head_cell,style:r.head_cell,"aria-label":d(u,{locale:a}),children:c(u,{locale:a})},h)})]})}function pbe(){var e,t=os(),r=t.classNames,s=t.styles,a=t.components,i=(e=a==null?void 0:a.HeadRow)!==null&&e!==void 0?e:mbe;return n.jsx("thead",{style:s.head,className:r.head,children:n.jsx(i,{})})}function gbe(e){var t=os(),r=t.locale,s=t.formatters.formatDay;return n.jsx(n.Fragment,{children:s(e.date,{locale:r})})}var _8=P.createContext(void 0);function xbe(e){if(!O1(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return n.jsx(_8.Provider,{value:t,children:e.children})}return n.jsx(vbe,{initialProps:e.initialProps,children:e.children})}function vbe(e){var t=e.initialProps,r=e.children,s=t.selected,a=t.min,i=t.max,o=function(l,u,h){var f,m;(f=t.onDayClick)===null||f===void 0||f.call(t,l,u,h);var p=!!(u.selected&&a&&(s==null?void 0:s.length)===a);if(!p){var g=!!(!u.selected&&i&&(s==null?void 0:s.length)===i);if(!g){var v=s?GH([],s):[];if(u.selected){var x=v.findIndex(function(y){return qi(l,y)});v.splice(x,1)}else v.push(l);(m=t.onSelect)===null||m===void 0||m.call(t,v,l,u,h)}}},c={disabled:[]};s&&c.disabled.push(function(l){var u=i&&s.length>i-1,h=s.some(function(f){return qi(f,l)});return!!(u&&!h)});var d={selected:s,onDayClick:o,modifiers:c};return n.jsx(_8.Provider,{value:d,children:r})}function j8(){var e=P.useContext(_8);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function ybe(e,t){var r=t||{},s=r.from,a=r.to;return s&&a?qi(a,e)&&qi(s,e)?void 0:qi(a,e)?{from:a,to:void 0}:qi(s,e)?void 0:Fw(s,e)?{from:e,to:a}:{from:s,to:e}:a?Fw(e,a)?{from:a,to:e}:{from:e,to:a}:s?b8(e,s)?{from:e,to:s}:{from:s,to:e}:{from:e,to:void 0}}var N8=P.createContext(void 0);function bbe(e){if(!R1(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return n.jsx(N8.Provider,{value:t,children:e.children})}return n.jsx(wbe,{initialProps:e.initialProps,children:e.children})}function wbe(e){var t=e.initialProps,r=e.children,s=t.selected,a=s||{},i=a.from,o=a.to,c=t.min,d=t.max,l=function(m,p,g){var v,x;(v=t.onDayClick)===null||v===void 0||v.call(t,m,p,g);var y=ybe(m,s);(x=t.onSelect)===null||x===void 0||x.call(t,y,m,p,g)},u={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(u.range_start=[i],o?(u.range_end=[o],qi(i,o)||(u.range_middle=[{after:i,before:o}])):u.range_end=[i]):o&&(u.range_start=[o],u.range_end=[o]),c&&(i&&!o&&u.disabled.push({after:mn(i,c-1),before:vi(i,c-1)}),i&&o&&u.disabled.push({after:i,before:vi(i,c-1)}),!i&&o&&u.disabled.push({after:mn(o,c-1),before:vi(o,c-1)})),d){if(i&&!o&&(u.disabled.push({before:vi(i,-d+1)}),u.disabled.push({after:vi(i,d-1)})),i&&o){var h=ac(o,i)+1,f=d-h;u.disabled.push({before:mn(i,f)}),u.disabled.push({after:vi(o,f)})}!i&&o&&(u.disabled.push({before:vi(o,-d+1)}),u.disabled.push({after:vi(o,d-1)}))}return n.jsx(N8.Provider,{value:{selected:s,onDayClick:l,modifiers:u},children:r})}function S8(){var e=P.useContext(N8);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function Lb(e){return Array.isArray(e)?GH([],e):e!==void 0?[e]:[]}function _be(e){var t={};return Object.entries(e).forEach(function(r){var s=r[0],a=r[1];t[s]=Lb(a)}),t}var Ml;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(Ml||(Ml={}));var jbe=Ml.Selected,Fc=Ml.Disabled,Nbe=Ml.Hidden,Sbe=Ml.Today,B3=Ml.RangeEnd,$3=Ml.RangeMiddle,F3=Ml.RangeStart,Cbe=Ml.Outside;function Ebe(e,t,r){var s,a=(s={},s[jbe]=Lb(e.selected),s[Fc]=Lb(e.disabled),s[Nbe]=Lb(e.hidden),s[Sbe]=[e.today],s[B3]=[],s[$3]=[],s[F3]=[],s[Cbe]=[],s);return e.fromDate&&a[Fc].push({before:e.fromDate}),e.toDate&&a[Fc].push({after:e.toDate}),O1(e)?a[Fc]=a[Fc].concat(t.modifiers[Fc]):R1(e)&&(a[Fc]=a[Fc].concat(r.modifiers[Fc]),a[F3]=r.modifiers[F3],a[$3]=r.modifiers[$3],a[B3]=r.modifiers[B3]),a}var QH=P.createContext(void 0);function kbe(e){var t=os(),r=j8(),s=S8(),a=Ebe(t,r,s),i=_be(t.modifiers),o=$r($r({},a),i);return n.jsx(QH.Provider,{value:o,children:e.children})}function JH(){var e=P.useContext(QH);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Abe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Tbe(e){return!!(e&&typeof e=="object"&&"from"in e)}function Pbe(e){return!!(e&&typeof e=="object"&&"after"in e)}function Obe(e){return!!(e&&typeof e=="object"&&"before"in e)}function Rbe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Mbe(e,t){var r,s=t.from,a=t.to;if(s&&a){var i=ac(a,s)<0;i&&(r=[a,s],s=r[0],a=r[1]);var o=ac(e,s)>=0&&ac(a,e)>=0;return o}return a?qi(a,e):s?qi(s,e):!1}function Ibe(e){return p8(e)}function Dbe(e){return Array.isArray(e)&&e.every(p8)}function Lbe(e,t){return t.some(function(r){if(typeof r=="boolean")return r;if(Ibe(r))return qi(e,r);if(Dbe(r))return r.includes(e);if(Tbe(r))return Mbe(e,r);if(Rbe(r))return r.dayOfWeek.includes(e.getDay());if(Abe(r)){var s=ac(r.before,e),a=ac(r.after,e),i=s>0,o=a<0,c=Fw(r.before,r.after);return c?o&&i:i||o}return Pbe(r)?ac(e,r.after)>0:Obe(r)?ac(r.before,e)>0:typeof r=="function"?r(e):!1})}function C8(e,t,r){var s=Object.keys(t).reduce(function(i,o){var c=t[o];return Lbe(e,c)&&i.push(o),i},[]),a={};return s.forEach(function(i){return a[i]=!0}),r&&!w8(e,r)&&(a.outside=!0),a}function Bbe(e,t){for(var r=Ps(e[0]),s=fc(e[e.length-1]),a,i,o=r;o<=s;){var c=C8(o,t),d=!c.disabled&&!c.hidden;if(!d){o=vi(o,1);continue}if(c.selected)return o;c.today&&!i&&(i=o),a||(a=o),o=vi(o,1)}return i||a}var $be=365;function eG(e,t){var r=t.moveBy,s=t.direction,a=t.context,i=t.modifiers,o=t.retry,c=o===void 0?{count:0,lastFocused:e}:o,d=a.weekStartsOn,l=a.fromDate,u=a.toDate,h=a.locale,f={day:vi,week:VC,month:Qo,year:RH,startOfWeek:function(v){return a.ISOWeek?yf(v):bc(v,{locale:h,weekStartsOn:d})},endOfWeek:function(v){return a.ISOWeek?DH(v):x8(v,{locale:h,weekStartsOn:d})}},m=f[r](e,s==="after"?1:-1);s==="before"&&l?m=pve([l,m]):s==="after"&&u&&(m=gve([u,m]));var p=!0;if(i){var g=C8(m,i);p=!g.disabled&&!g.hidden}return p?m:c.count>$be?c.lastFocused:eG(m,{moveBy:r,direction:s,context:a,modifiers:i,retry:$r($r({},c),{count:c.count+1})})}var tG=P.createContext(void 0);function Fbe(e){var t=M1(),r=JH(),s=P.useState(),a=s[0],i=s[1],o=P.useState(),c=o[0],d=o[1],l=Bbe(t.displayMonths,r),u=a??(c&&t.isDateDisplayed(c))?c:l,h=function(){d(a),i(void 0)},f=function(v){i(v)},m=os(),p=function(v,x){if(a){var y=eG(a,{moveBy:v,direction:x,context:m,modifiers:r});qi(a,y)||(t.goToDate(y,a),f(y))}},g={focusedDay:a,focusTarget:u,blur:h,focus:f,focusDayAfter:function(){return p("day","after")},focusDayBefore:function(){return p("day","before")},focusWeekAfter:function(){return p("week","after")},focusWeekBefore:function(){return p("week","before")},focusMonthBefore:function(){return p("month","before")},focusMonthAfter:function(){return p("month","after")},focusYearBefore:function(){return p("year","before")},focusYearAfter:function(){return p("year","after")},focusStartOfWeek:function(){return p("startOfWeek","before")},focusEndOfWeek:function(){return p("endOfWeek","after")}};return n.jsx(tG.Provider,{value:g,children:e.children})}function E8(){var e=P.useContext(tG);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function zbe(e,t){var r=JH(),s=C8(e,r,t);return s}var k8=P.createContext(void 0);function Ube(e){if(!sj(e.initialProps)){var t={selected:void 0};return n.jsx(k8.Provider,{value:t,children:e.children})}return n.jsx(Vbe,{initialProps:e.initialProps,children:e.children})}function Vbe(e){var t=e.initialProps,r=e.children,s=function(i,o,c){var d,l,u;if((d=t.onDayClick)===null||d===void 0||d.call(t,i,o,c),o.selected&&!t.required){(l=t.onSelect)===null||l===void 0||l.call(t,void 0,i,o,c);return}(u=t.onSelect)===null||u===void 0||u.call(t,i,i,o,c)},a={selected:t.selected,onDayClick:s};return n.jsx(k8.Provider,{value:a,children:r})}function rG(){var e=P.useContext(k8);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function qbe(e,t){var r=os(),s=rG(),a=j8(),i=S8(),o=E8(),c=o.focusDayAfter,d=o.focusDayBefore,l=o.focusWeekAfter,u=o.focusWeekBefore,h=o.blur,f=o.focus,m=o.focusMonthBefore,p=o.focusMonthAfter,g=o.focusYearBefore,v=o.focusYearAfter,x=o.focusStartOfWeek,y=o.focusEndOfWeek,b=function(N){var C,k,I,U;sj(r)?(C=s.onDayClick)===null||C===void 0||C.call(s,e,t,N):O1(r)?(k=a.onDayClick)===null||k===void 0||k.call(a,e,t,N):R1(r)?(I=i.onDayClick)===null||I===void 0||I.call(i,e,t,N):(U=r.onDayClick)===null||U===void 0||U.call(r,e,t,N)},j=function(N){var C;f(e),(C=r.onDayFocus)===null||C===void 0||C.call(r,e,t,N)},T=function(N){var C;h(),(C=r.onDayBlur)===null||C===void 0||C.call(r,e,t,N)},O=function(N){var C;(C=r.onDayMouseEnter)===null||C===void 0||C.call(r,e,t,N)},R=function(N){var C;(C=r.onDayMouseLeave)===null||C===void 0||C.call(r,e,t,N)},D=function(N){var C;(C=r.onDayPointerEnter)===null||C===void 0||C.call(r,e,t,N)},L=function(N){var C;(C=r.onDayPointerLeave)===null||C===void 0||C.call(r,e,t,N)},q=function(N){var C;(C=r.onDayTouchCancel)===null||C===void 0||C.call(r,e,t,N)},X=function(N){var C;(C=r.onDayTouchEnd)===null||C===void 0||C.call(r,e,t,N)},H=function(N){var C;(C=r.onDayTouchMove)===null||C===void 0||C.call(r,e,t,N)},M=function(N){var C;(C=r.onDayTouchStart)===null||C===void 0||C.call(r,e,t,N)},F=function(N){var C;(C=r.onDayKeyUp)===null||C===void 0||C.call(r,e,t,N)},S=function(N){var C;switch(N.key){case"ArrowLeft":N.preventDefault(),N.stopPropagation(),r.dir==="rtl"?c():d();break;case"ArrowRight":N.preventDefault(),N.stopPropagation(),r.dir==="rtl"?d():c();break;case"ArrowDown":N.preventDefault(),N.stopPropagation(),l();break;case"ArrowUp":N.preventDefault(),N.stopPropagation(),u();break;case"PageUp":N.preventDefault(),N.stopPropagation(),N.shiftKey?g():m();break;case"PageDown":N.preventDefault(),N.stopPropagation(),N.shiftKey?v():p();break;case"Home":N.preventDefault(),N.stopPropagation(),x();break;case"End":N.preventDefault(),N.stopPropagation(),y();break}(C=r.onDayKeyDown)===null||C===void 0||C.call(r,e,t,N)},E={onClick:b,onFocus:j,onBlur:T,onKeyDown:S,onKeyUp:F,onMouseEnter:O,onMouseLeave:R,onPointerEnter:D,onPointerLeave:L,onTouchCancel:q,onTouchEnd:X,onTouchMove:H,onTouchStart:M};return E}function Wbe(){var e=os(),t=rG(),r=j8(),s=S8(),a=sj(e)?t.selected:O1(e)?r.selected:R1(e)?s.selected:void 0;return a}function Hbe(e){return Object.values(Ml).includes(e)}function Gbe(e,t){var r=[e.classNames.day];return Object.keys(t).forEach(function(s){var a=e.modifiersClassNames[s];if(a)r.push(a);else if(Hbe(s)){var i=e.classNames["day_".concat(s)];i&&r.push(i)}}),r}function Kbe(e,t){var r=$r({},e.styles.day);return Object.keys(t).forEach(function(s){var a;r=$r($r({},r),(a=e.modifiersStyles)===null||a===void 0?void 0:a[s])}),r}function Xbe(e,t,r){var s,a,i,o=os(),c=E8(),d=zbe(e,t),l=qbe(e,d),u=Wbe(),h=!!(o.onDayClick||o.mode!=="default");P.useEffect(function(){var O;d.outside||c.focusedDay&&h&&qi(c.focusedDay,e)&&((O=r.current)===null||O===void 0||O.focus())},[c.focusedDay,e,r,h,d.outside]);var f=Gbe(o,d).join(" "),m=Kbe(o,d),p=!!(d.outside&&!o.showOutsideDays||d.hidden),g=(i=(a=o.components)===null||a===void 0?void 0:a.DayContent)!==null&&i!==void 0?i:gbe,v=n.jsx(g,{date:e,displayMonth:t,activeModifiers:d}),x={style:m,className:f,children:v,role:"gridcell"},y=c.focusTarget&&qi(c.focusTarget,e)&&!d.outside,b=c.focusedDay&&qi(c.focusedDay,e),j=$r($r($r({},x),(s={disabled:d.disabled,role:"gridcell"},s["aria-selected"]=d.selected,s.tabIndex=b||y?0:-1,s)),l),T={isButton:h,isHidden:p,activeModifiers:d,selectedDays:u,buttonProps:j,divProps:x};return T}function Ybe(e){var t=P.useRef(null),r=Xbe(e.date,e.displayMonth,t);return r.isHidden?n.jsx("div",{role:"gridcell"}):r.isButton?n.jsx(zw,$r({name:"day",ref:t},r.buttonProps)):n.jsx("div",$r({},r.divProps))}function Zbe(e){var t=e.number,r=e.dates,s=os(),a=s.onWeekNumberClick,i=s.styles,o=s.classNames,c=s.locale,d=s.labels.labelWeekNumber,l=s.formatters.formatWeekNumber,u=l(Number(t),{locale:c});if(!a)return n.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:u});var h=d(Number(t),{locale:c}),f=function(m){a(t,r,m)};return n.jsx(zw,{name:"week-number","aria-label":h,className:o.weeknumber,style:i.weeknumber,onClick:f,children:u})}function Qbe(e){var t,r,s=os(),a=s.styles,i=s.classNames,o=s.showWeekNumber,c=s.components,d=(t=c==null?void 0:c.Day)!==null&&t!==void 0?t:Ybe,l=(r=c==null?void 0:c.WeekNumber)!==null&&r!==void 0?r:Zbe,u;return o&&(u=n.jsx("td",{className:i.cell,style:a.cell,children:n.jsx(l,{number:e.weekNumber,dates:e.dates})})),n.jsxs("tr",{className:i.row,style:a.row,children:[u,e.dates.map(function(h){return n.jsx("td",{className:i.cell,style:a.cell,role:"presentation",children:n.jsx(d,{displayMonth:e.displayMonth,date:h})},b1e(h))})]})}function NM(e,t,r){for(var s=r!=null&&r.ISOWeek?DH(t):x8(t,r),a=r!=null&&r.ISOWeek?yf(e):bc(e,r),i=ac(s,a),o=[],c=0;c<=i;c++)o.push(vi(a,c));var d=o.reduce(function(l,u){var h=r!=null&&r.ISOWeek?BH(u):FH(u,r),f=l.find(function(m){return m.weekNumber===h});return f?(f.dates.push(u),l):(l.push({weekNumber:h,dates:[u]}),l)},[]);return d}function Jbe(e,t){var r=NM(Ps(e),fc(e),t);if(t!=null&&t.useFixedWeeks){var s=_1e(e,t);if(s<6){var a=r[r.length-1],i=a.dates[a.dates.length-1],o=VC(i,6-s),c=NM(VC(i,1),o,t);r.push.apply(r,c)}}return r}function ewe(e){var t,r,s,a=os(),i=a.locale,o=a.classNames,c=a.styles,d=a.hideHead,l=a.fixedWeeks,u=a.components,h=a.weekStartsOn,f=a.firstWeekContainsDate,m=a.ISOWeek,p=Jbe(e.displayMonth,{useFixedWeeks:!!l,ISOWeek:m,locale:i,weekStartsOn:h,firstWeekContainsDate:f}),g=(t=u==null?void 0:u.Head)!==null&&t!==void 0?t:pbe,v=(r=u==null?void 0:u.Row)!==null&&r!==void 0?r:Qbe,x=(s=u==null?void 0:u.Footer)!==null&&s!==void 0?s:hbe;return n.jsxs("table",{id:e.id,className:o.table,style:c.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!d&&n.jsx(g,{}),n.jsx("tbody",{className:o.tbody,style:c.tbody,children:p.map(function(y){return n.jsx(v,{displayMonth:e.displayMonth,dates:y.dates,weekNumber:y.weekNumber},y.weekNumber)})}),n.jsx(x,{displayMonth:e.displayMonth})]})}function twe(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var rwe=twe()?P.useLayoutEffect:P.useEffect,z3=!1,nwe=0;function SM(){return"react-day-picker-".concat(++nwe)}function swe(e){var t,r=e??(z3?SM():null),s=P.useState(r),a=s[0],i=s[1];return rwe(function(){a===null&&i(SM())},[]),P.useEffect(function(){z3===!1&&(z3=!0)},[]),(t=e??a)!==null&&t!==void 0?t:void 0}function awe(e){var t,r,s=os(),a=s.dir,i=s.classNames,o=s.styles,c=s.components,d=M1().displayMonths,l=swe(s.id?"".concat(s.id,"-").concat(e.displayIndex):void 0),u=s.id?"".concat(s.id,"-grid-").concat(e.displayIndex):void 0,h=[i.month],f=o.month,m=e.displayIndex===0,p=e.displayIndex===d.length-1,g=!m&&!p;a==="rtl"&&(t=[m,p],p=t[0],m=t[1]),m&&(h.push(i.caption_start),f=$r($r({},f),o.caption_start)),p&&(h.push(i.caption_end),f=$r($r({},f),o.caption_end)),g&&(h.push(i.caption_between),f=$r($r({},f),o.caption_between));var v=(r=c==null?void 0:c.Caption)!==null&&r!==void 0?r:ube;return n.jsxs("div",{className:h.join(" "),style:f,children:[n.jsx(v,{id:l,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),n.jsx(ewe,{id:u,"aria-labelledby":l,displayMonth:e.displayMonth})]},e.displayIndex)}function iwe(e){var t=os(),r=t.classNames,s=t.styles;return n.jsx("div",{className:r.months,style:s.months,children:e.children})}function owe(e){var t,r,s=e.initialProps,a=os(),i=E8(),o=M1(),c=P.useState(!1),d=c[0],l=c[1];P.useEffect(function(){a.initialFocus&&i.focusTarget&&(d||(i.focus(i.focusTarget),l(!0)))},[a.initialFocus,d,i.focus,i.focusTarget,i]);var u=[a.classNames.root,a.className];a.numberOfMonths>1&&u.push(a.classNames.multiple_months),a.showWeekNumber&&u.push(a.classNames.with_weeknumber);var h=$r($r({},a.styles.root),a.style),f=Object.keys(s).filter(function(p){return p.startsWith("data-")}).reduce(function(p,g){var v;return $r($r({},p),(v={},v[g]=s[g],v))},{}),m=(r=(t=s.components)===null||t===void 0?void 0:t.Months)!==null&&r!==void 0?r:iwe;return n.jsx("div",$r({className:u.join(" "),style:h,dir:a.dir,id:a.id,nonce:s.nonce,title:s.title,lang:s.lang},f,{children:n.jsx(m,{children:o.displayMonths.map(function(p,g){return n.jsx(awe,{displayIndex:g,displayMonth:p},g)})})}))}function lwe(e){var t=e.children,r=Oye(e,["children"]);return n.jsx(Zye,{initialProps:r,children:n.jsx(obe,{children:n.jsx(Ube,{initialProps:r,children:n.jsx(xbe,{initialProps:r,children:n.jsx(bbe,{initialProps:r,children:n.jsx(kbe,{children:n.jsx(Fbe,{children:t})})})})})})})}function cwe(e){return n.jsx(lwe,$r({},e,{children:n.jsx(owe,{initialProps:e})}))}function Ti({className:e,classNames:t,showOutsideDays:r=!0,...s}){return n.jsx(cwe,{showOutsideDays:r,className:We("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:We(sv({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:We(sv({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...a})=>n.jsx(Gz,{className:"h-4 w-4"}),IconRight:({...a})=>n.jsx(Dn,{className:"h-4 w-4"})},...s})}Ti.displayName="Calendar";function dwe(){const[e,t]=P.useState([]),[r,s]=P.useState(!0),[a,i]=P.useState(""),[o,c]=P.useState(!1),[d,l]=P.useState(null),[u,h]=P.useState(""),[f,m]=P.useState("percentage"),[p,g]=P.useState(""),[v,x]=P.useState(),[y,b]=P.useState(),[j,T]=P.useState(""),[O,R]=P.useState(""),[D,L]=P.useState(!1);P.useEffect(()=>{q()},[]);const q=async()=>{s(!0);try{const{data:k,error:I}=await ce.from("coupons").select("*").order("created_at",{ascending:!1});if(I)throw I;t(k||[])}catch(k){console.error("Error fetching coupons:",k),de.error("Erro ao carregar cupons")}finally{s(!1)}},X=()=>{h(""),m("percentage"),g(""),x(void 0),b(void 0),T(""),R("")},H=async()=>{if(!u.trim()||!p){de.error("Preencha o cdigo e o valor do desconto");return}L(!0);try{const{error:k}=await ce.from("coupons").insert({code:u.toUpperCase().trim(),discount_type:f,discount_value:parseFloat(p),starts_at:(v==null?void 0:v.toISOString())||null,ends_at:(y==null?void 0:y.toISOString())||null,max_uses:j?parseInt(j):null,min_order_value:O?parseFloat(O):null});if(k){if(k.code==="23505")de.error("J existe um cupom com este cdigo");else throw k;return}de.success("Cupom criado com sucesso!"),c(!1),X(),q()}catch(k){console.error("Error creating coupon:",k),de.error("Erro ao criar cupom")}finally{L(!1)}},M=async k=>{try{const{error:I}=await ce.from("coupons").update({is_active:!k.is_active}).eq("id",k.id);if(I)throw I;t(U=>U.map($=>$.id===k.id?{...$,is_active:!$.is_active}:$)),de.success(k.is_active?"Cupom desativado":"Cupom ativado")}catch(I){console.error("Error toggling coupon:",I),de.error("Erro ao atualizar cupom")}},F=async k=>{if(confirm("Tem certeza que deseja excluir este cupom?"))try{const{error:I}=await ce.from("coupons").delete().eq("id",k);if(I)throw I;t(U=>U.filter($=>$.id!==k)),de.success("Cupom excludo")}catch(I){console.error("Error deleting coupon:",I),de.error("Erro ao excluir cupom")}},S=k=>{navigator.clipboard.writeText(k),l(k),setTimeout(()=>l(null),2e3)},E=e.filter(k=>k.code.toLowerCase().includes(a.toLowerCase())),N=k=>{if(!k.is_active)return{label:"Inativo",variant:"secondary"};const I=new Date;return k.starts_at&&new Date(k.starts_at)>I?{label:"Agendado",variant:"outline"}:k.ends_at&&new Date(k.ends_at)<I?{label:"Expirado",variant:"destructive"}:k.max_uses&&k.times_used>=k.max_uses?{label:"Esgotado",variant:"destructive"}:{label:"Ativo",variant:"default"}},C=k=>k.discount_type==="percentage"?`${k.discount_value}%`:`R$ ${k.discount_value.toFixed(2)}`;return n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(Hh,{className:"h-5 w-5"}),"Cupons de Desconto"]}),n.jsx(Ai,{children:"Gerencie cupons promocionais para suas vendas"})]}),n.jsxs(he,{onClick:()=>c(!0),children:[n.jsx(An,{className:"h-4 w-4 mr-1"}),"Novo Cupom"]})]})}),n.jsxs(Be,{children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar por cdigo...",value:a,onChange:k=>i(k.target.value),className:"pl-10"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Total"})]}),n.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(k=>N(k).label==="Ativo").length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Ativos"})]}),n.jsxs("div",{className:"p-3 bg-amber-50 dark:bg-amber-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:e.reduce((k,I)=>k+I.times_used,0)}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Usos"})]})]}),r?n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando..."}):E.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Hh,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhum cupom encontrado"})]}):n.jsx("div",{className:"rounded-md border overflow-x-auto",children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{children:"Cdigo"}),n.jsx(jt,{children:"Desconto"}),n.jsx(jt,{children:"Validade"}),n.jsx(jt,{children:"Usos"}),n.jsx(jt,{children:"Status"}),n.jsx(jt,{className:"text-right",children:"Aes"})]})}),n.jsx(Na,{children:E.map(k=>{const I=N(k);return n.jsxs(Qr,{children:[n.jsx(yt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("code",{className:"font-mono font-bold bg-secondary px-2 py-1 rounded",children:k.code}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>S(k.code),children:d===k.code?n.jsx(xn,{className:"h-3 w-3 text-green-600"}):n.jsx(Ia,{className:"h-3 w-3"})})]})}),n.jsxs(yt,{children:[n.jsxs("div",{className:"flex items-center gap-1",children:[k.discount_type==="percentage"?n.jsx(jo,{className:"h-3 w-3"}):n.jsx(ws,{className:"h-3 w-3"}),C(k)]}),k.min_order_value&&n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Mn: R$ ",k.min_order_value.toFixed(2)]})]}),n.jsx(yt,{children:n.jsxs("div",{className:"text-sm",children:[k.starts_at&&n.jsxs("div",{children:["De:"," ",Ht(new Date(k.starts_at),"dd/MM/yy",{locale:gr})]}),k.ends_at&&n.jsxs("div",{children:["At:"," ",Ht(new Date(k.ends_at),"dd/MM/yy",{locale:gr})]}),!k.starts_at&&!k.ends_at&&n.jsx("span",{className:"text-muted-foreground",children:"Sem limite"})]})}),n.jsx(yt,{children:n.jsxs("div",{className:"text-sm",children:[k.times_used,k.max_uses&&` / ${k.max_uses}`]})}),n.jsx(yt,{children:n.jsx(Ae,{variant:I.variant,children:I.label})}),n.jsx(yt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>M(k),title:k.is_active?"Desativar":"Ativar",children:k.is_active?n.jsx(Vu,{className:"h-4 w-4 text-green-600"}):n.jsx(Uu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>F(k.id),children:n.jsx(mi,{className:"h-4 w-4 text-destructive"})})]})})]},k.id)})})]})})]}),n.jsx(cn,{open:o,onOpenChange:c,children:n.jsxs(sn,{className:"sm:max-w-md",children:[n.jsx(fn,{children:n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(Hh,{className:"h-5 w-5"}),"Novo Cupom"]})}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Cdigo do Cupom *"}),n.jsx(Qe,{placeholder:"Ex: DESCONTO10",value:u,onChange:k=>h(k.target.value.toUpperCase()),className:"font-mono"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Tipo de Desconto *"}),n.jsxs(Kt,{value:f,onValueChange:k=>m(k),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsxs(qt,{className:"bg-background z-50",children:[n.jsx(ze,{value:"percentage",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(jo,{className:"h-3 w-3"})," Porcentagem"]})}),n.jsx(ze,{value:"fixed",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ws,{className:"h-3 w-3"})," Valor fixo"]})})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Valor *"}),n.jsxs("div",{className:"relative",children:[n.jsx(Qe,{type:"number",min:"0",step:f==="percentage"?"1":"0.01",max:f==="percentage"?"100":void 0,value:p,onChange:k=>g(k.target.value),placeholder:f==="percentage"?"10":"15.00",className:"pr-8"}),n.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm",children:f==="percentage"?"%":"R$"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Data de Incio"}),n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("w-full justify-start text-left font-normal",!v&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),v?Ht(v,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Za,{className:"w-auto p-0 bg-background z-50",align:"start",children:n.jsx(Ti,{mode:"single",selected:v,onSelect:x,initialFocus:!0,className:"pointer-events-auto"})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Data de Fim"}),n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("w-full justify-start text-left font-normal",!y&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),y?Ht(y,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Za,{className:"w-auto p-0 bg-background z-50",align:"start",children:n.jsx(Ti,{mode:"single",selected:y,onSelect:b,initialFocus:!0,className:"pointer-events-auto"})})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"N Mximo de Usos"}),n.jsx(Qe,{type:"number",min:"1",value:j,onChange:k=>T(k.target.value),placeholder:"Ilimitado"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Pedido Mnimo (R$)"}),n.jsx(Qe,{type:"number",min:"0",step:"0.01",value:O,onChange:k=>R(k.target.value),placeholder:"Sem mnimo"})]})]})]}),n.jsxs(Da,{children:[n.jsx(he,{variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),n.jsx(he,{onClick:H,disabled:D,children:D?"Criando...":"Criar Cupom"})]})]})})]})}const uwe=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"],hwe=["cancelado"],lh=e=>uwe.includes(e.status)||e.payment_status==="approved",_0=e=>hwe.includes(e.status);function fwe(e){const[t,r]=P.useState(null),[s,a]=P.useState(null),[i,o]=P.useState([]),[c,d]=P.useState([]),[l,u]=P.useState([]),[h,f]=P.useState([]),[m,p]=P.useState([]),[g,v]=P.useState(!0),{startDate:x,endDate:y,prevStartDate:b,prevEndDate:j}=P.useMemo(()=>{var X,H;const O=new Date;let R,D,L,q;switch(e.period){case"today":R=Vn(O),D=rs(O),L=Vn(mn(O,1)),q=rs(mn(O,1));break;case"7days":R=Vn(mn(O,6)),D=rs(O),L=Vn(mn(O,13)),q=rs(mn(O,7));break;case"30days":R=Vn(mn(O,29)),D=rs(O),L=Vn(mn(O,59)),q=rs(mn(O,30));break;case"thisMonth":R=Ps(O),D=rs(O),L=Ps(uo(O,1)),q=fc(uo(O,1));break;case"lastMonth":R=Ps(uo(O,1)),D=fc(uo(O,1)),L=Ps(uo(O,2)),q=fc(uo(O,2));break;case"custom":R=((X=e.customDateRange)==null?void 0:X.from)||Vn(O),D=((H=e.customDateRange)==null?void 0:H.to)||rs(O);const M=Math.ceil((D.getTime()-R.getTime())/(1e3*60*60*24));L=mn(R,M),q=mn(D,M);break;default:R=Vn(O),D=rs(O),L=Vn(mn(O,1)),q=rs(mn(O,1))}return{startDate:R,endDate:D,prevStartDate:L,prevEndDate:q}},[e.period,e.customDateRange]),T=P.useCallback(async()=>{v(!0);try{const[O,R]=await Promise.all([ce.from("sellers").select("id, name").eq("is_active",!0),ce.from("live_events").select("id, titulo, data_hora_inicio").order("data_hora_inicio",{ascending:!1}).limit(20)]);f(O.data||[]),p(R.data||[]);let D=ce.from("orders").select("*, order_items(*)").gte("created_at",x.toISOString()).lte("created_at",y.toISOString());e.channel==="catalog"?D=D.is("live_event_id",null):e.channel==="live"&&(D=D.not("live_event_id","is",null)),e.liveEventId&&(D=D.eq("live_event_id",e.liveEventId)),e.sellerId&&(D=D.eq("seller_id",e.sellerId));let L=ce.from("orders").select("*, order_items(*)").gte("created_at",b.toISOString()).lte("created_at",j.toISOString());e.channel==="catalog"?L=L.is("live_event_id",null):e.channel==="live"&&(L=L.not("live_event_id","is",null)),e.liveEventId&&(L=L.eq("live_event_id",e.liveEventId)),e.sellerId&&(L=L.eq("seller_id",e.sellerId));const q=ce.from("customers").select("*").order("total_spent",{ascending:!1}).limit(10),[X,H,M]=await Promise.all([D,L,q]),F=X.data||[],S=H.data||[],E=M.data||[];{const Se=F.filter(Ze=>Ze.live_event_id),$e=F.filter(Ze=>!Ze.live_event_id),Ke=F.filter(Ze=>lh(Ze)).length;console.log("[Dashboard Debug] Query Info:",{dateRange:{start:x.toISOString(),end:y.toISOString()},filters:{channel:e.channel,liveEventId:e.liveEventId,sellerId:e.sellerId},results:{totalOrders:F.length,liveOrders:Se.length,catalogOrders:$e.length,paidOrders:Ke,previousPeriodOrders:S.length},warning:Se.length===0&&e.channel!=="catalog"?" No Live orders found. Check if live_carts are being converted to orders.":null})}const N=Se=>{const $e=Se.filter(ut=>!_0(ut)),Ke=Se.filter(ut=>lh(ut)),Ze=Se.filter(ut=>_0(ut)),it=Ke.reduce((ut,bt)=>{const Ce=(bt.order_items||[]).reduce((Ge,Pe)=>Pe.product_price===0?Ge:Ge+Pe.product_price*Pe.quantity,0);return ut+Ce},0),Re=$e.reduce((ut,bt)=>{const Ce=(bt.order_items||[]).reduce((Ge,Pe)=>Pe.product_price===0?Ge:Ge+Pe.product_price*Pe.quantity,0);return ut+Ce},0),ot=Ke.reduce((ut,bt)=>{const Je=bt.order_items||[];return ut+Je.filter(Ce=>Ce.product_price>0).reduce((Ce,Ge)=>Ce+Ge.quantity,0)},0);return{paidTotal:it,reservedTotal:Re,paidCount:Ke.length,notCancelledCount:$e.length,cancelledCount:Ze.length,totalPieces:ot}},C=N(F),k=N(S),I=F.filter(Se=>lh(Se)&&Se.updated_at),U=I.length>0?I.reduce((Se,$e)=>{const Ke=lu($e.created_at),Ze=lu($e.updated_at);return Se+cM(Ze,Ke)},0)/I.length:0,$=await qC({startDate:x,endDate:y,liveEventId:e.liveEventId,sellerId:e.sellerId});console.log("[Dashboard] Pending orders debug:",$.debug);const Y=$.summary.map(Se=>({id:Se.type,type:Se.type,title:Se.title,count:Se.count,value:Se.value,severity:Se.severity}));u(Y);const Z=F.filter(Se=>!Se.live_event_id),re=F.filter(Se=>Se.live_event_id),G=Z.filter(Se=>!_0(Se)),J=re.filter(Se=>!_0(Se)),V=Z.filter(Se=>lh(Se)),W=re.filter(Se=>lh(Se)),ee=V.reduce((Se,$e)=>Se+($e.total||0),0),ie=W.reduce((Se,$e)=>Se+($e.total||0),0),oe=J.reduce((Se,$e)=>Se+($e.total||0),0),se=new Set(V.map(Se=>Se.customer_id).filter(Boolean));a({catalog:{pago:ee,pedidosPagos:V.length,ticket:V.length>0?ee/V.length:0,conversao:G.length>0?V.length/G.length*100:0,clientesAtivos:se.size},live:{pago:ie,reservado:oe,pedidosPagos:W.length,ticket:W.length>0?ie/W.length:0,conversao:J.length>0?W.length/J.length*100:0,progressoPagamento:oe>0?ie/oe*100:0,lotesPendentes:J.filter(Se=>!lh(Se)).length}});const le=new Map,ye=new Map;(O.data||[]).forEach(Se=>ye.set(Se.id,Se.name)),F.forEach(Se=>{const $e=Se.seller_id;if(!$e)return;const Ke=ye.get($e)||"Sem nome",Ze=le.get($e)||{id:$e,name:Ke,pedidosReservados:0,pedidosPagos:0,valorReservado:0,valorPago:0,tempoTotal:0};if(_0(Se)||(Ze.pedidosReservados+=1,Ze.valorReservado+=Se.total||0),lh(Se)&&(Ze.pedidosPagos+=1,Ze.valorPago+=Se.total||0,Se.updated_at)){const it=lu(Se.created_at),Re=lu(Se.updated_at);Ze.tempoTotal+=cM(Re,it)}le.set($e,Ze)});const ue=Array.from(le.values()).map(Se=>{const $e=Se.pedidosReservados>0?Se.pedidosPagos/Se.pedidosReservados*100:0,Ke=Se.pedidosPagos>0?Se.valorPago/Se.pedidosPagos:0,Ze=Se.pedidosPagos>0?Se.tempoTotal/Se.pedidosPagos:0;return{id:Se.id,name:Se.name,pedidosReservados:Se.pedidosReservados,pedidosPagos:Se.pedidosPagos,conversao:$e,valorPago:Se.valorPago,ticketMedio:Ke,tempoMedioPagamento:Ze,badges:[],performanceScore:0}});if(ue.length>0){const Se=Math.max(...ue.map(Je=>Je.valorPago),1),$e=Math.max(...ue.map(Je=>Je.pedidosPagos),1),Ke=Math.max(...ue.map(Je=>Je.ticketMedio),1);ue.forEach(Je=>{const Ce=Je.valorPago/Se,Ge=Je.pedidosPagos/$e,Pe=Je.ticketMedio/Ke,Ve=Je.conversao/100;Je.performanceScore=Ve*.4+Ce*.3+Ge*.2+Pe*.1});const Ze=Math.max(...ue.map(Je=>Je.valorPago)),it=ue.filter(Je=>Je.pedidosReservados>=3||Je.valorPago>=300),Re=it.length>0?Math.max(...it.map(Je=>Je.conversao)):0,ot=Math.max(...ue.map(Je=>Je.pedidosPagos)),ut=Math.max(...ue.map(Je=>Je.ticketMedio)),bt=Math.min(...ue.filter(Je=>Je.pedidosPagos>0).map(Je=>Je.tempoMedioPagamento));ue.forEach(Je=>{Je.badges=[],Je.valorPago===Ze&&Ze>0&&Je.badges.push("maior_faturamento"),(Je.pedidosReservados>=3||Je.valorPago>=300)&&Je.conversao===Re&&Re>0&&Je.badges.push("maior_conversao"),Je.pedidosPagos===ot&&ot>0&&Je.badges.push("mais_pedidos"),Je.ticketMedio===ut&&ut>0&&Je.badges.push("maior_ticket"),Je.pedidosPagos>0&&Je.tempoMedioPagamento===bt&&bt<24&&Je.badges.push("velocidade")})}o(ue.sort((Se,$e)=>$e.performanceScore-Se.performanceScore));const ne=E.slice(0,5).map(Se=>({id:Se.id,name:Se.name,instagram_handle:Se.instagram_handle,totalGasto:Se.total_spent||0,totalPedidos:Se.total_orders||0,ultimaCompra:Se.last_order_at}));d(ne);const pe=(Se,$e)=>{const Ke=Se-$e,Ze=$e>0?(Se-$e)/$e*100:Se>0?100:0;return{value:Se,previousValue:$e,change:Ke,changePercent:Ze}},ge=async(Se,$e)=>{const{count:Ke}=await ce.from("customers").select("*",{count:"exact",head:!0}).gte("created_at",Se.toISOString()).lte("created_at",$e.toISOString());return Ke||0},[Ne,_e]=await Promise.all([ge(x,y),ge(b,j)]),be=F.filter(Se=>Se.status==="cancelado").length,Me=F.filter(Se=>Se.status!=="cancelado").length;r({faturamentoPago:pe(C.paidTotal,k.paidTotal),reservado:pe(C.reservedTotal,k.reservedTotal),conversao:pe(C.reservedTotal>0?C.paidTotal/C.reservedTotal*100:0,k.reservedTotal>0?k.paidTotal/k.reservedTotal*100:0),ticketMedio:pe(C.paidCount>0?C.paidTotal/C.paidCount:0,k.paidCount>0?k.paidTotal/k.paidCount:0),pecasAtendimento:pe(C.paidCount>0?C.totalPieces/C.paidCount:0,k.paidCount>0?k.totalPieces/k.paidCount:0),pendenciasOperacionais:pe(Y.reduce((Se,$e)=>Se+$e.count,0),0),pedidosPagos:C.paidCount,pedidosPendentes:Me-C.paidCount,cancelados:be,novosClientes:pe(Ne,_e),taxaCancelamento:Me+be>0?be/(Me+be)*100:0})}catch(O){console.error("Error fetching dashboard data:",O)}finally{v(!1)}},[x,y,b,j,e.channel,e.sellerId,e.liveEventId]);return P.useEffect(()=>{T()},[T]),{kpis:t,channelComparison:s,sellerPerformance:i,topCustomers:c,pendingActions:l,sellers:h,liveEvents:m,isLoading:g,refetch:T,dateRange:{startDate:x,endDate:y}}}const mwe=[{value:"today",label:"Hoje"},{value:"7days",label:"ltimos 7 dias"},{value:"30days",label:"ltimos 30 dias"},{value:"thisMonth",label:"Este ms"},{value:"lastMonth",label:"Ms passado"},{value:"custom",label:"Personalizado"}],pwe=[{value:"all",label:"Todos os canais"},{value:"catalog",label:"Catlogo"},{value:"live",label:"Live"}];function gwe({filters:e,onFiltersChange:t,sellers:r,liveEvents:s}){var l,u;const a=h=>{t({...e,period:h})},i=h=>{t({...e,channel:h,liveEventId:h!=="live"?null:e.liveEventId})},o=h=>{t({...e,sellerId:h==="all_sellers"?null:h})},c=h=>{t({...e,liveEventId:h==="all_lives"?null:h})},d=h=>{h.from&&h.to&&t({...e,period:"custom",customDateRange:{from:h.from,to:h.to}})};return n.jsx("div",{className:"sticky top-14 sm:top-16 z-40 bg-background/95 backdrop-blur border-b border-border py-2 sm:py-3 -mx-4 px-4 mb-4 sm:mb-6",children:n.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[n.jsx(wd,{className:"h-4 w-4 text-muted-foreground hidden sm:block"}),n.jsxs(Kt,{value:e.period,onValueChange:a,children:[n.jsx(Vt,{className:"w-[130px] sm:w-[160px] h-8 sm:h-9 bg-card text-sm",children:n.jsx(Xt,{})}),n.jsx(qt,{className:"bg-popover z-50",children:mwe.map(h=>n.jsx(ze,{value:h.value,children:h.label},h.value))})]}),e.period==="custom"&&n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 h-8 sm:h-9 text-sm",children:[n.jsx(is,{className:"h-4 w-4"}),e.customDateRange?n.jsxs(n.Fragment,{children:[Ht(e.customDateRange.from,"dd/MM",{locale:gr})," - ",Ht(e.customDateRange.to,"dd/MM",{locale:gr})]}):"Selecionar datas"]})}),n.jsx(Za,{className:"w-auto p-0 bg-popover z-50",align:"start",children:n.jsx(Ti,{mode:"range",selected:{from:(l=e.customDateRange)==null?void 0:l.from,to:(u=e.customDateRange)==null?void 0:u.to},onSelect:h=>d(h||{}),numberOfMonths:2,className:We("p-3 pointer-events-auto")})})]}),n.jsx("div",{className:"h-6 w-px bg-border hidden sm:block"}),n.jsxs(Kt,{value:e.channel,onValueChange:i,children:[n.jsx(Vt,{className:"w-[120px] sm:w-[140px] h-8 sm:h-9 bg-card text-sm",children:n.jsx(Xt,{})}),n.jsx(qt,{className:"bg-popover z-50",children:pwe.map(h=>n.jsx(ze,{value:h.value,children:h.label},h.value))})]}),(e.channel==="all"||e.channel==="live")&&s.length>0&&n.jsxs(Kt,{value:e.liveEventId||"all_lives",onValueChange:c,children:[n.jsx(Vt,{className:"w-[140px] sm:w-[180px] h-8 sm:h-9 bg-card text-sm",children:n.jsx(Xt,{placeholder:"Todas as lives"})}),n.jsxs(qt,{className:"bg-popover z-50",children:[n.jsx(ze,{value:"all_lives",children:"Agrupar por perodo"}),s.map(h=>n.jsx(ze,{value:h.id,children:h.titulo},h.id))]})]}),n.jsx("div",{className:"h-6 w-px bg-border hidden sm:block"}),n.jsxs(Kt,{value:e.sellerId||"all_sellers",onValueChange:o,children:[n.jsx(Vt,{className:"w-[130px] sm:w-[160px] h-8 sm:h-9 bg-card text-sm",children:n.jsx(Xt,{placeholder:"Vendedoras"})}),n.jsxs(qt,{className:"bg-popover z-50",children:[n.jsx(ze,{value:"all_sellers",children:"Todas vendedoras"}),r.map(h=>n.jsx(ze,{value:h.id,children:h.name},h.id))]})]})]})})}function xwe(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}const nG=we.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),Rg=()=>{const e=we.useContext(nG);if(!e)throw new Error("useDrawerContext must be used within a Drawer.Root");return e};xwe(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,-100%,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(-100%,0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(100%,0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,100%,0)}}@keyframes slideFromTop{from{transform:translate3d(0,-100%,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,-100%,0)}}@keyframes slideFromLeft{from{transform:translate3d(-100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(-100%,0,0)}}@keyframes slideFromRight{from{transform:translate3d(100%,0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(100%,0,0)}}`);const vwe=24,ywe=typeof window<"u"?P.useLayoutEffect:P.useEffect;function CM(...e){return(...t)=>{for(let r of e)typeof r=="function"&&r(...t)}}function bwe(){return A8(/^Mac/)}function wwe(){return A8(/^iPhone/)}function EM(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function _we(){return A8(/^iPad/)||bwe()&&navigator.maxTouchPoints>1}function sG(){return wwe()||_we()}function A8(e){return typeof window<"u"&&window.navigator!=null?e.test(window.navigator.platform):void 0}const U3=typeof document<"u"&&window.visualViewport;function kM(e){let t=window.getComputedStyle(e);return/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}function aG(e){for(kM(e)&&(e=e.parentElement);e&&!kM(e);)e=e.parentElement;return e||document.scrollingElement||document.documentElement}const jwe=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let Uy=0,V3;function Nwe(e={}){let{isDisabled:t}=e;ywe(()=>{if(!t)return Uy++,Uy===1&&sG()&&(V3=Swe()),()=>{Uy--,Uy===0&&(V3==null||V3())}},[t])}function Swe(){let e,t=0,r=h=>{e=aG(h.target),!(e===document.documentElement&&e===document.body)&&(t=h.changedTouches[0].pageY)},s=h=>{if(!e||e===document.documentElement||e===document.body){h.preventDefault();return}let f=h.changedTouches[0].pageY,m=e.scrollTop,p=e.scrollHeight-e.clientHeight;p!==0&&((m<=0&&f>t||m>=p&&f<t)&&h.preventDefault(),t=f)},a=h=>{let f=h.target;WC(f)&&f!==document.activeElement&&(h.preventDefault(),f.style.transform="translateY(-2000px)",f.focus(),requestAnimationFrame(()=>{f.style.transform=""}))},i=h=>{let f=h.target;WC(f)&&(f.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{f.style.transform="",U3&&(U3.height<window.innerHeight?requestAnimationFrame(()=>{AM(f)}):U3.addEventListener("resize",()=>AM(f),{once:!0}))}))},o=()=>{window.scrollTo(0,0)},c=window.pageXOffset,d=window.pageYOffset,l=CM(Cwe(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let u=CM(j0(document,"touchstart",r,{passive:!1,capture:!0}),j0(document,"touchmove",s,{passive:!1,capture:!0}),j0(document,"touchend",a,{passive:!1,capture:!0}),j0(document,"focus",i,!0),j0(window,"scroll",o));return()=>{l(),u(),window.scrollTo(c,d)}}function Cwe(e,t,r){let s=e.style[t];return e.style[t]=r,()=>{e.style[t]=s}}function j0(e,t,r,s){return e.addEventListener(t,r,s),()=>{e.removeEventListener(t,r,s)}}function AM(e){let t=document.scrollingElement||document.documentElement;for(;e&&e!==t;){let r=aG(e);if(r!==document.documentElement&&r!==document.body&&r!==e){let s=r.getBoundingClientRect().top,a=e.getBoundingClientRect().top,i=e.getBoundingClientRect().bottom;const o=r.getBoundingClientRect().bottom+vwe;i>o&&(r.scrollTop+=a-s)}e=r.parentElement}}function WC(e){return e instanceof HTMLInputElement&&!jwe.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}function Ewe(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function kwe(...e){return t=>e.forEach(r=>Ewe(r,t))}function iG(...e){return P.useCallback(kwe(...e),e)}const oG=new WeakMap;function oa(e,t,r=!1){if(!e||!(e instanceof HTMLElement))return;let s={};Object.entries(t).forEach(([a,i])=>{if(a.startsWith("--")){e.style.setProperty(a,i);return}s[a]=e.style[a],e.style[a]=i}),!r&&oG.set(e,s)}function Awe(e,t){if(!e||!(e instanceof HTMLElement))return;let r=oG.get(e);r&&(e.style[t]=r[t])}const ca=e=>{switch(e){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return e}};function Vy(e,t){if(!e)return null;const r=window.getComputedStyle(e),s=r.transform||r.webkitTransform||r.mozTransform;let a=s.match(/^matrix3d\((.+)\)$/);return a?parseFloat(a[1].split(", ")[ca(t)?13:12]):(a=s.match(/^matrix\((.+)\)$/),a?parseFloat(a[1].split(", ")[ca(t)?5:4]):null)}function Twe(e){return 8*(Math.log(e+1)-2)}function q3(e,t){if(!e)return()=>{};const r=e.style.cssText;return Object.assign(e.style,t),()=>{e.style.cssText=r}}function Pwe(...e){return(...t)=>{for(const r of e)typeof r=="function"&&r(...t)}}const Ss={DURATION:.5,EASE:[.32,.72,0,1]},lG=.4,Owe=.25,Rwe=100,cG=8,ch=16,HC=26,W3="vaul-dragging";function dG(e){const t=we.useRef(e);return we.useEffect(()=>{t.current=e}),we.useMemo(()=>(...r)=>t.current==null?void 0:t.current.call(t,...r),[])}function Mwe({defaultProp:e,onChange:t}){const r=we.useState(e),[s]=r,a=we.useRef(s),i=dG(t);return we.useEffect(()=>{a.current!==s&&(i(s),a.current=s)},[s,a,i]),r}function uG({prop:e,defaultProp:t,onChange:r=()=>{}}){const[s,a]=Mwe({defaultProp:t,onChange:r}),i=e!==void 0,o=i?e:s,c=dG(r),d=we.useCallback(l=>{if(i){const h=typeof l=="function"?l(e):l;h!==e&&c(h)}else a(l)},[i,e,a,c]);return[o,d]}function Iwe({activeSnapPointProp:e,setActiveSnapPointProp:t,snapPoints:r,drawerRef:s,overlayRef:a,fadeFromIndex:i,onSnapPointChange:o,direction:c="bottom",container:d,snapToSequentialPoint:l}){const[u,h]=uG({prop:e,defaultProp:r==null?void 0:r[0],onChange:t}),[f,m]=we.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);we.useEffect(()=>{function R(){m({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[]);const p=we.useMemo(()=>u===(r==null?void 0:r[r.length-1])||null,[r,u]),g=we.useMemo(()=>r==null?void 0:r.findIndex(R=>R===u),[r,u]),v=r&&r.length>0&&(i||i===0)&&!Number.isNaN(i)&&r[i]===u||!r,x=we.useMemo(()=>{const R=d?{width:d.getBoundingClientRect().width,height:d.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var D;return(D=r==null?void 0:r.map(L=>{const q=typeof L=="string";let X=0;if(q&&(X=parseInt(L,10)),ca(c)){const M=q?X:f?L*R.height:0;return f?c==="bottom"?R.height-M:-R.height+M:M}const H=q?X:f?L*R.width:0;return f?c==="right"?R.width-H:-R.width+H:H}))!=null?D:[]},[r,f,d]),y=we.useMemo(()=>g!==null?x==null?void 0:x[g]:null,[x,g]),b=we.useCallback(R=>{var D;const L=(D=x==null?void 0:x.findIndex(q=>q===R))!=null?D:null;o(L),oa(s.current,{transition:`transform ${Ss.DURATION}s cubic-bezier(${Ss.EASE.join(",")})`,transform:ca(c)?`translate3d(0, ${R}px, 0)`:`translate3d(${R}px, 0, 0)`}),x&&L!==x.length-1&&L!==i&&L<i?oa(a.current,{transition:`opacity ${Ss.DURATION}s cubic-bezier(${Ss.EASE.join(",")})`,opacity:"0"}):oa(a.current,{transition:`opacity ${Ss.DURATION}s cubic-bezier(${Ss.EASE.join(",")})`,opacity:"1"}),h(r==null?void 0:r[Math.max(L,0)])},[s.current,r,x,i,a,h]);we.useEffect(()=>{if(u||e){var R;const D=(R=r==null?void 0:r.findIndex(L=>L===e||L===u))!=null?R:-1;x&&D!==-1&&typeof x[D]=="number"&&b(x[D])}},[u,e,r,x,b]);function j({draggedDistance:R,closeDrawer:D,velocity:L,dismissible:q}){if(i===void 0)return;const X=c==="bottom"||c==="right"?(y??0)-R:(y??0)+R,H=g===i-1,M=g===0,F=R>0;if(H&&oa(a.current,{transition:`opacity ${Ss.DURATION}s cubic-bezier(${Ss.EASE.join(",")})`}),!l&&L>2&&!F){q?D():b(x[0]);return}if(!l&&L>2&&F&&x&&r){b(x[r.length-1]);return}const S=x==null?void 0:x.reduce((N,C)=>typeof N!="number"||typeof C!="number"?N:Math.abs(C-X)<Math.abs(N-X)?C:N),E=ca(c)?window.innerHeight:window.innerWidth;if(L>lG&&Math.abs(R)<E*.4){const N=F?1:-1;if(N>0&&p){b(x[r.length-1]);return}if(M&&N<0&&q&&D(),g===null)return;b(x[g+N]);return}b(S)}function T({draggedDistance:R}){if(y===null)return;const D=c==="bottom"||c==="right"?y-R:y+R;(c==="bottom"||c==="right")&&D<x[x.length-1]||(c==="top"||c==="left")&&D>x[x.length-1]||oa(s.current,{transform:ca(c)?`translate3d(0, ${D}px, 0)`:`translate3d(${D}px, 0, 0)`})}function O(R,D){if(!r||typeof g!="number"||!x||i===void 0)return null;const L=g===i-1;if(g>=i&&D)return 0;if(L&&!D)return 1;if(!v&&!L)return null;const X=L?g+1:g-1,H=L?x[X]-x[X-1]:x[X+1]-x[X],M=R/Math.abs(H);return L?1-M:M}return{isLastSnapPoint:p,activeSnapPoint:u,shouldFade:v,getPercentageDragged:O,setActiveSnapPoint:h,activeSnapPointIndex:g,onRelease:j,onDrag:T,snapPointsOffset:x}}const Dwe=()=>()=>{};function Lwe(){const{direction:e,isOpen:t,shouldScaleBackground:r,setBackgroundColorOnScale:s,noBodyStyles:a}=Rg(),i=we.useRef(null),o=P.useMemo(()=>document.body.style.backgroundColor,[]);function c(){return(window.innerWidth-HC)/window.innerWidth}we.useEffect(()=>{if(t&&r){i.current&&clearTimeout(i.current);const d=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!d)return;Pwe(s&&!a?q3(document.body,{background:"black"}):Dwe,q3(d,{transformOrigin:ca(e)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${Ss.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Ss.EASE.join(",")})`}));const l=q3(d,{borderRadius:`${cG}px`,overflow:"hidden",...ca(e)?{transform:`scale(${c()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${c()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{l(),i.current=window.setTimeout(()=>{o?document.body.style.background=o:document.body.style.removeProperty("background")},Ss.DURATION*1e3)}}},[t,r,o])}let N0=null;function Bwe({isOpen:e,modal:t,nested:r,hasBeenOpened:s,preventScrollRestoration:a,noBodyStyles:i}){const[o,c]=we.useState(()=>typeof window<"u"?window.location.href:""),d=we.useRef(0),l=we.useCallback(()=>{if(EM()&&N0===null&&e&&!i){N0={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:h,innerHeight:f}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-d.current}px`,left:`${-h}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const m=f-window.innerHeight;m&&d.current>=f&&(document.body.style.top=`${-(d.current+m)}px`)}),300)}},[e]),u=we.useCallback(()=>{if(EM()&&N0!==null&&!i){const h=-parseInt(document.body.style.top,10),f=-parseInt(document.body.style.left,10);Object.assign(document.body.style,N0),window.requestAnimationFrame(()=>{if(a&&o!==window.location.href){c(window.location.href);return}window.scrollTo(f,h)}),N0=null}},[o]);return we.useEffect(()=>{function h(){d.current=window.scrollY}return h(),window.addEventListener("scroll",h),()=>{window.removeEventListener("scroll",h)}},[]),we.useEffect(()=>{r||!s||(e?(!window.matchMedia("(display-mode: standalone)").matches&&l(),t||window.setTimeout(()=>{u()},500)):u())},[e,s,o,t,r,l,u]),{restorePositionSetting:u}}function hG({open:e,onOpenChange:t,children:r,onDrag:s,onRelease:a,snapPoints:i,shouldScaleBackground:o=!1,setBackgroundColorOnScale:c=!0,closeThreshold:d=Owe,scrollLockTimeout:l=Rwe,dismissible:u=!0,handleOnly:h=!1,fadeFromIndex:f=i&&i.length-1,activeSnapPoint:m,setActiveSnapPoint:p,fixed:g,modal:v=!0,onClose:x,nested:y,noBodyStyles:b,direction:j="bottom",defaultOpen:T=!1,disablePreventScroll:O=!0,snapToSequentialPoint:R=!1,preventScrollRestoration:D=!1,repositionInputs:L=!0,onAnimationEnd:q,container:X,autoFocus:H=!1}){var M,F;const[S=!1,E]=uG({defaultProp:T,prop:e,onChange:st=>{t==null||t(st),!st&&!y&&Ke(),setTimeout(()=>{q==null||q(st)},Ss.DURATION*1e3),st&&!v&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),st||(document.body.style.pointerEvents="auto")}}),[N,C]=we.useState(!1),[k,I]=we.useState(!1),[U,$]=we.useState(!1),Y=we.useRef(null),Z=we.useRef(null),re=we.useRef(null),G=we.useRef(null),J=we.useRef(null),V=we.useRef(!1),W=we.useRef(null),ee=we.useRef(0),ie=we.useRef(!1),oe=we.useRef(0),se=we.useRef(null),le=we.useRef(((M=se.current)==null?void 0:M.getBoundingClientRect().height)||0),ye=we.useRef(((F=se.current)==null?void 0:F.getBoundingClientRect().width)||0),ue=we.useRef(0),ne=we.useCallback(st=>{i&&st===be.length-1&&(Z.current=new Date)},[]),{activeSnapPoint:pe,activeSnapPointIndex:ge,setActiveSnapPoint:Ne,onRelease:_e,snapPointsOffset:be,onDrag:Me,shouldFade:Se,getPercentageDragged:$e}=Iwe({snapPoints:i,activeSnapPointProp:m,setActiveSnapPointProp:p,drawerRef:se,fadeFromIndex:f,overlayRef:Y,onSnapPointChange:ne,direction:j,container:X,snapToSequentialPoint:R});Nwe({isDisabled:!S||k||!v||U||!N||!L||!O});const{restorePositionSetting:Ke}=Bwe({isOpen:S,modal:v,nested:y,hasBeenOpened:N,preventScrollRestoration:D,noBodyStyles:b});function Ze(){return(window.innerWidth-HC)/window.innerWidth}function it(st){var xt,fe;!u&&!i||se.current&&!se.current.contains(st.target)||(le.current=((xt=se.current)==null?void 0:xt.getBoundingClientRect().height)||0,ye.current=((fe=se.current)==null?void 0:fe.getBoundingClientRect().width)||0,I(!0),re.current=new Date,sG()&&window.addEventListener("touchend",()=>V.current=!1,{once:!0}),st.target.setPointerCapture(st.pointerId),ee.current=ca(j)?st.pageY:st.pageX)}function Re(st,xt){var fe,Ie;let tt=st;const lt=(fe=window.getSelection())==null?void 0:fe.toString(),It=se.current?Vy(se.current,j):null,ct=new Date;if(tt.hasAttribute("data-vaul-no-drag")||tt.closest("[data-vaul-no-drag]"))return!1;if(j==="right"||j==="left")return!0;if(Z.current&&ct.getTime()-Z.current.getTime()<500)return!1;if(It!==null&&(j==="bottom"?It>0:It<0))return!0;if(lt&&lt.length>0)return!1;if(ct.getTime()-((Ie=J.current)==null?void 0:Ie.getTime())<l&&It===0||xt)return J.current=ct,!1;for(;tt;){if(tt.scrollHeight>tt.clientHeight){if(tt.scrollTop!==0)return J.current=new Date,!1;if(tt.getAttribute("role")==="dialog")return!0}tt=tt.parentNode}return!0}function ot(st){if(se.current&&k){const xt=j==="bottom"||j==="right"?1:-1,fe=(ee.current-(ca(j)?st.pageY:st.pageX))*xt,Ie=fe>0,tt=i&&!u&&!Ie;if(tt&&ge===0)return;const lt=Math.abs(fe),It=document.querySelector("[data-vaul-drawer-wrapper]"),ct=j==="bottom"||j==="top"?le.current:ye.current;let at=lt/ct;const gt=$e(lt,Ie);if(gt!==null&&(at=gt),tt&&at>=1||!V.current&&!Re(st.target,Ie))return;if(se.current.classList.add(W3),V.current=!0,oa(se.current,{transition:"none"}),oa(Y.current,{transition:"none"}),i&&Me({draggedDistance:fe}),Ie&&!i){const St=Twe(fe),rt=Math.min(St*-1,0)*xt;oa(se.current,{transform:ca(j)?`translate3d(0, ${rt}px, 0)`:`translate3d(${rt}px, 0, 0)`});return}const Yt=1-at;if((Se||f&&ge===f-1)&&(s==null||s(st,at),oa(Y.current,{opacity:`${Yt}`,transition:"none"},!0)),It&&Y.current&&o){const St=Math.min(Ze()+at*(1-Ze()),1),rt=8-at*8,ir=Math.max(0,14-at*14);oa(It,{borderRadius:`${rt}px`,transform:ca(j)?`scale(${St}) translate3d(0, ${ir}px, 0)`:`scale(${St}) translate3d(${ir}px, 0, 0)`,transition:"none"},!0)}if(!i){const St=lt*xt;oa(se.current,{transform:ca(j)?`translate3d(0, ${St}px, 0)`:`translate3d(${St}px, 0, 0)`})}}}we.useEffect(()=>{var st;function xt(){if(!se.current||!L)return;const fe=document.activeElement;if(WC(fe)||ie.current){var Ie;const tt=((Ie=window.visualViewport)==null?void 0:Ie.height)||0,lt=window.innerHeight;let It=lt-tt;const ct=se.current.getBoundingClientRect().height||0,at=ct>lt*.8;ue.current||(ue.current=ct);const gt=se.current.getBoundingClientRect().top;if(Math.abs(oe.current-It)>60&&(ie.current=!ie.current),i&&i.length>0&&be&&ge){const Yt=be[ge]||0;It+=Yt}if(oe.current=It,ct>tt||ie.current){const Yt=se.current.getBoundingClientRect().height;let St=Yt;Yt>tt&&(St=tt-(at?gt:HC)),g?se.current.style.height=`${Yt-Math.max(It,0)}px`:se.current.style.height=`${Math.max(St,tt-gt)}px`}else se.current.style.height=`${ue.current}px`;i&&i.length>0&&!ie.current?se.current.style.bottom="0px":se.current.style.bottom=`${Math.max(It,0)}px`}}return(st=window.visualViewport)==null||st.addEventListener("resize",xt),()=>{var fe;return(fe=window.visualViewport)==null?void 0:fe.removeEventListener("resize",xt)}},[ge,i,be]);function ut(st){Je(),x==null||x(),st||E(!1),setTimeout(()=>{i&&Ne(i[0])},Ss.DURATION*1e3)}function bt(){if(!se.current)return;const st=document.querySelector("[data-vaul-drawer-wrapper]"),xt=Vy(se.current,j);oa(se.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${Ss.DURATION}s cubic-bezier(${Ss.EASE.join(",")})`}),oa(Y.current,{transition:`opacity ${Ss.DURATION}s cubic-bezier(${Ss.EASE.join(",")})`,opacity:"1"}),o&&xt&&xt>0&&S&&oa(st,{borderRadius:`${cG}px`,overflow:"hidden",...ca(j)?{transform:`scale(${Ze()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${Ze()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${Ss.DURATION}s`,transitionTimingFunction:`cubic-bezier(${Ss.EASE.join(",")})`},!0)}function Je(){!k||!se.current||(se.current.classList.remove(W3),V.current=!1,I(!1),G.current=new Date)}function Ce(st){if(!k||!se.current)return;se.current.classList.remove(W3),V.current=!1,I(!1),G.current=new Date;const xt=Vy(se.current,j);if(!Re(st.target,!1)||!xt||Number.isNaN(xt)||re.current===null)return;const fe=G.current.getTime()-re.current.getTime(),Ie=ee.current-(ca(j)?st.pageY:st.pageX),tt=Math.abs(Ie)/fe;if(tt>.05&&($(!0),setTimeout(()=>{$(!1)},200)),i){_e({draggedDistance:Ie*(j==="bottom"||j==="right"?1:-1),closeDrawer:ut,velocity:tt,dismissible:u}),a==null||a(st,!0);return}if(j==="bottom"||j==="right"?Ie>0:Ie<0){bt(),a==null||a(st,!0);return}if(tt>lG){ut(),a==null||a(st,!1);return}var lt;const It=Math.min((lt=se.current.getBoundingClientRect().height)!=null?lt:0,window.innerHeight);var ct;const at=Math.min((ct=se.current.getBoundingClientRect().width)!=null?ct:0,window.innerWidth),gt=j==="left"||j==="right";if(Math.abs(xt)>=(gt?at:It)*d){ut(),a==null||a(st,!1);return}a==null||a(st,!0),bt()}we.useEffect(()=>(S&&(oa(document.documentElement,{scrollBehavior:"auto"}),Z.current=new Date),()=>{Awe(document.documentElement,"scrollBehavior")}),[S]);function Ge(st){const xt=st?(window.innerWidth-ch)/window.innerWidth:1,fe=st?-ch:0;W.current&&window.clearTimeout(W.current),oa(se.current,{transition:`transform ${Ss.DURATION}s cubic-bezier(${Ss.EASE.join(",")})`,transform:`scale(${xt}) translate3d(0, ${fe}px, 0)`}),!st&&se.current&&(W.current=setTimeout(()=>{const Ie=Vy(se.current,j);oa(se.current,{transition:"none",transform:ca(j)?`translate3d(0, ${Ie}px, 0)`:`translate3d(${Ie}px, 0, 0)`})},500))}function Pe(st,xt){if(xt<0)return;const fe=(window.innerWidth-ch)/window.innerWidth,Ie=fe+xt*(1-fe),tt=-ch+xt*ch;oa(se.current,{transform:ca(j)?`scale(${Ie}) translate3d(0, ${tt}px, 0)`:`scale(${Ie}) translate3d(${tt}px, 0, 0)`,transition:"none"})}function Ve(st,xt){const fe=ca(j)?window.innerHeight:window.innerWidth,Ie=xt?(fe-ch)/fe:1,tt=xt?-ch:0;xt&&oa(se.current,{transition:`transform ${Ss.DURATION}s cubic-bezier(${Ss.EASE.join(",")})`,transform:ca(j)?`scale(${Ie}) translate3d(0, ${tt}px, 0)`:`scale(${Ie}) translate3d(${tt}px, 0, 0)`})}return we.createElement(w1,{defaultOpen:T,onOpenChange:st=>{!u&&!st||(st?C(!0):ut(!0),E(st))},open:S},we.createElement(nG.Provider,{value:{activeSnapPoint:pe,snapPoints:i,setActiveSnapPoint:Ne,drawerRef:se,overlayRef:Y,onOpenChange:t,onPress:it,onRelease:Ce,onDrag:ot,dismissible:u,handleOnly:h,isOpen:S,isDragging:k,shouldFade:Se,closeDrawer:ut,onNestedDrag:Pe,onNestedOpenChange:Ge,onNestedRelease:Ve,keyboardIsOpen:ie,modal:v,snapPointsOffset:be,direction:j,shouldScaleBackground:o,setBackgroundColorOnScale:c,noBodyStyles:b,container:X,autoFocus:H}},r))}const fG=we.forwardRef(function({...e},t){const{overlayRef:r,snapPoints:s,onRelease:a,shouldFade:i,isOpen:o,modal:c}=Rg(),d=iG(t,r),l=s&&s.length>0;return c?we.createElement(Tf,{onMouseUp:a,ref:d,"data-vaul-overlay":"","data-vaul-snap-points":o&&l?"true":"false","data-vaul-snap-points-overlay":o&&i?"true":"false",...e}):(typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),null)});fG.displayName="Drawer.Overlay";const mG=we.forwardRef(function({onPointerDownOutside:e,style:t,onOpenAutoFocus:r,...s},a){const{drawerRef:i,onPress:o,onRelease:c,onDrag:d,keyboardIsOpen:l,snapPointsOffset:u,modal:h,isOpen:f,direction:m,snapPoints:p,container:g,handleOnly:v,autoFocus:x}=Rg(),[y,b]=we.useState(!1),j=iG(a,i),T=we.useRef(null),O=we.useRef(null),R=we.useRef(!1),D=p&&p.length>0;Lwe();const L=(X,H,M=0)=>{if(R.current)return!0;const F=Math.abs(X.y),S=Math.abs(X.x),E=S>F,N=["bottom","right"].includes(H)?1:-1;if(H==="left"||H==="right"){if(!(X.x*N<0)&&S>=0&&S<=M)return E}else if(!(X.y*N<0)&&F>=0&&F<=M)return!E;return R.current=!0,!0};we.useEffect(()=>{D&&window.requestAnimationFrame(()=>{b(!0)})},[]);function q(X){T.current=null,R.current=!1,c(X)}return we.createElement(Pf,{"data-vaul-drawer-direction":m,"data-vaul-drawer":"","data-vaul-delayed-snap-points":y?"true":"false","data-vaul-snap-points":f&&D?"true":"false","data-vaul-custom-container":g?"true":"false",...s,ref:j,style:u&&u.length>0?{"--snap-point-height":`${u[0]}px`,...t}:t,onPointerDown:X=>{v||(s.onPointerDown==null||s.onPointerDown.call(s,X),T.current={x:X.pageX,y:X.pageY},o(X))},onOpenAutoFocus:X=>{r==null||r(X),x||X.preventDefault()},onPointerDownOutside:X=>{if(e==null||e(X),!h||X.defaultPrevented){X.preventDefault();return}l.current&&(l.current=!1)},onFocusOutside:X=>{if(!h){X.preventDefault();return}},onPointerMove:X=>{if(O.current=X,v||(s.onPointerMove==null||s.onPointerMove.call(s,X),!T.current))return;const H=X.pageY-T.current.y,M=X.pageX-T.current.x,F=X.pointerType==="touch"?10:2;L({x:M,y:H},m,F)?d(X):(Math.abs(M)>F||Math.abs(H)>F)&&(T.current=null)},onPointerUp:X=>{s.onPointerUp==null||s.onPointerUp.call(s,X),T.current=null,R.current=!1,c(X)},onPointerOut:X=>{s.onPointerOut==null||s.onPointerOut.call(s,X),q(O.current)},onContextMenu:X=>{s.onContextMenu==null||s.onContextMenu.call(s,X),q(O.current)}})});mG.displayName="Drawer.Content";const $we=250,Fwe=120,pG=we.forwardRef(function({preventCycle:e=!1,children:t,...r},s){const{closeDrawer:a,isDragging:i,snapPoints:o,activeSnapPoint:c,setActiveSnapPoint:d,dismissible:l,handleOnly:u,isOpen:h,onPress:f,onDrag:m}=Rg(),p=we.useRef(null),g=we.useRef(!1);function v(){if(g.current){b();return}window.setTimeout(()=>{x()},Fwe)}function x(){if(i||e||g.current){b();return}if(b(),(!o||o.length===0)&&l){a();return}if(c===o[o.length-1]&&l){a();return}const T=o.findIndex(R=>R===c);if(T===-1)return;const O=o[T+1];d(O)}function y(){p.current=window.setTimeout(()=>{g.current=!0},$we)}function b(){window.clearTimeout(p.current),g.current=!1}return we.createElement("div",{onClick:v,onPointerCancel:b,onPointerDown:j=>{u&&f(j),y()},onPointerMove:j=>{u&&m(j)},ref:s,"data-vaul-drawer-visible":h?"true":"false","data-vaul-handle":"","aria-hidden":"true",...r},we.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},t))});pG.displayName="Drawer.Handle";function zwe({onDrag:e,onOpenChange:t,...r}){const{onNestedDrag:s,onNestedOpenChange:a,onNestedRelease:i}=Rg();if(!s)throw new Error("Drawer.NestedRoot must be placed in another drawer");return we.createElement(hG,{nested:!0,onClose:()=>{a(!1)},onDrag:(o,c)=>{s(o,c),e==null||e(o,c)},onOpenChange:o=>{o&&a(o)},onRelease:i,...r})}function Uwe(e){const t=Rg(),{container:r=t.container,...s}=e;return we.createElement(_1,{container:r,...s})}const Fl={Root:hG,NestedRoot:zwe,Content:mG,Overlay:fG,Trigger:z_,Portal:Uwe,Handle:pG,Close:j1,Title:jg,Description:Ng},gG=({shouldScaleBackground:e=!0,...t})=>n.jsx(Fl.Root,{shouldScaleBackground:e,...t});gG.displayName="Drawer";const Vwe=Fl.Trigger,qwe=Fl.Portal,Wwe=Fl.Close,xG=P.forwardRef(({className:e,...t},r)=>n.jsx(Fl.Overlay,{ref:r,className:We("fixed inset-0 z-50 bg-black/80",e),...t}));xG.displayName=Fl.Overlay.displayName;const vG=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(qwe,{children:[n.jsx(xG,{}),n.jsxs(Fl.Content,{ref:s,className:We("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto max-h-[85vh] flex-col rounded-t-[10px] border bg-background overflow-hidden",e),...r,children:[n.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted shrink-0"}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:t})]})]}));vG.displayName="DrawerContent";const yG=({className:e,...t})=>n.jsx("div",{className:We("grid gap-1.5 p-4 text-center sm:text-left",e),...t});yG.displayName="DrawerHeader";const bG=({className:e,...t})=>n.jsx("div",{className:We("mt-auto flex flex-col gap-2 p-4",e),...t});bG.displayName="DrawerFooter";const wG=P.forwardRef(({className:e,...t},r)=>n.jsx(Fl.Title,{ref:r,className:We("text-lg font-semibold leading-none tracking-tight",e),...t}));wG.displayName=Fl.Title.displayName;const Hwe=P.forwardRef(({className:e,...t},r)=>n.jsx(Fl.Description,{ref:r,className:We("text-sm text-muted-foreground",e),...t}));Hwe.displayName=Fl.Description.displayName;const TM=[{value:"today",label:"Hoje"},{value:"7days",label:"ltimos 7 dias"},{value:"30days",label:"ltimos 30 dias"},{value:"thisMonth",label:"Este ms"},{value:"lastMonth",label:"Ms passado"},{value:"custom",label:"Personalizado"}],Gwe=[{value:"all",label:"Todos os canais"},{value:"catalog",label:"Catlogo"},{value:"live",label:"Live"}];function Kwe({filters:e,onFiltersChange:t,sellers:r,liveEvents:s}){var p,g,v,x,y;const[a,i]=P.useState(!1),[o,c]=P.useState(e),[d,l]=P.useState(!1),u=()=>{t(o),i(!1)},h=()=>{const b={period:"7days",channel:"all",liveEventId:null,sellerId:null};c(b),t(b),i(!1)},f=[e.period!=="7days",e.channel!=="all",e.sellerId!==null,e.liveEventId!==null].filter(Boolean).length,m=((p=TM.find(b=>b.value===e.period))==null?void 0:p.label)||"Perodo";return n.jsxs(gG,{open:a,onOpenChange:i,children:[n.jsx(Vwe,{asChild:!0,children:n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 h-9",children:[n.jsx(wd,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden xs:inline",children:m}),f>0&&n.jsx(Ae,{variant:"secondary",className:"h-5 w-5 p-0 flex items-center justify-center text-xs",children:f})]})}),n.jsxs(vG,{className:"max-h-[85vh]",children:[n.jsx(yG,{className:"border-b pb-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(wG,{children:"Filtros"}),n.jsx(Wwe,{asChild:!0,children:n.jsx(he,{variant:"ghost",size:"icon",children:n.jsx(an,{className:"h-5 w-5"})})})]})}),n.jsxs("div",{className:"p-4 space-y-6 overflow-y-auto flex-1",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{className:"text-sm font-medium",children:"Perodo"}),n.jsxs(Kt,{value:o.period,onValueChange:b=>{c({...o,period:b}),b==="custom"&&l(!0)},children:[n.jsx(Vt,{className:"w-full h-12",children:n.jsx(Xt,{})}),n.jsx(qt,{children:TM.map(b=>n.jsx(ze,{value:b.value,children:b.label},b.value))})]})]}),o.period==="custom"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{className:"text-sm font-medium",children:"Intervalo de datas"}),n.jsx("div",{className:"border rounded-lg p-2",children:n.jsx(Ti,{mode:"range",selected:{from:(g=o.customDateRange)==null?void 0:g.from,to:(v=o.customDateRange)==null?void 0:v.to},onSelect:b=>{b!=null&&b.from&&(b!=null&&b.to)&&c({...o,customDateRange:{from:b.from,to:b.to}})},numberOfMonths:1,className:"pointer-events-auto"})}),((x=o.customDateRange)==null?void 0:x.from)&&((y=o.customDateRange)==null?void 0:y.to)&&n.jsxs("p",{className:"text-sm text-muted-foreground text-center",children:[Ht(o.customDateRange.from,"dd/MM/yyyy",{locale:gr})," -"," ",Ht(o.customDateRange.to,"dd/MM/yyyy",{locale:gr})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{className:"text-sm font-medium",children:"Canal"}),n.jsxs(Kt,{value:o.channel,onValueChange:b=>c({...o,channel:b,liveEventId:b!=="live"?null:o.liveEventId}),children:[n.jsx(Vt,{className:"w-full h-12",children:n.jsx(Xt,{})}),n.jsx(qt,{children:Gwe.map(b=>n.jsx(ze,{value:b.value,children:b.label},b.value))})]})]}),(o.channel==="all"||o.channel==="live")&&s.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{className:"text-sm font-medium",children:"Live"}),n.jsxs(Kt,{value:o.liveEventId||"all_lives",onValueChange:b=>c({...o,liveEventId:b==="all_lives"?null:b}),children:[n.jsx(Vt,{className:"w-full h-12",children:n.jsx(Xt,{placeholder:"Todas as lives"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all_lives",children:"Todas as lives"}),s.map(b=>n.jsx(ze,{value:b.id,children:b.titulo},b.id))]})]})]}),r.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{className:"text-sm font-medium",children:"Vendedora"}),n.jsxs(Kt,{value:o.sellerId||"all_sellers",onValueChange:b=>c({...o,sellerId:b==="all_sellers"?null:b}),children:[n.jsx(Vt,{className:"w-full h-12",children:n.jsx(Xt,{placeholder:"Todas as vendedoras"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all_sellers",children:"Todas as vendedoras"}),r.map(b=>n.jsx(ze,{value:b.id,children:b.name},b.id))]})]})]})]}),n.jsxs(bG,{className:"border-t pt-4 gap-2",children:[n.jsxs(he,{onClick:u,className:"w-full h-12 gap-2",children:[n.jsx(xn,{className:"h-4 w-4"}),"Aplicar Filtros"]}),n.jsx(he,{variant:"outline",onClick:h,className:"w-full h-12",children:"Limpar Filtros"})]})]})]})}const H3=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),GC=e=>`${e.toFixed(1)}%`,Xwe=(e,t=1)=>e.toFixed(t);function nm({icon:e,label:t,value:r,kpi:s,tooltip:a,onClick:i,variant:o="default"}){const c=s.changePercent>0,d=s.changePercent<0,l=c?_s:d?qx:null,u={default:"bg-card hover:bg-card/80",success:"bg-primary/5 hover:bg-primary/10 border-primary/20",warning:"bg-amber-50 hover:bg-amber-100/50 border-amber-200",muted:"bg-muted/50 hover:bg-muted"}[o];return n.jsx(wp,{children:n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsx(De,{className:We("cursor-pointer transition-all group border min-h-[100px]",u),onClick:i,children:n.jsxs(Be,{className:"p-3 sm:p-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-1 sm:mb-2",children:[n.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 min-w-0",children:[n.jsx(e,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-muted-foreground shrink-0"}),n.jsx("span",{className:"text-[10px] sm:text-xs font-medium text-muted-foreground uppercase tracking-wide truncate",children:t})]}),n.jsx(Yz,{className:"h-3 w-3 text-muted-foreground/50 shrink-0 hidden sm:block"})]}),n.jsx("p",{className:"text-lg sm:text-2xl font-semibold text-foreground tracking-tight truncate",children:r}),l&&s.changePercent!==0&&n.jsxs("div",{className:We("flex items-center gap-1 mt-1 text-[10px] sm:text-xs font-medium",c?"text-primary":"text-destructive"),children:[n.jsx(l,{className:"h-3 w-3 shrink-0"}),n.jsxs("span",{className:"truncate",children:[c?"+":"",GC(s.changePercent)]}),n.jsx("span",{className:"text-muted-foreground font-normal hidden sm:inline",children:"vs anterior"})]})]})})}),n.jsx(Aa,{side:"bottom",className:"max-w-xs",children:n.jsx("p",{className:"text-xs",children:a})})]})})}function Ywe({kpis:e,onKPIClick:t}){return n.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-2 sm:gap-3",children:[n.jsx(nm,{icon:ws,label:"Faturamento",value:H3(e.faturamentoPago.value),kpi:e.faturamentoPago,tooltip:"Soma de pedidos com pagamento confirmado. Exclui brindes (R$0).",onClick:()=>t("faturamento"),variant:"success"}),n.jsx(nm,{icon:ln,label:"Reservado",value:H3(e.reservado.value),kpi:e.reservado,tooltip:"Soma de pedidos ativos (no cancelados), independente de pagamento.",onClick:()=>t("reservado")}),n.jsx(nm,{icon:ba,label:"Converso",value:GC(e.conversao.value),kpi:e.conversao,tooltip:"Pago  Reservado (em R$). Mede eficincia de fechamento.",onClick:()=>t("conversao")}),n.jsx(nm,{icon:ws,label:"Ticket",value:H3(e.ticketMedio.value),kpi:e.ticketMedio,tooltip:"Faturamento Pago  N de pedidos pagos.",onClick:()=>t("ticket")}),n.jsx(nm,{icon:Ut,label:"P.A.",value:Xwe(e.pecasAtendimento.value),kpi:e.pecasAtendimento,tooltip:"Peas por Atendimento: itens pagos (sem brinde)  n de pedidos pagos.",onClick:()=>t("pa")}),n.jsx(nm,{icon:Mr,label:"Pendncias",value:e.pendenciasOperacionais.value.toString(),kpi:e.pendenciasOperacionais,tooltip:"Pedidos que exigem ao imediata (cobrar, postar, validar, etc.).",onClick:()=>t("pendencias"),variant:e.pendenciasOperacionais.value>0?"warning":"muted"})]}),n.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2 sm:pb-0 sm:grid sm:grid-cols-3 md:grid-cols-5 sm:overflow-visible -mx-4 px-4 sm:mx-0 sm:px-0",children:[n.jsx(De,{className:"bg-card/50 cursor-pointer hover:bg-card transition-colors shrink-0 w-[140px] sm:w-auto",onClick:()=>t("pagos"),children:n.jsx(Be,{className:"p-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:"Pagos"}),n.jsx("span",{className:"text-base sm:text-lg font-semibold text-primary",children:e.pedidosPagos})]})})}),n.jsx(De,{className:"bg-card/50 cursor-pointer hover:bg-card transition-colors shrink-0 w-[140px] sm:w-auto",onClick:()=>t("pendentes"),children:n.jsx(Be,{className:"p-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:"Pendentes"}),n.jsx("span",{className:"text-base sm:text-lg font-semibold text-amber-600",children:e.pedidosPendentes})]})})}),n.jsx(De,{className:"bg-card/50 cursor-pointer hover:bg-card transition-colors shrink-0 w-[140px] sm:w-auto",onClick:()=>t("cancelados"),children:n.jsx(Be,{className:"p-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:"Cancelados"}),n.jsx("span",{className:"text-base sm:text-lg font-semibold text-destructive",children:e.cancelados})]})})}),n.jsx(De,{className:"bg-card/50 cursor-pointer hover:bg-card transition-colors shrink-0 w-[140px] sm:w-auto",onClick:()=>t("ticket"),children:n.jsx(Be,{className:"p-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(hk,{className:"h-3 w-3 text-muted-foreground"}),n.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:"Novos Cli."})]}),n.jsxs("span",{className:"text-base sm:text-lg font-semibold",children:[e.novosClientes.value,e.novosClientes.change>0&&n.jsxs("span",{className:"text-xs text-primary ml-1",children:["+",e.novosClientes.change]})]})]})})}),n.jsx(De,{className:"bg-card/50 shrink-0 w-[140px] sm:w-auto",children:n.jsx(Be,{className:"p-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:"Cancelam."}),n.jsx("span",{className:We("text-base sm:text-lg font-semibold",e.taxaCancelamento>10?"text-destructive":"text-muted-foreground"),children:GC(e.taxaCancelamento)})]})})})]})]})}var T8="Progress",P8=100,[Zwe,pet]=ta(T8),[Qwe,Jwe]=Zwe(T8),_G=P.forwardRef((e,t)=>{const{__scopeProgress:r,value:s=null,max:a,getValueLabel:i=e2e,...o}=e;(a||a===0)&&!PM(a)&&console.error(t2e(`${a}`,"Progress"));const c=PM(a)?a:P8;s!==null&&!OM(s,c)&&console.error(r2e(`${s}`,"Progress"));const d=OM(s,c)?s:null,l=Uw(d)?i(d,c):void 0;return n.jsx(Qwe,{scope:r,value:d,max:c,children:n.jsx(er.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":Uw(d)?d:void 0,"aria-valuetext":l,role:"progressbar","data-state":SG(d,c),"data-value":d??void 0,"data-max":c,...o,ref:t})})});_G.displayName=T8;var jG="ProgressIndicator",NG=P.forwardRef((e,t)=>{const{__scopeProgress:r,...s}=e,a=Jwe(jG,r);return n.jsx(er.div,{"data-state":SG(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...s,ref:t})});NG.displayName=jG;function e2e(e,t){return`${Math.round(e/t*100)}%`}function SG(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Uw(e){return typeof e=="number"}function PM(e){return Uw(e)&&!isNaN(e)&&e>0}function OM(e,t){return Uw(e)&&!isNaN(e)&&e<=t&&e>=0}function t2e(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${P8}\`.`}function r2e(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${P8} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var CG=_G,n2e=NG;const Mg=P.forwardRef(({className:e,value:t,...r},s)=>n.jsx(CG,{ref:s,className:We("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:n.jsx(n2e,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Mg.displayName=CG.displayName;const S0=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),G3=e=>`${e.toFixed(1)}%`;function dh({label:e,value:t,highlight:r,icon:s,onClick:a}){return n.jsxs("div",{className:`flex items-center justify-between py-2 border-b border-border/30 last:border-0 ${a?"cursor-pointer hover:bg-muted/50 -mx-1 px-1 rounded transition-colors":""}`,onClick:a,children:[n.jsxs("span",{className:"text-sm text-muted-foreground flex items-center gap-1.5",children:[s,e]}),n.jsx("span",{className:`text-sm font-medium ${r?"text-primary":""}`,children:t})]})}function s2e({data:e}){const t=fr();return n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[n.jsxs(De,{className:"cursor-pointer hover:shadow-md transition-all group bg-gradient-to-br from-stone-50 to-stone-100/50 border-stone-200",onClick:()=>t(zs.catalogAll()),children:[n.jsx(Ot,{className:"pb-2 sm:pb-3 p-3 sm:p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"p-1.5 rounded-md bg-stone-200/60",children:n.jsx(pa,{className:"h-4 w-4 text-stone-600"})}),n.jsx(Mt,{className:"text-sm sm:text-base font-semibold text-stone-700",children:"Catlogo"})]}),n.jsx(ps,{className:"h-4 w-4 text-stone-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),n.jsxs(Be,{className:"pt-0 p-3 sm:p-6 sm:pt-0",children:[n.jsxs("div",{className:"mb-3 sm:mb-4 cursor-pointer hover:opacity-80 transition-opacity",onClick:r=>{r.stopPropagation(),t(zs.catalogPagos())},children:[n.jsx("p",{className:"text-xl sm:text-2xl font-semibold text-stone-800",children:S0(e.catalog.pago)}),n.jsx("p",{className:"text-[10px] sm:text-xs text-stone-500",children:"Faturamento Pago"})]}),n.jsxs("div",{className:"space-y-0.5 text-sm",children:[n.jsx(dh,{label:"Pedidos Pagos",value:e.catalog.pedidosPagos.toString(),onClick:()=>t(zs.catalogPagos())}),n.jsx(dh,{label:"Ticket Mdio",value:S0(e.catalog.ticket)}),n.jsx(dh,{label:"Converso",value:G3(e.catalog.conversao)}),n.jsx(dh,{label:"Clientes",value:e.catalog.clientesAtivos.toString(),icon:n.jsx(wa,{className:"h-3 w-3"})})]}),n.jsx("div",{className:"mt-3 sm:mt-4 pt-2 sm:pt-3 border-t border-stone-200",children:n.jsxs("span",{className:"text-[10px] sm:text-xs text-stone-500 flex items-center gap-1",children:[n.jsx(ps,{className:"h-3 w-3"})," Ver pedidos"]})})]})]}),n.jsxs(De,{className:"cursor-pointer hover:shadow-md transition-all group bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20",onClick:()=>t(zs.liveAll()),children:[n.jsx(Ot,{className:"pb-2 sm:pb-3 p-3 sm:p-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"p-1.5 rounded-md bg-primary/15",children:n.jsx(Ts,{className:"h-4 w-4 text-primary"})}),n.jsx(Mt,{className:"text-sm sm:text-base font-semibold text-foreground",children:"Live Shop"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[e.live.lotesPendentes>0&&n.jsxs(Ae,{variant:"outline",className:"text-[10px] sm:text-xs border-amber-300 text-amber-700 bg-amber-50 px-1.5 py-0 cursor-pointer hover:bg-amber-100",onClick:r=>{r.stopPropagation(),t(zs.livePendentes())},children:[e.live.lotesPendentes," a cobrar"]}),n.jsx(ps,{className:"h-4 w-4 text-primary/50 opacity-0 group-hover:opacity-100 transition-opacity"})]})]})}),n.jsxs(Be,{className:"pt-0 p-3 sm:p-6 sm:pt-0",children:[n.jsxs("div",{className:"mb-3 sm:mb-4 flex items-end gap-3 sm:gap-4",children:[n.jsxs("div",{className:"cursor-pointer hover:opacity-80 transition-opacity",onClick:r=>{r.stopPropagation(),t(zs.livePagos())},children:[n.jsx("p",{className:"text-xl sm:text-2xl font-semibold text-primary",children:S0(e.live.pago)}),n.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"Faturamento Pago"})]}),n.jsxs("div",{className:"text-right cursor-pointer hover:opacity-80 transition-opacity",onClick:r=>{r.stopPropagation(),t(zs.livePendentes())},children:[n.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground",children:S0(e.live.reservado)}),n.jsx("p",{className:"text-[10px] sm:text-xs text-muted-foreground",children:"Reservado"})]})]}),n.jsxs("div",{className:"mb-2 sm:mb-3",children:[n.jsxs("div",{className:"flex justify-between text-[10px] sm:text-xs text-muted-foreground mb-1",children:[n.jsx("span",{children:"Pagamento"}),n.jsx("span",{className:"font-medium",children:G3(e.live.progressoPagamento)})]}),n.jsx(Mg,{value:e.live.progressoPagamento,className:"h-1.5 sm:h-2"})]}),n.jsxs("div",{className:"space-y-0.5 text-sm",children:[n.jsx(dh,{label:"Pedidos Pagos",value:e.live.pedidosPagos.toString(),onClick:()=>t(zs.livePagos())}),n.jsx(dh,{label:"Ticket Mdio",value:S0(e.live.ticket)}),n.jsx(dh,{label:"Converso",value:G3(e.live.conversao),icon:n.jsx(_s,{className:"h-3 w-3"})})]}),n.jsx("div",{className:"mt-3 sm:mt-4 pt-2 sm:pt-3 border-t border-primary/10",children:n.jsxs("span",{className:"text-[10px] sm:text-xs text-primary/70 flex items-center gap-1",children:[n.jsx(ps,{className:"h-3 w-3"})," Ver pedidos"]})})]})]})]})}const qy=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),RM=e=>`${e.toFixed(1)}%`,a2e={maior_faturamento:{icon:ws,label:"Maior Faturamento",color:"bg-primary/10 text-primary border-primary/30"},maior_conversao:{icon:ba,label:"Maior Converso",color:"bg-emerald-50 text-emerald-700 border-emerald-200"},mais_pedidos:{icon:ln,label:"Mais Pedidos",color:"bg-blue-50 text-blue-700 border-blue-200"},maior_ticket:{icon:tU,label:"Maior Ticket",color:"bg-violet-50 text-violet-700 border-violet-200"},velocidade:{icon:Ei,label:"Mais Rpida",color:"bg-amber-50 text-amber-700 border-amber-200"}};function i2e({sellers:e}){const[t,r]=P.useState("valorPago"),[s,a]=P.useState(!1),i=l=>{t===l?a(!s):(r(l),a(!1))},o=[...e].sort((l,u)=>{const h=l[t]-u[t];return s?h:-h}),c=l=>l.length===0?null:n.jsx("div",{className:"flex flex-wrap gap-1",children:l.map(u=>{const h=a2e[u],f=h.icon;return n.jsx(wp,{children:n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsx(Ae,{variant:"outline",className:We("text-xs gap-1 border",h.color),children:n.jsx(f,{className:"h-3 w-3"})})}),n.jsx(Aa,{side:"top",children:n.jsx("p",{className:"text-xs",children:h.label})})]})},u)})}),d=({label:l,sortKeyName:u})=>n.jsxs(he,{variant:"ghost",size:"sm",className:We("h-auto p-0 font-medium hover:bg-transparent",t===u?"text-foreground":"text-muted-foreground"),onClick:()=>i(u),children:[l,n.jsx(Uz,{className:"ml-1 h-3 w-3"})]});return e.length===0?n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsx(Mt,{className:"text-base font-medium",children:"Performance por Vendedora"})}),n.jsx(Be,{children:n.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhuma vendedora com pedidos no perodo."})})]}):n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Mt,{className:"text-base font-medium",children:"Performance por Vendedora"}),n.jsx(wp,{children:n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsx("span",{className:"text-xs text-muted-foreground cursor-help hidden sm:inline",children:" Critrios"})}),n.jsx(Aa,{side:"left",className:"max-w-xs",children:n.jsxs("div",{className:"text-xs space-y-1",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Maior Faturamento:"})," maior valor pago (R$)"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Maior Converso:"})," maior % (base mn. 3 pedidos ou R$300)"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Mais Pedidos:"})," maior quantidade de pedidos pagos"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Maior Ticket:"})," maior ticket mdio"]})]})})]})})]})}),n.jsxs(Be,{className:"pt-0",children:[n.jsx("div",{className:"hidden md:block overflow-x-auto",children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{className:"hover:bg-transparent",children:[n.jsx(jt,{className:"w-[150px]",children:"Vendedora"}),n.jsx(jt,{className:"text-right",children:"Reservados"}),n.jsx(jt,{className:"text-right",children:"Pagos"}),n.jsx(jt,{className:"text-right",children:n.jsx(d,{label:"Converso",sortKeyName:"conversao"})}),n.jsx(jt,{className:"text-right",children:n.jsx(d,{label:"Valor Pago",sortKeyName:"valorPago"})}),n.jsx(jt,{className:"text-right",children:n.jsx(d,{label:"Ticket",sortKeyName:"ticketMedio"})}),n.jsx(jt,{className:"w-[120px]",children:"Destaques"})]})}),n.jsx(Na,{children:o.map((l,u)=>n.jsxs(Qr,{children:[n.jsx(yt,{className:"font-medium",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs text-muted-foreground w-4",children:[u+1,"."]}),l.name]})}),n.jsx(yt,{className:"text-right text-muted-foreground",children:l.pedidosReservados}),n.jsx(yt,{className:"text-right",children:l.pedidosPagos}),n.jsx(yt,{className:"text-right",children:n.jsx("span",{className:We(l.conversao>=70?"text-primary font-medium":l.conversao<50?"text-amber-600":""),children:RM(l.conversao)})}),n.jsx(yt,{className:"text-right font-medium",children:qy(l.valorPago)}),n.jsx(yt,{className:"text-right",children:qy(l.ticketMedio)}),n.jsx(yt,{children:c(l.badges)})]},l.id))})]})}),n.jsx("div",{className:"md:hidden space-y-3",children:o.map((l,u)=>n.jsxs("div",{className:"p-3 rounded-lg border bg-card/50",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-xs text-muted-foreground",children:[u+1,"."]}),n.jsx("span",{className:"font-medium text-sm",children:l.name})]}),c(l.badges)]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Reservados:"}),n.jsx("span",{children:l.pedidosReservados})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Pagos:"}),n.jsx("span",{children:l.pedidosPagos})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Converso:"}),n.jsx("span",{className:We(l.conversao>=70?"text-primary font-medium":l.conversao<50?"text-amber-600":""),children:RM(l.conversao)})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{className:"text-muted-foreground",children:"Ticket:"}),n.jsx("span",{children:qy(l.ticketMedio)})]})]}),n.jsxs("div",{className:"mt-2 pt-2 border-t flex justify-between items-center",children:[n.jsx("span",{className:"text-xs text-muted-foreground",children:"Total Pago"}),n.jsx("span",{className:"font-semibold text-primary",children:qy(l.valorPago)})]})]},l.id))})]})]})}const o2e=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),l2e={aguardando_pagamento_24h:{icon:Br,getRoute:zs.aguardandoPagamento24h},aguardando_retorno_24h:{icon:f1,getRoute:zs.aguardandoRetorno24h},nao_cobrado:{icon:N_,getRoute:zs.naoCobrado},pago_sem_logistica:{icon:gn,getRoute:zs.pagoSemLogistica},etiqueta_pendente:{icon:Ut,getRoute:zs.etiquetaPendente},sem_vendedora:{icon:Oae,getRoute:zs.semVendedora},urgente:{icon:Mr,getRoute:zs.urgente}};function c2e({actions:e}){const t=fr();return e.length===0?n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(Mr,{className:"h-4 w-4 text-muted-foreground"}),"Pendncias Operacionais"]})}),n.jsx(Be,{children:n.jsx("div",{className:"text-center py-6",children:n.jsx("p",{className:"text-sm text-muted-foreground",children:" Nenhuma pendncia no momento"})})})]}):n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(Mr,{className:"h-4 w-4 text-amber-500"}),"Pendncias Operacionais"]})}),n.jsx(Be,{className:"pt-0",children:n.jsx("div",{className:"space-y-2",children:e.map(r=>{const s=l2e[r.type],a=s.icon;return n.jsxs("div",{className:We("flex items-center gap-3 p-3 rounded-lg cursor-pointer transition-colors group",r.severity==="error"?"bg-destructive/5 hover:bg-destructive/10":r.severity==="warning"?"bg-amber-50 hover:bg-amber-100":"bg-muted/50 hover:bg-muted"),onClick:()=>t(s.getRoute()),children:[n.jsx(a,{className:We("h-4 w-4 shrink-0",r.severity==="error"?"text-destructive":r.severity==="warning"?"text-amber-600":"text-muted-foreground")}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:r.title}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.count," pedido",r.count>1?"s":"","  ",o2e(r.value)]})]}),n.jsx(ps,{className:"h-4 w-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"})]},r.id)})})})]})}const d2e=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);function u2e({customers:e}){const t=fr();return e.length===0?n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(wa,{className:"h-4 w-4 text-muted-foreground"}),"Melhores Clientes"]})}),n.jsx(Be,{children:n.jsx("p",{className:"text-sm text-muted-foreground text-center py-6",children:"Nenhum cliente encontrado."})})]}):n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Mt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(wa,{className:"h-4 w-4 text-muted-foreground"}),"Melhores Clientes"]}),n.jsxs("button",{className:"text-xs text-muted-foreground hover:text-foreground transition-colors flex items-center gap-1",onClick:()=>t("/dashboard?tab=clientes"),children:["Ver todos ",n.jsx(ps,{className:"h-3 w-3"})]})]})}),n.jsx(Be,{className:"pt-0",children:n.jsx("div",{className:"space-y-3",children:e.map((r,s)=>n.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>t(`/dashboard/clientes/${r.id}`),children:[n.jsxs("span",{className:"text-xs text-muted-foreground w-4",children:[s+1,"."]}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:r.name||r.instagram_handle||"Cliente"}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[r.instagram_handle&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Zz,{className:"h-3 w-3"}),"@",r.instagram_handle.replace("@","")]}),n.jsxs("span",{children:[" ",r.totalPedidos," pedido",r.totalPedidos!==1?"s":""]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-sm font-semibold text-primary",children:d2e(r.totalGasto)}),r.ultimaCompra&&n.jsx("p",{className:"text-xs text-muted-foreground",children:y8(new Date(r.ultimaCompra),{addSuffix:!0,locale:gr})})]})]},r.id))})})]})}const h2e=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"];function f2e(){const e=fr(),[t,r]=P.useState([]),[s,a]=P.useState([]),[i,o]=P.useState([]),[c,d]=P.useState(!0);P.useEffect(()=>{l()},[]);const l=async()=>{try{const f=mn(new Date,7),{data:m}=await ce.from("orders").select("*, order_items(*)").gte("created_at",f.toISOString());if(!m)return;const p=new Map;m.forEach(b=>{const j=h2e.includes(b.status),T=b.status==="aguardando_pagamento",O=b.status==="cancelado";(b.order_items||[]).forEach(D=>{const L=D.product_name||"Unknown",q=p.get(L)||{name:D.product_name||"Unknown",sku:D.product_sku,qtySold:0,revenue:0,reservedQty:0,canceledQty:0};j&&(q.qtySold+=D.quantity||0,q.revenue+=(D.product_price||0)*(D.quantity||0)),T&&(q.reservedQty+=D.quantity||0),O&&(q.canceledQty+=D.quantity||0),p.set(L,q)})});const g=Array.from(p.values()),v=[...g].filter(b=>b.qtySold>0).sort((b,j)=>j.qtySold-b.qtySold).slice(0,5).map(b=>({name:b.name,sku:b.sku,qty:b.qtySold,revenue:b.revenue}));r(v);const x=[...g].filter(b=>b.revenue>0).sort((b,j)=>j.revenue-b.revenue).slice(0,5).map(b=>({name:b.name,sku:b.sku,qty:b.qtySold,revenue:b.revenue}));a(x);const y=[];g.forEach(b=>{const j=b.qtySold+b.reservedQty+b.canceledQty;if(j===0)return;const T=b.qtySold/j*100,O=b.canceledQty/j*100;b.reservedQty>3&&T<30&&y.push({name:b.name,type:"baixa_conversao",value:`${T.toFixed(0)}% converso, ${b.reservedQty} reservados`}),O>30&&b.canceledQty>2&&y.push({name:b.name,type:"alto_cancelamento",value:`${O.toFixed(0)}% cancelamento`})}),o(y.slice(0,5))}catch(f){console.error("Error loading BI cards:",f)}finally{d(!1)}},u=f=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(f),h=f=>{const m=new URLSearchParams;f&&m.set("sort",f),e(`/dashboard/insights?${m.toString()}`)};return c?n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(f=>n.jsx(De,{className:"animate-pulse",children:n.jsx(Be,{className:"h-48 flex items-center justify-center",children:n.jsx(At,{className:"h-6 w-6 animate-spin text-muted-foreground"})})},f))}):n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[n.jsxs(De,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>h("qty"),children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(Ut,{className:"h-4 w-4 text-blue-500"}),"Top 5 Peas (Qtd)"]})}),n.jsxs(Be,{className:"space-y-2",children:[t.length===0?n.jsx("p",{className:"text-sm text-muted-foreground",children:"Sem vendas no perodo"}):t.map((f,m)=>n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsxs("span",{className:"text-muted-foreground w-4 shrink-0",children:[m+1,"."]}),n.jsx("span",{className:"truncate",children:f.name})]}),n.jsx(Ae,{variant:"secondary",className:"shrink-0 ml-2",children:f.qty})]},m)),n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full mt-2 gap-1",children:["Ver ranking completo ",n.jsx(Dn,{className:"h-3 w-3"})]})]})]}),n.jsxs(De,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>h("revenue"),children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(ws,{className:"h-4 w-4 text-green-500"}),"Top 5 Peas (Receita)"]})}),n.jsxs(Be,{className:"space-y-2",children:[s.length===0?n.jsx("p",{className:"text-sm text-muted-foreground",children:"Sem vendas no perodo"}):s.map((f,m)=>n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsxs("span",{className:"text-muted-foreground w-4 shrink-0",children:[m+1,"."]}),n.jsx("span",{className:"truncate",children:f.name})]}),n.jsx("span",{className:"font-medium text-green-600 shrink-0 ml-2",children:u(f.revenue)})]},m)),n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full mt-2 gap-1",children:["Ver ranking completo ",n.jsx(Dn,{className:"h-3 w-3"})]})]})]}),n.jsxs(De,{className:"cursor-pointer hover:border-primary/50 transition-colors",onClick:()=>h("risk"),children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(Mr,{className:"h-4 w-4 text-amber-500"}),"Risco Operacional"]})}),n.jsxs(Be,{className:"space-y-2",children:[i.length===0?n.jsxs("div",{className:"text-center py-4",children:[n.jsx(Ae,{className:"bg-green-100 text-green-700 border-0",children:"Tudo OK"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Nenhum alerta ativo"})]}):i.map((f,m)=>n.jsxs("div",{className:"space-y-1",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsx(Ae,{variant:"outline",className:f.type==="baixa_conversao"?"border-amber-300 text-amber-700 text-[10px]":"border-red-300 text-red-700 text-[10px]",children:f.type==="baixa_conversao"?"Converso":"Cancelamento"})}),n.jsx("p",{className:"text-xs truncate",children:f.name}),n.jsx("p",{className:"text-[10px] text-muted-foreground",children:f.value})]},m)),n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full mt-2 gap-1",children:["Ver todos alertas ",n.jsx(Dn,{className:"h-3 w-3"})]})]})]}),n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(aU,{className:"h-4 w-4 text-purple-500"}),"Aes Rpidas"]})}),n.jsxs(Be,{className:"space-y-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",onClick:()=>e("/dashboard?tab=orders&status=aguardando_pagamento"),children:[n.jsx(_s,{className:"h-4 w-4 text-amber-500"}),"Cobrar reservas"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",onClick:()=>e("/dashboard?tab=products&filter=low_stock"),children:[n.jsx(Ut,{className:"h-4 w-4 text-blue-500"}),"Repor estoque"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"w-full justify-start gap-2",onClick:()=>h("risk"),children:[n.jsx(Mr,{className:"h-4 w-4 text-red-500"}),"Ver alertas"]}),n.jsxs(he,{variant:"default",size:"sm",className:"w-full justify-start gap-2 mt-2",onClick:()=>h(),children:[n.jsx(_s,{className:"h-4 w-4"}),"Centro de Inteligncia"]})]})]})]})}const K3=768;function O8(){const[e,t]=P.useState(void 0);return P.useEffect(()=>{const r=window.matchMedia(`(max-width: ${K3-1}px)`),s=()=>{t(window.innerWidth<K3)};return r.addEventListener("change",s),t(window.innerWidth<K3),()=>r.removeEventListener("change",s)},[]),!!e}function m2e(){const e=fr(),t=O8(),[r,s]=P.useState({period:"7days",channel:"all",liveEventId:null,sellerId:null}),{kpis:a,channelComparison:i,sellerPerformance:o,topCustomers:c,pendingActions:d,sellers:l,liveEvents:u,isLoading:h,refetch:f}=fwe(r),m=p=>{switch(p){case"faturamento":e(zs.faturamentoPago());break;case"reservado":e(zs.reservado());break;case"conversao":e(zs.conversao());break;case"ticket":e("/dashboard?tab=clientes");break;case"pa":e("/dashboard?tab=products");break;case"pendencias":e(zs.pendencias());break;case"pagos":e(zs.pagos());break;case"pendentes":e(zs.pendentes());break;case"cancelados":e(zs.cancelados());break}};return h?n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):a?n.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"min-w-0",children:[n.jsx("h2",{className:"text-lg sm:text-xl font-semibold truncate",children:"Viso Geral"}),n.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground hidden sm:block",children:"Dados consolidados do seu negcio"})]}),n.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[t?n.jsx(Kwe,{filters:r,onFiltersChange:s,sellers:l,liveEvents:u}):null,n.jsxs(he,{variant:"outline",size:"sm",onClick:f,className:"gap-2 h-9",children:[n.jsx(en,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Atualizar"})]})]})]}),!t&&n.jsx(gwe,{filters:r,onFiltersChange:s,sellers:l,liveEvents:u}),n.jsx(Ywe,{kpis:a,onKPIClick:m}),n.jsxs("div",{className:"mt-6",children:[n.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Inteligncia Operacional"}),n.jsx(f2e,{})]}),n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-10 gap-4 sm:gap-6",children:[n.jsxs("div",{className:"lg:col-span-7 space-y-4 sm:space-y-6",children:[i&&n.jsxs("div",{children:[n.jsx("h3",{className:"text-sm font-medium text-muted-foreground mb-2 sm:mb-3",children:"Catlogo vs Live"}),n.jsx(s2e,{data:i})]}),n.jsx(i2e,{sellers:o})]}),n.jsxs("div",{className:"lg:col-span-3 space-y-4 sm:space-y-6",children:[n.jsx("div",{id:"pending-actions",children:n.jsx(c2e,{actions:d})}),n.jsx(u2e,{customers:c})]})]})]}):n.jsxs("div",{className:"text-center py-20",children:[n.jsx("p",{className:"text-muted-foreground",children:"Erro ao carregar dados"}),n.jsx(he,{onClick:f,variant:"outline",className:"mt-4",children:"Tentar novamente"})]})}const MM=[{value:"overview",label:"Viso Geral",icon:ak},{value:"clientes",label:"Clientes",icon:nU},{value:"products",label:"Produtos",icon:Ut},{value:"orders",label:"Pedidos",icon:ln},{value:"lives",label:"Lives",icon:Ts},{value:"cupons",label:"Cupons",icon:Hh},{value:"promocoes",label:"Promoes",icon:Oa},{value:"brindes",label:"Brindes",icon:Rn},{value:"club",label:"Le.Po Club",icon:Ei},{value:"equipe",label:"Equipe",icon:hk},{value:"prints",label:"Prints",icon:sk,showCount:!0}];function p2e({activeTab:e,onTabChange:t,onLogout:r,onImportStock:s,printCount:a}){const[i,o]=P.useState(!1),c=d=>{t(d),o(!1)};return MM.find(d=>d.value===e),n.jsxs(Tu,{open:i,onOpenChange:o,children:[n.jsx(Bk,{asChild:!0,children:n.jsxs(he,{variant:"ghost",size:"icon",className:"md:hidden shrink-0",children:[n.jsx(eU,{className:"h-5 w-5"}),n.jsx("span",{className:"sr-only",children:"Menu"})]})}),n.jsxs(fd,{side:"left",className:"w-[min(92vw,320px)] p-0 overflow-hidden",children:[n.jsx(Pu,{className:"p-4 border-b shrink-0",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsx("img",{src:hd,alt:"LE.PO",className:"h-8 max-w-[120px] object-contain"}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>o(!1),className:"shrink-0",children:n.jsx(an,{className:"h-5 w-5"})})]})}),n.jsxs("nav",{className:"flex flex-col h-[calc(100vh-80px)] overflow-hidden",children:[n.jsx("div",{className:"flex-1 overflow-y-auto py-2",children:MM.map(d=>{const l=d.icon,u=e===d.value;return n.jsxs("button",{onClick:()=>c(d.value),className:We("w-full flex items-center gap-3 px-4 py-3 text-left transition-colors","hover:bg-muted/50 active:bg-muted","min-h-[48px]",u&&"bg-primary/5 text-primary border-r-2 border-primary"),children:[n.jsx(l,{className:We("h-5 w-5 shrink-0",u?"text-primary":"text-muted-foreground")}),n.jsx("span",{className:We("text-sm font-medium truncate flex-1",u&&"text-primary"),children:d.label}),d.showCount&&a>0&&n.jsx("span",{className:"shrink-0 text-xs bg-primary text-primary-foreground px-2 py-0.5 rounded-full",children:a})]},d.value)})}),n.jsxs("div",{className:"border-t p-4 space-y-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"w-full justify-start gap-2 h-11",onClick:()=>{s(),o(!1)},children:[n.jsx(sf,{className:"h-4 w-4"}),"Importar Estoque"]}),n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full justify-start gap-2 h-11 text-muted-foreground",onClick:()=>{r(),o(!1)},children:[n.jsx(ik,{className:"h-4 w-4"}),"Sair"]})]})]})]})]})}function g2e(){const{sellers:e,isLoading:t,createSeller:r,updateSeller:s,toggleSellerActive:a,loadAllSellers:i}=h8(),[o,c]=P.useState(!1),[d,l]=P.useState(null),[u,h]=P.useState({name:"",whatsapp:"",email:""}),[f,m]=P.useState(!1);P.useState(()=>{f&&i()});const p=x=>{x?(l(x),h({name:x.name,whatsapp:x.whatsapp||"",email:x.email||""})):(l(null),h({name:"",whatsapp:"",email:""})),c(!0)},g=async x=>{if(x.preventDefault(),!!u.name.trim())try{d?await s(d.id,{name:u.name,whatsapp:u.whatsapp||null,email:u.email||null}):await r({name:u.name,whatsapp:u.whatsapp||void 0,email:u.email||void 0}),c(!1),h({name:"",whatsapp:"",email:""}),l(null)}catch{}},v=f?e:e.filter(x=>x.is_active);return t?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})}):n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("h2",{className:"text-lg font-semibold",children:"Equipe de Vendas"}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>{m(!f),f||i()},children:f?"Ocultar inativos":"Mostrar inativos"})]}),n.jsxs(cn,{open:o,onOpenChange:c,children:[n.jsx(Zge,{asChild:!0,children:n.jsxs(he,{onClick:()=>p(),children:[n.jsx(An,{className:"h-4 w-4 mr-2"}),"Nova Vendedora"]})}),n.jsxs(sn,{children:[n.jsx(fn,{children:n.jsx(dn,{children:d?"Editar Vendedora":"Cadastrar Vendedora"})}),n.jsxs("form",{onSubmit:g,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"name",children:"Nome *"}),n.jsx(Qe,{id:"name",placeholder:"Nome da vendedora",value:u.name,onChange:x=>h(y=>({...y,name:x.target.value})),required:!0})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"whatsapp",children:"WhatsApp"}),n.jsx(Qe,{id:"whatsapp",placeholder:"(62) 99999-9999",value:u.whatsapp,onChange:x=>h(y=>({...y,whatsapp:x.target.value}))})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"email",children:"E-mail"}),n.jsx(Qe,{id:"email",type:"email",placeholder:"email@exemplo.com",value:u.email,onChange:x=>h(y=>({...y,email:x.target.value}))})]}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsx(he,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancelar"}),n.jsx(he,{type:"submit",children:d?"Salvar":"Cadastrar"})]})]})]})]})]}),v.length===0?n.jsx(De,{children:n.jsxs(Be,{className:"py-12 text-center text-muted-foreground",children:[n.jsx(Wn,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhuma vendedora cadastrada ainda."}),n.jsx("p",{className:"text-sm mt-1",children:'Clique em "Nova Vendedora" para comear.'})]})}):n.jsx("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:v.map(x=>n.jsx(De,{className:x.is_active?"":"opacity-60",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h3",{className:"font-medium truncate",children:x.name}),!x.is_active&&n.jsx(Ae,{variant:"secondary",className:"text-xs",children:"Inativa"})]}),x.whatsapp&&n.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-muted-foreground mt-1",children:[n.jsx(el,{className:"h-3 w-3"}),n.jsx("span",{children:x.whatsapp})]}),x.email&&n.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-muted-foreground mt-0.5",children:[n.jsx(ok,{className:"h-3 w-3"}),n.jsx("span",{className:"truncate",children:x.email})]})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsx(he,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>p(x),children:n.jsx(nc,{className:"h-4 w-4"})}),n.jsx(he,{size:"icon",variant:"ghost",className:"h-8 w-8",onClick:()=>a(x.id,!x.is_active),title:x.is_active?"Desativar":"Ativar",children:x.is_active?n.jsx(Vu,{className:"h-4 w-4 text-green-600"}):n.jsx(Uu,{className:"h-4 w-4 text-muted-foreground"})})]})]})})},x.id))})]})}function EG(){const[e,t]=P.useState([]),[r,s]=P.useState([]),[a,i]=P.useState(!0),o=P.useCallback(async()=>{try{const{data:x,error:y}=await ce.from("gifts").select("*").order("created_at",{ascending:!1});if(y)throw y;t(x||[])}catch(x){console.error("Error fetching gifts:",x),de.error("Erro ao carregar brindes")}},[]),c=P.useCallback(async()=>{try{const{data:x,error:y}=await ce.from("gift_rules").select(`
          *,
          gift:gifts(*),
          live_event:live_events(id, titulo)
        `).order("priority",{ascending:!1});if(y)throw y;s(x||[])}catch(x){console.error("Error fetching gift rules:",x),de.error("Erro ao carregar regras de brindes")}},[]),d=P.useCallback(async()=>{i(!0),await Promise.all([o(),c()]),i(!1)},[o,c]);return P.useEffect(()=>{d()},[d]),{gifts:e,rules:r,isLoading:a,fetchAll:d,fetchGifts:o,fetchRules:c,createGift:async x=>{try{const{data:y,error:b}=await ce.from("gifts").insert({name:x.name,image_url:x.image_url||null,description:x.description||null,stock_qty:x.unlimited_stock?0:x.stock_qty,unlimited_stock:x.unlimited_stock,is_active:x.is_active,start_at:x.start_at||null,end_at:x.end_at||null,require_manual_confirm:x.require_manual_confirm,cost:x.cost||null}).select().single();if(b)throw b;return de.success("Brinde criado com sucesso!"),o(),y}catch(y){return console.error("Error creating gift:",y),de.error("Erro ao criar brinde"),null}},updateGift:async(x,y)=>{try{const{error:b}=await ce.from("gifts").update({name:y.name,image_url:y.image_url,description:y.description,stock_qty:y.unlimited_stock?0:y.stock_qty,unlimited_stock:y.unlimited_stock,is_active:y.is_active,start_at:y.start_at||null,end_at:y.end_at||null,require_manual_confirm:y.require_manual_confirm,cost:y.cost}).eq("id",x);if(b)throw b;return de.success("Brinde atualizado!"),o(),!0}catch(b){return console.error("Error updating gift:",b),de.error("Erro ao atualizar brinde"),!1}},toggleGiftActive:async(x,y)=>{try{const{error:b}=await ce.from("gifts").update({is_active:!y}).eq("id",x);if(b)throw b;return t(j=>j.map(T=>T.id===x?{...T,is_active:!y}:T)),de.success(y?"Brinde desativado":"Brinde ativado"),!0}catch(b){return console.error("Error toggling gift:",b),de.error("Erro ao atualizar brinde"),!1}},deleteGift:async x=>{try{const{error:y}=await ce.from("gifts").delete().eq("id",x);if(y)throw y;return t(b=>b.filter(j=>j.id!==x)),de.success("Brinde excludo"),!0}catch(y){return console.error("Error deleting gift:",y),de.error("Erro ao excluir brinde"),!1}},createRule:async x=>{try{const{data:y,error:b}=await ce.from("gift_rules").insert({name:x.name,is_active:x.is_active,channel_scope:x.channel_scope,live_event_id:x.live_event_id||null,start_at:x.start_at||null,end_at:x.end_at||null,priority:x.priority,condition_type:x.condition_type,condition_value:x.condition_value||null,gift_id:x.gift_id,gift_qty:x.gift_qty,max_per_customer:x.max_per_customer||null,max_total_awards:x.max_total_awards||null}).select("*, gift:gifts(*), live_event:live_events(id, titulo)").single();if(b)throw b;return de.success("Regra criada com sucesso!"),c(),y}catch(y){return console.error("Error creating rule:",y),de.error("Erro ao criar regra"),null}},updateRule:async(x,y)=>{try{const{error:b}=await ce.from("gift_rules").update({name:y.name,is_active:y.is_active,channel_scope:y.channel_scope,live_event_id:y.live_event_id||null,start_at:y.start_at||null,end_at:y.end_at||null,priority:y.priority,condition_type:y.condition_type,condition_value:y.condition_value,gift_id:y.gift_id,gift_qty:y.gift_qty,max_per_customer:y.max_per_customer,max_total_awards:y.max_total_awards}).eq("id",x);if(b)throw b;return de.success("Regra atualizada!"),c(),!0}catch(b){return console.error("Error updating rule:",b),de.error("Erro ao atualizar regra"),!1}},toggleRuleActive:async(x,y)=>{try{const{error:b}=await ce.from("gift_rules").update({is_active:!y}).eq("id",x);if(b)throw b;return s(j=>j.map(T=>T.id===x?{...T,is_active:!y}:T)),de.success(y?"Regra desativada":"Regra ativada"),!0}catch(b){return console.error("Error toggling rule:",b),de.error("Erro ao atualizar regra"),!1}},deleteRule:async x=>{try{const{error:y}=await ce.from("gift_rules").delete().eq("id",x);if(y)throw y;return s(b=>b.filter(j=>j.id!==x)),de.success("Regra excluda"),!0}catch(y){return console.error("Error deleting rule:",y),de.error("Erro ao excluir regra"),!1}}}}function x2e(){const[e,t]=P.useState([]),[r,s]=P.useState(!0);return P.useEffect(()=>{(async()=>{try{const i=new Date().toISOString(),{data:o,error:c}=await ce.from("gifts").select("*").eq("is_active",!0).or(`start_at.is.null,start_at.lte.${i}`).or(`end_at.is.null,end_at.gte.${i}`).order("name");if(c)throw c;t(o||[])}catch(i){console.error("Error fetching active gifts:",i)}finally{s(!1)}})()},[]),{gifts:e,isLoading:r}}function v2e(){const{gifts:e,isLoading:t,createGift:r,updateGift:s,toggleGiftActive:a,deleteGift:i}=EG(),[o,c]=P.useState(""),[d,l]=P.useState(!1),[u,h]=P.useState(null),[f,m]=P.useState(!1),[p,g]=P.useState(!1),[v,x]=P.useState(""),[y,b]=P.useState(""),[j,T]=P.useState(""),[O,R]=P.useState(""),[D,L]=P.useState(!1),[q,X]=P.useState(!0),[H,M]=P.useState(),[F,S]=P.useState(),[E,N]=P.useState(!1),[C,k]=P.useState(""),I=()=>{x(""),b(""),T(""),R(""),L(!1),X(!0),M(void 0),S(void 0),N(!1),k(""),h(null)},U=()=>{I(),l(!0)},$=V=>{var W;h(V),x(V.name),b(V.image_url||""),T(V.description||""),R(V.stock_qty.toString()),L(V.unlimited_stock),X(V.is_active),M(V.start_at?new Date(V.start_at):void 0),S(V.end_at?new Date(V.end_at):void 0),N(V.require_manual_confirm),k(((W=V.cost)==null?void 0:W.toString())||""),l(!0)},Y=async V=>{var ee;const W=(ee=V.target.files)==null?void 0:ee[0];if(W){g(!0);try{const ie=W.name.split(".").pop(),se=`gifts/${`gift-${Date.now()}.${ie}`}`,{error:le}=await ce.storage.from("products").upload(se,W);if(le)throw le;const{data:{publicUrl:ye}}=ce.storage.from("products").getPublicUrl(se);b(ye),de.success("Imagem enviada!")}catch(ie){console.error("Error uploading image:",ie),de.error("Erro ao enviar imagem")}finally{g(!1)}}},Z=async()=>{if(!v.trim()){de.error("Preencha o nome do brinde");return}if(!D&&!O){de.error("Informe a quantidade em estoque ou marque como ilimitado");return}m(!0);const V={name:v.trim(),image_url:y||void 0,description:j||void 0,stock_qty:D?0:parseInt(O)||0,unlimited_stock:D,is_active:q,start_at:H==null?void 0:H.toISOString(),end_at:F==null?void 0:F.toISOString(),require_manual_confirm:E,cost:C?parseFloat(C):void 0};let W=!1;u?W=await s(u.id,V):W=!!await r(V),m(!1),W&&(l(!1),I())},re=async V=>{confirm("Tem certeza que deseja excluir este brinde?")&&await i(V)},G=e.filter(V=>{var W;return V.name.toLowerCase().includes(o.toLowerCase())||((W=V.sku)==null?void 0:W.toLowerCase().includes(o.toLowerCase()))}),J=V=>{if(!V.is_active)return{label:"Inativo",variant:"secondary"};const W=new Date;return V.start_at&&new Date(V.start_at)>W?{label:"Agendado",variant:"outline"}:V.end_at&&new Date(V.end_at)<W?{label:"Expirado",variant:"destructive"}:!V.unlimited_stock&&V.stock_qty<=0?{label:"Sem estoque",variant:"destructive"}:{label:"Ativo",variant:"default"}};return n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(Rn,{className:"h-5 w-5"}),"Brindes"]}),n.jsx(Ai,{children:"Cadastre brindes para regras automticas e sorteios"})]}),n.jsxs(he,{onClick:U,children:[n.jsx(An,{className:"h-4 w-4 mr-1"}),"Novo Brinde"]})]})}),n.jsxs(Be,{children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar por nome ou SKU...",value:o,onChange:V=>c(V.target.value),className:"pl-10"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Total"})]}),n.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(V=>J(V).label==="Ativo").length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Ativos"})]}),n.jsxs("div",{className:"p-3 bg-amber-50 dark:bg-amber-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:e.filter(V=>V.unlimited_stock).length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Ilimitados"})]})]}),t?n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando..."}):G.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Rn,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhum brinde encontrado"})]}):n.jsx("div",{className:"rounded-md border overflow-x-auto",children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{children:"Brinde"}),n.jsx(jt,{children:"SKU"}),n.jsx(jt,{children:"Estoque"}),n.jsx(jt,{children:"Validade"}),n.jsx(jt,{children:"Status"}),n.jsx(jt,{className:"text-right",children:"Aes"})]})}),n.jsx(Na,{children:G.map(V=>{const W=J(V);return n.jsxs(Qr,{children:[n.jsx(yt,{children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:V.image_url?n.jsx("img",{src:V.image_url,alt:V.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Rn,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:V.name}),V.description&&n.jsx("div",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:V.description})]})]})}),n.jsx(yt,{children:n.jsx("code",{className:"text-xs bg-secondary px-1 py-0.5 rounded",children:V.sku})}),n.jsx(yt,{children:V.unlimited_stock?n.jsxs("span",{className:"flex items-center gap-1 text-muted-foreground",children:[n.jsx(hae,{className:"h-3 w-3"})," Ilimitado"]}):n.jsxs("span",{className:V.stock_qty<=0?"text-destructive":"",children:[V.stock_qty," un"]})}),n.jsx(yt,{children:n.jsxs("div",{className:"text-sm",children:[V.start_at&&n.jsxs("div",{children:["De: ",Ht(new Date(V.start_at),"dd/MM/yy",{locale:gr})]}),V.end_at&&n.jsxs("div",{children:["At: ",Ht(new Date(V.end_at),"dd/MM/yy",{locale:gr})]}),!V.start_at&&!V.end_at&&n.jsx("span",{className:"text-muted-foreground",children:"Sem limite"})]})}),n.jsx(yt,{children:n.jsx(Ae,{variant:W.variant,children:W.label})}),n.jsx(yt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>$(V),children:n.jsx(ea,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>a(V.id,V.is_active),title:V.is_active?"Desativar":"Ativar",children:V.is_active?n.jsx(Vu,{className:"h-4 w-4 text-green-600"}):n.jsx(Uu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>re(V.id),children:n.jsx(mi,{className:"h-4 w-4 text-destructive"})})]})})]},V.id)})})]})})]}),n.jsx(cn,{open:d,onOpenChange:l,children:n.jsxs(sn,{className:"sm:max-w-lg p-0 max-h-[85vh] flex flex-col overflow-hidden",children:[n.jsx(fn,{className:"px-6 py-4 border-b shrink-0",children:n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(Rn,{className:"h-5 w-5"}),u?"Editar Brinde":"Novo Brinde"]})}),n.jsxs("div",{className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Nome do Brinde *"}),n.jsx(Qe,{placeholder:"Ex: Brinco Semijoia",value:v,onChange:V=>x(V.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Foto"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Qe,{placeholder:"URL da imagem ou envie",value:y,onChange:V=>b(V.target.value),className:"flex-1"}),n.jsx(he,{variant:"outline",size:"icon",asChild:!0,disabled:p,children:n.jsxs("label",{className:"cursor-pointer",children:[n.jsx(Gh,{className:"h-4 w-4"}),n.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:Y})]})})]}),y&&n.jsx("div",{className:"w-20 h-20 rounded overflow-hidden border",children:n.jsx("img",{src:y,alt:"Preview",className:"w-full h-full object-cover"})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Descrio (opcional)"}),n.jsx(Yn,{placeholder:"Breve descrio do brinde",value:j,onChange:V=>T(V.target.value),rows:2})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Estoque"}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(va,{id:"unlimited",checked:D,onCheckedChange:V=>L(!!V)}),n.jsx("label",{htmlFor:"unlimited",className:"text-sm cursor-pointer",children:"Ilimitado"})]}),!D&&n.jsx(Qe,{type:"number",min:"0",placeholder:"Quantidade",value:O,onChange:V=>R(V.target.value),className:"w-32"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Data de Incio"}),n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("w-full justify-start text-left font-normal",!H&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),H?Ht(H,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Za,{className:"w-auto p-0 z-50",align:"start",children:n.jsx(Ti,{mode:"single",selected:H,onSelect:M,locale:gr,initialFocus:!0})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Data de Fim"}),n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("w-full justify-start text-left font-normal",!F&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),F?Ht(F,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Za,{className:"w-auto p-0 z-50",align:"start",children:n.jsx(Ti,{mode:"single",selected:F,onSelect:S,locale:gr,initialFocus:!0})})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Custo (interno, opcional)"}),n.jsx(Qe,{type:"number",min:"0",step:"0.01",placeholder:"R$ 0,00",value:C,onChange:V=>k(V.target.value)})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(va,{id:"active",checked:q,onCheckedChange:V=>X(!!V)}),n.jsx("label",{htmlFor:"active",className:"text-sm cursor-pointer",children:"Brinde ativo"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(va,{id:"confirm",checked:E,onCheckedChange:V=>N(!!V)}),n.jsx("label",{htmlFor:"confirm",className:"text-sm cursor-pointer",children:"Requer confirmao manual na separao"})]})]})]}),n.jsxs(Da,{className:"px-6 py-4 border-t shrink-0",children:[n.jsx(he,{variant:"outline",onClick:()=>l(!1),children:"Cancelar"}),n.jsx(he,{onClick:Z,disabled:f,children:f?"Salvando...":u?"Salvar":"Criar Brinde"})]})]})})]})}const y2e={catalog_only:"Apenas Catlogo",live_only:"Apenas Lives",both:"Catlogo e Lives",live_specific:"Live Especfica"},b2e={all_purchases:"Todas as compras",min_value:"Valor mnimo",first_n_paid:"Primeiros N pagos",first_n_reserved:"Primeiros N reservados"},w2e={all_purchases:ln,min_value:ws,first_n_paid:xs,first_n_reserved:wa};function _2e(){const{rules:e,isLoading:t,createRule:r,updateRule:s,toggleRuleActive:a,deleteRule:i}=EG(),{gifts:o}=x2e(),[c,d]=P.useState([]),[l,u]=P.useState(""),[h,f]=P.useState(!1),[m,p]=P.useState(null),[g,v]=P.useState(!1),[x,y]=P.useState(""),[b,j]=P.useState(!0),[T,O]=P.useState("both"),[R,D]=P.useState(""),[L,q]=P.useState(),[X,H]=P.useState(),[M,F]=P.useState("0"),[S,E]=P.useState("all_purchases"),[N,C]=P.useState(""),[k,I]=P.useState(""),[U,$]=P.useState("1"),[Y,Z]=P.useState("1"),[re,G]=P.useState("");P.useEffect(()=>{(async()=>{const{data:pe}=await ce.from("live_events").select("id, titulo, status").in("status",["planejada","ao_vivo"]).order("data_hora_inicio",{ascending:!1});d(pe||[])})()},[]);const J=()=>{y(""),j(!0),O("both"),D(""),q(void 0),H(void 0),F("0"),E("all_purchases"),C(""),I(""),$("1"),Z("1"),G(""),p(null)},V=()=>{J(),f(!0)},W=ne=>{var pe,ge,Ne;p(ne),y(ne.name),j(ne.is_active),O(ne.channel_scope),D(ne.live_event_id||""),q(ne.start_at?new Date(ne.start_at):void 0),H(ne.end_at?new Date(ne.end_at):void 0),F(ne.priority.toString()),E(ne.condition_type),C(((pe=ne.condition_value)==null?void 0:pe.toString())||""),I(ne.gift_id),$(ne.gift_qty.toString()),Z(((ge=ne.max_per_customer)==null?void 0:ge.toString())||"1"),G(((Ne=ne.max_total_awards)==null?void 0:Ne.toString())||""),f(!0)},ee=async()=>{if(!x.trim()){de.error("Preencha o nome da regra");return}if(!k){de.error("Selecione um brinde");return}if(T==="live_specific"&&!R){de.error("Selecione uma live");return}if((S==="min_value"||S==="first_n_paid"||S==="first_n_reserved")&&!N){de.error("Informe o valor da condio");return}v(!0);const ne={name:x.trim(),is_active:b,channel_scope:T,live_event_id:T==="live_specific"?R:void 0,start_at:L==null?void 0:L.toISOString(),end_at:X==null?void 0:X.toISOString(),priority:parseInt(M)||0,condition_type:S,condition_value:N?parseFloat(N):void 0,gift_id:k,gift_qty:parseInt(U)||1,max_per_customer:Y?parseInt(Y):void 0,max_total_awards:re?parseInt(re):void 0};let pe=!1;m?pe=await s(m.id,ne):pe=!!await r(ne),v(!1),pe&&(f(!1),J())},ie=async ne=>{confirm("Tem certeza que deseja excluir esta regra?")&&await i(ne)},oe=e.filter(ne=>{var pe;return ne.name.toLowerCase().includes(l.toLowerCase())||((pe=ne.gift)==null?void 0:pe.name.toLowerCase().includes(l.toLowerCase()))}),se=ne=>{if(!ne.is_active)return{label:"Inativa",variant:"secondary"};if(ne.gift&&!ne.gift.unlimited_stock&&ne.gift.stock_qty<ne.gift_qty)return{label:"Sem Estoque",variant:"destructive",description:`Requer ${ne.gift_qty}, disp: ${ne.gift.stock_qty}`};const pe=new Date;return ne.start_at&&new Date(ne.start_at)>pe?{label:"Agendada",variant:"outline"}:ne.end_at&&new Date(ne.end_at)<pe?{label:"Expirada",variant:"destructive"}:ne.max_total_awards&&ne.current_awards_count>=ne.max_total_awards?{label:"Esgotada",variant:"destructive"}:{label:"Ativa",variant:"default"}},le=o.find(ne=>ne.id===k),ye=le&&!le.unlimited_stock&&le.stock_qty<(parseInt(U)||1),ue=S==="min_value"||S==="first_n_paid"||S==="first_n_reserved";return n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(cx,{className:"h-5 w-5"}),"Regras de Brindes"]}),n.jsx(Ai,{children:"Configure regras automticas para aplicar brindes"})]}),n.jsxs(he,{onClick:V,children:[n.jsx(An,{className:"h-4 w-4 mr-1"}),"Nova Regra"]})]})}),n.jsxs(Be,{children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar regras...",value:l,onChange:ne=>u(ne.target.value),className:"pl-10"})]}),t?n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando..."}):oe.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(cx,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhuma regra encontrada"})]}):n.jsx("div",{className:"rounded-md border overflow-x-auto",children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{children:"Regra"}),n.jsx(jt,{children:"Brinde"}),n.jsx(jt,{children:"Condio"}),n.jsx(jt,{children:"Canal"}),n.jsx(jt,{children:"Aplicaes"}),n.jsx(jt,{children:"Status"}),n.jsx(jt,{className:"text-right",children:"Aes"})]})}),n.jsx(Na,{children:oe.map(ne=>{var Ne,_e;const pe=se(ne),ge=w2e[ne.condition_type];return n.jsxs(Qr,{children:[n.jsxs(yt,{children:[n.jsx("div",{className:"font-medium",children:ne.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Prioridade: ",ne.priority]})]}),n.jsx(yt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 bg-secondary rounded overflow-hidden shrink-0",children:(Ne=ne.gift)!=null&&Ne.image_url?n.jsx("img",{src:ne.gift.image_url,alt:"",className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Rn,{className:"h-3 w-3 text-muted-foreground"})})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm",children:((_e=ne.gift)==null?void 0:_e.name)||""}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["x",ne.gift_qty]}),ne.gift&&!ne.gift.unlimited_stock&&n.jsxs("div",{className:We("text-[10px]",ne.gift.stock_qty<ne.gift_qty?"text-destructive font-medium":"text-muted-foreground"),children:["Estoque: ",ne.gift.stock_qty]})]})]})}),n.jsxs(yt,{children:[n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx(ge,{className:"h-3.5 w-3.5 text-muted-foreground"}),n.jsx("span",{className:"text-sm",children:b2e[ne.condition_type]})]}),ne.condition_value&&n.jsx("div",{className:"text-xs text-muted-foreground mt-0.5",children:ne.condition_type==="min_value"?`R$ ${ne.condition_value.toFixed(2)}`:`${ne.condition_value}`})]}),n.jsxs(yt,{children:[n.jsx("div",{className:"text-sm",children:y2e[ne.channel_scope]}),ne.live_event&&n.jsx("div",{className:"text-xs text-muted-foreground truncate max-w-[120px]",children:ne.live_event.titulo})]}),n.jsx(yt,{children:n.jsxs("div",{className:"text-sm",children:[ne.current_awards_count,ne.max_total_awards&&` / ${ne.max_total_awards}`]})}),n.jsx(yt,{children:n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsx(Ae,{variant:pe.variant,children:pe.label}),pe.description&&n.jsx("span",{className:"text-[10px] text-destructive font-medium whitespace-nowrap",children:pe.description})]})}),n.jsx(yt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>W(ne),children:n.jsx(ea,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>a(ne.id,ne.is_active),children:ne.is_active?n.jsx(Vu,{className:"h-4 w-4 text-green-600"}):n.jsx(Uu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>ie(ne.id),children:n.jsx(mi,{className:"h-4 w-4 text-destructive"})})]})})]},ne.id)})})]})})]}),n.jsx(cn,{open:h,onOpenChange:f,children:n.jsxs(sn,{className:"sm:max-w-lg p-0 max-h-[85vh] flex flex-col overflow-hidden",children:[n.jsx(fn,{className:"px-6 py-4 border-b shrink-0",children:n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(cx,{className:"h-5 w-5"}),m?"Editar Regra":"Nova Regra"]})}),n.jsxs("div",{className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Nome da Regra *"}),n.jsx(Qe,{placeholder:"Ex: Brinde acima de R$ 400",value:x,onChange:ne=>y(ne.target.value)})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{className:"col-span-2 space-y-2",children:[n.jsx(Le,{children:"Brinde *"}),n.jsxs(Kt,{value:k,onValueChange:I,children:[n.jsx(Vt,{className:We(ye&&"border-destructive text-destructive"),children:n.jsx(Xt,{placeholder:"Selecione"})}),n.jsx(qt,{className:"bg-background z-50",children:o.map(ne=>n.jsx(ze,{value:ne.id,children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Rn,{className:"h-3 w-3"}),ne.name,!ne.unlimited_stock&&n.jsxs("span",{className:We("text-xs ml-1",ne.stock_qty<(parseInt(U)||1)?"text-destructive":"text-muted-foreground"),children:["(Estoque: ",ne.stock_qty,")"]})]})},ne.id))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Qtd"}),n.jsx(Qe,{type:"number",min:"1",value:U,onChange:ne=>$(ne.target.value),className:We(ye&&"border-destructive text-destructive")})]})]}),ye&&le&&n.jsxs("div",{className:"text-sm bg-destructive/10 text-destructive p-3 rounded-md flex gap-2 items-start mt-0",children:[n.jsx(Cn,{className:"h-4 w-4 mt-0.5 shrink-0"}),n.jsxs("div",{className:"flex flex-col gap-1",children:[n.jsx("p",{className:"font-medium",children:"Ateno: Estoque Insuficiente"}),n.jsxs("p",{className:"text-xs opacity-90",children:["Voc est configurando para dar ",n.jsx("strong",{children:U})," unidades, mas s h ",n.jsx("strong",{children:le.stock_qty})," em estoque."]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Aplicar em"}),n.jsxs(Kt,{value:T,onValueChange:ne=>O(ne),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsxs(qt,{className:"bg-background z-50",children:[n.jsx(ze,{value:"both",children:"Catlogo e Lives"}),n.jsx(ze,{value:"catalog_only",children:"Apenas Catlogo"}),n.jsx(ze,{value:"live_only",children:"Apenas Lives"}),n.jsx(ze,{value:"live_specific",children:"Live Especfica"})]})]})]}),T==="live_specific"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Live *"}),n.jsxs(Kt,{value:R,onValueChange:D,children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecione a live"})}),n.jsx(qt,{className:"bg-background z-50",children:c.map(ne=>n.jsx(ze,{value:ne.id,children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Ts,{className:"h-3 w-3"}),ne.titulo]})},ne.id))})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Condio"}),n.jsxs(Kt,{value:S,onValueChange:ne=>E(ne),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsxs(qt,{className:"bg-background z-50",children:[n.jsx(ze,{value:"all_purchases",children:"Todas as compras"}),n.jsx(ze,{value:"min_value",children:"Valor mnimo"}),n.jsx(ze,{value:"first_n_paid",children:"Primeiros N pagos"}),n.jsx(ze,{value:"first_n_reserved",children:"Primeiros N reservados"})]})]})]}),ue&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:S==="min_value"?"Valor (R$)":"Quantidade"}),n.jsx(Qe,{type:"number",min:"1",step:S==="min_value"?"0.01":"1",value:N,onChange:ne=>C(ne.target.value),placeholder:S==="min_value"?"400.00":"10"})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Por cliente"}),n.jsx(Qe,{type:"number",min:"1",value:Y,onChange:ne=>Z(ne.target.value),placeholder:"1"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Total mximo"}),n.jsx(Qe,{type:"number",min:"1",value:re,onChange:ne=>G(ne.target.value),placeholder:"Ilimitado"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Prioridade"}),n.jsx(Qe,{type:"number",value:M,onChange:ne=>F(ne.target.value),placeholder:"0"})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Data de Incio"}),n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("w-full justify-start text-left font-normal",!L&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),L?Ht(L,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Za,{className:"w-auto p-0 z-50",align:"start",children:n.jsx(Ti,{mode:"single",selected:L,onSelect:q,locale:gr,initialFocus:!0})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Data de Fim"}),n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("w-full justify-start text-left font-normal",!X&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),X?Ht(X,"dd/MM/yy"):"Selecionar"]})}),n.jsx(Za,{className:"w-auto p-0 z-50",align:"start",children:n.jsx(Ti,{mode:"single",selected:X,onSelect:H,locale:gr,initialFocus:!0})})]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(va,{id:"ruleActive",checked:b,onCheckedChange:ne=>j(!!ne)}),n.jsx("label",{htmlFor:"ruleActive",className:"text-sm cursor-pointer",children:"Regra ativa"})]})]}),n.jsxs(Da,{className:"px-6 py-4 border-t shrink-0",children:[n.jsx(he,{variant:"outline",onClick:()=>f(!1),children:"Cancelar"}),n.jsx(he,{onClick:ee,disabled:g,children:g?"Salvando...":m?"Salvar":"Criar Regra"})]})]})})]})}function j2e(){return n.jsxs(pi,{defaultValue:"gifts",className:"space-y-4",children:[n.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:n.jsxs(Qa,{className:"inline-flex w-max sm:w-auto",children:[n.jsxs(pr,{value:"gifts",className:"gap-2 min-h-[44px] px-4",children:[n.jsx(Rn,{className:"h-4 w-4"}),n.jsx("span",{children:"Brindes"})]}),n.jsxs(pr,{value:"rules",className:"gap-2 min-h-[44px] px-4",children:[n.jsx(cx,{className:"h-4 w-4"}),n.jsx("span",{children:"Regras"})]})]})}),n.jsx(wr,{value:"gifts",children:n.jsx(v2e,{})}),n.jsx(wr,{value:"rules",children:n.jsx(_2e,{})})]})}var aj="Switch",[N2e,get]=ta(aj),[S2e,C2e]=N2e(aj),kG=P.forwardRef((e,t)=>{const{__scopeSwitch:r,name:s,checked:a,defaultChecked:i,required:o,disabled:c,value:d="on",onCheckedChange:l,form:u,...h}=e,[f,m]=P.useState(null),p=Ir(t,b=>m(b)),g=P.useRef(!1),v=f?u||!!f.closest("form"):!0,[x,y]=Yi({prop:a,defaultProp:i??!1,onChange:l,caller:aj});return n.jsxs(S2e,{scope:r,checked:x,disabled:c,children:[n.jsx(er.button,{type:"button",role:"switch","aria-checked":x,"aria-required":o,"data-state":OG(x),"data-disabled":c?"":void 0,disabled:c,value:d,...h,ref:p,onClick:kt(e.onClick,b=>{y(j=>!j),v&&(g.current=b.isPropagationStopped(),g.current||b.stopPropagation())})}),v&&n.jsx(PG,{control:f,bubbles:!g.current,name:s,value:d,checked:x,required:o,disabled:c,form:u,style:{transform:"translateX(-100%)"}})]})});kG.displayName=aj;var AG="SwitchThumb",TG=P.forwardRef((e,t)=>{const{__scopeSwitch:r,...s}=e,a=C2e(AG,r);return n.jsx(er.span,{"data-state":OG(a.checked),"data-disabled":a.disabled?"":void 0,...s,ref:t})});TG.displayName=AG;var E2e="SwitchBubbleInput",PG=P.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:s=!0,...a},i)=>{const o=P.useRef(null),c=Ir(o,i),d=H_(r),l=k_(t);return P.useEffect(()=>{const u=o.current;if(!u)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(d!==r&&m){const p=new Event("click",{bubbles:s});m.call(u,r),u.dispatchEvent(p)}},[d,r,s]),n.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:c,style:{...a.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});PG.displayName=E2e;function OG(e){return e?"checked":"unchecked"}var RG=kG,k2e=TG;const di=P.forwardRef(({className:e,...t},r)=>n.jsx(RG,{className:We("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",e),...t,ref:r,children:n.jsx(k2e,{className:We("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));di.displayName=RG.displayName;function A2e(){const[e,t]=P.useState([]),[r,s]=P.useState([]),[a,i]=P.useState([]),[o,c]=P.useState(null),[d,l]=P.useState(null),[u,h]=P.useState(null),[f,m]=P.useState(!0),p=P.useCallback(async()=>{m(!0);try{await Promise.all([g(),v(),x(),y(),b()])}finally{m(!1)}},[]),g=async()=>{const{data:M,error:F}=await ce.from("loyalty_tiers").select("*").order("display_order",{ascending:!0});!F&&M&&t(M.map(S=>({id:S.id,name:S.name,slug:S.slug,minPoints:S.min_points,maxPoints:S.max_points,multiplier:Number(S.multiplier),benefits:S.benefits,badgeColor:S.badge_color||"#8B7355",displayOrder:S.display_order,isActive:S.is_active})))},v=async()=>{const{data:M,error:F}=await ce.from("loyalty_campaigns").select("*").order("priority",{ascending:!1});!F&&M&&s(M.map(S=>({id:S.id,name:S.name,description:S.description,campaignType:S.campaign_type,multiplierValue:Number(S.multiplier_value),bonusPoints:S.bonus_points,giftId:S.gift_id,minOrderValue:S.min_order_value?Number(S.min_order_value):null,applicableTiers:S.applicable_tiers||[],channelScope:S.channel_scope,categoryFilter:S.category_filter,skuFilter:S.sku_filter,priority:S.priority,maxUsesPerCustomer:S.max_uses_per_customer,maxTotalUses:S.max_total_uses,currentUses:S.current_uses,startAt:S.start_at,endAt:S.end_at,isActive:S.is_active})))},x=async()=>{const{data:M,error:F}=await ce.from("loyalty_missions").select("*").order("display_order",{ascending:!0});!F&&M&&i(M.map(S=>({id:S.id,missionKey:S.mission_key,title:S.title,subtitle:S.subtitle,emoji:S.emoji||"",description:S.description,pointsReward:S.points_reward,missionType:S.mission_type,questionsJson:S.questions_json||[],maxPhotos:S.max_photos||5,isRepeatable:S.is_repeatable,repeatIntervalDays:S.repeat_interval_days,prerequisiteMissionId:S.prerequisite_mission_id,minTier:S.min_tier||"poa",displayOrder:S.display_order,isActive:S.is_active,isPublished:S.is_published})))},y=async()=>{const{data:M}=await ce.from("loyalty_settings").select("setting_value").eq("setting_key","general").single(),{data:F}=await ce.from("loyalty_settings").select("setting_value").eq("setting_key","messages").single();if(M!=null&&M.setting_value){const S=M.setting_value;c({enabled:S.enabled??!0,pointsPerReal:S.points_per_real??1,pointsExpiryMonths:S.points_expiry_months??12,weeklyMissionLimit:S.weekly_mission_limit??300})}if(F!=null&&F.setting_value){const S=F.setting_value;l({welcome:S.welcome??"",levelUp:S.level_up??"",pointsEarned:S.points_earned??"",pointsExpiring:S.points_expiring??""})}},b=async()=>{const{data:M}=await ce.from("point_transactions").select("points, type, expired");let F=0,S=0,E=0;(M||[]).forEach($=>{$.points>0&&!$.expired&&(F+=$.points),$.type==="redemption"&&(S+=Math.abs($.points)),$.expired&&(E+=$.points)});const{count:N}=await ce.from("customer_loyalty").select("*",{count:"exact",head:!0}),{data:C}=await ce.from("customer_loyalty").select("current_tier"),k={};(C||[]).forEach($=>{k[$.current_tier]=(k[$.current_tier]||0)+1});const{data:I}=await ce.from("reward_redemptions").select("reward_id, loyalty_rewards(name)").limit(100),U={};(I||[]).forEach($=>{var Z;const Y=((Z=$.loyalty_rewards)==null?void 0:Z.name)||"Unknown";U[$.reward_id]||(U[$.reward_id]={name:Y,count:0}),U[$.reward_id].count++}),h({pointsEarned:F,pointsRedeemed:S,pointsExpired:E,activeUsers:N||0,topRewards:Object.values(U).sort(($,Y)=>Y.count-$.count).slice(0,5).map($=>({name:$.name,redemptions:$.count})),tierDistribution:Object.entries(k).map(([$,Y])=>({tier:$,count:Y}))})},j=async M=>{const F={name:M.name,slug:M.slug,min_points:M.minPoints,max_points:M.maxPoints,multiplier:M.multiplier,benefits:M.benefits,badge_color:M.badgeColor,display_order:M.displayOrder,is_active:M.isActive};if(M.id){const{error:S}=await ce.from("loyalty_tiers").update(F).eq("id",M.id);if(S)throw S}else{const{error:S}=await ce.from("loyalty_tiers").insert(F);if(S)throw S}await g()},T=async M=>{const{error:F}=await ce.from("loyalty_tiers").delete().eq("id",M);if(F)throw F;await g()},O=async M=>{const F={name:M.name,description:M.description,campaign_type:M.campaignType,multiplier_value:M.multiplierValue,bonus_points:M.bonusPoints,gift_id:M.giftId,min_order_value:M.minOrderValue,applicable_tiers:M.applicableTiers,channel_scope:M.channelScope,category_filter:M.categoryFilter,sku_filter:M.skuFilter,priority:M.priority,max_uses_per_customer:M.maxUsesPerCustomer,max_total_uses:M.maxTotalUses,start_at:M.startAt,end_at:M.endAt,is_active:M.isActive};if(M.id){const{error:S}=await ce.from("loyalty_campaigns").update(F).eq("id",M.id);if(S)throw S}else{const{error:S}=await ce.from("loyalty_campaigns").insert(F);if(S)throw S}await v()},R=async M=>{const{error:F}=await ce.from("loyalty_campaigns").delete().eq("id",M);if(F)throw F;await v()},D=async M=>{const F={mission_key:M.missionKey,title:M.title,subtitle:M.subtitle,emoji:M.emoji,description:M.description,points_reward:M.pointsReward,mission_type:M.missionType,questions_json:M.questionsJson,max_photos:M.maxPhotos,is_repeatable:M.isRepeatable,repeat_interval_days:M.repeatIntervalDays,prerequisite_mission_id:M.prerequisiteMissionId,min_tier:M.minTier,display_order:M.displayOrder,is_active:M.isActive,is_published:M.isPublished};if(M.id){const{error:S}=await ce.from("loyalty_missions").update(F).eq("id",M.id);if(S)throw S}else{const{error:S}=await ce.from("loyalty_missions").insert(F);if(S)throw S}await x()},L=async M=>{const{error:F}=await ce.from("loyalty_missions").delete().eq("id",M);if(F)throw F;await x()},q=async M=>{const{error:F}=await ce.from("loyalty_settings").update({setting_value:{enabled:M.enabled,points_per_real:M.pointsPerReal,points_expiry_months:M.pointsExpiryMonths,weekly_mission_limit:M.weeklyMissionLimit}}).eq("setting_key","general");if(F)throw F;c(M)},X=async M=>{const{error:F}=await ce.from("loyalty_settings").update({setting_value:{welcome:M.welcome,level_up:M.levelUp,points_earned:M.pointsEarned,points_expiring:M.pointsExpiring}}).eq("setting_key","messages");if(F)throw F;l(M)},H=async(M,F,S,E)=>{const{error:N}=await ce.from("point_transactions").insert({user_id:M,type:F>0?"earn":"redemption",points:F,description:`Ajuste manual: ${S}`});if(N)throw N;const{data:C}=await ce.from("customer_loyalty").select("current_points").eq("user_id",M).single();C&&await ce.from("customer_loyalty").update({current_points:C.current_points+F,lifetime_points:F>0?C.current_points+F:void 0}).eq("user_id",M)};return P.useEffect(()=>{p()},[p]),{tiers:e,campaigns:r,missions:a,settings:o,messages:d,reportData:u,isLoading:f,fetchAll:p,saveTier:j,deleteTier:T,saveCampaign:O,deleteCampaign:R,saveMission:D,deleteMission:L,saveSettings:q,saveMessages:X,adjustPoints:H}}const X3=[{value:"discount_fixed",label:"Desconto fixo (R$)",icon:jo},{value:"discount_percentage",label:"Desconto (%)",icon:jo},{value:"free_shipping",label:"Frete grtis",icon:gn},{value:"gift",label:"Brinde fsico",icon:Rn},{value:"vip_access",label:"Acesso VIP",icon:Ei}],Y3=[{value:"catalog",label:"Apenas Catlogo"},{value:"live",label:"Apenas Lives"},{value:"both",label:"Catlogo e Lives"}];function T2e({onBack:e}){const[t,r]=P.useState([]),[s,a]=P.useState([]),[i,o]=P.useState(!0),[c,d]=P.useState(""),[l,u]=P.useState("all"),[h,f]=P.useState(!1),[m,p]=P.useState(null),[g,v]=P.useState(!1),[x,y]=P.useState({name:"",description:"",type:"discount_fixed",points_cost:1e3,discount_value:30,min_tier:"poa",min_order_value:0,channel:"catalog",max_per_customer:1,stock_qty:null,unlimited_stock:!0,is_active:!0,is_featured:!1}),b=P.useCallback(async()=>{o(!0);try{const[M,F]=await Promise.all([ce.from("loyalty_rewards").select("*").order("points_cost",{ascending:!0}),ce.from("loyalty_tiers").select("id, slug, name").eq("is_active",!0).order("display_order")]);M.data&&r(M.data),F.data&&a(F.data)}catch(M){console.error("Error fetching data:",M),de.error("Erro ao carregar dados")}finally{o(!1)}},[]);P.useEffect(()=>{b()},[b]);const j=()=>{y({name:"",description:"",type:"discount_fixed",points_cost:1e3,discount_value:30,min_tier:"poa",min_order_value:0,channel:"catalog",max_per_customer:1,stock_qty:null,unlimited_stock:!0,is_active:!0,is_featured:!1}),p(null)},T=()=>{j(),f(!0)},O=M=>{p(M),y({name:M.name,description:M.description||"",type:M.type,points_cost:M.points_cost,discount_value:M.discount_value||0,min_tier:M.min_tier,min_order_value:M.min_order_value||0,channel:M.channel||"catalog",max_per_customer:M.max_per_customer||1,stock_qty:M.stock_qty,unlimited_stock:M.unlimited_stock,is_active:M.is_active,is_featured:M.is_featured}),f(!0)},R=async()=>{if(!x.name.trim()){de.error("Nome  obrigatrio");return}if(x.points_cost<=0){de.error("Custo em pontos deve ser maior que zero");return}v(!0);try{const M={name:x.name.trim(),description:x.description||null,type:x.type,points_cost:x.points_cost,discount_value:x.discount_value||null,min_tier:x.min_tier,min_order_value:x.min_order_value||null,channel:x.channel,max_per_customer:x.max_per_customer,stock_qty:x.unlimited_stock?null:x.stock_qty,unlimited_stock:x.unlimited_stock,is_active:x.is_active,is_featured:x.is_featured};if(m){const{error:F}=await ce.from("loyalty_rewards").update(M).eq("id",m.id);if(F)throw F;de.success("Recompensa atualizada!")}else{const{error:F}=await ce.from("loyalty_rewards").insert(M);if(F)throw F;de.success("Recompensa criada!")}f(!1),j(),b()}catch(M){console.error("Error saving reward:",M),de.error(M.message||"Erro ao salvar")}finally{v(!1)}},D=async(M,F)=>{try{const{error:S}=await ce.from("loyalty_rewards").update({is_active:!F}).eq("id",M);if(S)throw S;b()}catch{de.error("Erro ao alterar status")}},L=async M=>{if(confirm("Tem certeza que deseja excluir esta recompensa?"))try{const{error:F}=await ce.from("loyalty_rewards").delete().eq("id",M);if(F)throw F;de.success("Recompensa excluda"),b()}catch{de.error("Erro ao excluir")}},q=t.filter(M=>{const F=M.name.toLowerCase().includes(c.toLowerCase()),S=l==="all"||M.channel===l;return F&&S}),X=M=>{const F=X3.find(S=>S.value===M);return(F==null?void 0:F.icon)||Rn},H=M=>{var F;return((F=s.find(S=>S.slug===M))==null?void 0:F.name)||M};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:e,children:n.jsx(vs,{className:"h-5 w-5"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h2",{className:"text-xl font-serif",children:"Recompensas por Pontos"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Catlogo de itens que clientes podem resgatar com Pos"})]}),n.jsxs(he,{onClick:T,children:[n.jsx(An,{className:"h-4 w-4 mr-1"}),"Nova Recompensa"]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar recompensas...",value:c,onChange:M=>d(M.target.value),className:"pl-10"})]}),n.jsxs(Kt,{value:l,onValueChange:u,children:[n.jsx(Vt,{className:"w-[180px]",children:n.jsx(Xt,{placeholder:"Canal"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos os canais"}),Y3.map(M=>n.jsx(ze,{value:M.value,children:M.label},M.value))]})]})]}),n.jsx(De,{children:n.jsx(Be,{className:"p-0",children:i?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(At,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):q.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(Rn,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhuma recompensa encontrada"})]}):n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{children:"Recompensa"}),n.jsx(jt,{children:"Tipo"}),n.jsx(jt,{children:"Pontos"}),n.jsx(jt,{children:"Canal"}),n.jsx(jt,{children:"Nvel mn."}),n.jsx(jt,{children:"Resgates"}),n.jsx(jt,{children:"Status"}),n.jsx(jt,{className:"text-right",children:"Aes"})]})}),n.jsx(Na,{children:q.map(M=>{var S,E;const F=X(M.type);return n.jsxs(Qr,{children:[n.jsx(yt,{children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-muted rounded-lg flex items-center justify-center",children:n.jsx(F,{className:"h-5 w-5 text-muted-foreground"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"font-medium flex items-center gap-2",children:[M.name,M.is_featured&&n.jsx(ki,{className:"h-3 w-3 text-amber-500 fill-amber-500"})]}),M.description&&n.jsx("div",{className:"text-xs text-muted-foreground truncate max-w-[200px]",children:M.description})]})]})}),n.jsx(yt,{children:n.jsx(Ae,{variant:"outline",children:((S=X3.find(N=>N.value===M.type))==null?void 0:S.label)||M.type})}),n.jsxs(yt,{children:[n.jsx("span",{className:"font-medium",children:M.points_cost}),n.jsx("span",{className:"text-muted-foreground text-xs ml-1",children:"pts"})]}),n.jsx(yt,{children:((E=Y3.find(N=>N.value===M.channel))==null?void 0:E.label)||M.channel}),n.jsx(yt,{children:H(M.min_tier)}),n.jsxs(yt,{children:[M.current_redemptions,!M.unlimited_stock&&M.stock_qty!==null&&n.jsxs("span",{className:"text-muted-foreground",children:["/",M.stock_qty]})]}),n.jsx(yt,{children:n.jsx(Ae,{variant:M.is_active?"default":"secondary",children:M.is_active?"Ativo":"Inativo"})}),n.jsx(yt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>O(M),children:n.jsx(ea,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>D(M.id,M.is_active),children:M.is_active?n.jsx(Vu,{className:"h-4 w-4 text-green-600"}):n.jsx(Uu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>L(M.id),children:n.jsx(mi,{className:"h-4 w-4 text-destructive"})})]})})]},M.id)})})]})})}),n.jsx(cn,{open:h,onOpenChange:f,children:n.jsxs(sn,{className:"sm:max-w-lg max-h-[85vh] flex flex-col overflow-hidden",children:[n.jsx(fn,{children:n.jsx(dn,{children:m?"Editar Recompensa":"Nova Recompensa"})}),n.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 py-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Nome *"}),n.jsx(Qe,{value:x.name,onChange:M=>y({...x,name:M.target.value}),placeholder:"Ex: Cupom R$ 30"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Descrio"}),n.jsx(Yn,{value:x.description,onChange:M=>y({...x,description:M.target.value}),placeholder:"Descrio curta da recompensa"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Tipo"}),n.jsxs(Kt,{value:x.type,onValueChange:M=>y({...x,type:M}),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsx(qt,{children:X3.map(M=>n.jsx(ze,{value:M.value,children:M.label},M.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Custo em Pontos *"}),n.jsx(Qe,{type:"number",value:x.points_cost,onChange:M=>y({...x,points_cost:Number(M.target.value)})})]})]}),(x.type==="discount_fixed"||x.type==="discount_percentage"||x.type==="free_shipping")&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{children:["Valor do desconto ",x.type==="discount_percentage"?"(%)":"(R$)"]}),n.jsx(Qe,{type:"number",value:x.discount_value,onChange:M=>y({...x,discount_value:Number(M.target.value)})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Canal"}),n.jsxs(Kt,{value:x.channel,onValueChange:M=>y({...x,channel:M}),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsx(qt,{children:Y3.map(M=>n.jsx(ze,{value:M.value,children:M.label},M.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Nvel mnimo"}),n.jsxs(Kt,{value:x.min_tier,onValueChange:M=>y({...x,min_tier:M}),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsx(qt,{children:s.map(M=>n.jsx(ze,{value:M.slug,children:M.name},M.slug))})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Valor mn. do pedido (R$)"}),n.jsx(Qe,{type:"number",value:x.min_order_value,onChange:M=>y({...x,min_order_value:Number(M.target.value)})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Mx. por cliente (30 dias)"}),n.jsx(Qe,{type:"number",value:x.max_per_customer,onChange:M=>y({...x,max_per_customer:Number(M.target.value)})})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(di,{checked:x.unlimited_stock,onCheckedChange:M=>y({...x,unlimited_stock:M})}),n.jsx(Le,{children:"Estoque ilimitado"})]}),!x.unlimited_stock&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Quantidade em estoque"}),n.jsx(Qe,{type:"number",value:x.stock_qty||"",onChange:M=>y({...x,stock_qty:Number(M.target.value)||null})})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(di,{checked:x.is_featured,onCheckedChange:M=>y({...x,is_featured:M})}),n.jsx(Le,{children:"Destaque (aparece primeiro)"})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(di,{checked:x.is_active,onCheckedChange:M=>y({...x,is_active:M})}),n.jsx(Le,{children:"Ativo"})]})]})]}),n.jsxs(Da,{children:[n.jsx(he,{variant:"outline",onClick:()=>f(!1),children:"Cancelar"}),n.jsxs(he,{onClick:R,disabled:g,children:[g&&n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}),"Salvar"]})]})]})})]})}const Z3=[{value:"catalog_only",label:"Apenas Catlogo"},{value:"live_only",label:"Apenas Lives"},{value:"both",label:"Catlogo e Lives"}],IM=[{value:"all_purchases",label:"Todas as compras"},{value:"min_value",label:"Valor mnimo"},{value:"first_n_paid",label:"Primeiros N pagos"}];function P2e({onBack:e}){const[t,r]=P.useState([]),[s,a]=P.useState([]),[i,o]=P.useState([]),[c,d]=P.useState(!0),[l,u]=P.useState(""),[h,f]=P.useState("all"),[m,p]=P.useState(!1),[g,v]=P.useState(null),[x,y]=P.useState(!1),[b,j]=P.useState({name:"",channel_scope:"both",condition_type:"min_value",condition_value:300,gift_id:"",gift_qty:1,max_per_customer:1,max_total_awards:null,priority:0,start_at:null,end_at:null,is_active:!0}),T=P.useCallback(async()=>{d(!0);try{const[S,E,N]=await Promise.all([ce.from("gift_rules").select("*, gift:gifts(name, image_url)").order("priority",{ascending:!1}),ce.from("gifts").select("id, name, image_url").eq("is_active",!0).order("name"),ce.from("loyalty_tiers").select("slug, name").eq("is_active",!0).order("display_order")]);S.data&&r(S.data),E.data&&a(E.data),N.data&&o(N.data)}catch(S){console.error("Error fetching data:",S),de.error("Erro ao carregar dados")}finally{d(!1)}},[]);P.useEffect(()=>{T()},[T]);const O=()=>{j({name:"",channel_scope:"both",condition_type:"min_value",condition_value:300,gift_id:"",gift_qty:1,max_per_customer:1,max_total_awards:null,priority:0,start_at:null,end_at:null,is_active:!0}),v(null)},R=()=>{O(),p(!0)},D=S=>{v(S),j({name:S.name,channel_scope:S.channel_scope,condition_type:S.condition_type,condition_value:S.condition_value||0,gift_id:S.gift_id,gift_qty:S.gift_qty,max_per_customer:S.max_per_customer||1,max_total_awards:S.max_total_awards,priority:S.priority,start_at:S.start_at?new Date(S.start_at):null,end_at:S.end_at?new Date(S.end_at):null,is_active:S.is_active}),p(!0)},L=async()=>{var S,E;if(!b.name.trim()){de.error("Nome  obrigatrio");return}if(!b.gift_id){de.error("Selecione um brinde");return}if(b.condition_type==="min_value"&&(!b.condition_value||b.condition_value<=0)){de.error("Valor mnimo deve ser maior que zero");return}y(!0);try{const N={name:b.name.trim(),channel_scope:b.channel_scope,condition_type:b.condition_type,condition_value:b.condition_value||null,gift_id:b.gift_id,gift_qty:b.gift_qty,max_per_customer:b.max_per_customer,max_total_awards:b.max_total_awards,priority:b.priority,start_at:((S=b.start_at)==null?void 0:S.toISOString())||null,end_at:((E=b.end_at)==null?void 0:E.toISOString())||null,is_active:b.is_active};if(g){const{error:C}=await ce.from("gift_rules").update(N).eq("id",g.id);if(C)throw C;de.success("Regra atualizada!")}else{const{error:C}=await ce.from("gift_rules").insert(N);if(C)throw C;de.success("Regra criada!")}p(!1),O(),T()}catch(N){console.error("Error saving rule:",N),de.error(N.message||"Erro ao salvar")}finally{y(!1)}},q=async(S,E)=>{try{const{error:N}=await ce.from("gift_rules").update({is_active:!E}).eq("id",S);if(N)throw N;T()}catch{de.error("Erro ao alterar status")}},X=async S=>{if(confirm("Tem certeza que deseja excluir esta regra?"))try{const{error:E}=await ce.from("gift_rules").delete().eq("id",S);if(E)throw E;de.success("Regra excluda"),T()}catch{de.error("Erro ao excluir")}},H=t.filter(S=>{const E=S.name.toLowerCase().includes(l.toLowerCase()),N=h==="all"||S.channel_scope===h;return E&&N}),M=S=>{if(!S.is_active)return{label:"Inativa",variant:"secondary"};const E=new Date;return S.start_at&&new Date(S.start_at)>E?{label:"Agendada",variant:"outline"}:S.end_at&&new Date(S.end_at)<E?{label:"Expirada",variant:"destructive"}:S.max_total_awards&&S.current_awards_count>=S.max_total_awards?{label:"Esgotada",variant:"destructive"}:{label:"Ativa",variant:"default"}},F=b.condition_type==="min_value"||b.condition_type==="first_n_paid";return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:e,children:n.jsx(vs,{className:"h-5 w-5"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h2",{className:"text-xl font-serif",children:"Brindes Automticos"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Regras para adicionar brindes automaticamente ao carrinho"})]}),n.jsxs(he,{onClick:R,children:[n.jsx(An,{className:"h-4 w-4 mr-1"}),"Nova Regra"]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar regras...",value:l,onChange:S=>u(S.target.value),className:"pl-10"})]}),n.jsxs(Kt,{value:h,onValueChange:f,children:[n.jsx(Vt,{className:"w-[180px]",children:n.jsx(Xt,{placeholder:"Canal"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos os canais"}),Z3.map(S=>n.jsx(ze,{value:S.value,children:S.label},S.value))]})]})]}),n.jsx(De,{children:n.jsx(Be,{className:"p-0",children:c?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(At,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):H.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(cx,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhuma regra encontrada"})]}):n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{children:"Regra"}),n.jsx(jt,{children:"Brinde"}),n.jsx(jt,{children:"Condio"}),n.jsx(jt,{children:"Canal"}),n.jsx(jt,{children:"Aplicaes"}),n.jsx(jt,{children:"Status"}),n.jsx(jt,{className:"text-right",children:"Aes"})]})}),n.jsx(Na,{children:H.map(S=>{var N,C,k,I;const E=M(S);return n.jsxs(Qr,{children:[n.jsxs(yt,{children:[n.jsx("div",{className:"font-medium",children:S.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Prioridade: ",S.priority]})]}),n.jsx(yt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 bg-secondary rounded overflow-hidden shrink-0",children:(N=S.gift)!=null&&N.image_url?n.jsx("img",{src:S.gift.image_url,alt:"",className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Rn,{className:"h-3 w-3 text-muted-foreground"})})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm",children:((C=S.gift)==null?void 0:C.name)||""}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["x",S.gift_qty]})]})]})}),n.jsxs(yt,{children:[n.jsx("div",{className:"text-sm",children:(k=IM.find(U=>U.value===S.condition_type))==null?void 0:k.label}),S.condition_value&&n.jsx("div",{className:"text-xs text-muted-foreground",children:S.condition_type==="min_value"?`R$ ${S.condition_value.toFixed(2)}`:S.condition_value})]}),n.jsx(yt,{children:((I=Z3.find(U=>U.value===S.channel_scope))==null?void 0:I.label)||S.channel_scope}),n.jsxs(yt,{children:[S.current_awards_count,S.max_total_awards&&` / ${S.max_total_awards}`]}),n.jsx(yt,{children:n.jsx(Ae,{variant:E.variant,children:E.label})}),n.jsx(yt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>D(S),children:n.jsx(ea,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>q(S.id,S.is_active),children:S.is_active?n.jsx(Vu,{className:"h-4 w-4 text-green-600"}):n.jsx(Uu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>X(S.id),children:n.jsx(mi,{className:"h-4 w-4 text-destructive"})})]})})]},S.id)})})]})})}),n.jsx(cn,{open:m,onOpenChange:p,children:n.jsxs(sn,{className:"sm:max-w-lg max-h-[85vh] flex flex-col overflow-hidden",children:[n.jsx(fn,{children:n.jsx(dn,{children:g?"Editar Regra":"Nova Regra de Brinde"})}),n.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 py-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Nome da Regra *"}),n.jsx(Qe,{value:b.name,onChange:S=>j({...b,name:S.target.value}),placeholder:"Ex: Brinde acima de R$ 400"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{className:"col-span-2 space-y-2",children:[n.jsx(Le,{children:"Brinde *"}),n.jsxs(Kt,{value:b.gift_id,onValueChange:S=>j({...b,gift_id:S}),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecione"})}),n.jsx(qt,{children:s.map(S=>n.jsx(ze,{value:S.id,children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Rn,{className:"h-3 w-3"}),S.name]})},S.id))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Qtd"}),n.jsx(Qe,{type:"number",min:"1",value:b.gift_qty,onChange:S=>j({...b,gift_qty:Number(S.target.value)||1})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Aplicar em"}),n.jsxs(Kt,{value:b.channel_scope,onValueChange:S=>j({...b,channel_scope:S}),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsx(qt,{children:Z3.map(S=>n.jsx(ze,{value:S.value,children:S.label},S.value))})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Condio"}),n.jsxs(Kt,{value:b.condition_type,onValueChange:S=>j({...b,condition_type:S}),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsx(qt,{children:IM.map(S=>n.jsx(ze,{value:S.value,children:S.label},S.value))})]})]}),F&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:b.condition_type==="min_value"?"Valor mnimo (R$)":"Quantidade"}),n.jsx(Qe,{type:"number",value:b.condition_value,onChange:S=>j({...b,condition_value:Number(S.target.value)})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Mx. por cliente"}),n.jsx(Qe,{type:"number",value:b.max_per_customer,onChange:S=>j({...b,max_per_customer:Number(S.target.value)||1})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Mx. total (vazio = ilimitado)"}),n.jsx(Qe,{type:"number",value:b.max_total_awards||"",onChange:S=>j({...b,max_total_awards:S.target.value?Number(S.target.value):null}),placeholder:"Ilimitado"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Prioridade (maior = preferncia)"}),n.jsx(Qe,{type:"number",value:b.priority,onChange:S=>j({...b,priority:Number(S.target.value)})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Incio"}),n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("w-full justify-start text-left font-normal",!b.start_at&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),b.start_at?Ht(b.start_at,"dd/MM/yyyy",{locale:gr}):"Imediato"]})}),n.jsx(Za,{className:"w-auto p-0",children:n.jsx(Ti,{mode:"single",selected:b.start_at||void 0,onSelect:S=>j({...b,start_at:S||null}),locale:gr})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Fim"}),n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("w-full justify-start text-left font-normal",!b.end_at&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),b.end_at?Ht(b.end_at,"dd/MM/yyyy",{locale:gr}):"Sem limite"]})}),n.jsx(Za,{className:"w-auto p-0",children:n.jsx(Ti,{mode:"single",selected:b.end_at||void 0,onSelect:S=>j({...b,end_at:S||null}),locale:gr})})]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(di,{checked:b.is_active,onCheckedChange:S=>j({...b,is_active:S})}),n.jsx(Le,{children:"Regra ativa"})]})]}),n.jsxs(Da,{children:[n.jsx(he,{variant:"outline",onClick:()=>p(!1),children:"Cancelar"}),n.jsxs(he,{onClick:L,disabled:x,children:[x&&n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}),"Salvar"]})]})]})})]})}function O2e(){const[e,t]=P.useState([]),[r,s]=P.useState(!0),[a,i]=P.useState(new Date().getMonth()+1),[o,c]=P.useState("all"),d=P.useCallback(async()=>{s(!0);try{const{data:m,error:p}=await ce.rpc("get_birthday_members_of_month",{p_month:a});p?(console.error("Error fetching birthday members:",p),t([])):t((m||[]).map(g=>{var v;return{userId:g.user_id,email:g.user_email,name:g.user_name||((v=g.user_email)==null?void 0:v.split("@")[0])||"",birthDate:g.birth_date,whatsapp:g.whatsapp,tier:g.tier||"poa",discountPercent:g.discount_percent,couponCode:g.coupon_code,notifiedAt:g.notified_at,renotifiedAt:g.renotified_at,usedAt:g.used_at,orderId:g.order_id,discountId:g.discount_id}}))}catch(m){console.error("Birthday admin error:",m)}finally{s(!1)}},[a]);P.useEffect(()=>{d()},[d]);const l=P.useCallback(async(m,p=!1)=>{const{error:g}=await ce.rpc("mark_birthday_notified",{p_discount_id:m,p_is_renotify:p});if(g)throw g;await d()},[d]),u=P.useCallback(async m=>{const{data:p,error:g}=await ce.rpc("get_or_create_birthday_discount",{p_user_id:m});if(g)throw g;return await d(),p==null?void 0:p[0]},[d]),h=e.filter(m=>o==="all"?!0:o==="not_notified"?!m.notifiedAt&&!m.usedAt:o==="notified_not_used"?m.notifiedAt&&!m.usedAt:o==="used"?!!m.usedAt:o==="renotified"?!!m.renotifiedAt&&!m.usedAt:!0),f={total:e.length,notNotified:e.filter(m=>!m.notifiedAt&&!m.usedAt).length,notifiedNotUsed:e.filter(m=>m.notifiedAt&&!m.usedAt).length,used:e.filter(m=>!!m.usedAt).length};return{members:h,allMembers:e,isLoading:r,selectedMonth:a,setSelectedMonth:i,statusFilter:o,setStatusFilter:c,stats:f,markNotified:l,ensureDiscount:u,refetch:d}}const R2e={poa:5,poa_gold:10,poa_platinum:15,poa_black:20},DM=["","Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],LM={poa:"Po",poa_gold:"Gold",poa_platinum:"Platinum",poa_black:"Black"};function M2e(){const{members:e,allMembers:t,isLoading:r,selectedMonth:s,setSelectedMonth:a,statusFilter:i,setStatusFilter:o,stats:c,markNotified:d,ensureDiscount:l,refetch:u}=O2e(),[h,f]=P.useState(null),m=async y=>{f(y.userId);try{let b=y.discountId,j=y.couponCode,T=y.discountPercent;if(!b){const D=await l(y.userId);D&&(b=D.discount_id,j=D.coupon_code,T=D.discount_percent)}b&&await d(b,!1);const O=y.name.split(" ")[0],R=encodeURIComponent(`Ol ${O}! 

Feliz aniversrio! Como membro ${LM[y.tier]||"Po"} do Le.Po Club, preparamos um presente especial para voc:

 ${T||R2e[y.tier]}% de desconto na sua prxima compra este ms!

Use o cupom: *${j||""}*

Vlido at o final do ms. Aproveite! `);if(y.whatsapp){const L=`https://wa.me/55${y.whatsapp.replace(/\D/g,"")}?text=${R}`;window.open(L,"_blank")}else await navigator.clipboard.writeText(decodeURIComponent(R)),de.info("Sem WhatsApp cadastrado. Mensagem copiada para a rea de transferncia.");de.success(`${O} marcada como notificada`)}catch(b){console.error("Error notifying:",b),de.error("Erro ao notificar")}finally{f(null)}},p=async y=>{if(y.discountId){f(y.userId);try{await d(y.discountId,!0);const b=y.name.split(" ")[0],j=g(),T=encodeURIComponent(`Oi ${b}! 

Lembrete: seu desconto de aniversrio de ${y.discountPercent}% ainda est ativo!

Faltam apenas ${j} dias para usar. No perca essa oportunidade!

Cupom: *${y.couponCode}*

Acesse: seuprovador.com.br`);if(y.whatsapp){const O=y.whatsapp.replace(/\D/g,"");window.open(`https://wa.me/55${O}?text=${T}`,"_blank")}else await navigator.clipboard.writeText(decodeURIComponent(T)),de.info("Mensagem copiada para a rea de transferncia.");de.success(`Reaviso enviado para ${b}`)}catch{de.error("Erro ao reenviar")}finally{f(null)}}};function g(){const y=new Date;return new Date(y.getFullYear(),y.getMonth()+1,0).getDate()-y.getDate()}function v(y){return y.usedAt?n.jsx(Ae,{variant:"default",className:"bg-green-600 text-white",children:"Usou desconto"}):y.renotifiedAt?n.jsx(Ae,{variant:"outline",className:"border-amber-500 text-amber-600",children:"Reavisada"}):y.notifiedAt?n.jsx(Ae,{variant:"outline",className:"border-blue-500 text-blue-600",children:"Notificada"}):y.discountId?n.jsx(Ae,{variant:"outline",className:"border-gray-400 text-gray-500",children:"No notificada"}):n.jsx(Ae,{variant:"outline",className:"border-gray-300 text-gray-400",children:"Sem desconto"})}const x=s===new Date().getMonth()+1;return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs(Kt,{value:String(s),onValueChange:y=>a(Number(y)),children:[n.jsx(Vt,{className:"w-[160px]",children:n.jsx(Xt,{})}),n.jsx(qt,{children:DM.slice(1).map((y,b)=>n.jsx(ze,{value:String(b+1),children:y},b+1))})]}),n.jsx(he,{variant:"ghost",size:"icon",onClick:u,disabled:r,children:n.jsx(en,{className:`h-4 w-4 ${r?"animate-spin":""}`})})]}),n.jsxs(Kt,{value:i,onValueChange:y=>o(y),children:[n.jsxs(Vt,{className:"w-[200px]",children:[n.jsx(wd,{className:"h-4 w-4 mr-2"}),n.jsx(Xt,{})]}),n.jsxs(qt,{children:[n.jsxs(ze,{value:"all",children:["Todas (",c.total,")"]}),n.jsxs(ze,{value:"not_notified",children:["No notificadas (",c.notNotified,")"]}),n.jsxs(ze,{value:"notified_not_used",children:["Notificadas s/ uso (",c.notifiedNotUsed,")"]}),n.jsxs(ze,{value:"used",children:["Usaram desconto (",c.used,")"]})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[n.jsx(De,{children:n.jsxs(Be,{className:"p-4 text-center",children:[n.jsx(fw,{className:"h-5 w-5 mx-auto mb-1 text-pink-500"}),n.jsx("div",{className:"text-2xl font-bold",children:c.total}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Aniversariantes"})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4 text-center",children:[n.jsx(Cn,{className:"h-5 w-5 mx-auto mb-1 text-gray-400"}),n.jsx("div",{className:"text-2xl font-bold",children:c.notNotified}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"No notificadas"})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4 text-center",children:[n.jsx(Br,{className:"h-5 w-5 mx-auto mb-1 text-blue-500"}),n.jsx("div",{className:"text-2xl font-bold",children:c.notifiedNotUsed}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Sem uso"})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4 text-center",children:[n.jsx(pn,{className:"h-5 w-5 mx-auto mb-1 text-green-500"}),n.jsx("div",{className:"text-2xl font-bold",children:c.used}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Usaram"})]})})]}),r?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(fw,{className:"h-12 w-12 mx-auto mb-3 opacity-30"}),n.jsxs("p",{children:["Nenhuma aniversariante ",i!=="all"?"com esse filtro ":"","em ",DM[s]]})]}):n.jsx("div",{className:"space-y-3",children:e.map(y=>n.jsx(De,{className:"overflow-hidden",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"font-medium truncate",children:y.name}),v(y)]}),n.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-xs text-muted-foreground",children:[n.jsx("span",{children:new Date(y.birthDate+"T12:00:00").toLocaleDateString("pt-BR",{day:"numeric",month:"long"})}),n.jsx("span",{className:"font-medium",children:LM[y.tier]||"Po"}),y.discountPercent&&n.jsxs("span",{className:"text-green-600 font-medium",children:[y.discountPercent,"% off"]}),y.couponCode&&n.jsx("span",{className:"font-mono text-[10px] bg-muted px-1.5 py-0.5 rounded",children:y.couponCode})]}),n.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-[10px] text-muted-foreground mt-2",children:[y.notifiedAt&&n.jsxs("span",{children:["Notificada: ",new Date(y.notifiedAt).toLocaleDateString("pt-BR")]}),y.renotifiedAt&&n.jsxs("span",{children:["Reaviso: ",new Date(y.renotifiedAt).toLocaleDateString("pt-BR")]}),y.usedAt&&n.jsxs("span",{className:"text-green-600",children:["Usou: ",new Date(y.usedAt).toLocaleDateString("pt-BR")]})]})]}),n.jsx("div",{className:"flex gap-2 shrink-0",children:!y.usedAt&&n.jsx(n.Fragment,{children:y.notifiedAt?y.renotifiedAt?n.jsx("span",{className:"text-xs text-muted-foreground italic",children:"J reavisada"}):n.jsxs(he,{size:"sm",variant:"outline",onClick:()=>p(y),disabled:h===y.userId,className:"gap-1.5",children:[h===y.userId?n.jsx(At,{className:"h-3.5 w-3.5 animate-spin"}):n.jsx(en,{className:"h-3.5 w-3.5"}),"Reaviso"]}):n.jsxs(he,{size:"sm",onClick:()=>m(y),disabled:h===y.userId,className:"gap-1.5",children:[h===y.userId?n.jsx(At,{className:"h-3.5 w-3.5 animate-spin"}):n.jsx(N_,{className:"h-3.5 w-3.5"}),"Enviar mensagem"]})})})]})})},y.userId))}),!r&&x&&c.total>0&&n.jsx("div",{className:"bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg p-3",children:n.jsxs("p",{className:"text-xs text-amber-700 dark:text-amber-300",children:[n.jsx("strong",{children:"Dica:"}),' Prximo ao final do ms, use o boto "Reaviso" para lembrar as clientes que ainda no usaram o desconto de aniversrio. Faltam'," ",n.jsxs("strong",{children:[g()," dias"]})," para encerrar as promoes deste ms."]})})]})}function I2e(){const{tiers:e,campaigns:t,missions:r,settings:s,messages:a,reportData:i,isLoading:o,saveTier:c,deleteTier:d,saveCampaign:l,deleteCampaign:u,saveMission:h,deleteMission:f,saveSettings:m,saveMessages:p}=A2e(),[g,v]=P.useState("config");return o?n.jsx("div",{className:"flex items-center justify-center py-20",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):n.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[n.jsxs("div",{children:[n.jsx("h2",{className:"text-xl sm:text-2xl font-serif",children:"Le.Po Club"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Programa de fidelidade e gamificao"})]}),s&&n.jsxs(Ae,{variant:s.enabled?"default":"secondary",className:"gap-1 w-fit",children:[s.enabled?n.jsx(Vu,{className:"h-3 w-3"}):n.jsx(Uu,{className:"h-3 w-3"}),s.enabled?"Ativo":"Inativo"]})]}),n.jsxs(pi,{value:g,onValueChange:v,children:[n.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:n.jsxs(Qa,{className:"inline-flex w-max sm:grid sm:grid-cols-7 sm:w-full bg-muted/50 p-1",children:[n.jsxs(pr,{value:"config",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(dk,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Config"})]}),n.jsxs(pr,{value:"tiers",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(qz,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Nveis"})]}),n.jsxs(pr,{value:"campaigns",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(Jz,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Campanhas"})]}),n.jsxs(pr,{value:"rewards",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(Rn,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Recompensas"})]}),n.jsxs(pr,{value:"missions",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(ba,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Misses"})]}),n.jsxs(pr,{value:"birthdays",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(fw,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Aniversrios"})]}),n.jsxs(pr,{value:"reports",className:"gap-1.5 sm:gap-2 px-3 sm:px-4 min-h-[40px]",children:[n.jsx(Pl,{className:"h-4 w-4"}),n.jsx("span",{className:"text-xs sm:text-sm",children:"Relatrios"})]})]})}),n.jsx(wr,{value:"config",className:"space-y-4 sm:space-y-6",children:n.jsx(D2e,{settings:s,messages:a,onSaveSettings:m,onSaveMessages:p})}),n.jsx(wr,{value:"tiers",className:"space-y-4 sm:space-y-6",children:n.jsx(L2e,{tiers:e,onSave:c,onDelete:d})}),n.jsx(wr,{value:"campaigns",className:"space-y-4 sm:space-y-6",children:n.jsx(B2e,{campaigns:t,tiers:e,onSave:l,onDelete:u})}),n.jsx(wr,{value:"rewards",className:"space-y-4 sm:space-y-6",children:n.jsx($2e,{tiers:e})}),n.jsx(wr,{value:"missions",className:"space-y-4 sm:space-y-6",children:n.jsx(F2e,{missions:r,tiers:e,onSave:h,onDelete:f})}),n.jsx(wr,{value:"reports",className:"space-y-4 sm:space-y-6",children:n.jsx(z2e,{data:i,tiers:e})}),n.jsx(wr,{value:"birthdays",className:"space-y-4 sm:space-y-6",children:n.jsx(M2e,{})})]})]})}function D2e({settings:e,messages:t,onSaveSettings:r,onSaveMessages:s}){const[a,i]=P.useState(e),[o,c]=P.useState(t),[d,l]=P.useState(!1),u=async()=>{l(!0);try{await r(a),await s(o),de.success("Configuraes salvas!")}catch{de.error("Erro ao salvar")}finally{l(!1)}};return a?n.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[n.jsxs(De,{children:[n.jsxs(Ot,{children:[n.jsx(Mt,{children:"Configuraes Gerais"}),n.jsx(Ai,{children:"Regras do programa de pontos"})]}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Le,{htmlFor:"enabled",children:"Programa ativo"}),n.jsx(di,{id:"enabled",checked:a.enabled,onCheckedChange:h=>i({...a,enabled:h})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Pontos por R$ pago"}),n.jsx(Qe,{type:"number",value:a.pointsPerReal,onChange:h=>i({...a,pointsPerReal:Number(h.target.value)})}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Pontos creditados somente quando o pedido for PAGO"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Expirao de pontos (meses)"}),n.jsx(Qe,{type:"number",value:a.pointsExpiryMonths,onChange:h=>i({...a,pointsExpiryMonths:Number(h.target.value)})}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Pontos expiram aps este perodo (FIFO)"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Limite semanal de misses (pontos)"}),n.jsx(Qe,{type:"number",value:a.weeklyMissionLimit,onChange:h=>i({...a,weeklyMissionLimit:Number(h.target.value)})})]}),n.jsx("div",{className:"pt-4 border-t",children:n.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[n.jsx("strong",{children:"Regra de estorno:"})," Se pedido for CANCELADO/ESTORNADO, os pontos so automaticamente removidos."]})})]})]}),n.jsxs(De,{children:[n.jsxs(Ot,{children:[n.jsx(Mt,{children:"Mensagens do Club"}),n.jsx(Ai,{children:"Textos exibidos para os clientes"})]}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Boas-vindas"}),n.jsx(Yn,{value:(o==null?void 0:o.welcome)||"",onChange:h=>c({...o,welcome:h.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Subiu de nvel"}),n.jsx(Yn,{value:(o==null?void 0:o.levelUp)||"",onChange:h=>c({...o,levelUp:h.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{children:["Ganhou pontos (use ","{points}",")"]}),n.jsx(Yn,{value:(o==null?void 0:o.pointsEarned)||"",onChange:h=>c({...o,pointsEarned:h.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{children:["Pontos expirando (use ","{days}",")"]}),n.jsx(Yn,{value:(o==null?void 0:o.pointsExpiring)||"",onChange:h=>c({...o,pointsExpiring:h.target.value})})]})]})]}),n.jsx("div",{className:"md:col-span-2",children:n.jsxs(he,{onClick:u,disabled:d,className:"w-full sm:w-auto",children:[d?n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}):null,"Salvar Configuraes"]})})]}):null}function L2e({tiers:e,onSave:t,onDelete:r}){const[s,a]=P.useState(null),[i,o]=P.useState(!1),c=async()=>{if(!(s!=null&&s.name)||!(s!=null&&s.slug)){de.error("Nome e slug so obrigatrios");return}o(!0);try{await t(s),a(null),de.success("Nvel salvo!")}catch{de.error("Erro ao salvar")}finally{o(!1)}};return n.jsxs(De,{children:[n.jsxs(Ot,{className:"flex flex-row items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(Mt,{children:"Nveis do Club"}),n.jsx(Ai,{children:"Configure os tiers de fidelidade"})]}),n.jsxs(he,{onClick:()=>a({isActive:!0,multiplier:1,displayOrder:e.length}),size:"sm",children:[n.jsx(An,{className:"h-4 w-4 mr-1"})," Novo Nvel"]})]}),n.jsx(Be,{children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{children:"Ordem"}),n.jsx(jt,{children:"Nome"}),n.jsx(jt,{children:"Pontos"}),n.jsx(jt,{children:"Multiplicador"}),n.jsx(jt,{children:"Status"}),n.jsx(jt,{className:"text-right",children:"Aes"})]})}),n.jsx(Na,{children:e.map(d=>n.jsxs(Qr,{children:[n.jsx(yt,{children:d.displayOrder}),n.jsx(yt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:d.badgeColor}}),n.jsx("span",{className:"font-medium",children:d.name})]})}),n.jsxs(yt,{children:[d.minPoints.toLocaleString()," - ",d.maxPoints?d.maxPoints.toLocaleString():""]}),n.jsxs(yt,{children:[d.multiplier,"x"]}),n.jsx(yt,{children:n.jsx(Ae,{variant:d.isActive?"default":"secondary",children:d.isActive?"Ativo":"Inativo"})}),n.jsxs(yt,{className:"text-right",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>a(d),children:n.jsx(ea,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>r(d.id),children:n.jsx(mi,{className:"h-4 w-4 text-destructive"})})]})]},d.id))})]})}),n.jsx(cn,{open:!!s,onOpenChange:d=>!d&&a(null),children:n.jsxs(sn,{children:[n.jsx(fn,{children:n.jsx(dn,{children:s!=null&&s.id?"Editar Nvel":"Novo Nvel"})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Nome"}),n.jsx(Qe,{value:(s==null?void 0:s.name)||"",onChange:d=>a({...s,name:d.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Slug"}),n.jsx(Qe,{value:(s==null?void 0:s.slug)||"",onChange:d=>a({...s,slug:d.target.value})})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Pontos mnimos"}),n.jsx(Qe,{type:"number",value:(s==null?void 0:s.minPoints)||0,onChange:d=>a({...s,minPoints:Number(d.target.value)})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Pontos mximos"}),n.jsx(Qe,{type:"number",value:(s==null?void 0:s.maxPoints)||"",onChange:d=>a({...s,maxPoints:d.target.value?Number(d.target.value):null}),placeholder:""})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Multiplicador"}),n.jsx(Qe,{type:"number",step:"0.1",value:(s==null?void 0:s.multiplier)||1,onChange:d=>a({...s,multiplier:Number(d.target.value)})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Cor do badge"}),n.jsx(Qe,{type:"color",value:(s==null?void 0:s.badgeColor)||"#8B7355",onChange:d=>a({...s,badgeColor:d.target.value})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Benefcios"}),n.jsx(Yn,{value:(s==null?void 0:s.benefits)||"",onChange:d=>a({...s,benefits:d.target.value})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(di,{checked:(s==null?void 0:s.isActive)??!0,onCheckedChange:d=>a({...s,isActive:d})}),n.jsx(Le,{children:"Ativo"})]})]}),n.jsxs(Da,{children:[n.jsx(he,{variant:"outline",onClick:()=>a(null),children:"Cancelar"}),n.jsxs(he,{onClick:c,disabled:i,children:[i&&n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}),"Salvar"]})]})]})})]})}function B2e({campaigns:e,tiers:t,onSave:r,onDelete:s}){var u,h;const[a,i]=P.useState(null),[o,c]=P.useState(!1),d=async()=>{if(!(a!=null&&a.name)){de.error("Nome  obrigatrio");return}c(!0);try{await r(a),i(null),de.success("Campanha salva!")}catch{de.error("Erro ao salvar")}finally{c(!1)}},l=[{value:"multiplier",label:"Multiplicador de pontos"},{value:"bonus_points",label:"Pontos bnus"},{value:"auto_gift",label:"Brinde automtico"},{value:"mission_bonus",label:"Misso bnus"}];return n.jsxs(De,{children:[n.jsxs(Ot,{className:"flex flex-row items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(Mt,{children:"Campanhas"}),n.jsx(Ai,{children:"Promoes e multiplicadores temporrios"})]}),n.jsxs(he,{onClick:()=>i({isActive:!0,campaignType:"multiplier",multiplierValue:2,channelScope:"both",applicableTiers:["poa","poa_gold","poa_platinum","atelier"],priority:0}),size:"sm",children:[n.jsx(An,{className:"h-4 w-4 mr-1"})," Nova Campanha"]})]}),n.jsx(Be,{children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{children:"Nome"}),n.jsx(jt,{children:"Tipo"}),n.jsx(jt,{children:"Canal"}),n.jsx(jt,{children:"Perodo"}),n.jsx(jt,{children:"Status"}),n.jsx(jt,{className:"text-right",children:"Aes"})]})}),n.jsx(Na,{children:e.length===0?n.jsx(Qr,{children:n.jsx(yt,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"Nenhuma campanha cadastrada"})}):e.map(f=>{var m;return n.jsxs(Qr,{children:[n.jsx(yt,{className:"font-medium",children:f.name}),n.jsx(yt,{children:n.jsx(Ae,{variant:"outline",children:((m=l.find(p=>p.value===f.campaignType))==null?void 0:m.label)||f.campaignType})}),n.jsx(yt,{className:"capitalize",children:f.channelScope}),n.jsxs(yt,{className:"text-sm",children:[f.startAt?new Date(f.startAt).toLocaleDateString("pt-BR"):"-","  ",f.endAt?new Date(f.endAt).toLocaleDateString("pt-BR"):""]}),n.jsx(yt,{children:n.jsx(Ae,{variant:f.isActive?"default":"secondary",children:f.isActive?"Ativa":"Inativa"})}),n.jsxs(yt,{className:"text-right",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>i(f),children:n.jsx(ea,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>s(f.id),children:n.jsx(mi,{className:"h-4 w-4 text-destructive"})})]})]},f.id)})})]})}),n.jsx(cn,{open:!!a,onOpenChange:f=>!f&&i(null),children:n.jsxs(sn,{className:"max-w-lg",children:[n.jsx(fn,{children:n.jsx(dn,{children:a!=null&&a.id?"Editar Campanha":"Nova Campanha"})}),n.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Nome"}),n.jsx(Qe,{value:(a==null?void 0:a.name)||"",onChange:f=>i({...a,name:f.target.value})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Descrio"}),n.jsx(Yn,{value:(a==null?void 0:a.description)||"",onChange:f=>i({...a,description:f.target.value})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Tipo"}),n.jsxs(Kt,{value:(a==null?void 0:a.campaignType)||"multiplier",onValueChange:f=>i({...a,campaignType:f}),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsx(qt,{children:l.map(f=>n.jsx(ze,{value:f.value,children:f.label},f.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Canal"}),n.jsxs(Kt,{value:(a==null?void 0:a.channelScope)||"both",onValueChange:f=>i({...a,channelScope:f}),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"both",children:"Ambos"}),n.jsx(ze,{value:"live",children:"S Live"}),n.jsx(ze,{value:"catalog",children:"S Catlogo"})]})]})]})]}),(a==null?void 0:a.campaignType)==="multiplier"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Multiplicador"}),n.jsx(Qe,{type:"number",step:"0.1",value:(a==null?void 0:a.multiplierValue)||2,onChange:f=>i({...a,multiplierValue:Number(f.target.value)})})]}),(a==null?void 0:a.campaignType)==="bonus_points"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Pontos bnus"}),n.jsx(Qe,{type:"number",value:(a==null?void 0:a.bonusPoints)||0,onChange:f=>i({...a,bonusPoints:Number(f.target.value)})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Incio"}),n.jsx(Qe,{type:"datetime-local",value:((u=a==null?void 0:a.startAt)==null?void 0:u.slice(0,16))||"",onChange:f=>i({...a,startAt:f.target.value?new Date(f.target.value).toISOString():null})})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Fim"}),n.jsx(Qe,{type:"datetime-local",value:((h=a==null?void 0:a.endAt)==null?void 0:h.slice(0,16))||"",onChange:f=>i({...a,endAt:f.target.value?new Date(f.target.value).toISOString():null})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Valor mnimo do pedido"}),n.jsx(Qe,{type:"number",value:(a==null?void 0:a.minOrderValue)||"",onChange:f=>i({...a,minOrderValue:f.target.value?Number(f.target.value):null}),placeholder:"Sem mnimo"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(di,{checked:(a==null?void 0:a.isActive)??!0,onCheckedChange:f=>i({...a,isActive:f})}),n.jsx(Le,{children:"Campanha ativa"})]})]}),n.jsxs(Da,{children:[n.jsx(he,{variant:"outline",onClick:()=>i(null),children:"Cancelar"}),n.jsxs(he,{onClick:d,disabled:o,children:[o&&n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}),"Salvar"]})]})]})})]})}function $2e({tiers:e}){const[t,r]=P.useState("menu");return t==="rewards"?n.jsx(T2e,{onBack:()=>r("menu")}):t==="rules"?n.jsx(P2e,{onBack:()=>r("menu")}):n.jsxs(De,{children:[n.jsxs(Ot,{children:[n.jsx(Mt,{children:"Recompensas & Brindes"}),n.jsx(Ai,{children:"Gerencie recompensas por resgate de pontos e brindes automticos"})]}),n.jsxs(Be,{children:[n.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[n.jsx(De,{className:"border-dashed hover:border-primary/50 transition-colors cursor-pointer",onClick:()=>r("rewards"),children:n.jsxs(Be,{className:"p-6 text-center",children:[n.jsx(Rn,{className:"h-10 w-10 mx-auto mb-3 text-muted-foreground"}),n.jsx("h3",{className:"font-medium mb-1",children:"Resgate por Pontos"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Clientes trocam pontos por descontos, frete grtis ou brindes"}),n.jsx(he,{variant:"outline",size:"sm",children:"Gerenciar Recompensas"})]})}),n.jsx(De,{className:"border-dashed hover:border-primary/50 transition-colors cursor-pointer",onClick:()=>r("rules"),children:n.jsxs(Be,{className:"p-6 text-center",children:[n.jsx(Jz,{className:"h-10 w-10 mx-auto mb-3 text-muted-foreground"}),n.jsx("h3",{className:"font-medium mb-1",children:"Brindes Automticos"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Brindes adicionados automaticamente ao carrinho por regras"}),n.jsx(he,{variant:"outline",size:"sm",children:"Configurar Regras"})]})})]}),n.jsxs("div",{className:"mt-6 p-4 bg-muted/50 rounded-lg",children:[n.jsx("h4",{className:"font-medium mb-2",children:"Nveis e elegibilidade"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(s=>n.jsxs(Ae,{variant:"outline",style:{borderColor:s.badgeColor,color:s.badgeColor},children:[s.name," (",s.minPoints,"+ pts)"]},s.id))})]})]})]})}function F2e({missions:e,tiers:t,onSave:r,onDelete:s}){const[a,i]=P.useState(null),[o,c]=P.useState(!1),d=async()=>{if(!(a!=null&&a.title)||!(a!=null&&a.missionKey)){de.error("Ttulo e chave so obrigatrios");return}c(!0);try{await r(a),i(null),de.success("Misso salva!")}catch{de.error("Erro ao salvar")}finally{c(!1)}},l=[{value:"quiz",label:"Quiz/Perguntas"},{value:"profile_update",label:"Atualizar perfil"},{value:"photo_upload",label:"Enviar fotos"},{value:"first_purchase",label:"Primeira compra"},{value:"review",label:"Avaliao"}];return n.jsxs(De,{children:[n.jsxs(Ot,{className:"flex flex-row items-center justify-between",children:[n.jsxs("div",{children:[n.jsx(Mt,{children:"Misses"}),n.jsx(Ai,{children:"Questionrios e tarefas que do pontos"})]}),n.jsxs(he,{onClick:()=>i({isActive:!0,isPublished:!1,missionType:"quiz",pointsReward:50,maxPhotos:5,emoji:"",displayOrder:e.length,questionsJson:[]}),size:"sm",children:[n.jsx(An,{className:"h-4 w-4 mr-1"})," Nova Misso"]})]}),n.jsx(Be,{children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{children:"Misso"}),n.jsx(jt,{children:"Tipo"}),n.jsx(jt,{children:"Pontos"}),n.jsx(jt,{children:"Status"}),n.jsx(jt,{className:"text-right",children:"Aes"})]})}),n.jsx(Na,{children:e.length===0?n.jsx(Qr,{children:n.jsx(yt,{colSpan:5,className:"text-center text-muted-foreground py-8",children:"Nenhuma misso cadastrada"})}):e.map(u=>{var h;return n.jsxs(Qr,{children:[n.jsx(yt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-xl",children:u.emoji}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:u.title}),n.jsx("div",{className:"text-xs text-muted-foreground",children:u.subtitle})]})]})}),n.jsx(yt,{children:n.jsx(Ae,{variant:"outline",children:((h=l.find(f=>f.value===u.missionType))==null?void 0:h.label)||u.missionType})}),n.jsxs(yt,{children:["+",u.pointsReward," pts"]}),n.jsx(yt,{children:n.jsxs("div",{className:"flex gap-1",children:[n.jsx(Ae,{variant:u.isActive?"default":"secondary",children:u.isActive?"Ativo":"Inativo"}),u.isPublished&&n.jsx(Ae,{variant:"outline",children:"Publicado"})]})}),n.jsxs(yt,{className:"text-right",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>i(u),children:n.jsx(ea,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>s(u.id),children:n.jsx(mi,{className:"h-4 w-4 text-destructive"})})]})]},u.id)})})]})}),n.jsx(cn,{open:!!a,onOpenChange:u=>!u&&i(null),children:n.jsxs(sn,{className:"max-w-lg",children:[n.jsx(fn,{children:n.jsx(dn,{children:a!=null&&a.id?"Editar Misso":"Nova Misso"})}),n.jsxs("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:[n.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Emoji"}),n.jsx(Qe,{value:(a==null?void 0:a.emoji)||"",onChange:u=>i({...a,emoji:u.target.value}),className:"text-center text-xl"})]}),n.jsxs("div",{className:"col-span-3 space-y-2",children:[n.jsx(Le,{children:"Ttulo"}),n.jsx(Qe,{value:(a==null?void 0:a.title)||"",onChange:u=>i({...a,title:u.target.value})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Chave nica"}),n.jsx(Qe,{value:(a==null?void 0:a.missionKey)||"",onChange:u=>i({...a,missionKey:u.target.value.toLowerCase().replace(/\s+/g,"_")}),placeholder:"ex: mission_trabalho"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Subttulo"}),n.jsx(Qe,{value:(a==null?void 0:a.subtitle)||"",onChange:u=>i({...a,subtitle:u.target.value})})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Tipo"}),n.jsxs(Kt,{value:(a==null?void 0:a.missionType)||"quiz",onValueChange:u=>i({...a,missionType:u}),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsx(qt,{children:l.map(u=>n.jsx(ze,{value:u.value,children:u.label},u.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Pontos"}),n.jsx(Qe,{type:"number",value:(a==null?void 0:a.pointsReward)||50,onChange:u=>i({...a,pointsReward:Number(u.target.value)})})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Descrio"}),n.jsx(Yn,{value:(a==null?void 0:a.description)||"",onChange:u=>i({...a,description:u.target.value})})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(di,{checked:(a==null?void 0:a.isActive)??!0,onCheckedChange:u=>i({...a,isActive:u})}),n.jsx(Le,{children:"Ativo"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(di,{checked:(a==null?void 0:a.isPublished)??!1,onCheckedChange:u=>i({...a,isPublished:u})}),n.jsx(Le,{children:"Publicado"})]})]})]}),n.jsxs(Da,{children:[n.jsx(he,{variant:"outline",onClick:()=>i(null),children:"Cancelar"}),n.jsxs(he,{onClick:d,disabled:o,children:[o&&n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}),"Salvar"]})]})]})})]})}function z2e({data:e,tiers:t}){return e?n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Pontos Emitidos"}),n.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["+",e.pointsEarned.toLocaleString()]})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Pontos Resgatados"}),n.jsxs("div",{className:"text-2xl font-bold text-amber-600",children:["-",e.pointsRedeemed.toLocaleString()]})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Pontos Expirados"}),n.jsx("div",{className:"text-2xl font-bold text-red-600",children:e.pointsExpired.toLocaleString()})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Membros Ativos"}),n.jsx("div",{className:"text-2xl font-bold",children:e.activeUsers})]})})]}),n.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsx(Mt,{children:"Distribuio por Nvel"})}),n.jsx(Be,{children:n.jsx("div",{className:"space-y-3",children:t.map(r=>{var o;const s=((o=e.tierDistribution.find(c=>c.tier===r.slug))==null?void 0:o.count)||0,a=e.activeUsers||1,i=Math.round(s/a*100);return n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:r.badgeColor}}),r.name]}),n.jsxs("span",{className:"text-muted-foreground",children:[s," (",i,"%)"]})]}),n.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full rounded-full",style:{width:`${i}%`,backgroundColor:r.badgeColor}})})]},r.id)})})})]}),n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsx(Mt,{children:"Top Recompensas"})}),n.jsx(Be,{children:e.topRewards.length===0?n.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Nenhum resgate ainda"}):n.jsx("div",{className:"space-y-3",children:e.topRewards.map((r,s)=>n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{children:r.name}),n.jsxs(Ae,{variant:"outline",children:[r.redemptions," resgates"]})]},s))})})]})]})]}):n.jsx("div",{className:"flex items-center justify-center py-20 text-muted-foreground",children:"Carregando relatrios..."})}function U2e(){const[e,t]=P.useState([]),[r,s]=P.useState(!0),a=P.useCallback(async()=>{s(!0);try{const{data:l,error:u}=await ce.from("promotional_tables").select("*").order("priority",{ascending:!1});if(u)throw u;const h=m=>{if(!m)return[];if(Array.isArray(m))return m;if(typeof m=="string")try{const p=JSON.parse(m);return Array.isArray(p)?p:[]}catch{return[]}return[]},f=(l||[]).map(m=>({...m,category_discounts:h(m.category_discounts),product_discounts:h(m.product_discounts)}));t(f)}catch(l){console.error("Error fetching promotional tables:",l),de.error("Erro ao carregar tabelas promocionais")}finally{s(!1)}},[]);return P.useEffect(()=>{a()},[a]),{tables:e,isLoading:r,fetchTables:a,createTable:async l=>{try{const{error:u}=await ce.from("promotional_tables").insert({...l,category_discounts:JSON.stringify(l.category_discounts),product_discounts:JSON.stringify(l.product_discounts)});if(u)throw u;return de.success("Tabela promocional criada!"),await a(),!0}catch(u){return console.error("Error creating promotional table:",u),de.error("Erro ao criar tabela promocional"),!1}},updateTable:async(l,u)=>{try{const h={...u};u.category_discounts&&(h.category_discounts=JSON.stringify(u.category_discounts)),u.product_discounts&&(h.product_discounts=JSON.stringify(u.product_discounts));const{error:f}=await ce.from("promotional_tables").update(h).eq("id",l);if(f)throw f;return de.success("Tabela promocional atualizada!"),await a(),!0}catch(h){return console.error("Error updating promotional table:",h),de.error("Erro ao atualizar tabela promocional"),!1}},deleteTable:async l=>{try{const{error:u}=await ce.from("promotional_tables").delete().eq("id",l);if(u)throw u;return de.success("Tabela promocional excluda!"),t(h=>h.filter(f=>f.id!==l)),!0}catch(u){return console.error("Error deleting promotional table:",u),de.error("Erro ao excluir tabela promocional"),!1}},toggleActive:async l=>{try{const{error:u}=await ce.from("promotional_tables").update({is_active:!l.is_active}).eq("id",l.id);if(u)throw u;return t(h=>h.map(f=>f.id===l.id?{...f,is_active:!f.is_active}:f)),de.success(l.is_active?"Tabela desativada":"Tabela ativada"),!0}catch(u){return console.error("Error toggling table:",u),de.error("Erro ao atualizar tabela"),!1}}}}const Wy=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e);function V2e({value:e,onChange:t}){const[r,s]=P.useState(!1),[a,i]=P.useState(""),[o,c]=P.useState([]),[d,l]=P.useState(!1),[u,h]=P.useState(!1),[f,m]=P.useState("percentage"),[p,g]=P.useState(""),[v,x]=P.useState(!1),[y,b]=P.useState(""),[j,T]=P.useState(!1);P.useEffect(()=>{if(!r)return;const N=setTimeout(()=>{O(a)},300);return()=>clearTimeout(N)},[a,r]),P.useEffect(()=>{r&&O("")},[r]);const O=async N=>{l(!0);try{let C=ce.from("product_catalog").select("id, name, image_url, price, sku, is_active, stock_by_size, discount_type, discount_value").order("name").limit(50);N&&N.length>=2&&(C=C.or(`name.ilike.%${N}%,sku.ilike.%${N}%`));const{data:k,error:I}=await C;if(I)throw I;c(k||[])}catch(C){console.error("Error fetching products:",C)}finally{l(!1)}},R=P.useMemo(()=>{const N=new Set(e.map(C=>C.product_id));return o.filter(C=>!N.has(C.id))},[o,e]),D=P.useCallback(N=>{if(e.some(C=>C.product_id===N.id)){de.info("Produto j adicionado",{description:N.name});return}if(!N.is_active){de.warning("Produto inativo",{description:`${N.name} est inativo. Confirme se deseja adicionar.`,action:{label:"Adicionar mesmo assim",onClick:()=>L(N)}});return}L(N)},[e,u,f,p]),L=N=>{const C=u?f:"percentage",k=u&&p?parseFloat(p):10,I={product_id:N.id,product_name:N.name,discount_type:C,discount_value:k,price_base:"current",image_url:N.image_url||void 0,original_price:N.price,sku:N.sku||void 0,is_active:N.is_active};t([...e,I]),s(!1),i("")},q=N=>{t(e.filter(C=>C.product_id!==N))},X=(N,C,k)=>{t(e.map(I=>I.product_id===N?{...I,[C]:C==="discount_value"?parseFloat(String(k))||0:k}:I))},H=()=>{if(!p)return;const N=parseFloat(p);t(e.map(C=>({...C,discount_type:f,discount_value:N}))),de.success(`Desconto aplicado a ${e.length} produtos`)},M=async()=>{if(y.trim()){T(!0);try{const N=y.split(/[\n,;\s]+/).map(V=>V.trim()).filter(V=>V.length>0);if(N.length===0){de.error("Nenhum SKU ou ID vlido encontrado");return}const{data:C,error:k}=await ce.from("product_catalog").select("id, name, image_url, price, sku, is_active, stock_by_size").or(N.map(V=>`sku.eq.${V},id.eq.${V}`).join(","));if(k)throw k;const I=C||[],U=new Set(I.map(V=>V.sku||V.id)),$=N.filter(V=>!U.has(V)&&!I.some(W=>W.id===V));let Y=0,Z=0;const re=new Set(e.map(V=>V.product_id)),G=[];for(const V of I){if(re.has(V.id)){Z++;continue}G.push({product_id:V.id,product_name:V.name,discount_type:f,discount_value:p?parseFloat(p):10,price_base:"current",image_url:V.image_url||void 0,original_price:V.price,sku:V.sku||void 0,is_active:V.is_active}),Y++}t([...e,...G]);let J=`${Y} produto(s) adicionado(s)`;Z>0&&(J+=`, ${Z} j existiam`),$.length>0&&(J+=`, ${$.length} no encontrado(s)`),de.success(J,{description:$.length>0?`No encontrados: ${$.slice(0,5).join(", ")}${$.length>5?"...":""}`:void 0}),x(!1),b("")}catch(N){console.error("Error processing paste:",N),de.error("Erro ao processar lista")}finally{T(!1)}}},F=N=>N.original_price?N.discount_type==="percentage"?N.original_price*(1-N.discount_value/100):Math.max(0,N.original_price-N.discount_value):null,S=N=>{if(N.discount_type==="percentage"){if(N.discount_value<=0||N.discount_value>90)return"Desconto % deve ser entre 1 e 90"}else if(N.discount_type==="fixed"&&N.original_price&&N.discount_value>=N.original_price)return"Desconto no pode ser maior que o preo";return null},E=P.useMemo(()=>{if(e.length===0)return null;const N=e.reduce((C,k)=>k.discount_type==="percentage"?C+k.discount_value:k.original_price&&k.original_price>0?C+k.discount_value/k.original_price*100:C,0)/e.length;return{count:e.length,avgDiscount:N.toFixed(1)}},[e]);return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(di,{id:"bulk-same-discount",checked:u,onCheckedChange:h}),n.jsx(Le,{htmlFor:"bulk-same-discount",className:"text-sm",children:"Aplicar mesmo desconto"})]}),u&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Kt,{value:f,onValueChange:N=>m(N),children:[n.jsx(Vt,{className:"w-20",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"percentage",children:"%"}),n.jsx(ze,{value:"fixed",children:"R$"})]})]}),n.jsx(Qe,{type:"number",min:"0",max:f==="percentage"?"90":void 0,placeholder:"Valor",value:p,onChange:N=>g(N.target.value),className:"w-24"}),e.length>0&&n.jsx(he,{variant:"outline",size:"sm",onClick:H,children:"Aplicar a todos"})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsxs(hi,{open:r,onOpenChange:s,children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:"flex-1 justify-start",children:[n.jsx(Ln,{className:"h-4 w-4 mr-2"}),"Buscar produto por nome ou SKU..."]})}),n.jsx(Za,{className:"w-[400px] p-0",align:"start",children:n.jsxs(r8,{shouldFilter:!1,children:[n.jsx(aH,{placeholder:"Digite nome ou SKU...",value:a,onValueChange:i}),n.jsx(n8,{children:d?n.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Buscando..."}):R.length===0?n.jsx(s8,{children:a.length<2?"Digite ao menos 2 caracteres":"Nenhum produto encontrado"}):n.jsx(a8,{children:R.slice(0,20).map(N=>{const C=Ixe(N.stock_by_size);return n.jsxs(i8,{value:N.id,onSelect:()=>D(N),className:"flex items-center gap-3 p-2",children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:N.image_url?n.jsx("img",{src:N.image_url,alt:N.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-medium text-sm truncate",children:N.name}),!N.is_active&&n.jsx(Ae,{variant:"outline",className:"text-[10px] px-1",children:"Inativo"})]}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[N.sku||"Sem SKU","  ",Wy(N.price),"  ",C," un"]})]}),n.jsx(An,{className:"h-4 w-4 shrink-0"})]},N.id)})})})]})})]}),n.jsxs(he,{variant:"outline",onClick:()=>x(!0),children:[n.jsx(mw,{className:"h-4 w-4 mr-2"}),"Colar SKUs"]})]}),E&&n.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[n.jsxs("span",{children:[E.count," produto(s) selecionado(s)"]}),n.jsxs("span",{children:["Mdia: ",E.avgDiscount,"% desconto"]})]}),e.length>0?n.jsx("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:e.map(N=>{const C=F(N),k=S(N);return n.jsx("div",{className:We("p-3 rounded-lg border",k?"border-destructive/50 bg-destructive/5":"bg-muted/30"),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:N.image_url?n.jsx("img",{src:N.image_url,alt:N.product_name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("span",{className:"font-medium text-sm truncate",children:N.product_name||N.product_id.slice(0,8)}),N.is_active===!1&&n.jsxs(Ae,{variant:"outline",className:"text-[10px] px-1",children:[n.jsx(Mr,{className:"h-2.5 w-2.5 mr-0.5"}),"Inativo"]})]}),n.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:[N.sku||"",N.original_price&&`  ${Wy(N.original_price)}`]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[n.jsxs(Kt,{value:N.discount_type,onValueChange:I=>X(N.product_id,"discount_type",I),children:[n.jsx(Vt,{className:"w-16 h-8",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"percentage",children:n.jsx(jo,{className:"h-3 w-3"})}),n.jsx(ze,{value:"fixed",children:n.jsx(ws,{className:"h-3 w-3"})})]})]}),n.jsx(Qe,{type:"number",min:"0",max:N.discount_type==="percentage"?"90":void 0,step:N.discount_type==="percentage"?"1":"0.01",value:N.discount_value,onChange:I=>X(N.product_id,"discount_value",I.target.value),className:"w-20 h-8"}),C!==null&&N.original_price&&n.jsxs("span",{className:"text-sm",children:[n.jsx("span",{className:"text-muted-foreground line-through",children:Wy(N.original_price)}),"  ",n.jsx("span",{className:"font-medium text-green-600",children:Wy(C)})]})]}),k&&n.jsx("p",{className:"text-xs text-destructive mt-1",children:k})]}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0 text-muted-foreground hover:text-destructive",onClick:()=>q(N.product_id),children:n.jsx(mi,{className:"h-4 w-4"})})]})},N.product_id)})}):n.jsxs("div",{className:"text-center py-8 text-muted-foreground border border-dashed rounded-lg",children:[n.jsx(Ut,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm",children:"Nenhum produto selecionado"}),n.jsx("p",{className:"text-xs",children:"Use a busca acima para adicionar produtos"})]}),n.jsx(cn,{open:v,onOpenChange:x,children:n.jsxs(sn,{className:"sm:max-w-md",children:[n.jsx(fn,{children:n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(mw,{className:"h-5 w-5"}),"Colar Lista de SKUs/IDs"]})}),n.jsxs("div",{className:"space-y-4",children:[n.jsx(Yn,{placeholder:"Cole aqui os SKUs ou IDs separados por vrgula, espao ou nova linha...",value:y,onChange:N=>b(N.target.value),rows:6}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Exemplo: SKU001, SKU002, SKU003 ou um por linha"})]}),n.jsxs(Da,{children:[n.jsx(he,{variant:"outline",onClick:()=>x(!1),children:"Cancelar"}),n.jsx(he,{onClick:M,disabled:j||!y.trim(),children:j?"Processando...":n.jsxs(n.Fragment,{children:[n.jsx(xn,{className:"h-4 w-4 mr-1"}),"Processar"]})})]})]})})]})}const q2e=["vestidos","blusas","calas","saias","shorts","conjuntos","macaces","casacos","acessrios"];function W2e({open:e,onOpenChange:t,table:r,onSubmit:s}){const a=!!r,[i,o]=P.useState(""),[c,d]=P.useState(""),[l,u]=P.useState(!0),[h,f]=P.useState(0),[m,p]=P.useState("all"),[g,v]=P.useState(),[x,y]=P.useState("00:00"),[b,j]=P.useState(),[T,O]=P.useState("23:59"),[R,D]=P.useState(""),[L,q]=P.useState(""),[X,H]=P.useState(""),[M,F]=P.useState([]),[S,E]=P.useState(""),[N,C]=P.useState("percentage"),[k,I]=P.useState(""),[U,$]=P.useState([]),[Y,Z]=P.useState(!1);P.useEffect(()=>{var ee,ie;if(e){if(r){if(o(r.name),d(r.description||""),u(r.is_active),f(r.priority),p(r.channel_scope),r.start_at){const oe=new Date(r.start_at);v(oe),y(Ht(oe,"HH:mm"))}else v(void 0),y("00:00");if(r.end_at){const oe=new Date(r.end_at);j(oe),O(Ht(oe,"HH:mm"))}else j(void 0),O("23:59");D(r.store_discount_type||""),q(((ee=r.store_discount_value)==null?void 0:ee.toString())||""),H(((ie=r.store_min_order_value)==null?void 0:ie.toString())||""),F(r.category_discounts||[]),$((r.product_discounts||[]).map(oe=>({product_id:oe.product_id,product_name:oe.product_name,discount_type:oe.discount_type,discount_value:oe.discount_value,price_base:"current"})))}else o(""),d(""),u(!0),f(0),p("all"),v(void 0),y("00:00"),j(void 0),O("23:59"),D(""),q(""),H(""),F([]),$([]);E(""),I("")}},[e,r]);const re=(ee,ie)=>{if(!ee)return null;const[oe,se]=ie.split(":").map(Number),le=new Date(ee);return le.setHours(oe,se,0,0),le.toISOString()},G=()=>{if(!S||!k)return;const ee=M.find(ie=>ie.category===S);F(ee?ie=>ie.map(oe=>oe.category===S?{...oe,discount_type:N,discount_value:parseFloat(k)}:oe):ie=>[...ie,{category:S,discount_type:N,discount_value:parseFloat(k)}]),E(""),I("")},J=ee=>{F(ie=>ie.filter(oe=>oe.category!==ee))},V=()=>U.map(ee=>({product_id:ee.product_id,product_name:ee.product_name,discount_type:ee.discount_type,discount_value:ee.discount_value})),W=async()=>{if(i.trim()){Z(!0);try{const ee={name:i.trim(),description:c.trim()||null,is_active:l,priority:h,channel_scope:m,start_at:re(g,x),end_at:re(b,T),store_discount_type:R||null,store_discount_value:L?parseFloat(L):null,store_min_order_value:X?parseFloat(X):null,category_discounts:M,product_discounts:V(),user_id:null};await s(ee)&&t(!1)}finally{Z(!1)}}};return n.jsx(cn,{open:e,onOpenChange:t,children:n.jsxs(sn,{className:"!flex !flex-col sm:max-w-2xl max-h-[90vh] overflow-hidden p-0",children:[n.jsxs(fn,{className:"shrink-0 p-4 sm:p-6 pb-4 border-b",children:[n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(Oa,{className:"h-5 w-5"}),a?"Editar Tabela Promocional":"Nova Tabela Promocional"]}),n.jsx(Zo,{children:a?"Atualize as regras de preo e agendamento":"Crie regras de desconto para loja, categorias ou produtos especficos"})]}),n.jsx("div",{className:"flex-1 min-h-0 overflow-y-auto overscroll-contain px-4 sm:px-6",children:n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"name",children:"Nome da Tabela *"}),n.jsx(Qe,{id:"name",placeholder:"Ex: Black Friday 2025",value:i,onChange:ee=>o(ee.target.value)}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Uso interno, no aparece para o cliente"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"description",children:"Descrio (opcional)"}),n.jsx(Yn,{id:"description",placeholder:"Detalhes sobre a promoo...",value:c,onChange:ee=>d(ee.target.value),rows:2})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(di,{id:"is_active",checked:l,onCheckedChange:u}),n.jsx(Le,{htmlFor:"is_active",children:"Ativa"})]}),n.jsxs("div",{className:"flex-1 space-y-1",children:[n.jsx(Le,{children:"Canal"}),n.jsxs(Kt,{value:m,onValueChange:ee=>p(ee),children:[n.jsx(Vt,{className:"w-full sm:w-40",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos"}),n.jsx(ze,{value:"catalog",children:"S Catlogo"}),n.jsx(ze,{value:"live",children:"S Live"})]})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsx(Le,{children:"Prioridade"}),n.jsx(Qe,{type:"number",min:"0",value:h,onChange:ee=>f(parseInt(ee.target.value)||0),className:"w-20"})]})]})]}),n.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[n.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[n.jsx(Br,{className:"h-4 w-4"}),"Agendamento"]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Incio"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("flex-1 justify-start text-left font-normal",!g&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),g?Ht(g,"dd/MM/yy"):"Data"]})}),n.jsx(Za,{className:"w-auto p-0",align:"start",children:n.jsx(Ti,{mode:"single",selected:g,onSelect:v,locale:gr})})]}),n.jsx(Qe,{type:"time",value:x,onChange:ee=>y(ee.target.value),className:"w-24"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Fim"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("flex-1 justify-start text-left font-normal",!b&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),b?Ht(b,"dd/MM/yy"):"Data"]})}),n.jsx(Za,{className:"w-auto p-0",align:"start",children:n.jsx(Ti,{mode:"single",selected:b,onSelect:j,locale:gr})})]}),n.jsx(Qe,{type:"time",value:T,onChange:ee=>O(ee.target.value),className:"w-24"})]})]})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Deixe vazio para promoo sem limite de tempo"})]}),n.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[n.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[n.jsx(pa,{className:"h-4 w-4"}),"Desconto Geral da Loja"]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Aplica um desconto padro para toda a loja"}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Tipo"}),n.jsxs(Kt,{value:R,onValueChange:ee=>D(ee),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecionar"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"percentage",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(jo,{className:"h-3 w-3"})," Porcentagem"]})}),n.jsx(ze,{value:"fixed",children:n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ws,{className:"h-3 w-3"})," Valor fixo"]})})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Desconto"}),n.jsxs("div",{className:"relative",children:[n.jsx(Qe,{type:"number",min:"0",step:R==="percentage"?"1":"0.01",value:L,onChange:ee=>q(ee.target.value),placeholder:"0",disabled:!R}),R&&n.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm",children:R==="percentage"?"%":"R$"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Valor Mnimo"}),n.jsxs("div",{className:"relative",children:[n.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground text-sm",children:"R$"}),n.jsx(Qe,{type:"number",min:"0",step:"0.01",value:X,onChange:ee=>H(ee.target.value),placeholder:"0,00",className:"pl-10"})]})]})]})]}),n.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[n.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[n.jsx(Oa,{className:"h-4 w-4"}),"Descontos por Categoria"]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Substituem o desconto geral da loja"}),M.length>0&&n.jsx("div",{className:"space-y-2",children:M.map(ee=>n.jsxs("div",{className:"flex items-center justify-between bg-secondary/50 rounded-lg px-3 py-2",children:[n.jsx("span",{className:"capitalize font-medium",children:ee.category}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm",children:ee.discount_type==="percentage"?`${ee.discount_value}%`:`R$ ${ee.discount_value.toFixed(2)}`}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>J(ee.category),children:n.jsx(an,{className:"h-3 w-3"})})]})]},ee.category))}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsxs(Kt,{value:S,onValueChange:E,children:[n.jsx(Vt,{className:"flex-1",children:n.jsx(Xt,{placeholder:"Categoria"})}),n.jsx(qt,{children:q2e.filter(ee=>!M.find(ie=>ie.category===ee)).map(ee=>n.jsx(ze,{value:ee,className:"capitalize",children:ee},ee))})]}),n.jsxs(Kt,{value:N,onValueChange:ee=>C(ee),children:[n.jsx(Vt,{className:"w-full sm:w-32",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"percentage",children:"%"}),n.jsx(ze,{value:"fixed",children:"R$"})]})]}),n.jsx(Qe,{type:"number",min:"0",placeholder:"Valor",value:k,onChange:ee=>I(ee.target.value),className:"w-full sm:w-24"}),n.jsx(he,{variant:"outline",size:"icon",onClick:G,disabled:!S||!k,children:n.jsx(An,{className:"h-4 w-4"})})]})]}),n.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[n.jsxs("h3",{className:"font-medium flex items-center gap-2",children:[n.jsx(Ut,{className:"h-4 w-4"}),"Descontos por Produto"]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Substituem descontos de categoria e geral. Busque e selecione produtos abaixo."}),n.jsx(V2e,{value:U,onChange:$})]})]})}),n.jsx(Da,{className:"shrink-0 p-4 sm:p-6 border-t bg-background",children:n.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-2 w-full sm:w-auto",children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),disabled:Y,className:"w-full sm:w-auto",children:"Cancelar"}),n.jsx(he,{onClick:W,disabled:Y||!i.trim(),className:"w-full sm:w-auto",children:Y?"Salvando...":a?"Salvar Alteraes":"Criar Tabela"})]})})]})})}function H2e(){const{tables:e,isLoading:t,createTable:r,updateTable:s,deleteTable:a,toggleActive:i}=U2e(),[o,c]=P.useState(""),[d,l]=P.useState(!1),[u,h]=P.useState(null),[f,m]=P.useState(null),p=()=>{h(null),l(!0)},g=O=>{h(O),l(!0)},v=async O=>{confirm(`Excluir a tabela "${O.name}"?`)&&await a(O.id)},x=async O=>u?await s(u.id,O):await r(O),y=e.filter(O=>{var R;return O.name.toLowerCase().includes(o.toLowerCase())||((R=O.description)==null?void 0:R.toLowerCase().includes(o.toLowerCase()))}),b=O=>{if(!O.is_active)return{label:"Inativa",variant:"secondary"};const R=new Date;return O.start_at&&Fw(lu(O.start_at),R)?{label:"Agendada",variant:"outline"}:O.end_at&&b8(lu(O.end_at),R)?{label:"Expirada",variant:"destructive"}:{label:"Ativa",variant:"default"}},j=(O,R)=>!O||!R?"-":O==="percentage"?`${R}%`:`R$ ${R.toFixed(2)}`,T=O=>{switch(O){case"catalog":return"Catlogo";case"live":return"Live";default:return"Todos"}};return n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[n.jsxs("div",{children:[n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(Oa,{className:"h-5 w-5"}),"Tabelas Promocionais"]}),n.jsx(Ai,{children:"Regras de preo com agendamento e descontos por loja, categoria ou produto"})]}),n.jsxs(he,{onClick:p,className:"w-full sm:w-auto",children:[n.jsx(An,{className:"h-4 w-4 mr-1"}),"Nova Tabela"]})]})}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar tabelas...",value:o,onChange:O=>c(O.target.value),className:"pl-10"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold",children:e.length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Total"})]}),n.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.filter(O=>b(O).label==="Ativa").length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Ativas"})]}),n.jsxs("div",{className:"p-3 bg-amber-50 dark:bg-amber-950/30 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:e.filter(O=>b(O).label==="Agendada").length}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Agendadas"})]})]}),t?n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando..."}):y.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Oa,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhuma tabela promocional encontrada"}),n.jsx(he,{variant:"link",onClick:p,className:"mt-2",children:"Criar primeira tabela"})]}):n.jsx("div",{className:"space-y-3",children:y.map(O=>{const R=b(O),D=f===O.id,L=!!O.store_discount_type&&!!O.store_discount_value,q=O.category_discounts.length>0,X=O.product_discounts.length>0;return n.jsx(Ag,{open:D,onOpenChange:()=>m(D?null:O.id),children:n.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[n.jsxs("div",{className:"p-4 bg-card flex flex-col sm:flex-row sm:items-center gap-3",children:[n.jsx(Tg,{asChild:!0,children:n.jsxs("button",{className:"flex-1 flex items-start gap-3 text-left",children:[n.jsx("div",{className:"mt-1",children:D?n.jsx(nf,{className:"h-4 w-4 text-muted-foreground"}):n.jsx(Zi,{className:"h-4 w-4 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("span",{className:"font-medium",children:O.name}),n.jsx(Ae,{variant:R.variant,children:R.label}),n.jsx(Ae,{variant:"outline",className:"text-xs",children:T(O.channel_scope)})]}),O.description&&n.jsx("p",{className:"text-sm text-muted-foreground mt-1 truncate",children:O.description}),n.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground flex-wrap",children:[(O.start_at||O.end_at)&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Br,{className:"h-3 w-3"}),O.start_at&&Ht(lu(O.start_at),"dd/MM HH:mm",{locale:gr}),O.start_at&&O.end_at&&"  ",O.end_at&&Ht(lu(O.end_at),"dd/MM HH:mm",{locale:gr})]}),L&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(pa,{className:"h-3 w-3"}),j(O.store_discount_type,O.store_discount_value)]}),q&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Oa,{className:"h-3 w-3"}),O.category_discounts.length," cat."]}),X&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(Ut,{className:"h-3 w-3"}),O.product_discounts.length," prod."]})]})]})]})}),n.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>g(O),title:"Editar",children:n.jsx(ea,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>i(O),title:O.is_active?"Desativar":"Ativar",children:O.is_active?n.jsx(Vu,{className:"h-4 w-4 text-green-600"}):n.jsx(Uu,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>v(O),title:"Excluir",children:n.jsx(mi,{className:"h-4 w-4 text-destructive"})})]})]}),n.jsx(Pg,{children:n.jsxs("div",{className:"border-t p-4 bg-muted/30 space-y-4",children:[L&&n.jsxs("div",{children:[n.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[n.jsx(pa,{className:"h-4 w-4"}),"Desconto Geral"]}),n.jsxs("div",{className:"text-sm",children:[j(O.store_discount_type,O.store_discount_value),O.store_min_order_value&&O.store_min_order_value>0&&n.jsxs("span",{className:"text-muted-foreground ml-2",children:["(mn. R$ ",O.store_min_order_value.toFixed(2),")"]})]})]}),q&&n.jsxs("div",{children:[n.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[n.jsx(Oa,{className:"h-4 w-4"}),"Por Categoria"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:O.category_discounts.map(H=>n.jsxs(Ae,{variant:"secondary",className:"capitalize",children:[H.category,": ",j(H.discount_type,H.discount_value)]},H.category))})]}),X&&n.jsxs("div",{children:[n.jsxs("h4",{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[n.jsx(Ut,{className:"h-4 w-4"}),"Por Produto"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:O.product_discounts.map(H=>n.jsxs(Ae,{variant:"secondary",children:[H.product_name||H.product_id.slice(0,8),":"," ",j(H.discount_type,H.discount_value)]},H.product_id))})]}),!L&&!q&&!X&&n.jsx("p",{className:"text-sm text-muted-foreground",children:"Nenhum desconto configurado"})]})})]})},O.id)})})]}),n.jsx(W2e,{open:d,onOpenChange:l,table:u,onSubmit:x})]})}const G2e=()=>{const e=fr(),[t,r]=kc(),s=t.get("tab"),a=t.get("filter"),[i,o]=P.useState(s||"overview");P.useEffect(()=>{s&&s!==i&&o(s)},[s]);const c=E=>{o(E);const N=new URLSearchParams(t);N.set("tab",E),E!==s&&N.delete("filter"),r(N)},[d,l]=P.useState(null),[u,h]=P.useState(null),[f,m]=P.useState([]),[p,g]=P.useState([]),[v,x]=P.useState({}),[y,b]=P.useState(!0),[j,T]=P.useState(!1),[O,R]=P.useState(null),[D,L]=P.useState("");P.useEffect(()=>{const{data:{subscription:E}}=ce.auth.onAuthStateChange((N,C)=>{h(C),l((C==null?void 0:C.user)??null),C||e("/login")});return ce.auth.getSession().then(({data:{session:N}})=>{h(N),l((N==null?void 0:N.user)??null),N||e("/login")}),()=>E.unsubscribe()},[e]),P.useEffect(()=>{d&&q()},[d]);const q=async()=>{try{const{data:E,error:N}=await ce.from("customers").select("*").order("created_at",{ascending:!1});if(N)throw N;m(E||[]);const{data:C,error:k}=await ce.from("print_requests").select("*").order("created_at",{ascending:!1});if(k)throw k;g(C||[]);const I=(C||[]).filter(U=>U.linked_product_id).map(U=>U.linked_product_id);if(I.length>0){const{data:U}=await ce.from("product_catalog").select("id, name, image_url, price").in("id",I);if(U){const $={};U.forEach(Y=>{$[Y.id]=Y}),x($)}}}catch(E){console.error("Error loading data:",E),de.error("Erro ao carregar dados")}finally{b(!1)}},X=async()=>{await ce.auth.signOut(),e("/login")},H=E=>{const{data:N}=ce.storage.from("prints").getPublicUrl(E);return N.publicUrl},M=E=>new Date(E).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}),F=E=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(E),S=E=>{const N=f.find(C=>C.id===E.customer_id);R(E),L((N==null?void 0:N.phone)||""),T(!0)};return d?n.jsxs("div",{className:"min-h-screen bg-background overflow-x-hidden w-full max-w-full",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b border-border",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 h-14 sm:h-16 flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 min-w-0",children:[n.jsx(p2e,{activeTab:i,onTabChange:c,onLogout:X,onImportStock:()=>e("/importar-estoque"),printCount:p.length}),n.jsx("img",{src:hd,alt:"LE.PO",className:"h-6 sm:h-8 shrink-0 max-w-[100px]"}),n.jsx("div",{className:"hidden md:block h-6 w-px bg-border"}),n.jsx("span",{className:"hidden md:block text-sm font-medium text-muted-foreground truncate",children:"Painel de Controle"})]}),n.jsxs("div",{className:"flex items-center gap-1 sm:gap-2 shrink-0",children:[n.jsxs(he,{variant:"outline",onClick:()=>e("/importar-estoque"),size:"sm",className:"gap-2 hidden sm:flex h-9",children:[n.jsx(sf,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden lg:inline",children:"Importar Estoque"})]}),n.jsxs(he,{variant:"ghost",onClick:X,size:"sm",className:"gap-2 hidden md:flex h-9",children:[n.jsx(ik,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden lg:inline",children:"Sair"})]})]})]})}),n.jsx("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-4 sm:py-6 overflow-x-hidden w-full",children:n.jsxs(pi,{value:i,onValueChange:c,className:"space-y-4 sm:space-y-6",children:[n.jsxs(Qa,{className:"hidden md:flex flex-wrap bg-muted/50 p-1",children:[n.jsxs(pr,{value:"overview",className:"gap-2",children:[n.jsx(ak,{className:"h-4 w-4"}),"Viso Geral"]}),n.jsxs(pr,{value:"clientes",className:"gap-2",children:[n.jsx(nU,{className:"h-4 w-4"}),"Clientes"]}),n.jsxs(pr,{value:"products",className:"gap-2",children:[n.jsx(Ut,{className:"h-4 w-4"}),"Produtos"]}),n.jsxs(pr,{value:"orders",className:"gap-2",children:[n.jsx(ln,{className:"h-4 w-4"}),"Pedidos"]}),n.jsxs(pr,{value:"lives",className:"gap-2",children:[n.jsx(Ts,{className:"h-4 w-4"}),"Lives"]}),n.jsxs(pr,{value:"cupons",className:"gap-2",children:[n.jsx(Hh,{className:"h-4 w-4"}),"Cupons"]}),n.jsxs(pr,{value:"promocoes",className:"gap-2",children:[n.jsx(Oa,{className:"h-4 w-4"}),"Promoes"]}),n.jsxs(pr,{value:"brindes",className:"gap-2",children:[n.jsx(Rn,{className:"h-4 w-4"}),"Brindes"]}),n.jsxs(pr,{value:"loyalty",className:"flex items-center gap-2",children:[n.jsx(Ei,{className:"h-4 w-4"}),"Clube"]}),n.jsxs(pr,{value:"rfv",className:"flex items-center gap-2 bg-purple-50 text-purple-700 data-[state=active]:bg-purple-600 data-[state=active]:text-white",children:[n.jsx(XS,{className:"h-4 w-4"}),"Copiloto RFV"]}),n.jsxs(pr,{value:"sellers",className:"flex items-center gap-2",children:[n.jsx(hk,{className:"h-4 w-4"}),"Equipe"]}),n.jsxs(pr,{value:"prints",className:"gap-2",children:[n.jsx(sk,{className:"h-4 w-4"}),"Prints (",p.length,")"]})]}),n.jsx(wr,{value:"overview",children:n.jsx(m2e,{})}),n.jsx(wr,{value:"products",children:n.jsx(sve,{userId:d.id,initialFilter:a||void 0})}),n.jsx(wr,{value:"orders",children:n.jsx(jye,{initialFilter:a||void 0})}),n.jsx(wr,{value:"prints",children:n.jsxs("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[p.map(E=>{const N=f.find(k=>k.id===E.customer_id),C=E.linked_product_id?v[E.linked_product_id]:null;return n.jsxs("div",{className:"bg-card rounded-xl border border-border overflow-hidden",children:[n.jsx("div",{className:"aspect-square bg-secondary",children:n.jsx("img",{src:H(E.image_path),alt:"Print do story",className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"p-4 space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${C?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700"}`,children:C?"Vinculado":"Pendente"}),n.jsx("span",{className:"text-xs text-muted-foreground",children:M(E.created_at)})]}),n.jsxs("div",{className:"text-sm space-y-1",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Tel:"})," ",(N==null?void 0:N.phone)||"-"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Tamanho:"})," ",E.size||"-"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Preferncia:"})," ",E.preference==="ajustado"?"Mais ajustado":"Mais soltinho"]})]}),C&&n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg",children:[n.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Produto vinculado:"}),n.jsxs("div",{className:"flex items-center gap-3",children:[C.image_url?n.jsx("img",{src:C.image_url,alt:C.name,className:"w-10 h-10 object-cover rounded"}):n.jsx("div",{className:"w-10 h-10 bg-secondary rounded flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:C.name}),n.jsx("p",{className:"text-xs text-muted-foreground",children:F(C.price)})]})]})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"w-full gap-2",onClick:()=>S(E),children:[n.jsx(Qz,{className:"h-4 w-4"}),C?"Alterar produto":"Vincular a produto"]})]})]},E.id)}),p.length===0&&n.jsx("div",{className:"col-span-full text-center py-12 text-muted-foreground",children:"Nenhum print recebido ainda."})]})}),n.jsx(wr,{value:"clientes",children:n.jsx(kye,{})}),n.jsx(wr,{value:"lives",children:n.jsx(Pye,{})}),n.jsx(wr,{value:"cupons",children:n.jsx(dwe,{})}),n.jsx(wr,{value:"promocoes",children:n.jsx(H2e,{})}),n.jsx(wr,{value:"brindes",children:n.jsx(j2e,{})}),n.jsx(wr,{value:"loyalty",children:n.jsx(I2e,{})}),n.jsx(wr,{value:"rfv",children:n.jsx(De,{className:"p-8 text-center border-dashed border-2 border-purple-200",children:n.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[n.jsx("div",{className:"bg-purple-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto",children:n.jsx(XS,{className:"h-8 w-8 text-purple-600"})}),n.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Motor de Recorrncia Inteligente"}),n.jsx("p",{className:"text-gray-600",children:"O Copiloto RFV analisa sua base de clientes, identifica quem est sumido e sugere as melhores mensagens para vender novamente."}),n.jsxs(he,{onClick:()=>e("/dashboard/copiloto-rfv"),className:"bg-purple-600 hover:bg-purple-700 gap-2",children:["Abrir Painel do Copiloto",n.jsx(ba,{className:"h-4 w-4"})]})]})})}),n.jsx(wr,{value:"sellers",children:n.jsx(g2e,{})})]})}),O&&n.jsx(ave,{open:j,onOpenChange:T,print:O,customerPhone:D,onSuccess:q})]}):null};function K2e(){const[e,t]=P.useState(new Set),[r,s]=P.useState([]),[a,i]=P.useState(!0),o=P.useCallback(async()=>{try{const{data:l,error:u}=await ce.from("live_products").select(`
          product_id,
          visibilidade,
          bloquear_desde_planejamento,
          live_event:live_events(id, titulo, status)
        `).eq("visibilidade","exclusivo_live");if(u)throw u;const h=[],f=new Set;(l||[]).forEach(m=>{var v,x;const p=(v=m.live_event)==null?void 0:v.status;(p==="ao_vivo"||p==="planejada"&&m.bloquear_desde_planejamento)&&(f.add(m.product_id),h.push({productId:m.product_id,liveTitle:((x=m.live_event)==null?void 0:x.titulo)||"Live",visibility:m.visibilidade}))}),t(f),s(h)}catch(l){console.error("Error fetching hidden products:",l)}finally{i(!1)}},[]);P.useEffect(()=>{o()},[o]);const c=P.useCallback(l=>e.has(l),[e]),d=P.useCallback(l=>{const u=r.find(h=>h.productId===l);return u?`Exclusivo da live "${u.liveTitle}"`:null},[r]);return{hiddenProductIds:e,hiddenInfo:r,isLoading:a,isProductHidden:c,getHiddenReason:d,refresh:o}}const BM=["Vestidos","Blusas","Calas","Saias","Conjuntos","Acessrios","Blazers"],$M=["Preto","Branco","Bege","Rosa","Azul","Verde","Vermelho","Marrom","Cinza","Estampado"],FM=["PP","P","M","G","GG","34","36","38","40","42","44","46"],X2e=[{label:"Trabalho",query:"trabalho"},{label:"Jantar",query:"jantar"},{label:"Evento",query:"evento"},{label:"Igreja",query:"igreja"},{label:"Viagem",query:"viagem"},{label:"Dia a dia chic",query:"dia_a_dia_chic"},{label:"Todas as peas",query:""}],Y2e=[{icon:en,label:"Troca fcil",desc:"Sem burocracia"},{icon:xs,label:"3x sem juros",desc:"No carto"},{icon:nn,label:"Suporte WhatsApp",desc:"Resposta rpida"},{icon:gn,label:"Envio Brasil",desc:"Todo o pas"}],Z2e=()=>{const[e,t]=kc(),[r,s]=P.useState([]),[a,i]=P.useState(!0),[o,c]=P.useState(""),[d,l]=P.useState(null),[u,h]=P.useState(null),[f,m]=P.useState([]),[p,g]=P.useState(""),[v,x]=P.useState("recent");P.useEffect(()=>{const J=e.get("occasion")||"";g(J)},[e]);const{isProductHidden:y}=K2e(),b=P.useMemo(()=>r.map(J=>J.id),[r]),{getAvailable:j,getAvailableSizes:T,getTotalAvailable:O,isProductOutOfStock:R,isSizeLowStock:D}=N1(b.length>0?b:void 0),{getEffectivePrice:L,getOriginalPrice:q,hasDiscount:X,getDiscountPercent:H}=$k({channel:"catalog",productIds:b.length>0?b:void 0,enabled:b.length>0});P.useEffect(()=>{async function J(){try{const{data:V,error:W}=await ce.from("product_catalog").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(W)throw W;s(V||[])}catch(V){console.error("Error loading products:",V)}finally{i(!1)}}J()},[]);const M=P.useMemo(()=>{let J=r;if(J=J.filter(V=>!y(V.id)),o){const V=o.toLowerCase();J=J.filter(W=>{var ee;return W.name.toLowerCase().includes(V)||((ee=W.category)==null?void 0:ee.toLowerCase().includes(V))})}if(p){const V=p.toLowerCase();J=J.filter(W=>{var ee,ie,oe;return((ee=W.tags)==null?void 0:ee.some(se=>typeof se=="string"&&se.toLowerCase().includes(V)))||((ie=W.style)==null?void 0:ie.toLowerCase().includes(V))||((oe=W.category)==null?void 0:oe.toLowerCase().includes(V))||W.name.toLowerCase().includes(V)||(Array.isArray(W.occasion)?W.occasion.some(se=>typeof se=="string"&&se.toLowerCase().includes(V)):typeof W.occasion=="string"&&W.occasion.toLowerCase().includes(V))})}switch(d&&(J=J.filter(V=>V.category===d)),u&&(J=J.filter(V=>V.color===u)),f.length>0&&(J=J.filter(V=>f.some(W=>j(V.id,W)>0))),v){case"price_asc":J=[...J].sort((V,W)=>V.price-W.price);break;case"price_desc":J=[...J].sort((V,W)=>W.price-V.price);break;case"name":J=[...J].sort((V,W)=>V.name.localeCompare(W.name));break}return J=[...J].sort((V,W)=>{const ee=O(V.id)<=0,ie=O(W.id)<=0;return ee&&!ie?1:!ee&&ie?-1:0}),J},[r,o,d,u,f,v,p,y,j,O]),F=[d,u].filter(Boolean).length+(f.length>0?1:0),S=J=>{m(V=>V.includes(J)?V.filter(W=>W!==J):[...V,J])},E=()=>{l(null),h(null),m([]),c(""),g("")},N=J=>T(J.id),C=J=>T(J.id).some(W=>D(J.id,W)),k=J=>R(J.id),I=J=>{if(J.images&&J.images.length>0){const V=J.main_image_index||0;return J.images[V]||J.images[0]}return J.image_url||void 0},U=J=>{g(J),t(J?{occasion:J}:{})},$=Math.ceil(M.length/2),Y=M.slice(0,$),Z=M.slice($),re=J=>{const V=k(J),W=!V&&C(J);return n.jsx(Gt,{to:`/produto/${J.id}`,children:n.jsxs("div",{className:"relative group",children:[V?n.jsx(Ae,{variant:"secondary",className:"absolute top-3 left-3 z-10 text-[10px] tracking-wider uppercase bg-muted/90 text-muted-foreground backdrop-blur-sm",children:"Esgotado"}):W?n.jsx(Ae,{className:"absolute top-3 left-3 z-10 text-[10px] tracking-wider uppercase bg-foreground/90 text-background backdrop-blur-sm",children:"ltimas unidades"}):null,n.jsx(_p,{name:J.name,price:q(J.id,J.price),effectivePrice:L(J.id,J.price),imageUrl:I(J),sizes:N(J),isOutOfStock:V,hasPromotionalDiscount:X(J.id),discountPercent:H(J.id)})]})},J.id)},G=({value:J,onChange:V,placeholder:W,options:ee,width:ie="w-[130px]"})=>n.jsxs(Kt,{value:J||"_all",onValueChange:oe=>V(oe==="_all"?null:oe),children:[n.jsx(Vt,{className:`${ie} border-foreground/15 bg-transparent text-xs tracking-wide`,children:n.jsx(Xt,{placeholder:W})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"_all",children:W}),ee.map(oe=>n.jsx(ze,{value:oe,children:oe},oe))]})]});return n.jsxs("div",{className:"min-h-screen flex flex-col bg-background",children:[n.jsx(Xm,{}),n.jsx(Cr,{}),n.jsxs("section",{className:"relative py-20 md:py-32 px-5 text-center bg-primary overflow-hidden",children:[n.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gold/5 rounded-full blur-3xl -mr-32 -mt-32"}),n.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-rose/5 rounded-full blur-3xl -ml-32 -mb-32"}),n.jsxs("div",{className:"relative z-10 max-w-4xl mx-auto",children:[n.jsx("span",{className:"text-gold text-[10px] tracking-[0.4em] uppercase font-bold mb-6 block",children:"Curadoria Exclusiva"}),n.jsxs("h1",{className:"font-serif text-4xl md:text-6xl lg:text-7xl text-white leading-tight mb-8",children:["Cada pea, uma ",n.jsx("span",{className:"italic",children:"histria"}),".",n.jsx("br",{}),"Cada look, sua ",n.jsx("span",{className:"italic",children:"identidade"}),"."]}),n.jsx("p",{className:"text-white/60 font-light text-lg md:text-xl max-w-2xl mx-auto leading-relaxed",children:"Uma seleo estratgica pensada para a mulher contempornea que no abre mo da sofisticao e praticidade."})]})]}),n.jsx("section",{className:"px-5 pb-10 md:pb-14",children:n.jsxs("div",{className:"max-w-3xl mx-auto",children:[n.jsx("p",{className:"text-center text-[10px] tracking-[0.3em] uppercase text-muted-foreground/60 mb-8 font-bold",children:"Filtrar por Ocasio"}),n.jsx("div",{className:"flex flex-wrap justify-center gap-x-6 gap-y-4 md:gap-x-8",children:X2e.map(J=>n.jsxs("button",{onClick:()=>U(J.query),className:"group relative",children:[n.jsx("span",{className:`
                    font-serif text-base md:text-lg transition-colors duration-300
                    ${p===J.query?"text-foreground":"text-foreground/50 hover:text-foreground/80"}
                  `,children:J.label}),n.jsx("span",{className:`
                    absolute -bottom-2 left-0 h-0.5 bg-gold transition-all duration-500
                    ${p===J.query?"w-full":"w-0 group-hover:w-full"}
                  `})]},J.query||"all"))})]})}),n.jsx("section",{className:"border-y border-foreground/8 bg-secondary/20",children:n.jsxs("div",{className:"max-w-6xl mx-auto px-5 py-4",children:[n.jsxs("div",{className:"flex flex-col md:flex-row gap-3 items-center",children:[n.jsxs("div",{className:"relative flex-1 w-full md:w-auto",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar por nome...",value:o,onChange:J=>c(J.target.value),className:"pl-10 border-foreground/15 bg-transparent text-sm"})]}),n.jsxs("div",{className:"flex gap-2 items-center",children:[n.jsxs(Tu,{children:[n.jsx(Bk,{asChild:!0,children:n.jsxs(he,{variant:"outline",size:"sm",className:"md:hidden gap-1.5 border-foreground/15 text-xs",children:[n.jsx(wd,{className:"h-3.5 w-3.5"}),"Filtros",F>0&&n.jsx("span",{className:"bg-accent text-white text-[10px] rounded-full w-4 h-4 flex items-center justify-center",children:F})]})}),n.jsxs(fd,{side:"right",children:[n.jsx(Pu,{children:n.jsx(cf,{className:"font-serif",children:"Filtros"})}),n.jsxs("div",{className:"space-y-6 mt-6",children:[n.jsxs("div",{children:[n.jsx("label",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-2 block",children:"Categoria"}),n.jsx(G,{value:d,onChange:l,placeholder:"Todas",options:BM,width:"w-full"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-2 block",children:"Cor"}),n.jsx(G,{value:u,onChange:h,placeholder:"Todas",options:$M,width:"w-full"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-3 block",children:"Tamanho"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:FM.map(J=>n.jsx("button",{onClick:()=>S(J),className:`
                              px-3 py-1.5 text-xs tracking-wide border rounded-full transition-all duration-200
                              ${f.includes(J)?"bg-foreground text-background border-foreground":"border-foreground/20 text-foreground/70 hover:border-foreground/40"}
                            `,children:J},J))})]}),F>0&&n.jsx(he,{variant:"ghost",onClick:E,className:"w-full text-xs tracking-wide",children:"Limpar filtros"})]})]})]}),n.jsxs("div",{className:"hidden md:flex gap-2",children:[n.jsx(G,{value:d,onChange:l,placeholder:"Categoria",options:BM}),n.jsx(G,{value:u,onChange:h,placeholder:"Cor",options:$M,width:"w-[110px]"}),n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs("button",{className:"inline-flex items-center gap-1.5 h-10 px-3 border border-foreground/15 bg-transparent text-xs tracking-wide rounded-md hover:bg-secondary/50 transition-colors",children:[f.length>0?`${f.length} tam.`:"Tamanho",n.jsx(Zi,{className:"h-3.5 w-3.5 text-muted-foreground"})]})}),n.jsxs(Za,{align:"start",className:"w-auto p-3",children:[n.jsx("p",{className:"text-[10px] tracking-[0.15em] uppercase text-muted-foreground font-medium mb-2",children:"Tamanho"}),n.jsx("div",{className:"flex flex-wrap gap-1.5 max-w-[220px]",children:FM.map(J=>n.jsx("button",{onClick:()=>S(J),className:`
                            px-2.5 py-1 text-xs tracking-wide border rounded-full transition-all duration-200
                            ${f.includes(J)?"bg-foreground text-background border-foreground":"border-foreground/20 text-foreground/70 hover:border-foreground/40"}
                          `,children:J},J))}),f.length>0&&n.jsx("button",{onClick:()=>m([]),className:"mt-2 text-[10px] text-muted-foreground hover:text-foreground transition-colors",children:"Limpar tamanhos"})]})]})]}),n.jsxs(Kt,{value:v,onValueChange:x,children:[n.jsx(Vt,{className:"w-[130px] border-foreground/15 bg-transparent text-xs tracking-wide",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"recent",children:"Mais recentes"}),n.jsx(ze,{value:"price_asc",children:"Menor preo"}),n.jsx(ze,{value:"price_desc",children:"Maior preo"}),n.jsx(ze,{value:"name",children:"A-Z"})]})]})]})]}),(F>0||p)&&n.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 pt-3 border-t border-foreground/5",children:[p&&n.jsxs("button",{onClick:()=>U(""),className:"inline-flex items-center gap-1 px-3 py-1 text-[11px] tracking-wide border border-accent/30 text-accent rounded-full hover:bg-accent/5 transition-colors",children:[p,n.jsx(an,{className:"h-3 w-3"})]}),d&&n.jsxs("button",{onClick:()=>l(null),className:"inline-flex items-center gap-1 px-3 py-1 text-[11px] tracking-wide border border-foreground/15 rounded-full hover:bg-secondary transition-colors",children:[d,n.jsx(an,{className:"h-3 w-3"})]}),u&&n.jsxs("button",{onClick:()=>h(null),className:"inline-flex items-center gap-1 px-3 py-1 text-[11px] tracking-wide border border-foreground/15 rounded-full hover:bg-secondary transition-colors",children:[u,n.jsx(an,{className:"h-3 w-3"})]}),f.map(J=>n.jsxs("button",{onClick:()=>S(J),className:"inline-flex items-center gap-1 px-3 py-1 text-[11px] tracking-wide border border-foreground/15 rounded-full hover:bg-secondary transition-colors",children:["Tam ",J,n.jsx(an,{className:"h-3 w-3"})]},J)),n.jsx("button",{onClick:E,className:"text-[11px] tracking-wide text-muted-foreground hover:text-foreground transition-colors",children:"Limpar todos"})]})]})}),n.jsx("div",{className:"max-w-6xl mx-auto px-5 pt-6 pb-2",children:n.jsxs("p",{className:"text-[11px] tracking-[0.15em] uppercase text-muted-foreground font-medium",children:[M.length," ",M.length===1?"pea":"peas",p?` para ${p}`:""]})}),n.jsx("main",{className:"max-w-6xl mx-auto px-5 py-6",children:a?n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6",children:[...Array(8)].map((J,V)=>n.jsxs("div",{className:"animate-pulse",children:[n.jsx("div",{className:"aspect-[3/4] bg-secondary mb-3"}),n.jsx("div",{className:"h-3 bg-secondary w-3/4 mb-2"}),n.jsx("div",{className:"h-3 bg-secondary w-1/2"})]},V))}):M.length===0?n.jsxs("div",{className:"text-center py-20",children:[n.jsx("p",{className:"font-serif text-xl mb-2",children:"Nenhuma pea encontrada"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Tente remover alguns filtros ou explorar outra ocasio."}),n.jsx(he,{variant:"outline",onClick:E,className:"text-xs tracking-wide",children:"Limpar filtros"})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6",children:Y.map(re)}),M.length>3&&n.jsxs("section",{className:"my-16 md:my-24 py-16 md:py-24 px-5 bg-secondary/30 rounded-[3rem] border border-gold/10 overflow-hidden relative",children:[n.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-gold/5 rounded-full blur-3xl"}),n.jsxs("div",{className:"relative z-10 max-w-2xl mx-auto text-center",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-gold/10 text-gold flex items-center justify-center mx-auto mb-8 shadow-sm",children:n.jsx(Wr,{className:"h-6 w-6"})}),n.jsxs("h2",{className:"font-serif text-3xl md:text-5xl mb-6 text-primary italic",children:["Descubra o estilo que ",n.jsx("br",{})," mais valoriza voc."]}),n.jsx("p",{className:"text-muted-foreground font-light text-base md:text-lg mb-10 max-w-md mx-auto leading-relaxed",children:"Nossa IA analisa suas preferncias para sugerir as peas perfeitas para seu biotipo e rotina."}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[n.jsx(Gt,{to:"/meu-estilo",children:n.jsx("button",{className:"btn-gold px-12 py-4 rounded-full text-[10px] tracking-[0.2em] uppercase font-bold",children:"Quero meu Provador VIP"})}),n.jsx(Gt,{to:"/enviar-print",children:n.jsx("button",{className:"px-12 py-4 rounded-full border border-primary/20 text-primary text-[10px] tracking-[0.2em] uppercase font-bold hover:bg-white/50 transition-all backdrop-blur-sm",children:"Buscar por Foto"})})]})]})]}),Z.length>0&&n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6",children:Z.map(re)})]})}),n.jsx("section",{className:"py-14 md:py-20 px-5 bg-[hsl(35,30%,94%)]/60",children:n.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[n.jsx("span",{className:"text-xs tracking-[0.2em] uppercase text-accent font-medium",children:"Por que escolher a LE.PO"}),n.jsx("h2",{className:"font-serif text-2xl md:text-3xl mt-2 mb-3",children:"Mais de 8 anos vestindo mulheres reais."}),n.jsx("p",{className:"text-muted-foreground text-sm font-light mb-10 max-w-md mx-auto",children:"No somos s uma loja. Somos sua parceira de estilo para cada momento da sua vida."}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-8",children:Y2e.map(J=>n.jsxs("div",{className:"flex flex-col items-center gap-3 group",children:[n.jsx("div",{className:"w-14 h-14 rounded-full bg-card border border-border flex items-center justify-center shadow-sm group-hover:shadow-md group-hover:border-accent/40 transition-all duration-300",children:n.jsx(J.icon,{className:"h-6 w-6 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:J.label}),n.jsx("p",{className:"text-xs text-muted-foreground",children:J.desc})]})]},J.label))})]})}),n.jsx("section",{className:"py-16 md:py-24 px-5",children:n.jsxs("div",{className:"max-w-2xl mx-auto text-center",children:[n.jsx("div",{className:"w-px h-12 bg-accent/40 mx-auto mb-6"}),n.jsx("h2",{className:"font-serif text-3xl md:text-4xl mb-4 italic",children:"Pronta para se sentir incrvel?"}),n.jsx("p",{className:"text-muted-foreground font-light mb-8 max-w-md mx-auto",children:"Monte seu provador VIP em 2 minutos e receba sugestes personalizadas direto no seu WhatsApp."}),n.jsx(Gt,{to:"/meu-estilo",children:n.jsx("button",{className:"px-12 py-4 bg-foreground text-background text-xs tracking-[0.25em] uppercase font-medium transition-all duration-500 hover:bg-accent hover:text-white",children:"Quero meu provador VIP"})}),n.jsx("p",{className:"text-[11px] text-muted-foreground mt-6 tracking-wide",children:"Gratuito  Leva menos de 2 minutos"})]})}),n.jsx("footer",{className:"border-t border-border py-10 px-5",children:n.jsxs("div",{className:"max-w-5xl mx-auto",children:[n.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-6",children:[n.jsxs("div",{className:"text-center md:text-left",children:[n.jsx("p",{className:"font-serif text-lg mb-1",children:"LE.PO"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Curadoria de moda feminina  Anpolis, GO"})]}),n.jsxs("div",{className:"flex items-center gap-5 text-sm text-muted-foreground",children:[n.jsx(Gt,{to:"/catalogo",className:"hover:text-foreground transition-colors",children:"Catlogo"}),n.jsx(Gt,{to:"/meu-estilo",className:"hover:text-foreground transition-colors",children:"Provador VIP"}),n.jsx(Gt,{to:"/enviar-print",className:"hover:text-foreground transition-colors",children:"Buscar por foto"}),n.jsx("a",{href:No("Ol! Gostaria de saber mais sobre a LE.PO "),target:"_blank",rel:"noopener noreferrer",className:"hover:text-foreground transition-colors",children:"WhatsApp"})]})]}),n.jsxs("div",{className:"border-t border-border mt-6 pt-6 flex flex-col sm:flex-row items-center justify-between gap-2",children:[n.jsxs("p",{className:"text-xs text-muted-foreground",children:[" ",new Date().getFullYear()," LE.PO. Todos os direitos reservados."]}),n.jsx(Gt,{to:"/area-lojista",className:"text-[10px] text-muted-foreground/40 hover:text-muted-foreground transition-colors",children:"rea do Lojista"})]})]})})]})};function MG(){const{user:e}=Hn(),[t,r]=P.useState([]),[s,a]=P.useState(!1),i=P.useCallback(async()=>{if(!e){r([]);return}try{const{data:d,error:l}=await ce.from("customer_favorites").select("product_id").eq("user_id",e.id);if(l)throw l;r((d==null?void 0:d.map(u=>u.product_id))||[])}catch(d){console.error("Error loading favorites:",d)}},[e]);P.useEffect(()=>{i()},[i]);const o=P.useCallback(d=>t.includes(d),[t]),c=P.useCallback(async d=>{if(!e)return!1;a(!0);const l=t.includes(d);try{if(l){const{error:u}=await ce.from("customer_favorites").delete().eq("user_id",e.id).eq("product_id",d);if(u)throw u;r(h=>h.filter(f=>f!==d)),de.success("Removido dos favoritos")}else{const{error:u}=await ce.from("customer_favorites").insert({user_id:e.id,product_id:d});if(u)throw u;r(h=>[...h,d]),de.success("Adicionado aos favoritos ")}return!0}catch(u){return console.error("Error toggling favorite:",u),de.error("Erro ao atualizar favoritos"),!1}finally{a(!1)}},[e,t]);return{favorites:t,isFavorite:o,toggleFavorite:c,isLoading:s,refetch:i}}const Q2e=()=>{var J;const{productId:e}=ra(),[t]=kc(),r=fr(),{addItem:s}=Wu(),{user:a}=Hn(),{trackEvent:i}=Wk(),{isFavorite:o,toggleFavorite:c,isLoading:d}=MG(),[l,u]=P.useState(null),[h,f]=P.useState([]),[m,p]=P.useState(null),[g,v]=P.useState(0),[x,y]=P.useState(!1),[b,j]=P.useState(!0),{availableSizes:T,available:O,isLowStock:R,isProductOutOfStock:D,isLoading:L}=Jfe(e),{effectivePrice:q,originalPrice:X,hasDiscount:H,discountPercent:M,promotionName:F,isLoading:S}=Qfe(e,"catalog");P.useEffect(()=>{async function V(){if(e)try{const{data:W,error:ee}=await ce.from("product_catalog").select("*").eq("id",e).single();if(ee)throw ee;if(u(W),v(W.main_image_index||0),W){const{data:ie,error:oe}=await ce.from("product_catalog").select("*").eq("is_active",!0).neq("id",e).or(`category.eq.${W.category},style.eq.${W.style}`).limit(4);oe||f(ie||[])}}catch(W){console.error("Error loading product:",W),de.error("Produto no encontrado")}finally{j(!1)}}V()},[e]);const E=V=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(V),N=(J=l==null?void 0:l.images)!=null&&J.length?l.images:l!=null&&l.image_url?[l.image_url]:[],C=H?q:(l==null?void 0:l.price)||0,k=H||(l==null?void 0:l.discount_value)&&l.discount_value>0,I=H?M>0?`-${M}%`:`-R$ ${((X||(l==null?void 0:l.price)||0)-q).toFixed(2)}`:null,U=()=>{if(!l||!e)return;if(!m){de.error("Selecione um tamanho");return}if(O(m)<=0){de.error("Tamanho esgotado no momento");return}s({productId:l.id,name:l.name,price:C,originalPrice:l.price,discountPercent:M,size:m,imageUrl:N[0]||l.image_url,fromAI:t.get("from")==="ai_look"}),t.get("from")==="ai_look"&&i("ai_look_add_to_cart",{product_id:e,size:m,price:C}),de.success("Adicionado ao carrinho!"),r("/carrinho")},$=async()=>{try{await navigator.share({title:l==null?void 0:l.name,text:`Confira essa pea linda: ${l==null?void 0:l.name}`,url:window.location.href})}catch{navigator.clipboard.writeText(window.location.href),de.success("Link copiado!")}},Y=async()=>{if(!a){de.info("Faa login para salvar favoritos"),r("/entrar");return}e&&await c(e)},Z=e?o(e):!1,re=()=>{N.length>0&&(v(V=>(V+1)%N.length),y(!1))},G=()=>{N.length>0&&(v(V=>(V-1+N.length)%N.length),y(!1))};return b||L||S?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Xm,{}),n.jsx(Cr,{}),n.jsx("div",{className:"container mx-auto px-4 py-8",children:n.jsxs("div",{className:"animate-pulse",children:[n.jsx("div",{className:"aspect-[3/4] md:aspect-square bg-secondary rounded-xl mb-6"}),n.jsx("div",{className:"h-6 bg-secondary rounded w-3/4 mb-3"}),n.jsx("div",{className:"h-8 bg-secondary rounded w-1/3"})]})})]}):l?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Xm,{}),n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-6",children:[n.jsxs(Gt,{to:"/catalogo",className:"inline-flex items-center gap-2 text-[10px] tracking-[0.2em] uppercase font-bold text-primary/40 hover:text-primary mb-8 group transition-colors",children:[n.jsx(vs,{className:"h-4 w-4 transition-transform group-hover:-translate-x-1"}),"Voltar ao catlogo"]}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"relative aspect-[3/4] bg-secondary rounded-[2.5rem] overflow-hidden shadow-2xl",children:[x&&l.video_url?n.jsx("video",{src:l.video_url,controls:!0,autoPlay:!0,className:"w-full h-full object-contain bg-black"}):N.length>0?n.jsx("img",{src:N[g],alt:l.name,className:"w-full h-full object-cover animate-fade-in"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-16 w-16 text-muted-foreground"})}),N.length>1&&!x&&n.jsxs(n.Fragment,{children:[n.jsx(he,{variant:"ghost",size:"icon",className:"absolute left-4 top-1/2 -translate-y-1/2 h-12 w-12 rounded-full bg-white/10 backdrop-blur-md text-white border border-white/20 hover:bg-white/20 transition-all",onClick:G,children:n.jsx(Gz,{className:"h-6 w-6"})}),n.jsx(he,{variant:"ghost",size:"icon",className:"absolute right-4 top-1/2 -translate-y-1/2 h-12 w-12 rounded-full bg-white/10 backdrop-blur-md text-white border border-white/20 hover:bg-white/20 transition-all",onClick:re,children:n.jsx(Dn,{className:"h-6 w-6"})})]})]}),(N.length>1||l.video_url)&&n.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-2",children:[N.map((V,W)=>n.jsx("button",{onClick:()=>{v(W),y(!1)},className:`flex-shrink-0 w-16 h-20 rounded-lg overflow-hidden border-2 transition-colors ${g===W&&!x?"border-accent":"border-transparent"}`,children:n.jsx("img",{src:V,alt:"",className:"w-full h-full object-cover"})},W)),l.video_url&&n.jsx("button",{onClick:()=>y(!0),className:`flex-shrink-0 w-16 h-20 rounded-lg overflow-hidden border-2 transition-colors bg-black flex items-center justify-center ${x?"border-accent":"border-transparent"}`,children:n.jsx(ck,{className:"h-6 w-6 text-white"})})]})]}),n.jsxs("div",{className:"space-y-6",children:[l.category&&n.jsx("span",{className:"text-gold text-[10px] tracking-[0.4em] uppercase font-bold mb-3 block",children:l.category}),n.jsx("h1",{className:"font-serif text-4xl md:text-5xl lg:text-6xl text-primary leading-tight lowercase",children:l.name}),n.jsx("div",{className:"flex items-center gap-4 py-4 border-y border-primary/5",children:k?n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-3xl font-bold text-primary",children:E(C)}),n.jsx("p",{className:"text-xl text-primary/30 line-through font-light",children:E(X||l.price)}),I&&n.jsxs("div",{className:"px-3 py-1 bg-gold/10 text-gold text-[10px] font-bold tracking-widest uppercase rounded-full border border-gold/10",children:["OFF ",I]})]}):n.jsx("p",{className:"text-3xl font-bold text-primary",children:E(l.price)})}),l.description&&n.jsx("p",{className:"text-muted-foreground",children:l.description}),n.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[l.color&&n.jsxs("p",{children:[n.jsx("span",{className:"font-medium text-foreground",children:"Cor:"})," ",l.color]}),l.style&&n.jsxs("p",{children:[n.jsx("span",{className:"font-medium text-foreground",children:"Estilo:"})," ",l.style]}),l.occasion&&n.jsxs("p",{children:[n.jsx("span",{className:"font-medium text-foreground",children:"Ocasio:"})," ",l.occasion]}),l.modeling&&n.jsxs("p",{children:[n.jsx("span",{className:"font-medium text-foreground",children:"Modelagem:"})," ",l.modeling]})]}),T.length>0?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("label",{className:"text-[10px] tracking-[0.2em] uppercase font-bold text-primary/60",children:"Selecione seu Tamanho"}),n.jsx("button",{className:"text-[10px] tracking-[0.2em] uppercase font-bold text-gold underline underline-offset-4",children:"Tabela de Medidas"})]}),n.jsx("div",{className:"flex flex-wrap gap-3",children:T.map(V=>{const W=R(V);return n.jsxs("button",{onClick:()=>p(V===m?null:V),className:`
                          min-w-[56px] h-14 rounded-full border-2 transition-all duration-300 text-sm font-bold tracking-wider
                          ${m===V?"border-gold bg-gold text-white shadow-lg shadow-gold/20":"border-primary/5 bg-white text-primary/60 hover:border-primary/20"}
                          ${W&&m!==V?"relative":""}
                        `,children:[V,W&&m!==V&&n.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 rounded-full bg-gold animate-pulse"})]},V)})}),m&&R(m)&&n.jsxs("p",{className:"text-xs text-destructive mt-2 flex items-center gap-1",children:[n.jsx(Cn,{className:"h-3 w-3"}),"ltimas unidades disponveis!"]})]}):n.jsx("div",{className:"p-4 bg-muted rounded-lg text-center",children:n.jsx("p",{className:"text-muted-foreground",children:"Produto esgotado"})}),n.jsxs("div",{className:"flex flex-col gap-4 pt-4",children:[n.jsxs(he,{size:"lg",onClick:U,className:`
                  h-16 rounded-full text-[10px] tracking-[0.3em] uppercase font-bold transition-all duration-500 shadow-xl
                  ${!m||D?"bg-primary/5 text-primary/20":"btn-gold text-white"}
                `,disabled:!m||T.length===0||D,children:[n.jsx(ln,{className:"h-5 w-5 mr-2"}),T.length===0||D?"Indisponvel no Momento":m?"Adicionar ao Provador":"Escolha o seu Tamanho"]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsxs(he,{variant:"outline",size:"lg",className:`flex-1 gap-2 ${Z?"text-destructive border-destructive":""}`,onClick:Y,disabled:d,children:[n.jsx(El,{className:`h-5 w-5 ${Z?"fill-current":""}`}),Z?"Favoritado":"Favoritar"]}),n.jsx(he,{variant:"outline",size:"lg",onClick:$,className:"gap-2",children:n.jsx(_ae,{className:"h-5 w-5"})})]})]})]})]}),h.length>0&&n.jsxs("section",{className:"mt-16",children:[n.jsx("h2",{className:"font-serif text-2xl mb-6",children:"Voc tambm pode gostar"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6",children:h.map(V=>{var W;return n.jsx(Gt,{to:`/produto/${V.id}`,children:n.jsx(_p,{name:V.name,price:V.price,imageUrl:((W=V.images)==null?void 0:W[V.main_image_index||0])||V.image_url||void 0,sizes:vH(V.stock_by_size)})},V.id)})})]})]}),n.jsx("footer",{className:"py-8 border-t border-border mt-12",children:n.jsx("div",{className:"container mx-auto px-4 text-center text-sm text-muted-foreground",children:n.jsx("p",{children:" 2024 Provador VIP. Feito com  para lojistas de moda."})})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Xm,{}),n.jsx(Cr,{}),n.jsxs("div",{className:"container mx-auto px-4 py-16 text-center",children:[n.jsx(Ut,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-4",children:"Produto no encontrado"}),n.jsx(Gt,{to:"/catalogo",children:n.jsx(he,{variant:"outline",children:"Ver catlogo"})})]})]})};function Hy(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const J2e=()=>{const e=fr(),{items:t,removeItem:r,updateQuantity:s,total:a,itemCount:i,gifts:o}=Wu(),c=t.map(h=>h.productId),{getAvailable:d,isLoading:l}=N1(c),u=(h,f,m)=>{const p=d(h,f);if(m>=p){de.error(`Limite do estoque disponvel (${p} un.)`);return}s(h,f,m+1)};return t.length===0?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx(ln,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Seu carrinho est vazio"}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Que tal encontrar algo especial?"}),n.jsx(he,{onClick:()=>e("/catalogo"),children:"Ver catlogo"})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-lg",children:[n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>e(-1),className:"mb-4",children:[n.jsx(vs,{className:"h-4 w-4 mr-1"}),"Voltar"]}),n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsx(ln,{className:"h-6 w-6 text-accent"}),n.jsxs("h1",{className:"font-serif text-2xl",children:["Meu Carrinho (",i,")"]})]}),n.jsx("div",{className:"space-y-4 mb-8",children:t.map(h=>n.jsx(De,{children:n.jsxs(Be,{className:"p-4 flex gap-4",children:[n.jsx("div",{className:"w-20 h-24 bg-stone-50 rounded-lg flex items-center justify-center overflow-hidden",children:h.imageUrl?n.jsx("img",{src:h.imageUrl,alt:h.name,className:"w-full h-full object-contain"}):n.jsx(Ut,{className:"h-8 w-8 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("h3",{className:"font-medium line-clamp-1",children:h.name}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Tamanho: ",h.size]}),h.discountPercent>0?n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:"font-semibold text-green-600",children:Hy(h.price)}),n.jsx("span",{className:"text-xs text-muted-foreground line-through",children:Hy(h.originalPrice)}),n.jsxs(Ae,{variant:"secondary",className:"bg-green-100 text-green-700 text-[10px] px-1 py-0",children:[n.jsx(Oa,{className:"h-2.5 w-2.5 mr-0.5"}),"-",h.discountPercent,"%"]})]}):n.jsx("p",{className:"font-semibold text-accent mt-1",children:Hy(h.price)})]}),n.jsxs("div",{className:"flex flex-col items-end justify-between",children:[n.jsx(he,{variant:"ghost",size:"icon",className:"h-8 w-8 text-destructive",onClick:()=>r(h.productId,h.size),children:n.jsx(mi,{className:"h-4 w-4"})}),n.jsxs("div",{className:"flex flex-col items-end gap-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(he,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>s(h.productId,h.size,h.quantity-1),children:n.jsx(vp,{className:"h-3 w-3"})}),n.jsx("span",{className:"w-6 text-center text-sm font-medium",children:h.quantity}),n.jsx(he,{variant:"outline",size:"icon",className:"h-7 w-7",onClick:()=>u(h.productId,h.size,h.quantity),disabled:l||h.quantity>=d(h.productId,h.size),children:n.jsx(An,{className:"h-3 w-3"})})]}),!l&&h.quantity>=d(h.productId,h.size)&&n.jsxs("span",{className:"text-[10px] text-destructive flex items-center gap-0.5",children:[n.jsx(Cn,{className:"h-3 w-3"}),"Mx. disponvel"]})]})]})]})},`${h.productId}-${h.size}`))}),o&&o.length>0&&n.jsxs("div",{className:"space-y-4 mb-8",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Rn,{className:"h-5 w-5 text-green-600"}),n.jsx("h2",{className:"font-serif text-lg text-green-700",children:"Seus Brindes"})]}),o.map(h=>n.jsx(De,{className:"border-green-200 bg-green-50/30",children:n.jsxs(Be,{className:"p-4 flex gap-4",children:[n.jsx("div",{className:"w-20 h-24 bg-white rounded-lg flex items-center justify-center overflow-hidden border border-green-100",children:h.imageUrl?n.jsx("img",{src:h.imageUrl,alt:h.name,className:"w-full h-full object-contain"}):n.jsx(Rn,{className:"h-8 w-8 text-green-500"})}),n.jsx("div",{className:"flex-1",children:n.jsx("div",{className:"flex items-start justify-between",children:n.jsxs("div",{children:[n.jsx("h3",{className:"font-medium line-clamp-1 text-green-900",children:h.name}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsxs(Ae,{className:"bg-green-500 hover:bg-green-600 border-none",children:[n.jsx(Rn,{className:"h-3 w-3 mr-1"}),"GRTIS"]}),n.jsx("span",{className:"text-xs text-green-700 font-medium hidden sm:inline",children:"Mimo especial pra voc!"})]})]})})}),n.jsx("div",{className:"flex flex-col items-end justify-center",children:n.jsx("div",{className:"flex items-center gap-2 bg-white/50 px-3 py-1 rounded-full border border-green-100",children:n.jsxs("span",{className:"text-sm font-medium text-green-800",children:[h.quantity," un"]})})})]})},`gift-${h.productId}`))]}),n.jsx(De,{className:"mb-6",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex justify-between items-center text-lg",children:[n.jsx("span",{className:"font-medium",children:"Total"}),n.jsx("span",{className:"font-bold text-accent",children:Hy(a)})]})})}),n.jsx(he,{className:"w-full",size:"lg",onClick:()=>e("/checkout"),children:"Finalizar pedido"})]})]})};var R8="Radio",[e_e,IG]=ta(R8),[t_e,r_e]=e_e(R8),DG=P.forwardRef((e,t)=>{const{__scopeRadio:r,name:s,checked:a=!1,required:i,disabled:o,value:c="on",onCheck:d,form:l,...u}=e,[h,f]=P.useState(null),m=Ir(t,v=>f(v)),p=P.useRef(!1),g=h?l||!!h.closest("form"):!0;return n.jsxs(t_e,{scope:r,checked:a,disabled:o,children:[n.jsx(er.button,{type:"button",role:"radio","aria-checked":a,"data-state":FG(a),"data-disabled":o?"":void 0,disabled:o,value:c,...u,ref:m,onClick:kt(e.onClick,v=>{a||d==null||d(),g&&(p.current=v.isPropagationStopped(),p.current||v.stopPropagation())})}),g&&n.jsx($G,{control:h,bubbles:!p.current,name:s,value:c,checked:a,required:i,disabled:o,form:l,style:{transform:"translateX(-100%)"}})]})});DG.displayName=R8;var LG="RadioIndicator",BG=P.forwardRef((e,t)=>{const{__scopeRadio:r,forceMount:s,...a}=e,i=r_e(LG,r);return n.jsx(Gs,{present:s||i.checked,children:n.jsx(er.span,{"data-state":FG(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t})})});BG.displayName=LG;var n_e="RadioBubbleInput",$G=P.forwardRef(({__scopeRadio:e,control:t,checked:r,bubbles:s=!0,...a},i)=>{const o=P.useRef(null),c=Ir(o,i),d=H_(r),l=k_(t);return P.useEffect(()=>{const u=o.current;if(!u)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(d!==r&&m){const p=new Event("click",{bubbles:s});m.call(u,r),u.dispatchEvent(p)}},[d,r,s]),n.jsx(er.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:c,style:{...a.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});$G.displayName=n_e;function FG(e){return e?"checked":"unchecked"}var s_e=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],ij="RadioGroup",[a_e,xet]=ta(ij,[Eg,IG]),zG=Eg(),UG=IG(),[i_e,o_e]=a_e(ij),VG=P.forwardRef((e,t)=>{const{__scopeRadioGroup:r,name:s,defaultValue:a,value:i,required:o=!1,disabled:c=!1,orientation:d,dir:l,loop:u=!0,onValueChange:h,...f}=e,m=zG(r),p=Cg(l),[g,v]=Yi({prop:i,defaultProp:a??null,onChange:h,caller:ij});return n.jsx(i_e,{scope:r,name:s,required:o,disabled:c,value:g,onValueChange:v,children:n.jsx(Xk,{asChild:!0,...m,orientation:d,dir:p,loop:u,children:n.jsx(er.div,{role:"radiogroup","aria-required":o,"aria-orientation":d,"data-disabled":c?"":void 0,dir:p,...f,ref:t})})})});VG.displayName=ij;var qG="RadioGroupItem",WG=P.forwardRef((e,t)=>{const{__scopeRadioGroup:r,disabled:s,...a}=e,i=o_e(qG,r),o=i.disabled||s,c=zG(r),d=UG(r),l=P.useRef(null),u=Ir(t,l),h=i.value===a.value,f=P.useRef(!1);return P.useEffect(()=>{const m=g=>{s_e.includes(g.key)&&(f.current=!0)},p=()=>f.current=!1;return document.addEventListener("keydown",m),document.addEventListener("keyup",p),()=>{document.removeEventListener("keydown",m),document.removeEventListener("keyup",p)}},[]),n.jsx(Yk,{asChild:!0,...c,focusable:!o,active:h,children:n.jsx(DG,{disabled:o,required:i.required,checked:h,...d,...a,name:i.name,ref:u,onCheck:()=>i.onValueChange(a.value),onKeyDown:kt(m=>{m.key==="Enter"&&m.preventDefault()}),onFocus:kt(a.onFocus,()=>{var m;f.current&&((m=l.current)==null||m.click())})})})});WG.displayName=qG;var l_e="RadioGroupIndicator",HG=P.forwardRef((e,t)=>{const{__scopeRadioGroup:r,...s}=e,a=UG(r);return n.jsx(BG,{...a,...s,ref:t})});HG.displayName=l_e;var GG=VG,KG=WG,c_e=HG;const wc=P.forwardRef(({className:e,...t},r)=>n.jsx(GG,{className:We("grid gap-2",e),...t,ref:r}));wc.displayName=GG.displayName;const Wi=P.forwardRef(({className:e,...t},r)=>n.jsx(KG,{ref:r,className:We("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:n.jsx(c_e,{className:"flex items-center justify-center",children:n.jsx(Kz,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Wi.displayName=KG.displayName;const Zs={originZipCode:"75110-760",storeAddress:"Rua Luiz Frana, n 65, qd 32 lote 20 - Bairro Jundia - Anpolis/GO",storeHours:"Segunda a Sexta: 9h s 18h | Sbado: 9h s 13h",motoboyFee:10,motoboyDeliveryText:"Entrega rpida em Anpolis",defaultWeight:.3,defaultLength:30,defaultWidth:20,defaultHeight:10};function M8(){const[e,t]=P.useState(!1),[r,s]=P.useState(null),[a,i]=P.useState(null),o=P.useCallback(()=>{i(null),s(null),t(!1)},[]),c=P.useCallback(async d=>{var u;const l=d.replace(/\D/g,"");if(l.length!==8)return s("CEP deve ter 8 dgitos"),null;t(!0),s(null);try{const h=await fetch(`https://viacep.com.br/ws/${l}/json/`);if(!h.ok)throw new Error("Erro ao consultar CEP");const f=await h.json();if(f.erro)return s("CEP no encontrado"),i(null),null;const m={street:f.logradouro||"",neighborhood:f.bairro||"",city:f.localidade||"",state:f.uf||"",cep:((u=f.cep)==null?void 0:u.replace(/\D/g,""))||l};return i(m),s(null),m}catch(h){return console.error("CEP lookup error:",h),s("Erro ao buscar CEP. Tente novamente."),i(null),null}finally{t(!1)}},[]);return{isLoading:e,error:r,data:a,lookup:c,reset:o}}function fv(e){const t=e.replace(/\D/g,"").slice(0,8);return t.length<=5?t:`${t.slice(0,5)}-${t.slice(5,8)}`}const d_e=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"];function XG(e){const t=e.replace(/\D/g,"").slice(0,11);return t.length===0?"":t.length<=3?t:t.length<=6?`${t.slice(0,3)}.${t.slice(3)}`:t.length<=9?`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6)}`:`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6,9)}-${t.slice(9)}`}function Gy(e){return e.replace(/\D/g,"").length===11}function oj({value:e,onChange:t,showReference:r=!0,showCpf:s=!0,cpfRequired:a=!1,className:i,disabled:o=!1}){const c=M8(),[d,l]=P.useState(e.zipCode||""),[u,h]=P.useState(!1);P.useEffect(()=>{e.zipCode&&e.zipCode!==d.replace(/\D/g,"")&&l(fv(e.zipCode))},[e.zipCode]);const f=v=>{const x=fv(v.target.value);l(x),t({...e,zipCode:x.replace(/\D/g,"")}),h(!1)},m=async()=>{const v=d.replace(/\D/g,"");if(v.length===8&&!u){const x=await c.lookup(v);x&&(t({...e,zipCode:x.cep,street:x.street||e.street,neighborhood:x.neighborhood||e.neighborhood,city:x.city||e.city,state:x.state||e.state}),h(!0))}},p=async()=>{const v=d.replace(/\D/g,"");if(v.length===8){const x=await c.lookup(v);x&&(t({...e,zipCode:x.cep,street:x.street||e.street,neighborhood:x.neighborhood||e.neighborhood,city:x.city||e.city,state:x.state||e.state}),h(!0))}},g=(v,x)=>{t({...e,[v]:x})};return n.jsxs("div",{className:We("space-y-4",i),children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{htmlFor:"cep",className:"flex items-center gap-2",children:[n.jsx(_o,{className:"h-4 w-4"}),"CEP"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Qe,{id:"cep",value:d,onChange:f,onBlur:m,placeholder:"00000-000",maxLength:9,disabled:o,className:We(u&&"border-green-500 bg-green-50/50")}),u&&n.jsx(xn,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-green-600"})]}),n.jsx(he,{type:"button",variant:"outline",size:"icon",onClick:p,disabled:d.replace(/\D/g,"").length!==8||c.isLoading||o,children:c.isLoading?n.jsx(At,{className:"h-4 w-4 animate-spin"}):n.jsx(Ln,{className:"h-4 w-4"})})]}),c.error&&n.jsx("p",{className:"text-sm text-destructive",children:c.error}),u&&n.jsx("p",{className:"text-sm text-green-600",children:"Endereo preenchido automaticamente!"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"street",children:"Rua / Avenida"}),n.jsx(Qe,{id:"street",value:e.street,onChange:v=>g("street",v.target.value),placeholder:"Nome da rua ou avenida",disabled:o})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"number",children:"Nmero"}),n.jsx(Qe,{id:"number",value:e.number,onChange:v=>g("number",v.target.value),placeholder:"N",disabled:o})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"complement",children:"Complemento"}),n.jsx(Qe,{id:"complement",value:e.complement,onChange:v=>g("complement",v.target.value),placeholder:"Apto, Bloco, etc.",disabled:o})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"neighborhood",children:"Bairro"}),n.jsx(Qe,{id:"neighborhood",value:e.neighborhood,onChange:v=>g("neighborhood",v.target.value),placeholder:"Bairro",disabled:o})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"col-span-2 space-y-2",children:[n.jsx(Le,{htmlFor:"city",children:"Cidade"}),n.jsx(Qe,{id:"city",value:e.city,onChange:v=>g("city",v.target.value),placeholder:"Cidade",disabled:o})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Estado"}),n.jsxs(Kt,{value:e.state,onValueChange:v=>g("state",v),disabled:o,children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"UF"})}),n.jsx(qt,{children:d_e.map(v=>n.jsx(ze,{value:v,children:v},v))})]})]})]}),s&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{htmlFor:"cpf",children:["CPF ",a?n.jsx("span",{className:"text-red-500",children:"*"}):"(opcional)"]}),n.jsx(Qe,{id:"cpf",value:XG(e.document||""),onChange:v=>g("document",v.target.value.replace(/\D/g,"").slice(0,11)),placeholder:"000.000.000-00",maxLength:14,disabled:o,className:We(a&&!Gy(e.document||"")&&"border-red-500",!a&&e.document&&!Gy(e.document)&&"border-amber-500")}),a&&!Gy(e.document||"")&&n.jsx("p",{className:"text-xs text-red-600",children:"CPF obrigatrio para gerar etiqueta dos Correios (11 dgitos)"}),!a&&e.document&&!Gy(e.document)&&n.jsx("p",{className:"text-xs text-amber-600",children:"CPF deve ter 11 dgitos"})]}),r&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"reference",children:"Ponto de referncia (opcional)"}),n.jsx(Qe,{id:"reference",value:e.reference,onChange:v=>g("reference",v.target.value),placeholder:"Prximo a...",disabled:o})]})]})}function KC(e){let r=[e.street,e.number,e.complement,e.neighborhood,e.city,e.state].filter(Boolean).join(", ");return e.zipCode&&(r+=` - CEP ${fv(e.zipCode)}`),e.reference&&(r+=` (${e.reference})`),r}function XC(e,t,r,s,a,i){var u;let o=e||"",c="",d="",l="";if(e){const h=e.split(",").map(f=>f.trim());if(h.length>=2)if(o=h[0],/^\d+/.test(h[1])){c=((u=h[1].match(/^\d+/))==null?void 0:u[0])||"";const f=h[1].replace(/^\d+\s*/,"").trim();f&&(d=f),h[2]&&(l=h[2])}else l=h[1]}return{zipCode:(s==null?void 0:s.replace(/\D/g,""))||"",street:o,number:c,complement:d,neighborhood:l,city:t||"",state:r||"",reference:a||"",document:(i==null?void 0:i.replace(/\D/g,""))||""}}function YG(){const[e,t]=P.useState(null),[r,s]=P.useState(!1),[a,i]=P.useState(null),[o,c]=P.useState(0),d=f=>e?e.discount_type==="percentage"?f*(e.discount_value/100):Math.min(e.discount_value,f):0,l=async(f,m)=>{if(!f.trim())return i("Digite um cdigo de cupom"),!1;s(!0),i(null);try{const p=f.toUpperCase().trim(),{data:g,error:v}=await ce.from("coupons").select("*").eq("code",p).eq("is_active",!0).maybeSingle();if(v)throw v;if(!g)return await u(p,m)?!0:(i("Cupom no encontrado ou inativo"),t(null),c(0),!1);const x=g,y=new Date;if(x.starts_at&&new Date(x.starts_at)>y)return i("Este cupom ainda no est disponvel"),!1;if(x.ends_at&&new Date(x.ends_at)<y)return i("Este cupom expirou"),!1;if(x.max_uses&&x.times_used>=x.max_uses)return i("Este cupom atingiu o limite de usos"),!1;if(x.min_order_value&&m<x.min_order_value)return i(`Pedido mnimo de R$ ${x.min_order_value.toFixed(2)} para este cupom`),!1;t(x);const b=x.discount_type==="percentage"?m*(x.discount_value/100):Math.min(x.discount_value,m);return c(b),de.success(`Cupom aplicado! Desconto de R$ ${b.toFixed(2)}`),!0}catch(p){return console.error("Error applying coupon:",p),i("Erro ao validar cupom"),!1}finally{s(!1)}},u=async(f,m)=>{try{const{data:p,error:g}=await ce.from("birthday_discounts").select("id, coupon_code, discount_percent, used_at, expires_at, user_id").eq("coupon_code",f).maybeSingle();if(g||!p)return!1;if(p.used_at)return i("Este cupom de aniversrio j foi utilizado"),!1;if(p.expires_at&&new Date(p.expires_at)<new Date)return i("Este cupom de aniversrio expirou"),!1;const{data:{user:v}}=await ce.auth.getUser();if(!v||v.id!==p.user_id)return i("Este cupom pertence a outra conta"),!1;const x=m*(p.discount_percent/100),y={id:p.id,code:p.coupon_code,discount_type:"percentage",discount_value:p.discount_percent,starts_at:null,ends_at:p.expires_at,max_uses:1,times_used:0,min_order_value:null,is_active:!0,isBirthdayCoupon:!0,birthdayDiscountId:p.id};return t(y),c(x),de.success(` Cupom de aniversrio aplicado! ${p.discount_percent}% de desconto (R$ ${x.toFixed(2)})`),!0}catch(p){return console.error("Error checking birthday coupon:",p),!1}};return{coupon:e,isLoading:r,error:a,discountAmount:o,applyCoupon:l,removeCoupon:()=>{t(null),c(0),i(null)},calculateDiscount:d}}async function ZG(e,t,r,s,a){try{if(a){await ce.from("birthday_discounts").update({used_at:new Date().toISOString(),order_id:t}).eq("id",e);return}await ce.from("coupon_uses").insert({coupon_id:e,order_id:t,live_cart_id:r,discount_applied:s});const{data:i}=await ce.from("coupons").select("times_used").eq("id",e).single();i&&await ce.from("coupons").update({times_used:(i.times_used||0)+1}).eq("id",e)}catch(i){console.error("Error recording coupon use:",i)}}function QG({onApply:e,onRemove:t,appliedCoupon:r,isLoading:s,error:a,orderTotal:i,className:o}){const[c,d]=P.useState(""),l=async()=>{await e(c)&&d("")},u=h=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(h);return r?n.jsxs("div",{className:We("flex items-center justify-between p-3 bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800 rounded-lg",o),children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(xn,{className:"h-4 w-4 text-green-600"}),n.jsxs("div",{children:[n.jsx("span",{className:"font-mono font-bold text-green-700 dark:text-green-400",children:r.code}),n.jsxs("span",{className:"text-sm text-green-600 dark:text-green-400 ml-2",children:["-",u(r.discountAmount)]})]})]}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-600 hover:text-red-600",onClick:t,children:n.jsx(an,{className:"h-4 w-4"})})]}):n.jsxs("div",{className:We("space-y-2",o),children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Hh,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Cdigo do cupom",value:c,onChange:h=>d(h.target.value.toUpperCase()),className:"pl-10 font-mono",disabled:s})]}),n.jsx(he,{type:"button",variant:"outline",onClick:l,disabled:!c.trim()||s,children:s?n.jsx(At,{className:"h-4 w-4 animate-spin"}):"Aplicar"})]}),a&&n.jsx("p",{className:"text-xs text-destructive",children:a})]})}function u_e(e){const r=[e.street,e.number,e.complement,e.neighborhood].filter(Boolean).join(", "),s=[e.city,e.state].filter(Boolean).join(" - "),a=e.zipCode?`CEP ${e.zipCode}`:"";return[r,s,a].filter(Boolean).join(`
`)}function h_e(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function JG({address:e,onAddressConfirmed:t,onEditAddress:r,initialPeriod:s="qualquer",initialNotes:a=""}){const[i,o]=P.useState(!1),[c,d]=P.useState(s),[l,u]=P.useState(a),h=u_e(e),f=!!(e.street&&e.city&&e.state),m=()=>{o(!0),t({period:c,notes:l})};return f?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{className:"font-medium",children:"Confirme o endereo para entrega *"}),n.jsx(wc,{value:i?"confirmed":"",onValueChange:p=>{p==="confirmed"&&m()},children:n.jsxs("label",{className:`flex items-start gap-3 p-4 rounded-lg border-2 cursor-pointer transition-all hover:bg-muted/50 ${i?"border-green-500 bg-green-50":"border-muted hover:border-primary/50"}`,children:[n.jsx(Wi,{value:"confirmed",className:"mt-1"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(_o,{className:`h-4 w-4 shrink-0 ${i?"text-green-600":"text-muted-foreground"}`}),n.jsx("span",{className:`font-medium ${i?"text-green-800":""}`,children:"Endereo de entrega"})]}),i&&n.jsx(xn,{className:"h-5 w-5 text-green-600 shrink-0"})]}),n.jsx("pre",{className:"text-sm text-muted-foreground whitespace-pre-wrap font-sans mt-2",children:h}),e.reference&&n.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:[n.jsx("span",{className:"font-medium",children:"Ref:"})," ",e.reference]})]})]})}),n.jsxs(he,{variant:"outline",size:"sm",onClick:r,className:"mt-2",children:[n.jsx(ea,{className:"h-4 w-4 mr-2"}),"Editar endereo"]})]}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[n.jsx(Br,{className:"h-4 w-4 text-primary"}),n.jsx(Le,{className:"font-medium",children:"Perodo de entrega *"})]}),n.jsxs(wc,{value:c,onValueChange:p=>{d(p),i&&t({period:p,notes:l})},className:"space-y-2",children:[n.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-muted/50 ${c==="manha"?"border-primary bg-primary/5":""}`,children:[n.jsx(Wi,{value:"manha"}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Manh"}),n.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"(8h s 12h)"})]})]}),n.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-muted/50 ${c==="tarde"?"border-primary bg-primary/5":""}`,children:[n.jsx(Wi,{value:"tarde"}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Tarde"}),n.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"(13h s 18h)"})]})]}),n.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:bg-muted/50 ${c==="qualquer"?"border-primary bg-primary/5":""}`,children:[n.jsx(Wi,{value:"qualquer"}),n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:"Qualquer horrio"}),n.jsx("span",{className:"text-sm text-muted-foreground ml-2",children:"(8h s 18h)"})]})]})]})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsx(Le,{className:"font-medium mb-2 block",children:"Observaes para entrega"}),n.jsx(Yn,{value:l,onChange:p=>{u(p.target.value),i&&t({period:c,notes:p.target.value})},placeholder:"Ex: deixar na portaria / ao chegar ligar / casa de fundo / prximo ao mercado...",rows:3,className:"resize-none"})]})}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-primary/5 rounded-lg border border-primary/20",children:[n.jsx("span",{className:"text-sm font-medium",children:"Taxa de entrega Motoboy:"}),n.jsx("span",{className:"font-bold text-primary",children:h_e(Zs.motoboyFee)})]})]}):n.jsx(De,{className:"border-amber-200 bg-amber-50",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(_o,{className:"h-5 w-5 text-amber-600 mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-amber-800",children:"Endereo no cadastrado"}),n.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Para entrega via Motoboy, precisamos do seu endereo completo."}),n.jsxs(he,{variant:"outline",size:"sm",className:"mt-3 border-amber-300 text-amber-800 hover:bg-amber-100",onClick:r,children:[n.jsx(ea,{className:"h-4 w-4 mr-2"}),"Cadastrar endereo"]})]})]})})})}function eK(e,t){return e&&!!t}function tK({notes:e,onNotesChange:t}){return n.jsxs("div",{className:"space-y-4",children:[n.jsx(De,{className:"border-green-200 bg-green-50",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(pa,{className:"h-5 w-5 text-green-600 mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-green-800",children:"Retirar na Loja"}),n.jsx("p",{className:"text-sm text-green-700 mt-1",children:Zs.storeAddress}),n.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-green-600",children:[n.jsx(Br,{className:"h-4 w-4"}),n.jsx("span",{children:Zs.storeHours})]}),n.jsx("p",{className:"text-lg font-bold text-green-700 mt-2",children:"Grtis"})]})]})})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsx(Le,{className:"font-medium mb-2 block",children:"Observaes (opcional)"}),n.jsx(Yn,{value:e,onChange:r=>t(r.target.value),placeholder:"Ex: vou buscar amanh s 10h / outra pessoa vai retirar (nome)...",rows:3,className:"resize-none"})]})})]})}function f_e({userId:e,quotedZipCode:t,onAddressSelect:r,selectedAddressId:s,cpfRequired:a=!0,className:i}){const[o,c]=P.useState([]),[d,l]=P.useState(!0),[u,h]=P.useState(s||null),[f,m]=P.useState(!1),[p,g]=P.useState({zipCode:t,street:"",number:"",complement:"",neighborhood:"",city:"",state:"",reference:"",document:""}),v=t.replace(/\D/g,"");P.useEffect(()=>{async function R(){if(e){l(!0);try{const{data:D}=await ce.from("customers").select("id").eq("user_id",e).maybeSingle();if(D){const{data:L}=await ce.from("customer_addresses").select("*").eq("customer_id",D.id).order("is_default",{ascending:!1});if(L){c(L);const q=L.find(X=>{var H;return((H=X.zip_code)==null?void 0:H.replace(/\D/g,""))===v});q&&!u?(h(q.id),x(q)):!q&&L.length===0&&m(!0)}}else m(!0)}catch(D){console.error("Error loading addresses:",D)}finally{l(!1)}}}R()},[e,v]),P.useEffect(()=>{f&&g(R=>({...R,zipCode:v}))},[f,v]);const x=R=>{var L,q;const D={zipCode:((L=R.zip_code)==null?void 0:L.replace(/\D/g,""))||"",street:R.street||"",number:R.number||"",complement:R.complement||"",neighborhood:R.neighborhood||"",city:R.city||"",state:R.state||"",reference:R.reference||"",document:((q=R.document)==null?void 0:q.replace(/\D/g,""))||""};r(D,R.id)},y=R=>{g(R),R.zipCode.replace(/\D/g,"")===v&&R.street&&R.city&&R.state&&r(R,void 0)},b=()=>{h(null),m(!0),g({zipCode:v,street:"",number:"",complement:"",neighborhood:"",city:"",state:"",reference:"",document:""})},j=R=>{h(R.id),m(!1),x(R)},T=o.filter(R=>{var D;return((D=R.zip_code)==null?void 0:D.replace(/\D/g,""))===v}),O=o.filter(R=>{var D;return((D=R.zip_code)==null?void 0:D.replace(/\D/g,""))!==v});return d?n.jsxs("div",{className:"animate-pulse space-y-3",children:[n.jsx("div",{className:"h-20 bg-muted rounded-lg"}),n.jsx("div",{className:"h-20 bg-muted rounded-lg"})]}):n.jsxs("div",{className:We("space-y-4",i),children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(_o,{className:"h-4 w-4 text-primary"}),n.jsxs("span",{className:"font-medium",children:["Endereo de entrega para CEP ",v.replace(/(\d{5})(\d{3})/,"$1-$2")]})]}),T.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Endereos salvos para este CEP:"}),n.jsx(wc,{value:u||"",onValueChange:R=>{const D=T.find(L=>L.id===R);D&&j(D)},children:T.map(R=>n.jsx(zM,{address:R,isSelected:u===R.id&&!f,onSelect:()=>j(R),showWarning:!1},R.id))})]}),O.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Outros endereos salvos (CEP diferente):"}),n.jsx(wc,{value:u||"",onValueChange:R=>{const D=O.find(L=>L.id===R);D&&j(D)},children:O.map(R=>n.jsx(zM,{address:R,isSelected:u===R.id&&!f,onSelect:()=>j(R),showWarning:!0,quotedZip:v},R.id))})]}),n.jsx(De,{className:We("cursor-pointer transition-colors",f?"border-primary bg-primary/5":"hover:border-primary/50"),onClick:b,children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:We("w-5 h-5 rounded-full border-2 flex items-center justify-center",f?"border-primary bg-primary":"border-muted-foreground"),children:f&&n.jsx(xn,{className:"h-3 w-3 text-primary-foreground"})}),n.jsx(cae,{className:"h-4 w-4 text-primary"}),n.jsx("span",{className:"font-medium",children:"Cadastrar novo endereo"})]})})}),f&&n.jsx(De,{className:"border-primary/30",children:n.jsxs(Be,{className:"p-4",children:[n.jsx(oj,{value:p,onChange:y,showReference:!0,showCpf:!0,cpfRequired:a}),p.zipCode.replace(/\D/g,"")!==v&&p.zipCode.length===8&&n.jsxs(xf,{variant:"destructive",className:"mt-3",children:[n.jsx(Cn,{className:"h-4 w-4"}),n.jsxs(vf,{children:["O CEP do endereo (",p.zipCode.replace(/(\d{5})(\d{3})/,"$1-$2"),")  diferente do CEP cotado (",v.replace(/(\d{5})(\d{3})/,"$1-$2"),"). O frete pode mudar. Por favor, use o CEP correto."]})]})]})})]})}function zM({address:e,isSelected:t,onSelect:r,showWarning:s,quotedZip:a}){var d;const i=[e.street,e.number,e.complement,e.neighborhood].filter(Boolean).join(", "),o=`${e.city} - ${e.state}`,c=((d=e.zip_code)==null?void 0:d.replace(/(\d{5})(\d{3})/,"$1-$2"))||"";return n.jsx(De,{className:We("cursor-pointer transition-colors",t?"border-primary bg-primary/5":"hover:border-primary/50",s&&"border-amber-300"),onClick:r,children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:We("w-5 h-5 rounded-full border-2 flex items-center justify-center mt-0.5",t?"border-primary bg-primary":"border-muted-foreground"),children:t&&n.jsx(xn,{className:"h-3 w-3 text-primary-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(Xz,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"font-medium",children:e.label||"Endereo"}),e.is_default&&n.jsx("span",{className:"text-xs bg-primary/10 text-primary px-2 py-0.5 rounded",children:"Padro"})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:i}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[o,"  CEP ",c]}),s&&a&&n.jsxs("div",{className:"flex items-center gap-1 mt-2 text-amber-600 text-xs",children:[n.jsx(Cn,{className:"h-3 w-3"}),n.jsxs("span",{children:["CEP diferente do cotado (",a.replace(/(\d{5})(\d{3})/,"$1-$2"),"). O frete ser recalculado."]})]})]})]})})})}function Gl(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const m_e=.3,C0={length:30,width:20,height:10},p_e=()=>{var Ge;const e=fr(),{items:t,total:r,clearCart:s}=Wu(),a=YG(),{user:i,isLoading:o}=Hn(),{trackEvent:c}=Wk(),[d,l]=P.useState("profile"),[u,h]=P.useState(""),f=Kk(""),[m,p]=P.useState({zipCode:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:"",reference:"",document:""}),[g,v]=P.useState("motoboy"),[x,y]=P.useState([]),[b,j]=P.useState(null),[T,O]=P.useState(!1),[R,D]=P.useState(""),[L,q]=P.useState(null),[X,H]=P.useState(null),[M,F]=P.useState(""),[S,E]=P.useState(!1),[N,C]=P.useState("qualquer"),[k,I]=P.useState(""),[U,$]=P.useState(!1),[Y,Z]=P.useState(null),[re,G]=P.useState(!1),[J,V]=P.useState(!1),[W,ee]=P.useState(null),[ie,oe]=P.useState(null),[se,le]=P.useState({}),[ye,ue]=P.useState([]),[ne,pe]=P.useState(!1);P.useEffect(()=>{!o&&!i&&(de.info("Faa login para finalizar seu pedido"),e("/entrar",{state:{returnTo:"/checkout"}}))},[i,o,e]),P.useEffect(()=>{i&&be()},[i]),P.useEffect(()=>{d==="review"&&g==="shipping"&&((()=>{if(!L||!M)return!1;const Ve=L.zipCode.replace(/\D/g,""),st=M.replace(/\D/g,"");return!!(L.street&&L.city&&L.state&&Ve.length===8)&&Ve===st})()||(de.error("Endereo de entrega invlido. Selecione ou cadastre um endereo."),l("delivery")))},[d,g,L,M]);const ge=P.useMemo(()=>[...new Set(t.map(Pe=>Pe.productId))],[t]),{getAvailable:Ne,isLoading:_e}=N1(ge.length>0?ge:void 0);P.useEffect(()=>{async function Pe(){if(t.length===0)return;const{data:Ve}=await ce.from("product_catalog").select("id, stock_by_size, color, image_url, images, main_image_index, weight_kg, length_cm, width_cm, height_cm").in("id",ge);if(Ve){const st={};Ve.forEach(xt=>{st[xt.id]=xt}),le(st)}}Pe()},[t,ge]),P.useEffect(()=>{if(_e||t.length===0)return;const Pe=[];t.forEach(Ve=>{const st=Ne(Ve.productId,Ve.size);Ve.quantity>st&&(st<=0?Pe.push(`${Ve.name} (${Ve.size}): tamanho esgotado no momento`):Pe.push(`${Ve.name} (${Ve.size}): apenas ${st} disponvel(is)`))}),ue(Pe)},[t,Ne,_e]);const be=async()=>{if(!i)return;const{data:Pe}=await ce.from("profiles").select("full_name, name, whatsapp, address_line, city, state, zip_code, address_reference, cpf, address").eq("user_id",i.id).maybeSingle();if(Pe){const Ve=Pe.full_name||Pe.name||"";h(Ve),Pe.whatsapp&&f.setDisplayValue(Pe.whatsapp);const st=XC(Pe.address_line,Pe.city,Pe.state,Pe.zip_code,Pe.address_reference);p(st),Pe.zip_code&&D(Pe.zip_code.replace(/\D/g,""));const xt=!!(Ve&&Pe.whatsapp);pe(xt),xt&&l("delivery")}},Me=async()=>{if(i){if(!u.trim()||!f.displayValue){de.error("Preencha nome e WhatsApp");return}if(!f.isValid){de.error("WhatsApp invlido");return}G(!0);try{const Ve=[m.street,m.number,m.complement,m.neighborhood].filter(Boolean).join(", "),{error:st}=await ce.from("profiles").update({full_name:u.trim(),name:u.trim(),whatsapp:f.getNormalizedValue(),address_line:Ve||null,city:m.city.trim()||null,state:m.state.trim()||null,zip_code:m.zipCode.replace(/\D/g,"")||null,address_reference:m.reference.trim()||null}).eq("user_id",i.id);if(st)throw st;pe(!0),l("delivery"),de.success("Dados salvos!")}catch(Pe){console.error("Save profile error:",Pe),de.error("Erro ao salvar dados")}finally{G(!1)}}},Se=()=>{let Pe=0;return t.forEach(Ve=>{var xt;const st=((xt=se[Ve.productId])==null?void 0:xt.weight_kg)||m_e;Pe+=st*Ve.quantity}),Math.round(Pe*100)/100},$e=()=>{let Pe=C0.length,Ve=C0.width,st=0;return t.forEach(xt=>{const fe=se[xt.productId],Ie=(fe==null?void 0:fe.length_cm)||C0.length,tt=(fe==null?void 0:fe.width_cm)||C0.width,lt=(fe==null?void 0:fe.height_cm)||C0.height;Pe=Math.max(Pe,Ie),Ve=Math.max(Ve,tt),st+=lt*xt.quantity}),{length:Math.min(Math.max(Pe,11),100),width:Math.min(Math.max(Ve,11),100),height:Math.min(Math.max(st,2),100)}},Ke=async()=>{var Ve,st;const Pe=R.replace(/\D/g,"");if(Pe.length!==8){de.error("CEP invlido");return}O(!0),y([]),j(null),q(null),H(null);try{const xt=Se(),fe=$e();console.log(`Shipping calculation: weight=${xt}kg, dimensions=${fe.length}x${fe.width}x${fe.height}cm`);const{data:Ie,error:tt}=await ce.functions.invoke("calculate-shipping",{body:{toZipCode:Pe,weight:xt,length:fe.length,width:fe.width,height:fe.height}});if(tt)throw tt;Ie.quotes&&Ie.quotes.length>0?(y(Ie.quotes),j(Ie.quotes[0]),F(Pe),de.success("Frete calculado! Agora selecione o endereo de entrega.")):de.error(Ie.error||"No foi possvel calcular o frete")}catch(xt){console.error("Shipping calculation error:",xt);let fe="Erro ao calcular frete";if(((Ve=xt==null?void 0:xt.context)==null?void 0:Ve.status)===500||((st=xt==null?void 0:xt.context)==null?void 0:st.status)===400)try{const Ie=await xt.context.json();Ie!=null&&Ie.error&&(fe=Ie.error,Ie.details&&(fe+=`: ${Ie.details}`))}catch(Ie){console.error("Failed to parse error body:",Ie)}else xt!=null&&xt.message&&(fe=xt.message);de.error(fe)}finally{O(!1)}},Ze=()=>g==="pickup"?0:g==="motoboy"?Zs.motoboyFee:g==="shipping"&&b?b.price:0,it=()=>g==="shipping"&&L?(L.document||"").replace(/\D/g,"").length===11:(m.document||"").replace(/\D/g,"").length===11,Re=()=>{if(!L||!M)return!1;const Pe=L.zipCode.replace(/\D/g,""),Ve=M.replace(/\D/g,"");return!!(L.street&&L.city&&L.state&&Pe.length===8)&&Pe===Ve},ot=()=>{if(!b)return"Calcule o frete primeiro";if(!M)return"CEP no cotado";if(!L)return"Selecione ou cadastre um endereo";const Pe=L.zipCode.replace(/\D/g,""),Ve=M.replace(/\D/g,"");return Pe!==Ve?`O frete foi calculado para o CEP ${Ve.replace(/(\d{5})(\d{3})/,"$1-$2")}, mas o endereo selecionado  do CEP ${Pe.replace(/(\d{5})(\d{3})/,"$1-$2")}. Selecione ou cadastre o endereo correto.`:!L.street||!L.city||!L.state?"Complete todos os campos obrigatrios do endereo":it()?null:"CPF obrigatrio para gerar etiqueta dos Correios (11 dgitos)"},ut=()=>g==="pickup"?!0:g==="motoboy"?eK(S,N):g==="shipping"?!!b&&Re()&&it():!1,bt=async()=>{var Pe;if(!i){de.error("Faa login para continuar");return}if(t.length===0){de.error("Carrinho vazio");return}if(!u.trim()){de.error("Preencha seu nome completo"),l("profile");return}if(!f.isValid||!f.displayValue){de.error("Preencha um WhatsApp vlido"),l("profile");return}if(ye.length>0){de.error("Corrija os problemas de estoque");return}if(g==="shipping"){const Ve=ot();if(Ve){de.error(Ve),l("delivery");return}}$(!0);try{const Ve=Ze(),st=a.discountAmount,xt=r-st+Ve,fe=g==="shipping"&&L?L:m,tt=[fe.street,fe.number,fe.complement,fe.neighborhood].filter(Boolean).join(", "),lt={full_name:u,whatsapp:f.getNormalizedValue(),address_line:tt,city:fe.city,state:fe.state,zip_code:fe.zipCode,address_reference:fe.reference,document:((Pe=fe.document)==null?void 0:Pe.replace(/\D/g,""))||""},It=g==="pickup"?"Retirada na loja":`${tt}, ${fe.city} - ${fe.state}, CEP ${fe.zipCode}${fe.reference?` (${fe.reference})`:""}`,{data:ct,error:at}=await ce.from("orders").insert({customer_name:u,customer_phone:f.getNormalizedValue(),customer_address:It,subtotal:r,total:xt,status:"aguardando_pagamento",payment_status:"pending",user_id:i.id,delivery_method:g,shipping_fee:Ve,shipping_service:(b==null?void 0:b.service)||null,shipping_deadline_days:(b==null?void 0:b.deliveryDays)||null,address_snapshot:lt,coupon_id:a.coupon&&!a.coupon.isBirthdayCoupon?a.coupon.id:null,coupon_discount:st,delivery_period:g==="motoboy"?N:null,delivery_notes:(k==null?void 0:k.trim())||null,customer_notes:(k==null?void 0:k.trim())||null}).select().single();if(at)throw at;t.some(Te=>Te.fromAI)&&c("ai_look_checkout_completed",{order_id:ct.id,total:xt,products_count:t.length});const gt=t.map(Te=>{var Dt;const qe=se[Te.productId],ht=(qe==null?void 0:qe.main_image_index)||0,Pt=((Dt=qe==null?void 0:qe.images)==null?void 0:Dt[ht])||(qe==null?void 0:qe.image_url)||Te.imageUrl||null,vt=Te.price*Te.quantity;return console.log("[CHECKOUT] Order item:",{product_id:Te.productId,size:Te.size,quantity:Te.quantity,unit_price_original:Te.originalPrice,unit_price_final:Te.price,discount_percent:Te.discountPercent,subtotal:vt}),{order_id:ct.id,product_id:Te.productId,product_name:Te.name,product_price:Te.price,unit_price_original:Te.originalPrice,discount_percent:Te.discountPercent,subtotal:vt,size:Te.size,quantity:Te.quantity,color:(qe==null?void 0:qe.color)||null,image_url:Pt}}),{error:Yt}=await ce.from("order_items").insert(gt);if(Yt)throw Yt;const{data:St,error:rt}=await ce.rpc("reserve_order_stock",{p_order_id:ct.id});rt?console.error("[CHECKOUT] Stock reservation failed:",rt):console.log("[CHECKOUT] Stock reserved:",St),a.coupon&&await ZG(a.coupon.id,ct.id,null,st,a.coupon.isBirthdayCoupon);const ir=(m.document||"").replace(/\D/g,"");if(ir.length===11&&(i!=null&&i.id)){const{data:Te}=await ce.from("customers").select("id").eq("user_id",i.id).maybeSingle();if(Te){await ce.from("customers").update({document:ir}).eq("id",Te.id);const{data:qe}=await ce.from("customer_addresses").select("id").eq("customer_id",Te.id).eq("is_default",!0).maybeSingle();qe&&await ce.from("customer_addresses").update({document:ir}).eq("id",qe.id)}}ee(ct.id),oe(ct.id.slice(0,8).toUpperCase());const Ct=r-a.discountAmount+Ze();Z(Ct),s(),l("payment"),de.success("Pedido criado! Agora finalize o pagamento.")}catch(Ve){console.error("Checkout error:",Ve),de.error("Erro ao criar pedido. Tente novamente.")}finally{$(!1)}},Je=async()=>{if(!W){de.error("Pedido no encontrado");return}V(!0);try{console.log("[CHECKOUT] Calling finalize_order_prices RPC for:",W);const{data:Pe,error:Ve}=await ce.rpc("finalize_order_prices",{p_order_id:W});Ve?(console.error("finalize_order_prices RPC error:",Ve),console.warn("[CHECKOUT] Continuing despite finalize error")):console.log("[CHECKOUT] finalize_order_prices result:",Pe);const{data:st,error:xt}=await ce.functions.invoke("create-mp-preference",{body:{order_id:W,payer_email:(i==null?void 0:i.email)||""}});if(xt){console.error("MP preference invocation error:",xt),de.error("Erro de conexo com o servidor. Tente novamente.");return}if(st!=null&&st.error_code||st!=null&&st.error){console.error("MP preference error:",st);const fe=st.error||"Erro ao criar link de pagamento",Ie=st.action||"";de.error(`${fe}${Ie?` ${Ie}`:""}`);return}st!=null&&st.init_point?window.location.href=st.init_point:(console.error("MP preference missing init_point:",st),de.error("Link de pagamento no gerado. Tente novamente."))}catch(Pe){console.error("Payment error:",Pe),de.error("Erro ao processar pagamento. Verifique sua conexo.")}finally{V(!1)}};if(o)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-primary"})});if(t.length===0&&!ie&&d!=="payment")return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx(Ut,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Carrinho vazio"}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Adicione produtos antes de finalizar"}),n.jsx(he,{onClick:()=>e("/catalogo"),children:"Ver catlogo"})]})]});const Ce=r-a.discountAmount+Ze();return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-lg",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1 sm:gap-2 mb-8",children:[n.jsx(Ky,{step:"profile",current:d,label:"Cadastro",icon:n.jsx(Wn,{className:"h-4 w-4"})}),n.jsx("div",{className:"w-4 sm:w-8 h-px bg-border"}),n.jsx(Ky,{step:"delivery",current:d,label:"Entrega",icon:n.jsx(gn,{className:"h-4 w-4"})}),n.jsx("div",{className:"w-4 sm:w-8 h-px bg-border"}),n.jsx(Ky,{step:"review",current:d,label:"Confirmar",icon:n.jsx(pn,{className:"h-4 w-4"})}),n.jsx("div",{className:"w-4 sm:w-8 h-px bg-border"}),n.jsx(Ky,{step:"payment",current:d,label:"Pagar",icon:n.jsx(xs,{className:"h-4 w-4"})})]}),ye.length>0&&n.jsx(De,{className:"mb-6 border-destructive",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Cn,{className:"h-5 w-5 text-destructive flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-destructive mb-1",children:"Problemas de estoque"}),n.jsx("ul",{className:"text-sm text-muted-foreground space-y-1",children:ye.map((Pe,Ve)=>n.jsx("li",{children:Pe},Ve))}),n.jsx(he,{variant:"link",size:"sm",className:"px-0 h-auto mt-2",onClick:()=>e("/carrinho"),children:"Ajustar carrinho"})]})]})})}),d==="profile"&&n.jsxs(De,{children:[n.jsxs(Ot,{children:[n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(Wn,{className:"h-5 w-5"}),"Complete seu cadastro"]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:" s uma vez. Seus dados ficam salvos para os prximos pedidos."})]}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"fullName",children:"Seu nome *"}),n.jsx(Qe,{id:"fullName",placeholder:"Maria Silva",value:u,onChange:Pe=>h(Pe.target.value),required:!0})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"phone",children:"WhatsApp *"}),n.jsx(Qe,{id:"phone",type:"tel",placeholder:"(62) 99122-3519",value:f.displayValue,onChange:f.handleChange,onBlur:f.handleBlur,className:f.hasError?"border-destructive":""}),f.hasError&&n.jsx("p",{className:"text-sm text-destructive",children:"WhatsApp invlido"})]}),n.jsxs("div",{className:"border-t pt-4 mt-4",children:[n.jsx("p",{className:"text-sm font-medium mb-3",children:"Endereo (para entregas)"}),n.jsx(oj,{value:m,onChange:Pe=>{p(Pe),Pe.zipCode.length===8&&D(Pe.zipCode)},showReference:!0})]}),n.jsx(he,{className:"w-full mt-4",onClick:Me,disabled:re||!u.trim()||!f.displayValue||!f.isValid,children:re?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):n.jsxs(n.Fragment,{children:["Continuar",n.jsx(ps,{className:"h-4 w-4 ml-2"})]})})]})]}),d==="delivery"&&n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(gn,{className:"h-5 w-5"}),"Como voc quer receber?"]})}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs(wc,{value:g,onValueChange:Pe=>{v(Pe),Pe!=="shipping"&&(y([]),j(null))},children:[n.jsxs("div",{className:`flex items-start space-x-3 p-4 rounded-lg border ${g==="motoboy"?"border-primary bg-primary/5":"border-border"}`,children:[n.jsx(Wi,{value:"motoboy",id:"motoboy",className:"mt-1"}),n.jsxs(Le,{htmlFor:"motoboy",className:"flex-1 cursor-pointer",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(_o,{className:"h-4 w-4 text-primary"}),n.jsx("span",{className:"font-medium",children:"Motoboy (Anpolis)"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:Zs.motoboyDeliveryText}),n.jsx("p",{className:"text-sm font-medium text-primary mt-1",children:Gl(Zs.motoboyFee)})]})]}),n.jsxs("div",{className:`flex items-start space-x-3 p-4 rounded-lg border ${g==="pickup"?"border-primary bg-primary/5":"border-border"}`,children:[n.jsx(Wi,{value:"pickup",id:"pickup",className:"mt-1"}),n.jsxs(Le,{htmlFor:"pickup",className:"flex-1 cursor-pointer",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(pa,{className:"h-4 w-4 text-primary"}),n.jsx("span",{className:"font-medium",children:"Retirar na loja"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:Zs.storeAddress}),n.jsx("p",{className:"text-xs text-muted-foreground",children:Zs.storeHours}),n.jsx("p",{className:"text-sm font-medium text-green-600 mt-1",children:"Grtis"})]})]}),n.jsxs("div",{className:`flex items-start space-x-3 p-4 rounded-lg border ${g==="shipping"?"border-primary bg-primary/5":"border-border"}`,children:[n.jsx(Wi,{value:"shipping",id:"shipping",className:"mt-1"}),n.jsxs(Le,{htmlFor:"shipping",className:"flex-1 cursor-pointer",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(gn,{className:"h-4 w-4 text-primary"}),n.jsx("span",{className:"font-medium",children:"Outra cidade (Correios)"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Entrega via PAC ou SEDEX"})]})]})]}),g==="motoboy"&&n.jsx(JG,{address:{street:m.street,number:m.number,complement:m.complement,neighborhood:m.neighborhood,city:m.city,state:m.state,zipCode:m.zipCode,reference:m.reference},onAddressConfirmed:({period:Pe,notes:Ve})=>{E(!0),C(Pe),I(Ve)},onEditAddress:()=>l("profile"),initialPeriod:N,initialNotes:k}),g==="pickup"&&n.jsx(tK,{notes:k,onNotesChange:I}),g==="shipping"&&n.jsxs("div",{className:"border-t pt-4 space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{className:"text-sm font-medium",children:"1. Calcular frete"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Qe,{placeholder:"Digite o CEP de destino",value:R,onChange:Pe=>D(Pe.target.value.replace(/\D/g,"").slice(0,8)),className:"flex-1"}),n.jsx(he,{variant:"secondary",onClick:Ke,disabled:T||R.length<8,children:T?n.jsx(At,{className:"h-4 w-4 animate-spin"}):"Calcular"})]})]}),x.length>0&&n.jsx(wc,{value:(b==null?void 0:b.service)||"",onValueChange:Pe=>j(x.find(Ve=>Ve.service===Pe)||null),children:x.map(Pe=>n.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${(b==null?void 0:b.service)===Pe.service?"border-primary bg-primary/5":"border-border"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Wi,{value:Pe.service,id:Pe.service}),n.jsxs(Le,{htmlFor:Pe.service,className:"cursor-pointer",children:[n.jsx("span",{className:"font-medium",children:Pe.serviceName}),n.jsx("p",{className:"text-xs text-muted-foreground",children:Pe.deliveryRange.min===Pe.deliveryRange.max?`${Pe.deliveryDays} dias teis`:`${Pe.deliveryRange.min}-${Pe.deliveryRange.max} dias teis`})]})]}),n.jsx("span",{className:"font-medium",children:Gl(Pe.price)})]},Pe.service))}),b&&M&&i&&n.jsxs("div",{className:"space-y-2 border-t pt-4",children:[n.jsx(Le,{className:"text-sm font-medium",children:"2. Endereo de entrega"}),n.jsx(f_e,{userId:i.id,quotedZipCode:M,onAddressSelect:(Pe,Ve)=>{q(Pe),H(Ve||null)},selectedAddressId:X,cpfRequired:!0})]}),b&&ot()&&n.jsxs(xf,{variant:"destructive",className:"mt-2",children:[n.jsx(Cn,{className:"h-4 w-4"}),n.jsx(vf,{children:ot()})]})]}),n.jsxs("div",{className:"flex gap-3 pt-4",children:[n.jsx(he,{variant:"outline",onClick:()=>l("profile"),children:"Voltar"}),n.jsxs(he,{className:"flex-1",onClick:()=>l("review"),disabled:!ut(),children:["Continuar",n.jsx(ps,{className:"h-4 w-4 ml-2"})]})]})]})]}),d==="review"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsx(Mt,{className:"text-sm font-medium text-muted-foreground",children:"Resumo do pedido"})}),n.jsxs(Be,{className:"space-y-2",children:[t.map(Pe=>{var fe;const Ve=(fe=se[Pe.productId])==null?void 0:fe.stock_by_size,xt=$xe(Ve&&typeof Ve=="object"?Ve:{},Pe.size);return n.jsxs("div",{className:"flex justify-between text-sm items-center",children:[n.jsxs("span",{className:"flex items-center gap-2",children:[Pe.name," (",Pe.size,") x",Pe.quantity,xt&&n.jsx(Ae,{variant:"outline",className:"text-[10px]",children:"ltimas"})]}),n.jsx("span",{children:Gl(Pe.price*Pe.quantity)})]},`${Pe.productId}-${Pe.size}`)}),n.jsxs("div",{className:"border-t pt-2 mt-2 space-y-1",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:"Subtotal"}),n.jsx("span",{children:Gl(r)})]}),a.discountAmount>0&&n.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[n.jsxs("span",{children:["Cupom (",(Ge=a.coupon)==null?void 0:Ge.code,")"]}),n.jsxs("span",{children:["-",Gl(a.discountAmount)]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{children:g==="pickup"?"Retirada":g==="motoboy"?"Motoboy":(b==null?void 0:b.serviceName)||"Frete"}),n.jsx("span",{className:Ze()===0?"text-green-600":"",children:Ze()===0?"Grtis":Gl(Ze())})]}),n.jsxs("div",{className:"flex justify-between font-medium text-lg border-t pt-2",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{className:"text-accent",children:Gl(Ce)})]})]})]})]}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsx("p",{className:"text-sm font-medium mb-3",children:"Cupom de desconto"}),n.jsx(QG,{onApply:Pe=>a.applyCoupon(Pe,r),onRemove:a.removeCoupon,appliedCoupon:a.coupon?{code:a.coupon.code,discountAmount:a.discountAmount}:null,isLoading:a.isLoading,error:a.error,orderTotal:r})]})}),n.jsx(De,{children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[g==="pickup"?n.jsx(pa,{className:"h-5 w-5 text-primary mt-0.5"}):n.jsx(_o,{className:"h-5 w-5 text-primary mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:g==="pickup"?"Retirada na loja":"Entrega"}),g==="pickup"?n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:Zs.storeAddress}),n.jsx("p",{className:"text-xs text-muted-foreground",children:Zs.storeHours})]}):g==="shipping"&&L?n.jsxs(n.Fragment,{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:KC(L)}),b&&n.jsxs("p",{className:"text-xs text-primary mt-1",children:[b.serviceName,"  ",Gl(b.price)]})]}):n.jsx("p",{className:"text-sm text-muted-foreground",children:KC(m)})]})]})})}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(he,{variant:"outline",onClick:()=>l("delivery"),children:"Voltar"}),n.jsx(he,{className:"flex-1",size:"lg",onClick:bt,disabled:U||ye.length>0,children:U?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),"Finalizando..."]}):`Confirmar pedido  ${Gl(Ce)}`})]})]}),d==="payment"&&W&&n.jsx("div",{className:"space-y-4",children:n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(xs,{className:"h-5 w-5"}),"Pagamento via Mercado Pago"]})}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-4 text-center",children:[n.jsxs("p",{className:"text-sm mb-2",children:["Pedido ",n.jsxs("span",{className:"font-mono font-bold",children:["#",ie]})," criado!"]}),Y!==null?n.jsx("p",{className:"text-2xl font-bold text-accent",children:Gl(Y)}):n.jsx("div",{className:"h-8 w-32 mx-auto bg-muted animate-pulse rounded"})]}),n.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Voc ser redirecionada para o Mercado Pago para finalizar o pagamento com segurana. Aceita carto, Pix e boleto."}),n.jsx(he,{onClick:Je,disabled:J,className:"w-full",size:"lg",children:J?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),"Gerando link..."]}):n.jsxs(n.Fragment,{children:["Pagar com Mercado Pago",n.jsx(ma,{className:"h-4 w-4 ml-2"})]})}),n.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Pagamento 100% seguro. Seus dados so protegidos."})]})]})})]})]})};function Ky({step:e,current:t,label:r,icon:s}){const a=["profile","delivery","review","payment"],i=a.indexOf(t),o=a.indexOf(e),c=e===t,d=o<i;return n.jsxs("div",{className:`flex flex-col items-center gap-1 ${c?"text-primary":d?"text-primary/70":"text-muted-foreground"}`,children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${c?"bg-primary text-primary-foreground":d?"bg-primary/20":"bg-muted"}`,children:d?n.jsx(pn,{className:"h-4 w-4"}):s}),n.jsx("span",{className:"text-xs",children:r})]})}function Xy(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var rK={exports:{}};/*! ExcelJS 19-10-2023 */(function(e,t){(function(r){e.exports=r()})(function(){return function r(s,a,i){function o(l,u){if(!a[l]){if(!s[l]){var h=typeof Xy=="function"&&Xy;if(!u&&h)return h(l,!0);if(c)return c(l,!0);var f=new Error("Cannot find module '"+l+"'");throw f.code="MODULE_NOT_FOUND",f}var m=a[l]={exports:{}};s[l][0].call(m.exports,function(p){return o(s[l][1][p]||p)},m,m.exports,r,s,a,i)}return a[l].exports}for(var c=typeof Xy=="function"&&Xy,d=0;d<i.length;d++)o(i[d]);return o}({1:[function(r,s,a){const i=r("fs"),o=r("fast-csv"),c=r("dayjs/plugin/customParseFormat"),d=r("dayjs/plugin/utc"),l=r("dayjs").extend(c).extend(d),u=r("../utils/stream-buf"),{fs:{exists:h}}=r("../utils/utils"),f={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};s.exports=class{constructor(m){this.workbook=m,this.worksheet=null}async readFile(m,p){if(p=p||{},!await h(m))throw new Error("File not found: "+m);const g=i.createReadStream(m),v=await this.read(g,p);return g.close(),v}read(m,p){return p=p||{},new Promise((g,v)=>{const x=this.workbook.addWorksheet(p.sheetName),y=p.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],b=p.map||function(T){if(T==="")return null;const O=Number(T);if(!Number.isNaN(O)&&O!==1/0)return O;const R=y.reduce((L,q)=>{if(L)return L;const X=l(T,q,!0);return X.isValid()?X:null},null);if(R)return new Date(R.valueOf());const D=f[T];return D!==void 0?D:T},j=o.parse(p.parserOptions).on("data",T=>{x.addRow(T.map(b))}).on("end",()=>{j.emit("worksheet",x)});j.on("worksheet",g).on("error",v),m.pipe(j)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(m,p){return new Promise((g,v)=>{p=p||{};const x=this.workbook.getWorksheet(p.sheetName||p.sheetId),y=o.format(p.formatterOptions);m.on("finish",()=>{g()}),y.on("error",v),y.pipe(m);const{dateFormat:b,dateUTC:j}=p,T=p.map||(D=>{if(D){if(D.text||D.hyperlink)return D.hyperlink||D.text||"";if(D.formula||D.result)return D.result||"";if(D instanceof Date)return b?j?l.utc(D).format(b):l(D).format(b):j?l.utc(D).format():l(D).format();if(D.error)return D.error;if(typeof D=="object")return JSON.stringify(D)}return D}),O=p.includeEmptyRows===void 0||p.includeEmptyRows;let R=1;x&&x.eachRow((D,L)=>{if(O)for(;R++<L-1;)y.write([]);const{values:q}=D;q.shift(),y.write(q.map(T)),R=L}),y.end()})}writeFile(m,p){const g={encoding:(p=p||{}).encoding||"utf8"},v=i.createWriteStream(m,g);return this.write(v,p)}async writeBuffer(m){const p=new u;return await this.write(p,m),p.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(r,s,a){const i=r("../utils/col-cache");class o{constructor(d,l){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=d,l)if(typeof l=="string"){const h=i.decodeAddress(l);this.nativeCol=h.col+u,this.nativeColOff=0,this.nativeRow=h.row+u,this.nativeRowOff=0}else l.nativeCol!==void 0?(this.nativeCol=l.nativeCol||0,this.nativeColOff=l.nativeColOff||0,this.nativeRow=l.nativeRow||0,this.nativeRowOff=l.nativeRowOff||0):l.col!==void 0?(this.col=l.col+u,this.row=l.row+u):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(d){return d instanceof o||d==null?d:new o(d)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(d){this.nativeCol=Math.floor(d),this.nativeColOff=Math.floor((d-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(d){this.nativeRow=Math.floor(d),this.nativeRowOff=Math.floor((d-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(d){this.nativeCol=d.nativeCol,this.nativeColOff=d.nativeColOff,this.nativeRow=d.nativeRow,this.nativeRowOff=d.nativeRowOff}}s.exports=o},{"../utils/col-cache":19}],3:[function(r,s,a){const i=r("../utils/col-cache"),o=r("../utils/under-dash"),c=r("./enums"),{slideFormula:d}=r("../utils/shared-formula"),l=r("./note");class u{constructor(m,p,g){if(!m||!p)throw new Error("A Cell needs a Row");this._row=m,this._column=p,i.validateAddress(g),this._address=g,this._value=h.create(u.Types.Null,this),this.style=this._mergeStyle(m.style,p.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(m){this.style.numFmt=m}get font(){return this.style.font}set font(m){this.style.font=m}get alignment(){return this.style.alignment}set alignment(m){this.style.alignment=m}get border(){return this.style.border}set border(m){this.style.border=m}get fill(){return this.style.fill}set fill(m){this.style.fill=m}get protection(){return this.style.protection}set protection(m){this.style.protection=m}_mergeStyle(m,p,g){const v=m&&m.numFmt||p&&p.numFmt;v&&(g.numFmt=v);const x=m&&m.font||p&&p.font;x&&(g.font=x);const y=m&&m.alignment||p&&p.alignment;y&&(g.alignment=y);const b=m&&m.border||p&&p.border;b&&(g.border=b);const j=m&&m.fill||p&&p.fill;j&&(g.fill=j);const T=m&&m.protection||p&&p.protection;return T&&(g.protection=T),g}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===u.Types.Merge}merge(m,p){this._value.release(),this._value=h.create(u.Types.Merge,this,m),p||(this.style=m.style)}unmerge(){this.type===u.Types.Merge&&(this._value.release(),this._value=h.create(u.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(m){return this._value.type===u.Types.Merge&&this._value.isMergedTo(m)}get master(){return this.type===u.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===u.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(m){this.type!==u.Types.Merge?(this._value.release(),this._value=h.create(h.getType(m),this,m)):this._value.master.value=m}get note(){return this._comment&&this._comment.note}set note(m){this._comment=new l(m)}get text(){return this._value.toString()}get html(){return o.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(m){this.type===u.Types.String&&(this._value=h.create(u.Types.Hyperlink,this,{text:this._value.value,hyperlink:m}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:m}=this._row;return{sheetName:m.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(m){this.names=[m]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(m){const{definedNames:p}=this.workbook;p.removeAllNames(this.fullAddress),m.forEach(g=>{p.addEx(this.fullAddress,g)})}addName(m){this.workbook.definedNames.addEx(this.fullAddress,m)}removeName(m){this.workbook.definedNames.removeEx(this.fullAddress,m)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(m){this._dataValidations.add(this.address,m)}get model(){const{model:m}=this._value;return m.style=this.style,this._comment&&(m.comment=this._comment.model),m}set model(m){if(this._value.release(),this._value=h.create(m.type,this),this._value.model=m,m.comment)switch(m.comment.type){case"note":this._comment=l.fromModel(m.comment)}m.style?this.style=m.style:this.style={}}}u.Types=c.ValueType;const h={getType:f=>f==null?u.Types.Null:f instanceof String||typeof f=="string"?u.Types.String:typeof f=="number"?u.Types.Number:typeof f=="boolean"?u.Types.Boolean:f instanceof Date?u.Types.Date:f.text&&f.hyperlink?u.Types.Hyperlink:f.formula||f.sharedFormula?u.Types.Formula:f.richText?u.Types.RichText:f.sharedString?u.Types.SharedString:f.error?u.Types.Error:u.Types.JSON,types:[{t:u.Types.Null,f:class{constructor(f){this.model={address:f.address,type:u.Types.Null}}get value(){return null}set value(f){}get type(){return u.Types.Null}get effectiveType(){return u.Types.Null}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){}toString(){return""}}},{t:u.Types.Number,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Number,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Number}get effectiveType(){return u.Types.Number}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.String,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.String,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:u.Types.Date,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Date,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Date}get effectiveType(){return u.Types.Date}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Hyperlink,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Hyperlink,text:m?m.text:void 0,hyperlink:m?m.hyperlink:void 0},m&&m.tooltip&&(this.model.tooltip=m.tooltip)}get value(){const f={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(f.tooltip=this.model.tooltip),f}set value(f){this.model={text:f.text,hyperlink:f.hyperlink},f.tooltip&&(this.model.tooltip=f.tooltip)}get text(){return this.model.text}set text(f){this.model.text=f}get hyperlink(){return this.model.hyperlink}set hyperlink(f){this.model.hyperlink=f}get type(){return u.Types.Hyperlink}get effectiveType(){return u.Types.Hyperlink}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:u.Types.Formula,f:class{constructor(f,m){this.cell=f,this.model={address:f.address,type:u.Types.Formula,shareType:m?m.shareType:void 0,ref:m?m.ref:void 0,formula:m?m.formula:void 0,sharedFormula:m?m.sharedFormula:void 0,result:m?m.result:void 0}}_copyModel(f){const m={},p=g=>{const v=f[g];v&&(m[g]=v)};return p("formula"),p("result"),p("ref"),p("shareType"),p("sharedFormula"),m}get value(){return this._copyModel(this.model)}set value(f){this.model=this._copyModel(f)}validate(f){switch(h.getType(f)){case u.Types.Null:case u.Types.String:case u.Types.Number:case u.Types.Date:break;case u.Types.Hyperlink:case u.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(f){this.model.formula=f}get formulaType(){return this.model.formula?c.FormulaType.Master:this.model.sharedFormula?c.FormulaType.Shared:c.FormulaType.None}get result(){return this.model.result}set result(f){this.model.result=f}get type(){return u.Types.Formula}get effectiveType(){const f=this.model.result;return f==null?c.ValueType.Null:f instanceof String||typeof f=="string"?c.ValueType.String:typeof f=="number"?c.ValueType.Number:f instanceof Date?c.ValueType.Date:f.text&&f.hyperlink?c.ValueType.Hyperlink:f.formula?c.ValueType.Formula:c.ValueType.Null}get address(){return this.model.address}set address(f){this.model.address=f}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:f}=this.cell,m=f.findCell(this.model.sharedFormula);this._translatedFormula=m&&d(m.formula,m.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:u.Types.Merge,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Merge,master:m?m.address:void 0},this._master=m,m&&m.addMergeRef()}get value(){return this._master.value}set value(f){f instanceof u?(this._master&&this._master.releaseMergeRef(),f.addMergeRef(),this._master=f):this._master.value=f}isMergedTo(f){return f===this._master}get master(){return this._master}get type(){return u.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:u.Types.JSON,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.String,value:JSON.stringify(m),rawValue:m}}get value(){return this.model.rawValue}set value(f){this.model.rawValue=f,this.model.value=JSON.stringify(f)}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:u.Types.SharedString,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.SharedString,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.SharedString}get effectiveType(){return u.Types.SharedString}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.RichText,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.String,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}toString(){return this.model.value.richText.map(f=>f.text).join("")}get type(){return u.Types.RichText}get effectiveType(){return u.Types.RichText}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:u.Types.Boolean,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Boolean,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Boolean}get effectiveType(){return u.Types.Boolean}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Error,f:class{constructor(f,m){this.model={address:f.address,type:u.Types.Error,value:m}}get value(){return this.model.value}set value(f){this.model.value=f}get type(){return u.Types.Error}get effectiveType(){return u.Types.Error}get address(){return this.model.address}set address(f){this.model.address=f}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((f,m)=>(f[m.t]=m.f,f),[]),create(f,m,p){const g=this.types[f];if(!g)throw new Error("Could not create Value of type "+f);return new g(m,p)}};s.exports=u},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(r,s,a){const i=r("../utils/under-dash"),o=r("./enums"),c=r("../utils/col-cache");class d{constructor(u,h,f){this._worksheet=u,this._number=h,f!==!1&&(this.defn=f)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return c.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(u){u?(this.key=u.key,this.width=u.width!==void 0?u.width:9,this.outlineLevel=u.outlineLevel,u.style?this.style=u.style:this.style={},this.header=u.header,this._hidden=!!u.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(u){u!==void 0?(this._header=u,this.headers.forEach((h,f)=>{this._worksheet.getCell(f+1,this.number).value=h})):this._header=void 0}get key(){return this._key}set key(u){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=u,u&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(u){this._hidden=u}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(u){this._outlineLevel=u}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(u){return this.width===u.width&&this.hidden===u.hidden&&this.outlineLevel===u.outlineLevel&&i.isEqual(this.style,u.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const u=this.style;return!u||!(u.font||u.numFmt||u.alignment||u.border||u.fill||u.protection)}get headerCount(){return this.headers.length}eachCell(u,h){const f=this.number;h||(h=u,u=null),this._worksheet.eachRow(u,(m,p)=>{h(m.getCell(f),p)})}get values(){const u=[];return this.eachCell((h,f)=>{h&&h.type!==o.ValueType.Null&&(u[f]=h.value)}),u}set values(u){if(!u)return;const h=this.number;let f=0;u.hasOwnProperty("0")&&(f=1),u.forEach((m,p)=>{this._worksheet.getCell(p+f,h).value=m})}_applyStyle(u,h){return this.style[u]=h,this.eachCell(f=>{f[u]=h}),h}get numFmt(){return this.style.numFmt}set numFmt(u){this._applyStyle("numFmt",u)}get font(){return this.style.font}set font(u){this._applyStyle("font",u)}get alignment(){return this.style.alignment}set alignment(u){this._applyStyle("alignment",u)}get protection(){return this.style.protection}set protection(u){this._applyStyle("protection",u)}get border(){return this.style.border}set border(u){this._applyStyle("border",u)}get fill(){return this.style.fill}set fill(u){this._applyStyle("fill",u)}static toModel(u){const h=[];let f=null;return u&&u.forEach((m,p)=>{m.isDefault?f&&(f=null):f&&m.equivalentTo(f)?f.max=p+1:(f={min:p+1,max:p+1,width:m.width!==void 0?m.width:9,style:m.style,isCustomWidth:m.isCustomWidth,hidden:m.hidden,outlineLevel:m.outlineLevel,collapsed:m.collapsed},h.push(f))}),h.length?h:void 0}static fromModel(u,h){const f=[];let m=1,p=0;for(h=(h=h||[]).sort(function(g,v){return g.min-v.min});p<h.length;){const g=h[p++];for(;m<g.min;)f.push(new d(u,m++));for(;m<=g.max;)f.push(new d(u,m++,g))}return f.length?f:null}}s.exports=d},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(r,s,a){s.exports=class{constructor(i){this.model=i||{}}add(i,o){return this.model[i]=o}find(i){return this.model[i]}remove(i){this.model[i]=void 0}}},{}],6:[function(r,s,a){const i=r("../utils/under-dash"),o=r("../utils/col-cache"),c=r("../utils/cell-matrix"),d=r("./range"),l=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;s.exports=class{constructor(){this.matrixMap={}}getMatrix(u){return this.matrixMap[u]||(this.matrixMap[u]=new c)}add(u,h){const f=o.decodeEx(u);this.addEx(f,h)}addEx(u,h){const f=this.getMatrix(h);if(u.top)for(let m=u.left;m<=u.right;m++)for(let p=u.top;p<=u.bottom;p++){const g={sheetName:u.sheetName,address:o.n2l(m)+p,row:p,col:m};f.addCellEx(g)}else f.addCellEx(u)}remove(u,h){const f=o.decodeEx(u);this.removeEx(f,h)}removeEx(u,h){this.getMatrix(h).removeCellEx(u)}removeAllNames(u){i.each(this.matrixMap,h=>{h.removeCellEx(u)})}forEach(u){i.each(this.matrixMap,(h,f)=>{h.forEach(m=>{u(f,m)})})}getNames(u){return this.getNamesEx(o.decodeEx(u))}getNamesEx(u){return i.map(this.matrixMap,(h,f)=>h.findCellEx(u)&&f).filter(Boolean)}_explore(u,h){h.mark=!1;const{sheetName:f}=h,m=new d(h.row,h.col,h.row,h.col,f);let p,g;function v(y,b){const j=u.findCellAt(f,y,h.col);return!(!j||!j.mark)&&(m[b]=y,j.mark=!1,!0)}for(g=h.row-1;v(g,"top");g--);for(g=h.row+1;v(g,"bottom");g++);function x(y,b){const j=[];for(g=m.top;g<=m.bottom;g++){const T=u.findCellAt(f,g,y);if(!T||!T.mark)return!1;j.push(T)}m[b]=y;for(let T=0;T<j.length;T++)j[T].mark=!1;return!0}for(p=h.col-1;x(p,"left");p--);for(p=h.col+1;x(p,"right");p++);return m}getRanges(u,h){return(h=h||this.matrixMap[u])?(h.forEach(f=>{f.mark=!0}),{name:u,ranges:h.map(f=>f.mark&&this._explore(h,f)).filter(Boolean).map(f=>f.$shortRange)}):{name:u,ranges:[]}}normaliseMatrix(u,h){u.forEachInSheet(h,(f,m,p)=>{f&&(f.row===m&&f.col===p||(f.row=m,f.col=p,f.address=o.n2l(p)+m))})}spliceRows(u,h,f,m){i.each(this.matrixMap,p=>{p.spliceRows(u,h,f,m),this.normaliseMatrix(p,u)})}spliceColumns(u,h,f,m){i.each(this.matrixMap,p=>{p.spliceColumns(u,h,f,m),this.normaliseMatrix(p,u)})}get model(){return i.map(this.matrixMap,(u,h)=>this.getRanges(h,u)).filter(u=>u.ranges.length)}set model(u){const h=this.matrixMap={};u.forEach(f=>{const m=h[f.name]=new c;f.ranges.forEach(p=>{l.test(p.split("!").pop()||"")&&m.addCell(p)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(r,s,a){s.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(r,s,a){const i=r("../utils/col-cache"),o=r("./anchor");s.exports=class{constructor(c,d){this.worksheet=c,this.model=d}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(c){let{type:d,imageId:l,range:u,hyperlinks:h}=c;if(this.type=d,this.imageId=l,d==="image")if(typeof u=="string"){const f=i.decode(u);this.range={tl:new o(this.worksheet,{col:f.left,row:f.top},-1),br:new o(this.worksheet,{col:f.right,row:f.bottom},0),editAs:"oneCell"}}else this.range={tl:new o(this.worksheet,u.tl,0),br:u.br&&new o(this.worksheet,u.br,0),ext:u.ext,editAs:u.editAs,hyperlinks:h||u.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(r,s,a){const i=r("../utils/under-dash");class o{constructor(d){this.note=d}get model(){let d=null;switch(typeof this.note){case"string":d={type:"note",note:{texts:[{text:this.note}]}};break;default:d={type:"note",note:this.note}}return i.deepMerge({},o.DEFAULT_CONFIGS,d)}set model(d){const{note:l}=d,{texts:u}=l;u.length===1&&Object.keys(u[0]).length===1?this.note=u[0].text:this.note=l}static fromModel(d){const l=new o;return l.model=d,l}}o.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},s.exports=o},{"../utils/under-dash":26}],10:[function(r,s,a){const i=r("../utils/col-cache");class o{constructor(){this.decode(arguments)}setTLBR(d,l,u,h,f){if(arguments.length<4){const m=i.decodeAddress(d),p=i.decodeAddress(l);this.model={top:Math.min(m.row,p.row),left:Math.min(m.col,p.col),bottom:Math.max(m.row,p.row),right:Math.max(m.col,p.col),sheetName:u},this.setTLBR(m.row,m.col,p.row,p.col,f)}else this.model={top:Math.min(d,u),left:Math.min(l,h),bottom:Math.max(d,u),right:Math.max(l,h),sheetName:f}}decode(d){switch(d.length){case 5:this.setTLBR(d[0],d[1],d[2],d[3],d[4]);break;case 4:this.setTLBR(d[0],d[1],d[2],d[3]);break;case 3:this.setTLBR(d[0],d[1],d[2]);break;case 2:this.setTLBR(d[0],d[1]);break;case 1:{const l=d[0];if(l instanceof o)this.model={top:l.model.top,left:l.model.left,bottom:l.model.bottom,right:l.model.right,sheetName:l.sheetName};else if(l instanceof Array)this.decode(l);else if(l.top&&l.left&&l.bottom&&l.right)this.model={top:l.top,left:l.left,bottom:l.bottom,right:l.right,sheetName:l.sheetName};else{const u=i.decodeEx(l);u.top?this.model={top:u.top,left:u.left,bottom:u.bottom,right:u.right,sheetName:u.sheetName}:this.model={top:u.row,left:u.col,bottom:u.row,right:u.col,sheetName:u.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+d.length)}}get top(){return this.model.top||1}set top(d){this.model.top=d}get left(){return this.model.left||1}set left(d){this.model.left=d}get bottom(){return this.model.bottom||1}set bottom(d){this.model.bottom=d}get right(){return this.model.right||1}set right(d){this.model.right=d}get sheetName(){return this.model.sheetName}set sheetName(d){this.model.sheetName=d}get _serialisedSheetName(){const{sheetName:d}=this.model;return d?/^[a-zA-Z0-9]*$/.test(d)?d+"!":`'${d}'!`:""}expand(d,l,u,h){(!this.model.top||d<this.top)&&(this.top=d),(!this.model.left||l<this.left)&&(this.left=l),(!this.model.bottom||u>this.bottom)&&(this.bottom=u),(!this.model.right||h>this.right)&&(this.right=h)}expandRow(d){if(d){const{dimensions:l,number:u}=d;l&&this.expand(u,l.min,u,l.max)}}expandToAddress(d){const l=i.decodeEx(d);this.expand(l.row,l.col,l.row,l.col)}get tl(){return i.n2l(this.left)+this.top}get $t$l(){return`$${i.n2l(this.left)}$${this.top}`}get br(){return i.n2l(this.right)+this.bottom}get $b$r(){return`$${i.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(d){return(!d.sheetName||!this.sheetName||d.sheetName===this.sheetName)&&!(d.bottom<this.top)&&!(d.top>this.bottom)&&!(d.right<this.left)&&!(d.left>this.right)}contains(d){const l=i.decodeEx(d);return this.containsEx(l)}containsEx(d){return(!d.sheetName||!this.sheetName||d.sheetName===this.sheetName)&&d.row>=this.top&&d.row<=this.bottom&&d.col>=this.left&&d.col<=this.right}forEachAddress(d){for(let l=this.left;l<=this.right;l++)for(let u=this.top;u<=this.bottom;u++)d(i.encodeAddress(u,l),u,l)}}s.exports=o},{"../utils/col-cache":19}],11:[function(r,s,a){const i=r("../utils/under-dash"),o=r("./enums"),c=r("../utils/col-cache"),d=r("./cell");s.exports=class{constructor(l,u){this._worksheet=l,this._number=u,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(l){return this._cells[l-1]}getCellEx(l){let u=this._cells[l.col-1];if(!u){const h=this._worksheet.getColumn(l.col);u=new d(this,h,l.address),this._cells[l.col-1]=u}return u}getCell(l){if(typeof l=="string"){const u=this._worksheet.getColumnKey(l);l=u?u.number:c.l2n(l)}return this._cells[l-1]||this.getCellEx({address:c.encodeAddress(this._number,l),row:this._number,col:l})}splice(l,u){const h=l+u;for(var f=arguments.length,m=new Array(f>2?f-2:0),p=2;p<f;p++)m[p-2]=arguments[p];const g=m.length-u,v=this._cells.length;let x,y,b;if(g<0)for(x=l+m.length;x<=v;x++)b=this._cells[x-1],y=this._cells[x-g-1],y?(b=this.getCell(x),b.value=y.value,b.style=y.style,b._comment=y._comment):b&&(b.value=null,b.style={},b._comment=void 0);else if(g>0)for(x=v;x>=h;x--)y=this._cells[x-1],y?(b=this.getCell(x+g),b.value=y.value,b.style=y.style,b._comment=y._comment):this._cells[x+g-1]=void 0;for(x=0;x<m.length;x++)b=this.getCell(l+x),b.value=m[x],b.style={},b._comment=void 0}eachCell(l,u){if(u||(u=l,l=null),l&&l.includeEmpty){const h=this._cells.length;for(let f=1;f<=h;f++)u(this.getCell(f),f)}else this._cells.forEach((h,f)=>{h&&h.type!==o.ValueType.Null&&u(h,f+1)})}addPageBreak(l,u){const h=this._worksheet,f=Math.max(0,l-1)||0,m=Math.max(0,u-1)||16838,p={id:this._number,max:m,man:1};f&&(p.min=f),h.rowBreaks.push(p)}get values(){const l=[];return this._cells.forEach(u=>{u&&u.type!==o.ValueType.Null&&(l[u.col]=u.value)}),l}set values(l){if(this._cells=[],l)if(l instanceof Array){let u=0;l.hasOwnProperty("0")&&(u=1),l.forEach((h,f)=>{h!==void 0&&(this.getCellEx({address:c.encodeAddress(this._number,f+u),row:this._number,col:f+u}).value=h)})}else this._worksheet.eachColumnKey((u,h)=>{l[h]!==void 0&&(this.getCellEx({address:c.encodeAddress(this._number,u.number),row:this._number,col:u.number}).value=l[h])})}get hasValues(){return i.some(this._cells,l=>l&&l.type!==o.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let l=0;return this.eachCell(()=>{l++}),l}get dimensions(){let l=0,u=0;return this._cells.forEach(h=>{h&&h.type!==o.ValueType.Null&&((!l||l>h.col)&&(l=h.col),u<h.col&&(u=h.col))}),l>0?{min:l,max:u}:null}_applyStyle(l,u){return this.style[l]=u,this._cells.forEach(h=>{h&&(h[l]=u)}),u}get numFmt(){return this.style.numFmt}set numFmt(l){this._applyStyle("numFmt",l)}get font(){return this.style.font}set font(l){this._applyStyle("font",l)}get alignment(){return this.style.alignment}set alignment(l){this._applyStyle("alignment",l)}get protection(){return this.style.protection}set protection(l){this._applyStyle("protection",l)}get border(){return this.style.border}set border(l){this._applyStyle("border",l)}get fill(){return this.style.fill}set fill(l){this._applyStyle("fill",l)}get hidden(){return!!this._hidden}set hidden(l){this._hidden=l}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(l){this._outlineLevel=l}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const l=[];let u=0,h=0;return this._cells.forEach(f=>{if(f){const m=f.model;m&&((!u||u>f.col)&&(u=f.col),h<f.col&&(h=f.col),l.push(m))}}),this.height||l.length?{cells:l,number:this.number,min:u,max:h,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(l){if(l.number!==this._number)throw new Error("Invalid row number in model");let u;this._cells=[],l.cells.forEach(h=>{switch(h.type){case d.Types.Merge:break;default:{let f;if(h.address)f=c.decodeAddress(h.address);else if(u){const{row:m}=u,p=u.col+1;f={row:m,col:p,address:c.encodeAddress(m,p),$col$row:`$${c.n2l(p)}$${m}`}}u=f,this.getCellEx(f).model=h;break}}}),l.height?this.height=l.height:delete this.height,this.hidden=l.hidden,this.outlineLevel=l.outlineLevel||0,this.style=l.style&&JSON.parse(JSON.stringify(l.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(r,s,a){const i=r("../utils/col-cache");class o{constructor(d,l,u){this.table=d,this.column=l,this.index=u}_set(d,l){this.table.cacheState(),this.column[d]=l}get name(){return this.column.name}set name(d){this._set("name",d)}get filterButton(){return this.column.filterButton}set filterButton(d){this.column.filterButton=d}get style(){return this.column.style}set style(d){this.column.style=d}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(d){this._set("totalsRowLabel",d)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(d){this._set("totalsRowFunction",d)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(d){this._set("totalsRowResult",d)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(d){this._set("totalsRowFormula",d)}}s.exports=class{constructor(c,d){this.worksheet=c,d&&(this.table=d,this.validate(),this.store())}getFormula(c){switch(c.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${c.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${c.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${c.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${c.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${c.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${c.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${c.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${c.name}])`;case"custom":return c.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+c.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:c}=this,d=(g,v,x)=>{g[v]===void 0&&(g[v]=x)};d(c,"headerRow",!0),d(c,"totalsRow",!1),d(c,"style",{}),d(c.style,"theme","TableStyleMedium2"),d(c.style,"showFirstColumn",!1),d(c.style,"showLastColumn",!1),d(c.style,"showRowStripes",!1),d(c.style,"showColumnStripes",!1);const l=(g,v)=>{if(!g)throw new Error(v)};l(c.ref,"Table must have ref"),l(c.columns,"Table must have column definitions"),l(c.rows,"Table must have row definitions"),c.tl=i.decodeAddress(c.ref);const{row:u,col:h}=c.tl;l(u>0,"Table must be on valid row"),l(h>0,"Table must be on valid col");const{width:f,filterHeight:m,tableHeight:p}=this;c.autoFilterRef=i.encode(u,h,u+m-1,h+f-1),c.tableRef=i.encode(u,h,u+p-1,h+f-1),c.columns.forEach((g,v)=>{l(g.name,`Column ${v} must have a name`),v===0?d(g,"totalsRowLabel","Total"):(d(g,"totalsRowFunction","none"),g.totalsRowFormula=this.getFormula(g))})}store(){const c=(m,p)=>{p&&Object.keys(p).forEach(g=>{m[g]=p[g]})},{worksheet:d,table:l}=this,{row:u,col:h}=l.tl;let f=0;if(l.headerRow){const m=d.getRow(u+f++);l.columns.forEach((p,g)=>{const{style:v,name:x}=p,y=m.getCell(h+g);y.value=x,c(y,v)})}if(l.rows.forEach(m=>{const p=d.getRow(u+f++);m.forEach((g,v)=>{const x=p.getCell(h+v);x.value=g,c(x,l.columns[v].style)})}),l.totalsRow){const m=d.getRow(u+f++);l.columns.forEach((p,g)=>{const v=m.getCell(h+g);if(g===0)v.value=p.totalsRowLabel;else{const x=this.getFormula(p);v.value=x?{formula:p.totalsRowFormula,result:p.totalsRowResult}:null}c(v,p.style)})}}load(c){const{table:d}=this,{row:l,col:u}=d.tl;let h=0;if(d.headerRow){const f=c.getRow(l+h++);d.columns.forEach((m,p)=>{f.getCell(u+p).value=m.name})}if(d.rows.forEach(f=>{const m=c.getRow(l+h++);f.forEach((p,g)=>{m.getCell(u+g).value=p})}),d.totalsRow){const f=c.getRow(l+h++);d.columns.forEach((m,p)=>{const g=f.getCell(u+p);p===0?g.value=m.totalsRowLabel:this.getFormula(m)&&(g.value={formula:m.totalsRowFormula,result:m.totalsRowResult})})}}get model(){return this.table}set model(c){this.table=c}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const c=i.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let d=0;d<this._cache.tableHeight;d++){const l=this.worksheet.getRow(c.row+d);for(let u=0;u<this._cache.width;u++)l.getCell(c.col+u).value=null}else{for(let d=this.tableHeight;d<this._cache.tableHeight;d++){const l=this.worksheet.getRow(c.row+d);for(let u=0;u<this._cache.width;u++)l.getCell(c.col+u).value=null}for(let d=0;d<this.tableHeight;d++){const l=this.worksheet.getRow(c.row+d);for(let u=this.width;u<this._cache.width;u++)l.getCell(c.col+u).value=null}}this.store()}addRow(c,d){this.cacheState(),d===void 0?this.table.rows.push(c):this.table.rows.splice(d,0,c)}removeRows(c){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(c,d)}getColumn(c){const d=this.table.columns[c];return new o(this,d,c)}addColumn(c,d,l){this.cacheState(),l===void 0?(this.table.columns.push(c),this.table.rows.forEach((u,h)=>{u.push(d[h])})):(this.table.columns.splice(l,0,c),this.table.rows.forEach((u,h)=>{u.splice(l,0,d[h])}))}removeColumns(c){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(c,d),this.table.rows.forEach(l=>{l.splice(c,d)})}_assign(c,d,l){this.cacheState(),c[d]=l}get ref(){return this.table.ref}set ref(c){this._assign(this.table,"ref",c)}get name(){return this.table.name}set name(c){this.table.name=c}get displayName(){return this.table.displyName||this.table.name}set displayNamename(c){this.table.displayName=c}get headerRow(){return this.table.headerRow}set headerRow(c){this._assign(this.table,"headerRow",c)}get totalsRow(){return this.table.totalsRow}set totalsRow(c){this._assign(this.table,"totalsRow",c)}get theme(){return this.table.style.name}set theme(c){this.table.style.name=c}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(c){this.table.style.showFirstColumn=c}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(c){this.table.style.showLastColumn=c}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(c){this.table.style.showRowStripes=c}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(c){this.table.style.showColumnStripes=c}}},{"../utils/col-cache":19}],13:[function(r,s,a){const i=r("./worksheet"),o=r("./defined-names"),c=r("../xlsx/xlsx"),d=r("../csv/csv");s.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new o}get xlsx(){return this._xlsx||(this._xlsx=new c(this)),this._xlsx}get csv(){return this._csv||(this._csv=new d(this)),this._csv}get nextId(){for(let l=1;l<this._worksheets.length;l++)if(!this._worksheets[l])return l;return this._worksheets.length||1}addWorksheet(l,u){const h=this.nextId;u&&(typeof u=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),u={properties:{tabColor:{argb:u}}}):(u.argb||u.theme||u.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),u={properties:{tabColor:u}}));const f=this._worksheets.reduce((g,v)=>(v&&v.orderNo)>g?v.orderNo:g,0),m=Object.assign({},u,{id:h,name:l,orderNo:f+1,workbook:this}),p=new i(m);return this._worksheets[h]=p,p}removeWorksheetEx(l){delete this._worksheets[l.id]}removeWorksheet(l){const u=this.getWorksheet(l);u&&u.destroy()}getWorksheet(l){return l===void 0?this._worksheets.find(Boolean):typeof l=="number"?this._worksheets[l]:typeof l=="string"?this._worksheets.find(u=>u&&u.name===l):void 0}get worksheets(){return this._worksheets.slice(1).sort((l,u)=>l.orderNo-u.orderNo).filter(Boolean)}eachSheet(l){this.worksheets.forEach(u=>{l(u,u.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(l){const u=this.media.length;return this.media.push(Object.assign({},l,{type:"image"})),u}getImage(l){return this.media[l]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(l=>l.model),sheets:this.worksheets.map(l=>l.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(l){this.creator=l.creator,this.lastModifiedBy=l.lastModifiedBy,this.lastPrinted=l.lastPrinted,this.created=l.created,this.modified=l.modified,this.company=l.company,this.manager=l.manager,this.title=l.title,this.subject=l.subject,this.keywords=l.keywords,this.category=l.category,this.description=l.description,this.language=l.language,this.revision=l.revision,this.contentStatus=l.contentStatus,this.properties=l.properties,this.calcProperties=l.calcProperties,this._worksheets=[],l.worksheets.forEach(u=>{const{id:h,name:f,state:m}=u,p=l.sheets&&l.sheets.findIndex(g=>g.id===h);(this._worksheets[h]=new i({id:h,name:f,orderNo:p,state:m,workbook:this})).model=u}),this._definedNames.model=l.definedNames,this.views=l.views,this._themes=l.themes,this.media=l.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(r,s,a){const i=r("../utils/under-dash"),o=r("../utils/col-cache"),c=r("./range"),d=r("./row"),l=r("./column"),u=r("./enums"),h=r("./image"),f=r("./table"),m=r("./data-validations"),p=r("../utils/encryptor"),{copyStyle:g}=r("../utils/copy-style");s.exports=class{constructor(v){v=v||{},this._workbook=v.workbook,this.id=v.id,this.orderNo=v.orderNo,this.name=v.name,this.state=v.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},v.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!v.pageSetup||!v.pageSetup.fitToWidth&&!v.pageSetup.fitToHeight||v.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},v.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},v.headerFooter),this.dataValidations=new m,this.views=v.views||[],this.autoFilter=v.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(v){if(v===void 0&&(v="sheet"+this.id),this._name!==v){if(typeof v!="string")throw new Error("The name has to be a string.");if(v==="")throw new Error("The name can't be empty.");if(v==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(v))throw new Error(`Worksheet name ${v} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(v))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+v);if(v&&v.length>31&&(console.warn(`Worksheet name ${v} exceeds 31 chars. This will be truncated`),v=v.substring(0,31)),this._workbook._worksheets.find(x=>x&&x.name.toLowerCase()===v.toLowerCase()))throw new Error("Worksheet name already exists: "+v);this._name=v}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const v=new c;return this._rows.forEach(x=>{if(x){const y=x.dimensions;y&&v.expand(x.number,y.min,x.number,y.max)}}),v}get columns(){return this._columns}set columns(v){this._headerRowCount=v.reduce((b,j)=>{const T=(j.header?1:j.headers&&j.headers.length)||0;return Math.max(b,T)},0);let x=1;const y=this._columns=[];v.forEach(b=>{const j=new l(this,x++,!1);y.push(j),j.defn=b})}getColumnKey(v){return this._keys[v]}setColumnKey(v,x){this._keys[v]=x}deleteColumnKey(v){delete this._keys[v]}eachColumnKey(v){i.each(this._keys,v)}getColumn(v){if(typeof v=="string"){const x=this._keys[v];if(x)return x;v=o.l2n(v)}if(this._columns||(this._columns=[]),v>this._columns.length){let x=this._columns.length+1;for(;x<=v;)this._columns.push(new l(this,x++))}return this._columns[v-1]}spliceColumns(v,x){const y=this._rows.length;for(var b=arguments.length,j=new Array(b>2?b-2:0),T=2;T<b;T++)j[T-2]=arguments[T];if(j.length>0)for(let L=0;L<y;L++){const q=[v,x];j.forEach(H=>{q.push(H[L]||null)});const X=this.getRow(L+1);X.splice.apply(X,q)}else this._rows.forEach(L=>{L&&L.splice(v,x)});const O=j.length-x,R=v+x,D=this._columns.length;if(O<0)for(let L=v+j.length;L<=D;L++)this.getColumn(L).defn=this.getColumn(L-O).defn;else if(O>0)for(let L=D;L>=R;L--)this.getColumn(L+O).defn=this.getColumn(L).defn;for(let L=v;L<v+j.length;L++)this.getColumn(L).defn=null;this.workbook.definedNames.spliceColumns(this.name,v,x,j.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let v=0;return this.eachRow(x=>{v=Math.max(v,x.cellCount)}),v}get actualColumnCount(){const v=[];let x=0;return this.eachRow(y=>{y.eachCell(b=>{let{col:j}=b;v[j]||(v[j]=!0,x++)})}),x}_commitRow(){}get _lastRowNumber(){const v=this._rows;let x=v.length;for(;x>0&&v[x-1]===void 0;)x--;return x}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(v){return this._rows[v-1]}findRows(v,x){return this._rows.slice(v-1,v-1+x)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let v=0;return this.eachRow(()=>{v++}),v}getRow(v){let x=this._rows[v-1];return x||(x=this._rows[v-1]=new d(this,v)),x}getRows(v,x){if(x<1)return;const y=[];for(let b=v;b<v+x;b++)y.push(this.getRow(b));return y}addRow(v){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=this._nextRow,b=this.getRow(y);return b.values=v,this._setStyleOption(y,x[0]==="i"?x:"n"),b}addRows(v){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=[];return v.forEach(b=>{y.push(this.addRow(b,x))}),y}insertRow(v,x){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(v,0,x),this._setStyleOption(v,y),this.getRow(v)}insertRows(v,x){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(v,0,...x),y!=="n")for(let b=0;b<x.length;b++)y[0]==="o"&&this.findRow(x.length+v+b)!==void 0?this._copyStyle(x.length+v+b,v+b,y[1]==="+"):y[0]==="i"&&this.findRow(v-1)!==void 0&&this._copyStyle(v-1,v+b,y[1]==="+");return this.getRows(v,x.length)}_setStyleOption(v){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";x[0]==="o"&&this.findRow(v+1)!==void 0?this._copyStyle(v+1,v,x[1]==="+"):x[0]==="i"&&this.findRow(v-1)!==void 0&&this._copyStyle(v-1,v,x[1]==="+")}_copyStyle(v,x){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const b=this.getRow(v),j=this.getRow(x);j.style=g(b.style),b.eachCell({includeEmpty:y},(T,O)=>{j.getCell(O).style=g(T.style)}),j.height=b.height}duplicateRow(v,x){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const b=this._rows[v-1],j=new Array(x).fill(b.values);this.spliceRows(v+1,y?0:x,...j);for(let T=0;T<x;T++){const O=this._rows[v+T];O.style=b.style,O.height=b.height,b.eachCell({includeEmpty:!0},(R,D)=>{O.getCell(D).style=R.style})}}spliceRows(v,x){const y=v+x;for(var b=arguments.length,j=new Array(b>2?b-2:0),T=2;T<b;T++)j[T-2]=arguments[T];const O=j.length,R=O-x,D=this._rows.length;let L,q;if(R<0)for(v===D&&(this._rows[D-1]=void 0),L=y;L<=D;L++)if(q=this._rows[L-1],q){const X=this.getRow(L+R);X.values=q.values,X.style=q.style,X.height=q.height,q.eachCell({includeEmpty:!0},(H,M)=>{X.getCell(M).style=H.style}),this._rows[L-1]=void 0}else this._rows[L+R-1]=void 0;else if(R>0)for(L=D;L>=y;L--)if(q=this._rows[L-1],q){const X=this.getRow(L+R);X.values=q.values,X.style=q.style,X.height=q.height,q.eachCell({includeEmpty:!0},(H,M)=>{if(X.getCell(M).style=H.style,H._value.constructor.name==="MergeValue"){const F=this.getRow(H._row._number+O).getCell(M),S=H._value._master,E=this.getRow(S._row._number+O).getCell(S._column._number);F.merge(E)}})}else this._rows[L+R-1]=void 0;for(L=0;L<O;L++){const X=this.getRow(v+L);X.style={},X.values=j[L]}this.workbook.definedNames.spliceRows(this.name,v,x,O)}eachRow(v,x){if(x||(x=v,v=void 0),v&&v.includeEmpty){const y=this._rows.length;for(let b=1;b<=y;b++)x(this.getRow(b),b)}else this._rows.forEach(y=>{y&&y.hasValues&&x(y,y.number)})}getSheetValues(){const v=[];return this._rows.forEach(x=>{x&&(v[x.number]=x.values)}),v}findCell(v,x){const y=o.getAddress(v,x),b=this._rows[y.row-1];return b?b.findCell(y.col):void 0}getCell(v,x){const y=o.getAddress(v,x);return this.getRow(y.row).getCellEx(y)}mergeCells(){for(var v=arguments.length,x=new Array(v),y=0;y<v;y++)x[y]=arguments[y];const b=new c(x);this._mergeCellsInternal(b)}mergeCellsWithoutStyle(){for(var v=arguments.length,x=new Array(v),y=0;y<v;y++)x[y]=arguments[y];const b=new c(x);this._mergeCellsInternal(b,!0)}_mergeCellsInternal(v,x){i.each(this._merges,b=>{if(b.intersects(v))throw new Error("Cannot merge already merged cells")});const y=this.getCell(v.top,v.left);for(let b=v.top;b<=v.bottom;b++)for(let j=v.left;j<=v.right;j++)(b>v.top||j>v.left)&&this.getCell(b,j).merge(y,x);this._merges[y.address]=v}_unMergeMaster(v){const x=this._merges[v.address];if(x){for(let y=x.top;y<=x.bottom;y++)for(let b=x.left;b<=x.right;b++)this.getCell(y,b).unmerge();delete this._merges[v.address]}}get hasMerges(){return i.some(this._merges,Boolean)}unMergeCells(){for(var v=arguments.length,x=new Array(v),y=0;y<v;y++)x[y]=arguments[y];const b=new c(x);for(let j=b.top;j<=b.bottom;j++)for(let T=b.left;T<=b.right;T++){const O=this.findCell(j,T);O&&(O.type===u.ValueType.Merge?this._unMergeMaster(O.master):this._merges[O.address]&&this._unMergeMaster(O))}}fillFormula(v,x,y){let b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const j=o.decode(v),{top:T,left:O,bottom:R,right:D}=j,L=D-O+1,q=o.encodeAddress(T,O),X=b==="shared";let H;H=typeof y=="function"?y:Array.isArray(y)?Array.isArray(y[0])?(F,S)=>y[F-T][S-O]:(F,S)=>y[(F-T)*L+(S-O)]:()=>{};let M=!0;for(let F=T;F<=R;F++)for(let S=O;S<=D;S++)M?(this.getCell(F,S).value={shareType:b,formula:x,ref:v,result:H(F,S)},M=!1):this.getCell(F,S).value=X?{sharedFormula:q,result:H(F,S)}:H(F,S)}addImage(v,x){const y={type:"image",imageId:v,range:x};this._media.push(new h(this,y))}getImages(){return this._media.filter(v=>v.type==="image")}addBackgroundImage(v){const x={type:"background",imageId:v};this._media.push(new h(this,x))}getBackgroundImageId(){const v=this._media.find(x=>x.type==="background");return v&&v.imageId}protect(v,x){return new Promise(y=>{this.sheetProtection={sheet:!0},x&&"spinCount"in x&&(x.spinCount=Number.isFinite(x.spinCount)?Math.round(Math.max(0,x.spinCount)):1e5),v&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=p.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=x&&"spinCount"in x?x.spinCount:1e5,this.sheetProtection.hashValue=p.convertPasswordToHash(v,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),x&&(this.sheetProtection=Object.assign(this.sheetProtection,x),!v&&"spinCount"in x&&delete this.sheetProtection.spinCount),y()})}unprotect(){this.sheetProtection=null}addTable(v){const x=new f(this,v);return this.tables[v.name]=x,x}getTable(v){return this.tables[v]}removeTable(v){delete this.tables[v]}getTables(){return Object.values(this.tables)}addConditionalFormatting(v){this.conditionalFormattings.push(v)}removeConditionalFormatting(v){typeof v=="number"?this.conditionalFormattings.splice(v,1):this.conditionalFormattings=v instanceof Function?this.conditionalFormattings.filter(v):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(v){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=v}get model(){const v={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(b=>b.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(b=>b.model),conditionalFormattings:this.conditionalFormattings};v.cols=l.toModel(this.columns);const x=v.rows=[],y=v.dimensions=new c;return this._rows.forEach(b=>{const j=b&&b.model;j&&(y.expand(j.number,j.min,j.number,j.max),x.push(j))}),v.merges=[],i.each(this._merges,b=>{v.merges.push(b.range)}),v}_parseRows(v){this._rows=[],v.rows.forEach(x=>{const y=new d(this,x.number);this._rows[y.number-1]=y,y.model=x})}_parseMergeCells(v){i.each(v.mergeCells,x=>{this.mergeCellsWithoutStyle(x)})}set model(v){this.name=v.name,this._columns=l.fromModel(this,v.cols),this._parseRows(v),this._parseMergeCells(v),this.dataValidations=new m(v.dataValidations),this.properties=v.properties,this.pageSetup=v.pageSetup,this.headerFooter=v.headerFooter,this.views=v.views,this.autoFilter=v.autoFilter,this._media=v.media.map(x=>new h(this,x)),this.sheetProtection=v.sheetProtection,this.tables=v.tables.reduce((x,y)=>{const b=new f;return b.model=y,x[y.name]=b,x},{}),this.conditionalFormattings=v.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(r,s,a){r("core-js/modules/es.promise"),r("core-js/modules/es.promise.finally"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.values"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.async-iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.find-index"),r("core-js/modules/es.array.find"),r("core-js/modules/es.string.from-code-point"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.number.is-nan"),r("regenerator-runtime/runtime");const i={Workbook:r("./doc/workbook")},o=r("./doc/enums");Object.keys(o).forEach(c=>{i[c]=o[c]}),s.exports=i},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(r,s,a){const i=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");a.bufferToString=function(o){return typeof o=="string"?o:i?i.decode(o):o.toString()}},{}],17:[function(r,s,a){const i=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:o}=r("buffer");a.stringToBuffer=function(c){return typeof c!="string"?c:i?o.from(i.encode(c).buffer):o.from(c)}},{buffer:220}],18:[function(r,s,a){const i=r("./under-dash"),o=r("./col-cache");s.exports=class{constructor(c){this.template=c,this.sheets={}}addCell(c){this.addCellEx(o.decodeEx(c))}getCell(c){return this.findCellEx(o.decodeEx(c),!0)}findCell(c){return this.findCellEx(o.decodeEx(c),!1)}findCellAt(c,d,l){const u=this.sheets[c],h=u&&u[d];return h&&h[l]}addCellEx(c){if(c.top)for(let d=c.top;d<=c.bottom;d++)for(let l=c.left;l<=c.right;l++)this.getCellAt(c.sheetName,d,l);else this.findCellEx(c,!0)}getCellEx(c){return this.findCellEx(c,!0)}findCellEx(c,d){const l=this.findSheet(c,d),u=this.findSheetRow(l,c,d);return this.findRowCell(u,c,d)}getCellAt(c,d,l){const u=this.sheets[c]||(this.sheets[c]=[]),h=u[d]||(u[d]=[]);return h[l]||(h[l]={sheetName:c,address:o.n2l(l)+d,row:d,col:l})}removeCellEx(c){const d=this.findSheet(c);if(!d)return;const l=this.findSheetRow(d,c);l&&delete l[c.col]}forEachInSheet(c,d){const l=this.sheets[c];l&&l.forEach((u,h)=>{u&&u.forEach((f,m)=>{f&&d(f,h,m)})})}forEach(c){i.each(this.sheets,(d,l)=>{this.forEachInSheet(l,c)})}map(c){const d=[];return this.forEach(l=>{d.push(c(l))}),d}findSheet(c,d){const l=c.sheetName;return this.sheets[l]?this.sheets[l]:d?this.sheets[l]=[]:void 0}findSheetRow(c,d,l){const{row:u}=d;return c&&c[u]?c[u]:l?c[u]=[]:void 0}findRowCell(c,d,l){const{col:u}=d;return c&&c[u]?c[u]:l?c[u]=this.template?Object.assign(d,JSON.parse(JSON.stringify(this.template))):d:void 0}spliceRows(c,d,l,u){const h=this.sheets[c];if(h){const f=[];for(let m=0;m<u;m++)f.push([]);h.splice(d,l,...f)}}spliceColumns(c,d,l,u){const h=this.sheets[c];if(h){const f=[];for(let m=0;m<u;m++)f.push(null);i.each(h,m=>{m.splice(d,l,...f)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(r,s,a){const i=/^[A-Z]+\d+$/,o={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:c=>c<=26?1:c<=676?2:3,_fill(c){let d,l,u,h,f,m=1;if(c>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&c>=1){for(;m<=26;)d=this._dictionary[m-1],this._n2l[m]=d,this._l2n[d]=m,m++;this._l2nFill=1}if(this._l2nFill<2&&c>=2){for(m=27;m<=702;)l=m-27,u=l%26,h=Math.floor(l/26),d=this._dictionary[h]+this._dictionary[u],this._n2l[m]=d,this._l2n[d]=m,m++;this._l2nFill=2}if(this._l2nFill<3&&c>=3){for(m=703;m<=16384;)l=m-703,u=l%26,h=Math.floor(l/26)%26,f=Math.floor(l/676),d=this._dictionary[f]+this._dictionary[h]+this._dictionary[u],this._n2l[m]=d,this._l2n[d]=m,m++;this._l2nFill=3}},l2n(c){if(this._l2n[c]||this._fill(c.length),!this._l2n[c])throw new Error("Out of bounds. Invalid column letter: "+c);return this._l2n[c]},n2l(c){if(c<1||c>16384)throw new Error(c+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[c]||this._fill(this._level(c)),this._n2l[c]},_hash:{},validateAddress(c){if(!i.test(c))throw new Error("Invalid Address: "+c);return!0},decodeAddress(c){const d=c.length<5&&this._hash[c];if(d)return d;let l=!1,u="",h=0,f=!1,m="",p=0;for(let v,x=0;x<c.length;x++)if(v=c.charCodeAt(x),!f&&v>=65&&v<=90)l=!0,u+=c[x],h=26*h+v-64;else if(v>=48&&v<=57)f=!0,m+=c[x],p=10*p+v-48;else if(f&&l&&v!==36)break;if(l){if(h>16384)throw new Error("Out of bounds. Invalid column letter: "+u)}else h=void 0;f||(p=void 0);const g={address:c=u+m,col:h,row:p,$col$row:`$${u}$${m}`};return h<=100&&p<=100&&(this._hash[c]=g,this._hash[g.$col$row]=g),g},getAddress(c,d){if(d){const l=this.n2l(d)+c;return this.decodeAddress(l)}return this.decodeAddress(c)},decode(c){const d=c.split(":");if(d.length===2){const l=this.decodeAddress(d[0]),u=this.decodeAddress(d[1]),h={top:Math.min(l.row,u.row),left:Math.min(l.col,u.col),bottom:Math.max(l.row,u.row),right:Math.max(l.col,u.col)};return h.tl=this.n2l(h.left)+h.top,h.br=this.n2l(h.right)+h.bottom,h.dimensions=`${h.tl}:${h.br}`,h}return this.decodeAddress(c)},decodeEx(c){const d=c.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),l=d[1]||d[2],u=d[3],h=u.split(":");if(h.length>1){let m=this.decodeAddress(h[0]),p=this.decodeAddress(h[1]);const g=Math.min(m.row,p.row),v=Math.min(m.col,p.col),x=Math.max(m.row,p.row),y=Math.max(m.col,p.col);return m=this.n2l(v)+g,p=this.n2l(y)+x,{top:g,left:v,bottom:x,right:y,sheetName:l,tl:{address:m,col:v,row:g,$col$row:`$${this.n2l(v)}$${g}`,sheetName:l},br:{address:p,col:y,row:x,$col$row:`$${this.n2l(y)}$${x}`,sheetName:l},dimensions:`${m}:${p}`}}if(u.startsWith("#"))return l?{sheetName:l,error:u}:{error:u};const f=this.decodeAddress(u);return l?{sheetName:l,...f}:f},encodeAddress:(c,d)=>o.n2l(d)+c,encode(){switch(arguments.length){case 2:return o.encodeAddress(arguments[0],arguments[1]);case 4:return`${o.encodeAddress(arguments[0],arguments[1])}:${o.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(c,d){const[l,u,,h,f]=c,[m,p]=d;return m>=l&&m<=h&&p>=u&&p<=f}};s.exports=o},{}],20:[function(r,s,a){const i=(c,d)=>({...c,...d.reduce((l,u)=>(c[u]&&(l[u]={...c[u]}),l),{})}),o=function(c,d,l){let u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];c[l]&&(d[l]=i(c[l],u))};a.copyStyle=c=>{if(!c)return c;if(d=c,Object.keys(d).length===0)return{};var d;const l={...c};return o(c,l,"font",["color"]),o(c,l,"alignment"),o(c,l,"protection"),c.border&&(o(c,l,"border"),o(c.border,l.border,"top",["color"]),o(c.border,l.border,"left",["color"]),o(c.border,l.border,"bottom",["color"]),o(c.border,l.border,"right",["color"]),o(c.border,l.border,"diagonal",["color"])),c.fill&&(o(c,l,"fill",["fgColor","bgColor","center"]),c.fill.stops&&(l.fill.stops=c.fill.stops.map(u=>i(u,["color"])))),l}},{}],21:[function(r,s,a){(function(i){(function(){const o=r("crypto"),c={hash(d){const l=o.createHash(d);for(var u=arguments.length,h=new Array(u>1?u-1:0),f=1;f<u;f++)h[f-1]=arguments[f];return l.update(i.concat(h)),l.digest()},convertPasswordToHash(d,l,u,h){if(l=l.toLowerCase(),o.getHashes().indexOf(l)<0)throw new Error(`Hash algorithm '${l}' not supported!`);const f=i.from(d,"utf16le");let m=this.hash(l,i.from(u,"base64"),f);for(let p=0;p<h;p++){const g=i.alloc(4);g.writeUInt32LE(p,0),m=this.hash(l,m,g)}return m.toString("base64")},randomBytes:d=>o.randomBytes(d)};s.exports=c}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(r,s,a){const{SaxesParser:i}=r("saxes"),{PassThrough:o}=r("readable-stream"),{bufferToString:c}=r("./browser-buffer-decode");s.exports=async function*(d){d.pipe&&!d[Symbol.asyncIterator]&&(d=d.pipe(new o));const l=new i;let u;l.on("error",f=>{u=f});let h=[];l.on("opentag",f=>h.push({eventType:"opentag",value:f})),l.on("text",f=>h.push({eventType:"text",value:f})),l.on("closetag",f=>h.push({eventType:"closetag",value:f}));for await(const f of d){if(l.write(c(f)),u)throw u;yield h,h=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(r,s,a){const i=r("./col-cache"),o=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,c=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;s.exports={slideFormula:function(d,l,u){const h=i.decode(l),f=i.decode(u);return d.replace(o,(m,p,g,v,x)=>{if(x)return m;const y=c.exec(v);if(y){const b=y[1],j=y[2].toUpperCase(),T=y[3],O=y[4];if(j.length>3||j.length===3&&j>"XFD")return m;let R=i.l2n(j),D=parseInt(O,10);return b||(R+=f.col-h.col),T||(D+=f.row-h.row),(p||"")+(b||"")+i.n2l(R)+(T||"")+D}return m})}}},{"./col-cache":19}],24:[function(r,s,a){(function(i,o){(function(){const c=r("readable-stream"),d=r("./utils"),l=r("./string-buf");class u{constructor(v,x){this._data=v,this._encoding=x}get length(){return this.toBuffer().length}copy(v,x,y,b){return this.toBuffer().copy(v,x,y,b)}toBuffer(){return this._buffer||(this._buffer=o.from(this._data,this._encoding)),this._buffer}}class h{constructor(v){this._data=v}get length(){return this._data.length}copy(v,x,y,b){return this._data._buf.copy(v,x,y,b)}toBuffer(){return this._data.toBuffer()}}class f{constructor(v){this._data=v}get length(){return this._data.length}copy(v,x,y,b){this._data.copy(v,x,y,b)}toBuffer(){return this._data}}class m{constructor(v){this.size=v,this.buffer=o.alloc(v),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const v=o.alloc(this.iWrite-this.iRead);return this.buffer.copy(v,0,this.iRead,this.iWrite),v}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(v){let x;return v===0?null:v===void 0||v>=this.length?(x=this.toBuffer(),this.iRead=this.iWrite,x):(x=o.alloc(v),this.buffer.copy(x,0,this.iRead,v),this.iRead+=v,x)}write(v,x,y){const b=Math.min(y,this.size-this.iWrite);return v.copy(this.buffer,this.iWrite,x,x+b),this.iWrite+=b,b}}const p=function(g){g=g||{},this.bufSize=g.bufSize||1048576,this.buffers=[],this.batch=g.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};d.inherits(p,c.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return o.concat(this.buffers.map(g=>g.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const v=this.buffers[this.buffers.length-1];if(!v.full)return v}const g=new m(this.bufSize);return this.buffers.push(g),g},async _pipe(g){await Promise.all(this.pipes.map(function(v){return new Promise(x=>{v.write(g.toBuffer(),()=>{x()})})}))},_writeToBuffers(g){let v=0;const x=g.length;for(;v<x;)v+=this._getWritableBuffer().write(g,v,x-v)},async write(g,v,x){let y;if(v instanceof Function&&(x=v,v="utf8"),x=x||d.nop,g instanceof l)y=new h(g);else if(g instanceof o)y=new f(g);else{if(!(typeof g=="string"||g instanceof String||g instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");y=new u(g,v)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(y);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(y),i.nextTick(x)):(await this._pipe(y),x());else this.paused||this.emit("data",y.toBuffer()),this._writeToBuffers(y),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(g,v,x){const y=b=>{b?x(b):(this._flush(),this.pipes.forEach(j=>{j.end()}),this.emit("finish"))};g?this.write(g,v,y):y()},read(g){let v;if(g){for(v=[];g&&this.buffers.length&&!this.buffers[0].eod;){const x=this.buffers[0],y=x.read(g);g-=y.length,v.push(y),x.eod&&x.full&&this.buffers.shift()}return o.concat(v)}return v=this.buffers.map(x=>x.toBuffer()).filter(Boolean),this.buffers=[],o.concat(v)},setEncoding(g){this.encoding=g},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(g){this.pipes.push(g),!this.paused&&this.buffers.length&&this.end()},unpipe(g){this.pipes=this.pipes.filter(v=>v!==g)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),s.exports=p}).call(this)}).call(this,r("_process"),r("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(r,s,a){(function(i){(function(){s.exports=class{constructor(o){this._buf=i.alloc(o&&o.size||16384),this._encoding=o&&o.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=i.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(o){o=o||0,this._buffer=void 0,this._inPos=o}_grow(o){let c=2*this._buf.length;for(;c<o;)c*=2;const d=i.alloc(c);this._buf.copy(d,0),this._buf=d}addText(o){this._buffer=void 0;let c=this._inPos+this._buf.write(o,this._inPos,this._encoding);for(;c>=this._buf.length-4;)this._grow(this._inPos+o.length),c=this._inPos+this._buf.write(o,this._inPos,this._encoding);this._inPos=c}addStringBuf(o){o.length&&(this._buffer=void 0,this.length+o.length>this.capacity&&this._grow(this.length+o.length),o._buf.copy(this._buf,this._inPos,0,o.length),this._inPos+=o.length)}}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220}],26:[function(r,s,a){const{toString:i}=Object.prototype,o=/["&<>]/,c={each:function(d,l){d&&(Array.isArray(d)?d.forEach(l):Object.keys(d).forEach(u=>{l(d[u],u)}))},some:function(d,l){return!!d&&(Array.isArray(d)?d.some(l):Object.keys(d).some(u=>l(d[u],u)))},every:function(d,l){return!d||(Array.isArray(d)?d.every(l):Object.keys(d).every(u=>l(d[u],u)))},map:function(d,l){return d?Array.isArray(d)?d.map(l):Object.keys(d).map(u=>l(d[u],u)):[]},keyBy:(d,l)=>d.reduce((u,h)=>(u[h[l]]=h,u),{}),isEqual:function(d,l){const u=typeof d,h=typeof l,f=Array.isArray(d),m=Array.isArray(l);let p;if(u!==h)return!1;switch(typeof d){case"object":if(f||m)return!(!f||!m)&&d.length===l.length&&d.every((g,v)=>{const x=l[v];return c.isEqual(g,x)});if(d===null||l===null)return d===l;if(p=Object.keys(d),Object.keys(l).length!==p.length)return!1;for(const g of p)if(!l.hasOwnProperty(g))return!1;return c.every(d,(g,v)=>{const x=l[v];return c.isEqual(g,x)});default:return d===l}},escapeHtml(d){const l=o.exec(d);if(!l)return d;let u="",h="",f=0,m=l.index;for(;m<d.length;m++){switch(d.charAt(m)){case'"':h="&quot;";break;case"&":h="&amp;";break;case"'":h="&apos;";break;case"<":h="&lt;";break;case">":h="&gt;";break;default:continue}f!==m&&(u+=d.substring(f,m)),f=m+1,u+=h}return f!==m?u+d.substring(f,m):u},strcmp:(d,l)=>d<l?-1:d>l?1:0,isUndefined:d=>i.call(d)==="[object Undefined]",isObject:d=>i.call(d)==="[object Object]",deepMerge(){const d=arguments[0]||{},{length:l}=arguments;let u,h,f;function m(p,g){u=d[g],f=Array.isArray(p),c.isObject(p)||f?(f?(f=!1,h=u&&Array.isArray(u)?u:[]):h=u&&c.isObject(u)?u:{},d[g]=c.deepMerge(h,p)):c.isUndefined(p)||(d[g]=p)}for(let p=0;p<l;p++)c.each(arguments[p],m);return d}};s.exports=c},{}],27:[function(r,s,a){(function(i,o){(function(){const c=r("fs"),d=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,l={nop(){},promiseImmediate:u=>new Promise(h=>{i.setImmediate?o(()=>{h(u)}):setTimeout(()=>{h(u)},1)}),inherits:function(u,h,f,m){u.super_=h,m||(m=f,f=null),f&&Object.keys(f).forEach(g=>{Object.defineProperty(u,g,Object.getOwnPropertyDescriptor(f,g))});const p={constructor:{value:u,enumerable:!1,writable:!1,configurable:!0}};m&&Object.keys(m).forEach(g=>{p[g]=Object.getOwnPropertyDescriptor(m,g)}),u.prototype=Object.create(h.prototype,p)},dateToExcel:(u,h)=>25569+u.getTime()/864e5-(h?1462:0),excelToDate(u,h){const f=Math.round(24*(u-25569+(h?1462:0))*3600*1e3);return new Date(f)},parsePath(u){const h=u.lastIndexOf("/");return{path:u.substring(0,h),name:u.substring(h+1)}},getRelsPath(u){const h=l.parsePath(u);return`${h.path}/_rels/${h.name}.rels`},xmlEncode(u){const h=d.exec(u);if(!h)return u;let f="",m="",p=0,g=h.index;for(;g<u.length;g++){const v=u.charCodeAt(g);switch(v){case 34:m="&quot;";break;case 38:m="&amp;";break;case 39:m="&apos;";break;case 60:m="&lt;";break;case 62:m="&gt;";break;case 127:m="";break;default:if(v<=31&&(v<=8||v>=11&&v!==13)){m="";break}continue}p!==g&&(f+=u.substring(p,g)),p=g+1,m&&(f+=m)}return p!==g?f+u.substring(p,g):f},xmlDecode:u=>u.replace(/&([a-z]*);/g,h=>{switch(h){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return h}}),validInt(u){const h=parseInt(u,10);return Number.isNaN(h)?0:h},isDateFmt(u){return u?(u=(u=u.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:u=>new Promise(h=>{c.access(u,c.constants.F_OK,f=>{h(!f)})})},toIsoDateString:u=>u.toIsoString().subsstr(0,10),parseBoolean:u=>u===!0||u==="true"||u===1||u==="1"};s.exports=l}).call(this)}).call(this,typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{},r("timers").setImmediate)},{fs:216,timers:523}],28:[function(r,s,a){const i=r("./under-dash"),o=r("./utils");function c(u,h,f){u.push(` ${h}="${o.xmlEncode(f.toString())}"`)}function d(u,h){if(h){const f=[];i.each(h,(m,p)=>{m!==void 0&&c(f,p,m)}),u.push(f.join(""))}}class l{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(h){const f=this._xml;f.push("<?xml"),d(f,h),f.push(`?>
`)}openNode(h,f){const m=this.tos,p=this._xml;m&&this.open&&p.push(">"),this._stack.push(h),p.push("<"),p.push(h),d(p,f),this.leaf=!0,this.open=!0}addAttribute(h,f){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");f!==void 0&&c(this._xml,h,f)}addAttributes(h){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");d(this._xml,h)}writeText(h){const f=this._xml;this.open&&(f.push(">"),this.open=!1),this.leaf=!1,f.push(o.xmlEncode(h.toString()))}writeXml(h){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(h)}closeNode(){const h=this._stack.pop(),f=this._xml;this.leaf?f.push("/>"):(f.push("</"),f.push(h),f.push(">")),this.open=!1,this.leaf=!1}leafNode(h,f,m){this.openNode(h,f),m!==void 0&&this.writeText(m),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const h=this._rollbacks.pop();this._xml.length>h.xml&&this._xml.splice(h.xml,this._xml.length-h.xml),this._stack.length>h.stack&&this._stack.splice(h.stack,this._stack.length-h.stack),this.leaf=h.leaf,this.open=h.open}get xml(){return this.closeAll(),this._xml.join("")}}l.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},s.exports=l},{"./under-dash":26,"./utils":27}],29:[function(r,s,a){(function(i){(function(){const o=r("events"),c=r("jszip"),d=r("./stream-buf"),{stringToBuffer:l}=r("./browser-buffer-encode");class u extends o.EventEmitter{constructor(f){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},f),this.zip=new c,this.stream=new d}append(f,m){m.hasOwnProperty("base64")&&m.base64?this.zip.file(m.name,f,{base64:!0}):(i.browser&&typeof f=="string"&&(f=l(f)),this.zip.file(m.name,f))}async finalize(){const f=await this.zip.generateAsync(this.options);this.stream.end(f),this.emit("finish")}read(f){return this.stream.read(f)}setEncoding(f){return this.stream.setEncoding(f)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(f,m){return this.stream.pipe(f,m)}unpipe(f){return this.stream.unpipe(f)}unshift(f){return this.stream.unshift(f)}wrap(f){return this.stream.wrap(f)}}s.exports={ZipWriter:u}}).call(this)}).call(this,r("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(r,s,a){s.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(r,s,a){s.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(r,s,a){const i=r("../../utils/parse-sax"),o=r("../../utils/xml-stream");class c{prepare(){}render(){}parseOpen(l){}parseText(l){}parseClose(l){}reconcile(l,u){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(l=>{l instanceof c?l.reset():l.xform&&l.xform.reset()})}mergeModel(l){this.model=Object.assign(this.model||{},l)}async parse(l){for await(const u of l)for(const{eventType:h,value:f}of u)if(h==="opentag")this.parseOpen(f);else if(h==="text")this.parseText(f);else if(h==="closetag"&&!this.parseClose(f.name))return this.model;return this.model}async parseStream(l){return this.parse(i(l))}get xml(){return this.toXml(this.model)}toXml(l){const u=new o;return this.render(u,l),u.xml}static toAttribute(l,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(l===void 0){if(h)return u}else if(h||l!==u)return l.toString()}static toStringAttribute(l,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return c.toAttribute(l,u,h)}static toStringValue(l,u){return l===void 0?u:l}static toBoolAttribute(l,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(l===void 0){if(h)return u}else if(h||l!==u)return l?"1":"0"}static toBoolValue(l,u){return l===void 0?u:l==="1"}static toIntAttribute(l,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return c.toAttribute(l,u,h)}static toIntValue(l,u){return l===void 0?u:parseInt(l,10)}static toFloatAttribute(l,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return c.toAttribute(l,u,h)}static toFloatValue(l,u){return l===void 0?u:parseFloat(l)}}s.exports=c},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(r,s,a){const i=r("../base-xform"),o=r("../../../utils/col-cache");function c(l){try{return o.decodeEx(l),!0}catch{return!1}}function d(l){const u=[];let h=!1,f="";return l.split(",").forEach(m=>{if(!m)return;const p=(m.match(/'/g)||[]).length;if(!p)return void(h?f+=m+",":c(m)&&u.push(m));const g=p%2==0;!h&&g&&c(m)?u.push(m):h&&!g?(h=!1,c(f+m)&&u.push(f+m),f=""):(h=!0,f+=m+",")}),u}s.exports=class extends i{render(l,u){l.openNode("definedName",{name:u.name,localSheetId:u.localSheetId}),l.writeText(u.ranges.join(",")),l.closeNode()}parseOpen(l){switch(l.name){case"definedName":return this._parsedName=l.attributes.name,this._parsedLocalSheetId=l.attributes.localSheetId,this._parsedText=[],!0;default:return!1}}parseText(l){this._parsedText.push(l)}parseClose(){return this.model={name:this._parsedName,ranges:d(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(r,s,a){const i=r("../../../utils/utils"),o=r("../base-xform");s.exports=class extends o{render(c,d){c.leafNode("sheet",{sheetId:d.id,name:d.name,state:d.state,"r:id":d.rId})}parseOpen(c){return c.name==="sheet"&&(this.model={name:i.xmlDecode(c.attributes.name),id:parseInt(c.attributes.sheetId,10),state:c.attributes.state,rId:c.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,c){o.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:c.fullCalcOnLoad?1:void 0})}parseOpen(o){return o.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,c){o.leafNode("workbookPr",{date1904:c.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(o){return o.name==="workbookPr"&&(this.model={date1904:o.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,c){const d={xWindow:c.x||0,yWindow:c.y||0,windowWidth:c.width||12e3,windowHeight:c.height||24e3,firstSheet:c.firstSheet,activeTab:c.activeTab};c.visibility&&c.visibility!=="visible"&&(d.visibility=c.visibility),o.leafNode("workbookView",d)}parseOpen(o){if(o.name==="workbookView"){const c=this.model={},d=function(u,h,f){const m=h!==void 0?c[u]=h:f;m!==void 0&&(c[u]=m)},l=function(u,h,f){const m=h!==void 0?c[u]=parseInt(h,10):f;m!==void 0&&(c[u]=m)};return l("x",o.attributes.xWindow,0),l("y",o.attributes.yWindow,0),l("width",o.attributes.windowWidth,25e3),l("height",o.attributes.windowHeight,1e4),d("visibility",o.attributes.visibility,"visible"),l("activeTab",o.attributes.activeTab,void 0),l("firstSheet",o.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../../../utils/col-cache"),c=r("../../../utils/xml-stream"),d=r("../base-xform"),l=r("../static-xform"),u=r("../list-xform"),h=r("./defined-name-xform"),f=r("./sheet-xform"),m=r("./workbook-view-xform"),p=r("./workbook-properties-xform"),g=r("./workbook-calc-properties-xform");class v extends d{constructor(){super(),this.map={fileVersion:v.STATIC_XFORMS.fileVersion,workbookPr:new p,bookViews:new u({tag:"bookViews",count:!1,childXform:new m}),sheets:new u({tag:"sheets",count:!1,childXform:new f}),definedNames:new u({tag:"definedNames",count:!1,childXform:new h}),calcPr:new g}}prepare(y){y.sheets=y.worksheets;const b=[];let j=0;y.sheets.forEach(T=>{if(T.pageSetup&&T.pageSetup.printArea&&T.pageSetup.printArea.split("&&").forEach(O=>{const R=O.split(":"),D={name:"_xlnm.Print_Area",ranges:[`'${T.name}'!$${R[0]}:$${R[1]}`],localSheetId:j};b.push(D)}),T.pageSetup&&(T.pageSetup.printTitlesRow||T.pageSetup.printTitlesColumn)){const O=[];if(T.pageSetup.printTitlesColumn){const D=T.pageSetup.printTitlesColumn.split(":");O.push(`'${T.name}'!$${D[0]}:$${D[1]}`)}if(T.pageSetup.printTitlesRow){const D=T.pageSetup.printTitlesRow.split(":");O.push(`'${T.name}'!$${D[0]}:$${D[1]}`)}const R={name:"_xlnm.Print_Titles",ranges:O,localSheetId:j};b.push(R)}j++}),b.length&&(y.definedNames=y.definedNames.concat(b)),(y.media||[]).forEach((T,O)=>{T.name=T.type+(O+1)})}render(y,b){y.openXml(c.StdDocAttributes),y.openNode("workbook",v.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(y),this.map.workbookPr.render(y,b.properties),this.map.bookViews.render(y,b.views),this.map.sheets.render(y,b.sheets),this.map.definedNames.render(y,b.definedNames),this.map.calcPr.render(y,b.calcProperties),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"workbook":return!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"workbook":return this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1;default:return!0}}reconcile(y){const b=(y.workbookRels||[]).reduce((D,L)=>(D[L.Id]=L,D),{}),j=[];let T,O=0;(y.sheets||[]).forEach(D=>{const L=b[D.rId];L&&(T=y.worksheetHash["xl/"+L.Target.replace(/^(\s|\/xl\/)+/,"")],T&&(T.name=D.name,T.id=D.id,T.state=D.state,j[O++]=T))});const R=[];i.each(y.definedNames,D=>{if(D.name==="_xlnm.Print_Area"){if(T=j[D.localSheetId],T){T.pageSetup||(T.pageSetup={});const L=o.decodeEx(D.ranges[0]);T.pageSetup.printArea=T.pageSetup.printArea?`${T.pageSetup.printArea}&&${L.dimensions}`:L.dimensions}}else if(D.name==="_xlnm.Print_Titles"){if(T=j[D.localSheetId],T){T.pageSetup||(T.pageSetup={});const L=D.ranges.join(","),q=/\$/g,X=/\$\d+:\$\d+/,H=L.match(X);if(H&&H.length){const S=H[0];T.pageSetup.printTitlesRow=S.replace(q,"")}const M=/\$[A-Z]+:\$[A-Z]+/,F=L.match(M);if(F&&F.length){const S=F[0];T.pageSetup.printTitlesColumn=S.replace(q,"")}}}else R.push(D)}),y.definedNames=R,y.media.forEach((D,L)=>{D.index=L})}}v.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},v.STATIC_XFORMS={fileVersion:new l({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},s.exports=v},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(r,s,a){const i=r("../strings/rich-text-xform"),o=r("../../../utils/utils"),c=r("../base-xform"),d=s.exports=function(l){this.model=l};o.inherits(d,c,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new i),this._richTextXform},render(l,u){u=u||this.model,l.openNode("comment",{ref:u.ref,authorId:0}),l.openNode("text"),u&&u.note&&u.note.texts&&u.note.texts.forEach(h=>{this.richTextXform.render(l,h)}),l.closeNode(),l.closeNode()},parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"comment":return this.model={type:"note",note:{texts:[]},...l.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(l),!0;default:return!1}},parseText(l){this.parser&&this.parser.parseText(l)},parseClose(l){switch(l){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(l),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../../../utils/utils"),c=r("../base-xform"),d=r("./comment-xform"),l=s.exports=function(){this.map={comment:new d}};o.inherits(l,c,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(u,h){h=h||this.model,u.openXml(i.StdDocAttributes),u.openNode("comments",l.COMMENTS_ATTRIBUTES),u.openNode("authors"),u.leafNode("author",null,"Author"),u.closeNode(),u.openNode("commentList"),h.comments.forEach(f=>{this.map.comment.render(u,f)}),u.closeNode(),u.closeNode()},parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(u),!0;default:return!1}},parseText(u){this.parser&&this.parser.parseText(u)},parseClose(u){switch(u){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,c,d){(c===d[2]||this.tag==="x:SizeWithCells"&&c===d[1])&&o.leafNode(this.tag)}parseOpen(o){switch(o.name){case this.tag:return this.model={},this.model[this.tag]=!0,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,c){o.leafNode(this.tag,null,c)}parseOpen(o){switch(o.name){case this.tag:return this.text="",!0;default:return!1}}parseText(o){this.text=o}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"x:Anchor"}getAnchorRect(o){const c=Math.floor(o.left),d=Math.floor(68*(o.left-c)),l=Math.floor(o.top),u=Math.floor(18*(o.top-l)),h=Math.floor(o.right),f=Math.floor(68*(o.right-h)),m=Math.floor(o.bottom);return[c,d,l,u,h,f,m,Math.floor(18*(o.bottom-m))]}getDefaultRect(o){const c=o.col,d=Math.max(o.row-2,0);return[c,6,d,14,c+2,2,d+4,16]}render(o,c){const d=c.anchor?this.getAnchorRect(c.anchor):this.getDefaultRect(c.refAddress);o.leafNode("x:Anchor",null,d.join(", "))}parseOpen(o){switch(o.name){case this.tag:return this.text="",!0;default:return!1}}parseText(o){this.text=o}parseClose(){return!1}}},{"../base-xform":32}],44:[function(r,s,a){const i=r("../base-xform"),o=r("./vml-anchor-xform"),c=r("./style/vml-protection-xform"),d=r("./style/vml-position-xform"),l=["twoCells","oneCells","absolute"];s.exports=class extends i{constructor(){super(),this.map={"x:Anchor":new o,"x:Locked":new c({tag:"x:Locked"}),"x:LockText":new c({tag:"x:LockText"}),"x:SizeWithCells":new d({tag:"x:SizeWithCells"}),"x:MoveWithCells":new d({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(u,h){const{protection:f,editAs:m}=h.note;u.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(u,m,l),this.map["x:SizeWithCells"].render(u,m,l),this.map["x:Anchor"].render(u,h),this.map["x:Locked"].render(u,f.locked),u.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(u,f.lockText),u.leafNode("x:Row",null,h.refAddress.row-1),u.leafNode("x:Column",null,h.refAddress.col-1),u.closeNode()}parseOpen(u){switch(u.name){case this.tag:this.reset(),this.model={anchor:[],protection:{},editAs:""};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.normalizeModel(),!1;default:return!0}}normalizeModel(){const u=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),h=Object.keys(u).length;this.model.editAs=l[h],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),c=r("./vml-shape-xform");class d extends o{constructor(){super(),this.map={"v:shape":new c}}get tag(){return"xml"}render(u,h){u.openXml(i.StdDocAttributes),u.openNode(this.tag,d.DRAWING_ATTRIBUTES),u.openNode("o:shapelayout",{"v:ext":"edit"}),u.leafNode("o:idmap",{"v:ext":"edit",data:1}),u.closeNode(),u.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),u.leafNode("v:stroke",{joinstyle:"miter"}),u.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),u.closeNode(),h.comments.forEach((f,m)=>{this.map["v:shape"].render(u,f,m)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={comments:[]};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}reconcile(u,h){u.anchors.forEach(f=>{f.br?this.map["xdr:twoCellAnchor"].reconcile(f,h):this.map["xdr:oneCellAnchor"].reconcile(f,h)})}}d.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},s.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(r,s,a){const i=r("../base-xform"),o=r("./vml-textbox-xform"),c=r("./vml-client-data-xform");class d extends i{constructor(){super(),this.map={"v:textbox":new o,"x:ClientData":new c}}get tag(){return"v:shape"}render(u,h,f){u.openNode("v:shape",d.V_SHAPE_ATTRIBUTES(h,f)),u.leafNode("v:fill",{color2:"infoBackground [80]"}),u.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),u.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(u,h),this.map["x:ClientData"].render(u,h),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset(),this.model={margins:{insetmode:u.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}};break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1;default:return!0}}}d.V_SHAPE_ATTRIBUTES=(l,u)=>({id:"_x0000_s"+(1025+u),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":l.note.margins&&l.note.margins.insetmode}),s.exports=d},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"v:textbox"}conversionUnit(o,c,d){return`${parseFloat(o)*c.toFixed(2)}${d}`}reverseConversionUnit(o){return(o||"").split(",").map(c=>Number(parseFloat(this.conversionUnit(parseFloat(c),.1,"")).toFixed(2)))}render(o,c){const d={style:"mso-direction-alt:auto"};if(c&&c.note){let{inset:l}=c.note&&c.note.margins;Array.isArray(l)&&(l=l.map(u=>this.conversionUnit(u,10,"mm")).join(",")),l&&(d.inset=l)}o.openNode("v:textbox",d),o.leafNode("div",{style:"text-align:left"}),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:return this.model={inset:this.reverseConversionUnit(o.attributes.inset)},!0;default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],48:[function(r,s,a){const i=r("./base-xform");s.exports=class extends i{createNewModel(o){return{}}parseOpen(o){return this.parser=this.parser||this.map[o.name],this.parser?(this.parser.parseOpen(o),!0):o.name===this.tag&&(this.model=this.createNewModel(o),!0)}parseText(o){this.parser&&this.parser.parseText(o)}onParserClose(o,c){this.model[o]=c.model}parseClose(o){return this.parser?(this.parser.parseClose(o)||(this.onParserClose(o,this.parser),this.parser=void 0),!0):o!==this.tag}}},{"./base-xform":32}],49:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,c){o.openNode("HeadingPairs"),o.openNode("vt:vector",{size:2,baseType:"variant"}),o.openNode("vt:variant"),o.leafNode("vt:lpstr",void 0,"Worksheets"),o.closeNode(),o.openNode("vt:variant"),o.leafNode("vt:i4",void 0,c.length),o.closeNode(),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="HeadingPairs"}parseText(){}parseClose(o){return o!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,c){o.openNode("TitlesOfParts"),o.openNode("vt:vector",{size:c.length,baseType:"lpstr"}),c.forEach(d=>{o.leafNode("vt:lpstr",void 0,d.name)}),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="TitlesOfParts"}parseText(){}parseClose(o){return o!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),c=r("../simple/string-xform"),d=r("./app-heading-pairs-xform"),l=r("./app-titles-of-parts-xform");class u extends o{constructor(){super(),this.map={Company:new c({tag:"Company"}),Manager:new c({tag:"Manager"}),HeadingPairs:new d,TitleOfParts:new l}}render(f,m){f.openXml(i.StdDocAttributes),f.openNode("Properties",u.PROPERTY_ATTRIBUTES),f.leafNode("Application",void 0,"Microsoft Excel"),f.leafNode("DocSecurity",void 0,"0"),f.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(f,m.worksheets),this.map.TitleOfParts.render(f,m.worksheets),this.map.Company.render(f,m.company||""),this.map.Manager.render(f,m.manager),f.leafNode("LinksUpToDate",void 0,"false"),f.leafNode("SharedDoc",void 0,"false"),f.leafNode("HyperlinksChanged",void 0,"false"),f.leafNode("AppVersion",void 0,"16.0300"),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"Properties":return!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"Properties":return this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1;default:return!0}}}u.DateFormat=function(h){return h.toISOString().replace(/[.]\d{3,6}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},s.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform");class c extends o{render(l,u){l.openXml(i.StdDocAttributes),l.openNode("Types",c.PROPERTY_ATTRIBUTES);const h={};(u.media||[]).forEach(f=>{if(f.type==="image"){const m=f.extension;h[m]||(h[m]=!0,l.leafNode("Default",{Extension:m,ContentType:"image/"+m}))}}),l.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),l.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),l.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),u.worksheets.forEach(f=>{const m=`/xl/worksheets/sheet${f.id}.xml`;l.leafNode("Override",{PartName:m,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),l.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),l.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),u.sharedStrings&&u.sharedStrings.count&&l.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),u.tables&&u.tables.forEach(f=>{l.leafNode("Override",{PartName:"/xl/tables/"+f.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),u.drawings&&u.drawings.forEach(f=>{l.leafNode("Override",{PartName:`/xl/drawings/${f.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),u.commentRefs&&(l.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),u.commentRefs.forEach(f=>{let{commentName:m}=f;l.leafNode("Override",{PartName:`/xl/${m}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),l.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),l.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),l.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}c.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},s.exports=c},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),c=r("../simple/date-xform"),d=r("../simple/string-xform"),l=r("../simple/integer-xform");class u extends o{constructor(){super(),this.map={"dc:creator":new d({tag:"dc:creator"}),"dc:title":new d({tag:"dc:title"}),"dc:subject":new d({tag:"dc:subject"}),"dc:description":new d({tag:"dc:description"}),"dc:identifier":new d({tag:"dc:identifier"}),"dc:language":new d({tag:"dc:language"}),"cp:keywords":new d({tag:"cp:keywords"}),"cp:category":new d({tag:"cp:category"}),"cp:lastModifiedBy":new d({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new c({tag:"cp:lastPrinted",format:u.DateFormat}),"cp:revision":new l({tag:"cp:revision"}),"cp:version":new d({tag:"cp:version"}),"cp:contentStatus":new d({tag:"cp:contentStatus"}),"cp:contentType":new d({tag:"cp:contentType"}),"dcterms:created":new c({tag:"dcterms:created",attrs:u.DateAttrs,format:u.DateFormat}),"dcterms:modified":new c({tag:"dcterms:modified",attrs:u.DateAttrs,format:u.DateFormat})}}render(f,m){f.openXml(i.StdDocAttributes),f.openNode("cp:coreProperties",u.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(f,m.creator),this.map["dc:title"].render(f,m.title),this.map["dc:subject"].render(f,m.subject),this.map["dc:description"].render(f,m.description),this.map["dc:identifier"].render(f,m.identifier),this.map["dc:language"].render(f,m.language),this.map["cp:keywords"].render(f,m.keywords),this.map["cp:category"].render(f,m.category),this.map["cp:lastModifiedBy"].render(f,m.lastModifiedBy),this.map["cp:lastPrinted"].render(f,m.lastPrinted),this.map["cp:revision"].render(f,m.revision),this.map["cp:version"].render(f,m.version),this.map["cp:contentStatus"].render(f,m.contentStatus),this.map["cp:contentType"].render(f,m.contentType),this.map["dcterms:created"].render(f,m.created),this.map["dcterms:modified"].render(f,m.modified),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[f.name],this.parser)return this.parser.parseOpen(f),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(f))}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.parser=void 0),!0;switch(f){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+f)}}}u.DateFormat=function(h){return h.toISOString().replace(/[.]\d{3}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},s.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{render(o,c){o.leafNode("Relationship",c)}parseOpen(o){switch(o.name){case"Relationship":return this.model=o.attributes,!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),c=r("./relationship-xform");class d extends o{constructor(){super(),this.map={Relationship:new c}}render(u,h){h=h||this._values,u.openXml(i.StdDocAttributes),u.openNode("Relationships",d.RELATIONSHIPS_ATTRIBUTES),h.forEach(f=>{this.map.Relationship.render(u,f)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[u.name],this.parser)return this.parser.parseOpen(u),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.push(this.parser.model),this.parser=void 0),!0;switch(u){case"Relationships":return!1;default:throw new Error("Unexpected xml node in parseClose: "+u)}}}d.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},s.exports=d},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case this.tag:this.reset(),this.model={range:{editAs:o.attributes.editAs||"oneCell"}};break;default:this.parser=this.map[o.name],this.parser&&this.parser.parseOpen(o)}return!0}parseText(o){this.parser&&this.parser.parseText(o)}reconcilePicture(o,c){if(o&&o.rId){const d=c.rels[o.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(d){const l=d[1],u=c.mediaIndex[l];return c.media[u]}}}}},{"../base-xform":32}],57:[function(r,s,a){const i=r("../base-xform"),o=r("./blip-xform");s.exports=class extends i{constructor(){super(),this.map={"a:blip":new o}}get tag(){return"xdr:blipFill"}render(c,d){c.openNode(this.tag),this.map["a:blip"].render(c,d),c.openNode("a:stretch"),c.leafNode("a:fillRect"),c.closeNode(),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset();break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(){}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model=this.map["a:blip"].model,!1;default:return!0}}}},{"../base-xform":32,"./blip-xform":58}],58:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"a:blip"}render(o,c){o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":c.rId,cstate:"print"})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:embed"]},!0;default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],59:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"xdr:cNvPicPr"}render(o){o.openNode(this.tag),o.leafNode("a:picLocks",{noChangeAspect:"1"}),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],60:[function(r,s,a){const i=r("../base-xform"),o=r("./hlink-click-xform"),c=r("./ext-lst-xform");s.exports=class extends i{constructor(){super(),this.map={"a:hlinkClick":new o,"a:extLst":new c}}get tag(){return"xdr:cNvPr"}render(d,l){d.openNode(this.tag,{id:l.index,name:"Picture "+l.index}),this.map["a:hlinkClick"].render(d,l),this.map["a:extLst"].render(d,l),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:this.reset();break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(){}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case this.tag:return this.model=this.map["a:hlinkClick"].model,!1;default:return!0}}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(r,s,a){const i=r("../base-xform"),o=r("../simple/integer-xform");s.exports=class extends i{constructor(c){super(),this.tag=c.tag,this.map={"xdr:col":new o({tag:"xdr:col",zero:!0}),"xdr:colOff":new o({tag:"xdr:colOff",zero:!0}),"xdr:row":new o({tag:"xdr:row",zero:!0}),"xdr:rowOff":new o({tag:"xdr:rowOff",zero:!0})}}render(c,d){c.openNode(this.tag),this.map["xdr:col"].render(c,d.nativeCol),this.map["xdr:colOff"].render(c,d.nativeColOff),this.map["xdr:row"].render(c,d.nativeRow),this.map["xdr:rowOff"].render(c,d.nativeRowOff),c.closeNode()}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:this.reset();break;default:this.parser=this.map[c.name],this.parser&&this.parser.parseOpen(c)}return!0}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;switch(c){case this.tag:return this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1;default:return!0}}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(r,s,a){const i=r("../../../utils/col-cache"),o=r("../../../utils/xml-stream"),c=r("../base-xform"),d=r("./two-cell-anchor-xform"),l=r("./one-cell-anchor-xform");class u extends c{constructor(){super(),this.map={"xdr:twoCellAnchor":new d,"xdr:oneCellAnchor":new l}}prepare(f){f.anchors.forEach((m,p)=>{m.anchorType=function(g){return(typeof g.range=="string"?i.decode(g.range):g.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"}(m),this.map[m.anchorType].prepare(m,{index:p})})}get tag(){return"xdr:wsDr"}render(f,m){f.openXml(o.StdDocAttributes),f.openNode(this.tag,u.DRAWING_ATTRIBUTES),m.anchors.forEach(p=>{this.map[p.anchorType].render(f,p)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:this.reset(),this.model={anchors:[]};break;default:this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f)}return!0}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){if(this.parser)return this.parser.parseClose(f)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0;switch(f){case this.tag:return!1;default:return!0}}reconcile(f,m){f.anchors.forEach(p=>{p.br?this.map["xdr:twoCellAnchor"].reconcile(p,m):this.map["xdr:oneCellAnchor"].reconcile(p,m)})}}u.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},s.exports=u},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"a:extLst"}render(o){o.openNode(this.tag),o.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),o.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),o.closeNode(),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){switch(o){case this.tag:return!1;default:return!0}}}},{"../base-xform":32}],64:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.map={}}render(o,c){o.openNode(this.tag);const d=Math.floor(9525*c.width),l=Math.floor(9525*c.height);o.addAttribute("cx",d),o.addAttribute("cy",l),o.closeNode()}parseOpen(o){return o.name===this.tag&&(this.model={width:parseInt(o.attributes.cx||"0",10)/9525,height:parseInt(o.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"a:hlinkClick"}render(o,c){c.hyperlinks&&c.hyperlinks.rId&&o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":c.hyperlinks.rId,tooltip:c.hyperlinks.tooltip})}parseOpen(o){switch(o.name){case this.tag:return this.model={hyperlinks:{rId:o.attributes["r:id"],tooltip:o.attributes.tooltip}},!0;default:return!0}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(r,s,a){const i=r("../base-xform"),o=r("./c-nv-pr-xform"),c=r("./c-nv-pic-pr-xform");s.exports=class extends i{constructor(){super(),this.map={"xdr:cNvPr":new o,"xdr:cNvPicPr":new c}}get tag(){return"xdr:nvPicPr"}render(d,l){d.openNode(this.tag),this.map["xdr:cNvPr"].render(d,l),this.map["xdr:cNvPicPr"].render(d,l),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case this.tag:this.reset();break;default:this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)}return!0}parseText(){}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case this.tag:return this.model=this.map["xdr:cNvPr"].model,!1;default:return!0}}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(r,s,a){const i=r("./base-cell-anchor-xform"),o=r("../static-xform"),c=r("./cell-position-xform"),d=r("./ext-xform"),l=r("./pic-xform");s.exports=class extends i{constructor(){super(),this.map={"xdr:from":new c({tag:"xdr:from"}),"xdr:ext":new d({tag:"xdr:ext"}),"xdr:pic":new l,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(u,h){this.map["xdr:pic"].prepare(u.picture,h)}render(u,h){u.openNode(this.tag,{editAs:h.range.editAs||"oneCell"}),this.map["xdr:from"].render(u,h.range.tl),this.map["xdr:ext"].render(u,h.range.ext),this.map["xdr:pic"].render(u,h.picture),this.map["xdr:clientData"].render(u,{}),u.closeNode()}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.parser=void 0),!0;switch(u){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(u,h){u.medium=this.reconcilePicture(u.picture,h)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(r,s,a){const i=r("../base-xform"),o=r("../static-xform"),c=r("./blip-fill-xform"),d=r("./nv-pic-pr-xform"),l=r("./sp-pr");s.exports=class extends i{constructor(){super(),this.map={"xdr:nvPicPr":new d,"xdr:blipFill":new c,"xdr:spPr":new o(l)}}get tag(){return"xdr:pic"}prepare(u,h){u.index=h.index+1}render(u,h){u.openNode(this.tag),this.map["xdr:nvPicPr"].render(u,h),this.map["xdr:blipFill"].render(u,h),this.map["xdr:spPr"].render(u,h),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.tag:this.reset();break;default:this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)}return!0}parseText(){}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.mergeModel(this.parser.model),this.parser=void 0),!0;switch(u){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(r,s,a){s.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(r,s,a){const i=r("./base-cell-anchor-xform"),o=r("../static-xform"),c=r("./cell-position-xform"),d=r("./pic-xform");s.exports=class extends i{constructor(){super(),this.map={"xdr:from":new c({tag:"xdr:from"}),"xdr:to":new c({tag:"xdr:to"}),"xdr:pic":new d,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(l,u){this.map["xdr:pic"].prepare(l.picture,u)}render(l,u){l.openNode(this.tag,{editAs:u.range.editAs||"oneCell"}),this.map["xdr:from"].render(l,u.range.tl),this.map["xdr:to"].render(l,u.range.br),this.map["xdr:pic"].render(l,u.picture),this.map["xdr:clientData"].render(l,{}),l.closeNode()}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1;default:return!0}}reconcile(l,u){l.medium=this.reconcilePicture(l.picture,u)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(r,s,a){const i=r("./base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.always=!!o.always,this.count=o.count,this.empty=o.empty,this.$count=o.$count||"count",this.$=o.$,this.childXform=o.childXform,this.maxItems=o.maxItems}prepare(o,c){const{childXform:d}=this;o&&o.forEach((l,u)=>{c.index=u,d.prepare(l,c)})}render(o,c){if(this.always||c&&c.length){o.openNode(this.tag,this.$),this.count&&o.addAttribute(this.$count,c&&c.length||0);const{childXform:d}=this;(c||[]).forEach((l,u)=>{d.render(o,l,u)}),o.closeNode()}else this.empty&&o.leafNode(this.tag)}parseOpen(o){if(this.parser)return this.parser.parseOpen(o),!0;switch(o.name){case this.tag:return this.model=[],!0;default:return!!this.childXform.parseOpen(o)&&(this.parser=this.childXform,!0)}}parseText(o){this.parser&&this.parser.parseText(o)}parseClose(o){if(this.parser){if(!this.parser.parseClose(o)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(o,c){if(o){const{childXform:d}=this;o.forEach(l=>{d.reconcile(l,c)})}}}},{"./base-xform":32}],72:[function(r,s,a){const i=r("../../../utils/col-cache"),o=r("../base-xform");s.exports=class extends o{get tag(){return"autoFilter"}render(c,d){if(d)if(typeof d=="string")c.leafNode("autoFilter",{ref:d});else{const l=function(f){return typeof f=="string"?f:i.getAddress(f.row,f.column).address},u=l(d.from),h=l(d.to);u&&h&&c.leafNode("autoFilter",{ref:`${u}:${h}`})}}parseOpen(c){c.name==="autoFilter"&&(this.model=c.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(r,s,a){const i=r("../../../utils/utils"),o=r("../base-xform"),c=r("../../../doc/range"),d=r("../../../doc/enums"),l=r("../strings/rich-text-xform");function u(h){if(h==null)return d.ValueType.Null;if(h instanceof String||typeof h=="string")return d.ValueType.String;if(typeof h=="number")return d.ValueType.Number;if(typeof h=="boolean")return d.ValueType.Boolean;if(h instanceof Date)return d.ValueType.Date;if(h.text&&h.hyperlink)return d.ValueType.Hyperlink;if(h.formula)return d.ValueType.Formula;if(h.error)return d.ValueType.Error;throw new Error("I could not understand type of value")}s.exports=class extends o{constructor(){super(),this.richTextXForm=new l}get tag(){return"c"}prepare(h,f){const m=f.styles.addStyleModel(h.style||{},function(p){switch(p.type){case d.ValueType.Formula:return u(p.result);default:return p.type}}(h));switch(m&&(h.styleId=m),h.comment&&f.comments.push({...h.comment,ref:h.address}),h.type){case d.ValueType.String:case d.ValueType.RichText:f.sharedStrings&&(h.ssId=f.sharedStrings.add(h.value));break;case d.ValueType.Date:f.date1904&&(h.date1904=!0);break;case d.ValueType.Hyperlink:f.sharedStrings&&h.text!==void 0&&h.text!==null&&(h.ssId=f.sharedStrings.add(h.text)),f.hyperlinks.push({address:h.address,target:h.hyperlink,tooltip:h.tooltip});break;case d.ValueType.Merge:f.merges.add(h);break;case d.ValueType.Formula:if(f.date1904&&(h.date1904=!0),h.shareType==="shared"&&(h.si=f.siFormulae++),h.formula)f.formulae[h.address]=h;else if(h.sharedFormula){const p=f.formulae[h.sharedFormula];if(!p)throw new Error("Shared Formula master must exist above and or left of clone for cell "+h.address);p.si===void 0?(p.shareType="shared",p.si=f.siFormulae++,p.range=new c(p.address,h.address)):p.range&&p.range.expandToAddress(h.address),h.si=p.si}}}renderFormula(h,f){let m=null;switch(f.shareType){case"shared":m={t:"shared",ref:f.ref||f.range.range,si:f.si};break;case"array":m={t:"array",ref:f.ref};break;default:f.si!==void 0&&(m={t:"shared",si:f.si})}switch(u(f.result)){case d.ValueType.Null:h.leafNode("f",m,f.formula);break;case d.ValueType.String:h.addAttribute("t","str"),h.leafNode("f",m,f.formula),h.leafNode("v",null,f.result);break;case d.ValueType.Number:h.leafNode("f",m,f.formula),h.leafNode("v",null,f.result);break;case d.ValueType.Boolean:h.addAttribute("t","b"),h.leafNode("f",m,f.formula),h.leafNode("v",null,f.result?1:0);break;case d.ValueType.Error:h.addAttribute("t","e"),h.leafNode("f",m,f.formula),h.leafNode("v",null,f.result.error);break;case d.ValueType.Date:h.leafNode("f",m,f.formula),h.leafNode("v",null,i.dateToExcel(f.result,f.date1904));break;default:throw new Error("I could not understand type of value")}}render(h,f){if(f.type!==d.ValueType.Null||f.styleId){switch(h.openNode("c"),h.addAttribute("r",f.address),f.styleId&&h.addAttribute("s",f.styleId),f.type){case d.ValueType.Null:break;case d.ValueType.Number:h.leafNode("v",null,f.value);break;case d.ValueType.Boolean:h.addAttribute("t","b"),h.leafNode("v",null,f.value?"1":"0");break;case d.ValueType.Error:h.addAttribute("t","e"),h.leafNode("v",null,f.value.error);break;case d.ValueType.String:case d.ValueType.RichText:f.ssId!==void 0?(h.addAttribute("t","s"),h.leafNode("v",null,f.ssId)):f.value&&f.value.richText?(h.addAttribute("t","inlineStr"),h.openNode("is"),f.value.richText.forEach(m=>{this.richTextXForm.render(h,m)}),h.closeNode("is")):(h.addAttribute("t","str"),h.leafNode("v",null,f.value));break;case d.ValueType.Date:h.leafNode("v",null,i.dateToExcel(f.value,f.date1904));break;case d.ValueType.Hyperlink:f.ssId!==void 0?(h.addAttribute("t","s"),h.leafNode("v",null,f.ssId)):(h.addAttribute("t","str"),h.leafNode("v",null,f.text));break;case d.ValueType.Formula:this.renderFormula(h,f);break;case d.ValueType.Merge:}h.closeNode()}}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"c":return this.model={address:h.attributes.r},this.t=h.attributes.t,h.attributes.s&&(this.model.styleId=parseInt(h.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=h.attributes.si,this.model.shareType=h.attributes.t,this.model.ref=h.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(h),!0;default:return!1}}parseText(h){if(this.parser)this.parser.parseText(h);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+h:h;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+h:h:this.model.value=this.model.value?this.model.value+h:h}}parseClose(h){switch(h){case"c":{const{model:f}=this;if(f.formula||f.shareType)f.type=d.ValueType.Formula,f.value&&(this.t==="str"?f.result=i.xmlDecode(f.value):this.t==="b"?f.result=parseInt(f.value,10)!==0:this.t==="e"?f.result={error:f.value}:f.result=parseFloat(f.value),f.value=void 0);else if(f.value!==void 0)switch(this.t){case"s":f.type=d.ValueType.String,f.value=parseInt(f.value,10);break;case"str":f.type=d.ValueType.String,f.value=i.xmlDecode(f.value);break;case"inlineStr":f.type=d.ValueType.String;break;case"b":f.type=d.ValueType.Boolean,f.value=parseInt(f.value,10)!==0;break;case"e":f.type=d.ValueType.Error,f.value={error:f.value};break;default:f.type=d.ValueType.Number,f.value=parseFloat(f.value)}else f.styleId?f.type=d.ValueType.Null:f.type=d.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(h),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(h),!0)}}reconcile(h,f){const m=h.styleId&&f.styles&&f.styles.getStyleModel(h.styleId);switch(m&&(h.style=m),h.styleId!==void 0&&(h.styleId=void 0),h.type){case d.ValueType.String:typeof h.value=="number"&&f.sharedStrings&&(h.value=f.sharedStrings.getString(h.value)),h.value.richText&&(h.type=d.ValueType.RichText);break;case d.ValueType.Number:m&&i.isDateFmt(m.numFmt)&&(h.type=d.ValueType.Date,h.value=i.excelToDate(h.value,f.date1904));break;case d.ValueType.Formula:h.result!==void 0&&m&&i.isDateFmt(m.numFmt)&&(h.result=i.excelToDate(h.result,f.date1904)),h.shareType==="shared"&&(h.ref?f.formulae[h.si]=h.address:(h.sharedFormula=f.formulae[h.si],delete h.shareType),delete h.si)}const p=f.hyperlinkMap[h.address];p&&(h.type===d.ValueType.Formula?(h.text=h.result,h.result=void 0):(h.text=h.value,h.value=void 0),h.type=d.ValueType.Hyperlink,h.hyperlink=p);const g=f.commentsMap&&f.commentsMap[h.address];g&&(h.comment=g)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{get tag(){return"x14:cfIcon"}render(o,c){o.leafNode(this.tag,{iconSet:c.iconSet,iconId:c.iconId})}parseOpen(o){let{attributes:c}=o;this.model={iconSet:c.iconSet,iconId:i.toIntValue(c.iconId)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],75:[function(r,s,a){const{v4:i}=r("uuid"),o=r("../../base-xform"),c=r("../../composite-xform"),d=r("./databar-ext-xform"),l=r("./icon-set-ext-xform"),u={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class h extends c{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new d,"x14:iconSet":this.iconSetXform=new l}}get tag(){return"x14:cfRule"}static isExt(m){return m.type==="dataBar"?d.isExt(m):!(m.type!=="iconSet"||!m.custom&&!u[m.iconSet])}prepare(m){h.isExt(m)&&(m.x14Id=`{${i()}}`.toUpperCase())}render(m,p){if(h.isExt(p))switch(p.type){case"dataBar":this.renderDataBar(m,p);break;case"iconSet":this.renderIconSet(m,p)}}renderDataBar(m,p){m.openNode(this.tag,{type:"dataBar",id:p.x14Id}),this.databarXform.render(m,p),m.closeNode()}renderIconSet(m,p){m.openNode(this.tag,{type:"iconSet",priority:p.priority,id:p.x14Id||`{${i()}}`}),this.iconSetXform.render(m,p),m.closeNode()}createNewModel(m){let{attributes:p}=m;return{type:p.type,x14Id:p.id,priority:o.toIntValue(p.priority)}}onParserClose(m,p){Object.assign(this.model,p.model)}}s.exports=h},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(r,s,a){const i=r("../../composite-xform"),o=r("./f-ext-xform");s.exports=class extends i{constructor(){super(),this.map={"xm:f":this.fExtXform=new o}}get tag(){return"x14:cfvo"}render(c,d){c.openNode(this.tag,{type:d.type}),d.value!==void 0&&this.fExtXform.render(c,d.value),c.closeNode()}createNewModel(c){return{type:c.attributes.type}}onParserClose(c,d){switch(c){case"xm:f":this.model.value=d.model?parseFloat(d.model):0}}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(r,s,a){const i=r("../../composite-xform"),o=r("./sqref-ext-xform"),c=r("./cf-rule-ext-xform");s.exports=class extends i{constructor(){super(),this.map={"xm:sqref":this.sqRef=new o,"x14:cfRule":this.cfRule=new c}}get tag(){return"x14:conditionalFormatting"}prepare(d,l){d.rules.forEach(u=>{this.cfRule.prepare(u,l)})}render(d,l){l.rules.some(c.isExt)&&(d.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),l.rules.filter(c.isExt).forEach(u=>this.cfRule.render(d,u)),this.sqRef.render(d,l.ref),d.closeNode())}createNewModel(){return{rules:[]}}onParserClose(d,l){switch(d){case"xm:sqref":this.model.ref=l.model;break;case"x14:cfRule":this.model.rules.push(l.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(r,s,a){const i=r("../../composite-xform"),o=r("./cf-rule-ext-xform"),c=r("./conditional-formatting-ext-xform");s.exports=class extends i{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new c}}get tag(){return"x14:conditionalFormattings"}hasContent(d){return d.hasExtContent===void 0&&(d.hasExtContent=d.some(l=>l.rules.some(o.isExt))),d.hasExtContent}prepare(d,l){d.forEach(u=>{this.cfXform.prepare(u,l)})}render(d,l){this.hasContent(l)&&(d.openNode(this.tag),l.forEach(u=>this.cfXform.render(d,u)),d.closeNode())}createNewModel(){return[]}onParserClose(d,l){this.model.push(l.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(r,s,a){const i=r("../../base-xform"),o=r("../../composite-xform"),c=r("../../style/color-xform"),d=r("./cfvo-ext-xform");s.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new d,"x14:borderColor":this.borderColorXform=new c("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new c("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new c("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new c("x14:axisColor")}}static isExt(l){return!l.gradient}get tag(){return"x14:dataBar"}render(l,u){l.openNode(this.tag,{minLength:i.toIntAttribute(u.minLength,0,!0),maxLength:i.toIntAttribute(u.maxLength,100,!0),border:i.toBoolAttribute(u.border,!1),gradient:i.toBoolAttribute(u.gradient,!0),negativeBarColorSameAsPositive:i.toBoolAttribute(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolAttribute(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toAttribute(u.axisPosition,"auto"),direction:i.toAttribute(u.direction,"leftToRight")}),u.cfvo.forEach(h=>{this.cfvoXform.render(l,h)}),this.borderColorXform.render(l,u.borderColor),this.negativeBorderColorXform.render(l,u.negativeBorderColor),this.negativeFillColorXform.render(l,u.negativeFillColor),this.axisColorXform.render(l,u.axisColor),l.closeNode()}createNewModel(l){let{attributes:u}=l;return{cfvo:[],minLength:i.toIntValue(u.minLength,0),maxLength:i.toIntValue(u.maxLength,100),border:i.toBoolValue(u.border,!1),gradient:i.toBoolValue(u.gradient,!0),negativeBarColorSameAsPositive:i.toBoolValue(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:i.toBoolValue(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:i.toStringValue(u.axisPosition,"auto"),direction:i.toStringValue(u.direction,"leftToRight")}}onParserClose(l,u){const[,h]=l.split(":");switch(h){case"cfvo":this.model.cfvo.push(u.model);break;default:this.model[h]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{get tag(){return"xm:f"}render(o,c){o.leafNode(this.tag,null,c)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],81:[function(r,s,a){const i=r("../../base-xform"),o=r("../../composite-xform"),c=r("./cfvo-ext-xform"),d=r("./cf-icon-ext-xform");s.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new c,"x14:cfIcon":this.cfIconXform=new d}}get tag(){return"x14:iconSet"}render(l,u){l.openNode(this.tag,{iconSet:i.toStringAttribute(u.iconSet),reverse:i.toBoolAttribute(u.reverse,!1),showValue:i.toBoolAttribute(u.showValue,!0),custom:i.toBoolAttribute(u.icons,!1)}),u.cfvo.forEach(h=>{this.cfvoXform.render(l,h)}),u.icons&&u.icons.forEach((h,f)=>{h.iconId=f,this.cfIconXform.render(l,h)}),l.closeNode()}createNewModel(l){let{attributes:u}=l;return{cfvo:[],iconSet:i.toStringValue(u.iconSet,"3TrafficLights"),reverse:i.toBoolValue(u.reverse,!1),showValue:i.toBoolValue(u.showValue,!0)}}onParserClose(l,u){const[,h]=l.split(":");switch(h){case"cfvo":this.model.cfvo.push(u.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(u.model);break;default:this.model[h]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{get tag(){return"xm:sqref"}render(o,c){o.leafNode(this.tag,null,c)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],83:[function(r,s,a){const i=r("../../base-xform"),o=r("../../composite-xform"),c=r("../../../../doc/range"),d=r("./databar-xform"),l=r("./ext-lst-ref-xform"),u=r("./formula-xform"),h=r("./color-scale-xform"),f=r("./icon-set-xform"),m={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},p=v=>{const{type:x,operator:y}=v;switch(x){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:x};default:return{type:x,operator:y}}};class g extends o{constructor(){super(),this.map={dataBar:this.databarXform=new d,extLst:this.extLstRefXform=new l,formula:this.formulaXform=new u,colorScale:this.colorScaleXform=new h,iconSet:this.iconSetXform=new f}}get tag(){return"cfRule"}static isPrimitive(x){return x.type!=="iconSet"||!x.custom&&!m[x.iconSet]}render(x,y){switch(y.type){case"expression":this.renderExpression(x,y);break;case"cellIs":this.renderCellIs(x,y);break;case"top10":this.renderTop10(x,y);break;case"aboveAverage":this.renderAboveAverage(x,y);break;case"dataBar":this.renderDataBar(x,y);break;case"colorScale":this.renderColorScale(x,y);break;case"iconSet":this.renderIconSet(x,y);break;case"containsText":this.renderText(x,y);break;case"timePeriod":this.renderTimePeriod(x,y)}}renderExpression(x,y){x.openNode(this.tag,{type:"expression",dxfId:y.dxfId,priority:y.priority}),this.formulaXform.render(x,y.formulae[0]),x.closeNode()}renderCellIs(x,y){x.openNode(this.tag,{type:"cellIs",dxfId:y.dxfId,priority:y.priority,operator:y.operator}),y.formulae.forEach(b=>{this.formulaXform.render(x,b)}),x.closeNode()}renderTop10(x,y){x.leafNode(this.tag,{type:"top10",dxfId:y.dxfId,priority:y.priority,percent:i.toBoolAttribute(y.percent,!1),bottom:i.toBoolAttribute(y.bottom,!1),rank:i.toIntValue(y.rank,10,!0)})}renderAboveAverage(x,y){x.leafNode(this.tag,{type:"aboveAverage",dxfId:y.dxfId,priority:y.priority,aboveAverage:i.toBoolAttribute(y.aboveAverage,!0)})}renderDataBar(x,y){x.openNode(this.tag,{type:"dataBar",priority:y.priority}),this.databarXform.render(x,y),this.extLstRefXform.render(x,y),x.closeNode()}renderColorScale(x,y){x.openNode(this.tag,{type:"colorScale",priority:y.priority}),this.colorScaleXform.render(x,y),x.closeNode()}renderIconSet(x,y){g.isPrimitive(y)&&(x.openNode(this.tag,{type:"iconSet",priority:y.priority}),this.iconSetXform.render(x,y),x.closeNode())}renderText(x,y){x.openNode(this.tag,{type:y.operator,dxfId:y.dxfId,priority:y.priority,operator:i.toStringAttribute(y.operator,"containsText")});const b=(j=>{if(j.formulae&&j.formulae[0])return j.formulae[0];const T=new c(j.ref),{tl:O}=T;switch(j.operator){case"containsText":return`NOT(ISERROR(SEARCH("${j.text}",${O})))`;case"containsBlanks":return`LEN(TRIM(${O}))=0`;case"notContainsBlanks":return`LEN(TRIM(${O}))>0`;case"containsErrors":return`ISERROR(${O})`;case"notContainsErrors":return`NOT(ISERROR(${O}))`;default:return}})(y);b&&this.formulaXform.render(x,b),x.closeNode()}renderTimePeriod(x,y){x.openNode(this.tag,{type:"timePeriod",dxfId:y.dxfId,priority:y.priority,timePeriod:y.timePeriod});const b=(j=>{if(j.formulae&&j.formulae[0])return j.formulae[0];const T=new c(j.ref),{tl:O}=T;switch(j.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${O},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${O},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${O},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${O},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${O},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${O},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${O},1)=TODAY()-1`;case"today":return`FLOOR(${O},1)=TODAY()`;case"tomorrow":return`FLOOR(${O},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${O},1)<=6,FLOOR(${O},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${O})=MONTH(EDATE(TODAY(),0-1)),YEAR(${O})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${O})=MONTH(TODAY()),YEAR(${O})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${O})=MONTH(EDATE(TODAY(),0+1)),YEAR(${O})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(y);b&&this.formulaXform.render(x,b),x.closeNode()}createNewModel(x){let{attributes:y}=x;return{...p(y),dxfId:i.toIntValue(y.dxfId),priority:i.toIntValue(y.priority),timePeriod:y.timePeriod,percent:i.toBoolValue(y.percent),bottom:i.toBoolValue(y.bottom),rank:i.toIntValue(y.rank),aboveAverage:i.toBoolValue(y.aboveAverage)}}onParserClose(x,y){switch(x){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,y.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(y.model)}}}s.exports=g},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{get tag(){return"cfvo"}render(o,c){o.leafNode(this.tag,{type:c.type,val:c.value})}parseOpen(o){this.model={type:o.attributes.type,value:i.toFloatValue(o.attributes.val)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],85:[function(r,s,a){const i=r("../../composite-xform"),o=r("../../style/color-xform"),c=r("./cfvo-xform");s.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new c,color:this.colorXform=new o}}get tag(){return"colorScale"}render(d,l){d.openNode(this.tag),l.cfvo.forEach(u=>{this.cfvoXform.render(d,u)}),l.color.forEach(u=>{this.colorXform.render(d,u)}),d.closeNode()}createNewModel(d){return{cfvo:[],color:[]}}onParserClose(d,l){this.model[d].push(l.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(r,s,a){const i=r("../../composite-xform"),o=r("./cf-rule-xform");s.exports=class extends i{constructor(){super(),this.map={cfRule:new o}}get tag(){return"conditionalFormatting"}render(c,d){d.rules.some(o.isPrimitive)&&(c.openNode(this.tag,{sqref:d.ref}),d.rules.forEach(l=>{o.isPrimitive(l)&&(l.ref=d.ref,this.map.cfRule.render(c,l))}),c.closeNode())}createNewModel(c){let{attributes:d}=c;return{ref:d.sqref,rules:[]}}onParserClose(c,d){this.model.rules.push(d.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(r,s,a){const i=r("../../base-xform"),o=r("./conditional-formatting-xform");s.exports=class extends i{constructor(){super(),this.cfXform=new o}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(c,d){let l=c.reduce((u,h)=>Math.max(u,...h.rules.map(f=>f.priority||0)),1);c.forEach(u=>{u.rules.forEach(h=>{h.priority||(h.priority=l++),h.style&&(h.dxfId=d.styles.addDxfStyle(h.style))})})}render(c,d){d.forEach(l=>{this.cfXform.render(c,l)})}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"conditionalFormatting":return this.parser=this.cfXform,this.parser.parseOpen(c),!0;default:return!1}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){return!!this.parser&&(!!this.parser.parseClose(c)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(c,d){c.forEach(l=>{l.rules.forEach(u=>{u.dxfId!==void 0&&(u.style=d.styles.getDxfStyle(u.dxfId),delete u.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(r,s,a){const i=r("../../composite-xform"),o=r("../../style/color-xform"),c=r("./cfvo-xform");s.exports=class extends i{constructor(){super(),this.map={cfvo:this.cfvoXform=new c,color:this.colorXform=new o}}get tag(){return"dataBar"}render(d,l){d.openNode(this.tag),l.cfvo.forEach(u=>{this.cfvoXform.render(d,u)}),this.colorXform.render(d,l.color),d.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(d,l){switch(d){case"cfvo":this.model.cfvo.push(l.model);break;case"color":this.model.color=l.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(r,s,a){const i=r("../../base-xform"),o=r("../../composite-xform");class c extends i{get tag(){return"x14:id"}render(u,h){u.leafNode(this.tag,null,h)}parseOpen(){this.model=""}parseText(u){this.model+=u}parseClose(u){return u!==this.tag}}class d extends o{constructor(){super(),this.map={"x14:id":this.idXform=new c}}get tag(){return"ext"}render(u,h){u.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(u,h.x14Id),u.closeNode()}createNewModel(){return{}}onParserClose(u,h){this.model.x14Id=h.model}}s.exports=class extends o{constructor(){super(),this.map={ext:new d}}get tag(){return"extLst"}render(l,u){l.openNode(this.tag),this.map.ext.render(l,u),l.closeNode()}createNewModel(){return{}}onParserClose(l,u){Object.assign(this.model,u.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(r,s,a){const i=r("../../base-xform");s.exports=class extends i{get tag(){return"formula"}render(o,c){o.leafNode(this.tag,null,c)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],91:[function(r,s,a){const i=r("../../base-xform"),o=r("../../composite-xform"),c=r("./cfvo-xform");s.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new c}}get tag(){return"iconSet"}render(d,l){d.openNode(this.tag,{iconSet:i.toStringAttribute(l.iconSet,"3TrafficLights"),reverse:i.toBoolAttribute(l.reverse,!1),showValue:i.toBoolAttribute(l.showValue,!0)}),l.cfvo.forEach(u=>{this.cfvoXform.render(d,u)}),d.closeNode()}createNewModel(d){let{attributes:l}=d;return{iconSet:i.toStringValue(l.iconSet,"3TrafficLights"),reverse:i.toBoolValue(l.reverse),showValue:i.toBoolValue(l.showValue),cfvo:[]}}onParserClose(d,l){this.model[d].push(l.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(r,s,a){const i=r("../../../utils/utils"),o=r("../base-xform");s.exports=class extends o{get tag(){return"col"}prepare(c,d){const l=d.styles.addStyleModel(c.style||{});l&&(c.styleId=l)}render(c,d){c.openNode("col"),c.addAttribute("min",d.min),c.addAttribute("max",d.max),d.width&&c.addAttribute("width",d.width),d.styleId&&c.addAttribute("style",d.styleId),d.hidden&&c.addAttribute("hidden","1"),d.bestFit&&c.addAttribute("bestFit","1"),d.outlineLevel&&c.addAttribute("outlineLevel",d.outlineLevel),d.collapsed&&c.addAttribute("collapsed","1"),c.addAttribute("customWidth","1"),c.closeNode()}parseOpen(c){if(c.name==="col"){const d=this.model={min:parseInt(c.attributes.min||"0",10),max:parseInt(c.attributes.max||"0",10),width:c.attributes.width===void 0?void 0:parseFloat(c.attributes.width||"0")};return c.attributes.style&&(d.styleId=parseInt(c.attributes.style,10)),i.parseBoolean(c.attributes.hidden)&&(d.hidden=!0),i.parseBoolean(c.attributes.bestFit)&&(d.bestFit=!0),c.attributes.outlineLevel&&(d.outlineLevel=parseInt(c.attributes.outlineLevel,10)),i.parseBoolean(c.attributes.collapsed)&&(d.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(c,d){c.styleId&&(c.style=d.styles.getStyleModel(c.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../../../utils/utils"),c=r("../../../utils/col-cache"),d=r("../base-xform"),l=r("../../../doc/range");function u(f,m,p,g){const v=m[p];v!==void 0?f[p]=v:g!==void 0&&(f[p]=g)}function h(f,m,p,g){const v=m[p];v!==void 0&&(f[p]=o.parseBoolean(v))}s.exports=class extends d{get tag(){return"dataValidations"}render(f,m){const p=function(g){const v=i.map(g,(b,j)=>({address:j,dataValidation:b,marked:!1})).sort((b,j)=>i.strcmp(b.address,j.address)),x=i.keyBy(v,"address"),y=(b,j,T)=>{for(let O=0;O<j;O++){const R=c.encodeAddress(b.row+O,T);if(!g[R]||!i.isEqual(g[b.address],g[R]))return!1}return!0};return v.map(b=>{if(!b.marked){const j=c.decodeEx(b.address);if(j.dimensions)return x[j.dimensions].marked=!0,{...b.dataValidation,sqref:b.address};let T=1,O=c.encodeAddress(j.row+T,j.col);for(;g[O]&&i.isEqual(b.dataValidation,g[O]);)T++,O=c.encodeAddress(j.row+T,j.col);let R=1;for(;y(j,T,j.col+R);)R++;for(let D=0;D<T;D++)for(let L=0;L<R;L++)O=c.encodeAddress(j.row+D,j.col+L),x[O].marked=!0;if(T>1||R>1){const D=j.row+(T-1),L=j.col+(R-1);return{...b.dataValidation,sqref:`${b.address}:${c.encodeAddress(D,L)}`}}return{...b.dataValidation,sqref:b.address}}return null}).filter(Boolean)}(m);p.length&&(f.openNode("dataValidations",{count:p.length}),p.forEach(g=>{f.openNode("dataValidation"),g.type!=="any"&&(f.addAttribute("type",g.type),g.operator&&g.type!=="list"&&g.operator!=="between"&&f.addAttribute("operator",g.operator),g.allowBlank&&f.addAttribute("allowBlank","1")),g.showInputMessage&&f.addAttribute("showInputMessage","1"),g.promptTitle&&f.addAttribute("promptTitle",g.promptTitle),g.prompt&&f.addAttribute("prompt",g.prompt),g.showErrorMessage&&f.addAttribute("showErrorMessage","1"),g.errorStyle&&f.addAttribute("errorStyle",g.errorStyle),g.errorTitle&&f.addAttribute("errorTitle",g.errorTitle),g.error&&f.addAttribute("error",g.error),f.addAttribute("sqref",g.sqref),(g.formulae||[]).forEach((v,x)=>{f.openNode("formula"+(x+1)),g.type==="date"?f.writeText(o.dateToExcel(new Date(v))):f.writeText(v),f.closeNode()}),f.closeNode()}),f.closeNode())}parseOpen(f){switch(f.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=f.attributes.sqref;const m={type:f.attributes.type||"any",formulae:[]};switch(f.attributes.type&&h(m,f.attributes,"allowBlank"),h(m,f.attributes,"showInputMessage"),h(m,f.attributes,"showErrorMessage"),m.type){case"any":case"list":case"custom":break;default:u(m,f.attributes,"operator","between")}return u(m,f.attributes,"promptTitle"),u(m,f.attributes,"prompt"),u(m,f.attributes,"errorStyle"),u(m,f.attributes,"errorTitle"),u(m,f.attributes,"error"),this._dataValidation=m,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(f){this._formula&&this._formula.push(f)}parseClose(f){switch(f){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(m=>{m.includes(":")?new l(m).forEachAddress(p=>{this.model[p]=this._dataValidation}):this.model[m]=this._dataValidation}),!0;case"formula1":case"formula2":{let m=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":m=parseInt(m,10);break;case"decimal":m=parseFloat(m);break;case"date":m=o.excelToDate(parseFloat(m))}return this._dataValidation.formulae.push(m),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"dimension"}render(o,c){c&&o.leafNode("dimension",{ref:c})}parseOpen(o){return o.name==="dimension"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"drawing"}render(o,c){c&&o.leafNode(this.tag,{"r:id":c.rId})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(r,s,a){const i=r("../composite-xform"),o=r("./cf-ext/conditional-formattings-ext-xform");class c extends i{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new o}}get tag(){return"ext"}hasContent(l){return this.conditionalFormattings.hasContent(l.conditionalFormattings)}prepare(l,u){this.conditionalFormattings.prepare(l.conditionalFormattings,u)}render(l,u){l.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(l,u.conditionalFormattings),l.closeNode()}createNewModel(){return{}}onParserClose(l,u){this.model[l]=u.model}}s.exports=class extends i{constructor(){super(),this.map={ext:this.ext=new c}}get tag(){return"extLst"}prepare(d,l){this.ext.prepare(d,l)}hasContent(d){return this.ext.hasContent(d)}render(d,l){this.hasContent(l)&&(d.openNode("extLst"),this.ext.render(d,l),d.closeNode())}createNewModel(){return{}}onParserClose(d,l){Object.assign(this.model,l.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"headerFooter"}render(o,c){if(c){o.addRollback();let d=!1;o.openNode("headerFooter"),c.differentFirst&&(o.addAttribute("differentFirst","1"),d=!0),c.differentOddEven&&(o.addAttribute("differentOddEven","1"),d=!0),c.oddHeader&&typeof c.oddHeader=="string"&&(o.leafNode("oddHeader",null,c.oddHeader),d=!0),c.oddFooter&&typeof c.oddFooter=="string"&&(o.leafNode("oddFooter",null,c.oddFooter),d=!0),c.evenHeader&&typeof c.evenHeader=="string"&&(o.leafNode("evenHeader",null,c.evenHeader),d=!0),c.evenFooter&&typeof c.evenFooter=="string"&&(o.leafNode("evenFooter",null,c.evenFooter),d=!0),c.firstHeader&&typeof c.firstHeader=="string"&&(o.leafNode("firstHeader",null,c.firstHeader),d=!0),c.firstFooter&&typeof c.firstFooter=="string"&&(o.leafNode("firstFooter",null,c.firstFooter),d=!0),d?(o.closeNode(),o.commit()):o.rollback()}}parseOpen(o){switch(o.name){case"headerFooter":return this.model={},o.attributes.differentFirst&&(this.model.differentFirst=parseInt(o.attributes.differentFirst,0)===1),o.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(o.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(o){switch(this.currentNode){case"oddHeader":this.model.oddHeader=o;break;case"oddFooter":this.model.oddFooter=o;break;case"evenHeader":this.model.evenHeader=o;break;case"evenFooter":this.model.evenFooter=o;break;case"firstHeader":this.model.firstHeader=o;break;case"firstFooter":this.model.firstFooter=o}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"hyperlink"}render(o,c){this.isInternalLink(c)?o.leafNode("hyperlink",{ref:c.address,"r:id":c.rId,tooltip:c.tooltip,location:c.target}):o.leafNode("hyperlink",{ref:c.address,"r:id":c.rId,tooltip:c.tooltip})}parseOpen(o){return o.name==="hyperlink"&&(this.model={address:o.attributes.ref,rId:o.attributes["r:id"],tooltip:o.attributes.tooltip},o.attributes.location&&(this.model.target=o.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(o){return o.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(o.target)}}},{"../base-xform":32}],99:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"mergeCell"}render(o,c){o.leafNode("mergeCell",{ref:c})}parseOpen(o){return o.name==="mergeCell"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../../../doc/range"),c=r("../../../utils/col-cache"),d=r("../../../doc/enums");s.exports=class{constructor(){this.merges={}}add(l){if(this.merges[l.master])this.merges[l.master].expandToAddress(l.address);else{const u=`${l.master}:${l.address}`;this.merges[l.master]=new o(u)}}get mergeCells(){return i.map(this.merges,l=>l.range)}reconcile(l,u){i.each(l,h=>{const f=c.decode(h);for(let m=f.top;m<=f.bottom;m++){const p=u[m-1];for(let g=f.left;g<=f.right;g++){const v=p.cells[g-1];v?v.type===d.ValueType.Merge&&(v.master=f.tl):p.cells[g]={type:d.ValueType.Null,address:c.encodeAddress(m,g)}}}})}getMasterAddress(l){const u=this.hash[l];return u&&u.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(r,s,a){const i=r("../base-xform"),o=c=>c!==void 0;s.exports=class extends i{get tag(){return"outlinePr"}render(c,d){return!(!d||!o(d.summaryBelow)&&!o(d.summaryRight))&&(c.leafNode(this.tag,{summaryBelow:o(d.summaryBelow)?Number(d.summaryBelow):void 0,summaryRight:o(d.summaryRight)?Number(d.summaryRight):void 0}),!0)}parseOpen(c){return c.name===this.tag&&(this.model={summaryBelow:o(c.attributes.summaryBelow)?!!Number(c.attributes.summaryBelow):void 0,summaryRight:o(c.attributes.summaryRight)?!!Number(c.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"brk"}render(o,c){o.leafNode("brk",c)}parseOpen(o){return o.name==="brk"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../base-xform");s.exports=class extends o{get tag(){return"pageMargins"}render(c,d){if(d){const l={left:d.left,right:d.right,top:d.top,bottom:d.bottom,header:d.header,footer:d.footer};i.some(l,u=>u!==void 0)&&c.leafNode(this.tag,l)}}parseOpen(c){switch(c.name){case this.tag:return this.model={left:parseFloat(c.attributes.left||.7),right:parseFloat(c.attributes.right||.7),top:parseFloat(c.attributes.top||.75),bottom:parseFloat(c.attributes.bottom||.75),header:parseFloat(c.attributes.header||.3),footer:parseFloat(c.attributes.footer||.3)},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"pageSetUpPr"}render(o,c){return!(!c||!c.fitToPage)&&(o.leafNode(this.tag,{fitToPage:c.fitToPage?"1":void 0}),!0)}parseOpen(o){return o.name===this.tag&&(this.model={fitToPage:o.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../base-xform");function c(h){return h?"1":void 0}function d(h){switch(h){case"overThenDown":return h;default:return}}function l(h){switch(h){case"atEnd":case"asDisplyed":return h;default:return}}function u(h){switch(h){case"dash":case"blank":case"NA":return h;default:return}}s.exports=class extends o{get tag(){return"pageSetup"}render(h,f){if(f){const m={paperSize:f.paperSize,orientation:f.orientation,horizontalDpi:f.horizontalDpi,verticalDpi:f.verticalDpi,pageOrder:d(f.pageOrder),blackAndWhite:c(f.blackAndWhite),draft:c(f.draft),cellComments:l(f.cellComments),errors:u(f.errors),scale:f.scale,fitToWidth:f.fitToWidth,fitToHeight:f.fitToHeight,firstPageNumber:f.firstPageNumber,useFirstPageNumber:c(f.firstPageNumber),usePrinterDefaults:c(f.usePrinterDefaults),copies:f.copies};i.some(m,p=>p!==void 0)&&h.leafNode(this.tag,m)}}parseOpen(h){switch(h.name){case this.tag:return this.model={paperSize:(f=h.attributes.paperSize,f!==void 0?parseInt(f,10):void 0),orientation:h.attributes.orientation||"portrait",horizontalDpi:parseInt(h.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(h.attributes.verticalDpi||"4294967295",10),pageOrder:h.attributes.pageOrder||"downThenOver",blackAndWhite:h.attributes.blackAndWhite==="1",draft:h.attributes.draft==="1",cellComments:h.attributes.cellComments||"None",errors:h.attributes.errors||"displayed",scale:parseInt(h.attributes.scale||"100",10),fitToWidth:parseInt(h.attributes.fitToWidth||"1",10),fitToHeight:parseInt(h.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(h.attributes.firstPageNumber||"1",10),useFirstPageNumber:h.attributes.useFirstPageNumber==="1",usePrinterDefaults:h.attributes.usePrinterDefaults==="1",copies:parseInt(h.attributes.copies||"1",10)},!0;default:return!1}var f}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"picture"}render(o,c){c&&o.leafNode(this.tag,{"r:id":c.rId})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../base-xform");function c(d){return d?"1":void 0}s.exports=class extends o{get tag(){return"printOptions"}render(d,l){if(l){const u={headings:c(l.showRowColHeaders),gridLines:c(l.showGridLines),horizontalCentered:c(l.horizontalCentered),verticalCentered:c(l.verticalCentered)};i.some(u,h=>h!==void 0)&&d.leafNode(this.tag,u)}}parseOpen(d){switch(d.name){case this.tag:return this.model={showRowColHeaders:d.attributes.headings==="1",showGridLines:d.attributes.gridLines==="1",horizontalCentered:d.attributes.horizontalCentered==="1",verticalCentered:d.attributes.verticalCentered==="1"},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(r,s,a){const i=r("./page-breaks-xform"),o=r("../list-xform");s.exports=class extends o{constructor(){super({tag:"rowBreaks",count:!0,childXform:new i})}render(c,d){if(d&&d.length){c.openNode(this.tag,this.$),this.count&&(c.addAttribute(this.$count,d.length),c.addAttribute("manualBreakCount",d.length));const{childXform:l}=this;d.forEach(u=>{l.render(c,u)}),c.closeNode()}else this.empty&&c.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(r,s,a){const i=r("../base-xform"),o=r("../../../utils/utils"),c=r("./cell-xform");s.exports=class extends i{constructor(d){super(),this.maxItems=d&&d.maxItems,this.map={c:new c}}get tag(){return"row"}prepare(d,l){const u=l.styles.addStyleModel(d.style);u&&(d.styleId=u);const h=this.map.c;d.cells.forEach(f=>{h.prepare(f,l)})}render(d,l,u){d.openNode("row"),d.addAttribute("r",l.number),l.height&&(d.addAttribute("ht",l.height),d.addAttribute("customHeight","1")),l.hidden&&d.addAttribute("hidden","1"),l.min>0&&l.max>0&&l.min<=l.max&&d.addAttribute("spans",`${l.min}:${l.max}`),l.styleId&&(d.addAttribute("s",l.styleId),d.addAttribute("customFormat","1")),d.addAttribute("x14ac:dyDescent","0.25"),l.outlineLevel&&d.addAttribute("outlineLevel",l.outlineLevel),l.collapsed&&d.addAttribute("collapsed","1");const h=this.map.c;l.cells.forEach(f=>{h.render(d,f,u)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;if(d.name==="row"){this.numRowsSeen+=1;const l=d.attributes.spans?d.attributes.spans.split(":").map(h=>parseInt(h,10)):[void 0,void 0],u=this.model={number:parseInt(d.attributes.r,10),min:l[0],max:l[1],cells:[]};return d.attributes.s&&(u.styleId=parseInt(d.attributes.s,10)),o.parseBoolean(d.attributes.hidden)&&(u.hidden=!0),o.parseBoolean(d.attributes.bestFit)&&(u.bestFit=!0),d.attributes.ht&&(u.height=parseFloat(d.attributes.ht)),d.attributes.outlineLevel&&(u.outlineLevel=parseInt(d.attributes.outlineLevel,10)),o.parseBoolean(d.attributes.collapsed)&&(u.collapsed=!0),!0}return this.parser=this.map[d.name],!!this.parser&&(this.parser.parseOpen(d),!0)}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser){if(!this.parser.parseClose(d)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(d,l){d.style=d.styleId?l.styles.getStyleModel(d.styleId):{},d.styleId!==void 0&&(d.styleId=void 0);const u=this.map.c;d.cells.forEach(h=>{u.reconcile(h,l)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../base-xform");s.exports=class extends o{get tag(){return"sheetFormatPr"}render(c,d){if(d){const l={defaultRowHeight:d.defaultRowHeight,outlineLevelRow:d.outlineLevelRow,outlineLevelCol:d.outlineLevelCol,"x14ac:dyDescent":d.dyDescent};d.defaultColWidth&&(l.defaultColWidth=d.defaultColWidth),d.defaultRowHeight&&d.defaultRowHeight===15||(l.customHeight="1"),i.some(l,u=>u!==void 0)&&c.leafNode("sheetFormatPr",l)}}parseOpen(c){return c.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(c.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(c.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(c.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(c.attributes.outlineLevelCol||"0",10)},c.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(c.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(r,s,a){const i=r("../base-xform"),o=r("../style/color-xform"),c=r("./page-setup-properties-xform"),d=r("./outline-properties-xform");s.exports=class extends i{constructor(){super(),this.map={tabColor:new o("tabColor"),pageSetUpPr:new c,outlinePr:new d}}get tag(){return"sheetPr"}render(l,u){if(u){l.addRollback(),l.openNode("sheetPr");let h=!1;h=this.map.tabColor.render(l,u.tabColor)||h,h=this.map.pageSetUpPr.render(l,u.pageSetup)||h,h=this.map.outlinePr.render(l,u.outlineProperties)||h,h?(l.closeNode(),l.commit()):l.rollback()}}parseOpen(l){return this.parser?(this.parser.parseOpen(l),!0):l.name===this.tag?(this.reset(),!0):!!this.map[l.name]&&(this.parser=this.map[l.name],this.parser.parseOpen(l),!0)}parseText(l){return!!this.parser&&(this.parser.parseText(l),!0)}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../base-xform");function c(l,u){return l?u:void 0}function d(l,u){return l===u||void 0}s.exports=class extends o{get tag(){return"sheetProtection"}render(l,u){if(u){const h={sheet:c(u.sheet,"1"),selectLockedCells:u.selectLockedCells===!1?"1":void 0,selectUnlockedCells:u.selectUnlockedCells===!1?"1":void 0,formatCells:c(u.formatCells,"0"),formatColumns:c(u.formatColumns,"0"),formatRows:c(u.formatRows,"0"),insertColumns:c(u.insertColumns,"0"),insertRows:c(u.insertRows,"0"),insertHyperlinks:c(u.insertHyperlinks,"0"),deleteColumns:c(u.deleteColumns,"0"),deleteRows:c(u.deleteRows,"0"),sort:c(u.sort,"0"),autoFilter:c(u.autoFilter,"0"),pivotTables:c(u.pivotTables,"0")};u.sheet&&(h.algorithmName=u.algorithmName,h.hashValue=u.hashValue,h.saltValue=u.saltValue,h.spinCount=u.spinCount,h.objects=c(u.objects===!1,"1"),h.scenarios=c(u.scenarios===!1,"1")),i.some(h,f=>f!==void 0)&&l.leafNode(this.tag,h)}}parseOpen(l){switch(l.name){case this.tag:return this.model={sheet:d(l.attributes.sheet,"1"),objects:l.attributes.objects!=="1"&&void 0,scenarios:l.attributes.scenarios!=="1"&&void 0,selectLockedCells:l.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:l.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:d(l.attributes.formatCells,"0"),formatColumns:d(l.attributes.formatColumns,"0"),formatRows:d(l.attributes.formatRows,"0"),insertColumns:d(l.attributes.insertColumns,"0"),insertRows:d(l.attributes.insertRows,"0"),insertHyperlinks:d(l.attributes.insertHyperlinks,"0"),deleteColumns:d(l.attributes.deleteColumns,"0"),deleteRows:d(l.attributes.deleteRows,"0"),sort:d(l.attributes.sort,"0"),autoFilter:d(l.attributes.autoFilter,"0"),pivotTables:d(l.attributes.pivotTables,"0")},l.attributes.algorithmName&&(this.model.algorithmName=l.attributes.algorithmName,this.model.hashValue=l.attributes.hashValue,this.model.saltValue=l.attributes.saltValue,this.model.spinCount=parseInt(l.attributes.spinCount,10)),!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(r,s,a){const i=r("../../../utils/col-cache"),o=r("../base-xform"),c={frozen:"frozen",frozenSplit:"frozen",split:"split"};s.exports=class extends o{get tag(){return"sheetView"}prepare(d){switch(d.state){case"frozen":case"split":break;default:d.state="normal"}}render(d,l){d.openNode("sheetView",{workbookViewId:l.workbookViewId||0});const u=function(g,v,x){x&&d.addAttribute(g,v)};let h,f,m,p;switch(u("rightToLeft","1",l.rightToLeft===!0),u("tabSelected","1",l.tabSelected),u("showRuler","0",l.showRuler===!1),u("showRowColHeaders","0",l.showRowColHeaders===!1),u("showGridLines","0",l.showGridLines===!1),u("zoomScale",l.zoomScale,l.zoomScale),u("zoomScaleNormal",l.zoomScaleNormal,l.zoomScaleNormal),u("view",l.style,l.style),l.state){case"frozen":f=l.xSplit||0,m=l.ySplit||0,h=l.topLeftCell||i.getAddress(m+1,f+1).address,p=(l.xSplit&&l.ySplit?"bottomRight":l.xSplit&&"topRight")||"bottomLeft",d.leafNode("pane",{xSplit:l.xSplit||void 0,ySplit:l.ySplit||void 0,topLeftCell:h,activePane:p,state:"frozen"}),d.leafNode("selection",{pane:p,activeCell:l.activeCell,sqref:l.activeCell});break;case"split":l.activePane==="topLeft"&&(l.activePane=void 0),d.leafNode("pane",{xSplit:l.xSplit||void 0,ySplit:l.ySplit||void 0,topLeftCell:l.topLeftCell,activePane:l.activePane}),d.leafNode("selection",{pane:l.activePane,activeCell:l.activeCell,sqref:l.activeCell});break;case"normal":l.activeCell&&d.leafNode("selection",{activeCell:l.activeCell,sqref:l.activeCell})}d.closeNode()}parseOpen(d){switch(d.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(d.attributes.workbookViewId,10),rightToLeft:d.attributes.rightToLeft==="1",tabSelected:d.attributes.tabSelected==="1",showRuler:d.attributes.showRuler!=="0",showRowColHeaders:d.attributes.showRowColHeaders!=="0",showGridLines:d.attributes.showGridLines!=="0",zoomScale:parseInt(d.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(d.attributes.zoomScaleNormal||"100",10),style:d.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(d.attributes.xSplit||"0",10),ySplit:parseInt(d.attributes.ySplit||"0",10),topLeftCell:d.attributes.topLeftCell,activePane:d.attributes.activePane||"topLeft",state:d.attributes.state},!0;case"selection":{const l=d.attributes.pane||"topLeft";return this.selections[l]={pane:l,activeCell:d.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(d){let l,u;switch(d){case"sheetView":return this.sheetView&&this.pane?(l=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:c[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(l.activePane=this.pane.activePane),u=this.selections[this.pane.activePane],u&&u.activeCell&&(l.activeCell=u.activeCell),this.sheetView.style&&(l.style=this.sheetView.style)):(l=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},u=this.selections.topLeft,u&&u.activeCell&&(l.activeCell=u.activeCell),this.sheetView.style&&(l.style=this.sheetView.style)),!1;default:return!0}}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"tablePart"}render(o,c){c&&o.leafNode(this.tag,{"r:id":c.rId})}parseOpen(o){switch(o.name){case this.tag:return this.model={rId:o.attributes["r:id"]},!0;default:return!1}}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../../../utils/col-cache"),c=r("../../../utils/xml-stream"),d=r("../../rel-type"),l=r("./merges"),u=r("../base-xform"),h=r("../list-xform"),f=r("./row-xform"),m=r("./col-xform"),p=r("./dimension-xform"),g=r("./hyperlink-xform"),v=r("./merge-cell-xform"),x=r("./data-validations-xform"),y=r("./sheet-properties-xform"),b=r("./sheet-format-properties-xform"),j=r("./sheet-view-xform"),T=r("./sheet-protection-xform"),O=r("./page-margins-xform"),R=r("./page-setup-xform"),D=r("./print-options-xform"),L=r("./auto-filter-xform"),q=r("./picture-xform"),X=r("./drawing-xform"),H=r("./table-part-xform"),M=r("./row-breaks-xform"),F=r("./header-footer-xform"),S=r("./cf/conditional-formattings-xform"),E=r("./ext-lst-xform"),N=(k,I)=>{if(!I||!I.length)return k;if(!k||!k.length)return I;const U={},$={};return k.forEach(Y=>{U[Y.ref]=Y,Y.rules.forEach(Z=>{const{x14Id:re}=Z;re&&($[re]=Z)})}),I.forEach(Y=>{Y.rules.forEach(Z=>{const re=$[Z.x14Id];re?((G,J)=>{Object.keys(J).forEach(V=>{const W=G[V],ee=J[V];W===void 0&&ee!==void 0&&(G[V]=ee)})})(re,Z):U[Y.ref]?U[Y.ref].rules.push(Z):k.push({ref:Y.ref,rules:[Z]})})}),k};class C extends u{constructor(I){super();const{maxRows:U,maxCols:$,ignoreNodes:Y}=I||{};this.ignoreNodes=Y||[],this.map={sheetPr:new y,dimension:new p,sheetViews:new h({tag:"sheetViews",count:!1,childXform:new j}),sheetFormatPr:new b,cols:new h({tag:"cols",count:!1,childXform:new m}),sheetData:new h({tag:"sheetData",count:!1,empty:!0,childXform:new f({maxItems:$}),maxItems:U}),autoFilter:new L,mergeCells:new h({tag:"mergeCells",count:!0,childXform:new v}),rowBreaks:new M,hyperlinks:new h({tag:"hyperlinks",count:!1,childXform:new g}),pageMargins:new O,dataValidations:new x,pageSetup:new R,headerFooter:new F,printOptions:new D,picture:new q,drawing:new X,sheetProtection:new T,tableParts:new h({tag:"tableParts",count:!0,childXform:new H}),conditionalFormatting:new S,extLst:new E}}prepare(I,U){U.merges=new l,I.hyperlinks=U.hyperlinks=[],I.comments=U.comments=[],U.formulae={},U.siFormulae=0,this.map.cols.prepare(I.cols,U),this.map.sheetData.prepare(I.rows,U),this.map.conditionalFormatting.prepare(I.conditionalFormattings,U),I.mergeCells=U.merges.mergeCells;const $=I.rels=[];function Y(G){return"rId"+(G.length+1)}if(I.hyperlinks.forEach(G=>{const J=Y($);G.rId=J,$.push({Id:J,Type:d.Hyperlink,Target:G.target,TargetMode:"External"})}),I.comments.length>0){const G={Id:Y($),Type:d.Comments,Target:`../comments${I.id}.xml`};$.push(G);const J={Id:Y($),Type:d.VmlDrawing,Target:`../drawings/vmlDrawing${I.id}.vml`};$.push(J),I.comments.forEach(V=>{V.refAddress=o.decodeAddress(V.ref)}),U.commentRefs.push({commentName:"comments"+I.id,vmlDrawing:"vmlDrawing"+I.id})}const Z=[];let re;I.media.forEach(G=>{if(G.type==="background"){const J=Y($);re=U.media[G.imageId],$.push({Id:J,Type:d.Image,Target:`../media/${re.name}.${re.extension}`}),I.background={rId:J},I.image=U.media[G.imageId]}else if(G.type==="image"){let{drawing:J}=I;re=U.media[G.imageId],J||(J=I.drawing={rId:Y($),name:"drawing"+ ++U.drawingsCount,anchors:[],rels:[]},U.drawings.push(J),$.push({Id:J.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${J.name}.xml`}));let V=this.preImageId===G.imageId?Z[G.imageId]:Z[J.rels.length];V||(V=Y(J.rels),Z[J.rels.length]=V,J.rels.push({Id:V,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${re.name}.${re.extension}`}));const W={picture:{rId:V},range:G.range};if(G.hyperlinks&&G.hyperlinks.hyperlink){const ee=Y(J.rels);Z[J.rels.length]=ee,W.picture.hyperlinks={tooltip:G.hyperlinks.tooltip,rId:ee},J.rels.push({Id:ee,Type:d.Hyperlink,Target:G.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=G.imageId,J.anchors.push(W)}}),I.tables.forEach(G=>{const J=Y($);G.rId=J,$.push({Id:J,Type:d.Table,Target:"../tables/"+G.target}),G.columns.forEach(V=>{const{style:W}=V;W&&(V.dxfId=U.styles.addDxfStyle(W))})}),this.map.extLst.prepare(I,U)}render(I,U){I.openXml(c.StdDocAttributes),I.openNode("worksheet",C.WORKSHEET_ATTRIBUTES);const $=U.properties?{defaultRowHeight:U.properties.defaultRowHeight,dyDescent:U.properties.dyDescent,outlineLevelCol:U.properties.outlineLevelCol,outlineLevelRow:U.properties.outlineLevelRow}:void 0;U.properties&&U.properties.defaultColWidth&&($.defaultColWidth=U.properties.defaultColWidth);const Y={outlineProperties:U.properties&&U.properties.outlineProperties,tabColor:U.properties&&U.properties.tabColor,pageSetup:U.pageSetup&&U.pageSetup.fitToPage?{fitToPage:U.pageSetup.fitToPage}:void 0},Z=U.pageSetup&&U.pageSetup.margins,re={showRowColHeaders:U.pageSetup&&U.pageSetup.showRowColHeaders,showGridLines:U.pageSetup&&U.pageSetup.showGridLines,horizontalCentered:U.pageSetup&&U.pageSetup.horizontalCentered,verticalCentered:U.pageSetup&&U.pageSetup.verticalCentered},G=U.sheetProtection;this.map.sheetPr.render(I,Y),this.map.dimension.render(I,U.dimensions),this.map.sheetViews.render(I,U.views),this.map.sheetFormatPr.render(I,$),this.map.cols.render(I,U.cols),this.map.sheetData.render(I,U.rows),this.map.sheetProtection.render(I,G),this.map.autoFilter.render(I,U.autoFilter),this.map.mergeCells.render(I,U.mergeCells),this.map.conditionalFormatting.render(I,U.conditionalFormattings),this.map.dataValidations.render(I,U.dataValidations),this.map.hyperlinks.render(I,U.hyperlinks),this.map.printOptions.render(I,re),this.map.pageMargins.render(I,Z),this.map.pageSetup.render(I,U.pageSetup),this.map.headerFooter.render(I,U.headerFooter),this.map.rowBreaks.render(I,U.rowBreaks),this.map.drawing.render(I,U.drawing),this.map.picture.render(I,U.background),this.map.tableParts.render(I,U.tables),this.map.extLst.render(I,U),U.rels&&U.rels.forEach(J=>{J.Type===d.VmlDrawing&&I.leafNode("legacyDrawing",{"r:id":J.Id})}),I.closeNode()}parseOpen(I){return this.parser?(this.parser.parseOpen(I),!0):I.name==="worksheet"?(i.each(this.map,U=>{U.reset()}),!0):(this.map[I.name]&&!this.ignoreNodes.includes(I.name)&&(this.parser=this.map[I.name],this.parser.parseOpen(I)),!0)}parseText(I){this.parser&&this.parser.parseText(I)}parseClose(I){if(this.parser)return this.parser.parseClose(I)||(this.parser=void 0),!0;switch(I){case"worksheet":{const U=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(U.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(U.outlineProperties=this.map.sheetPr.model.outlineProperties);const $={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},Y=Object.assign($,this.map.pageSetup.model,this.map.printOptions.model),Z=N(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:U,views:this.map.sheetViews.model,pageSetup:Y,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:Z},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}default:return!0}}reconcile(I,U){const $=(I.relationships||[]).reduce((Z,re)=>{if(Z[re.Id]=re,re.Type===d.Comments&&(I.comments=U.comments[re.Target].comments),re.Type===d.VmlDrawing&&I.comments&&I.comments.length){const G=U.vmlDrawings[re.Target].comments;I.comments.forEach((J,V)=>{J.note=Object.assign({},J.note,G[V])})}return Z},{});if(U.commentsMap=(I.comments||[]).reduce((Z,re)=>(re.ref&&(Z[re.ref]=re),Z),{}),U.hyperlinkMap=(I.hyperlinks||[]).reduce((Z,re)=>(re.rId&&(Z[re.address]=$[re.rId].Target),Z),{}),U.formulae={},I.rows=I.rows&&I.rows.filter(Boolean)||[],I.rows.forEach(Z=>{Z.cells=Z.cells&&Z.cells.filter(Boolean)||[]}),this.map.cols.reconcile(I.cols,U),this.map.sheetData.reconcile(I.rows,U),this.map.conditionalFormatting.reconcile(I.conditionalFormattings,U),I.media=[],I.drawing){const Z=$[I.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(Z){const re=Z[1];U.drawings[re].anchors.forEach(G=>{if(G.medium){const J={type:"image",imageId:G.medium.index,range:G.range,hyperlinks:G.picture.hyperlinks};I.media.push(J)}})}}const Y=I.background&&$[I.background.rId];if(Y){const Z=Y.Target.split("/media/")[1],re=U.mediaIndex&&U.mediaIndex[Z];re!==void 0&&I.media.push({type:"background",imageId:re})}I.tables=(I.tables||[]).map(Z=>{const re=$[Z.rId];return U.tables[re.Target]}),delete I.relationships,delete I.hyperlinks,delete I.comments}}C.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},s.exports=C},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr}render(o,c){c&&(o.openNode(this.tag),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this._format=o.format||function(c){try{return Number.isNaN(c.getTime())?"":c.toISOString()}catch{return""}},this._parse=o.parse||function(c){return new Date(c)}}render(o,c){c&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,this._format(c)):o.writeText(this._format(c)),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=this._parse(o.attributes[this.attr]):this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this.zero=o.zero}render(o,c){(c||this.zero)&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,c):o.writeText(c),o.closeNode())}parseOpen(o){return o.name===this.tag&&(this.attr?this.model=parseInt(o.attributes[this.attr],10):this.text=[],!0)}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs}render(o,c){c!==void 0&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,c):o.writeText(c),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=o.attributes[this.attr]:this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(r,s,a){const i=r("./base-xform"),o=r("../../utils/xml-stream");s.exports=class extends i{constructor(c){super(),this._model=c}render(c){if(!this._xml){const d=new o;(function l(u,h){u.openNode(h.tag,h.$),h.c&&h.c.forEach(f=>{l(u,f)}),h.t&&u.writeText(h.t),u.closeNode()})(d,this._model),this._xml=d.xml}c.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(c){switch(c){case this._model.tag:return!1;default:return!0}}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(r,s,a){const i=r("./text-xform"),o=r("./rich-text-xform"),c=r("../base-xform");s.exports=class extends c{constructor(){super(),this.map={r:new o,t:new i}}get tag(){return"rPh"}render(d,l){if(d.openNode(this.tag,{sb:l.sb||0,eb:l.eb||0}),l&&l.hasOwnProperty("richText")&&l.richText){const{r:u}=this.map;l.richText.forEach(h=>{u.render(d,h)})}else l&&this.map.t.render(d,l.text);d.closeNode()}parseOpen(d){const{name:l}=d;return this.parser?(this.parser.parseOpen(d),!0):l===this.tag?(this.model={sb:parseInt(d.attributes.sb,10),eb:parseInt(d.attributes.eb,10)},!0):(this.parser=this.map[l],!!this.parser&&(this.parser.parseOpen(d),!0))}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser){if(!this.parser.parseClose(d)){switch(d){case"r":{let l=this.model.richText;l||(l=this.model.richText=[]),l.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}switch(d){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(r,s,a){const i=r("./text-xform"),o=r("../style/font-xform"),c=r("../base-xform");class d extends c{constructor(u){super(),this.model=u}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new i)}get fontXform(){return this._fontXform||(this._fontXform=new o(d.FONT_OPTIONS))}render(u,h){h=h||this.model,u.openNode("r"),h.font&&this.fontXform.render(u,h.font),this.textXform.render(u,h.text),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(u),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){switch(u){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}}d.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},s.exports=d},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(r,s,a){const i=r("./text-xform"),o=r("./rich-text-xform"),c=r("./phonetic-text-xform"),d=r("../base-xform");s.exports=class extends d{constructor(l){super(),this.model=l,this.map={r:new o,t:new i,rPh:new c}}get tag(){return"si"}render(l,u){l.openNode(this.tag),u&&u.hasOwnProperty("richText")&&u.richText?u.richText.length?u.richText.forEach(h=>{this.map.r.render(l,h)}):this.map.t.render(l,""):u!=null&&this.map.t.render(l,u),l.closeNode()}parseOpen(l){const{name:u}=l;return this.parser?(this.parser.parseOpen(l),!0):u===this.tag?(this.model={},!0):(this.parser=this.map[u],!!this.parser&&(this.parser.parseOpen(l),!0))}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){switch(l){case"r":{let u=this.model.richText;u||(u=this.model.richText=[]),u.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}switch(l){case this.tag:return!1;default:return!0}}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),c=r("./shared-string-xform");s.exports=class extends o{constructor(d){super(),this.model=d||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new c)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(d){return this.model.values[d]}add(d){return d.richText?this.addRichText(d):this.addText(d)}addText(d){let l=this.hash[d];return l===void 0&&(l=this.hash[d]=this.model.values.length,this.model.values.push(d)),this.model.count++,l}addRichText(d){const l=this.sharedStringXform.toXml(d);let u=this.rich[l];return u===void 0&&(u=this.rich[l]=this.model.values.length,this.model.values.push(d)),this.model.count++,u}render(d,l){l=l||this._values,d.openXml(i.StdDocAttributes),d.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:l.count,uniqueCount:l.values.length});const u=this.sharedStringXform;l.values.forEach(h=>{u.render(d,h)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(d),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(d))}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;switch(d){case"sst":return!1;default:throw new Error("Unexpected xml node in parseClose: "+d)}}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"t"}render(o,c){o.openNode("t"),/^\s|\n|\s$/.test(c)&&o.addAttribute("xml:space","preserve"),o.writeText(c),o.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(o,c)=>String.fromCharCode(parseInt(c,16)))}parseOpen(o){switch(o.name){case"t":return this._text=[],!0;default:return!1}}parseText(o){this._text.push(o)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(r,s,a){const i=r("../../../doc/enums"),o=r("../../../utils/utils"),c=r("../base-xform"),d={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((u,h)=>(u[h]=!0,u),{}),horizontal(u){return this.horizontalValues[u]?u:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((u,h)=>(u[h]=!0,u),{}),vertical(u){return u==="middle"?"center":this.verticalValues[u]?u:void 0},wrapText:u=>!!u||void 0,shrinkToFit:u=>!!u||void 0,textRotation(u){switch(u){case"vertical":return u;default:return(u=o.validInt(u))>=-90&&u<=90?u:void 0}},indent:u=>(u=o.validInt(u),Math.max(0,u)),readingOrder(u){switch(u){case"ltr":return i.ReadingOrder.LeftToRight;case"rtl":return i.ReadingOrder.RightToLeft;default:return}}},l={toXml(u){if(u=d.textRotation(u)){if(u==="vertical")return 255;const h=Math.round(u);if(h>=0&&h<=90)return h;if(h<0&&h>=-90)return 90-h}},toModel(u){const h=o.validInt(u);if(h!==void 0){if(h===255)return"vertical";if(h>=0&&h<=90)return h;if(h>90&&h<=180)return 90-h}}};s.exports=class extends c{get tag(){return"alignment"}render(u,h){u.addRollback(),u.openNode("alignment");let f=!1;function m(p,g){g&&(u.addAttribute(p,g),f=!0)}m("horizontal",d.horizontal(h.horizontal)),m("vertical",d.vertical(h.vertical)),m("wrapText",!!d.wrapText(h.wrapText)&&"1"),m("shrinkToFit",!!d.shrinkToFit(h.shrinkToFit)&&"1"),m("indent",d.indent(h.indent)),m("textRotation",l.toXml(h.textRotation)),m("readingOrder",d.readingOrder(h.readingOrder)),u.closeNode(),f?u.commit():u.rollback()}parseOpen(u){const h={};let f=!1;function m(p,g,v){p&&(h[g]=v,f=!0)}m(u.attributes.horizontal,"horizontal",u.attributes.horizontal),m(u.attributes.vertical,"vertical",u.attributes.vertical==="center"?"middle":u.attributes.vertical),m(u.attributes.wrapText,"wrapText",o.parseBoolean(u.attributes.wrapText)),m(u.attributes.shrinkToFit,"shrinkToFit",o.parseBoolean(u.attributes.shrinkToFit)),m(u.attributes.indent,"indent",parseInt(u.attributes.indent,10)),m(u.attributes.textRotation,"textRotation",l.toModel(u.attributes.textRotation)),m(u.attributes.readingOrder,"readingOrder",u.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=f?h:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(r,s,a){const i=r("../base-xform"),o=r("../../../utils/utils"),c=r("./color-xform");class d extends i{constructor(u){super(),this.name=u,this.map={color:new c}}get tag(){return this.name}render(u,h,f){const m=h&&h.color||f||this.defaultColor;u.openNode(this.name),h&&h.style&&(u.addAttribute("style",h.style),m&&this.map.color.render(u,m)),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.name:{const{style:h}=u.attributes;return this.model=h?{style:h}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):(u===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(u){return d.validStyleValues[u]}}d.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((l,u)=>(l[u]=!0,l),{}),s.exports=class extends i{constructor(){super(),this.map={top:new d("top"),left:new d("left"),bottom:new d("bottom"),right:new d("right"),diagonal:new d("diagonal")}}render(l,u){const{color:h}=u;function f(m,p){m&&!m.color&&u.color&&(m={...m,color:u.color}),p.render(l,m,h)}l.openNode("border"),u.diagonal&&u.diagonal.style&&(u.diagonal.up&&l.addAttribute("diagonalUp","1"),u.diagonal.down&&l.addAttribute("diagonalDown","1")),f(u.left,this.map.left),f(u.right,this.map.right),f(u.top,this.map.top),f(u.bottom,this.map.bottom),f(u.diagonal,this.map.diagonal),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"border":return this.reset(),this.diagonalUp=o.parseBoolean(l.attributes.diagonalUp),this.diagonalDown=o.parseBoolean(l.attributes.diagonalDown),!0;default:return this.parser=this.map[l.name],!!this.parser&&(this.parser.parseOpen(l),!0)}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;if(l==="border"){const u=this.model={},h=function(f,m,p){m&&(p&&Object.assign(m,p),u[f]=m)};h("left",this.map.left.model),h("right",this.map.right.model),h("top",this.map.top.model),h("bottom",this.map.bottom.model),h("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{constructor(o){super(),this.name=o||"color"}get tag(){return this.name}render(o,c){return!!c&&(o.openNode(this.name),c.argb?o.addAttribute("rgb",c.argb):c.theme!==void 0?(o.addAttribute("theme",c.theme),c.tint!==void 0&&o.addAttribute("tint",c.tint)):c.indexed!==void 0?o.addAttribute("indexed",c.indexed):o.addAttribute("auto","1"),o.closeNode(),!0)}parseOpen(o){return o.name===this.name&&(o.attributes.rgb?this.model={argb:o.attributes.rgb}:o.attributes.theme?(this.model={theme:parseInt(o.attributes.theme,10)},o.attributes.tint&&(this.model.tint=parseFloat(o.attributes.tint))):o.attributes.indexed?this.model={indexed:parseInt(o.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(r,s,a){const i=r("../base-xform"),o=r("./alignment-xform"),c=r("./border-xform"),d=r("./fill-xform"),l=r("./font-xform"),u=r("./numfmt-xform"),h=r("./protection-xform");s.exports=class extends i{constructor(){super(),this.map={alignment:new o,border:new c,fill:new d,font:new l,numFmt:new u,protection:new h}}get tag(){return"dxf"}render(f,m){if(f.openNode(this.tag),m.font&&this.map.font.render(f,m.font),m.numFmt&&m.numFmtId){const p={id:m.numFmtId,formatCode:m.numFmt};this.map.numFmt.render(f,p)}m.fill&&this.map.fill.render(f,m.fill),m.alignment&&this.map.alignment.render(f,m.alignment),m.border&&this.map.border.render(f,m.border),m.protection&&this.map.protection.render(f,m.protection),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case this.tag:return this.reset(),!0;default:return this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f),!0}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return this.parser?(this.parser.parseClose(f)||(this.parser=void 0),!0):f!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(r,s,a){const i=r("../base-xform"),o=r("./color-xform");class c extends i{constructor(){super(),this.map={color:new o}}get tag(){return"stop"}render(f,m){f.openNode("stop"),f.addAttribute("position",m.position),this.map.color.render(f,m.color),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"stop":return this.model={position:parseFloat(f.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(f),!0;default:return!1}}parseText(){}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class d extends i{constructor(){super(),this.map={fgColor:new o("fgColor"),bgColor:new o("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(f,m){f.openNode("patternFill"),f.addAttribute("patternType",m.pattern),m.fgColor&&this.map.fgColor.render(f,m.fgColor),m.bgColor&&this.map.bgColor.render(f,m.bgColor),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"patternFill":return this.model={type:"pattern",pattern:f.attributes.patternType},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.parser.model&&(this.model[f]=this.parser.model),this.parser=void 0),!0)}}class l extends i{constructor(){super(),this.map={stop:new c}}get name(){return"gradient"}get tag(){return"gradientFill"}render(f,m){switch(f.openNode("gradientFill"),m.gradient){case"angle":f.addAttribute("degree",m.degree);break;case"path":f.addAttribute("type","path"),m.center.left&&(f.addAttribute("left",m.center.left),m.center.right===void 0&&f.addAttribute("right",m.center.left)),m.center.right&&f.addAttribute("right",m.center.right),m.center.top&&(f.addAttribute("top",m.center.top),m.center.bottom===void 0&&f.addAttribute("bottom",m.center.top)),m.center.bottom&&f.addAttribute("bottom",m.center.bottom)}const p=this.map.stop;m.stops.forEach(g=>{p.render(f,g)}),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"gradientFill":{const m=this.model={stops:[]};return f.attributes.degree?(m.gradient="angle",m.degree=parseInt(f.attributes.degree,10)):f.attributes.type==="path"&&(m.gradient="path",m.center={left:f.attributes.left?parseFloat(f.attributes.left):0,top:f.attributes.top?parseFloat(f.attributes.top):0},f.attributes.right!==f.attributes.left&&(m.center.right=f.attributes.right?parseFloat(f.attributes.right):0),f.attributes.bottom!==f.attributes.top&&(m.center.bottom=f.attributes.bottom?parseFloat(f.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(f),!0;default:return!1}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class u extends i{constructor(){super(),this.map={patternFill:new d,gradientFill:new l}}get tag(){return"fill"}render(f,m){switch(f.addRollback(),f.openNode("fill"),m.type){case"pattern":this.map.patternFill.render(f,m);break;case"gradient":this.map.gradientFill.render(f,m);break;default:return void f.rollback()}f.closeNode(),f.commit()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;switch(f.name){case"fill":return this.model={},!0;default:return this.parser=this.map[f.name],!!this.parser&&(this.parser.parseOpen(f),!0)}}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return!!this.parser&&(this.parser.parseClose(f)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(f){return u.validPatternValues[f]}}u.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((h,f)=>(h[f]=!0,h),{}),u.StopXform=c,u.PatternFillXform=d,u.GradientFillXform=l,s.exports=u},{"../base-xform":32,"./color-xform":128}],131:[function(r,s,a){const i=r("./color-xform"),o=r("../simple/boolean-xform"),c=r("../simple/integer-xform"),d=r("../simple/string-xform"),l=r("./underline-xform"),u=r("../../../utils/under-dash"),h=r("../base-xform");class f extends h{constructor(p){super(),this.options=p||f.OPTIONS,this.map={b:{prop:"bold",xform:new o({tag:"b",attr:"val"})},i:{prop:"italic",xform:new o({tag:"i",attr:"val"})},u:{prop:"underline",xform:new l},charset:{prop:"charset",xform:new c({tag:"charset",attr:"val"})},color:{prop:"color",xform:new i},condense:{prop:"condense",xform:new o({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new o({tag:"extend",attr:"val"})},family:{prop:"family",xform:new c({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new o({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new d({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new d({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new o({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new o({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new c({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new d({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(p,g){const{map:v}=this;p.openNode(this.options.tagName),u.each(this.map,(x,y)=>{v[y].xform.render(p,g[x.prop])}),p.closeNode()}parseOpen(p){if(this.parser)return this.parser.parseOpen(p),!0;if(this.map[p.name])return this.parser=this.map[p.name].xform,this.parser.parseOpen(p);switch(p.name){case this.options.tagName:return this.model={},!0;default:return!1}}parseText(p){this.parser&&this.parser.parseText(p)}parseClose(p){if(this.parser&&!this.parser.parseClose(p)){const g=this.map[p];return this.parser.model&&(this.model[g.prop]=this.parser.model),this.parser=void 0,!0}switch(p){case this.options.tagName:return!1;default:return!0}}}f.OPTIONS={tagName:"font",fontNameTag:"name"},s.exports=f},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(r,s,a){const i=r("../../../utils/under-dash"),o=r("../../defaultnumformats"),c=r("../base-xform"),d=function(){const u={};return i.each(o,(h,f)=>{h.f&&(u[h.f]=parseInt(f,10))}),u}();class l extends c{constructor(h,f){super(),this.id=h,this.formatCode=f}get tag(){return"numFmt"}render(h,f){h.leafNode("numFmt",{numFmtId:f.id,formatCode:f.formatCode})}parseOpen(h){switch(h.name){case"numFmt":return this.model={id:parseInt(h.attributes.numFmtId,10),formatCode:h.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0;default:return!1}}parseText(){}parseClose(){return!1}}l.getDefaultFmtId=function(u){return d[u]},l.getDefaultFmtCode=function(u){return o[u]&&o[u].f},s.exports=l},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(r,s,a){const i=r("../base-xform"),o={boolean:(c,d)=>c===void 0?d:c};s.exports=class extends i{get tag(){return"protection"}render(c,d){c.addRollback(),c.openNode("protection");let l=!1;function u(h,f){f!==void 0&&(c.addAttribute(h,f),l=!0)}u("locked",o.boolean(d.locked,!0)?void 0:"0"),u("hidden",o.boolean(d.hidden,!1)?"1":void 0),c.closeNode(),l?c.commit():c.rollback()}parseOpen(c){const d={locked:c.attributes.locked!=="0",hidden:c.attributes.hidden==="1"},l=!d.locked||d.hidden;this.model=l?d:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(r,s,a){const i=r("../base-xform"),o=r("./alignment-xform"),c=r("./protection-xform");s.exports=class extends i{constructor(d){super(),this.xfId=!(!d||!d.xfId),this.map={alignment:new o,protection:new c}}get tag(){return"xf"}render(d,l){d.openNode("xf",{numFmtId:l.numFmtId||0,fontId:l.fontId||0,fillId:l.fillId||0,borderId:l.borderId||0}),this.xfId&&d.addAttribute("xfId",l.xfId||0),l.numFmtId&&d.addAttribute("applyNumberFormat","1"),l.fontId&&d.addAttribute("applyFont","1"),l.fillId&&d.addAttribute("applyFill","1"),l.borderId&&d.addAttribute("applyBorder","1"),l.alignment&&d.addAttribute("applyAlignment","1"),l.protection&&d.addAttribute("applyProtection","1"),l.alignment&&this.map.alignment.render(d,l.alignment),l.protection&&this.map.protection.render(d,l.protection),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"xf":return this.model={numFmtId:parseInt(d.attributes.numFmtId,10),fontId:parseInt(d.attributes.fontId,10),fillId:parseInt(d.attributes.fillId,10),borderId:parseInt(d.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(d.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(d),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):d!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(r,s,a){const i=r("../../../doc/enums"),o=r("../../../utils/xml-stream"),c=r("../base-xform"),d=r("../static-xform"),l=r("../list-xform"),u=r("./font-xform"),h=r("./fill-xform"),f=r("./border-xform"),m=r("./numfmt-xform"),p=r("./style-xform"),g=r("./dxf-xform");class v extends c{constructor(y){super(),this.map={numFmts:new l({tag:"numFmts",count:!0,childXform:new m}),fonts:new l({tag:"fonts",count:!0,childXform:new u,$:{"x14ac:knownFonts":1}}),fills:new l({tag:"fills",count:!0,childXform:new h}),borders:new l({tag:"borders",count:!0,childXform:new f}),cellStyleXfs:new l({tag:"cellStyleXfs",count:!0,childXform:new p}),cellXfs:new l({tag:"cellXfs",count:!0,childXform:new p({xfId:!0})}),dxfs:new l({tag:"dxfs",always:!0,count:!0,childXform:new g}),numFmt:new m,font:new u,fill:new h,border:new f,style:new p({xfId:!0}),cellStyles:v.STATIC_XFORMS.cellStyles,tableStyles:v.STATIC_XFORMS.tableStyles,extLst:v.STATIC_XFORMS.extLst},y&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(y,b){b=b||this.model,y.openXml(o.StdDocAttributes),y.openNode("styleSheet",v.STYLESHEET_ATTRIBUTES),this.index?(b.numFmts&&b.numFmts.length&&(y.openNode("numFmts",{count:b.numFmts.length}),b.numFmts.forEach(j=>{y.writeXml(j)}),y.closeNode()),b.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),y.openNode("fonts",{count:b.fonts.length,"x14ac:knownFonts":1}),b.fonts.forEach(j=>{y.writeXml(j)}),y.closeNode(),y.openNode("fills",{count:b.fills.length}),b.fills.forEach(j=>{y.writeXml(j)}),y.closeNode(),y.openNode("borders",{count:b.borders.length}),b.borders.forEach(j=>{y.writeXml(j)}),y.closeNode(),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),y.openNode("cellXfs",{count:b.styles.length}),b.styles.forEach(j=>{y.writeXml(j)}),y.closeNode()):(this.map.numFmts.render(y,b.numFmts),this.map.fonts.render(y,b.fonts),this.map.fills.render(y,b.fills),this.map.borders.render(y,b.borders),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(y,b.styles)),v.STATIC_XFORMS.cellStyles.render(y),this.map.dxfs.render(y,b.dxfs),v.STATIC_XFORMS.tableStyles.render(y),v.STATIC_XFORMS.extLst.render(y),y.closeNode()}parseOpen(y){if(this.parser)return this.parser.parseOpen(y),!0;switch(y.name){case"styleSheet":return this.initIndex(),!0;default:return this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0}}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"styleSheet":{this.model={};const b=(j,T)=>{T.model&&T.model.length&&(this.model[j]=T.model)};if(b("numFmts",this.map.numFmts),b("fonts",this.map.fonts),b("fills",this.map.fills),b("borders",this.map.borders),b("styles",this.map.cellXfs),b("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const j=this.index.numFmt;this.model.numFmts.forEach(T=>{j[T.id]=T.formatCode})}return!1}default:return!0}}addStyleModel(y,b){if(!y)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(y))return this.weakMap.get(y);const j={};if(b=b||i.ValueType.Number,y.numFmt)j.numFmtId=this._addNumFmtStr(y.numFmt);else switch(b){case i.ValueType.Number:j.numFmtId=this._addNumFmtStr("General");break;case i.ValueType.Date:j.numFmtId=this._addNumFmtStr("mm-dd-yy")}y.font&&(j.fontId=this._addFont(y.font)),y.border&&(j.borderId=this._addBorder(y.border)),y.fill&&(j.fillId=this._addFill(y.fill)),y.alignment&&(j.alignment=y.alignment),y.protection&&(j.protection=y.protection);const T=this._addStyle(j);return this.weakMap&&this.weakMap.set(y,T),T}getStyleModel(y){const b=this.model.styles[y];if(!b)return null;let j=this.index.model[y];if(j)return j;if(j=this.index.model[y]={},b.numFmtId){const O=this.index.numFmt[b.numFmtId]||m.getDefaultFmtCode(b.numFmtId);O&&(j.numFmt=O)}function T(O,R,D){if(D||D===0){const L=R[D];L&&(j[O]=L)}}return T("font",this.model.fonts,b.fontId),T("border",this.model.borders,b.borderId),T("fill",this.model.fills,b.fillId),b.alignment&&(j.alignment=b.alignment),b.protection&&(j.protection=b.protection),j}addDxfStyle(y){return y.numFmt&&(y.numFmtId=this._addNumFmtStr(y.numFmt)),this.model.dxfs.push(y),this.model.dxfs.length-1}getDxfStyle(y){return this.model.dxfs[y]}_addStyle(y){const b=this.map.style.toXml(y);let j=this.index.style[b];return j===void 0&&(j=this.index.style[b]=this.model.styles.length,this.model.styles.push(b)),j}_addNumFmtStr(y){let b=m.getDefaultFmtId(y);if(b!==void 0||(b=this.index.numFmt[y],b!==void 0))return b;b=this.index.numFmt[y]=164+this.model.numFmts.length;const j=this.map.numFmt.toXml({id:b,formatCode:y});return this.model.numFmts.push(j),b}_addFont(y){const b=this.map.font.toXml(y);let j=this.index.font[b];return j===void 0&&(j=this.index.font[b]=this.model.fonts.length,this.model.fonts.push(b)),j}_addBorder(y){const b=this.map.border.toXml(y);let j=this.index.border[b];return j===void 0&&(j=this.index.border[b]=this.model.borders.length,this.model.borders.push(b)),j}_addFill(y){const b=this.map.fill.toXml(y);let j=this.index.fill[b];return j===void 0&&(j=this.index.fill[b]=this.model.fills.length,this.model.fills.push(b)),j}}v.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},v.STATIC_XFORMS={cellStyles:new d({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new d({tag:"dxfs",$:{count:0}}),tableStyles:new d({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new d({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},v.Mock=class extends v{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(x){return x.autodrain(),Promise.resolve()}addStyleModel(x,y){switch(y){case i.ValueType.Date:return this.dateStyleId;default:return 0}}get dateStyleId(){if(!this._dateStyleId){const x={numFmtId:m.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(x)}return this._dateStyleId}getStyleModel(){return{}}},s.exports=v},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(r,s,a){const i=r("../base-xform");class o extends i{constructor(d){super(),this.model=d}get tag(){return"u"}render(d,l){if((l=l||this.model)===!0)d.leafNode("u");else{const u=o.Attributes[l];u&&d.leafNode("u",u)}}parseOpen(d){d.name==="u"&&(this.model=d.attributes.val||!0)}parseText(){}parseClose(){return!1}}o.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},s.exports=o},{"../base-xform":32}],137:[function(r,s,a){const i=r("../base-xform"),o=r("./filter-column-xform");s.exports=class extends i{constructor(){super(),this.map={filterColumn:new o}}get tag(){return"autoFilter"}prepare(c){c.columns.forEach((d,l)=>{this.map.filterColumn.prepare(d,{index:l})})}render(c,d){return c.openNode(this.tag,{ref:d.autoFilterRef}),d.columns.forEach(l=>{this.map.filterColumn.render(c,l)}),c.closeNode(),!0}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case this.tag:return this.model={autoFilterRef:c.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[c.name],this.parser)return this.parseOpen(c),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(c))}}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;switch(c){case this.tag:return!1;default:throw new Error("Unexpected xml node in parseClose: "+c)}}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"customFilter"}render(o,c){o.leafNode(this.tag,{val:c.val,operator:c.operator})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val,operator:o.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(r,s,a){const i=r("../base-xform"),o=r("../list-xform"),c=r("./custom-filter-xform"),d=r("./filter-xform");s.exports=class extends i{constructor(){super(),this.map={customFilters:new o({tag:"customFilters",count:!1,empty:!0,childXform:new c}),filters:new o({tag:"filters",count:!1,empty:!0,childXform:new d})}}get tag(){return"filterColumn"}prepare(l,u){l.colId=u.index.toString()}render(l,u){return u.customFilters?(l.openNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),this.map.customFilters.render(l,u.customFilters),l.closeNode(),!0):(l.leafNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),!0)}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;const{attributes:u}=l;switch(l.name){case this.tag:return this.model={filterButton:u.hiddenButton==="0"},!0;default:if(this.parser=this.map[l.name],this.parser)return this.parseOpen(l),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(){}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.parser=void 0),!0;switch(l){case this.tag:return this.model.customFilters=this.map.customFilters.model,!1;default:return!0}}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"filter"}render(o,c){o.leafNode(this.tag,{val:c.val})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"tableColumn"}prepare(o,c){o.id=c.index+1}render(o,c){return o.leafNode(this.tag,{id:c.id.toString(),name:c.name,totalsRowLabel:c.totalsRowLabel,totalsRowFunction:c.totalsRowFunction,dxfId:c.dxfId}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:c}=o;return this.model={name:c.name,totalsRowLabel:c.totalsRowLabel,totalsRowFunction:c.totalsRowFunction,dxfId:c.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(r,s,a){const i=r("../base-xform");s.exports=class extends i{get tag(){return"tableStyleInfo"}render(o,c){return o.leafNode(this.tag,{name:c.theme?c.theme:void 0,showFirstColumn:c.showFirstColumn?"1":"0",showLastColumn:c.showLastColumn?"1":"0",showRowStripes:c.showRowStripes?"1":"0",showColumnStripes:c.showColumnStripes?"1":"0"}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:c}=o;return this.model={theme:c.name?c.name:null,showFirstColumn:c.showFirstColumn==="1",showLastColumn:c.showLastColumn==="1",showRowStripes:c.showRowStripes==="1",showColumnStripes:c.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(r,s,a){const i=r("../../../utils/xml-stream"),o=r("../base-xform"),c=r("../list-xform"),d=r("./auto-filter-xform"),l=r("./table-column-xform"),u=r("./table-style-info-xform");class h extends o{constructor(){super(),this.map={autoFilter:new d,tableColumns:new c({tag:"tableColumns",count:!0,empty:!0,childXform:new l}),tableStyleInfo:new u}}prepare(m,p){this.map.autoFilter.prepare(m),this.map.tableColumns.prepare(m.columns,p)}get tag(){return"table"}render(m,p){m.openXml(i.StdDocAttributes),m.openNode(this.tag,{...h.TABLE_ATTRIBUTES,id:p.id,name:p.name,displayName:p.displayName||p.name,ref:p.tableRef,totalsRowCount:p.totalsRow?"1":void 0,totalsRowShown:p.totalsRow?void 0:"1",headerRowCount:p.headerRow?"1":"0"}),this.map.autoFilter.render(m,p),this.map.tableColumns.render(m,p.columns),this.map.tableStyleInfo.render(m,p.style),m.closeNode()}parseOpen(m){if(this.parser)return this.parser.parseOpen(m),!0;const{name:p,attributes:g}=m;switch(p){case this.tag:this.reset(),this.model={name:g.name,displayName:g.displayName||g.name,tableRef:g.ref,totalsRow:g.totalsRowCount==="1",headerRow:g.headerRowCount==="1"};break;default:this.parser=this.map[m.name],this.parser&&this.parser.parseOpen(m)}return!0}parseText(m){this.parser&&this.parser.parseText(m)}parseClose(m){if(this.parser)return this.parser.parseClose(m)||(this.parser=void 0),!0;switch(m){case this.tag:return this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((p,g)=>{this.model.columns[g].filterButton=p.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1;default:return!0}}reconcile(m,p){m.columns.forEach(g=>{g.dxfId!==void 0&&(g.style=p.styles.getDxfStyle(g.dxfId))})}}h.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},s.exports=h},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(r,s,a){(function(i,o){(function(){const c=r("fs"),d=r("jszip"),{PassThrough:l}=r("readable-stream"),u=r("../utils/zip-stream"),h=r("../utils/stream-buf"),f=r("../utils/utils"),m=r("../utils/xml-stream"),{bufferToString:p}=r("../utils/browser-buffer-decode"),g=r("./xform/style/styles-xform"),v=r("./xform/core/core-xform"),x=r("./xform/strings/shared-strings-xform"),y=r("./xform/core/relationships-xform"),b=r("./xform/core/content-types-xform"),j=r("./xform/core/app-xform"),T=r("./xform/book/workbook-xform"),O=r("./xform/sheet/worksheet-xform"),R=r("./xform/drawing/drawing-xform"),D=r("./xform/table/table-xform"),L=r("./xform/comment/comments-xform"),q=r("./xform/comment/vml-notes-xform"),X=r("./xml/theme1");class H{constructor(F){this.workbook=F}async readFile(F,S){if(!await f.fs.exists(F))throw new Error("File not found: "+F);const E=c.createReadStream(F);try{const N=await this.read(E,S);return E.close(),N}catch(N){throw E.close(),N}}parseRels(F){return new y().parseStream(F)}parseWorkbook(F){return new T().parseStream(F)}parseSharedStrings(F){return new x().parseStream(F)}reconcile(F,S){const E=new T,N=new O(S),C=new R,k=new D;E.reconcile(F);const I={media:F.media,mediaIndex:F.mediaIndex};Object.keys(F.drawings).forEach(Y=>{const Z=F.drawings[Y],re=F.drawingRels[Y];re&&(I.rels=re.reduce((G,J)=>(G[J.Id]=J,G),{}),(Z.anchors||[]).forEach(G=>{const J=G.picture&&G.picture.hyperlinks;J&&I.rels[J.rId]&&(J.hyperlink=I.rels[J.rId].Target,delete J.rId)}),C.reconcile(Z,I))});const U={styles:F.styles};Object.values(F.tables).forEach(Y=>{k.reconcile(Y,U)});const $={styles:F.styles,sharedStrings:F.sharedStrings,media:F.media,mediaIndex:F.mediaIndex,date1904:F.properties&&F.properties.date1904,drawings:F.drawings,comments:F.comments,tables:F.tables,vmlDrawings:F.vmlDrawings};F.worksheets.forEach(Y=>{Y.relationships=F.worksheetRels[Y.sheetNo],N.reconcile(Y,$)}),delete F.worksheetHash,delete F.worksheetRels,delete F.globalRels,delete F.sharedStrings,delete F.workbookRels,delete F.sheetDefs,delete F.styles,delete F.mediaIndex,delete F.drawings,delete F.drawingRels,delete F.vmlDrawings}async _processWorksheetEntry(F,S,E,N,C){const k=new O(N),I=await k.parseStream(F);I.sheetNo=E,S.worksheetHash[C]=I,S.worksheets.push(I)}async _processCommentEntry(F,S,E){const N=new L,C=await N.parseStream(F);S.comments[`../${E}.xml`]=C}async _processTableEntry(F,S,E){const N=new D,C=await N.parseStream(F);S.tables[`../tables/${E}.xml`]=C}async _processWorksheetRelsEntry(F,S,E){const N=new y,C=await N.parseStream(F);S.worksheetRels[E]=C}async _processMediaEntry(F,S,E){const N=E.lastIndexOf(".");if(N>=1){const C=E.substr(N+1),k=E.substr(0,N);await new Promise((I,U)=>{const $=new h;$.on("finish",()=>{S.mediaIndex[E]=S.media.length,S.mediaIndex[k]=S.media.length;const Y={type:"image",name:k,extension:C,buffer:$.toBuffer()};S.media.push(Y),I()}),F.on("error",Y=>{U(Y)}),F.pipe($)})}}async _processDrawingEntry(F,S,E){const N=new R,C=await N.parseStream(F);S.drawings[E]=C}async _processDrawingRelsEntry(F,S,E){const N=new y,C=await N.parseStream(F);S.drawingRels[E]=C}async _processVmlDrawingEntry(F,S,E){const N=new q,C=await N.parseStream(F);S.vmlDrawings[`../drawings/${E}.vml`]=C}async _processThemeEntry(F,S,E){await new Promise((N,C)=>{const k=new h;F.on("error",C),k.on("error",C),k.on("finish",()=>{S.themes[E]=k.read().toString(),N()}),F.pipe(k)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(F,S){!F[Symbol.asyncIterator]&&F.pipe&&(F=F.pipe(new l));const E=[];for await(const N of F)E.push(N);return this.load(o.concat(E),S)}async load(F,S){let E;E=S&&S.base64?o.from(F.toString(),"base64"):F;const N={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},C=await d.loadAsync(E);for(const k of Object.values(C.files))if(!k.dir){let I,U=k.name;if(U[0]==="/"&&(U=U.substr(1)),U.match(/xl\/media\//)||U.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))I=new l,I.write(await k.async("nodebuffer"));else{let $;I=new l({writableObjectMode:!0,readableObjectMode:!0}),$=i.browser?p(await k.async("nodebuffer")):await k.async("string");const Y=16384;for(let Z=0;Z<$.length;Z+=Y)I.write($.substring(Z,Z+Y))}switch(I.end(),U){case"_rels/.rels":N.globalRels=await this.parseRels(I);break;case"xl/workbook.xml":{const $=await this.parseWorkbook(I);N.sheets=$.sheets,N.definedNames=$.definedNames,N.views=$.views,N.properties=$.properties,N.calcProperties=$.calcProperties;break}case"xl/_rels/workbook.xml.rels":N.workbookRels=await this.parseRels(I);break;case"xl/sharedStrings.xml":N.sharedStrings=new x,await N.sharedStrings.parseStream(I);break;case"xl/styles.xml":N.styles=new g,await N.styles.parseStream(I);break;case"docProps/app.xml":{const $=new j,Y=await $.parseStream(I);N.company=Y.company,N.manager=Y.manager;break}case"docProps/core.xml":{const $=new v,Y=await $.parseStream(I);Object.assign(N,Y);break}default:{let $=U.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if($){await this._processWorksheetEntry(I,N,$[1],S,U);break}if($=U.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),$){await this._processWorksheetRelsEntry(I,N,$[1]);break}if($=U.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),$){await this._processThemeEntry(I,N,$[1]);break}if($=U.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),$){await this._processMediaEntry(I,N,$[1]);break}if($=U.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),$){await this._processDrawingEntry(I,N,$[1]);break}if($=U.match(/xl\/(comments\d+)[.]xml/),$){await this._processCommentEntry(I,N,$[1]);break}if($=U.match(/xl\/tables\/(table\d+)[.]xml/),$){await this._processTableEntry(I,N,$[1]);break}if($=U.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),$){await this._processDrawingRelsEntry(I,N,$[1]);break}if($=U.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),$){await this._processVmlDrawingEntry(I,N,$[1]);break}}}}return this.reconcile(N,S),this.workbook.model=N,this.workbook}async addMedia(F,S){await Promise.all(S.media.map(async E=>{if(E.type==="image"){const N=`xl/media/${E.name}.${E.extension}`;if(E.filename){const C=await function(k,I){return new Promise((U,$)=>{c.readFile(k,I,(Y,Z)=>{Y?$(Y):U(Z)})})}(E.filename);return F.append(C,{name:N})}if(E.buffer)return F.append(E.buffer,{name:N});if(E.base64){const C=E.base64,k=C.substring(C.indexOf(",")+1);return F.append(k,{name:N,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(F,S){const E=new R,N=new y;S.worksheets.forEach(C=>{const{drawing:k}=C;if(k){E.prepare(k,{});let I=E.toXml(k);F.append(I,{name:`xl/drawings/${k.name}.xml`}),I=N.toXml(k.rels),F.append(I,{name:`xl/drawings/_rels/${k.name}.xml.rels`})}})}addTables(F,S){const E=new D;S.worksheets.forEach(N=>{const{tables:C}=N;C.forEach(k=>{E.prepare(k,{});const I=E.toXml(k);F.append(I,{name:"xl/tables/"+k.target})})})}async addContentTypes(F,S){const E=new b().toXml(S);F.append(E,{name:"[Content_Types].xml"})}async addApp(F,S){const E=new j().toXml(S);F.append(E,{name:"docProps/app.xml"})}async addCore(F,S){const E=new v;F.append(E.toXml(S),{name:"docProps/core.xml"})}async addThemes(F,S){const E=S.themes||{theme1:X};Object.keys(E).forEach(N=>{const C=E[N],k=`xl/theme/${N}.xml`;F.append(C,{name:k})})}async addOfficeRels(F){const S=new y().toXml([{Id:"rId1",Type:H.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:H.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:H.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);F.append(S,{name:"_rels/.rels"})}async addWorkbookRels(F,S){let E=1;const N=[{Id:"rId"+E++,Type:H.RelType.Styles,Target:"styles.xml"},{Id:"rId"+E++,Type:H.RelType.Theme,Target:"theme/theme1.xml"}];S.sharedStrings.count&&N.push({Id:"rId"+E++,Type:H.RelType.SharedStrings,Target:"sharedStrings.xml"}),S.worksheets.forEach(k=>{k.rId="rId"+E++,N.push({Id:k.rId,Type:H.RelType.Worksheet,Target:`worksheets/sheet${k.id}.xml`})});const C=new y().toXml(N);F.append(C,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(F,S){S.sharedStrings&&S.sharedStrings.count&&F.append(S.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(F,S){const{xml:E}=S.styles;E&&F.append(E,{name:"xl/styles.xml"})}async addWorkbook(F,S){const E=new T;F.append(E.toXml(S),{name:"xl/workbook.xml"})}async addWorksheets(F,S){const E=new O,N=new y,C=new L,k=new q;S.worksheets.forEach(I=>{let U=new m;E.render(U,I),F.append(U.xml,{name:`xl/worksheets/sheet${I.id}.xml`}),I.rels&&I.rels.length&&(U=new m,N.render(U,I.rels),F.append(U.xml,{name:`xl/worksheets/_rels/sheet${I.id}.xml.rels`})),I.comments.length>0&&(U=new m,C.render(U,I),F.append(U.xml,{name:`xl/comments${I.id}.xml`}),U=new m,k.render(U,I),F.append(U.xml,{name:`xl/drawings/vmlDrawing${I.id}.vml`}))})}_finalize(F){return new Promise((S,E)=>{F.on("finish",()=>{S(this)}),F.on("error",E),F.finalize()})}prepareModel(F,S){F.creator=F.creator||"ExcelJS",F.lastModifiedBy=F.lastModifiedBy||"ExcelJS",F.created=F.created||new Date,F.modified=F.modified||new Date,F.useSharedStrings=S.useSharedStrings===void 0||S.useSharedStrings,F.useStyles=S.useStyles===void 0||S.useStyles,F.sharedStrings=new x,F.styles=F.useStyles?new g(!0):new g.Mock;const E=new T,N=new O;E.prepare(F);const C={sharedStrings:F.sharedStrings,styles:F.styles,date1904:F.properties.date1904,drawingsCount:0,media:F.media};C.drawings=F.drawings=[],C.commentRefs=F.commentRefs=[];let k=0;F.tables=[],F.worksheets.forEach(I=>{I.tables.forEach(U=>{k++,U.target=`table${k}.xml`,U.id=k,F.tables.push(U)}),N.prepare(I,C)})}async write(F,S){S=S||{};const{model:E}=this.workbook,N=new u.ZipWriter(S.zip);return N.pipe(F),this.prepareModel(E,S),await this.addContentTypes(N,E),await this.addOfficeRels(N,E),await this.addWorkbookRels(N,E),await this.addWorksheets(N,E),await this.addSharedStrings(N,E),await this.addDrawings(N,E),await this.addTables(N,E),await Promise.all([this.addThemes(N,E),this.addStyles(N,E)]),await this.addMedia(N,E),await Promise.all([this.addApp(N,E),this.addCore(N,E)]),await this.addWorkbook(N,E),this._finalize(N)}writeFile(F,S){const E=c.createWriteStream(F);return new Promise((N,C)=>{E.on("finish",()=>{N()}),E.on("error",k=>{C(k)}),this.write(E,S).then(()=>{E.end()}).catch(k=>{C(k)})})}async writeBuffer(F){const S=new h;return await this.write(S,F),S.read()}}H.RelType=r("./rel-type"),s.exports=H}).call(this)}).call(this,r("_process"),r("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(r,s,a){s.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(r,s,a){(function(i){(function(){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvFormatterStream=void 0;const o=r("stream"),c=r("./formatter");class d extends o.Transform{constructor(u){super({writableObjectMode:u.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=u,this.rowFormatter=new c.RowFormatter(u),this.hasWrittenBOM=!u.writeBOM}transform(u){return this.rowFormatter.rowTransform=u,this}_transform(u,h,f){let m=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(u,(p,g)=>p?(m=!0,f(p)):(g&&g.forEach(v=>{this.push(i.from(v,"utf8"))}),m=!0,f()))}catch(p){if(m)throw p;f(p)}}_flush(u){this.rowFormatter.finish((h,f)=>h?u(h):(f&&f.forEach(m=>{this.push(i.from(m,"utf8"))}),u()))}}a.CsvFormatterStream=d}).call(this)}).call(this,r("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.FormatterOptions=void 0,a.FormatterOptions=class{constructor(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var o;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,i||{}),(i==null?void 0:i.quoteHeaders)===void 0&&(this.quoteHeaders=this.quoteColumns),(i==null?void 0:i.quote)===!0?this.quote='"':(i==null?void 0:i.quote)===!1&&(this.quote=""),typeof(i==null?void 0:i.escape)!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((o=i.writeHeaders)===null||o===void 0||o),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(r,s,a){var i=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(a,"__esModule",{value:!0}),a.FieldFormatter=void 0;const o=i(r("lodash.isboolean")),c=i(r("lodash.isnil")),d=i(r("lodash.escaperegexp"));a.FieldFormatter=class{constructor(l){this._headers=null,this.formatterOptions=l,l.headers!==null&&(this.headers=l.headers),this.REPLACE_REGEXP=new RegExp(l.quote,"g");const u=`[${l.delimiter}${d.default(l.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(u)}set headers(l){this._headers=l}shouldQuote(l,u){const h=u?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return o.default(h)?h:Array.isArray(h)?h[l]:this._headers!==null&&h[this._headers[l]]}format(l,u,h){const f=(""+(c.default(l)?"":l)).replace(/\0/g,""),{formatterOptions:m}=this;return m.quote!==""&&f.indexOf(m.quote)!==-1?this.quoteField(f.replace(this.REPLACE_REGEXP,m.escapedQuote)):f.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(u,h)?this.quoteField(f):f}quoteField(l){const{quote:u}=this.formatterOptions;return`${u}${l}${u}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(r,s,a){var i=function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(a,"__esModule",{value:!0}),a.RowFormatter=void 0;const o=i(r("lodash.isfunction")),c=i(r("lodash.isequal")),d=r("./FieldFormatter"),l=r("../types");class u{constructor(f){this.rowCount=0,this.formatterOptions=f,this.fieldFormatter=new d.FieldFormatter(f),this.headers=f.headers,this.shouldWriteHeaders=f.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),f.transform&&(this.rowTransform=f.transform)}static isRowHashArray(f){return!!Array.isArray(f)&&Array.isArray(f[0])&&f[0].length===2}static isRowArray(f){return Array.isArray(f)&&!this.isRowHashArray(f)}static gatherHeaders(f){return u.isRowHashArray(f)?f.map(m=>m[0]):Array.isArray(f)?f:Object.keys(f)}static createTransform(f){return l.isSyncTransform(f)?(m,p)=>{let g=null;try{g=f(m)}catch(v){return p(v)}return p(null,g)}:(m,p)=>{f(m,p)}}set rowTransform(f){if(!o.default(f))throw new TypeError("The transform should be a function");this._rowTransform=u.createTransform(f)}format(f,m){this.callTransformer(f,(p,g)=>{if(p)return m(p);if(!f)return m(null);const v=[];if(g){const{shouldFormatColumns:x,headers:y}=this.checkHeaders(g);if(this.shouldWriteHeaders&&y&&!this.hasWrittenHeaders&&(v.push(this.formatColumns(y,!0)),this.hasWrittenHeaders=!0),x){const b=this.gatherColumns(g);v.push(this.formatColumns(b,!1))}}return m(null,v)})}finish(f){const m=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return f(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));m.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&m.push(this.formatterOptions.rowDelimiter),f(null,m)}checkHeaders(f){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const m=u.gatherHeaders(f);return this.headers=m,this.fieldFormatter.headers=m,this.shouldWriteHeaders?{shouldFormatColumns:!c.default(m,f),headers:m}:{shouldFormatColumns:!0,headers:null}}gatherColumns(f){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(f)?u.isRowHashArray(f)?this.headers.map((m,p)=>{const g=f[p];return g?g[1]:""}):u.isRowArray(f)&&!this.shouldWriteHeaders?f:this.headers.map((m,p)=>f[p]):this.headers.map(m=>f[m])}callTransformer(f,m){return this._rowTransform?this._rowTransform(f,m):m(null,f)}formatColumns(f,m){const p=f.map((v,x)=>this.fieldFormatter.format(v,x,m)).join(this.formatterOptions.delimiter),{rowCount:g}=this;return this.rowCount+=1,g?[this.formatterOptions.rowDelimiter,p].join(""):p}}a.RowFormatter=u},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.FieldFormatter=a.RowFormatter=void 0;var i=r("./RowFormatter");Object.defineProperty(a,"RowFormatter",{enumerable:!0,get:function(){return i.RowFormatter}});var o=r("./FieldFormatter");Object.defineProperty(a,"FieldFormatter",{enumerable:!0,get:function(){return o.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(r,s,a){(function(i){(function(){var o=Object.create?function(x,y,b,j){j===void 0&&(j=b),Object.defineProperty(x,j,{enumerable:!0,get:function(){return y[b]}})}:function(x,y,b,j){j===void 0&&(j=b),x[j]=y[b]},c=Object.create?function(x,y){Object.defineProperty(x,"default",{enumerable:!0,value:y})}:function(x,y){x.default=y},d=function(x){if(x&&x.__esModule)return x;var y={};if(x!=null)for(var b in x)b!=="default"&&Object.prototype.hasOwnProperty.call(x,b)&&o(y,x,b);return c(y,x),y},l=function(x,y){for(var b in x)b==="default"||Object.prototype.hasOwnProperty.call(y,b)||o(y,x,b)};Object.defineProperty(a,"__esModule",{value:!0}),a.writeToPath=a.writeToString=a.writeToBuffer=a.writeToStream=a.write=a.format=a.FormatterOptions=a.CsvFormatterStream=void 0;const u=r("util"),h=r("stream"),f=d(r("fs")),m=r("./FormatterOptions"),p=r("./CsvFormatterStream");l(r("./types"),a);var g=r("./CsvFormatterStream");Object.defineProperty(a,"CsvFormatterStream",{enumerable:!0,get:function(){return g.CsvFormatterStream}});var v=r("./FormatterOptions");Object.defineProperty(a,"FormatterOptions",{enumerable:!0,get:function(){return v.FormatterOptions}}),a.format=x=>new p.CsvFormatterStream(new m.FormatterOptions(x)),a.write=(x,y)=>{const b=a.format(y),j=u.promisify((T,O)=>{b.write(T,void 0,O)});return x.reduce((T,O)=>T.then(()=>j(O)),Promise.resolve()).then(()=>b.end()).catch(T=>{b.emit("error",T)}),b},a.writeToStream=(x,y,b)=>a.write(y,b).pipe(x),a.writeToBuffer=function(x){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const b=[],j=new h.Writable({write(T,O,R){b.push(T),R()}});return new Promise((T,O)=>{j.on("error",O).on("finish",()=>T(i.concat(b))),a.write(x,y).pipe(j)})},a.writeToString=(x,y)=>a.writeToBuffer(x,y).then(b=>b.toString()),a.writeToPath=(x,y,b)=>{const j=f.createWriteStream(x,{encoding:"utf8"});return a.write(y,b).pipe(j)}}).call(this)}).call(this,r("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.isSyncTransform=void 0,a.isSyncTransform=i=>i.length===1},{}],153:[function(r,s,a){(function(i){(function(){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvParserStream=void 0;const o=r("string_decoder"),c=r("stream"),d=r("./transforms"),l=r("./parser");class u extends c.Transform{constructor(f){super({objectMode:f.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=f,this.parser=new l.Parser(f),this.headerTransformer=new d.HeaderTransformer(f),this.decoder=new o.StringDecoder(f.encoding),this.rowTransformerValidator=new d.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(f){return this.rowTransformerValidator.rowTransform=f,this}validate(f){return this.rowTransformerValidator.rowValidator=f,this}emit(f){if(f==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var m=arguments.length,p=new Array(m>1?m-1:0),g=1;g<m;g++)p[g-1]=arguments[g];return super.emit(f,...p)}_transform(f,m,p){if(this.hasHitRowLimit)return p();const g=u.wrapDoneCallback(p);try{const{lines:v}=this,x=v+this.decoder.write(f),y=this.parse(x,!0);return this.processRows(y,g)}catch(v){return g(v)}}_flush(f){const m=u.wrapDoneCallback(f);if(this.hasHitRowLimit)return m();try{const p=this.lines+this.decoder.end(),g=this.parse(p,!1);return this.processRows(g,m)}catch(p){return m(p)}}parse(f,m){if(!f)return[];const{line:p,rows:g}=this.parser.parse(f,m);return this.lines=p,g}processRows(f,m){const p=f.length,g=v=>{const x=j=>j?m(j):v%100!=0?g(v+1):void i(()=>g(v+1));if(this.checkAndEmitHeaders(),v>=p||this.hasHitRowLimit)return m();if(this.parsedLineCount+=1,this.shouldSkipLine)return x();const y=f[v];this.rowCount+=1,this.parsedRowCount+=1;const b=this.rowCount;return this.transformRow(y,(j,T)=>{if(j)return this.rowCount-=1,x(j);if(!T)return x(new Error("expected transform result"));if(T.isValid){if(T.row)return this.pushRow(T.row,x)}else this.emit("data-invalid",T.row,b,T.reason);return x()})};g(0)}transformRow(f,m){try{this.headerTransformer.transform(f,(p,g)=>p?m(p):g?g.isValid?g.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(g.row,m):this.skipRow(m):(this.rowCount-=1,this.parsedRowCount-=1,m(null,{row:null,isValid:!0})):this.shouldEmitRows?m(null,{isValid:!1,row:f}):this.skipRow(m):m(new Error("Expected result from header transform")))}catch(p){m(p)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(f){return this.rowCount-=1,f(null,{row:null,isValid:!0})}pushRow(f,m){try{this.parserOptions.objectMode?this.push(f):this.push(JSON.stringify(f)),m()}catch(p){m(p)}}static wrapDoneCallback(f){let m=!1;return function(p){if(p){if(m)throw p;return m=!0,void f(p)}for(var g=arguments.length,v=new Array(g>1?g-1:0),x=1;x<g;x++)v[x-1]=arguments[x];f(...v)}}}a.CsvParserStream=u}).call(this)}).call(this,r("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(r,s,a){var i=function(d){return d&&d.__esModule?d:{default:d}};Object.defineProperty(a,"__esModule",{value:!0}),a.ParserOptions=void 0;const o=i(r("lodash.escaperegexp")),c=i(r("lodash.isnil"));a.ParserOptions=class{constructor(d){var l;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,d||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=o.default(this.delimiter),this.escapeChar=(l=this.escape)!==null&&l!==void 0?l:this.quote,this.supportsComments=!c.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(r,s,a){var i=Object.create?function(g,v,x,y){y===void 0&&(y=x),Object.defineProperty(g,y,{enumerable:!0,get:function(){return v[x]}})}:function(g,v,x,y){y===void 0&&(y=x),g[y]=v[x]},o=Object.create?function(g,v){Object.defineProperty(g,"default",{enumerable:!0,value:v})}:function(g,v){g.default=v},c=function(g){if(g&&g.__esModule)return g;var v={};if(g!=null)for(var x in g)x!=="default"&&Object.prototype.hasOwnProperty.call(g,x)&&i(v,g,x);return o(v,g),v},d=function(g,v){for(var x in g)x==="default"||Object.prototype.hasOwnProperty.call(v,x)||i(v,g,x)};Object.defineProperty(a,"__esModule",{value:!0}),a.parseString=a.parseFile=a.parseStream=a.parse=a.ParserOptions=a.CsvParserStream=void 0;const l=c(r("fs")),u=r("stream"),h=r("./ParserOptions"),f=r("./CsvParserStream");d(r("./types"),a);var m=r("./CsvParserStream");Object.defineProperty(a,"CsvParserStream",{enumerable:!0,get:function(){return m.CsvParserStream}});var p=r("./ParserOptions");Object.defineProperty(a,"ParserOptions",{enumerable:!0,get:function(){return p.ParserOptions}}),a.parse=g=>new f.CsvParserStream(new h.ParserOptions(g)),a.parseStream=(g,v)=>g.pipe(new f.CsvParserStream(new h.ParserOptions(v))),a.parseFile=function(g){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return l.createReadStream(g).pipe(new f.CsvParserStream(new h.ParserOptions(v)))},a.parseString=(g,v)=>{const x=new u.Readable;return x.push(g),x.push(null),x.pipe(new f.CsvParserStream(new h.ParserOptions(v)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Parser=void 0;const i=r("./Scanner"),o=r("./RowParser"),c=r("./Token");class d{constructor(u){this.parserOptions=u,this.rowParser=new o.RowParser(this.parserOptions)}static removeBOM(u){return u&&u.charCodeAt(0)===65279?u.slice(1):u}parse(u,h){const f=new i.Scanner({line:d.removeBOM(u),parserOptions:this.parserOptions,hasMoreData:h});return this.parserOptions.supportsComments?this.parseWithComments(f):this.parseWithoutComments(f)}parseWithoutComments(u){const h=[];let f=!0;for(;f;)f=this.parseRow(u,h);return{line:u.line,rows:h}}parseWithComments(u){const{parserOptions:h}=this,f=[];for(let m=u.nextCharacterToken;m!==null;m=u.nextCharacterToken)if(c.Token.isTokenComment(m,h)){if(u.advancePastLine()===null)return{line:u.lineFromCursor,rows:f};if(!u.hasMoreCharacters)return{line:u.lineFromCursor,rows:f};u.truncateToCursor()}else if(!this.parseRow(u,f))break;return{line:u.line,rows:f}}parseRow(u,h){if(!u.nextNonSpaceToken)return!1;const f=this.rowParser.parse(u);return f!==null&&(this.parserOptions.ignoreEmpty&&o.RowParser.isEmptyRow(f)||h.push(f),!0)}}a.Parser=d},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.RowParser=void 0;const i=r("./column"),o=r("./Token");a.RowParser=class{constructor(c){this.parserOptions=c,this.columnParser=new i.ColumnParser(c)}static isEmptyRow(c){return c.join("").replace(/\s+/g,"")===""}parse(c){const{parserOptions:d}=this,{hasMoreData:l}=c,u=c,h=[];let f=this.getStartToken(u,h);for(;f;){if(o.Token.isTokenRowDelimiter(f))return u.advancePastToken(f),!u.hasMoreCharacters&&o.Token.isTokenCarriageReturn(f,d)&&l?null:(u.truncateToCursor(),h);if(!this.shouldSkipColumnParse(u,f,h)){const m=this.columnParser.parse(u);if(m===null)return null;h.push(m)}f=u.nextNonSpaceToken}return l?null:(u.truncateToCursor(),h)}getStartToken(c,d){const l=c.nextNonSpaceToken;return l!==null&&o.Token.isTokenDelimiter(l,this.parserOptions)?(d.push(""),c.nextNonSpaceToken):l}shouldSkipColumnParse(c,d,l){const{parserOptions:u}=this;if(o.Token.isTokenDelimiter(d,u)){c.advancePastToken(d);const h=c.nextCharacterToken;if(!c.hasMoreCharacters||h!==null&&o.Token.isTokenRowDelimiter(h)||h!==null&&o.Token.isTokenDelimiter(h,u))return l.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Scanner=void 0;const i=r("./Token"),o=/((?:\r\n)|\n|\r)/;a.Scanner=class{constructor(c){this.cursor=0,this.line=c.line,this.lineLength=this.line.length,this.parserOptions=c.parserOptions,this.hasMoreData=c.hasMoreData,this.cursor=c.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:c}=this,d=this.parserOptions.NEXT_TOKEN_REGEXP;if(c.search(d)===-1)return null;const l=d.exec(c);if(l==null)return null;const u=l[1],h=this.cursor+(l.index||0);return new i.Token({token:u,startCursor:h,endCursor:h+u.length-1})}get nextCharacterToken(){const{cursor:c,lineLength:d}=this;return d<=c?null:new i.Token({token:this.line[c],startCursor:c,endCursor:c})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const c=o.exec(this.lineFromCursor);return c?(this.cursor+=(c.index||0)+c[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(c){return this.cursor=c,this}advanceToToken(c){return this.cursor=c.startCursor,this}advancePastToken(c){return this.cursor=c.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.Token=void 0,a.Token=class{constructor(i){this.token=i.token,this.startCursor=i.startCursor,this.endCursor=i.endCursor}static isTokenRowDelimiter(i){const o=i.token;return o==="\r"||o===`
`||o===`\r
`}static isTokenCarriageReturn(i,o){return i.token===o.carriageReturn}static isTokenComment(i,o){return o.supportsComments&&!!i&&i.token===o.comment}static isTokenEscapeCharacter(i,o){return i.token===o.escapeChar}static isTokenQuote(i,o){return i.token===o.quote}static isTokenDelimiter(i,o){return i.token===o.delimiter}}},{}],160:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnFormatter=void 0,a.ColumnFormatter=class{constructor(i){i.trim?this.format=o=>o.trim():i.ltrim?this.format=o=>o.trimLeft():i.rtrim?this.format=o=>o.trimRight():this.format=o=>o}}},{}],161:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnParser=void 0;const i=r("./NonQuotedColumnParser"),o=r("./QuotedColumnParser"),c=r("../Token");a.ColumnParser=class{constructor(d){this.parserOptions=d,this.quotedColumnParser=new o.QuotedColumnParser(d),this.nonQuotedColumnParser=new i.NonQuotedColumnParser(d)}parse(d){const{nextNonSpaceToken:l}=d;return l!==null&&c.Token.isTokenQuote(l,this.parserOptions)?(d.advanceToToken(l),this.quotedColumnParser.parse(d)):this.nonQuotedColumnParser.parse(d)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.NonQuotedColumnParser=void 0;const i=r("./ColumnFormatter"),o=r("../Token");a.NonQuotedColumnParser=class{constructor(c){this.parserOptions=c,this.columnFormatter=new i.ColumnFormatter(c)}parse(c){if(!c.hasMoreCharacters)return null;const{parserOptions:d}=this,l=[];let u=c.nextCharacterToken;for(;u&&!o.Token.isTokenDelimiter(u,d)&&!o.Token.isTokenRowDelimiter(u);u=c.nextCharacterToken)l.push(u.token),c.advancePastToken(u);return this.columnFormatter.format(l.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.QuotedColumnParser=void 0;const i=r("./ColumnFormatter"),o=r("../Token");a.QuotedColumnParser=class{constructor(c){this.parserOptions=c,this.columnFormatter=new i.ColumnFormatter(c)}parse(c){if(!c.hasMoreCharacters)return null;const d=c.cursor,{foundClosingQuote:l,col:u}=this.gatherDataBetweenQuotes(c);if(!l){if(c.advanceTo(d),!c.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${c.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(c),u}gatherDataBetweenQuotes(c){const{parserOptions:d}=this;let l=!1,u=!1;const h=[];let f=c.nextCharacterToken;for(;!u&&f!==null;f=c.nextCharacterToken){const m=o.Token.isTokenQuote(f,d);if(!l&&m)l=!0;else if(l)if(o.Token.isTokenEscapeCharacter(f,d)){c.advancePastToken(f);const p=c.nextCharacterToken;p!==null&&(o.Token.isTokenQuote(p,d)||o.Token.isTokenEscapeCharacter(p,d))?(h.push(p.token),f=p):m?u=!0:h.push(f.token)}else m?u=!0:h.push(f.token);c.advancePastToken(f)}return{col:this.columnFormatter.format(h.join("")),foundClosingQuote:u}}checkForMalformedColumn(c){const{parserOptions:d}=this,{nextNonSpaceToken:l}=c;if(l){const u=o.Token.isTokenDelimiter(l,d),h=o.Token.isTokenRowDelimiter(l);if(!u&&!h){const f=c.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${d.escapedDelimiter}' OR new line got: '${l.token}'. at '${f}`)}c.advanceToToken(l)}else c.hasMoreData||c.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.ColumnFormatter=a.QuotedColumnParser=a.NonQuotedColumnParser=a.ColumnParser=void 0;var i=r("./ColumnParser");Object.defineProperty(a,"ColumnParser",{enumerable:!0,get:function(){return i.ColumnParser}});var o=r("./NonQuotedColumnParser");Object.defineProperty(a,"NonQuotedColumnParser",{enumerable:!0,get:function(){return o.NonQuotedColumnParser}});var c=r("./QuotedColumnParser");Object.defineProperty(a,"QuotedColumnParser",{enumerable:!0,get:function(){return c.QuotedColumnParser}});var d=r("./ColumnFormatter");Object.defineProperty(a,"ColumnFormatter",{enumerable:!0,get:function(){return d.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.QuotedColumnParser=a.NonQuotedColumnParser=a.ColumnParser=a.Token=a.Scanner=a.RowParser=a.Parser=void 0;var i=r("./Parser");Object.defineProperty(a,"Parser",{enumerable:!0,get:function(){return i.Parser}});var o=r("./RowParser");Object.defineProperty(a,"RowParser",{enumerable:!0,get:function(){return o.RowParser}});var c=r("./Scanner");Object.defineProperty(a,"Scanner",{enumerable:!0,get:function(){return c.Scanner}});var d=r("./Token");Object.defineProperty(a,"Token",{enumerable:!0,get:function(){return d.Token}});var l=r("./column");Object.defineProperty(a,"ColumnParser",{enumerable:!0,get:function(){return l.ColumnParser}}),Object.defineProperty(a,"NonQuotedColumnParser",{enumerable:!0,get:function(){return l.NonQuotedColumnParser}}),Object.defineProperty(a,"QuotedColumnParser",{enumerable:!0,get:function(){return l.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(r,s,a){var i=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(a,"__esModule",{value:!0}),a.HeaderTransformer=void 0;const o=i(r("lodash.isundefined")),c=i(r("lodash.isfunction")),d=i(r("lodash.uniq")),l=i(r("lodash.groupby"));a.HeaderTransformer=class{constructor(u){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=u,u.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(u.headers)?this.setHeaders(u.headers):c.default(u.headers)&&(this.headersTransform=u.headers)}transform(u,h){return this.shouldMapRow(u)?h(null,this.processRow(u)):h(null,{row:null,isValid:!0})}shouldMapRow(u){const{parserOptions:h}=this;if(!this.headersTransform&&h.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(u)){if(this.headersTransform)this.setHeaders(this.headersTransform(u));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(u)}return!1}return!0}processRow(u){if(!this.headers)return{row:u,isValid:!0};const{parserOptions:h}=this;if(!h.discardUnmappedColumns&&u.length>this.headersLength){if(!h.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${u.length}`);return{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}}return h.strictColumnHandling&&u.length<this.headersLength?{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}:{row:this.mapHeaders(u),isValid:!0}}mapHeaders(u){const h={},{headers:f,headersLength:m}=this;for(let p=0;p<m;p+=1){const g=f[p];if(!o.default(g)){const v=u[p];o.default(v)?h[g]="":h[g]=v}}return h}setHeaders(u){var h;const f=u.filter(m=>!!m);if(d.default(f).length!==f.length){const m=l.default(f),p=Object.keys(m).filter(g=>m[g].length>1);throw new Error("Duplicate headers found "+JSON.stringify(p))}this.headers=u,this.receivedHeaders=!0,this.headersLength=((h=this.headers)===null||h===void 0?void 0:h.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(r,s,a){var i=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(a,"__esModule",{value:!0}),a.RowTransformerValidator=void 0;const o=i(r("lodash.isfunction")),c=r("../types");class d{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(u){return c.isSyncTransform(u)?(h,f)=>{let m=null;try{m=u(h)}catch(p){return f(p)}return f(null,m)}:u}static createValidator(u){return c.isSyncValidate(u)?(h,f)=>{f(null,{row:h,isValid:u(h)})}:(h,f)=>{u(h,(m,p,g)=>m?f(m):f(null,p?{row:h,isValid:p,reason:g}:{row:h,isValid:!1,reason:g}))}}set rowTransform(u){if(!o.default(u))throw new TypeError("The transform should be a function");this._rowTransform=d.createTransform(u)}set rowValidator(u){if(!o.default(u))throw new TypeError("The validate should be a function");this._rowValidator=d.createValidator(u)}transformAndValidate(u,h){return this.callTransformer(u,(f,m)=>f?h(f):m?this.callValidator(m,(p,g)=>p?h(p):g&&!g.isValid?h(null,{row:m,isValid:!1,reason:g.reason}):h(null,{row:m,isValid:!0})):h(null,{row:null,isValid:!0}))}callTransformer(u,h){return this._rowTransform?this._rowTransform(u,h):h(null,u)}callValidator(u,h){return this._rowValidator?this._rowValidator(u,h):h(null,{row:u,isValid:!0})}}a.RowTransformerValidator=d},{"../types":169,"lodash.isfunction":446}],168:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.HeaderTransformer=a.RowTransformerValidator=void 0;var i=r("./RowTransformerValidator");Object.defineProperty(a,"RowTransformerValidator",{enumerable:!0,get:function(){return i.RowTransformerValidator}});var o=r("./HeaderTransformer");Object.defineProperty(a,"HeaderTransformer",{enumerable:!0,get:function(){return o.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.isSyncValidate=a.isSyncTransform=void 0,a.isSyncTransform=i=>i.length===1,a.isSyncValidate=i=>i.length===1},{}],170:[function(r,s,a){const i=a;i.bignum=r("bn.js"),i.define=r("./asn1/api").define,i.base=r("./asn1/base"),i.constants=r("./asn1/constants"),i.decoders=r("./asn1/decoders"),i.encoders=r("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(r,s,a){const i=r("./encoders"),o=r("./decoders"),c=r("inherits");function d(l,u){this.name=l,this.body=u,this.decoders={},this.encoders={}}a.define=function(l,u){return new d(l,u)},d.prototype._createNamed=function(l){const u=this.name;function h(f){this._initNamed(f,u)}return c(h,l),h.prototype._initNamed=function(f,m){l.call(this,f,m)},new h(this)},d.prototype._getDecoder=function(l){return l=l||"der",this.decoders.hasOwnProperty(l)||(this.decoders[l]=this._createNamed(o[l])),this.decoders[l]},d.prototype.decode=function(l,u,h){return this._getDecoder(u).decode(l,h)},d.prototype._getEncoder=function(l){return l=l||"der",this.encoders.hasOwnProperty(l)||(this.encoders[l]=this._createNamed(i[l])),this.encoders[l]},d.prototype.encode=function(l,u,h){return this._getEncoder(u).encode(l,h)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(r,s,a){const i=r("inherits"),o=r("../base/reporter").Reporter,c=r("safer-buffer").Buffer;function d(u,h){o.call(this,h),c.isBuffer(u)?(this.base=u,this.offset=0,this.length=u.length):this.error("Input not Buffer")}function l(u,h){if(Array.isArray(u))this.length=0,this.value=u.map(function(f){return l.isEncoderBuffer(f)||(f=new l(f,h)),this.length+=f.length,f},this);else if(typeof u=="number"){if(!(0<=u&&u<=255))return h.error("non-byte EncoderBuffer value");this.value=u,this.length=1}else if(typeof u=="string")this.value=u,this.length=c.byteLength(u);else{if(!c.isBuffer(u))return h.error("Unsupported type: "+typeof u);this.value=u,this.length=u.length}}i(d,o),a.DecoderBuffer=d,d.isDecoderBuffer=function(u){return u instanceof d?!0:typeof u=="object"&&c.isBuffer(u.base)&&u.constructor.name==="DecoderBuffer"&&typeof u.offset=="number"&&typeof u.length=="number"&&typeof u.save=="function"&&typeof u.restore=="function"&&typeof u.isEmpty=="function"&&typeof u.readUInt8=="function"&&typeof u.skip=="function"&&typeof u.raw=="function"},d.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},d.prototype.restore=function(u){const h=new d(this.base);return h.offset=u.offset,h.length=this.offset,this.offset=u.offset,o.prototype.restore.call(this,u.reporter),h},d.prototype.isEmpty=function(){return this.offset===this.length},d.prototype.readUInt8=function(u){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(u||"DecoderBuffer overrun")},d.prototype.skip=function(u,h){if(!(this.offset+u<=this.length))return this.error(h||"DecoderBuffer overrun");const f=new d(this.base);return f._reporterState=this._reporterState,f.offset=this.offset,f.length=this.offset+u,this.offset+=u,f},d.prototype.raw=function(u){return this.base.slice(u?u.offset:this.offset,this.length)},a.EncoderBuffer=l,l.isEncoderBuffer=function(u){return u instanceof l?!0:typeof u=="object"&&u.constructor.name==="EncoderBuffer"&&typeof u.length=="number"&&typeof u.join=="function"},l.prototype.join=function(u,h){return u||(u=c.alloc(this.length)),h||(h=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(f){f.join(u,h),h+=f.length}):(typeof this.value=="number"?u[h]=this.value:typeof this.value=="string"?u.write(this.value,h):c.isBuffer(this.value)&&this.value.copy(u,h),h+=this.length)),u}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(r,s,a){const i=a;i.Reporter=r("./reporter").Reporter,i.DecoderBuffer=r("./buffer").DecoderBuffer,i.EncoderBuffer=r("./buffer").EncoderBuffer,i.Node=r("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(r,s,a){const i=r("../base/reporter").Reporter,o=r("../base/buffer").EncoderBuffer,c=r("../base/buffer").DecoderBuffer,d=r("minimalistic-assert"),l=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(l);function h(m,p,g){const v={};this._baseState=v,v.name=g,v.enc=m,v.parent=p||null,v.children=null,v.tag=null,v.args=null,v.reverseArgs=null,v.choice=null,v.optional=!1,v.any=!1,v.obj=!1,v.use=null,v.useDecoder=null,v.key=null,v.default=null,v.explicit=null,v.implicit=null,v.contains=null,v.parent||(v.children=[],this._wrap())}s.exports=h;const f=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];h.prototype.clone=function(){const m=this._baseState,p={};f.forEach(function(v){p[v]=m[v]});const g=new this.constructor(p.parent);return g._baseState=p,g},h.prototype._wrap=function(){const m=this._baseState;u.forEach(function(p){this[p]=function(){const g=new this.constructor(this);return m.children.push(g),g[p].apply(g,arguments)}},this)},h.prototype._init=function(m){const p=this._baseState;d(p.parent===null),m.call(this),p.children=p.children.filter(function(g){return g._baseState.parent===this},this),d.equal(p.children.length,1,"Root node can have only one child")},h.prototype._useArgs=function(m){const p=this._baseState,g=m.filter(function(v){return v instanceof this.constructor},this);m=m.filter(function(v){return!(v instanceof this.constructor)},this),g.length!==0&&(d(p.children===null),p.children=g,g.forEach(function(v){v._baseState.parent=this},this)),m.length!==0&&(d(p.args===null),p.args=m,p.reverseArgs=m.map(function(v){if(typeof v!="object"||v.constructor!==Object)return v;const x={};return Object.keys(v).forEach(function(y){y==(0|y)&&(y|=0);const b=v[y];x[b]=y}),x}))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach(function(m){h.prototype[m]=function(){const p=this._baseState;throw new Error(m+" not implemented for encoding: "+p.enc)}}),l.forEach(function(m){h.prototype[m]=function(){const p=this._baseState,g=Array.prototype.slice.call(arguments);return d(p.tag===null),p.tag=m,this._useArgs(g),this}}),h.prototype.use=function(m){d(m);const p=this._baseState;return d(p.use===null),p.use=m,this},h.prototype.optional=function(){return this._baseState.optional=!0,this},h.prototype.def=function(m){const p=this._baseState;return d(p.default===null),p.default=m,p.optional=!0,this},h.prototype.explicit=function(m){const p=this._baseState;return d(p.explicit===null&&p.implicit===null),p.explicit=m,this},h.prototype.implicit=function(m){const p=this._baseState;return d(p.explicit===null&&p.implicit===null),p.implicit=m,this},h.prototype.obj=function(){const m=this._baseState,p=Array.prototype.slice.call(arguments);return m.obj=!0,p.length!==0&&this._useArgs(p),this},h.prototype.key=function(m){const p=this._baseState;return d(p.key===null),p.key=m,this},h.prototype.any=function(){return this._baseState.any=!0,this},h.prototype.choice=function(m){const p=this._baseState;return d(p.choice===null),p.choice=m,this._useArgs(Object.keys(m).map(function(g){return m[g]})),this},h.prototype.contains=function(m){const p=this._baseState;return d(p.use===null),p.contains=m,this},h.prototype._decode=function(m,p){const g=this._baseState;if(g.parent===null)return m.wrapResult(g.children[0]._decode(m,p));let v,x=g.default,y=!0,b=null;if(g.key!==null&&(b=m.enterKey(g.key)),g.optional){let j=null;if(g.explicit!==null?j=g.explicit:g.implicit!==null?j=g.implicit:g.tag!==null&&(j=g.tag),j!==null||g.any){if(y=this._peekTag(m,j,g.any),m.isError(y))return y}else{const T=m.save();try{g.choice===null?this._decodeGeneric(g.tag,m,p):this._decodeChoice(m,p),y=!0}catch{y=!1}m.restore(T)}}if(g.obj&&y&&(v=m.enterObject()),y){if(g.explicit!==null){const T=this._decodeTag(m,g.explicit);if(m.isError(T))return T;m=T}const j=m.offset;if(g.use===null&&g.choice===null){let T;g.any&&(T=m.save());const O=this._decodeTag(m,g.implicit!==null?g.implicit:g.tag,g.any);if(m.isError(O))return O;g.any?x=m.raw(T):m=O}if(p&&p.track&&g.tag!==null&&p.track(m.path(),j,m.length,"tagged"),p&&p.track&&g.tag!==null&&p.track(m.path(),m.offset,m.length,"content"),g.any||(x=g.choice===null?this._decodeGeneric(g.tag,m,p):this._decodeChoice(m,p)),m.isError(x))return x;if(g.any||g.choice!==null||g.children===null||g.children.forEach(function(T){T._decode(m,p)}),g.contains&&(g.tag==="octstr"||g.tag==="bitstr")){const T=new c(x);x=this._getUse(g.contains,m._reporterState.obj)._decode(T,p)}}return g.obj&&y&&(x=m.leaveObject(v)),g.key===null||x===null&&y!==!0?b!==null&&m.exitKey(b):m.leaveKey(b,g.key,x),x},h.prototype._decodeGeneric=function(m,p,g){const v=this._baseState;return m==="seq"||m==="set"?null:m==="seqof"||m==="setof"?this._decodeList(p,m,v.args[0],g):/str$/.test(m)?this._decodeStr(p,m,g):m==="objid"&&v.args?this._decodeObjid(p,v.args[0],v.args[1],g):m==="objid"?this._decodeObjid(p,null,null,g):m==="gentime"||m==="utctime"?this._decodeTime(p,m,g):m==="null_"?this._decodeNull(p,g):m==="bool"?this._decodeBool(p,g):m==="objDesc"?this._decodeStr(p,m,g):m==="int"||m==="enum"?this._decodeInt(p,v.args&&v.args[0],g):v.use!==null?this._getUse(v.use,p._reporterState.obj)._decode(p,g):p.error("unknown tag: "+m)},h.prototype._getUse=function(m,p){const g=this._baseState;return g.useDecoder=this._use(m,p),d(g.useDecoder._baseState.parent===null),g.useDecoder=g.useDecoder._baseState.children[0],g.implicit!==g.useDecoder._baseState.implicit&&(g.useDecoder=g.useDecoder.clone(),g.useDecoder._baseState.implicit=g.implicit),g.useDecoder},h.prototype._decodeChoice=function(m,p){const g=this._baseState;let v=null,x=!1;return Object.keys(g.choice).some(function(y){const b=m.save(),j=g.choice[y];try{const T=j._decode(m,p);if(m.isError(T))return!1;v={type:y,value:T},x=!0}catch{return m.restore(b),!1}return!0},this),x?v:m.error("Choice not matched")},h.prototype._createEncoderBuffer=function(m){return new o(m,this.reporter)},h.prototype._encode=function(m,p,g){const v=this._baseState;if(v.default!==null&&v.default===m)return;const x=this._encodeValue(m,p,g);return x===void 0||this._skipDefault(x,p,g)?void 0:x},h.prototype._encodeValue=function(m,p,g){const v=this._baseState;if(v.parent===null)return v.children[0]._encode(m,p||new i);let x=null;if(this.reporter=p,v.optional&&m===void 0){if(v.default===null)return;m=v.default}let y=null,b=!1;if(v.any)x=this._createEncoderBuffer(m);else if(v.choice)x=this._encodeChoice(m,p);else if(v.contains)y=this._getUse(v.contains,g)._encode(m,p),b=!0;else if(v.children)y=v.children.map(function(j){if(j._baseState.tag==="null_")return j._encode(null,p,m);if(j._baseState.key===null)return p.error("Child should have a key");const T=p.enterKey(j._baseState.key);if(typeof m!="object")return p.error("Child expected, but input is not object");const O=j._encode(m[j._baseState.key],p,m);return p.leaveKey(T),O},this).filter(function(j){return j}),y=this._createEncoderBuffer(y);else if(v.tag==="seqof"||v.tag==="setof"){if(!v.args||v.args.length!==1)return p.error("Too many args for : "+v.tag);if(!Array.isArray(m))return p.error("seqof/setof, but data is not Array");const j=this.clone();j._baseState.implicit=null,y=this._createEncoderBuffer(m.map(function(T){const O=this._baseState;return this._getUse(O.args[0],m)._encode(T,p)},j))}else v.use!==null?x=this._getUse(v.use,g)._encode(m,p):(y=this._encodePrimitive(v.tag,m),b=!0);if(!v.any&&v.choice===null){const j=v.implicit!==null?v.implicit:v.tag,T=v.implicit===null?"universal":"context";j===null?v.use===null&&p.error("Tag could be omitted only for .use()"):v.use===null&&(x=this._encodeComposite(j,b,T,y))}return v.explicit!==null&&(x=this._encodeComposite(v.explicit,!1,"context",x)),x},h.prototype._encodeChoice=function(m,p){const g=this._baseState,v=g.choice[m.type];return v||d(!1,m.type+" not found in "+JSON.stringify(Object.keys(g.choice))),v._encode(m.value,p)},h.prototype._encodePrimitive=function(m,p){const g=this._baseState;if(/str$/.test(m))return this._encodeStr(p,m);if(m==="objid"&&g.args)return this._encodeObjid(p,g.reverseArgs[0],g.args[1]);if(m==="objid")return this._encodeObjid(p,null,null);if(m==="gentime"||m==="utctime")return this._encodeTime(p,m);if(m==="null_")return this._encodeNull();if(m==="int"||m==="enum")return this._encodeInt(p,g.args&&g.reverseArgs[0]);if(m==="bool")return this._encodeBool(p);if(m==="objDesc")return this._encodeStr(p,m);throw new Error("Unsupported tag: "+m)},h.prototype._isNumstr=function(m){return/^[0-9 ]*$/.test(m)},h.prototype._isPrintstr=function(m){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(m)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(r,s,a){const i=r("inherits");function o(d){this._reporterState={obj:null,path:[],options:d||{},errors:[]}}function c(d,l){this.path=d,this.rethrow(l)}a.Reporter=o,o.prototype.isError=function(d){return d instanceof c},o.prototype.save=function(){const d=this._reporterState;return{obj:d.obj,pathLen:d.path.length}},o.prototype.restore=function(d){const l=this._reporterState;l.obj=d.obj,l.path=l.path.slice(0,d.pathLen)},o.prototype.enterKey=function(d){return this._reporterState.path.push(d)},o.prototype.exitKey=function(d){const l=this._reporterState;l.path=l.path.slice(0,d-1)},o.prototype.leaveKey=function(d,l,u){const h=this._reporterState;this.exitKey(d),h.obj!==null&&(h.obj[l]=u)},o.prototype.path=function(){return this._reporterState.path.join("/")},o.prototype.enterObject=function(){const d=this._reporterState,l=d.obj;return d.obj={},l},o.prototype.leaveObject=function(d){const l=this._reporterState,u=l.obj;return l.obj=d,u},o.prototype.error=function(d){let l;const u=this._reporterState,h=d instanceof c;if(l=h?d:new c(u.path.map(function(f){return"["+JSON.stringify(f)+"]"}).join(""),d.message||d,d.stack),!u.options.partial)throw l;return h||u.errors.push(l),l},o.prototype.wrapResult=function(d){const l=this._reporterState;return l.options.partial?{result:this.isError(d)?null:d,errors:l.errors}:d},i(c,Error),c.prototype.rethrow=function(d){if(this.message=d+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,c),!this.stack)try{throw new Error(this.message)}catch(l){this.stack=l.stack}return this}},{inherits:440}],176:[function(r,s,a){function i(o){const c={};return Object.keys(o).forEach(function(d){(0|d)==d&&(d|=0);const l=o[d];c[l]=d}),c}a.tagClass={0:"universal",1:"application",2:"context",3:"private"},a.tagClassByName=i(a.tagClass),a.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},a.tagByName=i(a.tag)},{}],177:[function(r,s,a){const i=a;i._reverse=function(o){const c={};return Object.keys(o).forEach(function(d){(0|d)==d&&(d|=0);const l=o[d];c[l]=d}),c},i.der=r("./der")},{"./der":176}],178:[function(r,s,a){const i=r("inherits"),o=r("bn.js"),c=r("../base/buffer").DecoderBuffer,d=r("../base/node"),l=r("../constants/der");function u(p){this.enc="der",this.name=p.name,this.entity=p,this.tree=new h,this.tree._init(p.body)}function h(p){d.call(this,"der",p)}function f(p,g){let v=p.readUInt8(g);if(p.isError(v))return v;const x=l.tagClass[v>>6],y=(32&v)==0;if((31&v)==31){let b=v;for(v=0;(128&b)==128;){if(b=p.readUInt8(g),p.isError(b))return b;v<<=7,v|=127&b}}else v&=31;return{cls:x,primitive:y,tag:v,tagStr:l.tag[v]}}function m(p,g,v){let x=p.readUInt8(v);if(p.isError(x))return x;if(!g&&x===128)return null;if(!(128&x))return x;const y=127&x;if(y>4)return p.error("length octect is too long");x=0;for(let b=0;b<y;b++){x<<=8;const j=p.readUInt8(v);if(p.isError(j))return j;x|=j}return x}s.exports=u,u.prototype.decode=function(p,g){return c.isDecoderBuffer(p)||(p=new c(p,g)),this.tree._decode(p,g)},i(h,d),h.prototype._peekTag=function(p,g,v){if(p.isEmpty())return!1;const x=p.save(),y=f(p,'Failed to peek tag: "'+g+'"');return p.isError(y)?y:(p.restore(x),y.tag===g||y.tagStr===g||y.tagStr+"of"===g||v)},h.prototype._decodeTag=function(p,g,v){const x=f(p,'Failed to decode tag of "'+g+'"');if(p.isError(x))return x;let y=m(p,x.primitive,'Failed to get length of "'+g+'"');if(p.isError(y))return y;if(!v&&x.tag!==g&&x.tagStr!==g&&x.tagStr+"of"!==g)return p.error('Failed to match tag: "'+g+'"');if(x.primitive||y!==null)return p.skip(y,'Failed to match body of: "'+g+'"');const b=p.save(),j=this._skipUntilEnd(p,'Failed to skip indefinite length body: "'+this.tag+'"');return p.isError(j)?j:(y=p.offset-b.offset,p.restore(b),p.skip(y,'Failed to match body of: "'+g+'"'))},h.prototype._skipUntilEnd=function(p,g){for(;;){const v=f(p,g);if(p.isError(v))return v;const x=m(p,v.primitive,g);if(p.isError(x))return x;let y;if(y=v.primitive||x!==null?p.skip(x):this._skipUntilEnd(p,g),p.isError(y))return y;if(v.tagStr==="end")break}},h.prototype._decodeList=function(p,g,v,x){const y=[];for(;!p.isEmpty();){const b=this._peekTag(p,"end");if(p.isError(b))return b;const j=v.decode(p,"der",x);if(p.isError(j)&&b)break;y.push(j)}return y},h.prototype._decodeStr=function(p,g){if(g==="bitstr"){const v=p.readUInt8();return p.isError(v)?v:{unused:v,data:p.raw()}}if(g==="bmpstr"){const v=p.raw();if(v.length%2==1)return p.error("Decoding of string type: bmpstr length mismatch");let x="";for(let y=0;y<v.length/2;y++)x+=String.fromCharCode(v.readUInt16BE(2*y));return x}if(g==="numstr"){const v=p.raw().toString("ascii");return this._isNumstr(v)?v:p.error("Decoding of string type: numstr unsupported characters")}if(g==="octstr"||g==="objDesc")return p.raw();if(g==="printstr"){const v=p.raw().toString("ascii");return this._isPrintstr(v)?v:p.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(g)?p.raw().toString():p.error("Decoding of string type: "+g+" unsupported")},h.prototype._decodeObjid=function(p,g,v){let x;const y=[];let b=0,j=0;for(;!p.isEmpty();)j=p.readUInt8(),b<<=7,b|=127&j,!(128&j)&&(y.push(b),b=0);128&j&&y.push(b);const T=y[0]/40|0,O=y[0]%40;if(x=v?y:[T,O].concat(y.slice(1)),g){let R=g[x.join(" ")];R===void 0&&(R=g[x.join(".")]),R!==void 0&&(x=R)}return x},h.prototype._decodeTime=function(p,g){const v=p.raw().toString();let x,y,b,j,T,O;if(g==="gentime")x=0|v.slice(0,4),y=0|v.slice(4,6),b=0|v.slice(6,8),j=0|v.slice(8,10),T=0|v.slice(10,12),O=0|v.slice(12,14);else{if(g!=="utctime")return p.error("Decoding "+g+" time is not supported yet");x=0|v.slice(0,2),y=0|v.slice(2,4),b=0|v.slice(4,6),j=0|v.slice(6,8),T=0|v.slice(8,10),O=0|v.slice(10,12),x=x<70?2e3+x:1900+x}return Date.UTC(x,y-1,b,j,T,O,0)},h.prototype._decodeNull=function(){return null},h.prototype._decodeBool=function(p){const g=p.readUInt8();return p.isError(g)?g:g!==0},h.prototype._decodeInt=function(p,g){const v=p.raw();let x=new o(v);return g&&(x=g[x.toString(10)]||x),x},h.prototype._use=function(p,g){return typeof p=="function"&&(p=p(g)),p._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(r,s,a){const i=a;i.der=r("./der"),i.pem=r("./pem")},{"./der":178,"./pem":180}],180:[function(r,s,a){const i=r("inherits"),o=r("safer-buffer").Buffer,c=r("./der");function d(l){c.call(this,l),this.enc="pem"}i(d,c),s.exports=d,d.prototype.decode=function(l,u){const h=l.toString().split(/[\r\n]+/g),f=u.label.toUpperCase(),m=/^-----(BEGIN|END) ([^-]+)-----$/;let p=-1,g=-1;for(let y=0;y<h.length;y++){const b=h[y].match(m);if(b!==null&&b[2]===f){if(p!==-1){if(b[1]!=="END")break;g=y;break}if(b[1]!=="BEGIN")break;p=y}}if(p===-1||g===-1)throw new Error("PEM section not found for: "+f);const v=h.slice(p+1,g).join("");v.replace(/[^a-z0-9+/=]+/gi,"");const x=o.from(v,"base64");return c.prototype.decode.call(this,x,u)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(r,s,a){const i=r("inherits"),o=r("safer-buffer").Buffer,c=r("../base/node"),d=r("../constants/der");function l(f){this.enc="der",this.name=f.name,this.entity=f,this.tree=new u,this.tree._init(f.body)}function u(f){c.call(this,"der",f)}function h(f){return f<10?"0"+f:f}s.exports=l,l.prototype.encode=function(f,m){return this.tree._encode(f,m).join()},i(u,c),u.prototype._encodeComposite=function(f,m,p,g){const v=function(b,j,T,O){let R;if(b==="seqof"?b="seq":b==="setof"&&(b="set"),d.tagByName.hasOwnProperty(b))R=d.tagByName[b];else{if(typeof b!="number"||(0|b)!==b)return O.error("Unknown tag: "+b);R=b}return R>=31?O.error("Multi-octet tag encoding unsupported"):(j||(R|=32),R|=d.tagClassByName[T||"universal"]<<6,R)}(f,m,p,this.reporter);if(g.length<128){const b=o.alloc(2);return b[0]=v,b[1]=g.length,this._createEncoderBuffer([b,g])}let x=1;for(let b=g.length;b>=256;b>>=8)x++;const y=o.alloc(2+x);y[0]=v,y[1]=128|x;for(let b=1+x,j=g.length;j>0;b--,j>>=8)y[b]=255&j;return this._createEncoderBuffer([y,g])},u.prototype._encodeStr=function(f,m){if(m==="bitstr")return this._createEncoderBuffer([0|f.unused,f.data]);if(m==="bmpstr"){const p=o.alloc(2*f.length);for(let g=0;g<f.length;g++)p.writeUInt16BE(f.charCodeAt(g),2*g);return this._createEncoderBuffer(p)}return m==="numstr"?this._isNumstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: numstr supports only digits and space"):m==="printstr"?this._isPrintstr(f)?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(m)||m==="objDesc"?this._createEncoderBuffer(f):this.reporter.error("Encoding of string type: "+m+" unsupported")},u.prototype._encodeObjid=function(f,m,p){if(typeof f=="string"){if(!m)return this.reporter.error("string objid given, but no values map found");if(!m.hasOwnProperty(f))return this.reporter.error("objid not found in values map");f=m[f].split(/[\s.]+/g);for(let y=0;y<f.length;y++)f[y]|=0}else if(Array.isArray(f)){f=f.slice();for(let y=0;y<f.length;y++)f[y]|=0}if(!Array.isArray(f))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(f));if(!p){if(f[1]>=40)return this.reporter.error("Second objid identifier OOB");f.splice(0,2,40*f[0]+f[1])}let g=0;for(let y=0;y<f.length;y++){let b=f[y];for(g++;b>=128;b>>=7)g++}const v=o.alloc(g);let x=v.length-1;for(let y=f.length-1;y>=0;y--){let b=f[y];for(v[x--]=127&b;(b>>=7)>0;)v[x--]=128|127&b}return this._createEncoderBuffer(v)},u.prototype._encodeTime=function(f,m){let p;const g=new Date(f);return m==="gentime"?p=[h(g.getUTCFullYear()),h(g.getUTCMonth()+1),h(g.getUTCDate()),h(g.getUTCHours()),h(g.getUTCMinutes()),h(g.getUTCSeconds()),"Z"].join(""):m==="utctime"?p=[h(g.getUTCFullYear()%100),h(g.getUTCMonth()+1),h(g.getUTCDate()),h(g.getUTCHours()),h(g.getUTCMinutes()),h(g.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+m+" time is not supported yet"),this._encodeStr(p,"octstr")},u.prototype._encodeNull=function(){return this._createEncoderBuffer("")},u.prototype._encodeInt=function(f,m){if(typeof f=="string"){if(!m)return this.reporter.error("String int or enum given, but no values map");if(!m.hasOwnProperty(f))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(f));f=m[f]}if(typeof f!="number"&&!o.isBuffer(f)){const v=f.toArray();!f.sign&&128&v[0]&&v.unshift(0),f=o.from(v)}if(o.isBuffer(f)){let v=f.length;f.length===0&&v++;const x=o.alloc(v);return f.copy(x),f.length===0&&(x[0]=0),this._createEncoderBuffer(x)}if(f<128)return this._createEncoderBuffer(f);if(f<256)return this._createEncoderBuffer([0,f]);let p=1;for(let v=f;v>=256;v>>=8)p++;const g=new Array(p);for(let v=g.length-1;v>=0;v--)g[v]=255&f,f>>=8;return 128&g[0]&&g.unshift(0),this._createEncoderBuffer(o.from(g))},u.prototype._encodeBool=function(f){return this._createEncoderBuffer(f?255:0)},u.prototype._use=function(f,m){return typeof f=="function"&&(f=f(m)),f._getEncoder("der").tree},u.prototype._skipDefault=function(f,m,p){const g=this._baseState;let v;if(g.default===null)return!1;const x=f.join();if(g.defaultBuffer===void 0&&(g.defaultBuffer=this._encodeValue(g.default,m,p).join()),x.length!==g.defaultBuffer.length)return!1;for(v=0;v<x.length;v++)if(x[v]!==g.defaultBuffer[v])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(r,s,a){const i=a;i.der=r("./der"),i.pem=r("./pem")},{"./der":181,"./pem":183}],183:[function(r,s,a){const i=r("inherits"),o=r("./der");function c(d){o.call(this,d),this.enc="pem"}i(c,o),s.exports=c,c.prototype.encode=function(d,l){const u=o.prototype.encode.call(this,d).toString("base64"),h=["-----BEGIN "+l.label+"-----"];for(let f=0;f<u.length;f+=64)h.push(u.slice(f,f+64));return h.push("-----END "+l.label+"-----"),h.join(`
`)}},{"./der":181,inherits:440}],184:[function(r,s,a){(function(i,o){function c(M,F){if(!M)throw new Error(F||"Assertion failed")}function d(M,F){M.super_=F;var S=function(){};S.prototype=F.prototype,M.prototype=new S,M.prototype.constructor=M}function l(M,F,S){if(l.isBN(M))return M;this.negative=0,this.words=null,this.length=0,this.red=null,M!==null&&(F!=="le"&&F!=="be"||(S=F,F=10),this._init(M||0,F||10,S||"be"))}var u;typeof i=="object"?i.exports=l:(void 0).BN=l,l.BN=l,l.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:r("buffer").Buffer}catch{}function h(M,F){var S=M.charCodeAt(F);return S>=65&&S<=70?S-55:S>=97&&S<=102?S-87:S-48&15}function f(M,F,S){var E=h(M,S);return S-1>=F&&(E|=h(M,S-1)<<4),E}function m(M,F,S,E){for(var N=0,C=Math.min(M.length,S),k=F;k<C;k++){var I=M.charCodeAt(k)-48;N*=E,N+=I>=49?I-49+10:I>=17?I-17+10:I}return N}l.isBN=function(M){return M instanceof l||M!==null&&typeof M=="object"&&M.constructor.wordSize===l.wordSize&&Array.isArray(M.words)},l.max=function(M,F){return M.cmp(F)>0?M:F},l.min=function(M,F){return M.cmp(F)<0?M:F},l.prototype._init=function(M,F,S){if(typeof M=="number")return this._initNumber(M,F,S);if(typeof M=="object")return this._initArray(M,F,S);F==="hex"&&(F=16),c(F===(0|F)&&F>=2&&F<=36);var E=0;(M=M.toString().replace(/\s+/g,""))[0]==="-"&&(E++,this.negative=1),E<M.length&&(F===16?this._parseHex(M,E,S):(this._parseBase(M,F,E),S==="le"&&this._initArray(this.toArray(),F,S)))},l.prototype._initNumber=function(M,F,S){M<0&&(this.negative=1,M=-M),M<67108864?(this.words=[67108863&M],this.length=1):M<4503599627370496?(this.words=[67108863&M,M/67108864&67108863],this.length=2):(c(M<9007199254740992),this.words=[67108863&M,M/67108864&67108863,1],this.length=3),S==="le"&&this._initArray(this.toArray(),F,S)},l.prototype._initArray=function(M,F,S){if(c(typeof M.length=="number"),M.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(M.length/3),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var N,C,k=0;if(S==="be")for(E=M.length-1,N=0;E>=0;E-=3)C=M[E]|M[E-1]<<8|M[E-2]<<16,this.words[N]|=C<<k&67108863,this.words[N+1]=C>>>26-k&67108863,(k+=24)>=26&&(k-=26,N++);else if(S==="le")for(E=0,N=0;E<M.length;E+=3)C=M[E]|M[E+1]<<8|M[E+2]<<16,this.words[N]|=C<<k&67108863,this.words[N+1]=C>>>26-k&67108863,(k+=24)>=26&&(k-=26,N++);return this.strip()},l.prototype._parseHex=function(M,F,S){this.length=Math.ceil((M.length-F)/6),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var N,C=0,k=0;if(S==="be")for(E=M.length-1;E>=F;E-=2)N=f(M,F,E)<<C,this.words[k]|=67108863&N,C>=18?(C-=18,k+=1,this.words[k]|=N>>>26):C+=8;else for(E=(M.length-F)%2==0?F+1:F;E<M.length;E+=2)N=f(M,F,E)<<C,this.words[k]|=67108863&N,C>=18?(C-=18,k+=1,this.words[k]|=N>>>26):C+=8;this.strip()},l.prototype._parseBase=function(M,F,S){this.words=[0],this.length=1;for(var E=0,N=1;N<=67108863;N*=F)E++;E--,N=N/F|0;for(var C=M.length-S,k=C%E,I=Math.min(C,C-k)+S,U=0,$=S;$<I;$+=E)U=m(M,$,$+E,F),this.imuln(N),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U);if(k!==0){var Y=1;for(U=m(M,$,M.length,F),$=0;$<k;$++)Y*=F;this.imuln(Y),this.words[0]+U<67108864?this.words[0]+=U:this._iaddn(U)}this.strip()},l.prototype.copy=function(M){M.words=new Array(this.length);for(var F=0;F<this.length;F++)M.words[F]=this.words[F];M.length=this.length,M.negative=this.negative,M.red=this.red},l.prototype.clone=function(){var M=new l(null);return this.copy(M),M},l.prototype._expand=function(M){for(;this.length<M;)this.words[this.length++]=0;return this},l.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},l.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},l.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],v=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function x(M,F,S){S.negative=F.negative^M.negative;var E=M.length+F.length|0;S.length=E,E=E-1|0;var N=0|M.words[0],C=0|F.words[0],k=N*C,I=67108863&k,U=k/67108864|0;S.words[0]=I;for(var $=1;$<E;$++){for(var Y=U>>>26,Z=67108863&U,re=Math.min($,F.length-1),G=Math.max(0,$-M.length+1);G<=re;G++){var J=$-G|0;Y+=(k=(N=0|M.words[J])*(C=0|F.words[G])+Z)/67108864|0,Z=67108863&k}S.words[$]=0|Z,U=0|Y}return U!==0?S.words[$]=0|U:S.length--,S.strip()}l.prototype.toString=function(M,F){var S;if(F=0|F||1,(M=M||10)===16||M==="hex"){S="";for(var E=0,N=0,C=0;C<this.length;C++){var k=this.words[C],I=(16777215&(k<<E|N)).toString(16);S=(N=k>>>24-E&16777215)!==0||C!==this.length-1?p[6-I.length]+I+S:I+S,(E+=2)>=26&&(E-=26,C--)}for(N!==0&&(S=N.toString(16)+S);S.length%F!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}if(M===(0|M)&&M>=2&&M<=36){var U=g[M],$=v[M];S="";var Y=this.clone();for(Y.negative=0;!Y.isZero();){var Z=Y.modn($).toString(M);S=(Y=Y.idivn($)).isZero()?Z+S:p[U-Z.length]+Z+S}for(this.isZero()&&(S="0"+S);S.length%F!=0;)S="0"+S;return this.negative!==0&&(S="-"+S),S}c(!1,"Base should be between 2 and 36")},l.prototype.toNumber=function(){var M=this.words[0];return this.length===2?M+=67108864*this.words[1]:this.length===3&&this.words[2]===1?M+=4503599627370496+67108864*this.words[1]:this.length>2&&c(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-M:M},l.prototype.toJSON=function(){return this.toString(16)},l.prototype.toBuffer=function(M,F){return c(u!==void 0),this.toArrayLike(u,M,F)},l.prototype.toArray=function(M,F){return this.toArrayLike(Array,M,F)},l.prototype.toArrayLike=function(M,F,S){var E=this.byteLength(),N=S||Math.max(1,E);c(E<=N,"byte array longer than desired length"),c(N>0,"Requested array length <= 0"),this.strip();var C,k,I=F==="le",U=new M(N),$=this.clone();if(I){for(k=0;!$.isZero();k++)C=$.andln(255),$.iushrn(8),U[k]=C;for(;k<N;k++)U[k]=0}else{for(k=0;k<N-E;k++)U[k]=0;for(k=0;!$.isZero();k++)C=$.andln(255),$.iushrn(8),U[N-k-1]=C}return U},Math.clz32?l.prototype._countBits=function(M){return 32-Math.clz32(M)}:l.prototype._countBits=function(M){var F=M,S=0;return F>=4096&&(S+=13,F>>>=13),F>=64&&(S+=7,F>>>=7),F>=8&&(S+=4,F>>>=4),F>=2&&(S+=2,F>>>=2),S+F},l.prototype._zeroBits=function(M){if(M===0)return 26;var F=M,S=0;return!(8191&F)&&(S+=13,F>>>=13),!(127&F)&&(S+=7,F>>>=7),!(15&F)&&(S+=4,F>>>=4),!(3&F)&&(S+=2,F>>>=2),!(1&F)&&S++,S},l.prototype.bitLength=function(){var M=this.words[this.length-1],F=this._countBits(M);return 26*(this.length-1)+F},l.prototype.zeroBits=function(){if(this.isZero())return 0;for(var M=0,F=0;F<this.length;F++){var S=this._zeroBits(this.words[F]);if(M+=S,S!==26)break}return M},l.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},l.prototype.toTwos=function(M){return this.negative!==0?this.abs().inotn(M).iaddn(1):this.clone()},l.prototype.fromTwos=function(M){return this.testn(M-1)?this.notn(M).iaddn(1).ineg():this.clone()},l.prototype.isNeg=function(){return this.negative!==0},l.prototype.neg=function(){return this.clone().ineg()},l.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},l.prototype.iuor=function(M){for(;this.length<M.length;)this.words[this.length++]=0;for(var F=0;F<M.length;F++)this.words[F]=this.words[F]|M.words[F];return this.strip()},l.prototype.ior=function(M){return c((this.negative|M.negative)==0),this.iuor(M)},l.prototype.or=function(M){return this.length>M.length?this.clone().ior(M):M.clone().ior(this)},l.prototype.uor=function(M){return this.length>M.length?this.clone().iuor(M):M.clone().iuor(this)},l.prototype.iuand=function(M){var F;F=this.length>M.length?M:this;for(var S=0;S<F.length;S++)this.words[S]=this.words[S]&M.words[S];return this.length=F.length,this.strip()},l.prototype.iand=function(M){return c((this.negative|M.negative)==0),this.iuand(M)},l.prototype.and=function(M){return this.length>M.length?this.clone().iand(M):M.clone().iand(this)},l.prototype.uand=function(M){return this.length>M.length?this.clone().iuand(M):M.clone().iuand(this)},l.prototype.iuxor=function(M){var F,S;this.length>M.length?(F=this,S=M):(F=M,S=this);for(var E=0;E<S.length;E++)this.words[E]=F.words[E]^S.words[E];if(this!==F)for(;E<F.length;E++)this.words[E]=F.words[E];return this.length=F.length,this.strip()},l.prototype.ixor=function(M){return c((this.negative|M.negative)==0),this.iuxor(M)},l.prototype.xor=function(M){return this.length>M.length?this.clone().ixor(M):M.clone().ixor(this)},l.prototype.uxor=function(M){return this.length>M.length?this.clone().iuxor(M):M.clone().iuxor(this)},l.prototype.inotn=function(M){c(typeof M=="number"&&M>=0);var F=0|Math.ceil(M/26),S=M%26;this._expand(F),S>0&&F--;for(var E=0;E<F;E++)this.words[E]=67108863&~this.words[E];return S>0&&(this.words[E]=~this.words[E]&67108863>>26-S),this.strip()},l.prototype.notn=function(M){return this.clone().inotn(M)},l.prototype.setn=function(M,F){c(typeof M=="number"&&M>=0);var S=M/26|0,E=M%26;return this._expand(S+1),this.words[S]=F?this.words[S]|1<<E:this.words[S]&~(1<<E),this.strip()},l.prototype.iadd=function(M){var F,S,E;if(this.negative!==0&&M.negative===0)return this.negative=0,F=this.isub(M),this.negative^=1,this._normSign();if(this.negative===0&&M.negative!==0)return M.negative=0,F=this.isub(M),M.negative=1,F._normSign();this.length>M.length?(S=this,E=M):(S=M,E=this);for(var N=0,C=0;C<E.length;C++)F=(0|S.words[C])+(0|E.words[C])+N,this.words[C]=67108863&F,N=F>>>26;for(;N!==0&&C<S.length;C++)F=(0|S.words[C])+N,this.words[C]=67108863&F,N=F>>>26;if(this.length=S.length,N!==0)this.words[this.length]=N,this.length++;else if(S!==this)for(;C<S.length;C++)this.words[C]=S.words[C];return this},l.prototype.add=function(M){var F;return M.negative!==0&&this.negative===0?(M.negative=0,F=this.sub(M),M.negative^=1,F):M.negative===0&&this.negative!==0?(this.negative=0,F=M.sub(this),this.negative=1,F):this.length>M.length?this.clone().iadd(M):M.clone().iadd(this)},l.prototype.isub=function(M){if(M.negative!==0){M.negative=0;var F=this.iadd(M);return M.negative=1,F._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(M),this.negative=1,this._normSign();var S,E,N=this.cmp(M);if(N===0)return this.negative=0,this.length=1,this.words[0]=0,this;N>0?(S=this,E=M):(S=M,E=this);for(var C=0,k=0;k<E.length;k++)C=(F=(0|S.words[k])-(0|E.words[k])+C)>>26,this.words[k]=67108863&F;for(;C!==0&&k<S.length;k++)C=(F=(0|S.words[k])+C)>>26,this.words[k]=67108863&F;if(C===0&&k<S.length&&S!==this)for(;k<S.length;k++)this.words[k]=S.words[k];return this.length=Math.max(this.length,k),S!==this&&(this.negative=1),this.strip()},l.prototype.sub=function(M){return this.clone().isub(M)};var y=function(M,F,S){var E,N,C,k=M.words,I=F.words,U=S.words,$=0,Y=0|k[0],Z=8191&Y,re=Y>>>13,G=0|k[1],J=8191&G,V=G>>>13,W=0|k[2],ee=8191&W,ie=W>>>13,oe=0|k[3],se=8191&oe,le=oe>>>13,ye=0|k[4],ue=8191&ye,ne=ye>>>13,pe=0|k[5],ge=8191&pe,Ne=pe>>>13,_e=0|k[6],be=8191&_e,Me=_e>>>13,Se=0|k[7],$e=8191&Se,Ke=Se>>>13,Ze=0|k[8],it=8191&Ze,Re=Ze>>>13,ot=0|k[9],ut=8191&ot,bt=ot>>>13,Je=0|I[0],Ce=8191&Je,Ge=Je>>>13,Pe=0|I[1],Ve=8191&Pe,st=Pe>>>13,xt=0|I[2],fe=8191&xt,Ie=xt>>>13,tt=0|I[3],lt=8191&tt,It=tt>>>13,ct=0|I[4],at=8191&ct,gt=ct>>>13,Yt=0|I[5],St=8191&Yt,rt=Yt>>>13,ir=0|I[6],Ct=8191&ir,Te=ir>>>13,qe=0|I[7],ht=8191&qe,Pt=qe>>>13,vt=0|I[8],Dt=8191&vt,_r=vt>>>13,sr=0|I[9],or=8191&sr,jr=sr>>>13;S.negative=M.negative^F.negative,S.length=19;var br=($+(E=Math.imul(Z,Ce))|0)+((8191&(N=(N=Math.imul(Z,Ge))+Math.imul(re,Ce)|0))<<13)|0;$=((C=Math.imul(re,Ge))+(N>>>13)|0)+(br>>>26)|0,br&=67108863,E=Math.imul(J,Ce),N=(N=Math.imul(J,Ge))+Math.imul(V,Ce)|0,C=Math.imul(V,Ge);var Nr=($+(E=E+Math.imul(Z,Ve)|0)|0)+((8191&(N=(N=N+Math.imul(Z,st)|0)+Math.imul(re,Ve)|0))<<13)|0;$=((C=C+Math.imul(re,st)|0)+(N>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,E=Math.imul(ee,Ce),N=(N=Math.imul(ee,Ge))+Math.imul(ie,Ce)|0,C=Math.imul(ie,Ge),E=E+Math.imul(J,Ve)|0,N=(N=N+Math.imul(J,st)|0)+Math.imul(V,Ve)|0,C=C+Math.imul(V,st)|0;var et=($+(E=E+Math.imul(Z,fe)|0)|0)+((8191&(N=(N=N+Math.imul(Z,Ie)|0)+Math.imul(re,fe)|0))<<13)|0;$=((C=C+Math.imul(re,Ie)|0)+(N>>>13)|0)+(et>>>26)|0,et&=67108863,E=Math.imul(se,Ce),N=(N=Math.imul(se,Ge))+Math.imul(le,Ce)|0,C=Math.imul(le,Ge),E=E+Math.imul(ee,Ve)|0,N=(N=N+Math.imul(ee,st)|0)+Math.imul(ie,Ve)|0,C=C+Math.imul(ie,st)|0,E=E+Math.imul(J,fe)|0,N=(N=N+Math.imul(J,Ie)|0)+Math.imul(V,fe)|0,C=C+Math.imul(V,Ie)|0;var Tt=($+(E=E+Math.imul(Z,lt)|0)|0)+((8191&(N=(N=N+Math.imul(Z,It)|0)+Math.imul(re,lt)|0))<<13)|0;$=((C=C+Math.imul(re,It)|0)+(N>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,E=Math.imul(ue,Ce),N=(N=Math.imul(ue,Ge))+Math.imul(ne,Ce)|0,C=Math.imul(ne,Ge),E=E+Math.imul(se,Ve)|0,N=(N=N+Math.imul(se,st)|0)+Math.imul(le,Ve)|0,C=C+Math.imul(le,st)|0,E=E+Math.imul(ee,fe)|0,N=(N=N+Math.imul(ee,Ie)|0)+Math.imul(ie,fe)|0,C=C+Math.imul(ie,Ie)|0,E=E+Math.imul(J,lt)|0,N=(N=N+Math.imul(J,It)|0)+Math.imul(V,lt)|0,C=C+Math.imul(V,It)|0;var rr=($+(E=E+Math.imul(Z,at)|0)|0)+((8191&(N=(N=N+Math.imul(Z,gt)|0)+Math.imul(re,at)|0))<<13)|0;$=((C=C+Math.imul(re,gt)|0)+(N>>>13)|0)+(rr>>>26)|0,rr&=67108863,E=Math.imul(ge,Ce),N=(N=Math.imul(ge,Ge))+Math.imul(Ne,Ce)|0,C=Math.imul(Ne,Ge),E=E+Math.imul(ue,Ve)|0,N=(N=N+Math.imul(ue,st)|0)+Math.imul(ne,Ve)|0,C=C+Math.imul(ne,st)|0,E=E+Math.imul(se,fe)|0,N=(N=N+Math.imul(se,Ie)|0)+Math.imul(le,fe)|0,C=C+Math.imul(le,Ie)|0,E=E+Math.imul(ee,lt)|0,N=(N=N+Math.imul(ee,It)|0)+Math.imul(ie,lt)|0,C=C+Math.imul(ie,It)|0,E=E+Math.imul(J,at)|0,N=(N=N+Math.imul(J,gt)|0)+Math.imul(V,at)|0,C=C+Math.imul(V,gt)|0;var nr=($+(E=E+Math.imul(Z,St)|0)|0)+((8191&(N=(N=N+Math.imul(Z,rt)|0)+Math.imul(re,St)|0))<<13)|0;$=((C=C+Math.imul(re,rt)|0)+(N>>>13)|0)+(nr>>>26)|0,nr&=67108863,E=Math.imul(be,Ce),N=(N=Math.imul(be,Ge))+Math.imul(Me,Ce)|0,C=Math.imul(Me,Ge),E=E+Math.imul(ge,Ve)|0,N=(N=N+Math.imul(ge,st)|0)+Math.imul(Ne,Ve)|0,C=C+Math.imul(Ne,st)|0,E=E+Math.imul(ue,fe)|0,N=(N=N+Math.imul(ue,Ie)|0)+Math.imul(ne,fe)|0,C=C+Math.imul(ne,Ie)|0,E=E+Math.imul(se,lt)|0,N=(N=N+Math.imul(se,It)|0)+Math.imul(le,lt)|0,C=C+Math.imul(le,It)|0,E=E+Math.imul(ee,at)|0,N=(N=N+Math.imul(ee,gt)|0)+Math.imul(ie,at)|0,C=C+Math.imul(ie,gt)|0,E=E+Math.imul(J,St)|0,N=(N=N+Math.imul(J,rt)|0)+Math.imul(V,St)|0,C=C+Math.imul(V,rt)|0;var Qt=($+(E=E+Math.imul(Z,Ct)|0)|0)+((8191&(N=(N=N+Math.imul(Z,Te)|0)+Math.imul(re,Ct)|0))<<13)|0;$=((C=C+Math.imul(re,Te)|0)+(N>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,E=Math.imul($e,Ce),N=(N=Math.imul($e,Ge))+Math.imul(Ke,Ce)|0,C=Math.imul(Ke,Ge),E=E+Math.imul(be,Ve)|0,N=(N=N+Math.imul(be,st)|0)+Math.imul(Me,Ve)|0,C=C+Math.imul(Me,st)|0,E=E+Math.imul(ge,fe)|0,N=(N=N+Math.imul(ge,Ie)|0)+Math.imul(Ne,fe)|0,C=C+Math.imul(Ne,Ie)|0,E=E+Math.imul(ue,lt)|0,N=(N=N+Math.imul(ue,It)|0)+Math.imul(ne,lt)|0,C=C+Math.imul(ne,It)|0,E=E+Math.imul(se,at)|0,N=(N=N+Math.imul(se,gt)|0)+Math.imul(le,at)|0,C=C+Math.imul(le,gt)|0,E=E+Math.imul(ee,St)|0,N=(N=N+Math.imul(ee,rt)|0)+Math.imul(ie,St)|0,C=C+Math.imul(ie,rt)|0,E=E+Math.imul(J,Ct)|0,N=(N=N+Math.imul(J,Te)|0)+Math.imul(V,Ct)|0,C=C+Math.imul(V,Te)|0;var Ee=($+(E=E+Math.imul(Z,ht)|0)|0)+((8191&(N=(N=N+Math.imul(Z,Pt)|0)+Math.imul(re,ht)|0))<<13)|0;$=((C=C+Math.imul(re,Pt)|0)+(N>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,E=Math.imul(it,Ce),N=(N=Math.imul(it,Ge))+Math.imul(Re,Ce)|0,C=Math.imul(Re,Ge),E=E+Math.imul($e,Ve)|0,N=(N=N+Math.imul($e,st)|0)+Math.imul(Ke,Ve)|0,C=C+Math.imul(Ke,st)|0,E=E+Math.imul(be,fe)|0,N=(N=N+Math.imul(be,Ie)|0)+Math.imul(Me,fe)|0,C=C+Math.imul(Me,Ie)|0,E=E+Math.imul(ge,lt)|0,N=(N=N+Math.imul(ge,It)|0)+Math.imul(Ne,lt)|0,C=C+Math.imul(Ne,It)|0,E=E+Math.imul(ue,at)|0,N=(N=N+Math.imul(ue,gt)|0)+Math.imul(ne,at)|0,C=C+Math.imul(ne,gt)|0,E=E+Math.imul(se,St)|0,N=(N=N+Math.imul(se,rt)|0)+Math.imul(le,St)|0,C=C+Math.imul(le,rt)|0,E=E+Math.imul(ee,Ct)|0,N=(N=N+Math.imul(ee,Te)|0)+Math.imul(ie,Ct)|0,C=C+Math.imul(ie,Te)|0,E=E+Math.imul(J,ht)|0,N=(N=N+Math.imul(J,Pt)|0)+Math.imul(V,ht)|0,C=C+Math.imul(V,Pt)|0;var Xe=($+(E=E+Math.imul(Z,Dt)|0)|0)+((8191&(N=(N=N+Math.imul(Z,_r)|0)+Math.imul(re,Dt)|0))<<13)|0;$=((C=C+Math.imul(re,_r)|0)+(N>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,E=Math.imul(ut,Ce),N=(N=Math.imul(ut,Ge))+Math.imul(bt,Ce)|0,C=Math.imul(bt,Ge),E=E+Math.imul(it,Ve)|0,N=(N=N+Math.imul(it,st)|0)+Math.imul(Re,Ve)|0,C=C+Math.imul(Re,st)|0,E=E+Math.imul($e,fe)|0,N=(N=N+Math.imul($e,Ie)|0)+Math.imul(Ke,fe)|0,C=C+Math.imul(Ke,Ie)|0,E=E+Math.imul(be,lt)|0,N=(N=N+Math.imul(be,It)|0)+Math.imul(Me,lt)|0,C=C+Math.imul(Me,It)|0,E=E+Math.imul(ge,at)|0,N=(N=N+Math.imul(ge,gt)|0)+Math.imul(Ne,at)|0,C=C+Math.imul(Ne,gt)|0,E=E+Math.imul(ue,St)|0,N=(N=N+Math.imul(ue,rt)|0)+Math.imul(ne,St)|0,C=C+Math.imul(ne,rt)|0,E=E+Math.imul(se,Ct)|0,N=(N=N+Math.imul(se,Te)|0)+Math.imul(le,Ct)|0,C=C+Math.imul(le,Te)|0,E=E+Math.imul(ee,ht)|0,N=(N=N+Math.imul(ee,Pt)|0)+Math.imul(ie,ht)|0,C=C+Math.imul(ie,Pt)|0,E=E+Math.imul(J,Dt)|0,N=(N=N+Math.imul(J,_r)|0)+Math.imul(V,Dt)|0,C=C+Math.imul(V,_r)|0;var dt=($+(E=E+Math.imul(Z,or)|0)|0)+((8191&(N=(N=N+Math.imul(Z,jr)|0)+Math.imul(re,or)|0))<<13)|0;$=((C=C+Math.imul(re,jr)|0)+(N>>>13)|0)+(dt>>>26)|0,dt&=67108863,E=Math.imul(ut,Ve),N=(N=Math.imul(ut,st))+Math.imul(bt,Ve)|0,C=Math.imul(bt,st),E=E+Math.imul(it,fe)|0,N=(N=N+Math.imul(it,Ie)|0)+Math.imul(Re,fe)|0,C=C+Math.imul(Re,Ie)|0,E=E+Math.imul($e,lt)|0,N=(N=N+Math.imul($e,It)|0)+Math.imul(Ke,lt)|0,C=C+Math.imul(Ke,It)|0,E=E+Math.imul(be,at)|0,N=(N=N+Math.imul(be,gt)|0)+Math.imul(Me,at)|0,C=C+Math.imul(Me,gt)|0,E=E+Math.imul(ge,St)|0,N=(N=N+Math.imul(ge,rt)|0)+Math.imul(Ne,St)|0,C=C+Math.imul(Ne,rt)|0,E=E+Math.imul(ue,Ct)|0,N=(N=N+Math.imul(ue,Te)|0)+Math.imul(ne,Ct)|0,C=C+Math.imul(ne,Te)|0,E=E+Math.imul(se,ht)|0,N=(N=N+Math.imul(se,Pt)|0)+Math.imul(le,ht)|0,C=C+Math.imul(le,Pt)|0,E=E+Math.imul(ee,Dt)|0,N=(N=N+Math.imul(ee,_r)|0)+Math.imul(ie,Dt)|0,C=C+Math.imul(ie,_r)|0;var Fe=($+(E=E+Math.imul(J,or)|0)|0)+((8191&(N=(N=N+Math.imul(J,jr)|0)+Math.imul(V,or)|0))<<13)|0;$=((C=C+Math.imul(V,jr)|0)+(N>>>13)|0)+(Fe>>>26)|0,Fe&=67108863,E=Math.imul(ut,fe),N=(N=Math.imul(ut,Ie))+Math.imul(bt,fe)|0,C=Math.imul(bt,Ie),E=E+Math.imul(it,lt)|0,N=(N=N+Math.imul(it,It)|0)+Math.imul(Re,lt)|0,C=C+Math.imul(Re,It)|0,E=E+Math.imul($e,at)|0,N=(N=N+Math.imul($e,gt)|0)+Math.imul(Ke,at)|0,C=C+Math.imul(Ke,gt)|0,E=E+Math.imul(be,St)|0,N=(N=N+Math.imul(be,rt)|0)+Math.imul(Me,St)|0,C=C+Math.imul(Me,rt)|0,E=E+Math.imul(ge,Ct)|0,N=(N=N+Math.imul(ge,Te)|0)+Math.imul(Ne,Ct)|0,C=C+Math.imul(Ne,Te)|0,E=E+Math.imul(ue,ht)|0,N=(N=N+Math.imul(ue,Pt)|0)+Math.imul(ne,ht)|0,C=C+Math.imul(ne,Pt)|0,E=E+Math.imul(se,Dt)|0,N=(N=N+Math.imul(se,_r)|0)+Math.imul(le,Dt)|0,C=C+Math.imul(le,_r)|0;var Zt=($+(E=E+Math.imul(ee,or)|0)|0)+((8191&(N=(N=N+Math.imul(ee,jr)|0)+Math.imul(ie,or)|0))<<13)|0;$=((C=C+Math.imul(ie,jr)|0)+(N>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,E=Math.imul(ut,lt),N=(N=Math.imul(ut,It))+Math.imul(bt,lt)|0,C=Math.imul(bt,It),E=E+Math.imul(it,at)|0,N=(N=N+Math.imul(it,gt)|0)+Math.imul(Re,at)|0,C=C+Math.imul(Re,gt)|0,E=E+Math.imul($e,St)|0,N=(N=N+Math.imul($e,rt)|0)+Math.imul(Ke,St)|0,C=C+Math.imul(Ke,rt)|0,E=E+Math.imul(be,Ct)|0,N=(N=N+Math.imul(be,Te)|0)+Math.imul(Me,Ct)|0,C=C+Math.imul(Me,Te)|0,E=E+Math.imul(ge,ht)|0,N=(N=N+Math.imul(ge,Pt)|0)+Math.imul(Ne,ht)|0,C=C+Math.imul(Ne,Pt)|0,E=E+Math.imul(ue,Dt)|0,N=(N=N+Math.imul(ue,_r)|0)+Math.imul(ne,Dt)|0,C=C+Math.imul(ne,_r)|0;var wt=($+(E=E+Math.imul(se,or)|0)|0)+((8191&(N=(N=N+Math.imul(se,jr)|0)+Math.imul(le,or)|0))<<13)|0;$=((C=C+Math.imul(le,jr)|0)+(N>>>13)|0)+(wt>>>26)|0,wt&=67108863,E=Math.imul(ut,at),N=(N=Math.imul(ut,gt))+Math.imul(bt,at)|0,C=Math.imul(bt,gt),E=E+Math.imul(it,St)|0,N=(N=N+Math.imul(it,rt)|0)+Math.imul(Re,St)|0,C=C+Math.imul(Re,rt)|0,E=E+Math.imul($e,Ct)|0,N=(N=N+Math.imul($e,Te)|0)+Math.imul(Ke,Ct)|0,C=C+Math.imul(Ke,Te)|0,E=E+Math.imul(be,ht)|0,N=(N=N+Math.imul(be,Pt)|0)+Math.imul(Me,ht)|0,C=C+Math.imul(Me,Pt)|0,E=E+Math.imul(ge,Dt)|0,N=(N=N+Math.imul(ge,_r)|0)+Math.imul(Ne,Dt)|0,C=C+Math.imul(Ne,_r)|0;var Et=($+(E=E+Math.imul(ue,or)|0)|0)+((8191&(N=(N=N+Math.imul(ue,jr)|0)+Math.imul(ne,or)|0))<<13)|0;$=((C=C+Math.imul(ne,jr)|0)+(N>>>13)|0)+(Et>>>26)|0,Et&=67108863,E=Math.imul(ut,St),N=(N=Math.imul(ut,rt))+Math.imul(bt,St)|0,C=Math.imul(bt,rt),E=E+Math.imul(it,Ct)|0,N=(N=N+Math.imul(it,Te)|0)+Math.imul(Re,Ct)|0,C=C+Math.imul(Re,Te)|0,E=E+Math.imul($e,ht)|0,N=(N=N+Math.imul($e,Pt)|0)+Math.imul(Ke,ht)|0,C=C+Math.imul(Ke,Pt)|0,E=E+Math.imul(be,Dt)|0,N=(N=N+Math.imul(be,_r)|0)+Math.imul(Me,Dt)|0,C=C+Math.imul(Me,_r)|0;var kr=($+(E=E+Math.imul(ge,or)|0)|0)+((8191&(N=(N=N+Math.imul(ge,jr)|0)+Math.imul(Ne,or)|0))<<13)|0;$=((C=C+Math.imul(Ne,jr)|0)+(N>>>13)|0)+(kr>>>26)|0,kr&=67108863,E=Math.imul(ut,Ct),N=(N=Math.imul(ut,Te))+Math.imul(bt,Ct)|0,C=Math.imul(bt,Te),E=E+Math.imul(it,ht)|0,N=(N=N+Math.imul(it,Pt)|0)+Math.imul(Re,ht)|0,C=C+Math.imul(Re,Pt)|0,E=E+Math.imul($e,Dt)|0,N=(N=N+Math.imul($e,_r)|0)+Math.imul(Ke,Dt)|0,C=C+Math.imul(Ke,_r)|0;var Jt=($+(E=E+Math.imul(be,or)|0)|0)+((8191&(N=(N=N+Math.imul(be,jr)|0)+Math.imul(Me,or)|0))<<13)|0;$=((C=C+Math.imul(Me,jr)|0)+(N>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,E=Math.imul(ut,ht),N=(N=Math.imul(ut,Pt))+Math.imul(bt,ht)|0,C=Math.imul(bt,Pt),E=E+Math.imul(it,Dt)|0,N=(N=N+Math.imul(it,_r)|0)+Math.imul(Re,Dt)|0,C=C+Math.imul(Re,_r)|0;var tr=($+(E=E+Math.imul($e,or)|0)|0)+((8191&(N=(N=N+Math.imul($e,jr)|0)+Math.imul(Ke,or)|0))<<13)|0;$=((C=C+Math.imul(Ke,jr)|0)+(N>>>13)|0)+(tr>>>26)|0,tr&=67108863,E=Math.imul(ut,Dt),N=(N=Math.imul(ut,_r))+Math.imul(bt,Dt)|0,C=Math.imul(bt,_r);var zt=($+(E=E+Math.imul(it,or)|0)|0)+((8191&(N=(N=N+Math.imul(it,jr)|0)+Math.imul(Re,or)|0))<<13)|0;$=((C=C+Math.imul(Re,jr)|0)+(N>>>13)|0)+(zt>>>26)|0,zt&=67108863;var vn=($+(E=Math.imul(ut,or))|0)+((8191&(N=(N=Math.imul(ut,jr))+Math.imul(bt,or)|0))<<13)|0;return $=((C=Math.imul(bt,jr))+(N>>>13)|0)+(vn>>>26)|0,vn&=67108863,U[0]=br,U[1]=Nr,U[2]=et,U[3]=Tt,U[4]=rr,U[5]=nr,U[6]=Qt,U[7]=Ee,U[8]=Xe,U[9]=dt,U[10]=Fe,U[11]=Zt,U[12]=wt,U[13]=Et,U[14]=kr,U[15]=Jt,U[16]=tr,U[17]=zt,U[18]=vn,$!==0&&(U[19]=$,S.length++),S};function b(M,F,S){return new j().mulp(M,F,S)}function j(M,F){this.x=M,this.y=F}Math.imul||(y=x),l.prototype.mulTo=function(M,F){var S=this.length+M.length;return this.length===10&&M.length===10?y(this,M,F):S<63?x(this,M,F):S<1024?function(E,N,C){C.negative=N.negative^E.negative,C.length=E.length+N.length;for(var k=0,I=0,U=0;U<C.length-1;U++){var $=I;I=0;for(var Y=67108863&k,Z=Math.min(U,N.length-1),re=Math.max(0,U-E.length+1);re<=Z;re++){var G=U-re,J=(0|E.words[G])*(0|N.words[re]),V=67108863&J;Y=67108863&(V=V+Y|0),I+=($=($=$+(J/67108864|0)|0)+(V>>>26)|0)>>>26,$&=67108863}C.words[U]=Y,k=$,$=I}return k!==0?C.words[U]=k:C.length--,C.strip()}(this,M,F):b(this,M,F)},j.prototype.makeRBT=function(M){for(var F=new Array(M),S=l.prototype._countBits(M)-1,E=0;E<M;E++)F[E]=this.revBin(E,S,M);return F},j.prototype.revBin=function(M,F,S){if(M===0||M===S-1)return M;for(var E=0,N=0;N<F;N++)E|=(1&M)<<F-N-1,M>>=1;return E},j.prototype.permute=function(M,F,S,E,N,C){for(var k=0;k<C;k++)E[k]=F[M[k]],N[k]=S[M[k]]},j.prototype.transform=function(M,F,S,E,N,C){this.permute(C,M,F,S,E,N);for(var k=1;k<N;k<<=1)for(var I=k<<1,U=Math.cos(2*Math.PI/I),$=Math.sin(2*Math.PI/I),Y=0;Y<N;Y+=I)for(var Z=U,re=$,G=0;G<k;G++){var J=S[Y+G],V=E[Y+G],W=S[Y+G+k],ee=E[Y+G+k],ie=Z*W-re*ee;ee=Z*ee+re*W,W=ie,S[Y+G]=J+W,E[Y+G]=V+ee,S[Y+G+k]=J-W,E[Y+G+k]=V-ee,G!==I&&(ie=U*Z-$*re,re=U*re+$*Z,Z=ie)}},j.prototype.guessLen13b=function(M,F){var S=1|Math.max(F,M),E=1&S,N=0;for(S=S/2|0;S;S>>>=1)N++;return 1<<N+1+E},j.prototype.conjugate=function(M,F,S){if(!(S<=1))for(var E=0;E<S/2;E++){var N=M[E];M[E]=M[S-E-1],M[S-E-1]=N,N=F[E],F[E]=-F[S-E-1],F[S-E-1]=-N}},j.prototype.normalize13b=function(M,F){for(var S=0,E=0;E<F/2;E++){var N=8192*Math.round(M[2*E+1]/F)+Math.round(M[2*E]/F)+S;M[E]=67108863&N,S=N<67108864?0:N/67108864|0}return M},j.prototype.convert13b=function(M,F,S,E){for(var N=0,C=0;C<F;C++)N+=0|M[C],S[2*C]=8191&N,N>>>=13,S[2*C+1]=8191&N,N>>>=13;for(C=2*F;C<E;++C)S[C]=0;c(N===0),c((-8192&N)==0)},j.prototype.stub=function(M){for(var F=new Array(M),S=0;S<M;S++)F[S]=0;return F},j.prototype.mulp=function(M,F,S){var E=2*this.guessLen13b(M.length,F.length),N=this.makeRBT(E),C=this.stub(E),k=new Array(E),I=new Array(E),U=new Array(E),$=new Array(E),Y=new Array(E),Z=new Array(E),re=S.words;re.length=E,this.convert13b(M.words,M.length,k,E),this.convert13b(F.words,F.length,$,E),this.transform(k,C,I,U,E,N),this.transform($,C,Y,Z,E,N);for(var G=0;G<E;G++){var J=I[G]*Y[G]-U[G]*Z[G];U[G]=I[G]*Z[G]+U[G]*Y[G],I[G]=J}return this.conjugate(I,U,E),this.transform(I,U,re,C,E,N),this.conjugate(re,C,E),this.normalize13b(re,E),S.negative=M.negative^F.negative,S.length=M.length+F.length,S.strip()},l.prototype.mul=function(M){var F=new l(null);return F.words=new Array(this.length+M.length),this.mulTo(M,F)},l.prototype.mulf=function(M){var F=new l(null);return F.words=new Array(this.length+M.length),b(this,M,F)},l.prototype.imul=function(M){return this.clone().mulTo(M,this)},l.prototype.imuln=function(M){c(typeof M=="number"),c(M<67108864);for(var F=0,S=0;S<this.length;S++){var E=(0|this.words[S])*M,N=(67108863&E)+(67108863&F);F>>=26,F+=E/67108864|0,F+=N>>>26,this.words[S]=67108863&N}return F!==0&&(this.words[S]=F,this.length++),this},l.prototype.muln=function(M){return this.clone().imuln(M)},l.prototype.sqr=function(){return this.mul(this)},l.prototype.isqr=function(){return this.imul(this.clone())},l.prototype.pow=function(M){var F=function(C){for(var k=new Array(C.bitLength()),I=0;I<k.length;I++){var U=I/26|0,$=I%26;k[I]=(C.words[U]&1<<$)>>>$}return k}(M);if(F.length===0)return new l(1);for(var S=this,E=0;E<F.length&&F[E]===0;E++,S=S.sqr());if(++E<F.length)for(var N=S.sqr();E<F.length;E++,N=N.sqr())F[E]!==0&&(S=S.mul(N));return S},l.prototype.iushln=function(M){c(typeof M=="number"&&M>=0);var F,S=M%26,E=(M-S)/26,N=67108863>>>26-S<<26-S;if(S!==0){var C=0;for(F=0;F<this.length;F++){var k=this.words[F]&N,I=(0|this.words[F])-k<<S;this.words[F]=I|C,C=k>>>26-S}C&&(this.words[F]=C,this.length++)}if(E!==0){for(F=this.length-1;F>=0;F--)this.words[F+E]=this.words[F];for(F=0;F<E;F++)this.words[F]=0;this.length+=E}return this.strip()},l.prototype.ishln=function(M){return c(this.negative===0),this.iushln(M)},l.prototype.iushrn=function(M,F,S){var E;c(typeof M=="number"&&M>=0),E=F?(F-F%26)/26:0;var N=M%26,C=Math.min((M-N)/26,this.length),k=67108863^67108863>>>N<<N,I=S;if(E-=C,E=Math.max(0,E),I){for(var U=0;U<C;U++)I.words[U]=this.words[U];I.length=C}if(C!==0)if(this.length>C)for(this.length-=C,U=0;U<this.length;U++)this.words[U]=this.words[U+C];else this.words[0]=0,this.length=1;var $=0;for(U=this.length-1;U>=0&&($!==0||U>=E);U--){var Y=0|this.words[U];this.words[U]=$<<26-N|Y>>>N,$=Y&k}return I&&$!==0&&(I.words[I.length++]=$),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},l.prototype.ishrn=function(M,F,S){return c(this.negative===0),this.iushrn(M,F,S)},l.prototype.shln=function(M){return this.clone().ishln(M)},l.prototype.ushln=function(M){return this.clone().iushln(M)},l.prototype.shrn=function(M){return this.clone().ishrn(M)},l.prototype.ushrn=function(M){return this.clone().iushrn(M)},l.prototype.testn=function(M){c(typeof M=="number"&&M>=0);var F=M%26,S=(M-F)/26,E=1<<F;return!(this.length<=S)&&!!(this.words[S]&E)},l.prototype.imaskn=function(M){c(typeof M=="number"&&M>=0);var F=M%26,S=(M-F)/26;if(c(this.negative===0,"imaskn works only with positive numbers"),this.length<=S)return this;if(F!==0&&S++,this.length=Math.min(S,this.length),F!==0){var E=67108863^67108863>>>F<<F;this.words[this.length-1]&=E}return this.strip()},l.prototype.maskn=function(M){return this.clone().imaskn(M)},l.prototype.iaddn=function(M){return c(typeof M=="number"),c(M<67108864),M<0?this.isubn(-M):this.negative!==0?this.length===1&&(0|this.words[0])<M?(this.words[0]=M-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(M),this.negative=1,this):this._iaddn(M)},l.prototype._iaddn=function(M){this.words[0]+=M;for(var F=0;F<this.length&&this.words[F]>=67108864;F++)this.words[F]-=67108864,F===this.length-1?this.words[F+1]=1:this.words[F+1]++;return this.length=Math.max(this.length,F+1),this},l.prototype.isubn=function(M){if(c(typeof M=="number"),c(M<67108864),M<0)return this.iaddn(-M);if(this.negative!==0)return this.negative=0,this.iaddn(M),this.negative=1,this;if(this.words[0]-=M,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var F=0;F<this.length&&this.words[F]<0;F++)this.words[F]+=67108864,this.words[F+1]-=1;return this.strip()},l.prototype.addn=function(M){return this.clone().iaddn(M)},l.prototype.subn=function(M){return this.clone().isubn(M)},l.prototype.iabs=function(){return this.negative=0,this},l.prototype.abs=function(){return this.clone().iabs()},l.prototype._ishlnsubmul=function(M,F,S){var E,N,C=M.length+S;this._expand(C);var k=0;for(E=0;E<M.length;E++){N=(0|this.words[E+S])+k;var I=(0|M.words[E])*F;k=((N-=67108863&I)>>26)-(I/67108864|0),this.words[E+S]=67108863&N}for(;E<this.length-S;E++)k=(N=(0|this.words[E+S])+k)>>26,this.words[E+S]=67108863&N;if(k===0)return this.strip();for(c(k===-1),k=0,E=0;E<this.length;E++)k=(N=-(0|this.words[E])+k)>>26,this.words[E]=67108863&N;return this.negative=1,this.strip()},l.prototype._wordDiv=function(M,F){var S=(this.length,M.length),E=this.clone(),N=M,C=0|N.words[N.length-1];(S=26-this._countBits(C))!==0&&(N=N.ushln(S),E.iushln(S),C=0|N.words[N.length-1]);var k,I=E.length-N.length;if(F!=="mod"){(k=new l(null)).length=I+1,k.words=new Array(k.length);for(var U=0;U<k.length;U++)k.words[U]=0}var $=E.clone()._ishlnsubmul(N,1,I);$.negative===0&&(E=$,k&&(k.words[I]=1));for(var Y=I-1;Y>=0;Y--){var Z=67108864*(0|E.words[N.length+Y])+(0|E.words[N.length+Y-1]);for(Z=Math.min(Z/C|0,67108863),E._ishlnsubmul(N,Z,Y);E.negative!==0;)Z--,E.negative=0,E._ishlnsubmul(N,1,Y),E.isZero()||(E.negative^=1);k&&(k.words[Y]=Z)}return k&&k.strip(),E.strip(),F!=="div"&&S!==0&&E.iushrn(S),{div:k||null,mod:E}},l.prototype.divmod=function(M,F,S){return c(!M.isZero()),this.isZero()?{div:new l(0),mod:new l(0)}:this.negative!==0&&M.negative===0?(C=this.neg().divmod(M,F),F!=="mod"&&(E=C.div.neg()),F!=="div"&&(N=C.mod.neg(),S&&N.negative!==0&&N.iadd(M)),{div:E,mod:N}):this.negative===0&&M.negative!==0?(C=this.divmod(M.neg(),F),F!=="mod"&&(E=C.div.neg()),{div:E,mod:C.mod}):this.negative&M.negative?(C=this.neg().divmod(M.neg(),F),F!=="div"&&(N=C.mod.neg(),S&&N.negative!==0&&N.isub(M)),{div:C.div,mod:N}):M.length>this.length||this.cmp(M)<0?{div:new l(0),mod:this}:M.length===1?F==="div"?{div:this.divn(M.words[0]),mod:null}:F==="mod"?{div:null,mod:new l(this.modn(M.words[0]))}:{div:this.divn(M.words[0]),mod:new l(this.modn(M.words[0]))}:this._wordDiv(M,F);var E,N,C},l.prototype.div=function(M){return this.divmod(M,"div",!1).div},l.prototype.mod=function(M){return this.divmod(M,"mod",!1).mod},l.prototype.umod=function(M){return this.divmod(M,"mod",!0).mod},l.prototype.divRound=function(M){var F=this.divmod(M);if(F.mod.isZero())return F.div;var S=F.div.negative!==0?F.mod.isub(M):F.mod,E=M.ushrn(1),N=M.andln(1),C=S.cmp(E);return C<0||N===1&&C===0?F.div:F.div.negative!==0?F.div.isubn(1):F.div.iaddn(1)},l.prototype.modn=function(M){c(M<=67108863);for(var F=(1<<26)%M,S=0,E=this.length-1;E>=0;E--)S=(F*S+(0|this.words[E]))%M;return S},l.prototype.idivn=function(M){c(M<=67108863);for(var F=0,S=this.length-1;S>=0;S--){var E=(0|this.words[S])+67108864*F;this.words[S]=E/M|0,F=E%M}return this.strip()},l.prototype.divn=function(M){return this.clone().idivn(M)},l.prototype.egcd=function(M){c(M.negative===0),c(!M.isZero());var F=this,S=M.clone();F=F.negative!==0?F.umod(M):F.clone();for(var E=new l(1),N=new l(0),C=new l(0),k=new l(1),I=0;F.isEven()&&S.isEven();)F.iushrn(1),S.iushrn(1),++I;for(var U=S.clone(),$=F.clone();!F.isZero();){for(var Y=0,Z=1;!(F.words[0]&Z)&&Y<26;++Y,Z<<=1);if(Y>0)for(F.iushrn(Y);Y-- >0;)(E.isOdd()||N.isOdd())&&(E.iadd(U),N.isub($)),E.iushrn(1),N.iushrn(1);for(var re=0,G=1;!(S.words[0]&G)&&re<26;++re,G<<=1);if(re>0)for(S.iushrn(re);re-- >0;)(C.isOdd()||k.isOdd())&&(C.iadd(U),k.isub($)),C.iushrn(1),k.iushrn(1);F.cmp(S)>=0?(F.isub(S),E.isub(C),N.isub(k)):(S.isub(F),C.isub(E),k.isub(N))}return{a:C,b:k,gcd:S.iushln(I)}},l.prototype._invmp=function(M){c(M.negative===0),c(!M.isZero());var F=this,S=M.clone();F=F.negative!==0?F.umod(M):F.clone();for(var E,N=new l(1),C=new l(0),k=S.clone();F.cmpn(1)>0&&S.cmpn(1)>0;){for(var I=0,U=1;!(F.words[0]&U)&&I<26;++I,U<<=1);if(I>0)for(F.iushrn(I);I-- >0;)N.isOdd()&&N.iadd(k),N.iushrn(1);for(var $=0,Y=1;!(S.words[0]&Y)&&$<26;++$,Y<<=1);if($>0)for(S.iushrn($);$-- >0;)C.isOdd()&&C.iadd(k),C.iushrn(1);F.cmp(S)>=0?(F.isub(S),N.isub(C)):(S.isub(F),C.isub(N))}return(E=F.cmpn(1)===0?N:C).cmpn(0)<0&&E.iadd(M),E},l.prototype.gcd=function(M){if(this.isZero())return M.abs();if(M.isZero())return this.abs();var F=this.clone(),S=M.clone();F.negative=0,S.negative=0;for(var E=0;F.isEven()&&S.isEven();E++)F.iushrn(1),S.iushrn(1);for(;;){for(;F.isEven();)F.iushrn(1);for(;S.isEven();)S.iushrn(1);var N=F.cmp(S);if(N<0){var C=F;F=S,S=C}else if(N===0||S.cmpn(1)===0)break;F.isub(S)}return S.iushln(E)},l.prototype.invm=function(M){return this.egcd(M).a.umod(M)},l.prototype.isEven=function(){return(1&this.words[0])==0},l.prototype.isOdd=function(){return(1&this.words[0])==1},l.prototype.andln=function(M){return this.words[0]&M},l.prototype.bincn=function(M){c(typeof M=="number");var F=M%26,S=(M-F)/26,E=1<<F;if(this.length<=S)return this._expand(S+1),this.words[S]|=E,this;for(var N=E,C=S;N!==0&&C<this.length;C++){var k=0|this.words[C];N=(k+=N)>>>26,k&=67108863,this.words[C]=k}return N!==0&&(this.words[C]=N,this.length++),this},l.prototype.isZero=function(){return this.length===1&&this.words[0]===0},l.prototype.cmpn=function(M){var F,S=M<0;if(this.negative!==0&&!S)return-1;if(this.negative===0&&S)return 1;if(this.strip(),this.length>1)F=1;else{S&&(M=-M),c(M<=67108863,"Number is too big");var E=0|this.words[0];F=E===M?0:E<M?-1:1}return this.negative!==0?0|-F:F},l.prototype.cmp=function(M){if(this.negative!==0&&M.negative===0)return-1;if(this.negative===0&&M.negative!==0)return 1;var F=this.ucmp(M);return this.negative!==0?0|-F:F},l.prototype.ucmp=function(M){if(this.length>M.length)return 1;if(this.length<M.length)return-1;for(var F=0,S=this.length-1;S>=0;S--){var E=0|this.words[S],N=0|M.words[S];if(E!==N){E<N?F=-1:E>N&&(F=1);break}}return F},l.prototype.gtn=function(M){return this.cmpn(M)===1},l.prototype.gt=function(M){return this.cmp(M)===1},l.prototype.gten=function(M){return this.cmpn(M)>=0},l.prototype.gte=function(M){return this.cmp(M)>=0},l.prototype.ltn=function(M){return this.cmpn(M)===-1},l.prototype.lt=function(M){return this.cmp(M)===-1},l.prototype.lten=function(M){return this.cmpn(M)<=0},l.prototype.lte=function(M){return this.cmp(M)<=0},l.prototype.eqn=function(M){return this.cmpn(M)===0},l.prototype.eq=function(M){return this.cmp(M)===0},l.red=function(M){return new X(M)},l.prototype.toRed=function(M){return c(!this.red,"Already a number in reduction context"),c(this.negative===0,"red works only with positives"),M.convertTo(this)._forceRed(M)},l.prototype.fromRed=function(){return c(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},l.prototype._forceRed=function(M){return this.red=M,this},l.prototype.forceRed=function(M){return c(!this.red,"Already a number in reduction context"),this._forceRed(M)},l.prototype.redAdd=function(M){return c(this.red,"redAdd works only with red numbers"),this.red.add(this,M)},l.prototype.redIAdd=function(M){return c(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,M)},l.prototype.redSub=function(M){return c(this.red,"redSub works only with red numbers"),this.red.sub(this,M)},l.prototype.redISub=function(M){return c(this.red,"redISub works only with red numbers"),this.red.isub(this,M)},l.prototype.redShl=function(M){return c(this.red,"redShl works only with red numbers"),this.red.shl(this,M)},l.prototype.redMul=function(M){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,M),this.red.mul(this,M)},l.prototype.redIMul=function(M){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,M),this.red.imul(this,M)},l.prototype.redSqr=function(){return c(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},l.prototype.redISqr=function(){return c(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},l.prototype.redSqrt=function(){return c(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},l.prototype.redInvm=function(){return c(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},l.prototype.redNeg=function(){return c(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},l.prototype.redPow=function(M){return c(this.red&&!M.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,M)};var T={k256:null,p224:null,p192:null,p25519:null};function O(M,F){this.name=M,this.p=new l(F,16),this.n=this.p.bitLength(),this.k=new l(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function R(){O.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function D(){O.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function L(){O.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function q(){O.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function X(M){if(typeof M=="string"){var F=l._prime(M);this.m=F.p,this.prime=F}else c(M.gtn(1),"modulus must be greater than 1"),this.m=M,this.prime=null}function H(M){X.call(this,M),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new l(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}O.prototype._tmp=function(){var M=new l(null);return M.words=new Array(Math.ceil(this.n/13)),M},O.prototype.ireduce=function(M){var F,S=M;do this.split(S,this.tmp),F=(S=(S=this.imulK(S)).iadd(this.tmp)).bitLength();while(F>this.n);var E=F<this.n?-1:S.ucmp(this.p);return E===0?(S.words[0]=0,S.length=1):E>0?S.isub(this.p):S.strip!==void 0?S.strip():S._strip(),S},O.prototype.split=function(M,F){M.iushrn(this.n,0,F)},O.prototype.imulK=function(M){return M.imul(this.k)},d(R,O),R.prototype.split=function(M,F){for(var S=Math.min(M.length,9),E=0;E<S;E++)F.words[E]=M.words[E];if(F.length=S,M.length<=9)return M.words[0]=0,void(M.length=1);var N=M.words[9];for(F.words[F.length++]=4194303&N,E=10;E<M.length;E++){var C=0|M.words[E];M.words[E-10]=(4194303&C)<<4|N>>>22,N=C}N>>>=22,M.words[E-10]=N,N===0&&M.length>10?M.length-=10:M.length-=9},R.prototype.imulK=function(M){M.words[M.length]=0,M.words[M.length+1]=0,M.length+=2;for(var F=0,S=0;S<M.length;S++){var E=0|M.words[S];F+=977*E,M.words[S]=67108863&F,F=64*E+(F/67108864|0)}return M.words[M.length-1]===0&&(M.length--,M.words[M.length-1]===0&&M.length--),M},d(D,O),d(L,O),d(q,O),q.prototype.imulK=function(M){for(var F=0,S=0;S<M.length;S++){var E=19*(0|M.words[S])+F,N=67108863&E;E>>>=26,M.words[S]=N,F=E}return F!==0&&(M.words[M.length++]=F),M},l._prime=function(M){if(T[M])return T[M];var F;if(M==="k256")F=new R;else if(M==="p224")F=new D;else if(M==="p192")F=new L;else{if(M!=="p25519")throw new Error("Unknown prime "+M);F=new q}return T[M]=F,F},X.prototype._verify1=function(M){c(M.negative===0,"red works only with positives"),c(M.red,"red works only with red numbers")},X.prototype._verify2=function(M,F){c((M.negative|F.negative)==0,"red works only with positives"),c(M.red&&M.red===F.red,"red works only with red numbers")},X.prototype.imod=function(M){return this.prime?this.prime.ireduce(M)._forceRed(this):M.umod(this.m)._forceRed(this)},X.prototype.neg=function(M){return M.isZero()?M.clone():this.m.sub(M)._forceRed(this)},X.prototype.add=function(M,F){this._verify2(M,F);var S=M.add(F);return S.cmp(this.m)>=0&&S.isub(this.m),S._forceRed(this)},X.prototype.iadd=function(M,F){this._verify2(M,F);var S=M.iadd(F);return S.cmp(this.m)>=0&&S.isub(this.m),S},X.prototype.sub=function(M,F){this._verify2(M,F);var S=M.sub(F);return S.cmpn(0)<0&&S.iadd(this.m),S._forceRed(this)},X.prototype.isub=function(M,F){this._verify2(M,F);var S=M.isub(F);return S.cmpn(0)<0&&S.iadd(this.m),S},X.prototype.shl=function(M,F){return this._verify1(M),this.imod(M.ushln(F))},X.prototype.imul=function(M,F){return this._verify2(M,F),this.imod(M.imul(F))},X.prototype.mul=function(M,F){return this._verify2(M,F),this.imod(M.mul(F))},X.prototype.isqr=function(M){return this.imul(M,M.clone())},X.prototype.sqr=function(M){return this.mul(M,M)},X.prototype.sqrt=function(M){if(M.isZero())return M.clone();var F=this.m.andln(3);if(c(F%2==1),F===3){var S=this.m.add(new l(1)).iushrn(2);return this.pow(M,S)}for(var E=this.m.subn(1),N=0;!E.isZero()&&E.andln(1)===0;)N++,E.iushrn(1);c(!E.isZero());var C=new l(1).toRed(this),k=C.redNeg(),I=this.m.subn(1).iushrn(1),U=this.m.bitLength();for(U=new l(2*U*U).toRed(this);this.pow(U,I).cmp(k)!==0;)U.redIAdd(k);for(var $=this.pow(U,E),Y=this.pow(M,E.addn(1).iushrn(1)),Z=this.pow(M,E),re=N;Z.cmp(C)!==0;){for(var G=Z,J=0;G.cmp(C)!==0;J++)G=G.redSqr();c(J<re);var V=this.pow($,new l(1).iushln(re-J-1));Y=Y.redMul(V),$=V.redSqr(),Z=Z.redMul($),re=J}return Y},X.prototype.invm=function(M){var F=M._invmp(this.m);return F.negative!==0?(F.negative=0,this.imod(F).redNeg()):this.imod(F)},X.prototype.pow=function(M,F){if(F.isZero())return new l(1).toRed(this);if(F.cmpn(1)===0)return M.clone();var S=new Array(16);S[0]=new l(1).toRed(this),S[1]=M;for(var E=2;E<S.length;E++)S[E]=this.mul(S[E-1],M);var N=S[0],C=0,k=0,I=F.bitLength()%26;for(I===0&&(I=26),E=F.length-1;E>=0;E--){for(var U=F.words[E],$=I-1;$>=0;$--){var Y=U>>$&1;N!==S[0]&&(N=this.sqr(N)),Y!==0||C!==0?(C<<=1,C|=Y,(++k===4||E===0&&$===0)&&(N=this.mul(N,S[C]),k=0,C=0)):k=0}I=26}return N},X.prototype.convertTo=function(M){var F=M.umod(this.m);return F===M?F.clone():F},X.prototype.convertFrom=function(M){var F=M.clone();return F.red=null,F},l.mont=function(M){return new H(M)},d(H,X),H.prototype.convertTo=function(M){return this.imod(M.ushln(this.shift))},H.prototype.convertFrom=function(M){var F=this.imod(M.mul(this.rinv));return F.red=null,F},H.prototype.imul=function(M,F){if(M.isZero()||F.isZero())return M.words[0]=0,M.length=1,M;var S=M.imul(F),E=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=S.isub(E).iushrn(this.shift),C=N;return N.cmp(this.m)>=0?C=N.isub(this.m):N.cmpn(0)<0&&(C=N.iadd(this.m)),C._forceRed(this)},H.prototype.mul=function(M,F){if(M.isZero()||F.isZero())return new l(0)._forceRed(this);var S=M.mul(F),E=S.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),N=S.isub(E).iushrn(this.shift),C=N;return N.cmp(this.m)>=0?C=N.isub(this.m):N.cmpn(0)<0&&(C=N.iadd(this.m)),C._forceRed(this)},H.prototype.invm=function(M){return this.imod(M._invmp(this.m).mul(this.r2))._forceRed(this)}})(s===void 0||s)},{buffer:188}],185:[function(r,s,a){a.byteLength=function(m){var p=h(m),g=p[0],v=p[1];return 3*(g+v)/4-v},a.toByteArray=function(m){var p,g,v=h(m),x=v[0],y=v[1],b=new c(function(O,R,D){return 3*(R+D)/4-D}(0,x,y)),j=0,T=y>0?x-4:x;for(g=0;g<T;g+=4)p=o[m.charCodeAt(g)]<<18|o[m.charCodeAt(g+1)]<<12|o[m.charCodeAt(g+2)]<<6|o[m.charCodeAt(g+3)],b[j++]=p>>16&255,b[j++]=p>>8&255,b[j++]=255&p;return y===2&&(p=o[m.charCodeAt(g)]<<2|o[m.charCodeAt(g+1)]>>4,b[j++]=255&p),y===1&&(p=o[m.charCodeAt(g)]<<10|o[m.charCodeAt(g+1)]<<4|o[m.charCodeAt(g+2)]>>2,b[j++]=p>>8&255,b[j++]=255&p),b},a.fromByteArray=function(m){for(var p,g=m.length,v=g%3,x=[],y=0,b=g-v;y<b;y+=16383)x.push(f(m,y,y+16383>b?b:y+16383));return v===1?(p=m[g-1],x.push(i[p>>2]+i[p<<4&63]+"==")):v===2&&(p=(m[g-2]<<8)+m[g-1],x.push(i[p>>10]+i[p>>4&63]+i[p<<2&63]+"=")),x.join("")};for(var i=[],o=[],c=typeof Uint8Array<"u"?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,u=d.length;l<u;++l)i[l]=d[l],o[d.charCodeAt(l)]=l;function h(m){var p=m.length;if(p%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var g=m.indexOf("=");return g===-1&&(g=p),[g,g===p?0:4-g%4]}function f(m,p,g){for(var v,x,y=[],b=p;b<g;b+=3)v=(m[b]<<16&16711680)+(m[b+1]<<8&65280)+(255&m[b+2]),y.push(i[(x=v)>>18&63]+i[x>>12&63]+i[x>>6&63]+i[63&x]);return y.join("")}o[45]=62,o[95]=63},{}],186:[function(r,s,a){(function(i,o){function c(S,E){if(!S)throw new Error(E||"Assertion failed")}function d(S,E){S.super_=E;var N=function(){};N.prototype=E.prototype,S.prototype=new N,S.prototype.constructor=S}function l(S,E,N){if(l.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,S!==null&&(E!=="le"&&E!=="be"||(N=E,E=10),this._init(S||0,E||10,N||"be"))}var u;typeof i=="object"?i.exports=l:(void 0).BN=l,l.BN=l,l.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:r("buffer").Buffer}catch{}function h(S,E){var N=S.charCodeAt(E);return N>=48&&N<=57?N-48:N>=65&&N<=70?N-55:N>=97&&N<=102?N-87:void c(!1,"Invalid character in "+S)}function f(S,E,N){var C=h(S,N);return N-1>=E&&(C|=h(S,N-1)<<4),C}function m(S,E,N,C){for(var k=0,I=0,U=Math.min(S.length,N),$=E;$<U;$++){var Y=S.charCodeAt($)-48;k*=C,I=Y>=49?Y-49+10:Y>=17?Y-17+10:Y,c(Y>=0&&I<C,"Invalid character"),k+=I}return k}function p(S,E){S.words=E.words,S.length=E.length,S.negative=E.negative,S.red=E.red}if(l.isBN=function(S){return S instanceof l||S!==null&&typeof S=="object"&&S.constructor.wordSize===l.wordSize&&Array.isArray(S.words)},l.max=function(S,E){return S.cmp(E)>0?S:E},l.min=function(S,E){return S.cmp(E)<0?S:E},l.prototype._init=function(S,E,N){if(typeof S=="number")return this._initNumber(S,E,N);if(typeof S=="object")return this._initArray(S,E,N);E==="hex"&&(E=16),c(E===(0|E)&&E>=2&&E<=36);var C=0;(S=S.toString().replace(/\s+/g,""))[0]==="-"&&(C++,this.negative=1),C<S.length&&(E===16?this._parseHex(S,C,N):(this._parseBase(S,E,C),N==="le"&&this._initArray(this.toArray(),E,N)))},l.prototype._initNumber=function(S,E,N){S<0&&(this.negative=1,S=-S),S<67108864?(this.words=[67108863&S],this.length=1):S<4503599627370496?(this.words=[67108863&S,S/67108864&67108863],this.length=2):(c(S<9007199254740992),this.words=[67108863&S,S/67108864&67108863,1],this.length=3),N==="le"&&this._initArray(this.toArray(),E,N)},l.prototype._initArray=function(S,E,N){if(c(typeof S.length=="number"),S.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(S.length/3),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var k,I,U=0;if(N==="be")for(C=S.length-1,k=0;C>=0;C-=3)I=S[C]|S[C-1]<<8|S[C-2]<<16,this.words[k]|=I<<U&67108863,this.words[k+1]=I>>>26-U&67108863,(U+=24)>=26&&(U-=26,k++);else if(N==="le")for(C=0,k=0;C<S.length;C+=3)I=S[C]|S[C+1]<<8|S[C+2]<<16,this.words[k]|=I<<U&67108863,this.words[k+1]=I>>>26-U&67108863,(U+=24)>=26&&(U-=26,k++);return this._strip()},l.prototype._parseHex=function(S,E,N){this.length=Math.ceil((S.length-E)/6),this.words=new Array(this.length);for(var C=0;C<this.length;C++)this.words[C]=0;var k,I=0,U=0;if(N==="be")for(C=S.length-1;C>=E;C-=2)k=f(S,E,C)<<I,this.words[U]|=67108863&k,I>=18?(I-=18,U+=1,this.words[U]|=k>>>26):I+=8;else for(C=(S.length-E)%2==0?E+1:E;C<S.length;C+=2)k=f(S,E,C)<<I,this.words[U]|=67108863&k,I>=18?(I-=18,U+=1,this.words[U]|=k>>>26):I+=8;this._strip()},l.prototype._parseBase=function(S,E,N){this.words=[0],this.length=1;for(var C=0,k=1;k<=67108863;k*=E)C++;C--,k=k/E|0;for(var I=S.length-N,U=I%C,$=Math.min(I,I-U)+N,Y=0,Z=N;Z<$;Z+=C)Y=m(S,Z,Z+C,E),this.imuln(k),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y);if(U!==0){var re=1;for(Y=m(S,Z,S.length,E),Z=0;Z<U;Z++)re*=E;this.imuln(re),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y)}this._strip()},l.prototype.copy=function(S){S.words=new Array(this.length);for(var E=0;E<this.length;E++)S.words[E]=this.words[E];S.length=this.length,S.negative=this.negative,S.red=this.red},l.prototype._move=function(S){p(S,this)},l.prototype.clone=function(){var S=new l(null);return this.copy(S),S},l.prototype._expand=function(S){for(;this.length<S;)this.words[this.length++]=0;return this},l.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},l.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{l.prototype[Symbol.for("nodejs.util.inspect.custom")]=g}catch{l.prototype.inspect=g}else l.prototype.inspect=g;function g(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var v=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],x=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];l.prototype.toString=function(S,E){var N;if(E=0|E||1,(S=S||10)===16||S==="hex"){N="";for(var C=0,k=0,I=0;I<this.length;I++){var U=this.words[I],$=(16777215&(U<<C|k)).toString(16);k=U>>>24-C&16777215,(C+=2)>=26&&(C-=26,I--),N=k!==0||I!==this.length-1?v[6-$.length]+$+N:$+N}for(k!==0&&(N=k.toString(16)+N);N.length%E!=0;)N="0"+N;return this.negative!==0&&(N="-"+N),N}if(S===(0|S)&&S>=2&&S<=36){var Y=x[S],Z=y[S];N="";var re=this.clone();for(re.negative=0;!re.isZero();){var G=re.modrn(Z).toString(S);N=(re=re.idivn(Z)).isZero()?G+N:v[Y-G.length]+G+N}for(this.isZero()&&(N="0"+N);N.length%E!=0;)N="0"+N;return this.negative!==0&&(N="-"+N),N}c(!1,"Base should be between 2 and 36")},l.prototype.toNumber=function(){var S=this.words[0];return this.length===2?S+=67108864*this.words[1]:this.length===3&&this.words[2]===1?S+=4503599627370496+67108864*this.words[1]:this.length>2&&c(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-S:S},l.prototype.toJSON=function(){return this.toString(16,2)},u&&(l.prototype.toBuffer=function(S,E){return this.toArrayLike(u,S,E)}),l.prototype.toArray=function(S,E){return this.toArrayLike(Array,S,E)};function b(S,E,N){N.negative=E.negative^S.negative;var C=S.length+E.length|0;N.length=C,C=C-1|0;var k=0|S.words[0],I=0|E.words[0],U=k*I,$=67108863&U,Y=U/67108864|0;N.words[0]=$;for(var Z=1;Z<C;Z++){for(var re=Y>>>26,G=67108863&Y,J=Math.min(Z,E.length-1),V=Math.max(0,Z-S.length+1);V<=J;V++){var W=Z-V|0;re+=(U=(k=0|S.words[W])*(I=0|E.words[V])+G)/67108864|0,G=67108863&U}N.words[Z]=0|G,Y=0|re}return Y!==0?N.words[Z]=0|Y:N.length--,N._strip()}l.prototype.toArrayLike=function(S,E,N){this._strip();var C=this.byteLength(),k=N||Math.max(1,C);c(C<=k,"byte array longer than desired length"),c(k>0,"Requested array length <= 0");var I=function(U,$){return U.allocUnsafe?U.allocUnsafe($):new U($)}(S,k);return this["_toArrayLike"+(E==="le"?"LE":"BE")](I,C),I},l.prototype._toArrayLikeLE=function(S,E){for(var N=0,C=0,k=0,I=0;k<this.length;k++){var U=this.words[k]<<I|C;S[N++]=255&U,N<S.length&&(S[N++]=U>>8&255),N<S.length&&(S[N++]=U>>16&255),I===6?(N<S.length&&(S[N++]=U>>24&255),C=0,I=0):(C=U>>>24,I+=2)}if(N<S.length)for(S[N++]=C;N<S.length;)S[N++]=0},l.prototype._toArrayLikeBE=function(S,E){for(var N=S.length-1,C=0,k=0,I=0;k<this.length;k++){var U=this.words[k]<<I|C;S[N--]=255&U,N>=0&&(S[N--]=U>>8&255),N>=0&&(S[N--]=U>>16&255),I===6?(N>=0&&(S[N--]=U>>24&255),C=0,I=0):(C=U>>>24,I+=2)}if(N>=0)for(S[N--]=C;N>=0;)S[N--]=0},Math.clz32?l.prototype._countBits=function(S){return 32-Math.clz32(S)}:l.prototype._countBits=function(S){var E=S,N=0;return E>=4096&&(N+=13,E>>>=13),E>=64&&(N+=7,E>>>=7),E>=8&&(N+=4,E>>>=4),E>=2&&(N+=2,E>>>=2),N+E},l.prototype._zeroBits=function(S){if(S===0)return 26;var E=S,N=0;return!(8191&E)&&(N+=13,E>>>=13),!(127&E)&&(N+=7,E>>>=7),!(15&E)&&(N+=4,E>>>=4),!(3&E)&&(N+=2,E>>>=2),!(1&E)&&N++,N},l.prototype.bitLength=function(){var S=this.words[this.length-1],E=this._countBits(S);return 26*(this.length-1)+E},l.prototype.zeroBits=function(){if(this.isZero())return 0;for(var S=0,E=0;E<this.length;E++){var N=this._zeroBits(this.words[E]);if(S+=N,N!==26)break}return S},l.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},l.prototype.toTwos=function(S){return this.negative!==0?this.abs().inotn(S).iaddn(1):this.clone()},l.prototype.fromTwos=function(S){return this.testn(S-1)?this.notn(S).iaddn(1).ineg():this.clone()},l.prototype.isNeg=function(){return this.negative!==0},l.prototype.neg=function(){return this.clone().ineg()},l.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},l.prototype.iuor=function(S){for(;this.length<S.length;)this.words[this.length++]=0;for(var E=0;E<S.length;E++)this.words[E]=this.words[E]|S.words[E];return this._strip()},l.prototype.ior=function(S){return c((this.negative|S.negative)==0),this.iuor(S)},l.prototype.or=function(S){return this.length>S.length?this.clone().ior(S):S.clone().ior(this)},l.prototype.uor=function(S){return this.length>S.length?this.clone().iuor(S):S.clone().iuor(this)},l.prototype.iuand=function(S){var E;E=this.length>S.length?S:this;for(var N=0;N<E.length;N++)this.words[N]=this.words[N]&S.words[N];return this.length=E.length,this._strip()},l.prototype.iand=function(S){return c((this.negative|S.negative)==0),this.iuand(S)},l.prototype.and=function(S){return this.length>S.length?this.clone().iand(S):S.clone().iand(this)},l.prototype.uand=function(S){return this.length>S.length?this.clone().iuand(S):S.clone().iuand(this)},l.prototype.iuxor=function(S){var E,N;this.length>S.length?(E=this,N=S):(E=S,N=this);for(var C=0;C<N.length;C++)this.words[C]=E.words[C]^N.words[C];if(this!==E)for(;C<E.length;C++)this.words[C]=E.words[C];return this.length=E.length,this._strip()},l.prototype.ixor=function(S){return c((this.negative|S.negative)==0),this.iuxor(S)},l.prototype.xor=function(S){return this.length>S.length?this.clone().ixor(S):S.clone().ixor(this)},l.prototype.uxor=function(S){return this.length>S.length?this.clone().iuxor(S):S.clone().iuxor(this)},l.prototype.inotn=function(S){c(typeof S=="number"&&S>=0);var E=0|Math.ceil(S/26),N=S%26;this._expand(E),N>0&&E--;for(var C=0;C<E;C++)this.words[C]=67108863&~this.words[C];return N>0&&(this.words[C]=~this.words[C]&67108863>>26-N),this._strip()},l.prototype.notn=function(S){return this.clone().inotn(S)},l.prototype.setn=function(S,E){c(typeof S=="number"&&S>=0);var N=S/26|0,C=S%26;return this._expand(N+1),this.words[N]=E?this.words[N]|1<<C:this.words[N]&~(1<<C),this._strip()},l.prototype.iadd=function(S){var E,N,C;if(this.negative!==0&&S.negative===0)return this.negative=0,E=this.isub(S),this.negative^=1,this._normSign();if(this.negative===0&&S.negative!==0)return S.negative=0,E=this.isub(S),S.negative=1,E._normSign();this.length>S.length?(N=this,C=S):(N=S,C=this);for(var k=0,I=0;I<C.length;I++)E=(0|N.words[I])+(0|C.words[I])+k,this.words[I]=67108863&E,k=E>>>26;for(;k!==0&&I<N.length;I++)E=(0|N.words[I])+k,this.words[I]=67108863&E,k=E>>>26;if(this.length=N.length,k!==0)this.words[this.length]=k,this.length++;else if(N!==this)for(;I<N.length;I++)this.words[I]=N.words[I];return this},l.prototype.add=function(S){var E;return S.negative!==0&&this.negative===0?(S.negative=0,E=this.sub(S),S.negative^=1,E):S.negative===0&&this.negative!==0?(this.negative=0,E=S.sub(this),this.negative=1,E):this.length>S.length?this.clone().iadd(S):S.clone().iadd(this)},l.prototype.isub=function(S){if(S.negative!==0){S.negative=0;var E=this.iadd(S);return S.negative=1,E._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(S),this.negative=1,this._normSign();var N,C,k=this.cmp(S);if(k===0)return this.negative=0,this.length=1,this.words[0]=0,this;k>0?(N=this,C=S):(N=S,C=this);for(var I=0,U=0;U<C.length;U++)I=(E=(0|N.words[U])-(0|C.words[U])+I)>>26,this.words[U]=67108863&E;for(;I!==0&&U<N.length;U++)I=(E=(0|N.words[U])+I)>>26,this.words[U]=67108863&E;if(I===0&&U<N.length&&N!==this)for(;U<N.length;U++)this.words[U]=N.words[U];return this.length=Math.max(this.length,U),N!==this&&(this.negative=1),this._strip()},l.prototype.sub=function(S){return this.clone().isub(S)};var j=function(S,E,N){var C,k,I,U=S.words,$=E.words,Y=N.words,Z=0,re=0|U[0],G=8191&re,J=re>>>13,V=0|U[1],W=8191&V,ee=V>>>13,ie=0|U[2],oe=8191&ie,se=ie>>>13,le=0|U[3],ye=8191&le,ue=le>>>13,ne=0|U[4],pe=8191&ne,ge=ne>>>13,Ne=0|U[5],_e=8191&Ne,be=Ne>>>13,Me=0|U[6],Se=8191&Me,$e=Me>>>13,Ke=0|U[7],Ze=8191&Ke,it=Ke>>>13,Re=0|U[8],ot=8191&Re,ut=Re>>>13,bt=0|U[9],Je=8191&bt,Ce=bt>>>13,Ge=0|$[0],Pe=8191&Ge,Ve=Ge>>>13,st=0|$[1],xt=8191&st,fe=st>>>13,Ie=0|$[2],tt=8191&Ie,lt=Ie>>>13,It=0|$[3],ct=8191&It,at=It>>>13,gt=0|$[4],Yt=8191&gt,St=gt>>>13,rt=0|$[5],ir=8191&rt,Ct=rt>>>13,Te=0|$[6],qe=8191&Te,ht=Te>>>13,Pt=0|$[7],vt=8191&Pt,Dt=Pt>>>13,_r=0|$[8],sr=8191&_r,or=_r>>>13,jr=0|$[9],br=8191&jr,Nr=jr>>>13;N.negative=S.negative^E.negative,N.length=19;var et=(Z+(C=Math.imul(G,Pe))|0)+((8191&(k=(k=Math.imul(G,Ve))+Math.imul(J,Pe)|0))<<13)|0;Z=((I=Math.imul(J,Ve))+(k>>>13)|0)+(et>>>26)|0,et&=67108863,C=Math.imul(W,Pe),k=(k=Math.imul(W,Ve))+Math.imul(ee,Pe)|0,I=Math.imul(ee,Ve);var Tt=(Z+(C=C+Math.imul(G,xt)|0)|0)+((8191&(k=(k=k+Math.imul(G,fe)|0)+Math.imul(J,xt)|0))<<13)|0;Z=((I=I+Math.imul(J,fe)|0)+(k>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,C=Math.imul(oe,Pe),k=(k=Math.imul(oe,Ve))+Math.imul(se,Pe)|0,I=Math.imul(se,Ve),C=C+Math.imul(W,xt)|0,k=(k=k+Math.imul(W,fe)|0)+Math.imul(ee,xt)|0,I=I+Math.imul(ee,fe)|0;var rr=(Z+(C=C+Math.imul(G,tt)|0)|0)+((8191&(k=(k=k+Math.imul(G,lt)|0)+Math.imul(J,tt)|0))<<13)|0;Z=((I=I+Math.imul(J,lt)|0)+(k>>>13)|0)+(rr>>>26)|0,rr&=67108863,C=Math.imul(ye,Pe),k=(k=Math.imul(ye,Ve))+Math.imul(ue,Pe)|0,I=Math.imul(ue,Ve),C=C+Math.imul(oe,xt)|0,k=(k=k+Math.imul(oe,fe)|0)+Math.imul(se,xt)|0,I=I+Math.imul(se,fe)|0,C=C+Math.imul(W,tt)|0,k=(k=k+Math.imul(W,lt)|0)+Math.imul(ee,tt)|0,I=I+Math.imul(ee,lt)|0;var nr=(Z+(C=C+Math.imul(G,ct)|0)|0)+((8191&(k=(k=k+Math.imul(G,at)|0)+Math.imul(J,ct)|0))<<13)|0;Z=((I=I+Math.imul(J,at)|0)+(k>>>13)|0)+(nr>>>26)|0,nr&=67108863,C=Math.imul(pe,Pe),k=(k=Math.imul(pe,Ve))+Math.imul(ge,Pe)|0,I=Math.imul(ge,Ve),C=C+Math.imul(ye,xt)|0,k=(k=k+Math.imul(ye,fe)|0)+Math.imul(ue,xt)|0,I=I+Math.imul(ue,fe)|0,C=C+Math.imul(oe,tt)|0,k=(k=k+Math.imul(oe,lt)|0)+Math.imul(se,tt)|0,I=I+Math.imul(se,lt)|0,C=C+Math.imul(W,ct)|0,k=(k=k+Math.imul(W,at)|0)+Math.imul(ee,ct)|0,I=I+Math.imul(ee,at)|0;var Qt=(Z+(C=C+Math.imul(G,Yt)|0)|0)+((8191&(k=(k=k+Math.imul(G,St)|0)+Math.imul(J,Yt)|0))<<13)|0;Z=((I=I+Math.imul(J,St)|0)+(k>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,C=Math.imul(_e,Pe),k=(k=Math.imul(_e,Ve))+Math.imul(be,Pe)|0,I=Math.imul(be,Ve),C=C+Math.imul(pe,xt)|0,k=(k=k+Math.imul(pe,fe)|0)+Math.imul(ge,xt)|0,I=I+Math.imul(ge,fe)|0,C=C+Math.imul(ye,tt)|0,k=(k=k+Math.imul(ye,lt)|0)+Math.imul(ue,tt)|0,I=I+Math.imul(ue,lt)|0,C=C+Math.imul(oe,ct)|0,k=(k=k+Math.imul(oe,at)|0)+Math.imul(se,ct)|0,I=I+Math.imul(se,at)|0,C=C+Math.imul(W,Yt)|0,k=(k=k+Math.imul(W,St)|0)+Math.imul(ee,Yt)|0,I=I+Math.imul(ee,St)|0;var Ee=(Z+(C=C+Math.imul(G,ir)|0)|0)+((8191&(k=(k=k+Math.imul(G,Ct)|0)+Math.imul(J,ir)|0))<<13)|0;Z=((I=I+Math.imul(J,Ct)|0)+(k>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,C=Math.imul(Se,Pe),k=(k=Math.imul(Se,Ve))+Math.imul($e,Pe)|0,I=Math.imul($e,Ve),C=C+Math.imul(_e,xt)|0,k=(k=k+Math.imul(_e,fe)|0)+Math.imul(be,xt)|0,I=I+Math.imul(be,fe)|0,C=C+Math.imul(pe,tt)|0,k=(k=k+Math.imul(pe,lt)|0)+Math.imul(ge,tt)|0,I=I+Math.imul(ge,lt)|0,C=C+Math.imul(ye,ct)|0,k=(k=k+Math.imul(ye,at)|0)+Math.imul(ue,ct)|0,I=I+Math.imul(ue,at)|0,C=C+Math.imul(oe,Yt)|0,k=(k=k+Math.imul(oe,St)|0)+Math.imul(se,Yt)|0,I=I+Math.imul(se,St)|0,C=C+Math.imul(W,ir)|0,k=(k=k+Math.imul(W,Ct)|0)+Math.imul(ee,ir)|0,I=I+Math.imul(ee,Ct)|0;var Xe=(Z+(C=C+Math.imul(G,qe)|0)|0)+((8191&(k=(k=k+Math.imul(G,ht)|0)+Math.imul(J,qe)|0))<<13)|0;Z=((I=I+Math.imul(J,ht)|0)+(k>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,C=Math.imul(Ze,Pe),k=(k=Math.imul(Ze,Ve))+Math.imul(it,Pe)|0,I=Math.imul(it,Ve),C=C+Math.imul(Se,xt)|0,k=(k=k+Math.imul(Se,fe)|0)+Math.imul($e,xt)|0,I=I+Math.imul($e,fe)|0,C=C+Math.imul(_e,tt)|0,k=(k=k+Math.imul(_e,lt)|0)+Math.imul(be,tt)|0,I=I+Math.imul(be,lt)|0,C=C+Math.imul(pe,ct)|0,k=(k=k+Math.imul(pe,at)|0)+Math.imul(ge,ct)|0,I=I+Math.imul(ge,at)|0,C=C+Math.imul(ye,Yt)|0,k=(k=k+Math.imul(ye,St)|0)+Math.imul(ue,Yt)|0,I=I+Math.imul(ue,St)|0,C=C+Math.imul(oe,ir)|0,k=(k=k+Math.imul(oe,Ct)|0)+Math.imul(se,ir)|0,I=I+Math.imul(se,Ct)|0,C=C+Math.imul(W,qe)|0,k=(k=k+Math.imul(W,ht)|0)+Math.imul(ee,qe)|0,I=I+Math.imul(ee,ht)|0;var dt=(Z+(C=C+Math.imul(G,vt)|0)|0)+((8191&(k=(k=k+Math.imul(G,Dt)|0)+Math.imul(J,vt)|0))<<13)|0;Z=((I=I+Math.imul(J,Dt)|0)+(k>>>13)|0)+(dt>>>26)|0,dt&=67108863,C=Math.imul(ot,Pe),k=(k=Math.imul(ot,Ve))+Math.imul(ut,Pe)|0,I=Math.imul(ut,Ve),C=C+Math.imul(Ze,xt)|0,k=(k=k+Math.imul(Ze,fe)|0)+Math.imul(it,xt)|0,I=I+Math.imul(it,fe)|0,C=C+Math.imul(Se,tt)|0,k=(k=k+Math.imul(Se,lt)|0)+Math.imul($e,tt)|0,I=I+Math.imul($e,lt)|0,C=C+Math.imul(_e,ct)|0,k=(k=k+Math.imul(_e,at)|0)+Math.imul(be,ct)|0,I=I+Math.imul(be,at)|0,C=C+Math.imul(pe,Yt)|0,k=(k=k+Math.imul(pe,St)|0)+Math.imul(ge,Yt)|0,I=I+Math.imul(ge,St)|0,C=C+Math.imul(ye,ir)|0,k=(k=k+Math.imul(ye,Ct)|0)+Math.imul(ue,ir)|0,I=I+Math.imul(ue,Ct)|0,C=C+Math.imul(oe,qe)|0,k=(k=k+Math.imul(oe,ht)|0)+Math.imul(se,qe)|0,I=I+Math.imul(se,ht)|0,C=C+Math.imul(W,vt)|0,k=(k=k+Math.imul(W,Dt)|0)+Math.imul(ee,vt)|0,I=I+Math.imul(ee,Dt)|0;var Fe=(Z+(C=C+Math.imul(G,sr)|0)|0)+((8191&(k=(k=k+Math.imul(G,or)|0)+Math.imul(J,sr)|0))<<13)|0;Z=((I=I+Math.imul(J,or)|0)+(k>>>13)|0)+(Fe>>>26)|0,Fe&=67108863,C=Math.imul(Je,Pe),k=(k=Math.imul(Je,Ve))+Math.imul(Ce,Pe)|0,I=Math.imul(Ce,Ve),C=C+Math.imul(ot,xt)|0,k=(k=k+Math.imul(ot,fe)|0)+Math.imul(ut,xt)|0,I=I+Math.imul(ut,fe)|0,C=C+Math.imul(Ze,tt)|0,k=(k=k+Math.imul(Ze,lt)|0)+Math.imul(it,tt)|0,I=I+Math.imul(it,lt)|0,C=C+Math.imul(Se,ct)|0,k=(k=k+Math.imul(Se,at)|0)+Math.imul($e,ct)|0,I=I+Math.imul($e,at)|0,C=C+Math.imul(_e,Yt)|0,k=(k=k+Math.imul(_e,St)|0)+Math.imul(be,Yt)|0,I=I+Math.imul(be,St)|0,C=C+Math.imul(pe,ir)|0,k=(k=k+Math.imul(pe,Ct)|0)+Math.imul(ge,ir)|0,I=I+Math.imul(ge,Ct)|0,C=C+Math.imul(ye,qe)|0,k=(k=k+Math.imul(ye,ht)|0)+Math.imul(ue,qe)|0,I=I+Math.imul(ue,ht)|0,C=C+Math.imul(oe,vt)|0,k=(k=k+Math.imul(oe,Dt)|0)+Math.imul(se,vt)|0,I=I+Math.imul(se,Dt)|0,C=C+Math.imul(W,sr)|0,k=(k=k+Math.imul(W,or)|0)+Math.imul(ee,sr)|0,I=I+Math.imul(ee,or)|0;var Zt=(Z+(C=C+Math.imul(G,br)|0)|0)+((8191&(k=(k=k+Math.imul(G,Nr)|0)+Math.imul(J,br)|0))<<13)|0;Z=((I=I+Math.imul(J,Nr)|0)+(k>>>13)|0)+(Zt>>>26)|0,Zt&=67108863,C=Math.imul(Je,xt),k=(k=Math.imul(Je,fe))+Math.imul(Ce,xt)|0,I=Math.imul(Ce,fe),C=C+Math.imul(ot,tt)|0,k=(k=k+Math.imul(ot,lt)|0)+Math.imul(ut,tt)|0,I=I+Math.imul(ut,lt)|0,C=C+Math.imul(Ze,ct)|0,k=(k=k+Math.imul(Ze,at)|0)+Math.imul(it,ct)|0,I=I+Math.imul(it,at)|0,C=C+Math.imul(Se,Yt)|0,k=(k=k+Math.imul(Se,St)|0)+Math.imul($e,Yt)|0,I=I+Math.imul($e,St)|0,C=C+Math.imul(_e,ir)|0,k=(k=k+Math.imul(_e,Ct)|0)+Math.imul(be,ir)|0,I=I+Math.imul(be,Ct)|0,C=C+Math.imul(pe,qe)|0,k=(k=k+Math.imul(pe,ht)|0)+Math.imul(ge,qe)|0,I=I+Math.imul(ge,ht)|0,C=C+Math.imul(ye,vt)|0,k=(k=k+Math.imul(ye,Dt)|0)+Math.imul(ue,vt)|0,I=I+Math.imul(ue,Dt)|0,C=C+Math.imul(oe,sr)|0,k=(k=k+Math.imul(oe,or)|0)+Math.imul(se,sr)|0,I=I+Math.imul(se,or)|0;var wt=(Z+(C=C+Math.imul(W,br)|0)|0)+((8191&(k=(k=k+Math.imul(W,Nr)|0)+Math.imul(ee,br)|0))<<13)|0;Z=((I=I+Math.imul(ee,Nr)|0)+(k>>>13)|0)+(wt>>>26)|0,wt&=67108863,C=Math.imul(Je,tt),k=(k=Math.imul(Je,lt))+Math.imul(Ce,tt)|0,I=Math.imul(Ce,lt),C=C+Math.imul(ot,ct)|0,k=(k=k+Math.imul(ot,at)|0)+Math.imul(ut,ct)|0,I=I+Math.imul(ut,at)|0,C=C+Math.imul(Ze,Yt)|0,k=(k=k+Math.imul(Ze,St)|0)+Math.imul(it,Yt)|0,I=I+Math.imul(it,St)|0,C=C+Math.imul(Se,ir)|0,k=(k=k+Math.imul(Se,Ct)|0)+Math.imul($e,ir)|0,I=I+Math.imul($e,Ct)|0,C=C+Math.imul(_e,qe)|0,k=(k=k+Math.imul(_e,ht)|0)+Math.imul(be,qe)|0,I=I+Math.imul(be,ht)|0,C=C+Math.imul(pe,vt)|0,k=(k=k+Math.imul(pe,Dt)|0)+Math.imul(ge,vt)|0,I=I+Math.imul(ge,Dt)|0,C=C+Math.imul(ye,sr)|0,k=(k=k+Math.imul(ye,or)|0)+Math.imul(ue,sr)|0,I=I+Math.imul(ue,or)|0;var Et=(Z+(C=C+Math.imul(oe,br)|0)|0)+((8191&(k=(k=k+Math.imul(oe,Nr)|0)+Math.imul(se,br)|0))<<13)|0;Z=((I=I+Math.imul(se,Nr)|0)+(k>>>13)|0)+(Et>>>26)|0,Et&=67108863,C=Math.imul(Je,ct),k=(k=Math.imul(Je,at))+Math.imul(Ce,ct)|0,I=Math.imul(Ce,at),C=C+Math.imul(ot,Yt)|0,k=(k=k+Math.imul(ot,St)|0)+Math.imul(ut,Yt)|0,I=I+Math.imul(ut,St)|0,C=C+Math.imul(Ze,ir)|0,k=(k=k+Math.imul(Ze,Ct)|0)+Math.imul(it,ir)|0,I=I+Math.imul(it,Ct)|0,C=C+Math.imul(Se,qe)|0,k=(k=k+Math.imul(Se,ht)|0)+Math.imul($e,qe)|0,I=I+Math.imul($e,ht)|0,C=C+Math.imul(_e,vt)|0,k=(k=k+Math.imul(_e,Dt)|0)+Math.imul(be,vt)|0,I=I+Math.imul(be,Dt)|0,C=C+Math.imul(pe,sr)|0,k=(k=k+Math.imul(pe,or)|0)+Math.imul(ge,sr)|0,I=I+Math.imul(ge,or)|0;var kr=(Z+(C=C+Math.imul(ye,br)|0)|0)+((8191&(k=(k=k+Math.imul(ye,Nr)|0)+Math.imul(ue,br)|0))<<13)|0;Z=((I=I+Math.imul(ue,Nr)|0)+(k>>>13)|0)+(kr>>>26)|0,kr&=67108863,C=Math.imul(Je,Yt),k=(k=Math.imul(Je,St))+Math.imul(Ce,Yt)|0,I=Math.imul(Ce,St),C=C+Math.imul(ot,ir)|0,k=(k=k+Math.imul(ot,Ct)|0)+Math.imul(ut,ir)|0,I=I+Math.imul(ut,Ct)|0,C=C+Math.imul(Ze,qe)|0,k=(k=k+Math.imul(Ze,ht)|0)+Math.imul(it,qe)|0,I=I+Math.imul(it,ht)|0,C=C+Math.imul(Se,vt)|0,k=(k=k+Math.imul(Se,Dt)|0)+Math.imul($e,vt)|0,I=I+Math.imul($e,Dt)|0,C=C+Math.imul(_e,sr)|0,k=(k=k+Math.imul(_e,or)|0)+Math.imul(be,sr)|0,I=I+Math.imul(be,or)|0;var Jt=(Z+(C=C+Math.imul(pe,br)|0)|0)+((8191&(k=(k=k+Math.imul(pe,Nr)|0)+Math.imul(ge,br)|0))<<13)|0;Z=((I=I+Math.imul(ge,Nr)|0)+(k>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,C=Math.imul(Je,ir),k=(k=Math.imul(Je,Ct))+Math.imul(Ce,ir)|0,I=Math.imul(Ce,Ct),C=C+Math.imul(ot,qe)|0,k=(k=k+Math.imul(ot,ht)|0)+Math.imul(ut,qe)|0,I=I+Math.imul(ut,ht)|0,C=C+Math.imul(Ze,vt)|0,k=(k=k+Math.imul(Ze,Dt)|0)+Math.imul(it,vt)|0,I=I+Math.imul(it,Dt)|0,C=C+Math.imul(Se,sr)|0,k=(k=k+Math.imul(Se,or)|0)+Math.imul($e,sr)|0,I=I+Math.imul($e,or)|0;var tr=(Z+(C=C+Math.imul(_e,br)|0)|0)+((8191&(k=(k=k+Math.imul(_e,Nr)|0)+Math.imul(be,br)|0))<<13)|0;Z=((I=I+Math.imul(be,Nr)|0)+(k>>>13)|0)+(tr>>>26)|0,tr&=67108863,C=Math.imul(Je,qe),k=(k=Math.imul(Je,ht))+Math.imul(Ce,qe)|0,I=Math.imul(Ce,ht),C=C+Math.imul(ot,vt)|0,k=(k=k+Math.imul(ot,Dt)|0)+Math.imul(ut,vt)|0,I=I+Math.imul(ut,Dt)|0,C=C+Math.imul(Ze,sr)|0,k=(k=k+Math.imul(Ze,or)|0)+Math.imul(it,sr)|0,I=I+Math.imul(it,or)|0;var zt=(Z+(C=C+Math.imul(Se,br)|0)|0)+((8191&(k=(k=k+Math.imul(Se,Nr)|0)+Math.imul($e,br)|0))<<13)|0;Z=((I=I+Math.imul($e,Nr)|0)+(k>>>13)|0)+(zt>>>26)|0,zt&=67108863,C=Math.imul(Je,vt),k=(k=Math.imul(Je,Dt))+Math.imul(Ce,vt)|0,I=Math.imul(Ce,Dt),C=C+Math.imul(ot,sr)|0,k=(k=k+Math.imul(ot,or)|0)+Math.imul(ut,sr)|0,I=I+Math.imul(ut,or)|0;var vn=(Z+(C=C+Math.imul(Ze,br)|0)|0)+((8191&(k=(k=k+Math.imul(Ze,Nr)|0)+Math.imul(it,br)|0))<<13)|0;Z=((I=I+Math.imul(it,Nr)|0)+(k>>>13)|0)+(vn>>>26)|0,vn&=67108863,C=Math.imul(Je,sr),k=(k=Math.imul(Je,or))+Math.imul(Ce,sr)|0,I=Math.imul(Ce,or);var yn=(Z+(C=C+Math.imul(ot,br)|0)|0)+((8191&(k=(k=k+Math.imul(ot,Nr)|0)+Math.imul(ut,br)|0))<<13)|0;Z=((I=I+Math.imul(ut,Nr)|0)+(k>>>13)|0)+(yn>>>26)|0,yn&=67108863;var wn=(Z+(C=Math.imul(Je,br))|0)+((8191&(k=(k=Math.imul(Je,Nr))+Math.imul(Ce,br)|0))<<13)|0;return Z=((I=Math.imul(Ce,Nr))+(k>>>13)|0)+(wn>>>26)|0,wn&=67108863,Y[0]=et,Y[1]=Tt,Y[2]=rr,Y[3]=nr,Y[4]=Qt,Y[5]=Ee,Y[6]=Xe,Y[7]=dt,Y[8]=Fe,Y[9]=Zt,Y[10]=wt,Y[11]=Et,Y[12]=kr,Y[13]=Jt,Y[14]=tr,Y[15]=zt,Y[16]=vn,Y[17]=yn,Y[18]=wn,Z!==0&&(Y[19]=Z,N.length++),N};function T(S,E,N){N.negative=E.negative^S.negative,N.length=S.length+E.length;for(var C=0,k=0,I=0;I<N.length-1;I++){var U=k;k=0;for(var $=67108863&C,Y=Math.min(I,E.length-1),Z=Math.max(0,I-S.length+1);Z<=Y;Z++){var re=I-Z,G=(0|S.words[re])*(0|E.words[Z]),J=67108863&G;$=67108863&(J=J+$|0),k+=(U=(U=U+(G/67108864|0)|0)+(J>>>26)|0)>>>26,U&=67108863}N.words[I]=$,C=U,U=k}return C!==0?N.words[I]=C:N.length--,N._strip()}function O(S,E,N){return T(S,E,N)}Math.imul||(j=b),l.prototype.mulTo=function(S,E){var N=this.length+S.length;return this.length===10&&S.length===10?j(this,S,E):N<63?b(this,S,E):N<1024?T(this,S,E):O(this,S,E)},l.prototype.mul=function(S){var E=new l(null);return E.words=new Array(this.length+S.length),this.mulTo(S,E)},l.prototype.mulf=function(S){var E=new l(null);return E.words=new Array(this.length+S.length),O(this,S,E)},l.prototype.imul=function(S){return this.clone().mulTo(S,this)},l.prototype.imuln=function(S){var E=S<0;E&&(S=-S),c(typeof S=="number"),c(S<67108864);for(var N=0,C=0;C<this.length;C++){var k=(0|this.words[C])*S,I=(67108863&k)+(67108863&N);N>>=26,N+=k/67108864|0,N+=I>>>26,this.words[C]=67108863&I}return N!==0&&(this.words[C]=N,this.length++),E?this.ineg():this},l.prototype.muln=function(S){return this.clone().imuln(S)},l.prototype.sqr=function(){return this.mul(this)},l.prototype.isqr=function(){return this.imul(this.clone())},l.prototype.pow=function(S){var E=function(I){for(var U=new Array(I.bitLength()),$=0;$<U.length;$++){var Y=$/26|0,Z=$%26;U[$]=I.words[Y]>>>Z&1}return U}(S);if(E.length===0)return new l(1);for(var N=this,C=0;C<E.length&&E[C]===0;C++,N=N.sqr());if(++C<E.length)for(var k=N.sqr();C<E.length;C++,k=k.sqr())E[C]!==0&&(N=N.mul(k));return N},l.prototype.iushln=function(S){c(typeof S=="number"&&S>=0);var E,N=S%26,C=(S-N)/26,k=67108863>>>26-N<<26-N;if(N!==0){var I=0;for(E=0;E<this.length;E++){var U=this.words[E]&k,$=(0|this.words[E])-U<<N;this.words[E]=$|I,I=U>>>26-N}I&&(this.words[E]=I,this.length++)}if(C!==0){for(E=this.length-1;E>=0;E--)this.words[E+C]=this.words[E];for(E=0;E<C;E++)this.words[E]=0;this.length+=C}return this._strip()},l.prototype.ishln=function(S){return c(this.negative===0),this.iushln(S)},l.prototype.iushrn=function(S,E,N){var C;c(typeof S=="number"&&S>=0),C=E?(E-E%26)/26:0;var k=S%26,I=Math.min((S-k)/26,this.length),U=67108863^67108863>>>k<<k,$=N;if(C-=I,C=Math.max(0,C),$){for(var Y=0;Y<I;Y++)$.words[Y]=this.words[Y];$.length=I}if(I!==0)if(this.length>I)for(this.length-=I,Y=0;Y<this.length;Y++)this.words[Y]=this.words[Y+I];else this.words[0]=0,this.length=1;var Z=0;for(Y=this.length-1;Y>=0&&(Z!==0||Y>=C);Y--){var re=0|this.words[Y];this.words[Y]=Z<<26-k|re>>>k,Z=re&U}return $&&Z!==0&&($.words[$.length++]=Z),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},l.prototype.ishrn=function(S,E,N){return c(this.negative===0),this.iushrn(S,E,N)},l.prototype.shln=function(S){return this.clone().ishln(S)},l.prototype.ushln=function(S){return this.clone().iushln(S)},l.prototype.shrn=function(S){return this.clone().ishrn(S)},l.prototype.ushrn=function(S){return this.clone().iushrn(S)},l.prototype.testn=function(S){c(typeof S=="number"&&S>=0);var E=S%26,N=(S-E)/26,C=1<<E;return!(this.length<=N)&&!!(this.words[N]&C)},l.prototype.imaskn=function(S){c(typeof S=="number"&&S>=0);var E=S%26,N=(S-E)/26;if(c(this.negative===0,"imaskn works only with positive numbers"),this.length<=N)return this;if(E!==0&&N++,this.length=Math.min(N,this.length),E!==0){var C=67108863^67108863>>>E<<E;this.words[this.length-1]&=C}return this._strip()},l.prototype.maskn=function(S){return this.clone().imaskn(S)},l.prototype.iaddn=function(S){return c(typeof S=="number"),c(S<67108864),S<0?this.isubn(-S):this.negative!==0?this.length===1&&(0|this.words[0])<=S?(this.words[0]=S-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(S),this.negative=1,this):this._iaddn(S)},l.prototype._iaddn=function(S){this.words[0]+=S;for(var E=0;E<this.length&&this.words[E]>=67108864;E++)this.words[E]-=67108864,E===this.length-1?this.words[E+1]=1:this.words[E+1]++;return this.length=Math.max(this.length,E+1),this},l.prototype.isubn=function(S){if(c(typeof S=="number"),c(S<67108864),S<0)return this.iaddn(-S);if(this.negative!==0)return this.negative=0,this.iaddn(S),this.negative=1,this;if(this.words[0]-=S,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var E=0;E<this.length&&this.words[E]<0;E++)this.words[E]+=67108864,this.words[E+1]-=1;return this._strip()},l.prototype.addn=function(S){return this.clone().iaddn(S)},l.prototype.subn=function(S){return this.clone().isubn(S)},l.prototype.iabs=function(){return this.negative=0,this},l.prototype.abs=function(){return this.clone().iabs()},l.prototype._ishlnsubmul=function(S,E,N){var C,k,I=S.length+N;this._expand(I);var U=0;for(C=0;C<S.length;C++){k=(0|this.words[C+N])+U;var $=(0|S.words[C])*E;U=((k-=67108863&$)>>26)-($/67108864|0),this.words[C+N]=67108863&k}for(;C<this.length-N;C++)U=(k=(0|this.words[C+N])+U)>>26,this.words[C+N]=67108863&k;if(U===0)return this._strip();for(c(U===-1),U=0,C=0;C<this.length;C++)U=(k=-(0|this.words[C])+U)>>26,this.words[C]=67108863&k;return this.negative=1,this._strip()},l.prototype._wordDiv=function(S,E){var N=(this.length,S.length),C=this.clone(),k=S,I=0|k.words[k.length-1];(N=26-this._countBits(I))!==0&&(k=k.ushln(N),C.iushln(N),I=0|k.words[k.length-1]);var U,$=C.length-k.length;if(E!=="mod"){(U=new l(null)).length=$+1,U.words=new Array(U.length);for(var Y=0;Y<U.length;Y++)U.words[Y]=0}var Z=C.clone()._ishlnsubmul(k,1,$);Z.negative===0&&(C=Z,U&&(U.words[$]=1));for(var re=$-1;re>=0;re--){var G=67108864*(0|C.words[k.length+re])+(0|C.words[k.length+re-1]);for(G=Math.min(G/I|0,67108863),C._ishlnsubmul(k,G,re);C.negative!==0;)G--,C.negative=0,C._ishlnsubmul(k,1,re),C.isZero()||(C.negative^=1);U&&(U.words[re]=G)}return U&&U._strip(),C._strip(),E!=="div"&&N!==0&&C.iushrn(N),{div:U||null,mod:C}},l.prototype.divmod=function(S,E,N){return c(!S.isZero()),this.isZero()?{div:new l(0),mod:new l(0)}:this.negative!==0&&S.negative===0?(I=this.neg().divmod(S,E),E!=="mod"&&(C=I.div.neg()),E!=="div"&&(k=I.mod.neg(),N&&k.negative!==0&&k.iadd(S)),{div:C,mod:k}):this.negative===0&&S.negative!==0?(I=this.divmod(S.neg(),E),E!=="mod"&&(C=I.div.neg()),{div:C,mod:I.mod}):this.negative&S.negative?(I=this.neg().divmod(S.neg(),E),E!=="div"&&(k=I.mod.neg(),N&&k.negative!==0&&k.isub(S)),{div:I.div,mod:k}):S.length>this.length||this.cmp(S)<0?{div:new l(0),mod:this}:S.length===1?E==="div"?{div:this.divn(S.words[0]),mod:null}:E==="mod"?{div:null,mod:new l(this.modrn(S.words[0]))}:{div:this.divn(S.words[0]),mod:new l(this.modrn(S.words[0]))}:this._wordDiv(S,E);var C,k,I},l.prototype.div=function(S){return this.divmod(S,"div",!1).div},l.prototype.mod=function(S){return this.divmod(S,"mod",!1).mod},l.prototype.umod=function(S){return this.divmod(S,"mod",!0).mod},l.prototype.divRound=function(S){var E=this.divmod(S);if(E.mod.isZero())return E.div;var N=E.div.negative!==0?E.mod.isub(S):E.mod,C=S.ushrn(1),k=S.andln(1),I=N.cmp(C);return I<0||k===1&&I===0?E.div:E.div.negative!==0?E.div.isubn(1):E.div.iaddn(1)},l.prototype.modrn=function(S){var E=S<0;E&&(S=-S),c(S<=67108863);for(var N=(1<<26)%S,C=0,k=this.length-1;k>=0;k--)C=(N*C+(0|this.words[k]))%S;return E?-C:C},l.prototype.modn=function(S){return this.modrn(S)},l.prototype.idivn=function(S){var E=S<0;E&&(S=-S),c(S<=67108863);for(var N=0,C=this.length-1;C>=0;C--){var k=(0|this.words[C])+67108864*N;this.words[C]=k/S|0,N=k%S}return this._strip(),E?this.ineg():this},l.prototype.divn=function(S){return this.clone().idivn(S)},l.prototype.egcd=function(S){c(S.negative===0),c(!S.isZero());var E=this,N=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var C=new l(1),k=new l(0),I=new l(0),U=new l(1),$=0;E.isEven()&&N.isEven();)E.iushrn(1),N.iushrn(1),++$;for(var Y=N.clone(),Z=E.clone();!E.isZero();){for(var re=0,G=1;!(E.words[0]&G)&&re<26;++re,G<<=1);if(re>0)for(E.iushrn(re);re-- >0;)(C.isOdd()||k.isOdd())&&(C.iadd(Y),k.isub(Z)),C.iushrn(1),k.iushrn(1);for(var J=0,V=1;!(N.words[0]&V)&&J<26;++J,V<<=1);if(J>0)for(N.iushrn(J);J-- >0;)(I.isOdd()||U.isOdd())&&(I.iadd(Y),U.isub(Z)),I.iushrn(1),U.iushrn(1);E.cmp(N)>=0?(E.isub(N),C.isub(I),k.isub(U)):(N.isub(E),I.isub(C),U.isub(k))}return{a:I,b:U,gcd:N.iushln($)}},l.prototype._invmp=function(S){c(S.negative===0),c(!S.isZero());var E=this,N=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var C,k=new l(1),I=new l(0),U=N.clone();E.cmpn(1)>0&&N.cmpn(1)>0;){for(var $=0,Y=1;!(E.words[0]&Y)&&$<26;++$,Y<<=1);if($>0)for(E.iushrn($);$-- >0;)k.isOdd()&&k.iadd(U),k.iushrn(1);for(var Z=0,re=1;!(N.words[0]&re)&&Z<26;++Z,re<<=1);if(Z>0)for(N.iushrn(Z);Z-- >0;)I.isOdd()&&I.iadd(U),I.iushrn(1);E.cmp(N)>=0?(E.isub(N),k.isub(I)):(N.isub(E),I.isub(k))}return(C=E.cmpn(1)===0?k:I).cmpn(0)<0&&C.iadd(S),C},l.prototype.gcd=function(S){if(this.isZero())return S.abs();if(S.isZero())return this.abs();var E=this.clone(),N=S.clone();E.negative=0,N.negative=0;for(var C=0;E.isEven()&&N.isEven();C++)E.iushrn(1),N.iushrn(1);for(;;){for(;E.isEven();)E.iushrn(1);for(;N.isEven();)N.iushrn(1);var k=E.cmp(N);if(k<0){var I=E;E=N,N=I}else if(k===0||N.cmpn(1)===0)break;E.isub(N)}return N.iushln(C)},l.prototype.invm=function(S){return this.egcd(S).a.umod(S)},l.prototype.isEven=function(){return(1&this.words[0])==0},l.prototype.isOdd=function(){return(1&this.words[0])==1},l.prototype.andln=function(S){return this.words[0]&S},l.prototype.bincn=function(S){c(typeof S=="number");var E=S%26,N=(S-E)/26,C=1<<E;if(this.length<=N)return this._expand(N+1),this.words[N]|=C,this;for(var k=C,I=N;k!==0&&I<this.length;I++){var U=0|this.words[I];k=(U+=k)>>>26,U&=67108863,this.words[I]=U}return k!==0&&(this.words[I]=k,this.length++),this},l.prototype.isZero=function(){return this.length===1&&this.words[0]===0},l.prototype.cmpn=function(S){var E,N=S<0;if(this.negative!==0&&!N)return-1;if(this.negative===0&&N)return 1;if(this._strip(),this.length>1)E=1;else{N&&(S=-S),c(S<=67108863,"Number is too big");var C=0|this.words[0];E=C===S?0:C<S?-1:1}return this.negative!==0?0|-E:E},l.prototype.cmp=function(S){if(this.negative!==0&&S.negative===0)return-1;if(this.negative===0&&S.negative!==0)return 1;var E=this.ucmp(S);return this.negative!==0?0|-E:E},l.prototype.ucmp=function(S){if(this.length>S.length)return 1;if(this.length<S.length)return-1;for(var E=0,N=this.length-1;N>=0;N--){var C=0|this.words[N],k=0|S.words[N];if(C!==k){C<k?E=-1:C>k&&(E=1);break}}return E},l.prototype.gtn=function(S){return this.cmpn(S)===1},l.prototype.gt=function(S){return this.cmp(S)===1},l.prototype.gten=function(S){return this.cmpn(S)>=0},l.prototype.gte=function(S){return this.cmp(S)>=0},l.prototype.ltn=function(S){return this.cmpn(S)===-1},l.prototype.lt=function(S){return this.cmp(S)===-1},l.prototype.lten=function(S){return this.cmpn(S)<=0},l.prototype.lte=function(S){return this.cmp(S)<=0},l.prototype.eqn=function(S){return this.cmpn(S)===0},l.prototype.eq=function(S){return this.cmp(S)===0},l.red=function(S){return new M(S)},l.prototype.toRed=function(S){return c(!this.red,"Already a number in reduction context"),c(this.negative===0,"red works only with positives"),S.convertTo(this)._forceRed(S)},l.prototype.fromRed=function(){return c(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},l.prototype._forceRed=function(S){return this.red=S,this},l.prototype.forceRed=function(S){return c(!this.red,"Already a number in reduction context"),this._forceRed(S)},l.prototype.redAdd=function(S){return c(this.red,"redAdd works only with red numbers"),this.red.add(this,S)},l.prototype.redIAdd=function(S){return c(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,S)},l.prototype.redSub=function(S){return c(this.red,"redSub works only with red numbers"),this.red.sub(this,S)},l.prototype.redISub=function(S){return c(this.red,"redISub works only with red numbers"),this.red.isub(this,S)},l.prototype.redShl=function(S){return c(this.red,"redShl works only with red numbers"),this.red.shl(this,S)},l.prototype.redMul=function(S){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.mul(this,S)},l.prototype.redIMul=function(S){return c(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.imul(this,S)},l.prototype.redSqr=function(){return c(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},l.prototype.redISqr=function(){return c(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},l.prototype.redSqrt=function(){return c(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},l.prototype.redInvm=function(){return c(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},l.prototype.redNeg=function(){return c(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},l.prototype.redPow=function(S){return c(this.red&&!S.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,S)};var R={k256:null,p224:null,p192:null,p25519:null};function D(S,E){this.name=S,this.p=new l(E,16),this.n=this.p.bitLength(),this.k=new l(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function L(){D.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function q(){D.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function X(){D.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function H(){D.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function M(S){if(typeof S=="string"){var E=l._prime(S);this.m=E.p,this.prime=E}else c(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}function F(S){M.call(this,S),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new l(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}D.prototype._tmp=function(){var S=new l(null);return S.words=new Array(Math.ceil(this.n/13)),S},D.prototype.ireduce=function(S){var E,N=S;do this.split(N,this.tmp),E=(N=(N=this.imulK(N)).iadd(this.tmp)).bitLength();while(E>this.n);var C=E<this.n?-1:N.ucmp(this.p);return C===0?(N.words[0]=0,N.length=1):C>0?N.isub(this.p):N.strip!==void 0?N.strip():N._strip(),N},D.prototype.split=function(S,E){S.iushrn(this.n,0,E)},D.prototype.imulK=function(S){return S.imul(this.k)},d(L,D),L.prototype.split=function(S,E){for(var N=Math.min(S.length,9),C=0;C<N;C++)E.words[C]=S.words[C];if(E.length=N,S.length<=9)return S.words[0]=0,void(S.length=1);var k=S.words[9];for(E.words[E.length++]=4194303&k,C=10;C<S.length;C++){var I=0|S.words[C];S.words[C-10]=(4194303&I)<<4|k>>>22,k=I}k>>>=22,S.words[C-10]=k,k===0&&S.length>10?S.length-=10:S.length-=9},L.prototype.imulK=function(S){S.words[S.length]=0,S.words[S.length+1]=0,S.length+=2;for(var E=0,N=0;N<S.length;N++){var C=0|S.words[N];E+=977*C,S.words[N]=67108863&E,E=64*C+(E/67108864|0)}return S.words[S.length-1]===0&&(S.length--,S.words[S.length-1]===0&&S.length--),S},d(q,D),d(X,D),d(H,D),H.prototype.imulK=function(S){for(var E=0,N=0;N<S.length;N++){var C=19*(0|S.words[N])+E,k=67108863&C;C>>>=26,S.words[N]=k,E=C}return E!==0&&(S.words[S.length++]=E),S},l._prime=function(S){if(R[S])return R[S];var E;if(S==="k256")E=new L;else if(S==="p224")E=new q;else if(S==="p192")E=new X;else{if(S!=="p25519")throw new Error("Unknown prime "+S);E=new H}return R[S]=E,E},M.prototype._verify1=function(S){c(S.negative===0,"red works only with positives"),c(S.red,"red works only with red numbers")},M.prototype._verify2=function(S,E){c((S.negative|E.negative)==0,"red works only with positives"),c(S.red&&S.red===E.red,"red works only with red numbers")},M.prototype.imod=function(S){return this.prime?this.prime.ireduce(S)._forceRed(this):(p(S,S.umod(this.m)._forceRed(this)),S)},M.prototype.neg=function(S){return S.isZero()?S.clone():this.m.sub(S)._forceRed(this)},M.prototype.add=function(S,E){this._verify2(S,E);var N=S.add(E);return N.cmp(this.m)>=0&&N.isub(this.m),N._forceRed(this)},M.prototype.iadd=function(S,E){this._verify2(S,E);var N=S.iadd(E);return N.cmp(this.m)>=0&&N.isub(this.m),N},M.prototype.sub=function(S,E){this._verify2(S,E);var N=S.sub(E);return N.cmpn(0)<0&&N.iadd(this.m),N._forceRed(this)},M.prototype.isub=function(S,E){this._verify2(S,E);var N=S.isub(E);return N.cmpn(0)<0&&N.iadd(this.m),N},M.prototype.shl=function(S,E){return this._verify1(S),this.imod(S.ushln(E))},M.prototype.imul=function(S,E){return this._verify2(S,E),this.imod(S.imul(E))},M.prototype.mul=function(S,E){return this._verify2(S,E),this.imod(S.mul(E))},M.prototype.isqr=function(S){return this.imul(S,S.clone())},M.prototype.sqr=function(S){return this.mul(S,S)},M.prototype.sqrt=function(S){if(S.isZero())return S.clone();var E=this.m.andln(3);if(c(E%2==1),E===3){var N=this.m.add(new l(1)).iushrn(2);return this.pow(S,N)}for(var C=this.m.subn(1),k=0;!C.isZero()&&C.andln(1)===0;)k++,C.iushrn(1);c(!C.isZero());var I=new l(1).toRed(this),U=I.redNeg(),$=this.m.subn(1).iushrn(1),Y=this.m.bitLength();for(Y=new l(2*Y*Y).toRed(this);this.pow(Y,$).cmp(U)!==0;)Y.redIAdd(U);for(var Z=this.pow(Y,C),re=this.pow(S,C.addn(1).iushrn(1)),G=this.pow(S,C),J=k;G.cmp(I)!==0;){for(var V=G,W=0;V.cmp(I)!==0;W++)V=V.redSqr();c(W<J);var ee=this.pow(Z,new l(1).iushln(J-W-1));re=re.redMul(ee),Z=ee.redSqr(),G=G.redMul(Z),J=W}return re},M.prototype.invm=function(S){var E=S._invmp(this.m);return E.negative!==0?(E.negative=0,this.imod(E).redNeg()):this.imod(E)},M.prototype.pow=function(S,E){if(E.isZero())return new l(1).toRed(this);if(E.cmpn(1)===0)return S.clone();var N=new Array(16);N[0]=new l(1).toRed(this),N[1]=S;for(var C=2;C<N.length;C++)N[C]=this.mul(N[C-1],S);var k=N[0],I=0,U=0,$=E.bitLength()%26;for($===0&&($=26),C=E.length-1;C>=0;C--){for(var Y=E.words[C],Z=$-1;Z>=0;Z--){var re=Y>>Z&1;k!==N[0]&&(k=this.sqr(k)),re!==0||I!==0?(I<<=1,I|=re,(++U===4||C===0&&Z===0)&&(k=this.mul(k,N[I]),U=0,I=0)):U=0}$=26}return k},M.prototype.convertTo=function(S){var E=S.umod(this.m);return E===S?E.clone():E},M.prototype.convertFrom=function(S){var E=S.clone();return E.red=null,E},l.mont=function(S){return new F(S)},d(F,M),F.prototype.convertTo=function(S){return this.imod(S.ushln(this.shift))},F.prototype.convertFrom=function(S){var E=this.imod(S.mul(this.rinv));return E.red=null,E},F.prototype.imul=function(S,E){if(S.isZero()||E.isZero())return S.words[0]=0,S.length=1,S;var N=S.imul(E),C=N.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=N.isub(C).iushrn(this.shift),I=k;return k.cmp(this.m)>=0?I=k.isub(this.m):k.cmpn(0)<0&&(I=k.iadd(this.m)),I._forceRed(this)},F.prototype.mul=function(S,E){if(S.isZero()||E.isZero())return new l(0)._forceRed(this);var N=S.mul(E),C=N.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),k=N.isub(C).iushrn(this.shift),I=k;return k.cmp(this.m)>=0?I=k.isub(this.m):k.cmpn(0)<0&&(I=k.iadd(this.m)),I._forceRed(this)},F.prototype.invm=function(S){return this.imod(S._invmp(this.m).mul(this.r2))._forceRed(this)}})(s===void 0||s)},{buffer:188}],187:[function(r,s,a){var i;function o(d){this.rand=d}if(s.exports=function(d){return i||(i=new o(null)),i.generate(d)},s.exports.Rand=o,o.prototype.generate=function(d){return this._rand(d)},o.prototype._rand=function(d){if(this.rand.getBytes)return this.rand.getBytes(d);for(var l=new Uint8Array(d),u=0;u<l.length;u++)l[u]=this.rand.getByte();return l},typeof self=="object")self.crypto&&self.crypto.getRandomValues?o.prototype._rand=function(d){var l=new Uint8Array(d);return self.crypto.getRandomValues(l),l}:self.msCrypto&&self.msCrypto.getRandomValues?o.prototype._rand=function(d){var l=new Uint8Array(d);return self.msCrypto.getRandomValues(l),l}:typeof window=="object"&&(o.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var c=r("crypto");if(typeof c.randomBytes!="function")throw new Error("Not supported");o.prototype._rand=function(d){return c.randomBytes(d)}}catch{}},{crypto:188}],188:[function(r,s,a){},{}],189:[function(r,s,a){var i=r("safe-buffer").Buffer;function o(f){i.isBuffer(f)||(f=i.from(f));for(var m=f.length/4|0,p=new Array(m),g=0;g<m;g++)p[g]=f.readUInt32BE(4*g);return p}function c(f){for(;0<f.length;f++)f[0]=0}function d(f,m,p,g,v){for(var x,y,b,j,T=p[0],O=p[1],R=p[2],D=p[3],L=f[0]^m[0],q=f[1]^m[1],X=f[2]^m[2],H=f[3]^m[3],M=4,F=1;F<v;F++)x=T[L>>>24]^O[q>>>16&255]^R[X>>>8&255]^D[255&H]^m[M++],y=T[q>>>24]^O[X>>>16&255]^R[H>>>8&255]^D[255&L]^m[M++],b=T[X>>>24]^O[H>>>16&255]^R[L>>>8&255]^D[255&q]^m[M++],j=T[H>>>24]^O[L>>>16&255]^R[q>>>8&255]^D[255&X]^m[M++],L=x,q=y,X=b,H=j;return x=(g[L>>>24]<<24|g[q>>>16&255]<<16|g[X>>>8&255]<<8|g[255&H])^m[M++],y=(g[q>>>24]<<24|g[X>>>16&255]<<16|g[H>>>8&255]<<8|g[255&L])^m[M++],b=(g[X>>>24]<<24|g[H>>>16&255]<<16|g[L>>>8&255]<<8|g[255&q])^m[M++],j=(g[H>>>24]<<24|g[L>>>16&255]<<16|g[q>>>8&255]<<8|g[255&X])^m[M++],[x>>>=0,y>>>=0,b>>>=0,j>>>=0]}var l=[0,1,2,4,8,16,32,64,128,27,54],u=function(){for(var f=new Array(256),m=0;m<256;m++)f[m]=m<128?m<<1:m<<1^283;for(var p=[],g=[],v=[[],[],[],[]],x=[[],[],[],[]],y=0,b=0,j=0;j<256;++j){var T=b^b<<1^b<<2^b<<3^b<<4;T=T>>>8^255&T^99,p[y]=T,g[T]=y;var O=f[y],R=f[O],D=f[R],L=257*f[T]^16843008*T;v[0][y]=L<<24|L>>>8,v[1][y]=L<<16|L>>>16,v[2][y]=L<<8|L>>>24,v[3][y]=L,L=16843009*D^65537*R^257*O^16843008*y,x[0][T]=L<<24|L>>>8,x[1][T]=L<<16|L>>>16,x[2][T]=L<<8|L>>>24,x[3][T]=L,y===0?y=b=1:(y=O^f[f[f[D^O]]],b^=f[f[b]])}return{SBOX:p,INV_SBOX:g,SUB_MIX:v,INV_SUB_MIX:x}}();function h(f){this._key=o(f),this._reset()}h.blockSize=16,h.keySize=32,h.prototype.blockSize=h.blockSize,h.prototype.keySize=h.keySize,h.prototype._reset=function(){for(var f=this._key,m=f.length,p=m+6,g=4*(p+1),v=[],x=0;x<m;x++)v[x]=f[x];for(x=m;x<g;x++){var y=v[x-1];x%m==0?(y=y<<8|y>>>24,y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y],y^=l[x/m|0]<<24):m>6&&x%m==4&&(y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y]),v[x]=v[x-m]^y}for(var b=[],j=0;j<g;j++){var T=g-j,O=v[T-(j%4?0:4)];b[j]=j<4||T<=4?O:u.INV_SUB_MIX[0][u.SBOX[O>>>24]]^u.INV_SUB_MIX[1][u.SBOX[O>>>16&255]]^u.INV_SUB_MIX[2][u.SBOX[O>>>8&255]]^u.INV_SUB_MIX[3][u.SBOX[255&O]]}this._nRounds=p,this._keySchedule=v,this._invKeySchedule=b},h.prototype.encryptBlockRaw=function(f){return d(f=o(f),this._keySchedule,u.SUB_MIX,u.SBOX,this._nRounds)},h.prototype.encryptBlock=function(f){var m=this.encryptBlockRaw(f),p=i.allocUnsafe(16);return p.writeUInt32BE(m[0],0),p.writeUInt32BE(m[1],4),p.writeUInt32BE(m[2],8),p.writeUInt32BE(m[3],12),p},h.prototype.decryptBlock=function(f){var m=(f=o(f))[1];f[1]=f[3],f[3]=m;var p=d(f,this._invKeySchedule,u.INV_SUB_MIX,u.INV_SBOX,this._nRounds),g=i.allocUnsafe(16);return g.writeUInt32BE(p[0],0),g.writeUInt32BE(p[3],4),g.writeUInt32BE(p[2],8),g.writeUInt32BE(p[1],12),g},h.prototype.scrub=function(){c(this._keySchedule),c(this._invKeySchedule),c(this._key)},s.exports.AES=h},{"safe-buffer":494}],190:[function(r,s,a){var i=r("./aes"),o=r("safe-buffer").Buffer,c=r("cipher-base"),d=r("inherits"),l=r("./ghash"),u=r("buffer-xor"),h=r("./incr32");function f(m,p,g,v){c.call(this);var x=o.alloc(4,0);this._cipher=new i.AES(p);var y=this._cipher.encryptBlock(x);this._ghash=new l(y),g=function(b,j,T){if(j.length===12)return b._finID=o.concat([j,o.from([0,0,0,1])]),o.concat([j,o.from([0,0,0,2])]);var O=new l(T),R=j.length,D=R%16;O.update(j),D&&(D=16-D,O.update(o.alloc(D,0))),O.update(o.alloc(8,0));var L=8*R,q=o.alloc(8);q.writeUIntBE(L,0,8),O.update(q),b._finID=O.state;var X=o.from(b._finID);return h(X),X}(this,g,y),this._prev=o.from(g),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=v,this._alen=0,this._len=0,this._mode=m,this._authTag=null,this._called=!1}d(f,c),f.prototype._update=function(m){if(!this._called&&this._alen){var p=16-this._alen%16;p<16&&(p=o.alloc(p,0),this._ghash.update(p))}this._called=!0;var g=this._mode.encrypt(this,m);return this._decrypt?this._ghash.update(m):this._ghash.update(g),this._len+=m.length,g},f.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var m=u(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(p,g){var v=0;p.length!==g.length&&v++;for(var x=Math.min(p.length,g.length),y=0;y<x;++y)v+=p[y]^g[y];return v}(m,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=m,this._cipher.scrub()},f.prototype.getAuthTag=function(){if(this._decrypt||!o.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},f.prototype.setAuthTag=function(m){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=m},f.prototype.setAAD=function(m){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(m),this._alen+=m.length},s.exports=f},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(r,s,a){var i=r("./encrypter"),o=r("./decrypter"),c=r("./modes/list.json");a.createCipher=a.Cipher=i.createCipher,a.createCipheriv=a.Cipheriv=i.createCipheriv,a.createDecipher=a.Decipher=o.createDecipher,a.createDecipheriv=a.Decipheriv=o.createDecipheriv,a.listCiphers=a.getCiphers=function(){return Object.keys(c)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(r,s,a){var i=r("./authCipher"),o=r("safe-buffer").Buffer,c=r("./modes"),d=r("./streamCipher"),l=r("cipher-base"),u=r("./aes"),h=r("evp_bytestokey");function f(g,v,x){l.call(this),this._cache=new m,this._last=void 0,this._cipher=new u.AES(v),this._prev=o.from(x),this._mode=g,this._autopadding=!0}function m(){this.cache=o.allocUnsafe(0)}function p(g,v,x){var y=c[g.toLowerCase()];if(!y)throw new TypeError("invalid suite type");if(typeof x=="string"&&(x=o.from(x)),y.mode!=="GCM"&&x.length!==y.iv)throw new TypeError("invalid iv length "+x.length);if(typeof v=="string"&&(v=o.from(v)),v.length!==y.key/8)throw new TypeError("invalid key length "+v.length);return y.type==="stream"?new d(y.module,v,x,!0):y.type==="auth"?new i(y.module,v,x,!0):new f(y.module,v,x)}r("inherits")(f,l),f.prototype._update=function(g){var v,x;this._cache.add(g);for(var y=[];v=this._cache.get(this._autopadding);)x=this._mode.decrypt(this,v),y.push(x);return o.concat(y)},f.prototype._final=function(){var g=this._cache.flush();if(this._autopadding)return function(v){var x=v[15];if(x<1||x>16)throw new Error("unable to decrypt data");for(var y=-1;++y<x;)if(v[y+(16-x)]!==x)throw new Error("unable to decrypt data");if(x!==16)return v.slice(0,16-x)}(this._mode.decrypt(this,g));if(g)throw new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(g){return this._autopadding=!!g,this},m.prototype.add=function(g){this.cache=o.concat([this.cache,g])},m.prototype.get=function(g){var v;if(g){if(this.cache.length>16)return v=this.cache.slice(0,16),this.cache=this.cache.slice(16),v}else if(this.cache.length>=16)return v=this.cache.slice(0,16),this.cache=this.cache.slice(16),v;return null},m.prototype.flush=function(){if(this.cache.length)return this.cache},a.createDecipher=function(g,v){var x=c[g.toLowerCase()];if(!x)throw new TypeError("invalid suite type");var y=h(v,!1,x.key,x.iv);return p(g,y.key,y.iv)},a.createDecipheriv=p},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(r,s,a){var i=r("./modes"),o=r("./authCipher"),c=r("safe-buffer").Buffer,d=r("./streamCipher"),l=r("cipher-base"),u=r("./aes"),h=r("evp_bytestokey");function f(v,x,y){l.call(this),this._cache=new p,this._cipher=new u.AES(x),this._prev=c.from(y),this._mode=v,this._autopadding=!0}r("inherits")(f,l),f.prototype._update=function(v){var x,y;this._cache.add(v);for(var b=[];x=this._cache.get();)y=this._mode.encrypt(this,x),b.push(y);return c.concat(b)};var m=c.alloc(16,16);function p(){this.cache=c.allocUnsafe(0)}function g(v,x,y){var b=i[v.toLowerCase()];if(!b)throw new TypeError("invalid suite type");if(typeof x=="string"&&(x=c.from(x)),x.length!==b.key/8)throw new TypeError("invalid key length "+x.length);if(typeof y=="string"&&(y=c.from(y)),b.mode!=="GCM"&&y.length!==b.iv)throw new TypeError("invalid iv length "+y.length);return b.type==="stream"?new d(b.module,x,y):b.type==="auth"?new o(b.module,x,y):new f(b.module,x,y)}f.prototype._final=function(){var v=this._cache.flush();if(this._autopadding)return v=this._mode.encrypt(this,v),this._cipher.scrub(),v;if(!v.equals(m))throw this._cipher.scrub(),new Error("data not multiple of block length")},f.prototype.setAutoPadding=function(v){return this._autopadding=!!v,this},p.prototype.add=function(v){this.cache=c.concat([this.cache,v])},p.prototype.get=function(){if(this.cache.length>15){var v=this.cache.slice(0,16);return this.cache=this.cache.slice(16),v}return null},p.prototype.flush=function(){for(var v=16-this.cache.length,x=c.allocUnsafe(v),y=-1;++y<v;)x.writeUInt8(v,y);return c.concat([this.cache,x])},a.createCipheriv=g,a.createCipher=function(v,x){var y=i[v.toLowerCase()];if(!y)throw new TypeError("invalid suite type");var b=h(x,!1,y.key,y.iv);return g(v,b.key,b.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(r,s,a){var i=r("safe-buffer").Buffer,o=i.alloc(16,0);function c(l){var u=i.allocUnsafe(16);return u.writeUInt32BE(l[0]>>>0,0),u.writeUInt32BE(l[1]>>>0,4),u.writeUInt32BE(l[2]>>>0,8),u.writeUInt32BE(l[3]>>>0,12),u}function d(l){this.h=l,this.state=i.alloc(16,0),this.cache=i.allocUnsafe(0)}d.prototype.ghash=function(l){for(var u=-1;++u<l.length;)this.state[u]^=l[u];this._multiply()},d.prototype._multiply=function(){for(var l,u,h,f=[(l=this.h).readUInt32BE(0),l.readUInt32BE(4),l.readUInt32BE(8),l.readUInt32BE(12)],m=[0,0,0,0],p=-1;++p<128;){for(this.state[~~(p/8)]&1<<7-p%8&&(m[0]^=f[0],m[1]^=f[1],m[2]^=f[2],m[3]^=f[3]),h=(1&f[3])!=0,u=3;u>0;u--)f[u]=f[u]>>>1|(1&f[u-1])<<31;f[0]=f[0]>>>1,h&&(f[0]=f[0]^225<<24)}this.state=c(m)},d.prototype.update=function(l){var u;for(this.cache=i.concat([this.cache,l]);this.cache.length>=16;)u=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(u)},d.prototype.final=function(l,u){return this.cache.length&&this.ghash(i.concat([this.cache,o],16)),this.ghash(c([0,l,0,u])),this.state},s.exports=d},{"safe-buffer":494}],195:[function(r,s,a){s.exports=function(i){for(var o,c=i.length;c--;){if((o=i.readUInt8(c))!==255){o++,i.writeUInt8(o,c);break}i.writeUInt8(0,c)}}},{}],196:[function(r,s,a){var i=r("buffer-xor");a.encrypt=function(o,c){var d=i(c,o._prev);return o._prev=o._cipher.encryptBlock(d),o._prev},a.decrypt=function(o,c){var d=o._prev;o._prev=c;var l=o._cipher.decryptBlock(c);return i(l,d)}},{"buffer-xor":219}],197:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("buffer-xor");function c(d,l,u){var h=l.length,f=o(l,d._cache);return d._cache=d._cache.slice(h),d._prev=i.concat([d._prev,u?l:f]),f}a.encrypt=function(d,l,u){for(var h,f=i.allocUnsafe(0);l.length;){if(d._cache.length===0&&(d._cache=d._cipher.encryptBlock(d._prev),d._prev=i.allocUnsafe(0)),!(d._cache.length<=l.length)){f=i.concat([f,c(d,l,u)]);break}h=d._cache.length,f=i.concat([f,c(d,l.slice(0,h),u)]),l=l.slice(h)}return f}},{"buffer-xor":219,"safe-buffer":494}],198:[function(r,s,a){var i=r("safe-buffer").Buffer;function o(d,l,u){for(var h,f,m=-1,p=0;++m<8;)h=l&1<<7-m?128:0,p+=(128&(f=d._cipher.encryptBlock(d._prev)[0]^h))>>m%8,d._prev=c(d._prev,u?h:f);return p}function c(d,l){var u=d.length,h=-1,f=i.allocUnsafe(d.length);for(d=i.concat([d,i.from([l])]);++h<u;)f[h]=d[h]<<1|d[h+1]>>7;return f}a.encrypt=function(d,l,u){for(var h=l.length,f=i.allocUnsafe(h),m=-1;++m<h;)f[m]=o(d,l[m],u);return f}},{"safe-buffer":494}],199:[function(r,s,a){var i=r("safe-buffer").Buffer;function o(c,d,l){var u=c._cipher.encryptBlock(c._prev)[0]^d;return c._prev=i.concat([c._prev.slice(1),i.from([l?d:u])]),u}a.encrypt=function(c,d,l){for(var u=d.length,h=i.allocUnsafe(u),f=-1;++f<u;)h[f]=o(c,d[f],l);return h}},{"safe-buffer":494}],200:[function(r,s,a){var i=r("buffer-xor"),o=r("safe-buffer").Buffer,c=r("../incr32");function d(l){var u=l._cipher.encryptBlockRaw(l._prev);return c(l._prev),u}a.encrypt=function(l,u){var h=Math.ceil(u.length/16),f=l._cache.length;l._cache=o.concat([l._cache,o.allocUnsafe(16*h)]);for(var m=0;m<h;m++){var p=d(l),g=f+16*m;l._cache.writeUInt32BE(p[0],g+0),l._cache.writeUInt32BE(p[1],g+4),l._cache.writeUInt32BE(p[2],g+8),l._cache.writeUInt32BE(p[3],g+12)}var v=l._cache.slice(0,u.length);return l._cache=l._cache.slice(u.length),i(u,v)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(r,s,a){a.encrypt=function(i,o){return i._cipher.encryptBlock(o)},a.decrypt=function(i,o){return i._cipher.decryptBlock(o)}},{}],202:[function(r,s,a){var i={ECB:r("./ecb"),CBC:r("./cbc"),CFB:r("./cfb"),CFB8:r("./cfb8"),CFB1:r("./cfb1"),OFB:r("./ofb"),CTR:r("./ctr"),GCM:r("./ctr")},o=r("./list.json");for(var c in o)o[c].module=i[o[c].mode];s.exports=o},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(r,s,a){s.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(r,s,a){(function(i){(function(){var o=r("buffer-xor");function c(d){return d._prev=d._cipher.encryptBlock(d._prev),d._prev}a.encrypt=function(d,l){for(;d._cache.length<l.length;)d._cache=i.concat([d._cache,c(d)]);var u=d._cache.slice(0,l.length);return d._cache=d._cache.slice(l.length),o(l,u)}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(r,s,a){var i=r("./aes"),o=r("safe-buffer").Buffer,c=r("cipher-base");function d(l,u,h,f){c.call(this),this._cipher=new i.AES(u),this._prev=o.from(h),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=f,this._mode=l}r("inherits")(d,c),d.prototype._update=function(l){return this._mode.encrypt(this,l,this._decrypt)},d.prototype._final=function(){this._cipher.scrub()},s.exports=d},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(r,s,a){var i=r("browserify-des"),o=r("browserify-aes/browser"),c=r("browserify-aes/modes"),d=r("browserify-des/modes"),l=r("evp_bytestokey");function u(f,m,p){if(f=f.toLowerCase(),c[f])return o.createCipheriv(f,m,p);if(d[f])return new i({key:m,iv:p,mode:f});throw new TypeError("invalid suite type")}function h(f,m,p){if(f=f.toLowerCase(),c[f])return o.createDecipheriv(f,m,p);if(d[f])return new i({key:m,iv:p,mode:f,decrypt:!0});throw new TypeError("invalid suite type")}a.createCipher=a.Cipher=function(f,m){var p,g;if(f=f.toLowerCase(),c[f])p=c[f].key,g=c[f].iv;else{if(!d[f])throw new TypeError("invalid suite type");p=8*d[f].key,g=d[f].iv}var v=l(m,!1,p,g);return u(f,v.key,v.iv)},a.createCipheriv=a.Cipheriv=u,a.createDecipher=a.Decipher=function(f,m){var p,g;if(f=f.toLowerCase(),c[f])p=c[f].key,g=c[f].iv;else{if(!d[f])throw new TypeError("invalid suite type");p=8*d[f].key,g=d[f].iv}var v=l(m,!1,p,g);return h(f,v.key,v.iv)},a.createDecipheriv=a.Decipheriv=h,a.listCiphers=a.getCiphers=function(){return Object.keys(d).concat(o.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(r,s,a){var i=r("cipher-base"),o=r("des.js"),c=r("inherits"),d=r("safe-buffer").Buffer,l={"des-ede3-cbc":o.CBC.instantiate(o.EDE),"des-ede3":o.EDE,"des-ede-cbc":o.CBC.instantiate(o.EDE),"des-ede":o.EDE,"des-cbc":o.CBC.instantiate(o.DES),"des-ecb":o.DES};function u(h){i.call(this);var f,m=h.mode.toLowerCase(),p=l[m];f=h.decrypt?"decrypt":"encrypt";var g=h.key;d.isBuffer(g)||(g=d.from(g)),m!=="des-ede"&&m!=="des-ede-cbc"||(g=d.concat([g,g.slice(0,8)]));var v=h.iv;d.isBuffer(v)||(v=d.from(v)),this._des=p.create({key:g,iv:v,type:f})}l.des=l["des-cbc"],l.des3=l["des-ede3-cbc"],s.exports=u,c(u,i),u.prototype._update=function(h){return d.from(this._des.update(h))},u.prototype._final=function(){return d.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(r,s,a){a["des-ecb"]={key:8,iv:0},a["des-cbc"]=a.des={key:8,iv:8},a["des-ede3-cbc"]=a.des3={key:24,iv:8},a["des-ede3"]={key:24,iv:0},a["des-ede-cbc"]={key:16,iv:8},a["des-ede"]={key:16,iv:0}},{}],209:[function(r,s,a){(function(i){(function(){var o=r("bn.js"),c=r("randombytes");function d(u){var h,f=u.modulus.byteLength();do h=new o(c(f));while(h.cmp(u.modulus)>=0||!h.umod(u.prime1)||!h.umod(u.prime2));return h}function l(u,h){var f=function(R){var D=d(R);return{blinder:D.toRed(o.mont(R.modulus)).redPow(new o(R.publicExponent)).fromRed(),unblinder:D.invm(R.modulus)}}(h),m=h.modulus.byteLength(),p=new o(u).mul(f.blinder).umod(h.modulus),g=p.toRed(o.mont(h.prime1)),v=p.toRed(o.mont(h.prime2)),x=h.coefficient,y=h.prime1,b=h.prime2,j=g.redPow(h.exponent1).fromRed(),T=v.redPow(h.exponent2).fromRed(),O=j.isub(T).imul(x).umod(y).imul(b);return T.iadd(O).imul(f.unblinder).umod(h.modulus).toArrayLike(i,"be",m)}l.getr=d,s.exports=l}).call(this)}).call(this,r("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(r,s,a){s.exports=r("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(r,s,a){s.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(r,s,a){s.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("create-hash"),c=r("readable-stream"),d=r("inherits"),l=r("./sign"),u=r("./verify"),h=r("./algorithms.json");function f(v){c.Writable.call(this);var x=h[v];if(!x)throw new Error("Unknown message digest");this._hashType=x.hash,this._hash=o(x.hash),this._tag=x.id,this._signType=x.sign}function m(v){c.Writable.call(this);var x=h[v];if(!x)throw new Error("Unknown message digest");this._hash=o(x.hash),this._tag=x.id,this._signType=x.sign}function p(v){return new f(v)}function g(v){return new m(v)}Object.keys(h).forEach(function(v){h[v].id=i.from(h[v].id,"hex"),h[v.toLowerCase()]=h[v]}),d(f,c.Writable),f.prototype._write=function(v,x,y){this._hash.update(v),y()},f.prototype.update=function(v,x){return typeof v=="string"&&(v=i.from(v,x)),this._hash.update(v),this},f.prototype.sign=function(v,x){this.end();var y=this._hash.digest(),b=l(y,v,this._hashType,this._signType,this._tag);return x?b.toString(x):b},d(m,c.Writable),m.prototype._write=function(v,x,y){this._hash.update(v),y()},m.prototype.update=function(v,x){return typeof v=="string"&&(v=i.from(v,x)),this._hash.update(v),this},m.prototype.verify=function(v,x,y){typeof x=="string"&&(x=i.from(x,y)),this.end();var b=this._hash.digest();return u(x,b,v,this._signType,this._tag)},s.exports={Sign:p,Verify:g,createSign:p,createVerify:g}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("create-hmac"),c=r("browserify-rsa"),d=r("elliptic").ec,l=r("bn.js"),u=r("parse-asn1"),h=r("./curves.json");function f(v,x,y,b){if((v=i.from(v.toArray())).length<x.byteLength()){var j=i.alloc(x.byteLength()-v.length);v=i.concat([j,v])}var T=y.length,O=function(L,q){L=(L=m(L,q)).mod(q);var X=i.from(L.toArray());if(X.length<q.byteLength()){var H=i.alloc(q.byteLength()-X.length);X=i.concat([H,X])}return X}(y,x),R=i.alloc(T);R.fill(1);var D=i.alloc(T);return D=o(b,D).update(R).update(i.from([0])).update(v).update(O).digest(),R=o(b,D).update(R).digest(),{k:D=o(b,D).update(R).update(i.from([1])).update(v).update(O).digest(),v:R=o(b,D).update(R).digest()}}function m(v,x){var y=new l(v),b=(v.length<<3)-x.bitLength();return b>0&&y.ishrn(b),y}function p(v,x,y){var b,j;do{for(b=i.alloc(0);8*b.length<v.bitLength();)x.v=o(y,x.k).update(x.v).digest(),b=i.concat([b,x.v]);j=m(b,v),x.k=o(y,x.k).update(x.v).update(i.from([0])).digest(),x.v=o(y,x.k).update(x.v).digest()}while(j.cmp(v)!==-1);return j}function g(v,x,y,b){return v.toRed(l.mont(y)).redPow(x).fromRed().mod(b)}s.exports=function(v,x,y,b,j){var T=u(x);if(T.curve){if(b!=="ecdsa"&&b!=="ecdsa/rsa")throw new Error("wrong private key type");return function(L,q){var X=h[q.curve.join(".")];if(!X)throw new Error("unknown curve "+q.curve.join("."));var H=new d(X).keyFromPrivate(q.privateKey).sign(L);return i.from(H.toDER())}(v,T)}if(T.type==="dsa"){if(b!=="dsa")throw new Error("wrong private key type");return function(L,q,X){for(var H,M=q.params.priv_key,F=q.params.p,S=q.params.q,E=q.params.g,N=new l(0),C=m(L,S).mod(S),k=!1,I=f(M,S,L,X);k===!1;)H=p(S,I,X),N=g(E,H,F,S),(k=H.invm(S).imul(C.add(M.mul(N))).mod(S)).cmpn(0)===0&&(k=!1,N=new l(0));return function(U,$){U=U.toArray(),$=$.toArray(),128&U[0]&&(U=[0].concat(U)),128&$[0]&&($=[0].concat($));var Y=[48,U.length+$.length+4,2,U.length];return Y=Y.concat(U,[2,$.length],$),i.from(Y)}(N,k)}(v,T,y)}if(b!=="rsa"&&b!=="ecdsa/rsa")throw new Error("wrong private key type");v=i.concat([j,v]);for(var O=T.modulus.byteLength(),R=[0,1];v.length+R.length+1<O;)R.push(255);R.push(0);for(var D=-1;++D<v.length;)R.push(v[D]);return c(R,T)},s.exports.getKey=f,s.exports.makeKey=p},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("bn.js"),c=r("elliptic").ec,d=r("parse-asn1"),l=r("./curves.json");function u(h,f){if(h.cmpn(0)<=0)throw new Error("invalid sig");if(h.cmp(f)>=f)throw new Error("invalid sig")}s.exports=function(h,f,m,p,g){var v=d(m);if(v.type==="ec"){if(p!=="ecdsa"&&p!=="ecdsa/rsa")throw new Error("wrong public key type");return function(R,D,L){var q=l[L.data.algorithm.curve.join(".")];if(!q)throw new Error("unknown curve "+L.data.algorithm.curve.join("."));var X=new c(q),H=L.data.subjectPrivateKey.data;return X.verify(D,R,H)}(h,f,v)}if(v.type==="dsa"){if(p!=="dsa")throw new Error("wrong public key type");return function(R,D,L){var q=L.data.p,X=L.data.q,H=L.data.g,M=L.data.pub_key,F=d.signature.decode(R,"der"),S=F.s,E=F.r;u(S,X),u(E,X);var N=o.mont(q),C=S.invm(X);return H.toRed(N).redPow(new o(D).mul(C).mod(X)).fromRed().mul(M.toRed(N).redPow(E.mul(C).mod(X)).fromRed()).mod(q).mod(X).cmp(E)===0}(h,f,v)}if(p!=="rsa"&&p!=="ecdsa/rsa")throw new Error("wrong public key type");f=i.concat([g,f]);for(var x=v.modulus.byteLength(),y=[1],b=0;f.length+y.length+2<x;)y.push(255),b++;y.push(0);for(var j=-1;++j<f.length;)y.push(f[j]);y=i.from(y);var T=o.mont(v.modulus);h=(h=new o(h).toRed(T)).redPow(new o(v.publicExponent)),h=i.from(h.fromRed().toArray());var O=b<8?1:0;for(x=Math.min(h.length,y.length),h.length!==y.length&&(O=1),j=-1;++j<x;)O|=h[j]^y[j];return O===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(r,s,a){},{}],217:[function(r,s,a){var i=r("buffer"),o=i.Buffer;function c(l,u){for(var h in l)u[h]=l[h]}function d(l,u,h){return o(l,u,h)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?s.exports=i:(c(i,a),a.Buffer=d),c(o,d),d.from=function(l,u,h){if(typeof l=="number")throw new TypeError("Argument must not be a number");return o(l,u,h)},d.alloc=function(l,u,h){if(typeof l!="number")throw new TypeError("Argument must be a number");var f=o(l);return u!==void 0?typeof h=="string"?f.fill(u,h):f.fill(u):f.fill(0),f},d.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return o(l)},d.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return i.SlowBuffer(l)}},{buffer:220}],218:[function(r,s,a){var i=r("safe-buffer").Buffer,o=i.isEncoding||function(v){switch((v=""+v)&&v.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function c(v){var x;switch(this.encoding=function(y){var b=function(j){if(!j)return"utf8";for(var T;;)switch(j){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return j;default:if(T)return;j=(""+j).toLowerCase(),T=!0}}(y);if(typeof b!="string"&&(i.isEncoding===o||!o(y)))throw new Error("Unknown encoding: "+y);return b||y}(v),this.encoding){case"utf16le":this.text=u,this.end=h,x=4;break;case"utf8":this.fillLast=l,x=4;break;case"base64":this.text=f,this.end=m,x=3;break;default:return this.write=p,void(this.end=g)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(x)}function d(v){return v<=127?0:v>>5==6?2:v>>4==14?3:v>>3==30?4:v>>6==2?-1:-2}function l(v){var x=this.lastTotal-this.lastNeed,y=function(b,j,T){if((192&j[0])!=128)return b.lastNeed=0,"";if(b.lastNeed>1&&j.length>1){if((192&j[1])!=128)return b.lastNeed=1,"";if(b.lastNeed>2&&j.length>2&&(192&j[2])!=128)return b.lastNeed=2,""}}(this,v);return y!==void 0?y:this.lastNeed<=v.length?(v.copy(this.lastChar,x,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(v.copy(this.lastChar,x,0,v.length),void(this.lastNeed-=v.length))}function u(v,x){if((v.length-x)%2==0){var y=v.toString("utf16le",x);if(y){var b=y.charCodeAt(y.length-1);if(b>=55296&&b<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1],y.slice(0,-1)}return y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=v[v.length-1],v.toString("utf16le",x,v.length-1)}function h(v){var x=v&&v.length?this.write(v):"";if(this.lastNeed){var y=this.lastTotal-this.lastNeed;return x+this.lastChar.toString("utf16le",0,y)}return x}function f(v,x){var y=(v.length-x)%3;return y===0?v.toString("base64",x):(this.lastNeed=3-y,this.lastTotal=3,y===1?this.lastChar[0]=v[v.length-1]:(this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1]),v.toString("base64",x,v.length-y))}function m(v){var x=v&&v.length?this.write(v):"";return this.lastNeed?x+this.lastChar.toString("base64",0,3-this.lastNeed):x}function p(v){return v.toString(this.encoding)}function g(v){return v&&v.length?this.write(v):""}a.StringDecoder=c,c.prototype.write=function(v){if(v.length===0)return"";var x,y;if(this.lastNeed){if((x=this.fillLast(v))===void 0)return"";y=this.lastNeed,this.lastNeed=0}else y=0;return y<v.length?x?x+this.text(v,y):this.text(v,y):x||""},c.prototype.end=function(v){var x=v&&v.length?this.write(v):"";return this.lastNeed?x+"":x},c.prototype.text=function(v,x){var y=function(j,T,O){var R=T.length-1;if(R<O)return 0;var D=d(T[R]);return D>=0?(D>0&&(j.lastNeed=D-1),D):--R<O||D===-2?0:(D=d(T[R]))>=0?(D>0&&(j.lastNeed=D-2),D):--R<O||D===-2?0:(D=d(T[R]))>=0?(D>0&&(D===2?D=0:j.lastNeed=D-3),D):0}(this,v,x);if(!this.lastNeed)return v.toString("utf8",x);this.lastTotal=y;var b=v.length-(y-this.lastNeed);return v.copy(this.lastChar,0,b),v.toString("utf8",x,b)},c.prototype.fillLast=function(v){if(this.lastNeed<=v.length)return v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,v.length),this.lastNeed-=v.length}},{"safe-buffer":217}],219:[function(r,s,a){(function(i){(function(){s.exports=function(o,c){for(var d=Math.min(o.length,c.length),l=new i(d),u=0;u<d;++u)l[u]=o[u]^c[u];return l}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220}],220:[function(r,s,a){(function(i){(function(){var o=r("base64-js"),c=r("ieee754");a.Buffer=l,a.SlowBuffer=function(V){return+V!=V&&(V=0),l.alloc(+V)},a.INSPECT_MAX_BYTES=50;function d(V){if(V>2147483647)throw new RangeError('The value "'+V+'" is invalid for option "size"');var W=new Uint8Array(V);return W.__proto__=l.prototype,W}function l(V,W,ee){if(typeof V=="number"){if(typeof W=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(V)}return u(V,W,ee)}function u(V,W,ee){if(typeof V=="string")return function(se,le){if(typeof le=="string"&&le!==""||(le="utf8"),!l.isEncoding(le))throw new TypeError("Unknown encoding: "+le);var ye=0|g(se,le),ue=d(ye),ne=ue.write(se,le);return ne!==ye&&(ue=ue.slice(0,ne)),ue}(V,W);if(ArrayBuffer.isView(V))return m(V);if(V==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V);if(G(V,ArrayBuffer)||V&&G(V.buffer,ArrayBuffer))return function(se,le,ye){if(le<0||se.byteLength<le)throw new RangeError('"offset" is outside of buffer bounds');if(se.byteLength<le+(ye||0))throw new RangeError('"length" is outside of buffer bounds');var ue;return ue=le===void 0&&ye===void 0?new Uint8Array(se):ye===void 0?new Uint8Array(se,le):new Uint8Array(se,le,ye),ue.__proto__=l.prototype,ue}(V,W,ee);if(typeof V=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ie=V.valueOf&&V.valueOf();if(ie!=null&&ie!==V)return l.from(ie,W,ee);var oe=function(se){if(l.isBuffer(se)){var le=0|p(se.length),ye=d(le);return ye.length===0||se.copy(ye,0,0,le),ye}if(se.length!==void 0)return typeof se.length!="number"||J(se.length)?d(0):m(se);if(se.type==="Buffer"&&Array.isArray(se.data))return m(se.data)}(V);if(oe)return oe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof V[Symbol.toPrimitive]=="function")return l.from(V[Symbol.toPrimitive]("string"),W,ee);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V)}function h(V){if(typeof V!="number")throw new TypeError('"size" argument must be of type number');if(V<0)throw new RangeError('The value "'+V+'" is invalid for option "size"')}function f(V){return h(V),d(V<0?0:0|p(V))}function m(V){for(var W=V.length<0?0:0|p(V.length),ee=d(W),ie=0;ie<W;ie+=1)ee[ie]=255&V[ie];return ee}function p(V){if(V>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|V}function g(V,W){if(l.isBuffer(V))return V.length;if(ArrayBuffer.isView(V)||G(V,ArrayBuffer))return V.byteLength;if(typeof V!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof V);var ee=V.length,ie=arguments.length>2&&arguments[2]===!0;if(!ie&&ee===0)return 0;for(var oe=!1;;)switch(W){case"ascii":case"latin1":case"binary":return ee;case"utf8":case"utf-8":return Y(V).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*ee;case"hex":return ee>>>1;case"base64":return Z(V).length;default:if(oe)return ie?-1:Y(V).length;W=(""+W).toLowerCase(),oe=!0}}function v(V,W,ee){var ie=!1;if((W===void 0||W<0)&&(W=0),W>this.length||((ee===void 0||ee>this.length)&&(ee=this.length),ee<=0)||(ee>>>=0)<=(W>>>=0))return"";for(V||(V="utf8");;)switch(V){case"hex":return F(this,W,ee);case"utf8":case"utf-8":return X(this,W,ee);case"ascii":return H(this,W,ee);case"latin1":case"binary":return M(this,W,ee);case"base64":return q(this,W,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,W,ee);default:if(ie)throw new TypeError("Unknown encoding: "+V);V=(V+"").toLowerCase(),ie=!0}}function x(V,W,ee){var ie=V[W];V[W]=V[ee],V[ee]=ie}function y(V,W,ee,ie,oe){if(V.length===0)return-1;if(typeof ee=="string"?(ie=ee,ee=0):ee>2147483647?ee=2147483647:ee<-2147483648&&(ee=-2147483648),J(ee=+ee)&&(ee=oe?0:V.length-1),ee<0&&(ee=V.length+ee),ee>=V.length){if(oe)return-1;ee=V.length-1}else if(ee<0){if(!oe)return-1;ee=0}if(typeof W=="string"&&(W=l.from(W,ie)),l.isBuffer(W))return W.length===0?-1:b(V,W,ee,ie,oe);if(typeof W=="number")return W&=255,typeof Uint8Array.prototype.indexOf=="function"?oe?Uint8Array.prototype.indexOf.call(V,W,ee):Uint8Array.prototype.lastIndexOf.call(V,W,ee):b(V,[W],ee,ie,oe);throw new TypeError("val must be string, number or Buffer")}function b(V,W,ee,ie,oe){var se,le=1,ye=V.length,ue=W.length;if(ie!==void 0&&((ie=String(ie).toLowerCase())==="ucs2"||ie==="ucs-2"||ie==="utf16le"||ie==="utf-16le")){if(V.length<2||W.length<2)return-1;le=2,ye/=2,ue/=2,ee/=2}function ne(_e,be){return le===1?_e[be]:_e.readUInt16BE(be*le)}if(oe){var pe=-1;for(se=ee;se<ye;se++)if(ne(V,se)===ne(W,pe===-1?0:se-pe)){if(pe===-1&&(pe=se),se-pe+1===ue)return pe*le}else pe!==-1&&(se-=se-pe),pe=-1}else for(ee+ue>ye&&(ee=ye-ue),se=ee;se>=0;se--){for(var ge=!0,Ne=0;Ne<ue;Ne++)if(ne(V,se+Ne)!==ne(W,Ne)){ge=!1;break}if(ge)return se}return-1}function j(V,W,ee,ie){ee=Number(ee)||0;var oe=V.length-ee;ie?(ie=Number(ie))>oe&&(ie=oe):ie=oe;var se=W.length;ie>se/2&&(ie=se/2);for(var le=0;le<ie;++le){var ye=parseInt(W.substr(2*le,2),16);if(J(ye))return le;V[ee+le]=ye}return le}function T(V,W,ee,ie){return re(Y(W,V.length-ee),V,ee,ie)}function O(V,W,ee,ie){return re(function(oe){for(var se=[],le=0;le<oe.length;++le)se.push(255&oe.charCodeAt(le));return se}(W),V,ee,ie)}function R(V,W,ee,ie){return O(V,W,ee,ie)}function D(V,W,ee,ie){return re(Z(W),V,ee,ie)}function L(V,W,ee,ie){return re(function(oe,se){for(var le,ye,ue,ne=[],pe=0;pe<oe.length&&!((se-=2)<0);++pe)le=oe.charCodeAt(pe),ye=le>>8,ue=le%256,ne.push(ue),ne.push(ye);return ne}(W,V.length-ee),V,ee,ie)}function q(V,W,ee){return W===0&&ee===V.length?o.fromByteArray(V):o.fromByteArray(V.slice(W,ee))}function X(V,W,ee){ee=Math.min(V.length,ee);for(var ie=[],oe=W;oe<ee;){var se,le,ye,ue,ne=V[oe],pe=null,ge=ne>239?4:ne>223?3:ne>191?2:1;if(oe+ge<=ee)switch(ge){case 1:ne<128&&(pe=ne);break;case 2:(192&(se=V[oe+1]))==128&&(ue=(31&ne)<<6|63&se)>127&&(pe=ue);break;case 3:se=V[oe+1],le=V[oe+2],(192&se)==128&&(192&le)==128&&(ue=(15&ne)<<12|(63&se)<<6|63&le)>2047&&(ue<55296||ue>57343)&&(pe=ue);break;case 4:se=V[oe+1],le=V[oe+2],ye=V[oe+3],(192&se)==128&&(192&le)==128&&(192&ye)==128&&(ue=(15&ne)<<18|(63&se)<<12|(63&le)<<6|63&ye)>65535&&ue<1114112&&(pe=ue)}pe===null?(pe=65533,ge=1):pe>65535&&(pe-=65536,ie.push(pe>>>10&1023|55296),pe=56320|1023&pe),ie.push(pe),oe+=ge}return function(Ne){var _e=Ne.length;if(_e<=4096)return String.fromCharCode.apply(String,Ne);for(var be="",Me=0;Me<_e;)be+=String.fromCharCode.apply(String,Ne.slice(Me,Me+=4096));return be}(ie)}a.kMaxLength=2147483647,l.TYPED_ARRAY_SUPPORT=function(){try{var V=new Uint8Array(1);return V.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},V.foo()===42}catch{return!1}}(),l.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),l.poolSize=8192,l.from=function(V,W,ee){return u(V,W,ee)},l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,l.alloc=function(V,W,ee){return function(ie,oe,se){return h(ie),ie<=0?d(ie):oe!==void 0?typeof se=="string"?d(ie).fill(oe,se):d(ie).fill(oe):d(ie)}(V,W,ee)},l.allocUnsafe=function(V){return f(V)},l.allocUnsafeSlow=function(V){return f(V)},l.isBuffer=function(V){return V!=null&&V._isBuffer===!0&&V!==l.prototype},l.compare=function(V,W){if(G(V,Uint8Array)&&(V=l.from(V,V.offset,V.byteLength)),G(W,Uint8Array)&&(W=l.from(W,W.offset,W.byteLength)),!l.isBuffer(V)||!l.isBuffer(W))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(V===W)return 0;for(var ee=V.length,ie=W.length,oe=0,se=Math.min(ee,ie);oe<se;++oe)if(V[oe]!==W[oe]){ee=V[oe],ie=W[oe];break}return ee<ie?-1:ie<ee?1:0},l.isEncoding=function(V){switch(String(V).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(V,W){if(!Array.isArray(V))throw new TypeError('"list" argument must be an Array of Buffers');if(V.length===0)return l.alloc(0);var ee;if(W===void 0)for(W=0,ee=0;ee<V.length;++ee)W+=V[ee].length;var ie=l.allocUnsafe(W),oe=0;for(ee=0;ee<V.length;++ee){var se=V[ee];if(G(se,Uint8Array)&&(se=l.from(se)),!l.isBuffer(se))throw new TypeError('"list" argument must be an Array of Buffers');se.copy(ie,oe),oe+=se.length}return ie},l.byteLength=g,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var V=this.length;if(V%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var W=0;W<V;W+=2)x(this,W,W+1);return this},l.prototype.swap32=function(){var V=this.length;if(V%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var W=0;W<V;W+=4)x(this,W,W+3),x(this,W+1,W+2);return this},l.prototype.swap64=function(){var V=this.length;if(V%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var W=0;W<V;W+=8)x(this,W,W+7),x(this,W+1,W+6),x(this,W+2,W+5),x(this,W+3,W+4);return this},l.prototype.toString=function(){var V=this.length;return V===0?"":arguments.length===0?X(this,0,V):v.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(V){if(!l.isBuffer(V))throw new TypeError("Argument must be a Buffer");return this===V||l.compare(this,V)===0},l.prototype.inspect=function(){var V="",W=a.INSPECT_MAX_BYTES;return V=this.toString("hex",0,W).replace(/(.{2})/g,"$1 ").trim(),this.length>W&&(V+=" ... "),"<Buffer "+V+">"},l.prototype.compare=function(V,W,ee,ie,oe){if(G(V,Uint8Array)&&(V=l.from(V,V.offset,V.byteLength)),!l.isBuffer(V))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof V);if(W===void 0&&(W=0),ee===void 0&&(ee=V?V.length:0),ie===void 0&&(ie=0),oe===void 0&&(oe=this.length),W<0||ee>V.length||ie<0||oe>this.length)throw new RangeError("out of range index");if(ie>=oe&&W>=ee)return 0;if(ie>=oe)return-1;if(W>=ee)return 1;if(this===V)return 0;for(var se=(oe>>>=0)-(ie>>>=0),le=(ee>>>=0)-(W>>>=0),ye=Math.min(se,le),ue=this.slice(ie,oe),ne=V.slice(W,ee),pe=0;pe<ye;++pe)if(ue[pe]!==ne[pe]){se=ue[pe],le=ne[pe];break}return se<le?-1:le<se?1:0},l.prototype.includes=function(V,W,ee){return this.indexOf(V,W,ee)!==-1},l.prototype.indexOf=function(V,W,ee){return y(this,V,W,ee,!0)},l.prototype.lastIndexOf=function(V,W,ee){return y(this,V,W,ee,!1)},l.prototype.write=function(V,W,ee,ie){if(W===void 0)ie="utf8",ee=this.length,W=0;else if(ee===void 0&&typeof W=="string")ie=W,ee=this.length,W=0;else{if(!isFinite(W))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");W>>>=0,isFinite(ee)?(ee>>>=0,ie===void 0&&(ie="utf8")):(ie=ee,ee=void 0)}var oe=this.length-W;if((ee===void 0||ee>oe)&&(ee=oe),V.length>0&&(ee<0||W<0)||W>this.length)throw new RangeError("Attempt to write outside buffer bounds");ie||(ie="utf8");for(var se=!1;;)switch(ie){case"hex":return j(this,V,W,ee);case"utf8":case"utf-8":return T(this,V,W,ee);case"ascii":return O(this,V,W,ee);case"latin1":case"binary":return R(this,V,W,ee);case"base64":return D(this,V,W,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,V,W,ee);default:if(se)throw new TypeError("Unknown encoding: "+ie);ie=(""+ie).toLowerCase(),se=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function H(V,W,ee){var ie="";ee=Math.min(V.length,ee);for(var oe=W;oe<ee;++oe)ie+=String.fromCharCode(127&V[oe]);return ie}function M(V,W,ee){var ie="";ee=Math.min(V.length,ee);for(var oe=W;oe<ee;++oe)ie+=String.fromCharCode(V[oe]);return ie}function F(V,W,ee){var ie=V.length;(!W||W<0)&&(W=0),(!ee||ee<0||ee>ie)&&(ee=ie);for(var oe="",se=W;se<ee;++se)oe+=$(V[se]);return oe}function S(V,W,ee){for(var ie=V.slice(W,ee),oe="",se=0;se<ie.length;se+=2)oe+=String.fromCharCode(ie[se]+256*ie[se+1]);return oe}function E(V,W,ee){if(V%1!=0||V<0)throw new RangeError("offset is not uint");if(V+W>ee)throw new RangeError("Trying to access beyond buffer length")}function N(V,W,ee,ie,oe,se){if(!l.isBuffer(V))throw new TypeError('"buffer" argument must be a Buffer instance');if(W>oe||W<se)throw new RangeError('"value" argument is out of bounds');if(ee+ie>V.length)throw new RangeError("Index out of range")}function C(V,W,ee,ie,oe,se){if(ee+ie>V.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("Index out of range")}function k(V,W,ee,ie,oe){return W=+W,ee>>>=0,oe||C(V,0,ee,4),c.write(V,W,ee,ie,23,4),ee+4}function I(V,W,ee,ie,oe){return W=+W,ee>>>=0,oe||C(V,0,ee,8),c.write(V,W,ee,ie,52,8),ee+8}l.prototype.slice=function(V,W){var ee=this.length;(V=~~V)<0?(V+=ee)<0&&(V=0):V>ee&&(V=ee),(W=W===void 0?ee:~~W)<0?(W+=ee)<0&&(W=0):W>ee&&(W=ee),W<V&&(W=V);var ie=this.subarray(V,W);return ie.__proto__=l.prototype,ie},l.prototype.readUIntLE=function(V,W,ee){V>>>=0,W>>>=0,ee||E(V,W,this.length);for(var ie=this[V],oe=1,se=0;++se<W&&(oe*=256);)ie+=this[V+se]*oe;return ie},l.prototype.readUIntBE=function(V,W,ee){V>>>=0,W>>>=0,ee||E(V,W,this.length);for(var ie=this[V+--W],oe=1;W>0&&(oe*=256);)ie+=this[V+--W]*oe;return ie},l.prototype.readUInt8=function(V,W){return V>>>=0,W||E(V,1,this.length),this[V]},l.prototype.readUInt16LE=function(V,W){return V>>>=0,W||E(V,2,this.length),this[V]|this[V+1]<<8},l.prototype.readUInt16BE=function(V,W){return V>>>=0,W||E(V,2,this.length),this[V]<<8|this[V+1]},l.prototype.readUInt32LE=function(V,W){return V>>>=0,W||E(V,4,this.length),(this[V]|this[V+1]<<8|this[V+2]<<16)+16777216*this[V+3]},l.prototype.readUInt32BE=function(V,W){return V>>>=0,W||E(V,4,this.length),16777216*this[V]+(this[V+1]<<16|this[V+2]<<8|this[V+3])},l.prototype.readIntLE=function(V,W,ee){V>>>=0,W>>>=0,ee||E(V,W,this.length);for(var ie=this[V],oe=1,se=0;++se<W&&(oe*=256);)ie+=this[V+se]*oe;return ie>=(oe*=128)&&(ie-=Math.pow(2,8*W)),ie},l.prototype.readIntBE=function(V,W,ee){V>>>=0,W>>>=0,ee||E(V,W,this.length);for(var ie=W,oe=1,se=this[V+--ie];ie>0&&(oe*=256);)se+=this[V+--ie]*oe;return se>=(oe*=128)&&(se-=Math.pow(2,8*W)),se},l.prototype.readInt8=function(V,W){return V>>>=0,W||E(V,1,this.length),128&this[V]?-1*(255-this[V]+1):this[V]},l.prototype.readInt16LE=function(V,W){V>>>=0,W||E(V,2,this.length);var ee=this[V]|this[V+1]<<8;return 32768&ee?4294901760|ee:ee},l.prototype.readInt16BE=function(V,W){V>>>=0,W||E(V,2,this.length);var ee=this[V+1]|this[V]<<8;return 32768&ee?4294901760|ee:ee},l.prototype.readInt32LE=function(V,W){return V>>>=0,W||E(V,4,this.length),this[V]|this[V+1]<<8|this[V+2]<<16|this[V+3]<<24},l.prototype.readInt32BE=function(V,W){return V>>>=0,W||E(V,4,this.length),this[V]<<24|this[V+1]<<16|this[V+2]<<8|this[V+3]},l.prototype.readFloatLE=function(V,W){return V>>>=0,W||E(V,4,this.length),c.read(this,V,!0,23,4)},l.prototype.readFloatBE=function(V,W){return V>>>=0,W||E(V,4,this.length),c.read(this,V,!1,23,4)},l.prototype.readDoubleLE=function(V,W){return V>>>=0,W||E(V,8,this.length),c.read(this,V,!0,52,8)},l.prototype.readDoubleBE=function(V,W){return V>>>=0,W||E(V,8,this.length),c.read(this,V,!1,52,8)},l.prototype.writeUIntLE=function(V,W,ee,ie){V=+V,W>>>=0,ee>>>=0,ie||N(this,V,W,ee,Math.pow(2,8*ee)-1,0);var oe=1,se=0;for(this[W]=255&V;++se<ee&&(oe*=256);)this[W+se]=V/oe&255;return W+ee},l.prototype.writeUIntBE=function(V,W,ee,ie){V=+V,W>>>=0,ee>>>=0,ie||N(this,V,W,ee,Math.pow(2,8*ee)-1,0);var oe=ee-1,se=1;for(this[W+oe]=255&V;--oe>=0&&(se*=256);)this[W+oe]=V/se&255;return W+ee},l.prototype.writeUInt8=function(V,W,ee){return V=+V,W>>>=0,ee||N(this,V,W,1,255,0),this[W]=255&V,W+1},l.prototype.writeUInt16LE=function(V,W,ee){return V=+V,W>>>=0,ee||N(this,V,W,2,65535,0),this[W]=255&V,this[W+1]=V>>>8,W+2},l.prototype.writeUInt16BE=function(V,W,ee){return V=+V,W>>>=0,ee||N(this,V,W,2,65535,0),this[W]=V>>>8,this[W+1]=255&V,W+2},l.prototype.writeUInt32LE=function(V,W,ee){return V=+V,W>>>=0,ee||N(this,V,W,4,4294967295,0),this[W+3]=V>>>24,this[W+2]=V>>>16,this[W+1]=V>>>8,this[W]=255&V,W+4},l.prototype.writeUInt32BE=function(V,W,ee){return V=+V,W>>>=0,ee||N(this,V,W,4,4294967295,0),this[W]=V>>>24,this[W+1]=V>>>16,this[W+2]=V>>>8,this[W+3]=255&V,W+4},l.prototype.writeIntLE=function(V,W,ee,ie){if(V=+V,W>>>=0,!ie){var oe=Math.pow(2,8*ee-1);N(this,V,W,ee,oe-1,-oe)}var se=0,le=1,ye=0;for(this[W]=255&V;++se<ee&&(le*=256);)V<0&&ye===0&&this[W+se-1]!==0&&(ye=1),this[W+se]=(V/le>>0)-ye&255;return W+ee},l.prototype.writeIntBE=function(V,W,ee,ie){if(V=+V,W>>>=0,!ie){var oe=Math.pow(2,8*ee-1);N(this,V,W,ee,oe-1,-oe)}var se=ee-1,le=1,ye=0;for(this[W+se]=255&V;--se>=0&&(le*=256);)V<0&&ye===0&&this[W+se+1]!==0&&(ye=1),this[W+se]=(V/le>>0)-ye&255;return W+ee},l.prototype.writeInt8=function(V,W,ee){return V=+V,W>>>=0,ee||N(this,V,W,1,127,-128),V<0&&(V=255+V+1),this[W]=255&V,W+1},l.prototype.writeInt16LE=function(V,W,ee){return V=+V,W>>>=0,ee||N(this,V,W,2,32767,-32768),this[W]=255&V,this[W+1]=V>>>8,W+2},l.prototype.writeInt16BE=function(V,W,ee){return V=+V,W>>>=0,ee||N(this,V,W,2,32767,-32768),this[W]=V>>>8,this[W+1]=255&V,W+2},l.prototype.writeInt32LE=function(V,W,ee){return V=+V,W>>>=0,ee||N(this,V,W,4,2147483647,-2147483648),this[W]=255&V,this[W+1]=V>>>8,this[W+2]=V>>>16,this[W+3]=V>>>24,W+4},l.prototype.writeInt32BE=function(V,W,ee){return V=+V,W>>>=0,ee||N(this,V,W,4,2147483647,-2147483648),V<0&&(V=4294967295+V+1),this[W]=V>>>24,this[W+1]=V>>>16,this[W+2]=V>>>8,this[W+3]=255&V,W+4},l.prototype.writeFloatLE=function(V,W,ee){return k(this,V,W,!0,ee)},l.prototype.writeFloatBE=function(V,W,ee){return k(this,V,W,!1,ee)},l.prototype.writeDoubleLE=function(V,W,ee){return I(this,V,W,!0,ee)},l.prototype.writeDoubleBE=function(V,W,ee){return I(this,V,W,!1,ee)},l.prototype.copy=function(V,W,ee,ie){if(!l.isBuffer(V))throw new TypeError("argument should be a Buffer");if(ee||(ee=0),ie||ie===0||(ie=this.length),W>=V.length&&(W=V.length),W||(W=0),ie>0&&ie<ee&&(ie=ee),ie===ee||V.length===0||this.length===0)return 0;if(W<0)throw new RangeError("targetStart out of bounds");if(ee<0||ee>=this.length)throw new RangeError("Index out of range");if(ie<0)throw new RangeError("sourceEnd out of bounds");ie>this.length&&(ie=this.length),V.length-W<ie-ee&&(ie=V.length-W+ee);var oe=ie-ee;if(this===V&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(W,ee,ie);else if(this===V&&ee<W&&W<ie)for(var se=oe-1;se>=0;--se)V[se+W]=this[se+ee];else Uint8Array.prototype.set.call(V,this.subarray(ee,ie),W);return oe},l.prototype.fill=function(V,W,ee,ie){if(typeof V=="string"){if(typeof W=="string"?(ie=W,W=0,ee=this.length):typeof ee=="string"&&(ie=ee,ee=this.length),ie!==void 0&&typeof ie!="string")throw new TypeError("encoding must be a string");if(typeof ie=="string"&&!l.isEncoding(ie))throw new TypeError("Unknown encoding: "+ie);if(V.length===1){var oe=V.charCodeAt(0);(ie==="utf8"&&oe<128||ie==="latin1")&&(V=oe)}}else typeof V=="number"&&(V&=255);if(W<0||this.length<W||this.length<ee)throw new RangeError("Out of range index");if(ee<=W)return this;var se;if(W>>>=0,ee=ee===void 0?this.length:ee>>>0,V||(V=0),typeof V=="number")for(se=W;se<ee;++se)this[se]=V;else{var le=l.isBuffer(V)?V:l.from(V,ie),ye=le.length;if(ye===0)throw new TypeError('The value "'+V+'" is invalid for argument "value"');for(se=0;se<ee-W;++se)this[se+W]=le[se%ye]}return this};var U=/[^+/0-9A-Za-z-_]/g;function $(V){return V<16?"0"+V.toString(16):V.toString(16)}function Y(V,W){var ee;W=W||1/0;for(var ie=V.length,oe=null,se=[],le=0;le<ie;++le){if((ee=V.charCodeAt(le))>55295&&ee<57344){if(!oe){if(ee>56319){(W-=3)>-1&&se.push(239,191,189);continue}if(le+1===ie){(W-=3)>-1&&se.push(239,191,189);continue}oe=ee;continue}if(ee<56320){(W-=3)>-1&&se.push(239,191,189),oe=ee;continue}ee=65536+(oe-55296<<10|ee-56320)}else oe&&(W-=3)>-1&&se.push(239,191,189);if(oe=null,ee<128){if((W-=1)<0)break;se.push(ee)}else if(ee<2048){if((W-=2)<0)break;se.push(ee>>6|192,63&ee|128)}else if(ee<65536){if((W-=3)<0)break;se.push(ee>>12|224,ee>>6&63|128,63&ee|128)}else{if(!(ee<1114112))throw new Error("Invalid code point");if((W-=4)<0)break;se.push(ee>>18|240,ee>>12&63|128,ee>>6&63|128,63&ee|128)}}return se}function Z(V){return o.toByteArray(function(W){if((W=(W=W.split("=")[0]).trim().replace(U,"")).length<2)return"";for(;W.length%4!=0;)W+="=";return W}(V))}function re(V,W,ee,ie){for(var oe=0;oe<ie&&!(oe+ee>=W.length||oe>=V.length);++oe)W[oe+ee]=V[oe];return oe}function G(V,W){return V instanceof W||V!=null&&V.constructor!=null&&V.constructor.name!=null&&V.constructor.name===W.name}function J(V){return V!=V}}).call(this)}).call(this,r("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("stream").Transform,c=r("string_decoder").StringDecoder;function d(l){o.call(this),this.hashMode=typeof l=="string",this.hashMode?this[l]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}r("inherits")(d,o),d.prototype.update=function(l,u,h){typeof l=="string"&&(l=i.from(l,u));var f=this._update(l);return this.hashMode?this:(h&&(f=this._toString(f,h)),f)},d.prototype.setAutoPadding=function(){},d.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},d.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},d.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},d.prototype._transform=function(l,u,h){var f;try{this.hashMode?this._update(l):this.push(this._update(l))}catch(m){f=m}finally{h(f)}},d.prototype._flush=function(l){var u;try{this.push(this.__final())}catch(h){u=h}l(u)},d.prototype._finalOrDigest=function(l){var u=this.__final()||i.alloc(0);return l&&(u=this._toString(u,l,!0)),u},d.prototype._toString=function(l,u,h){if(this._decoder||(this._decoder=new c(u),this._encoding=u),this._encoding!==u)throw new Error("can't switch encodings");var f=this._decoder.write(l);return h&&(f+=this._decoder.end()),f},s.exports=d},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(r,s,a){var i=r("../internals/is-callable"),o=r("../internals/try-to-string"),c=TypeError;s.exports=function(d){if(i(d))return d;throw new c(o(d)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(r,s,a){var i=r("../internals/is-constructor"),o=r("../internals/try-to-string"),c=TypeError;s.exports=function(d){if(i(d))return d;throw new c(o(d)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(r,s,a){var i=r("../internals/is-callable"),o=String,c=TypeError;s.exports=function(d){if(typeof d=="object"||i(d))return d;throw new c("Can't set "+o(d)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(r,s,a){var i=r("../internals/well-known-symbol"),o=r("../internals/object-create"),c=r("../internals/object-define-property").f,d=i("unscopables"),l=Array.prototype;l[d]===void 0&&c(l,d,{configurable:!0,value:o(null)}),s.exports=function(u){l[d][u]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(r,s,a){var i=r("../internals/object-is-prototype-of"),o=TypeError;s.exports=function(c,d){if(i(d,c))return c;throw new o("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(r,s,a){var i=r("../internals/is-object"),o=String,c=TypeError;s.exports=function(d){if(i(d))return d;throw new c(o(d)+" is not an object")}},{"../internals/is-object":289}],228:[function(r,s,a){var i=r("../internals/to-indexed-object"),o=r("../internals/to-absolute-index"),c=r("../internals/length-of-array-like"),d=function(l){return function(u,h,f){var m,p=i(u),g=c(p),v=o(f,g);if(l&&h!=h){for(;g>v;)if((m=p[v++])!=m)return!0}else for(;g>v;v++)if((l||v in p)&&p[v]===h)return l||v||0;return!l&&-1}};s.exports={includes:d(!0),indexOf:d(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(r,s,a){var i=r("../internals/function-bind-context"),o=r("../internals/function-uncurry-this"),c=r("../internals/indexed-object"),d=r("../internals/to-object"),l=r("../internals/length-of-array-like"),u=r("../internals/array-species-create"),h=o([].push),f=function(m){var p=m===1,g=m===2,v=m===3,x=m===4,y=m===6,b=m===7,j=m===5||y;return function(T,O,R,D){for(var L,q,X=d(T),H=c(X),M=i(O,R),F=l(H),S=0,E=D||u,N=p?E(T,F):g||b?E(T,0):void 0;F>S;S++)if((j||S in H)&&(q=M(L=H[S],S,X),m))if(p)N[S]=q;else if(q)switch(m){case 3:return!0;case 5:return L;case 6:return S;case 2:h(N,L)}else switch(m){case 4:return!1;case 7:h(N,L)}return y?-1:v||x?x:N}};s.exports={forEach:f(0),map:f(1),filter:f(2),some:f(3),every:f(4),find:f(5),findIndex:f(6),filterReject:f(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(r,s,a){var i=r("../internals/to-absolute-index"),o=r("../internals/length-of-array-like"),c=r("../internals/create-property"),d=Array,l=Math.max;s.exports=function(u,h,f){for(var m=o(u),p=i(h,m),g=i(f===void 0?m:f,m),v=d(l(g-p,0)),x=0;p<g;p++,x++)c(v,x,u[p]);return v.length=x,v}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(r,s,a){var i=r("../internals/function-uncurry-this");s.exports=i([].slice)},{"../internals/function-uncurry-this":268}],232:[function(r,s,a){var i=r("../internals/is-array"),o=r("../internals/is-constructor"),c=r("../internals/is-object"),d=r("../internals/well-known-symbol")("species"),l=Array;s.exports=function(u){var h;return i(u)&&(h=u.constructor,(o(h)&&(h===l||i(h.prototype))||c(h)&&(h=h[d])===null)&&(h=void 0)),h===void 0?l:h}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(r,s,a){var i=r("../internals/array-species-constructor");s.exports=function(o,c){return new(i(o))(c===0?0:c)}},{"../internals/array-species-constructor":232}],234:[function(r,s,a){var i=r("../internals/well-known-symbol")("iterator"),o=!1;try{var c=0,d={next:function(){return{done:!!c++}},return:function(){o=!0}};d[i]=function(){return this},Array.from(d,function(){throw 2})}catch{}s.exports=function(l,u){try{if(!u&&!o)return!1}catch{return!1}var h=!1;try{var f={};f[i]=function(){return{next:function(){return{done:h=!0}}}},l(f)}catch{}return h}},{"../internals/well-known-symbol":357}],235:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=i({}.toString),c=i("".slice);s.exports=function(d){return c(o(d),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(r,s,a){var i=r("../internals/to-string-tag-support"),o=r("../internals/is-callable"),c=r("../internals/classof-raw"),d=r("../internals/well-known-symbol")("toStringTag"),l=Object,u=c(function(){return arguments}())==="Arguments";s.exports=i?c:function(h){var f,m,p;return h===void 0?"Undefined":h===null?"Null":typeof(m=function(g,v){try{return g[v]}catch{}}(f=l(h),d))=="string"?m:u?c(f):(p=c(f))==="Object"&&o(f.callee)?"Arguments":p}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(r,s,a){var i=r("../internals/has-own-property"),o=r("../internals/own-keys"),c=r("../internals/object-get-own-property-descriptor"),d=r("../internals/object-define-property");s.exports=function(l,u,h){for(var f=o(u),m=d.f,p=c.f,g=0;g<f.length;g++){var v=f[g];i(l,v)||h&&i(h,v)||m(l,v,p(u,v))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(r,s,a){var i=r("../internals/well-known-symbol")("match");s.exports=function(o){var c=/./;try{"/./"[o](c)}catch{try{return c[i]=!1,"/./"[o](c)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(r,s,a){var i=r("../internals/fails");s.exports=!i(function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype})},{"../internals/fails":260}],240:[function(r,s,a){s.exports=function(i,o){return{value:i,done:o}}},{}],241:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/object-define-property"),c=r("../internals/create-property-descriptor");s.exports=i?function(d,l,u){return o.f(d,l,c(1,u))}:function(d,l,u){return d[l]=u,d}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(r,s,a){s.exports=function(i,o){return{enumerable:!(1&i),configurable:!(2&i),writable:!(4&i),value:o}}},{}],243:[function(r,s,a){var i=r("../internals/to-property-key"),o=r("../internals/object-define-property"),c=r("../internals/create-property-descriptor");s.exports=function(d,l,u){var h=i(l);h in d?o.f(d,h,c(0,u)):d[h]=u}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(r,s,a){var i=r("../internals/make-built-in"),o=r("../internals/object-define-property");s.exports=function(c,d,l){return l.get&&i(l.get,d,{getter:!0}),l.set&&i(l.set,d,{setter:!0}),o.f(c,d,l)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(r,s,a){var i=r("../internals/is-callable"),o=r("../internals/object-define-property"),c=r("../internals/make-built-in"),d=r("../internals/define-global-property");s.exports=function(l,u,h,f){f||(f={});var m=f.enumerable,p=f.name!==void 0?f.name:u;if(i(h)&&c(h,p,f),f.global)m?l[u]=h:d(u,h);else{try{f.unsafe?l[u]&&(m=!0):delete l[u]}catch{}m?l[u]=h:o.f(l,u,{value:h,enumerable:!1,configurable:!f.nonConfigurable,writable:!f.nonWritable})}return l}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(r,s,a){var i=r("../internals/global"),o=Object.defineProperty;s.exports=function(c,d){try{o(i,c,{value:d,configurable:!0,writable:!0})}catch{i[c]=d}return d}},{"../internals/global":274}],247:[function(r,s,a){var i=r("../internals/fails");s.exports=!i(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})},{"../internals/fails":260}],248:[function(r,s,a){var i=typeof document=="object"&&document.all,o=i===void 0&&i!==void 0;s.exports={all:i,IS_HTMLDDA:o}},{}],249:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/is-object"),c=i.document,d=o(c)&&o(c.createElement);s.exports=function(l){return d?c.createElement(l):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(r,s,a){var i=r("../internals/engine-is-deno"),o=r("../internals/engine-is-node");s.exports=!i&&!o&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(r,s,a){s.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(r,s,a){var i=r("../internals/engine-user-agent");s.exports=/ipad|iphone|ipod/i.test(i)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(r,s,a){var i=r("../internals/engine-user-agent");s.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(i)},{"../internals/engine-user-agent":256}],254:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/classof-raw");s.exports=o(i.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(r,s,a){var i=r("../internals/engine-user-agent");s.exports=/web0s(?!.*chrome)/i.test(i)},{"../internals/engine-user-agent":256}],256:[function(r,s,a){s.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(r,s,a){var i,o,c=r("../internals/global"),d=r("../internals/engine-user-agent"),l=c.process,u=c.Deno,h=l&&l.versions||u&&u.version,f=h&&h.v8;f&&(o=(i=f.split("."))[0]>0&&i[0]<4?1:+(i[0]+i[1])),!o&&d&&(!(i=d.match(/Edge\/(\d+)/))||i[1]>=74)&&(i=d.match(/Chrome\/(\d+)/))&&(o=+i[1]),s.exports=o},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(r,s,a){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/object-get-own-property-descriptor").f,c=r("../internals/create-non-enumerable-property"),d=r("../internals/define-built-in"),l=r("../internals/define-global-property"),u=r("../internals/copy-constructor-properties"),h=r("../internals/is-forced");s.exports=function(f,m){var p,g,v,x,y,b=f.target,j=f.global,T=f.stat;if(p=j?i:T?i[b]||l(b,{}):(i[b]||{}).prototype)for(g in m){if(x=m[g],v=f.dontCallGetSet?(y=o(p,g))&&y.value:p[g],!h(j?g:b+(T?".":"#")+g,f.forced)&&v!==void 0){if(typeof x==typeof v)continue;u(x,v)}(f.sham||v&&v.sham)&&c(x,"sham",!0),d(p,g,x,f)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(r,s,a){s.exports=function(i){try{return!!i()}catch{return!0}}},{}],261:[function(r,s,a){var i=r("../internals/function-bind-native"),o=Function.prototype,c=o.apply,d=o.call;s.exports=typeof Reflect=="object"&&Reflect.apply||(i?d.bind(c):function(){return d.apply(c,arguments)})},{"../internals/function-bind-native":263}],262:[function(r,s,a){var i=r("../internals/function-uncurry-this-clause"),o=r("../internals/a-callable"),c=r("../internals/function-bind-native"),d=i(i.bind);s.exports=function(l,u){return o(l),u===void 0?l:c?d(l,u):function(){return l.apply(u,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(r,s,a){var i=r("../internals/fails");s.exports=!i(function(){var o=(function(){}).bind();return typeof o!="function"||o.hasOwnProperty("prototype")})},{"../internals/fails":260}],264:[function(r,s,a){var i=r("../internals/function-bind-native"),o=Function.prototype.call;s.exports=i?o.bind(o):function(){return o.apply(o,arguments)}},{"../internals/function-bind-native":263}],265:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/has-own-property"),c=Function.prototype,d=i&&Object.getOwnPropertyDescriptor,l=o(c,"name"),u=l&&(function(){}).name==="something",h=l&&(!i||i&&d(c,"name").configurable);s.exports={EXISTS:l,PROPER:u,CONFIGURABLE:h}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/a-callable");s.exports=function(c,d,l){try{return i(o(Object.getOwnPropertyDescriptor(c,d)[l]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(r,s,a){var i=r("../internals/classof-raw"),o=r("../internals/function-uncurry-this");s.exports=function(c){if(i(c)==="Function")return o(c)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(r,s,a){var i=r("../internals/function-bind-native"),o=Function.prototype,c=o.call,d=i&&o.bind.bind(c,c);s.exports=i?d:function(l){return function(){return c.apply(l,arguments)}}},{"../internals/function-bind-native":263}],269:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/is-callable"),c=function(d){return o(d)?d:void 0};s.exports=function(d,l){return arguments.length<2?c(i[d]):i[d]&&i[d][l]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(r,s,a){var i=r("../internals/classof"),o=r("../internals/get-method"),c=r("../internals/is-null-or-undefined"),d=r("../internals/iterators"),l=r("../internals/well-known-symbol")("iterator");s.exports=function(u){if(!c(u))return o(u,l)||o(u,"@@iterator")||d[i(u)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(r,s,a){var i=r("../internals/function-call"),o=r("../internals/a-callable"),c=r("../internals/an-object"),d=r("../internals/try-to-string"),l=r("../internals/get-iterator-method"),u=TypeError;s.exports=function(h,f){var m=arguments.length<2?l(h):f;if(o(m))return c(i(m,h));throw new u(d(h)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/is-array"),c=r("../internals/is-callable"),d=r("../internals/classof-raw"),l=r("../internals/to-string"),u=i([].push);s.exports=function(h){if(c(h))return h;if(o(h)){for(var f=h.length,m=[],p=0;p<f;p++){var g=h[p];typeof g=="string"?u(m,g):typeof g!="number"&&d(g)!=="Number"&&d(g)!=="String"||u(m,l(g))}var v=m.length,x=!0;return function(y,b){if(x)return x=!1,b;if(o(this))return b;for(var j=0;j<v;j++)if(m[j]===y)return b}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(r,s,a){var i=r("../internals/a-callable"),o=r("../internals/is-null-or-undefined");s.exports=function(c,d){var l=c[d];return o(l)?void 0:i(l)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(r,s,a){(function(i){(function(){var o=function(c){return c&&c.Math===Math&&c};s.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof i=="object"&&i)||function(){return this}()||this||Function("return this")()}).call(this)}).call(this,typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/to-object"),c=i({}.hasOwnProperty);s.exports=Object.hasOwn||function(d,l){return c(o(d),l)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(r,s,a){s.exports={}},{}],277:[function(r,s,a){s.exports=function(i,o){try{arguments.length===1?console.error(i):console.error(i,o)}catch{}}},{}],278:[function(r,s,a){var i=r("../internals/get-built-in");s.exports=i("document","documentElement")},{"../internals/get-built-in":269}],279:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/fails"),c=r("../internals/document-create-element");s.exports=!i&&!o(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!==7})},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/fails"),c=r("../internals/classof-raw"),d=Object,l=i("".split);s.exports=o(function(){return!d("z").propertyIsEnumerable(0)})?function(u){return c(u)==="String"?l(u,""):d(u)}:d},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/is-callable"),c=r("../internals/shared-store"),d=i(Function.toString);o(c.inspectSource)||(c.inspectSource=function(l){return d(l)}),s.exports=c.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(r,s,a){var i,o,c,d=r("../internals/weak-map-basic-detection"),l=r("../internals/global"),u=r("../internals/is-object"),h=r("../internals/create-non-enumerable-property"),f=r("../internals/has-own-property"),m=r("../internals/shared-store"),p=r("../internals/shared-key"),g=r("../internals/hidden-keys"),v=l.TypeError,x=l.WeakMap;if(d||m.state){var y=m.state||(m.state=new x);y.get=y.get,y.has=y.has,y.set=y.set,i=function(j,T){if(y.has(j))throw new v("Object already initialized");return T.facade=j,y.set(j,T),T},o=function(j){return y.get(j)||{}},c=function(j){return y.has(j)}}else{var b=p("state");g[b]=!0,i=function(j,T){if(f(j,b))throw new v("Object already initialized");return T.facade=j,h(j,b,T),T},o=function(j){return f(j,b)?j[b]:{}},c=function(j){return f(j,b)}}s.exports={set:i,get:o,has:c,enforce:function(j){return c(j)?o(j):i(j,{})},getterFor:function(j){return function(T){var O;if(!u(T)||(O=o(T)).type!==j)throw new v("Incompatible receiver, "+j+" required");return O}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(r,s,a){var i=r("../internals/well-known-symbol"),o=r("../internals/iterators"),c=i("iterator"),d=Array.prototype;s.exports=function(l){return l!==void 0&&(o.Array===l||d[c]===l)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(r,s,a){var i=r("../internals/classof-raw");s.exports=Array.isArray||function(o){return i(o)==="Array"}},{"../internals/classof-raw":235}],285:[function(r,s,a){var i=r("../internals/document-all"),o=i.all;s.exports=i.IS_HTMLDDA?function(c){return typeof c=="function"||c===o}:function(c){return typeof c=="function"}},{"../internals/document-all":248}],286:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/fails"),c=r("../internals/is-callable"),d=r("../internals/classof"),l=r("../internals/get-built-in"),u=r("../internals/inspect-source"),h=function(){},f=[],m=l("Reflect","construct"),p=/^\s*(?:class|function)\b/,g=i(p.exec),v=!p.test(h),x=function(b){if(!c(b))return!1;try{return m(h,f,b),!0}catch{return!1}},y=function(b){if(!c(b))return!1;switch(d(b)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return v||!!g(p,u(b))}catch{return!0}};y.sham=!0,s.exports=!m||o(function(){var b;return x(x.call)||!x(Object)||!x(function(){b=!0})||b})?y:x},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(r,s,a){var i=r("../internals/fails"),o=r("../internals/is-callable"),c=/#|\.prototype\./,d=function(m,p){var g=u[l(m)];return g===f||g!==h&&(o(p)?i(p):!!p)},l=d.normalize=function(m){return String(m).replace(c,".").toLowerCase()},u=d.data={},h=d.NATIVE="N",f=d.POLYFILL="P";s.exports=d},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(r,s,a){s.exports=function(i){return i==null}},{}],289:[function(r,s,a){var i=r("../internals/is-callable"),o=r("../internals/document-all"),c=o.all;s.exports=o.IS_HTMLDDA?function(d){return typeof d=="object"?d!==null:i(d)||d===c}:function(d){return typeof d=="object"?d!==null:i(d)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(r,s,a){s.exports=!1},{}],291:[function(r,s,a){var i=r("../internals/is-object"),o=r("../internals/classof-raw"),c=r("../internals/well-known-symbol")("match");s.exports=function(d){var l;return i(d)&&((l=d[c])!==void 0?!!l:o(d)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(r,s,a){var i=r("../internals/get-built-in"),o=r("../internals/is-callable"),c=r("../internals/object-is-prototype-of"),d=r("../internals/use-symbol-as-uid"),l=Object;s.exports=d?function(u){return typeof u=="symbol"}:function(u){var h=i("Symbol");return o(h)&&c(h.prototype,l(u))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(r,s,a){var i=r("../internals/function-bind-context"),o=r("../internals/function-call"),c=r("../internals/an-object"),d=r("../internals/try-to-string"),l=r("../internals/is-array-iterator-method"),u=r("../internals/length-of-array-like"),h=r("../internals/object-is-prototype-of"),f=r("../internals/get-iterator"),m=r("../internals/get-iterator-method"),p=r("../internals/iterator-close"),g=TypeError,v=function(y,b){this.stopped=y,this.result=b},x=v.prototype;s.exports=function(y,b,j){var T,O,R,D,L,q,X,H=j&&j.that,M=!(!j||!j.AS_ENTRIES),F=!(!j||!j.IS_RECORD),S=!(!j||!j.IS_ITERATOR),E=!(!j||!j.INTERRUPTED),N=i(b,H),C=function(I){return T&&p(T,"normal",I),new v(!0,I)},k=function(I){return M?(c(I),E?N(I[0],I[1],C):N(I[0],I[1])):E?N(I,C):N(I)};if(F)T=y.iterator;else if(S)T=y;else{if(!(O=m(y)))throw new g(d(y)+" is not iterable");if(l(O)){for(R=0,D=u(y);D>R;R++)if((L=k(y[R]))&&h(x,L))return L;return new v(!1)}T=f(y,O)}for(q=F?y.next:T.next;!(X=o(q,T)).done;){try{L=k(X.value)}catch(I){p(T,"throw",I)}if(typeof L=="object"&&L&&h(x,L))return L}return new v(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(r,s,a){var i=r("../internals/function-call"),o=r("../internals/an-object"),c=r("../internals/get-method");s.exports=function(d,l,u){var h,f;o(d);try{if(!(h=c(d,"return"))){if(l==="throw")throw u;return u}h=i(h,d)}catch(m){f=!0,h=m}if(l==="throw")throw u;if(f)throw h;return o(h),u}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(r,s,a){var i=r("../internals/iterators-core").IteratorPrototype,o=r("../internals/object-create"),c=r("../internals/create-property-descriptor"),d=r("../internals/set-to-string-tag"),l=r("../internals/iterators"),u=function(){return this};s.exports=function(h,f,m,p){var g=f+" Iterator";return h.prototype=o(i,{next:c(+!p,m)}),d(h,g,!1,!0),l[g]=u,h}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-call"),c=r("../internals/is-pure"),d=r("../internals/function-name"),l=r("../internals/is-callable"),u=r("../internals/iterator-create-constructor"),h=r("../internals/object-get-prototype-of"),f=r("../internals/object-set-prototype-of"),m=r("../internals/set-to-string-tag"),p=r("../internals/create-non-enumerable-property"),g=r("../internals/define-built-in"),v=r("../internals/well-known-symbol"),x=r("../internals/iterators"),y=r("../internals/iterators-core"),b=d.PROPER,j=d.CONFIGURABLE,T=y.IteratorPrototype,O=y.BUGGY_SAFARI_ITERATORS,R=v("iterator"),D=function(){return this};s.exports=function(L,q,X,H,M,F,S){u(X,q,H);var E,N,C,k=function(G){if(G===M&&Z)return Z;if(!O&&G&&G in $)return $[G];switch(G){case"keys":case"values":case"entries":return function(){return new X(this,G)}}return function(){return new X(this)}},I=q+" Iterator",U=!1,$=L.prototype,Y=$[R]||$["@@iterator"]||M&&$[M],Z=!O&&Y||k(M),re=q==="Array"&&$.entries||Y;if(re&&(E=h(re.call(new L)))!==Object.prototype&&E.next&&(c||h(E)===T||(f?f(E,T):l(E[R])||g(E,R,D)),m(E,I,!0,!0),c&&(x[I]=D)),b&&M==="values"&&Y&&Y.name!=="values"&&(!c&&j?p($,"name","values"):(U=!0,Z=function(){return o(Y,this)})),M)if(N={values:k("values"),keys:F?Z:k("keys"),entries:k("entries")},S)for(C in N)(O||U||!(C in $))&&g($,C,N[C]);else i({target:q,proto:!0,forced:O||U},N);return c&&!S||$[R]===Z||g($,R,Z,{name:M}),x[q]=Z,N}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(r,s,a){var i,o,c,d=r("../internals/fails"),l=r("../internals/is-callable"),u=r("../internals/is-object"),h=r("../internals/object-create"),f=r("../internals/object-get-prototype-of"),m=r("../internals/define-built-in"),p=r("../internals/well-known-symbol"),g=r("../internals/is-pure"),v=p("iterator"),x=!1;[].keys&&("next"in(c=[].keys())?(o=f(f(c)))!==Object.prototype&&(i=o):x=!0),!u(i)||d(function(){var y={};return i[v].call(y)!==y})?i={}:g&&(i=h(i)),l(i[v])||m(i,v,function(){return this}),s.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:x}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(r,s,a){arguments[4][276][0].apply(a,arguments)},{dup:276}],299:[function(r,s,a){var i=r("../internals/to-length");s.exports=function(o){return i(o.length)}},{"../internals/to-length":343}],300:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/fails"),c=r("../internals/is-callable"),d=r("../internals/has-own-property"),l=r("../internals/descriptors"),u=r("../internals/function-name").CONFIGURABLE,h=r("../internals/inspect-source"),f=r("../internals/internal-state"),m=f.enforce,p=f.get,g=String,v=Object.defineProperty,x=i("".slice),y=i("".replace),b=i([].join),j=l&&!o(function(){return v(function(){},"length",{value:8}).length!==8}),T=String(String).split("String"),O=s.exports=function(R,D,L){x(g(D),0,7)==="Symbol("&&(D="["+y(g(D),/^Symbol\(([^)]*)\)/,"$1")+"]"),L&&L.getter&&(D="get "+D),L&&L.setter&&(D="set "+D),(!d(R,"name")||u&&R.name!==D)&&(l?v(R,"name",{value:D,configurable:!0}):R.name=D),j&&L&&d(L,"arity")&&R.length!==L.arity&&v(R,"length",{value:L.arity});try{L&&d(L,"constructor")&&L.constructor?l&&v(R,"prototype",{writable:!1}):R.prototype&&(R.prototype=void 0)}catch{}var q=m(R);return d(q,"source")||(q.source=b(T,typeof D=="string"?D:"")),R};Function.prototype.toString=O(function(){return c(this)&&p(this).source||h(this)},"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(r,s,a){var i=Math.ceil,o=Math.floor;s.exports=Math.trunc||function(c){var d=+c;return(d>0?o:i)(d)}},{}],302:[function(r,s,a){var i,o,c,d,l,u=r("../internals/global"),h=r("../internals/function-bind-context"),f=r("../internals/object-get-own-property-descriptor").f,m=r("../internals/task").set,p=r("../internals/queue"),g=r("../internals/engine-is-ios"),v=r("../internals/engine-is-ios-pebble"),x=r("../internals/engine-is-webos-webkit"),y=r("../internals/engine-is-node"),b=u.MutationObserver||u.WebKitMutationObserver,j=u.document,T=u.process,O=u.Promise,R=f(u,"queueMicrotask"),D=R&&R.value;if(!D){var L=new p,q=function(){var X,H;for(y&&(X=T.domain)&&X.exit();H=L.get();)try{H()}catch(M){throw L.head&&i(),M}X&&X.enter()};g||y||x||!b||!j?!v&&O&&O.resolve?((d=O.resolve(void 0)).constructor=O,l=h(d.then,d),i=function(){l(q)}):y?i=function(){T.nextTick(q)}:(m=h(m,u),i=function(){m(q)}):(o=!0,c=j.createTextNode(""),new b(q).observe(c,{characterData:!0}),i=function(){c.data=o=!o}),D=function(X){L.head||i(),L.add(X)}}s.exports=D},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(r,s,a){var i=r("../internals/a-callable"),o=TypeError,c=function(d){var l,u;this.promise=new d(function(h,f){if(l!==void 0||u!==void 0)throw new o("Bad Promise constructor");l=h,u=f}),this.resolve=i(l),this.reject=i(u)};s.exports.f=function(d){return new c(d)}},{"../internals/a-callable":222}],304:[function(r,s,a){var i=r("../internals/is-regexp"),o=TypeError;s.exports=function(c){if(i(c))throw new o("The method doesn't accept regular expressions");return c}},{"../internals/is-regexp":291}],305:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/function-uncurry-this"),c=r("../internals/function-call"),d=r("../internals/fails"),l=r("../internals/object-keys"),u=r("../internals/object-get-own-property-symbols"),h=r("../internals/object-property-is-enumerable"),f=r("../internals/to-object"),m=r("../internals/indexed-object"),p=Object.assign,g=Object.defineProperty,v=o([].concat);s.exports=!p||d(function(){if(i&&p({b:1},p(g({},"a",{enumerable:!0,get:function(){g(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var x={},y={},b=Symbol("assign detection");return x[b]=7,"abcdefghijklmnopqrst".split("").forEach(function(j){y[j]=j}),p({},x)[b]!==7||l(p({},y)).join("")!=="abcdefghijklmnopqrst"})?function(x,y){for(var b=f(x),j=arguments.length,T=1,O=u.f,R=h.f;j>T;)for(var D,L=m(arguments[T++]),q=O?v(l(L),O(L)):l(L),X=q.length,H=0;X>H;)D=q[H++],i&&!c(R,L,D)||(b[D]=L[D]);return b}:p},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(r,s,a){var i,o=r("../internals/an-object"),c=r("../internals/object-define-properties"),d=r("../internals/enum-bug-keys"),l=r("../internals/hidden-keys"),u=r("../internals/html"),h=r("../internals/document-create-element"),f=r("../internals/shared-key"),m=f("IE_PROTO"),p=function(){},g=function(y){return"<script>"+y+"<\/script>"},v=function(y){y.write(g("")),y.close();var b=y.parentWindow.Object;return y=null,b},x=function(){try{i=new ActiveXObject("htmlfile")}catch{}var y,b;x=typeof document<"u"?document.domain&&i?v(i):((b=h("iframe")).style.display="none",u.appendChild(b),b.src="javascript:",(y=b.contentWindow.document).open(),y.write(g("document.F=Object")),y.close(),y.F):v(i);for(var j=d.length;j--;)delete x.prototype[d[j]];return x()};l[m]=!0,s.exports=Object.create||function(y,b){var j;return y!==null?(p.prototype=o(y),j=new p,p.prototype=null,j[m]=y):j=x(),b===void 0?j:c.f(j,b)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/v8-prototype-define-bug"),c=r("../internals/object-define-property"),d=r("../internals/an-object"),l=r("../internals/to-indexed-object"),u=r("../internals/object-keys");a.f=i&&!o?Object.defineProperties:function(h,f){d(h);for(var m,p=l(f),g=u(f),v=g.length,x=0;v>x;)c.f(h,m=g[x++],p[m]);return h}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/ie8-dom-define"),c=r("../internals/v8-prototype-define-bug"),d=r("../internals/an-object"),l=r("../internals/to-property-key"),u=TypeError,h=Object.defineProperty,f=Object.getOwnPropertyDescriptor;a.f=i?c?function(m,p,g){if(d(m),p=l(p),d(g),typeof m=="function"&&p==="prototype"&&"value"in g&&"writable"in g&&!g.writable){var v=f(m,p);v&&v.writable&&(m[p]=g.value,g={configurable:"configurable"in g?g.configurable:v.configurable,enumerable:"enumerable"in g?g.enumerable:v.enumerable,writable:!1})}return h(m,p,g)}:h:function(m,p,g){if(d(m),p=l(p),d(g),o)try{return h(m,p,g)}catch{}if("get"in g||"set"in g)throw new u("Accessors not supported");return"value"in g&&(m[p]=g.value),m}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/function-call"),c=r("../internals/object-property-is-enumerable"),d=r("../internals/create-property-descriptor"),l=r("../internals/to-indexed-object"),u=r("../internals/to-property-key"),h=r("../internals/has-own-property"),f=r("../internals/ie8-dom-define"),m=Object.getOwnPropertyDescriptor;a.f=i?m:function(p,g){if(p=l(p),g=u(g),f)try{return m(p,g)}catch{}if(h(p,g))return d(!o(c.f,p,g),p[g])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(r,s,a){var i=r("../internals/classof-raw"),o=r("../internals/to-indexed-object"),c=r("../internals/object-get-own-property-names").f,d=r("../internals/array-slice-simple"),l=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];s.exports.f=function(u){return l&&i(u)==="Window"?function(h){try{return c(h)}catch{return d(l)}}(u):c(o(u))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(r,s,a){var i=r("../internals/object-keys-internal"),o=r("../internals/enum-bug-keys").concat("length","prototype");a.f=Object.getOwnPropertyNames||function(c){return i(c,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(r,s,a){a.f=Object.getOwnPropertySymbols},{}],313:[function(r,s,a){var i=r("../internals/has-own-property"),o=r("../internals/is-callable"),c=r("../internals/to-object"),d=r("../internals/shared-key"),l=r("../internals/correct-prototype-getter"),u=d("IE_PROTO"),h=Object,f=h.prototype;s.exports=l?h.getPrototypeOf:function(m){var p=c(m);if(i(p,u))return p[u];var g=p.constructor;return o(g)&&p instanceof g?g.prototype:p instanceof h?f:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(r,s,a){var i=r("../internals/function-uncurry-this");s.exports=i({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=r("../internals/has-own-property"),c=r("../internals/to-indexed-object"),d=r("../internals/array-includes").indexOf,l=r("../internals/hidden-keys"),u=i([].push);s.exports=function(h,f){var m,p=c(h),g=0,v=[];for(m in p)!o(l,m)&&o(p,m)&&u(v,m);for(;f.length>g;)o(p,m=f[g++])&&(~d(v,m)||u(v,m));return v}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(r,s,a){var i=r("../internals/object-keys-internal"),o=r("../internals/enum-bug-keys");s.exports=Object.keys||function(c){return i(c,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(r,s,a){var i={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,c=o&&!i.call({1:2},1);a.f=c?function(d){var l=o(this,d);return!!l&&l.enumerable}:i},{}],318:[function(r,s,a){var i=r("../internals/function-uncurry-this-accessor"),o=r("../internals/an-object"),c=r("../internals/a-possible-prototype");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var d,l=!1,u={};try{(d=i(Object.prototype,"__proto__","set"))(u,[]),l=u instanceof Array}catch{}return function(h,f){return o(h),c(f),l?d(h,f):h.__proto__=f,h}}():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/fails"),c=r("../internals/function-uncurry-this"),d=r("../internals/object-get-prototype-of"),l=r("../internals/object-keys"),u=r("../internals/to-indexed-object"),h=c(r("../internals/object-property-is-enumerable").f),f=c([].push),m=i&&o(function(){var g=Object.create(null);return g[2]=2,!h(g,2)}),p=function(g){return function(v){for(var x,y=u(v),b=l(y),j=m&&d(y)===null,T=b.length,O=0,R=[];T>O;)x=b[O++],i&&!(j?x in y:h(y,x))||f(R,g?[x,y[x]]:y[x]);return R}};s.exports={entries:p(!0),values:p(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(r,s,a){var i=r("../internals/function-call"),o=r("../internals/is-callable"),c=r("../internals/is-object"),d=TypeError;s.exports=function(l,u){var h,f;if(u==="string"&&o(h=l.toString)&&!c(f=i(h,l))||o(h=l.valueOf)&&!c(f=i(h,l))||u!=="string"&&o(h=l.toString)&&!c(f=i(h,l)))return f;throw new d("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(r,s,a){var i=r("../internals/get-built-in"),o=r("../internals/function-uncurry-this"),c=r("../internals/object-get-own-property-names"),d=r("../internals/object-get-own-property-symbols"),l=r("../internals/an-object"),u=o([].concat);s.exports=i("Reflect","ownKeys")||function(h){var f=c.f(l(h)),m=d.f;return m?u(f,m(h)):f}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(r,s,a){var i=r("../internals/global");s.exports=i},{"../internals/global":274}],323:[function(r,s,a){s.exports=function(i){try{return{error:!1,value:i()}}catch(o){return{error:!0,value:o}}}},{}],324:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/promise-native-constructor"),c=r("../internals/is-callable"),d=r("../internals/is-forced"),l=r("../internals/inspect-source"),u=r("../internals/well-known-symbol"),h=r("../internals/engine-is-browser"),f=r("../internals/engine-is-deno"),m=r("../internals/is-pure"),p=r("../internals/engine-v8-version"),g=o&&o.prototype,v=u("species"),x=!1,y=c(i.PromiseRejectionEvent),b=d("Promise",function(){var j=l(o),T=j!==String(o);if(!T&&p===66||m&&(!g.catch||!g.finally))return!0;if(!p||p<51||!/native code/.test(j)){var O=new o(function(D){D(1)}),R=function(D){D(function(){},function(){})};if((O.constructor={})[v]=R,!(x=O.then(function(){})instanceof R))return!0}return!T&&(h||f)&&!y});s.exports={CONSTRUCTOR:b,REJECTION_EVENT:y,SUBCLASSING:x}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(r,s,a){var i=r("../internals/global");s.exports=i.Promise},{"../internals/global":274}],326:[function(r,s,a){var i=r("../internals/an-object"),o=r("../internals/is-object"),c=r("../internals/new-promise-capability");s.exports=function(d,l){if(i(d),o(l)&&l.constructor===d)return l;var u=c.f(d);return(0,u.resolve)(l),u.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(r,s,a){var i=r("../internals/promise-native-constructor"),o=r("../internals/check-correctness-of-iteration"),c=r("../internals/promise-constructor-detection").CONSTRUCTOR;s.exports=c||!o(function(d){i.all(d).then(void 0,function(){})})},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(r,s,a){var i=function(){this.head=null,this.tail=null};i.prototype={add:function(o){var c={item:o,next:null},d=this.tail;d?d.next=c:this.head=c,this.tail=c},get:function(){var o=this.head;if(o)return(this.head=o.next)===null&&(this.tail=null),o.item}},s.exports=i},{}],329:[function(r,s,a){var i=r("../internals/is-null-or-undefined"),o=TypeError;s.exports=function(c){if(i(c))throw new o("Can't call method on "+c);return c}},{"../internals/is-null-or-undefined":288}],330:[function(r,s,a){var i=r("../internals/get-built-in"),o=r("../internals/define-built-in-accessor"),c=r("../internals/well-known-symbol"),d=r("../internals/descriptors"),l=c("species");s.exports=function(u){var h=i(u);d&&h&&!h[l]&&o(h,l,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(r,s,a){var i=r("../internals/object-define-property").f,o=r("../internals/has-own-property"),c=r("../internals/well-known-symbol")("toStringTag");s.exports=function(d,l,u){d&&!u&&(d=d.prototype),d&&!o(d,c)&&i(d,c,{configurable:!0,value:l})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(r,s,a){var i=r("../internals/shared"),o=r("../internals/uid"),c=i("keys");s.exports=function(d){return c[d]||(c[d]=o(d))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/define-global-property"),c=i["__core-js_shared__"]||o("__core-js_shared__",{});s.exports=c},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(r,s,a){var i=r("../internals/is-pure"),o=r("../internals/shared-store");(s.exports=function(c,d){return o[c]||(o[c]=d!==void 0?d:{})})("versions",[]).push({version:"3.33.0",mode:i?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(r,s,a){var i=r("../internals/an-object"),o=r("../internals/a-constructor"),c=r("../internals/is-null-or-undefined"),d=r("../internals/well-known-symbol")("species");s.exports=function(l,u){var h,f=i(l).constructor;return f===void 0||c(h=i(f)[d])?u:o(h)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(r,s,a){var i=r("../internals/engine-v8-version"),o=r("../internals/fails"),c=r("../internals/global").String;s.exports=!!Object.getOwnPropertySymbols&&!o(function(){var d=Symbol("symbol detection");return!c(d)||!(Object(d)instanceof Symbol)||!Symbol.sham&&i&&i<41})},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(r,s,a){var i=r("../internals/function-call"),o=r("../internals/get-built-in"),c=r("../internals/well-known-symbol"),d=r("../internals/define-built-in");s.exports=function(){var l=o("Symbol"),u=l&&l.prototype,h=u&&u.valueOf,f=c("toPrimitive");u&&!u[f]&&d(u,f,function(m){return i(h,this)},{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(r,s,a){var i=r("../internals/symbol-constructor-detection");s.exports=i&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(r,s,a){var i,o,c,d,l=r("../internals/global"),u=r("../internals/function-apply"),h=r("../internals/function-bind-context"),f=r("../internals/is-callable"),m=r("../internals/has-own-property"),p=r("../internals/fails"),g=r("../internals/html"),v=r("../internals/array-slice"),x=r("../internals/document-create-element"),y=r("../internals/validate-arguments-length"),b=r("../internals/engine-is-ios"),j=r("../internals/engine-is-node"),T=l.setImmediate,O=l.clearImmediate,R=l.process,D=l.Dispatch,L=l.Function,q=l.MessageChannel,X=l.String,H=0,M={};p(function(){i=l.location});var F=function(C){if(m(M,C)){var k=M[C];delete M[C],k()}},S=function(C){return function(){F(C)}},E=function(C){F(C.data)},N=function(C){l.postMessage(X(C),i.protocol+"//"+i.host)};T&&O||(T=function(C){y(arguments.length,1);var k=f(C)?C:L(C),I=v(arguments,1);return M[++H]=function(){u(k,void 0,I)},o(H),H},O=function(C){delete M[C]},j?o=function(C){R.nextTick(S(C))}:D&&D.now?o=function(C){D.now(S(C))}:q&&!b?(d=(c=new q).port2,c.port1.onmessage=E,o=h(d.postMessage,d)):l.addEventListener&&f(l.postMessage)&&!l.importScripts&&i&&i.protocol!=="file:"&&!p(N)?(o=N,l.addEventListener("message",E,!1)):o="onreadystatechange"in x("script")?function(C){g.appendChild(x("script")).onreadystatechange=function(){g.removeChild(this),F(C)}}:function(C){setTimeout(S(C),0)}),s.exports={set:T,clear:O}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(r,s,a){var i=r("../internals/to-integer-or-infinity"),o=Math.max,c=Math.min;s.exports=function(d,l){var u=i(d);return u<0?o(u+l,0):c(u,l)}},{"../internals/to-integer-or-infinity":342}],341:[function(r,s,a){var i=r("../internals/indexed-object"),o=r("../internals/require-object-coercible");s.exports=function(c){return i(o(c))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(r,s,a){var i=r("../internals/math-trunc");s.exports=function(o){var c=+o;return c!=c||c===0?0:i(c)}},{"../internals/math-trunc":301}],343:[function(r,s,a){var i=r("../internals/to-integer-or-infinity"),o=Math.min;s.exports=function(c){return c>0?o(i(c),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(r,s,a){var i=r("../internals/require-object-coercible"),o=Object;s.exports=function(c){return o(i(c))}},{"../internals/require-object-coercible":329}],345:[function(r,s,a){var i=r("../internals/function-call"),o=r("../internals/is-object"),c=r("../internals/is-symbol"),d=r("../internals/get-method"),l=r("../internals/ordinary-to-primitive"),u=r("../internals/well-known-symbol"),h=TypeError,f=u("toPrimitive");s.exports=function(m,p){if(!o(m)||c(m))return m;var g,v=d(m,f);if(v){if(p===void 0&&(p="default"),g=i(v,m,p),!o(g)||c(g))return g;throw new h("Can't convert object to primitive value")}return p===void 0&&(p="number"),l(m,p)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(r,s,a){var i=r("../internals/to-primitive"),o=r("../internals/is-symbol");s.exports=function(c){var d=i(c,"string");return o(d)?d:d+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(r,s,a){var i={};i[r("../internals/well-known-symbol")("toStringTag")]="z",s.exports=String(i)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(r,s,a){var i=r("../internals/classof"),o=String;s.exports=function(c){if(i(c)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return o(c)}},{"../internals/classof":236}],349:[function(r,s,a){var i=String;s.exports=function(o){try{return i(o)}catch{return"Object"}}},{}],350:[function(r,s,a){var i=r("../internals/function-uncurry-this"),o=0,c=Math.random(),d=i(1 .toString);s.exports=function(l){return"Symbol("+(l===void 0?"":l)+")_"+d(++o+c,36)}},{"../internals/function-uncurry-this":268}],351:[function(r,s,a){var i=r("../internals/symbol-constructor-detection");s.exports=i&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(r,s,a){var i=r("../internals/descriptors"),o=r("../internals/fails");s.exports=i&&o(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(r,s,a){var i=TypeError;s.exports=function(o,c){if(o<c)throw new i("Not enough arguments");return o}},{}],354:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/is-callable"),c=i.WeakMap;s.exports=o(c)&&/native code/.test(String(c))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(r,s,a){var i=r("../internals/path"),o=r("../internals/has-own-property"),c=r("../internals/well-known-symbol-wrapped"),d=r("../internals/object-define-property").f;s.exports=function(l){var u=i.Symbol||(i.Symbol={});o(u,l)||d(u,l,{value:c.f(l)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(r,s,a){var i=r("../internals/well-known-symbol");a.f=i},{"../internals/well-known-symbol":357}],357:[function(r,s,a){var i=r("../internals/global"),o=r("../internals/shared"),c=r("../internals/has-own-property"),d=r("../internals/uid"),l=r("../internals/symbol-constructor-detection"),u=r("../internals/use-symbol-as-uid"),h=i.Symbol,f=o("wks"),m=u?h.for||h:h&&h.withoutSetter||d;s.exports=function(p){return c(f,p)||(f[p]=l&&c(h,p)?h[p]:m("Symbol."+p)),f[p]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/array-iteration").findIndex,c=r("../internals/add-to-unscopables"),d=!0;"findIndex"in[]&&Array(1).findIndex(function(){d=!1}),i({target:"Array",proto:!0,forced:d},{findIndex:function(l){return o(this,l,arguments.length>1?arguments[1]:void 0)}}),c("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/array-iteration").find,c=r("../internals/add-to-unscopables"),d=!0;"find"in[]&&Array(1).find(function(){d=!1}),i({target:"Array",proto:!0,forced:d},{find:function(l){return o(this,l,arguments.length>1?arguments[1]:void 0)}}),c("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/array-includes").includes,c=r("../internals/fails"),d=r("../internals/add-to-unscopables");i({target:"Array",proto:!0,forced:c(function(){return!Array(1).includes()})},{includes:function(l){return o(this,l,arguments.length>1?arguments[1]:void 0)}}),d("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(r,s,a){var i=r("../internals/to-indexed-object"),o=r("../internals/add-to-unscopables"),c=r("../internals/iterators"),d=r("../internals/internal-state"),l=r("../internals/object-define-property").f,u=r("../internals/iterator-define"),h=r("../internals/create-iter-result-object"),f=r("../internals/is-pure"),m=r("../internals/descriptors"),p=d.set,g=d.getterFor("Array Iterator");s.exports=u(Array,"Array",function(x,y){p(this,{type:"Array Iterator",target:i(x),index:0,kind:y})},function(){var x=g(this),y=x.target,b=x.kind,j=x.index++;if(!y||j>=y.length)return x.target=void 0,h(void 0,!0);switch(b){case"keys":return h(j,!1);case"values":return h(y[j],!1)}return h([j,y[j]],!1)},"values");var v=c.Arguments=c.Array;if(o("keys"),o("values"),o("entries"),!f&&m&&v.name!=="values")try{l(v,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/get-built-in"),c=r("../internals/function-apply"),d=r("../internals/function-call"),l=r("../internals/function-uncurry-this"),u=r("../internals/fails"),h=r("../internals/is-callable"),f=r("../internals/is-symbol"),m=r("../internals/array-slice"),p=r("../internals/get-json-replacer-function"),g=r("../internals/symbol-constructor-detection"),v=String,x=o("JSON","stringify"),y=l(/./.exec),b=l("".charAt),j=l("".charCodeAt),T=l("".replace),O=l(1 .toString),R=/[\uD800-\uDFFF]/g,D=/^[\uD800-\uDBFF]$/,L=/^[\uDC00-\uDFFF]$/,q=!g||u(function(){var F=o("Symbol")("stringify detection");return x([F])!=="[null]"||x({a:F})!=="{}"||x(Object(F))!=="{}"}),X=u(function(){return x("\uDF06\uD834")!=='"\\udf06\\ud834"'||x("\uDEAD")!=='"\\udead"'}),H=function(F,S){var E=m(arguments),N=p(S);if(h(N)||F!==void 0&&!f(F))return E[1]=function(C,k){if(h(N)&&(k=d(N,this,v(C),k)),!f(k))return k},c(x,null,E)},M=function(F,S,E){var N=b(E,S-1),C=b(E,S+1);return y(D,F)&&!y(L,C)||y(L,F)&&!y(D,N)?"\\u"+O(j(F,0),16):F};x&&i({target:"JSON",stat:!0,arity:3,forced:q||X},{stringify:function(F,S,E){var N=m(arguments),C=c(q?H:x,null,N);return X&&typeof C=="string"?T(C,R,M):C}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(r,s,a){r("../internals/export")({target:"Number",stat:!0},{isNaN:function(i){return i!=i}})},{"../internals/export":259}],364:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/object-assign");i({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/symbol-constructor-detection"),c=r("../internals/fails"),d=r("../internals/object-get-own-property-symbols"),l=r("../internals/to-object");i({target:"Object",stat:!0,forced:!o||c(function(){d.f(1)})},{getOwnPropertySymbols:function(u){var h=d.f;return h?h(l(u)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/to-object"),c=r("../internals/object-keys");i({target:"Object",stat:!0,forced:r("../internals/fails")(function(){c(1)})},{keys:function(d){return c(o(d))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/object-to-array").values;i({target:"Object",stat:!0},{values:function(c){return o(c)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-call"),c=r("../internals/a-callable"),d=r("../internals/new-promise-capability"),l=r("../internals/perform"),u=r("../internals/iterate");i({target:"Promise",stat:!0,forced:r("../internals/promise-statics-incorrect-iteration")},{all:function(h){var f=this,m=d.f(f),p=m.resolve,g=m.reject,v=l(function(){var x=c(f.resolve),y=[],b=0,j=1;u(h,function(T){var O=b++,R=!1;j++,o(x,f,T).then(function(D){R||(R=!0,y[O]=D,--j||p(y))},g)}),--j||p(y)});return v.error&&g(v.value),m.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/is-pure"),c=r("../internals/promise-constructor-detection").CONSTRUCTOR,d=r("../internals/promise-native-constructor"),l=r("../internals/get-built-in"),u=r("../internals/is-callable"),h=r("../internals/define-built-in"),f=d&&d.prototype;if(i({target:"Promise",proto:!0,forced:c,real:!0},{catch:function(p){return this.then(void 0,p)}}),!o&&u(d)){var m=l("Promise").prototype.catch;f.catch!==m&&h(f,"catch",m,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(r,s,a){var i,o,c,d=r("../internals/export"),l=r("../internals/is-pure"),u=r("../internals/engine-is-node"),h=r("../internals/global"),f=r("../internals/function-call"),m=r("../internals/define-built-in"),p=r("../internals/object-set-prototype-of"),g=r("../internals/set-to-string-tag"),v=r("../internals/set-species"),x=r("../internals/a-callable"),y=r("../internals/is-callable"),b=r("../internals/is-object"),j=r("../internals/an-instance"),T=r("../internals/species-constructor"),O=r("../internals/task").set,R=r("../internals/microtask"),D=r("../internals/host-report-errors"),L=r("../internals/perform"),q=r("../internals/queue"),X=r("../internals/internal-state"),H=r("../internals/promise-native-constructor"),M=r("../internals/promise-constructor-detection"),F=r("../internals/new-promise-capability"),S=M.CONSTRUCTOR,E=M.REJECTION_EVENT,N=M.SUBCLASSING,C=X.getterFor("Promise"),k=X.set,I=H&&H.prototype,U=H,$=I,Y=h.TypeError,Z=h.document,re=h.process,G=F.f,J=G,V=!!(Z&&Z.createEvent&&h.dispatchEvent),W=function(ge){var Ne;return!(!b(ge)||!y(Ne=ge.then))&&Ne},ee=function(ge,Ne){var _e,be,Me,Se=Ne.value,$e=Ne.state===1,Ke=$e?ge.ok:ge.fail,Ze=ge.resolve,it=ge.reject,Re=ge.domain;try{Ke?($e||(Ne.rejection===2&&ye(Ne),Ne.rejection=1),Ke===!0?_e=Se:(Re&&Re.enter(),_e=Ke(Se),Re&&(Re.exit(),Me=!0)),_e===ge.promise?it(new Y("Promise-chain cycle")):(be=W(_e))?f(be,_e,Ze,it):Ze(_e)):it(Se)}catch(ot){Re&&!Me&&Re.exit(),it(ot)}},ie=function(ge,Ne){ge.notified||(ge.notified=!0,R(function(){for(var _e,be=ge.reactions;_e=be.get();)ee(_e,ge);ge.notified=!1,Ne&&!ge.rejection&&se(ge)}))},oe=function(ge,Ne,_e){var be,Me;V?((be=Z.createEvent("Event")).promise=Ne,be.reason=_e,be.initEvent(ge,!1,!0),h.dispatchEvent(be)):be={promise:Ne,reason:_e},!E&&(Me=h["on"+ge])?Me(be):ge==="unhandledrejection"&&D("Unhandled promise rejection",_e)},se=function(ge){f(O,h,function(){var Ne,_e=ge.facade,be=ge.value;if(le(ge)&&(Ne=L(function(){u?re.emit("unhandledRejection",be,_e):oe("unhandledrejection",_e,be)}),ge.rejection=u||le(ge)?2:1,Ne.error))throw Ne.value})},le=function(ge){return ge.rejection!==1&&!ge.parent},ye=function(ge){f(O,h,function(){var Ne=ge.facade;u?re.emit("rejectionHandled",Ne):oe("rejectionhandled",Ne,ge.value)})},ue=function(ge,Ne,_e){return function(be){ge(Ne,be,_e)}},ne=function(ge,Ne,_e){ge.done||(ge.done=!0,_e&&(ge=_e),ge.value=Ne,ge.state=2,ie(ge,!0))},pe=function(ge,Ne,_e){if(!ge.done){ge.done=!0,_e&&(ge=_e);try{if(ge.facade===Ne)throw new Y("Promise can't be resolved itself");var be=W(Ne);be?R(function(){var Me={done:!1};try{f(be,Ne,ue(pe,Me,ge),ue(ne,Me,ge))}catch(Se){ne(Me,Se,ge)}}):(ge.value=Ne,ge.state=1,ie(ge,!1))}catch(Me){ne({done:!1},Me,ge)}}};if(S&&($=(U=function(ge){j(this,$),x(ge),f(i,this);var Ne=C(this);try{ge(ue(pe,Ne),ue(ne,Ne))}catch(_e){ne(Ne,_e)}}).prototype,(i=function(ge){k(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new q,rejection:!1,state:0,value:void 0})}).prototype=m($,"then",function(ge,Ne){var _e=C(this),be=G(T(this,U));return _e.parent=!0,be.ok=!y(ge)||ge,be.fail=y(Ne)&&Ne,be.domain=u?re.domain:void 0,_e.state===0?_e.reactions.add(be):R(function(){ee(be,_e)}),be.promise}),o=function(){var ge=new i,Ne=C(ge);this.promise=ge,this.resolve=ue(pe,Ne),this.reject=ue(ne,Ne)},F.f=G=function(ge){return ge===U||ge===void 0?new o(ge):J(ge)},!l&&y(H)&&I!==Object.prototype)){c=I.then,N||m(I,"then",function(ge,Ne){var _e=this;return new U(function(be,Me){f(c,_e,be,Me)}).then(ge,Ne)},{unsafe:!0});try{delete I.constructor}catch{}p&&p(I,$)}d({global:!0,constructor:!0,wrap:!0,forced:S},{Promise:U}),g(U,"Promise",!1,!0),v("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/is-pure"),c=r("../internals/promise-native-constructor"),d=r("../internals/fails"),l=r("../internals/get-built-in"),u=r("../internals/is-callable"),h=r("../internals/species-constructor"),f=r("../internals/promise-resolve"),m=r("../internals/define-built-in"),p=c&&c.prototype;if(i({target:"Promise",proto:!0,real:!0,forced:!!c&&d(function(){p.finally.call({then:function(){}},function(){})})},{finally:function(v){var x=h(this,l("Promise")),y=u(v);return this.then(y?function(b){return f(x,v()).then(function(){return b})}:v,y?function(b){return f(x,v()).then(function(){throw b})}:v)}}),!o&&u(c)){var g=l("Promise").prototype.finally;p.finally!==g&&m(p,"finally",g,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(r,s,a){r("../modules/es.promise.constructor"),r("../modules/es.promise.all"),r("../modules/es.promise.catch"),r("../modules/es.promise.race"),r("../modules/es.promise.reject"),r("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-call"),c=r("../internals/a-callable"),d=r("../internals/new-promise-capability"),l=r("../internals/perform"),u=r("../internals/iterate");i({target:"Promise",stat:!0,forced:r("../internals/promise-statics-incorrect-iteration")},{race:function(h){var f=this,m=d.f(f),p=m.reject,g=l(function(){var v=c(f.resolve);u(h,function(x){o(v,f,x).then(m.resolve,p)})});return g.error&&p(g.value),m.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-call"),c=r("../internals/new-promise-capability");i({target:"Promise",stat:!0,forced:r("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(d){var l=c.f(this);return o(l.reject,void 0,d),l.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/get-built-in"),c=r("../internals/is-pure"),d=r("../internals/promise-native-constructor"),l=r("../internals/promise-constructor-detection").CONSTRUCTOR,u=r("../internals/promise-resolve"),h=o("Promise"),f=c&&!l;i({target:"Promise",stat:!0,forced:c||l},{resolve:function(m){return u(f&&this===h?d:this,m)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-uncurry-this"),c=r("../internals/to-absolute-index"),d=RangeError,l=String.fromCharCode,u=String.fromCodePoint,h=o([].join);i({target:"String",stat:!0,arity:1,forced:!!u&&u.length!==1},{fromCodePoint:function(f){for(var m,p=[],g=arguments.length,v=0;g>v;){if(m=+arguments[v++],c(m,1114111)!==m)throw new d(m+" is not a valid code point");p[v]=m<65536?l(m):l(55296+((m-=65536)>>10),m%1024+56320)}return h(p,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/function-uncurry-this"),c=r("../internals/not-a-regexp"),d=r("../internals/require-object-coercible"),l=r("../internals/to-string"),u=r("../internals/correct-is-regexp-logic"),h=o("".indexOf);i({target:"String",proto:!0,forced:!u("includes")},{includes:function(f){return!!~h(l(d(this)),l(c(f)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(r,s,a){r("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/global"),c=r("../internals/function-call"),d=r("../internals/function-uncurry-this"),l=r("../internals/is-pure"),u=r("../internals/descriptors"),h=r("../internals/symbol-constructor-detection"),f=r("../internals/fails"),m=r("../internals/has-own-property"),p=r("../internals/object-is-prototype-of"),g=r("../internals/an-object"),v=r("../internals/to-indexed-object"),x=r("../internals/to-property-key"),y=r("../internals/to-string"),b=r("../internals/create-property-descriptor"),j=r("../internals/object-create"),T=r("../internals/object-keys"),O=r("../internals/object-get-own-property-names"),R=r("../internals/object-get-own-property-names-external"),D=r("../internals/object-get-own-property-symbols"),L=r("../internals/object-get-own-property-descriptor"),q=r("../internals/object-define-property"),X=r("../internals/object-define-properties"),H=r("../internals/object-property-is-enumerable"),M=r("../internals/define-built-in"),F=r("../internals/define-built-in-accessor"),S=r("../internals/shared"),E=r("../internals/shared-key"),N=r("../internals/hidden-keys"),C=r("../internals/uid"),k=r("../internals/well-known-symbol"),I=r("../internals/well-known-symbol-wrapped"),U=r("../internals/well-known-symbol-define"),$=r("../internals/symbol-define-to-primitive"),Y=r("../internals/set-to-string-tag"),Z=r("../internals/internal-state"),re=r("../internals/array-iteration").forEach,G=E("hidden"),J=Z.set,V=Z.getterFor("Symbol"),W=Object.prototype,ee=o.Symbol,ie=ee&&ee.prototype,oe=o.RangeError,se=o.TypeError,le=o.QObject,ye=L.f,ue=q.f,ne=R.f,pe=H.f,ge=d([].push),Ne=S("symbols"),_e=S("op-symbols"),be=S("wks"),Me=!le||!le.prototype||!le.prototype.findChild,Se=function(Je,Ce,Ge){var Pe=ye(W,Ce);Pe&&delete W[Ce],ue(Je,Ce,Ge),Pe&&Je!==W&&ue(W,Ce,Pe)},$e=u&&f(function(){return j(ue({},"a",{get:function(){return ue(this,"a",{value:7}).a}})).a!==7})?Se:ue,Ke=function(Je,Ce){var Ge=Ne[Je]=j(ie);return J(Ge,{type:"Symbol",tag:Je,description:Ce}),u||(Ge.description=Ce),Ge},Ze=function(Je,Ce,Ge){Je===W&&Ze(_e,Ce,Ge),g(Je);var Pe=x(Ce);return g(Ge),m(Ne,Pe)?(Ge.enumerable?(m(Je,G)&&Je[G][Pe]&&(Je[G][Pe]=!1),Ge=j(Ge,{enumerable:b(0,!1)})):(m(Je,G)||ue(Je,G,b(1,{})),Je[G][Pe]=!0),$e(Je,Pe,Ge)):ue(Je,Pe,Ge)},it=function(Je,Ce){g(Je);var Ge=v(Ce),Pe=T(Ge).concat(bt(Ge));return re(Pe,function(Ve){u&&!c(Re,Ge,Ve)||Ze(Je,Ve,Ge[Ve])}),Je},Re=function(Je){var Ce=x(Je),Ge=c(pe,this,Ce);return!(this===W&&m(Ne,Ce)&&!m(_e,Ce))&&(!(Ge||!m(this,Ce)||!m(Ne,Ce)||m(this,G)&&this[G][Ce])||Ge)},ot=function(Je,Ce){var Ge=v(Je),Pe=x(Ce);if(Ge!==W||!m(Ne,Pe)||m(_e,Pe)){var Ve=ye(Ge,Pe);return!Ve||!m(Ne,Pe)||m(Ge,G)&&Ge[G][Pe]||(Ve.enumerable=!0),Ve}},ut=function(Je){var Ce=ne(v(Je)),Ge=[];return re(Ce,function(Pe){m(Ne,Pe)||m(N,Pe)||ge(Ge,Pe)}),Ge},bt=function(Je){var Ce=Je===W,Ge=ne(Ce?_e:v(Je)),Pe=[];return re(Ge,function(Ve){!m(Ne,Ve)||Ce&&!m(W,Ve)||ge(Pe,Ne[Ve])}),Pe};h||(M(ie=(ee=function(){if(p(ie,this))throw new se("Symbol is not a constructor");var Je=arguments.length&&arguments[0]!==void 0?y(arguments[0]):void 0,Ce=C(Je),Ge=function(Pe){this===W&&c(Ge,_e,Pe),m(this,G)&&m(this[G],Ce)&&(this[G][Ce]=!1);var Ve=b(1,Pe);try{$e(this,Ce,Ve)}catch(st){if(!(st instanceof oe))throw st;Se(this,Ce,Ve)}};return u&&Me&&$e(W,Ce,{configurable:!0,set:Ge}),Ke(Ce,Je)}).prototype,"toString",function(){return V(this).tag}),M(ee,"withoutSetter",function(Je){return Ke(C(Je),Je)}),H.f=Re,q.f=Ze,X.f=it,L.f=ot,O.f=R.f=ut,D.f=bt,I.f=function(Je){return Ke(k(Je),Je)},u&&(F(ie,"description",{configurable:!0,get:function(){return V(this).description}}),l||M(W,"propertyIsEnumerable",Re,{unsafe:!0}))),i({global:!0,constructor:!0,wrap:!0,forced:!h,sham:!h},{Symbol:ee}),re(T(be),function(Je){U(Je)}),i({target:"Symbol",stat:!0,forced:!h},{useSetter:function(){Me=!0},useSimple:function(){Me=!1}}),i({target:"Object",stat:!0,forced:!h,sham:!u},{create:function(Je,Ce){return Ce===void 0?j(Je):it(j(Je),Ce)},defineProperty:Ze,defineProperties:it,getOwnPropertyDescriptor:ot}),i({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:ut}),$(),Y(ee,"Symbol"),N[G]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/get-built-in"),c=r("../internals/has-own-property"),d=r("../internals/to-string"),l=r("../internals/shared"),u=r("../internals/symbol-registry-detection"),h=l("string-to-symbol-registry"),f=l("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!u},{for:function(m){var p=d(m);if(c(h,p))return h[p];var g=o("Symbol")(p);return h[p]=g,f[g]=p,g}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(r,s,a){r("../modules/es.symbol.constructor"),r("../modules/es.symbol.for"),r("../modules/es.symbol.key-for"),r("../modules/es.json.stringify"),r("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(r,s,a){var i=r("../internals/export"),o=r("../internals/has-own-property"),c=r("../internals/is-symbol"),d=r("../internals/try-to-string"),l=r("../internals/shared"),u=r("../internals/symbol-registry-detection"),h=l("symbol-to-string-registry");i({target:"Symbol",stat:!0,forced:!u},{keyFor:function(f){if(!c(f))throw new TypeError(d(f)+" is not a symbol");if(o(h,f))return h[f]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(r,s,a){function i(o){return Object.prototype.toString.call(o)}a.isArray=function(o){return Array.isArray?Array.isArray(o):i(o)==="[object Array]"},a.isBoolean=function(o){return typeof o=="boolean"},a.isNull=function(o){return o===null},a.isNullOrUndefined=function(o){return o==null},a.isNumber=function(o){return typeof o=="number"},a.isString=function(o){return typeof o=="string"},a.isSymbol=function(o){return typeof o=="symbol"},a.isUndefined=function(o){return o===void 0},a.isRegExp=function(o){return i(o)==="[object RegExp]"},a.isObject=function(o){return typeof o=="object"&&o!==null},a.isDate=function(o){return i(o)==="[object Date]"},a.isError=function(o){return i(o)==="[object Error]"||o instanceof Error},a.isFunction=function(o){return typeof o=="function"},a.isPrimitive=function(o){return o===null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||typeof o=="symbol"||o===void 0},a.isBuffer=r("buffer").Buffer.isBuffer},{buffer:220}],384:[function(r,s,a){(function(i){(function(){var o=r("elliptic"),c=r("bn.js");s.exports=function(h){return new l(h)};var d={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function l(h){this.curveType=d[h],this.curveType||(this.curveType={name:h}),this.curve=new o.ec(this.curveType.name),this.keys=void 0}function u(h,f,m){Array.isArray(h)||(h=h.toArray());var p=new i(h);if(m&&p.length<m){var g=new i(m-p.length);g.fill(0),p=i.concat([g,p])}return f?p.toString(f):p}d.p224=d.secp224r1,d.p256=d.secp256r1=d.prime256v1,d.p192=d.secp192r1=d.prime192v1,d.p384=d.secp384r1,d.p521=d.secp521r1,l.prototype.generateKeys=function(h,f){return this.keys=this.curve.genKeyPair(),this.getPublicKey(h,f)},l.prototype.computeSecret=function(h,f,m){return f=f||"utf8",i.isBuffer(h)||(h=new i(h,f)),u(this.curve.keyFromPublic(h).getPublic().mul(this.keys.getPrivate()).getX(),m,this.curveType.byteLength)},l.prototype.getPublicKey=function(h,f){var m=this.keys.getPublic(f==="compressed",!0);return f==="hybrid"&&(m[m.length-1]%2?m[0]=7:m[0]=6),u(m,h)},l.prototype.getPrivateKey=function(h){return u(this.keys.getPrivate(),h)},l.prototype.setPublicKey=function(h,f){return f=f||"utf8",i.isBuffer(h)||(h=new i(h,f)),this.keys._importPublic(h),this},l.prototype.setPrivateKey=function(h,f){f=f||"utf8",i.isBuffer(h)||(h=new i(h,f));var m=new c(h);return m=m.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(m),this}}).call(this)}).call(this,r("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(r,s,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],386:[function(r,s,a){var i=r("inherits"),o=r("md5.js"),c=r("ripemd160"),d=r("sha.js"),l=r("cipher-base");function u(h){l.call(this,"digest"),this._hash=h}i(u,l),u.prototype._update=function(h){this._hash.update(h)},u.prototype._final=function(){return this._hash.digest()},s.exports=function(h){return(h=h.toLowerCase())==="md5"?new o:h==="rmd160"||h==="ripemd160"?new c:new u(d(h))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(r,s,a){var i=r("md5.js");s.exports=function(o){return new i().update(o).digest()}},{"md5.js":450}],388:[function(r,s,a){var i=r("inherits"),o=r("./legacy"),c=r("cipher-base"),d=r("safe-buffer").Buffer,l=r("create-hash/md5"),u=r("ripemd160"),h=r("sha.js"),f=d.alloc(128);function m(p,g){c.call(this,"digest"),typeof g=="string"&&(g=d.from(g));var v=p==="sha512"||p==="sha384"?128:64;this._alg=p,this._key=g,g.length>v?g=(p==="rmd160"?new u:h(p)).update(g).digest():g.length<v&&(g=d.concat([g,f],v));for(var x=this._ipad=d.allocUnsafe(v),y=this._opad=d.allocUnsafe(v),b=0;b<v;b++)x[b]=54^g[b],y[b]=92^g[b];this._hash=p==="rmd160"?new u:h(p),this._hash.update(x)}i(m,c),m.prototype._update=function(p){this._hash.update(p)},m.prototype._final=function(){var p=this._hash.digest();return(this._alg==="rmd160"?new u:h(this._alg)).update(this._opad).update(p).digest()},s.exports=function(p,g){return(p=p.toLowerCase())==="rmd160"||p==="ripemd160"?new m("rmd160",g):p==="md5"?new o(l,g):new m(p,g)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(r,s,a){var i=r("inherits"),o=r("safe-buffer").Buffer,c=r("cipher-base"),d=o.alloc(128);function l(u,h){c.call(this,"digest"),typeof h=="string"&&(h=o.from(h)),this._alg=u,this._key=h,h.length>64?h=u(h):h.length<64&&(h=o.concat([h,d],64));for(var f=this._ipad=o.allocUnsafe(64),m=this._opad=o.allocUnsafe(64),p=0;p<64;p++)f[p]=54^h[p],m[p]=92^h[p];this._hash=[f]}i(l,c),l.prototype._update=function(u){this._hash.push(u)},l.prototype._final=function(){var u=this._alg(o.concat(this._hash));return this._alg(o.concat([this._opad,u]))},s.exports=l},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(r,s,a){a.randomBytes=a.rng=a.pseudoRandomBytes=a.prng=r("randombytes"),a.createHash=a.Hash=r("create-hash"),a.createHmac=a.Hmac=r("create-hmac");var i=r("browserify-sign/algos"),o=Object.keys(i),c=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(o);a.getHashes=function(){return c};var d=r("pbkdf2");a.pbkdf2=d.pbkdf2,a.pbkdf2Sync=d.pbkdf2Sync;var l=r("browserify-cipher");a.Cipher=l.Cipher,a.createCipher=l.createCipher,a.Cipheriv=l.Cipheriv,a.createCipheriv=l.createCipheriv,a.Decipher=l.Decipher,a.createDecipher=l.createDecipher,a.Decipheriv=l.Decipheriv,a.createDecipheriv=l.createDecipheriv,a.getCiphers=l.getCiphers,a.listCiphers=l.listCiphers;var u=r("diffie-hellman");a.DiffieHellmanGroup=u.DiffieHellmanGroup,a.createDiffieHellmanGroup=u.createDiffieHellmanGroup,a.getDiffieHellman=u.getDiffieHellman,a.createDiffieHellman=u.createDiffieHellman,a.DiffieHellman=u.DiffieHellman;var h=r("browserify-sign");a.createSign=h.createSign,a.Sign=h.Sign,a.createVerify=h.createVerify,a.Verify=h.Verify,a.createECDH=r("create-ecdh");var f=r("public-encrypt");a.publicEncrypt=f.publicEncrypt,a.privateEncrypt=f.privateEncrypt,a.publicDecrypt=f.publicDecrypt,a.privateDecrypt=f.privateDecrypt;var m=r("randomfill");a.randomFill=m.randomFill,a.randomFillSync=m.randomFillSync,a.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},a.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(r,s,a){(function(i,o){typeof a=="object"&&s!==void 0?s.exports=o():(i=typeof globalThis<"u"?globalThis:i||self).dayjs=o()})(void 0,function(){var i=6e4,o=36e5,c="millisecond",d="second",l="minute",u="hour",h="day",f="week",m="month",p="quarter",g="year",v="date",x="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,j={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(E){var N=["th","st","nd","rd"],C=E%100;return"["+E+(N[(C-20)%10]||N[C]||N[0])+"]"}},T=function(E,N,C){var k=String(E);return!k||k.length>=N?E:""+Array(N+1-k.length).join(C)+E},O={s:T,z:function(E){var N=-E.utcOffset(),C=Math.abs(N),k=Math.floor(C/60),I=C%60;return(N<=0?"+":"-")+T(k,2,"0")+":"+T(I,2,"0")},m:function E(N,C){if(N.date()<C.date())return-E(C,N);var k=12*(C.year()-N.year())+(C.month()-N.month()),I=N.clone().add(k,m),U=C-I<0,$=N.clone().add(k+(U?-1:1),m);return+(-(k+(C-I)/(U?I-$:$-I))||0)},a:function(E){return E<0?Math.ceil(E)||0:Math.floor(E)},p:function(E){return{M:m,y:g,w:f,d:h,D:v,h:u,m:l,s:d,ms:c,Q:p}[E]||String(E||"").toLowerCase().replace(/s$/,"")},u:function(E){return E===void 0}},R="en",D={};D[R]=j;var L="$isDayjsObject",q=function(E){return E instanceof F||!(!E||!E[L])},X=function E(N,C,k){var I;if(!N)return R;if(typeof N=="string"){var U=N.toLowerCase();D[U]&&(I=U),C&&(D[U]=C,I=U);var $=N.split("-");if(!I&&$.length>1)return E($[0])}else{var Y=N.name;D[Y]=N,I=Y}return!k&&I&&(R=I),I||!k&&R},H=function(E,N){if(q(E))return E.clone();var C=typeof N=="object"?N:{};return C.date=E,C.args=arguments,new F(C)},M=O;M.l=X,M.i=q,M.w=function(E,N){return H(E,{locale:N.$L,utc:N.$u,x:N.$x,$offset:N.$offset})};var F=function(){function E(C){this.$L=X(C.locale,null,!0),this.parse(C),this.$x=this.$x||C.x||{},this[L]=!0}var N=E.prototype;return N.parse=function(C){this.$d=function(k){var I=k.date,U=k.utc;if(I===null)return new Date(NaN);if(M.u(I))return new Date;if(I instanceof Date)return new Date(I);if(typeof I=="string"&&!/Z$/i.test(I)){var $=I.match(y);if($){var Y=$[2]-1||0,Z=($[7]||"0").substring(0,3);return U?new Date(Date.UTC($[1],Y,$[3]||1,$[4]||0,$[5]||0,$[6]||0,Z)):new Date($[1],Y,$[3]||1,$[4]||0,$[5]||0,$[6]||0,Z)}}return new Date(I)}(C),this.init()},N.init=function(){var C=this.$d;this.$y=C.getFullYear(),this.$M=C.getMonth(),this.$D=C.getDate(),this.$W=C.getDay(),this.$H=C.getHours(),this.$m=C.getMinutes(),this.$s=C.getSeconds(),this.$ms=C.getMilliseconds()},N.$utils=function(){return M},N.isValid=function(){return this.$d.toString()!==x},N.isSame=function(C,k){var I=H(C);return this.startOf(k)<=I&&I<=this.endOf(k)},N.isAfter=function(C,k){return H(C)<this.startOf(k)},N.isBefore=function(C,k){return this.endOf(k)<H(C)},N.$g=function(C,k,I){return M.u(C)?this[k]:this.set(I,C)},N.unix=function(){return Math.floor(this.valueOf()/1e3)},N.valueOf=function(){return this.$d.getTime()},N.startOf=function(C,k){var I=this,U=!!M.u(k)||k,$=M.p(C),Y=function(ie,oe){var se=M.w(I.$u?Date.UTC(I.$y,oe,ie):new Date(I.$y,oe,ie),I);return U?se:se.endOf(h)},Z=function(ie,oe){return M.w(I.toDate()[ie].apply(I.toDate("s"),(U?[0,0,0,0]:[23,59,59,999]).slice(oe)),I)},re=this.$W,G=this.$M,J=this.$D,V="set"+(this.$u?"UTC":"");switch($){case g:return U?Y(1,0):Y(31,11);case m:return U?Y(1,G):Y(0,G+1);case f:var W=this.$locale().weekStart||0,ee=(re<W?re+7:re)-W;return Y(U?J-ee:J+(6-ee),G);case h:case v:return Z(V+"Hours",0);case u:return Z(V+"Minutes",1);case l:return Z(V+"Seconds",2);case d:return Z(V+"Milliseconds",3);default:return this.clone()}},N.endOf=function(C){return this.startOf(C,!1)},N.$set=function(C,k){var I,U=M.p(C),$="set"+(this.$u?"UTC":""),Y=(I={},I[h]=$+"Date",I[v]=$+"Date",I[m]=$+"Month",I[g]=$+"FullYear",I[u]=$+"Hours",I[l]=$+"Minutes",I[d]=$+"Seconds",I[c]=$+"Milliseconds",I)[U],Z=U===h?this.$D+(k-this.$W):k;if(U===m||U===g){var re=this.clone().set(v,1);re.$d[Y](Z),re.init(),this.$d=re.set(v,Math.min(this.$D,re.daysInMonth())).$d}else Y&&this.$d[Y](Z);return this.init(),this},N.set=function(C,k){return this.clone().$set(C,k)},N.get=function(C){return this[M.p(C)]()},N.add=function(C,k){var I,U=this;C=Number(C);var $=M.p(k),Y=function(G){var J=H(U);return M.w(J.date(J.date()+Math.round(G*C)),U)};if($===m)return this.set(m,this.$M+C);if($===g)return this.set(g,this.$y+C);if($===h)return Y(1);if($===f)return Y(7);var Z=(I={},I[l]=i,I[u]=o,I[d]=1e3,I)[$]||1,re=this.$d.getTime()+C*Z;return M.w(re,this)},N.subtract=function(C,k){return this.add(-1*C,k)},N.format=function(C){var k=this,I=this.$locale();if(!this.isValid())return I.invalidDate||x;var U=C||"YYYY-MM-DDTHH:mm:ssZ",$=M.z(this),Y=this.$H,Z=this.$m,re=this.$M,G=I.weekdays,J=I.months,V=I.meridiem,W=function(oe,se,le,ye){return oe&&(oe[se]||oe(k,U))||le[se].slice(0,ye)},ee=function(oe){return M.s(Y%12||12,oe,"0")},ie=V||function(oe,se,le){var ye=oe<12?"AM":"PM";return le?ye.toLowerCase():ye};return U.replace(b,function(oe,se){return se||function(le){switch(le){case"YY":return String(k.$y).slice(-2);case"YYYY":return M.s(k.$y,4,"0");case"M":return re+1;case"MM":return M.s(re+1,2,"0");case"MMM":return W(I.monthsShort,re,J,3);case"MMMM":return W(J,re);case"D":return k.$D;case"DD":return M.s(k.$D,2,"0");case"d":return String(k.$W);case"dd":return W(I.weekdaysMin,k.$W,G,2);case"ddd":return W(I.weekdaysShort,k.$W,G,3);case"dddd":return G[k.$W];case"H":return String(Y);case"HH":return M.s(Y,2,"0");case"h":return ee(1);case"hh":return ee(2);case"a":return ie(Y,Z,!0);case"A":return ie(Y,Z,!1);case"m":return String(Z);case"mm":return M.s(Z,2,"0");case"s":return String(k.$s);case"ss":return M.s(k.$s,2,"0");case"SSS":return M.s(k.$ms,3,"0");case"Z":return $}return null}(oe)||$.replace(":","")})},N.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},N.diff=function(C,k,I){var U,$=this,Y=M.p(k),Z=H(C),re=(Z.utcOffset()-this.utcOffset())*i,G=this-Z,J=function(){return M.m($,Z)};switch(Y){case g:U=J()/12;break;case m:U=J();break;case p:U=J()/3;break;case f:U=(G-re)/6048e5;break;case h:U=(G-re)/864e5;break;case u:U=G/o;break;case l:U=G/i;break;case d:U=G/1e3;break;default:U=G}return I?U:M.a(U)},N.daysInMonth=function(){return this.endOf(m).$D},N.$locale=function(){return D[this.$L]},N.locale=function(C,k){if(!C)return this.$L;var I=this.clone(),U=X(C,k,!0);return U&&(I.$L=U),I},N.clone=function(){return M.w(this.$d,this)},N.toDate=function(){return new Date(this.valueOf())},N.toJSON=function(){return this.isValid()?this.toISOString():null},N.toISOString=function(){return this.$d.toISOString()},N.toString=function(){return this.$d.toUTCString()},E}(),S=F.prototype;return H.prototype=S,[["$ms",c],["$s",d],["$m",l],["$H",u],["$W",h],["$M",m],["$y",g],["$D",v]].forEach(function(E){S[E[1]]=function(N){return this.$g(N,E[0],E[1])}}),H.extend=function(E,N){return E.$i||(E(N,F,H),E.$i=!0),H},H.locale=X,H.isDayjs=q,H.unix=function(E){return H(1e3*E)},H.en=D[R],H.Ls=D,H.p={},H})},{}],392:[function(r,s,a){(function(i,o){typeof a=="object"&&s!==void 0?s.exports=o():(i=typeof globalThis<"u"?globalThis:i||self).dayjs_plugin_customParseFormat=o()})(void 0,function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},o=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,c=/\d\d/,d=/\d\d?/,l=/\d*[^-_:/,()\s\d]+/,u={},h=function(y){return(y=+y)+(y>68?1900:2e3)},f=function(y){return function(b){this[y]=+b}},m=[/[+-]\d\d:?(\d\d)?|Z/,function(y){(this.zone||(this.zone={})).offset=function(b){if(!b||b==="Z")return 0;var j=b.match(/([+-]|\d\d)/g),T=60*j[1]+(+j[2]||0);return T===0?0:j[0]==="+"?-T:T}(y)}],p=function(y){var b=u[y];return b&&(b.indexOf?b:b.s.concat(b.f))},g=function(y,b){var j,T=u.meridiem;if(T){for(var O=1;O<=24;O+=1)if(y.indexOf(T(O,0,b))>-1){j=O>12;break}}else j=y===(b?"pm":"PM");return j},v={A:[l,function(y){this.afternoon=g(y,!1)}],a:[l,function(y){this.afternoon=g(y,!0)}],S:[/\d/,function(y){this.milliseconds=100*+y}],SS:[c,function(y){this.milliseconds=10*+y}],SSS:[/\d{3}/,function(y){this.milliseconds=+y}],s:[d,f("seconds")],ss:[d,f("seconds")],m:[d,f("minutes")],mm:[d,f("minutes")],H:[d,f("hours")],h:[d,f("hours")],HH:[d,f("hours")],hh:[d,f("hours")],D:[d,f("day")],DD:[c,f("day")],Do:[l,function(y){var b=u.ordinal,j=y.match(/\d+/);if(this.day=j[0],b)for(var T=1;T<=31;T+=1)b(T).replace(/\[|\]/g,"")===y&&(this.day=T)}],M:[d,f("month")],MM:[c,f("month")],MMM:[l,function(y){var b=p("months"),j=(p("monthsShort")||b.map(function(T){return T.slice(0,3)})).indexOf(y)+1;if(j<1)throw new Error;this.month=j%12||j}],MMMM:[l,function(y){var b=p("months").indexOf(y)+1;if(b<1)throw new Error;this.month=b%12||b}],Y:[/[+-]?\d+/,f("year")],YY:[c,function(y){this.year=h(y)}],YYYY:[/\d{4}/,f("year")],Z:m,ZZ:m};function x(y){var b,j;b=y,j=u&&u.formats;for(var T=(y=b.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(H,M,F){var S=F&&F.toUpperCase();return M||j[F]||i[F]||j[S].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(E,N,C){return N||C.slice(1)})})).match(o),O=T.length,R=0;R<O;R+=1){var D=T[R],L=v[D],q=L&&L[0],X=L&&L[1];T[R]=X?{regex:q,parser:X}:D.replace(/^\[|\]$/g,"")}return function(H){for(var M={},F=0,S=0;F<O;F+=1){var E=T[F];if(typeof E=="string")S+=E.length;else{var N=E.regex,C=E.parser,k=H.slice(S),I=N.exec(k)[0];C.call(M,I),H=H.replace(I,"")}}return function(U){var $=U.afternoon;if($!==void 0){var Y=U.hours;$?Y<12&&(U.hours+=12):Y===12&&(U.hours=0),delete U.afternoon}}(M),M}}return function(y,b,j){j.p.customParseFormat=!0,y&&y.parseTwoDigitYear&&(h=y.parseTwoDigitYear);var T=b.prototype,O=T.parse;T.parse=function(R){var D=R.date,L=R.utc,q=R.args;this.$u=L;var X=q[1];if(typeof X=="string"){var H=q[2]===!0,M=q[3]===!0,F=H||M,S=q[2];M&&(S=q[2]),u=this.$locale(),!H&&S&&(u=j.Ls[S]),this.$d=function(k,I,U){try{if(["x","X"].indexOf(I)>-1)return new Date((I==="X"?1e3:1)*k);var $=x(I)(k),Y=$.year,Z=$.month,re=$.day,G=$.hours,J=$.minutes,V=$.seconds,W=$.milliseconds,ee=$.zone,ie=new Date,oe=re||(Y||Z?1:ie.getDate()),se=Y||ie.getFullYear(),le=0;Y&&!Z||(le=Z>0?Z-1:ie.getMonth());var ye=G||0,ue=J||0,ne=V||0,pe=W||0;return ee?new Date(Date.UTC(se,le,oe,ye,ue,ne,pe+60*ee.offset*1e3)):U?new Date(Date.UTC(se,le,oe,ye,ue,ne,pe)):new Date(se,le,oe,ye,ue,ne,pe)}catch{return new Date("")}}(D,X,L),this.init(),S&&S!==!0&&(this.$L=this.locale(S).$L),F&&D!=this.format(X)&&(this.$d=new Date("")),u={}}else if(X instanceof Array)for(var E=X.length,N=1;N<=E;N+=1){q[1]=X[N-1];var C=j.apply(this,q);if(C.isValid()){this.$d=C.$d,this.$L=C.$L,this.init();break}N===E&&(this.$d=new Date(""))}else O.call(this,R)}}})},{}],393:[function(r,s,a){(function(i,o){typeof a=="object"&&s!==void 0?s.exports=o():(i=typeof globalThis<"u"?globalThis:i||self).dayjs_plugin_utc=o()})(void 0,function(){var i="minute",o=/[+-]\d\d(?::?\d\d)?/g,c=/([+-]|\d\d)/g;return function(d,l,u){var h=l.prototype;u.utc=function(y){var b={date:y,utc:!0,args:arguments};return new l(b)},h.utc=function(y){var b=u(this.toDate(),{locale:this.$L,utc:!0});return y?b.add(this.utcOffset(),i):b},h.local=function(){return u(this.toDate(),{locale:this.$L,utc:!1})};var f=h.parse;h.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),f.call(this,y)};var m=h.init;h.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else m.call(this)};var p=h.utcOffset;h.utcOffset=function(y,b){var j=this.$utils().u;if(j(y))return this.$u?0:j(this.$offset)?p.call(this):this.$offset;if(typeof y=="string"&&(y=function(D){D===void 0&&(D="");var L=D.match(o);if(!L)return null;var q=(""+L[0]).match(c)||["-",0,0],X=q[0],H=60*+q[1]+ +q[2];return H===0?0:X==="+"?H:-H}(y))===null)return this;var T=Math.abs(y)<=16?60*y:y,O=this;if(b)return O.$offset=T,O.$u=y===0,O;if(y!==0){var R=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(O=this.local().add(T+R,i)).$offset=T,O.$x.$localOffset=R}else O=this.utc();return O};var g=h.format;h.format=function(y){var b=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return g.call(this,b)},h.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},h.isUTC=function(){return!!this.$u},h.toISOString=function(){return this.toDate().toISOString()},h.toString=function(){return this.toDate().toUTCString()};var v=h.toDate;h.toDate=function(y){return y==="s"&&this.$offset?u(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():v.call(this)};var x=h.diff;h.diff=function(y,b,j){if(y&&this.$u===y.$u)return x.call(this,y,b,j);var T=this.local(),O=u(y).local();return x.call(T,O,b,j)}}})},{}],394:[function(r,s,a){a.utils=r("./des/utils"),a.Cipher=r("./des/cipher"),a.DES=r("./des/des"),a.CBC=r("./des/cbc"),a.EDE=r("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(r,s,a){var i=r("minimalistic-assert"),o=r("inherits"),c={};function d(l){i.equal(l.length,8,"Invalid IV length"),this.iv=new Array(8);for(var u=0;u<this.iv.length;u++)this.iv[u]=l[u]}a.instantiate=function(l){function u(p){l.call(this,p),this._cbcInit()}o(u,l);for(var h=Object.keys(c),f=0;f<h.length;f++){var m=h[f];u.prototype[m]=c[m]}return u.create=function(p){return new u(p)},u},c._cbcInit=function(){var l=new d(this.options.iv);this._cbcState=l},c._update=function(l,u,h,f){var m=this._cbcState,p=this.constructor.super_.prototype,g=m.iv;if(this.type==="encrypt"){for(var v=0;v<this.blockSize;v++)g[v]^=l[u+v];for(p._update.call(this,g,0,h,f),v=0;v<this.blockSize;v++)g[v]=h[f+v]}else{for(p._update.call(this,l,u,h,f),v=0;v<this.blockSize;v++)h[f+v]^=g[v];for(v=0;v<this.blockSize;v++)g[v]=l[u+v]}}},{inherits:440,"minimalistic-assert":453}],396:[function(r,s,a){var i=r("minimalistic-assert");function o(c){this.options=c,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=c.padding!==!1}s.exports=o,o.prototype._init=function(){},o.prototype.update=function(c){return c.length===0?[]:this.type==="decrypt"?this._updateDecrypt(c):this._updateEncrypt(c)},o.prototype._buffer=function(c,d){for(var l=Math.min(this.buffer.length-this.bufferOff,c.length-d),u=0;u<l;u++)this.buffer[this.bufferOff+u]=c[d+u];return this.bufferOff+=l,l},o.prototype._flushBuffer=function(c,d){return this._update(this.buffer,0,c,d),this.bufferOff=0,this.blockSize},o.prototype._updateEncrypt=function(c){var d=0,l=0,u=(this.bufferOff+c.length)/this.blockSize|0,h=new Array(u*this.blockSize);this.bufferOff!==0&&(d+=this._buffer(c,d),this.bufferOff===this.buffer.length&&(l+=this._flushBuffer(h,l)));for(var f=c.length-(c.length-d)%this.blockSize;d<f;d+=this.blockSize)this._update(c,d,h,l),l+=this.blockSize;for(;d<c.length;d++,this.bufferOff++)this.buffer[this.bufferOff]=c[d];return h},o.prototype._updateDecrypt=function(c){for(var d=0,l=0,u=Math.ceil((this.bufferOff+c.length)/this.blockSize)-1,h=new Array(u*this.blockSize);u>0;u--)d+=this._buffer(c,d),l+=this._flushBuffer(h,l);return d+=this._buffer(c,d),h},o.prototype.final=function(c){var d,l;return c&&(d=this.update(c)),l=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),d?d.concat(l):l},o.prototype._pad=function(c,d){if(d===0)return!1;for(;d<c.length;)c[d++]=0;return!0},o.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var c=new Array(this.blockSize);return this._update(this.buffer,0,c,0),c},o.prototype._unpad=function(c){return c},o.prototype._finalDecrypt=function(){i.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var c=new Array(this.blockSize);return this._flushBuffer(c,0),this._unpad(c)}},{"minimalistic-assert":453}],397:[function(r,s,a){var i=r("minimalistic-assert"),o=r("inherits"),c=r("./utils"),d=r("./cipher");function l(){this.tmp=new Array(2),this.keys=null}function u(f){d.call(this,f);var m=new l;this._desState=m,this.deriveKeys(m,f.key)}o(u,d),s.exports=u,u.create=function(f){return new u(f)};var h=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];u.prototype.deriveKeys=function(f,m){f.keys=new Array(32),i.equal(m.length,this.blockSize,"Invalid key length");var p=c.readUInt32BE(m,0),g=c.readUInt32BE(m,4);c.pc1(p,g,f.tmp,0),p=f.tmp[0],g=f.tmp[1];for(var v=0;v<f.keys.length;v+=2){var x=h[v>>>1];p=c.r28shl(p,x),g=c.r28shl(g,x),c.pc2(p,g,f.keys,v)}},u.prototype._update=function(f,m,p,g){var v=this._desState,x=c.readUInt32BE(f,m),y=c.readUInt32BE(f,m+4);c.ip(x,y,v.tmp,0),x=v.tmp[0],y=v.tmp[1],this.type==="encrypt"?this._encrypt(v,x,y,v.tmp,0):this._decrypt(v,x,y,v.tmp,0),x=v.tmp[0],y=v.tmp[1],c.writeUInt32BE(p,x,g),c.writeUInt32BE(p,y,g+4)},u.prototype._pad=function(f,m){if(this.padding===!1)return!1;for(var p=f.length-m,g=m;g<f.length;g++)f[g]=p;return!0},u.prototype._unpad=function(f){if(this.padding===!1)return f;for(var m=f[f.length-1],p=f.length-m;p<f.length;p++)i.equal(f[p],m);return f.slice(0,f.length-m)},u.prototype._encrypt=function(f,m,p,g,v){for(var x=m,y=p,b=0;b<f.keys.length;b+=2){var j=f.keys[b],T=f.keys[b+1];c.expand(y,f.tmp,0),j^=f.tmp[0],T^=f.tmp[1];var O=c.substitute(j,T),R=y;y=(x^c.permute(O))>>>0,x=R}c.rip(y,x,g,v)},u.prototype._decrypt=function(f,m,p,g,v){for(var x=p,y=m,b=f.keys.length-2;b>=0;b-=2){var j=f.keys[b],T=f.keys[b+1];c.expand(x,f.tmp,0),j^=f.tmp[0],T^=f.tmp[1];var O=c.substitute(j,T),R=x;x=(y^c.permute(O))>>>0,y=R}c.rip(x,y,g,v)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(r,s,a){var i=r("minimalistic-assert"),o=r("inherits"),c=r("./cipher"),d=r("./des");function l(h,f){i.equal(f.length,24,"Invalid key length");var m=f.slice(0,8),p=f.slice(8,16),g=f.slice(16,24);this.ciphers=h==="encrypt"?[d.create({type:"encrypt",key:m}),d.create({type:"decrypt",key:p}),d.create({type:"encrypt",key:g})]:[d.create({type:"decrypt",key:g}),d.create({type:"encrypt",key:p}),d.create({type:"decrypt",key:m})]}function u(h){c.call(this,h);var f=new l(this.type,this.options.key);this._edeState=f}o(u,c),s.exports=u,u.create=function(h){return new u(h)},u.prototype._update=function(h,f,m,p){var g=this._edeState;g.ciphers[0]._update(h,f,m,p),g.ciphers[1]._update(m,p,m,p),g.ciphers[2]._update(m,p,m,p)},u.prototype._pad=d.prototype._pad,u.prototype._unpad=d.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(r,s,a){a.readUInt32BE=function(d,l){return(d[0+l]<<24|d[1+l]<<16|d[2+l]<<8|d[3+l])>>>0},a.writeUInt32BE=function(d,l,u){d[0+u]=l>>>24,d[1+u]=l>>>16&255,d[2+u]=l>>>8&255,d[3+u]=255&l},a.ip=function(d,l,u,h){for(var f=0,m=0,p=6;p>=0;p-=2){for(var g=0;g<=24;g+=8)f<<=1,f|=l>>>g+p&1;for(g=0;g<=24;g+=8)f<<=1,f|=d>>>g+p&1}for(p=6;p>=0;p-=2){for(g=1;g<=25;g+=8)m<<=1,m|=l>>>g+p&1;for(g=1;g<=25;g+=8)m<<=1,m|=d>>>g+p&1}u[h+0]=f>>>0,u[h+1]=m>>>0},a.rip=function(d,l,u,h){for(var f=0,m=0,p=0;p<4;p++)for(var g=24;g>=0;g-=8)f<<=1,f|=l>>>g+p&1,f<<=1,f|=d>>>g+p&1;for(p=4;p<8;p++)for(g=24;g>=0;g-=8)m<<=1,m|=l>>>g+p&1,m<<=1,m|=d>>>g+p&1;u[h+0]=f>>>0,u[h+1]=m>>>0},a.pc1=function(d,l,u,h){for(var f=0,m=0,p=7;p>=5;p--){for(var g=0;g<=24;g+=8)f<<=1,f|=l>>g+p&1;for(g=0;g<=24;g+=8)f<<=1,f|=d>>g+p&1}for(g=0;g<=24;g+=8)f<<=1,f|=l>>g+p&1;for(p=1;p<=3;p++){for(g=0;g<=24;g+=8)m<<=1,m|=l>>g+p&1;for(g=0;g<=24;g+=8)m<<=1,m|=d>>g+p&1}for(g=0;g<=24;g+=8)m<<=1,m|=d>>g+p&1;u[h+0]=f>>>0,u[h+1]=m>>>0},a.r28shl=function(d,l){return d<<l&268435455|d>>>28-l};var i=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];a.pc2=function(d,l,u,h){for(var f=0,m=0,p=i.length>>>1,g=0;g<p;g++)f<<=1,f|=d>>>i[g]&1;for(g=p;g<i.length;g++)m<<=1,m|=l>>>i[g]&1;u[h+0]=f>>>0,u[h+1]=m>>>0},a.expand=function(d,l,u){var h=0,f=0;h=(1&d)<<5|d>>>27;for(var m=23;m>=15;m-=4)h<<=6,h|=d>>>m&63;for(m=11;m>=3;m-=4)f|=d>>>m&63,f<<=6;f|=(31&d)<<1|d>>>31,l[u+0]=h>>>0,l[u+1]=f>>>0};var o=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];a.substitute=function(d,l){for(var u=0,h=0;h<4;h++)u<<=4,u|=o[64*h+(d>>>18-6*h&63)];for(h=0;h<4;h++)u<<=4,u|=o[256+64*h+(l>>>18-6*h&63)];return u>>>0};var c=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];a.permute=function(d){for(var l=0,u=0;u<c.length;u++)l<<=1,l|=d>>>c[u]&1;return l>>>0},a.padSplit=function(d,l,u){for(var h=d.toString(2);h.length<l;)h="0"+h;for(var f=[],m=0;m<l;m+=u)f.push(h.slice(m,m+u));return f.join(" ")}},{}],400:[function(r,s,a){(function(i){(function(){var o=r("./lib/generatePrime"),c=r("./lib/primes.json"),d=r("./lib/dh"),l={binary:!0,hex:!0,base64:!0};a.DiffieHellmanGroup=a.createDiffieHellmanGroup=a.getDiffieHellman=function(u){var h=new i(c[u].prime,"hex"),f=new i(c[u].gen,"hex");return new d(h,f)},a.createDiffieHellman=a.DiffieHellman=function u(h,f,m,p){return i.isBuffer(f)||l[f]===void 0?u(h,"binary",f,m):(f=f||"binary",p=p||"binary",m=m||new i([2]),i.isBuffer(m)||(m=new i(m,p)),typeof h=="number"?new d(o(h,m),m,!0):(i.isBuffer(h)||(h=new i(h,f)),new d(h,m,!0)))}}).call(this)}).call(this,r("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(r,s,a){(function(i){(function(){var o=r("bn.js"),c=new(r("miller-rabin")),d=new o(24),l=new o(11),u=new o(10),h=new o(3),f=new o(7),m=r("./generatePrime"),p=r("randombytes");function g(j,T){return T=T||"utf8",i.isBuffer(j)||(j=new i(j,T)),this._pub=new o(j),this}function v(j,T){return T=T||"utf8",i.isBuffer(j)||(j=new i(j,T)),this._priv=new o(j),this}s.exports=y;var x={};function y(j,T,O){this.setGenerator(T),this.__prime=new o(j),this._prime=o.mont(this.__prime),this._primeLen=j.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,O?(this.setPublicKey=g,this.setPrivateKey=v):this._primeCode=8}function b(j,T){var O=new i(j.toArray());return T?O.toString(T):O}Object.defineProperty(y.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=function(j,T){var O=T.toString("hex"),R=[O,j.toString(16)].join("_");if(R in x)return x[R];var D,L=0;if(j.isEven()||!m.simpleSieve||!m.fermatTest(j)||!c.test(j))return L+=1,L+=O==="02"||O==="05"?8:4,x[R]=L,L;switch(c.test(j.shrn(1))||(L+=2),O){case"02":j.mod(d).cmp(l)&&(L+=8);break;case"05":(D=j.mod(u)).cmp(h)&&D.cmp(f)&&(L+=8);break;default:L+=4}return x[R]=L,L}(this.__prime,this.__gen)),this._primeCode}}),y.prototype.generateKeys=function(){return this._priv||(this._priv=new o(p(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},y.prototype.computeSecret=function(j){var T=(j=(j=new o(j)).toRed(this._prime)).redPow(this._priv).fromRed(),O=new i(T.toArray()),R=this.getPrime();if(O.length<R.length){var D=new i(R.length-O.length);D.fill(0),O=i.concat([D,O])}return O},y.prototype.getPublicKey=function(j){return b(this._pub,j)},y.prototype.getPrivateKey=function(j){return b(this._priv,j)},y.prototype.getPrime=function(j){return b(this.__prime,j)},y.prototype.getGenerator=function(j){return b(this._gen,j)},y.prototype.setGenerator=function(j,T){return T=T||"utf8",i.isBuffer(j)||(j=new i(j,T)),this.__gen=j,this._gen=new o(j),this}}).call(this)}).call(this,r("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(r,s,a){var i=r("randombytes");s.exports=j,j.simpleSieve=y,j.fermatTest=b;var o=r("bn.js"),c=new o(24),d=new(r("miller-rabin")),l=new o(1),u=new o(2),h=new o(5),f=(new o(16),new o(8),new o(10)),m=new o(3),p=(new o(7),new o(11)),g=new o(4),v=(new o(12),null);function x(){if(v!==null)return v;var T=[];T[0]=2;for(var O=1,R=3;R<1048576;R+=2){for(var D=Math.ceil(Math.sqrt(R)),L=0;L<O&&T[L]<=D&&R%T[L]!=0;L++);O!==L&&T[L]<=D||(T[O++]=R)}return v=T,T}function y(T){for(var O=x(),R=0;R<O.length;R++)if(T.modn(O[R])===0)return T.cmpn(O[R])===0;return!0}function b(T){var O=o.mont(T);return u.toRed(O).redPow(T.subn(1)).fromRed().cmpn(1)===0}function j(T,O){if(T<16)return new o(O===2||O===5?[140,123]:[140,39]);var R,D;for(O=new o(O);;){for(R=new o(i(Math.ceil(T/8)));R.bitLength()>T;)R.ishrn(1);if(R.isEven()&&R.iadd(l),R.testn(1)||R.iadd(u),O.cmp(u)){if(!O.cmp(h))for(;R.mod(f).cmp(m);)R.iadd(g)}else for(;R.mod(c).cmp(p);)R.iadd(g);if(y(D=R.shrn(1))&&y(R)&&b(D)&&b(R)&&d.test(D)&&d.test(R))return R}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(r,s,a){s.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(r,s,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],405:[function(r,s,a){var i=a;i.version=r("../package.json").version,i.utils=r("./elliptic/utils"),i.rand=r("brorand"),i.curve=r("./elliptic/curve"),i.curves=r("./elliptic/curves"),i.ec=r("./elliptic/ec"),i.eddsa=r("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(r,s,a){var i=r("bn.js"),o=r("../utils"),c=o.getNAF,d=o.getJSF,l=o.assert;function u(f,m){this.type=f,this.p=new i(m.p,16),this.red=m.prime?i.red(m.prime):i.mont(this.p),this.zero=new i(0).toRed(this.red),this.one=new i(1).toRed(this.red),this.two=new i(2).toRed(this.red),this.n=m.n&&new i(m.n,16),this.g=m.g&&this.pointFromJSON(m.g,m.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var p=this.n&&this.p.div(this.n);!p||p.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function h(f,m){this.curve=f,this.type=m,this.precomputed=null}s.exports=u,u.prototype.point=function(){throw new Error("Not implemented")},u.prototype.validate=function(){throw new Error("Not implemented")},u.prototype._fixedNafMul=function(f,m){l(f.precomputed);var p=f._getDoubles(),g=c(m,1,this._bitLength),v=(1<<p.step+1)-(p.step%2==0?2:1);v/=3;var x,y,b=[];for(x=0;x<g.length;x+=p.step){y=0;for(var j=x+p.step-1;j>=x;j--)y=(y<<1)+g[j];b.push(y)}for(var T=this.jpoint(null,null,null),O=this.jpoint(null,null,null),R=v;R>0;R--){for(x=0;x<b.length;x++)(y=b[x])===R?O=O.mixedAdd(p.points[x]):y===-R&&(O=O.mixedAdd(p.points[x].neg()));T=T.add(O)}return T.toP()},u.prototype._wnafMul=function(f,m){var p=4,g=f._getNAFPoints(p);p=g.wnd;for(var v=g.points,x=c(m,p,this._bitLength),y=this.jpoint(null,null,null),b=x.length-1;b>=0;b--){for(var j=0;b>=0&&x[b]===0;b--)j++;if(b>=0&&j++,y=y.dblp(j),b<0)break;var T=x[b];l(T!==0),y=f.type==="affine"?T>0?y.mixedAdd(v[T-1>>1]):y.mixedAdd(v[-T-1>>1].neg()):T>0?y.add(v[T-1>>1]):y.add(v[-T-1>>1].neg())}return f.type==="affine"?y.toP():y},u.prototype._wnafMulAdd=function(f,m,p,g,v){var x,y,b,j=this._wnafT1,T=this._wnafT2,O=this._wnafT3,R=0;for(x=0;x<g;x++){var D=(b=m[x])._getNAFPoints(f);j[x]=D.wnd,T[x]=D.points}for(x=g-1;x>=1;x-=2){var L=x-1,q=x;if(j[L]===1&&j[q]===1){var X=[m[L],null,null,m[q]];m[L].y.cmp(m[q].y)===0?(X[1]=m[L].add(m[q]),X[2]=m[L].toJ().mixedAdd(m[q].neg())):m[L].y.cmp(m[q].y.redNeg())===0?(X[1]=m[L].toJ().mixedAdd(m[q]),X[2]=m[L].add(m[q].neg())):(X[1]=m[L].toJ().mixedAdd(m[q]),X[2]=m[L].toJ().mixedAdd(m[q].neg()));var H=[-3,-1,-5,-7,0,7,5,1,3],M=d(p[L],p[q]);for(R=Math.max(M[0].length,R),O[L]=new Array(R),O[q]=new Array(R),y=0;y<R;y++){var F=0|M[0][y],S=0|M[1][y];O[L][y]=H[3*(F+1)+(S+1)],O[q][y]=0,T[L]=X}}else O[L]=c(p[L],j[L],this._bitLength),O[q]=c(p[q],j[q],this._bitLength),R=Math.max(O[L].length,R),R=Math.max(O[q].length,R)}var E=this.jpoint(null,null,null),N=this._wnafT4;for(x=R;x>=0;x--){for(var C=0;x>=0;){var k=!0;for(y=0;y<g;y++)N[y]=0|O[y][x],N[y]!==0&&(k=!1);if(!k)break;C++,x--}if(x>=0&&C++,E=E.dblp(C),x<0)break;for(y=0;y<g;y++){var I=N[y];I!==0&&(I>0?b=T[y][I-1>>1]:I<0&&(b=T[y][-I-1>>1].neg()),E=b.type==="affine"?E.mixedAdd(b):E.add(b))}}for(x=0;x<g;x++)T[x]=null;return v?E:E.toP()},u.BasePoint=h,h.prototype.eq=function(){throw new Error("Not implemented")},h.prototype.validate=function(){return this.curve.validate(this)},u.prototype.decodePoint=function(f,m){f=o.toArray(f,m);var p=this.p.byteLength();if((f[0]===4||f[0]===6||f[0]===7)&&f.length-1==2*p)return f[0]===6?l(f[f.length-1]%2==0):f[0]===7&&l(f[f.length-1]%2==1),this.point(f.slice(1,1+p),f.slice(1+p,1+2*p));if((f[0]===2||f[0]===3)&&f.length-1===p)return this.pointFromX(f.slice(1,1+p),f[0]===3);throw new Error("Unknown point format")},h.prototype.encodeCompressed=function(f){return this.encode(f,!0)},h.prototype._encode=function(f){var m=this.curve.p.byteLength(),p=this.getX().toArray("be",m);return f?[this.getY().isEven()?2:3].concat(p):[4].concat(p,this.getY().toArray("be",m))},h.prototype.encode=function(f,m){return o.encode(this._encode(m),f)},h.prototype.precompute=function(f){if(this.precomputed)return this;var m={doubles:null,naf:null,beta:null};return m.naf=this._getNAFPoints(8),m.doubles=this._getDoubles(4,f),m.beta=this._getBeta(),this.precomputed=m,this},h.prototype._hasDoubles=function(f){if(!this.precomputed)return!1;var m=this.precomputed.doubles;return!!m&&m.points.length>=Math.ceil((f.bitLength()+1)/m.step)},h.prototype._getDoubles=function(f,m){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var p=[this],g=this,v=0;v<m;v+=f){for(var x=0;x<f;x++)g=g.dbl();p.push(g)}return{step:f,points:p}},h.prototype._getNAFPoints=function(f){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var m=[this],p=(1<<f)-1,g=p===1?null:this.dbl(),v=1;v<p;v++)m[v]=m[v-1].add(g);return{wnd:f,points:m}},h.prototype._getBeta=function(){return null},h.prototype.dblp=function(f){for(var m=this,p=0;p<f;p++)m=m.dbl();return m}},{"../utils":419,"bn.js":420}],407:[function(r,s,a){var i=r("../utils"),o=r("bn.js"),c=r("inherits"),d=r("./base"),l=i.assert;function u(f){this.twisted=(0|f.a)!=1,this.mOneA=this.twisted&&(0|f.a)==-1,this.extended=this.mOneA,d.call(this,"edwards",f),this.a=new o(f.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new o(f.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new o(f.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),l(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|f.c)==1}function h(f,m,p,g,v){d.BasePoint.call(this,f,"projective"),m===null&&p===null&&g===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new o(m,16),this.y=new o(p,16),this.z=g?new o(g,16):this.curve.one,this.t=v&&new o(v,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}c(u,d),s.exports=u,u.prototype._mulA=function(f){return this.mOneA?f.redNeg():this.a.redMul(f)},u.prototype._mulC=function(f){return this.oneC?f:this.c.redMul(f)},u.prototype.jpoint=function(f,m,p,g){return this.point(f,m,p,g)},u.prototype.pointFromX=function(f,m){(f=new o(f,16)).red||(f=f.toRed(this.red));var p=f.redSqr(),g=this.c2.redSub(this.a.redMul(p)),v=this.one.redSub(this.c2.redMul(this.d).redMul(p)),x=g.redMul(v.redInvm()),y=x.redSqrt();if(y.redSqr().redSub(x).cmp(this.zero)!==0)throw new Error("invalid point");var b=y.fromRed().isOdd();return(m&&!b||!m&&b)&&(y=y.redNeg()),this.point(f,y)},u.prototype.pointFromY=function(f,m){(f=new o(f,16)).red||(f=f.toRed(this.red));var p=f.redSqr(),g=p.redSub(this.c2),v=p.redMul(this.d).redMul(this.c2).redSub(this.a),x=g.redMul(v.redInvm());if(x.cmp(this.zero)===0){if(m)throw new Error("invalid point");return this.point(this.zero,f)}var y=x.redSqrt();if(y.redSqr().redSub(x).cmp(this.zero)!==0)throw new Error("invalid point");return y.fromRed().isOdd()!==m&&(y=y.redNeg()),this.point(y,f)},u.prototype.validate=function(f){if(f.isInfinity())return!0;f.normalize();var m=f.x.redSqr(),p=f.y.redSqr(),g=m.redMul(this.a).redAdd(p),v=this.c2.redMul(this.one.redAdd(this.d.redMul(m).redMul(p)));return g.cmp(v)===0},c(h,d.BasePoint),u.prototype.pointFromJSON=function(f){return h.fromJSON(this,f)},u.prototype.point=function(f,m,p,g){return new h(this,f,m,p,g)},h.fromJSON=function(f,m){return new h(f,m[0],m[1],m[2])},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},h.prototype._extDbl=function(){var f=this.x.redSqr(),m=this.y.redSqr(),p=this.z.redSqr();p=p.redIAdd(p);var g=this.curve._mulA(f),v=this.x.redAdd(this.y).redSqr().redISub(f).redISub(m),x=g.redAdd(m),y=x.redSub(p),b=g.redSub(m),j=v.redMul(y),T=x.redMul(b),O=v.redMul(b),R=y.redMul(x);return this.curve.point(j,T,R,O)},h.prototype._projDbl=function(){var f,m,p,g,v,x,y=this.x.redAdd(this.y).redSqr(),b=this.x.redSqr(),j=this.y.redSqr();if(this.curve.twisted){var T=(g=this.curve._mulA(b)).redAdd(j);this.zOne?(f=y.redSub(b).redSub(j).redMul(T.redSub(this.curve.two)),m=T.redMul(g.redSub(j)),p=T.redSqr().redSub(T).redSub(T)):(v=this.z.redSqr(),x=T.redSub(v).redISub(v),f=y.redSub(b).redISub(j).redMul(x),m=T.redMul(g.redSub(j)),p=T.redMul(x))}else g=b.redAdd(j),v=this.curve._mulC(this.z).redSqr(),x=g.redSub(v).redSub(v),f=this.curve._mulC(y.redISub(g)).redMul(x),m=this.curve._mulC(g).redMul(b.redISub(j)),p=g.redMul(x);return this.curve.point(f,m,p)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},h.prototype._extAdd=function(f){var m=this.y.redSub(this.x).redMul(f.y.redSub(f.x)),p=this.y.redAdd(this.x).redMul(f.y.redAdd(f.x)),g=this.t.redMul(this.curve.dd).redMul(f.t),v=this.z.redMul(f.z.redAdd(f.z)),x=p.redSub(m),y=v.redSub(g),b=v.redAdd(g),j=p.redAdd(m),T=x.redMul(y),O=b.redMul(j),R=x.redMul(j),D=y.redMul(b);return this.curve.point(T,O,D,R)},h.prototype._projAdd=function(f){var m,p,g=this.z.redMul(f.z),v=g.redSqr(),x=this.x.redMul(f.x),y=this.y.redMul(f.y),b=this.curve.d.redMul(x).redMul(y),j=v.redSub(b),T=v.redAdd(b),O=this.x.redAdd(this.y).redMul(f.x.redAdd(f.y)).redISub(x).redISub(y),R=g.redMul(j).redMul(O);return this.curve.twisted?(m=g.redMul(T).redMul(y.redSub(this.curve._mulA(x))),p=j.redMul(T)):(m=g.redMul(T).redMul(y.redSub(x)),p=this.curve._mulC(j).redMul(T)),this.curve.point(R,m,p)},h.prototype.add=function(f){return this.isInfinity()?f:f.isInfinity()?this:this.curve.extended?this._extAdd(f):this._projAdd(f)},h.prototype.mul=function(f){return this._hasDoubles(f)?this.curve._fixedNafMul(this,f):this.curve._wnafMul(this,f)},h.prototype.mulAdd=function(f,m,p){return this.curve._wnafMulAdd(1,[this,m],[f,p],2,!1)},h.prototype.jmulAdd=function(f,m,p){return this.curve._wnafMulAdd(1,[this,m],[f,p],2,!0)},h.prototype.normalize=function(){if(this.zOne)return this;var f=this.z.redInvm();return this.x=this.x.redMul(f),this.y=this.y.redMul(f),this.t&&(this.t=this.t.redMul(f)),this.z=this.curve.one,this.zOne=!0,this},h.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},h.prototype.getX=function(){return this.normalize(),this.x.fromRed()},h.prototype.getY=function(){return this.normalize(),this.y.fromRed()},h.prototype.eq=function(f){return this===f||this.getX().cmp(f.getX())===0&&this.getY().cmp(f.getY())===0},h.prototype.eqXToP=function(f){var m=f.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(m)===0)return!0;for(var p=f.clone(),g=this.curve.redN.redMul(this.z);;){if(p.iadd(this.curve.n),p.cmp(this.curve.p)>=0)return!1;if(m.redIAdd(g),this.x.cmp(m)===0)return!0}},h.prototype.toP=h.prototype.normalize,h.prototype.mixedAdd=h.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(r,s,a){var i=a;i.base=r("./base"),i.short=r("./short"),i.mont=r("./mont"),i.edwards=r("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(r,s,a){var i=r("bn.js"),o=r("inherits"),c=r("./base"),d=r("../utils");function l(h){c.call(this,"mont",h),this.a=new i(h.a,16).toRed(this.red),this.b=new i(h.b,16).toRed(this.red),this.i4=new i(4).toRed(this.red).redInvm(),this.two=new i(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function u(h,f,m){c.BasePoint.call(this,h,"projective"),f===null&&m===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new i(f,16),this.z=new i(m,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}o(l,c),s.exports=l,l.prototype.validate=function(h){var f=h.normalize().x,m=f.redSqr(),p=m.redMul(f).redAdd(m.redMul(this.a)).redAdd(f);return p.redSqrt().redSqr().cmp(p)===0},o(u,c.BasePoint),l.prototype.decodePoint=function(h,f){return this.point(d.toArray(h,f),1)},l.prototype.point=function(h,f){return new u(this,h,f)},l.prototype.pointFromJSON=function(h){return u.fromJSON(this,h)},u.prototype.precompute=function(){},u.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},u.fromJSON=function(h,f){return new u(h,f[0],f[1]||h.one)},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.z.cmpn(0)===0},u.prototype.dbl=function(){var h=this.x.redAdd(this.z).redSqr(),f=this.x.redSub(this.z).redSqr(),m=h.redSub(f),p=h.redMul(f),g=m.redMul(f.redAdd(this.curve.a24.redMul(m)));return this.curve.point(p,g)},u.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.diffAdd=function(h,f){var m=this.x.redAdd(this.z),p=this.x.redSub(this.z),g=h.x.redAdd(h.z),v=h.x.redSub(h.z).redMul(m),x=g.redMul(p),y=f.z.redMul(v.redAdd(x).redSqr()),b=f.x.redMul(v.redISub(x).redSqr());return this.curve.point(y,b)},u.prototype.mul=function(h){for(var f=h.clone(),m=this,p=this.curve.point(null,null),g=[];f.cmpn(0)!==0;f.iushrn(1))g.push(f.andln(1));for(var v=g.length-1;v>=0;v--)g[v]===0?(m=m.diffAdd(p,this),p=p.dbl()):(p=m.diffAdd(p,this),m=m.dbl());return p},u.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.eq=function(h){return this.getX().cmp(h.getX())===0},u.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(r,s,a){var i=r("../utils"),o=r("bn.js"),c=r("inherits"),d=r("./base"),l=i.assert;function u(m){d.call(this,"short",m),this.a=new o(m.a,16).toRed(this.red),this.b=new o(m.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(m),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function h(m,p,g,v){d.BasePoint.call(this,m,"affine"),p===null&&g===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new o(p,16),this.y=new o(g,16),v&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function f(m,p,g,v){d.BasePoint.call(this,m,"jacobian"),p===null&&g===null&&v===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new o(0)):(this.x=new o(p,16),this.y=new o(g,16),this.z=new o(v,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}c(u,d),s.exports=u,u.prototype._getEndomorphism=function(m){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var p,g;if(m.beta)p=new o(m.beta,16).toRed(this.red);else{var v=this._getEndoRoots(this.p);p=(p=v[0].cmp(v[1])<0?v[0]:v[1]).toRed(this.red)}if(m.lambda)g=new o(m.lambda,16);else{var x=this._getEndoRoots(this.n);this.g.mul(x[0]).x.cmp(this.g.x.redMul(p))===0?g=x[0]:(g=x[1],l(this.g.mul(g).x.cmp(this.g.x.redMul(p))===0))}return{beta:p,lambda:g,basis:m.basis?m.basis.map(function(y){return{a:new o(y.a,16),b:new o(y.b,16)}}):this._getEndoBasis(g)}}},u.prototype._getEndoRoots=function(m){var p=m===this.p?this.red:o.mont(m),g=new o(2).toRed(p).redInvm(),v=g.redNeg(),x=new o(3).toRed(p).redNeg().redSqrt().redMul(g);return[v.redAdd(x).fromRed(),v.redSub(x).fromRed()]},u.prototype._getEndoBasis=function(m){for(var p,g,v,x,y,b,j,T,O,R=this.n.ushrn(Math.floor(this.n.bitLength()/2)),D=m,L=this.n.clone(),q=new o(1),X=new o(0),H=new o(0),M=new o(1),F=0;D.cmpn(0)!==0;){var S=L.div(D);T=L.sub(S.mul(D)),O=H.sub(S.mul(q));var E=M.sub(S.mul(X));if(!v&&T.cmp(R)<0)p=j.neg(),g=q,v=T.neg(),x=O;else if(v&&++F==2)break;j=T,L=D,D=T,H=q,q=O,M=X,X=E}y=T.neg(),b=O;var N=v.sqr().add(x.sqr());return y.sqr().add(b.sqr()).cmp(N)>=0&&(y=p,b=g),v.negative&&(v=v.neg(),x=x.neg()),y.negative&&(y=y.neg(),b=b.neg()),[{a:v,b:x},{a:y,b}]},u.prototype._endoSplit=function(m){var p=this.endo.basis,g=p[0],v=p[1],x=v.b.mul(m).divRound(this.n),y=g.b.neg().mul(m).divRound(this.n),b=x.mul(g.a),j=y.mul(v.a),T=x.mul(g.b),O=y.mul(v.b);return{k1:m.sub(b).sub(j),k2:T.add(O).neg()}},u.prototype.pointFromX=function(m,p){(m=new o(m,16)).red||(m=m.toRed(this.red));var g=m.redSqr().redMul(m).redIAdd(m.redMul(this.a)).redIAdd(this.b),v=g.redSqrt();if(v.redSqr().redSub(g).cmp(this.zero)!==0)throw new Error("invalid point");var x=v.fromRed().isOdd();return(p&&!x||!p&&x)&&(v=v.redNeg()),this.point(m,v)},u.prototype.validate=function(m){if(m.inf)return!0;var p=m.x,g=m.y,v=this.a.redMul(p),x=p.redSqr().redMul(p).redIAdd(v).redIAdd(this.b);return g.redSqr().redISub(x).cmpn(0)===0},u.prototype._endoWnafMulAdd=function(m,p,g){for(var v=this._endoWnafT1,x=this._endoWnafT2,y=0;y<m.length;y++){var b=this._endoSplit(p[y]),j=m[y],T=j._getBeta();b.k1.negative&&(b.k1.ineg(),j=j.neg(!0)),b.k2.negative&&(b.k2.ineg(),T=T.neg(!0)),v[2*y]=j,v[2*y+1]=T,x[2*y]=b.k1,x[2*y+1]=b.k2}for(var O=this._wnafMulAdd(1,v,x,2*y,g),R=0;R<2*y;R++)v[R]=null,x[R]=null;return O},c(h,d.BasePoint),u.prototype.point=function(m,p,g){return new h(this,m,p,g)},u.prototype.pointFromJSON=function(m,p){return h.fromJSON(this,m,p)},h.prototype._getBeta=function(){if(this.curve.endo){var m=this.precomputed;if(m&&m.beta)return m.beta;var p=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(m){var g=this.curve,v=function(x){return g.point(x.x.redMul(g.endo.beta),x.y)};m.beta=p,p.precomputed={beta:null,naf:m.naf&&{wnd:m.naf.wnd,points:m.naf.points.map(v)},doubles:m.doubles&&{step:m.doubles.step,points:m.doubles.points.map(v)}}}return p}},h.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},h.fromJSON=function(m,p,g){typeof p=="string"&&(p=JSON.parse(p));var v=m.point(p[0],p[1],g);if(!p[2])return v;function x(b){return m.point(b[0],b[1],g)}var y=p[2];return v.precomputed={beta:null,doubles:y.doubles&&{step:y.doubles.step,points:[v].concat(y.doubles.points.map(x))},naf:y.naf&&{wnd:y.naf.wnd,points:[v].concat(y.naf.points.map(x))}},v},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return this.inf},h.prototype.add=function(m){if(this.inf)return m;if(m.inf)return this;if(this.eq(m))return this.dbl();if(this.neg().eq(m))return this.curve.point(null,null);if(this.x.cmp(m.x)===0)return this.curve.point(null,null);var p=this.y.redSub(m.y);p.cmpn(0)!==0&&(p=p.redMul(this.x.redSub(m.x).redInvm()));var g=p.redSqr().redISub(this.x).redISub(m.x),v=p.redMul(this.x.redSub(g)).redISub(this.y);return this.curve.point(g,v)},h.prototype.dbl=function(){if(this.inf)return this;var m=this.y.redAdd(this.y);if(m.cmpn(0)===0)return this.curve.point(null,null);var p=this.curve.a,g=this.x.redSqr(),v=m.redInvm(),x=g.redAdd(g).redIAdd(g).redIAdd(p).redMul(v),y=x.redSqr().redISub(this.x.redAdd(this.x)),b=x.redMul(this.x.redSub(y)).redISub(this.y);return this.curve.point(y,b)},h.prototype.getX=function(){return this.x.fromRed()},h.prototype.getY=function(){return this.y.fromRed()},h.prototype.mul=function(m){return m=new o(m,16),this.isInfinity()?this:this._hasDoubles(m)?this.curve._fixedNafMul(this,m):this.curve.endo?this.curve._endoWnafMulAdd([this],[m]):this.curve._wnafMul(this,m)},h.prototype.mulAdd=function(m,p,g){var v=[this,p],x=[m,g];return this.curve.endo?this.curve._endoWnafMulAdd(v,x):this.curve._wnafMulAdd(1,v,x,2)},h.prototype.jmulAdd=function(m,p,g){var v=[this,p],x=[m,g];return this.curve.endo?this.curve._endoWnafMulAdd(v,x,!0):this.curve._wnafMulAdd(1,v,x,2,!0)},h.prototype.eq=function(m){return this===m||this.inf===m.inf&&(this.inf||this.x.cmp(m.x)===0&&this.y.cmp(m.y)===0)},h.prototype.neg=function(m){if(this.inf)return this;var p=this.curve.point(this.x,this.y.redNeg());if(m&&this.precomputed){var g=this.precomputed,v=function(x){return x.neg()};p.precomputed={naf:g.naf&&{wnd:g.naf.wnd,points:g.naf.points.map(v)},doubles:g.doubles&&{step:g.doubles.step,points:g.doubles.points.map(v)}}}return p},h.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},c(f,d.BasePoint),u.prototype.jpoint=function(m,p,g){return new f(this,m,p,g)},f.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var m=this.z.redInvm(),p=m.redSqr(),g=this.x.redMul(p),v=this.y.redMul(p).redMul(m);return this.curve.point(g,v)},f.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},f.prototype.add=function(m){if(this.isInfinity())return m;if(m.isInfinity())return this;var p=m.z.redSqr(),g=this.z.redSqr(),v=this.x.redMul(p),x=m.x.redMul(g),y=this.y.redMul(p.redMul(m.z)),b=m.y.redMul(g.redMul(this.z)),j=v.redSub(x),T=y.redSub(b);if(j.cmpn(0)===0)return T.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var O=j.redSqr(),R=O.redMul(j),D=v.redMul(O),L=T.redSqr().redIAdd(R).redISub(D).redISub(D),q=T.redMul(D.redISub(L)).redISub(y.redMul(R)),X=this.z.redMul(m.z).redMul(j);return this.curve.jpoint(L,q,X)},f.prototype.mixedAdd=function(m){if(this.isInfinity())return m.toJ();if(m.isInfinity())return this;var p=this.z.redSqr(),g=this.x,v=m.x.redMul(p),x=this.y,y=m.y.redMul(p).redMul(this.z),b=g.redSub(v),j=x.redSub(y);if(b.cmpn(0)===0)return j.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var T=b.redSqr(),O=T.redMul(b),R=g.redMul(T),D=j.redSqr().redIAdd(O).redISub(R).redISub(R),L=j.redMul(R.redISub(D)).redISub(x.redMul(O)),q=this.z.redMul(b);return this.curve.jpoint(D,L,q)},f.prototype.dblp=function(m){if(m===0)return this;if(this.isInfinity())return this;if(!m)return this.dbl();var p;if(this.curve.zeroA||this.curve.threeA){var g=this;for(p=0;p<m;p++)g=g.dbl();return g}var v=this.curve.a,x=this.curve.tinv,y=this.x,b=this.y,j=this.z,T=j.redSqr().redSqr(),O=b.redAdd(b);for(p=0;p<m;p++){var R=y.redSqr(),D=O.redSqr(),L=D.redSqr(),q=R.redAdd(R).redIAdd(R).redIAdd(v.redMul(T)),X=y.redMul(D),H=q.redSqr().redISub(X.redAdd(X)),M=X.redISub(H),F=q.redMul(M);F=F.redIAdd(F).redISub(L);var S=O.redMul(j);p+1<m&&(T=T.redMul(L)),y=H,j=S,O=F}return this.curve.jpoint(y,O.redMul(x),j)},f.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},f.prototype._zeroDbl=function(){var m,p,g;if(this.zOne){var v=this.x.redSqr(),x=this.y.redSqr(),y=x.redSqr(),b=this.x.redAdd(x).redSqr().redISub(v).redISub(y);b=b.redIAdd(b);var j=v.redAdd(v).redIAdd(v),T=j.redSqr().redISub(b).redISub(b),O=y.redIAdd(y);O=(O=O.redIAdd(O)).redIAdd(O),m=T,p=j.redMul(b.redISub(T)).redISub(O),g=this.y.redAdd(this.y)}else{var R=this.x.redSqr(),D=this.y.redSqr(),L=D.redSqr(),q=this.x.redAdd(D).redSqr().redISub(R).redISub(L);q=q.redIAdd(q);var X=R.redAdd(R).redIAdd(R),H=X.redSqr(),M=L.redIAdd(L);M=(M=M.redIAdd(M)).redIAdd(M),m=H.redISub(q).redISub(q),p=X.redMul(q.redISub(m)).redISub(M),g=(g=this.y.redMul(this.z)).redIAdd(g)}return this.curve.jpoint(m,p,g)},f.prototype._threeDbl=function(){var m,p,g;if(this.zOne){var v=this.x.redSqr(),x=this.y.redSqr(),y=x.redSqr(),b=this.x.redAdd(x).redSqr().redISub(v).redISub(y);b=b.redIAdd(b);var j=v.redAdd(v).redIAdd(v).redIAdd(this.curve.a),T=j.redSqr().redISub(b).redISub(b);m=T;var O=y.redIAdd(y);O=(O=O.redIAdd(O)).redIAdd(O),p=j.redMul(b.redISub(T)).redISub(O),g=this.y.redAdd(this.y)}else{var R=this.z.redSqr(),D=this.y.redSqr(),L=this.x.redMul(D),q=this.x.redSub(R).redMul(this.x.redAdd(R));q=q.redAdd(q).redIAdd(q);var X=L.redIAdd(L),H=(X=X.redIAdd(X)).redAdd(X);m=q.redSqr().redISub(H),g=this.y.redAdd(this.z).redSqr().redISub(D).redISub(R);var M=D.redSqr();M=(M=(M=M.redIAdd(M)).redIAdd(M)).redIAdd(M),p=q.redMul(X.redISub(m)).redISub(M)}return this.curve.jpoint(m,p,g)},f.prototype._dbl=function(){var m=this.curve.a,p=this.x,g=this.y,v=this.z,x=v.redSqr().redSqr(),y=p.redSqr(),b=g.redSqr(),j=y.redAdd(y).redIAdd(y).redIAdd(m.redMul(x)),T=p.redAdd(p),O=(T=T.redIAdd(T)).redMul(b),R=j.redSqr().redISub(O.redAdd(O)),D=O.redISub(R),L=b.redSqr();L=(L=(L=L.redIAdd(L)).redIAdd(L)).redIAdd(L);var q=j.redMul(D).redISub(L),X=g.redAdd(g).redMul(v);return this.curve.jpoint(R,q,X)},f.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var m=this.x.redSqr(),p=this.y.redSqr(),g=this.z.redSqr(),v=p.redSqr(),x=m.redAdd(m).redIAdd(m),y=x.redSqr(),b=this.x.redAdd(p).redSqr().redISub(m).redISub(v),j=(b=(b=(b=b.redIAdd(b)).redAdd(b).redIAdd(b)).redISub(y)).redSqr(),T=v.redIAdd(v);T=(T=(T=T.redIAdd(T)).redIAdd(T)).redIAdd(T);var O=x.redIAdd(b).redSqr().redISub(y).redISub(j).redISub(T),R=p.redMul(O);R=(R=R.redIAdd(R)).redIAdd(R);var D=this.x.redMul(j).redISub(R);D=(D=D.redIAdd(D)).redIAdd(D);var L=this.y.redMul(O.redMul(T.redISub(O)).redISub(b.redMul(j)));L=(L=(L=L.redIAdd(L)).redIAdd(L)).redIAdd(L);var q=this.z.redAdd(b).redSqr().redISub(g).redISub(j);return this.curve.jpoint(D,L,q)},f.prototype.mul=function(m,p){return m=new o(m,p),this.curve._wnafMul(this,m)},f.prototype.eq=function(m){if(m.type==="affine")return this.eq(m.toJ());if(this===m)return!0;var p=this.z.redSqr(),g=m.z.redSqr();if(this.x.redMul(g).redISub(m.x.redMul(p)).cmpn(0)!==0)return!1;var v=p.redMul(this.z),x=g.redMul(m.z);return this.y.redMul(x).redISub(m.y.redMul(v)).cmpn(0)===0},f.prototype.eqXToP=function(m){var p=this.z.redSqr(),g=m.toRed(this.curve.red).redMul(p);if(this.x.cmp(g)===0)return!0;for(var v=m.clone(),x=this.curve.redN.redMul(p);;){if(v.iadd(this.curve.n),v.cmp(this.curve.p)>=0)return!1;if(g.redIAdd(x),this.x.cmp(g)===0)return!0}},f.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},f.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(r,s,a){var i,o=a,c=r("hash.js"),d=r("./curve"),l=r("./utils").assert;function u(f){f.type==="short"?this.curve=new d.short(f):f.type==="edwards"?this.curve=new d.edwards(f):this.curve=new d.mont(f),this.g=this.curve.g,this.n=this.curve.n,this.hash=f.hash,l(this.g.validate(),"Invalid curve"),l(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function h(f,m){Object.defineProperty(o,f,{configurable:!0,enumerable:!0,get:function(){var p=new u(m);return Object.defineProperty(o,f,{configurable:!0,enumerable:!0,value:p}),p}})}o.PresetCurve=u,h("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:c.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),h("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:c.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),h("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:c.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),h("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:c.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),h("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:c.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),h("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:c.sha256,gRed:!1,g:["9"]}),h("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:c.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{i=r("./precomputed/secp256k1")}catch{i=void 0}h("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:c.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",i]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(r,s,a){var i=r("bn.js"),o=r("hmac-drbg"),c=r("../utils"),d=r("../curves"),l=r("brorand"),u=c.assert,h=r("./key"),f=r("./signature");function m(p){if(!(this instanceof m))return new m(p);typeof p=="string"&&(u(Object.prototype.hasOwnProperty.call(d,p),"Unknown curve "+p),p=d[p]),p instanceof d.PresetCurve&&(p={curve:p}),this.curve=p.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=p.curve.g,this.g.precompute(p.curve.n.bitLength()+1),this.hash=p.hash||p.curve.hash}s.exports=m,m.prototype.keyPair=function(p){return new h(this,p)},m.prototype.keyFromPrivate=function(p,g){return h.fromPrivate(this,p,g)},m.prototype.keyFromPublic=function(p,g){return h.fromPublic(this,p,g)},m.prototype.genKeyPair=function(p){p||(p={});for(var g=new o({hash:this.hash,pers:p.pers,persEnc:p.persEnc||"utf8",entropy:p.entropy||l(this.hash.hmacStrength),entropyEnc:p.entropy&&p.entropyEnc||"utf8",nonce:this.n.toArray()}),v=this.n.byteLength(),x=this.n.sub(new i(2));;){var y=new i(g.generate(v));if(!(y.cmp(x)>0))return y.iaddn(1),this.keyFromPrivate(y)}},m.prototype._truncateToN=function(p,g){var v=8*p.byteLength()-this.n.bitLength();return v>0&&(p=p.ushrn(v)),!g&&p.cmp(this.n)>=0?p.sub(this.n):p},m.prototype.sign=function(p,g,v,x){typeof v=="object"&&(x=v,v=null),x||(x={}),g=this.keyFromPrivate(g,v),p=this._truncateToN(new i(p,16));for(var y=this.n.byteLength(),b=g.getPrivate().toArray("be",y),j=p.toArray("be",y),T=new o({hash:this.hash,entropy:b,nonce:j,pers:x.pers,persEnc:x.persEnc||"utf8"}),O=this.n.sub(new i(1)),R=0;;R++){var D=x.k?x.k(R):new i(T.generate(this.n.byteLength()));if(!((D=this._truncateToN(D,!0)).cmpn(1)<=0||D.cmp(O)>=0)){var L=this.g.mul(D);if(!L.isInfinity()){var q=L.getX(),X=q.umod(this.n);if(X.cmpn(0)!==0){var H=D.invm(this.n).mul(X.mul(g.getPrivate()).iadd(p));if((H=H.umod(this.n)).cmpn(0)!==0){var M=(L.getY().isOdd()?1:0)|(q.cmp(X)!==0?2:0);return x.canonical&&H.cmp(this.nh)>0&&(H=this.n.sub(H),M^=1),new f({r:X,s:H,recoveryParam:M})}}}}}},m.prototype.verify=function(p,g,v,x){p=this._truncateToN(new i(p,16)),v=this.keyFromPublic(v,x);var y=(g=new f(g,"hex")).r,b=g.s;if(y.cmpn(1)<0||y.cmp(this.n)>=0||b.cmpn(1)<0||b.cmp(this.n)>=0)return!1;var j,T=b.invm(this.n),O=T.mul(p).umod(this.n),R=T.mul(y).umod(this.n);return this.curve._maxwellTrick?!(j=this.g.jmulAdd(O,v.getPublic(),R)).isInfinity()&&j.eqXToP(y):!(j=this.g.mulAdd(O,v.getPublic(),R)).isInfinity()&&j.getX().umod(this.n).cmp(y)===0},m.prototype.recoverPubKey=function(p,g,v,x){u((3&v)===v,"The recovery param is more than two bits"),g=new f(g,x);var y=this.n,b=new i(p),j=g.r,T=g.s,O=1&v,R=v>>1;if(j.cmp(this.curve.p.umod(this.curve.n))>=0&&R)throw new Error("Unable to find sencond key candinate");j=R?this.curve.pointFromX(j.add(this.curve.n),O):this.curve.pointFromX(j,O);var D=g.r.invm(y),L=y.sub(b).mul(D).umod(y),q=T.mul(D).umod(y);return this.g.mulAdd(L,j,q)},m.prototype.getKeyRecoveryParam=function(p,g,v,x){if((g=new f(g,x)).recoveryParam!==null)return g.recoveryParam;for(var y=0;y<4;y++){var b;try{b=this.recoverPubKey(p,g,y)}catch{continue}if(b.eq(v))return y}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(r,s,a){var i=r("bn.js"),o=r("../utils").assert;function c(d,l){this.ec=d,this.priv=null,this.pub=null,l.priv&&this._importPrivate(l.priv,l.privEnc),l.pub&&this._importPublic(l.pub,l.pubEnc)}s.exports=c,c.fromPublic=function(d,l,u){return l instanceof c?l:new c(d,{pub:l,pubEnc:u})},c.fromPrivate=function(d,l,u){return l instanceof c?l:new c(d,{priv:l,privEnc:u})},c.prototype.validate=function(){var d=this.getPublic();return d.isInfinity()?{result:!1,reason:"Invalid public key"}:d.validate()?d.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},c.prototype.getPublic=function(d,l){return typeof d=="string"&&(l=d,d=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),l?this.pub.encode(l,d):this.pub},c.prototype.getPrivate=function(d){return d==="hex"?this.priv.toString(16,2):this.priv},c.prototype._importPrivate=function(d,l){this.priv=new i(d,l||16),this.priv=this.priv.umod(this.ec.curve.n)},c.prototype._importPublic=function(d,l){if(d.x||d.y)return this.ec.curve.type==="mont"?o(d.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||o(d.x&&d.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(d.x,d.y));this.pub=this.ec.curve.decodePoint(d,l)},c.prototype.derive=function(d){return d.validate()||o(d.validate(),"public point not validated"),d.mul(this.priv).getX()},c.prototype.sign=function(d,l,u){return this.ec.sign(d,this,l,u)},c.prototype.verify=function(d,l){return this.ec.verify(d,l,this)},c.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(r,s,a){var i=r("bn.js"),o=r("../utils"),c=o.assert;function d(m,p){if(m instanceof d)return m;this._importDER(m,p)||(c(m.r&&m.s,"Signature without r or s"),this.r=new i(m.r,16),this.s=new i(m.s,16),m.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=m.recoveryParam)}function l(){this.place=0}function u(m,p){var g=m[p.place++];if(!(128&g))return g;var v=15&g;if(v===0||v>4)return!1;for(var x=0,y=0,b=p.place;y<v;y++,b++)x<<=8,x|=m[b],x>>>=0;return!(x<=127)&&(p.place=b,x)}function h(m){for(var p=0,g=m.length-1;!m[p]&&!(128&m[p+1])&&p<g;)p++;return p===0?m:m.slice(p)}function f(m,p){if(p<128)m.push(p);else{var g=1+(Math.log(p)/Math.LN2>>>3);for(m.push(128|g);--g;)m.push(p>>>(g<<3)&255);m.push(p)}}s.exports=d,d.prototype._importDER=function(m,p){m=o.toArray(m,p);var g=new l;if(m[g.place++]!==48)return!1;var v=u(m,g);if(v===!1||v+g.place!==m.length||m[g.place++]!==2)return!1;var x=u(m,g);if(x===!1)return!1;var y=m.slice(g.place,x+g.place);if(g.place+=x,m[g.place++]!==2)return!1;var b=u(m,g);if(b===!1||m.length!==b+g.place)return!1;var j=m.slice(g.place,b+g.place);if(y[0]===0){if(!(128&y[1]))return!1;y=y.slice(1)}if(j[0]===0){if(!(128&j[1]))return!1;j=j.slice(1)}return this.r=new i(y),this.s=new i(j),this.recoveryParam=null,!0},d.prototype.toDER=function(m){var p=this.r.toArray(),g=this.s.toArray();for(128&p[0]&&(p=[0].concat(p)),128&g[0]&&(g=[0].concat(g)),p=h(p),g=h(g);!(g[0]||128&g[1]);)g=g.slice(1);var v=[2];f(v,p.length),(v=v.concat(p)).push(2),f(v,g.length);var x=v.concat(g),y=[48];return f(y,x.length),y=y.concat(x),o.encode(y,m)}},{"../utils":419,"bn.js":420}],415:[function(r,s,a){var i=r("hash.js"),o=r("../curves"),c=r("../utils"),d=c.assert,l=c.parseBytes,u=r("./key"),h=r("./signature");function f(m){if(d(m==="ed25519","only tested with ed25519 so far"),!(this instanceof f))return new f(m);m=o[m].curve,this.curve=m,this.g=m.g,this.g.precompute(m.n.bitLength()+1),this.pointClass=m.point().constructor,this.encodingLength=Math.ceil(m.n.bitLength()/8),this.hash=i.sha512}s.exports=f,f.prototype.sign=function(m,p){m=l(m);var g=this.keyFromSecret(p),v=this.hashInt(g.messagePrefix(),m),x=this.g.mul(v),y=this.encodePoint(x),b=this.hashInt(y,g.pubBytes(),m).mul(g.priv()),j=v.add(b).umod(this.curve.n);return this.makeSignature({R:x,S:j,Rencoded:y})},f.prototype.verify=function(m,p,g){m=l(m),p=this.makeSignature(p);var v=this.keyFromPublic(g),x=this.hashInt(p.Rencoded(),v.pubBytes(),m),y=this.g.mul(p.S());return p.R().add(v.pub().mul(x)).eq(y)},f.prototype.hashInt=function(){for(var m=this.hash(),p=0;p<arguments.length;p++)m.update(arguments[p]);return c.intFromLE(m.digest()).umod(this.curve.n)},f.prototype.keyFromPublic=function(m){return u.fromPublic(this,m)},f.prototype.keyFromSecret=function(m){return u.fromSecret(this,m)},f.prototype.makeSignature=function(m){return m instanceof h?m:new h(this,m)},f.prototype.encodePoint=function(m){var p=m.getY().toArray("le",this.encodingLength);return p[this.encodingLength-1]|=m.getX().isOdd()?128:0,p},f.prototype.decodePoint=function(m){var p=(m=c.parseBytes(m)).length-1,g=m.slice(0,p).concat(-129&m[p]),v=(128&m[p])!=0,x=c.intFromLE(g);return this.curve.pointFromY(x,v)},f.prototype.encodeInt=function(m){return m.toArray("le",this.encodingLength)},f.prototype.decodeInt=function(m){return c.intFromLE(m)},f.prototype.isPoint=function(m){return m instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(r,s,a){var i=r("../utils"),o=i.assert,c=i.parseBytes,d=i.cachedProperty;function l(u,h){this.eddsa=u,this._secret=c(h.secret),u.isPoint(h.pub)?this._pub=h.pub:this._pubBytes=c(h.pub)}l.fromPublic=function(u,h){return h instanceof l?h:new l(u,{pub:h})},l.fromSecret=function(u,h){return h instanceof l?h:new l(u,{secret:h})},l.prototype.secret=function(){return this._secret},d(l,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),d(l,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),d(l,"privBytes",function(){var u=this.eddsa,h=this.hash(),f=u.encodingLength-1,m=h.slice(0,u.encodingLength);return m[0]&=248,m[f]&=127,m[f]|=64,m}),d(l,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),d(l,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),d(l,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),l.prototype.sign=function(u){return o(this._secret,"KeyPair can only verify"),this.eddsa.sign(u,this)},l.prototype.verify=function(u,h){return this.eddsa.verify(u,h,this)},l.prototype.getSecret=function(u){return o(this._secret,"KeyPair is public only"),i.encode(this.secret(),u)},l.prototype.getPublic=function(u){return i.encode(this.pubBytes(),u)},s.exports=l},{"../utils":419}],417:[function(r,s,a){var i=r("bn.js"),o=r("../utils"),c=o.assert,d=o.cachedProperty,l=o.parseBytes;function u(h,f){this.eddsa=h,typeof f!="object"&&(f=l(f)),Array.isArray(f)&&(f={R:f.slice(0,h.encodingLength),S:f.slice(h.encodingLength)}),c(f.R&&f.S,"Signature without R or S"),h.isPoint(f.R)&&(this._R=f.R),f.S instanceof i&&(this._S=f.S),this._Rencoded=Array.isArray(f.R)?f.R:f.Rencoded,this._Sencoded=Array.isArray(f.S)?f.S:f.Sencoded}d(u,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),d(u,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),d(u,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),d(u,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),u.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},u.prototype.toHex=function(){return o.encode(this.toBytes(),"hex").toUpperCase()},s.exports=u},{"../utils":419,"bn.js":420}],418:[function(r,s,a){s.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(r,s,a){var i=a,o=r("bn.js"),c=r("minimalistic-assert"),d=r("minimalistic-crypto-utils");i.assert=c,i.toArray=d.toArray,i.zero2=d.zero2,i.toHex=d.toHex,i.encode=d.encode,i.getNAF=function(l,u,h){var f=new Array(Math.max(l.bitLength(),h)+1);f.fill(0);for(var m=1<<u+1,p=l.clone(),g=0;g<f.length;g++){var v,x=p.andln(m-1);p.isOdd()?(v=x>(m>>1)-1?(m>>1)-x:x,p.isubn(v)):v=0,f[g]=v,p.iushrn(1)}return f},i.getJSF=function(l,u){var h=[[],[]];l=l.clone(),u=u.clone();for(var f,m=0,p=0;l.cmpn(-m)>0||u.cmpn(-p)>0;){var g,v,x=l.andln(3)+m&3,y=u.andln(3)+p&3;x===3&&(x=-1),y===3&&(y=-1),g=1&x?(f=l.andln(7)+m&7)!==3&&f!==5||y!==2?x:-x:0,h[0].push(g),v=1&y?(f=u.andln(7)+p&7)!==3&&f!==5||x!==2?y:-y:0,h[1].push(v),2*m===g+1&&(m=1-m),2*p===v+1&&(p=1-p),l.iushrn(1),u.iushrn(1)}return h},i.cachedProperty=function(l,u,h){var f="_"+u;l.prototype[u]=function(){return this[f]!==void 0?this[f]:this[f]=h.call(this)}},i.parseBytes=function(l){return typeof l=="string"?i.toArray(l,"hex"):l},i.intFromLE=function(l){return new o(l,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(r,s,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],421:[function(r,s,a){s.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(r,s,a){var i=Object.create||function(D){var L=function(){};return L.prototype=D,new L},o=Object.keys||function(D){var L=[];for(var q in D)Object.prototype.hasOwnProperty.call(D,q)&&L.push(q);return q},c=Function.prototype.bind||function(D){var L=this;return function(){return L.apply(D,arguments)}};function d(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=i(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}s.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0;var l,u=10;try{var h={};Object.defineProperty&&Object.defineProperty(h,"x",{value:0}),l=h.x===0}catch{l=!1}function f(D){return D._maxListeners===void 0?d.defaultMaxListeners:D._maxListeners}function m(D,L,q){if(L)D.call(q);else for(var X=D.length,H=R(D,X),M=0;M<X;++M)H[M].call(q)}function p(D,L,q,X){if(L)D.call(q,X);else for(var H=D.length,M=R(D,H),F=0;F<H;++F)M[F].call(q,X)}function g(D,L,q,X,H){if(L)D.call(q,X,H);else for(var M=D.length,F=R(D,M),S=0;S<M;++S)F[S].call(q,X,H)}function v(D,L,q,X,H,M){if(L)D.call(q,X,H,M);else for(var F=D.length,S=R(D,F),E=0;E<F;++E)S[E].call(q,X,H,M)}function x(D,L,q,X){if(L)D.apply(q,X);else for(var H=D.length,M=R(D,H),F=0;F<H;++F)M[F].apply(q,X)}function y(D,L,q,X){var H,M,F;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if((M=D._events)?(M.newListener&&(D.emit("newListener",L,q.listener?q.listener:q),M=D._events),F=M[L]):(M=D._events=i(null),D._eventsCount=0),F){if(typeof F=="function"?F=M[L]=X?[q,F]:[F,q]:X?F.unshift(q):F.push(q),!F.warned&&(H=f(D))&&H>0&&F.length>H){F.warned=!0;var S=new Error("Possible EventEmitter memory leak detected. "+F.length+' "'+String(L)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');S.name="MaxListenersExceededWarning",S.emitter=D,S.type=L,S.count=F.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",S.name,S.message)}}else F=M[L]=q,++D._eventsCount;return D}function b(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var D=new Array(arguments.length),L=0;L<D.length;++L)D[L]=arguments[L];this.listener.apply(this.target,D)}}function j(D,L,q){var X={fired:!1,wrapFn:void 0,target:D,type:L,listener:q},H=c.call(b,X);return H.listener=q,X.wrapFn=H,H}function T(D,L,q){var X=D._events;if(!X)return[];var H=X[L];return H?typeof H=="function"?q?[H.listener||H]:[H]:q?function(M){for(var F=new Array(M.length),S=0;S<F.length;++S)F[S]=M[S].listener||M[S];return F}(H):R(H,H.length):[]}function O(D){var L=this._events;if(L){var q=L[D];if(typeof q=="function")return 1;if(q)return q.length}return 0}function R(D,L){for(var q=new Array(L),X=0;X<L;++X)q[X]=D[X];return q}l?Object.defineProperty(d,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(D){if(typeof D!="number"||D<0||D!=D)throw new TypeError('"defaultMaxListeners" must be a positive number');u=D}}):d.defaultMaxListeners=u,d.prototype.setMaxListeners=function(D){if(typeof D!="number"||D<0||isNaN(D))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=D,this},d.prototype.getMaxListeners=function(){return f(this)},d.prototype.emit=function(D){var L,q,X,H,M,F,S=D==="error";if(F=this._events)S=S&&F.error==null;else if(!S)return!1;if(S){if(arguments.length>1&&(L=arguments[1]),L instanceof Error)throw L;var E=new Error('Unhandled "error" event. ('+L+")");throw E.context=L,E}if(!(q=F[D]))return!1;var N=typeof q=="function";switch(X=arguments.length){case 1:m(q,N,this);break;case 2:p(q,N,this,arguments[1]);break;case 3:g(q,N,this,arguments[1],arguments[2]);break;case 4:v(q,N,this,arguments[1],arguments[2],arguments[3]);break;default:for(H=new Array(X-1),M=1;M<X;M++)H[M-1]=arguments[M];x(q,N,this,H)}return!0},d.prototype.addListener=function(D,L){return y(this,D,L,!1)},d.prototype.on=d.prototype.addListener,d.prototype.prependListener=function(D,L){return y(this,D,L,!0)},d.prototype.once=function(D,L){if(typeof L!="function")throw new TypeError('"listener" argument must be a function');return this.on(D,j(this,D,L)),this},d.prototype.prependOnceListener=function(D,L){if(typeof L!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(D,j(this,D,L)),this},d.prototype.removeListener=function(D,L){var q,X,H,M,F;if(typeof L!="function")throw new TypeError('"listener" argument must be a function');if(!(X=this._events))return this;if(!(q=X[D]))return this;if(q===L||q.listener===L)--this._eventsCount==0?this._events=i(null):(delete X[D],X.removeListener&&this.emit("removeListener",D,q.listener||L));else if(typeof q!="function"){for(H=-1,M=q.length-1;M>=0;M--)if(q[M]===L||q[M].listener===L){F=q[M].listener,H=M;break}if(H<0)return this;H===0?q.shift():function(S,E){for(var N=E,C=N+1,k=S.length;C<k;N+=1,C+=1)S[N]=S[C];S.pop()}(q,H),q.length===1&&(X[D]=q[0]),X.removeListener&&this.emit("removeListener",D,F||L)}return this},d.prototype.removeAllListeners=function(D){var L,q,X;if(!(q=this._events))return this;if(!q.removeListener)return arguments.length===0?(this._events=i(null),this._eventsCount=0):q[D]&&(--this._eventsCount==0?this._events=i(null):delete q[D]),this;if(arguments.length===0){var H,M=o(q);for(X=0;X<M.length;++X)(H=M[X])!=="removeListener"&&this.removeAllListeners(H);return this.removeAllListeners("removeListener"),this._events=i(null),this._eventsCount=0,this}if(typeof(L=q[D])=="function")this.removeListener(D,L);else if(L)for(X=L.length-1;X>=0;X--)this.removeListener(D,L[X]);return this},d.prototype.listeners=function(D){return T(this,D,!0)},d.prototype.rawListeners=function(D){return T(this,D,!1)},d.listenerCount=function(D,L){return typeof D.listenerCount=="function"?D.listenerCount(L):O.call(D,L)},d.prototype.listenerCount=O,d.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("md5.js");s.exports=function(c,d,l,u){if(i.isBuffer(c)||(c=i.from(c,"binary")),d&&(i.isBuffer(d)||(d=i.from(d,"binary")),d.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var h=l/8,f=i.alloc(h),m=i.alloc(u||0),p=i.alloc(0);h>0||u>0;){var g=new o;g.update(p),g.update(c),d&&g.update(d),p=g.digest();var v=0;if(h>0){var x=f.length-h;v=Math.min(h,p.length),p.copy(f,x,0,v),h-=v}if(v<p.length&&u>0){var y=m.length-u,b=Math.min(u,p.length-v);p.copy(m,y,v,v+b),u-=b}}return p.fill(0),{key:f,iv:m}}},{"md5.js":450,"safe-buffer":494}],424:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.CsvParserStream=a.ParserOptions=a.parseFile=a.parseStream=a.parseString=a.parse=a.FormatterOptions=a.CsvFormatterStream=a.writeToPath=a.writeToString=a.writeToBuffer=a.writeToStream=a.write=a.format=void 0;var i=r("@fast-csv/format");Object.defineProperty(a,"format",{enumerable:!0,get:function(){return i.format}}),Object.defineProperty(a,"write",{enumerable:!0,get:function(){return i.write}}),Object.defineProperty(a,"writeToStream",{enumerable:!0,get:function(){return i.writeToStream}}),Object.defineProperty(a,"writeToBuffer",{enumerable:!0,get:function(){return i.writeToBuffer}}),Object.defineProperty(a,"writeToString",{enumerable:!0,get:function(){return i.writeToString}}),Object.defineProperty(a,"writeToPath",{enumerable:!0,get:function(){return i.writeToPath}}),Object.defineProperty(a,"CsvFormatterStream",{enumerable:!0,get:function(){return i.CsvFormatterStream}}),Object.defineProperty(a,"FormatterOptions",{enumerable:!0,get:function(){return i.FormatterOptions}});var o=r("@fast-csv/parse");Object.defineProperty(a,"parse",{enumerable:!0,get:function(){return o.parse}}),Object.defineProperty(a,"parseString",{enumerable:!0,get:function(){return o.parseString}}),Object.defineProperty(a,"parseStream",{enumerable:!0,get:function(){return o.parseStream}}),Object.defineProperty(a,"parseFile",{enumerable:!0,get:function(){return o.parseFile}}),Object.defineProperty(a,"ParserOptions",{enumerable:!0,get:function(){return o.ParserOptions}}),Object.defineProperty(a,"CsvParserStream",{enumerable:!0,get:function(){return o.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("readable-stream").Transform;function c(d){o.call(this),this._block=i.allocUnsafe(d),this._blockSize=d,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}r("inherits")(c,o),c.prototype._transform=function(d,l,u){var h=null;try{this.update(d,l)}catch(f){h=f}u(h)},c.prototype._flush=function(d){var l=null;try{this.push(this.digest())}catch(u){l=u}d(l)},c.prototype.update=function(d,l){if(function(g,v){if(!i.isBuffer(g)&&typeof g!="string")throw new TypeError(v+" must be a string or a buffer")}(d,"Data"),this._finalized)throw new Error("Digest already called");i.isBuffer(d)||(d=i.from(d,l));for(var u=this._block,h=0;this._blockOffset+d.length-h>=this._blockSize;){for(var f=this._blockOffset;f<this._blockSize;)u[f++]=d[h++];this._update(),this._blockOffset=0}for(;h<d.length;)u[this._blockOffset++]=d[h++];for(var m=0,p=8*d.length;p>0;++m)this._length[m]+=p,(p=this._length[m]/4294967296|0)>0&&(this._length[m]-=4294967296*p);return this},c.prototype._update=function(){throw new Error("_update is not implemented")},c.prototype.digest=function(d){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var l=this._digest();d!==void 0&&(l=l.toString(d)),this._block.fill(0),this._blockOffset=0;for(var u=0;u<4;++u)this._length[u]=0;return l},c.prototype._digest=function(){throw new Error("_digest is not implemented")},s.exports=c},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(r,s,a){var i=a;i.utils=r("./hash/utils"),i.common=r("./hash/common"),i.sha=r("./hash/sha"),i.ripemd=r("./hash/ripemd"),i.hmac=r("./hash/hmac"),i.sha1=i.sha.sha1,i.sha256=i.sha.sha256,i.sha224=i.sha.sha224,i.sha384=i.sha.sha384,i.sha512=i.sha.sha512,i.ripemd160=i.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(r,s,a){var i=r("./utils"),o=r("minimalistic-assert");function c(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}a.BlockHash=c,c.prototype.update=function(d,l){if(d=i.toArray(d,l),this.pending?this.pending=this.pending.concat(d):this.pending=d,this.pendingTotal+=d.length,this.pending.length>=this._delta8){var u=(d=this.pending).length%this._delta8;this.pending=d.slice(d.length-u,d.length),this.pending.length===0&&(this.pending=null),d=i.join32(d,0,d.length-u,this.endian);for(var h=0;h<d.length;h+=this._delta32)this._update(d,h,h+this._delta32)}return this},c.prototype.digest=function(d){return this.update(this._pad()),o(this.pending===null),this._digest(d)},c.prototype._pad=function(){var d=this.pendingTotal,l=this._delta8,u=l-(d+this.padLength)%l,h=new Array(u+this.padLength);h[0]=128;for(var f=1;f<u;f++)h[f]=0;if(d<<=3,this.endian==="big"){for(var m=8;m<this.padLength;m++)h[f++]=0;h[f++]=0,h[f++]=0,h[f++]=0,h[f++]=0,h[f++]=d>>>24&255,h[f++]=d>>>16&255,h[f++]=d>>>8&255,h[f++]=255&d}else for(h[f++]=255&d,h[f++]=d>>>8&255,h[f++]=d>>>16&255,h[f++]=d>>>24&255,h[f++]=0,h[f++]=0,h[f++]=0,h[f++]=0,m=8;m<this.padLength;m++)h[f++]=0;return h}},{"./utils":437,"minimalistic-assert":453}],428:[function(r,s,a){var i=r("./utils"),o=r("minimalistic-assert");function c(d,l,u){if(!(this instanceof c))return new c(d,l,u);this.Hash=d,this.blockSize=d.blockSize/8,this.outSize=d.outSize/8,this.inner=null,this.outer=null,this._init(i.toArray(l,u))}s.exports=c,c.prototype._init=function(d){d.length>this.blockSize&&(d=new this.Hash().update(d).digest()),o(d.length<=this.blockSize);for(var l=d.length;l<this.blockSize;l++)d.push(0);for(l=0;l<d.length;l++)d[l]^=54;for(this.inner=new this.Hash().update(d),l=0;l<d.length;l++)d[l]^=106;this.outer=new this.Hash().update(d)},c.prototype.update=function(d,l){return this.inner.update(d,l),this},c.prototype.digest=function(d){return this.outer.update(this.inner.digest()),this.outer.digest(d)}},{"./utils":437,"minimalistic-assert":453}],429:[function(r,s,a){var i=r("./utils"),o=r("./common"),c=i.rotl32,d=i.sum32,l=i.sum32_3,u=i.sum32_4,h=o.BlockHash;function f(){if(!(this instanceof f))return new f;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function m(j,T,O,R){return j<=15?T^O^R:j<=31?T&O|~T&R:j<=47?(T|~O)^R:j<=63?T&R|O&~R:T^(O|~R)}function p(j){return j<=15?0:j<=31?1518500249:j<=47?1859775393:j<=63?2400959708:2840853838}function g(j){return j<=15?1352829926:j<=31?1548603684:j<=47?1836072691:j<=63?2053994217:0}i.inherits(f,h),a.ripemd160=f,f.blockSize=512,f.outSize=160,f.hmacStrength=192,f.padLength=64,f.prototype._update=function(j,T){for(var O=this.h[0],R=this.h[1],D=this.h[2],L=this.h[3],q=this.h[4],X=O,H=R,M=D,F=L,S=q,E=0;E<80;E++){var N=d(c(u(O,m(E,R,D,L),j[v[E]+T],p(E)),y[E]),q);O=q,q=L,L=c(D,10),D=R,R=N,N=d(c(u(X,m(79-E,H,M,F),j[x[E]+T],g(E)),b[E]),S),X=S,S=F,F=c(M,10),M=H,H=N}N=l(this.h[1],D,F),this.h[1]=l(this.h[2],L,S),this.h[2]=l(this.h[3],q,X),this.h[3]=l(this.h[4],O,H),this.h[4]=l(this.h[0],R,M),this.h[0]=N},f.prototype._digest=function(j){return j==="hex"?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var v=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],x=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],b=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(r,s,a){a.sha1=r("./sha/1"),a.sha224=r("./sha/224"),a.sha256=r("./sha/256"),a.sha384=r("./sha/384"),a.sha512=r("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(r,s,a){var i=r("../utils"),o=r("../common"),c=r("./common"),d=i.rotl32,l=i.sum32,u=i.sum32_5,h=c.ft_1,f=o.BlockHash,m=[1518500249,1859775393,2400959708,3395469782];function p(){if(!(this instanceof p))return new p;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}i.inherits(p,f),s.exports=p,p.blockSize=512,p.outSize=160,p.hmacStrength=80,p.padLength=64,p.prototype._update=function(g,v){for(var x=this.W,y=0;y<16;y++)x[y]=g[v+y];for(;y<x.length;y++)x[y]=d(x[y-3]^x[y-8]^x[y-14]^x[y-16],1);var b=this.h[0],j=this.h[1],T=this.h[2],O=this.h[3],R=this.h[4];for(y=0;y<x.length;y++){var D=~~(y/20),L=u(d(b,5),h(D,j,T,O),R,x[y],m[D]);R=O,O=T,T=d(j,30),j=b,b=L}this.h[0]=l(this.h[0],b),this.h[1]=l(this.h[1],j),this.h[2]=l(this.h[2],T),this.h[3]=l(this.h[3],O),this.h[4]=l(this.h[4],R)},p.prototype._digest=function(g){return g==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(r,s,a){var i=r("../utils"),o=r("./256");function c(){if(!(this instanceof c))return new c;o.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}i.inherits(c,o),s.exports=c,c.blockSize=512,c.outSize=224,c.hmacStrength=192,c.padLength=64,c.prototype._digest=function(d){return d==="hex"?i.toHex32(this.h.slice(0,7),"big"):i.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(r,s,a){var i=r("../utils"),o=r("../common"),c=r("./common"),d=r("minimalistic-assert"),l=i.sum32,u=i.sum32_4,h=i.sum32_5,f=c.ch32,m=c.maj32,p=c.s0_256,g=c.s1_256,v=c.g0_256,x=c.g1_256,y=o.BlockHash,b=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function j(){if(!(this instanceof j))return new j;y.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=b,this.W=new Array(64)}i.inherits(j,y),s.exports=j,j.blockSize=512,j.outSize=256,j.hmacStrength=192,j.padLength=64,j.prototype._update=function(T,O){for(var R=this.W,D=0;D<16;D++)R[D]=T[O+D];for(;D<R.length;D++)R[D]=u(x(R[D-2]),R[D-7],v(R[D-15]),R[D-16]);var L=this.h[0],q=this.h[1],X=this.h[2],H=this.h[3],M=this.h[4],F=this.h[5],S=this.h[6],E=this.h[7];for(d(this.k.length===R.length),D=0;D<R.length;D++){var N=h(E,g(M),f(M,F,S),this.k[D],R[D]),C=l(p(L),m(L,q,X));E=S,S=F,F=M,M=l(H,N),H=X,X=q,q=L,L=l(N,C)}this.h[0]=l(this.h[0],L),this.h[1]=l(this.h[1],q),this.h[2]=l(this.h[2],X),this.h[3]=l(this.h[3],H),this.h[4]=l(this.h[4],M),this.h[5]=l(this.h[5],F),this.h[6]=l(this.h[6],S),this.h[7]=l(this.h[7],E)},j.prototype._digest=function(T){return T==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(r,s,a){var i=r("../utils"),o=r("./512");function c(){if(!(this instanceof c))return new c;o.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}i.inherits(c,o),s.exports=c,c.blockSize=1024,c.outSize=384,c.hmacStrength=192,c.padLength=128,c.prototype._digest=function(d){return d==="hex"?i.toHex32(this.h.slice(0,12),"big"):i.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(r,s,a){var i=r("../utils"),o=r("../common"),c=r("minimalistic-assert"),d=i.rotr64_hi,l=i.rotr64_lo,u=i.shr64_hi,h=i.shr64_lo,f=i.sum64,m=i.sum64_hi,p=i.sum64_lo,g=i.sum64_4_hi,v=i.sum64_4_lo,x=i.sum64_5_hi,y=i.sum64_5_lo,b=o.BlockHash,j=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function T(){if(!(this instanceof T))return new T;b.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=j,this.W=new Array(160)}function O(C,k,I,U,$){var Y=C&I^~C&$;return Y<0&&(Y+=4294967296),Y}function R(C,k,I,U,$,Y){var Z=k&U^~k&Y;return Z<0&&(Z+=4294967296),Z}function D(C,k,I,U,$){var Y=C&I^C&$^I&$;return Y<0&&(Y+=4294967296),Y}function L(C,k,I,U,$,Y){var Z=k&U^k&Y^U&Y;return Z<0&&(Z+=4294967296),Z}function q(C,k){var I=d(C,k,28)^d(k,C,2)^d(k,C,7);return I<0&&(I+=4294967296),I}function X(C,k){var I=l(C,k,28)^l(k,C,2)^l(k,C,7);return I<0&&(I+=4294967296),I}function H(C,k){var I=d(C,k,14)^d(C,k,18)^d(k,C,9);return I<0&&(I+=4294967296),I}function M(C,k){var I=l(C,k,14)^l(C,k,18)^l(k,C,9);return I<0&&(I+=4294967296),I}function F(C,k){var I=d(C,k,1)^d(C,k,8)^u(C,k,7);return I<0&&(I+=4294967296),I}function S(C,k){var I=l(C,k,1)^l(C,k,8)^h(C,k,7);return I<0&&(I+=4294967296),I}function E(C,k){var I=d(C,k,19)^d(k,C,29)^u(C,k,6);return I<0&&(I+=4294967296),I}function N(C,k){var I=l(C,k,19)^l(k,C,29)^h(C,k,6);return I<0&&(I+=4294967296),I}i.inherits(T,b),s.exports=T,T.blockSize=1024,T.outSize=512,T.hmacStrength=192,T.padLength=128,T.prototype._prepareBlock=function(C,k){for(var I=this.W,U=0;U<32;U++)I[U]=C[k+U];for(;U<I.length;U+=2){var $=E(I[U-4],I[U-3]),Y=N(I[U-4],I[U-3]),Z=I[U-14],re=I[U-13],G=F(I[U-30],I[U-29]),J=S(I[U-30],I[U-29]),V=I[U-32],W=I[U-31];I[U]=g($,Y,Z,re,G,J,V,W),I[U+1]=v($,Y,Z,re,G,J,V,W)}},T.prototype._update=function(C,k){this._prepareBlock(C,k);var I=this.W,U=this.h[0],$=this.h[1],Y=this.h[2],Z=this.h[3],re=this.h[4],G=this.h[5],J=this.h[6],V=this.h[7],W=this.h[8],ee=this.h[9],ie=this.h[10],oe=this.h[11],se=this.h[12],le=this.h[13],ye=this.h[14],ue=this.h[15];c(this.k.length===I.length);for(var ne=0;ne<I.length;ne+=2){var pe=ye,ge=ue,Ne=H(W,ee),_e=M(W,ee),be=O(W,ee,ie,oe,se),Me=R(W,ee,ie,oe,se,le),Se=this.k[ne],$e=this.k[ne+1],Ke=I[ne],Ze=I[ne+1],it=x(pe,ge,Ne,_e,be,Me,Se,$e,Ke,Ze),Re=y(pe,ge,Ne,_e,be,Me,Se,$e,Ke,Ze);pe=q(U,$),ge=X(U,$),Ne=D(U,$,Y,Z,re),_e=L(U,$,Y,Z,re,G);var ot=m(pe,ge,Ne,_e),ut=p(pe,ge,Ne,_e);ye=se,ue=le,se=ie,le=oe,ie=W,oe=ee,W=m(J,V,it,Re),ee=p(V,V,it,Re),J=re,V=G,re=Y,G=Z,Y=U,Z=$,U=m(it,Re,ot,ut),$=p(it,Re,ot,ut)}f(this.h,0,U,$),f(this.h,2,Y,Z),f(this.h,4,re,G),f(this.h,6,J,V),f(this.h,8,W,ee),f(this.h,10,ie,oe),f(this.h,12,se,le),f(this.h,14,ye,ue)},T.prototype._digest=function(C){return C==="hex"?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(r,s,a){var i=r("../utils").rotr32;function o(l,u,h){return l&u^~l&h}function c(l,u,h){return l&u^l&h^u&h}function d(l,u,h){return l^u^h}a.ft_1=function(l,u,h,f){return l===0?o(u,h,f):l===1||l===3?d(u,h,f):l===2?c(u,h,f):void 0},a.ch32=o,a.maj32=c,a.p32=d,a.s0_256=function(l){return i(l,2)^i(l,13)^i(l,22)},a.s1_256=function(l){return i(l,6)^i(l,11)^i(l,25)},a.g0_256=function(l){return i(l,7)^i(l,18)^l>>>3},a.g1_256=function(l){return i(l,17)^i(l,19)^l>>>10}},{"../utils":437}],437:[function(r,s,a){var i=r("minimalistic-assert"),o=r("inherits");function c(h,f){return(64512&h.charCodeAt(f))==55296&&!(f<0||f+1>=h.length)&&(64512&h.charCodeAt(f+1))==56320}function d(h){return(h>>>24|h>>>8&65280|h<<8&16711680|(255&h)<<24)>>>0}function l(h){return h.length===1?"0"+h:h}function u(h){return h.length===7?"0"+h:h.length===6?"00"+h:h.length===5?"000"+h:h.length===4?"0000"+h:h.length===3?"00000"+h:h.length===2?"000000"+h:h.length===1?"0000000"+h:h}a.inherits=o,a.toArray=function(h,f){if(Array.isArray(h))return h.slice();if(!h)return[];var m=[];if(typeof h=="string")if(f){if(f==="hex")for((h=h.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(h="0"+h),g=0;g<h.length;g+=2)m.push(parseInt(h[g]+h[g+1],16))}else for(var p=0,g=0;g<h.length;g++){var v=h.charCodeAt(g);v<128?m[p++]=v:v<2048?(m[p++]=v>>6|192,m[p++]=63&v|128):c(h,g)?(v=65536+((1023&v)<<10)+(1023&h.charCodeAt(++g)),m[p++]=v>>18|240,m[p++]=v>>12&63|128,m[p++]=v>>6&63|128,m[p++]=63&v|128):(m[p++]=v>>12|224,m[p++]=v>>6&63|128,m[p++]=63&v|128)}else for(g=0;g<h.length;g++)m[g]=0|h[g];return m},a.toHex=function(h){for(var f="",m=0;m<h.length;m++)f+=l(h[m].toString(16));return f},a.htonl=d,a.toHex32=function(h,f){for(var m="",p=0;p<h.length;p++){var g=h[p];f==="little"&&(g=d(g)),m+=u(g.toString(16))}return m},a.zero2=l,a.zero8=u,a.join32=function(h,f,m,p){var g=m-f;i(g%4==0);for(var v=new Array(g/4),x=0,y=f;x<v.length;x++,y+=4){var b;b=p==="big"?h[y]<<24|h[y+1]<<16|h[y+2]<<8|h[y+3]:h[y+3]<<24|h[y+2]<<16|h[y+1]<<8|h[y],v[x]=b>>>0}return v},a.split32=function(h,f){for(var m=new Array(4*h.length),p=0,g=0;p<h.length;p++,g+=4){var v=h[p];f==="big"?(m[g]=v>>>24,m[g+1]=v>>>16&255,m[g+2]=v>>>8&255,m[g+3]=255&v):(m[g+3]=v>>>24,m[g+2]=v>>>16&255,m[g+1]=v>>>8&255,m[g]=255&v)}return m},a.rotr32=function(h,f){return h>>>f|h<<32-f},a.rotl32=function(h,f){return h<<f|h>>>32-f},a.sum32=function(h,f){return h+f>>>0},a.sum32_3=function(h,f,m){return h+f+m>>>0},a.sum32_4=function(h,f,m,p){return h+f+m+p>>>0},a.sum32_5=function(h,f,m,p,g){return h+f+m+p+g>>>0},a.sum64=function(h,f,m,p){var g=h[f],v=p+h[f+1]>>>0,x=(v<p?1:0)+m+g;h[f]=x>>>0,h[f+1]=v},a.sum64_hi=function(h,f,m,p){return(f+p>>>0<f?1:0)+h+m>>>0},a.sum64_lo=function(h,f,m,p){return f+p>>>0},a.sum64_4_hi=function(h,f,m,p,g,v,x,y){var b=0,j=f;return b+=(j=j+p>>>0)<f?1:0,b+=(j=j+v>>>0)<v?1:0,h+m+g+x+(b+=(j=j+y>>>0)<y?1:0)>>>0},a.sum64_4_lo=function(h,f,m,p,g,v,x,y){return f+p+v+y>>>0},a.sum64_5_hi=function(h,f,m,p,g,v,x,y,b,j){var T=0,O=f;return T+=(O=O+p>>>0)<f?1:0,T+=(O=O+v>>>0)<v?1:0,T+=(O=O+y>>>0)<y?1:0,h+m+g+x+b+(T+=(O=O+j>>>0)<j?1:0)>>>0},a.sum64_5_lo=function(h,f,m,p,g,v,x,y,b,j){return f+p+v+y+j>>>0},a.rotr64_hi=function(h,f,m){return(f<<32-m|h>>>m)>>>0},a.rotr64_lo=function(h,f,m){return(h<<32-m|f>>>m)>>>0},a.shr64_hi=function(h,f,m){return h>>>m},a.shr64_lo=function(h,f,m){return(h<<32-m|f>>>m)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(r,s,a){var i=r("hash.js"),o=r("minimalistic-crypto-utils"),c=r("minimalistic-assert");function d(l){if(!(this instanceof d))return new d(l);this.hash=l.hash,this.predResist=!!l.predResist,this.outLen=this.hash.outSize,this.minEntropy=l.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var u=o.toArray(l.entropy,l.entropyEnc||"hex"),h=o.toArray(l.nonce,l.nonceEnc||"hex"),f=o.toArray(l.pers,l.persEnc||"hex");c(u.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(u,h,f)}s.exports=d,d.prototype._init=function(l,u,h){var f=l.concat(u).concat(h);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var m=0;m<this.V.length;m++)this.K[m]=0,this.V[m]=1;this._update(f),this._reseed=1,this.reseedInterval=281474976710656},d.prototype._hmac=function(){return new i.hmac(this.hash,this.K)},d.prototype._update=function(l){var u=this._hmac().update(this.V).update([0]);l&&(u=u.update(l)),this.K=u.digest(),this.V=this._hmac().update(this.V).digest(),l&&(this.K=this._hmac().update(this.V).update([1]).update(l).digest(),this.V=this._hmac().update(this.V).digest())},d.prototype.reseed=function(l,u,h,f){typeof u!="string"&&(f=h,h=u,u=null),l=o.toArray(l,u),h=o.toArray(h,f),c(l.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(l.concat(h||[])),this._reseed=1},d.prototype.generate=function(l,u,h,f){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof u!="string"&&(f=h,h=u,u=null),h&&(h=o.toArray(h,f||"hex"),this._update(h));for(var m=[];m.length<l;)this.V=this._hmac().update(this.V).digest(),m=m.concat(this.V);var p=m.slice(0,l);return this._update(h),this._reseed++,o.encode(p,u)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(r,s,a){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */a.read=function(i,o,c,d,l){var u,h,f=8*l-d-1,m=(1<<f)-1,p=m>>1,g=-7,v=c?l-1:0,x=c?-1:1,y=i[o+v];for(v+=x,u=y&(1<<-g)-1,y>>=-g,g+=f;g>0;u=256*u+i[o+v],v+=x,g-=8);for(h=u&(1<<-g)-1,u>>=-g,g+=d;g>0;h=256*h+i[o+v],v+=x,g-=8);if(u===0)u=1-p;else{if(u===m)return h?NaN:1/0*(y?-1:1);h+=Math.pow(2,d),u-=p}return(y?-1:1)*h*Math.pow(2,u-d)},a.write=function(i,o,c,d,l,u){var h,f,m,p=8*u-l-1,g=(1<<p)-1,v=g>>1,x=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=d?0:u-1,b=d?1:-1,j=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(f=isNaN(o)?1:0,h=g):(h=Math.floor(Math.log(o)/Math.LN2),o*(m=Math.pow(2,-h))<1&&(h--,m*=2),(o+=h+v>=1?x/m:x*Math.pow(2,1-v))*m>=2&&(h++,m/=2),h+v>=g?(f=0,h=g):h+v>=1?(f=(o*m-1)*Math.pow(2,l),h+=v):(f=o*Math.pow(2,v-1)*Math.pow(2,l),h=0));l>=8;i[c+y]=255&f,y+=b,f/=256,l-=8);for(h=h<<l|f,p+=l;p>0;i[c+y]=255&h,y+=b,h/=256,p-=8);i[c+y-b]|=128*j}},{}],440:[function(r,s,a){typeof Object.create=="function"?s.exports=function(i,o){o&&(i.super_=o,i.prototype=Object.create(o.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}))}:s.exports=function(i,o){if(o){i.super_=o;var c=function(){};c.prototype=o.prototype,i.prototype=new c,i.prototype.constructor=i}}},{}],441:[function(r,s,a){(function(i,o,c,d,l,u,h,f){(function(){/*!

	JSZip v3.10.1 - A JavaScript class for generating and reading zip files
	<http://stuartk.com/jszip>

	(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
	Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

	JSZip uses the library pako released under the MIT license :
	https://github.com/nodeca/pako/blob/main/LICENSE
	*/(function(m){typeof a=="object"&&s!==void 0?s.exports=m():(typeof window<"u"?window:o!==void 0?o:typeof self<"u"?self:this).JSZip=m()})(function(){return function m(p,g,v){function x(j,T){if(!g[j]){if(!p[j]){var O=typeof r=="function"&&r;if(!T&&O)return O(j,!0);if(y)return y(j,!0);var R=new Error("Cannot find module '"+j+"'");throw R.code="MODULE_NOT_FOUND",R}var D=g[j]={exports:{}};p[j][0].call(D.exports,function(L){return x(p[j][1][L]||L)},D,D.exports,m,p,g,v)}return g[j].exports}for(var y=typeof r=="function"&&r,b=0;b<v.length;b++)x(v[b]);return x}({1:[function(m,p,g){var v=m("./utils"),x=m("./support"),y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";g.encode=function(b){for(var j,T,O,R,D,L,q,X=[],H=0,M=b.length,F=M,S=v.getTypeOf(b)!=="string";H<b.length;)F=M-H,O=S?(j=b[H++],T=H<M?b[H++]:0,H<M?b[H++]:0):(j=b.charCodeAt(H++),T=H<M?b.charCodeAt(H++):0,H<M?b.charCodeAt(H++):0),R=j>>2,D=(3&j)<<4|T>>4,L=1<F?(15&T)<<2|O>>6:64,q=2<F?63&O:64,X.push(y.charAt(R)+y.charAt(D)+y.charAt(L)+y.charAt(q));return X.join("")},g.decode=function(b){var j,T,O,R,D,L,q=0,X=0,H="data:";if(b.substr(0,H.length)===H)throw new Error("Invalid base64 input, it looks like a data url.");var M,F=3*(b=b.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(b.charAt(b.length-1)===y.charAt(64)&&F--,b.charAt(b.length-2)===y.charAt(64)&&F--,F%1!=0)throw new Error("Invalid base64 input, bad content length.");for(M=x.uint8array?new Uint8Array(0|F):new Array(0|F);q<b.length;)j=y.indexOf(b.charAt(q++))<<2|(R=y.indexOf(b.charAt(q++)))>>4,T=(15&R)<<4|(D=y.indexOf(b.charAt(q++)))>>2,O=(3&D)<<6|(L=y.indexOf(b.charAt(q++))),M[X++]=j,D!==64&&(M[X++]=T),L!==64&&(M[X++]=O);return M}},{"./support":30,"./utils":32}],2:[function(m,p,g){var v=m("./external"),x=m("./stream/DataWorker"),y=m("./stream/Crc32Probe"),b=m("./stream/DataLengthProbe");function j(T,O,R,D,L){this.compressedSize=T,this.uncompressedSize=O,this.crc32=R,this.compression=D,this.compressedContent=L}j.prototype={getContentWorker:function(){var T=new x(v.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new b("data_length")),O=this;return T.on("end",function(){if(this.streamInfo.data_length!==O.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),T},getCompressedWorker:function(){return new x(v.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},j.createWorkerFrom=function(T,O,R){return T.pipe(new y).pipe(new b("uncompressedSize")).pipe(O.compressWorker(R)).pipe(new b("compressedSize")).withStreamInfo("compression",O)},p.exports=j},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(m,p,g){var v=m("./stream/GenericWorker");g.STORE={magic:"\0\0",compressWorker:function(){return new v("STORE compression")},uncompressWorker:function(){return new v("STORE decompression")}},g.DEFLATE=m("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(m,p,g){var v=m("./utils"),x=function(){for(var y,b=[],j=0;j<256;j++){y=j;for(var T=0;T<8;T++)y=1&y?3988292384^y>>>1:y>>>1;b[j]=y}return b}();p.exports=function(y,b){return y!==void 0&&y.length?v.getTypeOf(y)!=="string"?function(j,T,O,R){var D=x,L=0+O;j^=-1;for(var q=0;q<L;q++)j=j>>>8^D[255&(j^T[q])];return-1^j}(0|b,y,y.length):function(j,T,O,R){var D=x,L=0+O;j^=-1;for(var q=0;q<L;q++)j=j>>>8^D[255&(j^T.charCodeAt(q))];return-1^j}(0|b,y,y.length):0}},{"./utils":32}],5:[function(m,p,g){g.base64=!1,g.binary=!1,g.dir=!1,g.createFolders=!0,g.date=null,g.compression=null,g.compressionOptions=null,g.comment=null,g.unixPermissions=null,g.dosPermissions=null},{}],6:[function(m,p,g){var v;v=typeof Promise<"u"?Promise:m("lie"),p.exports={Promise:v}},{lie:37}],7:[function(m,p,g){var v=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",x=m("pako"),y=m("./utils"),b=m("./stream/GenericWorker"),j=v?"uint8array":"array";function T(O,R){b.call(this,"FlateWorker/"+O),this._pako=null,this._pakoAction=O,this._pakoOptions=R,this.meta={}}g.magic="\b\0",y.inherits(T,b),T.prototype.processChunk=function(O){this.meta=O.meta,this._pako===null&&this._createPako(),this._pako.push(y.transformTo(j,O.data),!1)},T.prototype.flush=function(){b.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},T.prototype.cleanUp=function(){b.prototype.cleanUp.call(this),this._pako=null},T.prototype._createPako=function(){this._pako=new x[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var O=this;this._pako.onData=function(R){O.push({data:R,meta:O.meta})}},g.compressWorker=function(O){return new T("Deflate",O)},g.uncompressWorker=function(){return new T("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(m,p,g){function v(D,L){var q,X="";for(q=0;q<L;q++)X+=String.fromCharCode(255&D),D>>>=8;return X}function x(D,L,q,X,H,M){var F,S,E=D.file,N=D.compression,C=M!==j.utf8encode,k=y.transformTo("string",M(E.name)),I=y.transformTo("string",j.utf8encode(E.name)),U=E.comment,$=y.transformTo("string",M(U)),Y=y.transformTo("string",j.utf8encode(U)),Z=I.length!==E.name.length,re=Y.length!==U.length,G="",J="",V="",W=E.dir,ee=E.date,ie={crc32:0,compressedSize:0,uncompressedSize:0};L&&!q||(ie.crc32=D.crc32,ie.compressedSize=D.compressedSize,ie.uncompressedSize=D.uncompressedSize);var oe=0;L&&(oe|=8),C||!Z&&!re||(oe|=2048);var se=0,le=0;W&&(se|=16),H==="UNIX"?(le=798,se|=function(ue,ne){var pe=ue;return ue||(pe=ne?16893:33204),(65535&pe)<<16}(E.unixPermissions,W)):(le=20,se|=function(ue){return 63&(ue||0)}(E.dosPermissions)),F=ee.getUTCHours(),F<<=6,F|=ee.getUTCMinutes(),F<<=5,F|=ee.getUTCSeconds()/2,S=ee.getUTCFullYear()-1980,S<<=4,S|=ee.getUTCMonth()+1,S<<=5,S|=ee.getUTCDate(),Z&&(J=v(1,1)+v(T(k),4)+I,G+="up"+v(J.length,2)+J),re&&(V=v(1,1)+v(T($),4)+Y,G+="uc"+v(V.length,2)+V);var ye="";return ye+=`
\0`,ye+=v(oe,2),ye+=N.magic,ye+=v(F,2),ye+=v(S,2),ye+=v(ie.crc32,4),ye+=v(ie.compressedSize,4),ye+=v(ie.uncompressedSize,4),ye+=v(k.length,2),ye+=v(G.length,2),{fileRecord:O.LOCAL_FILE_HEADER+ye+k+G,dirRecord:O.CENTRAL_FILE_HEADER+v(le,2)+ye+v($.length,2)+"\0\0\0\0"+v(se,4)+v(X,4)+k+G+$}}var y=m("../utils"),b=m("../stream/GenericWorker"),j=m("../utf8"),T=m("../crc32"),O=m("../signature");function R(D,L,q,X){b.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=L,this.zipPlatform=q,this.encodeFileName=X,this.streamFiles=D,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}y.inherits(R,b),R.prototype.push=function(D){var L=D.meta.percent||0,q=this.entriesCount,X=this._sources.length;this.accumulate?this.contentBuffer.push(D):(this.bytesWritten+=D.data.length,b.prototype.push.call(this,{data:D.data,meta:{currentFile:this.currentFile,percent:q?(L+100*(q-X-1))/q:100}}))},R.prototype.openedSource=function(D){this.currentSourceOffset=this.bytesWritten,this.currentFile=D.file.name;var L=this.streamFiles&&!D.file.dir;if(L){var q=x(D,L,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:q.fileRecord,meta:{percent:0}})}else this.accumulate=!0},R.prototype.closedSource=function(D){this.accumulate=!1;var L=this.streamFiles&&!D.file.dir,q=x(D,L,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(q.dirRecord),L)this.push({data:function(X){return O.DATA_DESCRIPTOR+v(X.crc32,4)+v(X.compressedSize,4)+v(X.uncompressedSize,4)}(D),meta:{percent:100}});else for(this.push({data:q.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},R.prototype.flush=function(){for(var D=this.bytesWritten,L=0;L<this.dirRecords.length;L++)this.push({data:this.dirRecords[L],meta:{percent:100}});var q=this.bytesWritten-D,X=function(H,M,F,S,E){var N=y.transformTo("string",E(S));return O.CENTRAL_DIRECTORY_END+"\0\0\0\0"+v(H,2)+v(H,2)+v(M,4)+v(F,4)+v(N.length,2)+N}(this.dirRecords.length,q,D,this.zipComment,this.encodeFileName);this.push({data:X,meta:{percent:100}})},R.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},R.prototype.registerPrevious=function(D){this._sources.push(D);var L=this;return D.on("data",function(q){L.processChunk(q)}),D.on("end",function(){L.closedSource(L.previous.streamInfo),L._sources.length?L.prepareNextSource():L.end()}),D.on("error",function(q){L.error(q)}),this},R.prototype.resume=function(){return!!b.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},R.prototype.error=function(D){var L=this._sources;if(!b.prototype.error.call(this,D))return!1;for(var q=0;q<L.length;q++)try{L[q].error(D)}catch{}return!0},R.prototype.lock=function(){b.prototype.lock.call(this);for(var D=this._sources,L=0;L<D.length;L++)D[L].lock()},p.exports=R},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(m,p,g){var v=m("../compressions"),x=m("./ZipFileWorker");g.generateWorker=function(y,b,j){var T=new x(b.streamFiles,j,b.platform,b.encodeFileName),O=0;try{y.forEach(function(R,D){O++;var L=function(M,F){var S=M||F,E=v[S];if(!E)throw new Error(S+" is not a valid compression method !");return E}(D.options.compression,b.compression),q=D.options.compressionOptions||b.compressionOptions||{},X=D.dir,H=D.date;D._compressWorker(L,q).withStreamInfo("file",{name:R,dir:X,date:H,comment:D.comment||"",unixPermissions:D.unixPermissions,dosPermissions:D.dosPermissions}).pipe(T)}),T.entriesCount=O}catch(R){T.error(R)}return T}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(m,p,g){function v(){if(!(this instanceof v))return new v;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var x=new v;for(var y in this)typeof this[y]!="function"&&(x[y]=this[y]);return x}}(v.prototype=m("./object")).loadAsync=m("./load"),v.support=m("./support"),v.defaults=m("./defaults"),v.version="3.10.1",v.loadAsync=function(x,y){return new v().loadAsync(x,y)},v.external=m("./external"),p.exports=v},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(m,p,g){var v=m("./utils"),x=m("./external"),y=m("./utf8"),b=m("./zipEntries"),j=m("./stream/Crc32Probe"),T=m("./nodejsUtils");function O(R){return new x.Promise(function(D,L){var q=R.decompressed.getContentWorker().pipe(new j);q.on("error",function(X){L(X)}).on("end",function(){q.streamInfo.crc32!==R.decompressed.crc32?L(new Error("Corrupted zip : CRC32 mismatch")):D()}).resume()})}p.exports=function(R,D){var L=this;return D=v.extend(D||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:y.utf8decode}),T.isNode&&T.isStream(R)?x.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):v.prepareContent("the loaded zip file",R,!0,D.optimizedBinaryString,D.base64).then(function(q){var X=new b(D);return X.load(q),X}).then(function(q){var X=[x.Promise.resolve(q)],H=q.files;if(D.checkCRC32)for(var M=0;M<H.length;M++)X.push(O(H[M]));return x.Promise.all(X)}).then(function(q){for(var X=q.shift(),H=X.files,M=0;M<H.length;M++){var F=H[M],S=F.fileNameStr,E=v.resolve(F.fileNameStr);L.file(E,F.decompressed,{binary:!0,optimizedBinaryString:!0,date:F.date,dir:F.dir,comment:F.fileCommentStr.length?F.fileCommentStr:null,unixPermissions:F.unixPermissions,dosPermissions:F.dosPermissions,createFolders:D.createFolders}),F.dir||(L.file(E).unsafeOriginalName=S)}return X.zipComment.length&&(L.comment=X.zipComment),L})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(m,p,g){var v=m("../utils"),x=m("../stream/GenericWorker");function y(b,j){x.call(this,"Nodejs stream input adapter for "+b),this._upstreamEnded=!1,this._bindStream(j)}v.inherits(y,x),y.prototype._bindStream=function(b){var j=this;(this._stream=b).pause(),b.on("data",function(T){j.push({data:T,meta:{percent:0}})}).on("error",function(T){j.isPaused?this.generatedError=T:j.error(T)}).on("end",function(){j.isPaused?j._upstreamEnded=!0:j.end()})},y.prototype.pause=function(){return!!x.prototype.pause.call(this)&&(this._stream.pause(),!0)},y.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},p.exports=y},{"../stream/GenericWorker":28,"../utils":32}],13:[function(m,p,g){var v=m("readable-stream").Readable;function x(y,b,j){v.call(this,b),this._helper=y;var T=this;y.on("data",function(O,R){T.push(O)||T._helper.pause(),j&&j(R)}).on("error",function(O){T.emit("error",O)}).on("end",function(){T.push(null)})}m("../utils").inherits(x,v),x.prototype._read=function(){this._helper.resume()},p.exports=x},{"../utils":32,"readable-stream":16}],14:[function(m,p,g){p.exports={isNode:c!==void 0,newBufferFrom:function(v,x){if(c.from&&c.from!==Uint8Array.from)return c.from(v,x);if(typeof v=="number")throw new Error('The "data" argument must not be a number');return new c(v,x)},allocBuffer:function(v){if(c.alloc)return c.alloc(v);var x=new c(v);return x.fill(0),x},isBuffer:function(v){return c.isBuffer(v)},isStream:function(v){return v&&typeof v.on=="function"&&typeof v.pause=="function"&&typeof v.resume=="function"}}},{}],15:[function(m,p,g){function v(E,N,C){var k,I=y.getTypeOf(N),U=y.extend(C||{},T);U.date=U.date||new Date,U.compression!==null&&(U.compression=U.compression.toUpperCase()),typeof U.unixPermissions=="string"&&(U.unixPermissions=parseInt(U.unixPermissions,8)),U.unixPermissions&&16384&U.unixPermissions&&(U.dir=!0),U.dosPermissions&&16&U.dosPermissions&&(U.dir=!0),U.dir&&(E=H(E)),U.createFolders&&(k=X(E))&&M.call(this,k,!0);var $=I==="string"&&U.binary===!1&&U.base64===!1;C&&C.binary!==void 0||(U.binary=!$),(N instanceof O&&N.uncompressedSize===0||U.dir||!N||N.length===0)&&(U.base64=!1,U.binary=!0,N="",U.compression="STORE",I="string");var Y;Y=N instanceof O||N instanceof b?N:L.isNode&&L.isStream(N)?new q(E,N):y.prepareContent(E,N,U.binary,U.optimizedBinaryString,U.base64);var Z=new R(E,Y,U);this.files[E]=Z}var x=m("./utf8"),y=m("./utils"),b=m("./stream/GenericWorker"),j=m("./stream/StreamHelper"),T=m("./defaults"),O=m("./compressedObject"),R=m("./zipObject"),D=m("./generate"),L=m("./nodejsUtils"),q=m("./nodejs/NodejsStreamInputAdapter"),X=function(E){E.slice(-1)==="/"&&(E=E.substring(0,E.length-1));var N=E.lastIndexOf("/");return 0<N?E.substring(0,N):""},H=function(E){return E.slice(-1)!=="/"&&(E+="/"),E},M=function(E,N){return N=N!==void 0?N:T.createFolders,E=H(E),this.files[E]||v.call(this,E,null,{dir:!0,createFolders:N}),this.files[E]};function F(E){return Object.prototype.toString.call(E)==="[object RegExp]"}var S={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(E){var N,C,k;for(N in this.files)k=this.files[N],(C=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&E(C,k)},filter:function(E){var N=[];return this.forEach(function(C,k){E(C,k)&&N.push(k)}),N},file:function(E,N,C){if(arguments.length!==1)return E=this.root+E,v.call(this,E,N,C),this;if(F(E)){var k=E;return this.filter(function(U,$){return!$.dir&&k.test(U)})}var I=this.files[this.root+E];return I&&!I.dir?I:null},folder:function(E){if(!E)return this;if(F(E))return this.filter(function(I,U){return U.dir&&E.test(I)});var N=this.root+E,C=M.call(this,N),k=this.clone();return k.root=C.name,k},remove:function(E){E=this.root+E;var N=this.files[E];if(N||(E.slice(-1)!=="/"&&(E+="/"),N=this.files[E]),N&&!N.dir)delete this.files[E];else for(var C=this.filter(function(I,U){return U.name.slice(0,E.length)===E}),k=0;k<C.length;k++)delete this.files[C[k].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(E){var N,C={};try{if((C=y.extend(E||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:x.utf8encode})).type=C.type.toLowerCase(),C.compression=C.compression.toUpperCase(),C.type==="binarystring"&&(C.type="string"),!C.type)throw new Error("No output type specified.");y.checkSupport(C.type),C.platform!=="darwin"&&C.platform!=="freebsd"&&C.platform!=="linux"&&C.platform!=="sunos"||(C.platform="UNIX"),C.platform==="win32"&&(C.platform="DOS");var k=C.comment||this.comment||"";N=D.generateWorker(this,C,k)}catch(I){(N=new b("error")).error(I)}return new j(N,C.type||"string",C.mimeType)},generateAsync:function(E,N){return this.generateInternalStream(E).accumulate(N)},generateNodeStream:function(E,N){return(E=E||{}).type||(E.type="nodebuffer"),this.generateInternalStream(E).toNodejsStream(N)}};p.exports=S},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(m,p,g){p.exports=m("stream")},{stream:void 0}],17:[function(m,p,g){var v=m("./DataReader");function x(y){v.call(this,y);for(var b=0;b<this.data.length;b++)y[b]=255&y[b]}m("../utils").inherits(x,v),x.prototype.byteAt=function(y){return this.data[this.zero+y]},x.prototype.lastIndexOfSignature=function(y){for(var b=y.charCodeAt(0),j=y.charCodeAt(1),T=y.charCodeAt(2),O=y.charCodeAt(3),R=this.length-4;0<=R;--R)if(this.data[R]===b&&this.data[R+1]===j&&this.data[R+2]===T&&this.data[R+3]===O)return R-this.zero;return-1},x.prototype.readAndCheckSignature=function(y){var b=y.charCodeAt(0),j=y.charCodeAt(1),T=y.charCodeAt(2),O=y.charCodeAt(3),R=this.readData(4);return b===R[0]&&j===R[1]&&T===R[2]&&O===R[3]},x.prototype.readData=function(y){if(this.checkOffset(y),y===0)return[];var b=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},p.exports=x},{"../utils":32,"./DataReader":18}],18:[function(m,p,g){var v=m("../utils");function x(y){this.data=y,this.length=y.length,this.index=0,this.zero=0}x.prototype={checkOffset:function(y){this.checkIndex(this.index+y)},checkIndex:function(y){if(this.length<this.zero+y||y<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+y+"). Corrupted zip ?")},setIndex:function(y){this.checkIndex(y),this.index=y},skip:function(y){this.setIndex(this.index+y)},byteAt:function(){},readInt:function(y){var b,j=0;for(this.checkOffset(y),b=this.index+y-1;b>=this.index;b--)j=(j<<8)+this.byteAt(b);return this.index+=y,j},readString:function(y){return v.transformTo("string",this.readData(y))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var y=this.readInt(4);return new Date(Date.UTC(1980+(y>>25&127),(y>>21&15)-1,y>>16&31,y>>11&31,y>>5&63,(31&y)<<1))}},p.exports=x},{"../utils":32}],19:[function(m,p,g){var v=m("./Uint8ArrayReader");function x(y){v.call(this,y)}m("../utils").inherits(x,v),x.prototype.readData=function(y){this.checkOffset(y);var b=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},p.exports=x},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(m,p,g){var v=m("./DataReader");function x(y){v.call(this,y)}m("../utils").inherits(x,v),x.prototype.byteAt=function(y){return this.data.charCodeAt(this.zero+y)},x.prototype.lastIndexOfSignature=function(y){return this.data.lastIndexOf(y)-this.zero},x.prototype.readAndCheckSignature=function(y){return y===this.readData(4)},x.prototype.readData=function(y){this.checkOffset(y);var b=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},p.exports=x},{"../utils":32,"./DataReader":18}],21:[function(m,p,g){var v=m("./ArrayReader");function x(y){v.call(this,y)}m("../utils").inherits(x,v),x.prototype.readData=function(y){if(this.checkOffset(y),y===0)return new Uint8Array(0);var b=this.data.subarray(this.zero+this.index,this.zero+this.index+y);return this.index+=y,b},p.exports=x},{"../utils":32,"./ArrayReader":17}],22:[function(m,p,g){var v=m("../utils"),x=m("../support"),y=m("./ArrayReader"),b=m("./StringReader"),j=m("./NodeBufferReader"),T=m("./Uint8ArrayReader");p.exports=function(O){var R=v.getTypeOf(O);return v.checkSupport(R),R!=="string"||x.uint8array?R==="nodebuffer"?new j(O):x.uint8array?new T(v.transformTo("uint8array",O)):new y(v.transformTo("array",O)):new b(O)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(m,p,g){g.LOCAL_FILE_HEADER="PK",g.CENTRAL_FILE_HEADER="PK",g.CENTRAL_DIRECTORY_END="PK",g.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",g.ZIP64_CENTRAL_DIRECTORY_END="PK",g.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(m,p,g){var v=m("./GenericWorker"),x=m("../utils");function y(b){v.call(this,"ConvertWorker to "+b),this.destType=b}x.inherits(y,v),y.prototype.processChunk=function(b){this.push({data:x.transformTo(this.destType,b.data),meta:b.meta})},p.exports=y},{"../utils":32,"./GenericWorker":28}],25:[function(m,p,g){var v=m("./GenericWorker"),x=m("../crc32");function y(){v.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}m("../utils").inherits(y,v),y.prototype.processChunk=function(b){this.streamInfo.crc32=x(b.data,this.streamInfo.crc32||0),this.push(b)},p.exports=y},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(m,p,g){var v=m("../utils"),x=m("./GenericWorker");function y(b){x.call(this,"DataLengthProbe for "+b),this.propName=b,this.withStreamInfo(b,0)}v.inherits(y,x),y.prototype.processChunk=function(b){if(b){var j=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=j+b.data.length}x.prototype.processChunk.call(this,b)},p.exports=y},{"../utils":32,"./GenericWorker":28}],27:[function(m,p,g){var v=m("../utils"),x=m("./GenericWorker");function y(b){x.call(this,"DataWorker");var j=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,b.then(function(T){j.dataIsReady=!0,j.data=T,j.max=T&&T.length||0,j.type=v.getTypeOf(T),j.isPaused||j._tickAndRepeat()},function(T){j.error(T)})}v.inherits(y,x),y.prototype.cleanUp=function(){x.prototype.cleanUp.call(this),this.data=null},y.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,v.delay(this._tickAndRepeat,[],this)),!0)},y.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(v.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},y.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var b=null,j=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":b=this.data.substring(this.index,j);break;case"uint8array":b=this.data.subarray(this.index,j);break;case"array":case"nodebuffer":b=this.data.slice(this.index,j)}return this.index=j,this.push({data:b,meta:{percent:this.max?this.index/this.max*100:0}})},p.exports=y},{"../utils":32,"./GenericWorker":28}],28:[function(m,p,g){function v(x){this.name=x||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}v.prototype={push:function(x){this.emit("data",x)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(x){this.emit("error",x)}return!0},error:function(x){return!this.isFinished&&(this.isPaused?this.generatedError=x:(this.isFinished=!0,this.emit("error",x),this.previous&&this.previous.error(x),this.cleanUp()),!0)},on:function(x,y){return this._listeners[x].push(y),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(x,y){if(this._listeners[x])for(var b=0;b<this._listeners[x].length;b++)this._listeners[x][b].call(this,y)},pipe:function(x){return x.registerPrevious(this)},registerPrevious:function(x){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=x.streamInfo,this.mergeStreamInfo(),this.previous=x;var y=this;return x.on("data",function(b){y.processChunk(b)}),x.on("end",function(){y.end()}),x.on("error",function(b){y.error(b)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var x=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),x=!0),this.previous&&this.previous.resume(),!x},flush:function(){},processChunk:function(x){this.push(x)},withStreamInfo:function(x,y){return this.extraStreamInfo[x]=y,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var x in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,x)&&(this.streamInfo[x]=this.extraStreamInfo[x])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var x="Worker "+this.name;return this.previous?this.previous+" -> "+x:x}},p.exports=v},{}],29:[function(m,p,g){var v=m("../utils"),x=m("./ConvertWorker"),y=m("./GenericWorker"),b=m("../base64"),j=m("../support"),T=m("../external"),O=null;if(j.nodestream)try{O=m("../nodejs/NodejsStreamOutputAdapter")}catch{}function R(D,L,q){var X=L;switch(L){case"blob":case"arraybuffer":X="uint8array";break;case"base64":X="string"}try{this._internalType=X,this._outputType=L,this._mimeType=q,v.checkSupport(X),this._worker=D.pipe(new x(X)),D.lock()}catch(H){this._worker=new y("error"),this._worker.error(H)}}R.prototype={accumulate:function(D){return function(L,q){return new T.Promise(function(X,H){var M=[],F=L._internalType,S=L._outputType,E=L._mimeType;L.on("data",function(N,C){M.push(N),q&&q(C)}).on("error",function(N){M=[],H(N)}).on("end",function(){try{var N=function(C,k,I){switch(C){case"blob":return v.newBlob(v.transformTo("arraybuffer",k),I);case"base64":return b.encode(k);default:return v.transformTo(C,k)}}(S,function(C,k){var I,U=0,$=null,Y=0;for(I=0;I<k.length;I++)Y+=k[I].length;switch(C){case"string":return k.join("");case"array":return Array.prototype.concat.apply([],k);case"uint8array":for($=new Uint8Array(Y),I=0;I<k.length;I++)$.set(k[I],U),U+=k[I].length;return $;case"nodebuffer":return c.concat(k);default:throw new Error("concat : unsupported type '"+C+"'")}}(F,M),E);X(N)}catch(C){H(C)}M=[]}).resume()})}(this,D)},on:function(D,L){var q=this;return D==="data"?this._worker.on(D,function(X){L.call(q,X.data,X.meta)}):this._worker.on(D,function(){v.delay(L,arguments,q)}),this},resume:function(){return v.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(D){if(v.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new O(this,{objectMode:this._outputType!=="nodebuffer"},D)}},p.exports=R},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(m,p,g){if(g.base64=!0,g.array=!0,g.string=!0,g.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",g.nodebuffer=c!==void 0,g.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")g.blob=!1;else{var v=new ArrayBuffer(0);try{g.blob=new Blob([v],{type:"application/zip"}).size===0}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);x.append(v),g.blob=x.getBlob("application/zip").size===0}catch{g.blob=!1}}}try{g.nodestream=!!m("readable-stream").Readable}catch{g.nodestream=!1}},{"readable-stream":16}],31:[function(m,p,g){for(var v=m("./utils"),x=m("./support"),y=m("./nodejsUtils"),b=m("./stream/GenericWorker"),j=new Array(256),T=0;T<256;T++)j[T]=252<=T?6:248<=T?5:240<=T?4:224<=T?3:192<=T?2:1;function O(){b.call(this,"utf-8 decode"),this.leftOver=null}function R(){b.call(this,"utf-8 encode")}j[254]=j[254]=1,g.utf8encode=function(D){return x.nodebuffer?y.newBufferFrom(D,"utf-8"):function(L){var q,X,H,M,F,S=L.length,E=0;for(M=0;M<S;M++)(64512&(X=L.charCodeAt(M)))==55296&&M+1<S&&(64512&(H=L.charCodeAt(M+1)))==56320&&(X=65536+(X-55296<<10)+(H-56320),M++),E+=X<128?1:X<2048?2:X<65536?3:4;for(q=x.uint8array?new Uint8Array(E):new Array(E),M=F=0;F<E;M++)(64512&(X=L.charCodeAt(M)))==55296&&M+1<S&&(64512&(H=L.charCodeAt(M+1)))==56320&&(X=65536+(X-55296<<10)+(H-56320),M++),X<128?q[F++]=X:(X<2048?q[F++]=192|X>>>6:(X<65536?q[F++]=224|X>>>12:(q[F++]=240|X>>>18,q[F++]=128|X>>>12&63),q[F++]=128|X>>>6&63),q[F++]=128|63&X);return q}(D)},g.utf8decode=function(D){return x.nodebuffer?v.transformTo("nodebuffer",D).toString("utf-8"):function(L){var q,X,H,M,F=L.length,S=new Array(2*F);for(q=X=0;q<F;)if((H=L[q++])<128)S[X++]=H;else if(4<(M=j[H]))S[X++]=65533,q+=M-1;else{for(H&=M===2?31:M===3?15:7;1<M&&q<F;)H=H<<6|63&L[q++],M--;1<M?S[X++]=65533:H<65536?S[X++]=H:(H-=65536,S[X++]=55296|H>>10&1023,S[X++]=56320|1023&H)}return S.length!==X&&(S.subarray?S=S.subarray(0,X):S.length=X),v.applyFromCharCode(S)}(D=v.transformTo(x.uint8array?"uint8array":"array",D))},v.inherits(O,b),O.prototype.processChunk=function(D){var L=v.transformTo(x.uint8array?"uint8array":"array",D.data);if(this.leftOver&&this.leftOver.length){if(x.uint8array){var q=L;(L=new Uint8Array(q.length+this.leftOver.length)).set(this.leftOver,0),L.set(q,this.leftOver.length)}else L=this.leftOver.concat(L);this.leftOver=null}var X=function(M,F){var S;for((F=F||M.length)>M.length&&(F=M.length),S=F-1;0<=S&&(192&M[S])==128;)S--;return S<0||S===0?F:S+j[M[S]]>F?S:F}(L),H=L;X!==L.length&&(x.uint8array?(H=L.subarray(0,X),this.leftOver=L.subarray(X,L.length)):(H=L.slice(0,X),this.leftOver=L.slice(X,L.length))),this.push({data:g.utf8decode(H),meta:D.meta})},O.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:g.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},g.Utf8DecodeWorker=O,v.inherits(R,b),R.prototype.processChunk=function(D){this.push({data:g.utf8encode(D.data),meta:D.meta})},g.Utf8EncodeWorker=R},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(m,p,g){var v=m("./support"),x=m("./base64"),y=m("./nodejsUtils"),b=m("./external");function j(q){return q}function T(q,X){for(var H=0;H<q.length;++H)X[H]=255&q.charCodeAt(H);return X}m("setimmediate"),g.newBlob=function(q,X){g.checkSupport("blob");try{return new Blob([q],{type:X})}catch{try{var H=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return H.append(q),H.getBlob(X)}catch{throw new Error("Bug : can't construct the Blob.")}}};var O={stringifyByChunk:function(q,X,H){var M=[],F=0,S=q.length;if(S<=H)return String.fromCharCode.apply(null,q);for(;F<S;)X==="array"||X==="nodebuffer"?M.push(String.fromCharCode.apply(null,q.slice(F,Math.min(F+H,S)))):M.push(String.fromCharCode.apply(null,q.subarray(F,Math.min(F+H,S)))),F+=H;return M.join("")},stringifyByChar:function(q){for(var X="",H=0;H<q.length;H++)X+=String.fromCharCode(q[H]);return X},applyCanBeUsed:{uint8array:function(){try{return v.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return v.nodebuffer&&String.fromCharCode.apply(null,y.allocBuffer(1)).length===1}catch{return!1}}()}};function R(q){var X=65536,H=g.getTypeOf(q),M=!0;if(H==="uint8array"?M=O.applyCanBeUsed.uint8array:H==="nodebuffer"&&(M=O.applyCanBeUsed.nodebuffer),M)for(;1<X;)try{return O.stringifyByChunk(q,H,X)}catch{X=Math.floor(X/2)}return O.stringifyByChar(q)}function D(q,X){for(var H=0;H<q.length;H++)X[H]=q[H];return X}g.applyFromCharCode=R;var L={};L.string={string:j,array:function(q){return T(q,new Array(q.length))},arraybuffer:function(q){return L.string.uint8array(q).buffer},uint8array:function(q){return T(q,new Uint8Array(q.length))},nodebuffer:function(q){return T(q,y.allocBuffer(q.length))}},L.array={string:R,array:j,arraybuffer:function(q){return new Uint8Array(q).buffer},uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return y.newBufferFrom(q)}},L.arraybuffer={string:function(q){return R(new Uint8Array(q))},array:function(q){return D(new Uint8Array(q),new Array(q.byteLength))},arraybuffer:j,uint8array:function(q){return new Uint8Array(q)},nodebuffer:function(q){return y.newBufferFrom(new Uint8Array(q))}},L.uint8array={string:R,array:function(q){return D(q,new Array(q.length))},arraybuffer:function(q){return q.buffer},uint8array:j,nodebuffer:function(q){return y.newBufferFrom(q)}},L.nodebuffer={string:R,array:function(q){return D(q,new Array(q.length))},arraybuffer:function(q){return L.nodebuffer.uint8array(q).buffer},uint8array:function(q){return D(q,new Uint8Array(q.length))},nodebuffer:j},g.transformTo=function(q,X){if(X=X||"",!q)return X;g.checkSupport(q);var H=g.getTypeOf(X);return L[H][q](X)},g.resolve=function(q){for(var X=q.split("/"),H=[],M=0;M<X.length;M++){var F=X[M];F==="."||F===""&&M!==0&&M!==X.length-1||(F===".."?H.pop():H.push(F))}return H.join("/")},g.getTypeOf=function(q){return typeof q=="string"?"string":Object.prototype.toString.call(q)==="[object Array]"?"array":v.nodebuffer&&y.isBuffer(q)?"nodebuffer":v.uint8array&&q instanceof Uint8Array?"uint8array":v.arraybuffer&&q instanceof ArrayBuffer?"arraybuffer":void 0},g.checkSupport=function(q){if(!v[q.toLowerCase()])throw new Error(q+" is not supported by this platform")},g.MAX_VALUE_16BITS=65535,g.MAX_VALUE_32BITS=-1,g.pretty=function(q){var X,H,M="";for(H=0;H<(q||"").length;H++)M+="\\x"+((X=q.charCodeAt(H))<16?"0":"")+X.toString(16).toUpperCase();return M},g.delay=function(q,X,H){f(function(){q.apply(H||null,X||[])})},g.inherits=function(q,X){function H(){}H.prototype=X.prototype,q.prototype=new H},g.extend=function(){var q,X,H={};for(q=0;q<arguments.length;q++)for(X in arguments[q])Object.prototype.hasOwnProperty.call(arguments[q],X)&&H[X]===void 0&&(H[X]=arguments[q][X]);return H},g.prepareContent=function(q,X,H,M,F){return b.Promise.resolve(X).then(function(S){return v.blob&&(S instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(S))!==-1)&&typeof FileReader<"u"?new b.Promise(function(E,N){var C=new FileReader;C.onload=function(k){E(k.target.result)},C.onerror=function(k){N(k.target.error)},C.readAsArrayBuffer(S)}):S}).then(function(S){var E=g.getTypeOf(S);return E?(E==="arraybuffer"?S=g.transformTo("uint8array",S):E==="string"&&(F?S=x.decode(S):H&&M!==!0&&(S=function(N){return T(N,v.uint8array?new Uint8Array(N.length):new Array(N.length))}(S))),S):b.Promise.reject(new Error("Can't read the data of '"+q+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(m,p,g){var v=m("./reader/readerFor"),x=m("./utils"),y=m("./signature"),b=m("./zipEntry"),j=m("./support");function T(O){this.files=[],this.loadOptions=O}T.prototype={checkSignature:function(O){if(!this.reader.readAndCheckSignature(O)){this.reader.index-=4;var R=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+x.pretty(R)+", expected "+x.pretty(O)+")")}},isSignature:function(O,R){var D=this.reader.index;this.reader.setIndex(O);var L=this.reader.readString(4)===R;return this.reader.setIndex(D),L},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var O=this.reader.readData(this.zipCommentLength),R=j.uint8array?"uint8array":"array",D=x.transformTo(R,O);this.zipComment=this.loadOptions.decodeFileName(D)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var O,R,D,L=this.zip64EndOfCentralSize-44;0<L;)O=this.reader.readInt(2),R=this.reader.readInt(4),D=this.reader.readData(R),this.zip64ExtensibleData[O]={id:O,length:R,value:D}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var O,R;for(O=0;O<this.files.length;O++)R=this.files[O],this.reader.setIndex(R.localHeaderOffset),this.checkSignature(y.LOCAL_FILE_HEADER),R.readLocalPart(this.reader),R.handleUTF8(),R.processAttributes()},readCentralDir:function(){var O;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(y.CENTRAL_FILE_HEADER);)(O=new b({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(O);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var O=this.reader.lastIndexOfSignature(y.CENTRAL_DIRECTORY_END);if(O<0)throw this.isSignature(0,y.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(O);var R=O;if(this.checkSignature(y.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===x.MAX_VALUE_16BITS||this.diskWithCentralDirStart===x.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===x.MAX_VALUE_16BITS||this.centralDirRecords===x.MAX_VALUE_16BITS||this.centralDirSize===x.MAX_VALUE_32BITS||this.centralDirOffset===x.MAX_VALUE_32BITS){if(this.zip64=!0,(O=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(O),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,y.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var D=this.centralDirOffset+this.centralDirSize;this.zip64&&(D+=20,D+=12+this.zip64EndOfCentralSize);var L=R-D;if(0<L)this.isSignature(R,y.CENTRAL_FILE_HEADER)||(this.reader.zero=L);else if(L<0)throw new Error("Corrupted zip: missing "+Math.abs(L)+" bytes.")},prepareReader:function(O){this.reader=v(O)},load:function(O){this.prepareReader(O),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},p.exports=T},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(m,p,g){var v=m("./reader/readerFor"),x=m("./utils"),y=m("./compressedObject"),b=m("./crc32"),j=m("./utf8"),T=m("./compressions"),O=m("./support");function R(D,L){this.options=D,this.loadOptions=L}R.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(D){var L,q;if(D.skip(22),this.fileNameLength=D.readInt(2),q=D.readInt(2),this.fileName=D.readData(this.fileNameLength),D.skip(q),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((L=function(X){for(var H in T)if(Object.prototype.hasOwnProperty.call(T,H)&&T[H].magic===X)return T[H];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+x.pretty(this.compressionMethod)+" unknown (inner file : "+x.transformTo("string",this.fileName)+")");this.decompressed=new y(this.compressedSize,this.uncompressedSize,this.crc32,L,D.readData(this.compressedSize))},readCentralPart:function(D){this.versionMadeBy=D.readInt(2),D.skip(2),this.bitFlag=D.readInt(2),this.compressionMethod=D.readString(2),this.date=D.readDate(),this.crc32=D.readInt(4),this.compressedSize=D.readInt(4),this.uncompressedSize=D.readInt(4);var L=D.readInt(2);if(this.extraFieldsLength=D.readInt(2),this.fileCommentLength=D.readInt(2),this.diskNumberStart=D.readInt(2),this.internalFileAttributes=D.readInt(2),this.externalFileAttributes=D.readInt(4),this.localHeaderOffset=D.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");D.skip(L),this.readExtraFields(D),this.parseZIP64ExtraField(D),this.fileComment=D.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var D=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),D==0&&(this.dosPermissions=63&this.externalFileAttributes),D==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var D=v(this.extraFields[1].value);this.uncompressedSize===x.MAX_VALUE_32BITS&&(this.uncompressedSize=D.readInt(8)),this.compressedSize===x.MAX_VALUE_32BITS&&(this.compressedSize=D.readInt(8)),this.localHeaderOffset===x.MAX_VALUE_32BITS&&(this.localHeaderOffset=D.readInt(8)),this.diskNumberStart===x.MAX_VALUE_32BITS&&(this.diskNumberStart=D.readInt(4))}},readExtraFields:function(D){var L,q,X,H=D.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});D.index+4<H;)L=D.readInt(2),q=D.readInt(2),X=D.readData(q),this.extraFields[L]={id:L,length:q,value:X};D.setIndex(H)},handleUTF8:function(){var D=O.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=j.utf8decode(this.fileName),this.fileCommentStr=j.utf8decode(this.fileComment);else{var L=this.findExtraFieldUnicodePath();if(L!==null)this.fileNameStr=L;else{var q=x.transformTo(D,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(q)}var X=this.findExtraFieldUnicodeComment();if(X!==null)this.fileCommentStr=X;else{var H=x.transformTo(D,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(H)}}},findExtraFieldUnicodePath:function(){var D=this.extraFields[28789];if(D){var L=v(D.value);return L.readInt(1)!==1||b(this.fileName)!==L.readInt(4)?null:j.utf8decode(L.readData(D.length-5))}return null},findExtraFieldUnicodeComment:function(){var D=this.extraFields[25461];if(D){var L=v(D.value);return L.readInt(1)!==1||b(this.fileComment)!==L.readInt(4)?null:j.utf8decode(L.readData(D.length-5))}return null}},p.exports=R},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(m,p,g){function v(L,q,X){this.name=L,this.dir=X.dir,this.date=X.date,this.comment=X.comment,this.unixPermissions=X.unixPermissions,this.dosPermissions=X.dosPermissions,this._data=q,this._dataBinary=X.binary,this.options={compression:X.compression,compressionOptions:X.compressionOptions}}var x=m("./stream/StreamHelper"),y=m("./stream/DataWorker"),b=m("./utf8"),j=m("./compressedObject"),T=m("./stream/GenericWorker");v.prototype={internalStream:function(L){var q=null,X="string";try{if(!L)throw new Error("No output type specified.");var H=(X=L.toLowerCase())==="string"||X==="text";X!=="binarystring"&&X!=="text"||(X="string"),q=this._decompressWorker();var M=!this._dataBinary;M&&!H&&(q=q.pipe(new b.Utf8EncodeWorker)),!M&&H&&(q=q.pipe(new b.Utf8DecodeWorker))}catch(F){(q=new T("error")).error(F)}return new x(q,X,"")},async:function(L,q){return this.internalStream(L).accumulate(q)},nodeStream:function(L,q){return this.internalStream(L||"nodebuffer").toNodejsStream(q)},_compressWorker:function(L,q){if(this._data instanceof j&&this._data.compression.magic===L.magic)return this._data.getCompressedWorker();var X=this._decompressWorker();return this._dataBinary||(X=X.pipe(new b.Utf8EncodeWorker)),j.createWorkerFrom(X,L,q)},_decompressWorker:function(){return this._data instanceof j?this._data.getContentWorker():this._data instanceof T?this._data:new y(this._data)}};for(var O=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],R=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},D=0;D<O.length;D++)v.prototype[O[D]]=R;p.exports=v},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(m,p,g){(function(v){var x,y,b=v.MutationObserver||v.WebKitMutationObserver;if(b){var j=0,T=new b(L),O=v.document.createTextNode("");T.observe(O,{characterData:!0}),x=function(){O.data=j=++j%2}}else if(v.setImmediate||v.MessageChannel===void 0)x="document"in v&&"onreadystatechange"in v.document.createElement("script")?function(){var q=v.document.createElement("script");q.onreadystatechange=function(){L(),q.onreadystatechange=null,q.parentNode.removeChild(q),q=null},v.document.documentElement.appendChild(q)}:function(){setTimeout(L,0)};else{var R=new v.MessageChannel;R.port1.onmessage=L,x=function(){R.port2.postMessage(0)}}var D=[];function L(){var q,X;y=!0;for(var H=D.length;H;){for(X=D,D=[],q=-1;++q<H;)X[q]();H=D.length}y=!1}p.exports=function(q){D.push(q)!==1||y||x()}}).call(this,o!==void 0?o:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(m,p,g){var v=m("immediate");function x(){}var y={},b=["REJECTED"],j=["FULFILLED"],T=["PENDING"];function O(H){if(typeof H!="function")throw new TypeError("resolver must be a function");this.state=T,this.queue=[],this.outcome=void 0,H!==x&&q(this,H)}function R(H,M,F){this.promise=H,typeof M=="function"&&(this.onFulfilled=M,this.callFulfilled=this.otherCallFulfilled),typeof F=="function"&&(this.onRejected=F,this.callRejected=this.otherCallRejected)}function D(H,M,F){v(function(){var S;try{S=M(F)}catch(E){return y.reject(H,E)}S===H?y.reject(H,new TypeError("Cannot resolve promise with itself")):y.resolve(H,S)})}function L(H){var M=H&&H.then;if(H&&(typeof H=="object"||typeof H=="function")&&typeof M=="function")return function(){M.apply(H,arguments)}}function q(H,M){var F=!1;function S(C){F||(F=!0,y.reject(H,C))}function E(C){F||(F=!0,y.resolve(H,C))}var N=X(function(){M(E,S)});N.status==="error"&&S(N.value)}function X(H,M){var F={};try{F.value=H(M),F.status="success"}catch(S){F.status="error",F.value=S}return F}(p.exports=O).prototype.finally=function(H){if(typeof H!="function")return this;var M=this.constructor;return this.then(function(F){return M.resolve(H()).then(function(){return F})},function(F){return M.resolve(H()).then(function(){throw F})})},O.prototype.catch=function(H){return this.then(null,H)},O.prototype.then=function(H,M){if(typeof H!="function"&&this.state===j||typeof M!="function"&&this.state===b)return this;var F=new this.constructor(x);return this.state!==T?D(F,this.state===j?H:M,this.outcome):this.queue.push(new R(F,H,M)),F},R.prototype.callFulfilled=function(H){y.resolve(this.promise,H)},R.prototype.otherCallFulfilled=function(H){D(this.promise,this.onFulfilled,H)},R.prototype.callRejected=function(H){y.reject(this.promise,H)},R.prototype.otherCallRejected=function(H){D(this.promise,this.onRejected,H)},y.resolve=function(H,M){var F=X(L,M);if(F.status==="error")return y.reject(H,F.value);var S=F.value;if(S)q(H,S);else{H.state=j,H.outcome=M;for(var E=-1,N=H.queue.length;++E<N;)H.queue[E].callFulfilled(M)}return H},y.reject=function(H,M){H.state=b,H.outcome=M;for(var F=-1,S=H.queue.length;++F<S;)H.queue[F].callRejected(M);return H},O.resolve=function(H){return H instanceof this?H:y.resolve(new this(x),H)},O.reject=function(H){var M=new this(x);return y.reject(M,H)},O.all=function(H){var M=this;if(Object.prototype.toString.call(H)!=="[object Array]")return this.reject(new TypeError("must be an array"));var F=H.length,S=!1;if(!F)return this.resolve([]);for(var E=new Array(F),N=0,C=-1,k=new this(x);++C<F;)I(H[C],C);return k;function I(U,$){M.resolve(U).then(function(Y){E[$]=Y,++N!==F||S||(S=!0,y.resolve(k,E))},function(Y){S||(S=!0,y.reject(k,Y))})}},O.race=function(H){if(Object.prototype.toString.call(H)!=="[object Array]")return this.reject(new TypeError("must be an array"));var M=H.length,F=!1;if(!M)return this.resolve([]);for(var S,E=-1,N=new this(x);++E<M;)S=H[E],this.resolve(S).then(function(C){F||(F=!0,y.resolve(N,C))},function(C){F||(F=!0,y.reject(N,C))});return N}},{immediate:36}],38:[function(m,p,g){var v={};(0,m("./lib/utils/common").assign)(v,m("./lib/deflate"),m("./lib/inflate"),m("./lib/zlib/constants")),p.exports=v},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(m,p,g){var v=m("./zlib/deflate"),x=m("./utils/common"),y=m("./utils/strings"),b=m("./zlib/messages"),j=m("./zlib/zstream"),T=Object.prototype.toString;function O(D){if(!(this instanceof O))return new O(D);this.options=x.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},D||{});var L=this.options;L.raw&&0<L.windowBits?L.windowBits=-L.windowBits:L.gzip&&0<L.windowBits&&L.windowBits<16&&(L.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new j,this.strm.avail_out=0;var q=v.deflateInit2(this.strm,L.level,L.method,L.windowBits,L.memLevel,L.strategy);if(q!==0)throw new Error(b[q]);if(L.header&&v.deflateSetHeader(this.strm,L.header),L.dictionary){var X;if(X=typeof L.dictionary=="string"?y.string2buf(L.dictionary):T.call(L.dictionary)==="[object ArrayBuffer]"?new Uint8Array(L.dictionary):L.dictionary,(q=v.deflateSetDictionary(this.strm,X))!==0)throw new Error(b[q]);this._dict_set=!0}}function R(D,L){var q=new O(L);if(q.push(D,!0),q.err)throw q.msg||b[q.err];return q.result}O.prototype.push=function(D,L){var q,X,H=this.strm,M=this.options.chunkSize;if(this.ended)return!1;X=L===~~L?L:L===!0?4:0,typeof D=="string"?H.input=y.string2buf(D):T.call(D)==="[object ArrayBuffer]"?H.input=new Uint8Array(D):H.input=D,H.next_in=0,H.avail_in=H.input.length;do{if(H.avail_out===0&&(H.output=new x.Buf8(M),H.next_out=0,H.avail_out=M),(q=v.deflate(H,X))!==1&&q!==0)return this.onEnd(q),!(this.ended=!0);H.avail_out!==0&&(H.avail_in!==0||X!==4&&X!==2)||(this.options.to==="string"?this.onData(y.buf2binstring(x.shrinkBuf(H.output,H.next_out))):this.onData(x.shrinkBuf(H.output,H.next_out)))}while((0<H.avail_in||H.avail_out===0)&&q!==1);return X===4?(q=v.deflateEnd(this.strm),this.onEnd(q),this.ended=!0,q===0):X!==2||(this.onEnd(0),!(H.avail_out=0))},O.prototype.onData=function(D){this.chunks.push(D)},O.prototype.onEnd=function(D){D===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=D,this.msg=this.strm.msg},g.Deflate=O,g.deflate=R,g.deflateRaw=function(D,L){return(L=L||{}).raw=!0,R(D,L)},g.gzip=function(D,L){return(L=L||{}).gzip=!0,R(D,L)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(m,p,g){var v=m("./zlib/inflate"),x=m("./utils/common"),y=m("./utils/strings"),b=m("./zlib/constants"),j=m("./zlib/messages"),T=m("./zlib/zstream"),O=m("./zlib/gzheader"),R=Object.prototype.toString;function D(q){if(!(this instanceof D))return new D(q);this.options=x.assign({chunkSize:16384,windowBits:0,to:""},q||{});var X=this.options;X.raw&&0<=X.windowBits&&X.windowBits<16&&(X.windowBits=-X.windowBits,X.windowBits===0&&(X.windowBits=-15)),!(0<=X.windowBits&&X.windowBits<16)||q&&q.windowBits||(X.windowBits+=32),15<X.windowBits&&X.windowBits<48&&!(15&X.windowBits)&&(X.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new T,this.strm.avail_out=0;var H=v.inflateInit2(this.strm,X.windowBits);if(H!==b.Z_OK)throw new Error(j[H]);this.header=new O,v.inflateGetHeader(this.strm,this.header)}function L(q,X){var H=new D(X);if(H.push(q,!0),H.err)throw H.msg||j[H.err];return H.result}D.prototype.push=function(q,X){var H,M,F,S,E,N,C=this.strm,k=this.options.chunkSize,I=this.options.dictionary,U=!1;if(this.ended)return!1;M=X===~~X?X:X===!0?b.Z_FINISH:b.Z_NO_FLUSH,typeof q=="string"?C.input=y.binstring2buf(q):R.call(q)==="[object ArrayBuffer]"?C.input=new Uint8Array(q):C.input=q,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new x.Buf8(k),C.next_out=0,C.avail_out=k),(H=v.inflate(C,b.Z_NO_FLUSH))===b.Z_NEED_DICT&&I&&(N=typeof I=="string"?y.string2buf(I):R.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,H=v.inflateSetDictionary(this.strm,N)),H===b.Z_BUF_ERROR&&U===!0&&(H=b.Z_OK,U=!1),H!==b.Z_STREAM_END&&H!==b.Z_OK)return this.onEnd(H),!(this.ended=!0);C.next_out&&(C.avail_out!==0&&H!==b.Z_STREAM_END&&(C.avail_in!==0||M!==b.Z_FINISH&&M!==b.Z_SYNC_FLUSH)||(this.options.to==="string"?(F=y.utf8border(C.output,C.next_out),S=C.next_out-F,E=y.buf2string(C.output,F),C.next_out=S,C.avail_out=k-S,S&&x.arraySet(C.output,C.output,F,S,0),this.onData(E)):this.onData(x.shrinkBuf(C.output,C.next_out)))),C.avail_in===0&&C.avail_out===0&&(U=!0)}while((0<C.avail_in||C.avail_out===0)&&H!==b.Z_STREAM_END);return H===b.Z_STREAM_END&&(M=b.Z_FINISH),M===b.Z_FINISH?(H=v.inflateEnd(this.strm),this.onEnd(H),this.ended=!0,H===b.Z_OK):M!==b.Z_SYNC_FLUSH||(this.onEnd(b.Z_OK),!(C.avail_out=0))},D.prototype.onData=function(q){this.chunks.push(q)},D.prototype.onEnd=function(q){q===b.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=x.flattenChunks(this.chunks)),this.chunks=[],this.err=q,this.msg=this.strm.msg},g.Inflate=D,g.inflate=L,g.inflateRaw=function(q,X){return(X=X||{}).raw=!0,L(q,X)},g.ungzip=L},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(m,p,g){var v=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";g.assign=function(b){for(var j=Array.prototype.slice.call(arguments,1);j.length;){var T=j.shift();if(T){if(typeof T!="object")throw new TypeError(T+"must be non-object");for(var O in T)T.hasOwnProperty(O)&&(b[O]=T[O])}}return b},g.shrinkBuf=function(b,j){return b.length===j?b:b.subarray?b.subarray(0,j):(b.length=j,b)};var x={arraySet:function(b,j,T,O,R){if(j.subarray&&b.subarray)b.set(j.subarray(T,T+O),R);else for(var D=0;D<O;D++)b[R+D]=j[T+D]},flattenChunks:function(b){var j,T,O,R,D,L;for(j=O=0,T=b.length;j<T;j++)O+=b[j].length;for(L=new Uint8Array(O),j=R=0,T=b.length;j<T;j++)D=b[j],L.set(D,R),R+=D.length;return L}},y={arraySet:function(b,j,T,O,R){for(var D=0;D<O;D++)b[R+D]=j[T+D]},flattenChunks:function(b){return[].concat.apply([],b)}};g.setTyped=function(b){b?(g.Buf8=Uint8Array,g.Buf16=Uint16Array,g.Buf32=Int32Array,g.assign(g,x)):(g.Buf8=Array,g.Buf16=Array,g.Buf32=Array,g.assign(g,y))},g.setTyped(v)},{}],42:[function(m,p,g){var v=m("./common"),x=!0,y=!0;try{String.fromCharCode.apply(null,[0])}catch{x=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{y=!1}for(var b=new v.Buf8(256),j=0;j<256;j++)b[j]=252<=j?6:248<=j?5:240<=j?4:224<=j?3:192<=j?2:1;function T(O,R){if(R<65537&&(O.subarray&&y||!O.subarray&&x))return String.fromCharCode.apply(null,v.shrinkBuf(O,R));for(var D="",L=0;L<R;L++)D+=String.fromCharCode(O[L]);return D}b[254]=b[254]=1,g.string2buf=function(O){var R,D,L,q,X,H=O.length,M=0;for(q=0;q<H;q++)(64512&(D=O.charCodeAt(q)))==55296&&q+1<H&&(64512&(L=O.charCodeAt(q+1)))==56320&&(D=65536+(D-55296<<10)+(L-56320),q++),M+=D<128?1:D<2048?2:D<65536?3:4;for(R=new v.Buf8(M),q=X=0;X<M;q++)(64512&(D=O.charCodeAt(q)))==55296&&q+1<H&&(64512&(L=O.charCodeAt(q+1)))==56320&&(D=65536+(D-55296<<10)+(L-56320),q++),D<128?R[X++]=D:(D<2048?R[X++]=192|D>>>6:(D<65536?R[X++]=224|D>>>12:(R[X++]=240|D>>>18,R[X++]=128|D>>>12&63),R[X++]=128|D>>>6&63),R[X++]=128|63&D);return R},g.buf2binstring=function(O){return T(O,O.length)},g.binstring2buf=function(O){for(var R=new v.Buf8(O.length),D=0,L=R.length;D<L;D++)R[D]=O.charCodeAt(D);return R},g.buf2string=function(O,R){var D,L,q,X,H=R||O.length,M=new Array(2*H);for(D=L=0;D<H;)if((q=O[D++])<128)M[L++]=q;else if(4<(X=b[q]))M[L++]=65533,D+=X-1;else{for(q&=X===2?31:X===3?15:7;1<X&&D<H;)q=q<<6|63&O[D++],X--;1<X?M[L++]=65533:q<65536?M[L++]=q:(q-=65536,M[L++]=55296|q>>10&1023,M[L++]=56320|1023&q)}return T(M,L)},g.utf8border=function(O,R){var D;for((R=R||O.length)>O.length&&(R=O.length),D=R-1;0<=D&&(192&O[D])==128;)D--;return D<0||D===0?R:D+b[O[D]]>R?D:R}},{"./common":41}],43:[function(m,p,g){p.exports=function(v,x,y,b){for(var j=65535&v|0,T=v>>>16&65535|0,O=0;y!==0;){for(y-=O=2e3<y?2e3:y;T=T+(j=j+x[b++]|0)|0,--O;);j%=65521,T%=65521}return j|T<<16|0}},{}],44:[function(m,p,g){p.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(m,p,g){var v=function(){for(var x,y=[],b=0;b<256;b++){x=b;for(var j=0;j<8;j++)x=1&x?3988292384^x>>>1:x>>>1;y[b]=x}return y}();p.exports=function(x,y,b,j){var T=v,O=j+b;x^=-1;for(var R=j;R<O;R++)x=x>>>8^T[255&(x^y[R])];return-1^x}},{}],46:[function(m,p,g){var v,x=m("../utils/common"),y=m("./trees"),b=m("./adler32"),j=m("./crc32"),T=m("./messages"),O=-2,R=258,D=262,L=113;function q(G,J){return G.msg=T[J],J}function X(G){return(G<<1)-(4<G?9:0)}function H(G){for(var J=G.length;0<=--J;)G[J]=0}function M(G){var J=G.state,V=J.pending;V>G.avail_out&&(V=G.avail_out),V!==0&&(x.arraySet(G.output,J.pending_buf,J.pending_out,V,G.next_out),G.next_out+=V,J.pending_out+=V,G.total_out+=V,G.avail_out-=V,J.pending-=V,J.pending===0&&(J.pending_out=0))}function F(G,J){y._tr_flush_block(G,0<=G.block_start?G.block_start:-1,G.strstart-G.block_start,J),G.block_start=G.strstart,M(G.strm)}function S(G,J){G.pending_buf[G.pending++]=J}function E(G,J){G.pending_buf[G.pending++]=J>>>8&255,G.pending_buf[G.pending++]=255&J}function N(G,J){var V,W,ee=G.max_chain_length,ie=G.strstart,oe=G.prev_length,se=G.nice_match,le=G.strstart>G.w_size-D?G.strstart-(G.w_size-D):0,ye=G.window,ue=G.w_mask,ne=G.prev,pe=G.strstart+R,ge=ye[ie+oe-1],Ne=ye[ie+oe];G.prev_length>=G.good_match&&(ee>>=2),se>G.lookahead&&(se=G.lookahead);do if(ye[(V=J)+oe]===Ne&&ye[V+oe-1]===ge&&ye[V]===ye[ie]&&ye[++V]===ye[ie+1]){ie+=2,V++;do;while(ye[++ie]===ye[++V]&&ye[++ie]===ye[++V]&&ye[++ie]===ye[++V]&&ye[++ie]===ye[++V]&&ye[++ie]===ye[++V]&&ye[++ie]===ye[++V]&&ye[++ie]===ye[++V]&&ye[++ie]===ye[++V]&&ie<pe);if(W=R-(pe-ie),ie=pe-R,oe<W){if(G.match_start=J,se<=(oe=W))break;ge=ye[ie+oe-1],Ne=ye[ie+oe]}}while((J=ne[J&ue])>le&&--ee!=0);return oe<=G.lookahead?oe:G.lookahead}function C(G){var J,V,W,ee,ie,oe,se,le,ye,ue,ne=G.w_size;do{if(ee=G.window_size-G.lookahead-G.strstart,G.strstart>=ne+(ne-D)){for(x.arraySet(G.window,G.window,ne,ne,0),G.match_start-=ne,G.strstart-=ne,G.block_start-=ne,J=V=G.hash_size;W=G.head[--J],G.head[J]=ne<=W?W-ne:0,--V;);for(J=V=ne;W=G.prev[--J],G.prev[J]=ne<=W?W-ne:0,--V;);ee+=ne}if(G.strm.avail_in===0)break;if(oe=G.strm,se=G.window,le=G.strstart+G.lookahead,ue=void 0,(ye=ee)<(ue=oe.avail_in)&&(ue=ye),V=ue===0?0:(oe.avail_in-=ue,x.arraySet(se,oe.input,oe.next_in,ue,le),oe.state.wrap===1?oe.adler=b(oe.adler,se,ue,le):oe.state.wrap===2&&(oe.adler=j(oe.adler,se,ue,le)),oe.next_in+=ue,oe.total_in+=ue,ue),G.lookahead+=V,G.lookahead+G.insert>=3)for(ie=G.strstart-G.insert,G.ins_h=G.window[ie],G.ins_h=(G.ins_h<<G.hash_shift^G.window[ie+1])&G.hash_mask;G.insert&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[ie+3-1])&G.hash_mask,G.prev[ie&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=ie,ie++,G.insert--,!(G.lookahead+G.insert<3)););}while(G.lookahead<D&&G.strm.avail_in!==0)}function k(G,J){for(var V,W;;){if(G.lookahead<D){if(C(G),G.lookahead<D&&J===0)return 1;if(G.lookahead===0)break}if(V=0,G.lookahead>=3&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),V!==0&&G.strstart-V<=G.w_size-D&&(G.match_length=N(G,V)),G.match_length>=3)if(W=y._tr_tally(G,G.strstart-G.match_start,G.match_length-3),G.lookahead-=G.match_length,G.match_length<=G.max_lazy_match&&G.lookahead>=3){for(G.match_length--;G.strstart++,G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart,--G.match_length!=0;);G.strstart++}else G.strstart+=G.match_length,G.match_length=0,G.ins_h=G.window[G.strstart],G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+1])&G.hash_mask;else W=y._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++;if(W&&(F(G,!1),G.strm.avail_out===0))return 1}return G.insert=G.strstart<2?G.strstart:2,J===4?(F(G,!0),G.strm.avail_out===0?3:4):G.last_lit&&(F(G,!1),G.strm.avail_out===0)?1:2}function I(G,J){for(var V,W,ee;;){if(G.lookahead<D){if(C(G),G.lookahead<D&&J===0)return 1;if(G.lookahead===0)break}if(V=0,G.lookahead>=3&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),G.prev_length=G.match_length,G.prev_match=G.match_start,G.match_length=2,V!==0&&G.prev_length<G.max_lazy_match&&G.strstart-V<=G.w_size-D&&(G.match_length=N(G,V),G.match_length<=5&&(G.strategy===1||G.match_length===3&&4096<G.strstart-G.match_start)&&(G.match_length=2)),G.prev_length>=3&&G.match_length<=G.prev_length){for(ee=G.strstart+G.lookahead-3,W=y._tr_tally(G,G.strstart-1-G.prev_match,G.prev_length-3),G.lookahead-=G.prev_length-1,G.prev_length-=2;++G.strstart<=ee&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),--G.prev_length!=0;);if(G.match_available=0,G.match_length=2,G.strstart++,W&&(F(G,!1),G.strm.avail_out===0))return 1}else if(G.match_available){if((W=y._tr_tally(G,0,G.window[G.strstart-1]))&&F(G,!1),G.strstart++,G.lookahead--,G.strm.avail_out===0)return 1}else G.match_available=1,G.strstart++,G.lookahead--}return G.match_available&&(W=y._tr_tally(G,0,G.window[G.strstart-1]),G.match_available=0),G.insert=G.strstart<2?G.strstart:2,J===4?(F(G,!0),G.strm.avail_out===0?3:4):G.last_lit&&(F(G,!1),G.strm.avail_out===0)?1:2}function U(G,J,V,W,ee){this.good_length=G,this.max_lazy=J,this.nice_length=V,this.max_chain=W,this.func=ee}function $(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new x.Buf16(1146),this.dyn_dtree=new x.Buf16(122),this.bl_tree=new x.Buf16(78),H(this.dyn_ltree),H(this.dyn_dtree),H(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new x.Buf16(16),this.heap=new x.Buf16(573),H(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new x.Buf16(573),H(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Y(G){var J;return G&&G.state?(G.total_in=G.total_out=0,G.data_type=2,(J=G.state).pending=0,J.pending_out=0,J.wrap<0&&(J.wrap=-J.wrap),J.status=J.wrap?42:L,G.adler=J.wrap===2?0:1,J.last_flush=0,y._tr_init(J),0):q(G,O)}function Z(G){var J=Y(G);return J===0&&function(V){V.window_size=2*V.w_size,H(V.head),V.max_lazy_match=v[V.level].max_lazy,V.good_match=v[V.level].good_length,V.nice_match=v[V.level].nice_length,V.max_chain_length=v[V.level].max_chain,V.strstart=0,V.block_start=0,V.lookahead=0,V.insert=0,V.match_length=V.prev_length=2,V.match_available=0,V.ins_h=0}(G.state),J}function re(G,J,V,W,ee,ie){if(!G)return O;var oe=1;if(J===-1&&(J=6),W<0?(oe=0,W=-W):15<W&&(oe=2,W-=16),ee<1||9<ee||V!==8||W<8||15<W||J<0||9<J||ie<0||4<ie)return q(G,O);W===8&&(W=9);var se=new $;return(G.state=se).strm=G,se.wrap=oe,se.gzhead=null,se.w_bits=W,se.w_size=1<<se.w_bits,se.w_mask=se.w_size-1,se.hash_bits=ee+7,se.hash_size=1<<se.hash_bits,se.hash_mask=se.hash_size-1,se.hash_shift=~~((se.hash_bits+3-1)/3),se.window=new x.Buf8(2*se.w_size),se.head=new x.Buf16(se.hash_size),se.prev=new x.Buf16(se.w_size),se.lit_bufsize=1<<ee+6,se.pending_buf_size=4*se.lit_bufsize,se.pending_buf=new x.Buf8(se.pending_buf_size),se.d_buf=1*se.lit_bufsize,se.l_buf=3*se.lit_bufsize,se.level=J,se.strategy=ie,se.method=V,Z(G)}v=[new U(0,0,0,0,function(G,J){var V=65535;for(V>G.pending_buf_size-5&&(V=G.pending_buf_size-5);;){if(G.lookahead<=1){if(C(G),G.lookahead===0&&J===0)return 1;if(G.lookahead===0)break}G.strstart+=G.lookahead,G.lookahead=0;var W=G.block_start+V;if((G.strstart===0||G.strstart>=W)&&(G.lookahead=G.strstart-W,G.strstart=W,F(G,!1),G.strm.avail_out===0)||G.strstart-G.block_start>=G.w_size-D&&(F(G,!1),G.strm.avail_out===0))return 1}return G.insert=0,J===4?(F(G,!0),G.strm.avail_out===0?3:4):(G.strstart>G.block_start&&(F(G,!1),G.strm.avail_out),1)}),new U(4,4,8,4,k),new U(4,5,16,8,k),new U(4,6,32,32,k),new U(4,4,16,16,I),new U(8,16,32,32,I),new U(8,16,128,128,I),new U(8,32,128,256,I),new U(32,128,258,1024,I),new U(32,258,258,4096,I)],g.deflateInit=function(G,J){return re(G,J,8,15,8,0)},g.deflateInit2=re,g.deflateReset=Z,g.deflateResetKeep=Y,g.deflateSetHeader=function(G,J){return G&&G.state?G.state.wrap!==2?O:(G.state.gzhead=J,0):O},g.deflate=function(G,J){var V,W,ee,ie;if(!G||!G.state||5<J||J<0)return G?q(G,O):O;if(W=G.state,!G.output||!G.input&&G.avail_in!==0||W.status===666&&J!==4)return q(G,G.avail_out===0?-5:O);if(W.strm=G,V=W.last_flush,W.last_flush=J,W.status===42)if(W.wrap===2)G.adler=0,S(W,31),S(W,139),S(W,8),W.gzhead?(S(W,(W.gzhead.text?1:0)+(W.gzhead.hcrc?2:0)+(W.gzhead.extra?4:0)+(W.gzhead.name?8:0)+(W.gzhead.comment?16:0)),S(W,255&W.gzhead.time),S(W,W.gzhead.time>>8&255),S(W,W.gzhead.time>>16&255),S(W,W.gzhead.time>>24&255),S(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),S(W,255&W.gzhead.os),W.gzhead.extra&&W.gzhead.extra.length&&(S(W,255&W.gzhead.extra.length),S(W,W.gzhead.extra.length>>8&255)),W.gzhead.hcrc&&(G.adler=j(G.adler,W.pending_buf,W.pending,0)),W.gzindex=0,W.status=69):(S(W,0),S(W,0),S(W,0),S(W,0),S(W,0),S(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),S(W,3),W.status=L);else{var oe=8+(W.w_bits-8<<4)<<8;oe|=(2<=W.strategy||W.level<2?0:W.level<6?1:W.level===6?2:3)<<6,W.strstart!==0&&(oe|=32),oe+=31-oe%31,W.status=L,E(W,oe),W.strstart!==0&&(E(W,G.adler>>>16),E(W,65535&G.adler)),G.adler=1}if(W.status===69)if(W.gzhead.extra){for(ee=W.pending;W.gzindex<(65535&W.gzhead.extra.length)&&(W.pending!==W.pending_buf_size||(W.gzhead.hcrc&&W.pending>ee&&(G.adler=j(G.adler,W.pending_buf,W.pending-ee,ee)),M(G),ee=W.pending,W.pending!==W.pending_buf_size));)S(W,255&W.gzhead.extra[W.gzindex]),W.gzindex++;W.gzhead.hcrc&&W.pending>ee&&(G.adler=j(G.adler,W.pending_buf,W.pending-ee,ee)),W.gzindex===W.gzhead.extra.length&&(W.gzindex=0,W.status=73)}else W.status=73;if(W.status===73)if(W.gzhead.name){ee=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>ee&&(G.adler=j(G.adler,W.pending_buf,W.pending-ee,ee)),M(G),ee=W.pending,W.pending===W.pending_buf_size)){ie=1;break}ie=W.gzindex<W.gzhead.name.length?255&W.gzhead.name.charCodeAt(W.gzindex++):0,S(W,ie)}while(ie!==0);W.gzhead.hcrc&&W.pending>ee&&(G.adler=j(G.adler,W.pending_buf,W.pending-ee,ee)),ie===0&&(W.gzindex=0,W.status=91)}else W.status=91;if(W.status===91)if(W.gzhead.comment){ee=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>ee&&(G.adler=j(G.adler,W.pending_buf,W.pending-ee,ee)),M(G),ee=W.pending,W.pending===W.pending_buf_size)){ie=1;break}ie=W.gzindex<W.gzhead.comment.length?255&W.gzhead.comment.charCodeAt(W.gzindex++):0,S(W,ie)}while(ie!==0);W.gzhead.hcrc&&W.pending>ee&&(G.adler=j(G.adler,W.pending_buf,W.pending-ee,ee)),ie===0&&(W.status=103)}else W.status=103;if(W.status===103&&(W.gzhead.hcrc?(W.pending+2>W.pending_buf_size&&M(G),W.pending+2<=W.pending_buf_size&&(S(W,255&G.adler),S(W,G.adler>>8&255),G.adler=0,W.status=L)):W.status=L),W.pending!==0){if(M(G),G.avail_out===0)return W.last_flush=-1,0}else if(G.avail_in===0&&X(J)<=X(V)&&J!==4)return q(G,-5);if(W.status===666&&G.avail_in!==0)return q(G,-5);if(G.avail_in!==0||W.lookahead!==0||J!==0&&W.status!==666){var se=W.strategy===2?function(le,ye){for(var ue;;){if(le.lookahead===0&&(C(le),le.lookahead===0)){if(ye===0)return 1;break}if(le.match_length=0,ue=y._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++,ue&&(F(le,!1),le.strm.avail_out===0))return 1}return le.insert=0,ye===4?(F(le,!0),le.strm.avail_out===0?3:4):le.last_lit&&(F(le,!1),le.strm.avail_out===0)?1:2}(W,J):W.strategy===3?function(le,ye){for(var ue,ne,pe,ge,Ne=le.window;;){if(le.lookahead<=R){if(C(le),le.lookahead<=R&&ye===0)return 1;if(le.lookahead===0)break}if(le.match_length=0,le.lookahead>=3&&0<le.strstart&&(ne=Ne[pe=le.strstart-1])===Ne[++pe]&&ne===Ne[++pe]&&ne===Ne[++pe]){ge=le.strstart+R;do;while(ne===Ne[++pe]&&ne===Ne[++pe]&&ne===Ne[++pe]&&ne===Ne[++pe]&&ne===Ne[++pe]&&ne===Ne[++pe]&&ne===Ne[++pe]&&ne===Ne[++pe]&&pe<ge);le.match_length=R-(ge-pe),le.match_length>le.lookahead&&(le.match_length=le.lookahead)}if(le.match_length>=3?(ue=y._tr_tally(le,1,le.match_length-3),le.lookahead-=le.match_length,le.strstart+=le.match_length,le.match_length=0):(ue=y._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++),ue&&(F(le,!1),le.strm.avail_out===0))return 1}return le.insert=0,ye===4?(F(le,!0),le.strm.avail_out===0?3:4):le.last_lit&&(F(le,!1),le.strm.avail_out===0)?1:2}(W,J):v[W.level].func(W,J);if(se!==3&&se!==4||(W.status=666),se===1||se===3)return G.avail_out===0&&(W.last_flush=-1),0;if(se===2&&(J===1?y._tr_align(W):J!==5&&(y._tr_stored_block(W,0,0,!1),J===3&&(H(W.head),W.lookahead===0&&(W.strstart=0,W.block_start=0,W.insert=0))),M(G),G.avail_out===0))return W.last_flush=-1,0}return J!==4?0:W.wrap<=0?1:(W.wrap===2?(S(W,255&G.adler),S(W,G.adler>>8&255),S(W,G.adler>>16&255),S(W,G.adler>>24&255),S(W,255&G.total_in),S(W,G.total_in>>8&255),S(W,G.total_in>>16&255),S(W,G.total_in>>24&255)):(E(W,G.adler>>>16),E(W,65535&G.adler)),M(G),0<W.wrap&&(W.wrap=-W.wrap),W.pending!==0?0:1)},g.deflateEnd=function(G){var J;return G&&G.state?(J=G.state.status)!==42&&J!==69&&J!==73&&J!==91&&J!==103&&J!==L&&J!==666?q(G,O):(G.state=null,J===L?q(G,-3):0):O},g.deflateSetDictionary=function(G,J){var V,W,ee,ie,oe,se,le,ye,ue=J.length;if(!G||!G.state||(ie=(V=G.state).wrap)===2||ie===1&&V.status!==42||V.lookahead)return O;for(ie===1&&(G.adler=b(G.adler,J,ue,0)),V.wrap=0,ue>=V.w_size&&(ie===0&&(H(V.head),V.strstart=0,V.block_start=0,V.insert=0),ye=new x.Buf8(V.w_size),x.arraySet(ye,J,ue-V.w_size,V.w_size,0),J=ye,ue=V.w_size),oe=G.avail_in,se=G.next_in,le=G.input,G.avail_in=ue,G.next_in=0,G.input=J,C(V);V.lookahead>=3;){for(W=V.strstart,ee=V.lookahead-2;V.ins_h=(V.ins_h<<V.hash_shift^V.window[W+3-1])&V.hash_mask,V.prev[W&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=W,W++,--ee;);V.strstart=W,V.lookahead=2,C(V)}return V.strstart+=V.lookahead,V.block_start=V.strstart,V.insert=V.lookahead,V.lookahead=0,V.match_length=V.prev_length=2,V.match_available=0,G.next_in=se,G.input=le,G.avail_in=oe,V.wrap=ie,0},g.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(m,p,g){p.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(m,p,g){p.exports=function(v,x){var y,b,j,T,O,R,D,L,q,X,H,M,F,S,E,N,C,k,I,U,$,Y,Z,re,G;y=v.state,b=v.next_in,re=v.input,j=b+(v.avail_in-5),T=v.next_out,G=v.output,O=T-(x-v.avail_out),R=T+(v.avail_out-257),D=y.dmax,L=y.wsize,q=y.whave,X=y.wnext,H=y.window,M=y.hold,F=y.bits,S=y.lencode,E=y.distcode,N=(1<<y.lenbits)-1,C=(1<<y.distbits)-1;e:do{F<15&&(M+=re[b++]<<F,F+=8,M+=re[b++]<<F,F+=8),k=S[M&N];t:for(;;){if(M>>>=I=k>>>24,F-=I,(I=k>>>16&255)==0)G[T++]=65535&k;else{if(!(16&I)){if(!(64&I)){k=S[(65535&k)+(M&(1<<I)-1)];continue t}if(32&I){y.mode=12;break e}v.msg="invalid literal/length code",y.mode=30;break e}U=65535&k,(I&=15)&&(F<I&&(M+=re[b++]<<F,F+=8),U+=M&(1<<I)-1,M>>>=I,F-=I),F<15&&(M+=re[b++]<<F,F+=8,M+=re[b++]<<F,F+=8),k=E[M&C];r:for(;;){if(M>>>=I=k>>>24,F-=I,!(16&(I=k>>>16&255))){if(!(64&I)){k=E[(65535&k)+(M&(1<<I)-1)];continue r}v.msg="invalid distance code",y.mode=30;break e}if($=65535&k,F<(I&=15)&&(M+=re[b++]<<F,(F+=8)<I&&(M+=re[b++]<<F,F+=8)),D<($+=M&(1<<I)-1)){v.msg="invalid distance too far back",y.mode=30;break e}if(M>>>=I,F-=I,(I=T-O)<$){if(q<(I=$-I)&&y.sane){v.msg="invalid distance too far back",y.mode=30;break e}if(Z=H,(Y=0)===X){if(Y+=L-I,I<U){for(U-=I;G[T++]=H[Y++],--I;);Y=T-$,Z=G}}else if(X<I){if(Y+=L+X-I,(I-=X)<U){for(U-=I;G[T++]=H[Y++],--I;);if(Y=0,X<U){for(U-=I=X;G[T++]=H[Y++],--I;);Y=T-$,Z=G}}}else if(Y+=X-I,I<U){for(U-=I;G[T++]=H[Y++],--I;);Y=T-$,Z=G}for(;2<U;)G[T++]=Z[Y++],G[T++]=Z[Y++],G[T++]=Z[Y++],U-=3;U&&(G[T++]=Z[Y++],1<U&&(G[T++]=Z[Y++]))}else{for(Y=T-$;G[T++]=G[Y++],G[T++]=G[Y++],G[T++]=G[Y++],2<(U-=3););U&&(G[T++]=G[Y++],1<U&&(G[T++]=G[Y++]))}break}}break}}while(b<j&&T<R);b-=U=F>>3,M&=(1<<(F-=U<<3))-1,v.next_in=b,v.next_out=T,v.avail_in=b<j?j-b+5:5-(b-j),v.avail_out=T<R?R-T+257:257-(T-R),y.hold=M,y.bits=F}},{}],49:[function(m,p,g){var v=m("../utils/common"),x=m("./adler32"),y=m("./crc32"),b=m("./inffast"),j=m("./inftrees"),T=-2;function O(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function R(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new v.Buf16(320),this.work=new v.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function D(N){var C;return N&&N.state?(C=N.state,N.total_in=N.total_out=C.total=0,N.msg="",C.wrap&&(N.adler=1&C.wrap),C.mode=1,C.last=0,C.havedict=0,C.dmax=32768,C.head=null,C.hold=0,C.bits=0,C.lencode=C.lendyn=new v.Buf32(852),C.distcode=C.distdyn=new v.Buf32(592),C.sane=1,C.back=-1,0):T}function L(N){var C;return N&&N.state?((C=N.state).wsize=0,C.whave=0,C.wnext=0,D(N)):T}function q(N,C){var k,I;return N&&N.state?(I=N.state,C<0?(k=0,C=-C):(k=1+(C>>4),C<48&&(C&=15)),C&&(C<8||15<C)?T:(I.window!==null&&I.wbits!==C&&(I.window=null),I.wrap=k,I.wbits=C,L(N))):T}function X(N,C){var k,I;return N?(I=new R,(N.state=I).window=null,(k=q(N,C))!==0&&(N.state=null),k):T}var H,M,F=!0;function S(N){if(F){var C;for(H=new v.Buf32(512),M=new v.Buf32(32),C=0;C<144;)N.lens[C++]=8;for(;C<256;)N.lens[C++]=9;for(;C<280;)N.lens[C++]=7;for(;C<288;)N.lens[C++]=8;for(j(1,N.lens,0,288,H,0,N.work,{bits:9}),C=0;C<32;)N.lens[C++]=5;j(2,N.lens,0,32,M,0,N.work,{bits:5}),F=!1}N.lencode=H,N.lenbits=9,N.distcode=M,N.distbits=5}function E(N,C,k,I){var U,$=N.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new v.Buf8($.wsize)),I>=$.wsize?(v.arraySet($.window,C,k-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(I<(U=$.wsize-$.wnext)&&(U=I),v.arraySet($.window,C,k-I,U,$.wnext),(I-=U)?(v.arraySet($.window,C,k-I,I,0),$.wnext=I,$.whave=$.wsize):($.wnext+=U,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=U))),0}g.inflateReset=L,g.inflateReset2=q,g.inflateResetKeep=D,g.inflateInit=function(N){return X(N,15)},g.inflateInit2=X,g.inflate=function(N,C){var k,I,U,$,Y,Z,re,G,J,V,W,ee,ie,oe,se,le,ye,ue,ne,pe,ge,Ne,_e,be,Me=0,Se=new v.Buf8(4),$e=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&N.avail_in!==0)return T;(k=N.state).mode===12&&(k.mode=13),Y=N.next_out,U=N.output,re=N.avail_out,$=N.next_in,I=N.input,Z=N.avail_in,G=k.hold,J=k.bits,V=Z,W=re,Ne=0;e:for(;;)switch(k.mode){case 1:if(k.wrap===0){k.mode=13;break}for(;J<16;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}if(2&k.wrap&&G===35615){Se[k.check=0]=255&G,Se[1]=G>>>8&255,k.check=y(k.check,Se,2,0),J=G=0,k.mode=2;break}if(k.flags=0,k.head&&(k.head.done=!1),!(1&k.wrap)||(((255&G)<<8)+(G>>8))%31){N.msg="incorrect header check",k.mode=30;break}if((15&G)!=8){N.msg="unknown compression method",k.mode=30;break}if(J-=4,ge=8+(15&(G>>>=4)),k.wbits===0)k.wbits=ge;else if(ge>k.wbits){N.msg="invalid window size",k.mode=30;break}k.dmax=1<<ge,N.adler=k.check=1,k.mode=512&G?10:12,J=G=0;break;case 2:for(;J<16;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}if(k.flags=G,(255&k.flags)!=8){N.msg="unknown compression method",k.mode=30;break}if(57344&k.flags){N.msg="unknown header flags set",k.mode=30;break}k.head&&(k.head.text=G>>8&1),512&k.flags&&(Se[0]=255&G,Se[1]=G>>>8&255,k.check=y(k.check,Se,2,0)),J=G=0,k.mode=3;case 3:for(;J<32;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}k.head&&(k.head.time=G),512&k.flags&&(Se[0]=255&G,Se[1]=G>>>8&255,Se[2]=G>>>16&255,Se[3]=G>>>24&255,k.check=y(k.check,Se,4,0)),J=G=0,k.mode=4;case 4:for(;J<16;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}k.head&&(k.head.xflags=255&G,k.head.os=G>>8),512&k.flags&&(Se[0]=255&G,Se[1]=G>>>8&255,k.check=y(k.check,Se,2,0)),J=G=0,k.mode=5;case 5:if(1024&k.flags){for(;J<16;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}k.length=G,k.head&&(k.head.extra_len=G),512&k.flags&&(Se[0]=255&G,Se[1]=G>>>8&255,k.check=y(k.check,Se,2,0)),J=G=0}else k.head&&(k.head.extra=null);k.mode=6;case 6:if(1024&k.flags&&(Z<(ee=k.length)&&(ee=Z),ee&&(k.head&&(ge=k.head.extra_len-k.length,k.head.extra||(k.head.extra=new Array(k.head.extra_len)),v.arraySet(k.head.extra,I,$,ee,ge)),512&k.flags&&(k.check=y(k.check,I,ee,$)),Z-=ee,$+=ee,k.length-=ee),k.length))break e;k.length=0,k.mode=7;case 7:if(2048&k.flags){if(Z===0)break e;for(ee=0;ge=I[$+ee++],k.head&&ge&&k.length<65536&&(k.head.name+=String.fromCharCode(ge)),ge&&ee<Z;);if(512&k.flags&&(k.check=y(k.check,I,ee,$)),Z-=ee,$+=ee,ge)break e}else k.head&&(k.head.name=null);k.length=0,k.mode=8;case 8:if(4096&k.flags){if(Z===0)break e;for(ee=0;ge=I[$+ee++],k.head&&ge&&k.length<65536&&(k.head.comment+=String.fromCharCode(ge)),ge&&ee<Z;);if(512&k.flags&&(k.check=y(k.check,I,ee,$)),Z-=ee,$+=ee,ge)break e}else k.head&&(k.head.comment=null);k.mode=9;case 9:if(512&k.flags){for(;J<16;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}if(G!==(65535&k.check)){N.msg="header crc mismatch",k.mode=30;break}J=G=0}k.head&&(k.head.hcrc=k.flags>>9&1,k.head.done=!0),N.adler=k.check=0,k.mode=12;break;case 10:for(;J<32;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}N.adler=k.check=O(G),J=G=0,k.mode=11;case 11:if(k.havedict===0)return N.next_out=Y,N.avail_out=re,N.next_in=$,N.avail_in=Z,k.hold=G,k.bits=J,2;N.adler=k.check=1,k.mode=12;case 12:if(C===5||C===6)break e;case 13:if(k.last){G>>>=7&J,J-=7&J,k.mode=27;break}for(;J<3;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}switch(k.last=1&G,J-=1,3&(G>>>=1)){case 0:k.mode=14;break;case 1:if(S(k),k.mode=20,C!==6)break;G>>>=2,J-=2;break e;case 2:k.mode=17;break;case 3:N.msg="invalid block type",k.mode=30}G>>>=2,J-=2;break;case 14:for(G>>>=7&J,J-=7&J;J<32;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}if((65535&G)!=(G>>>16^65535)){N.msg="invalid stored block lengths",k.mode=30;break}if(k.length=65535&G,J=G=0,k.mode=15,C===6)break e;case 15:k.mode=16;case 16:if(ee=k.length){if(Z<ee&&(ee=Z),re<ee&&(ee=re),ee===0)break e;v.arraySet(U,I,$,ee,Y),Z-=ee,$+=ee,re-=ee,Y+=ee,k.length-=ee;break}k.mode=12;break;case 17:for(;J<14;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}if(k.nlen=257+(31&G),G>>>=5,J-=5,k.ndist=1+(31&G),G>>>=5,J-=5,k.ncode=4+(15&G),G>>>=4,J-=4,286<k.nlen||30<k.ndist){N.msg="too many length or distance symbols",k.mode=30;break}k.have=0,k.mode=18;case 18:for(;k.have<k.ncode;){for(;J<3;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}k.lens[$e[k.have++]]=7&G,G>>>=3,J-=3}for(;k.have<19;)k.lens[$e[k.have++]]=0;if(k.lencode=k.lendyn,k.lenbits=7,_e={bits:k.lenbits},Ne=j(0,k.lens,0,19,k.lencode,0,k.work,_e),k.lenbits=_e.bits,Ne){N.msg="invalid code lengths set",k.mode=30;break}k.have=0,k.mode=19;case 19:for(;k.have<k.nlen+k.ndist;){for(;le=(Me=k.lencode[G&(1<<k.lenbits)-1])>>>16&255,ye=65535&Me,!((se=Me>>>24)<=J);){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}if(ye<16)G>>>=se,J-=se,k.lens[k.have++]=ye;else{if(ye===16){for(be=se+2;J<be;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}if(G>>>=se,J-=se,k.have===0){N.msg="invalid bit length repeat",k.mode=30;break}ge=k.lens[k.have-1],ee=3+(3&G),G>>>=2,J-=2}else if(ye===17){for(be=se+3;J<be;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}J-=se,ge=0,ee=3+(7&(G>>>=se)),G>>>=3,J-=3}else{for(be=se+7;J<be;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}J-=se,ge=0,ee=11+(127&(G>>>=se)),G>>>=7,J-=7}if(k.have+ee>k.nlen+k.ndist){N.msg="invalid bit length repeat",k.mode=30;break}for(;ee--;)k.lens[k.have++]=ge}}if(k.mode===30)break;if(k.lens[256]===0){N.msg="invalid code -- missing end-of-block",k.mode=30;break}if(k.lenbits=9,_e={bits:k.lenbits},Ne=j(1,k.lens,0,k.nlen,k.lencode,0,k.work,_e),k.lenbits=_e.bits,Ne){N.msg="invalid literal/lengths set",k.mode=30;break}if(k.distbits=6,k.distcode=k.distdyn,_e={bits:k.distbits},Ne=j(2,k.lens,k.nlen,k.ndist,k.distcode,0,k.work,_e),k.distbits=_e.bits,Ne){N.msg="invalid distances set",k.mode=30;break}if(k.mode=20,C===6)break e;case 20:k.mode=21;case 21:if(6<=Z&&258<=re){N.next_out=Y,N.avail_out=re,N.next_in=$,N.avail_in=Z,k.hold=G,k.bits=J,b(N,W),Y=N.next_out,U=N.output,re=N.avail_out,$=N.next_in,I=N.input,Z=N.avail_in,G=k.hold,J=k.bits,k.mode===12&&(k.back=-1);break}for(k.back=0;le=(Me=k.lencode[G&(1<<k.lenbits)-1])>>>16&255,ye=65535&Me,!((se=Me>>>24)<=J);){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}if(le&&!(240&le)){for(ue=se,ne=le,pe=ye;le=(Me=k.lencode[pe+((G&(1<<ue+ne)-1)>>ue)])>>>16&255,ye=65535&Me,!(ue+(se=Me>>>24)<=J);){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}G>>>=ue,J-=ue,k.back+=ue}if(G>>>=se,J-=se,k.back+=se,k.length=ye,le===0){k.mode=26;break}if(32&le){k.back=-1,k.mode=12;break}if(64&le){N.msg="invalid literal/length code",k.mode=30;break}k.extra=15&le,k.mode=22;case 22:if(k.extra){for(be=k.extra;J<be;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}k.length+=G&(1<<k.extra)-1,G>>>=k.extra,J-=k.extra,k.back+=k.extra}k.was=k.length,k.mode=23;case 23:for(;le=(Me=k.distcode[G&(1<<k.distbits)-1])>>>16&255,ye=65535&Me,!((se=Me>>>24)<=J);){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}if(!(240&le)){for(ue=se,ne=le,pe=ye;le=(Me=k.distcode[pe+((G&(1<<ue+ne)-1)>>ue)])>>>16&255,ye=65535&Me,!(ue+(se=Me>>>24)<=J);){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}G>>>=ue,J-=ue,k.back+=ue}if(G>>>=se,J-=se,k.back+=se,64&le){N.msg="invalid distance code",k.mode=30;break}k.offset=ye,k.extra=15&le,k.mode=24;case 24:if(k.extra){for(be=k.extra;J<be;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}k.offset+=G&(1<<k.extra)-1,G>>>=k.extra,J-=k.extra,k.back+=k.extra}if(k.offset>k.dmax){N.msg="invalid distance too far back",k.mode=30;break}k.mode=25;case 25:if(re===0)break e;if(ee=W-re,k.offset>ee){if((ee=k.offset-ee)>k.whave&&k.sane){N.msg="invalid distance too far back",k.mode=30;break}ie=ee>k.wnext?(ee-=k.wnext,k.wsize-ee):k.wnext-ee,ee>k.length&&(ee=k.length),oe=k.window}else oe=U,ie=Y-k.offset,ee=k.length;for(re<ee&&(ee=re),re-=ee,k.length-=ee;U[Y++]=oe[ie++],--ee;);k.length===0&&(k.mode=21);break;case 26:if(re===0)break e;U[Y++]=k.length,re--,k.mode=21;break;case 27:if(k.wrap){for(;J<32;){if(Z===0)break e;Z--,G|=I[$++]<<J,J+=8}if(W-=re,N.total_out+=W,k.total+=W,W&&(N.adler=k.check=k.flags?y(k.check,U,W,Y-W):x(k.check,U,W,Y-W)),W=re,(k.flags?G:O(G))!==k.check){N.msg="incorrect data check",k.mode=30;break}J=G=0}k.mode=28;case 28:if(k.wrap&&k.flags){for(;J<32;){if(Z===0)break e;Z--,G+=I[$++]<<J,J+=8}if(G!==(4294967295&k.total)){N.msg="incorrect length check",k.mode=30;break}J=G=0}k.mode=29;case 29:Ne=1;break e;case 30:Ne=-3;break e;case 31:return-4;case 32:default:return T}return N.next_out=Y,N.avail_out=re,N.next_in=$,N.avail_in=Z,k.hold=G,k.bits=J,(k.wsize||W!==N.avail_out&&k.mode<30&&(k.mode<27||C!==4))&&E(N,N.output,N.next_out,W-N.avail_out)?(k.mode=31,-4):(V-=N.avail_in,W-=N.avail_out,N.total_in+=V,N.total_out+=W,k.total+=W,k.wrap&&W&&(N.adler=k.check=k.flags?y(k.check,U,W,N.next_out-W):x(k.check,U,W,N.next_out-W)),N.data_type=k.bits+(k.last?64:0)+(k.mode===12?128:0)+(k.mode===20||k.mode===15?256:0),(V==0&&W===0||C===4)&&Ne===0&&(Ne=-5),Ne)},g.inflateEnd=function(N){if(!N||!N.state)return T;var C=N.state;return C.window&&(C.window=null),N.state=null,0},g.inflateGetHeader=function(N,C){var k;return N&&N.state&&2&(k=N.state).wrap?((k.head=C).done=!1,0):T},g.inflateSetDictionary=function(N,C){var k,I=C.length;return N&&N.state?(k=N.state).wrap!==0&&k.mode!==11?T:k.mode===11&&x(1,C,I,0)!==k.check?-3:E(N,C,I,I)?(k.mode=31,-4):(k.havedict=1,0):T},g.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(m,p,g){var v=m("../utils/common"),x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],b=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],j=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];p.exports=function(T,O,R,D,L,q,X,H){var M,F,S,E,N,C,k,I,U,$=H.bits,Y=0,Z=0,re=0,G=0,J=0,V=0,W=0,ee=0,ie=0,oe=0,se=null,le=0,ye=new v.Buf16(16),ue=new v.Buf16(16),ne=null,pe=0;for(Y=0;Y<=15;Y++)ye[Y]=0;for(Z=0;Z<D;Z++)ye[O[R+Z]]++;for(J=$,G=15;1<=G&&ye[G]===0;G--);if(G<J&&(J=G),G===0)return L[q++]=20971520,L[q++]=20971520,H.bits=1,0;for(re=1;re<G&&ye[re]===0;re++);for(J<re&&(J=re),Y=ee=1;Y<=15;Y++)if(ee<<=1,(ee-=ye[Y])<0)return-1;if(0<ee&&(T===0||G!==1))return-1;for(ue[1]=0,Y=1;Y<15;Y++)ue[Y+1]=ue[Y]+ye[Y];for(Z=0;Z<D;Z++)O[R+Z]!==0&&(X[ue[O[R+Z]]++]=Z);if(C=T===0?(se=ne=X,19):T===1?(se=x,le-=257,ne=y,pe-=257,256):(se=b,ne=j,-1),Y=re,N=q,W=Z=oe=0,S=-1,E=(ie=1<<(V=J))-1,T===1&&852<ie||T===2&&592<ie)return 1;for(;;){for(k=Y-W,U=X[Z]<C?(I=0,X[Z]):X[Z]>C?(I=ne[pe+X[Z]],se[le+X[Z]]):(I=96,0),M=1<<Y-W,re=F=1<<V;L[N+(oe>>W)+(F-=M)]=k<<24|I<<16|U|0,F!==0;);for(M=1<<Y-1;oe&M;)M>>=1;if(M!==0?(oe&=M-1,oe+=M):oe=0,Z++,--ye[Y]==0){if(Y===G)break;Y=O[R+X[Z]]}if(J<Y&&(oe&E)!==S){for(W===0&&(W=J),N+=re,ee=1<<(V=Y-W);V+W<G&&!((ee-=ye[V+W])<=0);)V++,ee<<=1;if(ie+=1<<V,T===1&&852<ie||T===2&&592<ie)return 1;L[S=oe&E]=J<<24|V<<16|N-q|0}}return oe!==0&&(L[N+oe]=Y-W<<24|64<<16|0),H.bits=J,0}},{"../utils/common":41}],51:[function(m,p,g){p.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(m,p,g){var v=m("../utils/common");function x(ne){for(var pe=ne.length;0<=--pe;)ne[pe]=0}var y=256,b=286,j=30,T=15,O=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],R=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],D=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],q=new Array(576);x(q);var X=new Array(60);x(X);var H=new Array(512);x(H);var M=new Array(256);x(M);var F=new Array(29);x(F);var S,E,N,C=new Array(j);function k(ne,pe,ge,Ne,_e){this.static_tree=ne,this.extra_bits=pe,this.extra_base=ge,this.elems=Ne,this.max_length=_e,this.has_stree=ne&&ne.length}function I(ne,pe){this.dyn_tree=ne,this.max_code=0,this.stat_desc=pe}function U(ne){return ne<256?H[ne]:H[256+(ne>>>7)]}function $(ne,pe){ne.pending_buf[ne.pending++]=255&pe,ne.pending_buf[ne.pending++]=pe>>>8&255}function Y(ne,pe,ge){ne.bi_valid>16-ge?(ne.bi_buf|=pe<<ne.bi_valid&65535,$(ne,ne.bi_buf),ne.bi_buf=pe>>16-ne.bi_valid,ne.bi_valid+=ge-16):(ne.bi_buf|=pe<<ne.bi_valid&65535,ne.bi_valid+=ge)}function Z(ne,pe,ge){Y(ne,ge[2*pe],ge[2*pe+1])}function re(ne,pe){for(var ge=0;ge|=1&ne,ne>>>=1,ge<<=1,0<--pe;);return ge>>>1}function G(ne,pe,ge){var Ne,_e,be=new Array(16),Me=0;for(Ne=1;Ne<=T;Ne++)be[Ne]=Me=Me+ge[Ne-1]<<1;for(_e=0;_e<=pe;_e++){var Se=ne[2*_e+1];Se!==0&&(ne[2*_e]=re(be[Se]++,Se))}}function J(ne){var pe;for(pe=0;pe<b;pe++)ne.dyn_ltree[2*pe]=0;for(pe=0;pe<j;pe++)ne.dyn_dtree[2*pe]=0;for(pe=0;pe<19;pe++)ne.bl_tree[2*pe]=0;ne.dyn_ltree[512]=1,ne.opt_len=ne.static_len=0,ne.last_lit=ne.matches=0}function V(ne){8<ne.bi_valid?$(ne,ne.bi_buf):0<ne.bi_valid&&(ne.pending_buf[ne.pending++]=ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0}function W(ne,pe,ge,Ne){var _e=2*pe,be=2*ge;return ne[_e]<ne[be]||ne[_e]===ne[be]&&Ne[pe]<=Ne[ge]}function ee(ne,pe,ge){for(var Ne=ne.heap[ge],_e=ge<<1;_e<=ne.heap_len&&(_e<ne.heap_len&&W(pe,ne.heap[_e+1],ne.heap[_e],ne.depth)&&_e++,!W(pe,Ne,ne.heap[_e],ne.depth));)ne.heap[ge]=ne.heap[_e],ge=_e,_e<<=1;ne.heap[ge]=Ne}function ie(ne,pe,ge){var Ne,_e,be,Me,Se=0;if(ne.last_lit!==0)for(;Ne=ne.pending_buf[ne.d_buf+2*Se]<<8|ne.pending_buf[ne.d_buf+2*Se+1],_e=ne.pending_buf[ne.l_buf+Se],Se++,Ne===0?Z(ne,_e,pe):(Z(ne,(be=M[_e])+y+1,pe),(Me=O[be])!==0&&Y(ne,_e-=F[be],Me),Z(ne,be=U(--Ne),ge),(Me=R[be])!==0&&Y(ne,Ne-=C[be],Me)),Se<ne.last_lit;);Z(ne,256,pe)}function oe(ne,pe){var ge,Ne,_e,be=pe.dyn_tree,Me=pe.stat_desc.static_tree,Se=pe.stat_desc.has_stree,$e=pe.stat_desc.elems,Ke=-1;for(ne.heap_len=0,ne.heap_max=573,ge=0;ge<$e;ge++)be[2*ge]!==0?(ne.heap[++ne.heap_len]=Ke=ge,ne.depth[ge]=0):be[2*ge+1]=0;for(;ne.heap_len<2;)be[2*(_e=ne.heap[++ne.heap_len]=Ke<2?++Ke:0)]=1,ne.depth[_e]=0,ne.opt_len--,Se&&(ne.static_len-=Me[2*_e+1]);for(pe.max_code=Ke,ge=ne.heap_len>>1;1<=ge;ge--)ee(ne,be,ge);for(_e=$e;ge=ne.heap[1],ne.heap[1]=ne.heap[ne.heap_len--],ee(ne,be,1),Ne=ne.heap[1],ne.heap[--ne.heap_max]=ge,ne.heap[--ne.heap_max]=Ne,be[2*_e]=be[2*ge]+be[2*Ne],ne.depth[_e]=(ne.depth[ge]>=ne.depth[Ne]?ne.depth[ge]:ne.depth[Ne])+1,be[2*ge+1]=be[2*Ne+1]=_e,ne.heap[1]=_e++,ee(ne,be,1),2<=ne.heap_len;);ne.heap[--ne.heap_max]=ne.heap[1],function(Ze,it){var Re,ot,ut,bt,Je,Ce,Ge=it.dyn_tree,Pe=it.max_code,Ve=it.stat_desc.static_tree,st=it.stat_desc.has_stree,xt=it.stat_desc.extra_bits,fe=it.stat_desc.extra_base,Ie=it.stat_desc.max_length,tt=0;for(bt=0;bt<=T;bt++)Ze.bl_count[bt]=0;for(Ge[2*Ze.heap[Ze.heap_max]+1]=0,Re=Ze.heap_max+1;Re<573;Re++)Ie<(bt=Ge[2*Ge[2*(ot=Ze.heap[Re])+1]+1]+1)&&(bt=Ie,tt++),Ge[2*ot+1]=bt,Pe<ot||(Ze.bl_count[bt]++,Je=0,fe<=ot&&(Je=xt[ot-fe]),Ce=Ge[2*ot],Ze.opt_len+=Ce*(bt+Je),st&&(Ze.static_len+=Ce*(Ve[2*ot+1]+Je)));if(tt!==0){do{for(bt=Ie-1;Ze.bl_count[bt]===0;)bt--;Ze.bl_count[bt]--,Ze.bl_count[bt+1]+=2,Ze.bl_count[Ie]--,tt-=2}while(0<tt);for(bt=Ie;bt!==0;bt--)for(ot=Ze.bl_count[bt];ot!==0;)Pe<(ut=Ze.heap[--Re])||(Ge[2*ut+1]!==bt&&(Ze.opt_len+=(bt-Ge[2*ut+1])*Ge[2*ut],Ge[2*ut+1]=bt),ot--)}}(ne,pe),G(be,Ke,ne.bl_count)}function se(ne,pe,ge){var Ne,_e,be=-1,Me=pe[1],Se=0,$e=7,Ke=4;for(Me===0&&($e=138,Ke=3),pe[2*(ge+1)+1]=65535,Ne=0;Ne<=ge;Ne++)_e=Me,Me=pe[2*(Ne+1)+1],++Se<$e&&_e===Me||(Se<Ke?ne.bl_tree[2*_e]+=Se:_e!==0?(_e!==be&&ne.bl_tree[2*_e]++,ne.bl_tree[32]++):Se<=10?ne.bl_tree[34]++:ne.bl_tree[36]++,be=_e,Ke=(Se=0)===Me?($e=138,3):_e===Me?($e=6,3):($e=7,4))}function le(ne,pe,ge){var Ne,_e,be=-1,Me=pe[1],Se=0,$e=7,Ke=4;for(Me===0&&($e=138,Ke=3),Ne=0;Ne<=ge;Ne++)if(_e=Me,Me=pe[2*(Ne+1)+1],!(++Se<$e&&_e===Me)){if(Se<Ke)for(;Z(ne,_e,ne.bl_tree),--Se!=0;);else _e!==0?(_e!==be&&(Z(ne,_e,ne.bl_tree),Se--),Z(ne,16,ne.bl_tree),Y(ne,Se-3,2)):Se<=10?(Z(ne,17,ne.bl_tree),Y(ne,Se-3,3)):(Z(ne,18,ne.bl_tree),Y(ne,Se-11,7));be=_e,Ke=(Se=0)===Me?($e=138,3):_e===Me?($e=6,3):($e=7,4)}}x(C);var ye=!1;function ue(ne,pe,ge,Ne){Y(ne,0+(Ne?1:0),3),function(_e,be,Me,Se){V(_e),$(_e,Me),$(_e,~Me),v.arraySet(_e.pending_buf,_e.window,be,Me,_e.pending),_e.pending+=Me}(ne,pe,ge)}g._tr_init=function(ne){ye||(function(){var pe,ge,Ne,_e,be,Me=new Array(16);for(_e=Ne=0;_e<28;_e++)for(F[_e]=Ne,pe=0;pe<1<<O[_e];pe++)M[Ne++]=_e;for(M[Ne-1]=_e,_e=be=0;_e<16;_e++)for(C[_e]=be,pe=0;pe<1<<R[_e];pe++)H[be++]=_e;for(be>>=7;_e<j;_e++)for(C[_e]=be<<7,pe=0;pe<1<<R[_e]-7;pe++)H[256+be++]=_e;for(ge=0;ge<=T;ge++)Me[ge]=0;for(pe=0;pe<=143;)q[2*pe+1]=8,pe++,Me[8]++;for(;pe<=255;)q[2*pe+1]=9,pe++,Me[9]++;for(;pe<=279;)q[2*pe+1]=7,pe++,Me[7]++;for(;pe<=287;)q[2*pe+1]=8,pe++,Me[8]++;for(G(q,287,Me),pe=0;pe<j;pe++)X[2*pe+1]=5,X[2*pe]=re(pe,5);S=new k(q,O,257,b,T),E=new k(X,R,0,j,T),N=new k(new Array(0),D,0,19,7)}(),ye=!0),ne.l_desc=new I(ne.dyn_ltree,S),ne.d_desc=new I(ne.dyn_dtree,E),ne.bl_desc=new I(ne.bl_tree,N),ne.bi_buf=0,ne.bi_valid=0,J(ne)},g._tr_stored_block=ue,g._tr_flush_block=function(ne,pe,ge,Ne){var _e,be,Me=0;0<ne.level?(ne.strm.data_type===2&&(ne.strm.data_type=function(Se){var $e,Ke=4093624447;for($e=0;$e<=31;$e++,Ke>>>=1)if(1&Ke&&Se.dyn_ltree[2*$e]!==0)return 0;if(Se.dyn_ltree[18]!==0||Se.dyn_ltree[20]!==0||Se.dyn_ltree[26]!==0)return 1;for($e=32;$e<y;$e++)if(Se.dyn_ltree[2*$e]!==0)return 1;return 0}(ne)),oe(ne,ne.l_desc),oe(ne,ne.d_desc),Me=function(Se){var $e;for(se(Se,Se.dyn_ltree,Se.l_desc.max_code),se(Se,Se.dyn_dtree,Se.d_desc.max_code),oe(Se,Se.bl_desc),$e=18;3<=$e&&Se.bl_tree[2*L[$e]+1]===0;$e--);return Se.opt_len+=3*($e+1)+5+5+4,$e}(ne),_e=ne.opt_len+3+7>>>3,(be=ne.static_len+3+7>>>3)<=_e&&(_e=be)):_e=be=ge+5,ge+4<=_e&&pe!==-1?ue(ne,pe,ge,Ne):ne.strategy===4||be===_e?(Y(ne,2+(Ne?1:0),3),ie(ne,q,X)):(Y(ne,4+(Ne?1:0),3),function(Se,$e,Ke,Ze){var it;for(Y(Se,$e-257,5),Y(Se,Ke-1,5),Y(Se,Ze-4,4),it=0;it<Ze;it++)Y(Se,Se.bl_tree[2*L[it]+1],3);le(Se,Se.dyn_ltree,$e-1),le(Se,Se.dyn_dtree,Ke-1)}(ne,ne.l_desc.max_code+1,ne.d_desc.max_code+1,Me+1),ie(ne,ne.dyn_ltree,ne.dyn_dtree)),J(ne),Ne&&V(ne)},g._tr_tally=function(ne,pe,ge){return ne.pending_buf[ne.d_buf+2*ne.last_lit]=pe>>>8&255,ne.pending_buf[ne.d_buf+2*ne.last_lit+1]=255&pe,ne.pending_buf[ne.l_buf+ne.last_lit]=255&ge,ne.last_lit++,pe===0?ne.dyn_ltree[2*ge]++:(ne.matches++,pe--,ne.dyn_ltree[2*(M[ge]+y+1)]++,ne.dyn_dtree[2*U(pe)]++),ne.last_lit===ne.lit_bufsize-1},g._tr_align=function(ne){Y(ne,2,3),Z(ne,256,q),function(pe){pe.bi_valid===16?($(pe,pe.bi_buf),pe.bi_buf=0,pe.bi_valid=0):8<=pe.bi_valid&&(pe.pending_buf[pe.pending++]=255&pe.bi_buf,pe.bi_buf>>=8,pe.bi_valid-=8)}(ne)}},{"../utils/common":41}],53:[function(m,p,g){p.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(m,p,g){(function(v){(function(x,y){if(!x.setImmediate){var b,j,T,O,R=1,D={},L=!1,q=x.document,X=Object.getPrototypeOf&&Object.getPrototypeOf(x);X=X&&X.setTimeout?X:x,b={}.toString.call(x.process)==="[object process]"?function(S){i.nextTick(function(){M(S)})}:function(){if(x.postMessage&&!x.importScripts){var S=!0,E=x.onmessage;return x.onmessage=function(){S=!1},x.postMessage("","*"),x.onmessage=E,S}}()?(O="setImmediate$"+Math.random()+"$",x.addEventListener?x.addEventListener("message",F,!1):x.attachEvent("onmessage",F),function(S){x.postMessage(O+S,"*")}):x.MessageChannel?((T=new MessageChannel).port1.onmessage=function(S){M(S.data)},function(S){T.port2.postMessage(S)}):q&&"onreadystatechange"in q.createElement("script")?(j=q.documentElement,function(S){var E=q.createElement("script");E.onreadystatechange=function(){M(S),E.onreadystatechange=null,j.removeChild(E),E=null},j.appendChild(E)}):function(S){setTimeout(M,0,S)},X.setImmediate=function(S){typeof S!="function"&&(S=new Function(""+S));for(var E=new Array(arguments.length-1),N=0;N<E.length;N++)E[N]=arguments[N+1];var C={callback:S,args:E};return D[R]=C,b(R),R++},X.clearImmediate=H}function H(S){delete D[S]}function M(S){if(L)setTimeout(M,0,S);else{var E=D[S];if(E){L=!0;try{(function(N){var C=N.callback,k=N.args;switch(k.length){case 0:C();break;case 1:C(k[0]);break;case 2:C(k[0],k[1]);break;case 3:C(k[0],k[1],k[2]);break;default:C.apply(void 0,k)}})(E)}finally{H(S),L=!1}}}}function F(S){S.source===x&&typeof S.data=="string"&&S.data.indexOf(O)===0&&M(+S.data.slice(O.length))}})(typeof self>"u"?v===void 0?this:v:self)}).call(this,o!==void 0?o:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}).call(this)}).call(this,r("_process"),typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],r("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(r,s,a){(function(i){(function(){var o=/[\\^$.*+?()[\]{}|]/g,c=RegExp(o.source),d=typeof i=="object"&&i&&i.Object===Object&&i,l=typeof self=="object"&&self&&self.Object===Object&&self,u=d||l||Function("return this")(),h=Object.prototype.toString,f=u.Symbol,m=f?f.prototype:void 0,p=m?m.toString:void 0;function g(v){if(typeof v=="string")return v;if(function(y){return typeof y=="symbol"||function(b){return!!b&&typeof b=="object"}(y)&&h.call(y)=="[object Symbol]"}(v))return p?p.call(v):"";var x=v+"";return x=="0"&&1/v==-1/0?"-0":x}s.exports=function(v){var x;return(v=(x=v)==null?"":g(x))&&c.test(v)?v.replace(o,"\\$&"):v}}).call(this)}).call(this,typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(r,s,a){(function(i){(function(){var o="[object Arguments]",c="[object Map]",d="[object Object]",l="[object Set]",u=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h=/^\w*$/,f=/^\./,m=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,p=/\\(\\)?/g,g=/^\[object .+?Constructor\]$/,v=/^(?:0|[1-9]\d*)$/,x={};x["[object Float32Array]"]=x["[object Float64Array]"]=x["[object Int8Array]"]=x["[object Int16Array]"]=x["[object Int32Array]"]=x["[object Uint8Array]"]=x["[object Uint8ClampedArray]"]=x["[object Uint16Array]"]=x["[object Uint32Array]"]=!0,x[o]=x["[object Array]"]=x["[object ArrayBuffer]"]=x["[object Boolean]"]=x["[object DataView]"]=x["[object Date]"]=x["[object Error]"]=x["[object Function]"]=x[c]=x["[object Number]"]=x[d]=x["[object RegExp]"]=x[l]=x["[object String]"]=x["[object WeakMap]"]=!1;var y=typeof i=="object"&&i&&i.Object===Object&&i,b=typeof self=="object"&&self&&self.Object===Object&&self,j=y||b||Function("return this")(),T=typeof a=="object"&&a&&!a.nodeType&&a,O=T&&typeof s=="object"&&s&&!s.nodeType&&s,R=O&&O.exports===T&&y.process,D=function(){try{return R&&R.binding("util")}catch{}}(),L=D&&D.isTypedArray;function q(Ee,Xe,dt,Fe){for(var Zt=-1,wt=Ee?Ee.length:0;++Zt<wt;){var Et=Ee[Zt];Xe(Fe,Et,dt(Et),Ee)}return Fe}function X(Ee,Xe){for(var dt=-1,Fe=Ee?Ee.length:0;++dt<Fe;)if(Xe(Ee[dt],dt,Ee))return!0;return!1}function H(Ee){var Xe=!1;if(Ee!=null&&typeof Ee.toString!="function")try{Xe=!!(Ee+"")}catch{}return Xe}function M(Ee){var Xe=-1,dt=Array(Ee.size);return Ee.forEach(function(Fe,Zt){dt[++Xe]=[Zt,Fe]}),dt}function F(Ee){var Xe=-1,dt=Array(Ee.size);return Ee.forEach(function(Fe){dt[++Xe]=Fe}),dt}var S,E,N,C=Array.prototype,k=Function.prototype,I=Object.prototype,U=j["__core-js_shared__"],$=(S=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",Y=k.toString,Z=I.hasOwnProperty,re=I.toString,G=RegExp("^"+Y.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),J=j.Symbol,V=j.Uint8Array,W=I.propertyIsEnumerable,ee=C.splice,ie=(E=Object.keys,N=Object,function(Ee){return E(N(Ee))}),oe=at(j,"DataView"),se=at(j,"Map"),le=at(j,"Promise"),ye=at(j,"Set"),ue=at(j,"WeakMap"),ne=at(Object,"create"),pe=qe(oe),ge=qe(se),Ne=qe(le),_e=qe(ye),be=qe(ue),Me=J?J.prototype:void 0,Se=Me?Me.valueOf:void 0,$e=Me?Me.toString:void 0;function Ke(Ee){var Xe=-1,dt=Ee?Ee.length:0;for(this.clear();++Xe<dt;){var Fe=Ee[Xe];this.set(Fe[0],Fe[1])}}function Ze(Ee){var Xe=-1,dt=Ee?Ee.length:0;for(this.clear();++Xe<dt;){var Fe=Ee[Xe];this.set(Fe[0],Fe[1])}}function it(Ee){var Xe=-1,dt=Ee?Ee.length:0;for(this.clear();++Xe<dt;){var Fe=Ee[Xe];this.set(Fe[0],Fe[1])}}function Re(Ee){var Xe=-1,dt=Ee?Ee.length:0;for(this.__data__=new it;++Xe<dt;)this.add(Ee[Xe])}function ot(Ee){this.__data__=new Ze(Ee)}function ut(Ee,Xe){var dt=sr(Ee)||_r(Ee)?function(Et,kr){for(var Jt=-1,tr=Array(Et);++Jt<Et;)tr[Jt]=kr(Jt);return tr}(Ee.length,String):[],Fe=dt.length,Zt=!!Fe;for(var wt in Ee)!Z.call(Ee,wt)||Zt&&(wt=="length"||Yt(wt,Fe))||dt.push(wt);return dt}function bt(Ee,Xe){for(var dt=Ee.length;dt--;)if(Dt(Ee[dt][0],Xe))return dt;return-1}function Je(Ee,Xe,dt,Fe){return Ge(Ee,function(Zt,wt,Et){Xe(Fe,Zt,dt(Zt),Et)}),Fe}Ke.prototype.clear=function(){this.__data__=ne?ne(null):{}},Ke.prototype.delete=function(Ee){return this.has(Ee)&&delete this.__data__[Ee]},Ke.prototype.get=function(Ee){var Xe=this.__data__;if(ne){var dt=Xe[Ee];return dt==="__lodash_hash_undefined__"?void 0:dt}return Z.call(Xe,Ee)?Xe[Ee]:void 0},Ke.prototype.has=function(Ee){var Xe=this.__data__;return ne?Xe[Ee]!==void 0:Z.call(Xe,Ee)},Ke.prototype.set=function(Ee,Xe){return this.__data__[Ee]=ne&&Xe===void 0?"__lodash_hash_undefined__":Xe,this},Ze.prototype.clear=function(){this.__data__=[]},Ze.prototype.delete=function(Ee){var Xe=this.__data__,dt=bt(Xe,Ee);return!(dt<0)&&(dt==Xe.length-1?Xe.pop():ee.call(Xe,dt,1),!0)},Ze.prototype.get=function(Ee){var Xe=this.__data__,dt=bt(Xe,Ee);return dt<0?void 0:Xe[dt][1]},Ze.prototype.has=function(Ee){return bt(this.__data__,Ee)>-1},Ze.prototype.set=function(Ee,Xe){var dt=this.__data__,Fe=bt(dt,Ee);return Fe<0?dt.push([Ee,Xe]):dt[Fe][1]=Xe,this},it.prototype.clear=function(){this.__data__={hash:new Ke,map:new(se||Ze),string:new Ke}},it.prototype.delete=function(Ee){return ct(this,Ee).delete(Ee)},it.prototype.get=function(Ee){return ct(this,Ee).get(Ee)},it.prototype.has=function(Ee){return ct(this,Ee).has(Ee)},it.prototype.set=function(Ee,Xe){return ct(this,Ee).set(Ee,Xe),this},Re.prototype.add=Re.prototype.push=function(Ee){return this.__data__.set(Ee,"__lodash_hash_undefined__"),this},Re.prototype.has=function(Ee){return this.__data__.has(Ee)},ot.prototype.clear=function(){this.__data__=new Ze},ot.prototype.delete=function(Ee){return this.__data__.delete(Ee)},ot.prototype.get=function(Ee){return this.__data__.get(Ee)},ot.prototype.has=function(Ee){return this.__data__.has(Ee)},ot.prototype.set=function(Ee,Xe){var dt=this.__data__;if(dt instanceof Ze){var Fe=dt.__data__;if(!se||Fe.length<199)return Fe.push([Ee,Xe]),this;dt=this.__data__=new it(Fe)}return dt.set(Ee,Xe),this};var Ce,Ge=(Ce=function(Ee,Xe){return Ee&&Pe(Ee,Xe,nr)},function(Ee,Xe){if(Ee==null)return Ee;if(!or(Ee))return Ce(Ee,Xe);for(var dt=Ee.length,Fe=-1,Zt=Object(Ee);++Fe<dt&&Xe(Zt[Fe],Fe,Zt)!==!1;);return Ee}),Pe=function(Ee){return function(Xe,dt,Fe){for(var Zt=-1,wt=Object(Xe),Et=Fe(Xe),kr=Et.length;kr--;){var Jt=Et[++Zt];if(dt(wt[Jt],Jt,wt)===!1)break}return Xe}}();function Ve(Ee,Xe){for(var dt=0,Fe=(Xe=St(Xe,Ee)?[Xe]:lt(Xe)).length;Ee!=null&&dt<Fe;)Ee=Ee[Te(Xe[dt++])];return dt&&dt==Fe?Ee:void 0}function st(Ee,Xe){return Ee!=null&&Xe in Object(Ee)}function xt(Ee,Xe,dt,Fe,Zt){return Ee===Xe||(Ee==null||Xe==null||!Nr(Ee)&&!et(Xe)?Ee!=Ee&&Xe!=Xe:function(wt,Et,kr,Jt,tr,zt){var vn=sr(wt),yn=sr(Et),wn="[object Array]",Hr="[object Array]";vn||(wn=(wn=gt(wt))==o?d:wn),yn||(Hr=(Hr=gt(Et))==o?d:Hr);var Gn=wn==d&&!H(wt),Ba=Hr==d&&!H(Et),_n=wn==Hr;if(_n&&!Gn)return zt||(zt=new ot),vn||rr(wt)?It(wt,Et,kr,Jt,tr,zt):function(Fr,Ye,ke,ur,js,Qn,al){switch(ke){case"[object DataView]":if(Fr.byteLength!=Ye.byteLength||Fr.byteOffset!=Ye.byteOffset)return!1;Fr=Fr.buffer,Ye=Ye.buffer;case"[object ArrayBuffer]":return!(Fr.byteLength!=Ye.byteLength||!ur(new V(Fr),new V(Ye)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Dt(+Fr,+Ye);case"[object Error]":return Fr.name==Ye.name&&Fr.message==Ye.message;case"[object RegExp]":case"[object String]":return Fr==Ye+"";case c:var Ao=M;case l:var Ca=2&Qn;if(Ao||(Ao=F),Fr.size!=Ye.size&&!Ca)return!1;var vr=al.get(Fr);if(vr)return vr==Ye;Qn|=1,al.set(Fr,Ye);var Mn=It(Ao(Fr),Ao(Ye),ur,js,Qn,al);return al.delete(Fr),Mn;case"[object Symbol]":if(Se)return Se.call(Fr)==Se.call(Ye)}return!1}(wt,Et,wn,kr,Jt,tr,zt);if(!(2&tr)){var Ja=Gn&&Z.call(wt,"__wrapped__"),kd=Ba&&Z.call(Et,"__wrapped__");if(Ja||kd){var to=Ja?wt.value():wt,jn=kd?Et.value():Et;return zt||(zt=new ot),kr(to,jn,Jt,tr,zt)}}return _n?(zt||(zt=new ot),function(Fr,Ye,ke,ur,js,Qn){var al=2&js,Ao=nr(Fr),Ca=Ao.length,vr=nr(Ye).length;if(Ca!=vr&&!al)return!1;for(var Mn=Ca;Mn--;){var il=Ao[Mn];if(!(al?il in Ye:Z.call(Ye,il)))return!1}var J1=Qn.get(Fr);if(J1&&Qn.get(Ye))return J1==Ye;var Ad=!0;Qn.set(Fr,Ye),Qn.set(Ye,Fr);for(var Td=al;++Mn<Ca;){il=Ao[Mn];var Pd=Fr[il],Bf=Ye[il];if(ur)var Vs=al?ur(Bf,Pd,il,Ye,Fr,Qn):ur(Pd,Bf,il,Fr,Ye,Qn);if(!(Vs===void 0?Pd===Bf||ke(Pd,Bf,ur,js,Qn):Vs)){Ad=!1;break}Td||(Td=il=="constructor")}if(Ad&&!Td){var Ul=Fr.constructor,ro=Ye.constructor;Ul==ro||!("constructor"in Fr)||!("constructor"in Ye)||typeof Ul=="function"&&Ul instanceof Ul&&typeof ro=="function"&&ro instanceof ro||(Ad=!1)}return Qn.delete(Fr),Qn.delete(Ye),Ad}(wt,Et,kr,Jt,tr,zt)):!1}(Ee,Xe,xt,dt,Fe,Zt))}function fe(Ee){return!(!Nr(Ee)||function(Xe){return!!$&&$ in Xe}(Ee))&&(jr(Ee)||H(Ee)?G:g).test(qe(Ee))}function Ie(Ee){return typeof Ee=="function"?Ee:Ee==null?Qt:typeof Ee=="object"?sr(Ee)?function(Fe,Zt){return St(Fe)&&rt(Zt)?ir(Te(Fe),Zt):function(wt){var Et=function(kr,Jt,tr){var zt=kr==null?void 0:Ve(kr,Jt);return zt===void 0?tr:zt}(wt,Fe);return Et===void 0&&Et===Zt?function(kr,Jt){return kr!=null&&function(tr,zt,vn){zt=St(zt,tr)?[zt]:lt(zt);for(var yn,wn=-1,Hr=zt.length;++wn<Hr;){var Gn=Te(zt[wn]);if(!(yn=tr!=null&&vn(tr,Gn)))break;tr=tr[Gn]}return yn||!!(Hr=tr?tr.length:0)&&br(Hr)&&Yt(Gn,Hr)&&(sr(tr)||_r(tr))}(kr,Jt,st)}(wt,Fe):xt(Zt,Et,void 0,3)}}(Ee[0],Ee[1]):function(Fe){var Zt=function(wt){for(var Et=nr(wt),kr=Et.length;kr--;){var Jt=Et[kr],tr=wt[Jt];Et[kr]=[Jt,tr,rt(tr)]}return Et}(Fe);return Zt.length==1&&Zt[0][2]?ir(Zt[0][0],Zt[0][1]):function(wt){return wt===Fe||function(Et,kr,Jt,tr){var zt=Jt.length,vn=zt;if(Et==null)return!vn;for(Et=Object(Et);zt--;){var yn=Jt[zt];if(yn[2]?yn[1]!==Et[yn[0]]:!(yn[0]in Et))return!1}for(;++zt<vn;){var wn=(yn=Jt[zt])[0],Hr=Et[wn],Gn=yn[1];if(yn[2]){if(Hr===void 0&&!(wn in Et))return!1}else{var Ba=new ot,_n;if(!(_n===void 0?xt(Gn,Hr,tr,3,Ba):_n))return!1}}return!0}(wt,Fe,Zt)}}(Ee):St(Xe=Ee)?(dt=Te(Xe),function(Fe){return Fe==null?void 0:Fe[dt]}):function(Fe){return function(Zt){return Ve(Zt,Fe)}}(Xe);var Xe,dt}function tt(Ee){if(dt=(Xe=Ee)&&Xe.constructor,Fe=typeof dt=="function"&&dt.prototype||I,Xe!==Fe)return ie(Ee);var Xe,dt,Fe,Zt=[];for(var wt in Object(Ee))Z.call(Ee,wt)&&wt!="constructor"&&Zt.push(wt);return Zt}function lt(Ee){return sr(Ee)?Ee:Ct(Ee)}function It(Ee,Xe,dt,Fe,Zt,wt){var Et=2&Zt,kr=Ee.length,Jt=Xe.length;if(kr!=Jt&&!(Et&&Jt>kr))return!1;var tr=wt.get(Ee);if(tr&&wt.get(Xe))return tr==Xe;var zt=-1,vn=!0,yn=1&Zt?new Re:void 0;for(wt.set(Ee,Xe),wt.set(Xe,Ee);++zt<kr;){var wn=Ee[zt],Hr=Xe[zt];if(Fe)var Gn=Et?Fe(Hr,wn,zt,Xe,Ee,wt):Fe(wn,Hr,zt,Ee,Xe,wt);if(Gn!==void 0){if(Gn)continue;vn=!1;break}if(yn){if(!X(Xe,function(Ba,_n){if(!yn.has(_n)&&(wn===Ba||dt(wn,Ba,Fe,Zt,wt)))return yn.add(_n)})){vn=!1;break}}else if(wn!==Hr&&!dt(wn,Hr,Fe,Zt,wt)){vn=!1;break}}return wt.delete(Ee),wt.delete(Xe),vn}function ct(Ee,Xe){var dt,Fe,Zt=Ee.__data__;return((Fe=typeof(dt=Xe))=="string"||Fe=="number"||Fe=="symbol"||Fe=="boolean"?dt!=="__proto__":dt===null)?Zt[typeof Xe=="string"?"string":"hash"]:Zt.map}function at(Ee,Xe){var dt=function(Fe,Zt){return Fe==null?void 0:Fe[Zt]}(Ee,Xe);return fe(dt)?dt:void 0}var gt=function(Ee){return re.call(Ee)};function Yt(Ee,Xe){return!!(Xe=Xe??9007199254740991)&&(typeof Ee=="number"||v.test(Ee))&&Ee>-1&&Ee%1==0&&Ee<Xe}function St(Ee,Xe){if(sr(Ee))return!1;var dt=typeof Ee;return!(dt!="number"&&dt!="symbol"&&dt!="boolean"&&Ee!=null&&!Tt(Ee))||h.test(Ee)||!u.test(Ee)||Xe!=null&&Ee in Object(Xe)}function rt(Ee){return Ee==Ee&&!Nr(Ee)}function ir(Ee,Xe){return function(dt){return dt!=null&&dt[Ee]===Xe&&(Xe!==void 0||Ee in Object(dt))}}(oe&&gt(new oe(new ArrayBuffer(1)))!="[object DataView]"||se&&gt(new se)!=c||le&&gt(le.resolve())!="[object Promise]"||ye&&gt(new ye)!=l||ue&&gt(new ue)!="[object WeakMap]")&&(gt=function(Ee){var Xe=re.call(Ee),dt=Xe==d?Ee.constructor:void 0,Fe=dt?qe(dt):void 0;if(Fe)switch(Fe){case pe:return"[object DataView]";case ge:return c;case Ne:return"[object Promise]";case _e:return l;case be:return"[object WeakMap]"}return Xe});var Ct=vt(function(Ee){var Xe;Ee=(Xe=Ee)==null?"":function(Fe){if(typeof Fe=="string")return Fe;if(Tt(Fe))return $e?$e.call(Fe):"";var Zt=Fe+"";return Zt=="0"&&1/Fe==-1/0?"-0":Zt}(Xe);var dt=[];return f.test(Ee)&&dt.push(""),Ee.replace(m,function(Fe,Zt,wt,Et){dt.push(wt?Et.replace(p,"$1"):Zt||Fe)}),dt});function Te(Ee){if(typeof Ee=="string"||Tt(Ee))return Ee;var Xe=Ee+"";return Xe=="0"&&1/Ee==-1/0?"-0":Xe}function qe(Ee){if(Ee!=null){try{return Y.call(Ee)}catch{}try{return Ee+""}catch{}}return""}var ht,Pt=(ht=function(Ee,Xe,dt){Z.call(Ee,dt)?Ee[dt].push(Xe):Ee[dt]=[Xe]},function(Ee,Xe){var dt=sr(Ee)?q:Je,Fe={};return dt(Ee,ht,Ie(Xe),Fe)});function vt(Ee,Xe){if(typeof Ee!="function"||Xe&&typeof Xe!="function")throw new TypeError("Expected a function");var dt=function(){var Fe=arguments,Zt=Xe?Xe.apply(this,Fe):Fe[0],wt=dt.cache;if(wt.has(Zt))return wt.get(Zt);var Et=Ee.apply(this,Fe);return dt.cache=wt.set(Zt,Et),Et};return dt.cache=new(vt.Cache||it),dt}function Dt(Ee,Xe){return Ee===Xe||Ee!=Ee&&Xe!=Xe}function _r(Ee){return function(Xe){return et(Xe)&&or(Xe)}(Ee)&&Z.call(Ee,"callee")&&(!W.call(Ee,"callee")||re.call(Ee)==o)}vt.Cache=it;var sr=Array.isArray;function or(Ee){return Ee!=null&&br(Ee.length)&&!jr(Ee)}function jr(Ee){var Xe=Nr(Ee)?re.call(Ee):"";return Xe=="[object Function]"||Xe=="[object GeneratorFunction]"}function br(Ee){return typeof Ee=="number"&&Ee>-1&&Ee%1==0&&Ee<=9007199254740991}function Nr(Ee){var Xe=typeof Ee;return!!Ee&&(Xe=="object"||Xe=="function")}function et(Ee){return!!Ee&&typeof Ee=="object"}function Tt(Ee){return typeof Ee=="symbol"||et(Ee)&&re.call(Ee)=="[object Symbol]"}var rr=L?function(Ee){return function(Xe){return Ee(Xe)}}(L):function(Ee){return et(Ee)&&br(Ee.length)&&!!x[re.call(Ee)]};function nr(Ee){return or(Ee)?ut(Ee):tt(Ee)}function Qt(Ee){return Ee}s.exports=Pt}).call(this)}).call(this,typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(r,s,a){var i=Object.prototype.toString;s.exports=function(o){return o===!0||o===!1||function(c){return!!c&&typeof c=="object"}(o)&&i.call(o)=="[object Boolean]"}},{}],445:[function(r,s,a){(function(i){(function(){var o="[object Arguments]",c="[object Map]",d="[object Object]",l="[object Set]",u=/^\[object .+?Constructor\]$/,h=/^(?:0|[1-9]\d*)$/,f={};f["[object Float32Array]"]=f["[object Float64Array]"]=f["[object Int8Array]"]=f["[object Int16Array]"]=f["[object Int32Array]"]=f["[object Uint8Array]"]=f["[object Uint8ClampedArray]"]=f["[object Uint16Array]"]=f["[object Uint32Array]"]=!0,f[o]=f["[object Array]"]=f["[object ArrayBuffer]"]=f["[object Boolean]"]=f["[object DataView]"]=f["[object Date]"]=f["[object Error]"]=f["[object Function]"]=f[c]=f["[object Number]"]=f[d]=f["[object RegExp]"]=f[l]=f["[object String]"]=f["[object WeakMap]"]=!1;var m=typeof i=="object"&&i&&i.Object===Object&&i,p=typeof self=="object"&&self&&self.Object===Object&&self,g=m||p||Function("return this")(),v=typeof a=="object"&&a&&!a.nodeType&&a,x=v&&typeof s=="object"&&s&&!s.nodeType&&s,y=x&&x.exports===v,b=y&&m.process,j=function(){try{return b&&b.binding&&b.binding("util")}catch{}}(),T=j&&j.isTypedArray;function O(Te,qe){for(var ht=-1,Pt=Te==null?0:Te.length;++ht<Pt;)if(qe(Te[ht],ht,Te))return!0;return!1}function R(Te){var qe=-1,ht=Array(Te.size);return Te.forEach(function(Pt,vt){ht[++qe]=[vt,Pt]}),ht}function D(Te){var qe=-1,ht=Array(Te.size);return Te.forEach(function(Pt){ht[++qe]=Pt}),ht}var L,q,X,H=Array.prototype,M=Function.prototype,F=Object.prototype,S=g["__core-js_shared__"],E=M.toString,N=F.hasOwnProperty,C=(L=/[^.]+$/.exec(S&&S.keys&&S.keys.IE_PROTO||""))?"Symbol(src)_1."+L:"",k=F.toString,I=RegExp("^"+E.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),U=y?g.Buffer:void 0,$=g.Symbol,Y=g.Uint8Array,Z=F.propertyIsEnumerable,re=H.splice,G=$?$.toStringTag:void 0,J=Object.getOwnPropertySymbols,V=U?U.isBuffer:void 0,W=(q=Object.keys,X=Object,function(Te){return q(X(Te))}),ee=st(g,"DataView"),ie=st(g,"Map"),oe=st(g,"Promise"),se=st(g,"Set"),le=st(g,"WeakMap"),ye=st(Object,"create"),ue=tt(ee),ne=tt(ie),pe=tt(oe),ge=tt(se),Ne=tt(le),_e=$?$.prototype:void 0,be=_e?_e.valueOf:void 0;function Me(Te){var qe=-1,ht=Te==null?0:Te.length;for(this.clear();++qe<ht;){var Pt=Te[qe];this.set(Pt[0],Pt[1])}}function Se(Te){var qe=-1,ht=Te==null?0:Te.length;for(this.clear();++qe<ht;){var Pt=Te[qe];this.set(Pt[0],Pt[1])}}function $e(Te){var qe=-1,ht=Te==null?0:Te.length;for(this.clear();++qe<ht;){var Pt=Te[qe];this.set(Pt[0],Pt[1])}}function Ke(Te){var qe=-1,ht=Te==null?0:Te.length;for(this.__data__=new $e;++qe<ht;)this.add(Te[qe])}function Ze(Te){var qe=this.__data__=new Se(Te);this.size=qe.size}function it(Te,qe){var ht=ct(Te),Pt=!ht&&It(Te),vt=!ht&&!Pt&&at(Te),Dt=!ht&&!Pt&&!vt&&ir(Te),_r=ht||Pt||vt||Dt,sr=_r?function(br,Nr){for(var et=-1,Tt=Array(br);++et<br;)Tt[et]=Nr(et);return Tt}(Te.length,String):[],or=sr.length;for(var jr in Te)!N.call(Te,jr)||_r&&(jr=="length"||vt&&(jr=="offset"||jr=="parent")||Dt&&(jr=="buffer"||jr=="byteLength"||jr=="byteOffset")||Ie(jr,or))||sr.push(jr);return sr}function Re(Te,qe){for(var ht=Te.length;ht--;)if(lt(Te[ht][0],qe))return ht;return-1}function ot(Te){return Te==null?Te===void 0?"[object Undefined]":"[object Null]":G&&G in Object(Te)?function(qe){var ht=N.call(qe,G),Pt=qe[G];try{qe[G]=void 0;var vt=!0}catch{}var Dt=k.call(qe);return vt&&(ht?qe[G]=Pt:delete qe[G]),Dt}(Te):function(qe){return k.call(qe)}(Te)}function ut(Te){return rt(Te)&&ot(Te)==o}function bt(Te,qe,ht,Pt,vt){return Te===qe||(Te==null||qe==null||!rt(Te)&&!rt(qe)?Te!=Te&&qe!=qe:function(Dt,_r,sr,or,jr,br){var Nr=ct(Dt),et=ct(_r),Tt=Nr?"[object Array]":fe(Dt),rr=et?"[object Array]":fe(_r),nr=(Tt=Tt==o?d:Tt)==d,Qt=(rr=rr==o?d:rr)==d,Ee=Tt==rr;if(Ee&&at(Dt)){if(!at(_r))return!1;Nr=!0,nr=!1}if(Ee&&!nr)return br||(br=new Ze),Nr||ir(Dt)?Ge(Dt,_r,sr,or,jr,br):function(wt,Et,kr,Jt,tr,zt,vn){switch(kr){case"[object DataView]":if(wt.byteLength!=Et.byteLength||wt.byteOffset!=Et.byteOffset)return!1;wt=wt.buffer,Et=Et.buffer;case"[object ArrayBuffer]":return!(wt.byteLength!=Et.byteLength||!zt(new Y(wt),new Y(Et)));case"[object Boolean]":case"[object Date]":case"[object Number]":return lt(+wt,+Et);case"[object Error]":return wt.name==Et.name&&wt.message==Et.message;case"[object RegExp]":case"[object String]":return wt==Et+"";case c:var yn=R;case l:var wn=1&Jt;if(yn||(yn=D),wt.size!=Et.size&&!wn)return!1;var Hr=vn.get(wt);if(Hr)return Hr==Et;Jt|=2,vn.set(wt,Et);var Gn=Ge(yn(wt),yn(Et),Jt,tr,zt,vn);return vn.delete(wt),Gn;case"[object Symbol]":if(be)return be.call(wt)==be.call(Et)}return!1}(Dt,_r,Tt,sr,or,jr,br);if(!(1&sr)){var Xe=nr&&N.call(Dt,"__wrapped__"),dt=Qt&&N.call(_r,"__wrapped__");if(Xe||dt){var Fe=Xe?Dt.value():Dt,Zt=dt?_r.value():_r;return br||(br=new Ze),jr(Fe,Zt,sr,or,br)}}return Ee?(br||(br=new Ze),function(wt,Et,kr,Jt,tr,zt){var vn=1&kr,yn=Pe(wt),wn=yn.length,Hr=Pe(Et).length;if(wn!=Hr&&!vn)return!1;for(var Gn=wn;Gn--;){var Ba=yn[Gn];if(!(vn?Ba in Et:N.call(Et,Ba)))return!1}var _n=zt.get(wt);if(_n&&zt.get(Et))return _n==Et;var Ja=!0;zt.set(wt,Et),zt.set(Et,wt);for(var kd=vn;++Gn<wn;){Ba=yn[Gn];var to=wt[Ba],jn=Et[Ba];if(Jt)var Fr=vn?Jt(jn,to,Ba,Et,wt,zt):Jt(to,jn,Ba,wt,Et,zt);if(!(Fr===void 0?to===jn||tr(to,jn,kr,Jt,zt):Fr)){Ja=!1;break}kd||(kd=Ba=="constructor")}if(Ja&&!kd){var Ye=wt.constructor,ke=Et.constructor;Ye==ke||!("constructor"in wt)||!("constructor"in Et)||typeof Ye=="function"&&Ye instanceof Ye&&typeof ke=="function"&&ke instanceof ke||(Ja=!1)}return zt.delete(wt),zt.delete(Et),Ja}(Dt,_r,sr,or,jr,br)):!1}(Te,qe,ht,Pt,bt,vt))}function Je(Te){return!(!St(Te)||function(qe){return!!C&&C in qe}(Te))&&(gt(Te)?I:u).test(tt(Te))}function Ce(Te){if(ht=(qe=Te)&&qe.constructor,Pt=typeof ht=="function"&&ht.prototype||F,qe!==Pt)return W(Te);var qe,ht,Pt,vt=[];for(var Dt in Object(Te))N.call(Te,Dt)&&Dt!="constructor"&&vt.push(Dt);return vt}function Ge(Te,qe,ht,Pt,vt,Dt){var _r=1&ht,sr=Te.length,or=qe.length;if(sr!=or&&!(_r&&or>sr))return!1;var jr=Dt.get(Te);if(jr&&Dt.get(qe))return jr==qe;var br=-1,Nr=!0,et=2&ht?new Ke:void 0;for(Dt.set(Te,qe),Dt.set(qe,Te);++br<sr;){var Tt=Te[br],rr=qe[br];if(Pt)var nr=_r?Pt(rr,Tt,br,qe,Te,Dt):Pt(Tt,rr,br,Te,qe,Dt);if(nr!==void 0){if(nr)continue;Nr=!1;break}if(et){if(!O(qe,function(Qt,Ee){if(Xe=Ee,!et.has(Xe)&&(Tt===Qt||vt(Tt,Qt,ht,Pt,Dt)))return et.push(Ee);var Xe})){Nr=!1;break}}else if(Tt!==rr&&!vt(Tt,rr,ht,Pt,Dt)){Nr=!1;break}}return Dt.delete(Te),Dt.delete(qe),Nr}function Pe(Te){return function(qe,ht,Pt){var vt=ht(qe);return ct(qe)?vt:function(Dt,_r){for(var sr=-1,or=_r.length,jr=Dt.length;++sr<or;)Dt[jr+sr]=_r[sr];return Dt}(vt,Pt(qe))}(Te,Ct,xt)}function Ve(Te,qe){var ht,Pt,vt=Te.__data__;return((Pt=typeof(ht=qe))=="string"||Pt=="number"||Pt=="symbol"||Pt=="boolean"?ht!=="__proto__":ht===null)?vt[typeof qe=="string"?"string":"hash"]:vt.map}function st(Te,qe){var ht=function(Pt,vt){return Pt==null?void 0:Pt[vt]}(Te,qe);return Je(ht)?ht:void 0}Me.prototype.clear=function(){this.__data__=ye?ye(null):{},this.size=0},Me.prototype.delete=function(Te){var qe=this.has(Te)&&delete this.__data__[Te];return this.size-=qe?1:0,qe},Me.prototype.get=function(Te){var qe=this.__data__;if(ye){var ht=qe[Te];return ht==="__lodash_hash_undefined__"?void 0:ht}return N.call(qe,Te)?qe[Te]:void 0},Me.prototype.has=function(Te){var qe=this.__data__;return ye?qe[Te]!==void 0:N.call(qe,Te)},Me.prototype.set=function(Te,qe){var ht=this.__data__;return this.size+=this.has(Te)?0:1,ht[Te]=ye&&qe===void 0?"__lodash_hash_undefined__":qe,this},Se.prototype.clear=function(){this.__data__=[],this.size=0},Se.prototype.delete=function(Te){var qe=this.__data__,ht=Re(qe,Te);return!(ht<0)&&(ht==qe.length-1?qe.pop():re.call(qe,ht,1),--this.size,!0)},Se.prototype.get=function(Te){var qe=this.__data__,ht=Re(qe,Te);return ht<0?void 0:qe[ht][1]},Se.prototype.has=function(Te){return Re(this.__data__,Te)>-1},Se.prototype.set=function(Te,qe){var ht=this.__data__,Pt=Re(ht,Te);return Pt<0?(++this.size,ht.push([Te,qe])):ht[Pt][1]=qe,this},$e.prototype.clear=function(){this.size=0,this.__data__={hash:new Me,map:new(ie||Se),string:new Me}},$e.prototype.delete=function(Te){var qe=Ve(this,Te).delete(Te);return this.size-=qe?1:0,qe},$e.prototype.get=function(Te){return Ve(this,Te).get(Te)},$e.prototype.has=function(Te){return Ve(this,Te).has(Te)},$e.prototype.set=function(Te,qe){var ht=Ve(this,Te),Pt=ht.size;return ht.set(Te,qe),this.size+=ht.size==Pt?0:1,this},Ke.prototype.add=Ke.prototype.push=function(Te){return this.__data__.set(Te,"__lodash_hash_undefined__"),this},Ke.prototype.has=function(Te){return this.__data__.has(Te)},Ze.prototype.clear=function(){this.__data__=new Se,this.size=0},Ze.prototype.delete=function(Te){var qe=this.__data__,ht=qe.delete(Te);return this.size=qe.size,ht},Ze.prototype.get=function(Te){return this.__data__.get(Te)},Ze.prototype.has=function(Te){return this.__data__.has(Te)},Ze.prototype.set=function(Te,qe){var ht=this.__data__;if(ht instanceof Se){var Pt=ht.__data__;if(!ie||Pt.length<199)return Pt.push([Te,qe]),this.size=++ht.size,this;ht=this.__data__=new $e(Pt)}return ht.set(Te,qe),this.size=ht.size,this};var xt=J?function(Te){return Te==null?[]:(Te=Object(Te),function(qe,ht){for(var Pt=-1,vt=qe==null?0:qe.length,Dt=0,_r=[];++Pt<vt;){var sr=qe[Pt];ht(sr,Pt,qe)&&(_r[Dt++]=sr)}return _r}(J(Te),function(qe){return Z.call(Te,qe)}))}:function(){return[]},fe=ot;function Ie(Te,qe){return!!(qe=qe??9007199254740991)&&(typeof Te=="number"||h.test(Te))&&Te>-1&&Te%1==0&&Te<qe}function tt(Te){if(Te!=null){try{return E.call(Te)}catch{}try{return Te+""}catch{}}return""}function lt(Te,qe){return Te===qe||Te!=Te&&qe!=qe}(ee&&fe(new ee(new ArrayBuffer(1)))!="[object DataView]"||ie&&fe(new ie)!=c||oe&&fe(oe.resolve())!="[object Promise]"||se&&fe(new se)!=l||le&&fe(new le)!="[object WeakMap]")&&(fe=function(Te){var qe=ot(Te),ht=qe==d?Te.constructor:void 0,Pt=ht?tt(ht):"";if(Pt)switch(Pt){case ue:return"[object DataView]";case ne:return c;case pe:return"[object Promise]";case ge:return l;case Ne:return"[object WeakMap]"}return qe});var It=ut(function(){return arguments}())?ut:function(Te){return rt(Te)&&N.call(Te,"callee")&&!Z.call(Te,"callee")},ct=Array.isArray,at=V||function(){return!1};function gt(Te){if(!St(Te))return!1;var qe=ot(Te);return qe=="[object Function]"||qe=="[object GeneratorFunction]"||qe=="[object AsyncFunction]"||qe=="[object Proxy]"}function Yt(Te){return typeof Te=="number"&&Te>-1&&Te%1==0&&Te<=9007199254740991}function St(Te){var qe=typeof Te;return Te!=null&&(qe=="object"||qe=="function")}function rt(Te){return Te!=null&&typeof Te=="object"}var ir=T?function(Te){return function(qe){return Te(qe)}}(T):function(Te){return rt(Te)&&Yt(Te.length)&&!!f[ot(Te)]};function Ct(Te){return(qe=Te)!=null&&Yt(qe.length)&&!gt(qe)?it(Te):Ce(Te);var qe}s.exports=function(Te,qe){return bt(Te,qe)}}).call(this)}).call(this,typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(r,s,a){(function(i){(function(){var o=typeof i=="object"&&i&&i.Object===Object&&i,c=typeof self=="object"&&self&&self.Object===Object&&self,d=o||c||Function("return this")(),l=Object.prototype,u=l.hasOwnProperty,h=l.toString,f=d.Symbol,m=f?f.toStringTag:void 0;function p(g){return g==null?g===void 0?"[object Undefined]":"[object Null]":m&&m in Object(g)?function(v){var x=u.call(v,m),y=v[m];try{v[m]=void 0;var b=!0}catch{}var j=h.call(v);return b&&(x?v[m]=y:delete v[m]),j}(g):function(v){return h.call(v)}(g)}s.exports=function(g){if(!function(x){var y=typeof x;return x!=null&&(y=="object"||y=="function")}(g))return!1;var v=p(g);return v=="[object Function]"||v=="[object GeneratorFunction]"||v=="[object AsyncFunction]"||v=="[object Proxy]"}}).call(this)}).call(this,typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(r,s,a){s.exports=function(i){return i==null}},{}],448:[function(r,s,a){s.exports=function(i){return i===void 0}},{}],449:[function(r,s,a){(function(i){(function(){var o=/^\[object .+?Constructor\]$/,c=typeof i=="object"&&i&&i.Object===Object&&i,d=typeof self=="object"&&self&&self.Object===Object&&self,l=c||d||Function("return this")();function u($,Y){return!!($&&$.length)&&function(Z,re,G){if(re!=re)return function(W,ee,ie,oe){for(var se=W.length,le=ie+-1;++le<se;)if(ee(W[le],le,W))return le;return-1}(Z,h,G);for(var J=G-1,V=Z.length;++J<V;)if(Z[J]===re)return J;return-1}($,Y,0)>-1}function h($){return $!=$}function f($,Y){return $.has(Y)}function m($){var Y=-1,Z=Array($.size);return $.forEach(function(re){Z[++Y]=re}),Z}var p,g=Array.prototype,v=Function.prototype,x=Object.prototype,y=l["__core-js_shared__"],b=(p=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+p:"",j=v.toString,T=x.hasOwnProperty,O=x.toString,R=RegExp("^"+j.call(T).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),D=g.splice,L=I(l,"Map"),q=I(l,"Set"),X=I(Object,"create");function H($){var Y=-1,Z=$?$.length:0;for(this.clear();++Y<Z;){var re=$[Y];this.set(re[0],re[1])}}function M($){var Y=-1,Z=$?$.length:0;for(this.clear();++Y<Z;){var re=$[Y];this.set(re[0],re[1])}}function F($){var Y=-1,Z=$?$.length:0;for(this.clear();++Y<Z;){var re=$[Y];this.set(re[0],re[1])}}function S($){var Y=-1,Z=$?$.length:0;for(this.__data__=new F;++Y<Z;)this.add($[Y])}function E($,Y){for(var Z,re,G=$.length;G--;)if((Z=$[G][0])===(re=Y)||Z!=Z&&re!=re)return G;return-1}function N($){return!(!U($)||(Y=$,b&&b in Y))&&(function(Z){var re=U(Z)?O.call(Z):"";return re=="[object Function]"||re=="[object GeneratorFunction]"}($)||function(Z){var re=!1;if(Z!=null&&typeof Z.toString!="function")try{re=!!(Z+"")}catch{}return re}($)?R:o).test(function(Z){if(Z!=null){try{return j.call(Z)}catch{}try{return Z+""}catch{}}return""}($));var Y}H.prototype.clear=function(){this.__data__=X?X(null):{}},H.prototype.delete=function($){return this.has($)&&delete this.__data__[$]},H.prototype.get=function($){var Y=this.__data__;if(X){var Z=Y[$];return Z==="__lodash_hash_undefined__"?void 0:Z}return T.call(Y,$)?Y[$]:void 0},H.prototype.has=function($){var Y=this.__data__;return X?Y[$]!==void 0:T.call(Y,$)},H.prototype.set=function($,Y){return this.__data__[$]=X&&Y===void 0?"__lodash_hash_undefined__":Y,this},M.prototype.clear=function(){this.__data__=[]},M.prototype.delete=function($){var Y=this.__data__,Z=E(Y,$);return!(Z<0)&&(Z==Y.length-1?Y.pop():D.call(Y,Z,1),!0)},M.prototype.get=function($){var Y=this.__data__,Z=E(Y,$);return Z<0?void 0:Y[Z][1]},M.prototype.has=function($){return E(this.__data__,$)>-1},M.prototype.set=function($,Y){var Z=this.__data__,re=E(Z,$);return re<0?Z.push([$,Y]):Z[re][1]=Y,this},F.prototype.clear=function(){this.__data__={hash:new H,map:new(L||M),string:new H}},F.prototype.delete=function($){return k(this,$).delete($)},F.prototype.get=function($){return k(this,$).get($)},F.prototype.has=function($){return k(this,$).has($)},F.prototype.set=function($,Y){return k(this,$).set($,Y),this},S.prototype.add=S.prototype.push=function($){return this.__data__.set($,"__lodash_hash_undefined__"),this},S.prototype.has=function($){return this.__data__.has($)};var C=q&&1/m(new q([,-0]))[1]==1/0?function($){return new q($)}:function(){};function k($,Y){var Z,re,G=$.__data__;return((re=typeof(Z=Y))=="string"||re=="number"||re=="symbol"||re=="boolean"?Z!=="__proto__":Z===null)?G[typeof Y=="string"?"string":"hash"]:G.map}function I($,Y){var Z=function(re,G){return re==null?void 0:re[G]}($,Y);return N(Z)?Z:void 0}function U($){var Y=typeof $;return!!$&&(Y=="object"||Y=="function")}s.exports=function($){return $&&$.length?function(Y,Z,re){var G=-1,J=u,V=Y.length,W=!0,ee=[],ie=ee;if(V>=200){var oe=C(Y);if(oe)return m(oe);W=!1,J=f,ie=new S}else ie=ee;e:for(;++G<V;){var se=Y[G],le=se;if(se=se!==0?se:0,W&&le==le){for(var ye=ie.length;ye--;)if(ie[ye]===le)continue e;ee.push(se)}else J(ie,le,re)||(ie!==ee&&ie.push(le),ee.push(se))}return ee}($):[]}}).call(this)}).call(this,typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(r,s,a){var i=r("inherits"),o=r("hash-base"),c=r("safe-buffer").Buffer,d=new Array(16);function l(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function u(g,v){return g<<v|g>>>32-v}function h(g,v,x,y,b,j,T){return u(g+(v&x|~v&y)+b+j|0,T)+v|0}function f(g,v,x,y,b,j,T){return u(g+(v&y|x&~y)+b+j|0,T)+v|0}function m(g,v,x,y,b,j,T){return u(g+(v^x^y)+b+j|0,T)+v|0}function p(g,v,x,y,b,j,T){return u(g+(x^(v|~y))+b+j|0,T)+v|0}i(l,o),l.prototype._update=function(){for(var g=d,v=0;v<16;++v)g[v]=this._block.readInt32LE(4*v);var x=this._a,y=this._b,b=this._c,j=this._d;x=h(x,y,b,j,g[0],3614090360,7),j=h(j,x,y,b,g[1],3905402710,12),b=h(b,j,x,y,g[2],606105819,17),y=h(y,b,j,x,g[3],3250441966,22),x=h(x,y,b,j,g[4],4118548399,7),j=h(j,x,y,b,g[5],1200080426,12),b=h(b,j,x,y,g[6],2821735955,17),y=h(y,b,j,x,g[7],4249261313,22),x=h(x,y,b,j,g[8],1770035416,7),j=h(j,x,y,b,g[9],2336552879,12),b=h(b,j,x,y,g[10],4294925233,17),y=h(y,b,j,x,g[11],2304563134,22),x=h(x,y,b,j,g[12],1804603682,7),j=h(j,x,y,b,g[13],4254626195,12),b=h(b,j,x,y,g[14],2792965006,17),x=f(x,y=h(y,b,j,x,g[15],1236535329,22),b,j,g[1],4129170786,5),j=f(j,x,y,b,g[6],3225465664,9),b=f(b,j,x,y,g[11],643717713,14),y=f(y,b,j,x,g[0],3921069994,20),x=f(x,y,b,j,g[5],3593408605,5),j=f(j,x,y,b,g[10],38016083,9),b=f(b,j,x,y,g[15],3634488961,14),y=f(y,b,j,x,g[4],3889429448,20),x=f(x,y,b,j,g[9],568446438,5),j=f(j,x,y,b,g[14],3275163606,9),b=f(b,j,x,y,g[3],4107603335,14),y=f(y,b,j,x,g[8],1163531501,20),x=f(x,y,b,j,g[13],2850285829,5),j=f(j,x,y,b,g[2],4243563512,9),b=f(b,j,x,y,g[7],1735328473,14),x=m(x,y=f(y,b,j,x,g[12],2368359562,20),b,j,g[5],4294588738,4),j=m(j,x,y,b,g[8],2272392833,11),b=m(b,j,x,y,g[11],1839030562,16),y=m(y,b,j,x,g[14],4259657740,23),x=m(x,y,b,j,g[1],2763975236,4),j=m(j,x,y,b,g[4],1272893353,11),b=m(b,j,x,y,g[7],4139469664,16),y=m(y,b,j,x,g[10],3200236656,23),x=m(x,y,b,j,g[13],681279174,4),j=m(j,x,y,b,g[0],3936430074,11),b=m(b,j,x,y,g[3],3572445317,16),y=m(y,b,j,x,g[6],76029189,23),x=m(x,y,b,j,g[9],3654602809,4),j=m(j,x,y,b,g[12],3873151461,11),b=m(b,j,x,y,g[15],530742520,16),x=p(x,y=m(y,b,j,x,g[2],3299628645,23),b,j,g[0],4096336452,6),j=p(j,x,y,b,g[7],1126891415,10),b=p(b,j,x,y,g[14],2878612391,15),y=p(y,b,j,x,g[5],4237533241,21),x=p(x,y,b,j,g[12],1700485571,6),j=p(j,x,y,b,g[3],2399980690,10),b=p(b,j,x,y,g[10],4293915773,15),y=p(y,b,j,x,g[1],2240044497,21),x=p(x,y,b,j,g[8],1873313359,6),j=p(j,x,y,b,g[15],4264355552,10),b=p(b,j,x,y,g[6],2734768916,15),y=p(y,b,j,x,g[13],1309151649,21),x=p(x,y,b,j,g[4],4149444226,6),j=p(j,x,y,b,g[11],3174756917,10),b=p(b,j,x,y,g[2],718787259,15),y=p(y,b,j,x,g[9],3951481745,21),this._a=this._a+x|0,this._b=this._b+y|0,this._c=this._c+b|0,this._d=this._d+j|0},l.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var g=c.allocUnsafe(16);return g.writeInt32LE(this._a,0),g.writeInt32LE(this._b,4),g.writeInt32LE(this._c,8),g.writeInt32LE(this._d,12),g},s.exports=l},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(r,s,a){var i=r("bn.js"),o=r("brorand");function c(d){this.rand=d||new o.Rand}s.exports=c,c.create=function(d){return new c(d)},c.prototype._randbelow=function(d){var l=d.bitLength(),u=Math.ceil(l/8);do var h=new i(this.rand.generate(u));while(h.cmp(d)>=0);return h},c.prototype._randrange=function(d,l){var u=l.sub(d);return d.add(this._randbelow(u))},c.prototype.test=function(d,l,u){var h=d.bitLength(),f=i.mont(d),m=new i(1).toRed(f);l||(l=Math.max(1,h/48|0));for(var p=d.subn(1),g=0;!p.testn(g);g++);for(var v=d.shrn(g),x=p.toRed(f);l>0;l--){var y=this._randrange(new i(2),p);u&&u(y);var b=y.toRed(f).redPow(v);if(b.cmp(m)!==0&&b.cmp(x)!==0){for(var j=1;j<g;j++){if((b=b.redSqr()).cmp(m)===0)return!1;if(b.cmp(x)===0)break}if(j===g)return!1}}return!0},c.prototype.getDivisor=function(d,l){var u=d.bitLength(),h=i.mont(d),f=new i(1).toRed(h);l||(l=Math.max(1,u/48|0));for(var m=d.subn(1),p=0;!m.testn(p);p++);for(var g=d.shrn(p),v=m.toRed(h);l>0;l--){var x=this._randrange(new i(2),m),y=d.gcd(x);if(y.cmpn(1)!==0)return y;var b=x.toRed(h).redPow(g);if(b.cmp(f)!==0&&b.cmp(v)!==0){for(var j=1;j<p;j++){if((b=b.redSqr()).cmp(f)===0)return b.fromRed().subn(1).gcd(d);if(b.cmp(v)===0)break}if(j===p)return(b=b.redSqr()).fromRed().subn(1).gcd(d)}}return!1}},{"bn.js":452,brorand:187}],452:[function(r,s,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],453:[function(r,s,a){function i(o,c){if(!o)throw new Error(c||"Assertion failed")}s.exports=i,i.equal=function(o,c,d){if(o!=c)throw new Error(d||"Assertion failed: "+o+" != "+c)}},{}],454:[function(r,s,a){var i=a;function o(d){return d.length===1?"0"+d:d}function c(d){for(var l="",u=0;u<d.length;u++)l+=o(d[u].toString(16));return l}i.toArray=function(d,l){if(Array.isArray(d))return d.slice();if(!d)return[];var u=[];if(typeof d!="string"){for(var h=0;h<d.length;h++)u[h]=0|d[h];return u}if(l==="hex")for((d=d.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(d="0"+d),h=0;h<d.length;h+=2)u.push(parseInt(d[h]+d[h+1],16));else for(h=0;h<d.length;h++){var f=d.charCodeAt(h),m=f>>8,p=255&f;m?u.push(m,p):u.push(p)}return u},i.zero2=o,i.toHex=c,i.encode=function(d,l){return l==="hex"?c(d):d}},{}],455:[function(r,s,a){s.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(r,s,a){var i=r("asn1.js");a.certificate=r("./certificate");var o=i.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});a.RSAPrivateKey=o;var c=i.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});a.RSAPublicKey=c;var d=i.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(l),this.key("subjectPublicKey").bitstr())});a.PublicKey=d;var l=i.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),u=i.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(l),this.key("subjectPrivateKey").octstr())});a.PrivateKey=u;var h=i.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});a.EncryptedPrivateKey=h;var f=i.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});a.DSAPrivateKey=f,a.DSAparam=i.define("DSAparam",function(){this.int()});var m=i.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(p),this.key("publicKey").optional().explicit(1).bitstr())});a.ECPrivateKey=m;var p=i.define("ECParameters",function(){this.choice({namedCurve:this.objid()})});a.signature=i.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})},{"./certificate":457,"asn1.js":170}],457:[function(r,s,a){var i=r("asn1.js"),o=i.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),c=i.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),d=i.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),l=i.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(d),this.key("subjectPublicKey").bitstr())}),u=i.define("RelativeDistinguishedName",function(){this.setof(c)}),h=i.define("RDNSequence",function(){this.seqof(u)}),f=i.define("Name",function(){this.choice({rdnSequence:this.use(h)})}),m=i.define("Validity",function(){this.seq().obj(this.key("notBefore").use(o),this.key("notAfter").use(o))}),p=i.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),g=i.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(d),this.key("issuer").use(f),this.key("validity").use(m),this.key("subject").use(f),this.key("subjectPublicKeyInfo").use(l),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(p).optional())}),v=i.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(g),this.key("signatureAlgorithm").use(d),this.key("signatureValue").bitstr())});s.exports=v},{"asn1.js":170}],458:[function(r,s,a){var i=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,o=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,c=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,d=r("evp_bytestokey"),l=r("browserify-aes"),u=r("safe-buffer").Buffer;s.exports=function(h,f){var m,p=h.toString(),g=p.match(i);if(g){var v="aes"+g[1],x=u.from(g[2],"hex"),y=u.from(g[3].replace(/[\r\n]/g,""),"base64"),b=d(f,x.slice(0,8),parseInt(g[1],10)).key,j=[],T=l.createDecipheriv(v,b,x);j.push(T.update(y)),j.push(T.final()),m=u.concat(j)}else{var O=p.match(c);m=u.from(O[2].replace(/[\r\n]/g,""),"base64")}return{tag:p.match(o)[1],data:m}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(r,s,a){var i=r("./asn1"),o=r("./aesid.json"),c=r("./fixProc"),d=r("browserify-aes"),l=r("pbkdf2"),u=r("safe-buffer").Buffer;function h(f){var m;typeof f!="object"||u.isBuffer(f)||(m=f.passphrase,f=f.key),typeof f=="string"&&(f=u.from(f));var p,g,v=c(f,m),x=v.tag,y=v.data;switch(x){case"CERTIFICATE":g=i.certificate.decode(y,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(g||(g=i.PublicKey.decode(y,"der")),p=g.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPublicKey.decode(g.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return g.subjectPrivateKey=g.subjectPublicKey,{type:"ec",data:g};case"1.2.840.10040.4.1":return g.algorithm.params.pub_key=i.DSAparam.decode(g.subjectPublicKey.data,"der"),{type:"dsa",data:g.algorithm.params};default:throw new Error("unknown key id "+p)}case"ENCRYPTED PRIVATE KEY":y=function(b,j){var T=b.algorithm.decrypt.kde.kdeparams.salt,O=parseInt(b.algorithm.decrypt.kde.kdeparams.iters.toString(),10),R=o[b.algorithm.decrypt.cipher.algo.join(".")],D=b.algorithm.decrypt.cipher.iv,L=b.subjectPrivateKey,q=parseInt(R.split("-")[1],10)/8,X=l.pbkdf2Sync(j,T,O,q,"sha1"),H=d.createDecipheriv(R,X,D),M=[];return M.push(H.update(L)),M.push(H.final()),u.concat(M)}(y=i.EncryptedPrivateKey.decode(y,"der"),m);case"PRIVATE KEY":switch(p=(g=i.PrivateKey.decode(y,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return i.RSAPrivateKey.decode(g.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:g.algorithm.curve,privateKey:i.ECPrivateKey.decode(g.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return g.algorithm.params.priv_key=i.DSAparam.decode(g.subjectPrivateKey,"der"),{type:"dsa",params:g.algorithm.params};default:throw new Error("unknown key id "+p)}case"RSA PUBLIC KEY":return i.RSAPublicKey.decode(y,"der");case"RSA PRIVATE KEY":return i.RSAPrivateKey.decode(y,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:i.DSAPrivateKey.decode(y,"der")};case"EC PRIVATE KEY":return{curve:(y=i.ECPrivateKey.decode(y,"der")).parameters.value,privateKey:y.privateKey};default:throw new Error("unknown key type "+x)}}s.exports=h,h.signature=i.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(r,s,a){a.pbkdf2=r("./lib/async"),a.pbkdf2Sync=r("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(r,s,a){(function(i){(function(){var o,c,d=r("safe-buffer").Buffer,l=r("./precondition"),u=r("./default-encoding"),h=r("./sync"),f=r("./to-buffer"),m=i.crypto&&i.crypto.subtle,p={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},g=[];function v(){return c||(c=i.process&&i.process.nextTick?i.process.nextTick:i.queueMicrotask?i.queueMicrotask:i.setImmediate?i.setImmediate:i.setTimeout)}function x(y,b,j,T,O){return m.importKey("raw",y,{name:"PBKDF2"},!1,["deriveBits"]).then(function(R){return m.deriveBits({name:"PBKDF2",salt:b,iterations:j,hash:{name:O}},R,T<<3)}).then(function(R){return d.from(R)})}s.exports=function(y,b,j,T,O,R){typeof O=="function"&&(R=O,O=void 0);var D=p[(O=O||"sha1").toLowerCase()];if(D&&typeof i.Promise=="function"){if(l(j,T),y=f(y,u,"Password"),b=f(b,u,"Salt"),typeof R!="function")throw new Error("No callback provided to pbkdf2");(function(L,q){L.then(function(X){v()(function(){q(null,X)})},function(X){v()(function(){q(X)})})})(function(L){if(i.process&&!i.process.browser||!m||!m.importKey||!m.deriveBits)return Promise.resolve(!1);if(g[L]!==void 0)return g[L];var q=x(o=o||d.alloc(8),o,10,128,L).then(function(){return!0}).catch(function(){return!1});return g[L]=q,q}(D).then(function(L){return L?x(y,b,j,T,D):h(y,b,j,T,O)}),R)}else v()(function(){var L;try{L=h(y,b,j,T,O)}catch(q){return R(q)}R(null,L)})}}).call(this)}).call(this,typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(r,s,a){(function(i,o){(function(){var c;o.process&&o.process.browser?c="utf-8":o.process&&o.process.version?c=parseInt(i.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":c="utf-8",s.exports=c}).call(this)}).call(this,r("_process"),typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(r,s,a){var i=Math.pow(2,30)-1;s.exports=function(o,c){if(typeof o!="number")throw new TypeError("Iterations not a number");if(o<0)throw new TypeError("Bad iterations");if(typeof c!="number")throw new TypeError("Key length not a number");if(c<0||c>i||c!=c)throw new TypeError("Bad key length")}},{}],464:[function(r,s,a){var i=r("create-hash/md5"),o=r("ripemd160"),c=r("sha.js"),d=r("safe-buffer").Buffer,l=r("./precondition"),u=r("./default-encoding"),h=r("./to-buffer"),f=d.alloc(128),m={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function p(g,v,x){var y=function(D){function L(q){return c(D).update(q).digest()}return D==="rmd160"||D==="ripemd160"?function(q){return new o().update(q).digest()}:D==="md5"?i:L}(g),b=g==="sha512"||g==="sha384"?128:64;v.length>b?v=y(v):v.length<b&&(v=d.concat([v,f],b));for(var j=d.allocUnsafe(b+m[g]),T=d.allocUnsafe(b+m[g]),O=0;O<b;O++)j[O]=54^v[O],T[O]=92^v[O];var R=d.allocUnsafe(b+x+4);j.copy(R,0,0,b),this.ipad1=R,this.ipad2=j,this.opad=T,this.alg=g,this.blocksize=b,this.hash=y,this.size=m[g]}p.prototype.run=function(g,v){return g.copy(v,this.blocksize),this.hash(v).copy(this.opad,this.blocksize),this.hash(this.opad)},s.exports=function(g,v,x,y,b){l(x,y);var j=new p(b=b||"sha1",g=h(g,u,"Password"),(v=h(v,u,"Salt")).length),T=d.allocUnsafe(y),O=d.allocUnsafe(v.length+4);v.copy(O,0,0,v.length);for(var R=0,D=m[b],L=Math.ceil(y/D),q=1;q<=L;q++){O.writeUInt32BE(q,v.length);for(var X=j.run(O,j.ipad1),H=X,M=1;M<x;M++){H=j.run(H,j.ipad2);for(var F=0;F<D;F++)X[F]^=H[F]}X.copy(T,R),R+=D}return T}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(r,s,a){var i=r("safe-buffer").Buffer;s.exports=function(o,c,d){if(i.isBuffer(o))return o;if(typeof o=="string")return i.from(o,c);if(ArrayBuffer.isView(o))return i.from(o.buffer);throw new TypeError(d+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(r,s,a){(function(i){(function(){i===void 0||!i.version||i.version.indexOf("v0.")===0||i.version.indexOf("v1.")===0&&i.version.indexOf("v1.8.")!==0?s.exports={nextTick:function(o,c,d,l){if(typeof o!="function")throw new TypeError('"callback" argument must be a function');var u,h,f=arguments.length;switch(f){case 0:case 1:return i.nextTick(o);case 2:return i.nextTick(function(){o.call(null,c)});case 3:return i.nextTick(function(){o.call(null,c,d)});case 4:return i.nextTick(function(){o.call(null,c,d,l)});default:for(u=new Array(f-1),h=0;h<u.length;)u[h++]=arguments[h];return i.nextTick(function(){o.apply(null,u)})}}}:s.exports=i}).call(this)}).call(this,r("_process"))},{_process:467}],467:[function(r,s,a){var i,o,c=s.exports={};function d(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function u(b){if(i===setTimeout)return setTimeout(b,0);if((i===d||!i)&&setTimeout)return i=setTimeout,setTimeout(b,0);try{return i(b,0)}catch{try{return i.call(null,b,0)}catch{return i.call(this,b,0)}}}(function(){try{i=typeof setTimeout=="function"?setTimeout:d}catch{i=d}try{o=typeof clearTimeout=="function"?clearTimeout:l}catch{o=l}})();var h,f=[],m=!1,p=-1;function g(){m&&h&&(m=!1,h.length?f=h.concat(f):p=-1,f.length&&v())}function v(){if(!m){var b=u(g);m=!0;for(var j=f.length;j;){for(h=f,f=[];++p<j;)h&&h[p].run();p=-1,j=f.length}h=null,m=!1,function(T){if(o===clearTimeout)return clearTimeout(T);if((o===l||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(T);try{o(T)}catch{try{return o.call(null,T)}catch{return o.call(this,T)}}}(b)}}function x(b,j){this.fun=b,this.array=j}function y(){}c.nextTick=function(b){var j=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)j[T-1]=arguments[T];f.push(new x(b,j)),f.length!==1||m||u(v)},x.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=y,c.addListener=y,c.once=y,c.off=y,c.removeListener=y,c.removeAllListeners=y,c.emit=y,c.prependListener=y,c.prependOnceListener=y,c.listeners=function(b){return[]},c.binding=function(b){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(b){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}},{}],468:[function(r,s,a){a.publicEncrypt=r("./publicEncrypt"),a.privateDecrypt=r("./privateDecrypt"),a.privateEncrypt=function(i,o){return a.publicEncrypt(i,o,!0)},a.publicDecrypt=function(i,o){return a.privateDecrypt(i,o,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(r,s,a){var i=r("create-hash"),o=r("safe-buffer").Buffer;function c(d){var l=o.allocUnsafe(4);return l.writeUInt32BE(d,0),l}s.exports=function(d,l){for(var u,h=o.alloc(0),f=0;h.length<l;)u=c(f++),h=o.concat([h,i("sha1").update(d).update(u).digest()]);return h.slice(0,l)}},{"create-hash":386,"safe-buffer":494}],470:[function(r,s,a){arguments[4][184][0].apply(a,arguments)},{buffer:188,dup:184}],471:[function(r,s,a){var i=r("parse-asn1"),o=r("./mgf"),c=r("./xor"),d=r("bn.js"),l=r("browserify-rsa"),u=r("create-hash"),h=r("./withPublic"),f=r("safe-buffer").Buffer;s.exports=function(m,p,g){var v;v=m.padding?m.padding:g?1:4;var x,y=i(m),b=y.modulus.byteLength();if(p.length>b||new d(p).cmp(y.modulus)>=0)throw new Error("decryption error");x=g?h(new d(p),y):l(p,y);var j=f.alloc(b-x.length);if(x=f.concat([j,x],b),v===4)return function(T,O){var R=T.modulus.byteLength(),D=u("sha1").update(f.alloc(0)).digest(),L=D.length;if(O[0]!==0)throw new Error("decryption error");var q=O.slice(1,L+1),X=O.slice(L+1),H=c(q,o(X,L)),M=c(X,o(H,R-L-1));if(function(S,E){S=f.from(S),E=f.from(E);var N=0,C=S.length;S.length!==E.length&&(N++,C=Math.min(S.length,E.length));for(var k=-1;++k<C;)N+=S[k]^E[k];return N}(D,M.slice(0,L)))throw new Error("decryption error");for(var F=L;M[F]===0;)F++;if(M[F++]!==1)throw new Error("decryption error");return M.slice(F)}(y,x);if(v===1)return function(T,O,R){for(var D=O.slice(0,2),L=2,q=0;O[L++]!==0;)if(L>=O.length){q++;break}var X=O.slice(2,L-1);if((D.toString("hex")!=="0002"&&!R||D.toString("hex")!=="0001"&&R)&&q++,X.length<8&&q++,q)throw new Error("decryption error");return O.slice(L)}(0,x,g);if(v===3)return x;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(r,s,a){var i=r("parse-asn1"),o=r("randombytes"),c=r("create-hash"),d=r("./mgf"),l=r("./xor"),u=r("bn.js"),h=r("./withPublic"),f=r("browserify-rsa"),m=r("safe-buffer").Buffer;s.exports=function(p,g,v){var x;x=p.padding?p.padding:v?1:4;var y,b=i(p);if(x===4)y=function(j,T){var O=j.modulus.byteLength(),R=T.length,D=c("sha1").update(m.alloc(0)).digest(),L=D.length,q=2*L;if(R>O-q-2)throw new Error("message too long");var X=m.alloc(O-R-q-2),H=O-L-1,M=o(L),F=l(m.concat([D,X,m.alloc(1,1),T],H),d(M,H)),S=l(M,d(F,L));return new u(m.concat([m.alloc(1),S,F],O))}(b,g);else if(x===1)y=function(j,T,O){var R,D=T.length,L=j.modulus.byteLength();if(D>L-11)throw new Error("message too long");return R=O?m.alloc(L-D-3,255):function(q){for(var X,H=m.allocUnsafe(q),M=0,F=o(2*q),S=0;M<q;)S===F.length&&(F=o(2*q),S=0),(X=F[S++])&&(H[M++]=X);return H}(L-D-3),new u(m.concat([m.from([0,O?1:2]),R,m.alloc(1),T],L))}(b,g,v);else{if(x!==3)throw new Error("unknown padding");if((y=new u(g)).cmp(b.modulus)>=0)throw new Error("data too long for modulus")}return v?f(y,b):h(y,b)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(r,s,a){var i=r("bn.js"),o=r("safe-buffer").Buffer;s.exports=function(c,d){return o.from(c.toRed(i.mont(d.modulus)).redPow(new i(d.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(r,s,a){s.exports=function(i,o){for(var c=i.length,d=-1;++d<c;)i[d]^=o[d];return i}},{}],475:[function(r,s,a){(function(i,o){(function(){var c=r("safe-buffer").Buffer,d=o.crypto||o.msCrypto;d&&d.getRandomValues?s.exports=function(l,u){if(l>4294967295)throw new RangeError("requested too many random bytes");var h=c.allocUnsafe(l);if(l>0)if(l>65536)for(var f=0;f<l;f+=65536)d.getRandomValues(h.slice(f,f+65536));else d.getRandomValues(h);return typeof u=="function"?i.nextTick(function(){u(null,h)}):h}:s.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,r("_process"),typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(r,s,a){(function(i,o){(function(){function c(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var d=r("safe-buffer"),l=r("randombytes"),u=d.Buffer,h=d.kMaxLength,f=o.crypto||o.msCrypto,m=Math.pow(2,32)-1;function p(x,y){if(typeof x!="number"||x!=x)throw new TypeError("offset must be a number");if(x>m||x<0)throw new TypeError("offset must be a uint32");if(x>h||x>y)throw new RangeError("offset out of range")}function g(x,y,b){if(typeof x!="number"||x!=x)throw new TypeError("size must be a number");if(x>m||x<0)throw new TypeError("size must be a uint32");if(x+y>b||x>h)throw new RangeError("buffer too small")}function v(x,y,b,j){if(i.browser){var T=x.buffer,O=new Uint8Array(T,y,b);return f.getRandomValues(O),j?void i.nextTick(function(){j(null,x)}):x}if(!j)return l(b).copy(x,y),x;l(b,function(R,D){if(R)return j(R);D.copy(x,y),j(null,x)})}f&&f.getRandomValues||!i.browser?(a.randomFill=function(x,y,b,j){if(!(u.isBuffer(x)||x instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof y=="function")j=y,y=0,b=x.length;else if(typeof b=="function")j=b,b=x.length-y;else if(typeof j!="function")throw new TypeError('"cb" argument must be a function');return p(y,x.length),g(b,y,x.length),v(x,y,b,j)},a.randomFillSync=function(x,y,b){if(y===void 0&&(y=0),!(u.isBuffer(x)||x instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return p(y,x.length),b===void 0&&(b=x.length-y),g(b,y,x.length),v(x,y,b)}):(a.randomFill=c,a.randomFillSync=c)}).call(this)}).call(this,r("_process"),typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(r,s,a){var i={};function o(d,l,u){u||(u=Error);var h=function(f){var m,p;function g(v,x,y){return f.call(this,function(b,j,T){return typeof l=="string"?l:l(b,j,T)}(v,x,y))||this}return p=f,(m=g).prototype=Object.create(p.prototype),m.prototype.constructor=m,m.__proto__=p,g}(u);h.prototype.name=u.name,h.prototype.code=d,i[d]=h}function c(d,l){if(Array.isArray(d)){var u=d.length;return d=d.map(function(h){return String(h)}),u>2?"one of ".concat(l," ").concat(d.slice(0,u-1).join(", "),", or ")+d[u-1]:u===2?"one of ".concat(l," ").concat(d[0]," or ").concat(d[1]):"of ".concat(l," ").concat(d[0])}return"of ".concat(l," ").concat(String(d))}o("ERR_INVALID_OPT_VALUE",function(d,l){return'The value "'+l+'" is invalid for option "'+d+'"'},TypeError),o("ERR_INVALID_ARG_TYPE",function(d,l,u){var h,f,m;if(typeof l=="string"&&(f="not ",l.substr(0,f.length)===f)?(h="must not be",l=l.replace(/^not /,"")):h="must be",function(g,v,x){return(x===void 0||x>g.length)&&(x=g.length),g.substring(x-v.length,x)===v}(d," argument"))m="The ".concat(d," ").concat(h," ").concat(c(l,"type"));else{var p=function(g,v,x){return typeof x!="number"&&(x=0),!(x+v.length>g.length)&&g.indexOf(v,x)!==-1}(d,".")?"property":"argument";m='The "'.concat(d,'" ').concat(p," ").concat(h," ").concat(c(l,"type"))}return m+=". Received type ".concat(typeof u)},TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",function(d){return"The "+d+" method is not implemented"}),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",function(d){return"Cannot call "+d+" after a stream was destroyed"}),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",function(d){return"Unknown encoding: "+d},TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),s.exports.codes=i},{}],478:[function(r,s,a){(function(i){(function(){var o=Object.keys||function(g){var v=[];for(var x in g)v.push(x);return v};s.exports=f;var c=r("./_stream_readable"),d=r("./_stream_writable");r("inherits")(f,c);for(var l=o(d.prototype),u=0;u<l.length;u++){var h=l[u];f.prototype[h]||(f.prototype[h]=d.prototype[h])}function f(g){if(!(this instanceof f))return new f(g);c.call(this,g),d.call(this,g),this.allowHalfOpen=!0,g&&(g.readable===!1&&(this.readable=!1),g.writable===!1&&(this.writable=!1),g.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",m)))}function m(){this._writableState.ended||i.nextTick(p,this)}function p(g){g.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(f.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(f.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}})}).call(this)}).call(this,r("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(r,s,a){s.exports=o;var i=r("./_stream_transform");function o(c){if(!(this instanceof o))return new o(c);i.call(this,c)}r("inherits")(o,i),o.prototype._transform=function(c,d,l){l(null,c)}},{"./_stream_transform":481,inherits:440}],480:[function(r,s,a){(function(i,o){(function(){var c;s.exports=H,H.ReadableState=X,r("events").EventEmitter;var d=function(V,W){return V.listeners(W).length},l=r("./internal/streams/stream"),u=r("buffer").Buffer,h=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},f,m=r("util");f=m&&m.debuglog?m.debuglog("stream"):function(){};var p,g,v,x=r("./internal/streams/buffer_list"),y=r("./internal/streams/destroy"),b=r("./internal/streams/state").getHighWaterMark,j=r("../errors").codes,T=j.ERR_INVALID_ARG_TYPE,O=j.ERR_STREAM_PUSH_AFTER_EOF,R=j.ERR_METHOD_NOT_IMPLEMENTED,D=j.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r("inherits")(H,l);var L=y.errorOrDestroy,q=["error","close","destroy","pause","resume"];function X(V,W,ee){c=c||r("./_stream_duplex"),V=V||{},typeof ee!="boolean"&&(ee=W instanceof c),this.objectMode=!!V.objectMode,ee&&(this.objectMode=this.objectMode||!!V.readableObjectMode),this.highWaterMark=b(this,V,"readableHighWaterMark",ee),this.buffer=new x,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=V.emitClose!==!1,this.autoDestroy=!!V.autoDestroy,this.destroyed=!1,this.defaultEncoding=V.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,V.encoding&&(p||(p=r("string_decoder/").StringDecoder),this.decoder=new p(V.encoding),this.encoding=V.encoding)}function H(V){if(c=c||r("./_stream_duplex"),!(this instanceof H))return new H(V);var W=this instanceof c;this._readableState=new X(V,this,W),this.readable=!0,V&&(typeof V.read=="function"&&(this._read=V.read),typeof V.destroy=="function"&&(this._destroy=V.destroy)),l.call(this)}function M(V,W,ee,ie,oe){f("readableAddChunk",W);var se,le=V._readableState;if(W===null)le.reading=!1,function(ye,ue){if(f("onEofChunk"),!ue.ended){if(ue.decoder){var ne=ue.decoder.end();ne&&ne.length&&(ue.buffer.push(ne),ue.length+=ue.objectMode?1:ne.length)}ue.ended=!0,ue.sync?E(ye):(ue.needReadable=!1,ue.emittedReadable||(ue.emittedReadable=!0,N(ye)))}}(V,le);else if(oe||(se=function(ye,ue){var ne;pe=ue,u.isBuffer(pe)||pe instanceof h||typeof ue=="string"||ue===void 0||ye.objectMode||(ne=new T("chunk",["string","Buffer","Uint8Array"],ue));var pe;return ne}(le,W)),se)L(V,se);else if(le.objectMode||W&&W.length>0)if(typeof W=="string"||le.objectMode||Object.getPrototypeOf(W)===u.prototype||(W=function(ye){return u.from(ye)}(W)),ie)le.endEmitted?L(V,new D):F(V,le,W,!0);else if(le.ended)L(V,new O);else{if(le.destroyed)return!1;le.reading=!1,le.decoder&&!ee?(W=le.decoder.write(W),le.objectMode||W.length!==0?F(V,le,W,!1):C(V,le)):F(V,le,W,!1)}else ie||(le.reading=!1,C(V,le));return!le.ended&&(le.length<le.highWaterMark||le.length===0)}function F(V,W,ee,ie){W.flowing&&W.length===0&&!W.sync?(W.awaitDrain=0,V.emit("data",ee)):(W.length+=W.objectMode?1:ee.length,ie?W.buffer.unshift(ee):W.buffer.push(ee),W.needReadable&&E(V)),C(V,W)}Object.defineProperty(H.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(V){this._readableState&&(this._readableState.destroyed=V)}}),H.prototype.destroy=y.destroy,H.prototype._undestroy=y.undestroy,H.prototype._destroy=function(V,W){W(V)},H.prototype.push=function(V,W){var ee,ie=this._readableState;return ie.objectMode?ee=!0:typeof V=="string"&&((W=W||ie.defaultEncoding)!==ie.encoding&&(V=u.from(V,W),W=""),ee=!0),M(this,V,W,!1,ee)},H.prototype.unshift=function(V){return M(this,V,null,!0,!1)},H.prototype.isPaused=function(){return this._readableState.flowing===!1},H.prototype.setEncoding=function(V){p||(p=r("string_decoder/").StringDecoder);var W=new p(V);this._readableState.decoder=W,this._readableState.encoding=this._readableState.decoder.encoding;for(var ee=this._readableState.buffer.head,ie="";ee!==null;)ie+=W.write(ee.data),ee=ee.next;return this._readableState.buffer.clear(),ie!==""&&this._readableState.buffer.push(ie),this._readableState.length=ie.length,this};function S(V,W){return V<=0||W.length===0&&W.ended?0:W.objectMode?1:V!=V?W.flowing&&W.length?W.buffer.head.data.length:W.length:(V>W.highWaterMark&&(W.highWaterMark=function(ee){return ee>=1073741824?ee=1073741824:(ee--,ee|=ee>>>1,ee|=ee>>>2,ee|=ee>>>4,ee|=ee>>>8,ee|=ee>>>16,ee++),ee}(V)),V<=W.length?V:W.ended?W.length:(W.needReadable=!0,0))}function E(V){var W=V._readableState;f("emitReadable",W.needReadable,W.emittedReadable),W.needReadable=!1,W.emittedReadable||(f("emitReadable",W.flowing),W.emittedReadable=!0,i.nextTick(N,V))}function N(V){var W=V._readableState;f("emitReadable_",W.destroyed,W.length,W.ended),W.destroyed||!W.length&&!W.ended||(V.emit("readable"),W.emittedReadable=!1),W.needReadable=!W.flowing&&!W.ended&&W.length<=W.highWaterMark,Y(V)}function C(V,W){W.readingMore||(W.readingMore=!0,i.nextTick(k,V,W))}function k(V,W){for(;!W.reading&&!W.ended&&(W.length<W.highWaterMark||W.flowing&&W.length===0);){var ee=W.length;if(f("maybeReadMore read 0"),V.read(0),ee===W.length)break}W.readingMore=!1}function I(V){var W=V._readableState;W.readableListening=V.listenerCount("readable")>0,W.resumeScheduled&&!W.paused?W.flowing=!0:V.listenerCount("data")>0&&V.resume()}function U(V){f("readable nexttick read 0"),V.read(0)}function $(V,W){f("resume",W.reading),W.reading||V.read(0),W.resumeScheduled=!1,V.emit("resume"),Y(V),W.flowing&&!W.reading&&V.read(0)}function Y(V){var W=V._readableState;for(f("flow",W.flowing);W.flowing&&V.read()!==null;);}function Z(V,W){return W.length===0?null:(W.objectMode?ee=W.buffer.shift():!V||V>=W.length?(ee=W.decoder?W.buffer.join(""):W.buffer.length===1?W.buffer.first():W.buffer.concat(W.length),W.buffer.clear()):ee=W.buffer.consume(V,W.decoder),ee);var ee}function re(V){var W=V._readableState;f("endReadable",W.endEmitted),W.endEmitted||(W.ended=!0,i.nextTick(G,W,V))}function G(V,W){if(f("endReadableNT",V.endEmitted,V.length),!V.endEmitted&&V.length===0&&(V.endEmitted=!0,W.readable=!1,W.emit("end"),V.autoDestroy)){var ee=W._writableState;(!ee||ee.autoDestroy&&ee.finished)&&W.destroy()}}function J(V,W){for(var ee=0,ie=V.length;ee<ie;ee++)if(V[ee]===W)return ee;return-1}H.prototype.read=function(V){f("read",V),V=parseInt(V,10);var W=this._readableState,ee=V;if(V!==0&&(W.emittedReadable=!1),V===0&&W.needReadable&&((W.highWaterMark!==0?W.length>=W.highWaterMark:W.length>0)||W.ended))return f("read: emitReadable",W.length,W.ended),W.length===0&&W.ended?re(this):E(this),null;if((V=S(V,W))===0&&W.ended)return W.length===0&&re(this),null;var ie,oe=W.needReadable;return f("need readable",oe),(W.length===0||W.length-V<W.highWaterMark)&&f("length less than watermark",oe=!0),W.ended||W.reading?f("reading or ended",oe=!1):oe&&(f("do read"),W.reading=!0,W.sync=!0,W.length===0&&(W.needReadable=!0),this._read(W.highWaterMark),W.sync=!1,W.reading||(V=S(ee,W))),(ie=V>0?Z(V,W):null)===null?(W.needReadable=W.length<=W.highWaterMark,V=0):(W.length-=V,W.awaitDrain=0),W.length===0&&(W.ended||(W.needReadable=!0),ee!==V&&W.ended&&re(this)),ie!==null&&this.emit("data",ie),ie},H.prototype._read=function(V){L(this,new R("_read()"))},H.prototype.pipe=function(V,W){var ee=this,ie=this._readableState;switch(ie.pipesCount){case 0:ie.pipes=V;break;case 1:ie.pipes=[ie.pipes,V];break;default:ie.pipes.push(V)}ie.pipesCount+=1,f("pipe count=%d opts=%j",ie.pipesCount,W);var oe=(!W||W.end!==!1)&&V!==i.stdout&&V!==i.stderr?le:_e;function se(be,Me){f("onunpipe"),be===ee&&Me&&Me.hasUnpiped===!1&&(Me.hasUnpiped=!0,f("cleanup"),V.removeListener("close",ge),V.removeListener("finish",Ne),V.removeListener("drain",ye),V.removeListener("error",pe),V.removeListener("unpipe",se),ee.removeListener("end",le),ee.removeListener("end",_e),ee.removeListener("data",ne),ue=!0,!ie.awaitDrain||V._writableState&&!V._writableState.needDrain||ye())}function le(){f("onend"),V.end()}ie.endEmitted?i.nextTick(oe):ee.once("end",oe),V.on("unpipe",se);var ye=function(be){return function(){var Me=be._readableState;f("pipeOnDrain",Me.awaitDrain),Me.awaitDrain&&Me.awaitDrain--,Me.awaitDrain===0&&d(be,"data")&&(Me.flowing=!0,Y(be))}}(ee);V.on("drain",ye);var ue=!1;function ne(be){f("ondata");var Me=V.write(be);f("dest.write",Me),Me===!1&&((ie.pipesCount===1&&ie.pipes===V||ie.pipesCount>1&&J(ie.pipes,V)!==-1)&&!ue&&(f("false write response, pause",ie.awaitDrain),ie.awaitDrain++),ee.pause())}function pe(be){f("onerror",be),_e(),V.removeListener("error",pe),d(V,"error")===0&&L(V,be)}function ge(){V.removeListener("finish",Ne),_e()}function Ne(){f("onfinish"),V.removeListener("close",ge),_e()}function _e(){f("unpipe"),ee.unpipe(V)}return ee.on("data",ne),function(be,Me,Se){if(typeof be.prependListener=="function")return be.prependListener(Me,Se);be._events&&be._events[Me]?Array.isArray(be._events[Me])?be._events[Me].unshift(Se):be._events[Me]=[Se,be._events[Me]]:be.on(Me,Se)}(V,"error",pe),V.once("close",ge),V.once("finish",Ne),V.emit("pipe",ee),ie.flowing||(f("pipe resume"),ee.resume()),V},H.prototype.unpipe=function(V){var W=this._readableState,ee={hasUnpiped:!1};if(W.pipesCount===0)return this;if(W.pipesCount===1)return V&&V!==W.pipes||(V||(V=W.pipes),W.pipes=null,W.pipesCount=0,W.flowing=!1,V&&V.emit("unpipe",this,ee)),this;if(!V){var ie=W.pipes,oe=W.pipesCount;W.pipes=null,W.pipesCount=0,W.flowing=!1;for(var se=0;se<oe;se++)ie[se].emit("unpipe",this,{hasUnpiped:!1});return this}var le=J(W.pipes,V);return le===-1||(W.pipes.splice(le,1),W.pipesCount-=1,W.pipesCount===1&&(W.pipes=W.pipes[0]),V.emit("unpipe",this,ee)),this},H.prototype.on=function(V,W){var ee=l.prototype.on.call(this,V,W),ie=this._readableState;return V==="data"?(ie.readableListening=this.listenerCount("readable")>0,ie.flowing!==!1&&this.resume()):V==="readable"&&(ie.endEmitted||ie.readableListening||(ie.readableListening=ie.needReadable=!0,ie.flowing=!1,ie.emittedReadable=!1,f("on readable",ie.length,ie.reading),ie.length?E(this):ie.reading||i.nextTick(U,this))),ee},H.prototype.addListener=H.prototype.on,H.prototype.removeListener=function(V,W){var ee=l.prototype.removeListener.call(this,V,W);return V==="readable"&&i.nextTick(I,this),ee},H.prototype.removeAllListeners=function(V){var W=l.prototype.removeAllListeners.apply(this,arguments);return V!=="readable"&&V!==void 0||i.nextTick(I,this),W},H.prototype.resume=function(){var V=this._readableState;return V.flowing||(f("resume"),V.flowing=!V.readableListening,function(W,ee){ee.resumeScheduled||(ee.resumeScheduled=!0,i.nextTick($,W,ee))}(this,V)),V.paused=!1,this},H.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},H.prototype.wrap=function(V){var W=this,ee=this._readableState,ie=!1;for(var oe in V.on("end",function(){if(f("wrapped end"),ee.decoder&&!ee.ended){var le=ee.decoder.end();le&&le.length&&W.push(le)}W.push(null)}),V.on("data",function(le){f("wrapped data"),ee.decoder&&(le=ee.decoder.write(le)),ee.objectMode&&le==null||(ee.objectMode||le&&le.length)&&(W.push(le)||(ie=!0,V.pause()))}),V)this[oe]===void 0&&typeof V[oe]=="function"&&(this[oe]=function(le){return function(){return V[le].apply(V,arguments)}}(oe));for(var se=0;se<q.length;se++)V.on(q[se],this.emit.bind(this,q[se]));return this._read=function(le){f("wrapped _read",le),ie&&(ie=!1,V.resume())},this},typeof Symbol=="function"&&(H.prototype[Symbol.asyncIterator]=function(){return g===void 0&&(g=r("./internal/streams/async_iterator")),g(this)}),Object.defineProperty(H.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(H.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(H.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(V){this._readableState&&(this._readableState.flowing=V)}}),H._fromList=Z,Object.defineProperty(H.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(H.from=function(V,W){return v===void 0&&(v=r("./internal/streams/from")),v(H,V,W)})}).call(this)}).call(this,r("_process"),typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(r,s,a){s.exports=f;var i=r("../errors").codes,o=i.ERR_METHOD_NOT_IMPLEMENTED,c=i.ERR_MULTIPLE_CALLBACK,d=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,l=i.ERR_TRANSFORM_WITH_LENGTH_0,u=r("./_stream_duplex");function h(g,v){var x=this._transformState;x.transforming=!1;var y=x.writecb;if(y===null)return this.emit("error",new c);x.writechunk=null,x.writecb=null,v!=null&&this.push(v),y(g);var b=this._readableState;b.reading=!1,(b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}function f(g){if(!(this instanceof f))return new f(g);u.call(this,g),this._transformState={afterTransform:h.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,g&&(typeof g.transform=="function"&&(this._transform=g.transform),typeof g.flush=="function"&&(this._flush=g.flush)),this.on("prefinish",m)}function m(){var g=this;typeof this._flush!="function"||this._readableState.destroyed?p(this,null,null):this._flush(function(v,x){p(g,v,x)})}function p(g,v,x){if(v)return g.emit("error",v);if(x!=null&&g.push(x),g._writableState.length)throw new l;if(g._transformState.transforming)throw new d;return g.push(null)}r("inherits")(f,u),f.prototype.push=function(g,v){return this._transformState.needTransform=!1,u.prototype.push.call(this,g,v)},f.prototype._transform=function(g,v,x){x(new o("_transform()"))},f.prototype._write=function(g,v,x){var y=this._transformState;if(y.writecb=x,y.writechunk=g,y.writeencoding=v,!y.transforming){var b=this._readableState;(y.needTransform||b.needReadable||b.length<b.highWaterMark)&&this._read(b.highWaterMark)}},f.prototype._read=function(g){var v=this._transformState;v.writechunk===null||v.transforming?v.needTransform=!0:(v.transforming=!0,this._transform(v.writechunk,v.writeencoding,v.afterTransform))},f.prototype._destroy=function(g,v){u.prototype._destroy.call(this,g,function(x){v(x)})}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(r,s,a){(function(i,o){(function(){function c(k){var I=this;this.next=null,this.entry=null,this.finish=function(){(function(U,$,Y){var Z=U.entry;for(U.entry=null;Z;){var re=Z.callback;$.pendingcb--,re(Y),Z=Z.next}$.corkedRequestsFree.next=U})(I,k)}}var d;s.exports=H,H.WritableState=X;var l={deprecate:r("util-deprecate")},u=r("./internal/streams/stream"),h=r("buffer").Buffer,f=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},m,p=r("./internal/streams/destroy"),g=r("./internal/streams/state").getHighWaterMark,v=r("../errors").codes,x=v.ERR_INVALID_ARG_TYPE,y=v.ERR_METHOD_NOT_IMPLEMENTED,b=v.ERR_MULTIPLE_CALLBACK,j=v.ERR_STREAM_CANNOT_PIPE,T=v.ERR_STREAM_DESTROYED,O=v.ERR_STREAM_NULL_VALUES,R=v.ERR_STREAM_WRITE_AFTER_END,D=v.ERR_UNKNOWN_ENCODING,L=p.errorOrDestroy;function q(){}function X(k,I,U){d=d||r("./_stream_duplex"),k=k||{},typeof U!="boolean"&&(U=I instanceof d),this.objectMode=!!k.objectMode,U&&(this.objectMode=this.objectMode||!!k.writableObjectMode),this.highWaterMark=g(this,k,"writableHighWaterMark",U),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var $=k.decodeStrings===!1;this.decodeStrings=!$,this.defaultEncoding=k.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Y){(function(Z,re){var G=Z._writableState,J=G.sync,V=G.writecb;if(typeof V!="function")throw new b;if(function(ee){ee.writing=!1,ee.writecb=null,ee.length-=ee.writelen,ee.writelen=0}(G),re)(function(ee,ie,oe,se,le){--ie.pendingcb,oe?(i.nextTick(le,se),i.nextTick(C,ee,ie),ee._writableState.errorEmitted=!0,L(ee,se)):(le(se),ee._writableState.errorEmitted=!0,L(ee,se),C(ee,ie))})(Z,G,J,re,V);else{var W=E(G)||Z.destroyed;W||G.corked||G.bufferProcessing||!G.bufferedRequest||S(Z,G),J?i.nextTick(F,Z,G,W,V):F(Z,G,W,V)}})(I,Y)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=k.emitClose!==!1,this.autoDestroy=!!k.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new c(this)}function H(k){var I=this instanceof(d=d||r("./_stream_duplex"));if(!I&&!m.call(H,this))return new H(k);this._writableState=new X(k,this,I),this.writable=!0,k&&(typeof k.write=="function"&&(this._write=k.write),typeof k.writev=="function"&&(this._writev=k.writev),typeof k.destroy=="function"&&(this._destroy=k.destroy),typeof k.final=="function"&&(this._final=k.final)),u.call(this)}function M(k,I,U,$,Y,Z,re){I.writelen=$,I.writecb=re,I.writing=!0,I.sync=!0,I.destroyed?I.onwrite(new T("write")):U?k._writev(Y,I.onwrite):k._write(Y,Z,I.onwrite),I.sync=!1}function F(k,I,U,$){U||function(Y,Z){Z.length===0&&Z.needDrain&&(Z.needDrain=!1,Y.emit("drain"))}(k,I),I.pendingcb--,$(),C(k,I)}function S(k,I){I.bufferProcessing=!0;var U=I.bufferedRequest;if(k._writev&&U&&U.next){var $=I.bufferedRequestCount,Y=new Array($),Z=I.corkedRequestsFree;Z.entry=U;for(var re=0,G=!0;U;)Y[re]=U,U.isBuf||(G=!1),U=U.next,re+=1;Y.allBuffers=G,M(k,I,!0,I.length,Y,"",Z.finish),I.pendingcb++,I.lastBufferedRequest=null,Z.next?(I.corkedRequestsFree=Z.next,Z.next=null):I.corkedRequestsFree=new c(I),I.bufferedRequestCount=0}else{for(;U;){var J=U.chunk,V=U.encoding,W=U.callback;if(M(k,I,!1,I.objectMode?1:J.length,J,V,W),U=U.next,I.bufferedRequestCount--,I.writing)break}U===null&&(I.lastBufferedRequest=null)}I.bufferedRequest=U,I.bufferProcessing=!1}function E(k){return k.ending&&k.length===0&&k.bufferedRequest===null&&!k.finished&&!k.writing}function N(k,I){k._final(function(U){I.pendingcb--,U&&L(k,U),I.prefinished=!0,k.emit("prefinish"),C(k,I)})}function C(k,I){var U=E(I);if(U&&(function(Y,Z){Z.prefinished||Z.finalCalled||(typeof Y._final!="function"||Z.destroyed?(Z.prefinished=!0,Y.emit("prefinish")):(Z.pendingcb++,Z.finalCalled=!0,i.nextTick(N,Y,Z)))}(k,I),I.pendingcb===0&&(I.finished=!0,k.emit("finish"),I.autoDestroy))){var $=k._readableState;(!$||$.autoDestroy&&$.endEmitted)&&k.destroy()}return U}r("inherits")(H,u),X.prototype.getBuffer=function(){for(var k=this.bufferedRequest,I=[];k;)I.push(k),k=k.next;return I},function(){try{Object.defineProperty(X.prototype,"buffer",{get:l.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(m=Function.prototype[Symbol.hasInstance],Object.defineProperty(H,Symbol.hasInstance,{value:function(k){return!!m.call(this,k)||this===H&&k&&k._writableState instanceof X}})):m=function(k){return k instanceof this},H.prototype.pipe=function(){L(this,new j)},H.prototype.write=function(k,I,U){var $,Y=this._writableState,Z=!1,re=!Y.objectMode&&($=k,h.isBuffer($)||$ instanceof f);return re&&!h.isBuffer(k)&&(k=function(G){return h.from(G)}(k)),typeof I=="function"&&(U=I,I=null),re?I="buffer":I||(I=Y.defaultEncoding),typeof U!="function"&&(U=q),Y.ending?function(G,J){var V=new R;L(G,V),i.nextTick(J,V)}(this,U):(re||function(G,J,V,W){var ee;return V===null?ee=new O:typeof V=="string"||J.objectMode||(ee=new x("chunk",["string","Buffer"],V)),!ee||(L(G,ee),i.nextTick(W,ee),!1)}(this,Y,k,U))&&(Y.pendingcb++,Z=function(G,J,V,W,ee,ie){if(!V){var oe=function(ue,ne,pe){return ue.objectMode||ue.decodeStrings===!1||typeof ne!="string"||(ne=h.from(ne,pe)),ne}(J,W,ee);W!==oe&&(V=!0,ee="buffer",W=oe)}var se=J.objectMode?1:W.length;J.length+=se;var le=J.length<J.highWaterMark;if(le||(J.needDrain=!0),J.writing||J.corked){var ye=J.lastBufferedRequest;J.lastBufferedRequest={chunk:W,encoding:ee,isBuf:V,callback:ie,next:null},ye?ye.next=J.lastBufferedRequest:J.bufferedRequest=J.lastBufferedRequest,J.bufferedRequestCount+=1}else M(G,J,!1,se,W,ee,ie);return le}(this,Y,re,k,I,U)),Z},H.prototype.cork=function(){this._writableState.corked++},H.prototype.uncork=function(){var k=this._writableState;k.corked&&(k.corked--,k.writing||k.corked||k.bufferProcessing||!k.bufferedRequest||S(this,k))},H.prototype.setDefaultEncoding=function(k){if(typeof k=="string"&&(k=k.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((k+"").toLowerCase())>-1))throw new D(k);return this._writableState.defaultEncoding=k,this},Object.defineProperty(H.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(H.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),H.prototype._write=function(k,I,U){U(new y("_write()"))},H.prototype._writev=null,H.prototype.end=function(k,I,U){var $=this._writableState;return typeof k=="function"?(U=k,k=null,I=null):typeof I=="function"&&(U=I,I=null),k!=null&&this.write(k,I),$.corked&&($.corked=1,this.uncork()),$.ending||function(Y,Z,re){Z.ending=!0,C(Y,Z),re&&(Z.finished?i.nextTick(re):Y.once("finish",re)),Z.ended=!0,Y.writable=!1}(this,$,U),this},Object.defineProperty(H.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(H.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(k){this._writableState&&(this._writableState.destroyed=k)}}),H.prototype.destroy=p.destroy,H.prototype._undestroy=p.undestroy,H.prototype._destroy=function(k,I){I(k)}}).call(this)}).call(this,r("_process"),typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(r,s,a){(function(i){(function(){var o;function c(T,O,R){return(O=function(D){var L=function(q,X){if(typeof q!="object"||q===null)return q;var H=q[Symbol.toPrimitive];if(H!==void 0){var M=H.call(q,X||"default");if(typeof M!="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return(X==="string"?String:Number)(q)}(D,"string");return typeof L=="symbol"?L:String(L)}(O))in T?Object.defineProperty(T,O,{value:R,enumerable:!0,configurable:!0,writable:!0}):T[O]=R,T}var d=r("./end-of-stream"),l=Symbol("lastResolve"),u=Symbol("lastReject"),h=Symbol("error"),f=Symbol("ended"),m=Symbol("lastPromise"),p=Symbol("handlePromise"),g=Symbol("stream");function v(T,O){return{value:T,done:O}}function x(T){var O=T[l];if(O!==null){var R=T[g].read();R!==null&&(T[m]=null,T[l]=null,T[u]=null,O(v(R,!1)))}}function y(T){i.nextTick(x,T)}var b=Object.getPrototypeOf(function(){}),j=Object.setPrototypeOf((c(o={get stream(){return this[g]},next:function(){var T=this,O=this[h];if(O!==null)return Promise.reject(O);if(this[f])return Promise.resolve(v(void 0,!0));if(this[g].destroyed)return new Promise(function(q,X){i.nextTick(function(){T[h]?X(T[h]):q(v(void 0,!0))})});var R,D=this[m];if(D)R=new Promise(function(q,X){return function(H,M){q.then(function(){X[f]?H(v(void 0,!0)):X[p](H,M)},M)}}(D,this));else{var L=this[g].read();if(L!==null)return Promise.resolve(v(L,!1));R=new Promise(this[p])}return this[m]=R,R}},Symbol.asyncIterator,function(){return this}),c(o,"return",function(){var T=this;return new Promise(function(O,R){T[g].destroy(null,function(D){D?R(D):O(v(void 0,!0))})})}),o),b);s.exports=function(T){var O,R=Object.create(j,(c(O={},g,{value:T,writable:!0}),c(O,l,{value:null,writable:!0}),c(O,u,{value:null,writable:!0}),c(O,h,{value:null,writable:!0}),c(O,f,{value:T._readableState.endEmitted,writable:!0}),c(O,p,{value:function(D,L){var q=R[g].read();q?(R[m]=null,R[l]=null,R[u]=null,D(v(q,!1))):(R[l]=D,R[u]=L)},writable:!0}),O));return R[m]=null,d(T,function(D){if(D&&D.code!=="ERR_STREAM_PREMATURE_CLOSE"){var L=R[u];return L!==null&&(R[m]=null,R[l]=null,R[u]=null,L(D)),void(R[h]=D)}var q=R[l];q!==null&&(R[m]=null,R[l]=null,R[u]=null,q(v(void 0,!0))),R[f]=!0}),T.on("readable",y.bind(null,R)),R}}).call(this)}).call(this,r("_process"))},{"./end-of-stream":486,_process:467}],484:[function(r,s,a){function i(m,p){var g=Object.keys(m);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(m);p&&(v=v.filter(function(x){return Object.getOwnPropertyDescriptor(m,x).enumerable})),g.push.apply(g,v)}return g}function o(m){for(var p=1;p<arguments.length;p++){var g=arguments[p]!=null?arguments[p]:{};p%2?i(Object(g),!0).forEach(function(v){c(m,v,g[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(g)):i(Object(g)).forEach(function(v){Object.defineProperty(m,v,Object.getOwnPropertyDescriptor(g,v))})}return m}function c(m,p,g){return(p=l(p))in m?Object.defineProperty(m,p,{value:g,enumerable:!0,configurable:!0,writable:!0}):m[p]=g,m}function d(m,p){for(var g=0;g<p.length;g++){var v=p[g];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(m,l(v.key),v)}}function l(m){var p=function(g,v){if(typeof g!="object"||g===null)return g;var x=g[Symbol.toPrimitive];if(x!==void 0){var y=x.call(g,v||"default");if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(v==="string"?String:Number)(g)}(m,"string");return typeof p=="symbol"?p:String(p)}var u=r("buffer").Buffer,h=r("util").inspect,f=h&&h.custom||"inspect";s.exports=function(){function m(){(function(v,x){if(!(v instanceof x))throw new TypeError("Cannot call a class as a function")})(this,m),this.head=null,this.tail=null,this.length=0}var p,g;return p=m,(g=[{key:"push",value:function(v){var x={data:v,next:null};this.length>0?this.tail.next=x:this.head=x,this.tail=x,++this.length}},{key:"unshift",value:function(v){var x={data:v,next:this.head};this.length===0&&(this.tail=x),this.head=x,++this.length}},{key:"shift",value:function(){if(this.length!==0){var v=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,v}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(v){if(this.length===0)return"";for(var x=this.head,y=""+x.data;x=x.next;)y+=v+x.data;return y}},{key:"concat",value:function(v){if(this.length===0)return u.alloc(0);for(var x,y,b,j=u.allocUnsafe(v>>>0),T=this.head,O=0;T;)x=T.data,y=j,b=O,u.prototype.copy.call(x,y,b),O+=T.data.length,T=T.next;return j}},{key:"consume",value:function(v,x){var y;return v<this.head.data.length?(y=this.head.data.slice(0,v),this.head.data=this.head.data.slice(v)):y=v===this.head.data.length?this.shift():x?this._getString(v):this._getBuffer(v),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(v){var x=this.head,y=1,b=x.data;for(v-=b.length;x=x.next;){var j=x.data,T=v>j.length?j.length:v;if(T===j.length?b+=j:b+=j.slice(0,v),(v-=T)==0){T===j.length?(++y,x.next?this.head=x.next:this.head=this.tail=null):(this.head=x,x.data=j.slice(T));break}++y}return this.length-=y,b}},{key:"_getBuffer",value:function(v){var x=u.allocUnsafe(v),y=this.head,b=1;for(y.data.copy(x),v-=y.data.length;y=y.next;){var j=y.data,T=v>j.length?j.length:v;if(j.copy(x,x.length-v,0,T),(v-=T)==0){T===j.length?(++b,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=j.slice(T));break}++b}return this.length-=b,x}},{key:f,value:function(v,x){return h(this,o(o({},x),{},{depth:0,customInspect:!1}))}}])&&d(p.prototype,g),Object.defineProperty(p,"prototype",{writable:!1}),m}()},{buffer:220,util:188}],485:[function(r,s,a){(function(i){(function(){function o(l,u){d(l,u),c(l)}function c(l){l._writableState&&!l._writableState.emitClose||l._readableState&&!l._readableState.emitClose||l.emit("close")}function d(l,u){l.emit("error",u)}s.exports={destroy:function(l,u){var h=this,f=this._readableState&&this._readableState.destroyed,m=this._writableState&&this._writableState.destroyed;return f||m?(u?u(l):l&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(d,this,l)):i.nextTick(d,this,l)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(l||null,function(p){!u&&p?h._writableState?h._writableState.errorEmitted?i.nextTick(c,h):(h._writableState.errorEmitted=!0,i.nextTick(o,h,p)):i.nextTick(o,h,p):u?(i.nextTick(c,h),u(p)):i.nextTick(c,h)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(l,u){var h=l._readableState,f=l._writableState;h&&h.autoDestroy||f&&f.autoDestroy?l.destroy(u):l.emit("error",u)}}}).call(this)}).call(this,r("_process"))},{_process:467}],486:[function(r,s,a){var i=r("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function o(){}s.exports=function c(d,l,u){if(typeof l=="function")return c(d,null,l);l||(l={}),u=function(T){var O=!1;return function(){if(!O){O=!0;for(var R=arguments.length,D=new Array(R),L=0;L<R;L++)D[L]=arguments[L];T.apply(this,D)}}}(u||o);var h=l.readable||l.readable!==!1&&d.readable,f=l.writable||l.writable!==!1&&d.writable,m=function(){d.writable||g()},p=d._writableState&&d._writableState.finished,g=function(){f=!1,p=!0,h||u.call(d)},v=d._readableState&&d._readableState.endEmitted,x=function(){h=!1,v=!0,f||u.call(d)},y=function(T){u.call(d,T)},b=function(){var T;return h&&!v?(d._readableState&&d._readableState.ended||(T=new i),u.call(d,T)):f&&!p?(d._writableState&&d._writableState.ended||(T=new i),u.call(d,T)):void 0},j=function(){d.req.on("finish",g)};return function(T){return T.setHeader&&typeof T.abort=="function"}(d)?(d.on("complete",g),d.on("abort",b),d.req?j():d.on("request",j)):f&&!d._writableState&&(d.on("end",m),d.on("close",m)),d.on("end",x),d.on("finish",g),l.error!==!1&&d.on("error",y),d.on("close",b),function(){d.removeListener("complete",g),d.removeListener("abort",b),d.removeListener("request",j),d.req&&d.req.removeListener("finish",g),d.removeListener("end",m),d.removeListener("close",m),d.removeListener("finish",g),d.removeListener("end",x),d.removeListener("error",y),d.removeListener("close",b)}}},{"../../../errors":477}],487:[function(r,s,a){s.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(r,s,a){var i,o=r("../../../errors").codes,c=o.ERR_MISSING_ARGS,d=o.ERR_STREAM_DESTROYED;function l(p){if(p)throw p}function u(p,g,v,x){x=function(j){var T=!1;return function(){T||(T=!0,j.apply(void 0,arguments))}}(x);var y=!1;p.on("close",function(){y=!0}),i===void 0&&(i=r("./end-of-stream")),i(p,{readable:g,writable:v},function(j){if(j)return x(j);y=!0,x()});var b=!1;return function(j){if(!y&&!b)return b=!0,function(T){return T.setHeader&&typeof T.abort=="function"}(p)?p.abort():typeof p.destroy=="function"?p.destroy():void x(j||new d("pipe"))}}function h(p){p()}function f(p,g){return p.pipe(g)}function m(p){return p.length?typeof p[p.length-1]!="function"?l:p.pop():l}s.exports=function(){for(var p=arguments.length,g=new Array(p),v=0;v<p;v++)g[v]=arguments[v];var x,y=m(g);if(Array.isArray(g[0])&&(g=g[0]),g.length<2)throw new c("streams");var b=g.map(function(j,T){var O=T<g.length-1;return u(j,O,T>0,function(R){x||(x=R),R&&b.forEach(h),O||(b.forEach(h),y(x))})});return g.reduce(f)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(r,s,a){var i=r("../../../errors").codes.ERR_INVALID_OPT_VALUE;s.exports={getHighWaterMark:function(o,c,d,l){var u=function(h,f,m){return h.highWaterMark!=null?h.highWaterMark:f?h[m]:null}(c,l,d);if(u!=null){if(!isFinite(u)||Math.floor(u)!==u||u<0)throw new i(l?d:"highWaterMark",u);return Math.floor(u)}return o.objectMode?16:16384}}},{"../../../errors":477}],490:[function(r,s,a){s.exports=r("events").EventEmitter},{events:422}],491:[function(r,s,a){(a=s.exports=r("./lib/_stream_readable.js")).Stream=a,a.Readable=a,a.Writable=r("./lib/_stream_writable.js"),a.Duplex=r("./lib/_stream_duplex.js"),a.Transform=r("./lib/_stream_transform.js"),a.PassThrough=r("./lib/_stream_passthrough.js"),a.finished=r("./lib/internal/streams/end-of-stream.js"),a.pipeline=r("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(r,s,a){var i=function(o){var c=Object.prototype,d=c.hasOwnProperty,l=Object.defineProperty||function(C,k,I){C[k]=I.value},u=typeof Symbol=="function"?Symbol:{},h=u.iterator||"@@iterator",f=u.asyncIterator||"@@asyncIterator",m=u.toStringTag||"@@toStringTag";function p(C,k,I){return Object.defineProperty(C,k,{value:I,enumerable:!0,configurable:!0,writable:!0}),C[k]}try{p({},"")}catch{p=function(k,I,U){return k[I]=U}}function g(C,k,I,U){var $=k&&k.prototype instanceof y?k:y,Y=Object.create($.prototype),Z=new S(U||[]);return l(Y,"_invoke",{value:X(C,I,Z)}),Y}function v(C,k,I){try{return{type:"normal",arg:C.call(k,I)}}catch(U){return{type:"throw",arg:U}}}o.wrap=g;var x={};function y(){}function b(){}function j(){}var T={};p(T,h,function(){return this});var O=Object.getPrototypeOf,R=O&&O(O(E([])));R&&R!==c&&d.call(R,h)&&(T=R);var D=j.prototype=y.prototype=Object.create(T);function L(C){["next","throw","return"].forEach(function(k){p(C,k,function(I){return this._invoke(k,I)})})}function q(C,k){var I;l(this,"_invoke",{value:function(U,$){function Y(){return new k(function(Z,re){(function G(J,V,W,ee){var ie=v(C[J],C,V);if(ie.type!=="throw"){var oe=ie.arg,se=oe.value;return se&&typeof se=="object"&&d.call(se,"__await")?k.resolve(se.__await).then(function(le){G("next",le,W,ee)},function(le){G("throw",le,W,ee)}):k.resolve(se).then(function(le){oe.value=le,W(oe)},function(le){return G("throw",le,W,ee)})}ee(ie.arg)})(U,$,Z,re)})}return I=I?I.then(Y,Y):Y()}})}function X(C,k,I){var U="suspendedStart";return function($,Y){if(U==="executing")throw new Error("Generator is already running");if(U==="completed"){if($==="throw")throw Y;return N()}for(I.method=$,I.arg=Y;;){var Z=I.delegate;if(Z){var re=H(Z,I);if(re){if(re===x)continue;return re}}if(I.method==="next")I.sent=I._sent=I.arg;else if(I.method==="throw"){if(U==="suspendedStart")throw U="completed",I.arg;I.dispatchException(I.arg)}else I.method==="return"&&I.abrupt("return",I.arg);U="executing";var G=v(C,k,I);if(G.type==="normal"){if(U=I.done?"completed":"suspendedYield",G.arg===x)continue;return{value:G.arg,done:I.done}}G.type==="throw"&&(U="completed",I.method="throw",I.arg=G.arg)}}}function H(C,k){var I=k.method,U=C.iterator[I];if(U===void 0)return k.delegate=null,I==="throw"&&C.iterator.return&&(k.method="return",k.arg=void 0,H(C,k),k.method==="throw")||I!=="return"&&(k.method="throw",k.arg=new TypeError("The iterator does not provide a '"+I+"' method")),x;var $=v(U,C.iterator,k.arg);if($.type==="throw")return k.method="throw",k.arg=$.arg,k.delegate=null,x;var Y=$.arg;return Y?Y.done?(k[C.resultName]=Y.value,k.next=C.nextLoc,k.method!=="return"&&(k.method="next",k.arg=void 0),k.delegate=null,x):Y:(k.method="throw",k.arg=new TypeError("iterator result is not an object"),k.delegate=null,x)}function M(C){var k={tryLoc:C[0]};1 in C&&(k.catchLoc=C[1]),2 in C&&(k.finallyLoc=C[2],k.afterLoc=C[3]),this.tryEntries.push(k)}function F(C){var k=C.completion||{};k.type="normal",delete k.arg,C.completion=k}function S(C){this.tryEntries=[{tryLoc:"root"}],C.forEach(M,this),this.reset(!0)}function E(C){if(C){var k=C[h];if(k)return k.call(C);if(typeof C.next=="function")return C;if(!isNaN(C.length)){var I=-1,U=function $(){for(;++I<C.length;)if(d.call(C,I))return $.value=C[I],$.done=!1,$;return $.value=void 0,$.done=!0,$};return U.next=U}}return{next:N}}function N(){return{value:void 0,done:!0}}return b.prototype=j,l(D,"constructor",{value:j,configurable:!0}),l(j,"constructor",{value:b,configurable:!0}),b.displayName=p(j,m,"GeneratorFunction"),o.isGeneratorFunction=function(C){var k=typeof C=="function"&&C.constructor;return!!k&&(k===b||(k.displayName||k.name)==="GeneratorFunction")},o.mark=function(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,j):(C.__proto__=j,p(C,m,"GeneratorFunction")),C.prototype=Object.create(D),C},o.awrap=function(C){return{__await:C}},L(q.prototype),p(q.prototype,f,function(){return this}),o.AsyncIterator=q,o.async=function(C,k,I,U,$){$===void 0&&($=Promise);var Y=new q(g(C,k,I,U),$);return o.isGeneratorFunction(k)?Y:Y.next().then(function(Z){return Z.done?Z.value:Y.next()})},L(D),p(D,m,"Generator"),p(D,h,function(){return this}),p(D,"toString",function(){return"[object Generator]"}),o.keys=function(C){var k=Object(C),I=[];for(var U in k)I.push(U);return I.reverse(),function $(){for(;I.length;){var Y=I.pop();if(Y in k)return $.value=Y,$.done=!1,$}return $.done=!0,$}},o.values=E,S.prototype={constructor:S,reset:function(C){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(F),!C)for(var k in this)k.charAt(0)==="t"&&d.call(this,k)&&!isNaN(+k.slice(1))&&(this[k]=void 0)},stop:function(){this.done=!0;var C=this.tryEntries[0].completion;if(C.type==="throw")throw C.arg;return this.rval},dispatchException:function(C){if(this.done)throw C;var k=this;function I(G,J){return Y.type="throw",Y.arg=C,k.next=G,J&&(k.method="next",k.arg=void 0),!!J}for(var U=this.tryEntries.length-1;U>=0;--U){var $=this.tryEntries[U],Y=$.completion;if($.tryLoc==="root")return I("end");if($.tryLoc<=this.prev){var Z=d.call($,"catchLoc"),re=d.call($,"finallyLoc");if(Z&&re){if(this.prev<$.catchLoc)return I($.catchLoc,!0);if(this.prev<$.finallyLoc)return I($.finallyLoc)}else if(Z){if(this.prev<$.catchLoc)return I($.catchLoc,!0)}else{if(!re)throw new Error("try statement without catch or finally");if(this.prev<$.finallyLoc)return I($.finallyLoc)}}}},abrupt:function(C,k){for(var I=this.tryEntries.length-1;I>=0;--I){var U=this.tryEntries[I];if(U.tryLoc<=this.prev&&d.call(U,"finallyLoc")&&this.prev<U.finallyLoc){var $=U;break}}$&&(C==="break"||C==="continue")&&$.tryLoc<=k&&k<=$.finallyLoc&&($=null);var Y=$?$.completion:{};return Y.type=C,Y.arg=k,$?(this.method="next",this.next=$.finallyLoc,x):this.complete(Y)},complete:function(C,k){if(C.type==="throw")throw C.arg;return C.type==="break"||C.type==="continue"?this.next=C.arg:C.type==="return"?(this.rval=this.arg=C.arg,this.method="return",this.next="end"):C.type==="normal"&&k&&(this.next=k),x},finish:function(C){for(var k=this.tryEntries.length-1;k>=0;--k){var I=this.tryEntries[k];if(I.finallyLoc===C)return this.complete(I.completion,I.afterLoc),F(I),x}},catch:function(C){for(var k=this.tryEntries.length-1;k>=0;--k){var I=this.tryEntries[k];if(I.tryLoc===C){var U=I.completion;if(U.type==="throw"){var $=U.arg;F(I)}return $}}throw new Error("illegal catch attempt")},delegateYield:function(C,k,I){return this.delegate={iterator:E(C),resultName:k,nextLoc:I},this.method==="next"&&(this.arg=void 0),x}},o}(typeof s=="object"?s.exports:{});try{regeneratorRuntime=i}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},{}],493:[function(r,s,a){var i=r("buffer").Buffer,o=r("inherits"),c=r("hash-base"),d=new Array(16),l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],u=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],h=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],f=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],m=[0,1518500249,1859775393,2400959708,2840853838],p=[1352829926,1548603684,1836072691,2053994217,0];function g(){c.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function v(O,R){return O<<R|O>>>32-R}function x(O,R,D,L,q,X,H,M){return v(O+(R^D^L)+X+H|0,M)+q|0}function y(O,R,D,L,q,X,H,M){return v(O+(R&D|~R&L)+X+H|0,M)+q|0}function b(O,R,D,L,q,X,H,M){return v(O+((R|~D)^L)+X+H|0,M)+q|0}function j(O,R,D,L,q,X,H,M){return v(O+(R&L|D&~L)+X+H|0,M)+q|0}function T(O,R,D,L,q,X,H,M){return v(O+(R^(D|~L))+X+H|0,M)+q|0}o(g,c),g.prototype._update=function(){for(var O=d,R=0;R<16;++R)O[R]=this._block.readInt32LE(4*R);for(var D=0|this._a,L=0|this._b,q=0|this._c,X=0|this._d,H=0|this._e,M=0|this._a,F=0|this._b,S=0|this._c,E=0|this._d,N=0|this._e,C=0;C<80;C+=1){var k,I;C<16?(k=x(D,L,q,X,H,O[l[C]],m[0],h[C]),I=T(M,F,S,E,N,O[u[C]],p[0],f[C])):C<32?(k=y(D,L,q,X,H,O[l[C]],m[1],h[C]),I=j(M,F,S,E,N,O[u[C]],p[1],f[C])):C<48?(k=b(D,L,q,X,H,O[l[C]],m[2],h[C]),I=b(M,F,S,E,N,O[u[C]],p[2],f[C])):C<64?(k=j(D,L,q,X,H,O[l[C]],m[3],h[C]),I=y(M,F,S,E,N,O[u[C]],p[3],f[C])):(k=T(D,L,q,X,H,O[l[C]],m[4],h[C]),I=x(M,F,S,E,N,O[u[C]],p[4],f[C])),D=H,H=X,X=v(q,10),q=L,L=k,M=N,N=E,E=v(S,10),S=F,F=I}var U=this._b+q+E|0;this._b=this._c+X+N|0,this._c=this._d+H+M|0,this._d=this._e+D+F|0,this._e=this._a+L+S|0,this._a=U},g.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var O=i.alloc?i.alloc(20):new i(20);return O.writeInt32LE(this._a,0),O.writeInt32LE(this._b,4),O.writeInt32LE(this._c,8),O.writeInt32LE(this._d,12),O.writeInt32LE(this._e,16),O},s.exports=g},{buffer:220,"hash-base":425,inherits:440}],494:[function(r,s,a){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var i=r("buffer"),o=i.Buffer;function c(l,u){for(var h in l)u[h]=l[h]}function d(l,u,h){return o(l,u,h)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?s.exports=i:(c(i,a),a.Buffer=d),d.prototype=Object.create(o.prototype),c(o,d),d.from=function(l,u,h){if(typeof l=="number")throw new TypeError("Argument must not be a number");return o(l,u,h)},d.alloc=function(l,u,h){if(typeof l!="number")throw new TypeError("Argument must be a number");var f=o(l);return u!==void 0?typeof h=="string"?f.fill(u,h):f.fill(u):f.fill(0),f},d.allocUnsafe=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return o(l)},d.allocUnsafeSlow=function(l){if(typeof l!="number")throw new TypeError("Argument must be a number");return i.SlowBuffer(l)}},{buffer:220}],495:[function(r,s,a){(function(i){(function(){var o,c=r("buffer"),d=c.Buffer,l={};for(o in c)c.hasOwnProperty(o)&&o!=="SlowBuffer"&&o!=="Buffer"&&(l[o]=c[o]);var u=l.Buffer={};for(o in d)d.hasOwnProperty(o)&&o!=="allocUnsafe"&&o!=="allocUnsafeSlow"&&(u[o]=d[o]);if(l.Buffer.prototype=d.prototype,u.from&&u.from!==Uint8Array.from||(u.from=function(h,f,m){if(typeof h=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof h);if(h&&h.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h);return d(h,f,m)}),u.alloc||(u.alloc=function(h,f,m){if(typeof h!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof h);if(h<0||h>=2*(1<<30))throw new RangeError('The value "'+h+'" is invalid for option "size"');var p=d(h);return f&&f.length!==0?typeof m=="string"?p.fill(f,m):p.fill(f):p.fill(0),p}),!l.kStringMaxLength)try{l.kStringMaxLength=i.binding("buffer").kStringMaxLength}catch{}l.constants||(l.constants={MAX_LENGTH:l.kMaxLength},l.kStringMaxLength&&(l.constants.MAX_STRING_LENGTH=l.kStringMaxLength)),s.exports=l}).call(this)}).call(this,r("_process"))},{_process:467,buffer:220}],496:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0});const i=r("xmlchars/xml/1.0/ed5"),o=r("xmlchars/xml/1.1/ed2"),c=r("xmlchars/xmlns/1.0/ed3");var d=i.isS,l=i.isChar,u=i.isNameStartChar,h=i.isNameChar,f=i.S_LIST,m=i.NAME_RE,p=o.isChar,g=c.isNCNameStartChar,v=c.isNCNameChar,x=c.NC_NAME_RE;const y="http://www.w3.org/XML/1998/namespace",b="http://www.w3.org/2000/xmlns/",j={__proto__:null,xml:y,xmlns:b},T={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},O=E=>E===34||E===39,R=[34,39],D=[...R,91,62],L=[...R,60,93],q=[61,63,...f],X=[...f,62,38,60];function H(E,N,C){switch(N){case"xml":C!==y&&E.fail(`xml prefix must be bound to ${y}.`);break;case"xmlns":C!==b&&E.fail(`xmlns prefix must be bound to ${b}.`)}switch(C){case b:E.fail(N===""?`the default namespace may not be set to ${C}.`:`may not assign a prefix (even "xmlns") to the URI ${b}.`);break;case y:switch(N){case"xml":break;case"":E.fail(`the default namespace may not be set to ${C}.`);break;default:E.fail("may not assign the xml namespace to another prefix.")}}}const M=E=>x.test(E),F=E=>m.test(E);a.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const S={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};a.SaxesParser=class{constructor(E){this.opt=E??{},this.fragmentOpt=!!this.opt.fragment;const N=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,N){this.nameStartCheck=g,this.nameCheck=v,this.isName=M,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},j);const C=this.opt.additionalNamespaces;C!=null&&(function(k,I){for(const U of Object.keys(I))H(k,U,I[U])}(this,C),Object.assign(this.ns,C))}else this.nameStartCheck=u,this.nameCheck=h,this.isName=F,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var E;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:N}=this;this.state=N?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=N,this.xmlDeclPossible=!N,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:C}=this.opt;if(C===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");C="1.0"}this.setXMLVersion(C),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(T),(E=this.readyHandler)===null||E===void 0||E.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(E,N){this[S[E]]=N}off(E){this[S[E]]=void 0}makeError(E){var N;let C=(N=this.fileName)!==null&&N!==void 0?N:"";return this.trackPosition&&(C.length>0&&(C+=":"),C+=`${this.line}:${this.column}`),C.length>0&&(C+=": "),new Error(C+E)}fail(E){const N=this.makeError(E),C=this.errorHandler;if(C===void 0)throw N;return C(N),this}write(E){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let N=!1;E===null?(N=!0,E=""):typeof E=="object"&&(E=E.toString()),this.carriedFromPrevious!==void 0&&(E=`${this.carriedFromPrevious}${E}`,this.carriedFromPrevious=void 0);let C=E.length;const k=E.charCodeAt(C-1);!N&&(k===13||k>=55296&&k<=56319)&&(this.carriedFromPrevious=E[C-1],C--,E=E.slice(0,C));const{stateTable:I}=this;for(this.chunk=E,this.i=0;this.i<C;)I[this.state].call(this);return this.chunkPosition+=C,N?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:E,i:N}=this;if(this.prevI=N,this.i=N+1,N>=E.length)return-1;const C=E.charCodeAt(N);if(this.column++,C<55296){if(C>=32||C===9)return C;switch(C){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return E.charCodeAt(N+1)===10&&(this.i=N+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),C}}if(C>56319)return C>=57344&&C<=65533||this.fail("disallowed character."),C;const k=65536+1024*(C-55296)+(E.charCodeAt(N+1)-56320);return this.i=N+2,k>1114111&&this.fail("disallowed character."),k}getCode11(){const{chunk:E,i:N}=this;if(this.prevI=N,this.i=N+1,N>=E.length)return-1;const C=E.charCodeAt(N);if(this.column++,C<55296){if(C>31&&C<127||C>159&&C!==8232||C===9)return C;switch(C){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const I=E.charCodeAt(N+1);I!==10&&I!==133||(this.i=N+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),C}}if(C>56319)return C>=57344&&C<=65533||this.fail("disallowed character."),C;const k=65536+1024*(C-55296)+(E.charCodeAt(N+1)-56320);return this.i=N+2,k>1114111&&this.fail("disallowed character."),k}getCodeNorm(){const E=this.getCode();return E===-2?10:E}unget(){this.i=this.prevI,this.column--}captureTo(E){let{i:N}=this;const{chunk:C}=this;for(;;){const k=this.getCode(),I=k===-2,U=I?10:k;if(U===-1||E.includes(U))return this.text+=C.slice(N,this.prevI),U;I&&(this.text+=C.slice(N,this.prevI)+`
`,N=this.i)}}captureToChar(E){let{i:N}=this;const{chunk:C}=this;for(;;){let k=this.getCode();switch(k){case-2:this.text+=C.slice(N,this.prevI)+`
`,N=this.i,k=10;break;case-1:return this.text+=C.slice(N),!1}if(k===E)return this.text+=C.slice(N,this.prevI),!0}}captureNameChars(){const{chunk:E,i:N}=this;for(;;){const C=this.getCode();if(C===-1)return this.name+=E.slice(N),-1;if(!h(C))return this.name+=E.slice(N,this.prevI),C===-2?10:C}}skipSpaces(){for(;;){const E=this.getCodeNorm();if(E===-1||!d(E))return E}}setXMLVersion(E){this.currentXMLVersion=E,E==="1.0"?(this.isChar=l,this.getCode=this.getCode10):(this.isChar=p,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const E=this.i,N=this.skipSpaces();switch(this.prevI!==E&&(this.xmlDeclPossible=!1),N){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var E;const N=this.captureTo(D);switch(N){case 62:(E=this.doctypeHandler)===null||E===void 0||E.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(N),N===91?this.state=4:O(N)&&(this.state=3,this.q=N)}}sDoctypeQuote(){const E=this.q;this.captureToChar(E)&&(this.text+=String.fromCodePoint(E),this.q=null,this.state=2)}sDTD(){const E=this.captureTo(L);E!==-1&&(this.text+=String.fromCodePoint(E),E===93?this.state=2:E===60?this.state=6:O(E)&&(this.state=5,this.q=E))}sDTDQuoted(){const E=this.q;this.captureToChar(E)&&(this.text+=String.fromCodePoint(E),this.state=4,this.q=null)}sDTDOpenWaka(){const E=this.getCodeNorm();switch(this.text+=String.fromCodePoint(E),E){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const E=String.fromCodePoint(this.getCodeNorm()),N=this.openWakaBang+=E;this.text+=E,N!=="-"&&(this.state=N==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const E=this.getCodeNorm();this.text+=String.fromCodePoint(E),this.state=E===45?10:8}sDTDCommentEnded(){const E=this.getCodeNorm();this.text+=String.fromCodePoint(E),E===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const E=this.getCodeNorm();this.text+=String.fromCodePoint(E),E===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:E}=this;const{chunk:N}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=N.slice(E,this.prevI)+`
`,E=this.i;break;case 59:{const{entityReturnState:C}=this,k=this.entity+N.slice(E,this.prevI);let I;this.state=C,k===""?(this.fail("empty entity name."),I="&;"):(I=this.parseEntity(k),this.entity=""),C===13&&this.textHandler===void 0||(this.text+=I);break e}case-1:this.entity+=N.slice(E);break e}}sOpenWaka(){const E=this.getCode();if(u(E))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(E){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var E;const N=this.getCodeNorm();N===45?(this.state=19,(E=this.commentHandler)===null||E===void 0||E.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(N),this.state=17)}sCommentEnded(){const E=this.getCodeNorm();E!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(E),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const E=this.getCodeNorm();E===93?this.state=22:(this.text+="]"+String.fromCodePoint(E),this.state=20)}sCDataEnding2(){var E;const N=this.getCodeNorm();switch(N){case 62:(E=this.cdataHandler)===null||E===void 0||E.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(N),this.state=20}}sPIFirstChar(){const E=this.getCodeNorm();this.nameStartCheck(E)?(this.piTarget+=String.fromCodePoint(E),this.state=24):E===63||d(E)?(this.fail("processing instruction without a target."),this.state=E===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(E),this.state=24)}sPIRest(){const{chunk:E,i:N}=this;for(;;){const C=this.getCodeNorm();if(C===-1)return void(this.piTarget+=E.slice(N));if(!this.nameCheck(C)){this.piTarget+=E.slice(N,this.prevI);const k=C===63;k||d(C)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=k?33:27):this.state=k?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(C));break}}}sPIBody(){if(this.text.length===0){const E=this.getCodeNorm();E===63?this.state=26:d(E)||(this.text=String.fromCodePoint(E))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var E;const N=this.getCodeNorm();if(N===62){const{piTarget:C}=this;C.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(E=this.piHandler)===null||E===void 0||E.call(this,{target:C,body:this.text}),this.piTarget=this.text="",this.state=13}else N===63?this.text+="?":(this.text+="?"+String.fromCodePoint(N),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const E=this.skipSpaces();E!==63?E!==-1&&(this.state=28,this.name=String.fromCodePoint(E)):this.state=33}sXMLDeclName(){const E=this.captureTo(q);if(E===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(d(E)||E===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=E===61?30:29}}sXMLDeclEq(){const E=this.getCodeNorm();if(E===63)return this.state=33,void this.fail("XML declaration is incomplete.");d(E)||(E!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const E=this.getCodeNorm();if(E===63)return this.state=33,void this.fail("XML declaration is incomplete.");d(E)||(O(E)?this.q=E:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const E=this.captureTo([this.q,63]);if(E===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(E===-1)return;const N=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const C=N;this.xmlDecl.version=C,/^1\.[0-9]+$/.test(C)?this.opt.forceXMLVersion||this.setXMLVersion(C):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(N)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=N;break;case"standalone":N!=="yes"&&N!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=N}this.name="",this.state=32}sXMLDeclSeparator(){const E=this.getCodeNorm();E!==63?(d(E)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var E;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(E=this.xmldeclHandler)===null||E===void 0||E.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var E;const N=this.captureNameChars();if(N===-1)return;const C=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=C.ns=Object.create(null)),(E=this.openTagStartHandler)===null||E===void 0||E.call(this,C),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),N){case 62:this.openTag();break;case 47:this.state=35;break;default:d(N)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const E=this.skipSpaces();E!==-1&&(u(E)?(this.unget(),this.state=37):E===62?this.openTag():E===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const E=this.captureNameChars();E===61?this.state=39:d(E)?this.state=38:E===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):E!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const E=this.skipSpaces();switch(E){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",E===62?this.openTag():u(E)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const E=this.getCodeNorm();O(E)?(this.q=E,this.state=40):d(E)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:E,chunk:N}=this;let{i:C}=this;for(;;)switch(this.getCode()){case E:return this.pushAttrib(this.name,this.text+N.slice(C,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=N.slice(C,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=N.slice(C,this.prevI)+" ",C=this.i;break;case 60:return this.text+=N.slice(C,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=N.slice(C))}}sAttribValueClosed(){const E=this.getCodeNorm();d(E)?this.state=36:E===62?this.openTag():E===47?this.state=35:u(E)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const E=this.captureTo(X);switch(E){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",E===62?this.openTag():this.state=36}}sCloseTag(){const E=this.captureNameChars();E===62?this.closeTag():d(E)?this.state=44:E!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:E,forbiddenState:N}=this;const{chunk:C,textHandler:k}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,k!==void 0){const{text:I}=this,U=C.slice(E,this.prevI);I.length!==0?(k(I+U),this.text=""):U.length!==0&&k(U)}N=0;break e;case 38:this.state=14,this.entityReturnState=13,k!==void 0&&(this.text+=C.slice(E,this.prevI)),N=0;break e;case 93:switch(N){case 0:N=1;break;case 1:N=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:N===2&&this.fail('the string "]]>" is disallowed in char data.'),N=0;break;case-2:k!==void 0&&(this.text+=C.slice(E,this.prevI)+`
`),E=this.i,N=0;break;case-1:k!==void 0&&(this.text+=C.slice(E));break e;default:N=0}this.forbiddenState=N}handleTextOutsideRoot(){let{i:E}=this;const{chunk:N,textHandler:C}=this;let k=!1;e:for(;;){const I=this.getCode();switch(I){case 60:if(this.state=15,C!==void 0){const{text:U}=this,$=N.slice(E,this.prevI);U.length!==0?(C(U+$),this.text=""):$.length!==0&&C($)}break e;case 38:this.state=14,this.entityReturnState=13,C!==void 0&&(this.text+=N.slice(E,this.prevI)),k=!0;break e;case-2:C!==void 0&&(this.text+=N.slice(E,this.prevI)+`
`),E=this.i;break;case-1:C!==void 0&&(this.text+=N.slice(E));break e;default:d(I)||(k=!0)}}k&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(E,N){var C;const{prefix:k,local:I}=this.qname(E),U={name:E,prefix:k,local:I,value:N};if(this.attribList.push(U),(C=this.attributeHandler)===null||C===void 0||C.call(this,U),k==="xmlns"){const $=N.trim();this.currentXMLVersion==="1.0"&&$===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[I]=$,H(this,I,$)}else if(E==="xmlns"){const $=N.trim();this.topNS[""]=$,H(this,"",$)}}pushAttribPlain(E,N){var C;const k={name:E,value:N};this.attribList.push(k),(C=this.attributeHandler)===null||C===void 0||C.call(this,k)}end(){var E,N;this.sawRoot||this.fail("document must contain a root element.");const{tags:C}=this;for(;C.length>0;){const I=C.pop();this.fail("unclosed tag: "+I.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:k}=this;return k.length!==0&&((E=this.textHandler)===null||E===void 0||E.call(this,k),this.text=""),this._closed=!0,(N=this.endHandler)===null||N===void 0||N.call(this),this._init(),this}resolve(E){var N,C;let k=this.topNS[E];if(k!==void 0)return k;const{tags:I}=this;for(let U=I.length-1;U>=0;U--)if(k=I[U].ns[E],k!==void 0)return k;return k=this.ns[E],k!==void 0?k:(C=(N=this.opt).resolvePrefix)===null||C===void 0?void 0:C.call(N,E)}qname(E){const N=E.indexOf(":");if(N===-1)return{prefix:"",local:E};const C=E.slice(N+1),k=E.slice(0,N);return(k===""||C===""||C.includes(":"))&&this.fail(`malformed name: ${E}.`),{prefix:k,local:C}}processAttribsNS(){var E;const{attribList:N}=this,C=this.tag;{const{prefix:U,local:$}=this.qname(C.name);C.prefix=U,C.local=$;const Y=C.uri=(E=this.resolve(U))!==null&&E!==void 0?E:"";U!==""&&(U==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),Y===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(U)}.`),C.uri=U))}if(N.length===0)return;const{attributes:k}=C,I=new Set;for(const U of N){const{name:$,prefix:Y,local:Z}=U;let re,G;Y===""?(re=$==="xmlns"?b:"",G=$):(re=this.resolve(Y),re===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(Y)}.`),re=Y),G=`{${re}}${Z}`),I.has(G)&&this.fail(`duplicate attribute: ${G}.`),I.add(G),U.uri=re,k[$]=U}this.attribList=[]}processAttribsPlain(){const{attribList:E}=this,N=this.tag.attributes;for(const{name:C,value:k}of E)N[C]!==void 0&&this.fail(`duplicate attribute: ${C}.`),N[C]=k;this.attribList=[]}openTag(){var E;this.processAttribs();const{tags:N}=this,C=this.tag;C.isSelfClosing=!1,(E=this.openTagHandler)===null||E===void 0||E.call(this,C),N.push(C),this.state=13,this.name=""}openSelfClosingTag(){var E,N,C;this.processAttribs();const{tags:k}=this,I=this.tag;I.isSelfClosing=!0,(E=this.openTagHandler)===null||E===void 0||E.call(this,I),(N=this.closeTagHandler)===null||N===void 0||N.call(this,I),(this.tag=(C=k[k.length-1])!==null&&C!==void 0?C:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:E,name:N}=this;if(this.state=13,this.name="",N==="")return this.fail("weird empty close tag."),void(this.text+="</>");const C=this.closeTagHandler;let k=E.length;for(;k-- >0;){const I=this.tag=E.pop();if(this.topNS=I.ns,C==null||C(I),I.name===N)break;this.fail("unexpected close tag.")}k===0?this.closedRoot=!0:k<0&&(this.fail(`unmatched closing tag: ${N}.`),this.text+=`</${N}>`)}parseEntity(E){if(E[0]!=="#"){const C=this.ENTITIES[E];return C!==void 0?C:(this.fail(this.isName(E)?"undefined entity.":"disallowed character in entity name."),`&${E};`)}let N=NaN;return E[1]==="x"&&/^#x[0-9a-f]+$/i.test(E)?N=parseInt(E.slice(2),16):/^#[0-9]+$/.test(E)&&(N=parseInt(E.slice(1),10)),this.isChar(N)?String.fromCodePoint(N):(this.fail("malformed character entity."),`&${E};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(r,s,a){var i=r("safe-buffer").Buffer;function o(c,d){this._block=i.alloc(c),this._finalSize=d,this._blockSize=c,this._len=0}o.prototype.update=function(c,d){typeof c=="string"&&(d=d||"utf8",c=i.from(c,d));for(var l=this._block,u=this._blockSize,h=c.length,f=this._len,m=0;m<h;){for(var p=f%u,g=Math.min(h-m,u-p),v=0;v<g;v++)l[p+v]=c[m+v];m+=g,(f+=g)%u==0&&this._update(l)}return this._len+=h,this},o.prototype.digest=function(c){var d=this._len%this._blockSize;this._block[d]=128,this._block.fill(0,d+1),d>=this._finalSize&&(this._update(this._block),this._block.fill(0));var l=8*this._len;if(l<=4294967295)this._block.writeUInt32BE(l,this._blockSize-4);else{var u=(4294967295&l)>>>0,h=(l-u)/4294967296;this._block.writeUInt32BE(h,this._blockSize-8),this._block.writeUInt32BE(u,this._blockSize-4)}this._update(this._block);var f=this._hash();return c?f.toString(c):f},o.prototype._update=function(){throw new Error("_update must be implemented by subclass")},s.exports=o},{"safe-buffer":494}],498:[function(r,s,a){var i=s.exports=function(o){o=o.toLowerCase();var c=i[o];if(!c)throw new Error(o+" is not supported (we accept pull requests)");return new c};i.sha=r("./sha"),i.sha1=r("./sha1"),i.sha224=r("./sha224"),i.sha256=r("./sha256"),i.sha384=r("./sha384"),i.sha512=r("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(r,s,a){var i=r("inherits"),o=r("./hash"),c=r("safe-buffer").Buffer,d=[1518500249,1859775393,-1894007588,-899497514],l=new Array(80);function u(){this.init(),this._w=l,o.call(this,64,56)}function h(m){return m<<30|m>>>2}function f(m,p,g,v){return m===0?p&g|~p&v:m===2?p&g|p&v|g&v:p^g^v}i(u,o),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(m){for(var p,g=this._w,v=0|this._a,x=0|this._b,y=0|this._c,b=0|this._d,j=0|this._e,T=0;T<16;++T)g[T]=m.readInt32BE(4*T);for(;T<80;++T)g[T]=g[T-3]^g[T-8]^g[T-14]^g[T-16];for(var O=0;O<80;++O){var R=~~(O/20),D=0|((p=v)<<5|p>>>27)+f(R,x,y,b)+j+g[O]+d[R];j=b,b=y,y=h(x),x=v,v=D}this._a=v+this._a|0,this._b=x+this._b|0,this._c=y+this._c|0,this._d=b+this._d|0,this._e=j+this._e|0},u.prototype._hash=function(){var m=c.allocUnsafe(20);return m.writeInt32BE(0|this._a,0),m.writeInt32BE(0|this._b,4),m.writeInt32BE(0|this._c,8),m.writeInt32BE(0|this._d,12),m.writeInt32BE(0|this._e,16),m},s.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(r,s,a){var i=r("inherits"),o=r("./hash"),c=r("safe-buffer").Buffer,d=[1518500249,1859775393,-1894007588,-899497514],l=new Array(80);function u(){this.init(),this._w=l,o.call(this,64,56)}function h(p){return p<<5|p>>>27}function f(p){return p<<30|p>>>2}function m(p,g,v,x){return p===0?g&v|~g&x:p===2?g&v|g&x|v&x:g^v^x}i(u,o),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(p){for(var g,v=this._w,x=0|this._a,y=0|this._b,b=0|this._c,j=0|this._d,T=0|this._e,O=0;O<16;++O)v[O]=p.readInt32BE(4*O);for(;O<80;++O)v[O]=(g=v[O-3]^v[O-8]^v[O-14]^v[O-16])<<1|g>>>31;for(var R=0;R<80;++R){var D=~~(R/20),L=h(x)+m(D,y,b,j)+T+v[R]+d[D]|0;T=j,j=b,b=f(y),y=x,x=L}this._a=x+this._a|0,this._b=y+this._b|0,this._c=b+this._c|0,this._d=j+this._d|0,this._e=T+this._e|0},u.prototype._hash=function(){var p=c.allocUnsafe(20);return p.writeInt32BE(0|this._a,0),p.writeInt32BE(0|this._b,4),p.writeInt32BE(0|this._c,8),p.writeInt32BE(0|this._d,12),p.writeInt32BE(0|this._e,16),p},s.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(r,s,a){var i=r("inherits"),o=r("./sha256"),c=r("./hash"),d=r("safe-buffer").Buffer,l=new Array(64);function u(){this.init(),this._w=l,c.call(this,64,56)}i(u,o),u.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},u.prototype._hash=function(){var h=d.allocUnsafe(28);return h.writeInt32BE(this._a,0),h.writeInt32BE(this._b,4),h.writeInt32BE(this._c,8),h.writeInt32BE(this._d,12),h.writeInt32BE(this._e,16),h.writeInt32BE(this._f,20),h.writeInt32BE(this._g,24),h},s.exports=u},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(r,s,a){var i=r("inherits"),o=r("./hash"),c=r("safe-buffer").Buffer,d=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],l=new Array(64);function u(){this.init(),this._w=l,o.call(this,64,56)}function h(v,x,y){return y^v&(x^y)}function f(v,x,y){return v&x|y&(v|x)}function m(v){return(v>>>2|v<<30)^(v>>>13|v<<19)^(v>>>22|v<<10)}function p(v){return(v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7)}function g(v){return(v>>>7|v<<25)^(v>>>18|v<<14)^v>>>3}i(u,o),u.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},u.prototype._update=function(v){for(var x,y=this._w,b=0|this._a,j=0|this._b,T=0|this._c,O=0|this._d,R=0|this._e,D=0|this._f,L=0|this._g,q=0|this._h,X=0;X<16;++X)y[X]=v.readInt32BE(4*X);for(;X<64;++X)y[X]=0|(((x=y[X-2])>>>17|x<<15)^(x>>>19|x<<13)^x>>>10)+y[X-7]+g(y[X-15])+y[X-16];for(var H=0;H<64;++H){var M=q+p(R)+h(R,D,L)+d[H]+y[H]|0,F=m(b)+f(b,j,T)|0;q=L,L=D,D=R,R=O+M|0,O=T,T=j,j=b,b=M+F|0}this._a=b+this._a|0,this._b=j+this._b|0,this._c=T+this._c|0,this._d=O+this._d|0,this._e=R+this._e|0,this._f=D+this._f|0,this._g=L+this._g|0,this._h=q+this._h|0},u.prototype._hash=function(){var v=c.allocUnsafe(32);return v.writeInt32BE(this._a,0),v.writeInt32BE(this._b,4),v.writeInt32BE(this._c,8),v.writeInt32BE(this._d,12),v.writeInt32BE(this._e,16),v.writeInt32BE(this._f,20),v.writeInt32BE(this._g,24),v.writeInt32BE(this._h,28),v},s.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(r,s,a){var i=r("inherits"),o=r("./sha512"),c=r("./hash"),d=r("safe-buffer").Buffer,l=new Array(160);function u(){this.init(),this._w=l,c.call(this,128,112)}i(u,o),u.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},u.prototype._hash=function(){var h=d.allocUnsafe(48);function f(m,p,g){h.writeInt32BE(m,g),h.writeInt32BE(p,g+4)}return f(this._ah,this._al,0),f(this._bh,this._bl,8),f(this._ch,this._cl,16),f(this._dh,this._dl,24),f(this._eh,this._el,32),f(this._fh,this._fl,40),h},s.exports=u},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(r,s,a){var i=r("inherits"),o=r("./hash"),c=r("safe-buffer").Buffer,d=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],l=new Array(160);function u(){this.init(),this._w=l,o.call(this,128,112)}function h(j,T,O){return O^j&(T^O)}function f(j,T,O){return j&T|O&(j|T)}function m(j,T){return(j>>>28|T<<4)^(T>>>2|j<<30)^(T>>>7|j<<25)}function p(j,T){return(j>>>14|T<<18)^(j>>>18|T<<14)^(T>>>9|j<<23)}function g(j,T){return(j>>>1|T<<31)^(j>>>8|T<<24)^j>>>7}function v(j,T){return(j>>>1|T<<31)^(j>>>8|T<<24)^(j>>>7|T<<25)}function x(j,T){return(j>>>19|T<<13)^(T>>>29|j<<3)^j>>>6}function y(j,T){return(j>>>19|T<<13)^(T>>>29|j<<3)^(j>>>6|T<<26)}function b(j,T){return j>>>0<T>>>0?1:0}i(u,o),u.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},u.prototype._update=function(j){for(var T=this._w,O=0|this._ah,R=0|this._bh,D=0|this._ch,L=0|this._dh,q=0|this._eh,X=0|this._fh,H=0|this._gh,M=0|this._hh,F=0|this._al,S=0|this._bl,E=0|this._cl,N=0|this._dl,C=0|this._el,k=0|this._fl,I=0|this._gl,U=0|this._hl,$=0;$<32;$+=2)T[$]=j.readInt32BE(4*$),T[$+1]=j.readInt32BE(4*$+4);for(;$<160;$+=2){var Y=T[$-30],Z=T[$-30+1],re=g(Y,Z),G=v(Z,Y),J=x(Y=T[$-4],Z=T[$-4+1]),V=y(Z,Y),W=T[$-14],ee=T[$-14+1],ie=T[$-32],oe=T[$-32+1],se=G+ee|0,le=re+W+b(se,G)|0;le=(le=le+J+b(se=se+V|0,V)|0)+ie+b(se=se+oe|0,oe)|0,T[$]=le,T[$+1]=se}for(var ye=0;ye<160;ye+=2){le=T[ye],se=T[ye+1];var ue=f(O,R,D),ne=f(F,S,E),pe=m(O,F),ge=m(F,O),Ne=p(q,C),_e=p(C,q),be=d[ye],Me=d[ye+1],Se=h(q,X,H),$e=h(C,k,I),Ke=U+_e|0,Ze=M+Ne+b(Ke,U)|0;Ze=(Ze=(Ze=Ze+Se+b(Ke=Ke+$e|0,$e)|0)+be+b(Ke=Ke+Me|0,Me)|0)+le+b(Ke=Ke+se|0,se)|0;var it=ge+ne|0,Re=pe+ue+b(it,ge)|0;M=H,U=I,H=X,I=k,X=q,k=C,q=L+Ze+b(C=N+Ke|0,N)|0,L=D,N=E,D=R,E=S,R=O,S=F,O=Ze+Re+b(F=Ke+it|0,Ke)|0}this._al=this._al+F|0,this._bl=this._bl+S|0,this._cl=this._cl+E|0,this._dl=this._dl+N|0,this._el=this._el+C|0,this._fl=this._fl+k|0,this._gl=this._gl+I|0,this._hl=this._hl+U|0,this._ah=this._ah+O+b(this._al,F)|0,this._bh=this._bh+R+b(this._bl,S)|0,this._ch=this._ch+D+b(this._cl,E)|0,this._dh=this._dh+L+b(this._dl,N)|0,this._eh=this._eh+q+b(this._el,C)|0,this._fh=this._fh+X+b(this._fl,k)|0,this._gh=this._gh+H+b(this._gl,I)|0,this._hh=this._hh+M+b(this._hl,U)|0},u.prototype._hash=function(){var j=c.allocUnsafe(64);function T(O,R,D){j.writeInt32BE(O,D),j.writeInt32BE(R,D+4)}return T(this._ah,this._al,0),T(this._bh,this._bl,8),T(this._ch,this._cl,16),T(this._dh,this._dl,24),T(this._eh,this._el,32),T(this._fh,this._fl,40),T(this._gh,this._gl,48),T(this._hh,this._hl,56),j},s.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(r,s,a){s.exports=o;var i=r("events").EventEmitter;function o(){i.call(this)}r("inherits")(o,i),o.Readable=r("readable-stream/readable.js"),o.Writable=r("readable-stream/writable.js"),o.Duplex=r("readable-stream/duplex.js"),o.Transform=r("readable-stream/transform.js"),o.PassThrough=r("readable-stream/passthrough.js"),o.Stream=o,o.prototype.pipe=function(c,d){var l=this;function u(x){c.writable&&c.write(x)===!1&&l.pause&&l.pause()}function h(){l.readable&&l.resume&&l.resume()}l.on("data",u),c.on("drain",h),c._isStdio||d&&d.end===!1||(l.on("end",m),l.on("close",p));var f=!1;function m(){f||(f=!0,c.end())}function p(){f||(f=!0,typeof c.destroy=="function"&&c.destroy())}function g(x){if(v(),i.listenerCount(this,"error")===0)throw x}function v(){l.removeListener("data",u),c.removeListener("drain",h),l.removeListener("end",m),l.removeListener("close",p),l.removeListener("error",g),c.removeListener("error",g),l.removeListener("end",v),l.removeListener("close",v),c.removeListener("close",v)}return l.on("error",g),c.on("error",g),l.on("end",v),l.on("close",v),c.on("close",v),c.emit("pipe",l),c}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(r,s,a){var i={}.toString;s.exports=Array.isArray||function(o){return i.call(o)=="[object Array]"}},{}],507:[function(r,s,a){s.exports=r("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(r,s,a){var i=r("process-nextick-args"),o=Object.keys||function(v){var x=[];for(var y in v)x.push(y);return x};s.exports=m;var c=Object.create(r("core-util-is"));c.inherits=r("inherits");var d=r("./_stream_readable"),l=r("./_stream_writable");c.inherits(m,d);for(var u=o(l.prototype),h=0;h<u.length;h++){var f=u[h];m.prototype[f]||(m.prototype[f]=l.prototype[f])}function m(v){if(!(this instanceof m))return new m(v);d.call(this,v),l.call(this,v),v&&v.readable===!1&&(this.readable=!1),v&&v.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,v&&v.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",p)}function p(){this.allowHalfOpen||this._writableState.ended||i.nextTick(g,this)}function g(v){v.end()}Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(m.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(v){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=v,this._writableState.destroyed=v)}}),m.prototype._destroy=function(v,x){this.push(null),this.end(),i.nextTick(x,v)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(r,s,a){s.exports=c;var i=r("./_stream_transform"),o=Object.create(r("core-util-is"));function c(d){if(!(this instanceof c))return new c(d);i.call(this,d)}o.inherits=r("inherits"),o.inherits(c,i),c.prototype._transform=function(d,l,u){u(null,d)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(r,s,a){(function(i,o){(function(){var c=r("process-nextick-args");s.exports=O;var d,l=r("isarray");O.ReadableState=T,r("events").EventEmitter;var u=function(U,$){return U.listeners($).length},h=r("./internal/streams/stream"),f=r("safe-buffer").Buffer,m=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},p=Object.create(r("core-util-is"));p.inherits=r("inherits");var g=r("util"),v=void 0;v=g&&g.debuglog?g.debuglog("stream"):function(){};var x,y=r("./internal/streams/BufferList"),b=r("./internal/streams/destroy");p.inherits(O,h);var j=["error","close","destroy","pause","resume"];function T(U,$){U=U||{};var Y=$ instanceof(d=d||r("./_stream_duplex"));this.objectMode=!!U.objectMode,Y&&(this.objectMode=this.objectMode||!!U.readableObjectMode);var Z=U.highWaterMark,re=U.readableHighWaterMark,G=this.objectMode?16:16384;this.highWaterMark=Z||Z===0?Z:Y&&(re||re===0)?re:G,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=U.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,U.encoding&&(x||(x=r("string_decoder/").StringDecoder),this.decoder=new x(U.encoding),this.encoding=U.encoding)}function O(U){if(d=d||r("./_stream_duplex"),!(this instanceof O))return new O(U);this._readableState=new T(U,this),this.readable=!0,U&&(typeof U.read=="function"&&(this._read=U.read),typeof U.destroy=="function"&&(this._destroy=U.destroy)),h.call(this)}function R(U,$,Y,Z,re){var G,J=U._readableState;return $===null?(J.reading=!1,function(V,W){if(!W.ended){if(W.decoder){var ee=W.decoder.end();ee&&ee.length&&(W.buffer.push(ee),W.length+=W.objectMode?1:ee.length)}W.ended=!0,q(V)}}(U,J)):(re||(G=function(V,W){var ee;ie=W,f.isBuffer(ie)||ie instanceof m||typeof W=="string"||W===void 0||V.objectMode||(ee=new TypeError("Invalid non-string/buffer chunk"));var ie;return ee}(J,$)),G?U.emit("error",G):J.objectMode||$&&$.length>0?(typeof $=="string"||J.objectMode||Object.getPrototypeOf($)===f.prototype||($=function(V){return f.from(V)}($)),Z?J.endEmitted?U.emit("error",new Error("stream.unshift() after end event")):D(U,J,$,!0):J.ended?U.emit("error",new Error("stream.push() after EOF")):(J.reading=!1,J.decoder&&!Y?($=J.decoder.write($),J.objectMode||$.length!==0?D(U,J,$,!1):H(U,J)):D(U,J,$,!1))):Z||(J.reading=!1)),function(V){return!V.ended&&(V.needReadable||V.length<V.highWaterMark||V.length===0)}(J)}function D(U,$,Y,Z){$.flowing&&$.length===0&&!$.sync?(U.emit("data",Y),U.read(0)):($.length+=$.objectMode?1:Y.length,Z?$.buffer.unshift(Y):$.buffer.push(Y),$.needReadable&&q(U)),H(U,$)}Object.defineProperty(O.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(U){this._readableState&&(this._readableState.destroyed=U)}}),O.prototype.destroy=b.destroy,O.prototype._undestroy=b.undestroy,O.prototype._destroy=function(U,$){this.push(null),$(U)},O.prototype.push=function(U,$){var Y,Z=this._readableState;return Z.objectMode?Y=!0:typeof U=="string"&&(($=$||Z.defaultEncoding)!==Z.encoding&&(U=f.from(U,$),$=""),Y=!0),R(this,U,$,!1,Y)},O.prototype.unshift=function(U){return R(this,U,null,!0,!1)},O.prototype.isPaused=function(){return this._readableState.flowing===!1},O.prototype.setEncoding=function(U){return x||(x=r("string_decoder/").StringDecoder),this._readableState.decoder=new x(U),this._readableState.encoding=U,this};function L(U,$){return U<=0||$.length===0&&$.ended?0:$.objectMode?1:U!=U?$.flowing&&$.length?$.buffer.head.data.length:$.length:(U>$.highWaterMark&&($.highWaterMark=function(Y){return Y>=8388608?Y=8388608:(Y--,Y|=Y>>>1,Y|=Y>>>2,Y|=Y>>>4,Y|=Y>>>8,Y|=Y>>>16,Y++),Y}(U)),U<=$.length?U:$.ended?$.length:($.needReadable=!0,0))}function q(U){var $=U._readableState;$.needReadable=!1,$.emittedReadable||(v("emitReadable",$.flowing),$.emittedReadable=!0,$.sync?c.nextTick(X,U):X(U))}function X(U){v("emit readable"),U.emit("readable"),E(U)}function H(U,$){$.readingMore||($.readingMore=!0,c.nextTick(M,U,$))}function M(U,$){for(var Y=$.length;!$.reading&&!$.flowing&&!$.ended&&$.length<$.highWaterMark&&(v("maybeReadMore read 0"),U.read(0),Y!==$.length);)Y=$.length;$.readingMore=!1}function F(U){v("readable nexttick read 0"),U.read(0)}function S(U,$){$.reading||(v("resume read 0"),U.read(0)),$.resumeScheduled=!1,$.awaitDrain=0,U.emit("resume"),E(U),$.flowing&&!$.reading&&U.read(0)}function E(U){var $=U._readableState;for(v("flow",$.flowing);$.flowing&&U.read()!==null;);}function N(U,$){return $.length===0?null:($.objectMode?Y=$.buffer.shift():!U||U>=$.length?(Y=$.decoder?$.buffer.join(""):$.buffer.length===1?$.buffer.head.data:$.buffer.concat($.length),$.buffer.clear()):Y=function(Z,re,G){var J;return Z<re.head.data.length?(J=re.head.data.slice(0,Z),re.head.data=re.head.data.slice(Z)):J=Z===re.head.data.length?re.shift():G?function(V,W){var ee=W.head,ie=1,oe=ee.data;for(V-=oe.length;ee=ee.next;){var se=ee.data,le=V>se.length?se.length:V;if(le===se.length?oe+=se:oe+=se.slice(0,V),(V-=le)===0){le===se.length?(++ie,ee.next?W.head=ee.next:W.head=W.tail=null):(W.head=ee,ee.data=se.slice(le));break}++ie}return W.length-=ie,oe}(Z,re):function(V,W){var ee=f.allocUnsafe(V),ie=W.head,oe=1;for(ie.data.copy(ee),V-=ie.data.length;ie=ie.next;){var se=ie.data,le=V>se.length?se.length:V;if(se.copy(ee,ee.length-V,0,le),(V-=le)===0){le===se.length?(++oe,ie.next?W.head=ie.next:W.head=W.tail=null):(W.head=ie,ie.data=se.slice(le));break}++oe}return W.length-=oe,ee}(Z,re),J}(U,$.buffer,$.decoder),Y);var Y}function C(U){var $=U._readableState;if($.length>0)throw new Error('"endReadable()" called on non-empty stream');$.endEmitted||($.ended=!0,c.nextTick(k,$,U))}function k(U,$){U.endEmitted||U.length!==0||(U.endEmitted=!0,$.readable=!1,$.emit("end"))}function I(U,$){for(var Y=0,Z=U.length;Y<Z;Y++)if(U[Y]===$)return Y;return-1}O.prototype.read=function(U){v("read",U),U=parseInt(U,10);var $=this._readableState,Y=U;if(U!==0&&($.emittedReadable=!1),U===0&&$.needReadable&&($.length>=$.highWaterMark||$.ended))return v("read: emitReadable",$.length,$.ended),$.length===0&&$.ended?C(this):q(this),null;if((U=L(U,$))===0&&$.ended)return $.length===0&&C(this),null;var Z,re=$.needReadable;return v("need readable",re),($.length===0||$.length-U<$.highWaterMark)&&v("length less than watermark",re=!0),$.ended||$.reading?v("reading or ended",re=!1):re&&(v("do read"),$.reading=!0,$.sync=!0,$.length===0&&($.needReadable=!0),this._read($.highWaterMark),$.sync=!1,$.reading||(U=L(Y,$))),(Z=U>0?N(U,$):null)===null?($.needReadable=!0,U=0):$.length-=U,$.length===0&&($.ended||($.needReadable=!0),Y!==U&&$.ended&&C(this)),Z!==null&&this.emit("data",Z),Z},O.prototype._read=function(U){this.emit("error",new Error("_read() is not implemented"))},O.prototype.pipe=function(U,$){var Y=this,Z=this._readableState;switch(Z.pipesCount){case 0:Z.pipes=U;break;case 1:Z.pipes=[Z.pipes,U];break;default:Z.pipes.push(U)}Z.pipesCount+=1,v("pipe count=%d opts=%j",Z.pipesCount,$);var re=(!$||$.end!==!1)&&U!==i.stdout&&U!==i.stderr?J:ye;function G(ue,ne){v("onunpipe"),ue===Y&&ne&&ne.hasUnpiped===!1&&(ne.hasUnpiped=!0,v("cleanup"),U.removeListener("close",se),U.removeListener("finish",le),U.removeListener("drain",V),U.removeListener("error",oe),U.removeListener("unpipe",G),Y.removeListener("end",J),Y.removeListener("end",ye),Y.removeListener("data",ie),W=!0,!Z.awaitDrain||U._writableState&&!U._writableState.needDrain||V())}function J(){v("onend"),U.end()}Z.endEmitted?c.nextTick(re):Y.once("end",re),U.on("unpipe",G);var V=function(ue){return function(){var ne=ue._readableState;v("pipeOnDrain",ne.awaitDrain),ne.awaitDrain&&ne.awaitDrain--,ne.awaitDrain===0&&u(ue,"data")&&(ne.flowing=!0,E(ue))}}(Y);U.on("drain",V);var W=!1,ee=!1;function ie(ue){v("ondata"),ee=!1,U.write(ue)!==!1||ee||((Z.pipesCount===1&&Z.pipes===U||Z.pipesCount>1&&I(Z.pipes,U)!==-1)&&!W&&(v("false write response, pause",Z.awaitDrain),Z.awaitDrain++,ee=!0),Y.pause())}function oe(ue){v("onerror",ue),ye(),U.removeListener("error",oe),u(U,"error")===0&&U.emit("error",ue)}function se(){U.removeListener("finish",le),ye()}function le(){v("onfinish"),U.removeListener("close",se),ye()}function ye(){v("unpipe"),Y.unpipe(U)}return Y.on("data",ie),function(ue,ne,pe){if(typeof ue.prependListener=="function")return ue.prependListener(ne,pe);ue._events&&ue._events[ne]?l(ue._events[ne])?ue._events[ne].unshift(pe):ue._events[ne]=[pe,ue._events[ne]]:ue.on(ne,pe)}(U,"error",oe),U.once("close",se),U.once("finish",le),U.emit("pipe",Y),Z.flowing||(v("pipe resume"),Y.resume()),U},O.prototype.unpipe=function(U){var $=this._readableState,Y={hasUnpiped:!1};if($.pipesCount===0)return this;if($.pipesCount===1)return U&&U!==$.pipes||(U||(U=$.pipes),$.pipes=null,$.pipesCount=0,$.flowing=!1,U&&U.emit("unpipe",this,Y)),this;if(!U){var Z=$.pipes,re=$.pipesCount;$.pipes=null,$.pipesCount=0,$.flowing=!1;for(var G=0;G<re;G++)Z[G].emit("unpipe",this,{hasUnpiped:!1});return this}var J=I($.pipes,U);return J===-1||($.pipes.splice(J,1),$.pipesCount-=1,$.pipesCount===1&&($.pipes=$.pipes[0]),U.emit("unpipe",this,Y)),this},O.prototype.on=function(U,$){var Y=h.prototype.on.call(this,U,$);if(U==="data")this._readableState.flowing!==!1&&this.resume();else if(U==="readable"){var Z=this._readableState;Z.endEmitted||Z.readableListening||(Z.readableListening=Z.needReadable=!0,Z.emittedReadable=!1,Z.reading?Z.length&&q(this):c.nextTick(F,this))}return Y},O.prototype.addListener=O.prototype.on,O.prototype.resume=function(){var U=this._readableState;return U.flowing||(v("resume"),U.flowing=!0,function($,Y){Y.resumeScheduled||(Y.resumeScheduled=!0,c.nextTick(S,$,Y))}(this,U)),this},O.prototype.pause=function(){return v("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(v("pause"),this._readableState.flowing=!1,this.emit("pause")),this},O.prototype.wrap=function(U){var $=this,Y=this._readableState,Z=!1;for(var re in U.on("end",function(){if(v("wrapped end"),Y.decoder&&!Y.ended){var J=Y.decoder.end();J&&J.length&&$.push(J)}$.push(null)}),U.on("data",function(J){v("wrapped data"),Y.decoder&&(J=Y.decoder.write(J)),Y.objectMode&&J==null||(Y.objectMode||J&&J.length)&&($.push(J)||(Z=!0,U.pause()))}),U)this[re]===void 0&&typeof U[re]=="function"&&(this[re]=function(J){return function(){return U[J].apply(U,arguments)}}(re));for(var G=0;G<j.length;G++)U.on(j[G],this.emit.bind(this,j[G]));return this._read=function(J){v("wrapped _read",J),Z&&(Z=!1,U.resume())},this},Object.defineProperty(O.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),O._fromList=N}).call(this)}).call(this,r("_process"),typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(r,s,a){s.exports=d;var i=r("./_stream_duplex"),o=Object.create(r("core-util-is"));function c(h,f){var m=this._transformState;m.transforming=!1;var p=m.writecb;if(!p)return this.emit("error",new Error("write callback called multiple times"));m.writechunk=null,m.writecb=null,f!=null&&this.push(f),p(h);var g=this._readableState;g.reading=!1,(g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}function d(h){if(!(this instanceof d))return new d(h);i.call(this,h),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,h&&(typeof h.transform=="function"&&(this._transform=h.transform),typeof h.flush=="function"&&(this._flush=h.flush)),this.on("prefinish",l)}function l(){var h=this;typeof this._flush=="function"?this._flush(function(f,m){u(h,f,m)}):u(this,null,null)}function u(h,f,m){if(f)return h.emit("error",f);if(m!=null&&h.push(m),h._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(h._transformState.transforming)throw new Error("Calling transform done when still transforming");return h.push(null)}o.inherits=r("inherits"),o.inherits(d,i),d.prototype.push=function(h,f){return this._transformState.needTransform=!1,i.prototype.push.call(this,h,f)},d.prototype._transform=function(h,f,m){throw new Error("_transform() is not implemented")},d.prototype._write=function(h,f,m){var p=this._transformState;if(p.writecb=m,p.writechunk=h,p.writeencoding=f,!p.transforming){var g=this._readableState;(p.needTransform||g.needReadable||g.length<g.highWaterMark)&&this._read(g.highWaterMark)}},d.prototype._read=function(h){var f=this._transformState;f.writechunk!==null&&f.writecb&&!f.transforming?(f.transforming=!0,this._transform(f.writechunk,f.writeencoding,f.afterTransform)):f.needTransform=!0},d.prototype._destroy=function(h,f){var m=this;i.prototype._destroy.call(this,h,function(p){f(p),m.emit("close")})}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(r,s,a){(function(i,o,c){(function(){var d=r("process-nextick-args");function l(H){var M=this;this.next=null,this.entry=null,this.finish=function(){(function(F,S,E){var N=F.entry;for(F.entry=null;N;){var C=N.callback;S.pendingcb--,C(E),N=N.next}S.corkedRequestsFree.next=F})(M,H)}}s.exports=T;var u,h=!i.browser&&["v0.10","v0.9."].indexOf(i.version.slice(0,5))>-1?c:d.nextTick;T.WritableState=j;var f=Object.create(r("core-util-is"));f.inherits=r("inherits");var m={deprecate:r("util-deprecate")},p=r("./internal/streams/stream"),g=r("safe-buffer").Buffer,v=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},x,y=r("./internal/streams/destroy");function b(){}function j(H,M){u=u||r("./_stream_duplex"),H=H||{};var F=M instanceof u;this.objectMode=!!H.objectMode,F&&(this.objectMode=this.objectMode||!!H.writableObjectMode);var S=H.highWaterMark,E=H.writableHighWaterMark,N=this.objectMode?16:16384;this.highWaterMark=S||S===0?S:F&&(E||E===0)?E:N,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var C=H.decodeStrings===!1;this.decodeStrings=!C,this.defaultEncoding=H.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(k){(function(I,U){var $=I._writableState,Y=$.sync,Z=$.writecb;if(function(G){G.writing=!1,G.writecb=null,G.length-=G.writelen,G.writelen=0}($),U)(function(G,J,V,W,ee){--J.pendingcb,V?(d.nextTick(ee,W),d.nextTick(X,G,J),G._writableState.errorEmitted=!0,G.emit("error",W)):(ee(W),G._writableState.errorEmitted=!0,G.emit("error",W),X(G,J))})(I,$,Y,U,Z);else{var re=L($);re||$.corked||$.bufferProcessing||!$.bufferedRequest||D(I,$),Y?h(R,I,$,re,Z):R(I,$,re,Z)}})(M,k)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new l(this)}function T(H){if(u=u||r("./_stream_duplex"),!(x.call(T,this)||this instanceof u))return new T(H);this._writableState=new j(H,this),this.writable=!0,H&&(typeof H.write=="function"&&(this._write=H.write),typeof H.writev=="function"&&(this._writev=H.writev),typeof H.destroy=="function"&&(this._destroy=H.destroy),typeof H.final=="function"&&(this._final=H.final)),p.call(this)}function O(H,M,F,S,E,N,C){M.writelen=S,M.writecb=C,M.writing=!0,M.sync=!0,F?H._writev(E,M.onwrite):H._write(E,N,M.onwrite),M.sync=!1}function R(H,M,F,S){F||function(E,N){N.length===0&&N.needDrain&&(N.needDrain=!1,E.emit("drain"))}(H,M),M.pendingcb--,S(),X(H,M)}function D(H,M){M.bufferProcessing=!0;var F=M.bufferedRequest;if(H._writev&&F&&F.next){var S=M.bufferedRequestCount,E=new Array(S),N=M.corkedRequestsFree;N.entry=F;for(var C=0,k=!0;F;)E[C]=F,F.isBuf||(k=!1),F=F.next,C+=1;E.allBuffers=k,O(H,M,!0,M.length,E,"",N.finish),M.pendingcb++,M.lastBufferedRequest=null,N.next?(M.corkedRequestsFree=N.next,N.next=null):M.corkedRequestsFree=new l(M),M.bufferedRequestCount=0}else{for(;F;){var I=F.chunk,U=F.encoding,$=F.callback;if(O(H,M,!1,M.objectMode?1:I.length,I,U,$),F=F.next,M.bufferedRequestCount--,M.writing)break}F===null&&(M.lastBufferedRequest=null)}M.bufferedRequest=F,M.bufferProcessing=!1}function L(H){return H.ending&&H.length===0&&H.bufferedRequest===null&&!H.finished&&!H.writing}function q(H,M){H._final(function(F){M.pendingcb--,F&&H.emit("error",F),M.prefinished=!0,H.emit("prefinish"),X(H,M)})}function X(H,M){var F=L(M);return F&&(function(S,E){E.prefinished||E.finalCalled||(typeof S._final=="function"?(E.pendingcb++,E.finalCalled=!0,d.nextTick(q,S,E)):(E.prefinished=!0,S.emit("prefinish")))}(H,M),M.pendingcb===0&&(M.finished=!0,H.emit("finish"))),F}f.inherits(T,p),j.prototype.getBuffer=function(){for(var H=this.bufferedRequest,M=[];H;)M.push(H),H=H.next;return M},function(){try{Object.defineProperty(j.prototype,"buffer",{get:m.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(x=Function.prototype[Symbol.hasInstance],Object.defineProperty(T,Symbol.hasInstance,{value:function(H){return!!x.call(this,H)||this===T&&H&&H._writableState instanceof j}})):x=function(H){return H instanceof this},T.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},T.prototype.write=function(H,M,F){var S,E=this._writableState,N=!1,C=!E.objectMode&&(S=H,g.isBuffer(S)||S instanceof v);return C&&!g.isBuffer(H)&&(H=function(k){return g.from(k)}(H)),typeof M=="function"&&(F=M,M=null),C?M="buffer":M||(M=E.defaultEncoding),typeof F!="function"&&(F=b),E.ended?function(k,I){var U=new Error("write after end");k.emit("error",U),d.nextTick(I,U)}(this,F):(C||function(k,I,U,$){var Y=!0,Z=!1;return U===null?Z=new TypeError("May not write null values to stream"):typeof U=="string"||U===void 0||I.objectMode||(Z=new TypeError("Invalid non-string/buffer chunk")),Z&&(k.emit("error",Z),d.nextTick($,Z),Y=!1),Y}(this,E,H,F))&&(E.pendingcb++,N=function(k,I,U,$,Y,Z){if(!U){var re=function(W,ee,ie){return W.objectMode||W.decodeStrings===!1||typeof ee!="string"||(ee=g.from(ee,ie)),ee}(I,$,Y);$!==re&&(U=!0,Y="buffer",$=re)}var G=I.objectMode?1:$.length;I.length+=G;var J=I.length<I.highWaterMark;if(J||(I.needDrain=!0),I.writing||I.corked){var V=I.lastBufferedRequest;I.lastBufferedRequest={chunk:$,encoding:Y,isBuf:U,callback:Z,next:null},V?V.next=I.lastBufferedRequest:I.bufferedRequest=I.lastBufferedRequest,I.bufferedRequestCount+=1}else O(k,I,!1,G,$,Y,Z);return J}(this,E,C,H,M,F)),N},T.prototype.cork=function(){this._writableState.corked++},T.prototype.uncork=function(){var H=this._writableState;H.corked&&(H.corked--,H.writing||H.corked||H.bufferProcessing||!H.bufferedRequest||D(this,H))},T.prototype.setDefaultEncoding=function(H){if(typeof H=="string"&&(H=H.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((H+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+H);return this._writableState.defaultEncoding=H,this},Object.defineProperty(T.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),T.prototype._write=function(H,M,F){F(new Error("_write() is not implemented"))},T.prototype._writev=null,T.prototype.end=function(H,M,F){var S=this._writableState;typeof H=="function"?(F=H,H=null,M=null):typeof M=="function"&&(F=M,M=null),H!=null&&this.write(H,M),S.corked&&(S.corked=1,this.uncork()),S.ending||function(E,N,C){N.ending=!0,X(E,N),C&&(N.finished?d.nextTick(C):E.once("finish",C)),N.ended=!0,E.writable=!1}(this,S,F)},Object.defineProperty(T.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(H){this._writableState&&(this._writableState.destroyed=H)}}),T.prototype.destroy=y.destroy,T.prototype._undestroy=y.undestroy,T.prototype._destroy=function(H,M){this.end(),M(H)}}).call(this)}).call(this,r("_process"),typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{},r("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(r,s,a){var i=r("safe-buffer").Buffer,o=r("util");s.exports=function(){function c(){(function(d,l){if(!(d instanceof l))throw new TypeError("Cannot call a class as a function")})(this,c),this.head=null,this.tail=null,this.length=0}return c.prototype.push=function(d){var l={data:d,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length},c.prototype.unshift=function(d){var l={data:d,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length},c.prototype.shift=function(){if(this.length!==0){var d=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,d}},c.prototype.clear=function(){this.head=this.tail=null,this.length=0},c.prototype.join=function(d){if(this.length===0)return"";for(var l=this.head,u=""+l.data;l=l.next;)u+=d+l.data;return u},c.prototype.concat=function(d){if(this.length===0)return i.alloc(0);for(var l,u,h,f=i.allocUnsafe(d>>>0),m=this.head,p=0;m;)l=m.data,u=f,h=p,l.copy(u,h),p+=m.data.length,m=m.next;return f},c}(),o&&o.inspect&&o.inspect.custom&&(s.exports.prototype[o.inspect.custom]=function(){var c=o.inspect({length:this.length});return this.constructor.name+" "+c})},{"safe-buffer":520,util:188}],514:[function(r,s,a){var i=r("process-nextick-args");function o(c,d){c.emit("error",d)}s.exports={destroy:function(c,d){var l=this,u=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return u||h?(d?d(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,i.nextTick(o,this,c)):i.nextTick(o,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,function(f){!d&&f?l._writableState?l._writableState.errorEmitted||(l._writableState.errorEmitted=!0,i.nextTick(o,l,f)):i.nextTick(o,l,f):d&&d(f)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(r,s,a){arguments[4][490][0].apply(a,arguments)},{dup:490,events:422}],516:[function(r,s,a){s.exports=r("./readable").PassThrough},{"./readable":517}],517:[function(r,s,a){(a=s.exports=r("./lib/_stream_readable.js")).Stream=a,a.Readable=a,a.Writable=r("./lib/_stream_writable.js"),a.Duplex=r("./lib/_stream_duplex.js"),a.Transform=r("./lib/_stream_transform.js"),a.PassThrough=r("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(r,s,a){s.exports=r("./readable").Transform},{"./readable":517}],519:[function(r,s,a){s.exports=r("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(r,s,a){arguments[4][217][0].apply(a,arguments)},{buffer:220,dup:217}],521:[function(r,s,a){arguments[4][218][0].apply(a,arguments)},{dup:218,"safe-buffer":520}],522:[function(r,s,a){arguments[4][218][0].apply(a,arguments)},{dup:218,"safe-buffer":494}],523:[function(r,s,a){(function(i,o){(function(){var c=r("process/browser.js").nextTick,d=Function.prototype.apply,l=Array.prototype.slice,u={},h=0;function f(m,p){this._id=m,this._clearFn=p}a.setTimeout=function(){return new f(d.call(setTimeout,window,arguments),clearTimeout)},a.setInterval=function(){return new f(d.call(setInterval,window,arguments),clearInterval)},a.clearTimeout=a.clearInterval=function(m){m.close()},f.prototype.unref=f.prototype.ref=function(){},f.prototype.close=function(){this._clearFn.call(window,this._id)},a.enroll=function(m,p){clearTimeout(m._idleTimeoutId),m._idleTimeout=p},a.unenroll=function(m){clearTimeout(m._idleTimeoutId),m._idleTimeout=-1},a._unrefActive=a.active=function(m){clearTimeout(m._idleTimeoutId);var p=m._idleTimeout;p>=0&&(m._idleTimeoutId=setTimeout(function(){m._onTimeout&&m._onTimeout()},p))},a.setImmediate=typeof i=="function"?i:function(m){var p=h++,g=!(arguments.length<2)&&l.call(arguments,1);return u[p]=!0,c(function(){u[p]&&(g?m.apply(null,g):m.call(null),a.clearImmediate(p))}),p},a.clearImmediate=typeof o=="function"?o:function(m){delete u[m]}}).call(this)}).call(this,r("timers").setImmediate,r("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(r,s,a){(function(i){(function(){function o(c){try{if(!i.localStorage)return!1}catch{return!1}var d=i.localStorage[c];return d!=null&&String(d).toLowerCase()==="true"}s.exports=function(c,d){if(o("noDeprecation"))return c;var l=!1;return function(){if(!l){if(o("throwDeprecation"))throw new Error(d);o("traceDeprecation")?console.trace(d):console.warn(d),l=!0}return c.apply(this,arguments)}}}).call(this)}).call(this,typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(r,s,a){typeof Object.create=="function"?s.exports=function(i,o){i.super_=o,i.prototype=Object.create(o.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}})}:s.exports=function(i,o){i.super_=o;var c=function(){};c.prototype=o.prototype,i.prototype=new c,i.prototype.constructor=i}},{}],526:[function(r,s,a){s.exports=function(i){return i&&typeof i=="object"&&typeof i.copy=="function"&&typeof i.fill=="function"&&typeof i.readUInt8=="function"}},{}],527:[function(r,s,a){(function(i,o){(function(){var c=/%[sdj%]/g;a.format=function(E){if(!j(E)){for(var N=[],C=0;C<arguments.length;C++)N.push(u(arguments[C]));return N.join(" ")}C=1;for(var k=arguments,I=k.length,U=String(E).replace(c,function(Y){if(Y==="%%")return"%";if(C>=I)return Y;switch(Y){case"%s":return String(k[C++]);case"%d":return Number(k[C++]);case"%j":try{return JSON.stringify(k[C++])}catch{return"[Circular]"}default:return Y}}),$=k[C];C<I;$=k[++C])y($)||!R($)?U+=" "+$:U+=" "+u($);return U},a.deprecate=function(E,N){if(T(o.process))return function(){return a.deprecate(E,N).apply(this,arguments)};if(i.noDeprecation===!0)return E;var C=!1;return function(){if(!C){if(i.throwDeprecation)throw new Error(N);i.traceDeprecation?console.trace(N):console.error(N),C=!0}return E.apply(this,arguments)}};var d,l={};function u(E,N){var C={seen:[],stylize:f};return arguments.length>=3&&(C.depth=arguments[2]),arguments.length>=4&&(C.colors=arguments[3]),x(N)?C.showHidden=N:N&&a._extend(C,N),T(C.showHidden)&&(C.showHidden=!1),T(C.depth)&&(C.depth=2),T(C.colors)&&(C.colors=!1),T(C.customInspect)&&(C.customInspect=!0),C.colors&&(C.stylize=h),m(C,E,C.depth)}function h(E,N){var C=u.styles[N];return C?"\x1B["+u.colors[C][0]+"m"+E+"\x1B["+u.colors[C][1]+"m":E}function f(E,N){return E}function m(E,N,C){if(E.customInspect&&N&&q(N.inspect)&&N.inspect!==a.inspect&&(!N.constructor||N.constructor.prototype!==N)){var k=N.inspect(C,E);return j(k)||(k=m(E,k,C)),k}var I=function(V,W){if(T(W))return V.stylize("undefined","undefined");if(j(W)){var ee="'"+JSON.stringify(W).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return V.stylize(ee,"string")}if(b(W))return V.stylize(""+W,"number");if(x(W))return V.stylize(""+W,"boolean");if(y(W))return V.stylize("null","null")}(E,N);if(I)return I;var U=Object.keys(N),$=function(V){var W={};return V.forEach(function(ee,ie){W[ee]=!0}),W}(U);if(E.showHidden&&(U=Object.getOwnPropertyNames(N)),L(N)&&(U.indexOf("message")>=0||U.indexOf("description")>=0))return p(N);if(U.length===0){if(q(N)){var Y=N.name?": "+N.name:"";return E.stylize("[Function"+Y+"]","special")}if(O(N))return E.stylize(RegExp.prototype.toString.call(N),"regexp");if(D(N))return E.stylize(Date.prototype.toString.call(N),"date");if(L(N))return p(N)}var Z,re="",G=!1,J=["{","}"];return v(N)&&(G=!0,J=["[","]"]),q(N)&&(re=" [Function"+(N.name?": "+N.name:"")+"]"),O(N)&&(re=" "+RegExp.prototype.toString.call(N)),D(N)&&(re=" "+Date.prototype.toUTCString.call(N)),L(N)&&(re=" "+p(N)),U.length!==0||G&&N.length!=0?C<0?O(N)?E.stylize(RegExp.prototype.toString.call(N),"regexp"):E.stylize("[Object]","special"):(E.seen.push(N),Z=G?function(V,W,ee,ie,oe){for(var se=[],le=0,ye=W.length;le<ye;++le)S(W,String(le))?se.push(g(V,W,ee,ie,String(le),!0)):se.push("");return oe.forEach(function(ue){ue.match(/^\d+$/)||se.push(g(V,W,ee,ie,ue,!0))}),se}(E,N,C,$,U):U.map(function(V){return g(E,N,C,$,V,G)}),E.seen.pop(),function(V,W,ee){return V.reduce(function(ie,oe){return oe.indexOf(`
`)>=0,ie+oe.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?ee[0]+(W===""?"":W+`
 `)+" "+V.join(`,
  `)+" "+ee[1]:ee[0]+W+" "+V.join(", ")+" "+ee[1]}(Z,re,J)):J[0]+re+J[1]}function p(E){return"["+Error.prototype.toString.call(E)+"]"}function g(E,N,C,k,I,U){var $,Y,Z;if((Z=Object.getOwnPropertyDescriptor(N,I)||{value:N[I]}).get?Y=Z.set?E.stylize("[Getter/Setter]","special"):E.stylize("[Getter]","special"):Z.set&&(Y=E.stylize("[Setter]","special")),S(k,I)||($="["+I+"]"),Y||(E.seen.indexOf(Z.value)<0?(Y=y(C)?m(E,Z.value,null):m(E,Z.value,C-1)).indexOf(`
`)>-1&&(Y=U?Y.split(`
`).map(function(re){return"  "+re}).join(`
`).substr(2):`
`+Y.split(`
`).map(function(re){return"   "+re}).join(`
`)):Y=E.stylize("[Circular]","special")),T($)){if(U&&I.match(/^\d+$/))return Y;($=JSON.stringify(""+I)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?($=$.substr(1,$.length-2),$=E.stylize($,"name")):($=$.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),$=E.stylize($,"string"))}return $+": "+Y}function v(E){return Array.isArray(E)}function x(E){return typeof E=="boolean"}function y(E){return E===null}function b(E){return typeof E=="number"}function j(E){return typeof E=="string"}function T(E){return E===void 0}function O(E){return R(E)&&X(E)==="[object RegExp]"}function R(E){return typeof E=="object"&&E!==null}function D(E){return R(E)&&X(E)==="[object Date]"}function L(E){return R(E)&&(X(E)==="[object Error]"||E instanceof Error)}function q(E){return typeof E=="function"}function X(E){return Object.prototype.toString.call(E)}function H(E){return E<10?"0"+E.toString(10):E.toString(10)}a.debuglog=function(E){if(T(d)&&(d=i.env.NODE_DEBUG||""),E=E.toUpperCase(),!l[E])if(new RegExp("\\b"+E+"\\b","i").test(d)){var N=i.pid;l[E]=function(){var C=a.format.apply(a,arguments);console.error("%s %d: %s",E,N,C)}}else l[E]=function(){};return l[E]},a.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},a.isArray=v,a.isBoolean=x,a.isNull=y,a.isNullOrUndefined=function(E){return E==null},a.isNumber=b,a.isString=j,a.isSymbol=function(E){return typeof E=="symbol"},a.isUndefined=T,a.isRegExp=O,a.isObject=R,a.isDate=D,a.isError=L,a.isFunction=q,a.isPrimitive=function(E){return E===null||typeof E=="boolean"||typeof E=="number"||typeof E=="string"||typeof E=="symbol"||E===void 0},a.isBuffer=r("./support/isBuffer");var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function F(){var E=new Date,N=[H(E.getHours()),H(E.getMinutes()),H(E.getSeconds())].join(":");return[E.getDate(),M[E.getMonth()],N].join(" ")}function S(E,N){return Object.prototype.hasOwnProperty.call(E,N)}a.log=function(){console.log("%s - %s",F(),a.format.apply(a,arguments))},a.inherits=r("inherits"),a._extend=function(E,N){if(!N||!R(N))return E;for(var C=Object.keys(N),k=C.length;k--;)E[C[k]]=N[C[k]];return E}}).call(this)}).call(this,r("_process"),typeof Ur<"u"?Ur:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"v1",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(a,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(a,"v4",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(a,"v5",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(a,"NIL",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(a,"version",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(a,"validate",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(a,"stringify",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(a,"parse",{enumerable:!0,get:function(){return m.default}});var i=p(r("./v1.js")),o=p(r("./v3.js")),c=p(r("./v4.js")),d=p(r("./v5.js")),l=p(r("./nil.js")),u=p(r("./version.js")),h=p(r("./validate.js")),f=p(r("./stringify.js")),m=p(r("./parse.js"));function p(g){return g&&g.__esModule?g:{default:g}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(r,s,a){function i(m){return 14+(m+64>>>9<<4)+1}function o(m,p){const g=(65535&m)+(65535&p);return(m>>16)+(p>>16)+(g>>16)<<16|65535&g}function c(m,p,g,v,x,y){return o((b=o(o(p,m),o(v,y)))<<(j=x)|b>>>32-j,g);var b,j}function d(m,p,g,v,x,y,b){return c(p&g|~p&v,m,p,x,y,b)}function l(m,p,g,v,x,y,b){return c(p&v|g&~v,m,p,x,y,b)}function u(m,p,g,v,x,y,b){return c(p^g^v,m,p,x,y,b)}function h(m,p,g,v,x,y,b){return c(g^(p|~v),m,p,x,y,b)}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var f=function(m){if(typeof m=="string"){const p=unescape(encodeURIComponent(m));m=new Uint8Array(p.length);for(let g=0;g<p.length;++g)m[g]=p.charCodeAt(g)}return function(p){const g=[],v=32*p.length;for(let x=0;x<v;x+=8){const y=p[x>>5]>>>x%32&255,b=parseInt("0123456789abcdef".charAt(y>>>4&15)+"0123456789abcdef".charAt(15&y),16);g.push(b)}return g}(function(p,g){p[g>>5]|=128<<g%32,p[i(g)-1]=g;let v=1732584193,x=-271733879,y=-1732584194,b=271733878;for(let j=0;j<p.length;j+=16){const T=v,O=x,R=y,D=b;v=d(v,x,y,b,p[j],7,-680876936),b=d(b,v,x,y,p[j+1],12,-389564586),y=d(y,b,v,x,p[j+2],17,606105819),x=d(x,y,b,v,p[j+3],22,-1044525330),v=d(v,x,y,b,p[j+4],7,-176418897),b=d(b,v,x,y,p[j+5],12,1200080426),y=d(y,b,v,x,p[j+6],17,-1473231341),x=d(x,y,b,v,p[j+7],22,-45705983),v=d(v,x,y,b,p[j+8],7,1770035416),b=d(b,v,x,y,p[j+9],12,-1958414417),y=d(y,b,v,x,p[j+10],17,-42063),x=d(x,y,b,v,p[j+11],22,-1990404162),v=d(v,x,y,b,p[j+12],7,1804603682),b=d(b,v,x,y,p[j+13],12,-40341101),y=d(y,b,v,x,p[j+14],17,-1502002290),x=d(x,y,b,v,p[j+15],22,1236535329),v=l(v,x,y,b,p[j+1],5,-165796510),b=l(b,v,x,y,p[j+6],9,-1069501632),y=l(y,b,v,x,p[j+11],14,643717713),x=l(x,y,b,v,p[j],20,-373897302),v=l(v,x,y,b,p[j+5],5,-701558691),b=l(b,v,x,y,p[j+10],9,38016083),y=l(y,b,v,x,p[j+15],14,-660478335),x=l(x,y,b,v,p[j+4],20,-405537848),v=l(v,x,y,b,p[j+9],5,568446438),b=l(b,v,x,y,p[j+14],9,-1019803690),y=l(y,b,v,x,p[j+3],14,-187363961),x=l(x,y,b,v,p[j+8],20,1163531501),v=l(v,x,y,b,p[j+13],5,-1444681467),b=l(b,v,x,y,p[j+2],9,-51403784),y=l(y,b,v,x,p[j+7],14,1735328473),x=l(x,y,b,v,p[j+12],20,-1926607734),v=u(v,x,y,b,p[j+5],4,-378558),b=u(b,v,x,y,p[j+8],11,-2022574463),y=u(y,b,v,x,p[j+11],16,1839030562),x=u(x,y,b,v,p[j+14],23,-35309556),v=u(v,x,y,b,p[j+1],4,-1530992060),b=u(b,v,x,y,p[j+4],11,1272893353),y=u(y,b,v,x,p[j+7],16,-155497632),x=u(x,y,b,v,p[j+10],23,-1094730640),v=u(v,x,y,b,p[j+13],4,681279174),b=u(b,v,x,y,p[j],11,-358537222),y=u(y,b,v,x,p[j+3],16,-722521979),x=u(x,y,b,v,p[j+6],23,76029189),v=u(v,x,y,b,p[j+9],4,-640364487),b=u(b,v,x,y,p[j+12],11,-421815835),y=u(y,b,v,x,p[j+15],16,530742520),x=u(x,y,b,v,p[j+2],23,-995338651),v=h(v,x,y,b,p[j],6,-198630844),b=h(b,v,x,y,p[j+7],10,1126891415),y=h(y,b,v,x,p[j+14],15,-1416354905),x=h(x,y,b,v,p[j+5],21,-57434055),v=h(v,x,y,b,p[j+12],6,1700485571),b=h(b,v,x,y,p[j+3],10,-1894986606),y=h(y,b,v,x,p[j+10],15,-1051523),x=h(x,y,b,v,p[j+1],21,-2054922799),v=h(v,x,y,b,p[j+8],6,1873313359),b=h(b,v,x,y,p[j+15],10,-30611744),y=h(y,b,v,x,p[j+6],15,-1560198380),x=h(x,y,b,v,p[j+13],21,1309151649),v=h(v,x,y,b,p[j+4],6,-145523070),b=h(b,v,x,y,p[j+11],10,-1120210379),y=h(y,b,v,x,p[j+2],15,718787259),x=h(x,y,b,v,p[j+9],21,-343485551),v=o(v,T),x=o(x,O),y=o(y,R),b=o(b,D)}return[v,x,y,b]}(function(p){if(p.length===0)return[];const g=8*p.length,v=new Uint32Array(i(g));for(let x=0;x<g;x+=8)v[x>>5]|=(255&p[x/8])<<x%32;return v}(m),8*m.length))};a.default=f},{}],530:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=r("./validate.js"))&&i.__esModule?i:{default:i},c=function(d){if(!(0,o.default)(d))throw TypeError("Invalid UUID");let l;const u=new Uint8Array(16);return u[0]=(l=parseInt(d.slice(0,8),16))>>>24,u[1]=l>>>16&255,u[2]=l>>>8&255,u[3]=255&l,u[4]=(l=parseInt(d.slice(9,13),16))>>>8,u[5]=255&l,u[6]=(l=parseInt(d.slice(14,18),16))>>>8,u[7]=255&l,u[8]=(l=parseInt(d.slice(19,23),16))>>>8,u[9]=255&l,u[10]=(l=parseInt(d.slice(24,36),16))/1099511627776&255,u[11]=l/4294967296&255,u[12]=l>>>24&255,u[13]=l>>>16&255,u[14]=l>>>8&255,u[15]=255&l,u};a.default=c},{"./validate.js":541}],532:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0,a.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(r,s,a){let i;Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(){if(!i&&(i=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!i))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return i(o)};const o=new Uint8Array(16)},{}],534:[function(r,s,a){function i(d,l,u,h){switch(d){case 0:return l&u^~l&h;case 1:return l^u^h;case 2:return l&u^l&h^u&h;case 3:return l^u^h}}function o(d,l){return d<<l|d>>>32-l}Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var c=function(d){const l=[1518500249,1859775393,2400959708,3395469782],u=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof d=="string"){const p=unescape(encodeURIComponent(d));d=[];for(let g=0;g<p.length;++g)d.push(p.charCodeAt(g))}else Array.isArray(d)||(d=Array.prototype.slice.call(d));d.push(128);const h=d.length/4+2,f=Math.ceil(h/16),m=new Array(f);for(let p=0;p<f;++p){const g=new Uint32Array(16);for(let v=0;v<16;++v)g[v]=d[64*p+4*v]<<24|d[64*p+4*v+1]<<16|d[64*p+4*v+2]<<8|d[64*p+4*v+3];m[p]=g}m[f-1][14]=8*(d.length-1)/Math.pow(2,32),m[f-1][14]=Math.floor(m[f-1][14]),m[f-1][15]=8*(d.length-1)&4294967295;for(let p=0;p<f;++p){const g=new Uint32Array(80);for(let T=0;T<16;++T)g[T]=m[p][T];for(let T=16;T<80;++T)g[T]=o(g[T-3]^g[T-8]^g[T-14]^g[T-16],1);let v=u[0],x=u[1],y=u[2],b=u[3],j=u[4];for(let T=0;T<80;++T){const O=Math.floor(T/20),R=o(v,5)+i(O,x,y,b)+j+l[O]+g[T]>>>0;j=b,b=y,y=o(x,30)>>>0,x=v,v=R}u[0]=u[0]+v>>>0,u[1]=u[1]+x>>>0,u[2]=u[2]+y>>>0,u[3]=u[3]+b>>>0,u[4]=u[4]+j>>>0}return[u[0]>>24&255,u[0]>>16&255,u[0]>>8&255,255&u[0],u[1]>>24&255,u[1]>>16&255,u[1]>>8&255,255&u[1],u[2]>>24&255,u[2]>>16&255,u[2]>>8&255,255&u[2],u[3]>>24&255,u[3]>>16&255,u[3]>>8&255,255&u[3],u[4]>>24&255,u[4]>>16&255,u[4]>>8&255,255&u[4]]};a.default=c},{}],535:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=r("./validate.js"))&&i.__esModule?i:{default:i};const c=[];for(let l=0;l<256;++l)c.push((l+256).toString(16).substr(1));var d=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const h=(c[l[u+0]]+c[l[u+1]]+c[l[u+2]]+c[l[u+3]]+"-"+c[l[u+4]]+c[l[u+5]]+"-"+c[l[u+6]]+c[l[u+7]]+"-"+c[l[u+8]]+c[l[u+9]]+"-"+c[l[u+10]]+c[l[u+11]]+c[l[u+12]]+c[l[u+13]]+c[l[u+14]]+c[l[u+15]]).toLowerCase();if(!(0,o.default)(h))throw TypeError("Stringified UUID is invalid");return h};a.default=d},{"./validate.js":541}],536:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(r("./rng.js")),o=c(r("./stringify.js"));function c(m){return m&&m.__esModule?m:{default:m}}let d,l,u=0,h=0;var f=function(m,p,g){let v=p&&g||0;const x=p||new Array(16);let y=(m=m||{}).node||d,b=m.clockseq!==void 0?m.clockseq:l;if(y==null||b==null){const L=m.random||(m.rng||i.default)();y==null&&(y=d=[1|L[0],L[1],L[2],L[3],L[4],L[5]]),b==null&&(b=l=16383&(L[6]<<8|L[7]))}let j=m.msecs!==void 0?m.msecs:Date.now(),T=m.nsecs!==void 0?m.nsecs:h+1;const O=j-u+(T-h)/1e4;if(O<0&&m.clockseq===void 0&&(b=b+1&16383),(O<0||j>u)&&m.nsecs===void 0&&(T=0),T>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=j,h=T,l=b,j+=122192928e5;const R=(1e4*(268435455&j)+T)%4294967296;x[v++]=R>>>24&255,x[v++]=R>>>16&255,x[v++]=R>>>8&255,x[v++]=255&R;const D=j/4294967296*1e4&268435455;x[v++]=D>>>8&255,x[v++]=255&D,x[v++]=D>>>24&15|16,x[v++]=D>>>16&255,x[v++]=b>>>8|128,x[v++]=255&b;for(let L=0;L<6;++L)x[v+L]=y[L];return p||(0,o.default)(x)};a.default=f},{"./rng.js":533,"./stringify.js":535}],537:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(r("./v35.js")),o=c(r("./md5.js"));function c(l){return l&&l.__esModule?l:{default:l}}var d=(0,i.default)("v3",48,o.default);a.default=d},{"./md5.js":529,"./v35.js":538}],538:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(u,h,f){function m(p,g,v,x){if(typeof p=="string"&&(p=function(b){b=unescape(encodeURIComponent(b));const j=[];for(let T=0;T<b.length;++T)j.push(b.charCodeAt(T));return j}(p)),typeof g=="string"&&(g=(0,o.default)(g)),g.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let y=new Uint8Array(16+p.length);if(y.set(g),y.set(p,g.length),y=f(y),y[6]=15&y[6]|h,y[8]=63&y[8]|128,v){x=x||0;for(let b=0;b<16;++b)v[x+b]=y[b];return v}return(0,i.default)(y)}try{m.name=u}catch{}return m.DNS=d,m.URL=l,m},a.URL=a.DNS=void 0;var i=c(r("./stringify.js")),o=c(r("./parse.js"));function c(u){return u&&u.__esModule?u:{default:u}}const d="6ba7b810-9dad-11d1-80b4-00c04fd430c8";a.DNS=d;const l="6ba7b811-9dad-11d1-80b4-00c04fd430c8";a.URL=l},{"./parse.js":531,"./stringify.js":535}],539:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(r("./rng.js")),o=c(r("./stringify.js"));function c(l){return l&&l.__esModule?l:{default:l}}var d=function(l,u,h){const f=(l=l||{}).random||(l.rng||i.default)();if(f[6]=15&f[6]|64,f[8]=63&f[8]|128,u){h=h||0;for(let m=0;m<16;++m)u[h+m]=f[m];return u}return(0,o.default)(f)};a.default=d},{"./rng.js":533,"./stringify.js":535}],540:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=c(r("./v35.js")),o=c(r("./sha1.js"));function c(l){return l&&l.__esModule?l:{default:l}}var d=(0,i.default)("v5",80,o.default);a.default=d},{"./sha1.js":534,"./v35.js":538}],541:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=r("./regex.js"))&&i.__esModule?i:{default:i},c=function(d){return typeof d=="string"&&o.default.test(d)};a.default=c},{"./regex.js":532}],542:[function(r,s,a){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i,o=(i=r("./validate.js"))&&i.__esModule?i:{default:i},c=function(d){if(!(0,o.default)(d))throw TypeError("Invalid UUID");return parseInt(d.substr(14,1),16)};a.default=c},{"./validate.js":541}],543:[function(r,s,a){/**
* Character classes and associated utilities for the 5th edition of XML 1.0.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(a,"__esModule",{value:!0}),a.CHAR=`	
\r ---`,a.S=` 	\r
`,a.NAME_START_CHAR=":A-Z_a-z-----------",a.NAME_CHAR="-"+a.NAME_START_CHAR+".0-9--",a.CHAR_RE=new RegExp("^["+a.CHAR+"]$","u"),a.S_RE=new RegExp("^["+a.S+"]+$","u"),a.NAME_START_CHAR_RE=new RegExp("^["+a.NAME_START_CHAR+"]$","u"),a.NAME_CHAR_RE=new RegExp("^["+a.NAME_CHAR+"]$","u"),a.NAME_RE=new RegExp("^["+a.NAME_START_CHAR+"]["+a.NAME_CHAR+"]*$","u"),a.NMTOKEN_RE=new RegExp("^["+a.NAME_CHAR+"]+$","u");function i(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}a.S_LIST=[32,10,13,9],a.isChar=function(o){return o>=32&&o<=55295||o===10||o===13||o===9||o>=57344&&o<=65533||o>=65536&&o<=1114111},a.isS=function(o){return o===32||o===10||o===13||o===9},a.isNameStartChar=i,a.isNameChar=function(o){return i(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],544:[function(r,s,a){/**
* Character classes and associated utilities for the 2nd edition of XML 1.1.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/Object.defineProperty(a,"__esModule",{value:!0}),a.CHAR="---",a.RESTRICTED_CHAR="-\b\v\f---",a.S=` 	\r
`,a.NAME_START_CHAR=":A-Z_a-z-----------",a.NAME_CHAR="-"+a.NAME_START_CHAR+".0-9--",a.CHAR_RE=new RegExp("^["+a.CHAR+"]$","u"),a.RESTRICTED_CHAR_RE=new RegExp("^["+a.RESTRICTED_CHAR+"]$","u"),a.S_RE=new RegExp("^["+a.S+"]+$","u"),a.NAME_START_CHAR_RE=new RegExp("^["+a.NAME_START_CHAR+"]$","u"),a.NAME_CHAR_RE=new RegExp("^["+a.NAME_CHAR+"]$","u"),a.NAME_RE=new RegExp("^["+a.NAME_START_CHAR+"]["+a.NAME_CHAR+"]*$","u"),a.NMTOKEN_RE=new RegExp("^["+a.NAME_CHAR+"]+$","u");function i(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}a.S_LIST=[32,10,13,9],a.isChar=function(o){return o>=1&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},a.isRestrictedChar=function(o){return o>=1&&o<=8||o===11||o===12||o>=14&&o<=31||o>=127&&o<=132||o>=134&&o<=159},a.isCharAndNotRestricted=function(o){return o===9||o===10||o===13||o>31&&o<127||o===133||o>159&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},a.isS=function(o){return o===32||o===10||o===13||o===9},a.isNameStartChar=i,a.isNameChar=function(o){return i(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],545:[function(r,s,a){/**
* Character class utilities for XML NS 1.0 edition 3.
*
* @author Louis-Dominique Dubeau
* @license MIT
* @copyright Louis-Dominique Dubeau
*/function i(o){return o>=65&&o<=90||o===95||o>=97&&o<=122||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8204&&o<=8205||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}Object.defineProperty(a,"__esModule",{value:!0}),a.NC_NAME_START_CHAR="A-Z_a-z------------",a.NC_NAME_CHAR="-"+a.NC_NAME_START_CHAR+".0-9--",a.NC_NAME_START_CHAR_RE=new RegExp("^["+a.NC_NAME_START_CHAR+"]$","u"),a.NC_NAME_CHAR_RE=new RegExp("^["+a.NC_NAME_CHAR+"]$","u"),a.NC_NAME_RE=new RegExp("^["+a.NC_NAME_START_CHAR+"]["+a.NC_NAME_CHAR+"]*$","u"),a.isNCNameStartChar=i,a.isNCNameChar=function(o){return i(o)||o===45||o===46||o>=48&&o<=57||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}]},{},[15])(15)})})(rK);var g_e=rK.exports;const mv=On(g_e);function x_e(e,t,r){const s={...r||{}},a=e||{};for(const i of Object.keys(t)){const o=a[i]||0,d=(t[i]||0)-o;if(d<0){const l=Math.abs(d);s[i]=Math.max(0,(s[i]||0)-l)}}for(const i of Object.keys(s))s[i]===0&&delete s[i];return s}function v_e(e,t){const r=e||{},s=t||{},a={};for(const i of Object.keys(r)){const o=r[i]||0,c=s[i]||0;a[i]=Math.max(0,o-c)}return a}const y_e=["PP","P","M","G","GG","XG","XXG","XXXG","UN","U","UNICO","NICO","34","35","36","37","38","39","40","41","42","43","44","45","46","48","50","52"],b_e=["QT","QTDE","QUANTIDADE","TOTAL","SALDO"];function w_e(e){const t=e.trim().toUpperCase();return t==="U"||t==="UNICO"||t==="NICO"?"UN":t}function __e(e){const t=e.trim().toUpperCase();return b_e.includes(t)}function Q3(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}const UM={preto:"Preto",branco:"Branco",bege:"Bege",rosa:"Rosa",azul:"Azul",verde:"Verde",vermelho:"Vermelho",marrom:"Marrom",cinza:"Cinza",estampado:"Estampado","off white":"Off White",offwhite:"Off White","off-white":"Off White",chocolate:"Chocolate",menta:"Menta",nude:"Nude",caramelo:"Caramelo",mostarda:"Mostarda",vinho:"Vinho",laranja:"Laranja",amarelo:"Amarelo",lilas:"Lils",lils:"Lils",roxo:"Roxo",coral:"Coral"};function j_e(e){if(!e)return e;const t=e.trim().toLowerCase();return UM[t]?UM[t]:e.trim().split(/\s+/).map(r=>r.charAt(0).toUpperCase()+r.slice(1).toLowerCase()).join(" ")}function I8(e){if(e==null||e==="")return null;if(typeof e=="number")return isNaN(e)?null:e;let t=String(e).trim();if(t==="")return null;t=t.replace(/[R$\s]/g,"");const r=t.lastIndexOf(","),s=t.lastIndexOf(".");r>s&&r!==-1?(t=t.replace(/\./g,""),t=t.replace(",",".")):(s!==-1||r===-1)&&(t=t.replace(/,/g,""));const i=parseFloat(t);return isNaN(i)?null:i}function N_e(e){const t=I8(e);return t===null?0:t>1e4?(console.log(`[parsePrice] Auto-converting from centavos: ${t} -> ${t/100}`),t/100):t}function S_e(e){const t=I8(e);if(t===null)return 0;const r=Math.trunc(t);return r<0?0:r}function C_e(){var $,Y;const e=fr(),{user:t,isLoading:r,rolesLoading:s,isMerchant:a}=Hn(),[i,o]=P.useState(null),[c,d]=P.useState([]),[l,u]=P.useState(!1),[h,f]=P.useState(!1),[m,p]=P.useState(!1),[g,v]=P.useState([]),[x,y]=P.useState(!1),[b,j]=P.useState(!0),[T,O]=P.useState({updatedCount:0,createdCount:0,negativeValuesWarning:!1,showResult:!1}),[R,D]=P.useState(!1),[L,q]=P.useState(0);P.useEffect(()=>{!r&&!s&&(!t||!a())&&e("/login")},[t,r,s,a,e]),P.useEffect(()=>{t&&X()},[t]);const X=async()=>{const{data:Z,error:re}=await ce.from("inventory_imports").select("id, filename, total_rows, matched_count, unmatched_count, created_at").order("created_at",{ascending:!1}).limit(20);!re&&Z&&v(Z)},H=P.useCallback(Z=>{var G;const re=(G=Z.target.files)==null?void 0:G[0];re&&(o(re),p(!1),d([]))},[]),M=async()=>{if(i){u(!0);try{const Z=await i.arrayBuffer(),re=new mv.Workbook;await re.xlsx.load(Z);const G=re.worksheets[0];if(!G){de.error("Planilha vazia"),u(!1);return}const J=[];G.eachRow({includeEmpty:!1},Ne=>{J.push(Ne.values?Ne.values.slice(1):[])});const V=J[0]||[],W=Ne=>String(Ne??"").trim(),ee=Ne=>W(Ne).toUpperCase();let ie=V.findIndex(Ne=>ee(Ne)==="REFERE");ie===-1&&(ie=V.findIndex(Ne=>ee(Ne).includes("REFERENCIA")));const oe=V.findIndex(Ne=>ee(Ne).includes("TIPODESC")),se=V.findIndex(Ne=>ee(Ne).includes("COR1DESC")),le=V.findIndex(Ne=>ee(Ne).includes("PRCVENDA")),ye={};for(let Ne=0;Ne<V.length;Ne++){const _e=W(V[Ne]);if(!_e)continue;const be=_e.toUpperCase();if(__e(_e)){console.log(`Ignoring column: "${_e}" at index ${Ne}`);continue}const Me=/^\d+$/.test(_e);let Se=null;if(Me){const $e=Number(_e);Number.isFinite($e)&&$e>=34&&$e<=46&&(Se=String($e))}else{const $e=w_e(be);y_e.includes($e)&&(Se=$e)}Se&&(ye[Se]||(ye[Se]=[]),ye[Se].push(Ne),ye[Se].length>1?console.log(`Mapped duplicate size column: "${_e}" -> "${Se}" at index ${Ne}`):console.log(`Mapped size column: "${_e}" -> "${Se}" at index ${Ne}`))}if(console.log("Final mapped size columns:",ye),console.log("Header mapping:",{referenciaIndex:ie,tipoDescIndex:oe,cor1DescIndex:se,prcVendaIndex:le,sizeColumnIndexes:ye,headerRow:V.slice(0,20)}),ie===-1||oe===-1||se===-1){de.error("Colunas obrigatrias no encontradas: REFERE/REFERENCIA, TIPODESC, COR1DESC"),u(!1);return}if(Object.keys(ye).length===0){de.error("Nenhuma coluna de tamanho encontrada (PP/P/M/G/GG/UN ou numricas 3446 como 36/38/40/42/44)"),u(!1);return}le===-1&&de.warning("Coluna PRCVENDA no encontrada - preos sero definidos como 0");const ue=new Map;let ne=!1,pe=0;for(let Ne=1;Ne<J.length;Ne++){const _e=J[Ne],be=String(_e[ie]||"").trim(),Me=String(_e[oe]||"").trim(),Se=String(_e[se]||"").trim();if(!be||!Se)continue;pe++;const $e=Q3(Se),Ke=`${be}-${$e}`;ue.has(Ke)||ue.set(Ke,{referencia:be,tipoDesc:Me,cor1Desc:Se,stockBySize:{},prices:[]});const Ze=ue.get(Ke);if(le!==-1){const it=_e[le];Ne<=5&&console.log(`[DEBUG Row ${Ne}] PRCVENDA raw:`,it,`type: ${typeof it}`);const Re=N_e(it);Ne<=5&&console.log(`[DEBUG Row ${Ne}] PRCVENDA parsed:`,Re),Re>0&&Ze.prices.push(Re)}for(const[it,Re]of Object.entries(ye)){let ot=0;for(const ut of Re){const bt=_e[ut];Ne<=5&&bt!==void 0&&bt!==null&&bt!==""&&console.log(`[DEBUG Row ${Ne}] Stock ${it} raw:`,bt,`type: ${typeof bt}`);const Je=S_e(bt);Ne<=5&&bt!==void 0&&bt!==null&&bt!==""&&console.log(`[DEBUG Row ${Ne}] Stock ${it} parsed:`,Je);const Ce=I8(bt);Ce!==null&&Ce<0&&(ne=!0),ot+=Je}Ze.stockBySize[it]=(Ze.stockBySize[it]||0)+ot}}q(pe);const ge=Object.values(ye).reduce((Ne,_e)=>Ne+_e.length,0);await F(Array.from(ue.values()),ne,ge),p(!0),ne&&de.warning("Valores negativos detectados e normalizados para 0")}catch(Z){console.error("Error parsing file:",Z),de.error("Erro ao ler arquivo")}finally{u(!1)}}},F=async(Z,re,G)=>{const J=Z.map(oe=>`${oe.referencia}-${Q3(oe.cor1Desc)}`),{data:V,error:W}=await ce.from("product_catalog").select("id, sku, group_key, name").in("sku",J);W&&console.error("Error fetching products:",W);const ee=new Map((V==null?void 0:V.map(oe=>[oe.sku,oe]))||[]),ie=Z.map(oe=>{const se=`${oe.referencia}-${Q3(oe.cor1Desc)}`,le=ee.get(se),ue=Object.values(oe.stockBySize).reduce((Ne,_e)=>Ne+_e,0)===0,ne=[...new Set(oe.prices)],pe=ne.length>1,ge=ne.length>0?Math.max(...ne):0;return{groupKey:se,referencia:oe.referencia,color:j_e(oe.cor1Desc),productName:oe.tipoDesc,stockBySize:oe.stockBySize,price:ge,hasPriceVariation:pe,existingProductId:le==null?void 0:le.id,isNew:!le,hasNegativeValues:re,hasZeroStock:ue,mappedSizesCount:G}});d(ie)},S=async()=>{if(c.length===0){de.error("Nenhum produto para processar");return}f(!0);let Z=0,re=0;const G=c.some(J=>J.hasNegativeValues);try{for(const W of c){const ee=Object.entries(W.stockBySize).filter(([,ie])=>ie>0).map(([ie])=>ie);if(W.existingProductId){const{data:ie}=await ce.from("product_catalog").select("erp_stock_by_size, committed_by_size").eq("id",W.existingProductId).single(),oe=(ie==null?void 0:ie.erp_stock_by_size)||{},se=(ie==null?void 0:ie.committed_by_size)||{},le=x_e(oe,W.stockBySize,se),ye=v_e(W.stockBySize,le),{error:ue}=await ce.from("product_catalog").update({erp_stock_by_size:W.stockBySize,committed_by_size:le,stock_by_size:ye,sizes:ee}).eq("id",W.existingProductId);ue?console.error("Error updating product:",W.groupKey,ue):Z++}else if(b){const ie=W.groupKey,oe=`${W.productName} - ${W.color} (${W.referencia})`,{error:se}=await ce.from("product_catalog").insert({user_id:t==null?void 0:t.id,sku:ie,group_key:W.referencia,name:W.productName,color:W.color,description:oe,price:W.price,is_active:!1,created_from_import:!0,erp_stock_by_size:W.stockBySize,committed_by_size:{},stock_by_size:W.stockBySize,sizes:ee,tags:W.hasPriceVariation?["revisao-preco"]:[]});se?console.error("Error creating product:",W.groupKey,se):re++}}const J=c.filter(W=>W.isNew),V=c.filter(W=>!W.isNew);await ce.from("inventory_imports").insert({user_id:t==null?void 0:t.id,filename:(i==null?void 0:i.name)||"import.xlsx",total_rows:L,matched_count:V.length,unmatched_count:b?0:J.length,updated_products:V.map(W=>({id:W.existingProductId,sku:W.groupKey,name:W.productName})),unmatched_skus:b?[]:J.map(W=>W.groupKey)}),X(),O({updatedCount:Z,createdCount:re,negativeValuesWarning:G,showResult:!0}),o(null),d([]),p(!1),re>0?de.success(`${Z} produtos atualizados e ${re} produtos criados como rascunho!`):de.success(`${Z} produtos atualizados!`)}catch(J){console.error("Error applying changes:",J),de.error("Erro ao aplicar alteraes")}finally{f(!1)}},E=async()=>{D(!0);try{const{data:Z,error:re}=await ce.from("product_catalog").select("id, name, sku, stock_by_size, group_key, created_from_import").eq("created_from_import",!0);if(re){de.error("Erro ao buscar produtos importados");return}if(!Z||Z.length===0){de.info("Nenhum produto importado encontrado para consolidar");return}const G=new Map;for(const W of Z){const ee=W.sku||W.group_key;ee&&(G.has(ee)||G.set(ee,[]),G.get(ee).push(W))}let J=0,V=0;for(const[W,ee]of G){if(ee.length<=1)continue;const ie=ee[0],oe=ie.stock_by_size||{};for(let ue=1;ue<ee.length;ue++){const pe=ee[ue].stock_by_size||{};for(const[ge,Ne]of Object.entries(pe))oe[ge]=(oe[ge]||0)+Ne}const{error:se}=await ce.from("product_catalog").update({stock_by_size:oe,sizes:Object.keys(oe).filter(ue=>oe[ue]>0)}).eq("id",ie.id);if(se){console.error("Error updating main product:",se);continue}const le=ee.slice(1).map(ue=>ue.id),{error:ye}=await ce.from("product_catalog").delete().in("id",le);ye?console.error("Error deleting duplicates:",ye):(J++,V+=le.length)}J>0?de.success(`${J} produtos consolidados, ${V} duplicatas removidas!`):de.info("Nenhuma duplicata encontrada para consolidar")}catch(Z){console.error("Error merging products:",Z),de.error("Erro ao consolidar produtos")}finally{D(!1)}},N=async()=>{const Z=[["REFERENCIA","TIPODESC","COR1DESC","PRCVENDA","PP","P","M","G","GG","UN","36","38","40","42"],["YT00172","TOP CARLA","PRETO","129,90",2,5,3,1,0,0,0,0,0,0],["YT00172","TOP CARLA","BRANCO","129,90",1,4,2,2,1,0,0,0,0,0],["YT00015","TOP DANI","ROSA","89,90",0,3,5,2,0,0,0,0,0,0]],re=new mv.Workbook,G=re.addWorksheet("Estoque");Z.forEach(ie=>G.addRow(ie));const J=await re.xlsx.writeBuffer(),V=new Blob([J],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),W=window.URL.createObjectURL(V),ee=document.createElement("a");ee.href=W,ee.download="modelo_estoque_novo.xlsx",ee.click(),window.URL.revokeObjectURL(W)},C=Z=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Z),k=c.some(Z=>Z.hasPriceVariation);if(r||s)return n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Carregando..."});const I=c.filter(Z=>Z.isNew),U=c.filter(Z=>!Z.isNew);return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-serif font-bold",children:"Importar Estoque"}),n.jsx("p",{className:"text-muted-foreground",children:"Novo formato: REFERENCIA + COR = produto nico"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{variant:"outline",onClick:N,children:[n.jsx(Af,{className:"h-4 w-4 mr-2"}),"Baixar modelo"]}),n.jsxs(he,{variant:"outline",onClick:E,disabled:R,children:[n.jsx(xae,{className:"h-4 w-4 mr-2"}),R?"Consolidando...":"Consolidar duplicatas"]}),n.jsxs(he,{variant:"outline",onClick:()=>y(!0),children:[n.jsx(gw,{className:"h-4 w-4 mr-2"}),"Histrico"]})]})]}),n.jsxs(De,{className:"mb-6",children:[n.jsxs(Ot,{children:[n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(sf,{className:"h-5 w-5"}),"Upload de Planilha"]}),n.jsx(Ai,{children:"Formato: REFERENCIA, TIPODESC, COR1DESC, PRCVENDA e colunas de tamanho (PP, P, M, G, GG, UN, 36-42)"})]}),n.jsx(Be,{children:n.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[n.jsx("div",{className:"flex-1",children:n.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer hover:bg-muted/50 transition-colors",children:[n.jsx(Gh,{className:"h-8 w-8 text-muted-foreground mb-2"}),n.jsx("span",{className:"text-sm text-muted-foreground",children:i?i.name:"Clique ou arraste um arquivo"}),n.jsx("input",{type:"file",className:"hidden",accept:".xlsx,.xls,.csv",onChange:H})]})}),n.jsx(he,{onClick:M,disabled:!i||l,className:"sm:self-end",children:l?"Processando...":"Processar arquivo"})]})})]}),m&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[n.jsx(De,{children:n.jsxs(Be,{className:"pt-6",children:[n.jsx("div",{className:"text-2xl font-bold text-primary",children:L}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Linhas lidas"})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"pt-6",children:[n.jsx("div",{className:"text-2xl font-bold text-primary",children:c.length}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Produtos (Ref+Cor)"})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"pt-6",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(xn,{className:"h-5 w-5 text-green-500"}),n.jsx("span",{className:"text-2xl font-bold text-green-600",children:U.length}),n.jsx("span",{className:"text-muted-foreground",children:"/"}),n.jsx(An,{className:"h-5 w-5 text-amber-500"}),n.jsx("span",{className:"text-2xl font-bold text-amber-600",children:I.length})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Existentes / Novos"})]})})]}),c.some(Z=>Z.hasNegativeValues)&&n.jsx(De,{className:"mb-6 border-amber-200 bg-amber-50",children:n.jsxs(Be,{className:"pt-6 flex items-center gap-3",children:[n.jsx(Cn,{className:"h-5 w-5 text-amber-600"}),n.jsxs("span",{className:"text-amber-800",children:[n.jsx("strong",{children:"Ateno:"})," Valores negativos foram detectados na planilha e normalizados para 0."]})]})}),k&&n.jsx(De,{className:"mb-6 border-orange-200 bg-orange-50",children:n.jsxs(Be,{className:"pt-6 flex items-center gap-3",children:[n.jsx(Cn,{className:"h-5 w-5 text-orange-600"}),n.jsxs("span",{className:"text-orange-800",children:[n.jsx("strong",{children:"Variao de preo:"})," Alguns produtos possuem preos diferentes entre tamanhos. O maior valor foi usado e os produtos foram marcados para reviso."]})]})}),c.some(Z=>Z.hasZeroStock)&&n.jsx(De,{className:"mb-6 border-red-200 bg-red-50",children:n.jsxs(Be,{className:"pt-6 flex items-center gap-3",children:[n.jsx(Cn,{className:"h-5 w-5 text-red-600"}),n.jsxs("span",{className:"text-red-800",children:[n.jsx("strong",{children:"Estoque zerado:"})," ",c.filter(Z=>Z.hasZeroStock).length," produto(s) no possuem estoque ou as colunas de tamanho no foram mapeadas corretamente.",(($=c[0])==null?void 0:$.mappedSizesCount)>0&&n.jsxs("span",{className:"block text-sm mt-1",children:["Colunas de tamanho mapeadas: ",(Y=c[0])==null?void 0:Y.mappedSizesCount]})]})]})}),n.jsxs(De,{className:"mb-6",children:[n.jsxs(Ot,{children:[n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(sf,{className:"h-5 w-5"}),"Produtos (",c.length,")"]}),n.jsx(Ai,{children:"Cada linha = REFERENCIA + COR (produto nico)"})]}),n.jsxs(Be,{children:[b&&I.length>0&&n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-amber-50 rounded-lg border border-amber-200 mb-4",children:[n.jsx("input",{type:"checkbox",id:"autoCreate",checked:b,onChange:Z=>j(Z.target.checked),className:"h-4 w-4 rounded border-gray-300"}),n.jsx("label",{htmlFor:"autoCreate",className:"text-sm",children:n.jsxs("strong",{children:["Auto-cadastrar ",I.length," produto(s) novo(s) como rascunho"]})})]}),n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{children:"Status"}),n.jsx(jt,{children:"Modelo"}),n.jsx(jt,{children:"Cor"}),n.jsx(jt,{children:"Nome"}),n.jsx(jt,{children:"Preo"}),n.jsx(jt,{children:"Estoque por Tamanho"})]})}),n.jsx(Na,{children:c.slice(0,30).map(Z=>n.jsxs(Qr,{children:[n.jsx(yt,{children:Z.isNew?n.jsxs(Ae,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200",children:[n.jsx(An,{className:"h-3 w-3 mr-1"}),"Novo"]}):n.jsxs(Ae,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[n.jsx(xn,{className:"h-3 w-3 mr-1"}),"Atualizar"]})}),n.jsx(yt,{className:"font-mono font-bold",children:Z.referencia}),n.jsx(yt,{children:n.jsx(Ae,{variant:"secondary",children:Z.color})}),n.jsx(yt,{children:Z.productName}),n.jsx(yt,{children:n.jsxs("div",{className:"flex items-center gap-1",children:[Z.price>0?n.jsx("span",{className:Z.hasPriceVariation?"text-orange-600 font-medium":"",children:C(Z.price)}):n.jsx("span",{className:"text-muted-foreground text-sm",children:"-"}),Z.hasPriceVariation&&n.jsx(Ae,{variant:"outline",className:"text-xs bg-orange-50 text-orange-600 border-orange-200",children:"Variao"})]})}),n.jsx(yt,{children:n.jsx("div",{className:"flex flex-wrap gap-1",children:(()=>{const re=Object.entries(Z.stockBySize),G=re.filter(([,V])=>V>0),J=re.filter(([,V])=>V===0);return G.length===0&&re.length===0?n.jsx("span",{className:"text-xs text-red-500 font-medium",children:" Colunas no mapeadas"}):G.length===0?n.jsx("span",{className:"text-xs text-amber-600 font-medium",children:" Estoque zerado"}):n.jsxs(n.Fragment,{children:[G.map(([V,W])=>n.jsxs(Ae,{variant:"default",className:"text-xs",children:[V,": ",W]},V)),J.slice(0,3).map(([V])=>n.jsxs(Ae,{variant:"outline",className:"text-xs text-muted-foreground",children:[V,": 0"]},V)),J.length>3&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",J.length-3]})]})})()})})]},Z.groupKey))})]}),c.length>30&&n.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["E mais ",c.length-30," produtos..."]})]})]}),n.jsx(Ta,{className:"my-6"}),n.jsxs("div",{className:"flex justify-end gap-3",children:[n.jsx(he,{variant:"outline",onClick:()=>{p(!1),o(null),d([])},children:"Cancelar"}),n.jsx(he,{onClick:S,disabled:h||c.length===0,children:h?"Aplicando...":`Aplicar (${U.length} atualizar${I.length>0&&b?` + ${I.length} criar`:""})`})]})]}),T.showResult&&n.jsxs(De,{className:"border-green-200 bg-green-50",children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2 text-green-700",children:[n.jsx(xn,{className:"h-5 w-5"}),"Importao Concluda!"]})}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"p-4 bg-white rounded-lg border",children:[n.jsx("div",{className:"text-2xl font-bold text-primary",children:T.updatedCount}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Produtos atualizados"})]}),n.jsxs("div",{className:"p-4 bg-white rounded-lg border",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:T.createdCount}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Produtos criados (rascunho)"})]}),T.negativeValuesWarning&&n.jsx("div",{className:"p-4 bg-amber-50 rounded-lg border border-amber-200",children:n.jsxs("div",{className:"flex items-center gap-2 text-amber-600",children:[n.jsx(Cn,{className:"h-5 w-5"}),n.jsx("span",{className:"font-medium",children:"Valores negativos normalizados"})]})})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(he,{variant:"outline",onClick:()=>O({updatedCount:0,createdCount:0,negativeValuesWarning:!1,showResult:!1}),children:"Fazer nova importao"}),T.createdCount>0&&n.jsxs(he,{onClick:()=>e("/dashboard?tab=products&filter=imported"),children:[n.jsx(Ux,{className:"h-4 w-4 mr-2"}),"Ver produtos arquivados"]})]})]})]})]}),n.jsx(cn,{open:x,onOpenChange:y,children:n.jsxs(sn,{className:"max-w-2xl",children:[n.jsx(fn,{children:n.jsx(dn,{children:"Histrico de Importaes"})}),n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{children:"Arquivo"}),n.jsx(jt,{children:"Linhas"}),n.jsx(jt,{children:"Atualizados"}),n.jsx(jt,{children:"Novos"}),n.jsx(jt,{children:"Data"})]})}),n.jsx(Na,{children:g.map(Z=>n.jsxs(Qr,{children:[n.jsx(yt,{className:"font-medium",children:Z.filename}),n.jsx(yt,{children:Z.total_rows}),n.jsx(yt,{className:"text-green-600",children:Z.matched_count}),n.jsx(yt,{className:"text-amber-600",children:Z.unmatched_count}),n.jsx(yt,{className:"text-muted-foreground",children:new Date(Z.created_at).toLocaleDateString("pt-BR")})]},Z.id))})]})]})})]})}function E_e({customer:e,hasQuiz:t,hasPrints:r}){const s=l=>{const u=l.replace(/\D/g,"");return u.length===11?`(${u.slice(0,2)}) ${u.slice(2,7)}-${u.slice(7)}`:u.length===13&&u.startsWith("55")?`(${u.slice(2,4)}) ${u.slice(4,9)}-${u.slice(9)}`:l},a=l=>new Date(l).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit"}),i=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l),o=!!e.name&&!!e.phone&&!!e.email,c=o?"Cadastro completo":"Cadastro incompleto",d=`Oi ${e.name||""}!  Sou da Lepoa, tudo bem?`;return n.jsxs("div",{className:"bg-card rounded-xl border border-border p-6",children:[n.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[n.jsxs(Ae,{variant:"outline",className:"gap-1",children:[" ",e.total_orders," pedido",e.total_orders!==1?"s":""]}),n.jsxs(Ae,{variant:"outline",className:"gap-1 text-primary",children:[" ",i(e.total_spent)]}),e.last_order_at&&n.jsxs(Ae,{variant:"outline",className:"gap-1",children:[" ltima compra: ",a(e.last_order_at)]}),n.jsx(Ae,{variant:t?"default":"secondary",className:"gap-1",children:t?" Quiz respondido":" Sem quiz"}),r&&n.jsx(Ae,{variant:"outline",className:"gap-1",children:" Enviou prints"})]}),n.jsxs("div",{className:"flex flex-col md:flex-row md:items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex items-start gap-4",children:[n.jsx("div",{className:"w-16 h-16 rounded-full bg-secondary flex items-center justify-center shrink-0",children:n.jsx(Wn,{className:"h-8 w-8 text-muted-foreground"})}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h1",{className:"font-serif text-2xl",children:e.name||"Cliente sem nome"}),o?n.jsx(Er,{className:"h-5 w-5 text-green-500"}):n.jsx(Cn,{className:"h-5 w-5 text-amber-500"})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-muted-foreground",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(el,{className:"h-4 w-4"}),s(e.phone)]}),e.instagram&&n.jsxs("a",{href:`https://instagram.com/${e.instagram.replace("@","")}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-primary hover:underline",children:[n.jsx(Wn,{className:"h-4 w-4"}),"@",e.instagram.replace("@","")]}),e.email&&n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ok,{className:"h-4 w-4"}),e.email]}),n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(is,{className:"h-4 w-4"}),"Desde ",a(e.created_at)]})]}),n.jsxs("div",{className:"flex flex-wrap gap-2 pt-1",children:[e.style_title&&n.jsxs(Ae,{variant:"default",className:"gap-1",children:[" ",e.style_title]}),(e.size_letter||e.size_number)&&n.jsxs(Ae,{variant:"secondary",children:["Tam. ",[e.size_letter,e.size_number].filter(Boolean).join(" / ")]})]}),n.jsx("p",{className:`text-xs ${o?"text-green-600":"text-amber-600"}`,children:c})]})]}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsx(q_,{href:No(d,e.phone),variant:"primary",className:"w-auto"})})]})]})}function VM(e){const t=(e||"").replace(/\D/g,"").slice(0,11);return t.length===0?"":t.length<=3?t:t.length<=6?`${t.slice(0,3)}.${t.slice(3)}`:t.length<=9?`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6)}`:`${t.slice(0,3)}.${t.slice(3,6)}.${t.slice(6,9)}-${t.slice(9)}`}function k_e({customer:e,onUpdate:t}){var f,m;const[r,s]=P.useState(!1),[a,i]=P.useState(!1),[o,c]=P.useState({name:e.name||"",email:e.email||"",instagram:e.instagram||"",document:((f=e.document)==null?void 0:f.replace(/\D/g,""))||"",birth_date:e.birth_date||""}),d=async()=>{i(!0);try{const p=o.document.replace(/\D/g,"");if(p&&p.length!==11){de.error("CPF deve ter 11 dgitos"),i(!1);return}const{error:g}=await ce.from("customers").update({name:o.name||null,email:o.email||null,instagram:o.instagram||null,document:p||null,birth_date:o.birth_date||null}).eq("id",e.id);if(g)throw g;if(p){const{data:v}=await ce.from("customer_addresses").select("id").eq("customer_id",e.id).eq("is_default",!0).maybeSingle();v&&await ce.from("customer_addresses").update({document:p}).eq("id",v.id)}de.success("Dados atualizados!"),s(!1),t()}catch(p){console.error("Error updating customer:",p),de.error("Erro ao atualizar dados")}finally{i(!1)}},l=()=>{var p;c({name:e.name||"",email:e.email||"",instagram:e.instagram||"",document:((p=e.document)==null?void 0:p.replace(/\D/g,""))||"",birth_date:e.birth_date||""}),s(!1)},u=((m=e.document)==null?void 0:m.replace(/\D/g,""))||"",h=u.length===11;return n.jsxs(De,{children:[n.jsxs(Ot,{className:"flex flex-row items-center justify-between pb-2",children:[n.jsxs(Mt,{className:"text-lg flex items-center gap-2",children:[n.jsx(Wn,{className:"h-5 w-5 text-primary"}),"Dados do Cliente"]}),r?n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{variant:"ghost",size:"sm",onClick:l,children:[n.jsx(an,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),n.jsxs(he,{size:"sm",onClick:d,disabled:a,children:[a?n.jsx(At,{className:"h-4 w-4 animate-spin mr-1"}):n.jsx(td,{className:"h-4 w-4 mr-1"}),"Salvar"]})]}):n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>s(!0),children:[n.jsx(nc,{className:"h-4 w-4 mr-1"}),"Editar"]})]}),n.jsx(Be,{className:"space-y-4",children:r?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"edit-name",children:"Nome"}),n.jsx(Qe,{id:"edit-name",value:o.name,onChange:p=>c({...o,name:p.target.value}),placeholder:"Nome completo"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"edit-email",children:"Email"}),n.jsx(Qe,{id:"edit-email",type:"email",value:o.email,onChange:p=>c({...o,email:p.target.value}),placeholder:"email@exemplo.com"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"edit-cpf",children:"CPF"}),n.jsx(Qe,{id:"edit-cpf",value:VM(o.document),onChange:p=>c({...o,document:p.target.value.replace(/\D/g,"").slice(0,11)}),placeholder:"000.000.000-00",maxLength:14}),o.document&&o.document.length>0&&o.document.length!==11&&n.jsxs("p",{className:"text-xs text-amber-600",children:["CPF deve ter 11 dgitos (",o.document.length,"/11)"]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"edit-instagram",children:"Instagram"}),n.jsx(Qe,{id:"edit-instagram",value:o.instagram,onChange:p=>c({...o,instagram:p.target.value}),placeholder:"@usuario"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"edit-birthday",children:"Data de Aniversrio"}),n.jsx(Qe,{id:"edit-birthday",type:"date",value:o.birth_date,onChange:p=>c({...o,birth_date:p.target.value}),max:new Date().toISOString().split("T")[0]})]})]}):n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Wn,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-sm font-medium",children:"Nome:"}),n.jsx("span",{className:"text-sm",children:e.name||n.jsx("span",{className:"text-muted-foreground italic",children:"No informado"})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(el,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-sm font-medium",children:"Telefone:"}),n.jsx("span",{className:"text-sm",children:Ib(e.phone)})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ok,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-sm font-medium",children:"Email:"}),n.jsx("span",{className:"text-sm",children:e.email||n.jsx("span",{className:"text-muted-foreground italic",children:"No informado"})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(af,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-sm font-medium",children:"CPF:"}),h?n.jsx("span",{className:"text-sm font-mono",children:VM(u)}):n.jsx("span",{className:"text-sm text-muted-foreground italic",children:"No informado"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Wn,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-sm font-medium",children:"Instagram:"}),n.jsx("span",{className:"text-sm",children:e.instagram||n.jsx("span",{className:"text-muted-foreground italic",children:"No informado"})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(fw,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-sm font-medium",children:"Aniversrio:"}),n.jsx("span",{className:"text-sm",children:e.birth_date?new Date(e.birth_date+"T00:00:00").toLocaleDateString("pt-BR"):n.jsx("span",{className:"text-muted-foreground italic",children:"No informado"})})]}),e.address_line&&n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(_o,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm font-medium",children:"Endereo:"}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.address_line,e.city&&`, ${e.city}`,e.state&&`/${e.state}`,e.zip_code&&` - CEP ${e.zip_code}`]})]})]})]})})]})}function A_e({customer:e,profileData:t,quizResponses:r,quizLink:s}){const a=r.length>0||!!e.style_title||!!(t!=null&&t.style_title),i=()=>{const o=`Oi ${e.name||""}!  Fizemos uma consultoria rpida no Provador VIP. Quer descobrir seu estilo e receber sugestes no seu tamanho? Responde em 2 min: ${s}`;navigator.clipboard.writeText(o),de.success("Mensagem copiada!")};return a?n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"text-lg flex items-center gap-2",children:[n.jsx(Wr,{className:"h-5 w-5 text-primary"}),"Perfil de Estilo"]})}),n.jsxs(Be,{className:"space-y-4",children:[(t==null?void 0:t.quiz_points)&&n.jsxs("div",{className:"flex items-center gap-4 p-3 bg-primary/5 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Pontos VIP"}),n.jsxs("p",{className:"text-xl font-bold text-primary",children:[" ",t.quiz_points," pts"]})]}),t.quiz_level&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Nvel"}),n.jsxs("p",{className:"font-medium",children:["Nvel ",t.quiz_level]})]})]}),e.style_title&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Estilo Principal"}),n.jsxs(Ae,{variant:"default",className:"text-base px-3 py-1",children:[" ",e.style_title]})]}),(e.size_letter||e.size_number)&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Tamanhos"}),n.jsxs("div",{className:"flex gap-2",children:[e.size_letter&&n.jsxs(Ae,{variant:"secondary",children:["Letra: ",e.size_letter]}),e.size_number&&n.jsxs(Ae,{variant:"secondary",children:["Nmero: ",e.size_number]})]})]}),(t==null?void 0:t.style_description)&&n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Descrio do Estilo"}),n.jsx("p",{className:"text-sm",children:t.style_description})]}),(t==null?void 0:t.color_palette)&&t.color_palette.length>0&&n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-muted-foreground mb-1 flex items-center gap-1",children:[n.jsx(lk,{className:"h-4 w-4"}),"Paleta de Cores"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:t.color_palette.map((o,c)=>n.jsx(Ae,{variant:"outline",children:o},c))})]}),(t==null?void 0:t.avoid_items)&&t.avoid_items.length>0&&n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-muted-foreground mb-1 flex items-center gap-1",children:[n.jsx(sae,{className:"h-4 w-4"}),"No gosta / Evitar"]}),n.jsx("div",{className:"flex flex-wrap gap-2",children:t.avoid_items.map((o,c)=>n.jsx(Ae,{variant:"destructive",className:"bg-red-100 text-red-700 hover:bg-red-100",children:o},c))})]}),(t==null?void 0:t.personal_tip)&&n.jsxs("div",{children:[n.jsxs("p",{className:"text-sm text-muted-foreground mb-1 flex items-center gap-1",children:[n.jsx(N_,{className:"h-4 w-4"}),"Comentrio da cliente"]}),n.jsxs("p",{className:"text-sm italic bg-secondary/50 p-3 rounded-lg",children:['"',t.personal_tip,'"']})]}),r.length>0&&n.jsxs("div",{className:"pt-4 border-t",children:[n.jsx("p",{className:"text-sm font-medium mb-3",children:"Respostas do Quiz"}),n.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:r.map(o=>n.jsxs("div",{className:"text-sm",children:[n.jsxs("p",{className:"text-muted-foreground",children:[o.question_number,". ",o.question]}),n.jsx("p",{className:"font-medium text-primary",children:o.answer})]},o.id))})]})]})]}):n.jsx(De,{className:"border-amber-200 bg-amber-50/50",children:n.jsxs(Be,{className:"py-8 text-center",children:[n.jsx(Wr,{className:"h-12 w-12 mx-auto mb-4 text-amber-500"}),n.jsx("h3",{className:"font-medium text-lg mb-2",children:"Cliente ainda no completou o Quiz"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Envie um convite personalizado para conhecer o estilo dela"}),n.jsxs(he,{onClick:i,variant:"outline",className:"gap-2",children:[n.jsx(Ia,{className:"h-4 w-4"}),"Copiar convite para Quiz"]})]})})}function T_e({orders:e}){const[t,r]=P.useState(new Set),s=l=>{r(u=>{const h=new Set(u);return h.has(l)?h.delete(l):h.add(l),h})},a=l=>new Date(l).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}),i=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l),o=l=>({pendente:{label:"Pendente",variant:"secondary"},aguardando_pagamento:{label:"Aguardando Pagamento",variant:"outline"},pago:{label:"Pago",variant:"default"},enviado:{label:"Enviado",variant:"default"},entregue:{label:"Entregue",variant:"default"},cancelado:{label:"Cancelado",variant:"destructive"}})[l]||{label:l,variant:"secondary"},c=l=>{switch(l){case"motoboy":return n.jsx(rc,{className:"h-4 w-4"});case"pickup":return n.jsx(pa,{className:"h-4 w-4"});default:return n.jsx(gn,{className:"h-4 w-4"})}},d=(l,u)=>{switch(l){case"motoboy":return"Motoboy";case"pickup":return"Retirada na loja";default:return u||"Correios"}};return e.length===0?n.jsx(De,{children:n.jsxs(Be,{className:"py-12 text-center text-muted-foreground",children:[n.jsx(ln,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhum pedido encontrado para esta cliente."})]})}):n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"text-lg flex items-center gap-2",children:[n.jsx(ln,{className:"h-5 w-5"}),"Histrico de Pedidos (",e.length,")"]})}),n.jsx(Be,{className:"space-y-3",children:e.map(l=>{const u=t.has(l.id),h=o(l.status);return n.jsx(Ag,{open:u,children:n.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[n.jsx(Tg,{asChild:!0,children:n.jsxs("button",{onClick:()=>s(l.id),className:"w-full p-4 flex items-center justify-between hover:bg-muted/50 transition-colors text-left",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium",children:["#",l.id.slice(0,8).toUpperCase()]}),n.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[n.jsx(is,{className:"h-3 w-3"}),a(l.created_at)]})]}),n.jsx(Ae,{variant:h.variant,children:h.label})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-bold text-primary",children:i(l.total)}),n.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1 justify-end",children:[c(l.delivery_method),d(l.delivery_method,l.shipping_service)]})]}),u?n.jsx(nf,{className:"h-5 w-5 text-muted-foreground"}):n.jsx(Zi,{className:"h-5 w-5 text-muted-foreground"})]})]})}),n.jsx(Pg,{children:n.jsxs("div",{className:"border-t p-4 bg-muted/30 space-y-3",children:[l.items.map(f=>n.jsxs("div",{className:"flex items-center gap-3",children:[f.image_url?n.jsx("img",{src:f.image_url,alt:f.product_name,className:"w-12 h-12 object-cover rounded"}):n.jsx("div",{className:"w-12 h-12 bg-secondary rounded flex items-center justify-center",children:n.jsx(Ut,{className:"h-5 w-5 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-sm truncate",children:f.product_name}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[f.color&&`${f.color}  `,"Tam. ",f.size,"  Qtd. ",f.quantity]})]}),n.jsx("p",{className:"font-medium text-sm",children:i(f.product_price*f.quantity)})]},f.id)),l.tracking_code&&n.jsx("div",{className:"pt-2 border-t",children:n.jsxs("p",{className:"text-xs text-muted-foreground",children:["Cdigo de rastreio: ",n.jsx("span",{className:"font-mono font-medium",children:l.tracking_code})]})}),l.customer_notes&&n.jsxs("div",{className:"pt-2 border-t",children:[n.jsxs("div",{className:"flex items-center gap-1 text-xs font-medium text-blue-700 mb-1",children:[n.jsx(nn,{className:"h-3 w-3"}),"Observao do cliente:"]}),n.jsx("div",{className:"text-xs bg-blue-50 border border-blue-200 rounded p-2",children:l.customer_notes})]}),l.customer_address&&n.jsxs("div",{className:"text-xs text-muted-foreground pt-2 border-t",children:[n.jsx("p",{className:"font-medium",children:"Endereo:"}),n.jsx("p",{children:l.customer_address})]})]})})]})},l.id)})})]})}function P_e({prints:e,linkedProducts:t}){const[r,s]=P.useState(null),a=c=>{const{data:d}=ce.storage.from("prints").getPublicUrl(c);return d.publicUrl},i=c=>new Date(c).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"}),o=c=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c);return e.length===0?n.jsx(De,{children:n.jsxs(Be,{className:"py-12 text-center text-muted-foreground",children:[n.jsx(Ma,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhum print enviado por esta cliente."})]})}):n.jsxs(n.Fragment,{children:[n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"text-lg flex items-center gap-2",children:[n.jsx(Ma,{className:"h-5 w-5"}),"Prints Enviados (",e.length,")"]})}),n.jsx(Be,{children:n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:e.map(c=>{const d=c.linked_product_id?t[c.linked_product_id]:null;return n.jsxs("div",{className:"group relative cursor-pointer",onClick:()=>s(c),children:[n.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-secondary",children:n.jsx("img",{src:a(c.image_path),alt:"Print enviado",className:"w-full h-full object-cover group-hover:scale-105 transition-transform"})}),n.jsx(Ae,{variant:d?"default":"secondary",className:"absolute top-2 right-2 text-xs",children:d?"Vinculado":"Pendente"}),n.jsxs("div",{className:"mt-2 space-y-1",children:[n.jsx("p",{className:"text-xs text-muted-foreground",children:i(c.created_at)}),c.size&&n.jsxs("p",{className:"text-xs",children:["Tam. ",c.size]}),d&&n.jsx("p",{className:"text-xs text-primary truncate font-medium",children:d.name})]})]},c.id)})})})]}),n.jsx(cn,{open:!!r,onOpenChange:()=>s(null),children:n.jsxs(sn,{className:"max-w-2xl",children:[n.jsx(dn,{className:"sr-only",children:"Detalhes do Print"}),r&&n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"aspect-square max-h-[60vh] rounded-lg overflow-hidden bg-secondary",children:n.jsx("img",{src:a(r.image_path),alt:"Print enviado",className:"w-full h-full object-contain"})}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Enviado em ",i(r.created_at)]}),n.jsx(Ae,{variant:r.linked_product_id?"default":"secondary",children:r.linked_product_id?"Produto vinculado":"Pendente de anlise"})]}),r.size&&n.jsxs("p",{className:"text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Tamanho:"})," ",r.size]}),r.preference&&n.jsxs("p",{className:"text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Preferncia:"})," ",r.preference==="ajustado"?"Mais ajustado":"Mais soltinho"]}),r.linked_product_id&&t[r.linked_product_id]&&n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg mt-3",children:[n.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Produto vinculado:"}),n.jsxs("div",{className:"flex items-center gap-3",children:[t[r.linked_product_id].image_url&&n.jsx("img",{src:t[r.linked_product_id].image_url,alt:t[r.linked_product_id].name,className:"w-12 h-12 object-cover rounded"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-sm",children:t[r.linked_product_id].name}),n.jsx("p",{className:"text-sm text-primary",children:o(t[r.linked_product_id].price)})]}),n.jsx(he,{variant:"outline",size:"sm",asChild:!0,children:n.jsxs("a",{href:`/produto/${r.linked_product_id}`,target:"_blank",rel:"noopener noreferrer",className:"gap-1",children:[n.jsx(ma,{className:"h-4 w-4"}),"Ver"]})})]})]})]})]})]})})]})}function O_e({customer:e,quizLink:t,lastOrderId:r,lastOrderStatus:s}){const a=e.name||"",i=[e.size_letter,e.size_number].filter(Boolean).join(" / "),o=[{id:"quiz-invite",icon:n.jsx(Wr,{className:"h-4 w-4"}),title:"Convite para Quiz",description:"Enviar link do quiz de estilo",message:`Oi ${a}!  Fizemos uma consultoria rpida no Provador VIP. Quer descobrir seu estilo e receber sugestes no seu tamanho? Responde em 2 min: ${t}`},{id:"product-suggestion",icon:n.jsx(Ut,{className:"h-4 w-4"}),title:"Sugesto de Produto",description:"Avisar sobre pea nova",message:`Oi ${a}! Chegou uma pea que tem muito a ver com voc ${i?` No seu tamanho (${i}).`:""} Quer que eu te mostre? `},{id:"order-status",icon:n.jsx(gn,{className:"h-4 w-4"}),title:"Status do Pedido",description:"Atualizao de pedido",message:r?`Oi ${a}! Sobre o pedido #${r.slice(0,8).toUpperCase()}, ele est como: ${R_e(s||"pendente")}. Se quiser, posso te atualizar por aqui! `:`Oi ${a}! Sobre seu pedido, ele est em andamento. Se quiser, posso te atualizar por aqui! `}],c=(d,l)=>{navigator.clipboard.writeText(d),de.success(`${l} copiada!`)};return n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"text-lg flex items-center gap-2",children:[n.jsx(nn,{className:"h-5 w-5"}),"Mensagens Prontas"]})}),n.jsx(Be,{className:"space-y-3",children:o.map(d=>n.jsx("div",{className:"p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[n.jsx("div",{className:"p-2 bg-primary/10 rounded-lg text-primary",children:d.icon}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-sm",children:d.title}),n.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:d.description}),n.jsx("p",{className:"text-sm text-muted-foreground bg-secondary/50 p-2 rounded text-ellipsis overflow-hidden",children:d.message.length>120?d.message.slice(0,120)+"...":d.message})]})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"shrink-0 gap-1",onClick:()=>c(d.message,d.title),children:[n.jsx(Ia,{className:"h-4 w-4"}),"Copiar"]})]})},d.id))})]})}function R_e(e){return{pendente:"Pendente",aguardando_pagamento:"Aguardando Pagamento",pago:"Pago ",enviado:"Enviado ",entregue:"Entregue ",cancelado:"Cancelado"}[e]||e}function M_e({customerId:e}){const[t,r]=P.useState([]),[s,a]=P.useState(!0);P.useEffect(()=>{i()},[e]);const i=async()=>{var l;a(!0);try{let{data:u,error:h}=await ce.from("live_customers").select("id, live_event_id, whatsapp").eq("client_id",e);if(h)throw h;if(!u||u.length===0){const{data:g}=await ce.from("customers").select("phone").eq("id",e).single(),v=(l=g==null?void 0:g.phone)==null?void 0:l.replace(/\D/g,"");if(v){const{data:x}=await ce.from("live_customers").select("id, live_event_id, whatsapp").or(`whatsapp.ilike.%${v}%,whatsapp.ilike.%${v.slice(-8)}%`);u=x||[],u.length>0&&await ce.from("live_customers").update({client_id:e}).in("id",u.map(y=>y.id))}}if(!u||u.length===0){r([]),a(!1);return}const f=u.map(g=>g.id),{data:m,error:p}=await ce.from("live_carts").select(`
          id,
          status,
          subtotal,
          total,
          created_at,
          updated_at,
          live_event:live_events(id, titulo, data_hora_inicio, status),
          items:live_cart_items(
            id,
            qtd,
            preco_unitario,
            status,
            variante,
            product:product_catalog(id, name, image_url)
          )
        `).in("live_customer_id",f).order("created_at",{ascending:!1});if(p)throw p;r(m||[])}catch(u){console.error("Error loading live history:",u)}finally{a(!1)}},o=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l),c=l=>{switch(l){case"pago":return n.jsxs(Ae,{className:"bg-green-500 text-white gap-1",children:[n.jsx(Er,{className:"h-3 w-3"}),"Pago"]});case"cancelado":case"expirado":return n.jsxs(Ae,{variant:"destructive",className:"gap-1",children:[n.jsx(qn,{className:"h-3 w-3"}),l==="cancelado"?"Cancelado":"Expirado"]});case"aguardando_pagamento":return n.jsxs(Ae,{className:"bg-amber-500 text-white gap-1",children:[n.jsx(Br,{className:"h-3 w-3"}),"Aguardando Pagamento"]});default:return n.jsxs(Ae,{variant:"secondary",className:"gap-1",children:[n.jsx(zi,{className:"h-3 w-3"}),l==="aberto"?"Aberto":l]})}},d={totalLives:new Set(t.map(l=>{var u;return(u=l.live_event)==null?void 0:u.id})).size,totalCarts:t.length,paid:t.filter(l=>l.status==="pago").length,cancelled:t.filter(l=>["cancelado","expirado"].includes(l.status)).length,pending:t.filter(l=>!["pago","cancelado","expirado"].includes(l.status)).length,totalPaid:t.filter(l=>l.status==="pago").reduce((l,u)=>l+u.total,0),totalReserved:t.reduce((l,u)=>l+u.total,0)};return s?n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(Ts,{className:"h-5 w-5"}),"Histrico de Lives"]})}),n.jsxs(Be,{className:"space-y-4",children:[n.jsx(Kr,{className:"h-20 w-full"}),n.jsx(Kr,{className:"h-20 w-full"})]})]}):t.length===0?n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(Ts,{className:"h-5 w-5"}),"Histrico de Lives"]})}),n.jsx(Be,{children:n.jsx("p",{className:"text-muted-foreground text-center py-8",children:"Esta cliente ainda no participou de nenhuma live."})})]}):n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(Ts,{className:"h-5 w-5"}),"Histrico de Lives"]})}),n.jsxs(Be,{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg text-center",children:[n.jsx("div",{className:"text-2xl font-bold",children:d.totalLives}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Lives participadas"})]}),n.jsxs("div",{className:"p-3 bg-green-50 rounded-lg text-center border border-green-200",children:[n.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.paid}),n.jsx("div",{className:"text-xs text-green-600",children:"Carrinhos pagos"})]}),n.jsxs("div",{className:"p-3 bg-red-50 rounded-lg text-center border border-red-200",children:[n.jsx("div",{className:"text-2xl font-bold text-red-600",children:d.cancelled}),n.jsx("div",{className:"text-xs text-red-600",children:"Cancelados/Expirados"})]}),n.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg text-center border border-amber-200",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:d.pending}),n.jsx("div",{className:"text-xs text-amber-600",children:"Pendentes"})]})]}),n.jsxs("div",{className:"flex gap-4 p-4 bg-gradient-to-r from-primary/10 to-primary/5 rounded-lg",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Reservado"}),n.jsx("div",{className:"text-xl font-bold",children:o(d.totalReserved)})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Pago"}),n.jsx("div",{className:"text-xl font-bold text-green-600",children:o(d.totalPaid)})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Taxa de Converso"}),n.jsx("div",{className:"text-xl font-bold",children:d.totalCarts>0?`${Math.round(d.paid/d.totalCarts*100)}%`:""})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h4",{className:"font-medium text-sm text-muted-foreground",children:"Carrinhos"}),t.map(l=>{var u,h,f;return n.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ts,{className:"h-4 w-4 text-primary"}),n.jsx("span",{className:"font-medium",children:((u=l.live_event)==null?void 0:u.titulo)||"Live"})]}),n.jsx("div",{className:"text-sm text-muted-foreground",children:(h=l.live_event)!=null&&h.data_hora_inicio?Ht(new Date(l.live_event.data_hora_inicio),"dd/MM/yyyy 's' HH:mm",{locale:gr}):Ht(new Date(l.created_at),"dd/MM/yyyy 's' HH:mm",{locale:gr})})]}),n.jsxs("div",{className:"text-right",children:[c(l.status),n.jsx("div",{className:"text-lg font-bold mt-1",children:o(l.total)})]})]}),n.jsxs("div",{className:"space-y-2",children:[(l.items||[]).slice(0,3).map(m=>{var p,g,v,x;return n.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[n.jsx("div",{className:"w-10 h-10 bg-muted rounded overflow-hidden shrink-0",children:(p=m.product)!=null&&p.image_url?n.jsx("img",{src:m.product.image_url,alt:m.product.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(zi,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"truncate",children:((g=m.product)==null?void 0:g.name)||"Produto"}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[((v=m.variante)==null?void 0:v.tamanho)&&`Tam: ${m.variante.tamanho}`,((x=m.variante)==null?void 0:x.cor)&&`  ${m.variante.cor}`,`  Qtd: ${m.qtd}`]})]}),n.jsx("div",{className:"text-right shrink-0",children:o(m.preco_unitario*m.qtd)})]},m.id)}),(((f=l.items)==null?void 0:f.length)||0)>3&&n.jsxs("div",{className:"text-xs text-muted-foreground text-center",children:["+ ",l.items.length-3," outros itens"]})]})]},l.id)})]})]})]})}function I_e({customerId:e,customerPhone:t}){const[r,s]=P.useState([]),[a,i]=P.useState(!0),[o,c]=P.useState("all");P.useEffect(()=>{d()},[e,t]);const d=async()=>{i(!0);try{const g=t==null?void 0:t.replace(/\D/g,""),{data:v}=await ce.from("orders").select(`
          id,
          status,
          total,
          created_at,
          live_event_id,
          items:order_items(
            id,
            product_name,
            product_price,
            quantity,
            size,
            color,
            image_url
          )
        `).eq("customer_id",e).order("created_at",{ascending:!1});let x=[];if(g){const{data:q}=await ce.from("orders").select(`
            id,
            customer_phone,
            status,
            total,
            created_at,
            live_event_id,
            items:order_items(
              id,
              product_name,
              product_price,
              quantity,
              size,
              color,
              image_url
            )
          `).is("customer_id",null).order("created_at",{ascending:!1});x=(q||[]).filter(X=>{var F;const H=(F=X.customer_phone)==null?void 0:F.replace(/\D/g,"");if(!H||!g)return!1;if(H===g)return!0;const M=S=>S.startsWith("55")?S.slice(2):S;return M(H)===M(g)})}const y=[...v||[],...x],b=new Set,j=y.filter(q=>b.has(q.id)?!1:(b.add(q.id),!0)),{data:T}=await ce.from("live_customers").select("id, live_event_id").eq("client_id",e);let O=[];if(T&&T.length>0){const q=T.map(H=>H.id),{data:X}=await ce.from("live_carts").select(`
            id,
            status,
            total,
            created_at,
            order_id,
            live_event:live_events(id, titulo),
            items:live_cart_items(
              id,
              qtd,
              preco_unitario,
              status,
              variante,
              product:product_catalog(id, name, image_url, color)
            )
          `).in("live_customer_id",q).order("created_at",{ascending:!1});O=(X||[]).filter(H=>!H.order_id)}const R=j.map(q=>({id:q.id,type:q.live_event_id?"live":"regular",status:q.status,total:q.total,created_at:q.created_at,source_name:q.live_event_id?"Pedido de Live":"Loja Online",items:(q.items||[]).map(X=>({id:X.id,product_name:X.product_name,product_price:X.product_price,quantity:X.quantity,size:X.size,color:X.color,image_url:X.image_url}))})),D=O.map(q=>{var X;return{id:q.id,type:"live",status:q.status,total:q.total,created_at:q.created_at,source_name:((X=q.live_event)==null?void 0:X.titulo)||"Live",items:(q.items||[]).map(H=>{var M,F,S,E,N;return{id:H.id,product_name:((M=H.product)==null?void 0:M.name)||"Produto",product_price:H.preco_unitario,quantity:H.qtd,size:((F=H.variante)==null?void 0:F.tamanho)||"",color:((S=H.product)==null?void 0:S.color)||((E=H.variante)==null?void 0:E.cor)||null,image_url:((N=H.product)==null?void 0:N.image_url)||null}})}}),L=[...R,...D].sort((q,X)=>new Date(X.created_at).getTime()-new Date(q.created_at).getTime());s(L)}catch(g){console.error("Error loading sales data:",g)}finally{i(!1)}},l=P.useMemo(()=>{if(o==="all")return r;const g=new Date;let v;switch(o){case"30d":v=new Date(g.getTime()-30*24*60*60*1e3);break;case"90d":v=new Date(g.getTime()-90*24*60*60*1e3);break;case"1y":v=new Date(g.getTime()-365*24*60*60*1e3);break;default:return r}return r.filter(x=>new Date(x.created_at)>=v)},[r,o]),u=P.useMemo(()=>{const g=["pago","entregue","enviado"],v=l.filter(T=>g.includes(T.status)),x=l.filter(T=>T.type==="live"),y=l.filter(T=>T.type==="regular"),b=x.filter(T=>g.includes(T.status)),j=y.filter(T=>g.includes(T.status));return{totalOrders:l.length,paidOrders:v.length,cancelledOrders:l.filter(T=>["cancelado","expirado"].includes(T.status)).length,pendingOrders:l.filter(T=>!g.includes(T.status)&&!["cancelado","expirado"].includes(T.status)).length,totalRevenue:v.reduce((T,O)=>T+O.total,0),avgTicket:v.length>0?v.reduce((T,O)=>T+O.total,0)/v.length:0,liveRevenue:b.reduce((T,O)=>T+O.total,0),regularRevenue:j.reduce((T,O)=>T+O.total,0),liveCount:x.length,regularCount:y.length,conversionRate:l.length>0?v.length/l.length*100:0}},[l]),h=P.useMemo(()=>{const g={},v=["pago","entregue","enviado"];return l.filter(x=>v.includes(x.status)).forEach(x=>{x.items.forEach(y=>{const b=y.product_name;g[b]||(g[b]={name:y.product_name,qty:0,revenue:0,image_url:y.image_url}),g[b].qty+=y.quantity,g[b].revenue+=y.product_price*y.quantity})}),Object.values(g).sort((x,y)=>y.qty-x.qty).slice(0,5)},[l]),f=g=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(g),m=g=>{switch(g){case"pago":case"entregue":case"enviado":return n.jsxs(Ae,{className:"bg-green-500 text-white gap-1",children:[n.jsx(Er,{className:"h-3 w-3"}),g==="pago"?"Pago":g==="enviado"?"Enviado":"Entregue"]});case"cancelado":case"expirado":return n.jsxs(Ae,{variant:"destructive",className:"gap-1",children:[n.jsx(qn,{className:"h-3 w-3"}),g==="cancelado"?"Cancelado":"Expirado"]});case"aguardando_pagamento":return n.jsxs(Ae,{className:"bg-amber-500 text-white gap-1",children:[n.jsx(Br,{className:"h-3 w-3"}),"Aguardando"]});default:return n.jsx(Ae,{variant:"secondary",className:"gap-1",children:g==="pendente"?"Pendente":g})}},p=()=>{const g=["Data","Tipo","Origem","Status","Total","Itens"],v=l.map(j=>[Ht(new Date(j.created_at),"dd/MM/yyyy HH:mm"),j.type==="live"?"Live":"Loja",j.source_name,j.status,j.total.toFixed(2),j.items.map(T=>`${T.product_name} x${T.quantity}`).join("; ")]),x=[g,...v].map(j=>j.map(T=>`"${T}"`).join(",")).join(`
`),y=new Blob([x],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a");b.href=URL.createObjectURL(y),b.download=`vendas-cliente-${e.slice(0,8)}.csv`,b.click()};return a?n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(Pl,{className:"h-5 w-5"}),"Relatrio de Vendas"]})}),n.jsxs(Be,{className:"space-y-4",children:[n.jsx(Kr,{className:"h-24 w-full"}),n.jsx(Kr,{className:"h-40 w-full"})]})]}):n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(Pl,{className:"h-5 w-5"}),"Relatrio de Vendas Consolidado"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Kt,{value:o,onValueChange:c,children:[n.jsx(Vt,{className:"w-[140px]",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todo perodo"}),n.jsx(ze,{value:"30d",children:"ltimos 30 dias"}),n.jsx(ze,{value:"90d",children:"ltimos 90 dias"}),n.jsx(ze,{value:"1y",children:"ltimo ano"})]})]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:p,children:[n.jsx(Af,{className:"h-4 w-4 mr-1"}),"CSV"]})]})]})}),n.jsxs(Be,{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[n.jsxs("div",{className:"p-4 bg-gradient-to-br from-primary/10 to-primary/5 rounded-lg",children:[n.jsx("div",{className:"text-3xl font-bold",children:u.paidOrders}),n.jsx("div",{className:"text-sm text-muted-foreground",children:"Pedidos Pagos"})]}),n.jsxs("div",{className:"p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-lg border border-green-200",children:[n.jsx("div",{className:"text-3xl font-bold text-green-600",children:f(u.totalRevenue)}),n.jsx("div",{className:"text-sm text-green-600",children:"Receita Total"})]}),n.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[n.jsx("div",{className:"text-3xl font-bold",children:f(u.avgTicket)}),n.jsx("div",{className:"text-sm text-muted-foreground",children:"Ticket Mdio"})]}),n.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[n.jsxs("div",{className:"text-3xl font-bold",children:[u.conversionRate.toFixed(0),"%"]}),n.jsx("div",{className:"text-sm text-muted-foreground",children:"Converso"})]})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[n.jsxs("div",{className:"p-4 border rounded-lg space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[n.jsx(Ts,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm font-medium",children:"Lives"})]}),n.jsxs("div",{className:"flex justify-between items-end",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:u.liveCount}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"pedidos"})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-lg font-semibold text-green-600",children:f(u.liveRevenue)}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"receita"})]})]})]}),n.jsxs("div",{className:"p-4 border rounded-lg space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[n.jsx(ln,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm font-medium",children:"Loja Online"})]}),n.jsxs("div",{className:"flex justify-between items-end",children:[n.jsxs("div",{children:[n.jsx("div",{className:"text-2xl font-bold",children:u.regularCount}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"pedidos"})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-lg font-semibold text-green-600",children:f(u.regularRevenue)}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"receita"})]})]})]})]}),h.length>0&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h4",{className:"font-medium text-sm text-muted-foreground flex items-center gap-2",children:[n.jsx(_s,{className:"h-4 w-4"}),"Produtos Mais Comprados"]}),n.jsx("div",{className:"space-y-2",children:h.map((g,v)=>n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-muted/30 rounded-lg",children:[n.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-primary/10 rounded-full text-sm font-bold",children:v+1}),n.jsx("div",{className:"w-10 h-10 bg-muted rounded overflow-hidden shrink-0",children:g.image_url?n.jsx("img",{src:g.image_url,alt:"",className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium truncate",children:g.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[g.qty,"x comprado"]})]}),n.jsx("div",{className:"text-right shrink-0",children:n.jsx("div",{className:"font-medium",children:f(g.revenue)})})]},g.name))})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("h4",{className:"font-medium text-sm text-muted-foreground flex items-center gap-2",children:[n.jsx(is,{className:"h-4 w-4"}),"Histrico Completo (",l.length,")"]}),l.length===0?n.jsx("p",{className:"text-center py-6 text-muted-foreground",children:"Nenhum pedido encontrado no perodo selecionado."}):n.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto pr-2",children:l.map(g=>n.jsxs("div",{className:"border rounded-lg p-3 space-y-2 hover:bg-muted/30 transition-colors",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[g.type==="live"?n.jsx(Ts,{className:"h-4 w-4 text-purple-500"}):n.jsx(ln,{className:"h-4 w-4 text-blue-500"}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-sm",children:g.source_name}),n.jsx("div",{className:"text-xs text-muted-foreground",children:Ht(new Date(g.created_at),"dd/MM/yyyy 's' HH:mm",{locale:gr})})]})]}),n.jsxs("div",{className:"text-right",children:[m(g.status),n.jsx("div",{className:"font-bold mt-1",children:f(g.total)})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-1",children:[g.items.slice(0,3).map(v=>n.jsxs(Ae,{variant:"outline",className:"text-xs font-normal",children:[v.product_name," x",v.quantity]},v.id)),g.items.length>3&&n.jsxs(Ae,{variant:"outline",className:"text-xs font-normal",children:["+",g.items.length-3]})]})]},g.id))})]})]})]})}function D_e({photos:e,onPhotosUpdate:t}){const[r,s]=P.useState(null),[a,i]=P.useState(!1),[o,c]=P.useState(""),[d,l]=P.useState(!1),u=p=>new Date(p).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit"}),h=async(p,g)=>{g.stopPropagation();try{const{error:v}=await ce.from("customer_inspiration_photos").update({is_starred:!p.is_starred}).eq("id",p.id);if(v)throw v;t()}catch(v){console.error("Error updating star:",v),de.error("Erro ao atualizar")}},f=async()=>{if(r){l(!0);try{const{error:p}=await ce.from("customer_inspiration_photos").update({merchant_notes:o}).eq("id",r.id);if(p)throw p;i(!1),t(),de.success("Anotao salva!")}catch(p){console.error("Error saving notes:",p),de.error("Erro ao salvar anotao")}finally{l(!1)}}},m=p=>{s(p),c(p.merchant_notes||""),i(!1)};return e.length===0?n.jsx(De,{children:n.jsxs(Be,{className:"py-12 text-center text-muted-foreground",children:[n.jsx(Ma,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhuma foto de inspirao enviada."}),n.jsx("p",{className:"text-sm mt-1",children:"Fotos enviadas no quiz aparecero aqui."})]})}):n.jsxs(n.Fragment,{children:[n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"text-lg flex items-center gap-2",children:[n.jsx(Ma,{className:"h-5 w-5"}),"Inspiraes enviadas (",e.length,")"]})}),n.jsx(Be,{children:n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:e.map(p=>n.jsxs("div",{className:"group relative cursor-pointer",onClick:()=>m(p),children:[n.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-secondary",children:n.jsx("img",{src:p.image_url,alt:"Inspirao",className:"w-full h-full object-cover group-hover:scale-105 transition-transform"})}),n.jsx("button",{onClick:g=>h(p,g),className:`absolute top-2 right-2 p-1.5 rounded-full transition-colors ${p.is_starred?"bg-yellow-400 text-yellow-900":"bg-white/80 text-muted-foreground hover:bg-white"}`,children:n.jsx(ki,{className:"h-3.5 w-3.5",fill:p.is_starred?"currentColor":"none"})}),p.merchant_notes&&n.jsxs(Ae,{variant:"secondary",className:"absolute bottom-2 left-2 text-xs gap-1 bg-white/90",children:[n.jsx(ea,{className:"h-2.5 w-2.5"}),"Nota"]}),n.jsx(Ae,{variant:"outline",className:"absolute top-2 left-2 text-xs bg-white/90",children:p.source==="quiz"?"Quiz":p.source==="mission"?"Misso":"Upload"})]},p.id))})})]}),n.jsx(cn,{open:!!r,onOpenChange:()=>s(null),children:n.jsxs(sn,{className:"max-w-2xl",children:[n.jsx(dn,{className:"sr-only",children:"Detalhes da foto"}),r&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:r.image_url,alt:"Inspirao",className:"w-full max-h-[60vh] object-contain rounded-lg bg-secondary"}),n.jsx("button",{onClick:p=>h(r,p),className:`absolute top-4 right-4 p-2 rounded-full transition-colors ${r.is_starred?"bg-yellow-400 text-yellow-900":"bg-white/80 text-muted-foreground hover:bg-white"}`,children:n.jsx(ki,{className:"h-5 w-5",fill:r.is_starred?"currentColor":"none"})})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ae,{variant:"outline",children:r.source==="quiz"?"Quiz":r.source==="mission"?"Misso":"Upload"}),n.jsx("span",{className:"text-sm text-muted-foreground",children:u(r.created_at)})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("label",{className:"text-sm font-medium",children:"Anotao do lojista"}),!a&&n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>i(!0),children:[n.jsx(ea,{className:"h-4 w-4 mr-1"}),"Editar"]})]}),a?n.jsxs("div",{className:"space-y-2",children:[n.jsx(Yn,{value:o,onChange:p=>c(p.target.value),placeholder:"Adicione uma anotao sobre esta foto...",rows:3}),n.jsxs("div",{className:"flex gap-2 justify-end",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>{i(!1),c(r.merchant_notes||"")},children:[n.jsx(an,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),n.jsxs(he,{size:"sm",onClick:f,disabled:d,children:[d?n.jsx(At,{className:"h-4 w-4 animate-spin mr-1"}):n.jsx(xn,{className:"h-4 w-4 mr-1"}),"Salvar"]})]})]}):n.jsx("p",{className:"text-sm text-muted-foreground bg-secondary/50 rounded-lg p-3",children:r.merchant_notes||"Nenhuma anotao adicionada."})]})]})]})})]})}var YC=["Enter"," "],L_e=["ArrowDown","PageUp","Home"],nK=["ArrowUp","PageDown","End"],B_e=[...L_e,...nK],$_e={ltr:[...YC,"ArrowRight"],rtl:[...YC,"ArrowLeft"]},F_e={ltr:["ArrowLeft"],rtl:["ArrowRight"]},I1="Menu",[pv,z_e,U_e]=w_(I1),[Of,sK]=ta(I1,[U_e,Cc,Eg]),lj=Cc(),aK=Eg(),[V_e,Rf]=Of(I1),[q_e,D1]=Of(I1),iK=e=>{const{__scopeMenu:t,open:r=!1,children:s,dir:a,onOpenChange:i,modal:o=!0}=e,c=lj(t),[d,l]=P.useState(null),u=P.useRef(!1),h=Ws(i),f=Cg(a);return P.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),n.jsx(p1,{...c,children:n.jsx(V_e,{scope:t,open:r,onOpenChange:h,content:d,onContentChange:l,children:n.jsx(q_e,{scope:t,onClose:P.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:u,dir:f,modal:o,children:s})})})};iK.displayName=I1;var W_e="MenuAnchor",D8=P.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e,a=lj(r);return n.jsx(yg,{...a,...s,ref:t})});D8.displayName=W_e;var L8="MenuPortal",[H_e,oK]=Of(L8,{forceMount:void 0}),lK=e=>{const{__scopeMenu:t,forceMount:r,children:s,container:a}=e,i=Rf(L8,t);return n.jsx(H_e,{scope:t,forceMount:r,children:n.jsx(Gs,{present:r||i.open,children:n.jsx(mg,{asChild:!0,container:a,children:s})})})};lK.displayName=L8;var Wo="MenuContent",[G_e,B8]=Of(Wo),cK=P.forwardRef((e,t)=>{const r=oK(Wo,e.__scopeMenu),{forceMount:s=r.forceMount,...a}=e,i=Rf(Wo,e.__scopeMenu),o=D1(Wo,e.__scopeMenu);return n.jsx(pv.Provider,{scope:e.__scopeMenu,children:n.jsx(Gs,{present:s||i.open,children:n.jsx(pv.Slot,{scope:e.__scopeMenu,children:o.modal?n.jsx(K_e,{...a,ref:t}):n.jsx(X_e,{...a,ref:t})})})})}),K_e=P.forwardRef((e,t)=>{const r=Rf(Wo,e.__scopeMenu),s=P.useRef(null),a=Ir(t,s);return P.useEffect(()=>{const i=s.current;if(i)return $_(i)},[]),n.jsx($8,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:kt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),X_e=P.forwardRef((e,t)=>{const r=Rf(Wo,e.__scopeMenu);return n.jsx($8,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),Y_e=Eu("MenuContent.ScrollLock"),$8=P.forwardRef((e,t)=>{const{__scopeMenu:r,loop:s=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:c,onEntryFocus:d,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:m,disableOutsideScroll:p,...g}=e,v=Rf(Wo,r),x=D1(Wo,r),y=lj(r),b=aK(r),j=z_e(r),[T,O]=P.useState(null),R=P.useRef(null),D=Ir(t,R,v.onContentChange),L=P.useRef(0),q=P.useRef(""),X=P.useRef(0),H=P.useRef(null),M=P.useRef("right"),F=P.useRef(0),S=p?b1:P.Fragment,E=p?{as:Y_e,allowPinchZoom:!0}:void 0,N=k=>{var J,V;const I=q.current+k,U=j().filter(W=>!W.disabled),$=document.activeElement,Y=(J=U.find(W=>W.ref.current===$))==null?void 0:J.textValue,Z=U.map(W=>W.textValue),re=lje(Z,I,Y),G=(V=U.find(W=>W.textValue===re))==null?void 0:V.ref.current;(function W(ee){q.current=ee,window.clearTimeout(L.current),ee!==""&&(L.current=window.setTimeout(()=>W(""),1e3))})(I),G&&setTimeout(()=>G.focus())};P.useEffect(()=>()=>window.clearTimeout(L.current),[]),L_();const C=P.useCallback(k=>{var U,$;return M.current===((U=H.current)==null?void 0:U.side)&&dje(k,($=H.current)==null?void 0:$.area)},[]);return n.jsx(G_e,{scope:r,searchRef:q,onItemEnter:P.useCallback(k=>{C(k)&&k.preventDefault()},[C]),onItemLeave:P.useCallback(k=>{var I;C(k)||((I=R.current)==null||I.focus(),O(null))},[C]),onTriggerLeave:P.useCallback(k=>{C(k)&&k.preventDefault()},[C]),pointerGraceTimerRef:X,onPointerGraceIntentChange:P.useCallback(k=>{H.current=k},[]),children:n.jsx(S,{...E,children:n.jsx(y1,{asChild:!0,trapped:a,onMountAutoFocus:kt(i,k=>{var I;k.preventDefault(),(I=R.current)==null||I.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:n.jsx(Fu,{asChild:!0,disableOutsidePointerEvents:c,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:f,onDismiss:m,children:n.jsx(Xk,{asChild:!0,...b,dir:x.dir,orientation:"vertical",loop:s,currentTabStopId:T,onCurrentTabStopIdChange:O,onEntryFocus:kt(d,k=>{x.isUsingKeyboardRef.current||k.preventDefault()}),preventScrollOnEntryFocus:!0,children:n.jsx(g1,{role:"menu","aria-orientation":"vertical","data-state":SK(v.open),"data-radix-menu-content":"",dir:x.dir,...y,...g,ref:D,style:{outline:"none",...g.style},onKeyDown:kt(g.onKeyDown,k=>{const U=k.target.closest("[data-radix-menu-content]")===k.currentTarget,$=k.ctrlKey||k.altKey||k.metaKey,Y=k.key.length===1;U&&(k.key==="Tab"&&k.preventDefault(),!$&&Y&&N(k.key));const Z=R.current;if(k.target!==Z||!B_e.includes(k.key))return;k.preventDefault();const G=j().filter(J=>!J.disabled).map(J=>J.ref.current);nK.includes(k.key)&&G.reverse(),ije(G)}),onBlur:kt(e.onBlur,k=>{k.currentTarget.contains(k.target)||(window.clearTimeout(L.current),q.current="")}),onPointerMove:kt(e.onPointerMove,gv(k=>{const I=k.target,U=F.current!==k.clientX;if(k.currentTarget.contains(I)&&U){const $=k.clientX>F.current?"right":"left";M.current=$,F.current=k.clientX}}))})})})})})})});cK.displayName=Wo;var Z_e="MenuGroup",F8=P.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e;return n.jsx(er.div,{role:"group",...s,ref:t})});F8.displayName=Z_e;var Q_e="MenuLabel",dK=P.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e;return n.jsx(er.div,{...s,ref:t})});dK.displayName=Q_e;var Vw="MenuItem",qM="menu.itemSelect",cj=P.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:s,...a}=e,i=P.useRef(null),o=D1(Vw,e.__scopeMenu),c=B8(Vw,e.__scopeMenu),d=Ir(t,i),l=P.useRef(!1),u=()=>{const h=i.current;if(!r&&h){const f=new CustomEvent(qM,{bubbles:!0,cancelable:!0});h.addEventListener(qM,m=>s==null?void 0:s(m),{once:!0}),J6(h,f),f.defaultPrevented?l.current=!1:o.onClose()}};return n.jsx(uK,{...a,ref:d,disabled:r,onClick:kt(e.onClick,u),onPointerDown:h=>{var f;(f=e.onPointerDown)==null||f.call(e,h),l.current=!0},onPointerUp:kt(e.onPointerUp,h=>{var f;l.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:kt(e.onKeyDown,h=>{const f=c.searchRef.current!=="";r||f&&h.key===" "||YC.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});cj.displayName=Vw;var uK=P.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:s=!1,textValue:a,...i}=e,o=B8(Vw,r),c=aK(r),d=P.useRef(null),l=Ir(t,d),[u,h]=P.useState(!1),[f,m]=P.useState("");return P.useEffect(()=>{const p=d.current;p&&m((p.textContent??"").trim())},[i.children]),n.jsx(pv.ItemSlot,{scope:r,disabled:s,textValue:a??f,children:n.jsx(Yk,{asChild:!0,...c,focusable:!s,children:n.jsx(er.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":s||void 0,"data-disabled":s?"":void 0,...i,ref:l,onPointerMove:kt(e.onPointerMove,gv(p=>{s?o.onItemLeave(p):(o.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:kt(e.onPointerLeave,gv(p=>o.onItemLeave(p))),onFocus:kt(e.onFocus,()=>h(!0)),onBlur:kt(e.onBlur,()=>h(!1))})})})}),J_e="MenuCheckboxItem",hK=P.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:s,...a}=e;return n.jsx(xK,{scope:e.__scopeMenu,checked:r,children:n.jsx(cj,{role:"menuitemcheckbox","aria-checked":qw(r)?"mixed":r,...a,ref:t,"data-state":U8(r),onSelect:kt(a.onSelect,()=>s==null?void 0:s(qw(r)?!0:!r),{checkForDefaultPrevented:!1})})})});hK.displayName=J_e;var fK="MenuRadioGroup",[eje,tje]=Of(fK,{value:void 0,onValueChange:()=>{}}),mK=P.forwardRef((e,t)=>{const{value:r,onValueChange:s,...a}=e,i=Ws(s);return n.jsx(eje,{scope:e.__scopeMenu,value:r,onValueChange:i,children:n.jsx(F8,{...a,ref:t})})});mK.displayName=fK;var pK="MenuRadioItem",gK=P.forwardRef((e,t)=>{const{value:r,...s}=e,a=tje(pK,e.__scopeMenu),i=r===a.value;return n.jsx(xK,{scope:e.__scopeMenu,checked:i,children:n.jsx(cj,{role:"menuitemradio","aria-checked":i,...s,ref:t,"data-state":U8(i),onSelect:kt(s.onSelect,()=>{var o;return(o=a.onValueChange)==null?void 0:o.call(a,r)},{checkForDefaultPrevented:!1})})})});gK.displayName=pK;var z8="MenuItemIndicator",[xK,rje]=Of(z8,{checked:!1}),vK=P.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:s,...a}=e,i=rje(z8,r);return n.jsx(Gs,{present:s||qw(i.checked)||i.checked===!0,children:n.jsx(er.span,{...a,ref:t,"data-state":U8(i.checked)})})});vK.displayName=z8;var nje="MenuSeparator",yK=P.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e;return n.jsx(er.div,{role:"separator","aria-orientation":"horizontal",...s,ref:t})});yK.displayName=nje;var sje="MenuArrow",bK=P.forwardRef((e,t)=>{const{__scopeMenu:r,...s}=e,a=lj(r);return n.jsx(x1,{...a,...s,ref:t})});bK.displayName=sje;var aje="MenuSub",[vet,wK]=Of(aje),X0="MenuSubTrigger",_K=P.forwardRef((e,t)=>{const r=Rf(X0,e.__scopeMenu),s=D1(X0,e.__scopeMenu),a=wK(X0,e.__scopeMenu),i=B8(X0,e.__scopeMenu),o=P.useRef(null),{pointerGraceTimerRef:c,onPointerGraceIntentChange:d}=i,l={__scopeMenu:e.__scopeMenu},u=P.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return P.useEffect(()=>u,[u]),P.useEffect(()=>{const h=c.current;return()=>{window.clearTimeout(h),d(null)}},[c,d]),n.jsx(D8,{asChild:!0,...l,children:n.jsx(uK,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":a.contentId,"data-state":SK(r.open),...e,ref:cd(t,a.onTriggerChange),onClick:h=>{var f;(f=e.onClick)==null||f.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:kt(e.onPointerMove,gv(h=>{i.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!r.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:kt(e.onPointerLeave,gv(h=>{var m,p;u();const f=(m=r.content)==null?void 0:m.getBoundingClientRect();if(f){const g=(p=r.content)==null?void 0:p.dataset.side,v=g==="right",x=v?-5:5,y=f[v?"left":"right"],b=f[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+x,y:h.clientY},{x:y,y:f.top},{x:b,y:f.top},{x:b,y:f.bottom},{x:y,y:f.bottom}],side:g}),window.clearTimeout(c.current),c.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:kt(e.onKeyDown,h=>{var m;const f=i.searchRef.current!=="";e.disabled||f&&h.key===" "||$_e[s.dir].includes(h.key)&&(r.onOpenChange(!0),(m=r.content)==null||m.focus(),h.preventDefault())})})})});_K.displayName=X0;var jK="MenuSubContent",NK=P.forwardRef((e,t)=>{const r=oK(Wo,e.__scopeMenu),{forceMount:s=r.forceMount,...a}=e,i=Rf(Wo,e.__scopeMenu),o=D1(Wo,e.__scopeMenu),c=wK(jK,e.__scopeMenu),d=P.useRef(null),l=Ir(t,d);return n.jsx(pv.Provider,{scope:e.__scopeMenu,children:n.jsx(Gs,{present:s||i.open,children:n.jsx(pv.Slot,{scope:e.__scopeMenu,children:n.jsx($8,{id:c.contentId,"aria-labelledby":c.triggerId,...a,ref:l,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var h;o.isUsingKeyboardRef.current&&((h=d.current)==null||h.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:kt(e.onFocusOutside,u=>{u.target!==c.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:kt(e.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:kt(e.onKeyDown,u=>{var m;const h=u.currentTarget.contains(u.target),f=F_e[o.dir].includes(u.key);h&&f&&(i.onOpenChange(!1),(m=c.trigger)==null||m.focus(),u.preventDefault())})})})})})});NK.displayName=jK;function SK(e){return e?"open":"closed"}function qw(e){return e==="indeterminate"}function U8(e){return qw(e)?"indeterminate":e?"checked":"unchecked"}function ije(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function oje(e,t){return e.map((r,s)=>e[(t+s)%e.length])}function lje(e,t,r){const a=t.length>1&&Array.from(t).every(l=>l===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let o=oje(e,Math.max(i,0));a.length===1&&(o=o.filter(l=>l!==r));const d=o.find(l=>l.toLowerCase().startsWith(a.toLowerCase()));return d!==r?d:void 0}function cje(e,t){const{x:r,y:s}=e;let a=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const c=t[i],d=t[o],l=c.x,u=c.y,h=d.x,f=d.y;u>s!=f>s&&r<(h-l)*(s-u)/(f-u)+l&&(a=!a)}return a}function dje(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return cje(r,t)}function gv(e){return t=>t.pointerType==="mouse"?e(t):void 0}var uje=iK,hje=D8,fje=lK,mje=cK,pje=F8,gje=dK,xje=cj,vje=hK,yje=mK,bje=gK,wje=vK,_je=yK,jje=bK,Nje=_K,Sje=NK,dj="DropdownMenu",[Cje,yet]=ta(dj,[sK]),Ri=sK(),[Eje,CK]=Cje(dj),EK=e=>{const{__scopeDropdownMenu:t,children:r,dir:s,open:a,defaultOpen:i,onOpenChange:o,modal:c=!0}=e,d=Ri(t),l=P.useRef(null),[u,h]=Yi({prop:a,defaultProp:i??!1,onChange:o,caller:dj});return n.jsx(Eje,{scope:t,triggerId:xa(),triggerRef:l,contentId:xa(),open:u,onOpenChange:h,onOpenToggle:P.useCallback(()=>h(f=>!f),[h]),modal:c,children:n.jsx(uje,{...d,open:u,onOpenChange:h,dir:s,modal:c,children:r})})};EK.displayName=dj;var kK="DropdownMenuTrigger",AK=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:s=!1,...a}=e,i=CK(kK,r),o=Ri(r);return n.jsx(hje,{asChild:!0,...o,children:n.jsx(er.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":s?"":void 0,disabled:s,...a,ref:cd(t,i.triggerRef),onPointerDown:kt(e.onPointerDown,c=>{!s&&c.button===0&&c.ctrlKey===!1&&(i.onOpenToggle(),i.open||c.preventDefault())}),onKeyDown:kt(e.onKeyDown,c=>{s||(["Enter"," "].includes(c.key)&&i.onOpenToggle(),c.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(c.key)&&c.preventDefault())})})})});AK.displayName=kK;var kje="DropdownMenuPortal",TK=e=>{const{__scopeDropdownMenu:t,...r}=e,s=Ri(t);return n.jsx(fje,{...s,...r})};TK.displayName=kje;var PK="DropdownMenuContent",OK=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=CK(PK,r),i=Ri(r),o=P.useRef(!1);return n.jsx(mje,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...s,ref:t,onCloseAutoFocus:kt(e.onCloseAutoFocus,c=>{var d;o.current||(d=a.triggerRef.current)==null||d.focus(),o.current=!1,c.preventDefault()}),onInteractOutside:kt(e.onInteractOutside,c=>{const d=c.detail.originalEvent,l=d.button===0&&d.ctrlKey===!0,u=d.button===2||l;(!a.modal||u)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});OK.displayName=PK;var Aje="DropdownMenuGroup",Tje=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ri(r);return n.jsx(pje,{...a,...s,ref:t})});Tje.displayName=Aje;var Pje="DropdownMenuLabel",RK=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ri(r);return n.jsx(gje,{...a,...s,ref:t})});RK.displayName=Pje;var Oje="DropdownMenuItem",MK=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ri(r);return n.jsx(xje,{...a,...s,ref:t})});MK.displayName=Oje;var Rje="DropdownMenuCheckboxItem",IK=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ri(r);return n.jsx(vje,{...a,...s,ref:t})});IK.displayName=Rje;var Mje="DropdownMenuRadioGroup",Ije=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ri(r);return n.jsx(yje,{...a,...s,ref:t})});Ije.displayName=Mje;var Dje="DropdownMenuRadioItem",DK=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ri(r);return n.jsx(bje,{...a,...s,ref:t})});DK.displayName=Dje;var Lje="DropdownMenuItemIndicator",LK=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ri(r);return n.jsx(wje,{...a,...s,ref:t})});LK.displayName=Lje;var Bje="DropdownMenuSeparator",BK=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ri(r);return n.jsx(_je,{...a,...s,ref:t})});BK.displayName=Bje;var $je="DropdownMenuArrow",Fje=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ri(r);return n.jsx(jje,{...a,...s,ref:t})});Fje.displayName=$je;var zje="DropdownMenuSubTrigger",$K=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ri(r);return n.jsx(Nje,{...a,...s,ref:t})});$K.displayName=zje;var Uje="DropdownMenuSubContent",FK=P.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...s}=e,a=Ri(r);return n.jsx(Sje,{...a,...s,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});FK.displayName=Uje;var Vje=EK,qje=AK,Wje=TK,zK=OK,UK=RK,VK=MK,qK=IK,WK=DK,HK=LK,GK=BK,KK=$K,XK=FK;const L1=Vje,B1=qje,Hje=P.forwardRef(({className:e,inset:t,children:r,...s},a)=>n.jsxs(KK,{ref:a,className:We("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",t&&"pl-8",e),...s,children:[r,n.jsx(Dn,{className:"ml-auto h-4 w-4"})]}));Hje.displayName=KK.displayName;const Gje=P.forwardRef(({className:e,...t},r)=>n.jsx(XK,{ref:r,className:We("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Gje.displayName=XK.displayName;const Ig=P.forwardRef(({className:e,sideOffset:t=4,...r},s)=>n.jsx(Wje,{children:n.jsx(zK,{ref:s,sideOffset:t,className:We("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));Ig.displayName=zK.displayName;const po=P.forwardRef(({className:e,inset:t,...r},s)=>n.jsx(VK,{ref:s,className:We("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t&&"pl-8",e),...r}));po.displayName=VK.displayName;const Kje=P.forwardRef(({className:e,children:t,checked:r,...s},a)=>n.jsxs(qK,{ref:a,className:We("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),checked:r,...s,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(HK,{children:n.jsx(xn,{className:"h-4 w-4"})})}),t]}));Kje.displayName=qK.displayName;const Xje=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(WK,{ref:s,className:We("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e),...r,children:[n.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:n.jsx(HK,{children:n.jsx(Kz,{className:"h-2 w-2 fill-current"})})}),t]}));Xje.displayName=WK.displayName;const Yje=P.forwardRef(({className:e,inset:t,...r},s)=>n.jsx(UK,{ref:s,className:We("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));Yje.displayName=UK.displayName;const YK=P.forwardRef(({className:e,...t},r)=>n.jsx(GK,{ref:r,className:We("-mx-1 my-1 h-px bg-muted",e),...t}));YK.displayName=GK.displayName;const E0={nova:{label:"Nova",icon:pw,color:"bg-orange-100 text-orange-700 border-orange-300"},mostrei:{label:"J mostrei",icon:ci,color:"bg-blue-100 text-blue-700 border-blue-300"},enviei:{label:"J enviei",icon:zu,color:"bg-purple-100 text-purple-700 border-purple-300"},gostou:{label:"Gostou",icon:Tae,color:"bg-emerald-100 text-emerald-700 border-emerald-300"},nao_gostou:{label:"No gostou",icon:Aae,color:"bg-red-100 text-red-700 border-red-300"}};function Zje({customerId:e,customer:t,suggestions:r,onRefresh:s}){const[a,i]=P.useState(null),o=[t.size_letter,t.size_number,"UN","nico"].filter(Boolean),c=async(m,p)=>{i(m);try{const{error:g}=await ce.from("customer_product_suggestions").update({status:p}).eq("id",m);if(g)throw g;s(),de.success(`Status atualizado para "${E0[p].label}"`)}catch(g){console.error("Error updating status:",g),de.error("Erro ao atualizar status")}finally{i(null)}},d=m=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(m),l=m=>{if(!m)return null;if(m.images&&m.images.length>0){const p=m.main_image_index||0;return m.images[p]||m.images[0]}return m.image_url},u=m=>{if(!(m!=null&&m.stock_by_size))return 0;const p=m.stock_by_size;let g=0;return o.forEach(v=>{if(!v)return;const x=Object.keys(p).find(y=>y.toLowerCase()===v.toLowerCase());x&&(g+=p[x]||0)}),g},h=m=>{var b;const p=m.product;if(!p)return;const g=[t.size_letter,t.size_number].filter(Boolean).join("/"),v=((b=m.reasons)==null?void 0:b.length)>0?`

Essa pea combina com voc porque: ${m.reasons.slice(0,2).join(", ")}.`:"",x=`${window.location.origin}/produto/${p.id}`,y=`Oi${t.name?`, ${t.name}`:""} 

Separei essa pea porque combina MUITO com seu estilo${t.style_title?` ${t.style_title}`:""} e fica perfeita no seu tamanho ${g}.${v}

*${p.name}*
${d(p.price)}

Link: ${x}

Me conta o que achou! `;navigator.clipboard.writeText(y),de.success("Mensagem copiada!")},f=m=>{h(m);const p=t.phone.replace(/\D/g,""),g=p.startsWith("55")?p:`55${p}`;window.open(`https://wa.me/${g}`,"_blank")};return r.length===0?n.jsx(De,{children:n.jsxs(Be,{className:"py-12 text-center text-muted-foreground",children:[n.jsx(Wr,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhuma sugesto disponvel ainda."}),n.jsx("p",{className:"text-sm mt-1",children:"Sugestes so geradas automaticamente baseadas no perfil da cliente."})]})}):n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"text-lg flex items-center gap-2",children:[n.jsx(Wr,{className:"h-5 w-5 text-primary"}),"Sugestes de Produtos",n.jsxs(Ae,{variant:"secondary",className:"ml-2",children:[r.length," sugestes"]})]})}),n.jsx(Be,{children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(m=>{var y,b,j;const p=m.product,g=m.status,v=((y=E0[g])==null?void 0:y.icon)||pw,x=u(p);return n.jsxs("div",{className:"bg-secondary/30 rounded-lg overflow-hidden border border-border",children:[n.jsxs("div",{className:"aspect-square relative",children:[l(p)?n.jsx("img",{src:l(p),alt:(p==null?void 0:p.name)||"Produto",className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full bg-secondary flex items-center justify-center",children:n.jsx(Ut,{className:"h-8 w-8 text-muted-foreground"})}),n.jsxs(L1,{children:[n.jsx(B1,{asChild:!0,children:n.jsxs("button",{className:`absolute top-2 left-2 px-2 py-1 rounded-full text-xs font-medium border flex items-center gap-1 ${((b=E0[g])==null?void 0:b.color)||"bg-gray-100"}`,disabled:a===m.id,children:[a===m.id?n.jsx(At,{className:"h-3 w-3 animate-spin"}):n.jsx(v,{className:"h-3 w-3"}),((j=E0[g])==null?void 0:j.label)||"Nova"]})}),n.jsx(Ig,{children:Object.entries(E0).map(([T,O])=>n.jsxs(po,{onClick:()=>c(m.id,T),children:[n.jsx(O.icon,{className:"h-4 w-4 mr-2"}),O.label]},T))})]}),n.jsxs(Ae,{variant:"secondary",className:"absolute top-2 right-2 text-xs bg-white/90",children:[x," em estoque"]})]}),n.jsxs("div",{className:"p-3 space-y-2",children:[n.jsx("p",{className:"font-medium text-sm line-clamp-2",children:p==null?void 0:p.name}),n.jsx("p",{className:"text-primary font-bold",children:p?d(p.price):"-"}),m.reasons&&m.reasons.length>0&&n.jsx("div",{className:"flex flex-wrap gap-1",children:m.reasons.slice(0,2).map((T,O)=>n.jsx(Ae,{variant:"outline",className:"text-xs",children:T},O))}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"flex-1 gap-1 text-xs",onClick:()=>h(m),children:[n.jsx(Ia,{className:"h-3 w-3"}),"Copiar"]}),n.jsxs(he,{size:"sm",className:"flex-1 gap-1 text-xs bg-[#25D366] hover:bg-[#128C7E] text-white",onClick:()=>f(m),children:[n.jsx(nn,{className:"h-3 w-3"}),"Enviar"]})]})]})]},m.id)})})})]})}const Qje=["PP","P","M","G","GG","XG","XXG"],Jje=["34","36","38","40","42","44","46","48","50","52"];function eNe({customer:e,onUpdate:t}){var m;const[r,s]=P.useState(!1),[a,i]=P.useState(!1),o=XC(e.address_line,e.city,e.state,e.zip_code,e.address_reference||null,e.document||null),[c,d]=P.useState({name:e.name||"",email:e.email||"",size_letter:e.size_letter||"",size_number:e.size_number||"",document:((m=e.document)==null?void 0:m.replace(/\D/g,""))||""}),[l,u]=P.useState(o);P.useEffect(()=>{var p;d({name:e.name||"",email:e.email||"",size_letter:e.size_letter||"",size_number:e.size_number||"",document:((p=e.document)==null?void 0:p.replace(/\D/g,""))||""}),u(XC(e.address_line,e.city,e.state,e.zip_code,e.address_reference||null,e.document||null))},[e]);const h=[];if(e.name||h.push({key:"name",label:"Nome"}),e.email||h.push({key:"email",label:"Email"}),!e.size_letter&&!e.size_number&&h.push({key:"size",label:"Tamanho"}),e.address_line||h.push({key:"address_line",label:"Endereo"}),e.zip_code||h.push({key:"zip_code",label:"CEP"}),e.city||h.push({key:"city",label:"Cidade"}),e.state||h.push({key:"state",label:"Estado"}),h.length===0)return null;const f=async()=>{i(!0);try{const g=[l.street,l.number,l.complement,l.neighborhood].filter(Boolean).join(", "),v=(c.document||l.document||"").replace(/\D/g,""),{error:x}=await ce.from("customers").update({name:c.name||null,email:c.email||null,size_letter:c.size_letter||null,size_number:c.size_number||null,address_line:g||null,city:l.city||null,state:l.state||null,zip_code:l.zipCode||null,address_reference:l.reference||null,document:v||null}).eq("id",e.id);if(x)throw x;if(v&&l.zipCode){const{data:y}=await ce.from("customer_addresses").select("id").eq("customer_id",e.id).eq("is_default",!0).maybeSingle();y&&await ce.from("customer_addresses").update({document:v}).eq("id",y.id)}de.success("Cadastro atualizado!"),s(!1),t()}catch(p){console.error("Error updating customer:",p),de.error("Erro ao atualizar cadastro")}finally{i(!1)}};return n.jsxs(n.Fragment,{children:[n.jsxs(De,{className:"border-amber-200 bg-amber-50/50",children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-base flex items-center gap-2 text-amber-700",children:[n.jsx(Cn,{className:"h-5 w-5"}),"Cadastro incompleto"]})}),n.jsxs(Be,{className:"space-y-3",children:[n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsx("span",{className:"text-sm text-amber-700",children:"Faltam:"}),h.map(p=>n.jsx("span",{className:"px-2 py-0.5 rounded bg-amber-100 text-amber-700 text-sm",children:p.label},p.key))]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>s(!0),className:"border-amber-300 text-amber-700 hover:bg-amber-100",children:[n.jsx(Eae,{className:"h-4 w-4 mr-2"}),"Completar cadastro manualmente"]})]})]}),n.jsx(cn,{open:r,onOpenChange:s,children:n.jsxs(sn,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:[n.jsx(fn,{children:n.jsx(dn,{children:"Completar cadastro"})}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"font-medium text-sm text-muted-foreground uppercase tracking-wide",children:"Dados Pessoais"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"name",children:"Nome completo"}),n.jsx(Qe,{id:"name",value:c.name,onChange:p=>d({...c,name:p.target.value}),placeholder:"Nome da cliente"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"email",children:"Email"}),n.jsx(Qe,{id:"email",type:"email",value:c.email,onChange:p=>d({...c,email:p.target.value}),placeholder:"email@exemplo.com"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Tamanho (letra)"}),n.jsxs(Kt,{value:c.size_letter,onValueChange:p=>d({...c,size_letter:p==="_none"?"":p}),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecione"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"_none",children:"No informado"}),Qje.map(p=>n.jsx(ze,{value:p,children:p},p))]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Tamanho (nmero)"}),n.jsxs(Kt,{value:c.size_number,onValueChange:p=>d({...c,size_number:p==="_none"?"":p}),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecione"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"_none",children:"No informado"}),Jje.map(p=>n.jsx(ze,{value:p,children:p},p))]})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"document",children:"CPF"}),n.jsx(Qe,{id:"document",value:XG(c.document),onChange:p=>d({...c,document:p.target.value.replace(/\D/g,"").slice(0,11)}),placeholder:"000.000.000-00",maxLength:14}),c.document&&c.document.length>0&&c.document.length!==11&&n.jsxs("p",{className:"text-xs text-amber-600",children:["CPF deve ter 11 dgitos (",c.document.length,"/11)"]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h3",{className:"font-medium text-sm text-muted-foreground uppercase tracking-wide",children:"Endereo"}),n.jsx(oj,{value:l,onChange:u,showReference:!0,showCpf:!1})]})]}),n.jsxs(Da,{className:"gap-2 mt-6",children:[n.jsxs(he,{variant:"outline",onClick:()=>s(!1),children:[n.jsx(an,{className:"h-4 w-4 mr-1"}),"Cancelar"]}),n.jsxs(he,{onClick:f,disabled:a,children:[a?n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}):n.jsx(xn,{className:"h-4 w-4 mr-2"}),"Salvar"]})]})]})})]})}const tNe=()=>{var C,k;const{id:e}=ra(),t=fr(),{user:r,isMerchant:s,rolesLoading:a}=Hn(),[i,o]=P.useState(null),[c,d]=P.useState([]),[l,u]=P.useState([]),[h,f]=P.useState(null),[m,p]=P.useState([]),[g,v]=P.useState({}),[x,y]=P.useState([]),[b,j]=P.useState([]),[T,O]=P.useState([]),[R,D]=P.useState(!0),[L,q]=P.useState(!1);P.useEffect(()=>{!a&&(!r||!s())&&t("/login")},[r,s,a,t]),P.useEffect(()=>{e&&r&&X()},[e,r]);const X=async()=>{var I,U;if(e){D(!0);try{const{data:$,error:Y}=await ce.from("customers").select("*").eq("id",e).single();if(Y)throw Y;let Z=Y?null:$;if(Z&&!Z.instagram){let{data:pe}=await ce.from("live_customers").select("id, instagram_handle").eq("client_id",e).maybeSingle();if(!pe){const ge=(I=Z.phone)==null?void 0:I.replace(/\D/g,"");if(ge){const{data:Ne}=await ce.from("live_customers").select("id, instagram_handle").or(`whatsapp.ilike.%${ge}%,whatsapp.ilike.%${ge.slice(-8)}%`).limit(1).maybeSingle();Ne&&(pe=Ne,await ce.from("live_customers").update({client_id:e}).eq("id",pe.id))}}pe!=null&&pe.instagram_handle&&(await ce.from("customers").update({instagram:pe.instagram_handle}).eq("id",e),Z.instagram=pe.instagram_handle)}o(Z);const{data:re}=await ce.from("orders").select("*").eq("customer_id",e).order("created_at",{ascending:!1}),G=(U=$.phone)==null?void 0:U.replace(/\D/g,"");let J=[];if(G){const{data:pe}=await ce.from("orders").select("*").is("customer_id",null).order("created_at",{ascending:!1});J=(pe||[]).filter(ge=>{var be;const Ne=(be=ge.customer_phone)==null?void 0:be.replace(/\D/g,"");if(!Ne||!G)return!1;if(Ne===G)return!0;const _e=Me=>Me.startsWith("55")?Me.slice(2):Me;return _e(Ne)===_e(G)})}const V=[...re||[],...J],W=new Set,ee=V.filter(pe=>W.has(pe.id)?!1:(W.add(pe.id),!0)),ie=[];for(const pe of ee){const{data:ge}=await ce.from("order_items").select("*").eq("order_id",pe.id);ie.push({...pe,items:ge||[]})}d(ie);let oe=[];const{data:se}=await ce.from("quiz_responses").select("*").eq("customer_id",e).order("question_number");if(se&&se.length>0)oe=se;else if($.user_id){const{data:pe}=await ce.from("quiz_responses").select("*").eq("user_id",$.user_id).order("created_at",{ascending:!1}).limit(10);oe=pe||[]}if(u(oe),$.user_id){const{data:pe}=await ce.from("profiles").select("style_title, style_description, color_palette, avoid_items, personal_tip, size_letter, size_number, quiz_points, quiz_level, quiz_completed_at").eq("user_id",$.user_id).maybeSingle();pe&&f(pe)}const le=ce.from("print_requests").select("*").order("created_at",{ascending:!1});if($.user_id){const{data:pe}=await le.or(`customer_id.eq.${e},user_id.eq.${$.user_id}`);p(pe||[]);const ge=(pe||[]).filter(Ne=>Ne.linked_product_id).map(Ne=>Ne.linked_product_id);if(ge.length>0){const{data:Ne}=await ce.from("product_catalog").select("id, name, price, image_url").in("id",ge),_e={};(Ne||[]).forEach(be=>{_e[be.id]=be}),v(_e)}}else{const{data:pe}=await le.eq("customer_id",e);p(pe||[])}const{data:ye}=await ce.from("product_catalog").select("*").eq("is_active",!0);y(ye||[]);const{data:ue}=await ce.from("customer_inspiration_photos").select("*").eq("customer_id",e).order("is_starred",{ascending:!1}).order("created_at",{ascending:!1});j(ue||[]);const{data:ne}=await ce.from("customer_product_suggestions").select("*").eq("customer_id",e).order("score",{ascending:!1});if(ne&&ne.length>0){const pe=ne.map(be=>be.product_id),{data:ge}=await ce.from("product_catalog").select("*").in("id",pe),Ne={};(ge||[]).forEach(be=>{Ne[be.id]=be});const _e=ne.map(be=>({id:be.id,product_id:be.product_id,status:be.status||"nova",score:be.score,reasons:Array.isArray(be.reasons)?be.reasons:[],product:Ne[be.product_id]}));O(_e)}}catch($){console.error("Error loading customer data:",$),de.error("Erro ao carregar dados do cliente")}finally{D(!1)}}},H=`${window.location.origin}/quiz`;if(R||a)return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8 flex justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]});if(!i)return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 text-center",children:[n.jsx("p",{className:"text-muted-foreground",children:"Cliente no encontrado"}),n.jsx(he,{onClick:()=>t("/dashboard?tab=clientes"),className:"mt-4",children:"Voltar"})]})]});const M=i.style_title||(h==null?void 0:h.style_title),F=i.size_letter||(h==null?void 0:h.size_letter),S=i.size_number||(h==null?void 0:h.size_number),E=l.length>0||!!M||!!(h!=null&&h.quiz_completed_at),N=m.length>0;return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-5xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>t("/dashboard?tab=clientes"),children:[n.jsx(vs,{className:"h-4 w-4 mr-1"}),"Voltar para Clientes"]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>q(!0),className:"gap-1",children:[n.jsx(Hz,{className:"h-4 w-4"}),"Montar catlogo"]})]}),n.jsx("div",{className:"mb-6",children:n.jsx(E_e,{customer:{id:i.id,phone:i.phone,name:i.name,email:i.email,instagram:i.instagram,style_title:M||null,size_letter:F||null,size_number:S||null,created_at:i.created_at,total_orders:i.total_orders||0,total_spent:Number(i.total_spent)||0,last_order_at:i.last_order_at},hasQuiz:E,hasPrints:N})}),n.jsx("div",{className:"mb-6",children:n.jsx(eNe,{customer:{id:i.id,name:i.name,phone:i.phone,email:i.email,size_letter:F||null,size_number:S||null,address_line:i.address_line,city:i.city,state:i.state,zip_code:i.zip_code,address_reference:i.address_reference,document:i.document},onUpdate:X})}),n.jsxs(pi,{defaultValue:"vendas",className:"space-y-6",children:[n.jsxs(Qa,{className:"w-full justify-start flex-wrap h-auto gap-1",children:[n.jsxs(pr,{value:"vendas",className:"gap-1",children:[n.jsx(Pl,{className:"h-4 w-4"}),"Vendas"]}),n.jsxs(pr,{value:"perfil",className:"gap-1",children:[n.jsx(Wr,{className:"h-4 w-4"}),"Perfil"]}),n.jsxs(pr,{value:"pedidos",className:"gap-1",children:[n.jsx(ln,{className:"h-4 w-4"}),"Pedidos",c.length>0&&n.jsx(Ae,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:c.length})]}),n.jsxs(pr,{value:"inspiracoes",className:"gap-1",children:[n.jsx(Ma,{className:"h-4 w-4"}),"Inspiraes",b.length>0&&n.jsx(Ae,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:b.length})]}),n.jsxs(pr,{value:"prints",className:"gap-1",children:[n.jsx(Ma,{className:"h-4 w-4"}),"Prints",m.length>0&&n.jsx(Ae,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:m.length})]}),n.jsxs(pr,{value:"sugestoes",className:"gap-1",children:[n.jsx(Wr,{className:"h-4 w-4"}),"Sugestes",T.length>0&&n.jsx(Ae,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:T.length})]}),n.jsxs(pr,{value:"lives",className:"gap-1",children:[n.jsx(Ts,{className:"h-4 w-4"}),"Lives"]}),n.jsxs(pr,{value:"mensagens",className:"gap-1",children:[n.jsx(nn,{className:"h-4 w-4"}),"Mensagens"]})]}),n.jsx(wr,{value:"vendas",children:n.jsx(I_e,{customerId:i.id,customerPhone:i.phone})}),n.jsxs(wr,{value:"perfil",className:"space-y-6",children:[n.jsx(k_e,{customer:{id:i.id,name:i.name,phone:i.phone,email:i.email,instagram:i.instagram,address_line:i.address_line,city:i.city,state:i.state,zip_code:i.zip_code,document:i.document,birth_date:i.birth_date},onUpdate:X}),n.jsx(A_e,{customer:{name:i.name,style_title:M||null,size_letter:F||null,size_number:S||null},profileData:h,quizResponses:l,quizLink:H})]}),n.jsx(wr,{value:"pedidos",children:n.jsx(T_e,{orders:c})}),n.jsx(wr,{value:"inspiracoes",children:n.jsx(D_e,{photos:b,onPhotosUpdate:X})}),n.jsx(wr,{value:"prints",children:n.jsx(P_e,{prints:m,linkedProducts:g})}),n.jsx(wr,{value:"sugestoes",children:n.jsx(Zje,{customerId:i.id,customer:{name:i.name,phone:i.phone,style_title:M||null,size_letter:F||null,size_number:S||null},suggestions:T,onRefresh:X})}),n.jsx(wr,{value:"lives",children:n.jsx(M_e,{customerId:i.id})}),n.jsx(wr,{value:"mensagens",children:n.jsx(O_e,{customer:{name:i.name,size_letter:F||null,size_number:S||null},quizLink:H,lastOrderId:(C=c[0])==null?void 0:C.id,lastOrderStatus:(k=c[0])==null?void 0:k.status})})]})]}),n.jsx(HH,{open:L,onClose:()=>q(!1),customerId:i.id,customerName:i.name,customerPhone:i.phone,customerStyle:M||null,customerSizeLetter:F||null,customerSizeNumber:S||null,availableProducts:x})]})},rNe=()=>{const{link:e}=ra(),t=fr(),{user:r}=Hn(),{addItem:s,items:a}=Wu(),[i,o]=P.useState(null),[c,d]=P.useState(new Set),[l,u]=P.useState(!0),[h,f]=P.useState(null),[m,p]=P.useState({}),[g,v]=P.useState(new Set);P.useEffect(()=>{e&&x()},[e]),P.useEffect(()=>{r&&i&&y()},[r,i]);const x=async()=>{try{const{data:R,error:D}=await ce.from("customer_catalogs").select("*").eq("public_link",e).maybeSingle();if(D)throw D;if(!R){f("Catlogo no encontrado");return}const L=(R.products||[]).map(q=>q.id);if(L.length>0){const{data:q}=await ce.from("product_catalog").select("id, stock_by_size").in("id",L),X={};(q||[]).forEach(M=>{const F=M.stock_by_size;F&&(X[M.id]=Object.entries(F).filter(([S,E])=>E>0).map(([S])=>S))});const H=(R.products||[]).map(M=>({...M,sizes:X[M.id]||[]}));o({id:R.id,title:R.title,intro_text:R.intro_text,products:H,created_at:R.created_at,customer_id:R.customer_id})}else o({id:R.id,title:R.title,intro_text:R.intro_text,products:R.products||[],created_at:R.created_at,customer_id:R.customer_id})}catch(R){console.error("Error loading catalog:",R),f("Erro ao carregar catlogo")}finally{u(!1)}},y=async()=>{if(!r)return;const R=localStorage.getItem(`catalog_favorites_${i==null?void 0:i.id}`);R&&d(new Set(JSON.parse(R)))},b=async R=>{const D=new Set(c);if(c.has(R))D.delete(R),de.success("Removido dos favoritos");else if(D.add(R),de.success("Adicionado aos favoritos! "),r&&(i!=null&&i.customer_id))try{const{data:L}=await ce.from("customer_product_suggestions").select("id, status").eq("customer_id",i.customer_id).eq("product_id",R).maybeSingle();L?await ce.from("customer_product_suggestions").update({status:"gostou"}).eq("id",L.id):await ce.from("customer_product_suggestions").insert({customer_id:i.customer_id,product_id:R,status:"gostou",score:100,reasons:[{type:"favorited_in_catalog",label:"Favoritou no catlogo"}]})}catch(L){console.error("Error saving favorite:",L)}d(D),localStorage.setItem(`catalog_favorites_${i==null?void 0:i.id}`,JSON.stringify(Array.from(D)))},j=R=>{const D=m[R.id];if(!D){de.error("Selecione um tamanho");return}s({productId:R.id,name:R.name,price:R.price,originalPrice:R.price,discountPercent:0,size:D,imageUrl:R.image}),v(L=>new Set(L).add(R.id)),de.success("Adicionado ao carrinho! "),setTimeout(()=>{v(L=>{const q=new Set(L);return q.delete(R.id),q})},2e3)},T=R=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(R),O=a.reduce((R,D)=>R+D.quantity,0);return l?n.jsx("div",{className:"min-h-screen bg-gradient-to-b from-stone-50 to-white flex items-center justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-primary"})}):h||!i?n.jsx("div",{className:"min-h-screen bg-gradient-to-b from-stone-50 to-white flex items-center justify-center",children:n.jsxs("div",{className:"text-center px-4",children:[n.jsx(Wr,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground opacity-50"}),n.jsx("h1",{className:"text-xl font-serif mb-2",children:h||"Catlogo no encontrado"}),n.jsx("p",{className:"text-muted-foreground",children:"Este link pode ter expirado ou no est mais disponvel."})]})}):n.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-stone-50 to-white",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-stone-100",children:n.jsx("div",{className:"container mx-auto px-4 py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h1",{className:"font-serif text-lg",children:"Provador VIP"}),O>0&&n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>t("/carrinho"),children:[n.jsx(ln,{className:"h-4 w-4"}),n.jsx("span",{children:O})]})]})})}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsxs(Ae,{variant:"secondary",className:"mb-4 gap-1",children:[n.jsx(Wr,{className:"h-3 w-3"}),"Seleo exclusiva"]}),n.jsx("h1",{className:"font-serif text-2xl md:text-3xl mb-4",children:i.title}),i.intro_text&&n.jsx("p",{className:"text-muted-foreground leading-relaxed whitespace-pre-line",children:i.intro_text})]}),n.jsx("div",{className:"grid grid-cols-1 gap-6 mb-8",children:i.products.map((R,D)=>n.jsxs("div",{className:"bg-white rounded-xl overflow-hidden border border-stone-100 shadow-sm",children:[n.jsxs("div",{className:"aspect-[4/5] relative bg-stone-100",children:[R.image?n.jsx("img",{src:R.image,alt:R.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(ln,{className:"h-8 w-8 text-muted-foreground"})}),n.jsx("button",{className:`absolute top-3 right-3 w-10 h-10 rounded-full flex items-center justify-center transition-colors ${c.has(R.id)?"bg-red-500 text-white":"bg-white/80 backdrop-blur-sm hover:bg-white text-stone-400 hover:text-red-500"}`,onClick:()=>b(R.id),children:n.jsx(El,{className:`h-5 w-5 ${c.has(R.id)?"fill-current":""}`})}),R.color&&n.jsx(Ae,{variant:"secondary",className:"absolute bottom-3 left-3 text-xs bg-white/90",children:R.color})]}),n.jsxs("div",{className:"p-4 space-y-4",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-lg",children:R.name}),n.jsx("p",{className:"text-primary font-bold text-xl",children:T(R.price)})]}),R.sizes&&R.sizes.length>0&&n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Tamanhos disponveis:"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:R.sizes.map(L=>n.jsx("button",{onClick:()=>p(q=>({...q,[R.id]:L})),className:`px-3 py-1.5 text-sm rounded-lg border transition-colors ${m[R.id]===L?"bg-primary text-primary-foreground border-primary":"border-stone-200 hover:border-primary"}`,children:L},L))})]}),n.jsx(he,{className:"w-full gap-2",onClick:()=>j(R),disabled:!R.sizes||R.sizes.length===0,variant:g.has(R.id)?"secondary":"default",children:g.has(R.id)?n.jsxs(n.Fragment,{children:[n.jsx(xn,{className:"h-4 w-4"}),"Adicionado!"]}):n.jsxs(n.Fragment,{children:[n.jsx(An,{className:"h-4 w-4"}),"Adicionar ao carrinho"]})})]})]},R.id||D))}),c.size>0&&n.jsxs("div",{className:"mb-4 p-4 bg-red-50 rounded-xl border border-red-100",children:[n.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[n.jsx(El,{className:"h-4 w-4 fill-current"}),n.jsxs("span",{className:"font-medium",children:[c.size," pea(s) favoritada(s)"]})]}),n.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Sua consultora ver suas peas preferidas!"})]}),n.jsx("div",{className:"sticky bottom-4",children:n.jsx(he,{size:"lg",className:"w-full bg-[#25D366] hover:bg-[#128C7E] text-white gap-2 shadow-lg",asChild:!0,children:n.jsxs("a",{href:"https://wa.me/5562991223519?text=Oi!%20Vi%20o%20catlogo%20que%20voc%20preparou%20pra%20mim%20e%20adorei!%20%F0%9F%92%9B",target:"_blank",rel:"noopener noreferrer",children:[n.jsx(nn,{className:"h-5 w-5"}),"Falar sobre essas peas"]})})})]})]})},nNe=()=>{const e=Ec();return P.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),n.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:n.jsxs("div",{className:"text-center",children:[n.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),n.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),n.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})};function sNe({quizPoints:e,quizLevel:t,hasCompletedQuiz:r,lastMissionId:s,lastMissionName:a,lastMissionCompletedAt:i,nextMissionId:o,nextMissionName:c,inProgressMissionId:d}){const{level:l,title:u}=uf(e),h=g0[l-1]||0,f=g0[l]||g0[g0.length-1],m=e-h,p=f-h,g=Math.min(m/p*100,100),v=l>=g0.length,x=()=>{if(!i)return null;const y=new Date(i),j=Math.floor((new Date().getTime()-y.getTime())/(1e3*60*60*24));return j===0?"Hoje":j===1?"Ontem":j<7?`${j} dias atrs`:y.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})};return n.jsxs("div",{className:"bg-gradient-to-br from-accent/5 via-primary/5 to-accent/10 border border-accent/20 rounded-2xl p-5 mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[n.jsx(ga,{className:"h-5 w-5 text-accent"}),n.jsx("h2",{className:"font-serif text-lg",children:"Seu Progresso VIP"})]}),n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs("div",{className:"flex items-center gap-1.5 bg-accent/10 px-3 py-1.5 rounded-full",children:[n.jsx(ki,{className:"h-4 w-4 text-amber-500 fill-amber-500"}),n.jsxs("span",{className:"font-bold text-amber-700",children:[e," pts"]})]})}),n.jsxs("div",{className:"text-sm text-right",children:[n.jsxs("span",{className:"text-muted-foreground",children:["Nvel ",l,": "]}),n.jsx("span",{className:"font-medium text-accent",children:u})]})]}),!v&&n.jsxs("div",{className:"mb-4",children:[n.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground mb-1.5",children:[n.jsxs("span",{children:["Progresso para Nvel ",l+1]}),n.jsxs("span",{children:[f-e," pts restantes"]})]}),n.jsx(Mg,{value:g,className:"h-2 bg-secondary"})]}),v&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-accent mb-4",children:[n.jsx(pn,{className:"h-4 w-4"}),n.jsx("span",{className:"font-medium",children:"Nvel mximo alcanado! "})]}),n.jsx("div",{className:"mb-4",children:r?d?n.jsx(Gt,{to:`/missao/${d}`,children:n.jsxs(he,{className:"w-full gap-2 bg-amber-500 hover:bg-amber-600 text-white",children:[n.jsx(Br,{className:"h-4 w-4"}),"Continuar de onde parei",n.jsx(ps,{className:"h-4 w-4"})]})}):o?n.jsx(Gt,{to:`/missao/${o}`,children:n.jsxs(he,{className:"w-full gap-2",children:[n.jsx(ba,{className:"h-4 w-4"}),"Continuar Trilhas",n.jsx(ps,{className:"h-4 w-4"})]})}):n.jsxs("div",{className:"text-center text-sm text-muted-foreground bg-card/50 rounded-xl p-3",children:[n.jsx(pn,{className:"h-5 w-5 text-accent mx-auto mb-1"}),"Todas as misses completadas! "]}):n.jsx(Gt,{to:"/quiz",children:n.jsxs(he,{className:"w-full gap-2 bg-accent hover:bg-accent/90",children:[n.jsx(Wr,{className:"h-4 w-4"}),"Fazer Quiz Base",n.jsx(ps,{className:"h-4 w-4"})]})})}),r&&n.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[a&&n.jsxs("div",{className:"bg-card/50 rounded-xl p-3",children:[n.jsx("p",{className:"text-muted-foreground mb-0.5",children:"ltima misso"}),n.jsx("p",{className:"font-medium truncate",children:a}),i&&n.jsx("p",{className:"text-muted-foreground text-[10px]",children:x()})]}),c&&!d&&n.jsxs("div",{className:"bg-card/50 rounded-xl p-3",children:[n.jsx("p",{className:"text-muted-foreground mb-0.5",children:"Prxima sugerida"}),n.jsx("p",{className:"font-medium truncate",children:c})]})]}),r&&n.jsx("div",{className:"mt-4 pt-4 border-t border-border/50",children:n.jsxs(Ac,{children:[n.jsx(E1,{asChild:!0,children:n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full text-muted-foreground hover:text-foreground gap-2",children:[n.jsx(f1,{className:"h-4 w-4"}),"Refazer Quiz de Estilo"]})}),n.jsxs(Dl,{children:[n.jsxs(Ll,{children:[n.jsx(Bl,{children:"Refazer Quiz de Estilo?"}),n.jsxs($l,{children:["Voc pode refazer o quiz para atualizar seu perfil de estilo.",n.jsx("span",{className:"block mt-2 font-medium text-foreground",children:"Seus pontos sero mantidos  no sero somados novamente por respostas j dadas."})]})]}),n.jsxs(Tc,{children:[n.jsx(Oc,{children:"Cancelar"}),n.jsx(Pc,{asChild:!0,children:n.jsx(Gt,{to:"/quiz?redo=true",children:n.jsx(he,{children:"Refazer Quiz"})})})]})]})]})})]})}const aNe=Sg({email:Vi().email("Email invlido"),password:Vi().min(6,"Senha deve ter no mnimo 6 caracteres")});function iNe(){var D;const e=fr(),{user:t,isLoading:r}=Hn(),[s,a]=P.useState(!0),[i,o]=P.useState(""),[c,d]=P.useState(""),[l,u]=P.useState(!1),[h,f]=P.useState(!1),[m,p]=P.useState(!1),[g,v]=P.useState(null),[x,y]=P.useState(!0),[b,j]=P.useState(null),T=async()=>{p(!0);try{sessionStorage.setItem("oauth_return_to","/minha-conta");const{error:L}=await Fq.auth.signInWithOAuth("google",{redirect_uri:window.location.origin});if(L)throw L}catch(L){console.error("Google login error:",L),de.error("Erro ao conectar com Google"),p(!1)}};P.useEffect(()=>{t?O():y(!1)},[t]);const O=async()=>{if(t)try{let{data:L,error:q}=await ce.from("profiles").select("full_name, quiz_points, quiz_level, completed_missions, style_title, last_mission_id, last_mission_completed_at").eq("user_id",t.id).maybeSingle();if(!L&&!q){const{data:H}=await ce.from("profiles").insert({user_id:t.id}).select("full_name, quiz_points, quiz_level, completed_missions, style_title, last_mission_id, last_mission_completed_at").single();L=H}v({full_name:(L==null?void 0:L.full_name)||null,quiz_points:(L==null?void 0:L.quiz_points)||0,quiz_level:(L==null?void 0:L.quiz_level)||1,completed_missions:(L==null?void 0:L.completed_missions)||[],style_title:(L==null?void 0:L.style_title)||null,last_mission_id:(L==null?void 0:L.last_mission_id)||null,last_mission_completed_at:(L==null?void 0:L.last_mission_completed_at)||null});const{data:X}=await ce.from("mission_attempts").select("mission_id").eq("user_id",t.id).eq("status","in_progress").order("updated_at",{ascending:!1}).limit(1).maybeSingle();X&&j(X.mission_id)}catch(L){console.error("Error loading profile:",L)}finally{y(!1)}};if(!r&&t){const L=((g==null?void 0:g.quiz_points)||0)>0,q=(g==null?void 0:g.completed_missions)||[],X=cv(q),H=X.length>0?X[0]:null,M=g!=null&&g.last_mission_id?Pw(g.last_mission_id):null;return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-lg",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsxs("h1",{className:"font-serif text-2xl mb-2",children:["Ol, ",((D=g==null?void 0:g.full_name)==null?void 0:D.split(" ")[0])||"Visitante","! "]}),n.jsx("p",{className:"text-muted-foreground",children:t.email}),(g==null?void 0:g.style_title)&&n.jsxs("p",{className:"text-sm text-accent mt-1",children:["Estilo: ",g.style_title]})]}),!x&&n.jsx(sNe,{quizPoints:(g==null?void 0:g.quiz_points)||0,quizLevel:(g==null?void 0:g.quiz_level)||1,hasCompletedQuiz:L,lastMissionId:g==null?void 0:g.last_mission_id,lastMissionName:M==null?void 0:M.title,lastMissionCompletedAt:g==null?void 0:g.last_mission_completed_at,nextMissionId:H==null?void 0:H.id,nextMissionName:H==null?void 0:H.title,inProgressMissionId:b}),n.jsxs("div",{className:"space-y-3 mb-8",children:[n.jsx(Gt,{to:"/meus-favoritos",children:n.jsx(De,{className:"hover:shadow-md transition-shadow cursor-pointer border-red-200 bg-gradient-to-r from-red-50/50 to-background",children:n.jsxs(Be,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-red-100 flex items-center justify-center",children:n.jsx(El,{className:"h-5 w-5 text-red-500 fill-red-500"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Meus Favoritos"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Produtos que voc amou"})]})]}),n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground"})]})})}),n.jsx(Gt,{to:"/meus-pedidos",children:n.jsx(De,{className:"hover:shadow-md transition-shadow cursor-pointer",children:n.jsxs(Be,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-accent/10 flex items-center justify-center",children:n.jsx(Ut,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Meus Pedidos"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Acompanhe suas compras"})]})]}),n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground"})]})})}),n.jsx(Gt,{to:"/meus-prints",children:n.jsx(De,{className:"hover:shadow-md transition-shadow cursor-pointer",children:n.jsxs(Be,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-accent/10 flex items-center justify-center",children:n.jsx(Ma,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Meus Prints"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Prints enviados e resultados"})]})]}),n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground"})]})})}),n.jsx(Gt,{to:"/meu-estilo",children:n.jsx(De,{className:"hover:shadow-md transition-shadow cursor-pointer border-accent/30 bg-gradient-to-r from-accent/5 to-primary/5",children:n.jsxs(Be,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-accent/20 to-primary/20 flex items-center justify-center",children:n.jsx(Wr,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Meu Estilo"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:L?"Progresso e trilhas VIP":"Descubra seu estilo"})]})]}),n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground"})]})})}),n.jsx(Gt,{to:"/minhas-sugestoes",children:n.jsx(De,{className:"hover:shadow-md transition-shadow cursor-pointer",children:n.jsxs(Be,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-accent/10 flex items-center justify-center",children:n.jsx(ba,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Sugestes pra mim"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Looks personalizados"})]})]}),n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground"})]})})}),L&&n.jsx(De,{className:"hover:shadow-md transition-shadow cursor-pointer border-accent/30",onClick:()=>{var F;(F=document.getElementById("missions-section"))==null||F.scrollIntoView({behavior:"smooth"})},children:n.jsxs(Be,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-amber-100 to-accent/20 flex items-center justify-center",children:n.jsx(ba,{className:"h-5 w-5 text-amber-600"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Misses / Trilhas"}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[q.length,"/",q.length+X.length," completadas"]})]})]}),n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground"})]})}),n.jsx(Gt,{to:"/meu-perfil",children:n.jsx(De,{className:"hover:shadow-md transition-shadow cursor-pointer",children:n.jsxs(Be,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-accent/10 flex items-center justify-center",children:n.jsx(Wn,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Meus Dados"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Endereo, senha e perfil"})]})]}),n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground"})]})})}),n.jsx(De,{className:"hover:shadow-md transition-shadow cursor-pointer border-red-100 hover:bg-red-50/50",onClick:async()=>{await ce.auth.signOut(),e("/login")},children:n.jsxs(Be,{className:"p-4 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-red-50 flex items-center justify-center",children:n.jsx(Wn,{className:"h-5 w-5 text-red-500"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-red-600",children:"Sair da Conta"}),n.jsx("p",{className:"text-sm text-red-400",children:"Deslogar do dispositivo"})]})]}),n.jsx(Dn,{className:"h-5 w-5 text-red-300"})]})})]}),g&&g.quiz_points>0&&n.jsx("div",{id:"missions-section",className:"mt-8 pt-8 border-t border-border",children:n.jsx(Pq,{completedMissions:g.completed_missions,currentPoints:g.quiz_points,currentLevel:g.quiz_level})})]})]})}const R=async L=>{var X,H;L.preventDefault();const q=aNe.safeParse({email:i,password:c});if(!q.success){de.error(q.error.errors[0].message);return}f(!0);try{if(s){const{error:M}=await ce.auth.signInWithPassword({email:i,password:c});if(M)throw M;de.success("Bem-vinda de volta!")}else{const{error:M}=await ce.auth.signUp({email:i,password:c,options:{emailRedirectTo:`${window.location.origin}/minha-conta`}});if(M)throw M;de.success("Conta criada com sucesso!")}}catch(M){console.error("Auth error:",M);const F=M;(X=F.message)!=null&&X.includes("already registered")?de.error("Este email j est cadastrado. Tente fazer login."):(H=F.message)!=null&&H.includes("Invalid login")?de.error("Email ou senha incorretos."):de.error(F.message||"Erro ao autenticar. Tente novamente.")}finally{f(!1)}};return r?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("main",{className:"container mx-auto px-4 py-12 max-w-sm flex items-center justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-sm",children:[n.jsxs("div",{className:"text-center mb-8",children:[n.jsx("h1",{className:"font-serif text-2xl mb-2",children:s?"Entrar na sua conta":"Criar conta"}),n.jsx("p",{className:"text-muted-foreground text-sm",children:s?"Acesse seus pedidos e preferncias":"Crie sua conta para acompanhar tudo"})]}),n.jsxs(he,{type:"button",variant:"outline",className:"w-full mb-4",onClick:T,disabled:m,children:[m?n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}):n.jsxs("svg",{className:"h-5 w-5 mr-2",viewBox:"0 0 24 24",children:[n.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),n.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),n.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),n.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Continuar com Google"]}),n.jsxs("div",{className:"relative mb-4",children:[n.jsx("div",{className:"absolute inset-0 flex items-center",children:n.jsx(Ta,{className:"w-full"})}),n.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:n.jsx("span",{className:"bg-background px-3 text-muted-foreground",children:"ou"})})]}),n.jsxs("form",{onSubmit:R,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"email",children:"Email"}),n.jsx(Qe,{id:"email",type:"email",placeholder:"seu@email.com",value:i,onChange:L=>o(L.target.value),required:!0})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"password",children:"Senha"}),n.jsxs("div",{className:"relative",children:[n.jsx(Qe,{id:"password",type:l?"text":"password",placeholder:"",value:c,onChange:L=>d(L.target.value),required:!0}),n.jsx("button",{type:"button",onClick:()=>u(!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:l?n.jsx(dc,{className:"h-4 w-4"}):n.jsx(ci,{className:"h-4 w-4"})})]}),s&&n.jsx("div",{className:"mt-1 text-right",children:n.jsx(Gt,{to:"/esqueci-senha",className:"text-xs text-muted-foreground hover:text-accent transition-colors",children:"Esqueci minha senha"})})]}),n.jsx(he,{type:"submit",className:"w-full",disabled:h,children:h?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),s?"Entrando...":"Criando conta..."]}):s?"Entrar":"Criar conta"})]}),n.jsx("div",{className:"mt-6 text-center",children:n.jsx("button",{onClick:()=>a(!s),className:"text-sm text-muted-foreground hover:text-foreground transition-colors",children:s?"No tem conta? Criar agora":"J tem conta? Fazer login"})})]})]})}const oNe=[{label:"Viso Geral",href:"/minha-conta",icon:ak,description:"Seu resumo"},{label:"Meus Pedidos",href:"/meus-pedidos",icon:Ut,description:"Acompanhe suas compras"},{label:"Le.Po Club",href:"/minha-conta/club",icon:Ei,description:"Pontos & Recompensas",highlight:!0},{label:"Mdulos de Estilo",href:"/minha-conta/missoes",icon:ba,description:"Refine seu perfil"},{label:"Meu Estilo",href:"/meu-estilo",icon:Wr,description:"Quiz & Preferncias"},{label:"Sugestes",href:"/minhas-sugestoes",icon:El,description:"Looks para voc"},{label:"Meus Prints",href:"/meus-prints",icon:Ma,description:"Fotos enviadas"},{label:"Perfil",href:"/meu-perfil",icon:Wn,description:"Dados e endereos"}],lNe=[{label:"Incio",href:"/",icon:Xz},{label:"Catlogo",href:"/catalogo",icon:ln},{label:"Club",href:"/minha-conta/club",icon:Ei},{label:"Conta",href:"/minha-conta",icon:Wn}];function Pp({children:e,title:t,showBackButton:r}){var d;const s=Ec(),a=fr(),i=O8(),{user:o}=Hn(),c=async()=>{await ce.auth.signOut(),de.success("At logo!"),a("/")};return i?n.jsxs("div",{className:"min-h-screen bg-background pb-20",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-6",children:[r&&n.jsxs("button",{onClick:()=>a(-1),className:"flex items-center gap-1 text-muted-foreground mb-4 text-sm",children:[n.jsx(Dn,{className:"h-4 w-4 rotate-180"}),"Voltar"]}),t&&n.jsx("h1",{className:"font-serif text-xl mb-5",children:t}),e]}),n.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border z-50",children:n.jsx("div",{className:"flex items-center justify-around h-16",children:lNe.map(l=>{const u=s.pathname===l.href||l.href!=="/"&&s.pathname.startsWith(l.href),h=l.icon;return n.jsxs(Gt,{to:l.href,className:We("flex flex-col items-center justify-center gap-1 px-4 py-2 min-w-[64px]",u?"text-primary":"text-muted-foreground"),children:[n.jsx(h,{className:We("h-5 w-5",l.href==="/minha-conta/club"&&"text-accent")}),n.jsx("span",{className:"text-[10px] font-medium",children:l.label})]},l.href)})})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("div",{className:"container mx-auto px-4 py-8",children:n.jsxs("div",{className:"flex gap-8 max-w-6xl mx-auto",children:[n.jsx("aside",{className:"w-64 shrink-0",children:n.jsxs("div",{className:"sticky top-24",children:[n.jsxs("div",{className:"mb-6 px-2",children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Ol,"}),n.jsx("p",{className:"font-serif text-lg truncate",children:(d=o==null?void 0:o.email)==null?void 0:d.split("@")[0]})]}),n.jsx("nav",{className:"space-y-1",children:oNe.map(l=>{const u=s.pathname===l.href,h=l.icon;return n.jsxs(Gt,{to:l.href,className:We("flex items-center gap-3 px-3 py-2.5 rounded-lg transition-colors group",u?"bg-primary text-primary-foreground":"hover:bg-secondary text-foreground",l.highlight&&!u&&"text-accent"),children:[n.jsx(h,{className:We("h-5 w-5 shrink-0",l.highlight&&!u&&"text-accent")}),n.jsx("span",{className:"font-medium",children:l.label}),n.jsx(Dn,{className:We("h-4 w-4 ml-auto opacity-0 group-hover:opacity-100 transition-opacity",u&&"opacity-100")})]},l.href)})}),n.jsx("div",{className:"mt-8 pt-6 border-t",children:n.jsxs(he,{variant:"ghost",className:"w-full justify-start text-muted-foreground hover:text-destructive",onClick:c,children:[n.jsx(ik,{className:"h-5 w-5 mr-3"}),"Sair da conta"]})})]})}),n.jsxs("main",{className:"flex-1 min-w-0",children:[t&&n.jsx("h1",{className:"font-serif text-2xl mb-6",children:t}),e]})]})})]})}function cNe({variant:e="full"}){const{loyalty:t,getProgressToNextTier:r,isLoading:s}=C1();if(s)return n.jsxs("div",{className:"bg-gradient-to-br from-primary/5 via-accent/5 to-primary/10 rounded-2xl p-6 animate-pulse",children:[n.jsx("div",{className:"h-6 bg-muted rounded w-32 mb-4"}),n.jsx("div",{className:"h-8 bg-muted rounded w-24 mb-4"}),n.jsx("div",{className:"h-2 bg-muted rounded mb-4"}),n.jsx("div",{className:"h-10 bg-muted rounded"})]});const a=(t==null?void 0:t.currentTier)||"poa",i=ns[a],{progress:o,pointsNeeded:c,nextTierName:d}=r((t==null?void 0:t.annualPoints)||0,a);return e==="compact"?n.jsx(Gt,{to:"/minha-conta/club",children:n.jsx("div",{className:"bg-gradient-to-r from-primary/5 to-accent/10 border border-accent/20 rounded-xl p-4 hover:shadow-md transition-shadow",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-accent/20 to-primary/20 flex items-center justify-center",children:n.jsx(Ei,{className:"h-5 w-5 text-accent"})}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:"Le.Po Club"}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(ki,{className:"h-3.5 w-3.5 text-amber-500 fill-amber-500"}),n.jsx("span",{className:"font-semibold text-amber-700",children:(t==null?void 0:t.currentPoints)||0}),n.jsx("span",{children:"pontos"})]})]})]}),n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground"})]})})}):n.jsxs("div",{className:"bg-gradient-to-br from-card via-accent/5 to-card border border-accent/20 rounded-2xl p-6 shadow-sm",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-accent/20 to-primary/20 flex items-center justify-center",children:n.jsx(Ei,{className:"h-6 w-6 text-accent"})}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-serif text-lg",children:"Le.Po Club"}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Nvel ",n.jsx("span",{className:"font-medium text-foreground",children:i.name})]})]})]}),n.jsx("div",{className:"bg-card/80 rounded-xl p-4 mb-5 border border-border/50",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Seus pontos"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ki,{className:"h-5 w-5 text-amber-500 fill-amber-500"}),n.jsx("span",{className:"font-serif text-2xl font-semibold text-amber-700",children:(t==null?void 0:t.currentPoints)||0})]})]}),d&&n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-xs text-muted-foreground",children:"Prximo nvel"}),n.jsx("p",{className:"text-sm font-medium text-accent",children:d})]})]})}),d&&n.jsxs("div",{className:"mb-5",children:[n.jsxs("div",{className:"flex items-center justify-between text-xs mb-2",children:[n.jsxs("span",{className:"text-muted-foreground",children:["Progresso para ",d]}),n.jsxs("span",{className:"font-medium text-accent",children:[c," pts restantes"]})]}),n.jsx(Mg,{value:o,className:"h-2"})]}),n.jsx(Gt,{to:"/minha-conta/club",children:n.jsxs(he,{className:"w-full gap-2",variant:"outline",children:[n.jsx(Wr,{className:"h-4 w-4"}),"Ver Recompensas",n.jsx(Dn,{className:"h-4 w-4"})]})})]})}function Yy({title:e,description:t,href:r,icon:s,badge:a,highlight:i,status:o}){return n.jsx(Gt,{to:r,children:n.jsx("div",{className:We("bg-card border rounded-xl p-4 hover:shadow-md transition-all group",i&&"border-accent/30 bg-gradient-to-br from-card to-accent/5"),children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:We("w-10 h-10 rounded-lg flex items-center justify-center shrink-0",i?"bg-gradient-to-br from-accent/20 to-primary/20":"bg-secondary"),children:n.jsx(s,{className:We("h-5 w-5",i?"text-accent":"text-muted-foreground")})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h3",{className:"font-medium text-sm",children:e}),a&&n.jsx("span",{className:"text-[10px] font-semibold px-1.5 py-0.5 rounded-full bg-accent text-accent-foreground",children:a})]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:t}),o&&n.jsx("div",{className:"mt-2",children:n.jsx("span",{className:We("text-[10px] font-medium px-2 py-1 rounded-full",o.variant==="success"&&"bg-success/10 text-success",o.variant==="warning"&&"bg-amber-100 text-amber-700",o.variant==="muted"&&"bg-muted text-muted-foreground",o.variant==="default"&&"bg-primary/10 text-primary"),children:o.label})})]}),n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity shrink-0"})]})})})}function dNe(){const e=fr(),{user:t,isLoading:r}=Hn(),[s,a]=P.useState(null),[i,o]=P.useState(!0);P.useEffect(()=>{!r&&!t&&e("/minha-conta/auth")},[r,t,e]),P.useEffect(()=>{t?ce.from("orders").select("id, status").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(1).maybeSingle().then(({data:d})=>{a(d),o(!1)}):o(!1)},[t]);const c=d=>({pendente:{label:"Aguardando pagamento",variant:"warning"},pago:{label:"Pago",variant:"success"},preparar_envio:{label:"Em preparao",variant:"default"},postado:{label:"Enviado",variant:"success"},entregue:{label:"Entregue",variant:"muted"}})[d]||{label:d,variant:"muted"};return i?n.jsx(Pp,{children:n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})})}):n.jsxs(Pp,{children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("h1",{className:"font-serif text-2xl mb-1",children:"Ol! "}),n.jsx("p",{className:"text-muted-foreground text-sm",children:"Bem-vinda ao seu espao Le.Po"})]}),n.jsx("div",{className:"mb-6",children:n.jsx(cNe,{variant:"full"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(Yy,{title:"Meus Pedidos",description:s?"Acompanhe seu ltimo pedido":"Voc ainda no fez pedidos",href:"/meus-pedidos",icon:Ut,status:s?c(s.status):void 0}),n.jsx(Yy,{title:"Misses do Dia",description:"Responda perguntas e ganhe pontos",href:"/minha-conta/missoes",icon:ba,badge:"Novo",highlight:!0}),n.jsx(Yy,{title:"Meus Favoritos",description:"Produtos que voc amou",href:"/meus-favoritos",icon:El,highlight:!0}),n.jsx(Yy,{title:"Sugestes pra Voc",description:"Looks personalizados para seu estilo",href:"/minhas-sugestoes",icon:ba})]})]})}const WM={free_shipping:"https://images.unsplash.com/photo-1558618666-fcd25c85f82e?w=600&q=80",discount_fixed:"https://images.unsplash.com/photo-1607082349566-187342175e2f?w=600&q=80",discount_percentage:"https://images.unsplash.com/photo-1607082349566-187342175e2f?w=600&q=80",vip_access:"https://images.unsplash.com/photo-1558171813-4c088753af8f?w=600&q=80",gift:"https://images.unsplash.com/photo-1549465220-1a8b9238f7e7?w=600&q=80"},uNe={free_shipping:"Frete Grtis",discount_fixed:"Desconto Exclusivo",discount_percentage:"Desconto %",vip_access:"Acesso VIP",gift:"Presente Especial"},hNe={discount_fixed:jo,discount_percentage:jo,free_shipping:gn,gift:Rn,vip_access:Ei};function HM({reward:e,currentPoints:t,currentTier:r,onRedeem:s,isRedeeming:a,canRedeem:i}){const o=hNe[e.type]||Rn,c=ns[e.minTier]||ns.poa,d=["poa","poa_gold","poa_platinum","poa_black"],l=d.indexOf(r)>=d.indexOf(e.minTier),u=t>=e.pointsCost,h=e.pointsCost-t,f=e.imageUrl||WM[e.type]||WM.gift,m=uNe[e.type]||"Recompensa",p=Math.min(100,Math.round(t/e.pointsCost*100)),g=(()=>{switch(e.minTier){case"poa_black":return"from-zinc-900/95";case"poa_platinum":return"from-slate-600/95";case"poa_gold":return"from-amber-800/95";default:return"from-rose-900/95"}})(),v=!l,x=!e.unlimitedStock&&e.stockQty!==null&&e.stockQty<=0;return n.jsxs("div",{className:We("group relative bg-card rounded-2xl overflow-hidden transition-all duration-500","border border-border/60 shadow-sm",i.canRedeem&&"hover:shadow-xl hover:shadow-accent/10 hover:-translate-y-1 hover:border-accent/40",!i.canRedeem&&!v&&"opacity-90"),children:[n.jsxs("div",{className:"relative h-44 overflow-hidden",children:[n.jsx("img",{src:f,alt:e.name,className:We("w-full h-full object-cover transition-transform duration-700",i.canRedeem&&"group-hover:scale-110")}),n.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/20 to-transparent"}),n.jsx("div",{className:"absolute top-3 left-3",children:n.jsxs("span",{className:"inline-flex items-center gap-1.5 bg-white/90 backdrop-blur-md text-[10px] font-bold uppercase tracking-[0.1em] text-gray-800 px-3 py-1.5 rounded-full shadow-sm",children:[n.jsx(o,{className:"h-3 w-3"}),m]})}),e.minTier!=="poa"&&n.jsx("div",{className:"absolute top-3 right-3",children:n.jsxs("span",{className:We("inline-flex items-center gap-1 text-[10px] font-bold uppercase tracking-wider px-3 py-1.5 rounded-full shadow-sm",e.minTier==="poa_black"&&"bg-zinc-900 text-white",e.minTier==="poa_platinum"&&"bg-gradient-to-r from-slate-300 to-slate-500 text-slate-900",e.minTier==="poa_gold"&&"bg-gradient-to-r from-amber-300 to-amber-500 text-amber-900"),children:[n.jsx(Ei,{className:"h-3 w-3"}),c.name]})}),e.isFeatured&&n.jsx("div",{className:"absolute bottom-3 right-3",children:n.jsx(Wr,{className:"h-5 w-5 text-amber-300 drop-shadow-lg animate-pulse"})}),n.jsx("div",{className:"absolute bottom-3 left-3",children:n.jsxs("div",{className:"flex items-center gap-1.5 bg-black/70 backdrop-blur-md text-white px-3 py-1.5 rounded-full",children:[n.jsx(ki,{className:"h-3.5 w-3.5 text-amber-400 fill-amber-400"}),n.jsx("span",{className:"font-bold text-sm",children:e.pointsCost.toLocaleString()}),n.jsx("span",{className:"text-[10px] text-white/70 uppercase tracking-wider",children:"pts"})]})}),v&&n.jsxs("div",{className:We("absolute inset-0 bg-gradient-to-t to-black/40 flex flex-col items-center justify-center gap-2",g),children:[n.jsx(Yo,{className:"h-8 w-8 text-white/80"}),n.jsxs("span",{className:"text-white text-xs font-bold uppercase tracking-wider",children:["Nvel ",c.name]})]}),x&&!v&&n.jsx("div",{className:"absolute inset-0 bg-white/80 backdrop-blur-sm flex items-center justify-center",children:n.jsx("span",{className:"text-sm font-bold uppercase tracking-wider text-gray-500",children:"Esgotado"})})]}),n.jsxs("div",{className:"p-4",children:[n.jsx("h3",{className:"font-serif text-base font-semibold leading-tight mb-1 line-clamp-1 text-foreground",children:e.name}),e.description&&n.jsx("p",{className:"text-xs text-muted-foreground leading-relaxed mb-3 line-clamp-2",children:e.description}),i.canRedeem?n.jsxs(he,{className:"w-full gap-2 bg-foreground hover:bg-accent text-background text-xs tracking-[0.15em] uppercase font-semibold transition-all duration-300",onClick:()=>s(e.id),disabled:a,children:[n.jsx(Rn,{className:"h-4 w-4"}),a?"Resgatando...":"Resgatar agora"]}):v?n.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-muted-foreground py-2.5 bg-muted/50 rounded-lg",children:[n.jsx(Yo,{className:"h-3.5 w-3.5"}),n.jsxs("span",{className:"font-medium",children:["Desbloqueie no nvel ",c.name]})]}):u?n.jsx("p",{className:"text-xs text-center text-muted-foreground py-2",children:i.reason}):n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"h-1.5 bg-muted rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-accent rounded-full transition-all duration-700",style:{width:`${p}%`}})}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("span",{className:"text-[10px] text-muted-foreground uppercase tracking-wider",children:[p,"% alcanado"]}),n.jsxs("span",{className:"text-xs font-bold text-accent",children:["faltam ",h.toLocaleString()," pts"]})]})]})]})]})}const V8=P.createContext({});function q8(e){const t=P.useRef(null);return t.current===null&&(t.current=e()),t.current}const ZK=typeof window<"u",QK=ZK?P.useLayoutEffect:P.useEffect,uj=P.createContext(null);function W8(e,t){e.indexOf(t)===-1&&e.push(t)}function H8(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const _c=(e,t,r)=>r>t?t:r<e?e:r;let hj=()=>{},Op=()=>{};const pd={},JK=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function eX(e){return typeof e=="object"&&e!==null}const tX=e=>/^0[^.\s]+$/u.test(e);function G8(e){let t;return()=>(t===void 0&&(t=e()),t)}const Ho=e=>e,fNe=(e,t)=>r=>t(e(r)),$1=(...e)=>e.reduce(fNe),xv=(e,t,r)=>{const s=t-e;return s===0?1:(r-e)/s};class K8{constructor(){this.subscriptions=[]}add(t){return W8(this.subscriptions,t),()=>H8(this.subscriptions,t)}notify(t,r,s){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](t,r,s);else for(let i=0;i<a;i++){const o=this.subscriptions[i];o&&o(t,r,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const mc=e=>e*1e3,Uo=e=>e/1e3;function rX(e,t){return t?e*(1e3/t):0}const nX=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,mNe=1e-7,pNe=12;function gNe(e,t,r,s,a){let i,o,c=0;do o=t+(r-t)/2,i=nX(o,s,a)-e,i>0?r=o:t=o;while(Math.abs(i)>mNe&&++c<pNe);return o}function F1(e,t,r,s){if(e===t&&r===s)return Ho;const a=i=>gNe(i,0,1,e,r);return i=>i===0||i===1?i:nX(a(i),t,s)}const sX=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,aX=e=>t=>1-e(1-t),iX=F1(.33,1.53,.69,.99),X8=aX(iX),oX=sX(X8),lX=e=>(e*=2)<1?.5*X8(e):.5*(2-Math.pow(2,-10*(e-1))),Y8=e=>1-Math.sin(Math.acos(e)),cX=aX(Y8),dX=sX(Y8),xNe=F1(.42,0,1,1),vNe=F1(0,0,.58,1),uX=F1(.42,0,.58,1),yNe=e=>Array.isArray(e)&&typeof e[0]!="number",hX=e=>Array.isArray(e)&&typeof e[0]=="number",GM={linear:Ho,easeIn:xNe,easeInOut:uX,easeOut:vNe,circIn:Y8,circInOut:dX,circOut:cX,backIn:X8,backInOut:oX,backOut:iX,anticipate:lX},bNe=e=>typeof e=="string",KM=e=>{if(hX(e)){Op(e.length===4,"Cubic bezier arrays must contain four numerical values.","cubic-bezier-length");const[t,r,s,a]=e;return F1(t,r,s,a)}else if(bNe(e))return Op(GM[e]!==void 0,`Invalid easing type '${e}'`,"invalid-easing-type"),GM[e];return e},Zy=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],XM={value:null,addProjectionMetrics:null};function wNe(e,t){let r=new Set,s=new Set,a=!1,i=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1},d=0;function l(h){o.has(h)&&(u.schedule(h),e()),d++,h(c)}const u={schedule:(h,f=!1,m=!1)=>{const g=m&&a?r:s;return f&&o.add(h),g.has(h)||g.add(h),h},cancel:h=>{s.delete(h),o.delete(h)},process:h=>{if(c=h,a){i=!0;return}a=!0,[r,s]=[s,r],r.forEach(l),t&&XM.value&&XM.value.frameloop[t].push(d),d=0,r.clear(),a=!1,i&&(i=!1,u.process(h))}};return u}const _Ne=40;function fX(e,t){let r=!1,s=!0;const a={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,o=Zy.reduce((b,j)=>(b[j]=wNe(i,t?j:void 0),b),{}),{setup:c,read:d,resolveKeyframes:l,preUpdate:u,update:h,preRender:f,render:m,postRender:p}=o,g=()=>{const b=pd.useManualTiming?a.timestamp:performance.now();r=!1,pd.useManualTiming||(a.delta=s?1e3/60:Math.max(Math.min(b-a.timestamp,_Ne),1)),a.timestamp=b,a.isProcessing=!0,c.process(a),d.process(a),l.process(a),u.process(a),h.process(a),f.process(a),m.process(a),p.process(a),a.isProcessing=!1,r&&t&&(s=!1,e(g))},v=()=>{r=!0,s=!0,a.isProcessing||e(g)};return{schedule:Zy.reduce((b,j)=>{const T=o[j];return b[j]=(O,R=!1,D=!1)=>(r||v(),T.schedule(O,R,D)),b},{}),cancel:b=>{for(let j=0;j<Zy.length;j++)o[Zy[j]].cancel(b)},state:a,steps:o}}const{schedule:gs,cancel:Iu,state:Ha,steps:J3}=fX(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ho,!0);let Bb;function jNe(){Bb=void 0}const wi={now:()=>(Bb===void 0&&wi.set(Ha.isProcessing||pd.useManualTiming?Ha.timestamp:performance.now()),Bb),set:e=>{Bb=e,queueMicrotask(jNe)}},mX=e=>t=>typeof t=="string"&&t.startsWith(e),pX=mX("--"),NNe=mX("var(--"),Z8=e=>NNe(e)?SNe.test(e.split("/*")[0].trim()):!1,SNe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function YM(e){return typeof e!="string"?!1:e.split("/*")[0].includes("var(--")}const Dg={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},vv={...Dg,transform:e=>_c(0,1,e)},Qy={...Dg,default:1},mx=e=>Math.round(e*1e5)/1e5,Q8=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function CNe(e){return e==null}const ENe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,J8=(e,t)=>r=>!!(typeof r=="string"&&ENe.test(r)&&r.startsWith(e)||t&&!CNe(r)&&Object.prototype.hasOwnProperty.call(r,t)),gX=(e,t,r)=>s=>{if(typeof s!="string")return s;const[a,i,o,c]=s.match(Q8);return{[e]:parseFloat(a),[t]:parseFloat(i),[r]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},kNe=e=>_c(0,255,e),e4={...Dg,transform:e=>Math.round(kNe(e))},Ph={test:J8("rgb","red"),parse:gX("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:s=1})=>"rgba("+e4.transform(e)+", "+e4.transform(t)+", "+e4.transform(r)+", "+mx(vv.transform(s))+")"};function ANe(e){let t="",r="",s="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),s=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),s=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,s+=s,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(s,16),alpha:a?parseInt(a,16)/255:1}}const ZC={test:J8("#"),parse:ANe,transform:Ph.transform},z1=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),zd=z1("deg"),pc=z1("%"),hr=z1("px"),TNe=z1("vh"),PNe=z1("vw"),ZM={...pc,parse:e=>pc.parse(e)/100,transform:e=>pc.transform(e*100)},Am={test:J8("hsl","hue"),parse:gX("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:s=1})=>"hsla("+Math.round(e)+", "+pc.transform(mx(t))+", "+pc.transform(mx(r))+", "+mx(vv.transform(s))+")"},Ys={test:e=>Ph.test(e)||ZC.test(e)||Am.test(e),parse:e=>Ph.test(e)?Ph.parse(e):Am.test(e)?Am.parse(e):ZC.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ph.transform(e):Am.transform(e),getAnimatableNone:e=>{const t=Ys.parse(e);return t.alpha=0,Ys.transform(t)}},ONe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function RNe(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Q8))==null?void 0:t.length)||0)+(((r=e.match(ONe))==null?void 0:r.length)||0)>0}const xX="number",vX="color",MNe="var",INe="var(",QM="${}",DNe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function yv(e){const t=e.toString(),r=[],s={color:[],number:[],var:[]},a=[];let i=0;const c=t.replace(DNe,d=>(Ys.test(d)?(s.color.push(i),a.push(vX),r.push(Ys.parse(d))):d.startsWith(INe)?(s.var.push(i),a.push(MNe),r.push(d)):(s.number.push(i),a.push(xX),r.push(parseFloat(d))),++i,QM)).split(QM);return{values:r,split:c,indexes:s,types:a}}function yX(e){return yv(e).values}function bX(e){const{split:t,types:r}=yv(e),s=t.length;return a=>{let i="";for(let o=0;o<s;o++)if(i+=t[o],a[o]!==void 0){const c=r[o];c===xX?i+=mx(a[o]):c===vX?i+=Ys.transform(a[o]):i+=a[o]}return i}}const LNe=e=>typeof e=="number"?0:Ys.test(e)?Ys.getAnimatableNone(e):e;function BNe(e){const t=yX(e);return bX(e)(t.map(LNe))}const Du={test:RNe,parse:yX,createTransformer:bX,getAnimatableNone:BNe};function t4(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function $Ne({hue:e,saturation:t,lightness:r,alpha:s}){e/=360,t/=100,r/=100;let a=0,i=0,o=0;if(!t)a=i=o=r;else{const c=r<.5?r*(1+t):r+t-r*t,d=2*r-c;a=t4(d,c,e+1/3),i=t4(d,c,e),o=t4(d,c,e-1/3)}return{red:Math.round(a*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}function Ww(e,t){return r=>r>0?t:e}const As=(e,t,r)=>e+(t-e)*r,r4=(e,t,r)=>{const s=e*e,a=r*(t*t-s)+s;return a<0?0:Math.sqrt(a)},FNe=[ZC,Ph,Am],zNe=e=>FNe.find(t=>t.test(e));function JM(e){const t=zNe(e);if(hj(!!t,`'${e}' is not an animatable color. Use the equivalent color code instead.`,"color-not-animatable"),!t)return!1;let r=t.parse(e);return t===Am&&(r=$Ne(r)),r}const e7=(e,t)=>{const r=JM(e),s=JM(t);if(!r||!s)return Ww(e,t);const a={...r};return i=>(a.red=r4(r.red,s.red,i),a.green=r4(r.green,s.green,i),a.blue=r4(r.blue,s.blue,i),a.alpha=As(r.alpha,s.alpha,i),Ph.transform(a))},QC=new Set(["none","hidden"]);function UNe(e,t){return QC.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function VNe(e,t){return r=>As(e,t,r)}function eA(e){return typeof e=="number"?VNe:typeof e=="string"?Z8(e)?Ww:Ys.test(e)?e7:HNe:Array.isArray(e)?wX:typeof e=="object"?Ys.test(e)?e7:qNe:Ww}function wX(e,t){const r=[...e],s=r.length,a=e.map((i,o)=>eA(i)(i,t[o]));return i=>{for(let o=0;o<s;o++)r[o]=a[o](i);return r}}function qNe(e,t){const r={...e,...t},s={};for(const a in r)e[a]!==void 0&&t[a]!==void 0&&(s[a]=eA(e[a])(e[a],t[a]));return a=>{for(const i in s)r[i]=s[i](a);return r}}function WNe(e,t){const r=[],s={color:0,var:0,number:0};for(let a=0;a<t.values.length;a++){const i=t.types[a],o=e.indexes[i][s[i]],c=e.values[o]??0;r[a]=c,s[i]++}return r}const HNe=(e,t)=>{const r=Du.createTransformer(t),s=yv(e),a=yv(t);return s.indexes.var.length===a.indexes.var.length&&s.indexes.color.length===a.indexes.color.length&&s.indexes.number.length>=a.indexes.number.length?QC.has(e)&&!a.values.length||QC.has(t)&&!s.values.length?UNe(e,t):$1(wX(WNe(s,a),a.values),r):(hj(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`,"complex-values-different"),Ww(e,t))};function _X(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?As(e,t,r):eA(e)(e,t)}const GNe=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>gs.update(t,r),stop:()=>Iu(t),now:()=>Ha.isProcessing?Ha.timestamp:wi.now()}},jX=(e,t,r=10)=>{let s="";const a=Math.max(Math.round(t/r),2);for(let i=0;i<a;i++)s+=Math.round(e(i/(a-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},Hw=2e4;function tA(e){let t=0;const r=50;let s=e.next(t);for(;!s.done&&t<Hw;)t+=r,s=e.next(t);return t>=Hw?1/0:t}function KNe(e,t=100,r){const s=r({...e,keyframes:[0,t]}),a=Math.min(tA(s),Hw);return{type:"keyframes",ease:i=>s.next(a*i).value/t,duration:Uo(a)}}const XNe=5;function NX(e,t,r){const s=Math.max(t-XNe,0);return rX(r-e(s),t-s)}const Cs={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},n4=.001;function YNe({duration:e=Cs.duration,bounce:t=Cs.bounce,velocity:r=Cs.velocity,mass:s=Cs.mass}){let a,i;hj(e<=mc(Cs.maxDuration),"Spring duration must be 10 seconds or less","spring-duration-limit");let o=1-t;o=_c(Cs.minDamping,Cs.maxDamping,o),e=_c(Cs.minDuration,Cs.maxDuration,Uo(e)),o<1?(a=l=>{const u=l*o,h=u*e,f=u-r,m=JC(l,o),p=Math.exp(-h);return n4-f/m*p},i=l=>{const h=l*o*e,f=h*r+r,m=Math.pow(o,2)*Math.pow(l,2)*e,p=Math.exp(-h),g=JC(Math.pow(l,2),o);return(-a(l)+n4>0?-1:1)*((f-m)*p)/g}):(a=l=>{const u=Math.exp(-l*e),h=(l-r)*e+1;return-n4+u*h},i=l=>{const u=Math.exp(-l*e),h=(r-l)*(e*e);return u*h});const c=5/e,d=QNe(a,i,c);if(e=mc(e),isNaN(d))return{stiffness:Cs.stiffness,damping:Cs.damping,duration:e};{const l=Math.pow(d,2)*s;return{stiffness:l,damping:o*2*Math.sqrt(s*l),duration:e}}}const ZNe=12;function QNe(e,t,r){let s=r;for(let a=1;a<ZNe;a++)s=s-e(s)/t(s);return s}function JC(e,t){return e*Math.sqrt(1-t*t)}const JNe=["duration","bounce"],e3e=["stiffness","damping","mass"];function t7(e,t){return t.some(r=>e[r]!==void 0)}function t3e(e){let t={velocity:Cs.velocity,stiffness:Cs.stiffness,damping:Cs.damping,mass:Cs.mass,isResolvedFromDuration:!1,...e};if(!t7(e,e3e)&&t7(e,JNe))if(e.visualDuration){const r=e.visualDuration,s=2*Math.PI/(r*1.2),a=s*s,i=2*_c(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:Cs.mass,stiffness:a,damping:i}}else{const r=YNe(e);t={...t,...r,mass:Cs.mass},t.isResolvedFromDuration=!0}return t}function Gw(e=Cs.visualDuration,t=Cs.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:s,restDelta:a}=r;const i=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],c={done:!1,value:i},{stiffness:d,damping:l,mass:u,duration:h,velocity:f,isResolvedFromDuration:m}=t3e({...r,velocity:-Uo(r.velocity||0)}),p=f||0,g=l/(2*Math.sqrt(d*u)),v=o-i,x=Uo(Math.sqrt(d/u)),y=Math.abs(v)<5;s||(s=y?Cs.restSpeed.granular:Cs.restSpeed.default),a||(a=y?Cs.restDelta.granular:Cs.restDelta.default);let b;if(g<1){const T=JC(x,g);b=O=>{const R=Math.exp(-g*x*O);return o-R*((p+g*x*v)/T*Math.sin(T*O)+v*Math.cos(T*O))}}else if(g===1)b=T=>o-Math.exp(-x*T)*(v+(p+x*v)*T);else{const T=x*Math.sqrt(g*g-1);b=O=>{const R=Math.exp(-g*x*O),D=Math.min(T*O,300);return o-R*((p+g*x*v)*Math.sinh(D)+T*v*Math.cosh(D))/T}}const j={calculatedDuration:m&&h||null,next:T=>{const O=b(T);if(m)c.done=T>=h;else{let R=T===0?p:0;g<1&&(R=T===0?mc(p):NX(b,T,O));const D=Math.abs(R)<=s,L=Math.abs(o-O)<=a;c.done=D&&L}return c.value=c.done?o:O,c},toString:()=>{const T=Math.min(tA(j),Hw),O=jX(R=>j.next(T*R).value,T,30);return T+"ms "+O},toTransition:()=>{}};return j}Gw.applyToOptions=e=>{const t=KNe(e,100,Gw);return e.ease=t.ease,e.duration=mc(t.duration),e.type="keyframes",e};function e5({keyframes:e,velocity:t=0,power:r=.8,timeConstant:s=325,bounceDamping:a=10,bounceStiffness:i=500,modifyTarget:o,min:c,max:d,restDelta:l=.5,restSpeed:u}){const h=e[0],f={done:!1,value:h},m=D=>c!==void 0&&D<c||d!==void 0&&D>d,p=D=>c===void 0?d:d===void 0||Math.abs(c-D)<Math.abs(d-D)?c:d;let g=r*t;const v=h+g,x=o===void 0?v:o(v);x!==v&&(g=x-h);const y=D=>-g*Math.exp(-D/s),b=D=>x+y(D),j=D=>{const L=y(D),q=b(D);f.done=Math.abs(L)<=l,f.value=f.done?x:q};let T,O;const R=D=>{m(f.value)&&(T=D,O=Gw({keyframes:[f.value,p(f.value)],velocity:NX(b,D,f.value),damping:a,stiffness:i,restDelta:l,restSpeed:u}))};return R(0),{calculatedDuration:null,next:D=>{let L=!1;return!O&&T===void 0&&(L=!0,j(D),R(D)),T!==void 0&&D>=T?O.next(D-T):(!L&&j(D),f)}}}function r3e(e,t,r){const s=[],a=r||pd.mix||_X,i=e.length-1;for(let o=0;o<i;o++){let c=a(e[o],e[o+1]);if(t){const d=Array.isArray(t)?t[o]||Ho:t;c=$1(d,c)}s.push(c)}return s}function n3e(e,t,{clamp:r=!0,ease:s,mixer:a}={}){const i=e.length;if(Op(i===t.length,"Both input and output ranges must be the same length","range-length"),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const c=r3e(t,s,a),d=c.length,l=u=>{if(o&&u<e[0])return t[0];let h=0;if(d>1)for(;h<e.length-2&&!(u<e[h+1]);h++);const f=xv(e[h],e[h+1],u);return c[h](f)};return r?u=>l(_c(e[0],e[i-1],u)):l}function s3e(e,t){const r=e[e.length-1];for(let s=1;s<=t;s++){const a=xv(0,t,s);e.push(As(r,1,a))}}function a3e(e){const t=[0];return s3e(t,e.length-1),t}function i3e(e,t){return e.map(r=>r*t)}function o3e(e,t){return e.map(()=>t||uX).splice(0,e.length-1)}function px({duration:e=300,keyframes:t,times:r,ease:s="easeInOut"}){const a=yNe(s)?s.map(KM):KM(s),i={done:!1,value:t[0]},o=i3e(r&&r.length===t.length?r:a3e(t),e),c=n3e(o,t,{ease:Array.isArray(a)?a:o3e(t,a)});return{calculatedDuration:e,next:d=>(i.value=c(d),i.done=d>=e,i)}}const l3e=e=>e!==null;function rA(e,{repeat:t,repeatType:r="loop"},s,a=1){const i=e.filter(l3e),c=a<0||t&&r!=="loop"&&t%2===1?0:i.length-1;return!c||s===void 0?i[c]:s}const c3e={decay:e5,inertia:e5,tween:px,keyframes:px,spring:Gw};function SX(e){typeof e.type=="string"&&(e.type=c3e[e.type])}class nA{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const d3e=e=>e/100;class sA extends nA{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,a;const{motionValue:r}=this.options;r&&r.updatedAt!==wi.now()&&this.tick(wi.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(a=(s=this.options).onStop)==null||a.call(s))},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;SX(t);const{type:r=px,repeat:s=0,repeatDelay:a=0,repeatType:i,velocity:o=0}=t;let{keyframes:c}=t;const d=r||px;d!==px&&typeof c[0]!="number"&&(this.mixKeyframes=$1(d3e,_X(c[0],c[1])),c=[0,100]);const l=d({...t,keyframes:c});i==="mirror"&&(this.mirroredGenerator=d({...t,keyframes:[...c].reverse(),velocity:-o})),l.calculatedDuration===null&&(l.calculatedDuration=tA(l));const{calculatedDuration:u}=l;this.calculatedDuration=u,this.resolvedDuration=u+a,this.totalDuration=this.resolvedDuration*(s+1)-a,this.generator=l}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:s,totalDuration:a,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:d}=this;if(this.startTime===null)return s.next(0);const{delay:l=0,keyframes:u,repeat:h,repeatType:f,repeatDelay:m,type:p,onUpdate:g,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-a/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const x=this.currentTime-l*(this.playbackSpeed>=0?1:-1),y=this.playbackSpeed>=0?x<0:x>a;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=a);let b=this.currentTime,j=s;if(h){const D=Math.min(this.currentTime,a)/c;let L=Math.floor(D),q=D%1;!q&&D>=1&&(q=1),q===1&&L--,L=Math.min(L,h+1),!!(L%2)&&(f==="reverse"?(q=1-q,m&&(q-=m/c)):f==="mirror"&&(j=o)),b=_c(0,1,q)*c}const T=y?{done:!1,value:u[0]}:j.next(b);i&&(T.value=i(T.value));let{done:O}=T;!y&&d!==null&&(O=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&O);return R&&p!==e5&&(T.value=rA(u,this.options,v,this.speed)),g&&g(T.value),R&&this.finish(),T}then(t,r){return this.finished.then(t,r)}get duration(){return Uo(this.calculatedDuration)}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Uo(t)}get time(){return Uo(this.currentTime)}set time(t){var r;t=mc(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(wi.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Uo(this.currentTime))}play(){var a,i;if(this.isStopped)return;const{driver:t=GNe,startTime:r}=this.options;this.driver||(this.driver=t(o=>this.tick(o))),(i=(a=this.options).onPlay)==null||i.call(a);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(wi.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var t,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(t=this.options).onComplete)==null||r.call(t)}cancel(){var t,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(t=this.options).onCancel)==null||r.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),t.observe(this)}}function u3e(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Oh=e=>e*180/Math.PI,t5=e=>{const t=Oh(Math.atan2(e[1],e[0]));return r5(t)},h3e={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:t5,rotateZ:t5,skewX:e=>Oh(Math.atan(e[1])),skewY:e=>Oh(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},r5=e=>(e=e%360,e<0&&(e+=360),e),r7=t5,n7=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),s7=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),f3e={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:n7,scaleY:s7,scale:e=>(n7(e)+s7(e))/2,rotateX:e=>r5(Oh(Math.atan2(e[6],e[5]))),rotateY:e=>r5(Oh(Math.atan2(-e[2],e[0]))),rotateZ:r7,rotate:r7,skewX:e=>Oh(Math.atan(e[4])),skewY:e=>Oh(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function n5(e){return e.includes("scale")?1:0}function s5(e,t){if(!e||e==="none")return n5(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,a;if(r)s=f3e,a=r;else{const c=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=h3e,a=c}if(!a)return n5(t);const i=s[t],o=a[1].split(",").map(p3e);return typeof i=="function"?i(o):o[i]}const m3e=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return s5(r,t)};function p3e(e){return parseFloat(e.trim())}const Lg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Bg=new Set(Lg),a7=e=>e===Dg||e===hr,g3e=new Set(["x","y","z"]),x3e=Lg.filter(e=>!g3e.has(e));function v3e(e){const t=[];return x3e.forEach(r=>{const s=e.getValue(r);s!==void 0&&(t.push([r,s.get()]),s.set(r.startsWith("scale")?1:0))}),t}const cu={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>s5(t,"x"),y:(e,{transform:t})=>s5(t,"y")};cu.translateX=cu.x;cu.translateY=cu.y;const Kh=new Set;let a5=!1,i5=!1,o5=!1;function CX(){if(i5){const e=Array.from(Kh).filter(s=>s.needsMeasurement),t=new Set(e.map(s=>s.element)),r=new Map;t.forEach(s=>{const a=v3e(s);a.length&&(r.set(s,a),s.render())}),e.forEach(s=>s.measureInitialState()),t.forEach(s=>{s.render();const a=r.get(s);a&&a.forEach(([i,o])=>{var c;(c=s.getValue(i))==null||c.set(o)})}),e.forEach(s=>s.measureEndState()),e.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}i5=!1,a5=!1,Kh.forEach(e=>e.complete(o5)),Kh.clear()}function EX(){Kh.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(i5=!0)})}function y3e(){o5=!0,EX(),CX(),o5=!1}class aA{constructor(t,r,s,a,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=s,this.motionValue=a,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Kh.add(this),a5||(a5=!0,gs.read(EX),gs.resolveKeyframes(CX))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:s,motionValue:a}=this;if(t[0]===null){const i=a==null?void 0:a.get(),o=t[t.length-1];if(i!==void 0)t[0]=i;else if(s&&r){const c=s.readValue(r,o);c!=null&&(t[0]=c)}t[0]===void 0&&(t[0]=o),a&&i===void 0&&a.set(t[0])}u3e(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Kh.delete(this)}cancel(){this.state==="scheduled"&&(Kh.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const b3e=e=>e.startsWith("--");function w3e(e,t,r){b3e(t)?e.style.setProperty(t,r):e.style[t]=r}const _3e=G8(()=>window.ScrollTimeline!==void 0),j3e={};function N3e(e,t){const r=G8(e);return()=>j3e[t]??r()}const kX=N3e(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Y0=([e,t,r,s])=>`cubic-bezier(${e}, ${t}, ${r}, ${s})`,i7={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Y0([0,.65,.55,1]),circOut:Y0([.55,0,1,.45]),backIn:Y0([.31,.01,.66,-.59]),backOut:Y0([.33,1.53,.69,.99])};function AX(e,t){if(e)return typeof e=="function"?kX()?jX(e,t):"ease-out":hX(e)?Y0(e):Array.isArray(e)?e.map(r=>AX(r,t)||i7.easeOut):i7[e]}function S3e(e,t,r,{delay:s=0,duration:a=300,repeat:i=0,repeatType:o="loop",ease:c="easeOut",times:d}={},l=void 0){const u={[t]:r};d&&(u.offset=d);const h=AX(c,a);Array.isArray(h)&&(u.easing=h);const f={delay:s,duration:a,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return l&&(f.pseudoElement=l),e.animate(u,f)}function TX(e){return typeof e=="function"&&"applyToOptions"in e}function C3e({type:e,...t}){return TX(e)&&kX()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class E3e extends nA{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!t)return;const{element:r,name:s,keyframes:a,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:c,onComplete:d}=t;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=t,Op(typeof t.type!="string",`Mini animate() doesn't support "type" as a string.`,"mini-spring");const l=C3e(t);this.animation=S3e(r,s,a,l,i),l.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=rA(a,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(u):w3e(r,s,u),this.animation.cancel()}d==null||d(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,r;(r=(t=this.animation).finish)==null||r.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,r;this.isPseudoElement||(r=(t=this.animation).commitStyles)==null||r.call(t)}get duration(){var r,s;const t=((s=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:s.call(r).duration)||0;return Uo(Number(t))}get iterationDuration(){const{delay:t=0}=this.options||{};return this.duration+Uo(t)}get time(){return Uo(Number(this.animation.currentTime)||0)}set time(t){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=mc(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(t){this.manualStartTime=this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&_3e()?(this.animation.timeline=t,Ho):r(this)}}const PX={anticipate:lX,backInOut:oX,circInOut:dX};function k3e(e){return e in PX}function A3e(e){typeof e.ease=="string"&&k3e(e.ease)&&(e.ease=PX[e.ease])}const s4=10;class T3e extends E3e{constructor(t){A3e(t),SX(t),super(t),t.startTime!==void 0&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:s,onComplete:a,element:i,...o}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const c=new sA({...o,autoplay:!1}),d=Math.max(s4,wi.now()-this.startTime),l=_c(0,s4,d-s4);r.setWithVelocity(c.sample(Math.max(0,d-l)).value,c.sample(d).value,l),c.stop()}}const o7=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Du.test(e)||e==="0")&&!e.startsWith("url("));function P3e(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function O3e(e,t,r,s){const a=e[0];if(a===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],o=o7(a,t),c=o7(i,t);return hj(o===c,`You are trying to animate ${t} from "${a}" to "${i}". "${o?i:a}" is not an animatable value.`,"value-not-animatable"),!o||!c?!1:P3e(e)||(r==="spring"||TX(r))&&s}function l5(e){e.duration=0,e.type="keyframes"}const R3e=new Set(["opacity","clipPath","filter","transform"]),M3e=G8(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function I3e(e){var u;const{motionValue:t,name:r,repeatDelay:s,repeatType:a,damping:i,type:o}=e;if(!(((u=t==null?void 0:t.owner)==null?void 0:u.current)instanceof HTMLElement))return!1;const{onUpdate:d,transformTemplate:l}=t.owner.getProps();return M3e()&&r&&R3e.has(r)&&(r!=="transform"||!l)&&!d&&!s&&a!=="mirror"&&i!==0&&o!=="inertia"}const D3e=40;class L3e extends nA{constructor({autoplay:t=!0,delay:r=0,type:s="keyframes",repeat:a=0,repeatDelay:i=0,repeatType:o="loop",keyframes:c,name:d,motionValue:l,element:u,...h}){var p;super(),this.stop=()=>{var g,v;this._animation&&(this._animation.stop(),(g=this.stopTimeline)==null||g.call(this)),(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=wi.now();const f={autoplay:t,delay:r,type:s,repeat:a,repeatDelay:i,repeatType:o,name:d,motionValue:l,element:u,...h},m=(u==null?void 0:u.KeyframeResolver)||aA;this.keyframeResolver=new m(c,(g,v,x)=>this.onKeyframesResolved(g,v,f,!x),d,l,u),(p=this.keyframeResolver)==null||p.scheduleResolve()}onKeyframesResolved(t,r,s,a){var v,x;this.keyframeResolver=void 0;const{name:i,type:o,velocity:c,delay:d,isHandoff:l,onUpdate:u}=s;this.resolvedAt=wi.now(),O3e(t,i,o,c)||((pd.instantAnimations||!d)&&(u==null||u(rA(t,s,r))),t[0]=t[t.length-1],l5(s),s.repeat=0);const f={startTime:a?this.resolvedAt?this.resolvedAt-this.createdAt>D3e?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...s,keyframes:t},m=!l&&I3e(f),p=(x=(v=f.motionValue)==null?void 0:v.owner)==null?void 0:x.current,g=m?new T3e({...f,element:p}):new sA(f);g.finished.then(()=>{this.notifyFinished()}).catch(Ho),this.pendingTimeline&&(this.stopTimeline=g.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=g}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){var t;return this._animation||((t=this.keyframeResolver)==null||t.resume(),y3e()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var t;this._animation&&this.animation.cancel(),(t=this.keyframeResolver)==null||t.cancel()}}function OX(e,t,r,s=0,a=1){const i=Array.from(e).sort((l,u)=>l.sortNodePosition(u)).indexOf(t),o=e.size,c=(o-1)*s;return typeof r=="function"?r(i,o):a===1?i*s:c-i*s}const B3e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function $3e(e){const t=B3e.exec(e);if(!t)return[,];const[,r,s,a]=t;return[`--${r??s}`,a]}const F3e=4;function RX(e,t,r=1){Op(r<=F3e,`Max CSS variable fallback depth detected in property "${e}". This may indicate a circular fallback dependency.`,"max-css-var-depth");const[s,a]=$3e(e);if(!s)return;const i=window.getComputedStyle(t).getPropertyValue(s);if(i){const o=i.trim();return JK(o)?parseFloat(o):o}return Z8(a)?RX(a,t,r+1):a}const z3e={type:"spring",stiffness:500,damping:25,restSpeed:10},U3e=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),V3e={type:"keyframes",duration:.8},q3e={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},W3e=(e,{keyframes:t})=>t.length>2?V3e:Bg.has(e)?e.startsWith("scale")?U3e(t[1]):z3e:q3e,H3e=e=>e!==null;function G3e(e,{repeat:t,repeatType:r="loop"},s){const a=e.filter(H3e),i=t&&r!=="loop"&&t%2===1?0:a.length-1;return!i||s===void 0?a[i]:s}function iA(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}function K3e({when:e,delay:t,delayChildren:r,staggerChildren:s,staggerDirection:a,repeat:i,repeatType:o,repeatDelay:c,from:d,elapsed:l,...u}){return!!Object.keys(u).length}const oA=(e,t,r,s={},a,i)=>o=>{const c=iA(s,e)||{},d=c.delay||s.delay||0;let{elapsed:l=0}=s;l=l-mc(d);const u={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...c,delay:-l,onUpdate:f=>{t.set(f),c.onUpdate&&c.onUpdate(f)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:e,motionValue:t,element:i?void 0:a};K3e(c)||Object.assign(u,W3e(e,u)),u.duration&&(u.duration=mc(u.duration)),u.repeatDelay&&(u.repeatDelay=mc(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(l5(u),u.delay===0&&(h=!0)),(pd.instantAnimations||pd.skipAnimations)&&(h=!0,l5(u),u.delay=0),u.allowFlatten=!c.type&&!c.ease,h&&!i&&t.get()!==void 0){const f=G3e(u.keyframes,c);if(f!==void 0){gs.update(()=>{u.onUpdate(f),u.onComplete()});return}}return c.isSync?new sA(u):new L3e(u)};function l7(e){const t=[{},{}];return e==null||e.values.forEach((r,s)=>{t[0][s]=r.get(),t[1][s]=r.getVelocity()}),t}function lA(e,t,r,s){if(typeof t=="function"){const[a,i]=l7(s);t=t(r!==void 0?r:e.custom,a,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[a,i]=l7(s);t=t(r!==void 0?r:e.custom,a,i)}return t}function Qm(e,t,r){const s=e.getProps();return lA(s,t,r!==void 0?r:s.custom,e)}const MX=new Set(["width","height","top","left","right","bottom",...Lg]),c7=30,X3e=e=>!isNaN(parseFloat(e));class Y3e{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var i;const a=wi.now();if(this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=wi.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=X3e(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new K8);const s=this.events[t].add(r);return t==="change"?()=>{s(),gs.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,s){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-s}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var t;(t=this.events.change)==null||t.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=wi.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>c7)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,c7);return rX(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t,r;(t=this.dependents)==null||t.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Rp(e,t){return new Y3e(e,t)}const c5=e=>Array.isArray(e);function Z3e(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Rp(r))}function Q3e(e){return c5(e)?e[e.length-1]||0:e}function J3e(e,t){const r=Qm(e,t);let{transitionEnd:s={},transition:a={},...i}=r||{};i={...i,...s};for(const o in i){const c=Q3e(i[o]);Z3e(e,o,c)}}const li=e=>!!(e&&e.getVelocity);function e4e(e){return!!(li(e)&&e.add)}function d5(e,t){const r=e.getValue("willChange");if(e4e(r))return r.add(t);if(!r&&pd.WillChange){const s=new pd.WillChange("auto");e.addValue("willChange",s),s.add(t)}}function cA(e){return e.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)}const t4e="framerAppearId",IX="data-"+cA(t4e);function DX(e){return e.props[IX]}function r4e({protectedKeys:e,needsAnimating:t},r){const s=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,s}function LX(e,t,{delay:r=0,transitionOverride:s,type:a}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:o,...c}=t;const d=i==null?void 0:i.reduceMotion;s&&(i=s);const l=[],u=a&&e.animationState&&e.animationState.getState()[a];for(const h in c){const f=e.getValue(h,e.latestValues[h]??null),m=c[h];if(m===void 0||u&&r4e(u,h))continue;const p={delay:r,...iA(i||{},h)},g=f.get();if(g!==void 0&&!f.isAnimating&&!Array.isArray(m)&&m===g&&!p.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const b=DX(e);if(b){const j=window.MotionHandoffAnimation(b,h,gs);j!==null&&(p.startTime=j,v=!0)}}d5(e,h);const x=d??e.shouldReduceMotion;f.start(oA(h,f,m,x&&MX.has(h)?{type:!1}:p,e,v));const y=f.animation;y&&l.push(y)}return o&&Promise.all(l).then(()=>{gs.update(()=>{o&&J3e(e,o)})}),l}function u5(e,t,r={}){var d;const s=Qm(e,t,r.type==="exit"?(d=e.presenceContext)==null?void 0:d.custom:void 0);let{transition:a=e.getDefaultTransition()||{}}=s||{};r.transitionOverride&&(a=r.transitionOverride);const i=s?()=>Promise.all(LX(e,s,r)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(l=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:f}=a;return n4e(e,t,l,u,h,f,r)}:()=>Promise.resolve(),{when:c}=a;if(c){const[l,u]=c==="beforeChildren"?[i,o]:[o,i];return l().then(()=>u())}else return Promise.all([i(),o(r.delay)])}function n4e(e,t,r=0,s=0,a=0,i=1,o){const c=[];for(const d of e.variantChildren)d.notify("AnimationStart",t),c.push(u5(d,t,{...o,delay:r+(typeof s=="function"?0:s)+OX(e.variantChildren,d,s,a,i)}).then(()=>d.notify("AnimationComplete",t)));return Promise.all(c)}function s4e(e,t,r={}){e.notify("AnimationStart",t);let s;if(Array.isArray(t)){const a=t.map(i=>u5(e,i,r));s=Promise.all(a)}else if(typeof t=="string")s=u5(e,t,r);else{const a=typeof t=="function"?Qm(e,t,r.custom):t;s=Promise.all(LX(e,a,r))}return s.then(()=>{e.notify("AnimationComplete",t)})}const a4e={test:e=>e==="auto",parse:e=>e},BX=e=>t=>t.test(e),$X=[Dg,hr,pc,zd,PNe,TNe,a4e],d7=e=>$X.find(BX(e));function i4e(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||tX(e):!0}const o4e=new Set(["brightness","contrast","saturate","opacity"]);function l4e(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[s]=r.match(Q8)||[];if(!s)return e;const a=r.replace(s,"");let i=o4e.has(t)?1:0;return s!==r&&(i*=100),t+"("+i+a+")"}const c4e=/\b([a-z-]*)\(.*?\)/gu,h5={...Du,getAnimatableNone:e=>{const t=e.match(c4e);return t?t.map(l4e).join(" "):e}},u7={...Dg,transform:Math.round},d4e={rotate:zd,rotateX:zd,rotateY:zd,rotateZ:zd,scale:Qy,scaleX:Qy,scaleY:Qy,scaleZ:Qy,skew:zd,skewX:zd,skewY:zd,distance:hr,translateX:hr,translateY:hr,translateZ:hr,x:hr,y:hr,z:hr,perspective:hr,transformPerspective:hr,opacity:vv,originX:ZM,originY:ZM,originZ:hr},dA={borderWidth:hr,borderTopWidth:hr,borderRightWidth:hr,borderBottomWidth:hr,borderLeftWidth:hr,borderRadius:hr,borderTopLeftRadius:hr,borderTopRightRadius:hr,borderBottomRightRadius:hr,borderBottomLeftRadius:hr,width:hr,maxWidth:hr,height:hr,maxHeight:hr,top:hr,right:hr,bottom:hr,left:hr,inset:hr,insetBlock:hr,insetBlockStart:hr,insetBlockEnd:hr,insetInline:hr,insetInlineStart:hr,insetInlineEnd:hr,padding:hr,paddingTop:hr,paddingRight:hr,paddingBottom:hr,paddingLeft:hr,paddingBlock:hr,paddingBlockStart:hr,paddingBlockEnd:hr,paddingInline:hr,paddingInlineStart:hr,paddingInlineEnd:hr,margin:hr,marginTop:hr,marginRight:hr,marginBottom:hr,marginLeft:hr,marginBlock:hr,marginBlockStart:hr,marginBlockEnd:hr,marginInline:hr,marginInlineStart:hr,marginInlineEnd:hr,fontSize:hr,backgroundPositionX:hr,backgroundPositionY:hr,...d4e,zIndex:u7,fillOpacity:vv,strokeOpacity:vv,numOctaves:u7},u4e={...dA,color:Ys,backgroundColor:Ys,outlineColor:Ys,fill:Ys,stroke:Ys,borderColor:Ys,borderTopColor:Ys,borderRightColor:Ys,borderBottomColor:Ys,borderLeftColor:Ys,filter:h5,WebkitFilter:h5},FX=e=>u4e[e];function zX(e,t){let r=FX(e);return r!==h5&&(r=Du),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const h4e=new Set(["auto","none","0"]);function f4e(e,t,r){let s=0,a;for(;s<e.length&&!a;){const i=e[s];typeof i=="string"&&!h4e.has(i)&&yv(i).values.length&&(a=e[s]),s++}if(a&&r)for(const i of t)e[i]=zX(r,a)}class m4e extends aA{constructor(t,r,s,a,i){super(t,r,s,a,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:s}=this;if(!r||!r.current)return;super.readKeyframes();for(let u=0;u<t.length;u++){let h=t[u];if(typeof h=="string"&&(h=h.trim(),Z8(h))){const f=RX(h,r.current);f!==void 0&&(t[u]=f),u===t.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!MX.has(s)||t.length!==2)return;const[a,i]=t,o=d7(a),c=d7(i),d=YM(a),l=YM(i);if(d!==l&&cu[s]){this.needsMeasurement=!0;return}if(o!==c)if(a7(o)&&a7(c))for(let u=0;u<t.length;u++){const h=t[u];typeof h=="string"&&(t[u]=parseFloat(h))}else cu[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,s=[];for(let a=0;a<t.length;a++)(t[a]===null||i4e(t[a]))&&s.push(a);s.length&&f4e(t,s,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:s}=this;if(!t||!t.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=cu[s](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const a=r[r.length-1];a!==void 0&&t.getValue(s,a).jump(a,!1)}measureEndState(){var c;const{element:t,name:r,unresolvedKeyframes:s}=this;if(!t||!t.current)return;const a=t.getValue(r);a&&a.jump(this.measuredOrigin,!1);const i=s.length-1,o=s[i];s[i]=cu[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(c=this.removedTransforms)!=null&&c.length&&this.removedTransforms.forEach(([d,l])=>{t.getValue(d).set(l)}),this.resolveNoneKeyframes()}}function p4e(e,t,r){if(e==null)return[];if(e instanceof EventTarget)return[e];if(typeof e=="string"){const a=document.querySelectorAll(e);return a?Array.from(a):[]}return Array.from(e).filter(s=>s!=null)}const UX=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function f5(e){return eX(e)&&"offsetHeight"in e}const{schedule:uA,cancel:bet}=fX(queueMicrotask,!1),ml={x:!1,y:!1};function VX(){return ml.x||ml.y}function g4e(e){return e==="x"||e==="y"?ml[e]?null:(ml[e]=!0,()=>{ml[e]=!1}):ml.x||ml.y?null:(ml.x=ml.y=!0,()=>{ml.x=ml.y=!1})}function qX(e,t){const r=p4e(e),s=new AbortController,a={passive:!0,...t,signal:s.signal};return[r,a,()=>s.abort()]}function h7(e){return!(e.pointerType==="touch"||VX())}function x4e(e,t,r={}){const[s,a,i]=qX(e,r),o=c=>{if(!h7(c))return;const{target:d}=c,l=t(d,c);if(typeof l!="function"||!d)return;const u=h=>{h7(h)&&(l(h),d.removeEventListener("pointerleave",u))};d.addEventListener("pointerleave",u,a)};return s.forEach(c=>{c.addEventListener("pointerenter",o,a)}),i}const WX=(e,t)=>t?e===t?!0:WX(e,t.parentElement):!1,hA=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,v4e=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function HX(e){return v4e.has(e.tagName)||e.isContentEditable===!0}const $b=new WeakSet;function f7(e){return t=>{t.key==="Enter"&&e(t)}}function a4(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const y4e=(e,t)=>{const r=e.currentTarget;if(!r)return;const s=f7(()=>{if($b.has(r))return;a4(r,"down");const a=f7(()=>{a4(r,"up")}),i=()=>a4(r,"cancel");r.addEventListener("keyup",a,t),r.addEventListener("blur",i,t)});r.addEventListener("keydown",s,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",s),t)};function m7(e){return hA(e)&&!VX()}function b4e(e,t,r={}){const[s,a,i]=qX(e,r),o=c=>{const d=c.currentTarget;if(!m7(c))return;$b.add(d);const l=t(d,c),u=(m,p)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",f),$b.has(d)&&$b.delete(d),m7(m)&&typeof l=="function"&&l(m,{success:p})},h=m=>{u(m,d===window||d===document||r.useGlobalTarget||WX(d,m.target))},f=m=>{u(m,!1)};window.addEventListener("pointerup",h,a),window.addEventListener("pointercancel",f,a)};return s.forEach(c=>{(r.useGlobalTarget?window:c).addEventListener("pointerdown",o,a),f5(c)&&(c.addEventListener("focus",l=>y4e(l,a)),!HX(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),i}function GX(e){return eX(e)&&"ownerSVGElement"in e}function w4e(e){return GX(e)&&e.tagName==="svg"}const _4e=[...$X,Ys,Du],j4e=e=>_4e.find(BX(e)),p7=()=>({translate:0,scale:1,origin:0,originPoint:0}),Tm=()=>({x:p7(),y:p7()}),g7=()=>({min:0,max:0}),la=()=>({x:g7(),y:g7()}),m5={current:null},KX={current:!1},N4e=typeof window<"u";function S4e(){if(KX.current=!0,!!N4e)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>m5.current=e.matches;e.addEventListener("change",t),t()}else m5.current=!1}const C4e=new WeakMap;function fj(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function bv(e){return typeof e=="string"||Array.isArray(e)}const fA=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],mA=["initial",...fA];function mj(e){return fj(e.animate)||mA.some(t=>bv(e[t]))}function XX(e){return!!(mj(e)||e.variants)}function E4e(e,t,r){for(const s in t){const a=t[s],i=r[s];if(li(a))e.addValue(s,a);else if(li(i))e.addValue(s,Rp(a,{owner:e}));else if(i!==a)if(e.hasValue(s)){const o=e.getValue(s);o.liveStyle===!0?o.jump(a):o.hasAnimated||o.set(a)}else{const o=e.getStaticValue(s);e.addValue(s,Rp(o!==void 0?o:a,{owner:e}))}}for(const s in r)t[s]===void 0&&e.removeValue(s);return t}const x7=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let Kw={};function YX(e){Kw=e}function k4e(){return Kw}class A4e{scrapeMotionValuesFromProps(t,r,s){return{}}constructor({parent:t,props:r,presenceContext:s,reducedMotionConfig:a,blockInitialAnimation:i,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=aA,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const f=wi.now();this.renderScheduledAt<f&&(this.renderScheduledAt=f,gs.render(this.render,!1,!0))};const{latestValues:d,renderState:l}=o;this.latestValues=d,this.baseTarget={...d},this.initialValues=r.initial?{...d}:{},this.renderState=l,this.parent=t,this.props=r,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=a,this.options=c,this.blockInitialAnimation=!!i,this.isControllingVariants=mj(r),this.isVariantNode=XX(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const f in h){const m=h[f];d[f]!==void 0&&li(m)&&m.set(d[f])}}mount(t){var r;this.current=t,C4e.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,a)=>this.bindToMotionValue(a,s)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(KX.current||S4e(),this.shouldReduceMotion=m5.current),(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var t;this.projection&&this.projection.unmount(),Iu(this.notifyUpdate),Iu(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(t=this.parent)==null||t.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const s=this.features[r];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const s=Bg.has(t);s&&this.onBindTransform&&this.onBindTransform();const a=r.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&gs.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;typeof window<"u"&&window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{a(),i&&i(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Kw){const r=Kw[t];if(!r)continue;const{isEnabled:s,Feature:a}=r;if(!this.features[t]&&a&&s(this.props)&&(this.features[t]=new a(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):la()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let s=0;s<x7.length;s++){const a=x7[s];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const i="on"+a,o=t[i];o&&(this.propEventSubscriptions[a]=this.on(a,o))}this.prevMotionValues=E4e(this,this.scrapeMotionValuesFromProps(t,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const s=this.values.get(t);r!==s&&(s&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let s=this.values.get(t);return s===void 0&&r!==void 0&&(s=Rp(r===null?void 0:r,{owner:this}),this.addValue(t,s)),s}readValue(t,r){let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(JK(s)||tX(s))?s=parseFloat(s):!j4e(s)&&Du.test(r)&&(s=zX(t,r)),this.setBaseTarget(t,li(s)?s.get():s)),li(s)?s.get():s}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var i;const{initial:r}=this.props;let s;if(typeof r=="string"||typeof r=="object"){const o=lA(this.props,r,(i=this.presenceContext)==null?void 0:i.custom);o&&(s=o[t])}if(r&&s!==void 0)return s;const a=this.getBaseTargetFromProps(this.props,t);return a!==void 0&&!li(a)?a:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new K8),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){uA.render(this.render)}}class ZX extends A4e{constructor(){super(...arguments),this.KeyframeResolver=m4e}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){const s=t.style;return s?s[r]:void 0}removeValueFromRenderState(t,{vars:r,style:s}){delete r[t],delete s[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;li(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}class Xu{constructor(t){this.isMounted=!1,this.node=t}update(){}}function QX({top:e,left:t,right:r,bottom:s}){return{x:{min:t,max:r},y:{min:e,max:s}}}function T4e({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function P4e(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),s=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:s.y,right:s.x}}function i4(e){return e===void 0||e===1}function p5({scale:e,scaleX:t,scaleY:r}){return!i4(e)||!i4(t)||!i4(r)}function bh(e){return p5(e)||JX(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function JX(e){return v7(e.x)||v7(e.y)}function v7(e){return e&&e!=="0%"}function Xw(e,t,r){const s=e-r,a=t*s;return r+a}function y7(e,t,r,s,a){return a!==void 0&&(e=Xw(e,a,s)),Xw(e,r,s)+t}function g5(e,t=0,r=1,s,a){e.min=y7(e.min,t,r,s,a),e.max=y7(e.max,t,r,s,a)}function eY(e,{x:t,y:r}){g5(e.x,t.translate,t.scale,t.originPoint),g5(e.y,r.translate,r.scale,r.originPoint)}const b7=.999999999999,w7=1.0000000000001;function O4e(e,t,r,s=!1){const a=r.length;if(!a)return;t.x=t.y=1;let i,o;for(let c=0;c<a;c++){i=r[c],o=i.projectionDelta;const{visualElement:d}=i.options;d&&d.props.style&&d.props.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Om(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,eY(e,o)),s&&bh(i.latestValues)&&Om(e,i.latestValues))}t.x<w7&&t.x>b7&&(t.x=1),t.y<w7&&t.y>b7&&(t.y=1)}function Pm(e,t){e.min=e.min+t,e.max=e.max+t}function _7(e,t,r,s,a=.5){const i=As(e.min,e.max,a);g5(e,t,r,i,s)}function Om(e,t){_7(e.x,t.x,t.scaleX,t.scale,t.originX),_7(e.y,t.y,t.scaleY,t.scale,t.originY)}function tY(e,t){return QX(P4e(e.getBoundingClientRect(),t))}function R4e(e,t,r){const s=tY(e,r),{scroll:a}=t;return a&&(Pm(s.x,a.offset.x),Pm(s.y,a.offset.y)),s}const M4e={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},I4e=Lg.length;function D4e(e,t,r){let s="",a=!0;for(let i=0;i<I4e;i++){const o=Lg[i],c=e[o];if(c===void 0)continue;let d=!0;if(typeof c=="number")d=c===(o.startsWith("scale")?1:0);else{const l=parseFloat(c);d=o.startsWith("scale")?l===1:l===0}if(!d||r){const l=UX(c,dA[o]);if(!d){a=!1;const u=M4e[o]||o;s+=`${u}(${l}) `}r&&(t[o]=l)}}return s=s.trim(),r?s=r(t,a?"":s):a&&(s="none"),s}function pA(e,t,r){const{style:s,vars:a,transformOrigin:i}=e;let o=!1,c=!1;for(const d in t){const l=t[d];if(Bg.has(d)){o=!0;continue}else if(pX(d)){a[d]=l;continue}else{const u=UX(l,dA[d]);d.startsWith("origin")?(c=!0,i[d]=u):s[d]=u}}if(t.transform||(o||r?s.transform=D4e(t,e.transform,r):s.transform&&(s.transform="none")),c){const{originX:d="50%",originY:l="50%",originZ:u=0}=i;s.transformOrigin=`${d} ${l} ${u}`}}function rY(e,{style:t,vars:r},s,a){const i=e.style;let o;for(o in t)i[o]=t[o];a==null||a.applyProjectionStyles(i,s);for(o in r)i.setProperty(o,r[o])}function j7(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const k0={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(hr.test(e))e=parseFloat(e);else return e;const r=j7(e,t.target.x),s=j7(e,t.target.y);return`${r}% ${s}%`}},L4e={correct:(e,{treeScale:t,projectionDelta:r})=>{const s=e,a=Du.parse(e);if(a.length>5)return s;const i=Du.createTransformer(e),o=typeof a[0]!="number"?1:0,c=r.x.scale*t.x,d=r.y.scale*t.y;a[0+o]/=c,a[1+o]/=d;const l=As(c,d,.5);return typeof a[2+o]=="number"&&(a[2+o]/=l),typeof a[3+o]=="number"&&(a[3+o]/=l),i(a)}},x5={borderRadius:{...k0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:k0,borderTopRightRadius:k0,borderBottomLeftRadius:k0,borderBottomRightRadius:k0,boxShadow:L4e};function nY(e,{layout:t,layoutId:r}){return Bg.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!x5[e]||e==="opacity")}function gA(e,t,r){var o;const s=e.style,a=t==null?void 0:t.style,i={};if(!s)return i;for(const c in s)(li(s[c])||a&&li(a[c])||nY(c,e)||((o=r==null?void 0:r.getValue(c))==null?void 0:o.liveStyle)!==void 0)&&(i[c]=s[c]);return i}function B4e(e){return window.getComputedStyle(e)}class $4e extends ZX{constructor(){super(...arguments),this.type="html",this.renderInstance=rY}readValueFromInstance(t,r){var s;if(Bg.has(r))return(s=this.projection)!=null&&s.isProjecting?n5(r):m3e(t,r);{const a=B4e(t),i=(pX(r)?a.getPropertyValue(r):a[r])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:r}){return tY(t,r)}build(t,r,s){pA(t,r,s.transformTemplate)}scrapeMotionValuesFromProps(t,r,s){return gA(t,r,s)}}const F4e={offset:"stroke-dashoffset",array:"stroke-dasharray"},z4e={offset:"strokeDashoffset",array:"strokeDasharray"};function U4e(e,t,r=1,s=0,a=!0){e.pathLength=1;const i=a?F4e:z4e;e[i.offset]=`${-s}`,e[i.array]=`${t} ${r}`}const V4e=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function sY(e,{attrX:t,attrY:r,attrScale:s,pathLength:a,pathSpacing:i=1,pathOffset:o=0,...c},d,l,u){if(pA(e,c,l),d){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:f}=e;h.transform&&(f.transform=h.transform,delete h.transform),(f.transform||h.transformOrigin)&&(f.transformOrigin=h.transformOrigin??"50% 50%",delete h.transformOrigin),f.transform&&(f.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete h.transformBox);for(const m of V4e)h[m]!==void 0&&(f[m]=h[m],delete h[m]);t!==void 0&&(h.x=t),r!==void 0&&(h.y=r),s!==void 0&&(h.scale=s),a!==void 0&&U4e(h,a,i,o,!1)}const aY=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),iY=e=>typeof e=="string"&&e.toLowerCase()==="svg";function q4e(e,t,r,s){rY(e,t,void 0,s);for(const a in t.attrs)e.setAttribute(aY.has(a)?a:cA(a),t.attrs[a])}function oY(e,t,r){const s=gA(e,t,r);for(const a in e)if(li(e[a])||li(t[a])){const i=Lg.indexOf(a)!==-1?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a;s[i]=e[a]}return s}class W4e extends ZX{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=la}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Bg.has(r)){const s=FX(r);return s&&s.default||0}return r=aY.has(r)?r:cA(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,s){return oY(t,r,s)}build(t,r,s){sY(t,r,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(t,r,s,a){q4e(t,r,s,a)}mount(t){this.isSVGTag=iY(t.tagName),super.mount(t)}}const H4e=mA.length;function lY(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?lY(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<H4e;r++){const s=mA[r],a=e.props[s];(bv(a)||a===!1)&&(t[s]=a)}return t}function cY(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(t[s]!==e[s])return!1;return!0}const G4e=[...fA].reverse(),K4e=fA.length;function X4e(e){return t=>Promise.all(t.map(({animation:r,options:s})=>s4e(e,r,s)))}function Y4e(e){let t=X4e(e),r=N7(),s=!0;const a=d=>(l,u)=>{var f;const h=Qm(e,u,d==="exit"?(f=e.presenceContext)==null?void 0:f.custom:void 0);if(h){const{transition:m,transitionEnd:p,...g}=h;l={...l,...g,...p}}return l};function i(d){t=d(e)}function o(d){const{props:l}=e,u=lY(e.parent)||{},h=[],f=new Set;let m={},p=1/0;for(let v=0;v<K4e;v++){const x=G4e[v],y=r[x],b=l[x]!==void 0?l[x]:u[x],j=bv(b),T=x===d?y.isActive:null;T===!1&&(p=v);let O=b===u[x]&&b!==l[x]&&j;if(O&&s&&e.manuallyAnimateOnMount&&(O=!1),y.protectedKeys={...m},!y.isActive&&T===null||!b&&!y.prevProp||fj(b)||typeof b=="boolean")continue;const R=Z4e(y.prevProp,b);let D=R||x===d&&y.isActive&&!O&&j||v>p&&j,L=!1;const q=Array.isArray(b)?b:[b];let X=q.reduce(a(x),{});T===!1&&(X={});const{prevResolvedValues:H={}}=y,M={...H,...X},F=N=>{D=!0,f.has(N)&&(L=!0,f.delete(N)),y.needsAnimating[N]=!0;const C=e.getValue(N);C&&(C.liveStyle=!1)};for(const N in M){const C=X[N],k=H[N];if(m.hasOwnProperty(N))continue;let I=!1;c5(C)&&c5(k)?I=!cY(C,k):I=C!==k,I?C!=null?F(N):f.add(N):C!==void 0&&f.has(N)?F(N):y.protectedKeys[N]=!0}y.prevProp=b,y.prevResolvedValues=X,y.isActive&&(m={...m,...X}),s&&e.blockInitialAnimation&&(D=!1);const S=O&&R;D&&(!S||L)&&h.push(...q.map(N=>{const C={type:x};if(typeof N=="string"&&s&&!S&&e.manuallyAnimateOnMount&&e.parent){const{parent:k}=e,I=Qm(k,N);if(k.enteringChildren&&I){const{delayChildren:U}=I.transition||{};C.delay=OX(k.enteringChildren,e,U)}}return{animation:N,options:C}}))}if(f.size){const v={};if(typeof l.initial!="boolean"){const x=Qm(e,Array.isArray(l.initial)?l.initial[0]:l.initial);x&&x.transition&&(v.transition=x.transition)}f.forEach(x=>{const y=e.getBaseTarget(x),b=e.getValue(x);b&&(b.liveStyle=!0),v[x]=y??null}),h.push({animation:v})}let g=!!h.length;return s&&(l.initial===!1||l.initial===l.animate)&&!e.manuallyAnimateOnMount&&(g=!1),s=!1,g?t(h):Promise.resolve()}function c(d,l){var h;if(r[d].isActive===l)return Promise.resolve();(h=e.variantChildren)==null||h.forEach(f=>{var m;return(m=f.animationState)==null?void 0:m.setActive(d,l)}),r[d].isActive=l;const u=o(d);for(const f in r)r[f].protectedKeys={};return u}return{animateChanges:o,setActive:c,setAnimateFunction:i,getState:()=>r,reset:()=>{r=N7()}}}function Z4e(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!cY(t,e):!1}function uh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function N7(){return{animate:uh(!0),whileInView:uh(),whileHover:uh(),whileTap:uh(),whileDrag:uh(),whileFocus:uh(),exit:uh()}}function S7(e,t){e.min=t.min,e.max=t.max}function dl(e,t){S7(e.x,t.x),S7(e.y,t.y)}function C7(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}const dY=1e-4,Q4e=1-dY,J4e=1+dY,uY=.01,eSe=0-uY,tSe=0+uY;function _i(e){return e.max-e.min}function rSe(e,t,r){return Math.abs(e-t)<=r}function E7(e,t,r,s=.5){e.origin=s,e.originPoint=As(t.min,t.max,e.origin),e.scale=_i(r)/_i(t),e.translate=As(r.min,r.max,e.origin)-e.originPoint,(e.scale>=Q4e&&e.scale<=J4e||isNaN(e.scale))&&(e.scale=1),(e.translate>=eSe&&e.translate<=tSe||isNaN(e.translate))&&(e.translate=0)}function gx(e,t,r,s){E7(e.x,t.x,r.x,s?s.originX:void 0),E7(e.y,t.y,r.y,s?s.originY:void 0)}function k7(e,t,r){e.min=r.min+t.min,e.max=e.min+_i(t)}function nSe(e,t,r){k7(e.x,t.x,r.x),k7(e.y,t.y,r.y)}function A7(e,t,r){e.min=t.min-r.min,e.max=e.min+_i(t)}function Yw(e,t,r){A7(e.x,t.x,r.x),A7(e.y,t.y,r.y)}function T7(e,t,r,s,a){return e-=t,e=Xw(e,1/r,s),a!==void 0&&(e=Xw(e,1/a,s)),e}function sSe(e,t=0,r=1,s=.5,a,i=e,o=e){if(pc.test(t)&&(t=parseFloat(t),t=As(o.min,o.max,t/100)-o.min),typeof t!="number")return;let c=As(i.min,i.max,s);e===i&&(c-=t),e.min=T7(e.min,t,r,c,a),e.max=T7(e.max,t,r,c,a)}function P7(e,t,[r,s,a],i,o){sSe(e,t[r],t[s],t[a],t.scale,i,o)}const aSe=["x","scaleX","originX"],iSe=["y","scaleY","originY"];function O7(e,t,r,s){P7(e.x,t,aSe,r?r.x:void 0,s?s.x:void 0),P7(e.y,t,iSe,r?r.y:void 0,s?s.y:void 0)}function R7(e){return e.translate===0&&e.scale===1}function hY(e){return R7(e.x)&&R7(e.y)}function M7(e,t){return e.min===t.min&&e.max===t.max}function oSe(e,t){return M7(e.x,t.x)&&M7(e.y,t.y)}function I7(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function fY(e,t){return I7(e.x,t.x)&&I7(e.y,t.y)}function D7(e){return _i(e.x)/_i(e.y)}function L7(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}function Io(e){return[e("x"),e("y")]}function lSe(e,t,r){let s="";const a=e.x.translate/t.x,i=e.y.translate/t.y,o=(r==null?void 0:r.z)||0;if((a||i||o)&&(s=`translate3d(${a}px, ${i}px, ${o}px) `),(t.x!==1||t.y!==1)&&(s+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:l,rotate:u,rotateX:h,rotateY:f,skewX:m,skewY:p}=r;l&&(s=`perspective(${l}px) ${s}`),u&&(s+=`rotate(${u}deg) `),h&&(s+=`rotateX(${h}deg) `),f&&(s+=`rotateY(${f}deg) `),m&&(s+=`skewX(${m}deg) `),p&&(s+=`skewY(${p}deg) `)}const c=e.x.scale*t.x,d=e.y.scale*t.y;return(c!==1||d!==1)&&(s+=`scale(${c}, ${d})`),s||"none"}const mY=["TopLeft","TopRight","BottomLeft","BottomRight"],cSe=mY.length,B7=e=>typeof e=="string"?parseFloat(e):e,$7=e=>typeof e=="number"||hr.test(e);function dSe(e,t,r,s,a,i){a?(e.opacity=As(0,r.opacity??1,uSe(s)),e.opacityExit=As(t.opacity??1,0,hSe(s))):i&&(e.opacity=As(t.opacity??1,r.opacity??1,s));for(let o=0;o<cSe;o++){const c=`border${mY[o]}Radius`;let d=F7(t,c),l=F7(r,c);if(d===void 0&&l===void 0)continue;d||(d=0),l||(l=0),d===0||l===0||$7(d)===$7(l)?(e[c]=Math.max(As(B7(d),B7(l),s),0),(pc.test(l)||pc.test(d))&&(e[c]+="%")):e[c]=l}(t.rotate||r.rotate)&&(e.rotate=As(t.rotate||0,r.rotate||0,s))}function F7(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const uSe=pY(0,.5,cX),hSe=pY(.5,.95,Ho);function pY(e,t,r){return s=>s<e?0:s>t?1:r(xv(e,t,s))}function fSe(e,t,r){const s=li(e)?e:Rp(e);return s.start(oA("",s,t,r)),s.animation}function wv(e,t,r,s={passive:!0}){return e.addEventListener(t,r,s),()=>e.removeEventListener(t,r)}const mSe=(e,t)=>e.depth-t.depth;class pSe{constructor(){this.children=[],this.isDirty=!1}add(t){W8(this.children,t),this.isDirty=!0}remove(t){H8(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(mSe),this.isDirty=!1,this.children.forEach(t)}}function gSe(e,t){const r=wi.now(),s=({timestamp:a})=>{const i=a-r;i>=t&&(Iu(s),e(i-t))};return gs.setup(s,!0),()=>Iu(s)}function Fb(e){return li(e)?e.get():e}class xSe{constructor(){this.members=[]}add(t){W8(this.members,t),t.scheduleRender()}remove(t){if(H8(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(a=>t===a);if(r===0)return!1;let s;for(let a=r;a>=0;a--){const i=this.members[a];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(t,r){const s=this.lead;if(t!==s&&(this.prevLead=s,this.lead=t,t.show(),s)){s.instance&&s.scheduleRender(),t.scheduleRender();const a=s.options.layoutDependency,i=t.options.layoutDependency;a!==void 0&&i!==void 0&&a===i||(t.resumeFrom=s,r&&(t.resumeFrom.preserveOpacity=!0),s.snapshot&&(t.snapshot=s.snapshot,t.snapshot.latestValues=s.animationValues||s.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0));const{crossfade:c}=t.options;c===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:s}=t;r.onExitComplete&&r.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const zb={hasAnimatedSinceResize:!0,hasEverUpdated:!1},o4=["","X","Y","Z"],vSe=1e3;let ySe=0;function l4(e,t,r,s){const{latestValues:a}=t;a[e]&&(r[e]=a[e],t.setStaticValue(e,0),s&&(s[e]=0))}function gY(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=DX(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:a,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",gs,!(a||i))}const{parent:s}=e;s&&!s.hasCheckedOptimisedAppear&&gY(s)}function xY({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:s,resetTransform:a}){return class{constructor(o={},c=t==null?void 0:t()){this.id=ySe++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(_Se),this.nodes.forEach(CSe),this.nodes.forEach(ESe),this.nodes.forEach(jSe)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let d=0;d<this.path.length;d++)this.path[d].shouldResetTransform=!0;this.root===this&&(this.nodes=new pSe)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new K8),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const d=this.eventHandlers.get(o);d&&d.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=GX(o)&&!w4e(o),this.instance=o;const{layoutId:c,layout:d,visualElement:l}=this.options;if(l&&!l.current&&l.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(d||c)&&(this.isLayoutDirty=!0),e){let u,h=0;const f=()=>this.root.updateBlockedByResize=!1;gs.read(()=>{h=window.innerWidth}),e(o,()=>{const m=window.innerWidth;m!==h&&(h=m,this.root.updateBlockedByResize=!0,u&&u(),u=gSe(f,250),zb.hasAnimatedSinceResize&&(zb.hasAnimatedSinceResize=!1,this.nodes.forEach(V7)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&l&&(c||d)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:h,hasRelativeLayoutChanged:f,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||l.getDefaultTransition()||OSe,{onLayoutAnimationStart:g,onLayoutAnimationComplete:v}=l.getProps(),x=!this.targetLayout||!fY(this.targetLayout,m),y=!h&&f;if(this.options.layoutRoot||this.resumeFrom||y||h&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const b={...iA(p,"layout"),onPlay:g,onComplete:v};(l.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b),this.setAnimationOrigin(u,y)}else h||V7(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Iu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(kSe),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&gY(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:c,layout:d}=this.options;if(c===void 0&&!d)return;const l=this.getTransformTemplate();this.prevTransformTemplateValue=l?l(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(z7);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(U7);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(SSe),this.nodes.forEach(bSe),this.nodes.forEach(wSe)):this.nodes.forEach(U7),this.clearAllSnapshots();const c=wi.now();Ha.delta=_c(0,1e3/60,c-Ha.timestamp),Ha.timestamp=c,Ha.isProcessing=!0,J3.update.process(Ha),J3.preRender.process(Ha),J3.render.process(Ha),Ha.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,uA.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(NSe),this.sharedNodes.forEach(ASe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gs.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gs.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!_i(this.snapshot.measuredBox.x)&&!_i(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let d=0;d<this.path.length;d++)this.path[d].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=la(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const d=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:d,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:d}}}resetTransform(){if(!a)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!hY(this.projectionDelta),d=this.getTransformTemplate(),l=d?d(this.latestValues,""):void 0,u=l!==this.prevTransformTemplateValue;o&&this.instance&&(c||bh(this.latestValues)||u)&&(a(this.instance,l),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let d=this.removeElementScroll(c);return o&&(d=this.removeTransform(d)),RSe(d),{animationId:this.root.animationId,measuredBox:c,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){var l;const{visualElement:o}=this.options;if(!o)return la();const c=o.measureViewportBox();if(!(((l=this.scroll)==null?void 0:l.wasRoot)||this.path.some(MSe))){const{scroll:u}=this.root;u&&(Pm(c.x,u.offset.x),Pm(c.y,u.offset.y))}return c}removeElementScroll(o){var d;const c=la();if(dl(c,o),(d=this.scroll)!=null&&d.wasRoot)return c;for(let l=0;l<this.path.length;l++){const u=this.path[l],{scroll:h,options:f}=u;u!==this.root&&h&&f.layoutScroll&&(h.wasRoot&&dl(c,o),Pm(c.x,h.offset.x),Pm(c.y,h.offset.y))}return c}applyTransform(o,c=!1){const d=la();dl(d,o);for(let l=0;l<this.path.length;l++){const u=this.path[l];!c&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Om(d,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),bh(u.latestValues)&&Om(d,u.latestValues)}return bh(this.latestValues)&&Om(d,this.latestValues),d}removeTransform(o){const c=la();dl(c,o);for(let d=0;d<this.path.length;d++){const l=this.path[d];if(!l.instance||!bh(l.latestValues))continue;p5(l.latestValues)&&l.updateSnapshot();const u=la(),h=l.measurePageBox();dl(u,h),O7(c,l.latestValues,l.snapshot?l.snapshot.layoutBox:void 0,u)}return bh(this.latestValues)&&O7(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ha.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var m;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==c;if(!(o||d&&this.isSharedProjectionDirty||this.isProjectionDirty||(m=this.parent)!=null&&m.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:h}=this.options;if(!this.layout||!(u||h))return;this.resolvedRelativeTargetAt=Ha.timestamp;const f=this.getClosestProjectingParent();f&&this.linkedParentVersion!==f.layoutVersion&&!f.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(f&&f.layout?this.createRelativeTarget(f,this.layout.layoutBox,f.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=la(),this.targetWithTransforms=la()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),nSe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):dl(this.target,this.layout.layoutBox),eY(this.target,this.targetDelta)):dl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?this.createRelativeTarget(f,this.target,f.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||p5(this.parent.latestValues)||JX(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,c,d){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=la(),this.relativeTargetOrigin=la(),Yw(this.relativeTargetOrigin,c,d),dl(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var p;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let d=!0;if((this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty)&&(d=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===Ha.timestamp&&(d=!1),d)return;const{layout:l,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(l||u))return;dl(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,f=this.treeScale.y;O4e(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=la());const{target:m}=o;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(C7(this.prevProjectionDelta.x,this.projectionDelta.x),C7(this.prevProjectionDelta.y,this.projectionDelta.y)),gx(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==f||!L7(this.projectionDelta.x,this.prevProjectionDelta.x)||!L7(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var c;if((c=this.options.visualElement)==null||c.scheduleRender(),o){const d=this.getStack();d&&d.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Tm(),this.projectionDelta=Tm(),this.projectionDeltaWithTransform=Tm()}setAnimationOrigin(o,c=!1){const d=this.snapshot,l=d?d.latestValues:{},u={...this.latestValues},h=Tm();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const f=la(),m=d?d.source:void 0,p=this.layout?this.layout.source:void 0,g=m!==p,v=this.getStack(),x=!v||v.members.length<=1,y=!!(g&&!x&&this.options.crossfade===!0&&!this.path.some(PSe));this.animationProgress=0;let b;this.mixTargetDelta=j=>{const T=j/1e3;q7(h.x,o.x,T),q7(h.y,o.y,T),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Yw(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),TSe(this.relativeTarget,this.relativeTargetOrigin,f,T),b&&oSe(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=la()),dl(b,this.relativeTarget)),g&&(this.animationValues=u,dSe(u,l,this.latestValues,T,y,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=T},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var c,d,l;this.notifyListeners("animationStart"),(c=this.currentAnimation)==null||c.stop(),(l=(d=this.resumingFrom)==null?void 0:d.currentAnimation)==null||l.stop(),this.pendingAnimation&&(Iu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gs.update(()=>{zb.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Rp(0)),this.currentAnimation=fSe(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:u=>{this.mixTargetDelta(u),o.onUpdate&&o.onUpdate(u)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(vSe),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:d,layout:l,latestValues:u}=o;if(!(!c||!d||!l)){if(this!==o&&this.layout&&l&&vY(this.options.animationType,this.layout.layoutBox,l.layoutBox)){d=this.target||la();const h=_i(this.layout.layoutBox.x);d.x.min=o.target.x.min,d.x.max=d.x.min+h;const f=_i(this.layout.layoutBox.y);d.y.min=o.target.y.min,d.y.max=d.y.min+f}dl(c,d),Om(c,u),gx(this.projectionDeltaWithTransform,this.layoutCorrected,c,u)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new xSe),this.sharedNodes.get(o).add(c);const l=c.options.initialPromotionConfig;c.promote({transition:l?l.transition:void 0,preserveFollowOpacity:l&&l.shouldPreserveFollowOpacity?l.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var c;const{layoutId:o}=this.options;return o?((c=this.getStack())==null?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:o}=this.options;return o?(c=this.getStack())==null?void 0:c.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:d}={}){const l=this.getStack();l&&l.promote(this,d),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:d}=o;if((d.z||d.rotate||d.rotateX||d.rotateY||d.rotateZ||d.skewX||d.skewY)&&(c=!0),!c)return;const l={};d.z&&l4("z",o,l,this.animationValues);for(let u=0;u<o4.length;u++)l4(`rotate${o4[u]}`,o,l,this.animationValues),l4(`skew${o4[u]}`,o,l,this.animationValues);o.render();for(const u in l)o.setStaticValue(u,l[u]),this.animationValues&&(this.animationValues[u]=l[u]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const d=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Fb(c==null?void 0:c.pointerEvents)||"",o.transform=d?d(this.latestValues,""):"none";return}const l=this.getLead();if(!this.projectionDelta||!this.layout||!l.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Fb(c==null?void 0:c.pointerEvents)||""),this.hasProjected&&!bh(this.latestValues)&&(o.transform=d?d({},""):"none",this.hasProjected=!1);return}o.visibility="";const u=l.animationValues||l.latestValues;this.applyTransformsToTarget();let h=lSe(this.projectionDeltaWithTransform,this.treeScale,u);d&&(h=d(u,h)),o.transform=h;const{x:f,y:m}=this.projectionDelta;o.transformOrigin=`${f.origin*100}% ${m.origin*100}% 0`,l.animationValues?o.opacity=l===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=l===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const p in x5){if(u[p]===void 0)continue;const{correct:g,applyTo:v,isCSSVariable:x}=x5[p],y=h==="none"?u[p]:g(u[p],l);if(v){const b=v.length;for(let j=0;j<b;j++)o[v[j]]=y}else x?this.options.visualElement.renderState.vars[p]=y:o[p]=y}this.options.layoutId&&(o.pointerEvents=l===this?Fb(c==null?void 0:c.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var c;return(c=o.currentAnimation)==null?void 0:c.stop()}),this.root.nodes.forEach(z7),this.root.sharedNodes.clear()}}}function bSe(e){e.updateLayout()}function wSe(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:a}=e.layout,{animationType:i}=e.options,o=t.source!==e.layout.source;i==="size"?Io(h=>{const f=o?t.measuredBox[h]:t.layoutBox[h],m=_i(f);f.min=s[h].min,f.max=f.min+m}):vY(i,t.layoutBox,s)&&Io(h=>{const f=o?t.measuredBox[h]:t.layoutBox[h],m=_i(s[h]);f.max=f.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+m)});const c=Tm();gx(c,s,t.layoutBox);const d=Tm();o?gx(d,e.applyTransform(a,!0),t.measuredBox):gx(d,s,t.layoutBox);const l=!hY(c);let u=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:m}=h;if(f&&m){const p=la();Yw(p,t.layoutBox,f.layoutBox);const g=la();Yw(g,s,m.layoutBox),fY(p,g)||(u=!0),h.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=p,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:s,snapshot:t,delta:d,layoutDelta:c,hasLayoutChanged:l,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:s}=e.options;s&&s()}e.options.transition=void 0}function _Se(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function jSe(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function NSe(e){e.clearSnapshot()}function z7(e){e.clearMeasurements()}function U7(e){e.isLayoutDirty=!1}function SSe(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function V7(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function CSe(e){e.resolveTargetDelta()}function ESe(e){e.calcProjection()}function kSe(e){e.resetSkewAndRotation()}function ASe(e){e.removeLeadSnapshot()}function q7(e,t,r){e.translate=As(t.translate,0,r),e.scale=As(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function W7(e,t,r,s){e.min=As(t.min,r.min,s),e.max=As(t.max,r.max,s)}function TSe(e,t,r,s){W7(e.x,t.x,r.x,s),W7(e.y,t.y,r.y,s)}function PSe(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const OSe={duration:.45,ease:[.4,0,.1,1]},H7=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),G7=H7("applewebkit/")&&!H7("chrome/")?Math.round:Ho;function K7(e){e.min=G7(e.min),e.max=G7(e.max)}function RSe(e){K7(e.x),K7(e.y)}function vY(e,t,r){return e==="position"||e==="preserve-aspect"&&!rSe(D7(t),D7(r),.2)}function MSe(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const ISe=xY({attachResizeListener:(e,t)=>wv(e,"resize",t),measureScroll:()=>{var e,t;return{x:document.documentElement.scrollLeft||((e=document.body)==null?void 0:e.scrollLeft)||0,y:document.documentElement.scrollTop||((t=document.body)==null?void 0:t.scrollTop)||0}},checkIsScrollRoot:()=>!0}),c4={current:void 0},yY=xY({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!c4.current){const e=new ISe({});e.mount(window),e.setOptions({layoutScroll:!0}),c4.current=e}return c4.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),xA=P.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});function X7(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function DSe(...e){return t=>{let r=!1;const s=e.map(a=>{const i=X7(a,t);return!r&&typeof i=="function"&&(r=!0),i});if(r)return()=>{for(let a=0;a<s.length;a++){const i=s[a];typeof i=="function"?i():X7(e[a],null)}}}}function LSe(...e){return P.useCallback(DSe(...e),e)}class BSe extends P.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const s=r.offsetParent,a=f5(s)&&s.offsetWidth||0,i=f5(s)&&s.offsetHeight||0,o=this.props.sizeRef.current;o.height=r.offsetHeight||0,o.width=r.offsetWidth||0,o.top=r.offsetTop,o.left=r.offsetLeft,o.right=a-o.width-o.left,o.bottom=i-o.height-o.top}return null}componentDidUpdate(){}render(){return this.props.children}}function $Se({children:e,isPresent:t,anchorX:r,anchorY:s,root:a}){var h;const i=P.useId(),o=P.useRef(null),c=P.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:d}=P.useContext(xA),l=((h=e.props)==null?void 0:h.ref)??(e==null?void 0:e.ref),u=LSe(o,l);return P.useInsertionEffect(()=>{const{width:f,height:m,top:p,left:g,right:v,bottom:x}=c.current;if(t||!o.current||!f||!m)return;const y=r==="left"?`left: ${g}`:`right: ${v}`,b=s==="bottom"?`bottom: ${x}`:`top: ${p}`;o.current.dataset.motionPopId=i;const j=document.createElement("style");d&&(j.nonce=d);const T=a??document.head;return T.appendChild(j),j.sheet&&j.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${f}px !important;
            height: ${m}px !important;
            ${y}px !important;
            ${b}px !important;
          }
        `),()=>{T.contains(j)&&T.removeChild(j)}},[t]),n.jsx(BSe,{isPresent:t,childRef:o,sizeRef:c,children:P.cloneElement(e,{ref:u})})}const FSe=({children:e,initial:t,isPresent:r,onExitComplete:s,custom:a,presenceAffectsLayout:i,mode:o,anchorX:c,anchorY:d,root:l})=>{const u=q8(zSe),h=P.useId();let f=!0,m=P.useMemo(()=>(f=!1,{id:h,initial:t,isPresent:r,custom:a,onExitComplete:p=>{u.set(p,!0);for(const g of u.values())if(!g)return;s&&s()},register:p=>(u.set(p,!1),()=>u.delete(p))}),[r,u,s]);return i&&f&&(m={...m}),P.useMemo(()=>{u.forEach((p,g)=>u.set(g,!1))},[r]),P.useEffect(()=>{!r&&!u.size&&s&&s()},[r]),o==="popLayout"&&(e=n.jsx($Se,{isPresent:r,anchorX:c,anchorY:d,root:l,children:e})),n.jsx(uj.Provider,{value:m,children:e})};function zSe(){return new Map}function bY(e=!0){const t=P.useContext(uj);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:s,register:a}=t,i=P.useId();P.useEffect(()=>{if(e)return a(i)},[e]);const o=P.useCallback(()=>e&&s&&s(i),[i,s,e]);return!r&&s?[!1,o]:[!0]}const Jy=e=>e.key||"";function Y7(e){const t=[];return P.Children.forEach(e,r=>{P.isValidElement(r)&&t.push(r)}),t}const USe=({children:e,custom:t,initial:r=!0,onExitComplete:s,presenceAffectsLayout:a=!0,mode:i="sync",propagate:o=!1,anchorX:c="left",anchorY:d="top",root:l})=>{const[u,h]=bY(o),f=P.useMemo(()=>Y7(e),[e]),m=o&&!u?[]:f.map(Jy),p=P.useRef(!0),g=P.useRef(f),v=q8(()=>new Map),x=P.useRef(new Set),[y,b]=P.useState(f),[j,T]=P.useState(f);QK(()=>{p.current=!1,g.current=f;for(let D=0;D<j.length;D++){const L=Jy(j[D]);m.includes(L)?(v.delete(L),x.current.delete(L)):v.get(L)!==!0&&v.set(L,!1)}},[j,m.length,m.join("-")]);const O=[];if(f!==y){let D=[...f];for(let L=0;L<j.length;L++){const q=j[L],X=Jy(q);m.includes(X)||(D.splice(L,0,q),O.push(q))}return i==="wait"&&O.length&&(D=O),T(Y7(D)),b(f),null}const{forceRender:R}=P.useContext(V8);return n.jsx(n.Fragment,{children:j.map(D=>{const L=Jy(D),q=o&&!u?!1:f===j||m.includes(L),X=()=>{if(x.current.has(L))return;if(x.current.add(L),v.has(L))v.set(L,!0);else return;let H=!0;v.forEach(M=>{M||(H=!1)}),H&&(R==null||R(),T(g.current),o&&(h==null||h()),s&&s())};return n.jsx(FSe,{isPresent:q,initial:!p.current||r?void 0:!1,custom:t,presenceAffectsLayout:a,mode:i,root:l,onExitComplete:q?void 0:X,anchorX:c,anchorY:d,children:D},L)})})},wY=P.createContext({strict:!1}),Z7={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let Q7=!1;function VSe(){if(Q7)return;const e={};for(const t in Z7)e[t]={isEnabled:r=>Z7[t].some(s=>!!r[s])};YX(e),Q7=!0}function _Y(){return VSe(),k4e()}function qSe(e){const t=_Y();for(const r in e)t[r]={...t[r],...e[r]};YX(t)}const WSe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Zw(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||WSe.has(e)}let jY=e=>!Zw(e);function HSe(e){typeof e=="function"&&(jY=t=>t.startsWith("on")?!Zw(t):e(t))}try{HSe(require("@emotion/is-prop-valid").default)}catch{}function GSe(e,t,r){const s={};for(const a in e)a==="values"&&typeof e.values=="object"||(jY(a)||r===!0&&Zw(a)||!t&&!Zw(a)||e.draggable&&a.startsWith("onDrag"))&&(s[a]=e[a]);return s}const pj=P.createContext({});function KSe(e,t){if(mj(e)){const{initial:r,animate:s}=e;return{initial:r===!1||bv(r)?r:void 0,animate:bv(s)?s:void 0}}return e.inherit!==!1?t:{}}function XSe(e){const{initial:t,animate:r}=KSe(e,P.useContext(pj));return P.useMemo(()=>({initial:t,animate:r}),[J7(t),J7(r)])}function J7(e){return Array.isArray(e)?e.join(" "):e}const vA=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function NY(e,t,r){for(const s in t)!li(t[s])&&!nY(s,r)&&(e[s]=t[s])}function YSe({transformTemplate:e},t){return P.useMemo(()=>{const r=vA();return pA(r,t,e),Object.assign({},r.vars,r.style)},[t])}function ZSe(e,t){const r=e.style||{},s={};return NY(s,r,e),Object.assign(s,YSe(e,t)),s}function QSe(e,t){const r={},s=ZSe(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=s,r}const SY=()=>({...vA(),attrs:{}});function JSe(e,t,r,s){const a=P.useMemo(()=>{const i=SY();return sY(i,t,iY(s),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};NY(i,e.style,e),a.style={...i,...a.style}}return a}const eCe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function yA(e){return typeof e!="string"||e.includes("-")?!1:!!(eCe.indexOf(e)>-1||/[A-Z]/u.test(e))}function tCe(e,t,r,{latestValues:s},a,i=!1,o){const d=(o??yA(e)?JSe:QSe)(t,s,a,e),l=GSe(t,typeof e=="string",i),u=e!==P.Fragment?{...l,...d,ref:r}:{},{children:h}=t,f=P.useMemo(()=>li(h)?h.get():h,[h]);return P.createElement(e,{...u,children:f})}function rCe({scrapeMotionValuesFromProps:e,createRenderState:t},r,s,a){return{latestValues:nCe(r,s,a,e),renderState:t()}}function nCe(e,t,r,s){const a={},i=s(e,{});for(const f in i)a[f]=Fb(i[f]);let{initial:o,animate:c}=e;const d=mj(e),l=XX(e);t&&l&&!d&&e.inherit!==!1&&(o===void 0&&(o=t.initial),c===void 0&&(c=t.animate));let u=r?r.initial===!1:!1;u=u||o===!1;const h=u?c:o;if(h&&typeof h!="boolean"&&!fj(h)){const f=Array.isArray(h)?h:[h];for(let m=0;m<f.length;m++){const p=lA(e,f[m]);if(p){const{transitionEnd:g,transition:v,...x}=p;for(const y in x){let b=x[y];if(Array.isArray(b)){const j=u?b.length-1:0;b=b[j]}b!==null&&(a[y]=b)}for(const y in g)a[y]=g[y]}}}return a}const CY=e=>(t,r)=>{const s=P.useContext(pj),a=P.useContext(uj),i=()=>rCe(e,t,s,a);return r?i():q8(i)},sCe=CY({scrapeMotionValuesFromProps:gA,createRenderState:vA}),aCe=CY({scrapeMotionValuesFromProps:oY,createRenderState:SY}),iCe=Symbol.for("motionComponentSymbol");function oCe(e,t,r){const s=P.useRef(r);P.useInsertionEffect(()=>{s.current=r});const a=P.useRef(null);return P.useCallback(i=>{var c;i&&((c=e.onMount)==null||c.call(e,i)),t&&(i?t.mount(i):t.unmount());const o=s.current;if(typeof o=="function")if(i){const d=o(i);typeof d=="function"&&(a.current=d)}else a.current?(a.current(),a.current=null):o(i);else o&&(o.current=i)},[t])}const EY=P.createContext({});function Z0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function lCe(e,t,r,s,a,i){var x,y;const{visualElement:o}=P.useContext(pj),c=P.useContext(wY),d=P.useContext(uj),l=P.useContext(xA).reducedMotion,u=P.useRef(null),h=P.useRef(!1);s=s||c.renderer,!u.current&&s&&(u.current=s(e,{visualState:t,parent:o,props:r,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:l,isSVG:i}),h.current&&u.current&&(u.current.manuallyAnimateOnMount=!0));const f=u.current,m=P.useContext(EY);f&&!f.projection&&a&&(f.type==="html"||f.type==="svg")&&cCe(u.current,r,a,m);const p=P.useRef(!1);P.useInsertionEffect(()=>{f&&p.current&&f.update(r,d)});const g=r[IX],v=P.useRef(!!g&&!((x=window.MotionHandoffIsComplete)!=null&&x.call(window,g))&&((y=window.MotionHasOptimisedAnimation)==null?void 0:y.call(window,g)));return QK(()=>{h.current=!0,f&&(p.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),v.current&&f.animationState&&f.animationState.animateChanges())}),P.useEffect(()=>{f&&(!v.current&&f.animationState&&f.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)==null||b.call(window,g)}),v.current=!1),f.enteringChildren=void 0)}),f}function cCe(e,t,r,s){const{layoutId:a,layout:i,drag:o,dragConstraints:c,layoutScroll:d,layoutRoot:l,layoutCrossfade:u}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:kY(e.parent)),e.projection.setOptions({layoutId:a,layout:i,alwaysMeasureLayout:!!o||c&&Z0(c),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:s,crossfade:u,layoutScroll:d,layoutRoot:l})}function kY(e){if(e)return e.options.allowProjection!==!1?e.projection:kY(e.parent)}function d4(e,{forwardMotionProps:t=!1,type:r}={},s,a){s&&qSe(s);const i=r?r==="svg":yA(e),o=i?aCe:sCe;function c(l,u){let h;const f={...P.useContext(xA),...l,layoutId:dCe(l)},{isStatic:m}=f,p=XSe(l),g=o(l,m);if(!m&&ZK){uCe();const v=hCe(f);h=v.MeasureLayout,p.visualElement=lCe(e,g,f,a,v.ProjectionNode,i)}return n.jsxs(pj.Provider,{value:p,children:[h&&p.visualElement?n.jsx(h,{visualElement:p.visualElement,...f}):null,tCe(e,l,oCe(g,p.visualElement,u),g,m,t,i)]})}c.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const d=P.forwardRef(c);return d[iCe]=e,d}function dCe({layoutId:e}){const t=P.useContext(V8).id;return t&&e!==void 0?t+"-"+e:e}function uCe(e,t){P.useContext(wY).strict}function hCe(e){const t=_Y(),{drag:r,layout:s}=t;if(!r&&!s)return{};const a={...r,...s};return{MeasureLayout:r!=null&&r.isEnabled(e)||s!=null&&s.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function fCe(e,t){if(typeof Proxy>"u")return d4;const r=new Map,s=(i,o)=>d4(i,o,e,t),a=(i,o)=>s(i,o);return new Proxy(a,{get:(i,o)=>o==="create"?s:(r.has(o)||r.set(o,d4(o,void 0,e,t)),r.get(o))})}const mCe=(e,t)=>t.isSVG??yA(e)?new W4e(t):new $4e(t,{allowProjection:e!==P.Fragment});class pCe extends Xu{constructor(t){super(t),t.animationState||(t.animationState=Y4e(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();fj(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let gCe=0;class xCe extends Xu{constructor(){super(...arguments),this.id=gCe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const a=this.node.animationState.setActive("exit",!t);r&&!t&&a.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const vCe={animation:{Feature:pCe},exit:{Feature:xCe}};function U1(e){return{point:{x:e.pageX,y:e.pageY}}}const yCe=e=>t=>hA(t)&&e(t,U1(t));function xx(e,t,r,s){return wv(e,t,yCe(r),s)}const AY=({current:e})=>e?e.ownerDocument.defaultView:null,eI=(e,t)=>Math.abs(e-t);function bCe(e,t){const r=eI(e.x,t.x),s=eI(e.y,t.y);return Math.sqrt(r**2+s**2)}const tI=new Set(["auto","scroll"]);class TY{constructor(t,r,{transformPagePoint:s,contextWindow:a=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3,element:c}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=m=>{this.handleScroll(m.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=h4(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,g=bCe(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!g)return;const{point:v}=m,{timestamp:x}=Ha;this.history.push({...v,timestamp:x});const{onStart:y,onMove:b}=this.handlers;p||(y&&y(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,m)},this.handlePointerMove=(m,p)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=u4(p,this.transformPagePoint),gs.update(this.updatePoint,!0)},this.handlePointerUp=(m,p)=>{this.end();const{onEnd:g,onSessionEnd:v,resumeAnimation:x}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=h4(m.type==="pointercancel"?this.lastMoveEventInfo:u4(p,this.transformPagePoint),this.history);this.startEvent&&g&&g(m,y),v&&v(m,y)},!hA(t))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=s,this.distanceThreshold=o,this.contextWindow=a||window;const d=U1(t),l=u4(d,this.transformPagePoint),{point:u}=l,{timestamp:h}=Ha;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=r;f&&f(t,h4(l,this.history)),this.removeListeners=$1(xx(this.contextWindow,"pointermove",this.handlePointerMove),xx(this.contextWindow,"pointerup",this.handlePointerUp),xx(this.contextWindow,"pointercancel",this.handlePointerUp)),c&&this.startScrollTracking(c)}startScrollTracking(t){let r=t.parentElement;for(;r;){const s=getComputedStyle(r);(tI.has(s.overflowX)||tI.has(s.overflowY))&&this.scrollPositions.set(r,{x:r.scrollLeft,y:r.scrollTop}),r=r.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(t){const r=this.scrollPositions.get(t);if(!r)return;const s=t===window,a=s?{x:window.scrollX,y:window.scrollY}:{x:t.scrollLeft,y:t.scrollTop},i={x:a.x-r.x,y:a.y-r.y};i.x===0&&i.y===0||(s?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=i.x,this.lastMoveEventInfo.point.y+=i.y):this.history.length>0&&(this.history[0].x-=i.x,this.history[0].y-=i.y),this.scrollPositions.set(t,a),gs.update(this.updatePoint,!0))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Iu(this.updatePoint)}}function u4(e,t){return t?{point:t(e.point)}:e}function rI(e,t){return{x:e.x-t.x,y:e.y-t.y}}function h4({point:e},t){return{point:e,delta:rI(e,PY(t)),offset:rI(e,wCe(t)),velocity:_Ce(t,.1)}}function wCe(e){return e[0]}function PY(e){return e[e.length-1]}function _Ce(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,s=null;const a=PY(e);for(;r>=0&&(s=e[r],!(a.timestamp-s.timestamp>mc(t)));)r--;if(!s)return{x:0,y:0};const i=Uo(a.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(a.x-s.x)/i,y:(a.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function jCe(e,{min:t,max:r},s){return t!==void 0&&e<t?e=s?As(t,e,s.min):Math.max(e,t):r!==void 0&&e>r&&(e=s?As(r,e,s.max):Math.min(e,r)),e}function nI(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function NCe(e,{top:t,left:r,bottom:s,right:a}){return{x:nI(e.x,r,a),y:nI(e.y,t,s)}}function sI(e,t){let r=t.min-e.min,s=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,s]=[s,r]),{min:r,max:s}}function SCe(e,t){return{x:sI(e.x,t.x),y:sI(e.y,t.y)}}function CCe(e,t){let r=.5;const s=_i(e),a=_i(t);return a>s?r=xv(t.min,t.max-s,e.min):s>a&&(r=xv(e.min,e.max-a,t.min)),_c(0,1,r)}function ECe(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const v5=.35;function kCe(e=v5){return e===!1?e=0:e===!0&&(e=v5),{x:aI(e,"left","right"),y:aI(e,"top","bottom")}}function aI(e,t,r){return{min:iI(e,t),max:iI(e,r)}}function iI(e,t){return typeof e=="number"?e:e[t]||0}const ACe=new WeakMap;class TCe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=la(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:s}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const i=h=>{r?(this.stopAnimation(),this.snapToCursor(U1(h).point)):this.pauseAnimation()},o=(h,f)=>{this.stopAnimation();const{drag:m,dragPropagation:p,onDragStart:g}=this.getProps();if(m&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=g4e(m),!this.openDragLock))return;this.latestPointerEvent=h,this.latestPanInfo=f,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Io(x=>{let y=this.getAxisMotionValue(x).get()||0;if(pc.test(y)){const{projection:b}=this.visualElement;if(b&&b.layout){const j=b.layout.layoutBox[x];j&&(y=_i(j)*(parseFloat(y)/100))}}this.originPoint[x]=y}),g&&gs.postRender(()=>g(h,f)),d5(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},c=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f;const{dragPropagation:m,dragDirectionLock:p,onDirectionLock:g,onDrag:v}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:x}=f;if(p&&this.currentDirection===null){this.currentDirection=PCe(x),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",f.point,x),this.updateAxis("y",f.point,x),this.visualElement.render(),v&&v(h,f)},d=(h,f)=>{this.latestPointerEvent=h,this.latestPanInfo=f,this.stop(h,f),this.latestPointerEvent=null,this.latestPanInfo=null},l=()=>Io(h=>{var f;return this.getAnimationState(h)==="paused"&&((f=this.getAxisMotionValue(h).animation)==null?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new TY(t,{onSessionStart:i,onStart:o,onMove:c,onSessionEnd:d,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,distanceThreshold:s,contextWindow:AY(this.visualElement),element:this.visualElement.current})}stop(t,r){const s=t||this.latestPointerEvent,a=r||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!a||!s)return;const{velocity:o}=a;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&gs.postRender(()=>c(s,a))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(t,r,s){const{drag:a}=this.getProps();if(!s||!eb(t,a,this.currentDirection))return;const i=this.getAxisMotionValue(t);let o=this.originPoint[t]+s[t];this.constraints&&this.constraints[t]&&(o=jCe(o,this.constraints[t],this.elastic[t])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,a=this.constraints;t&&Z0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&s?this.constraints=NCe(s.layoutBox,t):this.constraints=!1,this.elastic=kCe(r),a!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Io(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=ECe(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Z0(t))return!1;const s=t.current;Op(s!==null,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.","drag-constraints-ref");const{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const i=R4e(s,a.root,this.visualElement.getTransformPagePoint());let o=SCe(a.layout.layoutBox,i);if(r){const c=r(T4e(o));this.hasMutatedConstraints=!!c,c&&(o=QX(c))}return o}startAnimation(t){const{drag:r,dragMomentum:s,dragElastic:a,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),d=this.constraints||{},l=Io(u=>{if(!eb(u,r,this.currentDirection))return;let h=d&&d[u]||{};o&&(h={min:0,max:0});const f=a?200:1e6,m=a?40:1e7,p={type:"inertia",velocity:s?t[u]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,p)});return Promise.all(l).then(c)}startAxisValueAnimation(t,r){const s=this.getAxisMotionValue(t);return d5(this.visualElement,t),s.start(oA(t,s,0,r,this.visualElement,!1))}stopAnimation(){Io(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Io(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,s=this.visualElement.getProps(),a=s[r];return a||this.visualElement.getValue(t,(s.initial?s.initial[t]:void 0)||0)}snapToCursor(t){Io(r=>{const{drag:s}=this.getProps();if(!eb(r,s,this.currentDirection))return;const{projection:a}=this.visualElement,i=this.getAxisMotionValue(r);if(a&&a.layout){const{min:o,max:c}=a.layout.layoutBox[r],d=i.get()||0;i.set(t[r]-As(o,c,.5)+d)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:s}=this.visualElement;if(!Z0(r)||!s||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Io(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const d=c.get();a[o]=CCe({min:d,max:d},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),Io(o=>{if(!eb(o,t,null))return;const c=this.getAxisMotionValue(o),{min:d,max:l}=this.constraints[o];c.set(As(d,l,a[o]))})}addListeners(){if(!this.visualElement.current)return;ACe.set(this.visualElement,this);const t=this.visualElement.current,r=xx(t,"pointerdown",d=>{const{drag:l,dragListener:u=!0}=this.getProps(),h=d.target,f=h!==t&&HX(h);l&&u&&!f&&this.start(d)}),s=()=>{const{dragConstraints:d}=this.getProps();Z0(d)&&d.current&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,i=a.addEventListener("measure",s);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),gs.read(s);const o=wv(window,"resize",()=>this.scalePositionWithinConstraints()),c=a.addEventListener("didUpdate",({delta:d,hasLayoutChanged:l})=>{this.isDragging&&l&&(Io(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=d[u].translate,h.set(h.get()+d[u].translate))}),this.visualElement.render())});return()=>{o(),r(),i(),c&&c()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:s=!1,dragPropagation:a=!1,dragConstraints:i=!1,dragElastic:o=v5,dragMomentum:c=!0}=t;return{...t,drag:r,dragDirectionLock:s,dragPropagation:a,dragConstraints:i,dragElastic:o,dragMomentum:c}}}function eb(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function PCe(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class OCe extends Xu{constructor(t){super(t),this.removeGroupControls=Ho,this.removeListeners=Ho,this.controls=new TCe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ho}update(){const{dragControls:t}=this.node.getProps(),{dragControls:r}=this.node.prevProps||{};t!==r&&(this.removeGroupControls(),t&&(this.removeGroupControls=t.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const oI=e=>(t,r)=>{e&&gs.postRender(()=>e(t,r))};class RCe extends Xu{constructor(){super(...arguments),this.removePointerDownListener=Ho}onPointerDown(t){this.session=new TY(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:AY(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:s,onPanEnd:a}=this.node.getProps();return{onSessionStart:oI(t),onStart:oI(r),onMove:s,onEnd:(i,o)=>{delete this.session,a&&gs.postRender(()=>a(i,o))}}}mount(){this.removePointerDownListener=xx(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let f4=!1;class MCe extends P.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s,layoutId:a}=this.props,{projection:i}=t;i&&(r.group&&r.group.add(i),s&&s.register&&a&&s.register(i),f4&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),zb.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:s,drag:a,isPresent:i}=this.props,{projection:o}=s;return o&&(o.isPresent=i,t.layoutDependency!==r&&o.setOptions({...o.options,layoutDependency:r}),f4=!0,a||t.layoutDependency!==r||r===void 0||t.isPresent!==i?o.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?o.promote():o.relegate()||gs.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),uA.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:s}=this.props,{projection:a}=t;f4=!0,a&&(a.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(a),s&&s.deregister&&s.deregister(a))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function OY(e){const[t,r]=bY(),s=P.useContext(V8);return n.jsx(MCe,{...e,layoutGroup:s,switchLayoutGroup:P.useContext(EY),isPresent:t,safeToRemove:r})}const ICe={pan:{Feature:RCe},drag:{Feature:OCe,ProjectionNode:yY,MeasureLayout:OY}};function lI(e,t,r){const{props:s}=e;e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",r==="Start");const a="onHover"+r,i=s[a];i&&gs.postRender(()=>i(t,U1(t)))}class DCe extends Xu{mount(){const{current:t}=this.node;t&&(this.unmount=x4e(t,(r,s)=>(lI(this.node,s,"Start"),a=>lI(this.node,a,"End"))))}unmount(){}}class LCe extends Xu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=$1(wv(this.node.current,"focus",()=>this.onFocus()),wv(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function cI(e,t,r){const{props:s}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&s.whileTap&&e.animationState.setActive("whileTap",r==="Start");const a="onTap"+(r==="End"?"":r),i=s[a];i&&gs.postRender(()=>i(t,U1(t)))}class BCe extends Xu{mount(){const{current:t}=this.node;t&&(this.unmount=b4e(t,(r,s)=>(cI(this.node,s,"Start"),(a,{success:i})=>cI(this.node,a,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const y5=new WeakMap,m4=new WeakMap,$Ce=e=>{const t=y5.get(e.target);t&&t(e)},FCe=e=>{e.forEach($Ce)};function zCe({root:e,...t}){const r=e||document;m4.has(r)||m4.set(r,{});const s=m4.get(r),a=JSON.stringify(t);return s[a]||(s[a]=new IntersectionObserver(FCe,{root:e,...t})),s[a]}function UCe(e,t,r){const s=zCe(t);return y5.set(e,r),s.observe(e),()=>{y5.delete(e),s.unobserve(e)}}const VCe={some:0,all:1};class qCe extends Xu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:s,amount:a="some",once:i}=t,o={root:r?r.current:void 0,rootMargin:s,threshold:typeof a=="number"?a:VCe[a]},c=d=>{const{isIntersecting:l}=d;if(this.isInView===l||(this.isInView=l,i&&!l&&this.hasEnteredView))return;l&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",l);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),f=l?u:h;f&&f(d)};return UCe(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(WCe(t,r))&&this.startObserver()}unmount(){}}function WCe({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const HCe={inView:{Feature:qCe},tap:{Feature:BCe},focus:{Feature:LCe},hover:{Feature:DCe}},GCe={layout:{ProjectionNode:yY,MeasureLayout:OY}},KCe={...vCe,...HCe,...ICe,...GCe},si=fCe(KCe,mCe);function XCe(){const{loyalty:e,rewards:t,redemptions:r,isLoading:s,getProgressToNextTier:a,canRedeemReward:i,redeemReward:o,getExpiringPoints:c,getTierInfo:d}=C1(),[l,u]=P.useState(null),h=async j=>{u(j);try{const T=await o(j);T&&de.success(`Resgatado! Use o cupom: ${T}`,{duration:8e3})}catch(T){de.error(T.message||"Erro ao resgatar")}finally{u(null)}};if(s)return n.jsx(Pp,{title:"Le.Po Club",children:n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})})});const f=(e==null?void 0:e.currentTier)||"poa",m=d(f),{progress:p,pointsNeeded:g,nextTierName:v}=a((e==null?void 0:e.annualPoints)||0,f),x=c(),y=t.filter(j=>j.isFeatured),b=j=>{switch(j){case"poa_black":return"from-zinc-900 to-black text-white";case"poa_platinum":return"from-slate-200 to-slate-400 text-slate-900";case"poa_gold":return"from-amber-200 to-amber-500 text-amber-950";default:return"from-rose-50 to-rose-200 text-rose-900"}};return n.jsxs(Pp,{title:"Le.Po Club",showBackButton:!0,children:[n.jsxs(si.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:We("relative overflow-hidden rounded-3xl p-8 mb-8 shadow-xl border-none","bg-gradient-to-br",b(f)),children:[n.jsx("div",{className:"absolute top-0 right-0 p-12 opacity-10",children:n.jsx(Ei,{className:"w-64 h-64 -mr-16 -mt-16 rotate-12"})}),n.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1/2 bg-gradient-to-t from-black/10 to-transparent"}),n.jsxs("div",{className:"relative z-10",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-16 h-16 rounded-full bg-white/20 backdrop-blur-md flex items-center justify-center shadow-inner",children:n.jsx(Ei,{className:"h-8 w-8"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium opacity-80 uppercase tracking-wider",children:"Nvel Atual"}),n.jsx("h1",{className:"font-serif text-3xl font-bold tracking-tight",children:m.name})]})]}),v&&n.jsxs("div",{className:"text-right hidden sm:block",children:[n.jsx("p",{className:"text-xs opacity-70 mb-1",children:"Prximo Nvel"}),n.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium",children:[v," ",n.jsx(Dn,{className:"w-4 h-4"})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-8",children:[n.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl p-4",children:[n.jsx("p",{className:"text-sm opacity-70 mb-1",children:"Pontos Disponveis"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ki,{className:"w-5 h-5 fill-current"}),n.jsx("span",{className:"text-3xl font-bold",children:(e==null?void 0:e.currentPoints)||0})]})]}),n.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl p-4",children:[n.jsx("p",{className:"text-sm opacity-70 mb-1",children:"Pontos por R$ 1"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Wr,{className:"w-5 h-5"}),n.jsxs("span",{className:"text-3xl font-bold",children:[m.multiplier,"x"]})]})]})]}),v&&n.jsxs("div",{className:"relative pt-2",children:[n.jsxs("div",{className:"flex justify-between text-xs font-medium mb-2 opacity-90",children:[n.jsxs("span",{children:[e==null?void 0:e.annualPoints," pontos anuais"]}),n.jsxs("span",{children:["Faltam ",g," para ",v]})]}),n.jsx("div",{className:"h-3 bg-black/20 rounded-full overflow-hidden backdrop-blur-sm",children:n.jsx(si.div,{initial:{width:0},animate:{width:`${p}%`},transition:{duration:1.5,ease:"easeOut"},className:"h-full bg-white/90 shadow-[0_0_10px_rgba(255,255,255,0.5)]"})})]})]})]}),n.jsxs("div",{className:"mb-8",children:[n.jsxs("h3",{className:"font-serif text-lg font-medium mb-4 flex items-center gap-2",children:[n.jsx(ki,{className:"w-5 h-5 text-accent"}),"Benefcios do seu nvel"]}),n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:m.benefits.map((j,T)=>n.jsxs(si.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:T*.1},className:"flex items-center gap-3 p-4 rounded-xl bg-card border border-border/50 shadow-sm",children:[n.jsx("div",{className:We("p-2 rounded-full",f==="poa_black"?"bg-zinc-100 text-black":"bg-accent/10 text-accent"),children:n.jsx(pae,{className:"w-4 h-4"})}),n.jsx("span",{className:"text-sm font-medium",children:j})]},T))})]}),x>0&&n.jsxs(si.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex items-center gap-3 p-4 mb-8 bg-amber-50 border border-amber-200 rounded-xl text-amber-800",children:[n.jsx(Cn,{className:"h-5 w-5 shrink-0"}),n.jsxs("div",{className:"text-sm",children:[n.jsxs("span",{className:"font-semibold",children:[x," pontos"]})," expiram em 30 dias. Aproveite para resgatar algo especial!"]})]}),n.jsxs(pi,{defaultValue:"rewards",className:"w-full",children:[n.jsxs(Qa,{className:"w-full mb-6 p-1 bg-muted/50 rounded-xl",children:[n.jsx(pr,{value:"rewards",className:"flex-1 rounded-lg",children:"Recompensas"}),n.jsx(pr,{value:"my-rewards",className:"flex-1 rounded-lg",children:"Meus Resgates"})]}),n.jsxs(wr,{value:"rewards",className:"space-y-10",children:[y.length>0&&n.jsxs("section",{children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Wr,{className:"h-4 w-4 text-amber-500"}),n.jsx("span",{className:"text-xs font-bold uppercase tracking-[0.2em] text-amber-600",children:"Exclusivo para voc"})]}),n.jsx("h3",{className:"font-serif text-xl md:text-2xl font-semibold mb-5",children:"Recompensas em Destaque"}),n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5",children:y.map(j=>n.jsx(HM,{reward:j,currentPoints:(e==null?void 0:e.currentPoints)||0,currentTier:f,onRedeem:h,isRedeeming:l===j.id,canRedeem:i(j)},j.id))})]}),n.jsxs("section",{children:[n.jsxs("div",{className:"mb-5",children:[n.jsx("span",{className:"text-xs font-bold uppercase tracking-[0.2em] text-accent",children:"Catlogo"}),n.jsx("h3",{className:"font-serif text-xl md:text-2xl font-semibold mt-1",children:"Todas as Recompensas"}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Quanto mais voc compra, mais recompensas desbloqueia."})]}),n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:t.map(j=>n.jsx(HM,{reward:j,currentPoints:(e==null?void 0:e.currentPoints)||0,currentTier:f,onRedeem:h,isRedeeming:l===j.id,canRedeem:i(j)},j.id))})]})]}),n.jsx(wr,{value:"my-rewards",children:r.length===0?n.jsxs("div",{className:"text-center py-16 bg-muted/30 rounded-3xl border border-dashed",children:[n.jsx(Rn,{className:"h-16 w-16 mx-auto mb-4 text-muted-foreground/30"}),n.jsx("h3",{className:"text-lg font-medium mb-2",children:"Nenhum resgate ainda"}),n.jsx("p",{className:"text-muted-foreground text-sm max-w-xs mx-auto",children:"Seus pontos acumulados podem ser trocados por produtos e descontos incrveis."})]}):n.jsx("div",{className:"space-y-4",children:r.map(j=>{var T;return n.jsxs("div",{className:"bg-card border rounded-2xl p-5 shadow-sm hover:shadow-md transition-shadow",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-lg",children:((T=j.reward)==null?void 0:T.name)||"Recompensa"}),n.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[n.jsx("div",{className:"bg-muted px-3 py-1 rounded-md font-mono text-sm font-medium select-all",children:j.couponCode}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Copie o cdigo"})]})]}),n.jsx("span",{className:`text-xs px-3 py-1 rounded-full font-medium ${j.status==="active"?"bg-green-100 text-green-700":j.status==="used"?"bg-gray-100 text-gray-500":"bg-red-100 text-red-700"}`,children:j.status==="active"?"Ativo":j.status==="used"?"Usado":"Expirado"})]}),n.jsxs("div",{className:"mt-4 pt-4 border-t flex justify-between items-center text-xs text-muted-foreground",children:[n.jsxs("span",{children:["Resgatado em ",new Date(j.createdAt).toLocaleDateString("pt-BR")]}),n.jsxs("span",{children:["Vlido at ",new Date(j.expiresAt).toLocaleDateString("pt-BR")]})]})]},j.id)})})})]})]})}function YCe(){const{user:e}=Hn(),{loyalty:t,monthlyMissionLimit:r,getMissionPointsRemaining:s}=C1(),[a,i]=P.useState([]),[o,c]=P.useState([]),[d,l]=P.useState(!0);if(P.useEffect(()=>{e?Promise.all([ce.from("mission_attempts").select("mission_id, status, completed_at").eq("user_id",e.id),ce.from("profiles").select("completed_missions").eq("user_id",e.id).maybeSingle()]).then(([v,x])=>{var y;i(v.data||[]),c(((y=x.data)==null?void 0:y.completed_missions)||[]),l(!1)}):l(!1)},[e]),d)return n.jsx(Pp,{title:"Mdulos de Estilo",showBackButton:!0,children:n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-foreground/20"})})});const u=cv(o),h=(t==null?void 0:t.currentPoints)||0,f=(t==null?void 0:t.weeklyMissionPoints)||0,m=s(f),p=a.filter(v=>v.status==="in_progress"),g=o.map(v=>{const x=a.find(y=>y.mission_id===v&&y.status==="completed");return{id:v,completedAt:x==null?void 0:x.completed_at}});return n.jsxs(Pp,{title:"Mdulos de Estilo",showBackButton:!0,children:[n.jsx("div",{className:"border border-foreground/10 p-5 mb-6",children:n.jsxs("div",{className:"flex items-end justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-[10px] tracking-[0.3em] uppercase text-foreground/40 font-medium mb-1",children:"Seus pontos no Le.Po Club"}),n.jsx("p",{className:"text-3xl font-light text-foreground",children:h.toLocaleString()})]}),n.jsx("div",{className:"text-right",children:n.jsx("p",{className:"text-[11px] text-foreground/40 tracking-wide",children:(t==null?void 0:t.currentTier)==="poa"?"Po":(t==null?void 0:t.currentTier)==="poa_gold"?"Po Gold":(t==null?void 0:t.currentTier)==="poa_platinum"?"Po Platinum":(t==null?void 0:t.currentTier)==="poa_black"?"Po Black":"Po"})})]})}),n.jsxs("div",{className:"border border-foreground/10 p-4 mb-8",children:[n.jsxs("div",{className:"flex items-center justify-between mb-3",children:[n.jsx("p",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/40 font-medium",children:"Progresso mensal de mdulos"}),n.jsxs("span",{className:"text-[11px] text-foreground/40",children:[m," pts restantes"]})]}),n.jsx("div",{className:"h-px bg-border relative",children:n.jsx("div",{className:"h-px bg-foreground transition-all duration-700",style:{width:`${f/r*100}%`}})}),n.jsxs("p",{className:"text-[11px] text-foreground/30 mt-2",children:[f," / ",r," Pos este ms"]})]}),p.length>0&&n.jsxs("div",{className:"mb-8",children:[n.jsx("h2",{className:"text-[11px] tracking-[0.2em] uppercase text-foreground/40 font-medium mb-4",children:"Em andamento"}),n.jsx("div",{className:"space-y-3",children:p.map(v=>{var y;const x=Pw(v.mission_id);return x?n.jsx(p4,{id:x.id,title:x.title,description:x.subtitle,questionCount:(y=x.questions)==null?void 0:y.length,status:"in_progress"},v.mission_id):null})})]}),u.length>0&&n.jsxs("div",{className:"mb-8",children:[n.jsx("h2",{className:"text-[11px] tracking-[0.2em] uppercase text-foreground/40 font-medium mb-4",children:"Disponveis"}),n.jsx("div",{className:"space-y-3",children:u.map(v=>{var x;return n.jsx(p4,{id:v.id,title:v.title,description:v.subtitle,questionCount:(x=v.questions)==null?void 0:x.length,status:"available"},v.id)})})]}),g.length>0&&n.jsxs("div",{children:[n.jsx("h2",{className:"text-[11px] tracking-[0.2em] uppercase text-foreground/40 font-medium mb-4",children:"Concludos"}),n.jsx("div",{className:"space-y-3",children:g.map(({id:v,completedAt:x})=>{const y=Pw(v);return y?n.jsx(p4,{id:y.id,title:y.title,description:y.subtitle,status:"completed",completedAt:x||void 0},v):null})})]}),u.length===0&&p.length===0&&g.length===0&&n.jsx("div",{className:"text-center py-16",children:n.jsx("p",{className:"text-foreground/40 text-sm font-light",children:"Faa o quiz de estilo primeiro para desbloquear mdulos"})})]})}function p4({id:e,title:t,description:r,questionCount:s,status:a,completedAt:i}){const o=a==="completed";return n.jsx("div",{className:We("border p-5 transition-all duration-300",o?"border-foreground/10 bg-foreground/[0.02]":"border-border hover:border-foreground/30"),children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx("h3",{className:We("text-sm tracking-wide",o?"text-foreground/50":"font-medium"),children:t}),o&&n.jsx(pn,{className:"h-3.5 w-3.5 text-foreground/30 shrink-0"})]}),n.jsx("p",{className:"text-[12px] text-foreground/40 font-light",children:r}),n.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[s&&n.jsxs("span",{className:"text-[11px] text-foreground/30 tracking-wide",children:[s," perguntas"]}),o&&i&&n.jsxs("span",{className:"text-[11px] text-foreground/30",children:["Concludo em ",new Date(i).toLocaleDateString("pt-BR")]})]})]}),n.jsx("div",{className:"shrink-0",children:o?n.jsx("span",{className:"text-[11px] tracking-[0.15em] uppercase text-foreground/30 font-medium",children:"Concludo"}):n.jsx(Gt,{to:`/missao/${e}`,children:n.jsxs("button",{className:"px-5 py-2.5 border border-foreground/20 text-[11px] tracking-[0.15em] uppercase font-medium text-foreground/60 transition-all duration-300 hover:border-foreground hover:text-foreground flex items-center gap-2",children:[a==="in_progress"?"Continuar":"Iniciar",n.jsx(ps,{className:"h-3 w-3"})]})})})]})})}const sm={pendente:{label:"Pendente",icon:Br,color:"bg-amber-100 text-amber-800"},aguardando_pagamento:{label:"Pendente",icon:xs,color:"bg-orange-100 text-orange-800"},confirmado:{label:"Confirmado",icon:Er,color:"bg-blue-100 text-blue-800"},pago:{label:"Pago",icon:Er,color:"bg-green-100 text-green-800"},etiqueta_gerada:{label:"Enviado",icon:gn,color:"bg-purple-100 text-purple-800"},enviado:{label:"Enviado",icon:gn,color:"bg-purple-100 text-purple-800"},postado:{label:"Enviado",icon:gn,color:"bg-purple-100 text-purple-800"},em_rota:{label:"Em rota de entrega",icon:gn,color:"bg-indigo-100 text-indigo-800"},entregue:{label:"Entregue",icon:Er,color:"bg-green-100 text-green-800"},cancelado:{label:"Cancelado",icon:an,color:"bg-red-100 text-red-800"},aberto:{label:"Pendente",icon:Br,color:"bg-amber-100 text-amber-800"},expirado:{label:"Pendente",icon:xs,color:"bg-orange-100 text-orange-800"},pagamento_rejeitado:{label:"Pagamento rejeitado",icon:an,color:"bg-red-100 text-red-800"},reembolsado:{label:"Reembolsado",icon:en,color:"bg-gray-100 text-gray-800"}},ZCe={label:"Em andamento",icon:Br,color:"bg-blue-100 text-blue-800"},b5=e=>{if(!e||e.startsWith("ORD-")||e.startsWith("ORD"))return!1;const t=/^[A-Z]{2}\d{9}BR$/.test(e),r=/^\d{8,20}$/.test(e);return t||r},RY=(e,t)=>{if(b5(t)){const r=sm.enviado;return e==="entregue"?sm.entregue:e==="cancelado"?sm.cancelado:e==="reembolsado"?sm.reembolsado:r}return e&&sm[e]?sm[e]:ZCe};function QCe(){const e=fr(),{user:t,isLoading:r}=Hn(),[s,a]=P.useState([]),[i,o]=P.useState(!0);P.useEffect(()=>{!r&&!t&&e("/minha-conta")},[t,r,e]),P.useEffect(()=>{t&&c()},[t]);const c=async()=>{if(t)try{const{data:u,error:h}=await ce.from("orders").select("id, created_at, status, total, customer_name, tracking_code").eq("user_id",t.id).order("created_at",{ascending:!1});if(h)throw h;const{data:f,error:m}=await ce.from("live_carts").select("id, created_at, status, total").eq("user_id",t.id).order("created_at",{ascending:!1});m&&m.code!=="PGRST100"&&console.error("Error fetching live orders:",m);const p=await Promise.all((u||[]).map(async x=>{const{count:y}=await ce.from("order_items").select("*",{count:"exact",head:!0}).eq("order_id",x.id);return{...x,items_count:y||0,type:"regular"}})),g=(f||[]).map(x=>{var y;return{id:x.id,created_at:x.created_at,status:x.status,total:x.total,customer_name:((y=t==null?void 0:t.user_metadata)==null?void 0:y.name)||"Cliente",tracking_code:null,items_count:1,type:"live"}}),v=[...p,...g].sort((x,y)=>new Date(y.created_at).getTime()-new Date(x.created_at).getTime());a(v)}catch(u){console.error("Error loading orders:",u)}finally{o(!1)}},d=u=>new Date(u).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"}),l=u=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(u);return r?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8",children:[n.jsx(Kr,{className:"h-8 w-48 mb-6"}),n.jsx("div",{className:"space-y-4",children:[1,2,3].map(u=>n.jsx(Kr,{className:"h-24 w-full"},u))})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[n.jsx("h1",{className:"font-serif text-2xl mb-6",children:"Meus Pedidos e Lives"}),i?n.jsx("div",{className:"space-y-4",children:[1,2,3].map(u=>n.jsx(Kr,{className:"h-24 w-full"},u))}):s.length===0?n.jsx(De,{children:n.jsxs(Be,{className:"py-12 text-center",children:[n.jsx(Ut,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"Voc ainda no fez nenhum pedido"}),n.jsx(Gt,{to:"/catalogo",className:"text-accent hover:underline",children:"Conferir peas "})]})}):n.jsx("div",{className:"space-y-3",children:s.map(u=>{const h=RY(u.status,u.tracking_code),f=h.icon,m=u.id.slice(0,8).toUpperCase(),p=No(Kfe(m));return n.jsx(De,{className:"hover:shadow-md transition-shadow",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Gt,{to:`/meus-pedidos/${u.id}`,className:"flex-1",children:n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"font-medium text-sm",children:["Pedido #",m]}),n.jsxs(Ae,{className:`${h.color} border-0 gap-1`,children:[n.jsx(f,{className:"h-3 w-3"}),h.label]})]}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[d(u.created_at),"  ",u.items_count," ",u.items_count===1?"item":"itens"]}),n.jsx("p",{className:"font-semibold",children:l(u.total)})]})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(q_,{href:p,variant:"circle"}),n.jsx(Gt,{to:`/meus-pedidos/${u.id}`,children:n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground"})})]})]})})},u.id)})})]})]})}function JCe(){const e=fr(),{id:t}=ra(),{user:r,isLoading:s}=Hn(),[a,i]=P.useState(null),[o,c]=P.useState([]),[d,l]=P.useState(!0),[u,h]=P.useState(!1),[f,m]=P.useState(!1),[p,g]=P.useState(null);P.useEffect(()=>{!s&&!r&&e("/minha-conta")},[r,s,e]),P.useEffect(()=>{r&&t&&v()},[r,t]);const v=async()=>{if(!r||!t)return;const{data:H,error:M}=await ce.from("orders").select("*").eq("id",t).eq("user_id",r.id).maybeSingle();if(M||!H){de.error("Pedido no encontrado"),e("/meus-pedidos");return}i(H);const{data:F}=await ce.from("order_items").select("*").eq("order_id",t);c(F||[]),l(!1)};P.useEffect(()=>{if(!(a!=null&&a.reserved_until)||a.status!=="aguardando_pagamento"){g(null);return}const H=()=>{const F=new Date,E=new Date(a.reserved_until).getTime()-F.getTime();if(E<=0){g("expirado");return}const N=Math.floor(E/6e4),C=Math.floor(E%6e4/1e3);g(`${N}:${C.toString().padStart(2,"0")}`)};H();const M=setInterval(H,1e3);return()=>clearInterval(M)},[a==null?void 0:a.reserved_until,a==null?void 0:a.status]);const x=async()=>{if(!a)return;h(!0);const{error:H}=await ce.from("orders").update({status:"cancelado"}).eq("id",a.id);H?de.error("Erro ao cancelar pedido"):(de.success("Pedido cancelado"),i({...a,status:"cancelado"})),h(!1)},y=async()=>{if(a){if(console.log("[PedidoDetalhe] Iniciando pagamento...",{orderId:a.id}),a.mp_checkout_url){console.log("[PedidoDetalhe] Redirecionando para URL existente:",a.mp_checkout_url),window.location.href=a.mp_checkout_url;return}m(!0);try{console.log("[PedidoDetalhe] Invocando create-mp-preference...");const{data:H,error:M}=await ce.functions.invoke("create-mp-preference",{body:{order_id:a.id,payer_email:(r==null?void 0:r.email)||""}});if(console.log("[PedidoDetalhe] Retorno da Edge Function:",{data:H,error:M}),M){console.error("[PedidoDetalhe] Erro RPC:",M);let S="Erro ao conectar com servidor de pagamento.";try{typeof M=="string"&&(S=M),M.message&&(S=M.message),M.message==="Failed to fetch"&&(S="Erro de conexo (CORS/Network). Verifique sua internet.")}catch{}de.error(`${S} Tente novamente.`);return}if(H!=null&&H.error_code||H!=null&&H.error){console.error("[PedidoDetalhe] Erro retornado pela API:",H),de.error(`Erro no pagamento: ${H.message||H.error||"Falha desconhecida"}`);return}const F=H.init_point||H.sandbox_init_point;if(F){console.log("[PedidoDetalhe] Link gerado:",F);const S={...a,mp_checkout_url:F,mp_preference_id:H.preference_id};i(S),await ce.from("orders").update({mp_checkout_url:F,mp_preference_id:H.preference_id,total:H.calculated_total||a.total}).eq("id",a.id),window.location.href=F}else console.error("[PedidoDetalhe] Nenhuma URL retornada:",H),de.error("Link de pagamento no disponvel (resposta vazia).")}catch(H){console.error("[PedidoDetalhe] Exceo crtica:",H),de.error(`Erro de conexo: ${H.message||"Tente novamente."}`)}finally{m(!1)}}},b=H=>new Date(H).toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),j=H=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(H),T=H=>H.slice(0,8).toUpperCase(),O=()=>{if(!a)return"";const H=o.map(F=>({name:F.product_name,size:F.size,color:F.color,quantity:F.quantity})),M=Gfe(T(a.id),H,j(a.total));return No(M)},R=a!=null&&a.reserved_until?new Date(a.reserved_until)<new Date:!1,D=(a==null?void 0:a.status)==="aguardando_pagamento"&&!R,L=a&&(a.status==="pendente"||a.status==="aguardando_pagamento")&&!R;if(s||d)return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[n.jsx(Kr,{className:"h-8 w-48 mb-6"}),n.jsx(Kr,{className:"h-64 w-full"})]})]});if(!a)return null;const q=RY(a.status,a.tracking_code),X=q.icon;return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>e("/meus-pedidos"),className:"mb-4",children:[n.jsx(vs,{className:"h-4 w-4 mr-1"}),"Voltar"]}),n.jsxs("div",{className:"flex items-start justify-between mb-6",children:[n.jsxs("div",{children:[n.jsxs("h1",{className:"font-serif text-2xl mb-1",children:["Pedido #",T(a.id)]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:b(a.created_at)})]}),n.jsxs(Ae,{className:`${q.color} border-0 gap-1`,children:[n.jsx(X,{className:"h-3 w-3"}),q.label]})]}),b5(a.tracking_code)&&n.jsx(De,{className:"mb-4 border-purple-200 bg-purple-50 dark:bg-purple-950/20",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(gn,{className:"h-5 w-5 text-purple-600 shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"text-sm font-medium text-purple-800 dark:text-purple-200",children:"Cdigo de rastreio"}),n.jsx("p",{className:"font-mono text-lg text-purple-900 dark:text-purple-100",children:a.tracking_code})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 border-purple-200 text-purple-700 hover:bg-purple-100",onClick:async()=>{await gf(a.tracking_code)&&de.success("Cdigo copiado!")},children:[n.jsx(Ia,{className:"h-4 w-4"}),"Copiar cdigo"]}),n.jsxs(he,{variant:"default",size:"sm",className:"gap-2 bg-purple-600 hover:bg-purple-700",onClick:()=>{window.open(`https://rastreamento.correios.com.br/app/index.php?objeto=${a.tracking_code}`,"_blank")},children:[n.jsx(ma,{className:"h-4 w-4"}),"Rastrear nos Correios"]})]})]})})}),a.status==="etiqueta_gerada"&&!b5(a.tracking_code)&&n.jsx(De,{className:"mb-4 border-purple-200 bg-purple-50 dark:bg-purple-950/20",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(gn,{className:"h-5 w-5 text-purple-600 shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-purple-800 dark:text-purple-200",children:"Pedido em preparao para envio"}),n.jsx("p",{className:"text-xs text-purple-700 dark:text-purple-300",children:"O cdigo de rastreio estar disponvel em breve."})]})]})})}),n.jsxs(De,{className:"mb-4",children:[n.jsx(Ot,{className:"pb-2",children:n.jsx(Mt,{className:"text-sm font-medium text-muted-foreground",children:"Itens do pedido"})}),n.jsxs(Be,{className:"space-y-4",children:[o.map(H=>n.jsxs("div",{className:"flex gap-3",children:[H.image_url?n.jsx("img",{src:H.image_url,alt:H.product_name,className:"w-16 h-16 object-cover rounded-lg"}):n.jsx("div",{className:"w-16 h-16 bg-secondary rounded-lg flex items-center justify-center",children:n.jsx(Ut,{className:"h-6 w-6 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:H.product_name}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Tamanho: ",H.size,H.color&&`  Cor: ${H.color}`]}),n.jsxs("div",{className:"flex justify-between items-center mt-1",children:[n.jsxs("span",{className:"text-sm text-muted-foreground",children:["Qtd: ",H.quantity]}),n.jsx("span",{className:"font-medium",children:j(H.product_price*H.quantity)})]})]})]},H.id)),n.jsx(Ta,{}),n.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{className:"text-accent",children:j(a.total)})]})]})]}),n.jsxs(De,{className:"mb-6",children:[n.jsx(Ot,{className:"pb-2",children:n.jsx(Mt,{className:"text-sm font-medium text-muted-foreground",children:"Endereo de entrega"})}),n.jsxs(Be,{children:[n.jsx("p",{className:"font-medium",children:a.customer_name}),n.jsx("p",{className:"text-sm text-muted-foreground",children:a.customer_phone}),n.jsx("p",{className:"text-sm mt-2",children:a.customer_address})]})]}),n.jsxs("div",{className:"space-y-3",children:[a.status==="aguardando_pagamento"&&R&&n.jsx(De,{className:"border-amber-200 bg-amber-50 dark:bg-amber-950/20",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Mr,{className:"h-5 w-5 text-amber-600 shrink-0"}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm font-medium text-amber-800 dark:text-amber-200",children:"Reserva expirada"}),n.jsx("p",{className:"text-xs text-amber-700 dark:text-amber-300",children:"Os itens podem ter sido liberados para outros clientes. Entre em contato para verificar disponibilidade."})]})]})})}),a.status==="aguardando_pagamento"&&p&&p!=="expirado"&&n.jsx(De,{className:"border-orange-200 bg-orange-50 dark:bg-orange-950/20",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ZS,{className:"h-4 w-4 text-orange-600"}),n.jsx("span",{className:"text-sm text-orange-700 dark:text-orange-300",children:"Reserva expira em:"})]}),n.jsx("span",{className:"font-mono font-bold text-orange-800 dark:text-orange-200",children:p})]})})}),D&&n.jsxs(he,{className:"w-full gap-2",onClick:y,disabled:f,children:[f?n.jsx(At,{className:"h-4 w-4 animate-spin"}):n.jsx(xs,{className:"h-4 w-4"}),f?"Gerando link...":"Pagar agora"]}),!D&&a.payment_link&&a.status==="pendente"&&n.jsx(he,{className:"w-full gap-2",asChild:!0,children:n.jsxs("a",{href:a.payment_link,target:"_blank",rel:"noopener noreferrer",children:[n.jsx(xs,{className:"h-4 w-4"}),"Pagar agora"]})}),n.jsx(q_,{href:O(),label:a.status==="cancelado"?"Falar com a loja mesmo assim":"Falar no WhatsApp",showMicrocopy:a.status!=="cancelado"}),L&&n.jsxs(Ac,{children:[n.jsx(E1,{asChild:!0,children:n.jsxs(he,{variant:"ghost",className:"w-full text-destructive hover:text-destructive gap-2",children:[n.jsx(an,{className:"h-4 w-4"}),"Cancelar pedido"]})}),n.jsxs(Dl,{children:[n.jsxs(Ll,{children:[n.jsx(Bl,{children:"Cancelar pedido?"}),n.jsx($l,{children:"Esta ao no pode ser desfeita. O pedido ser cancelado permanentemente."})]}),n.jsxs(Tc,{children:[n.jsx(Oc,{children:"Voltar"}),n.jsx(Pc,{onClick:x,disabled:u,className:"bg-destructive hover:bg-destructive/90",children:u?n.jsx(At,{className:"h-4 w-4 animate-spin"}):"Confirmar cancelamento"})]})]})]})]})]})]})}function e5e(){const e=fr(),{user:t,isLoading:r}=Hn(),{addItem:s}=Wu(),[a,i]=P.useState([]),[o,c]=P.useState(!0);P.useEffect(()=>{!r&&!t&&e("/minha-conta")},[t,r,e]),P.useEffect(()=>{t&&d()},[t]);const d=async()=>{if(!t)return;const{data:m,error:p}=await ce.from("print_requests").select("id, created_at, image_path, size, status, linked_product_id").eq("user_id",t.id).order("created_at",{ascending:!1});if(!p&&m){const g=await Promise.all(m.map(async v=>{if(v.linked_product_id){const{data:x}=await ce.from("product_catalog").select("id, name, price, image_url, sizes").eq("id",v.linked_product_id).single();return{...v,linked_product:x}}return{...v,linked_product:null}}));i(g)}c(!1)},l=m=>{const{data:p}=ce.storage.from("prints").getPublicUrl(m);return p.publicUrl},u=m=>new Date(m).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric"}),h=m=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(m),f=m=>{!m.linked_product||!m.size||(s({productId:m.linked_product.id,name:m.linked_product.name,price:m.linked_product.price,originalPrice:m.linked_product.price,discountPercent:0,size:m.size,imageUrl:m.linked_product.image_url||void 0}),de.success("Produto adicionado ao carrinho!"),e("/carrinho"))};return r?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8",children:[n.jsx(Kr,{className:"h-8 w-48 mb-6"}),n.jsx("div",{className:"space-y-4",children:[1,2].map(m=>n.jsx(Kr,{className:"h-32 w-full"},m))})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-2xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h1",{className:"font-serif text-2xl",children:"Meus Prints"}),n.jsx(Gt,{to:"/enviar-print",children:n.jsxs(he,{size:"sm",className:"gap-2",children:[n.jsx(Ma,{className:"h-4 w-4"}),"Enviar novo"]})})]}),o?n.jsx("div",{className:"space-y-4",children:[1,2].map(m=>n.jsx(Kr,{className:"h-32 w-full"},m))}):a.length===0?n.jsx(De,{children:n.jsxs(Be,{className:"py-12 text-center",children:[n.jsx(Ma,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"Voc ainda no enviou nenhum print"}),n.jsx(Gt,{to:"/enviar-print",className:"text-accent hover:underline",children:"Enviar print do story "})]})}):n.jsx("div",{className:"space-y-4",children:a.map(m=>n.jsx(De,{children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex gap-4",children:[n.jsx("div",{className:"w-20 h-24 bg-stone-50 rounded-lg overflow-hidden flex-shrink-0",children:n.jsx("img",{src:l(m.image_path),alt:"Print enviado",className:"w-full h-full object-contain"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:u(m.created_at)}),m.linked_product?n.jsxs(Ae,{className:"bg-green-100 text-green-800 border-0 gap-1",children:[n.jsx(Er,{className:"h-3 w-3"}),"Encontrado"]}):n.jsxs(Ae,{className:"bg-amber-100 text-amber-800 border-0 gap-1",children:[n.jsx(Br,{className:"h-3 w-3"}),"Em anlise"]})]}),m.size&&n.jsxs("p",{className:"text-sm mb-2",children:["Tamanho: ",n.jsx("span",{className:"font-medium",children:m.size})]}),m.linked_product&&n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-secondary/50 rounded-lg",children:[m.linked_product.image_url&&n.jsx("div",{className:"w-12 h-14 bg-stone-50 rounded overflow-hidden",children:n.jsx("img",{src:m.linked_product.image_url,alt:m.linked_product.name,className:"w-full h-full object-contain"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-sm truncate",children:m.linked_product.name}),n.jsx("p",{className:"text-sm text-accent",children:h(m.linked_product.price)})]}),n.jsxs(he,{size:"sm",onClick:()=>f(m),className:"gap-1",children:[n.jsx(ln,{className:"h-4 w-4"}),"Comprar"]})]})]})]})})},m.id))})]})]})}const t5e=["PP","P","M","G","GG","34","36","38","40","42","44","46"],r5e={zipCode:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:"",reference:"",document:""};function n5e(){const e=fr(),{user:t,isLoading:r,signOut:s}=Hn(),[a,i]=P.useState(!0),[o,c]=P.useState(!1),[d,l]=P.useState(!1),[u,h]=P.useState({name:"",whatsapp:"",instagram_handle:"",birth_date:"",preferred_sizes:[],style_preferences:"",addressData:r5e});P.useEffect(()=>{!r&&!t&&e("/minha-conta")},[t,r,e]),P.useEffect(()=>{t&&f()},[t]);const f=async()=>{if(!t)return;const{data:x,error:y}=await ce.from("profiles").select("name, whatsapp, instagram_handle, birth_date, preferred_sizes, style_preferences, address_line, city, state, zip_code, address_reference").eq("user_id",t.id).single();if(!y&&x){let b="",j="",T="",O="";if(x.address_line){const R=x.address_line.split(",").map(D=>D.trim());if(R.length>=1&&(b=R[0]),R.length>=2){const D=R[1].match(/^(\d+)\s*(.*)/);D?(j=D[1],T=D[2]||""):O=R[1]}R.length>=3&&(O=R[2])}h({name:x.name||"",whatsapp:x.whatsapp||"",instagram_handle:x.instagram_handle||"",birth_date:x.birth_date||"",preferred_sizes:x.preferred_sizes||[],style_preferences:x.style_preferences||"",addressData:{zipCode:x.zip_code||"",street:b,number:j,complement:T,neighborhood:O,city:x.city||"",state:x.state||"",reference:x.address_reference||"",document:""}}),!x.address_line&&!x.zip_code&&l(!0)}i(!1)},m=async()=>{if(!t)return;c(!0);const x=[u.addressData.street];u.addressData.number&&x.push(u.addressData.number+(u.addressData.complement?" "+u.addressData.complement:"")),u.addressData.neighborhood&&x.push(u.addressData.neighborhood);const y=x.filter(Boolean).join(", "),b=u.instagram_handle.replace(/@/g,"").replace(/\s/g,"").toLowerCase().trim()||null,{error:j}=await ce.from("profiles").update({name:u.name,whatsapp:u.whatsapp,instagram_handle:b,birth_date:u.birth_date||null,preferred_sizes:u.preferred_sizes,style_preferences:u.style_preferences,address_line:y,city:u.addressData.city,state:u.addressData.state,zip_code:u.addressData.zipCode,address_reference:u.addressData.reference}).eq("user_id",t.id);j?de.error("Erro ao salvar. Tente novamente."):(de.success("Perfil atualizado!"),l(!1)),c(!1)},p=x=>{h(y=>({...y,preferred_sizes:y.preferred_sizes.includes(x)?y.preferred_sizes.filter(b=>b!==x):[...y.preferred_sizes,x]}))},g=async()=>{await s(),e("/"),de.success("At logo!")},v=u.addressData.street||u.addressData.zipCode;return r||a?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-lg",children:[n.jsx(Kr,{className:"h-8 w-48 mb-6"}),n.jsxs("div",{className:"space-y-4",children:[n.jsx(Kr,{className:"h-24 w-full"}),n.jsx(Kr,{className:"h-24 w-full"})]})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-lg",children:[n.jsx("h1",{className:"font-serif text-2xl mb-6",children:"Meu Perfil"}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"text-base flex items-center gap-2",children:[n.jsx(Wn,{className:"h-4 w-4"}),"Dados pessoais"]})}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"name",children:"Nome"}),n.jsx(Qe,{id:"name",value:u.name,onChange:x=>h(y=>({...y,name:x.target.value})),placeholder:"Seu nome"})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"email",children:"Email"}),n.jsx(Qe,{id:"email",value:(t==null?void 0:t.email)||"",disabled:!0,className:"bg-muted"})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"whatsapp",children:"WhatsApp"}),n.jsx(Qe,{id:"whatsapp",value:u.whatsapp,onChange:x=>h(y=>({...y,whatsapp:x.target.value})),placeholder:"(11) 99999-9999"})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"instagram",children:"Instagram"}),n.jsx(Qe,{id:"instagram",value:u.instagram_handle,onChange:x=>h(y=>({...y,instagram_handle:x.target.value})),placeholder:"@seuinstagram"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Preencha para ver seus pedidos de live aqui na sua conta"})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"birth_date",children:"Data de nascimento"}),n.jsx(Qe,{id:"birth_date",type:"date",value:u.birth_date,onChange:x=>h(y=>({...y,birth_date:x.target.value}))}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Usada para sua ao exclusiva de aniversrio no Le.Po Club"})]})]})]}),n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"text-base flex items-center justify-between",children:[n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(_o,{className:"h-4 w-4"}),"Endereo de entrega"]}),v&&!d&&n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>l(!0),className:"text-muted-foreground hover:text-foreground",children:[n.jsx(ea,{className:"h-4 w-4 mr-1"}),"Editar"]})]})}),n.jsx(Be,{children:d?n.jsxs("div",{className:"space-y-4",children:[n.jsx(oj,{value:u.addressData,onChange:x=>h(y=>({...y,addressData:x}))}),v&&n.jsx(he,{variant:"outline",size:"sm",onClick:()=>l(!1),className:"w-full",children:"Cancelar edio"})]}):v?n.jsx("div",{className:"bg-muted/50 rounded-lg p-4",children:n.jsx("p",{className:"text-sm",children:KC(u.addressData)})}):n.jsxs("div",{className:"text-center py-4",children:[n.jsx("p",{className:"text-muted-foreground text-sm mb-3",children:"Nenhum endereo cadastrado"}),n.jsx(he,{variant:"outline",size:"sm",onClick:()=>l(!0),children:"Adicionar endereo"})]})})]}),n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsx(Mt,{className:"text-base",children:"Preferncias de moda"})}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx(Le,{className:"mb-2 block",children:"Meus tamanhos favoritos"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:t5e.map(x=>n.jsx("button",{onClick:()=>p(x),className:`px-3 py-1.5 text-sm rounded-full border transition-colors ${u.preferred_sizes.includes(x)?"bg-accent text-accent-foreground border-accent":"border-border hover:border-accent/50"}`,children:x},x))})]}),n.jsxs("div",{children:[n.jsx(Le,{htmlFor:"style",children:"Estilo e preferncias"}),n.jsx(Yn,{id:"style",value:u.style_preferences,onChange:x=>h(y=>({...y,style_preferences:x.target.value})),placeholder:"Ex: Gosto de peas confortveis, cores neutras, estampas florais...",rows:3})]})]})]}),n.jsx(he,{onClick:m,className:"w-full gap-2",disabled:o,children:o?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 animate-spin"}),"Salvando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(td,{className:"h-4 w-4"}),"Salvar alteraes"]})}),n.jsx(he,{variant:"outline",onClick:g,className:"w-full text-muted-foreground",children:"Sair da conta"})]})]})]})}function s5e(){const e=fr(),{user:t,isLoading:r}=Hn(),[s,a]=P.useState(!0),[i,o]=P.useState([]),[c,d]=P.useState(null),[l,u]=P.useState(!1);P.useEffect(()=>{!r&&!t&&e("/minha-conta")},[t,r,e]),P.useEffect(()=>{t&&h()},[t]);const h=async()=>{if(t)try{const{data:g}=await ce.from("profiles").select("*").eq("user_id",t.id).single(),{data:v}=await ce.from("customers").select("id, style_title, size_letter, size_number").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(1),x=v==null?void 0:v[0];let y=[],b=(g==null?void 0:g.quiz_points)||0;if(x){const{data:L}=await ce.from("quiz_responses").select("question, answer, points").eq("customer_id",x.id).order("question_number");L&&(y=L,b||(b=L.reduce((q,X)=>q+(X.points||0),0)))}const j=(g==null?void 0:g.size_letter)||(x==null?void 0:x.size_letter),T=(g==null?void 0:g.size_number)||(x==null?void 0:x.size_number),O=(g==null?void 0:g.style_title)||(x==null?void 0:x.style_title);d({styleTitle:O,sizeLetter:j,sizeNumber:T,totalPoints:b,responses:y});const{data:R}=await ce.from("product_catalog").select("*").eq("is_active",!0).limit(20),D=(R||[]).filter(L=>{const q=L.stock_by_size;return q?(q.UN||0)>0||j&&(q[j]||0)>0||T&&(q[T]||0)>0?!0:!j&&!T?Object.values(q).some(X=>X>0):!1:!1});o(D.slice(0,8))}catch(g){console.error("Error loading suggestions:",g)}finally{a(!1)}},f=async()=>{u(!0),await h(),de.success("Sugestes atualizadas!"),u(!1)},{level:m,title:p}=uf((c==null?void 0:c.totalPoints)||0);return r||s?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[n.jsx(Kr,{className:"h-8 w-48 mb-6"}),n.jsxs("div",{className:"grid gap-4",children:[n.jsx(Kr,{className:"h-32 w-full"}),n.jsx(Kr,{className:"h-64 w-full"})]})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-8 max-w-4xl",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h1",{className:"font-serif text-2xl",children:"Sugestes pra mim"}),n.jsxs(he,{variant:"outline",size:"sm",onClick:f,disabled:l,children:[l?n.jsx(At,{className:"h-4 w-4 animate-spin"}):n.jsx(en,{className:"h-4 w-4"}),n.jsx("span",{className:"ml-2 hidden sm:inline",children:"Atualizar"})]})]}),c&&c.totalPoints>0&&n.jsx(De,{className:"mb-6 bg-gradient-to-r from-amber-500/10 via-accent/10 to-amber-500/10 border-amber-500/30",children:n.jsx(Be,{className:"py-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-amber-500 to-accent flex items-center justify-center",children:n.jsx(ga,{className:"h-6 w-6 text-white"})}),n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium",children:["Nvel ",m,": ",p]}),n.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-muted-foreground",children:[n.jsx(ki,{className:"h-3.5 w-3.5 text-amber-500 fill-amber-500"}),n.jsxs("span",{children:[c.totalPoints," pontos acumulados"]})]})]})]}),c.styleTitle&&n.jsxs("div",{className:"text-right hidden sm:block",children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Seu estilo"}),n.jsx("p",{className:"font-medium",children:c.styleTitle})]})]})})}),(!c||!c.styleTitle)&&n.jsx(De,{className:"mb-6",children:n.jsxs(Be,{className:"py-8 text-center",children:[n.jsx(Wr,{className:"h-12 w-12 mx-auto mb-4 text-accent"}),n.jsx("h2",{className:"font-serif text-xl mb-2",children:"Descubra seu estilo!"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"Faa o quiz de estilo e receba sugestes personalizadas de looks"}),n.jsx(Gt,{to:"/quiz",children:n.jsxs(he,{className:"gap-2",children:[n.jsx(Rn,{className:"h-4 w-4"}),"Fazer o Quiz"]})})]})}),((c==null?void 0:c.sizeLetter)||(c==null?void 0:c.sizeNumber))&&n.jsxs("div",{className:"flex items-center gap-2 mb-4 text-sm text-muted-foreground flex-wrap",children:[n.jsx("span",{children:"Mostrando peas nos tamanhos"}),c.sizeLetter&&n.jsx("span",{className:"font-bold text-foreground bg-secondary px-2 py-0.5 rounded",children:c.sizeLetter}),c.sizeLetter&&c.sizeNumber&&n.jsx("span",{children:"e"}),c.sizeNumber&&n.jsx("span",{className:"font-bold text-foreground bg-secondary px-2 py-0.5 rounded",children:c.sizeNumber})]}),i.length>0?n.jsxs("div",{children:[n.jsx("h2",{className:"font-serif text-xl mb-4",children:"Peas que combinam com voc"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:i.map(g=>n.jsx(Gt,{to:`/produto/${g.id}`,children:n.jsx(_p,{name:g.name,price:g.price,imageUrl:g.image_url||void 0,sizes:g.sizes||[],badge:"Pra voc"})},g.id))})]}):c!=null&&c.sizeLetter||c!=null&&c.sizeNumber?n.jsx(De,{children:n.jsxs(Be,{className:"py-8 text-center",children:[n.jsx("p",{className:"text-muted-foreground",children:"Ainda no temos peas nos seus tamanhos no momento."}),n.jsx(Gt,{to:"/catalogo",className:"mt-4 inline-block",children:n.jsx(he,{variant:"outline",children:"Ver catlogo completo"})})]})}):null,n.jsxs(De,{className:"mt-8",children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"text-base flex items-center gap-2",children:[n.jsx(Rn,{className:"h-4 w-4 text-accent"}),"Mini-Quiz Semanal"]})}),n.jsxs(Be,{children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Responda mini-quizzes toda semana para ganhar mais pontos e melhorar suas sugestes!"}),n.jsxs(he,{variant:"outline",className:"gap-2",disabled:!0,children:[n.jsx(ki,{className:"h-4 w-4"}),"Em breve",n.jsx(Dn,{className:"h-4 w-4"})]})]})]})]})]})}function a5e(){const e=fr(),{user:t,isLoading:r}=Hn(),{favorites:s,toggleFavorite:a,isLoading:i}=MG(),[o,c]=P.useState([]),[d,l]=P.useState(!0);P.useEffect(()=>{!r&&!t&&e("/minha-conta")},[t,r,e]),P.useEffect(()=>{i||(async()=>{if(s.length===0){c([]),l(!1);return}try{const{data:f,error:m}=await ce.from("product_catalog").select("id, name, price, images, image_url, category, sizes, discount_type, discount_value").in("id",s).eq("is_active",!0);if(m)throw m;c(f||[])}catch(f){console.error("Error loading favorite products:",f)}finally{l(!1)}})()},[s,i]);const u=h=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(h);return r||d?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("main",{className:"container mx-auto px-4 py-12 flex items-center justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-6 max-w-6xl",children:[n.jsxs(he,{variant:"ghost",size:"sm",className:"mb-4",onClick:()=>e("/minha-conta"),children:[n.jsx(vs,{className:"h-4 w-4 mr-2"}),"Voltar"]}),n.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[n.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:n.jsx(El,{className:"h-6 w-6 text-red-500 fill-red-500"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"font-serif text-2xl",children:"Meus Favoritos"}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[o.length," ",o.length===1?"produto":"produtos"]})]})]}),o.length===0?n.jsxs("div",{className:"text-center py-16",children:[n.jsx(El,{className:"h-16 w-16 text-muted-foreground/30 mx-auto mb-4"}),n.jsx("h2",{className:"font-serif text-xl mb-2",children:"Nenhum favorito ainda"}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Explore nosso catlogo e salve seus produtos favoritos"}),n.jsx(Gt,{to:"/catalogo",children:n.jsxs(he,{children:[n.jsx(ln,{className:"h-4 w-4 mr-2"}),"Ver Catlogo"]})})]}):n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:o.map(h=>{var g;let f=h.price,m=!1;h.discount_type&&h.discount_value&&h.discount_value>0&&(m=!0,h.discount_type==="percentage"?f=h.price*(1-h.discount_value/100):f=Math.max(0,h.price-h.discount_value));const p=((g=h.images)==null?void 0:g[0])||h.image_url||"/placeholder.svg";return n.jsxs("div",{className:"card-product group relative",children:[n.jsx("button",{onClick:v=>{v.preventDefault(),a(h.id)},className:"absolute top-2 right-2 z-10 p-2 bg-white/90 rounded-full hover:bg-white transition-colors",children:n.jsx(El,{className:"h-4 w-4 text-red-500 fill-red-500"})}),n.jsxs(Gt,{to:`/produto/${h.id}`,children:[n.jsx("div",{className:"relative aspect-[3/4] overflow-hidden bg-secondary rounded-t-lg",children:n.jsx("img",{src:p,alt:h.name,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"})}),n.jsxs("div",{className:"p-3",children:[n.jsx("h3",{className:"font-medium text-sm line-clamp-2 mb-1",children:h.name}),h.sizes&&h.sizes.length>0&&n.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:["Tam: ",h.sizes.slice(0,4).join(", "),h.sizes.length>4?"...":""]}),n.jsx("div",{className:"flex flex-col",children:m?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"font-semibold text-green-600",children:u(f)}),n.jsx("span",{className:"text-xs text-muted-foreground line-through",children:u(h.price)})]}):n.jsx("span",{className:"font-semibold",children:u(h.price)})})]})]})]},h.id)})})]})]})}function tb(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const i5e=()=>{const[e]=kc(),t=fr(),r=e.get("order_id"),s=e.get("live_cart_id"),[a,i]=P.useState(!0),[o,c]=P.useState(null),[d,l]=P.useState(null),[u,h]=P.useState([]),[f,m]=P.useState(0);P.useEffect(()=>{r||s?p():i(!1)},[r,s]),P.useEffect(()=>{if((s||r)&&!o&&!d&&!a&&f<10){const T=setTimeout(()=>{m(O=>O+1),p()},3e3);return()=>clearTimeout(T)}},[s,r,o,d,a,f]);const p=async()=>{try{let T=null;if(r){const{data:O}=await ce.from("orders").select("*").eq("id",r).single();T=O}else if(s){const{data:O}=await ce.from("orders").select("*").eq("live_cart_id",s).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(T=O,!T){const{data:R}=await ce.from("live_carts").select("*").eq("id",s).single();R&&l(R)}}if(T){c(T);const{data:O}=await ce.from("order_items").select("*").eq("order_id",T.id);h(O||[])}}catch(T){console.error("Error loading order:",T)}finally{i(!1)}},g=(o==null?void 0:o.id)||r||s||"",v=(o==null?void 0:o.customer_name)||(d==null?void 0:d.customer_name)||"cliente",x=(o==null?void 0:o.total)||(d==null?void 0:d.total)||0,y=(o==null?void 0:o.shipping_fee)||(d==null?void 0:d.shipping_fee)||0,b=o||d,j=()=>`https://wa.me/5562991223519?text=${encodeURIComponent(`Oi! Sou ${v}. Acabei de fazer o pagamento do pedido #${g==null?void 0:g.slice(0,8).toUpperCase()}. Total: ${tb(x)}. Aguardo confirmao! `)}`;return a?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-primary"})}):b?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx("div",{className:"w-20 h-20 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center mx-auto mb-6 animate-fade-in",children:n.jsx(pn,{className:"h-10 w-10 text-green-600 dark:text-green-400"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pagamento confirmado! "}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Seu pedido foi pago com sucesso. Em breve voc receber atualizaes pelo WhatsApp."}),n.jsx(De,{className:"mb-6 text-left",children:n.jsxs(Be,{className:"p-6 space-y-4",children:[n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Pedido"}),n.jsxs("span",{className:"font-mono font-bold text-accent",children:["#",g.slice(0,8).toUpperCase()]})]}),u.length>0&&n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Itens"}),u.map(T=>n.jsxs("div",{className:"flex justify-between text-sm py-1",children:[n.jsxs("span",{children:[T.product_name," (",T.size,") x",T.quantity]}),n.jsx("span",{children:tb(T.product_price*T.quantity)})]},T.id))]}),y>0&&n.jsxs("div",{className:"flex justify-between text-sm border-t pt-2",children:[n.jsx("span",{children:"Frete"}),n.jsx("span",{children:tb(y)})]}),n.jsxs("div",{className:"flex justify-between font-medium text-lg border-t pt-2",children:[n.jsx("span",{children:"Total pago"}),n.jsx("span",{className:"text-green-600",children:tb(x)})]})]})}),n.jsxs("a",{href:j(),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full bg-[#25D366] hover:bg-[#20BD5A] text-white font-medium py-3 px-4 rounded-xl transition-colors mb-4",children:[n.jsx(nn,{className:"h-5 w-5"}),"Confirmar no WhatsApp"]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx(he,{variant:"outline",onClick:()=>t("/conta/meus-pedidos"),className:"flex-1",children:"Ver meus pedidos"}),n.jsx(he,{variant:"outline",onClick:()=>t("/"),className:"flex-1",children:"Voltar ao incio"})]})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx(Ut,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pedido no encontrado"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Seu pagamento pode estar sendo processado. Aguarde alguns segundos e atualize a pgina."}),n.jsxs("div",{className:"flex gap-2 justify-center",children:[n.jsx(he,{onClick:()=>window.location.reload(),variant:"outline",children:"Atualizar"}),n.jsx(he,{onClick:()=>t("/"),children:"Voltar ao incio"})]})]})]})};function dI(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const o5e=()=>{const[e]=kc(),t=fr(),r=e.get("order_id"),s=e.get("live_cart_id"),[a,i]=P.useState(!0),[o,c]=P.useState(null),[d,l]=P.useState(null),[u,h]=P.useState(0);P.useEffect(()=>{r||s?f():i(!1)},[r,s]),P.useEffect(()=>{if((s||r)&&!o&&!a&&u<10){const b=setTimeout(()=>{h(j=>j+1),f()},3e3);return()=>clearTimeout(b)}},[s,r,o,a,u]);const f=async()=>{try{let b=null;if(r){const{data:j}=await ce.from("orders").select("*").eq("id",r).single();b=j}else if(s){const{data:j}=await ce.from("orders").select("*").eq("live_cart_id",s).order("created_at",{ascending:!1}).limit(1).maybeSingle();if(b=j,!b){const{data:T}=await ce.from("live_carts").select("*").eq("id",s).single();if(T&&(l(T),T.status==="pago")){const{data:O}=await ce.from("orders").select("id").eq("live_cart_id",s).limit(1).maybeSingle();if(O){t(`/meus-pedidos/${O.id}`,{replace:!0});return}}}}if(b&&(c(b),b.status==="pago")){s?t(`/pedido/sucesso?live_cart_id=${s}`,{replace:!0}):t(`/pedido/sucesso?order_id=${b.id}`,{replace:!0});return}}catch(b){console.error("Error loading order:",b)}finally{i(!1)}},m=(o==null?void 0:o.id)||r||s||"",p=(o==null?void 0:o.customer_name)||(d==null?void 0:d.customer_name)||"cliente",g=(o==null?void 0:o.total)||(d==null?void 0:d.total)||0,v=o||d,x=()=>`https://wa.me/5562991223519?text=${encodeURIComponent(`Oi! Sou ${p}. Meu pagamento do pedido #${m==null?void 0:m.slice(0,8).toUpperCase()} est pendente. Pode me ajudar? `)}`,y=()=>{const b=(o==null?void 0:o.mp_checkout_url)||(d==null?void 0:d.mp_checkout_url);b&&window.open(b,"_blank")};return a?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-primary"})}):d&&d.status==="pago"?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx("div",{className:"w-20 h-20 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-6",children:n.jsx(pn,{className:"h-10 w-10 text-green-600"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pagamento confirmado! "}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Seu pedido foi pago com sucesso."}),n.jsx(De,{className:"mb-6",children:n.jsxs(Be,{className:"p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Pedido"}),n.jsxs("span",{className:"font-mono font-bold text-accent",children:["#",(s||"").slice(0,8).toUpperCase()]})]}),n.jsxs("div",{className:"flex justify-between font-medium text-lg border-t pt-4",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{className:"text-green-600",children:dI(g)})]})]})}),n.jsx(he,{onClick:()=>t("/conta/meus-pedidos"),className:"w-full",children:"Ver meus pedidos"})]})]}):v?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx("div",{className:"w-20 h-20 rounded-full bg-yellow-100 dark:bg-yellow-900/30 flex items-center justify-center mx-auto mb-6 animate-fade-in",children:n.jsx(Br,{className:"h-10 w-10 text-yellow-600 dark:text-yellow-400"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pagamento pendente"}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"Seu pagamento est sendo processado. Assim que for confirmado, voc receber uma notificao."}),n.jsx(De,{className:"mb-6",children:n.jsxs(Be,{className:"p-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Pedido"}),n.jsxs("span",{className:"font-mono font-bold text-accent",children:["#",m.slice(0,8).toUpperCase()]})]}),n.jsxs("div",{className:"flex justify-between font-medium text-lg border-t pt-4",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:dI(g)})]})]})}),((o==null?void 0:o.mp_checkout_url)||(d==null?void 0:d.mp_checkout_url))&&n.jsxs(he,{onClick:y,className:"w-full mb-4",children:[n.jsx(en,{className:"h-4 w-4 mr-2"}),"Tentar pagar novamente"]}),n.jsxs("a",{href:x(),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full border border-[#25D366] text-[#25D366] hover:bg-[#25D366]/10 font-medium py-3 px-4 rounded-xl transition-colors mb-4",children:[n.jsx(nn,{className:"h-5 w-5"}),"Falar no WhatsApp"]}),n.jsx(he,{variant:"outline",onClick:()=>t("/conta/meus-pedidos"),className:"w-full",children:"Ver meus pedidos"})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx(Ut,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pedido no encontrado"}),n.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Seu pagamento pode estar sendo processado. Aguarde alguns segundos e atualize a pgina."}),n.jsxs("div",{className:"flex gap-2 justify-center",children:[n.jsx(he,{onClick:()=>window.location.reload(),variant:"outline",children:"Atualizar"}),n.jsx(he,{onClick:()=>t("/"),children:"Voltar ao incio"})]})]})]})};function l5e(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}const c5e=()=>{const[e]=kc(),t=fr(),r=e.get("order_id"),s=e.get("live_cart_id"),[a,i]=P.useState(!0),[o,c]=P.useState(null),[d,l]=P.useState(null);P.useEffect(()=>{(async()=>{try{if(r){const{data:g}=await ce.from("orders").select("*").eq("id",r).single();g&&c(g)}if(s){const{data:g}=await ce.from("live_carts").select("id, total, mp_checkout_url, bag_number, status").eq("id",s).single();g&&l(g)}}catch(g){console.error("Error loading data:",g)}finally{i(!1)}})()},[r,s]);const u=(o==null?void 0:o.total)||(d==null?void 0:d.total)||0,h=(r==null?void 0:r.slice(0,8).toUpperCase())||(d!=null&&d.bag_number?`Sacola #${d.bag_number}`:s==null?void 0:s.slice(0,8).toUpperCase()),f=(o==null?void 0:o.mp_checkout_url)||(d==null?void 0:d.mp_checkout_url),m=()=>{const p=(o==null?void 0:o.customer_name)||"cliente";return`https://wa.me/5562991223519?text=${encodeURIComponent(`Oi! Sou ${p}. Tive um problema no pagamento do pedido ${h||"pedido"}. Pode me ajudar? `)}`};return a?n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-primary"})}):!r&&!s?n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx(Ut,{className:"h-16 w-16 mx-auto text-muted-foreground mb-4"}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pedido no encontrado"}),n.jsx(he,{onClick:()=>t("/"),children:"Voltar ao incio"})]})]}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsxs("main",{className:"container mx-auto px-4 py-12 max-w-lg text-center",children:[n.jsx("div",{className:"w-20 h-20 rounded-full bg-destructive/10 flex items-center justify-center mx-auto mb-6 animate-fade-in",children:n.jsx(qn,{className:"h-10 w-10 text-destructive"})}),n.jsx("h1",{className:"font-serif text-2xl mb-2",children:"Pagamento no aprovado"}),n.jsx("p",{className:"text-muted-foreground mb-6",children:"O Mercado Pago recusou o pagamento por motivos de segurana. Isso acontece s vezes  no se preocupe!"}),u>0&&n.jsx(De,{className:"mb-6",children:n.jsxs(Be,{className:"p-6",children:[h&&n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Pedido"}),n.jsxs("span",{className:"font-mono font-bold text-accent",children:["#",h]})]}),n.jsxs("div",{className:"flex justify-between font-medium text-lg border-t pt-4",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:l5e(u)})]})]})}),n.jsx(De,{className:"mb-6 border-amber-200 bg-amber-50/50 dark:bg-amber-950/20 dark:border-amber-800",children:n.jsxs(Be,{className:"p-5 text-left",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-3 text-amber-700 dark:text-amber-400",children:[n.jsx(Mr,{className:"h-5 w-5 flex-shrink-0"}),n.jsx("span",{className:"font-medium",children:"O que voc pode fazer:"})]}),n.jsxs("ul",{className:"space-y-2 text-sm text-amber-800 dark:text-amber-300",children:[n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"font-bold mt-0.5",children:"1."}),n.jsxs("span",{children:[n.jsx("strong",{children:"Tente pagar com PIX"}),"   mais rpido e raramente  recusado."]})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"font-bold mt-0.5",children:"2."}),n.jsx("span",{children:"Use outro carto de crdito ou dbito."})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"font-bold mt-0.5",children:"3."}),n.jsx("span",{children:"Verifique se os dados do carto esto corretos."})]}),n.jsxs("li",{className:"flex items-start gap-2",children:[n.jsx("span",{className:"font-bold mt-0.5",children:"4."}),n.jsx("span",{children:"Entre em contato com o banco se o problema persistir."})]})]})]})}),f&&n.jsxs(he,{onClick:()=>window.open(f,"_blank"),className:"w-full mb-3",size:"lg",children:[n.jsx(xs,{className:"h-4 w-4 mr-2"}),"Tentar pagar novamente (PIX/outro carto)"]}),n.jsxs("a",{href:m(),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 w-full bg-[#25D366] hover:bg-[#20BD5A] text-white font-medium py-3 px-4 rounded-xl transition-colors mb-3",children:[n.jsx(nn,{className:"h-5 w-5"}),"Pedir ajuda no WhatsApp"]}),n.jsx(he,{variant:"outline",onClick:()=>t("/"),className:"w-full",children:"Voltar ao incio"})]})]})};function uI({stockBySize:e,value:t,onChange:r,reserveAll:s,onReserveAllChange:a,disabled:i=!1}){const o=P.useMemo(()=>e?kp(Object.keys(e).filter(u=>(e[u]||0)>0)):[],[e]),c=P.useMemo(()=>e?Object.values(e).reduce((u,h)=>u+(h||0),0):0,[e]),d=P.useMemo(()=>Object.values(t).reduce((u,h)=>u+(h||0),0),[t]);P.useEffect(()=>{if(s&&e){const u={};Object.entries(e).forEach(([h,f])=>{f&&f>0&&(u[h]=f)}),r(u)}},[s,e]);const l=(u,h)=>{const f=(e==null?void 0:e[u])||0,m=Math.max(0,Math.min(h,f));r({...t,[u]:m}),s&&m!==f&&a(!1)};return o.length===0?n.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-lg text-muted-foreground",children:[n.jsx(Ut,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm",children:"Sem estoque disponvel"})]}):n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${s?"bg-primary/10 border-primary":"bg-background hover:bg-muted/50"}`,children:[n.jsx(va,{checked:s,onCheckedChange:u=>a(u===!0),disabled:i}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("span",{className:"font-medium text-sm flex items-center gap-2",children:[n.jsx(Yo,{className:"h-3.5 w-3.5"}),"Reservar todo o estoque para a live"]}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[c," unidades disponveis"]})]}),s&&n.jsx(Ae,{variant:"default",className:"bg-primary",children:"100% reservado"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx(Le,{className:"text-sm font-medium",children:"Quantidade por tamanho"}),n.jsxs(Ae,{variant:"outline",className:"text-xs",children:[d," de ",c]})]}),n.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-2",children:o.map(u=>{const h=(e==null?void 0:e[u])||0,f=t[u]||0;return n.jsxs("div",{className:`p-2 rounded-lg border text-center transition-colors ${f>0?"bg-primary/5 border-primary/30":"bg-background"}`,children:[n.jsx("div",{className:"font-medium text-sm mb-1",children:u}),n.jsxs("div",{className:"text-xs text-muted-foreground mb-2",children:["Disp: ",h]}),n.jsx(Qe,{type:"number",min:0,max:h,value:f||"",onChange:m=>l(u,parseInt(m.target.value)||0),disabled:i||s,className:"h-8 text-center text-sm",placeholder:"0"})]},u)})})]}),d>0&&!s&&n.jsxs("div",{className:"flex items-center justify-between p-2 bg-green-50 dark:bg-green-950/30 rounded-lg text-sm",children:[n.jsx("span",{className:"text-green-700 dark:text-green-400",children:"Total reservado para a live:"}),n.jsxs("span",{className:"font-bold text-green-700 dark:text-green-400",children:[d," unidades"]})]})]})}const g4={visibilidade:"catalogo_e_live",bloquear_desde_planejamento:!1,limite_unidades_live:null,live_discount_type:null,live_discount_value:null,stock_reservations:{},reserve_all:!0};function d5e(){const{eventId:e}=ra(),t=fr(),{event:r,products:s,kpis:a,isLoading:i,addProduct:o,removeProduct:c,fetchEvent:d}=nj(e),{updateEventStatus:l}=rj(),[u,h]=P.useState(!1),[f,m]=P.useState(""),[p,g]=P.useState([]),[v,x]=P.useState(new Map),[y,b]=P.useState(null),[j,T]=P.useState(g4),O=P.useRef(null);P.useEffect(()=>{},[u,y,j.live_discount_type,j.live_discount_value]);const[R,D]=P.useState(!1),[L,q]=P.useState(null),[X,H]=P.useState(g4),[M,F]=P.useState(!1);P.useEffect(()=>{(async()=>{const{data:Z,error:re}=await ce.from("product_catalog").select("id, name, image_url, images, price, color, stock_by_size, category, sku").eq("is_active",!0).order("name");if(re){console.error("[LivePlanning] Error fetching products:",re);return}const G=Z||[];g(G);const J=G.map(ie=>ie.id).filter(Boolean);if(J.length===0){x(new Map);return}const{data:V,error:W}=await ce.from("product_available_stock").select("product_id, size, available").in("product_id",J);if(W){console.error("[LivePlanning] Error fetching available stock:",W),x(new Map);return}const ee=new Map;(V||[]).forEach(ie=>{const oe=Number(ie.available||0);oe<=0||(ee.has(ie.product_id)||ee.set(ie.product_id,new Map),ee.get(ie.product_id).set(ie.size,oe))}),x(ee)})()},[]);const S=Y=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Y),E=Y=>Y?Object.values(Y).reduce((Z,re)=>Z+(re||0),0):0,N=async()=>{if(!y)return;await o(y.id,j)&&(h(!1),b(null),T(g4))},C=Y=>{var J;q(Y);const Z=Y.snapshot_variantes&&typeof Y.snapshot_variantes=="object"?Y.snapshot_variantes:{},re=Object.values(Z).reduce((V,W)=>V+(W||0),0),G=E(((J=Y.product)==null?void 0:J.stock_by_size)||null);H({visibilidade:Y.visibilidade,bloquear_desde_planejamento:Y.bloquear_desde_planejamento,limite_unidades_live:Y.limite_unidades_live,live_discount_type:Y.live_discount_type,live_discount_value:Y.live_discount_value,stock_reservations:Z,reserve_all:re===G&&G>0}),D(!0)},k=async()=>{if(!L)return;const Y=Object.values(X.stock_reservations).reduce((Z,re)=>Z+(re||0),0);F(!0);try{const{error:Z}=await ce.from("live_products").update({visibilidade:X.visibilidade,bloquear_desde_planejamento:X.bloquear_desde_planejamento,limite_unidades_live:Y>0?Y:X.limite_unidades_live,live_discount_type:X.live_discount_type,live_discount_value:X.live_discount_value,snapshot_variantes:X.stock_reservations}).eq("id",L.id);if(Z)throw Z;de.success("Produto atualizado!"),D(!1),q(null),d()}catch(Z){console.error("Error updating live product:",Z),de.error("Erro ao atualizar produto")}finally{F(!1)}},I=async()=>{if(!r)return;await l(r.id,"ao_vivo")&&t(`/dashboard/lives/${r.id}/backstage`)},U=new Set(s.map(Y=>Y.product_id)),$=p.filter(Y=>{var G,J;const Z=!f||Y.name.toLowerCase().includes(f.toLowerCase())||((G=Y.sku)==null?void 0:G.toLowerCase().includes(f.toLowerCase()))||((J=Y.category)==null?void 0:J.toLowerCase().includes(f.toLowerCase())),re=!U.has(Y.id);return Z&&re});return i||!r?n.jsxs("div",{className:"space-y-6",children:[n.jsx(Kr,{className:"h-10 w-48"}),n.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[n.jsx(Kr,{className:"h-24"}),n.jsx(Kr,{className:"h-24"}),n.jsx(Kr,{className:"h-24"})]}),n.jsx(Kr,{className:"h-96"})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>t("/dashboard?tab=lives"),children:n.jsx(vs,{className:"h-4 w-4"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"font-serif text-2xl font-semibold",children:r.titulo}),n.jsxs("p",{className:"text-muted-foreground text-sm flex items-center gap-1",children:[n.jsx(is,{className:"h-3.5 w-3.5"}),Ht(new Date(r.data_hora_inicio),"dd 'de' MMMM 's' HH:mm",{locale:gr})]})]})]}),n.jsxs(he,{className:"gap-2 bg-red-600 hover:bg-red-700",onClick:I,disabled:s.length===0,children:[n.jsx(ck,{className:"h-4 w-4"}),"Iniciar Live"]})]}),n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx(De,{children:n.jsxs(Be,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(Ut,{className:"h-4 w-4"}),"Produtos"]}),n.jsx("div",{className:"text-2xl font-semibold",children:s.length})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(ln,{className:"h-4 w-4"}),"Itens Planejados"]}),n.jsx("div",{className:"text-2xl font-semibold",children:a.totalPlanejado.itens})]})}),n.jsx(De,{className:"col-span-2",children:n.jsxs(Be,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(ws,{className:"h-4 w-4"}),"Valor Planejado"]}),n.jsx("div",{className:"text-2xl font-semibold",children:S(a.totalPlanejado.valor)})]})})]}),n.jsxs(De,{children:[n.jsxs(Ot,{className:"flex flex-row items-center justify-between",children:[n.jsx(Mt,{children:"Produtos da Live"}),n.jsxs(he,{onClick:()=>h(!0),className:"gap-2",children:[n.jsx(An,{className:"h-4 w-4"}),"Adicionar Produto"]})]}),n.jsx(Be,{children:s.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(Ut,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhum produto adicionado ainda"}),n.jsx("p",{className:"text-sm",children:"Adicione produtos para planejar sua live"})]}):n.jsx("div",{className:"space-y-3",children:s.map((Y,Z)=>{const re=Y.product;if(!re)return null;const G=re.available_by_size,J=G?Object.values(G).reduce((V,W)=>V+(W||0),0):0;return n.jsxs("div",{className:"flex items-center gap-4 p-3 border rounded-lg bg-card hover:bg-muted/30 transition-colors",children:[n.jsx("div",{className:"cursor-grab text-muted-foreground hover:text-foreground",children:n.jsx(nk,{className:"h-5 w-5"})}),n.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-sm font-medium",children:Z+1}),n.jsx("div",{className:"w-16 h-16 bg-secondary rounded-lg overflow-hidden shrink-0",children:re.image_url?n.jsx("img",{src:re.image_url,alt:re.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-6 w-6 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium truncate",children:re.name}),n.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2 flex-wrap",children:[re.color&&n.jsx("span",{className:"bg-secondary px-2 py-0.5 rounded text-xs",children:re.color}),Y.live_discount_type&&Y.live_discount_value?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-green-600 font-medium",children:S(Y.live_discount_type==="percentage"?re.price*(1-Y.live_discount_value/100):Math.max(0,re.price-Y.live_discount_value))}),n.jsx("span",{className:"line-through opacity-50",children:S(re.price)})]}):n.jsx("span",{children:S(re.price)}),n.jsx("span",{children:""}),n.jsxs("span",{children:[J," unid."]})]})]}),n.jsx(Ae,{variant:Y.visibilidade==="exclusivo_live"?"default":"outline",className:"shrink-0 gap-1",children:Y.visibilidade==="exclusivo_live"?n.jsxs(n.Fragment,{children:[n.jsx(dc,{className:"h-3 w-3"}),"Exclusivo"]}):n.jsxs(n.Fragment,{children:[n.jsx(ci,{className:"h-3 w-3"}),"Catlogo + Live"]})}),Y.bloquear_desde_planejamento&&n.jsxs(Ae,{variant:"secondary",className:"shrink-0 gap-1",children:[n.jsx(Yo,{className:"h-3 w-3"}),"Bloqueado"]}),n.jsx(he,{variant:"ghost",size:"icon",className:"shrink-0",onClick:()=>C(Y),children:n.jsx(ea,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive shrink-0",onClick:()=>c(Y.id),children:n.jsx(mi,{className:"h-4 w-4"})})]},Y.id)})})})]}),n.jsx(cn,{open:u,onOpenChange:h,children:n.jsxs(sn,{className:"p-0 w-[min(920px,95vw)] max-h-[85vh] !flex !flex-col overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b shrink-0",children:n.jsxs(fn,{className:"p-0 m-0",children:[n.jsx(dn,{children:"Adicionar Produto  Live"}),n.jsx(Zo,{children:"Selecione um produto e configure as opes para a live"})]})}),n.jsx("div",{ref:O,className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto",children:y?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-muted/30 rounded-lg",children:[n.jsx("div",{className:"w-16 h-16 bg-secondary rounded overflow-hidden shrink-0",children:y.image_url?n.jsx("img",{src:y.image_url,alt:y.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-6 w-6 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium",children:y.name}),n.jsx("div",{className:"text-sm text-muted-foreground",children:(()=>{const Y=v.get(y.id),Z=Y?Array.from(Y.values()).reduce((re,G)=>re+(G||0),0):0;return n.jsxs(n.Fragment,{children:[S(y.price),"  ",Z," unid."]})})()})]}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>b(null),children:"Trocar"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Visibilidade"}),n.jsxs(Kt,{value:j.visibilidade,onValueChange:Y=>T(Z=>({...Z,visibilidade:Y})),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"catalogo_e_live",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ci,{className:"h-4 w-4"}),"Catlogo + Live"]})}),n.jsx(ze,{value:"exclusivo_live",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dc,{className:"h-4 w-4"}),"Exclusivo da Live"]})})]})]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:j.visibilidade==="exclusivo_live"?"O produto ficar oculto no catlogo durante a live":"O produto continuar visvel no catlogo, mas respeitar reservas"})]}),j.visibilidade==="exclusivo_live"&&n.jsxs("div",{className:"flex items-center justify-between py-2",children:[n.jsxs("div",{children:[n.jsx(Le,{children:"Bloquear desde o planejamento"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Oculta o produto do catlogo antes mesmo de iniciar a live"})]}),n.jsx(di,{checked:j.bloquear_desde_planejamento,onCheckedChange:Y=>T(Z=>({...Z,bloquear_desde_planejamento:Y}))})]}),n.jsxs("div",{className:"space-y-2 border-t pt-4",children:[n.jsx(Le,{className:"font-medium",children:"Reserva de estoque por tamanho"}),n.jsx(uI,{stockBySize:y.stock_by_size,value:j.stock_reservations,onChange:Y=>T(Z=>({...Z,stock_reservations:Y})),reserveAll:j.reserve_all,onReserveAllChange:Y=>T(Z=>({...Z,reserve_all:Y}))})]}),n.jsxs("div",{className:"space-y-3 border-t pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Oa,{className:"h-4 w-4 text-primary"}),n.jsx(Le,{className:"font-medium",children:"Desconto exclusivo da Live"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Tipo de desconto"}),n.jsxs(Kt,{value:j.live_discount_type||"_none",onValueChange:Y=>T(Z=>({...Z,live_discount_type:Y==="_none"?null:Y,live_discount_value:Y==="_none"?null:Z.live_discount_value})),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Sem desconto"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"_none",children:"Sem desconto"}),n.jsx(ze,{value:"percentage",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(jo,{className:"h-3.5 w-3.5"}),"Porcentagem"]})}),n.jsx(ze,{value:"fixed",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(ws,{className:"h-3.5 w-3.5"}),"Valor fixo"]})})]})]})]}),j.live_discount_type&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:j.live_discount_type==="percentage"?"Desconto (%)":"Desconto (R$)"}),n.jsx(Qe,{type:"number",min:0,max:j.live_discount_type==="percentage"?100:void 0,step:j.live_discount_type==="percentage"?1:.01,placeholder:j.live_discount_type==="percentage"?"Ex: 10":"Ex: 15.00",value:j.live_discount_value||"",onChange:Y=>T(Z=>({...Z,live_discount_value:Y.target.value?parseFloat(Y.target.value):null}))})]})]}),j.live_discount_type&&j.live_discount_value&&n.jsx("div",{className:"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800 rounded-lg p-3",children:n.jsxs("p",{className:"text-sm text-green-700 dark:text-green-400",children:["Preo na live:"," ",n.jsx("span",{className:"font-bold",children:S(j.live_discount_type==="percentage"?y.price*(1-j.live_discount_value/100):Math.max(0,y.price-j.live_discount_value))}),n.jsx("span",{className:"text-xs ml-2 line-through opacity-70",children:S(y.price)})]})})]})]})]}):n.jsxs("div",{children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar por nome, SKU ou categoria...",value:f,onChange:Y=>m(Y.target.value),className:"pl-10"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[$.map(Y=>{const Z=v.get(Y.id),re=Z?Array.from(Z.values()).reduce((G,J)=>G+(J||0),0):0;return n.jsxs("button",{className:"flex items-center gap-3 p-3 border rounded-lg text-left hover:bg-muted/50 transition-colors",onClick:()=>b(Y),children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:Y.image_url?n.jsx("img",{src:Y.image_url,alt:Y.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:Y.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[S(Y.price),"  ",re," unid."]})]})]},Y.id)}),$.length===0&&n.jsx("div",{className:"col-span-2 text-center py-8 text-muted-foreground",children:"Nenhum produto encontrado"})]})]})}),n.jsxs("div",{className:"px-6 py-4 border-t shrink-0 flex justify-end gap-2",children:[n.jsx(he,{variant:"outline",onClick:()=>{h(!1),b(null)},children:"Cancelar"}),y&&n.jsxs(he,{onClick:N,className:"gap-2",children:[n.jsx(An,{className:"h-4 w-4"}),"Adicionar  Live"]})]})]})}),n.jsx(cn,{open:R,onOpenChange:D,children:n.jsxs(sn,{className:"p-0 w-[min(600px,95vw)] max-h-[85vh] !flex !flex-col overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b shrink-0",children:n.jsxs(fn,{className:"p-0 m-0 space-y-1",children:[n.jsx(dn,{children:"Editar Produto na Live"}),n.jsx(Zo,{children:"Altere as configuraes de reserva e desconto"})]})}),L&&L.product&&n.jsx("div",{className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto",children:n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-4 p-4 bg-muted/30 rounded-lg",children:[n.jsx("div",{className:"w-16 h-16 bg-secondary rounded overflow-hidden shrink-0",children:L.product.image_url?n.jsx("img",{src:L.product.image_url,alt:L.product.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-6 w-6 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium",children:L.product.name}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:[S(L.product.price),"  ",E(L.product.stock_by_size)," unid."]})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Visibilidade"}),n.jsxs(Kt,{value:X.visibilidade,onValueChange:Y=>H(Z=>({...Z,visibilidade:Y})),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"catalogo_e_live",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ci,{className:"h-4 w-4"}),"Catlogo + Live"]})}),n.jsx(ze,{value:"exclusivo_live",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dc,{className:"h-4 w-4"}),"Exclusivo da Live"]})})]})]})]}),X.visibilidade==="exclusivo_live"&&n.jsxs("div",{className:"flex items-center justify-between py-2",children:[n.jsxs("div",{children:[n.jsx(Le,{children:"Bloquear desde o planejamento"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Oculta o produto do catlogo antes da live"})]}),n.jsx(di,{checked:X.bloquear_desde_planejamento,onCheckedChange:Y=>H(Z=>({...Z,bloquear_desde_planejamento:Y}))})]}),n.jsxs("div",{className:"space-y-2 border-t pt-4",children:[n.jsx(Le,{className:"font-medium",children:"Reserva de estoque por tamanho"}),n.jsx(uI,{stockBySize:L.product.stock_by_size,value:X.stock_reservations,onChange:Y=>H(Z=>({...Z,stock_reservations:Y})),reserveAll:X.reserve_all,onReserveAllChange:Y=>H(Z=>({...Z,reserve_all:Y}))})]}),n.jsxs("div",{className:"space-y-3 border-t pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Oa,{className:"h-4 w-4 text-primary"}),n.jsx(Le,{className:"font-medium",children:"Desconto exclusivo da Live"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Tipo de desconto"}),n.jsxs(Kt,{value:X.live_discount_type||"_none",onValueChange:Y=>H(Z=>({...Z,live_discount_type:Y==="_none"?null:Y,live_discount_value:Y==="_none"?null:Z.live_discount_value})),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Sem desconto"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"_none",children:"Sem desconto"}),n.jsx(ze,{value:"percentage",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(jo,{className:"h-3.5 w-3.5"}),"Porcentagem"]})}),n.jsx(ze,{value:"fixed",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(ws,{className:"h-3.5 w-3.5"}),"Valor fixo"]})})]})]})]}),X.live_discount_type&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:X.live_discount_type==="percentage"?"Desconto (%)":"Desconto (R$)"}),n.jsx(Qe,{type:"number",min:0,max:X.live_discount_type==="percentage"?100:void 0,step:X.live_discount_type==="percentage"?1:.01,placeholder:X.live_discount_type==="percentage"?"Ex: 10":"Ex: 15.00",value:X.live_discount_value||"",onChange:Y=>H(Z=>({...Z,live_discount_value:Y.target.value?parseFloat(Y.target.value):null}))})]})]}),X.live_discount_type&&X.live_discount_value&&n.jsx("div",{className:"bg-green-50 dark:bg-green-950/30 border border-green-200 dark:border-green-800 rounded-lg p-3",children:n.jsxs("p",{className:"text-sm text-green-700 dark:text-green-400",children:["Preo na live:"," ",n.jsx("span",{className:"font-bold",children:S(X.live_discount_type==="percentage"?L.product.price*(1-X.live_discount_value/100):Math.max(0,L.product.price-X.live_discount_value))}),n.jsx("span",{className:"text-xs ml-2 line-through opacity-70",children:S(L.product.price)})]})})]})]})]})}),n.jsxs("div",{className:"px-6 py-4 border-t shrink-0 flex justify-end gap-2",children:[n.jsx(he,{variant:"outline",onClick:()=>{D(!1),q(null)},children:"Cancelar"}),n.jsx(he,{onClick:k,disabled:M,children:M?"Salvando...":"Salvar Alteraes"})]})]})})]})}function u5e(){const e=fr();ra();const[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await ce.auth.getSession();if(!a){e("/login");return}const{data:i}=await ce.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(c=>["merchant","admin"].includes(c.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx(Cr,{}),n.jsx("main",{className:"container mx-auto px-4 py-8",children:n.jsx(d5e,{})})]})}function h5e(e,t){return P.useReducer((r,s)=>t[r][s]??r,e)}var bA="ScrollArea",[MY,_et]=ta(bA),[f5e,rl]=MY(bA),IY=P.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:s="hover",dir:a,scrollHideDelay:i=600,...o}=e,[c,d]=P.useState(null),[l,u]=P.useState(null),[h,f]=P.useState(null),[m,p]=P.useState(null),[g,v]=P.useState(null),[x,y]=P.useState(0),[b,j]=P.useState(0),[T,O]=P.useState(!1),[R,D]=P.useState(!1),L=Ir(t,X=>d(X)),q=Cg(a);return n.jsx(f5e,{scope:r,type:s,dir:q,scrollHideDelay:i,scrollArea:c,viewport:l,onViewportChange:u,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:p,scrollbarXEnabled:T,onScrollbarXEnabledChange:O,scrollbarY:g,onScrollbarYChange:v,scrollbarYEnabled:R,onScrollbarYEnabledChange:D,onCornerWidthChange:y,onCornerHeightChange:j,children:n.jsx(er.div,{dir:q,...o,ref:L,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":b+"px",...e.style}})})});IY.displayName=bA;var DY="ScrollAreaViewport",LY=P.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:s,nonce:a,...i}=e,o=rl(DY,r),c=P.useRef(null),d=Ir(t,c,o.onViewportChange);return n.jsxs(n.Fragment,{children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),n.jsx(er.div,{"data-radix-scroll-area-viewport":"",...i,ref:d,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:n.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});LY.displayName=DY;var Rc="ScrollAreaScrollbar",wA=P.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=rl(Rc,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,c=e.orientation==="horizontal";return P.useEffect(()=>(c?i(!0):o(!0),()=>{c?i(!1):o(!1)}),[c,i,o]),a.type==="hover"?n.jsx(m5e,{...s,ref:t,forceMount:r}):a.type==="scroll"?n.jsx(p5e,{...s,ref:t,forceMount:r}):a.type==="auto"?n.jsx(BY,{...s,ref:t,forceMount:r}):a.type==="always"?n.jsx(_A,{...s,ref:t}):null});wA.displayName=Rc;var m5e=P.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=rl(Rc,e.__scopeScrollArea),[i,o]=P.useState(!1);return P.useEffect(()=>{const c=a.scrollArea;let d=0;if(c){const l=()=>{window.clearTimeout(d),o(!0)},u=()=>{d=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return c.addEventListener("pointerenter",l),c.addEventListener("pointerleave",u),()=>{window.clearTimeout(d),c.removeEventListener("pointerenter",l),c.removeEventListener("pointerleave",u)}}},[a.scrollArea,a.scrollHideDelay]),n.jsx(Gs,{present:r||i,children:n.jsx(BY,{"data-state":i?"visible":"hidden",...s,ref:t})})}),p5e=P.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=rl(Rc,e.__scopeScrollArea),i=e.orientation==="horizontal",o=xj(()=>d("SCROLL_END"),100),[c,d]=h5e("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return P.useEffect(()=>{if(c==="idle"){const l=window.setTimeout(()=>d("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(l)}},[c,a.scrollHideDelay,d]),P.useEffect(()=>{const l=a.viewport,u=i?"scrollLeft":"scrollTop";if(l){let h=l[u];const f=()=>{const m=l[u];h!==m&&(d("SCROLL"),o()),h=m};return l.addEventListener("scroll",f),()=>l.removeEventListener("scroll",f)}},[a.viewport,i,d,o]),n.jsx(Gs,{present:r||c!=="hidden",children:n.jsx(_A,{"data-state":c==="hidden"?"hidden":"visible",...s,ref:t,onPointerEnter:kt(e.onPointerEnter,()=>d("POINTER_ENTER")),onPointerLeave:kt(e.onPointerLeave,()=>d("POINTER_LEAVE"))})})}),BY=P.forwardRef((e,t)=>{const r=rl(Rc,e.__scopeScrollArea),{forceMount:s,...a}=e,[i,o]=P.useState(!1),c=e.orientation==="horizontal",d=xj(()=>{if(r.viewport){const l=r.viewport.offsetWidth<r.viewport.scrollWidth,u=r.viewport.offsetHeight<r.viewport.scrollHeight;o(c?l:u)}},10);return Mp(r.viewport,d),Mp(r.content,d),n.jsx(Gs,{present:s||i,children:n.jsx(_A,{"data-state":i?"visible":"hidden",...a,ref:t})})}),_A=P.forwardRef((e,t)=>{const{orientation:r="vertical",...s}=e,a=rl(Rc,e.__scopeScrollArea),i=P.useRef(null),o=P.useRef(0),[c,d]=P.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),l=VY(c.viewport,c.content),u={...s,sizes:c,onSizesChange:d,hasThumb:l>0&&l<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return w5e(f,o.current,c,m)}return r==="horizontal"?n.jsx(g5e,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const f=a.viewport.scrollLeft,m=hI(f,c,a.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{a.viewport&&(a.viewport.scrollLeft=f)},onDragScroll:f=>{a.viewport&&(a.viewport.scrollLeft=h(f,a.dir))}}):r==="vertical"?n.jsx(x5e,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&i.current){const f=a.viewport.scrollTop,m=hI(f,c);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{a.viewport&&(a.viewport.scrollTop=f)},onDragScroll:f=>{a.viewport&&(a.viewport.scrollTop=h(f))}}):null}),g5e=P.forwardRef((e,t)=>{const{sizes:r,onSizesChange:s,...a}=e,i=rl(Rc,e.__scopeScrollArea),[o,c]=P.useState(),d=P.useRef(null),l=Ir(t,d,i.onScrollbarXChange);return P.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),n.jsx(FY,{"data-orientation":"horizontal",...a,ref:l,sizes:r,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":gj(r)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(f),WY(f,h)&&u.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&s({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:Jw(o.paddingLeft),paddingEnd:Jw(o.paddingRight)}})}})}),x5e=P.forwardRef((e,t)=>{const{sizes:r,onSizesChange:s,...a}=e,i=rl(Rc,e.__scopeScrollArea),[o,c]=P.useState(),d=P.useRef(null),l=Ir(t,d,i.onScrollbarYChange);return P.useEffect(()=>{d.current&&c(getComputedStyle(d.current))},[d]),n.jsx(FY,{"data-orientation":"vertical",...a,ref:l,sizes:r,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":gj(r)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,h)=>{if(i.viewport){const f=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(f),WY(f,h)&&u.preventDefault()}},onResize:()=>{d.current&&i.viewport&&o&&s({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:Jw(o.paddingTop),paddingEnd:Jw(o.paddingBottom)}})}})}),[v5e,$Y]=MY(Rc),FY=P.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:s,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:c,onThumbPositionChange:d,onDragScroll:l,onWheelScroll:u,onResize:h,...f}=e,m=rl(Rc,r),[p,g]=P.useState(null),v=Ir(t,L=>g(L)),x=P.useRef(null),y=P.useRef(""),b=m.viewport,j=s.content-s.viewport,T=Ws(u),O=Ws(d),R=xj(h,10);function D(L){if(x.current){const q=L.clientX-x.current.left,X=L.clientY-x.current.top;l({x:q,y:X})}}return P.useEffect(()=>{const L=q=>{const X=q.target;(p==null?void 0:p.contains(X))&&T(q,j)};return document.addEventListener("wheel",L,{passive:!1}),()=>document.removeEventListener("wheel",L,{passive:!1})},[b,p,j,T]),P.useEffect(O,[s,O]),Mp(p,R),Mp(m.content,R),n.jsx(v5e,{scope:r,scrollbar:p,hasThumb:a,onThumbChange:Ws(i),onThumbPointerUp:Ws(o),onThumbPositionChange:O,onThumbPointerDown:Ws(c),children:n.jsx(er.div,{...f,ref:v,style:{position:"absolute",...f.style},onPointerDown:kt(e.onPointerDown,L=>{L.button===0&&(L.target.setPointerCapture(L.pointerId),x.current=p.getBoundingClientRect(),y.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),D(L))}),onPointerMove:kt(e.onPointerMove,D),onPointerUp:kt(e.onPointerUp,L=>{const q=L.target;q.hasPointerCapture(L.pointerId)&&q.releasePointerCapture(L.pointerId),document.body.style.webkitUserSelect=y.current,m.viewport&&(m.viewport.style.scrollBehavior=""),x.current=null})})})}),Qw="ScrollAreaThumb",zY=P.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=$Y(Qw,e.__scopeScrollArea);return n.jsx(Gs,{present:r||a.hasThumb,children:n.jsx(y5e,{ref:t,...s})})}),y5e=P.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:s,...a}=e,i=rl(Qw,r),o=$Y(Qw,r),{onThumbPositionChange:c}=o,d=Ir(t,h=>o.onThumbChange(h)),l=P.useRef(void 0),u=xj(()=>{l.current&&(l.current(),l.current=void 0)},100);return P.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(u(),!l.current){const m=_5e(h,c);l.current=m,c()}};return c(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,u,c]),n.jsx(er.div,{"data-state":o.hasThumb?"visible":"hidden",...a,ref:d,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:kt(e.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),p=h.clientX-m.left,g=h.clientY-m.top;o.onThumbPointerDown({x:p,y:g})}),onPointerUp:kt(e.onPointerUp,o.onThumbPointerUp)})});zY.displayName=Qw;var jA="ScrollAreaCorner",UY=P.forwardRef((e,t)=>{const r=rl(jA,e.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&s?n.jsx(b5e,{...e,ref:t}):null});UY.displayName=jA;var b5e=P.forwardRef((e,t)=>{const{__scopeScrollArea:r,...s}=e,a=rl(jA,r),[i,o]=P.useState(0),[c,d]=P.useState(0),l=!!(i&&c);return Mp(a.scrollbarX,()=>{var h;const u=((h=a.scrollbarX)==null?void 0:h.offsetHeight)||0;a.onCornerHeightChange(u),d(u)}),Mp(a.scrollbarY,()=>{var h;const u=((h=a.scrollbarY)==null?void 0:h.offsetWidth)||0;a.onCornerWidthChange(u),o(u)}),l?n.jsx(er.div,{...s,ref:t,style:{width:i,height:c,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function Jw(e){return e?parseInt(e,10):0}function VY(e,t){const r=e/t;return isNaN(r)?0:r}function gj(e){const t=VY(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=(e.scrollbar.size-r)*t;return Math.max(s,18)}function w5e(e,t,r,s="ltr"){const a=gj(r),i=a/2,o=t||i,c=a-o,d=r.scrollbar.paddingStart+o,l=r.scrollbar.size-r.scrollbar.paddingEnd-c,u=r.content-r.viewport,h=s==="ltr"?[0,u]:[u*-1,0];return qY([d,l],h)(e)}function hI(e,t,r="ltr"){const s=gj(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-a,o=t.content-t.viewport,c=i-s,d=r==="ltr"?[0,o]:[o*-1,0],l=RC(e,d);return qY([0,o],[0,c])(l)}function qY(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(r-e[0])}}function WY(e,t){return e>0&&e<t}var _5e=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},s=0;return function a(){const i={left:e.scrollLeft,top:e.scrollTop},o=r.left!==i.left,c=r.top!==i.top;(o||c)&&t(),r=i,s=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(s)};function xj(e,t){const r=Ws(e),s=P.useRef(0);return P.useEffect(()=>()=>window.clearTimeout(s.current),[]),P.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,t)},[r,t])}function Mp(e,t){const r=Ws(t);ya(()=>{let s=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(s),a.unobserve(e)}}},[e,r])}var HY=IY,j5e=LY,N5e=UY;const bi=P.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(HY,{ref:s,className:We("relative overflow-hidden",e),...r,children:[n.jsx(j5e,{className:"h-full w-full rounded-[inherit]",children:t}),n.jsx(GY,{}),n.jsx(N5e,{})]}));bi.displayName=HY.displayName;const GY=P.forwardRef(({className:e,orientation:t="vertical",...r},s)=>n.jsx(wA,{ref:s,orientation:t,className:We("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:n.jsx(zY,{className:"relative flex-1 rounded-full bg-border"})}));GY.displayName=wA.displayName;function S5e(e,t=!1){const[r,s]=P.useState([]),[a,i]=P.useState([]),[o,c]=P.useState([]),[d,l]=P.useState(!0),u=P.useRef(!0),h=P.useRef([]),f=P.useRef(t);f.current=t;const m=P.useCallback(async()=>{if(e){l(!0);try{const{data:C,error:k}=await ce.from("live_customers").select("*").eq("live_event_id",e).order("created_at",{ascending:!1});if(k)throw k;u.current&&s(C||[]);const{data:I,error:U}=await ce.from("live_carts").select(`
          *,
          live_customer:live_customers(*),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color)
          )
        `).eq("live_event_id",e).order("created_at",{ascending:!1});if(U)throw U;u.current&&i(I||[]);const{data:$,error:Y}=await ce.from("live_waitlist").select("*").eq("live_event_id",e).order("ordem");if(Y)throw Y;u.current&&c($||[])}catch(C){console.error("Error fetching backstage data:",C),u.current&&de.error("Erro ao carregar dados do backstage")}finally{u.current&&l(!1)}}},[e]);P.useEffect(()=>(u.current=!0,m(),()=>{u.current=!1}),[m]),P.useEffect(()=>{if(!e)return;h.current.forEach(re=>{ce.removeChannel(re)}),h.current=[];const C=()=>{u.current&&!f.current&&m()},k=()=>{try{const re=new(window.AudioContext||window.webkitAudioContext),G=(J,V,W,ee)=>{const ie=re.createOscillator(),oe=re.createGain();ie.connect(oe),oe.connect(re.destination),ie.frequency.setValueAtTime(J,re.currentTime+V),ie.type="sine",oe.gain.setValueAtTime(0,re.currentTime+V),oe.gain.linearRampToValueAtTime(ee,re.currentTime+V+.01),oe.gain.exponentialRampToValueAtTime(.01,re.currentTime+V+W),ie.start(re.currentTime+V),ie.stop(re.currentTime+V+W)};G(523.25,0,.15,.3),G(659.25,.1,.15,.3),G(783.99,.2,.25,.4),G(1046.5,.35,.4,.5)}catch(re){console.log("Could not play notification sound:",re)}},I=re=>{var G,J;u.current&&(re.eventType==="UPDATE"&&((G=re.new)==null?void 0:G.status)==="pago"&&((J=re.old)==null?void 0:J.status)!=="pago"&&(k(),ce.from("live_customers").select("instagram_handle, nome").eq("id",re.new.live_customer_id).single().then(({data:V})=>{const W=(V==null?void 0:V.nome)||(V==null?void 0:V.instagram_handle)||"Cliente",ee=re.new.total||0,ie=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(ee);f.current||de.success(` Pagamento Confirmado!
${W} pagou ${ie}`,{duration:8e3,icon:"",style:{background:"#22c55e",color:"white",fontWeight:"bold"}})})),f.current||m())},U=ce.channel(`live_carts_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_carts",filter:`live_event_id=eq.${e}`},I).subscribe(),$=ce.channel(`live_cart_items_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_cart_items"},C).subscribe(),Y=ce.channel(`live_customers_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_customers",filter:`live_event_id=eq.${e}`},C).subscribe(),Z=ce.channel(`live_waitlist_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_waitlist",filter:`live_event_id=eq.${e}`},C).subscribe();return h.current=[U,$,Y,Z],()=>{h.current.forEach(re=>{ce.removeChannel(re)}),h.current=[]}},[e,m]);const p=async C=>{if(!e)return null;const k=C.replace(/@/g,"").replace(/\s/g,"").toLowerCase().trim();if(!k)return de.error("Instagram invlido"),null;try{const I=r.find(Z=>Z.instagram_handle.toLowerCase().replace(/@/g,"").trim()===k);if(I&&(!I.nome||!I.client_id)){const{data:Z}=await ce.from("customers").select("id, name, phone, email").or(`instagram_handle.ilike.${k},instagram_handle.ilike.@${k}`).is("merged_into_customer_id",null).maybeSingle();if(Z){const{data:re}=await ce.from("live_customers").update({client_id:Z.id,nome:Z.name,whatsapp:Z.phone}).eq("id",I.id).select().single();if(re)return m(),re}}if(I)return I;let{data:U}=await ce.from("customers").select("id, name, phone, email, instagram_handle").or(`instagram_handle.ilike.${k},instagram_handle.ilike.@${k}`).is("merged_into_customer_id",null).maybeSingle();if(!U){const{data:Z}=await ce.from("instagram_identities").select("customer_id").ilike("instagram_handle_normalized",k).maybeSingle();if(Z!=null&&Z.customer_id){const{data:re}=await ce.from("customers").select("id, name, phone, email, instagram_handle").eq("id",Z.customer_id).is("merged_into_customer_id",null).maybeSingle();re&&(U=re)}}if(!U){const{data:Z}=await ce.from("live_customers").select("client_id").ilike("instagram_handle",k).not("client_id","is",null).limit(1).maybeSingle();if(Z!=null&&Z.client_id){const{data:re}=await ce.from("customers").select("id, name, phone, email, instagram_handle").eq("id",Z.client_id).is("merged_into_customer_id",null).maybeSingle();re&&(U=re)}}const{data:$,error:Y}=await ce.from("live_customers").insert({live_event_id:e,instagram_handle:k,status:"ativo",client_id:(U==null?void 0:U.id)||null,nome:(U==null?void 0:U.name)||null,whatsapp:(U==null?void 0:U.phone)||null}).select().single();if(Y){if(Y.code==="23505")return await m(),r.find(Z=>Z.instagram_handle.toLowerCase().replace(/@/g,"").trim()===k)||null;throw Y}return U&&de.success(`Cliente ${U.name||`@${k}`} identificado no CRM!`),await m(),$}catch(I){return console.error("Error getting/creating customer:",I),de.error("Erro ao buscar/criar cliente"),null}},g=async C=>{var U;if(!e)return null;const{data:k}=await ce.from("live_events").select("status").eq("id",e).single(),I=(k==null?void 0:k.status)==="encerrada"||(k==null?void 0:k.status)==="arquivada";try{const{data:$}=await ce.from("live_carts").select(`
          *,
          live_customer:live_customers(*),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color)
          )
        `).eq("live_event_id",e).eq("live_customer_id",C).maybeSingle();if($){if($.status==="cancelado"||$.status==="expirado"){const{data:J,error:V}=await ce.from("live_carts").update({status:"aguardando_pagamento",separation_status:"pendente"}).eq("id",$.id).select(`
              *,
              live_customer:live_customers(*),
              items:live_cart_items(
                *,
                product:product_catalog(id, name, image_url, color)
              )
            `).single();if(V)return console.error("Error reactivating cart:",V),$;{const W=((U=$.live_customer)==null?void 0:U.instagram_handle)||"cliente";return de.info(`Carrinho de ${W} reativado!`),m(),J}}return $}if(I)return de.error("Live encerrada! No  possvel criar novos carrinhos."),null;const{data:Y}=await ce.from("live_customers").select("client_id").eq("id",C).single();let Z=null;if(Y!=null&&Y.client_id){const{data:J}=await ce.from("customers").select("user_id").eq("id",Y.client_id).maybeSingle();Z=(J==null?void 0:J.user_id)||null}const{data:re,error:G}=await ce.from("live_carts").insert({live_event_id:e,live_customer_id:C,user_id:Z,status:"aberto",subtotal:0,descontos:0,frete:0,total:0}).select().single();if(G)throw G;return await m(),re}catch($){return console.error("Error getting/creating cart:",$),de.error("Erro ao buscar/criar carrinho"),null}},v=async C=>{if(!e)return!1;const{data:k}=await ce.from("live_events").select("status").eq("id",e).single();if((k==null?void 0:k.status)==="encerrada"||(k==null?void 0:k.status)==="arquivada")return de.error("Live encerrada! No  possvel adicionar novos itens."),!1;try{const I=await p(C.instagram_handle);if(!I)return!1;const U=await g(I.id);if(!U)return!1;const{data:$,error:Y}=await ce.from("product_catalog").select("price, stock_by_size").eq("id",C.product_id).single();if(Y||!$)return de.error("Produto no encontrado"),!1;const{data:Z}=await ce.from("live_products").select("live_discount_type, live_discount_value").eq("live_event_id",e).eq("product_id",C.product_id).maybeSingle();let re=$.price;Z!=null&&Z.live_discount_type&&(Z!=null&&Z.live_discount_value)&&(Z.live_discount_type==="percentage"?re=$.price*(1-Z.live_discount_value/100):Z.live_discount_type==="fixed"&&(re=Math.max(0,$.price-Z.live_discount_value)));const G=C.tamanho||"",{data:J}=await ce.rpc("get_available_stock",{p_product_id:C.product_id,p_size:G}),V=J||0;if(V<C.qtd)return de.error(`Estoque insuficiente! Disponvel: ${V}`),!1;const{data:W}=await ce.from("live_events").select("reservation_expiry_minutes").eq("id",e).single(),ee=(W==null?void 0:W.reservation_expiry_minutes)||30,ie=new Date;ie.setMinutes(ie.getMinutes()+ee);const{data:oe,error:se}=await ce.rpc("upsert_live_cart_item",{p_live_cart_id:U.id,p_product_id:C.product_id,p_variante:{cor:C.cor,tamanho:C.tamanho},p_qtd:C.qtd,p_preco_unitario:re,p_expiracao_reserva_em:ie.toISOString()});if(se)throw se;return console.log("[quickLaunch] Upsert result:",oe),await x(U.id),await b(U.id),de.success(` Reservado para ${C.instagram_handle}!`),await m(),!0}catch(I){return console.error("Error in quick launch:",I),de.error("Erro ao adicionar item"),!1}},x=async C=>{var k;try{const{data:I}=await ce.from("live_carts").select("live_event_id, live_customer:live_customers(client_id)").eq("id",C).single(),{data:U}=await ce.from("live_cart_items").select("preco_unitario, qtd, status").eq("live_cart_id",C).in("status",["reservado","confirmado"]),$=(U||[]).reduce((Y,Z)=>Y+Z.preco_unitario*Z.qtd,0);await ce.from("live_carts").update({subtotal:$,total:$}).eq("id",C),I&&e&&await y(C,$,e,((k=I.live_customer)==null?void 0:k.client_id)||void 0)}catch(I){console.error("Error updating cart totals:",I)}},y=async(C,k,I,U)=>{try{const $=new Date().toISOString(),{data:Y}=await ce.from("gift_rules").select("*, gift:gifts(*)").eq("is_active",!0).in("channel_scope",["live_only","both","live_specific"]).or(`start_at.is.null,start_at.lte.${$}`).or(`end_at.is.null,end_at.gte.${$}`).order("priority",{ascending:!1});if(!Y||Y.length===0)return;const Z=Y.filter(J=>J.channel_scope==="live_specific"?J.live_event_id===I:!0),{data:re}=await ce.from("order_gifts").select("id, gift_id, applied_by_rule_id, status").eq("live_cart_id",C).not("applied_by_rule_id","is",null).neq("status","removed"),G=new Set((re||[]).map(J=>J.applied_by_rule_id));for(const J of Z){const V=J.gift;if(!V)continue;let W=!1;switch(J.condition_type){case"all_purchases":W=!0;break;case"min_value":W=J.condition_value?k>=J.condition_value:!1;break;case"first_n_paid":case"first_n_reserved":W=J.condition_value?J.current_awards_count<J.condition_value:!1;break}J.max_total_awards&&J.current_awards_count>=J.max_total_awards&&(W=!1);const ee=G.has(J.id);if(W&&!ee){if(!V.unlimited_stock&&V.stock_qty<J.gift_qty){console.log(`Gift ${V.name} out of stock for rule ${J.name}`);continue}const{error:ie}=await ce.from("order_gifts").insert({live_cart_id:C,gift_id:V.id,qty:J.gift_qty,status:"pending_separation",applied_by_rule_id:J.id});ie||(await ce.rpc("decrement_gift_stock",{p_gift_id:V.id,p_qty:J.gift_qty}),await ce.rpc("increment_gift_rule_awards",{p_rule_id:J.id,p_qty:1}),await b(C),de.success(` Brinde aplicado: ${V.name}`))}else if(!W&&ee){const ie=re==null?void 0:re.find(oe=>oe.applied_by_rule_id===J.id);ie&&ie.status==="pending_separation"&&(await ce.from("order_gifts").update({status:"removed"}).eq("id",ie.id),await ce.rpc("decrement_gift_stock",{p_gift_id:ie.gift_id,p_qty:-J.gift_qty}),await b(C),de.info(`Brinde removido: ${V.name} (condio no atendida)`))}}}catch($){console.error("Error evaluating gift rules:",$)}},b=async C=>{try{const{data:k}=await ce.from("live_carts").select("bag_number, label_printed_at").eq("id",C).single();k!=null&&k.bag_number&&(k!=null&&k.label_printed_at)&&await ce.from("live_carts").update({needs_label_reprint:!0,updated_at:new Date().toISOString()}).eq("id",C)}catch(k){console.error("Error marking cart for reprint:",k)}},j=async C=>{try{const{data:k}=await ce.from("live_cart_items").select("live_cart_id, product_id, variante, separation_status, qtd").eq("id",C).single();if(!k)return{success:!1};if(k.separation_status==="separado"||k.separation_status==="retirado_confirmado")return{success:await O(C,`Cancelado - retirar ${k.qtd} unidade(s) da sacola`),productId:k.product_id};const{error:U}=await ce.from("live_cart_items").update({status:"removido"}).eq("id",C);if(U)throw U;await x(k.live_cart_id),await b(k.live_cart_id);const $=k.variante,Y=($==null?void 0:$.tamanho)||"",{data:Z}=await ce.from("live_waitlist").select("*").eq("live_event_id",e).eq("product_id",k.product_id).eq("status","ativa").order("ordem").limit(1),re=Z&&Z.length>0;return re?de.warning(` Estoque liberado! ${Z[0].instagram_handle} est na fila para este item.`,{duration:8e3,action:{label:"Ver fila",onClick:()=>{}}}):de.success("Item removido do carrinho"),await m(),{success:!0,waitlistEntry:re?Z[0]:void 0,productId:k.product_id,size:Y}}catch(k){return console.error("Error removing cart item:",k),de.error("Erro ao remover item"),{success:!1}}},T=async C=>{try{const{data:k}=await ce.from("live_cart_items").select("live_cart_id, qtd, product_id, variante, separation_status, separation_notes").eq("id",C).single();if(!k)return de.error("Item no encontrado"),!1;const I=k.separation_status==="separado"||k.separation_status==="retirado_confirmado";if(k.qtd<=1)return I?await O(C,"Cancelado - retirar 1 unidade da sacola"):(await j(C)).success;let U=k.separation_notes||"",$=k.separation_status;if(I){const Z=U.match(/pending_removal:(\d+)/),G=(Z?parseInt(Z[1],10):0)+1;Z?U=U.replace(/pending_removal:\d+/,`pending_removal:${G}`):U=U?`${U} | pending_removal:${G}`:`pending_removal:${G}`,$="cancelado"}const{error:Y}=await ce.from("live_cart_items").update({qtd:k.qtd-1,separation_notes:I?U:k.separation_notes,separation_status:I?$:k.separation_status}).eq("id",C);if(Y)throw Y;if(await x(k.live_cart_id),await b(k.live_cart_id),I)await ce.from("live_carts").update({separation_status:"atencao"}).eq("id",k.live_cart_id),de.warning(" 1 unidade cancelada! Retire da sacola fsica.",{duration:6e3});else{const Z=k.variante,re=(Z==null?void 0:Z.tamanho)||"",{data:G}=await ce.from("live_waitlist").select("*").eq("live_event_id",e).eq("product_id",k.product_id).eq("status","ativa").order("ordem",{ascending:!0}).limit(1);G&&G.length>0?de.warning(` 1 unidade liberada! ${G[0].instagram_handle} est na fila.`,{duration:6e3}):de.success("1 unidade removida do carrinho")}return await m(),!0}catch(k){return console.error("Error reducing item quantity:",k),de.error("Erro ao reduzir quantidade"),!1}},O=async(C,k)=>{try{const{data:I}=await ce.from("live_cart_items").select("live_cart_id, product_id, variante, preco_unitario, qtd").eq("id",C).single();if(!I)return de.error("Item no encontrado"),!1;const{error:U}=await ce.from("live_cart_items").update({status:"cancelado",separation_status:"cancelado",separation_notes:k||"Cancelado pelo cliente - retirar da sacola"}).eq("id",C);if(U)throw U;return await x(I.live_cart_id),await b(I.live_cart_id),await ce.from("live_carts").update({separation_status:"atencao"}).eq("id",I.live_cart_id),de.warning("Item cancelado! Retire da sacola fsica na separao.",{duration:5e3}),await m(),!0}catch(I){return console.error("Error cancelling item for separation:",I),de.error("Erro ao cancelar item"),!1}},R=async(C,k,I,U,$,Y)=>{if(!e)return!1;const Z=I.startsWith("@")?I.toLowerCase():`@${I.toLowerCase()}`;try{const{error:re}=await ce.from("live_waitlist").insert({live_event_id:e,product_id:C,variante:{...k,observacao:Y},instagram_handle:Z,whatsapp:U||null,status:"ativa"});if(re)throw re;return de.success(` ${Z} adicionado  lista de espera!`),await m(),!0}catch(re){return console.error("Error adding to waitlist:",re),de.error("Erro ao adicionar  lista de espera"),!1}},D=async C=>{try{await ce.from("live_waitlist").update({status:"cancelada"}).eq("id",C),de.info("Pulou para o prximo da fila"),await m()}catch(k){console.error("Error skipping waitlist entry:",k),de.error("Erro ao pular entrada")}},L=async(C,k)=>{try{const{error:I}=await ce.from("live_waitlist").update({status:"cancelada"}).eq("live_event_id",e).eq("product_id",C).eq("status","ativa").filter("variante->tamanho","eq",k);if(I)throw I;de.info("Fila encerrada para esta variao"),await m()}catch(I){console.error("Error ending waitlist queue:",I),de.error("Erro ao encerrar fila")}},q=(C,k)=>o.find(I=>{var U;return I.product_id===C&&((U=I.variante)==null?void 0:U.tamanho)===k&&I.status==="ativa"})||null,X=(C,k)=>o.filter(I=>{var U;return I.product_id===C&&((U=I.variante)==null?void 0:U.tamanho)===k&&I.status==="ativa"}).length,H=async C=>{try{const{data:k,error:I}=await ce.from("live_waitlist").select("*").eq("id",C).single();if(I||!k)return console.error("Error fetching waitlist item:",I),de.error("Erro ao buscar item da lista de espera"),!1;const U=k.variante;if(await v({instagram_handle:k.instagram_handle,product_id:k.product_id,cor:U==null?void 0:U.cor,tamanho:U==null?void 0:U.tamanho,qtd:1})){try{const{data:Y}=await ce.from("live_customers").select("id").eq("live_event_id",e).ilike("instagram_handle",k.instagram_handle).maybeSingle();if(Y!=null&&Y.id){const{data:Z}=await ce.from("live_carts").select("id").eq("live_event_id",e).eq("live_customer_id",Y.id).maybeSingle();Z!=null&&Z.id&&await x(Z.id)}}catch(Y){console.warn("Could not force-recalculate cart totals after waitlist allocation",Y)}return await ce.from("live_waitlist").update({status:"atendida"}).eq("id",C),de.success(` Alocado para ${k.instagram_handle}!`),await m(),!0}return!1}catch(k){return console.error("Error allocating from waitlist:",k),de.error("Erro ao alocar da lista de espera"),!1}},M=(C,k)=>{var $;const I=C.startsWith("@")?C.toLowerCase():`@${C.toLowerCase()}`;for(const Y of a)if((($=Y.live_customer)==null?void 0:$.instagram_handle.toLowerCase())===I){const Z=Y.items||[],re=k?Z.filter(G=>G.product_id===k&&["reservado","confirmado"].includes(G.status)):Z.filter(G=>["reservado","confirmado"].includes(G.status));if(re.length>0)return{found:!0,status:"reservado",details:re.map(J=>{var V,W;return`${(V=J.product)==null?void 0:V.name} (${(W=J.variante)==null?void 0:W.tamanho})`}).join(", ")}}const U=o.find(Y=>{const Z=Y.instagram_handle.toLowerCase()===I,re=k?Y.product_id===k:!0;return Z&&re});return U?{found:!0,status:"espera",details:`Posio ${U.ordem} na fila`}:{found:!1,status:"nao_consta"}},F=async C=>{try{const{data:k,error:I}=await ce.functions.invoke("create-live-cart-payment",{body:{live_cart_id:C}});if(I)return console.error("Error generating payment:",I),{success:!1,error:"Erro de conexo ao gerar link"};if(k!=null&&k.success&&(k!=null&&k.init_point))return k.already_exists?de.info("Link j existia - copiando..."):de.success("Link de pagamento gerado!"),await m(),{success:!0,checkoutUrl:k.init_point};if(k!=null&&k.error_code){const U=k.message||"Erro ao gerar pagamento",$=k.action?` ${k.action}`:"";return console.error("Payment error:",k),{success:!1,error:`${U}${$}`}}return{success:!1,error:(k==null?void 0:k.error)||(k==null?void 0:k.message)||"Erro ao gerar pagamento"}}catch(k){return console.error("Error generating payment:",k),{success:!1,error:"Erro ao gerar link de pagamento"}}},S=async C=>{try{const{data:k}=await ce.rpc("is_cart_in_committed_state",{p_cart_id:C});return k===!0}catch(k){return console.error("Error checking cart committed state:",k),!1}};return{customers:r,carts:a,waitlist:o,isLoading:d,fetchBackstageData:m,getOrCreateCustomer:p,getOrCreateCart:g,quickLaunch:v,removeCartItem:j,reduceItemQuantity:T,cancelItemForSeparation:O,addToWaitlist:R,allocateFromWaitlist:H,skipWaitlistEntry:D,endWaitlistQueue:L,getNextWaitlistEntry:q,getWaitlistCount:X,checkCustomerHasProduct:M,updateCartTotals:x,generatePaymentLink:F,updateCartStatus:async(C,k,I)=>{var U;try{const $=a.find(V=>V.id===C),Y=($==null?void 0:$.status)||null;if(k==="cancelado"&&$&&await S(C)){const ee=($.items||[]).filter(ie=>["reservado","confirmado"].includes(ie.status));for(const ie of ee){const oe=ie.variante;await ce.rpc("log_live_attention",{p_cart_id:C,p_attention_type:"cancellation",p_product_id:ie.product_id,p_product_name:((U=ie.product)==null?void 0:U.name)||"Produto",p_size:(oe==null?void 0:oe.tamanho)||null,p_quantity:ie.qtd,p_origin_bag_number:$.bag_number||null,p_payload:{reason:"cart_cancellation",item_id:ie.id}}),await ce.from("live_cart_items").update({status:"cancelado",separation_status:"cancelado",separation_notes:"Cancelado - RETIRAR DA SACOLA FSICA"}).eq("id",ie.id)}return await ce.from("live_carts").update({separation_status:"atencao",needs_label_reprint:!!$.label_printed_at}).eq("id",C),de.warning(" Sacola requer ateno fsica! Itens marcados para retirada na separao.",{duration:6e3}),await m(),{success:!0,requiresAttention:!0}}const Z={status:k};if(k==="pago"&&$){await ce.from("live_cart_items").update({status:"confirmado"}).eq("live_cart_id",C).in("status",["reservado"]);const V=$.live_customer,W=$.items||[],ee=(V==null?void 0:V.whatsapp)||"",ie=(V==null?void 0:V.nome)||(V==null?void 0:V.instagram_handle)||"Cliente Live",{data:oe,error:se}=await ce.from("orders").insert({customer_name:ie,customer_phone:ee,customer_address:"Pagamento manual - verificar endereo",total:$.total||0,status:"pago",payment_status:"approved",delivery_method:($.frete||0)>0?"shipping":"pickup",shipping_fee:$.frete||0,live_event_id:$.live_event_id,live_cart_id:C,source:"live"}).select().single();if(se)console.error("Failed to create order from live cart:",se);else if(oe){console.log(`Created order ${oe.id} from manual live cart payment`);const ye=W.filter(ue=>ue.status==="reservado"||ue.status==="confirmado").map(ue=>{var ne,pe,ge,Ne;return{order_id:oe.id,product_id:ue.product_id,product_name:((ne=ue.product)==null?void 0:ne.name)||"Produto",product_price:ue.preco_unitario,quantity:ue.qtd,size:((pe=ue.variante)==null?void 0:pe.tamanho)||"",color:((ge=ue.product)==null?void 0:ge.color)||null,image_url:((Ne=ue.product)==null?void 0:Ne.image_url)||null}});if(ye.length>0){const{error:ue}=await ce.from("order_items").insert(ye);ue&&console.error("Failed to create order items:",ue)}Z.order_id=oe.id}}k==="cancelado"&&$&&(await ce.from("live_cart_items").update({status:"cancelado"}).eq("live_cart_id",C).in("status",["reservado","confirmado"]),Z.separation_status="cancelado",console.log(`Released reservations for cancelled cart ${C}`));const{error:re}=await ce.from("live_carts").update(Z).eq("id",C);if(re)throw re;const{data:{user:G}}=await ce.auth.getUser();await ce.from("live_cart_status_history").insert({live_cart_id:C,old_status:Y,new_status:k,payment_method:I||null,changed_by:(G==null?void 0:G.id)||null,notes:I?`Pagamento manual via ${I}`:null});const J={pago:I?`Pagamento via ${I} confirmado!`:"Pagamento confirmado!",cancelado:"Carrinho cancelado e estoque liberado",aberto:"Carrinho reaberto"};return de.success(J[k]||"Status atualizado!"),await m(),{success:!0}}catch($){return console.error("Error updating cart status:",$),de.error("Erro ao atualizar status do carrinho"),{success:!1}}},fetchCartStatusHistory:async C=>{try{const{data:k,error:I}=await ce.from("live_cart_status_history").select("*").eq("live_cart_id",C).order("created_at",{ascending:!0});if(I)throw I;return k||[]}catch(k){return console.error("Error fetching cart history:",k),[]}}}}function C5e({open:e,onOpenChange:t,products:r,carts:s,waitlist:a,reservedStock:i}){var j,T,O,R,D,L,q;const[o,c]=P.useState("instagram"),[d,l]=P.useState(""),[u,h]=P.useState(""),[f,m]=P.useState(null),[p,g]=P.useState(null),v=X=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(X),x=P.useMemo(()=>{if(!d.trim())return null;const X=d.startsWith("@")?d.toLowerCase():`@${d.toLowerCase()}`,H=s.find(C=>{var k;return((k=C.live_customer)==null?void 0:k.instagram_handle.toLowerCase())===X}),M=a.filter(C=>C.instagram_handle.toLowerCase()===X);if(!H&&M.length===0)return{found:!1,handle:X};const F=((H==null?void 0:H.items)||[]).filter(C=>["reservado","confirmado"].includes(C.status)),S=F.reduce((C,k)=>C+k.preco_unitario*k.qtd,0),E=F.filter(C=>C.status==="confirmado").length,N=F.filter(C=>C.status==="reservado").length;return{found:!0,handle:X,cart:H,items:F,waitlistEntries:M,totalReservado:S,confirmedCount:E,reservedCount:N,status:H==null?void 0:H.status}},[d,s,a]),y=P.useMemo(()=>{if(!u.trim())return r;const X=u.toLowerCase();return r.filter(H=>{var M,F,S,E,N;return((M=H.product)==null?void 0:M.name.toLowerCase().includes(X))||((S=(F=H.product)==null?void 0:F.sku)==null?void 0:S.toLowerCase().includes(X))||((N=(E=H.product)==null?void 0:E.group_key)==null?void 0:N.toLowerCase().includes(X))})},[u,r]),b=P.useMemo(()=>{var N,C,k;if(!f||!p)return null;const X=f.product_id,H=p.size,M=[];s.forEach(I=>{(I.items||[]).filter(U=>{var $;return U.product_id===X&&(($=U.variante)==null?void 0:$.tamanho)===H&&["reservado","confirmado"].includes(U.status)}).forEach(U=>{var $;M.push({instagram:(($=I.live_customer)==null?void 0:$.instagram_handle)||"Desconhecido",time:Ht(new Date(U.reservado_em),"HH:mm",{locale:gr}),status:U.status,qty:U.qtd})})});const F=a.filter(I=>{var U;return I.product_id===X&&((U=I.variante)==null?void 0:U.tamanho)===H&&I.status==="ativa"}).sort((I,U)=>I.ordem-U.ordem),S=((C=(N=f.product)==null?void 0:N.stock_by_size)==null?void 0:C[H])||0,E=((k=i[X])==null?void 0:k[H])||0;return{totalStock:S,reserved:E,available:Math.max(0,S-E),reservations:M,waitlistEntries:F}},[f,p,s,a,i]);return n.jsx(cn,{open:e,onOpenChange:t,children:n.jsxs(sn,{className:"sm:max-w-2xl max-h-[85vh] overflow-hidden flex flex-col",children:[n.jsx(fn,{children:n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(wa,{className:"h-5 w-5"}),"Quem garantiu?"]})}),n.jsxs(pi,{value:o,onValueChange:X=>c(X),className:"flex-1 flex flex-col overflow-hidden",children:[n.jsxs(Qa,{className:"grid grid-cols-2 shrink-0",children:[n.jsxs(pr,{value:"instagram",className:"gap-1",children:[n.jsx(wa,{className:"h-4 w-4"}),"Por @"]}),n.jsxs(pr,{value:"produto",className:"gap-1",children:[n.jsx(Ut,{className:"h-4 w-4"}),"Por Produto"]})]}),n.jsxs(wr,{value:"instagram",className:"flex-1 overflow-auto mt-4 space-y-4",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"@instagram",value:d,onChange:X=>l(X.target.value),className:"pl-10"})]}),x&&!x.found&&n.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(an,{className:"h-5 w-5 text-red-600"}),n.jsxs("span",{className:"font-medium text-red-700",children:[x.handle," no consta"]})]})}),(x==null?void 0:x.found)&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-4 bg-muted/50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"font-semibold text-lg",children:x.handle}),n.jsx(Ae,{variant:x.status==="pago"?"default":x.status==="aguardando_pagamento"?"secondary":"outline",children:x.status==="pago"?"Pago":x.status==="aguardando_pagamento"?"Aguardando Pagamento":"Pendente"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Reservados:"}),n.jsx("span",{className:"ml-1 font-medium",children:x.reservedCount})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Confirmados:"}),n.jsx("span",{className:"ml-1 font-medium",children:x.confirmedCount})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Total:"}),n.jsx("span",{className:"ml-1 font-medium",children:v(x.totalReservado)})]})]})]}),x.items.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"font-medium text-sm",children:"Itens Reservados"}),x.items.map(X=>{var H,M,F,S;return n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-green-50 border border-green-100 rounded-lg",children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:((H=X.product)==null?void 0:H.image_url)&&n.jsx("img",{src:X.product.image_url,alt:X.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:(M=X.product)==null?void 0:M.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[((F=X.product)==null?void 0:F.color)&&`${X.product.color}  `,"Tam: ",(S=X.variante)==null?void 0:S.tamanho,"  Qtd: ",X.qtd]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("div",{className:"font-medium text-sm",children:v(X.preco_unitario*X.qtd)}),n.jsx(Ae,{variant:X.status==="confirmado"?"default":"secondary",className:"text-xs",children:X.status==="confirmado"?n.jsxs(n.Fragment,{children:[n.jsx(Er,{className:"h-3 w-3 mr-1"}),"Confirmado"]}):n.jsxs(n.Fragment,{children:[n.jsx(Br,{className:"h-3 w-3 mr-1"}),"Reservado"]})})]})]},X.id)})]}),x.waitlistEntries.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx("h4",{className:"font-medium text-sm",children:"Na Lista de Espera"}),x.waitlistEntries.map(X=>{var M,F;const H=r.find(S=>S.product_id===X.product_id);return n.jsxs("div",{className:"flex items-center gap-3 p-2 bg-amber-50 border border-amber-100 rounded-lg",children:[n.jsx(Fi,{className:"h-5 w-5 text-amber-600"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-sm",children:((M=H==null?void 0:H.product)==null?void 0:M.name)||"Produto"}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Tam: ",(F=X.variante)==null?void 0:F.tamanho,"  Posio #",X.ordem]})]})]},X.id)})]})]})]}),n.jsx(wr,{value:"produto",className:"flex-1 overflow-hidden mt-4",children:f?p?n.jsxs("div",{className:"h-full flex flex-col",children:[n.jsx(he,{variant:"ghost",size:"sm",className:"self-start mb-4",onClick:()=>g(null),children:" Voltar"}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg mb-4",children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:((D=f.product)==null?void 0:D.image_url)&&n.jsx("img",{src:f.product.image_url,alt:f.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium",children:(L=f.product)==null?void 0:L.name}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:[(q=f.product)==null?void 0:q.color,"  Tam: ",p.size]})]}),b&&n.jsxs("div",{className:"text-right text-sm",children:[n.jsxs("div",{children:["Disponvel:"," ",n.jsx("span",{className:b.available>0?"text-green-600 font-medium":"text-red-600 font-medium",children:b.available})]}),n.jsxs("div",{className:"text-muted-foreground",children:["de ",b.totalStock," total"]})]})]}),n.jsx(bi,{className:"flex-1",children:b&&n.jsxs("div",{className:"space-y-4",children:[b.reservations.length>0?n.jsxs("div",{className:"space-y-2",children:[n.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2",children:[n.jsx(Er,{className:"h-4 w-4 text-green-600"}),"Reservas (",b.reservations.length,")"]}),b.reservations.map((X,H)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-green-50 border border-green-100 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:X.instagram}),n.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:X.time})]}),n.jsx(Ae,{variant:X.status==="confirmado"?"default":"secondary",children:X.status==="confirmado"?"Confirmado":"Reservado"})]},H))]}):n.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Nenhuma reserva para esta variao"}),b.waitlistEntries.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2",children:[n.jsx(Fi,{className:"h-4 w-4 text-amber-600"}),"Lista de Espera (",b.waitlistEntries.length,")"]}),b.waitlistEntries.map((X,H)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-amber-50 border border-amber-100 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:X.instagram_handle}),X.whatsapp&&n.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:X.whatsapp})]}),n.jsxs(Ae,{variant:"outline",children:["#",H+1," na fila"]})]},X.id))]})]})})]}):n.jsxs("div",{className:"h-full flex flex-col",children:[n.jsx(he,{variant:"ghost",size:"sm",className:"self-start mb-4",onClick:()=>m(null),children:" Voltar"}),n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg mb-4",children:[n.jsx("div",{className:"w-16 h-16 bg-secondary rounded overflow-hidden shrink-0",children:((j=f.product)==null?void 0:j.image_url)&&n.jsx("img",{src:f.product.image_url,alt:f.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:(T=f.product)==null?void 0:T.name}),n.jsx("div",{className:"text-sm text-muted-foreground",children:(O=f.product)==null?void 0:O.color})]})]}),n.jsx("h4",{className:"font-medium mb-3",children:"Selecione um tamanho:"}),n.jsx("div",{className:"grid grid-cols-4 gap-2",children:kp(Object.keys(((R=f.product)==null?void 0:R.stock_by_size)||{})).map(X=>{var E,N,C;const H=((N=(E=f.product)==null?void 0:E.stock_by_size)==null?void 0:N[X])||0,M=((C=i[f.product_id])==null?void 0:C[X])||0,F=Math.max(0,H-M),S=a.filter(k=>{var I;return k.product_id===f.product_id&&((I=k.variante)==null?void 0:I.tamanho)===X&&k.status==="ativa"}).length;return n.jsxs("button",{className:`p-3 rounded-lg border text-center transition-colors hover:border-primary ${F===0?"bg-muted":""}`,onClick:()=>g({size:X}),children:[n.jsx("div",{className:"font-bold text-lg",children:X}),n.jsxs("div",{className:"text-xs text-muted-foreground space-y-0.5",children:[n.jsxs("div",{children:["Total: ",H]}),n.jsxs("div",{className:"text-amber-600",children:["Reserv: ",M]}),n.jsxs("div",{className:F>0?"text-green-600":"text-red-600",children:["Disp: ",F]}),S>0&&n.jsxs("div",{className:"text-blue-600",children:["Fila: ",S]})]})]},X)})})]}):n.jsxs("div",{className:"h-full flex flex-col",children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar produto por nome ou cdigo...",value:u,onChange:X=>h(X.target.value),className:"pl-10"})]}),n.jsx(bi,{className:"flex-1",children:n.jsx("div",{className:"space-y-2",children:y.map(X=>{const H=X.product;return H?n.jsx("div",{className:"p-3 rounded-lg border hover:bg-muted/50 cursor-pointer transition-colors",onClick:()=>m(X),children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:H.image_url&&n.jsx("img",{src:H.image_url,alt:H.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:H.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[H.sku||H.group_key,H.color&&`  ${H.color}`]})]}),n.jsx(zi,{className:"h-4 w-4 text-muted-foreground"})]})},X.id):null})})})]})})]})]})})}function E5e({open:e,onOpenChange:t,eventId:r,existingProductIds:s,onProductsAdded:a}){const[i,o]=P.useState(""),[c,d]=P.useState([]),[l,u]=P.useState(new Map),[h,f]=P.useState(new Set),[m,p]=P.useState(!1),[g,v]=P.useState(!1);P.useEffect(()=>{e&&(x(),f(new Set),o(""))},[e]);const x=async()=>{p(!0);try{const{data:O,error:R}=await ce.from("product_available_stock").select("product_id, size, stock, available");if(R){console.error("Error fetching available stock:",R),de.error("Erro ao carregar estoque disponvel"),p(!1);return}const D=new Map;(O||[]).forEach(X=>{X.available>0&&(D.has(X.product_id)||D.set(X.product_id,new Map),D.get(X.product_id).set(X.size,X.available))}),u(D),console.log("[AddProductsModal] Loaded available stock for",D.size,"products");const{data:L,error:q}=await ce.from("product_catalog").select("id, name, image_url, price, color, sku, group_key").eq("is_active",!0).order("name");if(q)throw q;d((L||[]).map(X=>({...X,stock_by_size:null})))}catch(O){console.error("Error fetching products:",O),de.error("Erro ao carregar produtos")}finally{p(!1)}},y=O=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(O),b=P.useMemo(()=>{let O=c.filter(R=>!s.includes(R.id));if(i.trim()){const R=i.toLowerCase();O=O.filter(D=>{var L,q,X;return D.name.toLowerCase().includes(R)||((L=D.sku)==null?void 0:L.toLowerCase().includes(R))||((q=D.group_key)==null?void 0:q.toLowerCase().includes(R))||((X=D.color)==null?void 0:X.toLowerCase().includes(R))})}return O},[c,s,i]),j=O=>{const R=new Set(h);R.has(O)?R.delete(O):R.add(O),f(R)},T=async()=>{var O;if(h.size!==0){v(!0);try{const{data:R}=await ce.from("live_products").select("prioridade_ordem").eq("live_event_id",r).order("prioridade_ordem",{ascending:!1}).limit(1);let D=((O=R==null?void 0:R[0])==null?void 0:O.prioridade_ordem)||0;const L=Array.from(h).map(X=>{D+=1;const H=l.get(X),M={};return H&&H.forEach((F,S)=>{F>0&&(M[S]=F)}),{live_event_id:r,product_id:X,prioridade_ordem:D,visibilidade:"catalogo_e_live",bloquear_desde_planejamento:!1,snapshot_variantes:M}}),{error:q}=await ce.from("live_products").insert(L);if(q)throw q;de.success(`${h.size} produto(s) adicionado(s)  live!`),a(),t(!1)}catch(R){console.error("Error adding products:",R),de.error("Erro ao adicionar produtos")}finally{v(!1)}}};return n.jsx(cn,{open:e,onOpenChange:t,children:n.jsxs(sn,{className:"p-0 w-[min(720px,95vw)] max-h-[85vh] !flex !flex-col overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b shrink-0",children:n.jsx(fn,{className:"p-0 m-0",children:n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(An,{className:"h-5 w-5"}),"Adicionar Produtos  Live"]})})}),n.jsxs("div",{className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto",children:[n.jsxs("div",{className:"relative mb-4",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar por nome, cdigo ou cor...",value:i,onChange:O=>o(O.target.value),className:"pl-10"})]}),h.size>0&&n.jsxs("div",{className:"flex items-center justify-between p-2 bg-primary/10 rounded-lg mb-3",children:[n.jsxs("span",{className:"text-sm font-medium",children:[h.size," produto(s) selecionado(s)"]}),n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>f(new Set),children:[n.jsx(an,{className:"h-4 w-4 mr-1"}),"Limpar"]})]}),m?n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Carregando produtos..."}):b.length===0?n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Ut,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{children:"Nenhum produto encontrado"})]}):n.jsx("div",{className:"space-y-2",children:b.map(O=>{const R=h.has(O.id),D=l.get(O.id);let L=[],q=0;return D&&D.size>0&&(D.forEach((H,M)=>{L.push({size:M,available:H}),q+=H}),L=kp(L.map(H=>H.size)).map(H=>{const M=D.get(H)||0;return{size:H,available:M}}).filter(H=>H.available>0)),n.jsx("div",{className:`p-3 rounded-lg border cursor-pointer transition-colors ${R?"border-primary bg-primary/5":"hover:bg-muted/50"}`,onClick:()=>j(O.id),children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(va,{checked:R}),n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:O.image_url?n.jsx("img",{src:O.image_url,alt:O.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:O.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[O.sku||O.group_key||"",O.color&&`  ${O.color}`,"  ",y(O.price)]}),n.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[L.slice(0,6).map(({size:X,available:H})=>n.jsxs("span",{className:`px-1.5 py-0.5 rounded text-xs ${H>0?"bg-secondary":"bg-red-100 text-red-600"}`,children:[X,": ",H]},X)),L.length>6&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",L.length-6]})]})]}),n.jsx("div",{className:"text-right shrink-0",children:n.jsxs(Ae,{variant:q>0?"secondary":"destructive",children:[q," un"]})})]})},O.id)})})]}),n.jsxs("div",{className:"px-6 py-4 border-t shrink-0 flex justify-end gap-2",children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),n.jsx(he,{onClick:T,disabled:h.size===0||g,children:g?"Adicionando...":n.jsxs(n.Fragment,{children:[n.jsx(xn,{className:"h-4 w-4 mr-1"}),"Adicionar ",h.size>0&&`(${h.size})`]})})]})]})})}function k5e({open:e,onOpenChange:t,liveProduct:r,onProductUpdated:s}){const[a,i]=P.useState("none"),[o,c]=P.useState(""),[d,l]=P.useState(""),[u,h]=P.useState("catalogo_e_live"),[f,m]=P.useState(!1),[p,g]=P.useState(!1);P.useEffect(()=>{var O,R;r&&(i(r.live_discount_type||"none"),c(((O=r.live_discount_value)==null?void 0:O.toString())||""),l(((R=r.limite_unidades_live)==null?void 0:R.toString())||""),h(r.visibilidade),m(r.bloquear_desde_planejamento))},[r]);const v=O=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(O),x=async()=>{if(r){g(!0);try{const O={visibilidade:u,bloquear_desde_planejamento:f,limite_unidades_live:d?parseInt(d):null};a==="none"?(O.live_discount_type=null,O.live_discount_value=null):(O.live_discount_type=a,O.live_discount_value=parseFloat(o)||null);const{error:R}=await ce.from("live_products").update(O).eq("id",r.id);if(R)throw R;de.success("Produto atualizado com sucesso!"),s(),t(!1)}catch(O){console.error("Error updating live product:",O),de.error("Erro ao atualizar produto")}finally{g(!1)}}};if(!r||!r.product)return null;const y=r.product,b=y.price,j=a==="none"?null:a,T=a!=="none"&&parseFloat(o)>0?fx(b,j,parseFloat(o)):b;return n.jsx(cn,{open:e,onOpenChange:t,children:n.jsxs(sn,{className:"p-0 w-[min(480px,95vw)] max-h-[85vh] !flex !flex-col overflow-hidden",children:[n.jsx("div",{className:"px-6 py-4 border-b shrink-0",children:n.jsx(fn,{className:"p-0 m-0",children:n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(ea,{className:"h-5 w-5"}),"Editar Produto na Live"]})})}),n.jsxs("div",{className:"px-6 py-4 flex-1 min-h-0 overflow-y-auto space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-lg",children:[y.image_url&&n.jsx("img",{src:y.image_url,alt:y.name,className:"w-14 h-14 rounded object-cover"}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium truncate",children:y.name}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:[y.color&&`${y.color}  `,v(b)]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Desconto na Live"}),n.jsxs(Kt,{value:a,onValueChange:O=>i(O),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"none",children:"Sem desconto"}),n.jsx(ze,{value:"percentage",children:"Percentual (%)"}),n.jsx(ze,{value:"fixed",children:"Valor fixo (R$)"})]})]})]}),a!=="none"&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:a==="percentage"?"Desconto (%)":"Desconto (R$)"}),n.jsxs("div",{className:"relative",children:[n.jsx(Qe,{type:"number",placeholder:a==="percentage"?"10":"20.00",value:o,onChange:O=>c(O.target.value),className:"pr-10"}),n.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:a==="percentage"?n.jsx(jo,{className:"h-4 w-4 text-muted-foreground"}):n.jsx(ws,{className:"h-4 w-4 text-muted-foreground"})})]}),parseFloat(o)>0&&n.jsxs("div",{className:"p-2 bg-green-50 rounded text-sm",children:[n.jsx("span",{className:"text-muted-foreground line-through mr-2",children:v(b)}),n.jsx("span",{className:"font-medium text-green-700",children:v(T)})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Limite de unidades na live (opcional)"}),n.jsx(Qe,{type:"number",placeholder:"Sem limite",value:d,onChange:O=>l(O.target.value)}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Deixe vazio para usar todo o estoque disponvel"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Visibilidade"}),n.jsxs(Kt,{value:u,onValueChange:O=>h(O),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"catalogo_e_live",children:"Catlogo e Live"}),n.jsx(ze,{value:"exclusivo_live",children:"Exclusivo da Live"})]})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[n.jsxs("div",{className:"space-y-0.5",children:[n.jsx(Le,{className:"cursor-pointer",children:"Bloquear desde planejamento"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Esconde do catlogo mesmo antes da live comear"})]}),n.jsx(di,{checked:f,onCheckedChange:m})]})]}),n.jsxs("div",{className:"px-6 py-4 border-t shrink-0 flex justify-end gap-2",children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),n.jsx(he,{onClick:x,disabled:p,children:p?"Salvando...":"Salvar alteraes"})]})]})})}function A5e({open:e,onOpenChange:t,productName:r,productColor:s,size:a,queueCount:i,onSubmit:o}){const[c,d]=P.useState(""),[l,u]=P.useState(""),[h,f]=P.useState(""),[m,p]=P.useState(""),[g,v]=P.useState(!1),x=async()=>{if(!c.trim())return;v(!0);const y=await o({instagram:c.trim(),nome:l.trim()||void 0,whatsapp:h.trim()||void 0,observacao:m.trim()||void 0});v(!1),y&&(d(""),u(""),f(""),p(""),t(!1))};return n.jsx(cn,{open:e,onOpenChange:t,children:n.jsxs(sn,{className:"sm:max-w-md",children:[n.jsx(fn,{children:n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(Fi,{className:"h-5 w-5 text-amber-600"}),"Lista de Espera"]})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[n.jsx("div",{className:"font-medium",children:r}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:[s&&`${s}  `,"Tam: ",a]}),i>0&&n.jsxs("div",{className:"text-xs text-amber-600 mt-1",children:[i," pessoa(s) j na fila"]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{children:["@ do Instagram ",n.jsx("span",{className:"text-destructive",children:"*"})]}),n.jsx(Qe,{placeholder:"@cliente",value:c,onChange:y=>d(y.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Nome (opcional)"}),n.jsx(Qe,{placeholder:"Nome da cliente",value:l,onChange:y=>u(y.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"WhatsApp (opcional)"}),n.jsx(Qe,{placeholder:"(62) 99999-9999",value:h,onChange:y=>f(y.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Observao (opcional)"}),n.jsx(Yn,{placeholder:"Ex: pode ser 38 ou 40",value:m,onChange:y=>p(y.target.value),rows:2})]})]})]}),n.jsxs(Da,{children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),n.jsx(he,{onClick:x,disabled:!c.trim()||g,children:g?"Adicionando...":"Entrar na Lista"})]})]})})}function T5e({open:e,onOpenChange:t,waitlistItem:r,product:s,onOffer:a,onSkip:i,onEndQueue:o}){var f,m,p,g;const[c,d]=P.useState(!1);if(!r||!s)return null;const l=async()=>{d(!0);const v=await a(r.id);d(!1),v&&t(!1)},u=async()=>{d(!0),await i(r.id),d(!1)},h=async()=>{var v;d(!0),await o(r.product_id,((v=r.variante)==null?void 0:v.tamanho)||""),d(!1),t(!1)};return n.jsx(cn,{open:e,onOpenChange:t,children:n.jsxs(sn,{className:"sm:max-w-[400px] p-0 overflow-hidden",children:[n.jsx(fn,{className:"p-5 pb-0",children:n.jsxs(dn,{className:"flex items-center gap-2 text-base",children:[n.jsx(Fi,{className:"h-5 w-5 text-amber-600 shrink-0"}),"Estoque Liberado!"]})}),n.jsxs("div",{className:"px-5 py-4 space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg",children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded-md overflow-hidden shrink-0",children:((f=s.product)==null?void 0:f.image_url)&&n.jsx("img",{src:s.product.image_url,alt:s.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:(m=s.product)==null?void 0:m.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[((p=s.product)==null?void 0:p.color)&&`${s.product.color}  `,"Tam: ",(g=r.variante)==null?void 0:g.tamanho]})]})]}),n.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[n.jsx(sU,{className:"h-4 w-4 text-amber-600 shrink-0"}),n.jsx("span",{className:"text-xs font-medium text-amber-800",children:"Prximo(a) na lista de espera:"})]}),n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsx("span",{className:"text-base font-bold text-amber-900 truncate block",children:r.instagram_handle}),r.whatsapp&&n.jsx("div",{className:"text-xs text-amber-700 truncate",children:r.whatsapp})]}),n.jsxs(Ae,{variant:"outline",className:"border-amber-300 text-amber-700 text-xs shrink-0 whitespace-nowrap",children:["#",r.ordem," na fila"]})]})]}),n.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["Deseja oferecer este item para"," ",n.jsx("strong",{className:"text-foreground",children:r.instagram_handle}),"?"]})]}),n.jsxs("div",{className:"px-5 pb-5 pt-0 flex flex-col gap-2",children:[n.jsxs(he,{onClick:l,disabled:c,className:"w-full gap-1.5 bg-green-600 hover:bg-green-700",children:[n.jsx(Er,{className:"h-4 w-4"}),"Oferecer para ",r.instagram_handle.length>12?r.instagram_handle.substring(0,12)+"...":r.instagram_handle]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{variant:"outline",onClick:h,disabled:c,className:"flex-1 gap-1 text-xs h-9",children:[n.jsx(qn,{className:"h-3.5 w-3.5"}),"Encerrar Fila"]}),n.jsxs(he,{variant:"secondary",onClick:u,disabled:c,className:"flex-1 gap-1 text-xs h-9",children:[n.jsx(uk,{className:"h-3.5 w-3.5"}),"Pular"]})]})]})]})})}function P5e({carts:e,onCartClick:t,onSendWhatsApp:r,onDismiss:s}){const[a,i]=P.useState(!0),[o,c]=P.useState(new Set),d=new Date,l=new Date(d.getTime()-24*60*60*1e3),u=e.filter(p=>{if(!["aberto","aguardando_pagamento","em_confirmacao"].includes(p.status))return!1;const x=new Date(p.created_at)<l,y=o.has(p.id);return x&&!y}),h=(p,g)=>{g.stopPropagation(),c(v=>new Set([...v,p])),s==null||s(p)},f=p=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(p),m=p=>y8(new Date(p),{addSuffix:!0,locale:gr});return u.length===0?null:n.jsx(Ag,{open:a,onOpenChange:i,children:n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg overflow-hidden",children:[n.jsx(Tg,{asChild:!0,children:n.jsxs("button",{className:"w-full px-4 py-3 flex items-center justify-between hover:bg-amber-100/50 transition-colors",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Mr,{className:"h-5 w-5 text-amber-600"}),n.jsxs("span",{className:"font-medium text-amber-800",children:[u.length," carrinho",u.length!==1?"s":""," pendente",u.length!==1?"s":""," h +24h"]}),n.jsx(Ae,{variant:"outline",className:"bg-amber-100 text-amber-700 border-amber-300",children:"Ao necessria"})]}),a?n.jsx(nf,{className:"h-4 w-4 text-amber-600"}):n.jsx(Zi,{className:"h-4 w-4 text-amber-600"})]})}),n.jsx(Pg,{children:n.jsxs("div",{className:"px-4 pb-4 space-y-2",children:[n.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"Estes carrinhos esto aguardando pagamento. Considere entrar em contato ou cancelar para liberar o estoque."}),u.map(p=>{const g=p.live_customer,v=(p.items||[]).filter(x=>["reservado","confirmado"].includes(x.status)).length;return n.jsxs("div",{className:"flex items-center justify-between gap-3 p-3 bg-white rounded-lg border border-amber-200 hover:border-amber-300 transition-colors cursor-pointer",onClick:()=>t(p),children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"font-medium text-sm truncate",children:["@",(g==null?void 0:g.instagram_handle)||"desconhecido"]}),(g==null?void 0:g.nome)&&n.jsxs("span",{className:"text-xs text-muted-foreground truncate",children:["(",g.nome.split(" ")[0],")"]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5",children:[n.jsx(Br,{className:"h-3 w-3"}),n.jsx("span",{children:m(p.created_at)}),n.jsx("span",{children:""}),n.jsxs("span",{children:[v," item",v!==1?"s":""]}),n.jsx("span",{children:""}),n.jsx("span",{className:"font-medium text-amber-700",children:f(p.total)})]})]}),n.jsxs("div",{className:"flex items-center gap-1.5 shrink-0",children:[(g==null?void 0:g.whatsapp)&&n.jsx(he,{size:"sm",variant:"outline",className:"h-8 px-2 text-green-600 hover:text-green-700 hover:bg-green-50",onClick:x=>r(p,x),children:n.jsx(nn,{className:"h-4 w-4"})}),n.jsx(he,{size:"sm",variant:"ghost",className:"h-8 px-2 text-muted-foreground hover:text-foreground",onClick:x=>h(p.id,x),children:n.jsx(an,{className:"h-4 w-4"})})]})]},p.id)})]})})]})})}const fI={ativa:{label:"Aguardando",icon:Br,color:"bg-amber-100 text-amber-700"},chamada:{label:"Chamado",icon:el,color:"bg-blue-100 text-blue-700"},atendida:{label:"Transferido",icon:Er,color:"bg-green-100 text-green-700"},cancelada:{label:"Cancelado",icon:qn,color:"bg-muted text-muted-foreground"}};function O5e({open:e,onOpenChange:t,productName:r,productColor:s,size:a,entries:i,hasStock:o,onAllocate:c,onSkip:d,onEndQueue:l,onAddToWaitlist:u}){const[h,f]=P.useState(null),m=i.filter(x=>x.status==="ativa"),p=i.filter(x=>x.status!=="ativa"),g=async x=>{f(x),await c(x),f(null)},v=async x=>{f(x),await d(x),f(null)};return n.jsx(Tu,{open:e,onOpenChange:t,children:n.jsxs(fd,{className:"sm:max-w-md flex flex-col",children:[n.jsxs(Pu,{className:"shrink-0",children:[n.jsxs(cf,{className:"flex items-center gap-2",children:[n.jsx(Fi,{className:"h-5 w-5 text-amber-600"}),"Lista de Espera"]}),n.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg text-left",children:[n.jsx("div",{className:"font-medium",children:r}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:[s&&`${s}  `,"Tam: ",a]})]})]}),n.jsxs(bi,{className:"flex-1 -mx-6 px-6",children:[o&&m.length>0&&n.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg mb-4 animate-pulse",children:[n.jsxs("div",{className:"flex items-center gap-2 text-amber-800",children:[n.jsx(Er,{className:"h-5 w-5"}),n.jsx("span",{className:"font-medium",children:"Estoque disponvel!"})]}),n.jsxs("p",{className:"text-sm text-amber-700 mt-1",children:["Oferea para ",m[0].instagram_handle]})]}),m.length>0?n.jsxs("div",{className:"space-y-2",children:[n.jsxs("h4",{className:"text-sm font-medium text-muted-foreground mb-2",children:["Fila ativa (",m.length,")"]}),m.map((x,y)=>{const b=y===0,j=h===x.id,T=x.variante;return n.jsx("div",{className:`p-3 rounded-lg border transition-colors ${b&&o?"border-amber-300 bg-amber-50":"hover:bg-muted/30"}`,children:n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Ae,{variant:"outline",className:`shrink-0 ${b?"border-amber-400 bg-amber-100 text-amber-800":""}`,children:["#",x.ordem]}),n.jsx("span",{className:"font-medium truncate",children:x.instagram_handle})]}),x.whatsapp&&n.jsxs("div",{className:"text-xs text-muted-foreground mt-0.5 flex items-center gap-1",children:[n.jsx(el,{className:"h-3 w-3"}),x.whatsapp]}),(T==null?void 0:T.observacao)&&n.jsxs("div",{className:"text-xs text-muted-foreground mt-1 italic",children:['"',T.observacao,'"']}),n.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:Ht(new Date(x.created_at),"dd/MM 's' HH:mm",{locale:gr})})]}),n.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[b&&o&&n.jsxs(he,{size:"sm",className:"gap-1 bg-green-600 hover:bg-green-700",disabled:j,onClick:()=>g(x.id),children:[n.jsx(Er,{className:"h-3 w-3"}),"Transferir"]}),n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsx(he,{size:"icon",variant:"ghost",className:"h-8 w-8",disabled:j,onClick:()=>v(x.id),children:n.jsx(uk,{className:"h-4 w-4"})})}),n.jsx(Aa,{children:"Pular (no respondeu)"})]})]})]})},x.id)})]}):n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Fi,{className:"h-10 w-10 mx-auto mb-3 opacity-30"}),n.jsx("p",{className:"text-sm",children:"Nenhuma pessoa na fila"})]}),p.length>0&&n.jsxs("div",{className:"mt-6",children:[n.jsxs("h4",{className:"text-sm font-medium text-muted-foreground mb-2",children:["Histrico (",p.length,")"]}),n.jsx("div",{className:"space-y-1",children:p.slice(0,5).map(x=>{const y=fI[x.status]||fI.ativa,b=y.icon;return n.jsxs("div",{className:"flex items-center gap-2 p-2 text-sm rounded opacity-60",children:[n.jsx(b,{className:"h-3 w-3 shrink-0"}),n.jsx("span",{className:"truncate",children:x.instagram_handle}),n.jsx(Ae,{variant:"outline",className:`text-xs ml-auto ${y.color}`,children:y.label})]},x.id)})})]})]}),n.jsxs(ZV,{className:"shrink-0 gap-2 sm:gap-2 pt-4 border-t",children:[n.jsxs(he,{variant:"outline",className:"flex-1 gap-1",onClick:u,children:[n.jsx(sU,{className:"h-4 w-4"}),"Adicionar"]}),m.length>0&&n.jsxs(he,{variant:"destructive",className:"flex-1 gap-1",onClick:l,children:[n.jsx(qn,{className:"h-4 w-4"}),"Encerrar Fila"]})]})]})})}function R5e({entries:e,products:t,getAvailableStock:r,onOfferClick:s}){const a=[];return e.forEach(i=>{var u;if(i.status!=="ativa")return;const o=t.find(h=>h.product_id===i.product_id);if(!(o!=null&&o.product))return;const c=((u=i.variante)==null?void 0:u.tamanho)||"",d=o.product.available_by_size||{},l=r(o.product_id,c,d[c]||0);l>0&&a.push({entry:i,product:o,availableStock:l})}),a.length===0?null:n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 animate-pulse",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Mr,{className:"h-5 w-5 text-amber-600"}),n.jsxs("span",{className:"font-semibold text-amber-800",children:["Estoque Liberado - ",a.length," na Fila"]})]}),n.jsxs("div",{className:"space-y-2",children:[a.slice(0,3).map(({entry:i,product:o,availableStock:c})=>{var d,l,u;return n.jsxs("div",{className:"flex items-center justify-between gap-2 p-2 bg-white/50 rounded",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[n.jsx("div",{className:"w-8 h-8 bg-secondary rounded overflow-hidden shrink-0",children:((d=o.product)==null?void 0:d.image_url)&&n.jsx("img",{src:o.product.image_url,alt:"",className:"w-full h-full object-cover"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("div",{className:"text-sm font-medium truncate",children:i.instagram_handle}),n.jsxs("div",{className:"text-xs text-amber-700",children:[(l=o.product)==null?void 0:l.name," - Tam: ",(u=i.variante)==null?void 0:u.tamanho]})]})]}),n.jsxs(he,{size:"sm",className:"shrink-0 gap-1 bg-amber-600 hover:bg-amber-700",onClick:()=>s(i,o),children:[n.jsx(ps,{className:"h-3 w-3"}),"Oferecer"]})]},i.id)}),a.length>3&&n.jsxs("div",{className:"text-xs text-amber-600 text-center",children:["+",a.length-3," mais na fila"]})]})]})}const x4={ativa:{label:"Aguardando",icon:Br,color:"bg-amber-100 text-amber-800 border-amber-200"},chamada:{label:"Chamada",icon:el,color:"bg-blue-100 text-blue-800 border-blue-200"},atendida:{label:"Atendida",icon:Er,color:"bg-green-100 text-green-800 border-green-200"},cancelada:{label:"Cancelada",icon:qn,color:"bg-muted text-muted-foreground border-muted"}};function mI({waitlist:e,products:t,onAllocate:r,onSkip:s,onEndQueue:a,getAvailableStock:i}){const[o,c]=P.useState(""),[d,l]=P.useState("all"),[u,h]=P.useState("all"),[f,m]=P.useState(null),p=P.useMemo(()=>e,[e]),g=P.useMemo(()=>p.filter(R=>{var X;const D=!o||R.instagram_handle.toLowerCase().includes(o.toLowerCase())||((X=R.whatsapp)==null?void 0:X.includes(o)),L=d==="all"||R.status===d,q=u==="all"||R.product_id===u;return D&&L&&q}),[p,o,d,u]),v=P.useMemo(()=>{const R={};return p.forEach(D=>{var X,H;const L=((X=D.variante)==null?void 0:X.tamanho)||"",q=`${D.product_id}_${L}`;if(!R[q]){const M=t.find(E=>E.product_id===D.product_id),F=((H=M==null?void 0:M.product)==null?void 0:H.available_by_size)||{},S=i(D.product_id,L,F[L]||0);R[q]={product:M,size:L,entries:[],activeCount:0,attendedCount:0,cancelledCount:0,hasStock:S>0,availableStock:S}}R[q].entries.push(D),D.status==="ativa"?R[q].activeCount++:D.status==="atendida"?R[q].attendedCount++:D.status==="cancelada"&&R[q].cancelledCount++}),Object.values(R).sort((D,L)=>D.hasStock&&D.activeCount>0&&!(L.hasStock&&L.activeCount>0)?-1:L.hasStock&&L.activeCount>0&&!(D.hasStock&&D.activeCount>0)?1:L.activeCount-D.activeCount)},[p,t,i]),x=P.useMemo(()=>{const R=p.filter(X=>X.status==="ativa").length,D=p.filter(X=>X.status==="atendida").length,L=p.filter(X=>X.status==="cancelada").length,q=v.filter(X=>X.hasStock&&X.activeCount>0).length;return{active:R,attended:D,cancelled:L,withStockAvailable:q,total:p.length}},[p,v]),y=P.useMemo(()=>[...new Set(p.map(D=>D.product_id))].map(D=>t.find(L=>L.product_id===D)).filter(Boolean),[p,t]),b=async R=>{m(R),await r(R),m(null)},j=async R=>{m(R),await s(R),m(null)},T=R=>{var D;return(D=t.find(L=>L.product_id===R))==null?void 0:D.product},O=()=>{const R=["#","Instagram","WhatsApp","Produto","Cor","Tamanho","Status","Data/Hora"],D=g.map(H=>{var S;const M=T(H.product_id),F=H.variante;return[H.ordem,H.instagram_handle,H.whatsapp||"-",(M==null?void 0:M.name)||"-",(F==null?void 0:F.cor)||"-",(F==null?void 0:F.tamanho)||"-",((S=x4[H.status])==null?void 0:S.label)||H.status,Ht(new Date(H.created_at),"dd/MM/yyyy HH:mm",{locale:gr})]}),L=[R,...D].map(H=>H.join(",")).join(`
`),q=new Blob([L],{type:"text/csv;charset=utf-8;"}),X=document.createElement("a");X.href=URL.createObjectURL(q),X.download=`lista-espera-${Ht(new Date,"yyyy-MM-dd")}.csv`,X.click()};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:[n.jsx(De,{className:"bg-gradient-to-br from-amber-50 to-amber-100/50 border-amber-200",children:n.jsxs(Be,{className:"p-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Br,{className:"h-4 w-4 text-amber-600"}),n.jsx("span",{className:"text-xs text-amber-700",children:"Aguardando"})]}),n.jsx("div",{className:"text-2xl font-bold text-amber-800",children:x.active})]})}),n.jsx(De,{className:"bg-gradient-to-br from-green-50 to-green-100/50 border-green-200",children:n.jsxs(Be,{className:"p-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Er,{className:"h-4 w-4 text-green-600"}),n.jsx("span",{className:"text-xs text-green-700",children:"Atendidas"})]}),n.jsx("div",{className:"text-2xl font-bold text-green-800",children:x.attended})]})}),n.jsx(De,{className:"bg-gradient-to-br from-muted to-muted/50",children:n.jsxs(Be,{className:"p-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(qn,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"Canceladas"})]}),n.jsx("div",{className:"text-2xl font-bold",children:x.cancelled})]})}),x.withStockAvailable>0&&n.jsx(De,{className:"bg-gradient-to-br from-amber-100 to-orange-100 border-amber-300 animate-pulse col-span-2 md:col-span-2",children:n.jsxs(Be,{className:"p-3",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Mr,{className:"h-4 w-4 text-amber-700"}),n.jsx("span",{className:"text-xs font-medium text-amber-800",children:" Ao Necessria"})]}),n.jsxs("div",{className:"text-lg font-bold text-amber-900",children:[x.withStockAvailable," variao(es) com estoque liberado"]})]})})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar por @ ou WhatsApp...",value:o,onChange:R=>c(R.target.value),className:"pl-9"})]}),n.jsxs(Kt,{value:d,onValueChange:R=>l(R),children:[n.jsx(Vt,{className:"w-full sm:w-40",children:n.jsx(Xt,{placeholder:"Status"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos"}),n.jsx(ze,{value:"ativa",children:"Aguardando"}),n.jsx(ze,{value:"atendida",children:"Atendidas"}),n.jsx(ze,{value:"cancelada",children:"Canceladas"})]})]}),n.jsxs(Kt,{value:u,onValueChange:h,children:[n.jsx(Vt,{className:"w-full sm:w-48",children:n.jsx(Xt,{placeholder:"Produto"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos os produtos"}),y.map(R=>{var D,L;return n.jsx(ze,{value:R.product_id,children:((L=(D=R.product)==null?void 0:D.name)==null?void 0:L.substring(0,25))||"Produto"},R.product_id)})]})]}),n.jsx(he,{variant:"outline",size:"icon",onClick:O,children:n.jsx(Af,{className:"h-4 w-4"})})]}),v.filter(R=>R.hasStock&&R.activeCount>0).length>0&&n.jsxs(De,{className:"border-amber-300 bg-amber-50/50",children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-sm flex items-center gap-2 text-amber-800",children:[n.jsx(Mr,{className:"h-4 w-4"}),"Produtos com estoque liberado e fila ativa"]})}),n.jsx(Be,{children:n.jsx("div",{className:"space-y-2",children:v.filter(R=>R.hasStock&&R.activeCount>0).map(R=>{var L,q,X,H,M,F,S;const D=R.entries.find(E=>E.status==="ativa");return n.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-amber-200",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:((q=(L=R.product)==null?void 0:L.product)==null?void 0:q.image_url)&&n.jsx("img",{src:R.product.product.image_url,alt:R.product.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-sm",children:(H=(X=R.product)==null?void 0:X.product)==null?void 0:H.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[((F=(M=R.product)==null?void 0:M.product)==null?void 0:F.color)&&`${R.product.product.color}  `,"Tam: ",R.size,"  ",R.availableStock," disponvel  ",R.activeCount," na fila"]})]})]}),D&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm font-medium text-amber-800",children:D.instagram_handle}),n.jsxs(he,{size:"sm",className:"gap-1 bg-green-600 hover:bg-green-700",disabled:f===D.id,onClick:()=>b(D.id),children:[n.jsx(Er,{className:"h-3 w-3"}),"Transferir"]})]})]},`${(S=R.product)==null?void 0:S.product_id}_${R.size}`)})})})]}),n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-sm flex items-center gap-2",children:[n.jsx(Fi,{className:"h-4 w-4"}),"Lista Completa (",g.length," registros)"]})}),n.jsx(Be,{className:"p-0",children:n.jsx(bi,{className:"h-[400px]",children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{children:[n.jsx(jt,{className:"w-12",children:"#"}),n.jsx(jt,{children:"Cliente"}),n.jsx(jt,{children:"Produto"}),n.jsx(jt,{children:"Tamanho"}),n.jsx(jt,{children:"Status"}),n.jsx(jt,{children:"Data"}),n.jsx(jt,{className:"text-right",children:"Aes"})]})}),n.jsx(Na,{children:g.length===0?n.jsx(Qr,{children:n.jsxs(yt,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:[n.jsx(Fi,{className:"h-8 w-8 mx-auto mb-2 opacity-30"}),n.jsx("p",{children:"Nenhum registro encontrado"})]})}):g.map(R=>{var E,N;const D=T(R.product_id),L=R.variante,q=x4[R.status]||x4.ativa,X=q.icon,H=R.status==="ativa",M=((N=(E=t.find(C=>C.product_id===R.product_id))==null?void 0:E.product)==null?void 0:N.available_by_size)||{},F=i(R.product_id,(L==null?void 0:L.tamanho)||"",M[L==null?void 0:L.tamanho]||0),S=H&&F>0;return n.jsxs(Qr,{className:S?"bg-amber-50/50":"",children:[n.jsx(yt,{children:n.jsx(Ae,{variant:"outline",className:"text-xs",children:R.ordem})}),n.jsxs(yt,{children:[n.jsx("div",{className:"font-medium",children:R.instagram_handle}),R.whatsapp&&n.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[n.jsx(el,{className:"h-3 w-3"}),R.whatsapp]})]}),n.jsx(yt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 bg-secondary rounded overflow-hidden shrink-0",children:(D==null?void 0:D.image_url)&&n.jsx("img",{src:D.image_url,alt:D.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{children:[n.jsx("div",{className:"text-sm font-medium truncate max-w-32",children:(D==null?void 0:D.name)||"Produto"}),(L==null?void 0:L.cor)&&n.jsx("div",{className:"text-xs text-muted-foreground",children:L.cor})]})]})}),n.jsx(yt,{children:n.jsx(Ae,{variant:"secondary",children:(L==null?void 0:L.tamanho)||"-"})}),n.jsx(yt,{children:n.jsxs(Ae,{variant:"outline",className:q.color,children:[n.jsx(X,{className:"h-3 w-3 mr-1"}),q.label]})}),n.jsx(yt,{className:"text-xs text-muted-foreground",children:Ht(new Date(R.created_at),"dd/MM HH:mm",{locale:gr})}),n.jsx(yt,{className:"text-right",children:H&&n.jsxs("div",{className:"flex items-center justify-end gap-1",children:[S&&n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsx(he,{size:"icon",variant:"default",className:"h-7 w-7 bg-green-600 hover:bg-green-700",disabled:f===R.id,onClick:()=>b(R.id),children:n.jsx(Er,{className:"h-3 w-3"})})}),n.jsx(Aa,{children:"Transferir para carrinho"})]}),n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsx(he,{size:"icon",variant:"ghost",className:"h-7 w-7",disabled:f===R.id,onClick:()=>j(R.id),children:n.jsx(uk,{className:"h-3 w-3"})})}),n.jsx(Aa,{children:"Pular (no respondeu)"})]})]})})]},R.id)})})]})})})]}),n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-sm flex items-center gap-2",children:[n.jsx(Ut,{className:"h-4 w-4"}),"Resumo por Produto/Tamanho"]})}),n.jsx(Be,{children:n.jsxs("div",{className:"space-y-2",children:[v.map(R=>{var D,L,q,X,H,M,F;return n.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${R.hasStock&&R.activeCount>0?"border-amber-300 bg-amber-50/50":"bg-muted/30"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:((L=(D=R.product)==null?void 0:D.product)==null?void 0:L.image_url)&&n.jsx("img",{src:R.product.product.image_url,alt:R.product.product.name,className:"w-full h-full object-cover"})}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-sm",children:(X=(q=R.product)==null?void 0:q.product)==null?void 0:X.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[((M=(H=R.product)==null?void 0:H.product)==null?void 0:M.color)&&`${R.product.product.color}  `,"Tamanho: ",R.size]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[R.hasStock&&R.activeCount>0&&n.jsxs(Ae,{className:"bg-amber-500 text-white animate-pulse text-xs",children:[R.availableStock," disponvel"]}),n.jsxs(Ae,{variant:"outline",className:"text-xs",children:[n.jsx(Br,{className:"h-3 w-3 mr-1"}),R.activeCount]}),n.jsxs(Ae,{variant:"outline",className:"text-xs text-green-700",children:[n.jsx(Er,{className:"h-3 w-3 mr-1"}),R.attendedCount]}),n.jsxs(Ae,{variant:"outline",className:"text-xs text-muted-foreground",children:[n.jsx(qn,{className:"h-3 w-3 mr-1"}),R.cancelledCount]})]})]},`${(F=R.product)==null?void 0:F.product_id}_${R.size}`)}),v.length===0&&n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(Fi,{className:"h-8 w-8 mx-auto mb-2 opacity-30"}),n.jsx("p",{children:"Nenhum item na lista de espera"})]})]})})]})]})}function M5e({open:e,onClose:t,onCreated:r}){const[s,a]=P.useState(""),[i,o]=P.useState("1"),[c,d]=P.useState(""),[l,u]=P.useState(!1),h=async()=>{if(!s.trim()){de.error("Preencha o nome do brinde");return}u(!0);try{const{data:f,error:m}=await ce.from("gifts").insert({name:s.trim(),stock_qty:parseInt(i)||1,image_url:c.trim()||null,is_active:!0,unlimited_stock:!1}).select().single();if(m)throw m;de.success(`Brinde "${s}" criado!`),r(f.id),a(""),o("1"),d(""),t()}catch(f){console.error("Error creating gift:",f),de.error("Erro ao criar brinde")}finally{u(!1)}};return n.jsx(cn,{open:e,onOpenChange:f=>!f&&t(),children:n.jsxs(sn,{className:"sm:max-w-md",children:[n.jsx(fn,{children:n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(An,{className:"h-5 w-5"}),"Criar Novo Brinde"]})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Nome do Brinde *"}),n.jsx(Qe,{placeholder:"Ex: Brinco Semijoia, Caixa de Bombom...",value:s,onChange:f=>a(f.target.value)})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Quantidade"}),n.jsx(Qe,{type:"number",min:"1",value:i,onChange:f=>o(f.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"URL da Imagem (opcional)"}),n.jsx(Qe,{placeholder:"https://...",value:c,onChange:f=>d(f.target.value)})]})]}),n.jsxs("div",{className:"flex gap-2 justify-end pt-2",children:[n.jsx(he,{variant:"outline",onClick:t,children:"Cancelar"}),n.jsx(he,{onClick:h,disabled:l,children:l?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),"Criando..."]}):"Criar e Selecionar"})]})]})]})})}function I5e({eventId:e,carts:t,onRefresh:r,onRaffleOverlayChange:s}){var W,ee,ie,oe,se,le,ye;const[a,i]=P.useState([]),[o,c]=P.useState(!0),[d,l]=P.useState(""),[u,h]=P.useState(!1),[f,m]=P.useState(!1),[p,g]=P.useState("idle"),[v,x]=P.useState(null),[y,b]=P.useState([]),[j,T]=P.useState(!1),O=P.useRef(null),R=P.useRef("idle"),[D,L]=P.useState(null),[q,X]=P.useState(""),[H,M]=P.useState(!1),[F,S]=P.useState(null);P.useEffect(()=>{const ue=p==="spinning"||p==="winner_revealed"||p==="applying_prize";R.current=p,s==null||s(ue)},[p,s]);const E=P.useCallback(async()=>{c(!0);try{const ue=new Date().toISOString(),{data:ne,error:pe}=await ce.from("gifts").select("*").eq("is_active",!0).or(`start_at.is.null,start_at.lte.${ue}`).or(`end_at.is.null,end_at.gte.${ue}`).order("name");if(pe)throw pe;const ge=(ne||[]).filter(Ne=>Ne.unlimited_stock||Ne.stock_qty>0);i(ge)}catch(ue){console.error("Error fetching gifts:",ue)}finally{c(!1)}},[]),N=P.useCallback(async()=>{const{data:ue}=await ce.from("live_raffles").select(`
        id,
        gift_id,
        winner_instagram_handle,
        winner_bag_number,
        winner_live_cart_id,
        created_at,
        status,
        applied_at,
        gift:gifts(*)
      `).eq("live_event_id",e).order("created_at",{ascending:!1}).limit(20);b(ue||[])},[e]);P.useEffect(()=>{E(),N()},[E,N]);const C=ue=>{const ne=t.find(pe=>pe.id===ue.winner_live_cart_id);return(ne==null?void 0:ne.status)==="pago"},k=async()=>{if(!(!D||!q)){if(C(D)){de.error("Este pedido j foi pago. Ajustes no so permitidos.");return}M(!0);try{const ue=a.find(ne=>ne.id===q);if(!ue)throw new Error("Brinde no encontrado");if(!ue.unlimited_stock&&ue.stock_qty<1){de.error(`Brinde "${ue.name}" sem estoque!`);return}if(D.status==="applied"){await ce.from("order_gifts").delete().eq("applied_by_raffle_id",D.id),D.gift_id&&await ce.rpc("decrement_gift_stock",{p_gift_id:D.gift_id,p_qty:-1}),await ce.from("order_gifts").insert({live_cart_id:D.winner_live_cart_id,gift_id:q,qty:1,status:"pending_separation",applied_by_raffle_id:D.id}),await ce.rpc("decrement_gift_stock",{p_gift_id:q,p_qty:1});const ne=t.find(ge=>ge.id===D.winner_live_cart_id),pe=!!(ne!=null&&ne.bag_number&&(ne!=null&&ne.label_printed_at));await ce.from("live_carts").update({raffle_prize:ue.name,raffle_name:`Sorteio - ${ue.name}`,needs_label_reprint:pe}).eq("id",D.winner_live_cart_id)}await ce.from("live_raffles").update({gift_id:q}).eq("id",D.id),de.success("Brinde atualizado com sucesso"),L(null),X(""),N(),E(),r==null||r()}catch(ue){console.error("Error updating raffle:",ue),de.error("Erro ao atualizar brinde")}finally{M(!1)}}},I=async()=>{if(F){if(C(F)){de.error("Este pedido j foi pago. Cancelamento no  permitido."),S(null);return}M(!0);try{if(F.status==="applied"){await ce.from("order_gifts").delete().eq("applied_by_raffle_id",F.id),F.gift_id&&await ce.rpc("decrement_gift_stock",{p_gift_id:F.gift_id,p_qty:-1});const ue=t.find(pe=>pe.id===F.winner_live_cart_id),ne=!!(ue!=null&&ue.bag_number&&(ue!=null&&ue.label_printed_at));await ce.from("live_carts").update({is_raffle_winner:!1,raffle_name:null,raffle_prize:null,raffle_applied:!1,needs_label_reprint:ne}).eq("id",F.winner_live_cart_id)}await ce.from("live_raffles").update({status:"cancelled"}).eq("id",F.id),de.success("Sorteio cancelado"),S(null),N(),E(),r==null||r()}catch(ue){console.error("Error canceling raffle:",ue),de.error("Erro ao cancelar sorteio")}finally{M(!1)}}},U=t.filter(ue=>!(!(ue.items||[]).some(pe=>["reservado","confirmado"].includes(pe.status))||u&&ue.status!=="pago"||ue.status==="cancelado")),$=async()=>{var ge,Ne,_e;if(!d){de.error("Selecione um brinde para sortear");return}if(U.length===0){de.error("No h sacolas elegveis para o sorteio");return}const ue=a.find(be=>be.id===d);if(!ue)return;if(!ue.unlimited_stock&&ue.stock_qty<1){de.error(`Brinde "${ue.name}" sem estoque!`);return}m(!0),g("spinning"),await new Promise(be=>setTimeout(be,3e3));const ne=Math.floor(Math.random()*U.length),pe=U[ne];try{const{data:be}=await ce.auth.getSession(),{data:Me,error:Se}=await ce.from("live_raffles").insert({live_event_id:e,gift_id:d,winner_live_cart_id:pe.id,winner_bag_number:pe.bag_number,winner_instagram_handle:(ge=pe.live_customer)==null?void 0:ge.instagram_handle,created_by:(_e=(Ne=be==null?void 0:be.session)==null?void 0:Ne.user)==null?void 0:_e.id,status:"pending"}).select().single();if(Se)throw Se;const $e={cart:pe,gift:ue,raffleId:Me.id};O.current=$e,x($e),g("winner_revealed"),N()}catch(be){console.error("Error recording raffle:",be),de.error("Erro ao registrar o sorteio"),m(!1),g("idle")}},Y=async()=>{var ne;const ue=v||O.current;if(ue){g("applying_prize");try{const{cart:pe,gift:ge,raffleId:Ne}=ue,{error:_e}=await ce.from("order_gifts").insert({live_cart_id:pe.id,gift_id:ge.id,qty:1,status:"pending_separation",applied_by_raffle_id:Ne});if(_e)throw _e;await ce.rpc("decrement_gift_stock",{p_gift_id:ge.id,p_qty:1});const be=!!(pe.bag_number&&pe.label_printed_at);await ce.from("live_carts").update({is_raffle_winner:!0,raffle_name:`Sorteio - ${ge.name}`,raffle_prize:ge.name,raffle_applied:!0,needs_label_reprint:be}).eq("id",pe.id),await ce.from("live_raffles").update({status:"applied",applied_at:new Date().toISOString()}).eq("id",Ne),de.success(` Prmio aplicado! ${(ne=pe.live_customer)==null?void 0:ne.instagram_handle} ganhou ${ge.name}!`),g("done"),N(),E(),r==null||r()}catch(pe){console.error("Error applying prize:",pe),de.error("Erro ao aplicar o prmio"),g("winner_revealed")}}},Z=()=>{m(!1),x(null),O.current=null,g("idle")},re=ue=>{E(),l(ue)},G=a.find(ue=>ue.id===d),J=v||O.current,V=ue=>{switch(ue.status){case"pending":return n.jsx(Ae,{variant:"outline",className:"bg-amber-100 text-amber-800 border-amber-300",children:"Pendente"});case"applied":return n.jsx(Ae,{variant:"outline",className:"bg-green-100 text-green-800 border-green-300",children:"Aplicado"});case"cancelled":return n.jsx(Ae,{variant:"outline",className:"bg-red-100 text-red-800 border-red-300",children:"Cancelado"});default:return null}};return n.jsxs(n.Fragment,{children:[n.jsxs(De,{children:[n.jsxs(Ot,{children:[n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(ga,{className:"h-5 w-5 text-amber-500"}),"Sorteio ao Vivo"]}),n.jsx(Ai,{children:"Sorteie brindes entre as sacolas da live"})]}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Brinde para sortear"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(Kt,{value:d,onValueChange:l,children:[n.jsx(Vt,{className:"flex-1",children:n.jsx(Xt,{placeholder:"Selecione um brinde cadastrado"})}),n.jsx(qt,{className:"bg-background z-50",children:o?n.jsxs("div",{className:"p-3 text-center text-sm text-muted-foreground",children:[n.jsx(At,{className:"h-4 w-4 animate-spin mx-auto mb-1"}),"Carregando..."]}):a.length===0?n.jsx("div",{className:"p-3 text-center text-sm text-muted-foreground",children:"Nenhum brinde disponvel"}):a.map(ue=>n.jsx(ze,{value:ue.id,children:n.jsxs("span",{className:"flex items-center gap-2",children:[ue.image_url?n.jsx("img",{src:ue.image_url,alt:"",className:"w-5 h-5 rounded object-cover"}):n.jsx(Rn,{className:"h-4 w-4"}),ue.name,!ue.unlimited_stock&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",ue.stock_qty," disponveis)"]})]})},ue.id))})]}),n.jsx(he,{variant:"outline",size:"icon",onClick:()=>T(!0),title:"Criar novo brinde",children:n.jsx(An,{className:"h-4 w-4"})}),n.jsx(he,{variant:"ghost",size:"icon",onClick:E,title:"Atualizar lista",children:n.jsx(en,{className:"h-4 w-4"})})]})]}),G&&n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg flex items-center gap-3",children:[G.image_url?n.jsx("img",{src:G.image_url,alt:G.name,className:"w-12 h-12 rounded object-cover"}):n.jsx("div",{className:"w-12 h-12 rounded bg-muted flex items-center justify-center",children:n.jsx(Rn,{className:"h-6 w-6 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium",children:G.name}),n.jsx("div",{className:"text-sm text-muted-foreground",children:G.unlimited_stock?"Estoque ilimitado":`${G.stock_qty} disponveis`})]})]}),n.jsx("div",{className:"flex items-center gap-4",children:n.jsxs("label",{className:"flex items-center gap-2 text-sm cursor-pointer",children:[n.jsx("input",{type:"checkbox",checked:u,onChange:ue=>h(ue.target.checked),className:"rounded border-input"}),"Apenas sacolas pagas"]})}),n.jsx("div",{className:"p-3 bg-secondary/50 rounded-lg",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Sacolas elegveis:"}),n.jsx(Ae,{variant:"secondary",className:"text-lg font-bold",children:U.length})]})}),n.jsx(he,{onClick:$,disabled:p!=="idle"||!d||U.length===0,className:"w-full gap-2 h-12 text-lg",size:"lg",children:p!=="idle"?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-5 w-5 animate-spin"}),"Sorteando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(Wr,{className:"h-5 w-5"}),"Sortear Agora"]})}),y.length>0&&n.jsxs("div",{className:"pt-4 border-t space-y-2",children:[n.jsx("h4",{className:"text-sm font-medium",children:"Sorteios desta live"}),n.jsx("div",{className:"space-y-2",children:y.map(ue=>{var ge,Ne;const ne=C(ue),pe=ue.status==="cancelled";return n.jsxs("div",{className:`flex items-center gap-2 p-2 rounded text-sm ${pe?"bg-secondary/20 opacity-60":"bg-secondary/30"}`,children:[n.jsx(ga,{className:`h-4 w-4 shrink-0 ${pe?"text-muted-foreground":"text-amber-500"}`}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("span",{className:`font-medium ${pe?"line-through":""}`,children:["@",(ge=ue.winner_instagram_handle)==null?void 0:ge.replace(/^@/,"")]}),ue.winner_bag_number&&n.jsxs("span",{className:"text-muted-foreground ml-1",children:["(Sacola #",ue.winner_bag_number,")"]})]}),n.jsx(Ae,{variant:"outline",className:"shrink-0",children:((Ne=ue.gift)==null?void 0:Ne.name)||"Brinde"}),V(ue),!pe&&n.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[n.jsx(he,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{if(ne){de.error("Este pedido j foi pago. Ajustes no so permitidos.");return}L(ue),X(ue.gift_id||"")},title:ne?"Pedido pago - no pode editar":"Editar brinde",disabled:ne,children:n.jsx(ea,{className:"h-3.5 w-3.5"})}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive hover:text-destructive",onClick:()=>{if(ne){de.error("Este pedido j foi pago. Cancelamento no  permitido.");return}S(ue)},title:ne?"Pedido pago - no pode cancelar":"Cancelar sorteio",disabled:ne,children:n.jsx(qn,{className:"h-3.5 w-3.5"})})]}),ne&&n.jsx(Ae,{variant:"secondary",className:"shrink-0 text-xs",children:"Pago"})]},ue.id)})})]})]})]}),n.jsx(M5e,{open:j,onClose:()=>T(!1),onCreated:re}),n.jsx(cn,{open:!!D,onOpenChange:ue=>!ue&&L(null),children:n.jsxs(sn,{className:"sm:max-w-md",children:[n.jsx(fn,{children:n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(ea,{className:"h-5 w-5"}),"Editar Brinde do Sorteio"]})}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsxs("div",{className:"p-3 bg-secondary/50 rounded-lg",children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Ganhadora:"}),n.jsxs("p",{className:"font-medium",children:["@",(W=D==null?void 0:D.winner_instagram_handle)==null?void 0:W.replace(/^@/,"")]}),(D==null?void 0:D.winner_bag_number)&&n.jsxs("p",{className:"text-sm text-muted-foreground",children:["Sacola #",D.winner_bag_number]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Novo brinde"}),n.jsxs(Kt,{value:q,onValueChange:X,children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecione um brinde"})}),n.jsx(qt,{className:"bg-background z-50",children:a.map(ue=>n.jsx(ze,{value:ue.id,children:n.jsxs("span",{className:"flex items-center gap-2",children:[ue.image_url?n.jsx("img",{src:ue.image_url,alt:"",className:"w-5 h-5 rounded object-cover"}):n.jsx(Rn,{className:"h-4 w-4"}),ue.name,!ue.unlimited_stock&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",ue.stock_qty," disp.)"]})]})},ue.id))})]})]})]}),n.jsxs(Da,{children:[n.jsx(he,{variant:"outline",onClick:()=>L(null),disabled:H,children:"Cancelar"}),n.jsx(he,{onClick:k,disabled:!q||q===(D==null?void 0:D.gift_id)||H,children:H?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}),"Salvando..."]}):"Salvar"})]})]})}),n.jsx(Ac,{open:!!F,onOpenChange:ue=>!ue&&S(null),children:n.jsxs(Dl,{children:[n.jsxs(Ll,{children:[n.jsx(Bl,{children:"Cancelar Sorteio?"}),n.jsxs($l,{children:["Deseja cancelar este sorteio?",(F==null?void 0:F.status)==="applied"&&n.jsxs(n.Fragment,{children:["O brinde ser removido da sacola de"," ",n.jsxs("strong",{children:["@",(ee=F==null?void 0:F.winner_instagram_handle)==null?void 0:ee.replace(/^@/,"")]}),"."]}),(F==null?void 0:F.status)==="pending"&&n.jsxs(n.Fragment,{children:["O sorteio pendente de"," ",n.jsxs("strong",{children:["@",(ie=F==null?void 0:F.winner_instagram_handle)==null?void 0:ie.replace(/^@/,"")]})," ser cancelado."]}),n.jsx("br",{}),n.jsx("br",{}),"Esta ao no pode ser desfeita."]})]}),n.jsxs(Tc,{children:[n.jsx(Oc,{disabled:H,children:"Manter"}),n.jsx(Pc,{onClick:I,disabled:H,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:H?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}),"Cancelando..."]}):"Sim, Cancelar Sorteio"})]})]})}),n.jsx(cn,{open:f,onOpenChange:ue=>{!ue&&p==="done"&&Z()},children:n.jsx(sn,{className:"sm:max-w-lg p-0 overflow-hidden border-0 bg-transparent shadow-none",onPointerDownOutside:ue=>{ue.preventDefault()},onEscapeKeyDown:ue=>{ue.preventDefault()},children:n.jsxs("div",{className:"bg-gradient-to-br from-[#faf8f5] via-white to-[#f5f0eb] rounded-2xl overflow-hidden shadow-2xl border border-amber-100",children:[n.jsx("div",{className:"px-6 py-4 bg-gradient-to-r from-amber-50 to-amber-100/50 border-b border-amber-200/50 flex justify-center",children:n.jsx("img",{src:hd,alt:"LE.PO",className:"h-10 object-contain"})}),n.jsx("div",{className:"p-8 text-center space-y-6",children:n.jsxs(USe,{mode:"wait",children:[p==="spinning"&&n.jsxs(si.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"space-y-6",children:[n.jsx(si.div,{animate:{rotate:360},transition:{duration:.8,repeat:1/0,ease:"linear"},className:"w-28 h-28 mx-auto rounded-full bg-gradient-to-br from-amber-100 to-amber-200 flex items-center justify-center shadow-lg border-4 border-white",children:n.jsx(Rn,{className:"h-14 w-14 text-amber-600"})}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("h2",{className:"text-2xl font-serif text-amber-900",children:"Sorteando..."}),n.jsx("p",{className:"text-sm text-amber-700/70",children:"Selecionando a ganhadora"})]}),n.jsx("div",{className:"flex flex-wrap justify-center gap-1.5 max-h-24 overflow-hidden px-4",children:U.slice(0,15).map((ue,ne)=>{var pe,ge;return n.jsx(si.div,{animate:{scale:[1,1.15,1],opacity:[.4,1,.4]},transition:{duration:.25,delay:ne*.06%.9,repeat:1/0},className:"px-2.5 py-1 bg-amber-100 rounded-full text-xs font-medium text-amber-800",children:(ge=(pe=ue.live_customer)==null?void 0:pe.instagram_handle)==null?void 0:ge.replace(/^@/,"")},ue.id)})})]},"spinning"),p==="winner_revealed"&&J&&n.jsxs(si.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",bounce:.4,duration:.6},className:"space-y-6",children:[n.jsxs(si.div,{initial:{y:-30,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"relative",children:[n.jsx(si.div,{animate:{scale:[1,1.05,1]},transition:{duration:1.5,repeat:1/0},className:"w-32 h-32 mx-auto rounded-full bg-gradient-to-br from-amber-300 via-amber-400 to-amber-500 flex items-center justify-center shadow-xl border-4 border-white",children:n.jsx(ga,{className:"h-16 w-16 text-white drop-shadow-lg"})}),[...Array(6)].map((ue,ne)=>n.jsx(si.div,{initial:{scale:0,x:0,y:0,opacity:0},animate:{scale:[0,1.2,0],x:Math.cos(ne*Math.PI/3)*70,y:Math.sin(ne*Math.PI/3)*70,opacity:[0,1,0]},transition:{delay:.3,duration:.8},className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:n.jsx(Wr,{className:"h-5 w-5 text-amber-400"})},ne))]}),n.jsxs(si.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"space-y-4",children:[n.jsx("h2",{className:"text-xl font-serif text-amber-800",children:" Temos uma vencedora! "}),n.jsxs("div",{className:"p-5 bg-gradient-to-br from-amber-50 to-white rounded-xl border border-amber-200 shadow-md space-y-3",children:[n.jsxs("div",{className:"text-3xl font-bold text-amber-900 tracking-tight",children:["@",(se=(oe=J.cart.live_customer)==null?void 0:oe.instagram_handle)==null?void 0:se.replace(/^@/,"")]}),J.cart.bag_number&&n.jsxs("div",{className:"flex items-center justify-center gap-2 text-amber-700",children:[n.jsx(ln,{className:"h-4 w-4"}),n.jsxs("span",{className:"font-medium",children:["Sacola #",String(J.cart.bag_number).padStart(3,"0")]})]})]}),n.jsxs("div",{className:"flex items-center justify-center gap-2 text-lg",children:[n.jsx("span",{className:"text-2xl",children:""}),n.jsxs("span",{className:"text-amber-800",children:["Ganhou: ",n.jsx("strong",{className:"text-amber-900",children:J.gift.name})]})]})]}),n.jsxs(si.div,{initial:{y:10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.6},className:"flex flex-col gap-3",children:[n.jsxs(he,{onClick:Y,className:"gap-2 px-8 bg-amber-600 hover:bg-amber-700 text-white shadow-lg",size:"lg",children:[n.jsx(Rn,{className:"h-4 w-4"}),"Aplicar prmio no carrinho"]}),n.jsx(he,{onClick:Z,variant:"ghost",className:"text-amber-700 hover:text-amber-900",children:"Fechar (no aplicar)"}),n.jsx("p",{className:"text-xs text-amber-600/70",children:"O sorteio ficar como pendente na lista"})]})]},"winner_revealed"),p==="applying_prize"&&J&&n.jsxs(si.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-6",children:[n.jsx("div",{className:"w-28 h-28 mx-auto rounded-full bg-gradient-to-br from-amber-100 to-amber-200 flex items-center justify-center shadow-lg border-4 border-white",children:n.jsx(At,{className:"h-14 w-14 text-amber-600 animate-spin"})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("h2",{className:"text-xl font-serif text-amber-900",children:"Aplicando prmio..."}),n.jsx("p",{className:"text-sm text-amber-700/70",children:"Adicionando brinde ao carrinho"})]})]},"applying"),p==="done"&&J&&n.jsxs(si.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",bounce:.3},className:"space-y-6",children:[n.jsx(si.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",delay:.1},className:"w-28 h-28 mx-auto rounded-full bg-gradient-to-br from-green-400 to-green-500 flex items-center justify-center shadow-xl border-4 border-white",children:n.jsx(xn,{className:"h-14 w-14 text-white"})}),n.jsxs("div",{className:"space-y-4",children:[n.jsx("h2",{className:"text-xl font-serif text-green-800",children:"Prmio aplicado! "}),n.jsxs("div",{className:"p-4 bg-green-50 rounded-xl border border-green-200",children:[n.jsxs("p",{className:"text-green-800",children:[n.jsxs("strong",{children:["@",(ye=(le=J.cart.live_customer)==null?void 0:le.instagram_handle)==null?void 0:ye.replace(/^@/,"")]})," ","ganhou"," ",n.jsx("strong",{children:J.gift.name})]}),n.jsx("p",{className:"text-sm text-green-600 mt-1",children:"O brinde foi adicionado ao carrinho e aparecer na separao"})]})]}),n.jsxs(he,{onClick:Z,className:"gap-2 px-8 bg-green-600 hover:bg-green-700 text-white shadow-lg",size:"lg",children:[n.jsx(xn,{className:"h-4 w-4"}),"Fechar"]})]},"done")]})})]})})})]})}function KY({history:e,isLoading:t}){const r=i=>Ht(new Date(i),"dd/MM 's' HH:mm",{locale:gr}),s=i=>({aberto:{label:"Aberto",color:"bg-blue-100 text-blue-700",icon:zi},em_confirmacao:{label:"Confirmando",color:"bg-amber-100 text-amber-700",icon:Br},aguardando_pagamento:{label:"Aguardando",color:"bg-orange-100 text-orange-700",icon:Br},pago:{label:"Pago",color:"bg-green-100 text-green-700",icon:Er},cancelado:{label:"Cancelado",color:"bg-red-100 text-red-700",icon:qn},expirado:{label:"Expirado",color:"bg-gray-100 text-gray-600",icon:Br}})[i]||{label:i,color:"bg-gray-100 text-gray-600",icon:gw},a=i=>{if(!i)return xs;const o=i.toLowerCase();return o.includes("dinheiro")?Wz:o.includes("loja")?pa:(o.includes("pix"),xs)};return t?n.jsx("div",{className:"flex items-center justify-center py-4",children:n.jsx(At,{className:"h-5 w-5 animate-spin text-muted-foreground"})}):e.length===0?null:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-muted-foreground",children:[n.jsx(gw,{className:"h-4 w-4"}),"Histrico de Status"]}),n.jsx("div",{className:"space-y-2",children:e.map((i,o)=>{const c=s(i.new_status),d=i.old_status?s(i.old_status):null,l=a(i.payment_method);return n.jsxs("div",{className:"flex items-start gap-3 p-2.5 rounded-lg bg-muted/50 text-sm",children:[n.jsxs("div",{className:"flex flex-col items-center shrink-0",children:[n.jsx("div",{className:`w-2 h-2 rounded-full ${i.new_status==="pago"?"bg-green-500":i.new_status==="cancelado"?"bg-red-500":"bg-primary"}`}),o<e.length-1&&n.jsx("div",{className:"w-0.5 h-full bg-border mt-1"})]}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[d&&n.jsxs(n.Fragment,{children:[n.jsx(Ae,{variant:"outline",className:`${d.color} text-xs`,children:d.label}),n.jsx(ps,{className:"h-3 w-3 text-muted-foreground"})]}),n.jsx(Ae,{variant:"outline",className:`${c.color} text-xs`,children:c.label}),i.payment_method&&n.jsxs("span",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[n.jsx(l,{className:"h-3 w-3"}),i.payment_method]})]}),i.notes&&n.jsx("p",{className:"text-xs text-muted-foreground mt-0.5 truncate",children:i.notes}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r(i.created_at)})]})]},i.id)})})]})}function XY(e){const[t,r]=P.useState([]),[s,a]=P.useState(!0),[i,o]=P.useState({status:"all",priority:"all",type:"all",liveEventId:e||"",search:"",assignedTo:""}),c=P.useCallback(async()=>{a(!0);let g=ce.from("live_pendencias").select(`
        *,
        live_cart:live_carts(
          bag_number,
          total,
          live_customer:live_customers(instagram_handle, nome)
        ),
        live_event:live_events(titulo)
      `).order("created_at",{ascending:!1});i.liveEventId&&(g=g.eq("live_event_id",i.liveEventId)),i.status!=="all"&&(g=g.eq("status",i.status)),i.priority!=="all"&&(g=g.eq("priority",i.priority)),i.type!=="all"&&(g=g.eq("type",i.type)),i.assignedTo&&(g=g.eq("assigned_to",i.assignedTo));const{data:v,error:x}=await g;if(x){console.error("Error fetching pendencias:",x),de.error("Erro ao carregar pendncias");return}let y=v||[];if(i.search){const b=i.search.toLowerCase();y=y.filter(j=>{var T,O,R,D,L,q,X,H,M,F;return((T=j.title)==null?void 0:T.toLowerCase().includes(b))||((O=j.description)==null?void 0:O.toLowerCase().includes(b))||((L=(D=(R=j.live_cart)==null?void 0:R.live_customer)==null?void 0:D.instagram_handle)==null?void 0:L.toLowerCase().includes(b))||((H=(X=(q=j.live_cart)==null?void 0:q.live_customer)==null?void 0:X.nome)==null?void 0:H.toLowerCase().includes(b))||((F=(M=j.live_cart)==null?void 0:M.bag_number)==null?void 0:F.toString().includes(b))})}r(y),a(!1)},[i]);P.useEffect(()=>{c()},[c]);const d=async g=>{const{data:v}=await ce.from("live_pendencias").select("id").eq("live_cart_id",g.live_cart_id).eq("type",g.type||"observacao_cliente").maybeSingle();if(v){const{error:x}=await ce.from("live_pendencias").update({title:g.title,description:g.description,priority:g.priority||"media",updated_at:new Date().toISOString()}).eq("id",v.id);return x?(de.error("Erro ao atualizar pendncia"),null):(de.success("Pendncia atualizada!"),c(),v.id)}else{const{data:x,error:y}=await ce.from("live_pendencias").insert({live_cart_id:g.live_cart_id,live_event_id:g.live_event_id,live_customer_id:g.live_customer_id,type:g.type||"observacao_cliente",title:g.title,description:g.description,priority:g.priority||"media",status:"aberta"}).select("id").single();return y?(console.error("Error creating pendencia:",y),de.error("Erro ao criar pendncia"),null):(de.success("Pendncia criada!"),c(),x.id)}},l=async(g,v)=>{const x={status:v};v==="resolvida"&&(x.resolved_at=new Date().toISOString());const{error:y}=await ce.from("live_pendencias").update(x).eq("id",g);return y?(de.error("Erro ao atualizar status"),!1):(de.success(`Status atualizado para ${v}`),c(),!0)},u=async(g,v)=>{const{error:x}=await ce.from("live_pendencias").update({assigned_to:v}).eq("id",g);return x?(de.error("Erro ao atribuir responsvel"),!1):(de.success("Responsvel atribudo!"),c(),!0)},h=async(g,v)=>{const{error:x}=await ce.from("live_pendencias").update({due_date:v}).eq("id",g);return x?(de.error("Erro ao definir prazo"),!1):(de.success("Prazo definido!"),c(),!0)},f=async g=>{const{data:v,error:x}=await ce.from("live_pendencias").select("*").eq("live_cart_id",g).maybeSingle();return x?(console.error("Error fetching pendencia:",x),null):v},m=t.filter(g=>g.status==="aberta").length,p=t.filter(g=>g.status==="em_andamento").length;return{pendencias:t,isLoading:s,filters:i,setFilters:o,fetchPendencias:c,upsertPendencia:d,updateStatus:l,assignTo:u,setDueDate:h,getPendenciaForCart:f,countOpen:m,countInProgress:p}}function D5e({cart:e,onClose:t,onRemoveItem:r,onReduceQuantity:s,onCancelCart:a,products:i,onWaitlistOffer:o,cartHistory:c,historyLoading:d}){var S;const[l,u]=P.useState((e==null?void 0:e.customer_live_notes)||""),[h,f]=P.useState(!1),[m,p]=P.useState(!1),[g,v]=P.useState(!1),[x,y]=P.useState(null),{upsertPendencia:b,getPendenciaForCart:j}=XY();P.useEffect(()=>{e&&(u(e.customer_live_notes||""),j(e.id).then(y))},[e==null?void 0:e.id,e==null?void 0:e.customer_live_notes]);const T=E=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(E),O=async()=>{if(!e)return;f(!0);const{error:E}=await ce.from("live_carts").update({customer_live_notes:l}).eq("id",e.id);f(!1),E?de.error("Erro ao salvar observaes"):de.success("Observaes salvas!")},R=async()=>{var I;if(!e)return;p(!0);const{error:E}=await ce.from("live_carts").update({customer_live_notes:l}).eq("id",e.id);if(E){de.error("Erro ao salvar observaes"),p(!1);return}const N=e.bag_number?`#${String(e.bag_number).padStart(3,"0")}`:"",C=((I=e.live_customer)==null?void 0:I.instagram_handle)||"cliente";await b({live_cart_id:e.id,live_event_id:e.live_event_id,live_customer_id:e.live_customer_id,type:"observacao_cliente",title:`Observao ${N} @${C}`,description:l,priority:"media"});const k=await j(e.id);y(k),p(!1)},D=async()=>{e&&confirm("Tem certeza que deseja cancelar este carrinho?")&&(v(!0),await a(e.id),v(!1),t())};if(!e)return null;const L=(e.items||[]).filter(E=>["reservado","confirmado","expirado"].includes(E.status)),q=(e.items||[]).filter(E=>E.status==="cancelado"),X=e.bag_number,H=e.needs_label_reprint,M=e.status!=="pago"&&e.status!=="cancelado",F=()=>{if(!x)return null;switch(x.status){case"aberta":return n.jsxs(Ae,{variant:"outline",className:"border-amber-300 bg-amber-50 text-amber-700 text-xs",children:[n.jsx(Br,{className:"h-3 w-3 mr-1"}),"Pendncia Aberta"]});case"em_andamento":return n.jsxs(Ae,{variant:"outline",className:"border-blue-300 bg-blue-50 text-blue-700 text-xs",children:[n.jsx(Cn,{className:"h-3 w-3 mr-1"}),"Em Andamento"]});case"resolvida":return n.jsxs(Ae,{variant:"outline",className:"border-green-300 bg-green-50 text-green-700 text-xs",children:[n.jsx(Er,{className:"h-3 w-3 mr-1"}),"Resolvida"]})}};return n.jsx(cn,{open:!!e,onOpenChange:()=>t(),children:n.jsxs(sn,{className:"w-[95vw] max-w-lg max-h-[85vh] flex flex-col p-0 gap-0",children:[n.jsx(fn,{className:"px-4 sm:px-6 pt-4 sm:pt-6 pb-3 border-b shrink-0",children:n.jsxs(dn,{className:"flex items-center gap-2 flex-wrap text-base sm:text-lg",children:[n.jsxs("span",{className:"truncate",children:["Carrinho de ",(S=e.live_customer)==null?void 0:S.instagram_handle]}),e.is_raffle_winner&&n.jsxs(Ae,{className:"bg-amber-500 text-white gap-1 shrink-0 text-xs",children:[n.jsx(ga,{className:"h-3 w-3"}),"Ganhadora"]}),H&&n.jsxs(Ae,{variant:"outline",className:"gap-1 text-amber-600 border-amber-300 shrink-0 text-xs",children:[n.jsx(h1,{className:"h-3 w-3"}),"Reimprimir"]})]})}),n.jsx("div",{className:"flex-1 overflow-y-auto px-4 sm:px-6 py-4 min-h-0",children:n.jsxs("div",{className:"space-y-4",children:[X&&M&&n.jsx("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg",children:n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(Cn,{className:"h-4 w-4 text-amber-600 shrink-0 mt-0.5"}),n.jsxs("div",{className:"min-w-0",children:[n.jsxs("span",{className:"text-sm font-medium text-amber-800",children:["Sacola #",String(X).padStart(3,"0")," j tem etiqueta"]}),n.jsx("p",{className:"text-xs text-amber-600 mt-0.5",children:"Se modificar itens, reimprima a etiqueta."})]})]})}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{className:"text-sm text-muted-foreground",children:"Itens do pedido:"}),L.map(E=>{var N,C,k;return n.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-muted/30 rounded-lg",children:[n.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-secondary rounded overflow-hidden shrink-0",children:(N=E.product)!=null&&N.image_url?n.jsx("img",{src:E.product.image_url,alt:E.product.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:(C=E.product)==null?void 0:C.name}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Tam: ",(k=E.variante)==null?void 0:k.tamanho,"  Qtd: ",E.qtd]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("div",{className:"font-medium text-sm",children:T(E.preco_unitario*E.qtd)}),M&&n.jsxs("div",{className:"flex gap-1 justify-end mt-1",children:[E.qtd>1&&n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsx(he,{variant:"ghost",size:"sm",className:"text-muted-foreground h-7 w-7 p-0 hover:text-foreground",onClick:()=>s(E.id),children:n.jsx(vp,{className:"h-3 w-3"})})}),n.jsx(Aa,{children:"Remover 1 unidade"})]}),n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsx(he,{variant:"ghost",size:"sm",className:"text-muted-foreground h-7 w-7 p-0 hover:text-foreground",onClick:async()=>{const I=await r(E.id);if(I.success&&I.waitlistEntry){const U=i.find($=>$.product_id===I.productId);U&&o(I.waitlistEntry,U)}},children:n.jsx(an,{className:"h-3 w-3"})})}),n.jsx(Aa,{children:E.qtd>1?`Remover todas ${E.qtd} unidades`:"Remover (devolve ao estoque)"})]})]})]})]},E.id)}),q.length>0&&n.jsxs("div",{className:"mt-3 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Cn,{className:"h-4 w-4 text-amber-600"}),n.jsx("span",{className:"text-sm font-medium text-amber-800",children:"Itens cancelados - retirar da sacola"})]}),q.map(E=>{var N,C,k;return n.jsxs("div",{className:"flex items-center gap-2 p-2 bg-amber-100/50 rounded mt-1",children:[n.jsx("div",{className:"w-8 h-8 bg-secondary rounded overflow-hidden shrink-0 opacity-60",children:(N=E.product)!=null&&N.image_url?n.jsx("img",{src:E.product.image_url,alt:E.product.name,className:"w-full h-full object-cover"}):n.jsx(Ut,{className:"h-3 w-3 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm text-amber-800 truncate line-through",children:(C=E.product)==null?void 0:C.name}),n.jsxs("div",{className:"text-xs text-amber-600",children:["Tam: ",(k=E.variante)==null?void 0:k.tamanho,"  Qtd: ",E.qtd]})]}),n.jsx(Ae,{variant:"outline",className:"bg-amber-100 text-amber-700 border-amber-300 text-xs shrink-0",children:"Retirar"})]},E.id)})]})]}),n.jsxs("div",{className:"flex justify-between items-center p-3 bg-primary/10 rounded-lg",children:[n.jsx("span",{className:"font-medium",children:"Total"}),n.jsx("span",{className:"text-xl font-bold",children:T(L.reduce((E,N)=>E+N.preco_unitario*N.qtd,0))})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg flex-wrap gap-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Status atual:"}),n.jsxs(Ae,{className:e.status==="pago"?"bg-green-100 text-green-700":e.status==="cancelado"?"bg-red-100 text-red-700":["aguardando_pagamento","em_confirmacao","expirado"].includes(e.status)?"bg-amber-100 text-amber-700":"bg-blue-100 text-blue-700",children:[e.status==="pago"&&" Pago",e.status==="aberto"&&" Aberto",e.status==="aguardando_pagamento"&&" Aguardando pagamento",e.status==="cancelado"&&" Cancelado",e.status==="expirado"&&" Aguardando pagamento",e.status==="em_confirmacao"&&" Confirmando"]})]}),c.length>0&&n.jsx(KY,{history:c,isLoading:d}),n.jsxs("div",{className:"space-y-3 pt-4 border-t",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Le,{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(mw,{className:"h-4 w-4"}),"Observaes da Cliente"]}),F()]}),n.jsx(Yn,{placeholder:"Ex: blusa branca  presente  look viagem",value:l,onChange:E=>u(E.target.value),className:"min-h-[60px] text-sm resize-none",style:{height:"auto",minHeight:"60px"},onInput:E=>{const N=E.target;N.style.height="auto",N.style.height=`${Math.min(N.scrollHeight,150)}px`}})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[n.jsx(he,{variant:"default",className:"flex-1 h-11",onClick:R,disabled:m||!l.trim(),children:m?"Salvando...":x?"Atualizar Pendncia":"Salvar e Criar Pendncia"}),n.jsx(he,{variant:"outline",className:"flex-1 h-11",onClick:O,disabled:h,children:h?"Salvando...":"Salvar apenas no pedido"})]}),(e==null?void 0:e.is_raffle_winner)&&n.jsxs("div",{className:"p-3 bg-amber-50 rounded-lg border border-amber-200",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ga,{className:"h-4 w-4 text-amber-600"}),n.jsx("span",{className:"text-sm font-medium text-amber-800",children:"Ganhadora de Sorteio"})]}),e.raffle_name&&n.jsx("p",{className:"text-xs text-amber-700 mt-1",children:e.raffle_name}),e.raffle_prize&&n.jsxs("p",{className:"text-xs text-amber-600 mt-0.5",children:[" ",e.raffle_prize]})]})]}),M&&n.jsxs(he,{variant:"outline",className:"w-full gap-1 text-destructive border-destructive/20 hover:bg-destructive/10 h-11",disabled:g,onClick:D,children:[n.jsx(qn,{className:"h-4 w-4"}),"Cancelar Carrinho"]})]})})]})})}function L5e(){var jr,br,Nr;const{eventId:e}=ra(),t=fr(),{event:r,products:s,kpis:a,isLoading:i,fetchEvent:o}=nj(e),{updateEventStatus:c}=rj(),[d,l]=P.useState(!1),{customers:u,carts:h,waitlist:f,isLoading:m,quickLaunch:p,removeCartItem:g,reduceItemQuantity:v,cancelItemForSeparation:x,addToWaitlist:y,allocateFromWaitlist:b,skipWaitlistEntry:j,endWaitlistQueue:T,getWaitlistCount:O,getNextWaitlistEntry:R,checkCustomerHasProduct:D,fetchBackstageData:L,generatePaymentLink:q,updateCartStatus:X,fetchCartStatusHistory:H}=S5e(e,d),[M,F]=P.useState(""),[S,E]=P.useState(""),[N,C]=P.useState(""),[k,I]=P.useState(""),[U,$]=P.useState(1),[Y,Z]=P.useState(""),[re,G]=P.useState(""),[J,V]=P.useState("all"),[W,ee]=P.useState(!1),[ie,oe]=P.useState(!1),[se,le]=P.useState(null),[ye,ue]=P.useState(null),[ne,pe]=P.useState(null),[ge,Ne]=P.useState(null),[_e,be]=P.useState(!1),[Me,Se]=P.useState(null),[$e,Ke]=P.useState(!1),[Ze,it]=P.useState("lancador");P.useState(null);const[Re,ot]=P.useState(!1);P.useState(!1);const[ut,bt]=P.useState(null),[Je,Ce]=P.useState([]),[Ge,Pe]=P.useState(!1),[Ve,st]=P.useState({}),xt=P.useMemo(()=>{const et=h.filter(Qt=>Qt.status!=="cancelado"),Tt=new Set;let rr=0,nr=0;return et.forEach(Qt=>{const Ee=Qt.items||[];let Xe=!1;Ee.forEach(dt=>{["reservado","confirmado"].includes(dt.status)&&(rr+=dt.qtd,nr+=dt.preco_unitario*dt.qtd,Xe=!0)}),Xe&&Tt.add(Qt.live_customer_id)}),{totalItems:rr,totalCustomers:Tt.size,totalValue:nr}},[h]);P.useEffect(()=>{const et={};h.forEach(Tt=>{(Tt.items||[]).forEach(rr=>{var nr;if(["reservado","confirmado"].includes(rr.status)){const Qt=rr.product_id,Ee=((nr=rr.variante)==null?void 0:nr.tamanho)||"";et[Qt]||(et[Qt]={}),et[Qt][Ee]=(et[Qt][Ee]||0)+rr.qtd}})}),st(et)},[h]),P.useEffect(()=>{if(se){const et=h.find(Tt=>Tt.id===se.id);et&&JSON.stringify(et)!==JSON.stringify(se)&&le(et)}},[h,se]),P.useEffect(()=>{se?(Pe(!0),H(se.id).then(et=>{Ce(et),Pe(!1)})):Ce([])},[se==null?void 0:se.id]);const fe=et=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(et),Ie=(et,Tt,rr)=>Math.max(0,rr),tt=async()=>{if(!M.trim()||!S||!N){de.error("Preencha todos os campos obrigatrios");return}if(Re){console.log("[handleQuickLaunch] Already in progress, ignoring duplicate click");return}ot(!0),console.log("[handleQuickLaunch] Starting - button disabled");try{const et=await p({instagram_handle:M.trim(),product_id:S,cor:k||void 0,tamanho:N,qtd:U});console.log("[handleQuickLaunch] RPC returned, success:",et),et&&(F(""),C(""),$(1),o())}finally{ot(!1),console.log("[handleQuickLaunch] Complete - button re-enabled")}},lt=async()=>{r&&confirm("Tem certeza que deseja encerrar a live?")&&(await c(r.id,"encerrada"),t(`/dashboard/lives/${r.id}/relatorio`))},It=async et=>ye?await y(ye.productId,{cor:ye.productColor,tamanho:ye.size},et.instagram,et.whatsapp,et.nome,et.observacao):!1,ct=async et=>await b(et),at=async et=>{await j(et);const Tt=f.find(rr=>rr.id!==et&&rr.status==="ativa");if(Tt){const rr=s.find(nr=>nr.product_id===Tt.product_id);pe({waitlistItem:Tt,product:rr||null})}else pe(null)},gt=async(et,Tt)=>{await T(et,Tt),Ne(null)},Yt=(et,Tt)=>f.filter(rr=>{var nr;return rr.product_id===et&&((nr=rr.variante)==null?void 0:nr.tamanho)===Tt}),St=(et,Tt)=>{pe({waitlistItem:et,product:Tt})},rt=s.find(et=>et.product_id===S),ir=s.filter(et=>{var rr;if(!Y)return!0;const Tt=et.product;return Tt?Tt.name.toLowerCase().includes(Y.toLowerCase())||((rr=Tt.sku)==null?void 0:rr.toLowerCase().includes(Y.toLowerCase())):!1}),Ct=h.filter(et=>{var Qt,Ee,Xe,dt;const Tt=!re||((Qt=et.live_customer)==null?void 0:Qt.instagram_handle.toLowerCase().includes(re.toLowerCase()))||((Xe=(Ee=et.live_customer)==null?void 0:Ee.nome)==null?void 0:Xe.toLowerCase().includes(re.toLowerCase())),rr=!!((dt=et.live_customer)!=null&&dt.client_id);return Tt&&(J==="all"||J==="registered"&&rr||J==="new"&&!rr)}),Te=h.filter(et=>{var Tt;return(Tt=et.live_customer)==null?void 0:Tt.client_id}).length,qe=h.filter(et=>{var Tt;return!((Tt=et.live_customer)!=null&&Tt.client_id)}).length,ht=i||m,Pt=et=>{const Tt=et.product;if(!Tt)return null;const rr=Tt.stock_by_size||{},nr=Tt.available_by_size||{},Qt=kp(Object.keys(rr)),Ee=Qt.reduce((Zt,wt)=>Zt+O(et.product_id,wt),0),Xe=Qt.some(Zt=>{const wt=Math.max(0,nr[Zt]||0),Et=O(et.product_id,Zt);return wt>0&&Et>0}),Fe=Qt.reduce((Zt,wt)=>Zt+Math.max(0,nr[wt]||0),0)===0;return n.jsxs("div",{className:`p-3 rounded-lg border transition-colors cursor-pointer ${S===et.product_id?"border-primary bg-primary/5":Xe?"border-amber-300 bg-amber-50/50":Fe?"opacity-60 hover:opacity-100":"hover:bg-muted/50"}`,onClick:()=>{E(et.product_id),I(Tt.color||""),C(""),it("lancador")},children:[n.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[n.jsxs("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-secondary rounded overflow-hidden shrink-0 relative",children:[Tt.image_url?n.jsx("img",{src:Tt.image_url,alt:Tt.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})}),Fe&&n.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:n.jsx("span",{className:"text-[8px] sm:text-[10px] font-bold text-white",children:"ESGOTADO"})})]}),n.jsxs("div",{className:"flex-1 min-w-0 overflow-hidden",children:[n.jsx("div",{className:"font-medium text-sm leading-tight truncate",children:Tt.name}),n.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:[km(et.live_discount_type,et.live_discount_value)?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-destructive font-medium",children:fe(fx(Tt.price,et.live_discount_type,et.live_discount_value))}),n.jsx("span",{className:"line-through ml-1 opacity-60",children:fe(Tt.price)})]}):fe(Tt.price),Tt.color&&n.jsxs("span",{className:"hidden sm:inline",children:["  ",Tt.color]})]}),n.jsxs("div",{className:"flex items-center gap-1 mt-1 flex-wrap",children:[km(et.live_discount_type,et.live_discount_value)&&n.jsx(Ae,{className:"text-[10px] px-1.5 py-0 h-4 bg-destructive text-destructive-foreground",children:SH(et.live_discount_type,et.live_discount_value)}),et.visibilidade==="exclusivo_live"&&n.jsx(Ae,{variant:"secondary",className:"text-[10px] px-1.5 py-0 h-4",children:"Exclusivo"})]})]}),n.jsx(he,{variant:"ghost",size:"icon",className:"h-8 w-8 shrink-0",onClick:Zt=>{Zt.stopPropagation(),Se(et)},children:n.jsx(ea,{className:"h-3.5 w-3.5"})})]}),n.jsx("div",{className:"flex flex-wrap gap-1.5 mt-2",children:Qt.map(Zt=>{const wt=Math.max(0,nr[Zt]||0),Et=wt<=0,kr=O(et.product_id,Zt),Jt=wt>0&&kr>0;return n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsxs("button",{className:`px-2 py-0.5 rounded text-xs font-medium transition-colors ${Jt?"bg-amber-500 text-white animate-pulse":Et?"bg-destructive/10 text-destructive line-through":wt<=2?"bg-amber-100 text-amber-700":"bg-secondary text-foreground hover:bg-primary hover:text-primary-foreground"}`,onClick:tr=>{tr.stopPropagation(),kr>0?Ne({productId:et.product_id,productName:Tt.name,productColor:Tt.color||void 0,size:Zt}):Et?ue({productId:et.product_id,productName:Tt.name,productColor:Tt.color||void 0,size:Zt}):(E(et.product_id),I(Tt.color||""),C(Zt),it("lancador"))},children:[Zt,kr>0&&n.jsxs("span",{className:"ml-1",children:["(",kr,")"]})]})}),n.jsx(Aa,{children:Jt?` Estoque liberado! ${kr} na fila`:kr>0?`Esgotado - ${kr} na lista de espera`:Et?"Esgotado - Clique para lista de espera":`${wt} disponveis`})]},Zt)})}),Ee>0&&n.jsxs("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-dashed",children:[n.jsxs("div",{className:"flex items-center gap-1 text-xs text-amber-700",children:[n.jsx(Fi,{className:"h-3 w-3"}),n.jsxs("span",{children:[Ee," na lista de espera"]})]}),Xe&&n.jsx(Ae,{className:"bg-amber-500 text-white text-xs animate-pulse",children:"Estoque liberado!"})]})]},et.id)},vt=()=>n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"@ do Instagram *"}),n.jsx(Qe,{placeholder:"@cliente",value:M,onChange:et=>F(et.target.value),onKeyDown:et=>{et.key==="Enter"&&M.trim()&&S&&N&&(et.preventDefault(),tt())},className:"text-lg"})]}),rt!=null&&rt.product?n.jsx("div",{className:"p-3 bg-muted/50 rounded-lg",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-12 h-12 bg-secondary rounded overflow-hidden shrink-0",children:rt.product.image_url?n.jsx("img",{src:rt.product.image_url,alt:rt.product.name,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"font-medium text-sm",children:rt.product.name}),n.jsx("div",{className:"text-xs text-muted-foreground",children:km(rt.live_discount_type,rt.live_discount_value)?n.jsxs(n.Fragment,{children:[n.jsx("span",{className:"text-destructive font-medium",children:fe(fx(rt.product.price,rt.live_discount_type,rt.live_discount_value))}),n.jsx("span",{className:"line-through ml-1 opacity-60",children:fe(rt.product.price)})]}):fe(rt.product.price)})]})]})}):n.jsxs("div",{className:"p-4 border-2 border-dashed rounded-lg text-center text-muted-foreground",children:[n.jsx(Ut,{className:"h-6 w-6 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm",children:"Selecione um produto na aba Produtos"})]}),(rt==null?void 0:rt.product)&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Tamanho *"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{const et=rt.product.stock_by_size||{},Tt=rt.product.available_by_size||{},rr=kp(Object.keys(et));return rr.length===0?n.jsx("p",{className:"text-sm text-muted-foreground italic",children:"Nenhum tamanho cadastrado"}):rr.map(nr=>{const Qt=Math.max(0,Tt[nr]||0),Ee=N===nr,Xe=Qt<=0,dt=O(rt.product_id,nr),Fe=Qt>0&&dt>0;return n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsxs("button",{className:`px-4 py-2 rounded-lg border text-sm font-medium transition-colors ${Fe?"bg-amber-500 text-white border-amber-500 animate-pulse":Xe?"bg-muted text-muted-foreground line-through cursor-pointer hover:bg-destructive/10 hover:text-destructive hover:no-underline":Ee?"bg-primary text-primary-foreground border-primary":"hover:bg-muted"}`,onClick:()=>{dt>0?Ne({productId:rt.product_id,productName:rt.product.name,productColor:rt.product.color||void 0,size:nr}):Xe?ue({productId:rt.product_id,productName:rt.product.name,productColor:rt.product.color||void 0,size:nr}):C(nr)},children:[nr,dt>0?n.jsxs("span",{className:"ml-1 text-xs",children:["(",dt," fila)"]}):Xe?n.jsx("span",{className:"ml-1 text-xs",children:"(esgotado)"}):n.jsxs("span",{className:"ml-1 text-xs opacity-70",children:["(",Qt,")"]})]})}),n.jsx(Aa,{children:Fe?` Estoque liberado! ${dt} na fila - clique para gerenciar`:dt>0?`${dt} na lista de espera - clique para gerenciar`:Xe?"Esgotado - Clique para adicionar  lista de espera":`${Qt} disponveis`})]},nr)})})()})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Quantidade"}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(he,{variant:"outline",size:"icon",onClick:()=>$(et=>Math.max(1,et-1)),children:n.jsx(vp,{className:"h-4 w-4"})}),n.jsx("span",{className:"text-xl font-semibold w-12 text-center",children:U}),n.jsx(he,{variant:"outline",size:"icon",onClick:()=>$(et=>et+1),children:n.jsx(An,{className:"h-4 w-4"})})]})]}),(rt==null?void 0:rt.product)&&N&&n.jsxs("div",{className:"p-4 bg-primary/10 rounded-lg text-center",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"}),n.jsx("div",{className:"text-2xl font-bold text-primary",children:fe(fx(rt.product.price,rt.live_discount_type,rt.live_discount_value)*U)}),km(rt.live_discount_type,rt.live_discount_value)&&n.jsx("div",{className:"text-xs text-muted-foreground line-through mt-1",children:fe(rt.product.price*U)})]}),n.jsx(he,{className:"w-full h-12 text-lg gap-2",onClick:tt,disabled:!M.trim()||!S||!N||Re,children:Re?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-5 w-5 animate-spin"}),"Adicionando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(An,{className:"h-5 w-5"}),"Adicionar ao Carrinho"]})})]}),Dt=et=>{const Tt=window.location.origin,rr=h.find(Qt=>Qt.id===et),nr=rr==null?void 0:rr.public_token;return nr?`${Tt}/live-checkout/${et}?token=${nr}`:`${Tt}/live-checkout/${et}`},_r=et=>{var Ee,Xe;const Tt=(et.items||[]).filter(dt=>["reservado","confirmado"].includes(dt.status)),rr=((Ee=et.live_customer)==null?void 0:Ee.nome)||((Xe=et.live_customer)==null?void 0:Xe.instagram_handle)||"",nr=Dt(et.id);let Qt=`Oi${rr?` ${rr.split(" ")[0]}`:""}! 

`;return Qt+=`Separei seus itens da live pra voc 

`,Tt.forEach(dt=>{var wt,Et,kr,Jt;const Fe=((wt=dt.variante)==null?void 0:wt.tamanho)||"",Zt=((Et=dt.variante)==null?void 0:Et.cor)||((kr=dt.product)==null?void 0:kr.color)||"";Qt+=` ${((Jt=dt.product)==null?void 0:Jt.name)||"Produto"}`,Fe&&(Qt+=` - Tam: ${Fe}`),Zt&&(Qt+=` (${Zt})`),Qt+=` - ${fe(dt.preco_unitario)}
`}),Qt+=`
 Total: ${fe(et.total)}

`,Qt+=`Finalize seu pedido por aqui:
${nr}

`,Qt+="Qualquer ajuste me chama aqui ",Qt},sr=(et,Tt)=>{var Qt,Ee;Tt&&Tt.stopPropagation();const rr=((Ee=(Qt=et.live_customer)==null?void 0:Qt.whatsapp)==null?void 0:Ee.replace(/\D/g,""))||"",nr=_r(et);if(rr){const Xe=`https://wa.me/${rr}?text=${encodeURIComponent(nr)}`;window.open(Xe,"_blank")}else navigator.clipboard.writeText(nr),de.success("Mensagem copiada! Envie pelo Instagram DM.")},or=et=>{const Tt=et.live_customer,rr=et.items||[],nr=rr.filter(Et=>["reservado","confirmado","expirado"].includes(Et.status)),Qt=nr.reduce((Et,kr)=>Et+kr.preco_unitario*kr.qtd,0),Ee={aberto:{label:"Aberto",color:"bg-blue-100 text-blue-700"},em_confirmacao:{label:"Confirmando",color:"bg-amber-100 text-amber-700"},aguardando_pagamento:{label:"Aguardando",color:"bg-orange-100 text-orange-700"},pago:{label:"Pago",color:"bg-green-100 text-green-700"},cancelado:{label:"Cancelado",color:"bg-red-100 text-red-700"},expirado:{label:"Aguardando pagamento",color:"bg-amber-100 text-amber-700"}},Xe=Ee[et.status]||Ee.aberto,dt=et.bag_number,Fe=rr.some(Et=>Et.status==="cancelado"),Zt=et.is_raffle_winner,wt=et.needs_label_reprint;return n.jsxs("div",{className:`p-3 rounded-lg border hover:bg-muted/30 transition-colors cursor-pointer ${Fe?"border-amber-300 bg-amber-50/30":""}`,onClick:()=>le(et),children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsxs("div",{className:"min-w-0 flex-1",children:[n.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[dt&&n.jsxs(Ae,{variant:"outline",className:"text-xs px-1.5 py-0 font-mono shrink-0",children:["#",String(dt).padStart(3,"0")]}),n.jsx("span",{className:"font-medium text-lg truncate",children:Tt==null?void 0:Tt.instagram_handle}),Tt!=null&&Tt.client_id?n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsx("div",{className:"w-5 h-5 rounded-full bg-green-100 flex items-center justify-center shrink-0",children:n.jsx(xn,{className:"h-3 w-3 text-green-600"})})}),n.jsx(Aa,{children:"Cliente cadastrado no CRM"})]}):n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsx("div",{className:"w-5 h-5 rounded-full bg-amber-100 flex items-center justify-center shrink-0",children:n.jsx(Wn,{className:"h-3 w-3 text-amber-600"})})}),n.jsx(Aa,{children:"Novo cliente (sem cadastro)"})]}),Zt&&n.jsxs(Ae,{className:"bg-amber-500 text-white text-xs gap-1",children:[n.jsx(ga,{className:"h-3 w-3"}),"Ganhadora"]})]}),(Tt==null?void 0:Tt.nome)&&n.jsx("div",{className:"text-xs text-muted-foreground truncate",children:Tt.nome})]}),n.jsxs("div",{className:"flex flex-col items-end gap-1 shrink-0 ml-2",children:[n.jsx(Ae,{className:Xe.color,children:Xe.label}),Fe&&n.jsxs(Ae,{variant:"outline",className:"text-xs bg-amber-100 text-amber-700 border-amber-300",children:[n.jsx(Cn,{className:"h-3 w-3 mr-1"}),"Retirar item"]}),wt&&n.jsx(Ae,{variant:"outline",className:"text-xs text-orange-600 border-orange-300",children:"Reimprimir"})]})]}),n.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[nr.length," ",nr.length===1?"item":"itens"]}),n.jsx("div",{className:"flex items-center justify-between",children:n.jsx("span",{className:"font-semibold",children:fe(Qt)})})]},et.id)};return ht||!r?n.jsx("div",{className:"h-screen flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ts,{className:"h-12 w-12 animate-pulse text-primary mx-auto mb-4"}),n.jsx("p",{className:"text-muted-foreground",children:"Carregando backstage..."})]})}):n.jsxs("div",{className:"h-screen flex flex-col bg-background",children:[n.jsxs("header",{className:"border-b bg-card px-2 sm:px-4 py-2 sm:py-3 shrink-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(he,{variant:"ghost",size:"icon",className:"h-9 w-9 shrink-0",onClick:()=>t("/dashboard?tab=lives"),children:n.jsx(vs,{className:"h-4 w-4"})}),n.jsxs(Ae,{variant:"destructive",className:"gap-1 animate-pulse shrink-0",children:[n.jsx(Ts,{className:"h-3 w-3"}),n.jsx("span",{className:"hidden sm:inline",children:"AO VIVO"})]}),n.jsx("h1",{className:"font-medium text-sm sm:text-base truncate",children:r.titulo}),n.jsxs("div",{className:"hidden sm:flex items-center gap-3 text-sm ml-auto",children:[n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"font-medium",children:xt.totalItems})]})}),n.jsx(Aa,{children:"Peas vendidas na live"})]}),n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(wa,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{className:"font-medium",children:xt.totalCustomers})]})}),n.jsx(Aa,{children:"Clientes comprando"})]}),n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsxs("div",{className:"flex items-center gap-1 text-green-600 font-medium",children:[n.jsx(ws,{className:"h-4 w-4"}),n.jsx("span",{children:fe(xt.totalValue)})]})}),n.jsx(Aa,{children:"Valor total de vendas"})]})]})]}),n.jsxs("div",{className:"flex sm:hidden items-center gap-3 text-xs mb-2 px-1",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Ut,{className:"h-3.5 w-3.5 text-muted-foreground"}),n.jsx("span",{className:"font-medium",children:xt.totalItems})]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(wa,{className:"h-3.5 w-3.5 text-muted-foreground"}),n.jsx("span",{className:"font-medium",children:xt.totalCustomers})]}),n.jsxs("div",{className:"flex items-center gap-1 text-green-600 font-medium",children:[n.jsx(ws,{className:"h-3.5 w-3.5"}),n.jsx("span",{children:fe(xt.totalValue)})]})]}),n.jsxs("div",{className:"flex items-center gap-1.5 overflow-x-auto pb-1 -mx-2 px-2 sm:mx-0 sm:px-0",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 shrink-0",onClick:()=>oe(!0),children:[n.jsx(An,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Produtos"})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 shrink-0",onClick:()=>t(`/dashboard/lives/${r.id}/separacao`),children:[n.jsx(Ut,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Separao"})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 shrink-0",onClick:()=>t(`/dashboard/lives/${r.id}/relatorio`),children:[n.jsx(Pl,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Relatrio"})]}),f.filter(et=>et.status==="ativa").length>0&&n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 border-amber-300 bg-amber-50 text-amber-800 hover:bg-amber-100 relative shrink-0",onClick:()=>be(!0),children:[n.jsx(Fi,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Fila"}),n.jsx(Ae,{className:"bg-amber-500 text-white h-4 w-4 p-0 text-[10px] flex items-center justify-center rounded-full ml-0.5",children:f.filter(et=>et.status==="ativa").length})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 shrink-0",onClick:()=>ee(!0),children:[n.jsx(YS,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Quem?"})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 h-8 border-amber-300 bg-amber-50 text-amber-700 hover:bg-amber-100 shrink-0",onClick:()=>Ke(!0),children:[n.jsx(ga,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Sorteio"})]}),n.jsxs(he,{variant:"destructive",size:"sm",className:"gap-1 h-8 shrink-0",onClick:lt,children:[n.jsx(rU,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"hidden sm:inline",children:"Encerrar"})]})]})]}),n.jsxs("div",{className:"shrink-0 px-4 pt-4 space-y-2",children:[n.jsx(R5e,{entries:f,products:s,getAvailableStock:Ie,onOfferClick:St}),n.jsx(P5e,{carts:h,onCartClick:et=>le(et),onSendWhatsApp:sr})]}),n.jsx("div",{className:"flex-1 overflow-hidden lg:hidden",children:n.jsxs(pi,{value:Ze,onValueChange:et=>it(et),className:"h-full flex flex-col",children:[n.jsxs(Qa,{className:"shrink-0 mx-4 mt-2 grid grid-cols-4",children:[n.jsxs(pr,{value:"produtos",className:"gap-1 text-xs",children:[n.jsx(Ut,{className:"h-3 w-3"}),"Produtos"]}),n.jsxs(pr,{value:"lancador",className:"gap-1 text-xs",children:[n.jsx(An,{className:"h-3 w-3"}),"Lanador"]}),n.jsxs(pr,{value:"carrinhos",className:"gap-1 text-xs",children:[n.jsx(zi,{className:"h-3 w-3"}),"Carrinhos"]}),n.jsxs(pr,{value:"fila",className:"gap-1 text-xs relative",children:[n.jsx(Fi,{className:"h-3 w-3"}),"Fila",f.filter(et=>et.status==="ativa").length>0&&n.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-amber-500 text-white text-[10px] rounded-full flex items-center justify-center",children:f.filter(et=>et.status==="ativa").length})]})]}),n.jsx(wr,{value:"produtos",className:"flex-1 overflow-hidden m-0 p-4",children:n.jsxs(De,{className:"h-full flex flex-col",children:[n.jsxs(Ot,{className:"shrink-0 pb-3",children:[n.jsxs(Mt,{className:"text-base flex items-center gap-2",children:[n.jsx(Ut,{className:"h-4 w-4"}),"Produtos (",s.length,")"]}),n.jsxs("div",{className:"relative mt-2",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar produto...",value:Y,onChange:et=>Z(et.target.value),className:"pl-10 h-9"})]})]}),n.jsx(Be,{className:"flex-1 overflow-hidden p-0",children:n.jsx(bi,{className:"h-full",children:n.jsx("div",{className:"p-4 pt-0 space-y-2",children:ir.map(et=>Pt(et))})})})]})}),n.jsx(wr,{value:"lancador",className:"flex-1 overflow-hidden m-0 p-4",children:n.jsxs(De,{className:"h-full flex flex-col",children:[n.jsx(Ot,{className:"shrink-0 pb-3",children:n.jsxs(Mt,{className:"text-base flex items-center gap-2",children:[n.jsx(An,{className:"h-4 w-4"}),"Lanador Rpido"]})}),n.jsx(Be,{className:"flex-1 overflow-auto",children:vt()})]})}),n.jsx(wr,{value:"carrinhos",className:"flex-1 overflow-hidden m-0 p-4",children:n.jsxs(De,{className:"h-full flex flex-col",children:[n.jsxs(Ot,{className:"shrink-0 pb-3",children:[n.jsxs(Mt,{className:"text-base flex items-center gap-2",children:[n.jsx(zi,{className:"h-4 w-4"}),"Carrinhos (",h.length,")"]}),n.jsxs("div",{className:"relative mt-2",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar @instagram...",value:re,onChange:et=>G(et.target.value),className:"pl-10 h-9"})]}),n.jsxs("div",{className:"flex gap-1.5 mt-2",children:[n.jsxs("button",{onClick:()=>V("all"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors ${J==="all"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:["Todos (",h.length,")"]}),n.jsxs("button",{onClick:()=>V("registered"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors flex items-center gap-1 ${J==="registered"?"bg-green-600 text-white":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[n.jsx(xn,{className:"h-3 w-3"}),"Cadastrados (",Te,")"]}),n.jsxs("button",{onClick:()=>V("new"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors flex items-center gap-1 ${J==="new"?"bg-amber-600 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"}`,children:[n.jsx(Wn,{className:"h-3 w-3"}),"Novos (",qe,")"]})]})]}),n.jsx(Be,{className:"flex-1 overflow-hidden p-0",children:n.jsx(bi,{className:"h-full",children:n.jsxs("div",{className:"p-4 pt-0 space-y-2",children:[Ct.map(et=>or(et)),Ct.length===0&&n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(zi,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm",children:"Nenhum carrinho ainda"})]})]})})})]})}),n.jsx(wr,{value:"fila",className:"flex-1 overflow-hidden m-0 p-4",children:n.jsxs(De,{className:"h-full flex flex-col",children:[n.jsx(Ot,{className:"shrink-0 pb-3",children:n.jsxs(Mt,{className:"text-base flex items-center gap-2",children:[n.jsx(Fi,{className:"h-4 w-4"}),"Lista de Espera",f.filter(et=>et.status==="ativa").length>0&&n.jsxs(Ae,{variant:"secondary",className:"ml-auto",children:[f.filter(et=>et.status==="ativa").length," aguardando"]})]})}),n.jsx(Be,{className:"flex-1 overflow-auto p-4 pt-0",children:n.jsx(mI,{waitlist:f,products:s,onAllocate:ct,onSkip:at,onEndQueue:gt,getAvailableStock:Ie})})]})})]})}),n.jsxs("div",{className:"hidden lg:grid flex-1 grid-cols-3 gap-4 p-4 overflow-hidden",children:[n.jsxs(De,{className:"flex flex-col overflow-hidden",children:[n.jsxs(Ot,{className:"shrink-0 pb-3",children:[n.jsx(Mt,{className:"text-base flex items-center justify-between",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Ut,{className:"h-4 w-4"}),"Produtos (",s.length,")"]})}),n.jsxs("div",{className:"relative mt-2",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar produto...",value:Y,onChange:et=>Z(et.target.value),className:"pl-10 h-9"})]})]}),n.jsx(Be,{className:"flex-1 overflow-hidden p-0",children:n.jsx(bi,{className:"h-full",children:n.jsx("div",{className:"p-4 pt-0 space-y-2",children:ir.map(et=>Pt(et))})})})]}),n.jsxs(De,{className:"flex flex-col overflow-hidden",children:[n.jsx(Ot,{className:"shrink-0 pb-3",children:n.jsxs(Mt,{className:"text-base flex items-center gap-2",children:[n.jsx(An,{className:"h-4 w-4"}),"Lanador Rpido"]})}),n.jsx(Be,{className:"flex-1 overflow-auto",children:vt()})]}),n.jsxs(De,{className:"flex flex-col overflow-hidden",children:[n.jsxs(Ot,{className:"shrink-0 pb-3",children:[n.jsx(Mt,{className:"text-base flex items-center justify-between",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(zi,{className:"h-4 w-4"}),"Carrinhos (",h.length,")"]})}),n.jsxs("div",{className:"relative mt-2",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar @instagram...",value:re,onChange:et=>G(et.target.value),className:"pl-10 h-9"})]}),n.jsxs("div",{className:"flex gap-1.5 mt-2",children:[n.jsxs("button",{onClick:()=>V("all"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors ${J==="all"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}`,children:["Todos (",h.length,")"]}),n.jsxs("button",{onClick:()=>V("registered"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors flex items-center gap-1 ${J==="registered"?"bg-green-600 text-white":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[n.jsx(xn,{className:"h-3 w-3"}),"Cadastrados (",Te,")"]}),n.jsxs("button",{onClick:()=>V("new"),className:`px-2.5 py-1 rounded-full text-xs font-medium transition-colors flex items-center gap-1 ${J==="new"?"bg-amber-600 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"}`,children:[n.jsx(Wn,{className:"h-3 w-3"}),"Novos (",qe,")"]})]})]}),n.jsx(Be,{className:"flex-1 overflow-hidden p-0",children:n.jsx(bi,{className:"h-full",children:n.jsxs("div",{className:"p-4 pt-0 space-y-2",children:[Ct.map(et=>or(et)),Ct.length===0&&n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(zi,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm",children:"Nenhum carrinho ainda"})]})]})})})]})]}),n.jsx(C5e,{open:W,onOpenChange:ee,products:s,carts:h,waitlist:f,reservedStock:Ve}),n.jsx(E5e,{open:ie,onOpenChange:oe,eventId:e||"",existingProductIds:s.map(et=>et.product_id),onProductsAdded:o}),ye&&n.jsx(A5e,{open:!!ye,onOpenChange:()=>ue(null),productId:ye.productId,productName:ye.productName,productColor:ye.productColor,size:ye.size,queueCount:O(ye.productId,ye.size),onSubmit:It}),ne&&n.jsx(T5e,{open:!!ne,onOpenChange:()=>pe(null),waitlistItem:ne.waitlistItem,product:ne.product,onOffer:ct,onSkip:at,onEndQueue:gt}),ge&&n.jsx(O5e,{open:!!ge,onOpenChange:()=>Ne(null),productName:ge.productName,productColor:ge.productColor,size:ge.size,entries:Yt(ge.productId,ge.size),hasStock:Ie(ge.productId,ge.size,((Nr=(br=(jr=s.find(et=>et.product_id===ge.productId))==null?void 0:jr.product)==null?void 0:br.available_by_size)==null?void 0:Nr[ge.size])||0)>0,onAllocate:ct,onSkip:at,onEndQueue:()=>gt(ge.productId,ge.size),onAddToWaitlist:()=>{ue({productId:ge.productId,productName:ge.productName,productColor:ge.productColor,size:ge.size})}}),n.jsx(D5e,{cart:se,onClose:()=>le(null),onRemoveItem:g,onReduceQuantity:v,onCancelCart:async et=>{await X(et,"cancelado")},products:s,onWaitlistOffer:(et,Tt)=>{pe({waitlistItem:et,product:Tt})},cartHistory:Je,historyLoading:Ge}),n.jsx(Tu,{open:_e,onOpenChange:be,children:n.jsxs(fd,{side:"right",className:"sm:max-w-2xl w-full",children:[n.jsx(Pu,{children:n.jsxs(cf,{className:"flex items-center gap-2",children:[n.jsx(Fi,{className:"h-5 w-5 text-amber-600"}),"Gerenciar Lista de Espera",f.filter(et=>et.status==="ativa").length>0&&n.jsxs(Ae,{className:"bg-amber-500 text-white",children:[f.filter(et=>et.status==="ativa").length," aguardando"]})]})}),n.jsx(bi,{className:"h-[calc(100vh-120px)] mt-4",children:n.jsx(mI,{waitlist:f,products:s,onAllocate:ct,onSkip:at,onEndQueue:gt,getAvailableStock:Ie})})]})}),n.jsx(Ac,{open:!!ut,onOpenChange:()=>bt(null),children:n.jsxs(Dl,{children:[n.jsxs(Ll,{children:[n.jsx(Bl,{children:"Cancelar item do pedido?"}),n.jsxs($l,{children:["Voc est prestes a cancelar ",n.jsx("strong",{children:ut==null?void 0:ut.productName})," (Tam: ",ut==null?void 0:ut.size,").",n.jsx("br",{}),n.jsx("br",{}),"Este item ser marcado para ",n.jsx("strong",{children:"retirada fsica da sacola"})," durante a separao. O estoque ",n.jsx("strong",{children:"no ser devolvido automaticamente"}),"."]})]}),n.jsxs(Tc,{children:[n.jsx(Oc,{children:"Voltar"}),n.jsx(Pc,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:async()=>{ut&&(await x(ut.itemId),bt(null),le(null))},children:"Confirmar Cancelamento"})]})]})}),n.jsx(k5e,{open:!!Me,onOpenChange:et=>!et&&Se(null),liveProduct:Me,onProductUpdated:o}),n.jsx(Tu,{open:$e,onOpenChange:Ke,children:n.jsxs(fd,{side:"right",className:"w-full sm:max-w-md p-0",children:[n.jsx(Pu,{className:"px-6 py-4 border-b",children:n.jsxs(cf,{className:"flex items-center gap-2",children:[n.jsx(ga,{className:"h-5 w-5 text-amber-500"}),"Sorteio ao Vivo"]})}),n.jsx("div",{className:"p-4",children:e&&n.jsx(I5e,{eventId:e,carts:h,onRefresh:L,onRaffleOverlayChange:l})})]})})]})}function B5e(){const e=fr();ra();const[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await ce.auth.getSession();if(!a){e("/login");return}const{data:i}=await ce.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(c=>["merchant","admin"].includes(c.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsx(L5e,{})}function $5e(e){const[t,r]=P.useState(null),[s,a]=P.useState(null),[i,o]=P.useState(null),[c,d]=P.useState([]),[l,u]=P.useState([]),[h,f]=P.useState([]),[m,p]=P.useState([]),[g,v]=P.useState([]),[x,y]=P.useState([]),[b,j]=P.useState(!0),T=P.useRef(!1),O=P.useRef([]),R=P.useRef(null),D=P.useCallback(async L=>{if(e){L!=null&&L.silent||j(!0);try{const{data:q,error:X}=await ce.from("live_events").select("*").eq("id",e).maybeSingle();if(X)throw X;if(!q){j(!1);return}r(q);const{data:H}=await ce.from("live_events").select("*").lt("data_hora_inicio",q.data_hora_inicio).order("data_hora_inicio",{ascending:!1}).limit(1).maybeSingle();a(H);const{data:M,error:F}=await ce.from("live_carts").select(`
          *,
          live_customer:live_customers(*),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color)
          ),
          seller:sellers(id, name)
        `).eq("live_event_id",e);if(F)throw F;const S=M||[];let E=[];if(H){const{data:fe}=await ce.from("live_carts").select(`
            *,
            items:live_cart_items(*)
          `).eq("live_event_id",H.id);E=fe||[]}const{data:N}=await ce.from("sellers").select("id, name").eq("is_active",!0),C=N||[],k=S.filter(fe=>fe.status!=="cancelado"),I=S.filter(fe=>fe.status==="pago"),U=k.reduce((fe,Ie)=>fe+(Ie.subtotal||0),0),$=I.reduce((fe,Ie)=>fe+(Ie.subtotal||0),0),Y=k.length,Z=U>0?$/U*100:0,re=I.length>0?$/I.length:0;let G=0;I.forEach(fe=>{(fe.items||[]).forEach(Ie=>{Ie.status==="confirmado"&&(G+=Ie.qtd)})});const J=I.length>0?G/I.length:0;let V={totalReservado:null,totalPago:null,pedidosAtivos:null,taxaConversao:null,ticketMedio:null,pecasPorAtendimento:null};if(E.length>0){const fe=E.filter(St=>St.status!=="cancelado"),Ie=E.filter(St=>St.status==="pago"),tt=fe.reduce((St,rt)=>St+(rt.subtotal||0),0),lt=Ie.reduce((St,rt)=>St+(rt.subtotal||0),0),It=fe.length,ct=tt>0?lt/tt*100:0,at=Ie.length>0?lt/Ie.length:0;let gt=0;Ie.forEach(St=>{(St.items||[]).forEach(rt=>{rt.status==="confirmado"&&(gt+=rt.qtd)})});const Yt=Ie.length>0?gt/Ie.length:0;V={totalReservado:tt>0?(U-tt)/tt*100:null,totalPago:lt>0?($-lt)/lt*100:null,pedidosAtivos:It>0?(Y-It)/It*100:null,taxaConversao:ct>0?Z-ct:null,ticketMedio:at>0?(re-at)/at*100:null,pecasPorAtendimento:Yt>0?(J-Yt)/Yt*100:null}}o({totalReservado:U,totalPago:$,pedidosAtivos:Y,taxaConversao:Z,ticketMedio:re,pecasPorAtendimento:J,comparison:V,previousLive:H?{id:H.id,titulo:H.titulo}:null});const W=[],ee=k;W.push({key:"reservado",label:"Reservado",count:ee.length,value:U,conversionFromPrevious:100,color:"blue"});const ie=k.filter(fe=>(fe.charge_attempts||0)>0),oe=ie.reduce((fe,Ie)=>fe+(Ie.subtotal||0),0);W.push({key:"cobrado",label:"Cobrado",count:ie.length,value:oe,conversionFromPrevious:ee.length>0?ie.length/ee.length*100:0,color:"amber"}),W.push({key:"pago",label:"Pago",count:I.length,value:$,conversionFromPrevious:ie.length>0?I.length/ie.length*100:0,color:"green"});const se=I.filter(fe=>fe.separation_status==="separado"||["etiqueta_gerada","postado","em_rota","entregue","retirado"].includes(fe.operational_status||"")),le=se.reduce((fe,Ie)=>fe+(Ie.subtotal||0),0);W.push({key:"separado",label:"Separado",count:se.length,value:le,conversionFromPrevious:I.length>0?se.length/I.length*100:0,color:"purple"});const ye=I.filter(fe=>["postado","em_rota","entregue","retirado"].includes(fe.operational_status||"")),ue=ye.reduce((fe,Ie)=>fe+(Ie.subtotal||0),0);W.push({key:"enviado",label:"Enviado/Retirado",count:ye.length,value:ue,conversionFromPrevious:se.length>0?ye.length/se.length*100:0,color:"indigo"});const ne=I.filter(fe=>fe.operational_status==="entregue"||fe.operational_status==="retirado"),pe=ne.reduce((fe,Ie)=>fe+(Ie.subtotal||0),0);W.push({key:"entregue",label:"Entregue",count:ne.length,value:pe,conversionFromPrevious:ye.length>0?ne.length/ye.length*100:100,color:"emerald"}),d(W);const ge=new Map;k.forEach(fe=>{const Ie=fe.seller_id||null,tt=ge.get(Ie)||{pedidos:0,valorPago:0,valorReservado:0,pecas:0};tt.valorReservado+=fe.subtotal||0,fe.status==="pago"&&(tt.pedidos+=1,tt.valorPago+=fe.subtotal||0,(fe.items||[]).forEach(lt=>{lt.status==="confirmado"&&(tt.pecas+=lt.qtd)})),ge.set(Ie,tt)});const Ne=[];ge.forEach((fe,Ie)=>{const tt=C.find(lt=>lt.id===Ie);Ne.push({sellerId:Ie,sellerName:(tt==null?void 0:tt.name)||"Sem vendedora",pedidos:fe.pedidos,valorReservado:fe.valorReservado,valorPago:fe.valorPago,ticketMedio:fe.pedidos>0?fe.valorPago/fe.pedidos:0,taxaConversao:fe.valorReservado>0?fe.valorPago/fe.valorReservado*100:0,rank:0,badges:[],performanceScore:0})}),Ne.sort((fe,Ie)=>Ie.valorPago-fe.valorPago),Ne.forEach((fe,Ie)=>{fe.rank=Ie+1});const _e=Ne.filter(fe=>fe.valorPago>0);if(_e.length>0){const fe=Math.max(..._e.map(gt=>gt.valorPago)),Ie=_e.find(gt=>gt.valorPago===fe);Ie&&Ie.badges.push("maior_faturamento");const tt=Math.max(..._e.map(gt=>gt.pedidos)),lt=_e.find(gt=>gt.pedidos===tt);lt&&lt.badges.push("mais_pedidos");const It=_e.filter(gt=>gt.pedidos>=3||gt.valorReservado>=300);if(It.length>0){const gt=Math.max(...It.map(St=>St.taxaConversao)),Yt=It.find(St=>St.taxaConversao===gt);Yt&&Yt.taxaConversao>0&&Yt.badges.push("maior_conversao")}const ct=Math.max(..._e.map(gt=>gt.valorPago),1),at=Math.max(..._e.map(gt=>gt.pedidos),1);if(_e.forEach(gt=>{const Yt=gt.valorPago/ct,St=gt.taxaConversao/100,rt=gt.pedidos/at;gt.performanceScore=.45*Yt+.35*St+.2*rt}),_e.length>=2){const Yt=[..._e].sort((St,rt)=>rt.performanceScore-St.performanceScore)[0];Yt.badges.length<3&&Yt.performanceScore>.5&&Yt.badges.push("melhor_performance")}}Ne.forEach(fe=>{fe.taxaConversao<30&&fe.valorReservado>200&&fe.pedidos===0&&fe.badges.push("attention")}),u(Ne);const be=Date.now(),Me=24*60*60*1e3,Se=12*60*60*1e3,$e=[],Ke=k.filter(fe=>{if(fe.status!=="aguardando_pagamento"||(fe.charge_attempts||0)===0)return!1;const Ie=fe.last_charge_at?new Date(fe.last_charge_at).getTime():0;return be-Ie>Me});Ke.length>0&&$e.push({key:"aguardando_retorno_24h",label:"Aguardando retorno >24h",count:Ke.length,value:Ke.reduce((fe,Ie)=>fe+(Ie.subtotal||0),0),severity:"danger",filterKey:"aguardando_retorno",icon:"clock"});const Ze=k.filter(fe=>fe.status==="aguardando_pagamento"&&(fe.charge_attempts||0)===0);Ze.length>0&&$e.push({key:"nao_cobrados",label:"Pedidos no cobrados",count:Ze.length,value:Ze.reduce((fe,Ie)=>fe+(Ie.subtotal||0),0),severity:"warning",filterKey:"needs_charge",icon:"send"});const it=I.filter(fe=>!fe.operational_status||fe.operational_status==="aguardando_pagamento"||fe.operational_status==="pago");if(it.length>0){const fe=it.filter(Ie=>{const tt=Ie.paid_at?new Date(Ie.paid_at).getTime():new Date(Ie.updated_at).getTime();return be-tt>Se});fe.length>0&&$e.push({key:"pagos_sem_logistica",label:"Pagos sem logstica iniciada",count:fe.length,value:fe.reduce((Ie,tt)=>Ie+(tt.subtotal||0),0),severity:"warning",filterKey:"preparar_envio",icon:"package"})}const Re=I.filter(fe=>fe.delivery_method==="correios"&&(!fe.operational_status||!["etiqueta_gerada","postado","entregue"].includes(fe.operational_status)));Re.length>0&&$e.push({key:"etiquetas_pendentes",label:"Etiquetas pendentes",count:Re.length,value:Re.reduce((fe,Ie)=>fe+(Ie.subtotal||0),0),severity:"info",filterKey:"correios",icon:"tag"});const ot=k.filter(fe=>!fe.seller_id);ot.length>0&&$e.push({key:"sem_vendedora",label:"Pedidos sem vendedora",count:ot.length,value:ot.reduce((fe,Ie)=>fe+(Ie.subtotal||0),0),severity:"info",filterKey:"none",icon:"user"});const ut=k.filter(fe=>fe.payment_review_status==="pending_review");ut.length>0&&$e.push({key:"pending_validation",label:"Pagamentos pendentes de validao",count:ut.length,value:ut.reduce((fe,Ie)=>fe+(Ie.subtotal||0),0),severity:"danger",filterKey:"pending_proof",icon:"shield"}),f($e);const bt=new Map;I.forEach(fe=>{(fe.items||[]).forEach(Ie=>{if(Ie.status==="confirmado"&&Ie.product){const tt=bt.get(Ie.product_id);tt?(tt.quantidadeVendida+=Ie.qtd,tt.valorTotal+=Ie.preco_unitario*Ie.qtd):bt.set(Ie.product_id,{productId:Ie.product_id,productName:Ie.product.name,productImage:Ie.product.image_url,productColor:Ie.product.color,quantidadeVendida:Ie.qtd,valorTotal:Ie.preco_unitario*Ie.qtd})}})}),p(Array.from(bt.values()).sort((fe,Ie)=>Ie.valorTotal-fe.valorTotal));const Je=["reservado","confirmado","expirado","removido","cancelado"],Ce=["reservado","confirmado"],Ge=S.filter(fe=>fe.live_customer&&fe.status!=="cancelado").map(fe=>{var lt,It,ct;const Ie=(fe.items||[]).filter(at=>Je.includes(at.status)),tt=(fe.items||[]).filter(at=>Ce.includes(at.status));return{customerId:fe.live_customer_id,cartId:fe.id,instagram:((lt=fe.live_customer)==null?void 0:lt.instagram_handle)||"",nome:((It=fe.live_customer)==null?void 0:It.nome)||null,whatsapp:((ct=fe.live_customer)==null?void 0:ct.whatsapp)||null,valorTotal:fe.total,itens:Ie.length,activeItens:tt.length,status:fe.status,items:Ie,mpCheckoutUrl:fe.mp_checkout_url||null,publicToken:fe.public_token||null}}).sort((fe,Ie)=>Ie.valorTotal-fe.valorTotal);v(Ge);const Pe=[];S.forEach(fe=>{const Ie=fe.status==="pago";(fe.items||[]).forEach(tt=>{if(["reservado","confirmado","expirado"].includes(tt.status)){const lt=new Date(tt.reservado_em).getTime();Pe.push({timestamp:lt,valor:tt.preco_unitario*tt.qtd,isPago:Ie})}})}),Pe.sort((fe,Ie)=>fe.timestamp-Ie.timestamp);let Ve=0,st=0;const xt=Pe.map(fe=>(Ve+=fe.valor,fe.isPago&&(st+=fe.valor),{time:new Date(fe.timestamp).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),timestamp:fe.timestamp,reservadoMomento:fe.valor,reservadoAcumulado:Ve,pagoAcumulado:st}));y(xt)}catch(q){console.error("Error fetching report data:",q)}finally{T.current=!0,L!=null&&L.silent||j(!1)}}},[e]);return P.useEffect(()=>{D()},[D]),P.useEffect(()=>{if(!e)return;O.current.forEach(H=>ce.removeChannel(H)),O.current=[],R.current&&(window.clearTimeout(R.current),R.current=null);const L=()=>{R.current&&window.clearTimeout(R.current),R.current=window.setTimeout(()=>{D({silent:T.current})},350)},q=ce.channel(`live_reports_v2_carts_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_carts",filter:`live_event_id=eq.${e}`},L).subscribe(),X=ce.channel(`live_reports_v2_items_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_cart_items"},L).subscribe();return O.current=[q,X],()=>{O.current.forEach(H=>ce.removeChannel(H)),O.current=[],R.current&&(window.clearTimeout(R.current),R.current=null)}},[e,D]),{event:t,previousEvent:s,kpis:i,funnel:c,sellerPerformance:l,insights:h,topProducts:m,customerSales:g,timelineData:x,isLoading:b,refetch:D}}function F5e({kpis:e}){const t=i=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(i),r=i=>i===null?null:`${i>0?"+":""}${i.toFixed(1)}%`,s=(i,o=!1)=>{if(i===null)return null;const c=i>0;return Math.abs(i)<.5?n.jsx("span",{className:"text-xs text-muted-foreground ml-1",children:"(=)"}):n.jsxs("span",{className:`inline-flex items-center gap-0.5 text-xs ${c?"text-green-600":"text-red-600"}`,children:[c?n.jsx(_s,{className:"h-3 w-3"}):n.jsx(qx,{className:"h-3 w-3"}),o?`${i>0?"+":""}${i.toFixed(1)}pp`:r(i)]})},a=[{title:"Total Reservado",value:t(e.totalReservado),comparison:e.comparison.totalReservado,icon:ws,iconBg:"bg-blue-100",iconColor:"text-blue-600",highlight:!0,highlightColor:"border-blue-200 bg-gradient-to-br from-blue-50 to-white"},{title:"Total Pago",value:t(e.totalPago),comparison:e.comparison.totalPago,icon:Er,iconBg:"bg-green-100",iconColor:"text-green-600",highlight:!0,highlightColor:"border-green-200 bg-gradient-to-br from-green-50 to-white"},{title:"Pedidos Ativos",value:e.pedidosAtivos.toString(),comparison:e.comparison.pedidosAtivos,icon:ln,iconBg:"bg-purple-100",iconColor:"text-purple-600"},{title:"Taxa de Converso",value:`${e.taxaConversao.toFixed(1)}%`,comparison:e.comparison.taxaConversao,isPercentagePoint:!0,icon:ba,iconBg:"bg-amber-100",iconColor:"text-amber-600"},{title:"Ticket Mdio",value:t(e.ticketMedio),comparison:e.comparison.ticketMedio,icon:xs,iconBg:"bg-teal-100",iconColor:"text-teal-600"},{title:"P.A. (Peas/Atend.)",value:e.pecasPorAtendimento.toFixed(1),comparison:e.comparison.pecasPorAtendimento,icon:Ut,iconBg:"bg-indigo-100",iconColor:"text-indigo-600"}];return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h2",{className:"text-lg font-semibold",children:"Viso Geral"}),e.previousLive&&n.jsxs("span",{className:"text-xs text-muted-foreground",children:["Comparado com: ",e.previousLive.titulo]})]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:a.map((i,o)=>n.jsx(De,{className:`relative overflow-hidden ${i.highlight?`border-2 ${i.highlightColor}`:""}`,children:n.jsxs(Be,{className:"p-4",children:[n.jsx("div",{className:"flex items-start justify-between mb-2",children:n.jsx("div",{className:`p-2 rounded-lg ${i.iconBg}`,children:n.jsx(i.icon,{className:`h-4 w-4 ${i.iconColor}`})})}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-baseline gap-1 flex-wrap",children:[n.jsx("span",{className:`text-xl font-bold ${i.highlight?o===0?"text-blue-700":"text-green-700":""}`,children:i.value}),s(i.comparison,i.isPercentagePoint)]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:i.title})]})]})},o))})]})}function z5e({funnel:e}){const t=fr(),{eventId:r}=ra(),s=c=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c),a=(c,d)=>{const l={blue:{bg:"bg-blue-500",text:"text-blue-700",border:"border-blue-300",light:"bg-blue-50"},amber:{bg:"bg-amber-500",text:"text-amber-700",border:"border-amber-300",light:"bg-amber-50"},green:{bg:"bg-green-500",text:"text-green-700",border:"border-green-300",light:"bg-green-50"},purple:{bg:"bg-purple-500",text:"text-purple-700",border:"border-purple-300",light:"bg-purple-50"},indigo:{bg:"bg-indigo-500",text:"text-indigo-700",border:"border-indigo-300",light:"bg-indigo-50"},emerald:{bg:"bg-emerald-500",text:"text-emerald-700",border:"border-emerald-300",light:"bg-emerald-50"}};return l[c]||l.blue},i=c=>{if(!r)return;const l={reservado:"all",cobrado:"cobrado",pago:"pago",separado:"separado",enviado:"postado",entregue:"entregue"}[c]||"all";t(`/dashboard/lives/${r}/pedidos?status=${l}`)},o=Math.max(...e.map(c=>c.count),1);return n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-3",children:n.jsx(Mt,{className:"text-base font-medium",children:"Funil da Live"})}),n.jsxs(Be,{className:"space-y-3",children:[e.map((c,d)=>{const l=a(c.color),u=Math.max(c.count/o*100,10),h=d>0&&e[d-1].count>0;return n.jsxs("div",{className:"space-y-1",children:[h&&n.jsxs("div",{className:"flex items-center justify-center gap-1 py-1",children:[n.jsx("div",{className:"h-px flex-1 bg-muted"}),n.jsxs(Ae,{variant:"outline",className:`text-xs ${c.conversionFromPrevious>=70?"border-green-300 text-green-600":c.conversionFromPrevious>=40?"border-amber-300 text-amber-600":"border-red-300 text-red-600"}`,children:[c.conversionFromPrevious.toFixed(0),"%"]}),n.jsx("div",{className:"h-px flex-1 bg-muted"})]}),n.jsx("button",{onClick:()=>i(c.key),className:`w-full group relative overflow-hidden rounded-lg border ${l.border} ${l.light} hover:shadow-md transition-all`,style:{width:`${u}%`,minWidth:"200px",marginLeft:"auto",marginRight:"auto"},children:n.jsxs("div",{className:"flex items-center justify-between p-3",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:`w-2 h-8 rounded-full ${l.bg}`}),n.jsxs("div",{className:"text-left",children:[n.jsx("p",{className:`font-medium text-sm ${l.text}`,children:c.label}),n.jsx("p",{className:"text-xs text-muted-foreground",children:s(c.value)})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:`text-xl font-bold ${l.text}`,children:c.count}),n.jsx(Dn,{className:"h-4 w-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"})]})]})})]},c.key)}),n.jsx("div",{className:"pt-3 border-t text-xs text-muted-foreground text-center",children:"Clique em uma etapa para filtrar os pedidos"})]})]})}function U5e({sellers:e}){const t=c=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c),r=c=>{switch(c){case 1:return n.jsx("div",{className:"flex items-center justify-center w-7 h-7 rounded-full bg-yellow-100",children:n.jsx(Ei,{className:"h-4 w-4 text-yellow-600"})});case 2:return n.jsx("div",{className:"flex items-center justify-center w-7 h-7 rounded-full bg-slate-200 text-slate-600 text-xs font-bold",children:"2"});case 3:return n.jsx("div",{className:"flex items-center justify-center w-7 h-7 rounded-full bg-amber-100 text-amber-700 text-xs font-bold",children:"3"});default:return n.jsxs("div",{className:"flex items-center justify-center w-7 h-7 rounded-full bg-muted text-muted-foreground text-xs font-bold",children:[c,""]})}},s=c=>{switch(c){case"maior_faturamento":return{icon:ws,label:"Maior Faturamento",className:"bg-green-100 text-green-700 border-green-300"};case"maior_conversao":return{icon:ba,label:"Maior Converso",className:"bg-blue-100 text-blue-700 border-blue-300"};case"mais_pedidos":return{icon:ln,label:"Mais Pedidos",className:"bg-purple-100 text-purple-700 border-purple-300"};case"melhor_performance":return{icon:qz,label:"Melhor Performance",className:"bg-yellow-100 text-yellow-700 border-yellow-300"};case"attention":return{icon:Mr,label:"Ateno",className:"border-red-300 text-red-600 bg-red-50"}}},a=c=>c.length===0?null:n.jsx("div",{className:"flex flex-wrap gap-1",children:c.map(d=>{const l=s(d),u=l.icon;return n.jsxs(Ae,{className:`${l.className} gap-1 text-[10px] px-1.5 py-0.5`,children:[n.jsx(u,{className:"h-3 w-3"}),n.jsx("span",{className:"hidden sm:inline",children:l.label})]},d)})}),i=[...e].filter(c=>c.valorPago>0),o=e.filter(c=>c.valorPago===0);return e.length===0?n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-3",children:n.jsxs(Mt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(wa,{className:"h-4 w-4"}),"Performance por Vendedora"]})}),n.jsx(Be,{children:n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(wa,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm",children:"Nenhuma vendedora atribuda ainda"})]})})]}):n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-3",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Mt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(_s,{className:"h-4 w-4"}),"Performance por Vendedora"]}),n.jsx(wp,{children:n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsx("span",{className:"text-xs text-muted-foreground cursor-help underline decoration-dotted",children:" Critrios dos badges"})}),n.jsx(Aa,{side:"left",className:"max-w-xs",children:n.jsxs("div",{className:"space-y-1 text-xs",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"Maior Faturamento:"})," Maior valor pago"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Mais Pedidos:"})," Maior n de pedidos pagos"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Maior Converso:"})," Maior % converso (base mnima: 3 pedidos OU R$300 reservado)"]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Melhor Performance:"})," Score ponderado (45% valor + 35% converso + 20% pedidos)"]})]})})]})})]})}),n.jsx(Be,{children:n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{className:"bg-muted/50",children:[n.jsx(jt,{className:"w-12 text-center",children:"#"}),n.jsx(jt,{children:"Vendedora"}),n.jsx(jt,{className:"text-center",children:"Pedidos"}),n.jsx(jt,{className:"text-right",children:"Valor Pago"}),n.jsx(jt,{className:"text-center hidden sm:table-cell",children:"Ticket Mdio"}),n.jsx(jt,{className:"text-center hidden md:table-cell",children:"Converso"}),n.jsx(jt,{className:"text-center",children:"Status"})]})}),n.jsxs(Na,{children:[i.map(c=>n.jsxs(Qr,{className:c.rank<=3?"bg-muted/20":"",children:[n.jsx(yt,{className:"text-center",children:r(c.rank)}),n.jsx(yt,{children:n.jsx("span",{className:`font-medium ${c.sellerId?"":"text-muted-foreground italic"}`,children:c.sellerName})}),n.jsx(yt,{className:"text-center font-medium",children:c.pedidos}),n.jsx(yt,{className:"text-right",children:n.jsx("span",{className:"font-bold text-green-600",children:t(c.valorPago)})}),n.jsx(yt,{className:"text-center hidden sm:table-cell",children:t(c.ticketMedio)}),n.jsx(yt,{className:"text-center hidden md:table-cell",children:n.jsxs("span",{className:`font-medium ${c.taxaConversao>=70?"text-green-600":c.taxaConversao>=40?"text-amber-600":"text-red-600"}`,children:[c.taxaConversao.toFixed(0),"%"]})}),n.jsx(yt,{className:"text-center",children:a(c.badges)})]},c.sellerId||"none")),o.length>0&&n.jsx(Qr,{className:"bg-muted/10",children:n.jsxs(yt,{colSpan:7,className:"text-center text-xs text-muted-foreground py-2",children:[o.length," vendedora(s) sem vendas pagas nesta live"]})})]})]})})})]})}function V5e({insights:e}){const t=fr(),{eventId:r}=ra(),s=c=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(c),a=c=>({clock:Br,send:zu,package:Ut,tag:Oa,user:Wn,shield:Sae})[c]||Mr,i=c=>{switch(c){case"danger":return{bg:"bg-red-50 hover:bg-red-100",border:"border-red-200",iconBg:"bg-red-100",iconColor:"text-red-600",textColor:"text-red-700"};case"warning":return{bg:"bg-amber-50 hover:bg-amber-100",border:"border-amber-200",iconBg:"bg-amber-100",iconColor:"text-amber-600",textColor:"text-amber-700"};default:return{bg:"bg-blue-50 hover:bg-blue-100",border:"border-blue-200",iconBg:"bg-blue-100",iconColor:"text-blue-600",textColor:"text-blue-700"}}},o=c=>{r&&t(`/dashboard/lives/${r}/pedidos?filter=${c.filterKey}`)};return e.length===0?n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-3",children:n.jsxs(Mt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(e3,{className:"h-4 w-4"}),"Insights Acionveis"]})}),n.jsx(Be,{children:n.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[n.jsx(e3,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),n.jsx("p",{className:"text-sm font-medium text-green-600",children:"Tudo em ordem!"}),n.jsx("p",{className:"text-xs mt-1",children:"Nenhuma pendncia identificada"})]})})]}):n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-3",children:n.jsxs(Mt,{className:"text-base font-medium flex items-center gap-2",children:[n.jsx(e3,{className:"h-4 w-4"}),"Insights Acionveis",n.jsxs("span",{className:"ml-auto text-xs font-normal text-muted-foreground",children:[e.length," pendncia(s)"]})]})}),n.jsx(Be,{className:"space-y-2",children:e.map(c=>{const d=a(c.icon),l=i(c.severity);return n.jsxs("button",{onClick:()=>o(c),className:`w-full flex items-center gap-3 p-3 rounded-lg border transition-all ${l.bg} ${l.border} group`,children:[n.jsx("div",{className:`p-2 rounded-lg ${l.iconBg}`,children:n.jsx(d,{className:`h-4 w-4 ${l.iconColor}`})}),n.jsxs("div",{className:"flex-1 text-left",children:[n.jsx("p",{className:`text-sm font-medium ${l.textColor}`,children:c.label}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:[c.count," pedido(s)  ",s(c.value)]})]}),n.jsx(Dn,{className:"h-4 w-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"})]},c.key)})})]})}function w5({products:e}){var s;const t=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a);if(e.length===0)return n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(ga,{className:"h-5 w-5 text-amber-500"}),"Produtos Mais Vendidos"]})}),n.jsx(Be,{children:n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhuma venda registrada"})})]});const r=((s=e[0])==null?void 0:s.valorTotal)||1;return n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(ga,{className:"h-5 w-5 text-amber-500"}),"Produtos Mais Vendidos"]})}),n.jsx(Be,{className:"space-y-3",children:e.slice(0,10).map((a,i)=>n.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg hover:bg-muted/50 transition-colors",children:[n.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold shrink-0 ${i===0?"bg-amber-100 text-amber-700":i===1?"bg-gray-200 text-gray-700":i===2?"bg-orange-100 text-orange-700":"bg-muted text-muted-foreground"}`,children:i+1}),n.jsx("div",{className:"w-10 h-10 rounded-lg bg-secondary overflow-hidden shrink-0",children:a.productImage?n.jsx("img",{src:a.productImage,alt:a.productName,className:"w-full h-full object-cover"}):n.jsx("div",{className:"w-full h-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium text-sm truncate",children:a.productName}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.productColor&&`${a.productColor}  `,a.quantidadeVendida," ",a.quantidadeVendida===1?"unidade":"unidades"]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("div",{className:"font-semibold text-sm",children:t(a.valorTotal)}),n.jsx("div",{className:"w-16 h-1 bg-muted rounded-full mt-1",children:n.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${a.valorTotal/r*100}%`}})})]})]},a.productId))})]})}function q5e({sales:e,onRefresh:t}){const[r,s]=P.useState(null),[a,i]=P.useState([]),[o,c]=P.useState(!1),[d,l]=P.useState(!1),u=x=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(x),h={pago:{label:"Pago",variant:"default",icon:Er},aguardando_pagamento:{label:"Aguardando",variant:"secondary",icon:Br},aberto:{label:"Aberto",variant:"outline",icon:Br},em_confirmacao:{label:"Confirmando",variant:"secondary",icon:Br},cancelado:{label:"Cancelado",variant:"destructive",icon:qn},expirado:{label:"Aguardando pagamento",variant:"secondary",icon:Br}};P.useEffect(()=>{r?(c(!0),ce.from("live_cart_status_history").select("*").eq("live_cart_id",r.cartId).order("created_at",{ascending:!0}).then(({data:x})=>{i(x||[]),c(!1)})):i([])},[r==null?void 0:r.cartId]);const f=(x,y)=>{const b=window.location.origin;return y?`${b}/live-checkout/${x}?token=${y}`:`${b}/live-checkout/${x}`},m=x=>{const y=x.nome||x.instagram,b=x.mpCheckoutUrl||f(x.cartId,x.publicToken);let j=`Oi${y?` ${y.split(" ")[0]}`:""}! 

`;return j+=`Vi aqui que seu pedido da live ainda est aguardando pagamento.

`,x.items.forEach(T=>{var D,L,q,X;const O=((D=T.variante)==null?void 0:D.tamanho)||"",R=((L=T.variante)==null?void 0:L.cor)||((q=T.product)==null?void 0:q.color)||"";j+=` ${((X=T.product)==null?void 0:X.name)||"Produto"}`,O&&(j+=` - Tam: ${O}`),R&&(j+=` (${R})`),j+=` - ${u(T.preco_unitario)}
`}),j+=`
 Total: ${u(x.valorTotal)}

`,j+=`Ainda quer garantir? Finalize por aqui:
${b}

`,j+="Me avisa se precisar de ajuda! ",j},p=x=>{var j;const y=((j=x.whatsapp)==null?void 0:j.replace(/\D/g,""))||"",b=m(x);if(y){const T=`https://wa.me/${y}?text=${encodeURIComponent(b)}`;window.open(T,"_blank")}else navigator.clipboard.writeText(b),de.success("Mensagem copiada! Envie pelo Instagram DM.")},g=async x=>{var y;l(!0);try{const{data:b,error:j}=await ce.functions.invoke("create-live-cart-payment",{body:{live_cart_id:x}});if(j)throw j;if(b!=null&&b.success&&(b!=null&&b.init_point))b.already_exists?de.info("Link j existia - abrindo..."):de.success("Link de pagamento gerado!"),window.open(b.init_point,"_blank"),t==null||t();else if(b!=null&&b.error_code){const T=b.message||"Erro ao gerar pagamento",O=b.action?` ${b.action}`:"";de.error(`${T}${O}`),console.error("Payment generation error:",b)}else de.error((b==null?void 0:b.error)||(b==null?void 0:b.message)||"Erro ao gerar pagamento")}catch(b){console.error("Error generating payment:",b);const j=((y=b==null?void 0:b.context)==null?void 0:y.json)||(b==null?void 0:b.data);j!=null&&j.error_code?de.error(j.message||"Erro ao gerar link de pagamento"):de.error("Erro de conexo ao gerar link")}finally{l(!1)}},v=x=>{const y=f(x.cartId,x.publicToken);navigator.clipboard.writeText(y),de.success("Link copiado!")};return e.length===0?n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(wa,{className:"h-5 w-5 text-primary"}),"Vendas por Cliente"]})}),n.jsx(Be,{children:n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Nenhum carrinho registrado"})})]}):n.jsxs(n.Fragment,{children:[n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(wa,{className:"h-5 w-5 text-primary"}),"Vendas por Cliente"]})}),n.jsx(Be,{className:"space-y-2",children:e.map((x,y)=>{const b=h[x.status]||h.aberto,j=b.icon;return n.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>s(x),children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center shrink-0",children:n.jsx("span",{className:"text-sm font-semibold text-primary",children:x.instagram.replace("@","").charAt(0).toUpperCase()})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium truncate",children:x.instagram}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[x.nome||"","  ",x.itens," ",x.itens===1?"item":"itens"]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("div",{className:"font-semibold",children:u(x.valorTotal)}),n.jsxs(Ae,{variant:b.variant,className:"text-xs mt-1",children:[n.jsx(j,{className:"h-3 w-3 mr-1"}),b.label]})]})]},`${x.customerId}-${y}`)})})]}),n.jsx(cn,{open:!!r,onOpenChange:x=>{x||s(null)},children:n.jsxs(sn,{className:"sm:max-w-lg max-h-[90vh] overflow-y-auto",children:[n.jsx(fn,{children:n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:n.jsx("span",{className:"text-sm font-semibold text-primary",children:r==null?void 0:r.instagram.replace("@","").charAt(0).toUpperCase()})}),r==null?void 0:r.instagram]})}),r&&n.jsxs("div",{className:"space-y-4",children:[r.nome&&n.jsxs("div",{className:"text-sm text-muted-foreground",children:[r.nome,r.whatsapp&&`  ${r.whatsapp}`]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:"Itens do Carrinho"}),r.items.length===0?n.jsx("div",{className:"text-center py-4 text-sm text-muted-foreground",children:"Nenhum item no carrinho"}):r.items.map(x=>{var j,T,O;const y=x.status,b=["expirado","removido","cancelado"].includes(y);return n.jsxs("div",{className:`flex items-center gap-3 p-2 rounded-lg ${b?"bg-muted/20 opacity-70":"bg-muted/30"}`,children:[n.jsx("div",{className:"w-10 h-10 bg-secondary rounded overflow-hidden shrink-0",children:(j=x.product)!=null&&j.image_url?n.jsx("img",{src:x.product.image_url,alt:x.product.name,className:"w-full h-full object-cover"}):n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground m-auto mt-3"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"font-medium text-sm truncate flex items-center gap-2",children:[(T=x.product)==null?void 0:T.name,b&&n.jsx(Ae,{variant:"outline",className:"text-[10px] px-1.5 py-0 bg-muted text-muted-foreground",children:y==="expirado"?"Expirado":y==="removido"?"Removido":"Cancelado"})]}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["Tam: ",(O=x.variante)==null?void 0:O.tamanho,"  Qtd: ",x.qtd]})]}),n.jsx("div",{className:`font-medium text-sm ${b?"line-through text-muted-foreground":""}`,children:u(x.preco_unitario*x.qtd)})]},x.id)})]}),n.jsxs("div",{className:"flex justify-between items-center p-3 bg-primary/10 rounded-lg",children:[n.jsx("span",{className:"font-medium",children:"Total"}),n.jsx("span",{className:"text-xl font-bold",children:u(r.valorTotal)})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Status atual:"}),n.jsxs(Ae,{className:r.status==="pago"?"bg-green-100 text-green-700":r.status==="cancelado"?"bg-red-100 text-red-700":["aguardando_pagamento","em_confirmacao","expirado"].includes(r.status)?"bg-amber-100 text-amber-700":"bg-blue-100 text-blue-700",children:[r.status==="pago"&&" Pago",r.status==="aberto"&&" Aberto",r.status==="aguardando_pagamento"&&" Aguardando",r.status==="cancelado"&&" Cancelado",r.status==="expirado"&&" Aguardando pagamento",r.status==="em_confirmacao"&&" Confirmando"]})]}),n.jsx(KY,{history:a,isLoading:o}),!["pago","cancelado"].includes(r.status)&&n.jsxs("div",{className:"space-y-3 pt-4 border-t mt-4",children:[n.jsx("div",{className:"text-sm font-medium",children:"Cobrar cliente"}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs(he,{variant:"outline",className:"gap-1.5",onClick:()=>v(r),children:[n.jsx(Ia,{className:"h-4 w-4"}),"Copiar Link"]}),n.jsxs(he,{variant:"outline",className:"gap-1.5 text-green-600 border-green-200 hover:bg-green-50",onClick:()=>p(r),children:[n.jsx(nn,{className:"h-4 w-4"}),r.whatsapp?"WhatsApp":"Copiar Msg"]})]}),r.mpCheckoutUrl?n.jsxs(he,{variant:"outline",className:"w-full gap-1.5 text-blue-600",onClick:()=>window.open(r.mpCheckoutUrl,"_blank"),children:[n.jsx(ma,{className:"h-4 w-4"}),"Abrir Link Mercado Pago"]}):n.jsxs(he,{className:"w-full gap-1.5",onClick:()=>g(r.cartId),disabled:d,children:[d?n.jsx(At,{className:"h-4 w-4 animate-spin"}):n.jsx(xs,{className:"h-4 w-4"}),"Gerar Link Mercado Pago"]})]})]})]})})]})}var W5e=Array.isArray,eo=W5e,H5e=typeof Ur=="object"&&Ur&&Ur.Object===Object&&Ur,YY=H5e,G5e=YY,K5e=typeof self=="object"&&self&&self.Object===Object&&self,X5e=G5e||K5e||Function("return this")(),Mc=X5e,Y5e=Mc,Z5e=Y5e.Symbol,V1=Z5e,pI=V1,ZY=Object.prototype,Q5e=ZY.hasOwnProperty,J5e=ZY.toString,A0=pI?pI.toStringTag:void 0;function eEe(e){var t=Q5e.call(e,A0),r=e[A0];try{e[A0]=void 0;var s=!0}catch{}var a=J5e.call(e);return s&&(t?e[A0]=r:delete e[A0]),a}var tEe=eEe,rEe=Object.prototype,nEe=rEe.toString;function sEe(e){return nEe.call(e)}var aEe=sEe,gI=V1,iEe=tEe,oEe=aEe,lEe="[object Null]",cEe="[object Undefined]",xI=gI?gI.toStringTag:void 0;function dEe(e){return e==null?e===void 0?cEe:lEe:xI&&xI in Object(e)?iEe(e):oEe(e)}var Sd=dEe;function uEe(e){return e!=null&&typeof e=="object"}var Cd=uEe,hEe=Sd,fEe=Cd,mEe="[object Symbol]";function pEe(e){return typeof e=="symbol"||fEe(e)&&hEe(e)==mEe}var $g=pEe,gEe=eo,xEe=$g,vEe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,yEe=/^\w*$/;function bEe(e,t){if(gEe(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||xEe(e)?!0:yEe.test(e)||!vEe.test(e)||t!=null&&e in Object(t)}var NA=bEe;function wEe(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var Yu=wEe;const Fg=On(Yu);var _Ee=Sd,jEe=Yu,NEe="[object AsyncFunction]",SEe="[object Function]",CEe="[object GeneratorFunction]",EEe="[object Proxy]";function kEe(e){if(!jEe(e))return!1;var t=_Ee(e);return t==SEe||t==CEe||t==NEe||t==EEe}var SA=kEe;const Lr=On(SA);var AEe=Mc,TEe=AEe["__core-js_shared__"],PEe=TEe,v4=PEe,vI=function(){var e=/[^.]+$/.exec(v4&&v4.keys&&v4.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function OEe(e){return!!vI&&vI in e}var REe=OEe,MEe=Function.prototype,IEe=MEe.toString;function DEe(e){if(e!=null){try{return IEe.call(e)}catch{}try{return e+""}catch{}}return""}var QY=DEe,LEe=SA,BEe=REe,$Ee=Yu,FEe=QY,zEe=/[\\^$.*+?()[\]{}|]/g,UEe=/^\[object .+?Constructor\]$/,VEe=Function.prototype,qEe=Object.prototype,WEe=VEe.toString,HEe=qEe.hasOwnProperty,GEe=RegExp("^"+WEe.call(HEe).replace(zEe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function KEe(e){if(!$Ee(e)||BEe(e))return!1;var t=LEe(e)?GEe:UEe;return t.test(FEe(e))}var XEe=KEe;function YEe(e,t){return e==null?void 0:e[t]}var ZEe=YEe,QEe=XEe,JEe=ZEe;function e6e(e,t){var r=JEe(e,t);return QEe(r)?r:void 0}var Mf=e6e,t6e=Mf,r6e=t6e(Object,"create"),vj=r6e,yI=vj;function n6e(){this.__data__=yI?yI(null):{},this.size=0}var s6e=n6e;function a6e(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var i6e=a6e,o6e=vj,l6e="__lodash_hash_undefined__",c6e=Object.prototype,d6e=c6e.hasOwnProperty;function u6e(e){var t=this.__data__;if(o6e){var r=t[e];return r===l6e?void 0:r}return d6e.call(t,e)?t[e]:void 0}var h6e=u6e,f6e=vj,m6e=Object.prototype,p6e=m6e.hasOwnProperty;function g6e(e){var t=this.__data__;return f6e?t[e]!==void 0:p6e.call(t,e)}var x6e=g6e,v6e=vj,y6e="__lodash_hash_undefined__";function b6e(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=v6e&&t===void 0?y6e:t,this}var w6e=b6e,_6e=s6e,j6e=i6e,N6e=h6e,S6e=x6e,C6e=w6e;function zg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}zg.prototype.clear=_6e;zg.prototype.delete=j6e;zg.prototype.get=N6e;zg.prototype.has=S6e;zg.prototype.set=C6e;var E6e=zg;function k6e(){this.__data__=[],this.size=0}var A6e=k6e;function T6e(e,t){return e===t||e!==e&&t!==t}var CA=T6e,P6e=CA;function O6e(e,t){for(var r=e.length;r--;)if(P6e(e[r][0],t))return r;return-1}var yj=O6e,R6e=yj,M6e=Array.prototype,I6e=M6e.splice;function D6e(e){var t=this.__data__,r=R6e(t,e);if(r<0)return!1;var s=t.length-1;return r==s?t.pop():I6e.call(t,r,1),--this.size,!0}var L6e=D6e,B6e=yj;function $6e(e){var t=this.__data__,r=B6e(t,e);return r<0?void 0:t[r][1]}var F6e=$6e,z6e=yj;function U6e(e){return z6e(this.__data__,e)>-1}var V6e=U6e,q6e=yj;function W6e(e,t){var r=this.__data__,s=q6e(r,e);return s<0?(++this.size,r.push([e,t])):r[s][1]=t,this}var H6e=W6e,G6e=A6e,K6e=L6e,X6e=F6e,Y6e=V6e,Z6e=H6e;function Ug(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}Ug.prototype.clear=G6e;Ug.prototype.delete=K6e;Ug.prototype.get=X6e;Ug.prototype.has=Y6e;Ug.prototype.set=Z6e;var bj=Ug,Q6e=Mf,J6e=Mc,eke=Q6e(J6e,"Map"),EA=eke,bI=E6e,tke=bj,rke=EA;function nke(){this.size=0,this.__data__={hash:new bI,map:new(rke||tke),string:new bI}}var ske=nke;function ake(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var ike=ake,oke=ike;function lke(e,t){var r=e.__data__;return oke(t)?r[typeof t=="string"?"string":"hash"]:r.map}var wj=lke,cke=wj;function dke(e){var t=cke(this,e).delete(e);return this.size-=t?1:0,t}var uke=dke,hke=wj;function fke(e){return hke(this,e).get(e)}var mke=fke,pke=wj;function gke(e){return pke(this,e).has(e)}var xke=gke,vke=wj;function yke(e,t){var r=vke(this,e),s=r.size;return r.set(e,t),this.size+=r.size==s?0:1,this}var bke=yke,wke=ske,_ke=uke,jke=mke,Nke=xke,Ske=bke;function Vg(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var s=e[t];this.set(s[0],s[1])}}Vg.prototype.clear=wke;Vg.prototype.delete=_ke;Vg.prototype.get=jke;Vg.prototype.has=Nke;Vg.prototype.set=Ske;var kA=Vg,JY=kA,Cke="Expected a function";function AA(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Cke);var r=function(){var s=arguments,a=t?t.apply(this,s):s[0],i=r.cache;if(i.has(a))return i.get(a);var o=e.apply(this,s);return r.cache=i.set(a,o)||i,o};return r.cache=new(AA.Cache||JY),r}AA.Cache=JY;var eZ=AA;const Eke=On(eZ);var kke=eZ,Ake=500;function Tke(e){var t=kke(e,function(s){return r.size===Ake&&r.clear(),s}),r=t.cache;return t}var Pke=Tke,Oke=Pke,Rke=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Mke=/\\(\\)?/g,Ike=Oke(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Rke,function(r,s,a,i){t.push(a?i.replace(Mke,"$1"):s||r)}),t}),Dke=Ike;function Lke(e,t){for(var r=-1,s=e==null?0:e.length,a=Array(s);++r<s;)a[r]=t(e[r],r,e);return a}var TA=Lke,wI=V1,Bke=TA,$ke=eo,Fke=$g,zke=1/0,_I=wI?wI.prototype:void 0,jI=_I?_I.toString:void 0;function tZ(e){if(typeof e=="string")return e;if($ke(e))return Bke(e,tZ)+"";if(Fke(e))return jI?jI.call(e):"";var t=e+"";return t=="0"&&1/e==-zke?"-0":t}var Uke=tZ,Vke=Uke;function qke(e){return e==null?"":Vke(e)}var rZ=qke,Wke=eo,Hke=NA,Gke=Dke,Kke=rZ;function Xke(e,t){return Wke(e)?e:Hke(e,t)?[e]:Gke(Kke(e))}var nZ=Xke,Yke=$g,Zke=1/0;function Qke(e){if(typeof e=="string"||Yke(e))return e;var t=e+"";return t=="0"&&1/e==-Zke?"-0":t}var _j=Qke,Jke=nZ,e8e=_j;function t8e(e,t){t=Jke(t,e);for(var r=0,s=t.length;e!=null&&r<s;)e=e[e8e(t[r++])];return r&&r==s?e:void 0}var PA=t8e,r8e=PA;function n8e(e,t,r){var s=e==null?void 0:r8e(e,t);return s===void 0?r:s}var sZ=n8e;const bo=On(sZ);function s8e(e){return e==null}var a8e=s8e;const Yr=On(a8e);var i8e=Sd,o8e=eo,l8e=Cd,c8e="[object String]";function d8e(e){return typeof e=="string"||!o8e(e)&&l8e(e)&&i8e(e)==c8e}var u8e=d8e;const bf=On(u8e);var aZ={exports:{}},Fn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OA=Symbol.for("react.element"),RA=Symbol.for("react.portal"),jj=Symbol.for("react.fragment"),Nj=Symbol.for("react.strict_mode"),Sj=Symbol.for("react.profiler"),Cj=Symbol.for("react.provider"),Ej=Symbol.for("react.context"),h8e=Symbol.for("react.server_context"),kj=Symbol.for("react.forward_ref"),Aj=Symbol.for("react.suspense"),Tj=Symbol.for("react.suspense_list"),Pj=Symbol.for("react.memo"),Oj=Symbol.for("react.lazy"),f8e=Symbol.for("react.offscreen"),iZ;iZ=Symbol.for("react.module.reference");function nl(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case OA:switch(e=e.type,e){case jj:case Sj:case Nj:case Aj:case Tj:return e;default:switch(e=e&&e.$$typeof,e){case h8e:case Ej:case kj:case Oj:case Pj:case Cj:return e;default:return t}}case RA:return t}}}Fn.ContextConsumer=Ej;Fn.ContextProvider=Cj;Fn.Element=OA;Fn.ForwardRef=kj;Fn.Fragment=jj;Fn.Lazy=Oj;Fn.Memo=Pj;Fn.Portal=RA;Fn.Profiler=Sj;Fn.StrictMode=Nj;Fn.Suspense=Aj;Fn.SuspenseList=Tj;Fn.isAsyncMode=function(){return!1};Fn.isConcurrentMode=function(){return!1};Fn.isContextConsumer=function(e){return nl(e)===Ej};Fn.isContextProvider=function(e){return nl(e)===Cj};Fn.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===OA};Fn.isForwardRef=function(e){return nl(e)===kj};Fn.isFragment=function(e){return nl(e)===jj};Fn.isLazy=function(e){return nl(e)===Oj};Fn.isMemo=function(e){return nl(e)===Pj};Fn.isPortal=function(e){return nl(e)===RA};Fn.isProfiler=function(e){return nl(e)===Sj};Fn.isStrictMode=function(e){return nl(e)===Nj};Fn.isSuspense=function(e){return nl(e)===Aj};Fn.isSuspenseList=function(e){return nl(e)===Tj};Fn.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===jj||e===Sj||e===Nj||e===Aj||e===Tj||e===f8e||typeof e=="object"&&e!==null&&(e.$$typeof===Oj||e.$$typeof===Pj||e.$$typeof===Cj||e.$$typeof===Ej||e.$$typeof===kj||e.$$typeof===iZ||e.getModuleId!==void 0)};Fn.typeOf=nl;aZ.exports=Fn;var m8e=aZ.exports,p8e=Sd,g8e=Cd,x8e="[object Number]";function v8e(e){return typeof e=="number"||g8e(e)&&p8e(e)==x8e}var oZ=v8e;const y8e=On(oZ);var b8e=oZ;function w8e(e){return b8e(e)&&e!=+e}var _8e=w8e;const qg=On(_8e);var ji=function(t){return t===0?0:t>0?1:-1},Rh=function(t){return bf(t)&&t.indexOf("%")===t.length-1},Lt=function(t){return y8e(t)&&!qg(t)},j8e=function(t){return Yr(t)},fa=function(t){return Lt(t)||bf(t)},N8e=0,Wg=function(t){var r=++N8e;return"".concat(t||"").concat(r)},Ni=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Lt(t)&&!bf(t))return s;var i;if(Rh(t)){var o=t.indexOf("%");i=r*parseFloat(t.slice(0,o))/100}else i=+t;return qg(i)&&(i=s),a&&i>r&&(i=r),i},Zd=function(t){if(!t)return null;var r=Object.keys(t);return r&&r.length?t[r[0]]:null},S8e=function(t){if(!Array.isArray(t))return!1;for(var r=t.length,s={},a=0;a<r;a++)if(!s[t[a]])s[t[a]]=!0;else return!0;return!1},$i=function(t,r){return Lt(t)&&Lt(r)?function(s){return t+s*(r-t)}:function(){return r}};function e2(e,t,r){return!e||!e.length?null:e.find(function(s){return s&&(typeof t=="function"?t(s):bo(s,t))===r})}var C8e=function(t,r){return Lt(t)&&Lt(r)?t-r:bf(t)&&bf(r)?t.localeCompare(r):t instanceof Date&&r instanceof Date?t.getTime()-r.getTime():String(t).localeCompare(String(r))};function Jm(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var s in t)if({}.hasOwnProperty.call(t,s)&&!{}.hasOwnProperty.call(e,s))return!1;return!0}function _5(e){"@babel/helpers - typeof";return _5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_5(e)}var E8e=["viewBox","children"],k8e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],NI=["points","pathLength"],y4={svg:E8e,polygon:NI,polyline:NI},MA=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],t2=function(t,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(P.isValidElement(t)&&(s=t.props),!Fg(s))return null;var a={};return Object.keys(s).forEach(function(i){MA.includes(i)&&(a[i]=r||function(o){return s[i](s,o)})}),a},A8e=function(t,r,s){return function(a){return t(r,s,a),null}},wf=function(t,r,s){if(!Fg(t)||_5(t)!=="object")return null;var a=null;return Object.keys(t).forEach(function(i){var o=t[i];MA.includes(i)&&typeof o=="function"&&(a||(a={}),a[i]=A8e(o,r,s))}),a},T8e=["children"],P8e=["children"];function SI(e,t){if(e==null)return{};var r=O8e(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function O8e(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function j5(e){"@babel/helpers - typeof";return j5=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j5(e)}var CI={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},rd=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},EI=null,b4=null,IA=function e(t){if(t===EI&&Array.isArray(b4))return b4;var r=[];return P.Children.forEach(t,function(s){Yr(s)||(m8e.isFragment(s)?r=r.concat(e(s.props.children)):r.push(s))}),b4=r,EI=t,r};function Go(e,t){var r=[],s=[];return Array.isArray(t)?s=t.map(function(a){return rd(a)}):s=[rd(t)],IA(e).forEach(function(a){var i=bo(a,"type.displayName")||bo(a,"type.name");s.indexOf(i)!==-1&&r.push(a)}),r}function lo(e,t){var r=Go(e,t);return r&&r[0]}var kI=function(t){if(!t||!t.props)return!1;var r=t.props,s=r.width,a=r.height;return!(!Lt(s)||s<=0||!Lt(a)||a<=0)},R8e=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],M8e=function(t){return t&&t.type&&bf(t.type)&&R8e.indexOf(t.type)>=0},I8e=function(t){return t&&j5(t)==="object"&&"clipDot"in t},D8e=function(t,r,s,a){var i,o=(i=y4==null?void 0:y4[a])!==null&&i!==void 0?i:[];return r.startsWith("data-")||!Lr(t)&&(a&&o.includes(r)||k8e.includes(r))||s&&MA.includes(r)},Sr=function(t,r,s){if(!t||typeof t=="function"||typeof t=="boolean")return null;var a=t;if(P.isValidElement(t)&&(a=t.props),!Fg(a))return null;var i={};return Object.keys(a).forEach(function(o){var c;D8e((c=a)===null||c===void 0?void 0:c[o],o,r,s)&&(i[o]=a[o])}),i},N5=function e(t,r){if(t===r)return!0;var s=P.Children.count(t);if(s!==P.Children.count(r))return!1;if(s===0)return!0;if(s===1)return AI(Array.isArray(t)?t[0]:t,Array.isArray(r)?r[0]:r);for(var a=0;a<s;a++){var i=t[a],o=r[a];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!AI(i,o))return!1}return!0},AI=function(t,r){if(Yr(t)&&Yr(r))return!0;if(!Yr(t)&&!Yr(r)){var s=t.props||{},a=s.children,i=SI(s,T8e),o=r.props||{},c=o.children,d=SI(o,P8e);return a&&c?Jm(i,d)&&N5(a,c):!a&&!c?Jm(i,d):!1}return!1},TI=function(t,r){var s=[],a={};return IA(t).forEach(function(i,o){if(M8e(i))s.push(i);else if(i){var c=rd(i.type),d=r[c]||{},l=d.handler,u=d.once;if(l&&(!u||!a[c])){var h=l(i,c,o);s.push(h),a[c]=!0}}}),s},L8e=function(t){var r=t&&t.type;return r&&CI[r]?CI[r]:null},B8e=function(t,r){return IA(r).indexOf(t)},$8e=["children","width","height","viewBox","className","style","title","desc"];function S5(){return S5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},S5.apply(this,arguments)}function F8e(e,t){if(e==null)return{};var r=z8e(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function z8e(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function C5(e){var t=e.children,r=e.width,s=e.height,a=e.viewBox,i=e.className,o=e.style,c=e.title,d=e.desc,l=F8e(e,$8e),u=a||{width:r,height:s,x:0,y:0},h=Xr("recharts-surface",i);return we.createElement("svg",S5({},Sr(l,!0,"svg"),{className:h,width:r,height:s,style:o,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),we.createElement("title",null,c),we.createElement("desc",null,d),t)}var U8e=["children","className"];function E5(){return E5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},E5.apply(this,arguments)}function V8e(e,t){if(e==null)return{};var r=q8e(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function q8e(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}var bn=we.forwardRef(function(e,t){var r=e.children,s=e.className,a=V8e(e,U8e),i=Xr("recharts-layer",s);return we.createElement("g",E5({className:i},Sr(a,!0),{ref:t}),r)}),Al=function(t,r){for(var s=arguments.length,a=new Array(s>2?s-2:0),i=2;i<s;i++)a[i-2]=arguments[i]};function W8e(e,t,r){var s=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(a);++s<a;)i[s]=e[s+t];return i}var H8e=W8e,G8e=H8e;function K8e(e,t,r){var s=e.length;return r=r===void 0?s:r,!t&&r>=s?e:G8e(e,t,r)}var X8e=K8e,Y8e="\\ud800-\\udfff",Z8e="\\u0300-\\u036f",Q8e="\\ufe20-\\ufe2f",J8e="\\u20d0-\\u20ff",eAe=Z8e+Q8e+J8e,tAe="\\ufe0e\\ufe0f",rAe="\\u200d",nAe=RegExp("["+rAe+Y8e+eAe+tAe+"]");function sAe(e){return nAe.test(e)}var lZ=sAe;function aAe(e){return e.split("")}var iAe=aAe,cZ="\\ud800-\\udfff",oAe="\\u0300-\\u036f",lAe="\\ufe20-\\ufe2f",cAe="\\u20d0-\\u20ff",dAe=oAe+lAe+cAe,uAe="\\ufe0e\\ufe0f",hAe="["+cZ+"]",k5="["+dAe+"]",A5="\\ud83c[\\udffb-\\udfff]",fAe="(?:"+k5+"|"+A5+")",dZ="[^"+cZ+"]",uZ="(?:\\ud83c[\\udde6-\\uddff]){2}",hZ="[\\ud800-\\udbff][\\udc00-\\udfff]",mAe="\\u200d",fZ=fAe+"?",mZ="["+uAe+"]?",pAe="(?:"+mAe+"(?:"+[dZ,uZ,hZ].join("|")+")"+mZ+fZ+")*",gAe=mZ+fZ+pAe,xAe="(?:"+[dZ+k5+"?",k5,uZ,hZ,hAe].join("|")+")",vAe=RegExp(A5+"(?="+A5+")|"+xAe+gAe,"g");function yAe(e){return e.match(vAe)||[]}var bAe=yAe,wAe=iAe,_Ae=lZ,jAe=bAe;function NAe(e){return _Ae(e)?jAe(e):wAe(e)}var SAe=NAe,CAe=X8e,EAe=lZ,kAe=SAe,AAe=rZ;function TAe(e){return function(t){t=AAe(t);var r=EAe(t)?kAe(t):void 0,s=r?r[0]:t.charAt(0),a=r?CAe(r,1).join(""):t.slice(1);return s[e]()+a}}var PAe=TAe,OAe=PAe,RAe=OAe("toUpperCase"),MAe=RAe;const Rj=On(MAe);function ts(e){return function(){return e}}const pZ=Math.cos,r2=Math.sin,zl=Math.sqrt,n2=Math.PI,Mj=2*n2,T5=Math.PI,P5=2*T5,wh=1e-6,IAe=P5-wh;function gZ(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function DAe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return gZ;const r=10**t;return function(s){this._+=s[0];for(let a=1,i=s.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+s[a]}}class LAe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?gZ:DAe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,s,a){this._append`Q${+t},${+r},${this._x1=+s},${this._y1=+a}`}bezierCurveTo(t,r,s,a,i,o){this._append`C${+t},${+r},${+s},${+a},${this._x1=+i},${this._y1=+o}`}arcTo(t,r,s,a,i){if(t=+t,r=+r,s=+s,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,c=this._y1,d=s-t,l=a-r,u=o-t,h=c-r,f=u*u+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(f>wh)if(!(Math.abs(h*d-l*u)>wh)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let m=s-o,p=a-c,g=d*d+l*l,v=m*m+p*p,x=Math.sqrt(g),y=Math.sqrt(f),b=i*Math.tan((T5-Math.acos((g+f-v)/(2*x*y)))/2),j=b/y,T=b/x;Math.abs(j-1)>wh&&this._append`L${t+j*u},${r+j*h}`,this._append`A${i},${i},0,0,${+(h*m>u*p)},${this._x1=t+T*d},${this._y1=r+T*l}`}}arc(t,r,s,a,i,o){if(t=+t,r=+r,s=+s,o=!!o,s<0)throw new Error(`negative radius: ${s}`);let c=s*Math.cos(a),d=s*Math.sin(a),l=t+c,u=r+d,h=1^o,f=o?a-i:i-a;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>wh||Math.abs(this._y1-u)>wh)&&this._append`L${l},${u}`,s&&(f<0&&(f=f%P5+P5),f>IAe?this._append`A${s},${s},0,1,${h},${t-c},${r-d}A${s},${s},0,1,${h},${this._x1=l},${this._y1=u}`:f>wh&&this._append`A${s},${s},0,${+(f>=T5)},${h},${this._x1=t+s*Math.cos(i)},${this._y1=r+s*Math.sin(i)}`)}rect(t,r,s,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${s=+s}v${+a}h${-s}Z`}toString(){return this._}}function DA(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const s=Math.floor(r);if(!(s>=0))throw new RangeError(`invalid digits: ${r}`);t=s}return e},()=>new LAe(t)}function LA(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function xZ(e){this._context=e}xZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Ij(e){return new xZ(e)}function vZ(e){return e[0]}function yZ(e){return e[1]}function bZ(e,t){var r=ts(!0),s=null,a=Ij,i=null,o=DA(c);e=typeof e=="function"?e:e===void 0?vZ:ts(e),t=typeof t=="function"?t:t===void 0?yZ:ts(t);function c(d){var l,u=(d=LA(d)).length,h,f=!1,m;for(s==null&&(i=a(m=o())),l=0;l<=u;++l)!(l<u&&r(h=d[l],l,d))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(h,l,d),+t(h,l,d));if(m)return i=null,m+""||null}return c.x=function(d){return arguments.length?(e=typeof d=="function"?d:ts(+d),c):e},c.y=function(d){return arguments.length?(t=typeof d=="function"?d:ts(+d),c):t},c.defined=function(d){return arguments.length?(r=typeof d=="function"?d:ts(!!d),c):r},c.curve=function(d){return arguments.length?(a=d,s!=null&&(i=a(s)),c):a},c.context=function(d){return arguments.length?(d==null?s=i=null:i=a(s=d),c):s},c}function rb(e,t,r){var s=null,a=ts(!0),i=null,o=Ij,c=null,d=DA(l);e=typeof e=="function"?e:e===void 0?vZ:ts(+e),t=typeof t=="function"?t:ts(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?yZ:ts(+r);function l(h){var f,m,p,g=(h=LA(h)).length,v,x=!1,y,b=new Array(g),j=new Array(g);for(i==null&&(c=o(y=d())),f=0;f<=g;++f){if(!(f<g&&a(v=h[f],f,h))===x)if(x=!x)m=f,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),p=f-1;p>=m;--p)c.point(b[p],j[p]);c.lineEnd(),c.areaEnd()}x&&(b[f]=+e(v,f,h),j[f]=+t(v,f,h),c.point(s?+s(v,f,h):b[f],r?+r(v,f,h):j[f]))}if(y)return c=null,y+""||null}function u(){return bZ().defined(a).curve(o).context(i)}return l.x=function(h){return arguments.length?(e=typeof h=="function"?h:ts(+h),s=null,l):e},l.x0=function(h){return arguments.length?(e=typeof h=="function"?h:ts(+h),l):e},l.x1=function(h){return arguments.length?(s=h==null?null:typeof h=="function"?h:ts(+h),l):s},l.y=function(h){return arguments.length?(t=typeof h=="function"?h:ts(+h),r=null,l):t},l.y0=function(h){return arguments.length?(t=typeof h=="function"?h:ts(+h),l):t},l.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:ts(+h),l):r},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(r)},l.lineX1=function(){return u().x(s).y(t)},l.defined=function(h){return arguments.length?(a=typeof h=="function"?h:ts(!!h),l):a},l.curve=function(h){return arguments.length?(o=h,i!=null&&(c=o(i)),l):o},l.context=function(h){return arguments.length?(h==null?i=c=null:c=o(i=h),l):i},l}class wZ{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function BAe(e){return new wZ(e,!0)}function $Ae(e){return new wZ(e,!1)}const BA={draw(e,t){const r=zl(t/n2);e.moveTo(r,0),e.arc(0,0,r,0,Mj)}},FAe={draw(e,t){const r=zl(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},_Z=zl(1/3),zAe=_Z*2,UAe={draw(e,t){const r=zl(t/zAe),s=r*_Z;e.moveTo(0,-r),e.lineTo(s,0),e.lineTo(0,r),e.lineTo(-s,0),e.closePath()}},VAe={draw(e,t){const r=zl(t),s=-r/2;e.rect(s,s,r,r)}},qAe=.8908130915292852,jZ=r2(n2/10)/r2(7*n2/10),WAe=r2(Mj/10)*jZ,HAe=-pZ(Mj/10)*jZ,GAe={draw(e,t){const r=zl(t*qAe),s=WAe*r,a=HAe*r;e.moveTo(0,-r),e.lineTo(s,a);for(let i=1;i<5;++i){const o=Mj*i/5,c=pZ(o),d=r2(o);e.lineTo(d*r,-c*r),e.lineTo(c*s-d*a,d*s+c*a)}e.closePath()}},w4=zl(3),KAe={draw(e,t){const r=-zl(t/(w4*3));e.moveTo(0,r*2),e.lineTo(-w4*r,-r),e.lineTo(w4*r,-r),e.closePath()}},Po=-.5,Oo=zl(3)/2,O5=1/zl(12),XAe=(O5/2+1)*3,YAe={draw(e,t){const r=zl(t/XAe),s=r/2,a=r*O5,i=s,o=r*O5+r,c=-i,d=o;e.moveTo(s,a),e.lineTo(i,o),e.lineTo(c,d),e.lineTo(Po*s-Oo*a,Oo*s+Po*a),e.lineTo(Po*i-Oo*o,Oo*i+Po*o),e.lineTo(Po*c-Oo*d,Oo*c+Po*d),e.lineTo(Po*s+Oo*a,Po*a-Oo*s),e.lineTo(Po*i+Oo*o,Po*o-Oo*i),e.lineTo(Po*c+Oo*d,Po*d-Oo*c),e.closePath()}};function ZAe(e,t){let r=null,s=DA(a);e=typeof e=="function"?e:ts(e||BA),t=typeof t=="function"?t:ts(t===void 0?64:+t);function a(){let i;if(r||(r=i=s()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:ts(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:ts(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function s2(){}function a2(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function NZ(e){this._context=e}NZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:a2(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:a2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function QAe(e){return new NZ(e)}function SZ(e){this._context=e}SZ.prototype={areaStart:s2,areaEnd:s2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:a2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function JAe(e){return new SZ(e)}function CZ(e){this._context=e}CZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,s):this._context.moveTo(r,s);break;case 3:this._point=4;default:a2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function eTe(e){return new CZ(e)}function EZ(e){this._context=e}EZ.prototype={areaStart:s2,areaEnd:s2,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function tTe(e){return new EZ(e)}function PI(e){return e<0?-1:1}function OI(e,t,r){var s=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(s||a<0&&-0),o=(r-e._y1)/(a||s<0&&-0),c=(i*a+o*s)/(s+a);return(PI(i)+PI(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(c))||0}function RI(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function _4(e,t,r){var s=e._x0,a=e._y0,i=e._x1,o=e._y1,c=(i-s)/3;e._context.bezierCurveTo(s+c,a+c*t,i-c,o-c*r,i,o)}function i2(e){this._context=e}i2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:_4(this,this._t0,RI(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,_4(this,RI(this,r=OI(this,e,t)),r);break;default:_4(this,this._t0,r=OI(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function kZ(e){this._context=new AZ(e)}(kZ.prototype=Object.create(i2.prototype)).point=function(e,t){i2.prototype.point.call(this,t,e)};function AZ(e){this._context=e}AZ.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,s,a,i){this._context.bezierCurveTo(t,e,s,r,i,a)}};function rTe(e){return new i2(e)}function nTe(e){return new kZ(e)}function TZ(e){this._context=e}TZ.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var s=MI(e),a=MI(t),i=0,o=1;o<r;++i,++o)this._context.bezierCurveTo(s[0][i],a[0][i],s[1][i],a[1][i],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function MI(e){var t,r=e.length-1,s,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)s=a[t]/i[t-1],i[t]-=s,o[t]-=s*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function sTe(e){return new TZ(e)}function Dj(e,t){this._context=e,this._t=t}Dj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function aTe(e){return new Dj(e,.5)}function iTe(e){return new Dj(e,0)}function oTe(e){return new Dj(e,1)}function Ip(e,t){if((o=e.length)>1)for(var r=1,s,a,i=e[t[0]],o,c=i.length;r<o;++r)for(a=i,i=e[t[r]],s=0;s<c;++s)i[s][1]+=i[s][0]=isNaN(a[s][1])?a[s][0]:a[s][1]}function R5(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function lTe(e,t){return e[t]}function cTe(e){const t=[];return t.key=e,t}function dTe(){var e=ts([]),t=R5,r=Ip,s=lTe;function a(i){var o=Array.from(e.apply(this,arguments),cTe),c,d=o.length,l=-1,u;for(const h of i)for(c=0,++l;c<d;++c)(o[c][l]=[0,+s(h,o[c].key,l,i)]).data=h;for(c=0,u=LA(t(o));c<d;++c)o[u[c]].index=c;return r(o,u),o}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:ts(Array.from(i)),a):e},a.value=function(i){return arguments.length?(s=typeof i=="function"?i:ts(+i),a):s},a.order=function(i){return arguments.length?(t=i==null?R5:typeof i=="function"?i:ts(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Ip,a):r},a}function uTe(e,t){if((s=e.length)>0){for(var r,s,a=0,i=e[0].length,o;a<i;++a){for(o=r=0;r<s;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<s;++r)e[r][a][1]/=o}Ip(e,t)}}function hTe(e,t){if((a=e.length)>0){for(var r=0,s=e[t[0]],a,i=s.length;r<i;++r){for(var o=0,c=0;o<a;++o)c+=e[o][r][1]||0;s[r][1]+=s[r][0]=-c/2}Ip(e,t)}}function fTe(e,t){if(!(!((o=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,s=1,a,i,o;s<i;++s){for(var c=0,d=0,l=0;c<o;++c){for(var u=e[t[c]],h=u[s][1]||0,f=u[s-1][1]||0,m=(h-f)/2,p=0;p<c;++p){var g=e[t[p]],v=g[s][1]||0,x=g[s-1][1]||0;m+=v-x}d+=h,l+=m*h}a[s-1][1]+=a[s-1][0]=r,d&&(r-=l/d)}a[s-1][1]+=a[s-1][0]=r,Ip(e,t)}}function _v(e){"@babel/helpers - typeof";return _v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_v(e)}var mTe=["type","size","sizeType"];function M5(){return M5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},M5.apply(this,arguments)}function II(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function DI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?II(Object(r),!0).forEach(function(s){pTe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):II(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function pTe(e,t,r){return t=gTe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gTe(e){var t=xTe(e,"string");return _v(t)=="symbol"?t:t+""}function xTe(e,t){if(_v(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(_v(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vTe(e,t){if(e==null)return{};var r=yTe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function yTe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}var PZ={symbolCircle:BA,symbolCross:FAe,symbolDiamond:UAe,symbolSquare:VAe,symbolStar:GAe,symbolTriangle:KAe,symbolWye:YAe},bTe=Math.PI/180,wTe=function(t){var r="symbol".concat(Rj(t));return PZ[r]||BA},_Te=function(t,r,s){if(r==="area")return t;switch(s){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var a=18*bTe;return 1.25*t*t*(Math.tan(a)-Math.tan(a*2)*Math.pow(Math.tan(a),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},jTe=function(t,r){PZ["symbol".concat(Rj(t))]=r},$A=function(t){var r=t.type,s=r===void 0?"circle":r,a=t.size,i=a===void 0?64:a,o=t.sizeType,c=o===void 0?"area":o,d=vTe(t,mTe),l=DI(DI({},d),{},{type:s,size:i,sizeType:c}),u=function(){var v=wTe(s),x=ZAe().type(v).size(_Te(i,c,s));return x()},h=l.className,f=l.cx,m=l.cy,p=Sr(l,!0);return f===+f&&m===+m&&i===+i?we.createElement("path",M5({},p,{className:Xr("recharts-symbols",h),transform:"translate(".concat(f,", ").concat(m,")"),d:u()})):null};$A.registerSymbol=jTe;function Dp(e){"@babel/helpers - typeof";return Dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dp(e)}function I5(){return I5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},I5.apply(this,arguments)}function LI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function NTe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LI(Object(r),!0).forEach(function(s){jv(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LI(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function STe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function CTe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,RZ(s.key),s)}}function ETe(e,t,r){return t&&CTe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function kTe(e,t,r){return t=o2(t),ATe(e,OZ()?Reflect.construct(t,r||[],o2(e).constructor):t.apply(e,r))}function ATe(e,t){if(t&&(Dp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return TTe(e)}function TTe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function OZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(OZ=function(){return!!e})()}function o2(e){return o2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},o2(e)}function PTe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&D5(e,t)}function D5(e,t){return D5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},D5(e,t)}function jv(e,t,r){return t=RZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RZ(e){var t=OTe(e,"string");return Dp(t)=="symbol"?t:t+""}function OTe(e,t){if(Dp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Dp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ro=32,FA=function(e){function t(){return STe(this,t),kTe(this,t,arguments)}return PTe(t,e),ETe(t,[{key:"renderIcon",value:function(s){var a=this.props.inactiveColor,i=Ro/2,o=Ro/6,c=Ro/3,d=s.inactive?a:s.color;if(s.type==="plainline")return we.createElement("line",{strokeWidth:4,fill:"none",stroke:d,strokeDasharray:s.payload.strokeDasharray,x1:0,y1:i,x2:Ro,y2:i,className:"recharts-legend-icon"});if(s.type==="line")return we.createElement("path",{strokeWidth:4,fill:"none",stroke:d,d:"M0,".concat(i,"h").concat(c,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*c,",").concat(i,`
            H`).concat(Ro,"M").concat(2*c,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(c,",").concat(i),className:"recharts-legend-icon"});if(s.type==="rect")return we.createElement("path",{stroke:"none",fill:d,d:"M0,".concat(Ro/8,"h").concat(Ro,"v").concat(Ro*3/4,"h").concat(-Ro,"z"),className:"recharts-legend-icon"});if(we.isValidElement(s.legendIcon)){var l=NTe({},s);return delete l.legendIcon,we.cloneElement(s.legendIcon,l)}return we.createElement($A,{fill:d,cx:i,cy:i,size:Ro,sizeType:"diameter",type:s.type})}},{key:"renderItems",value:function(){var s=this,a=this.props,i=a.payload,o=a.iconSize,c=a.layout,d=a.formatter,l=a.inactiveColor,u={x:0,y:0,width:Ro,height:Ro},h={display:c==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(m,p){var g=m.formatter||d,v=Xr(jv(jv({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",m.inactive));if(m.type==="none")return null;var x=Lr(m.value)?null:m.value;Al(!Lr(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var y=m.inactive?l:m.color;return we.createElement("li",I5({className:v,style:h,key:"legend-item-".concat(p)},wf(s.props,m,p)),we.createElement(C5,{width:o,height:o,viewBox:u,style:f},s.renderIcon(m)),we.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},g?g(x,m,p):x))})}},{key:"render",value:function(){var s=this.props,a=s.payload,i=s.layout,o=s.align;if(!a||!a.length)return null;var c={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return we.createElement("ul",{className:"recharts-default-legend",style:c},this.renderItems())}}])}(P.PureComponent);jv(FA,"displayName","Legend");jv(FA,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var RTe=bj;function MTe(){this.__data__=new RTe,this.size=0}var ITe=MTe;function DTe(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var LTe=DTe;function BTe(e){return this.__data__.get(e)}var $Te=BTe;function FTe(e){return this.__data__.has(e)}var zTe=FTe,UTe=bj,VTe=EA,qTe=kA,WTe=200;function HTe(e,t){var r=this.__data__;if(r instanceof UTe){var s=r.__data__;if(!VTe||s.length<WTe-1)return s.push([e,t]),this.size=++r.size,this;r=this.__data__=new qTe(s)}return r.set(e,t),this.size=r.size,this}var GTe=HTe,KTe=bj,XTe=ITe,YTe=LTe,ZTe=$Te,QTe=zTe,JTe=GTe;function Hg(e){var t=this.__data__=new KTe(e);this.size=t.size}Hg.prototype.clear=XTe;Hg.prototype.delete=YTe;Hg.prototype.get=ZTe;Hg.prototype.has=QTe;Hg.prototype.set=JTe;var MZ=Hg,ePe="__lodash_hash_undefined__";function tPe(e){return this.__data__.set(e,ePe),this}var rPe=tPe;function nPe(e){return this.__data__.has(e)}var sPe=nPe,aPe=kA,iPe=rPe,oPe=sPe;function l2(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new aPe;++t<r;)this.add(e[t])}l2.prototype.add=l2.prototype.push=iPe;l2.prototype.has=oPe;var IZ=l2;function lPe(e,t){for(var r=-1,s=e==null?0:e.length;++r<s;)if(t(e[r],r,e))return!0;return!1}var DZ=lPe;function cPe(e,t){return e.has(t)}var LZ=cPe,dPe=IZ,uPe=DZ,hPe=LZ,fPe=1,mPe=2;function pPe(e,t,r,s,a,i){var o=r&fPe,c=e.length,d=t.length;if(c!=d&&!(o&&d>c))return!1;var l=i.get(e),u=i.get(t);if(l&&u)return l==t&&u==e;var h=-1,f=!0,m=r&mPe?new dPe:void 0;for(i.set(e,t),i.set(t,e);++h<c;){var p=e[h],g=t[h];if(s)var v=o?s(g,p,h,t,e,i):s(p,g,h,e,t,i);if(v!==void 0){if(v)continue;f=!1;break}if(m){if(!uPe(t,function(x,y){if(!hPe(m,y)&&(p===x||a(p,x,r,s,i)))return m.push(y)})){f=!1;break}}else if(!(p===g||a(p,g,r,s,i))){f=!1;break}}return i.delete(e),i.delete(t),f}var BZ=pPe,gPe=Mc,xPe=gPe.Uint8Array,vPe=xPe;function yPe(e){var t=-1,r=Array(e.size);return e.forEach(function(s,a){r[++t]=[a,s]}),r}var bPe=yPe;function wPe(e){var t=-1,r=Array(e.size);return e.forEach(function(s){r[++t]=s}),r}var zA=wPe,BI=V1,$I=vPe,_Pe=CA,jPe=BZ,NPe=bPe,SPe=zA,CPe=1,EPe=2,kPe="[object Boolean]",APe="[object Date]",TPe="[object Error]",PPe="[object Map]",OPe="[object Number]",RPe="[object RegExp]",MPe="[object Set]",IPe="[object String]",DPe="[object Symbol]",LPe="[object ArrayBuffer]",BPe="[object DataView]",FI=BI?BI.prototype:void 0,j4=FI?FI.valueOf:void 0;function $Pe(e,t,r,s,a,i,o){switch(r){case BPe:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case LPe:return!(e.byteLength!=t.byteLength||!i(new $I(e),new $I(t)));case kPe:case APe:case OPe:return _Pe(+e,+t);case TPe:return e.name==t.name&&e.message==t.message;case RPe:case IPe:return e==t+"";case PPe:var c=NPe;case MPe:var d=s&CPe;if(c||(c=SPe),e.size!=t.size&&!d)return!1;var l=o.get(e);if(l)return l==t;s|=EPe,o.set(e,t);var u=jPe(c(e),c(t),s,a,i,o);return o.delete(e),u;case DPe:if(j4)return j4.call(e)==j4.call(t)}return!1}var FPe=$Pe;function zPe(e,t){for(var r=-1,s=t.length,a=e.length;++r<s;)e[a+r]=t[r];return e}var $Z=zPe,UPe=$Z,VPe=eo;function qPe(e,t,r){var s=t(e);return VPe(e)?s:UPe(s,r(e))}var WPe=qPe;function HPe(e,t){for(var r=-1,s=e==null?0:e.length,a=0,i=[];++r<s;){var o=e[r];t(o,r,e)&&(i[a++]=o)}return i}var GPe=HPe;function KPe(){return[]}var XPe=KPe,YPe=GPe,ZPe=XPe,QPe=Object.prototype,JPe=QPe.propertyIsEnumerable,zI=Object.getOwnPropertySymbols,eOe=zI?function(e){return e==null?[]:(e=Object(e),YPe(zI(e),function(t){return JPe.call(e,t)}))}:ZPe,tOe=eOe;function rOe(e,t){for(var r=-1,s=Array(e);++r<e;)s[r]=t(r);return s}var nOe=rOe,sOe=Sd,aOe=Cd,iOe="[object Arguments]";function oOe(e){return aOe(e)&&sOe(e)==iOe}var lOe=oOe,UI=lOe,cOe=Cd,FZ=Object.prototype,dOe=FZ.hasOwnProperty,uOe=FZ.propertyIsEnumerable,hOe=UI(function(){return arguments}())?UI:function(e){return cOe(e)&&dOe.call(e,"callee")&&!uOe.call(e,"callee")},UA=hOe,c2={exports:{}};function fOe(){return!1}var mOe=fOe;c2.exports;(function(e,t){var r=Mc,s=mOe,a=t&&!t.nodeType&&t,i=a&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===a,c=o?r.Buffer:void 0,d=c?c.isBuffer:void 0,l=d||s;e.exports=l})(c2,c2.exports);var zZ=c2.exports,pOe=9007199254740991,gOe=/^(?:0|[1-9]\d*)$/;function xOe(e,t){var r=typeof e;return t=t??pOe,!!t&&(r=="number"||r!="symbol"&&gOe.test(e))&&e>-1&&e%1==0&&e<t}var VA=xOe,vOe=9007199254740991;function yOe(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=vOe}var qA=yOe,bOe=Sd,wOe=qA,_Oe=Cd,jOe="[object Arguments]",NOe="[object Array]",SOe="[object Boolean]",COe="[object Date]",EOe="[object Error]",kOe="[object Function]",AOe="[object Map]",TOe="[object Number]",POe="[object Object]",OOe="[object RegExp]",ROe="[object Set]",MOe="[object String]",IOe="[object WeakMap]",DOe="[object ArrayBuffer]",LOe="[object DataView]",BOe="[object Float32Array]",$Oe="[object Float64Array]",FOe="[object Int8Array]",zOe="[object Int16Array]",UOe="[object Int32Array]",VOe="[object Uint8Array]",qOe="[object Uint8ClampedArray]",WOe="[object Uint16Array]",HOe="[object Uint32Array]",hs={};hs[BOe]=hs[$Oe]=hs[FOe]=hs[zOe]=hs[UOe]=hs[VOe]=hs[qOe]=hs[WOe]=hs[HOe]=!0;hs[jOe]=hs[NOe]=hs[DOe]=hs[SOe]=hs[LOe]=hs[COe]=hs[EOe]=hs[kOe]=hs[AOe]=hs[TOe]=hs[POe]=hs[OOe]=hs[ROe]=hs[MOe]=hs[IOe]=!1;function GOe(e){return _Oe(e)&&wOe(e.length)&&!!hs[bOe(e)]}var KOe=GOe;function XOe(e){return function(t){return e(t)}}var UZ=XOe,d2={exports:{}};d2.exports;(function(e,t){var r=YY,s=t&&!t.nodeType&&t,a=s&&!0&&e&&!e.nodeType&&e,i=a&&a.exports===s,o=i&&r.process,c=function(){try{var d=a&&a.require&&a.require("util").types;return d||o&&o.binding&&o.binding("util")}catch{}}();e.exports=c})(d2,d2.exports);var YOe=d2.exports,ZOe=KOe,QOe=UZ,VI=YOe,qI=VI&&VI.isTypedArray,JOe=qI?QOe(qI):ZOe,VZ=JOe,eRe=nOe,tRe=UA,rRe=eo,nRe=zZ,sRe=VA,aRe=VZ,iRe=Object.prototype,oRe=iRe.hasOwnProperty;function lRe(e,t){var r=rRe(e),s=!r&&tRe(e),a=!r&&!s&&nRe(e),i=!r&&!s&&!a&&aRe(e),o=r||s||a||i,c=o?eRe(e.length,String):[],d=c.length;for(var l in e)(t||oRe.call(e,l))&&!(o&&(l=="length"||a&&(l=="offset"||l=="parent")||i&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||sRe(l,d)))&&c.push(l);return c}var cRe=lRe,dRe=Object.prototype;function uRe(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||dRe;return e===r}var hRe=uRe;function fRe(e,t){return function(r){return e(t(r))}}var qZ=fRe,mRe=qZ,pRe=mRe(Object.keys,Object),gRe=pRe,xRe=hRe,vRe=gRe,yRe=Object.prototype,bRe=yRe.hasOwnProperty;function wRe(e){if(!xRe(e))return vRe(e);var t=[];for(var r in Object(e))bRe.call(e,r)&&r!="constructor"&&t.push(r);return t}var _Re=wRe,jRe=SA,NRe=qA;function SRe(e){return e!=null&&NRe(e.length)&&!jRe(e)}var q1=SRe,CRe=cRe,ERe=_Re,kRe=q1;function ARe(e){return kRe(e)?CRe(e):ERe(e)}var Lj=ARe,TRe=WPe,PRe=tOe,ORe=Lj;function RRe(e){return TRe(e,ORe,PRe)}var MRe=RRe,WI=MRe,IRe=1,DRe=Object.prototype,LRe=DRe.hasOwnProperty;function BRe(e,t,r,s,a,i){var o=r&IRe,c=WI(e),d=c.length,l=WI(t),u=l.length;if(d!=u&&!o)return!1;for(var h=d;h--;){var f=c[h];if(!(o?f in t:LRe.call(t,f)))return!1}var m=i.get(e),p=i.get(t);if(m&&p)return m==t&&p==e;var g=!0;i.set(e,t),i.set(t,e);for(var v=o;++h<d;){f=c[h];var x=e[f],y=t[f];if(s)var b=o?s(y,x,f,t,e,i):s(x,y,f,e,t,i);if(!(b===void 0?x===y||a(x,y,r,s,i):b)){g=!1;break}v||(v=f=="constructor")}if(g&&!v){var j=e.constructor,T=t.constructor;j!=T&&"constructor"in e&&"constructor"in t&&!(typeof j=="function"&&j instanceof j&&typeof T=="function"&&T instanceof T)&&(g=!1)}return i.delete(e),i.delete(t),g}var $Re=BRe,FRe=Mf,zRe=Mc,URe=FRe(zRe,"DataView"),VRe=URe,qRe=Mf,WRe=Mc,HRe=qRe(WRe,"Promise"),GRe=HRe,KRe=Mf,XRe=Mc,YRe=KRe(XRe,"Set"),WZ=YRe,ZRe=Mf,QRe=Mc,JRe=ZRe(QRe,"WeakMap"),eMe=JRe,L5=VRe,B5=EA,$5=GRe,F5=WZ,z5=eMe,HZ=Sd,Gg=QY,HI="[object Map]",tMe="[object Object]",GI="[object Promise]",KI="[object Set]",XI="[object WeakMap]",YI="[object DataView]",rMe=Gg(L5),nMe=Gg(B5),sMe=Gg($5),aMe=Gg(F5),iMe=Gg(z5),_h=HZ;(L5&&_h(new L5(new ArrayBuffer(1)))!=YI||B5&&_h(new B5)!=HI||$5&&_h($5.resolve())!=GI||F5&&_h(new F5)!=KI||z5&&_h(new z5)!=XI)&&(_h=function(e){var t=HZ(e),r=t==tMe?e.constructor:void 0,s=r?Gg(r):"";if(s)switch(s){case rMe:return YI;case nMe:return HI;case sMe:return GI;case aMe:return KI;case iMe:return XI}return t});var oMe=_h,N4=MZ,lMe=BZ,cMe=FPe,dMe=$Re,ZI=oMe,QI=eo,JI=zZ,uMe=VZ,hMe=1,e9="[object Arguments]",t9="[object Array]",nb="[object Object]",fMe=Object.prototype,r9=fMe.hasOwnProperty;function mMe(e,t,r,s,a,i){var o=QI(e),c=QI(t),d=o?t9:ZI(e),l=c?t9:ZI(t);d=d==e9?nb:d,l=l==e9?nb:l;var u=d==nb,h=l==nb,f=d==l;if(f&&JI(e)){if(!JI(t))return!1;o=!0,u=!1}if(f&&!u)return i||(i=new N4),o||uMe(e)?lMe(e,t,r,s,a,i):cMe(e,t,d,r,s,a,i);if(!(r&hMe)){var m=u&&r9.call(e,"__wrapped__"),p=h&&r9.call(t,"__wrapped__");if(m||p){var g=m?e.value():e,v=p?t.value():t;return i||(i=new N4),a(g,v,r,s,i)}}return f?(i||(i=new N4),dMe(e,t,r,s,a,i)):!1}var pMe=mMe,gMe=pMe,n9=Cd;function GZ(e,t,r,s,a){return e===t?!0:e==null||t==null||!n9(e)&&!n9(t)?e!==e&&t!==t:gMe(e,t,r,s,GZ,a)}var WA=GZ,xMe=MZ,vMe=WA,yMe=1,bMe=2;function wMe(e,t,r,s){var a=r.length,i=a,o=!s;if(e==null)return!i;for(e=Object(e);a--;){var c=r[a];if(o&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++a<i;){c=r[a];var d=c[0],l=e[d],u=c[1];if(o&&c[2]){if(l===void 0&&!(d in e))return!1}else{var h=new xMe;if(s)var f=s(l,u,d,e,t,h);if(!(f===void 0?vMe(u,l,yMe|bMe,s,h):f))return!1}}return!0}var _Me=wMe,jMe=Yu;function NMe(e){return e===e&&!jMe(e)}var KZ=NMe,SMe=KZ,CMe=Lj;function EMe(e){for(var t=CMe(e),r=t.length;r--;){var s=t[r],a=e[s];t[r]=[s,a,SMe(a)]}return t}var kMe=EMe;function AMe(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var XZ=AMe,TMe=_Me,PMe=kMe,OMe=XZ;function RMe(e){var t=PMe(e);return t.length==1&&t[0][2]?OMe(t[0][0],t[0][1]):function(r){return r===e||TMe(r,e,t)}}var MMe=RMe;function IMe(e,t){return e!=null&&t in Object(e)}var DMe=IMe,LMe=nZ,BMe=UA,$Me=eo,FMe=VA,zMe=qA,UMe=_j;function VMe(e,t,r){t=LMe(t,e);for(var s=-1,a=t.length,i=!1;++s<a;){var o=UMe(t[s]);if(!(i=e!=null&&r(e,o)))break;e=e[o]}return i||++s!=a?i:(a=e==null?0:e.length,!!a&&zMe(a)&&FMe(o,a)&&($Me(e)||BMe(e)))}var qMe=VMe,WMe=DMe,HMe=qMe;function GMe(e,t){return e!=null&&HMe(e,t,WMe)}var KMe=GMe,XMe=WA,YMe=sZ,ZMe=KMe,QMe=NA,JMe=KZ,e7e=XZ,t7e=_j,r7e=1,n7e=2;function s7e(e,t){return QMe(e)&&JMe(t)?e7e(t7e(e),t):function(r){var s=YMe(r,e);return s===void 0&&s===t?ZMe(r,e):XMe(t,s,r7e|n7e)}}var a7e=s7e;function i7e(e){return e}var Kg=i7e;function o7e(e){return function(t){return t==null?void 0:t[e]}}var l7e=o7e,c7e=PA;function d7e(e){return function(t){return c7e(t,e)}}var u7e=d7e,h7e=l7e,f7e=u7e,m7e=NA,p7e=_j;function g7e(e){return m7e(e)?h7e(p7e(e)):f7e(e)}var x7e=g7e,v7e=MMe,y7e=a7e,b7e=Kg,w7e=eo,_7e=x7e;function j7e(e){return typeof e=="function"?e:e==null?b7e:typeof e=="object"?w7e(e)?y7e(e[0],e[1]):v7e(e):_7e(e)}var Ic=j7e;function N7e(e,t,r,s){for(var a=e.length,i=r+(s?1:-1);s?i--:++i<a;)if(t(e[i],i,e))return i;return-1}var YZ=N7e;function S7e(e){return e!==e}var C7e=S7e;function E7e(e,t,r){for(var s=r-1,a=e.length;++s<a;)if(e[s]===t)return s;return-1}var k7e=E7e,A7e=YZ,T7e=C7e,P7e=k7e;function O7e(e,t,r){return t===t?P7e(e,t,r):A7e(e,T7e,r)}var R7e=O7e,M7e=R7e;function I7e(e,t){var r=e==null?0:e.length;return!!r&&M7e(e,t,0)>-1}var D7e=I7e;function L7e(e,t,r){for(var s=-1,a=e==null?0:e.length;++s<a;)if(r(t,e[s]))return!0;return!1}var B7e=L7e;function $7e(){}var F7e=$7e,S4=WZ,z7e=F7e,U7e=zA,V7e=1/0,q7e=S4&&1/U7e(new S4([,-0]))[1]==V7e?function(e){return new S4(e)}:z7e,W7e=q7e,H7e=IZ,G7e=D7e,K7e=B7e,X7e=LZ,Y7e=W7e,Z7e=zA,Q7e=200;function J7e(e,t,r){var s=-1,a=G7e,i=e.length,o=!0,c=[],d=c;if(r)o=!1,a=K7e;else if(i>=Q7e){var l=t?null:Y7e(e);if(l)return Z7e(l);o=!1,a=X7e,d=new H7e}else d=t?[]:c;e:for(;++s<i;){var u=e[s],h=t?t(u):u;if(u=r||u!==0?u:0,o&&h===h){for(var f=d.length;f--;)if(d[f]===h)continue e;t&&d.push(h),c.push(u)}else a(d,h,r)||(d!==c&&d.push(h),c.push(u))}return c}var eIe=J7e,tIe=Ic,rIe=eIe;function nIe(e,t){return e&&e.length?rIe(e,tIe(t)):[]}var sIe=nIe;const s9=On(sIe);function ZZ(e,t,r){return t===!0?s9(e,r):Lr(t)?s9(e,t):e}function Lp(e){"@babel/helpers - typeof";return Lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lp(e)}var aIe=["ref"];function a9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function zc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a9(Object(r),!0).forEach(function(s){Bj(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function iIe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i9(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,JZ(s.key),s)}}function oIe(e,t,r){return t&&i9(e.prototype,t),r&&i9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lIe(e,t,r){return t=u2(t),cIe(e,QZ()?Reflect.construct(t,r||[],u2(e).constructor):t.apply(e,r))}function cIe(e,t){if(t&&(Lp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dIe(e)}function dIe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QZ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(QZ=function(){return!!e})()}function u2(e){return u2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},u2(e)}function uIe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&U5(e,t)}function U5(e,t){return U5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},U5(e,t)}function Bj(e,t,r){return t=JZ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JZ(e){var t=hIe(e,"string");return Lp(t)=="symbol"?t:t+""}function hIe(e,t){if(Lp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Lp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fIe(e,t){if(e==null)return{};var r=mIe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function mIe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function pIe(e){return e.value}function gIe(e,t){if(we.isValidElement(e))return we.cloneElement(e,t);if(typeof e=="function")return we.createElement(e,t);t.ref;var r=fIe(t,aIe);return we.createElement(FA,r)}var o9=1,Xh=function(e){function t(){var r;iIe(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return r=lIe(this,t,[].concat(a)),Bj(r,"lastBoundingBox",{width:-1,height:-1}),r}return uIe(t,e),oIe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();return s.height=this.wrapperNode.offsetHeight,s.width=this.wrapperNode.offsetWidth,s}return null}},{key:"updateBBox",value:function(){var s=this.props.onBBoxUpdate,a=this.getBBox();a?(Math.abs(a.width-this.lastBoundingBox.width)>o9||Math.abs(a.height-this.lastBoundingBox.height)>o9)&&(this.lastBoundingBox.width=a.width,this.lastBoundingBox.height=a.height,s&&s(a)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,s&&s(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?zc({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(s){var a=this.props,i=a.layout,o=a.align,c=a.verticalAlign,d=a.margin,l=a.chartWidth,u=a.chartHeight,h,f;if(!s||(s.left===void 0||s.left===null)&&(s.right===void 0||s.right===null))if(o==="center"&&i==="vertical"){var m=this.getBBoxSnapshot();h={left:((l||0)-m.width)/2}}else h=o==="right"?{right:d&&d.right||0}:{left:d&&d.left||0};if(!s||(s.top===void 0||s.top===null)&&(s.bottom===void 0||s.bottom===null))if(c==="middle"){var p=this.getBBoxSnapshot();f={top:((u||0)-p.height)/2}}else f=c==="bottom"?{bottom:d&&d.bottom||0}:{top:d&&d.top||0};return zc(zc({},h),f)}},{key:"render",value:function(){var s=this,a=this.props,i=a.content,o=a.width,c=a.height,d=a.wrapperStyle,l=a.payloadUniqBy,u=a.payload,h=zc(zc({position:"absolute",width:o||"auto",height:c||"auto"},this.getDefaultPosition(d)),d);return we.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(m){s.wrapperNode=m}},gIe(i,zc(zc({},this.props),{},{payload:ZZ(u,l,pIe)})))}}],[{key:"getWithHeight",value:function(s,a){var i=zc(zc({},this.defaultProps),s.props),o=i.layout;return o==="vertical"&&Lt(s.props.height)?{height:s.props.height}:o==="horizontal"?{width:s.props.width||a}:null}}])}(P.PureComponent);Bj(Xh,"displayName","Legend");Bj(Xh,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var l9=V1,xIe=UA,vIe=eo,c9=l9?l9.isConcatSpreadable:void 0;function yIe(e){return vIe(e)||xIe(e)||!!(c9&&e&&e[c9])}var bIe=yIe,wIe=$Z,_Ie=bIe;function eQ(e,t,r,s,a){var i=-1,o=e.length;for(r||(r=_Ie),a||(a=[]);++i<o;){var c=e[i];t>0&&r(c)?t>1?eQ(c,t-1,r,s,a):wIe(a,c):s||(a[a.length]=c)}return a}var tQ=eQ;function jIe(e){return function(t,r,s){for(var a=-1,i=Object(t),o=s(t),c=o.length;c--;){var d=o[e?c:++a];if(r(i[d],d,i)===!1)break}return t}}var NIe=jIe,SIe=NIe,CIe=SIe(),EIe=CIe,kIe=EIe,AIe=Lj;function TIe(e,t){return e&&kIe(e,t,AIe)}var rQ=TIe,PIe=q1;function OIe(e,t){return function(r,s){if(r==null)return r;if(!PIe(r))return e(r,s);for(var a=r.length,i=t?a:-1,o=Object(r);(t?i--:++i<a)&&s(o[i],i,o)!==!1;);return r}}var RIe=OIe,MIe=rQ,IIe=RIe,DIe=IIe(MIe),HA=DIe,LIe=HA,BIe=q1;function $Ie(e,t){var r=-1,s=BIe(e)?Array(e.length):[];return LIe(e,function(a,i,o){s[++r]=t(a,i,o)}),s}var nQ=$Ie;function FIe(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var zIe=FIe,d9=$g;function UIe(e,t){if(e!==t){var r=e!==void 0,s=e===null,a=e===e,i=d9(e),o=t!==void 0,c=t===null,d=t===t,l=d9(t);if(!c&&!l&&!i&&e>t||i&&o&&d&&!c&&!l||s&&o&&d||!r&&d||!a)return 1;if(!s&&!i&&!l&&e<t||l&&r&&a&&!s&&!i||c&&r&&a||!o&&a||!d)return-1}return 0}var VIe=UIe,qIe=VIe;function WIe(e,t,r){for(var s=-1,a=e.criteria,i=t.criteria,o=a.length,c=r.length;++s<o;){var d=qIe(a[s],i[s]);if(d){if(s>=c)return d;var l=r[s];return d*(l=="desc"?-1:1)}}return e.index-t.index}var HIe=WIe,C4=TA,GIe=PA,KIe=Ic,XIe=nQ,YIe=zIe,ZIe=UZ,QIe=HIe,JIe=Kg,e9e=eo;function t9e(e,t,r){t.length?t=C4(t,function(i){return e9e(i)?function(o){return GIe(o,i.length===1?i[0]:i)}:i}):t=[JIe];var s=-1;t=C4(t,ZIe(KIe));var a=XIe(e,function(i,o,c){var d=C4(t,function(l){return l(i)});return{criteria:d,index:++s,value:i}});return YIe(a,function(i,o){return QIe(i,o,r)})}var r9e=t9e;function n9e(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var s9e=n9e,a9e=s9e,u9=Math.max;function i9e(e,t,r){return t=u9(t===void 0?e.length-1:t,0),function(){for(var s=arguments,a=-1,i=u9(s.length-t,0),o=Array(i);++a<i;)o[a]=s[t+a];a=-1;for(var c=Array(t+1);++a<t;)c[a]=s[a];return c[t]=r(o),a9e(e,this,c)}}var o9e=i9e;function l9e(e){return function(){return e}}var c9e=l9e,d9e=Mf,u9e=function(){try{var e=d9e(Object,"defineProperty");return e({},"",{}),e}catch{}}(),sQ=u9e,h9e=c9e,h9=sQ,f9e=Kg,m9e=h9?function(e,t){return h9(e,"toString",{configurable:!0,enumerable:!1,value:h9e(t),writable:!0})}:f9e,p9e=m9e,g9e=800,x9e=16,v9e=Date.now;function y9e(e){var t=0,r=0;return function(){var s=v9e(),a=x9e-(s-r);if(r=s,a>0){if(++t>=g9e)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var b9e=y9e,w9e=p9e,_9e=b9e,j9e=_9e(w9e),N9e=j9e,S9e=Kg,C9e=o9e,E9e=N9e;function k9e(e,t){return E9e(C9e(e,t,S9e),e+"")}var A9e=k9e,T9e=CA,P9e=q1,O9e=VA,R9e=Yu;function M9e(e,t,r){if(!R9e(r))return!1;var s=typeof t;return(s=="number"?P9e(r)&&O9e(t,r.length):s=="string"&&t in r)?T9e(r[t],e):!1}var $j=M9e,I9e=tQ,D9e=r9e,L9e=A9e,f9=$j,B9e=L9e(function(e,t){if(e==null)return[];var r=t.length;return r>1&&f9(e,t[0],t[1])?t=[]:r>2&&f9(t[0],t[1],t[2])&&(t=[t[0]]),D9e(e,I9e(t,1),[])}),$9e=B9e;const GA=On($9e);function Nv(e){"@babel/helpers - typeof";return Nv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nv(e)}function V5(){return V5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},V5.apply(this,arguments)}function F9e(e,t){return q9e(e)||V9e(e,t)||U9e(e,t)||z9e()}function z9e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U9e(e,t){if(e){if(typeof e=="string")return m9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m9(e,t)}}function m9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function V9e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function q9e(e){if(Array.isArray(e))return e}function p9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function E4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?p9(Object(r),!0).forEach(function(s){W9e(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function W9e(e,t,r){return t=H9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H9e(e){var t=G9e(e,"string");return Nv(t)=="symbol"?t:t+""}function G9e(e,t){if(Nv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Nv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function K9e(e){return Array.isArray(e)&&fa(e[0])&&fa(e[1])?e.join(" ~ "):e}var X9e=function(t){var r=t.separator,s=r===void 0?" : ":r,a=t.contentStyle,i=a===void 0?{}:a,o=t.itemStyle,c=o===void 0?{}:o,d=t.labelStyle,l=d===void 0?{}:d,u=t.payload,h=t.formatter,f=t.itemSorter,m=t.wrapperClassName,p=t.labelClassName,g=t.label,v=t.labelFormatter,x=t.accessibilityLayer,y=x===void 0?!1:x,b=function(){if(u&&u.length){var H={padding:0,margin:0},M=(f?GA(u,f):u).map(function(F,S){if(F.type==="none")return null;var E=E4({display:"block",paddingTop:4,paddingBottom:4,color:F.color||"#000"},c),N=F.formatter||h||K9e,C=F.value,k=F.name,I=C,U=k;if(N&&I!=null&&U!=null){var $=N(C,k,F,S,u);if(Array.isArray($)){var Y=F9e($,2);I=Y[0],U=Y[1]}else I=$}return we.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(S),style:E},fa(U)?we.createElement("span",{className:"recharts-tooltip-item-name"},U):null,fa(U)?we.createElement("span",{className:"recharts-tooltip-item-separator"},s):null,we.createElement("span",{className:"recharts-tooltip-item-value"},I),we.createElement("span",{className:"recharts-tooltip-item-unit"},F.unit||""))});return we.createElement("ul",{className:"recharts-tooltip-item-list",style:H},M)}return null},j=E4({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),T=E4({margin:0},l),O=!Yr(g),R=O?g:"",D=Xr("recharts-default-tooltip",m),L=Xr("recharts-tooltip-label",p);O&&v&&u!==void 0&&u!==null&&(R=v(g,u));var q=y?{role:"status","aria-live":"assertive"}:{};return we.createElement("div",V5({className:D,style:j},q),we.createElement("p",{className:L,style:T},we.isValidElement(R)?R:"".concat(R)),b())};function Sv(e){"@babel/helpers - typeof";return Sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sv(e)}function sb(e,t,r){return t=Y9e(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y9e(e){var t=Z9e(e,"string");return Sv(t)=="symbol"?t:t+""}function Z9e(e,t){if(Sv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Sv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var T0="recharts-tooltip-wrapper",Q9e={visibility:"hidden"};function J9e(e){var t=e.coordinate,r=e.translateX,s=e.translateY;return Xr(T0,sb(sb(sb(sb({},"".concat(T0,"-right"),Lt(r)&&t&&Lt(t.x)&&r>=t.x),"".concat(T0,"-left"),Lt(r)&&t&&Lt(t.x)&&r<t.x),"".concat(T0,"-bottom"),Lt(s)&&t&&Lt(t.y)&&s>=t.y),"".concat(T0,"-top"),Lt(s)&&t&&Lt(t.y)&&s<t.y))}function g9(e){var t=e.allowEscapeViewBox,r=e.coordinate,s=e.key,a=e.offsetTopLeft,i=e.position,o=e.reverseDirection,c=e.tooltipDimension,d=e.viewBox,l=e.viewBoxDimension;if(i&&Lt(i[s]))return i[s];var u=r[s]-c-a,h=r[s]+a;if(t[s])return o[s]?u:h;if(o[s]){var f=u,m=d[s];return f<m?Math.max(h,d[s]):Math.max(u,d[s])}var p=h+c,g=d[s]+l;return p>g?Math.max(u,d[s]):Math.max(h,d[s])}function eDe(e){var t=e.translateX,r=e.translateY,s=e.useTranslate3d;return{transform:s?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function tDe(e){var t=e.allowEscapeViewBox,r=e.coordinate,s=e.offsetTopLeft,a=e.position,i=e.reverseDirection,o=e.tooltipBox,c=e.useTranslate3d,d=e.viewBox,l,u,h;return o.height>0&&o.width>0&&r?(u=g9({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:o.width,viewBox:d,viewBoxDimension:d.width}),h=g9({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:o.height,viewBox:d,viewBoxDimension:d.height}),l=eDe({translateX:u,translateY:h,useTranslate3d:c})):l=Q9e,{cssProperties:l,cssClasses:J9e({translateX:u,translateY:h,coordinate:r})}}function Bp(e){"@babel/helpers - typeof";return Bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bp(e)}function x9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function v9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x9(Object(r),!0).forEach(function(s){W5(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function rDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nDe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,iQ(s.key),s)}}function sDe(e,t,r){return t&&nDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function aDe(e,t,r){return t=h2(t),iDe(e,aQ()?Reflect.construct(t,r||[],h2(e).constructor):t.apply(e,r))}function iDe(e,t){if(t&&(Bp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oDe(e)}function oDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function aQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(aQ=function(){return!!e})()}function h2(e){return h2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},h2(e)}function lDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&q5(e,t)}function q5(e,t){return q5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},q5(e,t)}function W5(e,t,r){return t=iQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iQ(e){var t=cDe(e,"string");return Bp(t)=="symbol"?t:t+""}function cDe(e,t){if(Bp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Bp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y9=1,dDe=function(e){function t(){var r;rDe(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return r=aDe(this,t,[].concat(a)),W5(r,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),W5(r,"handleKeyDown",function(o){if(o.key==="Escape"){var c,d,l,u;r.setState({dismissed:!0,dismissedAtCoordinate:{x:(c=(d=r.props.coordinate)===null||d===void 0?void 0:d.x)!==null&&c!==void 0?c:0,y:(l=(u=r.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&l!==void 0?l:0}})}}),r}return lDe(t,e),sDe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var s=this.wrapperNode.getBoundingClientRect();(Math.abs(s.width-this.state.lastBoundingBox.width)>y9||Math.abs(s.height-this.state.lastBoundingBox.height)>y9)&&this.setState({lastBoundingBox:{width:s.width,height:s.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var s,a;this.props.active&&this.updateBBox(),this.state.dismissed&&(((s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==this.state.dismissedAtCoordinate.x||((a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var s=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,c=a.animationDuration,d=a.animationEasing,l=a.children,u=a.coordinate,h=a.hasPayload,f=a.isAnimationActive,m=a.offset,p=a.position,g=a.reverseDirection,v=a.useTranslate3d,x=a.viewBox,y=a.wrapperStyle,b=tDe({allowEscapeViewBox:o,coordinate:u,offsetTopLeft:m,position:p,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:v,viewBox:x}),j=b.cssClasses,T=b.cssProperties,O=v9(v9({transition:f&&i?"transform ".concat(c,"ms ").concat(d):void 0},T),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&h?"visible":"hidden",position:"absolute",top:0,left:0},y);return we.createElement("div",{tabIndex:-1,className:j,style:O,ref:function(D){s.wrapperNode=D}},l)}}])}(P.PureComponent),uDe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},gc={isSsr:uDe(),get:function(t){return gc[t]},set:function(t,r){if(typeof t=="string")gc[t]=r;else{var s=Object.keys(t);s&&s.length&&s.forEach(function(a){gc[a]=t[a]})}}};function $p(e){"@babel/helpers - typeof";return $p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$p(e)}function b9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function w9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b9(Object(r),!0).forEach(function(s){KA(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function hDe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fDe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,lQ(s.key),s)}}function mDe(e,t,r){return t&&fDe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pDe(e,t,r){return t=f2(t),gDe(e,oQ()?Reflect.construct(t,r||[],f2(e).constructor):t.apply(e,r))}function gDe(e,t){if(t&&($p(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xDe(e)}function xDe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oQ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(oQ=function(){return!!e})()}function f2(e){return f2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},f2(e)}function vDe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&H5(e,t)}function H5(e,t){return H5=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},H5(e,t)}function KA(e,t,r){return t=lQ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lQ(e){var t=yDe(e,"string");return $p(t)=="symbol"?t:t+""}function yDe(e,t){if($p(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if($p(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bDe(e){return e.dataKey}function wDe(e,t){return we.isValidElement(e)?we.cloneElement(e,t):typeof e=="function"?we.createElement(e,t):we.createElement(X9e,t)}var Lo=function(e){function t(){return hDe(this,t),pDe(this,t,arguments)}return vDe(t,e),mDe(t,[{key:"render",value:function(){var s=this,a=this.props,i=a.active,o=a.allowEscapeViewBox,c=a.animationDuration,d=a.animationEasing,l=a.content,u=a.coordinate,h=a.filterNull,f=a.isAnimationActive,m=a.offset,p=a.payload,g=a.payloadUniqBy,v=a.position,x=a.reverseDirection,y=a.useTranslate3d,b=a.viewBox,j=a.wrapperStyle,T=p??[];h&&T.length&&(T=ZZ(p.filter(function(R){return R.value!=null&&(R.hide!==!0||s.props.includeHidden)}),g,bDe));var O=T.length>0;return we.createElement(dDe,{allowEscapeViewBox:o,animationDuration:c,animationEasing:d,isAnimationActive:f,active:i,coordinate:u,hasPayload:O,offset:m,position:v,reverseDirection:x,useTranslate3d:y,viewBox:b,wrapperStyle:j},wDe(l,w9(w9({},this.props),{},{payload:T})))}}])}(P.PureComponent);KA(Lo,"displayName","Tooltip");KA(Lo,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!gc.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var _De=Mc,jDe=function(){return _De.Date.now()},NDe=jDe,SDe=/\s/;function CDe(e){for(var t=e.length;t--&&SDe.test(e.charAt(t)););return t}var EDe=CDe,kDe=EDe,ADe=/^\s+/;function TDe(e){return e&&e.slice(0,kDe(e)+1).replace(ADe,"")}var PDe=TDe,ODe=PDe,_9=Yu,RDe=$g,j9=NaN,MDe=/^[-+]0x[0-9a-f]+$/i,IDe=/^0b[01]+$/i,DDe=/^0o[0-7]+$/i,LDe=parseInt;function BDe(e){if(typeof e=="number")return e;if(RDe(e))return j9;if(_9(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=_9(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ODe(e);var r=IDe.test(e);return r||DDe.test(e)?LDe(e.slice(2),r?2:8):MDe.test(e)?j9:+e}var cQ=BDe,$De=Yu,k4=NDe,N9=cQ,FDe="Expected a function",zDe=Math.max,UDe=Math.min;function VDe(e,t,r){var s,a,i,o,c,d,l=0,u=!1,h=!1,f=!0;if(typeof e!="function")throw new TypeError(FDe);t=N9(t)||0,$De(r)&&(u=!!r.leading,h="maxWait"in r,i=h?zDe(N9(r.maxWait)||0,t):i,f="trailing"in r?!!r.trailing:f);function m(O){var R=s,D=a;return s=a=void 0,l=O,o=e.apply(D,R),o}function p(O){return l=O,c=setTimeout(x,t),u?m(O):o}function g(O){var R=O-d,D=O-l,L=t-R;return h?UDe(L,i-D):L}function v(O){var R=O-d,D=O-l;return d===void 0||R>=t||R<0||h&&D>=i}function x(){var O=k4();if(v(O))return y(O);c=setTimeout(x,g(O))}function y(O){return c=void 0,f&&s?m(O):(s=a=void 0,o)}function b(){c!==void 0&&clearTimeout(c),l=0,s=d=a=c=void 0}function j(){return c===void 0?o:y(k4())}function T(){var O=k4(),R=v(O);if(s=arguments,a=this,d=O,R){if(c===void 0)return p(d);if(h)return clearTimeout(c),c=setTimeout(x,t),m(d)}return c===void 0&&(c=setTimeout(x,t)),o}return T.cancel=b,T.flush=j,T}var qDe=VDe,WDe=qDe,HDe=Yu,GDe="Expected a function";function KDe(e,t,r){var s=!0,a=!0;if(typeof e!="function")throw new TypeError(GDe);return HDe(r)&&(s="leading"in r?!!r.leading:s,a="trailing"in r?!!r.trailing:a),WDe(e,t,{leading:s,maxWait:t,trailing:a})}var XDe=KDe;const dQ=On(XDe);function Cv(e){"@babel/helpers - typeof";return Cv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cv(e)}function S9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function ab(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S9(Object(r),!0).forEach(function(s){YDe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function YDe(e,t,r){return t=ZDe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZDe(e){var t=QDe(e,"string");return Cv(t)=="symbol"?t:t+""}function QDe(e,t){if(Cv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Cv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JDe(e,t){return nLe(e)||rLe(e,t)||tLe(e,t)||eLe()}function eLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tLe(e,t){if(e){if(typeof e=="string")return C9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C9(e,t)}}function C9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function rLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function nLe(e){if(Array.isArray(e))return e}var XA=P.forwardRef(function(e,t){var r=e.aspect,s=e.initialDimension,a=s===void 0?{width:-1,height:-1}:s,i=e.width,o=i===void 0?"100%":i,c=e.height,d=c===void 0?"100%":c,l=e.minWidth,u=l===void 0?0:l,h=e.minHeight,f=e.maxHeight,m=e.children,p=e.debounce,g=p===void 0?0:p,v=e.id,x=e.className,y=e.onResize,b=e.style,j=b===void 0?{}:b,T=P.useRef(null),O=P.useRef();O.current=y,P.useImperativeHandle(t,function(){return Object.defineProperty(T.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),T.current},configurable:!0})});var R=P.useState({containerWidth:a.width,containerHeight:a.height}),D=JDe(R,2),L=D[0],q=D[1],X=P.useCallback(function(M,F){q(function(S){var E=Math.round(M),N=Math.round(F);return S.containerWidth===E&&S.containerHeight===N?S:{containerWidth:E,containerHeight:N}})},[]);P.useEffect(function(){var M=function(k){var I,U=k[0].contentRect,$=U.width,Y=U.height;X($,Y),(I=O.current)===null||I===void 0||I.call(O,$,Y)};g>0&&(M=dQ(M,g,{trailing:!0,leading:!1}));var F=new ResizeObserver(M),S=T.current.getBoundingClientRect(),E=S.width,N=S.height;return X(E,N),F.observe(T.current),function(){F.disconnect()}},[X,g]);var H=P.useMemo(function(){var M=L.containerWidth,F=L.containerHeight;if(M<0||F<0)return null;Al(Rh(o)||Rh(d),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,d),Al(!r||r>0,"The aspect(%s) must be greater than zero.",r);var S=Rh(o)?M:o,E=Rh(d)?F:d;r&&r>0&&(S?E=S/r:E&&(S=E*r),f&&E>f&&(E=f)),Al(S>0||E>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,S,E,o,d,u,h,r);var N=!Array.isArray(m)&&rd(m.type).endsWith("Chart");return we.Children.map(m,function(C){return we.isValidElement(C)?P.cloneElement(C,ab({width:S,height:E},N?{style:ab({height:"100%",width:"100%",maxHeight:E,maxWidth:S},C.props.style)}:{})):C})},[r,m,d,f,h,u,L,o]);return we.createElement("div",{id:v?"".concat(v):void 0,className:Xr("recharts-responsive-container",x),style:ab(ab({},j),{},{width:o,height:d,minWidth:u,minHeight:h,maxHeight:f}),ref:T},H)}),W1=function(t){return null};W1.displayName="Cell";function Ev(e){"@babel/helpers - typeof";return Ev=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ev(e)}function E9(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function G5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E9(Object(r),!0).forEach(function(s){sLe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E9(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function sLe(e,t,r){return t=aLe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aLe(e){var t=iLe(e,"string");return Ev(t)=="symbol"?t:t+""}function iLe(e,t){if(Ev(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Ev(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var am={widthCache:{},cacheCount:0},oLe=2e3,lLe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},k9="recharts_measurement_span";function cLe(e){var t=G5({},e);return Object.keys(t).forEach(function(r){t[r]||delete t[r]}),t}var vx=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||gc.isSsr)return{width:0,height:0};var s=cLe(r),a=JSON.stringify({text:t,copyStyle:s});if(am.widthCache[a])return am.widthCache[a];try{var i=document.getElementById(k9);i||(i=document.createElement("span"),i.setAttribute("id",k9),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=G5(G5({},lLe),s);Object.assign(i.style,o),i.textContent="".concat(t);var c=i.getBoundingClientRect(),d={width:c.width,height:c.height};return am.widthCache[a]=d,++am.cacheCount>oLe&&(am.cacheCount=0,am.widthCache={}),d}catch{return{width:0,height:0}}},dLe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function kv(e){"@babel/helpers - typeof";return kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kv(e)}function m2(e,t){return mLe(e)||fLe(e,t)||hLe(e,t)||uLe()}function uLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hLe(e,t){if(e){if(typeof e=="string")return A9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A9(e,t)}}function A9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function fLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;d=!1}else for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function mLe(e){if(Array.isArray(e))return e}function pLe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T9(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,xLe(s.key),s)}}function gLe(e,t,r){return t&&T9(e.prototype,t),r&&T9(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xLe(e){var t=vLe(e,"string");return kv(t)=="symbol"?t:t+""}function vLe(e,t){if(kv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(kv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var P9=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,O9=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,yLe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,bLe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,uQ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},wLe=Object.keys(uQ),Rm="NaN";function _Le(e,t){return e*uQ[t]}var ib=function(){function e(t,r){pLe(this,e),this.num=t,this.unit=r,this.num=t,this.unit=r,Number.isNaN(t)&&(this.unit=""),r!==""&&!yLe.test(r)&&(this.num=NaN,this.unit=""),wLe.includes(r)&&(this.num=_Le(t,r),this.unit="px")}return gLe(e,[{key:"add",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num+r.num,this.unit)}},{key:"subtract",value:function(r){return this.unit!==r.unit?new e(NaN,""):new e(this.num-r.num,this.unit)}},{key:"multiply",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num*r.num,this.unit||r.unit)}},{key:"divide",value:function(r){return this.unit!==""&&r.unit!==""&&this.unit!==r.unit?new e(NaN,""):new e(this.num/r.num,this.unit||r.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(r){var s,a=(s=bLe.exec(r))!==null&&s!==void 0?s:[],i=m2(a,3),o=i[1],c=i[2];return new e(parseFloat(o),c??"")}}])}();function hQ(e){if(e.includes(Rm))return Rm;for(var t=e;t.includes("*")||t.includes("/");){var r,s=(r=P9.exec(t))!==null&&r!==void 0?r:[],a=m2(s,4),i=a[1],o=a[2],c=a[3],d=ib.parse(i??""),l=ib.parse(c??""),u=o==="*"?d.multiply(l):d.divide(l);if(u.isNaN())return Rm;t=t.replace(P9,u.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var h,f=(h=O9.exec(t))!==null&&h!==void 0?h:[],m=m2(f,4),p=m[1],g=m[2],v=m[3],x=ib.parse(p??""),y=ib.parse(v??""),b=g==="+"?x.add(y):x.subtract(y);if(b.isNaN())return Rm;t=t.replace(O9,b.toString())}return t}var R9=/\(([^()]*)\)/;function jLe(e){for(var t=e;t.includes("(");){var r=R9.exec(t),s=m2(r,2),a=s[1];t=t.replace(R9,hQ(a))}return t}function NLe(e){var t=e.replace(/\s+/g,"");return t=jLe(t),t=hQ(t),t}function SLe(e){try{return NLe(e)}catch{return Rm}}function A4(e){var t=SLe(e.slice(5,-1));return t===Rm?"":t}var CLe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],ELe=["dx","dy","angle","className","breakAll"];function K5(){return K5=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},K5.apply(this,arguments)}function M9(e,t){if(e==null)return{};var r=kLe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function kLe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function I9(e,t){return OLe(e)||PLe(e,t)||TLe(e,t)||ALe()}function ALe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TLe(e,t){if(e){if(typeof e=="string")return D9(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return D9(e,t)}}function D9(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function PLe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;d=!1}else for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function OLe(e){if(Array.isArray(e))return e}var fQ=/[ \f\n\r\t\v\u2028\u2029]+/,mQ=function(t){var r=t.children,s=t.breakAll,a=t.style;try{var i=[];Yr(r)||(s?i=r.toString().split(""):i=r.toString().split(fQ));var o=i.map(function(d){return{word:d,width:vx(d,a).width}}),c=s?0:vx("",a).width;return{wordsWithComputedWidth:o,spaceWidth:c}}catch{return null}},RLe=function(t,r,s,a,i){var o=t.maxLines,c=t.children,d=t.style,l=t.breakAll,u=Lt(o),h=c,f=function(){var S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return S.reduce(function(E,N){var C=N.word,k=N.width,I=E[E.length-1];if(I&&(a==null||i||I.width+k+s<Number(a)))I.words.push(C),I.width+=k+s;else{var U={words:[C],width:k};E.push(U)}return E},[])},m=f(r),p=function(S){return S.reduce(function(E,N){return E.width>N.width?E:N})};if(!u)return m;for(var g="",v=function(S){var E=h.slice(0,S),N=mQ({breakAll:l,style:d,children:E+g}).wordsWithComputedWidth,C=f(N),k=C.length>o||p(C).width>Number(a);return[k,C]},x=0,y=h.length-1,b=0,j;x<=y&&b<=h.length-1;){var T=Math.floor((x+y)/2),O=T-1,R=v(O),D=I9(R,2),L=D[0],q=D[1],X=v(T),H=I9(X,1),M=H[0];if(!L&&!M&&(x=T+1),L&&M&&(y=T-1),!L&&M){j=q;break}b++}return j||m},L9=function(t){var r=Yr(t)?[]:t.toString().split(fQ);return[{words:r}]},MLe=function(t){var r=t.width,s=t.scaleToFit,a=t.children,i=t.style,o=t.breakAll,c=t.maxLines;if((r||s)&&!gc.isSsr){var d,l,u=mQ({breakAll:o,children:a,style:i});if(u){var h=u.wordsWithComputedWidth,f=u.spaceWidth;d=h,l=f}else return L9(a);return RLe({breakAll:o,children:a,maxLines:c,style:i},d,l,r,s)}return L9(a)},B9="#808080",_f=function(t){var r=t.x,s=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.lineHeight,c=o===void 0?"1em":o,d=t.capHeight,l=d===void 0?"0.71em":d,u=t.scaleToFit,h=u===void 0?!1:u,f=t.textAnchor,m=f===void 0?"start":f,p=t.verticalAnchor,g=p===void 0?"end":p,v=t.fill,x=v===void 0?B9:v,y=M9(t,CLe),b=P.useMemo(function(){return MLe({breakAll:y.breakAll,children:y.children,maxLines:y.maxLines,scaleToFit:h,style:y.style,width:y.width})},[y.breakAll,y.children,y.maxLines,h,y.style,y.width]),j=y.dx,T=y.dy,O=y.angle,R=y.className,D=y.breakAll,L=M9(y,ELe);if(!fa(s)||!fa(i))return null;var q=s+(Lt(j)?j:0),X=i+(Lt(T)?T:0),H;switch(g){case"start":H=A4("calc(".concat(l,")"));break;case"middle":H=A4("calc(".concat((b.length-1)/2," * -").concat(c," + (").concat(l," / 2))"));break;default:H=A4("calc(".concat(b.length-1," * -").concat(c,")"));break}var M=[];if(h){var F=b[0].width,S=y.width;M.push("scale(".concat((Lt(S)?S/F:1)/F,")"))}return O&&M.push("rotate(".concat(O,", ").concat(q,", ").concat(X,")")),M.length&&(L.transform=M.join(" ")),we.createElement("text",K5({},Sr(L,!0),{x:q,y:X,className:Xr("recharts-text",R),textAnchor:m,fill:x.includes("url")?B9:x}),b.map(function(E,N){var C=E.words.join(D?"":" ");return we.createElement("tspan",{x:q,dy:N===0?H:c,key:"".concat(C,"-").concat(N)},C)}))};function Nu(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function ILe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function YA(e){let t,r,s;e.length!==2?(t=Nu,r=(c,d)=>Nu(e(c),d),s=(c,d)=>e(c)-d):(t=e===Nu||e===ILe?e:DLe,r=e,s=e);function a(c,d,l=0,u=c.length){if(l<u){if(t(d,d)!==0)return u;do{const h=l+u>>>1;r(c[h],d)<0?l=h+1:u=h}while(l<u)}return l}function i(c,d,l=0,u=c.length){if(l<u){if(t(d,d)!==0)return u;do{const h=l+u>>>1;r(c[h],d)<=0?l=h+1:u=h}while(l<u)}return l}function o(c,d,l=0,u=c.length){const h=a(c,d,l,u-1);return h>l&&s(c[h-1],d)>-s(c[h],d)?h-1:h}return{left:a,center:o,right:i}}function DLe(){return 0}function pQ(e){return e===null?NaN:+e}function*LLe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const BLe=YA(Nu),H1=BLe.right;YA(pQ).center;class $9 extends Map{constructor(t,r=zLe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[s,a]of t)this.set(s,a)}get(t){return super.get(F9(this,t))}has(t){return super.has(F9(this,t))}set(t,r){return super.set($Le(this,t),r)}delete(t){return super.delete(FLe(this,t))}}function F9({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):r}function $Le({_intern:e,_key:t},r){const s=t(r);return e.has(s)?e.get(s):(e.set(s,r),r)}function FLe({_intern:e,_key:t},r){const s=t(r);return e.has(s)&&(r=e.get(s),e.delete(s)),r}function zLe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function ULe(e=Nu){if(e===Nu)return gQ;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const s=e(t,r);return s||s===0?s:(e(r,r)===0)-(e(t,t)===0)}}function gQ(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const VLe=Math.sqrt(50),qLe=Math.sqrt(10),WLe=Math.sqrt(2);function p2(e,t,r){const s=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(s)),i=s/Math.pow(10,a),o=i>=VLe?10:i>=qLe?5:i>=WLe?2:1;let c,d,l;return a<0?(l=Math.pow(10,-a)/o,c=Math.round(e*l),d=Math.round(t*l),c/l<e&&++c,d/l>t&&--d,l=-l):(l=Math.pow(10,a)*o,c=Math.round(e/l),d=Math.round(t/l),c*l<e&&++c,d*l>t&&--d),d<c&&.5<=r&&r<2?p2(e,t,r*2):[c,d,l]}function X5(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const s=t<e,[a,i,o]=s?p2(t,e,r):p2(e,t,r);if(!(i>=a))return[];const c=i-a+1,d=new Array(c);if(s)if(o<0)for(let l=0;l<c;++l)d[l]=(i-l)/-o;else for(let l=0;l<c;++l)d[l]=(i-l)*o;else if(o<0)for(let l=0;l<c;++l)d[l]=(a+l)/-o;else for(let l=0;l<c;++l)d[l]=(a+l)*o;return d}function Y5(e,t,r){return t=+t,e=+e,r=+r,p2(e,t,r)[2]}function Z5(e,t,r){t=+t,e=+e,r=+r;const s=t<e,a=s?Y5(t,e,r):Y5(e,t,r);return(s?-1:1)*(a<0?1/-a:a)}function z9(e,t){let r;for(const s of e)s!=null&&(r<s||r===void 0&&s>=s)&&(r=s);return r}function U9(e,t){let r;for(const s of e)s!=null&&(r>s||r===void 0&&s>=s)&&(r=s);return r}function xQ(e,t,r=0,s=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),s=Math.floor(Math.min(e.length-1,s)),!(r<=t&&t<=s))return e;for(a=a===void 0?gQ:ULe(a);s>r;){if(s-r>600){const d=s-r+1,l=t-r+1,u=Math.log(d),h=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*h*(d-h)/d)*(l-d/2<0?-1:1),m=Math.max(r,Math.floor(t-l*h/d+f)),p=Math.min(s,Math.floor(t+(d-l)*h/d+f));xQ(e,t,m,p,a)}const i=e[t];let o=r,c=s;for(P0(e,r,t),a(e[s],i)>0&&P0(e,r,s);o<c;){for(P0(e,o,c),++o,--c;a(e[o],i)<0;)++o;for(;a(e[c],i)>0;)--c}a(e[r],i)===0?P0(e,r,c):(++c,P0(e,c,s)),c<=t&&(r=c+1),t<=c&&(s=c-1)}return e}function P0(e,t,r){const s=e[t];e[t]=e[r],e[r]=s}function HLe(e,t,r){if(e=Float64Array.from(LLe(e)),!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return U9(e);if(t>=1)return z9(e);var s,a=(s-1)*t,i=Math.floor(a),o=z9(xQ(e,i).subarray(0,i+1)),c=U9(e.subarray(i+1));return o+(c-o)*(a-i)}}function GLe(e,t,r=pQ){if(!(!(s=e.length)||isNaN(t=+t))){if(t<=0||s<2)return+r(e[0],0,e);if(t>=1)return+r(e[s-1],s-1,e);var s,a=(s-1)*t,i=Math.floor(a),o=+r(e[i],i,e),c=+r(e[i+1],i+1,e);return o+(c-o)*(a-i)}}function KLe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var s=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++s<a;)i[s]=e+s*r;return i}function sl(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ed(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Q5=Symbol("implicit");function ZA(){var e=new $9,t=[],r=[],s=Q5;function a(i){let o=e.get(i);if(o===void 0){if(s!==Q5)return s;e.set(i,o=t.push(i)-1)}return r[o%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new $9;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(s=i,a):s},a.copy=function(){return ZA(t,r).unknown(s)},sl.apply(a,arguments),a}function Av(){var e=ZA().unknown(void 0),t=e.domain,r=e.range,s=0,a=1,i,o,c=!1,d=0,l=0,u=.5;delete e.unknown;function h(){var f=t().length,m=a<s,p=m?a:s,g=m?s:a;i=(g-p)/Math.max(1,f-d+l*2),c&&(i=Math.floor(i)),p+=(g-p-i*(f-d))*u,o=i*(1-d),c&&(p=Math.round(p),o=Math.round(o));var v=KLe(f).map(function(x){return p+i*x});return r(m?v.reverse():v)}return e.domain=function(f){return arguments.length?(t(f),h()):t()},e.range=function(f){return arguments.length?([s,a]=f,s=+s,a=+a,h()):[s,a]},e.rangeRound=function(f){return[s,a]=f,s=+s,a=+a,c=!0,h()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(c=!!f,h()):c},e.padding=function(f){return arguments.length?(d=Math.min(1,l=+f),h()):d},e.paddingInner=function(f){return arguments.length?(d=Math.min(1,f),h()):d},e.paddingOuter=function(f){return arguments.length?(l=+f,h()):l},e.align=function(f){return arguments.length?(u=Math.max(0,Math.min(1,f)),h()):u},e.copy=function(){return Av(t(),[s,a]).round(c).paddingInner(d).paddingOuter(l).align(u)},sl.apply(h(),arguments)}function vQ(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return vQ(t())},e}function yx(){return vQ(Av.apply(null,arguments).paddingInner(1))}function QA(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function yQ(e,t){var r=Object.create(e.prototype);for(var s in t)r[s]=t[s];return r}function G1(){}var Tv=.7,g2=1/Tv,ep="\\s*([+-]?\\d+)\\s*",Pv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",xc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",XLe=/^#([0-9a-f]{3,8})$/,YLe=new RegExp(`^rgb\\(${ep},${ep},${ep}\\)$`),ZLe=new RegExp(`^rgb\\(${xc},${xc},${xc}\\)$`),QLe=new RegExp(`^rgba\\(${ep},${ep},${ep},${Pv}\\)$`),JLe=new RegExp(`^rgba\\(${xc},${xc},${xc},${Pv}\\)$`),eBe=new RegExp(`^hsl\\(${Pv},${xc},${xc}\\)$`),tBe=new RegExp(`^hsla\\(${Pv},${xc},${xc},${Pv}\\)$`),V9={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};QA(G1,Ov,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:q9,formatHex:q9,formatHex8:rBe,formatHsl:nBe,formatRgb:W9,toString:W9});function q9(){return this.rgb().formatHex()}function rBe(){return this.rgb().formatHex8()}function nBe(){return bQ(this).formatHsl()}function W9(){return this.rgb().formatRgb()}function Ov(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=XLe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?H9(t):r===3?new Hi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?ob(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?ob(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=YLe.exec(e))?new Hi(t[1],t[2],t[3],1):(t=ZLe.exec(e))?new Hi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=QLe.exec(e))?ob(t[1],t[2],t[3],t[4]):(t=JLe.exec(e))?ob(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=eBe.exec(e))?X9(t[1],t[2]/100,t[3]/100,1):(t=tBe.exec(e))?X9(t[1],t[2]/100,t[3]/100,t[4]):V9.hasOwnProperty(e)?H9(V9[e]):e==="transparent"?new Hi(NaN,NaN,NaN,0):null}function H9(e){return new Hi(e>>16&255,e>>8&255,e&255,1)}function ob(e,t,r,s){return s<=0&&(e=t=r=NaN),new Hi(e,t,r,s)}function sBe(e){return e instanceof G1||(e=Ov(e)),e?(e=e.rgb(),new Hi(e.r,e.g,e.b,e.opacity)):new Hi}function J5(e,t,r,s){return arguments.length===1?sBe(e):new Hi(e,t,r,s??1)}function Hi(e,t,r,s){this.r=+e,this.g=+t,this.b=+r,this.opacity=+s}QA(Hi,J5,yQ(G1,{brighter(e){return e=e==null?g2:Math.pow(g2,e),new Hi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Tv:Math.pow(Tv,e),new Hi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Hi(Yh(this.r),Yh(this.g),Yh(this.b),x2(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:G9,formatHex:G9,formatHex8:aBe,formatRgb:K9,toString:K9}));function G9(){return`#${Mh(this.r)}${Mh(this.g)}${Mh(this.b)}`}function aBe(){return`#${Mh(this.r)}${Mh(this.g)}${Mh(this.b)}${Mh((isNaN(this.opacity)?1:this.opacity)*255)}`}function K9(){const e=x2(this.opacity);return`${e===1?"rgb(":"rgba("}${Yh(this.r)}, ${Yh(this.g)}, ${Yh(this.b)}${e===1?")":`, ${e})`}`}function x2(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Yh(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Mh(e){return e=Yh(e),(e<16?"0":"")+e.toString(16)}function X9(e,t,r,s){return s<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Nl(e,t,r,s)}function bQ(e){if(e instanceof Nl)return new Nl(e.h,e.s,e.l,e.opacity);if(e instanceof G1||(e=Ov(e)),!e)return new Nl;if(e instanceof Nl)return e;e=e.rgb();var t=e.r/255,r=e.g/255,s=e.b/255,a=Math.min(t,r,s),i=Math.max(t,r,s),o=NaN,c=i-a,d=(i+a)/2;return c?(t===i?o=(r-s)/c+(r<s)*6:r===i?o=(s-t)/c+2:o=(t-r)/c+4,c/=d<.5?i+a:2-i-a,o*=60):c=d>0&&d<1?0:o,new Nl(o,c,d,e.opacity)}function iBe(e,t,r,s){return arguments.length===1?bQ(e):new Nl(e,t,r,s??1)}function Nl(e,t,r,s){this.h=+e,this.s=+t,this.l=+r,this.opacity=+s}QA(Nl,iBe,yQ(G1,{brighter(e){return e=e==null?g2:Math.pow(g2,e),new Nl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Tv:Math.pow(Tv,e),new Nl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,s=r+(r<.5?r:1-r)*t,a=2*r-s;return new Hi(T4(e>=240?e-240:e+120,a,s),T4(e,a,s),T4(e<120?e+240:e-120,a,s),this.opacity)},clamp(){return new Nl(Y9(this.h),lb(this.s),lb(this.l),x2(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=x2(this.opacity);return`${e===1?"hsl(":"hsla("}${Y9(this.h)}, ${lb(this.s)*100}%, ${lb(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Y9(e){return e=(e||0)%360,e<0?e+360:e}function lb(e){return Math.max(0,Math.min(1,e||0))}function T4(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const JA=e=>()=>e;function oBe(e,t){return function(r){return e+r*t}}function lBe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(s){return Math.pow(e+s*t,r)}}function cBe(e){return(e=+e)==1?wQ:function(t,r){return r-t?lBe(t,r,e):JA(isNaN(t)?r:t)}}function wQ(e,t){var r=t-e;return r?oBe(e,r):JA(isNaN(e)?t:e)}const Z9=function e(t){var r=cBe(t);function s(a,i){var o=r((a=J5(a)).r,(i=J5(i)).r),c=r(a.g,i.g),d=r(a.b,i.b),l=wQ(a.opacity,i.opacity);return function(u){return a.r=o(u),a.g=c(u),a.b=d(u),a.opacity=l(u),a+""}}return s.gamma=e,s}(1);function dBe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,s=t.slice(),a;return function(i){for(a=0;a<r;++a)s[a]=e[a]*(1-i)+t[a]*i;return s}}function uBe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function hBe(e,t){var r=t?t.length:0,s=e?Math.min(r,e.length):0,a=new Array(s),i=new Array(r),o;for(o=0;o<s;++o)a[o]=Xg(e[o],t[o]);for(;o<r;++o)i[o]=t[o];return function(c){for(o=0;o<s;++o)i[o]=a[o](c);return i}}function fBe(e,t){var r=new Date;return e=+e,t=+t,function(s){return r.setTime(e*(1-s)+t*s),r}}function v2(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function mBe(e,t){var r={},s={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=Xg(e[a],t[a]):s[a]=t[a];return function(i){for(a in r)s[a]=r[a](i);return s}}var eE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,P4=new RegExp(eE.source,"g");function pBe(e){return function(){return e}}function gBe(e){return function(t){return e(t)+""}}function xBe(e,t){var r=eE.lastIndex=P4.lastIndex=0,s,a,i,o=-1,c=[],d=[];for(e=e+"",t=t+"";(s=eE.exec(e))&&(a=P4.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),c[o]?c[o]+=i:c[++o]=i),(s=s[0])===(a=a[0])?c[o]?c[o]+=a:c[++o]=a:(c[++o]=null,d.push({i:o,x:v2(s,a)})),r=P4.lastIndex;return r<t.length&&(i=t.slice(r),c[o]?c[o]+=i:c[++o]=i),c.length<2?d[0]?gBe(d[0].x):pBe(t):(t=d.length,function(l){for(var u=0,h;u<t;++u)c[(h=d[u]).i]=h.x(l);return c.join("")})}function Xg(e,t){var r=typeof t,s;return t==null||r==="boolean"?JA(t):(r==="number"?v2:r==="string"?(s=Ov(t))?(t=s,Z9):xBe:t instanceof Ov?Z9:t instanceof Date?fBe:uBe(t)?dBe:Array.isArray(t)?hBe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?mBe:v2)(e,t)}function eT(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function vBe(e,t){t===void 0&&(t=e,e=Xg);for(var r=0,s=t.length-1,a=t[0],i=new Array(s<0?0:s);r<s;)i[r]=e(a,a=t[++r]);return function(o){var c=Math.max(0,Math.min(s-1,Math.floor(o*=s)));return i[c](o-c)}}function yBe(e){return function(){return e}}function y2(e){return+e}var Q9=[0,1];function Si(e){return e}function tE(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:yBe(isNaN(t)?NaN:.5)}function bBe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(s){return Math.max(e,Math.min(t,s))}}function wBe(e,t,r){var s=e[0],a=e[1],i=t[0],o=t[1];return a<s?(s=tE(a,s),i=r(o,i)):(s=tE(s,a),i=r(i,o)),function(c){return i(s(c))}}function _Be(e,t,r){var s=Math.min(e.length,t.length)-1,a=new Array(s),i=new Array(s),o=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<s;)a[o]=tE(e[o],e[o+1]),i[o]=r(t[o],t[o+1]);return function(c){var d=H1(e,c,1,s)-1;return i[d](a[d](c))}}function K1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Fj(){var e=Q9,t=Q9,r=Xg,s,a,i,o=Si,c,d,l;function u(){var f=Math.min(e.length,t.length);return o!==Si&&(o=bBe(e[0],e[f-1])),c=f>2?_Be:wBe,d=l=null,h}function h(f){return f==null||isNaN(f=+f)?i:(d||(d=c(e.map(s),t,r)))(s(o(f)))}return h.invert=function(f){return o(a((l||(l=c(t,e.map(s),v2)))(f)))},h.domain=function(f){return arguments.length?(e=Array.from(f,y2),u()):e.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),u()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),r=eT,u()},h.clamp=function(f){return arguments.length?(o=f?!0:Si,u()):o!==Si},h.interpolate=function(f){return arguments.length?(r=f,u()):r},h.unknown=function(f){return arguments.length?(i=f,h):i},function(f,m){return s=f,a=m,u()}}function tT(){return Fj()(Si,Si)}function jBe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function b2(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,s=e.slice(0,r);return[s.length>1?s[0]+s.slice(2):s,+e.slice(r+1)]}function Fp(e){return e=b2(Math.abs(e)),e?e[1]:NaN}function NBe(e,t){return function(r,s){for(var a=r.length,i=[],o=0,c=e[0],d=0;a>0&&c>0&&(d+c+1>s&&(c=Math.max(1,s-d)),i.push(r.substring(a-=c,a+c)),!((d+=c+1)>s));)c=e[o=(o+1)%e.length];return i.reverse().join(t)}}function SBe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var CBe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Rv(e){if(!(t=CBe.exec(e)))throw new Error("invalid format: "+e);var t;return new rT({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Rv.prototype=rT.prototype;function rT(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}rT.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function EBe(e){e:for(var t=e.length,r=1,s=-1,a;r<t;++r)switch(e[r]){case".":s=a=r;break;case"0":s===0&&(s=r),a=r;break;default:if(!+e[r])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(a+1):e}var _Q;function kBe(e,t){var r=b2(e,t);if(!r)return e+"";var s=r[0],a=r[1],i=a-(_Q=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=s.length;return i===o?s:i>o?s+new Array(i-o+1).join("0"):i>0?s.slice(0,i)+"."+s.slice(i):"0."+new Array(1-i).join("0")+b2(e,Math.max(0,t+i-1))[0]}function J9(e,t){var r=b2(e,t);if(!r)return e+"";var s=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+s:s.length>a+1?s.slice(0,a+1)+"."+s.slice(a+1):s+new Array(a-s.length+2).join("0")}const eD={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:jBe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>J9(e*100,t),r:J9,s:kBe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function tD(e){return e}var rD=Array.prototype.map,nD=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function ABe(e){var t=e.grouping===void 0||e.thousands===void 0?tD:NBe(rD.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?tD:SBe(rD.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",d=e.nan===void 0?"NaN":e.nan+"";function l(h){h=Rv(h);var f=h.fill,m=h.align,p=h.sign,g=h.symbol,v=h.zero,x=h.width,y=h.comma,b=h.precision,j=h.trim,T=h.type;T==="n"?(y=!0,T="g"):eD[T]||(b===void 0&&(b=12),j=!0,T="g"),(v||f==="0"&&m==="=")&&(v=!0,f="0",m="=");var O=g==="$"?r:g==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",R=g==="$"?s:/[%p]/.test(T)?o:"",D=eD[T],L=/[defgprs%]/.test(T);b=b===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function q(X){var H=O,M=R,F,S,E;if(T==="c")M=D(X)+M,X="";else{X=+X;var N=X<0||1/X<0;if(X=isNaN(X)?d:D(Math.abs(X),b),j&&(X=EBe(X)),N&&+X==0&&p!=="+"&&(N=!1),H=(N?p==="("?p:c:p==="-"||p==="("?"":p)+H,M=(T==="s"?nD[8+_Q/3]:"")+M+(N&&p==="("?")":""),L){for(F=-1,S=X.length;++F<S;)if(E=X.charCodeAt(F),48>E||E>57){M=(E===46?a+X.slice(F+1):X.slice(F))+M,X=X.slice(0,F);break}}}y&&!v&&(X=t(X,1/0));var C=H.length+X.length+M.length,k=C<x?new Array(x-C+1).join(f):"";switch(y&&v&&(X=t(k+X,k.length?x-M.length:1/0),k=""),m){case"<":X=H+X+M+k;break;case"=":X=H+k+X+M;break;case"^":X=k.slice(0,C=k.length>>1)+H+X+M+k.slice(C);break;default:X=k+H+X+M;break}return i(X)}return q.toString=function(){return h+""},q}function u(h,f){var m=l((h=Rv(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(Fp(f)/3)))*3,g=Math.pow(10,-p),v=nD[8+p/3];return function(x){return m(g*x)+v}}return{format:l,formatPrefix:u}}var cb,nT,jQ;TBe({thousands:",",grouping:[3],currency:["$",""]});function TBe(e){return cb=ABe(e),nT=cb.format,jQ=cb.formatPrefix,cb}function PBe(e){return Math.max(0,-Fp(Math.abs(e)))}function OBe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Fp(t)/3)))*3-Fp(Math.abs(e)))}function RBe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Fp(t)-Fp(e))+1}function NQ(e,t,r,s){var a=Z5(e,t,r),i;switch(s=Rv(s??",f"),s.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return s.precision==null&&!isNaN(i=OBe(a,o))&&(s.precision=i),jQ(s,o)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(i=RBe(a,Math.max(Math.abs(e),Math.abs(t))))&&(s.precision=i-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(i=PBe(a))&&(s.precision=i-(s.type==="%")*2);break}}return nT(s)}function Zu(e){var t=e.domain;return e.ticks=function(r){var s=t();return X5(s[0],s[s.length-1],r??10)},e.tickFormat=function(r,s){var a=t();return NQ(a[0],a[a.length-1],r??10,s)},e.nice=function(r){r==null&&(r=10);var s=t(),a=0,i=s.length-1,o=s[a],c=s[i],d,l,u=10;for(c<o&&(l=o,o=c,c=l,l=a,a=i,i=l);u-- >0;){if(l=Y5(o,c,r),l===d)return s[a]=o,s[i]=c,t(s);if(l>0)o=Math.floor(o/l)*l,c=Math.ceil(c/l)*l;else if(l<0)o=Math.ceil(o*l)/l,c=Math.floor(c*l)/l;else break;d=l}return e},e}function w2(){var e=tT();return e.copy=function(){return K1(e,w2())},sl.apply(e,arguments),Zu(e)}function SQ(e){var t;function r(s){return s==null||isNaN(s=+s)?t:s}return r.invert=r,r.domain=r.range=function(s){return arguments.length?(e=Array.from(s,y2),r):e.slice()},r.unknown=function(s){return arguments.length?(t=s,r):t},r.copy=function(){return SQ(e).unknown(t)},e=arguments.length?Array.from(e,y2):[0,1],Zu(r)}function CQ(e,t){e=e.slice();var r=0,s=e.length-1,a=e[r],i=e[s],o;return i<a&&(o=r,r=s,s=o,o=a,a=i,i=o),e[r]=t.floor(a),e[s]=t.ceil(i),e}function sD(e){return Math.log(e)}function aD(e){return Math.exp(e)}function MBe(e){return-Math.log(-e)}function IBe(e){return-Math.exp(-e)}function DBe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function LBe(e){return e===10?DBe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function BBe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function iD(e){return(t,r)=>-e(-t,r)}function sT(e){const t=e(sD,aD),r=t.domain;let s=10,a,i;function o(){return a=BBe(s),i=LBe(s),r()[0]<0?(a=iD(a),i=iD(i),e(MBe,IBe)):e(sD,aD),t}return t.base=function(c){return arguments.length?(s=+c,o()):s},t.domain=function(c){return arguments.length?(r(c),o()):r()},t.ticks=c=>{const d=r();let l=d[0],u=d[d.length-1];const h=u<l;h&&([l,u]=[u,l]);let f=a(l),m=a(u),p,g;const v=c==null?10:+c;let x=[];if(!(s%1)&&m-f<v){if(f=Math.floor(f),m=Math.ceil(m),l>0){for(;f<=m;++f)for(p=1;p<s;++p)if(g=f<0?p/i(-f):p*i(f),!(g<l)){if(g>u)break;x.push(g)}}else for(;f<=m;++f)for(p=s-1;p>=1;--p)if(g=f>0?p/i(-f):p*i(f),!(g<l)){if(g>u)break;x.push(g)}x.length*2<v&&(x=X5(l,u,v))}else x=X5(f,m,Math.min(m-f,v)).map(i);return h?x.reverse():x},t.tickFormat=(c,d)=>{if(c==null&&(c=10),d==null&&(d=s===10?"s":","),typeof d!="function"&&(!(s%1)&&(d=Rv(d)).precision==null&&(d.trim=!0),d=nT(d)),c===1/0)return d;const l=Math.max(1,s*c/t.ticks().length);return u=>{let h=u/i(Math.round(a(u)));return h*s<s-.5&&(h*=s),h<=l?d(u):""}},t.nice=()=>r(CQ(r(),{floor:c=>i(Math.floor(a(c))),ceil:c=>i(Math.ceil(a(c)))})),t}function EQ(){const e=sT(Fj()).domain([1,10]);return e.copy=()=>K1(e,EQ()).base(e.base()),sl.apply(e,arguments),e}function oD(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function lD(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function aT(e){var t=1,r=e(oD(t),lD(t));return r.constant=function(s){return arguments.length?e(oD(t=+s),lD(t)):t},Zu(r)}function kQ(){var e=aT(Fj());return e.copy=function(){return K1(e,kQ()).constant(e.constant())},sl.apply(e,arguments)}function cD(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function $Be(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function FBe(e){return e<0?-e*e:e*e}function iT(e){var t=e(Si,Si),r=1;function s(){return r===1?e(Si,Si):r===.5?e($Be,FBe):e(cD(r),cD(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,s()):r},Zu(t)}function oT(){var e=iT(Fj());return e.copy=function(){return K1(e,oT()).exponent(e.exponent())},sl.apply(e,arguments),e}function zBe(){return oT.apply(null,arguments).exponent(.5)}function dD(e){return Math.sign(e)*e*e}function UBe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function AQ(){var e=tT(),t=[0,1],r=!1,s;function a(i){var o=UBe(e(i));return isNaN(o)?s:r?Math.round(o):o}return a.invert=function(i){return e.invert(dD(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,y2)).map(dD)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(s=i,a):s},a.copy=function(){return AQ(e.domain(),t).round(r).clamp(e.clamp()).unknown(s)},sl.apply(a,arguments),Zu(a)}function TQ(){var e=[],t=[],r=[],s;function a(){var o=0,c=Math.max(1,t.length);for(r=new Array(c-1);++o<c;)r[o-1]=GLe(e,o/c);return i}function i(o){return o==null||isNaN(o=+o)?s:t[H1(r,o)]}return i.invertExtent=function(o){var c=t.indexOf(o);return c<0?[NaN,NaN]:[c>0?r[c-1]:e[0],c<r.length?r[c]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let c of o)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(Nu),a()},i.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},i.unknown=function(o){return arguments.length?(s=o,i):s},i.quantiles=function(){return r.slice()},i.copy=function(){return TQ().domain(e).range(t).unknown(s)},sl.apply(i,arguments)}function PQ(){var e=0,t=1,r=1,s=[.5],a=[0,1],i;function o(d){return d!=null&&d<=d?a[H1(s,d,0,r)]:i}function c(){var d=-1;for(s=new Array(r);++d<r;)s[d]=((d+1)*t-(d-r)*e)/(r+1);return o}return o.domain=function(d){return arguments.length?([e,t]=d,e=+e,t=+t,c()):[e,t]},o.range=function(d){return arguments.length?(r=(a=Array.from(d)).length-1,c()):a.slice()},o.invertExtent=function(d){var l=a.indexOf(d);return l<0?[NaN,NaN]:l<1?[e,s[0]]:l>=r?[s[r-1],t]:[s[l-1],s[l]]},o.unknown=function(d){return arguments.length&&(i=d),o},o.thresholds=function(){return s.slice()},o.copy=function(){return PQ().domain([e,t]).range(a).unknown(i)},sl.apply(Zu(o),arguments)}function OQ(){var e=[.5],t=[0,1],r,s=1;function a(i){return i!=null&&i<=i?t[H1(e,i,0,s)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),s=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),s=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return OQ().domain(e).range(t).unknown(r)},sl.apply(a,arguments)}const O4=new Date,R4=new Date;function Sa(e,t,r,s){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const o=a(i),c=a.ceil(i);return i-o<c-i?o:c},a.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),a.range=(i,o,c)=>{const d=[];if(i=a.ceil(i),c=c==null?1:Math.floor(c),!(i<o)||!(c>0))return d;let l;do d.push(l=new Date(+i)),t(i,c),e(i);while(l<i&&i<o);return d},a.filter=i=>Sa(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,c)=>{if(o>=o)if(c<0)for(;++c<=0;)for(;t(o,-1),!i(o););else for(;--c>=0;)for(;t(o,1),!i(o););}),r&&(a.count=(i,o)=>(O4.setTime(+i),R4.setTime(+o),e(O4),e(R4),Math.floor(r(O4,R4))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(s?o=>s(o)%i===0:o=>a.count(0,o)%i===0):a)),a}const _2=Sa(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);_2.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Sa(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):_2);_2.range;const Zc=1e3,Vo=Zc*60,Qc=Vo*60,gd=Qc*24,lT=gd*7,uD=gd*30,M4=gd*365,Ih=Sa(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Zc)},(e,t)=>(t-e)/Zc,e=>e.getUTCSeconds());Ih.range;const cT=Sa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zc)},(e,t)=>{e.setTime(+e+t*Vo)},(e,t)=>(t-e)/Vo,e=>e.getMinutes());cT.range;const dT=Sa(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Vo)},(e,t)=>(t-e)/Vo,e=>e.getUTCMinutes());dT.range;const uT=Sa(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Zc-e.getMinutes()*Vo)},(e,t)=>{e.setTime(+e+t*Qc)},(e,t)=>(t-e)/Qc,e=>e.getHours());uT.range;const hT=Sa(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Qc)},(e,t)=>(t-e)/Qc,e=>e.getUTCHours());hT.range;const X1=Sa(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Vo)/gd,e=>e.getDate()-1);X1.range;const zj=Sa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/gd,e=>e.getUTCDate()-1);zj.range;const RQ=Sa(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/gd,e=>Math.floor(e/gd));RQ.range;function If(e){return Sa(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Vo)/lT)}const Uj=If(0),j2=If(1),VBe=If(2),qBe=If(3),zp=If(4),WBe=If(5),HBe=If(6);Uj.range;j2.range;VBe.range;qBe.range;zp.range;WBe.range;HBe.range;function Df(e){return Sa(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/lT)}const Vj=Df(0),N2=Df(1),GBe=Df(2),KBe=Df(3),Up=Df(4),XBe=Df(5),YBe=Df(6);Vj.range;N2.range;GBe.range;KBe.range;Up.range;XBe.range;YBe.range;const fT=Sa(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());fT.range;const mT=Sa(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());mT.range;const xd=Sa(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());xd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Sa(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});xd.range;const vd=Sa(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());vd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Sa(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});vd.range;function MQ(e,t,r,s,a,i){const o=[[Ih,1,Zc],[Ih,5,5*Zc],[Ih,15,15*Zc],[Ih,30,30*Zc],[i,1,Vo],[i,5,5*Vo],[i,15,15*Vo],[i,30,30*Vo],[a,1,Qc],[a,3,3*Qc],[a,6,6*Qc],[a,12,12*Qc],[s,1,gd],[s,2,2*gd],[r,1,lT],[t,1,uD],[t,3,3*uD],[e,1,M4]];function c(l,u,h){const f=u<l;f&&([l,u]=[u,l]);const m=h&&typeof h.range=="function"?h:d(l,u,h),p=m?m.range(l,+u+1):[];return f?p.reverse():p}function d(l,u,h){const f=Math.abs(u-l)/h,m=YA(([,,v])=>v).right(o,f);if(m===o.length)return e.every(Z5(l/M4,u/M4,h));if(m===0)return _2.every(Math.max(Z5(l,u,h),1));const[p,g]=o[f/o[m-1][2]<o[m][2]/f?m-1:m];return p.every(g)}return[c,d]}const[ZBe,QBe]=MQ(vd,mT,Vj,RQ,hT,dT),[JBe,e$e]=MQ(xd,fT,Uj,X1,uT,cT);function I4(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function D4(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function O0(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function t$e(e){var t=e.dateTime,r=e.date,s=e.time,a=e.periods,i=e.days,o=e.shortDays,c=e.months,d=e.shortMonths,l=R0(a),u=M0(a),h=R0(i),f=M0(i),m=R0(o),p=M0(o),g=R0(c),v=M0(c),x=R0(d),y=M0(d),b={a:N,A:C,b:k,B:I,c:null,d:xD,e:xD,f:N$e,g:M$e,G:D$e,H:w$e,I:_$e,j:j$e,L:IQ,m:S$e,M:C$e,p:U,q:$,Q:bD,s:wD,S:E$e,u:k$e,U:A$e,V:T$e,w:P$e,W:O$e,x:null,X:null,y:R$e,Y:I$e,Z:L$e,"%":yD},j={a:Y,A:Z,b:re,B:G,c:null,d:vD,e:vD,f:z$e,g:Z$e,G:J$e,H:B$e,I:$$e,j:F$e,L:LQ,m:U$e,M:V$e,p:J,q:V,Q:bD,s:wD,S:q$e,u:W$e,U:H$e,V:G$e,w:K$e,W:X$e,x:null,X:null,y:Y$e,Y:Q$e,Z:eFe,"%":yD},T={a:q,A:X,b:H,B:M,c:F,d:pD,e:pD,f:x$e,g:mD,G:fD,H:gD,I:gD,j:f$e,L:g$e,m:h$e,M:m$e,p:L,q:u$e,Q:y$e,s:b$e,S:p$e,u:i$e,U:o$e,V:l$e,w:a$e,W:c$e,x:S,X:E,y:mD,Y:fD,Z:d$e,"%":v$e};b.x=O(r,b),b.X=O(s,b),b.c=O(t,b),j.x=O(r,j),j.X=O(s,j),j.c=O(t,j);function O(W,ee){return function(ie){var oe=[],se=-1,le=0,ye=W.length,ue,ne,pe;for(ie instanceof Date||(ie=new Date(+ie));++se<ye;)W.charCodeAt(se)===37&&(oe.push(W.slice(le,se)),(ne=hD[ue=W.charAt(++se)])!=null?ue=W.charAt(++se):ne=ue==="e"?" ":"0",(pe=ee[ue])&&(ue=pe(ie,ne)),oe.push(ue),le=se+1);return oe.push(W.slice(le,se)),oe.join("")}}function R(W,ee){return function(ie){var oe=O0(1900,void 0,1),se=D(oe,W,ie+="",0),le,ye;if(se!=ie.length)return null;if("Q"in oe)return new Date(oe.Q);if("s"in oe)return new Date(oe.s*1e3+("L"in oe?oe.L:0));if(ee&&!("Z"in oe)&&(oe.Z=0),"p"in oe&&(oe.H=oe.H%12+oe.p*12),oe.m===void 0&&(oe.m="q"in oe?oe.q:0),"V"in oe){if(oe.V<1||oe.V>53)return null;"w"in oe||(oe.w=1),"Z"in oe?(le=D4(O0(oe.y,0,1)),ye=le.getUTCDay(),le=ye>4||ye===0?N2.ceil(le):N2(le),le=zj.offset(le,(oe.V-1)*7),oe.y=le.getUTCFullYear(),oe.m=le.getUTCMonth(),oe.d=le.getUTCDate()+(oe.w+6)%7):(le=I4(O0(oe.y,0,1)),ye=le.getDay(),le=ye>4||ye===0?j2.ceil(le):j2(le),le=X1.offset(le,(oe.V-1)*7),oe.y=le.getFullYear(),oe.m=le.getMonth(),oe.d=le.getDate()+(oe.w+6)%7)}else("W"in oe||"U"in oe)&&("w"in oe||(oe.w="u"in oe?oe.u%7:"W"in oe?1:0),ye="Z"in oe?D4(O0(oe.y,0,1)).getUTCDay():I4(O0(oe.y,0,1)).getDay(),oe.m=0,oe.d="W"in oe?(oe.w+6)%7+oe.W*7-(ye+5)%7:oe.w+oe.U*7-(ye+6)%7);return"Z"in oe?(oe.H+=oe.Z/100|0,oe.M+=oe.Z%100,D4(oe)):I4(oe)}}function D(W,ee,ie,oe){for(var se=0,le=ee.length,ye=ie.length,ue,ne;se<le;){if(oe>=ye)return-1;if(ue=ee.charCodeAt(se++),ue===37){if(ue=ee.charAt(se++),ne=T[ue in hD?ee.charAt(se++):ue],!ne||(oe=ne(W,ie,oe))<0)return-1}else if(ue!=ie.charCodeAt(oe++))return-1}return oe}function L(W,ee,ie){var oe=l.exec(ee.slice(ie));return oe?(W.p=u.get(oe[0].toLowerCase()),ie+oe[0].length):-1}function q(W,ee,ie){var oe=m.exec(ee.slice(ie));return oe?(W.w=p.get(oe[0].toLowerCase()),ie+oe[0].length):-1}function X(W,ee,ie){var oe=h.exec(ee.slice(ie));return oe?(W.w=f.get(oe[0].toLowerCase()),ie+oe[0].length):-1}function H(W,ee,ie){var oe=x.exec(ee.slice(ie));return oe?(W.m=y.get(oe[0].toLowerCase()),ie+oe[0].length):-1}function M(W,ee,ie){var oe=g.exec(ee.slice(ie));return oe?(W.m=v.get(oe[0].toLowerCase()),ie+oe[0].length):-1}function F(W,ee,ie){return D(W,t,ee,ie)}function S(W,ee,ie){return D(W,r,ee,ie)}function E(W,ee,ie){return D(W,s,ee,ie)}function N(W){return o[W.getDay()]}function C(W){return i[W.getDay()]}function k(W){return d[W.getMonth()]}function I(W){return c[W.getMonth()]}function U(W){return a[+(W.getHours()>=12)]}function $(W){return 1+~~(W.getMonth()/3)}function Y(W){return o[W.getUTCDay()]}function Z(W){return i[W.getUTCDay()]}function re(W){return d[W.getUTCMonth()]}function G(W){return c[W.getUTCMonth()]}function J(W){return a[+(W.getUTCHours()>=12)]}function V(W){return 1+~~(W.getUTCMonth()/3)}return{format:function(W){var ee=O(W+="",b);return ee.toString=function(){return W},ee},parse:function(W){var ee=R(W+="",!1);return ee.toString=function(){return W},ee},utcFormat:function(W){var ee=O(W+="",j);return ee.toString=function(){return W},ee},utcParse:function(W){var ee=R(W+="",!0);return ee.toString=function(){return W},ee}}}var hD={"-":"",_:" ",0:"0"},La=/^\s*\d+/,r$e=/^%/,n$e=/[\\^$*+?|[\]().{}]/g;function Pn(e,t,r){var s=e<0?"-":"",a=(s?-e:e)+"",i=a.length;return s+(i<r?new Array(r-i+1).join(t)+a:a)}function s$e(e){return e.replace(n$e,"\\$&")}function R0(e){return new RegExp("^(?:"+e.map(s$e).join("|")+")","i")}function M0(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function a$e(e,t,r){var s=La.exec(t.slice(r,r+1));return s?(e.w=+s[0],r+s[0].length):-1}function i$e(e,t,r){var s=La.exec(t.slice(r,r+1));return s?(e.u=+s[0],r+s[0].length):-1}function o$e(e,t,r){var s=La.exec(t.slice(r,r+2));return s?(e.U=+s[0],r+s[0].length):-1}function l$e(e,t,r){var s=La.exec(t.slice(r,r+2));return s?(e.V=+s[0],r+s[0].length):-1}function c$e(e,t,r){var s=La.exec(t.slice(r,r+2));return s?(e.W=+s[0],r+s[0].length):-1}function fD(e,t,r){var s=La.exec(t.slice(r,r+4));return s?(e.y=+s[0],r+s[0].length):-1}function mD(e,t,r){var s=La.exec(t.slice(r,r+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),r+s[0].length):-1}function d$e(e,t,r){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),r+s[0].length):-1}function u$e(e,t,r){var s=La.exec(t.slice(r,r+1));return s?(e.q=s[0]*3-3,r+s[0].length):-1}function h$e(e,t,r){var s=La.exec(t.slice(r,r+2));return s?(e.m=s[0]-1,r+s[0].length):-1}function pD(e,t,r){var s=La.exec(t.slice(r,r+2));return s?(e.d=+s[0],r+s[0].length):-1}function f$e(e,t,r){var s=La.exec(t.slice(r,r+3));return s?(e.m=0,e.d=+s[0],r+s[0].length):-1}function gD(e,t,r){var s=La.exec(t.slice(r,r+2));return s?(e.H=+s[0],r+s[0].length):-1}function m$e(e,t,r){var s=La.exec(t.slice(r,r+2));return s?(e.M=+s[0],r+s[0].length):-1}function p$e(e,t,r){var s=La.exec(t.slice(r,r+2));return s?(e.S=+s[0],r+s[0].length):-1}function g$e(e,t,r){var s=La.exec(t.slice(r,r+3));return s?(e.L=+s[0],r+s[0].length):-1}function x$e(e,t,r){var s=La.exec(t.slice(r,r+6));return s?(e.L=Math.floor(s[0]/1e3),r+s[0].length):-1}function v$e(e,t,r){var s=r$e.exec(t.slice(r,r+1));return s?r+s[0].length:-1}function y$e(e,t,r){var s=La.exec(t.slice(r));return s?(e.Q=+s[0],r+s[0].length):-1}function b$e(e,t,r){var s=La.exec(t.slice(r));return s?(e.s=+s[0],r+s[0].length):-1}function xD(e,t){return Pn(e.getDate(),t,2)}function w$e(e,t){return Pn(e.getHours(),t,2)}function _$e(e,t){return Pn(e.getHours()%12||12,t,2)}function j$e(e,t){return Pn(1+X1.count(xd(e),e),t,3)}function IQ(e,t){return Pn(e.getMilliseconds(),t,3)}function N$e(e,t){return IQ(e,t)+"000"}function S$e(e,t){return Pn(e.getMonth()+1,t,2)}function C$e(e,t){return Pn(e.getMinutes(),t,2)}function E$e(e,t){return Pn(e.getSeconds(),t,2)}function k$e(e){var t=e.getDay();return t===0?7:t}function A$e(e,t){return Pn(Uj.count(xd(e)-1,e),t,2)}function DQ(e){var t=e.getDay();return t>=4||t===0?zp(e):zp.ceil(e)}function T$e(e,t){return e=DQ(e),Pn(zp.count(xd(e),e)+(xd(e).getDay()===4),t,2)}function P$e(e){return e.getDay()}function O$e(e,t){return Pn(j2.count(xd(e)-1,e),t,2)}function R$e(e,t){return Pn(e.getFullYear()%100,t,2)}function M$e(e,t){return e=DQ(e),Pn(e.getFullYear()%100,t,2)}function I$e(e,t){return Pn(e.getFullYear()%1e4,t,4)}function D$e(e,t){var r=e.getDay();return e=r>=4||r===0?zp(e):zp.ceil(e),Pn(e.getFullYear()%1e4,t,4)}function L$e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Pn(t/60|0,"0",2)+Pn(t%60,"0",2)}function vD(e,t){return Pn(e.getUTCDate(),t,2)}function B$e(e,t){return Pn(e.getUTCHours(),t,2)}function $$e(e,t){return Pn(e.getUTCHours()%12||12,t,2)}function F$e(e,t){return Pn(1+zj.count(vd(e),e),t,3)}function LQ(e,t){return Pn(e.getUTCMilliseconds(),t,3)}function z$e(e,t){return LQ(e,t)+"000"}function U$e(e,t){return Pn(e.getUTCMonth()+1,t,2)}function V$e(e,t){return Pn(e.getUTCMinutes(),t,2)}function q$e(e,t){return Pn(e.getUTCSeconds(),t,2)}function W$e(e){var t=e.getUTCDay();return t===0?7:t}function H$e(e,t){return Pn(Vj.count(vd(e)-1,e),t,2)}function BQ(e){var t=e.getUTCDay();return t>=4||t===0?Up(e):Up.ceil(e)}function G$e(e,t){return e=BQ(e),Pn(Up.count(vd(e),e)+(vd(e).getUTCDay()===4),t,2)}function K$e(e){return e.getUTCDay()}function X$e(e,t){return Pn(N2.count(vd(e)-1,e),t,2)}function Y$e(e,t){return Pn(e.getUTCFullYear()%100,t,2)}function Z$e(e,t){return e=BQ(e),Pn(e.getUTCFullYear()%100,t,2)}function Q$e(e,t){return Pn(e.getUTCFullYear()%1e4,t,4)}function J$e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Up(e):Up.ceil(e),Pn(e.getUTCFullYear()%1e4,t,4)}function eFe(){return"+0000"}function yD(){return"%"}function bD(e){return+e}function wD(e){return Math.floor(+e/1e3)}var im,$Q,FQ;tFe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function tFe(e){return im=t$e(e),$Q=im.format,im.parse,FQ=im.utcFormat,im.utcParse,im}function rFe(e){return new Date(e)}function nFe(e){return e instanceof Date?+e:+new Date(+e)}function pT(e,t,r,s,a,i,o,c,d,l){var u=tT(),h=u.invert,f=u.domain,m=l(".%L"),p=l(":%S"),g=l("%I:%M"),v=l("%I %p"),x=l("%a %d"),y=l("%b %d"),b=l("%B"),j=l("%Y");function T(O){return(d(O)<O?m:c(O)<O?p:o(O)<O?g:i(O)<O?v:s(O)<O?a(O)<O?x:y:r(O)<O?b:j)(O)}return u.invert=function(O){return new Date(h(O))},u.domain=function(O){return arguments.length?f(Array.from(O,nFe)):f().map(rFe)},u.ticks=function(O){var R=f();return e(R[0],R[R.length-1],O??10)},u.tickFormat=function(O,R){return R==null?T:l(R)},u.nice=function(O){var R=f();return(!O||typeof O.range!="function")&&(O=t(R[0],R[R.length-1],O??10)),O?f(CQ(R,O)):u},u.copy=function(){return K1(u,pT(e,t,r,s,a,i,o,c,d,l))},u}function sFe(){return sl.apply(pT(JBe,e$e,xd,fT,Uj,X1,uT,cT,Ih,$Q).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function aFe(){return sl.apply(pT(ZBe,QBe,vd,mT,Vj,zj,hT,dT,Ih,FQ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function qj(){var e=0,t=1,r,s,a,i,o=Si,c=!1,d;function l(h){return h==null||isNaN(h=+h)?d:o(a===0?.5:(h=(i(h)-r)*a,c?Math.max(0,Math.min(1,h)):h))}l.domain=function(h){return arguments.length?([e,t]=h,r=i(e=+e),s=i(t=+t),a=r===s?0:1/(s-r),l):[e,t]},l.clamp=function(h){return arguments.length?(c=!!h,l):c},l.interpolator=function(h){return arguments.length?(o=h,l):o};function u(h){return function(f){var m,p;return arguments.length?([m,p]=f,o=h(m,p),l):[o(0),o(1)]}}return l.range=u(Xg),l.rangeRound=u(eT),l.unknown=function(h){return arguments.length?(d=h,l):d},function(h){return i=h,r=h(e),s=h(t),a=r===s?0:1/(s-r),l}}function Qu(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function zQ(){var e=Zu(qj()(Si));return e.copy=function(){return Qu(e,zQ())},Ed.apply(e,arguments)}function UQ(){var e=sT(qj()).domain([1,10]);return e.copy=function(){return Qu(e,UQ()).base(e.base())},Ed.apply(e,arguments)}function VQ(){var e=aT(qj());return e.copy=function(){return Qu(e,VQ()).constant(e.constant())},Ed.apply(e,arguments)}function gT(){var e=iT(qj());return e.copy=function(){return Qu(e,gT()).exponent(e.exponent())},Ed.apply(e,arguments)}function iFe(){return gT.apply(null,arguments).exponent(.5)}function qQ(){var e=[],t=Si;function r(s){if(s!=null&&!isNaN(s=+s))return t((H1(e,s,1)-1)/(e.length-1))}return r.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Nu),r},r.interpolator=function(s){return arguments.length?(t=s,r):t},r.range=function(){return e.map((s,a)=>t(a/(e.length-1)))},r.quantiles=function(s){return Array.from({length:s+1},(a,i)=>HLe(e,i/s))},r.copy=function(){return qQ(t).domain(e)},Ed.apply(r,arguments)}function Wj(){var e=0,t=.5,r=1,s=1,a,i,o,c,d,l=Si,u,h=!1,f;function m(g){return isNaN(g=+g)?f:(g=.5+((g=+u(g))-i)*(s*g<s*i?c:d),l(h?Math.max(0,Math.min(1,g)):g))}m.domain=function(g){return arguments.length?([e,t,r]=g,a=u(e=+e),i=u(t=+t),o=u(r=+r),c=a===i?0:.5/(i-a),d=i===o?0:.5/(o-i),s=i<a?-1:1,m):[e,t,r]},m.clamp=function(g){return arguments.length?(h=!!g,m):h},m.interpolator=function(g){return arguments.length?(l=g,m):l};function p(g){return function(v){var x,y,b;return arguments.length?([x,y,b]=v,l=vBe(g,[x,y,b]),m):[l(0),l(.5),l(1)]}}return m.range=p(Xg),m.rangeRound=p(eT),m.unknown=function(g){return arguments.length?(f=g,m):f},function(g){return u=g,a=g(e),i=g(t),o=g(r),c=a===i?0:.5/(i-a),d=i===o?0:.5/(o-i),s=i<a?-1:1,m}}function WQ(){var e=Zu(Wj()(Si));return e.copy=function(){return Qu(e,WQ())},Ed.apply(e,arguments)}function HQ(){var e=sT(Wj()).domain([.1,1,10]);return e.copy=function(){return Qu(e,HQ()).base(e.base())},Ed.apply(e,arguments)}function GQ(){var e=aT(Wj());return e.copy=function(){return Qu(e,GQ()).constant(e.constant())},Ed.apply(e,arguments)}function xT(){var e=iT(Wj());return e.copy=function(){return Qu(e,xT()).exponent(e.exponent())},Ed.apply(e,arguments)}function oFe(){return xT.apply(null,arguments).exponent(.5)}const _D=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Av,scaleDiverging:WQ,scaleDivergingLog:HQ,scaleDivergingPow:xT,scaleDivergingSqrt:oFe,scaleDivergingSymlog:GQ,scaleIdentity:SQ,scaleImplicit:Q5,scaleLinear:w2,scaleLog:EQ,scaleOrdinal:ZA,scalePoint:yx,scalePow:oT,scaleQuantile:TQ,scaleQuantize:PQ,scaleRadial:AQ,scaleSequential:zQ,scaleSequentialLog:UQ,scaleSequentialPow:gT,scaleSequentialQuantile:qQ,scaleSequentialSqrt:iFe,scaleSequentialSymlog:VQ,scaleSqrt:zBe,scaleSymlog:kQ,scaleThreshold:OQ,scaleTime:sFe,scaleUtc:aFe,tickFormat:NQ},Symbol.toStringTag,{value:"Module"}));var lFe=$g;function cFe(e,t,r){for(var s=-1,a=e.length;++s<a;){var i=e[s],o=t(i);if(o!=null&&(c===void 0?o===o&&!lFe(o):r(o,c)))var c=o,d=i}return d}var Hj=cFe;function dFe(e,t){return e>t}var KQ=dFe,uFe=Hj,hFe=KQ,fFe=Kg;function mFe(e){return e&&e.length?uFe(e,fFe,hFe):void 0}var pFe=mFe;const du=On(pFe);function gFe(e,t){return e<t}var XQ=gFe,xFe=Hj,vFe=XQ,yFe=Kg;function bFe(e){return e&&e.length?xFe(e,yFe,vFe):void 0}var wFe=bFe;const Gj=On(wFe);var _Fe=TA,jFe=Ic,NFe=nQ,SFe=eo;function CFe(e,t){var r=SFe(e)?_Fe:NFe;return r(e,jFe(t))}var EFe=CFe,kFe=tQ,AFe=EFe;function TFe(e,t){return kFe(AFe(e,t),1)}var PFe=TFe;const OFe=On(PFe);var RFe=WA;function MFe(e,t){return RFe(e,t)}var IFe=MFe;const Vp=On(IFe);var Yg=1e9,DFe={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},yT,bs=!0,Jo="[DecimalError] ",Zh=Jo+"Invalid argument: ",vT=Jo+"Exponent out of range: ",Zg=Math.floor,jh=Math.pow,LFe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,go,Ea=1e7,fs=7,YQ=9007199254740991,S2=Zg(YQ/fs),dr={};dr.absoluteValue=dr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};dr.comparedTo=dr.cmp=function(e){var t,r,s,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(s=i.d.length,a=e.d.length,t=0,r=s<a?s:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return s===a?0:s>a^i.s<0?1:-1};dr.decimalPlaces=dr.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*fs;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};dr.dividedBy=dr.div=function(e){return nd(this,new this.constructor(e))};dr.dividedToIntegerBy=dr.idiv=function(e){var t=this,r=t.constructor;return Zn(nd(t,new r(e),0,1),r.precision)};dr.equals=dr.eq=function(e){return!this.cmp(e)};dr.exponent=function(){return Js(this)};dr.greaterThan=dr.gt=function(e){return this.cmp(e)>0};dr.greaterThanOrEqualTo=dr.gte=function(e){return this.cmp(e)>=0};dr.isInteger=dr.isint=function(){return this.e>this.d.length-2};dr.isNegative=dr.isneg=function(){return this.s<0};dr.isPositive=dr.ispos=function(){return this.s>0};dr.isZero=function(){return this.s===0};dr.lessThan=dr.lt=function(e){return this.cmp(e)<0};dr.lessThanOrEqualTo=dr.lte=function(e){return this.cmp(e)<1};dr.logarithm=dr.log=function(e){var t,r=this,s=r.constructor,a=s.precision,i=a+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(go))throw Error(Jo+"NaN");if(r.s<1)throw Error(Jo+(r.s?"NaN":"-Infinity"));return r.eq(go)?new s(0):(bs=!1,t=nd(Mv(r,i),Mv(e,i),i),bs=!0,Zn(t,a))};dr.minus=dr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?JQ(t,e):ZQ(t,(e.s=-e.s,e))};dr.modulo=dr.mod=function(e){var t,r=this,s=r.constructor,a=s.precision;if(e=new s(e),!e.s)throw Error(Jo+"NaN");return r.s?(bs=!1,t=nd(r,e,0,1).times(e),bs=!0,r.minus(t)):Zn(new s(r),a)};dr.naturalExponential=dr.exp=function(){return QQ(this)};dr.naturalLogarithm=dr.ln=function(){return Mv(this)};dr.negated=dr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};dr.plus=dr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?ZQ(t,e):JQ(t,(e.s=-e.s,e))};dr.precision=dr.sd=function(e){var t,r,s,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Zh+e);if(t=Js(a)+1,s=a.d.length-1,r=s*fs+1,s=a.d[s],s){for(;s%10==0;s/=10)r--;for(s=a.d[0];s>=10;s/=10)r++}return e&&t>r?t:r};dr.squareRoot=dr.sqrt=function(){var e,t,r,s,a,i,o,c=this,d=c.constructor;if(c.s<1){if(!c.s)return new d(0);throw Error(Jo+"NaN")}for(e=Js(c),bs=!1,a=Math.sqrt(+c),a==0||a==1/0?(t=ic(c.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Zg((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),s=new d(t)):s=new d(a.toString()),r=d.precision,a=o=r+3;;)if(i=s,s=i.plus(nd(c,i,o+2)).times(.5),ic(i.d).slice(0,o)===(t=ic(s.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(Zn(i,r+1,0),i.times(i).eq(c)){s=i;break}}else if(t!="9999")break;o+=4}return bs=!0,Zn(s,r)};dr.times=dr.mul=function(e){var t,r,s,a,i,o,c,d,l,u=this,h=u.constructor,f=u.d,m=(e=new h(e)).d;if(!u.s||!e.s)return new h(0);for(e.s*=u.s,r=u.e+e.e,d=f.length,l=m.length,d<l&&(i=f,f=m,m=i,o=d,d=l,l=o),i=[],o=d+l,s=o;s--;)i.push(0);for(s=l;--s>=0;){for(t=0,a=d+s;a>s;)c=i[a]+m[s]*f[a-s-1]+t,i[a--]=c%Ea|0,t=c/Ea|0;i[a]=(i[a]+t)%Ea|0}for(;!i[--o];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,bs?Zn(e,h.precision):e};dr.toDecimalPlaces=dr.todp=function(e,t){var r=this,s=r.constructor;return r=new s(r),e===void 0?r:(jc(e,0,Yg),t===void 0?t=s.rounding:jc(t,0,8),Zn(r,e+Js(r)+1,t))};dr.toExponential=function(e,t){var r,s=this,a=s.constructor;return e===void 0?r=jf(s,!0):(jc(e,0,Yg),t===void 0?t=a.rounding:jc(t,0,8),s=Zn(new a(s),e+1,t),r=jf(s,!0,e+1)),r};dr.toFixed=function(e,t){var r,s,a=this,i=a.constructor;return e===void 0?jf(a):(jc(e,0,Yg),t===void 0?t=i.rounding:jc(t,0,8),s=Zn(new i(a),e+Js(a)+1,t),r=jf(s.abs(),!1,e+Js(s)+1),a.isneg()&&!a.isZero()?"-"+r:r)};dr.toInteger=dr.toint=function(){var e=this,t=e.constructor;return Zn(new t(e),Js(e)+1,t.rounding)};dr.toNumber=function(){return+this};dr.toPower=dr.pow=function(e){var t,r,s,a,i,o,c=this,d=c.constructor,l=12,u=+(e=new d(e));if(!e.s)return new d(go);if(c=new d(c),!c.s){if(e.s<1)throw Error(Jo+"Infinity");return c}if(c.eq(go))return c;if(s=d.precision,e.eq(go))return Zn(c,s);if(t=e.e,r=e.d.length-1,o=t>=r,i=c.s,o){if((r=u<0?-u:u)<=YQ){for(a=new d(go),t=Math.ceil(s/fs+4),bs=!1;r%2&&(a=a.times(c),ND(a.d,t)),r=Zg(r/2),r!==0;)c=c.times(c),ND(c.d,t);return bs=!0,e.s<0?new d(go).div(a):Zn(a,s)}}else if(i<0)throw Error(Jo+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,c.s=1,bs=!1,a=e.times(Mv(c,s+l)),bs=!0,a=QQ(a),a.s=i,a};dr.toPrecision=function(e,t){var r,s,a=this,i=a.constructor;return e===void 0?(r=Js(a),s=jf(a,r<=i.toExpNeg||r>=i.toExpPos)):(jc(e,1,Yg),t===void 0?t=i.rounding:jc(t,0,8),a=Zn(new i(a),e,t),r=Js(a),s=jf(a,e<=r||r<=i.toExpNeg,e)),s};dr.toSignificantDigits=dr.tosd=function(e,t){var r=this,s=r.constructor;return e===void 0?(e=s.precision,t=s.rounding):(jc(e,1,Yg),t===void 0?t=s.rounding:jc(t,0,8)),Zn(new s(r),e,t)};dr.toString=dr.valueOf=dr.val=dr.toJSON=dr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Js(e),r=e.constructor;return jf(e,t<=r.toExpNeg||t>=r.toExpPos)};function ZQ(e,t){var r,s,a,i,o,c,d,l,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),bs?Zn(t,h):t;if(d=e.d,l=t.d,o=e.e,a=t.e,d=d.slice(),i=o-a,i){for(i<0?(s=d,i=-i,c=l.length):(s=l,a=o,c=d.length),o=Math.ceil(h/fs),c=o>c?o+1:c+1,i>c&&(i=c,s.length=1),s.reverse();i--;)s.push(0);s.reverse()}for(c=d.length,i=l.length,c-i<0&&(i=c,s=l,l=d,d=s),r=0;i;)r=(d[--i]=d[i]+l[i]+r)/Ea|0,d[i]%=Ea;for(r&&(d.unshift(r),++a),c=d.length;d[--c]==0;)d.pop();return t.d=d,t.e=a,bs?Zn(t,h):t}function jc(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Zh+e)}function ic(e){var t,r,s,a=e.length-1,i="",o=e[0];if(a>0){for(i+=o,t=1;t<a;t++)s=e[t]+"",r=fs-s.length,r&&(i+=Gd(r)),i+=s;o=e[t],s=o+"",r=fs-s.length,r&&(i+=Gd(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var nd=function(){function e(s,a){var i,o=0,c=s.length;for(s=s.slice();c--;)i=s[c]*a+o,s[c]=i%Ea|0,o=i/Ea|0;return o&&s.unshift(o),s}function t(s,a,i,o){var c,d;if(i!=o)d=i>o?1:-1;else for(c=d=0;c<i;c++)if(s[c]!=a[c]){d=s[c]>a[c]?1:-1;break}return d}function r(s,a,i){for(var o=0;i--;)s[i]-=o,o=s[i]<a[i]?1:0,s[i]=o*Ea+s[i]-a[i];for(;!s[0]&&s.length>1;)s.shift()}return function(s,a,i,o){var c,d,l,u,h,f,m,p,g,v,x,y,b,j,T,O,R,D,L=s.constructor,q=s.s==a.s?1:-1,X=s.d,H=a.d;if(!s.s)return new L(s);if(!a.s)throw Error(Jo+"Division by zero");for(d=s.e-a.e,R=H.length,T=X.length,m=new L(q),p=m.d=[],l=0;H[l]==(X[l]||0);)++l;if(H[l]>(X[l]||0)&&--d,i==null?y=i=L.precision:o?y=i+(Js(s)-Js(a))+1:y=i,y<0)return new L(0);if(y=y/fs+2|0,l=0,R==1)for(u=0,H=H[0],y++;(l<T||u)&&y--;l++)b=u*Ea+(X[l]||0),p[l]=b/H|0,u=b%H|0;else{for(u=Ea/(H[0]+1)|0,u>1&&(H=e(H,u),X=e(X,u),R=H.length,T=X.length),j=R,g=X.slice(0,R),v=g.length;v<R;)g[v++]=0;D=H.slice(),D.unshift(0),O=H[0],H[1]>=Ea/2&&++O;do u=0,c=t(H,g,R,v),c<0?(x=g[0],R!=v&&(x=x*Ea+(g[1]||0)),u=x/O|0,u>1?(u>=Ea&&(u=Ea-1),h=e(H,u),f=h.length,v=g.length,c=t(h,g,f,v),c==1&&(u--,r(h,R<f?D:H,f))):(u==0&&(c=u=1),h=H.slice()),f=h.length,f<v&&h.unshift(0),r(g,h,v),c==-1&&(v=g.length,c=t(H,g,R,v),c<1&&(u++,r(g,R<v?D:H,v))),v=g.length):c===0&&(u++,g=[0]),p[l++]=u,c&&g[0]?g[v++]=X[j]||0:(g=[X[j]],v=1);while((j++<T||g[0]!==void 0)&&y--)}return p[0]||p.shift(),m.e=d,Zn(m,o?i+Js(m)+1:i)}}();function QQ(e,t){var r,s,a,i,o,c,d=0,l=0,u=e.constructor,h=u.precision;if(Js(e)>16)throw Error(vT+Js(e));if(!e.s)return new u(go);for(t==null?(bs=!1,c=h):c=t,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),l+=5;for(s=Math.log(jh(2,l))/Math.LN10*2+5|0,c+=s,r=a=i=new u(go),u.precision=c;;){if(a=Zn(a.times(e),c),r=r.times(++d),o=i.plus(nd(a,r,c)),ic(o.d).slice(0,c)===ic(i.d).slice(0,c)){for(;l--;)i=Zn(i.times(i),c);return u.precision=h,t==null?(bs=!0,Zn(i,h)):i}i=o}}function Js(e){for(var t=e.e*fs,r=e.d[0];r>=10;r/=10)t++;return t}function L4(e,t,r){if(t>e.LN10.sd())throw bs=!0,r&&(e.precision=r),Error(Jo+"LN10 precision limit exceeded");return Zn(new e(e.LN10),t)}function Gd(e){for(var t="";e--;)t+="0";return t}function Mv(e,t){var r,s,a,i,o,c,d,l,u,h=1,f=10,m=e,p=m.d,g=m.constructor,v=g.precision;if(m.s<1)throw Error(Jo+(m.s?"NaN":"-Infinity"));if(m.eq(go))return new g(0);if(t==null?(bs=!1,l=v):l=t,m.eq(10))return t==null&&(bs=!0),L4(g,l);if(l+=f,g.precision=l,r=ic(p),s=r.charAt(0),i=Js(m),Math.abs(i)<15e14){for(;s<7&&s!=1||s==1&&r.charAt(1)>3;)m=m.times(e),r=ic(m.d),s=r.charAt(0),h++;i=Js(m),s>1?(m=new g("0."+r),i++):m=new g(s+"."+r.slice(1))}else return d=L4(g,l+2,v).times(i+""),m=Mv(new g(s+"."+r.slice(1)),l-f).plus(d),g.precision=v,t==null?(bs=!0,Zn(m,v)):m;for(c=o=m=nd(m.minus(go),m.plus(go),l),u=Zn(m.times(m),l),a=3;;){if(o=Zn(o.times(u),l),d=c.plus(nd(o,new g(a),l)),ic(d.d).slice(0,l)===ic(c.d).slice(0,l))return c=c.times(2),i!==0&&(c=c.plus(L4(g,l+2,v).times(i+""))),c=nd(c,new g(h),l),g.precision=v,t==null?(bs=!0,Zn(c,v)):c;c=d,a+=2}}function jD(e,t){var r,s,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(s=t.search(/e/i))>0?(r<0&&(r=s),r+=+t.slice(s+1),t=t.substring(0,s)):r<0&&(r=t.length),s=0;t.charCodeAt(s)===48;)++s;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(s,a),t){if(a-=s,r=r-s-1,e.e=Zg(r/fs),e.d=[],s=(r+1)%fs,r<0&&(s+=fs),s<a){for(s&&e.d.push(+t.slice(0,s)),a-=fs;s<a;)e.d.push(+t.slice(s,s+=fs));t=t.slice(s),s=fs-t.length}else s-=a;for(;s--;)t+="0";if(e.d.push(+t),bs&&(e.e>S2||e.e<-S2))throw Error(vT+r)}else e.s=0,e.e=0,e.d=[0];return e}function Zn(e,t,r){var s,a,i,o,c,d,l,u,h=e.d;for(o=1,i=h[0];i>=10;i/=10)o++;if(s=t-o,s<0)s+=fs,a=t,l=h[u=0];else{if(u=Math.ceil((s+1)/fs),i=h.length,u>=i)return e;for(l=i=h[u],o=1;i>=10;i/=10)o++;s%=fs,a=s-fs+o}if(r!==void 0&&(i=jh(10,o-a-1),c=l/i%10|0,d=t<0||h[u+1]!==void 0||l%i,d=r<4?(c||d)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||d||r==6&&(s>0?a>0?l/jh(10,o-a):0:h[u-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return d?(i=Js(e),h.length=1,t=t-i-1,h[0]=jh(10,(fs-t%fs)%fs),e.e=Zg(-t/fs)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(s==0?(h.length=u,i=1,u--):(h.length=u+1,i=jh(10,fs-s),h[u]=a>0?(l/jh(10,o-a)%jh(10,a)|0)*i:0),d)for(;;)if(u==0){(h[0]+=i)==Ea&&(h[0]=1,++e.e);break}else{if(h[u]+=i,h[u]!=Ea)break;h[u--]=0,i=1}for(s=h.length;h[--s]===0;)h.pop();if(bs&&(e.e>S2||e.e<-S2))throw Error(vT+Js(e));return e}function JQ(e,t){var r,s,a,i,o,c,d,l,u,h,f=e.constructor,m=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),bs?Zn(t,m):t;if(d=e.d,h=t.d,s=t.e,l=e.e,d=d.slice(),o=l-s,o){for(u=o<0,u?(r=d,o=-o,c=h.length):(r=h,s=l,c=d.length),a=Math.max(Math.ceil(m/fs),c)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=d.length,c=h.length,u=a<c,u&&(c=a),a=0;a<c;a++)if(d[a]!=h[a]){u=d[a]<h[a];break}o=0}for(u&&(r=d,d=h,h=r,t.s=-t.s),c=d.length,a=h.length-c;a>0;--a)d[c++]=0;for(a=h.length;a>o;){if(d[--a]<h[a]){for(i=a;i&&d[--i]===0;)d[i]=Ea-1;--d[i],d[a]+=Ea}d[a]-=h[a]}for(;d[--c]===0;)d.pop();for(;d[0]===0;d.shift())--s;return d[0]?(t.d=d,t.e=s,bs?Zn(t,m):t):new f(0)}function jf(e,t,r){var s,a=Js(e),i=ic(e.d),o=i.length;return t?(r&&(s=r-o)>0?i=i.charAt(0)+"."+i.slice(1)+Gd(s):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Gd(-a-1)+i,r&&(s=r-o)>0&&(i+=Gd(s))):a>=o?(i+=Gd(a+1-o),r&&(s=r-a-1)>0&&(i=i+"."+Gd(s))):((s=a+1)<o&&(i=i.slice(0,s)+"."+i.slice(s)),r&&(s=r-o)>0&&(a+1===o&&(i+="."),i+=Gd(s))),e.s<0?"-"+i:i}function ND(e,t){if(e.length>t)return e.length=t,!0}function eJ(e){var t,r,s;function a(i){var o=this;if(!(o instanceof a))return new a(i);if(o.constructor=a,i instanceof a){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Zh+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return jD(o,i.toString())}else if(typeof i!="string")throw Error(Zh+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,LFe.test(i))jD(o,i);else throw Error(Zh+i)}if(a.prototype=dr,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=eJ,a.config=a.set=BFe,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<s.length;)e.hasOwnProperty(r=s[t++])||(e[r]=this[r]);return a.config(e),a}function BFe(e){if(!e||typeof e!="object")throw Error(Jo+"Object expected");var t,r,s,a=["precision",1,Yg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((s=e[r=a[t]])!==void 0)if(Zg(s)===s&&s>=a[t+1]&&s<=a[t+2])this[r]=s;else throw Error(Zh+r+": "+s);if((s=e[r="LN10"])!==void 0)if(s==Math.LN10)this[r]=new this(s);else throw Error(Zh+r+": "+s);return this}var yT=eJ(DFe);go=new yT(1);const Un=yT;function $Fe(e){return VFe(e)||UFe(e)||zFe(e)||FFe()}function FFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zFe(e,t){if(e){if(typeof e=="string")return rE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return rE(e,t)}}function UFe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function VFe(e){if(Array.isArray(e))return rE(e)}function rE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}var qFe=function(t){return t},tJ={"@@functional/placeholder":!0},rJ=function(t){return t===tJ},SD=function(t){return function r(){return arguments.length===0||arguments.length===1&&rJ(arguments.length<=0?void 0:arguments[0])?r:t.apply(void 0,arguments)}},WFe=function e(t,r){return t===1?r:SD(function(){for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];var o=a.filter(function(c){return c!==tJ}).length;return o>=t?r.apply(void 0,a):e(t-o,SD(function(){for(var c=arguments.length,d=new Array(c),l=0;l<c;l++)d[l]=arguments[l];var u=a.map(function(h){return rJ(h)?d.shift():h});return r.apply(void 0,$Fe(u).concat(d))}))})},Kj=function(t){return WFe(t.length,t)},nE=function(t,r){for(var s=[],a=t;a<r;++a)s[a-t]=a;return s},HFe=Kj(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(r){return t[r]}).map(e)}),GFe=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];if(!r.length)return qFe;var a=r.reverse(),i=a[0],o=a.slice(1);return function(){return o.reduce(function(c,d){return d(c)},i.apply(void 0,arguments))}},sE=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},nJ=function(t){var r=null,s=null;return function(){for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return r&&i.every(function(c,d){return c===r[d]})||(r=i,s=t.apply(void 0,i)),s}};function KFe(e){var t;return e===0?t=1:t=Math.floor(new Un(e).abs().log(10).toNumber())+1,t}function XFe(e,t,r){for(var s=new Un(e),a=0,i=[];s.lt(t)&&a<1e5;)i.push(s.toNumber()),s=s.add(r),a++;return i}var YFe=Kj(function(e,t,r){var s=+e,a=+t;return s+r*(a-s)}),ZFe=Kj(function(e,t,r){var s=t-+e;return s=s||1/0,(r-e)/s}),QFe=Kj(function(e,t,r){var s=t-+e;return s=s||1/0,Math.max(0,Math.min(1,(r-e)/s))});const Xj={rangeStep:XFe,getDigitCount:KFe,interpolateNumber:YFe,uninterpolateNumber:ZFe,uninterpolateTruncation:QFe};function aE(e){return tze(e)||eze(e)||sJ(e)||JFe()}function JFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eze(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function tze(e){if(Array.isArray(e))return iE(e)}function Iv(e,t){return sze(e)||nze(e,t)||sJ(e,t)||rze()}function rze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sJ(e,t){if(e){if(typeof e=="string")return iE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return iE(e,t)}}function iE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function nze(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var r=[],s=!0,a=!1,i=void 0;try{for(var o=e[Symbol.iterator](),c;!(s=(c=o.next()).done)&&(r.push(c.value),!(t&&r.length===t));s=!0);}catch(d){a=!0,i=d}finally{try{!s&&o.return!=null&&o.return()}finally{if(a)throw i}}return r}}function sze(e){if(Array.isArray(e))return e}function aJ(e){var t=Iv(e,2),r=t[0],s=t[1],a=r,i=s;return r>s&&(a=s,i=r),[a,i]}function iJ(e,t,r){if(e.lte(0))return new Un(0);var s=Xj.getDigitCount(e.toNumber()),a=new Un(10).pow(s),i=e.div(a),o=s!==1?.05:.1,c=new Un(Math.ceil(i.div(o).toNumber())).add(r).mul(o),d=c.mul(a);return t?d:new Un(Math.ceil(d))}function aze(e,t,r){var s=1,a=new Un(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(s=new Un(10).pow(Xj.getDigitCount(e)-1),a=new Un(Math.floor(a.div(s).toNumber())).mul(s)):i>1&&(a=new Un(Math.floor(e)))}else e===0?a=new Un(Math.floor((t-1)/2)):r||(a=new Un(Math.floor(e)));var o=Math.floor((t-1)/2),c=GFe(HFe(function(d){return a.add(new Un(d-o).mul(s)).toNumber()}),nE);return c(0,t)}function oJ(e,t,r,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(r-1)))return{step:new Un(0),tickMin:new Un(0),tickMax:new Un(0)};var i=iJ(new Un(t).sub(e).div(r-1),s,a),o;e<=0&&t>=0?o=new Un(0):(o=new Un(e).add(t).div(2),o=o.sub(new Un(o).mod(i)));var c=Math.ceil(o.sub(e).div(i).toNumber()),d=Math.ceil(new Un(t).sub(o).div(i).toNumber()),l=c+d+1;return l>r?oJ(e,t,r,s,a+1):(l<r&&(d=t>0?d+(r-l):d,c=t>0?c:c+(r-l)),{step:i,tickMin:o.sub(new Un(c).mul(i)),tickMax:o.add(new Un(d).mul(i))})}function ize(e){var t=Iv(e,2),r=t[0],s=t[1],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),c=aJ([r,s]),d=Iv(c,2),l=d[0],u=d[1];if(l===-1/0||u===1/0){var h=u===1/0?[l].concat(aE(nE(0,a-1).map(function(){return 1/0}))):[].concat(aE(nE(0,a-1).map(function(){return-1/0})),[u]);return r>s?sE(h):h}if(l===u)return aze(l,a,i);var f=oJ(l,u,o,i),m=f.step,p=f.tickMin,g=f.tickMax,v=Xj.rangeStep(p,g.add(new Un(.1).mul(m)),m);return r>s?sE(v):v}function oze(e,t){var r=Iv(e,2),s=r[0],a=r[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=aJ([s,a]),c=Iv(o,2),d=c[0],l=c[1];if(d===-1/0||l===1/0)return[s,a];if(d===l)return[d];var u=Math.max(t,2),h=iJ(new Un(l).sub(d).div(u-1),i,0),f=[].concat(aE(Xj.rangeStep(new Un(d),new Un(l).sub(new Un(.99).mul(h)),h)),[l]);return s>a?sE(f):f}var lze=nJ(ize),cze=nJ(oze),dze="Invariant failed";function Nf(e,t){throw new Error(dze)}var uze=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function qp(e){"@babel/helpers - typeof";return qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qp(e)}function C2(){return C2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},C2.apply(this,arguments)}function hze(e,t){return gze(e)||pze(e,t)||mze(e,t)||fze()}function fze(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mze(e,t){if(e){if(typeof e=="string")return CD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CD(e,t)}}function CD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function pze(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function gze(e){if(Array.isArray(e))return e}function xze(e,t){if(e==null)return{};var r=vze(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function vze(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function yze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bze(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,dJ(s.key),s)}}function wze(e,t,r){return t&&bze(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _ze(e,t,r){return t=E2(t),jze(e,lJ()?Reflect.construct(t,r||[],E2(e).constructor):t.apply(e,r))}function jze(e,t){if(t&&(qp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nze(e)}function Nze(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function lJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lJ=function(){return!!e})()}function E2(e){return E2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},E2(e)}function Sze(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oE(e,t)}function oE(e,t){return oE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},oE(e,t)}function cJ(e,t,r){return t=dJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dJ(e){var t=Cze(e,"string");return qp(t)=="symbol"?t:t+""}function Cze(e,t){if(qp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(qp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yj=function(e){function t(){return yze(this,t),_ze(this,t,arguments)}return Sze(t,e),wze(t,[{key:"render",value:function(){var s=this.props,a=s.offset,i=s.layout,o=s.width,c=s.dataKey,d=s.data,l=s.dataPointFormatter,u=s.xAxis,h=s.yAxis,f=xze(s,uze),m=Sr(f,!1);this.props.direction==="x"&&u.type!=="number"&&Nf();var p=d.map(function(g){var v=l(g,c),x=v.x,y=v.y,b=v.value,j=v.errorVal;if(!j)return null;var T=[],O,R;if(Array.isArray(j)){var D=hze(j,2);O=D[0],R=D[1]}else O=R=j;if(i==="vertical"){var L=u.scale,q=y+a,X=q+o,H=q-o,M=L(b-O),F=L(b+R);T.push({x1:F,y1:X,x2:F,y2:H}),T.push({x1:M,y1:q,x2:F,y2:q}),T.push({x1:M,y1:X,x2:M,y2:H})}else if(i==="horizontal"){var S=h.scale,E=x+a,N=E-o,C=E+o,k=S(b-O),I=S(b+R);T.push({x1:N,y1:I,x2:C,y2:I}),T.push({x1:E,y1:k,x2:E,y2:I}),T.push({x1:N,y1:k,x2:C,y2:k})}return we.createElement(bn,C2({className:"recharts-errorBar",key:"bar-".concat(T.map(function(U){return"".concat(U.x1,"-").concat(U.x2,"-").concat(U.y1,"-").concat(U.y2)}))},m),T.map(function(U){return we.createElement("line",C2({},U,{key:"line-".concat(U.x1,"-").concat(U.x2,"-").concat(U.y1,"-").concat(U.y2)}))}))});return we.createElement(bn,{className:"recharts-errorBars"},p)}}])}(we.Component);cJ(Yj,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});cJ(Yj,"displayName","ErrorBar");function Dv(e){"@babel/helpers - typeof";return Dv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dv(e)}function ED(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function hh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ED(Object(r),!0).forEach(function(s){Eze(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ED(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Eze(e,t,r){return t=kze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kze(e){var t=Aze(e,"string");return Dv(t)=="symbol"?t:t+""}function Aze(e,t){if(Dv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Dv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uJ=function(t){var r=t.children,s=t.formattedGraphicalItems,a=t.legendWidth,i=t.legendContent,o=lo(r,Xh);if(!o)return null;var c=Xh.defaultProps,d=c!==void 0?hh(hh({},c),o.props):{},l;return o.props&&o.props.payload?l=o.props&&o.props.payload:i==="children"?l=(s||[]).reduce(function(u,h){var f=h.item,m=h.props,p=m.sectors||m.data||[];return u.concat(p.map(function(g){return{type:o.props.iconType||f.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):l=(s||[]).map(function(u){var h=u.item,f=h.type.defaultProps,m=f!==void 0?hh(hh({},f),h.props):{},p=m.dataKey,g=m.name,v=m.legendType,x=m.hide;return{inactive:x,dataKey:p,type:d.iconType||v||"square",color:bT(h),value:g||p,payload:m}}),hh(hh(hh({},d),Xh.getWithHeight(o,a)),{},{payload:l,item:o})};function Lv(e){"@babel/helpers - typeof";return Lv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lv(e)}function kD(e){return Rze(e)||Oze(e)||Pze(e)||Tze()}function Tze(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pze(e,t){if(e){if(typeof e=="string")return lE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lE(e,t)}}function Oze(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Rze(e){if(Array.isArray(e))return lE(e)}function lE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function AD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Us(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AD(Object(r),!0).forEach(function(s){tp(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function tp(e,t,r){return t=Mze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Mze(e){var t=Ize(e,"string");return Lv(t)=="symbol"?t:t+""}function Ize(e,t){if(Lv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Lv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ua(e,t,r){return Yr(e)||Yr(t)?r:fa(t)?bo(e,t,r):Lr(t)?t(e):r}function bx(e,t,r,s){var a=OFe(e,function(c){return ua(c,t)});if(r==="number"){var i=a.filter(function(c){return Lt(c)||parseFloat(c)});return i.length?[Gj(i),du(i)]:[1/0,-1/0]}var o=s?a.filter(function(c){return!Yr(c)}):a;return o.map(function(c){return fa(c)||c instanceof Date?c:""})}var Dze=function(t){var r,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,c=(r=s==null?void 0:s.length)!==null&&r!==void 0?r:0;if(c<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var d=i.range,l=0;l<c;l++){var u=l>0?a[l-1].coordinate:a[c-1].coordinate,h=a[l].coordinate,f=l>=c-1?a[0].coordinate:a[l+1].coordinate,m=void 0;if(ji(h-u)!==ji(f-h)){var p=[];if(ji(f-h)===ji(d[1]-d[0])){m=f;var g=h+d[1]-d[0];p[0]=Math.min(g,(g+u)/2),p[1]=Math.max(g,(g+u)/2)}else{m=u;var v=f+d[1]-d[0];p[0]=Math.min(h,(v+h)/2),p[1]=Math.max(h,(v+h)/2)}var x=[Math.min(h,(m+h)/2),Math.max(h,(m+h)/2)];if(t>x[0]&&t<=x[1]||t>=p[0]&&t<=p[1]){o=a[l].index;break}}else{var y=Math.min(u,f),b=Math.max(u,f);if(t>(y+h)/2&&t<=(b+h)/2){o=a[l].index;break}}}else for(var j=0;j<c;j++)if(j===0&&t<=(s[j].coordinate+s[j+1].coordinate)/2||j>0&&j<c-1&&t>(s[j].coordinate+s[j-1].coordinate)/2&&t<=(s[j].coordinate+s[j+1].coordinate)/2||j===c-1&&t>(s[j].coordinate+s[j-1].coordinate)/2){o=s[j].index;break}return o},bT=function(t){var r,s=t,a=s.type.displayName,i=(r=t.type)!==null&&r!==void 0&&r.defaultProps?Us(Us({},t.type.defaultProps),t.props):t.props,o=i.stroke,c=i.fill,d;switch(a){case"Line":d=o;break;case"Area":case"Radar":d=o&&o!=="none"?o:c;break;default:d=c;break}return d},Lze=function(t){var r=t.barSize,s=t.totalSize,a=t.stackGroups,i=a===void 0?{}:a;if(!i)return{};for(var o={},c=Object.keys(i),d=0,l=c.length;d<l;d++)for(var u=i[c[d]].stackGroups,h=Object.keys(u),f=0,m=h.length;f<m;f++){var p=u[h[f]],g=p.items,v=p.cateAxisId,x=g.filter(function(R){return rd(R.type).indexOf("Bar")>=0});if(x&&x.length){var y=x[0].type.defaultProps,b=y!==void 0?Us(Us({},y),x[0].props):x[0].props,j=b.barSize,T=b[v];o[T]||(o[T]=[]);var O=Yr(j)?r:j;o[T].push({item:x[0],stackList:x.slice(1),barSize:Yr(O)?void 0:Ni(O,s,0)})}}return o},Bze=function(t){var r=t.barGap,s=t.barCategoryGap,a=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,c=t.maxBarSize,d=o.length;if(d<1)return null;var l=Ni(r,a,0,!0),u,h=[];if(o[0].barSize===+o[0].barSize){var f=!1,m=a/d,p=o.reduce(function(j,T){return j+T.barSize||0},0);p+=(d-1)*l,p>=a&&(p-=(d-1)*l,l=0),p>=a&&m>0&&(f=!0,m*=.9,p=d*m);var g=(a-p)/2>>0,v={offset:g-l,size:0};u=o.reduce(function(j,T){var O={item:T.item,position:{offset:v.offset+v.size+l,size:f?m:T.barSize}},R=[].concat(kD(j),[O]);return v=R[R.length-1].position,T.stackList&&T.stackList.length&&T.stackList.forEach(function(D){R.push({item:D,position:v})}),R},h)}else{var x=Ni(s,a,0,!0);a-2*x-(d-1)*l<=0&&(l=0);var y=(a-2*x-(d-1)*l)/d;y>1&&(y>>=0);var b=c===+c?Math.min(y,c):y;u=o.reduce(function(j,T,O){var R=[].concat(kD(j),[{item:T.item,position:{offset:x+(y+l)*O+(y-b)/2,size:b}}]);return T.stackList&&T.stackList.length&&T.stackList.forEach(function(D){R.push({item:D,position:R[R.length-1].position})}),R},h)}return u},$ze=function(t,r,s,a){var i=s.children,o=s.width,c=s.margin,d=o-(c.left||0)-(c.right||0),l=uJ({children:i,legendWidth:d});if(l){var u=a||{},h=u.width,f=u.height,m=l.align,p=l.verticalAlign,g=l.layout;if((g==="vertical"||g==="horizontal"&&p==="middle")&&m!=="center"&&Lt(t[m]))return Us(Us({},t),{},tp({},m,t[m]+(h||0)));if((g==="horizontal"||g==="vertical"&&m==="center")&&p!=="middle"&&Lt(t[p]))return Us(Us({},t),{},tp({},p,t[p]+(f||0)))}return t},Fze=function(t,r,s){return Yr(r)?!0:t==="horizontal"?r==="yAxis":t==="vertical"||s==="x"?r==="xAxis":s==="y"?r==="yAxis":!0},hJ=function(t,r,s,a,i){var o=r.props.children,c=Go(o,Yj).filter(function(l){return Fze(a,i,l.props.direction)});if(c&&c.length){var d=c.map(function(l){return l.props.dataKey});return t.reduce(function(l,u){var h=ua(u,s);if(Yr(h))return l;var f=Array.isArray(h)?[Gj(h),du(h)]:[h,h],m=d.reduce(function(p,g){var v=ua(u,g,0),x=f[0]-Math.abs(Array.isArray(v)?v[0]:v),y=f[1]+Math.abs(Array.isArray(v)?v[1]:v);return[Math.min(x,p[0]),Math.max(y,p[1])]},[1/0,-1/0]);return[Math.min(m[0],l[0]),Math.max(m[1],l[1])]},[1/0,-1/0])}return null},zze=function(t,r,s,a,i){var o=r.map(function(c){return hJ(t,c,s,i,a)}).filter(function(c){return!Yr(c)});return o&&o.length?o.reduce(function(c,d){return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]):null},fJ=function(t,r,s,a,i){var o=r.map(function(d){var l=d.props.dataKey;return s==="number"&&l&&hJ(t,d,l,a)||bx(t,l,s,i)});if(s==="number")return o.reduce(function(d,l){return[Math.min(d[0],l[0]),Math.max(d[1],l[1])]},[1/0,-1/0]);var c={};return o.reduce(function(d,l){for(var u=0,h=l.length;u<h;u++)c[l[u]]||(c[l[u]]=!0,d.push(l[u]));return d},[])},mJ=function(t,r){return t==="horizontal"&&r==="xAxis"||t==="vertical"&&r==="yAxis"||t==="centric"&&r==="angleAxis"||t==="radial"&&r==="radiusAxis"},pJ=function(t,r,s,a){if(a)return t.map(function(d){return d.coordinate});var i,o,c=t.map(function(d){return d.coordinate===r&&(i=!0),d.coordinate===s&&(o=!0),d.coordinate});return i||c.push(r),o||c.push(s),c},Jc=function(t,r,s){if(!t)return null;var a=t.scale,i=t.duplicateDomain,o=t.type,c=t.range,d=t.realScaleType==="scaleBand"?a.bandwidth()/2:2,l=(r||s)&&o==="category"&&a.bandwidth?a.bandwidth()/d:0;if(l=t.axisType==="angleAxis"&&(c==null?void 0:c.length)>=2?ji(c[0]-c[1])*2*l:l,r&&(t.ticks||t.niceTicks)){var u=(t.ticks||t.niceTicks).map(function(h){var f=i?i.indexOf(h):h;return{coordinate:a(f)+l,value:h,offset:l}});return u.filter(function(h){return!qg(h.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(h,f){return{coordinate:a(h)+l,value:h,index:f,offset:l}}):a.ticks&&!s?a.ticks(t.tickCount).map(function(h){return{coordinate:a(h)+l,value:h,offset:l}}):a.domain().map(function(h,f){return{coordinate:a(h)+l,value:i?i[h]:h,index:f,offset:l}})},B4=new WeakMap,db=function(t,r){if(typeof r!="function")return t;B4.has(t)||B4.set(t,new WeakMap);var s=B4.get(t);if(s.has(r))return s.get(r);var a=function(){t.apply(void 0,arguments),r.apply(void 0,arguments)};return s.set(r,a),a},gJ=function(t,r,s){var a=t.scale,i=t.type,o=t.layout,c=t.axisType;if(a==="auto")return o==="radial"&&c==="radiusAxis"?{scale:Av(),realScaleType:"band"}:o==="radial"&&c==="angleAxis"?{scale:w2(),realScaleType:"linear"}:i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!s)?{scale:yx(),realScaleType:"point"}:i==="category"?{scale:Av(),realScaleType:"band"}:{scale:w2(),realScaleType:"linear"};if(bf(a)){var d="scale".concat(Rj(a));return{scale:(_D[d]||yx)(),realScaleType:_D[d]?d:"point"}}return Lr(a)?{scale:a}:{scale:yx(),realScaleType:"point"}},TD=1e-4,xJ=function(t){var r=t.domain();if(!(!r||r.length<=2)){var s=r.length,a=t.range(),i=Math.min(a[0],a[1])-TD,o=Math.max(a[0],a[1])+TD,c=t(r[0]),d=t(r[s-1]);(c<i||c>o||d<i||d>o)&&t.domain([r[0],r[s-1]])}},Uze=function(t,r){if(!t)return null;for(var s=0,a=t.length;s<a;s++)if(t[s].item===r)return t[s].position;return null},Vze=function(t,r){if(!r||r.length!==2||!Lt(r[0])||!Lt(r[1]))return t;var s=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]),i=[t[0],t[1]];return(!Lt(t[0])||t[0]<s)&&(i[0]=s),(!Lt(t[1])||t[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<s&&(i[1]=s),i},qze=function(t){var r=t.length;if(!(r<=0))for(var s=0,a=t[0].length;s<a;++s)for(var i=0,o=0,c=0;c<r;++c){var d=qg(t[c][s][1])?t[c][s][0]:t[c][s][1];d>=0?(t[c][s][0]=i,t[c][s][1]=i+d,i=t[c][s][1]):(t[c][s][0]=o,t[c][s][1]=o+d,o=t[c][s][1])}},Wze=function(t){var r=t.length;if(!(r<=0))for(var s=0,a=t[0].length;s<a;++s)for(var i=0,o=0;o<r;++o){var c=qg(t[o][s][1])?t[o][s][0]:t[o][s][1];c>=0?(t[o][s][0]=i,t[o][s][1]=i+c,i=t[o][s][1]):(t[o][s][0]=0,t[o][s][1]=0)}},Hze={sign:qze,expand:uTe,none:Ip,silhouette:hTe,wiggle:fTe,positive:Wze},Gze=function(t,r,s){var a=r.map(function(c){return c.props.dataKey}),i=Hze[s],o=dTe().keys(a).value(function(c,d){return+ua(c,d,0)}).order(R5).offset(i);return o(t)},Kze=function(t,r,s,a,i,o){if(!t)return null;var c=o?r.reverse():r,d={},l=c.reduce(function(h,f){var m,p=(m=f.type)!==null&&m!==void 0&&m.defaultProps?Us(Us({},f.type.defaultProps),f.props):f.props,g=p.stackId,v=p.hide;if(v)return h;var x=p[s],y=h[x]||{hasStack:!1,stackGroups:{}};if(fa(g)){var b=y.stackGroups[g]||{numericAxisId:s,cateAxisId:a,items:[]};b.items.push(f),y.hasStack=!0,y.stackGroups[g]=b}else y.stackGroups[Wg("_stackId_")]={numericAxisId:s,cateAxisId:a,items:[f]};return Us(Us({},h),{},tp({},x,y))},d),u={};return Object.keys(l).reduce(function(h,f){var m=l[f];if(m.hasStack){var p={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(g,v){var x=m.stackGroups[v];return Us(Us({},g),{},tp({},v,{numericAxisId:s,cateAxisId:a,items:x.items,stackedData:Gze(t,x.items,i)}))},p)}return Us(Us({},h),{},tp({},f,m))},u)},vJ=function(t,r){var s=r.realScaleType,a=r.type,i=r.tickCount,o=r.originalDomain,c=r.allowDecimals,d=s||r.scale;if(d!=="auto"&&d!=="linear")return null;if(i&&a==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var l=t.domain();if(!l.length)return null;var u=lze(l,i,c);return t.domain([Gj(u),du(u)]),{niceTicks:u}}if(i&&a==="number"){var h=t.domain(),f=cze(h,i,c);return{niceTicks:f}}return null};function PD(e){var t=e.axis,r=e.ticks,s=e.bandSize,a=e.entry,i=e.index,o=e.dataKey;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Yr(a[t.dataKey])){var c=e2(r,"value",a[t.dataKey]);if(c)return c.coordinate+s/2}return r[i]?r[i].coordinate+s/2:null}var d=ua(a,Yr(o)?t.dataKey:o);return Yr(d)?null:t.scale(d)}var OD=function(t){var r=t.axis,s=t.ticks,a=t.offset,i=t.bandSize,o=t.entry,c=t.index;if(r.type==="category")return s[c]?s[c].coordinate+a:null;var d=ua(o,r.dataKey,r.domain[c]);return Yr(d)?null:r.scale(d)-i/2+a},Xze=function(t){var r=t.numericAxis,s=r.scale.domain();if(r.type==="number"){var a=Math.min(s[0],s[1]),i=Math.max(s[0],s[1]);return a<=0&&i>=0?0:i<0?i:a}return s[0]},Yze=function(t,r){var s,a=(s=t.type)!==null&&s!==void 0&&s.defaultProps?Us(Us({},t.type.defaultProps),t.props):t.props,i=a.stackId;if(fa(i)){var o=r[i];if(o){var c=o.items.indexOf(t);return c>=0?o.stackedData[c]:null}}return null},Zze=function(t){return t.reduce(function(r,s){return[Gj(s.concat([r[0]]).filter(Lt)),du(s.concat([r[1]]).filter(Lt))]},[1/0,-1/0])},yJ=function(t,r,s){return Object.keys(t).reduce(function(a,i){var o=t[i],c=o.stackedData,d=c.reduce(function(l,u){var h=Zze(u.slice(r,s+1));return[Math.min(l[0],h[0]),Math.max(l[1],h[1])]},[1/0,-1/0]);return[Math.min(d[0],a[0]),Math.max(d[1],a[1])]},[1/0,-1/0]).map(function(a){return a===1/0||a===-1/0?0:a})},RD=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,MD=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,cE=function(t,r,s){if(Lr(t))return t(r,s);if(!Array.isArray(t))return r;var a=[];if(Lt(t[0]))a[0]=s?t[0]:Math.min(t[0],r[0]);else if(RD.test(t[0])){var i=+RD.exec(t[0])[1];a[0]=r[0]-i}else Lr(t[0])?a[0]=t[0](r[0]):a[0]=r[0];if(Lt(t[1]))a[1]=s?t[1]:Math.max(t[1],r[1]);else if(MD.test(t[1])){var o=+MD.exec(t[1])[1];a[1]=r[1]+o}else Lr(t[1])?a[1]=t[1](r[1]):a[1]=r[1];return a},k2=function(t,r,s){if(t&&t.scale&&t.scale.bandwidth){var a=t.scale.bandwidth();if(!s||a>0)return a}if(t&&r&&r.length>=2){for(var i=GA(r,function(h){return h.coordinate}),o=1/0,c=1,d=i.length;c<d;c++){var l=i[c],u=i[c-1];o=Math.min((l.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return s?void 0:0},ID=function(t,r,s){return!t||!t.length||Vp(t,bo(s,"type.defaultProps.domain"))?r:t},bJ=function(t,r){var s=t.type.defaultProps?Us(Us({},t.type.defaultProps),t.props):t.props,a=s.dataKey,i=s.name,o=s.unit,c=s.formatter,d=s.tooltipType,l=s.chartType,u=s.hide;return Us(Us({},Sr(t,!1)),{},{dataKey:a,unit:o,formatter:c,name:i||a,color:bT(t),value:ua(r,a),type:d,payload:r,chartType:l,hide:u})};function Bv(e){"@babel/helpers - typeof";return Bv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bv(e)}function DD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Hc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DD(Object(r),!0).forEach(function(s){wJ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function wJ(e,t,r){return t=Qze(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qze(e){var t=Jze(e,"string");return Bv(t)=="symbol"?t:t+""}function Jze(e,t){if(Bv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Bv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eUe(e,t){return sUe(e)||nUe(e,t)||rUe(e,t)||tUe()}function tUe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rUe(e,t){if(e){if(typeof e=="string")return LD(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return LD(e,t)}}function LD(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function nUe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function sUe(e){if(Array.isArray(e))return e}var A2=Math.PI/180,aUe=function(t){return t*180/Math.PI},as=function(t,r,s,a){return{x:t+Math.cos(-A2*a)*s,y:r+Math.sin(-A2*a)*s}},_J=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(s.left||0)-(s.right||0)),Math.abs(r-(s.top||0)-(s.bottom||0)))/2},iUe=function(t,r,s,a,i){var o=t.width,c=t.height,d=t.startAngle,l=t.endAngle,u=Ni(t.cx,o,o/2),h=Ni(t.cy,c,c/2),f=_J(o,c,s),m=Ni(t.innerRadius,f,0),p=Ni(t.outerRadius,f,f*.8),g=Object.keys(r);return g.reduce(function(v,x){var y=r[x],b=y.domain,j=y.reversed,T;if(Yr(y.range))a==="angleAxis"?T=[d,l]:a==="radiusAxis"&&(T=[m,p]),j&&(T=[T[1],T[0]]);else{T=y.range;var O=T,R=eUe(O,2);d=R[0],l=R[1]}var D=gJ(y,i),L=D.realScaleType,q=D.scale;q.domain(b).range(T),xJ(q);var X=vJ(q,Hc(Hc({},y),{},{realScaleType:L})),H=Hc(Hc(Hc({},y),X),{},{range:T,radius:p,realScaleType:L,scale:q,cx:u,cy:h,innerRadius:m,outerRadius:p,startAngle:d,endAngle:l});return Hc(Hc({},v),{},wJ({},x,H))},{})},oUe=function(t,r){var s=t.x,a=t.y,i=r.x,o=r.y;return Math.sqrt(Math.pow(s-i,2)+Math.pow(a-o,2))},lUe=function(t,r){var s=t.x,a=t.y,i=r.cx,o=r.cy,c=oUe({x:s,y:a},{x:i,y:o});if(c<=0)return{radius:c};var d=(s-i)/c,l=Math.acos(d);return a>o&&(l=2*Math.PI-l),{radius:c,angle:aUe(l),angleInRadian:l}},cUe=function(t){var r=t.startAngle,s=t.endAngle,a=Math.floor(r/360),i=Math.floor(s/360),o=Math.min(a,i);return{startAngle:r-o*360,endAngle:s-o*360}},dUe=function(t,r){var s=r.startAngle,a=r.endAngle,i=Math.floor(s/360),o=Math.floor(a/360),c=Math.min(i,o);return t+c*360},BD=function(t,r){var s=t.x,a=t.y,i=lUe({x:s,y:a},r),o=i.radius,c=i.angle,d=r.innerRadius,l=r.outerRadius;if(o<d||o>l)return!1;if(o===0)return!0;var u=cUe(r),h=u.startAngle,f=u.endAngle,m=c,p;if(h<=f){for(;m>f;)m-=360;for(;m<h;)m+=360;p=m>=h&&m<=f}else{for(;m>h;)m-=360;for(;m<f;)m+=360;p=m>=f&&m<=h}return p?Hc(Hc({},r),{},{radius:o,angle:dUe(m,r)}):null},jJ=function(t){return!P.isValidElement(t)&&!Lr(t)&&typeof t!="boolean"?t.className:""};function $v(e){"@babel/helpers - typeof";return $v=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$v(e)}var uUe=["offset"];function hUe(e){return gUe(e)||pUe(e)||mUe(e)||fUe()}function fUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mUe(e,t){if(e){if(typeof e=="string")return dE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dE(e,t)}}function pUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function gUe(e){if(Array.isArray(e))return dE(e)}function dE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function xUe(e,t){if(e==null)return{};var r=vUe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function vUe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function $D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function aa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$D(Object(r),!0).forEach(function(s){yUe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$D(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function yUe(e,t,r){return t=bUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bUe(e){var t=wUe(e,"string");return $v(t)=="symbol"?t:t+""}function wUe(e,t){if($v(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if($v(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fv(){return Fv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Fv.apply(this,arguments)}var _Ue=function(t){var r=t.value,s=t.formatter,a=Yr(t.children)?r:t.children;return Lr(s)?s(a):a},jUe=function(t,r){var s=ji(r-t),a=Math.min(Math.abs(r-t),360);return s*a},NUe=function(t,r,s){var a=t.position,i=t.viewBox,o=t.offset,c=t.className,d=i,l=d.cx,u=d.cy,h=d.innerRadius,f=d.outerRadius,m=d.startAngle,p=d.endAngle,g=d.clockWise,v=(h+f)/2,x=jUe(m,p),y=x>=0?1:-1,b,j;a==="insideStart"?(b=m+y*o,j=g):a==="insideEnd"?(b=p-y*o,j=!g):a==="end"&&(b=p+y*o,j=g),j=x<=0?j:!j;var T=as(l,u,v,b),O=as(l,u,v,b+(j?1:-1)*359),R="M".concat(T.x,",").concat(T.y,`
    A`).concat(v,",").concat(v,",0,1,").concat(j?0:1,`,
    `).concat(O.x,",").concat(O.y),D=Yr(t.id)?Wg("recharts-radial-line-"):t.id;return we.createElement("text",Fv({},s,{dominantBaseline:"central",className:Xr("recharts-radial-bar-label",c)}),we.createElement("defs",null,we.createElement("path",{id:D,d:R})),we.createElement("textPath",{xlinkHref:"#".concat(D)},r))},SUe=function(t){var r=t.viewBox,s=t.offset,a=t.position,i=r,o=i.cx,c=i.cy,d=i.innerRadius,l=i.outerRadius,u=i.startAngle,h=i.endAngle,f=(u+h)/2;if(a==="outside"){var m=as(o,c,l+s,f),p=m.x,g=m.y;return{x:p,y:g,textAnchor:p>=o?"start":"end",verticalAnchor:"middle"}}if(a==="center")return{x:o,y:c,textAnchor:"middle",verticalAnchor:"middle"};if(a==="centerTop")return{x:o,y:c,textAnchor:"middle",verticalAnchor:"start"};if(a==="centerBottom")return{x:o,y:c,textAnchor:"middle",verticalAnchor:"end"};var v=(d+l)/2,x=as(o,c,v,f),y=x.x,b=x.y;return{x:y,y:b,textAnchor:"middle",verticalAnchor:"middle"}},CUe=function(t){var r=t.viewBox,s=t.parentViewBox,a=t.offset,i=t.position,o=r,c=o.x,d=o.y,l=o.width,u=o.height,h=u>=0?1:-1,f=h*a,m=h>0?"end":"start",p=h>0?"start":"end",g=l>=0?1:-1,v=g*a,x=g>0?"end":"start",y=g>0?"start":"end";if(i==="top"){var b={x:c+l/2,y:d-h*a,textAnchor:"middle",verticalAnchor:m};return aa(aa({},b),s?{height:Math.max(d-s.y,0),width:l}:{})}if(i==="bottom"){var j={x:c+l/2,y:d+u+f,textAnchor:"middle",verticalAnchor:p};return aa(aa({},j),s?{height:Math.max(s.y+s.height-(d+u),0),width:l}:{})}if(i==="left"){var T={x:c-v,y:d+u/2,textAnchor:x,verticalAnchor:"middle"};return aa(aa({},T),s?{width:Math.max(T.x-s.x,0),height:u}:{})}if(i==="right"){var O={x:c+l+v,y:d+u/2,textAnchor:y,verticalAnchor:"middle"};return aa(aa({},O),s?{width:Math.max(s.x+s.width-O.x,0),height:u}:{})}var R=s?{width:l,height:u}:{};return i==="insideLeft"?aa({x:c+v,y:d+u/2,textAnchor:y,verticalAnchor:"middle"},R):i==="insideRight"?aa({x:c+l-v,y:d+u/2,textAnchor:x,verticalAnchor:"middle"},R):i==="insideTop"?aa({x:c+l/2,y:d+f,textAnchor:"middle",verticalAnchor:p},R):i==="insideBottom"?aa({x:c+l/2,y:d+u-f,textAnchor:"middle",verticalAnchor:m},R):i==="insideTopLeft"?aa({x:c+v,y:d+f,textAnchor:y,verticalAnchor:p},R):i==="insideTopRight"?aa({x:c+l-v,y:d+f,textAnchor:x,verticalAnchor:p},R):i==="insideBottomLeft"?aa({x:c+v,y:d+u-f,textAnchor:y,verticalAnchor:m},R):i==="insideBottomRight"?aa({x:c+l-v,y:d+u-f,textAnchor:x,verticalAnchor:m},R):Fg(i)&&(Lt(i.x)||Rh(i.x))&&(Lt(i.y)||Rh(i.y))?aa({x:c+Ni(i.x,l),y:d+Ni(i.y,u),textAnchor:"end",verticalAnchor:"end"},R):aa({x:c+l/2,y:d+u/2,textAnchor:"middle",verticalAnchor:"middle"},R)},EUe=function(t){return"cx"in t&&Lt(t.cx)};function Pa(e){var t=e.offset,r=t===void 0?5:t,s=xUe(e,uUe),a=aa({offset:r},s),i=a.viewBox,o=a.position,c=a.value,d=a.children,l=a.content,u=a.className,h=u===void 0?"":u,f=a.textBreakAll;if(!i||Yr(c)&&Yr(d)&&!P.isValidElement(l)&&!Lr(l))return null;if(P.isValidElement(l))return P.cloneElement(l,a);var m;if(Lr(l)){if(m=P.createElement(l,a),P.isValidElement(m))return m}else m=_Ue(a);var p=EUe(i),g=Sr(a,!0);if(p&&(o==="insideStart"||o==="insideEnd"||o==="end"))return NUe(a,m,g);var v=p?SUe(a):CUe(a);return we.createElement(_f,Fv({className:Xr("recharts-label",h)},g,v,{breakAll:f}),m)}Pa.displayName="Label";var NJ=function(t){var r=t.cx,s=t.cy,a=t.angle,i=t.startAngle,o=t.endAngle,c=t.r,d=t.radius,l=t.innerRadius,u=t.outerRadius,h=t.x,f=t.y,m=t.top,p=t.left,g=t.width,v=t.height,x=t.clockWise,y=t.labelViewBox;if(y)return y;if(Lt(g)&&Lt(v)){if(Lt(h)&&Lt(f))return{x:h,y:f,width:g,height:v};if(Lt(m)&&Lt(p))return{x:m,y:p,width:g,height:v}}return Lt(h)&&Lt(f)?{x:h,y:f,width:0,height:0}:Lt(r)&&Lt(s)?{cx:r,cy:s,startAngle:i||a||0,endAngle:o||a||0,innerRadius:l||0,outerRadius:u||d||c||0,clockWise:x}:t.viewBox?t.viewBox:{}},kUe=function(t,r){return t?t===!0?we.createElement(Pa,{key:"label-implicit",viewBox:r}):fa(t)?we.createElement(Pa,{key:"label-implicit",viewBox:r,value:t}):P.isValidElement(t)?t.type===Pa?P.cloneElement(t,{key:"label-implicit",viewBox:r}):we.createElement(Pa,{key:"label-implicit",content:t,viewBox:r}):Lr(t)?we.createElement(Pa,{key:"label-implicit",content:t,viewBox:r}):Fg(t)?we.createElement(Pa,Fv({viewBox:r},t,{key:"label-implicit"})):null:null},AUe=function(t,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&s&&!t.label)return null;var a=t.children,i=NJ(t),o=Go(a,Pa).map(function(d,l){return P.cloneElement(d,{viewBox:r||i,key:"label-".concat(l)})});if(!s)return o;var c=kUe(t.label,r||i);return[c].concat(hUe(o))};Pa.parseViewBox=NJ;Pa.renderCallByParent=AUe;function TUe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var PUe=TUe;const OUe=On(PUe);function zv(e){"@babel/helpers - typeof";return zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zv(e)}var RUe=["valueAccessor"],MUe=["data","dataKey","clockWise","id","textBreakAll"];function IUe(e){return $Ue(e)||BUe(e)||LUe(e)||DUe()}function DUe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function LUe(e,t){if(e){if(typeof e=="string")return uE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uE(e,t)}}function BUe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function $Ue(e){if(Array.isArray(e))return uE(e)}function uE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function T2(){return T2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},T2.apply(this,arguments)}function FD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function zD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FD(Object(r),!0).forEach(function(s){FUe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function FUe(e,t,r){return t=zUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zUe(e){var t=UUe(e,"string");return zv(t)=="symbol"?t:t+""}function UUe(e,t){if(zv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(zv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UD(e,t){if(e==null)return{};var r=VUe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function VUe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}var qUe=function(t){return Array.isArray(t.value)?OUe(t.value):t.value};function sd(e){var t=e.valueAccessor,r=t===void 0?qUe:t,s=UD(e,RUe),a=s.data,i=s.dataKey,o=s.clockWise,c=s.id,d=s.textBreakAll,l=UD(s,MUe);return!a||!a.length?null:we.createElement(bn,{className:"recharts-label-list"},a.map(function(u,h){var f=Yr(i)?r(u,h):ua(u&&u.payload,i),m=Yr(c)?{}:{id:"".concat(c,"-").concat(h)};return we.createElement(Pa,T2({},Sr(u,!0),l,m,{parentViewBox:u.parentViewBox,value:f,textBreakAll:d,viewBox:Pa.parseViewBox(Yr(o)?u:zD(zD({},u),{},{clockWise:o})),key:"label-".concat(h),index:h}))}))}sd.displayName="LabelList";function WUe(e,t){return e?e===!0?we.createElement(sd,{key:"labelList-implicit",data:t}):we.isValidElement(e)||Lr(e)?we.createElement(sd,{key:"labelList-implicit",data:t,content:e}):Fg(e)?we.createElement(sd,T2({data:t},e,{key:"labelList-implicit"})):null:null}function HUe(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var s=e.children,a=Go(s,sd).map(function(o,c){return P.cloneElement(o,{data:t,key:"labelList-".concat(c)})});if(!r)return a;var i=WUe(e.label,t);return[i].concat(IUe(a))}sd.renderCallByParent=HUe;function Uv(e){"@babel/helpers - typeof";return Uv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Uv(e)}function hE(){return hE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},hE.apply(this,arguments)}function VD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function qD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VD(Object(r),!0).forEach(function(s){GUe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function GUe(e,t,r){return t=KUe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KUe(e){var t=XUe(e,"string");return Uv(t)=="symbol"?t:t+""}function XUe(e,t){if(Uv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Uv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var YUe=function(t,r){var s=ji(r-t),a=Math.min(Math.abs(r-t),359.999);return s*a},ub=function(t){var r=t.cx,s=t.cy,a=t.radius,i=t.angle,o=t.sign,c=t.isExternal,d=t.cornerRadius,l=t.cornerIsExternal,u=d*(c?1:-1)+a,h=Math.asin(d/u)/A2,f=l?i:i+o*h,m=as(r,s,u,f),p=as(r,s,a,f),g=l?i-o*h:i,v=as(r,s,u*Math.cos(h*A2),g);return{center:m,circleTangency:p,lineTangency:v,theta:h}},SJ=function(t){var r=t.cx,s=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.startAngle,c=t.endAngle,d=YUe(o,c),l=o+d,u=as(r,s,i,o),h=as(r,s,i,l),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(d)>180),",").concat(+(o>l),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(a>0){var m=as(r,s,a,o),p=as(r,s,a,l);f+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(d)>180),",").concat(+(o<=l),`,
            `).concat(m.x,",").concat(m.y," Z")}else f+="L ".concat(r,",").concat(s," Z");return f},ZUe=function(t){var r=t.cx,s=t.cy,a=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,c=t.forceCornerRadius,d=t.cornerIsExternal,l=t.startAngle,u=t.endAngle,h=ji(u-l),f=ub({cx:r,cy:s,radius:i,angle:l,sign:h,cornerRadius:o,cornerIsExternal:d}),m=f.circleTangency,p=f.lineTangency,g=f.theta,v=ub({cx:r,cy:s,radius:i,angle:u,sign:-h,cornerRadius:o,cornerIsExternal:d}),x=v.circleTangency,y=v.lineTangency,b=v.theta,j=d?Math.abs(l-u):Math.abs(l-u)-g-b;if(j<0)return c?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):SJ({cx:r,cy:s,innerRadius:a,outerRadius:i,startAngle:l,endAngle:u});var T="M ".concat(p.x,",").concat(p.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(j>180),",").concat(+(h<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(y.x,",").concat(y.y,`
  `);if(a>0){var O=ub({cx:r,cy:s,radius:a,angle:l,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),R=O.circleTangency,D=O.lineTangency,L=O.theta,q=ub({cx:r,cy:s,radius:a,angle:u,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:d}),X=q.circleTangency,H=q.lineTangency,M=q.theta,F=d?Math.abs(l-u):Math.abs(l-u)-L-M;if(F<0&&o===0)return"".concat(T,"L").concat(r,",").concat(s,"Z");T+="L".concat(H.x,",").concat(H.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(X.x,",").concat(X.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(F>180),",").concat(+(h>0),",").concat(R.x,",").concat(R.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(D.x,",").concat(D.y,"Z")}else T+="L".concat(r,",").concat(s,"Z");return T},QUe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},CJ=function(t){var r=qD(qD({},QUe),t),s=r.cx,a=r.cy,i=r.innerRadius,o=r.outerRadius,c=r.cornerRadius,d=r.forceCornerRadius,l=r.cornerIsExternal,u=r.startAngle,h=r.endAngle,f=r.className;if(o<i||u===h)return null;var m=Xr("recharts-sector",f),p=o-i,g=Ni(c,p,0,!0),v;return g>0&&Math.abs(u-h)<360?v=ZUe({cx:s,cy:a,innerRadius:i,outerRadius:o,cornerRadius:Math.min(g,p/2),forceCornerRadius:d,cornerIsExternal:l,startAngle:u,endAngle:h}):v=SJ({cx:s,cy:a,innerRadius:i,outerRadius:o,startAngle:u,endAngle:h}),we.createElement("path",hE({},Sr(r,!0),{className:m,d:v,role:"img"}))};function Vv(e){"@babel/helpers - typeof";return Vv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vv(e)}function fE(){return fE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},fE.apply(this,arguments)}function WD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function HD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WD(Object(r),!0).forEach(function(s){JUe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WD(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function JUe(e,t,r){return t=eVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eVe(e){var t=tVe(e,"string");return Vv(t)=="symbol"?t:t+""}function tVe(e,t){if(Vv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Vv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GD={curveBasisClosed:JAe,curveBasisOpen:eTe,curveBasis:QAe,curveBumpX:BAe,curveBumpY:$Ae,curveLinearClosed:tTe,curveLinear:Ij,curveMonotoneX:rTe,curveMonotoneY:nTe,curveNatural:sTe,curveStep:aTe,curveStepAfter:oTe,curveStepBefore:iTe},hb=function(t){return t.x===+t.x&&t.y===+t.y},I0=function(t){return t.x},D0=function(t){return t.y},rVe=function(t,r){if(Lr(t))return t;var s="curve".concat(Rj(t));return(s==="curveMonotone"||s==="curveBump")&&r?GD["".concat(s).concat(r==="vertical"?"Y":"X")]:GD[s]||Ij},nVe=function(t){var r=t.type,s=r===void 0?"linear":r,a=t.points,i=a===void 0?[]:a,o=t.baseLine,c=t.layout,d=t.connectNulls,l=d===void 0?!1:d,u=rVe(s,c),h=l?i.filter(function(g){return hb(g)}):i,f;if(Array.isArray(o)){var m=l?o.filter(function(g){return hb(g)}):o,p=h.map(function(g,v){return HD(HD({},g),{},{base:m[v]})});return c==="vertical"?f=rb().y(D0).x1(I0).x0(function(g){return g.base.x}):f=rb().x(I0).y1(D0).y0(function(g){return g.base.y}),f.defined(hb).curve(u),f(p)}return c==="vertical"&&Lt(o)?f=rb().y(D0).x1(I0).x0(o):Lt(o)?f=rb().x(I0).y1(D0).y0(o):f=bZ().x(I0).y(D0),f.defined(hb).curve(u),f(h)},rp=function(t){var r=t.className,s=t.points,a=t.path,i=t.pathRef;if((!s||!s.length)&&!a)return null;var o=s&&s.length?nVe(t):a;return P.createElement("path",fE({},Sr(t,!1),t2(t),{className:Xr("recharts-curve",r),d:o,ref:i}))},EJ={exports:{}},sVe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",aVe=sVe,iVe=aVe;function kJ(){}function AJ(){}AJ.resetWarningCache=kJ;var oVe=function(){function e(s,a,i,o,c,d){if(d!==iVe){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:AJ,resetWarningCache:kJ};return r.PropTypes=r,r};EJ.exports=oVe();var lVe=EJ.exports;const In=On(lVe);var cVe=Object.getOwnPropertyNames,dVe=Object.getOwnPropertySymbols,uVe=Object.prototype.hasOwnProperty;function KD(e,t){return function(s,a,i){return e(s,a,i)&&t(s,a,i)}}function fb(e){return function(r,s,a){if(!r||!s||typeof r!="object"||typeof s!="object")return e(r,s,a);var i=a.cache,o=i.get(r),c=i.get(s);if(o&&c)return o===s&&c===r;i.set(r,s),i.set(s,r);var d=e(r,s,a);return i.delete(r),i.delete(s),d}}function XD(e){return cVe(e).concat(dVe(e))}var hVe=Object.hasOwn||function(e,t){return uVe.call(e,t)};function Lf(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var fVe="__v",mVe="__o",pVe="_owner",YD=Object.getOwnPropertyDescriptor,ZD=Object.keys;function gVe(e,t,r){var s=e.length;if(t.length!==s)return!1;for(;s-- >0;)if(!r.equals(e[s],t[s],s,s,e,t,r))return!1;return!0}function xVe(e,t){return Lf(e.getTime(),t.getTime())}function vVe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function yVe(e,t){return e===t}function QD(e,t,r){var s=e.size;if(s!==t.size)return!1;if(!s)return!0;for(var a=new Array(s),i=e.entries(),o,c,d=0;(o=i.next())&&!o.done;){for(var l=t.entries(),u=!1,h=0;(c=l.next())&&!c.done;){if(a[h]){h++;continue}var f=o.value,m=c.value;if(r.equals(f[0],m[0],d,h,e,t,r)&&r.equals(f[1],m[1],f[0],m[0],e,t,r)){u=a[h]=!0;break}h++}if(!u)return!1;d++}return!0}var bVe=Lf;function wVe(e,t,r){var s=ZD(e),a=s.length;if(ZD(t).length!==a)return!1;for(;a-- >0;)if(!TJ(e,t,r,s[a]))return!1;return!0}function L0(e,t,r){var s=XD(e),a=s.length;if(XD(t).length!==a)return!1;for(var i,o,c;a-- >0;)if(i=s[a],!TJ(e,t,r,i)||(o=YD(e,i),c=YD(t,i),(o||c)&&(!o||!c||o.configurable!==c.configurable||o.enumerable!==c.enumerable||o.writable!==c.writable)))return!1;return!0}function _Ve(e,t){return Lf(e.valueOf(),t.valueOf())}function jVe(e,t){return e.source===t.source&&e.flags===t.flags}function JD(e,t,r){var s=e.size;if(s!==t.size)return!1;if(!s)return!0;for(var a=new Array(s),i=e.values(),o,c;(o=i.next())&&!o.done;){for(var d=t.values(),l=!1,u=0;(c=d.next())&&!c.done;){if(!a[u]&&r.equals(o.value,c.value,o.value,c.value,e,t,r)){l=a[u]=!0;break}u++}if(!l)return!1}return!0}function NVe(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}function SVe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function TJ(e,t,r,s){return(s===pVe||s===mVe||s===fVe)&&(e.$$typeof||t.$$typeof)?!0:hVe(t,s)&&r.equals(e[s],t[s],s,s,e,t,r)}var CVe="[object Arguments]",EVe="[object Boolean]",kVe="[object Date]",AVe="[object Error]",TVe="[object Map]",PVe="[object Number]",OVe="[object Object]",RVe="[object RegExp]",MVe="[object Set]",IVe="[object String]",DVe="[object URL]",LVe=Array.isArray,eL=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,tL=Object.assign,BVe=Object.prototype.toString.call.bind(Object.prototype.toString);function $Ve(e){var t=e.areArraysEqual,r=e.areDatesEqual,s=e.areErrorsEqual,a=e.areFunctionsEqual,i=e.areMapsEqual,o=e.areNumbersEqual,c=e.areObjectsEqual,d=e.arePrimitiveWrappersEqual,l=e.areRegExpsEqual,u=e.areSetsEqual,h=e.areTypedArraysEqual,f=e.areUrlsEqual;return function(p,g,v){if(p===g)return!0;if(p==null||g==null)return!1;var x=typeof p;if(x!==typeof g)return!1;if(x!=="object")return x==="number"?o(p,g,v):x==="function"?a(p,g,v):!1;var y=p.constructor;if(y!==g.constructor)return!1;if(y===Object)return c(p,g,v);if(LVe(p))return t(p,g,v);if(eL!=null&&eL(p))return h(p,g,v);if(y===Date)return r(p,g,v);if(y===RegExp)return l(p,g,v);if(y===Map)return i(p,g,v);if(y===Set)return u(p,g,v);var b=BVe(p);return b===kVe?r(p,g,v):b===RVe?l(p,g,v):b===TVe?i(p,g,v):b===MVe?u(p,g,v):b===OVe?typeof p.then!="function"&&typeof g.then!="function"&&c(p,g,v):b===DVe?f(p,g,v):b===AVe?s(p,g,v):b===CVe?c(p,g,v):b===EVe||b===PVe||b===IVe?d(p,g,v):!1}}function FVe(e){var t=e.circular,r=e.createCustomConfig,s=e.strict,a={areArraysEqual:s?L0:gVe,areDatesEqual:xVe,areErrorsEqual:vVe,areFunctionsEqual:yVe,areMapsEqual:s?KD(QD,L0):QD,areNumbersEqual:bVe,areObjectsEqual:s?L0:wVe,arePrimitiveWrappersEqual:_Ve,areRegExpsEqual:jVe,areSetsEqual:s?KD(JD,L0):JD,areTypedArraysEqual:s?L0:NVe,areUrlsEqual:SVe};if(r&&(a=tL({},a,r(a))),t){var i=fb(a.areArraysEqual),o=fb(a.areMapsEqual),c=fb(a.areObjectsEqual),d=fb(a.areSetsEqual);a=tL({},a,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:c,areSetsEqual:d})}return a}function zVe(e){return function(t,r,s,a,i,o,c){return e(t,r,c)}}function UVe(e){var t=e.circular,r=e.comparator,s=e.createState,a=e.equals,i=e.strict;if(s)return function(d,l){var u=s(),h=u.cache,f=h===void 0?t?new WeakMap:void 0:h,m=u.meta;return r(d,l,{cache:f,equals:a,meta:m,strict:i})};if(t)return function(d,l){return r(d,l,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var o={cache:void 0,equals:a,meta:void 0,strict:i};return function(d,l){return r(d,l,o)}}var VVe=Ju();Ju({strict:!0});Ju({circular:!0});Ju({circular:!0,strict:!0});Ju({createInternalComparator:function(){return Lf}});Ju({strict:!0,createInternalComparator:function(){return Lf}});Ju({circular:!0,createInternalComparator:function(){return Lf}});Ju({circular:!0,createInternalComparator:function(){return Lf},strict:!0});function Ju(e){e===void 0&&(e={});var t=e.circular,r=t===void 0?!1:t,s=e.createInternalComparator,a=e.createState,i=e.strict,o=i===void 0?!1:i,c=FVe(e),d=$Ve(c),l=s?s(d):zVe(d);return UVe({circular:r,comparator:d,createState:a,equals:l,strict:o})}function qVe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function rL(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,s=function a(i){r<0&&(r=i),i-r>t?(e(i),r=-1):qVe(a)};requestAnimationFrame(s)}function mE(e){"@babel/helpers - typeof";return mE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mE(e)}function WVe(e){return XVe(e)||KVe(e)||GVe(e)||HVe()}function HVe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GVe(e,t){if(e){if(typeof e=="string")return nL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nL(e,t)}}function nL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function KVe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XVe(e){if(Array.isArray(e))return e}function YVe(){var e={},t=function(){return null},r=!1,s=function a(i){if(!r){if(Array.isArray(i)){if(!i.length)return;var o=i,c=WVe(o),d=c[0],l=c.slice(1);if(typeof d=="number"){rL(a.bind(null,l),d);return}a(d),rL(a.bind(null,l));return}mE(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){r=!0},start:function(i){r=!1,s(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function qv(e){"@babel/helpers - typeof";return qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qv(e)}function sL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function aL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sL(Object(r),!0).forEach(function(s){PJ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function PJ(e,t,r){return t=ZVe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZVe(e){var t=QVe(e,"string");return qv(t)==="symbol"?t:String(t)}function QVe(e,t){if(qv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(qv(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JVe=function(t,r){return[Object.keys(t),Object.keys(r)].reduce(function(s,a){return s.filter(function(i){return a.includes(i)})})},eqe=function(t){return t},tqe=function(t){return t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())})},wx=function(t,r){return Object.keys(r).reduce(function(s,a){return aL(aL({},s),{},PJ({},a,t(a,r[a])))},{})},iL=function(t,r,s){return t.map(function(a){return"".concat(tqe(a)," ").concat(r,"ms ").concat(s)}).join(",")};function rqe(e,t){return aqe(e)||sqe(e,t)||OJ(e,t)||nqe()}function nqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function aqe(e){if(Array.isArray(e))return e}function iqe(e){return cqe(e)||lqe(e)||OJ(e)||oqe()}function oqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function OJ(e,t){if(e){if(typeof e=="string")return pE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pE(e,t)}}function lqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function cqe(e){if(Array.isArray(e))return pE(e)}function pE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}var P2=1e-4,RJ=function(t,r){return[0,3*t,3*r-6*t,3*t-3*r+1]},MJ=function(t,r){return t.map(function(s,a){return s*Math.pow(r,a)}).reduce(function(s,a){return s+a})},oL=function(t,r){return function(s){var a=RJ(t,r);return MJ(a,s)}},dqe=function(t,r){return function(s){var a=RJ(t,r),i=[].concat(iqe(a.map(function(o,c){return o*c}).slice(1)),[0]);return MJ(i,s)}},lL=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];var a=r[0],i=r[1],o=r[2],c=r[3];if(r.length===1)switch(r[0]){case"linear":a=0,i=0,o=1,c=1;break;case"ease":a=.25,i=.1,o=.25,c=1;break;case"ease-in":a=.42,i=0,o=1,c=1;break;case"ease-out":a=.42,i=0,o=.58,c=1;break;case"ease-in-out":a=0,i=0,o=.58,c=1;break;default:{var d=r[0].split("(");if(d[0]==="cubic-bezier"&&d[1].split(")")[0].split(",").length===4){var l=d[1].split(")")[0].split(",").map(function(v){return parseFloat(v)}),u=rqe(l,4);a=u[0],i=u[1],o=u[2],c=u[3]}}}var h=oL(a,o),f=oL(i,c),m=dqe(a,o),p=function(x){return x>1?1:x<0?0:x},g=function(x){for(var y=x>1?1:x,b=y,j=0;j<8;++j){var T=h(b)-y,O=m(b);if(Math.abs(T-y)<P2||O<P2)return f(b);b=p(b-T/O)}return f(b)};return g.isStepper=!1,g},uqe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.stiff,s=r===void 0?100:r,a=t.damping,i=a===void 0?8:a,o=t.dt,c=o===void 0?17:o,d=function(u,h,f){var m=-(u-h)*s,p=f*i,g=f+(m-p)*c/1e3,v=f*c/1e3+u;return Math.abs(v-h)<P2&&Math.abs(g)<P2?[h,0]:[v,g]};return d.isStepper=!0,d.dt=c,d},hqe=function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];var a=r[0];if(typeof a=="string")switch(a){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return lL(a);case"spring":return uqe();default:if(a.split("(")[0]==="cubic-bezier")return lL(a)}return typeof a=="function"?a:null};function Wv(e){"@babel/helpers - typeof";return Wv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wv(e)}function cL(e){return pqe(e)||mqe(e)||IJ(e)||fqe()}function fqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pqe(e){if(Array.isArray(e))return xE(e)}function dL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function qa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dL(Object(r),!0).forEach(function(s){gE(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function gE(e,t,r){return t=gqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gqe(e){var t=xqe(e,"string");return Wv(t)==="symbol"?t:String(t)}function xqe(e,t){if(Wv(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Wv(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vqe(e,t){return wqe(e)||bqe(e,t)||IJ(e,t)||yqe()}function yqe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function IJ(e,t){if(e){if(typeof e=="string")return xE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xE(e,t)}}function xE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function bqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function wqe(e){if(Array.isArray(e))return e}var O2=function(t,r,s){return t+(r-t)*s},vE=function(t){var r=t.from,s=t.to;return r!==s},_qe=function e(t,r,s){var a=wx(function(i,o){if(vE(o)){var c=t(o.from,o.to,o.velocity),d=vqe(c,2),l=d[0],u=d[1];return qa(qa({},o),{},{from:l,velocity:u})}return o},r);return s<1?wx(function(i,o){return vE(o)?qa(qa({},o),{},{velocity:O2(o.velocity,a[i].velocity,s),from:O2(o.from,a[i].from,s)}):o},r):e(t,a,s-1)};const jqe=function(e,t,r,s,a){var i=JVe(e,t),o=i.reduce(function(v,x){return qa(qa({},v),{},gE({},x,[e[x],t[x]]))},{}),c=i.reduce(function(v,x){return qa(qa({},v),{},gE({},x,{from:e[x],velocity:0,to:t[x]}))},{}),d=-1,l,u,h=function(){return null},f=function(){return wx(function(x,y){return y.from},c)},m=function(){return!Object.values(c).filter(vE).length},p=function(x){l||(l=x);var y=x-l,b=y/r.dt;c=_qe(r,c,b),a(qa(qa(qa({},e),t),f())),l=x,m()||(d=requestAnimationFrame(h))},g=function(x){u||(u=x);var y=(x-u)/s,b=wx(function(T,O){return O2.apply(void 0,cL(O).concat([r(y)]))},o);if(a(qa(qa(qa({},e),t),b)),y<1)d=requestAnimationFrame(h);else{var j=wx(function(T,O){return O2.apply(void 0,cL(O).concat([r(1)]))},o);a(qa(qa(qa({},e),t),j))}};return h=r.isStepper?p:g,function(){return requestAnimationFrame(h),function(){cancelAnimationFrame(d)}}};function Wp(e){"@babel/helpers - typeof";return Wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wp(e)}var Nqe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function Sqe(e,t){if(e==null)return{};var r=Cqe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function Cqe(e,t){if(e==null)return{};var r={},s=Object.keys(e),a,i;for(i=0;i<s.length;i++)a=s[i],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function $4(e){return Tqe(e)||Aqe(e)||kqe(e)||Eqe()}function Eqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kqe(e,t){if(e){if(typeof e=="string")return yE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return yE(e,t)}}function Aqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Tqe(e){if(Array.isArray(e))return yE(e)}function yE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function uL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function ul(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uL(Object(r),!0).forEach(function(s){Q0(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Q0(e,t,r){return t=DJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pqe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oqe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,DJ(s.key),s)}}function Rqe(e,t,r){return t&&Oqe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function DJ(e){var t=Mqe(e,"string");return Wp(t)==="symbol"?t:String(t)}function Mqe(e,t){if(Wp(e)!=="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Wp(s)!=="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Iqe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bE(e,t)}function bE(e,t){return bE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},bE(e,t)}function Dqe(e){var t=Lqe();return function(){var s=R2(e),a;if(t){var i=R2(this).constructor;a=Reflect.construct(s,arguments,i)}else a=s.apply(this,arguments);return wE(this,a)}}function wE(e,t){if(t&&(Wp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _E(e)}function _E(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Lqe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function R2(e){return R2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},R2(e)}var Nc=function(e){Iqe(r,e);var t=Dqe(r);function r(s,a){var i;Pqe(this,r),i=t.call(this,s,a);var o=i.props,c=o.isActive,d=o.attributeName,l=o.from,u=o.to,h=o.steps,f=o.children,m=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(_E(i)),i.changeStyle=i.changeStyle.bind(_E(i)),!c||m<=0)return i.state={style:{}},typeof f=="function"&&(i.state={style:u}),wE(i);if(h&&h.length)i.state={style:h[0].style};else if(l){if(typeof f=="function")return i.state={style:l},wE(i);i.state={style:d?Q0({},d,l):l}}else i.state={style:{}};return i}return Rqe(r,[{key:"componentDidMount",value:function(){var a=this.props,i=a.isActive,o=a.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(a){var i=this.props,o=i.isActive,c=i.canBegin,d=i.attributeName,l=i.shouldReAnimate,u=i.to,h=i.from,f=this.state.style;if(c){if(!o){var m={style:d?Q0({},d,u):u};this.state&&f&&(d&&f[d]!==u||!d&&f!==u)&&this.setState(m);return}if(!(VVe(a.to,u)&&a.canBegin&&a.isActive)){var p=!a.canBegin||!a.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=p||l?h:a.to;if(this.state&&f){var v={style:d?Q0({},d,g):g};(d&&f[d]!==g||!d&&f!==g)&&this.setState(v)}this.runAnimation(ul(ul({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var a=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),a&&a()}},{key:"handleStyleChange",value:function(a){this.changeStyle(a)}},{key:"changeStyle",value:function(a){this.mounted&&this.setState({style:a})}},{key:"runJSAnimation",value:function(a){var i=this,o=a.from,c=a.to,d=a.duration,l=a.easing,u=a.begin,h=a.onAnimationEnd,f=a.onAnimationStart,m=jqe(o,c,hqe(l),d,this.changeStyle),p=function(){i.stopJSAnimation=m()};this.manager.start([f,u,p,d,h])}},{key:"runStepAnimation",value:function(a){var i=this,o=a.steps,c=a.begin,d=a.onAnimationStart,l=o[0],u=l.style,h=l.duration,f=h===void 0?0:h,m=function(g,v,x){if(x===0)return g;var y=v.duration,b=v.easing,j=b===void 0?"ease":b,T=v.style,O=v.properties,R=v.onAnimationEnd,D=x>0?o[x-1]:v,L=O||Object.keys(T);if(typeof j=="function"||j==="spring")return[].concat($4(g),[i.runJSAnimation.bind(i,{from:D.style,to:T,duration:y,easing:j}),y]);var q=iL(L,y,j),X=ul(ul(ul({},D.style),T),{},{transition:q});return[].concat($4(g),[X,y,R]).filter(eqe)};return this.manager.start([d].concat($4(o.reduce(m,[u,Math.max(f,c)])),[a.onAnimationEnd]))}},{key:"runAnimation",value:function(a){this.manager||(this.manager=YVe());var i=a.begin,o=a.duration,c=a.attributeName,d=a.to,l=a.easing,u=a.onAnimationStart,h=a.onAnimationEnd,f=a.steps,m=a.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof l=="function"||typeof m=="function"||l==="spring"){this.runJSAnimation(a);return}if(f.length>1){this.runStepAnimation(a);return}var g=c?Q0({},c,d):d,v=iL(Object.keys(g),o,l);p.start([u,i,ul(ul({},g),{},{transition:v}),o,h])}},{key:"render",value:function(){var a=this.props,i=a.children;a.begin;var o=a.duration;a.attributeName,a.easing;var c=a.isActive;a.steps,a.from,a.to,a.canBegin,a.onAnimationEnd,a.shouldReAnimate,a.onAnimationReStart;var d=Sqe(a,Nqe),l=P.Children.count(i),u=this.state.style;if(typeof i=="function")return i(u);if(!c||l===0||o<=0)return i;var h=function(m){var p=m.props,g=p.style,v=g===void 0?{}:g,x=p.className,y=P.cloneElement(m,ul(ul({},d),{},{style:ul(ul({},v),u),className:x}));return y};return l===1?h(P.Children.only(i)):we.createElement("div",null,P.Children.map(i,function(f){return h(f)}))}}]),r}(P.PureComponent);Nc.displayName="Animate";Nc.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};Nc.propTypes={from:In.oneOfType([In.object,In.string]),to:In.oneOfType([In.object,In.string]),attributeName:In.string,duration:In.number,begin:In.number,easing:In.oneOfType([In.string,In.func]),steps:In.arrayOf(In.shape({duration:In.number.isRequired,style:In.object.isRequired,easing:In.oneOfType([In.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),In.func]),properties:In.arrayOf("string"),onAnimationEnd:In.func})),children:In.oneOfType([In.node,In.func]),isActive:In.bool,canBegin:In.bool,onAnimationEnd:In.func,shouldReAnimate:In.bool,onAnimationStart:In.func,onAnimationReStart:In.func};function Hv(e){"@babel/helpers - typeof";return Hv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hv(e)}function M2(){return M2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},M2.apply(this,arguments)}function Bqe(e,t){return Uqe(e)||zqe(e,t)||Fqe(e,t)||$qe()}function $qe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fqe(e,t){if(e){if(typeof e=="string")return hL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hL(e,t)}}function hL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function zqe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function Uqe(e){if(Array.isArray(e))return e}function fL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function mL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fL(Object(r),!0).forEach(function(s){Vqe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Vqe(e,t,r){return t=qqe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qqe(e){var t=Wqe(e,"string");return Hv(t)=="symbol"?t:t+""}function Wqe(e,t){if(Hv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Hv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pL=function(t,r,s,a,i){var o=Math.min(Math.abs(s)/2,Math.abs(a)/2),c=a>=0?1:-1,d=s>=0?1:-1,l=a>=0&&s>=0||a<0&&s<0?1:0,u;if(o>0&&i instanceof Array){for(var h=[0,0,0,0],f=0,m=4;f<m;f++)h[f]=i[f]>o?o:i[f];u="M".concat(t,",").concat(r+c*h[0]),h[0]>0&&(u+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(l,",").concat(t+d*h[0],",").concat(r)),u+="L ".concat(t+s-d*h[1],",").concat(r),h[1]>0&&(u+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(l,`,
        `).concat(t+s,",").concat(r+c*h[1])),u+="L ".concat(t+s,",").concat(r+a-c*h[2]),h[2]>0&&(u+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(l,`,
        `).concat(t+s-d*h[2],",").concat(r+a)),u+="L ".concat(t+d*h[3],",").concat(r+a),h[3]>0&&(u+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(l,`,
        `).concat(t,",").concat(r+a-c*h[3])),u+="Z"}else if(o>0&&i===+i&&i>0){var p=Math.min(o,i);u="M ".concat(t,",").concat(r+c*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+d*p,",").concat(r,`
            L `).concat(t+s-d*p,",").concat(r,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+s,",").concat(r+c*p,`
            L `).concat(t+s,",").concat(r+a-c*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t+s-d*p,",").concat(r+a,`
            L `).concat(t+d*p,",").concat(r+a,`
            A `).concat(p,",").concat(p,",0,0,").concat(l,",").concat(t,",").concat(r+a-c*p," Z")}else u="M ".concat(t,",").concat(r," h ").concat(s," v ").concat(a," h ").concat(-s," Z");return u},Hqe=function(t,r){if(!t||!r)return!1;var s=t.x,a=t.y,i=r.x,o=r.y,c=r.width,d=r.height;if(Math.abs(c)>0&&Math.abs(d)>0){var l=Math.min(i,i+c),u=Math.max(i,i+c),h=Math.min(o,o+d),f=Math.max(o,o+d);return s>=l&&s<=u&&a>=h&&a<=f}return!1},Gqe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},wT=function(t){var r=mL(mL({},Gqe),t),s=P.useRef(),a=P.useState(-1),i=Bqe(a,2),o=i[0],c=i[1];P.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var j=s.current.getTotalLength();j&&c(j)}catch{}},[]);var d=r.x,l=r.y,u=r.width,h=r.height,f=r.radius,m=r.className,p=r.animationEasing,g=r.animationDuration,v=r.animationBegin,x=r.isAnimationActive,y=r.isUpdateAnimationActive;if(d!==+d||l!==+l||u!==+u||h!==+h||u===0||h===0)return null;var b=Xr("recharts-rectangle",m);return y?we.createElement(Nc,{canBegin:o>0,from:{width:u,height:h,x:d,y:l},to:{width:u,height:h,x:d,y:l},duration:g,animationEasing:p,isActive:y},function(j){var T=j.width,O=j.height,R=j.x,D=j.y;return we.createElement(Nc,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,isActive:x,easing:p},we.createElement("path",M2({},Sr(r,!0),{className:b,d:pL(R,D,T,O,f),ref:s})))}):we.createElement("path",M2({},Sr(r,!0),{className:b,d:pL(d,l,u,h,f)}))},Kqe=["points","className","baseLinePoints","connectNulls"];function Mm(){return Mm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Mm.apply(this,arguments)}function Xqe(e,t){if(e==null)return{};var r=Yqe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function Yqe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function gL(e){return eWe(e)||Jqe(e)||Qqe(e)||Zqe()}function Zqe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qqe(e,t){if(e){if(typeof e=="string")return jE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jE(e,t)}}function Jqe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eWe(e){if(Array.isArray(e))return jE(e)}function jE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}var xL=function(t){return t&&t.x===+t.x&&t.y===+t.y},tWe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=[[]];return t.forEach(function(s){xL(s)?r[r.length-1].push(s):r[r.length-1].length>0&&r.push([])}),xL(t[0])&&r[r.length-1].push(t[0]),r[r.length-1].length<=0&&(r=r.slice(0,-1)),r},_x=function(t,r){var s=tWe(t);r&&(s=[s.reduce(function(i,o){return[].concat(gL(i),gL(o))},[])]);var a=s.map(function(i){return i.reduce(function(o,c,d){return"".concat(o).concat(d===0?"M":"L").concat(c.x,",").concat(c.y)},"")}).join("");return s.length===1?"".concat(a,"Z"):a},rWe=function(t,r,s){var a=_x(t,s);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(_x(r.reverse(),s).slice(1))},nWe=function(t){var r=t.points,s=t.className,a=t.baseLinePoints,i=t.connectNulls,o=Xqe(t,Kqe);if(!r||!r.length)return null;var c=Xr("recharts-polygon",s);if(a&&a.length){var d=o.stroke&&o.stroke!=="none",l=rWe(r,a,i);return we.createElement("g",{className:c},we.createElement("path",Mm({},Sr(o,!0),{fill:l.slice(-1)==="Z"?o.fill:"none",stroke:"none",d:l})),d?we.createElement("path",Mm({},Sr(o,!0),{fill:"none",d:_x(r,i)})):null,d?we.createElement("path",Mm({},Sr(o,!0),{fill:"none",d:_x(a,i)})):null)}var u=_x(r,i);return we.createElement("path",Mm({},Sr(o,!0),{fill:u.slice(-1)==="Z"?o.fill:"none",className:c,d:u}))};function NE(){return NE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},NE.apply(this,arguments)}var Zj=function(t){var r=t.cx,s=t.cy,a=t.r,i=t.className,o=Xr("recharts-dot",i);return r===+r&&s===+s&&a===+a?P.createElement("circle",NE({},Sr(t,!1),t2(t),{className:o,cx:r,cy:s,r:a})):null};function Gv(e){"@babel/helpers - typeof";return Gv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gv(e)}var sWe=["x","y","top","left","width","height","className"];function SE(){return SE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},SE.apply(this,arguments)}function vL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function aWe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vL(Object(r),!0).forEach(function(s){iWe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function iWe(e,t,r){return t=oWe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oWe(e){var t=lWe(e,"string");return Gv(t)=="symbol"?t:t+""}function lWe(e,t){if(Gv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Gv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cWe(e,t){if(e==null)return{};var r=dWe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function dWe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}var uWe=function(t,r,s,a,i,o){return"M".concat(t,",").concat(i,"v").concat(a,"M").concat(o,",").concat(r,"h").concat(s)},hWe=function(t){var r=t.x,s=r===void 0?0:r,a=t.y,i=a===void 0?0:a,o=t.top,c=o===void 0?0:o,d=t.left,l=d===void 0?0:d,u=t.width,h=u===void 0?0:u,f=t.height,m=f===void 0?0:f,p=t.className,g=cWe(t,sWe),v=aWe({x:s,y:i,top:c,left:l,width:h,height:m},g);return!Lt(s)||!Lt(i)||!Lt(h)||!Lt(m)||!Lt(c)||!Lt(l)?null:we.createElement("path",SE({},Sr(v,!0),{className:Xr("recharts-cross",p),d:uWe(s,i,h,m,c,l)}))},fWe=Hj,mWe=KQ,pWe=Ic;function gWe(e,t){return e&&e.length?fWe(e,pWe(t),mWe):void 0}var xWe=gWe;const vWe=On(xWe);var yWe=Hj,bWe=Ic,wWe=XQ;function _We(e,t){return e&&e.length?yWe(e,bWe(t),wWe):void 0}var jWe=_We;const NWe=On(jWe);var SWe=["cx","cy","angle","ticks","axisLine"],CWe=["ticks","tick","angle","tickFormatter","stroke"];function Hp(e){"@babel/helpers - typeof";return Hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hp(e)}function jx(){return jx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},jx.apply(this,arguments)}function yL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function fh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yL(Object(r),!0).forEach(function(s){Qj(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function bL(e,t){if(e==null)return{};var r=EWe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function EWe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function kWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wL(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,BJ(s.key),s)}}function AWe(e,t,r){return t&&wL(e.prototype,t),r&&wL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function TWe(e,t,r){return t=I2(t),PWe(e,LJ()?Reflect.construct(t,r||[],I2(e).constructor):t.apply(e,r))}function PWe(e,t){if(t&&(Hp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OWe(e)}function OWe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function LJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(LJ=function(){return!!e})()}function I2(e){return I2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},I2(e)}function RWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&CE(e,t)}function CE(e,t){return CE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},CE(e,t)}function Qj(e,t,r){return t=BJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BJ(e){var t=MWe(e,"string");return Hp(t)=="symbol"?t:t+""}function MWe(e,t){if(Hp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Hp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Jj=function(e){function t(){return kWe(this,t),TWe(this,t,arguments)}return RWe(t,e),AWe(t,[{key:"getTickValueCoord",value:function(s){var a=s.coordinate,i=this.props,o=i.angle,c=i.cx,d=i.cy;return as(c,d,a,o)}},{key:"getTickTextAnchor",value:function(){var s=this.props.orientation,a;switch(s){case"left":a="end";break;case"right":a="start";break;default:a="middle";break}return a}},{key:"getViewBox",value:function(){var s=this.props,a=s.cx,i=s.cy,o=s.angle,c=s.ticks,d=vWe(c,function(u){return u.coordinate||0}),l=NWe(c,function(u){return u.coordinate||0});return{cx:a,cy:i,startAngle:o,endAngle:o,innerRadius:l.coordinate||0,outerRadius:d.coordinate||0}}},{key:"renderAxisLine",value:function(){var s=this.props,a=s.cx,i=s.cy,o=s.angle,c=s.ticks,d=s.axisLine,l=bL(s,SWe),u=c.reduce(function(p,g){return[Math.min(p[0],g.coordinate),Math.max(p[1],g.coordinate)]},[1/0,-1/0]),h=as(a,i,u[0],o),f=as(a,i,u[1],o),m=fh(fh(fh({},Sr(l,!1)),{},{fill:"none"},Sr(d,!1)),{},{x1:h.x,y1:h.y,x2:f.x,y2:f.y});return we.createElement("line",jx({className:"recharts-polar-radius-axis-line"},m))}},{key:"renderTicks",value:function(){var s=this,a=this.props,i=a.ticks,o=a.tick,c=a.angle,d=a.tickFormatter,l=a.stroke,u=bL(a,CWe),h=this.getTickTextAnchor(),f=Sr(u,!1),m=Sr(o,!1),p=i.map(function(g,v){var x=s.getTickValueCoord(g),y=fh(fh(fh(fh({textAnchor:h,transform:"rotate(".concat(90-c,", ").concat(x.x,", ").concat(x.y,")")},f),{},{stroke:"none",fill:l},m),{},{index:v},x),{},{payload:g});return we.createElement(bn,jx({className:Xr("recharts-polar-radius-axis-tick",jJ(o)),key:"tick-".concat(g.coordinate)},wf(s.props,g,v)),t.renderTickItem(o,y,d?d(g.value,v):g.value))});return we.createElement(bn,{className:"recharts-polar-radius-axis-ticks"},p)}},{key:"render",value:function(){var s=this.props,a=s.ticks,i=s.axisLine,o=s.tick;return!a||!a.length?null:we.createElement(bn,{className:Xr("recharts-polar-radius-axis",this.props.className)},i&&this.renderAxisLine(),o&&this.renderTicks(),Pa.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(s,a,i){var o;return we.isValidElement(s)?o=we.cloneElement(s,a):Lr(s)?o=s(a):o=we.createElement(_f,jx({},a,{className:"recharts-polar-radius-axis-tick-value"}),i),o}}])}(P.PureComponent);Qj(Jj,"displayName","PolarRadiusAxis");Qj(Jj,"axisType","radiusAxis");Qj(Jj,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Gp(e){"@babel/helpers - typeof";return Gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gp(e)}function Ch(){return Ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Ch.apply(this,arguments)}function _L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function mh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_L(Object(r),!0).forEach(function(s){eN(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_L(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function IWe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jL(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,FJ(s.key),s)}}function DWe(e,t,r){return t&&jL(e.prototype,t),r&&jL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LWe(e,t,r){return t=D2(t),BWe(e,$J()?Reflect.construct(t,r||[],D2(e).constructor):t.apply(e,r))}function BWe(e,t){if(t&&(Gp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $We(e)}function $We(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $J(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return($J=function(){return!!e})()}function D2(e){return D2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},D2(e)}function FWe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&EE(e,t)}function EE(e,t){return EE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},EE(e,t)}function eN(e,t,r){return t=FJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FJ(e){var t=zWe(e,"string");return Gp(t)=="symbol"?t:t+""}function zWe(e,t){if(Gp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Gp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UWe=Math.PI/180,NL=1e-5,tN=function(e){function t(){return IWe(this,t),LWe(this,t,arguments)}return FWe(t,e),DWe(t,[{key:"getTickLineCoord",value:function(s){var a=this.props,i=a.cx,o=a.cy,c=a.radius,d=a.orientation,l=a.tickSize,u=l||8,h=as(i,o,c,s.coordinate),f=as(i,o,c+(d==="inner"?-1:1)*u,s.coordinate);return{x1:h.x,y1:h.y,x2:f.x,y2:f.y}}},{key:"getTickTextAnchor",value:function(s){var a=this.props.orientation,i=Math.cos(-s.coordinate*UWe),o;return i>NL?o=a==="outer"?"start":"end":i<-NL?o=a==="outer"?"end":"start":o="middle",o}},{key:"renderAxisLine",value:function(){var s=this.props,a=s.cx,i=s.cy,o=s.radius,c=s.axisLine,d=s.axisLineType,l=mh(mh({},Sr(this.props,!1)),{},{fill:"none"},Sr(c,!1));if(d==="circle")return we.createElement(Zj,Ch({className:"recharts-polar-angle-axis-line"},l,{cx:a,cy:i,r:o}));var u=this.props.ticks,h=u.map(function(f){return as(a,i,o,f.coordinate)});return we.createElement(nWe,Ch({className:"recharts-polar-angle-axis-line"},l,{points:h}))}},{key:"renderTicks",value:function(){var s=this,a=this.props,i=a.ticks,o=a.tick,c=a.tickLine,d=a.tickFormatter,l=a.stroke,u=Sr(this.props,!1),h=Sr(o,!1),f=mh(mh({},u),{},{fill:"none"},Sr(c,!1)),m=i.map(function(p,g){var v=s.getTickLineCoord(p),x=s.getTickTextAnchor(p),y=mh(mh(mh({textAnchor:x},u),{},{stroke:"none",fill:l},h),{},{index:g,payload:p,x:v.x2,y:v.y2});return we.createElement(bn,Ch({className:Xr("recharts-polar-angle-axis-tick",jJ(o)),key:"tick-".concat(p.coordinate)},wf(s.props,p,g)),c&&we.createElement("line",Ch({className:"recharts-polar-angle-axis-tick-line"},f,v)),o&&t.renderTickItem(o,y,d?d(p.value,g):p.value))});return we.createElement(bn,{className:"recharts-polar-angle-axis-ticks"},m)}},{key:"render",value:function(){var s=this.props,a=s.ticks,i=s.radius,o=s.axisLine;return i<=0||!a||!a.length?null:we.createElement(bn,{className:Xr("recharts-polar-angle-axis",this.props.className)},o&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(s,a,i){var o;return we.isValidElement(s)?o=we.cloneElement(s,a):Lr(s)?o=s(a):o=we.createElement(_f,Ch({},a,{className:"recharts-polar-angle-axis-tick-value"}),i),o}}])}(P.PureComponent);eN(tN,"displayName","PolarAngleAxis");eN(tN,"axisType","angleAxis");eN(tN,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var VWe=qZ,qWe=VWe(Object.getPrototypeOf,Object),WWe=qWe,HWe=Sd,GWe=WWe,KWe=Cd,XWe="[object Object]",YWe=Function.prototype,ZWe=Object.prototype,zJ=YWe.toString,QWe=ZWe.hasOwnProperty,JWe=zJ.call(Object);function eHe(e){if(!KWe(e)||HWe(e)!=XWe)return!1;var t=GWe(e);if(t===null)return!0;var r=QWe.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&zJ.call(r)==JWe}var tHe=eHe;const rHe=On(tHe);var nHe=Sd,sHe=Cd,aHe="[object Boolean]";function iHe(e){return e===!0||e===!1||sHe(e)&&nHe(e)==aHe}var oHe=iHe;const lHe=On(oHe);function Kv(e){"@babel/helpers - typeof";return Kv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kv(e)}function L2(){return L2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},L2.apply(this,arguments)}function cHe(e,t){return fHe(e)||hHe(e,t)||uHe(e,t)||dHe()}function dHe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uHe(e,t){if(e){if(typeof e=="string")return SL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SL(e,t)}}function SL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function hHe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function fHe(e){if(Array.isArray(e))return e}function CL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function EL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CL(Object(r),!0).forEach(function(s){mHe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function mHe(e,t,r){return t=pHe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pHe(e){var t=gHe(e,"string");return Kv(t)=="symbol"?t:t+""}function gHe(e,t){if(Kv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Kv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kL=function(t,r,s,a,i){var o=s-a,c;return c="M ".concat(t,",").concat(r),c+="L ".concat(t+s,",").concat(r),c+="L ".concat(t+s-o/2,",").concat(r+i),c+="L ".concat(t+s-o/2-a,",").concat(r+i),c+="L ".concat(t,",").concat(r," Z"),c},xHe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},vHe=function(t){var r=EL(EL({},xHe),t),s=P.useRef(),a=P.useState(-1),i=cHe(a,2),o=i[0],c=i[1];P.useEffect(function(){if(s.current&&s.current.getTotalLength)try{var b=s.current.getTotalLength();b&&c(b)}catch{}},[]);var d=r.x,l=r.y,u=r.upperWidth,h=r.lowerWidth,f=r.height,m=r.className,p=r.animationEasing,g=r.animationDuration,v=r.animationBegin,x=r.isUpdateAnimationActive;if(d!==+d||l!==+l||u!==+u||h!==+h||f!==+f||u===0&&h===0||f===0)return null;var y=Xr("recharts-trapezoid",m);return x?we.createElement(Nc,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:f,x:d,y:l},to:{upperWidth:u,lowerWidth:h,height:f,x:d,y:l},duration:g,animationEasing:p,isActive:x},function(b){var j=b.upperWidth,T=b.lowerWidth,O=b.height,R=b.x,D=b.y;return we.createElement(Nc,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:v,duration:g,easing:p},we.createElement("path",L2({},Sr(r,!0),{className:y,d:kL(R,D,j,T,O),ref:s})))}):we.createElement("g",null,we.createElement("path",L2({},Sr(r,!0),{className:y,d:kL(d,l,u,h,f)})))},yHe=["option","shapeType","propTransformer","activeClassName","isActive"];function Xv(e){"@babel/helpers - typeof";return Xv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xv(e)}function bHe(e,t){if(e==null)return{};var r=wHe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function wHe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function AL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function B2(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AL(Object(r),!0).forEach(function(s){_He(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function _He(e,t,r){return t=jHe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jHe(e){var t=NHe(e,"string");return Xv(t)=="symbol"?t:t+""}function NHe(e,t){if(Xv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Xv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SHe(e,t){return B2(B2({},t),e)}function CHe(e,t){return e==="symbols"}function TL(e){var t=e.shapeType,r=e.elementProps;switch(t){case"rectangle":return we.createElement(wT,r);case"trapezoid":return we.createElement(vHe,r);case"sector":return we.createElement(CJ,r);case"symbols":if(CHe(t))return we.createElement($A,r);break;default:return null}}function EHe(e){return P.isValidElement(e)?e.props:e}function UJ(e){var t=e.option,r=e.shapeType,s=e.propTransformer,a=s===void 0?SHe:s,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,c=e.isActive,d=bHe(e,yHe),l;if(P.isValidElement(t))l=P.cloneElement(t,B2(B2({},d),EHe(t)));else if(Lr(t))l=t(d);else if(rHe(t)&&!lHe(t)){var u=a(t,d);l=we.createElement(TL,{shapeType:r,elementProps:u})}else{var h=d;l=we.createElement(TL,{shapeType:r,elementProps:h})}return c?we.createElement(bn,{className:o},l):l}function rN(e,t){return t!=null&&"trapezoids"in e.props}function nN(e,t){return t!=null&&"sectors"in e.props}function Yv(e,t){return t!=null&&"points"in e.props}function kHe(e,t){var r,s,a=e.x===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.x)||e.x===t.x,i=e.y===(t==null||(s=t.labelViewBox)===null||s===void 0?void 0:s.y)||e.y===t.y;return a&&i}function AHe(e,t){var r=e.endAngle===t.endAngle,s=e.startAngle===t.startAngle;return r&&s}function THe(e,t){var r=e.x===t.x,s=e.y===t.y,a=e.z===t.z;return r&&s&&a}function PHe(e,t){var r;return rN(e,t)?r=kHe:nN(e,t)?r=AHe:Yv(e,t)&&(r=THe),r}function OHe(e,t){var r;return rN(e,t)?r="trapezoids":nN(e,t)?r="sectors":Yv(e,t)&&(r="points"),r}function RHe(e,t){if(rN(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}if(nN(e,t)){var s;return(s=t.tooltipPayload)===null||s===void 0||(s=s[0])===null||s===void 0||(s=s.payload)===null||s===void 0?void 0:s.payload}return Yv(e,t)?t.payload:{}}function MHe(e){var t=e.activeTooltipItem,r=e.graphicalItem,s=e.itemData,a=OHe(r,t),i=RHe(r,t),o=s.filter(function(d,l){var u=Vp(i,d),h=r.props[a].filter(function(p){var g=PHe(r,t);return g(p,t)}),f=r.props[a].indexOf(h[h.length-1]),m=l===f;return u&&m}),c=s.indexOf(o[o.length-1]);return c}var Ub;function Kp(e){"@babel/helpers - typeof";return Kp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kp(e)}function Im(){return Im=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Im.apply(this,arguments)}function PL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function es(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PL(Object(r),!0).forEach(function(s){Fo(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function IHe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OL(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,qJ(s.key),s)}}function DHe(e,t,r){return t&&OL(e.prototype,t),r&&OL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function LHe(e,t,r){return t=$2(t),BHe(e,VJ()?Reflect.construct(t,r||[],$2(e).constructor):t.apply(e,r))}function BHe(e,t){if(t&&(Kp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return $He(e)}function $He(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function VJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(VJ=function(){return!!e})()}function $2(e){return $2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},$2(e)}function FHe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&kE(e,t)}function kE(e,t){return kE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},kE(e,t)}function Fo(e,t,r){return t=qJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qJ(e){var t=zHe(e,"string");return Kp(t)=="symbol"?t:t+""}function zHe(e,t){if(Kp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Kp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Dc=function(e){function t(r){var s;return IHe(this,t),s=LHe(this,t,[r]),Fo(s,"pieRef",null),Fo(s,"sectorRefs",[]),Fo(s,"id",Wg("recharts-pie-")),Fo(s,"handleAnimationEnd",function(){var a=s.props.onAnimationEnd;s.setState({isAnimationFinished:!0}),Lr(a)&&a()}),Fo(s,"handleAnimationStart",function(){var a=s.props.onAnimationStart;s.setState({isAnimationFinished:!1}),Lr(a)&&a()}),s.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},s}return FHe(t,e),DHe(t,[{key:"isActiveIndex",value:function(s){var a=this.props.activeIndex;return Array.isArray(a)?a.indexOf(s)!==-1:s===a}},{key:"hasActiveIndex",value:function(){var s=this.props.activeIndex;return Array.isArray(s)?s.length!==0:s||s===0}},{key:"renderLabels",value:function(s){var a=this.props.isAnimationActive;if(a&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.label,c=i.labelLine,d=i.dataKey,l=i.valueKey,u=Sr(this.props,!1),h=Sr(o,!1),f=Sr(c,!1),m=o&&o.offsetRadius||20,p=s.map(function(g,v){var x=(g.startAngle+g.endAngle)/2,y=as(g.cx,g.cy,g.outerRadius+m,x),b=es(es(es(es({},u),g),{},{stroke:"none"},h),{},{index:v,textAnchor:t.getTextAnchor(y.x,g.cx)},y),j=es(es(es(es({},u),g),{},{fill:"none",stroke:g.fill},f),{},{index:v,points:[as(g.cx,g.cy,g.outerRadius,x),y]}),T=d;return Yr(d)&&Yr(l)?T="value":Yr(d)&&(T=l),we.createElement(bn,{key:"label-".concat(g.startAngle,"-").concat(g.endAngle,"-").concat(g.midAngle,"-").concat(v)},c&&t.renderLabelLineItem(c,j,"line"),t.renderLabelItem(o,b,ua(g,T)))});return we.createElement(bn,{className:"recharts-pie-labels"},p)}},{key:"renderSectorsStatically",value:function(s){var a=this,i=this.props,o=i.activeShape,c=i.blendStroke,d=i.inactiveShape;return s.map(function(l,u){if((l==null?void 0:l.startAngle)===0&&(l==null?void 0:l.endAngle)===0&&s.length!==1)return null;var h=a.isActiveIndex(u),f=d&&a.hasActiveIndex()?d:null,m=h?o:f,p=es(es({},l),{},{stroke:c?l.fill:l.stroke,tabIndex:-1});return we.createElement(bn,Im({ref:function(v){v&&!a.sectorRefs.includes(v)&&a.sectorRefs.push(v)},tabIndex:-1,className:"recharts-pie-sector"},wf(a.props,l,u),{key:"sector-".concat(l==null?void 0:l.startAngle,"-").concat(l==null?void 0:l.endAngle,"-").concat(l.midAngle,"-").concat(u)}),we.createElement(UJ,Im({option:m,isActive:h,shapeType:"sector"},p)))})}},{key:"renderSectorsWithAnimation",value:function(){var s=this,a=this.props,i=a.sectors,o=a.isAnimationActive,c=a.animationBegin,d=a.animationDuration,l=a.animationEasing,u=a.animationId,h=this.state,f=h.prevSectors,m=h.prevIsAnimationActive;return we.createElement(Nc,{begin:c,duration:d,isActive:o,easing:l,from:{t:0},to:{t:1},key:"pie-".concat(u,"-").concat(m),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(p){var g=p.t,v=[],x=i&&i[0],y=x.startAngle;return i.forEach(function(b,j){var T=f&&f[j],O=j>0?bo(b,"paddingAngle",0):0;if(T){var R=$i(T.endAngle-T.startAngle,b.endAngle-b.startAngle),D=es(es({},b),{},{startAngle:y+O,endAngle:y+R(g)+O});v.push(D),y=D.endAngle}else{var L=b.endAngle,q=b.startAngle,X=$i(0,L-q),H=X(g),M=es(es({},b),{},{startAngle:y+O,endAngle:y+H+O});v.push(M),y=M.endAngle}}),we.createElement(bn,null,s.renderSectorsStatically(v))})}},{key:"attachKeyboardHandlers",value:function(s){var a=this;s.onkeydown=function(i){if(!i.altKey)switch(i.key){case"ArrowLeft":{var o=++a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[o].focus(),a.setState({sectorToFocus:o});break}case"ArrowRight":{var c=--a.state.sectorToFocus<0?a.sectorRefs.length-1:a.state.sectorToFocus%a.sectorRefs.length;a.sectorRefs[c].focus(),a.setState({sectorToFocus:c});break}case"Escape":{a.sectorRefs[a.state.sectorToFocus].blur(),a.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var s=this.props,a=s.sectors,i=s.isAnimationActive,o=this.state.prevSectors;return i&&a&&a.length&&(!o||!Vp(o,a))?this.renderSectorsWithAnimation():this.renderSectorsStatically(a)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var s=this,a=this.props,i=a.hide,o=a.sectors,c=a.className,d=a.label,l=a.cx,u=a.cy,h=a.innerRadius,f=a.outerRadius,m=a.isAnimationActive,p=this.state.isAnimationFinished;if(i||!o||!o.length||!Lt(l)||!Lt(u)||!Lt(h)||!Lt(f))return null;var g=Xr("recharts-pie",c);return we.createElement(bn,{tabIndex:this.props.rootTabIndex,className:g,ref:function(x){s.pieRef=x}},this.renderSectors(),d&&this.renderLabels(o),Pa.renderCallByParent(this.props,null,!1),(!m||p)&&sd.renderCallByParent(this.props,o,!1))}}],[{key:"getDerivedStateFromProps",value:function(s,a){return a.prevIsAnimationActive!==s.isAnimationActive?{prevIsAnimationActive:s.isAnimationActive,prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:[],isAnimationFinished:!0}:s.isAnimationActive&&s.animationId!==a.prevAnimationId?{prevAnimationId:s.animationId,curSectors:s.sectors,prevSectors:a.curSectors,isAnimationFinished:!0}:s.sectors!==a.curSectors?{curSectors:s.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(s,a){return s>a?"start":s<a?"end":"middle"}},{key:"renderLabelLineItem",value:function(s,a,i){if(we.isValidElement(s))return we.cloneElement(s,a);if(Lr(s))return s(a);var o=Xr("recharts-pie-label-line",typeof s!="boolean"?s.className:"");return we.createElement(rp,Im({},a,{key:i,type:"linear",className:o}))}},{key:"renderLabelItem",value:function(s,a,i){if(we.isValidElement(s))return we.cloneElement(s,a);var o=i;if(Lr(s)&&(o=s(a),we.isValidElement(o)))return o;var c=Xr("recharts-pie-label-text",typeof s!="boolean"&&!Lr(s)?s.className:"");return we.createElement(_f,Im({},a,{alignmentBaseline:"middle",className:c}),o)}}])}(P.PureComponent);Ub=Dc;Fo(Dc,"displayName","Pie");Fo(Dc,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!gc.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});Fo(Dc,"parseDeltaAngle",function(e,t){var r=ji(t-e),s=Math.min(Math.abs(t-e),360);return r*s});Fo(Dc,"getRealPieData",function(e){var t=e.data,r=e.children,s=Sr(e,!1),a=Go(r,W1);return t&&t.length?t.map(function(i,o){return es(es(es({payload:i},s),i),a&&a[o]&&a[o].props)}):a&&a.length?a.map(function(i){return es(es({},s),i.props)}):[]});Fo(Dc,"parseCoordinateOfPie",function(e,t){var r=t.top,s=t.left,a=t.width,i=t.height,o=_J(a,i),c=s+Ni(e.cx,a,a/2),d=r+Ni(e.cy,i,i/2),l=Ni(e.innerRadius,o,0),u=Ni(e.outerRadius,o,o*.8),h=e.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:c,cy:d,innerRadius:l,outerRadius:u,maxRadius:h}});Fo(Dc,"getComposedData",function(e){var t=e.item,r=e.offset,s=t.type.defaultProps!==void 0?es(es({},t.type.defaultProps),t.props):t.props,a=Ub.getRealPieData(s);if(!a||!a.length)return null;var i=s.cornerRadius,o=s.startAngle,c=s.endAngle,d=s.paddingAngle,l=s.dataKey,u=s.nameKey,h=s.valueKey,f=s.tooltipType,m=Math.abs(s.minAngle),p=Ub.parseCoordinateOfPie(s,r),g=Ub.parseDeltaAngle(o,c),v=Math.abs(g),x=l;Yr(l)&&Yr(h)?(Al(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x="value"):Yr(l)&&(Al(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),x=h);var y=a.filter(function(D){return ua(D,x,0)!==0}).length,b=(v>=360?y:y-1)*d,j=v-y*m-b,T=a.reduce(function(D,L){var q=ua(L,x,0);return D+(Lt(q)?q:0)},0),O;if(T>0){var R;O=a.map(function(D,L){var q=ua(D,x,0),X=ua(D,u,L),H=(Lt(q)?q:0)/T,M;L?M=R.endAngle+ji(g)*d*(q!==0?1:0):M=o;var F=M+ji(g)*((q!==0?m:0)+H*j),S=(M+F)/2,E=(p.innerRadius+p.outerRadius)/2,N=[{name:X,value:q,payload:D,dataKey:x,type:f}],C=as(p.cx,p.cy,E,S);return R=es(es(es({percent:H,cornerRadius:i,name:X,tooltipPayload:N,midAngle:S,middleRadius:E,tooltipPosition:C},D),p),{},{value:ua(D,x),startAngle:M,endAngle:F,payload:D,paddingAngle:ji(g)*d}),R})}return es(es({},p),{},{sectors:O,data:a})});var UHe=Math.ceil,VHe=Math.max;function qHe(e,t,r,s){for(var a=-1,i=VHe(UHe((t-e)/(r||1)),0),o=Array(i);i--;)o[s?i:++a]=e,e+=r;return o}var WHe=qHe,HHe=cQ,RL=1/0,GHe=17976931348623157e292;function KHe(e){if(!e)return e===0?e:0;if(e=HHe(e),e===RL||e===-RL){var t=e<0?-1:1;return t*GHe}return e===e?e:0}var WJ=KHe,XHe=WHe,YHe=$j,F4=WJ;function ZHe(e){return function(t,r,s){return s&&typeof s!="number"&&YHe(t,r,s)&&(r=s=void 0),t=F4(t),r===void 0?(r=t,t=0):r=F4(r),s=s===void 0?t<r?1:-1:F4(s),XHe(t,r,s,e)}}var QHe=ZHe,JHe=QHe,eGe=JHe(),tGe=eGe;const F2=On(tGe);function Zv(e){"@babel/helpers - typeof";return Zv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zv(e)}function ML(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function IL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ML(Object(r),!0).forEach(function(s){HJ(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ML(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function HJ(e,t,r){return t=rGe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rGe(e){var t=nGe(e,"string");return Zv(t)=="symbol"?t:t+""}function nGe(e,t){if(Zv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Zv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sGe=["Webkit","Moz","O","ms"],aGe=function(t,r){var s=t.replace(/(\w)/,function(i){return i.toUpperCase()}),a=sGe.reduce(function(i,o){return IL(IL({},i),{},HJ({},o+s,r))},{});return a[t]=r,a};function Xp(e){"@babel/helpers - typeof";return Xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xp(e)}function z2(){return z2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},z2.apply(this,arguments)}function DL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function z4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DL(Object(r),!0).forEach(function(s){io(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function iGe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LL(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,KJ(s.key),s)}}function oGe(e,t,r){return t&&LL(e.prototype,t),r&&LL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function lGe(e,t,r){return t=U2(t),cGe(e,GJ()?Reflect.construct(t,r||[],U2(e).constructor):t.apply(e,r))}function cGe(e,t){if(t&&(Xp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dGe(e)}function dGe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function GJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(GJ=function(){return!!e})()}function U2(e){return U2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},U2(e)}function uGe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&AE(e,t)}function AE(e,t){return AE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},AE(e,t)}function io(e,t,r){return t=KJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KJ(e){var t=hGe(e,"string");return Xp(t)=="symbol"?t:t+""}function hGe(e,t){if(Xp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Xp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fGe=function(t){var r=t.data,s=t.startIndex,a=t.endIndex,i=t.x,o=t.width,c=t.travellerWidth;if(!r||!r.length)return{};var d=r.length,l=yx().domain(F2(0,d)).range([i,i+o-c]),u=l.domain().map(function(h){return l(h)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:l(s),endX:l(a),scale:l,scaleValues:u}},BL=function(t){return t.changedTouches&&!!t.changedTouches.length},Yp=function(e){function t(r){var s;return iGe(this,t),s=lGe(this,t,[r]),io(s,"handleDrag",function(a){s.leaveTimer&&(clearTimeout(s.leaveTimer),s.leaveTimer=null),s.state.isTravellerMoving?s.handleTravellerMove(a):s.state.isSlideMoving&&s.handleSlideDrag(a)}),io(s,"handleTouchMove",function(a){a.changedTouches!=null&&a.changedTouches.length>0&&s.handleDrag(a.changedTouches[0])}),io(s,"handleDragEnd",function(){s.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var a=s.props,i=a.endIndex,o=a.onDragEnd,c=a.startIndex;o==null||o({endIndex:i,startIndex:c})}),s.detachDragEndListener()}),io(s,"handleLeaveWrapper",function(){(s.state.isTravellerMoving||s.state.isSlideMoving)&&(s.leaveTimer=window.setTimeout(s.handleDragEnd,s.props.leaveTimeOut))}),io(s,"handleEnterSlideOrTraveller",function(){s.setState({isTextActive:!0})}),io(s,"handleLeaveSlideOrTraveller",function(){s.setState({isTextActive:!1})}),io(s,"handleSlideDragStart",function(a){var i=BL(a)?a.changedTouches[0]:a;s.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),s.attachDragEndListener()}),s.travellerDragStartHandlers={startX:s.handleTravellerDragStart.bind(s,"startX"),endX:s.handleTravellerDragStart.bind(s,"endX")},s.state={},s}return uGe(t,e),oGe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(s){var a=s.startX,i=s.endX,o=this.state.scaleValues,c=this.props,d=c.gap,l=c.data,u=l.length-1,h=Math.min(a,i),f=Math.max(a,i),m=t.getIndexInRange(o,h),p=t.getIndexInRange(o,f);return{startIndex:m-m%d,endIndex:p===u?u:p-p%d}}},{key:"getTextOfTick",value:function(s){var a=this.props,i=a.data,o=a.tickFormatter,c=a.dataKey,d=ua(i[s],c,s);return Lr(o)?o(d,s):d}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(s){var a=this.state,i=a.slideMoveStartX,o=a.startX,c=a.endX,d=this.props,l=d.x,u=d.width,h=d.travellerWidth,f=d.startIndex,m=d.endIndex,p=d.onChange,g=s.pageX-i;g>0?g=Math.min(g,l+u-h-c,l+u-h-o):g<0&&(g=Math.max(g,l-o,l-c));var v=this.getIndex({startX:o+g,endX:c+g});(v.startIndex!==f||v.endIndex!==m)&&p&&p(v),this.setState({startX:o+g,endX:c+g,slideMoveStartX:s.pageX})}},{key:"handleTravellerDragStart",value:function(s,a){var i=BL(a)?a.changedTouches[0]:a;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:s,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(s){var a=this.state,i=a.brushMoveStartX,o=a.movingTravellerId,c=a.endX,d=a.startX,l=this.state[o],u=this.props,h=u.x,f=u.width,m=u.travellerWidth,p=u.onChange,g=u.gap,v=u.data,x={startX:this.state.startX,endX:this.state.endX},y=s.pageX-i;y>0?y=Math.min(y,h+f-m-l):y<0&&(y=Math.max(y,h-l)),x[o]=l+y;var b=this.getIndex(x),j=b.startIndex,T=b.endIndex,O=function(){var D=v.length-1;return o==="startX"&&(c>d?j%g===0:T%g===0)||c<d&&T===D||o==="endX"&&(c>d?T%g===0:j%g===0)||c>d&&T===D};this.setState(io(io({},o,l+y),"brushMoveStartX",s.pageX),function(){p&&O()&&p(b)})}},{key:"handleTravellerMoveKeyboard",value:function(s,a){var i=this,o=this.state,c=o.scaleValues,d=o.startX,l=o.endX,u=this.state[a],h=c.indexOf(u);if(h!==-1){var f=h+s;if(!(f===-1||f>=c.length)){var m=c[f];a==="startX"&&m>=l||a==="endX"&&m<=d||this.setState(io({},a,m),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var s=this.props,a=s.x,i=s.y,o=s.width,c=s.height,d=s.fill,l=s.stroke;return we.createElement("rect",{stroke:l,fill:d,x:a,y:i,width:o,height:c})}},{key:"renderPanorama",value:function(){var s=this.props,a=s.x,i=s.y,o=s.width,c=s.height,d=s.data,l=s.children,u=s.padding,h=P.Children.only(l);return h?we.cloneElement(h,{x:a,y:i,width:o,height:c,margin:u,compact:!0,data:d}):null}},{key:"renderTravellerLayer",value:function(s,a){var i,o,c=this,d=this.props,l=d.y,u=d.travellerWidth,h=d.height,f=d.traveller,m=d.ariaLabel,p=d.data,g=d.startIndex,v=d.endIndex,x=Math.max(s,this.props.x),y=z4(z4({},Sr(this.props,!1)),{},{x,y:l,width:u,height:h}),b=m||"Min value: ".concat((i=p[g])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=p[v])===null||o===void 0?void 0:o.name);return we.createElement(bn,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":s,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[a],onTouchStart:this.travellerDragStartHandlers[a],onKeyDown:function(T){["ArrowLeft","ArrowRight"].includes(T.key)&&(T.preventDefault(),T.stopPropagation(),c.handleTravellerMoveKeyboard(T.key==="ArrowRight"?1:-1,a))},onFocus:function(){c.setState({isTravellerFocused:!0})},onBlur:function(){c.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(f,y))}},{key:"renderSlide",value:function(s,a){var i=this.props,o=i.y,c=i.height,d=i.stroke,l=i.travellerWidth,u=Math.min(s,a)+l,h=Math.max(Math.abs(a-s)-l,0);return we.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:d,fillOpacity:.2,x:u,y:o,width:h,height:c})}},{key:"renderText",value:function(){var s=this.props,a=s.startIndex,i=s.endIndex,o=s.y,c=s.height,d=s.travellerWidth,l=s.stroke,u=this.state,h=u.startX,f=u.endX,m=5,p={pointerEvents:"none",fill:l};return we.createElement(bn,{className:"recharts-brush-texts"},we.createElement(_f,z2({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,f)-m,y:o+c/2},p),this.getTextOfTick(a)),we.createElement(_f,z2({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,f)+d+m,y:o+c/2},p),this.getTextOfTick(i)))}},{key:"render",value:function(){var s=this.props,a=s.data,i=s.className,o=s.children,c=s.x,d=s.y,l=s.width,u=s.height,h=s.alwaysShowText,f=this.state,m=f.startX,p=f.endX,g=f.isTextActive,v=f.isSlideMoving,x=f.isTravellerMoving,y=f.isTravellerFocused;if(!a||!a.length||!Lt(c)||!Lt(d)||!Lt(l)||!Lt(u)||l<=0||u<=0)return null;var b=Xr("recharts-brush",i),j=we.Children.count(o)===1,T=aGe("userSelect","none");return we.createElement(bn,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:T},this.renderBackground(),j&&this.renderPanorama(),this.renderSlide(m,p),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(p,"endX"),(g||v||x||y||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(s){var a=s.x,i=s.y,o=s.width,c=s.height,d=s.stroke,l=Math.floor(i+c/2)-1;return we.createElement(we.Fragment,null,we.createElement("rect",{x:a,y:i,width:o,height:c,fill:d,stroke:"none"}),we.createElement("line",{x1:a+1,y1:l,x2:a+o-1,y2:l,fill:"none",stroke:"#fff"}),we.createElement("line",{x1:a+1,y1:l+2,x2:a+o-1,y2:l+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(s,a){var i;return we.isValidElement(s)?i=we.cloneElement(s,a):Lr(s)?i=s(a):i=t.renderDefaultTraveller(a),i}},{key:"getDerivedStateFromProps",value:function(s,a){var i=s.data,o=s.width,c=s.x,d=s.travellerWidth,l=s.updateId,u=s.startIndex,h=s.endIndex;if(i!==a.prevData||l!==a.prevUpdateId)return z4({prevData:i,prevTravellerWidth:d,prevUpdateId:l,prevX:c,prevWidth:o},i&&i.length?fGe({data:i,width:o,x:c,travellerWidth:d,startIndex:u,endIndex:h}):{scale:null,scaleValues:null});if(a.scale&&(o!==a.prevWidth||c!==a.prevX||d!==a.prevTravellerWidth)){a.scale.range([c,c+o-d]);var f=a.scale.domain().map(function(m){return a.scale(m)});return{prevData:i,prevTravellerWidth:d,prevUpdateId:l,prevX:c,prevWidth:o,startX:a.scale(s.startIndex),endX:a.scale(s.endIndex),scaleValues:f}}return null}},{key:"getIndexInRange",value:function(s,a){for(var i=s.length,o=0,c=i-1;c-o>1;){var d=Math.floor((o+c)/2);s[d]>a?c=d:o=d}return a>=s[c]?c:o}}])}(P.PureComponent);io(Yp,"displayName","Brush");io(Yp,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var mGe=HA;function pGe(e,t){var r;return mGe(e,function(s,a,i){return r=t(s,a,i),!r}),!!r}var gGe=pGe,xGe=DZ,vGe=Ic,yGe=gGe,bGe=eo,wGe=$j;function _Ge(e,t,r){var s=bGe(e)?xGe:yGe;return r&&wGe(e,t,r)&&(t=void 0),s(e,vGe(t))}var jGe=_Ge;const NGe=On(jGe);var vc=function(t,r){var s=t.alwaysShow,a=t.ifOverflow;return s&&(a="extendDomain"),a===r},$L=sQ;function SGe(e,t,r){t=="__proto__"&&$L?$L(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var CGe=SGe,EGe=CGe,kGe=rQ,AGe=Ic;function TGe(e,t){var r={};return t=AGe(t),kGe(e,function(s,a,i){EGe(r,a,t(s,a,i))}),r}var PGe=TGe;const OGe=On(PGe);function RGe(e,t){for(var r=-1,s=e==null?0:e.length;++r<s;)if(!t(e[r],r,e))return!1;return!0}var MGe=RGe,IGe=HA;function DGe(e,t){var r=!0;return IGe(e,function(s,a,i){return r=!!t(s,a,i),r}),r}var LGe=DGe,BGe=MGe,$Ge=LGe,FGe=Ic,zGe=eo,UGe=$j;function VGe(e,t,r){var s=zGe(e)?BGe:$Ge;return r&&UGe(e,t,r)&&(t=void 0),s(e,FGe(t))}var qGe=VGe;const XJ=On(qGe);var WGe=["x","y"];function Qv(e){"@babel/helpers - typeof";return Qv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qv(e)}function TE(){return TE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},TE.apply(this,arguments)}function FL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function B0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FL(Object(r),!0).forEach(function(s){HGe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function HGe(e,t,r){return t=GGe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GGe(e){var t=KGe(e,"string");return Qv(t)=="symbol"?t:t+""}function KGe(e,t){if(Qv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Qv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XGe(e,t){if(e==null)return{};var r=YGe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function YGe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function ZGe(e,t){var r=e.x,s=e.y,a=XGe(e,WGe),i="".concat(r),o=parseInt(i,10),c="".concat(s),d=parseInt(c,10),l="".concat(t.height||a.height),u=parseInt(l,10),h="".concat(t.width||a.width),f=parseInt(h,10);return B0(B0(B0(B0(B0({},t),a),o?{x:o}:{}),d?{y:d}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function zL(e){return we.createElement(UJ,TE({shapeType:"rectangle",propTransformer:ZGe,activeClassName:"recharts-active-bar"},e))}var QGe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(s,a){if(typeof t=="number")return t;var i=Lt(s)||j8e(s);return i?t(s,a):(i||Nf(),r)}},JGe=["value","background"],YJ;function Zp(e){"@babel/helpers - typeof";return Zp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zp(e)}function eKe(e,t){if(e==null)return{};var r=tKe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function tKe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function V2(){return V2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},V2.apply(this,arguments)}function UL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Ks(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UL(Object(r),!0).forEach(function(s){uu(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function rKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VL(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,QJ(s.key),s)}}function nKe(e,t,r){return t&&VL(e.prototype,t),r&&VL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sKe(e,t,r){return t=q2(t),aKe(e,ZJ()?Reflect.construct(t,r||[],q2(e).constructor):t.apply(e,r))}function aKe(e,t){if(t&&(Zp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return iKe(e)}function iKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ZJ(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ZJ=function(){return!!e})()}function q2(e){return q2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},q2(e)}function oKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&PE(e,t)}function PE(e,t){return PE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},PE(e,t)}function uu(e,t,r){return t=QJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QJ(e){var t=lKe(e,"string");return Zp(t)=="symbol"?t:t+""}function lKe(e,t){if(Zp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Zp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Y1=function(e){function t(){var r;rKe(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return r=sKe(this,t,[].concat(a)),uu(r,"state",{isAnimationFinished:!1}),uu(r,"id",Wg("recharts-bar-")),uu(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),o&&o()}),uu(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),o&&o()}),r}return oKe(t,e),nKe(t,[{key:"renderRectanglesStatically",value:function(s){var a=this,i=this.props,o=i.shape,c=i.dataKey,d=i.activeIndex,l=i.activeBar,u=Sr(this.props,!1);return s&&s.map(function(h,f){var m=f===d,p=m?l:o,g=Ks(Ks(Ks({},u),h),{},{isActive:m,option:p,index:f,dataKey:c,onAnimationStart:a.handleAnimationStart,onAnimationEnd:a.handleAnimationEnd});return we.createElement(bn,V2({className:"recharts-bar-rectangle"},wf(a.props,h,f),{key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(f)}),we.createElement(zL,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var s=this,a=this.props,i=a.data,o=a.layout,c=a.isAnimationActive,d=a.animationBegin,l=a.animationDuration,u=a.animationEasing,h=a.animationId,f=this.state.prevData;return we.createElement(Nc,{begin:d,duration:l,isActive:c,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var p=m.t,g=i.map(function(v,x){var y=f&&f[x];if(y){var b=$i(y.x,v.x),j=$i(y.y,v.y),T=$i(y.width,v.width),O=$i(y.height,v.height);return Ks(Ks({},v),{},{x:b(p),y:j(p),width:T(p),height:O(p)})}if(o==="horizontal"){var R=$i(0,v.height),D=R(p);return Ks(Ks({},v),{},{y:v.y+v.height-D,height:D})}var L=$i(0,v.width),q=L(p);return Ks(Ks({},v),{},{width:q})});return we.createElement(bn,null,s.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var s=this.props,a=s.data,i=s.isAnimationActive,o=this.state.prevData;return i&&a&&a.length&&(!o||!Vp(o,a))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(a)}},{key:"renderBackground",value:function(){var s=this,a=this.props,i=a.data,o=a.dataKey,c=a.activeIndex,d=Sr(this.props.background,!1);return i.map(function(l,u){l.value;var h=l.background,f=eKe(l,JGe);if(!h)return null;var m=Ks(Ks(Ks(Ks(Ks({},f),{},{fill:"#eee"},h),d),wf(s.props,l,u)),{},{onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd,dataKey:o,index:u,className:"recharts-bar-background-rectangle"});return we.createElement(zL,V2({key:"background-bar-".concat(u),option:s.props.background,isActive:u===c},m))})}},{key:"renderErrorBar",value:function(s,a){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,c=i.xAxis,d=i.yAxis,l=i.layout,u=i.children,h=Go(u,Yj);if(!h)return null;var f=l==="vertical"?o[0].height/2:o[0].width/2,m=function(v,x){var y=Array.isArray(v.value)?v.value[1]:v.value;return{x:v.x,y:v.y,value:y,errorVal:ua(v,x)}},p={clipPath:s?"url(#clipPath-".concat(a,")"):null};return we.createElement(bn,p,h.map(function(g){return we.cloneElement(g,{key:"error-bar-".concat(a,"-").concat(g.props.dataKey),data:o,xAxis:c,yAxis:d,layout:l,offset:f,dataPointFormatter:m})}))}},{key:"render",value:function(){var s=this.props,a=s.hide,i=s.data,o=s.className,c=s.xAxis,d=s.yAxis,l=s.left,u=s.top,h=s.width,f=s.height,m=s.isAnimationActive,p=s.background,g=s.id;if(a||!i||!i.length)return null;var v=this.state.isAnimationFinished,x=Xr("recharts-bar",o),y=c&&c.allowDataOverflow,b=d&&d.allowDataOverflow,j=y||b,T=Yr(g)?this.id:g;return we.createElement(bn,{className:x},y||b?we.createElement("defs",null,we.createElement("clipPath",{id:"clipPath-".concat(T)},we.createElement("rect",{x:y?l:l-h/2,y:b?u:u-f/2,width:y?h:h*2,height:b?f:f*2}))):null,we.createElement(bn,{className:"recharts-bar-rectangles",clipPath:j?"url(#clipPath-".concat(T,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(j,T),(!m||v)&&sd.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(s,a){return s.animationId!==a.prevAnimationId?{prevAnimationId:s.animationId,curData:s.data,prevData:a.curData}:s.data!==a.curData?{curData:s.data}:null}}])}(P.PureComponent);YJ=Y1;uu(Y1,"displayName","Bar");uu(Y1,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!gc.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});uu(Y1,"getComposedData",function(e){var t=e.props,r=e.item,s=e.barPosition,a=e.bandSize,i=e.xAxis,o=e.yAxis,c=e.xAxisTicks,d=e.yAxisTicks,l=e.stackedData,u=e.dataStartIndex,h=e.displayedData,f=e.offset,m=Uze(s,r);if(!m)return null;var p=t.layout,g=r.type.defaultProps,v=g!==void 0?Ks(Ks({},g),r.props):r.props,x=v.dataKey,y=v.children,b=v.minPointSize,j=p==="horizontal"?o:i,T=l?j.scale.domain():null,O=Xze({numericAxis:j}),R=Go(y,W1),D=h.map(function(L,q){var X,H,M,F,S,E;l?X=Vze(l[u+q],T):(X=ua(L,x),Array.isArray(X)||(X=[O,X]));var N=QGe(b,YJ.defaultProps.minPointSize)(X[1],q);if(p==="horizontal"){var C,k=[o.scale(X[0]),o.scale(X[1])],I=k[0],U=k[1];H=OD({axis:i,ticks:c,bandSize:a,offset:m.offset,entry:L,index:q}),M=(C=U??I)!==null&&C!==void 0?C:void 0,F=m.size;var $=I-U;if(S=Number.isNaN($)?0:$,E={x:H,y:o.y,width:F,height:o.height},Math.abs(N)>0&&Math.abs(S)<Math.abs(N)){var Y=ji(S||N)*(Math.abs(N)-Math.abs(S));M-=Y,S+=Y}}else{var Z=[i.scale(X[0]),i.scale(X[1])],re=Z[0],G=Z[1];if(H=re,M=OD({axis:o,ticks:d,bandSize:a,offset:m.offset,entry:L,index:q}),F=G-re,S=m.size,E={x:i.x,y:M,width:i.width,height:S},Math.abs(N)>0&&Math.abs(F)<Math.abs(N)){var J=ji(F||N)*(Math.abs(N)-Math.abs(F));F+=J}}return Ks(Ks(Ks({},L),{},{x:H,y:M,width:F,height:S,value:l?X:X[1],payload:L,background:E},R&&R[q]&&R[q].props),{},{tooltipPayload:[bJ(r,L)],tooltipPosition:{x:H+F/2,y:M+S/2}})});return Ks({data:D,layout:p},f)});function Jv(e){"@babel/helpers - typeof";return Jv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jv(e)}function cKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qL(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,JJ(s.key),s)}}function dKe(e,t,r){return t&&qL(e.prototype,t),r&&qL(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function WL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function _l(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?WL(Object(r),!0).forEach(function(s){sN(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):WL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function sN(e,t,r){return t=JJ(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JJ(e){var t=uKe(e,"string");return Jv(t)=="symbol"?t:t+""}function uKe(e,t){if(Jv(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Jv(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hKe=function(t,r,s,a,i){var o=t.width,c=t.height,d=t.layout,l=t.children,u=Object.keys(r),h={left:s.left,leftMirror:s.left,right:o-s.right,rightMirror:o-s.right,top:s.top,topMirror:s.top,bottom:c-s.bottom,bottomMirror:c-s.bottom},f=!!lo(l,Y1);return u.reduce(function(m,p){var g=r[p],v=g.orientation,x=g.domain,y=g.padding,b=y===void 0?{}:y,j=g.mirror,T=g.reversed,O="".concat(v).concat(j?"Mirror":""),R,D,L,q,X;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var H=x[1]-x[0],M=1/0,F=g.categoricalDomain.sort(C8e);if(F.forEach(function(Z,re){re>0&&(M=Math.min((Z||0)-(F[re-1]||0),M))}),Number.isFinite(M)){var S=M/H,E=g.layout==="vertical"?s.height:s.width;if(g.padding==="gap"&&(R=S*E/2),g.padding==="no-gap"){var N=Ni(t.barCategoryGap,S*E),C=S*E/2;R=C-N-(C-N)/E*N}}}a==="xAxis"?D=[s.left+(b.left||0)+(R||0),s.left+s.width-(b.right||0)-(R||0)]:a==="yAxis"?D=d==="horizontal"?[s.top+s.height-(b.bottom||0),s.top+(b.top||0)]:[s.top+(b.top||0)+(R||0),s.top+s.height-(b.bottom||0)-(R||0)]:D=g.range,T&&(D=[D[1],D[0]]);var k=gJ(g,i,f),I=k.scale,U=k.realScaleType;I.domain(x).range(D),xJ(I);var $=vJ(I,_l(_l({},g),{},{realScaleType:U}));a==="xAxis"?(X=v==="top"&&!j||v==="bottom"&&j,L=s.left,q=h[O]-X*g.height):a==="yAxis"&&(X=v==="left"&&!j||v==="right"&&j,L=h[O]-X*g.width,q=s.top);var Y=_l(_l(_l({},g),$),{},{realScaleType:U,x:L,y:q,scale:I,width:a==="xAxis"?s.width:g.width,height:a==="yAxis"?s.height:g.height});return Y.bandSize=k2(Y,$),!g.hide&&a==="xAxis"?h[O]+=(X?-1:1)*Y.height:g.hide||(h[O]+=(X?-1:1)*Y.width),_l(_l({},m),{},sN({},p,Y))},{})},eee=function(t,r){var s=t.x,a=t.y,i=r.x,o=r.y;return{x:Math.min(s,i),y:Math.min(a,o),width:Math.abs(i-s),height:Math.abs(o-a)}},fKe=function(t){var r=t.x1,s=t.y1,a=t.x2,i=t.y2;return eee({x:r,y:s},{x:a,y:i})},tee=function(){function e(t){cKe(this,e),this.scale=t}return dKe(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(r){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=s.bandAware,i=s.position;if(r!==void 0){if(i)switch(i){case"start":return this.scale(r);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+o}case"end":{var c=this.bandwidth?this.bandwidth():0;return this.scale(r)+c}default:return this.scale(r)}if(a){var d=this.bandwidth?this.bandwidth()/2:0;return this.scale(r)+d}return this.scale(r)}}},{key:"isInRange",value:function(r){var s=this.range(),a=s[0],i=s[s.length-1];return a<=i?r>=a&&r<=i:r>=i&&r<=a}}],[{key:"create",value:function(r){return new e(r)}}])}();sN(tee,"EPS",1e-4);var _T=function(t){var r=Object.keys(t).reduce(function(s,a){return _l(_l({},s),{},sN({},a,tee.create(t[a])))},{});return _l(_l({},r),{},{apply:function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,c=i.position;return OGe(a,function(d,l){return r[l].apply(d,{bandAware:o,position:c})})},isInRange:function(a){return XJ(a,function(i,o){return r[o].isInRange(i)})}})};function mKe(e){return(e%180+180)%180}var pKe=function(t){var r=t.width,s=t.height,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=mKe(a),o=i*Math.PI/180,c=Math.atan(s/r),d=o>c&&o<Math.PI-c?s/Math.sin(o):r/Math.cos(o);return Math.abs(d)},gKe=Ic,xKe=q1,vKe=Lj;function yKe(e){return function(t,r,s){var a=Object(t);if(!xKe(t)){var i=gKe(r);t=vKe(t),r=function(c){return i(a[c],c,a)}}var o=e(t,r,s);return o>-1?a[i?t[o]:o]:void 0}}var bKe=yKe,wKe=WJ;function _Ke(e){var t=wKe(e),r=t%1;return t===t?r?t-r:t:0}var jKe=_Ke,NKe=YZ,SKe=Ic,CKe=jKe,EKe=Math.max;function kKe(e,t,r){var s=e==null?0:e.length;if(!s)return-1;var a=r==null?0:CKe(r);return a<0&&(a=EKe(s+a,0)),NKe(e,SKe(t),a)}var AKe=kKe,TKe=bKe,PKe=AKe,OKe=TKe(PKe),RKe=OKe;const MKe=On(RKe);var IKe=Eke(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),jT=P.createContext(void 0),NT=P.createContext(void 0),ree=P.createContext(void 0),nee=P.createContext({}),see=P.createContext(void 0),aee=P.createContext(0),iee=P.createContext(0),HL=function(t){var r=t.state,s=r.xAxisMap,a=r.yAxisMap,i=r.offset,o=t.clipPathId,c=t.children,d=t.width,l=t.height,u=IKe(i);return we.createElement(jT.Provider,{value:s},we.createElement(NT.Provider,{value:a},we.createElement(nee.Provider,{value:i},we.createElement(ree.Provider,{value:u},we.createElement(see.Provider,{value:o},we.createElement(aee.Provider,{value:l},we.createElement(iee.Provider,{value:d},c)))))))},DKe=function(){return P.useContext(see)},oee=function(t){var r=P.useContext(jT);r==null&&Nf();var s=r[t];return s==null&&Nf(),s},LKe=function(){var t=P.useContext(jT);return Zd(t)},BKe=function(){var t=P.useContext(NT),r=MKe(t,function(s){return XJ(s.domain,Number.isFinite)});return r||Zd(t)},lee=function(t){var r=P.useContext(NT);r==null&&Nf();var s=r[t];return s==null&&Nf(),s},$Ke=function(){var t=P.useContext(ree);return t},FKe=function(){return P.useContext(nee)},ST=function(){return P.useContext(iee)},CT=function(){return P.useContext(aee)};function Qp(e){"@babel/helpers - typeof";return Qp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qp(e)}function zKe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function UKe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,dee(s.key),s)}}function VKe(e,t,r){return t&&UKe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qKe(e,t,r){return t=W2(t),WKe(e,cee()?Reflect.construct(t,r||[],W2(e).constructor):t.apply(e,r))}function WKe(e,t){if(t&&(Qp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return HKe(e)}function HKe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cee=function(){return!!e})()}function W2(e){return W2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},W2(e)}function GKe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&OE(e,t)}function OE(e,t){return OE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},OE(e,t)}function GL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function KL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GL(Object(r),!0).forEach(function(s){ET(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function ET(e,t,r){return t=dee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dee(e){var t=KKe(e,"string");return Qp(t)=="symbol"?t:t+""}function KKe(e,t){if(Qp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Qp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XKe(e,t){return JKe(e)||QKe(e,t)||ZKe(e,t)||YKe()}function YKe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZKe(e,t){if(e){if(typeof e=="string")return XL(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return XL(e,t)}}function XL(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function QKe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function JKe(e){if(Array.isArray(e))return e}function RE(){return RE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},RE.apply(this,arguments)}var eXe=function(t,r){var s;return we.isValidElement(t)?s=we.cloneElement(t,r):Lr(t)?s=t(r):s=we.createElement("line",RE({},r,{className:"recharts-reference-line-line"})),s},tXe=function(t,r,s,a,i,o,c,d,l){var u=i.x,h=i.y,f=i.width,m=i.height;if(s){var p=l.y,g=t.y.apply(p,{position:o});if(vc(l,"discard")&&!t.y.isInRange(g))return null;var v=[{x:u+f,y:g},{x:u,y:g}];return d==="left"?v.reverse():v}if(r){var x=l.x,y=t.x.apply(x,{position:o});if(vc(l,"discard")&&!t.x.isInRange(y))return null;var b=[{x:y,y:h+m},{x:y,y:h}];return c==="top"?b.reverse():b}if(a){var j=l.segment,T=j.map(function(O){return t.apply(O,{position:o})});return vc(l,"discard")&&NGe(T,function(O){return!t.isInRange(O)})?null:T}return null};function rXe(e){var t=e.x,r=e.y,s=e.segment,a=e.xAxisId,i=e.yAxisId,o=e.shape,c=e.className,d=e.alwaysShow,l=DKe(),u=oee(a),h=lee(i),f=$Ke();if(!l||!f)return null;Al(d===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=_T({x:u.scale,y:h.scale}),p=fa(t),g=fa(r),v=s&&s.length===2,x=tXe(m,p,g,v,f,e.position,u.orientation,h.orientation,e);if(!x)return null;var y=XKe(x,2),b=y[0],j=b.x,T=b.y,O=y[1],R=O.x,D=O.y,L=vc(e,"hidden")?"url(#".concat(l,")"):void 0,q=KL(KL({clipPath:L},Sr(e,!0)),{},{x1:j,y1:T,x2:R,y2:D});return we.createElement(bn,{className:Xr("recharts-reference-line",c)},eXe(o,q),Pa.renderCallByParent(e,fKe({x1:j,y1:T,x2:R,y2:D})))}var kT=function(e){function t(){return zKe(this,t),qKe(this,t,arguments)}return GKe(t,e),VKe(t,[{key:"render",value:function(){return we.createElement(rXe,this.props)}}])}(we.Component);ET(kT,"displayName","ReferenceLine");ET(kT,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function ME(){return ME=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ME.apply(this,arguments)}function Jp(e){"@babel/helpers - typeof";return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jp(e)}function YL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function ZL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YL(Object(r),!0).forEach(function(s){aN(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function nXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sXe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,hee(s.key),s)}}function aXe(e,t,r){return t&&sXe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function iXe(e,t,r){return t=H2(t),oXe(e,uee()?Reflect.construct(t,r||[],H2(e).constructor):t.apply(e,r))}function oXe(e,t){if(t&&(Jp(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lXe(e)}function lXe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function uee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(uee=function(){return!!e})()}function H2(e){return H2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},H2(e)}function cXe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&IE(e,t)}function IE(e,t){return IE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},IE(e,t)}function aN(e,t,r){return t=hee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hee(e){var t=dXe(e,"string");return Jp(t)=="symbol"?t:t+""}function dXe(e,t){if(Jp(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Jp(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uXe=function(t){var r=t.x,s=t.y,a=t.xAxis,i=t.yAxis,o=_T({x:a.scale,y:i.scale}),c=o.apply({x:r,y:s},{bandAware:!0});return vc(t,"discard")&&!o.isInRange(c)?null:c},iN=function(e){function t(){return nXe(this,t),iXe(this,t,arguments)}return cXe(t,e),aXe(t,[{key:"render",value:function(){var s=this.props,a=s.x,i=s.y,o=s.r,c=s.alwaysShow,d=s.clipPathId,l=fa(a),u=fa(i);if(Al(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!l||!u)return null;var h=uXe(this.props);if(!h)return null;var f=h.x,m=h.y,p=this.props,g=p.shape,v=p.className,x=vc(this.props,"hidden")?"url(#".concat(d,")"):void 0,y=ZL(ZL({clipPath:x},Sr(this.props,!0)),{},{cx:f,cy:m});return we.createElement(bn,{className:Xr("recharts-reference-dot",v)},t.renderDot(g,y),Pa.renderCallByParent(this.props,{x:f-o,y:m-o,width:2*o,height:2*o}))}}])}(we.Component);aN(iN,"displayName","ReferenceDot");aN(iN,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});aN(iN,"renderDot",function(e,t){var r;return we.isValidElement(e)?r=we.cloneElement(e,t):Lr(e)?r=e(t):r=we.createElement(Zj,ME({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),r});function DE(){return DE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},DE.apply(this,arguments)}function eg(e){"@babel/helpers - typeof";return eg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eg(e)}function QL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function JL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QL(Object(r),!0).forEach(function(s){oN(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QL(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function hXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fXe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,mee(s.key),s)}}function mXe(e,t,r){return t&&fXe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function pXe(e,t,r){return t=G2(t),gXe(e,fee()?Reflect.construct(t,r||[],G2(e).constructor):t.apply(e,r))}function gXe(e,t){if(t&&(eg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xXe(e)}function xXe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function fee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fee=function(){return!!e})()}function G2(e){return G2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},G2(e)}function vXe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&LE(e,t)}function LE(e,t){return LE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},LE(e,t)}function oN(e,t,r){return t=mee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mee(e){var t=yXe(e,"string");return eg(t)=="symbol"?t:t+""}function yXe(e,t){if(eg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(eg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bXe=function(t,r,s,a,i){var o=i.x1,c=i.x2,d=i.y1,l=i.y2,u=i.xAxis,h=i.yAxis;if(!u||!h)return null;var f=_T({x:u.scale,y:h.scale}),m={x:t?f.x.apply(o,{position:"start"}):f.x.rangeMin,y:s?f.y.apply(d,{position:"start"}):f.y.rangeMin},p={x:r?f.x.apply(c,{position:"end"}):f.x.rangeMax,y:a?f.y.apply(l,{position:"end"}):f.y.rangeMax};return vc(i,"discard")&&(!f.isInRange(m)||!f.isInRange(p))?null:eee(m,p)},lN=function(e){function t(){return hXe(this,t),pXe(this,t,arguments)}return vXe(t,e),mXe(t,[{key:"render",value:function(){var s=this.props,a=s.x1,i=s.x2,o=s.y1,c=s.y2,d=s.className,l=s.alwaysShow,u=s.clipPathId;Al(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=fa(a),f=fa(i),m=fa(o),p=fa(c),g=this.props.shape;if(!h&&!f&&!m&&!p&&!g)return null;var v=bXe(h,f,m,p,this.props);if(!v&&!g)return null;var x=vc(this.props,"hidden")?"url(#".concat(u,")"):void 0;return we.createElement(bn,{className:Xr("recharts-reference-area",d)},t.renderRect(g,JL(JL({clipPath:x},Sr(this.props,!0)),v)),Pa.renderCallByParent(this.props,v))}}])}(we.Component);oN(lN,"displayName","ReferenceArea");oN(lN,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});oN(lN,"renderRect",function(e,t){var r;return we.isValidElement(e)?r=we.cloneElement(e,t):Lr(e)?r=e(t):r=we.createElement(wT,DE({},t,{className:"recharts-reference-area-rect"})),r});function pee(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var s=[],a=0;a<e.length;a+=t)s.push(e[a]);return s}function wXe(e,t,r){var s={width:e.width+t.width,height:e.height+t.height};return pKe(s,r)}function _Xe(e,t,r){var s=r==="width",a=e.x,i=e.y,o=e.width,c=e.height;return t===1?{start:s?a:i,end:s?a+o:i+c}:{start:s?a+o:i+c,end:s?a:i}}function K2(e,t,r,s,a){if(e*t<e*s||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-s)>=0&&e*(t+e*i/2-a)<=0}function jXe(e,t){return pee(e,t+1)}function NXe(e,t,r,s,a){for(var i=(s||[]).slice(),o=t.start,c=t.end,d=0,l=1,u=o,h=function(){var p=s==null?void 0:s[d];if(p===void 0)return{v:pee(s,l)};var g=d,v,x=function(){return v===void 0&&(v=r(p,g)),v},y=p.coordinate,b=d===0||K2(e,y,x,u,c);b||(d=0,u=o,l+=1),b&&(u=y+e*(x()/2+a),d+=l)},f;l<=i.length;)if(f=h(),f)return f.v;return[]}function e1(e){"@babel/helpers - typeof";return e1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e1(e)}function eB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function ai(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eB(Object(r),!0).forEach(function(s){SXe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eB(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function SXe(e,t,r){return t=CXe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CXe(e){var t=EXe(e,"string");return e1(t)=="symbol"?t:t+""}function EXe(e,t){if(e1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(e1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kXe(e,t,r,s,a){for(var i=(s||[]).slice(),o=i.length,c=t.start,d=t.end,l=function(f){var m=i[f],p,g=function(){return p===void 0&&(p=r(m,f)),p};if(f===o-1){var v=e*(m.coordinate+e*g()/2-d);i[f]=m=ai(ai({},m),{},{tickCoord:v>0?m.coordinate-v*e:m.coordinate})}else i[f]=m=ai(ai({},m),{},{tickCoord:m.coordinate});var x=K2(e,m.tickCoord,g,c,d);x&&(d=m.tickCoord-e*(g()/2+a),i[f]=ai(ai({},m),{},{isShow:!0}))},u=o-1;u>=0;u--)l(u);return i}function AXe(e,t,r,s,a,i){var o=(s||[]).slice(),c=o.length,d=t.start,l=t.end;if(i){var u=s[c-1],h=r(u,c-1),f=e*(u.coordinate+e*h/2-l);o[c-1]=u=ai(ai({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate});var m=K2(e,u.tickCoord,function(){return h},d,l);m&&(l=u.tickCoord-e*(h/2+a),o[c-1]=ai(ai({},u),{},{isShow:!0}))}for(var p=i?c-1:c,g=function(y){var b=o[y],j,T=function(){return j===void 0&&(j=r(b,y)),j};if(y===0){var O=e*(b.coordinate-e*T()/2-d);o[y]=b=ai(ai({},b),{},{tickCoord:O<0?b.coordinate-O*e:b.coordinate})}else o[y]=b=ai(ai({},b),{},{tickCoord:b.coordinate});var R=K2(e,b.tickCoord,T,d,l);R&&(d=b.tickCoord+e*(T()/2+a),o[y]=ai(ai({},b),{},{isShow:!0}))},v=0;v<p;v++)g(v);return o}function AT(e,t,r){var s=e.tick,a=e.ticks,i=e.viewBox,o=e.minTickGap,c=e.orientation,d=e.interval,l=e.tickFormatter,u=e.unit,h=e.angle;if(!a||!a.length||!s)return[];if(Lt(d)||gc.isSsr)return jXe(a,typeof d=="number"&&Lt(d)?d:0);var f=[],m=c==="top"||c==="bottom"?"width":"height",p=u&&m==="width"?vx(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=function(b,j){var T=Lr(l)?l(b.value,j):b.value;return m==="width"?wXe(vx(T,{fontSize:t,letterSpacing:r}),p,h):vx(T,{fontSize:t,letterSpacing:r})[m]},v=a.length>=2?ji(a[1].coordinate-a[0].coordinate):1,x=_Xe(i,v,m);return d==="equidistantPreserveStart"?NXe(v,x,g,a,o):(d==="preserveStart"||d==="preserveStartEnd"?f=AXe(v,x,g,a,o,d==="preserveStartEnd"):f=kXe(v,x,g,a,o),f.filter(function(y){return y.isShow}))}var TXe=["viewBox"],PXe=["viewBox"],OXe=["ticks"];function tg(e){"@babel/helpers - typeof";return tg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tg(e)}function Dm(){return Dm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Dm.apply(this,arguments)}function tB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function sa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tB(Object(r),!0).forEach(function(s){TT(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tB(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function U4(e,t){if(e==null)return{};var r=RXe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function RXe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function MXe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rB(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,xee(s.key),s)}}function IXe(e,t,r){return t&&rB(e.prototype,t),r&&rB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function DXe(e,t,r){return t=X2(t),LXe(e,gee()?Reflect.construct(t,r||[],X2(e).constructor):t.apply(e,r))}function LXe(e,t){if(t&&(tg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BXe(e)}function BXe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(gee=function(){return!!e})()}function X2(e){return X2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},X2(e)}function $Xe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&BE(e,t)}function BE(e,t){return BE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},BE(e,t)}function TT(e,t,r){return t=xee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xee(e){var t=FXe(e,"string");return tg(t)=="symbol"?t:t+""}function FXe(e,t){if(tg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(tg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qg=function(e){function t(r){var s;return MXe(this,t),s=DXe(this,t,[r]),s.state={fontSize:"",letterSpacing:""},s}return $Xe(t,e),IXe(t,[{key:"shouldComponentUpdate",value:function(s,a){var i=s.viewBox,o=U4(s,TXe),c=this.props,d=c.viewBox,l=U4(c,PXe);return!Jm(i,d)||!Jm(o,l)||!Jm(a,this.state)}},{key:"componentDidMount",value:function(){var s=this.layerReference;if(s){var a=s.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];a&&this.setState({fontSize:window.getComputedStyle(a).fontSize,letterSpacing:window.getComputedStyle(a).letterSpacing})}}},{key:"getTickLineCoord",value:function(s){var a=this.props,i=a.x,o=a.y,c=a.width,d=a.height,l=a.orientation,u=a.tickSize,h=a.mirror,f=a.tickMargin,m,p,g,v,x,y,b=h?-1:1,j=s.tickSize||u,T=Lt(s.tickCoord)?s.tickCoord:s.coordinate;switch(l){case"top":m=p=s.coordinate,v=o+ +!h*d,g=v-b*j,y=g-b*f,x=T;break;case"left":g=v=s.coordinate,p=i+ +!h*c,m=p-b*j,x=m-b*f,y=T;break;case"right":g=v=s.coordinate,p=i+ +h*c,m=p+b*j,x=m+b*f,y=T;break;default:m=p=s.coordinate,v=o+ +h*d,g=v+b*j,y=g+b*f,x=T;break}return{line:{x1:m,y1:g,x2:p,y2:v},tick:{x,y}}}},{key:"getTickTextAnchor",value:function(){var s=this.props,a=s.orientation,i=s.mirror,o;switch(a){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var s=this.props,a=s.orientation,i=s.mirror,o="end";switch(a){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var s=this.props,a=s.x,i=s.y,o=s.width,c=s.height,d=s.orientation,l=s.mirror,u=s.axisLine,h=sa(sa(sa({},Sr(this.props,!1)),Sr(u,!1)),{},{fill:"none"});if(d==="top"||d==="bottom"){var f=+(d==="top"&&!l||d==="bottom"&&l);h=sa(sa({},h),{},{x1:a,y1:i+f*c,x2:a+o,y2:i+f*c})}else{var m=+(d==="left"&&!l||d==="right"&&l);h=sa(sa({},h),{},{x1:a+m*o,y1:i,x2:a+m*o,y2:i+c})}return we.createElement("line",Dm({},h,{className:Xr("recharts-cartesian-axis-line",bo(u,"className"))}))}},{key:"renderTicks",value:function(s,a,i){var o=this,c=this.props,d=c.tickLine,l=c.stroke,u=c.tick,h=c.tickFormatter,f=c.unit,m=AT(sa(sa({},this.props),{},{ticks:s}),a,i),p=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),v=Sr(this.props,!1),x=Sr(u,!1),y=sa(sa({},v),{},{fill:"none"},Sr(d,!1)),b=m.map(function(j,T){var O=o.getTickLineCoord(j),R=O.line,D=O.tick,L=sa(sa(sa(sa({textAnchor:p,verticalAnchor:g},v),{},{stroke:"none",fill:l},x),D),{},{index:T,payload:j,visibleTicksCount:m.length,tickFormatter:h});return we.createElement(bn,Dm({className:"recharts-cartesian-axis-tick",key:"tick-".concat(j.value,"-").concat(j.coordinate,"-").concat(j.tickCoord)},wf(o.props,j,T)),d&&we.createElement("line",Dm({},y,R,{className:Xr("recharts-cartesian-axis-tick-line",bo(d,"className"))})),u&&t.renderTickItem(u,L,"".concat(Lr(h)?h(j.value,T):j.value).concat(f||"")))});return we.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var s=this,a=this.props,i=a.axisLine,o=a.width,c=a.height,d=a.ticksGenerator,l=a.className,u=a.hide;if(u)return null;var h=this.props,f=h.ticks,m=U4(h,OXe),p=f;return Lr(d)&&(p=f&&f.length>0?d(this.props):d(m)),o<=0||c<=0||!p||!p.length?null:we.createElement(bn,{className:Xr("recharts-cartesian-axis",l),ref:function(v){s.layerReference=v}},i&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),Pa.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(s,a,i){var o,c=Xr(a.className,"recharts-cartesian-axis-tick-value");return we.isValidElement(s)?o=we.cloneElement(s,sa(sa({},a),{},{className:c})):Lr(s)?o=s(sa(sa({},a),{},{className:c})):o=we.createElement(_f,Dm({},a,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(P.Component);TT(Qg,"displayName","CartesianAxis");TT(Qg,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var zXe=["x1","y1","x2","y2","key"],UXe=["offset"];function Sf(e){"@babel/helpers - typeof";return Sf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sf(e)}function nB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function oi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nB(Object(r),!0).forEach(function(s){VXe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nB(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function VXe(e,t,r){return t=qXe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qXe(e){var t=WXe(e,"string");return Sf(t)=="symbol"?t:t+""}function WXe(e,t){if(Sf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(Sf(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dh(){return Dh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Dh.apply(this,arguments)}function sB(e,t){if(e==null)return{};var r=HXe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function HXe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}var GXe=function(t){var r=t.fill;if(!r||r==="none")return null;var s=t.fillOpacity,a=t.x,i=t.y,o=t.width,c=t.height,d=t.ry;return we.createElement("rect",{x:a,y:i,ry:d,width:o,height:c,stroke:"none",fill:r,fillOpacity:s,className:"recharts-cartesian-grid-bg"})};function vee(e,t){var r;if(we.isValidElement(e))r=we.cloneElement(e,t);else if(Lr(e))r=e(t);else{var s=t.x1,a=t.y1,i=t.x2,o=t.y2,c=t.key,d=sB(t,zXe),l=Sr(d,!1);l.offset;var u=sB(l,UXe);r=we.createElement("line",Dh({},u,{x1:s,y1:a,x2:i,y2:o,fill:"none",key:c}))}return r}function KXe(e){var t=e.x,r=e.width,s=e.horizontal,a=s===void 0?!0:s,i=e.horizontalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(c,d){var l=oi(oi({},e),{},{x1:t,y1:c,x2:t+r,y2:c,key:"line-".concat(d),index:d});return vee(a,l)});return we.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function XXe(e){var t=e.y,r=e.height,s=e.vertical,a=s===void 0?!0:s,i=e.verticalPoints;if(!a||!i||!i.length)return null;var o=i.map(function(c,d){var l=oi(oi({},e),{},{x1:c,y1:t,x2:c,y2:t+r,key:"line-".concat(d),index:d});return vee(a,l)});return we.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function YXe(e){var t=e.horizontalFill,r=e.fillOpacity,s=e.x,a=e.y,i=e.width,o=e.height,c=e.horizontalPoints,d=e.horizontal,l=d===void 0?!0:d;if(!l||!t||!t.length)return null;var u=c.map(function(f){return Math.round(f+a-a)}).sort(function(f,m){return f-m});a!==u[0]&&u.unshift(0);var h=u.map(function(f,m){var p=!u[m+1],g=p?a+o-f:u[m+1]-f;if(g<=0)return null;var v=m%t.length;return we.createElement("rect",{key:"react-".concat(m),y:f,x:s,height:g,width:i,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return we.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function ZXe(e){var t=e.vertical,r=t===void 0?!0:t,s=e.verticalFill,a=e.fillOpacity,i=e.x,o=e.y,c=e.width,d=e.height,l=e.verticalPoints;if(!r||!s||!s.length)return null;var u=l.map(function(f){return Math.round(f+i-i)}).sort(function(f,m){return f-m});i!==u[0]&&u.unshift(0);var h=u.map(function(f,m){var p=!u[m+1],g=p?i+c-f:u[m+1]-f;if(g<=0)return null;var v=m%s.length;return we.createElement("rect",{key:"react-".concat(m),x:f,y:o,width:g,height:d,stroke:"none",fill:s[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return we.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var QXe=function(t,r){var s=t.xAxis,a=t.width,i=t.height,o=t.offset;return pJ(AT(oi(oi(oi({},Qg.defaultProps),s),{},{ticks:Jc(s,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.left,o.left+o.width,r)},JXe=function(t,r){var s=t.yAxis,a=t.width,i=t.height,o=t.offset;return pJ(AT(oi(oi(oi({},Qg.defaultProps),s),{},{ticks:Jc(s,!0),viewBox:{x:0,y:0,width:a,height:i}})),o.top,o.top+o.height,r)},om={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function yee(e){var t,r,s,a,i,o,c=ST(),d=CT(),l=FKe(),u=oi(oi({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:om.stroke,fill:(r=e.fill)!==null&&r!==void 0?r:om.fill,horizontal:(s=e.horizontal)!==null&&s!==void 0?s:om.horizontal,horizontalFill:(a=e.horizontalFill)!==null&&a!==void 0?a:om.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:om.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:om.verticalFill,x:Lt(e.x)?e.x:l.left,y:Lt(e.y)?e.y:l.top,width:Lt(e.width)?e.width:l.width,height:Lt(e.height)?e.height:l.height}),h=u.x,f=u.y,m=u.width,p=u.height,g=u.syncWithTicks,v=u.horizontalValues,x=u.verticalValues,y=LKe(),b=BKe();if(!Lt(m)||m<=0||!Lt(p)||p<=0||!Lt(h)||h!==+h||!Lt(f)||f!==+f)return null;var j=u.verticalCoordinatesGenerator||QXe,T=u.horizontalCoordinatesGenerator||JXe,O=u.horizontalPoints,R=u.verticalPoints;if((!O||!O.length)&&Lr(T)){var D=v&&v.length,L=T({yAxis:b?oi(oi({},b),{},{ticks:D?v:b.ticks}):void 0,width:c,height:d,offset:l},D?!0:g);Al(Array.isArray(L),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Sf(L),"]")),Array.isArray(L)&&(O=L)}if((!R||!R.length)&&Lr(j)){var q=x&&x.length,X=j({xAxis:y?oi(oi({},y),{},{ticks:q?x:y.ticks}):void 0,width:c,height:d,offset:l},q?!0:g);Al(Array.isArray(X),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Sf(X),"]")),Array.isArray(X)&&(R=X)}return we.createElement("g",{className:"recharts-cartesian-grid"},we.createElement(GXe,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),we.createElement(KXe,Dh({},u,{offset:l,horizontalPoints:O,xAxis:y,yAxis:b})),we.createElement(XXe,Dh({},u,{offset:l,verticalPoints:R,xAxis:y,yAxis:b})),we.createElement(YXe,Dh({},u,{horizontalPoints:O})),we.createElement(ZXe,Dh({},u,{verticalPoints:R})))}yee.displayName="CartesianGrid";var eYe=["layout","type","stroke","connectNulls","isRange","ref"],tYe=["key"],bee;function rg(e){"@babel/helpers - typeof";return rg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rg(e)}function wee(e,t){if(e==null)return{};var r=rYe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function rYe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function Lh(){return Lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Lh.apply(this,arguments)}function aB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function Ud(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aB(Object(r),!0).forEach(function(s){oc(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aB(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function nYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function iB(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,jee(s.key),s)}}function sYe(e,t,r){return t&&iB(e.prototype,t),r&&iB(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function aYe(e,t,r){return t=Y2(t),iYe(e,_ee()?Reflect.construct(t,r||[],Y2(e).constructor):t.apply(e,r))}function iYe(e,t){if(t&&(rg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oYe(e)}function oYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _ee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_ee=function(){return!!e})()}function Y2(e){return Y2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Y2(e)}function lYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$E(e,t)}function $E(e,t){return $E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},$E(e,t)}function oc(e,t,r){return t=jee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jee(e){var t=cYe(e,"string");return rg(t)=="symbol"?t:t+""}function cYe(e,t){if(rg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(rg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yd=function(e){function t(){var r;nYe(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return r=aYe(this,t,[].concat(a)),oc(r,"state",{isAnimationFinished:!0}),oc(r,"id",Wg("recharts-area-")),oc(r,"handleAnimationEnd",function(){var o=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),Lr(o)&&o()}),oc(r,"handleAnimationStart",function(){var o=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),Lr(o)&&o()}),r}return lYe(t,e),sYe(t,[{key:"renderDots",value:function(s,a,i){var o=this.props.isAnimationActive,c=this.state.isAnimationFinished;if(o&&!c)return null;var d=this.props,l=d.dot,u=d.points,h=d.dataKey,f=Sr(this.props,!1),m=Sr(l,!0),p=u.map(function(v,x){var y=Ud(Ud(Ud({key:"dot-".concat(x),r:3},f),m),{},{index:x,cx:v.x,cy:v.y,dataKey:h,value:v.value,payload:v.payload,points:u});return t.renderDotItem(l,y)}),g={clipPath:s?"url(#clipPath-".concat(a?"":"dots-").concat(i,")"):null};return we.createElement(bn,Lh({className:"recharts-area-dots"},g),p)}},{key:"renderHorizontalRect",value:function(s){var a=this.props,i=a.baseLine,o=a.points,c=a.strokeWidth,d=o[0].x,l=o[o.length-1].x,u=s*Math.abs(d-l),h=du(o.map(function(f){return f.y||0}));return Lt(i)&&typeof i=="number"?h=Math.max(i,h):i&&Array.isArray(i)&&i.length&&(h=Math.max(du(i.map(function(f){return f.y||0})),h)),Lt(h)?we.createElement("rect",{x:d<l?d:d-u,y:0,width:u,height:Math.floor(h+(c?parseInt("".concat(c),10):1))}):null}},{key:"renderVerticalRect",value:function(s){var a=this.props,i=a.baseLine,o=a.points,c=a.strokeWidth,d=o[0].y,l=o[o.length-1].y,u=s*Math.abs(d-l),h=du(o.map(function(f){return f.x||0}));return Lt(i)&&typeof i=="number"?h=Math.max(i,h):i&&Array.isArray(i)&&i.length&&(h=Math.max(du(i.map(function(f){return f.x||0})),h)),Lt(h)?we.createElement("rect",{x:0,y:d<l?d:d-u,width:h+(c?parseInt("".concat(c),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(s){var a=this.props.layout;return a==="vertical"?this.renderVerticalRect(s):this.renderHorizontalRect(s)}},{key:"renderAreaStatically",value:function(s,a,i,o){var c=this.props,d=c.layout,l=c.type,u=c.stroke,h=c.connectNulls,f=c.isRange;c.ref;var m=wee(c,eYe);return we.createElement(bn,{clipPath:i?"url(#clipPath-".concat(o,")"):null},we.createElement(rp,Lh({},Sr(m,!0),{points:s,connectNulls:h,type:l,baseLine:a,layout:d,stroke:"none",className:"recharts-area-area"})),u!=="none"&&we.createElement(rp,Lh({},Sr(this.props,!1),{className:"recharts-area-curve",layout:d,type:l,connectNulls:h,fill:"none",points:s})),u!=="none"&&f&&we.createElement(rp,Lh({},Sr(this.props,!1),{className:"recharts-area-curve",layout:d,type:l,connectNulls:h,fill:"none",points:a})))}},{key:"renderAreaWithAnimation",value:function(s,a){var i=this,o=this.props,c=o.points,d=o.baseLine,l=o.isAnimationActive,u=o.animationBegin,h=o.animationDuration,f=o.animationEasing,m=o.animationId,p=this.state,g=p.prevPoints,v=p.prevBaseLine;return we.createElement(Nc,{begin:u,duration:h,isActive:l,easing:f,from:{t:0},to:{t:1},key:"area-".concat(m),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(x){var y=x.t;if(g){var b=g.length/c.length,j=c.map(function(D,L){var q=Math.floor(L*b);if(g[q]){var X=g[q],H=$i(X.x,D.x),M=$i(X.y,D.y);return Ud(Ud({},D),{},{x:H(y),y:M(y)})}return D}),T;if(Lt(d)&&typeof d=="number"){var O=$i(v,d);T=O(y)}else if(Yr(d)||qg(d)){var R=$i(v,0);T=R(y)}else T=d.map(function(D,L){var q=Math.floor(L*b);if(v[q]){var X=v[q],H=$i(X.x,D.x),M=$i(X.y,D.y);return Ud(Ud({},D),{},{x:H(y),y:M(y)})}return D});return i.renderAreaStatically(j,T,s,a)}return we.createElement(bn,null,we.createElement("defs",null,we.createElement("clipPath",{id:"animationClipPath-".concat(a)},i.renderClipRect(y))),we.createElement(bn,{clipPath:"url(#animationClipPath-".concat(a,")")},i.renderAreaStatically(c,d,s,a)))})}},{key:"renderArea",value:function(s,a){var i=this.props,o=i.points,c=i.baseLine,d=i.isAnimationActive,l=this.state,u=l.prevPoints,h=l.prevBaseLine,f=l.totalLength;return d&&o&&o.length&&(!u&&f>0||!Vp(u,o)||!Vp(h,c))?this.renderAreaWithAnimation(s,a):this.renderAreaStatically(o,c,s,a)}},{key:"render",value:function(){var s,a=this.props,i=a.hide,o=a.dot,c=a.points,d=a.className,l=a.top,u=a.left,h=a.xAxis,f=a.yAxis,m=a.width,p=a.height,g=a.isAnimationActive,v=a.id;if(i||!c||!c.length)return null;var x=this.state.isAnimationFinished,y=c.length===1,b=Xr("recharts-area",d),j=h&&h.allowDataOverflow,T=f&&f.allowDataOverflow,O=j||T,R=Yr(v)?this.id:v,D=(s=Sr(o,!1))!==null&&s!==void 0?s:{r:3,strokeWidth:2},L=D.r,q=L===void 0?3:L,X=D.strokeWidth,H=X===void 0?2:X,M=I8e(o)?o:{},F=M.clipDot,S=F===void 0?!0:F,E=q*2+H;return we.createElement(bn,{className:b},j||T?we.createElement("defs",null,we.createElement("clipPath",{id:"clipPath-".concat(R)},we.createElement("rect",{x:j?u:u-m/2,y:T?l:l-p/2,width:j?m:m*2,height:T?p:p*2})),!S&&we.createElement("clipPath",{id:"clipPath-dots-".concat(R)},we.createElement("rect",{x:u-E/2,y:l-E/2,width:m+E,height:p+E}))):null,y?null:this.renderArea(O,R),(o||y)&&this.renderDots(O,S,R),(!g||x)&&sd.renderCallByParent(this.props,c))}}],[{key:"getDerivedStateFromProps",value:function(s,a){return s.animationId!==a.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,curBaseLine:s.baseLine,prevPoints:a.curPoints,prevBaseLine:a.curBaseLine}:s.points!==a.curPoints||s.baseLine!==a.curBaseLine?{curPoints:s.points,curBaseLine:s.baseLine}:null}}])}(P.PureComponent);bee=yd;oc(yd,"displayName","Area");oc(yd,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!gc.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});oc(yd,"getBaseValue",function(e,t,r,s){var a=e.layout,i=e.baseValue,o=t.props.baseValue,c=o??i;if(Lt(c)&&typeof c=="number")return c;var d=a==="horizontal"?s:r,l=d.scale.domain();if(d.type==="number"){var u=Math.max(l[0],l[1]),h=Math.min(l[0],l[1]);return c==="dataMin"?h:c==="dataMax"||u<0?u:Math.max(Math.min(l[0],l[1]),0)}return c==="dataMin"?l[0]:c==="dataMax"?l[1]:l[0]});oc(yd,"getComposedData",function(e){var t=e.props,r=e.item,s=e.xAxis,a=e.yAxis,i=e.xAxisTicks,o=e.yAxisTicks,c=e.bandSize,d=e.dataKey,l=e.stackedData,u=e.dataStartIndex,h=e.displayedData,f=e.offset,m=t.layout,p=l&&l.length,g=bee.getBaseValue(t,r,s,a),v=m==="horizontal",x=!1,y=h.map(function(j,T){var O;p?O=l[u+T]:(O=ua(j,d),Array.isArray(O)?x=!0:O=[g,O]);var R=O[1]==null||p&&ua(j,d)==null;return v?{x:PD({axis:s,ticks:i,bandSize:c,entry:j,index:T}),y:R?null:a.scale(O[1]),value:O,payload:j}:{x:R?null:s.scale(O[1]),y:PD({axis:a,ticks:o,bandSize:c,entry:j,index:T}),value:O,payload:j}}),b;return p||x?b=y.map(function(j){var T=Array.isArray(j.value)?j.value[0]:null;return v?{x:j.x,y:T!=null&&j.y!=null?a.scale(T):null}:{x:T!=null?s.scale(T):null,y:j.y}}):b=v?a.scale(g):s.scale(g),Ud({points:y,baseLine:b,layout:m,isRange:x},f)});oc(yd,"renderDotItem",function(e,t){var r;if(we.isValidElement(e))r=we.cloneElement(e,t);else if(Lr(e))r=e(t);else{var s=Xr("recharts-area-dot",typeof e!="boolean"?e.className:""),a=t.key,i=wee(t,tYe);r=we.createElement(Zj,Lh({},i,{key:a,className:s}))}return r});function ng(e){"@babel/helpers - typeof";return ng=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ng(e)}function dYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uYe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Cee(s.key),s)}}function hYe(e,t,r){return t&&uYe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function fYe(e,t,r){return t=Z2(t),mYe(e,Nee()?Reflect.construct(t,r||[],Z2(e).constructor):t.apply(e,r))}function mYe(e,t){if(t&&(ng(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return pYe(e)}function pYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Nee=function(){return!!e})()}function Z2(e){return Z2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Z2(e)}function gYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&FE(e,t)}function FE(e,t){return FE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},FE(e,t)}function See(e,t,r){return t=Cee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cee(e){var t=xYe(e,"string");return ng(t)=="symbol"?t:t+""}function xYe(e,t){if(ng(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(ng(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zE(){return zE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},zE.apply(this,arguments)}function vYe(e){var t=e.xAxisId,r=ST(),s=CT(),a=oee(t);return a==null?null:P.createElement(Qg,zE({},a,{className:Xr("recharts-".concat(a.axisType," ").concat(a.axisType),a.className),viewBox:{x:0,y:0,width:r,height:s},ticksGenerator:function(o){return Jc(o,!0)}}))}var cN=function(e){function t(){return dYe(this,t),fYe(this,t,arguments)}return gYe(t,e),hYe(t,[{key:"render",value:function(){return P.createElement(vYe,this.props)}}])}(P.Component);See(cN,"displayName","XAxis");See(cN,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function sg(e){"@babel/helpers - typeof";return sg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sg(e)}function yYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bYe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Aee(s.key),s)}}function wYe(e,t,r){return t&&bYe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ye(e,t,r){return t=Q2(t),jYe(e,Eee()?Reflect.construct(t,r||[],Q2(e).constructor):t.apply(e,r))}function jYe(e,t){if(t&&(sg(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return NYe(e)}function NYe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Eee(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Eee=function(){return!!e})()}function Q2(e){return Q2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},Q2(e)}function SYe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&UE(e,t)}function UE(e,t){return UE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},UE(e,t)}function kee(e,t,r){return t=Aee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Aee(e){var t=CYe(e,"string");return sg(t)=="symbol"?t:t+""}function CYe(e,t){if(sg(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(sg(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VE(){return VE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},VE.apply(this,arguments)}var EYe=function(t){var r=t.yAxisId,s=ST(),a=CT(),i=lee(r);return i==null?null:P.createElement(Qg,VE({},i,{className:Xr("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:s,height:a},ticksGenerator:function(c){return Jc(c,!0)}}))},dN=function(e){function t(){return yYe(this,t),_Ye(this,t,arguments)}return SYe(t,e),wYe(t,[{key:"render",value:function(){return P.createElement(EYe,this.props)}}])}(P.Component);kee(dN,"displayName","YAxis");kee(dN,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function oB(e){return PYe(e)||TYe(e)||AYe(e)||kYe()}function kYe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AYe(e,t){if(e){if(typeof e=="string")return qE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return qE(e,t)}}function TYe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function PYe(e){if(Array.isArray(e))return qE(e)}function qE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}var WE=function(t,r,s,a,i){var o=Go(t,kT),c=Go(t,iN),d=[].concat(oB(o),oB(c)),l=Go(t,lN),u="".concat(a,"Id"),h=a[0],f=r;if(d.length&&(f=d.reduce(function(g,v){if(v.props[u]===s&&vc(v.props,"extendDomain")&&Lt(v.props[h])){var x=v.props[h];return[Math.min(g[0],x),Math.max(g[1],x)]}return g},f)),l.length){var m="".concat(h,"1"),p="".concat(h,"2");f=l.reduce(function(g,v){if(v.props[u]===s&&vc(v.props,"extendDomain")&&Lt(v.props[m])&&Lt(v.props[p])){var x=v.props[m],y=v.props[p];return[Math.min(g[0],x,y),Math.max(g[1],x,y)]}return g},f)}return i&&i.length&&(f=i.reduce(function(g,v){return Lt(v)?[Math.min(g[0],v),Math.max(g[1],v)]:g},f)),f},Tee={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(r=!1));function a(d,l,u){this.fn=d,this.context=l,this.once=u||!1}function i(d,l,u,h,f){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new a(u,h||d,f),p=r?r+l:l;return d._events[p]?d._events[p].fn?d._events[p]=[d._events[p],m]:d._events[p].push(m):(d._events[p]=m,d._eventsCount++),d}function o(d,l){--d._eventsCount===0?d._events=new s:delete d._events[l]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var l=[],u,h;if(this._eventsCount===0)return l;for(h in u=this._events)t.call(u,h)&&l.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},c.prototype.listeners=function(l){var u=r?r+l:l,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,m=h.length,p=new Array(m);f<m;f++)p[f]=h[f].fn;return p},c.prototype.listenerCount=function(l){var u=r?r+l:l,h=this._events[u];return h?h.fn?1:h.length:0},c.prototype.emit=function(l,u,h,f,m,p){var g=r?r+l:l;if(!this._events[g])return!1;var v=this._events[g],x=arguments.length,y,b;if(v.fn){switch(v.once&&this.removeListener(l,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,h),!0;case 4:return v.fn.call(v.context,u,h,f),!0;case 5:return v.fn.call(v.context,u,h,f,m),!0;case 6:return v.fn.call(v.context,u,h,f,m,p),!0}for(b=1,y=new Array(x-1);b<x;b++)y[b-1]=arguments[b];v.fn.apply(v.context,y)}else{var j=v.length,T;for(b=0;b<j;b++)switch(v[b].once&&this.removeListener(l,v[b].fn,void 0,!0),x){case 1:v[b].fn.call(v[b].context);break;case 2:v[b].fn.call(v[b].context,u);break;case 3:v[b].fn.call(v[b].context,u,h);break;case 4:v[b].fn.call(v[b].context,u,h,f);break;default:if(!y)for(T=1,y=new Array(x-1);T<x;T++)y[T-1]=arguments[T];v[b].fn.apply(v[b].context,y)}}return!0},c.prototype.on=function(l,u,h){return i(this,l,u,h,!1)},c.prototype.once=function(l,u,h){return i(this,l,u,h,!0)},c.prototype.removeListener=function(l,u,h,f){var m=r?r+l:l;if(!this._events[m])return this;if(!u)return o(this,m),this;var p=this._events[m];if(p.fn)p.fn===u&&(!f||p.once)&&(!h||p.context===h)&&o(this,m);else{for(var g=0,v=[],x=p.length;g<x;g++)(p[g].fn!==u||f&&!p[g].once||h&&p[g].context!==h)&&v.push(p[g]);v.length?this._events[m]=v.length===1?v[0]:v:o(this,m)}return this},c.prototype.removeAllListeners=function(l){var u;return l?(u=r?r+l:l,this._events[u]&&o(this,u)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,e.exports=c})(Tee);var OYe=Tee.exports;const RYe=On(OYe);var V4=new RYe,q4="recharts.syncMouseEvents";function t1(e){"@babel/helpers - typeof";return t1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t1(e)}function MYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IYe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Pee(s.key),s)}}function DYe(e,t,r){return t&&IYe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function W4(e,t,r){return t=Pee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pee(e){var t=LYe(e,"string");return t1(t)=="symbol"?t:t+""}function LYe(e,t){if(t1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t);if(t1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var BYe=function(){function e(){MYe(this,e),W4(this,"activeIndex",0),W4(this,"coordinateList",[]),W4(this,"layout","horizontal")}return DYe(e,[{key:"setDetails",value:function(r){var s,a=r.coordinateList,i=a===void 0?null:a,o=r.container,c=o===void 0?null:o,d=r.layout,l=d===void 0?null:d,u=r.offset,h=u===void 0?null:u,f=r.mouseHandlerCallback,m=f===void 0?null:f;this.coordinateList=(s=i??this.coordinateList)!==null&&s!==void 0?s:[],this.container=c??this.container,this.layout=l??this.layout,this.offset=h??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(r){if(this.coordinateList.length!==0)switch(r.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(r){this.activeIndex=r}},{key:"spoofMouse",value:function(){var r,s;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var a=this.container.getBoundingClientRect(),i=a.x,o=a.y,c=a.height,d=this.coordinateList[this.activeIndex].coordinate,l=((r=window)===null||r===void 0?void 0:r.scrollX)||0,u=((s=window)===null||s===void 0?void 0:s.scrollY)||0,h=i+d+l,f=o+this.offset.top+c/2+u;this.mouseHandlerCallback({pageX:h,pageY:f})}}}])}();function $Ye(e,t,r){if(r==="number"&&t===!0&&Array.isArray(e)){var s=e==null?void 0:e[0],a=e==null?void 0:e[1];if(s&&a&&Lt(s)&&Lt(a))return!0}return!1}function FYe(e,t,r,s){var a=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?s:r.width-1,height:e==="horizontal"?r.height-1:s}}function Oee(e){var t=e.cx,r=e.cy,s=e.radius,a=e.startAngle,i=e.endAngle,o=as(t,r,s,a),c=as(t,r,s,i);return{points:[o,c],cx:t,cy:r,radius:s,startAngle:a,endAngle:i}}function zYe(e,t,r){var s,a,i,o;if(e==="horizontal")s=t.x,i=s,a=r.top,o=r.top+r.height;else if(e==="vertical")a=t.y,o=a,s=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var c=t.cx,d=t.cy,l=t.innerRadius,u=t.outerRadius,h=t.angle,f=as(c,d,l,h),m=as(c,d,u,h);s=f.x,a=f.y,i=m.x,o=m.y}else return Oee(t);return[{x:s,y:a},{x:i,y:o}]}function r1(e){"@babel/helpers - typeof";return r1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r1(e)}function lB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function mb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lB(Object(r),!0).forEach(function(s){UYe(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lB(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function UYe(e,t,r){return t=VYe(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VYe(e){var t=qYe(e,"string");return r1(t)=="symbol"?t:t+""}function qYe(e,t){if(r1(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(r1(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WYe(e){var t,r,s=e.element,a=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,c=e.activePayload,d=e.offset,l=e.activeTooltipIndex,u=e.tooltipAxisBandSize,h=e.layout,f=e.chartName,m=(t=s.props.cursor)!==null&&t!==void 0?t:(r=s.type.defaultProps)===null||r===void 0?void 0:r.cursor;if(!s||!m||!i||!o||f!=="ScatterChart"&&a!=="axis")return null;var p,g=rp;if(f==="ScatterChart")p=o,g=hWe;else if(f==="BarChart")p=FYe(h,o,d,u),g=wT;else if(h==="radial"){var v=Oee(o),x=v.cx,y=v.cy,b=v.radius,j=v.startAngle,T=v.endAngle;p={cx:x,cy:y,startAngle:j,endAngle:T,innerRadius:b,outerRadius:b},g=CJ}else p={points:zYe(h,o,d)},g=rp;var O=mb(mb(mb(mb({stroke:"#ccc",pointerEvents:"none"},d),p),Sr(m,!1)),{},{payload:c,payloadIndex:l,className:Xr("recharts-tooltip-cursor",m.className)});return P.isValidElement(m)?P.cloneElement(m,O):P.createElement(g,O)}var HYe=["item"],GYe=["children","className","width","height","style","compact","title","desc"];function ag(e){"@babel/helpers - typeof";return ag=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ag(e)}function Lm(){return Lm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Lm.apply(this,arguments)}function cB(e,t){return YYe(e)||XYe(e,t)||Mee(e,t)||KYe()}function KYe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function XYe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var s,a,i,o,c=[],d=!0,l=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(d=(s=i.call(r)).done)&&(c.push(s.value),c.length!==t);d=!0);}catch(u){l=!0,a=u}finally{try{if(!d&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(l)throw a}}return c}}function YYe(e){if(Array.isArray(e))return e}function dB(e,t){if(e==null)return{};var r=ZYe(e,t),s,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)s=i[a],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(r[s]=e[s])}return r}function ZYe(e,t){if(e==null)return{};var r={};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;r[s]=e[s]}return r}function QYe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function JYe(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,Iee(s.key),s)}}function eZe(e,t,r){return t&&JYe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function tZe(e,t,r){return t=J2(t),rZe(e,Ree()?Reflect.construct(t,r||[],J2(e).constructor):t.apply(e,r))}function rZe(e,t){if(t&&(ag(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return nZe(e)}function nZe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ree(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ree=function(){return!!e})()}function J2(e){return J2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},J2(e)}function sZe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&HE(e,t)}function HE(e,t){return HE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,a){return s.__proto__=a,s},HE(e,t)}function ig(e){return oZe(e)||iZe(e)||Mee(e)||aZe()}function aZe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mee(e,t){if(e){if(typeof e=="string")return GE(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return GE(e,t)}}function iZe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function oZe(e){if(Array.isArray(e))return GE(e)}function GE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s}function uB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,s)}return r}function _t(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uB(Object(r),!0).forEach(function(s){Pr(e,s,r[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uB(Object(r)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(r,s))})}return e}function Pr(e,t,r){return t=Iee(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Iee(e){var t=lZe(e,"string");return ag(t)=="symbol"?t:t+""}function lZe(e,t){if(ag(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(ag(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cZe={xAxis:["bottom","top"],yAxis:["left","right"]},dZe={width:"100%",height:"100%"},Dee={x:0,y:0};function pb(e){return e}var uZe=function(t,r){return r==="horizontal"?t.x:r==="vertical"?t.y:r==="centric"?t.angle:t.radius},hZe=function(t,r,s,a){var i=r.find(function(u){return u&&u.index===s});if(i){if(t==="horizontal")return{x:i.coordinate,y:a.y};if(t==="vertical")return{x:a.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,c=a.radius;return _t(_t(_t({},a),as(a.cx,a.cy,c,o)),{},{angle:o,radius:c})}var d=i.coordinate,l=a.angle;return _t(_t(_t({},a),as(a.cx,a.cy,d,l)),{},{angle:l,radius:d})}return Dee},uN=function(t,r){var s=r.graphicalItems,a=r.dataStartIndex,i=r.dataEndIndex,o=(s??[]).reduce(function(c,d){var l=d.props.data;return l&&l.length?[].concat(ig(c),ig(l)):c},[]);return o.length>0?o:t&&t.length&&Lt(a)&&Lt(i)?t.slice(a,i+1):[]};function Lee(e){return e==="number"?[0,"auto"]:void 0}var KE=function(t,r,s,a){var i=t.graphicalItems,o=t.tooltipAxis,c=uN(r,t);return s<0||!i||!i.length||s>=c.length?null:i.reduce(function(d,l){var u,h=(u=l.props.data)!==null&&u!==void 0?u:r;h&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=s&&(h=h.slice(t.dataStartIndex,t.dataEndIndex+1));var f;if(o.dataKey&&!o.allowDuplicatedCategory){var m=h===void 0?c:h;f=e2(m,o.dataKey,a)}else f=h&&h[s]||c[s];return f?[].concat(ig(d),[bJ(l,f)]):d},[])},hB=function(t,r,s,a){var i=a||{x:t.chartX,y:t.chartY},o=uZe(i,s),c=t.orderedTooltipTicks,d=t.tooltipAxis,l=t.tooltipTicks,u=Dze(o,c,l,d);if(u>=0&&l){var h=l[u]&&l[u].value,f=KE(t,r,u,h),m=hZe(s,c,u,i);return{activeTooltipIndex:u,activeLabel:h,activePayload:f,activeCoordinate:m}}return null},fZe=function(t,r){var s=r.axes,a=r.graphicalItems,i=r.axisType,o=r.axisIdKey,c=r.stackGroups,d=r.dataStartIndex,l=r.dataEndIndex,u=t.layout,h=t.children,f=t.stackOffset,m=mJ(u,i);return s.reduce(function(p,g){var v,x=g.type.defaultProps!==void 0?_t(_t({},g.type.defaultProps),g.props):g.props,y=x.type,b=x.dataKey,j=x.allowDataOverflow,T=x.allowDuplicatedCategory,O=x.scale,R=x.ticks,D=x.includeHidden,L=x[o];if(p[L])return p;var q=uN(t.data,{graphicalItems:a.filter(function($){var Y,Z=o in $.props?$.props[o]:(Y=$.type.defaultProps)===null||Y===void 0?void 0:Y[o];return Z===L}),dataStartIndex:d,dataEndIndex:l}),X=q.length,H,M,F;$Ye(x.domain,j,y)&&(H=cE(x.domain,null,j),m&&(y==="number"||O!=="auto")&&(F=bx(q,b,"category")));var S=Lee(y);if(!H||H.length===0){var E,N=(E=x.domain)!==null&&E!==void 0?E:S;if(b){if(H=bx(q,b,y),y==="category"&&m){var C=S8e(H);T&&C?(M=H,H=F2(0,X)):T||(H=ID(N,H,g).reduce(function($,Y){return $.indexOf(Y)>=0?$:[].concat(ig($),[Y])},[]))}else if(y==="category")T?H=H.filter(function($){return $!==""&&!Yr($)}):H=ID(N,H,g).reduce(function($,Y){return $.indexOf(Y)>=0||Y===""||Yr(Y)?$:[].concat(ig($),[Y])},[]);else if(y==="number"){var k=zze(q,a.filter(function($){var Y,Z,re=o in $.props?$.props[o]:(Y=$.type.defaultProps)===null||Y===void 0?void 0:Y[o],G="hide"in $.props?$.props.hide:(Z=$.type.defaultProps)===null||Z===void 0?void 0:Z.hide;return re===L&&(D||!G)}),b,i,u);k&&(H=k)}m&&(y==="number"||O!=="auto")&&(F=bx(q,b,"category"))}else m?H=F2(0,X):c&&c[L]&&c[L].hasStack&&y==="number"?H=f==="expand"?[0,1]:yJ(c[L].stackGroups,d,l):H=fJ(q,a.filter(function($){var Y=o in $.props?$.props[o]:$.type.defaultProps[o],Z="hide"in $.props?$.props.hide:$.type.defaultProps.hide;return Y===L&&(D||!Z)}),y,u,!0);if(y==="number")H=WE(h,H,L,i,R),N&&(H=cE(N,H,j));else if(y==="category"&&N){var I=N,U=H.every(function($){return I.indexOf($)>=0});U&&(H=I)}}return _t(_t({},p),{},Pr({},L,_t(_t({},x),{},{axisType:i,domain:H,categoricalDomain:F,duplicateDomain:M,originalDomain:(v=x.domain)!==null&&v!==void 0?v:S,isCategorical:m,layout:u})))},{})},mZe=function(t,r){var s=r.graphicalItems,a=r.Axis,i=r.axisType,o=r.axisIdKey,c=r.stackGroups,d=r.dataStartIndex,l=r.dataEndIndex,u=t.layout,h=t.children,f=uN(t.data,{graphicalItems:s,dataStartIndex:d,dataEndIndex:l}),m=f.length,p=mJ(u,i),g=-1;return s.reduce(function(v,x){var y=x.type.defaultProps!==void 0?_t(_t({},x.type.defaultProps),x.props):x.props,b=y[o],j=Lee("number");if(!v[b]){g++;var T;return p?T=F2(0,m):c&&c[b]&&c[b].hasStack?(T=yJ(c[b].stackGroups,d,l),T=WE(h,T,b,i)):(T=cE(j,fJ(f,s.filter(function(O){var R,D,L=o in O.props?O.props[o]:(R=O.type.defaultProps)===null||R===void 0?void 0:R[o],q="hide"in O.props?O.props.hide:(D=O.type.defaultProps)===null||D===void 0?void 0:D.hide;return L===b&&!q}),"number",u),a.defaultProps.allowDataOverflow),T=WE(h,T,b,i)),_t(_t({},v),{},Pr({},b,_t(_t({axisType:i},a.defaultProps),{},{hide:!0,orientation:bo(cZe,"".concat(i,".").concat(g%2),null),domain:T,originalDomain:j,isCategorical:p,layout:u})))}return v},{})},pZe=function(t,r){var s=r.axisType,a=s===void 0?"xAxis":s,i=r.AxisComp,o=r.graphicalItems,c=r.stackGroups,d=r.dataStartIndex,l=r.dataEndIndex,u=t.children,h="".concat(a,"Id"),f=Go(u,i),m={};return f&&f.length?m=fZe(t,{axes:f,graphicalItems:o,axisType:a,axisIdKey:h,stackGroups:c,dataStartIndex:d,dataEndIndex:l}):o&&o.length&&(m=mZe(t,{Axis:i,graphicalItems:o,axisType:a,axisIdKey:h,stackGroups:c,dataStartIndex:d,dataEndIndex:l})),m},gZe=function(t){var r=Zd(t),s=Jc(r,!1,!0);return{tooltipTicks:s,orderedTooltipTicks:GA(s,function(a){return a.coordinate}),tooltipAxis:r,tooltipAxisBandSize:k2(r,s)}},fB=function(t){var r=t.children,s=t.defaultShowTooltip,a=lo(r,Yp),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),a&&a.props&&(a.props.startIndex>=0&&(i=a.props.startIndex),a.props.endIndex>=0&&(o=a.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!s}},xZe=function(t){return!t||!t.length?!1:t.some(function(r){var s=rd(r&&r.type);return s&&s.indexOf("Bar")>=0})},mB=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},vZe=function(t,r){var s=t.props,a=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,c=t.yAxisMap,d=c===void 0?{}:c,l=s.width,u=s.height,h=s.children,f=s.margin||{},m=lo(h,Yp),p=lo(h,Xh),g=Object.keys(d).reduce(function(T,O){var R=d[O],D=R.orientation;return!R.mirror&&!R.hide?_t(_t({},T),{},Pr({},D,T[D]+R.width)):T},{left:f.left||0,right:f.right||0}),v=Object.keys(o).reduce(function(T,O){var R=o[O],D=R.orientation;return!R.mirror&&!R.hide?_t(_t({},T),{},Pr({},D,bo(T,"".concat(D))+R.height)):T},{top:f.top||0,bottom:f.bottom||0}),x=_t(_t({},v),g),y=x.bottom;m&&(x.bottom+=m.props.height||Yp.defaultProps.height),p&&r&&(x=$ze(x,a,s,r));var b=l-x.left-x.right,j=u-x.top-x.bottom;return _t(_t({brushBottom:y},x),{},{width:Math.max(b,0),height:Math.max(j,0)})},yZe=function(t,r){if(r==="xAxis")return t[r].width;if(r==="yAxis")return t[r].height},Bee=function(t){var r=t.chartName,s=t.GraphicalChild,a=t.defaultTooltipEventType,i=a===void 0?"axis":a,o=t.validateTooltipEventTypes,c=o===void 0?["axis"]:o,d=t.axisComponents,l=t.legendContent,u=t.formatAxisMap,h=t.defaultProps,f=function(x,y){var b=y.graphicalItems,j=y.stackGroups,T=y.offset,O=y.updateId,R=y.dataStartIndex,D=y.dataEndIndex,L=x.barSize,q=x.layout,X=x.barGap,H=x.barCategoryGap,M=x.maxBarSize,F=mB(q),S=F.numericAxisName,E=F.cateAxisName,N=xZe(b),C=[];return b.forEach(function(k,I){var U=uN(x.data,{graphicalItems:[k],dataStartIndex:R,dataEndIndex:D}),$=k.type.defaultProps!==void 0?_t(_t({},k.type.defaultProps),k.props):k.props,Y=$.dataKey,Z=$.maxBarSize,re=$["".concat(S,"Id")],G=$["".concat(E,"Id")],J={},V=d.reduce(function(_e,be){var Me=y["".concat(be.axisType,"Map")],Se=$["".concat(be.axisType,"Id")];Me&&Me[Se]||be.axisType==="zAxis"||Nf();var $e=Me[Se];return _t(_t({},_e),{},Pr(Pr({},be.axisType,$e),"".concat(be.axisType,"Ticks"),Jc($e)))},J),W=V[E],ee=V["".concat(E,"Ticks")],ie=j&&j[re]&&j[re].hasStack&&Yze(k,j[re].stackGroups),oe=rd(k.type).indexOf("Bar")>=0,se=k2(W,ee),le=[],ye=N&&Lze({barSize:L,stackGroups:j,totalSize:yZe(V,E)});if(oe){var ue,ne,pe=Yr(Z)?M:Z,ge=(ue=(ne=k2(W,ee,!0))!==null&&ne!==void 0?ne:pe)!==null&&ue!==void 0?ue:0;le=Bze({barGap:X,barCategoryGap:H,bandSize:ge!==se?ge:se,sizeList:ye[G],maxBarSize:pe}),ge!==se&&(le=le.map(function(_e){return _t(_t({},_e),{},{position:_t(_t({},_e.position),{},{offset:_e.position.offset-ge/2})})}))}var Ne=k&&k.type&&k.type.getComposedData;Ne&&C.push({props:_t(_t({},Ne(_t(_t({},V),{},{displayedData:U,props:x,dataKey:Y,item:k,bandSize:se,barPosition:le,offset:T,stackedData:ie,layout:q,dataStartIndex:R,dataEndIndex:D}))),{},Pr(Pr(Pr({key:k.key||"item-".concat(I)},S,V[S]),E,V[E]),"animationId",O)),childIndex:B8e(k,x.children),item:k})}),C},m=function(x,y){var b=x.props,j=x.dataStartIndex,T=x.dataEndIndex,O=x.updateId;if(!kI({props:b}))return null;var R=b.children,D=b.layout,L=b.stackOffset,q=b.data,X=b.reverseStackOrder,H=mB(D),M=H.numericAxisName,F=H.cateAxisName,S=Go(R,s),E=Kze(q,S,"".concat(M,"Id"),"".concat(F,"Id"),L,X),N=d.reduce(function($,Y){var Z="".concat(Y.axisType,"Map");return _t(_t({},$),{},Pr({},Z,pZe(b,_t(_t({},Y),{},{graphicalItems:S,stackGroups:Y.axisType===M&&E,dataStartIndex:j,dataEndIndex:T}))))},{}),C=vZe(_t(_t({},N),{},{props:b,graphicalItems:S}),y==null?void 0:y.legendBBox);Object.keys(N).forEach(function($){N[$]=u(b,N[$],C,$.replace("Map",""),r)});var k=N["".concat(F,"Map")],I=gZe(k),U=f(b,_t(_t({},N),{},{dataStartIndex:j,dataEndIndex:T,updateId:O,graphicalItems:S,stackGroups:E,offset:C}));return _t(_t({formattedGraphicalItems:U,graphicalItems:S,offset:C,stackGroups:E},I),N)},p=function(v){function x(y){var b,j,T;return QYe(this,x),T=tZe(this,x,[y]),Pr(T,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Pr(T,"accessibilityManager",new BYe),Pr(T,"handleLegendBBoxUpdate",function(O){if(O){var R=T.state,D=R.dataStartIndex,L=R.dataEndIndex,q=R.updateId;T.setState(_t({legendBBox:O},m({props:T.props,dataStartIndex:D,dataEndIndex:L,updateId:q},_t(_t({},T.state),{},{legendBBox:O}))))}}),Pr(T,"handleReceiveSyncEvent",function(O,R,D){if(T.props.syncId===O){if(D===T.eventEmitterSymbol&&typeof T.props.syncMethod!="function")return;T.applySyncEvent(R)}}),Pr(T,"handleBrushChange",function(O){var R=O.startIndex,D=O.endIndex;if(R!==T.state.dataStartIndex||D!==T.state.dataEndIndex){var L=T.state.updateId;T.setState(function(){return _t({dataStartIndex:R,dataEndIndex:D},m({props:T.props,dataStartIndex:R,dataEndIndex:D,updateId:L},T.state))}),T.triggerSyncEvent({dataStartIndex:R,dataEndIndex:D})}}),Pr(T,"handleMouseEnter",function(O){var R=T.getMouseInfo(O);if(R){var D=_t(_t({},R),{},{isTooltipActive:!0});T.setState(D),T.triggerSyncEvent(D);var L=T.props.onMouseEnter;Lr(L)&&L(D,O)}}),Pr(T,"triggeredAfterMouseMove",function(O){var R=T.getMouseInfo(O),D=R?_t(_t({},R),{},{isTooltipActive:!0}):{isTooltipActive:!1};T.setState(D),T.triggerSyncEvent(D);var L=T.props.onMouseMove;Lr(L)&&L(D,O)}),Pr(T,"handleItemMouseEnter",function(O){T.setState(function(){return{isTooltipActive:!0,activeItem:O,activePayload:O.tooltipPayload,activeCoordinate:O.tooltipPosition||{x:O.cx,y:O.cy}}})}),Pr(T,"handleItemMouseLeave",function(){T.setState(function(){return{isTooltipActive:!1}})}),Pr(T,"handleMouseMove",function(O){O.persist(),T.throttleTriggeredAfterMouseMove(O)}),Pr(T,"handleMouseLeave",function(O){T.throttleTriggeredAfterMouseMove.cancel();var R={isTooltipActive:!1};T.setState(R),T.triggerSyncEvent(R);var D=T.props.onMouseLeave;Lr(D)&&D(R,O)}),Pr(T,"handleOuterEvent",function(O){var R=L8e(O),D=bo(T.props,"".concat(R));if(R&&Lr(D)){var L,q;/.*touch.*/i.test(R)?q=T.getMouseInfo(O.changedTouches[0]):q=T.getMouseInfo(O),D((L=q)!==null&&L!==void 0?L:{},O)}}),Pr(T,"handleClick",function(O){var R=T.getMouseInfo(O);if(R){var D=_t(_t({},R),{},{isTooltipActive:!0});T.setState(D),T.triggerSyncEvent(D);var L=T.props.onClick;Lr(L)&&L(D,O)}}),Pr(T,"handleMouseDown",function(O){var R=T.props.onMouseDown;if(Lr(R)){var D=T.getMouseInfo(O);R(D,O)}}),Pr(T,"handleMouseUp",function(O){var R=T.props.onMouseUp;if(Lr(R)){var D=T.getMouseInfo(O);R(D,O)}}),Pr(T,"handleTouchMove",function(O){O.changedTouches!=null&&O.changedTouches.length>0&&T.throttleTriggeredAfterMouseMove(O.changedTouches[0])}),Pr(T,"handleTouchStart",function(O){O.changedTouches!=null&&O.changedTouches.length>0&&T.handleMouseDown(O.changedTouches[0])}),Pr(T,"handleTouchEnd",function(O){O.changedTouches!=null&&O.changedTouches.length>0&&T.handleMouseUp(O.changedTouches[0])}),Pr(T,"handleDoubleClick",function(O){var R=T.props.onDoubleClick;if(Lr(R)){var D=T.getMouseInfo(O);R(D,O)}}),Pr(T,"handleContextMenu",function(O){var R=T.props.onContextMenu;if(Lr(R)){var D=T.getMouseInfo(O);R(D,O)}}),Pr(T,"triggerSyncEvent",function(O){T.props.syncId!==void 0&&V4.emit(q4,T.props.syncId,O,T.eventEmitterSymbol)}),Pr(T,"applySyncEvent",function(O){var R=T.props,D=R.layout,L=R.syncMethod,q=T.state.updateId,X=O.dataStartIndex,H=O.dataEndIndex;if(O.dataStartIndex!==void 0||O.dataEndIndex!==void 0)T.setState(_t({dataStartIndex:X,dataEndIndex:H},m({props:T.props,dataStartIndex:X,dataEndIndex:H,updateId:q},T.state)));else if(O.activeTooltipIndex!==void 0){var M=O.chartX,F=O.chartY,S=O.activeTooltipIndex,E=T.state,N=E.offset,C=E.tooltipTicks;if(!N)return;if(typeof L=="function")S=L(C,O);else if(L==="value"){S=-1;for(var k=0;k<C.length;k++)if(C[k].value===O.activeLabel){S=k;break}}var I=_t(_t({},N),{},{x:N.left,y:N.top}),U=Math.min(M,I.x+I.width),$=Math.min(F,I.y+I.height),Y=C[S]&&C[S].value,Z=KE(T.state,T.props.data,S),re=C[S]?{x:D==="horizontal"?C[S].coordinate:U,y:D==="horizontal"?$:C[S].coordinate}:Dee;T.setState(_t(_t({},O),{},{activeLabel:Y,activeCoordinate:re,activePayload:Z,activeTooltipIndex:S}))}else T.setState(O)}),Pr(T,"renderCursor",function(O){var R,D=T.state,L=D.isTooltipActive,q=D.activeCoordinate,X=D.activePayload,H=D.offset,M=D.activeTooltipIndex,F=D.tooltipAxisBandSize,S=T.getTooltipEventType(),E=(R=O.props.active)!==null&&R!==void 0?R:L,N=T.props.layout,C=O.key||"_recharts-cursor";return we.createElement(WYe,{key:C,activeCoordinate:q,activePayload:X,activeTooltipIndex:M,chartName:r,element:O,isActive:E,layout:N,offset:H,tooltipAxisBandSize:F,tooltipEventType:S})}),Pr(T,"renderPolarAxis",function(O,R,D){var L=bo(O,"type.axisType"),q=bo(T.state,"".concat(L,"Map")),X=O.type.defaultProps,H=X!==void 0?_t(_t({},X),O.props):O.props,M=q&&q[H["".concat(L,"Id")]];return P.cloneElement(O,_t(_t({},M),{},{className:Xr(L,M.className),key:O.key||"".concat(R,"-").concat(D),ticks:Jc(M,!0)}))}),Pr(T,"renderPolarGrid",function(O){var R=O.props,D=R.radialLines,L=R.polarAngles,q=R.polarRadius,X=T.state,H=X.radiusAxisMap,M=X.angleAxisMap,F=Zd(H),S=Zd(M),E=S.cx,N=S.cy,C=S.innerRadius,k=S.outerRadius;return P.cloneElement(O,{polarAngles:Array.isArray(L)?L:Jc(S,!0).map(function(I){return I.coordinate}),polarRadius:Array.isArray(q)?q:Jc(F,!0).map(function(I){return I.coordinate}),cx:E,cy:N,innerRadius:C,outerRadius:k,key:O.key||"polar-grid",radialLines:D})}),Pr(T,"renderLegend",function(){var O=T.state.formattedGraphicalItems,R=T.props,D=R.children,L=R.width,q=R.height,X=T.props.margin||{},H=L-(X.left||0)-(X.right||0),M=uJ({children:D,formattedGraphicalItems:O,legendWidth:H,legendContent:l});if(!M)return null;var F=M.item,S=dB(M,HYe);return P.cloneElement(F,_t(_t({},S),{},{chartWidth:L,chartHeight:q,margin:X,onBBoxUpdate:T.handleLegendBBoxUpdate}))}),Pr(T,"renderTooltip",function(){var O,R=T.props,D=R.children,L=R.accessibilityLayer,q=lo(D,Lo);if(!q)return null;var X=T.state,H=X.isTooltipActive,M=X.activeCoordinate,F=X.activePayload,S=X.activeLabel,E=X.offset,N=(O=q.props.active)!==null&&O!==void 0?O:H;return P.cloneElement(q,{viewBox:_t(_t({},E),{},{x:E.left,y:E.top}),active:N,label:S,payload:N?F:[],coordinate:M,accessibilityLayer:L})}),Pr(T,"renderBrush",function(O){var R=T.props,D=R.margin,L=R.data,q=T.state,X=q.offset,H=q.dataStartIndex,M=q.dataEndIndex,F=q.updateId;return P.cloneElement(O,{key:O.key||"_recharts-brush",onChange:db(T.handleBrushChange,O.props.onChange),data:L,x:Lt(O.props.x)?O.props.x:X.left,y:Lt(O.props.y)?O.props.y:X.top+X.height+X.brushBottom-(D.bottom||0),width:Lt(O.props.width)?O.props.width:X.width,startIndex:H,endIndex:M,updateId:"brush-".concat(F)})}),Pr(T,"renderReferenceElement",function(O,R,D){if(!O)return null;var L=T,q=L.clipPathId,X=T.state,H=X.xAxisMap,M=X.yAxisMap,F=X.offset,S=O.type.defaultProps||{},E=O.props,N=E.xAxisId,C=N===void 0?S.xAxisId:N,k=E.yAxisId,I=k===void 0?S.yAxisId:k;return P.cloneElement(O,{key:O.key||"".concat(R,"-").concat(D),xAxis:H[C],yAxis:M[I],viewBox:{x:F.left,y:F.top,width:F.width,height:F.height},clipPathId:q})}),Pr(T,"renderActivePoints",function(O){var R=O.item,D=O.activePoint,L=O.basePoint,q=O.childIndex,X=O.isRange,H=[],M=R.props.key,F=R.item.type.defaultProps!==void 0?_t(_t({},R.item.type.defaultProps),R.item.props):R.item.props,S=F.activeDot,E=F.dataKey,N=_t(_t({index:q,dataKey:E,cx:D.x,cy:D.y,r:4,fill:bT(R.item),strokeWidth:2,stroke:"#fff",payload:D.payload,value:D.value},Sr(S,!1)),t2(S));return H.push(x.renderActiveDot(S,N,"".concat(M,"-activePoint-").concat(q))),L?H.push(x.renderActiveDot(S,_t(_t({},N),{},{cx:L.x,cy:L.y}),"".concat(M,"-basePoint-").concat(q))):X&&H.push(null),H}),Pr(T,"renderGraphicChild",function(O,R,D){var L=T.filterFormatItem(O,R,D);if(!L)return null;var q=T.getTooltipEventType(),X=T.state,H=X.isTooltipActive,M=X.tooltipAxis,F=X.activeTooltipIndex,S=X.activeLabel,E=T.props.children,N=lo(E,Lo),C=L.props,k=C.points,I=C.isRange,U=C.baseLine,$=L.item.type.defaultProps!==void 0?_t(_t({},L.item.type.defaultProps),L.item.props):L.item.props,Y=$.activeDot,Z=$.hide,re=$.activeBar,G=$.activeShape,J=!!(!Z&&H&&N&&(Y||re||G)),V={};q!=="axis"&&N&&N.props.trigger==="click"?V={onClick:db(T.handleItemMouseEnter,O.props.onClick)}:q!=="axis"&&(V={onMouseLeave:db(T.handleItemMouseLeave,O.props.onMouseLeave),onMouseEnter:db(T.handleItemMouseEnter,O.props.onMouseEnter)});var W=P.cloneElement(O,_t(_t({},L.props),V));function ee(be){return typeof M.dataKey=="function"?M.dataKey(be.payload):null}if(J)if(F>=0){var ie,oe;if(M.dataKey&&!M.allowDuplicatedCategory){var se=typeof M.dataKey=="function"?ee:"payload.".concat(M.dataKey.toString());ie=e2(k,se,S),oe=I&&U&&e2(U,se,S)}else ie=k==null?void 0:k[F],oe=I&&U&&U[F];if(G||re){var le=O.props.activeIndex!==void 0?O.props.activeIndex:F;return[P.cloneElement(O,_t(_t(_t({},L.props),V),{},{activeIndex:le})),null,null]}if(!Yr(ie))return[W].concat(ig(T.renderActivePoints({item:L,activePoint:ie,basePoint:oe,childIndex:F,isRange:I})))}else{var ye,ue=(ye=T.getItemByXY(T.state.activeCoordinate))!==null&&ye!==void 0?ye:{graphicalItem:W},ne=ue.graphicalItem,pe=ne.item,ge=pe===void 0?O:pe,Ne=ne.childIndex,_e=_t(_t(_t({},L.props),V),{},{activeIndex:Ne});return[P.cloneElement(ge,_e),null,null]}return I?[W,null,null]:[W,null]}),Pr(T,"renderCustomized",function(O,R,D){return P.cloneElement(O,_t(_t({key:"recharts-customized-".concat(D)},T.props),T.state))}),Pr(T,"renderMap",{CartesianGrid:{handler:pb,once:!0},ReferenceArea:{handler:T.renderReferenceElement},ReferenceLine:{handler:pb},ReferenceDot:{handler:T.renderReferenceElement},XAxis:{handler:pb},YAxis:{handler:pb},Brush:{handler:T.renderBrush,once:!0},Bar:{handler:T.renderGraphicChild},Line:{handler:T.renderGraphicChild},Area:{handler:T.renderGraphicChild},Radar:{handler:T.renderGraphicChild},RadialBar:{handler:T.renderGraphicChild},Scatter:{handler:T.renderGraphicChild},Pie:{handler:T.renderGraphicChild},Funnel:{handler:T.renderGraphicChild},Tooltip:{handler:T.renderCursor,once:!0},PolarGrid:{handler:T.renderPolarGrid,once:!0},PolarAngleAxis:{handler:T.renderPolarAxis},PolarRadiusAxis:{handler:T.renderPolarAxis},Customized:{handler:T.renderCustomized}}),T.clipPathId="".concat((b=y.id)!==null&&b!==void 0?b:Wg("recharts"),"-clip"),T.throttleTriggeredAfterMouseMove=dQ(T.triggeredAfterMouseMove,(j=y.throttleDelay)!==null&&j!==void 0?j:1e3/60),T.state={},T}return sZe(x,v),eZe(x,[{key:"componentDidMount",value:function(){var b,j;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,j=b.children,T=b.data,O=b.height,R=b.layout,D=lo(j,Lo);if(D){var L=D.props.defaultIndex;if(!(typeof L!="number"||L<0||L>this.state.tooltipTicks.length-1)){var q=this.state.tooltipTicks[L]&&this.state.tooltipTicks[L].value,X=KE(this.state,T,L,q),H=this.state.tooltipTicks[L].coordinate,M=(this.state.offset.top+O)/2,F=R==="horizontal",S=F?{x:H,y:M}:{y:H,x:M},E=this.state.formattedGraphicalItems.find(function(C){var k=C.item;return k.type.name==="Scatter"});E&&(S=_t(_t({},S),E.props.points[L].tooltipPosition),X=E.props.points[L].tooltipPayload);var N={activeTooltipIndex:L,isTooltipActive:!0,activeLabel:q,activePayload:X,activeCoordinate:S};this.setState(N),this.renderCursor(D),this.accessibilityManager.setIndex(L)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,j){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==j.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var T,O;this.accessibilityManager.setDetails({offset:{left:(T=this.props.margin.left)!==null&&T!==void 0?T:0,top:(O=this.props.margin.top)!==null&&O!==void 0?O:0}})}return null}},{key:"componentDidUpdate",value:function(b){N5([lo(b.children,Lo)],[lo(this.props.children,Lo)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=lo(this.props.children,Lo);if(b&&typeof b.props.shared=="boolean"){var j=b.props.shared?"axis":"item";return c.indexOf(j)>=0?j:i}return i}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var j=this.container,T=j.getBoundingClientRect(),O=dLe(T),R={chartX:Math.round(b.pageX-O.left),chartY:Math.round(b.pageY-O.top)},D=T.width/j.offsetWidth||1,L=this.inRange(R.chartX,R.chartY,D);if(!L)return null;var q=this.state,X=q.xAxisMap,H=q.yAxisMap,M=this.getTooltipEventType(),F=hB(this.state,this.props.data,this.props.layout,L);if(M!=="axis"&&X&&H){var S=Zd(X).scale,E=Zd(H).scale,N=S&&S.invert?S.invert(R.chartX):null,C=E&&E.invert?E.invert(R.chartY):null;return _t(_t({},R),{},{xValue:N,yValue:C},F)}return F?_t(_t({},R),F):null}},{key:"inRange",value:function(b,j){var T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,O=this.props.layout,R=b/T,D=j/T;if(O==="horizontal"||O==="vertical"){var L=this.state.offset,q=R>=L.left&&R<=L.left+L.width&&D>=L.top&&D<=L.top+L.height;return q?{x:R,y:D}:null}var X=this.state,H=X.angleAxisMap,M=X.radiusAxisMap;if(H&&M){var F=Zd(H);return BD({x:R,y:D},F)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,j=this.getTooltipEventType(),T=lo(b,Lo),O={};T&&j==="axis"&&(T.props.trigger==="click"?O={onClick:this.handleClick}:O={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var R=t2(this.props,this.handleOuterEvent);return _t(_t({},R),O)}},{key:"addListener",value:function(){V4.on(q4,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){V4.removeListener(q4,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,j,T){for(var O=this.state.formattedGraphicalItems,R=0,D=O.length;R<D;R++){var L=O[R];if(L.item===b||L.props.key===b.key||j===rd(L.item.type)&&T===L.childIndex)return L}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,j=this.state.offset,T=j.left,O=j.top,R=j.height,D=j.width;return we.createElement("defs",null,we.createElement("clipPath",{id:b},we.createElement("rect",{x:T,y:O,height:R,width:D})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(j,T){var O=cB(T,2),R=O[0],D=O[1];return _t(_t({},j),{},Pr({},R,D.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(j,T){var O=cB(T,2),R=O[0],D=O[1];return _t(_t({},j),{},Pr({},R,D.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var j;return(j=this.state.xAxisMap)===null||j===void 0||(j=j[b])===null||j===void 0?void 0:j.scale}},{key:"getYScaleByAxisId",value:function(b){var j;return(j=this.state.yAxisMap)===null||j===void 0||(j=j[b])===null||j===void 0?void 0:j.scale}},{key:"getItemByXY",value:function(b){var j=this.state,T=j.formattedGraphicalItems,O=j.activeItem;if(T&&T.length)for(var R=0,D=T.length;R<D;R++){var L=T[R],q=L.props,X=L.item,H=X.type.defaultProps!==void 0?_t(_t({},X.type.defaultProps),X.props):X.props,M=rd(X.type);if(M==="Bar"){var F=(q.data||[]).find(function(C){return Hqe(b,C)});if(F)return{graphicalItem:L,payload:F}}else if(M==="RadialBar"){var S=(q.data||[]).find(function(C){return BD(b,C)});if(S)return{graphicalItem:L,payload:S}}else if(rN(L,O)||nN(L,O)||Yv(L,O)){var E=MHe({graphicalItem:L,activeTooltipItem:O,itemData:H.data}),N=H.activeIndex===void 0?E:H.activeIndex;return{graphicalItem:_t(_t({},L),{},{childIndex:N}),payload:Yv(L,O)?H.data[E]:L.props.data[E]}}}return null}},{key:"render",value:function(){var b=this;if(!kI(this))return null;var j=this.props,T=j.children,O=j.className,R=j.width,D=j.height,L=j.style,q=j.compact,X=j.title,H=j.desc,M=dB(j,GYe),F=Sr(M,!1);if(q)return we.createElement(HL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},we.createElement(C5,Lm({},F,{width:R,height:D,title:X,desc:H}),this.renderClipPath(),TI(T,this.renderMap)));if(this.props.accessibilityLayer){var S,E;F.tabIndex=(S=this.props.tabIndex)!==null&&S!==void 0?S:0,F.role=(E=this.props.role)!==null&&E!==void 0?E:"application",F.onKeyDown=function(C){b.accessibilityManager.keyboardEvent(C)},F.onFocus=function(){b.accessibilityManager.focus()}}var N=this.parseEventsOfWrapper();return we.createElement(HL,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},we.createElement("div",Lm({className:Xr("recharts-wrapper",O),style:_t({position:"relative",cursor:"default",width:R,height:D},L)},N,{ref:function(k){b.container=k}}),we.createElement(C5,Lm({},F,{width:R,height:D,title:X,desc:H,style:dZe}),this.renderClipPath(),TI(T,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(P.Component);Pr(p,"displayName",r),Pr(p,"defaultProps",_t({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),Pr(p,"getDerivedStateFromProps",function(v,x){var y=v.dataKey,b=v.data,j=v.children,T=v.width,O=v.height,R=v.layout,D=v.stackOffset,L=v.margin,q=x.dataStartIndex,X=x.dataEndIndex;if(x.updateId===void 0){var H=fB(v);return _t(_t(_t({},H),{},{updateId:0},m(_t(_t({props:v},H),{},{updateId:0}),x)),{},{prevDataKey:y,prevData:b,prevWidth:T,prevHeight:O,prevLayout:R,prevStackOffset:D,prevMargin:L,prevChildren:j})}if(y!==x.prevDataKey||b!==x.prevData||T!==x.prevWidth||O!==x.prevHeight||R!==x.prevLayout||D!==x.prevStackOffset||!Jm(L,x.prevMargin)){var M=fB(v),F={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},S=_t(_t({},hB(x,b,R)),{},{updateId:x.updateId+1}),E=_t(_t(_t({},M),F),S);return _t(_t(_t({},E),m(_t({props:v},E),x)),{},{prevDataKey:y,prevData:b,prevWidth:T,prevHeight:O,prevLayout:R,prevStackOffset:D,prevMargin:L,prevChildren:j})}if(!N5(j,x.prevChildren)){var N,C,k,I,U=lo(j,Yp),$=U&&(N=(C=U.props)===null||C===void 0?void 0:C.startIndex)!==null&&N!==void 0?N:q,Y=U&&(k=(I=U.props)===null||I===void 0?void 0:I.endIndex)!==null&&k!==void 0?k:X,Z=$!==q||Y!==X,re=!Yr(b),G=re&&!Z?x.updateId:x.updateId+1;return _t(_t({updateId:G},m(_t(_t({props:v},x),{},{updateId:G,dataStartIndex:$,dataEndIndex:Y}),x)),{},{prevChildren:j,dataStartIndex:$,dataEndIndex:Y})}return null}),Pr(p,"renderActiveDot",function(v,x,y){var b;return P.isValidElement(v)?b=P.cloneElement(v,x):Lr(v)?b=v(x):b=we.createElement(Zj,x),we.createElement(bn,{className:"recharts-active-dot",key:y},b)});var g=P.forwardRef(function(x,y){return we.createElement(p,Lm({},x,{ref:y}))});return g.displayName=p.displayName,g},$ee=Bee({chartName:"PieChart",GraphicalChild:Dc,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:tN},{axisType:"radiusAxis",AxisComp:Jj}],formatAxisMap:iUe,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}}),bZe=Bee({chartName:"AreaChart",GraphicalChild:yd,axisComponents:[{axisType:"xAxis",AxisComp:cN},{axisType:"yAxis",AxisComp:dN}],formatAxisMap:hKe});function XE({data:e}){const t=s=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0,maximumFractionDigits:0}).format(s);if(e.length===0)return n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(_s,{className:"h-5 w-5 text-primary"}),"Evoluo das Vendas"]})}),n.jsx(Be,{children:n.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Nenhum dado de vendas para exibir"})})]});const r=({active:s,payload:a,label:i})=>s&&a&&a.length?n.jsxs("div",{className:"bg-background border rounded-lg shadow-lg p-3",children:[n.jsx("p",{className:"font-medium text-sm mb-2",children:i}),a.map((o,c)=>n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:o.color}}),n.jsxs("span",{className:"text-muted-foreground",children:[o.name,":"]}),n.jsx("span",{className:"font-medium",children:t(o.value)})]},c))]}):null;return n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(_s,{className:"h-5 w-5 text-primary"}),"Evoluo das Vendas"]})}),n.jsx(Be,{children:n.jsx("div",{className:"h-[300px] w-full",children:n.jsx(XA,{width:"100%",height:"100%",children:n.jsxs(bZe,{data:e,margin:{top:10,right:30,left:0,bottom:0},children:[n.jsxs("defs",{children:[n.jsxs("linearGradient",{id:"colorReservado",x1:"0",y1:"0",x2:"0",y2:"1",children:[n.jsx("stop",{offset:"5%",stopColor:"hsl(217, 91%, 60%)",stopOpacity:.3}),n.jsx("stop",{offset:"95%",stopColor:"hsl(217, 91%, 60%)",stopOpacity:0})]}),n.jsxs("linearGradient",{id:"colorPago",x1:"0",y1:"0",x2:"0",y2:"1",children:[n.jsx("stop",{offset:"5%",stopColor:"hsl(142, 76%, 36%)",stopOpacity:.4}),n.jsx("stop",{offset:"95%",stopColor:"hsl(142, 76%, 36%)",stopOpacity:0})]})]}),n.jsx(yee,{strokeDasharray:"3 3",className:"stroke-muted"}),n.jsx(cN,{dataKey:"time",tick:{fontSize:12},tickLine:!1,axisLine:!1,className:"text-muted-foreground"}),n.jsx(dN,{tick:{fontSize:12},tickLine:!1,axisLine:!1,tickFormatter:s=>t(s),className:"text-muted-foreground",width:80}),n.jsx(Lo,{content:n.jsx(r,{})}),n.jsx(Xh,{verticalAlign:"top",height:36,formatter:s=>n.jsx("span",{className:"text-sm text-foreground",children:s})}),n.jsx(yd,{type:"monotone",dataKey:"reservadoAcumulado",name:"Total Reservado",stroke:"hsl(217, 91%, 60%)",strokeWidth:2,fillOpacity:1,fill:"url(#colorReservado)"}),n.jsx(yd,{type:"monotone",dataKey:"pagoAcumulado",name:"Total Pago",stroke:"hsl(142, 76%, 36%)",strokeWidth:2,fillOpacity:1,fill:"url(#colorPago)"})]})})})})]})}function wZe(){const{eventId:e}=ra(),t=fr(),{event:r,kpis:s,funnel:a,sellerPerformance:i,insights:o,topProducts:c,customerSales:d,timelineData:l,isLoading:u,refetch:h}=$5e(e);if(u)return n.jsx("div",{className:"min-h-screen bg-background p-4 md:p-6",children:n.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[n.jsx(Kr,{className:"h-10 w-64"}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[...Array(6)].map((p,g)=>n.jsx(Kr,{className:"h-24"},g))}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(Kr,{className:"h-80"}),n.jsx(Kr,{className:"h-80"})]})]})});if(!r)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(af,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Live no encontrada"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"O evento solicitado no existe."}),n.jsxs(he,{variant:"outline",onClick:()=>t("/dashboard"),children:[n.jsx(vs,{className:"h-4 w-4 mr-2"}),"Voltar ao Dashboard"]})]})});const f={planejada:{label:"Planejada",color:"bg-blue-100 text-blue-700"},ao_vivo:{label:"Ao Vivo",color:"bg-red-100 text-red-700 animate-pulse"},encerrada:{label:"Encerrada",color:"bg-muted text-muted-foreground"},arquivada:{label:"Arquivada",color:"bg-secondary text-secondary-foreground"}},m=f[r.status]||f.encerrada;return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>t("/dashboard"),children:n.jsx(vs,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("h1",{className:"text-lg font-semibold",children:r.titulo}),n.jsx(Ae,{className:m.color,children:m.label})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(is,{className:"h-3.5 w-3.5"}),Ht(new Date(r.data_hora_inicio),"dd 'de' MMMM 's' HH:mm",{locale:gr}),r.data_hora_fim&&n.jsxs(n.Fragment,{children:["  ",Ht(new Date(r.data_hora_fim),"HH:mm",{locale:gr})]})]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${r.id}/pedidos`),children:[n.jsx(Ut,{className:"h-4 w-4 mr-2"}),"Pedidos"]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${r.id}/separacao`),children:[n.jsx(wae,{className:"h-4 w-4 mr-2"}),"Separao"]}),r.status!=="ao_vivo"&&n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${r.id}/backstage`),children:[n.jsx(Ts,{className:"h-4 w-4 mr-2"}),"Backstage"]}),n.jsx(he,{variant:"outline",size:"icon",onClick:()=>h(),children:n.jsx(en,{className:"h-4 w-4"})})]})]})}),n.jsxs("main",{className:"max-w-7xl mx-auto p-4 md:p-6 space-y-6",children:[s&&n.jsx(F5e,{kpis:s}),n.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[n.jsx(z5e,{funnel:a}),n.jsx(V5e,{insights:o})]}),n.jsx(U5e,{sellers:i}),n.jsx(XE,{data:l}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(w5,{products:c}),n.jsx(q5e,{sales:d,onRefresh:h})]})]})]})}function _Ze(){const e=fr();ra();const[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await ce.auth.getSession();if(!a){e("/login");return}const{data:i}=await ce.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(c=>["merchant","admin"].includes(c.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsx(wZe,{})}function pB(e,t){const[r,s]=P.useState([]),[a,i]=P.useState(null),[o,c]=P.useState([]),[d,l]=P.useState([]),[u,h]=P.useState(!1),f=P.useCallback(async()=>{if(!(!e||!t)){h(!0);try{const m=new Date(t);m.setHours(23,59,59,999);const{data:p,error:g}=await ce.from("live_events").select("*").gte("data_hora_inicio",e.toISOString()).lte("data_hora_inicio",m.toISOString()).order("data_hora_inicio",{ascending:!1});if(g)throw g;if(!p||p.length===0){s([]),i(null),c([]),l([]),h(!1);return}const v=p.map(Y=>Y.id),{data:x,error:y}=await ce.from("live_carts").select(`
          *,
          live_customer:live_customers(*),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color)
          )
        `).in("live_event_id",v);if(y)throw y;const b=x||[],j=new Map;b.forEach(Y=>{const Z=j.get(Y.live_event_id)||[];Z.push(Y),j.set(Y.live_event_id,Z)});const T=p.map(Y=>{const Z=j.get(Y.id)||[],re=Z.filter(J=>!["cancelado","expirado"].includes(J.status)),G=Z.filter(J=>J.status==="pago");return{id:Y.id,titulo:Y.titulo,data_hora_inicio:Y.data_hora_inicio,data_hora_fim:Y.data_hora_fim,status:Y.status,totalReservado:re.reduce((J,V)=>J+V.total,0),totalPago:G.reduce((J,V)=>J+V.total,0),totalCarrinhos:Z.length,carrinhosPagos:G.length}});s(T);const O=b.filter(Y=>Y.status==="pago"),R=b.filter(Y=>Y.status==="aguardando_pagamento"||Y.status==="em_confirmacao"),D=b.filter(Y=>Y.status==="aberto"),L=b.filter(Y=>!["cancelado","expirado"].includes(Y.status)),q=L.reduce((Y,Z)=>Y+Z.total,0),X=O.reduce((Y,Z)=>Y+Z.total,0);let H=0;L.forEach(Y=>{(Y.items||[]).forEach(Z=>{["reservado","confirmado"].includes(Z.status)&&(H+=Z.qtd)})});let M=0;O.forEach(Y=>{(Y.items||[]).forEach(Z=>{Z.status==="confirmado"&&(M+=Z.qtd)})});let F=0;p.forEach(Y=>{Y.data_hora_fim&&Y.data_hora_inicio&&(F+=Math.round((new Date(Y.data_hora_fim).getTime()-new Date(Y.data_hora_inicio).getTime())/6e4))});const S={totalReservado:q,totalItensReservados:H,ticketMedioReservado:L.length>0?q/L.length:0,totalPago:X,totalItensPagos:M,ticketMedioPago:O.length>0?X/O.length:0,totalCarrinhos:b.length,carrinhosAbertos:D.length,carrinhosAguardando:R.length,carrinhosPagos:O.length,taxaConversao:b.length>0?O.length/b.length*100:0,taxaPagamento:q>0?X/q*100:0,duracaoMinutos:F,vendasPorHora:F>0?q/(F/60):q};i(S);const E=new Map;O.forEach(Y=>{(Y.items||[]).forEach(Z=>{if(Z.status==="confirmado"&&Z.product){const re=E.get(Z.product_id);re?(re.quantidadeVendida+=Z.qtd,re.valorTotal+=Z.preco_unitario*Z.qtd):E.set(Z.product_id,{productId:Z.product_id,productName:Z.product.name,productImage:Z.product.image_url,productColor:Z.product.color,quantidadeVendida:Z.qtd,valorTotal:Z.preco_unitario*Z.qtd})}})});const N=Array.from(E.values()).sort((Y,Z)=>Z.valorTotal-Y.valorTotal);c(N);const C=new Map;b.forEach(Y=>{const Z=Y.status==="pago";if(!!["cancelado","expirado"].includes(Y.status))return;const G=new Date(Y.created_at).toISOString().split("T")[0],J=C.get(G)||{reservado:0,pago:0};J.reservado+=Y.total,Z&&(J.pago+=Y.total),C.set(G,J)});const k=Array.from(C.entries()).sort((Y,Z)=>Y[0].localeCompare(Z[0]));let I=0,U=0;const $=k.map(([Y,Z])=>{I+=Z.reservado,U+=Z.pago;const re=new Date(Y);return{time:re.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"}),timestamp:re.getTime(),reservadoAcumulado:I,pagoAcumulado:U,reservadoMomento:Z.reservado}});l($)}catch(m){console.error("Error fetching period report data:",m)}finally{h(!1)}}},[e,t]);return P.useEffect(()=>{e&&t&&f()},[f,e,t]),{events:r,kpis:a,topProducts:o,timelineData:d,isLoading:u,totalEvents:r.length,refetch:f}}function gB({kpis:e}){const t=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a),r=a=>{const i=Math.floor(a/60),o=a%60;return i>0?`${i}h ${o}min`:`${o}min`},s=[{title:"Total Reservado",value:t(e.totalReservado),subtitle:`${e.totalItensReservados} itens em ${e.totalCarrinhos-e.carrinhosPagos} carrinhos`,icon:zi,iconBg:"bg-blue-100",iconColor:"text-blue-600",highlight:!0},{title:"Total Pago",value:t(e.totalPago),subtitle:`${e.carrinhosPagos} vendas confirmadas`,icon:Er,iconBg:"bg-green-100",iconColor:"text-green-600"},{title:"Ticket Mdio",value:t(e.ticketMedioReservado),subtitle:"Por carrinho",icon:xs,iconBg:"bg-purple-100",iconColor:"text-purple-600"},{title:"Taxa de Converso",value:`${e.taxaConversao.toFixed(1)}%`,subtitle:`${e.carrinhosPagos} de ${e.totalCarrinhos} carrinhos`,icon:ba,iconBg:"bg-orange-100",iconColor:"text-orange-600"},{title:"Vendas por Hora",value:t(e.vendasPorHora),subtitle:e.duracaoMinutos>0?r(e.duracaoMinutos):"Durao no registrada",icon:_s,iconBg:"bg-amber-100",iconColor:"text-amber-600"},{title:"Taxa de Pagamento",value:`${e.taxaPagamento.toFixed(1)}%`,subtitle:"Valor pago vs. reservado",icon:ws,iconBg:"bg-teal-100",iconColor:"text-teal-600"}];return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsx(De,{className:"relative overflow-hidden border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-white",children:n.jsxs(Be,{className:"p-5",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsx("div",{className:"p-2.5 rounded-lg bg-blue-100",children:n.jsx(zi,{className:"h-5 w-5 text-blue-600"})}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded-full",children:[n.jsx(Br,{className:"h-3 w-3"}),n.jsxs("span",{children:[e.carrinhosAbertos+e.carrinhosAguardando," pendentes"]})]})]}),n.jsx("div",{className:"text-3xl font-bold tracking-tight text-blue-700",children:t(e.totalReservado)}),n.jsx("div",{className:"text-sm font-medium text-blue-600 mt-1",children:"Total Reservado na Live"}),n.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[e.totalItensReservados," itens  ",e.totalCarrinhos," carrinhos"]})]})}),n.jsx(De,{className:"relative overflow-hidden border-2 border-green-200 bg-gradient-to-br from-green-50 to-white",children:n.jsxs(Be,{className:"p-5",children:[n.jsxs("div",{className:"flex items-start justify-between mb-3",children:[n.jsx("div",{className:"p-2.5 rounded-lg bg-green-100",children:n.jsx(Er,{className:"h-5 w-5 text-green-600"})}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 bg-green-100 px-2 py-1 rounded-full",children:[n.jsx(Er,{className:"h-3 w-3"}),n.jsxs("span",{children:[e.carrinhosPagos," pagos"]})]})]}),n.jsx("div",{className:"text-3xl font-bold tracking-tight text-green-700",children:t(e.totalPago)}),n.jsx("div",{className:"text-sm font-medium text-green-600 mt-1",children:"Total Pago"}),n.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[e.totalItensPagos," itens confirmados  Ticket mdio: ",t(e.ticketMedioPago)]})]})})]}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.slice(2).map((a,i)=>n.jsx(De,{className:"relative overflow-hidden",children:n.jsxs(Be,{className:"p-4",children:[n.jsx("div",{className:"flex items-start justify-between mb-2",children:n.jsx("div",{className:`p-2 rounded-lg ${a.iconBg}`,children:n.jsx(a.icon,{className:`h-4 w-4 ${a.iconColor}`})})}),n.jsx("div",{className:"text-2xl font-bold tracking-tight",children:a.value}),n.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:a.title}),n.jsx("div",{className:"text-xs text-muted-foreground/70 mt-0.5",children:a.subtitle})]})},i))})]})}function YE(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function Mo(e,t){return t===0?e>0?100:0:(e-t)/t*100}function jZe({variation:e,inverted:t=!1}){const r=t?e<0:e>0;return Math.abs(e)<.5?n.jsxs(Ae,{variant:"secondary",className:"gap-1 text-xs",children:[n.jsx(vp,{className:"h-3 w-3"}),"0%"]}):n.jsxs(Ae,{variant:"secondary",className:We("gap-1 text-xs",r?"bg-green-100 text-green-700 hover:bg-green-100":"bg-red-100 text-red-700 hover:bg-red-100"),children:[r?n.jsx(Vz,{className:"h-3 w-3"}):n.jsx(rae,{className:"h-3 w-3"}),e>0?"+":"",e.toFixed(1),"%"]})}function NZe({label:e,currentValue:t,previousValue:r,variation:s,formatAsPrice:a=!1,formatAsPercent:i=!1,inverted:o=!1}){const c=d=>typeof d=="string"?d:a?YE(d):i?`${d.toFixed(1)}%`:d.toLocaleString("pt-BR");return n.jsxs("div",{className:"grid grid-cols-4 gap-2 py-2 border-b last:border-0 items-center",children:[n.jsx("div",{className:"text-sm text-muted-foreground font-medium",children:e}),n.jsx("div",{className:"text-right font-semibold",children:c(t)}),n.jsx("div",{className:"text-right text-muted-foreground",children:c(r)}),n.jsx("div",{className:"flex justify-end",children:n.jsx(jZe,{variation:s,inverted:o})})]})}function SZe({data:e}){const{current:t,previous:r,currentEvents:s,previousEvents:a,currentLabel:i,previousLabel:o}=e;if(!t||!r)return n.jsx(De,{children:n.jsx(Be,{className:"py-8 text-center text-muted-foreground",children:"Selecione dois perodos com dados para visualizar a comparao."})});const c=[{label:"Total de Lives",current:s,previous:a,variation:Mo(s,a)},{label:"Faturamento Pago",current:t.totalPago,previous:r.totalPago,variation:Mo(t.totalPago,r.totalPago),formatAsPrice:!0},{label:"Total Reservado",current:t.totalReservado,previous:r.totalReservado,variation:Mo(t.totalReservado,r.totalReservado),formatAsPrice:!0},{label:"Ticket Mdio",current:t.ticketMedioPago,previous:r.ticketMedioPago,variation:Mo(t.ticketMedioPago,r.ticketMedioPago),formatAsPrice:!0},{label:"Total de Carrinhos",current:t.totalCarrinhos,previous:r.totalCarrinhos,variation:Mo(t.totalCarrinhos,r.totalCarrinhos)},{label:"Carrinhos Pagos",current:t.carrinhosPagos,previous:r.carrinhosPagos,variation:Mo(t.carrinhosPagos,r.carrinhosPagos)},{label:"Itens Vendidos",current:t.totalItensPagos,previous:r.totalItensPagos,variation:Mo(t.totalItensPagos,r.totalItensPagos)},{label:"Taxa de Converso",current:t.taxaConversao,previous:r.taxaConversao,variation:Mo(t.taxaConversao,r.taxaConversao),formatAsPercent:!0},{label:"Taxa de Pagamento",current:t.taxaPagamento,previous:r.taxaPagamento,variation:Mo(t.taxaPagamento,r.taxaPagamento),formatAsPercent:!0},{label:"Horas de Live",current:(t.duracaoMinutos/60).toFixed(1)+"h",previous:(r.duracaoMinutos/60).toFixed(1)+"h",variation:Mo(t.duracaoMinutos,r.duracaoMinutos)}],d=Mo(t.totalPago,r.totalPago),l=Mo(t.taxaConversao,r.taxaConversao);return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsx(De,{className:We("border-2",d>0?"border-green-200 bg-green-50/50":d<0?"border-red-200 bg-red-50/50":"border-muted"),children:n.jsxs(Be,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Crescimento Faturamento"}),n.jsxs("p",{className:We("text-2xl font-bold",d>0?"text-green-600":d<0?"text-red-600":""),children:[d>0?"+":"",d.toFixed(1),"%"]})]}),d>0?n.jsx(_s,{className:"h-8 w-8 text-green-500"}):d<0?n.jsx(qx,{className:"h-8 w-8 text-red-500"}):n.jsx(vp,{className:"h-8 w-8 text-muted-foreground"})]}),n.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[YE(t.totalPago)," vs ",YE(r.totalPago)]})]})}),n.jsx(De,{className:We("border-2",l>0?"border-green-200 bg-green-50/50":l<0?"border-red-200 bg-red-50/50":"border-muted"),children:n.jsxs(Be,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Evoluo da Converso"}),n.jsxs("p",{className:We("text-2xl font-bold",l>0?"text-green-600":l<0?"text-red-600":""),children:[l>0?"+":"",l.toFixed(1),"%"]})]}),l>0?n.jsx(_s,{className:"h-8 w-8 text-green-500"}):l<0?n.jsx(qx,{className:"h-8 w-8 text-red-500"}):n.jsx(vp,{className:"h-8 w-8 text-muted-foreground"})]}),n.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:[t.taxaConversao.toFixed(1),"% vs ",r.taxaConversao.toFixed(1),"%"]})]})}),n.jsx(De,{className:"border-2 border-primary/20 bg-primary/5",children:n.jsx(Be,{className:"pt-4",children:n.jsx("div",{className:"flex items-center justify-between",children:n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Comparando"}),n.jsx("p",{className:"text-lg font-semibold",children:i}),n.jsxs("p",{className:"text-sm text-muted-foreground",children:["vs ",o]})]})})})})]}),n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-base flex items-center gap-2",children:[n.jsx(_s,{className:"h-4 w-4 text-primary"}),"Comparativo Detalhado"]})}),n.jsxs(Be,{children:[n.jsxs("div",{className:"grid grid-cols-4 gap-2 py-2 border-b-2 text-sm font-medium text-muted-foreground",children:[n.jsx("div",{children:"Mtrica"}),n.jsx("div",{className:"text-right",children:i}),n.jsx("div",{className:"text-right",children:o}),n.jsx("div",{className:"text-right",children:"Variao"})]}),c.map((u,h)=>n.jsx(NZe,{label:u.label,currentValue:u.current,previousValue:u.previous,variation:u.variation,formatAsPrice:u.formatAsPrice,formatAsPercent:u.formatAsPercent},h))]})]})]})}const ph=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),Fee=e=>Ht(new Date(e),"dd/MM/yyyy HH:mm",{locale:gr}),xB=e=>`${e.toFixed(1)}%`;async function CZe(e,t){const r=await e.xlsx.writeBuffer(),s=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.download=t,i.click(),window.URL.revokeObjectURL(a)}function EZe(e){const{events:t,kpis:r,topProducts:s,startDate:a,endDate:i}=e,o=`${Ht(a,"dd-MM-yyyy")}_a_${Ht(i,"dd-MM-yyyy")}`;let c="";c+=`Relatrio de Lives - ${Ht(a,"dd/MM/yyyy")} a ${Ht(i,"dd/MM/yyyy")}

`,c+=`=== RESUMO DO PERODO ===
`,r&&(c+=`Total Reservado;${ph(r.totalReservado)}
`,c+=`Total Pago;${ph(r.totalPago)}
`,c+=`Itens Reservados;${r.totalItensReservados}
`,c+=`Itens Pagos;${r.totalItensPagos}
`,c+=`Ticket Mdio;${ph(r.ticketMedioPago)}
`,c+=`Total de Carrinhos;${r.totalCarrinhos}
`,c+=`Carrinhos Pagos;${r.carrinhosPagos}
`,c+=`Taxa de Converso;${xB(r.taxaConversao)}
`,c+=`Taxa de Pagamento;${xB(r.taxaPagamento)}
`,c+=`Durao Total;${(r.duracaoMinutos/60).toFixed(1)} horas
`,c+=`Vendas por Hora;${ph(r.vendasPorHora)}
`),c+=`
`,c+=`=== LIVES NO PERODO ===
`,c+=`Ttulo;Data/Hora Incio;Status;Total Reservado;Total Pago;Carrinhos;Carrinhos Pagos
`,t.forEach(h=>{c+=`${h.titulo};${Fee(h.data_hora_inicio)};${h.status};${ph(h.totalReservado)};${ph(h.totalPago)};${h.totalCarrinhos};${h.carrinhosPagos}
`}),c+=`
`,c+=`=== TOP PRODUTOS ===
`,c+=`Produto;Cor;Quantidade Vendida;Valor Total
`,s.forEach(h=>{c+=`${h.productName};${h.productColor||"-"};${h.quantidadeVendida};${ph(h.valorTotal)}
`});const d=new Blob(["\uFEFF"+c],{type:"text/csv;charset=utf-8;"}),l=window.URL.createObjectURL(d),u=document.createElement("a");u.href=l,u.download=`relatorio_lives_${o}.csv`,u.click(),window.URL.revokeObjectURL(l)}async function kZe(e){const{events:t,kpis:r,topProducts:s,startDate:a,endDate:i}=e,o=`${Ht(a,"dd-MM-yyyy")}_a_${Ht(i,"dd-MM-yyyy")}`,c=new mv.Workbook,d=c.addWorksheet("Resumo");d.columns=[{width:25},{width:20}],d.addRow(["RELATRIO DE LIVES POR PERODO"]),d.addRow([`Perodo: ${Ht(a,"dd/MM/yyyy")} a ${Ht(i,"dd/MM/yyyy")}`]),d.addRow([]),d.addRow(["INDICADOR","VALOR"]),r&&(d.addRow(["Total de Lives",t.length]),d.addRow(["Total Reservado",r.totalReservado]),d.addRow(["Total Pago",r.totalPago]),d.addRow(["Itens Reservados",r.totalItensReservados]),d.addRow(["Itens Pagos",r.totalItensPagos]),d.addRow(["Ticket Mdio Reservado",r.ticketMedioReservado]),d.addRow(["Ticket Mdio Pago",r.ticketMedioPago]),d.addRow(["Total de Carrinhos",r.totalCarrinhos]),d.addRow(["Carrinhos Abertos",r.carrinhosAbertos]),d.addRow(["Carrinhos Aguardando",r.carrinhosAguardando]),d.addRow(["Carrinhos Pagos",r.carrinhosPagos]),d.addRow(["Taxa de Converso (%)",r.taxaConversao]),d.addRow(["Taxa de Pagamento (%)",r.taxaPagamento]),d.addRow(["Durao Total (min)",r.duracaoMinutos]),d.addRow(["Vendas por Hora",r.vendasPorHora]));const l=c.addWorksheet("Lives");l.columns=[{width:30},{width:18},{width:12},{width:18},{width:15},{width:12},{width:15},{width:18}],l.addRow(["TTULO","DATA/HORA","STATUS","TOTAL RESERVADO","TOTAL PAGO","CARRINHOS","CARRINHOS PAGOS","TAXA CONVERSO (%)"]),t.forEach(h=>{const f=h.totalCarrinhos>0?h.carrinhosPagos/h.totalCarrinhos*100:0;l.addRow([h.titulo,Fee(h.data_hora_inicio),h.status,h.totalReservado,h.totalPago,h.totalCarrinhos,h.carrinhosPagos,Number(f.toFixed(1))])});const u=c.addWorksheet("Produtos");u.columns=[{width:40},{width:15},{width:20},{width:18}],u.addRow(["PRODUTO","COR","QUANTIDADE VENDIDA","VALOR TOTAL"]),s.forEach(h=>{u.addRow([h.productName,h.productColor||"-",h.quantidadeVendida,h.valorTotal])}),await CZe(c,`relatorio_lives_${o}.xlsx`)}function AZe(e,t,r){const s=t.getTime()-e.getTime();switch(r){case"previousPeriod":return{start:new Date(e.getTime()-s-864e5),end:new Date(e.getTime()-864e5)};case"previousMonth":return{start:uo(e,1),end:uo(t,1)};case"previousYear":return{start:pM(e,1),end:pM(t,1)};default:return{start:uo(e,1),end:uo(t,1)}}}function TZe(e){switch(e){case"previousPeriod":return"Perodo anterior";case"previousMonth":return"Ms anterior";case"previousYear":return"Ano anterior";default:return"Perodo anterior"}}function vB({totalEvents:e,kpis:t,formatPrice:r}){return n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx(De,{children:n.jsxs(Be,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(Ts,{className:"h-4 w-4"}),"Total de Lives"]}),n.jsx("div",{className:"text-2xl font-bold",children:e})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(ws,{className:"h-4 w-4"}),"Mdia por Live"]}),n.jsx("div",{className:"text-2xl font-bold",children:r(t?t.totalPago/e:0)})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(zi,{className:"h-4 w-4"}),"Carrinhos/Live"]}),n.jsx("div",{className:"text-2xl font-bold",children:t?(t.totalCarrinhos/e).toFixed(1):0})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"pt-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-sm mb-1",children:[n.jsx(_s,{className:"h-4 w-4"}),"Horas de Live"]}),n.jsxs("div",{className:"text-2xl font-bold",children:[t?(t.duracaoMinutos/60).toFixed(1):0,"h"]})]})})]})}function yB({events:e,statusLabels:t,formatPrice:r,navigate:s}){return n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(Ts,{className:"h-5 w-5 text-primary"}),"Lives no Perodo"]})}),n.jsx(Be,{className:"space-y-2 max-h-[400px] overflow-y-auto",children:e.map(a=>{const i=t[a.status]||t.encerrada;return n.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg border hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>s(`/dashboard/lives/${a.id}/relatorio`),children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("div",{className:"font-medium truncate",children:a.titulo}),n.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[n.jsx(is,{className:"h-3 w-3"}),Ht(new Date(a.data_hora_inicio),"dd/MM/yyyy HH:mm",{locale:gr})]})]}),n.jsxs("div",{className:"text-right shrink-0",children:[n.jsx("div",{className:"font-semibold text-green-600",children:r(a.totalPago)}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.carrinhosPagos,"/",a.totalCarrinhos," pagos"]})]}),n.jsx(Ae,{className:i.color,children:i.label})]},a.id)})})]})}function PZe(){const e=fr(),[t,r]=P.useState("30d"),[s,a]=P.useState(()=>mn(new Date,30)),[i,o]=P.useState(()=>new Date),[c,d]=P.useState(!1),[l,u]=P.useState("previousPeriod"),[h,f]=P.useState("overview"),{events:m,kpis:p,topProducts:g,timelineData:v,isLoading:x,totalEvents:y}=pB(s,i),b=s&&i?AZe(s,i,l):{start:void 0,end:void 0},{kpis:j,totalEvents:T,isLoading:O}=pB(c?b.start:void 0,c?b.end:void 0),R=F=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(F),D=F=>{r(F);const S=new Date;switch(F){case"7d":a(mn(S,7)),o(S);break;case"30d":a(mn(S,30)),o(S);break;case"thisMonth":a(Ps(S)),o(fc(S));break;case"lastMonth":const E=uo(S,1);a(Ps(E)),o(fc(E));break;case"thisYear":a(g8(S)),o(jve(S));break}},L={planejada:{label:"Planejada",color:"bg-blue-100 text-blue-700"},ao_vivo:{label:"Ao Vivo",color:"bg-red-100 text-red-700"},encerrada:{label:"Encerrada",color:"bg-muted text-muted-foreground"},arquivada:{label:"Arquivada",color:"bg-secondary text-secondary-foreground"}},q=s&&i?`${Ht(s,"dd/MM",{locale:gr})} - ${Ht(i,"dd/MM",{locale:gr})}`:"Perodo atual",X=b.start&&b.end?`${Ht(b.start,"dd/MM",{locale:gr})} - ${Ht(b.end,"dd/MM",{locale:gr})}`:TZe(l),H=()=>{!s||!i||EZe({events:m,kpis:p,topProducts:g,startDate:s,endDate:i})},M=()=>{!s||!i||kZe({events:m,kpis:p,topProducts:g,startDate:s,endDate:i})};return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>e("/dashboard"),children:n.jsx(vs,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Pl,{className:"h-5 w-5 text-primary"}),n.jsx("h1",{className:"text-lg font-semibold",children:"Relatrio de Lives por Perodo"})]}),n.jsx("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:s&&i&&n.jsxs(n.Fragment,{children:[n.jsx(is,{className:"h-3.5 w-3.5"}),Ht(s,"dd/MM/yyyy",{locale:gr}),"  ",Ht(i,"dd/MM/yyyy",{locale:gr}),n.jsxs("span",{className:"text-primary font-medium",children:["(",y," lives)"]})]})})]})]}),y>0&&n.jsxs(L1,{children:[n.jsx(B1,{asChild:!0,children:n.jsxs(he,{variant:"outline",size:"sm",children:[n.jsx(Af,{className:"h-4 w-4 mr-2"}),"Exportar"]})}),n.jsxs(Ig,{align:"end",children:[n.jsxs(po,{onClick:M,children:[n.jsx(sf,{className:"h-4 w-4 mr-2"}),"Excel (.xlsx)"]}),n.jsxs(po,{onClick:H,children:[n.jsx(af,{className:"h-4 w-4 mr-2"}),"CSV (.csv)"]})]})]})]})}),n.jsxs("main",{className:"max-w-7xl mx-auto p-4 md:p-6 space-y-6",children:[n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-3",children:n.jsxs(Mt,{className:"flex items-center gap-2 text-base",children:[n.jsx(wd,{className:"h-4 w-4"}),"Filtrar Perodo"]})}),n.jsx(Be,{children:n.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[n.jsxs(Kt,{value:t,onValueChange:F=>D(F),children:[n.jsx(Vt,{className:"w-[180px]",children:n.jsx(Xt,{placeholder:"Selecione o perodo"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"7d",children:"ltimos 7 dias"}),n.jsx(ze,{value:"30d",children:"ltimos 30 dias"}),n.jsx(ze,{value:"thisMonth",children:"Este ms"}),n.jsx(ze,{value:"lastMonth",children:"Ms passado"}),n.jsx(ze,{value:"thisYear",children:"Este ano"}),n.jsx(ze,{value:"custom",children:"Personalizado"})]})]}),t==="custom"&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("w-[140px] justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),s?Ht(s,"dd/MM/yyyy"):"Incio"]})}),n.jsx(Za,{className:"w-auto p-0",align:"start",children:n.jsx(Ti,{mode:"single",selected:s,onSelect:a,initialFocus:!0,className:We("p-3 pointer-events-auto")})})]}),n.jsx("span",{className:"text-muted-foreground",children:"at"}),n.jsxs(hi,{children:[n.jsx(fi,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:We("w-[140px] justify-start text-left font-normal",!i&&"text-muted-foreground"),children:[n.jsx(is,{className:"mr-2 h-4 w-4"}),i?Ht(i,"dd/MM/yyyy"):"Fim"]})}),n.jsx(Za,{className:"w-auto p-0",align:"start",children:n.jsx(Ti,{mode:"single",selected:i,onSelect:o,initialFocus:!0,className:We("p-3 pointer-events-auto")})})]})]})]})})]}),n.jsx(De,{children:n.jsx(Be,{className:"py-4",children:n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(di,{id:"comparison-mode",checked:c,onCheckedChange:F=>{d(F),f(F?"comparison":"overview")}}),n.jsxs(Le,{htmlFor:"comparison-mode",className:"flex items-center gap-2 cursor-pointer",children:[n.jsx(fO,{className:"h-4 w-4 text-primary"}),"Comparar com outro perodo"]})]}),c&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Comparar com:"}),n.jsxs(Kt,{value:l,onValueChange:F=>u(F),children:[n.jsx(Vt,{className:"w-[180px]",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"previousPeriod",children:"Perodo anterior"}),n.jsx(ze,{value:"previousMonth",children:"Mesmo perodo ms anterior"}),n.jsx(ze,{value:"previousYear",children:"Mesmo perodo ano anterior"})]})]}),b.start&&b.end&&n.jsxs(Ae,{variant:"secondary",className:"text-xs",children:[Ht(b.start,"dd/MM",{locale:gr})," - ",Ht(b.end,"dd/MM",{locale:gr})]})]})]})})}),x||c&&O?n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[...Array(6)].map((F,S)=>n.jsx(Kr,{className:"h-32"},S))}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(Kr,{className:"h-96"}),n.jsx(Kr,{className:"h-96"})]})]}):y===0?n.jsx(De,{className:"py-12",children:n.jsxs(Be,{className:"text-center",children:[n.jsx(Ts,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Nenhuma live encontrada"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:"No h lives registradas no perodo selecionado."}),n.jsx(he,{variant:"outline",onClick:()=>D("thisYear"),children:"Ver todo o ano"})]})}):c?n.jsxs(pi,{value:h,onValueChange:F=>f(F),children:[n.jsxs(Qa,{className:"mb-4",children:[n.jsx(pr,{value:"overview",children:"Viso Geral"}),n.jsxs(pr,{value:"comparison",children:[n.jsx(fO,{className:"h-4 w-4 mr-1"}),"Comparativo"]})]}),n.jsx(wr,{value:"comparison",children:n.jsx(SZe,{data:{current:p,previous:j,currentEvents:y,previousEvents:T,currentLabel:q,previousLabel:X}})}),n.jsx(wr,{value:"overview",children:n.jsxs("div",{className:"space-y-6",children:[p&&n.jsx(gB,{kpis:p}),n.jsx(vB,{totalEvents:y,kpis:p,formatPrice:R}),n.jsx(XE,{data:v}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(w5,{products:g}),n.jsx(yB,{events:m,statusLabels:L,formatPrice:R,navigate:e})]})]})})]}):n.jsxs(n.Fragment,{children:[p&&n.jsx(gB,{kpis:p}),n.jsx(vB,{totalEvents:y,kpis:p,formatPrice:R}),n.jsx(XE,{data:v}),n.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[n.jsx(w5,{products:g}),n.jsx(yB,{events:m,statusLabels:L,formatPrice:R,navigate:e})]}),p&&p.totalReservado>0&&n.jsxs("div",{className:"bg-gradient-to-r from-primary/10 via-primary/5 to-transparent rounded-xl p-6",children:[n.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Resumo do Perodo"}),n.jsxs("div",{className:"grid sm:grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Total de Lives:"}),n.jsx("div",{className:"font-bold text-lg",children:y})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Total Reservado:"}),n.jsx("div",{className:"font-bold text-lg",children:R(p.totalReservado)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Total Pago:"}),n.jsx("div",{className:"font-bold text-lg text-green-600",children:R(p.totalPago)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Itens Vendidos:"}),n.jsxs("div",{className:"font-bold text-lg",children:[p.totalItensPagos," unidades"]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-muted-foreground",children:"Taxa de Pagamento:"}),n.jsxs("div",{className:"font-bold text-lg",children:[p.taxaPagamento.toFixed(1),"%"]})]})]})]})]})]})]})}function OZe(){const e=fr(),[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await ce.auth.getSession();if(!a){e("/login");return}const{data:i}=await ce.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(c=>["merchant","admin"].includes(c.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsx(PZe,{})}function RZe(e){const[t,r]=P.useState([]),[s,a]=P.useState([]),[i,o]=P.useState({totalBags:0,bagsSeparated:0,bagsPending:0,bagsAttention:0,bagsCancelled:0,itemsCancelled:0,separationPercentage:0}),[c,d]=P.useState(!0),[l,u]=P.useState(!1),h=P.useRef(!0),f=P.useRef([]),m=P.useCallback(async()=>{if(e){d(!0);try{const{data:M,error:F}=await ce.from("live_carts").select(`
          *,
          live_customer:live_customers(id, instagram_handle, nome, whatsapp),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color, sku)
          ),
          gifts:order_gifts(
            id,
            gift_id,
            qty,
            status,
            separation_confirmed,
            applied_by_rule_id,
            applied_by_raffle_id,
            gift:gifts(id, name, image_url, sku)
          ),
          attention_logs:live_attention_log(
            id,
            attention_type,
            product_id,
            product_name,
            size,
            quantity,
            origin_bag_number,
            destination_bag_number,
            destination_instagram,
            payload,
            resolved_at,
            resolved_by,
            created_at
          )
        `).eq("live_event_id",e).order("bag_number",{ascending:!0,nullsFirst:!1});if(F)throw F;const S=(M||[]).filter(C=>!!C.bag_number).filter(C=>Array.isArray(C.items)&&C.items.length>0).filter(C=>C.status!=="cancelado"&&C.status!=="pago").filter(C=>(C.items||[]).filter(I=>["reservado","confirmado"].includes(I.status)).length===0).filter(C=>{const k=!!C.label_printed_at,I=C.separation_status==="separado",U=C.status==="etiqueta_gerada"||C.operational_status==="etiqueta_gerada";return!(k||I||U)}).map(C=>C.id);S.length>0&&await Promise.all(S.map(C=>ce.from("live_carts").update({status:"cancelado",separation_status:"cancelado"}).eq("id",C).neq("status","pago")));const N=(M||[]).map(C=>{var ye,ue;const k=C.label_printed_at||null,I=!!k,U=C.separation_status,$=I||U==="separado"||C.status==="etiqueta_gerada"||C.operational_status==="etiqueta_gerada",Y=(C.items||[]).filter(ne=>ne.status!=="removido"?!0:["separado","cancelado","retirado_confirmado"].includes(ne.separation_status)).map(ne=>{var Ke,Ze,it,Re,ot,ut;const pe=ne.status==="cancelado"||ne.status==="removido",ge=ne.separation_status==="cancelado",Ne=ne.separation_status==="separado"||ne.separation_status==="retirado_confirmado";let _e=0;if(ne.separation_notes){const bt=ne.separation_notes.match(/removed_confirmed:(\d+)/);bt&&(_e=parseInt(bt[1],10))}let be=0;if(ne.separation_notes){const bt=ne.separation_notes.match(/pending_removal:(\d+)/);bt&&(be=parseInt(bt[1],10))}let Me=ne.separation_status||"em_separacao";pe&&!ge&&Me!=="retirado_confirmado"&&(Me="cancelado"),be>0&&Me!=="retirado_confirmado"&&(Me="cancelado");const Se=be>0?Math.max(0,be-_e):0,$e=$&&pe;return{id:ne.id,bagId:C.id,bagNumber:C.bag_number||0,productId:ne.product_id,productName:((Ke=ne.product)==null?void 0:Ke.name)||"Produto",productImage:((Ze=ne.product)==null?void 0:Ze.image_url)||null,color:((it=ne.variante)==null?void 0:it.cor)||((Re=ne.product)==null?void 0:Re.color)||null,size:((ot=ne.variante)==null?void 0:ot.tamanho)||null,quantity:ne.qtd,unitPrice:ne.preco_unitario,status:Me,notes:ne.separation_notes||null,instagramHandle:((ut=C.live_customer)==null?void 0:ut.instagram_handle)||"@unknown",cartItemStatus:ne.status,removedConfirmedCount:_e,pendingRemovalFromQuantityReduction:be,wasSeparatedBeforeCancellation:Ne&&pe||be>0||$e}}),Z=(C.gifts||[]).filter(ne=>ne.status!=="removed").map(ne=>{var pe,ge,Ne;return{id:`gift-${ne.id}`,bagId:C.id,bagNumber:C.bag_number||0,productId:ne.gift_id,productName:` ${((pe=ne.gift)==null?void 0:pe.name)||"Brinde"}`,productImage:((ge=ne.gift)==null?void 0:ge.image_url)||null,color:null,size:null,quantity:ne.qty,unitPrice:0,status:ne.separation_confirmed?"separado":"em_separacao",notes:null,instagramHandle:((Ne=C.live_customer)==null?void 0:Ne.instagram_handle)||"@unknown",cartItemStatus:ne.status,removedConfirmedCount:0,isGift:!0,giftSource:ne.applied_by_raffle_id?"raffle":ne.applied_by_rule_id?"rule":null}}),re=[...Y,...Z],G=re.some(ne=>ne.status==="cancelado"||ne.cartItemStatus==="cancelado"||ne.cartItemStatus==="removido"),J=re.some(ne=>ne.status==="em_separacao"&&!["cancelado","removido"].includes(ne.cartItemStatus));let V=0;re.forEach(ne=>{if(ne.pendingRemovalFromQuantityReduction&&ne.pendingRemovalFromQuantityReduction>0){const pe=Math.max(0,ne.pendingRemovalFromQuantityReduction-ne.removedConfirmedCount);V+=pe}else if(ne.status==="cancelado"||ne.cartItemStatus==="cancelado"||ne.cartItemStatus==="removido"){const pe=ne.quantity-ne.removedConfirmedCount;pe>0&&(V+=pe)}});const W=k&&C.needs_label_reprint===!0,ee=[],ie=C.attention_logs||[];ie.forEach(ne=>{var pe;if(!ne.resolved_at){const ge={itemId:((pe=ne.payload)==null?void 0:pe.item_id)||ne.id,productName:ne.product_name||"Produto",productImage:null,color:null,size:ne.size,quantity:ne.quantity||1,originBagId:C.id,originBagNumber:ne.origin_bag_number||C.bag_number||0,destinationBagId:ne.destination_bag_number?"pending":null,destinationBagNumber:ne.destination_bag_number,destinationInstagram:ne.destination_instagram,createdAt:ne.created_at,removedFromOriginConfirmed:!1,placedInDestinationConfirmed:!1};ee.push({type:ne.attention_type,reallocationInfo:ge,description:ne.attention_type==="cancellation"?"Pedido cancelado - retirar itens da sacola":ne.attention_type==="reallocation"?`Pea realocada para Sacola #${ne.destination_bag_number}`:"Pea cancelada - retirar da sacola",resolved:!1})}}),re.forEach(ne=>{var be;const pe=ne.wasSeparatedBeforeCancellation,ge=ne.status==="cancelado"||ne.cartItemStatus==="cancelado"||ne.cartItemStatus==="removido",Ne=(ne.pendingRemovalFromQuantityReduction??0)>0;if(!ie.some(Me=>{var Se;return((Se=Me.payload)==null?void 0:Se.item_id)===ne.id&&!Me.resolved_at})&&(pe||Ne)&&(ge||Ne)){const Me=Ne?ne.pendingRemovalFromQuantityReduction??0:ne.quantity,Se=Math.max(0,Me-ne.removedConfirmedCount);if(Se>0){let $e=null,Ke=null,Ze=null;if(ne.notes){const Re=ne.notes.match(/reallocation:([^:]+):(\d+):([^|]+)/);Re&&($e=Re[1]==="null"?null:Re[1],Ke=parseInt(Re[2],10)||null,Ze=((be=Re[3])==null?void 0:be.trim())||null)}const it={itemId:ne.id,productName:ne.productName,productImage:ne.productImage,color:ne.color,size:ne.size,quantity:Se,originBagId:C.id,originBagNumber:C.bag_number||0,destinationBagId:$e,destinationBagNumber:Ke,destinationInstagram:Ze,createdAt:C.updated_at||C.created_at,removedFromOriginConfirmed:!1,placedInDestinationConfirmed:!1};ee.push({type:$e?"reallocation":Ne?"quantity_reduction":"cancellation",reallocationInfo:it,description:$e?`Pea realocada para Sacola #${Ke}`:"Pea cancelada - retirar da sacola",resolved:!1})}}});const oe=ee.some(ne=>!ne.resolved),se=oe;let le="em_separacao";return oe||V>0?le="atencao":C.separation_status==="cancelado"||C.status==="cancelado"?le="cancelado":!J&&re.length>0?le="separado":C.separation_status==="pendente"&&(le="pendente"),{id:C.id,bagNumber:C.bag_number||0,instagramHandle:((ye=C.live_customer)==null?void 0:ye.instagram_handle)||"@unknown",customerName:((ue=C.live_customer)==null?void 0:ue.nome)||null,totalItems:re.reduce((ne,pe)=>ne+pe.quantity,0),totalValue:C.total||0,status:le,items:re,hasCancelledItems:G,hasUnseparatedItems:J,cartStatus:C.status,createdAt:C.created_at,needsReprintLabel:W,pendingRemovalCount:V,labelPrintedAt:k,attentionRequirements:ee,hasUnresolvedAttention:oe,isBlocked:se}}).filter(C=>C.bagNumber>0);if(h.current){r(N);const C=p(N);a(C);const k=g(N);o(k)}}catch(M){console.error("Error fetching separation data:",M),h.current&&de.error("Erro ao carregar dados de separao")}finally{h.current&&d(!1)}}},[e]),p=M=>{const F=new Map;return M.forEach(S=>{S.items.forEach(E=>{const N=`${E.productId}_${E.color||""}_${E.size||""}`;F.has(N)||F.set(N,{productId:E.productId,productName:E.productName,productImage:E.productImage,color:E.color,size:E.size,sku:null,totalNeeded:0,totalSeparated:0,totalPending:0,totalCancelled:0,bags:[]});const C=F.get(N);C.bags.push({bagId:S.id,bagNumber:S.bagNumber,instagramHandle:S.instagramHandle,itemId:E.id,quantity:E.quantity,status:E.status}),E.status==="separado"||E.status==="retirado_confirmado"?C.totalSeparated+=E.quantity:E.status==="cancelado"?C.totalCancelled+=E.quantity:C.totalPending+=E.quantity,C.totalNeeded+=E.quantity})}),Array.from(F.values()).sort((S,E)=>{const N=S.productName.localeCompare(E.productName);return N!==0?N:(S.size||"").localeCompare(E.size||"")})},g=M=>{const F=M.length,S=M.filter($=>$.status==="separado").length,E=M.filter($=>$.status==="em_separacao"||$.status==="pendente").length,N=M.filter($=>$.status==="atencao").length,C=M.filter($=>$.status==="cancelado").length;let k=0;M.forEach($=>{$.items.forEach(Y=>{Y.status==="cancelado"&&(k+=Y.quantity)})});const I=F-C,U=I>0?Math.round(S/I*100):0;return{totalBags:F,bagsSeparated:S,bagsPending:E,bagsAttention:N,bagsCancelled:C,itemsCancelled:k,separationPercentage:U}},v=async()=>{if(!e)return!1;u(!0);try{const{data:M,error:F}=await ce.from("live_carts").select("id, bag_number").eq("live_event_id",e).neq("status","cancelado");if(F)throw F;if(!M||M.length===0)return de.warning("No h carrinhos nesta live para separar. Somente carrinhos cancelados no so includos."),u(!1),!1;const{data:S,error:E}=await ce.from("live_carts").select("id, created_at, status").eq("live_event_id",e).is("bag_number",null).neq("status","cancelado").order("created_at",{ascending:!0});if(E)throw E;if(!S||S.length===0)return de.info("Todas as sacolas ativas j foram numeradas"),await m(),!0;const{data:N}=await ce.from("live_carts").select("bag_number").eq("live_event_id",e).not("bag_number","is",null).order("bag_number",{ascending:!1}).limit(1).maybeSingle();let C=((N==null?void 0:N.bag_number)||0)+1;for(const k of S)await ce.from("live_carts").update({bag_number:C,separation_status:"em_separacao"}).eq("id",k.id),await ce.from("live_cart_items").update({separation_status:"em_separacao"}).eq("live_cart_id",k.id).is("separation_status",null),C++;return de.success(`${S.length} sacolas criadas!`),await m(),!0}catch(M){return console.error("Error generating bag numbers:",M),de.error("Erro ao gerar sacolas"),!1}finally{u(!1)}},x=async M=>{try{if(M.startsWith("gift-")){const E=M.replace("gift-",""),{error:N}=await ce.from("order_gifts").update({separation_confirmed:!0}).eq("id",E);if(N)throw N}else{const{error:E}=await ce.from("live_cart_items").update({separation_status:"separado"}).eq("id",M);if(E)throw E}const S=t.flatMap(E=>E.items).find(E=>E.id===M);return S&&await O(S.bagId),await m(),!0}catch(F){return console.error("Error marking item separated:",F),de.error("Erro ao marcar item como separado"),!1}},y=async(M,F)=>{try{const{error:S}=await ce.from("live_cart_items").update({separation_status:"cancelado",separation_notes:F||"Retirar do pedido"}).eq("id",M);if(S)throw S;const E=t.flatMap(N=>N.items).find(N=>N.id===M);return E&&await ce.from("live_carts").update({separation_status:"atencao"}).eq("id",E.bagId),de.warning("Item marcado para retirar"),await m(),!0}catch(S){return console.error("Error marking item cancelled:",S),de.error("Erro ao marcar item como cancelado"),!1}},b=async(M,F)=>{try{const S=t.flatMap(U=>U.items).find(U=>U.id===M);if(!S)return!1;const E=F!==void 0?F:S.quantity,N=S.pendingRemovalFromQuantityReduction&&S.pendingRemovalFromQuantityReduction>0?S.pendingRemovalFromQuantityReduction:S.quantity;let C=S.notes||"";C.includes("removed_confirmed:")?C=C.replace(/removed_confirmed:\d+/,`removed_confirmed:${E}`):C=C?`${C} | removed_confirmed:${E}`:`removed_confirmed:${E}`;const k=E>=N,{error:I}=await ce.from("live_cart_items").update({separation_status:k?"retirado_confirmado":"cancelado",separation_notes:C}).eq("id",M);if(I)throw I;if(k&&e){const{error:U}=await ce.from("live_attention_log").update({resolved_at:new Date().toISOString(),resolved_by:"manual_confirmation"}).eq("live_event_id",e).is("resolved_at",null).contains("payload",{item_id:M});U&&console.error("Error resolving attention log:",U)}return S&&await O(S.bagId),k&&de.success("Retirada confirmada"),await m(),!0}catch(S){return console.error("Error confirming item removed:",S),de.error("Erro ao confirmar retirada"),!1}},j=async M=>{try{const{error:F}=await ce.from("live_cart_items").update({separation_status:"separado"}).eq("live_cart_id",M).in("separation_status",["em_separacao",null]);if(F)throw F;const{error:S}=await ce.from("order_gifts").update({separation_confirmed:!0}).eq("live_cart_id",M).eq("separation_confirmed",!1);if(S)throw S;return await ce.from("live_carts").update({separation_status:"separado"}).eq("id",M),de.success("Sacola marcada como separada"),await m(),!0}catch(F){return console.error("Error marking bag separated:",F),de.error("Erro ao marcar sacola como separada"),!1}},T=async(M,F,S)=>{try{const E=t.flatMap(I=>I.items).filter(I=>I.productId===M&&I.color===F&&I.size===S&&I.status==="em_separacao");if(E.length===0)return de.info("No h itens pendentes para este produto"),!0;const N=E.map(I=>I.id),{error:C}=await ce.from("live_cart_items").update({separation_status:"separado"}).in("id",N);if(C)throw C;const k=[...new Set(E.map(I=>I.bagId))];for(const I of k)await O(I);return de.success(`${E.length} itens marcados como separados`),await m(),!0}catch(E){return console.error("Error marking all product items separated:",E),de.error("Erro ao marcar itens como separados"),!1}},O=async M=>{try{const{data:F}=await ce.from("live_cart_items").select("separation_status, status").eq("live_cart_id",M).neq("status","expirado"),{data:S}=await ce.from("order_gifts").select("separation_confirmed, status").eq("live_cart_id",M).neq("status","removed");if(!F)return;const E=F.filter(Y=>["reservado","confirmado"].includes(Y.status)),N=(S||[]).filter(Y=>Y.status!=="removed");if(F.length>0&&E.length===0&&N.length===0){await ce.from("live_carts").update({status:"cancelado",separation_status:"cancelado"}).eq("id",M).neq("status","pago");return}const C=E.some(Y=>Y.separation_status==="em_separacao"||Y.separation_status===null),k=N.some(Y=>!Y.separation_confirmed),I=C||k,U=F.some(Y=>Y.separation_status==="cancelado"||["cancelado","removido"].includes(Y.status));let $="em_separacao";U?$="atencao":I||($="separado"),await ce.from("live_carts").update({separation_status:$}).eq("id",M)}catch(F){console.error("Error updating bag status:",F)}},R=async M=>{try{const{error:F}=await ce.from("live_carts").update({label_printed_at:new Date().toISOString(),needs_label_reprint:!1}).eq("id",M);if(F)throw F;return await m(),!0}catch(F){return console.error("Error marking label printed:",F),de.error("Erro ao registrar impresso de etiqueta"),!1}},D=async M=>{try{const{error:F}=await ce.from("live_carts").update({label_printed_at:new Date().toISOString(),needs_label_reprint:!1}).in("id",M);if(F)throw F;return await m(),!0}catch(F){return console.error("Error marking labels printed:",F),de.error("Erro ao registrar impresses"),!1}},L=async M=>{if(e)try{const{data:F}=await ce.from("live_carts").select("bag_number").eq("live_event_id",e).not("bag_number","is",null).order("bag_number",{ascending:!1}).limit(1).maybeSingle(),S=((F==null?void 0:F.bag_number)||0)+1;await ce.from("live_carts").update({bag_number:S,separation_status:"em_separacao"}).eq("id",M).is("bag_number",null),await ce.from("live_cart_items").update({separation_status:"em_separacao"}).eq("live_cart_id",M).is("separation_status",null)}catch(F){console.error("Error auto-generating bag number:",F)}};return P.useEffect(()=>(h.current=!0,m(),()=>{h.current=!1}),[m]),P.useEffect(()=>{if(!e)return;f.current.forEach(E=>{ce.removeChannel(E)}),f.current=[];const M=async E=>{if(h.current){if((E==null?void 0:E.table)==="live_carts"&&(E!=null&&E.new)){const N=E.new;N.live_event_id===e&&N.bag_number===null&&N.status!=="cancelado"&&await L(N.id)}m()}},F=ce.channel(`separation_carts_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_carts",filter:`live_event_id=eq.${e}`},M).subscribe(),S=ce.channel(`separation_items_${e}_${Date.now()}`).on("postgres_changes",{event:"*",schema:"public",table:"live_cart_items"},()=>{h.current&&m()}).subscribe();return f.current=[F,S],()=>{f.current.forEach(E=>{ce.removeChannel(E)}),f.current=[]}},[e,m]),{bags:t,productGroups:s,kpis:i,isLoading:c,isGeneratingBags:l,fetchSeparationData:m,generateBagNumbers:v,markItemSeparated:x,markItemCancelled:y,confirmItemRemoved:b,markBagSeparated:j,markAllProductItemsSeparated:T,markLabelPrinted:R,markLabelsAsPrinted:D,filterBags:(M,F,S)=>{let E=[...t];if(S.trim()){const N=S.toLowerCase();E=E.filter(C=>{var k;return C.instagramHandle.toLowerCase().includes(N)||C.bagNumber.toString().includes(N)||((k=C.customerName)==null?void 0:k.toLowerCase().includes(N))||C.items.some(I=>I.productName.toLowerCase().includes(N))})}switch(M){case"pending":E=E.filter(N=>N.status==="em_separacao"||N.status==="pendente");break;case"separated":E=E.filter(N=>N.status==="separado");break;case"cancelled":E=E.filter(N=>N.status==="cancelado");break;case"attention":E=E.filter(N=>N.status==="atencao");break}switch(F){case"bag_number":E.sort((C,k)=>C.bagNumber-k.bagNumber);break;case"instagram":E.sort((C,k)=>C.instagramHandle.localeCompare(k.instagramHandle));break;case"status":const N={pendente:0,em_separacao:1,atencao:2,separado:3,cancelado:4};E.sort((C,k)=>N[C.status]-N[k.status]);break}return E},filterProductGroups:M=>{if(!M.trim())return s;const F=M.toLowerCase();return s.filter(S=>{var E,N,C;return S.productName.toLowerCase().includes(F)||((E=S.color)==null?void 0:E.toLowerCase().includes(F))||((N=S.size)==null?void 0:N.toLowerCase().includes(F))||((C=S.sku)==null?void 0:C.toLowerCase().includes(F))})},resolveReallocation:async(M,F,S)=>{try{if(!F)return de.error("Confirme que retirou a pea da sacola original"),!1;if(M.destinationBagId&&!S)return de.error("Confirme que colocou a pea na nova sacola"),!1;const E=t.flatMap(U=>U.items).find(U=>U.id===M.itemId);if(!E)return!1;let N=E.notes||"";const C=E.pendingRemovalFromQuantityReduction&&E.pendingRemovalFromQuantityReduction>0?E.pendingRemovalFromQuantityReduction:E.quantity;N.includes("removed_confirmed:")?N=N.replace(/removed_confirmed:\d+/,`removed_confirmed:${C}`):N=N?`${N} | removed_confirmed:${C}`:`removed_confirmed:${C}`,N.includes("reallocation_resolved")||(N=N?`${N} | reallocation_resolved:${new Date().toISOString()}`:`reallocation_resolved:${new Date().toISOString()}`);const{error:k}=await ce.from("live_cart_items").update({separation_status:"retirado_confirmado",separation_notes:N}).eq("id",M.itemId);if(k)throw k;await O(M.originBagId);const I=t.find(U=>U.id===M.originBagId);return I!=null&&I.labelPrintedAt&&await ce.from("live_carts").update({needs_label_reprint:!0}).eq("id",M.originBagId),de.success("Realocao confirmada"),await m(),!0}catch(E){return console.error("Error resolving reallocation:",E),de.error("Erro ao confirmar realocao"),!1}}}}function MZe({kpis:e}){return n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ut,{className:"h-5 w-5 text-primary"}),n.jsx("span",{className:"text-sm text-muted-foreground",children:"Sacolas"})]}),n.jsx("p",{className:"text-2xl font-bold mt-1",children:e.totalBags})]})}),n.jsx(De,{className:"border-green-200 bg-green-50/50",children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(pn,{className:"h-5 w-5 text-green-600"}),n.jsx("span",{className:"text-sm text-green-700",children:"Separadas"})]}),n.jsx("p",{className:"text-2xl font-bold text-green-700 mt-1",children:e.bagsSeparated})]})}),n.jsx(De,{className:"border-blue-200 bg-blue-50/50",children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(en,{className:"h-5 w-5 text-blue-600"}),n.jsx("span",{className:"text-sm text-blue-700",children:"Pendentes"})]}),n.jsx("p",{className:"text-2xl font-bold text-blue-700 mt-1",children:e.bagsPending})]})}),n.jsx(De,{className:"border-amber-200 bg-amber-50/50",children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Mr,{className:"h-5 w-5 text-amber-600"}),n.jsx("span",{className:"text-sm text-amber-700",children:"Ateno"})]}),n.jsx("p",{className:"text-2xl font-bold text-amber-700 mt-1",children:e.bagsAttention})]})}),n.jsx(De,{className:"border-red-200 bg-red-50/50",children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(qn,{className:"h-5 w-5 text-red-600"}),n.jsx("span",{className:"text-sm text-red-700",children:"Cancelados"})]}),n.jsx("p",{className:"text-2xl font-bold text-red-700 mt-1",children:e.bagsCancelled})]})}),n.jsx(De,{className:"border-primary/20 bg-primary/5",children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(_s,{className:"h-5 w-5 text-primary"}),n.jsx("span",{className:"text-sm text-primary",children:"Progresso"})]}),n.jsxs("p",{className:"text-2xl font-bold text-primary mt-1",children:[e.separationPercentage,"%"]})]})})]})}var Z1={},IZe=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},zee={},ko={};let PT;const DZe=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];ko.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return t*4+17};ko.getSymbolTotalCodewords=function(t){return DZe[t]};ko.getBCHDigit=function(e){let t=0;for(;e!==0;)t++,e>>>=1;return t};ko.setToSJISFunction=function(t){if(typeof t!="function")throw new Error('"toSJISFunc" is not a valid function.');PT=t};ko.isKanjiModeEnabled=function(){return typeof PT<"u"};ko.toSJIS=function(t){return PT(t)};var hN={};(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+r)}}e.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},e.from=function(s,a){if(e.isValid(s))return s;try{return t(s)}catch{return a}}})(hN);function Uee(){this.buffer=[],this.length=0}Uee.prototype={get:function(e){const t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)===1},put:function(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(e){const t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var LZe=Uee;function Q1(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}Q1.prototype.set=function(e,t,r,s){const a=e*this.size+t;this.data[a]=r,s&&(this.reservedBit[a]=!0)};Q1.prototype.get=function(e,t){return this.data[e*this.size+t]};Q1.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r};Q1.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]};var BZe=Q1,Vee={};(function(e){const t=ko.getSymbolSize;e.getRowColCoords=function(s){if(s===1)return[];const a=Math.floor(s/7)+2,i=t(s),o=i===145?26:Math.ceil((i-13)/(2*a-2))*2,c=[i-7];for(let d=1;d<a-1;d++)c[d]=c[d-1]-o;return c.push(6),c.reverse()},e.getPositions=function(s){const a=[],i=e.getRowColCoords(s),o=i.length;for(let c=0;c<o;c++)for(let d=0;d<o;d++)c===0&&d===0||c===0&&d===o-1||c===o-1&&d===0||a.push([i[c],i[d]]);return a}})(Vee);var qee={};const $Ze=ko.getSymbolSize,bB=7;qee.getPositions=function(t){const r=$Ze(t);return[[0,0],[r-bB,0],[0,r-bB]]};var Wee={};(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},e.from=function(a){return e.isValid(a)?parseInt(a,10):void 0},e.getPenaltyN1=function(a){const i=a.size;let o=0,c=0,d=0,l=null,u=null;for(let h=0;h<i;h++){c=d=0,l=u=null;for(let f=0;f<i;f++){let m=a.get(h,f);m===l?c++:(c>=5&&(o+=t.N1+(c-5)),l=m,c=1),m=a.get(f,h),m===u?d++:(d>=5&&(o+=t.N1+(d-5)),u=m,d=1)}c>=5&&(o+=t.N1+(c-5)),d>=5&&(o+=t.N1+(d-5))}return o},e.getPenaltyN2=function(a){const i=a.size;let o=0;for(let c=0;c<i-1;c++)for(let d=0;d<i-1;d++){const l=a.get(c,d)+a.get(c,d+1)+a.get(c+1,d)+a.get(c+1,d+1);(l===4||l===0)&&o++}return o*t.N2},e.getPenaltyN3=function(a){const i=a.size;let o=0,c=0,d=0;for(let l=0;l<i;l++){c=d=0;for(let u=0;u<i;u++)c=c<<1&2047|a.get(l,u),u>=10&&(c===1488||c===93)&&o++,d=d<<1&2047|a.get(u,l),u>=10&&(d===1488||d===93)&&o++}return o*t.N3},e.getPenaltyN4=function(a){let i=0;const o=a.data.length;for(let d=0;d<o;d++)i+=a.data[d];return Math.abs(Math.ceil(i*100/o/5)-10)*t.N4};function r(s,a,i){switch(s){case e.Patterns.PATTERN000:return(a+i)%2===0;case e.Patterns.PATTERN001:return a%2===0;case e.Patterns.PATTERN010:return i%3===0;case e.Patterns.PATTERN011:return(a+i)%3===0;case e.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(i/3))%2===0;case e.Patterns.PATTERN101:return a*i%2+a*i%3===0;case e.Patterns.PATTERN110:return(a*i%2+a*i%3)%2===0;case e.Patterns.PATTERN111:return(a*i%3+(a+i)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}e.applyMask=function(a,i){const o=i.size;for(let c=0;c<o;c++)for(let d=0;d<o;d++)i.isReserved(d,c)||i.xor(d,c,r(a,d,c))},e.getBestMask=function(a,i){const o=Object.keys(e.Patterns).length;let c=0,d=1/0;for(let l=0;l<o;l++){i(l),e.applyMask(l,a);const u=e.getPenaltyN1(a)+e.getPenaltyN2(a)+e.getPenaltyN3(a)+e.getPenaltyN4(a);e.applyMask(l,a),u<d&&(d=u,c=l)}return c}})(Wee);var fN={};const hu=hN,gb=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],xb=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];fN.getBlocksCount=function(t,r){switch(r){case hu.L:return gb[(t-1)*4+0];case hu.M:return gb[(t-1)*4+1];case hu.Q:return gb[(t-1)*4+2];case hu.H:return gb[(t-1)*4+3];default:return}};fN.getTotalCodewordsCount=function(t,r){switch(r){case hu.L:return xb[(t-1)*4+0];case hu.M:return xb[(t-1)*4+1];case hu.Q:return xb[(t-1)*4+2];case hu.H:return xb[(t-1)*4+3];default:return}};var Hee={},mN={};const Nx=new Uint8Array(512),e_=new Uint8Array(256);(function(){let t=1;for(let r=0;r<255;r++)Nx[r]=t,e_[t]=r,t<<=1,t&256&&(t^=285);for(let r=255;r<512;r++)Nx[r]=Nx[r-255]})();mN.log=function(t){if(t<1)throw new Error("log("+t+")");return e_[t]};mN.exp=function(t){return Nx[t]};mN.mul=function(t,r){return t===0||r===0?0:Nx[e_[t]+e_[r]]};(function(e){const t=mN;e.mul=function(s,a){const i=new Uint8Array(s.length+a.length-1);for(let o=0;o<s.length;o++)for(let c=0;c<a.length;c++)i[o+c]^=t.mul(s[o],a[c]);return i},e.mod=function(s,a){let i=new Uint8Array(s);for(;i.length-a.length>=0;){const o=i[0];for(let d=0;d<a.length;d++)i[d]^=t.mul(a[d],o);let c=0;for(;c<i.length&&i[c]===0;)c++;i=i.slice(c)}return i},e.generateECPolynomial=function(s){let a=new Uint8Array([1]);for(let i=0;i<s;i++)a=e.mul(a,new Uint8Array([1,t.exp(i)]));return a}})(Hee);const Gee=Hee;function OT(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}OT.prototype.initialize=function(t){this.degree=t,this.genPoly=Gee.generateECPolynomial(this.degree)};OT.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");const r=new Uint8Array(t.length+this.degree);r.set(t);const s=Gee.mod(r,this.genPoly),a=this.degree-s.length;if(a>0){const i=new Uint8Array(this.degree);return i.set(s,a),i}return s};var FZe=OT,Kee={},eh={},RT={};RT.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40};var Lc={};const Xee="[0-9]+",zZe="[A-Z $%*+\\-./:]+";let n1="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";n1=n1.replace(/u/g,"\\u");const UZe="(?:(?![A-Z0-9 $%*+\\-./:]|"+n1+`)(?:.|[\r
]))+`;Lc.KANJI=new RegExp(n1,"g");Lc.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Lc.BYTE=new RegExp(UZe,"g");Lc.NUMERIC=new RegExp(Xee,"g");Lc.ALPHANUMERIC=new RegExp(zZe,"g");const VZe=new RegExp("^"+n1+"$"),qZe=new RegExp("^"+Xee+"$"),WZe=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Lc.testKanji=function(t){return VZe.test(t)};Lc.testNumeric=function(t){return qZe.test(t)};Lc.testAlphanumeric=function(t){return WZe.test(t)};(function(e){const t=RT,r=Lc;e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!t.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},e.getBestModeForData=function(i){return r.testNumeric(i)?e.NUMERIC:r.testAlphanumeric(i)?e.ALPHANUMERIC:r.testKanji(i)?e.KANJI:e.BYTE},e.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},e.isValid=function(i){return i&&i.bit&&i.ccBits};function s(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+a)}}e.from=function(i,o){if(e.isValid(i))return i;try{return s(i)}catch{return o}}})(eh);(function(e){const t=ko,r=fN,s=hN,a=eh,i=RT,o=7973,c=t.getBCHDigit(o);function d(f,m,p){for(let g=1;g<=40;g++)if(m<=e.getCapacity(g,p,f))return g}function l(f,m){return a.getCharCountIndicator(f,m)+4}function u(f,m){let p=0;return f.forEach(function(g){const v=l(g.mode,m);p+=v+g.getBitsLength()}),p}function h(f,m){for(let p=1;p<=40;p++)if(u(f,p)<=e.getCapacity(p,m,a.MIXED))return p}e.from=function(m,p){return i.isValid(m)?parseInt(m,10):p},e.getCapacity=function(m,p,g){if(!i.isValid(m))throw new Error("Invalid QR Code version");typeof g>"u"&&(g=a.BYTE);const v=t.getSymbolTotalCodewords(m),x=r.getTotalCodewordsCount(m,p),y=(v-x)*8;if(g===a.MIXED)return y;const b=y-l(g,m);switch(g){case a.NUMERIC:return Math.floor(b/10*3);case a.ALPHANUMERIC:return Math.floor(b/11*2);case a.KANJI:return Math.floor(b/13);case a.BYTE:default:return Math.floor(b/8)}},e.getBestVersionForData=function(m,p){let g;const v=s.from(p,s.M);if(Array.isArray(m)){if(m.length>1)return h(m,v);if(m.length===0)return 1;g=m[0]}else g=m;return d(g.mode,g.getLength(),v)},e.getEncodedBits=function(m){if(!i.isValid(m)||m<7)throw new Error("Invalid QR Code version");let p=m<<12;for(;t.getBCHDigit(p)-c>=0;)p^=o<<t.getBCHDigit(p)-c;return m<<12|p}})(Kee);var Yee={};const ZE=ko,Zee=1335,HZe=21522,wB=ZE.getBCHDigit(Zee);Yee.getEncodedBits=function(t,r){const s=t.bit<<3|r;let a=s<<10;for(;ZE.getBCHDigit(a)-wB>=0;)a^=Zee<<ZE.getBCHDigit(a)-wB;return(s<<10|a)^HZe};var Qee={};const GZe=eh;function og(e){this.mode=GZe.NUMERIC,this.data=e.toString()}og.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)};og.prototype.getLength=function(){return this.data.length};og.prototype.getBitsLength=function(){return og.getBitsLength(this.data.length)};og.prototype.write=function(t){let r,s,a;for(r=0;r+3<=this.data.length;r+=3)s=this.data.substr(r,3),a=parseInt(s,10),t.put(a,10);const i=this.data.length-r;i>0&&(s=this.data.substr(r),a=parseInt(s,10),t.put(a,i*3+1))};var KZe=og;const XZe=eh,H4=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function lg(e){this.mode=XZe.ALPHANUMERIC,this.data=e}lg.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)};lg.prototype.getLength=function(){return this.data.length};lg.prototype.getBitsLength=function(){return lg.getBitsLength(this.data.length)};lg.prototype.write=function(t){let r;for(r=0;r+2<=this.data.length;r+=2){let s=H4.indexOf(this.data[r])*45;s+=H4.indexOf(this.data[r+1]),t.put(s,11)}this.data.length%2&&t.put(H4.indexOf(this.data[r]),6)};var YZe=lg;const ZZe=eh;function cg(e){this.mode=ZZe.BYTE,typeof e=="string"?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}cg.getBitsLength=function(t){return t*8};cg.prototype.getLength=function(){return this.data.length};cg.prototype.getBitsLength=function(){return cg.getBitsLength(this.data.length)};cg.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)};var QZe=cg;const JZe=eh,eQe=ko;function dg(e){this.mode=JZe.KANJI,this.data=e}dg.getBitsLength=function(t){return t*13};dg.prototype.getLength=function(){return this.data.length};dg.prototype.getBitsLength=function(){return dg.getBitsLength(this.data.length)};dg.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=eQe.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);r=(r>>>8&255)*192+(r&255),e.put(r,13)}};var tQe=dg,Jee={exports:{}};(function(e){var t={single_source_shortest_paths:function(r,s,a){var i={},o={};o[s]=0;var c=t.PriorityQueue.make();c.push(s,0);for(var d,l,u,h,f,m,p,g,v;!c.empty();){d=c.pop(),l=d.value,h=d.cost,f=r[l]||{};for(u in f)f.hasOwnProperty(u)&&(m=f[u],p=h+m,g=o[u],v=typeof o[u]>"u",(v||g>p)&&(o[u]=p,c.push(u,p),i[u]=l))}if(typeof a<"u"&&typeof o[a]>"u"){var x=["Could not find a path from ",s," to ",a,"."].join("");throw new Error(x)}return i},extract_shortest_path_from_predecessor_list:function(r,s){for(var a=[],i=s;i;)a.push(i),r[i],i=r[i];return a.reverse(),a},find_path:function(r,s,a){var i=t.single_source_shortest_paths(r,s,a);return t.extract_shortest_path_from_predecessor_list(i,a)},PriorityQueue:{make:function(r){var s=t.PriorityQueue,a={},i;r=r||{};for(i in s)s.hasOwnProperty(i)&&(a[i]=s[i]);return a.queue=[],a.sorter=r.sorter||s.default_sorter,a},default_sorter:function(r,s){return r.cost-s.cost},push:function(r,s){var a={value:r,cost:s};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(Jee);var rQe=Jee.exports;(function(e){const t=eh,r=KZe,s=YZe,a=QZe,i=tQe,o=Lc,c=ko,d=rQe;function l(x){return unescape(encodeURIComponent(x)).length}function u(x,y,b){const j=[];let T;for(;(T=x.exec(b))!==null;)j.push({data:T[0],index:T.index,mode:y,length:T[0].length});return j}function h(x){const y=u(o.NUMERIC,t.NUMERIC,x),b=u(o.ALPHANUMERIC,t.ALPHANUMERIC,x);let j,T;return c.isKanjiModeEnabled()?(j=u(o.BYTE,t.BYTE,x),T=u(o.KANJI,t.KANJI,x)):(j=u(o.BYTE_KANJI,t.BYTE,x),T=[]),y.concat(b,j,T).sort(function(R,D){return R.index-D.index}).map(function(R){return{data:R.data,mode:R.mode,length:R.length}})}function f(x,y){switch(y){case t.NUMERIC:return r.getBitsLength(x);case t.ALPHANUMERIC:return s.getBitsLength(x);case t.KANJI:return i.getBitsLength(x);case t.BYTE:return a.getBitsLength(x)}}function m(x){return x.reduce(function(y,b){const j=y.length-1>=0?y[y.length-1]:null;return j&&j.mode===b.mode?(y[y.length-1].data+=b.data,y):(y.push(b),y)},[])}function p(x){const y=[];for(let b=0;b<x.length;b++){const j=x[b];switch(j.mode){case t.NUMERIC:y.push([j,{data:j.data,mode:t.ALPHANUMERIC,length:j.length},{data:j.data,mode:t.BYTE,length:j.length}]);break;case t.ALPHANUMERIC:y.push([j,{data:j.data,mode:t.BYTE,length:j.length}]);break;case t.KANJI:y.push([j,{data:j.data,mode:t.BYTE,length:l(j.data)}]);break;case t.BYTE:y.push([{data:j.data,mode:t.BYTE,length:l(j.data)}])}}return y}function g(x,y){const b={},j={start:{}};let T=["start"];for(let O=0;O<x.length;O++){const R=x[O],D=[];for(let L=0;L<R.length;L++){const q=R[L],X=""+O+L;D.push(X),b[X]={node:q,lastCount:0},j[X]={};for(let H=0;H<T.length;H++){const M=T[H];b[M]&&b[M].node.mode===q.mode?(j[M][X]=f(b[M].lastCount+q.length,q.mode)-f(b[M].lastCount,q.mode),b[M].lastCount+=q.length):(b[M]&&(b[M].lastCount=q.length),j[M][X]=f(q.length,q.mode)+4+t.getCharCountIndicator(q.mode,y))}}T=D}for(let O=0;O<T.length;O++)j[T[O]].end=0;return{map:j,table:b}}function v(x,y){let b;const j=t.getBestModeForData(x);if(b=t.from(y,j),b!==t.BYTE&&b.bit<j.bit)throw new Error('"'+x+'" cannot be encoded with mode '+t.toString(b)+`.
 Suggested mode is: `+t.toString(j));switch(b===t.KANJI&&!c.isKanjiModeEnabled()&&(b=t.BYTE),b){case t.NUMERIC:return new r(x);case t.ALPHANUMERIC:return new s(x);case t.KANJI:return new i(x);case t.BYTE:return new a(x)}}e.fromArray=function(y){return y.reduce(function(b,j){return typeof j=="string"?b.push(v(j,null)):j.data&&b.push(v(j.data,j.mode)),b},[])},e.fromString=function(y,b){const j=h(y,c.isKanjiModeEnabled()),T=p(j),O=g(T,b),R=d.find_path(O.map,"start","end"),D=[];for(let L=1;L<R.length-1;L++)D.push(O.table[R[L]].node);return e.fromArray(m(D))},e.rawSplit=function(y){return e.fromArray(h(y,c.isKanjiModeEnabled()))}})(Qee);const pN=ko,G4=hN,nQe=LZe,sQe=BZe,aQe=Vee,iQe=qee,QE=Wee,JE=fN,oQe=FZe,t_=Kee,lQe=Yee,cQe=eh,K4=Qee;function dQe(e,t){const r=e.size,s=iQe.getPositions(t);for(let a=0;a<s.length;a++){const i=s[a][0],o=s[a][1];for(let c=-1;c<=7;c++)if(!(i+c<=-1||r<=i+c))for(let d=-1;d<=7;d++)o+d<=-1||r<=o+d||(c>=0&&c<=6&&(d===0||d===6)||d>=0&&d<=6&&(c===0||c===6)||c>=2&&c<=4&&d>=2&&d<=4?e.set(i+c,o+d,!0,!0):e.set(i+c,o+d,!1,!0))}}function uQe(e){const t=e.size;for(let r=8;r<t-8;r++){const s=r%2===0;e.set(r,6,s,!0),e.set(6,r,s,!0)}}function hQe(e,t){const r=aQe.getPositions(t);for(let s=0;s<r.length;s++){const a=r[s][0],i=r[s][1];for(let o=-2;o<=2;o++)for(let c=-2;c<=2;c++)o===-2||o===2||c===-2||c===2||o===0&&c===0?e.set(a+o,i+c,!0,!0):e.set(a+o,i+c,!1,!0)}}function fQe(e,t){const r=e.size,s=t_.getEncodedBits(t);let a,i,o;for(let c=0;c<18;c++)a=Math.floor(c/3),i=c%3+r-8-3,o=(s>>c&1)===1,e.set(a,i,o,!0),e.set(i,a,o,!0)}function X4(e,t,r){const s=e.size,a=lQe.getEncodedBits(t,r);let i,o;for(i=0;i<15;i++)o=(a>>i&1)===1,i<6?e.set(i,8,o,!0):i<8?e.set(i+1,8,o,!0):e.set(s-15+i,8,o,!0),i<8?e.set(8,s-i-1,o,!0):i<9?e.set(8,15-i-1+1,o,!0):e.set(8,15-i-1,o,!0);e.set(s-8,8,1,!0)}function mQe(e,t){const r=e.size;let s=-1,a=r-1,i=7,o=0;for(let c=r-1;c>0;c-=2)for(c===6&&c--;;){for(let d=0;d<2;d++)if(!e.isReserved(a,c-d)){let l=!1;o<t.length&&(l=(t[o]>>>i&1)===1),e.set(a,c-d,l),i--,i===-1&&(o++,i=7)}if(a+=s,a<0||r<=a){a-=s,s=-s;break}}}function pQe(e,t,r){const s=new nQe;r.forEach(function(d){s.put(d.mode.bit,4),s.put(d.getLength(),cQe.getCharCountIndicator(d.mode,e)),d.write(s)});const a=pN.getSymbolTotalCodewords(e),i=JE.getTotalCodewordsCount(e,t),o=(a-i)*8;for(s.getLengthInBits()+4<=o&&s.put(0,4);s.getLengthInBits()%8!==0;)s.putBit(0);const c=(o-s.getLengthInBits())/8;for(let d=0;d<c;d++)s.put(d%2?17:236,8);return gQe(s,e,t)}function gQe(e,t,r){const s=pN.getSymbolTotalCodewords(t),a=JE.getTotalCodewordsCount(t,r),i=s-a,o=JE.getBlocksCount(t,r),c=s%o,d=o-c,l=Math.floor(s/o),u=Math.floor(i/o),h=u+1,f=l-u,m=new oQe(f);let p=0;const g=new Array(o),v=new Array(o);let x=0;const y=new Uint8Array(e.buffer);for(let R=0;R<o;R++){const D=R<d?u:h;g[R]=y.slice(p,p+D),v[R]=m.encode(g[R]),p+=D,x=Math.max(x,D)}const b=new Uint8Array(s);let j=0,T,O;for(T=0;T<x;T++)for(O=0;O<o;O++)T<g[O].length&&(b[j++]=g[O][T]);for(T=0;T<f;T++)for(O=0;O<o;O++)b[j++]=v[O][T];return b}function xQe(e,t,r,s){let a;if(Array.isArray(e))a=K4.fromArray(e);else if(typeof e=="string"){let l=t;if(!l){const u=K4.rawSplit(e);l=t_.getBestVersionForData(u,r)}a=K4.fromString(e,l||40)}else throw new Error("Invalid data");const i=t_.getBestVersionForData(a,r);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!t)t=i;else if(t<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=pQe(t,r,a),c=pN.getSymbolSize(t),d=new sQe(c);return dQe(d,t),uQe(d),hQe(d,t),X4(d,r,0),t>=7&&fQe(d,t),mQe(d,o),isNaN(s)&&(s=QE.getBestMask(d,X4.bind(null,d,r))),QE.applyMask(s,d),X4(d,r,s),{modules:d,version:t,errorCorrectionLevel:r,maskPattern:s,segments:a}}zee.create=function(t,r){if(typeof t>"u"||t==="")throw new Error("No input text");let s=G4.M,a,i;return typeof r<"u"&&(s=G4.from(r.errorCorrectionLevel,G4.M),a=t_.from(r.version),i=QE.from(r.maskPattern),r.toSJISFunc&&pN.setToSJISFunction(r.toSJISFunc)),xQe(t,a,s,i)};var ete={},MT={};(function(e){function t(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let s=r.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+r);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(i){return[i,i]}))),s.length===6&&s.push("F","F");const a=parseInt(s.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+s.slice(0,6).join("")}}e.getOptions=function(s){s||(s={}),s.color||(s.color={});const a=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,i=s.width&&s.width>=21?s.width:void 0,o=s.scale||4;return{width:i,scale:i?4:o,margin:a,color:{dark:t(s.color.dark||"#000000ff"),light:t(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},e.getScale=function(s,a){return a.width&&a.width>=s+a.margin*2?a.width/(s+a.margin*2):a.scale},e.getImageWidth=function(s,a){const i=e.getScale(s,a);return Math.floor((s+a.margin*2)*i)},e.qrToImageData=function(s,a,i){const o=a.modules.size,c=a.modules.data,d=e.getScale(o,i),l=Math.floor((o+i.margin*2)*d),u=i.margin*d,h=[i.color.light,i.color.dark];for(let f=0;f<l;f++)for(let m=0;m<l;m++){let p=(f*l+m)*4,g=i.color.light;if(f>=u&&m>=u&&f<l-u&&m<l-u){const v=Math.floor((f-u)/d),x=Math.floor((m-u)/d);g=h[c[v*o+x]?1:0]}s[p++]=g.r,s[p++]=g.g,s[p++]=g.b,s[p]=g.a}}})(MT);(function(e){const t=MT;function r(a,i,o){a.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(i,o,c){let d=c,l=o;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),o||(l=s()),d=t.getOptions(d);const u=t.getImageWidth(i.modules.size,d),h=l.getContext("2d"),f=h.createImageData(u,u);return t.qrToImageData(f.data,i,d),r(h,l,u),h.putImageData(f,0,0),l},e.renderToDataURL=function(i,o,c){let d=c;typeof d>"u"&&(!o||!o.getContext)&&(d=o,o=void 0),d||(d={});const l=e.render(i,o,d),u=d.type||"image/png",h=d.rendererOpts||{};return l.toDataURL(u,h.quality)}})(ete);var tte={};const vQe=MT;function _B(e,t){const r=e.a/255,s=t+'="'+e.hex+'"';return r<1?s+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':s}function Y4(e,t,r){let s=e+t;return typeof r<"u"&&(s+=" "+r),s}function yQe(e,t,r){let s="",a=0,i=!1,o=0;for(let c=0;c<e.length;c++){const d=Math.floor(c%t),l=Math.floor(c/t);!d&&!i&&(i=!0),e[c]?(o++,c>0&&d>0&&e[c-1]||(s+=i?Y4("M",d+r,.5+l+r):Y4("m",a,0),a=0,i=!1),d+1<t&&e[c+1]||(s+=Y4("h",o),o=0)):a++}return s}tte.render=function(t,r,s){const a=vQe.getOptions(r),i=t.modules.size,o=t.modules.data,c=i+a.margin*2,d=a.color.light.a?"<path "+_B(a.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",l="<path "+_B(a.color.dark,"stroke")+' d="'+yQe(o,i,a.margin)+'"/>',u='viewBox="0 0 '+c+" "+c+'"',f='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+u+' shape-rendering="crispEdges">'+d+l+`</svg>
`;return typeof s=="function"&&s(null,f),f};const bQe=IZe,e6=zee,rte=ete,wQe=tte;function IT(e,t,r,s,a){const i=[].slice.call(arguments,1),o=i.length,c=typeof i[o-1]=="function";if(!c&&!bQe())throw new Error("Callback required as last argument");if(c){if(o<2)throw new Error("Too few arguments provided");o===2?(a=r,r=t,t=s=void 0):o===3&&(t.getContext&&typeof a>"u"?(a=s,s=void 0):(a=s,s=r,r=t,t=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(r=t,t=s=void 0):o===2&&!t.getContext&&(s=r,r=t,t=void 0),new Promise(function(d,l){try{const u=e6.create(r,s);d(e(u,t,s))}catch(u){l(u)}})}try{const d=e6.create(r,s);a(null,e(d,t,s))}catch(d){a(d)}}Z1.create=e6.create;Z1.toCanvas=IT.bind(null,rte.render);Z1.toDataURL=IT.bind(null,rte.renderToDataURL);Z1.toString=IT.bind(null,function(e,t,r){return wQe.render(e,r)});const _Qe=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),nte=async e=>{try{return await Z1.toDataURL(e,{width:150,margin:1,color:{dark:"#000000",light:"#ffffff"}})}catch(t){return console.error("Error generating QR code:",t),""}},ste=()=>`
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
    max-width: 300px;
    margin: 0 auto;
  }
  .label {
    border: 2px solid #000;
    border-radius: 8px;
    padding: 16px;
    text-align: center;
    page-break-inside: avoid;
    margin-bottom: 20px;
  }
  .event-title {
    font-size: 10px;
    color: #666;
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  .bag-number {
    font-size: 48px;
    font-weight: bold;
    margin-bottom: 4px;
  }
  .instagram {
    font-size: 18px;
    font-weight: 600;
    color: #e1306c;
    margin-bottom: 8px;
  }
  .customer-name {
    font-size: 12px;
    color: #666;
    margin-bottom: 8px;
  }
  .qr-container {
    display: flex;
    justify-content: center;
    margin: 12px 0;
  }
  .qr-container img {
    width: 120px;
    height: 120px;
  }
  .details {
    display: flex;
    justify-content: space-between;
    padding-top: 12px;
    border-top: 1px dashed #ccc;
    margin-top: 8px;
  }
  .detail-item {
    text-align: center;
  }
  .detail-label {
    font-size: 10px;
    color: #666;
    text-transform: uppercase;
  }
  .detail-value {
    font-size: 16px;
    font-weight: bold;
  }
  .items-list {
    text-align: left;
    margin-top: 12px;
    padding-top: 12px;
    border-top: 1px dashed #ccc;
    font-size: 11px;
  }
  .items-list-title {
    font-weight: bold;
    margin-bottom: 6px;
    font-size: 10px;
    text-transform: uppercase;
    color: #666;
  }
  .item-row {
    display: flex;
    justify-content: space-between;
    padding: 2px 0;
  }
  .item-name {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 180px;
  }
  .item-size {
    font-weight: 600;
    margin-left: 8px;
  }
  .separator {
    border: none;
    border-top: 2px dashed #999;
    margin: 30px 0;
    position: relative;
    page-break-before: always;
  }
  .separator-text {
    text-align: center;
    font-size: 10px;
    color: #666;
    margin-bottom: 10px;
    letter-spacing: 2px;
    text-transform: uppercase;
  }
  @media print {
    body {
      padding: 0;
    }
    .label {
      page-break-after: always;
    }
    .label:last-child {
      page-break-after: avoid;
    }
  }
`,ate=(e,t,r)=>`
    <div class="label">
      <div class="event-title">${t}</div>
      <div class="bag-number">#${e.bagNumber.toString().padStart(3,"0")}</div>
      <div class="instagram">${e.instagramHandle}</div>
      ${e.customerName?`<div class="customer-name">${e.customerName}</div>`:""}
      
      <div class="qr-container">
        <img src="${r}" alt="QR Code" />
      </div>
      
      <div class="details">
        <div class="detail-item">
          <div class="detail-label">Itens</div>
          <div class="detail-value">${e.totalItems}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">Total</div>
          <div class="detail-value">${_Qe(e.totalValue)}</div>
        </div>
      </div>
      
      ${e.items.length>0?`
        <div class="items-list">
          <div class="items-list-title">Itens da Sacola</div>
          ${e.items.map(s=>`
            <div class="item-row">
              <span class="item-name">${s.quantity}x ${s.productName}${s.color?` - ${s.color}`:""}</span>
              <span class="item-size">${s.size||""}</span>
            </div>
          `).join("")}
        </div>
      `:""}
    </div>
  `;function jQe({bag:e,eventTitle:t,onPrint:r,onLabelPrinted:s}){const a=async()=>{const d=`${window.location.origin}/sacola/${e.id}`,l=await nte(d);if(!l){de.error("Erro ao gerar QR code");return}const u=window.open("","_blank","width=400,height=700");if(!u){de.error("No foi possvel abrir janela de impresso");return}u.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Etiqueta Sacola #${e.bagNumber.toString().padStart(3,"0")}</title>
          <style>${ste()}</style>
        </head>
        <body>
          ${ate(e,t,l)}
          <script>
            // Wait for image to load before printing
            const img = document.querySelector('.qr-container img');
            if (img.complete) {
              setTimeout(() => { window.print(); window.close(); }, 300);
            } else {
              img.onload = () => { setTimeout(() => { window.print(); window.close(); }, 300); };
            }
          <\/script>
        </body>
      </html>
    `),u.document.close(),s&&await s(e.id),r==null||r()},i=!!e.labelPrintedAt,o=e.needsReprintLabel,c=e.labelPrintedAt?Ht(new Date(e.labelPrintedAt),"HH:mm"):null;return n.jsx(wp,{children:n.jsxs("div",{className:"flex items-center gap-2",onClick:d=>d.stopPropagation(),children:[o&&n.jsx(Ae,{className:"text-xs bg-orange-500 hover:bg-orange-600 text-white border-transparent",children:"Alterada"}),i&&n.jsxs("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:["Impressa ",c,o?"  Alterada":""]}),o?n.jsxs(Ga,{children:[n.jsx(Ka,{asChild:!0,children:n.jsxs(he,{variant:"default",size:"sm",className:"h-8 gap-1",onClick:a,children:[n.jsx(Oa,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Gerar etiqueta"})]})}),n.jsx(Aa,{children:n.jsx("p",{children:"Houve alterao aps impresso. Gere a etiqueta novamente."})})]}):i?n.jsxs(he,{variant:"outline",size:"sm",className:"h-8 gap-1",onClick:a,children:[n.jsx(h1,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Imprimir novamente"})]}):n.jsxs(he,{variant:"default",size:"sm",className:"h-8 gap-1",onClick:a,children:[n.jsx(Oa,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Gerar etiqueta"})]})]})})}function NQe({bags:e,eventTitle:t,onLabelsAsPrinted:r}){const s=async()=>{if(e.length===0)return;const o=window.location.origin,c=await Promise.all(e.map(async u=>{const h=`${o}/sacola/${u.id}`,f=await nte(h);return{bag:u,qrDataUrl:f}})),d=window.open("","_blank","width=400,height=800");if(!d){de.error("No foi possvel abrir janela de impresso");return}const l=c.map(({bag:u,qrDataUrl:h},f)=>{const m=ate(u,t,h);return f>0?`
            <div class="separator-text"> CORTE AQUI </div>
            <hr class="separator" />
            ${m}
          `:m}).join("");if(d.document.write(`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Etiquetas - ${t}</title>
          <style>${ste()}</style>
        </head>
        <body>
          ${l}
          <script>
            // Wait for all images to load before printing
            const images = document.querySelectorAll('.qr-container img');
            let loaded = 0;
            const total = images.length;
            
            function checkPrint() {
              loaded++;
              if (loaded >= total) {
                setTimeout(() => { window.print(); window.close(); }, 500);
              }
            }
            
            images.forEach(img => {
              if (img.complete) {
                checkPrint();
              } else {
                img.onload = checkPrint;
                img.onerror = checkPrint;
              }
            });
            
            // Fallback timeout
            setTimeout(() => { window.print(); window.close(); }, 3000);
          <\/script>
        </body>
      </html>
    `),d.document.close(),r){const u=e.map(h=>h.id);await r(u)}},a=e.filter(o=>o.needsReprintLabel).length,i=e.filter(o=>!o.labelPrintedAt).length;return n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2",onClick:s,disabled:e.length===0,children:[n.jsx(h1,{className:"h-4 w-4"}),"Imprimir Todas (",e.length,")",a>0&&n.jsxs(Ae,{variant:"destructive",className:"ml-1 text-xs",children:[a," alterada",a>1?"s":""]}),i>0&&a===0&&n.jsxs(Ae,{variant:"secondary",className:"ml-1 text-xs",children:[i," nova",i>1?"s":""]})]})}function SQe({open:e,onOpenChange:t,reallocation:r,onConfirm:s,isProcessing:a=!1}){var h,f;const[i,o]=P.useState((r==null?void 0:r.removedFromOriginConfirmed)||!1),[c,d]=P.useState((r==null?void 0:r.placedInDestinationConfirmed)||!1);if(!r)return null;const l=i&&(!r.destinationBagId||c),u=async()=>{await s(i,c),t(!1)};return n.jsx(Ac,{open:e,onOpenChange:t,children:n.jsxs(Dl,{className:"max-w-md",children:[n.jsxs(Ll,{children:[n.jsxs(Bl,{className:"flex items-center gap-2 text-amber-700",children:[n.jsx(Mr,{className:"h-5 w-5"}),"Confirmao de Realocao Obrigatria"]}),n.jsx($l,{className:"text-left",children:"Uma pea foi movida entre sacolas. Confirme manualmente cada etapa fsica."})]}),n.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/50 border",children:[n.jsx("div",{className:"h-12 w-12 rounded overflow-hidden bg-muted flex-shrink-0",children:r.productImage?n.jsx("img",{src:r.productImage,alt:r.productName,className:"h-full w-full object-cover"}):n.jsx("div",{className:"h-full w-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-5 w-5 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-sm truncate",children:r.productName}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[r.color&&n.jsx("span",{children:r.color}),r.size&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsx("span",{className:"font-medium",children:r.size})]}),n.jsx("span",{children:""}),n.jsxs("span",{children:["Qtd: ",r.quantity]})]})]})]}),n.jsxs("div",{className:"flex items-center justify-center gap-3 py-4",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 border-2 border-red-300 flex items-center justify-center mx-auto mb-1",children:n.jsx(ln,{className:"h-5 w-5 text-red-600"})}),n.jsxs(Ae,{variant:"outline",className:"text-xs",children:["Sacola #",r.originBagNumber.toString().padStart(3,"0")]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Origem"})]}),n.jsx(ps,{className:"h-6 w-6 text-muted-foreground flex-shrink-0"}),n.jsx("div",{className:"text-center",children:r.destinationBagId?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 border-2 border-green-300 flex items-center justify-center mx-auto mb-1",children:n.jsx(ln,{className:"h-5 w-5 text-green-600"})}),n.jsxs(Ae,{variant:"outline",className:"text-xs",children:["Sacola #",(h=r.destinationBagNumber)==null?void 0:h.toString().padStart(3,"0")]}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:r.destinationInstagram})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-100 border-2 border-gray-300 flex items-center justify-center mx-auto mb-1",children:n.jsx(Ut,{className:"h-5 w-5 text-gray-400"})}),n.jsx(Ae,{variant:"secondary",className:"text-xs",children:"Cancelado"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Devolver ao estoque"})]})})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${i?"bg-green-50 border-green-300":"bg-red-50 border-red-300 hover:bg-red-100"}`,children:[n.jsx(va,{checked:i,onCheckedChange:m=>o(m===!0),disabled:a,className:"mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("p",{className:"font-medium text-sm",children:[i&&n.jsx(pn,{className:"h-4 w-4 inline mr-1 text-green-600"}),"Confirmo que retirei a pea da Sacola #",r.originBagNumber.toString().padStart(3,"0")]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"A pea foi fisicamente removida da sacola original"})]})]}),r.destinationBagId&&n.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-lg border cursor-pointer transition-colors ${c?"bg-green-50 border-green-300":"bg-amber-50 border-amber-300 hover:bg-amber-100"} ${i?"":"opacity-50 pointer-events-none"}`,children:[n.jsx(va,{checked:c,onCheckedChange:m=>d(m===!0),disabled:a||!i,className:"mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("p",{className:"font-medium text-sm",children:[c&&n.jsx(pn,{className:"h-4 w-4 inline mr-1 text-green-600"}),"Confirmo que coloquei a pea na Sacola #",(f=r.destinationBagNumber)==null?void 0:f.toString().padStart(3,"0")]}),n.jsxs("p",{className:"text-xs text-muted-foreground",children:["A pea foi fisicamente colocada na nova sacola (",r.destinationInstagram,")"]})]})]})]}),n.jsxs("div",{className:"flex gap-2 mt-4",children:[n.jsx(he,{variant:"outline",onClick:()=>t(!1),disabled:a,className:"flex-1",children:"Voltar"}),n.jsx(he,{onClick:u,disabled:!l||a,className:"flex-1 gap-2",children:a?n.jsx(n.Fragment,{children:"Salvando..."}):n.jsxs(n.Fragment,{children:[n.jsx(pn,{className:"h-4 w-4"}),"Confirmar Realocao"]})})]})]})})}function CQe({bag:e,attentionRequirements:t,onResolveReallocation:r}){const[s,a]=P.useState(null),[i,o]=P.useState(!1),c=t.filter(u=>!u.resolved);if(!(c.length>0))return null;const l=async(u,h)=>{if(s){o(!0);try{await r(s,u,h)}finally{o(!1),a(null)}}};return n.jsxs(n.Fragment,{children:[n.jsx(De,{className:"border-amber-400 bg-amber-50",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"h-10 w-10 rounded-full bg-amber-100 border-2 border-amber-400 flex items-center justify-center flex-shrink-0",children:n.jsx(Mr,{className:"h-5 w-5 text-amber-600"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("h4",{className:"font-semibold text-amber-800",children:" Ateno Obrigatria"}),n.jsxs(Ae,{className:"bg-amber-200 text-amber-800 border-amber-300",children:[c.length," pendncia(s)"]})]}),n.jsx("p",{className:"text-sm text-amber-700 mb-3",children:"Esta sacola requer confirmao manual antes de continuar. Aes bloqueadas at resoluo."}),n.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[n.jsxs(Ae,{variant:"outline",className:"text-amber-700 border-amber-300 bg-amber-100/50",children:[n.jsx(Yo,{className:"h-3 w-3 mr-1"}),"Impresso bloqueada"]}),n.jsxs(Ae,{variant:"outline",className:"text-amber-700 border-amber-300 bg-amber-100/50",children:[n.jsx(Yo,{className:"h-3 w-3 mr-1"}),"Finalizao bloqueada"]})]}),n.jsx("div",{className:"space-y-2",children:c.map((u,h)=>{var f;return n.jsxs("div",{className:"p-3 rounded-lg bg-white border border-amber-200",children:[u.type==="reallocation"&&u.reallocationInfo&&n.jsxs("div",{className:"flex items-center justify-between gap-3",children:[n.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[n.jsx("div",{className:"h-10 w-10 rounded overflow-hidden bg-muted flex-shrink-0",children:u.reallocationInfo.productImage?n.jsx("img",{src:u.reallocationInfo.productImage,alt:u.reallocationInfo.productName,className:"h-full w-full object-cover"}):n.jsx("div",{className:"h-full w-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"text-sm font-medium truncate",children:u.reallocationInfo.productName}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[n.jsxs("span",{className:"flex items-center gap-1",children:[n.jsx(ln,{className:"h-3 w-3"}),"#",u.reallocationInfo.originBagNumber.toString().padStart(3,"0")]}),n.jsx(ps,{className:"h-3 w-3"}),u.reallocationInfo.destinationBagId?n.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[n.jsx(ln,{className:"h-3 w-3"}),"#",(f=u.reallocationInfo.destinationBagNumber)==null?void 0:f.toString().padStart(3,"0")]}):n.jsx("span",{className:"text-gray-500",children:"Cancelado"})]})]})]}),n.jsxs(he,{size:"sm",variant:"outline",className:"border-amber-400 text-amber-700 hover:bg-amber-100",onClick:()=>a(u.reallocationInfo),children:[n.jsx(pn,{className:"h-4 w-4 mr-1"}),"Confirmar"]})]}),u.type!=="reallocation"&&n.jsx("p",{className:"text-sm",children:u.description})]},h)})})]})]})})}),n.jsx(SQe,{open:!!s,onOpenChange:u=>!u&&a(null),reallocation:s,onConfirm:l,isProcessing:i})]})}function EQe({bags:e,eventTitle:t,onMarkItemSeparated:r,onMarkItemCancelled:s,onConfirmItemRemoved:a,onMarkBagSeparated:i,onLabelPrinted:o,onResolveReallocation:c}){const[d,l]=P.useState(new Set),[u,h]=P.useState({}),[f,m]=P.useState({});P.useEffect(()=>{const O={},R={};e.forEach(D=>{D.items.forEach(L=>{L.status==="separado"||L.status==="retirado_confirmado"?O[L.id]=L.quantity:L.status==="em_separacao"&&(O[L.id]=u[L.id]??0);const q=(L.pendingRemovalFromQuantityReduction??0)>0,X=L.status==="cancelado"||L.cartItemStatus==="cancelado"||L.cartItemStatus==="removido";if((q||X)&&(R[L.id]=L.removedConfirmedCount||f[L.id]||0),L.status==="retirado_confirmado"){const H=q?L.pendingRemovalFromQuantityReduction??0:L.quantity;R[L.id]=H}})}),h(D=>({...D,...O})),m(D=>({...D,...R}))},[e]);const[p,g]=P.useState(new Set),v=O=>{l(R=>{const D=new Set(R);return D.has(O)?D.delete(O):D.add(O),D})},x=async(O,R,D)=>{const L=u[O]||0;if(R<L)h(X=>({...X,[O]:Math.max(0,L-1)}));else{const X=L+1;h(H=>({...H,[O]:X})),X>=D.quantity&&(g(H=>new Set(H).add(O)),await r(O),g(H=>{const M=new Set(H);return M.delete(O),M}))}},y=async(O,R,D)=>{const L=f[O]||0;if(R<L){const X=Math.max(0,L-1);m(H=>({...H,[O]:X})),g(H=>new Set(H).add(O)),await a(O,X),g(H=>{const M=new Set(H);return M.delete(O),M})}else{const X=L+1;m(H=>({...H,[O]:X})),g(H=>new Set(H).add(O)),await a(O,X),g(H=>{const M=new Set(H);return M.delete(O),M})}},b=O=>{switch(O){case"separado":return n.jsxs(Ae,{className:"bg-green-100 text-green-700 border-green-200",children:[n.jsx(pn,{className:"h-3 w-3 mr-1"})," Separada"]});case"em_separacao":case"pendente":return n.jsxs(Ae,{variant:"secondary",className:"bg-blue-100 text-blue-700 border-blue-200",children:[n.jsx(en,{className:"h-3 w-3 mr-1"})," Em separao"]});case"atencao":return n.jsxs(Ae,{className:"bg-amber-100 text-amber-700 border-amber-200",children:[n.jsx(Mr,{className:"h-3 w-3 mr-1"})," Ateno"]});case"cancelado":return n.jsxs(Ae,{variant:"destructive",children:[n.jsx(qn,{className:"h-3 w-3 mr-1"})," Cancelada"]});default:return n.jsx(Ae,{variant:"outline",children:O})}},j=O=>{switch(O){case"separado":return n.jsx(Ae,{className:"bg-green-100 text-green-700 border-green-200 text-xs",children:n.jsx(pn,{className:"h-3 w-3"})});case"em_separacao":return n.jsx(Ae,{variant:"secondary",className:"bg-gray-100 text-gray-600 border-gray-200 text-xs",children:n.jsx(en,{className:"h-3 w-3"})});case"cancelado":return n.jsx(Ae,{variant:"destructive",className:"text-xs",children:n.jsx(qn,{className:"h-3 w-3"})});case"retirado_confirmado":return n.jsx(Ae,{className:"bg-gray-200 text-gray-600 text-xs",children:"Retirado "});default:return null}},T=O=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(O);return e.length===0?n.jsx(De,{className:"border-dashed",children:n.jsxs(Be,{className:"flex flex-col items-center justify-center py-12",children:[n.jsx(Ut,{className:"h-12 w-12 text-muted-foreground mb-3"}),n.jsx("p",{className:"text-muted-foreground",children:"Nenhuma sacola encontrada"})]})}):n.jsx("div",{className:"space-y-3",children:e.map(O=>n.jsx(Ag,{open:d.has(O.id),onOpenChange:()=>v(O.id),children:n.jsxs(De,{className:`transition-all ${O.status==="atencao"?"border-amber-300 bg-amber-50/30":O.status==="separado"?"border-green-300 bg-green-50/30":O.status==="cancelado"?"border-red-300 bg-red-50/30 opacity-60":""}`,children:[n.jsx(Tg,{className:"w-full",children:n.jsx(Ot,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[d.has(O.id)?n.jsx(Zi,{className:"h-5 w-5 text-muted-foreground"}):n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"font-bold text-lg",children:["Sacola #",O.bagNumber.toString().padStart(3,"0")]}),n.jsx("span",{className:"text-muted-foreground",children:""}),n.jsx("span",{className:"font-medium text-primary",children:O.instagramHandle}),O.customerName&&n.jsxs("span",{className:"text-sm text-muted-foreground hidden sm:inline",children:["(",O.customerName,")"]})]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[O.isBlocked?n.jsx(Ae,{variant:"outline",className:"text-amber-600 border-amber-300 bg-amber-50",children:" Bloqueado"}):n.jsx(jQe,{bag:O,eventTitle:t,onLabelPrinted:o}),n.jsxs("div",{className:"text-right hidden sm:block",children:[n.jsxs("p",{className:"text-sm text-muted-foreground",children:[O.totalItems," ",O.totalItems===1?"item":"itens"]}),n.jsx("p",{className:"font-semibold",children:T(O.totalValue)})]}),b(O.status)]})]})})}),n.jsx(Pg,{children:n.jsxs(Be,{className:"pt-0 pb-4 px-4",children:[O.hasUnresolvedAttention&&n.jsx("div",{className:"mb-4",children:n.jsx(CQe,{bag:O,attentionRequirements:O.attentionRequirements,onResolveReallocation:async(R,D,L)=>{await c(R,D,L)}})}),n.jsx("div",{className:"space-y-2 mb-4",children:O.items.map(R=>{const D=u[R.id]||0,L=f[R.id]||0,q=R.status==="separado"||R.status==="retirado_confirmado",X=R.status==="cancelado"||R.cartItemStatus==="cancelado"||R.cartItemStatus==="removido",H=(R.pendingRemovalFromQuantityReduction??0)>0,M=X||H,F=H?R.pendingRemovalFromQuantityReduction??0:X?R.quantity:0,S=Math.max(0,F-L),E=M&&S>0,N=X;return n.jsxs("div",{className:`p-3 rounded-lg border ${E?"bg-red-50 border-red-200":M&&S===0?"bg-gray-100 border-gray-200":q?"bg-green-50/50 border-green-200":"bg-background"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"h-12 w-12 rounded overflow-hidden bg-muted flex-shrink-0",children:R.productImage?n.jsx("img",{src:R.productImage,alt:R.productName,className:"h-full w-full object-cover"}):n.jsx("div",{className:"h-full w-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-5 w-5 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("p",{className:`font-medium text-sm truncate ${N?"line-through text-muted-foreground":""}`,children:R.productName}),R.isGift&&n.jsx(Ae,{className:"bg-amber-100 text-amber-700 border-amber-200 text-xs shrink-0",children:R.giftSource==="raffle"?" SORTEIO":" BRINDE"})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[R.color&&n.jsx("span",{children:R.color}),R.size&&n.jsxs(n.Fragment,{children:[n.jsx("span",{children:""}),n.jsx("span",{className:"font-medium",children:R.size})]}),n.jsx("span",{children:""}),n.jsxs("span",{children:["Qtd: ",R.quantity]}),H&&n.jsxs("span",{className:"text-red-600 font-medium",children:["(+ ",R.pendingRemovalFromQuantityReduction," cancelada",(R.pendingRemovalFromQuantityReduction??0)>1?"s":"",")"]}),R.status==="em_separacao"&&D>0&&!H&&n.jsxs("span",{className:"text-green-600 font-medium",children:["(",D,"/",R.quantity," separados)"]}),M&&L>0&&L<F&&n.jsxs("span",{className:"text-amber-600 font-medium",children:["(",L,"/",F," retirados)"]})]})]}),n.jsx("div",{className:"flex-shrink-0",children:H&&S>0?n.jsxs(Ae,{className:"bg-red-100 text-red-700 border-red-200 text-xs",children:[n.jsx(Mr,{className:"h-3 w-3 mr-1"}),"Retirar ",S]}):j(R.status)})]}),R.status==="em_separacao"&&n.jsx("div",{className:"mt-3 pt-3 border-t border-dashed",children:n.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[Array.from({length:R.quantity}).map((C,k)=>{const I=q||k<D;return n.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border cursor-pointer transition-colors ${I?"bg-green-100 border-green-300 text-green-700":"bg-background border-muted hover:bg-muted/50"}`,onClick:U=>U.stopPropagation(),children:[n.jsx(va,{checked:I,disabled:p.has(R.id),onCheckedChange:()=>x(R.id,k,R)}),n.jsxs("span",{className:"text-sm font-medium",children:["Unid. ",k+1]}),I&&n.jsx(pn,{className:"h-4 w-4"})]},k)}),p.has(R.id)&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(en,{className:"h-4 w-4 animate-spin"}),"Salvando..."]})]})}),E&&n.jsxs("div",{className:"mt-3 pt-3 border-t border-dashed border-red-200",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(mi,{className:"h-4 w-4 text-red-600"}),n.jsx("span",{className:"text-sm font-medium text-red-700",children:R.wasSeparatedBeforeCancellation?` ${H?`${F} unidade(s)`:"Item"} J SEPARADO foi cancelado! Retire da sacola:`:"Confirme a retirada fsica da sacola:"})]}),R.wasSeparatedBeforeCancellation&&n.jsx("div",{className:"mb-2 p-2 rounded text-xs bg-muted/60 border border-border text-foreground",children:H?`${F} unidade(s) deste produto j estava(m) na sacola fsica e precisa(m) ser removida(s) manualmente.`:"Este produto j estava na sacola fsica e precisa ser removido manualmente."}),n.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[Array.from({length:F}).map((C,k)=>{const I=k<L;return n.jsxs("label",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border cursor-pointer transition-colors ${I?"bg-gray-200 border-gray-400 text-gray-700":"bg-red-50 border-red-300 hover:bg-red-100 text-red-700"}`,onClick:U=>U.stopPropagation(),children:[n.jsx(va,{checked:I,disabled:p.has(R.id),onCheckedChange:()=>y(R.id,k)}),n.jsx("span",{className:"text-sm font-medium",children:I?" Retirado":`Retirar unid. ${k+1}`})]},k)}),p.has(R.id)&&n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(en,{className:"h-4 w-4 animate-spin"}),"Salvando..."]})]})]}),M&&S===0&&F>0&&n.jsxs("div",{className:"mt-2 flex items-center gap-2 text-sm text-gray-600",children:[n.jsx(pn,{className:"h-4 w-4"}),n.jsx("span",{children:"Retirada confirmada"})]})]},R.id)})}),O.needsReprintLabel&&n.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg bg-orange-100 border border-orange-300 mb-4",children:[n.jsx(Ut,{className:"h-5 w-5 text-orange-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-orange-800",children:" Reimprimir Etiqueta"}),n.jsx("p",{className:"text-sm text-orange-700",children:"Esta sacola foi modificada aps a etiqueta ser impressa. Reimprima a etiqueta aps confirmar as retiradas."})]})]}),O.pendingRemovalCount>0&&n.jsxs("div",{className:"flex items-start gap-2 p-3 rounded-lg bg-red-100 border border-red-300 mb-4",children:[n.jsx(Mr,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),n.jsxs("div",{children:[n.jsxs("p",{className:"font-medium text-red-800",children:["Ateno: ",O.pendingRemovalCount," unidade(s) cancelada(s) para retirar"]}),n.jsx("p",{className:"text-sm text-red-700",children:"Marque cada checkbox abaixo aps retirar fisicamente cada unidade da sacola."})]})]}),O.hasUnseparatedItems&&!O.hasCancelledItems&&!O.isBlocked&&n.jsxs(Ac,{children:[n.jsx(E1,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:"w-full gap-2",children:[n.jsx(pn,{className:"h-4 w-4"}),"Marcar toda sacola como separada"]})}),n.jsxs(Dl,{children:[n.jsxs(Ll,{children:[n.jsx(Bl,{children:"Confirmar separao completa?"}),n.jsxs($l,{children:["Todos os ",O.items.filter(R=>R.status==="em_separacao").length," itens pendentes sero marcados como separados."]})]}),n.jsxs(Tc,{children:[n.jsx(Oc,{children:"Cancelar"}),n.jsx(Pc,{onClick:()=>i(O.id),children:"Confirmar"})]})]})]}),O.hasUnseparatedItems&&!O.hasCancelledItems&&O.isBlocked&&n.jsx("div",{className:"p-3 rounded-lg bg-amber-50 border border-amber-200 text-center",children:n.jsx("p",{className:"text-sm text-amber-700",children:" Resolva as pendncias acima antes de finalizar a separao"})})]})})]})},O.id))})}function kQe({productGroups:e,onMarkItemSeparated:t,onMarkAllSeparated:r}){const[s,a]=P.useState(new Set),[i,o]=P.useState(new Set),[c,d]=P.useState(new Set),l=m=>`${m.productId}_${m.color||""}_${m.size||""}`,u=m=>{a(p=>{const g=new Set(p);return g.has(m)?g.delete(m):g.add(m),g})},h=async m=>{o(p=>new Set(p).add(m)),await t(m),o(p=>{const g=new Set(p);return g.delete(m),g})},f=async m=>{const p=l(m);d(g=>new Set(g).add(p)),await r(m.productId,m.color,m.size),d(g=>{const v=new Set(g);return v.delete(p),v})};return e.length===0?n.jsx(De,{className:"border-dashed",children:n.jsxs(Be,{className:"flex flex-col items-center justify-center py-12",children:[n.jsx(Ut,{className:"h-12 w-12 text-muted-foreground mb-3"}),n.jsx("p",{className:"text-muted-foreground",children:"Nenhum produto encontrado"})]})}):n.jsx("div",{className:"space-y-3",children:e.map(m=>{const p=l(m),g=s.has(p),v=m.totalNeeded>0?Math.round(m.totalSeparated/m.totalNeeded*100):0,x=m.totalPending===0;return n.jsx(Ag,{open:g,onOpenChange:()=>u(p),children:n.jsxs(De,{className:`transition-all ${x?"border-green-300 bg-green-50/30":""}`,children:[n.jsx(Tg,{className:"w-full",children:n.jsx(Ot,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[g?n.jsx(Zi,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"}):n.jsx(Dn,{className:"h-5 w-5 text-muted-foreground flex-shrink-0"}),n.jsx("div",{className:"h-14 w-14 rounded overflow-hidden bg-muted flex-shrink-0",children:m.productImage?n.jsx("img",{src:m.productImage,alt:m.productName,className:"h-full w-full object-cover"}):n.jsx("div",{className:"h-full w-full flex items-center justify-center",children:n.jsx(Ut,{className:"h-6 w-6 text-muted-foreground"})})}),n.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[n.jsx("p",{className:"font-medium truncate",children:m.productName}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[m.color&&n.jsx(Ae,{variant:"outline",className:"text-xs",children:m.color}),m.size&&n.jsx(Ae,{variant:"secondary",className:"text-xs font-bold",children:m.size})]})]}),n.jsxs("div",{className:"flex-shrink-0 text-right",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsxs("span",{className:"text-sm font-medium",children:[m.totalSeparated,"/",m.totalNeeded]}),x?n.jsx(pn,{className:"h-4 w-4 text-green-600"}):n.jsx(en,{className:"h-4 w-4 text-blue-600"})]}),n.jsx(Mg,{value:v,className:"w-20 h-2"})]})]})})}),n.jsx(Pg,{children:n.jsxs(Be,{className:"pt-0 pb-4 px-4",children:[n.jsxs("div",{className:"space-y-2 mb-4",children:[n.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Sacolas que precisam deste item:"}),m.bags.sort((y,b)=>y.bagNumber-b.bagNumber).map(y=>n.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${y.status==="separado"||y.status==="retirado_confirmado"?"bg-green-50 border-green-200":y.status==="cancelado"?"bg-red-50 border-red-200":"bg-background"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("span",{className:"font-bold text-lg",children:["#",y.bagNumber.toString().padStart(3,"0")]}),n.jsx("span",{className:"text-primary font-medium",children:y.instagramHandle}),n.jsxs(Ae,{variant:"outline",className:"text-xs",children:["Qtd: ",y.quantity]})]}),n.jsx("div",{className:"flex items-center gap-2",children:y.status==="separado"?n.jsxs(Ae,{className:"bg-green-100 text-green-700 border-green-200",children:[n.jsx(pn,{className:"h-3 w-3 mr-1"})," Separado"]}):y.status==="cancelado"?n.jsx(Ae,{variant:"destructive",children:"Cancelado"}):n.jsx(he,{size:"sm",variant:"outline",className:"h-8 bg-green-50 border-green-200 hover:bg-green-100 text-green-700",onClick:b=>{b.stopPropagation(),h(y.itemId)},disabled:i.has(y.itemId),children:i.has(y.itemId)?n.jsx(en,{className:"h-4 w-4 animate-spin"}):n.jsxs(n.Fragment,{children:[n.jsx(pn,{className:"h-4 w-4 mr-1"}),"Separado"]})})})]},y.itemId))]}),m.totalPending>0&&n.jsxs(Ac,{children:[n.jsx(E1,{asChild:!0,children:n.jsxs(he,{variant:"outline",className:"w-full gap-2",disabled:c.has(p),children:[c.has(p)?n.jsx(en,{className:"h-4 w-4 animate-spin"}):n.jsx(pn,{className:"h-4 w-4"}),"Marcar todos como separado (",m.totalPending," pendentes)"]})}),n.jsxs(Dl,{children:[n.jsxs(Ll,{children:[n.jsx(Bl,{children:"Marcar todos como separados?"}),n.jsx($l,{children:n.jsxs("div",{className:"space-y-2",children:[n.jsxs("p",{children:[m.totalPending," unidades de ",n.jsx("strong",{children:m.productName}),m.color&&` (${m.color})`,m.size&&` - Tam. ${m.size}`," sero marcadas como separadas."]}),n.jsxs("div",{className:"flex items-start gap-2 p-2 bg-amber-50 rounded border border-amber-200 mt-2",children:[n.jsx(Mr,{className:"h-4 w-4 text-amber-600 flex-shrink-0 mt-0.5"}),n.jsx("p",{className:"text-sm text-amber-700",children:"Certifique-se de ter todas as peas em mos antes de confirmar."})]})]})})]}),n.jsxs(Tc,{children:[n.jsx(Oc,{children:"Cancelar"}),n.jsx(Pc,{onClick:()=>f(m),children:"Confirmar todos"})]})]})]})]})})]})},p)})})}var lr;(function(e){e[e.QR_CODE=0]="QR_CODE",e[e.AZTEC=1]="AZTEC",e[e.CODABAR=2]="CODABAR",e[e.CODE_39=3]="CODE_39",e[e.CODE_93=4]="CODE_93",e[e.CODE_128=5]="CODE_128",e[e.DATA_MATRIX=6]="DATA_MATRIX",e[e.MAXICODE=7]="MAXICODE",e[e.ITF=8]="ITF",e[e.EAN_13=9]="EAN_13",e[e.EAN_8=10]="EAN_8",e[e.PDF_417=11]="PDF_417",e[e.RSS_14=12]="RSS_14",e[e.RSS_EXPANDED=13]="RSS_EXPANDED",e[e.UPC_A=14]="UPC_A",e[e.UPC_E=15]="UPC_E",e[e.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(lr||(lr={}));var jB=new Map([[lr.QR_CODE,"QR_CODE"],[lr.AZTEC,"AZTEC"],[lr.CODABAR,"CODABAR"],[lr.CODE_39,"CODE_39"],[lr.CODE_93,"CODE_93"],[lr.CODE_128,"CODE_128"],[lr.DATA_MATRIX,"DATA_MATRIX"],[lr.MAXICODE,"MAXICODE"],[lr.ITF,"ITF"],[lr.EAN_13,"EAN_13"],[lr.EAN_8,"EAN_8"],[lr.PDF_417,"PDF_417"],[lr.RSS_14,"RSS_14"],[lr.RSS_EXPANDED,"RSS_EXPANDED"],[lr.UPC_A,"UPC_A"],[lr.UPC_E,"UPC_E"],[lr.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),NB;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.URL=1]="URL"})(NB||(NB={}));function AQe(e){return Object.values(lr).includes(e)}var r_;(function(e){e[e.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",e[e.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(r_||(r_={}));var TQe=function(){function e(){}return e.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",e.SCAN_DEFAULT_FPS=2,e.DEFAULT_DISABLE_FLIP=!1,e.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,e.DEFAULT_SUPPORTED_SCAN_TYPE=[r_.SCAN_TYPE_CAMERA,r_.SCAN_TYPE_FILE],e}(),ite=function(){function e(t,r){this.format=t,this.formatName=r}return e.prototype.toString=function(){return this.formatName},e.create=function(t){if(!jB.has(t))throw"".concat(t," not in html5QrcodeSupportedFormatsTextMap");return new e(t,jB.get(t))},e}(),SB=function(){function e(){}return e.createFromText=function(t){var r={text:t};return{decodedText:t,result:r}},e.createFromQrcodeResult=function(t){return{decodedText:t.text,result:t}},e}(),t6;(function(e){e[e.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",e[e.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",e[e.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(t6||(t6={}));var PQe=function(){function e(){}return e.createFrom=function(t){return{errorMessage:t,type:t6.UNKWOWN_ERROR}},e}(),OQe=function(){function e(t){this.verbose=t}return e.prototype.log=function(t){this.verbose&&console.log(t)},e.prototype.warn=function(t){this.verbose&&console.warn(t)},e.prototype.logError=function(t,r){(this.verbose||r===!0)&&console.error(t)},e.prototype.logErrors=function(t){if(t.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(t)},e}();function Vc(e){return typeof e>"u"||e===null}var Bm=function(){function e(){}return e.codeParseError=function(t){return"QR code parse error, error = ".concat(t)},e.errorGettingUserMedia=function(t){return"Error getting userMedia, error = ".concat(t)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),ote=function(){function e(){}return e.isMediaStreamConstraintsValid=function(t,r){if(typeof t!="object"){var s=typeof t;return r.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(s,"."),!0),!1}for(var a=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],i=new Set(a),o=Object.keys(t),c=0,d=o;c<d.length;c++){var l=d[c];if(i.has(l))return r.logError("".concat(l," is not supported videoConstaints."),!0),!1}return!0},e}(),r6={exports:{}};(function(e,t){(function(r,s){s(t)})(Ur,function(r){function s(xe){return xe==null}var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(xe,w){xe.__proto__=w}||function(xe,w){for(var _ in w)w.hasOwnProperty(_)&&(xe[_]=w[_])};function i(xe,w){a(xe,w);function _(){this.constructor=xe}xe.prototype=w===null?Object.create(w):(_.prototype=w.prototype,new _)}function o(xe,w){var _=Object.setPrototypeOf;_?_(xe,w):xe.__proto__=w}function c(xe,w){w===void 0&&(w=xe.constructor);var _=Error.captureStackTrace;_&&_(xe,w)}var d=function(xe){i(w,xe);function w(_){var A=this.constructor,B=xe.call(this,_)||this;return Object.defineProperty(B,"name",{value:A.name,enumerable:!1}),o(B,A.prototype),c(B),B}return w}(Error);class l extends d{constructor(w=void 0){super(w),this.message=w}getKind(){return this.constructor.kind}}l.kind="Exception";class u extends l{}u.kind="ArgumentException";class h extends l{}h.kind="IllegalArgumentException";class f{constructor(w){if(this.binarizer=w,w===null)throw new h("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(w,_){return this.binarizer.getBlackRow(w,_)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(w,_,A,B){const z=this.binarizer.getLuminanceSource().crop(w,_,A,B);return new f(this.binarizer.createBinarizer(z))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const w=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new f(this.binarizer.createBinarizer(w))}rotateCounterClockwise45(){const w=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new f(this.binarizer.createBinarizer(w))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class m extends l{static getChecksumInstance(){return new m}}m.kind="ChecksumException";class p{constructor(w){this.source=w}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class g{static arraycopy(w,_,A,B,z){for(;z--;)A[B++]=w[_++]}static currentTimeMillis(){return Date.now()}}class v extends l{}v.kind="IndexOutOfBoundsException";class x extends v{constructor(w=void 0,_=void 0){super(_),this.index=w,this.message=_}}x.kind="ArrayIndexOutOfBoundsException";class y{static fill(w,_){for(let A=0,B=w.length;A<B;A++)w[A]=_}static fillWithin(w,_,A,B){y.rangeCheck(w.length,_,A);for(let z=_;z<A;z++)w[z]=B}static rangeCheck(w,_,A){if(_>A)throw new h("fromIndex("+_+") > toIndex("+A+")");if(_<0)throw new x(_);if(A>w)throw new x(A)}static asList(...w){return w}static create(w,_,A){return Array.from({length:w}).map(z=>Array.from({length:_}).fill(A))}static createInt32Array(w,_,A){return Array.from({length:w}).map(z=>Int32Array.from({length:_}).fill(A))}static equals(w,_){if(!w||!_||!w.length||!_.length||w.length!==_.length)return!1;for(let A=0,B=w.length;A<B;A++)if(w[A]!==_[A])return!1;return!0}static hashCode(w){if(w===null)return 0;let _=1;for(const A of w)_=31*_+A;return _}static fillUint8Array(w,_){for(let A=0;A!==w.length;A++)w[A]=_}static copyOf(w,_){return w.slice(0,_)}static copyOfUint8Array(w,_){if(w.length<=_){const A=new Uint8Array(_);return A.set(w),A}return w.slice(0,_)}static copyOfRange(w,_,A){const B=A-_,z=new Int32Array(B);return g.arraycopy(w,_,z,0,B),z}static binarySearch(w,_,A){A===void 0&&(A=y.numberComparator);let B=0,z=w.length-1;for(;B<=z;){const K=z+B>>1,Q=A(_,w[K]);if(Q>0)B=K+1;else if(Q<0)z=K-1;else return K}return-B-1}static numberComparator(w,_){return w-_}}class b{static numberOfTrailingZeros(w){let _;if(w===0)return 32;let A=31;return _=w<<16,_!==0&&(A-=16,w=_),_=w<<8,_!==0&&(A-=8,w=_),_=w<<4,_!==0&&(A-=4,w=_),_=w<<2,_!==0&&(A-=2,w=_),A-(w<<1>>>31)}static numberOfLeadingZeros(w){if(w===0)return 32;let _=1;return w>>>16||(_+=16,w<<=16),w>>>24||(_+=8,w<<=8),w>>>28||(_+=4,w<<=4),w>>>30||(_+=2,w<<=2),_-=w>>>31,_}static toHexString(w){return w.toString(16)}static toBinaryString(w){return String(parseInt(String(w),2))}static bitCount(w){return w=w-(w>>>1&1431655765),w=(w&858993459)+(w>>>2&858993459),w=w+(w>>>4)&252645135,w=w+(w>>>8),w=w+(w>>>16),w&63}static truncDivision(w,_){return Math.trunc(w/_)}static parseInt(w,_=void 0){return parseInt(w,_)}}b.MIN_VALUE_32_BITS=-2147483648,b.MAX_VALUE=Number.MAX_SAFE_INTEGER;class j{constructor(w,_){w===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=w,_==null?this.bits=j.makeArray(w):this.bits=_)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(w){if(w>this.bits.length*32){const _=j.makeArray(w);g.arraycopy(this.bits,0,_,0,this.bits.length),this.bits=_}}get(w){return(this.bits[Math.floor(w/32)]&1<<(w&31))!==0}set(w){this.bits[Math.floor(w/32)]|=1<<(w&31)}flip(w){this.bits[Math.floor(w/32)]^=1<<(w&31)}getNextSet(w){const _=this.size;if(w>=_)return _;const A=this.bits;let B=Math.floor(w/32),z=A[B];z&=~((1<<(w&31))-1);const K=A.length;for(;z===0;){if(++B===K)return _;z=A[B]}const Q=B*32+b.numberOfTrailingZeros(z);return Q>_?_:Q}getNextUnset(w){const _=this.size;if(w>=_)return _;const A=this.bits;let B=Math.floor(w/32),z=~A[B];z&=~((1<<(w&31))-1);const K=A.length;for(;z===0;){if(++B===K)return _;z=~A[B]}const Q=B*32+b.numberOfTrailingZeros(z);return Q>_?_:Q}setBulk(w,_){this.bits[Math.floor(w/32)]=_}setRange(w,_){if(_<w||w<0||_>this.size)throw new h;if(_===w)return;_--;const A=Math.floor(w/32),B=Math.floor(_/32),z=this.bits;for(let K=A;K<=B;K++){const Q=K>A?0:w&31,ae=(2<<(K<B?31:_&31))-(1<<Q);z[K]|=ae}}clear(){const w=this.bits.length,_=this.bits;for(let A=0;A<w;A++)_[A]=0}isRange(w,_,A){if(_<w||w<0||_>this.size)throw new h;if(_===w)return!0;_--;const B=Math.floor(w/32),z=Math.floor(_/32),K=this.bits;for(let Q=B;Q<=z;Q++){const te=Q>B?0:w&31,me=(2<<(Q<z?31:_&31))-(1<<te)&4294967295;if((K[Q]&me)!==(A?me:0))return!1}return!0}appendBit(w){this.ensureCapacity(this.size+1),w&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(w,_){if(_<0||_>32)throw new h("Num bits must be between 0 and 32");this.ensureCapacity(this.size+_);for(let A=_;A>0;A--)this.appendBit((w>>A-1&1)===1)}appendBitArray(w){const _=w.size;this.ensureCapacity(this.size+_);for(let A=0;A<_;A++)this.appendBit(w.get(A))}xor(w){if(this.size!==w.size)throw new h("Sizes don't match");const _=this.bits;for(let A=0,B=_.length;A<B;A++)_[A]^=w.bits[A]}toBytes(w,_,A,B){for(let z=0;z<B;z++){let K=0;for(let Q=0;Q<8;Q++)this.get(w)&&(K|=1<<7-Q),w++;_[A+z]=K}}getBitArray(){return this.bits}reverse(){const w=new Int32Array(this.bits.length),_=Math.floor((this.size-1)/32),A=_+1,B=this.bits;for(let z=0;z<A;z++){let K=B[z];K=K>>1&1431655765|(K&1431655765)<<1,K=K>>2&858993459|(K&858993459)<<2,K=K>>4&252645135|(K&252645135)<<4,K=K>>8&16711935|(K&16711935)<<8,K=K>>16&65535|(K&65535)<<16,w[_-z]=K}if(this.size!==A*32){const z=A*32-this.size;let K=w[0]>>>z;for(let Q=1;Q<A;Q++){const te=w[Q];K|=te<<32-z,w[Q-1]=K,K=te>>>z}w[A-1]=K}this.bits=w}static makeArray(w){return new Int32Array(Math.floor((w+31)/32))}equals(w){if(!(w instanceof j))return!1;const _=w;return this.size===_.size&&y.equals(this.bits,_.bits)}hashCode(){return 31*this.size+y.hashCode(this.bits)}toString(){let w="";for(let _=0,A=this.size;_<A;_++)_&7||(w+=" "),w+=this.get(_)?"X":".";return w}clone(){return new j(this.size,this.bits.slice())}}var T;(function(xe){xe[xe.OTHER=0]="OTHER",xe[xe.PURE_BARCODE=1]="PURE_BARCODE",xe[xe.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",xe[xe.TRY_HARDER=3]="TRY_HARDER",xe[xe.CHARACTER_SET=4]="CHARACTER_SET",xe[xe.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",xe[xe.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",xe[xe.ASSUME_GS1=7]="ASSUME_GS1",xe[xe.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",xe[xe.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",xe[xe.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(T||(T={}));var O=T;class R extends l{static getFormatInstance(){return new R}}R.kind="FormatException";var D;(function(xe){xe[xe.Cp437=0]="Cp437",xe[xe.ISO8859_1=1]="ISO8859_1",xe[xe.ISO8859_2=2]="ISO8859_2",xe[xe.ISO8859_3=3]="ISO8859_3",xe[xe.ISO8859_4=4]="ISO8859_4",xe[xe.ISO8859_5=5]="ISO8859_5",xe[xe.ISO8859_6=6]="ISO8859_6",xe[xe.ISO8859_7=7]="ISO8859_7",xe[xe.ISO8859_8=8]="ISO8859_8",xe[xe.ISO8859_9=9]="ISO8859_9",xe[xe.ISO8859_10=10]="ISO8859_10",xe[xe.ISO8859_11=11]="ISO8859_11",xe[xe.ISO8859_13=12]="ISO8859_13",xe[xe.ISO8859_14=13]="ISO8859_14",xe[xe.ISO8859_15=14]="ISO8859_15",xe[xe.ISO8859_16=15]="ISO8859_16",xe[xe.SJIS=16]="SJIS",xe[xe.Cp1250=17]="Cp1250",xe[xe.Cp1251=18]="Cp1251",xe[xe.Cp1252=19]="Cp1252",xe[xe.Cp1256=20]="Cp1256",xe[xe.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",xe[xe.UTF8=22]="UTF8",xe[xe.ASCII=23]="ASCII",xe[xe.Big5=24]="Big5",xe[xe.GB18030=25]="GB18030",xe[xe.EUC_KR=26]="EUC_KR"})(D||(D={}));class L{constructor(w,_,A,...B){this.valueIdentifier=w,this.name=A,typeof _=="number"?this.values=Int32Array.from([_]):this.values=_,this.otherEncodingNames=B,L.VALUE_IDENTIFIER_TO_ECI.set(w,this),L.NAME_TO_ECI.set(A,this);const z=this.values;for(let K=0,Q=z.length;K!==Q;K++){const te=z[K];L.VALUES_TO_ECI.set(te,this)}for(const K of B)L.NAME_TO_ECI.set(K,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(w){if(w<0||w>=900)throw new R("incorect value");const _=L.VALUES_TO_ECI.get(w);if(_===void 0)throw new R("incorect value");return _}static getCharacterSetECIByName(w){const _=L.NAME_TO_ECI.get(w);if(_===void 0)throw new R("incorect value");return _}equals(w){if(!(w instanceof L))return!1;const _=w;return this.getName()===_.getName()}}L.VALUE_IDENTIFIER_TO_ECI=new Map,L.VALUES_TO_ECI=new Map,L.NAME_TO_ECI=new Map,L.Cp437=new L(D.Cp437,Int32Array.from([0,2]),"Cp437"),L.ISO8859_1=new L(D.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),L.ISO8859_2=new L(D.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),L.ISO8859_3=new L(D.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),L.ISO8859_4=new L(D.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),L.ISO8859_5=new L(D.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),L.ISO8859_6=new L(D.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),L.ISO8859_7=new L(D.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),L.ISO8859_8=new L(D.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),L.ISO8859_9=new L(D.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),L.ISO8859_10=new L(D.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),L.ISO8859_11=new L(D.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),L.ISO8859_13=new L(D.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),L.ISO8859_14=new L(D.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),L.ISO8859_15=new L(D.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),L.ISO8859_16=new L(D.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),L.SJIS=new L(D.SJIS,20,"SJIS","Shift_JIS"),L.Cp1250=new L(D.Cp1250,21,"Cp1250","windows-1250"),L.Cp1251=new L(D.Cp1251,22,"Cp1251","windows-1251"),L.Cp1252=new L(D.Cp1252,23,"Cp1252","windows-1252"),L.Cp1256=new L(D.Cp1256,24,"Cp1256","windows-1256"),L.UnicodeBigUnmarked=new L(D.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),L.UTF8=new L(D.UTF8,26,"UTF8","UTF-8"),L.ASCII=new L(D.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),L.Big5=new L(D.Big5,28,"Big5"),L.GB18030=new L(D.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),L.EUC_KR=new L(D.EUC_KR,30,"EUC_KR","EUC-KR");class q extends l{}q.kind="UnsupportedOperationException";class X{static decode(w,_){const A=this.encodingName(_);return this.customDecoder?this.customDecoder(w,A):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(A)?this.decodeFallback(w,A):new TextDecoder(A).decode(w)}static shouldDecodeOnFallback(w){return!X.isBrowser()&&w==="ISO-8859-1"}static encode(w,_){const A=this.encodingName(_);return this.customEncoder?this.customEncoder(w,A):typeof TextEncoder>"u"?this.encodeFallback(w):new TextEncoder().encode(w)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(w){return typeof w=="string"?w:w.getName()}static encodingCharacterSet(w){return w instanceof L?w:L.getCharacterSetECIByName(w)}static decodeFallback(w,_){const A=this.encodingCharacterSet(_);if(X.isDecodeFallbackSupported(A)){let B="";for(let z=0,K=w.length;z<K;z++){let Q=w[z].toString(16);Q.length<2&&(Q="0"+Q),B+="%"+Q}return decodeURIComponent(B)}if(A.equals(L.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(w.buffer));throw new q(`Encoding ${this.encodingName(_)} not supported by fallback.`)}static isDecodeFallbackSupported(w){return w.equals(L.UTF8)||w.equals(L.ISO8859_1)||w.equals(L.ASCII)}static encodeFallback(w){const A=btoa(unescape(encodeURIComponent(w))).split(""),B=[];for(let z=0;z<A.length;z++)B.push(A[z].charCodeAt(0));return new Uint8Array(B)}}class H{static castAsNonUtf8Char(w,_=null){const A=_?_.getName():this.ISO88591;return X.decode(new Uint8Array([w]),A)}static guessEncoding(w,_){if(_!=null&&_.get(O.CHARACTER_SET)!==void 0)return _.get(O.CHARACTER_SET).toString();const A=w.length;let B=!0,z=!0,K=!0,Q=0,te=0,ae=0,me=0,ve=0,je=0,Oe=0,Ue=0,He=0,nt=0,pt=0;const $t=w.length>3&&w[0]===239&&w[1]===187&&w[2]===191;for(let Ft=0;Ft<A&&(B||z||K);Ft++){const Rt=w[Ft]&255;K&&(Q>0?Rt&128?Q--:K=!1:Rt&128&&(Rt&64?(Q++,Rt&32?(Q++,Rt&16?(Q++,Rt&8?K=!1:me++):ae++):te++):K=!1)),B&&(Rt>127&&Rt<160?B=!1:Rt>159&&(Rt<192||Rt===215||Rt===247)&&pt++),z&&(ve>0?Rt<64||Rt===127||Rt>252?z=!1:ve--:Rt===128||Rt===160||Rt>239?z=!1:Rt>160&&Rt<224?(je++,Ue=0,Oe++,Oe>He&&(He=Oe)):Rt>127?(ve++,Oe=0,Ue++,Ue>nt&&(nt=Ue)):(Oe=0,Ue=0))}return K&&Q>0&&(K=!1),z&&ve>0&&(z=!1),K&&($t||te+ae+me>0)?H.UTF8:z&&(H.ASSUME_SHIFT_JIS||He>=3||nt>=3)?H.SHIFT_JIS:B&&z?He===2&&je===2||pt*10>=A?H.SHIFT_JIS:H.ISO88591:B?H.ISO88591:z?H.SHIFT_JIS:K?H.UTF8:H.PLATFORM_DEFAULT_ENCODING}static format(w,..._){let A=-1;function B(K,Q,te,ae,me,ve){if(K==="%%")return"%";if(_[++A]===void 0)return;K=ae?parseInt(ae.substr(1)):void 0;let je=me?parseInt(me.substr(1)):void 0,Oe;switch(ve){case"s":Oe=_[A];break;case"c":Oe=_[A][0];break;case"f":Oe=parseFloat(_[A]).toFixed(K);break;case"p":Oe=parseFloat(_[A]).toPrecision(K);break;case"e":Oe=parseFloat(_[A]).toExponential(K);break;case"x":Oe=parseInt(_[A]).toString(je||16);break;case"d":Oe=parseFloat(parseInt(_[A],je||10).toPrecision(K)).toFixed(0);break}Oe=typeof Oe=="object"?JSON.stringify(Oe):(+Oe).toString(je);let Ue=parseInt(te),He=te&&te[0]+""=="0"?"0":" ";for(;Oe.length<Ue;)Oe=Q!==void 0?Oe+He:He+Oe;return Oe}let z=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return w.replace(z,B)}static getBytes(w,_){return X.encode(w,_)}static getCharCode(w,_=0){return w.charCodeAt(_)}static getCharAt(w){return String.fromCharCode(w)}}H.SHIFT_JIS=L.SJIS.getName(),H.GB2312="GB2312",H.ISO88591=L.ISO8859_1.getName(),H.EUC_JP="EUC_JP",H.UTF8=L.UTF8.getName(),H.PLATFORM_DEFAULT_ENCODING=H.UTF8,H.ASSUME_SHIFT_JIS=!1;class M{constructor(w=""){this.value=w}enableDecoding(w){return this.encoding=w,this}append(w){return typeof w=="string"?this.value+=w.toString():this.encoding?this.value+=H.castAsNonUtf8Char(w,this.encoding):this.value+=String.fromCharCode(w),this}appendChars(w,_,A){for(let B=_;_<_+A;B++)this.append(w[B]);return this}length(){return this.value.length}charAt(w){return this.value.charAt(w)}deleteCharAt(w){this.value=this.value.substr(0,w)+this.value.substring(w+1)}setCharAt(w,_){this.value=this.value.substr(0,w)+_+this.value.substr(w+1)}substring(w,_){return this.value.substring(w,_)}setLengthToZero(){this.value=""}toString(){return this.value}insert(w,_){this.value=this.value.substr(0,w)+_+this.value.substr(w+_.length)}}class F{constructor(w,_,A,B){if(this.width=w,this.height=_,this.rowSize=A,this.bits=B,_==null&&(_=w),this.height=_,w<1||_<1)throw new h("Both dimensions must be greater than 0");A==null&&(A=Math.floor((w+31)/32)),this.rowSize=A,B==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(w){const _=w.length,A=w[0].length,B=new F(A,_);for(let z=0;z<_;z++){const K=w[z];for(let Q=0;Q<A;Q++)K[Q]&&B.set(Q,z)}return B}static parseFromString(w,_,A){if(w===null)throw new h("stringRepresentation cannot be null");const B=new Array(w.length);let z=0,K=0,Q=-1,te=0,ae=0;for(;ae<w.length;)if(w.charAt(ae)===`
`||w.charAt(ae)==="\r"){if(z>K){if(Q===-1)Q=z-K;else if(z-K!==Q)throw new h("row lengths do not match");K=z,te++}ae++}else if(w.substring(ae,ae+_.length)===_)ae+=_.length,B[z]=!0,z++;else if(w.substring(ae,ae+A.length)===A)ae+=A.length,B[z]=!1,z++;else throw new h("illegal character encountered: "+w.substring(ae));if(z>K){if(Q===-1)Q=z-K;else if(z-K!==Q)throw new h("row lengths do not match");te++}const me=new F(Q,te);for(let ve=0;ve<z;ve++)B[ve]&&me.set(Math.floor(ve%Q),Math.floor(ve/Q));return me}get(w,_){const A=_*this.rowSize+Math.floor(w/32);return(this.bits[A]>>>(w&31)&1)!==0}set(w,_){const A=_*this.rowSize+Math.floor(w/32);this.bits[A]|=1<<(w&31)&4294967295}unset(w,_){const A=_*this.rowSize+Math.floor(w/32);this.bits[A]&=~(1<<(w&31)&4294967295)}flip(w,_){const A=_*this.rowSize+Math.floor(w/32);this.bits[A]^=1<<(w&31)&4294967295}xor(w){if(this.width!==w.getWidth()||this.height!==w.getHeight()||this.rowSize!==w.getRowSize())throw new h("input matrix dimensions do not match");const _=new j(Math.floor(this.width/32)+1),A=this.rowSize,B=this.bits;for(let z=0,K=this.height;z<K;z++){const Q=z*A,te=w.getRow(z,_).getBitArray();for(let ae=0;ae<A;ae++)B[Q+ae]^=te[ae]}}clear(){const w=this.bits,_=w.length;for(let A=0;A<_;A++)w[A]=0}setRegion(w,_,A,B){if(_<0||w<0)throw new h("Left and top must be nonnegative");if(B<1||A<1)throw new h("Height and width must be at least 1");const z=w+A,K=_+B;if(K>this.height||z>this.width)throw new h("The region must fit inside the matrix");const Q=this.rowSize,te=this.bits;for(let ae=_;ae<K;ae++){const me=ae*Q;for(let ve=w;ve<z;ve++)te[me+Math.floor(ve/32)]|=1<<(ve&31)&4294967295}}getRow(w,_){_==null||_.getSize()<this.width?_=new j(this.width):_.clear();const A=this.rowSize,B=this.bits,z=w*A;for(let K=0;K<A;K++)_.setBulk(K*32,B[z+K]);return _}setRow(w,_){g.arraycopy(_.getBitArray(),0,this.bits,w*this.rowSize,this.rowSize)}rotate180(){const w=this.getWidth(),_=this.getHeight();let A=new j(w),B=new j(w);for(let z=0,K=Math.floor((_+1)/2);z<K;z++)A=this.getRow(z,A),B=this.getRow(_-1-z,B),A.reverse(),B.reverse(),this.setRow(z,B),this.setRow(_-1-z,A)}getEnclosingRectangle(){const w=this.width,_=this.height,A=this.rowSize,B=this.bits;let z=w,K=_,Q=-1,te=-1;for(let ae=0;ae<_;ae++)for(let me=0;me<A;me++){const ve=B[ae*A+me];if(ve!==0){if(ae<K&&(K=ae),ae>te&&(te=ae),me*32<z){let je=0;for(;!(ve<<31-je&4294967295);)je++;me*32+je<z&&(z=me*32+je)}if(me*32+31>Q){let je=31;for(;!(ve>>>je);)je--;me*32+je>Q&&(Q=me*32+je)}}}return Q<z||te<K?null:Int32Array.from([z,K,Q-z+1,te-K+1])}getTopLeftOnBit(){const w=this.rowSize,_=this.bits;let A=0;for(;A<_.length&&_[A]===0;)A++;if(A===_.length)return null;const B=A/w;let z=A%w*32;const K=_[A];let Q=0;for(;!(K<<31-Q&4294967295);)Q++;return z+=Q,Int32Array.from([z,B])}getBottomRightOnBit(){const w=this.rowSize,_=this.bits;let A=_.length-1;for(;A>=0&&_[A]===0;)A--;if(A<0)return null;const B=Math.floor(A/w);let z=Math.floor(A%w)*32;const K=_[A];let Q=31;for(;!(K>>>Q);)Q--;return z+=Q,Int32Array.from([z,B])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(w){if(!(w instanceof F))return!1;const _=w;return this.width===_.width&&this.height===_.height&&this.rowSize===_.rowSize&&y.equals(this.bits,_.bits)}hashCode(){let w=this.width;return w=31*w+this.width,w=31*w+this.height,w=31*w+this.rowSize,w=31*w+y.hashCode(this.bits),w}toString(w="X ",_="  ",A=`
`){return this.buildToString(w,_,A)}buildToString(w,_,A){let B=new M;for(let z=0,K=this.height;z<K;z++){for(let Q=0,te=this.width;Q<te;Q++)B.append(this.get(Q,z)?w:_);B.append(A)}return B.toString()}clone(){return new F(this.width,this.height,this.rowSize,this.bits.slice())}}class S extends l{static getNotFoundInstance(){return new S}}S.kind="NotFoundException";class E extends p{constructor(w){super(w),this.luminances=E.EMPTY,this.buckets=new Int32Array(E.LUMINANCE_BUCKETS)}getBlackRow(w,_){const A=this.getLuminanceSource(),B=A.getWidth();_==null||_.getSize()<B?_=new j(B):_.clear(),this.initArrays(B);const z=A.getRow(w,this.luminances),K=this.buckets;for(let te=0;te<B;te++)K[(z[te]&255)>>E.LUMINANCE_SHIFT]++;const Q=E.estimateBlackPoint(K);if(B<3)for(let te=0;te<B;te++)(z[te]&255)<Q&&_.set(te);else{let te=z[0]&255,ae=z[1]&255;for(let me=1;me<B-1;me++){const ve=z[me+1]&255;(ae*4-te-ve)/2<Q&&_.set(me),te=ae,ae=ve}}return _}getBlackMatrix(){const w=this.getLuminanceSource(),_=w.getWidth(),A=w.getHeight(),B=new F(_,A);this.initArrays(_);const z=this.buckets;for(let te=1;te<5;te++){const ae=Math.floor(A*te/5),me=w.getRow(ae,this.luminances),ve=Math.floor(_*4/5);for(let je=Math.floor(_/5);je<ve;je++){const Oe=me[je]&255;z[Oe>>E.LUMINANCE_SHIFT]++}}const K=E.estimateBlackPoint(z),Q=w.getMatrix();for(let te=0;te<A;te++){const ae=te*_;for(let me=0;me<_;me++)(Q[ae+me]&255)<K&&B.set(me,te)}return B}createBinarizer(w){return new E(w)}initArrays(w){this.luminances.length<w&&(this.luminances=new Uint8ClampedArray(w));const _=this.buckets;for(let A=0;A<E.LUMINANCE_BUCKETS;A++)_[A]=0}static estimateBlackPoint(w){const _=w.length;let A=0,B=0,z=0;for(let me=0;me<_;me++)w[me]>z&&(B=me,z=w[me]),w[me]>A&&(A=w[me]);let K=0,Q=0;for(let me=0;me<_;me++){const ve=me-B,je=w[me]*ve*ve;je>Q&&(K=me,Q=je)}if(B>K){const me=B;B=K,K=me}if(K-B<=_/16)throw new S;let te=K-1,ae=-1;for(let me=K-1;me>B;me--){const ve=me-B,je=ve*ve*(K-me)*(A-w[me]);je>ae&&(te=me,ae=je)}return te<<E.LUMINANCE_SHIFT}}E.LUMINANCE_BITS=5,E.LUMINANCE_SHIFT=8-E.LUMINANCE_BITS,E.LUMINANCE_BUCKETS=1<<E.LUMINANCE_BITS,E.EMPTY=Uint8ClampedArray.from([0]);class N extends E{constructor(w){super(w),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const w=this.getLuminanceSource(),_=w.getWidth(),A=w.getHeight();if(_>=N.MINIMUM_DIMENSION&&A>=N.MINIMUM_DIMENSION){const B=w.getMatrix();let z=_>>N.BLOCK_SIZE_POWER;_&N.BLOCK_SIZE_MASK&&z++;let K=A>>N.BLOCK_SIZE_POWER;A&N.BLOCK_SIZE_MASK&&K++;const Q=N.calculateBlackPoints(B,z,K,_,A),te=new F(_,A);N.calculateThresholdForBlock(B,z,K,_,A,Q,te),this.matrix=te}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(w){return new N(w)}static calculateThresholdForBlock(w,_,A,B,z,K,Q){const te=z-N.BLOCK_SIZE,ae=B-N.BLOCK_SIZE;for(let me=0;me<A;me++){let ve=me<<N.BLOCK_SIZE_POWER;ve>te&&(ve=te);const je=N.cap(me,2,A-3);for(let Oe=0;Oe<_;Oe++){let Ue=Oe<<N.BLOCK_SIZE_POWER;Ue>ae&&(Ue=ae);const He=N.cap(Oe,2,_-3);let nt=0;for(let $t=-2;$t<=2;$t++){const Ft=K[je+$t];nt+=Ft[He-2]+Ft[He-1]+Ft[He]+Ft[He+1]+Ft[He+2]}const pt=nt/25;N.thresholdBlock(w,Ue,ve,pt,B,Q)}}}static cap(w,_,A){return w<_?_:w>A?A:w}static thresholdBlock(w,_,A,B,z,K){for(let Q=0,te=A*z+_;Q<N.BLOCK_SIZE;Q++,te+=z)for(let ae=0;ae<N.BLOCK_SIZE;ae++)(w[te+ae]&255)<=B&&K.set(_+ae,A+Q)}static calculateBlackPoints(w,_,A,B,z){const K=z-N.BLOCK_SIZE,Q=B-N.BLOCK_SIZE,te=new Array(A);for(let ae=0;ae<A;ae++){te[ae]=new Int32Array(_);let me=ae<<N.BLOCK_SIZE_POWER;me>K&&(me=K);for(let ve=0;ve<_;ve++){let je=ve<<N.BLOCK_SIZE_POWER;je>Q&&(je=Q);let Oe=0,Ue=255,He=0;for(let pt=0,$t=me*B+je;pt<N.BLOCK_SIZE;pt++,$t+=B){for(let Ft=0;Ft<N.BLOCK_SIZE;Ft++){const Rt=w[$t+Ft]&255;Oe+=Rt,Rt<Ue&&(Ue=Rt),Rt>He&&(He=Rt)}if(He-Ue>N.MIN_DYNAMIC_RANGE)for(pt++,$t+=B;pt<N.BLOCK_SIZE;pt++,$t+=B)for(let Ft=0;Ft<N.BLOCK_SIZE;Ft++)Oe+=w[$t+Ft]&255}let nt=Oe>>N.BLOCK_SIZE_POWER*2;if(He-Ue<=N.MIN_DYNAMIC_RANGE&&(nt=Ue/2,ae>0&&ve>0)){const pt=(te[ae-1][ve]+2*te[ae][ve-1]+te[ae-1][ve-1])/4;Ue<pt&&(nt=pt)}te[ae][ve]=nt}}return te}}N.BLOCK_SIZE_POWER=3,N.BLOCK_SIZE=1<<N.BLOCK_SIZE_POWER,N.BLOCK_SIZE_MASK=N.BLOCK_SIZE-1,N.MINIMUM_DIMENSION=N.BLOCK_SIZE*5,N.MIN_DYNAMIC_RANGE=24;class C{constructor(w,_){this.width=w,this.height=_}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(w,_,A,B){throw new q("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new q("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new q("This luminance source does not support rotation by 45 degrees.")}toString(){const w=new Uint8ClampedArray(this.width);let _=new M;for(let A=0;A<this.height;A++){const B=this.getRow(A,w);for(let z=0;z<this.width;z++){const K=B[z]&255;let Q;K<64?Q="#":K<128?Q="+":K<192?Q=".":Q=" ",_.append(Q)}_.append(`
`)}return _.toString()}}class k extends C{constructor(w){super(w.getWidth(),w.getHeight()),this.delegate=w}getRow(w,_){const A=this.delegate.getRow(w,_),B=this.getWidth();for(let z=0;z<B;z++)A[z]=255-(A[z]&255);return A}getMatrix(){const w=this.delegate.getMatrix(),_=this.getWidth()*this.getHeight(),A=new Uint8ClampedArray(_);for(let B=0;B<_;B++)A[B]=255-(w[B]&255);return A}isCropSupported(){return this.delegate.isCropSupported()}crop(w,_,A,B){return new k(this.delegate.crop(w,_,A,B))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new k(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new k(this.delegate.rotateCounterClockwise45())}}class I extends C{constructor(w){super(w.width,w.height),this.canvas=w,this.tempCanvasElement=null,this.buffer=I.makeBufferFromCanvasImageData(w)}static makeBufferFromCanvasImageData(w){const _=w.getContext("2d").getImageData(0,0,w.width,w.height);return I.toGrayscaleBuffer(_.data,w.width,w.height)}static toGrayscaleBuffer(w,_,A){const B=new Uint8ClampedArray(_*A);for(let z=0,K=0,Q=w.length;z<Q;z+=4,K++){let te;if(w[z+3]===0)te=255;else{const me=w[z],ve=w[z+1],je=w[z+2];te=306*me+601*ve+117*je+512>>10}B[K]=te}return B}getRow(w,_){if(w<0||w>=this.getHeight())throw new h("Requested row is outside the image: "+w);const A=this.getWidth(),B=w*A;return _===null?_=this.buffer.slice(B,B+A):(_.length<A&&(_=new Uint8ClampedArray(A)),_.set(this.buffer.slice(B,B+A))),_}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(w,_,A,B){return super.crop(w,_,A,B),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const w=this.canvas.ownerDocument.createElement("canvas");w.width=this.canvas.width,w.height=this.canvas.height,this.tempCanvasElement=w}return this.tempCanvasElement}rotate(w){const _=this.getTempCanvasElement(),A=_.getContext("2d"),B=w*I.DEGREE_TO_RADIANS,z=this.canvas.width,K=this.canvas.height,Q=Math.ceil(Math.abs(Math.cos(B))*z+Math.abs(Math.sin(B))*K),te=Math.ceil(Math.abs(Math.sin(B))*z+Math.abs(Math.cos(B))*K);return _.width=Q,_.height=te,A.translate(Q/2,te/2),A.rotate(B),A.drawImage(this.canvas,z/-2,K/-2),this.buffer=I.makeBufferFromCanvasImageData(_),this}invert(){return new k(this)}}I.DEGREE_TO_RADIANS=Math.PI/180;class U{constructor(w,_,A){this.deviceId=w,this.label=_,this.kind="videoinput",this.groupId=A||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var $=(globalThis||Ur||self||window||void 0)&&(globalThis||Ur||self||window||void 0).__awaiter||function(xe,w,_,A){function B(z){return z instanceof _?z:new _(function(K){K(z)})}return new(_||(_=Promise))(function(z,K){function Q(me){try{ae(A.next(me))}catch(ve){K(ve)}}function te(me){try{ae(A.throw(me))}catch(ve){K(ve)}}function ae(me){me.done?z(me.value):B(me.value).then(Q,te)}ae((A=A.apply(xe,w||[])).next())})};class Y{constructor(w,_=500,A){this.reader=w,this.timeBetweenScansMillis=_,this._hints=A,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(w){this._timeBetweenDecodingAttempts=w<0?0:w}set hints(w){this._hints=w||null}get hints(){return this._hints}listVideoInputDevices(){return $(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const w=yield navigator.mediaDevices.enumerateDevices(),_=[];for(const A of w){const B=A.kind==="video"?"videoinput":A.kind;if(B!=="videoinput")continue;const z=A.deviceId||A.id,K=A.label||`Video device ${_.length+1}`,Q=A.groupId,te={deviceId:z,label:K,kind:B,groupId:Q};_.push(te)}return _})}getVideoInputDevices(){return $(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(_=>new U(_.deviceId,_.label))})}findDeviceById(w){return $(this,void 0,void 0,function*(){const _=yield this.listVideoInputDevices();return _?_.find(A=>A.deviceId===w):null})}decodeFromInputVideoDevice(w,_){return $(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(w,_)})}decodeOnceFromVideoDevice(w,_){return $(this,void 0,void 0,function*(){this.reset();let A;w?A={deviceId:{exact:w}}:A={facingMode:"environment"};const B={video:A};return yield this.decodeOnceFromConstraints(B,_)})}decodeOnceFromConstraints(w,_){return $(this,void 0,void 0,function*(){const A=yield navigator.mediaDevices.getUserMedia(w);return yield this.decodeOnceFromStream(A,_)})}decodeOnceFromStream(w,_){return $(this,void 0,void 0,function*(){this.reset();const A=yield this.attachStreamToVideo(w,_);return yield this.decodeOnce(A)})}decodeFromInputVideoDeviceContinuously(w,_,A){return $(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(w,_,A)})}decodeFromVideoDevice(w,_,A){return $(this,void 0,void 0,function*(){let B;w?B={deviceId:{exact:w}}:B={facingMode:"environment"};const z={video:B};return yield this.decodeFromConstraints(z,_,A)})}decodeFromConstraints(w,_,A){return $(this,void 0,void 0,function*(){const B=yield navigator.mediaDevices.getUserMedia(w);return yield this.decodeFromStream(B,_,A)})}decodeFromStream(w,_,A){return $(this,void 0,void 0,function*(){this.reset();const B=yield this.attachStreamToVideo(w,_);return yield this.decodeContinuously(B,A)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(w,_){return $(this,void 0,void 0,function*(){const A=this.prepareVideoElement(_);return this.addVideoSource(A,w),this.videoElement=A,this.stream=w,yield this.playVideoOnLoadAsync(A),A})}playVideoOnLoadAsync(w){return new Promise((_,A)=>this.playVideoOnLoad(w,()=>_()))}playVideoOnLoad(w,_){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(w),w.addEventListener("ended",this.videoEndedListener),w.addEventListener("canplay",this.videoCanPlayListener),w.addEventListener("playing",_),this.tryPlayVideo(w)}isVideoPlaying(w){return w.currentTime>0&&!w.paused&&!w.ended&&w.readyState>2}tryPlayVideo(w){return $(this,void 0,void 0,function*(){if(this.isVideoPlaying(w)){console.warn("Trying to play video that is already playing.");return}try{yield w.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(w,_){const A=document.getElementById(w);if(!A)throw new u(`element with id '${w}' not found`);if(A.nodeName.toLowerCase()!==_.toLowerCase())throw new u(`element with id '${w}' must be an ${_} element`);return A}decodeFromImage(w,_){if(!w&&!_)throw new u("either imageElement with a src set or an url must be provided");return _&&!w?this.decodeFromImageUrl(_):this.decodeFromImageElement(w)}decodeFromVideo(w,_){if(!w&&!_)throw new u("Either an element with a src set or an URL must be provided");return _&&!w?this.decodeFromVideoUrl(_):this.decodeFromVideoElement(w)}decodeFromVideoContinuously(w,_,A){if(w===void 0&&_===void 0)throw new u("Either an element with a src set or an URL must be provided");return _&&!w?this.decodeFromVideoUrlContinuously(_,A):this.decodeFromVideoElementContinuously(w,A)}decodeFromImageElement(w){if(!w)throw new u("An image element must be provided.");this.reset();const _=this.prepareImageElement(w);this.imageElement=_;let A;return this.isImageLoaded(_)?A=this.decodeOnce(_,!1,!0):A=this._decodeOnLoadImage(_),A}decodeFromVideoElement(w){const _=this._decodeFromVideoElementSetup(w);return this._decodeOnLoadVideo(_)}decodeFromVideoElementContinuously(w,_){const A=this._decodeFromVideoElementSetup(w);return this._decodeOnLoadVideoContinuously(A,_)}_decodeFromVideoElementSetup(w){if(!w)throw new u("A video element must be provided.");this.reset();const _=this.prepareVideoElement(w);return this.videoElement=_,_}decodeFromImageUrl(w){if(!w)throw new u("An URL must be provided.");this.reset();const _=this.prepareImageElement();this.imageElement=_;const A=this._decodeOnLoadImage(_);return _.src=w,A}decodeFromVideoUrl(w){if(!w)throw new u("An URL must be provided.");this.reset();const _=this.prepareVideoElement(),A=this.decodeFromVideoElement(_);return _.src=w,A}decodeFromVideoUrlContinuously(w,_){if(!w)throw new u("An URL must be provided.");this.reset();const A=this.prepareVideoElement(),B=this.decodeFromVideoElementContinuously(A,_);return A.src=w,B}_decodeOnLoadImage(w){return new Promise((_,A)=>{this.imageLoadedListener=()=>this.decodeOnce(w,!1,!0).then(_,A),w.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(w){return $(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(w),yield this.decodeOnce(w)})}_decodeOnLoadVideoContinuously(w,_){return $(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(w),this.decodeContinuously(w,_)})}isImageLoaded(w){return!(!w.complete||w.naturalWidth===0)}prepareImageElement(w){let _;return typeof w>"u"&&(_=document.createElement("img"),_.width=200,_.height=200),typeof w=="string"&&(_=this.getMediaElement(w,"img")),w instanceof HTMLImageElement&&(_=w),_}prepareVideoElement(w){let _;return!w&&typeof document<"u"&&(_=document.createElement("video"),_.width=200,_.height=200),typeof w=="string"&&(_=this.getMediaElement(w,"video")),w instanceof HTMLVideoElement&&(_=w),_.setAttribute("autoplay","true"),_.setAttribute("muted","true"),_.setAttribute("playsinline","true"),_}decodeOnce(w,_=!0,A=!0){this._stopAsyncDecode=!1;const B=(z,K)=>{if(this._stopAsyncDecode){K(new S("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const Q=this.decode(w);z(Q)}catch(Q){const te=_&&Q instanceof S,me=(Q instanceof m||Q instanceof R)&&A;if(te||me)return setTimeout(B,this._timeBetweenDecodingAttempts,z,K);K(Q)}};return new Promise((z,K)=>B(z,K))}decodeContinuously(w,_){this._stopContinuousDecode=!1;const A=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const B=this.decode(w);_(B,null),setTimeout(A,this.timeBetweenScansMillis)}catch(B){_(null,B);const z=B instanceof m||B instanceof R,K=B instanceof S;(z||K)&&setTimeout(A,this._timeBetweenDecodingAttempts)}};A()}decode(w){const _=this.createBinaryBitmap(w);return this.decodeBitmap(_)}_isHTMLVideoElement(w){return w.videoWidth!==0}drawFrameOnCanvas(w,_,A){_||(_={sx:0,sy:0,sWidth:w.videoWidth,sHeight:w.videoHeight,dx:0,dy:0,dWidth:w.videoWidth,dHeight:w.videoHeight}),A||(A=this.captureCanvasContext),A.drawImage(w,_.sx,_.sy,_.sWidth,_.sHeight,_.dx,_.dy,_.dWidth,_.dHeight)}drawImageOnCanvas(w,_,A=this.captureCanvasContext){_||(_={sx:0,sy:0,sWidth:w.naturalWidth,sHeight:w.naturalHeight,dx:0,dy:0,dWidth:w.naturalWidth,dHeight:w.naturalHeight}),A||(A=this.captureCanvasContext),A.drawImage(w,_.sx,_.sy,_.sWidth,_.sHeight,_.dx,_.dy,_.dWidth,_.dHeight)}createBinaryBitmap(w){this.getCaptureCanvasContext(w),this._isHTMLVideoElement(w)?this.drawFrameOnCanvas(w):this.drawImageOnCanvas(w);const _=this.getCaptureCanvas(w),A=new I(_),B=new N(A);return new f(B)}getCaptureCanvasContext(w){if(!this.captureCanvasContext){const A=this.getCaptureCanvas(w).getContext("2d");this.captureCanvasContext=A}return this.captureCanvasContext}getCaptureCanvas(w){if(!this.captureCanvas){const _=this.createCaptureCanvas(w);this.captureCanvas=_}return this.captureCanvas}decodeBitmap(w){return this.reader.decode(w,this._hints)}createCaptureCanvas(w){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const _=document.createElement("canvas");let A,B;return typeof w<"u"&&(w instanceof HTMLVideoElement?(A=w.videoWidth,B=w.videoHeight):w instanceof HTMLImageElement&&(A=w.naturalWidth||w.width,B=w.naturalHeight||w.height)),_.style.width=A+"px",_.style.height=B+"px",_.width=A,_.height=B,_}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(w=>w.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(w,_){try{w.srcObject=_}catch{w.src=URL.createObjectURL(_)}}cleanVideoSource(w){try{w.srcObject=null}catch{w.src=""}this.videoElement.removeAttribute("src")}}class Z{constructor(w,_,A=_==null?0:8*_.length,B,z,K=g.currentTimeMillis()){this.text=w,this.rawBytes=_,this.numBits=A,this.resultPoints=B,this.format=z,this.timestamp=K,this.text=w,this.rawBytes=_,A==null?this.numBits=_==null?0:8*_.length:this.numBits=A,this.resultPoints=B,this.format=z,this.resultMetadata=null,K==null?this.timestamp=g.currentTimeMillis():this.timestamp=K}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(w,_){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(w,_)}putAllMetadata(w){w!==null&&(this.resultMetadata===null?this.resultMetadata=w:this.resultMetadata=new Map(w))}addResultPoints(w){const _=this.resultPoints;if(_===null)this.resultPoints=w;else if(w!==null&&w.length>0){const A=new Array(_.length+w.length);g.arraycopy(_,0,A,0,_.length),g.arraycopy(w,0,A,_.length,w.length),this.resultPoints=A}}getTimestamp(){return this.timestamp}toString(){return this.text}}var re;(function(xe){xe[xe.AZTEC=0]="AZTEC",xe[xe.CODABAR=1]="CODABAR",xe[xe.CODE_39=2]="CODE_39",xe[xe.CODE_93=3]="CODE_93",xe[xe.CODE_128=4]="CODE_128",xe[xe.DATA_MATRIX=5]="DATA_MATRIX",xe[xe.EAN_8=6]="EAN_8",xe[xe.EAN_13=7]="EAN_13",xe[xe.ITF=8]="ITF",xe[xe.MAXICODE=9]="MAXICODE",xe[xe.PDF_417=10]="PDF_417",xe[xe.QR_CODE=11]="QR_CODE",xe[xe.RSS_14=12]="RSS_14",xe[xe.RSS_EXPANDED=13]="RSS_EXPANDED",xe[xe.UPC_A=14]="UPC_A",xe[xe.UPC_E=15]="UPC_E",xe[xe.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(re||(re={}));var G=re,J;(function(xe){xe[xe.OTHER=0]="OTHER",xe[xe.ORIENTATION=1]="ORIENTATION",xe[xe.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",xe[xe.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",xe[xe.ISSUE_NUMBER=4]="ISSUE_NUMBER",xe[xe.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",xe[xe.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",xe[xe.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",xe[xe.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",xe[xe.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",xe[xe.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(J||(J={}));var V=J;class W{constructor(w,_,A,B,z=-1,K=-1){this.rawBytes=w,this.text=_,this.byteSegments=A,this.ecLevel=B,this.structuredAppendSequenceNumber=z,this.structuredAppendParity=K,this.numBits=w==null?0:8*w.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(w){this.numBits=w}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(w){this.errorsCorrected=w}getErasures(){return this.erasures}setErasures(w){this.erasures=w}getOther(){return this.other}setOther(w){this.other=w}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class ee{exp(w){return this.expTable[w]}log(w){if(w===0)throw new h;return this.logTable[w]}static addOrSubtract(w,_){return w^_}}class ie{constructor(w,_){if(_.length===0)throw new h;this.field=w;const A=_.length;if(A>1&&_[0]===0){let B=1;for(;B<A&&_[B]===0;)B++;B===A?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(A-B),g.arraycopy(_,B,this.coefficients,0,this.coefficients.length))}else this.coefficients=_}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(w){return this.coefficients[this.coefficients.length-1-w]}evaluateAt(w){if(w===0)return this.getCoefficient(0);const _=this.coefficients;let A;if(w===1){A=0;for(let K=0,Q=_.length;K!==Q;K++){const te=_[K];A=ee.addOrSubtract(A,te)}return A}A=_[0];const B=_.length,z=this.field;for(let K=1;K<B;K++)A=ee.addOrSubtract(z.multiply(w,A),_[K]);return A}addOrSubtract(w){if(!this.field.equals(w.field))throw new h("GenericGFPolys do not have same GenericGF field");if(this.isZero())return w;if(w.isZero())return this;let _=this.coefficients,A=w.coefficients;if(_.length>A.length){const K=_;_=A,A=K}let B=new Int32Array(A.length);const z=A.length-_.length;g.arraycopy(A,0,B,0,z);for(let K=z;K<A.length;K++)B[K]=ee.addOrSubtract(_[K-z],A[K]);return new ie(this.field,B)}multiply(w){if(!this.field.equals(w.field))throw new h("GenericGFPolys do not have same GenericGF field");if(this.isZero()||w.isZero())return this.field.getZero();const _=this.coefficients,A=_.length,B=w.coefficients,z=B.length,K=new Int32Array(A+z-1),Q=this.field;for(let te=0;te<A;te++){const ae=_[te];for(let me=0;me<z;me++)K[te+me]=ee.addOrSubtract(K[te+me],Q.multiply(ae,B[me]))}return new ie(Q,K)}multiplyScalar(w){if(w===0)return this.field.getZero();if(w===1)return this;const _=this.coefficients.length,A=this.field,B=new Int32Array(_),z=this.coefficients;for(let K=0;K<_;K++)B[K]=A.multiply(z[K],w);return new ie(A,B)}multiplyByMonomial(w,_){if(w<0)throw new h;if(_===0)return this.field.getZero();const A=this.coefficients,B=A.length,z=new Int32Array(B+w),K=this.field;for(let Q=0;Q<B;Q++)z[Q]=K.multiply(A[Q],_);return new ie(K,z)}divide(w){if(!this.field.equals(w.field))throw new h("GenericGFPolys do not have same GenericGF field");if(w.isZero())throw new h("Divide by 0");const _=this.field;let A=_.getZero(),B=this;const z=w.getCoefficient(w.getDegree()),K=_.inverse(z);for(;B.getDegree()>=w.getDegree()&&!B.isZero();){const Q=B.getDegree()-w.getDegree(),te=_.multiply(B.getCoefficient(B.getDegree()),K),ae=w.multiplyByMonomial(Q,te),me=_.buildMonomial(Q,te);A=A.addOrSubtract(me),B=B.addOrSubtract(ae)}return[A,B]}toString(){let w="";for(let _=this.getDegree();_>=0;_--){let A=this.getCoefficient(_);if(A!==0){if(A<0?(w+=" - ",A=-A):w.length>0&&(w+=" + "),_===0||A!==1){const B=this.field.log(A);B===0?w+="1":B===1?w+="a":(w+="a^",w+=B)}_!==0&&(_===1?w+="x":(w+="x^",w+=_))}}return w}}class oe extends l{}oe.kind="ArithmeticException";class se extends ee{constructor(w,_,A){super(),this.primitive=w,this.size=_,this.generatorBase=A;const B=new Int32Array(_);let z=1;for(let Q=0;Q<_;Q++)B[Q]=z,z*=2,z>=_&&(z^=w,z&=_-1);this.expTable=B;const K=new Int32Array(_);for(let Q=0;Q<_-1;Q++)K[B[Q]]=Q;this.logTable=K,this.zero=new ie(this,Int32Array.from([0])),this.one=new ie(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(w,_){if(w<0)throw new h;if(_===0)return this.zero;const A=new Int32Array(w+1);return A[0]=_,new ie(this,A)}inverse(w){if(w===0)throw new oe;return this.expTable[this.size-this.logTable[w]-1]}multiply(w,_){return w===0||_===0?0:this.expTable[(this.logTable[w]+this.logTable[_])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+b.toHexString(this.primitive)+","+this.size+")"}equals(w){return w===this}}se.AZTEC_DATA_12=new se(4201,4096,1),se.AZTEC_DATA_10=new se(1033,1024,1),se.AZTEC_DATA_6=new se(67,64,1),se.AZTEC_PARAM=new se(19,16,1),se.QR_CODE_FIELD_256=new se(285,256,0),se.DATA_MATRIX_FIELD_256=new se(301,256,1),se.AZTEC_DATA_8=se.DATA_MATRIX_FIELD_256,se.MAXICODE_FIELD_64=se.AZTEC_DATA_6;class le extends l{}le.kind="ReedSolomonException";class ye extends l{}ye.kind="IllegalStateException";class ue{constructor(w){this.field=w}decode(w,_){const A=this.field,B=new ie(A,w),z=new Int32Array(_);let K=!0;for(let Oe=0;Oe<_;Oe++){const Ue=B.evaluateAt(A.exp(Oe+A.getGeneratorBase()));z[z.length-1-Oe]=Ue,Ue!==0&&(K=!1)}if(K)return;const Q=new ie(A,z),te=this.runEuclideanAlgorithm(A.buildMonomial(_,1),Q,_),ae=te[0],me=te[1],ve=this.findErrorLocations(ae),je=this.findErrorMagnitudes(me,ve);for(let Oe=0;Oe<ve.length;Oe++){const Ue=w.length-1-A.log(ve[Oe]);if(Ue<0)throw new le("Bad error location");w[Ue]=se.addOrSubtract(w[Ue],je[Oe])}}runEuclideanAlgorithm(w,_,A){if(w.getDegree()<_.getDegree()){const Oe=w;w=_,_=Oe}const B=this.field;let z=w,K=_,Q=B.getZero(),te=B.getOne();for(;K.getDegree()>=(A/2|0);){let Oe=z,Ue=Q;if(z=K,Q=te,z.isZero())throw new le("r_{i-1} was zero");K=Oe;let He=B.getZero();const nt=z.getCoefficient(z.getDegree()),pt=B.inverse(nt);for(;K.getDegree()>=z.getDegree()&&!K.isZero();){const $t=K.getDegree()-z.getDegree(),Ft=B.multiply(K.getCoefficient(K.getDegree()),pt);He=He.addOrSubtract(B.buildMonomial($t,Ft)),K=K.addOrSubtract(z.multiplyByMonomial($t,Ft))}if(te=He.multiply(Q).addOrSubtract(Ue),K.getDegree()>=z.getDegree())throw new ye("Division algorithm failed to reduce polynomial?")}const ae=te.getCoefficient(0);if(ae===0)throw new le("sigmaTilde(0) was zero");const me=B.inverse(ae),ve=te.multiplyScalar(me),je=K.multiplyScalar(me);return[ve,je]}findErrorLocations(w){const _=w.getDegree();if(_===1)return Int32Array.from([w.getCoefficient(1)]);const A=new Int32Array(_);let B=0;const z=this.field;for(let K=1;K<z.getSize()&&B<_;K++)w.evaluateAt(K)===0&&(A[B]=z.inverse(K),B++);if(B!==_)throw new le("Error locator degree does not match number of roots");return A}findErrorMagnitudes(w,_){const A=_.length,B=new Int32Array(A),z=this.field;for(let K=0;K<A;K++){const Q=z.inverse(_[K]);let te=1;for(let ae=0;ae<A;ae++)if(K!==ae){const me=z.multiply(_[ae],Q),ve=me&1?me&-2:me|1;te=z.multiply(te,ve)}B[K]=z.multiply(w.evaluateAt(Q),z.inverse(te)),z.getGeneratorBase()!==0&&(B[K]=z.multiply(B[K],Q))}return B}}var ne;(function(xe){xe[xe.UPPER=0]="UPPER",xe[xe.LOWER=1]="LOWER",xe[xe.MIXED=2]="MIXED",xe[xe.DIGIT=3]="DIGIT",xe[xe.PUNCT=4]="PUNCT",xe[xe.BINARY=5]="BINARY"})(ne||(ne={}));class pe{decode(w){this.ddata=w;let _=w.getBits(),A=this.extractBits(_),B=this.correctBits(A),z=pe.convertBoolArrayToByteArray(B),K=pe.getEncodedData(B),Q=new W(z,K,null,null);return Q.setNumBits(B.length),Q}static highLevelDecode(w){return this.getEncodedData(w)}static getEncodedData(w){let _=w.length,A=ne.UPPER,B=ne.UPPER,z="",K=0;for(;K<_;)if(B===ne.BINARY){if(_-K<5)break;let Q=pe.readCode(w,K,5);if(K+=5,Q===0){if(_-K<11)break;Q=pe.readCode(w,K,11)+31,K+=11}for(let te=0;te<Q;te++){if(_-K<8){K=_;break}const ae=pe.readCode(w,K,8);z+=H.castAsNonUtf8Char(ae),K+=8}B=A}else{let Q=B===ne.DIGIT?4:5;if(_-K<Q)break;let te=pe.readCode(w,K,Q);K+=Q;let ae=pe.getCharacter(B,te);ae.startsWith("CTRL_")?(A=B,B=pe.getTable(ae.charAt(5)),ae.charAt(6)==="L"&&(A=B)):(z+=ae,B=A)}return z}static getTable(w){switch(w){case"L":return ne.LOWER;case"P":return ne.PUNCT;case"M":return ne.MIXED;case"D":return ne.DIGIT;case"B":return ne.BINARY;case"U":default:return ne.UPPER}}static getCharacter(w,_){switch(w){case ne.UPPER:return pe.UPPER_TABLE[_];case ne.LOWER:return pe.LOWER_TABLE[_];case ne.MIXED:return pe.MIXED_TABLE[_];case ne.PUNCT:return pe.PUNCT_TABLE[_];case ne.DIGIT:return pe.DIGIT_TABLE[_];default:throw new ye("Bad table")}}correctBits(w){let _,A;this.ddata.getNbLayers()<=2?(A=6,_=se.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(A=8,_=se.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(A=10,_=se.AZTEC_DATA_10):(A=12,_=se.AZTEC_DATA_12);let B=this.ddata.getNbDatablocks(),z=w.length/A;if(z<B)throw new R;let K=w.length%A,Q=new Int32Array(z);for(let je=0;je<z;je++,K+=A)Q[je]=pe.readCode(w,K,A);try{new ue(_).decode(Q,z-B)}catch(je){throw new R(je)}let te=(1<<A)-1,ae=0;for(let je=0;je<B;je++){let Oe=Q[je];if(Oe===0||Oe===te)throw new R;(Oe===1||Oe===te-1)&&ae++}let me=new Array(B*A-ae),ve=0;for(let je=0;je<B;je++){let Oe=Q[je];if(Oe===1||Oe===te-1)me.fill(Oe>1,ve,ve+A-1),ve+=A-1;else for(let Ue=A-1;Ue>=0;--Ue)me[ve++]=(Oe&1<<Ue)!==0}return me}extractBits(w){let _=this.ddata.isCompact(),A=this.ddata.getNbLayers(),B=(_?11:14)+A*4,z=new Int32Array(B),K=new Array(this.totalBitsInLayer(A,_));if(_)for(let Q=0;Q<z.length;Q++)z[Q]=Q;else{let Q=B+1+2*b.truncDivision(b.truncDivision(B,2)-1,15),te=B/2,ae=b.truncDivision(Q,2);for(let me=0;me<te;me++){let ve=me+b.truncDivision(me,15);z[te-me-1]=ae-ve-1,z[te+me]=ae+ve+1}}for(let Q=0,te=0;Q<A;Q++){let ae=(A-Q)*4+(_?9:12),me=Q*2,ve=B-1-me;for(let je=0;je<ae;je++){let Oe=je*2;for(let Ue=0;Ue<2;Ue++)K[te+Oe+Ue]=w.get(z[me+Ue],z[me+je]),K[te+2*ae+Oe+Ue]=w.get(z[me+je],z[ve-Ue]),K[te+4*ae+Oe+Ue]=w.get(z[ve-Ue],z[ve-je]),K[te+6*ae+Oe+Ue]=w.get(z[ve-je],z[me+Ue])}te+=ae*8}return K}static readCode(w,_,A){let B=0;for(let z=_;z<_+A;z++)B<<=1,w[z]&&(B|=1);return B}static readByte(w,_){let A=w.length-_;return A>=8?pe.readCode(w,_,8):pe.readCode(w,_,A)<<8-A}static convertBoolArrayToByteArray(w){let _=new Uint8Array((w.length+7)/8);for(let A=0;A<_.length;A++)_[A]=pe.readByte(w,8*A);return _}totalBitsInLayer(w,_){return((_?88:112)+16*w)*w}}pe.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],pe.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],pe.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],pe.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],pe.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class ge{constructor(){}static round(w){return w===NaN?0:w<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:w>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:w+(w<0?-.5:.5)|0}static distance(w,_,A,B){const z=w-A,K=_-B;return Math.sqrt(z*z+K*K)}static sum(w){let _=0;for(let A=0,B=w.length;A!==B;A++){const z=w[A];_+=z}return _}}class Ne{static floatToIntBits(w){return w}}Ne.MAX_VALUE=Number.MAX_SAFE_INTEGER;class _e{constructor(w,_){this.x=w,this.y=_}getX(){return this.x}getY(){return this.y}equals(w){if(w instanceof _e){const _=w;return this.x===_.x&&this.y===_.y}return!1}hashCode(){return 31*Ne.floatToIntBits(this.x)+Ne.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(w){const _=this.distance(w[0],w[1]),A=this.distance(w[1],w[2]),B=this.distance(w[0],w[2]);let z,K,Q;if(A>=_&&A>=B?(K=w[0],z=w[1],Q=w[2]):B>=A&&B>=_?(K=w[1],z=w[0],Q=w[2]):(K=w[2],z=w[0],Q=w[1]),this.crossProductZ(z,K,Q)<0){const te=z;z=Q,Q=te}w[0]=z,w[1]=K,w[2]=Q}static distance(w,_){return ge.distance(w.x,w.y,_.x,_.y)}static crossProductZ(w,_,A){const B=_.x,z=_.y;return(A.x-B)*(w.y-z)-(A.y-z)*(w.x-B)}}class be{constructor(w,_){this.bits=w,this.points=_}getBits(){return this.bits}getPoints(){return this.points}}class Me extends be{constructor(w,_,A,B,z){super(w,_),this.compact=A,this.nbDatablocks=B,this.nbLayers=z}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Se{constructor(w,_,A,B){this.image=w,this.height=w.getHeight(),this.width=w.getWidth(),_==null&&(_=Se.INIT_SIZE),A==null&&(A=w.getWidth()/2|0),B==null&&(B=w.getHeight()/2|0);const z=_/2|0;if(this.leftInit=A-z,this.rightInit=A+z,this.upInit=B-z,this.downInit=B+z,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new S}detect(){let w=this.leftInit,_=this.rightInit,A=this.upInit,B=this.downInit,z=!1,K=!0,Q=!1,te=!1,ae=!1,me=!1,ve=!1;const je=this.width,Oe=this.height;for(;K;){K=!1;let Ue=!0;for(;(Ue||!te)&&_<je;)Ue=this.containsBlackPoint(A,B,_,!1),Ue?(_++,K=!0,te=!0):te||_++;if(_>=je){z=!0;break}let He=!0;for(;(He||!ae)&&B<Oe;)He=this.containsBlackPoint(w,_,B,!0),He?(B++,K=!0,ae=!0):ae||B++;if(B>=Oe){z=!0;break}let nt=!0;for(;(nt||!me)&&w>=0;)nt=this.containsBlackPoint(A,B,w,!1),nt?(w--,K=!0,me=!0):me||w--;if(w<0){z=!0;break}let pt=!0;for(;(pt||!ve)&&A>=0;)pt=this.containsBlackPoint(w,_,A,!0),pt?(A--,K=!0,ve=!0):ve||A--;if(A<0){z=!0;break}K&&(Q=!0)}if(!z&&Q){const Ue=_-w;let He=null;for(let Ft=1;He===null&&Ft<Ue;Ft++)He=this.getBlackPointOnSegment(w,B-Ft,w+Ft,B);if(He==null)throw new S;let nt=null;for(let Ft=1;nt===null&&Ft<Ue;Ft++)nt=this.getBlackPointOnSegment(w,A+Ft,w+Ft,A);if(nt==null)throw new S;let pt=null;for(let Ft=1;pt===null&&Ft<Ue;Ft++)pt=this.getBlackPointOnSegment(_,A+Ft,_-Ft,A);if(pt==null)throw new S;let $t=null;for(let Ft=1;$t===null&&Ft<Ue;Ft++)$t=this.getBlackPointOnSegment(_,B-Ft,_-Ft,B);if($t==null)throw new S;return this.centerEdges($t,He,pt,nt)}else throw new S}getBlackPointOnSegment(w,_,A,B){const z=ge.round(ge.distance(w,_,A,B)),K=(A-w)/z,Q=(B-_)/z,te=this.image;for(let ae=0;ae<z;ae++){const me=ge.round(w+ae*K),ve=ge.round(_+ae*Q);if(te.get(me,ve))return new _e(me,ve)}return null}centerEdges(w,_,A,B){const z=w.getX(),K=w.getY(),Q=_.getX(),te=_.getY(),ae=A.getX(),me=A.getY(),ve=B.getX(),je=B.getY(),Oe=Se.CORR;return z<this.width/2?[new _e(ve-Oe,je+Oe),new _e(Q+Oe,te+Oe),new _e(ae-Oe,me-Oe),new _e(z+Oe,K-Oe)]:[new _e(ve+Oe,je+Oe),new _e(Q+Oe,te-Oe),new _e(ae-Oe,me+Oe),new _e(z-Oe,K-Oe)]}containsBlackPoint(w,_,A,B){const z=this.image;if(B){for(let K=w;K<=_;K++)if(z.get(K,A))return!0}else for(let K=w;K<=_;K++)if(z.get(A,K))return!0;return!1}}Se.INIT_SIZE=10,Se.CORR=1;class $e{static checkAndNudgePoints(w,_){const A=w.getWidth(),B=w.getHeight();let z=!0;for(let K=0;K<_.length&&z;K+=2){const Q=Math.floor(_[K]),te=Math.floor(_[K+1]);if(Q<-1||Q>A||te<-1||te>B)throw new S;z=!1,Q===-1?(_[K]=0,z=!0):Q===A&&(_[K]=A-1,z=!0),te===-1?(_[K+1]=0,z=!0):te===B&&(_[K+1]=B-1,z=!0)}z=!0;for(let K=_.length-2;K>=0&&z;K-=2){const Q=Math.floor(_[K]),te=Math.floor(_[K+1]);if(Q<-1||Q>A||te<-1||te>B)throw new S;z=!1,Q===-1?(_[K]=0,z=!0):Q===A&&(_[K]=A-1,z=!0),te===-1?(_[K+1]=0,z=!0):te===B&&(_[K+1]=B-1,z=!0)}}}class Ke{constructor(w,_,A,B,z,K,Q,te,ae){this.a11=w,this.a21=_,this.a31=A,this.a12=B,this.a22=z,this.a32=K,this.a13=Q,this.a23=te,this.a33=ae}static quadrilateralToQuadrilateral(w,_,A,B,z,K,Q,te,ae,me,ve,je,Oe,Ue,He,nt){const pt=Ke.quadrilateralToSquare(w,_,A,B,z,K,Q,te);return Ke.squareToQuadrilateral(ae,me,ve,je,Oe,Ue,He,nt).times(pt)}transformPoints(w){const _=w.length,A=this.a11,B=this.a12,z=this.a13,K=this.a21,Q=this.a22,te=this.a23,ae=this.a31,me=this.a32,ve=this.a33;for(let je=0;je<_;je+=2){const Oe=w[je],Ue=w[je+1],He=z*Oe+te*Ue+ve;w[je]=(A*Oe+K*Ue+ae)/He,w[je+1]=(B*Oe+Q*Ue+me)/He}}transformPointsWithValues(w,_){const A=this.a11,B=this.a12,z=this.a13,K=this.a21,Q=this.a22,te=this.a23,ae=this.a31,me=this.a32,ve=this.a33,je=w.length;for(let Oe=0;Oe<je;Oe++){const Ue=w[Oe],He=_[Oe],nt=z*Ue+te*He+ve;w[Oe]=(A*Ue+K*He+ae)/nt,_[Oe]=(B*Ue+Q*He+me)/nt}}static squareToQuadrilateral(w,_,A,B,z,K,Q,te){const ae=w-A+z-Q,me=_-B+K-te;if(ae===0&&me===0)return new Ke(A-w,z-A,w,B-_,K-B,_,0,0,1);{const ve=A-z,je=Q-z,Oe=B-K,Ue=te-K,He=ve*Ue-je*Oe,nt=(ae*Ue-je*me)/He,pt=(ve*me-ae*Oe)/He;return new Ke(A-w+nt*A,Q-w+pt*Q,w,B-_+nt*B,te-_+pt*te,_,nt,pt,1)}}static quadrilateralToSquare(w,_,A,B,z,K,Q,te){return Ke.squareToQuadrilateral(w,_,A,B,z,K,Q,te).buildAdjoint()}buildAdjoint(){return new Ke(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(w){return new Ke(this.a11*w.a11+this.a21*w.a12+this.a31*w.a13,this.a11*w.a21+this.a21*w.a22+this.a31*w.a23,this.a11*w.a31+this.a21*w.a32+this.a31*w.a33,this.a12*w.a11+this.a22*w.a12+this.a32*w.a13,this.a12*w.a21+this.a22*w.a22+this.a32*w.a23,this.a12*w.a31+this.a22*w.a32+this.a32*w.a33,this.a13*w.a11+this.a23*w.a12+this.a33*w.a13,this.a13*w.a21+this.a23*w.a22+this.a33*w.a23,this.a13*w.a31+this.a23*w.a32+this.a33*w.a33)}}class Ze extends $e{sampleGrid(w,_,A,B,z,K,Q,te,ae,me,ve,je,Oe,Ue,He,nt,pt,$t,Ft){const Rt=Ke.quadrilateralToQuadrilateral(B,z,K,Q,te,ae,me,ve,je,Oe,Ue,He,nt,pt,$t,Ft);return this.sampleGridWithTransform(w,_,A,Rt)}sampleGridWithTransform(w,_,A,B){if(_<=0||A<=0)throw new S;const z=new F(_,A),K=new Float32Array(2*_);for(let Q=0;Q<A;Q++){const te=K.length,ae=Q+.5;for(let me=0;me<te;me+=2)K[me]=me/2+.5,K[me+1]=ae;B.transformPoints(K),$e.checkAndNudgePoints(w,K);try{for(let me=0;me<te;me+=2)w.get(Math.floor(K[me]),Math.floor(K[me+1]))&&z.set(me/2,Q)}catch{throw new S}}return z}}class it{static setGridSampler(w){it.gridSampler=w}static getInstance(){return it.gridSampler}}it.gridSampler=new Ze;class Re{constructor(w,_){this.x=w,this.y=_}toResultPoint(){return new _e(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class ot{constructor(w){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=w}detect(){return this.detectMirror(!1)}detectMirror(w){let _=this.getMatrixCenter(),A=this.getBullsEyeCorners(_);if(w){let K=A[0];A[0]=A[2],A[2]=K}this.extractParameters(A);let B=this.sampleGrid(this.image,A[this.shift%4],A[(this.shift+1)%4],A[(this.shift+2)%4],A[(this.shift+3)%4]),z=this.getMatrixCornerPoints(A);return new Me(B,z,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(w){if(!this.isValidPoint(w[0])||!this.isValidPoint(w[1])||!this.isValidPoint(w[2])||!this.isValidPoint(w[3]))throw new S;let _=2*this.nbCenterLayers,A=new Int32Array([this.sampleLine(w[0],w[1],_),this.sampleLine(w[1],w[2],_),this.sampleLine(w[2],w[3],_),this.sampleLine(w[3],w[0],_)]);this.shift=this.getRotation(A,_);let B=0;for(let K=0;K<4;K++){let Q=A[(this.shift+K)%4];this.compact?(B<<=7,B+=Q>>1&127):(B<<=10,B+=(Q>>2&992)+(Q>>1&31))}let z=this.getCorrectedParameterData(B,this.compact);this.compact?(this.nbLayers=(z>>6)+1,this.nbDataBlocks=(z&63)+1):(this.nbLayers=(z>>11)+1,this.nbDataBlocks=(z&2047)+1)}getRotation(w,_){let A=0;w.forEach((B,z,K)=>{let Q=(B>>_-2<<1)+(B&1);A=(A<<3)+Q}),A=((A&1)<<11)+(A>>1);for(let B=0;B<4;B++)if(b.bitCount(A^this.EXPECTED_CORNER_BITS[B])<=2)return B;throw new S}getCorrectedParameterData(w,_){let A,B;_?(A=7,B=2):(A=10,B=4);let z=A-B,K=new Int32Array(A);for(let te=A-1;te>=0;--te)K[te]=w&15,w>>=4;try{new ue(se.AZTEC_PARAM).decode(K,z)}catch{throw new S}let Q=0;for(let te=0;te<B;te++)Q=(Q<<4)+K[te];return Q}getBullsEyeCorners(w){let _=w,A=w,B=w,z=w,K=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let ve=this.getFirstDifferent(_,K,1,-1),je=this.getFirstDifferent(A,K,1,1),Oe=this.getFirstDifferent(B,K,-1,1),Ue=this.getFirstDifferent(z,K,-1,-1);if(this.nbCenterLayers>2){let He=this.distancePoint(Ue,ve)*this.nbCenterLayers/(this.distancePoint(z,_)*(this.nbCenterLayers+2));if(He<.75||He>1.25||!this.isWhiteOrBlackRectangle(ve,je,Oe,Ue))break}_=ve,A=je,B=Oe,z=Ue,K=!K}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new S;this.compact=this.nbCenterLayers===5;let Q=new _e(_.getX()+.5,_.getY()-.5),te=new _e(A.getX()+.5,A.getY()+.5),ae=new _e(B.getX()-.5,B.getY()+.5),me=new _e(z.getX()-.5,z.getY()-.5);return this.expandSquare([Q,te,ae,me],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let w,_,A,B;try{let Q=new Se(this.image).detect();w=Q[0],_=Q[1],A=Q[2],B=Q[3]}catch{let te=this.image.getWidth()/2,ae=this.image.getHeight()/2;w=this.getFirstDifferent(new Re(te+7,ae-7),!1,1,-1).toResultPoint(),_=this.getFirstDifferent(new Re(te+7,ae+7),!1,1,1).toResultPoint(),A=this.getFirstDifferent(new Re(te-7,ae+7),!1,-1,1).toResultPoint(),B=this.getFirstDifferent(new Re(te-7,ae-7),!1,-1,-1).toResultPoint()}let z=ge.round((w.getX()+B.getX()+_.getX()+A.getX())/4),K=ge.round((w.getY()+B.getY()+_.getY()+A.getY())/4);try{let Q=new Se(this.image,15,z,K).detect();w=Q[0],_=Q[1],A=Q[2],B=Q[3]}catch{w=this.getFirstDifferent(new Re(z+7,K-7),!1,1,-1).toResultPoint(),_=this.getFirstDifferent(new Re(z+7,K+7),!1,1,1).toResultPoint(),A=this.getFirstDifferent(new Re(z-7,K+7),!1,-1,1).toResultPoint(),B=this.getFirstDifferent(new Re(z-7,K-7),!1,-1,-1).toResultPoint()}return z=ge.round((w.getX()+B.getX()+_.getX()+A.getX())/4),K=ge.round((w.getY()+B.getY()+_.getY()+A.getY())/4),new Re(z,K)}getMatrixCornerPoints(w){return this.expandSquare(w,2*this.nbCenterLayers,this.getDimension())}sampleGrid(w,_,A,B,z){let K=it.getInstance(),Q=this.getDimension(),te=Q/2-this.nbCenterLayers,ae=Q/2+this.nbCenterLayers;return K.sampleGrid(w,Q,Q,te,te,ae,te,ae,ae,te,ae,_.getX(),_.getY(),A.getX(),A.getY(),B.getX(),B.getY(),z.getX(),z.getY())}sampleLine(w,_,A){let B=0,z=this.distanceResultPoint(w,_),K=z/A,Q=w.getX(),te=w.getY(),ae=K*(_.getX()-w.getX())/z,me=K*(_.getY()-w.getY())/z;for(let ve=0;ve<A;ve++)this.image.get(ge.round(Q+ve*ae),ge.round(te+ve*me))&&(B|=1<<A-ve-1);return B}isWhiteOrBlackRectangle(w,_,A,B){let z=3;w=new Re(w.getX()-z,w.getY()+z),_=new Re(_.getX()-z,_.getY()-z),A=new Re(A.getX()+z,A.getY()-z),B=new Re(B.getX()+z,B.getY()+z);let K=this.getColor(B,w);if(K===0)return!1;let Q=this.getColor(w,_);return Q!==K||(Q=this.getColor(_,A),Q!==K)?!1:(Q=this.getColor(A,B),Q===K)}getColor(w,_){let A=this.distancePoint(w,_),B=(_.getX()-w.getX())/A,z=(_.getY()-w.getY())/A,K=0,Q=w.getX(),te=w.getY(),ae=this.image.get(w.getX(),w.getY()),me=Math.ceil(A);for(let je=0;je<me;je++)Q+=B,te+=z,this.image.get(ge.round(Q),ge.round(te))!==ae&&K++;let ve=K/A;return ve>.1&&ve<.9?0:ve<=.1===ae?1:-1}getFirstDifferent(w,_,A,B){let z=w.getX()+A,K=w.getY()+B;for(;this.isValid(z,K)&&this.image.get(z,K)===_;)z+=A,K+=B;for(z-=A,K-=B;this.isValid(z,K)&&this.image.get(z,K)===_;)z+=A;for(z-=A;this.isValid(z,K)&&this.image.get(z,K)===_;)K+=B;return K-=B,new Re(z,K)}expandSquare(w,_,A){let B=A/(2*_),z=w[0].getX()-w[2].getX(),K=w[0].getY()-w[2].getY(),Q=(w[0].getX()+w[2].getX())/2,te=(w[0].getY()+w[2].getY())/2,ae=new _e(Q+B*z,te+B*K),me=new _e(Q-B*z,te-B*K);z=w[1].getX()-w[3].getX(),K=w[1].getY()-w[3].getY(),Q=(w[1].getX()+w[3].getX())/2,te=(w[1].getY()+w[3].getY())/2;let ve=new _e(Q+B*z,te+B*K),je=new _e(Q-B*z,te-B*K);return[ae,ve,me,je]}isValid(w,_){return w>=0&&w<this.image.getWidth()&&_>0&&_<this.image.getHeight()}isValidPoint(w){let _=ge.round(w.getX()),A=ge.round(w.getY());return this.isValid(_,A)}distancePoint(w,_){return ge.distance(w.getX(),w.getY(),_.getX(),_.getY())}distanceResultPoint(w,_){return ge.distance(w.getX(),w.getY(),_.getX(),_.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(b.truncDivision(this.nbLayers-4,8)+1)+15}}class ut{decode(w,_=null){let A=null,B=new ot(w.getBlackMatrix()),z=null,K=null;try{let me=B.detectMirror(!1);z=me.getPoints(),this.reportFoundResultPoints(_,z),K=new pe().decode(me)}catch(me){A=me}if(K==null)try{let me=B.detectMirror(!0);z=me.getPoints(),this.reportFoundResultPoints(_,z),K=new pe().decode(me)}catch(me){throw A??me}let Q=new Z(K.getText(),K.getRawBytes(),K.getNumBits(),z,G.AZTEC,g.currentTimeMillis()),te=K.getByteSegments();te!=null&&Q.putMetadata(V.BYTE_SEGMENTS,te);let ae=K.getECLevel();return ae!=null&&Q.putMetadata(V.ERROR_CORRECTION_LEVEL,ae),Q}reportFoundResultPoints(w,_){if(w!=null){let A=w.get(O.NEED_RESULT_POINT_CALLBACK);A!=null&&_.forEach((B,z,K)=>{A.foundPossibleResultPoint(B)})}}reset(){}}class bt extends Y{constructor(w=500){super(new ut,w)}}class Je{decode(w,_){try{return this.doDecode(w,_)}catch{if(_&&_.get(O.TRY_HARDER)===!0&&w.isRotateSupported()){const z=w.rotateCounterClockwise(),K=this.doDecode(z,_),Q=K.getResultMetadata();let te=270;Q!==null&&Q.get(V.ORIENTATION)===!0&&(te=te+Q.get(V.ORIENTATION)%360),K.putMetadata(V.ORIENTATION,te);const ae=K.getResultPoints();if(ae!==null){const me=z.getHeight();for(let ve=0;ve<ae.length;ve++)ae[ve]=new _e(me-ae[ve].getY()-1,ae[ve].getX())}return K}else throw new S}}reset(){}doDecode(w,_){const A=w.getWidth(),B=w.getHeight();let z=new j(A);const K=_&&_.get(O.TRY_HARDER)===!0,Q=Math.max(1,B>>(K?8:5));let te;K?te=B:te=15;const ae=Math.trunc(B/2);for(let me=0;me<te;me++){const ve=Math.trunc((me+1)/2),je=(me&1)===0,Oe=ae+Q*(je?ve:-ve);if(Oe<0||Oe>=B)break;try{z=w.getBlackRow(Oe,z)}catch{continue}for(let Ue=0;Ue<2;Ue++){if(Ue===1&&(z.reverse(),_&&_.get(O.NEED_RESULT_POINT_CALLBACK)===!0)){const He=new Map;_.forEach((nt,pt)=>He.set(pt,nt)),He.delete(O.NEED_RESULT_POINT_CALLBACK),_=He}try{const He=this.decodeRow(Oe,z,_);if(Ue===1){He.putMetadata(V.ORIENTATION,180);const nt=He.getResultPoints();nt!==null&&(nt[0]=new _e(A-nt[0].getX()-1,nt[0].getY()),nt[1]=new _e(A-nt[1].getX()-1,nt[1].getY()))}return He}catch{}}}throw new S}static recordPattern(w,_,A){const B=A.length;for(let ae=0;ae<B;ae++)A[ae]=0;const z=w.getSize();if(_>=z)throw new S;let K=!w.get(_),Q=0,te=_;for(;te<z;){if(w.get(te)!==K)A[Q]++;else{if(++Q===B)break;A[Q]=1,K=!K}te++}if(!(Q===B||Q===B-1&&te===z))throw new S}static recordPatternInReverse(w,_,A){let B=A.length,z=w.get(_);for(;_>0&&B>=0;)w.get(--_)!==z&&(B--,z=!z);if(B>=0)throw new S;Je.recordPattern(w,_+1,A)}static patternMatchVariance(w,_,A){const B=w.length;let z=0,K=0;for(let ae=0;ae<B;ae++)z+=w[ae],K+=_[ae];if(z<K)return Number.POSITIVE_INFINITY;const Q=z/K;A*=Q;let te=0;for(let ae=0;ae<B;ae++){const me=w[ae],ve=_[ae]*Q,je=me>ve?me-ve:ve-me;if(je>A)return Number.POSITIVE_INFINITY;te+=je}return te/z}}class Ce extends Je{static findStartPattern(w){const _=w.getSize(),A=w.getNextSet(0);let B=0,z=Int32Array.from([0,0,0,0,0,0]),K=A,Q=!1;const te=6;for(let ae=A;ae<_;ae++)if(w.get(ae)!==Q)z[B]++;else{if(B===te-1){let me=Ce.MAX_AVG_VARIANCE,ve=-1;for(let je=Ce.CODE_START_A;je<=Ce.CODE_START_C;je++){const Oe=Je.patternMatchVariance(z,Ce.CODE_PATTERNS[je],Ce.MAX_INDIVIDUAL_VARIANCE);Oe<me&&(me=Oe,ve=je)}if(ve>=0&&w.isRange(Math.max(0,K-(ae-K)/2),K,!1))return Int32Array.from([K,ae,ve]);K+=z[0]+z[1],z=z.slice(2,z.length-1),z[B-1]=0,z[B]=0,B--}else B++;z[B]=1,Q=!Q}throw new S}static decodeCode(w,_,A){Je.recordPattern(w,A,_);let B=Ce.MAX_AVG_VARIANCE,z=-1;for(let K=0;K<Ce.CODE_PATTERNS.length;K++){const Q=Ce.CODE_PATTERNS[K],te=this.patternMatchVariance(_,Q,Ce.MAX_INDIVIDUAL_VARIANCE);te<B&&(B=te,z=K)}if(z>=0)return z;throw new S}decodeRow(w,_,A){const B=A&&A.get(O.ASSUME_GS1)===!0,z=Ce.findStartPattern(_),K=z[2];let Q=0;const te=new Uint8Array(20);te[Q++]=K;let ae;switch(K){case Ce.CODE_START_A:ae=Ce.CODE_CODE_A;break;case Ce.CODE_START_B:ae=Ce.CODE_CODE_B;break;case Ce.CODE_START_C:ae=Ce.CODE_CODE_C;break;default:throw new R}let me=!1,ve=!1,je="",Oe=z[0],Ue=z[1];const He=Int32Array.from([0,0,0,0,0,0]);let nt=0,pt=0,$t=K,Ft=0,Rt=!0,hn=!1,Zr=!1;for(;!me;){const Uf=ve;switch(ve=!1,nt=pt,pt=Ce.decodeCode(_,He,Ue),te[Q++]=pt,pt!==Ce.CODE_STOP&&(Rt=!0),pt!==Ce.CODE_STOP&&(Ft++,$t+=Ft*pt),Oe=Ue,Ue+=He.reduce((Ate,Tte)=>Ate+Tte,0),pt){case Ce.CODE_START_A:case Ce.CODE_START_B:case Ce.CODE_START_C:throw new R}switch(ae){case Ce.CODE_CODE_A:if(pt<64)Zr===hn?je+=String.fromCharCode(32+pt):je+=String.fromCharCode(32+pt+128),Zr=!1;else if(pt<96)Zr===hn?je+=String.fromCharCode(pt-64):je+=String.fromCharCode(pt+64),Zr=!1;else switch(pt!==Ce.CODE_STOP&&(Rt=!1),pt){case Ce.CODE_FNC_1:B&&(je.length===0?je+="]C1":je+="");break;case Ce.CODE_FNC_2:case Ce.CODE_FNC_3:break;case Ce.CODE_FNC_4_A:!hn&&Zr?(hn=!0,Zr=!1):hn&&Zr?(hn=!1,Zr=!1):Zr=!0;break;case Ce.CODE_SHIFT:ve=!0,ae=Ce.CODE_CODE_B;break;case Ce.CODE_CODE_B:ae=Ce.CODE_CODE_B;break;case Ce.CODE_CODE_C:ae=Ce.CODE_CODE_C;break;case Ce.CODE_STOP:me=!0;break}break;case Ce.CODE_CODE_B:if(pt<96)Zr===hn?je+=String.fromCharCode(32+pt):je+=String.fromCharCode(32+pt+128),Zr=!1;else switch(pt!==Ce.CODE_STOP&&(Rt=!1),pt){case Ce.CODE_FNC_1:B&&(je.length===0?je+="]C1":je+="");break;case Ce.CODE_FNC_2:case Ce.CODE_FNC_3:break;case Ce.CODE_FNC_4_B:!hn&&Zr?(hn=!0,Zr=!1):hn&&Zr?(hn=!1,Zr=!1):Zr=!0;break;case Ce.CODE_SHIFT:ve=!0,ae=Ce.CODE_CODE_A;break;case Ce.CODE_CODE_A:ae=Ce.CODE_CODE_A;break;case Ce.CODE_CODE_C:ae=Ce.CODE_CODE_C;break;case Ce.CODE_STOP:me=!0;break}break;case Ce.CODE_CODE_C:if(pt<100)pt<10&&(je+="0"),je+=pt;else switch(pt!==Ce.CODE_STOP&&(Rt=!1),pt){case Ce.CODE_FNC_1:B&&(je.length===0?je+="]C1":je+="");break;case Ce.CODE_CODE_A:ae=Ce.CODE_CODE_A;break;case Ce.CODE_CODE_B:ae=Ce.CODE_CODE_B;break;case Ce.CODE_STOP:me=!0;break}break}Uf&&(ae=ae===Ce.CODE_CODE_A?Ce.CODE_CODE_B:Ce.CODE_CODE_A)}const Ii=Ue-Oe;if(Ue=_.getNextUnset(Ue),!_.isRange(Ue,Math.min(_.getSize(),Ue+(Ue-Oe)/2),!1))throw new S;if($t-=Ft*nt,$t%103!==nt)throw new m;const ol=je.length;if(ol===0)throw new S;ol>0&&Rt&&(ae===Ce.CODE_CODE_C?je=je.substring(0,ol-2):je=je.substring(0,ol-1));const Di=(z[1]+z[0])/2,Xn=Oe+Ii/2,za=te.length,no=new Uint8Array(za);for(let Uf=0;Uf<za;Uf++)no[Uf]=te[Uf];const zf=[new _e(Di,w),new _e(Xn,w)];return new Z(je,no,0,zf,G.CODE_128,new Date().getTime())}}Ce.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Ce.MAX_AVG_VARIANCE=.25,Ce.MAX_INDIVIDUAL_VARIANCE=.7,Ce.CODE_SHIFT=98,Ce.CODE_CODE_C=99,Ce.CODE_CODE_B=100,Ce.CODE_CODE_A=101,Ce.CODE_FNC_1=102,Ce.CODE_FNC_2=97,Ce.CODE_FNC_3=96,Ce.CODE_FNC_4_A=101,Ce.CODE_FNC_4_B=100,Ce.CODE_START_A=103,Ce.CODE_START_B=104,Ce.CODE_START_C=105,Ce.CODE_STOP=106;class Ge extends Je{constructor(w=!1,_=!1){super(),this.usingCheckDigit=w,this.extendedMode=_,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(w,_,A){let B=this.counters;B.fill(0),this.decodeRowResult="";let z=Ge.findAsteriskPattern(_,B),K=_.getNextSet(z[1]),Q=_.getSize(),te,ae;do{Ge.recordPattern(_,K,B);let He=Ge.toNarrowWidePattern(B);if(He<0)throw new S;te=Ge.patternToChar(He),this.decodeRowResult+=te,ae=K;for(let nt of B)K+=nt;K=_.getNextSet(K)}while(te!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let me=0;for(let He of B)me+=He;let ve=K-ae-me;if(K!==Q&&ve*2<me)throw new S;if(this.usingCheckDigit){let He=this.decodeRowResult.length-1,nt=0;for(let pt=0;pt<He;pt++)nt+=Ge.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(pt));if(this.decodeRowResult.charAt(He)!==Ge.ALPHABET_STRING.charAt(nt%43))throw new m;this.decodeRowResult=this.decodeRowResult.substring(0,He)}if(this.decodeRowResult.length===0)throw new S;let je;this.extendedMode?je=Ge.decodeExtended(this.decodeRowResult):je=this.decodeRowResult;let Oe=(z[1]+z[0])/2,Ue=ae+me/2;return new Z(je,null,0,[new _e(Oe,w),new _e(Ue,w)],G.CODE_39,new Date().getTime())}static findAsteriskPattern(w,_){let A=w.getSize(),B=w.getNextSet(0),z=0,K=B,Q=!1,te=_.length;for(let ae=B;ae<A;ae++)if(w.get(ae)!==Q)_[z]++;else{if(z===te-1){if(this.toNarrowWidePattern(_)===Ge.ASTERISK_ENCODING&&w.isRange(Math.max(0,K-Math.floor((ae-K)/2)),K,!1))return[K,ae];K+=_[0]+_[1],_.copyWithin(0,2,2+z-1),_[z-1]=0,_[z]=0,z--}else z++;_[z]=1,Q=!Q}throw new S}static toNarrowWidePattern(w){let _=w.length,A=0,B;do{let z=2147483647;for(let te of w)te<z&&te>A&&(z=te);A=z,B=0;let K=0,Q=0;for(let te=0;te<_;te++){let ae=w[te];ae>A&&(Q|=1<<_-1-te,B++,K+=ae)}if(B===3){for(let te=0;te<_&&B>0;te++){let ae=w[te];if(ae>A&&(B--,ae*2>=K))return-1}return Q}}while(B>3);return-1}static patternToChar(w){for(let _=0;_<Ge.CHARACTER_ENCODINGS.length;_++)if(Ge.CHARACTER_ENCODINGS[_]===w)return Ge.ALPHABET_STRING.charAt(_);if(w===Ge.ASTERISK_ENCODING)return"*";throw new S}static decodeExtended(w){let _=w.length,A="";for(let B=0;B<_;B++){let z=w.charAt(B);if(z==="+"||z==="$"||z==="%"||z==="/"){let K=w.charAt(B+1),Q="\0";switch(z){case"+":if(K>="A"&&K<="Z")Q=String.fromCharCode(K.charCodeAt(0)+32);else throw new R;break;case"$":if(K>="A"&&K<="Z")Q=String.fromCharCode(K.charCodeAt(0)-64);else throw new R;break;case"%":if(K>="A"&&K<="E")Q=String.fromCharCode(K.charCodeAt(0)-38);else if(K>="F"&&K<="J")Q=String.fromCharCode(K.charCodeAt(0)-11);else if(K>="K"&&K<="O")Q=String.fromCharCode(K.charCodeAt(0)+16);else if(K>="P"&&K<="T")Q=String.fromCharCode(K.charCodeAt(0)+43);else if(K==="U")Q="\0";else if(K==="V")Q="@";else if(K==="W")Q="`";else if(K==="X"||K==="Y"||K==="Z")Q="";else throw new R;break;case"/":if(K>="A"&&K<="O")Q=String.fromCharCode(K.charCodeAt(0)-32);else if(K==="Z")Q=":";else throw new R;break}A+=Q,B++}else A+=z}return A}}Ge.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Ge.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Ge.ASTERISK_ENCODING=148;class Pe extends Je{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(w,_,A){let B=this.decodeStart(_),z=this.decodeEnd(_),K=new M;Pe.decodeMiddle(_,B[1],z[0],K);let Q=K.toString(),te=null;A!=null&&(te=A.get(O.ALLOWED_LENGTHS)),te==null&&(te=Pe.DEFAULT_ALLOWED_LENGTHS);let ae=Q.length,me=!1,ve=0;for(let Ue of te){if(ae===Ue){me=!0;break}Ue>ve&&(ve=Ue)}if(!me&&ae>ve&&(me=!0),!me)throw new R;const je=[new _e(B[1],w),new _e(z[0],w)];return new Z(Q,null,0,je,G.ITF,new Date().getTime())}static decodeMiddle(w,_,A,B){let z=new Int32Array(10),K=new Int32Array(5),Q=new Int32Array(5);for(z.fill(0),K.fill(0),Q.fill(0);_<A;){Je.recordPattern(w,_,z);for(let ae=0;ae<5;ae++){let me=2*ae;K[ae]=z[me],Q[ae]=z[me+1]}let te=Pe.decodeDigit(K);B.append(te.toString()),te=this.decodeDigit(Q),B.append(te.toString()),z.forEach(function(ae){_+=ae})}}decodeStart(w){let _=Pe.skipWhiteSpace(w),A=Pe.findGuardPattern(w,_,Pe.START_PATTERN);return this.narrowLineWidth=(A[1]-A[0])/4,this.validateQuietZone(w,A[0]),A}validateQuietZone(w,_){let A=this.narrowLineWidth*10;A=A<_?A:_;for(let B=_-1;A>0&&B>=0&&!w.get(B);B--)A--;if(A!==0)throw new S}static skipWhiteSpace(w){const _=w.getSize(),A=w.getNextSet(0);if(A===_)throw new S;return A}decodeEnd(w){w.reverse();try{let _=Pe.skipWhiteSpace(w),A;try{A=Pe.findGuardPattern(w,_,Pe.END_PATTERN_REVERSED[0])}catch(z){z instanceof S&&(A=Pe.findGuardPattern(w,_,Pe.END_PATTERN_REVERSED[1]))}this.validateQuietZone(w,A[0]);let B=A[0];return A[0]=w.getSize()-A[1],A[1]=w.getSize()-B,A}finally{w.reverse()}}static findGuardPattern(w,_,A){let B=A.length,z=new Int32Array(B),K=w.getSize(),Q=!1,te=0,ae=_;z.fill(0);for(let me=_;me<K;me++)if(w.get(me)!==Q)z[te]++;else{if(te===B-1){if(Je.patternMatchVariance(z,A,Pe.MAX_INDIVIDUAL_VARIANCE)<Pe.MAX_AVG_VARIANCE)return[ae,me];ae+=z[0]+z[1],g.arraycopy(z,2,z,0,te-1),z[te-1]=0,z[te]=0,te--}else te++;z[te]=1,Q=!Q}throw new S}static decodeDigit(w){let _=Pe.MAX_AVG_VARIANCE,A=-1,B=Pe.PATTERNS.length;for(let z=0;z<B;z++){let K=Pe.PATTERNS[z],Q=Je.patternMatchVariance(w,K,Pe.MAX_INDIVIDUAL_VARIANCE);Q<_?(_=Q,A=z):Q===_&&(A=-1)}if(A>=0)return A%10;throw new S}}Pe.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Pe.MAX_AVG_VARIANCE=.38,Pe.MAX_INDIVIDUAL_VARIANCE=.5,Pe.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Pe.START_PATTERN=Int32Array.from([1,1,1,1]),Pe.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Ve extends Je{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(w){let _=!1,A,B=0,z=Int32Array.from([0,0,0]);for(;!_;){z=Int32Array.from([0,0,0]),A=Ve.findGuardPattern(w,B,!1,this.START_END_PATTERN,z);let K=A[0];B=A[1];let Q=K-(B-K);Q>=0&&(_=w.isRange(Q,K,!1))}return A}static checkChecksum(w){return Ve.checkStandardUPCEANChecksum(w)}static checkStandardUPCEANChecksum(w){let _=w.length;if(_===0)return!1;let A=parseInt(w.charAt(_-1),10);return Ve.getStandardUPCEANChecksum(w.substring(0,_-1))===A}static getStandardUPCEANChecksum(w){let _=w.length,A=0;for(let B=_-1;B>=0;B-=2){let z=w.charAt(B).charCodeAt(0)-48;if(z<0||z>9)throw new R;A+=z}A*=3;for(let B=_-2;B>=0;B-=2){let z=w.charAt(B).charCodeAt(0)-48;if(z<0||z>9)throw new R;A+=z}return(1e3-A)%10}static decodeEnd(w,_){return Ve.findGuardPattern(w,_,!1,Ve.START_END_PATTERN,new Int32Array(Ve.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(w,_,A,B){return this.findGuardPattern(w,_,A,B,new Int32Array(B.length))}static findGuardPattern(w,_,A,B,z){let K=w.getSize();_=A?w.getNextUnset(_):w.getNextSet(_);let Q=0,te=_,ae=B.length,me=A;for(let ve=_;ve<K;ve++)if(w.get(ve)!==me)z[Q]++;else{if(Q===ae-1){if(Je.patternMatchVariance(z,B,Ve.MAX_INDIVIDUAL_VARIANCE)<Ve.MAX_AVG_VARIANCE)return Int32Array.from([te,ve]);te+=z[0]+z[1];let je=z.slice(2,z.length-1);for(let Oe=0;Oe<Q-1;Oe++)z[Oe]=je[Oe];z[Q-1]=0,z[Q]=0,Q--}else Q++;z[Q]=1,me=!me}throw new S}static decodeDigit(w,_,A,B){this.recordPattern(w,A,_);let z=this.MAX_AVG_VARIANCE,K=-1,Q=B.length;for(let te=0;te<Q;te++){let ae=B[te],me=Je.patternMatchVariance(_,ae,Ve.MAX_INDIVIDUAL_VARIANCE);me<z&&(z=me,K=te)}if(K>=0)return K;throw new S}}Ve.MAX_AVG_VARIANCE=.48,Ve.MAX_INDIVIDUAL_VARIANCE=.7,Ve.START_END_PATTERN=Int32Array.from([1,1,1]),Ve.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Ve.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Ve.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class st{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(w,_,A){let B=this.decodeRowStringBuffer,z=this.decodeMiddle(_,A,B),K=B.toString(),Q=st.parseExtensionString(K),te=[new _e((A[0]+A[1])/2,w),new _e(z,w)],ae=new Z(K,null,0,te,G.UPC_EAN_EXTENSION,new Date().getTime());return Q!=null&&ae.putAllMetadata(Q),ae}decodeMiddle(w,_,A){let B=this.decodeMiddleCounters;B[0]=0,B[1]=0,B[2]=0,B[3]=0;let z=w.getSize(),K=_[1],Q=0;for(let ae=0;ae<5&&K<z;ae++){let me=Ve.decodeDigit(w,B,K,Ve.L_AND_G_PATTERNS);A+=String.fromCharCode(48+me%10);for(let ve of B)K+=ve;me>=10&&(Q|=1<<4-ae),ae!==4&&(K=w.getNextSet(K),K=w.getNextUnset(K))}if(A.length!==5)throw new S;let te=this.determineCheckDigit(Q);if(st.extensionChecksum(A.toString())!==te)throw new S;return K}static extensionChecksum(w){let _=w.length,A=0;for(let B=_-2;B>=0;B-=2)A+=w.charAt(B).charCodeAt(0)-48;A*=3;for(let B=_-1;B>=0;B-=2)A+=w.charAt(B).charCodeAt(0)-48;return A*=3,A%10}determineCheckDigit(w){for(let _=0;_<10;_++)if(w===this.CHECK_DIGIT_ENCODINGS[_])return _;throw new S}static parseExtensionString(w){if(w.length!==5)return null;let _=st.parseExtension5String(w);return _==null?null:new Map([[V.SUGGESTED_PRICE,_]])}static parseExtension5String(w){let _;switch(w.charAt(0)){case"0":_="";break;case"5":_="$";break;case"9":switch(w){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}_="";break;default:_="";break}let A=parseInt(w.substring(1)),B=(A/100).toString(),z=A%100,K=z<10?"0"+z:z.toString();return _+B+"."+K}}class xt{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(w,_,A){let B=this.decodeRowStringBuffer,z=this.decodeMiddle(_,A,B),K=B.toString(),Q=xt.parseExtensionString(K),te=[new _e((A[0]+A[1])/2,w),new _e(z,w)],ae=new Z(K,null,0,te,G.UPC_EAN_EXTENSION,new Date().getTime());return Q!=null&&ae.putAllMetadata(Q),ae}decodeMiddle(w,_,A){let B=this.decodeMiddleCounters;B[0]=0,B[1]=0,B[2]=0,B[3]=0;let z=w.getSize(),K=_[1],Q=0;for(let te=0;te<2&&K<z;te++){let ae=Ve.decodeDigit(w,B,K,Ve.L_AND_G_PATTERNS);A+=String.fromCharCode(48+ae%10);for(let me of B)K+=me;ae>=10&&(Q|=1<<1-te),te!==1&&(K=w.getNextSet(K),K=w.getNextUnset(K))}if(A.length!==2)throw new S;if(parseInt(A.toString())%4!==Q)throw new S;return K}static parseExtensionString(w){return w.length!==2?null:new Map([[V.ISSUE_NUMBER,parseInt(w)]])}}class fe{static decodeRow(w,_,A){let B=Ve.findGuardPattern(_,A,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new st().decodeRow(w,_,B)}catch{return new xt().decodeRow(w,_,B)}}}fe.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class Ie extends Ve{constructor(){super(),this.decodeRowStringBuffer="",Ie.L_AND_G_PATTERNS=Ie.L_PATTERNS.map(w=>Int32Array.from(w));for(let w=10;w<20;w++){let _=Ie.L_PATTERNS[w-10],A=new Int32Array(_.length);for(let B=0;B<_.length;B++)A[B]=_[_.length-B-1];Ie.L_AND_G_PATTERNS[w]=A}}decodeRow(w,_,A){let B=Ie.findStartGuardPattern(_),z=A==null?null:A.get(O.NEED_RESULT_POINT_CALLBACK);if(z!=null){const Rt=new _e((B[0]+B[1])/2,w);z.foundPossibleResultPoint(Rt)}let K=this.decodeMiddle(_,B,this.decodeRowStringBuffer),Q=K.rowOffset,te=K.resultString;if(z!=null){const Rt=new _e(Q,w);z.foundPossibleResultPoint(Rt)}let ae=this.decodeEnd(_,Q);if(z!=null){const Rt=new _e((ae[0]+ae[1])/2,w);z.foundPossibleResultPoint(Rt)}let me=ae[1],ve=me+(me-ae[0]);if(ve>=_.getSize()||!_.isRange(me,ve,!1))throw new S;let je=te.toString();if(je.length<8)throw new R;if(!Ie.checkChecksum(je))throw new m;let Oe=(B[1]+B[0])/2,Ue=(ae[1]+ae[0])/2,He=this.getBarcodeFormat(),nt=[new _e(Oe,w),new _e(Ue,w)],pt=new Z(je,null,0,nt,He,new Date().getTime()),$t=0;try{let Rt=fe.decodeRow(w,_,ae[1]);pt.putMetadata(V.UPC_EAN_EXTENSION,Rt.getText()),pt.putAllMetadata(Rt.getResultMetadata()),pt.addResultPoints(Rt.getResultPoints()),$t=Rt.getText().length}catch{}let Ft=A==null?null:A.get(O.ALLOWED_EAN_EXTENSIONS);if(Ft!=null){let Rt=!1;for(let hn in Ft)if($t.toString()===hn){Rt=!0;break}if(!Rt)throw new S}return pt}decodeEnd(w,_){return Ie.findGuardPattern(w,_,!1,Ie.START_END_PATTERN,new Int32Array(Ie.START_END_PATTERN.length).fill(0))}static checkChecksum(w){return Ie.checkStandardUPCEANChecksum(w)}static checkStandardUPCEANChecksum(w){let _=w.length;if(_===0)return!1;let A=parseInt(w.charAt(_-1),10);return Ie.getStandardUPCEANChecksum(w.substring(0,_-1))===A}static getStandardUPCEANChecksum(w){let _=w.length,A=0;for(let B=_-1;B>=0;B-=2){let z=w.charAt(B).charCodeAt(0)-48;if(z<0||z>9)throw new R;A+=z}A*=3;for(let B=_-2;B>=0;B-=2){let z=w.charAt(B).charCodeAt(0)-48;if(z<0||z>9)throw new R;A+=z}return(1e3-A)%10}}class tt extends Ie{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(w,_,A){let B=this.decodeMiddleCounters;B[0]=0,B[1]=0,B[2]=0,B[3]=0;let z=w.getSize(),K=_[1],Q=0;for(let ae=0;ae<6&&K<z;ae++){let me=Ie.decodeDigit(w,B,K,Ie.L_AND_G_PATTERNS);A+=String.fromCharCode(48+me%10);for(let ve of B)K+=ve;me>=10&&(Q|=1<<5-ae)}A=tt.determineFirstDigit(A,Q),K=Ie.findGuardPattern(w,K,!0,Ie.MIDDLE_PATTERN,new Int32Array(Ie.MIDDLE_PATTERN.length).fill(0))[1];for(let ae=0;ae<6&&K<z;ae++){let me=Ie.decodeDigit(w,B,K,Ie.L_PATTERNS);A+=String.fromCharCode(48+me);for(let ve of B)K+=ve}return{rowOffset:K,resultString:A}}getBarcodeFormat(){return G.EAN_13}static determineFirstDigit(w,_){for(let A=0;A<10;A++)if(_===this.FIRST_DIGIT_ENCODINGS[A])return w=String.fromCharCode(48+A)+w,w;throw new S}}tt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class lt extends Ie{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(w,_,A){const B=this.decodeMiddleCounters;B[0]=0,B[1]=0,B[2]=0,B[3]=0;let z=w.getSize(),K=_[1];for(let te=0;te<4&&K<z;te++){let ae=Ie.decodeDigit(w,B,K,Ie.L_PATTERNS);A+=String.fromCharCode(48+ae);for(let me of B)K+=me}K=Ie.findGuardPattern(w,K,!0,Ie.MIDDLE_PATTERN,new Int32Array(Ie.MIDDLE_PATTERN.length).fill(0))[1];for(let te=0;te<4&&K<z;te++){let ae=Ie.decodeDigit(w,B,K,Ie.L_PATTERNS);A+=String.fromCharCode(48+ae);for(let me of B)K+=me}return{rowOffset:K,resultString:A}}getBarcodeFormat(){return G.EAN_8}}class It extends Ie{constructor(){super(...arguments),this.ean13Reader=new tt}getBarcodeFormat(){return G.UPC_A}decode(w,_){return this.maybeReturnResult(this.ean13Reader.decode(w))}decodeRow(w,_,A){return this.maybeReturnResult(this.ean13Reader.decodeRow(w,_,A))}decodeMiddle(w,_,A){return this.ean13Reader.decodeMiddle(w,_,A)}maybeReturnResult(w){let _=w.getText();if(_.charAt(0)==="0"){let A=new Z(_.substring(1),null,null,w.getResultPoints(),G.UPC_A);return w.getResultMetadata()!=null&&A.putAllMetadata(w.getResultMetadata()),A}else throw new S}reset(){this.ean13Reader.reset()}}class ct extends Ie{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(w,_,A){const B=this.decodeMiddleCounters.map(ae=>ae);B[0]=0,B[1]=0,B[2]=0,B[3]=0;const z=w.getSize();let K=_[1],Q=0;for(let ae=0;ae<6&&K<z;ae++){const me=ct.decodeDigit(w,B,K,ct.L_AND_G_PATTERNS);A+=String.fromCharCode(48+me%10);for(let ve of B)K+=ve;me>=10&&(Q|=1<<5-ae)}let te=ct.determineNumSysAndCheckDigit(A,Q);return{rowOffset:K,resultString:te}}decodeEnd(w,_){return ct.findGuardPatternWithoutCounters(w,_,!0,ct.MIDDLE_END_PATTERN)}checkChecksum(w){return Ie.checkChecksum(ct.convertUPCEtoUPCA(w))}static determineNumSysAndCheckDigit(w,_){for(let A=0;A<=1;A++)for(let B=0;B<10;B++)if(_===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[A][B]){let z=String.fromCharCode(48+A),K=String.fromCharCode(48+B);return z+w+K}throw S.getNotFoundInstance()}getBarcodeFormat(){return G.UPC_E}static convertUPCEtoUPCA(w){const _=w.slice(1,7).split("").map(z=>z.charCodeAt(0)),A=new M;A.append(w.charAt(0));let B=_[5];switch(B){case 0:case 1:case 2:A.appendChars(_,0,2),A.append(B),A.append("0000"),A.appendChars(_,2,3);break;case 3:A.appendChars(_,0,3),A.append("00000"),A.appendChars(_,3,2);break;case 4:A.appendChars(_,0,4),A.append("00000"),A.append(_[4]);break;default:A.appendChars(_,0,5),A.append("0000"),A.append(B);break}return w.length>=8&&A.append(w.charAt(7)),A.toString()}}ct.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),ct.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class at extends Je{constructor(w){super();let _=w==null?null:w.get(O.POSSIBLE_FORMATS),A=[];s(_)?(A.push(new tt),A.push(new It),A.push(new lt),A.push(new ct)):(_.indexOf(G.EAN_13)>-1&&A.push(new tt),_.indexOf(G.UPC_A)>-1&&A.push(new It),_.indexOf(G.EAN_8)>-1&&A.push(new lt),_.indexOf(G.UPC_E)>-1&&A.push(new ct)),this.readers=A}decodeRow(w,_,A){for(let B of this.readers)try{const z=B.decodeRow(w,_,A),K=z.getBarcodeFormat()===G.EAN_13&&z.getText().charAt(0)==="0",Q=A==null?null:A.get(O.POSSIBLE_FORMATS),te=Q==null||Q.includes(G.UPC_A);if(K&&te){const ae=z.getRawBytes(),me=new Z(z.getText().substring(1),ae,ae?ae.length:null,z.getResultPoints(),G.UPC_A);return me.putAllMetadata(z.getResultMetadata()),me}return z}catch{}throw new S}reset(){for(let w of this.readers)w.reset()}}class gt extends Je{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(w,_){for(let A=0;A<_.length;A++)if(Je.patternMatchVariance(w,_[A],gt.MAX_INDIVIDUAL_VARIANCE)<gt.MAX_AVG_VARIANCE)return A;throw new S}static count(w){return ge.sum(new Int32Array(w))}static increment(w,_){let A=0,B=_[0];for(let z=1;z<w.length;z++)_[z]>B&&(B=_[z],A=z);w[A]++}static decrement(w,_){let A=0,B=_[0];for(let z=1;z<w.length;z++)_[z]<B&&(B=_[z],A=z);w[A]--}static isFinderPattern(w){let _=w[0]+w[1],A=_+w[2]+w[3],B=_/A;if(B>=gt.MIN_FINDER_PATTERN_RATIO&&B<=gt.MAX_FINDER_PATTERN_RATIO){let z=Number.MAX_SAFE_INTEGER,K=Number.MIN_SAFE_INTEGER;for(let Q of w)Q>K&&(K=Q),Q<z&&(z=Q);return K<10*z}return!1}}gt.MAX_AVG_VARIANCE=.2,gt.MAX_INDIVIDUAL_VARIANCE=.45,gt.MIN_FINDER_PATTERN_RATIO=9.5/12,gt.MAX_FINDER_PATTERN_RATIO=12.5/14;class Yt{constructor(w,_){this.value=w,this.checksumPortion=_}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(w){if(!(w instanceof Yt))return!1;const _=w;return this.value===_.value&&this.checksumPortion===_.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class St{constructor(w,_,A,B,z){this.value=w,this.startEnd=_,this.value=w,this.startEnd=_,this.resultPoints=new Array,this.resultPoints.push(new _e(A,z)),this.resultPoints.push(new _e(B,z))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(w){if(!(w instanceof St))return!1;const _=w;return this.value===_.value}hashCode(){return this.value}}class rt{constructor(){}static getRSSvalue(w,_,A){let B=0;for(let te of w)B+=te;let z=0,K=0,Q=w.length;for(let te=0;te<Q-1;te++){let ae;for(ae=1,K|=1<<te;ae<w[te];ae++,K&=~(1<<te)){let me=rt.combins(B-ae-1,Q-te-2);if(A&&K===0&&B-ae-(Q-te-1)>=Q-te-1&&(me-=rt.combins(B-ae-(Q-te),Q-te-2)),Q-te-1>1){let ve=0;for(let je=B-ae-(Q-te-2);je>_;je--)ve+=rt.combins(B-ae-je-1,Q-te-3);me-=ve*(Q-1-te)}else B-ae>_&&me--;z+=me}B-=ae}return z}static combins(w,_){let A,B;w-_>_?(B=_,A=w-_):(B=w-_,A=_);let z=1,K=1;for(let Q=w;Q>A;Q--)z*=Q,K<=B&&(z/=K,K++);for(;K<=B;)z/=K,K++;return z}}class ir{static buildBitArray(w){let _=w.length*2-1;w[w.length-1].getRightChar()==null&&(_-=1);let A=12*_,B=new j(A),z=0,Q=w[0].getRightChar().getValue();for(let te=11;te>=0;--te)Q&1<<te&&B.set(z),z++;for(let te=1;te<w.length;++te){let ae=w[te],me=ae.getLeftChar().getValue();for(let ve=11;ve>=0;--ve)me&1<<ve&&B.set(z),z++;if(ae.getRightChar()!=null){let ve=ae.getRightChar().getValue();for(let je=11;je>=0;--je)ve&1<<je&&B.set(z),z++}}return B}}class Ct{constructor(w,_){_?this.decodedInformation=null:(this.finished=w,this.decodedInformation=_)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Te{constructor(w){this.newPosition=w}getNewPosition(){return this.newPosition}}class qe extends Te{constructor(w,_){super(w),this.value=_}getValue(){return this.value}isFNC1(){return this.value===qe.FNC1}}qe.FNC1="$";class ht extends Te{constructor(w,_,A){super(w),A?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=_}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Pt extends Te{constructor(w,_,A){if(super(w),_<0||_>10||A<0||A>10)throw new R;this.firstDigit=_,this.secondDigit=A}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Pt.FNC1}isSecondDigitFNC1(){return this.secondDigit===Pt.FNC1}isAnyFNC1(){return this.firstDigit===Pt.FNC1||this.secondDigit===Pt.FNC1}}Pt.FNC1=10;class vt{constructor(){}static parseFieldsInGeneralPurpose(w){if(!w)return null;if(w.length<2)throw new S;let _=w.substring(0,2);for(let z of vt.TWO_DIGIT_DATA_LENGTH)if(z[0]===_)return z[1]===vt.VARIABLE_LENGTH?vt.processVariableAI(2,z[2],w):vt.processFixedAI(2,z[1],w);if(w.length<3)throw new S;let A=w.substring(0,3);for(let z of vt.THREE_DIGIT_DATA_LENGTH)if(z[0]===A)return z[1]===vt.VARIABLE_LENGTH?vt.processVariableAI(3,z[2],w):vt.processFixedAI(3,z[1],w);for(let z of vt.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(z[0]===A)return z[1]===vt.VARIABLE_LENGTH?vt.processVariableAI(4,z[2],w):vt.processFixedAI(4,z[1],w);if(w.length<4)throw new S;let B=w.substring(0,4);for(let z of vt.FOUR_DIGIT_DATA_LENGTH)if(z[0]===B)return z[1]===vt.VARIABLE_LENGTH?vt.processVariableAI(4,z[2],w):vt.processFixedAI(4,z[1],w);throw new S}static processFixedAI(w,_,A){if(A.length<w)throw new S;let B=A.substring(0,w);if(A.length<w+_)throw new S;let z=A.substring(w,w+_),K=A.substring(w+_),Q="("+B+")"+z,te=vt.parseFieldsInGeneralPurpose(K);return te==null?Q:Q+te}static processVariableAI(w,_,A){let B=A.substring(0,w),z;A.length<w+_?z=A.length:z=w+_;let K=A.substring(w,z),Q=A.substring(z),te="("+B+")"+K,ae=vt.parseFieldsInGeneralPurpose(Q);return ae==null?te:te+ae}}vt.VARIABLE_LENGTH=[],vt.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",vt.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",vt.VARIABLE_LENGTH,20],["22",vt.VARIABLE_LENGTH,29],["30",vt.VARIABLE_LENGTH,8],["37",vt.VARIABLE_LENGTH,8],["90",vt.VARIABLE_LENGTH,30],["91",vt.VARIABLE_LENGTH,30],["92",vt.VARIABLE_LENGTH,30],["93",vt.VARIABLE_LENGTH,30],["94",vt.VARIABLE_LENGTH,30],["95",vt.VARIABLE_LENGTH,30],["96",vt.VARIABLE_LENGTH,30],["97",vt.VARIABLE_LENGTH,3],["98",vt.VARIABLE_LENGTH,30],["99",vt.VARIABLE_LENGTH,30]],vt.THREE_DIGIT_DATA_LENGTH=[["240",vt.VARIABLE_LENGTH,30],["241",vt.VARIABLE_LENGTH,30],["242",vt.VARIABLE_LENGTH,6],["250",vt.VARIABLE_LENGTH,30],["251",vt.VARIABLE_LENGTH,30],["253",vt.VARIABLE_LENGTH,17],["254",vt.VARIABLE_LENGTH,20],["400",vt.VARIABLE_LENGTH,30],["401",vt.VARIABLE_LENGTH,30],["402",17],["403",vt.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",vt.VARIABLE_LENGTH,20],["421",vt.VARIABLE_LENGTH,15],["422",3],["423",vt.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],vt.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",vt.VARIABLE_LENGTH,15],["391",vt.VARIABLE_LENGTH,18],["392",vt.VARIABLE_LENGTH,15],["393",vt.VARIABLE_LENGTH,18],["703",vt.VARIABLE_LENGTH,30]],vt.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",vt.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",vt.VARIABLE_LENGTH,20],["8003",vt.VARIABLE_LENGTH,30],["8004",vt.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",vt.VARIABLE_LENGTH,30],["8008",vt.VARIABLE_LENGTH,12],["8018",18],["8020",vt.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",vt.VARIABLE_LENGTH,70],["8200",vt.VARIABLE_LENGTH,70]];class Dt{constructor(w){this.buffer=new M,this.information=w}decodeAllCodes(w,_){let A=_,B=null;do{let z=this.decodeGeneralPurposeField(A,B),K=vt.parseFieldsInGeneralPurpose(z.getNewString());if(K!=null&&w.append(K),z.isRemaining()?B=""+z.getRemainingValue():B=null,A===z.getNewPosition())break;A=z.getNewPosition()}while(!0);return w.toString()}isStillNumeric(w){if(w+7>this.information.getSize())return w+4<=this.information.getSize();for(let _=w;_<w+3;++_)if(this.information.get(_))return!0;return this.information.get(w+3)}decodeNumeric(w){if(w+7>this.information.getSize()){let z=this.extractNumericValueFromBitArray(w,4);return z===0?new Pt(this.information.getSize(),Pt.FNC1,Pt.FNC1):new Pt(this.information.getSize(),z-1,Pt.FNC1)}let _=this.extractNumericValueFromBitArray(w,7),A=(_-8)/11,B=(_-8)%11;return new Pt(w+7,A,B)}extractNumericValueFromBitArray(w,_){return Dt.extractNumericValueFromBitArray(this.information,w,_)}static extractNumericValueFromBitArray(w,_,A){let B=0;for(let z=0;z<A;++z)w.get(_+z)&&(B|=1<<A-z-1);return B}decodeGeneralPurposeField(w,_){this.buffer.setLengthToZero(),_!=null&&this.buffer.append(_),this.current.setPosition(w);let A=this.parseBlocks();return A!=null&&A.isRemaining()?new ht(this.current.getPosition(),this.buffer.toString(),A.getRemainingValue()):new ht(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let w,_;do{let A=this.current.getPosition();if(this.current.isAlpha()?(_=this.parseAlphaBlock(),w=_.isFinished()):this.current.isIsoIec646()?(_=this.parseIsoIec646Block(),w=_.isFinished()):(_=this.parseNumericBlock(),w=_.isFinished()),!(A!==this.current.getPosition())&&!w)break}while(!w);return _.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let w=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(w.getNewPosition()),w.isFirstDigitFNC1()){let _;return w.isSecondDigitFNC1()?_=new ht(this.current.getPosition(),this.buffer.toString()):_=new ht(this.current.getPosition(),this.buffer.toString(),w.getSecondDigit()),new Ct(!0,_)}if(this.buffer.append(w.getFirstDigit()),w.isSecondDigitFNC1()){let _=new ht(this.current.getPosition(),this.buffer.toString());return new Ct(!0,_)}this.buffer.append(w.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Ct(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let w=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(w.getNewPosition()),w.isFNC1()){let _=new ht(this.current.getPosition(),this.buffer.toString());return new Ct(!0,_)}this.buffer.append(w.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Ct(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let w=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(w.getNewPosition()),w.isFNC1()){let _=new ht(this.current.getPosition(),this.buffer.toString());return new Ct(!0,_)}this.buffer.append(w.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Ct(!1)}isStillIsoIec646(w){if(w+5>this.information.getSize())return!1;let _=this.extractNumericValueFromBitArray(w,5);if(_>=5&&_<16)return!0;if(w+7>this.information.getSize())return!1;let A=this.extractNumericValueFromBitArray(w,7);if(A>=64&&A<116)return!0;if(w+8>this.information.getSize())return!1;let B=this.extractNumericValueFromBitArray(w,8);return B>=232&&B<253}decodeIsoIec646(w){let _=this.extractNumericValueFromBitArray(w,5);if(_===15)return new qe(w+5,qe.FNC1);if(_>=5&&_<15)return new qe(w+5,"0"+(_-5));let A=this.extractNumericValueFromBitArray(w,7);if(A>=64&&A<90)return new qe(w+7,""+(A+1));if(A>=90&&A<116)return new qe(w+7,""+(A+7));let B=this.extractNumericValueFromBitArray(w,8),z;switch(B){case 232:z="!";break;case 233:z='"';break;case 234:z="%";break;case 235:z="&";break;case 236:z="'";break;case 237:z="(";break;case 238:z=")";break;case 239:z="*";break;case 240:z="+";break;case 241:z=",";break;case 242:z="-";break;case 243:z=".";break;case 244:z="/";break;case 245:z=":";break;case 246:z=";";break;case 247:z="<";break;case 248:z="=";break;case 249:z=">";break;case 250:z="?";break;case 251:z="_";break;case 252:z=" ";break;default:throw new R}return new qe(w+8,z)}isStillAlpha(w){if(w+5>this.information.getSize())return!1;let _=this.extractNumericValueFromBitArray(w,5);if(_>=5&&_<16)return!0;if(w+6>this.information.getSize())return!1;let A=this.extractNumericValueFromBitArray(w,6);return A>=16&&A<63}decodeAlphanumeric(w){let _=this.extractNumericValueFromBitArray(w,5);if(_===15)return new qe(w+5,qe.FNC1);if(_>=5&&_<15)return new qe(w+5,"0"+(_-5));let A=this.extractNumericValueFromBitArray(w,6);if(A>=32&&A<58)return new qe(w+6,""+(A+33));let B;switch(A){case 58:B="*";break;case 59:B=",";break;case 60:B="-";break;case 61:B=".";break;case 62:B="/";break;default:throw new ye("Decoding invalid alphanumeric value: "+A)}return new qe(w+6,B)}isAlphaTo646ToAlphaLatch(w){if(w+1>this.information.getSize())return!1;for(let _=0;_<5&&_+w<this.information.getSize();++_)if(_===2){if(!this.information.get(w+2))return!1}else if(this.information.get(w+_))return!1;return!0}isAlphaOr646ToNumericLatch(w){if(w+3>this.information.getSize())return!1;for(let _=w;_<w+3;++_)if(this.information.get(_))return!1;return!0}isNumericToAlphaNumericLatch(w){if(w+1>this.information.getSize())return!1;for(let _=0;_<4&&_+w<this.information.getSize();++_)if(this.information.get(w+_))return!1;return!0}}class _r{constructor(w){this.information=w,this.generalDecoder=new Dt(w)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class sr extends _r{constructor(w){super(w)}encodeCompressedGtin(w,_){w.append("(01)");let A=w.length();w.append("9"),this.encodeCompressedGtinWithoutAI(w,_,A)}encodeCompressedGtinWithoutAI(w,_,A){for(let B=0;B<4;++B){let z=this.getGeneralDecoder().extractNumericValueFromBitArray(_+10*B,10);z/100===0&&w.append("0"),z/10===0&&w.append("0"),w.append(z)}sr.appendCheckDigit(w,A)}static appendCheckDigit(w,_){let A=0;for(let B=0;B<13;B++){let z=w.charAt(B+_).charCodeAt(0)-48;A+=B&1?z:3*z}A=10-A%10,A===10&&(A=0),w.append(A)}}sr.GTIN_SIZE=40;class or extends sr{constructor(w){super(w)}parseInformation(){let w=new M;w.append("(01)");let _=w.length(),A=this.getGeneralDecoder().extractNumericValueFromBitArray(or.HEADER_SIZE,4);return w.append(A),this.encodeCompressedGtinWithoutAI(w,or.HEADER_SIZE+4,_),this.getGeneralDecoder().decodeAllCodes(w,or.HEADER_SIZE+44)}}or.HEADER_SIZE=4;class jr extends _r{constructor(w){super(w)}parseInformation(){let w=new M;return this.getGeneralDecoder().decodeAllCodes(w,jr.HEADER_SIZE)}}jr.HEADER_SIZE=5;class br extends sr{constructor(w){super(w)}encodeCompressedWeight(w,_,A){let B=this.getGeneralDecoder().extractNumericValueFromBitArray(_,A);this.addWeightCode(w,B);let z=this.checkWeight(B),K=1e5;for(let Q=0;Q<5;++Q)z/K===0&&w.append("0"),K/=10;w.append(z)}}class Nr extends br{constructor(w){super(w)}parseInformation(){if(this.getInformation().getSize()!=Nr.HEADER_SIZE+br.GTIN_SIZE+Nr.WEIGHT_SIZE)throw new S;let w=new M;return this.encodeCompressedGtin(w,Nr.HEADER_SIZE),this.encodeCompressedWeight(w,Nr.HEADER_SIZE+br.GTIN_SIZE,Nr.WEIGHT_SIZE),w.toString()}}Nr.HEADER_SIZE=5,Nr.WEIGHT_SIZE=15;class et extends Nr{constructor(w){super(w)}addWeightCode(w,_){w.append("(3103)")}checkWeight(w){return w}}class Tt extends Nr{constructor(w){super(w)}addWeightCode(w,_){_<1e4?w.append("(3202)"):w.append("(3203)")}checkWeight(w){return w<1e4?w:w-1e4}}class rr extends sr{constructor(w){super(w)}parseInformation(){if(this.getInformation().getSize()<rr.HEADER_SIZE+sr.GTIN_SIZE)throw new S;let w=new M;this.encodeCompressedGtin(w,rr.HEADER_SIZE);let _=this.getGeneralDecoder().extractNumericValueFromBitArray(rr.HEADER_SIZE+sr.GTIN_SIZE,rr.LAST_DIGIT_SIZE);w.append("(392"),w.append(_),w.append(")");let A=this.getGeneralDecoder().decodeGeneralPurposeField(rr.HEADER_SIZE+sr.GTIN_SIZE+rr.LAST_DIGIT_SIZE,null);return w.append(A.getNewString()),w.toString()}}rr.HEADER_SIZE=8,rr.LAST_DIGIT_SIZE=2;class nr extends sr{constructor(w){super(w)}parseInformation(){if(this.getInformation().getSize()<nr.HEADER_SIZE+sr.GTIN_SIZE)throw new S;let w=new M;this.encodeCompressedGtin(w,nr.HEADER_SIZE);let _=this.getGeneralDecoder().extractNumericValueFromBitArray(nr.HEADER_SIZE+sr.GTIN_SIZE,nr.LAST_DIGIT_SIZE);w.append("(393"),w.append(_),w.append(")");let A=this.getGeneralDecoder().extractNumericValueFromBitArray(nr.HEADER_SIZE+sr.GTIN_SIZE+nr.LAST_DIGIT_SIZE,nr.FIRST_THREE_DIGITS_SIZE);A/100==0&&w.append("0"),A/10==0&&w.append("0"),w.append(A);let B=this.getGeneralDecoder().decodeGeneralPurposeField(nr.HEADER_SIZE+sr.GTIN_SIZE+nr.LAST_DIGIT_SIZE+nr.FIRST_THREE_DIGITS_SIZE,null);return w.append(B.getNewString()),w.toString()}}nr.HEADER_SIZE=8,nr.LAST_DIGIT_SIZE=2,nr.FIRST_THREE_DIGITS_SIZE=10;class Qt extends br{constructor(w,_,A){super(w),this.dateCode=A,this.firstAIdigits=_}parseInformation(){if(this.getInformation().getSize()!=Qt.HEADER_SIZE+Qt.GTIN_SIZE+Qt.WEIGHT_SIZE+Qt.DATE_SIZE)throw new S;let w=new M;return this.encodeCompressedGtin(w,Qt.HEADER_SIZE),this.encodeCompressedWeight(w,Qt.HEADER_SIZE+Qt.GTIN_SIZE,Qt.WEIGHT_SIZE),this.encodeCompressedDate(w,Qt.HEADER_SIZE+Qt.GTIN_SIZE+Qt.WEIGHT_SIZE),w.toString()}encodeCompressedDate(w,_){let A=this.getGeneralDecoder().extractNumericValueFromBitArray(_,Qt.DATE_SIZE);if(A==38400)return;w.append("("),w.append(this.dateCode),w.append(")");let B=A%32;A/=32;let z=A%12+1;A/=12;let K=A;K/10==0&&w.append("0"),w.append(K),z/10==0&&w.append("0"),w.append(z),B/10==0&&w.append("0"),w.append(B)}addWeightCode(w,_){w.append("("),w.append(this.firstAIdigits),w.append(_/1e5),w.append(")")}checkWeight(w){return w%1e5}}Qt.HEADER_SIZE=8,Qt.WEIGHT_SIZE=20,Qt.DATE_SIZE=16;function Ee(xe){try{if(xe.get(1))return new or(xe);if(!xe.get(2))return new jr(xe);switch(Dt.extractNumericValueFromBitArray(xe,1,4)){case 4:return new et(xe);case 5:return new Tt(xe)}switch(Dt.extractNumericValueFromBitArray(xe,1,5)){case 12:return new rr(xe);case 13:return new nr(xe)}switch(Dt.extractNumericValueFromBitArray(xe,1,7)){case 56:return new Qt(xe,"310","11");case 57:return new Qt(xe,"320","11");case 58:return new Qt(xe,"310","13");case 59:return new Qt(xe,"320","13");case 60:return new Qt(xe,"310","15");case 61:return new Qt(xe,"320","15");case 62:return new Qt(xe,"310","17");case 63:return new Qt(xe,"320","17")}}catch(w){throw console.log(w),new ye("unknown decoder: "+xe)}}class Xe{constructor(w,_,A,B){this.leftchar=w,this.rightchar=_,this.finderpattern=A,this.maybeLast=B}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(w,_){return w instanceof Xe?Xe.equalsOrNull(w.leftchar,_.leftchar)&&Xe.equalsOrNull(w.rightchar,_.rightchar)&&Xe.equalsOrNull(w.finderpattern,_.finderpattern):!1}static equalsOrNull(w,_){return w===null?_===null:Xe.equals(w,_)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class dt{constructor(w,_,A){this.pairs=w,this.rowNumber=_,this.wasReversed=A}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(w){return this.checkEqualitity(this,w)}toString(){return"{ "+this.pairs+" }"}equals(w,_){return w instanceof dt?this.checkEqualitity(w,_)&&w.wasReversed===_.wasReversed:!1}checkEqualitity(w,_){if(!w||!_)return;let A;return w.forEach((B,z)=>{_.forEach(K=>{B.getLeftChar().getValue()===K.getLeftChar().getValue()&&B.getRightChar().getValue()===K.getRightChar().getValue()&&B.getFinderPatter().getValue()===K.getFinderPatter().getValue()&&(A=!0)})}),A}}class Fe extends gt{constructor(w){super(...arguments),this.pairs=new Array(Fe.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=w===!0}decodeRow(w,_,A){this.pairs.length=0,this.startFromEven=!1;try{return Fe.constructResult(this.decodeRow2pairs(w,_))}catch(B){this.verbose&&console.log(B)}return this.pairs.length=0,this.startFromEven=!0,Fe.constructResult(this.decodeRow2pairs(w,_))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(w,_){let A=!1;for(;!A;)try{this.pairs.push(this.retrieveNextPair(_,this.pairs,w))}catch(z){if(z instanceof S){if(!this.pairs.length)throw new S;A=!0}}if(this.checkChecksum())return this.pairs;let B;if(this.rows.length?B=!0:B=!1,this.storeRow(w,!1),B){let z=this.checkRowsBoolean(!1);if(z!=null||(z=this.checkRowsBoolean(!0),z!=null))return z}throw new S}checkRowsBoolean(w){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,w&&(this.rows=this.rows.reverse());let _=null;try{_=this.checkRows(new Array,0)}catch(A){this.verbose&&console.log(A)}return w&&(this.rows=this.rows.reverse()),_}checkRows(w,_){for(let A=_;A<this.rows.length;A++){let B=this.rows[A];this.pairs.length=0;for(let K of w)this.pairs.push(K.getPairs());if(this.pairs.push(B.getPairs()),!Fe.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let z=new Array(w);z.push(B);try{return this.checkRows(z,A+1)}catch(K){this.verbose&&console.log(K)}}throw new S}static isValidSequence(w){for(let _ of Fe.FINDER_PATTERN_SEQUENCES){if(w.length>_.length)continue;let A=!0;for(let B=0;B<w.length;B++)if(w[B].getFinderPattern().getValue()!=_[B]){A=!1;break}if(A)return!0}return!1}storeRow(w,_){let A=0,B=!1,z=!1;for(;A<this.rows.length;){let K=this.rows[A];if(K.getRowNumber()>w){z=K.isEquivalent(this.pairs);break}B=K.isEquivalent(this.pairs),A++}z||B||Fe.isPartialRow(this.pairs,this.rows)||(this.rows.push(A,new dt(this.pairs,w,_)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(w,_){for(let A of _)if(A.getPairs().length!==w.length){for(let B of A.getPairs())for(let z of w)if(Xe.equals(B,z))break}}static isPartialRow(w,_){for(let A of _){let B=!0;for(let z of w){let K=!1;for(let Q of A.getPairs())if(z.equals(Q)){K=!0;break}if(!K){B=!1;break}}if(B)return!0}return!1}getRows(){return this.rows}static constructResult(w){let _=ir.buildBitArray(w),B=Ee(_).parseInformation(),z=w[0].getFinderPattern().getResultPoints(),K=w[w.length-1].getFinderPattern().getResultPoints(),Q=[z[0],z[1],K[0],K[1]];return new Z(B,null,null,Q,G.RSS_EXPANDED,null)}checkChecksum(){let w=this.pairs.get(0),_=w.getLeftChar(),A=w.getRightChar();if(A==null)return!1;let B=A.getChecksumPortion(),z=2;for(let Q=1;Q<this.pairs.size();++Q){let te=this.pairs.get(Q);B+=te.getLeftChar().getChecksumPortion(),z++;let ae=te.getRightChar();ae!=null&&(B+=ae.getChecksumPortion(),z++)}return B%=211,211*(z-4)+B==_.getValue()}static getNextSecondBar(w,_){let A;return w.get(_)?(A=w.getNextUnset(_),A=w.getNextSet(A)):(A=w.getNextSet(_),A=w.getNextUnset(A)),A}retrieveNextPair(w,_,A){let B=_.length%2==0;this.startFromEven&&(B=!B);let z,K=!0,Q=-1;do this.findNextPair(w,_,Q),z=this.parseFoundFinderPattern(w,A,B),z==null?Q=Fe.getNextSecondBar(w,this.startEnd[0]):K=!1;while(K);let te=this.decodeDataCharacter(w,z,B,!0);if(!this.isEmptyPair(_)&&_[_.length-1].mustBeLast())throw new S;let ae;try{ae=this.decodeDataCharacter(w,z,B,!1)}catch(me){ae=null,this.verbose&&console.log(me)}return new Xe(te,ae,z,!0)}isEmptyPair(w){return w.length===0}findNextPair(w,_,A){let B=this.getDecodeFinderCounters();B[0]=0,B[1]=0,B[2]=0,B[3]=0;let z=w.getSize(),K;A>=0?K=A:this.isEmptyPair(_)?K=0:K=_[_.length-1].getFinderPattern().getStartEnd()[1];let Q=_.length%2!=0;this.startFromEven&&(Q=!Q);let te=!1;for(;K<z&&(te=!w.get(K),!!te);)K++;let ae=0,me=K;for(let ve=K;ve<z;ve++)if(w.get(ve)!=te)B[ae]++;else{if(ae==3){if(Q&&Fe.reverseCounters(B),Fe.isFinderPattern(B)){this.startEnd[0]=me,this.startEnd[1]=ve;return}Q&&Fe.reverseCounters(B),me+=B[0]+B[1],B[0]=B[2],B[1]=B[3],B[2]=0,B[3]=0,ae--}else ae++;B[ae]=1,te=!te}throw new S}static reverseCounters(w){let _=w.length;for(let A=0;A<_/2;++A){let B=w[A];w[A]=w[_-A-1],w[_-A-1]=B}}parseFoundFinderPattern(w,_,A){let B,z,K;if(A){let ae=this.startEnd[0]-1;for(;ae>=0&&!w.get(ae);)ae--;ae++,B=this.startEnd[0]-ae,z=ae,K=this.startEnd[1]}else z=this.startEnd[0],K=w.getNextUnset(this.startEnd[1]+1),B=K-this.startEnd[1];let Q=this.getDecodeFinderCounters();g.arraycopy(Q,0,Q,1,Q.length-1),Q[0]=B;let te;try{te=this.parseFinderValue(Q,Fe.FINDER_PATTERNS)}catch{return null}return new St(te,[z,K],z,K,_)}decodeDataCharacter(w,_,A,B){let z=this.getDataCharacterCounters();for(let Xn=0;Xn<z.length;Xn++)z[Xn]=0;if(B)Fe.recordPatternInReverse(w,_.getStartEnd()[0],z);else{Fe.recordPattern(w,_.getStartEnd()[1],z);for(let Xn=0,za=z.length-1;Xn<za;Xn++,za--){let no=z[Xn];z[Xn]=z[za],z[za]=no}}let K=17,Q=ge.sum(new Int32Array(z))/K,te=(_.getStartEnd()[1]-_.getStartEnd()[0])/15;if(Math.abs(Q-te)/te>.3)throw new S;let ae=this.getOddCounts(),me=this.getEvenCounts(),ve=this.getOddRoundingErrors(),je=this.getEvenRoundingErrors();for(let Xn=0;Xn<z.length;Xn++){let za=1*z[Xn]/Q,no=za+.5;if(no<1){if(za<.3)throw new S;no=1}else if(no>8){if(za>8.7)throw new S;no=8}let zf=Xn/2;Xn&1?(me[zf]=no,je[zf]=za-no):(ae[zf]=no,ve[zf]=za-no)}this.adjustOddEvenCounts(K);let Oe=4*_.getValue()+(A?0:2)+(B?0:1)-1,Ue=0,He=0;for(let Xn=ae.length-1;Xn>=0;Xn--){if(Fe.isNotA1left(_,A,B)){let za=Fe.WEIGHTS[Oe][2*Xn];He+=ae[Xn]*za}Ue+=ae[Xn]}let nt=0;for(let Xn=me.length-1;Xn>=0;Xn--)if(Fe.isNotA1left(_,A,B)){let za=Fe.WEIGHTS[Oe][2*Xn+1];nt+=me[Xn]*za}let pt=He+nt;if(Ue&1||Ue>13||Ue<4)throw new S;let $t=(13-Ue)/2,Ft=Fe.SYMBOL_WIDEST[$t],Rt=9-Ft,hn=rt.getRSSvalue(ae,Ft,!0),Zr=rt.getRSSvalue(me,Rt,!1),Ii=Fe.EVEN_TOTAL_SUBSET[$t],ol=Fe.GSUM[$t],Di=hn*Ii+Zr+ol;return new Yt(Di,pt)}static isNotA1left(w,_,A){return!(w.getValue()==0&&_&&A)}adjustOddEvenCounts(w){let _=ge.sum(new Int32Array(this.getOddCounts())),A=ge.sum(new Int32Array(this.getEvenCounts())),B=!1,z=!1;_>13?z=!0:_<4&&(B=!0);let K=!1,Q=!1;A>13?Q=!0:A<4&&(K=!0);let te=_+A-w,ae=(_&1)==1,me=(A&1)==0;if(te==1)if(ae){if(me)throw new S;z=!0}else{if(!me)throw new S;Q=!0}else if(te==-1)if(ae){if(me)throw new S;B=!0}else{if(!me)throw new S;K=!0}else if(te==0){if(ae){if(!me)throw new S;_<A?(B=!0,Q=!0):(z=!0,K=!0)}else if(me)throw new S}else throw new S;if(B){if(z)throw new S;Fe.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(z&&Fe.decrement(this.getOddCounts(),this.getOddRoundingErrors()),K){if(Q)throw new S;Fe.increment(this.getEvenCounts(),this.getOddRoundingErrors())}Q&&Fe.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Fe.SYMBOL_WIDEST=[7,5,4,3,1],Fe.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Fe.GSUM=[0,348,1388,2948,3988],Fe.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Fe.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Fe.FINDER_PAT_A=0,Fe.FINDER_PAT_B=1,Fe.FINDER_PAT_C=2,Fe.FINDER_PAT_D=3,Fe.FINDER_PAT_E=4,Fe.FINDER_PAT_F=5,Fe.FINDER_PATTERN_SEQUENCES=[[Fe.FINDER_PAT_A,Fe.FINDER_PAT_A],[Fe.FINDER_PAT_A,Fe.FINDER_PAT_B,Fe.FINDER_PAT_B],[Fe.FINDER_PAT_A,Fe.FINDER_PAT_C,Fe.FINDER_PAT_B,Fe.FINDER_PAT_D],[Fe.FINDER_PAT_A,Fe.FINDER_PAT_E,Fe.FINDER_PAT_B,Fe.FINDER_PAT_D,Fe.FINDER_PAT_C],[Fe.FINDER_PAT_A,Fe.FINDER_PAT_E,Fe.FINDER_PAT_B,Fe.FINDER_PAT_D,Fe.FINDER_PAT_D,Fe.FINDER_PAT_F],[Fe.FINDER_PAT_A,Fe.FINDER_PAT_E,Fe.FINDER_PAT_B,Fe.FINDER_PAT_D,Fe.FINDER_PAT_E,Fe.FINDER_PAT_F,Fe.FINDER_PAT_F],[Fe.FINDER_PAT_A,Fe.FINDER_PAT_A,Fe.FINDER_PAT_B,Fe.FINDER_PAT_B,Fe.FINDER_PAT_C,Fe.FINDER_PAT_C,Fe.FINDER_PAT_D,Fe.FINDER_PAT_D],[Fe.FINDER_PAT_A,Fe.FINDER_PAT_A,Fe.FINDER_PAT_B,Fe.FINDER_PAT_B,Fe.FINDER_PAT_C,Fe.FINDER_PAT_C,Fe.FINDER_PAT_D,Fe.FINDER_PAT_E,Fe.FINDER_PAT_E],[Fe.FINDER_PAT_A,Fe.FINDER_PAT_A,Fe.FINDER_PAT_B,Fe.FINDER_PAT_B,Fe.FINDER_PAT_C,Fe.FINDER_PAT_C,Fe.FINDER_PAT_D,Fe.FINDER_PAT_E,Fe.FINDER_PAT_F,Fe.FINDER_PAT_F],[Fe.FINDER_PAT_A,Fe.FINDER_PAT_A,Fe.FINDER_PAT_B,Fe.FINDER_PAT_B,Fe.FINDER_PAT_C,Fe.FINDER_PAT_D,Fe.FINDER_PAT_D,Fe.FINDER_PAT_E,Fe.FINDER_PAT_E,Fe.FINDER_PAT_F,Fe.FINDER_PAT_F]],Fe.MAX_PAIRS=11;class Zt extends Yt{constructor(w,_,A){super(w,_),this.count=0,this.finderPattern=A}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class wt extends gt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(w,_,A){const B=this.decodePair(_,!1,w,A);wt.addOrTally(this.possibleLeftPairs,B),_.reverse();let z=this.decodePair(_,!0,w,A);wt.addOrTally(this.possibleRightPairs,z),_.reverse();for(let K of this.possibleLeftPairs)if(K.getCount()>1){for(let Q of this.possibleRightPairs)if(Q.getCount()>1&&wt.checkChecksum(K,Q))return wt.constructResult(K,Q)}throw new S}static addOrTally(w,_){if(_==null)return;let A=!1;for(let B of w)if(B.getValue()===_.getValue()){B.incrementCount(),A=!0;break}A||w.push(_)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(w,_){let A=4537077*w.getValue()+_.getValue(),B=new String(A).toString(),z=new M;for(let ae=13-B.length;ae>0;ae--)z.append("0");z.append(B);let K=0;for(let ae=0;ae<13;ae++){let me=z.charAt(ae).charCodeAt(0)-48;K+=ae&1?me:3*me}K=10-K%10,K===10&&(K=0),z.append(K.toString());let Q=w.getFinderPattern().getResultPoints(),te=_.getFinderPattern().getResultPoints();return new Z(z.toString(),null,0,[Q[0],Q[1],te[0],te[1]],G.RSS_14,new Date().getTime())}static checkChecksum(w,_){let A=(w.getChecksumPortion()+16*_.getChecksumPortion())%79,B=9*w.getFinderPattern().getValue()+_.getFinderPattern().getValue();return B>72&&B--,B>8&&B--,A===B}decodePair(w,_,A,B){try{let z=this.findFinderPattern(w,_),K=this.parseFoundFinderPattern(w,A,_,z),Q=B==null?null:B.get(O.NEED_RESULT_POINT_CALLBACK);if(Q!=null){let me=(z[0]+z[1])/2;_&&(me=w.getSize()-1-me),Q.foundPossibleResultPoint(new _e(me,A))}let te=this.decodeDataCharacter(w,K,!0),ae=this.decodeDataCharacter(w,K,!1);return new Zt(1597*te.getValue()+ae.getValue(),te.getChecksumPortion()+4*ae.getChecksumPortion(),K)}catch{return null}}decodeDataCharacter(w,_,A){let B=this.getDataCharacterCounters();for(let nt=0;nt<B.length;nt++)B[nt]=0;if(A)Je.recordPatternInReverse(w,_.getStartEnd()[0],B);else{Je.recordPattern(w,_.getStartEnd()[1]+1,B);for(let nt=0,pt=B.length-1;nt<pt;nt++,pt--){let $t=B[nt];B[nt]=B[pt],B[pt]=$t}}let z=A?16:15,K=ge.sum(new Int32Array(B))/z,Q=this.getOddCounts(),te=this.getEvenCounts(),ae=this.getOddRoundingErrors(),me=this.getEvenRoundingErrors();for(let nt=0;nt<B.length;nt++){let pt=B[nt]/K,$t=Math.floor(pt+.5);$t<1?$t=1:$t>8&&($t=8);let Ft=Math.floor(nt/2);nt&1?(te[Ft]=$t,me[Ft]=pt-$t):(Q[Ft]=$t,ae[Ft]=pt-$t)}this.adjustOddEvenCounts(A,z);let ve=0,je=0;for(let nt=Q.length-1;nt>=0;nt--)je*=9,je+=Q[nt],ve+=Q[nt];let Oe=0,Ue=0;for(let nt=te.length-1;nt>=0;nt--)Oe*=9,Oe+=te[nt],Ue+=te[nt];let He=je+3*Oe;if(A){if(ve&1||ve>12||ve<4)throw new S;let nt=(12-ve)/2,pt=wt.OUTSIDE_ODD_WIDEST[nt],$t=9-pt,Ft=rt.getRSSvalue(Q,pt,!1),Rt=rt.getRSSvalue(te,$t,!0),hn=wt.OUTSIDE_EVEN_TOTAL_SUBSET[nt],Zr=wt.OUTSIDE_GSUM[nt];return new Yt(Ft*hn+Rt+Zr,He)}else{if(Ue&1||Ue>10||Ue<4)throw new S;let nt=(10-Ue)/2,pt=wt.INSIDE_ODD_WIDEST[nt],$t=9-pt,Ft=rt.getRSSvalue(Q,pt,!0),Rt=rt.getRSSvalue(te,$t,!1),hn=wt.INSIDE_ODD_TOTAL_SUBSET[nt],Zr=wt.INSIDE_GSUM[nt];return new Yt(Rt*hn+Ft+Zr,He)}}findFinderPattern(w,_){let A=this.getDecodeFinderCounters();A[0]=0,A[1]=0,A[2]=0,A[3]=0;let B=w.getSize(),z=!1,K=0;for(;K<B&&(z=!w.get(K),_!==z);)K++;let Q=0,te=K;for(let ae=K;ae<B;ae++)if(w.get(ae)!==z)A[Q]++;else{if(Q===3){if(gt.isFinderPattern(A))return[te,ae];te+=A[0]+A[1],A[0]=A[2],A[1]=A[3],A[2]=0,A[3]=0,Q--}else Q++;A[Q]=1,z=!z}throw new S}parseFoundFinderPattern(w,_,A,B){let z=w.get(B[0]),K=B[0]-1;for(;K>=0&&z!==w.get(K);)K--;K++;const Q=B[0]-K,te=this.getDecodeFinderCounters(),ae=new Int32Array(te.length);g.arraycopy(te,0,ae,1,te.length-1),ae[0]=Q;const me=this.parseFinderValue(ae,wt.FINDER_PATTERNS);let ve=K,je=B[1];return A&&(ve=w.getSize()-1-ve,je=w.getSize()-1-je),new St(me,[K,B[1]],ve,je,_)}adjustOddEvenCounts(w,_){let A=ge.sum(new Int32Array(this.getOddCounts())),B=ge.sum(new Int32Array(this.getEvenCounts())),z=!1,K=!1,Q=!1,te=!1;w?(A>12?K=!0:A<4&&(z=!0),B>12?te=!0:B<4&&(Q=!0)):(A>11?K=!0:A<5&&(z=!0),B>10?te=!0:B<4&&(Q=!0));let ae=A+B-_,me=(A&1)===(w?1:0),ve=(B&1)===1;if(ae===1)if(me){if(ve)throw new S;K=!0}else{if(!ve)throw new S;te=!0}else if(ae===-1)if(me){if(ve)throw new S;z=!0}else{if(!ve)throw new S;Q=!0}else if(ae===0){if(me){if(!ve)throw new S;A<B?(z=!0,te=!0):(K=!0,Q=!0)}else if(ve)throw new S}else throw new S;if(z){if(K)throw new S;gt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(K&&gt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),Q){if(te)throw new S;gt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}te&&gt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}wt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],wt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],wt.OUTSIDE_GSUM=[0,161,961,2015,2715],wt.INSIDE_GSUM=[0,336,1036,1516],wt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],wt.INSIDE_ODD_WIDEST=[2,4,6,8],wt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Et extends Je{constructor(w,_){super(),this.readers=[],this.verbose=_===!0;const A=w?w.get(O.POSSIBLE_FORMATS):null,B=w&&w.get(O.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;A?((A.includes(G.EAN_13)||A.includes(G.UPC_A)||A.includes(G.EAN_8)||A.includes(G.UPC_E))&&this.readers.push(new at(w)),A.includes(G.CODE_39)&&this.readers.push(new Ge(B)),A.includes(G.CODE_128)&&this.readers.push(new Ce),A.includes(G.ITF)&&this.readers.push(new Pe),A.includes(G.RSS_14)&&this.readers.push(new wt),A.includes(G.RSS_EXPANDED)&&this.readers.push(new Fe(this.verbose))):(this.readers.push(new at(w)),this.readers.push(new Ge),this.readers.push(new at(w)),this.readers.push(new Ce),this.readers.push(new Pe),this.readers.push(new wt),this.readers.push(new Fe(this.verbose)))}decodeRow(w,_,A){for(let B=0;B<this.readers.length;B++)try{return this.readers[B].decodeRow(w,_,A)}catch{}throw new S}reset(){this.readers.forEach(w=>w.reset())}}class kr extends Y{constructor(w=500,_){super(new Et(_),w,_)}}class Jt{constructor(w,_,A){this.ecCodewords=w,this.ecBlocks=[_],A&&this.ecBlocks.push(A)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class tr{constructor(w,_){this.count=w,this.dataCodewords=_}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class zt{constructor(w,_,A,B,z,K){this.versionNumber=w,this.symbolSizeRows=_,this.symbolSizeColumns=A,this.dataRegionSizeRows=B,this.dataRegionSizeColumns=z,this.ecBlocks=K;let Q=0;const te=K.getECCodewords(),ae=K.getECBlocks();for(let me of ae)Q+=me.getCount()*(me.getDataCodewords()+te);this.totalCodewords=Q}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(w,_){if(w&1||_&1)throw new R;for(let A of zt.VERSIONS)if(A.symbolSizeRows===w&&A.symbolSizeColumns===_)return A;throw new R}toString(){return""+this.versionNumber}static buildVersions(){return[new zt(1,10,10,8,8,new Jt(5,new tr(1,3))),new zt(2,12,12,10,10,new Jt(7,new tr(1,5))),new zt(3,14,14,12,12,new Jt(10,new tr(1,8))),new zt(4,16,16,14,14,new Jt(12,new tr(1,12))),new zt(5,18,18,16,16,new Jt(14,new tr(1,18))),new zt(6,20,20,18,18,new Jt(18,new tr(1,22))),new zt(7,22,22,20,20,new Jt(20,new tr(1,30))),new zt(8,24,24,22,22,new Jt(24,new tr(1,36))),new zt(9,26,26,24,24,new Jt(28,new tr(1,44))),new zt(10,32,32,14,14,new Jt(36,new tr(1,62))),new zt(11,36,36,16,16,new Jt(42,new tr(1,86))),new zt(12,40,40,18,18,new Jt(48,new tr(1,114))),new zt(13,44,44,20,20,new Jt(56,new tr(1,144))),new zt(14,48,48,22,22,new Jt(68,new tr(1,174))),new zt(15,52,52,24,24,new Jt(42,new tr(2,102))),new zt(16,64,64,14,14,new Jt(56,new tr(2,140))),new zt(17,72,72,16,16,new Jt(36,new tr(4,92))),new zt(18,80,80,18,18,new Jt(48,new tr(4,114))),new zt(19,88,88,20,20,new Jt(56,new tr(4,144))),new zt(20,96,96,22,22,new Jt(68,new tr(4,174))),new zt(21,104,104,24,24,new Jt(56,new tr(6,136))),new zt(22,120,120,18,18,new Jt(68,new tr(6,175))),new zt(23,132,132,20,20,new Jt(62,new tr(8,163))),new zt(24,144,144,22,22,new Jt(62,new tr(8,156),new tr(2,155))),new zt(25,8,18,6,16,new Jt(7,new tr(1,5))),new zt(26,8,32,6,14,new Jt(11,new tr(1,10))),new zt(27,12,26,10,24,new Jt(14,new tr(1,16))),new zt(28,12,36,10,16,new Jt(18,new tr(1,22))),new zt(29,16,36,14,16,new Jt(24,new tr(1,32))),new zt(30,16,48,14,22,new Jt(28,new tr(1,49)))]}}zt.VERSIONS=zt.buildVersions();class vn{constructor(w){const _=w.getHeight();if(_<8||_>144||_&1)throw new R;this.version=vn.readVersion(w),this.mappingBitMatrix=this.extractDataRegion(w),this.readMappingMatrix=new F(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(w){const _=w.getHeight(),A=w.getWidth();return zt.getVersionForDimensions(_,A)}readCodewords(){const w=new Int8Array(this.version.getTotalCodewords());let _=0,A=4,B=0;const z=this.mappingBitMatrix.getHeight(),K=this.mappingBitMatrix.getWidth();let Q=!1,te=!1,ae=!1,me=!1;do if(A===z&&B===0&&!Q)w[_++]=this.readCorner1(z,K)&255,A-=2,B+=2,Q=!0;else if(A===z-2&&B===0&&K&3&&!te)w[_++]=this.readCorner2(z,K)&255,A-=2,B+=2,te=!0;else if(A===z+4&&B===2&&!(K&7)&&!ae)w[_++]=this.readCorner3(z,K)&255,A-=2,B+=2,ae=!0;else if(A===z-2&&B===0&&(K&7)===4&&!me)w[_++]=this.readCorner4(z,K)&255,A-=2,B+=2,me=!0;else{do A<z&&B>=0&&!this.readMappingMatrix.get(B,A)&&(w[_++]=this.readUtah(A,B,z,K)&255),A-=2,B+=2;while(A>=0&&B<K);A+=1,B+=3;do A>=0&&B<K&&!this.readMappingMatrix.get(B,A)&&(w[_++]=this.readUtah(A,B,z,K)&255),A+=2,B-=2;while(A<z&&B>=0);A+=3,B+=1}while(A<z||B<K);if(_!==this.version.getTotalCodewords())throw new R;return w}readModule(w,_,A,B){return w<0&&(w+=A,_+=4-(A+4&7)),_<0&&(_+=B,w+=4-(B+4&7)),this.readMappingMatrix.set(_,w),this.mappingBitMatrix.get(_,w)}readUtah(w,_,A,B){let z=0;return this.readModule(w-2,_-2,A,B)&&(z|=1),z<<=1,this.readModule(w-2,_-1,A,B)&&(z|=1),z<<=1,this.readModule(w-1,_-2,A,B)&&(z|=1),z<<=1,this.readModule(w-1,_-1,A,B)&&(z|=1),z<<=1,this.readModule(w-1,_,A,B)&&(z|=1),z<<=1,this.readModule(w,_-2,A,B)&&(z|=1),z<<=1,this.readModule(w,_-1,A,B)&&(z|=1),z<<=1,this.readModule(w,_,A,B)&&(z|=1),z}readCorner1(w,_){let A=0;return this.readModule(w-1,0,w,_)&&(A|=1),A<<=1,this.readModule(w-1,1,w,_)&&(A|=1),A<<=1,this.readModule(w-1,2,w,_)&&(A|=1),A<<=1,this.readModule(0,_-2,w,_)&&(A|=1),A<<=1,this.readModule(0,_-1,w,_)&&(A|=1),A<<=1,this.readModule(1,_-1,w,_)&&(A|=1),A<<=1,this.readModule(2,_-1,w,_)&&(A|=1),A<<=1,this.readModule(3,_-1,w,_)&&(A|=1),A}readCorner2(w,_){let A=0;return this.readModule(w-3,0,w,_)&&(A|=1),A<<=1,this.readModule(w-2,0,w,_)&&(A|=1),A<<=1,this.readModule(w-1,0,w,_)&&(A|=1),A<<=1,this.readModule(0,_-4,w,_)&&(A|=1),A<<=1,this.readModule(0,_-3,w,_)&&(A|=1),A<<=1,this.readModule(0,_-2,w,_)&&(A|=1),A<<=1,this.readModule(0,_-1,w,_)&&(A|=1),A<<=1,this.readModule(1,_-1,w,_)&&(A|=1),A}readCorner3(w,_){let A=0;return this.readModule(w-1,0,w,_)&&(A|=1),A<<=1,this.readModule(w-1,_-1,w,_)&&(A|=1),A<<=1,this.readModule(0,_-3,w,_)&&(A|=1),A<<=1,this.readModule(0,_-2,w,_)&&(A|=1),A<<=1,this.readModule(0,_-1,w,_)&&(A|=1),A<<=1,this.readModule(1,_-3,w,_)&&(A|=1),A<<=1,this.readModule(1,_-2,w,_)&&(A|=1),A<<=1,this.readModule(1,_-1,w,_)&&(A|=1),A}readCorner4(w,_){let A=0;return this.readModule(w-3,0,w,_)&&(A|=1),A<<=1,this.readModule(w-2,0,w,_)&&(A|=1),A<<=1,this.readModule(w-1,0,w,_)&&(A|=1),A<<=1,this.readModule(0,_-2,w,_)&&(A|=1),A<<=1,this.readModule(0,_-1,w,_)&&(A|=1),A<<=1,this.readModule(1,_-1,w,_)&&(A|=1),A<<=1,this.readModule(2,_-1,w,_)&&(A|=1),A<<=1,this.readModule(3,_-1,w,_)&&(A|=1),A}extractDataRegion(w){const _=this.version.getSymbolSizeRows(),A=this.version.getSymbolSizeColumns();if(w.getHeight()!==_)throw new h("Dimension of bitMatrix must match the version size");const B=this.version.getDataRegionSizeRows(),z=this.version.getDataRegionSizeColumns(),K=_/B|0,Q=A/z|0,te=K*B,ae=Q*z,me=new F(ae,te);for(let ve=0;ve<K;++ve){const je=ve*B;for(let Oe=0;Oe<Q;++Oe){const Ue=Oe*z;for(let He=0;He<B;++He){const nt=ve*(B+2)+1+He,pt=je+He;for(let $t=0;$t<z;++$t){const Ft=Oe*(z+2)+1+$t;if(w.get(Ft,nt)){const Rt=Ue+$t;me.set(Rt,pt)}}}}}return me}}class yn{constructor(w,_){this.numDataCodewords=w,this.codewords=_}static getDataBlocks(w,_){const A=_.getECBlocks();let B=0;const z=A.getECBlocks();for(let He of z)B+=He.getCount();const K=new Array(B);let Q=0;for(let He of z)for(let nt=0;nt<He.getCount();nt++){const pt=He.getDataCodewords(),$t=A.getECCodewords()+pt;K[Q++]=new yn(pt,new Uint8Array($t))}const ae=K[0].codewords.length-A.getECCodewords(),me=ae-1;let ve=0;for(let He=0;He<me;He++)for(let nt=0;nt<Q;nt++)K[nt].codewords[He]=w[ve++];const je=_.getVersionNumber()===24,Oe=je?8:Q;for(let He=0;He<Oe;He++)K[He].codewords[ae-1]=w[ve++];const Ue=K[0].codewords.length;for(let He=ae;He<Ue;He++)for(let nt=0;nt<Q;nt++){const pt=je?(nt+8)%Q:nt,$t=je&&pt>7?He-1:He;K[pt].codewords[$t]=w[ve++]}if(ve!==w.length)throw new h;return K}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class wn{constructor(w){this.bytes=w,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(w){if(w<1||w>32||w>this.available())throw new h(""+w);let _=0,A=this.bitOffset,B=this.byteOffset;const z=this.bytes;if(A>0){const K=8-A,Q=w<K?w:K,te=K-Q,ae=255>>8-Q<<te;_=(z[B]&ae)>>te,w-=Q,A+=Q,A===8&&(A=0,B++)}if(w>0){for(;w>=8;)_=_<<8|z[B]&255,B++,w-=8;if(w>0){const K=8-w,Q=255>>K<<K;_=_<<w|(z[B]&Q)>>K,A+=w}}return this.bitOffset=A,this.byteOffset=B,_}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Hr;(function(xe){xe[xe.PAD_ENCODE=0]="PAD_ENCODE",xe[xe.ASCII_ENCODE=1]="ASCII_ENCODE",xe[xe.C40_ENCODE=2]="C40_ENCODE",xe[xe.TEXT_ENCODE=3]="TEXT_ENCODE",xe[xe.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",xe[xe.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",xe[xe.BASE256_ENCODE=6]="BASE256_ENCODE"})(Hr||(Hr={}));class Gn{static decode(w){const _=new wn(w),A=new M,B=new M,z=new Array;let K=Hr.ASCII_ENCODE;do if(K===Hr.ASCII_ENCODE)K=this.decodeAsciiSegment(_,A,B);else{switch(K){case Hr.C40_ENCODE:this.decodeC40Segment(_,A);break;case Hr.TEXT_ENCODE:this.decodeTextSegment(_,A);break;case Hr.ANSIX12_ENCODE:this.decodeAnsiX12Segment(_,A);break;case Hr.EDIFACT_ENCODE:this.decodeEdifactSegment(_,A);break;case Hr.BASE256_ENCODE:this.decodeBase256Segment(_,A,z);break;default:throw new R}K=Hr.ASCII_ENCODE}while(K!==Hr.PAD_ENCODE&&_.available()>0);return B.length()>0&&A.append(B.toString()),new W(w,A.toString(),z.length===0?null:z,null)}static decodeAsciiSegment(w,_,A){let B=!1;do{let z=w.readBits(8);if(z===0)throw new R;if(z<=128)return B&&(z+=128),_.append(String.fromCharCode(z-1)),Hr.ASCII_ENCODE;if(z===129)return Hr.PAD_ENCODE;if(z<=229){const K=z-130;K<10&&_.append("0"),_.append(""+K)}else switch(z){case 230:return Hr.C40_ENCODE;case 231:return Hr.BASE256_ENCODE;case 232:_.append("");break;case 233:case 234:break;case 235:B=!0;break;case 236:_.append("[)>05"),A.insert(0,"");break;case 237:_.append("[)>06"),A.insert(0,"");break;case 238:return Hr.ANSIX12_ENCODE;case 239:return Hr.TEXT_ENCODE;case 240:return Hr.EDIFACT_ENCODE;case 241:break;default:if(z!==254||w.available()!==0)throw new R;break}}while(w.available()>0);return Hr.ASCII_ENCODE}static decodeC40Segment(w,_){let A=!1;const B=[];let z=0;do{if(w.available()===8)return;const K=w.readBits(8);if(K===254)return;this.parseTwoBytes(K,w.readBits(8),B);for(let Q=0;Q<3;Q++){const te=B[Q];switch(z){case 0:if(te<3)z=te+1;else if(te<this.C40_BASIC_SET_CHARS.length){const ae=this.C40_BASIC_SET_CHARS[te];A?(_.append(String.fromCharCode(ae.charCodeAt(0)+128)),A=!1):_.append(ae)}else throw new R;break;case 1:A?(_.append(String.fromCharCode(te+128)),A=!1):_.append(String.fromCharCode(te)),z=0;break;case 2:if(te<this.C40_SHIFT2_SET_CHARS.length){const ae=this.C40_SHIFT2_SET_CHARS[te];A?(_.append(String.fromCharCode(ae.charCodeAt(0)+128)),A=!1):_.append(ae)}else switch(te){case 27:_.append("");break;case 30:A=!0;break;default:throw new R}z=0;break;case 3:A?(_.append(String.fromCharCode(te+224)),A=!1):_.append(String.fromCharCode(te+96)),z=0;break;default:throw new R}}}while(w.available()>0)}static decodeTextSegment(w,_){let A=!1,B=[],z=0;do{if(w.available()===8)return;const K=w.readBits(8);if(K===254)return;this.parseTwoBytes(K,w.readBits(8),B);for(let Q=0;Q<3;Q++){const te=B[Q];switch(z){case 0:if(te<3)z=te+1;else if(te<this.TEXT_BASIC_SET_CHARS.length){const ae=this.TEXT_BASIC_SET_CHARS[te];A?(_.append(String.fromCharCode(ae.charCodeAt(0)+128)),A=!1):_.append(ae)}else throw new R;break;case 1:A?(_.append(String.fromCharCode(te+128)),A=!1):_.append(String.fromCharCode(te)),z=0;break;case 2:if(te<this.TEXT_SHIFT2_SET_CHARS.length){const ae=this.TEXT_SHIFT2_SET_CHARS[te];A?(_.append(String.fromCharCode(ae.charCodeAt(0)+128)),A=!1):_.append(ae)}else switch(te){case 27:_.append("");break;case 30:A=!0;break;default:throw new R}z=0;break;case 3:if(te<this.TEXT_SHIFT3_SET_CHARS.length){const ae=this.TEXT_SHIFT3_SET_CHARS[te];A?(_.append(String.fromCharCode(ae.charCodeAt(0)+128)),A=!1):_.append(ae),z=0}else throw new R;break;default:throw new R}}}while(w.available()>0)}static decodeAnsiX12Segment(w,_){const A=[];do{if(w.available()===8)return;const B=w.readBits(8);if(B===254)return;this.parseTwoBytes(B,w.readBits(8),A);for(let z=0;z<3;z++){const K=A[z];switch(K){case 0:_.append("\r");break;case 1:_.append("*");break;case 2:_.append(">");break;case 3:_.append(" ");break;default:if(K<14)_.append(String.fromCharCode(K+44));else if(K<40)_.append(String.fromCharCode(K+51));else throw new R;break}}}while(w.available()>0)}static parseTwoBytes(w,_,A){let B=(w<<8)+_-1,z=Math.floor(B/1600);A[0]=z,B-=z*1600,z=Math.floor(B/40),A[1]=z,A[2]=B-z*40}static decodeEdifactSegment(w,_){do{if(w.available()<=16)return;for(let A=0;A<4;A++){let B=w.readBits(6);if(B===31){const z=8-w.getBitOffset();z!==8&&w.readBits(z);return}B&32||(B|=64),_.append(String.fromCharCode(B))}}while(w.available()>0)}static decodeBase256Segment(w,_,A){let B=1+w.getByteOffset();const z=this.unrandomize255State(w.readBits(8),B++);let K;if(z===0?K=w.available()/8|0:z<250?K=z:K=250*(z-249)+this.unrandomize255State(w.readBits(8),B++),K<0)throw new R;const Q=new Uint8Array(K);for(let te=0;te<K;te++){if(w.available()<8)throw new R;Q[te]=this.unrandomize255State(w.readBits(8),B++)}A.push(Q);try{_.append(X.decode(Q,H.ISO88591))}catch(te){throw new ye("Platform does not support required encoding: "+te.message)}}static unrandomize255State(w,_){const A=149*_%255+1,B=w-A;return B>=0?B:B+256}}Gn.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Gn.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Gn.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Gn.TEXT_SHIFT2_SET_CHARS=Gn.C40_SHIFT2_SET_CHARS,Gn.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Ba{constructor(){this.rsDecoder=new ue(se.DATA_MATRIX_FIELD_256)}decode(w){const _=new vn(w),A=_.getVersion(),B=_.readCodewords(),z=yn.getDataBlocks(B,A);let K=0;for(let ae of z)K+=ae.getNumDataCodewords();const Q=new Uint8Array(K),te=z.length;for(let ae=0;ae<te;ae++){const me=z[ae],ve=me.getCodewords(),je=me.getNumDataCodewords();this.correctErrors(ve,je);for(let Oe=0;Oe<je;Oe++)Q[Oe*te+ae]=ve[Oe]}return Gn.decode(Q)}correctErrors(w,_){const A=new Int32Array(w);try{this.rsDecoder.decode(A,w.length-_)}catch{throw new m}for(let B=0;B<_;B++)w[B]=A[B]}}class _n{constructor(w){this.image=w,this.rectangleDetector=new Se(this.image)}detect(){const w=this.rectangleDetector.detect();let _=this.detectSolid1(w);if(_=this.detectSolid2(_),_[3]=this.correctTopRight(_),!_[3])throw new S;_=this.shiftToModuleCenter(_);const A=_[0],B=_[1],z=_[2],K=_[3];let Q=this.transitionsBetween(A,K)+1,te=this.transitionsBetween(z,K)+1;(Q&1)===1&&(Q+=1),(te&1)===1&&(te+=1),4*Q<7*te&&4*te<7*Q&&(Q=te=Math.max(Q,te));let ae=_n.sampleGrid(this.image,A,B,z,K,Q,te);return new be(ae,[A,B,z,K])}static shiftPoint(w,_,A){let B=(_.getX()-w.getX())/(A+1),z=(_.getY()-w.getY())/(A+1);return new _e(w.getX()+B,w.getY()+z)}static moveAway(w,_,A){let B=w.getX(),z=w.getY();return B<_?B-=1:B+=1,z<A?z-=1:z+=1,new _e(B,z)}detectSolid1(w){let _=w[0],A=w[1],B=w[3],z=w[2],K=this.transitionsBetween(_,A),Q=this.transitionsBetween(A,B),te=this.transitionsBetween(B,z),ae=this.transitionsBetween(z,_),me=K,ve=[z,_,A,B];return me>Q&&(me=Q,ve[0]=_,ve[1]=A,ve[2]=B,ve[3]=z),me>te&&(me=te,ve[0]=A,ve[1]=B,ve[2]=z,ve[3]=_),me>ae&&(ve[0]=B,ve[1]=z,ve[2]=_,ve[3]=A),ve}detectSolid2(w){let _=w[0],A=w[1],B=w[2],z=w[3],K=this.transitionsBetween(_,z),Q=_n.shiftPoint(A,B,(K+1)*4),te=_n.shiftPoint(B,A,(K+1)*4),ae=this.transitionsBetween(Q,_),me=this.transitionsBetween(te,z);return ae<me?(w[0]=_,w[1]=A,w[2]=B,w[3]=z):(w[0]=A,w[1]=B,w[2]=z,w[3]=_),w}correctTopRight(w){let _=w[0],A=w[1],B=w[2],z=w[3],K=this.transitionsBetween(_,z),Q=this.transitionsBetween(A,z),te=_n.shiftPoint(_,A,(Q+1)*4),ae=_n.shiftPoint(B,A,(K+1)*4);K=this.transitionsBetween(te,z),Q=this.transitionsBetween(ae,z);let me=new _e(z.getX()+(B.getX()-A.getX())/(K+1),z.getY()+(B.getY()-A.getY())/(K+1)),ve=new _e(z.getX()+(_.getX()-A.getX())/(Q+1),z.getY()+(_.getY()-A.getY())/(Q+1));if(!this.isValid(me))return this.isValid(ve)?ve:null;if(!this.isValid(ve))return me;let je=this.transitionsBetween(te,me)+this.transitionsBetween(ae,me),Oe=this.transitionsBetween(te,ve)+this.transitionsBetween(ae,ve);return je>Oe?me:ve}shiftToModuleCenter(w){let _=w[0],A=w[1],B=w[2],z=w[3],K=this.transitionsBetween(_,z)+1,Q=this.transitionsBetween(B,z)+1,te=_n.shiftPoint(_,A,Q*4),ae=_n.shiftPoint(B,A,K*4);K=this.transitionsBetween(te,z)+1,Q=this.transitionsBetween(ae,z)+1,(K&1)===1&&(K+=1),(Q&1)===1&&(Q+=1);let me=(_.getX()+A.getX()+B.getX()+z.getX())/4,ve=(_.getY()+A.getY()+B.getY()+z.getY())/4;_=_n.moveAway(_,me,ve),A=_n.moveAway(A,me,ve),B=_n.moveAway(B,me,ve),z=_n.moveAway(z,me,ve);let je,Oe;return te=_n.shiftPoint(_,A,Q*4),te=_n.shiftPoint(te,z,K*4),je=_n.shiftPoint(A,_,Q*4),je=_n.shiftPoint(je,B,K*4),ae=_n.shiftPoint(B,z,Q*4),ae=_n.shiftPoint(ae,A,K*4),Oe=_n.shiftPoint(z,B,Q*4),Oe=_n.shiftPoint(Oe,_,K*4),[te,je,ae,Oe]}isValid(w){return w.getX()>=0&&w.getX()<this.image.getWidth()&&w.getY()>0&&w.getY()<this.image.getHeight()}static sampleGrid(w,_,A,B,z,K,Q){return it.getInstance().sampleGrid(w,K,Q,.5,.5,K-.5,.5,K-.5,Q-.5,.5,Q-.5,_.getX(),_.getY(),z.getX(),z.getY(),B.getX(),B.getY(),A.getX(),A.getY())}transitionsBetween(w,_){let A=Math.trunc(w.getX()),B=Math.trunc(w.getY()),z=Math.trunc(_.getX()),K=Math.trunc(_.getY()),Q=Math.abs(K-B)>Math.abs(z-A);if(Q){let He=A;A=B,B=He,He=z,z=K,K=He}let te=Math.abs(z-A),ae=Math.abs(K-B),me=-te/2,ve=B<K?1:-1,je=A<z?1:-1,Oe=0,Ue=this.image.get(Q?B:A,Q?A:B);for(let He=A,nt=B;He!==z;He+=je){let pt=this.image.get(Q?nt:He,Q?He:nt);if(pt!==Ue&&(Oe++,Ue=pt),me+=ae,me>0){if(nt===K)break;nt+=ve,me-=te}}return Oe}}class Ja{constructor(){this.decoder=new Ba}decode(w,_=null){let A,B;if(_!=null&&_.has(O.PURE_BARCODE)){const ae=Ja.extractPureBits(w.getBlackMatrix());A=this.decoder.decode(ae),B=Ja.NO_POINTS}else{const ae=new _n(w.getBlackMatrix()).detect();A=this.decoder.decode(ae.getBits()),B=ae.getPoints()}const z=A.getRawBytes(),K=new Z(A.getText(),z,8*z.length,B,G.DATA_MATRIX,g.currentTimeMillis()),Q=A.getByteSegments();Q!=null&&K.putMetadata(V.BYTE_SEGMENTS,Q);const te=A.getECLevel();return te!=null&&K.putMetadata(V.ERROR_CORRECTION_LEVEL,te),K}reset(){}static extractPureBits(w){const _=w.getTopLeftOnBit(),A=w.getBottomRightOnBit();if(_==null||A==null)throw new S;const B=this.moduleSize(_,w);let z=_[1];const K=A[1];let Q=_[0];const ae=(A[0]-Q+1)/B,me=(K-z+1)/B;if(ae<=0||me<=0)throw new S;const ve=B/2;z+=ve,Q+=ve;const je=new F(ae,me);for(let Oe=0;Oe<me;Oe++){const Ue=z+Oe*B;for(let He=0;He<ae;He++)w.get(Q+He*B,Ue)&&je.set(He,Oe)}return je}static moduleSize(w,_){const A=_.getWidth();let B=w[0];const z=w[1];for(;B<A&&_.get(B,z);)B++;if(B===A)throw new S;const K=B-w[0];if(K===0)throw new S;return K}}Ja.NO_POINTS=[];class kd extends Y{constructor(w=500){super(new Ja,w)}}var to;(function(xe){xe[xe.L=0]="L",xe[xe.M=1]="M",xe[xe.Q=2]="Q",xe[xe.H=3]="H"})(to||(to={}));class jn{constructor(w,_,A){this.value=w,this.stringValue=_,this.bits=A,jn.FOR_BITS.set(A,this),jn.FOR_VALUE.set(w,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(w){switch(w){case"L":return jn.L;case"M":return jn.M;case"Q":return jn.Q;case"H":return jn.H;default:throw new u(w+"not available")}}toString(){return this.stringValue}equals(w){if(!(w instanceof jn))return!1;const _=w;return this.value===_.value}static forBits(w){if(w<0||w>=jn.FOR_BITS.size)throw new h;return jn.FOR_BITS.get(w)}}jn.FOR_BITS=new Map,jn.FOR_VALUE=new Map,jn.L=new jn(to.L,"L",1),jn.M=new jn(to.M,"M",0),jn.Q=new jn(to.Q,"Q",3),jn.H=new jn(to.H,"H",2);class Fr{constructor(w){this.errorCorrectionLevel=jn.forBits(w>>3&3),this.dataMask=w&7}static numBitsDiffering(w,_){return b.bitCount(w^_)}static decodeFormatInformation(w,_){const A=Fr.doDecodeFormatInformation(w,_);return A!==null?A:Fr.doDecodeFormatInformation(w^Fr.FORMAT_INFO_MASK_QR,_^Fr.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(w,_){let A=Number.MAX_SAFE_INTEGER,B=0;for(const z of Fr.FORMAT_INFO_DECODE_LOOKUP){const K=z[0];if(K===w||K===_)return new Fr(z[1]);let Q=Fr.numBitsDiffering(w,K);Q<A&&(B=z[1],A=Q),w!==_&&(Q=Fr.numBitsDiffering(_,K),Q<A&&(B=z[1],A=Q))}return A<=3?new Fr(B):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(w){if(!(w instanceof Fr))return!1;const _=w;return this.errorCorrectionLevel===_.errorCorrectionLevel&&this.dataMask===_.dataMask}}Fr.FORMAT_INFO_MASK_QR=21522,Fr.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class Ye{constructor(w,..._){this.ecCodewordsPerBlock=w,this.ecBlocks=_}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let w=0;const _=this.ecBlocks;for(const A of _)w+=A.getCount();return w}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class ke{constructor(w,_){this.count=w,this.dataCodewords=_}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ur{constructor(w,_,...A){this.versionNumber=w,this.alignmentPatternCenters=_,this.ecBlocks=A;let B=0;const z=A[0].getECCodewordsPerBlock(),K=A[0].getECBlocks();for(const Q of K)B+=Q.getCount()*(Q.getDataCodewords()+z);this.totalCodewords=B}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(w){return this.ecBlocks[w.getValue()]}static getProvisionalVersionForDimension(w){if(w%4!==1)throw new R;try{return this.getVersionForNumber((w-17)/4)}catch{throw new R}}static getVersionForNumber(w){if(w<1||w>40)throw new h;return ur.VERSIONS[w-1]}static decodeVersionInformation(w){let _=Number.MAX_SAFE_INTEGER,A=0;for(let B=0;B<ur.VERSION_DECODE_INFO.length;B++){const z=ur.VERSION_DECODE_INFO[B];if(z===w)return ur.getVersionForNumber(B+7);const K=Fr.numBitsDiffering(w,z);K<_&&(A=B+7,_=K)}return _<=3?ur.getVersionForNumber(A):null}buildFunctionPattern(){const w=this.getDimensionForVersion(),_=new F(w);_.setRegion(0,0,9,9),_.setRegion(w-8,0,8,9),_.setRegion(0,w-8,9,8);const A=this.alignmentPatternCenters.length;for(let B=0;B<A;B++){const z=this.alignmentPatternCenters[B]-2;for(let K=0;K<A;K++)B===0&&(K===0||K===A-1)||B===A-1&&K===0||_.setRegion(this.alignmentPatternCenters[K]-2,z,5,5)}return _.setRegion(6,9,1,w-17),_.setRegion(9,6,w-17,1),this.versionNumber>6&&(_.setRegion(w-11,0,3,6),_.setRegion(0,w-11,6,3)),_}toString(){return""+this.versionNumber}}ur.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),ur.VERSIONS=[new ur(1,new Int32Array(0),new Ye(7,new ke(1,19)),new Ye(10,new ke(1,16)),new Ye(13,new ke(1,13)),new Ye(17,new ke(1,9))),new ur(2,Int32Array.from([6,18]),new Ye(10,new ke(1,34)),new Ye(16,new ke(1,28)),new Ye(22,new ke(1,22)),new Ye(28,new ke(1,16))),new ur(3,Int32Array.from([6,22]),new Ye(15,new ke(1,55)),new Ye(26,new ke(1,44)),new Ye(18,new ke(2,17)),new Ye(22,new ke(2,13))),new ur(4,Int32Array.from([6,26]),new Ye(20,new ke(1,80)),new Ye(18,new ke(2,32)),new Ye(26,new ke(2,24)),new Ye(16,new ke(4,9))),new ur(5,Int32Array.from([6,30]),new Ye(26,new ke(1,108)),new Ye(24,new ke(2,43)),new Ye(18,new ke(2,15),new ke(2,16)),new Ye(22,new ke(2,11),new ke(2,12))),new ur(6,Int32Array.from([6,34]),new Ye(18,new ke(2,68)),new Ye(16,new ke(4,27)),new Ye(24,new ke(4,19)),new Ye(28,new ke(4,15))),new ur(7,Int32Array.from([6,22,38]),new Ye(20,new ke(2,78)),new Ye(18,new ke(4,31)),new Ye(18,new ke(2,14),new ke(4,15)),new Ye(26,new ke(4,13),new ke(1,14))),new ur(8,Int32Array.from([6,24,42]),new Ye(24,new ke(2,97)),new Ye(22,new ke(2,38),new ke(2,39)),new Ye(22,new ke(4,18),new ke(2,19)),new Ye(26,new ke(4,14),new ke(2,15))),new ur(9,Int32Array.from([6,26,46]),new Ye(30,new ke(2,116)),new Ye(22,new ke(3,36),new ke(2,37)),new Ye(20,new ke(4,16),new ke(4,17)),new Ye(24,new ke(4,12),new ke(4,13))),new ur(10,Int32Array.from([6,28,50]),new Ye(18,new ke(2,68),new ke(2,69)),new Ye(26,new ke(4,43),new ke(1,44)),new Ye(24,new ke(6,19),new ke(2,20)),new Ye(28,new ke(6,15),new ke(2,16))),new ur(11,Int32Array.from([6,30,54]),new Ye(20,new ke(4,81)),new Ye(30,new ke(1,50),new ke(4,51)),new Ye(28,new ke(4,22),new ke(4,23)),new Ye(24,new ke(3,12),new ke(8,13))),new ur(12,Int32Array.from([6,32,58]),new Ye(24,new ke(2,92),new ke(2,93)),new Ye(22,new ke(6,36),new ke(2,37)),new Ye(26,new ke(4,20),new ke(6,21)),new Ye(28,new ke(7,14),new ke(4,15))),new ur(13,Int32Array.from([6,34,62]),new Ye(26,new ke(4,107)),new Ye(22,new ke(8,37),new ke(1,38)),new Ye(24,new ke(8,20),new ke(4,21)),new Ye(22,new ke(12,11),new ke(4,12))),new ur(14,Int32Array.from([6,26,46,66]),new Ye(30,new ke(3,115),new ke(1,116)),new Ye(24,new ke(4,40),new ke(5,41)),new Ye(20,new ke(11,16),new ke(5,17)),new Ye(24,new ke(11,12),new ke(5,13))),new ur(15,Int32Array.from([6,26,48,70]),new Ye(22,new ke(5,87),new ke(1,88)),new Ye(24,new ke(5,41),new ke(5,42)),new Ye(30,new ke(5,24),new ke(7,25)),new Ye(24,new ke(11,12),new ke(7,13))),new ur(16,Int32Array.from([6,26,50,74]),new Ye(24,new ke(5,98),new ke(1,99)),new Ye(28,new ke(7,45),new ke(3,46)),new Ye(24,new ke(15,19),new ke(2,20)),new Ye(30,new ke(3,15),new ke(13,16))),new ur(17,Int32Array.from([6,30,54,78]),new Ye(28,new ke(1,107),new ke(5,108)),new Ye(28,new ke(10,46),new ke(1,47)),new Ye(28,new ke(1,22),new ke(15,23)),new Ye(28,new ke(2,14),new ke(17,15))),new ur(18,Int32Array.from([6,30,56,82]),new Ye(30,new ke(5,120),new ke(1,121)),new Ye(26,new ke(9,43),new ke(4,44)),new Ye(28,new ke(17,22),new ke(1,23)),new Ye(28,new ke(2,14),new ke(19,15))),new ur(19,Int32Array.from([6,30,58,86]),new Ye(28,new ke(3,113),new ke(4,114)),new Ye(26,new ke(3,44),new ke(11,45)),new Ye(26,new ke(17,21),new ke(4,22)),new Ye(26,new ke(9,13),new ke(16,14))),new ur(20,Int32Array.from([6,34,62,90]),new Ye(28,new ke(3,107),new ke(5,108)),new Ye(26,new ke(3,41),new ke(13,42)),new Ye(30,new ke(15,24),new ke(5,25)),new Ye(28,new ke(15,15),new ke(10,16))),new ur(21,Int32Array.from([6,28,50,72,94]),new Ye(28,new ke(4,116),new ke(4,117)),new Ye(26,new ke(17,42)),new Ye(28,new ke(17,22),new ke(6,23)),new Ye(30,new ke(19,16),new ke(6,17))),new ur(22,Int32Array.from([6,26,50,74,98]),new Ye(28,new ke(2,111),new ke(7,112)),new Ye(28,new ke(17,46)),new Ye(30,new ke(7,24),new ke(16,25)),new Ye(24,new ke(34,13))),new ur(23,Int32Array.from([6,30,54,78,102]),new Ye(30,new ke(4,121),new ke(5,122)),new Ye(28,new ke(4,47),new ke(14,48)),new Ye(30,new ke(11,24),new ke(14,25)),new Ye(30,new ke(16,15),new ke(14,16))),new ur(24,Int32Array.from([6,28,54,80,106]),new Ye(30,new ke(6,117),new ke(4,118)),new Ye(28,new ke(6,45),new ke(14,46)),new Ye(30,new ke(11,24),new ke(16,25)),new Ye(30,new ke(30,16),new ke(2,17))),new ur(25,Int32Array.from([6,32,58,84,110]),new Ye(26,new ke(8,106),new ke(4,107)),new Ye(28,new ke(8,47),new ke(13,48)),new Ye(30,new ke(7,24),new ke(22,25)),new Ye(30,new ke(22,15),new ke(13,16))),new ur(26,Int32Array.from([6,30,58,86,114]),new Ye(28,new ke(10,114),new ke(2,115)),new Ye(28,new ke(19,46),new ke(4,47)),new Ye(28,new ke(28,22),new ke(6,23)),new Ye(30,new ke(33,16),new ke(4,17))),new ur(27,Int32Array.from([6,34,62,90,118]),new Ye(30,new ke(8,122),new ke(4,123)),new Ye(28,new ke(22,45),new ke(3,46)),new Ye(30,new ke(8,23),new ke(26,24)),new Ye(30,new ke(12,15),new ke(28,16))),new ur(28,Int32Array.from([6,26,50,74,98,122]),new Ye(30,new ke(3,117),new ke(10,118)),new Ye(28,new ke(3,45),new ke(23,46)),new Ye(30,new ke(4,24),new ke(31,25)),new Ye(30,new ke(11,15),new ke(31,16))),new ur(29,Int32Array.from([6,30,54,78,102,126]),new Ye(30,new ke(7,116),new ke(7,117)),new Ye(28,new ke(21,45),new ke(7,46)),new Ye(30,new ke(1,23),new ke(37,24)),new Ye(30,new ke(19,15),new ke(26,16))),new ur(30,Int32Array.from([6,26,52,78,104,130]),new Ye(30,new ke(5,115),new ke(10,116)),new Ye(28,new ke(19,47),new ke(10,48)),new Ye(30,new ke(15,24),new ke(25,25)),new Ye(30,new ke(23,15),new ke(25,16))),new ur(31,Int32Array.from([6,30,56,82,108,134]),new Ye(30,new ke(13,115),new ke(3,116)),new Ye(28,new ke(2,46),new ke(29,47)),new Ye(30,new ke(42,24),new ke(1,25)),new Ye(30,new ke(23,15),new ke(28,16))),new ur(32,Int32Array.from([6,34,60,86,112,138]),new Ye(30,new ke(17,115)),new Ye(28,new ke(10,46),new ke(23,47)),new Ye(30,new ke(10,24),new ke(35,25)),new Ye(30,new ke(19,15),new ke(35,16))),new ur(33,Int32Array.from([6,30,58,86,114,142]),new Ye(30,new ke(17,115),new ke(1,116)),new Ye(28,new ke(14,46),new ke(21,47)),new Ye(30,new ke(29,24),new ke(19,25)),new Ye(30,new ke(11,15),new ke(46,16))),new ur(34,Int32Array.from([6,34,62,90,118,146]),new Ye(30,new ke(13,115),new ke(6,116)),new Ye(28,new ke(14,46),new ke(23,47)),new Ye(30,new ke(44,24),new ke(7,25)),new Ye(30,new ke(59,16),new ke(1,17))),new ur(35,Int32Array.from([6,30,54,78,102,126,150]),new Ye(30,new ke(12,121),new ke(7,122)),new Ye(28,new ke(12,47),new ke(26,48)),new Ye(30,new ke(39,24),new ke(14,25)),new Ye(30,new ke(22,15),new ke(41,16))),new ur(36,Int32Array.from([6,24,50,76,102,128,154]),new Ye(30,new ke(6,121),new ke(14,122)),new Ye(28,new ke(6,47),new ke(34,48)),new Ye(30,new ke(46,24),new ke(10,25)),new Ye(30,new ke(2,15),new ke(64,16))),new ur(37,Int32Array.from([6,28,54,80,106,132,158]),new Ye(30,new ke(17,122),new ke(4,123)),new Ye(28,new ke(29,46),new ke(14,47)),new Ye(30,new ke(49,24),new ke(10,25)),new Ye(30,new ke(24,15),new ke(46,16))),new ur(38,Int32Array.from([6,32,58,84,110,136,162]),new Ye(30,new ke(4,122),new ke(18,123)),new Ye(28,new ke(13,46),new ke(32,47)),new Ye(30,new ke(48,24),new ke(14,25)),new Ye(30,new ke(42,15),new ke(32,16))),new ur(39,Int32Array.from([6,26,54,82,110,138,166]),new Ye(30,new ke(20,117),new ke(4,118)),new Ye(28,new ke(40,47),new ke(7,48)),new Ye(30,new ke(43,24),new ke(22,25)),new Ye(30,new ke(10,15),new ke(67,16))),new ur(40,Int32Array.from([6,30,58,86,114,142,170]),new Ye(30,new ke(19,118),new ke(6,119)),new Ye(28,new ke(18,47),new ke(31,48)),new Ye(30,new ke(34,24),new ke(34,25)),new Ye(30,new ke(20,15),new ke(61,16)))];var js;(function(xe){xe[xe.DATA_MASK_000=0]="DATA_MASK_000",xe[xe.DATA_MASK_001=1]="DATA_MASK_001",xe[xe.DATA_MASK_010=2]="DATA_MASK_010",xe[xe.DATA_MASK_011=3]="DATA_MASK_011",xe[xe.DATA_MASK_100=4]="DATA_MASK_100",xe[xe.DATA_MASK_101=5]="DATA_MASK_101",xe[xe.DATA_MASK_110=6]="DATA_MASK_110",xe[xe.DATA_MASK_111=7]="DATA_MASK_111"})(js||(js={}));class Qn{constructor(w,_){this.value=w,this.isMasked=_}unmaskBitMatrix(w,_){for(let A=0;A<_;A++)for(let B=0;B<_;B++)this.isMasked(A,B)&&w.flip(B,A)}}Qn.values=new Map([[js.DATA_MASK_000,new Qn(js.DATA_MASK_000,(xe,w)=>(xe+w&1)===0)],[js.DATA_MASK_001,new Qn(js.DATA_MASK_001,(xe,w)=>(xe&1)===0)],[js.DATA_MASK_010,new Qn(js.DATA_MASK_010,(xe,w)=>w%3===0)],[js.DATA_MASK_011,new Qn(js.DATA_MASK_011,(xe,w)=>(xe+w)%3===0)],[js.DATA_MASK_100,new Qn(js.DATA_MASK_100,(xe,w)=>(Math.floor(xe/2)+Math.floor(w/3)&1)===0)],[js.DATA_MASK_101,new Qn(js.DATA_MASK_101,(xe,w)=>xe*w%6===0)],[js.DATA_MASK_110,new Qn(js.DATA_MASK_110,(xe,w)=>xe*w%6<3)],[js.DATA_MASK_111,new Qn(js.DATA_MASK_111,(xe,w)=>(xe+w+xe*w%3&1)===0)]]);class al{constructor(w){const _=w.getHeight();if(_<21||(_&3)!==1)throw new R;this.bitMatrix=w}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let w=0;for(let z=0;z<6;z++)w=this.copyBit(z,8,w);w=this.copyBit(7,8,w),w=this.copyBit(8,8,w),w=this.copyBit(8,7,w);for(let z=5;z>=0;z--)w=this.copyBit(8,z,w);const _=this.bitMatrix.getHeight();let A=0;const B=_-7;for(let z=_-1;z>=B;z--)A=this.copyBit(8,z,A);for(let z=_-8;z<_;z++)A=this.copyBit(z,8,A);if(this.parsedFormatInfo=Fr.decodeFormatInformation(w,A),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new R}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const w=this.bitMatrix.getHeight(),_=Math.floor((w-17)/4);if(_<=6)return ur.getVersionForNumber(_);let A=0;const B=w-11;for(let K=5;K>=0;K--)for(let Q=w-9;Q>=B;Q--)A=this.copyBit(Q,K,A);let z=ur.decodeVersionInformation(A);if(z!==null&&z.getDimensionForVersion()===w)return this.parsedVersion=z,z;A=0;for(let K=5;K>=0;K--)for(let Q=w-9;Q>=B;Q--)A=this.copyBit(K,Q,A);if(z=ur.decodeVersionInformation(A),z!==null&&z.getDimensionForVersion()===w)return this.parsedVersion=z,z;throw new R}copyBit(w,_,A){return(this.isMirror?this.bitMatrix.get(_,w):this.bitMatrix.get(w,_))?A<<1|1:A<<1}readCodewords(){const w=this.readFormatInformation(),_=this.readVersion(),A=Qn.values.get(w.getDataMask()),B=this.bitMatrix.getHeight();A.unmaskBitMatrix(this.bitMatrix,B);const z=_.buildFunctionPattern();let K=!0;const Q=new Uint8Array(_.getTotalCodewords());let te=0,ae=0,me=0;for(let ve=B-1;ve>0;ve-=2){ve===6&&ve--;for(let je=0;je<B;je++){const Oe=K?B-1-je:je;for(let Ue=0;Ue<2;Ue++)z.get(ve-Ue,Oe)||(me++,ae<<=1,this.bitMatrix.get(ve-Ue,Oe)&&(ae|=1),me===8&&(Q[te++]=ae,me=0,ae=0))}K=!K}if(te!==_.getTotalCodewords())throw new R;return Q}remask(){if(this.parsedFormatInfo===null)return;const w=Qn.values[this.parsedFormatInfo.getDataMask()],_=this.bitMatrix.getHeight();w.unmaskBitMatrix(this.bitMatrix,_)}setMirror(w){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=w}mirror(){const w=this.bitMatrix;for(let _=0,A=w.getWidth();_<A;_++)for(let B=_+1,z=w.getHeight();B<z;B++)w.get(_,B)!==w.get(B,_)&&(w.flip(B,_),w.flip(_,B))}}class Ao{constructor(w,_){this.numDataCodewords=w,this.codewords=_}static getDataBlocks(w,_,A){if(w.length!==_.getTotalCodewords())throw new h;const B=_.getECBlocksForLevel(A);let z=0;const K=B.getECBlocks();for(const Ue of K)z+=Ue.getCount();const Q=new Array(z);let te=0;for(const Ue of K)for(let He=0;He<Ue.getCount();He++){const nt=Ue.getDataCodewords(),pt=B.getECCodewordsPerBlock()+nt;Q[te++]=new Ao(nt,new Uint8Array(pt))}const ae=Q[0].codewords.length;let me=Q.length-1;for(;me>=0&&Q[me].codewords.length!==ae;)me--;me++;const ve=ae-B.getECCodewordsPerBlock();let je=0;for(let Ue=0;Ue<ve;Ue++)for(let He=0;He<te;He++)Q[He].codewords[Ue]=w[je++];for(let Ue=me;Ue<te;Ue++)Q[Ue].codewords[ve]=w[je++];const Oe=Q[0].codewords.length;for(let Ue=ve;Ue<Oe;Ue++)for(let He=0;He<te;He++){const nt=He<me?Ue:Ue+1;Q[He].codewords[nt]=w[je++]}return Q}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Ca;(function(xe){xe[xe.TERMINATOR=0]="TERMINATOR",xe[xe.NUMERIC=1]="NUMERIC",xe[xe.ALPHANUMERIC=2]="ALPHANUMERIC",xe[xe.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",xe[xe.BYTE=4]="BYTE",xe[xe.ECI=5]="ECI",xe[xe.KANJI=6]="KANJI",xe[xe.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",xe[xe.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",xe[xe.HANZI=9]="HANZI"})(Ca||(Ca={}));class vr{constructor(w,_,A,B){this.value=w,this.stringValue=_,this.characterCountBitsForVersions=A,this.bits=B,vr.FOR_BITS.set(B,this),vr.FOR_VALUE.set(w,this)}static forBits(w){const _=vr.FOR_BITS.get(w);if(_===void 0)throw new h;return _}getCharacterCountBits(w){const _=w.getVersionNumber();let A;return _<=9?A=0:_<=26?A=1:A=2,this.characterCountBitsForVersions[A]}getValue(){return this.value}getBits(){return this.bits}equals(w){if(!(w instanceof vr))return!1;const _=w;return this.value===_.value}toString(){return this.stringValue}}vr.FOR_BITS=new Map,vr.FOR_VALUE=new Map,vr.TERMINATOR=new vr(Ca.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),vr.NUMERIC=new vr(Ca.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),vr.ALPHANUMERIC=new vr(Ca.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),vr.STRUCTURED_APPEND=new vr(Ca.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),vr.BYTE=new vr(Ca.BYTE,"BYTE",Int32Array.from([8,16,16]),4),vr.ECI=new vr(Ca.ECI,"ECI",Int32Array.from([0,0,0]),7),vr.KANJI=new vr(Ca.KANJI,"KANJI",Int32Array.from([8,10,12]),8),vr.FNC1_FIRST_POSITION=new vr(Ca.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),vr.FNC1_SECOND_POSITION=new vr(Ca.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),vr.HANZI=new vr(Ca.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Mn{static decode(w,_,A,B){const z=new wn(w);let K=new M;const Q=new Array;let te=-1,ae=-1;try{let me=null,ve=!1,je;do{if(z.available()<4)je=vr.TERMINATOR;else{const Oe=z.readBits(4);je=vr.forBits(Oe)}switch(je){case vr.TERMINATOR:break;case vr.FNC1_FIRST_POSITION:case vr.FNC1_SECOND_POSITION:ve=!0;break;case vr.STRUCTURED_APPEND:if(z.available()<16)throw new R;te=z.readBits(8),ae=z.readBits(8);break;case vr.ECI:const Oe=Mn.parseECIValue(z);if(me=L.getCharacterSetECIByValue(Oe),me===null)throw new R;break;case vr.HANZI:const Ue=z.readBits(4),He=z.readBits(je.getCharacterCountBits(_));Ue===Mn.GB2312_SUBSET&&Mn.decodeHanziSegment(z,K,He);break;default:const nt=z.readBits(je.getCharacterCountBits(_));switch(je){case vr.NUMERIC:Mn.decodeNumericSegment(z,K,nt);break;case vr.ALPHANUMERIC:Mn.decodeAlphanumericSegment(z,K,nt,ve);break;case vr.BYTE:Mn.decodeByteSegment(z,K,nt,me,Q,B);break;case vr.KANJI:Mn.decodeKanjiSegment(z,K,nt);break;default:throw new R}break}}while(je!==vr.TERMINATOR)}catch{throw new R}return new W(w,K.toString(),Q.length===0?null:Q,A===null?null:A.toString(),te,ae)}static decodeHanziSegment(w,_,A){if(A*13>w.available())throw new R;const B=new Uint8Array(2*A);let z=0;for(;A>0;){const K=w.readBits(13);let Q=K/96<<8&4294967295|K%96;Q<959?Q+=41377:Q+=42657,B[z]=Q>>8&255,B[z+1]=Q&255,z+=2,A--}try{_.append(X.decode(B,H.GB2312))}catch(K){throw new R(K)}}static decodeKanjiSegment(w,_,A){if(A*13>w.available())throw new R;const B=new Uint8Array(2*A);let z=0;for(;A>0;){const K=w.readBits(13);let Q=K/192<<8&4294967295|K%192;Q<7936?Q+=33088:Q+=49472,B[z]=Q>>8,B[z+1]=Q,z+=2,A--}try{_.append(X.decode(B,H.SHIFT_JIS))}catch(K){throw new R(K)}}static decodeByteSegment(w,_,A,B,z,K){if(8*A>w.available())throw new R;const Q=new Uint8Array(A);for(let ae=0;ae<A;ae++)Q[ae]=w.readBits(8);let te;B===null?te=H.guessEncoding(Q,K):te=B.getName();try{_.append(X.decode(Q,te))}catch(ae){throw new R(ae)}z.push(Q)}static toAlphaNumericChar(w){if(w>=Mn.ALPHANUMERIC_CHARS.length)throw new R;return Mn.ALPHANUMERIC_CHARS[w]}static decodeAlphanumericSegment(w,_,A,B){const z=_.length();for(;A>1;){if(w.available()<11)throw new R;const K=w.readBits(11);_.append(Mn.toAlphaNumericChar(Math.floor(K/45))),_.append(Mn.toAlphaNumericChar(K%45)),A-=2}if(A===1){if(w.available()<6)throw new R;_.append(Mn.toAlphaNumericChar(w.readBits(6)))}if(B)for(let K=z;K<_.length();K++)_.charAt(K)==="%"&&(K<_.length()-1&&_.charAt(K+1)==="%"?_.deleteCharAt(K+1):_.setCharAt(K,""))}static decodeNumericSegment(w,_,A){for(;A>=3;){if(w.available()<10)throw new R;const B=w.readBits(10);if(B>=1e3)throw new R;_.append(Mn.toAlphaNumericChar(Math.floor(B/100))),_.append(Mn.toAlphaNumericChar(Math.floor(B/10)%10)),_.append(Mn.toAlphaNumericChar(B%10)),A-=3}if(A===2){if(w.available()<7)throw new R;const B=w.readBits(7);if(B>=100)throw new R;_.append(Mn.toAlphaNumericChar(Math.floor(B/10))),_.append(Mn.toAlphaNumericChar(B%10))}else if(A===1){if(w.available()<4)throw new R;const B=w.readBits(4);if(B>=10)throw new R;_.append(Mn.toAlphaNumericChar(B))}}static parseECIValue(w){const _=w.readBits(8);if(!(_&128))return _&127;if((_&192)===128){const A=w.readBits(8);return(_&63)<<8&4294967295|A}if((_&224)===192){const A=w.readBits(16);return(_&31)<<16&4294967295|A}throw new R}}Mn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Mn.GB2312_SUBSET=1;class il{constructor(w){this.mirrored=w}isMirrored(){return this.mirrored}applyMirroredCorrection(w){if(!this.mirrored||w===null||w.length<3)return;const _=w[0];w[0]=w[2],w[2]=_}}class J1{constructor(){this.rsDecoder=new ue(se.QR_CODE_FIELD_256)}decodeBooleanArray(w,_){return this.decodeBitMatrix(F.parseFromBooleanArray(w),_)}decodeBitMatrix(w,_){const A=new al(w);let B=null;try{return this.decodeBitMatrixParser(A,_)}catch(z){B=z}try{A.remask(),A.setMirror(!0),A.readVersion(),A.readFormatInformation(),A.mirror();const z=this.decodeBitMatrixParser(A,_);return z.setOther(new il(!0)),z}catch(z){throw B!==null?B:z}}decodeBitMatrixParser(w,_){const A=w.readVersion(),B=w.readFormatInformation().getErrorCorrectionLevel(),z=w.readCodewords(),K=Ao.getDataBlocks(z,A,B);let Q=0;for(const me of K)Q+=me.getNumDataCodewords();const te=new Uint8Array(Q);let ae=0;for(const me of K){const ve=me.getCodewords(),je=me.getNumDataCodewords();this.correctErrors(ve,je);for(let Oe=0;Oe<je;Oe++)te[ae++]=ve[Oe]}return Mn.decode(te,A,B,_)}correctErrors(w,_){const A=new Int32Array(w);try{this.rsDecoder.decode(A,w.length-_)}catch{throw new m}for(let B=0;B<_;B++)w[B]=A[B]}}class Ad extends _e{constructor(w,_,A){super(w,_),this.estimatedModuleSize=A}aboutEquals(w,_,A){if(Math.abs(_-this.getY())<=w&&Math.abs(A-this.getX())<=w){const B=Math.abs(w-this.estimatedModuleSize);return B<=1||B<=this.estimatedModuleSize}return!1}combineEstimate(w,_,A){const B=(this.getX()+_)/2,z=(this.getY()+w)/2,K=(this.estimatedModuleSize+A)/2;return new Ad(B,z,K)}}class Td{constructor(w,_,A,B,z,K,Q){this.image=w,this.startX=_,this.startY=A,this.width=B,this.height=z,this.moduleSize=K,this.resultPointCallback=Q,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const w=this.startX,_=this.height,A=this.width,B=w+A,z=this.startY+_/2,K=new Int32Array(3),Q=this.image;for(let te=0;te<_;te++){const ae=z+(te&1?-Math.floor((te+1)/2):Math.floor((te+1)/2));K[0]=0,K[1]=0,K[2]=0;let me=w;for(;me<B&&!Q.get(me,ae);)me++;let ve=0;for(;me<B;){if(Q.get(me,ae))if(ve===1)K[1]++;else if(ve===2){if(this.foundPatternCross(K)){const je=this.handlePossibleCenter(K,ae,me);if(je!==null)return je}K[0]=K[2],K[1]=1,K[2]=0,ve=1}else K[++ve]++;else ve===1&&ve++,K[ve]++;me++}if(this.foundPatternCross(K)){const je=this.handlePossibleCenter(K,ae,B);if(je!==null)return je}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new S}static centerFromEnd(w,_){return _-w[2]-w[1]/2}foundPatternCross(w){const _=this.moduleSize,A=_/2;for(let B=0;B<3;B++)if(Math.abs(_-w[B])>=A)return!1;return!0}crossCheckVertical(w,_,A,B){const z=this.image,K=z.getHeight(),Q=this.crossCheckStateCount;Q[0]=0,Q[1]=0,Q[2]=0;let te=w;for(;te>=0&&z.get(_,te)&&Q[1]<=A;)Q[1]++,te--;if(te<0||Q[1]>A)return NaN;for(;te>=0&&!z.get(_,te)&&Q[0]<=A;)Q[0]++,te--;if(Q[0]>A)return NaN;for(te=w+1;te<K&&z.get(_,te)&&Q[1]<=A;)Q[1]++,te++;if(te===K||Q[1]>A)return NaN;for(;te<K&&!z.get(_,te)&&Q[2]<=A;)Q[2]++,te++;if(Q[2]>A)return NaN;const ae=Q[0]+Q[1]+Q[2];return 5*Math.abs(ae-B)>=2*B?NaN:this.foundPatternCross(Q)?Td.centerFromEnd(Q,te):NaN}handlePossibleCenter(w,_,A){const B=w[0]+w[1]+w[2],z=Td.centerFromEnd(w,A),K=this.crossCheckVertical(_,z,2*w[1],B);if(!isNaN(K)){const Q=(w[0]+w[1]+w[2])/3;for(const ae of this.possibleCenters)if(ae.aboutEquals(Q,K,z))return ae.combineEstimate(K,z,Q);const te=new Ad(z,K,Q);this.possibleCenters.push(te),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(te)}return null}}class Pd extends _e{constructor(w,_,A,B){super(w,_),this.estimatedModuleSize=A,this.count=B,B===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(w,_,A){if(Math.abs(_-this.getY())<=w&&Math.abs(A-this.getX())<=w){const B=Math.abs(w-this.estimatedModuleSize);return B<=1||B<=this.estimatedModuleSize}return!1}combineEstimate(w,_,A){const B=this.count+1,z=(this.count*this.getX()+_)/B,K=(this.count*this.getY()+w)/B,Q=(this.count*this.estimatedModuleSize+A)/B;return new Pd(z,K,Q,B)}}class Bf{constructor(w){this.bottomLeft=w[0],this.topLeft=w[1],this.topRight=w[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class Vs{constructor(w,_){this.image=w,this.resultPointCallback=_,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=_}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(w){const _=w!=null&&w.get(O.TRY_HARDER)!==void 0,A=w!=null&&w.get(O.PURE_BARCODE)!==void 0,B=this.image,z=B.getHeight(),K=B.getWidth();let Q=Math.floor(3*z/(4*Vs.MAX_MODULES));(Q<Vs.MIN_SKIP||_)&&(Q=Vs.MIN_SKIP);let te=!1;const ae=new Int32Array(5);for(let ve=Q-1;ve<z&&!te;ve+=Q){ae[0]=0,ae[1]=0,ae[2]=0,ae[3]=0,ae[4]=0;let je=0;for(let Oe=0;Oe<K;Oe++)if(B.get(Oe,ve))(je&1)===1&&je++,ae[je]++;else if(je&1)ae[je]++;else if(je===4)if(Vs.foundPatternCross(ae)){if(this.handlePossibleCenter(ae,ve,Oe,A)===!0)if(Q=2,this.hasSkipped===!0)te=this.haveMultiplyConfirmedCenters();else{const He=this.findRowSkip();He>ae[2]&&(ve+=He-ae[2]-Q,Oe=K-1)}else{ae[0]=ae[2],ae[1]=ae[3],ae[2]=ae[4],ae[3]=1,ae[4]=0,je=3;continue}je=0,ae[0]=0,ae[1]=0,ae[2]=0,ae[3]=0,ae[4]=0}else ae[0]=ae[2],ae[1]=ae[3],ae[2]=ae[4],ae[3]=1,ae[4]=0,je=3;else ae[++je]++;Vs.foundPatternCross(ae)&&this.handlePossibleCenter(ae,ve,K,A)===!0&&(Q=ae[0],this.hasSkipped&&(te=this.haveMultiplyConfirmedCenters()))}const me=this.selectBestPatterns();return _e.orderBestPatterns(me),new Bf(me)}static centerFromEnd(w,_){return _-w[4]-w[3]-w[2]/2}static foundPatternCross(w){let _=0;for(let z=0;z<5;z++){const K=w[z];if(K===0)return!1;_+=K}if(_<7)return!1;const A=_/7,B=A/2;return Math.abs(A-w[0])<B&&Math.abs(A-w[1])<B&&Math.abs(3*A-w[2])<3*B&&Math.abs(A-w[3])<B&&Math.abs(A-w[4])<B}getCrossCheckStateCount(){const w=this.crossCheckStateCount;return w[0]=0,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w}crossCheckDiagonal(w,_,A,B){const z=this.getCrossCheckStateCount();let K=0;const Q=this.image;for(;w>=K&&_>=K&&Q.get(_-K,w-K);)z[2]++,K++;if(w<K||_<K)return!1;for(;w>=K&&_>=K&&!Q.get(_-K,w-K)&&z[1]<=A;)z[1]++,K++;if(w<K||_<K||z[1]>A)return!1;for(;w>=K&&_>=K&&Q.get(_-K,w-K)&&z[0]<=A;)z[0]++,K++;if(z[0]>A)return!1;const te=Q.getHeight(),ae=Q.getWidth();for(K=1;w+K<te&&_+K<ae&&Q.get(_+K,w+K);)z[2]++,K++;if(w+K>=te||_+K>=ae)return!1;for(;w+K<te&&_+K<ae&&!Q.get(_+K,w+K)&&z[3]<A;)z[3]++,K++;if(w+K>=te||_+K>=ae||z[3]>=A)return!1;for(;w+K<te&&_+K<ae&&Q.get(_+K,w+K)&&z[4]<A;)z[4]++,K++;if(z[4]>=A)return!1;const me=z[0]+z[1]+z[2]+z[3]+z[4];return Math.abs(me-B)<2*B&&Vs.foundPatternCross(z)}crossCheckVertical(w,_,A,B){const z=this.image,K=z.getHeight(),Q=this.getCrossCheckStateCount();let te=w;for(;te>=0&&z.get(_,te);)Q[2]++,te--;if(te<0)return NaN;for(;te>=0&&!z.get(_,te)&&Q[1]<=A;)Q[1]++,te--;if(te<0||Q[1]>A)return NaN;for(;te>=0&&z.get(_,te)&&Q[0]<=A;)Q[0]++,te--;if(Q[0]>A)return NaN;for(te=w+1;te<K&&z.get(_,te);)Q[2]++,te++;if(te===K)return NaN;for(;te<K&&!z.get(_,te)&&Q[3]<A;)Q[3]++,te++;if(te===K||Q[3]>=A)return NaN;for(;te<K&&z.get(_,te)&&Q[4]<A;)Q[4]++,te++;if(Q[4]>=A)return NaN;const ae=Q[0]+Q[1]+Q[2]+Q[3]+Q[4];return 5*Math.abs(ae-B)>=2*B?NaN:Vs.foundPatternCross(Q)?Vs.centerFromEnd(Q,te):NaN}crossCheckHorizontal(w,_,A,B){const z=this.image,K=z.getWidth(),Q=this.getCrossCheckStateCount();let te=w;for(;te>=0&&z.get(te,_);)Q[2]++,te--;if(te<0)return NaN;for(;te>=0&&!z.get(te,_)&&Q[1]<=A;)Q[1]++,te--;if(te<0||Q[1]>A)return NaN;for(;te>=0&&z.get(te,_)&&Q[0]<=A;)Q[0]++,te--;if(Q[0]>A)return NaN;for(te=w+1;te<K&&z.get(te,_);)Q[2]++,te++;if(te===K)return NaN;for(;te<K&&!z.get(te,_)&&Q[3]<A;)Q[3]++,te++;if(te===K||Q[3]>=A)return NaN;for(;te<K&&z.get(te,_)&&Q[4]<A;)Q[4]++,te++;if(Q[4]>=A)return NaN;const ae=Q[0]+Q[1]+Q[2]+Q[3]+Q[4];return 5*Math.abs(ae-B)>=B?NaN:Vs.foundPatternCross(Q)?Vs.centerFromEnd(Q,te):NaN}handlePossibleCenter(w,_,A,B){const z=w[0]+w[1]+w[2]+w[3]+w[4];let K=Vs.centerFromEnd(w,A),Q=this.crossCheckVertical(_,Math.floor(K),w[2],z);if(!isNaN(Q)&&(K=this.crossCheckHorizontal(Math.floor(K),Math.floor(Q),w[2],z),!isNaN(K)&&(!B||this.crossCheckDiagonal(Math.floor(Q),Math.floor(K),w[2],z)))){const te=z/7;let ae=!1;const me=this.possibleCenters;for(let ve=0,je=me.length;ve<je;ve++){const Oe=me[ve];if(Oe.aboutEquals(te,Q,K)){me[ve]=Oe.combineEstimate(Q,K,te),ae=!0;break}}if(!ae){const ve=new Pd(K,Q,te);me.push(ve),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(ve)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let _=null;for(const A of this.possibleCenters)if(A.getCount()>=Vs.CENTER_QUORUM)if(_==null)_=A;else return this.hasSkipped=!0,Math.floor((Math.abs(_.getX()-A.getX())-Math.abs(_.getY()-A.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let w=0,_=0;const A=this.possibleCenters.length;for(const K of this.possibleCenters)K.getCount()>=Vs.CENTER_QUORUM&&(w++,_+=K.getEstimatedModuleSize());if(w<3)return!1;const B=_/A;let z=0;for(const K of this.possibleCenters)z+=Math.abs(K.getEstimatedModuleSize()-B);return z<=.05*_}selectBestPatterns(){const w=this.possibleCenters.length;if(w<3)throw new S;const _=this.possibleCenters;let A;if(w>3){let B=0,z=0;for(const te of this.possibleCenters){const ae=te.getEstimatedModuleSize();B+=ae,z+=ae*ae}A=B/w;let K=Math.sqrt(z/w-A*A);_.sort((te,ae)=>{const me=Math.abs(ae.getEstimatedModuleSize()-A),ve=Math.abs(te.getEstimatedModuleSize()-A);return me<ve?-1:me>ve?1:0});const Q=Math.max(.2*A,K);for(let te=0;te<_.length&&_.length>3;te++){const ae=_[te];Math.abs(ae.getEstimatedModuleSize()-A)>Q&&(_.splice(te,1),te--)}}if(_.length>3){let B=0;for(const z of _)B+=z.getEstimatedModuleSize();A=B/_.length,_.sort((z,K)=>{if(K.getCount()===z.getCount()){const Q=Math.abs(K.getEstimatedModuleSize()-A),te=Math.abs(z.getEstimatedModuleSize()-A);return Q<te?1:Q>te?-1:0}else return K.getCount()-z.getCount()}),_.splice(3)}return[_[0],_[1],_[2]]}}Vs.CENTER_QUORUM=2,Vs.MIN_SKIP=3,Vs.MAX_MODULES=57;class Ul{constructor(w){this.image=w}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(w){this.resultPointCallback=w==null?null:w.get(O.NEED_RESULT_POINT_CALLBACK);const A=new Vs(this.image,this.resultPointCallback).find(w);return this.processFinderPatternInfo(A)}processFinderPatternInfo(w){const _=w.getTopLeft(),A=w.getTopRight(),B=w.getBottomLeft(),z=this.calculateModuleSize(_,A,B);if(z<1)throw new S("No pattern found in proccess finder.");const K=Ul.computeDimension(_,A,B,z),Q=ur.getProvisionalVersionForDimension(K),te=Q.getDimensionForVersion()-7;let ae=null;if(Q.getAlignmentPatternCenters().length>0){const Oe=A.getX()-_.getX()+B.getX(),Ue=A.getY()-_.getY()+B.getY(),He=1-3/te,nt=Math.floor(_.getX()+He*(Oe-_.getX())),pt=Math.floor(_.getY()+He*(Ue-_.getY()));for(let $t=4;$t<=16;$t<<=1)try{ae=this.findAlignmentInRegion(z,nt,pt,$t);break}catch(Ft){if(!(Ft instanceof S))throw Ft}}const me=Ul.createTransform(_,A,B,ae,K),ve=Ul.sampleGrid(this.image,me,K);let je;return ae===null?je=[B,_,A]:je=[B,_,A,ae],new be(ve,je)}static createTransform(w,_,A,B,z){const K=z-3.5;let Q,te,ae,me;return B!==null?(Q=B.getX(),te=B.getY(),ae=K-3,me=ae):(Q=_.getX()-w.getX()+A.getX(),te=_.getY()-w.getY()+A.getY(),ae=K,me=K),Ke.quadrilateralToQuadrilateral(3.5,3.5,K,3.5,ae,me,3.5,K,w.getX(),w.getY(),_.getX(),_.getY(),Q,te,A.getX(),A.getY())}static sampleGrid(w,_,A){return it.getInstance().sampleGridWithTransform(w,A,A,_)}static computeDimension(w,_,A,B){const z=ge.round(_e.distance(w,_)/B),K=ge.round(_e.distance(w,A)/B);let Q=Math.floor((z+K)/2)+7;switch(Q&3){case 0:Q++;break;case 2:Q--;break;case 3:throw new S("Dimensions could be not found.")}return Q}calculateModuleSize(w,_,A){return(this.calculateModuleSizeOneWay(w,_)+this.calculateModuleSizeOneWay(w,A))/2}calculateModuleSizeOneWay(w,_){const A=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(w.getX()),Math.floor(w.getY()),Math.floor(_.getX()),Math.floor(_.getY())),B=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(_.getX()),Math.floor(_.getY()),Math.floor(w.getX()),Math.floor(w.getY()));return isNaN(A)?B/7:isNaN(B)?A/7:(A+B)/14}sizeOfBlackWhiteBlackRunBothWays(w,_,A,B){let z=this.sizeOfBlackWhiteBlackRun(w,_,A,B),K=1,Q=w-(A-w);Q<0?(K=w/(w-Q),Q=0):Q>=this.image.getWidth()&&(K=(this.image.getWidth()-1-w)/(Q-w),Q=this.image.getWidth()-1);let te=Math.floor(_-(B-_)*K);return K=1,te<0?(K=_/(_-te),te=0):te>=this.image.getHeight()&&(K=(this.image.getHeight()-1-_)/(te-_),te=this.image.getHeight()-1),Q=Math.floor(w+(Q-w)*K),z+=this.sizeOfBlackWhiteBlackRun(w,_,Q,te),z-1}sizeOfBlackWhiteBlackRun(w,_,A,B){const z=Math.abs(B-_)>Math.abs(A-w);if(z){let Oe=w;w=_,_=Oe,Oe=A,A=B,B=Oe}const K=Math.abs(A-w),Q=Math.abs(B-_);let te=-K/2;const ae=w<A?1:-1,me=_<B?1:-1;let ve=0;const je=A+ae;for(let Oe=w,Ue=_;Oe!==je;Oe+=ae){const He=z?Ue:Oe,nt=z?Oe:Ue;if(ve===1===this.image.get(He,nt)){if(ve===2)return ge.distance(Oe,Ue,w,_);ve++}if(te+=Q,te>0){if(Ue===B)break;Ue+=me,te-=K}}return ve===2?ge.distance(A+ae,B,w,_):NaN}findAlignmentInRegion(w,_,A,B){const z=Math.floor(B*w),K=Math.max(0,_-z),Q=Math.min(this.image.getWidth()-1,_+z);if(Q-K<w*3)throw new S("Alignment top exceeds estimated module size.");const te=Math.max(0,A-z),ae=Math.min(this.image.getHeight()-1,A+z);if(ae-te<w*3)throw new S("Alignment bottom exceeds estimated module size.");return new Td(this.image,K,te,Q-K,ae-te,w,this.resultPointCallback).find()}}class ro{constructor(){this.decoder=new J1}getDecoder(){return this.decoder}decode(w,_){let A,B;if(_!=null&&_.get(O.PURE_BARCODE)!==void 0){const te=ro.extractPureBits(w.getBlackMatrix());A=this.decoder.decodeBitMatrix(te,_),B=ro.NO_POINTS}else{const te=new Ul(w.getBlackMatrix()).detect(_);A=this.decoder.decodeBitMatrix(te.getBits(),_),B=te.getPoints()}A.getOther()instanceof il&&A.getOther().applyMirroredCorrection(B);const z=new Z(A.getText(),A.getRawBytes(),void 0,B,G.QR_CODE,void 0),K=A.getByteSegments();K!==null&&z.putMetadata(V.BYTE_SEGMENTS,K);const Q=A.getECLevel();return Q!==null&&z.putMetadata(V.ERROR_CORRECTION_LEVEL,Q),A.hasStructuredAppend()&&(z.putMetadata(V.STRUCTURED_APPEND_SEQUENCE,A.getStructuredAppendSequenceNumber()),z.putMetadata(V.STRUCTURED_APPEND_PARITY,A.getStructuredAppendParity())),z}reset(){}static extractPureBits(w){const _=w.getTopLeftOnBit(),A=w.getBottomRightOnBit();if(_===null||A===null)throw new S;const B=this.moduleSize(_,w);let z=_[1],K=A[1],Q=_[0],te=A[0];if(Q>=te||z>=K)throw new S;if(K-z!==te-Q&&(te=Q+(K-z),te>=w.getWidth()))throw new S;const ae=Math.round((te-Q+1)/B),me=Math.round((K-z+1)/B);if(ae<=0||me<=0)throw new S;if(me!==ae)throw new S;const ve=Math.floor(B/2);z+=ve,Q+=ve;const je=Q+Math.floor((ae-1)*B)-te;if(je>0){if(je>ve)throw new S;Q-=je}const Oe=z+Math.floor((me-1)*B)-K;if(Oe>0){if(Oe>ve)throw new S;z-=Oe}const Ue=new F(ae,me);for(let He=0;He<me;He++){const nt=z+Math.floor(He*B);for(let pt=0;pt<ae;pt++)w.get(Q+Math.floor(pt*B),nt)&&Ue.set(pt,He)}return Ue}static moduleSize(w,_){const A=_.getHeight(),B=_.getWidth();let z=w[0],K=w[1],Q=!0,te=0;for(;z<B&&K<A;){if(Q!==_.get(z,K)){if(++te===5)break;Q=!Q}z++,K++}if(z===B||K===A)throw new S;return(z-w[0])/7}}ro.NO_POINTS=new Array;class Dr{PDF417Common(){}static getBitCountSum(w){return ge.sum(w)}static toIntArray(w){if(w==null||!w.length)return Dr.EMPTY_INT_ARRAY;const _=new Int32Array(w.length);let A=0;for(const B of w)_[A++]=B;return _}static getCodeword(w){const _=y.binarySearch(Dr.SYMBOL_TABLE,w&262143);return _<0?-1:(Dr.CODEWORD_TABLE[_]-1)%Dr.NUMBER_OF_CODEWORDS}}Dr.NUMBER_OF_CODEWORDS=929,Dr.MAX_CODEWORDS_IN_BARCODE=Dr.NUMBER_OF_CODEWORDS-1,Dr.MIN_ROWS_IN_BARCODE=3,Dr.MAX_ROWS_IN_BARCODE=90,Dr.MODULES_IN_CODEWORD=17,Dr.MODULES_IN_STOP_PATTERN=18,Dr.BARS_IN_MODULE=8,Dr.EMPTY_INT_ARRAY=new Int32Array([]),Dr.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Dr.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class ute{constructor(w,_){this.bits=w,this.points=_}getBits(){return this.bits}getPoints(){return this.points}}class tn{static detectMultiple(w,_,A){let B=w.getBlackMatrix(),z=tn.detect(A,B);return z.length||(B=B.clone(),B.rotate180(),z=tn.detect(A,B)),new ute(B,z)}static detect(w,_){const A=new Array;let B=0,z=0,K=!1;for(;B<_.getHeight();){const Q=tn.findVertices(_,B,z);if(Q[0]==null&&Q[3]==null){if(!K)break;K=!1,z=0;for(const te of A)te[1]!=null&&(B=Math.trunc(Math.max(B,te[1].getY()))),te[3]!=null&&(B=Math.max(B,Math.trunc(te[3].getY())));B+=tn.ROW_STEP;continue}if(K=!0,A.push(Q),!w)break;Q[2]!=null?(z=Math.trunc(Q[2].getX()),B=Math.trunc(Q[2].getY())):(z=Math.trunc(Q[4].getX()),B=Math.trunc(Q[4].getY()))}return A}static findVertices(w,_,A){const B=w.getHeight(),z=w.getWidth(),K=new Array(8);return tn.copyToResult(K,tn.findRowsWithPattern(w,B,z,_,A,tn.START_PATTERN),tn.INDEXES_START_PATTERN),K[4]!=null&&(A=Math.trunc(K[4].getX()),_=Math.trunc(K[4].getY())),tn.copyToResult(K,tn.findRowsWithPattern(w,B,z,_,A,tn.STOP_PATTERN),tn.INDEXES_STOP_PATTERN),K}static copyToResult(w,_,A){for(let B=0;B<A.length;B++)w[A[B]]=_[B]}static findRowsWithPattern(w,_,A,B,z,K){const Q=new Array(4);let te=!1;const ae=new Int32Array(K.length);for(;B<_;B+=tn.ROW_STEP){let ve=tn.findGuardPattern(w,z,B,A,!1,K,ae);if(ve!=null){for(;B>0;){const je=tn.findGuardPattern(w,z,--B,A,!1,K,ae);if(je!=null)ve=je;else{B++;break}}Q[0]=new _e(ve[0],B),Q[1]=new _e(ve[1],B),te=!0;break}}let me=B+1;if(te){let ve=0,je=Int32Array.from([Math.trunc(Q[0].getX()),Math.trunc(Q[1].getX())]);for(;me<_;me++){const Oe=tn.findGuardPattern(w,je[0],me,A,!1,K,ae);if(Oe!=null&&Math.abs(je[0]-Oe[0])<tn.MAX_PATTERN_DRIFT&&Math.abs(je[1]-Oe[1])<tn.MAX_PATTERN_DRIFT)je=Oe,ve=0;else{if(ve>tn.SKIPPED_ROW_COUNT_MAX)break;ve++}}me-=ve+1,Q[2]=new _e(je[0],me),Q[3]=new _e(je[1],me)}return me-B<tn.BARCODE_MIN_HEIGHT&&y.fill(Q,null),Q}static findGuardPattern(w,_,A,B,z,K,Q){y.fillWithin(Q,0,Q.length,0);let te=_,ae=0;for(;w.get(te,A)&&te>0&&ae++<tn.MAX_PIXEL_DRIFT;)te--;let me=te,ve=0,je=K.length;for(let Oe=z;me<B;me++)if(w.get(me,A)!==Oe)Q[ve]++;else{if(ve===je-1){if(tn.patternMatchVariance(Q,K,tn.MAX_INDIVIDUAL_VARIANCE)<tn.MAX_AVG_VARIANCE)return new Int32Array([te,me]);te+=Q[0]+Q[1],g.arraycopy(Q,2,Q,0,ve-1),Q[ve-1]=0,Q[ve]=0,ve--}else ve++;Q[ve]=1,Oe=!Oe}return ve===je-1&&tn.patternMatchVariance(Q,K,tn.MAX_INDIVIDUAL_VARIANCE)<tn.MAX_AVG_VARIANCE?new Int32Array([te,me-1]):null}static patternMatchVariance(w,_,A){let B=w.length,z=0,K=0;for(let ae=0;ae<B;ae++)z+=w[ae],K+=_[ae];if(z<K)return 1/0;let Q=z/K;A*=Q;let te=0;for(let ae=0;ae<B;ae++){let me=w[ae],ve=_[ae]*Q,je=me>ve?me-ve:ve-me;if(je>A)return 1/0;te+=je}return te/z}}tn.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),tn.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),tn.MAX_AVG_VARIANCE=.42,tn.MAX_INDIVIDUAL_VARIANCE=.8,tn.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),tn.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),tn.MAX_PIXEL_DRIFT=3,tn.MAX_PATTERN_DRIFT=5,tn.SKIPPED_ROW_COUNT_MAX=25,tn.ROW_STEP=5,tn.BARCODE_MIN_HEIGHT=10;class $a{constructor(w,_){if(_.length===0)throw new h;this.field=w;let A=_.length;if(A>1&&_[0]===0){let B=1;for(;B<A&&_[B]===0;)B++;B===A?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(A-B),g.arraycopy(_,B,this.coefficients,0,this.coefficients.length))}else this.coefficients=_}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(w){return this.coefficients[this.coefficients.length-1-w]}evaluateAt(w){if(w===0)return this.getCoefficient(0);if(w===1){let B=0;for(let z of this.coefficients)B=this.field.add(B,z);return B}let _=this.coefficients[0],A=this.coefficients.length;for(let B=1;B<A;B++)_=this.field.add(this.field.multiply(w,_),this.coefficients[B]);return _}add(w){if(!this.field.equals(w.field))throw new h("ModulusPolys do not have same ModulusGF field");if(this.isZero())return w;if(w.isZero())return this;let _=this.coefficients,A=w.coefficients;if(_.length>A.length){let K=_;_=A,A=K}let B=new Int32Array(A.length),z=A.length-_.length;g.arraycopy(A,0,B,0,z);for(let K=z;K<A.length;K++)B[K]=this.field.add(_[K-z],A[K]);return new $a(this.field,B)}subtract(w){if(!this.field.equals(w.field))throw new h("ModulusPolys do not have same ModulusGF field");return w.isZero()?this:this.add(w.negative())}multiply(w){return w instanceof $a?this.multiplyOther(w):this.multiplyScalar(w)}multiplyOther(w){if(!this.field.equals(w.field))throw new h("ModulusPolys do not have same ModulusGF field");if(this.isZero()||w.isZero())return new $a(this.field,new Int32Array([0]));let _=this.coefficients,A=_.length,B=w.coefficients,z=B.length,K=new Int32Array(A+z-1);for(let Q=0;Q<A;Q++){let te=_[Q];for(let ae=0;ae<z;ae++)K[Q+ae]=this.field.add(K[Q+ae],this.field.multiply(te,B[ae]))}return new $a(this.field,K)}negative(){let w=this.coefficients.length,_=new Int32Array(w);for(let A=0;A<w;A++)_[A]=this.field.subtract(0,this.coefficients[A]);return new $a(this.field,_)}multiplyScalar(w){if(w===0)return new $a(this.field,new Int32Array([0]));if(w===1)return this;let _=this.coefficients.length,A=new Int32Array(_);for(let B=0;B<_;B++)A[B]=this.field.multiply(this.coefficients[B],w);return new $a(this.field,A)}multiplyByMonomial(w,_){if(w<0)throw new h;if(_===0)return new $a(this.field,new Int32Array([0]));let A=this.coefficients.length,B=new Int32Array(A+w);for(let z=0;z<A;z++)B[z]=this.field.multiply(this.coefficients[z],_);return new $a(this.field,B)}toString(){let w=new M;for(let _=this.getDegree();_>=0;_--){let A=this.getCoefficient(_);A!==0&&(A<0?(w.append(" - "),A=-A):w.length()>0&&w.append(" + "),(_===0||A!==1)&&w.append(A),_!==0&&(_===1?w.append("x"):(w.append("x^"),w.append(_))))}return w.toString()}}class hte{add(w,_){return(w+_)%this.modulus}subtract(w,_){return(this.modulus+w-_)%this.modulus}exp(w){return this.expTable[w]}log(w){if(w===0)throw new h;return this.logTable[w]}inverse(w){if(w===0)throw new oe;return this.expTable[this.modulus-this.logTable[w]-1]}multiply(w,_){return w===0||_===0?0:this.expTable[(this.logTable[w]+this.logTable[_])%(this.modulus-1)]}getSize(){return this.modulus}equals(w){return w===this}}class gN extends hte{constructor(w,_){super(),this.modulus=w,this.expTable=new Int32Array(w),this.logTable=new Int32Array(w);let A=1;for(let B=0;B<w;B++)this.expTable[B]=A,A=A*_%w;for(let B=0;B<w-1;B++)this.logTable[this.expTable[B]]=B;this.zero=new $a(this,new Int32Array([0])),this.one=new $a(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(w,_){if(w<0)throw new h;if(_===0)return this.zero;let A=new Int32Array(w+1);return A[0]=_,new $a(this,A)}}gN.PDF417_GF=new gN(Dr.NUMBER_OF_CODEWORDS,3);class LT{constructor(){this.field=gN.PDF417_GF}decode(w,_,A){let B=new $a(this.field,w),z=new Int32Array(_),K=!1;for(let Ue=_;Ue>0;Ue--){let He=B.evaluateAt(this.field.exp(Ue));z[_-Ue]=He,He!==0&&(K=!0)}if(!K)return 0;let Q=this.field.getOne();if(A!=null)for(const Ue of A){let He=this.field.exp(w.length-1-Ue),nt=new $a(this.field,new Int32Array([this.field.subtract(0,He),1]));Q=Q.multiply(nt)}let te=new $a(this.field,z),ae=this.runEuclideanAlgorithm(this.field.buildMonomial(_,1),te,_),me=ae[0],ve=ae[1],je=this.findErrorLocations(me),Oe=this.findErrorMagnitudes(ve,me,je);for(let Ue=0;Ue<je.length;Ue++){let He=w.length-1-this.field.log(je[Ue]);if(He<0)throw m.getChecksumInstance();w[He]=this.field.subtract(w[He],Oe[Ue])}return je.length}runEuclideanAlgorithm(w,_,A){if(w.getDegree()<_.getDegree()){let je=w;w=_,_=je}let B=w,z=_,K=this.field.getZero(),Q=this.field.getOne();for(;z.getDegree()>=Math.round(A/2);){let je=B,Oe=K;if(B=z,K=Q,B.isZero())throw m.getChecksumInstance();z=je;let Ue=this.field.getZero(),He=B.getCoefficient(B.getDegree()),nt=this.field.inverse(He);for(;z.getDegree()>=B.getDegree()&&!z.isZero();){let pt=z.getDegree()-B.getDegree(),$t=this.field.multiply(z.getCoefficient(z.getDegree()),nt);Ue=Ue.add(this.field.buildMonomial(pt,$t)),z=z.subtract(B.multiplyByMonomial(pt,$t))}Q=Ue.multiply(K).subtract(Oe).negative()}let te=Q.getCoefficient(0);if(te===0)throw m.getChecksumInstance();let ae=this.field.inverse(te),me=Q.multiply(ae),ve=z.multiply(ae);return[me,ve]}findErrorLocations(w){let _=w.getDegree(),A=new Int32Array(_),B=0;for(let z=1;z<this.field.getSize()&&B<_;z++)w.evaluateAt(z)===0&&(A[B]=this.field.inverse(z),B++);if(B!==_)throw m.getChecksumInstance();return A}findErrorMagnitudes(w,_,A){let B=_.getDegree(),z=new Int32Array(B);for(let ae=1;ae<=B;ae++)z[B-ae]=this.field.multiply(ae,_.getCoefficient(ae));let K=new $a(this.field,z),Q=A.length,te=new Int32Array(Q);for(let ae=0;ae<Q;ae++){let me=this.field.inverse(A[ae]),ve=this.field.subtract(0,w.evaluateAt(me)),je=this.field.inverse(K.evaluateAt(me));te[ae]=this.field.multiply(ve,je)}return te}}class th{constructor(w,_,A,B,z){w instanceof th?this.constructor_2(w):this.constructor_1(w,_,A,B,z)}constructor_1(w,_,A,B,z){const K=_==null||A==null,Q=B==null||z==null;if(K&&Q)throw new S;K?(_=new _e(0,B.getY()),A=new _e(0,z.getY())):Q&&(B=new _e(w.getWidth()-1,_.getY()),z=new _e(w.getWidth()-1,A.getY())),this.image=w,this.topLeft=_,this.bottomLeft=A,this.topRight=B,this.bottomRight=z,this.minX=Math.trunc(Math.min(_.getX(),A.getX())),this.maxX=Math.trunc(Math.max(B.getX(),z.getX())),this.minY=Math.trunc(Math.min(_.getY(),B.getY())),this.maxY=Math.trunc(Math.max(A.getY(),z.getY()))}constructor_2(w){this.image=w.image,this.topLeft=w.getTopLeft(),this.bottomLeft=w.getBottomLeft(),this.topRight=w.getTopRight(),this.bottomRight=w.getBottomRight(),this.minX=w.getMinX(),this.maxX=w.getMaxX(),this.minY=w.getMinY(),this.maxY=w.getMaxY()}static merge(w,_){return w==null?_:_==null?w:new th(w.image,w.topLeft,w.bottomLeft,_.topRight,_.bottomRight)}addMissingRows(w,_,A){let B=this.topLeft,z=this.bottomLeft,K=this.topRight,Q=this.bottomRight;if(w>0){let te=A?this.topLeft:this.topRight,ae=Math.trunc(te.getY()-w);ae<0&&(ae=0);let me=new _e(te.getX(),ae);A?B=me:K=me}if(_>0){let te=A?this.bottomLeft:this.bottomRight,ae=Math.trunc(te.getY()+_);ae>=this.image.getHeight()&&(ae=this.image.getHeight()-1);let me=new _e(te.getX(),ae);A?z=me:Q=me}return new th(this.image,B,z,K,Q)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class fte{constructor(w,_,A,B){this.columnCount=w,this.errorCorrectionLevel=B,this.rowCountUpperPart=_,this.rowCountLowerPart=A,this.rowCount=_+A}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Jg{constructor(){this.buffer=""}static form(w,_){let A=-1;function B(K,Q,te,ae,me,ve){if(K==="%%")return"%";if(_[++A]===void 0)return;K=ae?parseInt(ae.substr(1)):void 0;let je=me?parseInt(me.substr(1)):void 0,Oe;switch(ve){case"s":Oe=_[A];break;case"c":Oe=_[A][0];break;case"f":Oe=parseFloat(_[A]).toFixed(K);break;case"p":Oe=parseFloat(_[A]).toPrecision(K);break;case"e":Oe=parseFloat(_[A]).toExponential(K);break;case"x":Oe=parseInt(_[A]).toString(je||16);break;case"d":Oe=parseFloat(parseInt(_[A],je||10).toPrecision(K)).toFixed(0);break}Oe=typeof Oe=="object"?JSON.stringify(Oe):(+Oe).toString(je);let Ue=parseInt(te),He=te&&te[0]+""=="0"?"0":" ";for(;Oe.length<Ue;)Oe=Q!==void 0?Oe+He:He+Oe;return Oe}let z=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return w.replace(z,B)}format(w,..._){this.buffer+=Jg.form(w,_)}toString(){return this.buffer}}class e0{constructor(w){this.boundingBox=new th(w),this.codewords=new Array(w.getMaxY()-w.getMinY()+1)}getCodewordNearby(w){let _=this.getCodeword(w);if(_!=null)return _;for(let A=1;A<e0.MAX_NEARBY_DISTANCE;A++){let B=this.imageRowToCodewordIndex(w)-A;if(B>=0&&(_=this.codewords[B],_!=null)||(B=this.imageRowToCodewordIndex(w)+A,B<this.codewords.length&&(_=this.codewords[B],_!=null)))return _}return null}imageRowToCodewordIndex(w){return w-this.boundingBox.getMinY()}setCodeword(w,_){this.codewords[this.imageRowToCodewordIndex(w)]=_}getCodeword(w){return this.codewords[this.imageRowToCodewordIndex(w)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const w=new Jg;let _=0;for(const A of this.codewords){if(A==null){w.format("%3d:    |   %n",_++);continue}w.format("%3d: %3d|%3d%n",_++,A.getRowNumber(),A.getValue())}return w.toString()}}e0.MAX_NEARBY_DISTANCE=5;class t0{constructor(){this.values=new Map}setValue(w){w=Math.trunc(w);let _=this.values.get(w);_==null&&(_=0),_++,this.values.set(w,_)}getValue(){let w=-1,_=new Array;for(const[A,B]of this.values.entries()){const z={getKey:()=>A,getValue:()=>B};z.getValue()>w?(w=z.getValue(),_=[],_.push(z.getKey())):z.getValue()===w&&_.push(z.getKey())}return Dr.toIntArray(_)}getConfidence(w){return this.values.get(w)}}class BT extends e0{constructor(w,_){super(w),this._isLeft=_}setRowNumbers(){for(let w of this.getCodewords())w!=null&&w.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(w){let _=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(_,w);let A=this.getBoundingBox(),B=this._isLeft?A.getTopLeft():A.getTopRight(),z=this._isLeft?A.getBottomLeft():A.getBottomRight(),K=this.imageRowToCodewordIndex(Math.trunc(B.getY())),Q=this.imageRowToCodewordIndex(Math.trunc(z.getY())),te=-1,ae=1,me=0;for(let ve=K;ve<Q;ve++){if(_[ve]==null)continue;let je=_[ve],Oe=je.getRowNumber()-te;if(Oe===0)me++;else if(Oe===1)ae=Math.max(ae,me),me=1,te=je.getRowNumber();else if(Oe<0||je.getRowNumber()>=w.getRowCount()||Oe>ve)_[ve]=null;else{let Ue;ae>2?Ue=(ae-2)*Oe:Ue=Oe;let He=Ue>=ve;for(let nt=1;nt<=Ue&&!He;nt++)He=_[ve-nt]!=null;He?_[ve]=null:(te=je.getRowNumber(),me=1)}}}getRowHeights(){let w=this.getBarcodeMetadata();if(w==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(w);let _=new Int32Array(w.getRowCount());for(let A of this.getCodewords())if(A!=null){let B=A.getRowNumber();if(B>=_.length)continue;_[B]++}return _}adjustIncompleteIndicatorColumnRowNumbers(w){let _=this.getBoundingBox(),A=this._isLeft?_.getTopLeft():_.getTopRight(),B=this._isLeft?_.getBottomLeft():_.getBottomRight(),z=this.imageRowToCodewordIndex(Math.trunc(A.getY())),K=this.imageRowToCodewordIndex(Math.trunc(B.getY())),Q=this.getCodewords(),te=-1;for(let ae=z;ae<K;ae++){if(Q[ae]==null)continue;let me=Q[ae];me.setRowNumberAsRowIndicatorColumn();let ve=me.getRowNumber()-te;ve===0||(ve===1?te=me.getRowNumber():me.getRowNumber()>=w.getRowCount()?Q[ae]=null:te=me.getRowNumber())}}getBarcodeMetadata(){let w=this.getCodewords(),_=new t0,A=new t0,B=new t0,z=new t0;for(let Q of w){if(Q==null)continue;Q.setRowNumberAsRowIndicatorColumn();let te=Q.getValue()%30,ae=Q.getRowNumber();switch(this._isLeft||(ae+=2),ae%3){case 0:A.setValue(te*3+1);break;case 1:z.setValue(te/3),B.setValue(te%3);break;case 2:_.setValue(te+1);break}}if(_.getValue().length===0||A.getValue().length===0||B.getValue().length===0||z.getValue().length===0||_.getValue()[0]<1||A.getValue()[0]+B.getValue()[0]<Dr.MIN_ROWS_IN_BARCODE||A.getValue()[0]+B.getValue()[0]>Dr.MAX_ROWS_IN_BARCODE)return null;let K=new fte(_.getValue()[0],A.getValue()[0],B.getValue()[0],z.getValue()[0]);return this.removeIncorrectCodewords(w,K),K}removeIncorrectCodewords(w,_){for(let A=0;A<w.length;A++){let B=w[A];if(w[A]==null)continue;let z=B.getValue()%30,K=B.getRowNumber();if(K>_.getRowCount()){w[A]=null;continue}switch(this._isLeft||(K+=2),K%3){case 0:z*3+1!==_.getRowCountUpperPart()&&(w[A]=null);break;case 1:(Math.trunc(z/3)!==_.getErrorCorrectionLevel()||z%3!==_.getRowCountLowerPart())&&(w[A]=null);break;case 2:z+1!==_.getColumnCount()&&(w[A]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class r0{constructor(w,_){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=w,this.barcodeColumnCount=w.getColumnCount(),this.boundingBox=_,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let w=Dr.MAX_CODEWORDS_IN_BARCODE,_;do _=w,w=this.adjustRowNumbersAndGetCount();while(w>0&&w<_);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(w){w!=null&&w.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let w=this.adjustRowNumbersByRow();if(w===0)return 0;for(let _=1;_<this.barcodeColumnCount+1;_++){let A=this.detectionResultColumns[_].getCodewords();for(let B=0;B<A.length;B++)A[B]!=null&&(A[B].hasValidRowNumber()||this.adjustRowNumbers(_,B,A))}return w}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let w=this.detectionResultColumns[0].getCodewords(),_=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let A=0;A<w.length;A++)if(w[A]!=null&&_[A]!=null&&w[A].getRowNumber()===_[A].getRowNumber())for(let B=1;B<=this.barcodeColumnCount;B++){let z=this.detectionResultColumns[B].getCodewords()[A];z!=null&&(z.setRowNumber(w[A].getRowNumber()),z.hasValidRowNumber()||(this.detectionResultColumns[B].getCodewords()[A]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let w=0,_=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let A=0;A<_.length;A++){if(_[A]==null)continue;let B=_[A].getRowNumber(),z=0;for(let K=this.barcodeColumnCount+1;K>0&&z<this.ADJUST_ROW_NUMBER_SKIP;K--){let Q=this.detectionResultColumns[K].getCodewords()[A];Q!=null&&(z=r0.adjustRowNumberIfValid(B,z,Q),Q.hasValidRowNumber()||w++)}}return w}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let w=0,_=this.detectionResultColumns[0].getCodewords();for(let A=0;A<_.length;A++){if(_[A]==null)continue;let B=_[A].getRowNumber(),z=0;for(let K=1;K<this.barcodeColumnCount+1&&z<this.ADJUST_ROW_NUMBER_SKIP;K++){let Q=this.detectionResultColumns[K].getCodewords()[A];Q!=null&&(z=r0.adjustRowNumberIfValid(B,z,Q),Q.hasValidRowNumber()||w++)}}return w}static adjustRowNumberIfValid(w,_,A){return A==null||A.hasValidRowNumber()||(A.isValidRowNumber(w)?(A.setRowNumber(w),_=0):++_),_}adjustRowNumbers(w,_,A){if(!this.detectionResultColumns[w-1])return;let B=A[_],z=this.detectionResultColumns[w-1].getCodewords(),K=z;this.detectionResultColumns[w+1]!=null&&(K=this.detectionResultColumns[w+1].getCodewords());let Q=new Array(14);Q[2]=z[_],Q[3]=K[_],_>0&&(Q[0]=A[_-1],Q[4]=z[_-1],Q[5]=K[_-1]),_>1&&(Q[8]=A[_-2],Q[10]=z[_-2],Q[11]=K[_-2]),_<A.length-1&&(Q[1]=A[_+1],Q[6]=z[_+1],Q[7]=K[_+1]),_<A.length-2&&(Q[9]=A[_+2],Q[12]=z[_+2],Q[13]=K[_+2]);for(let te of Q)if(r0.adjustRowNumber(B,te))return}static adjustRowNumber(w,_){return _==null?!1:_.hasValidRowNumber()&&_.getBucket()===w.getBucket()?(w.setRowNumber(_.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(w){this.boundingBox=w}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(w,_){this.detectionResultColumns[w]=_}getDetectionResultColumn(w){return this.detectionResultColumns[w]}toString(){let w=this.detectionResultColumns[0];w==null&&(w=this.detectionResultColumns[this.barcodeColumnCount+1]);let _=new Jg;for(let A=0;A<w.getCodewords().length;A++){_.format("CW %3d:",A);for(let B=0;B<this.barcodeColumnCount+2;B++){if(this.detectionResultColumns[B]==null){_.format("    |   ");continue}let z=this.detectionResultColumns[B].getCodewords()[A];if(z==null){_.format("    |   ");continue}_.format(" %3d|%3d",z.getRowNumber(),z.getValue())}_.format("%n")}return _.toString()}}class n0{constructor(w,_,A,B){this.rowNumber=n0.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(w),this.endX=Math.trunc(_),this.bucket=Math.trunc(A),this.value=Math.trunc(B)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(w){return w!==n0.BARCODE_ROW_UNKNOWN&&this.bucket===w%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(w){this.rowNumber=w}toString(){return this.rowNumber+"|"+this.value}}n0.BARCODE_ROW_UNKNOWN=-1;class Mi{static initialize(){for(let w=0;w<Dr.SYMBOL_TABLE.length;w++){let _=Dr.SYMBOL_TABLE[w],A=_&1;for(let B=0;B<Dr.BARS_IN_MODULE;B++){let z=0;for(;(_&1)===A;)z+=1,_>>=1;A=_&1,Mi.RATIOS_TABLE[w]||(Mi.RATIOS_TABLE[w]=new Array(Dr.BARS_IN_MODULE)),Mi.RATIOS_TABLE[w][Dr.BARS_IN_MODULE-B-1]=Math.fround(z/Dr.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(w){let _=Mi.getDecodedCodewordValue(Mi.sampleBitCounts(w));return _!==-1?_:Mi.getClosestDecodedValue(w)}static sampleBitCounts(w){let _=ge.sum(w),A=new Int32Array(Dr.BARS_IN_MODULE),B=0,z=0;for(let K=0;K<Dr.MODULES_IN_CODEWORD;K++){let Q=_/(2*Dr.MODULES_IN_CODEWORD)+K*_/Dr.MODULES_IN_CODEWORD;z+w[B]<=Q&&(z+=w[B],B++),A[B]++}return A}static getDecodedCodewordValue(w){let _=Mi.getBitValue(w);return Dr.getCodeword(_)===-1?-1:_}static getBitValue(w){let _=0;for(let A=0;A<w.length;A++)for(let B=0;B<w[A];B++)_=_<<1|(A%2===0?1:0);return Math.trunc(_)}static getClosestDecodedValue(w){let _=ge.sum(w),A=new Array(Dr.BARS_IN_MODULE);if(_>1)for(let K=0;K<A.length;K++)A[K]=Math.fround(w[K]/_);let B=Ne.MAX_VALUE,z=-1;this.bSymbolTableReady||Mi.initialize();for(let K=0;K<Mi.RATIOS_TABLE.length;K++){let Q=0,te=Mi.RATIOS_TABLE[K];for(let ae=0;ae<Dr.BARS_IN_MODULE;ae++){let me=Math.fround(te[ae]-A[ae]);if(Q+=Math.fround(me*me),Q>=B)break}Q<B&&(B=Q,z=Dr.SYMBOL_TABLE[K])}return z}}Mi.bSymbolTableReady=!1,Mi.RATIOS_TABLE=new Array(Dr.SYMBOL_TABLE.length).map(xe=>new Array(Dr.BARS_IN_MODULE));class $T{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(w){this.segmentIndex=w}getFileId(){return this.fileId}setFileId(w){this.fileId=w}getOptionalData(){return this.optionalData}setOptionalData(w){this.optionalData=w}isLastSegment(){return this.lastSegment}setLastSegment(w){this.lastSegment=w}getSegmentCount(){return this.segmentCount}setSegmentCount(w){this.segmentCount=w}getSender(){return this.sender||null}setSender(w){this.sender=w}getAddressee(){return this.addressee||null}setAddressee(w){this.addressee=w}getFileName(){return this.fileName}setFileName(w){this.fileName=w}getFileSize(){return this.fileSize}setFileSize(w){this.fileSize=w}getChecksum(){return this.checksum}setChecksum(w){this.checksum=w}getTimestamp(){return this.timestamp}setTimestamp(w){this.timestamp=w}}class FT{static parseLong(w,_=void 0){return parseInt(w,_)}}class zT extends l{}zT.kind="NullPointerException";class mte{writeBytes(w){this.writeBytesOffset(w,0,w.length)}writeBytesOffset(w,_,A){if(w==null)throw new zT;if(_<0||_>w.length||A<0||_+A>w.length||_+A<0)throw new v;if(A===0)return;for(let B=0;B<A;B++)this.write(w[_+B])}flush(){}close(){}}class pte extends l{}class gte extends mte{constructor(w=32){if(super(),this.count=0,w<0)throw new h("Negative initial size: "+w);this.buf=new Uint8Array(w)}ensureCapacity(w){w-this.buf.length>0&&this.grow(w)}grow(w){let A=this.buf.length<<1;if(A-w<0&&(A=w),A<0){if(w<0)throw new pte;A=b.MAX_VALUE}this.buf=y.copyOfUint8Array(this.buf,A)}write(w){this.ensureCapacity(this.count+1),this.buf[this.count]=w,this.count+=1}writeBytesOffset(w,_,A){if(_<0||_>w.length||A<0||_+A-w.length>0)throw new v;this.ensureCapacity(this.count+A),g.arraycopy(w,_,this.buf,this.count,A),this.count+=A}writeTo(w){w.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return y.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(w){return w?typeof w=="string"?this.toString_string(w):this.toString_number(w):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(w){return new String(this.buf).toString()}toString_number(w){return new String(this.buf).toString()}close(){}}var zn;(function(xe){xe[xe.ALPHA=0]="ALPHA",xe[xe.LOWER=1]="LOWER",xe[xe.MIXED=2]="MIXED",xe[xe.PUNCT=3]="PUNCT",xe[xe.ALPHA_SHIFT=4]="ALPHA_SHIFT",xe[xe.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(zn||(zn={}));function UT(){if(typeof window<"u")return window.BigInt||null;if(typeof Ur<"u")return Ur.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let ey;function Od(xe){if(typeof ey>"u"&&(ey=UT()),ey===null)throw new Error("BigInt is not supported!");return ey(xe)}function xte(){let xe=[];xe[0]=Od(1);let w=Od(900);xe[1]=w;for(let _=2;_<16;_++)xe[_]=xe[_-1]*w;return xe}class ft{static decode(w,_){let A=new M(""),B=L.ISO8859_1;A.enableDecoding(B);let z=1,K=w[z++],Q=new $T;for(;z<w[0];){switch(K){case ft.TEXT_COMPACTION_MODE_LATCH:z=ft.textCompaction(w,z,A);break;case ft.BYTE_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH_6:z=ft.byteCompaction(K,w,B,z,A);break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:A.append(w[z++]);break;case ft.NUMERIC_COMPACTION_MODE_LATCH:z=ft.numericCompaction(w,z,A);break;case ft.ECI_CHARSET:L.getCharacterSetECIByValue(w[z++]);break;case ft.ECI_GENERAL_PURPOSE:z+=2;break;case ft.ECI_USER_DEFINED:z++;break;case ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK:z=ft.decodeMacroBlock(w,z,Q);break;case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ft.MACRO_PDF417_TERMINATOR:throw new R;default:z--,z=ft.textCompaction(w,z,A);break}if(z<w.length)K=w[z++];else throw R.getFormatInstance()}if(A.length()===0)throw R.getFormatInstance();let te=new W(null,A.toString(),null,_);return te.setOther(Q),te}static decodeMacroBlock(w,_,A){if(_+ft.NUMBER_OF_SEQUENCE_CODEWORDS>w[0])throw R.getFormatInstance();let B=new Int32Array(ft.NUMBER_OF_SEQUENCE_CODEWORDS);for(let Q=0;Q<ft.NUMBER_OF_SEQUENCE_CODEWORDS;Q++,_++)B[Q]=w[_];A.setSegmentIndex(b.parseInt(ft.decodeBase900toBase10(B,ft.NUMBER_OF_SEQUENCE_CODEWORDS)));let z=new M;_=ft.textCompaction(w,_,z),A.setFileId(z.toString());let K=-1;for(w[_]===ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(K=_+1);_<w[0];)switch(w[_]){case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(_++,w[_]){case ft.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let Q=new M;_=ft.textCompaction(w,_+1,Q),A.setFileName(Q.toString());break;case ft.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let te=new M;_=ft.textCompaction(w,_+1,te),A.setSender(te.toString());break;case ft.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let ae=new M;_=ft.textCompaction(w,_+1,ae),A.setAddressee(ae.toString());break;case ft.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let me=new M;_=ft.numericCompaction(w,_+1,me),A.setSegmentCount(b.parseInt(me.toString()));break;case ft.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let ve=new M;_=ft.numericCompaction(w,_+1,ve),A.setTimestamp(FT.parseLong(ve.toString()));break;case ft.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let je=new M;_=ft.numericCompaction(w,_+1,je),A.setChecksum(b.parseInt(je.toString()));break;case ft.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let Oe=new M;_=ft.numericCompaction(w,_+1,Oe),A.setFileSize(FT.parseLong(Oe.toString()));break;default:throw R.getFormatInstance()}break;case ft.MACRO_PDF417_TERMINATOR:_++,A.setLastSegment(!0);break;default:throw R.getFormatInstance()}if(K!==-1){let Q=_-K;A.isLastSegment()&&Q--,A.setOptionalData(y.copyOfRange(w,K,K+Q))}return _}static textCompaction(w,_,A){let B=new Int32Array((w[0]-_)*2),z=new Int32Array((w[0]-_)*2),K=0,Q=!1;for(;_<w[0]&&!Q;){let te=w[_++];if(te<ft.TEXT_COMPACTION_MODE_LATCH)B[K]=te/30,B[K+1]=te%30,K+=2;else switch(te){case ft.TEXT_COMPACTION_MODE_LATCH:B[K++]=ft.TEXT_COMPACTION_MODE_LATCH;break;case ft.BYTE_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH_6:case ft.NUMERIC_COMPACTION_MODE_LATCH:case ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ft.MACRO_PDF417_TERMINATOR:_--,Q=!0;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:B[K]=ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,te=w[_++],z[K]=te,K++;break}}return ft.decodeTextCompaction(B,z,K,A),_}static decodeTextCompaction(w,_,A,B){let z=zn.ALPHA,K=zn.ALPHA,Q=0;for(;Q<A;){let te=w[Q],ae="";switch(z){case zn.ALPHA:if(te<26)ae=String.fromCharCode(65+te);else switch(te){case 26:ae=" ";break;case ft.LL:z=zn.LOWER;break;case ft.ML:z=zn.MIXED;break;case ft.PS:K=z,z=zn.PUNCT_SHIFT;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:B.append(_[Q]);break;case ft.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break;case zn.LOWER:if(te<26)ae=String.fromCharCode(97+te);else switch(te){case 26:ae=" ";break;case ft.AS:K=z,z=zn.ALPHA_SHIFT;break;case ft.ML:z=zn.MIXED;break;case ft.PS:K=z,z=zn.PUNCT_SHIFT;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:B.append(_[Q]);break;case ft.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break;case zn.MIXED:if(te<ft.PL)ae=ft.MIXED_CHARS[te];else switch(te){case ft.PL:z=zn.PUNCT;break;case 26:ae=" ";break;case ft.LL:z=zn.LOWER;break;case ft.AL:z=zn.ALPHA;break;case ft.PS:K=z,z=zn.PUNCT_SHIFT;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:B.append(_[Q]);break;case ft.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break;case zn.PUNCT:if(te<ft.PAL)ae=ft.PUNCT_CHARS[te];else switch(te){case ft.PAL:z=zn.ALPHA;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:B.append(_[Q]);break;case ft.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break;case zn.ALPHA_SHIFT:if(z=K,te<26)ae=String.fromCharCode(65+te);else switch(te){case 26:ae=" ";break;case ft.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break;case zn.PUNCT_SHIFT:if(z=K,te<ft.PAL)ae=ft.PUNCT_CHARS[te];else switch(te){case ft.PAL:z=zn.ALPHA;break;case ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:B.append(_[Q]);break;case ft.TEXT_COMPACTION_MODE_LATCH:z=zn.ALPHA;break}break}ae!==""&&B.append(ae),Q++}}static byteCompaction(w,_,A,B,z){let K=new gte,Q=0,te=0,ae=!1;switch(w){case ft.BYTE_COMPACTION_MODE_LATCH:let me=new Int32Array(6),ve=_[B++];for(;B<_[0]&&!ae;)switch(me[Q++]=ve,te=900*te+ve,ve=_[B++],ve){case ft.TEXT_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH:case ft.NUMERIC_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH_6:case ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ft.MACRO_PDF417_TERMINATOR:B--,ae=!0;break;default:if(Q%5===0&&Q>0){for(let je=0;je<6;++je)K.write(Number(Od(te)>>Od(8*(5-je))));te=0,Q=0}break}B===_[0]&&ve<ft.TEXT_COMPACTION_MODE_LATCH&&(me[Q++]=ve);for(let je=0;je<Q;je++)K.write(me[je]);break;case ft.BYTE_COMPACTION_MODE_LATCH_6:for(;B<_[0]&&!ae;){let je=_[B++];if(je<ft.TEXT_COMPACTION_MODE_LATCH)Q++,te=900*te+je;else switch(je){case ft.TEXT_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH:case ft.NUMERIC_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH_6:case ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ft.MACRO_PDF417_TERMINATOR:B--,ae=!0;break}if(Q%5===0&&Q>0){for(let Oe=0;Oe<6;++Oe)K.write(Number(Od(te)>>Od(8*(5-Oe))));te=0,Q=0}}break}return z.append(X.decode(K.toByteArray(),A)),B}static numericCompaction(w,_,A){let B=0,z=!1,K=new Int32Array(ft.MAX_NUMERIC_CODEWORDS);for(;_<w[0]&&!z;){let Q=w[_++];if(_===w[0]&&(z=!0),Q<ft.TEXT_COMPACTION_MODE_LATCH)K[B]=Q,B++;else switch(Q){case ft.TEXT_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH:case ft.BYTE_COMPACTION_MODE_LATCH_6:case ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case ft.MACRO_PDF417_TERMINATOR:_--,z=!0;break}(B%ft.MAX_NUMERIC_CODEWORDS===0||Q===ft.NUMERIC_COMPACTION_MODE_LATCH||z)&&B>0&&(A.append(ft.decodeBase900toBase10(K,B)),B=0)}return _}static decodeBase900toBase10(w,_){let A=Od(0);for(let z=0;z<_;z++)A+=ft.EXP900[_-z-1]*Od(w[z]);let B=A.toString();if(B.charAt(0)!=="1")throw new R;return B.substring(1)}}ft.TEXT_COMPACTION_MODE_LATCH=900,ft.BYTE_COMPACTION_MODE_LATCH=901,ft.NUMERIC_COMPACTION_MODE_LATCH=902,ft.BYTE_COMPACTION_MODE_LATCH_6=924,ft.ECI_USER_DEFINED=925,ft.ECI_GENERAL_PURPOSE=926,ft.ECI_CHARSET=927,ft.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,ft.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,ft.MACRO_PDF417_TERMINATOR=922,ft.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,ft.MAX_NUMERIC_CODEWORDS=15,ft.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,ft.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,ft.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,ft.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,ft.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,ft.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,ft.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,ft.PL=25,ft.LL=27,ft.AS=27,ft.ML=28,ft.AL=28,ft.PS=29,ft.PAL=29,ft.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,ft.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",ft.EXP900=UT()?xte():[],ft.NUMBER_OF_SEQUENCE_CODEWORDS=2;class rn{constructor(){}static decode(w,_,A,B,z,K,Q){let te=new th(w,_,A,B,z),ae=null,me=null,ve;for(let Ue=!0;;Ue=!1){if(_!=null&&(ae=rn.getRowIndicatorColumn(w,te,_,!0,K,Q)),B!=null&&(me=rn.getRowIndicatorColumn(w,te,B,!1,K,Q)),ve=rn.merge(ae,me),ve==null)throw S.getNotFoundInstance();let He=ve.getBoundingBox();if(Ue&&He!=null&&(He.getMinY()<te.getMinY()||He.getMaxY()>te.getMaxY()))te=He;else break}ve.setBoundingBox(te);let je=ve.getBarcodeColumnCount()+1;ve.setDetectionResultColumn(0,ae),ve.setDetectionResultColumn(je,me);let Oe=ae!=null;for(let Ue=1;Ue<=je;Ue++){let He=Oe?Ue:je-Ue;if(ve.getDetectionResultColumn(He)!==void 0)continue;let nt;He===0||He===je?nt=new BT(te,He===0):nt=new e0(te),ve.setDetectionResultColumn(He,nt);let pt=-1,$t=pt;for(let Ft=te.getMinY();Ft<=te.getMaxY();Ft++){if(pt=rn.getStartColumn(ve,He,Ft,Oe),pt<0||pt>te.getMaxX()){if($t===-1)continue;pt=$t}let Rt=rn.detectCodeword(w,te.getMinX(),te.getMaxX(),Oe,pt,Ft,K,Q);Rt!=null&&(nt.setCodeword(Ft,Rt),$t=pt,K=Math.min(K,Rt.getWidth()),Q=Math.max(Q,Rt.getWidth()))}}return rn.createDecoderResult(ve)}static merge(w,_){if(w==null&&_==null)return null;let A=rn.getBarcodeMetadata(w,_);if(A==null)return null;let B=th.merge(rn.adjustBoundingBox(w),rn.adjustBoundingBox(_));return new r0(A,B)}static adjustBoundingBox(w){if(w==null)return null;let _=w.getRowHeights();if(_==null)return null;let A=rn.getMax(_),B=0;for(let Q of _)if(B+=A-Q,Q>0)break;let z=w.getCodewords();for(let Q=0;B>0&&z[Q]==null;Q++)B--;let K=0;for(let Q=_.length-1;Q>=0&&(K+=A-_[Q],!(_[Q]>0));Q--);for(let Q=z.length-1;K>0&&z[Q]==null;Q--)K--;return w.getBoundingBox().addMissingRows(B,K,w.isLeft())}static getMax(w){let _=-1;for(let A of w)_=Math.max(_,A);return _}static getBarcodeMetadata(w,_){let A;if(w==null||(A=w.getBarcodeMetadata())==null)return _==null?null:_.getBarcodeMetadata();let B;return _==null||(B=_.getBarcodeMetadata())==null?A:A.getColumnCount()!==B.getColumnCount()&&A.getErrorCorrectionLevel()!==B.getErrorCorrectionLevel()&&A.getRowCount()!==B.getRowCount()?null:A}static getRowIndicatorColumn(w,_,A,B,z,K){let Q=new BT(_,B);for(let te=0;te<2;te++){let ae=te===0?1:-1,me=Math.trunc(Math.trunc(A.getX()));for(let ve=Math.trunc(Math.trunc(A.getY()));ve<=_.getMaxY()&&ve>=_.getMinY();ve+=ae){let je=rn.detectCodeword(w,0,w.getWidth(),B,me,ve,z,K);je!=null&&(Q.setCodeword(ve,je),B?me=je.getStartX():me=je.getEndX())}}return Q}static adjustCodewordCount(w,_){let A=_[0][1],B=A.getValue(),z=w.getBarcodeColumnCount()*w.getBarcodeRowCount()-rn.getNumberOfECCodeWords(w.getBarcodeECLevel());if(B.length===0){if(z<1||z>Dr.MAX_CODEWORDS_IN_BARCODE)throw S.getNotFoundInstance();A.setValue(z)}else B[0]!==z&&A.setValue(z)}static createDecoderResult(w){let _=rn.createBarcodeMatrix(w);rn.adjustCodewordCount(w,_);let A=new Array,B=new Int32Array(w.getBarcodeRowCount()*w.getBarcodeColumnCount()),z=[],K=new Array;for(let te=0;te<w.getBarcodeRowCount();te++)for(let ae=0;ae<w.getBarcodeColumnCount();ae++){let me=_[te][ae+1].getValue(),ve=te*w.getBarcodeColumnCount()+ae;me.length===0?A.push(ve):me.length===1?B[ve]=me[0]:(K.push(ve),z.push(me))}let Q=new Array(z.length);for(let te=0;te<Q.length;te++)Q[te]=z[te];return rn.createDecoderResultFromAmbiguousValues(w.getBarcodeECLevel(),B,Dr.toIntArray(A),Dr.toIntArray(K),Q)}static createDecoderResultFromAmbiguousValues(w,_,A,B,z){let K=new Int32Array(B.length),Q=100;for(;Q-- >0;){for(let te=0;te<K.length;te++)_[B[te]]=z[te][K[te]];try{return rn.decodeCodewords(_,w,A)}catch(te){if(!(te instanceof m))throw te}if(K.length===0)throw m.getChecksumInstance();for(let te=0;te<K.length;te++)if(K[te]<z[te].length-1){K[te]++;break}else if(K[te]=0,te===K.length-1)throw m.getChecksumInstance()}throw m.getChecksumInstance()}static createBarcodeMatrix(w){let _=Array.from({length:w.getBarcodeRowCount()},()=>new Array(w.getBarcodeColumnCount()+2));for(let B=0;B<_.length;B++)for(let z=0;z<_[B].length;z++)_[B][z]=new t0;let A=0;for(let B of w.getDetectionResultColumns()){if(B!=null){for(let z of B.getCodewords())if(z!=null){let K=z.getRowNumber();if(K>=0){if(K>=_.length)continue;_[K][A].setValue(z.getValue())}}}A++}return _}static isValidBarcodeColumn(w,_){return _>=0&&_<=w.getBarcodeColumnCount()+1}static getStartColumn(w,_,A,B){let z=B?1:-1,K=null;if(rn.isValidBarcodeColumn(w,_-z)&&(K=w.getDetectionResultColumn(_-z).getCodeword(A)),K!=null)return B?K.getEndX():K.getStartX();if(K=w.getDetectionResultColumn(_).getCodewordNearby(A),K!=null)return B?K.getStartX():K.getEndX();if(rn.isValidBarcodeColumn(w,_-z)&&(K=w.getDetectionResultColumn(_-z).getCodewordNearby(A)),K!=null)return B?K.getEndX():K.getStartX();let Q=0;for(;rn.isValidBarcodeColumn(w,_-z);){_-=z;for(let te of w.getDetectionResultColumn(_).getCodewords())if(te!=null)return(B?te.getEndX():te.getStartX())+z*Q*(te.getEndX()-te.getStartX());Q++}return B?w.getBoundingBox().getMinX():w.getBoundingBox().getMaxX()}static detectCodeword(w,_,A,B,z,K,Q,te){z=rn.adjustCodewordStartColumn(w,_,A,B,z,K);let ae=rn.getModuleBitCount(w,_,A,B,z,K);if(ae==null)return null;let me,ve=ge.sum(ae);if(B)me=z+ve;else{for(let Ue=0;Ue<ae.length/2;Ue++){let He=ae[Ue];ae[Ue]=ae[ae.length-1-Ue],ae[ae.length-1-Ue]=He}me=z,z=me-ve}if(!rn.checkCodewordSkew(ve,Q,te))return null;let je=Mi.getDecodedValue(ae),Oe=Dr.getCodeword(je);return Oe===-1?null:new n0(z,me,rn.getCodewordBucketNumber(je),Oe)}static getModuleBitCount(w,_,A,B,z,K){let Q=z,te=new Int32Array(8),ae=0,me=B?1:-1,ve=B;for(;(B?Q<A:Q>=_)&&ae<te.length;)w.get(Q,K)===ve?(te[ae]++,Q+=me):(ae++,ve=!ve);return ae===te.length||Q===(B?A:_)&&ae===te.length-1?te:null}static getNumberOfECCodeWords(w){return 2<<w}static adjustCodewordStartColumn(w,_,A,B,z,K){let Q=z,te=B?-1:1;for(let ae=0;ae<2;ae++){for(;(B?Q>=_:Q<A)&&B===w.get(Q,K);){if(Math.abs(z-Q)>rn.CODEWORD_SKEW_SIZE)return z;Q+=te}te=-te,B=!B}return Q}static checkCodewordSkew(w,_,A){return _-rn.CODEWORD_SKEW_SIZE<=w&&w<=A+rn.CODEWORD_SKEW_SIZE}static decodeCodewords(w,_,A){if(w.length===0)throw R.getFormatInstance();let B=1<<_+1,z=rn.correctErrors(w,A,B);rn.verifyCodewordCount(w,B);let K=ft.decode(w,""+_);return K.setErrorsCorrected(z),K.setErasures(A.length),K}static correctErrors(w,_,A){if(_!=null&&_.length>A/2+rn.MAX_ERRORS||A<0||A>rn.MAX_EC_CODEWORDS)throw m.getChecksumInstance();return rn.errorCorrection.decode(w,A,_)}static verifyCodewordCount(w,_){if(w.length<4)throw R.getFormatInstance();let A=w[0];if(A>w.length)throw R.getFormatInstance();if(A===0)if(_<w.length)w[0]=w.length-_;else throw R.getFormatInstance()}static getBitCountForCodeword(w){let _=new Int32Array(8),A=0,B=_.length-1;for(;!((w&1)!==A&&(A=w&1,B--,B<0));)_[B]++,w>>=1;return _}static getCodewordBucketNumber(w){return w instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(w):this.getCodewordBucketNumber_number(w)}static getCodewordBucketNumber_number(w){return rn.getCodewordBucketNumber(rn.getBitCountForCodeword(w))}static getCodewordBucketNumber_Int32Array(w){return(w[0]-w[2]+w[4]-w[6]+9)%9}static toString(w){let _=new Jg;for(let A=0;A<w.length;A++){_.format("Row %2d: ",A);for(let B=0;B<w[A].length;B++){let z=w[A][B];z.getValue().length===0?_.format("        ",null):_.format("%4d(%2d)",z.getValue()[0],z.getConfidence(z.getValue()[0]))}_.format("%n")}return _.toString()}}rn.CODEWORD_SKEW_SIZE=2,rn.MAX_ERRORS=3,rn.MAX_EC_CODEWORDS=512,rn.errorCorrection=new LT;class Fa{decode(w,_=null){let A=Fa.decode(w,_,!1);if(A==null||A.length===0||A[0]==null)throw S.getNotFoundInstance();return A[0]}decodeMultiple(w,_=null){try{return Fa.decode(w,_,!0)}catch(A){throw A instanceof R||A instanceof m?S.getNotFoundInstance():A}}static decode(w,_,A){const B=new Array,z=tn.detectMultiple(w,_,A);for(const K of z.getPoints()){const Q=rn.decode(z.getBits(),K[4],K[5],K[6],K[7],Fa.getMinCodewordWidth(K),Fa.getMaxCodewordWidth(K)),te=new Z(Q.getText(),Q.getRawBytes(),void 0,K,G.PDF_417);te.putMetadata(V.ERROR_CORRECTION_LEVEL,Q.getECLevel());const ae=Q.getOther();ae!=null&&te.putMetadata(V.PDF417_EXTRA_METADATA,ae),B.push(te)}return B.map(K=>K)}static getMaxWidth(w,_){return w==null||_==null?0:Math.trunc(Math.abs(w.getX()-_.getX()))}static getMinWidth(w,_){return w==null||_==null?b.MAX_VALUE:Math.trunc(Math.abs(w.getX()-_.getX()))}static getMaxCodewordWidth(w){return Math.floor(Math.max(Math.max(Fa.getMaxWidth(w[0],w[4]),Fa.getMaxWidth(w[6],w[2])*Dr.MODULES_IN_CODEWORD/Dr.MODULES_IN_STOP_PATTERN),Math.max(Fa.getMaxWidth(w[1],w[5]),Fa.getMaxWidth(w[7],w[3])*Dr.MODULES_IN_CODEWORD/Dr.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(w){return Math.floor(Math.min(Math.min(Fa.getMinWidth(w[0],w[4]),Fa.getMinWidth(w[6],w[2])*Dr.MODULES_IN_CODEWORD/Dr.MODULES_IN_STOP_PATTERN),Math.min(Fa.getMinWidth(w[1],w[5]),Fa.getMinWidth(w[7],w[3])*Dr.MODULES_IN_CODEWORD/Dr.MODULES_IN_STOP_PATTERN)))}reset(){}}class ty extends l{}ty.kind="ReaderException";class VT{constructor(w,_){this.verbose=w===!0,_&&this.setHints(_)}decode(w,_){return _&&this.setHints(_),this.decodeInternal(w)}decodeWithState(w){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(w)}setHints(w){this.hints=w;const _=!s(w)&&w.get(O.TRY_HARDER)===!0,A=s(w)?null:w.get(O.POSSIBLE_FORMATS),B=new Array;if(!s(A)){const z=A.some(K=>K===G.UPC_A||K===G.UPC_E||K===G.EAN_13||K===G.EAN_8||K===G.CODABAR||K===G.CODE_39||K===G.CODE_93||K===G.CODE_128||K===G.ITF||K===G.RSS_14||K===G.RSS_EXPANDED);z&&!_&&B.push(new Et(w,this.verbose)),A.includes(G.QR_CODE)&&B.push(new ro),A.includes(G.DATA_MATRIX)&&B.push(new Ja),A.includes(G.AZTEC)&&B.push(new ut),A.includes(G.PDF_417)&&B.push(new Fa),z&&_&&B.push(new Et(w,this.verbose))}B.length===0&&(_||B.push(new Et(w,this.verbose)),B.push(new ro),B.push(new Ja),B.push(new ut),B.push(new Fa),_&&B.push(new Et(w,this.verbose))),this.readers=B}reset(){if(this.readers!==null)for(const w of this.readers)w.reset()}decodeInternal(w){if(this.readers===null)throw new ty("No readers where selected, nothing can be read.");for(const _ of this.readers)try{return _.decode(w,this.hints)}catch(A){if(A instanceof ty)continue}throw new S("No MultiFormat Readers were able to detect the code.")}}class vte extends Y{constructor(w=null,_=500){const A=new VT;A.setHints(w),super(A,_)}decodeBitmap(w){return this.reader.decodeWithState(w)}}class yte extends Y{constructor(w=500){super(new Fa,w)}}class bte extends Y{constructor(w=500){super(new ro,w)}}var xN;(function(xe){xe[xe.ERROR_CORRECTION=0]="ERROR_CORRECTION",xe[xe.CHARACTER_SET=1]="CHARACTER_SET",xe[xe.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",xe[xe.MIN_SIZE=3]="MIN_SIZE",xe[xe.MAX_SIZE=4]="MAX_SIZE",xe[xe.MARGIN=5]="MARGIN",xe[xe.PDF417_COMPACT=6]="PDF417_COMPACT",xe[xe.PDF417_COMPACTION=7]="PDF417_COMPACTION",xe[xe.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",xe[xe.AZTEC_LAYERS=9]="AZTEC_LAYERS",xe[xe.QR_VERSION=10]="QR_VERSION"})(xN||(xN={}));var na=xN;class vN{constructor(w){this.field=w,this.cachedGenerators=[],this.cachedGenerators.push(new ie(w,Int32Array.from([1])))}buildGenerator(w){const _=this.cachedGenerators;if(w>=_.length){let A=_[_.length-1];const B=this.field;for(let z=_.length;z<=w;z++){const K=A.multiply(new ie(B,Int32Array.from([1,B.exp(z-1+B.getGeneratorBase())])));_.push(K),A=K}}return _[w]}encode(w,_){if(_===0)throw new h("No error correction bytes");const A=w.length-_;if(A<=0)throw new h("No data bytes provided");const B=this.buildGenerator(_),z=new Int32Array(A);g.arraycopy(w,0,z,0,A);let K=new ie(this.field,z);K=K.multiplyByMonomial(_,1);const te=K.divide(B)[1].getCoefficients(),ae=_-te.length;for(let me=0;me<ae;me++)w[A+me]=0;g.arraycopy(te,0,w,A+ae,te.length)}}class Ms{constructor(){}static applyMaskPenaltyRule1(w){return Ms.applyMaskPenaltyRule1Internal(w,!0)+Ms.applyMaskPenaltyRule1Internal(w,!1)}static applyMaskPenaltyRule2(w){let _=0;const A=w.getArray(),B=w.getWidth(),z=w.getHeight();for(let K=0;K<z-1;K++){const Q=A[K];for(let te=0;te<B-1;te++){const ae=Q[te];ae===Q[te+1]&&ae===A[K+1][te]&&ae===A[K+1][te+1]&&_++}}return Ms.N2*_}static applyMaskPenaltyRule3(w){let _=0;const A=w.getArray(),B=w.getWidth(),z=w.getHeight();for(let K=0;K<z;K++)for(let Q=0;Q<B;Q++){const te=A[K];Q+6<B&&te[Q]===1&&te[Q+1]===0&&te[Q+2]===1&&te[Q+3]===1&&te[Q+4]===1&&te[Q+5]===0&&te[Q+6]===1&&(Ms.isWhiteHorizontal(te,Q-4,Q)||Ms.isWhiteHorizontal(te,Q+7,Q+11))&&_++,K+6<z&&A[K][Q]===1&&A[K+1][Q]===0&&A[K+2][Q]===1&&A[K+3][Q]===1&&A[K+4][Q]===1&&A[K+5][Q]===0&&A[K+6][Q]===1&&(Ms.isWhiteVertical(A,Q,K-4,K)||Ms.isWhiteVertical(A,Q,K+7,K+11))&&_++}return _*Ms.N3}static isWhiteHorizontal(w,_,A){_=Math.max(_,0),A=Math.min(A,w.length);for(let B=_;B<A;B++)if(w[B]===1)return!1;return!0}static isWhiteVertical(w,_,A,B){A=Math.max(A,0),B=Math.min(B,w.length);for(let z=A;z<B;z++)if(w[z][_]===1)return!1;return!0}static applyMaskPenaltyRule4(w){let _=0;const A=w.getArray(),B=w.getWidth(),z=w.getHeight();for(let te=0;te<z;te++){const ae=A[te];for(let me=0;me<B;me++)ae[me]===1&&_++}const K=w.getHeight()*w.getWidth();return Math.floor(Math.abs(_*2-K)*10/K)*Ms.N4}static getDataMaskBit(w,_,A){let B,z;switch(w){case 0:B=A+_&1;break;case 1:B=A&1;break;case 2:B=_%3;break;case 3:B=(A+_)%3;break;case 4:B=Math.floor(A/2)+Math.floor(_/3)&1;break;case 5:z=A*_,B=(z&1)+z%3;break;case 6:z=A*_,B=(z&1)+z%3&1;break;case 7:z=A*_,B=z%3+(A+_&1)&1;break;default:throw new h("Invalid mask pattern: "+w)}return B===0}static applyMaskPenaltyRule1Internal(w,_){let A=0;const B=_?w.getHeight():w.getWidth(),z=_?w.getWidth():w.getHeight(),K=w.getArray();for(let Q=0;Q<B;Q++){let te=0,ae=-1;for(let me=0;me<z;me++){const ve=_?K[Q][me]:K[me][Q];ve===ae?te++:(te>=5&&(A+=Ms.N1+(te-5)),te=1,ae=ve)}te>=5&&(A+=Ms.N1+(te-5))}return A}}Ms.N1=3,Ms.N2=3,Ms.N3=40,Ms.N4=10;class ry{constructor(w,_){this.width=w,this.height=_;const A=new Array(_);for(let B=0;B!==_;B++)A[B]=new Uint8Array(w);this.bytes=A}getHeight(){return this.height}getWidth(){return this.width}get(w,_){return this.bytes[_][w]}getArray(){return this.bytes}setNumber(w,_,A){this.bytes[_][w]=A}setBoolean(w,_,A){this.bytes[_][w]=A?1:0}clear(w){for(const _ of this.bytes)y.fill(_,w)}equals(w){if(!(w instanceof ry))return!1;const _=w;if(this.width!==_.width||this.height!==_.height)return!1;for(let A=0,B=this.height;A<B;++A){const z=this.bytes[A],K=_.bytes[A];for(let Q=0,te=this.width;Q<te;++Q)if(z[Q]!==K[Q])return!1}return!0}toString(){const w=new M;for(let _=0,A=this.height;_<A;++_){const B=this.bytes[_];for(let z=0,K=this.width;z<K;++z)switch(B[z]){case 0:w.append(" 0");break;case 1:w.append(" 1");break;default:w.append("  ");break}w.append(`
`)}return w.toString()}}class rh{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const w=new M;return w.append(`<<
`),w.append(" mode: "),w.append(this.mode?this.mode.toString():"null"),w.append(`
 ecLevel: `),w.append(this.ecLevel?this.ecLevel.toString():"null"),w.append(`
 version: `),w.append(this.version?this.version.toString():"null"),w.append(`
 maskPattern: `),w.append(this.maskPattern.toString()),this.matrix?(w.append(`
 matrix:
`),w.append(this.matrix.toString())):w.append(`
 matrix: null
`),w.append(`>>
`),w.toString()}setMode(w){this.mode=w}setECLevel(w){this.ecLevel=w}setVersion(w){this.version=w}setMaskPattern(w){this.maskPattern=w}setMatrix(w){this.matrix=w}static isValidMaskPattern(w){return w>=0&&w<rh.NUM_MASK_PATTERNS}}rh.NUM_MASK_PATTERNS=8;class Kn extends l{}Kn.kind="WriterException";class Ar{constructor(){}static clearMatrix(w){w.clear(255)}static buildMatrix(w,_,A,B,z){Ar.clearMatrix(z),Ar.embedBasicPatterns(A,z),Ar.embedTypeInfo(_,B,z),Ar.maybeEmbedVersionInfo(A,z),Ar.embedDataBits(w,B,z)}static embedBasicPatterns(w,_){Ar.embedPositionDetectionPatternsAndSeparators(_),Ar.embedDarkDotAtLeftBottomCorner(_),Ar.maybeEmbedPositionAdjustmentPatterns(w,_),Ar.embedTimingPatterns(_)}static embedTypeInfo(w,_,A){const B=new j;Ar.makeTypeInfoBits(w,_,B);for(let z=0,K=B.getSize();z<K;++z){const Q=B.get(B.getSize()-1-z),te=Ar.TYPE_INFO_COORDINATES[z],ae=te[0],me=te[1];if(A.setBoolean(ae,me,Q),z<8){const ve=A.getWidth()-z-1;A.setBoolean(ve,8,Q)}else{const je=A.getHeight()-7+(z-8);A.setBoolean(8,je,Q)}}}static maybeEmbedVersionInfo(w,_){if(w.getVersionNumber()<7)return;const A=new j;Ar.makeVersionInfoBits(w,A);let B=6*3-1;for(let z=0;z<6;++z)for(let K=0;K<3;++K){const Q=A.get(B);B--,_.setBoolean(z,_.getHeight()-11+K,Q),_.setBoolean(_.getHeight()-11+K,z,Q)}}static embedDataBits(w,_,A){let B=0,z=-1,K=A.getWidth()-1,Q=A.getHeight()-1;for(;K>0;){for(K===6&&(K-=1);Q>=0&&Q<A.getHeight();){for(let te=0;te<2;++te){const ae=K-te;if(!Ar.isEmpty(A.get(ae,Q)))continue;let me;B<w.getSize()?(me=w.get(B),++B):me=!1,_!==255&&Ms.getDataMaskBit(_,ae,Q)&&(me=!me),A.setBoolean(ae,Q,me)}Q+=z}z=-z,Q+=z,K-=2}if(B!==w.getSize())throw new Kn("Not all bits consumed: "+B+"/"+w.getSize())}static findMSBSet(w){return 32-b.numberOfLeadingZeros(w)}static calculateBCHCode(w,_){if(_===0)throw new h("0 polynomial");const A=Ar.findMSBSet(_);for(w<<=A-1;Ar.findMSBSet(w)>=A;)w^=_<<Ar.findMSBSet(w)-A;return w}static makeTypeInfoBits(w,_,A){if(!rh.isValidMaskPattern(_))throw new Kn("Invalid mask pattern");const B=w.getBits()<<3|_;A.appendBits(B,5);const z=Ar.calculateBCHCode(B,Ar.TYPE_INFO_POLY);A.appendBits(z,10);const K=new j;if(K.appendBits(Ar.TYPE_INFO_MASK_PATTERN,15),A.xor(K),A.getSize()!==15)throw new Kn("should not happen but we got: "+A.getSize())}static makeVersionInfoBits(w,_){_.appendBits(w.getVersionNumber(),6);const A=Ar.calculateBCHCode(w.getVersionNumber(),Ar.VERSION_INFO_POLY);if(_.appendBits(A,12),_.getSize()!==18)throw new Kn("should not happen but we got: "+_.getSize())}static isEmpty(w){return w===255}static embedTimingPatterns(w){for(let _=8;_<w.getWidth()-8;++_){const A=(_+1)%2;Ar.isEmpty(w.get(_,6))&&w.setNumber(_,6,A),Ar.isEmpty(w.get(6,_))&&w.setNumber(6,_,A)}}static embedDarkDotAtLeftBottomCorner(w){if(w.get(8,w.getHeight()-8)===0)throw new Kn;w.setNumber(8,w.getHeight()-8,1)}static embedHorizontalSeparationPattern(w,_,A){for(let B=0;B<8;++B){if(!Ar.isEmpty(A.get(w+B,_)))throw new Kn;A.setNumber(w+B,_,0)}}static embedVerticalSeparationPattern(w,_,A){for(let B=0;B<7;++B){if(!Ar.isEmpty(A.get(w,_+B)))throw new Kn;A.setNumber(w,_+B,0)}}static embedPositionAdjustmentPattern(w,_,A){for(let B=0;B<5;++B){const z=Ar.POSITION_ADJUSTMENT_PATTERN[B];for(let K=0;K<5;++K)A.setNumber(w+K,_+B,z[K])}}static embedPositionDetectionPattern(w,_,A){for(let B=0;B<7;++B){const z=Ar.POSITION_DETECTION_PATTERN[B];for(let K=0;K<7;++K)A.setNumber(w+K,_+B,z[K])}}static embedPositionDetectionPatternsAndSeparators(w){const _=Ar.POSITION_DETECTION_PATTERN[0].length;Ar.embedPositionDetectionPattern(0,0,w),Ar.embedPositionDetectionPattern(w.getWidth()-_,0,w),Ar.embedPositionDetectionPattern(0,w.getWidth()-_,w);const A=8;Ar.embedHorizontalSeparationPattern(0,A-1,w),Ar.embedHorizontalSeparationPattern(w.getWidth()-A,A-1,w),Ar.embedHorizontalSeparationPattern(0,w.getWidth()-A,w);const B=7;Ar.embedVerticalSeparationPattern(B,0,w),Ar.embedVerticalSeparationPattern(w.getHeight()-B-1,0,w),Ar.embedVerticalSeparationPattern(B,w.getHeight()-B,w)}static maybeEmbedPositionAdjustmentPatterns(w,_){if(w.getVersionNumber()<2)return;const A=w.getVersionNumber()-1,B=Ar.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[A];for(let z=0,K=B.length;z!==K;z++){const Q=B[z];if(Q>=0)for(let te=0;te!==K;te++){const ae=B[te];ae>=0&&Ar.isEmpty(_.get(ae,Q))&&Ar.embedPositionAdjustmentPattern(ae-2,Q-2,_)}}}}Ar.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Ar.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Ar.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Ar.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Ar.VERSION_INFO_POLY=7973,Ar.TYPE_INFO_POLY=1335,Ar.TYPE_INFO_MASK_PATTERN=21522;class wte{constructor(w,_){this.dataBytes=w,this.errorCorrectionBytes=_}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class ls{constructor(){}static calculateMaskPenalty(w){return Ms.applyMaskPenaltyRule1(w)+Ms.applyMaskPenaltyRule2(w)+Ms.applyMaskPenaltyRule3(w)+Ms.applyMaskPenaltyRule4(w)}static encode(w,_,A=null){let B=ls.DEFAULT_BYTE_MODE_ENCODING;const z=A!==null&&A.get(na.CHARACTER_SET)!==void 0;z&&(B=A.get(na.CHARACTER_SET).toString());const K=this.chooseMode(w,B),Q=new j;if(K===vr.BYTE&&(z||ls.DEFAULT_BYTE_MODE_ENCODING!==B)){const Ft=L.getCharacterSetECIByName(B);Ft!==void 0&&this.appendECI(Ft,Q)}this.appendModeInfo(K,Q);const te=new j;this.appendBytes(w,K,te,B);let ae;if(A!==null&&A.get(na.QR_VERSION)!==void 0){const Ft=Number.parseInt(A.get(na.QR_VERSION).toString(),10);ae=ur.getVersionForNumber(Ft);const Rt=this.calculateBitsNeeded(K,Q,te,ae);if(!this.willFit(Rt,ae,_))throw new Kn("Data too big for requested version")}else ae=this.recommendVersion(_,K,Q,te);const me=new j;me.appendBitArray(Q);const ve=K===vr.BYTE?te.getSizeInBytes():w.length;this.appendLengthInfo(ve,ae,K,me),me.appendBitArray(te);const je=ae.getECBlocksForLevel(_),Oe=ae.getTotalCodewords()-je.getTotalECCodewords();this.terminateBits(Oe,me);const Ue=this.interleaveWithECBytes(me,ae.getTotalCodewords(),Oe,je.getNumBlocks()),He=new rh;He.setECLevel(_),He.setMode(K),He.setVersion(ae);const nt=ae.getDimensionForVersion(),pt=new ry(nt,nt),$t=this.chooseMaskPattern(Ue,_,ae,pt);return He.setMaskPattern($t),Ar.buildMatrix(Ue,_,ae,$t,pt),He.setMatrix(pt),He}static recommendVersion(w,_,A,B){const z=this.calculateBitsNeeded(_,A,B,ur.getVersionForNumber(1)),K=this.chooseVersion(z,w),Q=this.calculateBitsNeeded(_,A,B,K);return this.chooseVersion(Q,w)}static calculateBitsNeeded(w,_,A,B){return _.getSize()+w.getCharacterCountBits(B)+A.getSize()}static getAlphanumericCode(w){return w<ls.ALPHANUMERIC_TABLE.length?ls.ALPHANUMERIC_TABLE[w]:-1}static chooseMode(w,_=null){if(L.SJIS.getName()===_&&this.isOnlyDoubleByteKanji(w))return vr.KANJI;let A=!1,B=!1;for(let z=0,K=w.length;z<K;++z){const Q=w.charAt(z);if(ls.isDigit(Q))A=!0;else if(this.getAlphanumericCode(Q.charCodeAt(0))!==-1)B=!0;else return vr.BYTE}return B?vr.ALPHANUMERIC:A?vr.NUMERIC:vr.BYTE}static isOnlyDoubleByteKanji(w){let _;try{_=X.encode(w,L.SJIS)}catch{return!1}const A=_.length;if(A%2!==0)return!1;for(let B=0;B<A;B+=2){const z=_[B]&255;if((z<129||z>159)&&(z<224||z>235))return!1}return!0}static chooseMaskPattern(w,_,A,B){let z=Number.MAX_SAFE_INTEGER,K=-1;for(let Q=0;Q<rh.NUM_MASK_PATTERNS;Q++){Ar.buildMatrix(w,_,A,Q,B);let te=this.calculateMaskPenalty(B);te<z&&(z=te,K=Q)}return K}static chooseVersion(w,_){for(let A=1;A<=40;A++){const B=ur.getVersionForNumber(A);if(ls.willFit(w,B,_))return B}throw new Kn("Data too big")}static willFit(w,_,A){const B=_.getTotalCodewords(),K=_.getECBlocksForLevel(A).getTotalECCodewords(),Q=B-K,te=(w+7)/8;return Q>=te}static terminateBits(w,_){const A=w*8;if(_.getSize()>A)throw new Kn("data bits cannot fit in the QR Code"+_.getSize()+" > "+A);for(let K=0;K<4&&_.getSize()<A;++K)_.appendBit(!1);const B=_.getSize()&7;if(B>0)for(let K=B;K<8;K++)_.appendBit(!1);const z=w-_.getSizeInBytes();for(let K=0;K<z;++K)_.appendBits(K&1?17:236,8);if(_.getSize()!==A)throw new Kn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(w,_,A,B,z,K){if(B>=A)throw new Kn("Block ID too large");const Q=w%A,te=A-Q,ae=Math.floor(w/A),me=ae+1,ve=Math.floor(_/A),je=ve+1,Oe=ae-ve,Ue=me-je;if(Oe!==Ue)throw new Kn("EC bytes mismatch");if(A!==te+Q)throw new Kn("RS blocks mismatch");if(w!==(ve+Oe)*te+(je+Ue)*Q)throw new Kn("Total bytes mismatch");B<te?(z[0]=ve,K[0]=Oe):(z[0]=je,K[0]=Ue)}static interleaveWithECBytes(w,_,A,B){if(w.getSizeInBytes()!==A)throw new Kn("Number of bits and data bytes does not match");let z=0,K=0,Q=0;const te=new Array;for(let me=0;me<B;++me){const ve=new Int32Array(1),je=new Int32Array(1);ls.getNumDataBytesAndNumECBytesForBlockID(_,A,B,me,ve,je);const Oe=ve[0],Ue=new Uint8Array(Oe);w.toBytes(8*z,Ue,0,Oe);const He=ls.generateECBytes(Ue,je[0]);te.push(new wte(Ue,He)),K=Math.max(K,Oe),Q=Math.max(Q,He.length),z+=ve[0]}if(A!==z)throw new Kn("Data bytes does not match offset");const ae=new j;for(let me=0;me<K;++me)for(const ve of te){const je=ve.getDataBytes();me<je.length&&ae.appendBits(je[me],8)}for(let me=0;me<Q;++me)for(const ve of te){const je=ve.getErrorCorrectionBytes();me<je.length&&ae.appendBits(je[me],8)}if(_!==ae.getSizeInBytes())throw new Kn("Interleaving error: "+_+" and "+ae.getSizeInBytes()+" differ.");return ae}static generateECBytes(w,_){const A=w.length,B=new Int32Array(A+_);for(let K=0;K<A;K++)B[K]=w[K]&255;new vN(se.QR_CODE_FIELD_256).encode(B,_);const z=new Uint8Array(_);for(let K=0;K<_;K++)z[K]=B[A+K];return z}static appendModeInfo(w,_){_.appendBits(w.getBits(),4)}static appendLengthInfo(w,_,A,B){const z=A.getCharacterCountBits(_);if(w>=1<<z)throw new Kn(w+" is bigger than "+((1<<z)-1));B.appendBits(w,z)}static appendBytes(w,_,A,B){switch(_){case vr.NUMERIC:ls.appendNumericBytes(w,A);break;case vr.ALPHANUMERIC:ls.appendAlphanumericBytes(w,A);break;case vr.BYTE:ls.append8BitBytes(w,A,B);break;case vr.KANJI:ls.appendKanjiBytes(w,A);break;default:throw new Kn("Invalid mode: "+_)}}static getDigit(w){return w.charCodeAt(0)-48}static isDigit(w){const _=ls.getDigit(w);return _>=0&&_<=9}static appendNumericBytes(w,_){const A=w.length;let B=0;for(;B<A;){const z=ls.getDigit(w.charAt(B));if(B+2<A){const K=ls.getDigit(w.charAt(B+1)),Q=ls.getDigit(w.charAt(B+2));_.appendBits(z*100+K*10+Q,10),B+=3}else if(B+1<A){const K=ls.getDigit(w.charAt(B+1));_.appendBits(z*10+K,7),B+=2}else _.appendBits(z,4),B++}}static appendAlphanumericBytes(w,_){const A=w.length;let B=0;for(;B<A;){const z=ls.getAlphanumericCode(w.charCodeAt(B));if(z===-1)throw new Kn;if(B+1<A){const K=ls.getAlphanumericCode(w.charCodeAt(B+1));if(K===-1)throw new Kn;_.appendBits(z*45+K,11),B+=2}else _.appendBits(z,6),B++}}static append8BitBytes(w,_,A){let B;try{B=X.encode(w,A)}catch(z){throw new Kn(z)}for(let z=0,K=B.length;z!==K;z++){const Q=B[z];_.appendBits(Q,8)}}static appendKanjiBytes(w,_){let A;try{A=X.encode(w,L.SJIS)}catch(z){throw new Kn(z)}const B=A.length;for(let z=0;z<B;z+=2){const K=A[z]&255,Q=A[z+1]&255,te=K<<8&4294967295|Q;let ae=-1;if(te>=33088&&te<=40956?ae=te-33088:te>=57408&&te<=60351&&(ae=te-49472),ae===-1)throw new Kn("Invalid byte sequence");const me=(ae>>8)*192+(ae&255);_.appendBits(me,13)}}static appendECI(w,_){_.appendBits(vr.ECI.getBits(),4),_.appendBits(w.getValue(),8)}}ls.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),ls.DEFAULT_BYTE_MODE_ENCODING=L.UTF8.getName();class nh{write(w,_,A,B=null){if(w.length===0)throw new h("Found empty contents");if(_<0||A<0)throw new h("Requested dimensions are too small: "+_+"x"+A);let z=jn.L,K=nh.QUIET_ZONE_SIZE;B!==null&&(B.get(na.ERROR_CORRECTION)!==void 0&&(z=jn.fromString(B.get(na.ERROR_CORRECTION).toString())),B.get(na.MARGIN)!==void 0&&(K=Number.parseInt(B.get(na.MARGIN).toString(),10)));const Q=ls.encode(w,z,B);return this.renderResult(Q,_,A,K)}writeToDom(w,_,A,B,z=null){typeof w=="string"&&(w=document.querySelector(w));const K=this.write(_,A,B,z);w&&w.appendChild(K)}renderResult(w,_,A,B){const z=w.getMatrix();if(z===null)throw new ye;const K=z.getWidth(),Q=z.getHeight(),te=K+B*2,ae=Q+B*2,me=Math.max(_,te),ve=Math.max(A,ae),je=Math.min(Math.floor(me/te),Math.floor(ve/ae)),Oe=Math.floor((me-K*je)/2),Ue=Math.floor((ve-Q*je)/2),He=this.createSVGElement(me,ve);for(let nt=0,pt=Ue;nt<Q;nt++,pt+=je)for(let $t=0,Ft=Oe;$t<K;$t++,Ft+=je)if(z.get($t,nt)===1){const Rt=this.createSvgRectElement(Ft,pt,je,je);He.appendChild(Rt)}return He}createSVGElement(w,_){const A=document.createElementNS(nh.SVG_NS,"svg");return A.setAttributeNS(null,"height",w.toString()),A.setAttributeNS(null,"width",_.toString()),A}createSvgRectElement(w,_,A,B){const z=document.createElementNS(nh.SVG_NS,"rect");return z.setAttributeNS(null,"x",w.toString()),z.setAttributeNS(null,"y",_.toString()),z.setAttributeNS(null,"height",A.toString()),z.setAttributeNS(null,"width",B.toString()),z.setAttributeNS(null,"fill","#000000"),z}}nh.QUIET_ZONE_SIZE=4,nh.SVG_NS="http://www.w3.org/2000/svg";class $f{encode(w,_,A,B,z){if(w.length===0)throw new h("Found empty contents");if(_!==G.QR_CODE)throw new h("Can only encode QR_CODE, but got "+_);if(A<0||B<0)throw new h(`Requested dimensions are too small: ${A}x${B}`);let K=jn.L,Q=$f.QUIET_ZONE_SIZE;z!==null&&(z.get(na.ERROR_CORRECTION)!==void 0&&(K=jn.fromString(z.get(na.ERROR_CORRECTION).toString())),z.get(na.MARGIN)!==void 0&&(Q=Number.parseInt(z.get(na.MARGIN).toString(),10)));const te=ls.encode(w,K,z);return $f.renderResult(te,A,B,Q)}static renderResult(w,_,A,B){const z=w.getMatrix();if(z===null)throw new ye;const K=z.getWidth(),Q=z.getHeight(),te=K+B*2,ae=Q+B*2,me=Math.max(_,te),ve=Math.max(A,ae),je=Math.min(Math.floor(me/te),Math.floor(ve/ae)),Oe=Math.floor((me-K*je)/2),Ue=Math.floor((ve-Q*je)/2),He=new F(me,ve);for(let nt=0,pt=Ue;nt<Q;nt++,pt+=je)for(let $t=0,Ft=Oe;$t<K;$t++,Ft+=je)z.get($t,nt)===1&&He.setRegion(Ft,pt,je,je);return He}}$f.QUIET_ZONE_SIZE=4;class _te{encode(w,_,A,B,z){let K;switch(_){case G.QR_CODE:K=new $f;break;default:throw new h("No encoder available for format "+_)}return K.encode(w,_,A,B,z)}}class Vl extends C{constructor(w,_,A,B,z,K,Q,te){if(super(K,Q),this.yuvData=w,this.dataWidth=_,this.dataHeight=A,this.left=B,this.top=z,B+K>_||z+Q>A)throw new h("Crop rectangle does not fit within image data.");te&&this.reverseHorizontal(K,Q)}getRow(w,_){if(w<0||w>=this.getHeight())throw new h("Requested row is outside the image: "+w);const A=this.getWidth();(_==null||_.length<A)&&(_=new Uint8ClampedArray(A));const B=(w+this.top)*this.dataWidth+this.left;return g.arraycopy(this.yuvData,B,_,0,A),_}getMatrix(){const w=this.getWidth(),_=this.getHeight();if(w===this.dataWidth&&_===this.dataHeight)return this.yuvData;const A=w*_,B=new Uint8ClampedArray(A);let z=this.top*this.dataWidth+this.left;if(w===this.dataWidth)return g.arraycopy(this.yuvData,z,B,0,A),B;for(let K=0;K<_;K++){const Q=K*w;g.arraycopy(this.yuvData,z,B,Q,w),z+=this.dataWidth}return B}isCropSupported(){return!0}crop(w,_,A,B){return new Vl(this.yuvData,this.dataWidth,this.dataHeight,this.left+w,this.top+_,A,B,!1)}renderThumbnail(){const w=this.getWidth()/Vl.THUMBNAIL_SCALE_FACTOR,_=this.getHeight()/Vl.THUMBNAIL_SCALE_FACTOR,A=new Int32Array(w*_),B=this.yuvData;let z=this.top*this.dataWidth+this.left;for(let K=0;K<_;K++){const Q=K*w;for(let te=0;te<w;te++){const ae=B[z+te*Vl.THUMBNAIL_SCALE_FACTOR]&255;A[Q+te]=4278190080|ae*65793}z+=this.dataWidth*Vl.THUMBNAIL_SCALE_FACTOR}return A}getThumbnailWidth(){return this.getWidth()/Vl.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Vl.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(w,_){const A=this.yuvData;for(let B=0,z=this.top*this.dataWidth+this.left;B<_;B++,z+=this.dataWidth){const K=z+w/2;for(let Q=z,te=z+w-1;Q<K;Q++,te--){const ae=A[Q];A[Q]=A[te],A[te]=ae}}}invert(){return new k(this)}}Vl.THUMBNAIL_SCALE_FACTOR=2;class yN extends C{constructor(w,_,A,B,z,K,Q){if(super(_,A),this.dataWidth=B,this.dataHeight=z,this.left=K,this.top=Q,w.BYTES_PER_ELEMENT===4){const te=_*A,ae=new Uint8ClampedArray(te);for(let me=0;me<te;me++){const ve=w[me],je=ve>>16&255,Oe=ve>>7&510,Ue=ve&255;ae[me]=(je+Oe+Ue)/4&255}this.luminances=ae}else this.luminances=w;if(B===void 0&&(this.dataWidth=_),z===void 0&&(this.dataHeight=A),K===void 0&&(this.left=0),Q===void 0&&(this.top=0),this.left+_>this.dataWidth||this.top+A>this.dataHeight)throw new h("Crop rectangle does not fit within image data.")}getRow(w,_){if(w<0||w>=this.getHeight())throw new h("Requested row is outside the image: "+w);const A=this.getWidth();(_==null||_.length<A)&&(_=new Uint8ClampedArray(A));const B=(w+this.top)*this.dataWidth+this.left;return g.arraycopy(this.luminances,B,_,0,A),_}getMatrix(){const w=this.getWidth(),_=this.getHeight();if(w===this.dataWidth&&_===this.dataHeight)return this.luminances;const A=w*_,B=new Uint8ClampedArray(A);let z=this.top*this.dataWidth+this.left;if(w===this.dataWidth)return g.arraycopy(this.luminances,z,B,0,A),B;for(let K=0;K<_;K++){const Q=K*w;g.arraycopy(this.luminances,z,B,Q,w),z+=this.dataWidth}return B}isCropSupported(){return!0}crop(w,_,A,B){return new yN(this.luminances,A,B,this.dataWidth,this.dataHeight,this.left+w,this.top+_)}invert(){return new k(this)}}class qT extends L{static forName(w){return this.getCharacterSetECIByName(w)}}class bN{}bN.ISO_8859_1=L.ISO8859_1;class WT{isCompact(){return this.compact}setCompact(w){this.compact=w}getSize(){return this.size}setSize(w){this.size=w}getLayers(){return this.layers}setLayers(w){this.layers=w}getCodeWords(){return this.codeWords}setCodeWords(w){this.codeWords=w}getMatrix(){return this.matrix}setMatrix(w){this.matrix=w}}class HT{static singletonList(w){return[w]}static min(w,_){return w.sort(_)[0]}}class jte{constructor(w){this.previous=w}getPrevious(){return this.previous}}class Ff extends jte{constructor(w,_,A){super(w),this.value=_,this.bitCount=A}appendTo(w,_){w.appendBits(this.value,this.bitCount)}add(w,_){return new Ff(this,w,_)}addBinaryShift(w,_){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Ff(this,w,_)}toString(){let w=this.value&(1<<this.bitCount)-1;return w|=1<<this.bitCount,"<"+b.toBinaryString(w|1<<this.bitCount).substring(1)+">"}}class wN extends Ff{constructor(w,_,A){super(w,0,0),this.binaryShiftStart=_,this.binaryShiftByteCount=A}appendTo(w,_){for(let A=0;A<this.binaryShiftByteCount;A++)(A===0||A===31&&this.binaryShiftByteCount<=62)&&(w.appendBits(31,5),this.binaryShiftByteCount>62?w.appendBits(this.binaryShiftByteCount-31,16):A===0?w.appendBits(Math.min(this.binaryShiftByteCount,31),5):w.appendBits(this.binaryShiftByteCount-31,5)),w.appendBits(_[this.binaryShiftStart+A],8)}addBinaryShift(w,_){return new wN(this,w,_)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Nte(xe,w,_){return new wN(xe,w,_)}function s0(xe,w,_){return new Ff(xe,w,_)}const Ste=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Rd=0,ny=1,To=2,GT=3,ql=4,Cte=new Ff(null,0,0),_N=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function Ete(xe){for(let w of xe)y.fill(w,-1);return xe[Rd][ql]=0,xe[ny][ql]=0,xe[ny][Rd]=28,xe[GT][ql]=0,xe[To][ql]=0,xe[To][Rd]=15,xe}const KT=Ete(y.createInt32Array(6,6));class Wl{constructor(w,_,A,B){this.token=w,this.mode=_,this.binaryShiftByteCount=A,this.bitCount=B}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(w,_){let A=this.bitCount,B=this.token;if(w!==this.mode){let K=_N[this.mode][w];B=s0(B,K&65535,K>>16),A+=K>>16}let z=w===To?4:5;return B=s0(B,_,z),new Wl(B,w,0,A+z)}shiftAndAppend(w,_){let A=this.token,B=this.mode===To?4:5;return A=s0(A,KT[this.mode][w],B),A=s0(A,_,5),new Wl(A,this.mode,0,this.bitCount+B+5)}addBinaryShiftChar(w){let _=this.token,A=this.mode,B=this.bitCount;if(this.mode===ql||this.mode===To){let Q=_N[A][Rd];_=s0(_,Q&65535,Q>>16),B+=Q>>16,A=Rd}let z=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,K=new Wl(_,A,this.binaryShiftByteCount+1,B+z);return K.binaryShiftByteCount===2078&&(K=K.endBinaryShift(w+1)),K}endBinaryShift(w){if(this.binaryShiftByteCount===0)return this;let _=this.token;return _=Nte(_,w-this.binaryShiftByteCount,this.binaryShiftByteCount),new Wl(_,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(w){let _=this.bitCount+(_N[this.mode][w.mode]>>16);return this.binaryShiftByteCount<w.binaryShiftByteCount?_+=Wl.calculateBinaryShiftCost(w)-Wl.calculateBinaryShiftCost(this):this.binaryShiftByteCount>w.binaryShiftByteCount&&w.binaryShiftByteCount>0&&(_+=10),_<=w.bitCount}toBitArray(w){let _=[];for(let B=this.endBinaryShift(w.length).token;B!==null;B=B.getPrevious())_.unshift(B);let A=new j;for(const B of _)B.appendTo(A,w);return A}toString(){return H.format("%s bits=%d bytes=%d",Ste[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(w){return w.binaryShiftByteCount>62?21:w.binaryShiftByteCount>31?20:w.binaryShiftByteCount>0?10:0}}Wl.INITIAL_STATE=new Wl(Cte,Rd,0,0);function kte(xe){const w=H.getCharCode(" "),_=H.getCharCode("."),A=H.getCharCode(",");xe[Rd][w]=1;const B=H.getCharCode("Z"),z=H.getCharCode("A");for(let je=z;je<=B;je++)xe[Rd][je]=je-z+2;xe[ny][w]=1;const K=H.getCharCode("z"),Q=H.getCharCode("a");for(let je=Q;je<=K;je++)xe[ny][je]=je-Q+2;xe[To][w]=1;const te=H.getCharCode("9"),ae=H.getCharCode("0");for(let je=ae;je<=te;je++)xe[To][je]=je-ae+2;xe[To][A]=12,xe[To][_]=13;const me=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let je=0;je<me.length;je++)xe[GT][H.getCharCode(me[je])]=je;const ve=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let je=0;je<ve.length;je++)H.getCharCode(ve[je])>0&&(xe[ql][H.getCharCode(ve[je])]=je);return xe}const jN=kte(y.createInt32Array(5,256));class a0{constructor(w){this.text=w}encode(){const w=H.getCharCode(" "),_=H.getCharCode(`
`);let A=HT.singletonList(Wl.INITIAL_STATE);for(let z=0;z<this.text.length;z++){let K,Q=z+1<this.text.length?this.text[z+1]:0;switch(this.text[z]){case H.getCharCode("\r"):K=Q===_?2:0;break;case H.getCharCode("."):K=Q===w?3:0;break;case H.getCharCode(","):K=Q===w?4:0;break;case H.getCharCode(":"):K=Q===w?5:0;break;default:K=0}K>0?(A=a0.updateStateListForPair(A,z,K),z++):A=this.updateStateListForChar(A,z)}return HT.min(A,(z,K)=>z.getBitCount()-K.getBitCount()).toBitArray(this.text)}updateStateListForChar(w,_){const A=[];for(let B of w)this.updateStateForChar(B,_,A);return a0.simplifyStates(A)}updateStateForChar(w,_,A){let B=this.text[_]&255,z=jN[w.getMode()][B]>0,K=null;for(let Q=0;Q<=ql;Q++){let te=jN[Q][B];if(te>0){if(K==null&&(K=w.endBinaryShift(_)),!z||Q===w.getMode()||Q===To){const ae=K.latchAndAppend(Q,te);A.push(ae)}if(!z&&KT[w.getMode()][Q]>=0){const ae=K.shiftAndAppend(Q,te);A.push(ae)}}}if(w.getBinaryShiftByteCount()>0||jN[w.getMode()][B]===0){let Q=w.addBinaryShiftChar(_);A.push(Q)}}static updateStateListForPair(w,_,A){const B=[];for(let z of w)this.updateStateForPair(z,_,A,B);return this.simplifyStates(B)}static updateStateForPair(w,_,A,B){let z=w.endBinaryShift(_);if(B.push(z.latchAndAppend(ql,A)),w.getMode()!==ql&&B.push(z.shiftAndAppend(ql,A)),A===3||A===4){let K=z.latchAndAppend(To,16-A).latchAndAppend(To,1);B.push(K)}if(w.getBinaryShiftByteCount()>0){let K=w.addBinaryShiftChar(_).addBinaryShiftChar(_+1);B.push(K)}}static simplifyStates(w){let _=[];for(const A of w){let B=!0;for(const z of _){if(z.isBetterThanOrEqualTo(A)){B=!1;break}A.isBetterThanOrEqualTo(z)&&(_=_.filter(K=>K!==z))}B&&_.push(A)}return _}}class Nn{constructor(){}static encodeBytes(w){return Nn.encode(w,Nn.DEFAULT_EC_PERCENT,Nn.DEFAULT_AZTEC_LAYERS)}static encode(w,_,A){let B=new a0(w).encode(),z=b.truncDivision(B.getSize()*_,100)+11,K=B.getSize()+z,Q,te,ae,me,ve;if(A!==Nn.DEFAULT_AZTEC_LAYERS){if(Q=A<0,te=Math.abs(A),te>(Q?Nn.MAX_NB_BITS_COMPACT:Nn.MAX_NB_BITS))throw new h(H.format("Illegal value %s for layers",A));ae=Nn.totalBitsInLayer(te,Q),me=Nn.WORD_SIZE[te];let Rt=ae-ae%me;if(ve=Nn.stuffBits(B,me),ve.getSize()+z>Rt)throw new h("Data to large for user specified layer");if(Q&&ve.getSize()>me*64)throw new h("Data to large for user specified layer")}else{me=0,ve=null;for(let Rt=0;;Rt++){if(Rt>Nn.MAX_NB_BITS)throw new h("Data too large for an Aztec code");if(Q=Rt<=3,te=Q?Rt+1:Rt,ae=Nn.totalBitsInLayer(te,Q),K>ae)continue;(ve==null||me!==Nn.WORD_SIZE[te])&&(me=Nn.WORD_SIZE[te],ve=Nn.stuffBits(B,me));let hn=ae-ae%me;if(!(Q&&ve.getSize()>me*64)&&ve.getSize()+z<=hn)break}}let je=Nn.generateCheckWords(ve,ae,me),Oe=ve.getSize()/me,Ue=Nn.generateModeMessage(Q,te,Oe),He=(Q?11:14)+te*4,nt=new Int32Array(He),pt;if(Q){pt=He;for(let Rt=0;Rt<nt.length;Rt++)nt[Rt]=Rt}else{pt=He+1+2*b.truncDivision(b.truncDivision(He,2)-1,15);let Rt=b.truncDivision(He,2),hn=b.truncDivision(pt,2);for(let Zr=0;Zr<Rt;Zr++){let Ii=Zr+b.truncDivision(Zr,15);nt[Rt-Zr-1]=hn-Ii-1,nt[Rt+Zr]=hn+Ii+1}}let $t=new F(pt);for(let Rt=0,hn=0;Rt<te;Rt++){let Zr=(te-Rt)*4+(Q?9:12);for(let Ii=0;Ii<Zr;Ii++){let ol=Ii*2;for(let Di=0;Di<2;Di++)je.get(hn+ol+Di)&&$t.set(nt[Rt*2+Di],nt[Rt*2+Ii]),je.get(hn+Zr*2+ol+Di)&&$t.set(nt[Rt*2+Ii],nt[He-1-Rt*2-Di]),je.get(hn+Zr*4+ol+Di)&&$t.set(nt[He-1-Rt*2-Di],nt[He-1-Rt*2-Ii]),je.get(hn+Zr*6+ol+Di)&&$t.set(nt[He-1-Rt*2-Ii],nt[Rt*2+Di])}hn+=Zr*8}if(Nn.drawModeMessage($t,Q,pt,Ue),Q)Nn.drawBullsEye($t,b.truncDivision(pt,2),5);else{Nn.drawBullsEye($t,b.truncDivision(pt,2),7);for(let Rt=0,hn=0;Rt<b.truncDivision(He,2)-1;Rt+=15,hn+=16)for(let Zr=b.truncDivision(pt,2)&1;Zr<pt;Zr+=2)$t.set(b.truncDivision(pt,2)-hn,Zr),$t.set(b.truncDivision(pt,2)+hn,Zr),$t.set(Zr,b.truncDivision(pt,2)-hn),$t.set(Zr,b.truncDivision(pt,2)+hn)}let Ft=new WT;return Ft.setCompact(Q),Ft.setSize(pt),Ft.setLayers(te),Ft.setCodeWords(Oe),Ft.setMatrix($t),Ft}static drawBullsEye(w,_,A){for(let B=0;B<A;B+=2)for(let z=_-B;z<=_+B;z++)w.set(z,_-B),w.set(z,_+B),w.set(_-B,z),w.set(_+B,z);w.set(_-A,_-A),w.set(_-A+1,_-A),w.set(_-A,_-A+1),w.set(_+A,_-A),w.set(_+A,_-A+1),w.set(_+A,_+A-1)}static generateModeMessage(w,_,A){let B=new j;return w?(B.appendBits(_-1,2),B.appendBits(A-1,6),B=Nn.generateCheckWords(B,28,4)):(B.appendBits(_-1,5),B.appendBits(A-1,11),B=Nn.generateCheckWords(B,40,4)),B}static drawModeMessage(w,_,A,B){let z=b.truncDivision(A,2);if(_)for(let K=0;K<7;K++){let Q=z-3+K;B.get(K)&&w.set(Q,z-5),B.get(K+7)&&w.set(z+5,Q),B.get(20-K)&&w.set(Q,z+5),B.get(27-K)&&w.set(z-5,Q)}else for(let K=0;K<10;K++){let Q=z-5+K+b.truncDivision(K,5);B.get(K)&&w.set(Q,z-7),B.get(K+10)&&w.set(z+7,Q),B.get(29-K)&&w.set(Q,z+7),B.get(39-K)&&w.set(z-7,Q)}}static generateCheckWords(w,_,A){let B=w.getSize()/A,z=new vN(Nn.getGF(A)),K=b.truncDivision(_,A),Q=Nn.bitsToWords(w,A,K);z.encode(Q,K-B);let te=_%A,ae=new j;ae.appendBits(0,te);for(const me of Array.from(Q))ae.appendBits(me,A);return ae}static bitsToWords(w,_,A){let B=new Int32Array(A),z,K;for(z=0,K=w.getSize()/_;z<K;z++){let Q=0;for(let te=0;te<_;te++)Q|=w.get(z*_+te)?1<<_-te-1:0;B[z]=Q}return B}static getGF(w){switch(w){case 4:return se.AZTEC_PARAM;case 6:return se.AZTEC_DATA_6;case 8:return se.AZTEC_DATA_8;case 10:return se.AZTEC_DATA_10;case 12:return se.AZTEC_DATA_12;default:throw new h("Unsupported word size "+w)}}static stuffBits(w,_){let A=new j,B=w.getSize(),z=(1<<_)-2;for(let K=0;K<B;K+=_){let Q=0;for(let te=0;te<_;te++)(K+te>=B||w.get(K+te))&&(Q|=1<<_-1-te);(Q&z)===z?(A.appendBits(Q&z,_),K--):Q&z?A.appendBits(Q,_):(A.appendBits(Q|1,_),K--)}return A}static totalBitsInLayer(w,_){return((_?88:112)+16*w)*w}}Nn.DEFAULT_EC_PERCENT=33,Nn.DEFAULT_AZTEC_LAYERS=0,Nn.MAX_NB_BITS=32,Nn.MAX_NB_BITS_COMPACT=4,Nn.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class sy{encode(w,_,A,B){return this.encodeWithHints(w,_,A,B,null)}encodeWithHints(w,_,A,B,z){let K=bN.ISO_8859_1,Q=Nn.DEFAULT_EC_PERCENT,te=Nn.DEFAULT_AZTEC_LAYERS;return z!=null&&(z.has(na.CHARACTER_SET)&&(K=qT.forName(z.get(na.CHARACTER_SET).toString())),z.has(na.ERROR_CORRECTION)&&(Q=b.parseInt(z.get(na.ERROR_CORRECTION).toString())),z.has(na.AZTEC_LAYERS)&&(te=b.parseInt(z.get(na.AZTEC_LAYERS).toString()))),sy.encodeLayers(w,_,A,B,K,Q,te)}static encodeLayers(w,_,A,B,z,K,Q){if(_!==G.AZTEC)throw new h("Can only encode AZTEC, but got "+_);let te=Nn.encode(H.getBytes(w,z),K,Q);return sy.renderResult(te,A,B)}static renderResult(w,_,A){let B=w.getMatrix();if(B==null)throw new ye;let z=B.getWidth(),K=B.getHeight(),Q=Math.max(_,z),te=Math.max(A,K),ae=Math.min(Q/z,te/K),me=(Q-z*ae)/2,ve=(te-K*ae)/2,je=new F(Q,te);for(let Oe=0,Ue=ve;Oe<K;Oe++,Ue+=ae)for(let He=0,nt=me;He<z;He++,nt+=ae)B.get(He,Oe)&&je.setRegion(nt,Ue,ae,ae);return je}}r.AbstractExpandedDecoder=_r,r.ArgumentException=u,r.ArithmeticException=oe,r.AztecCode=WT,r.AztecCodeReader=ut,r.AztecCodeWriter=sy,r.AztecDecoder=pe,r.AztecDetector=ot,r.AztecDetectorResult=Me,r.AztecEncoder=Nn,r.AztecHighLevelEncoder=a0,r.AztecPoint=Re,r.BarcodeFormat=G,r.Binarizer=p,r.BinaryBitmap=f,r.BitArray=j,r.BitMatrix=F,r.BitSource=wn,r.BrowserAztecCodeReader=bt,r.BrowserBarcodeReader=kr,r.BrowserCodeReader=Y,r.BrowserDatamatrixCodeReader=kd,r.BrowserMultiFormatReader=vte,r.BrowserPDF417Reader=yte,r.BrowserQRCodeReader=bte,r.BrowserQRCodeSvgWriter=nh,r.CharacterSetECI=L,r.ChecksumException=m,r.Code128Reader=Ce,r.Code39Reader=Ge,r.DataMatrixDecodedBitStreamParser=Gn,r.DataMatrixReader=Ja,r.DecodeHintType=O,r.DecoderResult=W,r.DefaultGridSampler=Ze,r.DetectorResult=be,r.EAN13Reader=tt,r.EncodeHintType=na,r.Exception=l,r.FormatException=R,r.GenericGF=se,r.GenericGFPoly=ie,r.GlobalHistogramBinarizer=E,r.GridSampler=$e,r.GridSamplerInstance=it,r.HTMLCanvasElementLuminanceSource=I,r.HybridBinarizer=N,r.ITFReader=Pe,r.IllegalArgumentException=h,r.IllegalStateException=ye,r.InvertedLuminanceSource=k,r.LuminanceSource=C,r.MathUtils=ge,r.MultiFormatOneDReader=Et,r.MultiFormatReader=VT,r.MultiFormatWriter=_te,r.NotFoundException=S,r.OneDReader=Je,r.PDF417DecodedBitStreamParser=ft,r.PDF417DecoderErrorCorrection=LT,r.PDF417Reader=Fa,r.PDF417ResultMetadata=$T,r.PerspectiveTransform=Ke,r.PlanarYUVLuminanceSource=Vl,r.QRCodeByteMatrix=ry,r.QRCodeDataMask=Qn,r.QRCodeDecodedBitStreamParser=Mn,r.QRCodeDecoderErrorCorrectionLevel=jn,r.QRCodeDecoderFormatInformation=Fr,r.QRCodeEncoder=ls,r.QRCodeEncoderQRCode=rh,r.QRCodeMaskUtil=Ms,r.QRCodeMatrixUtil=Ar,r.QRCodeMode=vr,r.QRCodeReader=ro,r.QRCodeVersion=ur,r.QRCodeWriter=$f,r.RGBLuminanceSource=yN,r.RSS14Reader=wt,r.RSSExpandedReader=Fe,r.ReaderException=ty,r.ReedSolomonDecoder=ue,r.ReedSolomonEncoder=vN,r.ReedSolomonException=le,r.Result=Z,r.ResultMetadataType=V,r.ResultPoint=_e,r.StringUtils=H,r.UnsupportedOperationException=q,r.VideoInputDevice=U,r.WhiteRectangleDetector=Se,r.WriterException=Kn,r.ZXingArrays=y,r.ZXingCharset=qT,r.ZXingInteger=b,r.ZXingStandardCharsets=bN,r.ZXingStringBuilder=M,r.ZXingStringEncoding=X,r.ZXingSystem=g,r.createAbstractExpandedDecoder=Ee,Object.defineProperty(r,"__esModule",{value:!0})})})(r6,r6.exports);var us=r6.exports;const RQe=On(us),MQe=JB({__proto__:null,default:RQe},[us]);var CB=function(){function e(t,r,s){if(this.formatMap=new Map([[lr.QR_CODE,us.BarcodeFormat.QR_CODE],[lr.AZTEC,us.BarcodeFormat.AZTEC],[lr.CODABAR,us.BarcodeFormat.CODABAR],[lr.CODE_39,us.BarcodeFormat.CODE_39],[lr.CODE_93,us.BarcodeFormat.CODE_93],[lr.CODE_128,us.BarcodeFormat.CODE_128],[lr.DATA_MATRIX,us.BarcodeFormat.DATA_MATRIX],[lr.MAXICODE,us.BarcodeFormat.MAXICODE],[lr.ITF,us.BarcodeFormat.ITF],[lr.EAN_13,us.BarcodeFormat.EAN_13],[lr.EAN_8,us.BarcodeFormat.EAN_8],[lr.PDF_417,us.BarcodeFormat.PDF_417],[lr.RSS_14,us.BarcodeFormat.RSS_14],[lr.RSS_EXPANDED,us.BarcodeFormat.RSS_EXPANDED],[lr.UPC_A,us.BarcodeFormat.UPC_A],[lr.UPC_E,us.BarcodeFormat.UPC_E],[lr.UPC_EAN_EXTENSION,us.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!MQe)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=r,this.logger=s;var a=this.createZXingFormats(t),i=new Map;i.set(us.DecodeHintType.POSSIBLE_FORMATS,a),i.set(us.DecodeHintType.TRY_HARDER,!1),this.hints=i}return e.prototype.decodeAsync=function(t){var r=this;return new Promise(function(s,a){try{s(r.decode(t))}catch(i){a(i)}})},e.prototype.decode=function(t){var r=new us.MultiFormatReader(this.verbose,this.hints),s=new us.HTMLCanvasElementLuminanceSource(t),a=new us.BinaryBitmap(new us.HybridBinarizer(s)),i=r.decode(a);return{text:i.text,format:ite.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(r,s,a){t.set(r,s)}),t},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createZXingFormats=function(t){for(var r=[],s=0,a=t;s<a.length;s++){var i=a[s];this.formatMap.has(i)?r.push(this.formatMap.get(i)):this.logger.logError("".concat(i," is not supported by")+"ZXingHtml5QrcodeShim")}return r},e.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},e}(),IQe=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{l(s.next(u))}catch(h){o(h)}}function d(u){try{l(s.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):a(u.value).then(c,d)}l((s=s.apply(e,t||[])).next())})},DQe=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,a,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(l){return function(u){return d([l,u])}}function d(l){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(r=0)),r;)try{if(s=1,a&&(i=l[0]&2?a.return:l[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,l[1])).done)return i;switch(a=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(u){l=[6,u],a=0}finally{s=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},EB=function(){function e(t,r,s){if(this.formatMap=new Map([[lr.QR_CODE,"qr_code"],[lr.AZTEC,"aztec"],[lr.CODABAR,"codabar"],[lr.CODE_39,"code_39"],[lr.CODE_93,"code_93"],[lr.CODE_128,"code_128"],[lr.DATA_MATRIX,"data_matrix"],[lr.ITF,"itf"],[lr.EAN_13,"ean_13"],[lr.EAN_8,"ean_8"],[lr.PDF_417,"pdf417"],[lr.UPC_A,"upc_a"],[lr.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!e.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=r,this.logger=s;var a=this.createBarcodeDetectorFormats(t);if(this.detector=new BarcodeDetector(a),!this.detector)throw"BarcodeDetector detector not supported"}return e.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var t=new BarcodeDetector({formats:["qr_code"]});return typeof t<"u"},e.prototype.decodeAsync=function(t){return IQe(this,void 0,void 0,function(){var r,s;return DQe(this,function(a){switch(a.label){case 0:return[4,this.detector.detect(t)];case 1:if(r=a.sent(),!r||r.length===0)throw"No barcode or QR code detected.";return s=this.selectLargestBarcode(r),[2,{text:s.rawValue,format:ite.create(this.toHtml5QrcodeSupportedFormats(s.format)),debugData:this.createDebugData()}]}})})},e.prototype.selectLargestBarcode=function(t){for(var r=null,s=0,a=0,i=t;a<i.length;a++){var o=i[a],c=o.boundingBox.width*o.boundingBox.height;c>s&&(s=c,r=o)}if(!r)throw"No largest barcode found";return r},e.prototype.createBarcodeDetectorFormats=function(t){for(var r=[],s=0,a=t;s<a.length;s++){var i=a[s];this.formatMap.has(i)?r.push(this.formatMap.get(i)):this.logger.warn("".concat(i," is not supported by")+"BarcodeDetectorDelegate")}return{formats:r}},e.prototype.toHtml5QrcodeSupportedFormats=function(t){if(!this.reverseFormatMap.has(t))throw"reverseFormatMap doesn't have ".concat(t);return this.reverseFormatMap.get(t)},e.prototype.createReverseFormatMap=function(){var t=new Map;return this.formatMap.forEach(function(r,s,a){t.set(r,s)}),t},e.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},e}(),kB=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{l(s.next(u))}catch(h){o(h)}}function d(u){try{l(s.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):a(u.value).then(c,d)}l((s=s.apply(e,t||[])).next())})},AB=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,a,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(l){return function(u){return d([l,u])}}function d(l){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(r=0)),r;)try{if(s=1,a&&(i=l[0]&2?a.return:l[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,l[1])).done)return i;switch(a=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(u){l=[6,u],a=0}finally{s=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},LQe=function(){function e(t,r,s,a){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=s,r&&EB.isSupported()?(this.primaryDecoder=new EB(t,s,a),this.secondaryDecoder=new CB(t,s,a)):this.primaryDecoder=new CB(t,s,a)}return e.prototype.decodeAsync=function(t){return kB(this,void 0,void 0,function(){var r;return AB(this,function(s){switch(s.label){case 0:r=performance.now(),s.label=1;case 1:return s.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(t)];case 2:return[2,s.sent()];case 3:return this.possiblyLogPerformance(r),[7];case 4:return[2]}})})},e.prototype.decodeRobustlyAsync=function(t){return kB(this,void 0,void 0,function(){var r,s;return AB(this,function(a){switch(a.label){case 0:r=performance.now(),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(t)];case 2:return[2,a.sent()];case 3:if(s=a.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(t)];throw s;case 4:return this.possiblyLogPerformance(r),[7];case 5:return[2]}})})},e.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},e.prototype.possiblyLogPerformance=function(t){if(this.verbose){var r=performance.now()-t;this.executionResults.push(r),this.executions++,this.possiblyFlushPerformanceReport()}},e.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var t=0,r=0,s=this.executionResults;r<s.length;r++){var a=s[r];t+=a}var i=t/this.executionResults.length;console.log("".concat(i," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},e}(),DT=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(s[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function s(){this.constructor=t}t.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}(),n_=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{l(s.next(u))}catch(h){o(h)}}function d(u){try{l(s.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):a(u.value).then(c,d)}l((s=s.apply(e,t||[])).next())})},s_=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,a,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(l){return function(u){return d([l,u])}}function d(l){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(r=0)),r;)try{if(s=1,a&&(i=l[0]&2?a.return:l[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,l[1])).done)return i;switch(a=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(u){l=[6,u],a=0}finally{s=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},lte=function(){function e(t,r){this.name=t,this.track=r}return e.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},e.prototype.apply=function(t){var r={};r[this.name]=t;var s={advanced:[r]};return this.track.applyConstraints(s)},e.prototype.value=function(){var t=this.track.getSettings();if(this.name in t){var r=t[this.name];return r}return null},e}(),BQe=function(e){DT(t,e);function t(r,s){return e.call(this,r,s)||this}return t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(r){var s={};s[this.name]=r;var a={advanced:[s]};return this.track.applyConstraints(a)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var r=this.track.getCapabilities(),s=r[this.name];return{min:s.min,max:s.max,step:s.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(lte),$Qe=function(e){DT(t,e);function t(r){return e.call(this,"zoom",r)||this}return t}(BQe),FQe=function(e){DT(t,e);function t(r){return e.call(this,"torch",r)||this}return t}(lte),zQe=function(){function e(t){this.track=t}return e.prototype.zoomFeature=function(){return new $Qe(this.track)},e.prototype.torchFeature=function(){return new FQe(this.track)},e}(),UQe=function(){function e(t,r,s){this.isClosed=!1,this.parentElement=t,this.mediaStream=r,this.callbacks=s,this.surface=this.createVideoElement(this.parentElement.clientWidth),t.append(this.surface)}return e.prototype.createVideoElement=function(t){var r=document.createElement("video");return r.style.width="".concat(t,"px"),r.style.display="block",r.muted=!0,r.setAttribute("muted","true"),r.playsInline=!0,r},e.prototype.setupSurface=function(){var t=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var r=function(){var s=t.surface.clientWidth,a=t.surface.clientHeight;t.callbacks.onRenderSurfaceReady(s,a),t.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(t,r,s,a){return n_(this,void 0,void 0,function(){var i,o;return s_(this,function(c){switch(c.label){case 0:return i=new e(t,r,a),s.aspectRatio?(o={aspectRatio:s.aspectRatio},[4,i.getFirstTrackOrFail().applyConstraints(o)]):[3,2];case 1:c.sent(),c.label=2;case 2:return i.setupSurface(),[2,i]}})})},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(t){this.failIfClosed();var r=this,s=function(){setTimeout(t,200),r.surface.removeEventListener("playing",s)};this.surface.addEventListener("playing",s),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(t){return n_(this,void 0,void 0,function(){return s_(this,function(r){if("aspectRatio"in t)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(t)]})})},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var t=this;return new Promise(function(r,s){var a=t.mediaStream.getVideoTracks(),i=a.length,o=0;t.mediaStream.getVideoTracks().forEach(function(c){t.mediaStream.removeTrack(c),c.stop(),++o,o>=i&&(t.isClosed=!0,t.parentElement.removeChild(t.surface),r())})})},e.prototype.getCapabilities=function(){return new zQe(this.getFirstTrackOrFail())},e}(),VQe=function(){function e(t){this.mediaStream=t}return e.prototype.render=function(t,r,s){return n_(this,void 0,void 0,function(){return s_(this,function(a){return[2,UQe.create(t,this.mediaStream,r,s)]})})},e.create=function(t){return n_(this,void 0,void 0,function(){var r,s;return s_(this,function(a){switch(a.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return r={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(r)];case 1:return s=a.sent(),[2,new e(s)]}})})},e}(),TB=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{l(s.next(u))}catch(h){o(h)}}function d(u){try{l(s.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):a(u.value).then(c,d)}l((s=s.apply(e,t||[])).next())})},PB=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,a,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(l){return function(u){return d([l,u])}}function d(l){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(r=0)),r;)try{if(s=1,a&&(i=l[0]&2?a.return:l[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,l[1])).done)return i;switch(a=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(u){l=[6,u],a=0}finally{s=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},qQe=function(){function e(){}return e.failIfNotSupported=function(){return TB(this,void 0,void 0,function(){return PB(this,function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]})})},e.prototype.create=function(t){return TB(this,void 0,void 0,function(){return PB(this,function(r){return[2,VQe.create(t)]})})},e}(),WQe=function(e,t,r,s){function a(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function c(u){try{l(s.next(u))}catch(h){o(h)}}function d(u){try{l(s.throw(u))}catch(h){o(h)}}function l(u){u.done?i(u.value):a(u.value).then(c,d)}l((s=s.apply(e,t||[])).next())})},HQe=function(e,t){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,a,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(l){return function(u){return d([l,u])}}function d(l){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(r=0)),r;)try{if(s=1,a&&(i=l[0]&2?a.return:l[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,l[1])).done)return i;switch(a=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,a=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){r.label=l[1];break}if(l[0]===6&&r.label<i[1]){r.label=i[1],i=l;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(l);break}i[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(u){l=[6,u],a=0}finally{s=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},GQe=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var t=Bm.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(t=Bm.insecureContextCameraQueryError()),Promise.reject(t)},e.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var t=location.host.split(":")[0];return t==="127.0.0.1"||t==="localhost"},e.getCamerasFromMediaDevices=function(){return WQe(this,void 0,void 0,function(){var t,r,s,a,i,o,c;return HQe(this,function(d){switch(d.label){case 0:return t=function(l){for(var u=l.getVideoTracks(),h=0,f=u;h<f.length;h++){var m=f[h];m.enabled=!1,m.stop(),l.removeTrack(m)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return r=d.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(s=d.sent(),a=[],i=0,o=s;i<o.length;i++)c=o[i],c.kind==="videoinput"&&a.push({id:c.deviceId,label:c.label});return t(r),[2,a]}})})},e.getCamerasFromMediaStreamTrack=function(){return new Promise(function(t,r){var s=function(i){for(var o=[],c=0,d=i;c<d.length;c++){var l=d[c];l.kind==="video"&&o.push({id:l.id,label:l.label})}t(o)},a=MediaStreamTrack;a.getSources(s)})},e}(),Ls;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NOT_STARTED=1]="NOT_STARTED",e[e.SCANNING=2]="SCANNING",e[e.PAUSED=3]="PAUSED"})(Ls||(Ls={}));var KQe=function(){function e(){this.state=Ls.NOT_STARTED,this.onGoingTransactionNewState=Ls.UNKNOWN}return e.prototype.directTransition=function(t){this.failIfTransitionOngoing(),this.validateTransition(t),this.state=t},e.prototype.startTransition=function(t){return this.failIfTransitionOngoing(),this.validateTransition(t),this.onGoingTransactionNewState=t,this},e.prototype.execute=function(){if(this.onGoingTransactionNewState===Ls.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var t=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Ls.UNKNOWN,this.directTransition(t)},e.prototype.cancel=function(){if(this.onGoingTransactionNewState===Ls.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Ls.UNKNOWN},e.prototype.getState=function(){return this.state},e.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Ls.UNKNOWN)throw"Cannot transition to a new state, already under transition"},e.prototype.validateTransition=function(t){switch(this.state){case Ls.UNKNOWN:throw"Transition from unknown is not allowed";case Ls.NOT_STARTED:this.failIfNewStateIs(t,[Ls.PAUSED]);break;case Ls.SCANNING:break;case Ls.PAUSED:break}},e.prototype.failIfNewStateIs=function(t,r){for(var s=0,a=r;s<a.length;s++){var i=a[s];if(t===i)throw"Cannot transition from ".concat(this.state," to ").concat(t)}},e}(),XQe=function(){function e(t){this.stateManager=t}return e.prototype.startTransition=function(t){return this.stateManager.startTransition(t)},e.prototype.directTransition=function(t){this.stateManager.directTransition(t)},e.prototype.getState=function(){return this.stateManager.getState()},e.prototype.canScanFile=function(){return this.stateManager.getState()===Ls.NOT_STARTED},e.prototype.isScanning=function(){return this.stateManager.getState()!==Ls.NOT_STARTED},e.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Ls.SCANNING},e.prototype.isPaused=function(){return this.stateManager.getState()===Ls.PAUSED},e}(),YQe=function(){function e(){}return e.create=function(){return new XQe(new KQe)},e}(),ZQe=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,a){s.__proto__=a}||function(s,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(s[i]=a[i])},e(t,r)};return function(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");e(t,r);function s(){this.constructor=t}t.prototype=r===null?Object.create(r):(s.prototype=r.prototype,new s)}}(),ao=function(e){ZQe(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.DEFAULT_WIDTH=300,t.DEFAULT_WIDTH_OFFSET=2,t.FILE_SCAN_MIN_HEIGHT=300,t.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,t.MIN_QR_BOX_SIZE=50,t.SHADED_LEFT=1,t.SHADED_RIGHT=2,t.SHADED_TOP=3,t.SHADED_BOTTOM=4,t.SHADED_REGION_ELEMENT_ID="qr-shaded-region",t.VERBOSE=!1,t.BORDER_SHADER_DEFAULT_COLOR="#ffffff",t.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",t}(TQe),QQe=function(){function e(t,r){this.logger=r,this.fps=ao.SCAN_DEFAULT_FPS,t?(t.fps&&(this.fps=t.fps),this.disableFlip=t.disableFlip===!0,this.qrbox=t.qrbox,this.aspectRatio=t.aspectRatio,this.videoConstraints=t.videoConstraints):this.disableFlip=ao.DEFAULT_DISABLE_FLIP}return e.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?ote.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},e.prototype.isShadedBoxEnabled=function(){return!Vc(this.qrbox)},e.create=function(t,r){return new e(t,r)},e}(),cte=function(){function e(t,r){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(t))throw"HTML Element with id=".concat(t," not found");this.elementId=t,this.verbose=!1;var s;typeof r=="boolean"?this.verbose=r===!0:r&&(s=r,this.verbose=s.verbose===!0,s.experimentalFeatures),this.logger=new OQe(this.verbose),this.qrcode=new LQe(this.getSupportedFormats(r),this.getUseBarCodeDetectorIfSupported(s),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=YQe.create()}return e.prototype.start=function(t,r,s,a){var i=this;if(!t)throw"cameraIdOrConfig is required";if(!s||typeof s!="function")throw"qrCodeSuccessCallback is required and should be a function.";var o;a?o=a:o=this.verbose?this.logger.log:function(){};var c=QQe.create(r,this.logger);this.clearElement();var d=!1;c.videoConstraints&&(c.isMediaStreamConstraintsValid()?d=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var l=d,u=document.getElementById(this.elementId);u.clientWidth?u.clientWidth:ao.DEFAULT_WIDTH,u.style.position="relative",this.shouldScan=!0,this.element=u;var h=this,f=this.stateManagerProxy.startTransition(Ls.SCANNING);return new Promise(function(m,p){var g=l?c.videoConstraints:h.createVideoConstraints(t);if(!g){f.cancel(),p("videoConstraints should be defined");return}var v={};(!l||c.aspectRatio)&&(v.aspectRatio=c.aspectRatio);var x={onRenderSurfaceReady:function(y,b){h.setupUi(y,b,c),h.isScanning=!0,h.foreverScan(c,s,o)}};qQe.failIfNotSupported().then(function(y){y.create(g).then(function(b){return b.render(i.element,v,x).then(function(j){h.renderedCamera=j,f.execute(),m(null)}).catch(function(j){f.cancel(),p(j)})}).catch(function(b){f.cancel(),p(Bm.errorGettingUserMedia(b))})}).catch(function(y){f.cancel(),p(Bm.cameraStreamingNotSupported())})})},e.prototype.pause=function(t){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Ls.PAUSED),this.showPausedState(),(Vc(t)||t!==!0)&&(t=!1),t&&this.renderedCamera&&this.renderedCamera.pause()},e.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var t=this,r=function(){t.stateManagerProxy.directTransition(Ls.SCANNING),t.hidePausedState()};if(!this.renderedCamera.isPaused()){r();return}this.renderedCamera.resume(function(){r()})},e.prototype.getState=function(){return this.stateManagerProxy.getState()},e.prototype.stop=function(){var t=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var r=this.stateManagerProxy.startTransition(Ls.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var s=function(){if(t.element){var i=document.getElementById(ao.SHADED_REGION_ELEMENT_ID);i&&t.element.removeChild(i)}},a=this;return this.renderedCamera.close().then(function(){return a.renderedCamera=null,a.element&&(a.element.removeChild(a.canvasElement),a.canvasElement=null),s(),a.qrRegion&&(a.qrRegion=null),a.context&&(a.context=null),r.execute(),a.hidePausedState(),a.isScanning=!1,Promise.resolve()})},e.prototype.scanFile=function(t,r){return this.scanFileV2(t,r).then(function(s){return s.decodedText})},e.prototype.scanFileV2=function(t,r){var s=this;if(!t||!(t instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(Vc(r)&&(r=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(a,i){s.possiblyCloseLastScanImageFile(),s.clearElement(),s.lastScanImageFile=URL.createObjectURL(t);var o=new Image;o.onload=function(){var c=o.width,d=o.height,l=document.getElementById(s.elementId),u=l.clientWidth?l.clientWidth:ao.DEFAULT_WIDTH,h=Math.max(l.clientHeight?l.clientHeight:d,ao.FILE_SCAN_MIN_HEIGHT),f=s.computeCanvasDrawConfig(c,d,u,h);if(r){var m=s.createCanvasElement(u,h,"qr-canvas-visible");m.style.display="inline-block",l.appendChild(m);var p=m.getContext("2d");if(!p)throw"Unable to get 2d context from canvas";p.canvas.width=u,p.canvas.height=h,p.drawImage(o,0,0,c,d,f.x,f.y,f.width,f.height)}var g=ao.FILE_SCAN_HIDDEN_CANVAS_PADDING,v=Math.max(o.width,f.width),x=Math.max(o.height,f.height),y=v+2*g,b=x+2*g,j=s.createCanvasElement(y,b);l.appendChild(j);var T=j.getContext("2d");if(!T)throw"Unable to get 2d context from canvas";T.canvas.width=y,T.canvas.height=b,T.drawImage(o,0,0,c,d,g,g,v,x);try{s.qrcode.decodeRobustlyAsync(j).then(function(O){a(SB.createFromQrcodeResult(O))}).catch(i)}catch(O){i("QR code parse error, error = ".concat(O))}},o.onerror=i,o.onabort=i,o.onstalled=i,o.onsuspend=i,o.src=URL.createObjectURL(t)})},e.prototype.clear=function(){this.clearElement()},e.getCameras=function(){return GQe.retrieve()},e.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},e.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},e.prototype.applyVideoConstraints=function(t){if(t){if(!ote.isMediaStreamConstraintsValid(t,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(t)},e.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},e.prototype.getSupportedFormats=function(t){var r=[lr.QR_CODE,lr.AZTEC,lr.CODABAR,lr.CODE_39,lr.CODE_93,lr.CODE_128,lr.DATA_MATRIX,lr.MAXICODE,lr.ITF,lr.EAN_13,lr.EAN_8,lr.PDF_417,lr.RSS_14,lr.RSS_EXPANDED,lr.UPC_A,lr.UPC_E,lr.UPC_EAN_EXTENSION];if(!t||typeof t=="boolean"||!t.formatsToSupport)return r;if(!Array.isArray(t.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(t.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var s=[],a=0,i=t.formatsToSupport;a<i.length;a++){var o=i[a];AQe(o)?s.push(o):this.logger.warn("Invalid format: ".concat(o," passed in config, ignoring."))}if(s.length===0)throw"None of formatsToSupport match supported values.";return s},e.prototype.getUseBarCodeDetectorIfSupported=function(t){if(Vc(t))return!0;if(!Vc(t.useBarCodeDetectorIfSupported))return t.useBarCodeDetectorIfSupported!==!1;if(Vc(t.experimentalFeatures))return!0;var r=t.experimentalFeatures;return Vc(r.useBarCodeDetectorIfSupported)?!0:r.useBarCodeDetectorIfSupported!==!1},e.prototype.validateQrboxSize=function(t,r,s){var a=this,i=s.qrbox;this.validateQrboxConfig(i);var o=this.toQrdimensions(t,r,i),c=function(l){if(l<ao.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(ao.MIN_QR_BOX_SIZE,"px.")},d=function(l){return l>t&&(a.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),l=t),l};c(o.width),c(o.height),o.width=d(o.width)},e.prototype.validateQrboxConfig=function(t){if(typeof t!="number"&&typeof t!="function"&&(t.width===void 0||t.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},e.prototype.toQrdimensions=function(t,r,s){if(typeof s=="number")return{width:s,height:s};if(typeof s=="function")try{return s(t,r)}catch(a){throw new Error("qrbox config was passed as a function but it failed with unknown error"+a)}return s},e.prototype.setupUi=function(t,r,s){s.isShadedBoxEnabled()&&this.validateQrboxSize(t,r,s);var a=Vc(s.qrbox)?{width:t,height:r}:s.qrbox;this.validateQrboxConfig(a);var i=this.toQrdimensions(t,r,a);i.height>r&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var o=s.isShadedBoxEnabled()&&i.height<=r,c={x:0,y:0,width:t,height:r},d=o?this.getShadedRegionBounds(t,r,i):c,l=this.createCanvasElement(d.width,d.height),u={willReadFrequently:!0},h=l.getContext("2d",u);h.canvas.width=d.width,h.canvas.height=d.height,this.element.append(l),o&&this.possiblyInsertShadingElement(this.element,t,r,i),this.createScannerPausedUiElement(this.element),this.qrRegion=d,this.context=h,this.canvasElement=l},e.prototype.createScannerPausedUiElement=function(t){var r=document.createElement("div");r.innerText=Bm.scannerPaused(),r.style.display="none",r.style.position="absolute",r.style.top="0px",r.style.zIndex="1",r.style.background="rgba(9, 9, 9, 0.46)",r.style.color="#FFECEC",r.style.textAlign="center",r.style.width="100%",t.appendChild(r),this.scannerPausedUiElement=r},e.prototype.scanContext=function(t,r){var s=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(a){return t(a.text,SB.createFromQrcodeResult(a)),s.possiblyUpdateShaders(!0),!0}).catch(function(a){s.possiblyUpdateShaders(!1);var i=Bm.codeParseError(a);return r(i,PQe.createFrom(i)),!1})},e.prototype.foreverScan=function(t,r,s){var a=this;if(this.shouldScan&&this.renderedCamera){var i=this.renderedCamera.getSurface(),o=i.videoWidth/i.clientWidth,c=i.videoHeight/i.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var d=this.qrRegion.width*o,l=this.qrRegion.height*c,u=this.qrRegion.x*o,h=this.qrRegion.y*c;this.context.drawImage(i,u,h,d,l,0,0,this.qrRegion.width,this.qrRegion.height);var f=function(){a.foreverScanTimeout=setTimeout(function(){a.foreverScan(t,r,s)},a.getTimeoutFps(t.fps))};this.scanContext(r,s).then(function(m){!m&&t.disableFlip!==!0?(a.context.translate(a.context.canvas.width,0),a.context.scale(-1,1),a.scanContext(r,s).finally(function(){f()})):f()}).catch(function(m){a.logger.logError("Error happend while scanning context",m),f()})}},e.prototype.createVideoConstraints=function(t){if(typeof t=="string")return{deviceId:{exact:t}};if(typeof t=="object"){var r="facingMode",s="deviceId",a={user:!0,environment:!0},i="exact",o=function(p){if(p in a)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(p,"'")},c=Object.keys(t);if(c.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(c.length," keys");var d=Object.keys(t)[0];if(d!==r&&d!==s)throw"Only '".concat(r,"' and '").concat(s,"' ")+" are supported for 'cameraIdOrConfig'";if(d===r){var l=t.facingMode;if(typeof l=="string"){if(o(l))return{facingMode:l}}else if(typeof l=="object")if(i in l){if(o(l["".concat(i)]))return{facingMode:{exact:l["".concat(i)]}}}else throw"'facingMode' should be string or object with"+" ".concat(i," as key.");else{var u=typeof l;throw"Invalid type of 'facingMode' = ".concat(u)}}else{var h=t.deviceId;if(typeof h=="string")return{deviceId:h};if(typeof h=="object"){if(i in h)return{deviceId:{exact:h["".concat(i)]}};throw"'deviceId' should be string or object with"+" ".concat(i," as key.")}else{var f=typeof h;throw"Invalid type of 'deviceId' = ".concat(f)}}}var m=typeof t;throw"Invalid type of 'cameraIdOrConfig' = ".concat(m)},e.prototype.computeCanvasDrawConfig=function(t,r,s,a){if(t<=s&&r<=a){var i=(s-t)/2,o=(a-r)/2;return{x:i,y:o,width:t,height:r}}else{var c=t,d=r;return t>s&&(r=s/t*r,t=s),r>a&&(t=a/r*t,r=a),this.logger.log("Image downsampled from "+"".concat(c,"X").concat(d)+" to ".concat(t,"X").concat(r,".")),this.computeCanvasDrawConfig(t,r,s,a)}},e.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var t=document.getElementById(this.elementId);t&&(t.innerHTML="")},e.prototype.possiblyUpdateShaders=function(t){this.qrMatch!==t&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(r){r.style.backgroundColor=t?ao.BORDER_SHADER_MATCH_COLOR:ao.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=t)},e.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},e.prototype.createCanvasElement=function(t,r,s){var a=t,i=r,o=document.createElement("canvas");return o.style.width="".concat(a,"px"),o.style.height="".concat(i,"px"),o.style.display="none",o.id=Vc(s)?"qr-canvas":s,o},e.prototype.getShadedRegionBounds=function(t,r,s){if(s.width>t||s.height>r)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(t-s.width)/2,y:(r-s.height)/2,width:s.width,height:s.height}},e.prototype.possiblyInsertShadingElement=function(t,r,s,a){if(!(r-a.width<1||s-a.height<1)){var i=document.createElement("div");i.style.position="absolute";var o=(r-a.width)/2,c=(s-a.height)/2;if(i.style.borderLeft="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderRight="".concat(o,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderTop="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderBottom="".concat(c,"px solid rgba(0, 0, 0, 0.48)"),i.style.boxSizing="border-box",i.style.top="0px",i.style.bottom="0px",i.style.left="0px",i.style.right="0px",i.id="".concat(ao.SHADED_REGION_ELEMENT_ID),r-a.width<11||s-a.height<11)this.hasBorderShaders=!1;else{var d=5,l=40;this.insertShaderBorders(i,l,d,-d,null,0,!0),this.insertShaderBorders(i,l,d,-d,null,0,!1),this.insertShaderBorders(i,l,d,null,-d,0,!0),this.insertShaderBorders(i,l,d,null,-d,0,!1),this.insertShaderBorders(i,d,l+d,-d,null,-d,!0),this.insertShaderBorders(i,d,l+d,null,-d,-d,!0),this.insertShaderBorders(i,d,l+d,-d,null,-d,!1),this.insertShaderBorders(i,d,l+d,null,-d,-d,!1),this.hasBorderShaders=!0}t.append(i)}},e.prototype.insertShaderBorders=function(t,r,s,a,i,o,c){var d=document.createElement("div");d.style.position="absolute",d.style.backgroundColor=ao.BORDER_SHADER_DEFAULT_COLOR,d.style.width="".concat(r,"px"),d.style.height="".concat(s,"px"),a!==null&&(d.style.top="".concat(a,"px")),i!==null&&(d.style.bottom="".concat(i,"px")),c?d.style.left="".concat(o,"px"):d.style.right="".concat(o,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(d),t.appendChild(d)},e.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},e.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},e.prototype.getTimeoutFps=function(t){return 1e3/t},e}(),OB;(function(e){e[e.STATUS_DEFAULT=0]="STATUS_DEFAULT",e[e.STATUS_SUCCESS=1]="STATUS_SUCCESS",e[e.STATUS_WARNING=2]="STATUS_WARNING",e[e.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(OB||(OB={}));function JQe({bags:e,onMarkBagSeparated:t,onMarkItemSeparated:r}){const[s,a]=P.useState(!1),[i,o]=P.useState(!1),[c,d]=P.useState(null),[l,u]=P.useState(null),[h,f]=P.useState([]),m=P.useRef(null),p="qr-scanner-container",g=async()=>{try{const q=new cte(p);m.current=q,await q.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},y,()=>{}),o(!0)}catch(q){console.error("Error starting scanner:",q),de.error("No foi possvel acessar a cmera")}},v=async()=>{if(m.current&&i)try{await m.current.stop(),m.current=null,o(!1)}catch(q){console.error("Error stopping scanner:",q)}},x=q=>{const X={...q,id:crypto.randomUUID(),timestamp:new Date};f(H=>[X,...H].slice(0,50))},y=async q=>{try{let X=null;const H=q.match(/\/sacola\/([a-f0-9-]+)/i);if(H)X=H[1];else try{X=JSON.parse(q).bagId}catch{X=null}const M=X?e.find(N=>N.id===X):null;if(!M){u("not_found"),d(null),x({bagNumber:0,instagram:"QR Invlido",result:"not_found"}),b("error");return}const F={bagId:M.id,bagNumber:M.bagNumber,instagram:M.instagramHandle,items:M.totalItems,total:M.totalValue};if(M.status==="separado"){u("already_done"),d(F),x({bagNumber:M.bagNumber,instagram:M.instagramHandle,result:"already_done",itemsCount:M.totalItems}),b("warning");return}const S=M.items.filter(N=>N.status==="em_separacao");let E=!0;for(const N of S)await r(N.id)||(E=!1);E&&S.length>0?(u("success"),d(F),x({bagNumber:M.bagNumber,instagram:M.instagramHandle,result:"success",itemsCount:S.length}),b("success"),de.success(`Sacola #${M.bagNumber.toString().padStart(3,"0")} marcada como separada!`)):S.length===0&&(u("already_done"),d(F),x({bagNumber:M.bagNumber,instagram:M.instagramHandle,result:"already_done",itemsCount:M.totalItems}),b("warning")),setTimeout(()=>{u(null),d(null)},2e3)}catch(X){console.error("Invalid QR code data:",X),u("not_found"),x({bagNumber:0,instagram:"QR Invlido",result:"not_found"}),b("error"),setTimeout(()=>{u(null)},2e3)}},b=q=>{const X={success:[523.25,659.25,783.99],warning:[440,440],error:[311.13,233.08]};try{const H=new(window.AudioContext||window.webkitAudioContext);X[q].forEach((F,S)=>{const E=H.createOscillator(),N=H.createGain();E.connect(N),N.connect(H.destination),E.frequency.value=F,E.type="sine",N.gain.setValueAtTime(.3,H.currentTime),N.gain.exponentialRampToValueAtTime(.01,H.currentTime+.3),E.start(H.currentTime+S*.1),E.stop(H.currentTime+.3+S*.1)})}catch{}},j=q=>q.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),T=q=>{switch(q){case"success":return n.jsx(Ae,{className:"bg-green-100 text-green-700 border-green-200 text-xs",children:"Separada"});case"already_done":return n.jsx(Ae,{className:"bg-amber-100 text-amber-700 border-amber-200 text-xs",children:"J feita"});case"not_found":return n.jsx(Ae,{variant:"destructive",className:"text-xs",children:"No encontrada"})}},O=()=>{a(!0),u(null),d(null)},R=async()=>{await v(),a(!1),u(null),d(null)},D=()=>{f([])};P.useEffect(()=>{if(s&&!i){const q=setTimeout(()=>{g()},100);return()=>clearTimeout(q)}},[s]),P.useEffect(()=>()=>{v()},[]);const L={success:h.filter(q=>q.result==="success").length,alreadyDone:h.filter(q=>q.result==="already_done").length,notFound:h.filter(q=>q.result==="not_found").length};return n.jsxs(n.Fragment,{children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:O,className:"gap-2",children:[n.jsx(Vx,{className:"h-4 w-4"}),"Scanner QR"]}),n.jsx(cn,{open:s,onOpenChange:q=>!q&&R(),children:n.jsxs(sn,{className:"sm:max-w-lg max-h-[90vh] flex flex-col",children:[n.jsxs(fn,{children:[n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(Ma,{className:"h-5 w-5"}),"Scanner de Sacolas"]}),n.jsx(Zo,{children:"Aponte a cmera para o QR code da etiqueta da sacola"})]}),n.jsxs("div",{className:"relative",children:[n.jsx("div",{id:p,className:"w-full aspect-square rounded-lg overflow-hidden bg-muted"}),l&&n.jsxs("div",{className:`absolute inset-0 flex flex-col items-center justify-center rounded-lg ${l==="success"?"bg-green-500/90":l==="already_done"?"bg-amber-500/90":"bg-red-500/90"}`,children:[l==="success"&&n.jsxs(n.Fragment,{children:[n.jsx(pn,{className:"h-16 w-16 text-white mb-3"}),n.jsx("p",{className:"text-white font-bold text-xl",children:"Separada!"}),c&&n.jsxs("p",{className:"text-white/90 text-lg",children:["Sacola #",c.bagNumber.toString().padStart(3,"0")]})]}),l==="already_done"&&n.jsxs(n.Fragment,{children:[n.jsx(Ut,{className:"h-16 w-16 text-white mb-3"}),n.jsx("p",{className:"text-white font-bold text-xl",children:"J Separada"}),c&&n.jsxs("p",{className:"text-white/90 text-lg",children:["Sacola #",c.bagNumber.toString().padStart(3,"0")]})]}),l==="not_found"&&n.jsxs(n.Fragment,{children:[n.jsx(Mr,{className:"h-16 w-16 text-white mb-3"}),n.jsx("p",{className:"text-white font-bold text-xl",children:"No Encontrada"}),n.jsx("p",{className:"text-white/90 text-sm",children:"QR code no pertence a esta live"})]})]})]}),n.jsxs("div",{className:"flex justify-between text-sm pt-2 border-t",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("span",{className:"text-green-600 font-medium",children:[" ",L.success]}),n.jsxs("span",{className:"text-amber-600 font-medium",children:[" ",L.alreadyDone]}),n.jsxs("span",{className:"text-red-600 font-medium",children:[" ",L.notFound]})]}),n.jsxs("div",{className:"text-muted-foreground",children:["Pendentes: ",e.filter(q=>q.status!=="separado"&&q.status!=="cancelado").length]})]}),h.length>0&&n.jsxs("div",{className:"border-t pt-3",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("h4",{className:"text-sm font-medium flex items-center gap-2",children:[n.jsx(gw,{className:"h-4 w-4"}),"Histrico de Leituras"]}),n.jsx(he,{variant:"ghost",size:"sm",onClick:D,className:"h-7 text-xs text-muted-foreground",children:"Limpar"})]}),n.jsx(bi,{className:"h-[150px]",children:n.jsx("div",{className:"space-y-2 pr-3",children:h.map(q=>n.jsxs("div",{className:`flex items-center justify-between p-2 rounded-lg text-sm ${q.result==="success"?"bg-green-50 border border-green-100":q.result==="already_done"?"bg-amber-50 border border-amber-100":"bg-red-50 border border-red-100"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("div",{className:"font-bold text-base",children:["#",q.bagNumber.toString().padStart(3,"0")]}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium text-primary",children:q.instagram}),q.itemsCount!==void 0&&n.jsxs("div",{className:"text-xs text-muted-foreground",children:[q.itemsCount," ",q.itemsCount===1?"item":"itens"]})]})]}),n.jsxs("div",{className:"flex flex-col items-end gap-1",children:[T(q.result),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[n.jsx(Br,{className:"h-3 w-3"}),j(q.timestamp)]})]})]},q.id))})})]}),n.jsxs(he,{variant:"outline",onClick:R,className:"w-full gap-2",children:[n.jsx(an,{className:"h-4 w-4"}),"Fechar Scanner"]})]})})]})}function eJe({eventId:e,eventTitle:t="Live"}){const[r,s]=P.useState("by_bag"),[a,i]=P.useState("all"),[o,c]=P.useState("bag_number"),[d,l]=P.useState(""),{bags:u,productGroups:h,kpis:f,isLoading:m,isGeneratingBags:p,generateBagNumbers:g,markItemSeparated:v,markItemCancelled:x,confirmItemRemoved:y,markBagSeparated:b,markAllProductItemsSeparated:j,markLabelPrinted:T,markLabelsAsPrinted:O,filterBags:R,filterProductGroups:D,fetchSeparationData:L,resolveReallocation:q}=RZe(e),X=R(a,o,d),H=D(d);if(m)return n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(en,{className:"h-8 w-8 animate-spin text-muted-foreground"})});const M=u.length===0;return n.jsxs("div",{className:"space-y-6",children:[n.jsx(MZe,{kpis:f}),M&&n.jsx(De,{className:"border-dashed",children:n.jsxs(Be,{className:"flex flex-col items-center justify-center py-12 gap-4",children:[n.jsx(Ut,{className:"h-16 w-16 text-muted-foreground"}),n.jsxs("div",{className:"text-center",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Iniciar Separao"}),n.jsx("p",{className:"text-sm text-muted-foreground max-w-md mx-auto mt-1",children:"Clique para gerar sacolas numeradas para todos os pedidos da live. Cada pedido receber um nmero sequencial nico."})]}),n.jsx(he,{size:"lg",onClick:g,disabled:p,className:"gap-2",children:p?n.jsxs(n.Fragment,{children:[n.jsx(en,{className:"h-4 w-4 animate-spin"}),"Gerando sacolas..."]}):n.jsxs(n.Fragment,{children:[n.jsx(lae,{className:"h-4 w-4"}),"Iniciar Separao"]})})]})}),!M&&n.jsx(n.Fragment,{children:n.jsx("div",{className:"flex flex-col gap-4",children:n.jsxs(pi,{value:r,onValueChange:F=>s(F),children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[n.jsxs(Qa,{className:"grid w-full sm:w-auto grid-cols-2",children:[n.jsxs(pr,{value:"by_bag",className:"gap-2",children:[n.jsx(ln,{className:"h-4 w-4"}),"Por Sacola"]}),n.jsxs(pr,{value:"by_product",className:"gap-2",children:[n.jsx(aae,{className:"h-4 w-4"}),"Por Produto"]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[r==="by_bag"&&u.length>0&&n.jsx(JQe,{bags:u,onMarkBagSeparated:b,onMarkItemSeparated:v}),r==="by_bag"&&X.length>0&&n.jsx(NQe,{bags:X,eventTitle:t,onLabelsAsPrinted:O}),n.jsxs(he,{variant:"outline",size:"sm",onClick:g,disabled:p,className:"gap-2",children:[p?n.jsx(en,{className:"h-4 w-4 animate-spin"}):n.jsx(en,{className:"h-4 w-4"}),"Re-sincronizar"]})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-4",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar por @, nmero, produto...",value:d,onChange:F=>l(F.target.value),className:"pl-9"})]}),r==="by_bag"&&n.jsxs(n.Fragment,{children:[n.jsxs(Kt,{value:a,onValueChange:F=>i(F),children:[n.jsxs(Vt,{className:"w-full sm:w-[160px]",children:[n.jsx(wd,{className:"h-4 w-4 mr-2"}),n.jsx(Xt,{placeholder:"Filtrar"})]}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos"}),n.jsx(ze,{value:"pending",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(en,{className:"h-3 w-3"})," Pendentes"]})}),n.jsx(ze,{value:"separated",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(pn,{className:"h-3 w-3"})," Separados"]})}),n.jsx(ze,{value:"attention",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(Mr,{className:"h-3 w-3"})," Ateno"]})}),n.jsx(ze,{value:"cancelled",children:n.jsxs("span",{className:"flex items-center gap-2",children:[n.jsx(qn,{className:"h-3 w-3"})," Cancelados"]})})]})]}),n.jsxs(Kt,{value:o,onValueChange:F=>c(F),children:[n.jsxs(Vt,{className:"w-full sm:w-[160px]",children:[n.jsx(Uz,{className:"h-4 w-4 mr-2"}),n.jsx(Xt,{placeholder:"Ordenar"})]}),n.jsxs(qt,{children:[n.jsx(ze,{value:"bag_number",children:"N Sacola"}),n.jsx(ze,{value:"instagram",children:"@Instagram"}),n.jsx(ze,{value:"status",children:"Status"})]})]})]})]}),n.jsx(wr,{value:"by_bag",className:"mt-4",children:n.jsx(EQe,{bags:X,eventTitle:t,onMarkItemSeparated:v,onMarkItemCancelled:x,onConfirmItemRemoved:y,onMarkBagSeparated:b,onLabelPrinted:T,onResolveReallocation:q})}),n.jsx(wr,{value:"by_product",className:"mt-4",children:n.jsx(kQe,{productGroups:H,onMarkItemSeparated:v,onMarkAllSeparated:j})})]})})})]})}function tJe(){const e=fr(),{eventId:t}=ra(),[r,s]=P.useState(!0),[a,i]=P.useState("");return P.useEffect(()=>{(async()=>{const{data:{session:c}}=await ce.auth.getSession();if(!c){e("/login");return}const{data:d}=await ce.from("user_roles").select("role").eq("user_id",c.user.id);if(!(d==null?void 0:d.some(u=>["merchant","admin"].includes(u.role)))){e("/");return}if(t){const{data:u}=await ce.from("live_events").select("titulo").eq("id",t).single();u&&i(u.titulo)}s(!1)})()},[e,t]),r?n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsx(Ut,{className:"h-8 w-8 animate-pulse text-muted-foreground"})}):n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:n.jsxs("div",{className:"container flex h-14 items-center gap-4 px-4",children:[n.jsx(he,{variant:"ghost",size:"icon",asChild:!0,children:n.jsx(Gt,{to:`/dashboard/lives/${t}/backstage`,children:n.jsx(vs,{className:"h-5 w-5"})})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Ut,{className:"h-5 w-5 text-primary"}),n.jsx("h1",{className:"text-lg font-semibold",children:"Separao (Ps-Live)"})]}),a&&n.jsxs("span",{className:"text-sm text-muted-foreground hidden sm:block",children:[" ",a]})]})}),n.jsx("main",{className:"container px-4 py-6",children:n.jsx(eJe,{eventId:t,eventTitle:a})})]})}function rJe(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function nJe({zipCode:e,onZipCodeChange:t,cartWeight:r=.5,cartDimensions:s={length:30,width:20,height:10},selectedQuote:a,onQuoteSelect:i,disabled:o=!1}){const[c,d]=P.useState(e),[l,u]=P.useState(!1),[h,f]=P.useState([]),[m,p]=P.useState(null),[g,v]=P.useState(null),x=b=>{const j=b.replace(/\D/g,"").slice(0,8);d(j),t==null||t(j)},y=async()=>{const b=c.replace(/\D/g,"");if(b.length!==8){p("CEP deve ter 8 dgitos");return}u(!0),p(null),v(null);try{const j={toZipCode:b,weight:r,length:s.length,width:s.width,height:s.height};console.log("[ShippingCalculator] Calculating shipping:",j);const{data:T,error:O}=await ce.functions.invoke("calculate-shipping",{body:j});if(console.log("[ShippingCalculator] Response:",T),O){console.error("[ShippingCalculator] Function error:",O),p("Erro ao calcular frete"),v(O.message||"Erro na comunicao com o servidor");return}if(T!=null&&T.error){p(T.error),v(T.details||null),T.quotes&&f(T.quotes);return}if(T!=null&&T.quotes&&T.quotes.length>0)if(f(T.quotes),!a)i(T.quotes[0]),de.success("Frete calculado! Selecione uma opo.");else{const R=T.quotes.find(D=>D.id===a.id);i(R||T.quotes[0]),de.success("Frete atualizado!")}else f([]),p("Nenhuma opo de frete disponvel"),v("Verifique se o CEP est correto ou tente outro CEP")}catch(j){console.error("[ShippingCalculator] Exception:",j),p("Erro de conexo"),v((j==null?void 0:j.message)||"Verifique sua conexo e tente novamente")}finally{u(!1)}};return n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{className:"flex items-center gap-2",children:[n.jsx(_o,{className:"h-4 w-4"}),"CEP de destino"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Qe,{value:c,onChange:b=>x(b.target.value),placeholder:"00000-000",maxLength:9,disabled:o||l,className:"flex-1"}),n.jsx(he,{variant:"secondary",onClick:y,disabled:o||l||c.length<8,children:l?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}),"Calculando..."]}):h.length>0?n.jsxs(n.Fragment,{children:[n.jsx(en,{className:"h-4 w-4 mr-2"}),"Recalcular"]}):"Calcular frete"})]})]}),m&&n.jsx(De,{className:"border-destructive/50 bg-destructive/5",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx(Mr,{className:"h-5 w-5 text-destructive mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-destructive",children:m}),g&&n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g}),n.jsxs(he,{variant:"outline",size:"sm",className:"mt-3",onClick:y,disabled:l,children:[n.jsx(en,{className:"h-4 w-4 mr-2"}),"Tentar novamente"]})]})]})})}),h.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{className:"flex items-center gap-2",children:[n.jsx(gn,{className:"h-4 w-4"}),"Escolha o servio"]}),n.jsx(wc,{value:(a==null?void 0:a.id)||"",onValueChange:b=>{const j=h.find(T=>T.id===b);j&&i(j)},children:h.map(b=>n.jsxs("label",{className:`flex items-center justify-between p-4 rounded-lg border cursor-pointer hover:bg-muted/50 transition-colors ${(a==null?void 0:a.id)===b.id?"border-primary bg-primary/5":"border-border"}`,children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Wi,{value:b.id}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium",children:b.name||b.serviceName}),n.jsx("p",{className:"text-sm text-muted-foreground",children:b.deliveryRange?`${b.deliveryRange.min}-${b.deliveryRange.max} dias teis`:`${b.deliveryDays||b.deliveryTime} dias teis`})]})]}),n.jsx("span",{className:"font-semibold",children:rJe(b.price)})]},b.id))})]})]})}function sJe(){var Je;const{cartId:e}=ra(),t=fr(),r=new URLSearchParams(window.location.search).get("token"),{user:s,isLoading:a}=Hn();P.useEffect(()=>{if(!a&&!s){const Ce=encodeURIComponent(window.location.pathname+window.location.search);t(`/entrar?redirect=${Ce}`)}},[s,a,t]);const[i,o]=P.useState(null),[c,d]=P.useState(!0),[l,u]=P.useState(null),[h,f]=P.useState("cart"),[m,p]=P.useState(""),[g,v]=P.useState(""),x=Kk(""),[y,b]=P.useState(""),[j,T]=P.useState("");P.useEffect(()=>{if(!s)return;(async()=>{try{const{data:Ge}=await ce.from("customers").select("id, name, phone, email, document, birth_date").eq("user_id",s.id).maybeSingle();if(Ge){Ge.name&&p(Ge.name),Ge.phone&&x.setDisplayValue(Ge.phone),Ge.email&&v(Ge.email),Ge.document&&b(Ge.document),Ge.birth_date&&T(Ge.birth_date);const{data:Pe}=await ce.from("customer_addresses").select("*").eq("customer_id",Ge.id).order("is_default",{ascending:!1}).limit(1).maybeSingle();Pe&&(Pe.zip_code&&R(Pe.zip_code),Pe.street&&L(Pe.street),Pe.number&&X(Pe.number),Pe.complement&&M(Pe.complement),Pe.neighborhood&&S(Pe.neighborhood),Pe.city&&N(Pe.city),Pe.state&&k(Pe.state),Pe.reference&&U(Pe.reference))}else{const{data:Pe}=await ce.from("profiles").select("name, whatsapp").eq("user_id",s.id).single();Pe&&(Pe.name&&p(Pe.name),Pe.whatsapp&&x.setDisplayValue(Pe.whatsapp))}s.email&&v(Pe=>Pe||s.email||"")}catch(Ge){console.error("Error pre-filling customer data:",Ge)}})()},[s]);const[O,R]=P.useState(""),[D,L]=P.useState(""),[q,X]=P.useState(""),[H,M]=P.useState(""),[F,S]=P.useState(""),[E,N]=P.useState(""),[C,k]=P.useState(""),[I,U]=P.useState(""),{isLoading:$,lookup:Y}=M8(),[Z,re]=P.useState("motoboy"),[G,J]=P.useState(null),[V,W]=P.useState(!1),[ee,ie]=P.useState("qualquer"),[oe,se]=P.useState(""),[le,ye]=P.useState(!1),[ue,ne]=P.useState(!1),pe=YG();P.useEffect(()=>{if(!e)return;const Ce=pe.coupon&&!pe.coupon.isBirthdayCoupon?pe.coupon.id:null,Ge=pe.discountAmount;ce.from("live_carts").update({coupon_id:Ce,coupon_discount:Ge}).eq("id",e).then(()=>{o(Pe=>Pe?{...Pe,coupon_discount:Ge}:null)})},[pe.coupon,pe.discountAmount,e]);const ge=async Ce=>{const Ge=(i==null?void 0:i.subtotal)||0;return pe.applyCoupon(Ce,Ge)},Ne=()=>{pe.removeCoupon()};m.trim()&&x.isValid;const _e=P.useCallback(async()=>{if(!e||!r){u("Link invlido - token ausente"),d(!1);return}try{const{data:Ce,error:Ge}=await ce.rpc("get_live_checkout",{p_cart_id:e,p_token:r});if(Ge){console.error("RPC error:",Ge),u("Erro ao carregar sacola"),d(!1);return}const Pe=Ce;if(Pe!=null&&Pe.error){u(Pe.error),d(!1);return}if(Pe.status==="pago"){de.success("Pagamento confirmado!"),t(`/pedido/sucesso?live_cart_id=${e}`);return}if(o(Pe),Pe.customer_name&&p(Pe.customer_name),Pe.known_phone?x.setDisplayValue(Pe.known_phone):Pe.customer_whatsapp&&x.setDisplayValue(Pe.customer_whatsapp),Pe.shipping_address_snapshot){const Ve=Pe.shipping_address_snapshot;Ve.street&&L(Ve.street),Ve.number&&X(Ve.number),Ve.complement&&M(Ve.complement),Ve.neighborhood&&S(Ve.neighborhood),Ve.city&&N(Ve.city),Ve.state&&k(Ve.state),Ve.zip_code&&R(Ve.zip_code),Ve.reference&&U(Ve.reference),Ve.document&&b(Ve.document)}}catch(Ce){console.error("Error loading cart:",Ce),u("Erro ao carregar carrinho")}finally{d(!1)}},[e,r]);P.useEffect(()=>{_e()},[_e]),P.useEffect(()=>{let Ce;return(i==null?void 0:i.status)==="aguardando_pagamento"&&(Ce=setInterval(()=>{_e()},5e3)),()=>clearInterval(Ce)},[i==null?void 0:i.status,_e]);const be=async()=>{const Ce=O.replace(/\D/g,"");if(Ce.length!==8){de.error("CEP invlido");return}const Ge=await Y(Ce);Ge&&(L(Ge.street),S(Ge.neighborhood),N(Ge.city),k(Ge.state))},Me=async()=>{if(!m.trim()){de.error("Preencha seu nome");return}if(!x.isValid){de.error("WhatsApp invlido");return}f("delivery")},Se=()=>Z==="motoboy"?Zs.motoboyFee:Z==="pickup"?0:Z==="shipping"&&G?G.price:0,$e=()=>Math.max(0,((i==null?void 0:i.subtotal)||0)-pe.discountAmount)+Se(),Ke=()=>(y||"").replace(/\D/g,"").length===11,Ze=()=>Z==="pickup"?!0:Z==="motoboy"?eK(V,ee):Z==="shipping"?!!G&&Ke():!1,it=async()=>{if(!Ze()){Z==="motoboy"&&!V&&de.error("Confirme seu endereo de entrega"),Z==="shipping"&&!G&&de.error("Selecione uma opo de frete"),Z==="shipping"&&!Ke()&&de.error("CPF obrigatrio para Correios");return}const Ce=Se(),Pe=[D,q,H,F].filter(Boolean).join(", "),Ve=y.replace(/\D/g,""),st={name:m,street:D,number:q,complement:H,neighborhood:F,city:E,state:C,zip_code:O,reference:I,document:Ve,full_address:`${Pe}, ${E} - ${C}, CEP ${O}`},xt=Z==="pickup"?"retirada":Z==="shipping"?"correios":"motoboy";ne(!0);try{const{data:fe,error:Ie}=await ce.rpc("save_live_checkout_details",{p_cart_id:e,p_token:r,p_name:m.trim(),p_phone:x.getNormalizedValue(),p_delivery_method:xt,p_delivery_period:Z==="motoboy"?ee:null,p_delivery_notes:(oe==null?void 0:oe.trim())||null,p_address_snapshot:st,p_shipping_fee:Ce,p_shipping_service_name:Z==="shipping"&&G?G.name||G.serviceName:null,p_shipping_deadline_days:Z==="shipping"&&G&&(G.deliveryDays||G.deliveryTime)||null,p_customer_notes:(oe==null?void 0:oe.trim())||null,p_user_id:(s==null?void 0:s.id)||null});if(Ie)throw Ie;const tt=fe;if(tt!=null&&tt.error){de.error(tt.error);return}if(s!=null&&s.id){const lt={};j&&(lt.birth_date=j),g&&(lt.email=g),Ve&&(lt.document=Ve),Object.keys(lt).length>0&&await ce.from("customers").update(lt).eq("user_id",s.id)}o(lt=>lt?{...lt,frete:Ce,total:tt.total||$e(),delivery_method:xt}:null),f("payment")}catch(fe){console.error("Error saving checkout details:",fe),de.error((fe==null?void 0:fe.message)||"Erro ao salvar dados")}finally{ne(!1)}},Re=async()=>{if(e){console.log("[Checkout] Iniciando pagamento...",{cartId:e,deliveryFee:Se(),payer:{email:g,nome:m,cpf:y.replace(/\D/g,"")}}),ye(!0);try{console.log("[Checkout] Invocando create-live-cart-payment...");const{data:Ce,error:Ge}=await ce.functions.invoke("create-live-cart-payment",{body:{live_cart_id:e,public_token:r,shipping_fee:Se(),payer_email:g.trim()||void 0,payer_name:m.trim()||void 0,payer_phone:x.getNormalizedValue()||void 0,payer_cpf:y.replace(/\D/g,"")||void 0,customer_notes:(oe==null?void 0:oe.trim())||null}});if(console.log("[Checkout] Retorno da Edge Function:",{data:Ce,error:Ge}),Ge){console.error("[Checkout] Erro na chamada RPC:",Ge);let Ve="Erro de conexo com o servidor.";try{typeof Ge=="string"&&(Ve=Ge),Ge.message&&(Ve=Ge.message),Ge.message==="Failed to fetch"&&(Ve="Erro de conexo (CORS/Network). Verifique sua internet.")}catch{}de.error(`${Ve} Tente novamente.`);return}if(Ce!=null&&Ce.error||Ce!=null&&Ce.error_code||Ce!=null&&Ce.message&&!(Ce!=null&&Ce.init_point)){console.error("[Checkout] Erro retornado pela API:",Ce),de.error(`Erro no pagamento: ${Ce.message||"Falha desconhecida"}`);return}const Pe=Ce.init_point||Ce.sandbox_init_point;Pe?(console.log("[Checkout] URL gerada com sucesso:",Pe),await ce.rpc("set_live_cart_preference",{p_cart_id:e,p_preference_id:Ce.preference_id,p_checkout_url:Pe,p_total:Ce.calculated_total||void 0}),pe.coupon&&await ZG(pe.coupon.id,null,e,pe.discountAmount,pe.coupon.isBirthdayCoupon),window.location.href=Pe):(console.error("[Checkout] Nenhuma URL retornada:",Ce),de.error("O Mercado Pago no retornou o link. Tente novamente."))}catch(Ce){console.error("[Checkout] Exceo crtica:",Ce),de.error(`Erro crtico: ${Ce.message||"Falha inesperada"}`)}finally{ye(!1)}}},ot=Ce=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Ce);if(c)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[n.jsx(At,{className:"h-5 w-5 animate-spin"}),n.jsx("span",{children:"Carregando carrinho..."})]})});if(l)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:n.jsx(De,{className:"max-w-md w-full",children:n.jsxs(Be,{className:"pt-6 text-center",children:[n.jsx(Mr,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),n.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Ops!"}),n.jsx("p",{className:"text-muted-foreground mb-4",children:l}),n.jsx(he,{variant:"outline",onClick:()=>t("/"),children:"Voltar para a loja"})]})})});const ut=((i==null?void 0:i.items)||[]).filter(Ce=>["reservado","confirmado","expirado","pending_separation"].includes(Ce.status)),bt=[{id:"cart",label:"Carrinho",icon:zi},{id:"registration",label:"Dados",icon:Wn},{id:"delivery",label:"Entrega",icon:gn},{id:"payment",label:"Pagamento",icon:xs}];return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:n.jsxs("div",{className:"max-w-2xl mx-auto px-4 py-3 flex items-center gap-3",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>t(-1),children:n.jsx(vs,{className:"h-5 w-5"})}),n.jsxs("div",{children:[n.jsx("h1",{className:"text-lg font-semibold",children:"Finalizar Pedido"}),n.jsx("p",{className:"text-xs text-muted-foreground",children:i==null?void 0:i.instagram_handle})]})]})}),n.jsx("div",{className:"max-w-2xl mx-auto px-4 py-4",children:n.jsx("div",{className:"flex items-center justify-between",children:bt.map((Ce,Ge)=>{const Pe=Ce.id===h,Ve=bt.findIndex(xt=>xt.id===h)>Ge,st=Ce.icon;return n.jsxs("div",{className:"flex items-center",children:[n.jsxs("div",{className:`flex items-center gap-2 ${Pe?"text-primary":Ve?"text-green-600":"text-muted-foreground"}`,children:[n.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${Pe?"bg-primary text-primary-foreground":Ve?"bg-green-100 text-green-600":"bg-muted"}`,children:Ve?n.jsx(Er,{className:"h-4 w-4"}):n.jsx(st,{className:"h-4 w-4"})}),n.jsx("span",{className:"text-xs hidden sm:inline",children:Ce.label})]}),Ge<bt.length-1&&n.jsx("div",{className:`w-8 sm:w-16 h-0.5 mx-2 ${Ve?"bg-green-300":"bg-muted"}`})]},Ce.id)})})}),n.jsxs("main",{className:"max-w-2xl mx-auto p-4 pb-32 space-y-4",children:[h==="cart"&&n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(zi,{className:"h-5 w-5"}),"Seus Itens"]})}),n.jsxs(Be,{className:"space-y-4",children:[ut.map(Ce=>n.jsxs("div",{className:`flex gap-3 p-3 border rounded-lg ${Ce.is_gift?"bg-green-50/50 border-green-100":""}`,children:[Ce.product_image?n.jsx("img",{src:Ce.product_image,alt:Ce.product_name,className:"w-16 h-16 object-cover rounded-md"}):Ce.is_gift?n.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-md flex items-center justify-center",children:n.jsx(Ut,{className:"h-8 w-8 text-green-600"})}):null,n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("h4",{className:"font-medium truncate text-sm sm:text-base",children:Ce.product_name}),Ce.is_gift&&n.jsx("span",{className:"text-[10px] bg-green-100 text-green-700 px-2 py-0.5 rounded-full font-bold uppercase tracking-wide",children:"Brinde"})]}),n.jsxs("div",{className:"text-sm text-muted-foreground",children:[Ce.size&&Ce.size!=="nico"&&n.jsxs("span",{children:["Tam: ",Ce.size]}),Ce.color&&Ce.color!=="nico"&&n.jsxs("span",{children:["  ",Ce.color]})]}),n.jsxs("div",{className:"flex items-center justify-between mt-1",children:[n.jsxs("span",{className:"text-sm",children:["Qtd: ",Ce.quantity]}),n.jsx("span",{className:`font-semibold ${Ce.is_gift?"text-green-600":""}`,children:Ce.is_gift?"Grtis":ot(Ce.unit_price*Ce.quantity)})]})]})]},Ce.id)),n.jsx(Ta,{}),n.jsxs("div",{className:"flex items-center justify-between text-lg font-semibold",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:ot((i==null?void 0:i.subtotal)||0)})]}),n.jsx(he,{className:"w-full",size:"lg",onClick:()=>f("registration"),children:"Continuar"})]})]}),h==="registration"&&n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(Wn,{className:"h-5 w-5"}),"Seus Dados"]})}),n.jsxs(Be,{className:"space-y-4",children:[(i==null?void 0:i.known_phone)&&n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-sm text-green-700 flex items-center gap-2",children:[n.jsx(Er,{className:"h-4 w-4 flex-shrink-0"}),n.jsx("span",{children:"Reconhecemos voc! WhatsApp preenchido automaticamente."})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Nome completo *"}),n.jsx(Qe,{value:m,onChange:Ce=>p(Ce.target.value),placeholder:"Seu nome completo"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"WhatsApp *"}),n.jsx(Qe,{value:x.displayValue,onChange:Ce=>x.setDisplayValue(Ce.target.value),placeholder:"(62) 99999-9999"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"E-mail"}),n.jsx(Qe,{type:"email",value:g,onChange:Ce=>v(Ce.target.value),placeholder:"seu@email.com"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Data de aniversrio"}),n.jsx(Qe,{type:"date",value:j,onChange:Ce=>T(Ce.target.value),max:new Date().toISOString().split("T")[0]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Para desconto especial no ms do seu aniversrio "})]}),n.jsx(Ta,{}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Endereo (necessrio para entrega)"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"CEP"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Qe,{value:O,onChange:Ce=>R(Ce.target.value.replace(/\D/g,"").slice(0,8)),placeholder:"00000-000",maxLength:9}),n.jsx(he,{variant:"outline",onClick:be,disabled:$,children:$?n.jsx(At,{className:"h-4 w-4 animate-spin"}):"Buscar"})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.jsxs("div",{className:"col-span-2 space-y-2",children:[n.jsx(Le,{children:"Rua"}),n.jsx(Qe,{value:D,onChange:Ce=>L(Ce.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Nmero"}),n.jsx(Qe,{value:q,onChange:Ce=>X(Ce.target.value)})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Complemento"}),n.jsx(Qe,{value:H,onChange:Ce=>M(Ce.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Bairro"}),n.jsx(Qe,{value:F,onChange:Ce=>S(Ce.target.value)})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Cidade"}),n.jsx(Qe,{value:E,onChange:Ce=>N(Ce.target.value)})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Estado"}),n.jsx(Qe,{value:C,onChange:Ce=>k(Ce.target.value),maxLength:2})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"CPF (obrigatrio para Correios)"}),n.jsx(Qe,{value:y.replace(/\D/g,"").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"),onChange:Ce=>b(Ce.target.value.replace(/\D/g,"").slice(0,11)),placeholder:"000.000.000-00",maxLength:14})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Referncia"}),n.jsx(Qe,{value:I,onChange:Ce=>U(Ce.target.value),placeholder:"Prximo a..."})]}),n.jsxs("div",{className:"flex gap-2 pt-4",children:[n.jsx(he,{variant:"outline",onClick:()=>f("cart"),children:"Voltar"}),n.jsx(he,{className:"flex-1",onClick:Me,disabled:!m.trim()||!x.isValid,children:"Continuar"})]})]})]}),h==="delivery"&&n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(gn,{className:"h-5 w-5"}),"Entrega"]})}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs(wc,{value:Z,onValueChange:Ce=>{re(Ce),Ce!=="motoboy"&&W(!1)},children:[n.jsxs("label",{className:`flex items-center gap-3 p-4 border rounded-lg cursor-pointer hover:bg-muted/50 transition-colors ${Z==="motoboy"?"border-primary bg-primary/5":""}`,children:[n.jsx(Wi,{value:"motoboy"}),n.jsx(Ut,{className:"h-5 w-5 text-muted-foreground"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:"Motoboy (Anpolis)"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:Zs.motoboyDeliveryText})]}),n.jsx("span",{className:"font-semibold",children:ot(Zs.motoboyFee)})]}),n.jsxs("label",{className:`flex items-center gap-3 p-4 border rounded-lg cursor-pointer hover:bg-muted/50 transition-colors ${Z==="pickup"?"border-primary bg-primary/5":""}`,children:[n.jsx(Wi,{value:"pickup"}),n.jsx(pa,{className:"h-5 w-5 text-muted-foreground"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:"Retirar na Loja"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:Zs.storeAddress}),n.jsx("p",{className:"text-xs text-muted-foreground",children:Zs.storeHours})]}),n.jsx("span",{className:"font-semibold text-green-600",children:"Grtis"})]}),n.jsxs("label",{className:`flex items-start gap-3 p-4 border rounded-lg cursor-pointer hover:bg-muted/50 transition-colors ${Z==="shipping"?"border-primary bg-primary/5":""}`,children:[n.jsx(Wi,{value:"shipping",className:"mt-1"}),n.jsx(_o,{className:"h-5 w-5 text-muted-foreground mt-0.5"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium",children:"Enviar para outra cidade"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Correios (PAC/SEDEX)"})]})]})]}),Z==="motoboy"&&n.jsx(JG,{address:{street:D,number:q,complement:H,neighborhood:F,city:E,state:C,zipCode:O,reference:I},onAddressConfirmed:({period:Ce,notes:Ge})=>{W(!0),ie(Ce),se(Ge)},onEditAddress:()=>f("registration"),initialPeriod:ee,initialNotes:oe}),Z==="pickup"&&n.jsx(tK,{notes:oe,onNotesChange:se}),Z==="shipping"&&n.jsxs(n.Fragment,{children:[n.jsx(nJe,{zipCode:O,onZipCodeChange:R,cartWeight:.5,cartDimensions:{length:30,width:20,height:15},selectedQuote:G,onQuoteSelect:J}),n.jsxs("div",{className:"space-y-2 pt-2",children:[n.jsxs(Le,{htmlFor:"cpf-shipping",className:"flex items-center gap-1",children:["CPF do destinatrio ",n.jsx("span",{className:"text-red-500",children:"*"})]}),n.jsx(Qe,{id:"cpf-shipping",value:y?y.replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2"):"",onChange:Ce=>b(Ce.target.value.replace(/\D/g,"").slice(0,11)),placeholder:"000.000.000-00",maxLength:14,className:Ke()?"":"border-red-500"}),!Ke()&&n.jsxs("p",{className:"text-xs text-red-600 flex items-center gap-1",children:[n.jsx(Mr,{className:"h-3 w-3"}),"CPF obrigatrio para gerar etiqueta dos Correios (11 dgitos)"]})]})]}),n.jsx(Ta,{}),n.jsxs("div",{className:"space-y-2 text-sm",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Subtotal"}),n.jsx("span",{children:ot((i==null?void 0:i.subtotal)||0)})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Entrega"}),n.jsx("span",{children:Se()===0?n.jsx("span",{className:"text-green-600",children:"Grtis"}):ot(Se())})]}),n.jsxs("div",{className:"flex justify-between text-lg font-semibold pt-2 border-t",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:ot($e())})]})]}),n.jsxs("div",{className:"flex gap-2 pt-4",children:[n.jsx(he,{variant:"outline",onClick:()=>f("registration"),children:"Voltar"}),n.jsxs(he,{className:"flex-1",onClick:it,disabled:ue||!Ze(),children:[ue?n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}):null,"Continuar para Pagamento"]})]})]})]}),h==="payment"&&n.jsxs(De,{children:[n.jsx(Ot,{children:n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(xs,{className:"h-5 w-5"}),"Pagamento"]})}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[n.jsx("h4",{className:"font-medium",children:"Resumo do Pedido"}),n.jsxs("div",{className:"text-sm space-y-1",children:[n.jsxs("div",{className:"flex justify-between",children:[n.jsxs("span",{children:[ut.length," ",ut.length===1?"item":"itens"]}),n.jsx("span",{children:ot((i==null?void 0:i.subtotal)||0)})]}),pe.discountAmount>0&&n.jsxs("div",{className:"flex justify-between text-green-600",children:[n.jsxs("span",{children:["Cupom (",(Je=pe.coupon)==null?void 0:Je.code,")"]}),n.jsxs("span",{children:["-",ot(pe.discountAmount)]})]}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("span",{children:"Entrega"}),n.jsx("span",{children:ot((i==null?void 0:i.frete)||0)})]})]}),n.jsxs("div",{className:"flex justify-between text-lg font-semibold pt-2 border-t",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:ot(Math.max(0,((i==null?void 0:i.subtotal)||0)-pe.discountAmount)+((i==null?void 0:i.frete)||0))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{className:"text-sm font-medium",children:"Cupom de desconto"}),n.jsx(QG,{onApply:ge,onRemove:Ne,appliedCoupon:pe.coupon?{code:pe.coupon.code,discountAmount:pe.discountAmount}:null,isLoading:pe.isLoading,error:pe.error,orderTotal:(i==null?void 0:i.subtotal)||0})]}),n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-green-700 font-medium mb-2",children:[n.jsx(Er,{className:"h-5 w-5"}),"Pagamento Seguro"]}),n.jsx("p",{className:"text-sm text-green-600",children:"Voc ser redirecionada para o Mercado Pago para concluir o pagamento com segurana."})]}),n.jsxs("div",{className:"flex gap-2 pt-4",children:[n.jsx(he,{variant:"outline",onClick:()=>f("delivery"),children:"Voltar"}),n.jsx(he,{className:"flex-1 bg-[#009ee3] hover:bg-[#007bbd]",size:"lg",onClick:Re,disabled:le,children:le?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}),"Gerando pagamento..."]}):n.jsxs(n.Fragment,{children:[n.jsx(xs,{className:"h-4 w-4 mr-2"}),"Pagar com Mercado Pago"]})})]})]})]})]})]})}const RB=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),aJe=e=>{switch(e){case"pago":return{label:"Pago",variant:"default",icon:pn,tone:"primary"};case"aguardando_pagamento":return{label:"Aguardando Pagamento",variant:"secondary",icon:Br,tone:"muted"};case"cancelado":case"expirado":return{label:e==="cancelado"?"Cancelado":"Expirado",variant:"destructive",icon:qn,tone:"destructive"};default:return{label:"Em Aberto",variant:"outline",icon:Ut,tone:"muted"}}},iJe=e=>{switch(e){case"motoboy":return{label:"Entrega Motoboy",icon:rc};case"pickup":return{label:"Retirada na Loja",icon:pa};case"shipping":return{label:"Envio Correios",icon:gn};default:return{label:"No definido",icon:gn}}};function oJe(){const{bagId:e}=ra(),t=new URLSearchParams(window.location.search).get("token"),[r,s]=P.useState(null),[a,i]=P.useState(!0),[o,c]=P.useState(null),[d,l]=P.useState(!1);P.useEffect(()=>{e&&u()},[e]);const u=async()=>{try{i(!0),c(null);const{data:b,error:j}=await ce.functions.invoke("get-live-cart-public",{body:{live_cart_id:e,public_token:t}});if(j){console.error("Error invoking get-live-cart-public:",j),c("Sacola no encontrada");return}if(!(b!=null&&b.id)){c("Sacola no encontrada");return}s(b)}catch(b){console.error("Error fetching bag details:",b),c("Erro ao carregar detalhes da sacola")}finally{i(!1)}},h=async()=>{if(r){l(!0);try{const{data:b,error:j}=await ce.functions.invoke("create-live-cart-payment",{body:{live_cart_id:r.id}});if(j)throw j;const T=b==null?void 0:b.init_point;T?(s(O=>O?{...O,mpCheckoutUrl:T}:null),de.success("Link de pagamento gerado!")):de.error("No foi possvel obter o link de pagamento")}catch(b){console.error("Error generating payment:",b),de.error("Erro ao gerar link de pagamento")}finally{l(!1)}}};if(a)return n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:n.jsxs("div",{className:"text-center",children:[n.jsx(At,{className:"h-8 w-8 animate-spin text-primary mx-auto mb-4"}),n.jsx("p",{className:"text-muted-foreground",children:"Carregando detalhes..."})]})});if(o||!r)return n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background p-4",children:n.jsx(De,{className:"max-w-md w-full",children:n.jsxs(Be,{className:"pt-6 text-center",children:[n.jsx(Mr,{className:"h-12 w-12 text-destructive mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Sacola no encontrada"}),n.jsx("p",{className:"text-muted-foreground",children:o||"O QR code pode ser invlido ou a sacola foi removida."})]})})});const f=aJe(r.status),m=iJe(r.deliveryMethod),p=f.icon,g=m.icon,v=f.tone==="destructive"?"text-destructive":f.tone==="primary"?"text-primary":"text-muted-foreground",x=r.status==="pago",y=!x&&r.status!=="cancelado"&&r.status!=="expirado";return n.jsx("div",{className:"min-h-screen bg-background py-8 px-4",children:n.jsxs("div",{className:"max-w-md mx-auto space-y-4",children:[n.jsx(De,{children:n.jsxs(Ot,{className:"text-center pb-2",children:[n.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:r.eventTitle}),n.jsxs(Mt,{className:"text-4xl font-bold",children:["#",r.bagNumber.toString().padStart(3,"0")]}),n.jsx("p",{className:"text-lg font-semibold text-primary",children:r.instagramHandle}),r.customerName&&n.jsx("p",{className:"text-sm text-muted-foreground",children:r.customerName})]})}),n.jsx(De,{className:"border-2 border-border",children:n.jsx(Be,{className:"pt-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(p,{className:`h-8 w-8 ${v}`}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Status do Pagamento"}),n.jsx("p",{className:`text-lg font-bold ${v}`,children:f.label})]})]}),n.jsx(Ae,{variant:f.variant,className:"text-base px-4 py-1",children:x?"OK":"Pendente"})]})})}),n.jsx(De,{children:n.jsx(Be,{className:"pt-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center",children:n.jsx(g,{className:"h-6 w-6 text-muted-foreground"})}),n.jsxs("div",{children:[n.jsx("p",{className:"text-sm text-muted-foreground",children:"Mtodo de Entrega"}),n.jsx("p",{className:"text-lg font-semibold",children:m.label})]})]})})}),n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-base flex items-center gap-2",children:[n.jsx(Ut,{className:"h-4 w-4"}),"Itens da Sacola (",r.totalItems,")"]})}),n.jsxs(Be,{className:"space-y-3",children:[r.items.map(b=>n.jsxs("div",{className:"flex justify-between items-start py-2 border-b last:border-0",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-sm",children:b.productName}),n.jsx("p",{className:"text-xs text-muted-foreground",children:[b.color,b.size].filter(Boolean).join("  ")})]}),n.jsx("div",{className:"text-right",children:n.jsxs("p",{className:"text-sm font-medium",children:[b.quantity,"x ",RB(b.unitPrice)]})})]},b.id)),n.jsx(Ta,{}),n.jsxs("div",{className:"flex justify-between items-center pt-2",children:[n.jsx("span",{className:"text-lg font-bold",children:"Total"}),n.jsx("span",{className:"text-xl font-bold text-primary",children:RB(r.totalValue)})]})]})]}),y&&n.jsx(De,{className:"border-primary",children:n.jsxs(Be,{className:"pt-4 space-y-4",children:[n.jsxs("div",{className:"flex items-center gap-3 text-primary",children:[n.jsx(xs,{className:"h-6 w-6"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-semibold",children:"Pagamento Pendente"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Clique abaixo para gerar ou acessar o link de pagamento"})]})]}),r.mpCheckoutUrl?n.jsxs(he,{className:"w-full gap-2",size:"lg",onClick:()=>window.open(r.mpCheckoutUrl,"_blank"),children:[n.jsx(ma,{className:"h-4 w-4"}),"Ir para Pagamento"]}):n.jsxs(he,{className:"w-full gap-2",size:"lg",onClick:h,disabled:d,children:[d?n.jsx(At,{className:"h-4 w-4 animate-spin"}):n.jsx(xs,{className:"h-4 w-4"}),d?"Gerando...":"Gerar Link de Pagamento"]})]})}),x&&n.jsx(De,{className:"bg-secondary border-border",children:n.jsx(Be,{className:"pt-4",children:n.jsxs("div",{className:"flex items-center gap-3 text-primary",children:[n.jsx(pn,{className:"h-8 w-8"}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold text-lg",children:"Pagamento Confirmado!"}),n.jsx("p",{className:"text-sm",children:"Esta sacola est pronta para separao/entrega."})]})]})})}),n.jsxs("p",{className:"text-center text-xs text-muted-foreground pt-4",children:["Sacola criada em ",new Date(r.createdAt).toLocaleDateString("pt-BR")]})]})})}const lJe=e=>{const t=e.total>0?e.paid/e.total*100:0,r=e.totalValue>0?e.paidValue/e.totalValue*100:0,s=e.paid>0?e.paidValue/e.paid:0,a=Math.min(s/500*100,100);return t*.4+r*.4+a*.2},cJe=e=>{switch(e){case 1:return n.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-yellow-100",children:n.jsx(Ei,{className:"h-5 w-5 text-yellow-600"})});case 2:return n.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-slate-200",children:n.jsx(mO,{className:"h-5 w-5 text-slate-500"})});case 3:return n.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-amber-100",children:n.jsx(mO,{className:"h-5 w-5 text-amber-700"})});default:return n.jsxs("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-muted text-muted-foreground font-bold text-sm",children:[e,""]})}},dJe=e=>e>=70?n.jsxs(Ae,{className:"bg-green-100 text-green-700 border-green-300 gap-1",children:[n.jsx(nae,{className:"h-3 w-3"}),"Excelente"]}):e>=50?n.jsxs(Ae,{className:"bg-blue-100 text-blue-700 border-blue-300 gap-1",children:[n.jsx(ba,{className:"h-3 w-3"}),"Bom"]}):e>=30?n.jsx(Ae,{className:"bg-amber-100 text-amber-700 border-amber-300 gap-1",children:"Regular"}):n.jsxs(Ae,{className:"bg-red-100 text-red-700 border-red-300 gap-1",children:[n.jsx(zz,{className:"h-3 w-3"}),"Baixo"]});function uJe({liveStats:e,formatCurrency:t}){if(e.length<2)return null;const r=e.map(d=>({...d,conversionRate:d.total>0?d.paid/d.total*100:0,valueConversionRate:d.totalValue>0?d.paidValue/d.totalValue*100:0,averageTicket:d.paid>0?d.paidValue/d.paid:0,score:lJe(d),rank:0})).sort((d,l)=>l.score-d.score).map((d,l)=>({...d,rank:l+1})),s=r.reduce((d,l)=>d+l.conversionRate,0)/r.length,a=r.reduce((d,l)=>d+l.valueConversionRate,0)/r.length,i=r.filter(d=>d.averageTicket>0).reduce((d,l)=>d+l.averageTicket,0)/r.filter(d=>d.averageTicket>0).length||0,o=r[0],c=r[r.length-1];return n.jsxs(De,{children:[n.jsxs(Ot,{className:"pb-3",children:[n.jsxs(Mt,{className:"flex items-center gap-2 text-lg",children:[n.jsx(ga,{className:"h-5 w-5 text-yellow-500"}),"Ranking de Performance"]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Comparao automtica entre lives rastreadas"})]}),n.jsxs(Be,{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[n.jsx(De,{className:"bg-gradient-to-br from-yellow-50 to-amber-50 border-yellow-200",children:n.jsxs(Be,{className:"pt-4 pb-3",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(Ei,{className:"h-5 w-5 text-yellow-600"}),n.jsx("span",{className:"text-xs font-medium text-yellow-700",children:"Melhor Performance"})]}),n.jsx("p",{className:"font-semibold text-sm truncate",children:o.eventTitle}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsxs("span",{className:"text-lg font-bold text-yellow-700",children:[o.conversionRate.toFixed(0),"%"]}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"converso"})]})]})}),n.jsx(De,{className:"bg-muted/30",children:n.jsxs(Be,{className:"pt-4 pb-3",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(ba,{className:"h-5 w-5 text-muted-foreground"}),n.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Mdia Geral"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-center",children:[n.jsxs("div",{children:[n.jsxs("p",{className:"text-lg font-bold",children:[s.toFixed(0),"%"]}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Converso"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-lg font-bold",children:t(i)}),n.jsx("p",{className:"text-xs text-muted-foreground",children:"Ticket"})]})]})]})}),n.jsx(De,{className:"bg-red-50/50 border-red-200",children:n.jsxs(Be,{className:"pt-4 pb-3",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx(zz,{className:"h-5 w-5 text-red-500"}),n.jsx("span",{className:"text-xs font-medium text-red-700",children:"Menor Performance"})]}),n.jsx("p",{className:"font-semibold text-sm truncate",children:c.eventTitle}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsxs("span",{className:"text-lg font-bold text-red-600",children:[c.conversionRate.toFixed(0),"%"]}),n.jsx("span",{className:"text-xs text-muted-foreground",children:"converso"})]})]})})]}),n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{className:"bg-muted/50",children:[n.jsx(jt,{className:"w-12 text-center",children:"#"}),n.jsx(jt,{children:"Live"}),n.jsx(jt,{className:"text-center",children:"Converso"}),n.jsx(jt,{className:"text-center hidden sm:table-cell",children:"Valor Conv."}),n.jsx(jt,{className:"text-center hidden md:table-cell",children:"Ticket Mdio"}),n.jsx(jt,{className:"text-center",children:"Performance"})]})}),n.jsx(Na,{children:r.map(d=>{const l=d.conversionRate>s;return n.jsxs(Qr,{className:d.rank<=3?"bg-muted/20":"",children:[n.jsx(yt,{className:"text-center",children:cJe(d.rank)}),n.jsx(yt,{children:n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm truncate max-w-[150px]",children:d.eventTitle}),n.jsx("p",{className:"text-xs text-muted-foreground",children:Ht(new Date(d.eventDate),"dd/MM/yy",{locale:gr})})]})}),n.jsx(yt,{className:"text-center",children:n.jsxs("div",{className:"flex flex-col items-center",children:[n.jsxs("span",{className:`font-semibold ${l?"text-green-600":"text-muted-foreground"}`,children:[d.conversionRate.toFixed(0),"%"]}),n.jsxs("span",{className:"text-xs text-muted-foreground",children:[d.paid,"/",d.total]})]})}),n.jsx(yt,{className:"text-center hidden sm:table-cell",children:n.jsxs("span",{className:`font-medium ${d.valueConversionRate>a?"text-green-600":"text-muted-foreground"}`,children:[d.valueConversionRate.toFixed(0),"%"]})}),n.jsx(yt,{className:"text-center hidden md:table-cell",children:n.jsx("span",{className:"font-medium",children:t(d.averageTicket)})}),n.jsx(yt,{className:"text-center",children:dJe(d.score)})]},d.eventTitle)})})]})}),n.jsx("div",{className:"flex flex-wrap gap-2 justify-center text-xs text-muted-foreground pt-2",children:n.jsx("span",{children:"Score = 40% converso + 40% valor + 20% ticket"})})]})]})}const MB="bag-tracker-bags",IB="bag-tracker-alert-days",DB=3,Z4=e=>{const t=new Date(e),s=new Date().getTime()-t.getTime();return Math.floor(s/(1e3*60*60*24))},hJe=(e,t)=>e>=7?{label:`${e}d`,color:"bg-red-100 text-red-700 border-red-300",urgent:!0}:e>=t?{label:`${e}d`,color:"bg-amber-100 text-amber-700 border-amber-300",urgent:!0}:e>=1?{label:`${e}d`,color:"bg-muted text-muted-foreground",urgent:!1}:{label:"Hoje",color:"bg-muted text-muted-foreground",urgent:!1};function fJe(){const[e,t]=P.useState(!1),[r,s]=P.useState(()=>{try{const G=localStorage.getItem(MB);return G?JSON.parse(G):[]}catch{return[]}}),[a,i]=P.useState(!1),[o,c]=P.useState(""),[d,l]=P.useState("all"),[u,h]=P.useState(()=>{try{const G=localStorage.getItem(IB);return G?parseInt(G,10):DB}catch{return DB}}),f=P.useRef(null),m="bag-tracker-scanner";P.useEffect(()=>{localStorage.setItem(IB,u.toString())},[u]),P.useEffect(()=>{localStorage.setItem(MB,JSON.stringify(r))},[r]);const p=async()=>{try{const G=new cte(m);f.current=G,await G.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:250}},v,()=>{}),t(!0)}catch(G){console.error("Error starting scanner:",G),de.error("No foi possvel acessar a cmera")}},g=async()=>{if(f.current&&e)try{await f.current.stop(),f.current=null,t(!1)}catch(G){console.error("Error stopping scanner:",G)}},v=async G=>{let J=null;const V=G.match(/\/sacola\/([a-f0-9-]+)/i);if(V)J=V[1];else try{J=JSON.parse(G).bagId}catch{J=null}if(!J){L("error"),de.error("QR code invlido");return}if(r.some(W=>W.id===J)){L("warning"),de.info("Sacola j adicionada  lista");return}await x(J)},x=async G=>{var J,V,W,ee,ie;i(!0);try{const{data:oe,error:se}=await ce.functions.invoke("get-live-cart-public",{body:{bagId:G}});if(se||!(oe!=null&&oe.bag)){L("error"),de.error("Sacola no encontrada");return}const le=oe.bag;let ye="No definido";le.order_id&&(ye="Ver pedido");const ue={id:le.id,bagNumber:le.bag_number||0,instagram:((J=le.live_customers)==null?void 0:J.instagram_handle)||"Desconhecido",whatsapp:(V=le.live_customers)==null?void 0:V.whatsapp,status:le.status,deliveryMethod:ye,total:le.total||0,itemsCount:((W=oe.items)==null?void 0:W.length)||0,eventTitle:((ee=le.live_events)==null?void 0:ee.titulo)||"Live",eventDate:((ie=le.live_events)==null?void 0:ie.data_hora_inicio)||le.created_at,createdAt:le.created_at,mpCheckoutUrl:le.mp_checkout_url};s(ne=>[ue,...ne]),L("success"),de.success(`Sacola #${ue.bagNumber.toString().padStart(3,"0")} adicionada`)}catch(oe){console.error("Error fetching bag:",oe),L("error"),de.error("Erro ao buscar sacola")}finally{i(!1)}},y=G=>{s(J=>J.filter(V=>V.id!==G))},b=()=>{s([]),de.success("Lista limpa")},j=async G=>{var V;const J=r.findIndex(W=>W.id===G);if(J!==-1)try{const{data:W,error:ee}=await ce.functions.invoke("get-live-cart-public",{body:{bagId:G}});if(ee||!(W!=null&&W.bag)){de.error("Erro ao atualizar");return}const ie=W.bag,oe={...r[J],status:ie.status,total:ie.total||0,itemsCount:((V=W.items)==null?void 0:V.length)||0,mpCheckoutUrl:ie.mp_checkout_url};s(se=>{const le=[...se];return le[J]=oe,le}),de.success("Status atualizado")}catch{de.error("Erro ao atualizar")}},T=async()=>{for(const G of r)await j(G.id)},O=G=>{navigator.clipboard.writeText(G),de.success("Link copiado!")},R=(G,J)=>{const V=`Ol! Sua sacola #${J.bagNumber.toString().padStart(3,"0")} da live "${J.eventTitle}" est aguardando. Total: ${q(J.total)}`,W=`https://wa.me/55${G.replace(/\D/g,"")}?text=${encodeURIComponent(V)}`;window.open(W,"_blank")},D=()=>{const G=E.filter(W=>W.whatsapp);if(G.length===0){de.error("Nenhuma sacola pendente tem WhatsApp cadastrado");return}let J=0;G.forEach((W,ee)=>{setTimeout(()=>{const ie=`Ol! Sua sacola #${W.bagNumber.toString().padStart(3,"0")} da live "${W.eventTitle}" est aguardando pagamento h ${Z4(W.createdAt)} dias. Total: ${q(W.total)}. Podemos ajudar a finalizar?`,oe=`https://wa.me/55${W.whatsapp.replace(/\D/g,"")}?text=${encodeURIComponent(ie)}`;window.open(oe,"_blank"),J++,J===G.length&&de.success(`${J} conversa(s) aberta(s) no WhatsApp`)},ee*800)});const V=E.length-G.length;V>0&&de.warning(`${V} sacola(s) sem WhatsApp cadastrado`)},L=G=>{const J={success:[523.25,659.25,783.99],warning:[440,440],error:[311.13,233.08]};try{const V=new(window.AudioContext||window.webkitAudioContext);J[G].forEach((ee,ie)=>{const oe=V.createOscillator(),se=V.createGain();oe.connect(se),se.connect(V.destination),oe.frequency.value=ee,oe.type="sine",se.gain.setValueAtTime(.3,V.currentTime),se.gain.exponentialRampToValueAtTime(.01,V.currentTime+.3),oe.start(V.currentTime+ie*.1),oe.stop(V.currentTime+.3+ie*.1)})}catch{}},q=G=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(G),X=G=>{switch(G){case"pago":return"Pago";case"aguardando_pagamento":return"Aguardando Pagamento";case"cancelado":return"Cancelado";case"expirado":return"Expirado";default:return G}},H=G=>{switch(G){case"pago":return n.jsxs(Ae,{className:"bg-green-100 text-green-700 border-green-200 gap-1",children:[n.jsx(pn,{className:"h-3 w-3"}),"Pago"]});case"aguardando_pagamento":return n.jsxs(Ae,{className:"bg-amber-100 text-amber-700 border-amber-200 gap-1",children:[n.jsx(Br,{className:"h-3 w-3"}),"Aguardando"]});case"cancelado":case"expirado":return n.jsxs(Ae,{variant:"destructive",className:"gap-1",children:[n.jsx(an,{className:"h-3 w-3"}),"Cancelado"]});default:return n.jsxs(Ae,{variant:"outline",className:"gap-1",children:[n.jsx(Ut,{className:"h-3 w-3"}),G]})}},M=()=>{if(S.length===0){de.error("Nenhuma sacola para exportar");return}let G="";G+=`Rastreador de Sacolas - Exportado em ${Ht(new Date,"dd/MM/yyyy HH:mm",{locale:gr})}

`,G+=`=== RESUMO ===
`,G+=`Total de Sacolas;${N.total}
`,G+=`Sacolas Pagas;${N.paid}
`,G+=`Sacolas Pendentes;${N.pending}
`,G+=`Sacolas Canceladas;${N.cancelled}
`,G+=`Valor Total;${q(N.totalValue)}
`,G+=`Valor Pago;${q(N.paidValue)}

`,G+=`=== SACOLAS ===
`,G+=`Nmero;Instagram;Status;Live;Data Live;Itens;Valor;WhatsApp;Link Pagamento
`,S.forEach(ee=>{G+=`#${ee.bagNumber.toString().padStart(3,"0")};`,G+=`@${ee.instagram};`,G+=`${X(ee.status)};`,G+=`${ee.eventTitle};`,G+=`${Ht(new Date(ee.eventDate),"dd/MM/yyyy",{locale:gr})};`,G+=`${ee.itemsCount};`,G+=`${q(ee.total)};`,G+=`${ee.whatsapp||"-"};`,G+=`${ee.mpCheckoutUrl||"-"}
`});const J=new Blob(["\uFEFF"+G],{type:"text/csv;charset=utf-8;"}),V=window.URL.createObjectURL(J),W=document.createElement("a");W.href=V,W.download=`rastreador_sacolas_${Ht(new Date,"yyyy-MM-dd_HHmm")}.csv`,W.click(),window.URL.revokeObjectURL(V),de.success("CSV exportado!")},F=async()=>{if(S.length===0){de.error("Nenhuma sacola para exportar");return}const G=new mv.Workbook,J=G.addWorksheet("Resumo");J.columns=[{width:25},{width:20}],[["RASTREADOR DE SACOLAS"],[`Exportado em: ${Ht(new Date,"dd/MM/yyyy HH:mm",{locale:gr})}`],[],["INDICADOR","VALOR"],["Total de Sacolas",N.total],["Sacolas Pagas",N.paid],["Sacolas Pendentes",N.pending],["Sacolas Canceladas",N.cancelled],["Valor Total",N.totalValue],["Valor Pago",N.paidValue]].forEach(se=>J.addRow(se));const V=G.addWorksheet("Sacolas");V.columns=[{width:10},{width:20},{width:20},{width:25},{width:12},{width:8},{width:15},{width:18},{width:50}],V.addRow(["NMERO","INSTAGRAM","STATUS","LIVE","DATA LIVE","ITENS","VALOR","WHATSAPP","LINK PAGAMENTO"]),S.forEach(se=>{V.addRow([`#${se.bagNumber.toString().padStart(3,"0")}`,`@${se.instagram}`,X(se.status),se.eventTitle,Ht(new Date(se.eventDate),"dd/MM/yyyy",{locale:gr}),se.itemsCount,se.total,se.whatsapp||"-",se.mpCheckoutUrl||"-"])});const W=await G.xlsx.writeBuffer(),ee=new Blob([W],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),ie=window.URL.createObjectURL(ee),oe=document.createElement("a");oe.href=ie,oe.download=`rastreador_sacolas_${Ht(new Date,"yyyy-MM-dd_HHmm")}.xlsx`,oe.click(),window.URL.revokeObjectURL(ie),de.success("Excel exportado!")},S=r.filter(G=>{const J=G.instagram.toLowerCase().includes(o.toLowerCase())||G.bagNumber.toString().includes(o)||G.eventTitle.toLowerCase().includes(o.toLowerCase()),V=d==="all"||G.status===d;return J&&V}).sort((G,J)=>G.status==="aguardando_pagamento"&&J.status==="aguardando_pagamento"?new Date(G.createdAt).getTime()-new Date(J.createdAt).getTime():G.status==="aguardando_pagamento"?-1:J.status==="aguardando_pagamento"?1:0),E=r.filter(G=>G.status==="aguardando_pagamento"&&Z4(G.createdAt)>=u),N={total:r.length,paid:r.filter(G=>G.status==="pago").length,pending:r.filter(G=>G.status==="aguardando_pagamento").length,cancelled:r.filter(G=>["cancelado","expirado"].includes(G.status)).length,totalValue:r.reduce((G,J)=>G+J.total,0),paidValue:r.filter(G=>G.status==="pago").reduce((G,J)=>G+J.total,0),oldPending:E.length,oldPendingValue:E.reduce((G,J)=>G+J.total,0)},C=N.total>0?N.paid/N.total*100:0,k=N.totalValue>0?N.paidValue/N.totalValue*100:0,I=r.reduce((G,J)=>{const V=J.eventTitle;return G[V]||(G[V]={eventTitle:J.eventTitle,eventDate:J.eventDate,total:0,paid:0,pending:0,cancelled:0,totalValue:0,paidValue:0}),G[V].total++,G[V].totalValue+=J.total,J.status==="pago"?(G[V].paid++,G[V].paidValue+=J.total):J.status==="aguardando_pagamento"?G[V].pending++:G[V].cancelled++,G},{}),U=Object.values(I).sort((G,J)=>new Date(J.eventDate).getTime()-new Date(G.eventDate).getTime()),[$,Y]=P.useState(!1),[Z,re]=P.useState(!1);return P.useEffect(()=>()=>{g()},[]),n.jsxs("div",{className:"space-y-6",children:[n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-3",children:n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs(Mt,{className:"flex items-center gap-2 text-lg",children:[n.jsx(Ma,{className:"h-5 w-5 text-primary"}),"Scanner de Sacolas"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(dk,{className:"h-4 w-4 text-muted-foreground"}),n.jsxs(Kt,{value:u.toString(),onValueChange:G=>h(parseInt(G,10)),children:[n.jsx(Vt,{className:"w-[130px] h-8 text-xs",children:n.jsx(Xt,{placeholder:"Alerta em..."})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"1",children:"Alerta: 1 dia"}),n.jsx(ze,{value:"2",children:"Alerta: 2 dias"}),n.jsx(ze,{value:"3",children:"Alerta: 3 dias"}),n.jsx(ze,{value:"5",children:"Alerta: 5 dias"}),n.jsx(ze,{value:"7",children:"Alerta: 7 dias"}),n.jsx(ze,{value:"10",children:"Alerta: 10 dias"}),n.jsx(ze,{value:"14",children:"Alerta: 14 dias"})]})]})]})]})}),n.jsx(Be,{children:e?n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{id:m,className:"w-full max-w-sm mx-auto aspect-square rounded-lg overflow-hidden bg-muted"}),n.jsxs(he,{variant:"outline",onClick:g,className:"w-full gap-2",children:[n.jsx(an,{className:"h-4 w-4"}),"Parar Scanner"]})]}):n.jsxs(he,{onClick:p,className:"w-full gap-2",size:"lg",children:[n.jsx(Vx,{className:"h-5 w-5"}),"Iniciar Scanner"]})})]}),N.oldPending>0&&n.jsx(De,{className:"bg-red-50 border-red-300 border-2 animate-fade-in",children:n.jsx(Be,{className:"py-4",children:n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"rounded-full bg-red-100 p-2 shrink-0",children:n.jsx(Mr,{className:"h-5 w-5 text-red-600"})}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("h4",{className:"font-semibold text-red-800",children:[N.oldPending," ",N.oldPending===1?"sacola pendente":"sacolas pendentes"," h mais de ",u," dias"]}),n.jsxs("p",{className:"text-sm text-red-700",children:["Valor total pendente: ",q(N.oldPendingValue),"  Considere entrar em contato para cobrana"]})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-2 justify-end",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>l("aguardando_pagamento"),className:"border-red-300 text-red-700 hover:bg-red-100 gap-1",children:[n.jsx(Ln,{className:"h-3 w-3"}),"Ver todas"]}),n.jsxs(he,{size:"sm",onClick:D,className:"bg-[#25D366] hover:bg-[#1EBE5D] text-white gap-1",children:[n.jsx(nn,{className:"h-4 w-4"}),n.jsx(zu,{className:"h-3 w-3"}),"Cobrar todas (",E.filter(G=>G.whatsapp).length,")"]})]})]})})}),r.length>0&&n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsx(De,{className:"bg-muted/50",children:n.jsxs(Be,{className:"pt-4",children:[n.jsx("div",{className:"text-2xl font-bold",children:N.total}),n.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Sacolas"})]})}),n.jsx(De,{className:"bg-green-50 border-green-200",children:n.jsxs(Be,{className:"pt-4",children:[n.jsx("div",{className:"text-2xl font-bold text-green-700",children:N.paid}),n.jsx("div",{className:"text-sm text-green-600",children:"Pagas"})]})}),n.jsx(De,{className:`${N.oldPending>0?"bg-red-50 border-red-300":"bg-amber-50 border-amber-200"}`,children:n.jsxs(Be,{className:"pt-4",children:[n.jsxs("div",{className:`text-2xl font-bold ${N.oldPending>0?"text-red-700":"text-amber-700"}`,children:[N.pending,N.oldPending>0&&n.jsxs("span",{className:"text-sm font-normal ml-1",children:["(",N.oldPending," antigas)"]})]}),n.jsx("div",{className:`text-sm ${N.oldPending>0?"text-red-600":"text-amber-600"}`,children:"Pendentes"})]})}),n.jsx(De,{className:"bg-primary/5 border-primary/20",children:n.jsxs(Be,{className:"pt-4",children:[n.jsx("div",{className:"text-2xl font-bold text-primary",children:q(N.paidValue)}),n.jsx("div",{className:"text-sm text-muted-foreground",children:"Valor Pago"})]})})]}),r.length>0&&n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs("button",{onClick:()=>Y(!$),className:"flex items-center justify-between w-full text-left",children:[n.jsxs(Mt,{className:"flex items-center gap-2 text-lg",children:[n.jsx(Pl,{className:"h-5 w-5 text-primary"}),"Estatsticas de Converso"]}),$?n.jsx(nf,{className:"h-5 w-5 text-muted-foreground"}):n.jsx(Zi,{className:"h-5 w-5 text-muted-foreground"})]})}),n.jsx(Be,{className:"pb-3",children:n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[n.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1 text-2xl font-bold text-primary",children:[n.jsx(_s,{className:"h-5 w-5"}),C.toFixed(1),"%"]}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Taxa de Converso"}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:["(",N.paid,"/",N.total," sacolas)"]})]}),n.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50",children:[n.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[k.toFixed(1),"%"]}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Converso em Valor"}),n.jsxs("div",{className:"text-xs text-muted-foreground",children:[q(N.paidValue)," de ",q(N.totalValue)]})]}),n.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50",children:[n.jsx("div",{className:"text-2xl font-bold",children:N.total>0?q(N.paidValue/N.paid||0):"R$ 0"}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Ticket Mdio Pago"})]}),n.jsxs("div",{className:"text-center p-3 rounded-lg bg-muted/50",children:[n.jsx("div",{className:"text-2xl font-bold text-amber-600",children:q(N.totalValue-N.paidValue)}),n.jsx("div",{className:"text-xs text-muted-foreground",children:"Valor Pendente"})]})]})}),$&&U.length>0&&n.jsx(Be,{className:"pt-0",children:n.jsxs("div",{className:"border-t pt-4",children:[n.jsx("h4",{className:"font-medium text-sm text-muted-foreground mb-3",children:"Converso por Live"}),n.jsx("div",{className:"space-y-3",children:U.map(G=>{const J=G.total>0?G.paid/G.total*100:0;return G.totalValue>0&&G.paidValue/G.totalValue*100,n.jsxs("div",{className:"p-3 rounded-lg border bg-card",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-2",children:[n.jsxs("div",{children:[n.jsx("span",{className:"font-medium",children:G.eventTitle}),n.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:Ht(new Date(G.eventDate),"dd/MM/yy",{locale:gr})})]}),n.jsx("div",{className:"flex items-center gap-2",children:n.jsxs(Ae,{variant:"outline",className:`${J>=70?"bg-green-100 text-green-700 border-green-300":J>=40?"bg-amber-100 text-amber-700 border-amber-300":"bg-red-100 text-red-700 border-red-300"}`,children:[n.jsx(_s,{className:"h-3 w-3 mr-1"}),J.toFixed(0),"% converso"]})})]}),n.jsx("div",{className:"w-full bg-muted rounded-full h-2 mb-2",children:n.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all",style:{width:`${J}%`}})}),n.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs",children:[n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-semibold",children:G.total}),n.jsx("div",{className:"text-muted-foreground",children:"Total"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-semibold text-green-600",children:G.paid}),n.jsx("div",{className:"text-muted-foreground",children:"Pagas"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-semibold text-amber-600",children:G.pending}),n.jsx("div",{className:"text-muted-foreground",children:"Pendentes"})]}),n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"font-semibold text-primary",children:q(G.paidValue)}),n.jsx("div",{className:"text-muted-foreground",children:"Pago"})]})]})]},G.eventTitle)})})]})})]}),r.length>0&&U.length>=2&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs("button",{onClick:()=>re(!Z),className:"flex items-center gap-2 text-left w-full",children:[n.jsx(ga,{className:"h-5 w-5 text-yellow-500"}),n.jsx("span",{className:"font-semibold",children:"Comparao de Performance"}),n.jsxs(Ae,{variant:"secondary",className:"ml-2",children:[U.length," lives"]}),Z?n.jsx(nf,{className:"h-4 w-4 text-muted-foreground ml-auto"}):n.jsx(Zi,{className:"h-4 w-4 text-muted-foreground ml-auto"})]}),Z&&n.jsx(uJe,{liveStats:U,formatCurrency:q})]}),r.length>0&&n.jsxs(De,{children:[n.jsxs(Ot,{className:"pb-3",children:[n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[n.jsxs(Mt,{className:"text-lg",children:["Sacolas Rastreadas (",r.length,")"]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(L1,{children:[n.jsx(B1,{asChild:!0,children:n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1",children:[n.jsx(Af,{className:"h-4 w-4"}),"Exportar"]})}),n.jsxs(Ig,{align:"end",children:[n.jsxs(po,{onClick:M,className:"gap-2",children:[n.jsx(sf,{className:"h-4 w-4"}),"Exportar CSV"]}),n.jsxs(po,{onClick:F,className:"gap-2",children:[n.jsx(sf,{className:"h-4 w-4"}),"Exportar Excel"]})]})]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:T,className:"gap-1",children:[n.jsx(en,{className:"h-4 w-4"}),"Atualizar"]}),n.jsxs(he,{variant:"ghost",size:"sm",onClick:b,className:"gap-1 text-destructive",children:[n.jsx(mi,{className:"h-4 w-4"}),"Limpar"]})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-3",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar por @instagram, nmero ou live...",value:o,onChange:G=>c(G.target.value),className:"pl-9"})]}),n.jsx(pi,{value:d,onValueChange:l,className:"w-full sm:w-auto",children:n.jsxs(Qa,{className:"grid w-full grid-cols-4",children:[n.jsx(pr,{value:"all",className:"text-xs",children:"Todos"}),n.jsx(pr,{value:"pago",className:"text-xs",children:"Pagos"}),n.jsx(pr,{value:"aguardando_pagamento",className:"text-xs",children:"Pendentes"}),n.jsx(pr,{value:"cancelado",className:"text-xs",children:"Cancelados"})]})})]})]}),n.jsx(Be,{children:n.jsx(bi,{className:"h-[500px] pr-4",children:n.jsxs("div",{className:"space-y-3",children:[S.map(G=>{const J=Z4(G.createdAt),V=hJe(J,u),W=G.status==="aguardando_pagamento"&&J>=u;return n.jsx(De,{className:`border transition-all ${W?"border-red-300 border-2 bg-red-50/50 shadow-sm":""}`,children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3",children:[n.jsxs("div",{className:"flex-1 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsxs("span",{className:"text-xl font-bold",children:["#",G.bagNumber.toString().padStart(3,"0")]}),H(G.status),G.status==="aguardando_pagamento"&&n.jsxs(Ae,{variant:"outline",className:`gap-1 text-xs ${V.color}`,children:[V.urgent&&n.jsx(Br,{className:"h-3 w-3"}),V.label]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 text-sm",children:[n.jsx("div",{className:"flex items-center gap-1 text-muted-foreground",children:n.jsxs("span",{className:"font-medium text-primary",children:["@",G.instagram]})}),n.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[n.jsx(Ut,{className:"h-3 w-3"}),G.itemsCount," itens"]}),n.jsx("div",{className:"text-muted-foreground text-xs",children:G.eventTitle}),n.jsx("div",{className:"text-muted-foreground text-xs",children:Ht(new Date(G.eventDate),"dd/MM/yy",{locale:gr})})]}),n.jsx("div",{className:"text-lg font-semibold text-primary",children:q(G.total)})]}),n.jsxs("div",{className:"flex flex-row sm:flex-col gap-2 justify-end",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>window.open(`/sacola/${G.id}`,"_blank"),className:"gap-1",children:[n.jsx(ma,{className:"h-3 w-3"}),"Detalhes"]}),G.status==="aguardando_pagamento"&&G.mpCheckoutUrl&&n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>O(G.mpCheckoutUrl),className:"gap-1",children:[n.jsx(Ia,{className:"h-3 w-3"}),"Link Pgto"]}),G.whatsapp&&G.status==="aguardando_pagamento"&&n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>R(G.whatsapp,G),className:"gap-1 text-green-600 border-green-200 hover:bg-green-50",children:[n.jsx(el,{className:"h-3 w-3"}),"WhatsApp"]}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>j(G.id),className:"gap-1",children:n.jsx(en,{className:"h-3 w-3"})}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>y(G.id),className:"gap-1 text-destructive hover:text-destructive",children:n.jsx(an,{className:"h-3 w-3"})})]})]})})},G.id)}),S.length===0&&n.jsx("div",{className:"text-center py-8 text-muted-foreground",children:o||d!=="all"?"Nenhuma sacola encontrada com esses filtros":"Escaneie QR codes de sacolas para rastre-las"})]})})})]}),r.length===0&&!e&&n.jsx(De,{className:"border-dashed",children:n.jsxs(Be,{className:"flex flex-col items-center justify-center py-12 text-center",children:[n.jsx(Vx,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),n.jsx("h3",{className:"font-medium text-lg mb-2",children:"Nenhuma sacola rastreada"}),n.jsx("p",{className:"text-muted-foreground text-sm mb-4 max-w-sm",children:"Use o scanner para ler QR codes de sacolas de diversas lives e acompanhar o status de pagamento"}),n.jsxs(he,{onClick:p,className:"gap-2",children:[n.jsx(Ma,{className:"h-4 w-4"}),"Iniciar Scanner"]})]})})]})}function mJe(){const e=fr(),[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await ce.auth.getSession();if(!a){e("/login");return}const{data:i}=await ce.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(c=>["merchant","admin"].includes(c.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:n.jsxs("div",{className:"container flex h-14 items-center gap-4 px-4",children:[n.jsx(he,{variant:"ghost",size:"icon",asChild:!0,children:n.jsx(Gt,{to:"/dashboard",children:n.jsx(vs,{className:"h-5 w-5"})})}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Vx,{className:"h-5 w-5 text-primary"}),n.jsx("h1",{className:"text-lg font-semibold",children:"Rastreador de Sacolas"})]})]})}),n.jsx("main",{className:"container mx-auto px-4 py-6",children:n.jsx(fJe,{})})]})}function pJe(e){const[t,r]=P.useState([]),[s,a]=P.useState([]),[i,o]=P.useState(!0),[c,d]=P.useState(null),l=P.useRef(!0),u=P.useRef(null);P.useEffect(()=>{(async()=>{const{data:{user:U}}=await ce.auth.getUser();U&&d(U.id)})()},[]);const h=P.useCallback(async()=>{if(e){o(!0);try{const{data:I,error:U}=await ce.from("live_carts").select(`
          *,
          live_customer:live_customers(*),
          items:live_cart_items(
            *,
            product:product_catalog(id, name, image_url, color, sku)
          ),
          seller:sellers(id, name)
        `).eq("live_event_id",e).order("created_at",{ascending:!1});if(U)throw U;l.current&&r(I||[]);const{data:$}=await ce.from("sellers").select("id, name").eq("is_active",!0).order("name");l.current&&$&&a($)}catch(I){console.error("Error fetching orders:",I),l.current&&de.error("Erro ao carregar pedidos")}finally{l.current&&o(!1)}}},[e]);P.useEffect(()=>(l.current=!0,h(),()=>{l.current=!1}),[h]),P.useEffect(()=>{if(!e)return;u.current&&ce.removeChannel(u.current);const I=ce.channel(`live_orders_${e}`).on("postgres_changes",{event:"*",schema:"public",table:"live_carts",filter:`live_event_id=eq.${e}`},()=>{l.current&&h()}).on("postgres_changes",{event:"*",schema:"public",table:"live_cart_items"},()=>{l.current&&h()}).subscribe();return u.current=I,()=>{u.current&&ce.removeChannel(u.current)}},[e,h]);const f=P.useCallback(I=>{const U=Date.now(),$=(U-new Date(I.created_at).getTime())/(1e3*60*60),Y=I.paid_at?(U-new Date(I.paid_at).getTime())/(1e3*60*60):0,Z=I.last_charge_at?(U-new Date(I.last_charge_at).getTime())/(1e3*60*60):null,re=I.operational_status||I.status;if(re==="aguardando_pagamento"||re==="aberto"){if(!I.last_charge_at&&$>24)return{isUrgent:!0,reason:"Nunca cobrado +24h",hoursOverdue:$-24};if(Z&&Z>24)return{isUrgent:!0,reason:"Cobrar novamente +24h",hoursOverdue:Z-24}}if(re==="aguardando_retorno"&&Z&&Z>24)return{isUrgent:!0,reason:"Sem retorno +24h",hoursOverdue:Z-24};if(re==="pago"&&Y>12)return{isUrgent:!0,reason:"Pago +12h sem avano",hoursOverdue:Y-12};if(re==="etiqueta_gerada"){const G=I.label_printed_at?(U-new Date(I.label_printed_at).getTime())/36e5:Y;if(G>24)return{isUrgent:!0,reason:"Etiqueta +24h sem postar",hoursOverdue:G-24}}if(re==="em_rota"){const G=Y;if(G>8)return{isUrgent:!0,reason:"Em rota +8h",hoursOverdue:G-8}}return{isUrgent:!1,reason:null,hoursOverdue:0}},[]),m=P.useMemo(()=>{const I=t.filter(le=>le.status!=="cancelado"),$=Date.now()-24*60*60*1e3,Y=le=>{var ue;return(((ue=le.items)==null?void 0:ue.reduce((ne,pe)=>pe.preco_unitario===0?ne:["reservado","confirmado"].includes(pe.status)?ne+pe.preco_unitario*pe.qtd:ne,0))||0)+(le.frete||0)-(le.descontos||0)},Z=I.filter(le=>(le.operational_status||le.status)==="pago"||le.status==="pago"?!1:le.last_charge_at?new Date(le.last_charge_at).getTime()<$:!0).length,re=I.filter(le=>f(le).isUrgent).length,G=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue","retirado"],V=I.filter(le=>le.status==="pago"||G.includes(le.operational_status||"")).reduce((le,ye)=>le+Y(ye),0),W=I.filter(le=>(le.operational_status==="aguardando_pagamento"||le.status==="aguardando_pagamento"||le.status==="aberto")&&le.operational_status!=="aguardando_retorno"),ee=I.filter(le=>le.operational_status==="aguardando_retorno"),ie=I.filter(le=>le.status==="pago"&&!["preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"].includes(le.operational_status||"")),oe=I.filter(le=>le.operational_status==="preparar_envio"),se=I.filter(le=>le.operational_status==="entregue"||le.operational_status==="retirado");return{aguardandoPagamento:W.length,aguardandoRetorno:ee.length,pago:ie.length,prepararEnvio:oe.length,etiquetaGerada:I.filter(le=>le.operational_status==="etiqueta_gerada").length,postado:I.filter(le=>le.operational_status==="postado").length,emRota:I.filter(le=>le.operational_status==="em_rota").length,retirada:I.filter(le=>le.operational_status==="retirada"||le.delivery_method==="retirada"&&le.status==="pago"&&le.operational_status!=="entregue").length,motoboy:I.filter(le=>le.delivery_method==="motoboy"&&le.status==="pago"&&!["entregue"].includes(le.operational_status||"")).length,entregue:se.length,pendencias:I.filter(le=>le.operational_status==="pendencia_dados").length,semResponsavel:I.filter(le=>!le.seller_id&&le.status!=="cancelado").length,needsCharge:Z,urgentCount:re,pendingProof:I.filter(le=>le.payment_review_status==="pending_review").length,totalPago:V,totalPedidos:I.length,valorAguardandoPagamento:W.reduce((le,ye)=>le+Y(ye),0),valorAguardandoRetorno:ee.reduce((le,ye)=>le+Y(ye),0),valorPago:ie.reduce((le,ye)=>le+Y(ye),0),valorPrepararEnvio:oe.reduce((le,ye)=>le+Y(ye),0),valorEntregue:se.reduce((le,ye)=>le+Y(ye),0)}},[t,f]),p=P.useCallback(I=>{const $=Date.now()-24*60*60*1e3;return t.filter(Y=>{var Z,re,G,J,V;if(Y.status==="cancelado")return!1;if(I.search){const W=I.search.toLowerCase();if(!(((Z=Y.live_customer)==null?void 0:Z.instagram_handle.toLowerCase().includes(W))||((G=(re=Y.live_customer)==null?void 0:re.nome)==null?void 0:G.toLowerCase().includes(W))||((J=Y.bag_number)==null?void 0:J.toString().includes(W))||((V=Y.items)==null?void 0:V.some(ie=>{var oe,se,le;return((se=(oe=ie.product)==null?void 0:oe.sku)==null?void 0:se.toLowerCase().includes(W))||((le=ie.product)==null?void 0:le.name.toLowerCase().includes(W))}))))return!1}if(I.status&&I.status!=="all"){if(I.status==="aguardando_pagamento"){if(Y.status!=="aguardando_pagamento"&&Y.status!=="aberto")return!1}else if(I.status==="pago"){if(Y.status!=="pago")return!1}else if(Y.operational_status!==I.status)return!1}if(I.deliveryMethod&&I.deliveryMethod!=="all"&&Y.delivery_method!==I.deliveryMethod||I.sellerId&&(I.sellerId==="none"&&Y.seller_id||I.sellerId!=="none"&&Y.seller_id!==I.sellerId))return!1;if(I.urgentOnly){const W=new Date(Y.created_at);if((Date.now()-W.getTime())/(1e3*60*60)<24||Y.status==="pago")return!1}return!(I.needsCharge&&(Y.status==="pago"||Y.last_charge_at&&new Date(Y.last_charge_at).getTime()>=$)||I.pendingProof&&Y.payment_review_status!=="pending_review")})},[t]),g=P.useCallback(async(I,U)=>{r(Z=>Z.map(re=>re.id===I?{...re,seller_id:U,seller:U?s.find(G=>G.id===U):void 0}:re));const{data:$,error:Y}=await ce.from("live_carts").update({seller_id:U,updated_at:new Date().toISOString()}).eq("id",I).select("*, seller:sellers(id, name)").single();return Y?(de.error("Erro ao atribuir vendedora"),h(),!1):($&&r(Z=>Z.map(re=>re.id===I?{...re,...$}:re)),de.success(U?"Vendedora atribuda":"Vendedora removida"),!0)},[s,h]),v=P.useCallback(async(I,U)=>{const{error:$}=await ce.from("live_carts").update({operational_status:U,updated_at:new Date().toISOString()}).eq("id",I);return $?(de.error("Erro ao atualizar status"),!1):(de.success("Status atualizado"),!0)},[]),x=P.useCallback(async(I,U)=>{const{error:$}=await ce.from("live_carts").update({delivery_method:U,updated_at:new Date().toISOString()}).eq("id",I);return $?(de.error("Erro ao atualizar mtodo de entrega"),!1):(de.success("Mtodo de entrega atualizado"),!0)},[]),y=P.useCallback(async(I,U,$,Y)=>{const Z=t.find(V=>V.id===I);if(!Z)return de.error("Pedido no encontrado"),!1;if(Z.status==="pago")return de.error("No  possvel alterar entrega de pedido j pago"),!1;const re=Z.subtotal-Z.descontos+$,G={delivery_method:U,frete:$,total:re,updated_at:new Date().toISOString()};Y&&(G.shipping_service_name=Y);const{error:J}=await ce.from("live_carts").update(G).eq("id",I);return J?(de.error("Erro ao atualizar entrega"),!1):(r(V=>V.map(W=>W.id===I?{...W,delivery_method:U,frete:$,total:re,shipping_service_name:Y||W.shipping_service_name}:W)),de.success("Entrega configurada!"),!0)},[t]),b=P.useCallback(async(I,U)=>{const{error:$}=await ce.from("customers").update({zip_code:U,updated_at:new Date().toISOString()}).eq("id",I);return $?(console.error("Error updating customer ZIP:",$),!1):(console.log("[useLiveOrders] Customer ZIP updated:",I,U),!0)},[]),j=P.useCallback(async(I,U,$)=>{const{error:Y}=await ce.from("live_carts").update({delivery_period:U,delivery_notes:$,updated_at:new Date().toISOString()}).eq("id",I);return Y?(de.error("Erro ao atualizar detalhes de entrega"),!1):(de.success("Detalhes de entrega atualizados"),!0)},[]),T=P.useCallback(async I=>{try{const{data:U,error:$}=await ce.rpc("apply_live_cart_paid_effects",{p_live_cart_id:I});if($)return console.error("[applyPaidEffects] RPC error:",$),!1;console.log("[applyPaidEffects] Result:",U);const Y=typeof U=="object"?U:null;return Y!=null&&Y.success?(Y.already_processed?console.log("[applyPaidEffects] Stock already decremented (idempotent)"):console.log("[applyPaidEffects] Stock decremented:",Y.items_count,"items"),!0):!1}catch(U){return console.error("[applyPaidEffects] Exception:",U),!1}},[]),O=P.useCallback(async(I,U)=>{if(["rede","pix_itau","pix_rede","link_rede","dinheiro","pix","cartao"].includes(U.toLowerCase()))return de.error("Pagamento manual requer comprovante. Use o boto 'Pago' no card do pedido."),!1;const Y=t.find(J=>J.id===I),{error:Z}=await ce.from("live_cart_items").update({status:"confirmado"}).eq("live_cart_id",I).eq("status","reservado");Z&&console.error("[markAsPaid] Failed to confirm items:",Z);const{error:re}=await ce.from("live_carts").update({status:"pago",operational_status:"pago",paid_method:U,paid_at:new Date().toISOString(),paid_by_user:c,payment_review_status:"approved",updated_at:new Date().toISOString()}).eq("id",I);return re?(de.error("Erro ao marcar como pago"),!1):(await ce.from("live_cart_status_history").insert({live_cart_id:I,old_status:(Y==null?void 0:Y.operational_status)||"aguardando_pagamento",new_status:"pago",payment_method:U,changed_by:c}),await T(I)||console.warn("[markAsPaid] Stock decrement may have failed for:",I),de.success("Pagamento confirmado!"),!0)},[c,t,T]),R=P.useCallback(async(I,U,$,Y)=>{if(!$||$.trim()==="")return de.error("Comprovante obrigatrio para pagamento manual"),!1;if(!["rede","pix_itau","pix_rede","link_rede","dinheiro"].includes(U.toLowerCase()))return de.error("Mtodo de pagamento invlido"),!1;const re=t.find(W=>W.id===I),{error:G}=await ce.from("live_cart_items").update({status:"confirmado"}).eq("live_cart_id",I).eq("status","reservado");if(G)return console.error("[markAsPaidWithProof] Failed to confirm items:",G),de.error("Erro ao confirmar itens do carrinho"),!1;const{error:J}=await ce.from("live_carts").update({status:"pago",operational_status:"pago",paid_method:U,paid_at:new Date().toISOString(),paid_by_user:c,payment_proof_url:$,payment_review_status:"pending_review",updated_at:new Date().toISOString()}).eq("id",I);return J?(de.error("Erro ao marcar como pago"),!1):(await ce.from("live_cart_status_history").insert({live_cart_id:I,old_status:(re==null?void 0:re.operational_status)||"aguardando_pagamento",new_status:"pago",payment_method:U,changed_by:c,notes:Y||`Pagamento manual (${U}) com comprovante`}),await T(I)||console.warn("[markAsPaidWithProof] Stock decrement may have failed for:",I),de.success("Pagamento registrado (pendente validao)"),!0)},[c,t,T]),D=P.useCallback(async I=>{const U=new Date().toISOString(),{error:$}=await ce.from("live_carts").update({payment_review_status:"approved",validated_at:U,validated_by_user_id:c,updated_at:U}).eq("id",I);return $?(de.error("Erro ao aprovar pagamento"),!1):(await ce.from("live_cart_status_history").insert({live_cart_id:I,old_status:"pago",new_status:"pago",notes:"Pagamento manual validado pelo admin",changed_by:c}),await T(I)||console.warn("[approveManualPayment] Stock decrement may have failed for:",I),de.success("Pagamento validado!"),!0)},[c,T]),L=P.useCallback(async(I,U)=>{if(!U.trim())return de.error("Motivo da rejeio  obrigatrio"),!1;const $=new Date().toISOString(),{error:Y}=await ce.from("live_carts").update({status:"aguardando_pagamento",operational_status:"aguardando_retorno",payment_review_status:"rejected",rejection_reason:U,validated_at:$,validated_by_user_id:c,updated_at:$}).eq("id",I);return Y?(de.error("Erro ao rejeitar pagamento"),!1):(await ce.from("live_cart_status_history").insert({live_cart_id:I,old_status:"pago",new_status:"aguardando_retorno",notes:`Pagamento rejeitado: ${U}`,changed_by:c}),await ce.from("live_cart_items").update({status:"reservado"}).eq("live_cart_id",I).eq("status","confirmado"),de.success("Pagamento rejeitado. Vendedora pode cobrar novamente."),!0)},[c]),q=P.useCallback(async(I,U)=>{const $=new Date().toISOString(),Y=t.find(J=>J.id===I),Z=((Y==null?void 0:Y.charge_attempts)||0)+1,re={last_charge_at:$,charge_attempts:Z,charge_channel:U,charge_by_user:c,operational_status:"aguardando_retorno",updated_at:$},{error:G}=await ce.from("live_carts").update(re).eq("id",I);return G?(console.error("Error recording charge:",G),de.error("Erro ao registrar cobrana"),!1):(await ce.from("live_charge_logs").insert({live_cart_id:I,charged_by:c,channel:U}),await ce.from("live_cart_status_history").insert({live_cart_id:I,old_status:(Y==null?void 0:Y.operational_status)||"aguardando_pagamento",new_status:"aguardando_retorno",notes:`Cobrana registrada via ${U}`,changed_by:c}),r(J=>J.map(V=>V.id===I?{...V,last_charge_at:$,charge_attempts:Z,charge_channel:U,operational_status:"aguardando_retorno"}:V)),de.success("Cobrana registrada! Status: Aguardando retorno"),!0)},[t,c]),X=P.useCallback(async I=>{const U=t.find(re=>re.id===I);if(!U)return!1;if(U.payment_review_status==="pending_review")return de.error("Pagamento aguardando validao do admin. No  possvel avanar."),!1;const $=U.operational_status||"aguardando_pagamento";let Y=null;if(U.delivery_method==="correios"&&$==="postado"){if(!U.shipping_tracking_code)return de.error("Correios: necessrio cdigo de rastreio para marcar entregue"),!1;Y="entregue"}else if(U.delivery_method==="correios"&&$==="etiqueta_gerada"){if(!U.me_label_url&&!U.shipping_tracking_code)return de.error("Correios: necessrio gerar etiqueta primeiro"),!1;Y="postado"}else if(U.delivery_method==="motoboy"&&$!=="em_rota"&&$==="pago")Y="em_rota";else if(U.delivery_method==="motoboy"&&$==="em_rota")Y="entregue";else if(U.delivery_method==="retirada"&&$!=="retirada"&&$==="pago")Y="retirada";else if(U.delivery_method==="retirada"&&$==="retirada")Y="entregue";else switch($){case"pago":U.delivery_method==="correios"?Y="preparar_envio":U.delivery_method==="motoboy"?Y="em_rota":Y="retirada";break;case"preparar_envio":return de.info("Gere a etiqueta Melhor Envio primeiro"),!1;case"postado":Y="entregue";break;default:return de.error("No  possvel avanar deste status"),!1}if(!Y)return!1;const{error:Z}=await ce.from("live_carts").update({operational_status:Y,updated_at:new Date().toISOString()}).eq("id",I);return Z?(de.error("Erro ao avanar status"),!1):(await ce.from("live_cart_status_history").insert({live_cart_id:I,old_status:$,new_status:Y,changed_by:c}),r(re=>re.map(G=>G.id===I?{...G,operational_status:Y}:G)),de.success(`Status atualizado para ${Y.replace(/_/g," ")}`),!0)},[t,c]),H=P.useCallback(async(I,U,$,Y)=>{const Z=t.find(V=>V.id===I);if(!Z)return!1;if(!Y){if(Z.payment_review_status==="approved"&&["pago","preparar_envio","etiqueta_gerada"].includes(U))return de.error("Apenas admin pode reverter pagamentos validados"),!1;const V=["aguardando_pagamento","aguardando_retorno","pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"],W=V.indexOf(Z.operational_status),ee=V.indexOf(U);if(W-ee>1)return de.error("Vendedora pode voltar apenas 1 etapa"),!1}if(Y&&!$.trim())return de.error("Admin deve informar motivo para reverso"),!1;const re=new Date().toISOString(),G={operational_status:U,updated_at:re};["aguardando_pagamento","aguardando_retorno"].includes(U)&&(G.status="aguardando_pagamento");const{error:J}=await ce.from("live_carts").update(G).eq("id",I);return J?(de.error("Erro ao reverter status"),!1):(await ce.from("live_cart_status_history").insert({live_cart_id:I,old_status:Z.operational_status,new_status:U,notes:`REVERSO: ${$||"Sem motivo informado"}`,changed_by:c}),r(V=>V.map(W=>W.id===I?{...W,operational_status:U,...G}:W)),de.success(`Status revertido para ${U.replace(/_/g," ")}`),!0)},[t,c]),M=P.useCallback(async I=>{const U=t.find($=>$.id===I);if(!U)return{success:!1,error:"Pedido no encontrado"};if(!U.shipping_address_snapshot)return await ce.from("live_carts").update({operational_status:"pendencia_dados"}).eq("id",I),{success:!1,error:"Dados de envio pendentes"};try{const{data:$,error:Y}=await ce.functions.invoke("generate-shipping-label",{body:{cartId:I}});if(Y)throw Y;return{success:!0,labelUrl:$.label_url,trackingCode:$.tracking_code}}catch($){return de.error("Erro ao gerar etiqueta"),{success:!1,error:$.message}}},[t]),F=P.useCallback(async I=>{const U=t.find(Y=>Y.id===I);if((U==null?void 0:U.separation_status)!=="separado")return de.error("Pedido precisa ser separado antes de postar"),!1;const{error:$}=await ce.from("live_carts").update({operational_status:"postado",updated_at:new Date().toISOString()}).eq("id",I);return $?(de.error("Erro ao marcar como postado"),!1):(de.success("Pedido marcado como postado"),!0)},[t]),S=P.useCallback(async I=>{const U=t.find(G=>G.id===I);if(!U)return de.error("Pedido no encontrado"),!1;const $=U.operational_status;let Y,Z;if(U.delivery_method==="motoboy")if($==="pago")Y="em_rota",Z="Pedido em rota de entrega";else if($==="em_rota")Y="entregue",Z="Pedido entregue!";else return de.error("Status atual no permite esta ao"),!1;else if(U.delivery_method==="correios"){if($!=="postado")return de.error("Correios: pedido precisa estar postado para marcar entregue"),!1;Y="entregue",Z="Pedido entregue!"}else return de.error("Use 'Marcar como Retirado' para pedidos de retirada"),!1;const{error:re}=await ce.from("live_carts").update({operational_status:Y,updated_at:new Date().toISOString()}).eq("id",I);return re?(de.error("Erro ao atualizar status"),!1):(await ce.from("live_cart_status_history").insert({live_cart_id:I,old_status:$,new_status:Y,changed_by:c}),r(G=>G.map(J=>J.id===I?{...J,operational_status:Y}:J)),de.success(Z),!0)},[t,c]),E=P.useCallback(async I=>{const U=t.find(G=>G.id===I);if(!U)return de.error("Pedido no encontrado"),!1;if(U.delivery_method!=="retirada")return de.error("Ao s disponvel para pedidos de retirada na loja"),!1;const $=U.operational_status;let Y,Z;if($==="pago")Y="retirada",Z="Pedido aguardando retirada";else if($==="retirada")Y="entregue",Z="Pedido retirado pelo cliente!";else return de.error("Status atual no permite esta ao"),!1;const{error:re}=await ce.from("live_carts").update({operational_status:Y,updated_at:new Date().toISOString()}).eq("id",I);return re?(de.error("Erro ao atualizar status"),!1):(await ce.from("live_cart_status_history").insert({live_cart_id:I,old_status:$,new_status:Y,changed_by:c}),r(G=>G.map(J=>J.id===I?{...J,operational_status:Y}:J)),de.success(Z),!0)},[t,c]),N=P.useMemo(()=>{const U=Date.now()-24*60*60*1e3;return t.filter($=>$.status==="pago"||$.status==="cancelado"?!1:$.last_charge_at?new Date($.last_charge_at).getTime()<U:!0)},[t]),C=P.useCallback(async I=>{const{data:U,error:$}=await ce.from("live_charge_logs").select("channel, created_at, charged_by").eq("live_cart_id",I).order("created_at",{ascending:!1}).limit(20);return $?(console.error("Error fetching charge history:",$),[]):U||[]},[]),k=P.useCallback((I,U)=>{r($=>$.map(Y=>Y.id===I?{...Y,shipping_tracking_code:U}:Y))},[]);return{orders:t,sellers:s,kpis:m,isLoading:i,currentUserId:c,filterOrders:p,ordersNeedingCharge:N,getOrderUrgency:f,assignSeller:g,updateOperationalStatus:v,updateDeliveryMethod:x,updateDeliveryWithShipping:y,updateCustomerZipCode:b,updateDeliveryDetails:j,markAsPaid:O,markAsPaidWithProof:R,approveManualPayment:D,rejectManualPayment:L,applyPaidEffects:T,recordCharge:q,advanceStatus:X,revertStatus:H,generateShippingLabel:M,markAsPosted:F,markAsDelivered:S,markAsPickedUp:E,fetchChargeHistory:C,updateTrackingCode:k,refetch:h}}function gJe({kpis:e,activeFilter:t,onFilterClick:r}){const s=o=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(o),a=[{label:"Aguardando Pgto",value:e.aguardandoPagamento,valorTotal:e.valorAguardandoPagamento||0,icon:Br,color:"text-amber-600",bg:"bg-amber-50",border:"border-amber-200",activeBg:"bg-amber-100",filter:"aguardando_pagamento"},{label:"Aguardando Retorno",value:e.aguardandoRetorno,valorTotal:e.valorAguardandoRetorno||0,icon:f1,color:"text-orange-600",bg:"bg-orange-50",border:"border-orange-200",activeBg:"bg-orange-100",filter:"aguardando_retorno"},{label:"Pago",value:e.pago,valorTotal:e.valorPago||0,icon:Er,color:"text-green-600",bg:"bg-green-50",border:"border-green-200",activeBg:"bg-green-100",filter:"pago"},{label:"Preparar Envio",value:e.prepararEnvio,valorTotal:e.valorPrepararEnvio||0,icon:Ut,color:"text-blue-600",bg:"bg-blue-50",border:"border-blue-200",activeBg:"bg-blue-100",filter:"preparar_envio"},{label:"Etiqueta Gerada",value:e.etiquetaGerada,icon:Hh,color:"text-indigo-600",bg:"bg-indigo-50",border:"border-indigo-200",activeBg:"bg-indigo-100",filter:"etiqueta_gerada"},{label:"Postado",value:e.postado,icon:gn,color:"text-purple-600",bg:"bg-purple-50",border:"border-purple-200",activeBg:"bg-purple-100",filter:"postado"},{label:"Em Rota",value:e.emRota,icon:rc,color:"text-cyan-600",bg:"bg-cyan-50",border:"border-cyan-200",activeBg:"bg-cyan-100",filter:"em_rota"},{label:"Entregue ",value:e.entregue,valorTotal:e.valorEntregue||0,icon:oae,color:"text-emerald-600",bg:"bg-emerald-50",border:"border-emerald-200",activeBg:"bg-emerald-100",filter:"entregue"}],i=[{label:"Retirada",value:e.retirada,icon:pa,color:"text-teal-600",bg:"bg-teal-50",border:"border-teal-200",filter:"retirada"},{label:"Validar Pgto",value:e.pendingProof,icon:ws,color:"text-violet-600",bg:"bg-violet-50",border:"border-violet-200",filter:"pending_proof",highlight:e.pendingProof>0},{label:"Urgentes",value:e.urgentCount,icon:Cn,color:"text-rose-600",bg:"bg-rose-50",border:"border-rose-200",filter:"urgent",highlight:e.urgentCount>0},{label:"Cobrar",value:e.needsCharge,icon:nn,color:"text-red-600",bg:"bg-red-50",border:"border-red-200",filter:"needs_charge",highlight:e.needsCharge>0}];return n.jsxs("div",{className:"space-y-3 w-full max-w-full overflow-x-hidden",children:[n.jsx("div",{className:"scroll-container-x",children:n.jsx("div",{className:"flex sm:grid sm:grid-cols-4 md:grid-cols-8 gap-2 w-max sm:w-full",children:a.map(o=>{const c=t===o.filter;return n.jsx(De,{className:We("p-2 sm:p-3 cursor-pointer transition-all hover:shadow-md border shrink-0 w-[80px] sm:w-auto",c?o.activeBg:o.bg,o.border,c&&"ring-2 ring-offset-1 ring-primary/50"),onClick:()=>r(o.filter),children:n.jsxs("div",{className:"flex flex-col items-center text-center",children:[n.jsx(o.icon,{className:We("h-4 w-4 sm:h-5 sm:w-5 mb-1",o.color)}),n.jsx("span",{className:We("text-lg sm:text-2xl font-bold",o.color),children:o.value}),n.jsx("span",{className:"text-[9px] sm:text-xs text-muted-foreground leading-tight line-clamp-2",children:o.label}),o.valorTotal!==void 0&&o.valorTotal>0&&n.jsx("span",{className:"text-[9px] sm:text-xs font-medium text-muted-foreground mt-0.5 hidden sm:block",children:s(o.valorTotal)})]})},o.label)})})}),n.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:i.map(o=>{const c=t===o.filter;return n.jsxs(De,{className:We("p-2 cursor-pointer transition-all hover:shadow-md border flex items-center gap-2",c?"bg-primary/10":o.bg,o.border,o.highlight&&!c&&"ring-2 ring-offset-1 ring-red-300",c&&"ring-2 ring-offset-1 ring-primary/50"),onClick:()=>r(o.filter),children:[n.jsx(o.icon,{className:We("h-4 w-4 shrink-0",o.color)}),n.jsx("span",{className:We("font-bold text-lg",o.color),children:o.value}),n.jsx("span",{className:"text-xs text-muted-foreground truncate",children:o.label})]},o.label)})}),n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 bg-gradient-to-r from-primary/5 via-transparent to-transparent rounded-lg px-3 sm:px-4 py-2 border border-border/40",children:[n.jsxs("div",{className:"flex items-center gap-4 sm:gap-6 flex-wrap",children:[n.jsxs("button",{onClick:()=>r("none"),className:We("flex items-center gap-2 hover:underline transition-colors text-sm",t==="none"&&"font-medium text-primary"),children:[n.jsx(wa,{className:"h-4 w-4 text-muted-foreground"}),n.jsxs("span",{children:[n.jsx("span",{className:"font-medium",children:e.semResponsavel})," ",n.jsx("span",{className:"text-muted-foreground",children:"sem resp."})]})]}),n.jsxs("button",{onClick:()=>r("all"),className:We("text-sm text-muted-foreground hover:text-foreground hover:underline transition-colors",t==="all"&&"font-medium text-primary"),children:["Todos (",e.totalPedidos,")"]})]}),n.jsxs("div",{className:"text-left sm:text-right",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Total Pago: "}),n.jsx("span",{className:"text-base sm:text-lg font-bold text-green-600",children:s(e.totalPago)})]})]})]})}function LB({order:e,sellers:t,urgency:r,compact:s=!1,onSelect:a,onAssignSeller:i,onMarkAsPaid:o,onMarkAsPosted:c,onMarkAsDelivered:d,onMarkAsPickedUp:l,onAdvanceStatus:u,onRecordCharge:h,onOpenManualPayment:f}){var I,U,$;const[m,p]=P.useState(e.seller_id);P.useEffect(()=>{p(e.seller_id)},[e.seller_id]);const g=Y=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Y),v=e.status==="pago",x=e.status==="aguardando_pagamento"||e.status==="aberto"||e.operational_status==="aguardando_pagamento",y=e.operational_status==="aguardando_retorno",b=e.status==="cancelado",j=e.operational_status==="entregue"||e.operational_status==="retirado",T=e.payment_review_status==="pending_review",O=r.isUrgent,R=()=>{const Y=`${window.location.origin}/live-checkout/${e.id}`;return e.public_token?`${Y}?token=${e.public_token}`:Y},D=()=>{if(v)return null;if(!e.last_charge_at){const Z=(Date.now()-new Date(e.created_at).getTime())/36e5;return Z>24?{text:`Nunca cobrada (+${Math.floor(Z)}h)`,needsCharge:!0}:{text:"Nunca cobrada",needsCharge:!0}}const Y=(Date.now()-new Date(e.last_charge_at).getTime())/(1e3*60*60);return Y>24?{text:`Cobrar novamente (+${Math.floor(Y)}h)`,needsCharge:!0}:{text:`Cobrada ${y8(new Date(e.last_charge_at),{locale:gr,addSuffix:!0})}`,needsCharge:!1}},L=e.delivery_method==="correios"?gn:e.delivery_method==="motoboy"?rc:pa,q=()=>b?{label:"Cancelado",color:"text-muted-foreground bg-muted border-muted"}:j?{label:"Entregue ",color:"text-emerald-700 bg-emerald-50 border-emerald-200"}:T?{label:"Validar Pagamento",color:"text-violet-700 bg-violet-50 border-violet-200"}:v?e.operational_status==="preparar_envio"?{label:"Preparar Envio",color:"text-blue-700 bg-blue-50 border-blue-200"}:e.operational_status==="etiqueta_gerada"?{label:"Etiqueta Gerada",color:"text-indigo-700 bg-indigo-50 border-indigo-200"}:e.operational_status==="postado"?{label:"Postado",color:"text-purple-700 bg-purple-50 border-purple-200"}:e.operational_status==="em_rota"?{label:"Em Rota",color:"text-cyan-700 bg-cyan-50 border-cyan-200"}:e.operational_status==="retirada"?{label:"Aguardando Retirada",color:"text-teal-700 bg-teal-50 border-teal-200"}:{label:"Pago",color:"text-green-700 bg-green-50 border-green-200"}:y?{label:"Aguardando Retorno",color:"text-orange-700 bg-orange-50 border-orange-200"}:x&&!v?{label:"Aguardando Pagamento",color:"text-amber-700 bg-amber-50 border-amber-200"}:null,X=async()=>{const Y=R(),Z=av(Y,e.bag_number||void 0);await gf(Z)?de.success("Mensagem copiada com link!"):de.error("Erro ao copiar.")},H=()=>{const Y=e.live_customer;if(!(Y!=null&&Y.whatsapp)){de.error("Cliente sem WhatsApp cadastrado");return}const Z=R(),re=av(Z,e.bag_number||void 0),G=No(Y.whatsapp,re);window.open(G,"_blank")},M=async()=>{var re;const Y=(re=e.live_customer)!=null&&re.whatsapp?"whatsapp":"direct";await h(e.id,Y,!0)&&de.success("Cobrana registrada  Aguardando retorno")},F=async Y=>{const Z=Y==="unassigned"?null:Y;p(Z),await i(e.id,Z)},S=D(),E=q(),N=kw(((I=e.live_customer)==null?void 0:I.instagram_handle)||""),C=JV(((U=e.live_customer)==null?void 0:U.instagram_handle)||""),k=()=>{const Y=(Date.now()-new Date(e.updated_at).getTime())/36e5;return Y<1?`${Math.floor(Y*60)}min`:Y<24?`${Math.floor(Y)}h`:`${Math.floor(Y/24)}d`};return s?n.jsxs(De,{className:We("p-3 cursor-pointer hover:shadow-sm transition-all border-border/60",O&&"border-l-2 border-l-amber-500",b&&"opacity-50"),onClick:a,children:[n.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[n.jsxs("span",{className:"text-xs font-mono text-muted-foreground",children:["#",e.bag_number]}),n.jsx("span",{className:"font-medium text-sm truncate",children:N})]}),n.jsx(L,{className:"h-4 w-4 text-muted-foreground shrink-0"})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"font-semibold",children:g(e.total)}),E&&n.jsx(Ae,{variant:"outline",className:We("text-xs",E.color),children:E.label})]})]}):n.jsxs(De,{className:We("p-3 sm:p-4 transition-all border-border/60",O&&"border-l-4 border-l-amber-500 bg-amber-50/20",(S==null?void 0:S.needsCharge)&&!v&&!y&&"border-l-4 border-l-rose-400",b&&"opacity-50 bg-muted/30"),children:[n.jsxs("div",{className:"flex items-start justify-between gap-2 sm:gap-4 mb-2 sm:mb-3",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[n.jsxs("span",{className:"text-xs sm:text-sm font-mono text-muted-foreground shrink-0",children:["#",e.bag_number]}),n.jsxs("div",{className:"flex items-center gap-1 min-w-0",children:[n.jsx("span",{className:"font-semibold text-sm sm:text-base truncate",children:N}),C&&n.jsx("a",{href:C,target:"_blank",rel:"noopener noreferrer",onClick:Y=>Y.stopPropagation(),className:"text-muted-foreground hover:text-blue-600 shrink-0",children:n.jsx(ma,{className:"h-3 w-3"})})]})]}),n.jsx("div",{className:"shrink-0",children:E&&n.jsx(Ae,{variant:"outline",className:We("text-[10px] sm:text-xs font-medium",E.color),children:E.label})})]}),n.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 sm:gap-2 mb-2 sm:mb-3 text-xs sm:text-sm",children:[n.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[n.jsx(L,{className:"h-3.5 w-3.5"}),n.jsx("span",{className:"text-[10px] sm:text-xs",children:e.delivery_method==="correios"?"Correios":e.delivery_method==="motoboy"?"Motoboy":"Retirada"})]}),n.jsx("div",{className:"flex items-center",onClick:Y=>Y.stopPropagation(),children:n.jsxs(Kt,{value:m||"unassigned",onValueChange:F,children:[n.jsxs(Vt,{className:"h-6 sm:h-7 w-auto min-w-[70px] sm:min-w-[90px] text-[10px] sm:text-xs border-dashed bg-transparent px-1.5",children:[n.jsx(Wn,{className:"h-3 w-3 mr-0.5 text-muted-foreground"}),n.jsx(Xt,{placeholder:"Resp."})]}),n.jsxs(qt,{children:[n.jsx(ze,{value:"unassigned",children:"Sem responsvel"}),t.map(Y=>n.jsx(ze,{value:Y.id,children:Y.name},Y.id))]})]})}),n.jsx("span",{className:"text-[10px] sm:text-xs text-muted-foreground",children:k()}),O&&r.reason&&n.jsxs(Ae,{variant:"destructive",className:"text-[10px] sm:text-xs h-5",children:[n.jsx(Mr,{className:"h-3 w-3 mr-0.5"}),n.jsx("span",{className:"hidden sm:inline",children:r.reason})]}),S&&!v&&n.jsx("span",{className:We("text-[10px] sm:text-xs",S.needsCharge?"text-rose-600 font-medium":"text-muted-foreground"),children:S.text}),e.is_raffle_winner&&n.jsx(Ae,{className:"text-[10px] bg-amber-100 text-amber-800 border-amber-300 h-5",children:n.jsx(ga,{className:"h-3 w-3"})})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 pt-2 sm:pt-3 border-t border-border/40",children:[n.jsx("span",{className:"text-lg sm:text-xl font-bold tracking-tight",children:g(e.total)}),n.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 flex-wrap",onClick:Y=>Y.stopPropagation(),children:[(x||y)&&!v&&!b&&n.jsxs(n.Fragment,{children:[(($=e.live_customer)==null?void 0:$.whatsapp)&&n.jsxs(he,{variant:"outline",size:"sm",className:"h-9 sm:h-8 text-xs flex-1 sm:flex-none min-w-0",onClick:H,title:"Abrir WhatsApp com mensagem",children:[n.jsx(nn,{className:"h-3.5 w-3.5 sm:mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:y?"Reenviar":"Cobrar"})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"h-9 sm:h-8 text-xs",onClick:X,title:"Copiar mensagem com link",children:[n.jsx(Ia,{className:"h-3.5 w-3.5 sm:mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:"Copiar"})]}),n.jsxs(he,{variant:"outline",size:"sm",className:"h-9 sm:h-8 text-xs border-amber-300 text-amber-700 hover:bg-amber-50",onClick:M,title:"Registrar cobrana",children:[n.jsx(xn,{className:"h-3.5 w-3.5 sm:mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:"Registrar"})]}),n.jsxs(he,{variant:"default",size:"sm",className:"h-9 sm:h-8 text-xs bg-emerald-600 hover:bg-emerald-700",onClick:()=>f(e.id),title:"Marcar como pago",children:[n.jsx(ws,{className:"h-3.5 w-3.5 sm:mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:"Pago"})]})]}),v&&!j&&!b&&!T&&n.jsxs(he,{variant:"default",size:"sm",className:"h-9 sm:h-8 text-xs",onClick:()=>u(e.id),title:"Avanar para prximo status",children:[n.jsx(Dn,{className:"h-3.5 w-3.5 sm:mr-1"}),n.jsx("span",{className:"hidden sm:inline",children:"Avanar"})]}),n.jsxs(he,{variant:"ghost",size:"sm",className:"h-9 sm:h-8 text-xs text-muted-foreground hover:text-foreground",onClick:a,children:["Detalhes",n.jsx(Dn,{className:"h-3.5 w-3.5 ml-0.5"})]})]})]})]})}const xJe={rede:"Maquininha REDE",pix_itau:"PIX Ita",pix_rede:"PIX REDE",link_rede:"Link Externo REDE",dinheiro:"Dinheiro",pix:"PIX",cartao:"Carto"};function vJe({order:e,isAdmin:t,onApprove:r,onReject:s}){const[a,i]=P.useState(!1),[o,c]=P.useState(""),[d,l]=P.useState(!1),[u,h]=P.useState(!1),[f,m]=P.useState(!1),p=e.payment_review_status==="pending_review",g=e.payment_review_status==="approved",v=e.payment_review_status==="rejected",x=!!e.payment_proof_url;if(!x&&!p&&!g&&!v)return null;const y=async()=>{l(!0);const j=await r(e.id);return l(!1),j},b=async()=>{if(!o.trim())return;h(!0);const j=await s(e.id,o);h(!1),j&&(c(""),m(!1))};return n.jsxs("div",{className:"space-y-3",children:[n.jsx(Ta,{}),n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[n.jsx(Nae,{className:"h-4 w-4"}),"Pagamento Manual"]}),p&&n.jsxs(Ae,{className:"bg-violet-100 text-violet-700 border-violet-300",children:[n.jsx(Br,{className:"h-3 w-3 mr-1"}),"Aguardando Validao"]}),g&&n.jsxs(Ae,{className:"bg-green-100 text-green-700 border-green-300",children:[n.jsx(Er,{className:"h-3 w-3 mr-1"}),"Validado"]}),v&&n.jsxs(Ae,{className:"bg-red-100 text-red-700 border-red-300",children:[n.jsx(qn,{className:"h-3 w-3 mr-1"}),"Rejeitado"]})]}),n.jsxs("div",{className:"bg-muted/50 rounded-lg p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Mtodo"}),n.jsx("span",{className:"font-medium",children:xJe[e.paid_method||""]||e.paid_method})]}),e.paid_at&&n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Data/hora"}),n.jsx("span",{children:Ht(new Date(e.paid_at),"dd/MM/yyyy 's' HH:mm",{locale:gr})})]}),e.validated_at&&n.jsxs("div",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:v?"Rejeitado em":"Validado em"}),n.jsx("span",{children:Ht(new Date(e.validated_at),"dd/MM/yyyy 's' HH:mm",{locale:gr})})]})]}),x&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{className:"text-sm font-medium",children:"Comprovante"}),n.jsxs("div",{className:"relative cursor-pointer group",onClick:()=>i(!0),children:[n.jsx("img",{src:e.payment_proof_url,alt:"Comprovante de pagamento",className:"w-full max-h-48 object-contain rounded-lg border bg-muted"}),n.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors rounded-lg flex items-center justify-center",children:n.jsx(gae,{className:"h-6 w-6 text-white opacity-0 group-hover:opacity-100 transition-opacity drop-shadow-lg"})})]})]}),v&&e.rejection_reason&&n.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:n.jsxs("p",{className:"text-sm text-red-800",children:[n.jsx("strong",{children:"Motivo:"})," ",e.rejection_reason]})}),t&&p&&n.jsx("div",{className:"space-y-3 pt-2",children:f?n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Motivo da rejeio *"}),n.jsx(Yn,{value:o,onChange:j=>c(j.target.value),placeholder:"Ex: Valor divergente, comprovante invlido...",rows:2}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{variant:"outline",onClick:()=>{m(!1),c("")},disabled:u,children:"Cancelar"}),n.jsxs(he,{variant:"destructive",className:"flex-1",onClick:b,disabled:u||!o.trim(),children:[u?n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}):n.jsx(qn,{className:"h-4 w-4 mr-2"}),"Confirmar Rejeio"]})]})]}):n.jsxs("div",{className:"flex gap-2",children:[n.jsxs(he,{className:"flex-1 bg-green-600 hover:bg-green-700",onClick:y,disabled:d,children:[d?n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}):n.jsx(Er,{className:"h-4 w-4 mr-2"}),"Validar Pagamento"]}),n.jsxs(he,{variant:"outline",className:"border-red-300 text-red-600 hover:bg-red-50",onClick:()=>m(!0),children:[n.jsx(qn,{className:"h-4 w-4 mr-2"}),"Rejeitar"]})]})}),!t&&p&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-start gap-2",children:[n.jsx(Mr,{className:"h-5 w-5 text-amber-500 shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-amber-800",children:[n.jsx("p",{className:"font-medium",children:"Aguardando validao do admin"}),n.jsx("p",{className:"text-amber-700",children:"O pagamento foi registrado e est sendo revisado. Voc ser notificada quando for aprovado."})]})]})]}),n.jsx(cn,{open:a,onOpenChange:i,children:n.jsxs(sn,{className:"max-w-4xl max-h-[90vh] overflow-auto",children:[n.jsx(fn,{children:n.jsx(dn,{children:"Comprovante de Pagamento"})}),x&&n.jsx("img",{src:e.payment_proof_url,alt:"Comprovante de pagamento",className:"w-full object-contain"})]})})]})}const yJe=[{value:"rede",label:"Maquininha REDE"},{value:"pix_itau",label:"PIX Ita"},{value:"pix_rede",label:"PIX REDE"},{value:"link_rede",label:"Link Externo REDE"},{value:"dinheiro",label:"Dinheiro"}];function dte({open:e,onClose:t,orderId:r,orderTotal:s,onConfirm:a}){const[i,o]=P.useState(""),[c,d]=P.useState(""),[l,u]=P.useState(null),[h,f]=P.useState(""),[m,p]=P.useState(!1),[g,v]=P.useState(!1),x=P.useRef(null),y=R=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(R),b=R=>{var L;const D=(L=R.target.files)==null?void 0:L[0];if(D){if(D.size>5*1024*1024){de.error("Arquivo muito grande. Mximo 5MB.");return}u(D);const q=new FileReader;q.onload=X=>{var H;f((H=X.target)==null?void 0:H.result)},q.readAsDataURL(D)}},j=async()=>{if(!l)return null;p(!0);try{const R=l.name.split(".").pop(),L=`payment-proofs/${`payment-proof-${r}-${Date.now()}.${R}`}`,{error:q}=await ce.storage.from("products").upload(L,l);if(q)return console.error("Upload error:",q),de.error("Erro ao fazer upload do comprovante"),null;const{data:{publicUrl:X}}=ce.storage.from("products").getPublicUrl(L);return X}catch(R){return console.error("Upload error:",R),de.error("Erro ao fazer upload"),null}finally{p(!1)}},T=async()=>{if(!i){de.error("Selecione o mtodo de pagamento");return}if(!l){de.error("Comprovante obrigatrio para pagamento manual");return}v(!0);const R=await j();if(!R){v(!1);return}const D=await a(i,R,c);v(!1),D&&(o(""),d(""),u(null),f(""),t())},O=()=>{o(""),d(""),u(null),f(""),t()};return n.jsx(cn,{open:e,onOpenChange:O,children:n.jsxs(sn,{className:"sm:max-w-md",children:[n.jsxs(fn,{children:[n.jsx(dn,{children:"Registrar Pagamento Manual"}),n.jsxs(Zo,{children:["Valor: ",n.jsx("span",{className:"font-bold text-foreground",children:y(s)})]})]}),n.jsxs("div",{className:"space-y-4 py-4",children:[n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-start gap-2",children:[n.jsx(Mr,{className:"h-5 w-5 text-amber-500 shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-amber-800",children:[n.jsx("p",{className:"font-medium",children:"Comprovante obrigatrio"}),n.jsx("p",{className:"text-amber-700",children:"Pagamentos manuais passam por validao administrativa."})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Mtodo de Pagamento *"}),n.jsxs(Kt,{value:i,onValueChange:o,children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecione o mtodo"})}),n.jsx(qt,{children:yJe.map(R=>n.jsx(ze,{value:R.value,children:R.label},R.value))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Comprovante *"}),n.jsx("input",{type:"file",ref:x,onChange:b,accept:"image/*",className:"hidden"}),h?n.jsxs("div",{className:"relative",children:[n.jsx("img",{src:h,alt:"Comprovante",className:"w-full h-48 object-contain border rounded-lg bg-muted"}),n.jsx(he,{variant:"outline",size:"sm",className:"absolute bottom-2 right-2",onClick:()=>{var R;return(R=x.current)==null?void 0:R.click()},children:"Trocar"})]}):n.jsxs("div",{onClick:()=>{var R;return(R=x.current)==null?void 0:R.click()},className:"border-2 border-dashed rounded-lg p-8 text-center cursor-pointer hover:border-primary transition-colors",children:[n.jsx(Gh,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"Clique para anexar foto do comprovante"}),n.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG at 5MB"})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Observaes (opcional)"}),n.jsx(Yn,{value:c,onChange:R=>d(R.target.value),placeholder:"Informaes adicionais sobre o pagamento...",rows:2})]})]}),n.jsxs(Da,{children:[n.jsx(he,{variant:"outline",onClick:O,children:"Cancelar"}),n.jsxs(he,{onClick:T,disabled:g||m||!i||!l,children:[(g||m)&&n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),"Confirmar Pagamento"]})]})]})})}function bJe({orderId:e,currentMethod:t,currentShipping:r,currentShippingService:s,subtotal:a,discounts:i,isPaid:o,isAwaitingPayment:c,customerZipCode:d,customerId:l,orderItems:u=[],onUpdateDelivery:h,onUpdateCustomerZip:f}){const[m,p]=P.useState(t),[g,v]=P.useState(t==="correios"&&r>0?r.toString():""),[x,y]=P.useState(s||""),[b,j]=P.useState(!1),[T,O]=P.useState(d||""),[R,D]=P.useState(!1),[L,q]=P.useState([]),[X,H]=P.useState(""),[M,F]=P.useState(null),[S,E]=P.useState(!1),[N,C]=P.useState(""),k=()=>!t||t==="retirada"?t==="retirada":t==="motoboy"?r===Zs.motoboyFee:t==="correios"?r>0:!1;P.useEffect(()=>{d&&!T&&O(d)},[d]),P.useEffect(()=>{m!=="correios"&&(q([]),H(""),F(null),E(!1))},[m]);const I=se=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(se),U=async()=>{const se=T.replace(/\D/g,"");if(se.length!==8){F("CEP deve ter 8 dgitos");return}D(!0),F(null),q([]),H(""),E(!1);try{const le=u.reduce((pe,ge)=>pe+ge.qtd*.3,0)||.5,ye={toZipCode:se,weight:Math.max(.3,le),length:30,width:20,height:Math.min(100,10+u.reduce((pe,ge)=>pe+ge.qtd*3,0))};console.log("[DeliverySection] Calculating shipping:",ye);const{data:ue,error:ne}=await ce.functions.invoke("calculate-shipping",{body:ye});if(console.log("[DeliverySection] Response:",ue),ne){console.error("[DeliverySection] Function error:",ne),F("Erro ao calcular frete. Use o frete manual."),E(!0);return}if(ue!=null&&ue.error){F(ue.error),E(!0);return}ue!=null&&ue.quotes&&ue.quotes.length>0?(q(ue.quotes),de.success("Opes de frete carregadas!")):(F("Nenhuma opo de frete disponvel para este CEP"),E(!0))}catch(le){console.error("[DeliverySection] Exception:",le),F("Erro de conexo. Use o frete manual."),E(!0)}finally{D(!1)}},$=se=>{H(se);const le=L.find(ye=>ye.id===se);le&&(v(le.price.toString()),y(le.name||le.serviceName),E(!1),C(""))},Y=()=>{const se=parseFloat(N.replace(",","."));if(isNaN(se)||se<=0){de.error("Informe um valor vlido");return}v(se.toString()),y("Manual"),H("")},Z=se=>{if(se==="retirada")return 0;if(se==="motoboy")return Zs.motoboyFee;if(se==="correios"){const le=parseFloat(g.replace(",","."));return isNaN(le)?0:le}return 0},re=se=>{const le=Z(se);return a-i+le},G=()=>{if(m==="correios"){if(T.replace(/\D/g,"").length!==8)return!1;const le=parseFloat(g.replace(",","."));return!isNaN(le)&&le>0}return!0},J=()=>m!==t?!0:m==="correios"?(parseFloat(g.replace(",","."))||0)!==r:m==="motoboy"&&r!==Zs.motoboyFee||m==="retirada"&&r!==0,V=()=>k()?J()&&G():G(),W=async()=>{if(!G())return;j(!0);const se=Z(m),ye=await h(e,m,se,m==="correios"?x:void 0);if(ye&&m==="correios"&&l&&f){const ue=T.replace(/\D/g,"");ue.length===8&&ue!==(d==null?void 0:d.replace(/\D/g,""))&&await f(l,ue)}j(!1),ye&&v(se.toString())},ee=se=>{p(se),se!=="correios"&&(v(""),q([]),H(""),E(!1))},ie=m==="correios"?gn:m==="motoboy"?rc:pa,oe=m==="correios"?"Correios":m==="motoboy"?"Motoboy":"Retirada na Loja";return o?n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[n.jsx(ie,{className:"h-4 w-4"}),"Entrega: ",oe]}),n.jsxs(Ae,{className:"bg-green-100 text-green-700 border-green-300",children:[n.jsx(Er,{className:"h-3 w-3 mr-1"}),"Confirmada"]})]}),r>0&&n.jsxs("div",{className:"text-sm text-muted-foreground",children:["Frete: ",I(r),s&&` (${s})`]})]}):n.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/30",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[n.jsx(ie,{className:"h-4 w-4"}),"ETAPA 1: Forma de Envio"]}),k()?n.jsxs(Ae,{className:"bg-green-100 text-green-700 border-green-300",children:[n.jsx(Er,{className:"h-3 w-3 mr-1"}),"Confirmada"]}):n.jsxs(Ae,{variant:"outline",className:"border-amber-300 text-amber-700 bg-amber-50",children:[n.jsx(Mr,{className:"h-3 w-3 mr-1"}),"Pendente"]})]}),n.jsxs(Kt,{value:m,onValueChange:se=>ee(se),children:[n.jsx(Vt,{children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"retirada",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(pa,{className:"h-4 w-4"}),"Retirada na Loja (Grtis)"]})}),n.jsx(ze,{value:"motoboy",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(rc,{className:"h-4 w-4"}),"Motoboy - ",I(Zs.motoboyFee)]})}),n.jsx(ze,{value:"correios",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(gn,{className:"h-4 w-4"}),"Correios"]})})]})]}),m==="correios"&&n.jsxs("div",{className:"space-y-4 border-t pt-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{className:"flex items-center gap-2",children:[n.jsx(_o,{className:"h-4 w-4"}),"CEP de destino *"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Qe,{value:fv(T),onChange:se=>O(se.target.value.replace(/\D/g,"").slice(0,8)),placeholder:"00000-000",maxLength:9,disabled:R,className:"flex-1"}),n.jsx(he,{variant:"secondary",onClick:U,disabled:R||T.replace(/\D/g,"").length!==8,children:R?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 animate-spin mr-2"}),"Calculando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(iae,{className:"h-4 w-4 mr-2"}),"Calcular"]})})]}),T.replace(/\D/g,"").length!==8&&n.jsx("p",{className:"text-xs text-muted-foreground",children:"Informe o CEP para calcular o frete"})]}),M&&n.jsxs("div",{className:"bg-destructive/10 border border-destructive/30 rounded-lg p-3 text-sm text-destructive",children:[n.jsx(Mr,{className:"h-4 w-4 inline mr-2"}),M]}),L.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{className:"flex items-center gap-2",children:[n.jsx(gn,{className:"h-4 w-4"}),"Escolha o servio"]}),n.jsx(wc,{value:X,onValueChange:$,children:L.map(se=>n.jsxs("label",{className:We("flex items-center justify-between p-3 rounded-lg border cursor-pointer hover:bg-muted/50 transition-colors",X===se.id?"border-primary bg-primary/5":"border-border"),children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(Wi,{value:se.id}),n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-sm",children:se.name||se.serviceName}),n.jsx("p",{className:"text-xs text-muted-foreground",children:se.deliveryRange?`${se.deliveryRange.min}-${se.deliveryRange.max} dias teis`:`${se.deliveryDays||se.deliveryTime} dias teis`})]})]}),n.jsx("span",{className:"font-semibold",children:I(se.price)})]},se.id))})]}),(L.length>0||M)&&n.jsx("div",{className:"pt-2 border-t",children:n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>E(!S),className:"text-muted-foreground",children:[n.jsx(yae,{className:"h-4 w-4 mr-2"}),S?"Ocultar frete manual":"Inserir frete manual"]})}),S&&n.jsxs("div",{className:"space-y-2 p-3 bg-amber-50 border border-amber-200 rounded-lg",children:[n.jsx(Le,{className:"text-sm text-amber-800",children:"Valor do frete (manual)"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(Qe,{type:"text",inputMode:"decimal",placeholder:"Ex: 25,90",value:N,onChange:se=>C(se.target.value),className:"flex-1"}),n.jsx(he,{variant:"outline",onClick:Y,disabled:!N,children:"Usar"})]})]}),parseFloat(g)>0&&n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-medium text-green-800",children:"Frete selecionado"}),n.jsxs("p",{className:"text-sm text-green-600",children:[x||"Manual",": ",I(parseFloat(g))]})]}),n.jsx(Er,{className:"h-5 w-5 text-green-600"})]})]}),n.jsxs("div",{className:"bg-background p-3 rounded-md space-y-1",children:[n.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[n.jsx("span",{children:"Subtotal"}),n.jsx("span",{children:I(a)})]}),i>0&&n.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[n.jsx("span",{children:"Descontos"}),n.jsxs("span",{children:["-",I(i)]})]}),n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Frete"}),n.jsx("span",{className:We(Z(m)>0?"text-foreground":"text-muted-foreground"),children:Z(m)>0?I(Z(m)):"Grtis"})]}),n.jsxs("div",{className:"flex justify-between text-base font-bold pt-2 border-t",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:I(re(m))})]})]}),V()&&n.jsxs(he,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:W,disabled:!G()||b,children:[b?n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}):n.jsx(vae,{className:"h-4 w-4 mr-2"}),"Confirmar Forma de Envio"]}),k()&&!J()&&n.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 flex items-center gap-3",children:[n.jsx(Er,{className:"h-5 w-5 text-green-600 shrink-0"}),n.jsxs("div",{className:"flex-1",children:[n.jsx("p",{className:"font-medium text-green-800",children:"Entrega confirmada"}),n.jsxs("p",{className:"text-sm text-green-700",children:[m==="retirada"&&"Retirada na loja - Grtis",m==="motoboy"&&`Motoboy - ${I(Zs.motoboyFee)}`,m==="correios"&&`${s||"Correios"} - ${I(r)}`]})]})]}),c&&!k()&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-start gap-2",children:[n.jsx(Mr,{className:"h-5 w-5 text-amber-500 shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm text-amber-800",children:[n.jsx("p",{className:"font-medium",children:"Confirme a entrega antes do pagamento"}),n.jsx("p",{className:"text-amber-700",children:m?m==="correios"&&T.replace(/\D/g,"").length!==8?"Informe o CEP de destino para calcular o frete.":m==="correios"&&parseFloat(g)===0?"Selecione uma opo de frete ou informe manualmente.":"Clique em 'Confirmar Forma de Envio' para prosseguir.":"Selecione um mtodo de entrega."})]})]})]})}function wJe(e,t,r){return e?e==="retirada"?t===0:e==="motoboy"?t===10:e==="correios"?t>0:!1:!1}const _Je=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],BB=["name","phone","zip_code","street","number","neighborhood","city","state","document"];function n6(e){if(!e)return[...BB];const t=[];return BB.forEach(r=>{const s=e[r];(!s||s.trim()===""||r==="document"&&s.replace(/\D/g,"").length!==11)&&t.push(r)}),t}const $B={name:"Nome completo",document:"CPF",phone:"Telefone",zip_code:"CEP",street:"Rua",number:"Nmero",complement:"Complemento",neighborhood:"Bairro",city:"Cidade",state:"Estado",reference:"Referncia"};function jJe({orderId:e,customerId:t,currentData:r,customerName:s,customerPhone:a,onSaved:i,onCancel:o}){const c=M8(),[d,l]=P.useState(!1),[u,h]=P.useState({name:(r==null?void 0:r.name)||s||"",document:(r==null?void 0:r.document)||"",phone:(r==null?void 0:r.phone)||(a==null?void 0:a.replace(/\D/g,""))||"",zip_code:(r==null?void 0:r.zip_code)||"",street:(r==null?void 0:r.street)||"",number:(r==null?void 0:r.number)||"",complement:(r==null?void 0:r.complement)||"",neighborhood:(r==null?void 0:r.neighborhood)||"",city:(r==null?void 0:r.city)||"",state:(r==null?void 0:r.state)||"",reference:(r==null?void 0:r.reference)||""}),f=async()=>{const x=u.zip_code.replace(/\D/g,"");if(x.length===8){const y=await c.lookup(x);y&&h(b=>({...b,zip_code:y.cep,street:y.street||b.street,neighborhood:y.neighborhood||b.neighborhood,city:y.city||b.city,state:y.state||b.state}))}},m=(x,y)=>{h(b=>({...b,[x]:y}))},p=n6(u),g=p.length===0,v=async()=>{if(!g){de.error(`Preencha: ${p.map(x=>$B[x]).join(", ")}`);return}l(!0);try{const x=JSON.parse(JSON.stringify(u)),{error:y}=await ce.from("live_carts").update({shipping_address_snapshot:x,updated_at:new Date().toISOString()}).eq("id",e);if(y)throw y;if(t){const{error:b}=await ce.from("customers").update({name:u.name||void 0,phone:u.phone||void 0,address_line:`${u.street}, ${u.number}`,city:u.city,state:u.state,zip_code:u.zip_code,address_reference:u.reference||void 0,updated_at:new Date().toISOString()}).eq("id",t);b&&console.error("Failed to update customer:",b)}de.success("Dados de envio salvos!"),i()}catch(x){console.error("Error saving shipping data:",x),de.error("Erro ao salvar dados")}finally{l(!1)}};return n.jsxs("div",{className:"space-y-4",children:[p.length>0&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 flex items-start gap-2",children:[n.jsx(Mr,{className:"h-4 w-4 text-amber-600 mt-0.5 shrink-0"}),n.jsxs("div",{className:"text-sm",children:[n.jsx("p",{className:"font-medium text-amber-800",children:"Campos obrigatrios faltando:"}),n.jsx("p",{className:"text-amber-700",children:p.map(x=>$B[x]).join(", ")})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{htmlFor:"name",className:"flex items-center gap-2",children:[n.jsx(Wn,{className:"h-4 w-4"}),"Nome completo *"]}),n.jsx(Qe,{id:"name",value:u.name,onChange:x=>m("name",x.target.value),placeholder:"Nome completo do destinatrio"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{htmlFor:"document",className:"flex items-center gap-2",children:[n.jsx(af,{className:"h-4 w-4"}),"CPF *"]}),n.jsx(Qe,{id:"document",value:u.document,onChange:x=>{const b=x.target.value.replace(/\D/g,"").slice(0,11).replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d)/,"$1.$2").replace(/(\d{3})(\d{1,2})$/,"$1-$2");m("document",b)},placeholder:"000.000.000-00",className:u.document&&u.document.replace(/\D/g,"").length!==11?"border-amber-500":""}),u.document&&u.document.replace(/\D/g,"").length>0&&u.document.replace(/\D/g,"").length!==11&&n.jsx("p",{className:"text-xs text-amber-600",children:"CPF deve ter 11 dgitos"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{htmlFor:"phone",className:"flex items-center gap-2",children:[n.jsx(el,{className:"h-4 w-4"}),"Telefone *"]}),n.jsx(Qe,{id:"phone",value:u.phone,onChange:x=>{const y=x.target.value.replace(/\D/g,"").slice(0,11);let b=y;y.length>2&&(b=`(${y.slice(0,2)}) ${y.slice(2)}`),y.length>7&&(b=`(${y.slice(0,2)}) ${y.slice(2,7)}-${y.slice(7)}`),m("phone",b)},placeholder:"(00) 00000-0000"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs(Le,{htmlFor:"zip_code",className:"flex items-center gap-2",children:[n.jsx(_o,{className:"h-4 w-4"}),"CEP *"]}),n.jsx(Qe,{id:"zip_code",value:fv(u.zip_code),onChange:x=>m("zip_code",x.target.value.replace(/\D/g,"").slice(0,8)),onBlur:f,placeholder:"00000-000",maxLength:9}),c.isLoading&&n.jsxs("p",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[n.jsx(At,{className:"h-3 w-3 animate-spin"}),"Buscando endereo..."]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"street",children:"Rua / Avenida *"}),n.jsx(Qe,{id:"street",value:u.street,onChange:x=>m("street",x.target.value),placeholder:"Nome da rua"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"number",children:"Nmero *"}),n.jsx(Qe,{id:"number",value:u.number,onChange:x=>m("number",x.target.value),placeholder:"N"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"complement",children:"Complemento"}),n.jsx(Qe,{id:"complement",value:u.complement,onChange:x=>m("complement",x.target.value),placeholder:"Apto, Bloco..."})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"neighborhood",children:"Bairro *"}),n.jsx(Qe,{id:"neighborhood",value:u.neighborhood,onChange:x=>m("neighborhood",x.target.value),placeholder:"Bairro"})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[n.jsxs("div",{className:"col-span-2 space-y-2",children:[n.jsx(Le,{htmlFor:"city",children:"Cidade *"}),n.jsx(Qe,{id:"city",value:u.city,onChange:x=>m("city",x.target.value),placeholder:"Cidade"})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{children:"Estado *"}),n.jsxs(Kt,{value:u.state,onValueChange:x=>m("state",x),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"UF"})}),n.jsx(qt,{children:_Je.map(x=>n.jsx(ze,{value:x,children:x},x))})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{htmlFor:"reference",children:"Ponto de referncia"}),n.jsx(Qe,{id:"reference",value:u.reference,onChange:x=>m("reference",x.target.value),placeholder:"Prximo a..."})]}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[o&&n.jsx(he,{variant:"outline",onClick:o,className:"flex-1",children:"Cancelar"}),n.jsx(he,{onClick:v,disabled:!g||d,className:We("flex-1",g&&"bg-green-600 hover:bg-green-700"),children:d?n.jsxs(n.Fragment,{children:[n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}),"Salvando..."]}):n.jsxs(n.Fragment,{children:[n.jsx(td,{className:"h-4 w-4 mr-2"}),"Salvar Dados de Envio"]})})]})]})}const NJe=e=>/^[A-Z]{2}\d{9}BR$/.test(e),SJe=e=>/^\d{8,20}$/.test(e),FB=e=>!e||e.startsWith("ORD-")||e.startsWith("ORD")?!1:NJe(e)||SJe(e);function CJe({order:e,sellers:t,isAdmin:r,onClose:s,onAssignSeller:a,onMarkAsPaid:i,onMarkAsPaidWithProof:o,onMarkAsPosted:c,onMarkAsDelivered:d,onMarkAsPickedUp:l,onGenerateLabel:u,onUpdateDeliveryMethod:h,onUpdateDeliveryWithShipping:f,onUpdateCustomerZipCode:m,onRecordCharge:p,onApprovePayment:g,onRejectPayment:v,onRevertStatus:x,onTrackingSynced:y,chargeHistory:b=[]}){var Ne,_e,be,Me,Se,$e,Ke,Ze,it;const[j,T]=P.useState(!1),[O,R]=P.useState(!1),[D,L]=P.useState(!1),[q,X]=P.useState(!1),[H,M]=P.useState(""),[F,S]=P.useState(!1),[E,N]=P.useState(0),[C,k]=P.useState(!1);if(!e)return null;const I=Re=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(Re),U=e.status==="pago",$=e.status==="aguardando_pagamento"||e.status==="aberto",Y=e.operational_status==="aguardando_retorno",Z=e.status==="cancelado",re=(Date.now()-new Date(e.created_at).getTime())/(1e3*60*60),G=($||Y)&&re>24,J=()=>{const Re=`${window.location.origin}/live-checkout/${e.id}`;return e.public_token?`${Re}?token=${e.public_token}`:Re},V=()=>{const Re=e.live_customer;if(!(Re!=null&&Re.whatsapp))return null;const ot=J(),ut=av(ot);return No(Re.whatsapp,ut)},W=async()=>{const Re=J(),ot=av(Re);await gf(ot)?de.success("Mensagem copiada "):de.error("Erro ao copiar. Tente selecionar o texto manualmente.")},ee=async Re=>{p&&(await p(e.id,Re,!0),de.success("Cobrana registrada!"))},ie=()=>{var ot,ut;const Re=(ut=(ot=e.live_customer)==null?void 0:ot.instagram_handle)==null?void 0:ut.replace(/@/g,"").trim();return Re?`https://www.instagram.com/${Re}`:null},oe=()=>{const Re=e.live_customer;if(!(Re!=null&&Re.whatsapp))return null;const ot=`Ol${Re.nome?` ${Re.nome.split(" ")[0]}`:""}! 

Para enviar seu pedido da sacola #${e.bag_number}, preciso dos dados de entrega:

 Nome completo
 CEP
 Endereo completo (rua, nmero, complemento)
 Telefone

Pode me enviar? `;return No(Re.whatsapp,ot)},se=async(Re,ot,ut)=>{const bt=await o(e.id,Re,ot,ut);return bt&&R(!1),bt},le=async()=>{T(!0);const Re=await u(e.id);T(!1),Re.success&&Re.labelUrl?(window.open(Re.labelUrl,"_blank"),de.success("Etiqueta gerada com sucesso!")):Re.error&&(Re.error.includes("incompletos")?(S(!0),de.error("Complete os dados de envio para gerar a etiqueta",{description:Re.error,duration:5e3})):de.error(Re.error))},ye=async()=>{if(e){k(!0);try{const{data:Re,error:ot}=await ce.functions.invoke("sync-live-cart-tracking",{body:{cartId:e.id}});if(ot){console.error("Sync tracking error:",ot),de.error("Erro ao sincronizar rastreio");return}if(Re.error){Re.status==="tracking_not_found"?de.info("Cdigo de rastreio ainda no disponvel",{description:"Pode levar alguns minutos aps a compra da etiqueta. Tente novamente em breve."}):de.error(Re.error);return}Re.success&&Re.tracking_code&&(de.success(`Rastreio sincronizado: ${Re.tracking_code}`),y&&y(e.id,Re.tracking_code))}catch(Re){console.error("Sync tracking error:",Re),de.error("Erro ao sincronizar rastreio")}finally{k(!1)}}},ue=async Re=>{if(!x)return;if(r&&!H.trim()){de.error("Informe o motivo da reverso");return}await x(e.id,Re,H)&&(X(!1),M(""))},ne=()=>{const Re=e.operational_status,ot=[];return(Re==="entregue"||Re==="retirado")&&(e.delivery_method==="correios"&&ot.push("postado"),e.delivery_method==="motoboy"&&ot.push("em_rota"),e.delivery_method==="retirada"&&ot.push("retirada")),Re==="postado"&&ot.push("etiqueta_gerada"),Re==="etiqueta_gerada"&&ot.push("preparar_envio"),(Re==="preparar_envio"||Re==="em_rota"||Re==="retirada")&&ot.push("pago"),Re==="pago"&&r&&ot.push("aguardando_retorno","aguardando_pagamento"),Re==="aguardando_retorno"&&ot.push("aguardando_pagamento"),ot},pe=e.delivery_method==="correios"?gn:e.delivery_method==="motoboy"?rc:pa,ge=e.delivery_method==="correios"?"Correios":e.delivery_method==="motoboy"?"Motoboy":"Retirada na Loja";return n.jsxs(Tu,{open:!!e,onOpenChange:()=>s(),children:[n.jsxs(fd,{className:"w-full sm:max-w-lg overflow-hidden flex flex-col p-0 max-w-[100vw]",children:[n.jsxs(Pu,{className:"shrink-0 p-3 sm:p-6 pb-2 sm:pb-4",children:[n.jsx("div",{className:"flex items-start justify-between gap-2 pr-6",children:n.jsxs(cf,{className:"flex items-center gap-2 flex-wrap min-w-0",children:[n.jsxs(Ae,{variant:"secondary",className:"text-sm sm:text-lg px-2 sm:px-3 shrink-0",children:["#",e.bag_number]}),n.jsxs("span",{className:"text-sm truncate",children:["@",(Ne=e.live_customer)==null?void 0:Ne.instagram_handle]})]})}),((_e=e.live_customer)==null?void 0:_e.nome)&&n.jsx("p",{className:"text-sm text-muted-foreground truncate",children:e.live_customer.nome})]}),n.jsx(bi,{className:"flex-1 px-3 sm:px-6",children:n.jsxs("div",{className:"space-y-6 pb-6",children:[n.jsxs("div",{className:"flex flex-wrap gap-2",children:[Z&&n.jsx(Ae,{variant:"destructive",children:"Cancelado"}),$&&!Y&&n.jsxs(Ae,{variant:"outline",className:"border-amber-300 text-amber-700 bg-amber-50",children:[n.jsx(Br,{className:"h-3 w-3 mr-1"}),"Aguardando Pagamento"]}),Y&&n.jsxs(Ae,{variant:"outline",className:"border-orange-300 text-orange-700 bg-orange-50",children:[n.jsx(Br,{className:"h-3 w-3 mr-1"}),"Aguardando Retorno"]}),U&&e.operational_status==="pago"&&n.jsxs(Ae,{variant:"outline",className:"border-green-300 text-green-700 bg-green-50",children:[n.jsx(Er,{className:"h-3 w-3 mr-1"}),"Pago"]}),e.operational_status==="preparar_envio"&&n.jsx(Ae,{variant:"outline",className:"border-blue-300 text-blue-700 bg-blue-50",children:"Preparar Envio"}),e.operational_status==="etiqueta_gerada"&&n.jsx(Ae,{variant:"outline",className:"border-indigo-300 text-indigo-700 bg-indigo-50",children:"Etiqueta Gerada"}),e.operational_status==="postado"&&n.jsx(Ae,{variant:"outline",className:"border-purple-300 text-purple-700 bg-purple-50",children:"Postado"}),e.operational_status==="em_rota"&&n.jsxs(Ae,{variant:"outline",className:"border-cyan-300 text-cyan-700 bg-cyan-50",children:[n.jsx(rc,{className:"h-3 w-3 mr-1"}),"Em Rota"]}),e.operational_status==="retirada"&&n.jsxs(Ae,{variant:"outline",className:"border-teal-300 text-teal-700 bg-teal-50",children:[n.jsx(pa,{className:"h-3 w-3 mr-1"}),"Aguardando Retirada"]}),(e.operational_status==="entregue"||e.operational_status==="retirado")&&n.jsxs(Ae,{variant:"outline",className:"border-emerald-300 text-emerald-700 bg-emerald-50",children:[n.jsx(Er,{className:"h-3 w-3 mr-1"}),"Entregue"]}),e.is_raffle_winner&&n.jsxs(Ae,{className:"bg-yellow-100 text-yellow-800 border-yellow-300",children:[n.jsx(ga,{className:"h-3 w-3 mr-1"}),e.raffle_name||"Sorteio"]}),G&&n.jsxs(Ae,{variant:"destructive",children:[n.jsx(Mr,{className:"h-3 w-3 mr-1"}),"+",Math.floor(re),"h pendente"]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-sm font-medium",children:"Vendedora Responsvel"}),n.jsxs(Kt,{value:e.seller_id||"unassigned",onValueChange:Re=>a(e.id,Re==="unassigned"?null:Re),children:[n.jsx(Vt,{children:n.jsx(Xt,{placeholder:"Selecionar vendedora"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"unassigned",children:"Nenhuma"}),t.map(Re=>n.jsx(ze,{value:Re.id,children:Re.name},Re.id))]})]})]}),n.jsx(Ta,{}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("h4",{className:"font-medium",children:"Itens do Pedido"}),(be=e.items)==null?void 0:be.map(Re=>{var ot,ut,bt,Je;return n.jsxs("div",{className:We("flex items-center gap-3 p-2 rounded-lg border",Re.status==="cancelado"&&"opacity-50 bg-muted"),children:[(ot=Re.product)!=null&&ot.image_url?n.jsx("img",{src:Re.product.image_url,alt:"",className:"w-12 h-12 rounded object-cover"}):n.jsx("div",{className:"w-12 h-12 rounded bg-muted flex items-center justify-center",children:n.jsx(Ut,{className:"h-5 w-5 text-muted-foreground"})}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("p",{className:"font-medium text-sm truncate",children:(ut=Re.product)==null?void 0:ut.name}),n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[n.jsx("span",{children:((bt=Re.variante)==null?void 0:bt.tamanho)||"-"}),((Je=Re.product)==null?void 0:Je.color)&&n.jsxs("span",{children:[" ",Re.product.color]}),n.jsxs("span",{children:[" x",Re.qtd]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"font-medium",children:I(Re.preco_unitario*Re.qtd)}),Re.status==="cancelado"&&n.jsx(Ae,{variant:"destructive",className:"text-xs",children:"Cancelado"})]})]},Re.id)})]}),n.jsx(Ta,{}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),n.jsx("span",{children:I(e.subtotal)})]}),e.descontos>0&&n.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[n.jsx("span",{children:"Descontos"}),n.jsxs("span",{children:["-",I(e.descontos)]})]}),e.frete>0&&n.jsxs("div",{className:"flex justify-between text-sm",children:[n.jsx("span",{className:"text-muted-foreground",children:"Frete"}),n.jsx("span",{children:I(e.frete)})]}),n.jsxs("div",{className:"flex justify-between text-lg font-bold pt-2 border-t",children:[n.jsx("span",{children:"Total"}),n.jsx("span",{children:I(e.total)})]})]}),n.jsx(Ta,{}),($||Y)&&!Z&&n.jsx(bJe,{orderId:e.id,currentMethod:e.delivery_method,currentShipping:e.frete,currentShippingService:e.shipping_service_name,subtotal:e.subtotal,discounts:e.descontos,isPaid:U,isAwaitingPayment:$||Y,customerZipCode:(Me=e.shipping_address_snapshot)==null?void 0:Me.zip_code,customerId:(Se=e.live_customer)==null?void 0:Se.client_id,orderItems:(($e=e.items)==null?void 0:$e.map(Re=>({qtd:Re.qtd,product_id:Re.product_id})))||[],onUpdateDelivery:f,onUpdateCustomerZip:m}),U&&n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[n.jsx(pe,{className:"h-4 w-4"}),"Entrega: ",ge]}),n.jsxs(Ae,{className:"bg-green-100 text-green-700 border-green-300",children:[n.jsx(Er,{className:"h-3 w-3 mr-1"}),"Confirmada"]})]}),e.frete>0&&n.jsxs("div",{className:"text-sm text-muted-foreground",children:["Frete: ",I(e.frete)]}),e.delivery_method==="correios"&&n.jsx("div",{className:"bg-muted/50 rounded-lg p-3 space-y-2",children:(()=>{var bt,Je,Ce,Ge,Pe;const Re=e.shipping_address_snapshot,ut=n6(Re).length===0;return F||!ut?n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("h4",{className:"font-medium text-amber-700 flex items-center gap-2",children:[n.jsx(Mr,{className:"h-4 w-4"}),"Completar dados de envio"]}),ut&&n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>S(!1),children:n.jsx(an,{className:"h-4 w-4"})})]}),n.jsx(jJe,{orderId:e.id,customerId:(bt=e.live_customer)==null?void 0:bt.client_id,currentData:Re,customerName:(Je=e.live_customer)==null?void 0:Je.nome,customerPhone:(Ce=e.live_customer)==null?void 0:Ce.whatsapp,onSaved:()=>{S(!1),N(Ve=>Ve+1)},onCancel:ut?()=>S(!1):void 0}),((Ge=e.live_customer)==null?void 0:Ge.whatsapp)&&n.jsx("div",{className:"pt-2 border-t",children:n.jsx(he,{variant:"ghost",size:"sm",className:"text-muted-foreground w-full",asChild:!0,children:n.jsxs("a",{href:oe()||"#",target:"_blank",rel:"noopener noreferrer",children:[n.jsx(nn,{className:"h-4 w-4 mr-2"}),"Solicitar via WhatsApp"]})})})]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex items-start gap-2",children:[n.jsx(_o,{className:"h-4 w-4 text-muted-foreground shrink-0 mt-0.5"}),n.jsxs("div",{className:"text-sm",children:[n.jsx("p",{className:"font-medium",children:(Re==null?void 0:Re.name)||((Pe=e.live_customer)==null?void 0:Pe.nome)}),n.jsxs("p",{children:[Re==null?void 0:Re.street,", ",Re==null?void 0:Re.number]}),(Re==null?void 0:Re.complement)&&n.jsx("p",{children:Re.complement}),n.jsx("p",{children:Re==null?void 0:Re.neighborhood}),n.jsxs("p",{children:[Re==null?void 0:Re.city,"/",Re==null?void 0:Re.state]}),n.jsxs("p",{className:"font-medium",children:["CEP: ",Re==null?void 0:Re.zip_code]}),(Re==null?void 0:Re.phone)&&n.jsxs("p",{className:"text-muted-foreground",children:["Tel: ",Re.phone]})]})]}),n.jsx(he,{variant:"ghost",size:"icon",className:"shrink-0",onClick:()=>S(!0),children:n.jsx(nc,{className:"h-4 w-4"})})]}),(()=>{const Ve=FB(e.shipping_tracking_code),st=!!e.me_label_url||!!e.me_shipment_id;return st||e.shipping_tracking_code?n.jsx("div",{className:"pt-3 mt-3 border-t space-y-2",children:Ve?n.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(gn,{className:"h-4 w-4 text-purple-600"}),n.jsx("span",{className:"text-sm font-medium text-purple-800",children:"Cdigo de rastreio"})]}),n.jsx("p",{className:"font-mono text-lg text-purple-900",children:e.shipping_tracking_code}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 border-purple-200 text-purple-700 hover:bg-purple-100",onClick:async()=>{await navigator.clipboard.writeText(e.shipping_tracking_code),de.success("Cdigo copiado!")},children:[n.jsx(Ia,{className:"h-3 w-3"}),"Copiar"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-1 border-purple-200 text-purple-700 hover:bg-purple-100",onClick:()=>{window.open(`https://rastreamento.correios.com.br/app/index.php?objeto=${e.shipping_tracking_code}`,"_blank")},children:[n.jsx(ma,{className:"h-3 w-3"}),"Rastrear nos Correios"]})]})]}):st?n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[n.jsx(Mr,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm font-medium",children:"Etiqueta gerada, aguardando rastreio"})]}),n.jsx("p",{className:"text-xs text-amber-600",children:"O cdigo de rastreio pode levar alguns minutos para ficar disponvel aps a compra da etiqueta."}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 border-amber-300 text-amber-700 hover:bg-amber-100",onClick:ye,disabled:C,children:[C?n.jsx(At,{className:"h-3 w-3 animate-spin"}):n.jsx(en,{className:"h-3 w-3"}),"Sincronizar Rastreio"]})]}):null}):null})()]})})()},E)]}),n.jsx(vJe,{order:e,isAdmin:r,onApprove:g,onReject:v}),b.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsx(Ta,{}),n.jsx("h4",{className:"font-medium text-sm",children:"Histrico de Cobranas"}),n.jsx("div",{className:"space-y-1",children:b.map((Re,ot)=>n.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[n.jsx("span",{className:"capitalize",children:Re.channel==="whatsapp"?" WhatsApp":" Direct"}),n.jsx("span",{children:""}),n.jsx("span",{children:Ht(new Date(Re.created_at),"dd/MM HH:mm",{locale:gr})})]},ot))})]}),(e.customer_checkout_notes||e.customer_live_notes||e.delivery_notes)&&n.jsxs(n.Fragment,{children:[n.jsx(Ta,{}),n.jsxs("div",{className:"space-y-3",children:[e.customer_checkout_notes&&n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2 text-blue-700 mb-2",children:[n.jsx(nn,{className:"h-4 w-4"}),"Observao do cliente"]}),n.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:e.customer_checkout_notes})]}),e.customer_live_notes&&n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2 text-purple-700 mb-2",children:[n.jsx(nn,{className:"h-4 w-4"}),"Obs. da Live"]}),n.jsx("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg text-sm",children:e.customer_live_notes})]}),e.delivery_notes&&e.delivery_method==="motoboy"&&n.jsxs("div",{children:[n.jsxs("h4",{className:"font-medium text-sm flex items-center gap-2 text-amber-700 mb-2",children:[n.jsx(rc,{className:"h-4 w-4"}),"Instrues de entrega"]}),n.jsxs("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded-lg text-sm",children:[e.delivery_notes,e.delivery_period&&n.jsxs("p",{className:"mt-1 text-xs text-amber-600",children:["Perodo: ",e.delivery_period==="manha"?"Manh":e.delivery_period==="tarde"?"Tarde":"Qualquer horrio"]})]})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[((Ke=e.live_customer)==null?void 0:Ke.whatsapp)&&n.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[n.jsx(el,{className:"h-4 w-4 text-muted-foreground"}),n.jsx("span",{children:e.live_customer.whatsapp})]}),ie()&&n.jsxs("a",{href:ie(),target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[n.jsx(ma,{className:"h-3 w-3"}),kw(((Ze=e.live_customer)==null?void 0:Ze.instagram_handle)||"")]})]}),n.jsxs("div",{className:"text-xs text-muted-foreground space-y-1",children:[n.jsxs("p",{children:["Criado: ",Ht(new Date(e.created_at),"dd/MM/yyyy 's' HH:mm",{locale:gr})]}),n.jsxs("p",{children:["Atualizado: ",Ht(new Date(e.updated_at),"dd/MM/yyyy 's' HH:mm",{locale:gr})]}),e.last_charge_at&&n.jsxs("p",{children:["ltima cobrana: ",Ht(new Date(e.last_charge_at),"dd/MM HH:mm",{locale:gr})]}),e.label_printed_at&&n.jsxs("p",{children:["Etiqueta impressa: ",Ht(new Date(e.label_printed_at),"dd/MM HH:mm",{locale:gr})]})]})]})}),n.jsxs("div",{className:"shrink-0 border-t pt-4 space-y-3",children:[($||Y)&&!Z&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex gap-2",children:[((it=e.live_customer)==null?void 0:it.whatsapp)&&n.jsx(he,{variant:"outline",className:"flex-1",asChild:!0,children:n.jsxs("a",{href:V()||"#",target:"_blank",rel:"noopener noreferrer",children:[n.jsx(nn,{className:"h-4 w-4 mr-2"}),Y?"Cobrar novamente":"Cobrar WhatsApp"]})}),n.jsxs(he,{variant:"outline",onClick:W,children:[n.jsx(Ia,{className:"h-4 w-4 mr-2"}),"Copiar Mensagem"]})]}),ie()&&n.jsx(he,{variant:"outline",className:"w-full",asChild:!0,children:n.jsxs("a",{href:ie(),target:"_blank",rel:"noopener noreferrer",children:[n.jsx(ma,{className:"h-4 w-4 mr-2"}),"Abrir Instagram para Direct"]})}),p&&n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{variant:"outline",className:"flex-1 border-amber-300 text-amber-700 hover:bg-amber-50",onClick:()=>ee("whatsapp"),children:"Registrar via WhatsApp"}),n.jsx(he,{variant:"outline",className:"flex-1 border-purple-300 text-purple-700 hover:bg-purple-50",onClick:()=>ee("direct"),children:"Registrar via Direct"})]})]}),n.jsx(Ta,{}),(()=>{const Re=wJe(e.delivery_method,e.frete);return n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h4",{className:"font-medium text-sm",children:"ETAPA 2: Confirmar Pagamento"}),Re?n.jsxs(Ae,{className:"bg-green-100 text-green-700 border-green-300 text-xs",children:[n.jsx(Er,{className:"h-3 w-3 mr-1"}),"Liberado"]}):n.jsxs(Ae,{variant:"outline",className:"border-gray-300 text-gray-500 text-xs",children:[n.jsx(Mr,{className:"h-3 w-3 mr-1"}),"Aguardando Etapa 1"]})]}),n.jsxs(he,{className:"w-full bg-emerald-600 hover:bg-emerald-700 disabled:opacity-50",onClick:()=>R(!0),disabled:!Re,children:[n.jsx(ws,{className:"h-4 w-4 mr-2"}),"Marcar como Pago (com comprovante)"]}),!Re&&n.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-2 flex items-center gap-2 text-xs",children:[n.jsx(jae,{className:"h-4 w-4 text-gray-500 shrink-0"}),n.jsx("span",{className:"text-gray-600",children:"Complete a Etapa 1 (Confirmar forma de envio) para liberar o pagamento"})]}),n.jsxs(he,{variant:"outline",className:"w-full gap-2 border-amber-300 text-amber-700 hover:bg-amber-50",onClick:()=>L(!0),children:[n.jsx(en,{className:"h-4 w-4"}),"Revalidar Pagamento MP"]})]})})()]}),U&&!Z&&e.payment_review_status!=="pending_review"&&(()=>{const Re=e.operational_status,ot=e.delivery_method;return Re==="entregue"||Re==="retirado"?null:n.jsxs("div",{className:"space-y-3",children:[n.jsx(Ta,{}),ot==="correios"&&n.jsxs(n.Fragment,{children:[(Re==="pago"||Re==="preparar_envio")&&(()=>{const bt=e.shipping_address_snapshot,Ce=n6(bt).length===0;return n.jsxs("div",{className:"space-y-2",children:[n.jsx("div",{className:"text-sm text-muted-foreground",children:"Prximo passo: Gerar etiqueta Melhor Envio"}),n.jsxs(he,{className:"w-full",onClick:le,disabled:j||!Ce,children:[j?n.jsx(At,{className:"h-4 w-4 mr-2 animate-spin"}):n.jsx(Oa,{className:"h-4 w-4 mr-2"}),"Gerar Etiqueta"]}),!Ce&&n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-2 space-y-2",children:[n.jsxs("div",{className:"text-xs text-amber-700 flex items-center gap-1",children:[n.jsx(Mr,{className:"h-3 w-3"}),"Complete os dados de envio acima para gerar a etiqueta"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"w-full border-amber-300 text-amber-700 hover:bg-amber-100",onClick:()=>S(!0),children:[n.jsx(nc,{className:"h-3 w-3 mr-2"}),"Completar dados de envio"]})]})]})})(),Re==="etiqueta_gerada"&&e.me_label_url&&n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{variant:"outline",className:"flex-1",asChild:!0,children:n.jsxs("a",{href:e.me_label_url,target:"_blank",rel:"noopener noreferrer",children:[n.jsx(h1,{className:"h-4 w-4 mr-2"}),"Imprimir Etiqueta"]})}),n.jsxs(he,{className:"flex-1",onClick:()=>c(e.id),children:[n.jsx(gn,{className:"h-4 w-4 mr-2"}),"Marcar Postado"]})]}),Re==="postado"&&(FB(e.shipping_tracking_code)?n.jsxs(he,{className:"w-full bg-emerald-600 hover:bg-emerald-700",onClick:()=>d(e.id),children:[n.jsx(Er,{className:"h-4 w-4 mr-2"}),"Marcar como Entregue"]}):n.jsx("div",{className:"space-y-2",children:n.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 space-y-2",children:[n.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[n.jsx(Mr,{className:"h-4 w-4"}),n.jsx("span",{className:"text-sm font-medium",children:"Aguardando cdigo de rastreio"})]}),n.jsx("p",{className:"text-xs text-amber-600",children:"No  possvel marcar como entregue sem um cdigo de rastreio vlido."}),n.jsxs(he,{variant:"outline",size:"sm",className:"gap-2 border-amber-300 text-amber-700 hover:bg-amber-100 w-full",onClick:ye,disabled:C,children:[C?n.jsx(At,{className:"h-3 w-3 animate-spin"}):n.jsx(en,{className:"h-3 w-3"}),"Sincronizar Rastreio"]})]})}))]}),ot==="motoboy"&&n.jsxs(n.Fragment,{children:[Re==="pago"&&n.jsxs(he,{className:"w-full",onClick:()=>d(e.id),children:[n.jsx(rc,{className:"h-4 w-4 mr-2"}),"Marcar Em Rota"]}),Re==="em_rota"&&n.jsxs(he,{className:"w-full bg-emerald-600 hover:bg-emerald-700",onClick:()=>d(e.id),children:[n.jsx(Er,{className:"h-4 w-4 mr-2"}),"Marcar como Entregue"]})]}),ot==="retirada"&&n.jsxs(n.Fragment,{children:[Re==="pago"&&n.jsxs(he,{className:"w-full",onClick:()=>l(e.id),children:[n.jsx(pa,{className:"h-4 w-4 mr-2"}),"Marcar Aguardando Retirada"]}),Re==="retirada"&&n.jsxs(he,{className:"w-full bg-emerald-600 hover:bg-emerald-700",onClick:()=>l(e.id),children:[n.jsx(Er,{className:"h-4 w-4 mr-2"}),"Marcar como Retirado"]})]})]})})(),x&&ne().length>0&&!Z&&n.jsx("div",{className:"pt-2 border-t border-border/40",children:q?n.jsxs("div",{className:"space-y-2",children:[n.jsx(Le,{className:"text-sm",children:"Voltar para:"}),n.jsx("div",{className:"flex flex-wrap gap-2",children:ne().map(Re=>n.jsx(he,{variant:"outline",size:"sm",className:"text-xs",onClick:()=>ue(Re),children:Re.replace(/_/g," ")},Re))}),r&&n.jsx(Qe,{placeholder:"Motivo da reverso (obrigatrio para admin)",value:H,onChange:Re=>M(Re.target.value),className:"text-sm"}),n.jsx(he,{variant:"ghost",size:"sm",onClick:()=>{X(!1),M("")},children:"Cancelar"})]}):n.jsxs(he,{variant:"ghost",size:"sm",className:"w-full text-muted-foreground hover:text-foreground",onClick:()=>X(!0),children:[n.jsx(Pae,{className:"h-4 w-4 mr-2"}),"Voltar Status"]})})]})]}),n.jsx(dte,{open:O,onClose:()=>R(!1),orderId:e.id,orderTotal:e.total,onConfirm:se}),n.jsx(TH,{open:D,onClose:()=>L(!1),onSuccess:s,liveCartId:e.id})]})}function EJe({isOpen:e,onClose:t,message:r,phone:s}){const a=async()=>{await gf(r),de.success("Mensagem copiada!")},i=s.replace(/^55(\d{2})(\d{5})(\d{4})$/,"($1) $2-$3"),o=()=>{const c=encodeURIComponent(r),d=`https://wa.me/${s}?text=${c}`;window.location.href=d};return n.jsx(cn,{open:e,onOpenChange:t,children:n.jsxs(sn,{className:"max-w-md",children:[n.jsxs(fn,{children:[n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(nn,{className:"h-5 w-5 text-whatsapp"}),"WhatsApp"]}),n.jsx(Zo,{children:"O WhatsApp no pde ser aberto automaticamente. Copie a mensagem abaixo e envie manualmente."})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[n.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Nmero da loja:"}),n.jsx("p",{className:"font-mono text-lg",children:i})]}),n.jsxs("div",{className:"p-3 bg-muted rounded-lg max-h-48 overflow-y-auto",children:[n.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"Mensagem:"}),n.jsx("p",{className:"text-sm whitespace-pre-wrap",children:r})]})]}),n.jsxs(Da,{className:"flex-col sm:flex-row gap-2",children:[n.jsxs(he,{variant:"outline",onClick:o,className:"gap-2",children:[n.jsx(ma,{className:"h-4 w-4"}),"Tentar novamente"]}),n.jsxs(he,{onClick:a,className:"btn-whatsapp gap-2",children:[n.jsx(Ia,{className:"h-4 w-4"}),"Copiar mensagem"]})]})]})})}function kJe({open:e,onClose:t,orders:r,onRecordCharge:s}){const[a,i]=P.useState(new Set),[o,c]=P.useState("whatsapp"),[d,l]=P.useState(!1),[u,h]=P.useState(0),[f,m]=P.useState(new Set),[p,g]=P.useState(new Set),[v,x]=P.useState({open:!1,message:"",phone:""}),[y,b]=P.useState(r),[j,T]=P.useState(null),[O,R]=P.useState("");P.useEffect(()=>{b(r)},[r]),P.useEffect(()=>{e&&(i(new Set(r.map($=>$.id))),m(new Set),g(new Set),h(0),T(null))},[e,r]);const D=$=>{var Y;T($.id),R(((Y=$.live_customer)==null?void 0:Y.whatsapp)||"")},L=async $=>{if(!O.trim())return;const{error:Y}=await ce.from("live_customers").update({whatsapp:O}).eq("id",$.live_customer.id);if(Y){de.error("Erro ao salvar telefone");return}b(Z=>Z.map(re=>re.id===$.id?{...re,live_customer:{...re.live_customer,whatsapp:O}}:re)),i(Z=>new Set([...Z,$.id])),T(null),de.success("Telefone salvo!")},q=$=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format($),X=$=>{const Y=new Set(a);Y.has($)?Y.delete($):Y.add($),i(Y)},H=()=>{a.size===r.length?i(new Set):i(new Set(r.map($=>$.id)))},M=y.filter($=>a.has($.id)),F=$=>{const Y=`${window.location.origin}/live-checkout/${$.id}`;return $.public_token?`${Y}?token=${$.public_token}`:Y},S=$=>av(F($),$.bag_number||void 0),E=async()=>{const $=M.filter(Y=>{var Z;return(Z=Y.live_customer)==null?void 0:Z.whatsapp});if($.length===0){de.error("Nenhum pedido selecionado tem WhatsApp");return}l(!0),h(0);for(let Y=0;Y<$.length;Y++){const Z=$[Y],re=S(Z),G=No(Z.live_customer.whatsapp,re);try{window.open(G,"_blank")}catch{x({open:!0,message:re,phone:Z.live_customer.whatsapp})}await s(Z.id,"whatsapp",!0),h(Y+1),Y<$.length-1&&await new Promise(J=>setTimeout(J,600))}l(!1),de.success(`${$.length} cobranas registradas!`)},N=async($,Y)=>{const Z=S($);await navigator.clipboard.writeText(Z),m(re=>new Set([...re,Y])),de.success("Mensagem copiada!")},C=async $=>{const Y=F($);await navigator.clipboard.writeText(Y),de.success("Link copiado!")},k=async($,Y)=>{await s($.id,"direct",!0),g(Z=>new Set([...Z,Y])),de.success("Cobrana registrada!")},I=p.size,U=r.filter($=>{var Y;return(Y=$.live_customer)==null?void 0:Y.whatsapp}).length;return n.jsxs(n.Fragment,{children:[n.jsx(cn,{open:e,onOpenChange:()=>t(),children:n.jsxs(sn,{className:"max-w-2xl max-h-[85vh] flex flex-col",children:[n.jsxs(fn,{children:[n.jsxs(dn,{className:"flex items-center gap-2",children:[n.jsx(zu,{className:"h-5 w-5"}),"Cobrar Pendentes",n.jsxs(Ae,{variant:"secondary",children:[r.length," pedidos"]})]}),n.jsxs(Zo,{className:"text-muted-foreground",children:["Envie cobranas elegantes com link de pagamento. O modal ",n.jsx("strong",{children:"no fecha"})," ao copiar."]})]}),n.jsxs(pi,{value:o,onValueChange:$=>c($),children:[n.jsxs(Qa,{className:"grid w-full grid-cols-2",children:[n.jsxs(pr,{value:"whatsapp",className:"flex items-center gap-2",children:[n.jsx(nn,{className:"h-4 w-4"}),"WhatsApp (",U,")"]}),n.jsxs(pr,{value:"direct",className:"flex items-center gap-2",children:[n.jsx(Zz,{className:"h-4 w-4"}),"Direct (",r.length,")"]})]}),n.jsx(wr,{value:"whatsapp",className:"mt-4",children:n.jsxs("div",{className:"bg-emerald-50 border border-emerald-200 rounded-lg p-3 text-sm text-emerald-800",children:[n.jsx("p",{className:"font-medium mb-1",children:" Via WhatsApp"}),n.jsx("p",{className:"text-emerald-700",children:"Abre o WhatsApp para cada cliente selecionado. Se bloqueado, copie a mensagem manualmente."})]})}),n.jsx(wr,{value:"direct",className:"mt-4",children:n.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-3 text-sm text-purple-800",children:[n.jsx("p",{className:"font-medium mb-1",children:" Via Direct Instagram"}),n.jsx("p",{className:"text-purple-700",children:'Para cada cliente: copie a mensagem  abra o perfil  envie  clique em "Registrar".'})]})})]}),o==="whatsapp"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center gap-2 py-2 border-b mt-2",children:[n.jsx(va,{checked:a.size===r.length,onCheckedChange:H}),n.jsxs("span",{className:"text-sm font-medium",children:["Selecionar todos (",a.size,"/",r.length,")"]}),n.jsxs("span",{className:"ml-auto text-sm text-muted-foreground",children:["Total: ",q(M.reduce(($,Y)=>$+Y.total,0))]})]}),n.jsx(bi,{className:"flex-1 min-h-[200px] max-h-[300px]",children:n.jsx("div",{className:"space-y-2 pr-4",children:y.map($=>{var re,G,J;const Y=!!((re=$.live_customer)!=null&&re.whatsapp),Z=j===$.id;return n.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${!Y&&!Z?"opacity-90 bg-muted/30":"hover:bg-muted/50"}`,children:[n.jsx(va,{checked:a.has($.id),onCheckedChange:()=>X($.id),disabled:!Y&&!Z}),n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Ae,{variant:"outline",className:"font-mono text-xs",children:["#",$.bag_number]}),n.jsx("span",{className:"font-medium truncate",children:kw(((G=$.live_customer)==null?void 0:G.instagram_handle)||"")})]}),Z?n.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[n.jsx(Qe,{value:O,onChange:V=>R(V.target.value),placeholder:"1199...",className:"h-7 text-xs w-32 bg-white",autoFocus:!0,onKeyDown:V=>{V.key==="Enter"&&L($),V.key==="Escape"&&T(null)}}),n.jsx(he,{size:"icon",variant:"ghost",className:"h-7 w-7 text-emerald-600 hover:text-emerald-700 hover:bg-emerald-100",onClick:()=>L($),children:n.jsx(td,{className:"h-4 w-4"})}),n.jsx(he,{size:"icon",variant:"ghost",className:"h-7 w-7 text-muted-foreground hover:bg-muted",onClick:()=>T(null),children:n.jsx(an,{className:"h-4 w-4"})})]}):n.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-1 h-7",children:[Y?n.jsxs("span",{className:"text-emerald-600 flex items-center gap-1 bg-emerald-50 px-2 py-0.5 rounded-full border border-emerald-100",children:[" ",(J=$.live_customer)==null?void 0:J.whatsapp,n.jsx("button",{onClick:()=>D($),className:"ml-1 text-emerald-400 hover:text-emerald-700 p-0.5 rounded-full hover:bg-emerald-100 transition-colors",title:"Editar",children:n.jsx(ea,{className:"h-3 w-3"})})]}):n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("span",{className:"text-rose-600 font-medium flex items-center gap-1 bg-rose-50 px-2 py-0.5 rounded-full border border-rose-100",children:[n.jsx(Mr,{className:"h-3 w-3"}),"Sem WhatsApp"]}),n.jsx(he,{variant:"outline",size:"sm",className:"h-6 px-2 text-xs border-dashed text-muted-foreground hover:text-foreground hover:border-solid hover:bg-white transition-all",onClick:()=>D($),children:"+ Adicionar"})]}),$.charge_attempts>0&&n.jsxs("span",{className:"ml-1 px-1.5 py-0.5 bg-gray-100 rounded text-[10px] font-medium",children:[" ",$.charge_attempts,"x cobrada"]})]})]}),n.jsx("span",{className:"font-bold text-sm",children:q($.total)})]},$.id)})})}),n.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:u>0&&`${u} enviadas`}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(he,{variant:"outline",onClick:t,children:"Fechar"}),n.jsx(he,{onClick:E,disabled:d||M.filter($=>{var Y;return(Y=$.live_customer)==null?void 0:Y.whatsapp}).length===0,className:"bg-emerald-600 hover:bg-emerald-700",children:d?n.jsxs(n.Fragment,{children:["Enviando ",u,"/",M.filter($=>{var Y;return(Y=$.live_customer)==null?void 0:Y.whatsapp}).length,"..."]}):n.jsxs(n.Fragment,{children:[n.jsx(nn,{className:"h-4 w-4 mr-2"}),"Abrir WhatsApp (",M.filter($=>{var Y;return(Y=$.live_customer)==null?void 0:Y.whatsapp}).length,")"]})})]})]})]}),o==="direct"&&n.jsxs(n.Fragment,{children:[n.jsx(bi,{className:"flex-1 min-h-[200px] max-h-[400px] mt-2",children:n.jsx("div",{className:"space-y-3 pr-4",children:r.map(($,Y)=>{var V,W;const Z=((V=$.live_customer)==null?void 0:V.instagram_handle)||"",re=f.has(Y),G=p.has(Y),J=JV(Z);return n.jsxs("div",{className:`p-4 rounded-lg border ${G?"bg-emerald-50 border-emerald-200":re?"bg-amber-50 border-amber-200":"bg-background"}`,children:[n.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Ae,{variant:"outline",className:"font-mono text-xs",children:["#",$.bag_number]}),n.jsx("span",{className:"font-semibold",children:kw(Z)}),G&&n.jsxs(Ae,{className:"bg-emerald-100 text-emerald-700 text-xs",children:[n.jsx(xn,{className:"h-3 w-3 mr-1"}),"Registrada"]}),re&&!G&&n.jsx(Ae,{className:"bg-amber-100 text-amber-700 text-xs",children:"Copiada"})]}),((W=$.live_customer)==null?void 0:W.nome)&&n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:$.live_customer.nome}),J&&n.jsxs("a",{href:J,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline flex items-center gap-1 mt-1",children:[n.jsx(ma,{className:"h-3 w-3"}),J]})]}),n.jsx("span",{className:"font-bold",children:q($.total)})]}),n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(he,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>N($,Y),children:[n.jsx(Ia,{className:"h-4 w-4 mr-2"}),"Copiar mensagem"]}),n.jsxs(he,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>C($),children:[n.jsx(Ia,{className:"h-4 w-4 mr-2"}),"S link"]}),J&&n.jsx(he,{variant:"outline",size:"sm",asChild:!0,children:n.jsx("a",{href:J,target:"_blank",rel:"noopener noreferrer",children:n.jsx(ma,{className:"h-4 w-4"})})})]}),!G&&n.jsxs(he,{size:"sm",variant:"secondary",className:"w-full border-amber-300 text-amber-700 hover:bg-amber-100",onClick:()=>k($,Y),children:[n.jsx(xn,{className:"h-4 w-4 mr-2"}),"Registrar cobrana"]})]})]},$.id)})})}),n.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:I>0&&`${I} de ${r.length} registradas`}),n.jsx(he,{variant:"outline",onClick:t,children:"Fechar"})]})]})]})}),n.jsx(EJe,{isOpen:v.open,onClose:()=>x({...v,open:!1}),message:v.message,phone:v.phone})]})}function AJe(){const{eventId:e}=ra(),t=fr(),{hasRole:r,rolesLoading:s}=Hn(),a=!s&&r("admin"),{event:i,isLoading:o}=nj(e),{orders:c,sellers:d,kpis:l,isLoading:u,filterOrders:h,ordersNeedingCharge:f,getOrderUrgency:m,assignSeller:p,markAsPaid:g,markAsPaidWithProof:v,approveManualPayment:x,rejectManualPayment:y,markAsPosted:b,markAsDelivered:j,markAsPickedUp:T,advanceStatus:O,revertStatus:R,generateShippingLabel:D,updateDeliveryMethod:L,updateDeliveryWithShipping:q,updateCustomerZipCode:X,updateDeliveryDetails:H,recordCharge:M,fetchChargeHistory:F,updateTrackingCode:S,refetch:E}=pJe(e),[N,C]=P.useState("list"),[k,I]=P.useState(!1),[U,$]=P.useState(null),[Y,Z]=P.useState({search:"",status:"all",deliveryMethod:"all",sellerId:"",urgentOnly:!1,needsCharge:!1,pendingProof:!1}),[re,G]=P.useState(null),[J,V]=P.useState([]);P.useEffect(()=>{re!=null&&re.id?F(re.id).then(V):V([])},[re==null?void 0:re.id,F]);const W=P.useMemo(()=>c.find(ue=>ue.id===U),[c,U]),ee=P.useMemo(()=>h(Y),[h,Y]),ie=P.useMemo(()=>({aguardando:ee.filter(ue=>ue.status==="aguardando_pagamento"||ue.status==="aberto"),pago:ee.filter(ue=>ue.status==="pago"&&!["etiqueta_gerada","postado","entregue","retirado"].includes(ue.operational_status||"")),etiqueta:ee.filter(ue=>ue.operational_status==="etiqueta_gerada"),enviado:ee.filter(ue=>["postado","entregue","retirado","em_rota"].includes(ue.operational_status||""))}),[ee]),oe=ue=>{const ne={search:"",status:"all",deliveryMethod:"all",sellerId:"",urgentOnly:!1,needsCharge:!1,pendingProof:!1};ue==="needs_charge"?ne.needsCharge=!0:ue==="pending_proof"?ne.pendingProof=!0:ue==="urgent"?ne.urgentOnly=!0:ue==="none"?ne.sellerId="none":ue==="retirada"||ue==="motoboy"||ue==="correios"?(ne.deliveryMethod=ue,ne.status="pago"):ue!=="all"&&(ne.status=ue),Z(ne)};P.useMemo(()=>{if(re){const ue=c.find(ne=>ne.id===re.id);ue&&G(ue)}},[c,re==null?void 0:re.id]);const se=async(ue,ne,pe)=>U?v(U,ue,ne,pe):!1;if(o||u)return n.jsx("div",{className:"min-h-screen bg-background p-4 md:p-6",children:n.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[n.jsx(Kr,{className:"h-10 w-64"}),n.jsx("div",{className:"grid grid-cols-4 gap-4",children:[...Array(8)].map((ue,ne)=>n.jsx(Kr,{className:"h-20"},ne))}),n.jsx(Kr,{className:"h-96"})]})});if(!i)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ut,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Live no encontrada"}),n.jsxs(he,{variant:"outline",onClick:()=>t("/dashboard"),children:[n.jsx(vs,{className:"h-4 w-4 mr-2"}),"Voltar ao Dashboard"]})]})});const le={planejada:{label:"Planejada",color:"bg-blue-100 text-blue-700"},ao_vivo:{label:"Ao Vivo",color:"bg-red-100 text-red-700"},encerrada:{label:"Encerrada",color:"bg-muted text-muted-foreground"}},ye=le[i.status]||le.encerrada;return n.jsxs("div",{className:"min-h-screen bg-background overflow-x-hidden",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-3",children:[n.jsxs("div",{className:"flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>t("/dashboard"),className:"shrink-0",children:n.jsx(vs,{className:"h-5 w-5"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("h1",{className:"text-base sm:text-lg font-semibold truncate",children:i.titulo}),n.jsx(Ae,{className:`${ye.color} shrink-0 text-xs`,children:ye.label})]}),n.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-muted-foreground",children:[n.jsx(is,{className:"h-3 w-3"}),n.jsx("span",{className:"truncate",children:Ht(new Date(i.data_hora_inicio),"dd 'de' MMMM",{locale:gr})})]})]})]}),n.jsx("div",{className:"flex items-center gap-1 sm:gap-2 shrink-0",children:n.jsx(he,{variant:"outline",size:"icon",onClick:E,className:"h-9 w-9",children:n.jsx(en,{className:"h-4 w-4"})})})]}),n.jsxs("div",{className:"flex items-center gap-2 mt-3 flex-wrap",children:[f.length>0&&n.jsxs(he,{variant:"default",size:"sm",onClick:()=>I(!0),className:"bg-rose-600 hover:bg-rose-700 h-9",children:[n.jsx(zu,{className:"h-4 w-4 mr-1 sm:mr-2"}),n.jsx("span",{className:"hidden sm:inline",children:"Cobrar"})," (",f.length,")"]}),n.jsx(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${e}/pendencias`),className:"h-9",children:"Pendncias"}),n.jsx(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${e}/relatorio`),className:"h-9",children:"Relatrio"}),n.jsx(he,{variant:"outline",size:"sm",onClick:()=>t(`/dashboard/lives/${e}/separacao`),className:"h-9",children:"Separao"})]})]})}),n.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:n.jsx(gJe,{kpis:l,activeFilter:Y.status,onFilterClick:oe})}),n.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 pb-4",children:n.jsxs("div",{className:"flex flex-col gap-3 bg-muted/30 rounded-lg p-3 border",children:[n.jsxs("div",{className:"relative w-full",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar @instagram, nome, sacola...",className:"pl-9 bg-background w-full",value:Y.search,onChange:ue=>Z(ne=>({...ne,search:ue.target.value}))})]}),n.jsxs("div",{className:"grid grid-cols-2 sm:flex sm:flex-wrap gap-2",children:[n.jsxs(Kt,{value:Y.status,onValueChange:ue=>Z(ne=>({...ne,status:ue,needsCharge:!1,pendingProof:!1,urgentOnly:!1})),children:[n.jsx(Vt,{className:"w-full sm:w-[160px] bg-background h-10",children:n.jsx(Xt,{placeholder:"Status"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos os status"}),n.jsx(ze,{value:"aguardando_pagamento",children:"Aguardando Pgto"}),n.jsx(ze,{value:"aguardando_retorno",children:"Aguardando Retorno"}),n.jsx(ze,{value:"pago",children:"Pago"}),n.jsx(ze,{value:"preparar_envio",children:"Preparar Envio"}),n.jsx(ze,{value:"etiqueta_gerada",children:"Etiqueta Gerada"}),n.jsx(ze,{value:"postado",children:"Postado"}),n.jsx(ze,{value:"em_rota",children:"Em Rota"}),n.jsx(ze,{value:"entregue",children:"Entregue"})]})]}),n.jsxs(Kt,{value:Y.deliveryMethod,onValueChange:ue=>Z(ne=>({...ne,deliveryMethod:ue})),children:[n.jsx(Vt,{className:"w-full sm:w-[130px] bg-background h-10",children:n.jsx(Xt,{placeholder:"Entrega"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todas"}),n.jsx(ze,{value:"correios",children:"Correios"}),n.jsx(ze,{value:"motoboy",children:"Motoboy"}),n.jsx(ze,{value:"retirada",children:"Retirada"})]})]}),n.jsxs(Kt,{value:Y.sellerId||"all_sellers",onValueChange:ue=>Z(ne=>({...ne,sellerId:ue==="all_sellers"?"":ue})),children:[n.jsx(Vt,{className:"w-full sm:w-[150px] bg-background h-10 col-span-2 sm:col-span-1",children:n.jsx(Xt,{placeholder:"Responsvel"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all_sellers",children:"Todas"}),n.jsx(ze,{value:"none",children:"Sem responsvel"}),d.map(ue=>n.jsx(ze,{value:ue.id,children:ue.name},ue.id))]})]}),n.jsxs("div",{className:"hidden sm:flex gap-1 border rounded-md p-1 ml-auto bg-background",children:[n.jsx(he,{variant:N==="list"?"default":"ghost",size:"sm",onClick:()=>C("list"),className:"h-8",children:n.jsx(mae,{className:"h-4 w-4"})}),n.jsx(he,{variant:N==="kanban"?"default":"ghost",size:"sm",onClick:()=>C("kanban"),className:"h-8",children:n.jsx(fae,{className:"h-4 w-4"})})]})]}),(Y.urgentOnly||Y.needsCharge||Y.pendingProof)&&n.jsxs("div",{className:"flex gap-1 flex-wrap",children:[Y.urgentOnly&&n.jsxs(Ae,{variant:"outline",className:"cursor-pointer border-amber-300 text-amber-700 bg-amber-50",onClick:()=>Z(ue=>({...ue,urgentOnly:!1})),children:[n.jsx(Mr,{className:"h-3 w-3 mr-1"}),"Urgentes "]}),Y.needsCharge&&n.jsxs(Ae,{variant:"outline",className:"cursor-pointer border-rose-300 text-rose-700 bg-rose-50",onClick:()=>Z(ue=>({...ue,needsCharge:!1})),children:[n.jsx(nn,{className:"h-3 w-3 mr-1"}),"Cobrar "]}),Y.pendingProof&&n.jsx(Ae,{variant:"outline",className:"cursor-pointer border-purple-300 text-purple-700 bg-purple-50",onClick:()=>Z(ue=>({...ue,pendingProof:!1})),children:"Validar Pgto "})]})]})}),n.jsx("main",{className:"max-w-7xl mx-auto px-4 pb-8",children:N==="list"?n.jsx("div",{className:"space-y-3",children:ee.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(Ut,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhum pedido encontrado"})]}):ee.map(ue=>n.jsx(LB,{order:ue,sellers:d,urgency:m(ue),onSelect:()=>G(ue),onAssignSeller:p,onMarkAsPaid:g,onMarkAsPosted:b,onMarkAsDelivered:j,onMarkAsPickedUp:T,onAdvanceStatus:O,onRecordCharge:M,onOpenManualPayment:ne=>$(ne)},ue.id))}):n.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0 pb-4",children:n.jsx("div",{className:"flex sm:grid sm:grid-cols-4 gap-3 sm:gap-4 min-w-max sm:min-w-0",children:[{key:"aguardando",label:"Aguardando",data:ie.aguardando,color:"amber"},{key:"pago",label:"Pago",data:ie.pago,color:"emerald"},{key:"etiqueta",label:"Etiqueta",data:ie.etiqueta,color:"blue"},{key:"enviado",label:"Enviado",data:ie.enviado,color:"violet"}].map(ue=>n.jsxs("div",{className:"w-72 sm:w-auto shrink-0 sm:shrink space-y-2 sm:space-y-3",children:[n.jsxs("div",{className:"flex items-center gap-2 px-2 sm:px-3 py-1.5 sm:py-2 bg-muted/50 rounded-lg border sticky top-0",children:[n.jsx("span",{className:"font-medium text-xs sm:text-sm",children:ue.label}),n.jsx(Ae,{variant:"secondary",className:"ml-auto text-xs",children:ue.data.length})]}),ue.data.map(ne=>n.jsx(LB,{order:ne,sellers:d,urgency:m(ne),compact:!0,onSelect:()=>G(ne),onAssignSeller:p,onMarkAsPaid:g,onMarkAsPosted:b,onMarkAsDelivered:j,onMarkAsPickedUp:T,onAdvanceStatus:O,onRecordCharge:M,onOpenManualPayment:pe=>$(pe)},ne.id)),ue.data.length===0&&n.jsx("div",{className:"text-center py-6 text-muted-foreground text-xs sm:text-sm",children:"Nenhum pedido"})]},ue.key))})})}),n.jsx(CJe,{order:re,sellers:d,isAdmin:a,onClose:()=>G(null),onAssignSeller:p,onMarkAsPaid:g,onMarkAsPaidWithProof:v,onMarkAsPosted:b,onMarkAsDelivered:j,onMarkAsPickedUp:T,onGenerateLabel:D,onUpdateDeliveryMethod:L,onUpdateDeliveryWithShipping:q,onUpdateCustomerZipCode:X,onRecordCharge:M,onApprovePayment:x,onRejectPayment:y,onRevertStatus:(ue,ne,pe)=>R(ue,ne,pe,a),onTrackingSynced:S,chargeHistory:J}),n.jsx(kJe,{open:k,onClose:()=>I(!1),orders:f,onRecordCharge:M}),W&&n.jsx(dte,{open:!!U,onClose:()=>$(null),orderId:U,orderTotal:W.total,onConfirm:se})]})}function TJe(){const e=fr();ra();const[t,r]=P.useState(!0);return P.useEffect(()=>{(async()=>{const{data:{session:a}}=await ce.auth.getSession();if(!a){e("/login");return}const{data:i}=await ce.from("user_roles").select("role").eq("user_id",a.user.id);if(!(i==null?void 0:i.some(c=>["merchant","admin"].includes(c.role)))){e("/");return}r(!1)})()},[e]),t?null:n.jsx(AJe,{})}function PJe({liveEventId:e}){O8(),h8();const{pendencias:t,isLoading:r,filters:s,setFilters:a,updateStatus:i,assignTo:o,countOpen:c,countInProgress:d}=XY(e),l=p=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(p),u=p=>{switch(p){case"aberta":return n.jsxs(Ae,{variant:"outline",className:"border-amber-300 bg-amber-50 text-amber-700",children:[n.jsx(Br,{className:"h-3 w-3 mr-1"}),"Aberta"]});case"em_andamento":return n.jsxs(Ae,{variant:"outline",className:"border-blue-300 bg-blue-50 text-blue-700",children:[n.jsx(Cn,{className:"h-3 w-3 mr-1"}),"Em Andamento"]});case"resolvida":return n.jsxs(Ae,{variant:"outline",className:"border-green-300 bg-green-50 text-green-700",children:[n.jsx(Er,{className:"h-3 w-3 mr-1"}),"Resolvida"]})}},h=p=>{switch(p){case"alta":return n.jsx(Ae,{variant:"destructive",className:"text-xs",children:"Alta"});case"media":return n.jsx(Ae,{variant:"secondary",className:"text-xs",children:"Mdia"});case"baixa":return n.jsx(Ae,{variant:"outline",className:"text-xs",children:"Baixa"})}},f=p=>({observacao_cliente:"Observao",ajuste_tamanho:"Ajuste Tamanho",troca:"Troca",enviar_opcoes:"Enviar Opes",outros:"Outros"})[p],m=()=>{const p=["Data","Sacola","Cliente","Tipo","Ttulo","Descrio","Status","Prioridade"],g=t.map(b=>{var j,T,O;return[Ht(new Date(b.created_at),"dd/MM/yyyy HH:mm"),((j=b.live_cart)==null?void 0:j.bag_number)||"-",((O=(T=b.live_cart)==null?void 0:T.live_customer)==null?void 0:O.instagram_handle)||"-",f(b.type),b.title,b.description||"",b.status,b.priority]}),v=[p,...g].map(b=>b.join(",")).join(`
`),x=new Blob([v],{type:"text/csv;charset=utf-8;"}),y=document.createElement("a");y.href=URL.createObjectURL(x),y.download=`pendencias_${Ht(new Date,"yyyy-MM-dd")}.csv`,y.click()};return r?n.jsxs("div",{className:"space-y-4 p-4",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[n.jsx(Kr,{className:"h-20"}),n.jsx(Kr,{className:"h-20"}),n.jsx(Kr,{className:"h-20 hidden md:block"})]}),n.jsx(Kr,{className:"h-12"}),n.jsx("div",{className:"space-y-3",children:[...Array(5)].map((p,g)=>n.jsx(Kr,{className:"h-24"},g))})]}):n.jsxs("div",{className:"space-y-4 p-4 md:p-6 overflow-x-hidden",children:[n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[n.jsx(De,{className:`cursor-pointer transition-colors ${s.status==="aberta"?"ring-2 ring-primary":""}`,onClick:()=>a(p=>({...p,status:p.status==="aberta"?"all":"aberta"})),children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-amber-100 rounded-lg shrink-0",children:n.jsx(Br,{className:"h-5 w-5 text-amber-600"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-2xl font-bold",children:c}),n.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Abertas"})]})]})})}),n.jsx(De,{className:`cursor-pointer transition-colors ${s.status==="em_andamento"?"ring-2 ring-primary":""}`,onClick:()=>a(p=>({...p,status:p.status==="em_andamento"?"all":"em_andamento"})),children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-blue-100 rounded-lg shrink-0",children:n.jsx(Cn,{className:"h-5 w-5 text-blue-600"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-2xl font-bold",children:d}),n.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Em Andamento"})]})]})})}),n.jsx(De,{className:"hidden md:block",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"p-2 bg-green-100 rounded-lg shrink-0",children:n.jsx(Er,{className:"h-5 w-5 text-green-600"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"text-2xl font-bold",children:t.filter(p=>p.status==="resolvida").length}),n.jsx("p",{className:"text-xs text-muted-foreground truncate",children:"Resolvidas"})]})]})})})]}),n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"relative",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar @instagram, sacola, ttulo...",className:"pl-9",value:s.search,onChange:p=>a(g=>({...g,search:p.target.value}))})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(Kt,{value:s.status,onValueChange:p=>a(g=>({...g,status:p})),children:[n.jsx(Vt,{className:"w-full sm:w-[140px]",children:n.jsx(Xt,{placeholder:"Status"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos"}),n.jsx(ze,{value:"aberta",children:"Abertas"}),n.jsx(ze,{value:"em_andamento",children:"Em Andamento"}),n.jsx(ze,{value:"resolvida",children:"Resolvidas"})]})]}),n.jsxs(Kt,{value:s.priority,onValueChange:p=>a(g=>({...g,priority:p})),children:[n.jsx(Vt,{className:"w-full sm:w-[140px]",children:n.jsx(Xt,{placeholder:"Prioridade"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todas"}),n.jsx(ze,{value:"alta",children:"Alta"}),n.jsx(ze,{value:"media",children:"Mdia"}),n.jsx(ze,{value:"baixa",children:"Baixa"})]})]}),n.jsxs(Kt,{value:s.type,onValueChange:p=>a(g=>({...g,type:p})),children:[n.jsx(Vt,{className:"w-full sm:w-[150px]",children:n.jsx(Xt,{placeholder:"Tipo"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos"}),n.jsx(ze,{value:"observacao_cliente",children:"Observao"}),n.jsx(ze,{value:"ajuste_tamanho",children:"Ajuste Tam."}),n.jsx(ze,{value:"troca",children:"Troca"}),n.jsx(ze,{value:"enviar_opcoes",children:"Enviar Opes"}),n.jsx(ze,{value:"outros",children:"Outros"})]})]}),n.jsx(he,{variant:"outline",size:"icon",onClick:m,className:"shrink-0 ml-auto",children:n.jsx(Af,{className:"h-4 w-4"})})]})]}),n.jsx("div",{className:"space-y-3",children:t.length===0?n.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[n.jsx(N_,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),n.jsx("p",{children:"Nenhuma pendncia encontrada"})]}):t.map(p=>{var g,v,x,y;return n.jsx(De,{className:"overflow-hidden",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex flex-col gap-3",children:[n.jsxs("div",{className:"flex items-start justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[((g=p.live_cart)==null?void 0:g.bag_number)&&n.jsxs(Ae,{variant:"secondary",className:"shrink-0",children:["#",String(p.live_cart.bag_number).padStart(3,"0")]}),n.jsxs("span",{className:"font-medium truncate",children:["@",((x=(v=p.live_cart)==null?void 0:v.live_customer)==null?void 0:x.instagram_handle)||"Desconhecido"]})]}),n.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[h(p.priority),n.jsxs(L1,{children:[n.jsx(B1,{asChild:!0,children:n.jsx(he,{variant:"ghost",size:"icon",className:"h-8 w-8",children:n.jsx(dae,{className:"h-4 w-4"})})}),n.jsxs(Ig,{align:"end",className:"w-48",children:[n.jsxs(po,{onClick:()=>i(p.id,"aberta"),children:[n.jsx(Br,{className:"h-4 w-4 mr-2"}),"Marcar como Aberta"]}),n.jsxs(po,{onClick:()=>i(p.id,"em_andamento"),children:[n.jsx(Cn,{className:"h-4 w-4 mr-2"}),"Em Andamento"]}),n.jsxs(po,{onClick:()=>i(p.id,"resolvida"),children:[n.jsx(Er,{className:"h-4 w-4 mr-2"}),"Marcar como Resolvida"]}),n.jsx(YK,{}),n.jsxs(po,{children:[n.jsx(Wn,{className:"h-4 w-4 mr-2"}),"Atribuir Responsvel"]}),n.jsxs(po,{children:[n.jsx(is,{className:"h-4 w-4 mr-2"}),"Definir Prazo"]})]})]})]})]}),n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[u(p.status),n.jsx(Ae,{variant:"outline",className:"text-xs",children:f(p.type)})]}),n.jsx("p",{className:"font-medium text-sm line-clamp-1",children:p.title}),p.description&&n.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:p.description})]}),n.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground pt-2 border-t",children:[n.jsx("span",{children:Ht(new Date(p.created_at),"dd/MM 's' HH:mm",{locale:gr})}),((y=p.live_cart)==null?void 0:y.total)&&n.jsx("span",{className:"font-medium",children:l(p.live_cart.total)})]})]})})},p.id)})})]})}function OJe(){const e=fr(),{eventId:t}=ra(),{event:r,isLoading:s}=nj(t);if(s)return n.jsx("div",{className:"min-h-screen bg-background p-4",children:n.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[n.jsx(Kr,{className:"h-10 w-64"}),n.jsx(Kr,{className:"h-96"})]})});if(!r)return n.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx(Ut,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),n.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Live no encontrada"}),n.jsxs(he,{variant:"outline",onClick:()=>e("/dashboard"),children:[n.jsx(vs,{className:"h-4 w-4 mr-2"}),"Voltar ao Dashboard"]})]})});const a={planejada:{label:"Planejada",color:"bg-blue-100 text-blue-700"},ao_vivo:{label:"Ao Vivo",color:"bg-red-100 text-red-700"},encerrada:{label:"Encerrada",color:"bg-muted text-muted-foreground"}},i=a[r.status]||a.encerrada;return n.jsxs("div",{className:"min-h-screen bg-background overflow-x-hidden",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b",children:n.jsx("div",{className:"max-w-4xl mx-auto px-4 py-3 flex items-center justify-between",children:n.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>e(`/dashboard/lives/${t}/pedidos`),className:"shrink-0",children:n.jsx(vs,{className:"h-5 w-5"})}),n.jsxs("div",{className:"min-w-0",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[n.jsx("h1",{className:"text-lg font-semibold truncate",children:r.titulo}),n.jsx(Ae,{className:i.color,children:i.label})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx(mw,{className:"h-3.5 w-3.5"}),n.jsx("span",{children:"Pendncias"})]})]})]})})}),n.jsx("main",{className:"max-w-4xl mx-auto",children:n.jsx(PJe,{liveEventId:t})})]})}const lm=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"],$0=["cancelado"];function RJe(e){const[t,r]=P.useState(null),[s,a]=P.useState([]),[i,o]=P.useState([]),[c,d]=P.useState([]),[l,u]=P.useState([]),[h,f]=P.useState([]),[m,p]=P.useState(!0),{startDate:g,endDate:v,prevStartDate:x,prevEndDate:y}=P.useMemo(()=>{var L,q;const j=new Date;let T,O,R,D;switch(e.period){case"today":T=Vn(j),O=rs(j),R=Vn(mn(j,1)),D=rs(mn(j,1));break;case"7d":T=Vn(mn(j,6)),O=rs(j),R=Vn(mn(j,13)),D=rs(mn(j,7));break;case"30d":T=Vn(mn(j,29)),O=rs(j),R=Vn(mn(j,59)),D=rs(mn(j,30));break;case"thisMonth":T=Ps(j),O=rs(j),R=Ps(uo(j,1)),D=fc(uo(j,1));break;case"custom":T=((L=e.customDateRange)==null?void 0:L.from)||Vn(j),O=((q=e.customDateRange)==null?void 0:q.to)||rs(j);const X=Math.ceil((O.getTime()-T.getTime())/(1e3*60*60*24));R=mn(T,X),D=mn(O,X);break;default:T=Vn(mn(j,6)),O=rs(j),R=Vn(mn(j,13)),D=rs(mn(j,7))}return{startDate:T,endDate:O,prevStartDate:R,prevEndDate:D}},[e.period,e.customDateRange]),b=P.useCallback(async()=>{p(!0);try{const j=await ce.from("sellers").select("id, name").eq("is_active",!0);f(j.data||[]);let T=ce.from("orders").select("*, order_items(*)").gte("created_at",g.toISOString()).lte("created_at",v.toISOString());e.source==="catalog"?T=T.is("live_event_id",null):e.source==="live"&&(T=T.not("live_event_id","is",null)),e.sellerId&&(T=T.eq("seller_id",e.sellerId));let O=ce.from("orders").select("*, order_items(*)").gte("created_at",x.toISOString()).lte("created_at",y.toISOString());e.source==="catalog"?O=O.is("live_event_id",null):e.source==="live"&&(O=O.not("live_event_id","is",null));const R=ce.from("product_available_stock").select("product_id, size, available"),[D,L,q]=await Promise.all([T,O,R]),X=D.data||[],H=L.data||[],M=q.data||[],F=new Map,S=new Map;M.forEach(be=>{be.product_id&&F.set(be.product_id,(F.get(be.product_id)||0)+(be.available||0)),be.size&&S.set(be.size,(S.get(be.size)||0)+(be.available||0))});const E=be=>e.status==="all"?be:e.status==="pago"?be.filter(Me=>lm.includes(Me.status)):e.status==="reservado"?be.filter(Me=>Me.status==="aguardando_pagamento"):e.status==="cancelado"?be.filter(Me=>$0.includes(Me.status)):be,N=E(X),C=E(H),k=X.filter(be=>lm.includes(be.status)),I=H.filter(be=>lm.includes(be.status)),U=X.filter(be=>$0.includes(be.status)),$=X.filter(be=>be.status==="aguardando_pagamento"),Y=X.filter(be=>be.live_event_id),Z=X.filter(be=>!be.live_event_id),re=Y.filter(be=>lm.includes(be.status)),G=Z.filter(be=>lm.includes(be.status)),J=Y.filter(be=>!$0.includes(be.status)),V=Z.filter(be=>!$0.includes(be.status)),W=k.reduce((be,Me)=>be+(Me.total||0),0),ee=I.reduce((be,Me)=>be+(Me.total||0),0),ie=k.reduce((be,Me)=>{const Se=Me.order_items||[];return be+Se.reduce(($e,Ke)=>$e+(Ke.quantity||0),0)},0),oe=I.reduce((be,Me)=>{const Se=Me.order_items||[];return be+Se.reduce(($e,Ke)=>$e+(Ke.quantity||0),0)},0);r({receita:W,receitaPrev:ee,itensSold:ie,itensSoldPrev:oe,ticketMedio:k.length>0?W/k.length:0,ticketMedioPrev:I.length>0?ee/I.length:0,conversaoLive:J.length>0?re.length/J.length*100:0,conversaoCatalog:V.length>0?G.length/V.length*100:0,percentLive:k.length>0?re.length/k.length*100:0,percentCatalog:k.length>0?G.length/k.length*100:0,cancelamentoRate:X.length>0?U.length/X.length*100:0,ordersCount:k.length});const se=new Map;k.forEach(be=>{const Me=!!be.live_event_id;(be.order_items||[]).forEach($e=>{const Ke=$e.product_name||"Unknown",Ze=se.get(Ke)||{productId:null,productName:$e.product_name||"Unknown",productSku:$e.product_sku,imageUrl:$e.image_url,qtySold:0,revenue:0,liveQty:0,catalogQty:0,reservedQty:0,reservedValue:0,canceledQty:0,lastSaleAt:null};Ze.qtySold+=$e.quantity||0,Ze.revenue+=($e.product_price||0)*($e.quantity||0),Me?Ze.liveQty+=$e.quantity||0:Ze.catalogQty+=$e.quantity||0,(!Ze.lastSaleAt||be.paid_at&&be.paid_at>Ze.lastSaleAt)&&(Ze.lastSaleAt=be.paid_at||be.created_at),se.set(Ke,Ze)})}),$.forEach(be=>{(be.order_items||[]).forEach(Se=>{const $e=Se.product_name||"Unknown",Ke=se.get($e)||{productId:null,productName:Se.product_name||"Unknown",productSku:Se.product_sku,imageUrl:Se.image_url,qtySold:0,revenue:0,liveQty:0,catalogQty:0,reservedQty:0,reservedValue:0,canceledQty:0,lastSaleAt:null};Ke.reservedQty+=Se.quantity||0,Ke.reservedValue+=(Se.product_price||0)*(Se.quantity||0),se.set($e,Ke)})}),U.forEach(be=>{(be.order_items||[]).forEach(Se=>{const $e=Se.product_name||"Unknown",Ke=se.get($e);Ke&&(Ke.canceledQty+=Se.quantity||0)})});const le=Array.from(se.values()).map(be=>{const Me=be.qtySold+be.reservedQty+be.canceledQty,Se=Me>0?be.qtySold/Me*100:0,$e=Me>0?be.canceledQty/Me*100:0,Ke=be.qtySold>0?be.liveQty/be.qtySold*100:0,Ze=be.qtySold>0?be.revenue/be.qtySold:0;let it="ok";const Re=0;return Se<30&&be.reservedQty>3&&(it="warning"),$e>30&&(it="warning"),($e>50||Se<20&&be.reservedQty>5)&&(it="critical"),{productId:be.productId,productName:be.productName,productSku:be.productSku,imageUrl:be.imageUrl,qtySold:be.qtySold,revenue:be.revenue,avgPrice:Ze,percentLive:Ke,reservedQty:be.reservedQty,reservedValue:be.reservedValue,conversaoRate:Se,canceledQty:be.canceledQty,cancelamentoRate:$e,stockAvailable:Re,lastSaleAt:be.lastSaleAt,riskLevel:it}}),ye=e.search.toLowerCase(),ue=ye?le.filter(be=>be.productName.toLowerCase().includes(ye)||be.productSku&&be.productSku.toLowerCase().includes(ye)):le;ue.sort((be,Me)=>Me.revenue-be.revenue),a(ue);const ne=new Map;k.forEach(be=>{(be.order_items||[]).forEach(Se=>{const $e=Se.size||"N/A",Ke=ne.get($e)||{size:$e,qtySold:0,revenue:0,reservedQty:0,canceledQty:0,stockAvailable:S.get($e)||0};Ke.qtySold+=Se.quantity||0,Ke.revenue+=(Se.product_price||0)*(Se.quantity||0),ne.set($e,Ke)})}),$.forEach(be=>{(be.order_items||[]).forEach(Se=>{const $e=Se.size||"N/A",Ke=ne.get($e);Ke&&(Ke.reservedQty+=Se.quantity||0)})}),U.forEach(be=>{(be.order_items||[]).forEach(Se=>{const $e=Se.size||"N/A",Ke=ne.get($e);Ke&&(Ke.canceledQty+=Se.quantity||0)})}),o(Array.from(ne.values()).sort((be,Me)=>Me.revenue-be.revenue));const pe=new Map,ge=new Map;(j.data||[]).forEach(be=>ge.set(be.id,be.name)),X.forEach(be=>{if(!be.seller_id)return;const Me=be.seller_id,Se=ge.get(Me)||"Desconhecido",$e=pe.get(Me)||{id:Me,name:Se,revenue:0,qtySold:0,ordersCount:0,paidCount:0,canceledCount:0,productCounts:new Map};$e.ordersCount+=1,lm.includes(be.status)&&($e.paidCount+=1,$e.revenue+=be.total||0,(be.order_items||[]).forEach(Ze=>{$e.qtySold+=Ze.quantity||0;const it=Ze.product_name||"Unknown";$e.productCounts.set(it,($e.productCounts.get(it)||0)+(Ze.quantity||0))})),$0.includes(be.status)&&($e.canceledCount+=1),pe.set(Me,$e)});const Ne=Array.from(pe.values()).map(be=>{const Me=Array.from(be.productCounts.entries()).sort((Se,$e)=>$e[1]-Se[1]).slice(0,3).map(([Se,$e])=>({name:Se,qty:$e}));return{id:be.id,name:be.name,revenue:be.revenue,qtySold:be.qtySold,ordersCount:be.ordersCount,conversaoRate:be.ordersCount>0?be.paidCount/be.ordersCount*100:0,cancelamentoRate:be.ordersCount>0?be.canceledCount/be.ordersCount*100:0,topProducts:Me}});Ne.sort((be,Me)=>Me.revenue-be.revenue),d(Ne);const _e=[];le.forEach((be,Me)=>{be.reservedQty>3&&be.conversaoRate<30&&_e.push({id:`conv-${Me}`,type:"baixa_conversao",severity:be.conversaoRate<20?"error":"warning",productName:be.productName,productId:be.productId,message:`Converso de ${be.conversaoRate.toFixed(0)}% com ${be.reservedQty} reservados`,value:be.reservedValue}),be.cancelamentoRate>30&&_e.push({id:`cancel-${Me}`,type:"alto_cancelamento",severity:be.cancelamentoRate>50?"error":"warning",productName:be.productName,productId:be.productId,message:`${be.cancelamentoRate.toFixed(0)}% de cancelamento (${be.canceledQty} cancelados)`,value:be.canceledQty})}),u(_e)}catch(j){console.error("Error fetching insights data:",j)}finally{p(!1)}},[g,v,x,y,e.source,e.sellerId,e.status,e.search]);return P.useEffect(()=>{b()},[b]),{kpis:t,productRanking:s,sizeRanking:i,sellerRanking:c,alerts:l,sellers:h,isLoading:m,refetch:b,dateRange:{startDate:g,endDate:v}}}function MJe({data:e,sortBy:t,isLoading:r,onProductClick:s}){const a=c=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(c),i=c=>`${c.toFixed(1)}%`,o=[...e].sort((c,d)=>t==="revenue"?d.revenue-c.revenue:d.qtySold-c.qtySold);return r?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):e.length===0?n.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Nenhum produto encontrado no perodo"}):n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsx("div",{className:"overflow-x-auto",children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{className:"bg-muted/50",children:[n.jsx(jt,{className:"w-12",children:"#"}),n.jsx(jt,{children:"Produto"}),n.jsx(jt,{className:"text-right",children:"Qtd"}),n.jsx(jt,{className:"text-right",children:"Receita"}),n.jsx(jt,{className:"text-right",children:"Preo Mdio"}),n.jsx(jt,{className:"text-right",children:"% Live"}),n.jsx(jt,{className:"text-right",children:"Reservados"}),n.jsx(jt,{className:"text-right",children:"Converso"}),n.jsx(jt,{className:"text-right",children:"Cancelados"}),n.jsx(jt,{className:"text-center",children:"Risco"})]})}),n.jsx(Na,{children:o.map((c,d)=>n.jsxs(Qr,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>s(c.productName),children:[n.jsx(yt,{className:"font-mono text-muted-foreground",children:d+1}),n.jsx(yt,{children:n.jsxs("div",{className:"min-w-0",children:[n.jsx("p",{className:"font-medium truncate max-w-[200px]",children:c.productName}),c.productSku&&n.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:c.productSku})]})}),n.jsx(yt,{className:"text-right font-medium",children:c.qtySold}),n.jsx(yt,{className:"text-right font-medium text-green-600",children:a(c.revenue)}),n.jsx(yt,{className:"text-right",children:a(c.avgPrice)}),n.jsx(yt,{className:"text-right",children:c.percentLive>0?n.jsx(Ae,{variant:"outline",className:"border-pink-200 text-pink-700 text-xs",children:i(c.percentLive)}):n.jsx("span",{className:"text-muted-foreground",children:""})}),n.jsx(yt,{className:"text-right",children:c.reservedQty>0?n.jsxs("div",{children:[n.jsx("span",{className:"font-medium text-amber-600",children:c.reservedQty}),n.jsx("p",{className:"text-[10px] text-muted-foreground",children:a(c.reservedValue)})]}):n.jsx("span",{className:"text-muted-foreground",children:""})}),n.jsx(yt,{className:"text-right",children:n.jsx("span",{className:c.conversaoRate>=70?"text-green-600":c.conversaoRate>=40?"text-amber-600":"text-red-600",children:i(c.conversaoRate)})}),n.jsx(yt,{className:"text-right",children:c.canceledQty>0?n.jsxs("div",{children:[n.jsx("span",{className:"text-red-600",children:c.canceledQty}),n.jsx("p",{className:"text-[10px] text-muted-foreground",children:i(c.cancelamentoRate)})]}):n.jsx("span",{className:"text-muted-foreground",children:""})}),n.jsx(yt,{className:"text-center",children:n.jsx(Ae,{className:c.riskLevel==="critical"?"bg-red-100 text-red-700 border-0":c.riskLevel==="warning"?"bg-amber-100 text-amber-700 border-0":"bg-green-100 text-green-700 border-0",children:c.riskLevel==="critical"?"Crtico":c.riskLevel==="warning"?"Ateno":"OK"})})]},d))})]})})})}function IJe({data:e,isLoading:t}){const r=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(a);if(t)return n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(e.length===0)return n.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Nenhum dado de tamanho encontrado"});const s=e.reduce((a,i)=>a+i.qtySold,0);return e.reduce((a,i)=>a+i.revenue,0),n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{className:"bg-muted/50",children:[n.jsx(jt,{children:"Tamanho"}),n.jsx(jt,{className:"text-right",children:"Qtd Vendida"}),n.jsx(jt,{className:"text-right",children:"% do Total"}),n.jsx(jt,{className:"text-right",children:"Receita"}),n.jsx(jt,{className:"text-right",children:"Reservados"}),n.jsx(jt,{className:"text-right",children:"Cancelados"}),n.jsx(jt,{className:"text-right",children:"Estoque"})]})}),n.jsx(Na,{children:e.map((a,i)=>{const o=s>0?a.qtySold/s*100:0;return n.jsxs(Qr,{children:[n.jsx(yt,{children:n.jsx(Ae,{variant:"outline",className:"font-mono text-sm",children:a.size})}),n.jsx(yt,{className:"text-right font-medium",children:a.qtySold}),n.jsx(yt,{className:"text-right",children:n.jsxs("div",{className:"flex items-center justify-end gap-2",children:[n.jsx("div",{className:"w-16 h-2 bg-muted rounded-full overflow-hidden",children:n.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${Math.min(o,100)}%`}})}),n.jsxs("span",{className:"text-xs text-muted-foreground w-10",children:[o.toFixed(1),"%"]})]})}),n.jsx(yt,{className:"text-right font-medium text-green-600",children:r(a.revenue)}),n.jsx(yt,{className:"text-right",children:a.reservedQty>0?n.jsx("span",{className:"text-amber-600 font-medium",children:a.reservedQty}):n.jsx("span",{className:"text-muted-foreground",children:""})}),n.jsx(yt,{className:"text-right",children:a.canceledQty>0?n.jsx("span",{className:"text-red-600",children:a.canceledQty}):n.jsx("span",{className:"text-muted-foreground",children:""})}),n.jsx(yt,{className:"text-right",children:a.stockAvailable>0?n.jsx(Ae,{className:a.stockAvailable<5?"bg-red-100 text-red-700 border-0":a.stockAvailable<15?"bg-amber-100 text-amber-700 border-0":"bg-green-100 text-green-700 border-0",children:a.stockAvailable}):n.jsx(Ae,{className:"bg-muted text-muted-foreground border-0",children:"0"})})]},i)})})]})})}function DJe({data:e,isLoading:t}){const r=c=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(c),s=c=>`${c.toFixed(1)}%`;if(t)return n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})});if(e.length===0)return n.jsx("div",{className:"text-center py-12 text-muted-foreground",children:"Nenhuma vendedora encontrada no perodo"});const a=e.reduce((c,d)=>d.revenue>c.revenue?d:c,e[0]),i=e.filter(c=>c.ordersCount>=3).reduce((c,d)=>d.conversaoRate>c.conversaoRate?d:c,e[0]),o=e.reduce((c,d)=>d.qtySold>c.qtySold?d:c,e[0]);return n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs(De,{className:"border-yellow-200 bg-yellow-50/50",children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-sm flex items-center gap-2",children:[n.jsx(ga,{className:"h-4 w-4 text-yellow-600"}),"Maior Faturamento"]})}),n.jsxs(Be,{children:[n.jsx("p",{className:"font-bold text-lg",children:a.name}),n.jsx("p",{className:"text-green-600 font-medium",children:r(a.revenue)})]})]}),n.jsxs(De,{className:"border-blue-200 bg-blue-50/50",children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-sm flex items-center gap-2",children:[n.jsx(_s,{className:"h-4 w-4 text-blue-600"}),"Maior Converso"]})}),n.jsxs(Be,{children:[n.jsx("p",{className:"font-bold text-lg",children:i.name}),n.jsx("p",{className:"text-blue-600 font-medium",children:s(i.conversaoRate)})]})]}),n.jsxs(De,{className:"border-purple-200 bg-purple-50/50",children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-sm flex items-center gap-2",children:[n.jsx(ki,{className:"h-4 w-4 text-purple-600"}),"Mais Peas"]})}),n.jsxs(Be,{children:[n.jsx("p",{className:"font-bold text-lg",children:o.name}),n.jsxs("p",{className:"text-purple-600 font-medium",children:[o.qtySold," peas"]})]})]})]}),n.jsx("div",{className:"border rounded-lg overflow-hidden",children:n.jsxs(_a,{children:[n.jsx(ja,{children:n.jsxs(Qr,{className:"bg-muted/50",children:[n.jsx(jt,{className:"w-12",children:"#"}),n.jsx(jt,{children:"Vendedora"}),n.jsx(jt,{className:"text-right",children:"Receita"}),n.jsx(jt,{className:"text-right",children:"Peas"}),n.jsx(jt,{className:"text-right",children:"Pedidos"}),n.jsx(jt,{className:"text-right",children:"Converso"}),n.jsx(jt,{className:"text-right",children:"Cancelamento"}),n.jsx(jt,{children:"Top 3 Produtos"})]})}),n.jsx(Na,{children:e.map((c,d)=>n.jsxs(Qr,{children:[n.jsx(yt,{className:"font-mono text-muted-foreground",children:d+1}),n.jsx(yt,{children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-medium",children:c.name}),c.id===a.id&&n.jsx(Ae,{className:"bg-yellow-100 text-yellow-700 border-0 text-[10px]",children:" Top"}),c.id===i.id&&c.id!==a.id&&n.jsx(Ae,{className:"bg-blue-100 text-blue-700 border-0 text-[10px]",children:" Converso"})]})}),n.jsx(yt,{className:"text-right font-medium text-green-600",children:r(c.revenue)}),n.jsx(yt,{className:"text-right",children:c.qtySold}),n.jsx(yt,{className:"text-right",children:c.ordersCount}),n.jsx(yt,{className:"text-right",children:n.jsx("span",{className:c.conversaoRate>=70?"text-green-600 font-medium":c.conversaoRate>=40?"text-amber-600":"text-red-600",children:s(c.conversaoRate)})}),n.jsx(yt,{className:"text-right",children:c.cancelamentoRate>0?n.jsx("span",{className:c.cancelamentoRate>20?"text-red-600":"text-muted-foreground",children:s(c.cancelamentoRate)}):n.jsx("span",{className:"text-green-600",children:"0%"})}),n.jsx(yt,{children:n.jsx("div",{className:"flex flex-wrap gap-1",children:c.topProducts.slice(0,3).map((l,u)=>n.jsxs(Ae,{variant:"outline",className:"text-[10px] truncate max-w-[100px]",children:[l.name," (",l.qty,")"]},u))})})]},c.id))})]})})]})}function LJe({alerts:e,onViewProduct:t}){const r=fr(),s=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(l),a=l=>{switch(l){case"baixa_conversao":return n.jsx(qx,{className:"h-5 w-5"});case"alto_cancelamento":return n.jsx(qn,{className:"h-5 w-5"});case"ruptura":return n.jsx(Mr,{className:"h-5 w-5"})}},i=(l,u)=>{if(u==="error")return"border-red-200 bg-red-50";switch(l){case"baixa_conversao":return"border-amber-200 bg-amber-50";case"alto_cancelamento":return"border-red-200 bg-red-50";case"ruptura":return"border-orange-200 bg-orange-50";default:return"border-muted"}},o=l=>{switch(l){case"baixa_conversao":return"text-amber-700";case"alto_cancelamento":return"text-red-700";case"ruptura":return"text-orange-700"}},c=l=>{switch(l){case"baixa_conversao":return"Baixa Converso";case"alto_cancelamento":return"Alto Cancelamento";case"ruptura":return"Risco de Ruptura"}},d=e.reduce((l,u)=>(l[u.type]||(l[u.type]=[]),l[u.type].push(u),l),{});return e.length===0?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:n.jsx(Mr,{className:"h-8 w-8 text-green-600"})}),n.jsx("h3",{className:"text-lg font-medium text-green-700",children:"Tudo OK!"}),n.jsx("p",{className:"text-muted-foreground mt-1",children:"Nenhum alerta operacional ativo no momento"})]}):n.jsxs("div",{className:"space-y-6",children:[n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(d).map(([l,u])=>n.jsx(De,{className:i(l,"warning"),children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("span",{className:o(l),children:a(l)}),n.jsx("span",{className:`font-medium ${o(l)}`,children:c(l)})]}),n.jsx("p",{className:"text-2xl font-bold",children:u.length}),n.jsx("p",{className:"text-sm text-muted-foreground",children:"produtos afetados"})]})},l))}),n.jsx("div",{className:"space-y-3",children:e.map(l=>n.jsx(De,{className:i(l.type,l.severity),children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-start justify-between gap-4",children:[n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("span",{className:o(l.type),children:a(l.type)}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"font-medium",children:l.productName}),n.jsx(Ae,{variant:"outline",className:`text-[10px] ${l.severity==="error"?"border-red-300 text-red-700":"border-amber-300 text-amber-700"}`,children:l.severity==="error"?"Crtico":"Ateno"})]}),n.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:l.message}),l.type==="baixa_conversao"&&n.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Valor em reserva: ",n.jsx("span",{className:"font-medium",children:s(l.value)})]})]})]}),n.jsxs("div",{className:"flex gap-2 shrink-0",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:()=>t(l.productName),className:"gap-1",children:[n.jsx(ci,{className:"h-4 w-4"}),"Detalhes"]}),l.type==="baixa_conversao"&&n.jsxs(he,{variant:"default",size:"sm",onClick:()=>r(`/dashboard?tab=orders&status=aguardando_pagamento&search=${encodeURIComponent(l.productName)}`),className:"gap-1",children:[n.jsx(ma,{className:"h-4 w-4"}),"Ver reservas"]})]})]})})},l.id))})]})}const BJe=["pago","preparar_envio","etiqueta_gerada","postado","em_rota","retirada","entregue"];function $Je({productName:e,isOpen:t,onClose:r,filters:s}){const a=fr(),[i,o]=P.useState(null),[c,d]=P.useState(!1);P.useEffect(()=>{e&&t&&u()},[e,t,s]);const l=()=>{const p=new Date;switch(s.period){case"today":return{start:Vn(p),end:rs(p)};case"7d":return{start:Vn(mn(p,6)),end:rs(p)};case"30d":return{start:Vn(mn(p,29)),end:rs(p)};case"thisMonth":return{start:Ps(p),end:rs(p)};default:return{start:Vn(mn(p,6)),end:rs(p)}}},u=async()=>{if(e){d(!0);try{const{start:p,end:g}=l(),{data:v}=await ce.from("orders").select("*, order_items(*)").gte("created_at",p.toISOString()).lte("created_at",g.toISOString()),{data:x}=await ce.from("sellers").select("id, name"),y=new Map;(x||[]).forEach(F=>y.set(F.id,F.name));const b=(v||[]).filter(F=>(F.order_items||[]).some(E=>E.product_name===e));let j=0,T=0,O=0,R=0,D=0,L=0;const q=new Map,X=new Map,H=new Map,M=new Map;b.forEach(F=>{const S=BJe.includes(F.status),E=F.status==="aguardando_pagamento",N=F.status==="cancelado",C=!!F.live_event_id,k=Ht(new Date(F.created_at),"yyyy-MM-dd");if((F.order_items||[]).forEach(U=>{if(U.product_name!==e)return;const $=U.quantity||0,Y=(U.product_price||0)*$,Z=U.size||"N/A",re=q.get(Z)||{sold:0,reserved:0,canceled:0};if(S&&(re.sold+=$),E&&(re.reserved+=$),N&&(re.canceled+=$),q.set(Z,re),S){if(j+=$,T+=Y,C?(O+=$,D+=Y):(R+=$,L+=Y),F.seller_id){const J=y.get(F.seller_id)||"Desconhecido",V=X.get(J)||{sold:0,revenue:0};V.sold+=$,V.revenue+=Y,X.set(J,V)}const G=M.get(k)||{sold:0,revenue:0};G.sold+=$,G.revenue+=Y,M.set(k,G)}}),S){const U="Mercado Pago",$=H.get(U)||{count:0,total:0};$.count+=1,$.total+=F.total||0,H.set(U,$)}}),o({totalSold:j,totalRevenue:T,liveSold:O,catalogSold:R,liveRevenue:D,catalogRevenue:L,bySizeData:Array.from(q.entries()).map(([F,S])=>({size:F,sold:S.sold,reserved:S.reserved,canceled:S.canceled,stock:0})),bySellerData:Array.from(X.entries()).map(([F,S])=>({name:F,sold:S.sold,revenue:S.revenue})).sort((F,S)=>S.revenue-F.revenue),byPaymentData:Array.from(H.entries()).map(([F,S])=>({method:F,count:S.count,total:S.total})),dailyData:Array.from(M.entries()).map(([F,S])=>({date:F,sold:S.sold,revenue:S.revenue})).sort((F,S)=>F.date.localeCompare(S.date))})}catch(p){console.error("Error loading drilldown data:",p)}finally{d(!1)}}},h=p=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(p),f=p=>Ht(new Date(p),"dd/MM"),m=p=>{const g=new URLSearchParams;g.set("tab","orders"),g.set("status",p),g.set("search",e||""),a(`/dashboard?${g.toString()}`),r()};return n.jsx(Tu,{open:t,onOpenChange:p=>!p&&r(),children:n.jsxs(fd,{className:"sm:max-w-lg overflow-y-auto",children:[n.jsx(Pu,{children:n.jsxs(cf,{className:"flex items-center gap-2",children:[n.jsx(Ut,{className:"h-5 w-5"}),n.jsx("span",{className:"truncate",children:e})]})}),c?n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx(At,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):i?n.jsxs("div",{className:"mt-6 space-y-6",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsx(De,{children:n.jsxs(Be,{className:"p-3",children:[n.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Vendido"}),n.jsxs("p",{className:"text-lg font-bold",children:[i.totalSold," peas"]}),n.jsx("p",{className:"text-sm text-green-600",children:h(i.totalRevenue)})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-3",children:[n.jsx("p",{className:"text-xs text-muted-foreground",children:"Live vs Catlogo"}),n.jsxs("div",{className:"flex gap-2 mt-1",children:[n.jsxs(Ae,{className:"bg-pink-100 text-pink-700 border-0",children:["Live: ",i.liveSold]}),n.jsxs(Ae,{className:"bg-blue-100 text-blue-700 border-0",children:["Cat: ",i.catalogSold]})]})]})})]}),n.jsxs(pi,{defaultValue:"tamanhos",children:[n.jsxs(Qa,{className:"w-full",children:[n.jsx(pr,{value:"tamanhos",className:"flex-1",children:"Tamanhos"}),n.jsx(pr,{value:"vendedoras",className:"flex-1",children:"Vendedoras"}),n.jsx(pr,{value:"acoes",className:"flex-1",children:"Aes"})]}),n.jsx(wr,{value:"tamanhos",className:"mt-4 space-y-2",children:i.bySizeData.length===0?n.jsx("p",{className:"text-muted-foreground text-sm text-center py-4",children:"Sem dados de tamanho"}):i.bySizeData.map((p,g)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-lg",children:[n.jsx(Ae,{variant:"outline",className:"font-mono",children:p.size}),n.jsxs("div",{className:"flex gap-4 text-sm",children:[n.jsxs("span",{className:"text-green-600",children:["Vendido: ",p.sold]}),p.reserved>0&&n.jsxs("span",{className:"text-amber-600",children:["Reservado: ",p.reserved]}),p.canceled>0&&n.jsxs("span",{className:"text-red-600",children:["Cancelado: ",p.canceled]})]})]},g))}),n.jsx(wr,{value:"vendedoras",className:"mt-4 space-y-2",children:i.bySellerData.length===0?n.jsx("p",{className:"text-muted-foreground text-sm text-center py-4",children:"Sem vendas por vendedora"}):i.bySellerData.map((p,g)=>n.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted/50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[g===0&&n.jsx("span",{className:"text-yellow-600",children:""}),n.jsx("span",{className:"font-medium",children:p.name})]}),n.jsxs("div",{className:"text-sm",children:[n.jsxs("span",{className:"text-muted-foreground",children:[p.sold," peas  "]}),n.jsx("span",{className:"text-green-600 font-medium",children:h(p.revenue)})]})]},g))}),n.jsxs(wr,{value:"acoes",className:"mt-4 space-y-3",children:[n.jsxs(he,{variant:"outline",className:"w-full justify-start gap-2",onClick:()=>m("pago"),children:[n.jsx(ma,{className:"h-4 w-4"}),"Ver pedidos pagos"]}),n.jsxs(he,{variant:"outline",className:"w-full justify-start gap-2",onClick:()=>m("aguardando_pagamento"),children:[n.jsx(ma,{className:"h-4 w-4"}),"Ver reservas (cobrar)"]}),n.jsxs(he,{variant:"outline",className:"w-full justify-start gap-2",onClick:()=>m("cancelado"),children:[n.jsx(ma,{className:"h-4 w-4"}),"Ver cancelados"]})]})]}),i.dailyData.length>1&&n.jsxs(De,{children:[n.jsx(Ot,{className:"pb-2",children:n.jsxs(Mt,{className:"text-sm flex items-center gap-2",children:[n.jsx(_s,{className:"h-4 w-4"}),"Evoluo Diria"]})}),n.jsx(Be,{children:n.jsx("div",{className:"flex items-end gap-1 h-16",children:i.dailyData.map((p,g)=>{const v=Math.max(...i.dailyData.map(y=>y.sold),1),x=p.sold/v*100;return n.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[n.jsx("div",{className:"w-full bg-primary rounded-t",style:{height:`${x}%`,minHeight:p.sold>0?4:0}}),n.jsx("span",{className:"text-[10px] text-muted-foreground",children:f(p.date)})]},g)})})})]})]}):null]})})}const FJe=()=>{const e=fr(),[t,r]=kc(),[s,a]=P.useState({period:t.get("period")||"7d",source:t.get("source")||"all",status:t.get("status")||"pago",sellerId:t.get("seller")||null,paymentMethod:null,search:t.get("search")||""}),[i,o]=P.useState(t.get("tab")||"produtos"),[c,d]=P.useState(null),[l,u]=P.useState(t.get("sort")||"revenue"),{kpis:h,productRanking:f,sizeRanking:m,sellerRanking:p,alerts:g,sellers:v,isLoading:x,refetch:y,dateRange:b}=RJe(s),j=L=>{a(X=>({...X,...L}));const q=new URLSearchParams(t);Object.entries(L).forEach(([X,H])=>{H?q.set(X,String(H)):q.delete(X)}),r(q)},T=()=>{const L=[...f].sort((E,N)=>l==="revenue"?N.revenue-E.revenue:N.qtySold-E.qtySold),q=["Rank","Produto","SKU","Qtd Vendida","Receita","Preo Mdio","% Live","Reservados","Converso %","Cancelados","Cancel %"],X=L.map((E,N)=>[N+1,E.productName,E.productSku||"",E.qtySold,E.revenue.toFixed(2),E.avgPrice.toFixed(2),E.percentLive.toFixed(0),E.reservedQty,E.conversaoRate.toFixed(1),E.canceledQty,E.cancelamentoRate.toFixed(1)]),H=[q.join(","),...X.map(E=>E.join(","))].join(`
`),M=new Blob([H],{type:"text/csv;charset=utf-8;"}),F=URL.createObjectURL(M),S=document.createElement("a");S.href=F,S.download=`ranking-produtos-${new Date().toISOString().split("T")[0]}.csv`,S.click()},O=L=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(L),R=L=>`${L.toFixed(1)}%`,D=(L,q)=>{if(q===0)return null;const X=(L-q)/q*100,H=X>0;return n.jsxs("span",{className:`text-xs ${H?"text-green-600":"text-red-600"}`,children:[H?"+":"",X.toFixed(0),"%"]})};return n.jsxs("div",{className:"min-h-screen bg-background",children:[n.jsx("header",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur border-b border-border",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 h-14 flex items-center justify-between gap-2",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>e("/dashboard"),children:n.jsx(vs,{className:"h-5 w-5"})}),n.jsx("img",{src:hd,alt:"LE.PO",className:"h-6 hidden sm:block"}),n.jsx("div",{className:"h-6 w-px bg-border hidden sm:block"}),n.jsx("h1",{className:"text-sm sm:text-base font-semibold",children:"Centro de Inteligncia"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:y,className:"gap-2",children:[n.jsx(en,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Atualizar"})]}),n.jsxs(he,{variant:"outline",size:"sm",onClick:T,className:"gap-2",children:[n.jsx(Af,{className:"h-4 w-4"}),n.jsx("span",{className:"hidden sm:inline",children:"Exportar CSV"})]})]})]})}),n.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-4 py-4 sm:py-6 space-y-6",children:[n.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[n.jsxs(Kt,{value:s.period,onValueChange:L=>j({period:L}),children:[n.jsx(Vt,{className:"w-[130px]",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"today",children:"Hoje"}),n.jsx(ze,{value:"7d",children:"ltimos 7 dias"}),n.jsx(ze,{value:"30d",children:"ltimos 30 dias"}),n.jsx(ze,{value:"thisMonth",children:"Este ms"})]})]}),n.jsxs(Kt,{value:s.source,onValueChange:L=>j({source:L}),children:[n.jsx(Vt,{className:"w-[120px]",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todas origens"}),n.jsx(ze,{value:"live",children:"Live"}),n.jsx(ze,{value:"catalog",children:"Catlogo"})]})]}),n.jsxs(Kt,{value:s.status,onValueChange:L=>j({status:L}),children:[n.jsx(Vt,{className:"w-[130px]",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"pago",children:"Pagos"}),n.jsx(ze,{value:"reservado",children:"Reservados"}),n.jsx(ze,{value:"cancelado",children:"Cancelados"}),n.jsx(ze,{value:"all",children:"Todos"})]})]}),n.jsxs(Kt,{value:s.sellerId||"all",onValueChange:L=>j({sellerId:L==="all"?null:L}),children:[n.jsx(Vt,{className:"w-[140px]",children:n.jsx(Xt,{placeholder:"Vendedora"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todas vendedoras"}),v.map(L=>n.jsx(ze,{value:L.id,children:L.name},L.id))]})]}),n.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[n.jsx(Ln,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),n.jsx(Qe,{placeholder:"Buscar por nome ou SKU...",value:s.search,onChange:L=>j({search:L.target.value}),className:"pl-9"})]})]}),h&&n.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3",children:[n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(tU,{className:"h-3.5 w-3.5"}),"Receita"]}),n.jsx("div",{className:"text-lg font-bold",children:O(h.receita)}),D(h.receita,h.receitaPrev)]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(ln,{className:"h-3.5 w-3.5"}),"Itens vendidos"]}),n.jsx("div",{className:"text-lg font-bold",children:h.itensSold}),D(h.itensSold,h.itensSoldPrev)]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(Pl,{className:"h-3.5 w-3.5"}),"Ticket mdio"]}),n.jsx("div",{className:"text-lg font-bold",children:O(h.ticketMedio)}),D(h.ticketMedio,h.ticketMedioPrev)]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(_s,{className:"h-3.5 w-3.5"}),"Converso Live"]}),n.jsx("div",{className:"text-lg font-bold",children:R(h.conversaoLive)})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(_s,{className:"h-3.5 w-3.5"}),"Converso Catlogo"]}),n.jsx("div",{className:"text-lg font-bold",children:R(h.conversaoCatalog)})]})}),n.jsx(De,{children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground text-xs mb-1",children:[n.jsx(Mr,{className:"h-3.5 w-3.5"}),"Cancelamento"]}),n.jsx("div",{className:"text-lg font-bold text-red-600",children:R(h.cancelamentoRate)})]})})]}),h&&n.jsxs("div",{className:"flex gap-2 flex-wrap",children:[n.jsxs(Ae,{variant:"outline",className:"gap-1",children:[n.jsx("span",{className:"w-2 h-2 rounded-full bg-pink-500"}),"Live: ",R(h.percentLive)]}),n.jsxs(Ae,{variant:"outline",className:"gap-1",children:[n.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"}),"Catlogo: ",R(h.percentCatalog)]})]}),g.length>0&&n.jsx(De,{className:"border-amber-200 bg-amber-50",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Mr,{className:"h-5 w-5 text-amber-600"}),n.jsxs("span",{className:"font-medium text-amber-800",children:[g.length," alertas ativos"]})]}),n.jsxs(he,{variant:"ghost",size:"sm",onClick:()=>o("alertas"),className:"gap-1 text-amber-700",children:["Ver todos ",n.jsx(Dn,{className:"h-4 w-4"})]})]})})}),n.jsxs(pi,{value:i,onValueChange:o,children:[n.jsxs(Qa,{children:[n.jsxs(pr,{value:"produtos",className:"gap-2",children:[n.jsx(ln,{className:"h-4 w-4"}),"Produtos"]}),n.jsxs(pr,{value:"tamanhos",className:"gap-2",children:[n.jsx(Pl,{className:"h-4 w-4"}),"Tamanhos"]}),n.jsxs(pr,{value:"vendedoras",className:"gap-2",children:[n.jsx(wa,{className:"h-4 w-4"}),"Vendedoras"]}),n.jsxs(pr,{value:"alertas",className:"gap-2",children:[n.jsx(Mr,{className:"h-4 w-4"}),"Alertas",g.length>0&&n.jsx(Ae,{variant:"destructive",className:"ml-1 h-5 w-5 p-0 text-[10px]",children:g.length})]})]}),n.jsxs(wr,{value:"produtos",className:"mt-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm text-muted-foreground",children:"Ordenar por:"}),n.jsxs(Kt,{value:l,onValueChange:L=>u(L),children:[n.jsx(Vt,{className:"w-[120px]",children:n.jsx(Xt,{})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"revenue",children:"Receita"}),n.jsx(ze,{value:"qty",children:"Quantidade"})]})]})]}),n.jsxs("span",{className:"text-sm text-muted-foreground",children:[f.length," produtos"]})]}),n.jsx(MJe,{data:f,sortBy:l,isLoading:x,onProductClick:L=>d(L)})]}),n.jsx(wr,{value:"tamanhos",className:"mt-4",children:n.jsx(IJe,{data:m,isLoading:x})}),n.jsx(wr,{value:"vendedoras",className:"mt-4",children:n.jsx(DJe,{data:p,isLoading:x})}),n.jsx(wr,{value:"alertas",className:"mt-4",children:n.jsx(LJe,{alerts:g,onViewProduct:L=>d(L)})})]})]}),n.jsx($Je,{productName:c,isOpen:!!c,onClose:()=>d(null),filters:s})]})};function zJe(){const[e,t]=P.useState([]),[r,s]=P.useState([]),[a,i]=P.useState(null),[o,c]=P.useState(!0),[d,l]=P.useState(!1),[u,h]=P.useState([]),f=P.useCallback(async()=>{c(!0);try{const{data:v,error:x}=await ce.from("customer_rfv_metrics").select("*, customer:customers(name, phone)").order("monetary_value",{ascending:!1});if(x)throw x;const y=(v||[]).map(R=>{var D,L;return{...R,customer_name:((D=R.customer)==null?void 0:D.name)||"Sem nome",customer_phone:((L=R.customer)==null?void 0:L.phone)||""}});t(y);const{data:b,error:j}=await ce.from("rfv_tasks").select("*, customer:customers(name, phone)").in("status",["pendente","enviado"]).order("created_at",{ascending:!1}).limit(200);if(j)throw j;const T=(b||[]).map(R=>{var L,q;const D=y.find(X=>X.customer_id===R.customer_id);return{...R,customer_name:((L=R.customer)==null?void 0:L.name)||"Sem nome",customer_phone:((q=R.customer)==null?void 0:q.phone)||"",rfv_segment:(D==null?void 0:D.rfv_segment)||"novo"}});if(s(T),y.length>0){const R={},D={};y.forEach(N=>{R[N.rfv_segment]=(R[N.rfv_segment]||0)+1,D[N.purchase_channel]=(D[N.purchase_channel]||0)+1});const{data:L}=await ce.from("rfv_tasks").select("status").gte("created_at",new Date(Date.now()-30*24*60*60*1e3).toISOString()),q=L||[],X=q.length||1,H=q.filter(N=>N.status!=="pendente").length,M=q.filter(N=>["respondeu","converteu"].includes(N.status)).length,F=q.filter(N=>N.status==="converteu").length,S=q.filter(N=>N.status==="converteu").reduce((N,C)=>N+(Number(C.revenue_generated)||0),0),E=y.filter(N=>N.avg_cycle_days!==null).map(N=>N.avg_cycle_days);i({totalCustomers:y.length,segmentDistribution:R,channelDistribution:D,avgRecurrency:E.length>0?E.reduce((N,C)=>N+C,0)/E.length:0,avgTicket:y.reduce((N,C)=>N+C.avg_ticket,0)/y.length,pendingTasks:T.filter(N=>N.status==="pendente").length,tasksByPriority:T.reduce((N,C)=>(C.status==="pendente"&&(N[C.priority]=(N[C.priority]||0)+1),N),{}),executionRate:H/X*100,responseRate:M/X*100,conversionRate:F/X*100,dailyTaskGoal:q.filter(N=>N.created_at&&N.created_at.startsWith(new Date().toISOString().split("T")[0])).length,dailyTaskDone:q.filter(N=>N.created_at&&N.created_at.startsWith(new Date().toISOString().split("T")[0])&&N.status!=="pendente").length,totalRevenue:S,roi:S>0?S/(q.length||1):0})}const{data:O}=await ce.from("rfv_templates").select("*");O&&h(O)}catch(v){console.error("Error loading RFV data:",v),de.error("Erro ao carregar dados RFV")}finally{c(!1)}},[]),m=async()=>{var v,x;l(!0);try{const{data:y,error:b}=await ce.rpc("run_rfv_copilot");if(b)throw b;await ce.rpc("attribute_rfv_revenue"),de.success(`RFV recalculado! ${((v=y==null?void 0:y.metrics)==null?void 0:v.customers_calculated)||0} clientes, ${((x=y==null?void 0:y.tasks)==null?void 0:x.tasks_created)||0} tarefas`),await f()}catch(y){console.error("Error recalculating RFV:",y),de.error("Erro ao recalcular: "+(y.message||""))}finally{l(!1)}},p=async(v,x)=>{try{const{error:y}=await ce.from("rfv_tasks").update({status:x,executed_at:x!=="pendente"?new Date().toISOString():null,executed_by:x!=="pendente"?"admin":null}).eq("id",v);if(y)throw y;s(b=>b.map(j=>j.id===v?{...j,status:x,executed_at:new Date().toISOString()}:j)),de.success("Status atualizado!")}catch(y){de.error("Erro ao atualizar: "+(y.message||""))}},g=async(v,x,y)=>{try{const{error:b}=await ce.from("rfv_templates").upsert({task_type:v,channel_context:x,content:y,updated_at:new Date().toISOString()},{onConflict:"task_type,channel_context"});if(b)throw b;const{data:j}=await ce.from("rfv_templates").select("*");j&&h(j),de.success("Template salvo com sucesso!")}catch(b){de.error("Erro ao salvar template: "+(b.message||""))}};return P.useEffect(()=>{f()},[f]),{metrics:e,tasks:r,summary:a,isLoading:o,isRecalculating:d,recalculate:m,updateTaskStatus:p,saveTemplate:g,templates:u,reload:f}}function UJe({summary:e}){const t=s=>s.toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),r=[{label:"Clientes Analisados",value:e.totalCustomers.toString(),icon:wa,color:"from-purple-500 to-purple-600",detail:`${e.channelDistribution.hybrid||0} hbridos`},{label:"Tarefas Pendentes",value:e.pendingTasks.toString(),icon:ba,color:"from-red-500 to-orange-500",detail:`${e.tasksByPriority.critico||0} crticas`},{label:"Taxa de Execuo",value:`${e.executionRate.toFixed(0)}%`,icon:jo,color:"from-emerald-500 to-teal-500",detail:"ltimos 30 dias"},{label:"Taxa de Converso",value:`${e.conversionRate.toFixed(0)}%`,icon:Vz,color:"from-blue-500 to-indigo-500",detail:"ltimos 30 dias"},{label:"Ticket Mdio",value:t(e.avgTicket),icon:_s,color:"from-pink-500 to-rose-500",detail:"da base ativa"},{label:"Ciclo Mdio",value:e.avgRecurrency>0?`${e.avgRecurrency.toFixed(0)}d`:"",icon:Br,color:"from-amber-500 to-yellow-500",detail:"entre compras"},{label:"Receita Copiloto",value:t(e.totalRevenue||0),icon:Wz,color:"from-green-500 to-emerald-600",detail:"atribuio direta"},{label:"ROI (por tarefa)",value:t(e.roi||0),icon:Pl,color:"from-violet-500 to-purple-600",detail:"retorno mdio"}];return n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-8 gap-3",children:r.map(s=>n.jsx(De,{className:"border-0 shadow-sm hover:shadow-md transition-shadow",children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("div",{className:`p-1.5 rounded-lg bg-gradient-to-br ${s.color}`,children:n.jsx(s.icon,{className:"h-3.5 w-3.5 text-white"})}),n.jsx("span",{className:"text-xs text-muted-foreground",children:s.label})]}),n.jsx("div",{className:"text-xl font-bold",children:s.value}),n.jsx("div",{className:"text-xs text-muted-foreground mt-0.5",children:s.detail})]})},s.label))})}const zB={campeao:{emoji:"",label:"Campeo"},fiel:{emoji:"",label:"Fiel"},promissor:{emoji:"",label:"Promissor"},atencao:{emoji:"",label:"Ateno"},hibernando:{emoji:"",label:"Hibernando"},risco:{emoji:"",label:"Em Risco"},novo:{emoji:"",label:"Novo"}},UB={live_only:{emoji:"",label:"Live"},site_only:{emoji:"",label:"Site"},hybrid:{emoji:"",label:"Hbrido"}},VB={critico:{color:"border-red-200 bg-red-50/50",label:"Crtico",dot:""},importante:{color:"border-amber-200 bg-amber-50/50",label:"Importante",dot:""},oportunidade:{color:"border-emerald-200 bg-emerald-50/50",label:"Oportunidade",dot:""}},VJe={pos_compra:"Ps-compra",preventivo:"Preventivo",reativacao:"Reativao",vip:"VIP",perda_frequencia:"Perda Frequncia",migrar_canal:"Migrar Canal"};function qJe({tasks:e,onUpdateStatus:t,isLoading:r}){const s=fr(),[a,i]=P.useState(null),[o,c]=P.useState(null);if(r)return n.jsx("div",{className:"flex items-center justify-center py-12",children:n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})});if(e.length===0)return n.jsx(De,{className:"border-dashed border-2 border-purple-200",children:n.jsxs(Be,{className:"py-12 text-center text-muted-foreground",children:[n.jsx("p",{className:"text-lg mb-2",children:"Nenhuma tarefa encontrada"}),n.jsx("p",{className:"text-sm",children:'Clique em "Recalcular RFV" para gerar novas tarefas'})]})});const d=async u=>{try{await navigator.clipboard.writeText(u.suggested_message),c(u.id),de.success("Mensagem copiada!"),setTimeout(()=>c(null),2e3)}catch{de.error("Erro ao copiar")}},l=u=>{if(!u.customer_phone){de.error("Telefone no disponvel");return}const h=u.customer_phone.replace(/\D/g,""),f=h.startsWith("55")?h:`55${h}`,m=encodeURIComponent(u.suggested_message);window.open(`https://wa.me/${f}?text=${m}`,"_blank")};return n.jsx("div",{className:"space-y-3",children:e.map(u=>{const h=VB[u.priority]||VB.oportunidade,f=zB[u.rfv_segment||"novo"]||zB.novo,m=UB[u.channel_context]||UB.site_only,p=a===u.id,g=o===u.id;return n.jsx(De,{className:`transition-all hover:shadow-md ${h.color}`,children:n.jsxs(Be,{className:"p-4",children:[n.jsxs("div",{className:"flex items-start justify-between gap-3",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsxs("div",{className:"flex items-center flex-wrap gap-2 mb-1 cursor-pointer hover:opacity-75 transition-opacity",onClick:()=>s(`/dashboard/clientes/${u.customer_id}`),title:"Ver perfil completo",children:[n.jsx("span",{className:"font-semibold truncate group-hover:underline decoration-purple-400 decoration-2 underline-offset-2 transition-all",children:u.customer_name}),n.jsxs("div",{className:"flex items-center gap-1 bg-purple-50 px-2 py-0.5 rounded text-[10px] font-bold text-purple-700 border border-purple-100 shrink-0",children:[n.jsx(_s,{className:"h-3 w-3"}),u.repurchase_probability_score||0,"% Prob."]}),n.jsxs(Ae,{variant:"outline",className:"text-xs shrink-0",children:[f.emoji," ",f.label]}),n.jsxs(Ae,{variant:"outline",className:"text-xs shrink-0",children:[m.emoji," ",m.label]}),n.jsxs(Ae,{variant:"outline",className:"text-xs shrink-0",children:[h.dot," ",h.label]})]}),n.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[n.jsx("span",{className:"font-medium text-foreground",children:VJe[u.task_type]||u.task_type}),n.jsx("span",{children:""}),n.jsx("span",{className:"truncate",children:u.reason})]}),u.estimated_impact>0&&u.status==="pendente"&&n.jsxs("div",{className:"text-xs text-emerald-600 mt-1 flex items-center gap-1",children:[n.jsx(ws,{className:"h-3 w-3"}),"Impacto estimado: R$ ",u.estimated_impact.toFixed(2)]}),u.revenue_generated>0&&n.jsxs("div",{className:"text-xs text-blue-700 mt-1 font-bold flex items-center gap-1",children:[n.jsx(ln,{className:"h-3 w-3"}),"Receita gerada: R$ ",u.revenue_generated.toFixed(2)]})]}),n.jsx(he,{variant:"ghost",size:"icon",className:"shrink-0",onClick:()=>i(p?null:u.id),children:p?n.jsx(nf,{className:"h-4 w-4"}):n.jsx(Zi,{className:"h-4 w-4"})})]}),p&&n.jsxs("div",{className:"mt-3 pt-3 border-t space-y-3",children:[n.jsxs("div",{className:"bg-white rounded-lg p-3 text-sm border",children:[n.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:" Mensagem sugerida:"}),n.jsx("p",{className:"whitespace-pre-wrap",children:u.suggested_message})]}),n.jsxs("div",{className:"flex flex-wrap gap-2",children:[n.jsxs(he,{size:"sm",variant:"outline",onClick:()=>d(u),className:"gap-1",children:[g?n.jsx(xn,{className:"h-3.5 w-3.5 text-emerald-600"}):n.jsx(Ia,{className:"h-3.5 w-3.5"}),g?"Copiado!":"Copiar"]}),n.jsxs(he,{size:"sm",variant:"outline",onClick:()=>l(u),className:"gap-1 text-emerald-700 border-emerald-200 hover:bg-emerald-50",children:[n.jsx(el,{className:"h-3.5 w-3.5"}),"WhatsApp"]}),n.jsx("div",{className:"flex-1"}),u.status==="pendente"&&n.jsxs(n.Fragment,{children:[n.jsxs(he,{size:"sm",onClick:()=>t(u.id,"enviado"),className:"gap-1 bg-blue-600 hover:bg-blue-700",children:[n.jsx(zu,{className:"h-3.5 w-3.5"}),"Enviado"]}),n.jsxs(he,{size:"sm",variant:"ghost",onClick:()=>t(u.id,"sem_resposta"),className:"gap-1 text-muted-foreground",children:[n.jsx(qn,{className:"h-3.5 w-3.5"}),"Sem resposta"]})]}),u.status==="enviado"&&n.jsxs(n.Fragment,{children:[n.jsxs(he,{size:"sm",onClick:()=>t(u.id,"respondeu"),className:"gap-1 bg-amber-600 hover:bg-amber-700",children:[n.jsx(nn,{className:"h-3.5 w-3.5"}),"Respondeu"]}),n.jsxs(he,{size:"sm",onClick:()=>t(u.id,"converteu"),className:"gap-1 bg-emerald-600 hover:bg-emerald-700",children:[n.jsx(ln,{className:"h-3.5 w-3.5"}),"Converteu"]}),n.jsxs(he,{size:"sm",variant:"ghost",onClick:()=>t(u.id,"sem_resposta"),className:"gap-1 text-muted-foreground",children:[n.jsx(qn,{className:"h-3.5 w-3.5"}),"Sem resposta"]})]})]})]})]})},u.id)})})}const WJe={campeao:"#a855f7",fiel:"#3b82f6",promissor:"#22c55e",atencao:"#f59e0b",hibernando:"#94a3b8",risco:"#ef4444",novo:"#06b6d4"},HJe={campeao:" Campeo",fiel:" Fiel",promissor:" Promissor",atencao:" Ateno",hibernando:" Hibernando",risco:" Em Risco",novo:" Novo"};function GJe({distribution:e,total:t}){const r=Object.entries(e).map(([s,a])=>({name:HJe[s]||s,value:a,color:WJe[s]||"#9ca3af"})).sort((s,a)=>a.value-s.value);return n.jsxs(De,{className:"border-purple-100",children:[n.jsx(Ot,{children:n.jsx(Mt,{className:"text-base",children:"Distribuio dos Segmentos RFV"})}),n.jsxs(Be,{children:[n.jsx(XA,{width:"100%",height:300,children:n.jsxs($ee,{children:[n.jsx(Dc,{data:r,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:3,dataKey:"value",label:({name:s,percent:a})=>`${s} ${(a*100).toFixed(0)}%`,labelLine:{strokeWidth:1},children:r.map((s,a)=>n.jsx(W1,{fill:s.color,stroke:"white",strokeWidth:2},a))}),n.jsx(Lo,{formatter:s=>[`${s} clientes`,"Quantidade"]})]})}),n.jsxs("div",{className:"text-center text-sm text-muted-foreground mt-2",children:[t," clientes na base ativa"]})]})]})}const qB={live_only:{label:" Live Only",color:"#ef4444"},site_only:{label:" Site Only",color:"#3b82f6"},hybrid:{label:" Hybrid",color:"#a855f7"}};function KJe({distribution:e,total:t}){const r=Object.entries(e).map(([s,a])=>{var i,o;return{name:((i=qB[s])==null?void 0:i.label)||s,value:a,color:((o=qB[s])==null?void 0:o.color)||"#9ca3af"}}).sort((s,a)=>a.value-s.value);return n.jsxs(De,{className:"border-purple-100",children:[n.jsx(Ot,{children:n.jsx(Mt,{className:"text-base",children:"Distribuio por Canal de Compra"})}),n.jsxs(Be,{children:[n.jsx(XA,{width:"100%",height:300,children:n.jsxs($ee,{children:[n.jsx(Dc,{data:r,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:3,dataKey:"value",label:({name:s,percent:a})=>`${s} ${(a*100).toFixed(0)}%`,labelLine:{strokeWidth:1},children:r.map((s,a)=>n.jsx(W1,{fill:s.color,stroke:"white",strokeWidth:2},a))}),n.jsx(Lo,{formatter:s=>[`${s} clientes`,"Quantidade"]})]})}),n.jsxs("div",{className:"text-center text-sm text-muted-foreground mt-2",children:[t," clientes na base ativa"]})]})]})}const Q4=[{value:"pos_compra",label:"Ps-compra"},{value:"vip",label:"VIP (Campees)"},{value:"preventivo",label:"Preventivo"},{value:"reativacao",label:"Reativao"},{value:"migrar_canal",label:"Migrao de Canal"}],XJe=[{value:"site_only",label:"Site Only",emoji:""},{value:"live_only",label:"Live Only",emoji:""},{value:"hybrid",label:"Hbrido",emoji:""},{value:"all",label:"Geral (Fallback)",emoji:""}];function YJe({templates:e,onSave:t}){const[r,s]=P.useState(Q4[0].value),[a,i]=P.useState(!1),[o,c]=P.useState({}),d=async l=>{const u=o[`${r}_${l}`];u!==void 0&&(i(!0),await t(r,l,u),i(!1))};return n.jsxs("div",{className:"space-y-6",children:[n.jsxs(De,{className:"border-purple-100",children:[n.jsxs(Ot,{children:[n.jsxs(Mt,{className:"flex items-center gap-2",children:[n.jsx(td,{className:"h-5 w-5 text-purple-600"}),"Editor de Mensagens do Copiloto"]}),n.jsxs(Ai,{children:["Personalize o que o Copiloto sugere para cada situao. Use ",n.jsx("code",{className:"bg-slate-100 px-1 rounded",children:"{{name}}"})," para o nome do cliente."]})]}),n.jsx(Be,{children:n.jsxs(pi,{value:r,onValueChange:s,className:"space-y-6",children:[n.jsx(Qa,{className:"bg-slate-50 flex-wrap h-auto p-1",children:Q4.map(l=>n.jsx(pr,{value:l.value,className:"text-xs",children:l.label},l.value))}),Q4.map(l=>n.jsx(wr,{value:l.value,className:"space-y-4",children:n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:XJe.map(u=>{const h=e.find(m=>m.task_type===l.value&&m.channel_context===u.value),f=o[`${l.value}_${u.value}`]??(h==null?void 0:h.content)??"";return n.jsx(De,{className:"border-slate-100 shadow-none",children:n.jsxs(Be,{className:"p-4 space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs(Ae,{variant:"outline",className:"gap-1",children:[u.emoji," ",u.label]}),h&&n.jsx("span",{className:"text-[10px] text-muted-foreground italic",children:"Salvo"})]}),n.jsx(Yn,{value:f,onChange:m=>c(p=>({...p,[`${l.value}_${u.value}`]:m.target.value})),placeholder:"Escreva a mensagem aqui...",className:"text-sm min-h-[100px] bg-slate-50/30"}),n.jsx(he,{size:"sm",className:"w-full bg-slate-800 text-white hover:bg-slate-900",onClick:()=>d(u.value),disabled:a||f===((h==null?void 0:h.content)??""),children:"Salvar Template"})]})},u.value)})})},l.value))]})})]}),n.jsx(De,{className:"bg-blue-50/50 border-blue-100",children:n.jsxs(Be,{className:"p-4 flex gap-3 text-sm text-blue-700",children:[n.jsx(Yz,{className:"h-5 w-5 shrink-0"}),n.jsxs("p",{children:[n.jsx("strong",{children:"Dica:"})," Se voc no definir um template para um canal especfico (ex: Live Only), o sistema usar automaticamente o template marcado como ",n.jsx("strong",{children:"Geral (Fallback)"}),"."]})]})})]})}function ZJe(){const e=fr(),{metrics:t,tasks:r,summary:s,isLoading:a,isRecalculating:i,recalculate:o,updateTaskStatus:c,reload:d,templates:l,saveTemplate:u}=zJe(),[h,f]=P.useState("all"),[m,p]=P.useState("all"),[g,v]=P.useState("all"),x=r.filter(R=>!(h!=="all"&&R.channel_context!==h||m!=="all"&&R.priority!==m||g!=="all"&&R.task_type!==g)),y=x.filter(R=>R.priority==="critico"&&R.status==="pendente").length,b=x.filter(R=>R.priority==="importante"&&R.status==="pendente").length,j=x.filter(R=>R.priority==="oportunidade"&&R.status==="pendente").length,T=()=>{if(!r||r.length===0)return;const R=["Cliente","Telefone","Segmento","Canal","Tipo de Tarefa","Probabilidade Recompra","Impacto Estimado","Prioridade","Status","Receita Gerada"],D=r.map(M=>[M.customer_name||"",M.customer_phone||"",M.rfv_segment||"",M.channel_context||"",M.task_type||"",`${M.repurchase_probability_score||0}%`,M.estimated_impact||0,M.priority||"",M.status||"",M.revenue_generated||0]),L=[R.join(","),...D.map(M=>M.map(F=>`"${F}"`).join(","))].join(`
`),q=new Blob([L],{type:"text/csv;charset=utf-8;"}),X=URL.createObjectURL(q),H=document.createElement("a");H.setAttribute("href",X),H.setAttribute("download",`relatorio-rfv-${new Date().toISOString().split("T")[0]}.csv`),H.style.visibility="hidden",document.body.appendChild(H),H.click(),document.body.removeChild(H)},O=async()=>{if(!r||r.length===0)return;const R=new mv.Workbook,D=R.addWorksheet("Relatrio RFV");D.columns=[{header:"Cliente",key:"name",width:30},{header:"Telefone",key:"phone",width:20},{header:"Segmento",key:"segment",width:15},{header:"Canal",key:"channel",width:15},{header:"Tipo de Tarefa",key:"type",width:20},{header:"Probabilidade Recompra",key:"prob",width:20},{header:"Impacto Estimado",key:"impact",width:15},{header:"Prioridade",key:"priority",width:15},{header:"Status",key:"status",width:15},{header:"Receita Gerada",key:"revenue",width:15}],r.forEach(M=>{D.addRow({name:M.customer_name||"",phone:M.customer_phone||"",segment:M.rfv_segment||"",channel:M.channel_context||"",type:M.task_type||"",prob:`${M.repurchase_probability_score||0}%`,impact:M.estimated_impact||0,priority:M.priority||"",status:M.status||"",revenue:M.revenue_generated||0})}),D.getRow(1).font={bold:!0},D.getRow(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFE9D5FF"}};const L=await R.xlsx.writeBuffer(),q=new Blob([L],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),X=URL.createObjectURL(q),H=document.createElement("a");H.setAttribute("href",X),H.setAttribute("download",`relatorio-rfv-${new Date().toISOString().split("T")[0]}.xlsx`),H.style.visibility="hidden",document.body.appendChild(H),H.click(),document.body.removeChild(H)};return n.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-purple-50/30 to-pink-50/20",children:[n.jsx("div",{className:"bg-white/80 backdrop-blur-sm border-b border-purple-100 sticky top-0 z-50",children:n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx(he,{variant:"ghost",size:"icon",onClick:()=>e("/dashboard"),children:n.jsx(vs,{className:"h-5 w-5"})}),n.jsx("img",{src:hd,alt:"Le.Po",className:"h-8"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(XS,{className:"h-5 w-5 text-purple-600"}),n.jsx("h1",{className:"text-lg font-bold bg-gradient-to-r from-purple-700 to-pink-600 bg-clip-text text-transparent",children:"Copiloto RFV"})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(he,{variant:"outline",size:"sm",onClick:d,disabled:a,children:[n.jsx(en,{className:`h-4 w-4 mr-1 ${a?"animate-spin":""}`}),"Atualizar"]}),n.jsxs(he,{size:"sm",onClick:o,disabled:i,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:[n.jsx(aU,{className:`h-4 w-4 mr-1 ${i?"animate-pulse":""}`}),i?"Calculando...":"Recalcular RFV"]}),n.jsxs(L1,{children:[n.jsx(B1,{asChild:!0,children:n.jsxs(he,{variant:"outline",size:"sm",disabled:r.length===0,children:[n.jsx(uae,{className:"h-4 w-4 mr-1"}),"Exportar",n.jsx(Zi,{className:"h-4 w-4 ml-1 opacity-50"})]})}),n.jsxs(Ig,{align:"end",children:[n.jsx(po,{onClick:O,children:"Exportar Excel (.xlsx)"}),n.jsx(po,{onClick:T,children:"Exportar CSV (.csv)"})]})]})]})]})}),n.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:s&&n.jsx(De,{className:"border-purple-100 bg-white/50 overflow-hidden",children:n.jsx(Be,{className:"p-4",children:n.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[n.jsxs("div",{className:"space-y-1",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(pn,{className:"h-5 w-5 text-purple-600"}),n.jsx("h2",{className:"font-bold text-gray-800",children:"Meta Diria de Contatos"})]}),n.jsx("p",{className:"text-sm text-muted-foreground",children:s.dailyTaskDone>=s.dailyTaskGoal&&s.dailyTaskGoal>0?" Parabns! Todas as tarefas de hoje foram realizadas.":`Faltam ${s.dailyTaskGoal-s.dailyTaskDone} contatos para bater a meta de hoje.`})]}),n.jsxs("div",{className:"flex-1 max-w-md space-y-2",children:[n.jsxs("div",{className:"flex justify-between text-xs font-medium",children:[n.jsxs("span",{children:["Progresso: ",s.dailyTaskDone," / ",s.dailyTaskGoal," tarefas"]}),n.jsxs("span",{children:[s.dailyTaskGoal>0?Math.round(s.dailyTaskDone/s.dailyTaskGoal*100):0,"%"]})]}),n.jsx(Mg,{value:s.dailyTaskGoal>0?s.dailyTaskDone/s.dailyTaskGoal*100:0,className:"h-2.5 bg-purple-100"})]})]})})})}),n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-2 space-y-6",children:[s&&n.jsx(UJe,{summary:s}),n.jsxs(pi,{defaultValue:"tasks",className:"space-y-4",children:[n.jsxs(Qa,{className:"bg-white border",children:[n.jsxs(pr,{value:"tasks",className:"data-[state=active]:bg-purple-100 data-[state=active]:text-purple-700",children:[n.jsx(ba,{className:"h-4 w-4 mr-1"}),"Tarefas (",x.filter(R=>R.status==="pendente").length,")"]}),n.jsxs(pr,{value:"segments",className:"data-[state=active]:bg-purple-100 data-[state=active]:text-purple-700",children:[n.jsx(wa,{className:"h-4 w-4 mr-1"}),"Segmentos"]}),n.jsxs(pr,{value:"channels",className:"data-[state=active]:bg-purple-100 data-[state=active]:text-purple-700",children:[n.jsx(_s,{className:"h-4 w-4 mr-1"}),"Canais"]}),n.jsxs(pr,{value:"config",className:"data-[state=active]:bg-purple-100 data-[state=active]:text-purple-700",children:[n.jsx(dk,{className:"h-4 w-4 mr-1"}),"Configuraes"]})]}),n.jsxs(wr,{value:"tasks",className:"space-y-4",children:[n.jsxs("div",{className:"flex flex-wrap gap-2",children:[y>0&&n.jsxs(Ae,{variant:"destructive",className:"text-sm px-3 py-1",children:[" ",y," Crticas"]}),b>0&&n.jsxs(Ae,{className:"bg-amber-100 text-amber-800 hover:bg-amber-200 text-sm px-3 py-1",children:[" ",b," Importantes"]}),j>0&&n.jsxs(Ae,{className:"bg-emerald-100 text-emerald-800 hover:bg-emerald-200 text-sm px-3 py-1",children:[" ",j," Oportunidades"]})]}),n.jsxs("div",{className:"flex flex-wrap gap-3 items-center",children:[n.jsx(wd,{className:"h-4 w-4 text-muted-foreground"}),n.jsxs(Kt,{value:h,onValueChange:f,children:[n.jsx(Vt,{className:"w-[160px] bg-white",children:n.jsx(Xt,{placeholder:"Canal"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos os canais"}),n.jsx(ze,{value:"live_only",children:" Live Only"}),n.jsx(ze,{value:"site_only",children:" Site Only"}),n.jsx(ze,{value:"hybrid",children:" Hybrid"})]})]}),n.jsxs(Kt,{value:m,onValueChange:p,children:[n.jsx(Vt,{className:"w-[160px] bg-white",children:n.jsx(Xt,{placeholder:"Prioridade"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todas"}),n.jsx(ze,{value:"critico",children:" Crtico"}),n.jsx(ze,{value:"importante",children:" Importante"}),n.jsx(ze,{value:"oportunidade",children:" Oportunidade"})]})]}),n.jsxs(Kt,{value:g,onValueChange:v,children:[n.jsx(Vt,{className:"w-[180px] bg-white",children:n.jsx(Xt,{placeholder:"Tipo"})}),n.jsxs(qt,{children:[n.jsx(ze,{value:"all",children:"Todos os tipos"}),n.jsx(ze,{value:"pos_compra",children:"Ps-compra"}),n.jsx(ze,{value:"preventivo",children:"Preventivo"}),n.jsx(ze,{value:"reativacao",children:"Reativao"}),n.jsx(ze,{value:"vip",children:"VIP"}),n.jsx(ze,{value:"perda_frequencia",children:"Perda Frequncia"}),n.jsx(ze,{value:"migrar_canal",children:"Migrar Canal"})]})]})]}),n.jsx(qJe,{tasks:x,onUpdateStatus:c,isLoading:a})]}),n.jsx(wr,{value:"segments",children:s&&n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsx(GJe,{distribution:s.segmentDistribution,total:s.totalCustomers}),n.jsxs(De,{className:"border-purple-100",children:[n.jsx(Ot,{children:n.jsx(Mt,{className:"text-base",children:"Detalhamento por Segmento"})}),n.jsx(Be,{children:n.jsx("div",{className:"space-y-3",children:Object.entries(s.segmentDistribution).sort(([,R],[,D])=>D-R).map(([R,D])=>{const L=(D/s.totalCustomers*100).toFixed(1);return n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-lg",children:QJe(R)}),n.jsx("span",{className:"font-medium capitalize",children:R})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("div",{className:"w-32 bg-gray-100 rounded-full h-2",children:n.jsx("div",{className:"h-2 rounded-full bg-gradient-to-r from-purple-500 to-pink-500",style:{width:`${L}%`}})}),n.jsxs("span",{className:"text-sm text-muted-foreground w-16 text-right",children:[D," (",L,"%)"]})]})]},R)})})})]})]})}),n.jsx(wr,{value:"channels",children:s&&n.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[n.jsx(KJe,{distribution:s.channelDistribution,total:s.totalCustomers}),n.jsxs(De,{className:"border-purple-100",children:[n.jsx(Ot,{children:n.jsx(Mt,{className:"text-base",children:"Mtricas por Canal"})}),n.jsx(Be,{children:n.jsx("div",{className:"space-y-4",children:[{key:"live_only",label:" Live Only",color:"from-red-500 to-orange-500"},{key:"site_only",label:" Site Only",color:"from-blue-500 to-cyan-500"},{key:"hybrid",label:" Hybrid",color:"from-purple-500 to-pink-500"}].map(({key:R,label:D,color:L})=>{const q=t.filter(F=>F.purchase_channel===R),X=q.length,H=X>0?q.reduce((F,S)=>F+S.avg_ticket,0)/X:0,M=q.reduce((F,S)=>F+S.monetary_value,0);return n.jsxs("div",{className:"p-3 border rounded-lg",children:[n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsx("span",{className:"font-medium",children:D}),n.jsxs(Ae,{variant:"outline",children:[X," clientes"]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-muted-foreground",children:[n.jsxs("div",{children:["Ticket Mdio: ",n.jsxs("span",{className:"font-semibold text-foreground",children:["R$ ",H.toFixed(2)]})]}),n.jsxs("div",{children:["Receita Total: ",n.jsxs("span",{className:"font-semibold text-foreground",children:["R$ ",M.toFixed(2)]})]})]})]},R)})})})]})]})}),n.jsx(wr,{value:"config",children:n.jsx(YJe,{templates:l,onSave:u})})]})]})]})}function QJe(e){return{campeao:"",fiel:"",promissor:"",atencao:"",hibernando:"",risco:"",novo:""}[e]||""}const JJe=new tce,eet=()=>n.jsx(nce,{client:JJe,children:n.jsx(Fhe,{children:n.jsxs(wp,{children:[n.jsx(pie,{}),n.jsx(Gie,{}),n.jsx(ede,{children:n.jsxs(Hce,{children:[n.jsx(Tr,{path:"/",element:n.jsx(zme,{})}),n.jsx(Tr,{path:"/meu-estilo",element:n.jsx(ipe,{})}),n.jsx(Tr,{path:"/quiz",element:n.jsx(fpe,{})}),n.jsx(Tr,{path:"/resultado/:customerId",element:n.jsx(ppe,{})}),n.jsx(Tr,{path:"/missao/:missionId",element:n.jsx(vpe,{})}),n.jsx(Tr,{path:"/enviar-print",element:n.jsx(Ope,{})}),n.jsx(Tr,{path:"/print-story",element:n.jsx(zO,{to:"/enviar-print",replace:!0})}),n.jsx(Tr,{path:"/buscar-por-foto",element:n.jsx(zO,{to:"/enviar-print",replace:!0})}),n.jsx(Tr,{path:"/entrar",element:n.jsx(Nge,{})}),n.jsx(Tr,{path:"/auth/callback",element:n.jsx(Sge,{})}),n.jsx(Tr,{path:"/esqueci-senha",element:n.jsx(Cge,{})}),n.jsx(Tr,{path:"/redefinir-senha",element:n.jsx(kge,{})}),n.jsx(Tr,{path:"/resetar-senha",element:n.jsx(Tge,{})}),n.jsx(Tr,{path:"/minha-conta",element:n.jsx(dNe,{})}),n.jsx(Tr,{path:"/minha-conta/club",element:n.jsx(XCe,{})}),n.jsx(Tr,{path:"/minha-conta/missoes",element:n.jsx(YCe,{})}),n.jsx(Tr,{path:"/minha-conta/auth",element:n.jsx(iNe,{})}),n.jsx(Tr,{path:"/meus-pedidos",element:n.jsx(QCe,{})}),n.jsx(Tr,{path:"/meus-pedidos/:id",element:n.jsx(JCe,{})}),n.jsx(Tr,{path:"/meus-prints",element:n.jsx(e5e,{})}),n.jsx(Tr,{path:"/meu-perfil",element:n.jsx(n5e,{})}),n.jsx(Tr,{path:"/minhas-sugestoes",element:n.jsx(s5e,{})}),n.jsx(Tr,{path:"/meus-favoritos",element:n.jsx(a5e,{})}),n.jsx(Tr,{path:"/login",element:n.jsx(KR,{})}),n.jsx(Tr,{path:"/area-lojista",element:n.jsx(KR,{})}),n.jsx(Tr,{path:"/dashboard",element:n.jsx(G2e,{})}),n.jsx(Tr,{path:"/dashboard/clientes/:id",element:n.jsx(tNe,{})}),n.jsx(Tr,{path:"/dashboard/lives/relatorio",element:n.jsx(OZe,{})}),n.jsx(Tr,{path:"/dashboard/lives/rastreador",element:n.jsx(mJe,{})}),n.jsx(Tr,{path:"/dashboard/lives/:eventId/planejar",element:n.jsx(u5e,{})}),n.jsx(Tr,{path:"/dashboard/lives/:eventId/backstage",element:n.jsx(B5e,{})}),n.jsx(Tr,{path:"/dashboard/lives/:eventId/relatorio",element:n.jsx(_Ze,{})}),n.jsx(Tr,{path:"/dashboard/lives/:eventId/pedidos",element:n.jsx(TJe,{})}),n.jsx(Tr,{path:"/dashboard/lives/:eventId/pendencias",element:n.jsx(OJe,{})}),n.jsx(Tr,{path:"/dashboard/lives/:eventId/separacao",element:n.jsx(tJe,{})}),n.jsx(Tr,{path:"/dashboard/insights",element:n.jsx(FJe,{})}),n.jsx(Tr,{path:"/dashboard/copiloto-rfv",element:n.jsx(ZJe,{})}),n.jsx(Tr,{path:"/importar-estoque",element:n.jsx(C_e,{})}),n.jsx(Tr,{path:"/catalogo",element:n.jsx(Z2e,{})}),n.jsx(Tr,{path:"/produto/:productId",element:n.jsx(Q2e,{})}),n.jsx(Tr,{path:"/carrinho",element:n.jsx(J2e,{})}),n.jsx(Tr,{path:"/checkout",element:n.jsx(p_e,{})}),n.jsx(Tr,{path:"/pedido/sucesso",element:n.jsx(i5e,{})}),n.jsx(Tr,{path:"/pedido/pendente",element:n.jsx(o5e,{})}),n.jsx(Tr,{path:"/pedido/erro",element:n.jsx(c5e,{})}),n.jsx(Tr,{path:"/live-checkout/:cartId",element:n.jsx(sJe,{})}),n.jsx(Tr,{path:"/sacola/:bagId",element:n.jsx(oJe,{})}),n.jsx(Tr,{path:"/c/:link",element:n.jsx(rNe,{})}),n.jsx(Tr,{path:"*",element:n.jsx(nNe,{})})]})})]})})});fz(document.getElementById("root")).render(n.jsx(eet,{}))});export default tet();
